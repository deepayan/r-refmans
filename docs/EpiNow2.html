<!DOCTYPE html><html lang="en-GB"><head><title>Help for package EpiNow2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EpiNow2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EpiNow2-package'><p>EpiNow2: Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters</p></a></li>
<li><a href='#+2B.dist_spec'><p>Creates a delay distribution as the sum of two other delay distributions.</p></a></li>
<li><a href='#+3D+3D.dist_spec'><p>Compares two delay distributions</p></a></li>
<li><a href='#add_breakpoints'><p>Add breakpoints to certain dates in a data set.</p></a></li>
<li><a href='#add_day_of_week'><p>Adds a day of the week vector</p></a></li>
<li><a href='#add_horizon'><p>Add missing values for future dates</p></a></li>
<li><a href='#allocate_delays'><p>Allocate Delays into Required Stan Format</p></a></li>
<li><a href='#allocate_empty'><p>Allocate Empty Parameters to a List</p></a></li>
<li><a href='#apply_default_cdf_cutoff'><p>Apply default CDF cutoff to a &lt;dist_spec&gt; if it is unconstrained</p></a></li>
<li><a href='#apply_tolerance'><p>Applies a threshold to all nonparametric distributions in a &lt;dist_spec&gt;</p></a></li>
<li><a href='#apply_zero_threshold'><p>Convert zero case counts to <code>NA</code> (missing) if the 7-day average is above a</p>
threshold.</a></li>
<li><a href='#backcalc_opts'><p>Back Calculation Options</p></a></li>
<li><a href='#bootstrapped_dist_fit'><p>Fit a Subsampled Bootstrap to Integer Values and Summarise Distribution</p>
Parameters</a></li>
<li><a href='#bound_dist'><p>Define bounds of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p></a></li>
<li><a href='#c.dist_spec'><p>Combines multiple delay distributions for further processing</p></a></li>
<li><a href='#calc_CrI'><p>Calculate Credible Interval</p></a></li>
<li><a href='#calc_CrIs'><p>Calculate Credible Intervals</p></a></li>
<li><a href='#calc_summary_measures'><p>Calculate All Summary Measures</p></a></li>
<li><a href='#calc_summary_stats'><p>Calculate Summary Statistics</p></a></li>
<li><a href='#check_generation_time'><p>Validate probability distribution for using as generation time</p></a></li>
<li><a href='#check_reports_valid'><p>Validate data input</p></a></li>
<li><a href='#check_sparse_pmf_tail'><p>Check that PMF tail is not sparse</p></a></li>
<li><a href='#check_stan_delay'><p>Validate probability distribution for passing to stan</p></a></li>
<li><a href='#clean_nowcasts'><p>Clean Nowcasts for a Supplied Date</p></a></li>
<li><a href='#clean_regions'><p>Clean Regions</p></a></li>
<li><a href='#collapse'><p>Collapse nonparametric distributions in a &lt;dist_spec&gt;</p></a></li>
<li><a href='#construct_output'><p>Construct Output</p></a></li>
<li><a href='#convert_to_logmean'><p>Convert mean and sd to log mean for a log normal distribution</p></a></li>
<li><a href='#convert_to_logsd'><p>Convert mean and sd to log standard deviation for a log normal distribution</p></a></li>
<li><a href='#convert_to_natural'><p>Internal function for converting parameters to natural parameters.</p></a></li>
<li><a href='#convolve_and_scale'><p>Convolve and scale a time series</p></a></li>
<li><a href='#copy_results_to_latest'><p>Copy Results From Dated Folder to Latest</p></a></li>
<li><a href='#create_backcalc_data'><p>Create Back Calculation Data</p></a></li>
<li><a href='#create_delay_inits'><p>Create initial conditions for delays</p></a></li>
<li><a href='#create_future_rt'><p>Construct the Required Future Rt assumption</p></a></li>
<li><a href='#create_gp_data'><p>Create Gaussian Process Data</p></a></li>
<li><a href='#create_initial_conditions'><p>Create Initial Conditions Generating Function</p></a></li>
<li><a href='#create_obs_model'><p>Create Observation Model Settings</p></a></li>
<li><a href='#create_rt_data'><p>Create Time-varying Reproduction Number Data</p></a></li>
<li><a href='#create_shifted_cases'><p>Create Delay Shifted Cases</p></a></li>
<li><a href='#create_stan_args'><p>Create a List of Stan Arguments</p></a></li>
<li><a href='#create_stan_data'><p>Create Stan Data Required for estimate_infections</p></a></li>
<li><a href='#create_stan_delays'><p>Create delay variables for stan</p></a></li>
<li><a href='#create_stan_params'><p>Create parameters for stan</p></a></li>
<li><a href='#default_fill_missing_obs'><p>Temporary function to support the transition to full support of missing</p>
data.</a></li>
<li><a href='#delay_opts'><p>Delay Distribution Options</p></a></li>
<li><a href='#discrete_pmf'><p>Discretised probability mass function</p></a></li>
<li><a href='#discretise'><p>Discretise a &lt;dist_spec&gt;</p></a></li>
<li><a href='#dist_fit'><p>Fit an Integer Adjusted Exponential, Gamma or Lognormal distributions</p></a></li>
<li><a href='#dist_skel'><p>Distribution Skeleton</p></a></li>
<li><a href='#Distributions'><p>Probability distributions</p></a></li>
<li><a href='#epinow'><p>Real-time Rt Estimation, Forecasting and Reporting</p></a></li>
<li><a href='#epinow2_cmdstan_model'><p>Load and compile an EpiNow2 cmdstanr model</p></a></li>
<li><a href='#epinow2_rstan_model'><p>Load an EpiNow2 rstan model.</p></a></li>
<li><a href='#epinow2_stan_model'><p>Return a stan model object for the appropriate backend</p></a></li>
<li><a href='#estimate_delay'><p>Estimate a Delay Distribution</p></a></li>
<li><a href='#estimate_infections'><p>Estimate Infections, the Time-Varying Reproduction Number and the Rate of</p>
Growth</a></li>
<li><a href='#estimate_secondary'><p>Estimate a Secondary Observation from a Primary Observation</p></a></li>
<li><a href='#estimate_truncation'><p>Estimate Truncation of Observed Data</p></a></li>
<li><a href='#estimates_by_report_date'><p>Estimate Cases by Report Date</p></a></li>
<li><a href='#example_confirmed'><p>Example Confirmed Case Data Set</p></a></li>
<li><a href='#example_generation_time'><p>Example generation time</p></a></li>
<li><a href='#example_incubation_period'><p>Example incubation period</p></a></li>
<li><a href='#example_reporting_delay'><p>Example reporting delay</p></a></li>
<li><a href='#example_truncated'><p>Example Case Data Set with Truncation</p></a></li>
<li><a href='#expose_stan_fns'><p>Expose internal package stan functions in R</p></a></li>
<li><a href='#extract_CrIs'><p>Extract Credible Intervals Present</p></a></li>
<li><a href='#extract_inits'><p>Generate initial conditions from a Stan fit</p></a></li>
<li><a href='#extract_parameter'><p>Extract Samples for a Parameter from a Stan model</p></a></li>
<li><a href='#extract_parameter_samples'><p>Extract Parameter Samples from a Stan Model</p></a></li>
<li><a href='#extract_params'><p>Extract parameter names</p></a></li>
<li><a href='#extract_samples'><p>Extract all samples from a stan fit</p></a></li>
<li><a href='#extract_single_dist'><p>Extract a single element of a composite <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p></a></li>
<li><a href='#extract_stan_param'><p>Extract a Parameter Summary from a Stan Object</p></a></li>
<li><a href='#extract_static_parameter'><p>Extract Samples from a Parameter with a Single Dimension</p></a></li>
<li><a href='#fill_missing'><p>Fill missing data in a data set to prepare it for use within the package</p></a></li>
<li><a href='#filter_leading_zeros'><p>Filter leading zeros from a data set.</p></a></li>
<li><a href='#filter_opts'><p>Filter Options for a Target Region</p></a></li>
<li><a href='#fit_model'><p>Fit a model using the chosen backend.</p></a></li>
<li><a href='#fit_model_approximate'><p>Fit a Stan Model using an approximate method</p></a></li>
<li><a href='#fit_model_with_nuts'><p>Fit a Stan Model using the NUTs sampler</p></a></li>
<li><a href='#fix_dist'><p>Remove uncertainty in the parameters of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p></a></li>
<li><a href='#fix_parameters'><p>Fix the parameters of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p></a></li>
<li><a href='#forecast_infections'><p>Forecast infections from a given fit and trajectory of the time-varying</p>
reproduction number</a></li>
<li><a href='#forecast_opts'><p>Forecast options</p></a></li>
<li><a href='#forecast_secondary'><p>Forecast Secondary Observations Given a Fit from estimate_secondary</p></a></li>
<li><a href='#format_fit'><p>Format Posterior Samples</p></a></li>
<li><a href='#get_distribution'><p>Get the distribution of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p></a></li>
<li><a href='#get_element'><p>Extracts an element of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p></a></li>
<li><a href='#get_parameters'><p>Get parameters of a parametric distribution</p></a></li>
<li><a href='#get_pmf'><p>Get the probability mass function of a nonparametric distribution</p></a></li>
<li><a href='#get_raw_result'><p>Get a Single Raw Result</p></a></li>
<li><a href='#get_regional_results'><p>Get Combined Regional Results</p></a></li>
<li><a href='#get_regions'><p>Get Folders with Results</p></a></li>
<li><a href='#get_regions_with_most_reports'><p>Get Regions with Most Reported Cases</p></a></li>
<li><a href='#get_seeding_time'><p>Estimate seeding time from delays and generation time</p></a></li>
<li><a href='#gp_opts'><p>Approximate Gaussian Process Settings</p></a></li>
<li><a href='#growth_to_R'><p>Convert Growth Rates to Reproduction numbers.</p></a></li>
<li><a href='#gt_opts'><p>Generation Time Distribution Options</p></a></li>
<li><a href='#is_constrained'><p>Check if a &lt;dist_spec&gt; is constrained, i.e. has a finite maximum or nonzero</p>
CDF cutoff.</a></li>
<li><a href='#lapply_func'><p>Choose a parallel or sequential apply function</p></a></li>
<li><a href='#lower_bounds'><p>Get the lower bounds of the parameters of a distribution</p></a></li>
<li><a href='#make_conf'><p>Format Credible Intervals</p></a></li>
<li><a href='#map_prob_change'><p>Categorise the Probability of Change for Rt</p></a></li>
<li><a href='#match_output_arguments'><p>Match User Supplied Arguments with Supported Options</p></a></li>
<li><a href='#max.dist_spec'><p>Returns the maximum of one or more delay distribution</p></a></li>
<li><a href='#mean.dist_spec'><p>Returns the mean of one or more delay distribution</p></a></li>
<li><a href='#natural_params'><p>Get the names of the natural parameters of a distribution</p></a></li>
<li><a href='#ndist'><p>Calculate the number of distributions in a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p></a></li>
<li><a href='#new_dist_spec'><p>Internal function for generating a <code>dist_spec</code> given parameters and a</p>
distribution.</a></li>
<li><a href='#obs_opts'><p>Observation Model Options</p></a></li>
<li><a href='#opts_list'><p>Forecast optiong</p></a></li>
<li><a href='#plot_CrIs'><p>Plot EpiNow2 Credible Intervals</p></a></li>
<li><a href='#plot_estimates'><p>Plot Estimates</p></a></li>
<li><a href='#plot_summary'><p>Plot a Summary of the Latest Results</p></a></li>
<li><a href='#plot.dist_spec'><p>Plot PMF and CDF for a dist_spec object</p></a></li>
<li><a href='#plot.epinow'><p>Plot method for epinow</p></a></li>
<li><a href='#plot.estimate_infections'><p>Plot method for estimate_infections</p></a></li>
<li><a href='#plot.estimate_secondary'><p>Plot method for estimate_secondary</p></a></li>
<li><a href='#plot.estimate_truncation'><p>Plot method for estimate_truncation</p></a></li>
<li><a href='#print.dist_spec'><p>Prints the parameters of one or more delay distributions</p></a></li>
<li><a href='#process_region'><p>Process regional estimate</p></a></li>
<li><a href='#process_regions'><p>Process all Region Estimates</p></a></li>
<li><a href='#R_to_growth'><p>Convert Reproduction Numbers to Growth Rates</p></a></li>
<li><a href='#regional_epinow'><p>Real-time Rt Estimation, Forecasting and Reporting by Region</p></a></li>
<li><a href='#regional_runtimes'><p>Summarise Regional Runtimes</p></a></li>
<li><a href='#regional_summary'><p>Regional Summary Output</p></a></li>
<li><a href='#report_plots'><p>Report plots</p></a></li>
<li><a href='#report_summary'><p>Provide Summary Statistics for Estimated Infections and Rt</p></a></li>
<li><a href='#rt_opts'><p>Time-Varying Reproduction Number Options</p></a></li>
<li><a href='#run_region'><p>Run epinow with Regional Processing Code</p></a></li>
<li><a href='#save_estimate_infections'><p>Save Estimated Infections</p></a></li>
<li><a href='#save_input'><p>Save Observed Data</p></a></li>
<li><a href='#sd'><p>Returns the standard deviation of one or more delay distribution</p></a></li>
<li><a href='#secondary_opts'><p>Secondary Reports Options</p></a></li>
<li><a href='#set_dt_single_thread'><p>Set to Single Threading</p></a></li>
<li><a href='#setup_default_logging'><p>Setup Default Logging</p></a></li>
<li><a href='#setup_dt'><p>Convert to Data Table</p></a></li>
<li><a href='#setup_future'><p>Set up Future Backend</p></a></li>
<li><a href='#setup_logging'><p>Setup Logging</p></a></li>
<li><a href='#setup_target_folder'><p>Setup Target Folder for Saving</p></a></li>
<li><a href='#simulate_infections'><p>Simulate infections using the renewal equation</p></a></li>
<li><a href='#simulate_secondary'><p>Simulate secondary observations from primary observations</p></a></li>
<li><a href='#stan_laplace_opts'><p>Stan Laplace algorithm Options</p></a></li>
<li><a href='#stan_opts'><p>Stan Options</p></a></li>
<li><a href='#stan_pathfinder_opts'><p>Stan pathfinder algorithm Options</p></a></li>
<li><a href='#stan_sampling_opts'><p>Stan Sampling Options</p></a></li>
<li><a href='#stan_vb_opts'><p>Stan Variational Bayes Options</p></a></li>
<li><a href='#summarise_key_measures'><p>Summarise rt and cases</p></a></li>
<li><a href='#summarise_results'><p>Summarise Real-time Results</p></a></li>
<li><a href='#summary.epinow'><p>Summary output from epinow</p></a></li>
<li><a href='#summary.estimate_infections'><p>Summary output from estimate_infections</p></a></li>
<li><a href='#trunc_opts'><p>Truncation Distribution Options</p></a></li>
<li><a href='#update_horizon'><p>Updates Forecast Horizon Based on Input Data and Target</p></a></li>
<li><a href='#update_secondary_args'><p>Update estimate_secondary default priors</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimate Real-Time Case Counts and Time-Varying Epidemiological
Parameters</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates the time-varying reproduction number,
    rate of spread, and doubling time using a range of open-source tools
    (Abbott et al. (2020) &lt;<a href="https://doi.org/10.12688%2Fwellcomeopenres.16006.1">doi:10.12688/wellcomeopenres.16006.1</a>&gt;), and
    current best practices (Gostic et al. (2020)
    &lt;<a href="https://doi.org/10.1101%2F2020.06.18.20134858">doi:10.1101/2020.06.18.20134858</a>&gt;).  It aims to help users avoid some
    of the limitations of naive implementations in a framework that is
    informed by community feedback and is actively supported.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://epiforecasts.io/EpiNow2/">https://epiforecasts.io/EpiNow2/</a>,
<a href="https://epiforecasts.io/EpiNow2/dev/">https://epiforecasts.io/EpiNow2/dev/</a>,
<a href="https://github.com/epiforecasts/EpiNow2">https://github.com/epiforecasts/EpiNow2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/epiforecasts/EpiNow2/issues">https://github.com/epiforecasts/EpiNow2/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, cli, data.table, futile.logger (&ge; 1.4), ggplot2,
lifecycle, lubridate, methods, patchwork, posterior, purrr,
R.utils (&ge; 2.0.0), Rcpp (&ge; 0.12.0), rlang (&ge; 0.4.7), rstan
(&ge; 2.26.0), rstantools (&ge; 2.2.0), runner, scales, stats,
truncnorm, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cmdstanr, covr, future, future.apply, here, knitr, precommit,
progressr, rmarkdown, spelling, testthat, usethis, withr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.26.0), StanHeaders (&ge;
2.26.0)</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://stan-dev.r-universe.dev">https://stan-dev.r-universe.dev</a></td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2.9000</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make C++17</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-19 16:50:44 UTC; eidesfun</td>
</tr>
<tr>
<td>Author:</td>
<td>Sam Abbott <a href="https://orcid.org/0000-0001-8057-8037"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Joel Hellewell <a href="https://orcid.org/0000-0003-2683-0849"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Katharine Sherratt [aut],
  Katelyn Gostic [aut],
  Joe Hickson [aut],
  Hamada S. Badr <a href="https://orcid.org/0000-0002-9808-2344"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Michael DeWitt <a href="https://orcid.org/0000-0001-8940-1967"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  James M. Azam <a href="https://orcid.org/0000-0001-5782-7330"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Robin Thompson [ctb],
  Sophie Meakin [ctb],
  James Munday [ctb],
  Nikos Bosse [ctb],
  Paul Mee [ctb],
  Peter Ellis [ctb],
  Pietro Monticone [ctb],
  Lloyd Chapman [ctb],
  Andrew Johnson [ctb],
  Kaitlyn Johnson <a href="https://orcid.org/0000-0001-8011-0012"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  EpiForecasts [aut],
  Sebastian Funk <a href="https://orcid.org/0000-0002-2842-3406"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastian Funk &lt;sebastian.funk@lshtm.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-19 23:40:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='EpiNow2-package'>EpiNow2: Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters</h2><span id='topic+EpiNow2'></span><span id='topic+EpiNow2-package'></span>

<h3>Description</h3>

<p>Estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools (Abbott et al. (2020) <a href="https://doi.org/10.12688/wellcomeopenres.16006.1">doi:10.12688/wellcomeopenres.16006.1</a>), and current best practices (Gostic et al. (2020) <a href="https://doi.org/10.1101/2020.06.18.20134858">doi:10.1101/2020.06.18.20134858</a>). It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is actively supported.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Sebastian Funk <a href="mailto:sebastian.funk@lshtm.ac.uk">sebastian.funk@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0002-2842-3406">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Sam Abbott <a href="mailto:sam.abbott@lshtm.ac.uk">sam.abbott@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-8057-8037">ORCID</a>)
</p>
</li>
<li><p> Joel Hellewell <a href="mailto:joel.hellewell@lshtm.ac.uk">joel.hellewell@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0003-2683-0849">ORCID</a>)
</p>
</li>
<li><p> Katharine Sherratt <a href="mailto:katharine.sherratt@lshtm.ac.uk">katharine.sherratt@lshtm.ac.uk</a>
</p>
</li>
<li><p> Katelyn Gostic <a href="mailto:kgostic@uchicago.edu">kgostic@uchicago.edu</a>
</p>
</li>
<li><p> Joe Hickson <a href="mailto:joseph.hickson@metoffice.gov.uk">joseph.hickson@metoffice.gov.uk</a>
</p>
</li>
<li><p> Hamada S. Badr <a href="mailto:badr@jhu.edu">badr@jhu.edu</a> (<a href="https://orcid.org/0000-0002-9808-2344">ORCID</a>)
</p>
</li>
<li><p> Michael DeWitt <a href="mailto:me.dewitt.jr@gmail.com">me.dewitt.jr@gmail.com</a> (<a href="https://orcid.org/0000-0001-8940-1967">ORCID</a>)
</p>
</li>
<li><p> James M. Azam <a href="mailto:james.azam@lshtm.ac.uk">james.azam@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5782-7330">ORCID</a>)
</p>
</li>
<li><p> EpiForecasts
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Robin Thompson <a href="mailto:robin.thompson@lshtm.ac.uk">robin.thompson@lshtm.ac.uk</a> [contributor]
</p>
</li>
<li><p> Sophie Meakin <a href="mailto:sophie.meaking@lshtm.ac.uk">sophie.meaking@lshtm.ac.uk</a> [contributor]
</p>
</li>
<li><p> James Munday <a href="mailto:james.munday@lshtm.ac.uk">james.munday@lshtm.ac.uk</a> [contributor]
</p>
</li>
<li><p> Nikos Bosse [contributor]
</p>
</li>
<li><p> Paul Mee <a href="mailto:paul.mee@lshtm.ac.uk">paul.mee@lshtm.ac.uk</a> [contributor]
</p>
</li>
<li><p> Peter Ellis <a href="mailto:peter.ellis2013nz@gmail.com">peter.ellis2013nz@gmail.com</a> [contributor]
</p>
</li>
<li><p> Pietro Monticone <a href="mailto:pietro.monticone@edu.unito.it">pietro.monticone@edu.unito.it</a> [contributor]
</p>
</li>
<li><p> Lloyd Chapman <a href="mailto:lloyd.chapman1@lshtm.ac.uk">lloyd.chapman1@lshtm.ac.uk</a> [contributor]
</p>
</li>
<li><p> Andrew Johnson <a href="mailto:andrew.johnson@arjohnsonau.com">andrew.johnson@arjohnsonau.com</a> [contributor]
</p>
</li>
<li><p> Kaitlyn Johnson <a href="mailto:johnsonkaitlyne9@gmail.com">johnsonkaitlyne9@gmail.com</a> (<a href="https://orcid.org/0000-0001-8011-0012">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://epiforecasts.io/EpiNow2/">https://epiforecasts.io/EpiNow2/</a>
</p>
</li>
<li> <p><a href="https://epiforecasts.io/EpiNow2/dev/">https://epiforecasts.io/EpiNow2/dev/</a>
</p>
</li>
<li> <p><a href="https://github.com/epiforecasts/EpiNow2">https://github.com/epiforecasts/EpiNow2</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/epiforecasts/EpiNow2/issues">https://github.com/epiforecasts/EpiNow2/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+2B.dist_spec'>Creates a delay distribution as the sum of two other delay distributions.</h2><span id='topic++2B.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
e1 + e2
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B2B.dist_spec_+3A_e1">e1</code></td>
<td>
<p>The first delay distribution (of type &lt;dist_spec&gt;) to
combine.</p>
</td></tr>
<tr><td><code id="+2B2B.dist_spec_+3A_e2">e2</code></td>
<td>
<p>The second delay distribution (of type &lt;dist_spec&gt;) to
combine.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A delay distribution representing the sum of the two delays
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A fixed lognormal distribution with mean 5 and sd 1.
dist1 &lt;- LogNormal(
  meanlog = 1.6, sdlog = 1, max = 20
)
dist1 + dist1

# An uncertain gamma distribution with shape and rate normally distributed
# as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- Gamma(
  shape = Normal(3, 0.5),
  rate = Normal(2, 0.5),
  max = 20
)
dist1 + dist2
</code></pre>

<hr>
<h2 id='+3D+3D.dist_spec'>Compares two delay distributions</h2><span id='topic++3D+3D.dist_spec'></span><span id='topic++21+3D.dist_spec'></span>

<h3>Description</h3>

<p>Compares two delay distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
e1 == e2

## S3 method for class 'dist_spec'
e1 != e2
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B3D+2B3D.dist_spec_+3A_e1">e1</code></td>
<td>
<p>The first delay distribution (of type &lt;dist_spec&gt;) to
combine.</p>
</td></tr>
<tr><td><code id="+2B3D+2B3D.dist_spec_+3A_e2">e2</code></td>
<td>
<p>The second delay distribution (of type &lt;dist_spec&gt;) to
combine.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE or FALSE
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Fixed(1) == Normal(1, 0.5)
</code></pre>

<hr>
<h2 id='add_breakpoints'>Add breakpoints to certain dates in a data set.</h2><span id='topic+add_breakpoints'></span>

<h3>Description</h3>

<p>Add breakpoints to certain dates in a data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_breakpoints(data, dates = as.Date(character(0)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_breakpoints_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="add_breakpoints_+3A_dates">dates</code></td>
<td>
<p>A vector of dates to use as breakpoints.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table with <code>breakpoint</code> set to 1 on each of the specified
dates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>reported_cases &lt;- add_breakpoints(example_confirmed, as.Date("2020-03-26"))
</code></pre>

<hr>
<h2 id='add_day_of_week'>Adds a day of the week vector</h2><span id='topic+add_day_of_week'></span>

<h3>Description</h3>

<p>Adds a day of the week vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_day_of_week(dates, week_effect = 7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_day_of_week_+3A_dates">dates</code></td>
<td>
<p>Vector of dates</p>
</td></tr>
<tr><td><code id="add_day_of_week_+3A_week_effect">week_effect</code></td>
<td>
<p>Numeric from 1 to 7 defaults to 7</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the period day of the week index
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dates &lt;- seq(as.Date("2020-03-15"), by = "days", length.out = 15)
# Add date based day of week
add_day_of_week(dates, 7)

# Add shorter week
add_day_of_week(dates, 4)

## End(Not run)
</code></pre>

<hr>
<h2 id='add_horizon'>Add missing values for future dates</h2><span id='topic+add_horizon'></span>

<h3>Description</h3>

<p>Add missing values for future dates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_horizon(data, horizon, accumulate = 1L, obs_column = "confirm", by = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_horizon_+3A_data">data</code></td>
<td>
<p>Data frame with a <code>date</code> column. The other columns depend on the
model that the data are to be used, e.g. <code><a href="#topic+estimate_infections">estimate_infections()</a></code> or
<code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>. See the documentation there for the expected
format.</p>
</td></tr>
<tr><td><code id="add_horizon_+3A_horizon">horizon</code></td>
<td>
<p>Deprecated; use <code>forecast</code> instead to specify the predictive
horizon</p>
</td></tr>
<tr><td><code id="add_horizon_+3A_accumulate">accumulate</code></td>
<td>
<p>The number of days to accumulate when generating posterior
prediction, e.g. 7 for weekly accumulated forecasts. If this is not set an
attempt will be made to detect the accumulation frequency in the data.</p>
</td></tr>
<tr><td><code id="add_horizon_+3A_obs_column">obs_column</code></td>
<td>
<p>Character (default: &quot;confirm&quot;). If given, only the column
specified here will be used for checking missingness. This is useful if
using a data set that has multiple columns of hwich one of them
corresponds to observations that are to be processed here.</p>
</td></tr>
<tr><td><code id="add_horizon_+3A_by">by</code></td>
<td>
<p>Character vector. Name(s) of any additional column(s) where
data processing should be done separately for each value in the column.
This is useful when using data representing e.g. multiple geographies. If
NULL (default) no such grouping is done.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table with missing values for future dates
</p>

<hr>
<h2 id='allocate_delays'>Allocate Delays into Required Stan Format</h2><span id='topic+allocate_delays'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Allocate delays for stan. Used in <code><a href="#topic+delay_opts">delay_opts()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allocate_delays(delay_var, no_delays)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="allocate_delays_+3A_delay_var">delay_var</code></td>
<td>
<p>List of numeric delays</p>
</td></tr>
<tr><td><code id="allocate_delays_+3A_no_delays">no_delays</code></td>
<td>
<p>Numeric, number of delays</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric array
</p>

<hr>
<h2 id='allocate_empty'>Allocate Empty Parameters to a List</h2><span id='topic+allocate_empty'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Allocate missing parameters to be empty two dimensional arrays. Used
internally by <code><a href="#topic+forecast_infections">forecast_infections()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allocate_empty(data, params, n = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="allocate_empty_+3A_data">data</code></td>
<td>
<p>A list of parameters</p>
</td></tr>
<tr><td><code id="allocate_empty_+3A_params">params</code></td>
<td>
<p>A character vector of parameters to allocate to
empty if missing.</p>
</td></tr>
<tr><td><code id="allocate_empty_+3A_n">n</code></td>
<td>
<p>Numeric, number of samples to assign an empty array</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of parameters some allocated to be empty
</p>

<hr>
<h2 id='apply_default_cdf_cutoff'>Apply default CDF cutoff to a &lt;dist_spec&gt; if it is unconstrained</h2><span id='topic+apply_default_cdf_cutoff'></span>

<h3>Description</h3>

<p>Apply default CDF cutoff to a &lt;dist_spec&gt; if it is unconstrained
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_default_cdf_cutoff(dist, default_cdf_cutoff, cdf_cutoff_set)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="apply_default_cdf_cutoff_+3A_dist">dist</code></td>
<td>
<p>A &lt;dist_spec&gt;</p>
</td></tr>
<tr><td><code id="apply_default_cdf_cutoff_+3A_default_cdf_cutoff">default_cdf_cutoff</code></td>
<td>
<p>Numeric; default CDF cutoff to be used if an
unconstrained distribution is passed as <code>dist</code>. If <code>dist</code> is already
constrained by having a maximum or CDF cutoff this is ignored. Note that
this can only be done for &lt;dist_spec&gt; objects with fixed parameters.</p>
</td></tr>
<tr><td><code id="apply_default_cdf_cutoff_+3A_cdf_cutoff_set">cdf_cutoff_set</code></td>
<td>
<p>Logical; whether the default CDF cutoff has been set by
the user; if yes and <code>dist</code> is constrained a warning is issued</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A &lt;dist_spec&gt; with the default CDF cutoff set if previously not
constrained
</p>

<hr>
<h2 id='apply_tolerance'>Applies a threshold to all nonparametric distributions in a &lt;dist_spec&gt;</h2><span id='topic+apply_tolerance'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
This function is deprecated. Use <code>bound_dist()</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_tolerance(x, tolerance)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="apply_tolerance_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="apply_tolerance_+3A_tolerance">tolerance</code></td>
<td>
<p>Numeric; the desired tolerance level. Any part of the
cumulative distribution function beyond 1 minus this tolerance level is
removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> where probability masses below the threshold level
have been removed
</p>

<hr>
<h2 id='apply_zero_threshold'>Convert zero case counts to <code>NA</code> (missing) if the 7-day average is above a
threshold.</h2><span id='topic+apply_zero_threshold'></span>

<h3>Description</h3>

<p>This function aims to detect spurious zeroes by comparing the 7-day average
of the case counts to a threshold. If the 7-day average is above the
threshold, the zero case count is replaced with <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_zero_threshold(data, threshold = Inf, obs_column = "confirm")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="apply_zero_threshold_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="apply_zero_threshold_+3A_threshold">threshold</code></td>
<td>
<p>Numeric, defaults to <code>Inf</code>. Indicates if detected zero
cases are meaningful by using a threshold number of cases based on the
7-day average. If the average is above this threshold at the time of a
zero observation count then the zero is replaced with a missing (<code>NA</code>)
count and thus ignored in the likelihood.</p>
</td></tr>
<tr><td><code id="apply_zero_threshold_+3A_obs_column">obs_column</code></td>
<td>
<p>Character (default: &quot;confirm&quot;). If given, only the column
specified here will be used for checking missingness. This is useful if
using a data set that has multiple columns of hwich one of them
corresponds to observations that are to be processed here.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table with the zero threshold applied.
</p>

<hr>
<h2 id='backcalc_opts'>Back Calculation Options</h2><span id='topic+backcalc_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Defines a list specifying the optional arguments for the back calculation
of cases. Only used if <code>rt = NULL</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backcalc_opts(
  prior = c("reports", "none", "infections"),
  prior_window = 14,
  rt_window = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backcalc_opts_+3A_prior">prior</code></td>
<td>
<p>A character string defaulting to &quot;reports&quot;. Defines the prior
to use when deconvolving. Currently implemented options are to use smoothed
mean delay shifted reported cases (&quot;reports&quot;), to use the estimated
infections from the previous time step seeded for the first time step using
mean shifted reported cases (&quot;infections&quot;), or no prior (&quot;none&quot;). Using no
prior will result in poor real time performance. No prior and using
infections are only supported when a Gaussian process is present . If
observed data is not reliable then it a sensible first step is to explore
increasing the <code>prior_window</code> wit a sensible second step being to no longer
use reported cases as a prior (i.e set <code>prior = "none"</code>).</p>
</td></tr>
<tr><td><code id="backcalc_opts_+3A_prior_window">prior_window</code></td>
<td>
<p>Integer, defaults to 14 days. The mean centred smoothing
window to apply to mean shifted reports (used as a prior during back
calculation). 7 days is minimum recommended settings as this smooths day of
the week effects but depending on the quality of the data and the amount of
information users wish to use as a prior (higher values equalling a less
informative prior).</p>
</td></tr>
<tr><td><code id="backcalc_opts_+3A_rt_window">rt_window</code></td>
<td>
<p>Integer, defaults to 1. The size of the centred rolling
average to use when estimating Rt. This must be odd so that the central
estimate is included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;backcalc_opts&gt;&#8288;</code> object of back calculation settings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default settings
backcalc_opts()
</code></pre>

<hr>
<h2 id='bootstrapped_dist_fit'>Fit a Subsampled Bootstrap to Integer Values and Summarise Distribution
Parameters</h2><span id='topic+bootstrapped_dist_fit'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Fits an integer adjusted distribution to a subsampled bootstrap of data and
then integrates the posterior samples into a single set of summary
statistics. Can be used to generate a robust reporting delay that accounts
for the fact the underlying delay likely varies over time or that the size
of the available reporting delay sample may not be representative of the
current case load.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrapped_dist_fit(
  values,
  dist = "lognormal",
  samples = 2000,
  bootstraps = 10,
  bootstrap_samples = 250,
  max_value,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootstrapped_dist_fit_+3A_values">values</code></td>
<td>
<p>Integer vector of values.</p>
</td></tr>
<tr><td><code id="bootstrapped_dist_fit_+3A_dist">dist</code></td>
<td>
<p>Character string, which distribution to fit. Defaults to
lognormal (<code>"lognormal"</code>) but gamma (<code>"gamma"</code>) is also supported.</p>
</td></tr>
<tr><td><code id="bootstrapped_dist_fit_+3A_samples">samples</code></td>
<td>
<p>Numeric, number of samples to take overall from the
bootstrapped posteriors.</p>
</td></tr>
<tr><td><code id="bootstrapped_dist_fit_+3A_bootstraps">bootstraps</code></td>
<td>
<p>Numeric, defaults to 1. The number of bootstrap samples
(with replacement) of the delay distribution to take. If <code>samples</code> is less
than <code>bootstraps</code>, <code>samples</code> takes the value of <code>bootstraps</code>.</p>
</td></tr>
<tr><td><code id="bootstrapped_dist_fit_+3A_bootstrap_samples">bootstrap_samples</code></td>
<td>
<p>Numeric, defaults to 250. The number of samples to
take in each bootstrap if the sample size of the supplied delay
distribution is less than its value.</p>
</td></tr>
<tr><td><code id="bootstrapped_dist_fit_+3A_max_value">max_value</code></td>
<td>
<p>Numeric, defaults to the maximum value in the observed
data. Maximum delay to  allow (added to output but does impact fitting).</p>
</td></tr>
<tr><td><code id="bootstrapped_dist_fit_+3A_verbose">verbose</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should progress messages be
printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> object summarising the bootstrapped distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# lognormal
delays &lt;- rlnorm(500, log(5), 1)
out &lt;- bootstrapped_dist_fit(delays,
  samples = 1000, bootstraps = 10,
  dist = "lognormal"
)
out

</code></pre>

<hr>
<h2 id='bound_dist'>Define bounds of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></h2><span id='topic+bound_dist'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This sets attributes for further processing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bound_dist(x, max = Inf, cdf_cutoff = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bound_dist_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code>.</p>
</td></tr>
<tr><td><code id="bound_dist_+3A_max">max</code></td>
<td>
<p>Numeric, maximum value of the distribution. The distribution will
be truncated at this value. Default: <code>Inf</code>, i.e. no maximum.</p>
</td></tr>
<tr><td><code id="bound_dist_+3A_cdf_cutoff">cdf_cutoff</code></td>
<td>
<p>Numeric; the desired CDF cutoff. Any part of the
cumulative distribution function beyond 1 minus the value of this argument is
removed. Default: <code>0</code>, i.e. use the full distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> with relevant attributes set that define its bounds
</p>

<hr>
<h2 id='c.dist_spec'>Combines multiple delay distributions for further processing</h2><span id='topic+c.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This combines the parameters so that they can be fed as multiple delay
distributions to <code><a href="#topic+epinow">epinow()</a></code> or <code><a href="#topic+estimate_infections">estimate_infections()</a></code>.
</p>
<p>Note that distributions that already are combinations of other distributions
cannot be combined with other combinations of distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
c(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="c.dist_spec_+3A_...">...</code></td>
<td>
<p>The delay distributions to combine</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Combined delay distributions (with class <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A fixed lognormal distribution with mean 5 and sd 1.
dist1 &lt;- LogNormal(
  meanlog = 1.6, sdlog = 1, max = 20
)
dist1 + dist1

# An uncertain gamma distribution with shape and rate normally distributed
# as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- Gamma(
  shape = Normal(3, 0.5),
  rate = Normal(2, 0.5),
  max = 20
)
c(dist1, dist2)
</code></pre>

<hr>
<h2 id='calc_CrI'>Calculate Credible Interval</h2><span id='topic+calc_CrI'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Adds symmetric a credible interval based on quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_CrI(samples, summarise_by = NULL, CrI = 0.9)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_CrI_+3A_samples">samples</code></td>
<td>
<p>A data.table containing at least a value variable</p>
</td></tr>
<tr><td><code id="calc_CrI_+3A_summarise_by">summarise_by</code></td>
<td>
<p>A character vector of variables to group by.</p>
</td></tr>
<tr><td><code id="calc_CrI_+3A_cri">CrI</code></td>
<td>
<p>Numeric between 0 and 1. The credible interval for which to
return values. Defaults to 0.9.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table containing the upper and lower bounds for the specified
credible interval.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samples &lt;- data.frame(value = 1:10, type = "car")
# add 90% credible interval
calc_CrI(samples)
# add 90% credible interval grouped by type
calc_CrI(samples, summarise_by = "type")
</code></pre>

<hr>
<h2 id='calc_CrIs'>Calculate Credible Intervals</h2><span id='topic+calc_CrIs'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Adds symmetric credible intervals based on quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_CrIs(samples, summarise_by = NULL, CrIs = c(0.2, 0.5, 0.9))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_CrIs_+3A_samples">samples</code></td>
<td>
<p>A data.table containing at least a value variable</p>
</td></tr>
<tr><td><code id="calc_CrIs_+3A_summarise_by">summarise_by</code></td>
<td>
<p>A character vector of variables to group by.</p>
</td></tr>
<tr><td><code id="calc_CrIs_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table containing the <code>summarise_by</code> variables and the
specified lower and upper credible intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samples &lt;- data.frame(value = 1:10, type = "car")
# add credible intervals
calc_CrIs(samples)
# add 90% credible interval grouped by type
calc_CrIs(samples, summarise_by = "type")
</code></pre>

<hr>
<h2 id='calc_summary_measures'>Calculate All Summary Measures</h2><span id='topic+calc_summary_measures'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Calculate summary statistics and credible intervals from a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> by
group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_summary_measures(
  samples,
  summarise_by = NULL,
  order_by = NULL,
  CrIs = c(0.2, 0.5, 0.9)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_summary_measures_+3A_samples">samples</code></td>
<td>
<p>A data.table containing at least a value variable</p>
</td></tr>
<tr><td><code id="calc_summary_measures_+3A_summarise_by">summarise_by</code></td>
<td>
<p>A character vector of variables to group by.</p>
</td></tr>
<tr><td><code id="calc_summary_measures_+3A_order_by">order_by</code></td>
<td>
<p>A character vector of parameters to order by, defaults to
all <code>summarise_by</code> variables.</p>
</td></tr>
<tr><td><code id="calc_summary_measures_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table containing summary statistics by group.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samples &lt;- data.frame(value = 1:10, type = "car")
# default
calc_summary_measures(samples)
#  by type
calc_summary_measures(samples, summarise_by = "type")
</code></pre>

<hr>
<h2 id='calc_summary_stats'>Calculate Summary Statistics</h2><span id='topic+calc_summary_stats'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Calculate summary statistics from a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> by group.
Currently supports the mean, median and standard deviation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_summary_stats(samples, summarise_by = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_summary_stats_+3A_samples">samples</code></td>
<td>
<p>A data.table containing at least a value variable</p>
</td></tr>
<tr><td><code id="calc_summary_stats_+3A_summarise_by">summarise_by</code></td>
<td>
<p>A character vector of variables to group by.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table containing the upper and lower bounds for the specified
credible interval
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samples &lt;- data.frame(value = 1:10, type = "car")
# default
calc_summary_stats(samples)
#  by type
calc_summary_stats(samples, summarise_by = "type")
</code></pre>

<hr>
<h2 id='check_generation_time'>Validate probability distribution for using as generation time</h2><span id='topic+check_generation_time'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
does all the checks in<code>check_stan_delay()</code> and additionally makes sure
that if <code>dist</code> is nonparametric,  its first element is zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_generation_time(dist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_generation_time_+3A_dist">dist</code></td>
<td>
<p>A <code>dist_spec</code> object.'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects.
</p>

<hr>
<h2 id='check_reports_valid'>Validate data input</h2><span id='topic+check_reports_valid'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
<code>check_reports_valid()</code> checks that the supplied data is a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>,
and that it has the right column names and types. In particular, it checks
that the date column is in date format and does not contain NAs, and that
the other columns are numeric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_reports_valid(
  data,
  model = c("estimate_infections", "estimate_secondary")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_reports_valid_+3A_data">data</code></td>
<td>
<p>A data frame with either:
</p>

<ul>
<li><p> a minimum of two columns: <code>date</code> and <code>confirm</code>, if to be
used by <code><a href="#topic+estimate_infections">estimate_infections()</a></code> or <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code>, or
</p>
</li>
<li><p> a minimum of three columns: <code>date</code>, <code>primary</code>, and <code>secondary</code>, if to be
used by <code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="check_reports_valid_+3A_model">model</code></td>
<td>
<p>The EpiNow2 model to be used. Either
&quot;estimate_infections&quot;, &quot;estimate_truncation&quot;, or &quot;estimate_secondary&quot;.
This is used to determine which checks to perform on the data input.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects.
</p>

<hr>
<h2 id='check_sparse_pmf_tail'>Check that PMF tail is not sparse</h2><span id='topic+check_sparse_pmf_tail'></span>

<h3>Description</h3>

<p>Checks if the tail of a PMF vector has more than <code>span</code>
consecutive values smaller than <code>tol</code> and throws a warning if so.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_sparse_pmf_tail(pmf, span = 5, tol = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_sparse_pmf_tail_+3A_pmf">pmf</code></td>
<td>
<p>A probability mass function vector</p>
</td></tr>
<tr><td><code id="check_sparse_pmf_tail_+3A_span">span</code></td>
<td>
<p>The number of consecutive indices in the tail to check</p>
</td></tr>
<tr><td><code id="check_sparse_pmf_tail_+3A_tol">tol</code></td>
<td>
<p>The value which to consider the tail as sparse</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects.
</p>

<hr>
<h2 id='check_stan_delay'>Validate probability distribution for passing to stan</h2><span id='topic+check_stan_delay'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
<code>check_stan_delay()</code> checks that the supplied data is a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code>,
that it is a supported distribution, and that is has a finite maximum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_stan_delay(dist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_stan_delay_+3A_dist">dist</code></td>
<td>
<p>A <code>dist_spec</code> object.'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects.
</p>

<hr>
<h2 id='clean_nowcasts'>Clean Nowcasts for a Supplied Date</h2><span id='topic+clean_nowcasts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
This function removes nowcasts in the format produced by <code>EpiNow2</code> from a
target directory for the date supplied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_nowcasts(date = Sys.Date(), nowcast_dir = ".")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clean_nowcasts_+3A_date">date</code></td>
<td>
<p>Date object. Defaults to today's date</p>
</td></tr>
<tr><td><code id="clean_nowcasts_+3A_nowcast_dir">nowcast_dir</code></td>
<td>
<p>Character string giving the filepath to the nowcast
results directory. Defaults to the current directory.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='clean_regions'>Clean Regions</h2><span id='topic+clean_regions'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Removes regions with insufficient time points, and provides logging
information on the input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_regions(data, non_zero_points)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clean_regions_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date
(date), and region (<code>region</code>).</p>
</td></tr>
<tr><td><code id="clean_regions_+3A_non_zero_points">non_zero_points</code></td>
<td>
<p>Numeric, the minimum number of time points with
non-zero cases in a region required for that region to be evaluated.
Defaults to 7.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of cleaned regional data
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regional_epinow">regional_epinow()</a></code>
</p>

<hr>
<h2 id='collapse'>Collapse nonparametric distributions in a &lt;dist_spec&gt;</h2><span id='topic+collapse'></span><span id='topic+collapse.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This convolves any consecutive nonparametric distributions contained
in the &lt;dist_spec&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
collapse(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="collapse_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="collapse_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> where consecutive nonparametric distributions
have been convolved
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A fixed gamma distribution with mean 5 and sd 1.
dist1 &lt;- Gamma(mean = 5, sd = 1, max = 20)

# An uncertain lognormal distribution with meanlog and sdlog normally
# distributed as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- LogNormal(
  meanlog = Normal(3, 0.5),
  sdlog = Normal(2, 0.5),
  max = 20
)

# The maxf the sum of two distributions
collapse(discretise(dist1 + dist2, strict = FALSE))
</code></pre>

<hr>
<h2 id='construct_output'>Construct Output</h2><span id='topic+construct_output'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Combines the output produced internally by <code>epinow</code> into a single list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>construct_output(
  estimates,
  estimated_reported_cases,
  plots = NULL,
  summary = NULL,
  samples = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="construct_output_+3A_estimates">estimates</code></td>
<td>
<p>List of data frames as output by <code>estimate_infections</code></p>
</td></tr>
<tr><td><code id="construct_output_+3A_estimated_reported_cases">estimated_reported_cases</code></td>
<td>
<p>A list of dataframes as produced by
<code>estimates_by_report_date</code>.</p>
</td></tr>
<tr><td><code id="construct_output_+3A_plots">plots</code></td>
<td>
<p>A list of plots as produced by <code>report_plots</code>.</p>
</td></tr>
<tr><td><code id="construct_output_+3A_summary">summary</code></td>
<td>
<p>A list of summary output as produced by <code>report_summary</code>.</p>
</td></tr>
<tr><td><code id="construct_output_+3A_samples">samples</code></td>
<td>
<p>Logical, defaults to TRUE. Should samples be saved</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of output as returned by <code>epinow</code>
</p>

<hr>
<h2 id='convert_to_logmean'>Convert mean and sd to log mean for a log normal distribution</h2><span id='topic+convert_to_logmean'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Convert from mean and standard deviation to the log mean of the
lognormal distribution. Useful for defining distributions supported by
<code><a href="#topic+estimate_infections">estimate_infections()</a></code>, <code><a href="#topic+epinow">epinow()</a></code>, and <code><a href="#topic+regional_epinow">regional_epinow()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_to_logmean(mean, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_to_logmean_+3A_mean">mean</code></td>
<td>
<p>Numeric, mean of a distribution</p>
</td></tr>
<tr><td><code id="convert_to_logmean_+3A_sd">sd</code></td>
<td>
<p>Numeric, standard deviation of a distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The log mean of a lognormal distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
convert_to_logmean(2, 1)
</code></pre>

<hr>
<h2 id='convert_to_logsd'>Convert mean and sd to log standard deviation for a log normal distribution</h2><span id='topic+convert_to_logsd'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Convert from mean and standard deviation to the log standard deviation of the
lognormal distribution. Useful for defining distributions supported by
<code><a href="#topic+estimate_infections">estimate_infections()</a></code>, <code><a href="#topic+epinow">epinow()</a></code>, and <code><a href="#topic+regional_epinow">regional_epinow()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_to_logsd(mean, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_to_logsd_+3A_mean">mean</code></td>
<td>
<p>Numeric, mean of a distribution</p>
</td></tr>
<tr><td><code id="convert_to_logsd_+3A_sd">sd</code></td>
<td>
<p>Numeric, standard deviation of a distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The log standard deviation of a lognormal distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
convert_to_logsd(2, 1)
</code></pre>

<hr>
<h2 id='convert_to_natural'>Internal function for converting parameters to natural parameters.</h2><span id='topic+convert_to_natural'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This is used for preprocessing before generating a <code>dist_spec</code> object
from a given set of parameters and distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_to_natural(params, distribution)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_to_natural_+3A_params">params</code></td>
<td>
<p>A numerical named parameter vector</p>
</td></tr>
<tr><td><code id="convert_to_natural_+3A_distribution">distribution</code></td>
<td>
<p>Character; the distribution to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements, <code>params_mean</code> and <code>params_sd</code>, containing
mean and sd of natural parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
convert_to_natural(
  params = list(mean = 2, sd = 1),
  distribution = "gamma"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='convolve_and_scale'>Convolve and scale a time series</h2><span id='topic+convolve_and_scale'></span>

<h3>Description</h3>

<p>This applies a lognormal convolution with given, potentially time-varying
parameters representing the parameters of the lognormal distribution used for
the convolution and an optional scaling factor. This is akin to the model
used in <code><a href="#topic+estimate_secondary">estimate_secondary()</a></code> and <code><a href="#topic+simulate_secondary">simulate_secondary()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convolve_and_scale(
  data,
  type = c("incidence", "prevalence"),
  family = c("none", "poisson", "negbin"),
  delay_max = 30,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convolve_and_scale_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing the <code>date</code> of report and <code>primary</code>
cases as a numeric vector.</p>
</td></tr>
<tr><td><code id="convolve_and_scale_+3A_type">type</code></td>
<td>
<p>A character string indicating the type of observation the
secondary reports are. Options include:
</p>

<ul>
<li><p> &quot;incidence&quot;: Assumes that secondary reports equal a convolution of
previously observed primary reported cases. An example application is deaths
from an infectious disease predicted by reported cases of that disease (or
estimated infections).
</p>
</li>
<li><p> &quot;prevalence&quot;: Assumes that secondary reports are cumulative and are
defined by currently observed primary reports minus a convolution of
secondary reports. An example application is hospital bed usage predicted by
hospital admissions.
</p>
</li></ul>
</td></tr>
<tr><td><code id="convolve_and_scale_+3A_family">family</code></td>
<td>
<p>Character string defining the observation model. Options are
Negative binomial (&quot;negbin&quot;), the default, Poisson (&quot;poisson&quot;), and &quot;none&quot;
meaning the expectation is returned.</p>
</td></tr>
<tr><td><code id="convolve_and_scale_+3A_delay_max">delay_max</code></td>
<td>
<p>Integer, defaulting to 30 days. The maximum delay used in
the convolution model.</p>
</td></tr>
<tr><td><code id="convolve_and_scale_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to the observation model (i.e
<code>rnbinom</code> or <code>rpois</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Up to version 1.4.0 this function was called <code><a href="#topic+simulate_secondary">simulate_secondary()</a></code>.
</p>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing simulated data in the format required by
<code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>.
</p>


<h3>See Also</h3>

<p>estimate_secondary
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data.table for manipulation
library(data.table)

#### Incidence data example ####

# make some example secondary incidence data
cases &lt;- example_confirmed
cases &lt;- as.data.table(cases)[, primary := confirm]

# Assume that only 40 percent of cases are reported
cases[, scaling := 0.4]

# Parameters of the assumed log normal delay distribution
cases[, meanlog := 1.8][, sdlog := 0.5]

# Simulate secondary cases
cases &lt;- convolve_and_scale(cases, type = "incidence")
cases
#### Prevalence data example ####

# make some example prevalence data
cases &lt;- example_confirmed
cases &lt;- as.data.table(cases)[, primary := confirm]

# Assume that only 30 percent of cases are reported
cases[, scaling := 0.3]

# Parameters of the assumed log normal delay distribution
cases[, meanlog := 1.6][, sdlog := 0.8]

# Simulate secondary cases
cases &lt;- convolve_and_scale(cases, type = "prevalence")
cases
</code></pre>

<hr>
<h2 id='copy_results_to_latest'>Copy Results From Dated Folder to Latest</h2><span id='topic+copy_results_to_latest'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
Copies output from the dated folder to a latest folder. May be undergo
changes in later releases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_results_to_latest(target_folder = NULL, latest_folder = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="copy_results_to_latest_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="copy_results_to_latest_+3A_latest_folder">latest_folder</code></td>
<td>
<p>Character string containing the path to the latest
target folder. As produced by <code>setup_target_folder</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='create_backcalc_data'>Create Back Calculation Data</h2><span id='topic+create_backcalc_data'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Takes the output of <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code> and converts it into a list understood
by stan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_backcalc_data(backcalc = backcalc_opts())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_backcalc_data_+3A_backcalc">backcalc</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code> to
define the back calculation. Defaults to <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of settings defining the Gaussian process
</p>


<h3>See Also</h3>

<p>backcalc_opts
</p>

<hr>
<h2 id='create_delay_inits'>Create initial conditions for delays</h2><span id='topic+create_delay_inits'></span>

<h3>Description</h3>

<p>Create initial conditions for delays
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_delay_inits(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_delay_inits_+3A_data">data</code></td>
<td>
<p>A list of data as produced by <code><a href="#topic+create_stan_data">create_stan_data()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of initial conditions for delays
</p>

<hr>
<h2 id='create_future_rt'>Construct the Required Future Rt assumption</h2><span id='topic+create_future_rt'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Converts the <code>future</code> argument from <code><a href="#topic+rt_opts">rt_opts()</a></code> into arguments that can be
passed to stan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_future_rt(future = c("latest", "project", "estimate"), delay = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_future_rt_+3A_future">future</code></td>
<td>
<p>A character string or integer. This argument indicates how to
set future Rt values. Supported options are to project using the Rt model
(&quot;project&quot;), to use the latest estimate based on partial data (&quot;latest&quot;),
to use the latest estimate based on data that is over 50% complete
(&quot;estimate&quot;). If an integer is supplied then the Rt estimate from this many
days into the future (or past if negative) past will be used forwards in
time.</p>
</td></tr>
<tr><td><code id="create_future_rt_+3A_delay">delay</code></td>
<td>
<p>Numeric mean delay</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing a logical called fixed and an integer called from
</p>

<hr>
<h2 id='create_gp_data'>Create Gaussian Process Data</h2><span id='topic+create_gp_data'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Takes the output of <code><a href="#topic+gp_opts">gp_opts()</a></code> and converts it into a list understood by
stan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_gp_data(gp = gp_opts(), data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_gp_data_+3A_gp">gp</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+gp_opts">gp_opts()</a></code> to define the
Gaussian process. Defaults to <code><a href="#topic+gp_opts">gp_opts()</a></code>. Set to <code>NULL</code> to disable the
Gaussian process.</p>
</td></tr>
<tr><td><code id="create_gp_data_+3A_data">data</code></td>
<td>
<p>A list containing the following numeric values:
<code>t</code>, <code>seeding_time</code>, <code>horizon</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of settings defining the Gaussian process
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gp_opts">gp_opts()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# define input data required
data &lt;- list(
  t = 30,
  seeding_time = 7,
  horizon = 7
)

# default gaussian process data
create_gp_data(data = data)

# settings when no gaussian process is desired
create_gp_data(NULL, data)

# custom lengthscale
create_gp_data(gp_opts(ls_mean = 14), data)

## End(Not run)
</code></pre>

<hr>
<h2 id='create_initial_conditions'>Create Initial Conditions Generating Function</h2><span id='topic+create_initial_conditions'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Uses the output of <code><a href="#topic+create_stan_data">create_stan_data()</a></code> to create a function which can be
used to sample from the prior distributions (or as close as possible) for
parameters. Used in order to initialise each stan chain within a range of
plausible values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_initial_conditions(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_initial_conditions_+3A_data">data</code></td>
<td>
<p>A list of data as produced by <code><a href="#topic+create_stan_data">create_stan_data()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An initial condition generating function
</p>

<hr>
<h2 id='create_obs_model'>Create Observation Model Settings</h2><span id='topic+create_obs_model'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Takes the output of <code><a href="#topic+obs_opts">obs_opts()</a></code> and converts it into a list understood
by stan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_obs_model(obs = obs_opts(), dates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_obs_model_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="create_obs_model_+3A_dates">dates</code></td>
<td>
<p>A vector of dates used to calculate the day of the week.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of settings ready to be passed to stan defining
the Observation Model
</p>


<h3>See Also</h3>

<p><code><a href="#topic+obs_opts">obs_opts()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dates &lt;- seq(as.Date("2020-03-15"), by = "days", length.out = 15)
# default observation model data
create_obs_model(dates = dates)

# Poisson observation model
create_obs_model(obs_opts(family = "poisson"), dates = dates)

# Applying a observation scaling to the data
create_obs_model(
  obs_opts(scale = Normal(mean = 0.4, sd = 0.01)),
  dates = dates
)

# Apply a custom week week length
create_obs_model(obs_opts(week_length = 3), dates = dates)

## End(Not run)
</code></pre>

<hr>
<h2 id='create_rt_data'>Create Time-varying Reproduction Number Data</h2><span id='topic+create_rt_data'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Takes the output from <code><a href="#topic+rt_opts">rt_opts()</a></code> and converts it into a list understood by
stan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_rt_data(rt = rt_opts(), breakpoints = NULL, delay = 0, horizon = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_rt_data_+3A_rt">rt</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+rt_opts">rt_opts()</a></code> defining Rt
estimation. Defaults to <code><a href="#topic+rt_opts">rt_opts()</a></code>. To generate new infections using
the non-mechanistic model instead of the renewal equation model, use
<code>rt = NULL</code>. The non-mechanistic model internally uses the setting
<code>rt = rt_opts(use_rt = FALSE, future = "project", gp_on = "R0")</code>.</p>
</td></tr>
<tr><td><code id="create_rt_data_+3A_breakpoints">breakpoints</code></td>
<td>
<p>An integer vector (binary) indicating the location of
breakpoints.</p>
</td></tr>
<tr><td><code id="create_rt_data_+3A_delay">delay</code></td>
<td>
<p>Numeric mean delay</p>
</td></tr>
<tr><td><code id="create_rt_data_+3A_horizon">horizon</code></td>
<td>
<p>Numeric, forecast horizon.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of settings defining the time-varying reproduction number
</p>


<h3>See Also</h3>

<p>rt_settings
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# default Rt data
create_rt_data()

# settings when no Rt is desired
create_rt_data(rt = NULL)

# using breakpoints
create_rt_data(rt_opts(use_breakpoints = TRUE), breakpoints = rep(1, 10))

# using random walk
create_rt_data(rt_opts(rw = 7), breakpoints = rep(1, 10))

## End(Not run)
</code></pre>

<hr>
<h2 id='create_shifted_cases'>Create Delay Shifted Cases</h2><span id='topic+create_shifted_cases'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This functions creates a data frame of reported cases that has been smoothed
using a centred partial rolling average (with a period set by
<code>smoothing_window</code>) and shifted back in time by some delay. It is used by
<code><a href="#topic+estimate_infections">estimate_infections()</a></code> to generate the mean shifted prior on which the back
calculation method (see <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code>) is based.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_shifted_cases(data, shift, smoothing_window, horizon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_shifted_cases_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="create_shifted_cases_+3A_shift">shift</code></td>
<td>
<p>Numeric, mean delay shift to apply.</p>
</td></tr>
<tr><td><code id="create_shifted_cases_+3A_smoothing_window">smoothing_window</code></td>
<td>
<p>Numeric, the rolling average smoothing window
to apply. Must be odd in order to be defined as a centred average.</p>
</td></tr>
<tr><td><code id="create_shifted_cases_+3A_horizon">horizon</code></td>
<td>
<p>Deprecated; use <code>forecast</code> instead to specify the predictive
horizon</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first shifts all the data back in time by <code>shift</code> days (thus
discarding the first <code>shift</code> days of data) and then applies a centred
rolling mean of length <code>smoothing_window</code> to the shifted data except for
the final period. The final period (the forecast horizon plus half the
smoothing window) is instead replaced by a log-linear model fit (with 1
added to the data for fitting to avoid zeroes and later subtracted again),
projected to the end of the forecast horizon. The initial part of the data
(corresponding to the length of the smoothing window) is then removed, and
any non-integer resulting values rounded up.
</p>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> for shifted reported cases
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
shift &lt;- 7
horizon &lt;- 7
smoothing_window &lt;- 14
## add NAs for horizon
cases &lt;- add_horizon(example_confirmed[1:30], horizon)
## add zeroes initially
cases &lt;- data.table::rbindlist(list(
  data.table::data.table(
    date = seq(
      min(cases$date) - 10,
      min(cases$date) - 1,
      by = "days"
    ),
    confirm = 0, breakpoint = 0
  ),
  cases
))
create_shifted_cases(cases, shift, smoothing_window, horizon)

## End(Not run)
</code></pre>

<hr>
<h2 id='create_stan_args'>Create a List of Stan Arguments</h2><span id='topic+create_stan_args'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Generates a list of arguments as required by the stan sampling functions by
combining the required options with data, and type of initialisation.
Initialisation defaults to random but it is expected that
<code><a href="#topic+create_initial_conditions">create_initial_conditions()</a></code> will be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_stan_args(
  stan = stan_opts(),
  data = NULL,
  init = "random",
  model = "estimate_infections",
  fixed_param = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_stan_args_+3A_stan">stan</code></td>
<td>
<p>A list of stan options as generated by <code><a href="#topic+stan_opts">stan_opts()</a></code>. Defaults
to <code><a href="#topic+stan_opts">stan_opts()</a></code>. Can be used to override <code>data</code>, <code>init</code>, and <code>verbose</code>
settings if desired.</p>
</td></tr>
<tr><td><code id="create_stan_args_+3A_data">data</code></td>
<td>
<p>A list of stan data as created by <code><a href="#topic+create_stan_data">create_stan_data()</a></code></p>
</td></tr>
<tr><td><code id="create_stan_args_+3A_init">init</code></td>
<td>
<p>Initial conditions passed to <code>{rstan}</code>. Defaults to &quot;random&quot;
(initial values randomly drawn between -2 and 2) but can also be a
function (as supplied by <code><a href="#topic+create_initial_conditions">create_initial_conditions()</a></code>).</p>
</td></tr>
<tr><td><code id="create_stan_args_+3A_model">model</code></td>
<td>
<p>Character, name of the model for which arguments are
to be created.</p>
</td></tr>
<tr><td><code id="create_stan_args_+3A_fixed_param">fixed_param</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should arguments be
created to sample from fixed parameters (used by simulation functions).</p>
</td></tr>
<tr><td><code id="create_stan_args_+3A_verbose">verbose</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should verbose progress
messages be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of stan arguments
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# default settings
create_stan_args()

# increasing warmup
create_stan_args(stan = stan_opts(warmup = 1000))

## End(Not run)
</code></pre>

<hr>
<h2 id='create_stan_data'>Create Stan Data Required for estimate_infections</h2><span id='topic+create_stan_data'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Takes the output of <code><a href="#topic+stan_opts">stan_opts()</a></code> and converts it into a list understood by
stan. Internally calls the other <code>create_</code> family of functions to
construct a single list for input into stan with all data required
present.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_stan_data(
  data,
  seeding_time,
  rt,
  gp,
  obs,
  backcalc,
  shifted_cases,
  forecast
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_stan_data_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="create_stan_data_+3A_seeding_time">seeding_time</code></td>
<td>
<p>Integer; seeding time, usually obtained using
<code><a href="#topic+get_seeding_time">get_seeding_time()</a></code>.</p>
</td></tr>
<tr><td><code id="create_stan_data_+3A_rt">rt</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+rt_opts">rt_opts()</a></code> defining Rt
estimation. Defaults to <code><a href="#topic+rt_opts">rt_opts()</a></code>. To generate new infections using
the non-mechanistic model instead of the renewal equation model, use
<code>rt = NULL</code>. The non-mechanistic model internally uses the setting
<code>rt = rt_opts(use_rt = FALSE, future = "project", gp_on = "R0")</code>.</p>
</td></tr>
<tr><td><code id="create_stan_data_+3A_gp">gp</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+gp_opts">gp_opts()</a></code> to define the
Gaussian process. Defaults to <code><a href="#topic+gp_opts">gp_opts()</a></code>. Set to <code>NULL</code> to disable the
Gaussian process.</p>
</td></tr>
<tr><td><code id="create_stan_data_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="create_stan_data_+3A_backcalc">backcalc</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code> to
define the back calculation. Defaults to <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="create_stan_data_+3A_shifted_cases">shifted_cases</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of delay shifted cases</p>
</td></tr>
<tr><td><code id="create_stan_data_+3A_forecast">forecast</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+forecast_opts">forecast_opts()</a></code> defining
the forecast opitions. Defaults to <code><a href="#topic+forecast_opts">forecast_opts()</a></code>. If NULL then no
forecasting will be done.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of stan data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
create_stan_data(
  example_confirmed, 7, rt_opts(), gp_opts(), obs_opts(), 7,
  backcalc_opts(), create_shifted_cases(example_confirmed, 7, 14, 7)
)

## End(Not run)
</code></pre>

<hr>
<h2 id='create_stan_delays'>Create delay variables for stan</h2><span id='topic+create_stan_delays'></span>

<h3>Description</h3>

<p>Create delay variables for stan
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_stan_delays(..., time_points = 1L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_stan_delays_+3A_...">...</code></td>
<td>
<p>Named delay distributions. The names are assigned to IDs</p>
</td></tr>
<tr><td><code id="create_stan_delays_+3A_time_points">time_points</code></td>
<td>
<p>Integer, the number of time points in the data;
determines weight associated with weighted delay priors; default: 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of variables as expected by the stan model
</p>

<hr>
<h2 id='create_stan_params'>Create parameters for stan</h2><span id='topic+create_stan_params'></span>

<h3>Description</h3>

<p>Create parameters for stan
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_stan_params(..., lower_bounds = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_stan_params_+3A_...">...</code></td>
<td>
<p>Named delay distributions. The names are assigned to IDs</p>
</td></tr>
<tr><td><code id="create_stan_params_+3A_lower_bounds">lower_bounds</code></td>
<td>
<p>Named vector of lower bounds for any delay(s). The names
have to correspond to the names given to the delay distributions passed.
If <code>NULL</code> (default) no parameters are given a lower bound.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of variables as expected by the stan model
</p>

<hr>
<h2 id='default_fill_missing_obs'>Temporary function to support the transition to full support of missing
data.</h2><span id='topic+default_fill_missing_obs'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_fill_missing_obs(data, obs, obs_column)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="default_fill_missing_obs_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="default_fill_missing_obs_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="default_fill_missing_obs_+3A_obs_column">obs_column</code></td>
<td>
<p>Character (default: &quot;confirm&quot;). If given, only the column
specified here will be used for checking missingness. This is useful if
using a data set that has multiple columns of hwich one of them
corresponds to observations that are to be processed here.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data set with missing dates filled in as na values
</p>

<hr>
<h2 id='delay_opts'>Delay Distribution Options</h2><span id='topic+delay_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Returns delay distributions formatted for usage by downstream
functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delay_opts(dist = Fixed(0), default_cdf_cutoff = 0.001, weight_prior = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="delay_opts_+3A_dist">dist</code></td>
<td>
<p>A delay distribution or series of delay distributions. Default is
a fixed distribution with all mass at 0, i.e. no delay.</p>
</td></tr>
<tr><td><code id="delay_opts_+3A_default_cdf_cutoff">default_cdf_cutoff</code></td>
<td>
<p>Numeric; default CDF cutoff to be used if an
unconstrained distribution is passed as <code>dist</code>. If <code>dist</code> is already
constrained by having a maximum or CDF cutoff this is ignored. Note that
this can only be done for &lt;dist_spec&gt; objects with fixed parameters.</p>
</td></tr>
<tr><td><code id="delay_opts_+3A_weight_prior">weight_prior</code></td>
<td>
<p>Logical; if TRUE (default), any priors given in <code>dist</code>
will be weighted by the number of observation data points, in doing so
approximately placing an independent prior at each time step and usually
preventing the posteriors from shifting. If FALSE, no weight
will be applied, i.e. any parameters in <code>dist</code> will be treated as a single
parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;delay_opts&gt;&#8288;</code> object summarising the input delay distributions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_to_logmean">convert_to_logmean()</a></code> <code><a href="#topic+convert_to_logsd">convert_to_logsd()</a></code>
<code><a href="#topic+bootstrapped_dist_fit">bootstrapped_dist_fit()</a></code> <code><a href="#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># no delays
delay_opts()

# A single delay that has uncertainty
delay &lt;- LogNormal(
  meanlog = Normal(1, 0.2),
  sdlog = Normal(0.5, 0.1),
  max = 14
)
delay_opts(delay)

# A single delay without uncertainty
delay &lt;- LogNormal(meanlog = 1, sdlog = 0.5, max = 14)
delay_opts(delay)

# Multiple delays (in this case twice the same)
delay_opts(delay + delay)
</code></pre>

<hr>
<h2 id='discrete_pmf'>Discretised probability mass function</h2><span id='topic+discrete_pmf'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
This function returns the probability mass function of a discretised and
truncated distribution defined by distribution type, maximum value and model
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete_pmf(
  distribution = c("exp", "gamma", "lognormal", "normal", "fixed"),
  params,
  max_value,
  cdf_cutoff,
  width
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="discrete_pmf_+3A_distribution">distribution</code></td>
<td>
<p>A character string representing the distribution to be
used (one of &quot;exp&quot;, &quot;gamma&quot;, &quot;lognormal&quot;, &quot;normal&quot; or &quot;fixed&quot;)</p>
</td></tr>
<tr><td><code id="discrete_pmf_+3A_params">params</code></td>
<td>
<p>A list of parameters values (by name) required for each model.
For the exponential model this is a rate parameter and for the gamma model
this is alpha and beta.</p>
</td></tr>
<tr><td><code id="discrete_pmf_+3A_max_value">max_value</code></td>
<td>
<p>Numeric, the maximum value to allow.
Samples outside of this range are resampled.</p>
</td></tr>
<tr><td><code id="discrete_pmf_+3A_cdf_cutoff">cdf_cutoff</code></td>
<td>
<p>Numeric; the desired CDF cutoff. Any part of the
cumulative distribution function beyond 1 minus the value of this argument is
removed. Default: <code>0</code>, i.e. use the full distribution.</p>
</td></tr>
<tr><td><code id="discrete_pmf_+3A_width">width</code></td>
<td>
<p>Numeric, the width of each discrete bin.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector representing a probability distribution.
</p>


<h3>Methodological details</h3>

<p>The probability mass function of the discretised probability distribution is
a vector where the first entry corresponds to the integral over the (0,1]
interval of the corresponding continuous distribution (probability of
integer 0), the second entry corresponds to the (0,2] interval (probability
mass of integer 1), the third entry corresponds to the (1, 3] interval
(probability mass of integer 2), etc. This approximates the true
probability mass function of a double censored distribution which arises
from the difference of two censored events.
</p>


<h3>References</h3>

<p>Charniga, K., et al. Best practices for estimating and reporting
epidemiological delay distributions of infectious diseases using public
health surveillance and healthcare data, <em>arXiv e-prints</em>, 2024.
<a href="https://doi.org/10.48550/arXiv.2405.08841">doi:10.48550/arXiv.2405.08841</a>
Park,  S. W.,  et al.,  &quot;Estimating epidemiological delay distributions for
infectious diseases&quot;, <em>medRxiv</em>, 2024.
<a href="https://doi.org/10.1101/2024.01.12.24301247">doi:10.1101/2024.01.12.24301247</a>
</p>

<hr>
<h2 id='discretise'>Discretise a &lt;dist_spec&gt;</h2><span id='topic+discretise'></span><span id='topic+discretise.dist_spec'></span><span id='topic+discretize'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
discretise(x, strict = TRUE, ...)

discretize(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="discretise_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="discretise_+3A_strict">strict</code></td>
<td>
<p>Logical; If <code>TRUE</code> (default) an error will be thrown if a
distribution cannot be discretised (e.g., because no finite maximum has been
specified or parameters are uncertain). If <code>FALSE</code> then any distribution
that cannot be discretised will be returned as is.</p>
</td></tr>
<tr><td><code id="discretise_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> where all distributions with constant parameters are
nonparametric.
</p>


<h3>Methodological details</h3>

<p>The probability mass function of the discretised probability distribution is
a vector where the first entry corresponds to the integral over the (0,1]
interval of the corresponding continuous distribution (probability of
integer 0), the second entry corresponds to the (0,2] interval (probability
mass of integer 1), the third entry corresponds to the (1, 3] interval
(probability mass of integer 2), etc. This approximates the true
probability mass function of a double censored distribution which arises
from the difference of two censored events.
</p>


<h3>References</h3>

<p>Charniga, K., et al. Best practices for estimating and reporting
epidemiological delay distributions of infectious diseases using public
health surveillance and healthcare data, <em>arXiv e-prints</em>, 2024.
<a href="https://doi.org/10.48550/arXiv.2405.08841">doi:10.48550/arXiv.2405.08841</a>
Park,  S. W.,  et al.,  &quot;Estimating epidemiological delay distributions for
infectious diseases&quot;, <em>medRxiv</em>, 2024.
<a href="https://doi.org/10.1101/2024.01.12.24301247">doi:10.1101/2024.01.12.24301247</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A fixed gamma distribution with mean 5 and sd 1.
dist1 &lt;- Gamma(mean = 5, sd = 1, max = 20)

# An uncertain lognormal distribution with meanlog and sdlog normally
# distributed as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- LogNormal(
  meanlog = Normal(3, 0.5),
  sdlog = Normal(2, 0.5),
  max = 20
)

# The maxf the sum of two distributions
discretise(dist1 + dist2, strict = FALSE)
</code></pre>

<hr>
<h2 id='dist_fit'>Fit an Integer Adjusted Exponential, Gamma or Lognormal distributions</h2><span id='topic+dist_fit'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Fits an integer adjusted exponential, gamma or lognormal distribution using
stan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_fit(
  values = NULL,
  samples = 1000,
  cores = 1,
  chains = 2,
  dist = "exp",
  verbose = FALSE,
  backend = "rstan"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_fit_+3A_values">values</code></td>
<td>
<p>Numeric vector of values</p>
</td></tr>
<tr><td><code id="dist_fit_+3A_samples">samples</code></td>
<td>
<p>Numeric, number of samples to take. Must be &gt;= 1000.
Defaults to 1000.</p>
</td></tr>
<tr><td><code id="dist_fit_+3A_cores">cores</code></td>
<td>
<p>Numeric, defaults to 1. Number of CPU cores to use (no effect
if greater than the number of chains).</p>
</td></tr>
<tr><td><code id="dist_fit_+3A_chains">chains</code></td>
<td>
<p>Numeric, defaults to 2. Number of MCMC chains to use. More is
better with the minimum being two.</p>
</td></tr>
<tr><td><code id="dist_fit_+3A_dist">dist</code></td>
<td>
<p>Character string, which distribution to fit. Defaults to
exponential (<code>"exp"</code>) but gamma (<code>"gamma"</code>) and lognormal (<code>"lognormal"</code>) are
also supported.</p>
</td></tr>
<tr><td><code id="dist_fit_+3A_verbose">verbose</code></td>
<td>
<p>Logical, defaults to FALSE. Should verbose progress messages
be printed.</p>
</td></tr>
<tr><td><code id="dist_fit_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A stan fit of an interval censored distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# integer adjusted exponential model
dist_fit(rexp(1:100, 2),
  samples = 1000, dist = "exp",
  cores = ifelse(interactive(), 4, 1), verbose = TRUE
)


# integer adjusted gamma model
dist_fit(rgamma(1:100, 5, 5),
  samples = 1000, dist = "gamma",
  cores = ifelse(interactive(), 4, 1), verbose = TRUE
)

# integer adjusted lognormal model
dist_fit(rlnorm(1:100, log(5), 0.2),
  samples = 1000, dist = "lognormal",
  cores = ifelse(interactive(), 4, 1), verbose = TRUE
)

</code></pre>

<hr>
<h2 id='dist_skel'>Distribution Skeleton</h2><span id='topic+dist_skel'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
This function acts as a skeleton for a truncated distribution defined by
model type, maximum value and model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_skel(
  n,
  dist = FALSE,
  cum = TRUE,
  model,
  discrete = FALSE,
  params,
  max_value = 120
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_skel_+3A_n">n</code></td>
<td>
<p>Numeric vector, number of samples to take (or days for the
probability density).</p>
</td></tr>
<tr><td><code id="dist_skel_+3A_dist">dist</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should the probability density be
returned rather than a number of samples.</p>
</td></tr>
<tr><td><code id="dist_skel_+3A_cum">cum</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code>. If <code>dist = TRUE</code> should the returned
distribution be cumulative.</p>
</td></tr>
<tr><td><code id="dist_skel_+3A_model">model</code></td>
<td>
<p>Character string, defining the model to be used. Supported
options are exponential (&quot;exp&quot;), gamma (&quot;gamma&quot;), and log normal
(&quot;lognormal&quot;)</p>
</td></tr>
<tr><td><code id="dist_skel_+3A_discrete">discrete</code></td>
<td>
<p>Logical,  defaults to <code>FALSE</code>. Should the probability
distribution be discretised. In this case each entry of the probability
mass function corresponds to the 2-length interval ending at the entry
except for the first interval that covers (0, 1).  That is, the probability
mass function is a vector where the first entry corresponds to the integral
over the (0,1] interval of the continuous distribution, the second entry
corresponds to the (0,2] interval, the third entry corresponds to the (1,
3] interval etc.</p>
</td></tr>
<tr><td><code id="dist_skel_+3A_params">params</code></td>
<td>
<p>A list of parameters values (by name) required for each model.
For the exponential model this is a rate parameter and for the gamma model
this is alpha and beta.</p>
</td></tr>
<tr><td><code id="dist_skel_+3A_max_value">max_value</code></td>
<td>
<p>Numeric, the maximum value to allow. Defaults to 120.
Samples outside of this range are resampled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of samples or a probability distribution.
</p>

<hr>
<h2 id='Distributions'>Probability distributions</h2><span id='topic+Distributions'></span><span id='topic+LogNormal'></span><span id='topic+Gamma'></span><span id='topic+Normal'></span><span id='topic+Fixed'></span><span id='topic+NonParametric'></span>

<h3>Description</h3>

<p>Probability distributions
</p>
<p>Generates a nonparametric distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LogNormal(meanlog, sdlog, mean, sd, ...)

Gamma(shape, rate, scale, mean, sd, ...)

Normal(mean, sd, ...)

Fixed(value, ...)

NonParametric(pmf, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Distributions_+3A_meanlog">meanlog</code>, <code id="Distributions_+3A_sdlog">sdlog</code></td>
<td>
<p>mean and standard deviation of the distribution
on the log scale with default values of <code>0</code> and <code>1</code> respectively.</p>
</td></tr>
<tr><td><code id="Distributions_+3A_mean">mean</code>, <code id="Distributions_+3A_sd">sd</code></td>
<td>
<p>mean and standard deviation of the distribution</p>
</td></tr>
<tr><td><code id="Distributions_+3A_...">...</code></td>
<td>
<p>arguments to define the limits of the distribution that will be
passed to <code><a href="#topic+bound_dist">bound_dist()</a></code></p>
</td></tr>
<tr><td><code id="Distributions_+3A_shape">shape</code>, <code id="Distributions_+3A_scale">scale</code></td>
<td>
<p>shape and scale parameters.  Must be positive,
<code>scale</code> strictly.</p>
</td></tr>
<tr><td><code id="Distributions_+3A_rate">rate</code></td>
<td>
<p>an alternative way to specify the scale.</p>
</td></tr>
<tr><td><code id="Distributions_+3A_value">value</code></td>
<td>
<p>Value of the fixed (delta) distribution</p>
</td></tr>
<tr><td><code id="Distributions_+3A_pmf">pmf</code></td>
<td>
<p>Probability mass of the given distribution; this is
passed as a zero-indexed numeric vector (i.e. the fist entry represents
the probability mass of zero). If not summing to one it will be normalised
to sum to one internally.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Probability distributions are ubiquitous in EpiNow2, usually representing
epidemiological delays (e.g., the generation time for delays between
becoming infecting and infecting others; or reporting delays)
</p>
<p>They are generated using functions that have a name corresponding to the
probability distribution that is being used. They generated <code>dist_spec</code>
objects that are then passed to the models underlying EpiNow2.
All parameters can be given either as fixed values (a numeric value) or as
uncertain values (a <code>dist_sepc</code>). If given as uncertain values, currently
only normally distributed parameters (generated using <code>Normal()</code>) are
supported.
</p>
<p>Each distribution has a representation in terms of &quot;natural&quot; parameters (the
ones used in stan) but can sometimes also be specified using other
parameters such as the mean or standard deviation of the distribution. If
not given as natural parameters then these will be calculated from the given
parameters. If they have uncertainty, this will be done by random sampling
from the given uncertainty and converting resulting parameters to their
natural representation.
</p>
<p>Currently available distributions are lognormal, gamma, normal, fixed
(delta) and nonparametric. The nonparametric is a special case where the
probability mass function is given directly as a numeric vector.
</p>


<h3>Value</h3>

<p>A <code>dist_spec</code> representing a distribution of the given
specification.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>LogNormal(mean = 4, sd = 1)
LogNormal(mean = 4, sd = 1, max = 10)
# If specifying uncertain parameters, use the natural parameters
LogNormal(meanlog = Normal(1.5, 0.5), sdlog = 0.25, max = 10)
Gamma(mean = 4, sd = 1)
Gamma(shape = 16, rate = 4)
Gamma(shape = Normal(16, 2), rate = Normal(4, 1))
Normal(mean = 4, sd = 1)
Normal(mean = 4, sd = 1, max = 10)
Fixed(value = 3)
Fixed(value = 3.5)
NonParametric(c(0.1, 0.3, 0.2, 0.4))
NonParametric(c(0.1, 0.3, 0.2, 0.1, 0.1))
</code></pre>

<hr>
<h2 id='epinow'>Real-time Rt Estimation, Forecasting and Reporting</h2><span id='topic+epinow'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
This function wraps the functionality of <code><a href="#topic+estimate_infections">estimate_infections()</a></code> in order
to estimate Rt and cases by date of infection and forecast these infections
into the future. In addition to the functionality of
<code><a href="#topic+estimate_infections">estimate_infections()</a></code> it produces additional summary output useful for
reporting results and interpreting them as well as error catching and
reporting, making it particularly useful for production use e.g. running at
set intervals on a dedicated server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epinow(
  data,
  generation_time = gt_opts(),
  delays = delay_opts(),
  truncation = trunc_opts(),
  rt = rt_opts(),
  backcalc = backcalc_opts(),
  gp = gp_opts(),
  obs = obs_opts(),
  forecast = forecast_opts(),
  stan = stan_opts(),
  CrIs = c(0.2, 0.5, 0.9),
  return_output = is.null(target_folder),
  output = c("samples", "plots", "latest", "fit", "timing"),
  plot_args = list(),
  target_folder = NULL,
  target_date,
  logs = tempdir(),
  id = "epinow",
  verbose = interactive(),
  filter_leading_zeros = TRUE,
  zero_threshold = Inf,
  horizon
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epinow_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="epinow_+3A_generation_time">generation_time</code></td>
<td>
<p>A call to <code><a href="#topic+gt_opts">gt_opts()</a></code> (or its alias
<code><a href="#topic+generation_time_opts">generation_time_opts()</a></code>) defining the generation time distribution used.
For backwards compatibility a list of summary parameters can also be passed.</p>
</td></tr>
<tr><td><code id="epinow_+3A_delays">delays</code></td>
<td>
<p>A call to <code><a href="#topic+delay_opts">delay_opts()</a></code> defining delay distributions and
options. See the documentation of <code><a href="#topic+delay_opts">delay_opts()</a></code> and the examples below for
details.</p>
</td></tr>
<tr><td><code id="epinow_+3A_truncation">truncation</code></td>
<td>
<p>A call to <code><a href="#topic+trunc_opts">trunc_opts()</a></code> defining the truncation of
the observed data. Defaults to <code><a href="#topic+trunc_opts">trunc_opts()</a></code>, i.e. no truncation.  See the
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> help file for an approach to estimating this from
data where the <code>dist</code> list element returned by <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> is
used as the <code>truncation</code> argument here, thereby propagating the uncertainty
in the estimate.</p>
</td></tr>
<tr><td><code id="epinow_+3A_rt">rt</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+rt_opts">rt_opts()</a></code> defining Rt
estimation. Defaults to <code><a href="#topic+rt_opts">rt_opts()</a></code>. To generate new infections using
the non-mechanistic model instead of the renewal equation model, use
<code>rt = NULL</code>. The non-mechanistic model internally uses the setting
<code>rt = rt_opts(use_rt = FALSE, future = "project", gp_on = "R0")</code>.</p>
</td></tr>
<tr><td><code id="epinow_+3A_backcalc">backcalc</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code> to
define the back calculation. Defaults to <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="epinow_+3A_gp">gp</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+gp_opts">gp_opts()</a></code> to define the
Gaussian process. Defaults to <code><a href="#topic+gp_opts">gp_opts()</a></code>. Set to <code>NULL</code> to disable the
Gaussian process.</p>
</td></tr>
<tr><td><code id="epinow_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="epinow_+3A_forecast">forecast</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+forecast_opts">forecast_opts()</a></code> defining
the forecast opitions. Defaults to <code><a href="#topic+forecast_opts">forecast_opts()</a></code>. If NULL then no
forecasting will be done.</p>
</td></tr>
<tr><td><code id="epinow_+3A_stan">stan</code></td>
<td>
<p>A list of stan options as generated by <code><a href="#topic+stan_opts">stan_opts()</a></code>. Defaults
to <code><a href="#topic+stan_opts">stan_opts()</a></code>. Can be used to override <code>data</code>, <code>init</code>, and <code>verbose</code>
settings if desired.</p>
</td></tr>
<tr><td><code id="epinow_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="epinow_+3A_return_output">return_output</code></td>
<td>
<p>Logical, defaults to FALSE. Should output be returned,
this automatically updates to TRUE if no directory for saving is specified.</p>
</td></tr>
<tr><td><code id="epinow_+3A_output">output</code></td>
<td>
<p>A character vector of optional output to return. Supported
options are samples (&quot;samples&quot;), plots (&quot;plots&quot;), the run time (&quot;timing&quot;),
copying the dated folder into a latest folder (if <code>target_folder</code> is not
null, set using &quot;latest&quot;), and the stan fit (&quot;fit&quot;). The default is to
return all options.</p>
</td></tr>
<tr><td><code id="epinow_+3A_plot_args">plot_args</code></td>
<td>
<p>A list of optional arguments passed to <code><a href="#topic+plot.epinow">plot.epinow()</a></code>.</p>
</td></tr>
<tr><td><code id="epinow_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="epinow_+3A_target_date">target_date</code></td>
<td>
<p>Date, defaults to maximum found in the data if not
specified.</p>
</td></tr>
<tr><td><code id="epinow_+3A_logs">logs</code></td>
<td>
<p>Character path indicating the target folder in which to store log
information. Defaults to the temporary directory if not specified. Default
logging can be disabled if <code>logs</code> is set to NULL. If specifying a custom
logging setup then the code for <code><a href="#topic+setup_default_logging">setup_default_logging()</a></code> and the
<code><a href="#topic+setup_logging">setup_logging()</a></code> function are a sensible place to start.</p>
</td></tr>
<tr><td><code id="epinow_+3A_id">id</code></td>
<td>
<p>A character string used to assign logging information on error.
Used by <code><a href="#topic+regional_epinow">regional_epinow()</a></code> to assign errors to regions. Alter the default to
run with error catching.</p>
</td></tr>
<tr><td><code id="epinow_+3A_verbose">verbose</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code> when used interactively and
otherwise <code>FALSE</code>. Should verbose debug progress messages be printed.
Corresponds to the &quot;DEBUG&quot; level from <code>futile.logger</code>. See <code>setup_logging</code>
for more detailed logging options.</p>
</td></tr>
<tr><td><code id="epinow_+3A_filter_leading_zeros">filter_leading_zeros</code></td>
<td>
<p>Logical, defaults to TRUE. Should zeros at the
start of the time series be filtered out.</p>
</td></tr>
<tr><td><code id="epinow_+3A_zero_threshold">zero_threshold</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a> Numeric defaults
to Inf. Indicates if detected zero cases are meaningful by using a threshold
number of cases based on the 7-day average. If the average is above this
threshold then the zero is replaced using <code>fill</code>.</p>
</td></tr>
<tr><td><code id="epinow_+3A_horizon">horizon</code></td>
<td>
<p>Deprecated; use <code>forecast</code> instead to specify the predictive
horizon</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of output from estimate_infections with additional elements
summarising results and reporting errors if they have occurred.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estimate_infections">estimate_infections()</a></code> <code><a href="#topic+forecast_infections">forecast_infections()</a></code> <code><a href="#topic+regional_epinow">regional_epinow()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# set number of cores to use
old_opts &lt;- options()
options(mc.cores = ifelse(interactive(), 4, 1))

# set an example generation time. In practice this should use an estimate
# from the literature or be estimated from data
generation_time &lt;- Gamma(
  shape = Normal(1.3, 0.3),
  rate = Normal(0.37, 0.09),
  max = 14
)
# set an example incubation period. In practice this should use an estimate
# from the literature or be estimated from data
incubation_period &lt;- LogNormal(
  meanlog = Normal(1.6, 0.06),
  sdlog = Normal(0.4, 0.07),
  max = 14
)
# set an example reporting delay. In practice this should use an estimate
# from the literature or be estimated from data
reporting_delay &lt;- LogNormal(mean = 2, sd = 1, max = 10)

# example case data
reported_cases &lt;- example_confirmed[1:40]

# estimate Rt and nowcast/forecast cases by date of infection
out &lt;- epinow(
  data = reported_cases,
  generation_time = gt_opts(generation_time),
  rt = rt_opts(prior = LogNormal(mean = 2, sd = 0.1)),
  delays = delay_opts(incubation_period + reporting_delay)
)
# summary of the latest estimates
summary(out)
# plot estimates
plot(out)

# summary of R estimates
summary(out, type = "parameters", params = "R")

options(old_opts)

</code></pre>

<hr>
<h2 id='epinow2_cmdstan_model'>Load and compile an EpiNow2 cmdstanr model</h2><span id='topic+epinow2_cmdstan_model'></span>

<h3>Description</h3>

<p>The function has been adapted from a similar function in the epinowcast
package (Copyright holder: epinowcast authors, under MIT License).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epinow2_cmdstan_model(
  model = "estimate_infections",
  dir = system.file("stan", package = "EpiNow2"),
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epinow2_cmdstan_model_+3A_model">model</code></td>
<td>
<p>A character string indicating the model to use. Needs to be
present in <code>dir</code> (with extension <code>.stan</code>). Defaults to &quot;estimate_infections&quot;.</p>
</td></tr>
<tr><td><code id="epinow2_cmdstan_model_+3A_dir">dir</code></td>
<td>
<p>A character string specifying the path to any stan
files to include in the model. If missing the package default is used.</p>
</td></tr>
<tr><td><code id="epinow2_cmdstan_model_+3A_verbose">verbose</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code>. Should verbose
messages be shown.</p>
</td></tr>
<tr><td><code id="epinow2_cmdstan_model_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="cmdstanr.html#topic+cmdstan_model">cmdstanr::cmdstan_model()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>cmdstanr</code> model.
</p>

<hr>
<h2 id='epinow2_rstan_model'>Load an EpiNow2 rstan model.</h2><span id='topic+epinow2_rstan_model'></span>

<h3>Description</h3>

<p>The models are pre-compiled upon package install and is returned here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epinow2_rstan_model(model = "estimate_infections")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epinow2_rstan_model_+3A_model">model</code></td>
<td>
<p>A character string indicating the model to use. Needs to be
amongst the compiled models shipped with &quot;EpiNow2&quot; (see the <code>stan</code> directory
for a list). Defaults to &quot;estimate_infections&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>rstan</code> model.
</p>

<hr>
<h2 id='epinow2_stan_model'>Return a stan model object for the appropriate backend</h2><span id='topic+epinow2_stan_model'></span>

<h3>Description</h3>

<p>Return a stan model object for the appropriate backend
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epinow2_stan_model(
  backend = c("rstan", "cmdstanr"),
  model = c("estimate_infections", "simulate_infections", "estimate_secondary",
    "simulate_secondary", "estimate_truncation", "dist_fit")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epinow2_stan_model_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
<tr><td><code id="epinow2_stan_model_+3A_model">model</code></td>
<td>
<p>A character string indicating the model to use. One of
&quot;estimate_infections&quot; (default), &quot;simulate_infections&quot;,
&quot;estimate_secondary&quot;, &quot;simulate_secondary&quot;, &quot;estimate_truncation&quot; or
&quot;dist_fit&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A stan model object (either <code>rstan::stanmodel</code> or
<code>cmdstanr::CmdStanModel</code>, depending on the backend)
</p>

<hr>
<h2 id='estimate_delay'>Estimate a Delay Distribution</h2><span id='topic+estimate_delay'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Estimate a log normal delay distribution from a vector of integer delays.
Currently this function is a simple wrapper for <code><a href="#topic+bootstrapped_dist_fit">bootstrapped_dist_fit()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_delay(delays, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_delay_+3A_delays">delays</code></td>
<td>
<p>Integer vector of delays</p>
</td></tr>
<tr><td><code id="estimate_delay_+3A_...">...</code></td>
<td>
<p>Arguments to pass to internal methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> summarising the bootstrapped distribution
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootstrapped_dist_fit">bootstrapped_dist_fit()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
delays &lt;- rlnorm(500, log(5), 1)
estimate_delay(delays, samples = 1000, bootstraps = 10)

</code></pre>

<hr>
<h2 id='estimate_infections'>Estimate Infections, the Time-Varying Reproduction Number and the Rate of
Growth</h2><span id='topic+estimate_infections'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Uses a non-parametric approach to reconstruct cases by date of infection
from reported cases. It uses either a generative Rt model or non-parametric
back calculation to estimate underlying latent infections and then maps
these infections to observed cases via uncertain reporting delays and a
flexible observation model. See the examples and function arguments for the
details of all options. The default settings may not be sufficient for your
use case so the number of warmup samples (<code>stan_args = list(warmup)</code>) may
need to be increased as may the overall number of samples. Follow the links
provided by any warnings messages to diagnose issues with the MCMC fit. It
is recommended to explore several of the Rt estimation approaches supported
as not all of them may be suited to users own use cases. See
<a href="https://gist.github.com/seabbs/163d0f195892cde685c70473e1f5e867">here</a>
for an example of using <code>estimate_infections</code> within the <code>epinow</code> wrapper to
estimate Rt for Covid-19 in a country from the ECDC data source.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_infections(
  data,
  generation_time = gt_opts(),
  delays = delay_opts(),
  truncation = trunc_opts(),
  rt = rt_opts(),
  backcalc = backcalc_opts(),
  gp = gp_opts(),
  obs = obs_opts(),
  forecast = forecast_opts(),
  stan = stan_opts(),
  CrIs = c(0.2, 0.5, 0.9),
  weigh_delay_priors = TRUE,
  id = "estimate_infections",
  verbose = interactive(),
  filter_leading_zeros = TRUE,
  zero_threshold = Inf,
  horizon
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_infections_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_generation_time">generation_time</code></td>
<td>
<p>A call to <code><a href="#topic+gt_opts">gt_opts()</a></code> (or its alias
<code><a href="#topic+generation_time_opts">generation_time_opts()</a></code>) defining the generation time distribution used.
For backwards compatibility a list of summary parameters can also be passed.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_delays">delays</code></td>
<td>
<p>A call to <code><a href="#topic+delay_opts">delay_opts()</a></code> defining delay distributions and
options. See the documentation of <code><a href="#topic+delay_opts">delay_opts()</a></code> and the examples below for
details.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_truncation">truncation</code></td>
<td>
<p>A call to <code><a href="#topic+trunc_opts">trunc_opts()</a></code> defining the truncation of
the observed data. Defaults to <code><a href="#topic+trunc_opts">trunc_opts()</a></code>, i.e. no truncation.  See the
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> help file for an approach to estimating this from
data where the <code>dist</code> list element returned by <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> is
used as the <code>truncation</code> argument here, thereby propagating the uncertainty
in the estimate.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_rt">rt</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+rt_opts">rt_opts()</a></code> defining Rt
estimation. Defaults to <code><a href="#topic+rt_opts">rt_opts()</a></code>. To generate new infections using
the non-mechanistic model instead of the renewal equation model, use
<code>rt = NULL</code>. The non-mechanistic model internally uses the setting
<code>rt = rt_opts(use_rt = FALSE, future = "project", gp_on = "R0")</code>.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_backcalc">backcalc</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code> to
define the back calculation. Defaults to <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_gp">gp</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+gp_opts">gp_opts()</a></code> to define the
Gaussian process. Defaults to <code><a href="#topic+gp_opts">gp_opts()</a></code>. Set to <code>NULL</code> to disable the
Gaussian process.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_forecast">forecast</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+forecast_opts">forecast_opts()</a></code> defining
the forecast opitions. Defaults to <code><a href="#topic+forecast_opts">forecast_opts()</a></code>. If NULL then no
forecasting will be done.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_stan">stan</code></td>
<td>
<p>A list of stan options as generated by <code><a href="#topic+stan_opts">stan_opts()</a></code>. Defaults
to <code><a href="#topic+stan_opts">stan_opts()</a></code>. Can be used to override <code>data</code>, <code>init</code>, and <code>verbose</code>
settings if desired.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_weigh_delay_priors">weigh_delay_priors</code></td>
<td>
<p>Logical. If TRUE (default), all delay distribution
priors will be weighted by the number of observation data points, in doing so
approximately placing an independent prior at each time step and usually
preventing the posteriors from shifting. If FALSE, no weight will be applied,
i.e. delay distributions will be treated as a single parameters.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_id">id</code></td>
<td>
<p>A character string used to assign logging information on error.
Used by <code><a href="#topic+regional_epinow">regional_epinow()</a></code> to assign errors to regions. Alter the default to
run with error catching.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_verbose">verbose</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code> when used interactively and
otherwise <code>FALSE</code>. Should verbose debug progress messages be printed.
Corresponds to the &quot;DEBUG&quot; level from <code>futile.logger</code>. See <code>setup_logging</code>
for more detailed logging options.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_filter_leading_zeros">filter_leading_zeros</code></td>
<td>
<p>Logical, defaults to TRUE. Should zeros at the
start of the time series be filtered out.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_zero_threshold">zero_threshold</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a> Numeric defaults
to Inf. Indicates if detected zero cases are meaningful by using a threshold
number of cases based on the 7-day average. If the average is above this
threshold then the zero is replaced using <code>fill</code>.</p>
</td></tr>
<tr><td><code id="estimate_infections_+3A_horizon">horizon</code></td>
<td>
<p>Deprecated; use <code>forecast</code> instead to specify the predictive
horizon</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of output including: posterior samples, summarised posterior
samples, data used to fit the model, and the fit object itself.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epinow">epinow()</a></code> <code><a href="#topic+regional_epinow">regional_epinow()</a></code> <code><a href="#topic+forecast_infections">forecast_infections()</a></code>
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# set number of cores to use
old_opts &lt;- options()
options(mc.cores = ifelse(interactive(), 4, 1))

# get example case counts
reported_cases &lt;- example_confirmed[1:60]

# set an example generation time. In practice this should use an estimate
# from the literature or be estimated from data
generation_time &lt;- Gamma(
  shape = Normal(1.3, 0.3),
  rate = Normal(0.37, 0.09),
  max = 14
)
# set an example incubation period. In practice this should use an estimate
# from the literature or be estimated from data
incubation_period &lt;- LogNormal(
  meanlog = Normal(1.6, 0.06),
  sdlog = Normal(0.4, 0.07),
  max = 14
)
# set an example reporting delay. In practice this should use an estimate
# from the literature or be estimated from data
reporting_delay &lt;- LogNormal(mean = 2, sd = 1, max = 10)

# for more examples, see the "estimate_infections examples" vignette
def &lt;- estimate_infections(reported_cases,
  generation_time = gt_opts(generation_time),
  delays = delay_opts(incubation_period + reporting_delay),
  rt = rt_opts(prior = LogNormal(mean = 2, sd = 0.1))
)
# real time estimates
summary(def)
# summary plot
plot(def)
options(old_opts)

</code></pre>

<hr>
<h2 id='estimate_secondary'>Estimate a Secondary Observation from a Primary Observation</h2><span id='topic+estimate_secondary'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Estimates the relationship between a primary and secondary observation, for
example hospital admissions and deaths or hospital admissions and bed
occupancy. See <code><a href="#topic+secondary_opts">secondary_opts()</a></code> for model structure options. See parameter
documentation for model defaults and options. See the examples for case
studies using synthetic data and
<a href="https://gist.github.com/seabbs/4f09d7609df298db7a86c31612ff9d17">here</a>
for an example of forecasting Covid-19 deaths from Covid-19 cases. See
<a href="https://gist.github.com/seabbs/4dad3958ca8d83daca8f02b143d152e6">here</a> for
a prototype function that may be used to estimate and forecast a secondary
observation from a primary across multiple regions and
<a href="https://github.com/epiforecasts/covid.german.forecasts/blob/master/rt-forecast/death-from-cases.R">here</a> # nolint
for an application forecasting Covid-19 deaths in Germany and Poland.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_secondary(
  data,
  secondary = secondary_opts(),
  delays = delay_opts(LogNormal(meanlog = Normal(2.5, 0.5), sdlog = Normal(0.47, 0.25),
    max = 30), weight_prior = FALSE),
  truncation = trunc_opts(),
  obs = obs_opts(),
  stan = stan_opts(),
  burn_in = 14,
  CrIs = c(0.2, 0.5, 0.9),
  priors = NULL,
  model = NULL,
  weigh_delay_priors = FALSE,
  verbose = interactive(),
  filter_leading_zeros = FALSE,
  zero_threshold = Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_secondary_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing the <code>date</code> of report and both
<code>primary</code> and <code>secondary</code> reports. Optionally this can also have a logical
<code>accumulate</code> column which indicates whether data should be added to the
next data point. This is useful when modelling e.g. weekly incidence data.
See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which helps add the <code>accumulate</code>
column with the desired properties when dealing with non-daily data. If any
accumulation is done this happens after truncation as specified by the
<code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_secondary">secondary</code></td>
<td>
<p>A call to <code><a href="#topic+secondary_opts">secondary_opts()</a></code> or a list containing the
following  binary variables: cumulative, historic, primary_hist_additive,
current, primary_current_additive. These parameters control the structure of
the secondary model, see <code><a href="#topic+secondary_opts">secondary_opts()</a></code> for details.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_delays">delays</code></td>
<td>
<p>A call to <code><a href="#topic+delay_opts">delay_opts()</a></code> defining delay distributions between
primary and secondary observations See the documentation of <code><a href="#topic+delay_opts">delay_opts()</a></code>
for details. By default a diffuse prior  is assumed with a mean of 14 days
and standard deviation of 7 days (with a standard deviation of 0.5 and 0.25
respectively on the log scale).</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_truncation">truncation</code></td>
<td>
<p>A call to <code><a href="#topic+trunc_opts">trunc_opts()</a></code> defining the truncation of
the observed data. Defaults to <code><a href="#topic+trunc_opts">trunc_opts()</a></code>, i.e. no truncation.  See the
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> help file for an approach to estimating this from
data where the <code>dist</code> list element returned by <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> is
used as the <code>truncation</code> argument here, thereby propagating the uncertainty
in the estimate.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_stan">stan</code></td>
<td>
<p>A list of stan options as generated by <code><a href="#topic+stan_opts">stan_opts()</a></code>. Defaults
to <code><a href="#topic+stan_opts">stan_opts()</a></code>. Can be used to override <code>data</code>, <code>init</code>, and <code>verbose</code>
settings if desired.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_burn_in">burn_in</code></td>
<td>
<p>Integer, defaults to 14 days. The number of data points to
use for estimation but not to fit to at the beginning of the time series.
This must be less than the number of observations.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_priors">priors</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of named priors to be used in model fitting
rather than the defaults supplied from other arguments. This is typically
useful if wanting to inform an estimate from the posterior of another model
fit.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_model">model</code></td>
<td>
<p>A compiled stan model to override the default model. May be
useful for package developers or those developing extensions.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_weigh_delay_priors">weigh_delay_priors</code></td>
<td>
<p>Logical. If TRUE, all delay distribution priors
will be weighted by the number of observation data points, in doing so
approximately placing an independent prior at each time step and usually
preventing the posteriors from shifting. If FALSE (default), no weight will
be applied, i.e. delay distributions will be treated as a single
parameters.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_verbose">verbose</code></td>
<td>
<p>Logical, should model fitting progress be returned. Defaults
to <code><a href="base.html#topic+interactive">interactive()</a></code>.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_filter_leading_zeros">filter_leading_zeros</code></td>
<td>
<p>Logical, defaults to TRUE. Should zeros at the
start of the time series be filtered out.</p>
</td></tr>
<tr><td><code id="estimate_secondary_+3A_zero_threshold">zero_threshold</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a> Numeric defaults
to Inf. Indicates if detected zero cases are meaningful by using a threshold
number of cases based on the 7-day average. If the average is above this
threshold then the zero is replaced using <code>fill</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing: <code>predictions</code> (a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> ordered by date
with the primary, and secondary observations, and a summary of the model
estimated secondary observations), <code>posterior</code> which contains a summary of
the entire model posterior, <code>data</code> (a list of data used to fit the
model), and <code>fit</code> (the <code>stanfit</code> object).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# set number of cores to use
old_opts &lt;- options()
options(mc.cores = ifelse(interactive(), 4, 1))

# load data.table for manipulation
library(data.table)

#### Incidence data example ####

# make some example secondary incidence data
cases &lt;- example_confirmed
cases &lt;- as.data.table(cases)[, primary := confirm]
# Assume that only 40 percent of cases are reported
cases[, scaling := 0.4]
# Parameters of the assumed log normal delay distribution
cases[, meanlog := 1.8][, sdlog := 0.5]

# Simulate secondary cases
cases &lt;- convolve_and_scale(cases, type = "incidence")
#
# fit model to example data specifying a weak prior for fraction reported
# with a secondary case
inc &lt;- estimate_secondary(cases[1:60],
  obs = obs_opts(scale = Normal(mean = 0.2, sd = 0.2), week_effect = FALSE)
)
plot(inc, primary = TRUE)

# forecast future secondary cases from primary
inc_preds &lt;- forecast_secondary(
  inc, cases[seq(61, .N)][, value := primary]
)
plot(inc_preds, new_obs = cases, from = "2020-05-01")

#### Prevalence data example ####

# make some example prevalence data
cases &lt;- example_confirmed
cases &lt;- as.data.table(cases)[, primary := confirm]
# Assume that only 30 percent of cases are reported
cases[, scaling := 0.3]
# Parameters of the assumed log normal delay distribution
cases[, meanlog := 1.6][, sdlog := 0.8]

# Simulate secondary cases
cases &lt;- convolve_and_scale(cases, type = "prevalence")

# fit model to example prevalence data
prev &lt;- estimate_secondary(cases[1:100],
  secondary = secondary_opts(type = "prevalence"),
  obs = obs_opts(
    week_effect = FALSE,
    scale = Normal(mean = 0.4, sd = 0.1)
  )
)
plot(prev, primary = TRUE)

# forecast future secondary cases from primary
prev_preds &lt;- forecast_secondary(
  prev, cases[seq(101, .N)][, value := primary]
)
plot(prev_preds, new_obs = cases, from = "2020-06-01")

options(old_opts)

</code></pre>

<hr>
<h2 id='estimate_truncation'>Estimate Truncation of Observed Data</h2><span id='topic+estimate_truncation'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Estimates a truncation distribution from multiple snapshots of the same
data source over time. This distribution can then be used passed to the
<code>truncation</code> argument in <code><a href="#topic+regional_epinow">regional_epinow()</a></code>, <code><a href="#topic+epinow">epinow()</a></code>, and
<code><a href="#topic+estimate_infections">estimate_infections()</a></code> to adjust for truncated data and propagate the
uncertainty associated with data truncation into the estimates.
</p>
<p>See <a href="https://gist.github.com/seabbs/176b0c7f83eab1a7192a25b28bbd116a">here</a>
for an example of using this approach on Covid-19 data in England. The
functionality offered by this function is now available in a more principled
manner in the <a href="https://package.epinowcast.org/"><code>epinowcast</code> R package</a>.
</p>
<p>The model of truncation is as follows:
</p>

<ol>
<li><p> The truncation distribution is assumed to be discretised log normal wit
a mean and standard deviation that is informed by the data.
</p>
</li>
<li><p> The data set with the latest observations is adjusted for truncation using
the truncation distribution.
</p>
</li>
<li><p> Earlier data sets are recreated by applying the truncation distribution to
the adjusted latest observations in the time period of the earlier data set.
These data sets are then compared to the earlier observations assuming a
negative binomial observation model with an additive noise term to deal with
zero observations.
</p>
</li></ol>

<p>This model is then fit using <code>stan</code> with standard normal, or half normal,
prior for the mean, standard deviation, 1 over the square root of the
overdispersion and additive noise term.
</p>
<p>This approach assumes that:
</p>

<ul>
<li><p> Current truncation is related to past truncation.
</p>
</li>
<li><p> Truncation is a multiplicative scaling of underlying reported cases.
</p>
</li>
<li><p> Truncation is log normally distributed.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>estimate_truncation(
  data,
  truncation = trunc_opts(LogNormal(meanlog = Normal(0, 1), sdlog = Normal(1, 1), max =
    10)),
  model = NULL,
  stan = stan_opts(),
  CrIs = c(0.2, 0.5, 0.9),
  filter_leading_zeros = FALSE,
  zero_threshold = Inf,
  weigh_delay_priors = FALSE,
  verbose = TRUE,
  ...,
  obs
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_truncation_+3A_data">data</code></td>
<td>
<p>A list of <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>s each containing a date variable
and a confirm (numeric) variable. Each data set should be a snapshot
of the reported data over time. All data sets must contain a complete vector
of dates.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_truncation">truncation</code></td>
<td>
<p>A call to <code><a href="#topic+trunc_opts">trunc_opts()</a></code> defining the truncation of
the observed data. Defaults to <code><a href="#topic+trunc_opts">trunc_opts()</a></code>, i.e. no truncation.  See the
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> help file for an approach to estimating this from
data where the <code>dist</code> list element returned by <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> is
used as the <code>truncation</code> argument here, thereby propagating the uncertainty
in the estimate.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_model">model</code></td>
<td>
<p>A compiled stan model to override the default model. May be
useful for package developers or those developing extensions.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_stan">stan</code></td>
<td>
<p>A list of stan options as generated by <code><a href="#topic+stan_opts">stan_opts()</a></code>. Defaults
to <code><a href="#topic+stan_opts">stan_opts()</a></code>. Can be used to override <code>data</code>, <code>init</code>, and <code>verbose</code>
settings if desired.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_filter_leading_zeros">filter_leading_zeros</code></td>
<td>
<p>Logical, defaults to TRUE. Should zeros at the
start of the time series be filtered out.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_zero_threshold">zero_threshold</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a> Numeric defaults
to Inf. Indicates if detected zero cases are meaningful by using a threshold
number of cases based on the 7-day average. If the average is above this
threshold then the zero is replaced using <code>fill</code>.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_weigh_delay_priors">weigh_delay_priors</code></td>
<td>
<p>Deprecated; use the <code>weight_prior</code> option in
<code><a href="#topic+trunc_opts">trunc_opts()</a></code> instead.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_verbose">verbose</code></td>
<td>
<p>Logical, should model fitting progress be returned.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to <code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code>.</p>
</td></tr>
<tr><td><code id="estimate_truncation_+3A_obs">obs</code></td>
<td>
<p>Deprecated; use <code>data</code> instead.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing: the summary parameters of the truncation
distribution (<code>dist</code>), which could be passed to the <code>truncation</code> argument
of <code><a href="#topic+epinow">epinow()</a></code>, <code><a href="#topic+regional_epinow">regional_epinow()</a></code>, and <code><a href="#topic+estimate_infections">estimate_infections()</a></code>, the
estimated CMF of the truncation distribution (<code>cmf</code>, can be used to
adjusted new data), a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing the observed truncated
data, latest observed data and the adjusted for
truncation observations (<code>obs</code>), a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing the last
observed data (<code>last_obs</code>, useful for plotting and validation), the data
used for fitting (<code>data</code>) and the fit object (<code>fit</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# set number of cores to use
old_opts &lt;- options()
options(mc.cores = ifelse(interactive(), 4, 1))

# fit model to example data
# See [example_truncated] for more details
est &lt;- estimate_truncation(example_truncated,
  verbose = interactive(),
  chains = 2, iter = 2000
)

# summary of the distribution
est$dist
# summary of the estimated truncation cmf (can be applied to new data)
print(est$cmf)
# observations linked to truncation adjusted estimates
print(est$obs)
# validation plot of observations vs estimates
plot(est)

# Pass the truncation distribution to `epinow()`.
# Note, we're using the last snapshot as the observed data as it contains
# all the previous snapshots. Also, we're using the default options for
# illustrative purposes only.
out &lt;- epinow(
  generation_time = generation_time_opts(example_generation_time),
  example_truncated[[5]],
  truncation = trunc_opts(est$dist)
)
plot(out)
options(old_opts)

</code></pre>

<hr>
<h2 id='estimates_by_report_date'>Estimate Cases by Report Date</h2><span id='topic+estimates_by_report_date'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
Either extracts or converts reported cases from an input data table. For
output from <code>estimate_infections</code> this is a simple filtering step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimates_by_report_date(
  estimates,
  CrIs = c(0.2, 0.5, 0.9),
  target_folder = NULL,
  samples = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimates_by_report_date_+3A_estimates">estimates</code></td>
<td>
<p>List of data frames as output by <code>estimate_infections</code></p>
</td></tr>
<tr><td><code id="estimates_by_report_date_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="estimates_by_report_date_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="estimates_by_report_date_+3A_samples">samples</code></td>
<td>
<p>Logical, defaults to TRUE. Should samples be saved</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of samples and summarised estimates of estimated cases by
date of report.
</p>

<hr>
<h2 id='example_confirmed'>Example Confirmed Case Data Set</h2><span id='topic+example_confirmed'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
An example data frame of observed cases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_confirmed
</code></pre>


<h3>Format</h3>

<p>A data frame containing cases reported on each date.
</p>

<hr>
<h2 id='example_generation_time'>Example generation time</h2><span id='topic+example_generation_time'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
An example of a generation time estimate. See here for details:
https://github.com/epiforecasts/EpiNow2/blob/main/data-raw/generation-time.R
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_generation_time
</code></pre>


<h3>Format</h3>

<p>A <code>dist_spec</code> object summarising the distribution
</p>

<hr>
<h2 id='example_incubation_period'>Example incubation period</h2><span id='topic+example_incubation_period'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
An example of an incubation period estimate. See here for details:
https://github.com/epiforecasts/EpiNow2/blob/main/data-raw/incubation-period.R # nolint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_incubation_period
</code></pre>


<h3>Format</h3>

<p>A <code>dist_spec</code> object summarising the distribution
</p>

<hr>
<h2 id='example_reporting_delay'>Example reporting delay</h2><span id='topic+example_reporting_delay'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
An example of an reporting delay estimate. See here for details:
https://github.com/epiforecasts/EpiNow2/blob/main/data-raw/reporting-delay # nolint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_reporting_delay
</code></pre>


<h3>Format</h3>

<p>A <code>dist_spec</code> object summarising the distribution
</p>

<hr>
<h2 id='example_truncated'>Example Case Data Set with Truncation</h2><span id='topic+example_truncated'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
An example dataset of observed cases with truncation applied.
This data is generated internally for use in the example of
<code>estimate_truncation()</code>. For details on how the data is generated, see
<a href="https://github.com/epiforecasts/EpiNow2/blob/main/data-raw/truncated.R">https://github.com/epiforecasts/EpiNow2/blob/main/data-raw/truncated.R</a> #nolint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_truncated
</code></pre>


<h3>Format</h3>

<p>A list of <code>data.table</code>s containing cases reported on each date until
a point of truncation.
Each element of the list is a <code>data.table</code> with the following columns:
</p>

<dl>
<dt>date</dt><dd><p>Date of case report.</p>
</dd>
<dt>confirm</dt><dd><p>Number of confirmed cases.</p>
</dd>
</dl>


<hr>
<h2 id='expose_stan_fns'>Expose internal package stan functions in R</h2><span id='topic+expose_stan_fns'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
his function exposes internal stan functions in R from a user
supplied list of target files. Allows for testing of stan functions in R and
potentially user use in R code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expose_stan_fns(files, target_dir, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expose_stan_fns_+3A_files">files</code></td>
<td>
<p>A character vector indicating the target files.</p>
</td></tr>
<tr><td><code id="expose_stan_fns_+3A_target_dir">target_dir</code></td>
<td>
<p>A character string indicating the target directory for the
file.</p>
</td></tr>
<tr><td><code id="expose_stan_fns_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="rstan.html#topic+expose_stan_functions">rstan::expose_stan_functions()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='extract_CrIs'>Extract Credible Intervals Present</h2><span id='topic+extract_CrIs'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Helper function to extract the credible intervals present in a
<code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_CrIs(summarised)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_CrIs_+3A_summarised">summarised</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> as processed by <code>calc_CrIs</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of credible intervals detected in
the <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samples &lt;- data.frame(value = 1:10, type = "car")
summarised &lt;- calc_CrIs(samples,
  summarise_by = "type",
  CrIs = c(seq(0.05, 0.95, 0.05))
)
extract_CrIs(summarised)
</code></pre>

<hr>
<h2 id='extract_inits'>Generate initial conditions from a Stan fit</h2><span id='topic+extract_inits'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
Extracts posterior samples to use to initialise a full model fit. This may
be useful for certain data sets where the sampler gets stuck or cannot
easily be initialised. In <code><a href="#topic+estimate_infections">estimate_infections()</a></code>, <code><a href="#topic+epinow">epinow()</a></code> and
<code><a href="#topic+regional_epinow">regional_epinow()</a></code> this option can be engaged by setting
<code style="white-space: pre;">&#8288;stan_opts(init_fit = &lt;stanfit&gt;)&#8288;</code>.
</p>
<p>This implementation is based on the approach taken in
<a href="https://github.com/ImperialCollegeLondon/epidemia/">epidemia</a> authored by
James Scott.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_inits(fit, current_inits, exclude_list = NULL, samples = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_inits_+3A_fit">fit</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;stanfit&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="extract_inits_+3A_current_inits">current_inits</code></td>
<td>
<p>A function that returns a list of initial conditions
(such as <code><a href="#topic+create_initial_conditions">create_initial_conditions()</a></code>). Only used in <code>exclude_list</code> is
specified.</p>
</td></tr>
<tr><td><code id="extract_inits_+3A_exclude_list">exclude_list</code></td>
<td>
<p>A character vector of parameters to not initialise from
the fit object, defaulting to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="extract_inits_+3A_samples">samples</code></td>
<td>
<p>Numeric, defaults to 50. Number of posterior samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function that when called returns a set of initial conditions as a
named list.
</p>

<hr>
<h2 id='extract_parameter'>Extract Samples for a Parameter from a Stan model</h2><span id='topic+extract_parameter'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Extracts a single from a list of stan output and returns it as a
<code style="white-space: pre;">&#8288;&lt;data.table&gt;&#8288;</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_parameter(param, samples, dates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_parameter_+3A_param">param</code></td>
<td>
<p>Character string indicating the parameter to extract</p>
</td></tr>
<tr><td><code id="extract_parameter_+3A_samples">samples</code></td>
<td>
<p>Extracted stan model (using <code><a href="rstan.html#topic+stanfit-method-extract">rstan::extract()</a></code>)</p>
</td></tr>
<tr><td><code id="extract_parameter_+3A_dates">dates</code></td>
<td>
<p>A vector identifying the dimensionality of the parameter to
extract. Generally this will be a date.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing the parameter name, date, sample id and
sample value.
</p>

<hr>
<h2 id='extract_parameter_samples'>Extract Parameter Samples from a Stan Model</h2><span id='topic+extract_parameter_samples'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Extracts a custom set of parameters from a stan object and adds
stratification and dates where appropriate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_parameter_samples(
  stan_fit,
  data,
  reported_dates,
  imputed_dates,
  reported_inf_dates,
  drop_length_1 = FALSE,
  merge = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_parameter_samples_+3A_stan_fit">stan_fit</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;stanfit&gt;&#8288;</code> or <code style="white-space: pre;">&#8288;&lt;CmdStanMCMC&gt;&#8288;</code> object as returned by
<code><a href="#topic+fit_model">fit_model()</a></code>.</p>
</td></tr>
<tr><td><code id="extract_parameter_samples_+3A_data">data</code></td>
<td>
<p>A list of the data supplied to the <code><a href="#topic+fit_model">fit_model()</a></code> call.</p>
</td></tr>
<tr><td><code id="extract_parameter_samples_+3A_reported_dates">reported_dates</code></td>
<td>
<p>A vector of dates to report estimates for.</p>
</td></tr>
<tr><td><code id="extract_parameter_samples_+3A_imputed_dates">imputed_dates</code></td>
<td>
<p>A vector of dates to report imputed reports for.</p>
</td></tr>
<tr><td><code id="extract_parameter_samples_+3A_reported_inf_dates">reported_inf_dates</code></td>
<td>
<p>A vector of dates to report infection estimates
for.</p>
</td></tr>
<tr><td><code id="extract_parameter_samples_+3A_drop_length_1">drop_length_1</code></td>
<td>
<p>Logical; whether the first dimension should be dropped
if it is off length 1; this is necessary when processing simulation results.</p>
</td></tr>
<tr><td><code id="extract_parameter_samples_+3A_merge">merge</code></td>
<td>
<p>if TRUE, merge samples and data so that parameters can be
extracted from data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>'s each containing the posterior of a
parameter
</p>

<hr>
<h2 id='extract_params'>Extract parameter names</h2><span id='topic+extract_params'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
Internal function for extracting given parameter names of a distribution
from the environment. Called by <code>new_dist_spec</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_params(params, distribution)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_params_+3A_params">params</code></td>
<td>
<p>Given parameters (obtained using <code>as.list(environment())</code>)</p>
</td></tr>
<tr><td><code id="extract_params_+3A_distribution">distribution</code></td>
<td>
<p>Character; the distribution to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of parameters and their values.
</p>

<hr>
<h2 id='extract_samples'>Extract all samples from a stan fit</h2><span id='topic+extract_samples'></span>

<h3>Description</h3>

<p>If the <code>object</code> argument is a <code style="white-space: pre;">&#8288;&lt;stanfit&gt;&#8288;</code> object, it simply returns the
result of <code><a href="rstan.html#topic+stanfit-method-extract">rstan::extract()</a></code>. If it is a <code style="white-space: pre;">&#8288;&lt;CmdStanMCMC&gt;&#8288;</code> it returns samples
in the same format as <code><a href="rstan.html#topic+stanfit-method-extract">rstan::extract()</a></code> does for <code style="white-space: pre;">&#8288;&lt;stanfit&gt;&#8288;</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_samples(stan_fit, pars = NULL, include = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_samples_+3A_stan_fit">stan_fit</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;stanfit&gt;&#8288;</code> or <code style="white-space: pre;">&#8288;&lt;CmdStanMCMC&gt;&#8288;</code> object as returned by
<code><a href="#topic+fit_model">fit_model()</a></code>.</p>
</td></tr>
<tr><td><code id="extract_samples_+3A_pars">pars</code></td>
<td>
<p>Any selection of parameters to extract</p>
</td></tr>
<tr><td><code id="extract_samples_+3A_include">include</code></td>
<td>
<p>whether the parameters specified in <code>pars</code> should be included
(<code>TRUE</code>, the default) or excluded (<code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of data.tables with samples
</p>

<hr>
<h2 id='extract_single_dist'>Extract a single element of a composite <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></h2><span id='topic+extract_single_dist'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_single_dist(x, i)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_single_dist_+3A_x">x</code></td>
<td>
<p>A composite <code>dist_spec</code> object</p>
</td></tr>
<tr><td><code id="extract_single_dist_+3A_i">i</code></td>
<td>
<p>The index to extract</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single <code>dist_spec</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist1 &lt;- LogNormal(mean = 1.6, sd = 0.5, max = 20)

# An uncertain gamma distribution with shape and rate normally distributed
# as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- Gamma(
  shape = Normal(3, 0.5),
  rate = Normal(2, 0.5),
  max = 20
)

# Multiple distributions
## Not run: 
dist &lt;- dist1 + dist2
extract_single_dist(dist, 2)

## End(Not run)
</code></pre>

<hr>
<h2 id='extract_stan_param'>Extract a Parameter Summary from a Stan Object</h2><span id='topic+extract_stan_param'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Extracts summarised parameter posteriors from a <code>stanfit</code> object using
<code>rstan::summary()</code> in a format consistent with other summary functions
in <code>{EpiNow2}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_stan_param(
  fit,
  params = NULL,
  CrIs = c(0.2, 0.5, 0.9),
  var_names = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_stan_param_+3A_fit">fit</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;stanfit&gt;&#8288;</code> objec.</p>
</td></tr>
<tr><td><code id="extract_stan_param_+3A_params">params</code></td>
<td>
<p>A character vector of parameters to extract. Defaults to all
parameters.</p>
</td></tr>
<tr><td><code id="extract_stan_param_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="extract_stan_param_+3A_var_names">var_names</code></td>
<td>
<p>Logical defaults to <code>FALSE</code>. Should variables be named.
Automatically set to TRUE if multiple parameters are to be extracted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.table&gt;&#8288;</code> summarising parameter posteriors. Contains a
following variables: <code>variable</code>, <code>mean</code>, <code>mean_se</code>, <code>sd</code>, <code>median</code>, and
<code>lower_</code>, <code>upper_</code> followed by credible interval labels indicating the
credible intervals present.
</p>

<hr>
<h2 id='extract_static_parameter'>Extract Samples from a Parameter with a Single Dimension</h2><span id='topic+extract_static_parameter'></span>

<h3>Description</h3>

<p>Extract Samples from a Parameter with a Single Dimension
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_static_parameter(param, samples)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_static_parameter_+3A_param">param</code></td>
<td>
<p>Character string indicating the parameter to extract</p>
</td></tr>
<tr><td><code id="extract_static_parameter_+3A_samples">samples</code></td>
<td>
<p>Extracted stan model (using <code><a href="rstan.html#topic+stanfit-method-extract">rstan::extract()</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing the parameter name, sample id and sample
value
</p>

<hr>
<h2 id='fill_missing'>Fill missing data in a data set to prepare it for use within the package</h2><span id='topic+fill_missing'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This function ensures that all days between the first and last date in the
data are present. It adds an <code>accumulate</code> column that indicates whether
modelled observations should be accumulated onto a later data point.
point. This is useful for modelling data that is reported less frequently
than daily, e.g. weekly incidence data, as well as other reporting
artifacts such as delayed weekedn reporting. The function can also be used
to fill in missing observations with zeros.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_missing(
  data,
  missing_dates = c("ignore", "accumulate", "zero"),
  missing_obs = c("ignore", "accumulate", "zero"),
  initial_accumulate,
  obs_column = "confirm",
  by = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_missing_+3A_data">data</code></td>
<td>
<p>Data frame with a <code>date</code> column. The other columns depend on the
model that the data are to be used, e.g. <code><a href="#topic+estimate_infections">estimate_infections()</a></code> or
<code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>. See the documentation there for the expected
format. The data must not already have an <code>accumulate</code> function, otherwise
the function will fail with an error.</p>
</td></tr>
<tr><td><code id="fill_missing_+3A_missing_dates">missing_dates</code></td>
<td>
<p>Character. Options are &quot;ignore&quot; (the default),
&quot;accumulate&quot; and &quot;zero&quot;. This determines how missing dates in the data are
interpreted.  If set to &quot;ignore&quot;, any missing dates in the observation
data will be interpreted as missing and skipped in the likelihood. If set
to &quot;accumulate&quot;, modelled observations on dates that are missing in the
data will be accumulated and added to the next non-missing data point.
This can be used to model incidence data that is reported less frequently
than daily. In that case, the first data point is not included in the
likelihood (unless <code>initial_accumulate</code> is set to a value greater than
one) but used only to reset modelled observations to zero. If &quot;zero&quot; then
all observations on missing dates will be assumed to be of value 0.</p>
</td></tr>
<tr><td><code id="fill_missing_+3A_missing_obs">missing_obs</code></td>
<td>
<p>Character. How to process dates that exist in the data
but have observations with NA values. The options available are the same
ones as for the <code>missing_dates</code> argument.</p>
</td></tr>
<tr><td><code id="fill_missing_+3A_initial_accumulate">initial_accumulate</code></td>
<td>
<p>Integer. The number of initial dates to accumulate
if <code>missing_dates</code> or <code>missing_obs</code> is set to <code>"accumulate"</code>. This
argument needs ot have a minimum of 1. If it is set to 1 then no
accumulation is happening on the first data point. If it is greater than 1
then dates are added to the beginning of the data set to get be able to
have a sufficient number of modelled observations accumulated onto the
first data point. For modelling weekly incidence data this should be set
to 7. If accumulating and the first data point is not NA and this is
argument is not set, then if all dates in the data have the same gap this
will be taken as initial accumulation and a warning given to inform the
user. If not all gaps are the same the first data point will be removed
with a warning.</p>
</td></tr>
<tr><td><code id="fill_missing_+3A_obs_column">obs_column</code></td>
<td>
<p>Character (default: &quot;confirm&quot;). If given, only the column
specified here will be used for checking missingness. This is useful if
using a data set that has multiple columns of hwich one of them
corresponds to observations that are to be processed here.</p>
</td></tr>
<tr><td><code id="fill_missing_+3A_by">by</code></td>
<td>
<p>Character vector. Name(s) of any additional column(s) where
data processing should be done separately for each value in the column.
This is useful when using data representing e.g. multiple geographies. If
NULL (default) no such grouping is done.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table with an <code>accumulate</code> column that indicates whether
values are accumulated (see the documentation of the <code>data</code> argument in
<code><a href="#topic+estimate_infections">estimate_infections()</a></code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cases &lt;- data.table::copy(example_confirmed)
## calculate weekly sum
cases[, confirm := data.table::frollsum(confirm, 7)]
## limit to dates once a week
cases &lt;- cases[seq(7, nrow(cases), 7)]
## set the second observation to missing
cases[2, confirm := NA]
## fill missing data
fill_missing(cases, missing_dates = "accumulate", initial_accumulate = 7)
</code></pre>

<hr>
<h2 id='filter_leading_zeros'>Filter leading zeros from a data set.</h2><span id='topic+filter_leading_zeros'></span>

<h3>Description</h3>

<p>Filter leading zeros from a data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_leading_zeros(data, obs_column = "confirm", by = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_leading_zeros_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="filter_leading_zeros_+3A_obs_column">obs_column</code></td>
<td>
<p>Character (default: &quot;confirm&quot;). If given, only the column
specified here will be used for checking missingness. This is useful if
using a data set that has multiple columns of hwich one of them
corresponds to observations that are to be processed here.</p>
</td></tr>
<tr><td><code id="filter_leading_zeros_+3A_by">by</code></td>
<td>
<p>Character vector. Name(s) of any additional column(s) where
data processing should be done separately for each value in the column.
This is useful when using data representing e.g. multiple geographies. If
NULL (default) no such grouping is done.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table with leading zeros removed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cases &lt;- data.frame(
  date = as.Date("2020-01-01") + 0:10,
  confirm = c(0, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9)
)
filter_leading_zeros(cases)
</code></pre>

<hr>
<h2 id='filter_opts'>Filter Options for a Target Region</h2><span id='topic+filter_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
A helper function that allows the selection of region specific settings if
present and otherwise applies the overarching settings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_opts(opts, region)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_opts_+3A_opts">opts</code></td>
<td>
<p>Either a list of calls to an <code style="white-space: pre;">&#8288;_opts()&#8288;</code> function or a single
call to an <code style="white-space: pre;">&#8288;_opts()&#8288;</code> function.</p>
</td></tr>
<tr><td><code id="filter_opts_+3A_region">region</code></td>
<td>
<p>A character string indicating a region of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of options
</p>

<hr>
<h2 id='fit_model'>Fit a model using the chosen backend.</h2><span id='topic+fit_model'></span>

<h3>Description</h3>

<p>Internal function for dispatch to fitting with NUTS or VB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_model(args, id = "stan")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_model_+3A_args">args</code></td>
<td>
<p>List of stan arguments.</p>
</td></tr>
<tr><td><code id="fit_model_+3A_id">id</code></td>
<td>
<p>A character string used to assign logging information on error.
Used by <code><a href="#topic+regional_epinow">regional_epinow()</a></code> to assign errors to regions. Alter the default to
run with error catching.</p>
</td></tr>
</table>

<hr>
<h2 id='fit_model_approximate'>Fit a Stan Model using an approximate method</h2><span id='topic+fit_model_approximate'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Fits a stan model using variational inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_model_approximate(args, future = FALSE, id = "stan")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_model_approximate_+3A_args">args</code></td>
<td>
<p>List of stan arguments.</p>
</td></tr>
<tr><td><code id="fit_model_approximate_+3A_future">future</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should <code>future</code> be used to run
stan chains in parallel.</p>
</td></tr>
<tr><td><code id="fit_model_approximate_+3A_id">id</code></td>
<td>
<p>A character string used to assign logging information on error.
Used by <code><a href="#topic+regional_epinow">regional_epinow()</a></code> to assign errors to regions. Alter the default to
run with error catching.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A stan model object
</p>

<hr>
<h2 id='fit_model_with_nuts'>Fit a Stan Model using the NUTs sampler</h2><span id='topic+fit_model_with_nuts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Fits a stan model using <code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code>. Provides the optional ability to
run chains using <code>future</code> with error catching, timeouts and merging of
completed chains.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_model_with_nuts(
  args,
  future = FALSE,
  max_execution_time = Inf,
  id = "stan"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_model_with_nuts_+3A_args">args</code></td>
<td>
<p>List of stan arguments.</p>
</td></tr>
<tr><td><code id="fit_model_with_nuts_+3A_future">future</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should <code>future</code> be used to run
stan chains in parallel.</p>
</td></tr>
<tr><td><code id="fit_model_with_nuts_+3A_max_execution_time">max_execution_time</code></td>
<td>
<p>Numeric, defaults to Inf. What is the maximum
execution time per chain in seconds. Results will still be returned as long
as at least 2 chains complete successfully within the timelimit.</p>
</td></tr>
<tr><td><code id="fit_model_with_nuts_+3A_id">id</code></td>
<td>
<p>A character string used to assign logging information on error.
Used by <code><a href="#topic+regional_epinow">regional_epinow()</a></code> to assign errors to regions. Alter the default to
run with error catching.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A stan model object
</p>

<hr>
<h2 id='fix_dist'>Remove uncertainty in the parameters of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></h2><span id='topic+fix_dist'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
This function has been renamed to <code><a href="#topic+fix_parameters">fix_parameters()</a></code> as a more appropriate
name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fix_dist(x, strategy = c("mean", "sample"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fix_dist_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="fix_dist_+3A_strategy">strategy</code></td>
<td>
<p>Character; either &quot;mean&quot; (use the mean estimates of the
mean and standard deviation) or &quot;sample&quot; (randomly sample mean and
standard deviation from uncertainty given in the <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> object without uncertainty
</p>

<hr>
<h2 id='fix_parameters'>Fix the parameters of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></h2><span id='topic+fix_parameters'></span><span id='topic+fix_parameters.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
If the given <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> has any uncertainty, it is removed and the
corresponding distribution converted into a fixed one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
fix_parameters(x, strategy = c("mean", "sample"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fix_parameters_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="fix_parameters_+3A_strategy">strategy</code></td>
<td>
<p>Character; either &quot;mean&quot; (use the mean estimates of the
mean and standard deviation) or &quot;sample&quot; (randomly sample mean and
standard deviation from uncertainty given in the <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="fix_parameters_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> object without uncertainty
</p>


<h3>Examples</h3>

<pre><code class='language-R'># An uncertain gamma distribution with shape and rate normally distributed
# as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist &lt;- Gamma(
  shape = Normal(3, 0.5),
  rate = Normal(2, 0.5),
  max = 20
)

fix_parameters(dist)
</code></pre>

<hr>
<h2 id='forecast_infections'>Forecast infections from a given fit and trajectory of the time-varying
reproduction number</h2><span id='topic+forecast_infections'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
This function simulates infections using an existing fit to observed cases
but with a modified time-varying reproduction number. This can be used to
explore forecast models or past counterfactuals. Simulations can be run in
parallel using <code><a href="future.html#topic+plan">future::plan()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forecast_infections(
  estimates,
  R = NULL,
  model = NULL,
  samples = NULL,
  batch_size = 10,
  backend = "rstan",
  verbose = interactive()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forecast_infections_+3A_estimates">estimates</code></td>
<td>
<p>The <code>estimates</code> element of an <code><a href="#topic+epinow">epinow()</a></code> run that
has been done with output = &quot;fit&quot;, or the result of
<code><a href="#topic+estimate_infections">estimate_infections()</a></code> with <code>return_fit</code> set to TRUE.</p>
</td></tr>
<tr><td><code id="forecast_infections_+3A_r">R</code></td>
<td>
<p>A numeric vector of reproduction numbers; these will overwrite the
reproduction numbers contained in <code>estimates</code>, except elements set to
NA. Alternatively accepts a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing at least <code>date</code> and
<code>value</code> (integer) variables and optionally <code>sample</code>. More (or fewer) days
than in the original fit can be simulated.</p>
</td></tr>
<tr><td><code id="forecast_infections_+3A_model">model</code></td>
<td>
<p>A compiled stan model as returned by <code><a href="rstan.html#topic+stan_model">rstan::stan_model()</a></code>.</p>
</td></tr>
<tr><td><code id="forecast_infections_+3A_samples">samples</code></td>
<td>
<p>Numeric, number of posterior samples to simulate from. The
default is to use all samples in the <code>estimates</code> input.</p>
</td></tr>
<tr><td><code id="forecast_infections_+3A_batch_size">batch_size</code></td>
<td>
<p>Numeric, defaults to 10. Size of batches in which to
simulate. May decrease run times due to reduced IO costs but this is still
being evaluated. If set to NULL then all simulations are done at once.</p>
</td></tr>
<tr><td><code id="forecast_infections_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
<tr><td><code id="forecast_infections_+3A_verbose">verbose</code></td>
<td>
<p>Logical defaults to <code><a href="base.html#topic+interactive">interactive()</a></code>. If the <code>progressr</code>
package is available, a progress bar will be shown.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of output as returned by <code><a href="#topic+estimate_infections">estimate_infections()</a></code> but based on
results from the specified scenario rather than fitting.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generation_time_opts">generation_time_opts()</a></code> <code><a href="#topic+delay_opts">delay_opts()</a></code> <code><a href="#topic+rt_opts">rt_opts()</a></code>
<code><a href="#topic+estimate_infections">estimate_infections()</a></code> <code><a href="#topic+trunc_opts">trunc_opts()</a></code> <code><a href="#topic+stan_opts">stan_opts()</a></code> <code><a href="#topic+obs_opts">obs_opts()</a></code>
<code><a href="#topic+gp_opts">gp_opts()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# set number of cores to use
old_opts &lt;- options()
options(mc.cores = ifelse(interactive(), 4, 1))

# get example case counts
reported_cases &lt;- example_confirmed[1:50]

# fit model to data to recover Rt estimates
est &lt;- estimate_infections(reported_cases,
  generation_time = generation_time_opts(example_generation_time),
  delays = delay_opts(example_incubation_period + example_reporting_delay),
  rt = rt_opts(prior = LogNormal(mean = 2, sd = 0.1), rw = 7),
  obs = obs_opts(scale = Normal(mean = 0.1, sd = 0.01)),
  gp = NULL,
  forecast = forecast_opts(horizon = 0)
)

# update Rt trajectory and simulate new infections using it
R &lt;- c(rep(NA_real_, 26), rep(0.5, 10), rep(0.8, 14))
sims &lt;- forecast_infections(est, R)
plot(sims)

# with a data.frame input of samples
R_dt &lt;- data.frame(
  date = seq(
    min(summary(est, type = "parameters", param = "R")$date),
    by = "day", length.out = length(R)
  ),
  value = R
)
sims &lt;- forecast_infections(est, R_dt)
plot(sims)

#' # with a data.frame input of samples
R_samples &lt;- summary(est, type = "samples", param = "R")
R_samples &lt;- R_samples[
  ,
  .(date, sample, value)
][sample &lt;= 1000][date &lt;= "2020-04-10"]
R_samples &lt;- R_samples[date &gt;= "2020-04-01", value := 1.1]
sims &lt;- forecast_infections(est, R_samples)
plot(sims)

options(old_opts)

</code></pre>

<hr>
<h2 id='forecast_opts'>Forecast options</h2><span id='topic+forecast_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Defines a list specifying the arguments passed to underlying stan
backend functions via <code><a href="#topic+stan_sampling_opts">stan_sampling_opts()</a></code> and <code><a href="#topic+stan_vb_opts">stan_vb_opts()</a></code>. Custom
settings can be supplied which override the defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forecast_opts(horizon = 7, accumulate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forecast_opts_+3A_horizon">horizon</code></td>
<td>
<p>Numeric, defaults to 7. Number of days into the future to
forecast.</p>
</td></tr>
<tr><td><code id="forecast_opts_+3A_accumulate">accumulate</code></td>
<td>
<p>Integer, the number of days to accumulate in forecasts, if
any. If not given and observations are accumulated at constant frequency in
the data used for fitting then the same accumulation will be used in
forecasts unless set explicitly here.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;forecast_opts&gt;&#8288;</code> object of forecast setting.
</p>


<h3>See Also</h3>

<p>fill_missing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>forecast_opts(horizon = 28, accumulate = 7)
</code></pre>

<hr>
<h2 id='forecast_secondary'>Forecast Secondary Observations Given a Fit from estimate_secondary</h2><span id='topic+forecast_secondary'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This function forecasts secondary observations using the output of
<code><a href="#topic+estimate_secondary">estimate_secondary()</a></code> and either observed primary data or a forecast of
primary observations. See the examples of <code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>
for one use case. It can also be combined with <code><a href="#topic+estimate_infections">estimate_infections()</a></code> to
produce a forecast for a secondary observation from a forecast of a primary
observation. See the examples of <code><a href="#topic+estimate_secondary">estimate_secondary()</a></code> for
example use cases on synthetic data. See
<a href="https://gist.github.com/seabbs/4f09d7609df298db7a86c31612ff9d17">here</a>
for an example of forecasting Covid-19 deaths from Covid-19 cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forecast_secondary(
  estimate,
  primary,
  primary_variable = "reported_cases",
  model = NULL,
  backend = "rstan",
  samples = NULL,
  all_dates = FALSE,
  CrIs = c(0.2, 0.5, 0.9)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forecast_secondary_+3A_estimate">estimate</code></td>
<td>
<p>An object of class &quot;estimate_secondary&quot; as produced by
<code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>.</p>
</td></tr>
<tr><td><code id="forecast_secondary_+3A_primary">primary</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing at least <code>date</code> and <code>value</code>
(integer) variables and optionally <code>sample</code>. Used as the primary observation
used to forecast the secondary observations. Alternatively, this may be an
object of class &quot;estimate_infections&quot; as produced by <code>estimate_infections()</code>.
If <code>primary</code> is of class &quot;estimate_infections&quot; then the internal samples will
be filtered to have a minimum date ahead of those observed in the <code>estimate</code>
object.</p>
</td></tr>
<tr><td><code id="forecast_secondary_+3A_primary_variable">primary_variable</code></td>
<td>
<p>A character string indicating the primary variable,
defaulting to &quot;reported_cases&quot;. Only used when primary is of class
<code style="white-space: pre;">&#8288;&lt;estimate_infections&gt;&#8288;</code>.</p>
</td></tr>
<tr><td><code id="forecast_secondary_+3A_model">model</code></td>
<td>
<p>A compiled stan model as returned by <code><a href="rstan.html#topic+stan_model">rstan::stan_model()</a></code>.</p>
</td></tr>
<tr><td><code id="forecast_secondary_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
<tr><td><code id="forecast_secondary_+3A_samples">samples</code></td>
<td>
<p>Numeric, number of posterior samples to simulate from. The
default is to use all samples in the <code>primary</code> input when present. If not
present the default is to use 1000 samples.</p>
</td></tr>
<tr><td><code id="forecast_secondary_+3A_all_dates">all_dates</code></td>
<td>
<p>Logical, defaults to FALSE. Should a forecast for all dates
and not just those in the forecast horizon be returned.</p>
</td></tr>
<tr><td><code id="forecast_secondary_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing: <code>predictions</code> (a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> ordered by date
with the primary, and secondary observations, and a summary of the forecast
secondary observations. For primary observations in the forecast horizon
when uncertainty is present the median is used), <code>samples</code> a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>
of forecast secondary observation posterior samples, and <code>forecast</code> a summary
of the forecast secondary observation posterior.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>
</p>

<hr>
<h2 id='format_fit'>Format Posterior Samples</h2><span id='topic+format_fit'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Summaries posterior samples and adds additional custom variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_fit(posterior_samples, horizon, shift, burn_in, start_date, CrIs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_fit_+3A_posterior_samples">posterior_samples</code></td>
<td>
<p>A list of posterior samples as returned by
<code><a href="#topic+extract_parameter_samples">extract_parameter_samples()</a></code>.</p>
</td></tr>
<tr><td><code id="format_fit_+3A_horizon">horizon</code></td>
<td>
<p>Numeric, forecast horizon.</p>
</td></tr>
<tr><td><code id="format_fit_+3A_shift">shift</code></td>
<td>
<p>Numeric, the shift to apply to estimates.</p>
</td></tr>
<tr><td><code id="format_fit_+3A_burn_in">burn_in</code></td>
<td>
<p>Numeric, number of days to discard estimates for.</p>
</td></tr>
<tr><td><code id="format_fit_+3A_start_date">start_date</code></td>
<td>
<p>Date, earliest date with data.</p>
</td></tr>
<tr><td><code id="format_fit_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of samples and summarised posterior parameter estimates.
</p>

<hr>
<h2 id='get_distribution'>Get the distribution of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></h2><span id='topic+get_distribution'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_distribution(x, id = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_distribution_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code>.</p>
</td></tr>
<tr><td><code id="get_distribution_+3A_id">id</code></td>
<td>
<p>Integer; the id of the distribution to use (if x is a composite
distribution). If <code>x</code> is a single distribution this is ignored and can be
left at its default value of <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string naming the distribution (or &quot;nonparametric&quot;)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- Gamma(shape = 3, rate = 2, max = 10)
get_distribution(dist)
</code></pre>

<hr>
<h2 id='get_element'>Extracts an element of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></h2><span id='topic+get_element'></span>

<h3>Description</h3>

<p>Extracts an element of a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_element(x, id = NULL, element)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_element_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code>.</p>
</td></tr>
<tr><td><code id="get_element_+3A_id">id</code></td>
<td>
<p>Integer; the id of the distribution to use (if x is a composite
distribution). If <code>x</code> is a single distribution this is ignored and can be
left at its default value of <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="get_element_+3A_element">element</code></td>
<td>
<p>The element, i.e. &quot;parameters&quot;, &quot;pmf&quot; or &quot;distribution&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The id to use.
</p>

<hr>
<h2 id='get_parameters'>Get parameters of a parametric distribution</h2><span id='topic+get_parameters'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_parameters(x, id = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_parameters_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code>.</p>
</td></tr>
<tr><td><code id="get_parameters_+3A_id">id</code></td>
<td>
<p>Integer; the id of the distribution to use (if x is a composite
distribution). If <code>x</code> is a single distribution this is ignored and can be
left at its default value of <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of parameters of the distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- Gamma(shape = 3, rate = 2)
get_parameters(dist)
</code></pre>

<hr>
<h2 id='get_pmf'>Get the probability mass function of a nonparametric distribution</h2><span id='topic+get_pmf'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_pmf(x, id = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_pmf_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code>.</p>
</td></tr>
<tr><td><code id="get_pmf_+3A_id">id</code></td>
<td>
<p>Integer; the id of the distribution to use (if x is a composite
distribution). If <code>x</code> is a single distribution this is ignored and can be
left at its default value of <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The pmf of the distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- discretise(Gamma(shape = 3, rate = 2, max = 10))
get_pmf(dist)
</code></pre>

<hr>
<h2 id='get_raw_result'>Get a Single Raw Result</h2><span id='topic+get_raw_result'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_raw_result(file, region, date, result_dir)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_raw_result_+3A_file">file</code></td>
<td>
<p>Character string giving the result files name.</p>
</td></tr>
<tr><td><code id="get_raw_result_+3A_region">region</code></td>
<td>
<p>Character string giving the region of interest.</p>
</td></tr>
<tr><td><code id="get_raw_result_+3A_date">date</code></td>
<td>
<p>Target date (in the format <code style="white-space: pre;">&#8288;"yyyy-mm-dd&#8288;</code>).</p>
</td></tr>
<tr><td><code id="get_raw_result_+3A_result_dir">result_dir</code></td>
<td>
<p>Character string giving the location of the target
directory.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An R object read in from the targeted <code>.rds</code> file
</p>

<hr>
<h2 id='get_regional_results'>Get Combined Regional Results</h2><span id='topic+get_regional_results'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Summarises results across regions either from input or from disk. See the
examples for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_regional_results(
  regional_output,
  results_dir,
  date,
  samples = TRUE,
  forecast = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_regional_results_+3A_regional_output">regional_output</code></td>
<td>
<p>A list of output as produced by <code><a href="#topic+regional_epinow">regional_epinow()</a></code>
and stored in the <code>regional</code> list.</p>
</td></tr>
<tr><td><code id="get_regional_results_+3A_results_dir">results_dir</code></td>
<td>
<p>A character string indicating the folder containing the
<code>{EpiNow2}</code> results to extract.</p>
</td></tr>
<tr><td><code id="get_regional_results_+3A_date">date</code></td>
<td>
<p>A Character string (in the format &quot;yyyy-mm-dd&quot;) indicating the
date to extract data for. Defaults to &quot;latest&quot; which finds the latest
results available.</p>
</td></tr>
<tr><td><code id="get_regional_results_+3A_samples">samples</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code>. Should samples be returned.</p>
</td></tr>
<tr><td><code id="get_regional_results_+3A_forecast">forecast</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should forecast results be
returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of estimates, forecasts and estimated cases by date of report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example multiregion estimates
regional_out &lt;- readRDS(system.file(
  package = "EpiNow2", "extdata", "example_regional_epinow.rds"
))

# from output
results &lt;- get_regional_results(regional_out$regional, samples = FALSE)
</code></pre>

<hr>
<h2 id='get_regions'>Get Folders with Results</h2><span id='topic+get_regions'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_regions(results_dir)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_regions_+3A_results_dir">results_dir</code></td>
<td>
<p>A character string giving the directory in which results
are stored (as produced by <code><a href="#topic+regional_epinow">regional_epinow()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named character vector containing the results to plot.
</p>

<hr>
<h2 id='get_regions_with_most_reports'>Get Regions with Most Reported Cases</h2><span id='topic+get_regions_with_most_reports'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Extract a vector of regions with the most reported cases in a set time
window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_regions_with_most_reports(data, time_window = 7, no_regions = 6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_regions_with_most_reports_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date
(date), and region (<code>region</code>).</p>
</td></tr>
<tr><td><code id="get_regions_with_most_reports_+3A_time_window">time_window</code></td>
<td>
<p>Numeric, number of days to include from latest date in
data. Defaults to 7 days.</p>
</td></tr>
<tr><td><code id="get_regions_with_most_reports_+3A_no_regions">no_regions</code></td>
<td>
<p>Numeric, number of regions to return. Defaults to 6.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of regions with the highest reported cases
</p>

<hr>
<h2 id='get_seeding_time'>Estimate seeding time from delays and generation time</h2><span id='topic+get_seeding_time'></span>

<h3>Description</h3>

<p>The seeding time is set to the mean of the specified delays, constrained
to be at least the maximum generation time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_seeding_time(delays, generation_time, rt = rt_opts())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_seeding_time_+3A_delays">delays</code></td>
<td>
<p>A call to <code><a href="#topic+delay_opts">delay_opts()</a></code> defining delay distributions and
options. See the documentation of <code><a href="#topic+delay_opts">delay_opts()</a></code> and the examples below for
details.</p>
</td></tr>
<tr><td><code id="get_seeding_time_+3A_generation_time">generation_time</code></td>
<td>
<p>A call to <code><a href="#topic+gt_opts">gt_opts()</a></code> (or its alias
<code><a href="#topic+generation_time_opts">generation_time_opts()</a></code>) defining the generation time distribution used.
For backwards compatibility a list of summary parameters can also be passed.</p>
</td></tr>
<tr><td><code id="get_seeding_time_+3A_rt">rt</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+rt_opts">rt_opts()</a></code> defining Rt
estimation. Defaults to <code><a href="#topic+rt_opts">rt_opts()</a></code>. To generate new infections using
the non-mechanistic model instead of the renewal equation model, use
<code>rt = NULL</code>. The non-mechanistic model internally uses the setting
<code>rt = rt_opts(use_rt = FALSE, future = "project", gp_on = "R0")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer seeding time
</p>

<hr>
<h2 id='gp_opts'>Approximate Gaussian Process Settings</h2><span id='topic+gp_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Defines a list specifying the structure of the approximate Gaussian
process. Custom settings can be supplied which override the defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp_opts(
  basis_prop = 0.2,
  boundary_scale = 1.5,
  ls_mean = 21,
  ls_sd = 7,
  ls_min = 0,
  ls_max = 60,
  ls = LogNormal(mean = 21, sd = 7, max = 60),
  alpha = Normal(mean = 0, sd = 0.01),
  kernel = c("matern", "se", "ou", "periodic"),
  matern_order = 3/2,
  matern_type,
  w0 = 1,
  alpha_mean,
  alpha_sd
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gp_opts_+3A_basis_prop">basis_prop</code></td>
<td>
<p>Numeric, the proportion of time points to use as basis
functions. Defaults to 0.2. Decreasing this value results in a decrease in
accuracy but a faster compute time (with increasing it having the first
effect). In general smaller posterior length scales require a higher
proportion of basis functions. See (Riutort-Mayol et al. 2020
<a href="https://arxiv.org/abs/2004.11408">https://arxiv.org/abs/2004.11408</a>) for advice on updating this default.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_boundary_scale">boundary_scale</code></td>
<td>
<p>Numeric, defaults to 1.5. Boundary scale of the
approximate Gaussian process. See (Riutort-Mayol et al. 2020
<a href="https://arxiv.org/abs/2004.11408">https://arxiv.org/abs/2004.11408</a>) for advice on updating this default.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_ls_mean">ls_mean</code></td>
<td>
<p>Deprecated; use <code>ls</code> instead.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_ls_sd">ls_sd</code></td>
<td>
<p>Deprecated; use <code>ls</code> instead.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_ls_min">ls_min</code></td>
<td>
<p>Deprecated; use <code>ls</code> instead.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_ls_max">ls_max</code></td>
<td>
<p>Deprecated; use <code>ls</code> instead.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_ls">ls</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> giving the prior distribution of the lengthscale
parameter of the Gaussian process kernel on the scale of days. Defaults to
a Lognormal distribution with mean 21 days, sd 7 days and maximum 60 days:
<code>LogNormal(mean = 21, sd = 7, max = 60)</code> (a lower limit of 0 will be
enforced automatically to ensure positivity)</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_alpha">alpha</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> giving the prior distribution of the magnitude
parameter of the Gaussian process kernel. Should be approximately the
expected standard deviation of the Gaussian process (logged Rt in case of
the renewal model, logged infections in case of the nonmechanistic model).
Defaults to a half-normal distribution with mean 0 and sd 0.01:
<code>Normal(mean = 0, sd = 0.01)</code> (a lower limit of 0 will be enforced
automatically to ensure positivity)</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_kernel">kernel</code></td>
<td>
<p>Character string, the type of kernel required. Currently
supporting the Matern kernel (&quot;matern&quot;), squared exponential kernel (&quot;se&quot;),
periodic kernel, Ornstein-Uhlenbeck #' kernel (&quot;ou&quot;), and the periodic
kernel (&quot;periodic&quot;).</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_matern_order">matern_order</code></td>
<td>
<p>Numeric, defaults to 3/2. Order of Matrn Kernel to use.
Common choices are 1/2, 3/2, and 5/2. If <code>kernel</code> is set
to &quot;ou&quot;, <code>matern_order</code> will be automatically set to 1/2. Only used if
the kernel is set to &quot;matern&quot;.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_matern_type">matern_type</code></td>
<td>
<p>Deprecated; Numeric, defaults to 3/2. Order of Matrn
Kernel to use. Currently, the orders 1/2, 3/2, 5/2 and Inf are supported.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_w0">w0</code></td>
<td>
<p>Numeric, defaults to 1.0. Fundamental frequency for periodic
kernel. They are only used if <code>kernel</code> is set to &quot;periodic&quot;.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_alpha_mean">alpha_mean</code></td>
<td>
<p>Deprecated; use <code>alpha</code> instead.</p>
</td></tr>
<tr><td><code id="gp_opts_+3A_alpha_sd">alpha_sd</code></td>
<td>
<p>Deprecated; use <code>alpha</code> instead.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;gp_opts&gt;&#8288;</code> object of settings defining the Gaussian process
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default settings
gp_opts()

# add a custom length scale
gp_opts(ls = LogNormal(mean = 4, sd = 1, max = 20))

# use linear kernel
gp_opts(kernel = "periodic")
</code></pre>

<hr>
<h2 id='growth_to_R'>Convert Growth Rates to Reproduction numbers.</h2><span id='topic+growth_to_R'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
See <a href="https://www.medrxiv.org/content/10.1101/2020.01.30.20019877v3.full.pdf">here</a> # nolint
for justification. Now handled internally by stan so may be removed in
future updates if no user demand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>growth_to_R(r, gamma_mean, gamma_sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="growth_to_R_+3A_r">r</code></td>
<td>
<p>Numeric, rate of growth estimates.</p>
</td></tr>
<tr><td><code id="growth_to_R_+3A_gamma_mean">gamma_mean</code></td>
<td>
<p>Numeric, mean of the gamma distribution</p>
</td></tr>
<tr><td><code id="growth_to_R_+3A_gamma_sd">gamma_sd</code></td>
<td>
<p>Numeric, standard deviation of the gamma distribution
.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of reproduction number estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>growth_to_R(0.2, 4, 1)
</code></pre>

<hr>
<h2 id='gt_opts'>Generation Time Distribution Options</h2><span id='topic+gt_opts'></span><span id='topic+generation_time_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Returns generation time parameters in a format for lower level model use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gt_opts(dist = Fixed(1), default_cdf_cutoff = 0.001, weight_prior = TRUE)

generation_time_opts(
  dist = Fixed(1),
  default_cdf_cutoff = 0.001,
  weight_prior = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gt_opts_+3A_dist">dist</code></td>
<td>
<p>A delay distribution or series of delay distributions . If no
distribution is given a fixed generation time of 1 will be assumed.  If
passing a nonparametric distribution the first element should be zero (see
<em>Details</em> section)</p>
</td></tr>
<tr><td><code id="gt_opts_+3A_default_cdf_cutoff">default_cdf_cutoff</code></td>
<td>
<p>Numeric; default CDF cutoff to be used if an
unconstrained distribution is passed as <code>dist</code>. If <code>dist</code> is already
constrained by having a maximum or CDF cutoff this is ignored. Note that
this can only be done for &lt;dist_spec&gt; objects with fixed parameters.</p>
</td></tr>
<tr><td><code id="gt_opts_+3A_weight_prior">weight_prior</code></td>
<td>
<p>Logical; if TRUE (default), any priors given in <code>dist</code>
will be weighted by the number of observation data points, in doing so
approximately placing an independent prior at each time step and usually
preventing the posteriors from shifting. If FALSE, no weight
will be applied, i.e. any parameters in <code>dist</code> will be treated as a single
parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because the discretised renewal equation used in the package does
not support zero generation times, any distribution specified here will be
left-truncated at one, i.e. the first element of the nonparametric or
discretised probability distribution used for the generation time is set to
zero and the resulting distribution renormalised.
</p>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;generation_time_opts&gt;&#8288;</code> object summarising the input delay
distributions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_to_logmean">convert_to_logmean()</a></code> <code><a href="#topic+convert_to_logsd">convert_to_logsd()</a></code>
<code><a href="#topic+bootstrapped_dist_fit">bootstrapped_dist_fit()</a></code> <code><a href="#topic+Gamma">Gamma()</a></code> <code><a href="#topic+LogNormal">LogNormal()</a></code> <code><a href="#topic+Fixed">Fixed()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default settings with a fixed generation time of 1
generation_time_opts()

# A fixed gamma distributed generation time
generation_time_opts(Gamma(mean = 3, sd = 2, max = 14))

# An uncertain gamma distributed generation time
generation_time_opts(
  Gamma(
    shape = Normal(mean = 3, sd = 1),
    rate = Normal(mean = 2, sd = 0.5),
    max = 14
  )
)

# An example generation time
gt_opts(example_generation_time)
</code></pre>

<hr>
<h2 id='is_constrained'>Check if a &lt;dist_spec&gt; is constrained, i.e. has a finite maximum or nonzero
CDF cutoff.</h2><span id='topic+is_constrained'></span><span id='topic+is_constrained.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
is_constrained(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_constrained_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="is_constrained_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical; TRUE if <code>x</code> is constrained
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A fixed gamma distribution with mean 5 and sd 1.
dist1 &lt;- Gamma(mean = 5, sd = 1, max = 20)

# An uncertain lognormal distribution with meanlog and sdlog normally
# distributed as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- LogNormal(
  meanlog = Normal(3, 0.5),
  sdlog = Normal(2, 0.5),
  max = 20
)

# both distributions are constrained and therefore so is the sum
is_constrained(dist1 + dist2)
</code></pre>

<hr>
<h2 id='lapply_func'>Choose a parallel or sequential apply function</h2><span id='topic+lapply_func'></span>

<h3>Description</h3>

<p>Internal function that chooses an appropriate &quot;apply&quot;-type function (either
<code><a href="base.html#topic+lapply">lapply()</a></code> or <code><a href="future.apply.html#topic+future_lapply">future.apply::future_lapply()</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lapply_func(..., backend = "rstan", future.opts = list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lapply_func_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to underlying option functions,
<code><a href="#topic+stan_sampling_opts">stan_sampling_opts()</a></code> or <code><a href="#topic+stan_vb_opts">stan_vb_opts()</a></code>, depending on the method</p>
</td></tr>
<tr><td><code id="lapply_func_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function that can be used to apply a function to a list
</p>

<hr>
<h2 id='lower_bounds'>Get the lower bounds of the parameters of a distribution</h2><span id='topic+lower_bounds'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This is used to avoid sampling parameter values that have no support.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lower_bounds(distribution)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lower_bounds_+3A_distribution">distribution</code></td>
<td>
<p>Character; the distribution to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector, the lower bounds.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
lower_bounds("lognormal")

## End(Not run)
</code></pre>

<hr>
<h2 id='make_conf'>Format Credible Intervals</h2><span id='topic+make_conf'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Combines a list of values into formatted credible intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_conf(value, CrI = 90, reverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_conf_+3A_value">value</code></td>
<td>
<p>List of value to map into a string. Requires,
<code>point</code>, <code>lower</code>, and <code>upper.</code></p>
</td></tr>
<tr><td><code id="make_conf_+3A_cri">CrI</code></td>
<td>
<p>Numeric, credible interval to report. Defaults to 90.</p>
</td></tr>
<tr><td><code id="make_conf_+3A_reverse">reverse</code></td>
<td>
<p>Logical, defaults to FALSE. Should the reported
credible interval be switched.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector formatted for reporting
</p>


<h3>Examples</h3>

<pre><code class='language-R'>value &lt;- list(median = 2, lower_90 = 1, upper_90 = 3)
make_conf(value)
</code></pre>

<hr>
<h2 id='map_prob_change'>Categorise the Probability of Change for Rt</h2><span id='topic+map_prob_change'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Categorises a numeric variable into &quot;Increasing&quot; (&lt; 0.05),
&quot;Likely increasing&quot; (&lt;0.4), &quot;Stable&quot; (&lt; 0.6),
&quot;Likely decreasing&quot; (&lt; 0.95), &quot;Decreasing&quot; (&lt;= 1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_prob_change(var)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map_prob_change_+3A_var">var</code></td>
<td>
<p>Numeric variable to be categorised</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character variable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var &lt;- seq(0.01, 1, 0.01)
var

map_prob_change(var)
</code></pre>

<hr>
<h2 id='match_output_arguments'>Match User Supplied Arguments with Supported Options</h2><span id='topic+match_output_arguments'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Match user supplied arguments with supported options and return a logical
list for internal usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match_output_arguments(
  input_args = NULL,
  supported_args = NULL,
  logger = NULL,
  level = "info"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="match_output_arguments_+3A_input_args">input_args</code></td>
<td>
<p>A character vector of input arguments (can be partial).</p>
</td></tr>
<tr><td><code id="match_output_arguments_+3A_supported_args">supported_args</code></td>
<td>
<p>A character vector of supported output arguments.</p>
</td></tr>
<tr><td><code id="match_output_arguments_+3A_logger">logger</code></td>
<td>
<p>A character vector indicating the logger to target messages
at. Defaults to no logging.</p>
</td></tr>
<tr><td><code id="match_output_arguments_+3A_level">level</code></td>
<td>
<p>Character string defaulting to &quot;info&quot;. Logging level see
documentation of futile.logger for details. Supported options are &quot;info&quot; and
&quot;debug&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical vector of named output arguments
</p>

<hr>
<h2 id='max.dist_spec'>Returns the maximum of one or more delay distribution</h2><span id='topic+max.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This works out the maximum of all the (parametric / nonparametric) delay
distributions combined in the passed &lt;dist_spec&gt; (ignoring any uncertainty
in parameters)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
max(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="max.dist_spec_+3A_x">x</code></td>
<td>
<p>The &lt;dist_spec&gt; to use</p>
</td></tr>
<tr><td><code id="max.dist_spec_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of means.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A fixed gamma distribution with mean 5 and sd 1.
dist1 &lt;- Gamma(mean = 5, sd = 1, max = 20)
max(dist1)

# An uncertain lognormal distribution with meanlog and sdlog normally
# distributed as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- LogNormal(
  meanlog = Normal(3, 0.5),
  sdlog = Normal(2, 0.5),
  max = 20
)
max(dist2)

# The max the sum of two distributions
max(dist1 + dist2)
</code></pre>

<hr>
<h2 id='mean.dist_spec'>Returns the mean of one or more delay distribution</h2><span id='topic+mean.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This works out the mean of all the (parametric / nonparametric) delay
distributions combined in the passed &lt;dist_spec&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
mean(x, ..., ignore_uncertainty = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mean.dist_spec_+3A_x">x</code></td>
<td>
<p>The <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> to use</p>
</td></tr>
<tr><td><code id="mean.dist_spec_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
<tr><td><code id="mean.dist_spec_+3A_ignore_uncertainty">ignore_uncertainty</code></td>
<td>
<p>Logical; whether to ignore any uncertainty in
parameters. If set to FALSE (the default) then the mean of any uncertain
parameters will be returned as NA.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># A fixed lognormal distribution with mean 5 and sd 1.
dist1 &lt;- LogNormal(mean = 5, sd = 1, max = 20)
mean(dist1)

# An uncertain gamma distribution with shape and rate normally distributed
# as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- Gamma(
  shape = Normal(3, 0.5),
  rate = Normal(2, 0.5),
  max = 20
)
mean(dist2)

# The mean of the sum of two distributions
mean(dist1 + dist2)
</code></pre>

<hr>
<h2 id='natural_params'>Get the names of the natural parameters of a distribution</h2><span id='topic+natural_params'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
These are the parameters used in the stan models. All other parameter
representations are converted to these using <code><a href="#topic+convert_to_natural">convert_to_natural()</a></code> before
being passed to the stan models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>natural_params(distribution)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="natural_params_+3A_distribution">distribution</code></td>
<td>
<p>Character; the distribution to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector, the natural parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
natural_params("gamma")

## End(Not run)
</code></pre>

<hr>
<h2 id='ndist'>Calculate the number of distributions in a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code></h2><span id='topic+ndist'></span>

<h3>Description</h3>

<p>Calculate the number of distributions in a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ndist(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ndist_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of distributions.
</p>

<hr>
<h2 id='new_dist_spec'>Internal function for generating a <code>dist_spec</code> given parameters and a
distribution.</h2><span id='topic+new_dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This will convert all parameters to natural parameters before generating
a <code>dist_spec</code>. If they have uncertainty this will be done using sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_dist_spec(params, distribution, max = Inf, cdf_cutoff = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new_dist_spec_+3A_params">params</code></td>
<td>
<p>Parameters of the distribution (including <code>max</code>)</p>
</td></tr>
<tr><td><code id="new_dist_spec_+3A_distribution">distribution</code></td>
<td>
<p>Character; the distribution to use.</p>
</td></tr>
<tr><td><code id="new_dist_spec_+3A_max">max</code></td>
<td>
<p>Numeric, maximum value of the distribution. The distribution will
be truncated at this value. Default: <code>Inf</code>, i.e. no maximum.</p>
</td></tr>
<tr><td><code id="new_dist_spec_+3A_cdf_cutoff">cdf_cutoff</code></td>
<td>
<p>Numeric; the desired CDF cutoff. Any part of the
cumulative distribution function beyond 1 minus the value of this argument is
removed. Default: <code>0</code>, i.e. use the full distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>dist_spec</code> of the given specification.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>new_dist_spec(
  params = list(mean = 2, sd = 1),
  distribution = "normal"
)
</code></pre>

<hr>
<h2 id='obs_opts'>Observation Model Options</h2><span id='topic+obs_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Defines a list specifying the structure of the observation
model. Custom settings can be supplied which override the defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obs_opts(
  family = c("negbin", "poisson"),
  dispersion = Normal(mean = 0, sd = 0.25),
  weight = 1,
  week_effect = TRUE,
  week_length = 7,
  scale = Fixed(1),
  na = c("missing", "accumulate"),
  likelihood = TRUE,
  return_likelihood = FALSE,
  phi
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="obs_opts_+3A_family">family</code></td>
<td>
<p>Character string defining the observation model. Options are
Negative binomial (&quot;negbin&quot;), the default, and Poisson.</p>
</td></tr>
<tr><td><code id="obs_opts_+3A_dispersion">dispersion</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> specifying a prior on the dispersion
parameter of the reporting process, used only if <code>familiy</code> is &quot;negbin&quot;.
Internally parameterised such that this parameter is one over the square
root of the <code>phi</code> parameter for overdispersion of the
<a href="https://mc-stan.org/docs/functions-reference/unbounded_discrete_distributions.html#neg-binom-2-log">negative binomial distribution</a>. # nolint
Defaults to a half-normal distribution with mean of 0 and
standard deviation of 0.25: <code>Normal(mean = 0, sd = 0.25)</code>. A lower limit of
zero will be enforced automatically.</p>
</td></tr>
<tr><td><code id="obs_opts_+3A_weight">weight</code></td>
<td>
<p>Numeric, defaults to 1. Weight to give the observed data in the
log density.</p>
</td></tr>
<tr><td><code id="obs_opts_+3A_week_effect">week_effect</code></td>
<td>
<p>Logical defaulting to <code>TRUE</code>. Should a day of the week
effect be used in the observation model.</p>
</td></tr>
<tr><td><code id="obs_opts_+3A_week_length">week_length</code></td>
<td>
<p>Numeric assumed length of the week in days, defaulting to
7 days. This can be modified if data aggregated over a period other than a
week or if data has a non-weekly periodicity.</p>
</td></tr>
<tr><td><code id="obs_opts_+3A_scale">scale</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> specifying a prior on the scaling factor to be
applied to map latent infections (convolved to date of report).  Defaults
to a fixed value of 1, i.e. no scaling: <code>Fixed(1)</code>. A lower limit of zero
will be enforced automatically. If setting to a prior distribution and no
overreporting is expected, it might be sensible to set a maximum of 1 via
the <code>max</code> option when declaring the distribution.</p>
</td></tr>
<tr><td><code id="obs_opts_+3A_na">na</code></td>
<td>
<p>Deprecated; use the <code><a href="#topic+fill_missing">fill_missing()</a></code> function instead</p>
</td></tr>
<tr><td><code id="obs_opts_+3A_likelihood">likelihood</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code>. Should the likelihood be
included in the model.</p>
</td></tr>
<tr><td><code id="obs_opts_+3A_return_likelihood">return_likelihood</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should the likelihood
be returned by the model.</p>
</td></tr>
<tr><td><code id="obs_opts_+3A_phi">phi</code></td>
<td>
<p>deprecated; use <code>dispersion</code> instead</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;&lt;obs_opts&gt;&#8288;</code> object of observation model settings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default settings
obs_opts()

# Turn off day of the week effect
obs_opts(week_effect = TRUE)

# Scale reported data
obs_opts(scale = Normal(mean = 0.2, sd = 0.02))
</code></pre>

<hr>
<h2 id='opts_list'>Forecast optiong</h2><span id='topic+opts_list'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Define a list of <code style="white-space: pre;">&#8288;_opts()&#8288;</code> to pass to <code><a href="#topic+regional_epinow">regional_epinow()</a></code> <code style="white-space: pre;">&#8288;_opts()&#8288;</code> accepting
arguments. This is useful when different settings are needed between regions
within a single <code><a href="#topic+regional_epinow">regional_epinow()</a></code> call. Using <code><a href="#topic+opts_list">opts_list()</a></code> the defaults
can be applied to all regions present with an override passed to regions as
necessary (either within <code><a href="#topic+opts_list">opts_list()</a></code> or externally).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opts_list(opts, reported_cases, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opts_list_+3A_opts">opts</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;_opts()&#8288;</code> function call such as <code><a href="#topic+rt_opts">rt_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="opts_list_+3A_reported_cases">reported_cases</code></td>
<td>
<p>A data frame containing a <code>region</code> variable
indicating the target regions.</p>
</td></tr>
<tr><td><code id="opts_list_+3A_...">...</code></td>
<td>
<p>Optional override for region defaults. See the examples
for use case.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of options per region which can be passed to the <code style="white-space: pre;">&#8288;_opt&#8288;</code>
accepting arguments of <code>regional_epinow</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regional_epinow">regional_epinow()</a></code> <code><a href="#topic+rt_opts">rt_opts()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># uses example case vector
cases &lt;- example_confirmed[1:40]
cases &lt;- data.table::rbindlist(list(
  data.table::copy(cases)[, region := "testland"],
  cases[, region := "realland"]
))

# default settings
opts_list(rt_opts(), cases)

# add a weekly random walk in realland
opts_list(rt_opts(), cases, realland = rt_opts(rw = 7))

# add a weekly random walk externally
rt &lt;- opts_list(rt_opts(), cases)
rt$realland$rw &lt;- 7
rt
</code></pre>

<hr>
<h2 id='plot_CrIs'>Plot EpiNow2 Credible Intervals</h2><span id='topic+plot_CrIs'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Adds lineranges for user specified credible intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_CrIs(plot, CrIs, alpha, linewidth)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_CrIs_+3A_plot">plot</code></td>
<td>
<p>A <code>{ggplot2}</code> plot</p>
</td></tr>
<tr><td><code id="plot_CrIs_+3A_cris">CrIs</code></td>
<td>
<p>Numeric list of credible intervals present in the data. As
produced by <code><a href="#topic+extract_CrIs">extract_CrIs()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_CrIs_+3A_alpha">alpha</code></td>
<td>
<p>Numeric, overall alpha of the target line range</p>
</td></tr>
<tr><td><code id="plot_CrIs_+3A_linewidth">linewidth</code></td>
<td>
<p>Numeric, line width of the default line range.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>{ggplot2}</code> plot.
</p>

<hr>
<h2 id='plot_estimates'>Plot Estimates</h2><span id='topic+plot_estimates'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
Allows users to plot the output from <code><a href="#topic+estimate_infections">estimate_infections()</a></code> easily.
In future releases it may be depreciated in favour of increasing the
functionality of the S3 plot methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_estimates(
  estimate,
  reported,
  ylab,
  hline,
  obs_as_col = TRUE,
  max_plot = 10,
  estimate_type = c("Estimate", "Estimate based on partial data", "Forecast")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_estimates_+3A_estimate">estimate</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.table&gt;&#8288;</code> of estimates containing the following
variables: date, type (must contain &quot;estimate&quot;, &quot;estimate based on partial
data&quot; and optionally &quot;forecast&quot;).</p>
</td></tr>
<tr><td><code id="plot_estimates_+3A_reported">reported</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.table&gt;&#8288;</code> of reported cases with the following
variables: date, confirm.</p>
</td></tr>
<tr><td><code id="plot_estimates_+3A_ylab">ylab</code></td>
<td>
<p>Character string. Title for the plot y
axis.</p>
</td></tr>
<tr><td><code id="plot_estimates_+3A_hline">hline</code></td>
<td>
<p>Numeric, if supplied gives the horizontal intercept for a
indicator line.</p>
</td></tr>
<tr><td><code id="plot_estimates_+3A_obs_as_col">obs_as_col</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code>. Should observed data, if
supplied, be plotted using columns or as points (linked using a line).</p>
</td></tr>
<tr><td><code id="plot_estimates_+3A_max_plot">max_plot</code></td>
<td>
<p>Numeric, defaults to 10. A multiplicative upper bound on the\
number of cases shown on the plot. Based on the maximum number of reported
cases.</p>
</td></tr>
<tr><td><code id="plot_estimates_+3A_estimate_type">estimate_type</code></td>
<td>
<p>Character vector indicating the type of data to plot.
Default to all types with supported options being: &quot;Estimate&quot;, &quot;Estimate
based on partial data&quot;, and &quot;Forecast&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example model results
out &lt;- readRDS(system.file(
  package = "EpiNow2", "extdata", "example_estimate_infections.rds"
))

# plot infections
plot_estimates(
  estimate = out$summarised[variable == "infections"],
  reported = out$observations,
  ylab = "Cases", max_plot = 2
) + ggplot2::facet_wrap(~type, scales = "free_y")

# plot reported cases estimated via Rt
plot_estimates(
  estimate = out$summarised[variable == "reported_cases"],
  reported = out$observations,
  ylab = "Cases"
)

# plot Rt estimates
plot_estimates(
  estimate = out$summarised[variable == "R"],
  ylab = "Effective Reproduction No.",
  hline = 1
)

#' # plot Rt estimates without forecasts
plot_estimates(
  estimate = out$summarised[variable == "R"],
  ylab = "Effective Reproduction No.",
  hline = 1, estimate_type = "Estimate"
)
</code></pre>

<hr>
<h2 id='plot_summary'>Plot a Summary of the Latest Results</h2><span id='topic+plot_summary'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
Used to return a summary plot across regions (using results generated by
<code><a href="#topic+summarise_results">summarise_results()</a></code>).
</p>
<p>May be depreciated in later releases in favour of enhanced S3 methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_summary(summary_results, x_lab = "Region", log_cases = FALSE, max_cases)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_summary_+3A_summary_results">summary_results</code></td>
<td>
<p>A data.table as returned by <code><a href="#topic+summarise_results">summarise_results()</a></code> (the
<code>data</code> object).</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_x_lab">x_lab</code></td>
<td>
<p>A character string giving the label for the x axis, defaults to
region.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_log_cases">log_cases</code></td>
<td>
<p>Logical, should cases be shown on a logged scale. Defaults
to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_max_cases">max_cases</code></td>
<td>
<p>Numeric, no default. The maximum number of cases to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>{ggplot2}</code> object
</p>

<hr>
<h2 id='plot.dist_spec'>Plot PMF and CDF for a dist_spec object</h2><span id='topic+plot.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This function takes a <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> object and plots its probability mass
function (PMF) and cumulative distribution function (CDF) using <code>{ggplot2}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
plot(x, samples = 50L, res = 1, cumulative = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.dist_spec_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> object</p>
</td></tr>
<tr><td><code id="plot.dist_spec_+3A_samples">samples</code></td>
<td>
<p>Integer; Number of samples to generate for distributions
with uncertain parameters (default: 50).</p>
</td></tr>
<tr><td><code id="plot.dist_spec_+3A_res">res</code></td>
<td>
<p>Numeric; Resolution of the PMF and CDF (default: 1, i.e. integer
discretisation).</p>
</td></tr>
<tr><td><code id="plot.dist_spec_+3A_cumulative">cumulative</code></td>
<td>
<p>Logical; whether to plot the cumulative distribution in
addition to the probability mass function</p>
</td></tr>
<tr><td><code id="plot.dist_spec_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># A fixed lognormal distribution with mean 5 and sd 1.
dist1 &lt;- LogNormal(mean = 1.6, sd = 0.5, max = 20)
# Plot discretised distribution with 1 day discretisation window
plot(dist1)
# Plot discretised distribution with 0.01 day discretisation window
plot(dist1, res = 0.01, cumulative = FALSE)

# An uncertain gamma distribution with shape and rate normally distributed
# as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- Gamma(
  shape = Normal(3, 0.5),
  rate = Normal(2, 0.5),
  max = 20
)
plot(dist2)

# Multiple distributions with 0.1 discretisation window and do not plot the
# cumulative distribution
plot(dist1 + dist2, res = 0.1, cumulative = FALSE)
</code></pre>

<hr>
<h2 id='plot.epinow'>Plot method for epinow</h2><span id='topic+plot.epinow'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
<code>plot</code> method for class <code style="white-space: pre;">&#8288;&lt;epinow&gt;&#8288;</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epinow'
plot(x, type = "summary", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.epinow_+3A_x">x</code></td>
<td>
<p>A list of output as produced by <code><a href="#topic+epinow">epinow()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.epinow_+3A_type">type</code></td>
<td>
<p>A character vector indicating the name of the plot to return.
Defaults to  &quot;summary&quot; with supported options being &quot;infections&quot;, &quot;reports&quot;,
&quot;R&quot;, &quot;growth_rate&quot;, &quot;summary&quot;, &quot;all&quot;. If &quot;all&quot; is supplied all plots are
generated.</p>
</td></tr>
<tr><td><code id="plot.epinow_+3A_...">...</code></td>
<td>
<p>Pass additional arguments to report_plots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of plots as produced by <code><a href="#topic+report_plots">report_plots()</a></code>
</p>


<h3>See Also</h3>

<p>plot plot.estimate_infections report_plots estimate_infections
</p>

<hr>
<h2 id='plot.estimate_infections'>Plot method for estimate_infections</h2><span id='topic+plot.estimate_infections'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
<code>plot</code> method for class <code style="white-space: pre;">&#8288;&lt;estimate_infections&gt;&#8288;</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estimate_infections'
plot(
  x,
  type = c("summary", "infections", "reports", "R", "growth_rate", "all"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.estimate_infections_+3A_x">x</code></td>
<td>
<p>A list of output as produced by <code>estimate_infections</code></p>
</td></tr>
<tr><td><code id="plot.estimate_infections_+3A_type">type</code></td>
<td>
<p>A character vector indicating the name of the plot to return.
Defaults to  &quot;summary&quot; with supported options being &quot;infections&quot;, &quot;reports&quot;,
&quot;R&quot;, &quot;growth_rate&quot;, &quot;summary&quot;, &quot;all&quot;. If &quot;all&quot; is supplied all plots are
generated.</p>
</td></tr>
<tr><td><code id="plot.estimate_infections_+3A_...">...</code></td>
<td>
<p>Pass additional arguments to report_plots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of plots as produced by <code><a href="#topic+report_plots">report_plots()</a></code>
</p>


<h3>See Also</h3>

<p>plot report_plots estimate_infections
</p>

<hr>
<h2 id='plot.estimate_secondary'>Plot method for estimate_secondary</h2><span id='topic+plot.estimate_secondary'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
<code>plot</code> method for class &quot;estimate_secondary&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estimate_secondary'
plot(x, primary = FALSE, from = NULL, to = NULL, new_obs = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.estimate_secondary_+3A_x">x</code></td>
<td>
<p>A list of output as produced by <code>estimate_secondary</code></p>
</td></tr>
<tr><td><code id="plot.estimate_secondary_+3A_primary">primary</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should <code>primary</code> reports also
be plot?</p>
</td></tr>
<tr><td><code id="plot.estimate_secondary_+3A_from">from</code></td>
<td>
<p>Date object indicating when to plot from.</p>
</td></tr>
<tr><td><code id="plot.estimate_secondary_+3A_to">to</code></td>
<td>
<p>Date object indicating when to plot up to.</p>
</td></tr>
<tr><td><code id="plot.estimate_secondary_+3A_new_obs">new_obs</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing the columns <code>date</code> and <code>secondary</code>
which replace the secondary observations stored in the <code>estimate_secondary</code>
output.</p>
</td></tr>
<tr><td><code id="plot.estimate_secondary_+3A_...">...</code></td>
<td>
<p>Pass additional arguments to plot function. Not currently in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object.
</p>


<h3>See Also</h3>

<p>plot estimate_secondary
</p>

<hr>
<h2 id='plot.estimate_truncation'>Plot method for estimate_truncation</h2><span id='topic+plot.estimate_truncation'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
<code><a href="#topic+plot">plot()</a></code> method for class <code style="white-space: pre;">&#8288;&lt;estimate_truncation&gt;&#8288;</code>. Returns
a plot faceted over each dataset used in fitting with the latest
observations as columns, the data observed at the time (and so truncated)
as dots and the truncation adjusted estimates as a ribbon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estimate_truncation'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.estimate_truncation_+3A_x">x</code></td>
<td>
<p>A list of output as produced by <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code></p>
</td></tr>
<tr><td><code id="plot.estimate_truncation_+3A_...">...</code></td>
<td>
<p>Pass additional arguments to plot function. Not currently in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggplot2</code> object
</p>


<h3>See Also</h3>

<p>plot estimate_truncation
</p>

<hr>
<h2 id='print.dist_spec'>Prints the parameters of one or more delay distributions</h2><span id='topic+print.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This displays the parameters of the uncertain and probability mass
functions of fixed delay distributions combined in the passed &lt;dist_spec&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.dist_spec_+3A_x">x</code></td>
<td>
<p>The <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> to use</p>
</td></tr>
<tr><td><code id="print.dist_spec_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' # A fixed lognormal distribution with mean 5 and sd 1.
dist1 &lt;- LogNormal(mean = 1.5, sd = 0.5, max = 20)
print(dist1)

# An uncertain gamma distribution with shape and rate normally distributed
# as Normal(3, 0.5) and Normal(2, 0.5) respectively
dist2 &lt;- Gamma(
  shape = Normal(3, 0.5), rate = Normal(2, 0.5), max = 20
)
print(dist2)
</code></pre>

<hr>
<h2 id='process_region'>Process regional estimate</h2><span id='topic+process_region'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Internal function that removes output that is not required, and returns
logging information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_region(
  out,
  target_region,
  timing,
  return_output = TRUE,
  return_timing = TRUE,
  complete_logger = "EpiNow2.epinow"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_region_+3A_out">out</code></td>
<td>
<p>List of output returned by <code><a href="#topic+epinow">epinow()</a></code></p>
</td></tr>
<tr><td><code id="process_region_+3A_target_region">target_region</code></td>
<td>
<p>Character string indicating the region being evaluated</p>
</td></tr>
<tr><td><code id="process_region_+3A_timing">timing</code></td>
<td>
<p>Output from <code><a href="base.html#topic+Sys.time">Sys.time()</a></code></p>
</td></tr>
<tr><td><code id="process_region_+3A_return_output">return_output</code></td>
<td>
<p>Logical, defaults to FALSE. Should output be returned,
this automatically updates to TRUE if no directory for saving is specified.</p>
</td></tr>
<tr><td><code id="process_region_+3A_return_timing">return_timing</code></td>
<td>
<p>Logical, should runtime be returned</p>
</td></tr>
<tr><td><code id="process_region_+3A_complete_logger">complete_logger</code></td>
<td>
<p>Character string indicating the logger to output
the completion of estimation to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of processed output
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regional_epinow">regional_epinow()</a></code>
</p>

<hr>
<h2 id='process_regions'>Process all Region Estimates</h2><span id='topic+process_regions'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Internal function that processes the output from multiple <code><a href="#topic+epinow">epinow()</a></code> runs,
adds summary logging information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_regions(regional_out, regions)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_regions_+3A_regional_out">regional_out</code></td>
<td>
<p>A list of output from multiple runs of
<code><a href="#topic+regional_epinow">regional_epinow()</a></code></p>
</td></tr>
<tr><td><code id="process_regions_+3A_regions">regions</code></td>
<td>
<p>A character vector identifying the regions that have been run</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of all regional estimates and successful regional estimates
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regional_epinow">regional_epinow()</a></code> <code><a href="#topic+epinow">epinow()</a></code>
</p>

<hr>
<h2 id='R_to_growth'>Convert Reproduction Numbers to Growth Rates</h2><span id='topic+R_to_growth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
See <a href="https://www.medrxiv.org/content/10.1101/2020.01.30.20019877v3.full.pdf">here</a> # nolint
for justification. Now handled internally by stan so may be removed in
future updates if no user demand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R_to_growth(R, gamma_mean, gamma_sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="R_to_growth_+3A_r">R</code></td>
<td>
<p>Numeric, Reproduction number estimates</p>
</td></tr>
<tr><td><code id="R_to_growth_+3A_gamma_mean">gamma_mean</code></td>
<td>
<p>Numeric, mean of the gamma distribution</p>
</td></tr>
<tr><td><code id="R_to_growth_+3A_gamma_sd">gamma_sd</code></td>
<td>
<p>Numeric, standard deviation of the gamma distribution
.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of reproduction number estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>R_to_growth(2.18, 4, 1)
</code></pre>

<hr>
<h2 id='regional_epinow'>Real-time Rt Estimation, Forecasting and Reporting by Region</h2><span id='topic+regional_epinow'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Efficiently runs <code><a href="#topic+epinow">epinow()</a></code> across multiple regions in an efficient manner
and conducts basic data checks and cleaning such as removing regions with
fewer than <code>non_zero_points</code> as these are unlikely to produce reasonable
results whilst consuming significant resources. See the documentation for
<code><a href="#topic+epinow">epinow()</a></code> for further information.
</p>
<p>By default all arguments supporting input from <code style="white-space: pre;">&#8288;_opts()&#8288;</code> functions are
shared across regions (including delays, truncation, Rt settings, stan
settings, and gaussian process settings). Region specific settings are
supported by passing a named list of <code style="white-space: pre;">&#8288;_opts()&#8288;</code> calls (with an entry per
region) to the relevant argument. A helper function (<code><a href="#topic+opts_list">opts_list()</a></code>) is
available to facilitate building this list.
</p>
<p>Regions can be estimated in parallel using the <code>{future}</code> package (see
<code><a href="#topic+setup_future">setup_future()</a></code>). The progress of producing estimates across multiple
regions can be tracked using the <code>{progressr}</code> package. Modify this behaviour
using <code><a href="progressr.html#topic+handlers">progressr::handlers()</a></code> and enable it in batch by setting
<code>R_PROGRESSR_ENABLE=TRUE</code> as an environment variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regional_epinow(
  data,
  generation_time = gt_opts(),
  delays = delay_opts(),
  truncation = trunc_opts(),
  rt = rt_opts(),
  backcalc = backcalc_opts(),
  gp = gp_opts(),
  obs = obs_opts(),
  forecast = forecast_opts(),
  stan = stan_opts(),
  horizon,
  CrIs = c(0.2, 0.5, 0.9),
  target_folder = NULL,
  target_date,
  non_zero_points = 2,
  output = c("regions", "summary", "samples", "plots", "latest"),
  return_output = is.null(target_folder),
  summary_args = list(),
  verbose = FALSE,
  logs = tempdir(check = TRUE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regional_epinow_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date
(date), and region (<code>region</code>).</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_generation_time">generation_time</code></td>
<td>
<p>A call to <code><a href="#topic+gt_opts">gt_opts()</a></code> (or its alias
<code><a href="#topic+generation_time_opts">generation_time_opts()</a></code>) defining the generation time distribution used.
For backwards compatibility a list of summary parameters can also be passed.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_delays">delays</code></td>
<td>
<p>A call to <code><a href="#topic+delay_opts">delay_opts()</a></code> defining delay distributions and
options. See the documentation of <code><a href="#topic+delay_opts">delay_opts()</a></code> and the examples below for
details.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_truncation">truncation</code></td>
<td>
<p>A call to <code><a href="#topic+trunc_opts">trunc_opts()</a></code> defining the truncation of
the observed data. Defaults to <code><a href="#topic+trunc_opts">trunc_opts()</a></code>, i.e. no truncation.  See the
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> help file for an approach to estimating this from
data where the <code>dist</code> list element returned by <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> is
used as the <code>truncation</code> argument here, thereby propagating the uncertainty
in the estimate.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_rt">rt</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+rt_opts">rt_opts()</a></code> defining Rt
estimation. Defaults to <code><a href="#topic+rt_opts">rt_opts()</a></code>. To generate new infections using
the non-mechanistic model instead of the renewal equation model, use
<code>rt = NULL</code>. The non-mechanistic model internally uses the setting
<code>rt = rt_opts(use_rt = FALSE, future = "project", gp_on = "R0")</code>.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_backcalc">backcalc</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code> to
define the back calculation. Defaults to <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_gp">gp</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+gp_opts">gp_opts()</a></code> to define the
Gaussian process. Defaults to <code><a href="#topic+gp_opts">gp_opts()</a></code>. Set to <code>NULL</code> to disable the
Gaussian process.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_forecast">forecast</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+forecast_opts">forecast_opts()</a></code> defining
the forecast opitions. Defaults to <code><a href="#topic+forecast_opts">forecast_opts()</a></code>. If NULL then no
forecasting will be done.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_stan">stan</code></td>
<td>
<p>A list of stan options as generated by <code><a href="#topic+stan_opts">stan_opts()</a></code>. Defaults
to <code><a href="#topic+stan_opts">stan_opts()</a></code>. Can be used to override <code>data</code>, <code>init</code>, and <code>verbose</code>
settings if desired.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_horizon">horizon</code></td>
<td>
<p>Deprecated; use <code>forecast</code> instead to specify the predictive
horizon</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_target_date">target_date</code></td>
<td>
<p>Date, defaults to maximum found in the data if not
specified.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_non_zero_points">non_zero_points</code></td>
<td>
<p>Numeric, the minimum number of time points with
non-zero cases in a region required for that region to be evaluated.
Defaults to 7.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_output">output</code></td>
<td>
<p>A character vector of optional output to return. Supported
options are the individual regional estimates (&quot;regions&quot;),  samples
(&quot;samples&quot;), plots (&quot;plots&quot;), copying the individual region dated folder into
a latest folder (if <code>target_folder</code> is not null, set using &quot;latest&quot;), the
stan fit of the underlying model (&quot;fit&quot;), and an overall summary across
regions (&quot;summary&quot;). The default is to return samples and plots alongside
summarised estimates and summary statistics. If <code>target_folder</code> is not NULL
then the default is also to copy all results into a latest folder.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_return_output">return_output</code></td>
<td>
<p>Logical, defaults to FALSE. Should output be returned,
this automatically updates to TRUE if no directory for saving is specified.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_summary_args">summary_args</code></td>
<td>
<p>A list of arguments passed to <code><a href="#topic+regional_summary">regional_summary()</a></code>. See
the <code><a href="#topic+regional_summary">regional_summary()</a></code> documentation for details.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_verbose">verbose</code></td>
<td>
<p>Logical defaults to FALSE. Outputs verbose progress messages
to the console from <code><a href="#topic+epinow">epinow()</a></code>.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_logs">logs</code></td>
<td>
<p>Character path indicating the target folder in which to store log
information. Defaults to the temporary directory if not specified. Default
logging can be disabled if <code>logs</code> is set to NULL. If specifying a custom
logging setup then the code for <code><a href="#topic+setup_default_logging">setup_default_logging()</a></code> and the
<code><a href="#topic+setup_logging">setup_logging()</a></code> function are a sensible place to start.</p>
</td></tr>
<tr><td><code id="regional_epinow_+3A_...">...</code></td>
<td>
<p>Pass additional arguments to <code><a href="#topic+epinow">epinow()</a></code>. See the documentation for
<code><a href="#topic+epinow">epinow()</a></code> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of output stratified at the top level into regional output
and across region output summary output
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epinow">epinow()</a></code> <code><a href="#topic+estimate_infections">estimate_infections()</a></code> <code><a href="#topic+setup_future">setup_future()</a></code>
<code><a href="#topic+regional_summary">regional_summary()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# set number of cores to use
old_opts &lt;- options()
options(mc.cores = ifelse(interactive(), 4, 1))

# uses example case vector
cases &lt;- example_confirmed[1:60]
cases &lt;- data.table::rbindlist(list(
  data.table::copy(cases)[, region := "testland"],
  cases[, region := "realland"]
))

# run epinow across multiple regions and generate summaries
# samples and warmup have been reduced for this example
# for more examples, see the "estimate_infections examples" vignette
def &lt;- regional_epinow(
  data = cases,
  generation_time = gt_opts(example_generation_time),
  delays = delay_opts(example_incubation_period + example_reporting_delay),
  rt = rt_opts(prior = LogNormal(mean = 2, sd = 0.2)),
  stan = stan_opts(
    samples = 100, warmup = 200
  ),
  verbose = interactive()
)
options(old_opts)

</code></pre>

<hr>
<h2 id='regional_runtimes'>Summarise Regional Runtimes</h2><span id='topic+regional_runtimes'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Used internally by <code>regional_epinow</code> to summarise region run times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regional_runtimes(
  regional_output = NULL,
  target_folder = NULL,
  target_date = NULL,
  return_output = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regional_runtimes_+3A_regional_output">regional_output</code></td>
<td>
<p>A list of output as produced by <code><a href="#topic+regional_epinow">regional_epinow()</a></code>
and stored in the <code>regional</code> list.</p>
</td></tr>
<tr><td><code id="regional_runtimes_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="regional_runtimes_+3A_target_date">target_date</code></td>
<td>
<p>A character string giving the target date for which to
extract results
(in the format &quot;yyyy-mm-dd&quot;). Defaults to latest available estimates.</p>
</td></tr>
<tr><td><code id="regional_runtimes_+3A_return_output">return_output</code></td>
<td>
<p>Logical, defaults to FALSE. Should output be returned,
this automatically updates to TRUE if no directory for saving is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table of region run times
</p>


<h3>See Also</h3>

<p>regional_summary regional_epinow
</p>


<h3>Examples</h3>

<pre><code class='language-R'>regional_out &lt;- readRDS(system.file(
  package = "EpiNow2", "extdata", "example_regional_epinow.rds"
))
regional_runtimes(regional_output = regional_out$regional)
</code></pre>

<hr>
<h2 id='regional_summary'>Regional Summary Output</h2><span id='topic+regional_summary'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Used to produce summary output either internally in <code>regional_epinow</code> or
externally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regional_summary(
  regional_output = NULL,
  data,
  results_dir = NULL,
  summary_dir = NULL,
  target_date = NULL,
  region_scale = "Region",
  all_regions = TRUE,
  return_output = is.null(summary_dir),
  plot = TRUE,
  max_plot = 10,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regional_summary_+3A_regional_output">regional_output</code></td>
<td>
<p>A list of output as produced by <code><a href="#topic+regional_epinow">regional_epinow()</a></code>
and stored in the <code>regional</code> list.</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date
(date), and region (<code>region</code>).</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_results_dir">results_dir</code></td>
<td>
<p>An optional character string indicating the location of
the results directory to extract results from.</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_summary_dir">summary_dir</code></td>
<td>
<p>A character string giving the directory
in which to store summary of results.</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_target_date">target_date</code></td>
<td>
<p>A character string giving the target date for which to
extract results
(in the format &quot;yyyy-mm-dd&quot;). Defaults to latest available estimates.</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_region_scale">region_scale</code></td>
<td>
<p>A character string indicating the name to give the
regions being summarised.</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_all_regions">all_regions</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code>. Should summary plots for all
regions be returned rather than just regions of interest.</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_return_output">return_output</code></td>
<td>
<p>Logical, defaults to FALSE. Should output be returned,
this automatically updates to TRUE if no directory for saving is specified.</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_plot">plot</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code>. Should regional summary plots be
produced.</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_max_plot">max_plot</code></td>
<td>
<p>Numeric, defaults to 10. A multiplicative upper bound on the\
number of cases shown on the plot. Based on the maximum number of reported
cases.</p>
</td></tr>
<tr><td><code id="regional_summary_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>report_plots</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of summary measures and plots
</p>


<h3>See Also</h3>

<p>regional_epinow
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example output from regional_epinow model
regional_out &lt;- readRDS(system.file(
  package = "EpiNow2", "extdata", "example_regional_epinow.rds"
))

regional_summary(
  regional_output = regional_out$regional,
  data = regional_out$summary$reported_cases
)
</code></pre>

<hr>
<h2 id='report_plots'>Report plots</h2><span id='topic+report_plots'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
Returns key summary plots for estimates. May be depreciated in later
releases as current S3 methods are enhanced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report_plots(summarised_estimates, reported, target_folder = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="report_plots_+3A_summarised_estimates">summarised_estimates</code></td>
<td>
<p>A data.table of summarised estimates containing
the following variables: variable, median, bottom, and top.
</p>
<p>It should also contain the following estimates: R, infections,
reported_cases_rt, and r (rate of growth).</p>
</td></tr>
<tr><td><code id="report_plots_+3A_reported">reported</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.table&gt;&#8288;</code> of reported cases with the following
variables: date, confirm.</p>
</td></tr>
<tr><td><code id="report_plots_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="report_plots_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>plot_estimates()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of <code>ggplot2</code> objects, <code>list(infections, reports, R, growth_rate, summary)</code>, which correspond to a summary combination (last
item) and for the leading items.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_estimates">plot_estimates()</a></code> of
<code>summarised_estimates[variable == "infections"]</code>,
<code>summarised_estimates[variable == "reported_cases"]</code>,
<code>summarised_estimates[variable == "R"]</code>, and
<code>summarised_estimates[variable == "growth_rate"]</code>, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example output form estimate_infections
out &lt;- readRDS(system.file(
  package = "EpiNow2", "extdata", "example_estimate_infections.rds"
))

# plot infections
plots &lt;- report_plots(
  summarised_estimates = out$summarised,
  reported = out$observations
)
plots
</code></pre>

<hr>
<h2 id='report_summary'>Provide Summary Statistics for Estimated Infections and Rt</h2><span id='topic+report_summary'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
Creates a snapshot summary of estimates. May be removed in later releases as
S3 methods are enhanced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report_summary(
  summarised_estimates,
  rt_samples,
  target_folder = NULL,
  return_numeric = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="report_summary_+3A_summarised_estimates">summarised_estimates</code></td>
<td>
<p>A data.table of summarised estimates containing
the following variables: variable, median, bottom, and top. It should
contain the following estimates: R, infections, and r (rate of growth).</p>
</td></tr>
<tr><td><code id="report_summary_+3A_rt_samples">rt_samples</code></td>
<td>
<p>A data.table containing Rt samples with the following
variables: sample and value.</p>
</td></tr>
<tr><td><code id="report_summary_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="report_summary_+3A_return_numeric">return_numeric</code></td>
<td>
<p>Should numeric summary information be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table containing formatted and numeric summary measures
</p>

<hr>
<h2 id='rt_opts'>Time-Varying Reproduction Number Options</h2><span id='topic+rt_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Defines a list specifying the optional arguments for the time-varying
reproduction number. Custom settings can be supplied which override the
defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rt_opts(
  prior = LogNormal(mean = 1, sd = 1),
  use_rt = TRUE,
  rw = 0,
  use_breakpoints = TRUE,
  future = "latest",
  gp_on = c("R_t-1", "R0"),
  pop = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rt_opts_+3A_prior">prior</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;dist_spec&gt;&#8288;</code> giving the prior of the initial reproduciton
number. Ignored if <code>use_rt</code> is <code>FALSE</code>. Defaults to a LogNormal distributin
with mean of 1 and standard deviation of 1: <code>LogNormal(mean = 1, sd = 1)</code>.
A lower limit of 0 will be enforced automatically.</p>
</td></tr>
<tr><td><code id="rt_opts_+3A_use_rt">use_rt</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code>. Should Rt be used to generate
infections and hence reported cases.</p>
</td></tr>
<tr><td><code id="rt_opts_+3A_rw">rw</code></td>
<td>
<p>Numeric step size of the random walk, defaults to 0. To specify a
weekly random walk set <code>rw = 7</code>. For more custom break point settings
consider passing in a <code>breakpoints</code> variable as outlined in the next section.</p>
</td></tr>
<tr><td><code id="rt_opts_+3A_use_breakpoints">use_breakpoints</code></td>
<td>
<p>Logical, defaults to <code>TRUE</code>. Should break points be
used if present as a <code>breakpoint</code> variable in the input data. Break points
should be defined as 1 if present and otherwise 0. By default breakpoints
are fit jointly with a global non-parametric effect and so represent a
conservative estimate of break point changes (alter this by setting
<code>gp = NULL</code>).</p>
</td></tr>
<tr><td><code id="rt_opts_+3A_future">future</code></td>
<td>
<p>A character string or integer. This argument indicates how to
set future Rt values. Supported options are to project using the Rt model
(&quot;project&quot;), to use the latest estimate based on partial data (&quot;latest&quot;),
to use the latest estimate based on data that is over 50% complete
(&quot;estimate&quot;). If an integer is supplied then the Rt estimate from this many
days into the future (or past if negative) past will be used forwards in
time.</p>
</td></tr>
<tr><td><code id="rt_opts_+3A_gp_on">gp_on</code></td>
<td>
<p>Character string, defaulting to  &quot;R_t-1&quot;. Indicates how the
Gaussian process, if in use, should be applied to Rt. Currently supported
options are applying the Gaussian process to the last estimated Rt (i.e
Rt = Rt-1 * GP), and applying the Gaussian process to a global mean (i.e Rt
= R0 * GP). Both should produced comparable results when data is not sparse
but the method relying on a global mean will revert to this for real time
estimates, which may not be desirable.</p>
</td></tr>
<tr><td><code id="rt_opts_+3A_pop">pop</code></td>
<td>
<p>Integer, defaults to 0. Susceptible population initially present.
Used to adjust Rt estimates when otherwise fixed based on the proportion of
the population that is susceptible. When set to 0 no population adjustment
is done.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;&lt;rt_opts&gt;&#8288;</code> object with settings defining the time-varying
reproduction number.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default settings
rt_opts()

# add a custom length scale
rt_opts(prior = LogNormal(mean = 2, sd = 1))

# add a weekly random walk
rt_opts(rw = 7)
</code></pre>

<hr>
<h2 id='run_region'>Run epinow with Regional Processing Code</h2><span id='topic+run_region'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Internal function that handles calling <code><a href="#topic+epinow">epinow()</a></code>. Future work will extend
this function to better handle stan logs and allow the user to modify
settings between regions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_region(
  target_region,
  generation_time,
  delays,
  truncation,
  rt,
  backcalc,
  gp,
  obs,
  stan,
  horizon,
  CrIs,
  data,
  target_folder,
  target_date,
  return_output,
  output,
  complete_logger,
  verbose,
  progress_fn = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_region_+3A_target_region">target_region</code></td>
<td>
<p>Character string indicating the region being evaluated</p>
</td></tr>
<tr><td><code id="run_region_+3A_generation_time">generation_time</code></td>
<td>
<p>A call to <code><a href="#topic+gt_opts">gt_opts()</a></code> (or its alias
<code><a href="#topic+generation_time_opts">generation_time_opts()</a></code>) defining the generation time distribution used.
For backwards compatibility a list of summary parameters can also be passed.</p>
</td></tr>
<tr><td><code id="run_region_+3A_delays">delays</code></td>
<td>
<p>A call to <code><a href="#topic+delay_opts">delay_opts()</a></code> defining delay distributions and
options. See the documentation of <code><a href="#topic+delay_opts">delay_opts()</a></code> and the examples below for
details.</p>
</td></tr>
<tr><td><code id="run_region_+3A_truncation">truncation</code></td>
<td>
<p>A call to <code><a href="#topic+trunc_opts">trunc_opts()</a></code> defining the truncation of
the observed data. Defaults to <code><a href="#topic+trunc_opts">trunc_opts()</a></code>, i.e. no truncation.  See the
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> help file for an approach to estimating this from
data where the <code>dist</code> list element returned by <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> is
used as the <code>truncation</code> argument here, thereby propagating the uncertainty
in the estimate.</p>
</td></tr>
<tr><td><code id="run_region_+3A_rt">rt</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+rt_opts">rt_opts()</a></code> defining Rt
estimation. Defaults to <code><a href="#topic+rt_opts">rt_opts()</a></code>. To generate new infections using
the non-mechanistic model instead of the renewal equation model, use
<code>rt = NULL</code>. The non-mechanistic model internally uses the setting
<code>rt = rt_opts(use_rt = FALSE, future = "project", gp_on = "R0")</code>.</p>
</td></tr>
<tr><td><code id="run_region_+3A_backcalc">backcalc</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code> to
define the back calculation. Defaults to <code><a href="#topic+backcalc_opts">backcalc_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="run_region_+3A_gp">gp</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+gp_opts">gp_opts()</a></code> to define the
Gaussian process. Defaults to <code><a href="#topic+gp_opts">gp_opts()</a></code>. Set to <code>NULL</code> to disable the
Gaussian process.</p>
</td></tr>
<tr><td><code id="run_region_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="run_region_+3A_stan">stan</code></td>
<td>
<p>A list of stan options as generated by <code><a href="#topic+stan_opts">stan_opts()</a></code>. Defaults
to <code><a href="#topic+stan_opts">stan_opts()</a></code>. Can be used to override <code>data</code>, <code>init</code>, and <code>verbose</code>
settings if desired.</p>
</td></tr>
<tr><td><code id="run_region_+3A_horizon">horizon</code></td>
<td>
<p>Deprecated; use <code>forecast</code> instead to specify the predictive
horizon</p>
</td></tr>
<tr><td><code id="run_region_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="run_region_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date
(date), and region (<code>region</code>).</p>
</td></tr>
<tr><td><code id="run_region_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="run_region_+3A_target_date">target_date</code></td>
<td>
<p>Date, defaults to maximum found in the data if not
specified.</p>
</td></tr>
<tr><td><code id="run_region_+3A_return_output">return_output</code></td>
<td>
<p>Logical, defaults to FALSE. Should output be returned,
this automatically updates to TRUE if no directory for saving is specified.</p>
</td></tr>
<tr><td><code id="run_region_+3A_output">output</code></td>
<td>
<p>A character vector of optional output to return. Supported
options are the individual regional estimates (&quot;regions&quot;),  samples
(&quot;samples&quot;), plots (&quot;plots&quot;), copying the individual region dated folder into
a latest folder (if <code>target_folder</code> is not null, set using &quot;latest&quot;), the
stan fit of the underlying model (&quot;fit&quot;), and an overall summary across
regions (&quot;summary&quot;). The default is to return samples and plots alongside
summarised estimates and summary statistics. If <code>target_folder</code> is not NULL
then the default is also to copy all results into a latest folder.</p>
</td></tr>
<tr><td><code id="run_region_+3A_complete_logger">complete_logger</code></td>
<td>
<p>Character string indicating the logger to output
the completion of estimation to.</p>
</td></tr>
<tr><td><code id="run_region_+3A_verbose">verbose</code></td>
<td>
<p>Logical defaults to FALSE. Outputs verbose progress messages
to the console from <code><a href="#topic+epinow">epinow()</a></code>.</p>
</td></tr>
<tr><td><code id="run_region_+3A_progress_fn">progress_fn</code></td>
<td>
<p>Function as returned by <code><a href="progressr.html#topic+progressor">progressr::progressor()</a></code>. Allows
the use of a  progress bar. If NULL (default), no progress bar is used.</p>
</td></tr>
<tr><td><code id="run_region_+3A_...">...</code></td>
<td>
<p>Pass additional arguments to <code><a href="#topic+epinow">epinow()</a></code>. See the documentation for
<code><a href="#topic+epinow">epinow()</a></code> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of processed output as produced by <code><a href="#topic+process_region">process_region()</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regional_epinow">regional_epinow()</a></code>
</p>

<hr>
<h2 id='save_estimate_infections'>Save Estimated Infections</h2><span id='topic+save_estimate_infections'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Saves output from <code>estimate_infections</code> to a target directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_estimate_infections(
  estimates,
  target_folder = NULL,
  samples = TRUE,
  return_fit = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="save_estimate_infections_+3A_estimates">estimates</code></td>
<td>
<p>List of data frames as output by <code>estimate_infections</code></p>
</td></tr>
<tr><td><code id="save_estimate_infections_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="save_estimate_infections_+3A_samples">samples</code></td>
<td>
<p>Logical, defaults to TRUE. Should samples be saved</p>
</td></tr>
<tr><td><code id="save_estimate_infections_+3A_return_fit">return_fit</code></td>
<td>
<p>Logical, defaults to TRUE. Should the fit stan object
be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>See Also</h3>

<p>estimate_infections
</p>

<hr>
<h2 id='save_input'>Save Observed Data</h2><span id='topic+save_input'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Saves observed data to a target location if given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_input(data, target_folder)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="save_input_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
<tr><td><code id="save_input_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='sd'>Returns the standard deviation of one or more delay distribution</h2><span id='topic+sd'></span><span id='topic+sd.dist_spec'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This works out the standard deviation of all the (parametric /
nonparametric) delay distributions combined in the passed &lt;dist_spec&gt;.
If any of the parameters are themselves uncertain then <code>NA</code> is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_spec'
sd(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sd_+3A_x">x</code></td>
<td>
<p>The &lt;dist_spec&gt; to use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of standard deviations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# A fixed lognormal distribution with sd 5 and sd 1.
dist1 &lt;- LogNormal(mean = 5, sd = 1, max = 20)
sd(dist1)

# A gamma distribution with mean 3 and sd 2
dist2 &lt;- Gamma(mean = 3, sd = 2)
sd(dist2)

# The sd of the sum of two distributions
sd(dist1 + dist2)

## End(Not run)
</code></pre>

<hr>
<h2 id='secondary_opts'>Secondary Reports Options</h2><span id='topic+secondary_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Returns a list of options defining the secondary model used in
<code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>. This model is a combination of a convolution of
previously observed primary reports combined with current primary reports
(either additive or subtractive). It can optionally be cumulative. See the
documentation of <code>type</code> for sensible options to cover most use cases and the
returned values of <code><a href="#topic+secondary_opts">secondary_opts()</a></code> for all currently supported options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secondary_opts(type = c("incidence", "prevalence"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="secondary_opts_+3A_type">type</code></td>
<td>
<p>A character string indicating the type of observation the
secondary reports are. Options include:
</p>

<ul>
<li><p> &quot;incidence&quot;: Assumes that secondary reports equal a convolution of
previously observed primary reported cases. An example application is deaths
from an infectious disease predicted by reported cases of that disease (or
estimated infections).
</p>
</li>
<li><p> &quot;prevalence&quot;: Assumes that secondary reports are cumulative and are
defined by currently observed primary reports minus a convolution of
secondary reports. An example application is hospital bed usage predicted by
hospital admissions.
</p>
</li></ul>
</td></tr>
<tr><td><code id="secondary_opts_+3A_...">...</code></td>
<td>
<p>Overwrite options defined by type. See the returned values for all
options that can be passed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;secondary_opts&gt;&#8288;</code> object of binary options summarising secondary
model used in <code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>. Options returned are <code>cumulative</code>
(should the secondary report be cumulative), <code>historic</code> (should a
convolution of primary reported cases be used to predict secondary reported
cases), <code>primary_hist_additive</code> (should the historic convolution of primary
reported cases be additive or subtractive), <code>current</code> (should currently
observed primary reported cases contribute to current secondary reported
cases), <code>primary_current_additive</code> (should current primary reported cases be
additive or subtractive).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estimate_secondary">estimate_secondary()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># incidence model
secondary_opts("incidence")

# prevalence model
secondary_opts("prevalence")
</code></pre>

<hr>
<h2 id='set_dt_single_thread'>Set to Single Threading</h2><span id='topic+set_dt_single_thread'></span>

<h3>Description</h3>

<p>This function sets the threads used by <code>{data.table}</code> to 1 in the parent
function and then restores the initial <code>{data.table}</code> threads when the
function exits. This is primarily used as an internal function inside of
other functions and will generally not be used on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_dt_single_thread()
</code></pre>


<h3>Value</h3>

<p>an environment in the parent frame named &quot;dt_settings&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data.table::setDTthreads(2)
test_function &lt;- function() {
  set_dt_single_thread()

  print(data.table::getDTthreads())
}
test_function()
data.table::getDTthreads()

</code></pre>

<hr>
<h2 id='setup_default_logging'>Setup Default Logging</h2><span id='topic+setup_default_logging'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
Sets up default logging. Usage of logging is currently being explored as the
current setup cannot log stan errors or progress.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_default_logging(
  logs = tempdir(check = TRUE),
  mirror_epinow = FALSE,
  target_date = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup_default_logging_+3A_logs">logs</code></td>
<td>
<p>Character path indicating the target folder in which to store log
information. Defaults to the temporary directory if not specified. Default
logging can be disabled if <code>logs</code> is set to NULL. If specifying a custom
logging setup then the code for <code><a href="#topic+setup_default_logging">setup_default_logging()</a></code> and the
<code><a href="#topic+setup_logging">setup_logging()</a></code> function are a sensible place to start.</p>
</td></tr>
<tr><td><code id="setup_default_logging_+3A_mirror_epinow">mirror_epinow</code></td>
<td>
<p>Logical, defaults to FALSE. Should internal logging be
returned from <code><a href="#topic+epinow">epinow()</a></code> to the console.</p>
</td></tr>
<tr><td><code id="setup_default_logging_+3A_target_date">target_date</code></td>
<td>
<p>Date, defaults to maximum found in the data if not
specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>setup_default_logging()
</code></pre>

<hr>
<h2 id='setup_dt'>Convert to Data Table</h2><span id='topic+setup_dt'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Convenience function that sets the number of <code>{data.table}</code> cores to 1 and
maps input to be a <code>{data.table}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_dt(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup_dt_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data table
</p>

<hr>
<h2 id='setup_future'>Set up Future Backend</h2><span id='topic+setup_future'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
A utility function that aims to streamline the set up
of the required future backend with sensible defaults for most users of
<code><a href="#topic+regional_epinow">regional_epinow()</a></code>. More advanced users are recommended to setup their own
<code>{future}</code> backend based on their available resources. Running this requires
the <code>{future}</code> package to be installed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_future(
  data,
  strategies = c("multisession", "multisession"),
  min_cores_per_worker = 4
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup_future_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date
(date), and region (<code>region</code>).</p>
</td></tr>
<tr><td><code id="setup_future_+3A_strategies">strategies</code></td>
<td>
<p>A vector length 1 to 2 of strategies to pass to
<code><a href="future.html#topic+plan">future::plan()</a></code>. Nesting of parallelisation is from the top level down.
The default is to set up nesting parallelisation with both using
<code><a href="future.html#topic+multisession">future::multisession()</a></code> (<code><a href="future.html#topic+multicore">future::multicore()</a></code> will likely be a faster
option on supported platforms). For single level parallelisation use a
single strategy or <code><a href="future.html#topic+plan">future::plan()</a></code> directly. See <code><a href="future.html#topic+plan">future::plan()</a></code> for
options.</p>
</td></tr>
<tr><td><code id="setup_future_+3A_min_cores_per_worker">min_cores_per_worker</code></td>
<td>
<p>Numeric, the minimum number of cores per worker.
Defaults to 4 which assumes 4 MCMC chains are in use per region.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric number of cores to use per worker. If greater than 1 pass to
<code>stan_args = list(cores = "output from setup future")</code> or use
<code>future = TRUE</code>. If only a single strategy is used then nothing is returned.
</p>

<hr>
<h2 id='setup_logging'>Setup Logging</h2><span id='topic+setup_logging'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
Sets up <code>{futile.logger}</code> logging, which is integrated into <code>{EpiNow2}</code>.
See the documentation for <code>{futile.logger}</code> for full details. By default
<code>{EpiNow2}</code> prints all logs at the &quot;INFO&quot; level and returns them to the
console. Usage of logging is currently being explored as the current
setup cannot log stan errors or progress.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_logging(
  threshold = "INFO",
  file = NULL,
  mirror_to_console = FALSE,
  name = "EpiNow2"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup_logging_+3A_threshold">threshold</code></td>
<td>
<p>Character string indicating the logging level see
(?futile.logger for details of the available options). Defaults to &quot;INFO&quot;.</p>
</td></tr>
<tr><td><code id="setup_logging_+3A_file">file</code></td>
<td>
<p>Character string indicating the path to save logs to. By default
logs will be written to the console.</p>
</td></tr>
<tr><td><code id="setup_logging_+3A_mirror_to_console">mirror_to_console</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. If saving logs to a
file should they also be duplicated in the console.</p>
</td></tr>
<tr><td><code id="setup_logging_+3A_name">name</code></td>
<td>
<p>Character string defaulting to EpiNow2. This indicates the name
of the logger to setup. The default logger for EpiNow2 is called EpiNow2.
Nested options include: Epinow2.epinow which controls all logging for
<code><a href="#topic+epinow">epinow()</a></code> and nested functions, EpiNow2.epinow.estimate_infections
(logging in <code><a href="#topic+estimate_infections">estimate_infections()</a></code>, and
EpiNow2.epinow.estimate_infections.fit (logging in fitting functions).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>

<hr>
<h2 id='setup_target_folder'>Setup Target Folder for Saving</h2><span id='topic+setup_target_folder'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Sets up a folders for saving results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_target_folder(target_folder = NULL, target_date)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup_target_folder_+3A_target_folder">target_folder</code></td>
<td>
<p>Character string specifying where to save results (will
create if not present).</p>
</td></tr>
<tr><td><code id="setup_target_folder_+3A_target_date">target_date</code></td>
<td>
<p>Date, defaults to maximum found in the data if not
specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the path to the dated folder and the latest folder
</p>

<hr>
<h2 id='simulate_infections'>Simulate infections using the renewal equation</h2><span id='topic+simulate_infections'></span>

<h3>Description</h3>

<p>Simulations are done from given initial infections and, potentially
time-varying, reproduction numbers. Delays and parameters of the observation
model can be specified using the same options as in <code><a href="#topic+estimate_infections">estimate_infections()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_infections(
  R,
  initial_infections,
  day_of_week_effect = NULL,
  generation_time = generation_time_opts(),
  delays = delay_opts(),
  truncation = trunc_opts(),
  obs = obs_opts(),
  CrIs = c(0.2, 0.5, 0.9),
  backend = "rstan",
  seeding_time = NULL,
  pop = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_infections_+3A_r">R</code></td>
<td>
<p>a data frame of reproduction numbers (column <code>R</code>) by date (column
<code>date</code>). Column <code>R</code> must be numeric and <code>date</code> must be in date format. If
not all days between the first and last day in the <code>date</code> are present,
it will be assumed that R stays the same until the next given date.</p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_initial_infections">initial_infections</code></td>
<td>
<p>numeric; the initial number of infections (i.e.
before <code>R</code> applies). Note that results returned start the day after, i.e.
the initial number of infections is not reported again. See also
<code>seeding_time</code></p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_day_of_week_effect">day_of_week_effect</code></td>
<td>
<p>either <code>NULL</code> (no day of the week effect) or a
numerical vector of length specified in <code><a href="#topic+obs_opts">obs_opts()</a></code> as <code>week_length</code>
(default: 7) if <code>week_effect</code> is set to TRUE. Each element of the vector
gives the weight given to reporting on this day (normalised to 1).
The default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_generation_time">generation_time</code></td>
<td>
<p>A call to <code><a href="#topic+gt_opts">gt_opts()</a></code> (or its alias
<code><a href="#topic+generation_time_opts">generation_time_opts()</a></code>) defining the generation time distribution used.
For backwards compatibility a list of summary parameters can also be passed.</p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_delays">delays</code></td>
<td>
<p>A call to <code><a href="#topic+delay_opts">delay_opts()</a></code> defining delay distributions and
options. See the documentation of <code><a href="#topic+delay_opts">delay_opts()</a></code> and the examples below for
details.</p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_truncation">truncation</code></td>
<td>
<p>A call to <code><a href="#topic+trunc_opts">trunc_opts()</a></code> defining the truncation of
the observed data. Defaults to <code><a href="#topic+trunc_opts">trunc_opts()</a></code>, i.e. no truncation.  See the
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> help file for an approach to estimating this from
data where the <code>dist</code> list element returned by <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> is
used as the <code>truncation</code> argument here, thereby propagating the uncertainty
in the estimate.</p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_seeding_time">seeding_time</code></td>
<td>
<p>Integer; the number of days before the first time point
of <code>R</code>; default is <code>NULL</code>, in which case it is set to the maximum of the
generation time. The minimum is 1 , i.e. the first reproduction number
given applies on the day after the index cases given by
<code>initial_infections</code>. If the generation time is longer than 1 day on
average, a seeding time of 1 will always lead to an initial decline (as
there are no infections before the initial ones). Instead, if this is
greater than 1, an initial part of the epidemic (before the first value of
R given) of <code>seeding_time</code> days is assumed to have followed exponential
growth roughly in line with the growth rate implied by the first value of
R.</p>
</td></tr>
<tr><td><code id="simulate_infections_+3A_pop">pop</code></td>
<td>
<p>Integer, defaults to 0. Susceptible population initially present.
Used to adjust Rt estimates when otherwise fixed based on the proportion of
the population that is susceptible. When set to 0 no population adjustment
is done.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to simulate, all parameters that are specified such as the mean and
standard deviation of delays or observation scaling, must be fixed.
Uncertain parameters are not allowed.
</p>


<h3>Value</h3>

<p>A data.table of simulated infections (variable <code>infections</code>) and
reported cases (variable <code>reported_cases</code>) by date.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
R &lt;- data.frame(
  date = seq.Date(as.Date("2023-01-01"), length.out = 14, by = "day"),
  R = c(rep(1.2, 7), rep(0.8, 7))
)
sim &lt;- simulate_infections(
  R = R,
  initial_infections = 100,
  generation_time = generation_time_opts(
    fix_parameters(example_generation_time)
  ),
  delays = delay_opts(fix_parameters(example_reporting_delay)),
  obs = obs_opts(family = "poisson")
)

</code></pre>

<hr>
<h2 id='simulate_secondary'>Simulate secondary observations from primary observations</h2><span id='topic+simulate_secondary'></span>

<h3>Description</h3>

<p>Simulations are done from a given trajectory of primary observations by
applying any given delays and observation parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_secondary(
  primary,
  day_of_week_effect = NULL,
  secondary = secondary_opts(),
  delays = delay_opts(),
  truncation = trunc_opts(),
  obs = obs_opts(),
  CrIs = c(0.2, 0.5, 0.9),
  backend = "rstan"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_secondary_+3A_primary">primary</code></td>
<td>
<p>a data frame of primary reports (column <code>primary</code>) by date
(column <code>date</code>). Column <code>primary</code> must be numeric and <code>date</code> must be in
date format.  it will be assumed that <code>primary</code> is zero on the missing
days.</p>
</td></tr>
<tr><td><code id="simulate_secondary_+3A_day_of_week_effect">day_of_week_effect</code></td>
<td>
<p>either <code>NULL</code> (no day of the week effect) or a
numerical vector of length specified in <code><a href="#topic+obs_opts">obs_opts()</a></code> as <code>week_length</code>
(default: 7) if <code>week_effect</code> is set to TRUE. Each element of the vector
gives the weight given to reporting on this day (normalised to 1).
The default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="simulate_secondary_+3A_secondary">secondary</code></td>
<td>
<p>A call to <code><a href="#topic+secondary_opts">secondary_opts()</a></code> or a list containing the
following  binary variables: cumulative, historic, primary_hist_additive,
current, primary_current_additive. These parameters control the structure of
the secondary model, see <code><a href="#topic+secondary_opts">secondary_opts()</a></code> for details.</p>
</td></tr>
<tr><td><code id="simulate_secondary_+3A_delays">delays</code></td>
<td>
<p>A call to <code><a href="#topic+delay_opts">delay_opts()</a></code> defining delay distributions and
options. See the documentation of <code><a href="#topic+delay_opts">delay_opts()</a></code> and the examples below for
details.</p>
</td></tr>
<tr><td><code id="simulate_secondary_+3A_truncation">truncation</code></td>
<td>
<p>A call to <code><a href="#topic+trunc_opts">trunc_opts()</a></code> defining the truncation of
the observed data. Defaults to <code><a href="#topic+trunc_opts">trunc_opts()</a></code>, i.e. no truncation.  See the
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> help file for an approach to estimating this from
data where the <code>dist</code> list element returned by <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> is
used as the <code>truncation</code> argument here, thereby propagating the uncertainty
in the estimate.</p>
</td></tr>
<tr><td><code id="simulate_secondary_+3A_obs">obs</code></td>
<td>
<p>A list of options as generated by <code><a href="#topic+obs_opts">obs_opts()</a></code> defining the
observation model. Defaults to <code><a href="#topic+obs_opts">obs_opts()</a></code>.</p>
</td></tr>
<tr><td><code id="simulate_secondary_+3A_cris">CrIs</code></td>
<td>
<p>Numeric vector of credible intervals to calculate.</p>
</td></tr>
<tr><td><code id="simulate_secondary_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to simulate, all parameters that are specified such as the mean and
standard deviation of delays or observation scaling, must be fixed.
Uncertain parameters are not allowed.
</p>
<p>A function of the same name that was previously based on a reimplementation
of that model in R with potentially time-varying scalings and delays is
available as 'convolve_and_scale()
</p>


<h3>Value</h3>

<p>A data.table of simulated secondary observations (column <code>secondary</code>)
by date.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load data.table to manipulate `example_confirmed` below
library(data.table)
cases &lt;- as.data.table(example_confirmed)[, primary := confirm]
sim &lt;- simulate_secondary(
  cases,
  delays = delay_opts(fix_parameters(example_reporting_delay)),
  obs = obs_opts(family = "poisson")
)

</code></pre>

<hr>
<h2 id='stan_laplace_opts'>Stan Laplace algorithm Options</h2><span id='topic+stan_laplace_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
Defines a list specifying the arguments passed to <code><a href="cmdstanr.html#topic+model-method-laplace">cmdstanr::laplace()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_laplace_opts(backend = "cmdstanr", trials = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_laplace_opts_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
<tr><td><code id="stan_laplace_opts_+3A_trials">trials</code></td>
<td>
<p>Numeric, defaults to 10. Number of attempts to use
rstan::vb()] before failing.</p>
</td></tr>
<tr><td><code id="stan_laplace_opts_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to <code><a href="cmdstanr.html#topic+model-method-laplace">cmdstanr::laplace()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of arguments to pass to <code><a href="cmdstanr.html#topic+model-method-laplace">cmdstanr::laplace()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stan_laplace_opts()
</code></pre>

<hr>
<h2 id='stan_opts'>Stan Options</h2><span id='topic+stan_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Defines a list specifying the arguments passed to underlying stan
backend functions via <code><a href="#topic+stan_sampling_opts">stan_sampling_opts()</a></code> and <code><a href="#topic+stan_vb_opts">stan_vb_opts()</a></code>. Custom
settings can be supplied which override the defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_opts(
  object = NULL,
  samples = 2000,
  method = c("sampling", "vb", "laplace", "pathfinder"),
  backend = c("rstan", "cmdstanr"),
  return_fit = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_opts_+3A_object">object</code></td>
<td>
<p>Stan model object. By default uses the compiled package
default if using the &quot;rstan&quot; backend, and the default model obtained using
<code><a href="#topic+epinow2_cmdstan_model">epinow2_cmdstan_model()</a></code> if using the &quot;cmdstanr&quot; backend.</p>
</td></tr>
<tr><td><code id="stan_opts_+3A_samples">samples</code></td>
<td>
<p>Numeric, defaults to 2000. Number of posterior samples.</p>
</td></tr>
<tr><td><code id="stan_opts_+3A_method">method</code></td>
<td>
<p>A character string, defaulting to sampling. Currently supports
MCMC sampling (&quot;sampling&quot;) or approximate posterior sampling via
variational inference (&quot;vb&quot;) and, as experimental features if the
&quot;cmdstanr&quot; backend is used, approximate posterior sampling with the
laplace algorithm (&quot;laplace&quot;) or pathfinder (&quot;pathfinder&quot;).</p>
</td></tr>
<tr><td><code id="stan_opts_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
<tr><td><code id="stan_opts_+3A_return_fit">return_fit</code></td>
<td>
<p>Logical, defaults to TRUE. Should the fit stan model be
returned.</p>
</td></tr>
<tr><td><code id="stan_opts_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to underlying option functions,
<code><a href="#topic+stan_sampling_opts">stan_sampling_opts()</a></code> or <code><a href="#topic+stan_vb_opts">stan_vb_opts()</a></code>, depending on the method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;stan_opts&gt;&#8288;</code> object of arguments to pass to the appropriate
rstan functions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stan_sampling_opts">stan_sampling_opts()</a></code> <code><a href="#topic+stan_vb_opts">stan_vb_opts()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># using default of [rstan::sampling()]
stan_opts(samples = 1000)

# using vb
stan_opts(method = "vb")
</code></pre>

<hr>
<h2 id='stan_pathfinder_opts'>Stan pathfinder algorithm Options</h2><span id='topic+stan_pathfinder_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
Defines a list specifying the arguments passed to <code><a href="cmdstanr.html#topic+model-method-laplace">cmdstanr::laplace()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_pathfinder_opts(backend = "cmdstanr", samples = 2000, trials = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_pathfinder_opts_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
<tr><td><code id="stan_pathfinder_opts_+3A_samples">samples</code></td>
<td>
<p>Numeric, defaults to 2000. Number of posterior samples.</p>
</td></tr>
<tr><td><code id="stan_pathfinder_opts_+3A_trials">trials</code></td>
<td>
<p>Numeric, defaults to 10. Number of attempts to use
rstan::vb()] before failing.</p>
</td></tr>
<tr><td><code id="stan_pathfinder_opts_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to <code><a href="cmdstanr.html#topic+model-method-laplace">cmdstanr::laplace()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of arguments to pass to <code><a href="cmdstanr.html#topic+model-method-laplace">cmdstanr::laplace()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stan_laplace_opts()
</code></pre>

<hr>
<h2 id='stan_sampling_opts'>Stan Sampling Options</h2><span id='topic+stan_sampling_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Defines a list specifying the arguments passed to either <code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code>
or <code><a href="cmdstanr.html#topic+model-method-sample">cmdstanr::sample()</a></code>. Custom settings can be supplied which override the
defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_sampling_opts(
  cores = getOption("mc.cores", 1L),
  warmup = 250,
  samples = 2000,
  chains = 4,
  control = list(),
  save_warmup = FALSE,
  seed = as.integer(runif(1, 1, 1e+08)),
  future = FALSE,
  max_execution_time = Inf,
  backend = c("rstan", "cmdstanr"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_sampling_opts_+3A_cores">cores</code></td>
<td>
<p>Number of cores to use when executing the chains in parallel,
which defaults to 1 but it is recommended to set the mc.cores option to be
as many processors as the hardware and RAM allow (up to the number of
chains).</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_warmup">warmup</code></td>
<td>
<p>Numeric, defaults to 250. Number of warmup samples per chain.</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_samples">samples</code></td>
<td>
<p>Numeric, default 2000. Overall number of posterior samples.
When using multiple chains iterations per chain is samples / chains.</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_chains">chains</code></td>
<td>
<p>Numeric, defaults to 4. Number of MCMC chains to use.</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_control">control</code></td>
<td>
<p>List, defaults to empty. control parameters to pass to
underlying <code>rstan</code> function. By default <code>adapt_delta = 0.9</code> and
<code>max_treedepth = 12</code> though these settings can be overwritten.</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_save_warmup">save_warmup</code></td>
<td>
<p>Logical, defaults to FALSE. Should warmup progress be
saved.</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_seed">seed</code></td>
<td>
<p>Numeric, defaults uniform random number between 1 and 1e8. Seed
of sampling process.</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_future">future</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should stan chains be run in
parallel using <code>future</code>. This allows users to have chains fail gracefully
(i.e when combined with <code>max_execution_time</code>). Should be combined with a
call to <code><a href="future.html#topic+plan">future::plan()</a></code>.</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_max_execution_time">max_execution_time</code></td>
<td>
<p>Numeric, defaults to Inf (seconds). If set wil
kill off processing of each chain if not finished within the specified
timeout. When more than 2 chains finish successfully estimates will still be
returned. If less than 2 chains return within the allowed time then
estimation will fail with an informative error.</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_backend">backend</code></td>
<td>
<p>Character string indicating the backend to use for fitting
stan models. Supported arguments are &quot;rstan&quot; (default) or &quot;cmdstanr&quot;.</p>
</td></tr>
<tr><td><code id="stan_sampling_opts_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to <code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code> or
<code><a href="cmdstanr.html#topic+model-method-sample">cmdstanr::sample()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of arguments to pass to <code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code> or
<code><a href="cmdstanr.html#topic+model-method-sample">cmdstanr::sample()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stan_sampling_opts(samples = 2000)
</code></pre>

<hr>
<h2 id='stan_vb_opts'>Stan Variational Bayes Options</h2><span id='topic+stan_vb_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Defines a list specifying the arguments passed to <code><a href="rstan.html#topic+stanmodel-method-vb">rstan::vb()</a></code> or
<code><a href="cmdstanr.html#topic+model-method-variational">cmdstanr::variational()</a></code>. Custom settings can be supplied which override the
defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_vb_opts(samples = 2000, trials = 10, iter = 10000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_vb_opts_+3A_samples">samples</code></td>
<td>
<p>Numeric, default 2000. Overall number of approximate posterior
samples.</p>
</td></tr>
<tr><td><code id="stan_vb_opts_+3A_trials">trials</code></td>
<td>
<p>Numeric, defaults to 10. Number of attempts to use
rstan::vb()] before failing.</p>
</td></tr>
<tr><td><code id="stan_vb_opts_+3A_iter">iter</code></td>
<td>
<p>Numeric, defaulting to 10000. Number of iterations to use in
<code><a href="rstan.html#topic+stanmodel-method-vb">rstan::vb()</a></code>.</p>
</td></tr>
<tr><td><code id="stan_vb_opts_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to <code><a href="rstan.html#topic+stanmodel-method-vb">rstan::vb()</a></code> or
<code><a href="cmdstanr.html#topic+model-method-variational">cmdstanr::variational()</a></code>, depending on the chosen backend.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of arguments to pass to <code><a href="rstan.html#topic+stanmodel-method-vb">rstan::vb()</a></code> or
<code><a href="cmdstanr.html#topic+model-method-variational">cmdstanr::variational()</a></code>, depending on the chosen backend.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stan_vb_opts(samples = 1000)
</code></pre>

<hr>
<h2 id='summarise_key_measures'>Summarise rt and cases</h2><span id='topic+summarise_key_measures'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
Produces summarised <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>s of output across regions.
Used internally by <code>regional_summary</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise_key_measures(
  regional_results = NULL,
  results_dir = NULL,
  summary_dir = NULL,
  type = "region",
  date = "latest"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summarise_key_measures_+3A_regional_results">regional_results</code></td>
<td>
<p>A list of dataframes as produced by
<code>get_regional_results</code></p>
</td></tr>
<tr><td><code id="summarise_key_measures_+3A_results_dir">results_dir</code></td>
<td>
<p>Character string indicating the directory from which to
extract results.</p>
</td></tr>
<tr><td><code id="summarise_key_measures_+3A_summary_dir">summary_dir</code></td>
<td>
<p>Character string the directory into which to save results
as a csv.</p>
</td></tr>
<tr><td><code id="summarise_key_measures_+3A_type">type</code></td>
<td>
<p>Character string, the region identifier to apply (defaults to
region).</p>
</td></tr>
<tr><td><code id="summarise_key_measures_+3A_date">date</code></td>
<td>
<p>A Character string (in the format &quot;yyyy-mm-dd&quot;) indicating the
date to extract data for. Defaults to &quot;latest&quot; which finds the latest
results available.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of summarised Rt, cases by date of infection and cases by
date of report
</p>


<h3>See Also</h3>

<p>regional_summary
</p>

<hr>
<h2 id='summarise_results'>Summarise Real-time Results</h2><span id='topic+summarise_results'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
Used internally by <code>regional_summary</code> to produce a summary table of results.
May be streamlined in later releases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise_results(
  regions,
  summaries = NULL,
  results_dir = NULL,
  target_date = "latest",
  region_scale = "Region"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summarise_results_+3A_regions">regions</code></td>
<td>
<p>An character string containing the list of regions to extract
results for (must all have results for the same target date).</p>
</td></tr>
<tr><td><code id="summarise_results_+3A_summaries">summaries</code></td>
<td>
<p>A list of summary <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>s as output by <code>epinow</code></p>
</td></tr>
<tr><td><code id="summarise_results_+3A_results_dir">results_dir</code></td>
<td>
<p>An optional character string indicating the location of
the results directory to extract results from.</p>
</td></tr>
<tr><td><code id="summarise_results_+3A_target_date">target_date</code></td>
<td>
<p>A character string indicating the target date to extract
results for. All regions must have results
for this date.</p>
</td></tr>
<tr><td><code id="summarise_results_+3A_region_scale">region_scale</code></td>
<td>
<p>A character string indicating the name to give the
regions being summarised.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of summary data
</p>

<hr>
<h2 id='summary.epinow'>Summary output from epinow</h2><span id='topic+summary.epinow'></span><span id='topic+summary'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
<code>summary</code> method for class &quot;epinow&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epinow'
summary(
  object,
  output = c("estimates", "forecast", "estimated_reported_cases"),
  date = NULL,
  params = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.epinow_+3A_object">object</code></td>
<td>
<p>A list of output as produced by &quot;epinow&quot;.</p>
</td></tr>
<tr><td><code id="summary.epinow_+3A_output">output</code></td>
<td>
<p>A character string of output to summarise. Defaults to
&quot;estimates&quot; but also supports &quot;forecast&quot;, and &quot;estimated_reported_cases&quot;.</p>
</td></tr>
<tr><td><code id="summary.epinow_+3A_date">date</code></td>
<td>
<p>A date in the form &quot;yyyy-mm-dd&quot; to inspect estimates for.</p>
</td></tr>
<tr><td><code id="summary.epinow_+3A_params">params</code></td>
<td>
<p>A character vector of parameters to filter for.</p>
</td></tr>
<tr><td><code id="summary.epinow_+3A_...">...</code></td>
<td>
<p>Pass additional summary arguments to lower level methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of summary output
</p>


<h3>See Also</h3>

<p>summary.estimate_infections epinow
</p>

<hr>
<h2 id='summary.estimate_infections'>Summary output from estimate_infections</h2><span id='topic+summary.estimate_infections'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
<code>summary</code> method for class &quot;estimate_infections&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estimate_infections'
summary(
  object,
  type = c("snapshot", "parameters", "samples"),
  date = NULL,
  params = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.estimate_infections_+3A_object">object</code></td>
<td>
<p>A list of output as produced by &quot;estimate_infections&quot;.</p>
</td></tr>
<tr><td><code id="summary.estimate_infections_+3A_type">type</code></td>
<td>
<p>A character vector of data types to return. Defaults to
&quot;snapshot&quot; but also supports &quot;parameters&quot;, and &quot;samples&quot;. &quot;snapshot&quot; return
a summary at a given date (by default the latest date informed by data).
&quot;parameters&quot; returns summarised parameter estimates that can be further
filtered using <code>params</code> to show just the parameters of interest and date.
&quot;samples&quot; similarly returns posterior
samples.</p>
</td></tr>
<tr><td><code id="summary.estimate_infections_+3A_date">date</code></td>
<td>
<p>A date in the form &quot;yyyy-mm-dd&quot; to inspect estimates for.</p>
</td></tr>
<tr><td><code id="summary.estimate_infections_+3A_params">params</code></td>
<td>
<p>A character vector of parameters to filter for.</p>
</td></tr>
<tr><td><code id="summary.estimate_infections_+3A_...">...</code></td>
<td>
<p>Pass additional arguments to <code>report_summary</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of summary output
</p>


<h3>See Also</h3>

<p>summary estimate_infections report_summary
</p>

<hr>
<h2 id='trunc_opts'>Truncation Distribution Options</h2><span id='topic+trunc_opts'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Returns a truncation distribution formatted for usage by
downstream functions. See <code><a href="#topic+estimate_truncation">estimate_truncation()</a></code> for an approach to
estimate these distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trunc_opts(dist = Fixed(0), default_cdf_cutoff = 0.001, weight_prior = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trunc_opts_+3A_dist">dist</code></td>
<td>
<p>A delay distribution or series of delay distributions reflecting
the truncation. It can be specified using the probability distributions
interface in <code>EpiNow2</code> (See <code>?EpiNow2::Distributions</code>) or estimated using
<code><a href="#topic+estimate_truncation">estimate_truncation()</a></code>, which returns a <code>dist</code> object, suited
for use here out-of-box. Default is a fixed distribution with maximum 0, i.e.
no truncation.</p>
</td></tr>
<tr><td><code id="trunc_opts_+3A_default_cdf_cutoff">default_cdf_cutoff</code></td>
<td>
<p>Numeric; default CDF cutoff to be used if an
unconstrained distribution is passed as <code>dist</code>. If <code>dist</code> is already
constrained by having a maximum or CDF cutoff this is ignored. Note that
this can only be done for &lt;dist_spec&gt; objects with fixed parameters.</p>
</td></tr>
<tr><td><code id="trunc_opts_+3A_weight_prior">weight_prior</code></td>
<td>
<p>Logical; if TRUE, the truncation prior will be weighted
by the number of observation data points, in doing so approximately placing
an independent prior at each time step and usually preventing the
posteriors from shifting. If FALSE (default), no weight will be applied,
i.e. the truncation distribution will be treated as a single parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;trunc_opts&gt;&#8288;</code> object summarising the input truncation
distribution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_to_logmean">convert_to_logmean()</a></code> <code><a href="#topic+convert_to_logsd">convert_to_logsd()</a></code>
<code><a href="#topic+bootstrapped_dist_fit">bootstrapped_dist_fit()</a></code> <code><a href="#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># no truncation
trunc_opts()

# truncation dist
trunc_opts(dist = LogNormal(mean = 3, sd = 2, max = 10))
</code></pre>

<hr>
<h2 id='update_horizon'>Updates Forecast Horizon Based on Input Data and Target</h2><span id='topic+update_horizon'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
Makes sure that a forecast is returned for the user specified time period
beyond the target date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_horizon(horizon, target_date, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_horizon_+3A_horizon">horizon</code></td>
<td>
<p>Numeric, defaults to 7. Number of days into the future to
forecast.</p>
</td></tr>
<tr><td><code id="update_horizon_+3A_target_date">target_date</code></td>
<td>
<p>Date, defaults to maximum found in the data if not
specified.</p>
</td></tr>
<tr><td><code id="update_horizon_+3A_data">data</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of disease reports (confirm) by date (date).
<code>confirm</code> must be numeric and <code>date</code> must be in date format. Optionally
this can also have a logical <code>accumulate</code> column which indicates whether
data should be added to the next data point. This is useful when modelling
e.g. weekly incidence data. See also the <code><a href="#topic+fill_missing">fill_missing()</a></code> function which
helps add the <code>accumulate</code> column with the desired properties when dealing
with non-daily data. If any accumulation is done this happens after
truncation as specified by the <code>truncation</code> argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric forecast horizon adjusted for the users intention
</p>

<hr>
<h2 id='update_secondary_args'>Update estimate_secondary default priors</h2><span id='topic+update_secondary_args'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
This functions allows the user to more easily specify data driven or model
based priors for <code><a href="#topic+estimate_secondary">estimate_secondary()</a></code> from example from previous model
fits using a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> to overwrite other default settings. Note that
default settings are still required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_secondary_args(data, priors, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_secondary_args_+3A_data">data</code></td>
<td>
<p>A list of data and arguments as returned by <code>create_stan_data()</code>.</p>
</td></tr>
<tr><td><code id="update_secondary_args_+3A_priors">priors</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of named priors to be used in model fitting
rather than the defaults supplied from other arguments. This is typically
useful if wanting to inform a estimate from the posterior of another model
fit. Priors that are currently use to update the defaults are the scaling
fraction (&quot;frac_obs&quot;), and delay parameters (&quot;delay_params&quot;). The
<code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> should have the following variables: <code>variable</code>, <code>mean</code>, and
<code>sd</code>.</p>
</td></tr>
<tr><td><code id="update_secondary_args_+3A_verbose">verbose</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should verbose progress
messages be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list as produced by <code>create_stan_data()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>priors &lt;- data.frame(variable = "frac_obs", mean = 3, sd = 1)
data &lt;- list(obs_scale_mean = 4, obs_scale_sd = 3)
update_secondary_args(data, priors)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
