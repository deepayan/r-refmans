<!DOCTYPE html><html lang="en"><head><title>Help for package graphicalEvidence</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {graphicalEvidence}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#graphicalEvidence-package'>
<p>Compute Marginal Likelihood in Gaussian Graphical Models</p></a></li>
<li><a href='#evidence'><p>Compute Marginal Likelihood using Graphical Evidence</p></a></li>
<li><a href='#gen_params_evidence'><p>Generate Test Parameters</p></a></li>
<li><a href='#graphical_evidence_G_Wishart'><p>Compute Marginal Likelihood using Graphical Evidence under G Wishart</p></a></li>
<li><a href='#graphical_evidence_rmatrix'><p>Compute Marginal Likelihood using Graphical Evidence for Wishart,</p>
BGL, and GHS</a></li>
<li><a href='#prior_sampling'><p>Sample The Precision Matrix</p></a></li>
<li><a href='#set_seed_evidence'><p>Set the Random Seed</p></a></li>
<li><a href='#test_evidence'><p>Test Graphical Evidence</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Graphical Evidence</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-04</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Rowe &lt;david@rowe-stats.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes marginal likelihood in Gaussian graphical models through a
  novel telescoping block decomposition of the precision matrix which allows
  estimation of model evidence. The top level function used to estimate marginal
  likelihood is called evidence(), which expects the prior name, data, and
  relevant prior specific parameters. This package also provides an MCMC prior
  sampler using the same underlying approach, implemented in prior_sampling(),
  which expects a prior name and prior specific parameters. Both functions also
  expect the number of burn-in iterations and the number of sampling iterations
  for the underlying MCMC sampler.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, parallel, doParallel, foreach, mvtnorm</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>StagedInstall:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-06 16:58:15 UTC; dprow</td>
</tr>
<tr>
<td>Author:</td>
<td>David Rowe [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-07 11:40:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='graphicalEvidence-package'>
Compute Marginal Likelihood in Gaussian Graphical Models
</h2><span id='topic+graphicalEvidence-package'></span><span id='topic+graphicalEvidence'></span>

<h3>Description</h3>

<p>This package allows estimation of marginal likelihood in Gaussian graphical 
models through a novel telescoping block decomposition of the precision 
matrix which allows estimation of model evidence via an application of 
Chib's method. The currently implemented priors are: Bayesian graphical lasso 
(BGL), Graphical horseshoe (GHS), Wishart, and G-Wishart. The top level 
function used to estimate marginal likelihood is <code><a href="#topic+evidence">evidence</a></code> which 
expects the prior name, data, and relevant prior specific parameters. This 
package also provides an MCMC prior sampler for the priors of BGL, GHS, and 
G-Wishart, implemented in <code><a href="#topic+prior_sampling">prior_sampling</a></code>, which expects a prior 
name and prior specific parameters. Both functions also expect the number of 
burn-in iterations and the number of sampling iterations for the underlying 
MCMC sampler.
</p>
<p>Bhadra, A., Sagar, K., Rowe, D., Banerjee, S., &amp; Datta, J. (2022) 
&quot;Evidence Estimation in Gaussian Graphical Models Using a Telescoping Block 
Decomposition of the Precision Matrix.&quot; &lt;https://arxiv.org/abs/2205.01016&gt;
</p>
<p>Chib, S. &quot;Marginal likelihood from the Gibbs output.&quot; (1995) 
&lt;https://www.jstor.org/stable/2291521&gt;
</p>


<h3>Details</h3>

<p>This package implements marginal estimation for four priors, &quot;Wishart&quot;&quot;, 
Bayesian Graphical Lasso (&quot;BGL&quot;), graphical horseshoe (&quot;GHS&quot;), and 
&quot;G-Wishart&quot;. An MCMC prior sampler is also provided for &quot;BGL&quot;, &quot;GHS&quot;, and
&quot;G-Wishart&quot;.
</p>
<p>For more information and a faster, less portable implementation, visit the 
package repository on GitHub: 
<a href="https://github.com/dp-rho/graphicalEvidence">https://github.com/dp-rho/graphicalEvidence</a>
</p>


<h3>Author(s)</h3>

<p>Maintainer: David Rowe &lt;david@rowe-stats.com&gt;
</p>


<h3>References</h3>

<p>Bhadra, A., Sagar, K., Rowe, D., Banerjee, S., &amp; Datta, J. (2022) 
&quot;Evidence Estimation in Gaussian Graphical Models Using a Telescoping Block 
Decomposition of the Precision Matrix.&quot; &lt;https://arxiv.org/abs/2205.01016&gt;
</p>
<p>Chib, S. &quot;Marginal likelihood from the Gibbs output.&quot; (1995) 
&lt;https://www.jstor.org/stable/2291521&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+test_evidence">test_evidence</a></code>: For basic example of functionality
</p>
<p><code><a href="#topic+evidence">evidence</a></code>: For top level estimation function
</p>
<p><code><a href="#topic+prior_sampling">prior_sampling</a></code>: For the prior sampler function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  test_results &lt;- test_evidence(num_runs=3, prior_name='G_Wishart') 
</code></pre>

<hr>
<h2 id='evidence'>Compute Marginal Likelihood using Graphical Evidence</h2><span id='topic+evidence'></span>

<h3>Description</h3>

<p>Computes the marginal likelihood of input data xx under one of the following
priors: Wishart, Bayesian Graphical Lasso (BGL), 
Graphical Horseshoe (GHS), and G-Wishart, specified under prior_name. 
The number of runs is specified by num_runs, where each run is by default
using a random permutation of the columns of xx, as marginal likelihood 
should be independent of column permutation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evidence(
  xx,
  burnin,
  nmc,
  prior_name = c("Wishart", "BGL", "GHS", "G_Wishart"),
  runs = 1,
  print_progress = FALSE,
  permute_columns = TRUE,
  alpha = NULL,
  lambda = NULL,
  V = NULL,
  G = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evidence_+3A_xx">xx</code></td>
<td>
<p>The input data specified by a user for which the marginal 
likelihood is to be calculated. This should be input as a matrix like object
with each individual sample of xx representing one row</p>
</td></tr>
<tr><td><code id="evidence_+3A_burnin">burnin</code></td>
<td>
<p>The number of iterations the MCMC sampler should iterate 
through and discard before beginning to save results</p>
</td></tr>
<tr><td><code id="evidence_+3A_nmc">nmc</code></td>
<td>
<p>The number of samples that the MCMC sampler should use to estimate
marginal likelihood</p>
</td></tr>
<tr><td><code id="evidence_+3A_prior_name">prior_name</code></td>
<td>
<p>The name of the prior for which the marginal should be 
calculated, this is one of 'Wishart', 'BGL', 'GHS', 'G_Wishart'</p>
</td></tr>
<tr><td><code id="evidence_+3A_runs">runs</code></td>
<td>
<p>The number of complete runs of the graphical evidence method that
will be executed. Specifying multiple runs allows estimation of the variance
of the estimator and by default will permute the columns of xx such that 
each run uses a random column ordering, as marginal likelihood should be 
independent of column permutations</p>
</td></tr>
<tr><td><code id="evidence_+3A_print_progress">print_progress</code></td>
<td>
<p>A boolean which indicates whether progress should be 
displayed on the console as each row of the telescoping sum is computed and
each run is completed</p>
</td></tr>
<tr><td><code id="evidence_+3A_permute_columns">permute_columns</code></td>
<td>
<p>A boolean which indicates whether columns of xx for
runs beyond the first should be randomly permuted to ensure that 
marginal calculation is consistent across different column permutations</p>
</td></tr>
<tr><td><code id="evidence_+3A_alpha">alpha</code></td>
<td>
<p>A number specifying alpha for the priors of 'Wishart' and 
'G_Wishart'</p>
</td></tr>
<tr><td><code id="evidence_+3A_lambda">lambda</code></td>
<td>
<p>A number specifying lambda for the priors of 'BGL' and 'GHS'
prior</p>
</td></tr>
<tr><td><code id="evidence_+3A_v">V</code></td>
<td>
<p>The scale matrix when specifying 'Wishart' or 'G_Wishart' prior</p>
</td></tr>
<tr><td><code id="evidence_+3A_g">G</code></td>
<td>
<p>The adjacency matrix when specifying 'G_Wishart' prior</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results which contains the mean marginal likelihood, the
standard deviation of the estimator, and the raw results in a vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute the marginal 10 times with random column permutations of xx at each
# individual run for G-Wishart prior using 2,000 burnin and 10,000 sampled
# values at each call to the MCMC sampler
g_params &lt;- gen_params_evidence('G_Wishart')
marginal_results &lt;- evidence(
  g_params$x_mat, 2e3, 1e4, 'G_Wishart', 3, alpha=2, 
  V=g_params$scale_mat, G=g_params$g_mat
)
</code></pre>

<hr>
<h2 id='gen_params_evidence'>Generate Test Parameters</h2><span id='topic+gen_params_evidence'></span>

<h3>Description</h3>

<p>Generates predetermined parameters for testing the functionality of
the graphical evidence method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_params_evidence(prior_name = c("Wishart", "BGL", "GHS", "G_Wishart"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen_params_evidence_+3A_prior_name">prior_name</code></td>
<td>
<p>The name of the prior for being tested with preexisting
test parameters, this is one of 'Wishart', 'BGL', 'GHS', 'G_Wishart'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of matrices representing test parameters dependent on the 
prior specified in prior_name
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate test parameter matrices for G-Wishart prior 
gen_params_evidence('G_Wishart')
</code></pre>

<hr>
<h2 id='graphical_evidence_G_Wishart'>Compute Marginal Likelihood using Graphical Evidence under G Wishart</h2><span id='topic+graphical_evidence_G_Wishart'></span>

<h3>Description</h3>

<p>Computes the marginal likelihood of input data xx under G-Wishart prior using
graphical evidence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphical_evidence_G_Wishart(
  xx,
  burnin,
  nmc,
  alpha,
  V,
  G,
  print_progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="graphical_evidence_G_Wishart_+3A_xx">xx</code></td>
<td>
<p>The input data specified by a user for which the marginal 
likelihood is to be calculated. This should be input as a matrix like object
with each individual sample of xx representing one row</p>
</td></tr>
<tr><td><code id="graphical_evidence_G_Wishart_+3A_burnin">burnin</code></td>
<td>
<p>The number of iterations the MCMC sampler should iterate 
through and discard before beginning to save results</p>
</td></tr>
<tr><td><code id="graphical_evidence_G_Wishart_+3A_nmc">nmc</code></td>
<td>
<p>The number of samples that the MCMC sampler should use to estimate
marginal likelihood</p>
</td></tr>
<tr><td><code id="graphical_evidence_G_Wishart_+3A_alpha">alpha</code></td>
<td>
<p>A number specifying alpha for G-Wishart prior</p>
</td></tr>
<tr><td><code id="graphical_evidence_G_Wishart_+3A_v">V</code></td>
<td>
<p>The scale matrix of G-Wishart prior</p>
</td></tr>
<tr><td><code id="graphical_evidence_G_Wishart_+3A_g">G</code></td>
<td>
<p>The adjacency matrix of G-Wishart prior</p>
</td></tr>
<tr><td><code id="graphical_evidence_G_Wishart_+3A_print_progress">print_progress</code></td>
<td>
<p>A boolean which indicates whether progress should be 
displayed on the console as each row of the telescoping sum is computed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An estimate for the marginal likelihood under G-Wishart prior with
the specified parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute the marginal likelihood of xx for G-Wishart prior using 
# 2,000 burnin and 10,000 sampled values at each call to the MCMC sampler
g_params &lt;- gen_params_evidence('G_Wishart')
marginal_results &lt;- graphical_evidence_G_Wishart(
  g_params$x_mat, 2e3, 1e4, 2, g_params$scale_mat, g_params$g_mat
)
</code></pre>

<hr>
<h2 id='graphical_evidence_rmatrix'>Compute Marginal Likelihood using Graphical Evidence for Wishart,
BGL, and GHS</h2><span id='topic+graphical_evidence_rmatrix'></span>

<h3>Description</h3>

<p>Computes the marginal likelihood of input data xx under one of the following
priors: Wishart, Bayesian Graphical Lasso (BGL), and Graphical Horseshoe 
(GHS), specified under prior_name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphical_evidence_rmatrix(
  xx,
  burnin,
  nmc,
  prior_name = c("Wishart", "BGL", "GHS"),
  lambda = 0,
  alpha = 0,
  V = 0,
  print_progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="graphical_evidence_rmatrix_+3A_xx">xx</code></td>
<td>
<p>The input data specified by a user for which the marginal 
likelihood is to be calculated. This should be input as a matrix like object
with each individual sample of xx representing one row</p>
</td></tr>
<tr><td><code id="graphical_evidence_rmatrix_+3A_burnin">burnin</code></td>
<td>
<p>The number of iterations the MCMC sampler should iterate 
through and discard before beginning to save results</p>
</td></tr>
<tr><td><code id="graphical_evidence_rmatrix_+3A_nmc">nmc</code></td>
<td>
<p>The number of samples that the MCMC sampler should use to estimate
marginal likelihood</p>
</td></tr>
<tr><td><code id="graphical_evidence_rmatrix_+3A_prior_name">prior_name</code></td>
<td>
<p>The name of the prior for which the marginal should be 
calculated, this is one of 'Wishart', 'BGL', 'GHS'</p>
</td></tr>
<tr><td><code id="graphical_evidence_rmatrix_+3A_lambda">lambda</code></td>
<td>
<p>A number specifying lambda for the priors of 'BGL' and 'GHS'
prior</p>
</td></tr>
<tr><td><code id="graphical_evidence_rmatrix_+3A_alpha">alpha</code></td>
<td>
<p>A number specifying alpha for the priors of 'Wishart'</p>
</td></tr>
<tr><td><code id="graphical_evidence_rmatrix_+3A_v">V</code></td>
<td>
<p>The scale matrix when specifying 'Wishart'</p>
</td></tr>
<tr><td><code id="graphical_evidence_rmatrix_+3A_print_progress">print_progress</code></td>
<td>
<p>A boolean which indicates whether progress should be 
displayed on the console as each row of the telescoping sum is computed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An estimate for the marginal likelihood under specified prior with
the specified parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute the marginal likelihood of xx for GHS prior using 1,000 
# burnin and 5,000 sampled values at each call to the MCMC sampler
g_params &lt;- gen_params_evidence('GHS')
marginal_results &lt;- graphical_evidence_rmatrix(
  g_params$x_mat, 1e3, 5e3, 'GHS', lambda=1
)
</code></pre>

<hr>
<h2 id='prior_sampling'>Sample The Precision Matrix</h2><span id='topic+prior_sampling'></span>

<h3>Description</h3>

<p>Takes specified prior_name and relevant parameters to sample the precision
matrix nmc times after discarding the first number of runs specified by 
burnin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_sampling(
  p,
  burnin,
  nmc,
  prior_name = c("BGL", "GHS", "G_Wishart"),
  G = NULL,
  V = NULL,
  alpha = NULL,
  lambda = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prior_sampling_+3A_p">p</code></td>
<td>
<p>The dimension of the precision matrix that will be sampled</p>
</td></tr>
<tr><td><code id="prior_sampling_+3A_burnin">burnin</code></td>
<td>
<p>The number of iterations the MCMC sampler should iterate 
through and discard before beginning to save results</p>
</td></tr>
<tr><td><code id="prior_sampling_+3A_nmc">nmc</code></td>
<td>
<p>The number of samples that will be drawn</p>
</td></tr>
<tr><td><code id="prior_sampling_+3A_prior_name">prior_name</code></td>
<td>
<p>The name of the prior for which the marginal should be 
calculated, this is one of 'Wishart', 'BGL', 'GHS', 'G_Wishart'</p>
</td></tr>
<tr><td><code id="prior_sampling_+3A_g">G</code></td>
<td>
<p>The adjacency matrix when specifying 'G_Wishart' prior</p>
</td></tr>
<tr><td><code id="prior_sampling_+3A_v">V</code></td>
<td>
<p>The scale matrix when specifying 'Wishart' or 'G_Wishart' prior</p>
</td></tr>
<tr><td><code id="prior_sampling_+3A_alpha">alpha</code></td>
<td>
<p>A number specifying alpha for the priors of 'Wishart' and 
'G_Wishart'</p>
</td></tr>
<tr><td><code id="prior_sampling_+3A_lambda">lambda</code></td>
<td>
<p>A number specifying lambda for the priors of 'BGL' and 'GHS'
prior</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of dim nmc x p x p where each p x p slice is one sample of 
the precision matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Draw 5000 samples of the precision matrix for GHS prior distribution with
# parameter lambda set to 1
ghs_samples &lt;- prior_sampling(5, 1e3, 5e3, 'GHS', lambda=1)
</code></pre>

<hr>
<h2 id='set_seed_evidence'>Set the Random Seed</h2><span id='topic+set_seed_evidence'></span>

<h3>Description</h3>

<p>Sets the random seed of both the R session (using set.seed) and the compiled
sampler, as both samplers are used during any calls to evidence(...) or 
prior_sampling(...)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_seed_evidence(seed)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_seed_evidence_+3A_seed">seed</code></td>
<td>
<p>a random seed that will be passed to the interpreted random 
number generator using set.seed, and will be passed to the compiled random
number generator using private Rcpp package function set_seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, this function is called to set the random seed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set_seed_evidence(42)
</code></pre>

<hr>
<h2 id='test_evidence'>Test Graphical Evidence</h2><span id='topic+test_evidence'></span>

<h3>Description</h3>

<p>Tests any of the allowed priors with preexisting test inputs which
should yield reproducible results, as the random seed is reset during
this function call
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_evidence(
  num_runs,
  prior_name = c("Wishart", "BGL", "GHS", "G_Wishart"),
  input_seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_evidence_+3A_num_runs">num_runs</code></td>
<td>
<p>An integer number that specifies how many runs of 
graphical evidence will be executed on the test parameters, as multiple
runs allows us to quantify uncertainty on the estimator.</p>
</td></tr>
<tr><td><code id="test_evidence_+3A_prior_name">prior_name</code></td>
<td>
<p>The name of the prior for being tested with preexisting
test parameters, this is one of 'Wishart', 'BGL', 'GHS', 'G_Wishart'</p>
</td></tr>
<tr><td><code id="test_evidence_+3A_input_seed">input_seed</code></td>
<td>
<p>An integer value that will be used as a random seed to
make outputs repeatable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results which contains the mean marginal likelihood, the
standard deviation of the estimator, and the raw results in a vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute the marginal 10 times with random column permutations of the 
# preexisting test parameters for G-Wishart prior 
test_evidence(num_runs=3, 'G_Wishart')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
