<!DOCTYPE html><html><head><title>Help for package RLumModel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RLumModel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RLumModel-package'><p>Solving Ordinary Differential Equations to Understand Luminescence</p></a></li>
<li><a href='#.set_pars'><p>Set parameters for Different Quartz Luminescence Models</p></a></li>
<li><a href='#ExampleData.ModelOutput'><p>Example data (TL curve) simulated with parameter set from Pagonis 2007</p></a></li>
<li><a href='#model_LuminescenceSignals'><p>Model Luminescence Signals</p></a></li>
<li><a href='#read_SEQ2R'><p>Parse a Risoe SEQ-file to a sequence neccessary for simulating quartz luminescence</p></a></li>
<li><a href='#trace_ParameterStateEvolution'><p>Trace parameter state evolution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Solving Ordinary Differential Equations to Understand
Luminescence</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.10</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-02-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Johannes Friedrich
    <a href="https://orcid.org/0000-0002-0805-9547"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, trl,
    cre],
  Sebastian Kreutzer
    <a href="https://orcid.org/0000-0002-0734-2199"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, ths],
  Christoph Schmidt <a href="https://orcid.org/0000-0002-2309-3209"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Johannes Friedrich &lt;johannes.friedrich@posteo.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of functions to simulate luminescence signals in quartz and Al2O3 based on published models.</td>
</tr>
<tr>
<td>Contact:</td>
<td>Package Developer Team &lt;developer@model.r-luminescence.de&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/R-Lum/RLumModel/issues">https://github.com/R-Lum/RLumModel/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), utils, Luminescence (&ge; 0.9.18)</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve (&ge; 1.30), khroma (&ge; 1.8.0), methods, Rcpp (&ge; 1.0.8)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.1.0), R.rsp (&ge; 0.44.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=RLumModel">https://CRAN.R-project.org/package=RLumModel</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>RLumModel-package.R RcppExports.R calc_signal.R
calc_concentrations.R create_DRT.sequence.R
create_SAR.sequence.R extract_pars.R
model_LuminescenceSignals.R read_SEQ2R.R set_pars.R
simulate_CW_OSL.R simulate_heating.R simulate_illumination.R
simulate_irradiation.R simulate_LM_OSL.R simulate_pause.R
simulate_RF.R simulate_RF_and_heating.R simulate_TL.R
translate_sequence.R trace_ParameterStateEvolution.R</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp (&ge; 1.0.1), RcppArmadillo (&ge; 0.9.400.2.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-21 20:27:30 UTC; johannes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-22 00:40:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='RLumModel-package'>Solving Ordinary Differential Equations to Understand Luminescence</h2><span id='topic+RLumModel-package'></span>

<h3>Description</h3>


<p><img src="../help/figures/RLumModel_Logo.png" width="50" alt="RLumModel_Logo.png" /><br />

</p>


<h3>Details</h3>

<p>A collection of function to simulate luminescence signals in the mineral quartz based on
published models.
</p>
<p><strong>Authors</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
Johannes Friedrich </td><td style="text-align: left;"> University of Bayreuth, Germany </td>
</tr>
<tr>
 <td style="text-align: left;">
Sebastian Kreutzer </td><td style="text-align: left;"> Geography &amp; Earth Sciences, Aberystwyth University, United Kingdom</td>
</tr>
<tr>
 <td style="text-align: left;">
Christoph Schmidt </td><td style="text-align: left;"> University of Bayreuth, Germany
</td>
</tr>

</table>

<p><strong>Supervisor</strong>
</p>
<p>Christoph Schmidt, University of Bayreuth, Germany<br />
Sebastian Kreutzer,Geography &amp; Earth Sciences, Aberystwyth University, United Kingdom
#'
<strong>Project source code repository</strong>
</p>

<ul>
<li><p> https://github.com/R-Lum/RLumModel
</p>
</li></ul>

<p><strong>Related package projects</strong>
</p>

<ul>
<li><p> http://r-luminescence.de
</p>
</li>
<li><p> https://CRAN.r-project.org/package=Luminescence
</p>
</li>
<li><p> https://CRAN.r-project.org/package=RLumShiny
</p>
</li></ul>

<p><strong>Package maintainer</strong>
</p>
<p>Johannes Friedrich, University of Bayreuth, Germany
<br /> <a href="mailto:johannes.friedrich@posteo.de">johannes.friedrich@posteo.de</a>
</p>
<p><strong>Acknowledgement</strong>
</p>
<p>The work of Johannes Friedrich is gratefully supported by the DFG in framework of the project
'Modelling quartz luminescence signal dynamics relevant for dating and dosimetry' (SCHM 305114-1).
</p>

<hr>
<h2 id='.set_pars'>Set parameters for Different Quartz Luminescence Models</h2><span id='topic+.set_pars'></span>

<h3>Description</h3>

<p>This function provides all necessary model parameters to the
calculation of the ODEs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.set_pars(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".set_pars_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<b>required</b>): set model to be used.
Available models are: <code>"Bailey2001"</code>, <code>"Bailey2002"</code>, <code>"Bailey2004"</code>, <code>"Pagonis2007"</code>,
<code>"Pagonis2008"</code>, <code>"Friedrich2017"</code>, <code>"Friedrich2018"</code>, <code>"Peng2022"</code>. If model is indeed missing,
the list of allowed keywords is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The common model parameters are:
</p>
<p><b>N</b>: concentrations of electron/hole traps in cm^(-3)
<b>E</b>: depth of the electron/hole trap in eV
<b>s</b>: frequency factor in s^(-1)
<b>A</b>: conduction band to electron/hole trap transition probability in s^(-1)
<b>B</b>: valence band to hole trap transition probability in s^(-1)
<b>Th</b>: photo-ionisation cross-section in s^(-1)
<b>E_th</b>: thermal assistance energy in (eV)
<b>n</b>: concentrations of electron/hole traps after sample history in cm^(-3)
</p>


<h3>Value</h3>

<p>This function returns a <a href="base.html#topic+list">list</a> with all necessary parameters for
the used model. Returns vector of allowed keywords if model is missing.
</p>


<h3>Function version</h3>

<p>0.1.3
</p>


<h3>How to cite</h3>

<p>Friedrich, J., 2022. .set_pars(): Set parameters for Different Quartz Luminescence Models. Function version 0.1.3. In: Friedrich, J., Kreutzer, S., Schmidt, C., 2022. RLumModel: Solving Ordinary Differential Equations to Understand Luminescence. R package version 0.2.10. https://CRAN.R-project.org/package=RLumModel
</p>


<h3>Note</h3>

<p><b>n</b> are the saved concentrations of the last step of the sample history
of the used model. They will be loaded, if <code>simulate_sample_history = FALSE</code> in
<a href="#topic+model_LuminescenceSignals">model_LuminescenceSignals</a> is chosen.
</p>
<p>The order of the energy-band-levels is sometimes in an different order than in the original model.
This was necessary, because in the simulations the luminescence centre always
has to be the last entry in every parameter.
Another reason was the clear division between electron traps and hole centres.
When a user wants to create his/her own parameter sets he/she only has to take care that the
luminescence centre is the last entry in every vector and that the first entries
are the electron traps and the last entries the hole centres.
</p>


<h3>Author(s)</h3>

<p>Johannes Friedrich, University of Bayreuth (Germany),
</p>


<h3>References</h3>

<p>Bailey, R.M., 2001. Towards a general kinetic model for optically and thermally stimulated
luminescence of quartz. Radiation Measurements 33, 17-45.
</p>
<p>Bailey, R.M., 2002. Simulations of variability in the luminescence characteristics of natural
quartz and its implications for estimates of absorbed dose.
Radiation Protection Dosimetry 100, 33-38.
</p>
<p>Bailey, R.M., 2004. Paper I-simulation of dose absorption in quartz over geological timescales
and its implications for the precision and accuracy of optical dating.
Radiation Measurements 38, 299-310.
</p>
<p>Friedrich, J., Pagonis, V., Chen, R., Kreutzer, S., Schmidt, C., 2017: Quartz radiofluorescence: a modelling approach.
Journal of Luminescence 186, 318-325.
</p>
<p>Pagonis, V., Chen, R., Wintle, A.G., 2007. Modelling thermal transfer in optically
stimulated luminescence of quartz. Journal of Physics D: Applied Physics 40, 998-1006.
</p>
<p>Pagonis, V., Wintle, A.G., Chen, R., Wang, X.L., 2008. A theoretical model for a new dating protocol
for quartz based on thermally transferred OSL (TT-OSL).
Radiation Measurements 43, 704-708.
</p>
<p>Peng, J., Wang, X., Adamiec, G., 2022. The build-up of the laboratory-generated dose-response curve and underestimation of equivalent dose for quartz OSL in the high dose region: A critical modelling study. Quaternary Geochronology 67, 101231.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pars &lt;- .set_pars("Bailey2001")

</code></pre>

<hr>
<h2 id='ExampleData.ModelOutput'>Example data (TL curve) simulated with parameter set from Pagonis 2007</h2><span id='topic+ExampleData.ModelOutput'></span><span id='topic+model.output'></span>

<h3>Description</h3>

<p>Example data (TL curve) simulated with parameter set from Pagonis 2007
</p>


<h3>Format</h3>

<p>A RLum.Analysis object containing one TL curve as RLum.Data.Curve.
</p>


<h3>Function version</h3>

<p>0.1.1
</p>


<h3>Note</h3>

<p>This example has only one record (TL). The used sequence was
sequence &lt;- list(IRR = c(temp = 20, dose = 10, DoseRate = 1),
TL = c(temp_begin = 20, temp_end = 400, heating_rate = 5))
</p>


<h3>Author(s)</h3>

<p>Johannes Friedrich, University of Bayreuth (Germany)
</p>


<h3>Source</h3>

<p><b>model_LuminescenceSignals()</b>
</p>


<h3>References</h3>

<p>Pagonis, V., Chen, R., Wintle, A.G., 2007: Modelling thermal transfer in optically
stimulated luminescence of quartz. Journal of Physics D: Applied Physics 40, 998-1006.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("ExampleData.ModelOutput", envir = environment())

TL_curve &lt;- get_RLum(model.output, recordType = "TL$", drop = FALSE)

##plot TL curve
plot_RLum(TL_curve)

TL_concentrations &lt;- get_RLum(model.output, recordType = "(TL)", drop = FALSE)
plot_RLum(TL_concentrations)


</code></pre>

<hr>
<h2 id='model_LuminescenceSignals'>Model Luminescence Signals</h2><span id='topic+model_LuminescenceSignals'></span>

<h3>Description</h3>

<p>This function models luminescence signals for quartz based on published physical models.
It is possible to simulate TL, (CW-) OSL, RF measurements in a arbitrary sequence. This
sequence is defined as a <a href="base.html#topic+list">list</a> of certain aberrations. Furthermore it is possible to
load a sequence direct from the Risø Sequence Editor. The output is an <a href="Luminescence.html#topic+RLum.Analysis-class">Luminescence::RLum.Analysis</a> object and so the plots are done by the <a href="Luminescence.html#topic+plot_RLum.Analysis">Luminescence::plot_RLum.Analysis</a> function.
If a SAR sequence is simulated the plot output can be disabled and SAR analyse functions
can be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_LuminescenceSignals(
  model,
  sequence,
  lab.dose_rate = 1,
  simulate_sample_history = FALSE,
  plot = TRUE,
  verbose = TRUE,
  show_structure = FALSE,
  own_parameters = NULL,
  own_state_parameters = NULL,
  own_start_temperature = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_LuminescenceSignals_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): set model to be used. Available models are:
<code>"Bailey2001"</code>, <code>"Bailey2002"</code>, <code>"Bailey2004"</code>, <code>"Pagonis2007"</code>, <code>"Pagonis2008"</code>, <code>"Friedrich2017"</code>, <code>"Friedrich2018"</code>, <code style="white-space: pre;">&#8288;"Peng2022&#8288;</code>&quot; and for own models <code>"customized"</code> (or <code>"customised"</code>).
Note: When model = <code>"customized"</code>/<code style="white-space: pre;">&#8288;"customised&#8288;</code> is set, the argument <code>own_parameters</code> has to be set.</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_sequence">sequence</code></td>
<td>
<p><a href="base.html#topic+list">list</a> (<strong>required</strong>): set sequence to model as <a href="base.html#topic+list">list</a> or as *.seq file from the
Risø sequence editor. To simulate SAR measurements there is an extra option to set the sequence list (cf. details).</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_lab.dose_rate">lab.dose_rate</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): laboratory dose rate in XXX
Gy/s for calculating seconds into Gray in the *.seq file.</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_simulate_sample_history">simulate_sample_history</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): <code>FALSE</code> (with default):
simulation begins at laboratory conditions, <code>TRUE</code>: simulations begins at crystallization process (all levels 0)</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): Enables or disables plot output</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): Verbose mode on/off</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_show_structure">show_structure</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): Shows the structure of the result.
Recommended to show <code>record.id</code> to analyse concentrations.</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_own_parameters">own_parameters</code></td>
<td>
<p><a href="base.html#topic+list">list</a> (with default): This argument allows the user to submit own parameter sets. See details for more information.</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_own_state_parameters">own_state_parameters</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (with default): Some publications (e.g., Pagonis 2009)
offer state parameters. With this argument the user can submit this state parameters. For further details
see vignette &quot;RLumModel - Using own parameter sets&quot; and example 3. The parameter also accepts an
<a href="Luminescence.html#topic+RLum.Results-class">Luminescence::RLum.Results</a> object created by <a href="#topic+.set_pars">.set_pars</a> as input.</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_own_start_temperature">own_start_temperature</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (with default): Parameter to control the start temperature (in ºC) of
a simulation. This parameter takes effect only when 'model = &quot;customized&quot;' is chosen.</p>
</td></tr>
<tr><td><code id="model_LuminescenceSignals_+3A_...">...</code></td>
<td>
<p>further arguments and graphical parameters passed to
<a href="graphics.html#topic+plot.default">plot.default</a>. See details for further information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Defining a <code>sequence</code>
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Arguments</b> </td><td style="text-align: left;"> <b>Description</b> </td><td style="text-align: left;"> <b>Sub-arguments</b></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>TL</code> </td><td style="text-align: left;"> thermally stimulated luminescence </td><td style="text-align: left;"> 'temp begin' (ºC), 'temp end' (ºC), 'heating rate' (ºC/s)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>OSL</code></td><td style="text-align: left;"> optically stimulated luminescence </td><td style="text-align: left;"> 'temp' (ºC), 'duration' (s), 'optical_power' (%)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ILL</code></td><td style="text-align: left;"> illumination </td><td style="text-align: left;"> 'temp' (ºC), 'duration' (s), 'optical_power' (%)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>LM_OSL</code></td><td style="text-align: left;"> linear modulated OSL </td><td style="text-align: left;"> 'temp' (ºC), 'duration' (s), optional: 'start_power' (%), 'end_power' (%)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>RL/RF</code></td><td style="text-align: left;"> radioluminescence</td><td style="text-align: left;"> 'temp' (ºC), 'dose' (Gy), 'dose_rate' (Gy/s) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>RF_heating</code></td><td style="text-align: left;"> RF during heating/cooling</td><td style="text-align: left;"> 'temp begin' (ºC), 'temp end' (ºC), 'heating rate' (ºC/s], 'dose_rate' (Gy/s) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>IRR</code></td><td style="text-align: left;"> irradiation </td><td style="text-align: left;"> 'temp' (ºC), 'dose' (Gy), 'dose_rate' (Gy/s) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>CH</code> </td><td style="text-align: left;"> cutheat </td><td style="text-align: left;"> 'temp' (ºC), optional: 'duration' (s), 'heating_rate' (ºC/s)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>PH</code>  </td><td style="text-align: left;"> preheat </td><td style="text-align: left;"> 'temp' (ºC), 'duration' (s), optional: 'heating_rate' (ºC/s)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>PAUSE</code> </td><td style="text-align: left;"> pause </td><td style="text-align: left;"> 'temp' (ºC), 'duration' (s)
</td>
</tr>

</table>

<p><em>Note: 100% illumination power equates to 20 mW/cm^2</em>
</p>
<p><strong>Own parameters</strong>
</p>
<p>The <a href="base.html#topic+list">list</a> has to contain the following items:
</p>

<ul>
<li><p>N: Concentration of electron- and hole traps (cm^(-3))
</p>
</li>
<li><p>E: Electron/Hole trap depth (eV)
</p>
</li>
<li><p>s: Frequency factor (s^(-1))
</p>
</li>
<li><p>A: Conduction band to electron trap and valence band to hole trap transition probability (s^(-1) * cm^(3)).
<strong>CAUTION: Not every publication uses
the same definition of parameter A and B! See vignette &quot;RLumModel - Usage with own parameter sets&quot; for further details</strong>
</p>
</li>
<li><p>B: Conduction band to hole centre transition probability (s^(-1) * cm^(3)).
</p>
</li>
<li><p>Th: Photo-eviction constant or photoionisation cross section, respectively
</p>
</li>
<li><p>E_th: Thermal assistence energy (eV)
</p>
</li>
<li><p>k_B: Boltzman constant 8.617e-05 (eV/K)
</p>
</li>
<li><p>W: activation energy 0.64 (eV) (for UV)
</p>
</li>
<li><p>K: 2.8e7 (dimensionless constant)
</p>
</li>
<li><p>model: <code>"customized"</code>
</p>
</li>
<li><p>R (optional): Ionisation rate (pair production rate) equivalent to 1 Gy/s (s^(-1)) * cm^(-3))
</p>
</li></ul>

<p>For further details see Bailey 2001, Wintle 1975, vignette &quot;RLumModel - Using own parameter sets&quot;
and example 3.
</p>
<p><strong>Defining a SAR-sequence</strong><br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Abrivation</b> </td><td style="text-align: left;"> <b>Description</b> </td><td style="text-align: left;"> <b>examples</b> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>RegDose</code> </td><td style="text-align: left;"> Dose points of the regenerative cycles (Gy)</td><td style="text-align: left;"> c(0, 80, 140, 260, 320, 0, 80)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>TestDose</code></td><td style="text-align: left;"> Test dose for the SAR cycles  (Gy)</td><td style="text-align: left;"> 50 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>PH</code></td><td style="text-align: left;"> Temperature of the preheat (ºC)</td><td style="text-align: left;"> 240 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>CH</code></td><td style="text-align: left;"> Temperature of the cutheat (ºC)</td><td style="text-align: left;"> 200 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>OSL_temp</code></td><td style="text-align: left;"> Temperature of OSL read out (ºC)</td><td style="text-align: left;">  125 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>OSL_duration</code></td><td style="text-align: left;">  Duration of OSL read out (s)</td><td style="text-align: left;"> default: 40 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Irr_temp</code> </td><td style="text-align: left;"> Temperature of irradiation (ºC)</td><td style="text-align: left;"> default: 20</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>PH_duration</code>  </td><td style="text-align: left;"> Duration of the preheat (s)</td><td style="text-align: left;"> default: 10 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>dose_rate</code> </td><td style="text-align: left;"> Dose rate of the laboratory irradiation source (Gy/s)</td><td style="text-align: left;"> default: 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>optical_power</code> </td><td style="text-align: left;"> Percentage of the full illumination power (%)</td><td style="text-align: left;"> default: 90 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Irr_2recover</code> </td><td style="text-align: left;"> Dose to be recovered in a dose-recovery-test (Gy)</td><td style="text-align: left;"> 20
</td>
</tr>

</table>



<h3>Value</h3>

<p>This function returns an <a href="Luminescence.html#topic+RLum.Analysis-class">Luminescence::RLum.Analysis</a> object with all TL, (LM-) OSL and RF/RL steps
in the sequence. Every entry is an <a href="Luminescence.html#topic+RLum.Data.Curve-class">Luminescence::RLum.Data.Curve</a> object and can be plotted, analysed etc. with
further <code>RLum</code>-functions.
</p>


<h3>Function version</h3>

<p>0.1.6
</p>


<h3>How to cite</h3>

<p>Friedrich, J., Kreutzer, S., 2022. model_LuminescenceSignals(): Model Luminescence Signals. Function version 0.1.6. In: Friedrich, J., Kreutzer, S., Schmidt, C., 2022. RLumModel: Solving Ordinary Differential Equations to Understand Luminescence. R package version 0.2.10. https://CRAN.R-project.org/package=RLumModel
</p>


<h3>Author(s)</h3>

<p>Johannes Friedrich, University of Bayreuth (Germany),
Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)
</p>


<h3>References</h3>

<p>Bailey, R.M., 2001. Towards a general kinetic model for optically and thermally stimulated
luminescence of quartz. Radiation Measurements 33, 17-45.
</p>
<p>Bailey, R.M., 2002. Simulations of variability in the luminescence characteristics of natural
quartz and its implications for estimates of absorbed dose.
Radiation Protection Dosimetry 100, 33-38.
</p>
<p>Bailey, R.M., 2004. Paper I-simulation of dose absorption in quartz over geological timescales
and it simplications for the precision and accuracy of optical dating.
Radiation Measurements 38, 299-310.
</p>
<p>Friedrich, J., Kreutzer, S., Schmidt, C., 2016. Solving ordinary differential equations to understand luminescence:
'RLumModel', an advanced research tool for simulating luminescence in quartz using R. Quaternary Geochronology 35, 88-100.
</p>
<p>Friedrich, J., Pagonis, V., Chen, R., Kreutzer, S., Schmidt, C., 2017: Quartz radiofluorescence: a modelling approach.
Journal of Luminescence 186, 318-325.
</p>
<p>Pagonis, V., Chen, R., Wintle, A.G., 2007: Modelling thermal transfer in optically
stimulated luminescence of quartz. Journal of Physics D: Applied Physics 40, 998-1006.
</p>
<p>Pagonis, V., Wintle, A.G., Chen, R., Wang, X.L., 2008. A theoretical model for a new dating protocol
for quartz based on thermally transferred OSL (TT-OSL).
Radiation Measurements 43, 704-708.
</p>
<p>Pagonis, V., Lawless, J., Chen, R., Anderson, C., 2009. Radioluminescence in Al2O3:C - analytical and numerical
simulation results. Journal of Physics D: Applied Physics 42, 175107 (9pp).
</p>
<p>Peng, J., Wang, X., Adamiec, G., 2022. The build-up of the laboratory-generated dose-response curve and
underestimation of equivalent dose for quartz OSL in the high dose region: A critical modelling study.
Quaternary Geochronology 67, 101231.
</p>
<p>Soetaert, K., Cash, J., Mazzia, F., 2012. Solving differential equations in R.
Springer Science &amp; Business Media.
</p>
<p>Wintle, A., 1975. Thermal Quenching of Thermoluminescence in Quartz. Geophysical Journal International 41, 107-113.
</p>


<h3>See Also</h3>

<p><a href="base.html#topic+plot">plot</a>, <a href="Luminescence.html#topic+RLum-class">Luminescence::RLum</a>,
<a href="#topic+read_SEQ2R">read_SEQ2R</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##================================================================##
## Example 1: Simulate Bailey2001
## (cf. Bailey, 2001, Fig. 1)
##================================================================##

##set sequence with the following steps
## (1) Irradiation at 20 deg. C with a dose of 10 Gy and a dose rate of 1 Gy/s
## (2) TL from 20-400 deg. C with a rate of 5 K/s

sequence &lt;-
  list(
    IRR = c(20, 10, 1),
    TL = c(20, 400, 5)
  )

##model sequence
model.output &lt;- model_LuminescenceSignals(
  sequence = sequence,
  model = "Bailey2001"
)

##get all TL concentrations

TL_conc &lt;- get_RLum(model.output, recordType = "(TL)", drop = FALSE)

plot_RLum(TL_conc)

##plot 110 deg. C trap concentration

TL_110 &lt;- get_RLum(TL_conc, recordType = "conc. level 1")
plot_RLum(TL_110)

##============================================================================##
## Example 2: compare different optical powers of stimulation light
##============================================================================##

# call function "model_LuminescenceSignals", model = "Bailey2004"
# and simulate_sample_history = FALSE (default),
# because the sample history is not part of the sequence
# the optical_power of the LED is varied and then compared.

optical_power &lt;- seq(from = 0,to = 100,by = 20)

model.output &lt;- lapply(optical_power, function(x){

 sequence &lt;- list(IRR = c(20, 50, 1),
                  PH = c(220, 10, 5),
                  OSL = c(125, 50, x)
                  )

 data &lt;- model_LuminescenceSignals(
           sequence = sequence,
           model = "Bailey2004",
           plot = FALSE,
           verbose = FALSE
           )

 return(get_RLum(data, recordType = "OSL$", drop = FALSE))
})

##combine output curves
model.output.merged &lt;- merge_RLum(model.output)

##plot
plot_RLum(
 object = model.output.merged,
 xlab = "Illumination time (s)",
 ylab = "OSL signal (a.u.)",
 main = "OSL signal dependency on optical power of stimulation light",
 legend.text = paste("Optical power density", 20*optical_power/100, "mW/cm^2"),
 combine = TRUE)

##============================================================================##
## Example 3: Usage of own parameter sets (Pagonis 2009)
##============================================================================##

own_parameters &lt;- list(
  N = c(2e15, 2e15, 1e17, 2.4e16),
  E = c(0, 0, 0, 0),
  s = c(0, 0, 0, 0),
  A = c(2e-8, 2e-9, 4e-9, 1e-8),
  B = c(0, 0, 5e-11, 4e-8),
  Th = c(0, 0),
  E_th = c(0, 0),
  k_B = 8.617e-5,
  W = 0.64,
  K = 2.8e7,
  model = "customized",
  R = 1.7e15
 )
 ## Note: In Pagonis 2009 is B the valence band to hole centre probability,
 ## but in Bailey 2001 this is A_j. So the values of B (in Pagonis 2009)
 ## are A in the notation above. Also notice that the first two entries in N, A and
 ## B belong to the electron traps and the last two entries to the hole centres.

 own_state_parameters &lt;- c(0, 0, 0, 9.4e15)

 ## calculate Fig. 3 in Pagonis 2009. Note: The labels for the dose rate in the original
 ## publication are not correct.
 ## For a dose rate of 0.1 Gy/s belongs a RF signal to ~ 1.5e14 (see Fig. 6).

 sequence &lt;- list(RF = c(20, 0.1, 0.1))

 model_LuminescenceSignals(
   model = "customized",
   sequence = sequence,
   own_parameters = own_parameters,
   own_state_parameters = own_state_parameters)




## Not run: 
##============================================================================##
## Example 4: Simulate Thermal-Activation-Characteristics (TAC)
##============================================================================##

 ##set temperature
 act.temp &lt;- seq(from = 80, to = 600, by = 20)

 ##loop over temperature
 model.output &lt;- vapply(X = act.temp, FUN = function(x) {

 ##set sequence, note: sequence includes sample history
   sequence &lt;- list(
     IRR = c(20, 1, 1e-11),
     IRR = c(20, 10, 1),
     PH = c(x, 1),
     IRR = c(20, 0.1, 1),
     TL = c(20, 150, 5)
 )
 ##run simulation
   temp &lt;- model_LuminescenceSignals(
     sequence = sequence,
     model = "Pagonis2007",
     simulate_sample_history = TRUE,
     plot = FALSE,
     verbose = FALSE
   )
     ## "TL$" for exact matching TL and not (TL)
   TL_curve &lt;- get_RLum(temp, recordType = "TL$")
   ##return max value in TL curve
   return(max(get_RLum(TL_curve)[,2]))
 }, FUN.VALUE = 1)

 ##plot resutls
 plot(
   act.temp[-(1:3)],
   model.output[-(1:3)],
   type = "b",
   xlab = "Temperature [\u00B0C)",
   ylab = "TL [a.u.]"
 )

##============================================================================##
## Example 5: Simulate SAR sequence
##============================================================================##

##set SAR sequence with the following steps
## (1) RegDose: set regenerative dose (Gy) as vector
## (2) TestDose: set test dose (Gy)
## (3) PH: set preheat temperature in deg. C
## (4) CH: Set cutheat temperature in deg. C
## (5) OSL_temp: set OSL reading temperature in deg. C
## (6) OSL_duration: set OSL reading duration in s

sequence &lt;- list(
 RegDose = c(0,10,20,50,90,0,10),
 TestDose = 5,
 PH = 240,
 CH = 200,
 OSL_temp = 125,
 OSL_duration = 70)

# call function "model_LuminescenceSignals", set sequence = sequence,
# model = "Pagonis2007" (palaeodose = 20 Gy) and simulate_sample_history = FALSE (default),
# because the sample history is not part of the sequence

 model.output &lt;- model_LuminescenceSignals(
   sequence = sequence,
   model = "Pagonis2007",
   plot = FALSE
 )

# in environment is a new object "model.output" with the results of
# every step of the given sequence.
# Plots are done at OSL and TL steps and the growth curve

# call "analyse_SAR.CWOSL" from RLum package
 results &lt;- analyse_SAR.CWOSL(model.output,
                            signal.integral.min = 1,
                            signal.integral.max = 15,
                            background.integral.min = 601,
                            background.integral.max = 701,
                            fit.method = "EXP",
                            dose.points = c(0,10,20,50,90,0,10))


##============================================================================##
## Example 6: generate sequence from *.seq file and run SAR simulation
##============================================================================##

# load example *.SEQ file and construct a sequence.
# call function "model_LuminescenceSignals", load created sequence for sequence,
# set model = "Bailey2002" (palaeodose = 10 Gy)
# and simulate_sample_history = FALSE (default),
# because the sample history is not part of the sequence

path &lt;- system.file("extdata", "example_SAR_cycle.SEQ", package="RLumModel")

sequence &lt;- read_SEQ2R(file = path)

model.output &lt;- model_LuminescenceSignals(
  sequence = sequence,
  model = "Bailey2001",
  plot = FALSE
)


## call RLum package function "analyse_SAR.CWOSL" to analyse the simulated SAR cycle

results &lt;- analyse_SAR.CWOSL(model.output,
                             signal.integral.min = 1,
                             signal.integral.max = 10,
                             background.integral.min = 301,
                             background.integral.max = 401,
                             dose.points = c(0,8,14,26,32,0,8),
                             fit.method = "EXP")

print(get_RLum(results))


##============================================================================##
## Example 7: Simulate sequence at laboratory without sample history
##============================================================================##

##set sequence with the following steps
## (1) Irraditation at 20 deg. C with a dose of 100 Gy and a dose rate of 1 Gy/s
## (2) Preheat to 200 deg. C and hold for 10 s
## (3) LM-OSL at 125 deg. C. for 100 s
## (4) Cutheat at 200 dec. C.
## (5) Irraditation at 20 deg. C with a dose of 10 Gy and a dose rate of 1 Gy/s
## (6) Pause at 200 de. C. for 100 s
## (7) OSL at 125 deg. C for 100 s with 90 % optical power
## (8) Pause at 200 deg. C for 100 s
## (9) TL from 20-400 deg. C with a heat rate of 5 K/s
## (10) Radiofluorescence at 20 deg. C with a dose of 200 Gy and a dose rate of 0.01 Gy/s

sequence &lt;-
 list(
   IRR = c(20, 100, 1),
   PH = c(200, 10),
   LM_OSL = c(125, 100),
   CH = c(200),
   IRR = c(20, 10, 1),
   PAUSE = c(200, 100),
   OSL = c(125, 100, 90),
   PAUSE = c(200, 100),
   TL = c(20, 400, 5),
   RF = c(20, 200, 0.01)
)

# call function "model_LuminescenceSignals", set sequence = sequence,
# model = "Pagonis2008" (palaeodose = 200 Gy) and simulate_sample_history = FALSE (default),
# because the sample history is not part of the sequence

model.output &lt;- model_LuminescenceSignals(
   sequence = sequence,
   model = "Pagonis2008"
   )


## End(Not run)
</code></pre>

<hr>
<h2 id='read_SEQ2R'>Parse a Risoe SEQ-file to a sequence neccessary for simulating quartz luminescence</h2><span id='topic+read_SEQ2R'></span>

<h3>Description</h3>

<p>A SEQ-file created by the Risoe Sequence Editor can be imported to simulate the sequence written
in the sequence editor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_SEQ2R(file, lab.dose_rate = 1, txtProgressBar = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_SEQ2R_+3A_file">file</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> (<b>required</b>): a *.seq file created by the Risoe Sequence Editor</p>
</td></tr>
<tr><td><code id="read_SEQ2R_+3A_lab.dose_rate">lab.dose_rate</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> (with default): set the dose rate of the radiation source
in the laboratory Gy/s. Default: 1 Gy/s</p>
</td></tr>
<tr><td><code id="read_SEQ2R_+3A_txtprogressbar">txtProgressBar</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code> (with default): enables or disables the txtProgressBar for a visuell
control of the progress. Default: txtProgressBar = TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Supported versions</b>: Supppored and tested: version 4.36.
</p>


<h3>Value</h3>

<p>This function returns a <code><a href="base.html#topic+list">list</a></code> with the parsed *.seq file and the required steps for
<code><a href="#topic+model_LuminescenceSignals">model_LuminescenceSignals</a></code>.
</p>


<h3>Function version</h3>

<p>0.1.0
</p>


<h3>How to cite</h3>

<p>Friedrich, J., 2022. read_SEQ2R(): Parse a Risoe SEQ-file to a sequence neccessary for simulating quartz luminescence. Function version 0.1.0. In: Friedrich, J., Kreutzer, S., Schmidt, C., 2022. RLumModel: Solving Ordinary Differential Equations to Understand Luminescence. R package version 0.2.10. https://CRAN.R-project.org/package=RLumModel
</p>


<h3>Author(s)</h3>

<p>Johannes Friedrich, University of Bayreuth (Germany),
</p>


<h3>References</h3>

<p>Riso: Sequence Editor User Manual.
Available at: http://www.nutech.dtu.dk/english/-/media/Andre_Universitetsenheder/Nutech/Produkter
SequenceEditor.ashx?la=da
</p>


<h3>See Also</h3>

<p><code><a href="#topic+model_LuminescenceSignals">model_LuminescenceSignals</a></code>, <code><a href="base.html#topic+readLines">readLines</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##search "example_SAR_cycle.SEQ" in "extdata" in package "RLumModel"
path &lt;- system.file("extdata", "example_SAR_cycle.SEQ", package="RLumModel")

sequence &lt;- read_SEQ2R(file = path, txtProgressBar = FALSE)

</code></pre>

<hr>
<h2 id='trace_ParameterStateEvolution'>Trace parameter state evolution</h2><span id='topic+trace_ParameterStateEvolution'></span>

<h3>Description</h3>

<p>Traces the evolution of the concentrations in the different
levels over different simulation steps. For instance, a sequence consisting
of one TL and one OSL step has two iterations. For each step the end concentration
is extracted. This way, the evolution of the system can be traced throughout
a sequence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trace_ParameterStateEvolution(object, step = NULL, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trace_ParameterStateEvolution_+3A_object">object</code></td>
<td>
<p><a href="Luminescence.html#topic+RLum.Analysis-class">Luminescence::RLum.Analysis</a> (<strong>required</strong>): input object
created by the function <a href="#topic+model_LuminescenceSignals">model_LuminescenceSignals</a>. The input can be a list of such
objects</p>
</td></tr>
<tr><td><code id="trace_ParameterStateEvolution_+3A_step">step</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>): filter the input object to pick particular
steps, the input is passed to <a href="Luminescence.html#topic+get_RLum">Luminescence::get_RLum</a></p>
</td></tr>
<tr><td><code id="trace_ParameterStateEvolution_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>): enables/disables plot output</p>
</td></tr>
<tr><td><code id="trace_ParameterStateEvolution_+3A_...">...</code></td>
<td>
<p>optional arguments to be passed to control the plot output. Supported
are <code>xlim</code>, <code>xlab</code>, <code>ylab</code>, <code>log</code>, <code>col</code>, <code>type</code>, <code>bg</code>, <code>main</code>, <code>norm</code> (<code>TRUE</code>/<code>FALSE</code>),
<code>grid</code> (<code>TRUE</code>/<code>FALSE</code>), <code>step_names</code> (<code>TRUE</code>/<code>FALSE</code>)
Where meaningful, parameters can be provided as vectors. Vectors short than the number of plots are recycled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a plot and <a href="base.html#topic+list">list</a> with <a href="base.html#topic+matrix">matrix</a> objects of the parameter evolution. If
<code>object</code> is a <a href="base.html#topic+list">list</a> the output is a nested <a href="base.html#topic+list">list</a>
</p>


<h3>Function version</h3>

<p>0.1.0
</p>


<h3>How to cite</h3>

<p>Kreutzer, S., 2022. trace_ParameterStateEvolution(): Trace parameter state evolution. Function version 0.1.0. In: Friedrich, J., Kreutzer, S., Schmidt, C., 2022. RLumModel: Solving Ordinary Differential Equations to Understand Luminescence. R package version 0.2.10. https://CRAN.R-project.org/package=RLumModel
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sequence &lt;-
list(
IRR = c(20, 10, 1),
TL = c(20, 400, 5),
IRR = c(20, 10, 1),
TL = c(20, 400, 5))

##model sequence
model.output &lt;- model_LuminescenceSignals(
 sequence = sequence,
 verbose = FALSE,
 plot = FALSE,
 model = "Bailey2001")

## trace
trace_ParameterStateEvolution(model.output)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
