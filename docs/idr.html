<!DOCTYPE html><html><head><title>Help for package idr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {idr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#idr-package'>
<p>Irreproducible discovery rate</p></a></li>
<li><a href='#comp.uri'>
<p>Compute the value of Psi and Psi' for a given t</p></a></li>
<li><a href='#d.binormal'>
<p>Log density of bivariate Gaussian distribution with symmetric marginals</p></a></li>
<li><a href='#e.step.2normal'>
<p>E-step for parameterized bivariate 2-component Gaussian mixture models</p></a></li>
<li><a href='#est.IDR'>
<p>Estimate the irreproducible discovery rate using the copula mixture model</p></a></li>
<li><a href='#get.correspondence'>
<p>Compute correspondence profiles</p></a></li>
<li><a href='#get.pseudo.mix'>
<p>Compute the pseudo values of a mixture model from the empirical CDF</p></a></li>
<li><a href='#get.uri.2d'>
<p>Compute the correspondence profile (Psi(t, v)) and the derivative of</p>
the correspondence profile (Psi'(t, v))</a></li>
<li><a href='#loglik.2binormal'>
<p>Compute log-likelihood of parameterized bivariate 2-component Gaussian mixture models</p></a></li>
<li><a href='#m.step.2normal'>
<p>M-step for parameterized bivariate 2-component Gaussian mixture models</p></a></li>
<li><a href='#salmon'>
<p>Salmon data</p></a></li>
<li><a href='#select.IDR'>
<p>Select observations according to IDR</p></a></li>
<li><a href='#simu.idr'>
<p>Simulated data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Irreproducible Discovery Rate</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Qunhua Li </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Qunhua Li &lt;qunhua.li@psu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This is a package for estimating the copula mixture model and plotting correspondence curves. Details are in "Measuring reproducibility of high-throughput experiments" (2011), Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779, by Li, Brown, Huang, and Bickel. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-21 02:57:35 UTC; Qunhua Li</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-21 07:30:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='idr-package'>
Irreproducible discovery rate
</h2><span id='topic+idr-package'></span><span id='topic+idr'></span>

<h3>Description</h3>

<p>This package estimates the reproducibility of observations on
a pair of replicate rank lists. It consists of three components:
(1) plotting the correspondence curve to visualize reproducibility, (2)
quantifying reproducibility using a copula mixture model and estimating
the posterior probability for each obsrvation to be irreproducible
(local irreproducible discovery rate), and (3) ranking and selecting
observations by  their irreproducibility.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> idr</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2012-10-26</td>
</tr>
<tr>
 <td style="text-align: left;">
Updates: </td><td style="text-align: left;"> Improve the convergence of est.IDR (2014-08-15) </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The main functions are est.IDR(), get.correspondence() and
select.IDR(). est.IDR estimates the copula mixture model and the
posterior probability for each observation to be irreproducible. get.correspondence generates the values for plotting the correspondence curve. select.IDR ranks obervations by their reproducibility and reports
the number of observations passing the specified IDR thresholds.
</p>


<h3>Author(s)</h3>

<p>Qunhua Li
</p>
<p>Maintainer: Qunhua Li &lt;qunhua.li@gmail.com&gt;
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("simu.idr")
x &lt;- cbind(-simu.idr$x, -simu.idr$y)

mu &lt;- 2.6
sigma &lt;- 1.3
rho &lt;- 0.8
p &lt;- 0.7

idr.out &lt;- est.IDR(x, mu, sigma, rho, p, eps=0.001, max.ite=20)

names(idr.out)
</code></pre>

<hr>
<h2 id='comp.uri'>
Compute the value of Psi and Psi' for a given t
</h2><span id='topic+comp.uri'></span>

<h3>Description</h3>

<p>An internal function to compute Psi for a given (t, v)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.uri(tv, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comp.uri_+3A_tv">tv</code></td>
<td>
<p>A vector of two numeric values, t and v. Both t and
v are in [0,1]
</p>
</td></tr>
<tr><td><code id="comp.uri_+3A_x">x</code></td>
<td>
<p>A numeric vector of x, sorted by the order of y
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value of Psi(t, v)
</p>


<h3>Author(s)</h3>

<p>Qunhua Li
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>See Also</h3>

<p>get.uri.2d, get.correspondence
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(1, 10, by=1)
tv &lt;- c(0.1, 0.5)

# opposite order
y1 &lt;- seq(10, 1, by=-1)
o1 &lt;- order(y1)
x.o1 &lt;- x[o1]

comp.uri(tv, x.o1)

# same order
y2 &lt;- seq(1, 10, by=1)
o2 &lt;- order(y2)
x.o2 &lt;- x[o2]

comp.uri(tv, x.o2)
</code></pre>

<hr>
<h2 id='d.binormal'>
Log density of bivariate Gaussian distribution with symmetric marginals
</h2><span id='topic+d.binormal'></span>

<h3>Description</h3>

<p>Compute the log-density for parameterized bivariate Gaussian
distribution N(mu, mu, sigma, sigma, rho).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d.binormal(z.1, z.2, mu, sigma, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d.binormal_+3A_z.1">z.1</code></td>
<td>
<p> a numerical data vector on coordinate 1. </p>
</td></tr>
<tr><td><code id="d.binormal_+3A_z.2">z.2</code></td>
<td>
<p> a numerical data vector on coordinate 1. </p>
</td></tr>
<tr><td><code id="d.binormal_+3A_mu">mu</code></td>
<td>
<p> mean </p>
</td></tr>
<tr><td><code id="d.binormal_+3A_sigma">sigma</code></td>
<td>
<p> standard deviation </p>
</td></tr>
<tr><td><code id="d.binormal_+3A_rho">rho</code></td>
<td>
<p> correlation coefficient </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Log density of bivariate Gaussian distribution N(mu, mu, sigma, sigma, rho).
</p>


<h3>Author(s)</h3>

<p>Qunhua Li
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
z.1 &lt;- rnorm(500, 3, 1)
rho &lt;- 0.8

## The component with higher values is correlated with correlation coefficient=0.8 
z.2 &lt;- rnorm(500, 3 + 0.8*(z.1-3), (1-rho^2))
mu &lt;- 3
sigma &lt;- 1
den.z &lt;- d.binormal(z.1, z.2, mu, sigma, rho)

den.z
</code></pre>

<hr>
<h2 id='e.step.2normal'>
E-step for parameterized bivariate 2-component Gaussian mixture models
</h2><span id='topic+e.step.2normal'></span>

<h3>Description</h3>

<p>Expectation step in the EM algorithm for parameterized bivariate 2-component
Gaussian mixture models with (1-p)N(0, 0, 1, 1, 0) + pN(mu, mu, sigma,
sigma, rho).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e.step.2normal(z.1, z.2, mu, sigma, rho, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e.step.2normal_+3A_z.1">z.1</code></td>
<td>
<p> a numerical data vector on coordinate 1.</p>
</td></tr>
<tr><td><code id="e.step.2normal_+3A_z.2">z.2</code></td>
<td>
<p> a numerical data vector on coordinate 2.</p>
</td></tr>
<tr><td><code id="e.step.2normal_+3A_mu">mu</code></td>
<td>
<p> mean for the reproducible component.</p>
</td></tr>
<tr><td><code id="e.step.2normal_+3A_sigma">sigma</code></td>
<td>
<p> standard deviation of the reproducible component.</p>
</td></tr>
<tr><td><code id="e.step.2normal_+3A_rho">rho</code></td>
<td>
<p> correlation coefficient of the reproducible component.</p>
</td></tr>
<tr><td><code id="e.step.2normal_+3A_p">p</code></td>
<td>
<p> mixing proportion of the reproducible component.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>e.z</code></td>
<td>
<p> a numeric vector, where each entry represents the estimated expected conditional probability
that an observation is in the reproducible component. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qunhua Li
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>See Also</h3>

<p><code>m.step.2normal</code>, <code>loglik.2binormal</code>, <code>est.IDR</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
z.1 &lt;- c(rnorm(500, 0, 1), rnorm(500, 3, 1))
rho &lt;- 0.8

## The component with higher values is correlated with correlation coefficient=0.8 
z.2 &lt;- c(rnorm(500, 0, 1), rnorm(500, 3 + 0.8*(z.1[501:1000]-3), (1-rho^2)))

## Starting values
mu0 &lt;- 3
sigma0 &lt;- 1
rho0 &lt;- 0.85
p0 &lt;- 0.55

e.z &lt;- e.step.2normal(z.1, z.2, mu0, sigma0, rho0, p0)
</code></pre>

<hr>
<h2 id='est.IDR'>
Estimate the irreproducible discovery rate using the copula mixture model
</h2><span id='topic+est.IDR'></span>

<h3>Description</h3>

<p>Fit a Gaussian copula mixture model. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.IDR(x, mu, sigma, rho, p, eps=0.001, max.ite=30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est.IDR_+3A_x">x</code></td>
<td>
<p>an n by m numeric matrix, where m= num of replicates,
n=num of observations. Numerical values representing the
significance of the observations. Note that significant signals 
are expected to have large values of x. In case that smaller values
represent higher significance (e.g. p-value), a monotonic transformation 
needs to be applied to reverse the order before using this function, 
for example, -log(p-value). Currently, m=2. </p>
</td></tr>
<tr><td><code id="est.IDR_+3A_mu">mu</code></td>
<td>
<p> a starting value for the mean of the reproducible component.</p>
</td></tr>
<tr><td><code id="est.IDR_+3A_sigma">sigma</code></td>
<td>
<p> a starting value for the standard deviation of the
reproducible component.</p>
</td></tr>
<tr><td><code id="est.IDR_+3A_rho">rho</code></td>
<td>
<p> a starting value for the correlation coefficient of the
reproducible component.</p>
</td></tr>
<tr><td><code id="est.IDR_+3A_p">p</code></td>
<td>
<p> a starting value for the proportion of reproducible component.</p>
</td></tr>
<tr><td><code id="est.IDR_+3A_eps">eps</code></td>
<td>
<p> Stopping criterion. Iterations stop when the increment of
log-likelihood is &lt; eps*log-likelihood, Default=0.001.</p>
</td></tr>
<tr><td><code id="est.IDR_+3A_max.ite">max.ite</code></td>
<td>
<p> Maximum number of iterations. Default=30.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>para</code></td>
<td>
<p> estimated parameters: p, rho, mu, sigma.</p>
</td></tr>
<tr><td><code>idr</code></td>
<td>
<p> a numeric vector of the local idr for each observation (i.e.
estimated conditional probablility for each observation to belong to
the irreproducible component.</p>
</td></tr>
<tr><td><code>IDR</code></td>
<td>
<p>a numerical vector of the expected irreproducible discovery
rate for observations that are as irreproducible or more
irreproducible than the given observations.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> log-likelihood at the end of iterations.</p>
</td></tr>
<tr><td><code>loglik.trace</code></td>
<td>
<p> trajectory of log-likelihood. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qunhua Li
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("simu.idr")

# simu.idr$x and simu.idr$y are p-values
# Transfer them such that large values represent significant ones 
x &lt;- cbind(-simu.idr$x, -simu.idr$y)

mu &lt;- 2.6
sigma &lt;- 1.3
rho &lt;- 0.8
p &lt;- 0.7

idr.out &lt;- est.IDR(x, mu, sigma, rho, p, eps=0.001, max.ite=20)

names(idr.out)
</code></pre>

<hr>
<h2 id='get.correspondence'>
Compute correspondence profiles
</h2><span id='topic+get.correspondence'></span>

<h3>Description</h3>


<p>Compute the correspondence profiles (Psi and Psi') and the
corresponding smoothed curve using spline
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.correspondence(x1, x2, t, spline.df = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.correspondence_+3A_x1">x1</code></td>
<td>


<p>Data values or ranks of the data values on list 1, a vector of
numeric values. Large values need to be significant signals. If small
values represent significant signals, rank the signals reversely
(e.g. by ranking negative values) and use the rank as x1.
</p>
</td></tr>
<tr><td><code id="get.correspondence_+3A_x2">x2</code></td>
<td>


<p>Data values or ranks of the data values on list 2, a vector of
numeric values. Large values need to be significant signals. If small
values represent significant signals, rank the signals reversely
(e.g. by ranking negative values) and use the rank as x1.
</p>
</td></tr>
<tr><td><code id="get.correspondence_+3A_t">t</code></td>
<td>


<p>A numeric vector between 0 and 1 in ascending order. t is the
right-tail percentage.
</p>
</td></tr>
<tr><td><code id="get.correspondence_+3A_spline.df">spline.df</code></td>
<td>


<p>Degree of freedom for spline, to control the smoothness of the
smoothed curve. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>psi</code></td>
<td>
<p>the correspondence profile in terms of the scale of percentage, i.e. between (0, 1)</p>
</td></tr>
<tr><td><code>dpsi</code></td>
<td>
<p>the derivative of the correspondence profile in terms of the scale of percentage, i.e. between (0, 1)</p>
</td></tr>
<tr><td><code>psi.n</code></td>
<td>
<p>the correspondence profile in terms of the scale of the number of observations</p>
</td></tr>
<tr><td><code>dpsi.n</code></td>
<td>
<p>the derivative of the correspondence profile in terms of
the scale of the number of observations</p>
</td></tr>
</table>
<p>Each object above is a list consisting of the following items:
t: upper percentage (for psi and dpsi) or number of top ranked
observations (for psi.n and dpsi.n) 
value: psi or dpsi
smoothed.line: smoothing spline
ntotal: the number of observations
jump.point: the index of the vector of t such that psi(t[jump.point])
jumps up due to ties at the low values. This only
happends when data consists of a large number of discrete
values, e.g. values imputed for observations
appearing on only one replicate. 
</p>


<h3>Author(s)</h3>


<p>Qunhua Li
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# salmon data 
data(salmon)

# get.correspondence() needs the observations with high ranks have 
# high correlation and the observations with low ranks have low correlation. 
# In this dataset, small values have high correlation and large values 
# have low correlation.
# Ranking negative values makes the data follow the structure required
# by get.correspondence().
# There are 28 observations in this data set.

rank.x &lt;- rank(-salmon$spawners)
rank.y &lt;- rank(-salmon$recruits)
uv &lt;- get.correspondence(rank.x, rank.y, seq(0.01, 0.99, by=1/28)) 


# plot correspondence curve on the scale of percentage
plot(uv$psi$t, uv$psi$value, xlab="t", ylab="psi", xlim=c(0, max(uv$psi$t)), 
ylim=c(0, max(uv$psi$value)), cex.lab=2)
lines(uv$psi$smoothed.line, lwd=4)
abline(coef=c(0,1), lty=3)

# plot the derivative of correspondence curve on the scale of percentage
plot(uv$dpsi$t, uv$dpsi$value, xlab="t", ylab="psi'", xlim=c(0, max(uv$dpsi$t)),
ylim=c(0, max(uv$dpsi$value)), cex.lab=2)
lines(uv$dpsi$smoothed.line, lwd=4)
abline(h=1, lty=3)

# plot correspondence curve on the scale of the number of observations
plot(uv$psi.n$t, uv$psi.n$value, xlab="t", ylab="psi", xlim=c(0, max(uv$psi.n$t)), 
ylim=c(0, max(uv$psi.n$value)), cex.lab=2)
lines(uv$psi.n$smoothed.line, lwd=4)
abline(coef=c(0,1), lty=3)

# plot the derivative of correspondence curve on the scale of the number
# of observations
plot(uv$dpsi.n$t, uv$dpsi.n$value, xlab="t", ylab="psi'", xlim=c(0, max(uv$dpsi.n$t)), 
ylim=c(0, max(uv$dpsi.n$value)), cex.lab=2)
lines(uv$dpsi.n$smoothed.line, lwd=4)
abline(h=1, lty=3)

# If the rank lists consist of a large number of ties at the bottom
# (e.g. the same low value is imputed to the list for the observations
# that appear on only one list), it may be desirable to plot only
# observations before hitting the ties. Then it can be plotted using the
# following
plot(uv$psi$t[1:uv$psi$jump.point], uv$psi$value[1:uv$psi$jump.point], xlab="t",
ylab="psi", xlim=c(0, max(uv$psi$t[1:uv$psi$jump.point])), 
ylim=c(0, max(uv$psi$value[1:uv$psi$jump.point])), cex.lab=2)
lines(uv$psi$smoothed.line, lwd=4)
abline(coef=c(0,1), lty=3)
 
</code></pre>

<hr>
<h2 id='get.pseudo.mix'>
Compute the pseudo values of a mixture model from the empirical CDF
</h2><span id='topic+get.pseudo.mix'></span>

<h3>Description</h3>

<p>Compute the pseudo values of a mixture model from the empirical CDF  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.pseudo.mix(x, mu, sigma, rho, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.pseudo.mix_+3A_x">x</code></td>
<td>

<p>A vector of values of empirical CDF
</p>
</td></tr>
<tr><td><code id="get.pseudo.mix_+3A_mu">mu</code></td>
<td>

<p>Mean of the reproducible component in the mixture model on the latent space
</p>
</td></tr>
<tr><td><code id="get.pseudo.mix_+3A_sigma">sigma</code></td>
<td>

<p>Standard deviation of the reproducible component in the mixture model on the latent space
</p>
</td></tr>
<tr><td><code id="get.pseudo.mix_+3A_rho">rho</code></td>
<td>

<p>Correlation coefficient of the reproducible component in the mixture model on the latent space
</p>
</td></tr>
<tr><td><code id="get.pseudo.mix_+3A_p">p</code></td>
<td>

<p>Mixing proportion of the reproducible component in the mixture model on the latent space
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The values of a mixture model corresponding to the empirical CDF
</p>


<h3>Author(s)</h3>

<p>Qunhua Li
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- seq(0.1, 0.9, by=0.1)

mu &lt;- 2.6
sigma &lt;- 1.3
rho &lt;- 0.8
p &lt;- 0.7

pseudo.x &lt;- get.pseudo.mix(x, mu, sigma, rho, p)

pseudo.x
</code></pre>

<hr>
<h2 id='get.uri.2d'>
Compute the correspondence profile (Psi(t, v)) and the derivative of
the correspondence profile (Psi'(t, v)) 
</h2><span id='topic+get.uri.2d'></span>

<h3>Description</h3>

<p>An internal function to compute the correspondence profile (Psi(t, v)) and the derivative of the correspondence profile (Psi'(t, v)) for t and v between 0 and 1 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.uri.2d(x1, x2, tt, vv, spline.df = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.uri.2d_+3A_x1">x1</code></td>
<td>

</td></tr>
<tr><td><code id="get.uri.2d_+3A_x2">x2</code></td>
<td>

</td></tr>
<tr><td><code id="get.uri.2d_+3A_tt">tt</code></td>
<td>

<p>A vector of right-tail percentages for x1. It is a numeric vector between 0 and 1, e.g. seq(0.01, 0.99, by=0.01) 
</p>
</td></tr>
<tr><td><code id="get.uri.2d_+3A_vv">vv</code></td>
<td>

<p>A vector of right-tail percentages for x2. It is a numeric vector between 0 and 1, e.g. seq(0.01, 0.99, by=0.01)  
</p>
</td></tr>
<tr><td><code id="get.uri.2d_+3A_spline.df">spline.df</code></td>
<td>

<p>The degree of freedom to control the smoothness of the spline to be
superimposed on the points  
</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Qunhua Li
</p>


<h3>References</h3>


<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>See Also</h3>

<p>comp.uri, get.correspondence
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# salmon data from Kallenberg and Ledwina, 1999
data(salmon)

# get.correspondence() needs large ranks have high correlation and
# small ranks have low correlation. In this dataset, small values
# have high correlation and large values have low correlation.
# Ranking negative values makes the data follow the structure required
# by get.correspondence().
# There are 28 observations in this data set.

rank.x &lt;- rank(-salmon$spawners)
rank.y &lt;- rank(-salmon$recruits)
t &lt;- seq(0.01, 0.99, by=1/28)
psi.dpsi &lt;- get.uri.2d(rank.x, rank.y, t, t, spline.df=6.4)
</code></pre>

<hr>
<h2 id='loglik.2binormal'>
Compute log-likelihood of parameterized bivariate 2-component Gaussian mixture models
</h2><span id='topic+loglik.2binormal'></span>

<h3>Description</h3>

<p>Compute the log-likelihood for parameterized bivariate 2-component
Gaussian mixture models with (1-p)N(0, 0, 1, 1, 0) + pN(mu, mu, sigma,
sigma, rho).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik.2binormal(z.1, z.2, mu, sigma, rho, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik.2binormal_+3A_z.1">z.1</code></td>
<td>
<p> a numerical data vector on coordinate 1. </p>
</td></tr>
<tr><td><code id="loglik.2binormal_+3A_z.2">z.2</code></td>
<td>
<p> a numerical data vector on coordinate 1. </p>
</td></tr>
<tr><td><code id="loglik.2binormal_+3A_mu">mu</code></td>
<td>
<p> mean for the reproducible component. </p>
</td></tr>
<tr><td><code id="loglik.2binormal_+3A_sigma">sigma</code></td>
<td>
<p> standard deviation of the reproducible component. </p>
</td></tr>
<tr><td><code id="loglik.2binormal_+3A_rho">rho</code></td>
<td>
<p> correlation coefficient of the reproducible component. </p>
</td></tr>
<tr><td><code id="loglik.2binormal_+3A_p">p</code></td>
<td>
<p> mixing proportion of the reproducible component. </p>
</td></tr>  
</table>


<h3>Value</h3>

<p>Log-likelihood of the bivariate 2-component
Gaussian mixture models (1-p)N(0, 0, 1, 1, 0) + N(mu, mu, sigma,
sigma, rho)$.
</p>


<h3>Author(s)</h3>

<p>Qunhua Li
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>See Also</h3>

<p><code>m.step.2normal</code>, <code>e.step.normal</code>, <code>est.IDR</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>z.1 &lt;- c(rnorm(500, 0, 1), rnorm(500, 3, 1))
rho &lt;- 0.8

## The component with higher values is correlated with correlation coefficient=0.8 
z.2 &lt;- c(rnorm(500, 0, 1), rnorm(500, 3 + 0.8*(z.1[501:1000]-3), (1-rho^2)))

## Starting values
mu &lt;- 3
sigma &lt;- 1
rho &lt;- 0.85
p &lt;- 0.55

## The function is currently defined as
loglik &lt;- loglik.2binormal(z.1, z.2, mu, sigma, rho, p) 

loglik
</code></pre>

<hr>
<h2 id='m.step.2normal'>
M-step for parameterized bivariate 2-component Gaussian mixture models
</h2><span id='topic+m.step.2normal'></span>

<h3>Description</h3>

<p>Maximization step in the EM algorithm for parameterized bivariate 2-component
Gaussian mixture models with $(1-p)N(0, 0, 1, 1, 0) + pN(mu, mu, sigma^2,
sigma^2, rho)$. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m.step.2normal(z.1, z.2, e.z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m.step.2normal_+3A_z.1">z.1</code></td>
<td>
<p> a numerical data vector on coordinate 1.</p>
</td></tr>
<tr><td><code id="m.step.2normal_+3A_z.2">z.2</code></td>
<td>
<p> a numerical data vector on coordinate 2.</p>
</td></tr>
<tr><td><code id="m.step.2normal_+3A_e.z">e.z</code></td>
<td>
<p> a vector of expected conditional probability that the $i$th
observation is reproducible. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used in the EM algorithm for estimating the parameters
of the Gaussian mixture model at the latent copula space. 
</p>


<h3>Value</h3>

<p>Estimated parameters, basically a list including elements 
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p> the estimated mixing proportion of the reproducible component.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p> the estimated mean for the reproducible component.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p> the estimated standard deviation of the reproducible component.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p> the estimated correlation coefficient of the reproducible component.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qunhua Li
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>See Also</h3>

<p><code>e.step.2normal</code>, <code>loglik.2binormal</code>, <code>est.IDR</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

 
z.1 &lt;- c(rnorm(500, 0, 1), rnorm(500, 3, 1))
rho &lt;- 0.8

##The component with higher values is correlated with correlation coefficient=0.8 
z.2 &lt;- c(rnorm(500, 0, 1), rnorm(500, 3 + 0.8*(z.1[501:1000]-3), (1-rho^2)))
e.z &lt;- c(rep(0, 500) + abs(rnorm(0, 0.05)), rep(1, 500)-abs(rnorm(0, 0.05)))

para &lt;- m.step.2normal(z.1, z.2, e.z) 

para
</code></pre>

<hr>
<h2 id='salmon'>
Salmon data
</h2><span id='topic+salmon'></span>

<h3>Description</h3>

<p>This data is from Simonoff (1990, p 161). It concerns the
size of the annual spawning stock and its production of new
catchable-sized fish for 1940 through 1967 for the Skeena river
sockeye salmon stock (in thousands of fish). It has three columns,
year, spawners and recruits. It was speculated to consist of two
different populations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(salmon)</code></pre>


<h3>Format</h3>

<p>A data frame with 28 observations on the following 3 variables.
</p>

<dl>
<dt><code>year</code></dt><dd><p>a numeric vector of the year</p>
</dd>
<dt><code>spawners</code></dt><dd><p>a numeric vector of the annual spawning stock</p>
</dd>
<dt><code>recruits</code></dt><dd><p>a numeric vector of the production of new
catchable-sized fish</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data is salmon.dat in Simonoff (1990). It can be downloaded from the
book's website. 
</p>


<h3>References</h3>

<p>Simonoff, J. S. (1990), Smoothing Methods in Statistics, New York: Spinger-Verlag. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(salmon)
plot(rank(salmon$spawners), rank(salmon$recruits)) 
</code></pre>

<hr>
<h2 id='select.IDR'>
Select observations according to IDR
</h2><span id='topic+select.IDR'></span>

<h3>Description</h3>

<p>Select observations that exceeding a given IDR level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.IDR(x, IDR.x, IDR.level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select.IDR_+3A_x">x</code></td>
<td>
<p>a n by m numeric matrix, where m= num of replicates,
n=num of observations. Numerical values representing the
significance of the observations, where larger values represent
higher significance, for example, -log(p-value).   Currently, m=2. </p>
</td></tr>
<tr><td><code id="select.IDR_+3A_idr.x">IDR.x</code></td>
<td>
<p>Irreproducibile discovery rate for each entry of x. It is
computed from est.IDR().</p>
</td></tr>
<tr><td><code id="select.IDR_+3A_idr.level">IDR.level</code></td>
<td>
<p>IDR cutoff, a numerical value between [0,1].</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>Observations that are selected.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of observations that are selected.</p>
</td></tr>
<tr><td><code>IDR.level</code></td>
<td>
<p>IDR cutoff, a numerical value between [0,1].</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Qunhua Li
</p>


<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+est.IDR">est.IDR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("simu.idr")
x &lt;- cbind(-simu.idr$x, -simu.idr$y)

mu &lt;- 2.6
sigma &lt;- 1.3
rho &lt;- 0.8
p &lt;- 0.7

idr.out &lt;- est.IDR(x, mu, sigma, rho, p, eps=0.001, max.ite=20)
# select observations exceeding IDR threshold=0.01 
IDR.level &lt;- 0.01
x.selected &lt;- select.IDR(x, idr.out$IDR, IDR.level)
</code></pre>

<hr>
<h2 id='simu.idr'>
Simulated data
</h2><span id='topic+simu.idr'></span>

<h3>Description</h3>

<p>This is a simulated dataset for testing the program. Data is first
simulated from the copula mixture model with latent structure of 0.65
N(mu, mu, sigma, sigma, rho) + 0.95 N(0, 0, 1, 1, 0), where mu=2.5,
sigma=1, rho=0.84. The observations
in the dataset are then generated by taking the p-values from a z-test H0:
mu=0.     
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simu.idr)</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 observations on the following 3 variables.
</p>

<dl>
<dt><code>x</code></dt><dd><p>a numeric vector, representing p-values on replicate
1</p>
</dd>
<dt><code>y</code></dt><dd><p>a numeric vector, representing p-values on replicate
2</p>
</dd>
<dt><code>labels</code></dt><dd><p>a binary vector, where 1 represents the
reproducible component and 0 represents the irreproducible component. </p>
</dd>
</dl>



<h3>References</h3>

<p>Q. Li, J. B. Brown, H. Huang and P. J. Bickel. (2011)
Measuring reproducibility of high-throughput experiments. Annals of Applied Statistics, Vol. 5, No. 3, 1752-1779.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simu.idr)
plot(rank(simu.idr$x), rank(simu.idr$y)) 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
