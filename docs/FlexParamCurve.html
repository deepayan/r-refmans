<!DOCTYPE html><html lang="en"><head><title>Help for package FlexParamCurve</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FlexParamCurve}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FlexParamCurve-package'><p>Tools to Fit Flexible Parametric Curves</p></a></li>
<li><a href='#change.pnparameters'><p>Change Fixed Parameter Values</p></a></li>
<li><a href='#extraF'><p>Compare Two <code class="reqn">nlsList</code> Models Using Extra Sum-of-Squares F-Tests</p></a></li>
<li><a href='#extraF.nls'><p>Compare Two <code class="reqn">nls</code> Models Using Extra Sum-of-Squares F-Tests</p></a></li>
<li><a href='#get.mod'><p>Copy objects between R environments</p></a></li>
<li><a href='#logist.data'><p>Simulated growth of whiskered terns</p></a></li>
<li><a href='#modpar'><p>Estimate Values to be Used for Fixed FlexParamCurve Parameters</p></a></li>
<li><a href='#penguin.data'><p>Field data on growth of little penguins <code class="reqn">Eudyptula minor</code></p></a></li>
<li><a href='#pn.mod.compare'><p>Compare All Possible Positive-Negative Richards <code class="reqn">nlslist</code> Models</p></a></li>
<li><a href='#pn.modselect.step'><p>Backwards Stepwise Selection of Positive-Negative Richards <code class="reqn">nlslist</code> Models</p></a></li>
<li><a href='#posneg.data'><p>Simulated growth of black-browed albatrosses</p></a></li>
<li><a href='#posnegRichards.calls'><p>List of calls for fitting 33 SSposnegRichards models in <code>nlsList</code></p></a></li>
<li><a href='#posnegRichards.eqn'><p>Equations of the FlexParamCurve Family</p></a></li>
<li><a href='#SSposnegRichards'><p>Self-Starting Positive-Negative Richards Model (double-Richards)</p></a></li>
<li><a href='#tern.data'><p>Field data on growth of common terns <code class="reqn">Sterna hirundo</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Tools to Fit Flexible Parametric Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Stephen Oswald [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Model selection tools and 'selfStart' functions to fit parametric curves in 'nls', 'nlsList' and 'nlme' frameworks.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://pennstate.academia.edu:443/SteveOswald">https://pennstate.academia.edu:443/SteveOswald</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>nlme</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-11 04:13:56 UTC; admin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-11 04:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='FlexParamCurve-package'>Tools to Fit Flexible Parametric Curves</h2><span id='topic+FlexParamCurve-package'></span>

<h3>Description</h3>

<p>selfStart functions and model selection tools to fit parametric curves in 
</p>
<p><code><a href="stats.html#topic+nls">nls</a></code>, <code><a href="nlme.html#topic+nlsList">nlsList</a></code> and <code><a href="nlme.html#topic+nlme">nlme</a></code> frameworks.</p>


<h3>Details</h3>

<p>General approach for using package (also see examples below)
</p>
<p>1) Run <code class="reqn">modpar</code> to produce initial parameter estimates and estimates of parameter bounds for your dataset. 
</p>
<p>These are used to accomodate fixed parameters and are saved in user-specified <code><a href="base.html#topic+list">list</a></code> object
</p>
<p>All parameters and options in this list can be edited manually or using <code class="reqn">change.pnparameters</code>. The
</p>
<p>list could be created manually given that the elements were labelled sufficiently. Note that this step is 
</p>
<p>unnecessary when using the model selection routines <code class="reqn">pn.mod.compare</code> and <code class="reqn">pn.modselect.step</code> as they
</p>
<p>will automatically call <code class="reqn">modpar</code> if parameter estimates are missing.
</p>
<p>2) Determine most appropriate model (number of necessary parameters) for your data
</p>
<p>using  <code class="reqn">pn.mod.compare</code> or <code class="reqn">pn.modselect.step</code> (these rank competing model and then compare nested models using
</p>
<p><code class="reqn">extraF</code>). This may take some time as many <code class="reqn">nlsList</code> objects are fitted.
</p>
<p>Note that if you perform this step, then you do not need to perform step 1.
</p>
<p>If you are sure of your model (e.g. it is a simple logistic) Step 2 may be unnecessary.
</p>
<p>3) Fit <code class="reqn">nls</code> or <code class="reqn">nlsList</code> or <code class="reqn">nlme</code> models using <code class="reqn">SSposnegRichards</code> specifying
</p>
<p>the appropriate model number and the list of parameters and options (specified pn.options object). 
</p>
<p>Note if required model is monotonic (i.e. contains no recession parameters, modno= 12 or 32) recessional parameters
</p>
<p>will be ignored unless &quot;force.nonmonotonic&quot; option is TRUE in the specified pn.options list
</p>
<p>object (see <code class="reqn">modpar</code>) in which case they will be included as fixed values from the list object.
</p>
<p>Parameter bounds can be refinedto improve fits by altering this list, either manually or using
</p>
<p><code><a href="#topic+change.pnparameters">change.pnparameters</a></code>.
</p>
<p>4) Plot your curves using <code class="reqn">posnegRichards.eqn</code> specifying the appropriate model number and list of parameters/options.
</p>
<p>User level functions include:
</p>
<p><code class="reqn">pn.mod.compare</code>
</p>
<pre>

      all-model selection for positive-negative Richards nlsList models

        </pre>
<p><code class="reqn">pn.modselect.step</code>
</p>
<pre>

      backward stepwise model selection for positive-negative Richards nlsList models

        </pre>
<p><code class="reqn">SSposnegRichards</code>
</p>
<pre>

      selfStart function for estimating parameters of 36 possible reductions of the 8-parameter

      positive-negative Richards model (double-Richards)

        </pre>
<p><code class="reqn">posnegRichards.eqn</code>
</p>
<pre>

      function for evaluating 36 possible reductions of the 8-parameter 

      positive-negative Richards model (double-Richards)

        </pre>
<p><code class="reqn">modpar</code>
</p>
<pre>

      estimates mean parameters (and parameter bounds) for 8-parameter positive-negative Richards

      models or 4-parameter Richards models and saves in objects pnmodelparams

      and pnmodelparamsbounds. (required prior to use of the above functions)

        </pre>
<p><code class="reqn">change.pnparameters</code>
</p>
<pre>      

      simple function to update pnmodelparams and pnmodelparamsbounds

      with user specified values

        </pre>
<p><code class="reqn">extraF</code>
</p>
<pre>

      performs extra sum-of-squares F test for two nested nlsList models

        </pre>
<p><code class="reqn">extaF.nls</code>
</p>
<pre>

      performs extra sum-of-squares F test for two nested nls models

        </pre>


<h3>Note</h3>

<p>Version 1.5 saves many variables, and internal variables in the package environment:
</p>
<p>FlexParamCurve:::FPCEnv. By default, the pn.options file is copied to the environment
</p>
<p>specified by the functions (global environment by default). Model selection routines
</p>
<p>also copy from FPCenv to the global environment all nlsList models fitted during 
</p>
<p>model selection to provide backcompatibility with code for earlier versions. The user
</p>
<p>can redirect the directory to copy to by altering the Envir argument when calling the 
</p>
<p>function.
</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>References</h3>

<p>## Oswald, S.A. et al. 2012. FlexParamCurve: R package for flexible
</p>
<pre>

     fitting of nonlinear parametric curves. Methods in Ecology and Evolution. 3(6): 1073-77.

     doi: 10.1111/j.2041-210X.2012.00231.x (see also tutorial and introductory videos at:

     http://www.methodsinecologyandevolution.org/view/0/podcasts.html 

     posted September 2012 - if no longer at this link, check the archived videos (and comments) at:

     http://www.methodsinecologyandevolution.org/view/0/VideoPodcastArchive.html#allcontent)

                      </pre>


<h3>See Also</h3>

<p><code><a href="nlme.html#topic+nlme">nlme</a></code>
</p>
<p><code><a href="stats.html#topic+SSlogis">SSlogis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Code is provided here for an illustrative overview of using FlexParamCurve to select,  

# fit, analyze and plot the most appropriate non-linear curves for a dataset.

# NOTE: autorun is disabled for these examples since more detailed examples are provided for the 

# individual functions in their associated help files and runtime for this overview approximates 

# 5 mins. To run, simply copy and paste code from this help file into the R GUI.



# run all-model selection for posneg.data object (Step 2) without need to run any previous functions

## Not run:   

    modseltable &lt;- pn.mod.compare(posneg.data$age, posneg.data$mass,

    posneg.data$id, existing = FALSE, pn.options = "myoptions")
## End(Not run)



# run backwards stepwise model selection (Step 2) for logist.data object

#without need to run any previous functions

## Not run:   

    modseltable &lt;- pn.modselect.step(logist.data$age, logist.data$mass,

    logist.data$id, existing = FALSE, pn.options = "myoptions")
## End(Not run)



# estimate fixed parameters use data object posneg.data (Step 1)

## Not run:   

     modpar(posneg.data$age,posneg.data$mass, pn.options = "myoptions")
## End(Not run)



# change fixed values of M and constrain hatching mass to 45.5 in a growth curve (Step 1)

## Not run:   

      change.pnparameters(M=1,RM=0.5,first.y=45.5, pn.options = "myoptions")
## End(Not run)

    

# fit nlsList object using 6 parameter model with values M and RM (Step 3)

# fixed to value in pnmodelparams and then fit nlme model

## Not run:   

richardsR22.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, K = K,

      Infl = Infl, RAsym = RAsym, Rk = Rk, Ri = Ri,

      modno = 22, pn.options = "myoptions"), data = posneg.data)

richardsR22.nlme &lt;- nlme(richardsR22.lis, random = pdDiag(Asym + Infl ~ 1))
## End(Not run)

 

# fit reduced nlsList model and then compare performance with extraF (manual version of Step 2)

## Not run:   

 richardsR20.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, K = K,

      Infl = Infl, modno = 20, pn.options = "myoptions"), data = posneg.data)

 extraF(richardsR20.lis,richardsR22.lis)
## End(Not run)

 

# fit and plot a logistic curve (M=1) to data, note - all parameters set to 1 are ignored

# note code here forces \eqn{modpar} to only estimate 4 curve parameters (simple Richards curve)

#create list for fixed parameters

## Not run:   

modpar(logist.data$age,logist.data$mass,force4par=TRUE, pn.options = "myoptions")

change.pnparameters(M=1, pn.options = "myoptions") # set M to 1 for subsequent fit

richardsR20.nls &lt;- nls(mass ~ SSposnegRichards(age, Asym = Asym, K = K,

      Infl = Infl, modno = 20, pn.options = "myoptions"), data = logist.data)

plot(logist.data$age , logist.data$mass, xlab = "age", ylab = "mass", pch = ".", cex = 0.7) 

par &lt;- coef( richardsR20.nls )
## End(Not run)



#(Step 4)

## Not run:   

curve(posnegRichards.eqn(x, Asym = par[1], K = par[2], Infl = par[3], modno = 20

, pn.options = "myoptions"), add= TRUE)
## End(Not run)

</code></pre>

<hr>
<h2 id='change.pnparameters'>Change Fixed Parameter Values</h2><span id='topic+change.pnparameters'></span>

<h3>Description</h3>

<p>Function to alter values of parameters to be used by <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
</p>
<p>or <code><a href="#topic+posnegRichards.eqn">posnegRichards.eqn</a></code>
</p>
<p>as the fixed values in equations where parameters are fixed</p>


<h3>Usage</h3>

<pre><code class='language-R'>

change.pnparameters(Asym = NA,


K = NA,


Infl = NA,


M = NA,


RAsym = NA,


Rk = NA,


Ri = NA,


RM = NA,


Amin = NA,


Amax = NA,


Kmin = NA,


Kmax = NA,


Imin = NA,


Imax = NA,


Mmin = NA,


Mmax = NA,


RAmin = NA,


RAmax = NA,


Rkmin = NA,


Rkmax = NA,


Rimin = NA,


Rimax = NA,


RMmin = NA,


RMmax = NA,


first.y = NA,


x.at.first.y = NA,


last.y = NA,


x.at.last.y = NA,


twocomponent.x = NA,


verbose = NA,


force4par = NA,


pn.options,


Envir = .GlobalEnv)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change.pnparameters_+3A_asym">Asym</code></td>
<td>
<p>a numeric value for the asymptote of the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_k">K</code></td>
<td>
<p>a numeric value for the rate parameter of the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_infl">Infl</code></td>
<td>
<p>a numeric value for the point of inflection of the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_m">M</code></td>
<td>
<p>a numeric value for the shape parameter of the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_rasym">RAsym</code></td>
<td>
<p>a numeric value for  the asymptote of the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_rk">Rk</code></td>
<td>
<p>a numeric value for the rate parameter of the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_ri">Ri</code></td>
<td>
<p>a numeric value for the point of inflection of the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_rm">RM</code></td>
<td>
<p>a numeric value for the shape parameter of the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_amin">Amin</code></td>
<td>
<p>a numeric value for the minimum bound of Asym</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_amax">Amax</code></td>
<td>
<p>a numeric value for the maximum bound of Asym</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_kmin">Kmin</code></td>
<td>
<p>a numeric value for the minimum bound of K</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_kmax">Kmax</code></td>
<td>
<p>a numeric value for the maximum bound of K</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_imin">Imin</code></td>
<td>
<p>a numeric value for the minimum bound of Infl</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_imax">Imax</code></td>
<td>
<p>a numeric value for the maximum bound of Infl</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_mmin">Mmin</code></td>
<td>
<p>a numeric value for the minimum bound of M</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_mmax">Mmax</code></td>
<td>
<p>a numeric value for the maximum bound of M</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_ramin">RAmin</code></td>
<td>
<p>a numeric value for the minimum bound of RAsym</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_ramax">RAmax</code></td>
<td>
<p>a numeric value for the maximum bound of RAsym</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_rkmin">Rkmin</code></td>
<td>
<p>a numeric value for the minimum bound of Rk</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_rkmax">Rkmax</code></td>
<td>
<p>a numeric value for the maximum bound of Rk</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_rimin">Rimin</code></td>
<td>
<p>a numeric value for the minimum bound of Ri</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_rimax">Rimax</code></td>
<td>
<p>a numeric value for the maximum bound of Ri</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_rmmin">RMmin</code></td>
<td>
<p>a numeric value for the minimum bound of RM</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_rmmax">RMmax</code></td>
<td>
<p>a numeric value for the maximum bound of RM</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_first.y">first.y</code></td>
<td>
<p>the value of y at minimum x when it is required to be constrained</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_x.at.first.y">x.at.first.y</code></td>
<td>
<p>the final value of x - 0 value is used if not specified when last.y is not NA</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_last.y">last.y</code></td>
<td>
<p>the value of y at maximum x when it is required to be constrained</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_x.at.last.y">x.at.last.y</code></td>
<td>
<p>the final value of x - this is option is currently disabled</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_twocomponent.x">twocomponent.x</code></td>
<td>
<p>a numerical specifying the x-value (e.g. age) of intersection if a double model of 
</p>
<p>two separate components is to be fitted. Alternatively a logical of value
</p>
<p>= TRUE if the same type of model is to be fitted but the x of 
</p>
<p>intersection is unknown</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_verbose">verbose</code></td>
<td>
<p>logical indicating whether information on successful optimization and
</p>
<p>parameters should be returned during when using SSposnegRichards </p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_force4par">force4par</code></td>
<td>
<p>logical specifying whether parameters of the negative Richards
</p>
<p>should be ignored - effectively using simple Richards curve</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_pn.options">pn.options</code></td>
<td>
<p>required character string specifying the name of a list object currently 
</p>
<p>populated with starting parameter estimates, fitting options and bounds to be modified</p>
</td></tr>
<tr><td><code id="change.pnparameters_+3A_envir">Envir</code></td>
<td>
<p>a valid R environment to find pn.options in, by default this is the global environment</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function provides a simple way for the user to update
</p>
<p>the a user-named list that holds fixed values and options
</p>
<p>for fitting and solving positive-negative Richards curves with
</p>
<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> and <code><a href="#topic+posnegRichards.eqn">posnegRichards.eqn</a></code>,
</p>
<p>respectively. Running this function also concurrently updates the parameterbounds
</p>
<p>in the same list which are vthe maximum and minimum values
</p>
<p>for parameters to be used by <code><a href="stats.html#topic+optim">optim</a></code> and <code><a href="stats.html#topic+nls">nls</a></code>
</p>
<p>during parameter estimation
</p>
<p>in <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>. The list is written automatically by the function but 
</p>
<p>it is also output as a return value for assignation in the usual way [myoptions&lt;- change.pnparameters(...)].
</p>
<p>The list specified by pn.options must exist before this function is called. Use <code><a href="#topic+modpar">modpar</a></code>
</p>
<p>to estimate values for all parameters and easily generate a suitable list. See  <code><a href="#topic+modpar">modpar</a></code> for details of bounding.</p>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+list">list</a></code> of values for all above arguments,
</p>
<p>with new values substituted where specified in the call</p>


<h3>Note</h3>

<p>Requires <code><a href="#topic+modpar">modpar</a></code> to be have been run prior to execution   
</p>
<p>Version 1.5 saves many variables, and internal variables in the package environment:
</p>
<p>FlexParamCurve:::FPCEnv. By default, the pn.options file is copied to the environment
</p>
<p>specified by the functions (global environment by default). Model selection routines
</p>
<p>also copy from FPCenv to the global environment all nlsList models fitted during 
</p>
<p>model selection to provide backcompatibility with code for earlier versions. The user
</p>
<p>can redirect the directory to copy to by altering the Envir argument when calling the 
</p>
<p>function.
</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+modpar">modpar</a></code> <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> <code><a href="#topic+posnegRichards.eqn">posnegRichards.eqn</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

# change all fixed values except K and Rk


    modpar(posneg.data$age, posneg.data$mass, pn.options = "myoptions")


    change.pnparameters(Asym = 10000, Infl = 80, M = 5, RAsym = 10000, 


        Ri = 240, RM = 5, pn.options = "myoptions")





# change fixed values of M and constrain hatching mass to 45.5 in a growth curve


    change.pnparameters(M = 1, RM = 0.5, first.y = 45.5, pn.options = "myoptions")


</code></pre>

<hr>
<h2 id='extraF'>Compare Two <code class="reqn">nlsList</code> Models Using Extra Sum-of-Squares F-Tests</h2><span id='topic+extraF'></span>

<h3>Description</h3>

<p>Function to compare two nested models using extra sum-of-squares F-Tests.</p>


<h3>Usage</h3>

<pre><code class='language-R'>

extraF(submodel = 1,


genmodel = 1,


warn = TRUE)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extraF_+3A_submodel">submodel</code></td>
<td>
<p><code class="reqn">nlsList</code> model with fewer curve parameters (reduced model)</p>
</td></tr>
<tr><td><code id="extraF_+3A_genmodel">genmodel</code></td>
<td>
<p><code class="reqn">nlsList</code> model with more curve parameters (general model)</p>
</td></tr>
<tr><td><code id="extraF_+3A_warn">warn</code></td>
<td>
<p>logical specifying whether to report working R environment if previously exists</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models must be entered in the correct order with the reduced model appearing
</p>
<p>first in the call and the more general model appearing later. These must be nested models,
</p>
<p>i.e. the general model must contain all of the curve parameters in the reduced model and more.
</p>
<p>Entering models with the same number of parameters will produce NAs in the output, but
</p>
<p>the function will produce seemingly adequate output with non-nested models. The user must
</p>
<p>check that models are nested prior to use.
</p>
<p>This function is primarily designed to be called by the model selection functions
</p>
<p><code><a href="#topic+pn.modselect.step">pn.modselect.step</a></code> and <code><a href="#topic+pn.mod.compare">pn.mod.compare</a></code> but can be used independently.
</p>
<p>Extra sum-of-squares is obtained from: </p>
<pre>F = (SS1 - SS2)/(df1 - df2) / (SS2 / df2)</pre>
<p>where SS = sum-of-squares and df = degrees of freedom, for the more reduced model (1) and the
</p>
<p>more general model (2), respectively.
</p>
<p>If the F value is significant then the more general model provides a significant improvement
</p>
<p>over the reduced model, but if the models are not significantly different then the reduced
</p>
<p>parameter model is to be preferred.
</p>
<p>In extraF (formulated especially for nlsList models), the root mean square error
</p>
<p>(and sum of squares) is inflated to the value expected if all groups (levels) were 
</p>
<p>fitted [i.e. RSE  =  RSE* (sqrt(n1) / sqrt(n0)), where RSE is root mean square error, n0 is the sample size (total
</p>
<p>number of data points used in fit) for the model with missing levels, and n1 is the inflated sample size (total number
</p>
<p>of data points in dataset)]. This is based on RSE changing with the square root of sample size, as discussed in the help file for
</p>
<p><code><a href="#topic+pn.mod.compare">pn.mod.compare</a></code>. Degrees of freedom are then increased to the vaue if all individuals had been fitted successfully, 
</p>
<p>i.e. total df - (# curve parameters * # levels). Thus, RSE and df are enlarged for models with missing levels so all models are
</p>
<p>compared based on the variability expected if all levels had been fitted . This allows the Fstat from extraF to be independent of missing levels
</p>
<p>in either of the two models.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> listing the names of the models compared, F,
</p>
<p>numerator degrees of freedom,
</p>
<p>demonimator degrees of freedom, P value and the residual sum of squares for both the general
</p>
<p>and reduced models</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>References</h3>

<p>Ritz, C. and Streibigg, J. C. (2008) <code class="reqn">Nonlinear regression with R.</code>
</p>
<p>Springer-Verlag, New York.</p>


<h3>See Also</h3>

<p><code><a href="#topic+extraF.nls">extraF.nls</a></code>
</p>
<p><code><a href="nlme.html#topic+nlsList">nlsList</a></code>
</p>
<p><code><a href="#topic+pn.modselect.step">pn.modselect.step</a></code>
</p>
<p><code><a href="#topic+pn.mod.compare">pn.mod.compare</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

   #compare two nested nlsList models (4 vs 8 parameter models)


   modpar(posneg.data$age, posneg.data$mass, pn.options = "myoptions")


   # (only first 4 group levels in data used for example's sake)


   subdata&lt;-subset(posneg.data, as.numeric(row.names (posneg.data) ) &lt; 53)


   richardsR2.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, K = K,


     Infl = Infl, M = M, RAsym = RAsym, Rk = Rk, Ri = Ri,modno = 2, pn.options = "myoptions")


                        , data = subdata)


   richardsR12.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, K = K,


     Infl = Infl, M = M, modno = 12, pn.options = "myoptions")


                        , data = subdata)


   extraF(richardsR12.lis, richardsR2.lis)


</code></pre>

<hr>
<h2 id='extraF.nls'>Compare Two <code class="reqn">nls</code> Models Using Extra Sum-of-Squares F-Tests</h2><span id='topic+extraF.nls'></span>

<h3>Description</h3>

<p>Function to compare two nested <code><a href="stats.html#topic+nls">nls</a></code> models using extra
</p>
<p>sum-of-squares F-Tests.</p>


<h3>Usage</h3>

<pre><code class='language-R'>

extraF.nls(submodel,


genmodel)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extraF.nls_+3A_submodel">submodel</code></td>
<td>
<p><code class="reqn">nls</code> model with fewer curve parameters (reduced model)</p>
</td></tr>
<tr><td><code id="extraF.nls_+3A_genmodel">genmodel</code></td>
<td>
<p><code class="reqn">nls</code> model with more curve parameters (general model)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models must be entered in the correct order with the reduced model appearing
</p>
<p>first in the call and the more general model appearing later. These must be nested models,
</p>
<p>i.e. the general model must contain all of the curve parameters in the reduced model and more.
</p>
<p>Entering models with the same number of parameters will produce NAs in the output, but
</p>
<p>the function will produce seemingly adequate output with non-nested models. The user must
</p>
<p>check that models are nested prior to use.
</p>
<p>This function is not promoted for use in model selection as differences in curves of
</p>
<p>different grouping levels in the dataset may be obscured when curves are fitted to the
</p>
<p>entire dataset, as in <code><a href="stats.html#topic+nls">nls</a></code>.
</p>
<p>Extra sum-of-squares is obtained from: </p>
<pre>F = (SS1 - SS2)/(df1 - df2) / (SS2 / df2)</pre>
<p>where SS = sum-of-squares and df = degrees of freedom, for the more reduced model (1) and the
</p>
<p>more general model (2), respectively. To account for missing individuals for different fits
</p>
<p>df are scaled in all models to the value they would be if all individuals fit successfully (note
</p>
<p>that if all individuals had the same fit, this would not influence extra sum of squares).
</p>
<p>If the F value is significant then the more general model provides a significant improvement
</p>
<p>over the reduced model, but if the models are not significantly different then the reduced
</p>
<p>parameter model is to be preferred.</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> listing the names of the models compared, F,
</p>
<p>numerator degrees of freedom,
</p>
<p>demonimator degrees of freedom, P value and the residual sum of squares for both the general
</p>
<p>and reduced models</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>References</h3>

<p>Ritz, C. and Streibigg, J. C. (2008) <code class="reqn">Nonlinear regression with R.</code>
</p>
<p>Springer-Verlag, New York.</p>


<h3>See Also</h3>

<p><code><a href="#topic+extraF">extraF</a></code>
</p>
<p><code><a href="stats.html#topic+nls">nls</a></code>
</p>
<p><code><a href="#topic+pn.modselect.step">pn.modselect.step</a></code>
</p>
<p><code><a href="#topic+pn.mod.compare">pn.mod.compare</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

#fit and compare two nested nls models (7 vs 8 parameter models)


   #create list for fixed parameters


   modpar(posneg.data$age, posneg.data$mass, pn.options = "myoptions") 


   richardsR1.nls &lt;- nls(mass ~ SSposnegRichards(age, Asym = Asym, K = K,


   Infl = Infl, M = M, RAsym = RAsym, Rk = Rk, Ri = Ri, RM = RM, modno = 1, pn.options = myoptions)


                        , data = posneg.data)


   richardsR2.nls &lt;- nls(mass ~ SSposnegRichards(age, Asym = Asym, K = K,


   Infl = Infl, M = M, RAsym = RAsym, Rk = Rk, Ri = Ri, modno = 2, pn.options = myoptions)


                        , data = posneg.data)


   extraF.nls(richardsR2.nls, richardsR1.nls)


</code></pre>

<hr>
<h2 id='get.mod'>Copy objects between R environments</h2><span id='topic+get.mod'></span>

<h3>Description</h3>

<p>Function to copy objects between R environments</p>


<h3>Usage</h3>

<pre><code class='language-R'>
get.mod(modelname = ls(FPCEnv, pattern=".lis" ),

 from.envir = FPCEnv, to.envir = .GlobalEnv,

 write.mod = FALSE, silent = FALSE)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.mod_+3A_modelname">modelname</code></td>
<td>
<p>a character or character vector of object names</p>
</td></tr>
<tr><td><code id="get.mod_+3A_from.envir">from.envir</code></td>
<td>
<p>R environment currently containing the object(s)</p>
</td></tr>
<tr><td><code id="get.mod_+3A_to.envir">to.envir</code></td>
<td>
<p>destination R environment to copy the object(s) to</p>
</td></tr>
<tr><td><code id="get.mod_+3A_write.mod">write.mod</code></td>
<td>
<p>logical specifying if single models should be assigned or simply returned</p>
</td></tr>
<tr><td><code id="get.mod_+3A_silent">silent</code></td>
<td>
<p>logical specifying whether additional confirmation should be printed to the screen</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All arguments are optional. With defaults, this function copies any <code class="reqn">nlsList</code> models
</p>
<p>from the FlexParamCurve working environment to the Global Environment. However, user could use 
</p>
<p>this function to move any objects between any environments. 
</p>
<p>Default behavior is to assign models to an environment if more than 1 modelname is provided but to
</p>
<p>simply return the model from the function if only 1 modelname is given. Notes are printed to the
</p>
<p>screen to detail any models moved or any errors encountered.
</p>


<h3>Value</h3>

<p>If only 1 modelname is provided, the contents of the object is returned. If more
</p>
<p>more than 1 modelname is provided or if write.mod is FALSE then the object(s) will be assigned
</p>
<p>to the environment and no value is returned.</p>


<h3>Note</h3>

<p>The default function works by detecting the suffix .lis rather than object class, so will
</p>
<p>only return models with this suffix, not necessarily all <code class="reqn">nlsList</code> models if they have
</p>
<p>different suffixes.</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+pn.mod.compare">pn.mod.compare</a></code>
</p>
<p><code><a href="#topic+pn.modselect.step">pn.modselect.step</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 #transfer all nlsList models from the FlexParamCurve working environmment (FPCEnv) 

   #to the Global Environment. Note: unless pn.mod.compare or 

   #pn.modselect.step have been run, in which case this is default

   #1. subset data object (only 3 individuals) to expediate model selection

   subdata &lt;- subset(posneg.data, as.numeric(row.names (posneg.data) ) &lt; 40)

   #2. run model selection in FPCEnv using pn.mod.compare. Only two models (#1 and #5)

   #specified to be run here to reduce processing time. see pn.mod.compare

   modseltable &lt;- pn.mod.compare(subdata$age, subdata$mass,

   subdata$id, existing = FALSE, pn.options = "myoptions", mod.subset = c(1,5)

   , Envir = FlexParamCurve:::FPCEnv)

   #3. retrieve models from FlexParamCurve working environmment

   get.mod()

   #transfer an options file called myoptions from FPCEnv to the Global Environment

   #note data are forced to fit a monotonic curve in this example

   modpar(logist.data$age, logist.data$mass, pn.options = "myoptions.1", force4par = TRUE, 

   Envir = FlexParamCurve:::FPCEnv)

   get.mod(modelname = "myoptions.1", write.mod = TRUE)

</code></pre>

<hr>
<h2 id='logist.data'>Simulated growth of whiskered terns</h2><span id='topic+logist.data'></span>

<h3>Description</h3>

<p>The <code>logist.data</code> data frame has 1100 rows and 3 columns of records of
the simulated masses for whiskered tern chicks between 0 and 21 
days of age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logist.data</code></pre>


<h3>Format</h3>

<p>This object of class <code>c("nfnGroupedData", "nfGroupedData",
    "groupedData", "data.frame")</code> containing the following columns:
</p>

<dl>
<dt>mass</dt><dd>
<p>a numeric vector of chick masses (g).
</p>
</dd>
<dt>age</dt><dd>
<p>a numeric vector of chick ages (days).
</p>
</dd>
<dt>id</dt><dd>
<p>an ordered factor indicating unique id of each simulated individual,
i.e. which data belongs to which individual.
</p>
</dd>
</dl>



<h3>Details</h3>

   
<p>No published parameter estimates with associated variability are available for
positive-negative growth curves. These data were simulated using
an 3-parameter positive-negative Richards curve (<code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
(model 20)), using parameters drawn from normal distributions with the following
means (standard deviations):
</p>
<pre>
  Asym=92.35 (15.65)
  K=0.06 (0.138)
  Infl=0.294 (1.72)</pre>
<p>These values were taken from Pallisson et al. (2008) for 75 chicks reported.
Each simulated individual had 11 measurements
stratified through the development period, with 1-2 day random differences in timing
of each measurement.
This data object has methods for <code><a href="nlme.html#topic+nlme">nlme</a></code> grouped-data classes. 
</p>


<h3>Source</h3>

<p>Paillisson, J.-M., Latraube, F. &amp; Reeber, S. (2008) 
Assessing growth and age of Whiskered Tern 
<code class="reqn">Chlidonias hybrida</code> chicks using biometrics. Ardea, 96, 271-277.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
#view data
logist.data
#create list for fixed parameters
modpar(logist.data$age, logist.data$mass, force4par = TRUE, pn.options = "myoptions")
plot(mass ~ age, data = logist.data, subset = id == "0.002",
     xlab = "Chick age (day)", las = 1,
     ylab = "Chick mass (g)",
     main = "logist.data and fitted curve (Chick #2 only)")
change.pnparameters(M=1, pn.options = "myoptions") # set curve to logistic (M=1) in subsequent fit
fm1 &lt;- nls(mass ~ SSposnegRichards(age,Asym=Asym,K=K,Infl=Infl,
           modno=20, pn.options = "myoptions"),
           data = logist.data, subset = id == "0.002")
age &lt;- seq(0, 166, length.out = 101)
lines(age, predict(fm1, list(age = age)))
</code></pre>

<hr>
<h2 id='modpar'>Estimate Values to be Used for Fixed FlexParamCurve Parameters</h2><span id='topic+modpar'></span>

<h3>Description</h3>

<p>This function creates the object <code>pnmodelparams</code>
</p>
<p>which holds estimates of values for all 8 FlexParamCurve
</p>
<p>parameters used for fitting and solving positive-negative Richards curves with
</p>
<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> and <code><a href="#topic+posnegRichards.eqn">posnegRichards.eqn</a></code>,
</p>
<p>respectively. </p>


<h3>Usage</h3>

<pre><code class='language-R'>
modpar(x,

y,

pn.options = NA,

first.y = NA,

x.at.first.y = NA,

last.y = NA,

x.at.last.y = NA,

twocomponent.x = NA,

verbose = FALSE,

force8par = FALSE,

force4par = FALSE,

suppress.text = FALSE,

taper.ends = 0.45,

width.bounds = 1,

bounds.error = FALSE,

Envir = .GlobalEnv,

force.nonmonotonic = FALSE,

...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modpar_+3A_x">x</code></td>
<td>
<p>a numeric vector of primary predictor variable</p>
</td></tr>
<tr><td><code id="modpar_+3A_y">y</code></td>
<td>
<p>a numeric vector of response variable</p>
</td></tr>
<tr><td><code id="modpar_+3A_first.y">first.y</code></td>
<td>
<p>the value of y at minimum x  when it is required to be constrained</p>
</td></tr>
<tr><td><code id="modpar_+3A_x.at.first.y">x.at.first.y</code></td>
<td>
<p>the final value of x - 0 value is used if not specified when last.y is not NA</p>
</td></tr>
<tr><td><code id="modpar_+3A_last.y">last.y</code></td>
<td>
<p>the value of y at maximum x when it is required to be constrained</p>
</td></tr>
<tr><td><code id="modpar_+3A_x.at.last.y">x.at.last.y</code></td>
<td>
<p>the final value of x - must be specified if last.y is not NA</p>
</td></tr>
<tr><td><code id="modpar_+3A_twocomponent.x">twocomponent.x</code></td>
<td>
<p>a numerical specifying the x-value (e.g. age) of intersection if a double model of 
</p>
<p>two separate components is to be fitted. Alternatively a logical of value
</p>
<p>= TRUE if the same type of model is to be fitted but the x of 
</p>
<p>intersection is unknown</p>
</td></tr>
<tr><td><code id="modpar_+3A_verbose">verbose</code></td>
<td>
<p>logical indicating whether information on successful optimization and
</p>
<p>parameters should be returned during when using SSposnegRichards </p>
</td></tr>
<tr><td><code id="modpar_+3A_force8par">force8par</code></td>
<td>
<p>logical specifying whether parameters of the negative Richards
</p>
<p>curve should be set to defaults if they cannot be estimated</p>
</td></tr>
<tr><td><code id="modpar_+3A_force4par">force4par</code></td>
<td>
<p>logical specifying whether parameters of the negative Richards
</p>
<p>should be ignored - effectively using simple Richards curve</p>
</td></tr>
<tr><td><code id="modpar_+3A_pn.options">pn.options</code></td>
<td>
<p>character string specifying name of <code><a href="base.html#topic+list">list</a></code> object populated with starting 
</p>
<p>parameter estimates, fitting options and bounds or the destination for <code>modpar</code> to write a new list</p>
</td></tr>
<tr><td><code id="modpar_+3A_suppress.text">suppress.text</code></td>
<td>
<p>logical specifying whether modpar should return descriptive text to the screen during execution</p>
</td></tr>
<tr><td><code id="modpar_+3A_taper.ends">taper.ends</code></td>
<td>
<p>numeric representing the proportion of the range of the x variable for which data are extended at 
</p>
<p>the two ends of the data set. This is used in initial estimation (prior to optim and nls optimizations) and can 
</p>
<p>speed up subsequent optimizations by imposing a more pronounced S-shape to both first and second curves. Defaults to 0.45.</p>
</td></tr>
<tr><td><code id="modpar_+3A_width.bounds">width.bounds</code></td>
<td>
<p>a numeric indicating the proportion of the usual width of parameter bounds to be imposed during optimizations. 
</p>
<p>Large values may slow or terminate computations, however they could better accomodate data in which different levels exhibit very different
</p>
<p>parameter values.</p>
</td></tr>
<tr><td><code id="modpar_+3A_bounds.error">bounds.error</code></td>
<td>
<p>a logical. If true parameter estimation will terminate if initial estimation of parameters leads to
</p>
<p>values outside specified bounds in pn.options. If false, more appropriate bounds will be determined automatically.</p>
</td></tr>
<tr><td><code id="modpar_+3A_envir">Envir</code></td>
<td>
<p>a valid R environment to find pn.options in and export any output to, by default this is the global environment</p>
</td></tr> 
<tr><td><code id="modpar_+3A_force.nonmonotonic">force.nonmonotonic</code></td>
<td>
<p>if set to TRUE fixed recessional parameter estimates will be used for the two monotonic equations
</p>
<p>(modno #12 or #32), otherwise these two models will use RAsym = 0, Ri = 0, Rk = 1, RM = 1 to prevent non-monotonic relationships
</p>
<p>in these cases.</p>
</td></tr> 
<tr><td><code id="modpar_+3A_...">...</code></td>
<td>
<p>additional optional arguments to be passed to nlsList</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a formatted <code><a href="base.html#topic+list">list</a></code> object as named by the argument pn.options. This list
</p>
<p>holds estimates of values for all 8 FlexParamCurve parameters, fitting options and parameter bounds used for
</p>
<p>fitting and solving double-Richards curves with <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> and <code><a href="#topic+posnegRichards.eqn">posnegRichards.eqn</a></code>,
</p>
<p>respectively. Parameter bounds are the maximum and minimum parameters values that can be used by <code><a href="stats.html#topic+optim">optim</a></code>
</p>
<p>and <code><a href="stats.html#topic+nls">nls</a></code> during parameter estimation. For definitions of parameters see either <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> 
</p>
<p>or <code><a href="#topic+posnegRichards.eqn">posnegRichards.eqn</a></code>. The list is written automatically by the function (to &quot;.pntemplist&quot;) but it is
</p>
<p>also output as a return value for assignation and subsequent use in the usual way [myoptions&lt;- change.pnparameters(...)].
</p>
<p>Estimates are produced by fitting positive-negative or double Richards curves in
</p>
<p><code><a href="stats.html#topic+nls">nls</a></code> using
</p>
<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> for the full 8 parameter model (R1).
</p>
<p>If this fails, the function <code><a href="stats.html#topic+getInitial">getInitial</a></code> is called to
</p>
<p>attempt to produce initial estimates using the same 8 parameter model.
</p>
<p>If this also fails, estimates are attempted in the same way using the
</p>
<p>4 parameter (positive only) model (R12). In this case, only the positive
</p>
<p>parameters are returned (NAs are substituted for negative parameters)
</p>
<p>unless argument force8par=TRUE, in which case negative parameters are
</p>
<p>defaulted to: RAsym = 0.05*Asym, Rk = K, Ri = Infl, RM = M.
</p>
<p>This function can now fit biphasic (and more generally
</p>
<p>double-Richards) curves, where the final curve is effectively either two positive curves
</p>
<p>or two negative curves, as well as negative-positive curves. This functionality is default 
</p>
<p>and does not need to be specified.
</p>
<p>Parameter bounds estimated here for use in <code><a href="stats.html#topic+optim">optim</a></code> and <code><a href="stats.html#topic+nls">nls</a></code>
</p>
<p>fits within <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> are
</p>
<p>applicable to a wide range of curves, although user may
</p>
<p>change these manually in <code><a href="base.html#topic+list">list</a></code> object specified by <code>pn.options</code>.
</p>
<p>Bounds are estimated by <code><a href="#topic+modpar">modpar</a></code> by adding or subtracting multiples
</p>
<p>of fixed parameter values to estimated mean parameter values:
</p>
<p>-Asym*0.5 and +Asym*2.5,
</p>
<p>-K*0.5 and +K*0.5,
</p>
<p>-Infl*2.5 and +Infl*10
</p>
<p>-M*2 and +M*2
</p>
<p>-RAsym*0.5 and +RAsym*2.5,
</p>
<p>-Rk*0.5 and +Rk*0.5,
</p>
<p>-Ri*2.5 and +Ri*5
</p>
<p>-RM*2 and +RM*2.
</p>
<p>Use force8par = TRUE if initial call to <code><a href="#topic+modpar">modpar</a></code> produces estimates for
</p>
<p>only 4 parameters and yet an 8 parameter model is desired for <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
</p>
<p>or <code><a href="#topic+posnegRichards.eqn">posnegRichards.eqn</a></code>.
</p>
<p>Use force4par = TRUE if you desire to produces estimates only for the four parameters of
</p>
<p>a single Richards curves. This should also be used if you wish to fit simple logistic
</p>
<p>Gompertz or von Bertalanffy curves: see <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> for more details. If 
</p>
<p>the specified model in subsequent <code class="reqn">SSposnegRichards</code>, model selection or ploting calls
</p>
<p>is monotonic (i.e. contains no recession parameters: modno= 12 or 32) recessional parameters
</p>
<p>will not be included for these two models unless &quot;force.nonmonotonic&quot; option is TRUE,
</p>
<p>in the specified pn.options list object, in which case parameters will be drawn from the specified 
</p>
<p>pn.options list object.
</p>
<p>When specified, first.y and last.y are saved in list object specified by <code>pn.options</code> to instruct
</p>
<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> to add this as the first or last value of the response, respectively,
</p>
<p>during estimation.
</p>
<p>To fit two-component double-curves, in which one curve equation is used up to (and including)
</p>
<p>the x of intersection and a separate equation is used for x-values greater than the x of intersection
</p>
<p>the argument twocomponent.x should be set to the value for the x of intersection. If this argument
</p>
<p>is anything other than NA then a two-component model will be fitted when <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
</p>
<p>is called. This option will be saved in list object specified by <code>pn.options</code> and can be changed at will.
</p>
<p>taper.ends can be used to speed up optimization as it extends the dataset at maximum and minimum extremes 
</p>
<p>of x by repeatedly pasting the y values at these extremes for a specified proportion of the range of x. 
</p>
<p>taper.ends is a numeric value representing the proportion of the range of x values are extended for and 
</p>
<p>defaults to 0.45 (45
</p>
<p>tend towards a zero slope this is a suitable values. If tapered ends are not desirable then choose taper.ends = 0.
</p>
<p>If the argument verbose = TRUE then details concerning the optimization processes within 
</p>
<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> are printed on screen whenever <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> is called.
</p>
<p>These include whether optimization of the first or second parts of the curve or simultaneous optimizations
</p>
<p>are successful, if these have been further refined by nls, whether default parameters were used or the 
</p>
<p>parameterization was aborted and what parameter values were finally exported by <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>. 
</p>
<p>This option will be saved in the list object specified  by <code>pn.options</code> and can be changed at will.
</p>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+list">list</a></code> of estimated fixed values for all
</p>
<p>above arguments</p>


<h3>Note</h3>

<p>Version 1.5 saves many variables, and internal variables in the package environment:
</p>
<p>FlexParamCurve:::FPCEnv. By default, the pn.options file is copied to the environment
</p>
<p>specified by the functions (global environment by default). Model selection routines
</p>
<p>also copy from FPCenv to the global environment all nlsList models fitted during 
</p>
<p>model selection to provide backcompatibility with code for earlier versions. The user
</p>
<p>can redirect the directory to copy to by altering the Envir argument when calling the 
</p>
<p>function.
</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate fixed parameters use data object posneg.data

   	 modpar(posneg.data$age, posneg.data$mass, pn.options = "myoptions")



# estimate fixed parameters use data object posneg.data (only first 

# 4 group levels for example's sake) and specify a fixed hatching 

# mass for curve optimization using \code{\link{SSposnegRichards}}

	 modpar(posneg.data$age, posneg.data$mass, pn.options = "myoptions")

   	 subdata &lt;- subset(posneg.data,posneg.data$id == as.character(36)

	    		| posneg.data$id == as.character(9) 

	    		| posneg.data$id == as.character(32) 

	    		| posneg.data$id == as.character(43))

	 richardsR22.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, 

	         K = K, Infl = Infl, RAsym = RAsym, Rk = Rk, Ri = Ri, 

        	 modno = 22, pn.options = "myoptions"), data = subdata)

   		 



# force an 8 parameter estimate on logistic data

modpar(logist.data$age,logist.data$mass,force8par=TRUE, pn.options = "myoptions")





# force an 4 parameter model on logistic data

modpar(logist.data$age,logist.data$mass,force4par=TRUE, pn.options = "myoptions")



# troubleshoot the fit of a model 

modpar(posneg.data$age,posneg.data$mass,verbose=TRUE, pn.options = "myoptions")



# fit a two component model - enter your own data in place of "mydata"

        # this details an approach but is not run for want of appropriate data

        # if x of intersection unknown

        ## Not run: 

 	modpar(mydata$x,mydata$y,twocomponent.x=TRUE, pn.options = "myoptions")

        # if x of intersection = 75

 	modpar(mydata$x,mydata$y,twocomponent.x=75, pn.options = "myoptions")

 	richardsR1.nls &lt;- nls(y~ SSposnegRichards(x, Asym = Asym, K = K,

                 Infl = Infl, M = M, RAsym = RAsym, Rk = Rk, Ri = Ri, RM = RM,

                 modno = 1, pn.options = "myoptions")

                 , data = mydata)
## End(Not run)

</code></pre>

<hr>
<h2 id='penguin.data'>Field data on growth of little penguins <code class="reqn">Eudyptula minor</code></h2><span id='topic+penguin.data'></span>

<h3>Description</h3>

<p>The <code>penguin.data</code> data frame has 2244 rows and 11 columns of records of
the measured masses for little penguin chicks between 13 and 74 
days of age collected at Philip Island, Victoria, Australia in 2000 and 2002
(see Chiaradia &amp; Nisbet 2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penguin.data</code></pre>


<h3>Format</h3>

<p>This object of class <code>c("nfnGroupedData", "nfGroupedData",
    "groupedData", "data.frame")</code> containing the following columns:
</p>

<dl>
<dt>site</dt><dd>
<p>Three character factor for the site (only one site in dataset).
</p>
</dd>
<dt>year</dt><dd>
<p>A factor specifying the year of measurement.
</p>
</dd>
<dt>bandid</dt><dd>
<p>an ordered factor indicating unique id of each individual: the union of
the laying date of the nest relative to the colony and the band combination
</p>
</dd>
<dt>siteyear</dt><dd>
<p>A factor specifying levels of year for different sites (only one site in dataset).
</p>
</dd>
<dt>weight</dt><dd>
<p>a numeric vector of chick masses (g).
</p>
</dd>
<dt>ckage</dt><dd>
<p>a numeric vector of chick ages (days).
</p>
</dd>
<dt>Jdate</dt><dd>
<p>a numeric vector of first egg-laying date of the nest(days), relative to the mean
laying date for all nests in that year.
</p>
</dd>
<dt>nest</dt><dd>
<p>A factor of unique codes that identify each nest.
</p>
</dd>
<dt>ck</dt><dd>
<p>A factor of hatching order for each chick (A = first hatched, B = second hatched).
</p>
</dd>
<dt>outcome</dt><dd>
<p>A factor of codes for fate of each chick (F = fledged; only fledged chicks included).
</p>
</dd>
<dt>clutch</dt><dd>
<p>A factor of size of clutch/brood that each chick comes from (either 1- or 2-chick brood).
</p>
</dd>
</dl>



<h3>Details</h3>

   
<p>Data were collected as outlined in Chiaradia &amp; Nisbet (2006). Penguin chicks are generally considered
to exhibit a double-Gompertz growth form.Please contact Andre Chiaradia (a.chiaradia@penguins.org.au) 
for use in collaborations.
</p>


<h3>Source</h3>

<p>Chiaradia, A. &amp; Nisbet, I.C.T. (2006) 
Plasticity in parental provisioning and chick growth in Little Penguins <code class="reqn">Eudyptula minor</code>
in years of high and low breeding success. Ardea, 94, 257-270. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
#view data
penguin.data
modpar(penguin.data$ckage, penguin.data$weight, pn.options = "myoptions")
plot(weight ~ ckage, data = penguin.data, subset = bandid == penguin.data$bandid[1],
     xlab = "Chick age (day)", las = 1,
     ylab = "Chick mass (g)",
     main = "penguin.data and fitted curve (Chick #307 only)")
fm1 &lt;- nls(weight ~ SSposnegRichards(ckage,Asym=Asym,K=K,Infl=Infl, RAsym=RAsym,
           modno=31, pn.options= "myoptions"),
           data = penguin.data, subset = bandid == penguin.data$bandid[1])
ckage &lt;- seq(0, 74, length.out = 101)
lines(ckage, predict(fm1, list(ckage = ckage)))
</code></pre>

<hr>
<h2 id='pn.mod.compare'>Compare All Possible Positive-Negative Richards <code class="reqn">nlslist</code> Models</h2><span id='topic+pn.mod.compare'></span>

<h3>Description</h3>

<p>This function performs model selection for <code><a href="nlme.html#topic+nlsList">nlsList</a></code> models fitted using
</p>
<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>

pn.mod.compare(x,


y,


grp,


pn.options,


forcemod = 0,


existing = FALSE,


penaliz = "1/sqrt(n)",


taper.ends = 0.45,


mod.subset = c(NA),


Envir = .GlobalEnv,


...)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pn.mod.compare_+3A_x">x</code></td>
<td>
<p>a numeric vector of the primary predictor</p>
</td></tr>
<tr><td><code id="pn.mod.compare_+3A_y">y</code></td>
<td>
<p>a numeric vector of the response variable</p>
</td></tr>
<tr><td><code id="pn.mod.compare_+3A_grp">grp</code></td>
<td>
<p>a factor of same length as x and y that distinguishes groups within
</p>
<p>the dataset</p>
</td></tr>
<tr><td><code id="pn.mod.compare_+3A_pn.options">pn.options</code></td>
<td>
<p>required character string specifying name of 
</p>
<p><code><a href="base.html#topic+list">list</a></code> object populated with starting 
</p>
<p>parameter estimates, fitting options and bounds</p>
</td></tr>
<tr><td><code id="pn.mod.compare_+3A_forcemod">forcemod</code></td>
<td>
<p>optional numeric value to constrain model selection (see Details)</p>
</td></tr>
<tr><td><code id="pn.mod.compare_+3A_existing">existing</code></td>
<td>
<p>optional logical value specifying whether some of the relevant models
</p>
<p>have already been fitted</p>
</td></tr>
<tr><td><code id="pn.mod.compare_+3A_penaliz">penaliz</code></td>
<td>
<p>optional character value to determine how models are ranked (see Details)</p>
</td></tr>
<tr><td><code id="pn.mod.compare_+3A_taper.ends">taper.ends</code></td>
<td>
<p>numeric representing the proportion of the range of the x variable for which data are extended at 
</p>
<p>the two ends of the data set. This is used in initial estimation (prior to optim and nls optimizations) and can 
</p>
<p>speed up subsequent optimizations by imposing a more pronounced S-shape to both first and second curves. Defaults to 0.45.</p>
</td></tr>
<tr><td><code id="pn.mod.compare_+3A_mod.subset">mod.subset</code></td>
<td>
<p>optional vector containing modno of models that the user desires to be estimated. If not NA, only 
</p>
<p><code><a href="nlme.html#topic+nlsList">nlsList</a></code> models in mod.subset will be fitted and ranked</p>
</td></tr>
<tr><td><code id="pn.mod.compare_+3A_envir">Envir</code></td>
<td>
<p>a valid R environment to find pn.options in and export any output to, by default this is the global
</p>
<p>environment</p>
</td></tr> 
<tr><td><code id="pn.mod.compare_+3A_...">...</code></td>
<td>
<p>additional optional arguments to be passed to nlsList</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, whether parameter M should be fixed
</p>
<p>(see <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>) is determined by fitting models 12 and 20 and comparing
</p>
<p>their perfomance using <code><a href="#topic+extraF">extraF</a></code>. Note that model 20 is identical to model 32.
</p>
<p>If model 12 provides superior performance (variable values of  M) then 16 models that estimate M
</p>
<p>are run
</p>
<p>(models 1 through 16), otherwise the models with fixed M are fitted (models 21 through 36).
</p>
<p>Fitting these <code><a href="nlme.html#topic+nlsList">nlsList</a></code> models can be time-consuming (2-4 hours using the dataset
</p>
<p><code><a href="#topic+posneg.data">posneg.data</a></code> that encompasses 100 individuals) and if several of the relevant
</p>
<p>models are already fitted the option existing=TRUE can be used to avoid refitting models that
</p>
<p>already exist globally (note that a model object in which no grouping levels were successfully
</p>
<p>parameterized will be refitted, as will objects that are not of class nlsList).
</p>
<p>Specifying forcemod=3 will force model selection to only consider fixed M models and setting
</p>
<p>forcemod=4 will force model selection to consider models with varying values of M only.
</p>
<p>If fitting both models
</p>
<p>12 and 20 fails, fixed M models will be used by default.
</p>
<p>taper.ends can be used to speed up optimization as it extends the dataset at maximum and minimum extremes 
</p>
<p>of x by repeatedly pasting the y values at these extremes for a specified proportion of the range of x. 
</p>
<p>taper.ends is a numeric value representing the proportion of the range of x values are extended for and 
</p>
<p>defaults to 0.45 (45
</p>
<p>tend towards a zero slope this is a suitable values. If tapered ends are not desirable then choose taper.ends = 0.
</p>
<p>Models are ranked by modified pooled residual square error. By default residual standard error
</p>
<p>is divided by the square root of sample size. This exponentially penalizes models for which very few
</p>
<p>grouping levels (individuals) are successfully parameterized (the few individuals that are
</p>
<p>parameterized in these models are fit unsuprisingly well) using a function based on the relationship
</p>
<p>between standard error and sample size. However, different users may have different preferences
</p>
<p>and these can be specified in the argument penaliz (which residual
</p>
<p>standard error is multiplied by). This argument must be a character value
</p>
<p>that contains the character n (sample size) and must be a valid right hand side (RHS) of a formula:
</p>
<p>e.g. 1*(n), (n)^2. It cannot contain more than one n but could be a custom function, e.g. FUN(n).</p>


<h3>Value</h3>

<p>A list object with two components: $'Model rank table' contains the
</p>
<p>statistics from <code><a href="#topic+extraF">extraF</a></code> ranked by the  modified residual standard error,
</p>
<p>and $'P values from pairwise extraF comparison' is a matrix of P values from
</p>
<p><code><a href="#topic+extraF">extraF</a></code> for legitimate comparisons (nested and successfully fitted models).
</p>
<p>The naming convention for models is a concatenation of 'richardsR', the modno and '.lis'
</p>
<p>which is shortened in the matrix output, where the number of parameters has been
</p>
<p>pasted in parentheses to allow users to easily distinguish the more general model from
</p>
<p>the more reduced model
</p>
<p>(see <code><a href="#topic+extraF">extraF</a></code> and <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>).
</p>
<p>For extra flexibility, mod.subset can specify a vector of modno values (a number of different models) that 
</p>
<p>can be fitted in <code><a href="nlme.html#topic+nlsList">nlsList</a></code> and then evaluated by model selection. This prevents fitting of unwanted models or
</p>
<p>attempts to fit models that are known to fail. If the <code><a href="nlme.html#topic+nlsList">nlsList</a></code> model already exists it will not be refitted 
</p>
<p>and thus existing models can be included in the ranking table without adding noticeably to processing time.
</p>


<h3>Note</h3>

<p>If appropriate bounds (or starting parameters) are not available in the list specified by the variable supplied 
</p>
<p>to <code>pn.options</code>, <code><a href="#topic+modpar">modpar</a></code> will be called automatically prior to model selection. 
</p>
<p>During selection, text is output to the screen to inform the user of the progress of model selection
</p>
<p>(which model is being fitted, which were fit successfully)
</p>
<p>Version 1.5 saves many variables, and internal variables in the package environment:
</p>
<p>FlexParamCurve:::FPCEnv. By default, the pn.options file is copied to the environment
</p>
<p>specified by the functions (global environment by default). Model selection routines
</p>
<p>also copy from FPCenv to the global environment all nlsList models fitted during 
</p>
<p>model selection to provide backcompatibility with code for earlier versions. The user
</p>
<p>can redirect the directory to copy to by altering the Envir argument when calling the 
</p>
<p>function.
</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+extraF">extraF</a></code>
</p>
<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
</p>
<p><code><a href="nlme.html#topic+nlsList">nlsList</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>




#these examples will take a long while to run as they have to complete the 32 model comparison


#run model selection for posneg.data object (only first 3 group levels for example's sake)


   try(rm(myoptions),silent = TRUE)


   subdata &lt;- subset(posneg.data, as.numeric(row.names (posneg.data) ) &lt; 40)


   modseltable &lt;- pn.mod.compare(subdata$age, subdata$mass,


      subdata$id, existing = FALSE, pn.options = "myoptions")


   modseltable


   


#fit nlsList model initially and then run model selection


#for posneg.data object when at least one model is already fit


#(only first 3 group levels for example's sake)


    richardsR22.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, K = K,


      Infl = Infl, RAsym = RAsym, Rk = Rk, Ri = Ri , modno = 22, pn.options = "myoptions")


                        ,data = subdata)


   modseltable &lt;- pn.mod.compare(subdata$age, subdata$mass,


      subdata$id, forcemod = 3, existing = TRUE, pn.options = "myoptions")


   modseltable





#run model selection ranked by residual standard error*(1/sample size)


    modseltable &lt;- pn.mod.compare(subdata$age, subdata$mass,


      subdata$id, penaliz='1*(1/n)', existing = TRUE, pn.options = "myoptions")


    modseltable


    


</code></pre>

<hr>
<h2 id='pn.modselect.step'>Backwards Stepwise Selection of Positive-Negative Richards <code class="reqn">nlslist</code> Models</h2><span id='topic+pn.modselect.step'></span>

<h3>Description</h3>

<p>This function performs backawards stepwise model selection for <code><a href="nlme.html#topic+nlsList">nlsList</a></code>
</p>
<p>models fitted using
</p>
<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>

pn.modselect.step(x,


y,


grp,


pn.options,


forcemod = 0,


existing = FALSE,


penaliz = "1/sqrt(n)",


taper.ends = 0.45,


Envir = .GlobalEnv,


...)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pn.modselect.step_+3A_x">x</code></td>
<td>
<p>a numeric vector of the primary predictor</p>
</td></tr>
<tr><td><code id="pn.modselect.step_+3A_y">y</code></td>
<td>
<p>a numeric vector of the response variable</p>
</td></tr>
<tr><td><code id="pn.modselect.step_+3A_grp">grp</code></td>
<td>
<p>a factor of same length as x and y that distinguishes groups within
</p>
<p>the dataset</p>
</td></tr>
<tr><td><code id="pn.modselect.step_+3A_pn.options">pn.options</code></td>
<td>
<p>required character string specifying name of 
</p>
<p><code><a href="base.html#topic+list">list</a></code> object populated with starting 
</p>
<p>parameter estimates, fitting options and bounds</p>
</td></tr>
<tr><td><code id="pn.modselect.step_+3A_forcemod">forcemod</code></td>
<td>
<p>optional numeric value to constrain model selection (see Details)</p>
</td></tr>
<tr><td><code id="pn.modselect.step_+3A_existing">existing</code></td>
<td>
<p>optional logical value specifying whether some of the relevant models
</p>
<p>have already been fitted</p>
</td></tr>
<tr><td><code id="pn.modselect.step_+3A_penaliz">penaliz</code></td>
<td>
<p>optional character value to determine how models are ranked (see Details)</p>
</td></tr>
<tr><td><code id="pn.modselect.step_+3A_taper.ends">taper.ends</code></td>
<td>
<p>numeric representing the proportion of the range of the x variable for which data are extended at 
</p>
<p>the two ends of the data set. This is used in initial estimation (prior to optim and nls optimizations) and can 
</p>
<p>speed up subsequent optimizations by imposing a more pronounced S-shape to both first and second curves. Defaults to 0.45.</p>
</td></tr>
<tr><td><code id="pn.modselect.step_+3A_envir">Envir</code></td>
<td>
<p>a valid R environment to find pn.options in and export any output to, by default this is the global
</p>
<p>environment</p>
</td></tr> 
<tr><td><code id="pn.modselect.step_+3A_...">...</code></td>
<td>
<p>additional optional arguments to be passed to nlsList</p>
</td></tr>
</table>


<h3>Details</h3>

<p> First, whether parameter M should be fixed
</p>
<p>(see <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>) is determined by fitting models 12 and 32 and comparing
</p>
<p>their perfomance using <code><a href="#topic+extraF">extraF</a></code>.
</p>
<p>If model 12 provides superior performance (variable values of M) then 16 models that estimate M
</p>
<p>are run (models 1 through 16), otherwise the models with fixed M are fitted (models 21 through 36).
</p>
<p>Model selection then proceeds by fitting the most general model (8-parameter, model 1 for variable M;
</p>
<p>7-parameter, model 21 for fixed M). At each subsequent step reduced models are evaluated
</p>
<p>by creating <code><a href="nlme.html#topic+nlsList">nlsList</a></code> models through removal of a single parameter from the decreasing
</p>
<p>section of the curve (i.e. RAsym, Rk, Ri or RM). This is repeated until all possible models with
</p>
<p>one less parameter have been fitted and then these models are then ranked by modified pooled residual
</p>
<p>standard error (see below) to determine which reduced parameter model provides the best fit. This ranking
</p>
<p>esnures that in all cases subsequent extra sum-of-squares F-tests are only made between fully nested models. 
</p>
<p>The best ranked reduced parameter model is then compared with the more general model retained from the
</p>
<p>the previous step using the function <code><a href="#topic+extraF">extraF</a></code> to determine whether the more general
</p>
<p>model provides significant improvement over the best reduced model. The most appropriate model
</p>
<p>is then retained to be used as the general model in the next step. This process continues
</p>
<p>for up to six steps (all steps will be attempted even if the general model provides better
</p>
<p>performance to allow for much more reduced models to also be evaluated). The most reduced model
</p>
<p>possible to evaluate in this function contains only parameters for the positive section of the curve
</p>
<p>(4-parameters for variable M, 3-parameters for fixed M).
</p>
<p>Fitting these <code><a href="nlme.html#topic+nlsList">nlsList</a></code> models can be time-consuming (2-4 hours using the dataset
</p>
<p><code><a href="#topic+posneg.data">posneg.data</a></code> that encompasses 100 individuals) and if several of the relevant
</p>
<p>models are already fitted the option existing=TRUE can be used to avoid refitting models that
</p>
<p>already exist globally (note that a model object in which no grouping levels were successfully
</p>
<p>parameterized will be refitted, as will objects that are not of class <code><a href="nlme.html#topic+nlsList">nlsList</a></code>).
</p>
<p>Specifying forcemod=3 will force model selection to only consider fixed M models and setting
</p>
<p>forcemod=4 will force model selection to consider models with varying values of M only.
</p>
<p>If fitting both models 12 and 32 fails, fixed M models will be used by default.
</p>
<p>taper.ends can be used to speed up optimization as it extends the dataset at maximum and minimum extremes 
</p>
<p>of x by repeatedly pasting the y values at these extremes for a specified proportion of the range of x. 
</p>
<p>taper.ends is a numeric value representing the proportion of the range of x values are extended for and 
</p>
<p>defaults to 0.45 (45
</p>
<p>tend towards a zero slope this is a suitable values. If tapered ends are not desirable then choose taper.ends = 0.
</p>
<p>Competing non-nested models are ranked by modified pooled residual square error. By default this is residual 
</p>
<p>standard error divided by the square root of sample size. This exponentially penalizes models for which very few
</p>
<p>grouping levels (individuals) are successfully parameterized (the few individuals that are
</p>
<p>parameterized in these models are fit unsuprisingly well) using a function based on the relationship
</p>
<p>between standard error and sample size. However, different users may have different preferences
</p>
<p>and these can be specified in the argument penaliz (which residual
</p>
<p>standard error is multiplied by). This argument must be a character value
</p>
<p>that contains the character n (sample size) and must be a valid right hand side (RHS) of a formula:
</p>
<p>e.g. 1*(n), (n)^2. It cannot contain more than one n but could be a custom function, e.g. FUN(n).</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing statistics produced by <code><a href="#topic+extraF">extraF</a></code>
</p>
<p>evaluations at each step, detailing the name of the general and best reduced model at each
</p>
<p>step. The overall best model evaluated by the end of the function is saved globally as
</p>
<p><code class="reqn">pn.bestmodel.lis</code>
</p>
<p>The naming convention for models is a concatenation of 'richardsR', the modno and '.lis'
</p>
<p>(see <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>).</p>


<h3>Note</h3>

<p>If appropriate bounds (or starting parameters) are not available in the list specified by the variable supplied 
</p>
<p>to <code>pn.options</code>, <code><a href="#topic+modpar">modpar</a></code> will be called automatically prior to model selection. 
</p>
<p>During selection, text is output to the screen to inform the user of the progress of model selection
</p>
<p>(which model is being fitted)
</p>
<p>Version 1.5 saves many variables, and internal variables in the package environment:
</p>
<p>FlexParamCurve:::FPCEnv. By default, the pn.options file is copied to the environment
</p>
<p>specified by the functions (global environment by default). Model selection routines
</p>
<p>also copy from FPCenv to the global environment all nlsList models fitted during 
</p>
<p>model selection to provide backcompatibility with code for earlier versions. The user
</p>
<p>can redirect the directory to copy to by altering the Envir argument when calling the 
</p>
<p>function.
</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+pn.mod.compare">pn.mod.compare</a></code>
</p>
<p><code><a href="#topic+extraF">extraF</a></code>
</p>
<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
</p>
<p><code><a href="nlme.html#topic+nlsList">nlsList</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>




#these examples will take a long while to run as they have to complete the 32 model comparison


#run model selection for posneg.data object (only first 3 group levels for example's sake)


   try( rm(myoptions), silent = TRUE)


   subdata &lt;- subset(posneg.data, as.numeric(row.names (posneg.data) ) &lt; 40)


   modseltable &lt;- pn.modselect.step(subdata$age, subdata$mass,


      subdata$id, existing = FALSE, pn.options = "myoptions")


   modseltable





#fit nlsList model initially and then run model selection


#for posneg.data object when at least one model is already fit


#(only first 3 group levels for example's sake)


    richardsR22.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, K = K,


      Infl = Infl, RAsym = RAsym, Rk = Rk, Ri = Ri , modno = 22, pn.options = "myoptions")


                        ,data = subdata)


   modseltable &lt;- pn.modselect.step(subdata$age, subdata$mass,


      subdata$id, forcemod = 3, existing = TRUE, pn.options = "myoptions")


   modseltable





#run model selection ranked by residual standard error*sample size


#(only first 3 group levels for example's sake)


    modseltable &lt;- pn.modselect.step(subdata$age, subdata$mass,


      subdata$id, penaliz='1*(n)', existing = TRUE, pn.options = "myoptions")


    modseltable


    


</code></pre>

<hr>
<h2 id='posneg.data'>Simulated growth of black-browed albatrosses</h2><span id='topic+posneg.data'></span>

<h3>Description</h3>

<p>The <code>posneg.data</code> data frame has 1300 rows and 3 columns of records of
the simulated masses for black-browed albatross chicks between 0 and 166 
days of age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posneg.data</code></pre>


<h3>Format</h3>

<p>This object of class <code>c("nfnGroupedData", "nfGroupedData",
    "groupedData", "data.frame")</code> containing the following columns:
</p>

<dl>
<dt>mass</dt><dd>
<p>a numeric vector of chick masses (g).
</p>
</dd>
<dt>age</dt><dd>
<p>a numeric vector of chick ages (days).
</p>
</dd>
<dt>id</dt><dd>
<p>an ordered factor indicating unique id of each simulated individual,
i.e. which data belongs to which individual.
</p>
</dd>
</dl>



<h3>Details</h3>

   
<p>No published parameter estimates with associated variability are available for
positive-negative growth curves. These data were simulated using
an 8-parameter positive-negative Richards curve (<code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
(model 1)), using parameters drawn from normal distributions with the following
means (standard deviations):
</p>
<pre>
  Asym=4300 (180)
  K=0.06 (0.01)
  Infl=23 (0.4)
  M=0.1 (0.05)
  RAsym=1433.3 (540) #1/3 of Asym, more variable
  Rk=0.108 (0.03) #1.8 times faster recession, more variable
  Ri=Infl+87.259 (1.7) # more variable but linked to Infl
  RM=M (0.15) #more variable</pre>
<p>These values were chosen through comparison of growth curves with Huin and Prince (2000) Fig 2
and variability observed between individual chicks of little penguins in a 10 year dataset
(Chiaradia and Nisbet unpublished data). Each simulated individual had 13 measurements
stratified through the development period, with 1-13 day random differences in timing 
of each measurement.
This data object has methods for <code><a href="nlme.html#topic+nlme">nlme</a></code> grouped-data classes. 
</p>


<h3>Source</h3>

<p>Huin, N. &amp; Prince, P.A. (2000) 
Chick growth in albatrosses: curve fitting with a twist. 
Journal of Avian Biology, 31, 418-425.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
#view data
posneg.data
#create list for fixed parameters
modpar(posneg.data$age, posneg.data$mass, pn.options = "myoptions")
plot(mass ~ age, data = posneg.data, subset = id == "1",
     xlab = "Chick age (day)", las = 1,
     ylab = "Chick mass (g)",
     main = "posneg.data data and fitted curve (Chick #1 only)")
fm1 &lt;- nls(mass ~ SSposnegRichards(age,Asym=Asym,K=K,Infl=Infl, RAsym=RAsym,
           Rk=Rk,Ri=Ri,modno=22, pn.options= "myoptions"),
           data = posneg.data, subset = id == "1")
age &lt;- seq(0, 166, length.out = 101)
lines(age, predict(fm1, list(age = age)))
</code></pre>

<hr>
<h2 id='posnegRichards.calls'>List of calls for fitting 33 SSposnegRichards models in <code><a href="nlme.html#topic+nlsList">nlsList</a></code></h2><span id='topic+posnegRichards.calls'></span>

<h3>Description</h3>

<p>The <code>posnegRichards.calls</code> list has two components of 17 and 16 rows and 1 column, 
respectively, called 'Examples of calls for FlexParamCurve models that estimate parameter m'
(models with 4 estimable first curve parameters) and &quot;Examples of calls for FlexParamCurve models
that fix parameter m&quot; (models with 3 estimable second curve parameters, i.e. M is fixed
to value in <code class="reqn">pnmodelparams</code>. Individual calls can be accessed by indexing first the component
number and then the model number - see examples below.
Note that model 17 is formulated differently (see <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posnegRichards.calls</code></pre>


<h3>Format</h3>

<p>This object of class <code><a href="base.html#topic+list">list</a></code> containing the components:
</p>

<dl>
<dt>Examples of calls for FlexParamCurve models that estimate parameter m</dt><dd>
<p>a list of 16 possible reductions (nos. 1-16) of the FlexParamCurve double-Richards model 
that estimate parameter m. Also includes a custom model (17; see <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>).
</p>
</dd>
<dt>Examples of calls for FlexParamCurve models that fix parameter m</dt><dd>
<p>a list of 16 possible reductions (nos. 21-36) of the FlexParamCurve double-Richards model 
that do not estimate parameter m but instead fix it to a mean across the dataset 
or user-specified value.
</p>
</dd>    
</dl>



<h3>Details</h3>

   
<p>A list object to provide users with examples of how to fit 33 different <code><a href="nlme.html#topic+nlsList">nlsList</a></code>
models using the selfStart function <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see all possible calls
posnegRichards.calls
# extract the call for fitting a nls model with 8-parameter double-Richards curve (model 1)
#for an example just fit a subset of the data, 3 group levels (individuals)
   data &lt;- subset(posneg.data, as.numeric(row.names (posneg.data) ) &lt; 40)
modtofit &lt;- as.character( 
               posnegRichards.calls [[2]] [row.names(posnegRichards.calls [[2]]) == "22",] )
#change the data source
modtofit &lt;- sub("posneg.data","data",modtofit)
modtofit &lt;- parse(text = modtofit)
#create list for fixed parameters
modpar(posneg.data$age, posneg.data$mass, pn.options = "myoptions")
#create a new nlsList object called richards22.lis
eval(modtofit)
#view object
richardsR22.lis

# view call for model 1
posnegRichards.calls [[1]] [row.names(posnegRichards.calls [[1]]) == "1",]

# view call for model 21
posnegRichards.calls [[2]] [row.names(posnegRichards.calls [[2]]) == "21",]
</code></pre>

<hr>
<h2 id='posnegRichards.eqn'>Equations of the FlexParamCurve Family</h2><span id='topic+posnegRichards.eqn'></span>

<h3>Description</h3>

<p>Function to solve any of the equations in the FlexParamCurve family,
</p>
<p>depending on user-specified parameters and model choice</p>


<h3>Usage</h3>

<pre><code class='language-R'>

posnegRichards.eqn(x,


Asym = NA,


K = NA,


Infl = NA,


M = NA,


RAsym = NA,


Rk = NA,


Ri = NA,


RM = NA,


modno,


pn.options,


Envir = .GlobalEnv)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posnegRichards.eqn_+3A_x">x</code></td>
<td>
<p>a numeric vector of the primary predictor variable</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_asym">Asym</code></td>
<td>
<p>a numeric value for the asymptote of the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_k">K</code></td>
<td>
<p>a numeric value for the rate parameter of the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_infl">Infl</code></td>
<td>
<p>a numeric value for the point of inflection of the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_m">M</code></td>
<td>
<p>a numeric value for the shape parameter of the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_rasym">RAsym</code></td>
<td>
<p>a numeric value for the asymptote of the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_rk">Rk</code></td>
<td>
<p>a numeric value for the rate parameter of the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_ri">Ri</code></td>
<td>
<p>a numeric value for the point of inflection of the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_rm">RM</code></td>
<td>
<p>a numeric value for the shape parameter of the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_modno">modno</code></td>
<td>
<p>a numeric value (currently integer only) between 1 and 36 specifying the identification
</p>
<p>number of the equation to be fitted</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_pn.options">pn.options</code></td>
<td>
<p>a character vector specifying a list of parameters and options for plotting</p>
</td></tr>
<tr><td><code id="posnegRichards.eqn_+3A_envir">Envir</code></td>
<td>
<p>a valid R environment to find pn.options, by default this is the global environment</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits 1 of 32 possible FlexParamCurve equations (plus custon model #17). Equations 
</p>
<p>can fit both monotonic and non-monotonic curves (two different trajectories).
</p>
<p>These equations have also been described as double-Richards curves, or positive-negative Richards curves.
</p>
<p>From version 1.2 onwards this function can fit curves that exhibit negative followed by positive
</p>
<p>trajectories or double-positive or double-negative trajectories. This function can now also fit two 
</p>
<p>component (biphasic) models, where the first curve is used up to the x-value (e.g. age) of intersection and the 
</p>
<p>second curve is used afterwards, thus the curves are not joined as in standard models (see <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
</p>
<p>for details.
</p>
<p>The 32 possible equations are all based on the subtraction of one Richards curve from another, producing:
</p>
<p><code class="reqn">y = A / ([1+ m exp(-k (t-i))]1/m) - A' / ([1+ m' exp(-k' (t-i' ))]1/m' )</code>, where A=Asym, k=K, i=Infl, m=M,
</p>
<p>A'=RAsym, k'=Rk, i'=Ri, m'=RM; as described in the Arguments section above.
</p>
<p>All 32 possible equations are simply reformulations of this equation, in each case fixing a parameter or
</p>
<p>multiple parameters to (by default) the mean parameter across all individuals in the dataset (such as produced by a <code><a href="stats.html#topic+nls">nls</a></code>
</p>
<p>model). All models are detailed in the <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> help file. Any models that require parameter fixing
</p>
<p>(i.e. all except model #1) extract appropriate values from the specified list passed by name to pn.options for the fixed parameters. 
</p>
<p>This object is most easily created by running <code><a href="#topic+modpar">modpar</a></code> and can be adjusted manually or by using 
</p>
<p><code><a href="#topic+change.pnparameters">change.pnparameters</a></code> to user required specification.
</p>
<p>If parameters are omitted in the call but required by the <code class="reqn">modno</code> specified in the call, then they will be automatically extracted
</p>
<p>from the pn.options object supplied, with the appropriate warning. Thus, it is not necessary to list out parameters and modno but is 
</p>
<p>a useful exercise if you are unfamiliar or in doubt of exactly which model is being specified by <code class="reqn">modno</code>, see <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
</p>
<p>for a list. If a parameter is supplied separately with the call then this value will override those stored in for the same parameter in <code class="reqn">modno</code>:
</p>
<p>see examples below.
</p>


<h3>Value</h3>

<p>the solution of the equation specified (by modno), given the user-entered parameters</p>


<h3>Note</h3>

<p>Any models that require parameter fixing (i.e. all except model #1) extract appropriate values from the specified
</p>
<p>list passed to pn.options for the fixed parameters. This object is most easily created by running <code><a href="#topic+modpar">modpar</a></code> 
</p>
<p>and can be adjusted manually or by using <code><a href="#topic+change.pnparameters">change.pnparameters</a></code> to user required specification.
</p>
<p>Version 1.5 saves many variables, and internal variables in the package environment:
</p>
<p>FlexParamCurve:::FPCEnv. By default, the pn.options file is copied to the environment
</p>
<p>specified by the functions (global environment by default). Model selection routines
</p>
<p>also copy from FPCenv to the global environment all nlsList models fitted during 
</p>
<p>model selection to provide backcompatibility with code for earlier versions. The user
</p>
<p>can redirect the directory to copy to by altering the Envir argument when calling the 
</p>
<p>function.
</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code>
</p>
<p><code><a href="#topic+modpar">modpar</a></code>    </p>


<h3>Examples</h3>

<pre><code class='language-R'>

require(graphics)


# calculate y (dependent variable) for a given x for an 8-parameter double-Richards model


         #create pnmodelparams for fixed parameters 


   	 modpar(posneg.data$age, posneg.data$mass, pn.options = "myoptions")


   	 x = 10


   	 y &lt;- posnegRichards.eqn(x, 1000, 0.5, 25, 1, 100, 0.5, 125, 


   	 1, modno = 1, pn.options = "myoptions")


   	 print( c(x = x, y = y) )


   	 


# plot 8-parameter model using saved parameter values from modpar


	 plot(posneg.data$age, posneg.data$mass, pch = ".")


	 curve(posnegRichards.eqn(x,modno = 1, pn.options = "myoptions"), add = TRUE, lwd = 3)


	 


# plot 3-parameter model using saved parameter values from modpar


         curve(posnegRichards.eqn(x,modno = 32, pn.options = "myoptions"), add = TRUE, col =2


               , lwd = 3)


	 


# tweak the plot of a 3-parameter model by user specifying a lower asymptote:


#      ie give some parameter values


# directly and others through pn.options by default


         curve(posnegRichards.eqn(x,modno = 32, Asym = 3200, pn.options = "myoptions"),


               add = TRUE, col = 5, lwd = 3)


	 


# calculate y (dependent variable) for a given x for a 4-parameter Richards model 


# (note that second curve parameters are unneeded) and replaced with value from pn.options.


# User-supplied variables over-ride those stored in pn.options object


	 x = 10


   	 y &lt;- posnegRichards.eqn(x, 1000, 0.5, 25, 1, 


   	 1, modno = 12, pn.options = "myoptions")


   	 print( c(x = x, y = y) )


   	 


# plot a logistic curve (M=1),  note that second curve parameters are unneeded


         plot(1:200, posnegRichards.eqn(1:200, Asym = 1000, K = 0.5, Infl = 25, M = 1, 


   	         modno = 12, pn.options = "myoptions"), xlim = c(1, 200), xlab = "x", 


   		 ylab = "y", pch = 1, cex = 0.7)





# plot a double-logistic curve (M=1, RM=1),  


#note that second curve parameters are unneeded 	     


   	 plot(1:200, posnegRichards.eqn(1:200, Asym = 1000, K = 0.5, Infl = 25, M = 1,


   	      RAsym = -100, Rk = 0.5, Ri = 125, RM = 1,


   	      modno = 1, pn.options = "myoptions"), xlim = c(1, 200), xlab = "x", 


   		 ylab = "y", pch = 1, cex = 0.7)


</code></pre>

<hr>
<h2 id='SSposnegRichards'>Self-Starting Positive-Negative Richards Model (double-Richards)</h2><span id='topic+SSposnegRichards'></span>

<h3>Description</h3>

<p>This selfStart function evaluates a range of flexible logistic
</p>
<p>functions.  It also has an initial attribute that creates
</p>
<p>initial estimates of the parameters
</p>
<p>for the model specified.</p>


<h3>Usage</h3>

<pre><code class='language-R'>
SSposnegRichards(x,

Asym = NA,

K = NA,

Infl = NA,

M = NA,

RAsym = NA,

Rk = NA,

Ri = NA,

RM = NA,

modno,

pn.options,

Envir = ".GlobalEnv")

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SSposnegRichards_+3A_x">x</code></td>
<td>
<p>a numeric vector of the primary predictor
</p>
<p>variable at which to evaluate the model</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_asym">Asym</code></td>
<td>
<p>a numeric value for the asymptote of the
</p>
<p>positive (increasing) curve</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_k">K</code></td>
<td>
<p>a numeric value for the rate parameter of
</p>
<p>the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_infl">Infl</code></td>
<td>
<p>a numeric value for the point of inflection
</p>
<p>of the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_m">M</code></td>
<td>
<p>a numeric value for the shape parameter of
</p>
<p>the positive (increasing) curve</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_rasym">RAsym</code></td>
<td>
<p>a numeric value for  the asymptote of the
</p>
<p>negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_rk">Rk</code></td>
<td>
<p>a numeric value for the rate parameter of
</p>
<p>the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_ri">Ri</code></td>
<td>
<p>a numeric value for the point of inflection
</p>
<p>of the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_rm">RM</code></td>
<td>
<p>a numeric value for the shape parameter of
</p>
<p>the negative (decreasing) curve</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_modno">modno</code></td>
<td>
<p>a numeric value (currently integer only)
</p>
<p>between 1 and 36 specifying the identification
</p>
<p>number of the equation to be fitted</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_pn.options">pn.options</code></td>
<td>
<p>character string specifying name of 
</p>
<p><code><a href="base.html#topic+list">list</a></code> object populated with starting 
</p>
<p>parameter estimates, fitting options and bounds</p>
</td></tr>
<tr><td><code id="SSposnegRichards_+3A_envir">Envir</code></td>
<td>
<p>a character vector that represents the valid R environment in which to 
</p>
<p>find pn.options in and write any output to,
</p>
<p>by default this is the global environment</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This selfStart function evaluates a range of flexible logistic
</p>
<p>functions.  It also has an initial attribute that creates
</p>
<p>initial estimates of the parameters
</p>
<p>for the model specified. Equations can fit both monotonic and non-monotonic 
</p>
<p>curves (two different trajectories). These equations have also been described as
</p>
<p>double-Richards curves, or positive-negative Richards curves. **From version 1.2 
</p>
<p>onwards this function can fit curves that exhibit negative followed by positive
</p>
<p>trajectories or double positive or double negative trajectories.***
</p>
<p>The 32 possible equations (plus custom model #17) are all based on the subtraction of one Richards
</p>
<p>curve from another, producing:
</p>
<p><code class="reqn">y = A / ([1+ m exp(-k (t-i))]1/m) + A' / ([1+ m' exp(-k' (t-i' ))]1/m' )</code>,
</p>
<p>where A=Asym, k=K, i=Infl, m=M,
</p>
<p>A'=RAsym, k'=Rk, i'=Ri, m'=RM; as described in the Arguments section above.
</p>
<p>All 32 possible equations are simply reformulations of this equation, in each
</p>
<p>case fixing a parameter or multiple parameters to (by default) the mean parameter across
</p>
<p>all individuals in the dataset (such as produced by a <code><a href="stats.html#topic+nls">nls</a></code>
</p>
<p>model). Thus, a model in which one parameter is fixed has a 7-parameter equation,
</p>
<p>and one in which four are fixed has a 4-parameter equation, thus reducing 
</p>
<p>complexity and computation and compensatory parameter changes when a parameter does not 
</p>
<p>vary across group levels (e.g individuals)
</p>
<p>[the most appropriate equation can be determined using model selection in
</p>
<p><code><a href="#topic+pn.modselect.step">pn.modselect.step</a></code> or <code><a href="#topic+pn.mod.compare">pn.mod.compare</a></code>].
</p>
<p>Any models that require parameter fixing (i.e. all except #1)
</p>
<p>extract appropriate values from the list object specified by <code>pn.options</code> for the fixed
</p>
<p>parameters. This object is most easily created by running
</p>
<p><code><a href="#topic+modpar">modpar</a></code> and can be adjusted manually or by using
</p>
<p><code><a href="#topic+change.pnparameters">change.pnparameters</a></code> to user-required specification.
</p>
<p>Each of the 32 equations is identified by an integer value for modno (1 to 36).Models
</p>
<p>21-36 are the same as 1-16 except that in the former the first curve parameter <code>m</code>
</p>
<p>is fixed and not estimated. All equations (except 17 - see below) contain parameters Asym, K, and Infl.
</p>
<p>The list below summarizes which of the other 5 parameters are contained in
</p>
<p>which of the models (Y indicates that the parameter is estimated, blank indicates
</p>
<p>it is fixed).
</p>
<pre>

     modno   M   RAsym   Rk   Ri   RM   NOTES

     1       Y     Y     Y    Y    Y    8 parameter model

     2       Y     Y     Y    Y         

     3       Y                Y    Y

     4       Y     Y               Y

     5       Y                     Y

     6       Y     Y          Y    Y

     7       Y           Y    Y    Y

     8       Y     Y     Y         Y

     9       Y           Y         Y

     10      Y                Y

     11      Y     Y

     12      Y			 4 parameter, standard Richards model

     13      Y     Y          Y

     14      Y           Y    Y

     15      Y     Y     Y

     16      Y           Y

     17      see below

     18      see below

     19      see below

     20      see below                           

     21            Y     Y    Y    Y    7 parameter model, 4 recession params

     22            Y     Y    Y		6 parameter (double-logistic/double-Gompertz/double-Von Bertalannfy)

     23                       Y    Y

     24            Y               Y

     25                            Y

     26            Y          Y    Y

     27                  Y    Y    Y

     28            Y     Y         Y

     29                  Y         Y

     30                       Y

     31            Y

     32					only 3 parameters (used for logistic, Gompertz or Von Bertalannfy - see below)

     33            Y          Y

     34                  Y    Y

     35            Y     Y

     36                  Y           </pre>
<p>modno 17 represents a different parameterization for a custom model:
</p>
<p>(Asym/ 1 + exp(Infl - x)/ M) - (RAsym / 1 + exp(Ri - x)/ RM), in
</p>
<p>which M and RM actually represent scale parameters not shape parameters. This model and a suite of reductions:
</p>
<p>modno 17.1:
</p>
<p>modno 17.2:
</p>
<p>modno 17.3:
</p>
<p>are designed for use in modeling migration, <code class="reqn">sensu.</code> Bunnefeld et al. 2011, Singh et al. 2012.
</p>
<p>modnos 18, 19 and 20 are reserved for internal use by <code><a href="#topic+modpar">modpar</a></code>.
</p>
<p>To access common 3 parameter sigmoidal models use modno = 32, fixing
</p>
<p>parameters (using <code><a href="#topic+change.pnparameters">change.pnparameters</a></code>) to M = 1 for logistic,
</p>
<p>M = 0.1 for Gompertz, and M= -0.3 for von Bertalanffy. The same settings can be
</p>
<p>used with modno = 2 to fit the double-logistic, double-Gompertz or double-Von Bertalannfy.
</p>
<p>Note that to fit only 3 or 4 parameter curves, the option force4par = TRUE should be specified
</p>
<p>when running <code><a href="#topic+modpar">modpar</a></code>.
</p>
<p>The call for <code><a href="#topic+SSposnegRichards">SSposnegRichards</a></code> only differs from
</p>
<p>conventional selfStart models in that it requires a value for modno and a list of fitting options
</p>
<p>and values from <code><a href="#topic+modpar">modpar</a></code> to which to fix parameters in the reduced models. 
</p>
<p>Depending on the model chosen, different combinations of the 8 possible
</p>
<p>parameters are required: if one is missing the routine will stop with an
</p>
<p>appropriate error, if an extra one is added, it will be ignored (provided
</p>
<p>that it is labelled, e.g. M = 1; this is good practice to prevent accidental
</p>
<p>misassignments). 
</p>
<p>Here are two examples (7 parameter and 3 parameter):
</p>
<pre>richardsR2.lis &lt;- nlsList(mass ~ SSposnegRichards(age,

         Asym = Asym, K = K, Infl = Infl, M = M, RAsym = RAsym, Rk = Rk, Ri = Ri,

         , modno = 2), data = posneg.data)

         #correct call includes all necessary parameters</pre>
<pre>richardsR20.lis &lt;- nlsList(mass ~ SSposnegRichards(age,

         Asym = Asym, K = K, Infl = Infl, modno = 2), data = logist.data)

         #incorrect call missing required parameters, 

         #function terminates and generates an error message

         </pre>
<p>Examples for all models can be found in the list object
</p>
<p><code><a href="#topic+posnegRichards.calls">posnegRichards.calls</a></code>.
</p>
<p>If specified using <code><a href="#topic+modpar">modpar</a></code> optional constraints
</p>
<p>may be placed to specify response values at the minimum value and/or
</p>
<p>maximum values of the predictor. Such constraint allows realistic fits for
</p>
<p>datasets which are missing data
</p>
<p>at either end of the curve (e.g. hatching weight for some growth curves).
</p>
<p>Estimates are produced by splitting the two curves into separate positive
</p>
<p>and negative curves and estimating parameters for each curve separately
</p>
<p>in a similar manner to <code><a href="stats.html#topic+SSlogis">SSlogis</a></code>. Each curve is fit first by
</p>
<p><code><a href="stats.html#topic+optim">optim</a></code> using the parameter bounds in <code>pnmodelparamsbounds</code>
</p>
<p>(see <code><a href="#topic+modpar">modpar</a></code>) and a subsequent refinement is attempted using
</p>
<p><code><a href="stats.html#topic+nls">nls</a></code> with more restrictive parameter bounds. Finally, both curves
</p>
<p>are annealed
</p>
<p>and parameters are again estimated using restrictive bounds and starting values
</p>
<p>already determined during separate estimates. Equations for which the positive
</p>
<p>curve was inestimable are not estimated further, but if negative curve estimation
</p>
<p>or overall curve estimation fail, partial estimates are used: either default
</p>
<p>negative parameters (RAsym = 0.05*Asym, Rk = K, Ri = Infl, RM = M) annealed to positive
</p>
<p>curves or separate estimates annealed; both with compensation for interation
</p>
<p>between asymptotes.
</p>
<p>From version 1.2 onwards, this function can now fit two component models, where
</p>
<p>the first curve is used up to the x-value (e.g. age) of intersection and the second curve is used
</p>
<p>afterwards. Confusingly, these are also called &quot;double Richards&quot;, &quot;double Gompertz&quot;
</p>
<p>or &quot;double logistic&quot;: see Murphy et al. (2009) or Ross et al. (1995) for examples.
</p>
<p>To specify such models set twocomponent.x = TRUE (this will estimate the x of 
</p>
<p>intersection) when running <code><a href="#topic+modpar">modpar</a></code>. Alternatively, if known, the 
</p>
<p>x of intersection can be set directly by setting
</p>
<p>twocomponent.x = # (where # is the x of intersection). When <code><a href="#topic+modpar">modpar</a></code>
</p>
<p>is run this option will be saved in <code>pnmodelparas</code> and can be changed at will,
</p>
<p>either manually or using <code><a href="#topic+change.pnparameters">change.pnparameters</a></code>.
</p>
<p>From version 1.2 onwards, this function can now fit bilogistic (and more generally
</p>
<p>biRichards) curves, where the final curve is effectively either two positive curves
</p>
<p>or two negative curves. See Meyer (1994) for examples. This functionality is default 
</p>
<p>and does not need to be specified. 
</p>


<h3>Value</h3>

<p>a numeric vector of the same length as x containing parameter
</p>
<p>estimates for equation specified (fixed parameters
</p>
<p>are not return but are substituted in calls to <code><a href="stats.html#topic+nls">nls</a></code>
</p>
<p><code><a href="nlme.html#topic+nlsList">nlsList</a></code> and <code><a href="nlme.html#topic+nlme">nlme</a></code> with the fixed parameters
</p>
<p>stored in <code>pnmodelparams</code>; see <code><a href="#topic+modpar">modpar</a></code></p>


<h3>Note</h3>

<p>Any models that require parameter fixing (i.e. all except #1)
</p>
<p>extract appropriate values from the object <code>pnmodelparams</code> for the fixed
</p>
<p>parameters. This object is created by running
</p>
<p><code><a href="#topic+modpar">modpar</a></code> and can be adjusted manually or by using
</p>
<p><code><a href="#topic+change.pnparameters">change.pnparameters</a></code> to user required specification.
</p>
<p>Output may show errors and warnings especially during a <code><a href="nlme.html#topic+nlsList">nlsList</a></code>
</p>
<p>fit, in which the function is called repeatedly: once for each group level in the
</p>
<p>dataset. Warnings indicate conditions for which default parameters or incomplete estimates
</p>
<p>are used - see Details section - and errors occur from insufficient data or singularities.
</p>
<p>As a result of possible interaction and correlation between the parameters in some models,
</p>
<p>singularities may be common, but do not be alarmed by repeated error messages, as
</p>
<p>examination of a fitted <code><a href="nlme.html#topic+nlsList">nlsList</a></code> model may releave a large number of
</p>
<p>well estimated group levels, thus the elimation of unsuitable outlying groups only. Also,
</p>
<p>because very few of the 32 equations are likely to be suitable for the majority
</p>
<p>of datasets, consideration of the model being fitted is crucial when examining the output. Functions
</p>
<p><code><a href="#topic+pn.modselect.step">pn.modselect.step</a></code> and <code><a href="#topic+pn.mod.compare">pn.mod.compare</a></code> provide the ability
</p>
<p>for model selection of these equations through stepwise backward deletion or all
</p>
<p>model comparison, respectively. These offer powerful ways to determine the
</p>
<p>best equation for your dataset.
</p>
<p>To increase the ability of optimization routines to deal with
</p>
<p>a wide variety of values, particularly negative values for M or RM,
</p>
<p>only real component of complex numbers are modelled and integer versions
</p>
<p>of M and RM are used during estimation if floating values cause conversion
</p>
<p>issues.
</p>
<p>Speed of the function depends on the complexity of the data being fit.
</p>
<p>Version 1.5 saves many variables, and internal variables in the package environment:
</p>
<p>FlexParamCurve:::FPCEnv. By default, the pn.options file is copied to the environment
</p>
<p>specified by the functions (global environment by default). Model selection routines
</p>
<p>also copy from FPCenv to the global environment all nlsList models fitted during 
</p>
<p>model selection to provide backcompatibility with code for earlier versions. The user
</p>
<p>can redirect the directory to copy to by altering the Envir argument when calling the 
</p>
<p>function.
</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>References</h3>

<p>## Oswald, S.A. et al. (2012) FlexParamCurve: R package for flexible
</p>
<p>fitting of nonlinear parametric curves. Methods in Ecology and Evolution 3: 1073-1077.
</p>
<pre>

     doi: 10.1111/j.2041-210X.2012.00231.x 

     (see also tutorial and introductory videos at:

     http://www.methodsinecologyandevolution.org/view/0/podcasts.html

     (posted September 2012 - if no longer at this link, check the archived videos at:

     http://www.methodsinecologyandevolution.org/view/0/VideoPodcastArchive.html#allcontent

               </pre>
<p>#1# Nelder, J.A. (1962) Note: an alternative form of a generalized
</p>
<p>logistic equation. Biometrics, 18, 614-616.
</p>
<p>#2#
</p>
<p>Huin, N. &amp; Prince, P.A. (2000) Chick growth in albatrosses: curve fitting
</p>
<p>with a twist. Journal of Avian Biology, 31, 418-425.
</p>
<p>#3#
</p>
<p>Meyer, P. (1994) Bi-logistic growth. Technological Forecasting and Social 
</p>
<p>Change. 47: 89-102
</p>
<p>#4#
</p>
<p>Murphy, S. et al. (2009) Importance of biological parameters in assessing 
</p>
<p>the status of <code>Delphinus delphis</code>. Marine Ecology Progress Series 388: 273-291.
</p>
<p>#5#
</p>
<p>Pinheiro, J. &amp; Bates, D. (2000) <code>Mixed-Effects Models in S and S-Plus.</code>
</p>
<p>Springer Verlag, Berlin.
</p>
<p>#6#
</p>
<p>Ross, J.L. et al. (1994) Age, growth, mortality, and reproductive biology
</p>
<p>of red drums in North Carolina waters. Transactions of the American Fisheries
</p>
<p>Society 124: 37-54.
</p>
<p>#7#
</p>
<p>Bunnefeld et al. (2011) A model-driven approach to quantify migration patterns:
</p>
<p>individual, regional and yearly differences. Journal of Animal Ecology 80: 466-476.
</p>
<p>#8#
</p>
<p>Singh et al. (2012) From migration to nomadism: movement variability in a northern
</p>
<p>ungulate across its latitudinal range. Ecological Applications 22: 2007-2020.</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+SSlogis">SSlogis</a></code>
</p>
<p><code><a href="stats.html#topic+SSgompertz">SSgompertz</a></code>
</p>
<p><code><a href="#topic+posnegRichards.eqn">posnegRichards.eqn</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
 set.seed(3) #for compatability issues

 require(graphics)

    # retrieve mean estimates of 8 parameters using getInitial

    # and posneg.data object

    modpar(posneg.data$age, posneg.data$mass,verbose=TRUE, pn.options = "myoptions", width.bounds=2)

    getInitial(mass ~ SSposnegRichards(age, Asym, K, Infl, M, 

        RAsym, Rk, Ri, RM, modno = 1, pn.options = "myoptions"), data = posneg.data)



    # retrieve mean estimates and produce plot to illustrate fit for 

    # curve with M, Ri and Rk fixed

    pars &lt;- coef(nls(mass ~ SSposnegRichards(age, 

        Asym = Asym, K = K, Infl = Infl, RAsym = RAsym, 

        	RM = RM, modno = 24, pn.options = "myoptions"), data = posneg.data,

        	control=list(tolerance = 10)))

    plot(posneg.data$age, posneg.data$mass, pch=".")

    curve(posnegRichards.eqn(x, Asym = pars[1], K = pars[2], 

        Infl = pars[3], RAsym = pars[4],  

        RM = pars[5],  modno = 24, pn.options = "myoptions"), xlim = c(0, 

        200), add = TRUE)

    



    

        # following example not run as appropriate data are not available in the package

        # retrieve mean estimates and produce plot to illustrate fit for custom model 17

     ## Not run:  

     pars&lt;-as.numeric( getInitial(mass ~ SSposnegRichards(age, Asym, K, Infl,

           M, RAsym, Rk, Ri, RM, modno = 17, pn.options = "myoptions"), data = datansd) )

     plot(datansd$jday21March, datansd$moosensd)

     curve( posnegRichards.eqn(x, Asym = pars[1], K = 1, Infl = pars[2], 

            M = pars[3], RAsym = pars[4], Rk = 1, Ri = pars[5], RM = pars[6], 

            modno = 17, pn.options = "myoptions"), lty = 3, xlim = c(0, 200) , add = TRUE)
## End(Not run)

        

    # fit nls object using 8 parameter model

    # note: ensure data object is a groupedData object

    
   
        richardsR1.nls &lt;- nls(mass ~ SSposnegRichards(age, Asym = Asym, 

        K = K, Infl = Infl, M = M, RAsym = RAsym, Rk = Rk, Ri = Ri, 

        RM = RM, modno = 1, pn.options = "myoptions"), data = posneg.data)

        



    # following example not run as it fits very few levels in these data - as noted

    # such a comprehensive equation is rarely required

    # fit nlsList object using 8 parameter model

    # note: ensure data object is a groupedData object

    # also note: not many datasets require all 8 parameters

         ## Not run: 

         richardsR1.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, 

        K = K, Infl = Infl, M = M, RAsym = RAsym, Rk = Rk, Ri = Ri, 

        RM = RM, modno = 1, pn.options = "myoptions"), data = posneg.data)

    summary(richardsR1.lis)
## End(Not run)



    # fit nlsList object using 6 parameter model with value M and RM

    # fixed to value in pnmodelparams and then fit nlme model

    # note data is subset to provide estimates for a few individuals

    # as an example
    
     

    subdata &lt;- subset(posneg.data,posneg.data$id == as.character(26)

   		| posneg.data$id == as.character(1) 

   		| posneg.data$id == as.character(32))

    richardsR22.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, 

        K = K, Infl = Infl, RAsym = RAsym, Rk = Rk, Ri = Ri, 

        modno = 22, pn.options = "myoptions"), data = subdata)

    summary(richardsR22.lis )

    richardsR22.nlme &lt;- nlme(richardsR22.lis, random = pdDiag(Asym + Infl ~ 1) )

    summary(richardsR22.nlme)

         

    # fit nls object using simple logistic model, with 

    # M, RAsym, Rk, Ri, and RM fixed to values in pnmodelparams

     
    
    modpar(logist.data$age, logist.data$mass ,force4par = TRUE, pn.options = "myoptions")

    change.pnparameters(M = 1, pn.options = "myoptions") #set to logistic (M =1) prior to fit

    richardsR32.nls &lt;- nls(mass ~ SSposnegRichards(age, Asym = Asym, 

        K = K, Infl = Infl, modno = 32, pn.options = "myoptions"), data = logist.data)

    coef(richardsR32.nls)

                

    # fit a two component model - enter your own data in place of "mydata"

    # this is not run for want of an appropriate dataset

    # if x of intersection unknown

    ## Not run: 

    modpar(mydata$x,mydata$y,twocomponent.x=TRUE, pn.options = "myoptions")

    # if x of intersection = 75

    modpar(mydata$x,mydata$y,twocomponent.x=75, pn.options = "myoptions") 

    richardsR1.nls &lt;- nls(y~ SSposnegRichards(x, Asym = Asym, K = K,

      Infl = Infl, M = M, RAsym = RAsym, Rk = Rk, Ri = Ri, RM = RM, 

      modno = 1, pn.options = "myoptions")

      , data = mydata)

    coef(richardsR1.nls)
## End(Not run)

    </code></pre>

<hr>
<h2 id='tern.data'>Field data on growth of common terns <code class="reqn">Sterna hirundo</code></h2><span id='topic+tern.data'></span>

<h3>Description</h3>

<p>The <code>tern.data</code> data frame has 1164 rows and 12 columns of records of
the measured masses for common tern chicks between 1 and 30 
days of age collected at at Grays Beach, MA, in 1973 (Nisbet 1975) and
Monomoy, MA, in 1975 (Nisbet et al. 1978)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tern.data</code></pre>


<h3>Format</h3>

<p>This object of class <code>c("nfnGroupedData", "nfGroupedData",
    "groupedData", "data.frame")</code> containing the following columns:
</p>

<dl>
<dt>site</dt><dd>
<p>Four character factor for the two sites (MYMA: Monomoy Island, MA; GBCT: Grays Beach, CT).
</p>
</dd>
<dt>year</dt><dd>
<p>A factor specifying the year of measurement: 1973 or 1976.
</p>
</dd>
<dt>bandid</dt><dd>
<p>an ordered factor indicating unique id of each individual: the union of
the laying date of the nest relative to the colony and the band combination
</p>
</dd>
<dt>siteyear</dt><dd>
<p>A factor specifying levels of year for different sites (different years at each site).
</p>
</dd>
<dt>weight</dt><dd>
<p>a numeric vector of chick masses (g).
</p>
</dd>
<dt>ckage</dt><dd>
<p>a numeric vector of chick ages (days).
</p>
</dd>
<dt>Jdate</dt><dd>
<p>a numeric vector of first egg-laying date of the nest(days), relative to the mean
laying date for all nests in that year.
</p>
</dd>
<dt>nest</dt><dd>
<p>A factor of unique codes that identify each nest.
</p>
</dd>
<dt>ck</dt><dd>
<p>A factor of hatching order for each chick (A = first hatched, B = second hatched
C = third hatched).
</p>
</dd>
<dt>outcome</dt><dd>
<p>A factor of codes for fate of each chick (F = fledged; only fledged chicks included).
</p>
</dd>
<dt>eggmass</dt><dd>
<p>A numeric vector of the mass of the egg (from which the chick hatched) at laying.
</p>
</dd>
<dt>clutch</dt><dd>
<p>A factor of size of clutch/brood that each chick comes from (either 1- or 2-chick brood).
</p>
</dd>
</dl>



<h3>Details</h3>

   
<p>Data were collected as outlined in Nisbet (1975)[Grays Beach, MA, 1973] and
Nisbet et al.(1978) [Monomoy, MA, 1975].
Please contact Ian Nisbet &lt;icnisbet@verizon.net&gt; for use in collaborations.
</p>


<h3>Source</h3>

<p>Nisbet, I.C.T. (1975) Selective effects of predation in a tern colony. Condor, 77, 221-226.
Nisbet, I.C.T., Wilson, K.J. &amp; Broad, W.A. (1978) Common Terns raise young after death
of their mates. Condor, 80, 106-109.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
#view data
tern.data
#create pnmodelparams for fixed parameters
modpar(tern.data$ckage, tern.data$weight, force4par = TRUE, pn.options = "myoptions")
plot(weight ~ ckage, data = tern.data, subset = bandid == tern.data$bandid[1],
     xlab = "Chick age (day)", las = 1,
     ylab = "Chick mass (g)",
     main = "tern.data and fitted curve (Chick #156 only)")
fm1 &lt;- nls(weight ~ SSposnegRichards(ckage,Asym=Asym,K=K,Infl=Infl,modno=32,
           pn.options= "myoptions"),
           data = tern.data, subset = bandid == tern.data$bandid[1])
ckage &lt;- seq(0, 30, length.out = 101)
lines(ckage, predict(fm1, list(ckage = ckage)))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
