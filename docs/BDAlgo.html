<!DOCTYPE html><html><head><title>Help for package BDAlgo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BDAlgo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Abundance'><p>Abundance data sample</p></a></li>
<li><a href='#BDAlgo'><p>The Bloom Detecting Algorithm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bloom Detecting Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-30</td>
</tr>
<tr>
<td>Description:</td>
<td>The Bloom Detecting Algorithm enables the detection of blooms within a time series of species abundance and extracts 22 phenological variables. For details, see Karasiewicz et al. (2022) &lt;<a href="https://doi.org/10.3390%2Fjmse10020174">doi:10.3390/jmse10020174</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>inflection</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-30 09:26:35 UTC; frenc</td>
</tr>
<tr>
<td>Author:</td>
<td>Stephane Karasiewicz
    <a href="https://orcid.org/0000-0003-1652-9921"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stephane Karasiewicz &lt;skaraz.science@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-30 13:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='Abundance'>Abundance data sample</h2><span id='topic+Abundance'></span>

<h3>Description</h3>

<p>The <code>Abundance</code> data are a sample of the entire data set used in Karasiewicz et al.(2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Abundance)
</code></pre>


<h3>Format</h3>

<p>The <code>Abundance</code> is a matrix covering two stations and three species.
</p>


<h3>Source</h3>

<p>Karasiewicz S., and Lefebvre A. (2022). Environmental Impact on Harmful Species Pseudo-nitzschia spp. and Phaeocystis globosa Phenology and Niche. <em>JMSE</em> 10(2), 174. <a href="https://doi.org/10.3390/jmse10020174">doi:10.3390/jmse10020174</a>.
</p>


<h3>References</h3>

<p>Karasiewicz S., and Lefebvre A. (2022). Environmental Impact on Harmful Species Pseudo-nitzschia spp. and Phaeocystis globosa Phenology and Niche. <em>JMSE</em> 10(2), 174. <a href="https://doi.org/10.3390/jmse10020174">doi:10.3390/jmse10020174</a>.
</p>

<hr>
<h2 id='BDAlgo'>The Bloom Detecting Algorithm</h2><span id='topic+BDAlgo'></span>

<h3>Description</h3>

<p>The Bloom Detecting Algorithm enables the detection of  blooms within a time series of species abundance and extracts 22 phenological variables.
See details for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BDAlgo(data, threshold=c(4,4), perc_of_peak=0.85, nbr_days=300, date_col= 2,
station_col=1, Sp = c("Sp1", "Sp2"), min_Log = 2, SP_label = c("Species1", "Species2"),
Log=TRUE, PDF=FALSE, saving_path=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BDAlgo_+3A_data">data</code></td>
<td>
<p>a data frame table containing the species abundance time series with the station and date (dd/mm/yyyy).</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_threshold">threshold</code></td>
<td>
<p>a numeric vector, the abundance threshold from which a detected peak can be considered a bloom.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_perc_of_peak">perc_of_peak</code></td>
<td>
<p>a numeric value between 0 and 1, that creates an upper lower threshold under which the lower point after the peak could be considered the end of the bloom. See the details for more information.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_nbr_days">nbr_days</code></td>
<td>
<p>a numeric value corresponding to the maximum of days length of a bloom.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_date_col">date_col</code></td>
<td>
<p>a numeric value corresponding to the column of the 'date' variable.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_station_col">station_col</code></td>
<td>
<p>a numeric value corresponding to the column of the 'station' variable.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_sp">Sp</code></td>
<td>
<p>a character vector corresponding to the species column in the data to which you wish to apply the function.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_min_log">min_Log</code></td>
<td>
<p>a numeric value that is used as a lower threshold for the abundance of the data. See details for more information.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_sp_label">SP_label</code></td>
<td>
<p>a character vector corresponding to the species label to use for the output graph.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_log">Log</code></td>
<td>
<p>TRUE or FALSE if you want to log(x+1) transform the abundance data.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_pdf">PDF</code></td>
<td>
<p>TRUE or FALSE if you wish to save each graph in a single PDF.</p>
</td></tr>
<tr><td><code id="BDAlgo_+3A_saving_path">saving_path</code></td>
<td>
<p>a character vector used as a directory path to save the output graphs and rda files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data format required is a simple table with samples as rows and species as columns, with date (dd/mm/yyyy) and station in character. The dates are converted into date format in the algorithm.
</p>
<p>The Bloom Detecting Algorithm detects the bloom of a species within a time series of abundance according to three conditions. But first, the algorithm locate the high and low points of the curves. For each high point, the closest
was considered to be a bloom if:
</p>
<p>   1. The high points were above the value of <code>threshold</code> parameter value, which by default is 4, corresponding to the log10 of 10,000 cells/L. The threshold of 10,000 cells/L was used here as the algorithm was created to fit phytoplankton species. See the reference for more information.
</p>
<p>   2. The low points before and after the high points were inferior to the <code>perc_of_peak</code> of 0.85 (85%) of the high point value. In this case, some humps can be merged, as blooms can sometimes be bimodal.
</p>
<p>   3. The merging of two humps would occur when the value of one of the lowest points did not fit the second condition. The merging of two humps cannot occur if the merging causes the increasing or decreasing phase of the bloom to be greater than <code>nbr_days</code>, by default 300 days.
</p>
<p>These three conditions were necessary as they enabled the extraction of the phenological bloom, which in our case corresponded to HABs. The HAB case study helped us define the hump minimum abundance <code>threshold</code> as well as the amplitude <code>nbr_days</code> and shape <code>perc_of_peak</code>.
</p>
<p><code>Log</code> parameter simply transforms the abundance in log(x+1) as it helps with the large variation in the data value. The <code>min_Log</code> parameter (by default, 2 corresponding to 100 cells/L) was the minimum we fixed for our study.
</p>
<p>The output graphs are time series of your species abundance (grey dots) for each station with the fitted smooth spline (grey line) and confidence interval (grey shaded area).
The colored dots correspond to different timing phenological variables, which need to be in the following order for each bloom detected to confirm the validity of the algorithm fit.
Yellow (DBS) &gt; Turquoise (DMF) &gt; Red (DMA) &gt; Purple (DMM) &gt; Pink (DBE)
</p>


<h3>Value</h3>

<p>The BD_Algo function returns:
</p>
<p> 1. a graph per species and per station.
</p>
<p> 2. a list containing the species (Sp) and for each station the following data:
</p>
<p>- <code>smooth_spline</code>: the results of the smooth spline. See <a href="stats.html#topic+smooth.spline">smooth.spline</a> for more information on the return values.
</p>
<p>- <code>conf_intervall</code>:  the data of the confidence intervals.
</p>
<p>- <code>all_date</code>: the character vector with all the dates used in the smooth spline.
</p>
<p>- <code>all_bloom</code>: the phenological data frame of each bloom with the timing variables (DBS, DMF, DMA, DMM, DBE) corrected.
</p>
<p>- <code>all_bloom_date</code>: the raw phenological data frame of each bloom.
</p>
<p>Warnings may occur during the smooth spline applications.
</p>


<h3>Author(s)</h3>

<p>Stephane Karasiewicz, <a href="mailto:skaraz.science@gmail.fr">skaraz.science@gmail.fr</a>
</p>


<h3>References</h3>

<p>Karasiewicz S., and Lefebvre A. (2022). Environmental Impact on Harmful Species Pseudo-nitzschia spp. and Phaeocystis globosa Phenology and Niche. <em>JMSE</em> 10(2), 174. <a href="https://doi.org/10.3390/jmse10020174">doi:10.3390/jmse10020174</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(BDAlgo)
data(Abundance)
algo &lt;- BDAlgo(Abundance, threshold=c(4,4), perc_of_peak=0.85, nbr_days=300, date_col= 2,
station_col=1, Sp = c("Pseunitz", "Phaeocy"), min_Log = 2,SP_label = c("Pseudo", "Phae"),
Log=TRUE,PDF=FALSE, saving_path= NULL)
 

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
