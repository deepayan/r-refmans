<!DOCTYPE html><html lang="en"><head><title>Help for package resample</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {resample}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#resample-package'><p>Overview of the resample package</p></a></li>
<li><a href='#bootstrap'>
<p>One and two sample bootstrap sampling and permutation tests.</p></a></li>
<li><a href='#cat0'>
<p>Front end to cat</p></a></li>
<li><a href='#CI'>
<p>Bootstrap confidence intervals</p></a></li>
<li><a href='#colVars'>
<p>Column variances and standard deviations for matrices.</p></a></li>
<li><a href='#deprecated.resample'>
<p>Deprecated functions.</p></a></li>
<li><a href='#ExpandProbs'>
<p>Calculate modified probabilities for more accurate confidence intervals</p></a></li>
<li><a href='#IfElse'><p>Conditional Data Selection</p></a></li>
<li><a href='#jackknife'>
<p>One sample jackknife</p></a></li>
<li><a href='#print.resample'>
<p>Methods for common generic functions for resample objects</p></a></li>
<li><a href='#Quantile'>
<p>Compute quantiles using type = 6</p></a></li>
<li><a href='#resample'>
<p>Nonparametric resampling</p></a></li>
<li><a href='#resample-data'>
<p>Data sets for resampling examples</p></a></li>
<li><a href='#samp.bootstrap'>
<p>Generate indices for resampling</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Resampling Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Tim Hesterberg</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tim Hesterberg &lt;timhesterberg@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), graphics, stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>splus2R</td>
</tr>
<tr>
<td>Description:</td>
<td>Bootstrap, permutation tests, and jackknife,
	featuring easy-to-use syntax.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-13 04:47:03 UTC; timhesterberg</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-13 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='resample-package'>Overview of the resample package</h2><span id='topic+resample-package'></span>

<h3>Description</h3>

<p>Resampling functions, including one- and two-sample bootstrap and
permutation tests, with an easy-to-use syntax.
</p>


<h3>Details</h3>

<p>See <code>library(help = resample)</code> for version number, date, etc.
</p>


<h3>Data Sets</h3>

<p>A list of datasets is at
<code><a href="#topic+resample-data">resample-data</a></code>,
</p>


<h3>Main resampling functions</h3>

<p>The main resampling functions are:
<code><a href="#topic+bootstrap">bootstrap</a></code>,
<code><a href="#topic+bootstrap2">bootstrap2</a></code>,
<code><a href="#topic+permutationTest">permutationTest</a></code>, <br />
<code><a href="#topic+permutationTest2">permutationTest2</a></code>.
</p>


<h3>Methods</h3>

<p>Methods for generic functions include:
<code><a href="#topic+print.resample">print.resample</a></code>,
<code><a href="#topic+plot.resample">plot.resample</a></code>, <br />
<code><a href="#topic+hist.resample">hist.resample</a></code>,
<code><a href="#topic+qqnorm.resample">qqnorm.resample</a></code>, and
<code><a href="#topic+quantile.resample">quantile.resample</a></code>.
</p>


<h3>Confidence Intervals</h3>

<p>Functions that calculate confidence intervals for <code><a href="#topic+bootstrap">bootstrap</a></code>
and <code><a href="#topic+bootstrap2">bootstrap2</a></code> objects: <br />
<code><a href="#topic+CI.bca">CI.bca</a></code>,
<code><a href="#topic+CI.bootstrapT">CI.bootstrapT</a></code>,
<code><a href="#topic+CI.percentile">CI.percentile</a></code>,
<code><a href="#topic+CI.t">CI.t</a></code>.
</p>


<h3>Samplers</h3>

<p>Functions that generate indices for random samples:
<code><a href="#topic+samp.bootstrap">samp.bootstrap</a></code>,
<code><a href="#topic+samp.permute">samp.permute</a></code>.
</p>


<h3>Low-level Resampling Function</h3>

<p>This is called by the main resampling functions, but can also be
called directly:
<code><a href="#topic+resample">resample</a></code>.
</p>


<h3>New Versions</h3>

<p>I will post the newest versions to
<a href="https://www.timhesterberg.net/r-packages">https://www.timhesterberg.net/r-packages</a>.
See that page to join a list for announcements of new versions.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Verizon)
ILEC &lt;- with(Verizon, Time[Group == "ILEC"])
CLEC &lt;- with(Verizon, Time[Group == "CLEC"])

#### Sections in this set of examples
### Different ways to specify the data and statistic
### Example with plots and confidence intervals.


### Different ways to specify the data and statistic
# This code is flexible; there are different ways to call it,
# depending on how the data are stored and on the statistic.


## One-sample Bootstrap

# Ordinary vector, give statistic as a function
bootstrap(CLEC, mean)

# Vector by name, give statistic as an expression
bootstrap(CLEC, mean(CLEC))

# Vector created by an expression, use the name 'data'
bootstrap(with(Verizon, Time[Group == "CLEC"]), mean(data))

# A column in a data frame; use the name of the column
temp &lt;- data.frame(foo = CLEC)
bootstrap(temp, mean(foo))

# Put function arguments into an expression
bootstrap(CLEC, mean(CLEC, trim = .25))

# Put function arguments into a separate list
bootstrap(CLEC, mean, args.stat = list(trim = .25))


## One-sample jackknife

# Syntax is like bootstrap, e.g.
jackknife(CLEC, mean)


## One-sample permutation test

# To test H0: two variables are independent, exactly
# one of them just be permuted. For the CLEC data,
# we'll create an artificial variable.
CLEC2 &lt;- data.frame(Time = CLEC, index = 1:length(CLEC))

permutationTest(CLEC2, cor(Time, index),
                resampleColumns = "index")
# Could permute "Time" instead.

# resampleColumns not needed for variables outside 'data'
permutationTest(CLEC, cor(CLEC, 1:length(CLEC)))



### Two-sample problems
## Different ways to specify data and statistic

## Two-sample bootstrap

# Two data objects (one for each group)
bootstrap2(CLEC, data2 = ILEC, mean)

# data frame containing y variable(s) and a treatment variable
bootstrap2(Verizon, mean(Time), treatment = Group)

# treatment variable as a separate object
temp &lt;- Verizon$Group
bootstrap2(Verizon$Time, mean, treatment = temp)


## Two-sample permutation test

# Like bootstrap2, e.g.
permutationTest2(CLEC, data2 = ILEC, mean)


### Example with plots and confidence intervals.

boot &lt;- bootstrap2(CLEC, data2 = ILEC, mean)
perm &lt;- permutationTest2(CLEC, data2 = ILEC, mean,
                         alternative = "greater")
par(mfrow = c(2,2))
hist(boot)
qqnorm(boot)
qqline(boot$replicates)
hist(perm)


# P-value
perm
# Standard error, and bias estimate
boot

# Confidence intervals
CI.percentile(boot) # Percentile interval
CI.t(boot)  # t interval using bootstrap SE
# CI.bootstrapT and CI.bca do't currently support two-sample problems.

# Statistic can be multivariate.
# For the bootstrap2, it must have the estimate first, and a standard
# error second (don't need to divide by sqrt(n), that cancels out).
bootC &lt;- bootstrap(CLEC, mean, seed = 0)
bootC2 &lt;- bootstrap(CLEC, c(mean = mean(CLEC), sd = sd(CLEC)), seed = 0)
identical(bootC$replicates[, 1], bootC2$replicates[, 1])

CI.percentile(bootC)
CI.t(bootC)
CI.bca(bootC)
CI.bootstrapT(bootC2)
# The bootstrapT is the most accurate for skewed data, especially
# for small samples.

# By default the percentile and BCa intervals are "expanded", for
# better coverage in small samples. To turn this off:
CI.percentile(bootC, expand = FALSE)
</code></pre>

<hr>
<h2 id='bootstrap'>
One and two sample bootstrap sampling and permutation tests.
</h2><span id='topic+bootstrap'></span><span id='topic+bootstrap2'></span><span id='topic+permutationTest'></span><span id='topic+permutationTest2'></span>

<h3>Description</h3>

<p>Basic resampling. Supply the data and statistic to resample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap(data, statistic, R = 10000,
          args.stat = NULL, seed = NULL, sampler = samp.bootstrap,
          label = NULL, statisticNames = NULL, block.size = 100,
          trace = FALSE)
bootstrap2(data, statistic, treatment, data2 = NULL, R = 10000,
          ratio = FALSE,
          args.stat = NULL, seed = NULL, sampler = samp.bootstrap,
          label = NULL, statisticNames = NULL, block.size = 100,
          trace = FALSE)
permutationTest(data, statistic, R = 9999,
          alternative = "two.sided", resampleColumns = NULL,
          args.stat = NULL, seed = NULL, sampler = samp.permute,
          label = NULL, statisticNames = NULL, block.size = 100,
          trace = FALSE, tolerance = .Machine$double.eps ^ 0.5)
permutationTest2(data, statistic, treatment, data2 = NULL, R = 9999,
          alternative = "two.sided", ratio = FALSE, paired = FALSE,
          args.stat = NULL, seed = NULL, sampler = samp.permute,
          label = NULL, statisticNames = NULL, block.size = 100,
          trace = FALSE, tolerance = .Machine$double.eps ^ 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootstrap_+3A_data">data</code></td>
<td>

<p>vector, matrix, or data frame.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_statistic">statistic</code></td>
<td>

<p>a function, or expression (e.g. <code>mean(myData, trim = .2)</code>.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_r">R</code></td>
<td>

<p>number of replicates (bootstrap samples or permutation resamples).
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_treatment">treatment</code></td>
<td>

<p>a vector with two unique values.
For two-sample applications, suppy either <code>treatment</code> or
<code>data2</code>.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_data2">data2</code></td>
<td>

<p>an object like <code>data</code>; the second sample.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_alternative">alternative</code></td>
<td>

<p>one of <code>"two.sided"</code>, <code>"greater"</code>, or <code>"less"</code>.
If <code>statistic</code> returns a vector, this may be a vector
of the same length.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_ratio">ratio</code></td>
<td>

<p>logical, if <code>FALSE</code> then statistics for two samples are combined using
statistic1 - statistic2 (the statistics from the two samples).
If <code>TRUE</code>, it uses statistic1 / statistic2.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_resamplecolumns">resampleColumns</code></td>
<td>

<p>integer, or character (a subset of the column names of <code>data</code>);
if supplied then only these columns of the data are permuted.
For example, for a permutation test of the correlation of x and y,
only one of the variables should be permuted.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_args.stat">args.stat</code></td>
<td>

<p>a list of additional arguments to pass to <code>statistic</code>, if
it is a function.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_paired">paired</code></td>
<td>

<p>logical, if <code>TRUE</code> then observations in <code>data</code> and
<code>data2</code> are paired, and permutations are done within each pair.
Not yet implemented.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_seed">seed</code></td>
<td>

<p>old value of .Random.seed, or argument to set.seed.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_sampler">sampler</code></td>
<td>

<p>a function for resampling, see <code>help(<a href="#topic+samp.bootstrap">samp.bootstrap</a>)</code>.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_label">label</code></td>
<td>

<p>used for labeling plots (in a future version).
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_statisticnames">statisticNames</code></td>
<td>

<p>a character vector the same length as the vector returned by
<code>statistic</code>.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_block.size">block.size</code></td>
<td>

<p>integer. The <code>R</code> replicates are done this many at a time.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_trace">trace</code></td>
<td>

<p>logical, if <code>TRUE</code> an indication of progress is printed.
</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_tolerance">tolerance</code></td>
<td>

<p>when computing P-values, differences smaller than <code>tolerance</code>
(absolute or relative)
between the observed value and the replicates are considered equal.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is considerable flexibility in how you specify the data and statistic.
</p>
<p>For the <code>statistic</code>, you may supply a function, or an expression.
For example, if <code>data = x</code>, you may specify any of
</p>

<ul>
<li><p><code>statistic = mean</code>
</p>
</li>
<li><p><code>statistic = mean(x)</code>
</p>
</li>
<li><p><code>statistic = mean(data)</code>
</p>
</li></ul>

<p>If <code>data</code> is a data frame, the expression may refer to columns in
the data frame, e.g.
</p>

<ul>
<li><p><code>statistic = mean(x)</code>
</p>
</li>
<li><p><code>statistic = mean(myData$x)</code>
</p>
</li>
<li><p><code>statistic = mean(myData[, "x"])</code>
</p>
</li></ul>

<p>If <code>data</code> is not just the name of an object, e.g.
<code>data = subset(myData, age &gt; 17)</code>, or if <code>data2</code>
is supplied, then use the name 'data', e.g.
</p>

<ul>
<li><p><code>statistic = colMeans(data)</code>
</p>
</li></ul>



<h3>Value</h3>

<p>a list with class
<code>"bootstrap"</code>, <code>"bootstrap2"</code>,
<code>"permutationTest"</code>, <br />
or <code>"permutationTest2"</code>,
that inherits from <code>"resample"</code>,
with components:
</p>
<table role = "presentation">
<tr><td><code>observed</code></td>
<td>
<p>the value of the statistic for the original data.</p>
</td></tr>
<tr><td><code>replicates</code></td>
<td>
<p>a matrix with <code>R</code> rows and <code>p</code> columns.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the original data, or vector of
length 2 in two-sample problems.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p><code>length(observed)</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>number of replications.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>the value of the seed at the start of sampling.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>statistics</code></td>
<td>
<p>a data frame with <code>p</code> rows, with columns
<code>"observed"</code>, <code>"mean"</code> (the mean of the replicates),
and other columns appropriate to resampling; e.g. the bootstrap
objects have columns <code>"SE"</code> and <code>"Bias"</code>,
while the permutation test objects have <code>"Alternative"</code>
and <code>"PValue"</code>.</p>
</td></tr>
</table>
<p>The two-sample versions have an additional component:
</p>
<table role = "presentation">
<tr><td><code>resultsBoth</code></td>
<td>
<p>containing resampling results from each data set.
containing two components,
the results from resampling each of the two samples. These are
<code>bootstrap</code> objects; in the <code>permutationTest2</code> case
they are the result of sampling without replacement.</p>
</td></tr>
</table>
<p>There are functions for printing and plotting these objects,
in particular <code>print</code>, <code>hist</code>, <code>qqnorm</code>,
<code>plot</code> (currently the same as <code>hist</code>),
<code>quantile</code>.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+resample-package">resample-package</a></code>,
<code><a href="#topic+samp.bootstrap">samp.bootstrap</a></code>,
<code><a href="#topic+CI.percentile">CI.percentile</a></code>,
<code><a href="#topic+CI.t">CI.t</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See full set of examples in resample-package, including different
# ways to call the functions depending on the structure of the data.
data(Verizon)
CLEC &lt;- with(Verizon, Time[Group == "CLEC"])
bootC &lt;- bootstrap(CLEC, mean)
bootC
hist(bootC)
qqnorm(bootC)

</code></pre>

<hr>
<h2 id='cat0'>
Front end to cat
</h2><span id='topic+cat0'></span><span id='topic+catn'></span><span id='topic+cat0n'></span>

<h3>Description</h3>

<p>Call cat, with <code>sep=""</code> and/or newline at end.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cat0(...)
cat0n(...)
catn(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cat0_+3A_...">...</code></td>
<td>
<p>R objects, like for <code><a href="base.html#topic+cat">cat</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cat0</code> and <code>cat0n</code> call <code>cat</code> with <code>sep = ""</code>.
<code>catn</code> and <code>cat0n</code> print a final newline).
</p>


<h3>Value</h3>

<p>None (invisible <code>NULL</code>).
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+cat">cat</a></code>, <code><a href="base.html#topic+paste0">paste0</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cat("Print this")
# That printed without a final newline.
catn("Print this")
cat0n("10,", "000")
</code></pre>

<hr>
<h2 id='CI'>
Bootstrap confidence intervals
</h2><span id='topic+CI.percentile'></span><span id='topic+CI.t'></span><span id='topic+CI.bca'></span><span id='topic+CI.bootstrapT'></span>

<h3>Description</h3>

<p>Bootstrap confidence intervals - percentile method or t interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CI.percentile(x, confidence = 0.95, expand = TRUE, ...,
              probs = sort(1 + c(-1, 1) * confidence) / 2)
CI.t(x, confidence = 0.95, expand = TRUE,
              probs = sort(1 + c(-1, 1) * confidence) / 2)
CI.bca(x, confidence = 0.95,
              expand = TRUE, L = NULL,
              probs = sort(1 + c(-1, 1) * confidence) / 2)
CI.bootstrapT(x, confidence = 0.95,
              probs = sort(1 + c(-1, 1) * confidence) / 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CI_+3A_x">x</code></td>
<td>

<p>a <code><a href="#topic+bootstrap">bootstrap</a></code> or <code><a href="#topic+bootstrap">bootstrap</a></code> object.
</p>
</td></tr>
<tr><td><code id="CI_+3A_confidence">confidence</code></td>
<td>

<p>confidence level, between 0 and 1. The default 0.95
gives a 95% two-sided interval.
</p>
</td></tr>
<tr><td><code id="CI_+3A_expand">expand</code></td>
<td>

<p>logical, if <code>TRUE</code> then use modified percentiles for better
small-sample accuracy.
</p>
</td></tr>
<tr><td><code id="CI_+3A_...">...</code></td>
<td>

<p>additional arguments to pass to <code><a href="#topic+quantile.resample">quantile.resample</a></code>
and <code><a href="stats.html#topic+quantile">quantile</a></code>.
</p>
</td></tr>
<tr><td><code id="CI_+3A_probs">probs</code></td>
<td>

<p>probability values, between 0 and 1. <code>confidence = 0.95</code>
corresponds to <code>probs = c(0.025, 0.975)</code>.
If this is supplied then confidence is ignored.
</p>
</td></tr>
<tr><td><code id="CI_+3A_l">L</code></td>
<td>
<p>vector of length <code>n</code>, empirical influence function
values. If not supplied this is computed using <code><a href="#topic+jackknife">jackknife</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CI.bootstrapT</code> assumes the first dimension of the statistic
is an estimate, and the second is proportional to a SE for the
estimate. E.g. for bootstrapping the mean, they could be the mean and s.
This is subject to change.
</p>
<p><code>CI.bca</code> and <code>CI.bootstrapT</code> currently only support
a single sample.
</p>


<h3>Value</h3>

<p>a matrix with one column for each value in <code>probs</code> and one row
for each statistic.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>References</h3>

<p>This discusses the expanded percentile interval:
Hesterberg, Tim (2014), What Teachers Should Know about the
Bootstrap: Resampling in the Undergraduate Statistics Curriculum,
<a href="https://arxiv.org/abs/1411.5279">https://arxiv.org/abs/1411.5279</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootstrap">bootstrap</a></code>,
<code><a href="#topic+bootstrap2">bootstrap2</a></code>,
<code><a href="#topic+ExpandProbs">ExpandProbs</a></code> (for the expanded intervals).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See full set of examples in resample-package, including different
# ways to call all four functions depending on the structure of the data.
data(Verizon)
CLEC &lt;- with(Verizon, Time[Group == "CLEC"])
bootC &lt;- bootstrap(CLEC, mean, seed = 0)
bootC2 &lt;- bootstrap(CLEC, c(mean = mean(CLEC), sd = sd(CLEC)), seed = 0)
CI.percentile(bootC)
CI.t(bootC)
CI.bca(bootC)
CI.bootstrapT(bootC2)

</code></pre>

<hr>
<h2 id='colVars'>
Column variances and standard deviations for matrices.
</h2><span id='topic+colVars'></span><span id='topic+colStdevs'></span>

<h3>Description</h3>

<p>Quick and dirty function for column variances and standard deviations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colVars(x, na.rm = FALSE)
colStdevs(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="colVars_+3A_x">x</code></td>
<td>

<p>data frame, matrix, or vector. These versions do not support
higher-dimensional arrays.
</p>
</td></tr>
<tr><td><code id="colVars_+3A_na.rm">na.rm</code></td>
<td>

<p>logical. Should missing values (including <code>NaN</code>)
be omitted from the calculations?
</p>
</td></tr>
<tr><td><code id="colVars_+3A_...">...</code></td>
<td>

<p>other arguments passed to <code>colVars</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric or complex array of suitable size, or a vector if the result is
one-dimensional.  The <code>dimnames</code> (or <code>names</code> for a vector
result) are taken from the original array.
</p>


<h3>Note</h3>

<p>There are better versions of these functions in the aggregate package<br />
<a href="https://www.timhesterberg.net/r-packages">https://www.timhesterberg.net/r-packages</a>.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+colSums">colSums</a></code>, <code><a href="stats.html#topic+var">var</a></code>, <code><a href="stats.html#topic+sd">sd</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(rnorm(12), 4)
colVars(x)
colStdevs(x)
</code></pre>

<hr>
<h2 id='deprecated.resample'>
Deprecated functions.
</h2><span id='topic+limits.percentile'></span><span id='topic+limits.t'></span><span id='topic+limits.bootstrapT'></span>

<h3>Description</h3>

<p>Deprecated functions
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deprecated.resample_+3A_...">...</code></td>
<td>

<p>arguments to pass to the replacement functions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>limits.percentile</code>, <code>limits.t</code> and <code>limits.bootstrapT</code>
have been renamed &quot;CI.*&quot;.
</p>


<h3>Value</h3>

<p>See the replacement functions.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CI.percentile">CI.percentile</a></code>,
<code><a href="#topic+CI.t">CI.t</a></code>,
<code><a href="#topic+CI.bootstrapT">CI.bootstrapT</a></code>.
</p>

<hr>
<h2 id='ExpandProbs'>
Calculate modified probabilities for more accurate confidence intervals
</h2><span id='topic+ExpandProbs'></span>

<h3>Description</h3>

<p>Compute modified quantiles levels, for more accurate confidence
intervals. Using these levels gives sider intervals, with closer to
desired coverage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExpandProbs(probs, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExpandProbs_+3A_probs">probs</code></td>
<td>

<p>vector of numerical values between 0 and 1.
</p>
</td></tr>
<tr><td><code id="ExpandProbs_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bootstrap percentile confidence interval for a sample mean correspond roughly to
</p>
<p style="text-align: center;"><code class="reqn">\bar x \pm z_\alpha \hat\sigma</code>
</p>

<p>instead of
</p>
<p style="text-align: center;"><code class="reqn">\bar x \pm t_{\alpha,n-1} s</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat\sigma = \sqrt{(n-1)/n s}</code>
</p>

<p>is like s but computed using a divisor of n instead of n-1.
Similarly for other statistics, the bootstrap percentile interval
is too narrow, typically by roughly the same proportion.
</p>
<p>This function finds modified probability levels probs2, such that
</p>
<p style="text-align: center;"><code class="reqn">z_{\mbox{probs2}} \sqrt{(n-1)/n} = t_{\mbox{probs}, n-1}</code>
</p>

<p>z_probs2 sqrt((n-1)/n) = t_probs,n-1
so that for symmetric data, the bootstrap percentile interval
approximately matches the usual $t$ confidence interval.
</p>


<h3>Value</h3>

<p>A vector like <code>probs</code>, but with values closer to 0 and 1.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>References</h3>

<p>This discusses the expanded percentile interval:
Hesterberg, Tim (2014), What Teachers Should Know about the
Bootstrap: Resampling in the Undergraduate Statistics Curriculum,
<a href="https://arxiv.org/abs/1411.5279">https://arxiv.org/abs/1411.5279</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CI.percentile">CI.percentile</a></code>,
<code><a href="#topic+CI.bca">CI.bca</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>probs &lt;- c(0.025, 0.975)
n &lt;- c(5, 10, 20, 40, 100, 200, 1000)
outer(probs, n, ExpandProbs)
</code></pre>

<hr>
<h2 id='IfElse'>Conditional Data Selection</h2><span id='topic+IfElse'></span>

<h3>Description</h3>

<p>This is equivalent to <code>{if(test) yes else no}</code>.
The advantages of using this function are better formatting, and a more
natural syntax when the result is being assigned; see examples below.
</p>
<p>With 5 arguments, this is equivalent to
<code>{if(test1) yes else if(test2) u else v}</code>
(where arguments are given by name, not position).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IfElse(test, yes, no, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IfElse_+3A_test">test</code></td>
<td>
<p>logical value; if <code>TRUE</code> return <code>yes</code>.</p>
</td></tr>
<tr><td><code id="IfElse_+3A_yes">yes</code></td>
<td>
<p>any object; this is returned if <code>test</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="IfElse_+3A_no">no</code></td>
<td>
<p>normally any object; this is returned if <code>test</code> is <code>FALSE</code>.
If there are more than three arguments this should be logical.</p>
</td></tr>
<tr><td><code id="IfElse_+3A_...">...</code></td>
<td>
<p>there should be 3, 5, 7, etc. arguments to this function;
arguments 1, 3, 5, etc. should be logical values; the other arguments
(even numbered, and last) are objects that may be returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>test</code> should be a scalar logical, and only one of <code>yes</code> or
<code>no</code> is evaluated, depending on whether <code>test = TRUE</code> or
<code>test = FALSE</code>, and <code>yes</code> and <code>no</code> may be any objects.
In contrast, for
<code>ifelse</code>, test is normally a vector, both <code>yes</code> and <code>no</code>
are evaluated, even if
not used, and <code>yes</code> and <code>no</code> are vectors the same length as
<code>test</code>.
</p>


<h3>Value</h3>

<p>with three arguments, one of <code>yes</code> or <code>no</code>.
With k arguments, one of arguments 2, 4, ..., k-1, k.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+ifelse">ifelse</a></code>, <code><a href="base.html#topic+if">if</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>IfElse(TRUE, "cat", "dog")
IfElse(FALSE, "one", TRUE, "two", "three")
IfElse(FALSE, "one", FALSE, "two", "three")
</code></pre>

<hr>
<h2 id='jackknife'>
One sample jackknife
</h2><span id='topic+jackknife'></span>

<h3>Description</h3>

<p>Basic resampling. Supply the data and statistic to resample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jackknife(data, statistic, args.stat = NULL,
          label = NULL, statisticNames = NULL, trace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jackknife_+3A_data">data</code></td>
<td>

<p>vector, matrix, or data frame.
</p>
</td></tr>
<tr><td><code id="jackknife_+3A_statistic">statistic</code></td>
<td>

<p>a function, or expression (e.g. <code>mean(myData, trim = .2)</code>.
</p>
</td></tr>
<tr><td><code id="jackknife_+3A_args.stat">args.stat</code></td>
<td>

<p>a list of additional arguments to pass to <code>statistic</code>, if
it is a function.
</p>
</td></tr>
<tr><td><code id="jackknife_+3A_label">label</code></td>
<td>

<p>used for labeling plots (in a future version).
</p>
</td></tr>
<tr><td><code id="jackknife_+3A_statisticnames">statisticNames</code></td>
<td>

<p>a character vector the same length as the vector returned by
<code>statistic</code>.
</p>
</td></tr>
<tr><td><code id="jackknife_+3A_trace">trace</code></td>
<td>

<p>logical, if <code>TRUE</code> an indication of progress is printed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with class <code>"jackknife"</code>
that inherits from <code>"resample"</code>,
with components:
</p>
<table role = "presentation">
<tr><td><code>observed</code></td>
<td>
<p>the value of the statistic for the original data.</p>
</td></tr>
<tr><td><code>replicates</code></td>
<td>
<p>a matrix with <code>R</code> rows and <code>p</code> columns.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the original data, or vector of
length 2 in two-sample problems.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p><code>length(observed)</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>number of replications.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>the value of the seed at the start of sampling.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>statistics</code></td>
<td>
<p>a data frame with <code>p</code> rows, with columns
<code>"observed"</code>, <code>"mean"</code> (the mean of the replicates),
and other columns appropriate to resampling; e.g. the bootstrap
objects have columns <code>"SE"</code> and <code>"Bias"</code>,
while the permutation test objects have <code>"Alternative"</code>
and <code>"PValue"</code>.</p>
</td></tr>
</table>
<p>There are functions for printing and plotting these objects,
in particular <code>print</code>, <code>plot</code>, <code>hist</code>, <code>qqnorm</code>,
<code>quantile</code>.
</p>


<h3>Note</h3>

<p>The current version only handles a single sample.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+resample-package">resample-package</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See full set of examples in resample-package
data(Verizon)
CLEC &lt;- with(Verizon, Time[Group == "CLEC"])
jackknife(CLEC, mean)

</code></pre>

<hr>
<h2 id='print.resample'>
Methods for common generic functions for resample objects
</h2><span id='topic+plot.resample'></span><span id='topic+hist.resample'></span><span id='topic+qqnorm.resample'></span><span id='topic+print.resample'></span><span id='topic+quantile.resample'></span>

<h3>Description</h3>

<p>Methods for common generic functions. The methods
operate primarily on the replicates
(resampled statistics).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'resample'
print(x, ...)
## S3 method for class 'resample'
hist(x, ..., resampleColumns = 1:x$p, xlim = NULL,
                xlab = NULL, main = "", col = "blue", border = 0,
                breaks = "FD", showObserved = TRUE,
                legend = TRUE, args.legend = NULL)
## S3 method for class 'resample'
plot(x, ...)
## S3 method for class 'resample'
qqnorm(y, ..., resampleColumns = 1:y$p, ylab = NULL,
                pch = if(y$R &lt; 100) 1 else ".")
## S3 method for class 'resample'
quantile(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.resample_+3A_x">x</code>, <code id="print.resample_+3A_y">y</code></td>
<td>

<p>a <code>"resample"</code> object, usually produced by one of
<code><a href="#topic+bootstrap">bootstrap</a></code>,
<code><a href="#topic+bootstrap2">bootstrap2</a></code>,
<code><a href="#topic+permutationTest">permutationTest</a></code>, or
<code><a href="#topic+permutationTest2">permutationTest2</a></code>.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_...">...</code></td>
<td>

<p>additional arguments passed to the corresponding generic function.<br />
For <code>plot.resample</code>, these are passed to <code>hist.resample</code>.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_resamplecolumns">resampleColumns</code></td>
<td>

<p>integer subscripts, or names of statistics.
When a statistic is a vector, resampleColumns may be used to select
which resampling distributions to plot.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_xlim">xlim</code></td>
<td>

<p>limits for the x axis.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_xlab">xlab</code>, <code id="print.resample_+3A_ylab">ylab</code></td>
<td>

<p>x and y axis labels.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_main">main</code></td>
<td>

<p>main title
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_col">col</code></td>
<td>

<p>color used to fill bars, see <code><a href="graphics.html#topic+hist">hist</a></code>.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_border">border</code></td>
<td>

<p>color of the order around the bars, see <code><a href="graphics.html#topic+hist">hist</a></code>.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_breaks">breaks</code></td>
<td>

<p>method for computing breaks, see <code><a href="graphics.html#topic+hist">hist</a></code>.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_showobserved">showObserved</code></td>
<td>

<p>logical, if <code>TRUE</code> then vertical lines are shown at the
observed statistic and mean of the bootstrap replicates.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_legend">legend</code></td>
<td>

<p>logical, if <code>TRUE</code> a legend is added. Not used if
<code>showObserved = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_args.legend">args.legend</code></td>
<td>

<p><code>NULL</code> or a list of arguments to pass to
<code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
</td></tr>
<tr><td><code id="print.resample_+3A_pch">pch</code></td>
<td>

<p>plotting character, see <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>hist.resample</code> displays a histogram overlaid with a density
plot, with the observed value of the statistic indicated.
</p>
<p><code>plot.resample</code> currently just calls <code>hist.resample</code>.
</p>


<h3>Value</h3>

<p>For <code>quantile.resample</code>, a matrix with one row for each
statistic and one column for each value in <code>probs</code>.
This uses <code>type=6</code> when calling
<code><a href="stats.html#topic+quantile">quantile</a></code>, for wider (more accurate) quantiles than
the usual default.
</p>
<p>The other functions are not called for their return values.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+resample-package">resample-package</a></code>,
<code><a href="#topic+bootstrap">bootstrap</a></code>,
<code><a href="#topic+bootstrap2">bootstrap2</a></code>,
<code><a href="#topic+jackknife">jackknife</a></code>,
<code><a href="#topic+permutationTest">permutationTest</a></code>,<br />
<code><a href="#topic+permutationTest2">permutationTest2</a></code>,
<code><a href="stats.html#topic+quantile">quantile</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See full set of examples in resample-package
data(Verizon)
CLEC &lt;- with(Verizon, Time[Group == "CLEC"])
bootC &lt;- bootstrap(CLEC, mean, seed = 0)
print(bootC)
hist(bootC)
qqnorm(bootC)
quantile(bootC, probs = c(.25, .975))
# That is the percentile interval with expand = FALSE
CI.percentile(bootC)

</code></pre>

<hr>
<h2 id='Quantile'>
Compute quantiles using type = 6
</h2><span id='topic+Quantile'></span>

<h3>Description</h3>

<p>Front end to quantile, using type = 6 (appropriate for resampling)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quantile(x, ..., type = 6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Quantile_+3A_x">x</code></td>
<td>

<p><code>resample</code> object,
numerical object, or other object with a method for
<code><a href="stats.html#topic+quantile">quantile</a></code>.
</p>
</td></tr>
<tr><td><code id="Quantile_+3A_...">...</code></td>
<td>

<p>Other arguments passed to <code><a href="stats.html#topic+quantile">quantile</a></code>.
</p>
</td></tr>
<tr><td><code id="Quantile_+3A_type">type</code></td>
<td>

<p>With <code>type=6</code> and 99 observations, the k% quantile
is the k'th smallest observation; this corresponds to equal
probability above the largest observation, below the smallest
observation, and between each pair of adjacent observations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a front end to <code><a href="stats.html#topic+quantile">quantile</a></code>.
</p>


<h3>Value</h3>

<p>A vector or matrix of quantiles.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+quantile">quantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>quantile(1:9, .2)
Quantile(1:9, .2)
</code></pre>

<hr>
<h2 id='resample'>
Nonparametric resampling
</h2><span id='topic+resample'></span>

<h3>Description</h3>

<p>This function is called by <code><a href="#topic+bootstrap">bootstrap</a></code> and other
resampling functions to actually perform resampling, but may also be
called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resample(data, resampleFun, sampler, R = 10000, seed = NULL,
         statisticNames = NULL, block.size = 100,
         trace = FALSE, ..., observedIndices = 1:n,
         call = match.call())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="resample_+3A_data">data</code></td>
<td>

<p>vector, matrix, or data frame.
</p>
</td></tr>
<tr><td><code id="resample_+3A_resamplefun">resampleFun</code></td>
<td>

<p>a function with argument <code>data</code> and <code>ii</code>, that calculates
a statistic of interest for <code>data[ii]</code> or
<code>data[ii, , drop=FALSE]</code>, for a vector or matrix, respectively.
</p>
</td></tr>
<tr><td><code id="resample_+3A_sampler">sampler</code></td>
<td>

<p>a function like <code><a href="#topic+samp.bootstrap">samp.bootstrap</a></code> or
<code><a href="#topic+samp.permute">samp.permute</a></code>.
</p>
</td></tr>
<tr><td><code id="resample_+3A_r">R</code></td>
<td>

<p>number of resamples.
</p>
</td></tr>
<tr><td><code id="resample_+3A_seed">seed</code></td>
<td>

<p>old value of .Random.seed, or argument to set.seed.
</p>
</td></tr>
<tr><td><code id="resample_+3A_statisticnames">statisticNames</code></td>
<td>

<p>a character vector the same length as the vector returned by
<code>statistic</code>.
</p>
</td></tr>
<tr><td><code id="resample_+3A_block.size">block.size</code></td>
<td>

<p>integer. The <code>R</code> replicates are done this many at a time.
</p>
</td></tr>
<tr><td><code id="resample_+3A_trace">trace</code></td>
<td>

<p>logical, if <code>TRUE</code> an indication of progress is printed.
</p>
</td></tr>
<tr><td><code id="resample_+3A_...">...</code></td>
<td>

<p>addition arguments passed to <code>sampler</code>.
</p>
</td></tr>
<tr><td><code id="resample_+3A_observedindices">observedIndices</code></td>
<td>

<p>integer vector of indices, used for calculating the observed value.
When this is called by <code><a href="#topic+bootstrap2">bootstrap2</a></code> or
<code><a href="#topic+permutationTest2">permutationTest2</a></code>, those should be indices
corresponding to one sample in a merged data set.
</p>
</td></tr>
<tr><td><code id="resample_+3A_call">call</code></td>
<td>

<p>typically the call to <code>bootstrap</code> or another function that
calls resample. This may be a character string, e.g. when called
from <code>bootstrap2</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is called by
<code><a href="#topic+bootstrap">bootstrap</a></code>,
<code><a href="#topic+bootstrap2">bootstrap2</a></code>,
<code><a href="#topic+permutationTest">permutationTest</a></code>, and
<code><a href="#topic+permutationTest2">permutationTest2</a></code> to actually perform resampling.
The results are passed back to the calling function, which may
add additional components and a class, which inherits from
<code>"resample"</code>.
</p>
<p>This may also be called directly. In contrast to the other functions,
where you have flexibility in how you specify the statistic, here
<code>resampleFun</code> must be a function.
</p>


<h3>Value</h3>

<p>an object of class <code>"resample"</code>; this is
a list with components:
</p>
<table role = "presentation">
<tr><td><code>observed</code></td>
<td>
<p>the observed statistic, length <code>p</code>.</p>
</td></tr>
<tr><td><code>replicates</code></td>
<td>
<p>a matrix with <code>R</code> rows and <code>p</code> columns.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the length of the statistic returned by <code>resampleFun</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>number of resamples.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>the value of <code>seed</code> when this function is called.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootstrap">bootstrap</a></code>,
<code><a href="#topic+bootstrap2">bootstrap2</a></code>,
<code><a href="#topic+permutationTest">permutationTest</a></code>,
<code><a href="#topic+permutationTest2">permutationTest2</a></code>,
<code><a href="#topic+samp.bootstrap">samp.bootstrap</a></code>,
<code><a href="#topic+samp.permute">samp.permute</a></code>.
</p>
<p>For an overview of all functions in the package, see
<code><a href="#topic+resample-package">resample-package</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See full set of examples in resample-package, including different
# ways to call all the functions depending on the structure of the data.
data(Verizon)
CLEC &lt;- with(Verizon, Time[Group == "CLEC"])
bootC &lt;- bootstrap(CLEC, mean, seed = 0)
bootC

</code></pre>

<hr>
<h2 id='resample-data'>
Data sets for resampling examples
</h2><span id='topic+resample-data'></span><span id='topic+TV'></span><span id='topic+Verizon'></span>

<h3>Description</h3>

<p>Data sets for use in examples.
</p>


<h3>Details</h3>

<p><code>TV</code> has measurements of minutes of commercials per half-hour, for
&quot;Basic&quot; and &quot;Extended&quot; (extra-cost) cable TV stations.
</p>
<p><code>Verizon</code> has repair times, with two groups, CLEC and ILEC,
customers of the &quot;Competitive&quot; and &quot;Incumbent&quot; local exchange carrior.
</p>


<h3>DATA SETS</h3>

<p>TV            10 observations: Time,Cable
Verizon     1687 observations: Time,Group
</p>


<h3>Source</h3>

<p>The TV and Verizon datasets are used in What Teachers Should Know
about the Bootstrap: Resampling in the Undergraduate Statistics
Curriculum
</p>


<h3>References</h3>

<p>Hesterberg, Tim (2014), What Teachers Should Know about the
Bootstrap: Resampling in the Undergraduate Statistics Curriculum,
<a href="https://arxiv.org/abs/1411.5279">https://arxiv.org/abs/1411.5279</a>.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+resample-package">resample-package</a></code> for an overview of resampling functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(TV); summary(TV)
Basic &lt;- with(TV, Time[Cable == "Basic"])
Extended &lt;- with(TV, Time[Cable == "Extended"])

data(Verizon); summary(Verizon)
ILEC &lt;- with(Verizon, Time[Group == "ILEC"])
CLEC &lt;- with(Verizon, Time[Group == "CLEC"])

</code></pre>

<hr>
<h2 id='samp.bootstrap'>
Generate indices for resampling
</h2><span id='topic+samp.bootstrap'></span><span id='topic+samp.permute'></span>

<h3>Description</h3>

<p>Generate indices for resampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samp.bootstrap(n, R, size = n - reduceSize, reduceSize = 0)
samp.permute(n, R, size = n - reduceSize, reduceSize = 0,
             groupSizes = NULL, returnGroup = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="samp.bootstrap_+3A_n">n</code></td>
<td>

<p>sample size. For two-sample permutation tests, this is the sum of
the two sample sizes.
</p>
</td></tr>
<tr><td><code id="samp.bootstrap_+3A_r">R</code></td>
<td>

<p>number of vectors of indices to produce.
</p>
</td></tr>
<tr><td><code id="samp.bootstrap_+3A_size">size</code></td>
<td>

<p>size of samples to produce. For example, to do &quot;what-if&quot; analyses,
to estimate the variability of a statistic had the data been a
different size, you may specify the size.
</p>
</td></tr>
<tr><td><code id="samp.bootstrap_+3A_reducesize">reduceSize</code></td>
<td>

<p>integer; if specified, then <code>size = n - reduceSize</code>
(for each sample or stratum).
This is an alternate way to specify size. Typically bootstrap standard
errors are too small; they correspond to using <code>n</code> in the
divisor of the sample variance, rather than <code>n-1</code>.
By specifying <code>reduceSize = 1</code>, you can correct for that bias.
This is particularly convenient in two-sample problems where the
sample sizes differ.
</p>
</td></tr>
<tr><td><code id="samp.bootstrap_+3A_groupsizes">groupSizes</code></td>
<td>

<p><code>NULL</code>, or vector of positive integers that add to <code>n</code>.
</p>
</td></tr>
<tr><td><code id="samp.bootstrap_+3A_returngroup">returnGroup</code></td>
<td>

<p><code>NULL</code>, or integer from 1 to <code>length(groupSizes)</code>.
<code>groupSizes</code> and <code>returnGroup</code> must be supplied together;
then full permutations are created, but only subsets of size
<code>groupSizes[returnGroup]</code> is returned.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To obtain disjoint samples without replacement,
call this function multiple times, after setting the same random
number seed, with the same <code>groupSizes</code> but different values of
<code>returnGroup</code>. This is used for two-sample permutation tests.
</p>
<p>If <code>groupSizes</code> is supplied then <code>size</code> is ignored.
</p>


<h3>Value</h3>

<p>matrix with <code>size</code> rows and <code>R</code> columns
(or <code>groupSizes(returnGroup)</code> rows).
Each column contains indices for one bootstrap sample, or one permutation.
</p>


<h3>Note</h3>

<p>The value passed as <code>R</code> to this function is typically the
<code>block.size</code> argument to <code><a href="#topic+bootstrap">bootstrap</a></code> and other
resampling functions.
</p>


<h3>Author(s)</h3>

<p>Tim Hesterberg <a href="mailto:timhesterberg@gmail.com">timhesterberg@gmail.com</a>,<br />
<a href="https://www.timhesterberg.net/bootstrap-and-resampling">https://www.timhesterberg.net/bootstrap-and-resampling</a>
</p>


<h3>References</h3>

<p>This discusses reduced sample size:
Hesterberg, Tim C. (2004), Unbiasing the Bootstrap-Bootknife Sampling
vs. Smoothing, Proceedings of the Section on Statistics and the
Environment, American Statistical Association, 2924-2930,
<a href="https://drive.google.com/file/d/1eUo2nDIrd8J_yuh_uoZBaZ-2XCl_5pT7">https://drive.google.com/file/d/1eUo2nDIrd8J_yuh_uoZBaZ-2XCl_5pT7</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+resample-package">resample-package</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samp.bootstrap(7, 8)
samp.bootstrap(7, 8, size = 6)
samp.bootstrap(7, 8, reduceSize = 1)

# Full permutations
set.seed(0)
samp.permute(7, 8)

# Disjoint samples without replacement = subsets of permutations
set.seed(0)
samp.permute(7, 8, groupSizes = c(2, 5), returnGroup = 1)
set.seed(0)
samp.permute(7, 8, groupSizes = c(2, 5), returnGroup = 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
