<!DOCTYPE html><html><head><title>Help for package HyperbolicDist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HyperbolicDist}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Bessel K Ratio'><p>Ratio of Bessel K Functions</p></a></li>
<li><a href='#Functions for Moments'><p>Functions for Calculating Moments</p></a></li>
<li><a href='#Generalized Inverse Gaussian'><p>Generalized Inverse Gaussian Distribution</p></a></li>
<li><a href='#GeneralizedHyperbolic'><p>Generalized Hyperbolic Distribution</p></a></li>
<li><a href='#GeneralizedHyperbolicPlots'><p>Generalized Hyperbolic Quantile-Quantile and Percent-Percent Plots</p></a></li>
<li><a href='#ghypCalcRange'><p>Range of a Generalized Hyperbolic Distribution</p></a></li>
<li><a href='#ghypChangePars'><p>Change Parameterizations of the Generalized Hyperbolic Distribution</p></a></li>
<li><a href='#ghypMom'><p>Calculate Moments of the Generalized Hyperbolic Distribution</p></a></li>
<li><a href='#gigCalcRange'><p>Range of a Generalized Inverse Gaussian Distribution</p></a></li>
<li><a href='#gigChangePars'><p>Change Parameterizations of the Generalized Inverse Gaussian</p>
Distribution</a></li>
<li><a href='#gigCheckPars'><p>Check Parameters of the Generalized Inverse Gaussian Distribution</p></a></li>
<li><a href='#gigMom'><p>Calculate Moments of the Generalized Inverse Gaussian Distribution</p></a></li>
<li><a href='#GIGPlots'><p>Generalized Inverse Gaussian Quantile-Quantile and Percent-Percent Plots</p></a></li>
<li><a href='#hyperbCalcRange'><p>Range of a Hyperbolic Distribution</p></a></li>
<li><a href='#hyperbChangePars'><p>Change Parameterizations of the Hyperbolic Distribution</p></a></li>
<li><a href='#hyperbCvMTest'><p>Cramer-von~Mises Test of a Hyperbolic Distribution</p></a></li>
<li><a href='#hyperbFit'><p>Fit the Hyperbolic Distribution to Data</p></a></li>
<li><a href='#hyperbFitStart'><p>Find Starting Values for Fitting a Hyperbolic Distribution</p></a></li>
<li><a href='#Hyperbolic'><p>Hyperbolic Distribution</p></a></li>
<li><a href='#HyperbolicDistribution'>
<p>The Package &lsquo;HyperbolicDist&rsquo;: Summary Information</p></a></li>
<li><a href='#HyperbPlots'><p>Hyperbolic Quantile-Quantile and Percent-Percent Plots</p></a></li>
<li><a href='#hyperbWSqTable'><p>Percentage Points for the Cramer-von Mises Test of the Hyperbolic</p>
Distribution</a></li>
<li><a href='#is.wholenumber'><p>Is Object Numeric and Whole Numbers</p></a></li>
<li><a href='#logHist'><p>Plot Log-Histogram</p></a></li>
<li><a href='#mamquam'><p>Size of Gravels from Mamquam River</p></a></li>
<li><a href='#momChangeAbout'><p>Obtain Moments About a New Location</p></a></li>
<li><a href='#momIntegrated'><p>Moments Using Integration</p></a></li>
<li><a href='#momRecursion'><p>Computes the moment coefficients recursively for generalized</p>
hyperbolic and related distributions</a></li>
<li><a href='#resistors'><p>Resistance of One-half-ohm Resistors</p></a></li>
<li><a href='#safeIntegrate'><p>Safe Integration of One-Dimensional Functions</p></a></li>
<li><a href='#Sample Moments'><p>Sample Skewness and Kurtosis</p></a></li>
<li><a href='#SandP500'><p>S&amp;P 500</p></a></li>
<li><a href='#SkewLaplace'><p>Skew-Laplace Distribution</p></a></li>
<li><a href='#SkewLaplacePlots'><p>Skew-Laplace Quantile-Quantile and Percent-Percent Plots</p></a></li>
<li><a href='#Specific Generalized Hyperbolic Moments and Mode'><p>Moments and Mode of the Generalized Hyperbolic Distribution</p></a></li>
<li><a href='#Specific Generalized Inverse Gaussian Moments and Mode'><p>Moments and Mode of the Generalized Inverse Gaussian Distribution</p></a></li>
<li><a href='#Specific Hyperbolic Distribution Moments and Mode'><p>Moments and Mode of the Hyperbolic Distribution</p></a></li>
<li><a href='#summary.hyperbFit'><p>Summarizing Hyperbolic Distribution Fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.6-5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-26</td>
</tr>
<tr>
<td>Title:</td>
<td>The Hyperbolic Distribution</td>
</tr>
<tr>
<td>Author:</td>
<td>David Scott &lt;d.scott@auckland.ac.nz&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Scott &lt;d.scott@auckland.ac.nz&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>actuar</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Maintenance has been discontinued for this package. It has been
	     superseded by 'GeneralizedHyperbolic'. 'GeneralizedHyperbolic' 
	     includes all the functionality of 'HyperbolicDist' and more 
	     and is based on a more rational design. 'HyperbolicDist' 
	     provides functions for the hyperbolic and related 
	     distributions. Density, distribution and quantile functions 
	     and random number generation are provided for the hyperbolic 
	     distribution, the generalized hyperbolic distribution, 
	     the generalized inverse Gaussian distribution and the 
	     skew-Laplace distribution. Additional functionality is 
	     provided for the hyperbolic distribution, including 
	     fitting of the hyperbolic to data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-26 04:22:20 UTC; dsco036</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-26 05:30:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='Bessel+20K+20Ratio'>Ratio of Bessel K Functions</h2><span id='topic+besselRatio'></span>

<h3>Description</h3>

<p>Calculates the ratio of Bessel K functions of different orders
</p>


<h3>Usage</h3>

<pre><code class='language-R'>besselRatio(x, nu, orderDiff, useExpScaled = 700)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bessel+2B20K+2B20Ratio_+3A_x">x</code></td>
<td>
<p>Numeric, <code class="reqn">\geq 0</code>. Value at which the numerator and
denominator Bessel functions are evaluated.</p>
</td></tr>
<tr><td><code id="Bessel+2B20K+2B20Ratio_+3A_nu">nu</code></td>
<td>
<p>Numeric. The order of the Bessel function in the
denominator.</p>
</td></tr>
<tr><td><code id="Bessel+2B20K+2B20Ratio_+3A_orderdiff">orderDiff</code></td>
<td>
<p>Numeric. The order of the numerator Bessel function
minus the order of the denominator Bessel function.</p>
</td></tr>
<tr><td><code id="Bessel+2B20K+2B20Ratio_+3A_useexpscaled">useExpScaled</code></td>
<td>
<p>Numeric, <code class="reqn">\geq 0</code>. The smallest value of
<code class="reqn">x</code> for which the ratio is calculated using the
exponentially-scaled Bessel function values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses the function <code><a href="base.html#topic+besselK">besselK</a></code> to calculate the ratio of two
modified Bessel function of the third kind whose orders are
different. The calculation of Bessel functions will underflow if the
value of <code class="reqn">x</code> is greater than around 740. To avoid underflow the
exponentially-scaled Bessel functions can be returned by
<code><a href="base.html#topic+besselK">besselK</a></code>. The ratio is actually unaffected by exponential
scaling since the scaling cancels across numerator and denominator.
</p>
<p>The Bessel function ratio is useful in calculating moments of the
Generalized Inverse Gaussian distribution, and hence also for the
moments of the hyperbolic and generalized hyperbolic distributions.
</p>


<h3>Value</h3>

<p>The ratio
</p>
<p style="text-align: center;"><code class="reqn">\frac{K_{\nu+k}(x)}{K_{\nu}(x)}</code>
</p>

<p>of two modified Bessel functions of the third kind whose orders differ
by <code class="reqn">k</code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a></p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+besselK">besselK</a></code>, <code><a href="#topic+gigMom">gigMom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nus &lt;- c(0:5, 10, 20)
x &lt;- seq(1, 4, length.out = 11)
k &lt;- 3

raw &lt;- matrix(nrow = length(nus), ncol = length(x))
scaled &lt;- matrix(nrow = length(nus), ncol = length(x))
compare &lt;- matrix(nrow = length(nus), ncol = length(x))

for (i in 1:length(nus)){
    for (j in 1:length(x)) {
        raw[i,j] &lt;- besselRatio(x[j], nus[i],
                                orderDiff = k)
        scaled[i,j] &lt;- besselRatio(x[j], nus[i],
                                orderDiff = k, useExpScaled = 1)
        compare[i,j] &lt;- raw[i,j]/scaled[i,j]
    }
}
raw
scaled
compare

</code></pre>

<hr>
<h2 id='Functions+20for+20Moments'>Functions for Calculating Moments</h2><span id='topic+RLambda'></span><span id='topic+SLambda'></span><span id='topic+MLambda'></span><span id='topic+WLambda1'></span><span id='topic+WLambda2'></span><span id='topic+WLambda3'></span><span id='topic+WLambda4'></span><span id='topic+gammaLambda1'></span><span id='topic+gammaLambda2'></span>

<h3>Description</h3>

<p>Functions used to calculate the mean, variance, skewness and kurtosis
of a hyperbolic distribution. Not expected to be called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RLambda(zeta, lambda = 1)
SLambda(zeta, lambda = 1)
MLambda(zeta, lambda = 1)
WLambda1(zeta, lambda = 1)
WLambda2(zeta, lambda = 1)
WLambda3(zeta, lambda = 1)
WLambda4(zeta, lambda = 1)
gammaLambda1(hyperbPi, zeta, lambda = 1)
gammaLambda1(hyperbPi, zeta, lambda = 1)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Functions+2B20for+2B20Moments_+3A_hyperbpi">hyperbPi</code></td>
<td>
<p>Value of the parameter  <code class="reqn">\pi</code> of the
hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="Functions+2B20for+2B20Moments_+3A_zeta">zeta</code></td>
<td>
<p>Value of the parameter  <code class="reqn">\zeta</code> of the
hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="Functions+2B20for+2B20Moments_+3A_lambda">lambda</code></td>
<td>
<p>Parameter related to order of Bessel functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The functions <code>RLambda</code> and <code>SLambda</code>
are used in the calculation of the mean and variance. They are
functions of the Bessel functions of the third kind,
implemented in <span class="rlang"><b>R</b></span> as <code><a href="base.html#topic+besselK">besselK</a></code>. The other functions are
used in calculation of higher moments. See Barndorff-Nielsen, O. and
Blaesild, P (1981) for details of the calculations.
</p>
<p>The parameterisation of the hyperbolic distribution used for this
and other components of the <code>HyperbolicDist</code> package is the
<code class="reqn">(\pi,\zeta)</code> one. See <code>hyperbChangePars</code> to
transfer between parameterizations.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Richard Trendall,
Thomas Tran</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. and Blæsild, P (1981).
Hyperbolic distributions and ramifications: contributions to theory
and application.
In <em>Statistical Distributions in Scientific Work</em>,
eds., Taillie, C., Patil, G. P., and Baldessari, B. A., Vol. 4,
pp. 19&ndash;44. Dordrecht: Reidel.
</p>
<p>Barndorff-Nielsen, O. and Blæsild, P (1983).
Hyperbolic distributions.
In <em>Encyclopedia of Statistical Sciences</em>,
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dhyperb">dhyperb</a></code>,
<code><a href="#topic+hyperbMean">hyperbMean</a></code>,<code><a href="#topic+hyperbChangePars">hyperbChangePars</a></code>,
<code><a href="base.html#topic+besselK">besselK</a></code>
</p>

<hr>
<h2 id='Generalized+20Inverse+20Gaussian'>Generalized Inverse Gaussian Distribution</h2><span id='topic+dgig'></span><span id='topic+pgig'></span><span id='topic+qgig'></span><span id='topic+rgig'></span><span id='topic+rgig1'></span><span id='topic+ddgig'></span><span id='topic+gigBreaks'></span>

<h3>Description</h3>

<p>Density function, cumulative distribution function, quantile function
and random number generation for the generalized inverse Gaussian
distribution with parameter vector <code>Theta</code>. Utility routines are
included for the derivative of the density function and to find
suitable break points for use in determining the distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgig(x, Theta, KOmega = NULL)
pgig(q, Theta, small = 10^(-6), tiny = 10^(-10), deriv = 0.3,
     subdivisions = 100, accuracy = FALSE, ...)
qgig(p, Theta, small = 10^(-6), tiny = 10^(-10), deriv = 0.3,
     nInterpol = 100, subdivisions = 100, ...)
rgig(n, Theta)
rgig1(n, Theta)
ddgig(x, Theta, KOmega = NULL, ...)
gigBreaks (Theta, small = 10^(-6), tiny = 10^(-10), deriv = 0.3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_x">x</code>, <code id="Generalized+2B20Inverse+2B20Gaussian_+3A_q">q</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_n">n</code></td>
<td>
<p>Number of observations to be generated.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_theta">Theta</code></td>
<td>
<p>Parameter vector taking the form <code>c(lambda,chi,psi)</code>
for <code>rgig</code>, or <code>c(chi,psi)</code> for <code>rgig1</code>.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_komega">KOmega</code></td>
<td>
<p>Sets the value of the Bessel function in the density or
derivative of the density. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_small">small</code></td>
<td>
<p>Size of a small difference between the distribution
function and zero or one. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_tiny">tiny</code></td>
<td>
<p>Size of a tiny difference between the distribution
function and zero or one. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_deriv">deriv</code></td>
<td>
<p>Value between 0 and 1. Determines the point where the
derivative becomes substantial, compared to its maximum value. See
<b>Details</b>.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_accuracy">accuracy</code></td>
<td>
<p>Uses accuracy calculated by <code><a href="stats.html#topic+integrate">integrate</a></code>
to try and determine the accuracy of the distribution function
calculation.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_subdivisions">subdivisions</code></td>
<td>
<p>The maximum number of subdivisions used to integrate
the density returning the distribution function.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_ninterpol">nInterpol</code></td>
<td>
<p>The number of points used in qhyperb for cubic spline
interpolation (see <code>splinefun</code>) of the distribution function.</p>
</td></tr>
<tr><td><code id="Generalized+2B20Inverse+2B20Gaussian_+3A_...">...</code></td>
<td>
<p>Passes arguments to <code>uniroot</code>.  See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized inverse Gaussian distribution has density
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{(\psi/\chi)^{\frac{\lambda}{2}}}%
    {2K_\lambda(\sqrt{\psi\chi})}x^{\lambda-1}%
    e^{-\frac{1}{2}\left(\chi x^{-1}+\psi x\right)}</code>
</p>

<p>for <code class="reqn">x&gt;0</code>, where <code class="reqn">K_\lambda()</code> is the
modified Bessel function of the third kind with order
<code class="reqn">\lambda</code>.
</p>
<p>The generalized inverse Gaussian distribution is investigated in
detail in Jörgensen (1982).
</p>
<p>Use <code>gigChangePars</code> to convert from the
<code class="reqn">(\delta,\gamma)</code>,
<code class="reqn">(\alpha,\beta)</code>, or
<code class="reqn">(\omega,\eta)</code> parameterisations to the
<code class="reqn">(\chi,\psi)</code>, parameterisation used above.
</p>
<p><code>pgig</code> breaks the real line into eight regions in order to
determine the integral of <code>dgig</code>. The break points determining
the regions are found by <code>gigBreaks</code>, based on the values of
<code>small</code>, <code>tiny</code>, and <code>deriv</code>. In the extreme tails of
the distribution where the probability is <code>tiny</code> according to
<code>gigCalcRange</code>, the probability is taken to be zero.  For the
generalized inverse Gaussian distribution the leftmost breakpoint is
not affected by the value of <code>tiny</code> but is always taken as 0. In
the inner part of the distribution, the range is divided in 6 regions,
3 above the mode, and 3 below. On each side of the mode, there are two
break points giving the required three regions. The outer break point
is where the probability in the tail has the value given by the
variable <code>small</code>. The inner break point is where the derivative
of the density function is <code>deriv</code> times the maximum value of the
derivative on that side of the mode. In each of the 6 inner regions
the numerical integration routine <code><a href="#topic+safeIntegrate">safeIntegrate</a></code> (which
is a wrapper for <code><a href="stats.html#topic+integrate">integrate</a></code>) is used to integrate the
density <code>dgig</code>.
</p>
<p><code>qgig</code> use the breakup of the real line into the same 8
regions as <code>pgig</code>. For quantiles which fall in the 2 extreme
regions, the quantile is returned as <code>-Inf</code> or <code>Inf</code> as
appropriate. In the 6 inner regions <code>splinefun</code> is used to fit
values of the distribution function generated by <code>pgig</code>. The
quantiles are then found using the <code>uniroot</code> function.
</p>
<p><code>pgig</code> and <code>qgig</code> may generally be expected to be accurate
to 5 decimal places. Unfortunately, when <code>lambda</code> is less than
-0.5, the accuracy may be as little as 3 decimal places.
</p>
<p>Generalized inverse Gaussian observations are obtained via the
algorithm of Dagpunar (1989).
</p>


<h3>Value</h3>

<p><code>dgig</code> gives the density, <code>pgig</code> gives the distribution
function, <code>qgig</code> gives the quantile function, and <code>rgig</code>
generates random variates. <code>rgig1</code> generates random variates in
the special case where <code class="reqn">\lambda=1</code>. An estimate of the
accuracy of the approximation to the distribution function may be
found by setting <code>accuracy = TRUE</code> in the call to <code>phyperb</code>
which then returns a list with components <code>value</code> and
<code>error</code>.
</p>
<p><code>ddgig</code> gives the derivative of <code>dgig</code>.
</p>
<p><code>gigBreaks</code> returns a list with components:
</p>
<table>
<tr><td><code>xTiny</code></td>
<td>
<p>Takes value 0 always.</p>
</td></tr>
<tr><td><code>xSmall</code></td>
<td>
<p>Value such that probability to the left is less than
<code>small</code>.</p>
</td></tr>
<tr><td><code>lowBreak</code></td>
<td>
<p>Point to the left of the mode such that the
derivative of the density is <code>deriv</code> times its maximum value
on that side of the mode</p>
</td></tr>
<tr><td><code>highBreak</code></td>
<td>
<p>Point to the right of the mode such that the
derivative of the density is <code>deriv</code> times its maximum value
on that side of the mode</p>
</td></tr>
<tr><td><code>xLarge</code></td>
<td>
<p>Value such that probability to the right is less than
<code>small</code>.</p>
</td></tr>
<tr><td><code>xHuge</code></td>
<td>
<p>Value such that probability to the right is less than
<code>tiny</code>.</p>
</td></tr>
<tr><td><code>modeDist</code></td>
<td>
<p>The mode of the given generalized inverse Gaussian
distribution.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Richard Trendall,
and Melanie Luen.</p>


<h3>References</h3>

<p>Dagpunar, J.S. (1989). An easily implemented generalised inverse
Gaussian generator. <em>Commun. Statist. -Simula.</em>, <b>18</b>,
703&ndash;710.
</p>
<p>Jörgensen, B. (1982). <em>Statistical Properties of
the Generalized Inverse Gaussian Distribution</em>. Lecture Notes in
Statistics, Vol. 9, Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safeIntegrate">safeIntegrate</a></code>, <code><a href="stats.html#topic+integrate">integrate</a></code> for its
shortfalls, <code><a href="stats.html#topic+splinefun">splinefun</a></code>, <code><a href="stats.html#topic+uniroot">uniroot</a></code> and
<code><a href="#topic+gigChangePars">gigChangePars</a></code> for changing parameters to the
<code class="reqn">(\chi,\psi)</code> parameterisation, <code><a href="#topic+dghyp">dghyp</a></code> for
the generalized hyperbolic distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(1,2,3)
gigRange &lt;- gigCalcRange(Theta, tol = 10^(-3))
par(mfrow = c(1,2))
curve(dgig(x, Theta), from = gigRange[1], to = gigRange[2],
      n = 1000)
title("Density of the\n Generalized Inverse Gaussian")
curve(pgig(x, Theta), from = gigRange[1], to = gigRange[2],
      n = 1000)
title("Distribution Function of the\n Generalized Inverse Gaussian")
dataVector &lt;- rgig(500, Theta)
curve(dgig(x, Theta), range(dataVector)[1], range(dataVector)[2],
      n = 500)
hist(dataVector, freq = FALSE, add =TRUE)
title("Density and Histogram\n of the Generalized Inverse Gaussian")
logHist(dataVector, main =
   "Log-Density and Log-Histogram\n of the Generalized Inverse Gaussian")
curve(log(dgig(x, Theta)), add = TRUE,
      range(dataVector)[1], range(dataVector)[2], n = 500)
par(mfrow = c(2,1))
curve(dgig(x, Theta), from = gigRange[1], to = gigRange[2],
      n = 1000)
title("Density of the\n Generalized Inverse Gaussian")
curve(ddgig(x, Theta), from = gigRange[1], to = gigRange[2],
      n = 1000)
title("Derivative of the Density\n of the Generalized Inverse Gaussian")
par(mfrow = c(1,1))
gigRange &lt;- gigCalcRange(Theta, tol = 10^(-6))
curve(dgig(x, Theta), from = gigRange[1], to = gigRange[2],
      n = 1000)
bks &lt;- gigBreaks(Theta)
abline(v = bks)
</code></pre>

<hr>
<h2 id='GeneralizedHyperbolic'>Generalized Hyperbolic Distribution</h2><span id='topic+dghyp'></span><span id='topic+pghyp'></span><span id='topic+qghyp'></span><span id='topic+rghyp'></span><span id='topic+ddghyp'></span><span id='topic+ghypBreaks'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantiles and
random number generation for the generalized hyperbolic distribution
with parameter vector <code>Theta</code>. Utility routines are included for
the derivative of the density function and to find suitable break
points for use in determining the distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dghyp(x, Theta)
pghyp(q, Theta, small = 10^(-6), tiny = 10^(-10),
      deriv = 0.3, subdivisions = 100, accuracy = FALSE, ...)
qghyp(p, Theta, small = 10^(-6), tiny = 10^(-10),
      deriv = 0.3, nInterpol = 100, subdivisions = 100, ...)
rghyp(n, Theta)
ddghyp(x, Theta)
ghypBreaks(Theta, small = 10^(-6), tiny = 10^(-10), deriv = 0.3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GeneralizedHyperbolic_+3A_x">x</code>, <code id="GeneralizedHyperbolic_+3A_q">q</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_n">n</code></td>
<td>
<p>Number of observations to be generated.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_theta">Theta</code></td>
<td>
<p>Parameter vector taking the form
<code>c(lambda,alpha,beta,delta,mu)</code>.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_small">small</code></td>
<td>
<p>Size of a small difference between the distribution
function and zero or one. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_tiny">tiny</code></td>
<td>
<p>Size of a tiny difference between the distribution
function and zero or one. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_deriv">deriv</code></td>
<td>
<p>Value between 0 and 1. Determines the point where the
derivative becomes substantial, compared to its maximum value. See
<b>Details</b>.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_accuracy">accuracy</code></td>
<td>
<p>Uses accuracy calculated by~<code><a href="stats.html#topic+integrate">integrate</a></code>
to try and determine the accuracy of the distribution function
calculation.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_subdivisions">subdivisions</code></td>
<td>
<p>The maximum number of subdivisions used to
integrate the density returning the distribution function.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_ninterpol">nInterpol</code></td>
<td>
<p>The number of points used in qghyp for cubic spline
interpolation (see <code>splinefun</code>) of the distribution function.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolic_+3A_...">...</code></td>
<td>
<p>Passes arguments to <code>uniroot</code>.  See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized hyperbolic distribution has density
</p>
<p style="text-align: center;"><code class="reqn">f(x)=c(\lambda,\alpha,\beta,\delta)\times%
    \frac{K_{\lambda-1/2}(\alpha\sqrt{\delta^2+(x-\mu)^2})}%
    {(\sqrt{\delta^2+(x-\mu)^2}/\alpha)^{1/2-\lambda}}%
    e^{\beta(x-\mu)}</code>
</p>

<p>where <code class="reqn">K_\nu()</code> is the modified Bessel function of the
third kind with order <code class="reqn">\nu</code>, and
</p>
<p style="text-align: center;"><code class="reqn">c(\lambda,\alpha,\beta,\delta)=%
    \frac{(\sqrt{\alpha^2-\beta^2}/\delta)^\lambda}%
    {\sqrt{2\pi}K_\lambda(\delta\sqrt{\alpha^2-\beta^2})}</code>
</p>

<p>Use <code>ghypChangePars</code> to convert from the
<code class="reqn">(\zeta, \rho)</code>,
<code class="reqn">(\xi,\chi)</code>, or
<code class="reqn">(\bar\alpha,\bar\beta)</code> parameterisations
to the <code class="reqn">(\alpha, \beta)</code> parameterisation used
above.
</p>
<p><code>pghyp</code> breaks the real line into eight regions in order to
determine the integral of <code>dghyp</code>. The break points determining
the regions are found by <code>ghypBreaks</code>, based on the values of
<code>small</code>, <code>tiny</code>, and <code>deriv</code>. In the extreme tails of
the distribution where the probability is <code>tiny</code> according to
<code>ghypCalcRange</code>, the probability is taken to be zero.  In the
inner part of the distribution, the range is divided in 6 regions, 3
above the mode, and 3 below. On each side of the mode, there are two
break points giving the required three regions. The outer break point
is where the probability in the tail has the value given by the variable
<code>small</code>. The inner break point is where the derivative of the
density function is <code>deriv</code> times the maximum value of the
derivative on that side of the mode. In each of the 6 inner regions
the numerical integration routine <code><a href="#topic+safeIntegrate">safeIntegrate</a></code> (which
is a wrapper for <code><a href="stats.html#topic+integrate">integrate</a></code>) is used to integrate the
density <code>dghyp</code>.
</p>
<p><code>qghyp</code> use the breakup of the real line into the same 8
regions as <code>pghyp</code>. For quantiles which fall in the 2 extreme
regions, the quantile is returned as <code>-Inf</code> or <code>Inf</code> as
appropriate. In the 6 inner regions <code>splinefun</code> is used to fit
values of the distribution function generated by <code>pghyp</code>. The
quantiles are then found using the <code>uniroot</code> function.
</p>
<p><code>pghyp</code> and <code>qghyp</code> may generally be expected to be
accurate to 5 decimal places.
</p>
<p>The generalized hyperbolic distribution is discussed in Bibby and
Sörenson (2003). It can be represented as a particular
mixture of the normal distribution where the mixing distribution is the
generalized inverse Gaussian.  <code>rghyp</code> uses this representation
to generate observations from the generalized hyperbolic
distribution. Generalized inverse Gaussian observations are obtained
via the algorithm of Dagpunar (1989) which is implemented in
<code>rgig</code>.
</p>


<h3>Value</h3>

<p><code>dghyp</code> gives the density, <code>pghyp</code> gives the distribution
function, <code>qghyp</code> gives the quantile function and <code>rghyp</code>
generates random variates. An estimate of the accuracy of the
approximation to the distribution function may be found by setting
<code>accuracy=TRUE</code> in the call to <code>pghyp</code> which then returns
a list with components <code>value</code> and <code>error</code>.
</p>
<p><code>ddghyp</code> gives the derivative of <code>dghyp</code>.
</p>
<p><code>ghypBreaks</code> returns a list with components:
</p>
<table>
<tr><td><code>xTiny</code></td>
<td>
<p>Value such that probability to the left is less than
<code>tiny</code>.</p>
</td></tr>
<tr><td><code>xSmall</code></td>
<td>
<p>Value such that probability to the left is less than
<code>small</code>.</p>
</td></tr>
<tr><td><code>lowBreak</code></td>
<td>
<p>Point to the left of the mode such that the
derivative of the density is <code>deriv</code> times its maximum value
on that side of the mode.</p>
</td></tr>
<tr><td><code>highBreak</code></td>
<td>
<p>Point to the right of the mode such that the
derivative of the density is <code>deriv</code> times its maximum value
on that side of the mode.</p>
</td></tr>
<tr><td><code>xLarge</code></td>
<td>
<p>Value such that probability to the right is less than
<code>small</code>.</p>
</td></tr>
<tr><td><code>xHuge</code></td>
<td>
<p>Value such that probability to the right is less than
<code>tiny</code>.</p>
</td></tr>
<tr><td><code>modeDist</code></td>
<td>
<p>The mode of the given generalized hyperbolic distribution.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Richard Trendall</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. and Blæsild, P (1983).
Hyperbolic distributions.
In <em>Encyclopedia of Statistical Sciences</em>,
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley.
</p>
<p>Bibby, B. M. and Sörenson, M. (2003).
Hyperbolic processes in finance.
In <em>Handbook of Heavy Tailed Distributions in Finance</em>, ed.,
Rachev, S. T. pp. 212&ndash;248. Elsevier Science B.~V.
</p>
<p>Dagpunar, J.S. (1989).
An easily implemented generalised inverse Gaussian generator
<em>Commun. Statist. -Simula.</em>, <b>18</b>, 703&ndash;710.
</p>
<p>Prause, K. (1999) <em>The generalized hyperbolic models: Estimation,
financial derivatives and risk measurement.</em> PhD Thesis, Mathematics
Faculty, University of Freiburg.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dhyperb">dhyperb</a></code> for the hyperbolic distribution,
<code><a href="#topic+dgig">dgig</a></code> for the generalized inverse Gaussian distribution
<code><a href="#topic+safeIntegrate">safeIntegrate</a></code>, <code><a href="stats.html#topic+integrate">integrate</a></code> for its
shortfalls, <code><a href="stats.html#topic+splinefun">splinefun</a></code>,
<code><a href="stats.html#topic+uniroot">uniroot</a></code> and <code><a href="#topic+ghypChangePars">ghypChangePars</a></code> for
changing parameters to the <code class="reqn">(\alpha,\beta)</code>
parameterisation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(1/2,3,1,1,0)
ghypRange &lt;- ghypCalcRange(Theta, tol = 10^(-3))
par(mfrow = c(1,2))
curve(dghyp(x, Theta), from = ghypRange[1], to = ghypRange[2],
      n = 1000)
title("Density of the\n Generalized Hyperbolic Distribution")
curve(pghyp(x, Theta), from = ghypRange[1], to = ghypRange[2],
      n = 1000)
title("Distribution Function of the\n Generalized Hyperbolic Distribution")
dataVector &lt;- rghyp(500, Theta)
curve(dghyp(x, Theta), range(dataVector)[1], range(dataVector)[2],
      n = 500)
hist(dataVector, freq = FALSE, add =TRUE)
title("Density and Histogram of the\n Generalized Hyperbolic Distribution")
logHist(dataVector, main =
   "Log-Density and Log-Histogramof the\n Generalized Hyperbolic Distribution")
curve(log(dghyp(x, Theta)), add = TRUE,
      range(dataVector)[1], range(dataVector)[2], n = 500)
par(mfrow = c(2,1))
curve(dghyp(x, Theta), from = ghypRange[1], to = ghypRange[2],
      n = 1000)
title("Density of the\n Generalized Hyperbolic Distribution")
curve(ddghyp(x, Theta), from = ghypRange[1], to = ghypRange[2],
      n = 1000)
title("Derivative of the Density of the\n Generalized Hyperbolic Distribution")
par(mfrow = c(1,1))
ghypRange &lt;- ghypCalcRange(Theta, tol = 10^(-6))
curve(dghyp(x, Theta), from = ghypRange[1], to = ghypRange[2],
      n = 1000)
bks &lt;- ghypBreaks(Theta)
abline(v = bks)
</code></pre>

<hr>
<h2 id='GeneralizedHyperbolicPlots'>Generalized Hyperbolic Quantile-Quantile and Percent-Percent Plots</h2><span id='topic+qqghyp'></span><span id='topic+ppghyp'></span>

<h3>Description</h3>

<p><code>qqghyp</code> produces a generalized hyperbolic Q-Q plot of the values in
<code>y</code>.
</p>
<p><code>ppghyp</code> produces a generalized hyperbolic P-P (percent-percent) or
probability plot of the values in <code>y</code>.	
</p>
<p>Graphical parameters may be given as arguments to <code>qqghyp</code>,
and <code>ppghyp</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqghyp(y, Theta, main = "Generalized Hyperbolic Q-Q Plot",
  xlab = "Theoretical Quantiles",
  ylab = "Sample Quantiles",
  plot.it = TRUE, line = TRUE, ...)

ppghyp(y, Theta, main = "Generalized Hyperbolic P-P Plot",
  xlab = "Uniform Quantiles",
  ylab = "Probability-integral-transformed Data",
  plot.it = TRUE, line = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GeneralizedHyperbolicPlots_+3A_y">y</code></td>
<td>
<p>The data sample.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolicPlots_+3A_theta">Theta</code></td>
<td>
<p>Parameters of the generalized hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolicPlots_+3A_xlab">xlab</code>, <code id="GeneralizedHyperbolicPlots_+3A_ylab">ylab</code>, <code id="GeneralizedHyperbolicPlots_+3A_main">main</code></td>
<td>
<p>Plot labels.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolicPlots_+3A_plot.it">plot.it</code></td>
<td>
<p>Logical. Should the result be plotted?</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolicPlots_+3A_line">line</code></td>
<td>
<p>Add line through origin with unit slope.</p>
</td></tr>
<tr><td><code id="GeneralizedHyperbolicPlots_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>qqghyp</code> and <code>ppghyp</code>, a list with components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The x coordinates of the points that are to be plotted.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The y coordinates of the points that are to be plotted.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilk, M. B. and Gnanadesikan, R. (1968)
Probability plotting methods for the analysis of data.
<em>Biometrika</em>.
<b>55</b>, 1&ndash;17.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ppoints">ppoints</a></code>, <code><a href="#topic+dghyp">dghyp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfrow = c(1,2))
y &lt;- rghyp(200, c(2,2,1,2,2))
qqghyp(y, c(2,2,1,2,2),line = FALSE)
abline(0, 1, col = 2)
ppghyp(y, c(2,2,1,2,2))
</code></pre>

<hr>
<h2 id='ghypCalcRange'>Range of a Generalized Hyperbolic Distribution</h2><span id='topic+ghypCalcRange'></span>

<h3>Description</h3>

<p>Given the parameter vector Theta of a generalized hyperbolic distribution,
this function determines the range outside of which the density
function is negligible, to a specified tolerance. The parameterization used
is the <code class="reqn">(\alpha,\beta)</code> one (see
<code><a href="#topic+dghyp">dghyp</a></code>). To use another parameterization, use
<code><a href="#topic+ghypChangePars">ghypChangePars</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ghypCalcRange(Theta, tol = 10^(-5), density = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghypCalcRange_+3A_theta">Theta</code></td>
<td>
<p>Value of parameter vector specifying the hyperbolic
distribution.</p>
</td></tr>
<tr><td><code id="ghypCalcRange_+3A_tol">tol</code></td>
<td>
<p>Tolerance.</p>
</td></tr>
<tr><td><code id="ghypCalcRange_+3A_density">density</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the bounds are for the density
function. If <code>FALSE</code>, they should be for the probability
distribution, but this has not yet been implemented.</p>
</td></tr>
<tr><td><code id="ghypCalcRange_+3A_...">...</code></td>
<td>
<p>Extra arguments for calls to <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The particular generalized hyperbolic distribution being considered is
specified by the value of the parameter value <code>Theta</code>.
</p>
<p>If <code>density = TRUE</code>, the function gives a range, outside of which
the density is less than the given tolerance. Useful for plotting the
density. Also used in determining break points for the separate
sections over which numerical integration is used to determine the
distribution function. The points are found by using
<code><a href="stats.html#topic+uniroot">uniroot</a></code> on the density function.
</p>
<p>If <code>density = FALSE</code>, the function returns the message:
&quot;<code>Distribution function bounds not yet implemented</code>&quot;.
</p>


<h3>Value</h3>

<p>A two-component vector giving the lower and upper ends of the range.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a></p>


<h3>References</h3>

 
<p>Barndorff-Nielsen, O. and Blæsild, P (1983).
Hyperbolic distributions. 
In <em>Encyclopedia of Statistical Sciences</em>, 
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dghyp">dghyp</a></code>, <code><a href="#topic+ghypChangePars">ghypChangePars</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(1,5,3,1,0)
maxDens &lt;- dghyp(ghypMode(Theta), Theta)
ghypRange &lt;- ghypCalcRange(Theta, tol = 10^(-3)*maxDens)
ghypRange
curve(dghyp(x, Theta), ghypRange[1], ghypRange[2])
## Not run: ghypCalcRange(Theta, tol = 10^(-3), density = FALSE)
</code></pre>

<hr>
<h2 id='ghypChangePars'>Change Parameterizations of the Generalized Hyperbolic Distribution</h2><span id='topic+ghypChangePars'></span>

<h3>Description</h3>

<p>This function interchanges between the following 4 parameterizations
of the generalized hyperbolic distribution:
</p>
<p>1. <code class="reqn">\lambda, \alpha, \beta, \delta, \mu</code>
</p>
<p>2. <code class="reqn">\lambda, \zeta, \rho, \delta, \mu</code>
</p>
<p>3. <code class="reqn">\lambda, \xi, \chi, \delta, \mu</code>
</p>
<p>4. <code class="reqn">\lambda, \bar\alpha, \bar\beta, \delta, \mu</code>
</p>
<p>These are the parameterizations given in Prause (1999)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ghypChangePars(from, to, Theta, noNames = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghypChangePars_+3A_from">from</code></td>
<td>
<p>The set of parameters to change from.</p>
</td></tr>
<tr><td><code id="ghypChangePars_+3A_to">to</code></td>
<td>
<p>The set of parameters to change to.</p>
</td></tr>
<tr><td><code id="ghypChangePars_+3A_theta">Theta</code></td>
<td>
<p>&quot;from&quot; parameter vector consisting of 5 numerical elements.</p>
</td></tr>
<tr><td><code id="ghypChangePars_+3A_nonames">noNames</code></td>
<td>
<p>Logical. When <code>TRUE</code>, suppresses the parameter
<code>names</code> in the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the 4 parameterizations, the following must be positive:
</p>
<p>1. <code class="reqn">\alpha, \delta</code>
</p>
<p>2. <code class="reqn">\zeta, \delta</code>
</p>
<p>3. <code class="reqn">\xi, \delta</code>
</p>
<p>4. <code class="reqn">\bar\alpha, \delta</code>
</p>
<p>Furthermore, note that in the first parameterization
<code class="reqn">\alpha</code> must be greater than the absolute value of
<code class="reqn">\beta</code>; in the third parameterization, <code class="reqn">\xi</code>
must be less than one, and the absolute value of <code class="reqn">\chi</code> must
be less than <code class="reqn">\xi</code>; and in the fourth parameterization,
<code class="reqn">\bar\alpha</code> must be greater than the absolute value of
<code class="reqn">\bar\beta</code>.
</p>


<h3>Value</h3>

<p>A numerical vector of length 5 representing <code>Theta</code> in the
<code>to</code> parameterization.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Jennifer Tso, Richard Trendall</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. and Blæsild, P. (1983).
Hyperbolic distributions.
In <em>Encyclopedia of Statistical Sciences</em>,
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley.
</p>
<p>Prause, K. (1999) <em>The generalized hyperbolic models: Estimation,
financial derivatives and risk measurement.</em> PhD Thesis, Mathematics
Faculty, University of Freiburg.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dghyp">dghyp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta1 &lt;- c(2,2,1,3,0)                   # Parameterization 1
Theta2 &lt;- ghypChangePars(1, 2, Theta1)   # Convert to parameterization 2
Theta2                                   # Parameterization 2
ghypChangePars(2, 1, as.numeric(Theta2)) # Convert back to parameterization 1
</code></pre>

<hr>
<h2 id='ghypMom'>Calculate Moments of the Generalized Hyperbolic Distribution</h2><span id='topic+ghypMom'></span>

<h3>Description</h3>

<p>This function can be used to calculate raw moments, mu moments,
central moments and moments about any other given location for the
generalized hyperbolic distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ghypMom(order, Theta, momType = "raw", about = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghypMom_+3A_order">order</code></td>
<td>
<p>Numeric. The order of the moment to be calculated. Not
permitted to be a vector. Must be a positive whole number except for
moments about zero.</p>
</td></tr>
<tr><td><code id="ghypMom_+3A_theta">Theta</code></td>
<td>
<p>Numeric. The parameter vector specifying the GIG
distribution. Of the form <code>c(lambda, alpha, beta, delta, mu)</code>
(see <code><a href="#topic+dghyp">dghyp</a></code>).</p>
</td></tr>
<tr><td><code id="ghypMom_+3A_momtype">momType</code></td>
<td>
<p>Common types of moments to be calculated, default is &quot;raw&quot;.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="ghypMom_+3A_about">about</code></td>
<td>
<p>Numeric. The point around which the moment is to be
calculated, default is 0. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Checking whether <code>order</code> is a whole number is carried out using
the function <code><a href="#topic+is.wholenumber">is.wholenumber</a></code>.
</p>
<p><code>momType</code> can be either &quot;raw&quot; (moments about zero), &quot;mu&quot; (moments
about mu), or &quot;central&quot; (moments about mean). If one of these moment
types is specified, then there is no need to specify the <code>about</code>
value. For moments about any other location, the <code>about</code> value
must be specified. In the case that both <code>momType</code> and
<code>about</code> are specified and contradicting, the function will always
calculate the moments based on <code>about</code> rather than
<code>momType</code>.
</p>
<p>To calculate moments of the generalized hyperbolic distribution, the
function first calculates mu moments by the formula defined below and
then transforms mu moments to central moments or raw moments or
moments about any other location as required by calling
<code>momChangeAbout</code>.
</p>
<p>The mu moments are obtained from the recursion formula given in Scott,
Würtz and Tran (2008).
</p>


<h3>Value</h3>

<p>The moment specified.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a></p>


<h3>References</h3>

<p>Scott, D. J., Würtz, D. and Tran, T. T. (2008)
Moments of the Generalized Hyperbolic Distribution. Preprint.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ghypChangePars">ghypChangePars</a></code>, <code><a href="#topic+is.wholenumber">is.wholenumber</a></code>,
<code><a href="#topic+momChangeAbout">momChangeAbout</a></code>, <code><a href="#topic+momIntegrated">momIntegrated</a></code>,
<code><a href="#topic+ghypMean">ghypMean</a></code>, <code><a href="#topic+ghypVar">ghypVar</a></code>, <code><a href="#topic+ghypSkew">ghypSkew</a></code>,
<code><a href="#topic+ghypKurt">ghypKurt</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(2,2,1,2,1)
mu &lt;- Theta[5]
### mu moments
(m1 &lt;- ghypMean(Theta))
m1 - mu
ghypMom(1, Theta, momType = "mu")
momIntegrated("ghyp", order = 1, param = Theta, about = mu)
ghypMom(2, Theta, momType = "mu")
momIntegrated("ghyp", order = 2, param = Theta, about = mu)
ghypMom(10, Theta, momType = "mu")
momIntegrated("ghyp", order = 10, param = Theta, about = mu)

### raw moments
ghypMean(Theta)
ghypMom(1, Theta, momType = "raw")
momIntegrated("ghyp", order = 1, param = Theta, about = 0)
ghypMom(2, Theta, momType = "raw")
momIntegrated("ghyp", order = 2, param = Theta, about = 0)
ghypMom(10, Theta, momType = "raw")
momIntegrated("ghyp", order = 10, param = Theta, about = 0)

### central moments
ghypMom(1, Theta, momType = "central")
momIntegrated("ghyp", order = 1, param = Theta, about = m1)
ghypVar(Theta)
ghypMom(2, Theta, momType = "central")
momIntegrated("ghyp", order = 2, param = Theta, about = m1)
ghypMom(10, Theta, momType = "central")
momIntegrated("ghyp", order = 10, param = Theta, about = m1)

</code></pre>

<hr>
<h2 id='gigCalcRange'>Range of a Generalized Inverse Gaussian Distribution</h2><span id='topic+gigCalcRange'></span>

<h3>Description</h3>

<p>Given the parameter vector Theta of a generalized inverse Gaussian
distribution, this function determines the range outside of which the density
function is negligible, to a specified tolerance. The parameterization
used is the <code class="reqn">(\chi,\psi)</code> one (see
<code><a href="#topic+dgig">dgig</a></code>). To use another parameterization, use
<code><a href="#topic+gigChangePars">gigChangePars</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gigCalcRange(Theta, tol = 10^(-5), density = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gigCalcRange_+3A_theta">Theta</code></td>
<td>
<p>Value of parameter vector specifying the generalized
inverse Gaussian distribution.</p>
</td></tr>
<tr><td><code id="gigCalcRange_+3A_tol">tol</code></td>
<td>
<p>Tolerance.</p>
</td></tr>
<tr><td><code id="gigCalcRange_+3A_density">density</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the bounds are for the density
function. If <code>FALSE</code>, they should be for the probability
distribution, but this has not yet been implemented.</p>
</td></tr>
<tr><td><code id="gigCalcRange_+3A_...">...</code></td>
<td>
<p>Extra arguments for calls to <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The particular generalized inverse Gaussian distribution being
considered is specified by the value of the parameter value
<code>Theta</code>.
</p>
<p>If <code>density = TRUE</code>, the function gives a range, outside of which
the density is less than the given tolerance. Useful for plotting the
density. Also used in determining break points for the separate
sections over which numerical integration is used to determine the
distribution function. The points are found by using
<code><a href="stats.html#topic+uniroot">uniroot</a></code> on the density function.
</p>
<p>If <code>density = FALSE</code>, the function returns the message:
&quot;<code>Distribution function bounds not yet implemented</code>&quot;.
</p>


<h3>Value</h3>

<p>A two-component vector giving the lower and upper ends of the range.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a></p>


<h3>References</h3>

<p>Jörgensen, B. (1982).
<em>Statistical Properties of the Generalized Inverse Gaussian
Distribution</em>.
Lecture Notes in Statistics, Vol. 9, Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgig">dgig</a></code>, <code><a href="#topic+gigChangePars">gigChangePars</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(-0.5,5,2.5)
maxDens &lt;- dgig(gigMode(Theta), Theta)
gigRange &lt;- gigCalcRange(Theta, tol = 10^(-3)*maxDens)
gigRange
curve(dgig(x, Theta), gigRange[1], gigRange[2])
## Not run: gigCalcRange(Theta, tol = 10^(-3), density = FALSE)
</code></pre>

<hr>
<h2 id='gigChangePars'>Change Parameterizations of the Generalized Inverse Gaussian
Distribution</h2><span id='topic+gigChangePars'></span>

<h3>Description</h3>

<p>This function interchanges between the following 4 parameterizations
of the generalized inverse Gaussian distribution:
</p>
<p>1. <code class="reqn">(\lambda,\chi,\psi)</code>
</p>
<p>2. <code class="reqn">(\lambda,\delta,\gamma)</code>
</p>
<p>3. <code class="reqn">(\lambda,\alpha,\beta)</code>
</p>
<p>4. <code class="reqn">(\lambda,\omega,\eta)</code>
</p>
<p>See Jörgensen (1982) and Dagpunar (1989)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gigChangePars(from, to, Theta, noNames = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gigChangePars_+3A_from">from</code></td>
<td>
<p>The set of parameters to change from.</p>
</td></tr>
<tr><td><code id="gigChangePars_+3A_to">to</code></td>
<td>
<p>The set of parameters to change to.</p>
</td></tr>
<tr><td><code id="gigChangePars_+3A_theta">Theta</code></td>
<td>
<p>&ldquo;<code>from</code>&rdquo; parameter vector consisting of 3
numerical elements.</p>
</td></tr>
<tr><td><code id="gigChangePars_+3A_nonames">noNames</code></td>
<td>
<p>Logical. When <code>TRUE</code>, suppresses the parameter
<code>names</code> in the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The range of <code class="reqn">\lambda</code> is the whole real line.
In each parameterization, the other two parameters must take positive
values.
</p>


<h3>Value</h3>

<p>A numerical vector of length 3 representing <code>Theta</code> in the
&ldquo;<code>to</code>&rdquo; parameterization.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a></p>


<h3>References</h3>

<p>Jörgensen, B. (1982).
<em>Statistical Properties of the Generalized Inverse Gaussian
Distribution</em>.
Lecture Notes in Statistics, Vol. 9, Springer-Verlag, New York.
</p>
<p>Dagpunar, J. S. (1989).
An easily implemented generalised inverse Gaussian generator,
<em>Commun. Statist.&mdash;Simula.</em>, <b>18</b>, 703&ndash;710.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgig">dgig</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta1 &lt;- c(-0.5,5,2.5)                 # Parameterisation 1
Theta2 &lt;- gigChangePars(1, 2, Theta1)   # Convert to parameterization 2
Theta2                                  # Parameterization 2
gigChangePars(2, 1, as.numeric(Theta2)) # Convert back to parameterization 1
</code></pre>

<hr>
<h2 id='gigCheckPars'>Check Parameters of the Generalized Inverse Gaussian Distribution</h2><span id='topic+gigCheckPars'></span>

<h3>Description</h3>

<p>Given a putative set of parameters for the generalized inverse Gaussian
distribution, the functions checks if they are in the correct range,
and if they correspond to the boundary cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gigCheckPars(Theta, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gigCheckPars_+3A_theta">Theta</code></td>
<td>
<p>Numeric. Putative parameter values for a generalized
inverse Gaussian distribution.</p>
</td></tr>
<tr><td><code id="gigCheckPars_+3A_...">...</code></td>
<td>
<p>Further arguments for calls to <code>all.equal</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector <code>Theta</code> takes the form <code>c(lambda,chi,psi)</code>.
</p>
<p>If either <code>chi</code> or <code>psi</code> is negative, an error is returned.
</p>
<p>If <code>chi</code> is 0 (to within tolerance allowed by <code>all.equal</code>)
then <code>psi</code> and <code>lambda</code> must be positive or an error is
returned. If these conditions are satisfied, the distribution is
identified as a gamma distribution.
</p>
<p>If <code>psi</code> is 0 (to within tolerance allowed by <code>all.equal</code>)
then <code>chi</code> must be positive and <code>lambda</code> must be negative or
an error is returned. If these conditions are satisfied, the
distribution is identified as an inverse gamma distribution.
</p>
<p>If both <code>chi</code> and <code>psi</code> are positive, then the distribution
is identified as a normal generalized inverse Gaussian distribution.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>case</code></td>
<td>
<p>Whichever of <code>'error'</code>, <code>'gamma'</code>,
<code>invgamma</code>, or <code>'normal'</code> is identified by the function.</p>
</td></tr>
<tr><td><code>errMessage</code></td>
<td>
<p>An appropriate error message if an error was found,
the empty string <code>""</code> otherwise.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a></p>


<h3>References</h3>

<p>Paolella, Marc S. (2007)
Intermediate Probability: A Computational Approach,
Chichester: Wiley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgig">dgig</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>gigCheckPars(c(-0.5,5,2.5))      # normal
gigCheckPars(c(0.5,-5,2.5))      # error
gigCheckPars(c(0.5,5,-2.5))      # error
gigCheckPars(c(0.5,-5,-2.5))     # error
gigCheckPars(c(0.5,0,2.5))       # gamma
gigCheckPars(c(-0.5,0,2.5))      # error
gigCheckPars(c(0.5,0,0))         # error
gigCheckPars(c(-0.5,0,0))        # error
gigCheckPars(c(0.5,5,0))         # error
gigCheckPars(c(-0.5,5,0))        # invgamma
</code></pre>

<hr>
<h2 id='gigMom'>Calculate Moments of the Generalized Inverse Gaussian Distribution</h2><span id='topic+gigMom'></span><span id='topic+gigRawMom'></span><span id='topic+gammaRawMom'></span>

<h3>Description</h3>

<p>Functions to calculate raw moments and moments about a given location
for the generalized inverse Gaussian (GIG) distribution, including the
gamma and inverse gamma distributions as special cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gigRawMom(order, Theta)
gigMom(order, Theta, about = 0)
gammaRawMom(order, shape = 1, rate = 1, scale = 1/rate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gigMom_+3A_order">order</code></td>
<td>
<p>Numeric. The order of the moment to be calculated. Not
permitted to be a vector. Must be a positive whole number except for
moments about zero.</p>
</td></tr>
<tr><td><code id="gigMom_+3A_theta">Theta</code></td>
<td>
<p>Numeric. The parameter vector specifying the GIG
distribution. Of the form <code>c(lambda, chi, psi)</code> (see
<code><a href="#topic+dgig">dgig</a></code>).</p>
</td></tr>
<tr><td><code id="gigMom_+3A_about">about</code></td>
<td>
<p>Numeric. The point around which the moment is to be
calculated.</p>
</td></tr>
<tr><td><code id="gigMom_+3A_shape">shape</code></td>
<td>
<p>Numeric. The shape parameter, must be non-negative, not
permitted to be a vector.</p>
</td></tr>
<tr><td><code id="gigMom_+3A_scale">scale</code></td>
<td>
<p>Numeric. The scale parameter, must be positive, not
permitted to be a vector.</p>
</td></tr>
<tr><td><code id="gigMom_+3A_rate">rate</code></td>
<td>
<p>Numeric. The rate parameter, an alternative way to specify
the scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector <code>Theta</code> of parameters is examined using
<code><a href="#topic+gigCheckPars">gigCheckPars</a></code> to see if the parameters are valid for the GIG
distribution and if they correspond to the special cases which are the
gamma and inverse gamma distributions. Checking of special cases and
valid parameter vector values is carried out using the function
<code><a href="#topic+gigCheckPars">gigCheckPars</a></code>. Checking whether <code>order</code>
is a whole number is carried out using the function
<code><a href="#topic+is.wholenumber">is.wholenumber</a></code>.
</p>
<p>Raw moments (moments about zero) are calculated using the
functions <code>gigRawMom</code> or <code>gammaRawMom</code>. For moments not
about zero, the function <code><a href="#topic+momChangeAbout">momChangeAbout</a></code> is used to
derive moments about another point from raw moments. Note that raw moments
of the inverse gamma distribution can be obtained from the raw moments
of the gamma distribution because of the relationship between the two
distributions. An alternative implementation of raw moments of the gamma
and inverse gamma distributions may be found in the package
<span class="pkg">actuar</span> and these may be faster since they are written in C.
</p>
<p>To calculate the raw moments of the GIG distribution it is convenient to
use the alternative parameterization of the GIG in terms of
<code class="reqn">\omega</code> and <code class="reqn">\eta</code>, given as parameterization 3
in <code><a href="#topic+gigChangePars">gigChangePars</a></code>. Then the raw moment of the GIG
distribution of order <code class="reqn">k</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\eta^k K_{\lambda+k}(\omega)/K_{\lambda}(\omega)</code>
</p>

<p>where <code class="reqn">K_\lambda()</code> is the modified Bessel function of
the third kind of order <code class="reqn">\lambda</code>.
</p>
<p>The raw moment of the gamma distribution of order <code class="reqn">k</code> with
shape parameter <code class="reqn">\alpha</code> and rate parameter
<code class="reqn">\beta</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\beta^{-k}\Gamma(\alpha+k)/\Gamma(\alpha)</code>
</p>

<p>The raw moment of order <code class="reqn">k</code> of the inverse gamma distribution
with shape parameter <code class="reqn">\alpha</code> and rate parameter
<code class="reqn">\beta</code> is the raw moment of order <code class="reqn">-k</code> of the gamma
distribution with shape parameter <code class="reqn">\alpha</code> and rate parameter
<code class="reqn">1/\beta</code>.
</p>


<h3>Value</h3>

<p>The moment specified. In the case of raw moments, <code>Inf</code> is
returned if the moment is infinite.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a></p>


<h3>References</h3>

<p>Paolella, Marc S. (2007)
Intermediate Probability: A Computational Approach,
Chichester: Wiley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gigCheckPars">gigCheckPars</a></code>, <code><a href="#topic+gigChangePars">gigChangePars</a></code>,
<code><a href="#topic+is.wholenumber">is.wholenumber</a></code>, <code><a href="#topic+momChangeAbout">momChangeAbout</a></code>,
<code><a href="#topic+momIntegrated">momIntegrated</a></code>, <code><a href="#topic+gigMean">gigMean</a></code>,
<code><a href="#topic+gigVar">gigVar</a></code>, <code><a href="#topic+gigSkew">gigSkew</a></code>, <code><a href="#topic+gigKurt">gigKurt</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Raw moments of the generalized inverse Gaussian distribution
Theta &lt;- c(-0.5,5,2.5)
gigRawMom(1, Theta)
momIntegrated("gig", order = 1, param = Theta, about = 0)
gigRawMom(2, Theta)
momIntegrated("gig", order = 2, param = Theta, about = 0)
gigRawMom(10, Theta)
momIntegrated("gig", order = 10, param = Theta, about = 0)
gigRawMom(2.5, Theta)

### Moments of the generalized inverse Gaussian distribution
Theta &lt;- c(-0.5,5,2.5)
(m1 &lt;- gigRawMom(1, Theta))
gigMom(1, Theta)
gigMom(2, Theta, m1)
(m2 &lt;- momIntegrated("gig", order = 2, param = Theta, about = m1))
gigMom(1, Theta, m1)
gigMom(3, Theta, m1)
momIntegrated("gig", order = 3, param = Theta, about = m1)

### Raw moments of the gamma distribution
shape &lt;- 2
rate &lt;- 3
Theta &lt;- c(shape, rate)
gammaRawMom(1, shape, rate)
momIntegrated("gamma", order = 1, param = Theta, about = 0)
gammaRawMom(2, shape, rate)
momIntegrated("gamma", order = 2, param = Theta, about = 0)
gammaRawMom(10, shape, rate)
momIntegrated("gamma", order = 10, param = Theta, about = 0)

### Moments of the inverse gamma distribution
Theta &lt;- c(-0.5,5,0)
gigRawMom(2, Theta)              # Inf
gigRawMom(-2, Theta)
momIntegrated("invgamma", order = -2,
              param = c(-Theta[1],Theta[2]/2), about = 0)

### An example where the moment is infinite: inverse gamma
Theta &lt;- c(-0.5,5,0)
gigMom(1, Theta)
gigMom(2, Theta)
</code></pre>

<hr>
<h2 id='GIGPlots'>Generalized Inverse Gaussian Quantile-Quantile and Percent-Percent Plots</h2><span id='topic+qqgig'></span><span id='topic+ppgig'></span>

<h3>Description</h3>

<p><code>qqgig</code> produces a generalized inverse Gaussian QQ plot of the
values in <code>y</code>.
</p>
<p><code>ppgig</code> produces a generalized inverse Gaussian PP (percent-percent) or
probability plot of the values in <code>y</code>.
</p>
<p>If <code>line = TRUE</code>, a line with zero intercept and unit slope is
added to the plot.
</p>
<p>Graphical parameters may be given as arguments to <code>qqgig</code>, and
<code>ppgig</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqgig(y, Theta, main = "GIG Q-Q Plot",
  xlab = "Theoretical Quantiles",
  ylab = "Sample Quantiles",
  plot.it = TRUE, line = TRUE, ...)

ppgig(y, Theta, main = "GIG P-P Plot",
  xlab = "Uniform Quantiles",
  ylab = "Probability-integral-transformed Data",
  plot.it = TRUE, line = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GIGPlots_+3A_y">y</code></td>
<td>
<p>The data sample.</p>
</td></tr>
<tr><td><code id="GIGPlots_+3A_theta">Theta</code></td>
<td>
<p>Parameters of the generalized inverse Gaussian distribution.</p>
</td></tr>
<tr><td><code id="GIGPlots_+3A_xlab">xlab</code>, <code id="GIGPlots_+3A_ylab">ylab</code>, <code id="GIGPlots_+3A_main">main</code></td>
<td>
<p>Plot labels.</p>
</td></tr>
<tr><td><code id="GIGPlots_+3A_plot.it">plot.it</code></td>
<td>
<p>Logical.  TRUE denotes the results should be plotted.</p>
</td></tr>
<tr><td><code id="GIGPlots_+3A_line">line</code></td>
<td>
<p>Logical. If TRUE, a line with zero intercept and unit slope
is added to the plot.</p>
</td></tr>
<tr><td><code id="GIGPlots_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>qqgig</code> and <code>ppgig</code>, a list with components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The x coordinates of the points that are be plotted.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The y coordinates of the points that are be plotted.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilk, M. B. and Gnanadesikan, R. (1968)
Probability plotting methods for the analysis of data.
<em>Biometrika</em>.
<b>55</b>, 1&ndash;17.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ppoints">ppoints</a></code>, <code><a href="#topic+dgig">dgig</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfrow=c(1,2))
y &lt;- rgig(1000,c(1,2,3))
qqgig(y,c(1,2,3),line=FALSE)
abline(0,1,col=2)
ppgig(y,c(1,2,3))
</code></pre>

<hr>
<h2 id='hyperbCalcRange'>Range of a Hyperbolic Distribution</h2><span id='topic+hyperbCalcRange'></span>

<h3>Description</h3>

<p>Given the parameter vector Theta of a hyperbolic distribution,
this function calculates the range outside of which the distribution
has negligible probability, or the density function is negligible, to
a specified tolerance. The parameterization used
is the <code class="reqn">(\pi,\zeta)</code> one (see
<code><a href="#topic+dhyperb">dhyperb</a></code>). To use another parameterization, use
<code><a href="#topic+hyperbChangePars">hyperbChangePars</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyperbCalcRange(Theta, tol = 10^(-5), density = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hyperbCalcRange_+3A_theta">Theta</code></td>
<td>
<p>Value of parameter vector specifying the hyperbolic
distribution.</p>
</td></tr>
<tr><td><code id="hyperbCalcRange_+3A_tol">tol</code></td>
<td>
<p>Tolerance.</p>
</td></tr>
<tr><td><code id="hyperbCalcRange_+3A_density">density</code></td>
<td>
<p>Logical. If <code>FALSE</code>, the bounds are for the probability
distribution. If <code>TRUE</code>, they are for the density function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The particular hyperbolic distribution being considered is specified
by the value of the parameter value <code>Theta</code>.
</p>
<p>If <code>density = FALSE</code>, the function calculates
the effective range of the distribution, which is used in calculating
the distribution function and quantiles, and may be used in determining
the range when plotting the distribution. By effective range is meant that
the probability of an observation being greater than the upper end is
less than the specified tolerance <code>tol</code>. Likewise for being smaller
than the lower end of the range.
</p>
<p>If <code>density = TRUE</code>, the function gives a range, outside of which
the density is less than the given tolerance. Useful for plotting the
density.
</p>


<h3>Value</h3>

<p>A two-component vector giving the lower and upper ends of the range.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Jennifer Tso, Richard Trendall</p>


<h3>References</h3>

 
<p>Barndorff-Nielsen, O. and Blæsild, P (1983).
Hyperbolic distributions. 
In <em>Encyclopedia of Statistical Sciences</em>, 
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dhyperb">dhyperb</a></code>, <code><a href="#topic+hyperbChangePars">hyperbChangePars</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfrow = c(1,2))
Theta &lt;- c(3,5,1,0)
hyperbRange &lt;- hyperbCalcRange(Theta, tol = 10^(-3))
hyperbRange
curve(phyperb(x, Theta), hyperbRange[1], hyperbRange[2])
maxDens &lt;- dhyperb(hyperbMode(Theta), Theta)
hyperbRange &lt;- hyperbCalcRange(Theta, tol = 10^(-3)*maxDens, density = TRUE)
hyperbRange
curve(dhyperb(x, Theta), hyperbRange[1], hyperbRange[2])
</code></pre>

<hr>
<h2 id='hyperbChangePars'>Change Parameterizations of the Hyperbolic Distribution</h2><span id='topic+hyperbChangePars'></span>

<h3>Description</h3>

<p>This function interchanges between the following 4 parameterizations
of the hyperbolic distribution:
</p>
<p>1. <code class="reqn">\pi, \zeta, \delta, \mu</code>
</p>
<p>2. <code class="reqn">\alpha, \beta, \delta, \mu</code>
</p>
<p>3. <code class="reqn">\phi, \gamma, \delta, \mu</code>
</p>
<p>4. <code class="reqn">\xi, \chi, \delta, \mu</code>
</p>
<p>The first three are given in Barndorff-Nielsen and
Blæsild (1983), and the fourth in Prause (1999)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyperbChangePars(from, to, Theta, noNames = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hyperbChangePars_+3A_from">from</code></td>
<td>
<p>The set of parameters to change from.</p>
</td></tr>
<tr><td><code id="hyperbChangePars_+3A_to">to</code></td>
<td>
<p>The set of parameters to change to.</p>
</td></tr>
<tr><td><code id="hyperbChangePars_+3A_theta">Theta</code></td>
<td>
<p>&quot;from&quot; parameter vector consisting of 4 numerical elements.</p>
</td></tr>
<tr><td><code id="hyperbChangePars_+3A_nonames">noNames</code></td>
<td>
<p>Logical. When <code>TRUE</code>, suppresses the parameter
<code>names</code> in the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the 4 parameterizations, the following must be positive:
</p>
<p>1. <code class="reqn">\zeta,\delta</code>
</p>
<p>2. <code class="reqn">\alpha,\delta</code>
</p>
<p>3. <code class="reqn">\phi,\gamma,\delta</code>
</p>
<p>4. <code class="reqn">\xi,\delta</code>
</p>
<p>Furthermore, note that in the second parameterization
<code class="reqn">\alpha</code> must be greater than the absolute value of
<code class="reqn">\beta</code>, while in the fourth parameterization, <code class="reqn">\xi</code>
must be less than one, and the absolute value of <code class="reqn">\chi</code> must
be less than <code class="reqn">\xi</code>.
</p>


<h3>Value</h3>

<p>A numerical vector of length 4 representing <code>Theta</code> in the
<code>to</code> parameterization.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Jennifer Tso, Richard Trendall</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. and Blæsild, P. (1983).
Hyperbolic distributions.
In <em>Encyclopedia of Statistical Sciences</em>,
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley.
</p>
<p>Prause, K. (1999) <em>The generalized hyperbolic models: Estimation,
financial derivatives and risk measurement.</em> PhD Thesis, Mathematics
Faculty, University of Freiburg.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dhyperb">dhyperb</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta1 &lt;- c(-2,1,3,0)                      # Parameterization 1
Theta2 &lt;- hyperbChangePars(1, 2, Theta1)   # Convert to parameterization 2
Theta2                                     # Parameterization 2
hyperbChangePars(2, 1, as.numeric(Theta2)) # Convert back to parameterization 1
</code></pre>

<hr>
<h2 id='hyperbCvMTest'>Cramer-von~Mises Test of a Hyperbolic Distribution</h2><span id='topic+hyperbCvMTest'></span><span id='topic+hyperbCvMTestPValue'></span><span id='topic+print.hyperbCvMTest'></span>

<h3>Description</h3>

<p>Carry out a Crämer-von~Mises test of a hyperbolic
distribution where the parameters of the distribution are estimated,
or calculate the p-value for such a test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyperbCvMTest(x, Theta, conf.level = 0.95, ...)
hyperbCvMTestPValue(xi, chi, Wsq, digits = 3)
## S3 method for class 'hyperbCvMTest'
print(x, prefix = "\t", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hyperbCvMTest_+3A_x">x</code></td>
<td>
<p>A numeric vector of data values for <code>hyperbCvMTest</code>, or
object of class <code>"hyperbCvMTest"</code> for <code>print.hyperbCvMTest</code>.</p>
</td></tr>
<tr><td><code id="hyperbCvMTest_+3A_theta">Theta</code></td>
<td>
<p>Parameters of the hyperbolic distribution taking the form
<code>c(pi,zeta,delta,mu)</code>.</p>
</td></tr>
<tr><td><code id="hyperbCvMTest_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the the confidence interval.</p>
</td></tr>
<tr><td><code id="hyperbCvMTest_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="hyperbCvMTest_+3A_xi">xi</code></td>
<td>
<p>Value of <code class="reqn">\xi</code> in the <code class="reqn">(\xi,\chi)</code>
parameterization of the hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="hyperbCvMTest_+3A_chi">chi</code></td>
<td>
<p>Value of <code class="reqn">\chi</code> in the <code class="reqn">(\xi,\chi)</code>
parameterisation of the hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="hyperbCvMTest_+3A_wsq">Wsq</code></td>
<td>
<p>Value of the test statistic in the
Crämer-von~Mises test of the hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="hyperbCvMTest_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places for p-value.</p>
</td></tr>
<tr><td><code id="hyperbCvMTest_+3A_prefix">prefix</code></td>
<td>
<p>Character(s) to be printed before the description of the
test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>hyperbCvMTest</code> carries out a Crämer-von~Mises
goodness-of-fit test of the hyperbolic distribution. The parameter
<code>Theta</code> must be given in the <code class="reqn">(\pi,\zeta)</code>
parameterisation.
</p>
<p><code>hyperbCvMTestPValue</code> calculates the p-value of the test, and is
not expected to be called by the user. The method used is
interpolation in Table 5 given in Puig &amp; Stephens (2001), which
assumes all the parameters of the distribution are unknown. Since the
table used is limited, large p-values are simply given as
&ldquo;&gt;~0.25&rdquo; and very small ones as &ldquo;&lt;~0.01&rdquo;. The table is
created as the matrix <code>wsqTable</code> when the package
<code>HyperbolicDist</code> is invoked.
</p>
<p><code>print.hyperbCvMTest</code> prints the output
from the
Crämer-von~Mises goodness-of-fit test for
the hyperbolic distribution in very similar format to that provided by
<code>print.htest</code>. The only reason for having a special print method
is that p-values can be given as less than some value or greater than
some value, such as &ldquo;&lt;\ ~0.01&rdquo;, or &ldquo;&gt;\ ~0.25&rdquo;.
</p>


<h3>Value</h3>

<p><code>hyperbCvMTest</code> returns a list with class <code>hyperbCvMTest</code>
containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>A character string with the value
&ldquo;Crämer-von~Mises test of hyperbolic
distribution&rdquo;.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>A character string giving the name(s) of the data.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>The value of the parameter Theta.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value of the test.</p>
</td></tr>
<tr><td><code>warn</code></td>
<td>
<p>A warning if the parameter values are outside the limits
of the table given in Puig &amp; Stephens (2001).</p>
</td></tr>
</table>
<p><code>hyperbCvMTestPValue</code> returns a list with the elements
<code>p.value</code> and <code>warn</code> only.
</p>


<h3>Author(s)</h3>

<p>David Scott, Thomas Tran</p>


<h3>References</h3>

<p>Puig, Pedro and Stephens, Michael A. (2001),
Goodness-of-fit tests for the hyperbolic distribution.
<em>The Canadian Journal of Statistics/La Revue Canadienne de
Statistique</em>, <b>29</b>, 309&ndash;320.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(2,2,2,2)
dataVector &lt;- rhyperb(500, Theta)
fittedTheta &lt;- hyperbFit(dataVector)$Theta
hyperbCvMTest(dataVector, fittedTheta)
dataVector &lt;- rnorm(1000)
fittedTheta &lt;- hyperbFit(dataVector, startValues = "FN")$Theta
hyperbCvMTest(dataVector, fittedTheta)
</code></pre>

<hr>
<h2 id='hyperbFit'>Fit the Hyperbolic Distribution to Data</h2><span id='topic+hyperbFit'></span><span id='topic+print.hyperbFit'></span><span id='topic+plot.hyperbFit'></span>

<h3>Description</h3>

<p>Fits a hyperbolic distribution to data.
Displays the histogram, log-histogram (both with fitted densities),
Q-Q plot and P-P plot for the fit which has the maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  hyperbFit(x, freq = NULL, breaks = NULL, ThetaStart = NULL,
            startMethod = "Nelder-Mead", startValues = "BN",
            method = "Nelder-Mead", hessian = FALSE,
            plots = FALSE, printOut = FALSE,
            controlBFGS = list(maxit=200),
            controlNM = list(maxit=1000), maxitNLM = 1500, ...)

  ## S3 method for class 'hyperbFit'
print(x,
        digits = max(3, getOption("digits") - 3), ...)

  ## S3 method for class 'hyperbFit'
plot(x, which = 1:4,
       plotTitles = paste(c("Histogram of ","Log-Histogram of ",
                            "Q-Q Plot of ","P-P Plot of "), x$obsName,
                          sep = ""),
       ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hyperbFit_+3A_x">x</code></td>
<td>
<p>Data vector for <code>hyperbFit</code>. Object of class
<code>"hyperbFit"</code> for <code>print.hyperbFit</code> and <code>plot.hyperbFit</code>.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_freq">freq</code></td>
<td>
<p>A vector of weights with length equal to <code>length(x)</code>.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_breaks">breaks</code></td>
<td>
<p>Breaks for histogram, defaults to those generated by
<code>hist(x, right = FALSE, plot = FALSE)</code>.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_thetastart">ThetaStart</code></td>
<td>
<p>A user specified starting parameter vector Theta taking
the form <code>c(pi,zeta,delta,mu)</code>.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_startmethod">startMethod</code></td>
<td>
<p>Method used by <code>hyperbFitStart</code> in calls to
<code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_startvalues">startValues</code></td>
<td>
<p>Code giving the method of determining starting
values for finding the maximum likelihood estimate of Theta.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_method">method</code></td>
<td>
<p>Different optimisation methods to consider.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_hessian">hessian</code></td>
<td>
<p>Logical. If <code>TRUE</code> the value of the hessian is
returned.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_plots">plots</code></td>
<td>
<p>Logical. If <code>FALSE</code> suppresses printing of the
histogram, log-histogram, Q-Q plot and P-P plot.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_printout">printOut</code></td>
<td>
<p>Logical. If <code>FALSE</code> suppresses printing of
results of fitting.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_controlbfgs">controlBFGS</code></td>
<td>
<p>A list of control parameters for <code>optim</code> when using
the <code>"BFGS"</code> optimisation.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_controlnm">controlNM</code></td>
<td>
<p>A list of control parameters for <code>optim</code>
when using the <code>"Nelder-Mead"</code> optimisation.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_maxitnlm">maxitNLM</code></td>
<td>
<p>A positive integer specifying the maximum number of
iterations when using the <code>"nlm"</code> optimisation.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_digits">digits</code></td>
<td>
<p>Desired number of digits when the object is printed.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_which">which</code></td>
<td>
<p>If a subset of the plots is required, specify a subset of
the numbers <code>1:4</code>.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_plottitles">plotTitles</code></td>
<td>
<p>Titles to appear above the plots.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_ask">ask</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user is <em>ask</em>ed before
each plot, see <code><a href="graphics.html#topic+par">par</a>(ask = .)</code>.</p>
</td></tr>
<tr><td><code id="hyperbFit_+3A_...">...</code></td>
<td>
<p>Passes arguments to <code>par</code>, <code>hist</code>,
<code>logHist</code>, <code>qqhyperb</code> and <code>pphyperb</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>startMethod</code> can be either <code>"BFGS"</code> or
<code>"Nelder-Mead"</code>.
</p>
<p><code>startValues</code> can be one of the following:
</p>

<dl>
<dt><code>"US"</code></dt><dd><p>User-supplied.</p>
</dd>
<dt><code>"BN"</code></dt><dd><p>Based on Barndorff-Nielsen (1977).</p>
</dd>
<dt><code>"FN"</code></dt><dd><p>A fitted normal distribution.</p>
</dd>
<dt><code>"SL"</code></dt><dd><p>Based on a fitted skew-Laplace distribution.</p>
</dd>
<dt><code>"MoM"</code></dt><dd><p>Method of moments.</p>
</dd>
</dl>

<p>For the details concerning the use of <code>ThetaStart</code>,
<code>startMethod</code>, and <code>startValues</code>, see
<code><a href="#topic+hyperbFitStart">hyperbFitStart</a></code>.
</p>
<p>The three optimisation methods currently available are:
</p>

<dl>
<dt><code>"BFGS"</code></dt><dd><p>Uses the quasi-Newton method <code>"BFGS"</code> as
documented in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>"Nelder-Mead"</code></dt><dd><p>Uses an implementation of the Nelder and
Mead method as documented in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>"nlm"</code></dt><dd><p>Uses the <code><a href="stats.html#topic+nlm">nlm</a></code> function in R.</p>
</dd>
</dl>

<p>For details of how to pass control information for optimisation using
<code><a href="stats.html#topic+optim">optim</a></code> and <code><a href="stats.html#topic+nlm">nlm</a></code>, see <code><a href="stats.html#topic+optim">optim</a></code> and
<code><a href="stats.html#topic+nlm">nlm</a>.</code>
</p>
<p>When <code>method = "nlm"</code> is used, warnings may be produced. These do
not appear to be a problem.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>Theta</code></td>
<td>
<p>A vector giving the maximum likelihood estimate of
Theta, as <code>(pi,zeta,delta,mu)</code>.</p>
</td></tr>
<tr><td><code>maxLik</code></td>
<td>
<p>The value of the maximised log-likelihood.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>If <code>hessian</code> was set to <code>TRUE</code>, the value
of the hessian. Not present otherwise.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Optimisation method used.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>Convergence code. See the relevant documentation (either
<code><a href="stats.html#topic+optim">optim</a></code> or <code><a href="stats.html#topic+nlm">nlm</a></code>) for details on
convergence.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations of optimisation routine.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>The data used to fit the hyperbolic distribution.</p>
</td></tr>
<tr><td><code>xName</code></td>
<td>
<p>A character string with the actual <code>x</code> argument
name.</p>
</td></tr>
<tr><td><code>ThetaStart</code></td>
<td>
<p>Starting value of Theta returned by call to
<code><a href="#topic+hyperbFitStart">hyperbFitStart</a></code>.</p>
</td></tr>
<tr><td><code>svName</code></td>
<td>
<p>Descriptive name for the method finding start values.</p>
</td></tr>
<tr><td><code>startValues</code></td>
<td>
<p>Acronym for the method of finding start values.</p>
</td></tr>
<tr><td><code>KNu</code></td>
<td>
<p>Value of the Bessel function in the fitted density.</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>The cell boundaries found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>midpoints</code></td>
<td>
<p>The cell midpoints found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>empDens</code></td>
<td>
<p>The estimated density found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Ai-Wei Lee, Jennifer Tso, Richard Trendall, Thomas Tran</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. (1977)
Exponentially decreasing distributions for the logarithm of particle size,
<em>Proc. Roy. Soc. Lond.</em>,
A<b>353</b>, 401&ndash;419.
</p>
<p>Fieller, N. J., Flenley, E. C. and Olbricht, W. (1992)
Statistics of particle size data.
<em>Appl. Statist.</em>,
<b>41</b>, 127&ndash;146.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+nlm">nlm</a></code>, <code><a href="graphics.html#topic+par">par</a></code>,
<code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="#topic+logHist">logHist</a></code>, <code><a href="#topic+qqhyperb">qqhyperb</a></code>,
<code><a href="#topic+pphyperb">pphyperb</a></code>, <code><a href="#topic+dskewlap">dskewlap</a></code> and
<code><a href="#topic+hyperbFitStart">hyperbFitStart</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(2,2,2,2)
dataVector &lt;- rhyperb(500, Theta)
## See how well hyperbFit works
hyperbFit(dataVector)
hyperbFit(dataVector, plots = TRUE)
fit &lt;- hyperbFit(dataVector)
par(mfrow = c(1,2))
plot(fit, which = c(1,3))

## Use nlm instead of default
hyperbFit(dataVector, method = "nlm")

</code></pre>

<hr>
<h2 id='hyperbFitStart'>Find Starting Values for Fitting a Hyperbolic Distribution</h2><span id='topic+hyperbFitStart'></span><span id='topic+hyperbFitStartMoM'></span>

<h3>Description</h3>

<p>Finds starting values for input to a maximum likelihood routine for
fitting hyperbolic distribution to data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  hyperbFitStart(x, breaks = NULL, startValues = "BN",
                 ThetaStart = NULL, startMethodSL = "Nelder-Mead",
                 startMethodMoM = "Nelder-Mead", ...)
  hyperbFitStartMoM(x, startMethodMoM = "Nelder-Mead", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hyperbFitStart_+3A_x">x</code></td>
<td>
<p>Data vector.</p>
</td></tr>
<tr><td><code id="hyperbFitStart_+3A_breaks">breaks</code></td>
<td>
<p>Breaks for histogram. If missing, defaults to those
generated by <code>hist(x, right = FALSE, plot = FALSE)</code>.</p>
</td></tr>
<tr><td><code id="hyperbFitStart_+3A_startvalues">startValues</code></td>
<td>
<p>Vector of the different starting values to consider.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="hyperbFitStart_+3A_thetastart">ThetaStart</code></td>
<td>
<p>Starting values for Theta if <code>startValues =
      "US"</code>.</p>
</td></tr>
<tr><td><code id="hyperbFitStart_+3A_startmethodsl">startMethodSL</code></td>
<td>
<p>Method used by call to <code><a href="stats.html#topic+optim">optim</a></code> in
finding skew Laplace estimates.</p>
</td></tr>
<tr><td><code id="hyperbFitStart_+3A_startmethodmom">startMethodMoM</code></td>
<td>
<p>Method used by call to <code><a href="stats.html#topic+optim">optim</a></code> in
finding method of moments estimates.</p>
</td></tr>
<tr><td><code id="hyperbFitStart_+3A_...">...</code></td>
<td>
<p>Passes arguments to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible values of the argument <code>startValues</code> are the following:
</p>

<dl>
<dt><code>"US"</code></dt><dd><p>User-supplied.</p>
</dd>
<dt><code>"BN"</code></dt><dd><p>Based on Barndorff-Nielsen (1977).</p>
</dd>
<dt><code>"FN"</code></dt><dd><p>A fitted normal distribution.</p>
</dd>
<dt><code>"SL"</code></dt><dd><p>Based on a fitted skew-Laplace distribution.</p>
</dd>
<dt><code>"MoM"</code></dt><dd><p>Method of moments.</p>
</dd>
</dl>

<p>If <code>startValues = "US"</code> then a value must be supplied for
<code>ThetaStart</code>.
</p>
<p>If <code>startValues = "MoM"</code>, <code>hyperbFitStartMoM</code> is
called. These starting values are based on Barndorff-Nielsen <em>et
al</em> (1985).
</p>
<p>If <code>startValues = "SL"</code>, or <code>startValues = "MoM"</code> an initial
optimisation is needed to find the starting values. These
optimisations call <code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>Value</h3>

<p><code>hyperbFitStart</code> returns a list with components:
</p>
<table>
<tr><td><code>ThetaStart</code></td>
<td>
<p>A vector with elements <code>pi</code>, <code>lZeta</code> (log
of zeta), <code>lDelta</code> (log of delta), and <code>mu</code> giving the
starting value of Theta.</p>
</td></tr>
<tr><td><code>xName</code></td>
<td>
<p>A character string with the actual <code>x</code> argument name.</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>The cell boundaries found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>midpoints</code></td>
<td>
<p>The cell midpoints found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>empDens</code></td>
<td>
<p>The estimated density found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
</table>
<p><code>hyperbFitStartMoM</code> returns only the method of moments estimates
as a vector with elements <code>pi</code>, <code>lZeta</code> (log of zeta),
<code>lDelta</code> (log of delta), and <code>mu</code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Ai-Wei Lee, Jennifer Tso, Richard Trendall, Thomas Tran</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. (1977)
Exponentially decreasing distributions for the logarithm of particle size,
<em>Proc. Roy. Soc. Lond.</em>,
A<b>353</b>, 401&ndash;419.
</p>
<p>Barndorff-Nielsen, O., Blæsild, P., Jensen, J.,
and  Sörenson, M. (1985).
The fascination of sand.
In <em>A celebration of statistics, The ISI Centenary Volume</em>,
eds., Atkinson, A. C. and Fienberg, S. E.,
pp. 57&ndash;87. New York: Springer-Verlag.
</p>
<p>Fieller, N. J., Flenley, E. C. and Olbricht, W. (1992)
Statistics of particle size data.
<em>Appl. Statist.</em>,
<b>41</b>, 127&ndash;146.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HyperbolicDistribution">HyperbolicDistribution</a></code>, <code><a href="#topic+dskewlap">dskewlap</a></code>,
<code><a href="#topic+hyperbFit">hyperbFit</a></code>, <code><a href="graphics.html#topic+hist">hist</a></code>, and
<code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(2,2,2,2)
dataVector &lt;- rhyperb(500,Theta)
hyperbFitStart(dataVector,startValues="FN")
hyperbFitStartMoM(dataVector)
hyperbFitStart(dataVector,startValues="MoM")
</code></pre>

<hr>
<h2 id='Hyperbolic'>Hyperbolic Distribution</h2><span id='topic+dhyperb'></span><span id='topic+phyperb'></span><span id='topic+qhyperb'></span><span id='topic+rhyperb'></span><span id='topic+ddhyperb'></span><span id='topic+hyperbBreaks'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantiles and
random number generation for the hyperbolic distribution
with parameter vector <code>Theta</code>. Utility routines are included for
the derivative of the density function and to find suitable break
points for use in determining the distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dhyperb(x, Theta, KNu = NULL, logPars = FALSE)
phyperb(q, Theta, small = 10^(-6), tiny = 10^(-10),
        deriv = 0.3, subdivisions = 100, accuracy = FALSE, ...)
qhyperb(p, Theta, small = 10^(-6), tiny = 10^(-10),
        deriv = 0.3, nInterpol = 100, subdivisions = 100, ...)
rhyperb(n, Theta)
ddhyperb(x, Theta, KNu = NULL, ...)
hyperbBreaks(Theta, small = 10^(-6), tiny = 10^(-10), deriv = 0.3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hyperbolic_+3A_x">x</code>, <code id="Hyperbolic_+3A_q">q</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_n">n</code></td>
<td>
<p>Number of observations to be generated.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_theta">Theta</code></td>
<td>
<p>Parameter vector taking the form <code>c(pi,zeta,delta,mu)</code>.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_knu">KNu</code></td>
<td>
<p>Sets the value of the Bessel function in the density or
derivative of the density. See <b>Details</b></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="Hyperbolic_+3A_logpars">logPars</code></td>
<td>
<p>Logical; if <code>TRUE</code> the second and third components
of Theta are taken to be log(zeta) and log(delta) respectively.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_small">small</code></td>
<td>
<p>Size of a small difference between the distribution
function and zero or one. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_tiny">tiny</code></td>
<td>
<p>Size of a tiny difference between the distribution
function and zero or one. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_deriv">deriv</code></td>
<td>
<p>Value between 0 and 1. Determines the point where the
derivative becomes substantial, compared to its maximum value. See
<b>Details</b>.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_accuracy">accuracy</code></td>
<td>
<p>Uses accuracy calculated by <code><a href="stats.html#topic+integrate">integrate</a></code>
to try and determine the accuracy of the distribution function
calculation.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_subdivisions">subdivisions</code></td>
<td>
<p>The maximum number of subdivisions used to
integrate the density returning the distribution function.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_ninterpol">nInterpol</code></td>
<td>
<p>The number of points used in qhyperb for cubic spline
interpolation (see <code>splinefun</code>) of the distribution function.</p>
</td></tr>
<tr><td><code id="Hyperbolic_+3A_...">...</code></td>
<td>
<p>Passes arguments to <code>uniroot</code>.  See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The hyperbolic distribution has density
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{1}{2\delta\sqrt{1+\pi^2}K_1(\zeta)} %
    e^{-\zeta[\sqrt{1+\pi^2}\sqrt{1+(\frac{x-\mu}{\delta})^2}-%
    \pi\frac{x-\mu}{\delta}]}</code>
</p>

<p>where <code class="reqn">K_1()</code> is the modified Bessel function of the
third kind with order 1.
</p>
<p>A succinct description of the hyperbolic distribution is given in
Barndorff-Nielsen and Blæsild (1983). Three different
possible parameterisations are described in that paper. A fourth
parameterization is given in Prause (1999). All use location and scale
parameters <code class="reqn">\mu</code> and <code class="reqn">\delta</code>. There are two other
parameters in each case.
</p>
<p>Use <code>hyperbChangePars</code> to convert from the
<code class="reqn">(\alpha,\beta)</code> <code class="reqn">(\phi,\gamma)</code> or
<code class="reqn">(\xi,\chi)</code> parameterisations to the
<code class="reqn">(\pi,\zeta)</code> parameterisation used above.
</p>
<p><code>phyperb</code> breaks the real line into eight regions in order to
determine the integral of <code>dhyperb</code>. The break points determining
the regions are found by <code>hyperbBreaks</code>, based on the values of
<code>small</code>, <code>tiny</code>, and <code>deriv</code>. In the extreme tails of
the distribution where the probability is <code>tiny</code> according to
<code>hyperbCalcRange</code>, the probability is taken to be zero. In the
range between where the probability is <code>tiny</code> and <code>small</code>
according to <code>hyperbCalcRange</code>, an exponential approximation to
the hyperbolic distribution is used. In the inner part of the
distribution, the range is divided in 4 regions, 2 above the mode, and
2 below. On each side of the mode, the break point which forms the 2
regions is where the derivative of the density function is
<code>deriv</code> times the maximum value of the derivative on that side of
the mode. In each of the 4 inner regions the numerical integration routine
<code><a href="#topic+safeIntegrate">safeIntegrate</a></code> (which is a wrapper for
<code><a href="stats.html#topic+integrate">integrate</a></code>) is used to integrate the density <code>dhyperb</code>.
</p>
<p><code>qhyperb</code> uses the breakup of the real line into the same 8
regions as <code>phyperb</code>. For quantiles which fall in the 2 extreme
regions, the quantile is returned as <code>-Inf</code> or <code>Inf</code> as
appropriate. In the range between where the probability is <code>tiny</code>
and <code>small</code> according to <code>hyperbCalcRange</code>, an exponential
approximation to the hyperbolic distribution is used from which the
quantile may be found in closed form. In the 4 inner regions
<code>splinefun</code> is used to fit values of the distribution function
generated by <code>phyperb</code>.  The quantiles are then found
using the <code>uniroot</code> function.
</p>
<p><code>phyperb</code> and <code>qhyperb</code> may generally be expected to be
accurate to 5 decimal places.
</p>
<p>The hyperbolic distribution is a special case of the generalized
hyperbolic distribution (Barndorff-Nielsen and Blæsild
(1983)). The generalized hyperbolic distribution can be represented as
a particular mixture of the normal distribution where the mixing
distribution is the generalized inverse Gaussian.  <code>rhyperb</code> uses
this representation to generate observations from the hyperbolic
distribution. Generalized inverse Gaussian observations are obtained
via the algorithm of Dagpunar (1989).  </p>


<h3>Value</h3>

<p><code>dhyperb</code> gives the density, <code>phyperb</code> gives the distribution
function, <code>qhyperb</code> gives the quantile function and <code>rhyperb</code>
generates random variates. An estimate of the accuracy of the
approximation to the distribution function may be found by setting
<code>accuracy = TRUE</code> in the call to <code>phyperb</code> which then returns
a list with components <code>value</code> and <code>error</code>.
</p>
<p><code>ddhyperb</code> gives the derivative of <code>dhyperb</code>.
</p>
<p><code>hyperbBreaks</code> returns a list with components:
</p>
<table>
<tr><td><code>xTiny</code></td>
<td>
<p>Value such that probability to the left is less than
<code>tiny</code>.</p>
</td></tr>
<tr><td><code>xSmall</code></td>
<td>
<p>Value such that probability to the left is less than
<code>small</code>.</p>
</td></tr>
<tr><td><code>lowBreak</code></td>
<td>
<p>Point to the left of the mode such that the
derivative of the density is <code>deriv</code> times its maximum value
on that side of the mode</p>
</td></tr>
<tr><td><code>highBreak</code></td>
<td>
<p>Point to the right of the mode such that the
derivative of the density is <code>deriv</code> times its maximum value
on that side of the mode</p>
</td></tr>
<tr><td><code>xLarge</code></td>
<td>
<p>Value such that probability to the right is less than
<code>small</code>.</p>
</td></tr>
<tr><td><code>xHuge</code></td>
<td>
<p>Value such that probability to the right is less than
<code>tiny</code>.</p>
</td></tr>
<tr><td><code>modeDist</code></td>
<td>
<p>The mode of the given hyperbolic distribution.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Ai-Wei Lee, Jennifer Tso, Richard Trendall</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. and Blæsild, P (1983).
Hyperbolic distributions.
In <em>Encyclopedia of Statistical Sciences</em>,
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley.
</p>
<p>Dagpunar, J.S. (1989).
An easily implemented generalized inverse Gaussian generator
<em>Commun. Statist. -Simula.</em>,
<b>18</b>, 703&ndash;710.
</p>
<p>Prause, K. (1999) <em>The generalized hyperbolic models: Estimation,
financial derivatives and risk measurement.</em> PhD Thesis, Mathematics
Faculty, University of Freiburg.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safeIntegrate">safeIntegrate</a></code>, <code><a href="stats.html#topic+integrate">integrate</a></code> for its
shortfalls, <code><a href="stats.html#topic+splinefun">splinefun</a></code>, <code><a href="stats.html#topic+uniroot">uniroot</a></code> and
<code><a href="#topic+hyperbChangePars">hyperbChangePars</a></code> for changing parameters to the
<code class="reqn">(\pi,\zeta)</code> parameterisation, <code><a href="#topic+dghyp">dghyp</a></code> for
the generalized hyperbolic distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(2,1,1,0)
hyperbRange &lt;- hyperbCalcRange(Theta, tol = 10^(-3))
par(mfrow = c(1,2))
curve(dhyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Density of the\n Hyperbolic Distribution")
curve(phyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Distribution Function of the\n Hyperbolic Distribution")
dataVector &lt;- rhyperb(500, Theta)
curve(dhyperb(x, Theta), range(dataVector)[1], range(dataVector)[2],
      n = 500)
hist(dataVector, freq = FALSE, add =TRUE)
title("Density and Histogram\n of the Hyperbolic Distribution")
logHist(dataVector, main =
        "Log-Density and Log-Histogram\n of the Hyperbolic Distribution")
curve(log(dhyperb(x, Theta)), add = TRUE,
      range(dataVector)[1], range(dataVector)[2], n = 500)
par(mfrow = c(2,1))
curve(dhyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Density of the\n Hyperbolic Distribution")
curve(ddhyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Derivative of the Density\n of the Hyperbolic Distribution")
par(mfrow = c(1,1))
hyperbRange &lt;- hyperbCalcRange(Theta, tol = 10^(-6))
curve(dhyperb(x, Theta), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
bks &lt;- hyperbBreaks(Theta)
abline(v = bks)
</code></pre>

<hr>
<h2 id='HyperbolicDistribution'>
The Package &lsquo;HyperbolicDist&rsquo;: Summary Information
</h2><span id='topic+HyperbolicDist-package'></span><span id='topic+HyperbolicDistribution'></span><span id='topic+HyperbolicDist'></span>

<h3>Description</h3>

<p>This package provides a collection of functions for working with the
hyperbolic and related distributions.
</p>
<p>For the hyperbolic distribution functions are provided for the density
function, distribution function, quantiles, random number generation and
fitting the hyperbolic distribution to data (<code>hyperbFit</code>). The function
<code>hyperbChangePars</code> will interchange parameter values between
different parameterisations.  The mean, variance, skewness, kurtosis and
mode of a given hyperbolic distribution are given by <code>hyperbMean</code>,
<code>hyperbVar</code>, <code>hyperbSkew</code>, <code>hyperbKurt</code>, and
<code>hyperbMode</code> respectively. For assessing the fit of the hyperbolic
distribution to a set of data, the log-histogram is useful. See
<code><a href="#topic+logHist">logHist</a></code>. Q-Q and P-P plots are also provided for assessing
the fit of a hyperbolic distribution. A Crämer-von~Mises
test of the goodness of fit of data to a hyperbolic distribution is given by
<code>hyperbCvMTest</code>. S3 <code>print</code>, <code>plot</code> and <code>summary</code>
methods are provided for the output of <code>hyperbFit</code>.
</p>
<p>For the generalized hyperbolic distribution functions are provided for
the density function, distribution function, quantiles, and for random
number generation. The function <code>ghypChangePars</code> will interchange
parameter values between different parameterisations.  The mean, variance, and
mode of a given generalized hyperbolic distribution are given by
<code>ghypMean</code>, <code>ghypVar</code>, <code>ghypSkew</code>, <code>ghypKurt</code>, and
<code>ghypMode</code> respectively.  Q-Q and P-P plots are also provided for
assessing the fit of a generalized hyperbolic distribution.
</p>
<p>For the generalized inverse Gaussian distribution functions are provided for
the density function, distribution function, quantiles, and for random
number generation. The function <code>gigChangePars</code> will interchange
parameter values between different parameterisations.  The mean,
variance, skewness, kurtosis and mode of a given generalized inverse
Gaussian distribution are given by <code>gigMean</code>, <code>gigVar</code>,
<code>gigSkew</code>, <code>gigKurt</code>, and <code>gigMode</code> respectively.  Q-Q and
P-P plots are also provided for assessing the fit of a generalized
inverse Gaussian distribution.
</p>
<p>For the skew-Laplace distribution functions are provided for
the density function, distribution function, quantiles, and for random
number generation. Q-Q and P-P plots are also provided for assessing the
fit of a skew-Laplace distribution.
</p>


<h3>Acknowledgements</h3>

<p>A number of students have worked on the package: Ai-Wei Lee, Jennifer Tso,
Richard Trendall, and Thomas Tran.
</p>
<p>Thanks to Ross Ihaka and Paul Murrell for their willingness to answer
my questions, and to all the core group for the development of R.
</p>


<h3>LICENCE</h3>

<p>This library and its documentation are usable under the terms of the
&quot;GNU General Public License&quot;, a copy of which is distributed with the
package.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a></p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. (1977)
Exponentially decreasing distributions for the logarithm of particle size,
<em>Proc. Roy. Soc. Lond.</em>,
A<b>353</b>, 401&ndash;419.
</p>
<p>Barndorff-Nielsen, O. and Blæsild, P (1983).
Hyperbolic distributions.
In <em>Encyclopedia of Statistical Sciences</em>,
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley.
</p>
<p>Fieller, N. J., Flenley, E. C. and Olbricht, W. (1992)
Statistics of particle size data.
<em>Appl. Statist.</em>,
<b>41</b>, 127&ndash;146.
</p>
<p>Jörgensen, B. (1982). <em>Statistical Properties of
the Generalized Inverse Gaussian Distribution</em>. Lecture Notes in
Statistics, Vol. 9, Springer-Verlag, New York.
</p>
<p>Prause, K. (1999)
<em>The generalized hyperbolic models: Estimation, financial
derivatives and risk measurement.</em> PhD Thesis, Mathematics Faculty,
University of Freiburg.
</p>

<hr>
<h2 id='HyperbPlots'>Hyperbolic Quantile-Quantile and Percent-Percent Plots</h2><span id='topic+qqhyperb'></span><span id='topic+pphyperb'></span>

<h3>Description</h3>

<p><code>qqhyperb</code> produces a hyperbolic Q-Q plot of the values in
<code>y</code>.
</p>
<p><code>pphyperb</code> produces a hyperbolic P-P (percent-percent) or
probability plot of the values in <code>y</code>.	
</p>
<p>Graphical parameters may be given as arguments to <code>qqhyperb</code>,
and <code>pphyperb</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqhyperb(y, Theta, main = "Hyperbolic Q-Q Plot",
  xlab = "Theoretical Quantiles",
  ylab = "Sample Quantiles",
  plot.it = TRUE, line = TRUE, ...)

pphyperb(y, Theta, main = "Hyperbolic P-P Plot",
  xlab = "Uniform Quantiles",
  ylab = "Probability-integral-transformed Data",
  plot.it = TRUE, line = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HyperbPlots_+3A_y">y</code></td>
<td>
<p>The data sample.</p>
</td></tr>
<tr><td><code id="HyperbPlots_+3A_theta">Theta</code></td>
<td>
<p>Parameters of the hyperbolic distribution.</p>
</td></tr>
<tr><td><code id="HyperbPlots_+3A_xlab">xlab</code>, <code id="HyperbPlots_+3A_ylab">ylab</code>, <code id="HyperbPlots_+3A_main">main</code></td>
<td>
<p>Plot labels.</p>
</td></tr>
<tr><td><code id="HyperbPlots_+3A_plot.it">plot.it</code></td>
<td>
<p>Logical. Should the result be plotted?</p>
</td></tr>
<tr><td><code id="HyperbPlots_+3A_line">line</code></td>
<td>
<p>Add line through origin with unit slope.</p>
</td></tr>
<tr><td><code id="HyperbPlots_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>qqhyperb</code> and <code>pphyperb</code>, a list with components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The x coordinates of the points that are to be plotted.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The y coordinates of the points that are to be plotted.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilk, M. B. and Gnanadesikan, R. (1968)
Probability plotting methods for the analysis of data.
<em>Biometrika</em>.
<b>55</b>, 1&ndash;17.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ppoints">ppoints</a></code>, <code><a href="#topic+dhyperb">dhyperb</a></code>, <code><a href="#topic+hyperbFit">hyperbFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfrow = c(1,2))
y &lt;- rhyperb(200, c(2,2,2,2))
qqhyperb(y, c(2,2,2,2),line = FALSE)
abline(0, 1, col = 2)
pphyperb(y, c(2,2,2,2))
</code></pre>

<hr>
<h2 id='hyperbWSqTable'>Percentage Points for the Cramer-von Mises Test of the Hyperbolic
Distribution</h2><span id='topic+hyperbWSqTable'></span>

<h3>Description</h3>

<p>This gives Table 5 of Puig &amp; Stephens (2001) which is used for testing
the goodness-of-fit of the hyperbolic distribution using the
Crämer-von~Mises test. It is for internal use by
<code>hyperbCvMTest</code> and <code>hyperbCvMTestPValue</code> only and is not
intended to be accessed by the user. It is loaded automatically when
the package <code>HyperbolicDist</code> is invoked.
</p>


<h3>Format</h3>

<p>The <code>hyperbWSqTable</code> matrix has 55 rows and 5 columns, giving
percentage points of <code class="reqn">W^2</code> for different values of
<code class="reqn">\xi</code> and <code class="reqn">\alpha</code> (the rows), and of
<code class="reqn">\chi</code> (the columns).
</p>


<h3>Source</h3>

<p>Puig, Pedro and Stephens, Michael A. (2001),
Goodness-of-fit tests for the hyperbolic distribution.
<em>The Canadian Journal of Statistics/La Revue Canadienne de
Statistique</em>, <b>29</b>, 309&ndash;320.
</p>

<hr>
<h2 id='is.wholenumber'>Is Object Numeric and Whole Numbers</h2><span id='topic+is.wholenumber'></span>

<h3>Description</h3>

<p>Checks whether an object is numeric and if so, are all the elements
whole numbers, to a given tolerance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.wholenumber(x, tolerance = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.wholenumber_+3A_x">x</code></td>
<td>
<p>The object to be tested.</p>
</td></tr>
<tr><td><code id="is.wholenumber_+3A_tolerance">tolerance</code></td>
<td>
<p>Numeric <code class="reqn">\ge 0</code>. Absolute differences
greater than <code>tolerance</code> are treated as real differences.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The object <code>x</code> is first tested to see if it is numeric. If not
the function returns <code>'FALSE'</code>. Then if all the elements of
<code>x</code> are whole numbers to within the tolerance given by
<code>tolerance</code> the function returns <code>'TRUE'</code>. If not it returns
<code>'FALSE'</code>.
</p>


<h3>Value</h3>

<p>Either <code>'TRUE'</code> or <code>'FALSE'</code> depending on the result of the
test.
</p>


<h3>Author(s)</h3>

<p>David Scott  <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>.</p>


<h3>References</h3>

<p>Based on a post by Tony Plate &lt;tplate@acm.org&gt; on R-help.</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.wholenumber(-3:5)                           # TRUE
is.wholenumber(c(0,0.1,1.3,5))                 # FALSE
is.wholenumber(-3:5 + .Machine$double.eps)     # TRUE
is.wholenumber(-3:5 + .Machine$double.eps^0.5) # FALSE
is.wholenumber(c(2L,3L))                       # TRUE
is.wholenumber(c("2L","3L"))                   # FALSE
is.wholenumber(0i ^ (-3:3))                    # FALSE
is.wholenumber(matrix(1:6, nrow = 3))          # TRUE
is.wholenumber(list(-1:3,2:6))                 # FALSE
is.numeric(list(-1:3,2:6))                     # FALSE
is.wholenumber(unlist(list(-1:3,2:6)))         # TRUE
</code></pre>

<hr>
<h2 id='logHist'>Plot Log-Histogram</h2><span id='topic+logHist'></span>

<h3>Description</h3>

<p>Plots a log-histogram, as in for example Feiller, Flenley and Olbricht
(1992).
</p>
<p>The intended use of the log-histogram is to examine the fit of a
particular density to a set of data, as an alternative to a histogram
with a density curve. For this reason, only the log-density histogram
is implemented, and it is not possible to obtain a log-frequency
histogram.
</p>
<p>The log-histogram can be plotted with histogram-like dashed vertical
bars, or as points marking the tops of the log-histogram bars, or with
both bars and points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  logHist(x, breaks = "Sturges", 
          include.lowest = TRUE, right = TRUE, 
          main = paste("Log-Histogram of", xName), 
          xlim = range(breaks), ylim = NULL, xlab = xName, 
          ylab = "Log-density", nclass = NULL, htype = "b", ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logHist_+3A_x">x</code></td>
<td>
<p>A vector of values for which the log-histogram is desired.</p>
</td></tr>
<tr><td><code id="logHist_+3A_breaks">breaks</code></td>
<td>
<p>One of:
</p>

<ul>
<li><p> a vector giving the breakpoints between log-histogram cells;
</p>
</li>
<li><p> a single number giving the number of cells for the log-histogram;
</p>
</li>
<li><p> a character string naming an algorithm to compute the
number of cells (see <b>Details</b>);
</p>
</li>
<li><p> a function to compute the number of cells.
</p>
</li></ul>

<p>In the last three cases the number is a suggestion only.
</p>
</td></tr>
<tr><td><code id="logHist_+3A_include.lowest">include.lowest</code></td>
<td>
<p>Logical. If <code>TRUE</code>,
an &lsquo;x[i]&rsquo; equal to the &lsquo;breaks&rsquo; value will be included in the first
(or last, for <code>right = FALSE</code>) bar.</p>
</td></tr>
<tr><td><code id="logHist_+3A_right">right</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the log-histograms cells are
right-closed (left open) intervals.</p>
</td></tr>
<tr><td><code id="logHist_+3A_main">main</code>, <code id="logHist_+3A_xlab">xlab</code>, <code id="logHist_+3A_ylab">ylab</code></td>
<td>
<p>These arguments to <code>title</code> have useful
defaults here.</p>
</td></tr>
<tr><td><code id="logHist_+3A_xlim">xlim</code></td>
<td>
<p>Sensible default for the range of x values.</p>
</td></tr>
<tr><td><code id="logHist_+3A_ylim">ylim</code></td>
<td>
<p>Calculated by <code>logHist</code>, see <b>Details</b>.</p>
</td></tr>
<tr><td><code id="logHist_+3A_nclass">nclass</code></td>
<td>
<p>Numeric (integer).  For compatibility with <code>hist</code> only,
<code>nclass</code> is equivalent to <code>breaks</code> for a scalar or
character argument.</p>
</td></tr>
<tr><td><code id="logHist_+3A_htype">htype</code></td>
<td>
<p>Type of histogram. Possible types are:
</p>

<ul>
<li><p> '&quot;h&quot;' for a *h*istogram only;
</p>
</li>
<li><p> '&quot;p&quot;' for *p*oints marking the top of the histogram bars only;
</p>
</li>
<li><p> '&quot;b&quot;' for *b*oth.
</p>
</li></ul>

</td></tr>
<tr><td><code id="logHist_+3A_...">...</code></td>
<td>
<p>Further graphical parameters for calls
to <code>plot</code> and <code>points</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code><a href="graphics.html#topic+hist.default">hist.default</a></code> to determine the cells or classes and
calculate counts.
</p>
<p>To calculate <code>ylim</code> the following procedure is used. The upper
end of the range is given by the maximum value of the log-density,
plus 25% of the absolute value of the maximum. The lower end of the
range is given by the smallest (finite) value of the log-density, less
25% of the difference between the largest and smallest (finite) values 
of the log-density.
</p>
<p>A log-histogram in the form used by Feiller, Flenley and Olbricht (1992)
is plotted. See also Barndorff-Nielsen (1977) for use of log-histograms.
</p>


<h3>Value</h3>

<p>Returns a list with components:
</p>
<table>
<tr><td><code>breaks</code></td>
<td>
<p>The <code class="reqn">n+1</code> cell boundaries (= <code>breaks</code> if that
was a vector).</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p><code class="reqn">n</code> integers; for each cell, the number of
<code>x[]</code> inside.</p>
</td></tr>
<tr><td><code>logDensity</code></td>
<td>
<p>Log of <code class="reqn">\hat f(x_i)</code>, which are estimated
density values. 
</p>
<p>If <code>all(diff(breaks) == 1)</code>, estimated density values are the
relative frequencies <code>counts/n</code> and in general satisfy
<code class="reqn">\sum_i \hat f(x_i) (b_{i+1}-b_i) = 1</code>, where <code class="reqn">b_i</code> = <code>breaks[i]</code>.</p>
</td></tr>
<tr><td><code>mids</code></td>
<td>
<p>The <code class="reqn">n</code> cell midpoints.</p>
</td></tr>
<tr><td><code>xName</code></td>
<td>
<p>A character string with the actual <code>x</code> argument name.</p>
</td></tr>
<tr><td><code>heights</code></td>
<td>
<p>The location of the tops of the vertical segments used
in drawing the log-histogram.</p>
</td></tr>
<tr><td><code>ylim</code></td>
<td>
<p>The value of <code>ylim</code> calculated by <code>logHist</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Richard Trendall,
Thomas Tran
</p>


<h3>References</h3>

 
<p>Barndorff-Nielsen, O. (1977)
Exponentially decreasing distributions for the logarithm of particle size,
<em>Proc. Roy. Soc. Lond.</em>,
A<b>353</b>, 401&ndash;419.
</p>
<p>Barndorff-Nielsen, O. and BlÃ¦sild, P (1983).
Hyperbolic distributions. 
In <em>Encyclopedia of Statistical Sciences</em>, 
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley.
</p>
<p>Fieller, N. J., Flenley, E. C. and Olbricht, W. (1992)
Statistics of particle size data.
<em>Appl. Statist.</em>,
<b>41</b>, 127&ndash;146.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+hist">hist</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SandP500)
### Consider proportional changes in the index
change &lt;- SandP500[-length(SandP500)]/SandP500[-1]
hist(change)
logHist(change)
### Show points only
logHist(change, htype = "p", pch = 20, cex = 0.5)
### Fit the hyperbolic distribution to the changes
hyperbFit(change)
</code></pre>

<hr>
<h2 id='mamquam'>Size of Gravels from Mamquam River</h2><span id='topic+mamquam'></span>

<h3>Description</h3>

<p>Size of gravels collected from a sandbar in the Mamquam River,
British Columbia, Canada. Summary data, giving the frequency of
observations in 16 different size classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mamquam)</code></pre>


<h3>Format</h3>

<p>The <code>mamquam</code> data frame has 16 rows and 2 columns.
</p>

<table>
<tr>
 <td style="text-align: right;">
    [, 1] </td><td style="text-align: left;"> midpoints  </td><td style="text-align: left;"> midpoints of intervals (psi units) </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 2] </td><td style="text-align: left;"> counts      </td><td style="text-align: left;"> number of observations in interval </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Gravel sizes are determined by passing clasts through templates of
particular sizes. This gives a range in which the size of each clast
lies. Sizes (in mm) are then converted into psi units by taking the
base 2 logarithm of the size. The midpoints specified are the midpoints
of the psi unit ranges, and counts gives the number of observations
in each size range. The classes are of length 0.5 psi units. 
There are 3574 observations.
</p>


<h3>Source</h3>

<p>Rice, Stephen and Church, Michael (1996)
Sampling surficial gravels: the precision of size distribution
percentile estimates.
<em>J. of Sedimentary Research</em>,
<b>66</b>, 654&ndash;665.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mamquam)
str(mamquam)
attach(mamquam)
### Construct data from frequency summary, taking all observations
### at midpoints of intervals
psi &lt;- rep(midpoints, counts)
barplot(table(psi))
### Fit the hyperbolic distribution
hyperbFit(psi)

### Actually hyperbFit can deal with frequency data
hyperbFit(midpoints, freq=counts)
</code></pre>

<hr>
<h2 id='momChangeAbout'>Obtain Moments About a New Location</h2><span id='topic+momChangeAbout'></span>

<h3>Description</h3>

<p>Using the moments up to a given order about one location, this function
either returns the moments up to that given order about a new location as a 
vector or it returns a moment of a specific order defined by users 
(order &lt;= maximum order of the given moments) about a new location as a single
number. 
A generalization of using raw moments to obtain a central moment or using 
central moments to obtain a raw moment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  momChangeAbout(order = "all", oldMom, oldAbout, newAbout)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="momChangeAbout_+3A_order">order</code></td>
<td>
<p>One of:
</p>

<ul>
<li><p> the character string &quot;all&quot;, the default;
</p>
</li>
<li><p> a positive integer less than the maximum order of <code>oldMom</code>.
</p>
</li></ul>

</td></tr>
<tr><td><code id="momChangeAbout_+3A_oldmom">oldMom</code></td>
<td>
<p>Numeric. Moments of orders 1, 2, ..., about the point 
<code>oldAbout</code>.</p>
</td></tr>
<tr><td><code id="momChangeAbout_+3A_oldabout">oldAbout</code></td>
<td>
<p>Numeric. The point about which the moments <code>oldMom</code> have
been calculated.</p>
</td></tr>
<tr><td><code id="momChangeAbout_+3A_newabout">newAbout</code></td>
<td>
<p>Numeric. The point about which the desired moment or
moments are to be
obtained.</p>
</td></tr>
</table>


<h3>Details</h3>

  
<p>Suppose <code class="reqn">m_k</code> denotes the <code class="reqn">k</code>-th moment of a random
variable <code class="reqn">X</code> about a point <code class="reqn">a</code>, and <code class="reqn">m_k^*</code>
denotes the <code class="reqn">k</code>-th moment about <code class="reqn">b</code>. Then
<code class="reqn">m_k^*</code> may be determined from the moments
<code class="reqn">m_1,m_2,\dots,m_k</code> according to the formula
</p>
<p style="text-align: center;"><code class="reqn">m_k^*=\sum_{i=0}^k (a-b)^i m^{k-i}</code>
</p>

<p>This is the formula implemented by the function
<code>momChangeAbout</code>. It is a generalization of the well-known
formulae used to change raw moments to central moments or to change
central moments to raw moments. See for example Kendall and Stuart
(1989), Chapter 3.
</p>


<h3>Value</h3>

<p>The moment of order <code>order</code> about the location <code>newAbout</code> when 
<code>order</code> is specified.
The vector of moments about the location <code>newAbout</code> from first
order up to the maximum order of the <code>oldMom</code> when <code>order</code>
takes the value <code>"all"</code> or is not specified. 
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, 
Christine Yang Dong <a href="mailto:c.dong@auckland.ac.nz">c.dong@auckland.ac.nz</a></p>


<h3>References</h3>

<p>Kendall, M. G. and Stuart, A. (1969).
The Advanced Theory of Statistics, Volume 1, 3rd Edition.
London: Charles Griffin &amp; Company.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Gamma distribution
k &lt;- 4
shape &lt;- 2
old &lt;- 0
new &lt;- 1
sampSize &lt;- 1000000

### Calculate 1st to 4th raw moments 
m &lt;- numeric(k)
for (i in 1:k){
   m[i] &lt;- gamma(shape + i)/gamma(shape)
}
m

### Calculate 4th moment about new 
momChangeAbout(k, m, old, new)
### Calculate 3rd about new
momChangeAbout(3, m, old, new)

### Calculate 1st to 4th moments about new
momChangeAbout(oldMom = m, oldAbout = old, newAbout = new)
momChangeAbout(order = "all", m, old, new)
  
### Approximate kth moment about new using sampling
x &lt;- rgamma(sampSize, shape)
mean((x - new)^k) 
</code></pre>

<hr>
<h2 id='momIntegrated'>Moments Using Integration</h2><span id='topic+momIntegrated'></span>

<h3>Description</h3>

<p>Calculates moments and absolute moments about a given location for the
generalized hyperbolic and related distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>momIntegrated(densFn, order, param = NULL, about = 0, absolute = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="momIntegrated_+3A_densfn">densFn</code></td>
<td>
<p>Character. The name of the density function whose
moments are to be calculated. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="momIntegrated_+3A_order">order</code></td>
<td>
<p>Numeric. The order of the moment or absolute moment to be
calculated.</p>
</td></tr>
<tr><td><code id="momIntegrated_+3A_param">param</code></td>
<td>
<p>Numeric. A vector giving the parameter values for the
distribution specified by <code>densFn</code>. If no <code>param</code> values
are specified, then the default parameter values of each distribution
are used instead.</p>
</td></tr>
<tr><td><code id="momIntegrated_+3A_about">about</code></td>
<td>
<p>Numeric. The point about which the moment is to be calculated.</p>
</td></tr>
<tr><td><code id="momIntegrated_+3A_absolute">absolute</code></td>
<td>
<p>Logical. Whether absolute moments or ordinary moments
are to be calculated. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Denote the density function by <code class="reqn">f</code>. Then if
<code>order</code><code class="reqn">=k</code> and <code>about</code><code class="reqn">=a</code>,
<code>momIntegrated</code> calculates
</p>
<p style="text-align: center;"><code class="reqn">\int_{-\infty}^\infty (x - a)^k f(x) dx</code>
</p>

<p>when <code>absolute = FALSE</code> and
</p>
<p style="text-align: center;"><code class="reqn">\int_{-\infty}^\infty |x - a|^k f(x) dx</code>
</p>

<p>when <code>absolute = TRUE</code>.
</p>
<p>Only certain density functions are permitted.
</p>
<p>When <code>densFn="ghyp"</code> or <code>"generalized hyperbolic"</code> the
density used is <code>dghyp</code>. The default value for <code>param</code> is
<code>c(1,1,0,1,0)</code>.
</p>
<p>When <code>densFn="hyperb"</code> or <code>"hyperbolic"</code> the density used is
<code>dhyperb</code>. The default value for <code>param</code> is
<code>c(0,1,1,0)</code>.
</p>
<p>When <code>densFn="gig"</code> or <code>"generalized inverse gaussian"</code> the
density used is <code>dgig</code>. The default value for <code>param</code> is
<code>c(1,1,1)</code>.
</p>
<p>When <code>densFn="gamma"</code> the density used is <code>dgamma</code>. The
default value for <code>param</code> is <code>c(1,1)</code>.
</p>
<p>When <code>densFn="invgamma"</code> or <code>"inverse gamma"</code> the
density used is the density of the inverse gamma distribution given by
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{u^\alpha e^{-u}}{x \Gamma(\alpha)}, %
    \quad u = \theta/x</code>
</p>

<p>for <code class="reqn">x &gt; 0</code>, <code class="reqn">\alpha &gt; 0</code> and
<code class="reqn">\theta &gt; 0</code>.  The parameter vector
<code>param = c(shape,rate)</code> where <code>shape</code> <code class="reqn">=\alpha</code> and
<code>rate</code><code class="reqn">=1/\theta</code>. The default value for
<code>param</code> is <code>c(-1,1)</code>.
</p>


<h3>Value</h3>

<p>The value of the integral as specified in <b>Details</b>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, 
Christine Yang Dong <a href="mailto:c.dong@auckland.ac.nz">c.dong@auckland.ac.nz</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+dghyp">dghyp</a></code>, <code><a href="#topic+dhyperb">dhyperb</a></code>,
<code><a href="stats.html#topic+dgamma">dgamma</a></code>, <code><a href="#topic+dgig">dgig</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Calculate the mean of a generalized hyperbolic distribution
### Compare the use of integration and the formula for the mean
m1 &lt;- momIntegrated("ghyp", param = c(1/2,3,1,1,0), order = 1, about = 0)
m1
ghypMean(c(1/2,3,1,1,0))
### The first moment about the mean should be zero
momIntegrated("ghyp", order = 1, param = c(1/2,3,1,1,0), about = m1)
### The variance can be calculated from the raw moments
m2 &lt;- momIntegrated("ghyp", order = 2, param = c(1/2,3,1,1,0), about = 0)
m2
m2 - m1^2
### Compare with direct calculation using integration
momIntegrated("ghyp", order = 2, param = c(1/2,3,1,1,0), about = m1)
momIntegrated("generalized hyperbolic", param = c(1/2,3,1,1,0), order = 2,
              about = m1)
### Compare with use of the formula for the variance
ghypVar(c(1/2,3,1,1,0))
</code></pre>

<hr>
<h2 id='momRecursion'>Computes the moment coefficients recursively for generalized
hyperbolic and related distributions
</h2><span id='topic+momRecursion'></span>

<h3>Description</h3>

<p>This function computes all of the moments coefficients by recursion based on
Scott, Würtz and Tran (2008). See <b>Details</b> for the
formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  momRecursion(order = 12, printMatrix = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="momRecursion_+3A_order">order</code></td>
<td>
<p>Numeric. The order of the moment coefficients to be calculated.
Not permitted to be a vector. Must be a positive whole number except for
moments about zero.</p>
</td></tr>
<tr><td><code id="momRecursion_+3A_printmatrix">printMatrix</code></td>
<td>
<p>Logical. Should the coefficients matrix be printed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The moment coefficients recursively as <code class="reqn">a_{1,1}=1</code> and
</p>
<p style="text-align: center;"><code class="reqn">a_{k,\ell} = a_{k-1, \ell-1} + (2 \ell - k + 1) a_{k-1, \ell}</code>
</p>
<p> with
<code class="reqn">a_{k,\ell} = 0</code> for <code class="reqn">\ell&lt;\lfloor(k+1)/2\rfloor</code> or <code class="reqn">\ell&gt;k</code>
where <code class="reqn">k</code> = <code>order</code>, <code class="reqn">\ell</code> is equal to the integers from
<code class="reqn">(k+1)/2</code> to <code class="reqn">k</code>.
</p>
<p>This formula is given in Scott, Würtz and Tran (2008,
working paper).
</p>
<p>The function also calculates M which is equal to <code class="reqn">2\ell - k</code>.
It is a common term which will appear in the formulae
for calculating moments of generalized hyperbolic and related distributions.
</p>


<h3>Value</h3>

<table>
<tr><td><code>a</code></td>
<td>
<p>The non-zero moment coefficients for the specified order.</p>
</td></tr>
<tr><td><code>l</code></td>
<td>
<p>Integers from (<code>order</code>+1)/2 to <code>order</code>. It is used when
computing the moment coefficients and the mu moments.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>The common term used when computing mu moments for generalized
hyperbolic and related distributions, M = <code class="reqn">2\ell - k</code>,
<code class="reqn">k</code>=<code>order</code></p>
</td></tr>
<tr><td><code>lmin</code></td>
<td>
<p>The minimum of <code class="reqn">\ell</code>, which is equal to
(<code>order</code>+1)/2.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Christine Yang Dong <a href="mailto:c.dong@auckland.ac.nz">c.dong@auckland.ac.nz</a></p>


<h3>References</h3>

<p>Scott, D. J., Würtz, D. and Tran, T. T. (2008)
Moments of the Generalized Hyperbolic Distribution. Preprint.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  momRecursion(order = 12)

  #print out the matrix
  momRecursion(order = 12, "true")
</code></pre>

<hr>
<h2 id='resistors'>Resistance of One-half-ohm Resistors </h2><span id='topic+resistors'></span>

<h3>Description</h3>

<p>This data set gives the resistance in ohms of 500 nominally one-half-ohm
resistors, presented in Hahn and Shapiro (1967). Summary data giving the
frequency of observations in 28 intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(resistors)</code></pre>


<h3>Format</h3>

<p>The <code>resistors</code> data frame has 28 rows and 2 columns.
</p>

<table>
<tr>
 <td style="text-align: right;">
    [, 1] </td><td style="text-align: left;"> midpoints  </td><td style="text-align: left;"> midpoints of intervals (ohm) </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 2] </td><td style="text-align: left;"> counts     </td><td style="text-align: left;"> number of observations in interval </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>
    


<h3>Source</h3>

<p>Hahn, Gerald J. and Shapiro, Samuel S. (1967)
<em>Statistical Models in Engineering</em>.
New York: Wiley,
page 207.
</p>


<h3>References</h3>

<p>Chen, Hanfeng, and Kamburowska, Grazyna (2001) 
Fitting data to the Johnson system.
<em>J. Statist. Comput. Simul.</em>,
<b>70</b>, 21&ndash;32.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(resistors)
str(resistors)
attach(resistors)
### Construct data from frequency summary, taking all observations
### at midpoints of intervals
resistances &lt;- rep(midpoints,counts)
hist(resistances)
logHist(resistances)
## Fit the hyperbolic distribution
hyperbFit(resistances) 

## Actually fit.hyperb can deal with frequency data
hyperbFit(midpoints, freq=counts)

</code></pre>

<hr>
<h2 id='safeIntegrate'>Safe Integration of One-Dimensional Functions</h2><span id='topic+safeIntegrate'></span><span id='topic+print.integrate'></span>

<h3>Description</h3>

<p>Adaptive quadrature of functions of one variable over a finite or
infinite interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safeIntegrate(f, lower, upper, subdivisions=100,
              rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
              stop.on.error = TRUE, keep.xy = FALSE, aux = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="safeIntegrate_+3A_f">f</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> function taking a numeric first argument and returning
a numeric vector of the same length.  Returning a non-finite element will
generate an error.</p>
</td></tr>
<tr><td><code id="safeIntegrate_+3A_lower">lower</code>, <code id="safeIntegrate_+3A_upper">upper</code></td>
<td>
<p>The limits of integration.  Can be infinite.</p>
</td></tr>
<tr><td><code id="safeIntegrate_+3A_subdivisions">subdivisions</code></td>
<td>
<p>The maximum number of subintervals.</p>
</td></tr>
<tr><td><code id="safeIntegrate_+3A_rel.tol">rel.tol</code></td>
<td>
<p>Relative accuracy requested.</p>
</td></tr>
<tr><td><code id="safeIntegrate_+3A_abs.tol">abs.tol</code></td>
<td>
<p>Absolute accuracy requested.</p>
</td></tr>
<tr><td><code id="safeIntegrate_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>Logical. If true (the default) an error stops the
function.  If false some errors will give a result with a warning in
the <code>message</code> component.</p>
</td></tr>
<tr><td><code id="safeIntegrate_+3A_keep.xy">keep.xy</code></td>
<td>
<p>Unused.  For compatibility with S.</p>
</td></tr>
<tr><td><code id="safeIntegrate_+3A_aux">aux</code></td>
<td>
<p>Unused.  For compatibility with S.</p>
</td></tr>
<tr><td><code id="safeIntegrate_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>f</code>.  Remember
to use argument names <em>not</em> matching those of
<code>safeIntegrate(.)</code>!</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is just a wrapper around
<code><a href="stats.html#topic+integrate">integrate</a></code> to check for equality of
<code>upper</code> and <code>lower</code>. A check is made using
<code><a href="Matrix.html#topic+all.equal">all.equal</a></code>. When numerical equality is
detected, if <code>lower</code> (and hence <code>upper</code>) is infinite, the
value of the integral and the absolute error are both set to 0. When
<code>lower</code> is finite, the value of the integral is set to 0, and the
absolute error to the average of the function values at <code>upper</code> and
<code>lower</code> times the difference between <code>upper</code> and <code>lower</code>.
</p>
<p>When <code>upper</code> and <code>lower</code> are determined to be different, the
result is exactly as given by  <code><a href="stats.html#topic+integrate">integrate</a></code>.
</p>


<h3>Value</h3>

<p>A list of class <code>"integrate"</code> with components:
</p>
<table>
<tr><td><code>value</code></td>
<td>
<p>The final estimate of the integral.</p>
</td></tr>
<tr><td><code>abs.error</code></td>
<td>
<p>Estimate of the modulus of the absolute error.</p>
</td></tr>
<tr><td><code>subdivisions</code></td>
<td>
<p>The number of subintervals produced in the
subdivision process.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p><code>"OK"</code> or a character string giving the error message.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>The function <code><a href="stats.html#topic+integrate">integrate</a></code> and
<code><a href="Matrix.html#topic+all.equal">all.equal</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>integrate(dnorm, -1.96, 1.96)
safeIntegrate(dnorm, -1.96, 1.96)  # Same as for integrate()
integrate(dnorm, -Inf, Inf)
safeIntegrate(dnorm, -Inf, Inf)    # Same as for integrate()
integrate(dnorm, 1.96, 1.96)       # OK here but can give an error
safeIntegrate(dnorm, 1.96, 1.96)
integrate(dnorm, -Inf, -Inf)
safeIntegrate(dnorm, -Inf, -Inf)   # Avoids nonsense answer
integrate(dnorm, Inf, Inf)
safeIntegrate(dnorm, Inf, Inf)     # Avoids nonsense answer
</code></pre>

<hr>
<h2 id='Sample+20Moments'>Sample Skewness and Kurtosis</h2><span id='topic+skewness'></span><span id='topic+kurtosis'></span>

<h3>Description</h3>

<p>Computes the sample skewness and sample kurtosis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewness(x, na.rm = FALSE)
kurtosis(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sample+2B20Moments_+3A_x">x</code></td>
<td>
<p>A numeric vector containing the values whose skewness  or
kurtosis is to be computed.</p>
</td></tr>
<tr><td><code id="Sample+2B20Moments_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether <code>NA</code> values
should be stripped before the computation proceeds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">N = \mathrm{length}(x)</code>, then the skewness of
<code class="reqn">x</code> is defined as 
</p>
<p style="text-align: center;"><code class="reqn">N^{-1} \mathrm{sd}(x)^{-3} \sum_i (x_i - \mathrm{mean}(x))^3.</code>
</p>

<p>If <code class="reqn">N = \mathrm{length}(x)</code>, then the kurtosis of
<code class="reqn">x</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">N^{-1} \mathrm{sd}(x)^{-4}
    \sum_i(x_i - \mathrm{mean}(x))^4 - 3.</code>
</p>



<h3>Value</h3>

<p>The skewness or kurtosis of <code>x</code>.
</p>


<h3>Note</h3>

<p>These functions and the description of them are taken from the
package <code>e1071</code>. They are included to avoid having to require an
additional package.</p>


<h3>Author(s)</h3>

<p>Evgenia Dimitriadou, Kurt Hornik, Friedrich Leisch, David Meyer,
and Andreas Weingessel</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
skewness(x)
kurtosis(x)
</code></pre>

<hr>
<h2 id='SandP500'>S&amp;P 500</h2><span id='topic+SandP500'></span>

<h3>Description</h3>

<p>This data set gives the value of Standard and Poor's most notable stock
market price index (the S&amp;P 500) at year end, from 1800 to 2001.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SandP500)</code></pre>


<h3>Format</h3>

<p>A vector of 202 observations.
</p>


<h3>Source</h3>

<p>At the time of downloading, <code>http://www.globalfindata.com</code>
which no longer exists. Now at <code>https://globalfinancialdata.com</code>.
</p>


<h3>References</h3>

<p>Brown, Barry W., Spears, Floyd M. and Levy, Lawrence B. (2002)
The log <em>F</em>: a distribution for all seasons.
<em>Computational Statistics</em>,
<b>17</b>, 47&ndash;58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SandP500)
### Consider proportional changes in the index
change&lt;-SandP500[-length(SandP500)]/SandP500[-1]
hist(change)
### Fit hyperbolic distribution to changes
hyperbFit(change)

</code></pre>

<hr>
<h2 id='SkewLaplace'>Skew-Laplace Distribution</h2><span id='topic+dskewlap'></span><span id='topic+pskewlap'></span><span id='topic+qskewlap'></span><span id='topic+rskewlap'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantiles and 
random number generation for the skew-Laplace distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dskewlap(x, Theta, logPars = FALSE)
pskewlap(q, Theta)
qskewlap(p, Theta)
rskewlap(n, Theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SkewLaplace_+3A_x">x</code>, <code id="SkewLaplace_+3A_q">q</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="SkewLaplace_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="SkewLaplace_+3A_n">n</code></td>
<td>
<p>Number of observations to be generated.</p>
</td></tr>
<tr><td><code id="SkewLaplace_+3A_theta">Theta</code></td>
<td>
<p>Vector of parameters of the skew-Laplace distribution:
<code class="reqn">\alpha</code>,  <code class="reqn">\beta</code> and <code class="reqn">\mu</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="SkewLaplace_+3A_logpars">logPars</code></td>
<td>
<p>Logical. If <code>TRUE</code> the first and second components
of Theta are taken to be log(alpha) and log(beta) respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The central skew-Laplace has mode zero, and is a mixture of a (negative)
exponential distribution with mean <code class="reqn">\beta</code>, and the negative of an 
exponential distribution with mean <code class="reqn">\alpha</code>. The weights of
the positive and negative components are proportional to their means.
</p>
<p>The general skew-Laplace distribution is a shifted central skew-Laplace
distribution, where the mode is given by <code class="reqn">\mu</code>.
</p>
<p>The density is given by:
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{1}{\alpha+\beta} e^{(x - \mu)/\alpha}</code>
</p>

<p>for <code class="reqn">x\leq\mu</code>, and
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{1}{\alpha+\beta} e^{-(x - \mu)/\beta}</code>
</p>

<p>for <code class="reqn">x\geq\mu</code>
</p>


<h3>Value</h3>

<p><code>dskewlap</code> gives the density, <code>pskewlap</code> gives the distribution 
function, <code>qskewlap</code> gives the quantile function and <code>rskewlap</code> 
generates random variates. The distribution function is obtained by
elementary integration of the density function. Random variates are
generated from exponential observations using the characterization of
the skew-Laplace as a mixture of exponential observations.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, 
Ai-Wei Lee, Richard Trendall</p>


<h3>References</h3>

<p>Fieller, N. J., Flenley, E. C. and Olbricht, W. (1992)
Statistics of particle size data.
<em>Appl. Statist.</em>,
<b>41</b>, 127&ndash;146.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hyperbFitStart">hyperbFitStart</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(1,2,1)
par(mfrow = c(1,2))
curve(dskewlap(x, Theta), from = -5, to = 8, n = 1000)
title("Density of the\n Skew-Laplace Distribution")
curve(pskewlap(x, Theta), from = -5, to = 8, n = 1000)
title("Distribution Function of the\n Skew-Laplace Distribution")
dataVector &lt;- rskewlap(500, Theta)
curve(dskewlap(x, Theta), range(dataVector)[1], range(dataVector)[2],
      n = 500)
hist(dataVector, freq = FALSE, add =TRUE)
title("Density and Histogram\n of the Skew-Laplace Distribution")
logHist(dataVector, main =
        "Log-Density and Log-Histogram\n of the Skew-Laplace Distribution")
curve(log(dskewlap(x, Theta)), add = TRUE,
      range(dataVector)[1], range(dataVector)[2], n = 500)
</code></pre>

<hr>
<h2 id='SkewLaplacePlots'>Skew-Laplace Quantile-Quantile and Percent-Percent Plots</h2><span id='topic+qqskewlap'></span><span id='topic+ppskewlap'></span>

<h3>Description</h3>

<p><code>qqskewlap</code> produces a skew-Laplace QQ plot of the
values in <code>y</code>.
</p>
<p><code>ppskewlap</code> produces a skew-Laplace PP (percent-percent) or
probability plot of the values in <code>y</code>.
</p>
<p>If <code>line = TRUE</code>, a line with zero intercept and unit slope is
added to the plot.
</p>
<p>Graphical parameters may be given as arguments to <code>qqskewlap</code>, and
<code>ppskewlap</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqskewlap(y, Theta, main = "Skew-Laplace Q-Q Plot",
  xlab = "Theoretical Quantiles",
  ylab = "Sample Quantiles",
  plot.it = TRUE, line = TRUE, ...)

ppskewlap(y, Theta, main = "Skew-Laplace P-P Plot",
  xlab = "Uniform Quantiles",
  ylab = "Probability-integral-transformed Data",
  plot.it = TRUE, line = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SkewLaplacePlots_+3A_y">y</code></td>
<td>
<p>The data sample.</p>
</td></tr>
<tr><td><code id="SkewLaplacePlots_+3A_theta">Theta</code></td>
<td>
<p>Parameters of the skew-Laplace distribution.</p>
</td></tr>
<tr><td><code id="SkewLaplacePlots_+3A_xlab">xlab</code>, <code id="SkewLaplacePlots_+3A_ylab">ylab</code>, <code id="SkewLaplacePlots_+3A_main">main</code></td>
<td>
<p>Plot labels.</p>
</td></tr>
<tr><td><code id="SkewLaplacePlots_+3A_plot.it">plot.it</code></td>
<td>
<p>Logical.  TRUE denotes the results should be plotted.</p>
</td></tr>
<tr><td><code id="SkewLaplacePlots_+3A_line">line</code></td>
<td>
<p>Logical. If TRUE, a line with zero intercept and unit slope
is added to the plot.</p>
</td></tr>
<tr><td><code id="SkewLaplacePlots_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>qqskewlap</code> and <code>ppskewlap</code>, a list with components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The x coordinates of the points that are be plotted.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The y coordinates of the points that are be plotted.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilk, M. B. and Gnanadesikan, R. (1968)
Probability plotting methods for the analysis of data.
<em>Biometrika</em>.
<b>55</b>, 1&ndash;17.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ppoints">ppoints</a></code>, <code><a href="#topic+dskewlap">dskewlap</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfrow=c(1,2))
y &lt;- rskewlap(1000,c(0.5,1,2))
qqskewlap(y,c(0.5,1,2),line=FALSE)
abline(0,1,col=2)
ppskewlap(y,c(0.5,1,2))
</code></pre>

<hr>
<h2 id='Specific+20Generalized+20Hyperbolic+20Moments+20and+20Mode'>Moments and Mode of the Generalized Hyperbolic Distribution</h2><span id='topic+ghypMean'></span><span id='topic+ghypVar'></span><span id='topic+ghypSkew'></span><span id='topic+ghypKurt'></span><span id='topic+ghypMode'></span>

<h3>Description</h3>

<p>Functions to calculate the mean, variance, skewness, kurtosis and mode
of a specific generalized hyperbolic distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ghypMean(Theta)
ghypVar(Theta)
ghypSkew(Theta)
ghypKurt(Theta)
ghypMode(Theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Specific+2B20Generalized+2B20Hyperbolic+2B20Moments+2B20and+2B20Mode_+3A_theta">Theta</code></td>
<td>
<p>Parameter vector of the generalized hyperbolic distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ghypMean</code> gives the mean of the generalized hyperbolic distribution,
<code>ghypVar</code> the variance, <code>ghypSkew</code> the skewness,
<code>ghypKurt</code> the kurtosis, and <code>ghypMode</code> the mode. The
formulae used for the mean is given in Prause (1999). The variance,
skewness and kurtosis are obtained using the recursive formula
implemented in <code><a href="#topic+ghypMom">ghypMom</a></code> which can calculate moments of
all orders about any point.
</p>
<p>The mode is found by a numerical optimisation using
<code><a href="stats.html#topic+optim">optim</a></code>. For the special case of the hyperbolic
distribution a formula for the mode is available, see
<code><a href="#topic+hyperbMode">hyperbMode</a></code>.
</p>
<p>The parameterization of the generalized hyperbolic distribution used
for these functions is the <code class="reqn">(\alpha,\beta)</code> one. See
<code><a href="#topic+ghypChangePars">ghypChangePars</a></code> to transfer between parameterizations.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Thomas Tran</p>


<h3>References</h3>

<p>Prause, K. (1999) <em>The generalized hyperbolic models: Estimation,
financial derivatives and risk measurement.</em> PhD Thesis, Mathematics
Faculty, University of Freiburg. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dghyp">dghyp</a></code>, <code><a href="#topic+ghypChangePars">ghypChangePars</a></code>, 
<code><a href="base.html#topic+besselK">besselK</a></code>, <code><a href="#topic+RLambda">RLambda</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(2,2,1,2,2)
ghypMean(Theta)
ghypVar(Theta)
ghypSkew(Theta)
ghypKurt(Theta)
ghypMode(Theta)
maxDens &lt;- dghyp(ghypMode(Theta), Theta)
ghypRange &lt;- ghypCalcRange(Theta, tol = 10^(-3)*maxDens)
curve(dghyp(x, Theta), ghypRange[1], ghypRange[2])
abline(v = ghypMode(Theta), col = "blue")
abline(v = ghypMean(Theta), col = "red")
</code></pre>

<hr>
<h2 id='Specific+20Generalized+20Inverse+20Gaussian+20Moments+20and+20Mode'>Moments and Mode of the Generalized Inverse Gaussian Distribution</h2><span id='topic+gigMean'></span><span id='topic+gigVar'></span><span id='topic+gigSkew'></span><span id='topic+gigKurt'></span><span id='topic+gigMode'></span>

<h3>Description</h3>

<p>Functions to calculate the mean, variance, skewness, kurtosis and mode
of a specific generalized inverse Gaussian distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gigMean(Theta)
gigVar(Theta)
gigSkew(Theta)
gigKurt(Theta)
gigMode(Theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Specific+2B20Generalized+2B20Inverse+2B20Gaussian+2B20Moments+2B20and+2B20Mode_+3A_theta">Theta</code></td>
<td>
<p>Parameter vector of the generalized inverse Gaussian
distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>gigMean</code> gives the mean of the generalized inverse Gaussian
distribution, <code>gigVar</code> the variance, <code>gigSkew</code> the skewness,
<code>gigKurt</code> the kurtosis, and <code>gigMode</code> the mode. The formulae
used are as given in Jorgensen (1982),
pp. 13&ndash;17. Note that the kurtosis is the standardised fourth cumulant
or what is sometimes called the kurtosis excess. (See
<a href="http://mathworld.wolfram.com/Kurtosis.html">http://mathworld.wolfram.com/Kurtosis.html</a> for a discussion.)
</p>
<p>The parameterization used  for the generalized inverse Gaussian
distribution is the <code class="reqn">(\chi,\psi)</code> one (see
<code><a href="#topic+dgig">dgig</a></code>). To use another parameterization, use
<code><a href="#topic+gigChangePars">gigChangePars</a></code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a></p>


<h3>References</h3>

<p>Jorgensen, B. (1982).
<em>Statistical Properties of the Generalized Inverse Gaussian
Distribution</em>.
Lecture Notes in Statistics, Vol. 9, Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgig">dgig</a></code>, <code><a href="#topic+gigChangePars">gigChangePars</a></code>,
<code><a href="base.html#topic+besselK">besselK</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(-0.5,5,2.5)
gigMean(Theta)
gigVar(Theta)
gigSkew(Theta)
gigKurt(Theta)
gigMode(Theta)
</code></pre>

<hr>
<h2 id='Specific+20Hyperbolic+20Distribution+20Moments+20and+20Mode'>Moments and Mode of the Hyperbolic Distribution</h2><span id='topic+hyperbMean'></span><span id='topic+hyperbVar'></span><span id='topic+hyperbSkew'></span><span id='topic+hyperbKurt'></span><span id='topic+hyperbMode'></span>

<h3>Description</h3>

<p>Functions to calculate the mean, variance, skewness, kurtosis and mode
of a specific hyperbolic distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyperbMean(Theta)
hyperbVar(Theta)
hyperbSkew(Theta)
hyperbKurt(Theta)
hyperbMode(Theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Specific+2B20Hyperbolic+2B20Distribution+2B20Moments+2B20and+2B20Mode_+3A_theta">Theta</code></td>
<td>
<p>Parameter vector of the hyperbolic distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formulae used for the mean, variance and mode are as given in
Barndorff-Nielsen and Blæsild (1983), p. 702.  The
formulae used for the skewness and kurtosis are those of
Barndorff-Nielsen and Blæsild (1981), Appendix 2. 
</p>
<p>Note that the variance, skewness and kurtosis can be obtained from the
functions for the generalized hyperbolic distribution as special
cases. Likewise other moments can be obtained from the function
<code><a href="#topic+ghypMom">ghypMom</a></code> which implements a recursive method to moments
of any desired order. Note that functions for the generalized
hyperbolic distribution use a different parameterization, so care is
required.
</p>


<h3>Value</h3>

<p><code>hyperbMean</code> gives the mean of the hyperbolic distribution,
<code>hyperbVar</code> the variance, <code>hyperbSkew</code> the skewness,
<code>hyperbKurt</code> the kurtosis and <code>hyperbMode</code> the mode.
</p>
<p>Note that the kurtosis is the standardised fourth cumulant or what is
sometimes called the kurtosis excess. (See
<a href="http://mathworld.wolfram.com/Kurtosis.html">http://mathworld.wolfram.com/Kurtosis.html</a> for a discussion.)
</p>
<p>The parameterization of the hyperbolic distribution used for this
and other components of the <code>HyperbolicDist</code> package is the
<code class="reqn">(\pi,\zeta)</code> one. See <code><a href="#topic+hyperbChangePars">hyperbChangePars</a></code>
to transfer between parameterizations.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Richard Trendall,
Thomas Tran</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. and Blæsild, P (1981).
Hyperbolic distributions and ramifications: contributions to theory
and application.
In <em>Statistical Distributions in Scientific Work</em>,
eds., Taillie, C., Patil, G. P., and Baldessari, B. A., Vol. 4,
pp. 19&ndash;44. Dordrecht: Reidel.
</p>
<p>Barndorff-Nielsen, O. and Blæsild, P (1983).
Hyperbolic distributions.
In <em>Encyclopedia of Statistical Sciences</em>,
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700&ndash;707. New York: Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dhyperb">dhyperb</a></code>, <code><a href="#topic+hyperbChangePars">hyperbChangePars</a></code>,
<code><a href="base.html#topic+besselK">besselK</a></code>, <code><a href="#topic+ghypMom">ghypMom</a></code>, <code><a href="#topic+ghypMean">ghypMean</a></code>,
<code><a href="#topic+ghypVar">ghypVar</a></code>, <code><a href="#topic+ghypSkew">ghypSkew</a></code>, <code><a href="#topic+ghypKurt">ghypKurt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Theta &lt;- c(2,2,2,2)
hyperbMean(Theta)
hyperbVar(Theta)
hyperbSkew(Theta)
hyperbKurt(Theta)
hyperbMode(Theta)
</code></pre>

<hr>
<h2 id='summary.hyperbFit'>Summarizing Hyperbolic Distribution Fit</h2><span id='topic+summary.hyperbFit'></span><span id='topic+print.summary.hyperbFit'></span>

<h3>Description</h3>

<p><code>summary</code> Method for class <code>"hyperbFit"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hyperbFit'
summary(object, ...)

## S3 method for class 'summary.hyperbFit'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.hyperbFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>"hyperbFit"</code>, resulting from a call to
<code><a href="#topic+hyperbFit">hyperbFit</a></code>.</p>
</td></tr>
<tr><td><code id="summary.hyperbFit_+3A_x">x</code></td>
<td>
<p>An object of class <code>"summary.hyperbFit"</code>, resulting from
a call to <code>summary.hyperbFit</code>.</p>
</td></tr>
<tr><td><code id="summary.hyperbFit_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.hyperbFit_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.hyperbFit</code> calculates standard errors for the estimates
of <code class="reqn">\pi</code>, <code class="reqn">\zeta</code>, <code class="reqn">\delta</code>, and
<code class="reqn">\mu</code> of the hyperbolic distribution parameter vector Theta if
the Hessian from the call to <code><a href="stats.html#topic+optim">optim</a></code> or <code><a href="stats.html#topic+nlm">nlm</a></code>
is available. Because the parameters in the call to the optimiser are
<code class="reqn">\pi</code>, <code class="reqn">\log(\zeta)</code>,
<code class="reqn">\log(\delta)</code>, and <code class="reqn">\mu</code>, the delta method is
used to obtain the standard errors for <code class="reqn">\zeta</code> and
<code class="reqn">\delta</code>.
</p>


<h3>Value</h3>

<p>If the Hessian is available, <code>summary.hyperbFit</code> computes
standard errors for the estimates of <code class="reqn">\pi</code>, <code class="reqn">\zeta</code>,
<code class="reqn">\delta</code>, and <code class="reqn">\mu</code>, and adds them to <code>object</code>
as <code>object$sds</code>. Otherwise, no calculations are performed and the
composition of <code>object</code> is unaltered.
</p>
<p><code>summary.hyperbFit</code> invisibly returns <code>x</code>
with class  changed to <code>summary.hyperbFit</code>.
</p>
<p>See <code><a href="#topic+hyperbFit">hyperbFit</a></code> for the composition of an object of class
<code>hyperbFit</code>.
</p>
<p><code>print.summary.hyperbFit</code> prints a summary in the same format as
<code><a href="#topic+print.hyperbFit">print.hyperbFit</a></code> when the Hessian is not available from
the fit. When the Hessian is available, the standard errors for the
parameter estimates are printed in parentheses beneath the parameter
estimates, in the manner of <code>fitdistr</code> in the package
<code>MASS</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hyperbFit">hyperbFit</a></code>, <code><a href="base.html#topic+summary">summary</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Continuing the  hyperbFit(.) example:
Theta &lt;- c(2,2,2,2)
dataVector &lt;- rhyperb(500, Theta)
fit &lt;- hyperbFit(dataVector, method = "BFGS", hessian = TRUE)
print(fit)
summary(fit)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
