<!DOCTYPE html><html><head><title>Help for package dendroextras</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dendroextras}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dendroextras-package'><p>Extra functions to cut, label and colour dendrogram clusters</p></a></li>
<li><a href='#colour_clusters'><p>Colour sub-clusters of a tree (dendrogram/hclust) object</p></a></li>
<li><a href='#labels.hclust'><p>Find labels of hclust object (in dendrogram order)</p></a></li>
<li><a href='#labels+26lt+3B-'><p>Set the labels of an object</p></a></li>
<li><a href='#leaf_colours'><p>Return the leaf colours of a dendrogram</p></a></li>
<li><a href='#set_leaf_colours'><p>Set the leaf colours of a dendrogram</p></a></li>
<li><a href='#slice'><p>Cut a tree-like object into groups numbered in tree order</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Title:</td>
<td>Extra Functions to Cut, Label and Colour Dendrogram Clusters</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides extra functions to manipulate dendrograms
    that build on the base functions provided by the 'stats' package. The main
    functionality it is designed to add is the ability to colour all the edges
    in an object of class 'dendrogram' according to cluster membership i.e. each
    subtree is coloured, not just the terminal leaves. In addition it provides
    some utility functions to cut 'dendrogram' and 'hclust' objects and to 
    set/get labels.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-01-24 19:25:06 UTC; jefferis</td>
</tr>
<tr>
<td>Author:</td>
<td>Gregory Jefferis [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gregory Jefferis &lt;jefferis@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-01-25 14:38:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='dendroextras-package'>Extra functions to cut, label and colour dendrogram clusters</h2><span id='topic+dendroextras-package'></span><span id='topic+dendroextras'></span>

<h3>Description</h3>

<p>Extra functions to cut, label and colour dendrogram clusters
</p>


<h3>Cutting clusters</h3>

<p><code>dendroextras</code> provides the <code><a href="#topic+slice">slice</a></code> function as an 
alternative to the base <code><a href="base.html#topic+cut">cut</a></code> function. In contrast to 
<code>cut</code>, <code>slice</code> returns group membership <em>in dendrogram 
order</em> i.e. the first element in the group vector that is returned will be 
the leftmost member of the leftmost cluster (cluster #1).
</p>


<h3>Colouring clusters</h3>

<p><code>dendroextras</code> provides <code><a href="#topic+colour_clusters">colour_clusters</a></code> to colour all of
the edges forming clusters cut by height or number of groups. You can also 
set and retrieve the leaf colours (i.e. the terminal nodes) using 
<code><a href="#topic+set_leaf_colours">set_leaf_colours</a></code> and <code><a href="#topic+leaf_colours">leaf_colours</a></code>.
</p>


<h3>Labels</h3>

<p><code>dendroextras</code> provides <code><a href="base.html#topic+labels">labels</a></code> and
<code><a href="#topic+labels+3C-">labels&lt;-</a></code> methods to get and set the labels of cluster
members.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dendrogram">dendrogram</a>, <a href="stats.html#topic+hclust">hclust</a></code> in <code><a href="stats.html#topic+stats">stats</a></code> 
package.
</p>

<hr>
<h2 id='colour_clusters'>Colour sub-clusters of a tree (dendrogram/hclust) object</h2><span id='topic+colour_clusters'></span><span id='topic+color_clusters'></span><span id='topic+color_clusters'></span>

<h3>Description</h3>

<p>The distinctive feature of this function is to colour both the 
terminal leaves of a cluster and the edges leading to those leaves.
The edgePar attribute of nodes will be augmented by a new list item col.
The groups will be defined by a call to <code><a href="#topic+slice">slice</a></code> using the k or h
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colour_clusters(d, k = NULL, h = NULL, col = rainbow,
  groupLabels = NULL)

color_clusters(d, k = NULL, h = NULL, col = rainbow, groupLabels = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colour_clusters_+3A_d">d</code></td>
<td>
<p>A <code>dendrogram</code> or <code>hclust</code> tree object</p>
</td></tr>
<tr><td><code id="colour_clusters_+3A_k">k</code></td>
<td>
<p>number of groups (passed to <code>slice</code>)</p>
</td></tr>
<tr><td><code id="colour_clusters_+3A_h">h</code></td>
<td>
<p>height at which to cut tree (passed to <code>slice</code>)</p>
</td></tr>
<tr><td><code id="colour_clusters_+3A_col">col</code></td>
<td>
<p>Function or vector of colours</p>
</td></tr>
<tr><td><code id="colour_clusters_+3A_grouplabels">groupLabels</code></td>
<td>
<p>If TRUE add numeric group label - see Details for options</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>groupLabels=TRUE</code> then numeric group labels will added to
each cluster. If a vector is supplied then these entries will be used as 
the group labels. If a function is supplied then it will be passed a 
numeric vector of groups (e.g. 1:5) and must return the formatted group
labels.
</p>


<h3>Value</h3>

<p>a tree object of class dendrogram.
</p>


<h3>Author(s)</h3>

<p>jefferis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slice">slice</a>,<a href="stats.html#topic+cutree">cutree</a>,<a href="stats.html#topic+dendrogram">dendrogram</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d5=colour_clusters(hclust(dist(USArrests), "ave"),5)
plot(d5)
d5g=colour_clusters(hclust(dist(USArrests), "ave"),5,groupLabels=TRUE)
plot(d5g)
d5gr=colour_clusters(hclust(dist(USArrests), "ave"),5,groupLabels=as.roman)
plot(d5gr)
</code></pre>

<hr>
<h2 id='labels.hclust'>Find labels of hclust object (in dendrogram order)</h2><span id='topic+labels.hclust'></span>

<h3>Description</h3>

<p>NB will return labels in dendrogram order, not in the
order of the original labels retained in object$labels
ususally corresponding to the row or column names of 
the <code><a href="stats.html#topic+dist">dist</a></code> object provided to <code><a href="stats.html#topic+hclust">hclust</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hclust'
labels(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="labels.hclust_+3A_object">object</code></td>
<td>
<p>hclust object from which to extract labels</p>
</td></tr>
<tr><td><code id="labels.hclust_+3A_...">...</code></td>
<td>
<p>Additional arguments (ignored)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector of labels in dendrogram order
</p>


<h3>Author(s)</h3>

<p>jefferis
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+labels">labels</a>,<a href="stats.html#topic+hclust">hclust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hc &lt;- hclust(dist(USArrests), "ave")
dend &lt;- as.dendrogram(hc)
stopifnot(all.equal(labels(hc),labels(dend)))
</code></pre>

<hr>
<h2 id='labels+26lt+3B-'>Set the labels of an object</h2><span id='topic+labels+3C-'></span><span id='topic+labels+3C-.dendrogram'></span>

<h3>Description</h3>

<p>Set the labels of an object
</p>
<p>Set the labels of a dendrogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>labels(x,...) &lt;- value

labels(x,...) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="labels+2B26lt+2B3B-_+3A_x">x</code></td>
<td>
<p>Object on which to set labels</p>
</td></tr>
<tr><td><code id="labels+2B26lt+2B3B-_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to specific methods</p>
</td></tr>
<tr><td><code id="labels+2B26lt+2B3B-_+3A_value">value</code></td>
<td>
<p>New labels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class dendrogram
</p>


<h3>Author(s)</h3>

<p>jefferis
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dendrogram">dendrogram</a>,<a href="base.html#topic+labels">labels</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hc &lt;- hclust(dist(USArrests), "ave")
dend &lt;- as.dendrogram(hc)
labels(dend)&lt;-abbreviate(labels(dend),minlength=2)
</code></pre>

<hr>
<h2 id='leaf_colours'>Return the leaf colours of a dendrogram</h2><span id='topic+leaf_colours'></span><span id='topic+leaf_colors'></span>

<h3>Description</h3>

<p>Return the leaf colours of a dendrogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leaf_colours(d, col_to_return = c("edge", "node", "label"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leaf_colours_+3A_d">d</code></td>
<td>
<p>the dendrogram</p>
</td></tr>
<tr><td><code id="leaf_colours_+3A_col_to_return">col_to_return</code></td>
<td>
<p>Character scalar - kind of colour attribute to return</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The returned colours will be in dendrogram order.
</p>


<h3>Value</h3>

<p>named character vector of colours, NA_character_ where missing
</p>


<h3>Author(s)</h3>

<p>jefferis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slice">slice</a>,<a href="#topic+colour_clusters">colour_clusters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d5=colour_clusters(hclust(dist(USArrests), "ave"),5)
leaf_colours(d5)
</code></pre>

<hr>
<h2 id='set_leaf_colours'>Set the leaf colours of a dendrogram</h2><span id='topic+set_leaf_colours'></span><span id='topic+set_leaf_colors'></span><span id='topic+set_leaf_colors'></span>

<h3>Description</h3>

<p>Set the leaf colours of a dendrogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_leaf_colours(d, col, col_to_set = c("edge", "node", "label"))

set_leaf_colors(d, col, col_to_set = c("edge", "node", "label"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_leaf_colours_+3A_d">d</code></td>
<td>
<p>the dendrogram</p>
</td></tr>
<tr><td><code id="set_leaf_colours_+3A_col">col</code></td>
<td>
<p>Single colour or named character vector of colours. When NA no
colour will be set.</p>
</td></tr>
<tr><td><code id="set_leaf_colours_+3A_col_to_set">col_to_set</code></td>
<td>
<p>Character scalar - kind of colour attribute to set</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>jefferis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slice">slice</a>,<a href="#topic+colour_clusters">colour_clusters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d5=colour_clusters(hclust(dist(USArrests), "ave"),5)
dred=set_leaf_colours(d5,'red','edge')
stopifnot(isTRUE(all(leaf_colours(dred)=='red')))
d52=set_leaf_colours(d5,leaf_colours(d5),'edge')
stopifnot(all.equal(d5,d52))
</code></pre>

<hr>
<h2 id='slice'>Cut a tree-like object into groups numbered in tree order</h2><span id='topic+slice'></span>

<h3>Description</h3>

<p>In comparison with cutree, the groups are numbered from left to right as per
the tree when plotted in its standard horizontal form. Note also that the
return value will have the leaves sorted in dendrogram order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slice(x, k = NULL, h = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slice_+3A_x">x</code></td>
<td>
<p>tree like object</p>
</td></tr>
<tr><td><code id="slice_+3A_k">k</code></td>
<td>
<p>an integer scalar with the desired number of groups</p>
</td></tr>
<tr><td><code id="slice_+3A_h">h</code></td>
<td>
<p>numeric scalar with height where the tree should be cut</p>
</td></tr>
<tr><td><code id="slice_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named vector with group memberships
</p>


<h3>Author(s)</h3>

<p>jefferis
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cutree">cutree</a>,<a href="stats.html#topic+cut.dendrogram">cut.dendrogram</a>,<a href="stats.html#topic+rect.hclust">rect.hclust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hc &lt;- hclust(dist(USArrests), "ave")
# return groups, leaves ordered by dendrogram
slice(hc,k=5)
# return groups, leaves ordered as originally passed to hclust
slice(hc,k=5)[order(hc$order)]
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
