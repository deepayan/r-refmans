<!DOCTYPE html><html><head><title>Help for package metaviz</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {metaviz}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#metaviz-package'><p>metaviz: Forest Plots, Funnel Plots, and Visual Funnel Plot Inference for Meta-Analysis</p></a></li>
<li><a href='#brainvol'><p>Example data for a meta-analysis of correlations: Human brain volume and intelligence</p></a></li>
<li><a href='#exrehab'><p>Example data for a meta-analysis of dichotomous outcomes: Exercise-based cardiac rehabilitation</p></a></li>
<li><a href='#funnelinf'><p>Visual funnel plot inference for meta-analysis</p></a></li>
<li><a href='#homeopath'><p>Example data for a meta-analysis of standardized mean differences: Homeopathic treatment vs. Placebo</p></a></li>
<li><a href='#internal_viz_classicforest'><p>Internal helper function of viz_forest to create a classic forest plot</p></a></li>
<li><a href='#internal_viz_rainforest'><p>Internal helper function of viz_rainforest and viz_forest to create a rainforest plot.</p></a></li>
<li><a href='#internal_viz_thickforest'><p>Internal helper function of viz_thickforest and viz_forest to create a thick forest plot</p></a></li>
<li><a href='#mozart'><p>Example data for a meta-analysis of standardized mean differences: Mozart effect</p></a></li>
<li><a href='#viz_forest'><p>Forest plot variants for meta-analyses</p></a></li>
<li><a href='#viz_funnel'><p>Funnel plot variants for meta-analysis</p></a></li>
<li><a href='#viz_rainforest'><p>Rainforest plots for meta-analyses</p></a></li>
<li><a href='#viz_sunset'><p>Sunset (power-enhanced) funnel plot</p></a></li>
<li><a href='#viz_thickforest'><p>Thick forest plots for meta-analyses</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Forest Plots, Funnel Plots, and Visual Funnel Plot Inference for
Meta-Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A compilation of functions to create visually appealing and information-rich 
    plots of meta-analytic data using 'ggplot2'. Currently allows to create forest plots, 
    funnel plots, and many of their variants, such as rainforest plots, thick forest plots, 
    additional evidence contour funnel plots, and sunset funnel plots. In addition, functionalities 
    for visual inference with the funnel plot in the context of meta-analysis are provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.1.0), nullabor (&ge; 0.3.5), dplyr (&ge; 0.7.8),
RColorBrewer (&ge; 1.1-2), metafor (&ge; 1.9-9), gridExtra (&ge;
2.2.1), ggpubr (&ge; 0.1.6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>Cairo (&ge; 1.5-9), knitr, rmarkdown</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Mkossmeier/metaviz">https://github.com/Mkossmeier/metaviz</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Mkossmeier/metaviz/issues">https://github.com/Mkossmeier/metaviz/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-07 17:43:53 UTC; micha</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Kossmeier [cre, aut],
  Ulrich S. Tran [aut],
  Martin Voracek [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Kossmeier &lt;michael.kossmeier@univie.ac.at&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-09 09:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='metaviz-package'>metaviz: Forest Plots, Funnel Plots, and Visual Funnel Plot Inference for Meta-Analysis</h2><span id='topic+metaviz-package'></span><span id='topic+metaviz'></span>

<h3>Description</h3>

<p>The package metaviz is a collection of functions to create visually
appealing and information-rich plots of meta-analytic data using ggplot2.
Functions to create several variants of forest plots (<code>viz_forest</code>),
funnel plots (<code>viz_funnel</code>, <code>viz_sunset</code>), and to conduct visual
inference with funnel plots (<code>funnelinf</code>) are provided.
</p>


<h3>Forest plots (<code>viz_forest</code>)</h3>

<p>Several different types and variants of forest plots can be created. This includes
classic forest plots, subgroup forest plots, cumulative summary forest plots, and leave-one-out sensitivity
forest plots. In addition, the function allows to individually label and color studies and to
align tables with furhter study-level and summary-level information.
</p>
<p>In addition to traditional forest plots, rainforest plots as well as thick forest plots can be used.
Rainforest and thick forest plots are two recently proposed variants and enhancements of
the classic forest plot. Both variants visually emphasize large studies
(with short confidence intervals and more weight in the meta-analysis), while small studies
(with wide confidence intervals and less weight in the meta-analysis) are visually less dominant.
For further details see <code>help(viz_forest)</code>, <code>help(viz_rainforest)</code>, and <code>help(viz_thickforest)</code>.
</p>


<h3>Funnel plots (<code>viz_funnel</code>, <code>viz_sunset</code>)</h3>

<p>Numerous different funnel plot variants can be created. Options for several graphical augmentations
(e.g., confidence, significance, and additional evidence contours; choice of the ordinate; showing
study subgroups), and different statistical information displayed are provided (Egger's regression line,
and imputed studies by, as well as the adjusted summary effect from, the trim-and-fill method).
Further details and references can be found in the corresponding help file (<code>help(viz_funnel)</code>).
</p>
<p>Moreover, a novel variant of the funnel plot is introduced which displays the power of studies to detect an effect
of interest (e.g., the meta-analytic summary effect) using a two-sided Wald test. This sunset (power-enhanced)
funnel plot uses color-coded regions and a second y axis to visualize study-level power and can help to
critically examine the evidentiality and credibility of a set of studies. For further details see <code>help(viz_sunset)</code>.
</p>


<h3>Visual inference with funnel plots (<code>funnelinf</code>)</h3>

<p>Funnel plots are widely used in meta-analysis to assess small study effects as potential indicator of publication bias.
Visual inference can help to improve the objectivity and validity of conclusions based on funnel plot examinations by
guarding the meta-analyst from interpreting patterns in the funnel plot that might be perfectly plausible by chance.
Only if the funnel plot showing the real data is distinguishable from simultaneously presented
null funnel plots showing data simulated under the null hypothesis, conclusion based on visually inspecting
the real-data funnel plot might be warranted. The function <code>funnelinf</code> provides numerous tailored
options to conduct visual inference with the funnel plot graph in the context of meta-analysis. See <code>help(funnelinf)</code> for further details and relevant references.
</p>


<h3>Meta-analytic example datasets</h3>

<p>Four different example datasets from published meta-analyses are distributed
with the package: </p>

<ul>
<li><p> Two datasets for meta-analysis with standardized mean differences (<code>mozart</code>, <code>homeopath</code>)
</p>
</li>
<li><p> One dataset for meta-analysis with correlation coefficients (<code>brainvol</code>)
</p>
</li>
<li><p> One dataset for meta-analysis with dichotomous outcome data (<code>exrehab</code>).
</p>
</li></ul>

<p>More details and corresponding references can be found in the respective help files
(<code>help(mozart)</code>, <code>help(homeopath)</code>, <code>help(brainvol)</code>, <code>help(exrehab)</code>).
</p>

<hr>
<h2 id='brainvol'>Example data for a meta-analysis of correlations: Human brain volume and intelligence</h2><span id='topic+brainvol'></span>

<h3>Description</h3>

<p>A dataset consisting of 83 empirical studies used in the meta-analysis of
Pietschnig, Penke, Wicherts, Zeiler, and Voracek (2015) on the associations between human brain volume and
intelligence (measured full-scale IQ) in healthy participant samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brainvol
</code></pre>


<h3>Format</h3>

<p>A data frame with 83 rows and 8 variables:
</p>

<dl>
<dt>study_name</dt><dd><p>short name of each study</p>
</dd>
<dt>year</dt><dd><p>publication year of each study</p>
</dd>
<dt>r</dt><dd><p>observed correlations between intelligence and brain size</p>
</dd>
<dt>z</dt><dd><p>Fisher's z transform of the observed correlations for meta-analysis</p>
</dd>
<dt>z_se</dt><dd><p>Standard error of Fisher's z transformed observed correlations for meta-analysis</p>
</dd>
<dt>n</dt><dd><p>sample size of each study</p>
</dd>
<dt>sex</dt><dd><p>categorical moderator variable: gender of the participants in each study</p>
</dd>
<dt>mean_age</dt><dd><p>continuous moderator variable: mean age of all participants in each study</p>
</dd>
</dl>



<h3>References</h3>

<p>Pietschnig, J., Penke, L., Wicherts, J. M., Zeiler, M., &amp; Voracek, M. (2015). Meta-analysis of
associations between human brain volume and intelligence differences: How strong are they and what do they mean?.
<em>Neuroscience &amp; Biobehavioral Reviews</em>, <em>57</em>, 411-432.
</p>

<hr>
<h2 id='exrehab'>Example data for a meta-analysis of dichotomous outcomes: Exercise-based cardiac rehabilitation</h2><span id='topic+exrehab'></span>

<h3>Description</h3>

<p>A dataset consisting of 14 empirical studies used for a meta-analysis in
Anderson et al. (2016). The outcome of interest was risk of hospital admission of patients
with coronary heart disease within follow up duration. Compared was
exercise-based cardiac rehabilitation (treatment) with usual care (control).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exrehab
</code></pre>


<h3>Format</h3>

<p>A data frame with 14 rows and 15 variables:
</p>

<dl>
<dt>study_name</dt><dd><p>short name of each study</p>
</dd>
<dt>year</dt><dd><p>publication year of each study</p>
</dd>
<dt>ai</dt><dd><p>number of patients in the treatment group with an event (hospital admission) for each study.</p>
</dd>
<dt>bi</dt><dd><p>number of patients in the treatment group with no event for each study.</p>
</dd>
<dt>ci</dt><dd><p>number of patients in the control group with an event (hospital admission) for each study.</p>
</dd>
<dt>di</dt><dd><p>number of patients in the control group with no event for each study.</p>
</dd>
<dt>n1i</dt><dd><p>number of patients in the treatment group for each study, (ai + bi).</p>
</dd>
<dt>n2i</dt><dd><p>number of patients in the control group for each study, (ci + di).</p>
</dd>
<dt>rr</dt><dd><p>relative risk of an event for treatment vs. control, (ai/n1i)/(ci/n2i).</p>
</dd>
<dt>or</dt><dd><p>odds ratio of an event for treatment vs. control, (ai*di)/(bi*ci).</p>
</dd>
<dt>logrr</dt><dd><p>natural logarithm of the relative risk (<code>rr</code>) for meta-analysis.</p>
</dd>
<dt>logrr_se</dt><dd><p>standard error of the natural logarithm of the relative risk for meta-analysis, sqrt(1/ai + 1/ci - 1/(ai + bi) - 1/(ci + di)).</p>
</dd>
<dt>logor</dt><dd><p>natural logarithm of the odds ratio (<code>or</code>) for meta-analysis.</p>
</dd>
<dt>logor_se</dt><dd><p>standard error of the natural logarithm of the odds ratio for meta-analysis, sqrt(1/ai + 1/bi +1/ci + 1/di).</p>
</dd>
<dt>followup</dt><dd><p>dichotomous moderator: follow up duration.</p>
</dd>
</dl>



<h3>References</h3>

<p>Anderson, L., Oldridge, N., Thompson, D. R., Zwisler, A. D., Rees, K.,
Martin, N., &amp; Taylor, R. S. (2016). Exercise-based cardiac rehabilitation for coronary
heart disease: Cochrane systematic review and meta-analysis.
<em>Journal of the American College of Cardiology</em>, <em>67</em>, 1-12.
</p>

<hr>
<h2 id='funnelinf'>Visual funnel plot inference for meta-analysis</h2><span id='topic+funnelinf'></span>

<h3>Description</h3>

<p>Creates a lineup of funnel plots to conduct visual funnel plot inference (Kossmeier, Tran, &amp; Voracek, 2019). The funnel plot showing the actually supplied data is
presented alongside null plots showing simulated data under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funnelinf(
  x,
  group = NULL,
  group_permut = FALSE,
  n = 20,
  null_model = "REM",
  y_axis = "se",
  contours = TRUE,
  sig_contours = TRUE,
  contours_col = "Blues",
  trim_and_fill = FALSE,
  trim_and_fill_side = "left",
  egger = FALSE,
  show_solution = FALSE,
  rorschach = FALSE,
  point_size = 1.5,
  text_size = 3,
  xlab = "Effect",
  ylab = NULL,
  x_trans_function = NULL,
  x_breaks = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funnelinf_+3A_x">x</code></td>
<td>
<p>data.frame or matrix with the effect sizes of all studies (e.g.,
correlations, log odds ratios, or Cohen <em>d</em>) in the first column and their
respective standard errors in the second column. Alternatively, x can be the
output object of function <code>rma.uni</code> from package
<span class="pkg">metafor</span>; then effect sizes and standard errors are extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_group">group</code></td>
<td>
<p>factor indicating the subgroup of each study to show in the funnel plot. Has to be in the same order than <code>x</code>.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_group_permut">group_permut</code></td>
<td>
<p>logical scalar indicating if subgroup membership should be permuted
in the null plots. Ignored if no group is supplied.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_n">n</code></td>
<td>
<p>integer specifying the absolute number of plots in the lineup.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_null_model">null_model</code></td>
<td>
<p>character string indicating which meta-analytic model should be used to simulate the effect sizes for the null plots.
Available options are &quot;FEM&quot; for the fixed effect model and &quot;REM&quot; (default) for the random-effects model (using the
DerSimonian-Laird method to estimate the between-study variance <code class="reqn">\tau^2</code>).</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_y_axis">y_axis</code></td>
<td>
<p>character string indicating which y axis should be used in the funnel plot. Available options are &quot;se&quot; (default) for
standard error and &quot;precision&quot; for the reciprocal of the standard error.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_contours">contours</code></td>
<td>
<p>logical scalar indicating if classic funnel plot confidence contours and the summary effect should be displayed (i.e., summary effect +/-
qnorm(0.975) * SE).</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_sig_contours">sig_contours</code></td>
<td>
<p>logical scalar. Should significance contours be drawn? Significance contours show which combination of
effect size and standard error lead to study p-values smaller than 0.05 or 0.01 (using a Wald test).</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_contours_col">contours_col</code></td>
<td>
<p>character string indicating the color palette used from package <span class="pkg">RColorBrewer</span> for
<code>sig_contours</code>. Can be any of &quot;Blues&quot;, &quot;Greys&quot;, &quot;Oranges&quot;, &quot;Greens&quot;, &quot;Reds&quot;, and &quot;Purples&quot;.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_trim_and_fill">trim_and_fill</code></td>
<td>
<p>logical scalar. Should studies imputed by the trim and fill method be displayed? Also shows the adjusted summary
effect if <code>contours</code> is <code>TRUE</code> as well.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_trim_and_fill_side">trim_and_fill_side</code></td>
<td>
<p>character string indicating on which side of the funnel plot studies should be imputed by the trim and fill method (i.e., on which side studies are presumably missing due to publication bias).
Must be either &quot;right&quot; or &quot;left&quot; (default).</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_egger">egger</code></td>
<td>
<p>logical scalar. Should Egger's regression line be drawn? Only available if <code>y_axis</code> is <code>"se"</code>.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_show_solution">show_solution</code></td>
<td>
<p>logical scalar. Should the real-data plot be highlighted?</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_rorschach">rorschach</code></td>
<td>
<p>logical scalar. Should the lineup only consist of null plots?</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_point_size">point_size</code></td>
<td>
<p>numeric value. Size of the study points in the funnel plots.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_text_size">text_size</code></td>
<td>
<p>numeric value. Size of text in the lineup.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_xlab">xlab</code></td>
<td>
<p>character string specifying the label of the x axis.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_ylab">ylab</code></td>
<td>
<p>character string specifying the label of the y axis.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_x_trans_function">x_trans_function</code></td>
<td>
<p>function to transform the labels of the x axis. Common uses are to transform
log-odds-ratios or log-risk-ratios with <code>exp</code> to their original scale (odds ratios and risk ratios), or Fisher's z values
back to correlation coefficients using <code>tanh</code>.</p>
</td></tr>
<tr><td><code id="funnelinf_+3A_x_breaks">x_breaks</code></td>
<td>
<p>numeric vector of values for the breaks on the x-axis. When used in tandem with <code>x_trans_function</code>
the supplied values should be not yet transformed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Funnel plots are widely used in meta-analysis to assess small study effects as potential indicator for publication bias.
However, interpretations of funnel plots often lead to false conclusions about the presence and severity of bias (e.g., Terrin, Schmid, and Lau, 2005).
Visual inference (Buja et al. 2009; Majumder, Hofmann, and Cook 2013) can help to improve the validity of conclusions based on the visual inspection of a
funnel plot by saving investigators from interpreting funnel-plot patterns which might be perfectly plausible by chance.
Only if the real-data funnel plot is distinguishable from null-plots, the null hypothesis is formally rejected and
conclusions based on the visual inspection of the real-data funnel plot might be warranted (for further details, see Kossmeier, Tran, &amp; Voracek, 2019).
</p>
<p>Function <code>funnelinf</code> utilizes package <span class="pkg">nullabor</span> for null plot simulation and <span class="pkg">ggplot2</span> for
plotting the lineup. Several tailored features for visual inference with funnel plots are provided which currently include:
</p>

<ol>
<li><p> options for null-plot simulation under both FEM and REM meta-analysis (see below).
</p>
</li>
<li><p> subgroup analysis.
</p>
</li>
<li><p> graphical options specific to the funnel plot (significance and confidence contours, and choice of the ordinate).
</p>
</li>
<li><p> additional options to display various statistical information (Egger's regression line, and imputed studies by, as well as the adjusted summary effect from, the trim-and-fill method).
</p>
</li></ol>

<p>Null plots are simulated assuming normally distributed effect sizes with expected value equal to the observed summary effect and variance
either equal to the observed study variances (<code>null_model = "FEM"</code>) or the sum of the observed study variances and the estimated
between study variance <code class="reqn">\tau^2</code> (<code>null_model = "REM"</code>).
</p>


<h3>Value</h3>

<p>A lineup of n (20 by default) funnel plots; one showing the real data and n-1 showing
simulated data under the null hypothesis
</p>


<h3>Author(s)</h3>

<p>Michael Kossmeier* &lt;michael.kossmeier@univie.ac.at&gt;
</p>
<p>Ulrich S. Tran* &lt;ulrich.tran@univie.ac.at&gt;
</p>
<p>Martin Voracek* &lt;martin.voracek@univie.ac.at&gt;
</p>
<p>*Department of Basic Psychological Research and Research Methods, School of Psychology, University of Vienna
</p>


<h3>References</h3>

<p>Buja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E. K., Swayne, D. F., &amp; Wickham, H. (2009).
Statistical inference for exploratory data analysis and model diagnostics.
<em>Philosophical Transactions of the Royal Society of London A: Mathematical, Physical and Engineering Sciences</em>,
<em>367</em>, 4361-4383.
</p>
<p>Kossmeier, M., Tran, U. &amp; Voracek, M. (2019) Visual inference for the funnel plot in meta-analysis. <em>Zeitschrift f√ºr Psychologie - Journal of Psychology</em>, <em>227</em>.
</p>
<p>Majumder, M., Hofmann, H., &amp; Cook, D. (2013). Validation of visual statistical inference, applied to linear models.
<em>Journal of the American Statistical Association</em>, <em>108</em>, 942-956.
</p>
<p>Terrin, N., Schmid, C. H., &amp; Lau, J. (2005). In an empirical evaluation of the funnel plot, researchers could not
visually identify publication bias. <em>Journal of clinical epidemiology</em>, <em>58</em>, 894-901.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Plotting a funnel plot lineup with the exrehab data to conduct visual funnel plot inference
funnelinf(x = exrehab[, c("logrr", "logrr_se")])

# Plotting a funnel plot lineup with the mozart data to conduct visual funnel plot inference
# considering subgroups
funnelinf(x = mozart[, c("d", "se")],
group = mozart[, "rr_lab"],
group_permut = TRUE, null_model = "REM")

# Plotting a funnel plot lineup with the brainvolume data to conduct visual funnel plot inference
# considering heterogeneity by using the fixed effect model for null plot simulation
funnelinf(x = brainvol[, c("z", "z_se")],
null_model = "FEM")

## End(Not run)
</code></pre>

<hr>
<h2 id='homeopath'>Example data for a meta-analysis of standardized mean differences: Homeopathic treatment vs. Placebo</h2><span id='topic+homeopath'></span>

<h3>Description</h3>

<p>A dataset consisting of 54 randomized control trials (RCTs) from a published meta-analysis
(Mathie et al. 2017) comparing homeopathic treatment with placebo. See reference for further details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>homeopath
</code></pre>


<h3>Format</h3>

<p>A data frame with 54 rows and 4 variables:
</p>

<dl>
<dt>name</dt><dd><p>short name of each RCT</p>
</dd>
<dt>year</dt><dd><p>publication year of each RCT</p>
</dd>
<dt>d</dt><dd><p>observed effect size (Standardized mean differences). Negative effect sizes indicate superiority of homeopathic treatment.</p>
</dd>
<dt>se</dt><dd><p>standard error of observed effect size</p>
</dd>
</dl>



<h3>References</h3>

<p>Mathie, R. T., Ramparsad, N., Legg, L. A., Clausen, J., Moss, S.,
Davidson, J. R., ... McConnachie, A. (2017). Randomised, double-blind, placebo-controlled
trials of non-individualised homeopathic treatment: Systematic review and meta-analysis.
<em>Systematic Reviews</em>, <em>6</em>, 63.
</p>

<hr>
<h2 id='internal_viz_classicforest'>Internal helper function of viz_forest to create a classic forest plot</h2><span id='topic+internal_viz_classicforest'></span>

<h3>Description</h3>

<p>Creates a classic forest plot. Called by viz_forest for type = &quot;classic&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>internal_viz_classicforest(
  plotdata,
  madata,
  type = "standard",
  study_labels = NULL,
  summary_label = NULL,
  study_table = NULL,
  summary_table = NULL,
  annotate_CI = FALSE,
  confidence_level = 0.95,
  col = "Blues",
  summary_col = "Blues",
  tick_col = "firebrick",
  text_size = 3,
  xlab = "Effect",
  x_limit = NULL,
  x_trans_function = NULL,
  x_breaks = NULL
)
</code></pre>

<hr>
<h2 id='internal_viz_rainforest'>Internal helper function of viz_rainforest and viz_forest to create a rainforest plot.</h2><span id='topic+internal_viz_rainforest'></span>

<h3>Description</h3>

<p>Creates a rainforest plot. Called by viz_rainforest and viz_forest for type = &quot;rain&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>internal_viz_rainforest(
  plotdata,
  madata,
  type = "standard",
  study_labels = NULL,
  summary_label = NULL,
  study_table = NULL,
  summary_table = NULL,
  annotate_CI = FALSE,
  confidence_level = 0.95,
  col = "Blues",
  summary_col = "Blues",
  detail_level = 1,
  text_size = 3,
  xlab = "Effect",
  x_limit = NULL,
  x_trans_function = NULL,
  x_breaks = NULL
)
</code></pre>

<hr>
<h2 id='internal_viz_thickforest'>Internal helper function of viz_thickforest and viz_forest to create a thick forest plot</h2><span id='topic+internal_viz_thickforest'></span>

<h3>Description</h3>

<p>Creates a thick forest plot. Called by viz_thickforest and viz_forest for type = &quot;thick&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>internal_viz_thickforest(
  plotdata,
  madata,
  type = "standard",
  study_labels = NULL,
  summary_label = NULL,
  study_table = NULL,
  summary_table = NULL,
  annotate_CI = FALSE,
  confidence_level = 0.95,
  col = "Blues",
  summary_col = "Blues",
  tick_col = "firebrick",
  text_size = 3,
  xlab = "Effect",
  x_limit = NULL,
  x_trans_function = NULL,
  x_breaks = NULL
)
</code></pre>

<hr>
<h2 id='mozart'>Example data for a meta-analysis of standardized mean differences: Mozart effect</h2><span id='topic+mozart'></span>

<h3>Description</h3>

<p>A dataset consisting of 38 empirical studies used in the meta-analysis of
Pietschnig, Voracek, and Formann (2010) on the Mozart effect. Each study compared the spatial
task performance of participants after hearing the first movement &quot;allegro
con spirito&quot; of the Mozart sonata for two pianos in D major (KV 448) with
the spatial task performance of participants who were exposed to a non-musical
stimulus or no stimulus at all.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mozart
</code></pre>


<h3>Format</h3>

<p>A data frame with 38 rows and 6 variables:
</p>

<dl>
<dt>study_name</dt><dd><p>short name of each study</p>
</dd>
<dt>n</dt><dd><p>sample size of each study</p>
</dd>
<dt>d</dt><dd><p>observed effect size (Cohen <em>d</em>). Positive values correspond to higher mean performance in the group hearing the Mozart sonata</p>
</dd>
<dt>se</dt><dd><p>standard error of observed effect size</p>
</dd>
<dt>unpublished</dt><dd><p>dichotomous moderator variable: Was the
study unpublished?</p>
</dd>
<dt>rr_lab</dt><dd><p>dichotomous moderator variable: Was the study conducted in the lab of authors Rauscher or Rideout?</p>
</dd>
</dl>



<h3>References</h3>

<p>Pietschnig, J., Voracek, M., &amp; Formann, A. K. (2010). Mozart
effect-Shmozart effect: A meta-analysis. <em>Intelligence</em>, <em>38</em>, 314-323.
</p>

<hr>
<h2 id='viz_forest'>Forest plot variants for meta-analyses</h2><span id='topic+viz_forest'></span>

<h3>Description</h3>

<p>Creates a rainforest, thick forest, or classic forest plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>viz_forest(
  x,
  group = NULL,
  type = "standard",
  variant = "classic",
  method = "FE",
  study_labels = NULL,
  summary_label = NULL,
  confidence_level = 0.95,
  col = "Blues",
  summary_col = col,
  text_size = 3,
  xlab = "Effect",
  x_limit = NULL,
  x_trans_function = NULL,
  x_breaks = NULL,
  annotate_CI = FALSE,
  study_table = NULL,
  summary_table = NULL,
  table_headers = NULL,
  table_layout = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="viz_forest_+3A_x">x</code></td>
<td>
<p>data.frame or matrix with the effect sizes of all studies (e.g.,
correlations, log odds ratios, or Cohen <em>d</em>) in the first column and their
respective standard errors in the second column. Alternatively, x can be the
output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package
<span class="pkg">metafor</span>; then effect sizes and standard errors are extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_group">group</code></td>
<td>
<p>factor indicating the subgroup of each study to plot a subgroup forest plot. Has to be in the same order than <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_type">type</code></td>
<td>
<p>character string indicating the type of forest plot to be plotted. Can be &quot;standard&quot; (default), &quot;study_only&quot;,
&quot;summary_only&quot;, &quot;cumulative&quot;, or &quot;sensitivity&quot;. See 'Details'.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_variant">variant</code></td>
<td>
<p>character string indicating the forest plot variant that should be plotted. Can be &quot;classic&quot; (default) for a traditional forest plot,
&quot;rain&quot; for rainforest plot, &quot;thick&quot; for a thick forest plot.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_method">method</code></td>
<td>
<p>character string indicating which method should be used to compute the study weights and summary effect(s).
Can be any method argument from function <code>rma.uni</code> of package <span class="pkg">metafor</span>
(e.g., &quot;FE&quot; for the fixed effect model, or &quot;DL&quot; for the random effects model using the
DerSimonian-Laird method to estimate <code class="reqn">\tau^2</code>).
If input <code>x</code> is an output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package <span class="pkg">metafor</span>, then the method is extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_study_labels">study_labels</code></td>
<td>
<p>a character vector with names/identifiers to annotate each study in the forest plot.
Has to be in the same order than <code>x</code>. Ignored if <code>study_table</code> and/or <code>summary_table</code> is supplied.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_summary_label">summary_label</code></td>
<td>
<p>a character string specifying the name to annotate the summary effect. If a subgroup
analysis is plotted, <code>summary_label</code> should be a character vector with a name for each
subgroup summary effect, arranged in the order of the levels of <code>group</code>. Ignored if <code>study_table</code> and/or
<code>summary_table</code> is supplied.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_confidence_level">confidence_level</code></td>
<td>
<p>numeric value. The confidence level for the plotted confidence intervals.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_col">col</code></td>
<td>
<p>character string specifying the main color for plotting study-level results. For <code>variant = "thick"</code> and <code>variant = "classic"</code> can be a vector of length <code>nrow(x)</code>
with colors for each study-level result individually.
For <code>variant = "rain"</code> must be one of the following palettes from package
<span class="pkg">RColorBrewer</span>: &quot;Blues&quot;, &quot;Greys&quot;, &quot;Oranges&quot;, &quot;Greens&quot;, &quot;Reds&quot;, or &quot;Purples&quot;.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_summary_col">summary_col</code></td>
<td>
<p>character string specifying the main color for plotting the summary effect(s). For <code>variant = "thick"</code> and <code>variant = "classic"</code> can be a vector
with colors for each subgroup summary effect individually. For <code>variant = "rain"</code> with <code>type = "summary_only"</code> must be one of the following palettes from package
<span class="pkg">RColorBrewer</span>: &quot;Blues&quot;, &quot;Greys&quot;, &quot;Oranges&quot;, &quot;Greens&quot;, &quot;Reds&quot;, or &quot;Purples&quot;.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_text_size">text_size</code></td>
<td>
<p>numeric value. Size of text in the forest plot. Default is 3.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_xlab">xlab</code></td>
<td>
<p>character string specifying the label of the x axis. By default also used for the header of the aligned table if <code>annotate_CI</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_x_limit">x_limit</code></td>
<td>
<p>numeric vector of length 2 with the limits (minimum, maximum) of the x axis.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_x_trans_function">x_trans_function</code></td>
<td>
<p>function to transform the labels of the x axis. Common uses are to transform
log-odds-ratios or log-risk-ratios with <code>exp</code> to their original scale (odds ratios and risk ratios), or Fisher's z values
back to correlation coefficients using <code>tanh</code>.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_x_breaks">x_breaks</code></td>
<td>
<p>numeric vector of values for the breaks on the x-axis. When used in tandem with <code>x_trans_function</code>
the supplied values should be not yet transformed.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_annotate_ci">annotate_CI</code></td>
<td>
<p>logical scalar. Should the effect size and confidence interval values be shown as text in an aligned table on the right-hand side of the forest plot?</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_study_table">study_table</code></td>
<td>
<p>a data.frame with additional study-level variables which should be shown in an aligned table.
Has to be in the same order than <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_summary_table">summary_table</code></td>
<td>
<p>a data.frame with additional summary-level information shown in an aligned table.
If <code>group</code> is supplied, <code>summary_table</code> must have a row for each subgroup
summary effect, arranged in the order of the levels of <code>group</code>.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_table_headers">table_headers</code></td>
<td>
<p>character vector. Headers for each column of aligned tables via <code>study_table</code>, <code>summary_table</code>, and/or <code>annotate_CI</code>.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_table_layout">table_layout</code></td>
<td>
<p>numeric layout matrix passed to <code>layout_matrx</code> of <code><a href="gridExtra.html#topic+arrangeGrob">arrangeGrob</a></code>. Can be used to overwrite the default spacing
of the forest plot and aligned tables via <code>study_table</code>, <code>summary_table</code>, and <code>annotate_CI</code>.</p>
</td></tr>
<tr><td><code id="viz_forest_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="#topic+viz_rainforest">viz_rainforest</a></code> for <code>variant = "rain"</code>, or
<code><a href="#topic+viz_thickforest">viz_thickforest</a></code> for <code>variant = "thick"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The forest plot is the most widely used display to visualize meta-analytic results.
The function <code>viz_forest</code> creates visually appealing and informative-rich forest plots using ggplot2. Many options
to flexibly customize the visual appearance and statistical information displayed are provided. In addition,
rainforest plots as well as the thick forest plots can be created, two variants and enhancements of the
classical forest plot recently proposed by Schild and Voracek (2015). For further details see the documentation of
the wrapper functions <code><a href="#topic+viz_rainforest">viz_rainforest</a></code>, and <code><a href="#topic+viz_thickforest">viz_thickforest</a></code>.
</p>
<p><b>Available forest plot types</b>
</p>
<p>Different aspects of meta-analytic data can be shown in forest plots. Five different types are available in <code>viz_forest</code> via the <code>type</code> parameter.
Argument <code>"standard"</code> (default) shows study results as well as summary results in the forest plot. <code>"study_only"</code> allows to only show study results without the meta-analytic summary estimate.
<code>"summary_only"</code> can be used to only show meta-analytic summary estimate(s), which is primarily useful to visualize several subgroup results (using <code>group</code>).
<code>"cumulative"</code> shows a cumulative meta-analysis, that is, meta-analytic summary effects are computed sequentially by adding each study one-by-one.
Studies are added in the same order than they were supplied in <code>x</code>. Finally, <code>"sensitivity"</code> shows for each study the meta-analytic summary
effect if that particular study is not considered in the computation of the summary effect (leave-one-out analysis).
</p>


<h3>Value</h3>

<p>A forest plot is created using ggplot2.
</p>


<h3>Author(s)</h3>

<p>Michael Kossmeier* &lt;michael.kossmeier@univie.ac.at&gt;
</p>
<p>Ulrich S. Tran* &lt;ulrich.tran@univie.ac.at&gt;
</p>
<p>Martin Voracek* &lt;martin.voracek@univie.ac.at&gt;
</p>
<p>*Department of Basic Psychological Research and Research Methods, School of Psychology, University of Vienna
</p>


<h3>References</h3>

<p>Schild, A. H., &amp; Voracek, M. (2015). Finding your way out of the
forest without a trail of bread crumbs: Development and evaluation of two
novel displays of forest plots. <em>Research Synthesis Methods</em>, <em>6</em>,
74-86.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(metaviz)
# Plotting the mozart data using a classic forest plot
viz_forest(x = mozart[, c("d", "se")],
study_labels = mozart[, "study_name"], xlab = "Cohen d")

# Subgroup analysis of published and unpublished studies shown in a rainforest plot
viz_forest(x = mozart[, c("d", "se")], study_labels = mozart[, "study_name"], method = "REML",
variant = "rain", summary_label = c("Summary (rr_lab = no)", "Summary (rr_lab = yes)"),
group = mozart[, "rr_lab"], xlab = "Cohen d")

# Thick forest plot with additional information in aligned tables. Log risk
# ratios are labeled in their original metric (risk ratios) on the x axis.
viz_forest(x = exrehab[, c("logrr", "logrr_se")], variant = "thick",
xlab = "RR", x_trans_function = exp, annotate_CI = TRUE,
study_table = data.frame(
Name = exrehab[, "study_name"],
eventsT = paste(exrehab$ai, "/", exrehab$ai + exrehab$bi, sep = ""),
eventsC = paste(exrehab$ci, "/", exrehab$ci + exrehab$di, sep = "")),
summary_table = data.frame(
Name = "Summary",
eventsT = paste(sum(exrehab$ai), "/", sum(exrehab$ai + exrehab$bi), sep = ""),
eventsC = paste(sum(exrehab$ci), "/", sum(exrehab$ci + exrehab$di), sep = "")),
table_layout = matrix(c(1, 1, 2, 2, 3), nrow = 1))
</code></pre>

<hr>
<h2 id='viz_funnel'>Funnel plot variants for meta-analysis</h2><span id='topic+viz_funnel'></span>

<h3>Description</h3>

<p>Creates a funnel plot. Many options regarding the appearance and
statistical information displayed are provided (e.g., significance contours, additional evidence contours, and
trim-and-fill analysis).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>viz_funnel(
  x,
  group = NULL,
  y_axis = "se",
  method = "FE",
  contours = TRUE,
  sig_contours = TRUE,
  addev_contours = FALSE,
  contours_col = "Blues",
  contours_type = "FEM",
  detail_level = 1,
  egger = FALSE,
  trim_and_fill = FALSE,
  trim_and_fill_side = "left",
  text_size = 3,
  point_size = 2,
  xlab = "Effect",
  ylab = NULL,
  group_legend = FALSE,
  group_legend_title = "",
  x_trans_function = NULL,
  x_breaks = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="viz_funnel_+3A_x">x</code></td>
<td>
<p>data.frame or matrix with the effect sizes of all studies (e.g.,
correlations, log odds ratios, or Cohen <em>d</em>) in the first column and their
respective standard errors in the second column. Alternatively, x can be the
output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package
<span class="pkg">metafor</span>; then effect sizes and standard errors are extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_group">group</code></td>
<td>
<p>factor indicating the subgroup of each study to show in the funnel plot. Has to be in the same order than <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_y_axis">y_axis</code></td>
<td>
<p>character string indicating which y axis should be used in the funnel plot. Available options are &quot;se&quot; (default) for
standard error and &quot;precision&quot; for the reciprocal of the standard error.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_method">method</code></td>
<td>
<p>character string indicating the method used to compute the meta-analytic summary effect and, for a random effects model,
the between-study variance <code class="reqn">\tau^2</code>. Can be any method argument from <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code>
(e.g., &quot;FE&quot; for the fixed effect model, or &quot;DL&quot; for the random effects model using the DerSimonian-Laird method to estimate <code class="reqn">\tau^2</code>).
If input <code>x</code> is an output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package <span class="pkg">metafor</span>, then the method is extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_contours">contours</code></td>
<td>
<p>logical scalar indicating if classic funnel plot confidence contours and the summary effect
should be displayed.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_sig_contours">sig_contours</code></td>
<td>
<p>logical scalar. Should significance contours be drawn (at the 0.05 or 0.01 level using a Wald test)?</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_addev_contours">addev_contours</code></td>
<td>
<p>logical scalar. Should approximate additional evidence contours be drawn, showing the significance of the updated summary effect? See Details.
Note: For <code>method</code> other than &quot;FE&quot; or &quot;DL&quot; runtime is increased significantly. Consider reducing <code>detail_level</code>.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_contours_col">contours_col</code></td>
<td>
<p>character string indicating the color palette used from package <span class="pkg">RColorBrewer</span> for
<code>sig_contours</code>, and <code>addev_contours</code>. Can be any of &quot;Blues&quot;, &quot;Greys&quot;, &quot;Oranges&quot;, &quot;Greens&quot;, &quot;Reds&quot;, and &quot;Purples&quot;.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_contours_type">contours_type</code></td>
<td>
<p>character string indicating how confidence contours are computed.
Must be either &quot;FEM&quot; or &quot;REM&quot;. If contours_type is set to &quot;FEM&quot; (default), contours are given as M +/- qnorm(0.975)*SE,
with M the meta-analytic summary effect and SE the study standard error. If contours_type is set to &quot;REM&quot;, contours are given as
M +/- qnorm(0.975)*sqrt(SE^2 + <code class="reqn">\tau^2</code>), with M again the meta-analytic summary effect, SE the study standard error
and <code class="reqn">\tau^2</code> the esimated between study heterogeneity from a random effects model. The argument of contours_type has no effect if <code class="reqn">\tau^2</code> is zero.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_detail_level">detail_level</code></td>
<td>
<p>numeric scalar. Allows to increase or decrease the plotting detail of contours. Values can be chosen between 0.1 and 10. Default is 1.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_egger">egger</code></td>
<td>
<p>logical scalar. Should Egger's regression line be drawn? Only available if <code>y_axis</code> is <code>"se"</code>.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_trim_and_fill">trim_and_fill</code></td>
<td>
<p>logical scalar. Should studies imputed by the trim and fill method be displayed? Also shows the adjusted summary
effect if <code>contours</code> is <code>TRUE</code> as well.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_trim_and_fill_side">trim_and_fill_side</code></td>
<td>
<p>character string indicating on which side of the funnel plot studies should be imputed by the trim and fill method (i.e., on which side are studies presumably missing due to publication bias).
Must be either &quot;right&quot; or &quot;left&quot; (default).</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_text_size">text_size</code></td>
<td>
<p>numeric value. Size of text in the funnel plot. Default is 3.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_point_size">point_size</code></td>
<td>
<p>numeric value. Size of the study points in the funnel plot. Default is 2.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_xlab">xlab</code></td>
<td>
<p>character string specifying the label of the x axis.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_ylab">ylab</code></td>
<td>
<p>character string specifying the label of the y axis.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_group_legend">group_legend</code></td>
<td>
<p>logical scalar. Should there be a legend shown at the bottom of the graph if <code>group</code> was supplied?</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_group_legend_title">group_legend_title</code></td>
<td>
<p>a character string specifying the title of the legend if <code>group</code> was supplied and <code>group_legend</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_x_trans_function">x_trans_function</code></td>
<td>
<p>function to transform the labels of the x axis. Common uses are to transform
log-odds-ratios or log-risk-ratios with <code>exp</code> to their original scale (odds ratios and risk ratios), or Fisher's z values
back to correlation coefficients using <code>tanh</code>.</p>
</td></tr>
<tr><td><code id="viz_funnel_+3A_x_breaks">x_breaks</code></td>
<td>
<p>numeric vector of values for the breaks on the x-axis. When used in tandem with <code>x_trans_function</code>
the supplied values should be not yet transformed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The funnel plot is a widely used diagnostic plot in meta-analysis to assess small study effects
and in particular publication bias. The function <code>viz_funnel</code> is capable to create a large set of different funnel plot variants.
Options for several graphical augmentations (e.g., confidence, significance, and additional evidence contours; choice of the ordinate; study subgroups), and
different statistical information displayed are provided (Egger's regression line, and imputed studies by, as well as the adjusted summary effect from,
the trim-and-fill method).
</p>
<p><b>Contours</b>
</p>
<p>Three different contours are available in <code>viz_funnel</code>:
</p>

<ol>
<li> <p><b>confidence contours</b> (argument <code>contours</code>) show the region where one expects 95% of all studies to fall (assuming the meta-analytic model
applied is true and all estimates are identical to the parameters of interest).
Confidence contours can help to assess the plausibility of observations given the meta-analytic model specified (fixed effect or random effects model).
</p>
</li>
<li> <p><b>significance contours</b> (argument <code>sig_contours</code>) show shaded regions of individual study significance at the 5% and 1% level
(using the standard errors supplied and a Wald test). Significance contours were proposed to help distinguish publication bias from other sources of
funnel plot asymmetry (Peters, Sutton, Jones, Abrams, &amp; Rushton, 2008).
</p>
</li>
<li> <p><b>additional evidence contours: Significance of the summary effect</b> (argument <code>addev_contours</code>). These contours define regions
where a new study has to fall such that the updated meta-analytic summary effect is significantly different from zero or not
(using a two-sided test and an alpha level of 5%). Additional evidence contours allow to assess the robustness of the meta-analysis with respect to
the effect of potentially new published evidence on the significance of the meta-analytic summary effect (Langan, Higgins, Gregory, &amp; Sutton, 2012).
</p>
</li></ol>

<p><b>Measure on the y-axis</b>
</p>
<p>Two different options for the y-axis choice are available. First, to plot the standard errors on a reversed axis
(i.e., studies with small standard errors are at the top). Second, precision (i.e., 1 divided by the standard error) can be used.
Standard errors on the y-axis should be preferred in most situations but precision might have advantages if one or few large studies
(with high precision) should be compared to the results of smaller studies condensed at the bottom of the funnel plot (Sterne &amp; Egger, 2001).
</p>
<p><b>Egger's regression line</b>
</p>
<p>Egger's regression line (Egger, Smith, Schneider &amp; Minder, 1997) can be displayed if the standard error is used on the y axis.
Classic Egger's regression can be computed as the OLS estimator of regressing the standardized effect size (effect size divided by its standard error)
on precision (1 divided by the standard error). Showing this line in the funnel plot can further help to visually assess funnel plot asymmetry.
</p>
<p><b>Trim and fill analysis</b>
</p>
<p>Imputed studies by the trim-and fill method, as well as the adjusted summary effect (Duval &amp; Tweedie, 2000) can be displayed.
The trim-and fill algorithm basically estimates the number of (extreme) studies responsible for funnel plot asymmetry.
It then trims this number of (extreme) studies and computes the adjusted summary effect only considering the remaining studies.
Finally, it imputes studies - presumably missing due to publication bias - by mirroring the trimmed (extreme) studies (driving the funnel plot asymmetry)
around the (adjusted) summary effect. The user has to specify on which side of the funnel plot the trim-and fill method should impute missing studies
(i.e., the direction were studies are presumably missing due to publication bias). To estimate the number of (extreme) studies responsible for funnel plot
asymmetry the L estimator defined in Duval and Tweedie (2000) is used.
</p>


<h3>Value</h3>

<p>A funnel plot is created using ggplot2.
</p>


<h3>Author(s)</h3>

<p>Michael Kossmeier* &lt;michael.kossmeier@univie.ac.at&gt;
</p>
<p>Ulrich S. Tran* &lt;ulrich.tran@univie.ac.at&gt;
</p>
<p>Martin Voracek* &lt;martin.voracek@univie.ac.at&gt;
</p>
<p>*Department of Basic Psychological Research and Research Methods, School of Psychology, University of Vienna
</p>


<h3>References</h3>

<p>Duval, S., &amp; Tweedie, R. (2000). Trim and fill: a simple funnel-plot-based method of testing and adjusting for publication bias
in meta-analysis. <em>Biometrics</em>, <em>56</em>, 455-463.
</p>
<p>Egger, M., Smith, G. D., Schneider, M., &amp; Minder, C. (1997). Bias in meta-analysis detected by a simple, graphical test. <em>Bmj</em>, <em>315</em>, 629-634.
</p>
<p>Langan, D., Higgins, J. P., Gregory, W., &amp; Sutton, A. J. (2012). Graphical augmentations to the funnel plot assess the impact of
additional evidence on a meta-analysis. <em>Journal of clinical epidemiology</em>, <em>65</em>, 511-519.
</p>
<p>Peters, J. L., Sutton, A. J., Jones, D. R., Abrams, K. R., &amp; Rushton, L. (2008). Contour-enhanced meta-analysis
funnel plots help distinguish publication bias from other causes of asymmetry. <em>Journal of clinical epidemiology</em>, <em>61</em>,
991-996.
</p>
<p>Sterne, J. A., &amp; Egger, M. (2001). Funnel plots for detecting bias in meta-analysis: guidelines on choice of axis.
<em>Journal of clinical epidemiology</em>, <em>54</em>, 1046-1055
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(metaviz)
# Create a funnel plot using confidence and significance contours
viz_funnel(x = mozart[, c("d", "se")])

# Show a trim-and-fill analysis and Egger's regression line:
viz_funnel(x = mozart[, c("d", "se")], contours = TRUE,
trim_and_fill = TRUE, trim_and_fill_side = "left", egger = TRUE)

# Plot log-odds-ratios on the original OR scale and show additional evidence contours:
viz_funnel(x = exrehab[, c("logor", "logor_se")], sig_contours = FALSE,
addev_contours = TRUE, contours_col = "Greys", xlab = "Odds Ratio",
x_trans_function = exp, x_breaks = log(c(0.125, 0.25, 0.5, 1, 2, 4, 8)))

# Show study subgroups
viz_funnel(x = mozart[, c("d", "se")], group = mozart[, "unpublished"],
group_legend_title = "unpublished?")
</code></pre>

<hr>
<h2 id='viz_rainforest'>Rainforest plots for meta-analyses</h2><span id='topic+viz_rainforest'></span><span id='topic+rainforest'></span>

<h3>Description</h3>

<p>Creates a rainforest plot, a novel variant of the forest plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>viz_rainforest(
  x,
  group = NULL,
  type = "standard",
  method = "FE",
  study_labels = NULL,
  summary_label = NULL,
  confidence_level = 0.95,
  detail_level = 1,
  col = "Blues",
  summary_col = col,
  text_size = 3,
  xlab = "Effect",
  x_limit = NULL,
  x_trans_function = NULL,
  x_breaks = NULL,
  annotate_CI = FALSE,
  study_table = NULL,
  summary_table = NULL,
  table_headers = NULL,
  table_layout = NULL,
  ...
)

rainforest(
  x,
  group = NULL,
  type = "standard",
  method = "FE",
  study_labels = NULL,
  summary_label = NULL,
  confidence_level = 0.95,
  detail_level = 1,
  col = "Blues",
  summary_col = col,
  text_size = 3,
  xlab = "Effect",
  x_limit = NULL,
  x_trans_function = NULL,
  x_breaks = NULL,
  annotate_CI = FALSE,
  study_table = NULL,
  summary_table = NULL,
  table_headers = NULL,
  table_layout = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="viz_rainforest_+3A_x">x</code></td>
<td>
<p>data.frame or matrix with the effect sizes of all studies (e.g.,
correlations, log odds ratios, or Cohen <em>d</em>) in the first column and their
respective standard errors in the second column. Alternatively, x can be the
output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package
<span class="pkg">metafor</span>; then effect sizes and standard errors are extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_group">group</code></td>
<td>
<p>factor indicating the subgroup of each study to plot a subgroup forest plot. Has to be in the same order than <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_type">type</code></td>
<td>
<p>character string indicating the type of forest plot to be plotted. Can be &quot;standard&quot; (default), &quot;study_only&quot;,
&quot;summary_only&quot;, &quot;cumulative&quot;, or &quot;sensitivity&quot;. See 'Details'.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_method">method</code></td>
<td>
<p>character string indicating which method should be used to compute the study weights and summary effect(s).
Can be any method argument from <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code>
(e.g., &quot;FE&quot; for the fixed effect model, or &quot;DL&quot; for the random effects model using the
DerSimonian-Laird method to estimate <code class="reqn">\tau^2</code>).
If input <code>x</code> is an output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package <span class="pkg">metafor</span>, then the method is extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_study_labels">study_labels</code></td>
<td>
<p>a character vector with names/identifiers to annotate each study in the forest plot.
Has to be in the same order than <code>x</code>. Ignored if <code>study_table</code> and/or <code>summary_table</code> is supplied.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_summary_label">summary_label</code></td>
<td>
<p>a character string specifying the name to annotate the summary effect. If a subgroup
analysis is plotted, <code>summary_label</code> should be a character vector with a name for each
subgroup summary effect, arranged in the order of the levels of <code>group</code>. Ignored if <code>study_table</code> and/or
<code>summary_table</code> is supplied.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_confidence_level">confidence_level</code></td>
<td>
<p>numeric value. The confidence level for the plotted confidence intervals and likelihood raindrops.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_detail_level">detail_level</code></td>
<td>
<p>numeric value. Values larger than 1 lead to a higher
plotting detail (i.e., smoother likelihood raindrop polygons and more fluent
color shading), values smaller than 1 to less plotting detail compared to
the default plot.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_col">col</code></td>
<td>
<p>character string specifying the color palette for plotting study-level results from package <span class="pkg">RColorBrewer</span>.
Can be any of &quot;Blues&quot;, &quot;Greys&quot;, &quot;Oranges&quot;, &quot;Greens&quot;, &quot;Reds&quot;, and &quot;Purples&quot;.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_summary_col">summary_col</code></td>
<td>
<p>character string specifying the color for plotting the summary effect(s). Can be any of &quot;Blues&quot;, &quot;Greys&quot;, &quot;Oranges&quot;, &quot;Greens&quot;, &quot;Reds&quot;, and &quot;Purples&quot;.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_text_size">text_size</code></td>
<td>
<p>numeric value. Size of text in the forest plot. Default is 3.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_xlab">xlab</code></td>
<td>
<p>character string specifying the label of the x axis. By default also used for the header of the aligned table if <code>annotate_CI</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_x_limit">x_limit</code></td>
<td>
<p>numeric vector of length 2 with the limits (minimum, maximum) of the x axis.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_x_trans_function">x_trans_function</code></td>
<td>
<p>function to transform the labels of the x axis. Common uses are to transform
log-odds-ratios or log-risk-ratios with <code>exp</code> to their original scale (odds ratios and risk ratios), or Fisher's z values
back to correlation coefficients using <code>tanh</code>.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_x_breaks">x_breaks</code></td>
<td>
<p>numeric vector of values for the breaks on the x-axis. When used in tandem with <code>x_trans_function</code>
the supplied values should be not yet transformed.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_annotate_ci">annotate_CI</code></td>
<td>
<p>logical scalar. Should the effect size and confidence interval values be shown as text in an aligned table on the right-hand side of the forest plot?</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_study_table">study_table</code></td>
<td>
<p>a data.frame with additional study-level variables which should be shown in an aligned table.
Has to be in the same order than <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_summary_table">summary_table</code></td>
<td>
<p>a data.frame with additional summary-level information shown in an aligned table.
If <code>group</code> is supplied, <code>summary_table</code> must have a row for each subgroup
summary effect, arranged in the order of the levels of <code>group</code>.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_table_headers">table_headers</code></td>
<td>
<p>character vector. Headers for each column of aligned tables via <code>study_table</code>, <code>summary_table</code>, or <code>annotate_CI</code>.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_table_layout">table_layout</code></td>
<td>
<p>numeric layout matrix passed to <code>layout_matrx</code> of <code><a href="gridExtra.html#topic+arrangeGrob">arrangeGrob</a></code>. Can be used to overwrite the default spacing
of the forest plot and aligned tables via <code>study_table</code>, <code>summary_table</code>, and <code>annotate_CI</code>.</p>
</td></tr>
<tr><td><code id="viz_rainforest_+3A_...">...</code></td>
<td>
<p>deprecated argument names from earlier versions can still be passed to <code>viz_rainforest</code> via <code>...</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rainforest plots were proposed by Schild and Voracek (2015) as a variant and
enhancement of classic forest plots. Rainforest plots use (log-)likelihood drops
to depict study level results (for details, see Barrowman &amp;
Myers, 2003). <code>viz_rainforest</code> assumes normality of effect sizes to
construct these (log-)likelihood drops. The width of each such raindrop is identical to the
width of the confidence interval. For a given (log-)likelihood raindrop,
the height can be interpreted as the plausibility (i.e., (log-)likelihood value) for different true
values given the observed estimate. Moreover, the height of each raindrop is scaled with respect
to its relative meta-analytic weight considering all studies. Therefore, visually comparing heights of
different raindrops highlights the relative importance within the meta-analysis.
In addition, color shading is utilized to further visualize statistical uncertainty, as suggested by Jackson (2008).
Finally, study and summary level point estimates are depicted clearly by a specific symbol.
</p>
<p>Rainforest plots have the following advantages, as compared to classic forest plots:
</p>
 <ol>
<li><p> The width of the likelihood raindrops corresponds to the
confidence intervals, as also shown in the classic forest plot. In addition,
for each likelihood drop the height (and color shading) visualizes the
plausibility of true values given the observed estimate.
</p>
</li>
<li><p> Low likelihood drops and light color shading causes small studies (with
wide confidence intervals and less weight in the meta-analysis) to be visually less
dominant.
</p>
</li>
<li><p> In classic forest plots, it is often hard to depict the magnitude of
point estimates to a reasonable degree of accuracy, especially for studies
with large meta-analytic weights and correspondingly large plotting symbols
(commonly squares). Specific symbols within the raindrops improve the
visualization of study point estimates. </p>
</li></ol>

<p>Note that for subgroup analysis the height of each raindrop is scaled by the weight of each study within the subgroup divided by
the total weight sum of all studies irrespective of subgroup. Therefore, with subgroups present, the overall impression of raindrop
heights and color shading within a given subgroup compared to other subgroups conveys information about the relative precision of the meta-analytic
subgroup estimates.
</p>


<h3>Value</h3>

<p>A Rainforest plot is created using ggplot2.
</p>


<h3>Author(s)</h3>

<p>Michael Kossmeier* &lt;michael.kossmeier@univie.ac.at&gt;
</p>
<p>Ulrich S. Tran* &lt;ulrich.tran@univie.ac.at&gt;
</p>
<p>Martin Voracek* &lt;martin.voracek@univie.ac.at&gt;
</p>
<p>*Department of Basic Psychological Research and Research Methods, School of Psychology, University of Vienna
</p>


<h3>References</h3>

<p>Barrowman, N. J., &amp; Myers, R. A. (2003). Raindrop plots: A new way
to display collections of likelihoods and distributions. <em>American
Statistician</em>, <em>57</em>, 268-274.
</p>
<p>Jackson, C. H. (2008). Displaying uncertainty with shading.
<em>American Statistician</em>, <em>62</em>, 340-347.
</p>
<p>Schild, A. H., &amp; Voracek, M. (2015). Finding your way out of the
forest without a trail of bread crumbs: Development and evaluation of two
novel displays of forest plots. <em>Research Synthesis Methods</em>, <em>6</em>,
74-86.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(metaviz)
# Plotting a rainforest plot using the mozart data
viz_rainforest(x = mozart[, c("d", "se")],
study_labels = mozart[, "study_name"], xlab = "Cohen d")

# Visualizing a subgroup analysis of published and unpublished studies
viz_rainforest(x = mozart[, c("d", "se")], group = mozart[, "rr_lab"],
study_labels = mozart[, "study_name"], method = "REML",
summary_label = c("Summary (rr_lab = no)", "Summary (rr_lab = yes)"),
xlab = "Cohen d")

# Showing additional information in aligned tables. Log risk ratios are labeled
# in their original metric (risk ratios) on the x axis.
viz_rainforest(x = exrehab[, c("logrr", "logrr_se")],
annotate_CI = TRUE, xlab = "RR", x_trans_function = exp,
study_table = data.frame(
Name = exrehab[, "study_name"],
eventsT = paste(exrehab$ai, "/", exrehab$ai + exrehab$bi, sep = ""),
eventsC = paste(exrehab$ci, "/", exrehab$ci + exrehab$di, sep = "")),
summary_table = data.frame(
Name = "Summary",
eventsT = paste(sum(exrehab$ai), "/", sum(exrehab$ai + exrehab$bi), sep = ""),
eventsC = paste(sum(exrehab$ci), "/", sum(exrehab$ci + exrehab$di), sep = "")))
</code></pre>

<hr>
<h2 id='viz_sunset'>Sunset (power-enhanced) funnel plot</h2><span id='topic+viz_sunset'></span>

<h3>Description</h3>

<p>Creates a funnel plot with power regions and computes power-related statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>viz_sunset(
  x,
  y_axis = "se",
  true_effect = NULL,
  method = "FE",
  sig_level = 0.05,
  power_stats = TRUE,
  power_contours = "discrete",
  contours = FALSE,
  sig_contours = TRUE,
  text_size = 3,
  point_size = 2,
  xlab = "Effect",
  ylab = NULL,
  x_trans_function = NULL,
  x_breaks = NULL,
  y_breaks = NULL,
  x_limit = NULL,
  y_limit = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="viz_sunset_+3A_x">x</code></td>
<td>
<p>data.frame or matrix with the effect sizes of all studies (e.g.,
log odds ratios, or Cohen <em>d</em>) in the first column and their
respective standard errors in the second column. Alternatively, x can be the
output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package
<span class="pkg">metafor</span>; then effect sizes and standard errors are extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_y_axis">y_axis</code></td>
<td>
<p>character string indicating which y axis should be used in the funnel plot. Available options are &quot;se&quot; (default) for
standard error and &quot;precision&quot; for the reciprocal of the standard error.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_true_effect">true_effect</code></td>
<td>
<p>numeric scalar. Which true effect should be assumed for power calculations? The default is <code>NULL</code>,
for which the meta-analytic summary effect is used (computed with <code>method</code>).</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_method">method</code></td>
<td>
<p>character string indicating the method used to compute the meta-analytic summary effect. Can be any method argument from <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code>
(e.g., &quot;FE&quot; for the fixed effect model (default), or &quot;DL&quot; for the random effects model using the DerSimonian-Laird method to estimate <code class="reqn">\tau^2</code>).
If input <code>x</code> is an output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package <span class="pkg">metafor</span>, then the method is extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_sig_level">sig_level</code></td>
<td>
<p>logical scalar. For which significance level alpha should the study power be computed?</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_power_stats">power_stats</code></td>
<td>
<p>logical scalar. Should power-related statistics be computed and printed in the caption of the plot? (see details)</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_power_contours">power_contours</code></td>
<td>
<p>character string specifying how different power regions are plotted. Can be either &quot;continuous&quot;
or &quot;discrete&quot; (default).</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_contours">contours</code></td>
<td>
<p>logical scalar indicating if classic funnel plot confidence contours and the summary effect
should be displayed.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_sig_contours">sig_contours</code></td>
<td>
<p>logical scalar. Should significance contours be drawn (at the 0.05 or 0.01 level using a two-sided Wald test)?</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_text_size">text_size</code></td>
<td>
<p>numeric value. Size of text in the funnel plot. Default is 3.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_point_size">point_size</code></td>
<td>
<p>numeric value. Size of the study points in the funnel plot. Default is 2.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_xlab">xlab</code></td>
<td>
<p>character string specifying the label of the x axis.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_ylab">ylab</code></td>
<td>
<p>character string specifying the label of the y axis.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_x_trans_function">x_trans_function</code></td>
<td>
<p>function to transform the labels of the x axis. Common uses are to transform
log-odds-ratios or log-risk-ratios with <code>exp</code> to their original scale (odds ratios and risk ratios), or Fisher's z values
back to correlation coefficients using <code>tanh</code>.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_x_breaks">x_breaks</code></td>
<td>
<p>numeric vector of values for the breaks on the x-axis. When used in tandem with <code>x_trans_function</code>
the supplied values should be not yet transformed.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_y_breaks">y_breaks</code></td>
<td>
<p>numeric vector of values for the breaks on the y-axis.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_x_limit">x_limit</code></td>
<td>
<p>numeric vector of length two with user specified x axis limits.</p>
</td></tr>
<tr><td><code id="viz_sunset_+3A_y_limit">y_limit</code></td>
<td>
<p>numeric vector of length two with user specified y axis limits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The funnel plot is the most widely used diagnostic plot in meta-analysis, primarily to assess
small-study effects. The sunset (power-enhanced) funnel plot incorporates study-level power information
in the funnel display. This directly allows to examine the power studies had to detect an effect of interest
(e.g., the observed meta-analytic summary effect), whether funnel plot asymmetry is driven by underpowered but significant studies, and to visually
assess if there is an excess of low-powered significant effects in the meta-analysis
(conceptually related to the test of excess significance, Ioannidis &amp; Trikalinos, 2007).
For effect sizes assumed to be normally distributed (e.g., Cohen d, log OR),
the power corresponding to a given standard error is computed by using a two-sided Wald test and (by default) the meta-analytic
summary effect as assumed true effect. Colored regions of different power levels and a second axis with study level power are shown in the
funnel plot. In addition, power-related statistics are shown: a) The median power of all studies, b) the true effect size necessary such that
the median power of the studies would have been 33% or 66%, c) results of a test of excess significance (Ioannidis &amp; Trikalinos, 2007), and d)
the R-Index for expected replicability (Schimmack, 2016).
</p>


<h3>Value</h3>

<p>A power enhanced (&quot;sunset&quot;) funnel plot is created using ggplot2.
</p>


<h3>Author(s)</h3>

<p>Michael Kossmeier* &lt;michael.kossmeier@univie.ac.at&gt;
</p>
<p>Ulrich S. Tran* &lt;ulrich.tran@univie.ac.at&gt;
</p>
<p>Martin Voracek* &lt;martin.voracek@univie.ac.at&gt;
</p>
<p>*Department of Basic Psychological Research and Research Methods, School of Psychology, University of Vienna
</p>


<h3>References</h3>

<p>Ioannidis, J. P., &amp; Trikalinos, T. A. (2007). An exploratory test for an excess of significant
findings. <em>Clinical Trials</em>, <em>4</em>, 245-253.
</p>
<p>Schimmack, U. (2016). The replicability-index: Quantifying statistical research integrity.
Retrieved from https://replicationindex.wordpress.com/2016/01/31/a-revised-introduction-to-the-r-index/
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(metaviz)
# Create a power-enhanced ("sunset") funnel plot using confidence and significance contours
viz_sunset(x = homeopath[, c("d", "se")], contours = TRUE)
</code></pre>

<hr>
<h2 id='viz_thickforest'>Thick forest plots for meta-analyses</h2><span id='topic+viz_thickforest'></span>

<h3>Description</h3>

<p>Creates a thick forest plot, a novel variant of the forest plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>viz_thickforest(
  x,
  group = NULL,
  type = "standard",
  method = "FE",
  study_labels = NULL,
  summary_label = NULL,
  confidence_level = 0.95,
  col = "Blues",
  summary_col = col,
  tick_col = "firebrick",
  text_size = 3,
  xlab = "Effect",
  x_limit = NULL,
  x_trans_function = NULL,
  x_breaks = NULL,
  annotate_CI = FALSE,
  study_table = NULL,
  summary_table = NULL,
  table_headers = NULL,
  table_layout = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="viz_thickforest_+3A_x">x</code></td>
<td>
<p>data.frame or matrix with the effect sizes of all studies (e.g.,
correlations, log odds ratios, or Cohen <em>d</em>) in the first column and their
respective standard errors in the second column. Alternatively, x can be the
output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package
<span class="pkg">metafor</span>; then effect sizes and standard errors are extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_group">group</code></td>
<td>
<p>factor indicating the subgroup of each study to plot a subgroup forest plot. Has to be in the same order than <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_type">type</code></td>
<td>
<p>character string indicating the type of forest plot to be plotted. Can be &quot;standard&quot; (default), &quot;study_only&quot;,
&quot;summary_only&quot;, &quot;cumulative&quot;, or &quot;sensitivity&quot;. See 'Details'.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_method">method</code></td>
<td>
<p>character string indicating which method should be used to compute the study weights and summary effect(s).
Can be any method argument from <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code>
(e.g., &quot;FE&quot; for the fixed effect model, or &quot;DL&quot; for the random effects model using the
DerSimonian-Laird method to estimate <code class="reqn">\tau^2</code>).
If input <code>x</code> is an output object of function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> from package <span class="pkg">metafor</span>, then the method is extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_study_labels">study_labels</code></td>
<td>
<p>a character vector with names/identifiers to annotate each study in the forest plot.
Has to be in the same order than <code>x</code>. Ignored if <code>study_table</code> and/or <code>summary_table</code> is supplied.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_summary_label">summary_label</code></td>
<td>
<p>a character string specifying the name to annotate the summary effect. If a subgroup
analysis is plotted, <code>summary_label</code> should be a character vector with a name for each
subgroup summary effect, arranged in the order of the levels of <code>group</code>. Ignored if <code>study_table</code> and/or
<code>summary_table</code> is supplied.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_confidence_level">confidence_level</code></td>
<td>
<p>numeric value. The confidence level for the plotted confidence bars.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_col">col</code></td>
<td>
<p>character string specifying the color used for the study-level error bars. Can be a vector of length <code>nrow(x)</code>
with colors for each study-level result individually.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_summary_col">summary_col</code></td>
<td>
<p>character string specifying the main color for plotting the summary effect(s). Can be a vector
with colors for each subgroup summary effect individually.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_tick_col">tick_col</code></td>
<td>
<p>character string specifying the color used for the ticks indicating the point estimates.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_text_size">text_size</code></td>
<td>
<p>numeric value. Size of text in the forest plot. Default is 3.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_xlab">xlab</code></td>
<td>
<p>character string specifying the label of the x axis. By default also used for the header of the aligned table if <code>annotate_CI</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_x_limit">x_limit</code></td>
<td>
<p>numeric vector of length 2 with the limits (minimum, maximum) of the x axis.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_x_trans_function">x_trans_function</code></td>
<td>
<p>function to transform the labels of the x axis. Common uses are to transform
log-odds-ratios or log-risk-ratios with <code>exp</code> to their original scale (odds ratios and risk ratios), or Fisher's z values
back to correlation coefficients using <code>tanh</code>.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_x_breaks">x_breaks</code></td>
<td>
<p>numeric vector of values for the breaks on the x-axis. When used in tandem with <code>x_trans_function</code>
the supplied values should be not yet transformed.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_annotate_ci">annotate_CI</code></td>
<td>
<p>logical scalar. Should the effect size and confidence interval values be shown as text in an aligned table on the right-hand side of the forest plot?</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_study_table">study_table</code></td>
<td>
<p>a data.frame with additional study-level variables which should be shown in an aligned table.
Has to be in the same order than <code>x</code>.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_summary_table">summary_table</code></td>
<td>
<p>a data.frame with additional summary-level information shown in an aligned table.
If <code>group</code> is supplied, <code>summary_table</code> must have a row for each subgroup
summary effect, arranged in the order of the levels of <code>group</code>.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_table_headers">table_headers</code></td>
<td>
<p>character vector. Headers for each column of aligned tables via <code>study_table</code>, <code>summary_table</code>, or <code>annotate_CI</code>.</p>
</td></tr>
<tr><td><code id="viz_thickforest_+3A_table_layout">table_layout</code></td>
<td>
<p>numeric layout matrix passed to <code>layout_matrx</code> of <code><a href="gridExtra.html#topic+arrangeGrob">arrangeGrob</a></code>. Can be used to overwrite the default spacing
of the forest plot and aligned tables via <code>study_table</code>, <code>summary_table</code>, and <code>annotate_CI</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The thick forest plot was proposed by Schild and Voracek (2015) as a variant and
enhancement of classic forest plots. Thick forest plots use rectangular error bars
instead of traditional lines to display confidence intervals (width of the error bar), as well as the relative
meta-analytic weight (height of the error bar) of each study. In addition, study and summary level
point estimates are depicted clearly by a specific symbol.
</p>
<p>Thick forest plots have the following advantages, as compared to classic forest plots:
</p>

<ol>
<li><p> Using the height of bars proportional to the (relative) meta-analytic weight
causes small studies (with wide confidence intervals and less weight in the meta-analysis) to
be visually less dominant.
</p>
</li>
<li><p> In classic forest plots, it is often hard to depict the magnitude of
point estimates to a reasonable degree of accuracy, especially for studies
with large meta-analytic weights and correspondingly large plotting symbols
(commonly squares). Specific symbols within the thick forest plot improve the
visualization of study point estimates.</p>
</li></ol>

<p>Note that for subgroup analysis the height of each error bar is scaled by the weight of each study within the subgroup divided by
the sum of the weights of all studies irrespective of subgroup. Therefore, with subgroups present, the overall impression of error
bar heights within a given subgroup compared to other subgroups conveys information about the relative precision of the meta-analytic
estimate within the subgroup.
</p>


<h3>Value</h3>

<p>A thick forest plot is created using ggplot2.
</p>


<h3>Author(s)</h3>

<p>Michael Kossmeier* &lt;michael.kossmeier@univie.ac.at&gt;
</p>
<p>Ulrich S. Tran* &lt;ulrich.tran@univie.ac.at&gt;
</p>
<p>Martin Voracek* &lt;martin.voracek@univie.ac.at&gt;
</p>
<p>*Department of Basic Psychological Research and Research Methods, School of Psychology, University of Vienna
</p>


<h3>References</h3>

<p>Schild, A. H., &amp; Voracek, M. (2015). Finding your way out of the
forest without a trail of bread crumbs: Development and evaluation of two
novel displays of forest plots. <em>Research Synthesis Methods</em>, <em>6</em>,
74-86.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(metaviz)
# Plotting a thick forest plot using the mozart data
viz_thickforest(x = mozart[, c("d", "se")],
study_labels = mozart[, "study_name"], xlab = "Cohen d")

# Visualizing a subgroup analysis of published and unpublished studies
viz_thickforest(x = mozart[, c("d", "se")], group = mozart[, "rr_lab"],
study_labels = mozart[, "study_name"], method = "REML",
summary_label = c("Summary (rr_lab = no)", "Summary (rr_lab = yes)"),
xlab = "Cohen d")

# Showing additional information in aligned tables. Log risk ratios are labeled
# in their original metric (risk ratios) on the x axis.
viz_thickforest(x = exrehab[, c("logrr", "logrr_se")],
annotate_CI = TRUE, xlab = "RR", x_trans_function = exp,
study_table = data.frame(
Name = exrehab[, "study_name"],
eventsT = paste(exrehab$ai, "/", exrehab$ai + exrehab$bi, sep = ""),
eventsC = paste(exrehab$ci, "/", exrehab$ci + exrehab$di, sep = "")),
summary_table = data.frame(
Name = "Summary",
eventsT = paste(sum(exrehab$ai), "/", sum(exrehab$ai + exrehab$bi), sep = ""),
eventsC = paste(sum(exrehab$ci), "/", sum(exrehab$ci + exrehab$di), sep = "")),
table_layout = matrix(c(1, 1, 2, 2, 3), nrow = 1))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
