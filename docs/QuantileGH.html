<!DOCTYPE html><html lang="en-US"><head><title>Help for package QuantileGH</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {QuantileGH}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#QuantileGH-package'><p>Quantile Least Mahalanobis Distance Estimator for Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> Mixture</p></a></li>
<li><a href='#allequal'><p>Determine Nearly-Equal Elements</p></a></li>
<li><a href='#allequal_o_'><p>Test if Two double Vectors are Element-Wise (Nearly) Equal</p></a></li>
<li><a href='#drop1_fmx'><p>Drop or Add One Parameter from fmx Object</p></a></li>
<li><a href='#fmx_cluster'><p>Naive Estimates of Finite Mixture Distribution via Clustering</p></a></li>
<li><a href='#fmx_hybrid'><p>Best Naive Estimates for Finite Mixture Distribution</p></a></li>
<li><a href='#fmx_normix'><p>Naive Parameter Estimates using Mixture of Normal</p></a></li>
<li><a href='#klist'><p>Data Clusters by (modified) <code class="reqn">k</code>-Means</p></a></li>
<li><a href='#mahalanobis_int'><p>Simpler and Faster Mahalanobis Distance</p></a></li>
<li><a href='#QLMDe'><p>Quantile Least Mahalanobis Distance estimates</p></a></li>
<li><a href='#QLMDe_stepK'><p>Forward Selection of the Number of Components <code class="reqn">K</code></p></a></li>
<li><a href='#QLMDp'><p>Percentages for Quantile Least Mahalanobis Distance estimation</p></a></li>
<li><a href='#quantile_vcov'><p>Variance-Covariance of Quantiles</p></a></li>
<li><a href='#reAssign'><p>Re-Assign Observations Trimmed Prior to Trimmed <code class="reqn">k</code>-Means Clustering</p></a></li>
<li><a href='#step_fmx'><p>Forward Selection of <code class="reqn">gh</code>-parsimonious Model with Fixed Number of Components <code class="reqn">K</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Quantile Least Mahalanobis Distance Estimator for Tukey g-&amp;-h
Mixture</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-03-15</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for simulation, estimation, and model selection of
        finite mixtures of Tukey g-and-h distributions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, mixtools, tclust, fmx, TukeyGH77</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.4.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, mixsmsn</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-15 18:33:14 UTC; tingtingzhan</td>
</tr>
<tr>
<td>Author:</td>
<td>Tingting Zhan <a href="https://orcid.org/0000-0001-9971-4844"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Inna Chervoneva <a href="https://orcid.org/0000-0002-9104-4505"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tingting Zhan &lt;Tingting.Zhan@jefferson.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-15 18:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='QuantileGH-package'>Quantile Least Mahalanobis Distance Estimator for Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> Mixture</h2><span id='topic+QuantileGH'></span><span id='topic+QuantileGH-package'></span>

<h3>Description</h3>

<p>Tools for simulating and fitting finite mixtures of the 4-parameter Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> distributions.
Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> mixture is highly flexible to model multimodal distributions with variable degree of skewness and kurtosis in the components.
The Quantile Least Mahalanobis Distance estimator <a href="#topic+QLMDe">QLMDe</a> is used for estimating parameters of the finite Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> mixtures.
<a href="#topic+QLMDe">QLMDe</a> is an indirect estimator that minimizes the Mahalanobis distance between the sample and model-based quantiles.
A backward-forward stepwise model selection algorithm is provided to find
</p>

<ul>
<li> <p>a parsimonious Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> mixture model, conditional on a given number-of-components; and
</p>
</li>
<li> <p>the optimal number of components within the user-specified range.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Tingting Zhan <a href="mailto:Tingting.Zhan@jefferson.edu">Tingting.Zhan@jefferson.edu</a> (<a href="https://orcid.org/0000-0001-9971-4844">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Inna Chervoneva <a href="mailto:Inna.Chervoneva@jefferson.edu">Inna.Chervoneva@jefferson.edu</a> (<a href="https://orcid.org/0000-0002-9104-4505">ORCID</a>)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># see ?QLMDe

</code></pre>

<hr>
<h2 id='allequal'>Determine Nearly-Equal Elements</h2><span id='topic+allequal'></span><span id='topic+unique_allequal'></span><span id='topic+duplicated_allequal'></span>

<h3>Description</h3>

<p>Determine nearly-equal elements and extract non-nearly-equal elements in a <a href="base.html#topic+double">double</a> <a href="base.html#topic+vector">vector</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unique_allequal(x, ...)

duplicated_allequal(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="allequal_+3A_x">x</code></td>
<td>
<p><a href="base.html#topic+double">double</a> <a href="base.html#topic+vector">vector</a></p>
</td></tr>
<tr><td><code id="allequal_+3A_...">...</code></td>
<td>
<p>additional parameters of function <code><a href="#topic+allequal_o_">allequal_o_()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code><a href="#topic+duplicated_allequal">duplicated_allequal()</a></code> returns a <a href="base.html#topic+logical">logical</a> <a href="base.html#topic+vector">vector</a> of the same length as the input vector,
indicating whether each element is nearly-equal to any of the previous elements.
</p>
<p>Function <code><a href="#topic+unique_allequal">unique_allequal()</a></code> returns the non-nearly-equal elements in the input vector.
</p>


<h3>See Also</h3>

<p><a href="base.html#topic+duplicated.default">duplicated.default</a> <a href="base.html#topic+unique.default">unique.default</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(x = c(.3, 1-.7, 0, .Machine$double.eps))
duplicated.default(x) # not desired
unique.default(x) # not desired
duplicated_allequal(x)
unique_allequal(x)
unique_allequal(x, tol = .Machine$double.eps/2)
</code></pre>

<hr>
<h2 id='allequal_o_'>Test if Two <a href="base.html#topic+double">double</a> Vectors are Element-Wise (Nearly) Equal</h2><span id='topic+allequal_o_'></span>

<h3>Description</h3>

<p>Test if two <a href="base.html#topic+double">double</a> <a href="base.html#topic+vector">vector</a>s are element-wise (nearly) equal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allequal_o_(target, current, tolerance = sqrt(.Machine$double.eps), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="allequal_o__+3A_target">target</code></td>
<td>
<p>length-<code class="reqn">n_t</code> <a href="base.html#topic+double">double</a> <a href="base.html#topic+vector">vector</a>,
the target value(s), missing value not allowed</p>
</td></tr>
<tr><td><code id="allequal_o__+3A_current">current</code></td>
<td>
<p>length-<code class="reqn">n_c</code> <a href="base.html#topic+double">double</a> <a href="base.html#topic+vector">vector</a>,
the value(s) to be compared with <code>target</code>, missing value not allowed</p>
</td></tr>
<tr><td><code id="allequal_o__+3A_tolerance">tolerance</code></td>
<td>
<p>positive <a href="base.html#topic+double">double</a> scalar, default <code>sqrt(.Machine$double.eps)</code></p>
</td></tr>
<tr><td><code id="allequal_o__+3A_...">...</code></td>
<td>
<p>potential parameters, currently not in use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code><a href="#topic+allequal_o_">allequal_o_()</a></code> is different from <a href="base.html#topic+all.equal.numeric">all.equal.numeric</a>, such that
</p>

<ul>
<li><p>only compares between <a href="base.html#topic+double">double</a>, not <a href="base.html#topic+complex">complex</a>, values
</p>
</li>
<li><p>element-wise comparison is performed, in a fashion similar to function <a href="base.html#topic+outer">outer</a>
</p>
</li>
<li><p>a <a href="base.html#topic+logical">logical</a> scalar is always returned for each element-wise comparison.
</p>
</li></ul>



<h3>Value</h3>

<p>Function <code><a href="#topic+allequal_o_">allequal_o_()</a></code> returns an <code class="reqn">n_t\times n_c</code> <a href="base.html#topic+logical">logical</a> <a href="base.html#topic+matrix">matrix</a>
indicating whether the length-<code class="reqn">n_c</code> <a href="base.html#topic+vector">vector</a> <code>current</code>
is element-wise near-equal to
the length-<code class="reqn">n_t</code> <a href="base.html#topic+vector">vector</a> <code>target</code>
within the pre-specified <code>tolerance</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>allequal_o_(target = c(.3, 0), current = c(.3, 1-.7, 0, .Machine$double.eps))
</code></pre>

<hr>
<h2 id='drop1_fmx'>Drop or Add One Parameter from <a href="fmx.html#topic+fmx-class">fmx</a> Object</h2><span id='topic+drop1_fmx'></span><span id='topic+drop1.fmx'></span><span id='topic+add1.fmx'></span>

<h3>Description</h3>

<p>Fit <a href="fmx.html#topic+fmx-class">fmx</a> models with a single parameters being added or dropped.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fmx'
drop1(object, ...)

## S3 method for class 'fmx'
add1(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="drop1_fmx_+3A_object">object</code></td>
<td>
<p><a href="fmx.html#topic+fmx-class">fmx</a> object</p>
</td></tr>
<tr><td><code id="drop1_fmx_+3A_...">...</code></td>
<td>
<p>additional parameters, currently not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>..
</p>


<h3>Value</h3>

<p>Functions <code><a href="#topic+drop1.fmx">drop1.fmx()</a></code> and <code><a href="#topic+add1.fmx">add1.fmx()</a></code> return a <a href="base.html#topic+list">list</a> of <a href="fmx.html#topic+fmx-class">fmx</a> objects,
in the reverse order of model selection.
</p>


<h3>Note</h3>

<p>Functions <code><a href="#topic+drop1.fmx">drop1.fmx()</a></code> and <code><a href="#topic+add1.fmx">add1.fmx()</a></code> do <em>not</em>
return an <a href="stats.html#topic+anova">anova</a> table, like other
<code style="white-space: pre;">&#8288;stats:::drop.*&#8288;</code> or <code style="white-space: pre;">&#8288;stats:::add1.*&#8288;</code> functions do.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+step">step</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 
# donttest to save time
library(fmx)
(d2 = fmx('GH', A = c(1,6), B = 1.2, g = c(0,.3), h = c(.2,0), w = c(1,2)))
set.seed(312); hist(x2 &lt;- rfmx(n = 1e3L, dist = d2))
system.time(m0 &lt;- QLMDe(x2, distname = 'GH', K = 2L, constraint = c('g1', 'g2', 'h1', 'h2')))
system.time(m1 &lt;- QLMDe(x2, distname = 'GH', K = 2L, constraint = c('g1', 'h2')))
system.time(m2 &lt;- QLMDe(x2, distname = 'GH', K = 2L)) # ~2 secs

d1 = drop1(m1)
d1 # NULL
d2 = drop1(m2)
vapply(d2, FUN = getTeX, FUN.VALUE = '')

a0 = add1(m0)
vapply(a0, FUN = getTeX, FUN.VALUE = '')
a1 = add1(m1)
vapply(a1, FUN = getTeX, FUN.VALUE = '')



</code></pre>

<hr>
<h2 id='fmx_cluster'>Naive Estimates of Finite Mixture Distribution via Clustering</h2><span id='topic+fmx_cluster'></span>

<h3>Description</h3>

<p>Naive estimates for finite mixture distribution <a href="fmx.html#topic+fmx-class">fmx</a> via clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmx_cluster(
  x,
  K,
  distname = c("GH", "norm", "sn"),
  constraint = character(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fmx_cluster_+3A_x">x</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>, observations</p>
</td></tr>
<tr><td><code id="fmx_cluster_+3A_k">K</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> scalar, number of mixture components</p>
</td></tr>
<tr><td><code id="fmx_cluster_+3A_distname">distname</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar, name of parametric distribution of the mixture components</p>
</td></tr>
<tr><td><code id="fmx_cluster_+3A_constraint">constraint</code></td>
<td>
<p><a href="base.html#topic+character">character</a> <a href="base.html#topic+vector">vector</a>,
parameters (<code class="reqn">g</code> and/or <code class="reqn">h</code> for Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> mixture) to be set at 0.
See function <a href="fmx.html#topic+fmx_constraint">fmx_constraint</a> for details.</p>
</td></tr>
<tr><td><code id="fmx_cluster_+3A_...">...</code></td>
<td>
<p>additional parameters, currently not in use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First of all, if the specified number of components <code class="reqn">K\geq 2</code>,
trimmed <code class="reqn">k</code>-means clustering with re-assignment will be performed;
otherwise, all observations will be considered as one single cluster.
The standard <code class="reqn">k</code>-means clustering is not used since the heavy tails of
Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> distribution could be mistakenly classified as individual cluster(s).
</p>
<p>In each of the one or more clusters,
</p>

<ul>
<li><p><a href="TukeyGH77.html#topic+letterValue">letterValue</a>-based estimates of Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> distribution (Hoaglin, 2006)
are calculated, for any <code class="reqn">K\geq 1</code>, serving as the starting values for
QLMD algorithm.
These estimates are provided by function <code><a href="#topic+fmx_cluster">fmx_cluster()</a></code>.
</p>
</li>
<li><p>the <a href="stats.html#topic+median">median</a> and <a href="stats.html#topic+mad">mad</a> will serve as
the starting values for <code class="reqn">\mu</code> and <code class="reqn">\sigma</code>
(or <code class="reqn">A</code> and <code class="reqn">B</code> for Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> distribution, with <code class="reqn">g = h = 0</code>),
for QLMD algorithm
when <code class="reqn">K = 1</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>Function <code><a href="#topic+fmx_cluster">fmx_cluster()</a></code> returns an <a href="fmx.html#topic+fmx-class">fmx</a> object.
</p>

<hr>
<h2 id='fmx_hybrid'>Best Naive Estimates for Finite Mixture Distribution</h2><span id='topic+fmx_hybrid'></span>

<h3>Description</h3>

<p>Best estimates for finite mixture distribution <a href="fmx.html#topic+fmx-class">fmx</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmx_hybrid(x, test = c("logLik", "CvM", "KS"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fmx_hybrid_+3A_x">x</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>, observations</p>
</td></tr>
<tr><td><code id="fmx_hybrid_+3A_test">test</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar, criteria for selecting the optimal estimates.
See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="fmx_hybrid_+3A_...">...</code></td>
<td>
<p>additional parameters of functions <code><a href="#topic+fmx_normix">fmx_normix()</a></code> and <code><a href="#topic+fmx_cluster">fmx_cluster()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code><a href="#topic+fmx_hybrid">fmx_hybrid()</a></code> compares
Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> mixture estimate provided by function <code><a href="#topic+fmx_cluster">fmx_cluster()</a></code>
and the normal mixture estimate by function <code><a href="#topic+fmx_normix">fmx_normix()</a></code>,
and select the one either with maximum likelihood (<code>test = 'logLik'</code>, default),
with minimum Cramer-von Mises distance (<code>test = 'CvM'</code>) or
with minimum Kolmogorov distance (<a href="fmx.html#topic+Kolmogorov_fmx">Kolmogorov_fmx</a>).
</p>


<h3>Value</h3>

<p>Function <code><a href="#topic+fmx_hybrid">fmx_hybrid()</a></code> returns an <a href="fmx.html#topic+fmx-class">fmx</a> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(fmx)
d1 = fmx('norm', mean = c(1, 2), sd = .5, w = c(.4, .6))
set.seed(100); hist(x1 &lt;- rfmx(n = 1e3L, dist = d1))
fmx_normix(x1, distname = 'norm', K = 2L)
fmx_normix(x1, distname = 'GH', K = 2L)

(d2 = fmx('GH', A = c(1,6), B = 2, g = c(0,.3), h = c(.2,0), w = c(1,2)))
set.seed(100); hist(x2 &lt;- rfmx(n = 1e3L, dist = d2))
fmx_cluster(x2, K = 2L)
fmx_cluster(x2, K = 2L, constraint = c('g1', 'h2'))
fmx_normix(x2, K = 2L, distname = 'GH')
fmx_hybrid(x2, distname = 'GH', K = 2L)

</code></pre>

<hr>
<h2 id='fmx_normix'>Naive Parameter Estimates using Mixture of Normal</h2><span id='topic+fmx_normix'></span>

<h3>Description</h3>

<p>Naive parameter estimates for finite mixture distribution <a href="fmx.html#topic+fmx-class">fmx</a> using mixture of normal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmx_normix(x, K, distname = c("norm", "GH", "sn"), alpha = 0.05, R = 10L, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fmx_normix_+3A_x">x</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>, observations</p>
</td></tr>
<tr><td><code id="fmx_normix_+3A_k">K</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> scalar, number of mixture components</p>
</td></tr>
<tr><td><code id="fmx_normix_+3A_distname">distname</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar,
name of parametric distribution of the mixture components</p>
</td></tr>
<tr><td><code id="fmx_normix_+3A_alpha">alpha</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> scalar, proportion of observations to be trimmed in
trimmed <code class="reqn">k</code>-means algorithm <a href="tclust.html#topic+tkmeans">tkmeans</a></p>
</td></tr>
<tr><td><code id="fmx_normix_+3A_r">R</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> scalar, number of <a href="mixtools.html#topic+normalmixEM">normalmixEM</a> replicates</p>
</td></tr>
<tr><td><code id="fmx_normix_+3A_...">...</code></td>
<td>
<p>additional parameters, currently not in use</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="#topic+fmx_normix">fmx_normix</a> ... the cluster centers are provided as the starting values of <code class="reqn">\mu</code>'s for
the univariate normal mixture by EM <a href="mixtools.html#topic+normalmixEM">algorithm</a>.
<code>R</code> replicates of normal mixture estimates are obtained, and
the one with maximum likelihood will be selected
</p>


<h3>Value</h3>

<p>Function <code><a href="#topic+fmx_normix">fmx_normix()</a></code> returns an <a href="fmx.html#topic+fmx-class">fmx</a> object.
</p>

<hr>
<h2 id='klist'>Data Clusters by (modified) <code class="reqn">k</code>-Means</h2><span id='topic+klist'></span>

<h3>Description</h3>

<p>To create a <a href="base.html#topic+list">list</a> of observations based on (modified) <code class="reqn">k</code>-means algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>klist(x, K, method = c("reassign_tkmeans"), alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="klist_+3A_x">x</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>, one-dimensional observations</p>
</td></tr>
<tr><td><code id="klist_+3A_k">K</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> scalar, number of clusters</p>
</td></tr>
<tr><td><code id="klist_+3A_method">method</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar,
only <code>'reassign_tkmeans'</code> (default) supported yet</p>
</td></tr>
<tr><td><code id="klist_+3A_alpha">alpha</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> scalar, proportion of observations to be trimmed in
trimmed <code class="reqn">k</code>-means algorithm <a href="tclust.html#topic+tkmeans">tkmeans</a></p>
</td></tr>
<tr><td><code id="klist_+3A_...">...</code></td>
<td>
<p>additional parameters, currently not in use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code><a href="#topic+klist">klist()</a></code> returns a <a href="base.html#topic+list">list</a> of <a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>s.
</p>


<h3>See Also</h3>

<p><a href="#topic+reAssign.tkmeans">reAssign.tkmeans</a>
<a href="stats.html#topic+kmeans">kmeans</a>
</p>

<hr>
<h2 id='mahalanobis_int'>Simpler and Faster Mahalanobis Distance</h2><span id='topic+mahalanobis_int'></span>

<h3>Description</h3>

<p>Simpler and faster <a href="stats.html#topic+mahalanobis">mahalanobis</a> distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mahalanobis_int(x, center, invcov)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mahalanobis_int_+3A_x">x</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a></p>
</td></tr>
<tr><td><code id="mahalanobis_int_+3A_center">center</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>, mean <code class="reqn">\mathbf{\mu}</code></p>
</td></tr>
<tr><td><code id="mahalanobis_int_+3A_invcov">invcov</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+matrix">matrix</a>, <em>inverted</em> variance-covariance <code class="reqn">\mathbf{\Sigma}</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code><a href="#topic+mahalanobis_int">mahalanobis_int()</a></code> returns a <a href="base.html#topic+numeric">numeric</a> scalar.
</p>

<hr>
<h2 id='QLMDe'>Quantile Least Mahalanobis Distance estimates</h2><span id='topic+QLMDe'></span>

<h3>Description</h3>

<p>The quantile least Mahalanobis distance algorithm estimates the parameters of
single-component or finite mixture distributions
by minimizing the Mahalanobis distance between the vectors of sample and theoretical quantiles.
See <a href="#topic+QLMDp">QLMDp</a> for the default selection of probabilities at which the sample and theoretical quantiles are compared.
</p>
<p>The default initial values are estimated based on trimmed <code class="reqn">k</code>-means
clustering with re-assignment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QLMDe(
  x,
  distname = c("GH", "norm", "sn"),
  K,
  data.name = deparse1(substitute(x)),
  constraint = character(),
  probs = QLMDp(x = x),
  init = c("logLik", "letterValue", "normix"),
  tol = .Machine$double.eps^0.25,
  maxiter = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QLMDe_+3A_x">x</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>, the one-dimensional observations.</p>
</td></tr>
<tr><td><code id="QLMDe_+3A_distname">distname</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar, name of mixture distribution to be fitted.  Currently supports <code>'norm'</code> and <code>'GH'</code>.</p>
</td></tr>
<tr><td><code id="QLMDe_+3A_k">K</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> scalar, number of components (e.g., must use <code>2L</code> instead of <code>2</code>).</p>
</td></tr>
<tr><td><code id="QLMDe_+3A_data.name">data.name</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar, name for the observations for user-friendly print out.</p>
</td></tr>
<tr><td><code id="QLMDe_+3A_constraint">constraint</code></td>
<td>
<p><a href="base.html#topic+character">character</a> <a href="base.html#topic+vector">vector</a>, parameters (<code class="reqn">g</code> and/or <code class="reqn">h</code> for Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> mixture) to be set at 0.
See function <a href="fmx.html#topic+fmx_constraint">fmx_constraint</a> for details.</p>
</td></tr>
<tr><td><code id="QLMDe_+3A_probs">probs</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>, percentiles at where the sample and theoretical quantiles are to be matched.
See function <code><a href="#topic+QLMDp">QLMDp()</a></code> for details.</p>
</td></tr>
<tr><td><code id="QLMDe_+3A_init">init</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar for the method of initial values selection,
or an <a href="fmx.html#topic+fmx-class">fmx</a> object of the initial values.
See function <code><a href="#topic+fmx_hybrid">fmx_hybrid()</a></code> for more details.</p>
</td></tr>
<tr><td><code id="QLMDe_+3A_tol">tol</code>, <code id="QLMDe_+3A_maxiter">maxiter</code></td>
<td>
<p>see function <a href="TukeyGH77.html#topic+vuniroot2">vuniroot2</a></p>
</td></tr>
<tr><td><code id="QLMDe_+3A_...">...</code></td>
<td>
<p>additional parameters of <a href="stats.html#topic+optim">optim</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Quantile Least Mahalanobis Distance estimator fits a single-component or finite mixture distribution
by minimizing the Mahalanobis distance between
the theoretical and observed quantiles,
using the empirical quantile variance-covariance matrix <a href="#topic+quantile_vcov">quantile_vcov</a>.
</p>


<h3>Value</h3>

<p>Function <code><a href="#topic+QLMDe">QLMDe()</a></code> returns an <a href="fmx.html#topic+fmx-class">fmx</a> object.
</p>


<h3>See Also</h3>

<p><a href="#topic+fmx_hybrid">fmx_hybrid</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bmi, package = 'mixsmsn')
hist(x &lt;- bmi[[1L]])
QLMDe(x, distname = 'GH', K = 2L)

</code></pre>

<hr>
<h2 id='QLMDe_stepK'>Forward Selection of the Number of Components <code class="reqn">K</code></h2><span id='topic+QLMDe_stepK'></span>

<h3>Description</h3>

<p>To compare <code class="reqn">gh</code>-parsimonious models of Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> mixtures with different number of components <code class="reqn">K</code>
(up to a user-specified <code class="reqn">K_\text{max}</code>)
and select the optimal number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QLMDe_stepK(
  x,
  distname = c("GH", "norm"),
  data.name = deparse1(substitute(x)),
  Kmax = 3L,
  test = c("BIC", "AIC"),
  direction = c("forward", "backward"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QLMDe_stepK_+3A_x">x</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>, observations</p>
</td></tr>
<tr><td><code id="QLMDe_stepK_+3A_distname">distname</code>, <code id="QLMDe_stepK_+3A_data.name">data.name</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalars,
see parameters of the same names in function <code><a href="#topic+QLMDe">QLMDe()</a></code></p>
</td></tr>
<tr><td><code id="QLMDe_stepK_+3A_kmax">Kmax</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> scalar <code class="reqn">K_\text{max}</code>,
maximum number of components to be considered. Default <code>3L</code></p>
</td></tr>
<tr><td><code id="QLMDe_stepK_+3A_test">test</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar, criterion to be used, either
Akaike's information criterion <a href="stats.html#topic+AIC">AIC</a>, or
Bayesian information criterion <a href="stats.html#topic+BIC">BIC</a> (default).</p>
</td></tr>
<tr><td><code id="QLMDe_stepK_+3A_direction">direction</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar, direct of selection in function <code><a href="#topic+step_fmx">step_fmx()</a></code>,
either <code>'forward'</code> (default) or <code>'backward'</code></p>
</td></tr>
<tr><td><code id="QLMDe_stepK_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code><a href="#topic+QLMDe_stepK">QLMDe_stepK()</a></code> compares the <code class="reqn">gh</code>-parsimonious models with different number of components <code class="reqn">K</code>,
and selects the optimal number of components using BIC (default) or AIC.
</p>
<p>The forward selection starts with finding the <code class="reqn">gh</code>-parsimonious model (via function <code><a href="#topic+step_fmx">step_fmx()</a></code>)
at <code class="reqn">K = 1</code>.
Let the current number of component be <code class="reqn">K^c</code>.
We compare the <code class="reqn">gh</code>-parsimonious models of <code class="reqn">K^c+1</code> and <code class="reqn">K^c</code> component, respectively,
using BIC or AIC.
If <code class="reqn">K^c</code> is preferred, then the forward selection is stopped, and <code class="reqn">K^c</code> is considered the
optimal number of components.
If <code class="reqn">K^c+1</code> is preferred, then
the forward selection is stopped if <code class="reqn">K^c+1=K_{max}</code>,
otherwise update <code class="reqn">K^c</code> with <code class="reqn">K_c+1</code> and repeat the previous steps.
</p>


<h3>Value</h3>

<p>Function <code><a href="#topic+QLMDe_stepK">QLMDe_stepK()</a></code> returns an object of S3 class <code>'stepK'</code>,
which is a <a href="base.html#topic+list">list</a> of selected models (in reversed order) with attribute(s)
<code>'direction'</code> and
<code>'test'</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bmi, package = 'mixsmsn')
hist(x &lt;- bmi[[1L]])
QLMDe_stepK(x, distname = 'GH', Kmax = 2L)

</code></pre>

<hr>
<h2 id='QLMDp'>Percentages for Quantile Least Mahalanobis Distance estimation</h2><span id='topic+QLMDp'></span>

<h3>Description</h3>

<p>A vector of probabilities to be used in Quantile Least Mahalanobis Distance estimation (<a href="#topic+QLMDe">QLMDe</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QLMDp(
  from = 0.05,
  to = 0.95,
  length.out = 15L,
  equidistant = c("prob", "quantile"),
  extra = c(0.005, 0.01, 0.02, 0.03, 0.97, 0.98, 0.99, 0.995),
  x
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QLMDp_+3A_from">from</code>, <code id="QLMDp_+3A_to">to</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> scalar,
minimum and maximum of the equidistant (in probability or quantile) probabilities.
Default <code>.05</code> and <code>.95</code>, respectively</p>
</td></tr>
<tr><td><code id="QLMDp_+3A_length.out">length.out</code></td>
<td>
<p>non-negative <a href="base.html#topic+integer">integer</a> scalar,
the number of the equidistant (in probability or quantile) probabilities.</p>
</td></tr>
<tr><td><code id="QLMDp_+3A_equidistant">equidistant</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar.
If <code>'prob'</code> (default), then the probabilities are equidistant.
If <code>'quantile'</code>, then the quantiles (of the observations <code>x</code>) corresponding to the probabilities are equidistant.</p>
</td></tr>
<tr><td><code id="QLMDp_+3A_extra">extra</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a> of <em>additional</em> probabilities,
default <code>c(.005, .01, .02, .03, .97, .98, .99, .995)</code>.</p>
</td></tr>
<tr><td><code id="QLMDp_+3A_x">x</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a> of observations, only used when <code>equidistant = 'quantile'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default arguments of function <code><a href="#topic+QLMDp">QLMDp()</a></code> returns the probabilities of
<code>c(.005, .01, .02, .03, seq.int(.05, .95, length.out = 15L), .97, .98, .99, .995)</code>.
</p>


<h3>Value</h3>

<p>A <a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a> of probabilities to be supplied to parameter <code>p</code> of
Quantile Least Mahalanobis Distance <a href="#topic+QLMDe">QLMDe</a> estimation).
In practice, the length of this probability <a href="base.html#topic+vector">vector</a> <code>p</code>
must be equal or larger than the number of parameters in the distribution model to be estimated.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(fmx)
(d2 = fmx('GH', A = c(1,6), B = 2, g = c(0,.3), h = c(.2,0), w = c(1,2)))
set.seed(100); hist(x2 &lt;- rfmx(n = 1e3L, dist = d2))

# equidistant in probabilities
(p1 = QLMDp()) 

# equidistant in quantiles
(p2 = QLMDp(equidistant = 'quantile', x = x2)) 
</code></pre>

<hr>
<h2 id='quantile_vcov'>Variance-Covariance of Quantiles</h2><span id='topic+quantile_vcov'></span>

<h3>Description</h3>

<p>To compute the variance-covariance matrix of quantiles
based on Theorem 1 and 2 of Mosteller (1946).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantile_vcov(p, d)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantile_vcov_+3A_p">p</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>,
cumulative probabilities at the given quantiles</p>
</td></tr>
<tr><td><code id="quantile_vcov_+3A_d">d</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+vector">vector</a>,
probability densities at the given quantiles</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The end user should make sure no density too close to 0 is included in argument <code>d</code>.
</p>
<p>Function <code><a href="#topic+quantile_vcov">quantile_vcov()</a></code> must not be used in a compute-intensive way.
</p>


<h3>Value</h3>

<p>Function <code><a href="#topic+quantile_vcov">quantile_vcov()</a></code> returns the variance-covariance <a href="base.html#topic+matrix">matrix</a> of quantiles.
</p>


<h3>References</h3>

<p>Frederick Mosteller. On Some Useful &quot;Inefficient&quot; Statistics (1946).
<a href="https://doi.org/10.1214/aoms/1177730881">doi:10.1214/aoms/1177730881</a>
</p>

<hr>
<h2 id='reAssign'>Re-Assign Observations Trimmed Prior to Trimmed <code class="reqn">k</code>-Means Clustering</h2><span id='topic+reAssign'></span><span id='topic+reAssign.tkmeans'></span>

<h3>Description</h3>

<p>Re-assign the observations,
which are trimmed in the trimmed <code class="reqn">k</code>-means algorithm,
back to the closest cluster as determined by the smallest
Mahalanobis distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reAssign(x, ...)

## S3 method for class 'tkmeans'
reAssign(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reAssign_+3A_x">x</code></td>
<td>
<p>a <a href="tclust.html#topic+tkmeans">tkmeans</a> object</p>
</td></tr>
<tr><td><code id="reAssign_+3A_...">...</code></td>
<td>
<p>potential parameters, currently not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the <a href="tclust.html#topic+tkmeans">tkmeans</a> input,
the <a href="stats.html#topic+mahalanobis">mahalanobis</a> distance is computed between each trimmed observation
and each cluster.
Each trimmed observation is assigned to the closest cluster (i.e., with the smallest Mahalanobis distance).
</p>


<h3>Value</h3>

<p>Function <code><a href="#topic+reAssign.tkmeans">reAssign.tkmeans()</a></code> returns an <code>'reAssign_tkmeans'</code> object,
which inherits from <a href="tclust.html#topic+tkmeans">tkmeans</a> class.
</p>


<h3>Note</h3>

<p>Either <a href="stats.html#topic+kmeans">kmeans</a> or <a href="tclust.html#topic+tkmeans">tkmeans</a> is slow for big <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tclust)
data(geyser2)
clus = tkmeans(geyser2, k = 3L, alpha = .03)
plot(clus, main = 'Before Re-Assigning')
plot(reAssign(clus), main = 'After Re-Assigning')

</code></pre>

<hr>
<h2 id='step_fmx'>Forward Selection of <code class="reqn">gh</code>-parsimonious Model with Fixed Number of Components <code class="reqn">K</code></h2><span id='topic+step_fmx'></span>

<h3>Description</h3>

<p>To select the <code class="reqn">gh</code>-parsimonious mixture model,
i.e., with some <code class="reqn">g</code> and/or <code class="reqn">h</code> parameters equal to zero,
conditionally on a fixed number of components <code class="reqn">K</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step_fmx(
  object,
  test = c("BIC", "AIC"),
  direction = c("forward", "backward"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step_fmx_+3A_object">object</code></td>
<td>
<p><a href="fmx.html#topic+fmx-class">fmx</a> object</p>
</td></tr>
<tr><td><code id="step_fmx_+3A_test">test</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar, criterion to be used, either
Akaike's information criterion <a href="stats.html#topic+AIC">AIC</a>-like, or
Bayesian information criterion <a href="stats.html#topic+BIC">BIC</a>-like (default).</p>
</td></tr>
<tr><td><code id="step_fmx_+3A_direction">direction</code></td>
<td>
<p><a href="base.html#topic+character">character</a> scalar, <code>'forward'</code> (default) or
<code>'backward'</code></p>
</td></tr>
<tr><td><code id="step_fmx_+3A_...">...</code></td>
<td>
<p>additional parameters, currently not in use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm starts with quantile least Mahalanobis distance estimates
of either the full mixture of Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> distributions model, or
a constrained model (i.e., some <code class="reqn">g</code> and/or <code class="reqn">h</code> parameters equal to zero according to the user input).
Next, each of the non-zero <code class="reqn">g</code> and/or <code class="reqn">h</code> parameters is tested using the likelihood ratio test.
If all tested <code class="reqn">g</code> and/or <code class="reqn">h</code> parameters are significantly different from zero at the level 0.05
the algorithm is stopped and the initial model is considered <code class="reqn">gh</code>-parsimonious.
Otherwise, the <code class="reqn">g</code> or <code class="reqn">h</code> parameter with the largest p-value is constrained to zero
for the next iteration of the algorithm.
</p>
<p>The algorithm iterates until only significantly-different-from-zero <code class="reqn">g</code> and <code class="reqn">h</code> parameters
are retained, which corresponds to <code class="reqn">gh</code>-parsimonious Tukey <code class="reqn">g</code>-&amp;-<code class="reqn">h</code> mixture model.
</p>


<h3>Value</h3>

<p>Function <code><a href="#topic+step_fmx">step_fmx()</a></code> returns an object of S3 class <code>'step_fmx'</code>,
which is a <a href="base.html#topic+list">list</a> of selected models (in reversed order) with attribute(s)
<code>'direction'</code> and
<code>'test'</code>.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+step">step</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
