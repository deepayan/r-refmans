<!DOCTYPE html><html><head><title>Help for package covsep</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {covsep}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#covsep'><p>covsep: tests for determining if the covariance structure of</p>
2-dimensional data is separable</a></li>
<li><a href='#C1'><p>A covariance matrix</p></a></li>
<li><a href='#C2'><p>A covariance matrix</p></a></li>
<li><a href='#clt_test'><p>Test for separability of covariance operators for Gaussian process.</p></a></li>
<li><a href='#difference_fullcov'><p>compute the difference between the full sample covariance and its separable</p>
approximation</a></li>
<li><a href='#empirical_bootstrap_test'><p>Projection-based empirical bootstrap test for separability of covariance structure</p></a></li>
<li><a href='#gaussian_bootstrap_test'><p>Projection-based Gaussian (parametric) bootstrap test for separability of covariance structure</p></a></li>
<li><a href='#generate_surface_data'><p>Generate surface data</p></a></li>
<li><a href='#HS_empirical_bootstrap_test'><p>Empirical bootstrap test for</p>
separability of covariance structure using Hilbert&ndash;Schmidt distance</a></li>
<li><a href='#HS_gaussian_bootstrap_test'><p>Gaussian (parametric) bootstrap test</p>
for separability of covariance structure using Hilbert&ndash;Schmidt distance</a></li>
<li><a href='#marginal_covariances'><p>estimates marginal covariances (e.g. row and column covariances) of bi-dimensional sample</p></a></li>
<li><a href='#projected_differences'><p>Compute the projection of the rescaled difference between the sample covariance</p>
and its separable approximation onto the separable eigenfunctions</a></li>
<li><a href='#renormalize_mtnorm'><p>renormalize a matrix normal random matrix to have iid entries</p></a></li>
<li><a href='#rmtnorm'><p>Generate a sample from a Matrix Gaussian distribution</p></a></li>
<li><a href='#SurfacesData'><p>A data set of surfaces</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Tests for Determining if the Covariance Structure of
2-Dimensional Data is Separable</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Shahin Tavakoli [aut, cre],
  Davide Pigoli [ctb],
  John Aston [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shahin Tavakoli &lt;s.tavakoli@warwick.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for testing if the covariance structure of 2-dimensional data
    (e.g. samples of surfaces X_i = X_i(s,t)) is separable, i.e. if covariance(X) =
    C_1 x C_2.
    A complete descriptions of the implemented tests can be found in the paper
    Aston, John A. D.; Pigoli, Davide; Tavakoli, Shahin. Tests for separability in
    nonparametric covariance operators of random surfaces. Ann. Statist. 45 (2017),
    no. 4, 1431&ndash;1461. &lt;<a href="https://doi.org/10.1214%2F16-AOS1495">doi:10.1214/16-AOS1495</a>&gt; <a href="https://projecteuclid.org/euclid.aos/1498636862">https://projecteuclid.org/euclid.aos/1498636862</a> &lt;<a href="https://doi.org/10.48550/arXiv.1505.02023">doi:10.48550/arXiv.1505.02023</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm (&ge; 1.0.4)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-06 11:16:53 UTC; stavakol</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-06 15:37:27 UTC</td>
</tr>
</table>
<hr>
<h2 id='covsep'>covsep: tests for determining if the covariance structure of
2-dimensional data is separable</h2><span id='topic+covsep'></span><span id='topic+covsep-package'></span>

<h3>Description</h3>

<p>Functions for testing if the covariance structure of 2-dimensional data (e.g.
samples of surfaces X_i = X_i(s,t)) is separable, i.e. if cov(X) = C_1 x C_2. 
A complete descriptions of the implemented tests can be found in the paper Aston et al. (2017); see references below.
</p>


<h3>Main functions</h3>

<p>The main functions are </p>

<ul>
<li> <p><code><a href="#topic+clt_test">clt_test</a></code>,
</p>
</li>
<li> <p><code><a href="#topic+gaussian_bootstrap_test">gaussian_bootstrap_test</a></code>, 
</p>
</li>
<li> <p><code><a href="#topic+empirical_bootstrap_test">empirical_bootstrap_test</a></code>,
</p>
</li>
<li> <p><code><a href="#topic+HS_gaussian_bootstrap_test">HS_gaussian_bootstrap_test</a></code>,
</p>
</li>
<li> <p><code><a href="#topic+HS_empirical_bootstrap_test">HS_empirical_bootstrap_test</a></code>
</p>
</li></ul>



<h3>References</h3>

<p><cite>Aston, John A. D.; Pigoli, Davide; Tavakoli, Shahin. Tests for
separability in nonparametric covariance operators of random surfaces. Ann.
Statist. 45 (2017), no. 4, 1431&ndash;1461. &lt;doi:10.1214/16-AOS1495&gt;.
https://projecteuclid.org/euclid.aos/1498636862</cite>
</p>

<hr>
<h2 id='C1'>A covariance matrix</h2><span id='topic+C1'></span>

<h3>Description</h3>

<p>Marginal covariance matrix C1 used for simulations in the paper <a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C1
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> with 32 rows and 32 columns.</p>


<h3>Details</h3>

<p>This is a 32x32 real-valued covariance matrix.
</p>


<h3>References</h3>

<p><cite>Aston, John A. D.; Pigoli, Davide; Tavakoli, Shahin. Tests for
separability in nonparametric covariance operators of random surfaces. Ann.
Statist. 45 (2017), no. 4, 1431&ndash;1461. doi:10.1214/16-AOS1495.
https://projecteuclid.org/euclid.aos/1498636862</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(C1)
str(C1) 

</code></pre>

<hr>
<h2 id='C2'>A covariance matrix</h2><span id='topic+C2'></span>

<h3>Description</h3>

<p>Marginal covariance matrix C2 used for simulations in paper
<a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C2
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> with 7 rows and 7 columns.</p>


<h3>Details</h3>

<p>This is a 7x7 real-valued covariance matrix.
</p>


<h3>References</h3>

<p><cite>Aston, John A. D.; Pigoli, Davide; Tavakoli, Shahin. Tests for
separability in nonparametric covariance operators of random surfaces. Ann.
Statist. 45 (2017), no. 4, 1431&ndash;1461. doi:10.1214/16-AOS1495.
https://projecteuclid.org/euclid.aos/1498636862</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(C2)
str(C2)

</code></pre>

<hr>
<h2 id='clt_test'>Test for separability of covariance operators for Gaussian process.</h2><span id='topic+clt_test'></span>

<h3>Description</h3>

<p>This function performs the asymptotic test  for the separability of the covariance operator for a random surface generated from a Gaussian process (described in the paper <a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clt_test(Data, L1, L2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clt_test_+3A_data">Data</code></td>
<td>
<p>a (non-empty) <code>N x d1 x d2</code> array of data values. The first
direction indices the <code class="reqn">N</code> observations, each consisting of a <code>d1 x d2</code>
discretization of the surface, so that <code>Data[i,,]</code> corresponds to the
i-th observed surface.</p>
</td></tr>
<tr><td><code id="clt_test_+3A_l1">L1</code></td>
<td>
<p>an integer or vector of integers in <code class="reqn">1:p</code> indicating the
eigenfunctions in the first direction to be used for the test.</p>
</td></tr>
<tr><td><code id="clt_test_+3A_l2">L2</code></td>
<td>
<p>an integer or vector of integers in <code class="reqn">1:q</code> indicating the
eigenfunctions in the second direction to be used for the test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The p-value of the test for each pair <code>(l1,l2) = (L1[k], L2[k])</code>, for <code>k = 1:length(L1)</code>.
</p>


<h3>Details</h3>

<p>If L1 and L2 are vectors, they need to be of the same length.
</p>
<p>The function tests for separability using the projection of the covariance
operator in the separable eigenfunctions <code>u_i tensor v_j : i = 1, ..., l1;
j = 1, ..., l2</code>, for each pair <code>(l1,l2) = (L1[k], L2[k])</code>, for <code>k = 1:length(L1)</code>.
</p>
<p>The test works by using asymptotics, and is
only valid if the data is assumed to be Gaussian.
</p>
<p>The surface data needs to be measured or resampled on a common regular grid
or on common basis functions.
</p>


<h3>References</h3>

<p><cite>Aston, John A. D.; Pigoli, Davide; Tavakoli, Shahin. Tests for
separability in nonparametric covariance operators of random surfaces. Ann.
Statist. 45 (2017), no. 4, 1431&ndash;1461. doi:10.1214/16-AOS1495.
https://projecteuclid.org/euclid.aos/1498636862</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+empirical_bootstrap_test">empirical_bootstrap_test</a></code>, <code><a href="#topic+gaussian_bootstrap_test">gaussian_bootstrap_test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SurfacesData)
clt_test(SurfacesData, L1=c(1,2), L2=c(1,4))

</code></pre>

<hr>
<h2 id='difference_fullcov'>compute the difference between the full sample covariance and its separable
approximation</h2><span id='topic+difference_fullcov'></span>

<h3>Description</h3>

<p>compute the difference between the full sample covariance and its separable
approximation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difference_fullcov(Data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="difference_fullcov_+3A_data">Data</code></td>
<td>
<p>a (non-empty) <code>N x d1 x d2</code> array of data values. The first
direction indices the <code class="reqn">N</code> observations, each consisting of a <code>d1 x d2</code>
discretization of the surface, so that <code>Data[i,,]</code> corresponds to the
i-th observed surface.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>d1 x d2 x d1 x d2</code> array, where <code>d1 = nrow(Data)</code> and
<code>d2 = ncol(Data)</code>.
</p>


<h3>Details</h3>

<p>This is an internal function.
</p>

<hr>
<h2 id='empirical_bootstrap_test'>Projection-based empirical bootstrap test for separability of covariance structure</h2><span id='topic+empirical_bootstrap_test'></span>

<h3>Description</h3>

<p>This function performs the test for the separability of covariance structure
of a random surface based on the empirical bootstrap procedure described in
the paper <a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>empirical_bootstrap_test(Data, L1 = 1, L2 = 1, studentize = "full",
  B = 1000, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="empirical_bootstrap_test_+3A_data">Data</code></td>
<td>
<p>a (non-empty) <code>N x d1 x d2</code> array of data values. The first
direction indices the <code class="reqn">N</code> observations, each consisting of a <code>d1 x d2</code>
discretization of the surface, so that <code>Data[i,,]</code> corresponds to the
i-th observed surface.</p>
</td></tr>
<tr><td><code id="empirical_bootstrap_test_+3A_l1">L1</code></td>
<td>
<p>an integer or vector of integers in <code class="reqn">1:p</code> indicating the
eigenfunctions in the first direction to be used for the test.</p>
</td></tr>
<tr><td><code id="empirical_bootstrap_test_+3A_l2">L2</code></td>
<td>
<p>an integer or vector of integers in <code class="reqn">1:q</code> indicating the
eigenfunctions in the second direction to be used for the test.</p>
</td></tr>
<tr><td><code id="empirical_bootstrap_test_+3A_studentize">studentize</code></td>
<td>
<p>parameter to specify which type of studentization is performed. Possible options are 'no', 'diag' or 'full' (see details section).</p>
</td></tr>
<tr><td><code id="empirical_bootstrap_test_+3A_b">B</code></td>
<td>
<p>number of bootstrap replicates to be used.</p>
</td></tr>
<tr><td><code id="empirical_bootstrap_test_+3A_verbose">verbose</code></td>
<td>
<p>logical parameter for printing progress</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The p-value of the test for each pair <code>(l1,l2) = (L1[k], L2[k])</code>, for <code>k = 1:length(L1)</code>.
</p>


<h3>Details</h3>

<p>This function performs the test of separability 
of the covariance structure for a random surface (introduced in the paper
<a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>), when generated from a Gaussian
process. The sample surfaces need to be measured on a common regular grid. The test
consider a subspace formed by the tensor product of eigenfunctions of the separable
covariances. It is possible to specify the number of eigenfunctions to be considered
in each direction. 
</p>
<p>If L1 and L2 are vectors, they need to be of the same length.
</p>
<p>The function tests for separability using the projection of the covariance
operator in the separable eigenfunctions <code>u_i x v_j : i = 1, ..., l1;
j = 1, ..., l2</code>, for each pair (l1,l2) = (L1[k], L2[k]), for k = 1:length(L1).
</p>
<p><code>studentize</code> can take the values </p>

<dl>
<dt>'full'</dt><dd><p>default &amp; recommended method. Yhe projection coordinates are renormalized by an estimate of
their joint covariance</p>
</dd>
<dt>'no'</dt><dd><p>NOT RECOMMENDED. No studentization is performed</p>
</dd>
<dt>'diag'</dt><dd><p>NOT RECOMMENDED. Each projection coordinate is renormalized by an estimate of its standard deviation</p>
</dd>
</dl>

<p><code>B</code> the number of bootstrap replicates (1000 by default).
</p>
<p><code>verbose</code> to print the progress of the computations (TRUE by default)
</p>


<h3>References</h3>

<p><cite>Aston, John A. D.; Pigoli, Davide; Tavakoli, Shahin. Tests for
separability in nonparametric covariance operators of random surfaces. Ann.
Statist. 45 (2017), no. 4, 1431&ndash;1461. doi:10.1214/16-AOS1495.
https://projecteuclid.org/euclid.aos/1498636862</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gaussian_bootstrap_test">gaussian_bootstrap_test</a></code>, <code><a href="#topic+clt_test">clt_test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SurfacesData)
empirical_bootstrap_test(SurfacesData)
empirical_bootstrap_test(SurfacesData, B=100)
empirical_bootstrap_test(SurfacesData,L1=2,L2=2, B=1000, studentize='full')
</code></pre>

<hr>
<h2 id='gaussian_bootstrap_test'>Projection-based Gaussian (parametric) bootstrap test for separability of covariance structure</h2><span id='topic+gaussian_bootstrap_test'></span>

<h3>Description</h3>

<p>This function performs the test for the separability of covariance structure
of a random surface generated from a Gaussian process, based on the
parametric bootstrap procedure described in the paper
<a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gaussian_bootstrap_test(Data, L1 = 1, L2 = 2, studentize = "full",
  B = 1000, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gaussian_bootstrap_test_+3A_data">Data</code></td>
<td>
<p>a (non-empty) <code>N x d1 x d2</code> array of data values. The first
direction indices the <code class="reqn">N</code> observations, each consisting of a <code>d1 x d2</code>
discretization of the surface, so that <code>Data[i,,]</code> corresponds to the
i-th observed surface.</p>
</td></tr>
<tr><td><code id="gaussian_bootstrap_test_+3A_l1">L1</code></td>
<td>
<p>an integer or vector of integers in <code class="reqn">1:p</code> indicating the
eigenfunctions in the first direction to be used for the test.</p>
</td></tr>
<tr><td><code id="gaussian_bootstrap_test_+3A_l2">L2</code></td>
<td>
<p>an integer or vector of integers in <code class="reqn">1:q</code> indicating the
eigenfunctions in the second direction to be used for the test.</p>
</td></tr>
<tr><td><code id="gaussian_bootstrap_test_+3A_studentize">studentize</code></td>
<td>
<p>parameter to specify which type of studentization is performed. Possible options are 'no', 'diag' or 'full' (see details section).</p>
</td></tr>
<tr><td><code id="gaussian_bootstrap_test_+3A_b">B</code></td>
<td>
<p>number of bootstrap replicates to be used.</p>
</td></tr>
<tr><td><code id="gaussian_bootstrap_test_+3A_verbose">verbose</code></td>
<td>
<p>logical parameter for printing progress</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The p-value of the test for each pair <code>(l1,l2) = (L1[k], L2[k])</code>, for <code>k = 1:length(L1)</code>.
</p>


<h3>Details</h3>

<p>This function performs the test of separability 
of the covariance structure for a random surface (introduced in the paper
<a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>), when generated from a Gaussian
process. The sample surfaces need to be measured on a common regular grid. The test
consider a subspace formed by the tensor product of eigenfunctions of the separable
covariances. It is possible to specify the number of eigenfunctions to be considered
in each direction. 
</p>
<p>If L1 and L2 are vectors, they need to be of the same length.
</p>
<p>The function tests for separability using the projection of the covariance
operator in the separable eigenfunctions <code>u_i x v_j : i = 1, ..., l1;
j = 1, ..., l2</code>, for each pair (l1,l2) = (L1[k], L2[k]), for k = 1:length(L1).
</p>
<p><code>studentize</code> can take the values </p>

<dl>
<dt>'full'</dt><dd><p>default &amp; recommended method. Yhe projection coordinates are renormalized by an estimate of
their joint covariance</p>
</dd>
<dt>'no'</dt><dd><p>NOT RECOMMENDED. No studentization is performed</p>
</dd>
<dt>'diag'</dt><dd><p>NOT RECOMMENDED. Each projection coordinate is renormalized by an estimate of its standard deviation</p>
</dd>
</dl>

<p><code>B</code> the number of bootstrap replicates (1000 by default).
</p>
<p><code>verbose</code> to print the progress of the computations (TRUE by default)
</p>


<h3>References</h3>

<p><cite>Aston, John A. D.; Pigoli, Davide; Tavakoli, Shahin. Tests for
separability in nonparametric covariance operators of random surfaces. Ann.
Statist. 45 (2017), no. 4, 1431&ndash;1461. doi:10.1214/16-AOS1495.
https://projecteuclid.org/euclid.aos/1498636862</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+empirical_bootstrap_test">empirical_bootstrap_test</a></code>, <code><a href="#topic+clt_test">clt_test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SurfacesData)
gaussian_bootstrap_test(SurfacesData)
gaussian_bootstrap_test(SurfacesData, B=100)
gaussian_bootstrap_test(SurfacesData, L1=2,L2=2,B=1000, studentize='full')

</code></pre>

<hr>
<h2 id='generate_surface_data'>Generate surface data</h2><span id='topic+generate_surface_data'></span>

<h3>Description</h3>

<p>Generate samples of surface data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_surface_data(N, C1, C2, gamma, distribution = "gaussian")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_surface_data_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="generate_surface_data_+3A_c1">C1</code></td>
<td>
<p>row covariance</p>
</td></tr>
<tr><td><code id="generate_surface_data_+3A_c2">C2</code></td>
<td>
<p>column covariance</p>
</td></tr>
<tr><td><code id="generate_surface_data_+3A_gamma">gamma</code></td>
<td>
<p>parameter to specify how much the covariance is separable.</p>
</td></tr>
<tr><td><code id="generate_surface_data_+3A_distribution">distribution</code></td>
<td>
<p>distribution of the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>N x dim(C1)[1] x dim(C2)[1]</code> array containing the
generated data
</p>


<h3>Details</h3>

<p><code>gamma</code> can take values between 0 and 1; <code>gamma=0</code> corresponds to
a separable covariance, <code>gamma=1</code> corresponds to a non-separable
covariance (described in the paper <a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>).
Values of <code>gamma</code> between 0 and 1 corresponds to an interpolation between
these two covariances
</p>
<p><code> distribution </code> can take the values 'gaussian' or 'student'
</p>


<h3>References</h3>

<p><cite>Aston, John A. D.; Pigoli, Davide; Tavakoli, Shahin. Tests for
separability in nonparametric covariance operators of random surfaces. Ann.
Statist. 45 (2017), no. 4, 1431&ndash;1461. doi:10.1214/16-AOS1495.
https://projecteuclid.org/euclid.aos/1498636862</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data = generate_surface_data(30, C1, C2, gamma=0)

</code></pre>

<hr>
<h2 id='HS_empirical_bootstrap_test'>Empirical bootstrap test for
separability of covariance structure using Hilbert&ndash;Schmidt distance</h2><span id='topic+HS_empirical_bootstrap_test'></span>

<h3>Description</h3>

<p>Empirical bootstrap test for
separability of covariance structure using Hilbert&ndash;Schmidt distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HS_empirical_bootstrap_test(Data, B = 100, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HS_empirical_bootstrap_test_+3A_data">Data</code></td>
<td>
<p>a (non-empty) <code>N x d1 x d2</code> array of data values. The first
direction indices the <code class="reqn">N</code> observations, each consisting of a <code>d1 x d2</code>
discretization of the surface, so that <code>Data[i,,]</code> corresponds to the
i-th observed surface.</p>
</td></tr>
<tr><td><code id="HS_empirical_bootstrap_test_+3A_b">B</code></td>
<td>
<p>number of bootstrap replicates to be used.</p>
</td></tr>
<tr><td><code id="HS_empirical_bootstrap_test_+3A_verbose">verbose</code></td>
<td>
<p>logical parameter for printing progress</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The p-value of the test.
</p>


<h3>Details</h3>

<p>This function performs the test of separability 
of the covariance structure for a random surface (introduced in the paper
<a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>), when generated from a Gaussian
process. The sample surfaces need to be measured on a common regular grid. The test
considers the Hilbert&ndash;Schmidt distance between the sample covariance and its
separable approximation. WE DO NOT RECOMMEND THIS TEST, as it is does not have the
correct level, nor good power.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SurfacesData)
HS_empirical_bootstrap_test(SurfacesData)
HS_empirical_bootstrap_test(SurfacesData, B = 100)
</code></pre>

<hr>
<h2 id='HS_gaussian_bootstrap_test'>Gaussian (parametric) bootstrap test
for separability of covariance structure using Hilbert&ndash;Schmidt distance</h2><span id='topic+HS_gaussian_bootstrap_test'></span>

<h3>Description</h3>

<p>Gaussian (parametric) bootstrap test
for separability of covariance structure using Hilbert&ndash;Schmidt distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HS_gaussian_bootstrap_test(Data, B = 1000, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HS_gaussian_bootstrap_test_+3A_data">Data</code></td>
<td>
<p>a (non-empty) <code>N x d1 x d2</code> array of data values. The first
direction indices the <code class="reqn">N</code> observations, each consisting of a <code>d1 x d2</code>
discretization of the surface, so that <code>Data[i,,]</code> corresponds to the
i-th observed surface.</p>
</td></tr>
<tr><td><code id="HS_gaussian_bootstrap_test_+3A_b">B</code></td>
<td>
<p>number of bootstrap replicates to be used.</p>
</td></tr>
<tr><td><code id="HS_gaussian_bootstrap_test_+3A_verbose">verbose</code></td>
<td>
<p>logical parameter for printing progress</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The p-value of the test.
</p>


<h3>Details</h3>

<p>This function performs the test of separability 
of the covariance structure for a random surface (introduced in the paper
<a href="http://arxiv.org/abs/1505.02023">http://arxiv.org/abs/1505.02023</a>), when generated from a Gaussian
process. The sample surfaces need to be measured on a common regular grid. The test
considers the Hilbert&ndash;Schmidt distance between the sample covariance and its separable approximation. WE DO NOT RECOMMEND THIS TEST, as it is does not have the
correct level, nor good power.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SurfacesData)
HS_gaussian_bootstrap_test(SurfacesData)
HS_gaussian_bootstrap_test(SurfacesData, B = 100)
</code></pre>

<hr>
<h2 id='marginal_covariances'>estimates marginal covariances (e.g. row and column covariances) of bi-dimensional sample</h2><span id='topic+marginal_covariances'></span>

<h3>Description</h3>

<p>estimates marginal covariances (e.g. row and column covariances) of bi-dimensional sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marginal_covariances(Data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marginal_covariances_+3A_data">Data</code></td>
<td>
<p>a (non-empty) <code>N x d1 x d2</code> array of data values. The first
direction indices the <code class="reqn">N</code> observations, each consisting of a <code>d1 x d2</code>
discretization of the surface, so that <code>Data[i,,]</code> corresponds to the
i-th observed surface.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the row covariance (<code>C1</code>) and column covariance (<code>C2</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data  &lt;-  rmtnorm(30, C1, C2)
marginal.cov  &lt;- marginal_covariances(Data)
</code></pre>

<hr>
<h2 id='projected_differences'>Compute the projection of the rescaled difference between the sample covariance
and its separable approximation onto the separable eigenfunctions</h2><span id='topic+projected_differences'></span>

<h3>Description</h3>

<p>Compute the projection of the rescaled difference between the sample covariance
and its separable approximation onto the separable eigenfunctions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>projected_differences(Data, l1 = 1, l2 = 1,
  with.asymptotic.variances = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="projected_differences_+3A_data">Data</code></td>
<td>
<p>a (non-empty) <code>N x d1 x d2</code> array of data values. The first
direction indices the <code class="reqn">N</code> observations, each consisting of a <code>d1 x d2</code>
discretization of the surface, so that <code>Data[i,,]</code> corresponds to the
i-th observed surface.</p>
</td></tr>
<tr><td><code id="projected_differences_+3A_l1">l1</code></td>
<td>
<p>number of eigenfunctions to be used in the first (row) dimension for the projection</p>
</td></tr>
<tr><td><code id="projected_differences_+3A_l2">l2</code></td>
<td>
<p>number of eigenfunctions to be used in the second (column) dimension for the projection</p>
</td></tr>
<tr><td><code id="projected_differences_+3A_with.asymptotic.variances">with.asymptotic.variances</code></td>
<td>
<p>logical variable; if TRUE, the function outputs the estimate asymptotic variances of the projected differences</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with
</p>

<dl>
<dt>T.N</dt><dd><p>The projected differences</p>
</dd>
<dt>sigma.left</dt><dd><p>The row covariances of <code>T.N</code></p>
</dd>
<dt>sigma.right</dt><dd><p>The column covariances of <code>T.N</code></p>
</dd>
</dl>



<h3>Details</h3>

<p>The function computes the projection of the rescaled difference between the sample covariance
and its separable approximation onto the separable eigenfunctions <code>u_i
x v_j : i = 1, ..., l1; j = 1, ..., l2</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data  &lt;-  rmtnorm(30, C1, C2)
ans &lt;- projected_differences(Data, l1=1, l2=2)
</code></pre>

<hr>
<h2 id='renormalize_mtnorm'>renormalize a matrix normal random matrix to have iid entries</h2><span id='topic+renormalize_mtnorm'></span>

<h3>Description</h3>

<p>renormalize a matrix normal random matrix to have iid entries
</p>


<h3>Usage</h3>

<pre><code class='language-R'>renormalize_mtnorm(X, C1, C2, type = "full")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="renormalize_mtnorm_+3A_x">X</code></td>
<td>
<p>a matrix normal random matrix with mean zero</p>
</td></tr>
<tr><td><code id="renormalize_mtnorm_+3A_c1">C1</code></td>
<td>
<p>row covariance</p>
</td></tr>
<tr><td><code id="renormalize_mtnorm_+3A_c2">C2</code></td>
<td>
<p>column covariance</p>
</td></tr>
<tr><td><code id="renormalize_mtnorm_+3A_type">type</code></td>
<td>
<p>the type of renormalization to do.  Possible options are 'no',
'diag' or 'full' (see details section).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with renormalized entries
</p>


<h3>Details</h3>

<p><code> type </code> can take the values </p>

<dl>
<dt>'diag'</dt><dd><p>each entry of <code>X</code> is renormalized by its marginal standard deviation</p>
</dd>
<dt>'full'</dt><dd><p><code>X</code> is renormalized by its root inverse covariance</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>Data  &lt;-  rmtnorm(30, C1, C2)
ans  &lt;-  renormalize_mtnorm(Data[1,,], C1, C2)
</code></pre>

<hr>
<h2 id='rmtnorm'>Generate a sample from a Matrix Gaussian distribution</h2><span id='topic+rmtnorm'></span>

<h3>Description</h3>

<p>Generate a sample from a Matrix Gaussian distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmtnorm(N, C1, C2, M = matrix(0, nrow(C1), nrow(C2)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmtnorm_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="rmtnorm_+3A_c1">C1</code></td>
<td>
<p>row covariance</p>
</td></tr>
<tr><td><code id="rmtnorm_+3A_c2">C2</code></td>
<td>
<p>column covariance</p>
</td></tr>
<tr><td><code id="rmtnorm_+3A_m">M</code></td>
<td>
<p>mean matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>N x dim(C1)[1] x dim(C2)[1]</code> array containing the
generated data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data = rmtnorm(30, C1, C2)
</code></pre>

<hr>
<h2 id='SurfacesData'>A data set of surfaces</h2><span id='topic+SurfacesData'></span>

<h3>Description</h3>

<p>Dataset of 50 surfaces simulated from a Gaussian process with a separable covariance structure. <code>SurfacesData[i,,]</code> corresponds to the i-th surface observed on a 32x7 uniform grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurfacesData
</code></pre>


<h3>Format</h3>

<p>An object of class <code>array</code> of dimension 50 x 32 x 7.</p>


<h3>Details</h3>

<p>This is a <code>50 x 32 x 7</code> array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SurfacesData)
image(SurfacesData[1,,]) # color image of the first surface in the dataset
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
