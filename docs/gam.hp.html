<!DOCTYPE html><html lang="en"><head><title>Help for package gam.hp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gam.hp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#creatbin'><p>Internal function for glmm.hp() to create diagonal matrix</p></a></li>
<li><a href='#gam.hp'><p>Hierarchical Partitioning of Adjusted R2 and Explained Deviance for Generalized Additive Models</p></a></li>
<li><a href='#genList'><p>Internal function for glmm.hp()</p></a></li>
<li><a href='#odd'><p>Internal function for glmm.hp() to determine whether the odd number</p></a></li>
<li><a href='#permu.gamhp'><p>Permutation Test of Hierarchical Partitioning for GAM Analysis</p></a></li>
<li><a href='#plot.gamhp'><p>Plot for a <code>gam.hp</code> object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hierarchical Partitioning of Adjusted R2 and Explained Deviance
for Generalized Additive Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-15</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0),mgcv,ggplot2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiangshan Lai &lt;lai@njfu.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Conducts hierarchical partitioning to calculate individual contributions of each predictor towards adjusted R2 and explained deviance for generalized additive models based on output of gam()in 'mgcv' package, applying the algorithm in this paper: Lai(2024) &lt;<a href="https://doi.org/10.1016%2Fj.pld.2024.06.002">doi:10.1016/j.pld.2024.06.002</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/laijiangshan/gam.hp">https://github.com/laijiangshan/gam.hp</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-16 03:29:04 UTC; lai</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiangshan Lai <a href="https://orcid.org/0000-0002-0279-8816"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Jing Tang [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-16 03:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='creatbin'>Internal function for glmm.hp() to create diagonal matrix</h2><span id='topic+creatbin'></span>

<h3>Description</h3>

<p>Internal function for glmm.hp() to create diagonal matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>creatbin(col, binmatrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="creatbin_+3A_col">col</code></td>
<td>
<p>Imput number.</p>
</td></tr>
<tr><td><code id="creatbin_+3A_binmatrix">binmatrix</code></td>
<td>
<p>Imput empty matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix
</p>
<table role = "presentation">
<tr><td><code>a matix</code></td>
<td>
<p>A diagonal matrix</p>
</td></tr>
</table>

<hr>
<h2 id='gam.hp'>Hierarchical Partitioning of Adjusted R2 and Explained Deviance for Generalized Additive Models</h2><span id='topic+gam.hp'></span>

<h3>Description</h3>

<p>Hierarchical Partitioning of Adjusted R2 and Explained Deviance for Generalized Additive Models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gam.hp(mod, iv = NULL, type = "dev", commonality = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gam.hp_+3A_mod">mod</code></td>
<td>
<p>Fitted &quot;gam&quot; model objects.</p>
</td></tr>
<tr><td><code id="gam.hp_+3A_iv">iv</code></td>
<td>
<p>optional The relative importance of predictor groups will be assessed. The input for iv should be a list, where each element contains the names of variables belonging to a specific group. These variable names must correspond to the predictor variables defined in the model (mod).</p>
</td></tr>
<tr><td><code id="gam.hp_+3A_type">type</code></td>
<td>
<p>The type of R-square of gam, either &quot;dev&quot; or &quot;adjR2&quot;, in which &quot;dev&quot; is explained deviance and &quot;adjR2&quot; is adjusted R-square, the default is &quot;dev&quot;.</p>
</td></tr>
<tr><td><code id="gam.hp_+3A_commonality">commonality</code></td>
<td>
<p>Logical; If TRUE, the result of commonality analysis (2^N-1 fractions for N predictors) is shown, the default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function conducts hierarchical partitioning to calculate the individual contributions of each predictor towards total adjusted R2 and explained deviance for Generalized Additive Models. The adjusted R2 and explained deviance are is the output of summary.gam()in mgcv package.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dev</code></td>
<td>
<p>The R2 for the full model.</p>
</td></tr>
<tr><td><code>hierarchical.partitioning</code></td>
<td>
<p>A matrix containing individual effects and percentage of individual effects towards total adjusted R2 and explained deviance for each predictor.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@njfu.edu.cn">lai@njfu.edu.cn</a>
</p>


<h3>References</h3>


<ul>
<li><p> Lai J.,Tang J., Li T., Zhang A.,Mao L.(2024)Evaluating the relative importance of predictors in Generalized Additive Models using the gam.hp R package.Plant Diversity,46(4):542-546&lt;DOI:10.1016/j.pld.2024.06.002&gt;
</p>
</li>
<li><p> Lai J.,Zhu W., Cui D.,Mao L.(2023)Extension of the glmm.hp package to Zero-Inflated generalized linear mixed models and multiple regression.Journal of Plant Ecology,16(6):rtad038&lt;DOI:10.1093/jpe/rtad038&gt;
</p>
</li>
<li><p> Lai J.,Zou Y., Zhang S.,Zhang X.,Mao L.(2022)glmm.hp: an R package for computing individual effect of predictors in generalized linear mixed models.Journal of Plant Ecology,15(6):1302-1307&lt;DOI:10.1093/jpe/rtac096&gt;
</p>
</li>
<li><p> Lai J.,Zou Y., Zhang J.,Peres-Neto P.(2022) Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package.Methods in Ecology and Evolution,13(4):782-788&lt;DOI:10.1111/2041-210X.13800&gt;
</p>
</li>
<li><p> Chevan, A. &amp; Sutherland, M. (1991). Hierarchical partitioning. American Statistician, 45, 90-96. doi:10.1080/00031305.1991.10475776
</p>
</li>
<li><p> Nimon, K., Oswald, F.L. &amp; Roberts, J.K. (2013). Yhat: Interpreting regression effects. R package version 2.0.0.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(mgcv)
mod1 &lt;- gam(Sepal.Length ~ s(Petal.Length) + s(Petal.Width) + Sepal.Width,data = iris)
summary(mod1)
gam.hp(mod1)
gam.hp(mod1,type="adjR2")
gam.hp(mod1,commonality=TRUE)
iv &lt;- list(env1=c("s(Petal.Length)","s(Petal.Width)"),env2="Sepal.Width")
gam.hp(mod1,iv,type="adjR2")
gam.hp(mod1,iv,commonality=TRUE)
</code></pre>

<hr>
<h2 id='genList'>Internal function for glmm.hp()</h2><span id='topic+genList'></span>

<h3>Description</h3>

<p>Internal function for glmm.hp()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genList(ivlist, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genList_+3A_ivlist">ivlist</code></td>
<td>
<p>The names of explanatory variable.</p>
</td></tr>
<tr><td><code id="genList_+3A_value">value</code></td>
<td>
<p>The sequence ID.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector
</p>
<table role = "presentation">
<tr><td><code>newlist</code></td>
<td>
<p>A vector for variable index.</p>
</td></tr>
</table>

<hr>
<h2 id='odd'>Internal function for glmm.hp() to determine whether the odd number</h2><span id='topic+odd'></span>

<h3>Description</h3>

<p>Internal function for glmm.hp() to determine whether the odd number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odd(val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="odd_+3A_val">val</code></td>
<td>
<p>Imput number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical value
</p>
<table role = "presentation">
<tr><td><code>Logical value</code></td>
<td>
<p>TRUE or FALSE</p>
</td></tr>
</table>

<hr>
<h2 id='permu.gamhp'>Permutation Test of Hierarchical Partitioning for GAM Analysis</h2><span id='topic+permu.gamhp'></span>

<h3>Description</h3>

<p>Permutation Test of Hierarchical Partitioning for GAM Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permu.gamhp(mod = NULL, iv = NULL, type = "dev", permutations = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permu.gamhp_+3A_mod">mod</code></td>
<td>
<p>gam model generated by mgcv::gam()</p>
</td></tr>
<tr><td><code id="permu.gamhp_+3A_iv">iv</code></td>
<td>
<p>optional The relative importance of predictor groups will be assessed. The input for iv should be a list, where each element contains the names of variables belonging to a specific group. These variable names must correspond to the predictor variables defined in the model (mod).</p>
</td></tr>
<tr><td><code id="permu.gamhp_+3A_type">type</code></td>
<td>
<p>The type of total explained variation, either &quot;dev&quot; or &quot;adjR2&quot;, in which &quot;dev&quot; is deviance explained and &quot;adjR2&quot; is adjusted R-square, the default is &quot;adjR2&quot;.</p>
</td></tr>
<tr><td><code id="permu.gamhp_+3A_permutations">permutations</code></td>
<td>
<p>An integer; Number of permutations for computing p value of individual contribution for the randomized dataset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a permutation test of hierarchical partitioning for gam analysis. It returns a matrix of I values (the individual contribution towards total explained variation) for all values from permutations randomizations. For each permutation, the values in each variable (i.e each column of iv) are randomized independently, and gam.hp is run on the randomized iv. As well as the randomized I matrix, the function returns a summary table listing the observed I values, the p value of I for the randomized dataset.
</p>


<h3>Value</h3>

<p>a data.frame containing a summary table listing the observed individual contribution, the p value of individual contribution for the randomized dataset
</p>


<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@njfu.edu.cn">lai@njfu.edu.cn</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mgcv)
mod1 &lt;- gam(Sepal.Length ~ s(Petal.Length) + s(Petal.Width) + Sepal.Width,data = iris)
permu.gamhp(mod=mod1,type="dev",permutations=10)
iv &lt;- list(env1=c("s(Petal.Length)","s(Petal.Width)"),env2="Sepal.Width")
permu.gamhp(mod=mod1,iv,type="dev",permutations=10)
</code></pre>

<hr>
<h2 id='plot.gamhp'>Plot for a <code><a href="#topic+gam.hp">gam.hp</a></code> object</h2><span id='topic+plot.gamhp'></span>

<h3>Description</h3>

<p>Plot for a <code><a href="#topic+gam.hp">gam.hp</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamhp'
plot(x, plot.perc = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gamhp_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+gam.hp">gam.hp</a></code> object.</p>
</td></tr>
<tr><td><code id="plot.gamhp_+3A_plot.perc">plot.perc</code></td>
<td>
<p>Logical;if TRUE, the bar plot (based on ggplot2 package) of the percentage to individual effects of variables towards total explained variation, the default is FALSE to show plot with original individual effects.</p>
</td></tr>
<tr><td><code id="plot.gamhp_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>


<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@njfu.edu.cn">lai@njfu.edu.cn</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mgcv)
mod1 &lt;- gam(Sepal.Length ~ s(Petal.Length) + s(Petal.Width) + Sepal.Width,data = iris)
plot(gam.hp(mod1))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
