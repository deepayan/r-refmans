<!DOCTYPE html><html><head><title>Help for package fpop</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fpop}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Fpop'><p>Fpop</p></a></li>
<li><a href='#fpop_analysis'><p>fpop analysis</p></a></li>
<li><a href='#fpop-package'><p>Segmentation using optimal partioning and functional pruning</p></a></li>
<li><a href='#multiBinSeg'><p>multiBinSeg</p></a></li>
<li><a href='#retour_op'><p>retour op</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Segmentation using Optimal Partitioning and Function Pruning</td>
</tr>
<tr>
<td>Version:</td>
<td>2019.08.26</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guillem Rigaill &lt;guillem.rigaill@inra.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A dynamic programming algorithm for the fast segmentation of univariate signals into piecewise constant profiles.
  The 'fpop'  package is a wrapper to a C++ implementation of the fpop (Functional Pruning Optimal Partioning) algorithm described in Maidstone et al. 2017
  &lt;<a href="https://doi.org/10.1007%2Fs11222-016-9636-3">doi:10.1007/s11222-016-9636-3</a>&gt;. The problem of detecting changepoints in an univariate sequence is formulated 
  in terms of minimising the mean squared error over segmentations. The fpop algorithm exactly minimizes the mean squared error 
  for a penalty linear in the number of changepoints.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2.1)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-26 05:34:19 UTC; grigaill</td>
</tr>
<tr>
<td>Author:</td>
<td>Guillem Rigaill [aut, cre],
  Toby Hocking [aut],
  Robert Maidstone [aut],
  Michel Koskas [ctb],
  Paul Fearnhead [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-27 07:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='Fpop'>Fpop</h2><span id='topic+Fpop'></span>

<h3>Description</h3>

<p>Function calling the fpop algorithm, use functional pruning and
optimal partioning to recover the best segmentation with respect
to the L2 loss with a per change-point penalty of lambda. More
precisely, this function computes the solution to argmin_m
sum_i=1^n (x_i-m_i)^2 + lambda * sum_i=1^n-1 I(m_i !=
m_i+1), where the indicator function I counts the number of
changes in the mean vector m.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fpop(x, lambda, mini = min(x), maxi = max(x))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fpop_+3A_x">x</code></td>
<td>
<p>A vector of double : the signal to be segmented</p>
</td></tr>
<tr><td><code id="Fpop_+3A_lambda">lambda</code></td>
<td>
<p>Value of the penalty</p>
</td></tr>
<tr><td><code id="Fpop_+3A_mini">mini</code></td>
<td>
<p>Min value for the mean parameter of the segment</p>
</td></tr>
<tr><td><code id="Fpop_+3A_maxi">maxi</code></td>
<td>
<p>Max value for the mean parameter of the segment</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list with the following elements: input data (signal, n,
lambda, min, max), path (best previous segment end up to each data
point), cost (optimal penalized cost up to each data point), t.est
(vector of overall optimal segment ends), K (optimal number of
segments), J.est (total un-penalized cost of optimal model). To
see how cost relates to J.est, see definition of J.est in the R
source code for this function.</p>


<h3>Author(s)</h3>

<p>Guillem Rigaill, Toby Dylan Hocking</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
N &lt;- 100
data.vec &lt;- c(rnorm(N), rnorm(N, 2), rnorm(N))
fit &lt;- Fpop(data.vec, N)
end.vec &lt;- fit$t.est
change.vec &lt;- end.vec[-length(end.vec)]
start.vec &lt;- c(1, change.vec+1)
segs.list &lt;- list()
for(seg.i in seq_along(start.vec)){
  start &lt;- start.vec[seg.i]
  end &lt;- end.vec[seg.i]
  seg.data &lt;- data.vec[start:end]
  seg.mean &lt;- mean(seg.data)
  segs.list[[seg.i]] &lt;- data.frame(
    start, end,
    mean=seg.mean,
    seg.cost=sum((seg.data-seg.mean)^2))
}
segs &lt;- do.call(rbind, segs.list)
plot(data.vec)
with(segs, segments(start-0.5, mean, end+0.5, mean, col="green"))
with(segs[-1,], abline(v=start-0.5, col="green", lty="dotted"))
</code></pre>

<hr>
<h2 id='fpop_analysis'>fpop analysis</h2><span id='topic+fpop_analysis'></span>

<h3>Description</h3>

<p>A function to count the number of intervals and or candidate
segmentation at each step of fpop (under-developpemment)</p>


<h3>Usage</h3>

<pre><code class='language-R'>fpop_analysis(x, lambda, mini = min(x), maxi = max(x))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fpop_analysis_+3A_x">x</code></td>
<td>
<p>A vector of double : the signal to be segmented</p>
</td></tr>
<tr><td><code id="fpop_analysis_+3A_lambda">lambda</code></td>
<td>
<p>Value of the penalty</p>
</td></tr>
<tr><td><code id="fpop_analysis_+3A_mini">mini</code></td>
<td>
<p>Min value for the mean parameter of the segment</p>
</td></tr>
<tr><td><code id="fpop_analysis_+3A_maxi">maxi</code></td>
<td>
<p>Max value for the mean parameter of the segment</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a list with a vector containing the position of the change-points t.est</p>


<h3>Author(s)</h3>

<p>Guillem Rigaill, Toby Dylan Hocking</p>

<hr>
<h2 id='fpop-package'>Segmentation using optimal partioning and functional pruning</h2><span id='topic+fpop-package'></span><span id='topic+fpop'></span>

<h3>Description</h3>

<p>A wrapper to a C implementation of optimal partioning with functional pruning</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">Package: </td><td style="text-align: left;"> fpop</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Segmentation using optimal partioning and functional pruning</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2014.7.16</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> methods, cghseg</td>
</tr>
<tr>
 <td style="text-align: left;">
SystemRequirements: </td><td style="text-align: left;"> GNU GSL</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2014-02-26</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Guillem Rigaill</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Guillem Rigaill &lt;rigaill@evry.inra.fr&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> LGPL (&gt;= 2.1)</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Guillem Rigaill</p>

<hr>
<h2 id='multiBinSeg'>multiBinSeg</h2><span id='topic+multiBinSeg'></span>

<h3>Description</h3>

<p>Binary segmentation of p profiles using the L2 loss</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiBinSeg(geno, Kmax)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiBinSeg_+3A_geno">geno</code></td>
<td>
<p>A matrix with p columns and n lines, each column is one of the profile</p>
</td></tr>
<tr><td><code id="multiBinSeg_+3A_kmax">Kmax</code></td>
<td>
<p>Maximum number of change-points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return an object with the successive change-points found by binseg t.est and the L2 cost J.est</p>


<h3>Author(s)</h3>

<p>Guillem Rigaill, Toby Dylan Hocking</p>

<hr>
<h2 id='retour_op'>retour op</h2><span id='topic+retour_op'></span>

<h3>Description</h3>

<p>This function is used by the Fpop function to recover the best
segment ends from 1:n from the C output.</p>


<h3>Usage</h3>

<pre><code class='language-R'>retour_op(path)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="retour_op_+3A_path">path</code></td>
<td>
<p>the path vector of the &quot;colibri_op_R_c C&quot; function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with the best segment ends.</p>


<h3>Author(s)</h3>

<p>Guillem Rigaill, Toby Dylan Hocking</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
