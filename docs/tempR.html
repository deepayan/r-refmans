<!DOCTYPE html><html><head><title>Help for package tempR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tempR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#tempR'><p>tempR</p></a></li>
<li><a href='#adjust.brightness'><p>Adjust color brightness</p></a></li>
<li><a href='#bootstrap.band'><p>Get bootstrap confidence bands for attribute selections</p></a></li>
<li><a href='#citation.counts'><p>Counts TCATA Citations and Observations for a Product and a Comparison Set</p></a></li>
<li><a href='#convert.tcata'><p>Convert TCATA data</p></a></li>
<li><a href='#convert.tcategory'><p>Convert Temporal Category data</p></a></li>
<li><a href='#count.selections'><p>Count attribute selections</p></a></li>
<li><a href='#dist.city.block'><p>Calculate city block distance between two matrices</p></a></li>
<li><a href='#draw.hcross'><p>Draw h-cross, range box, and box to enclose h-box</p></a></li>
<li><a href='#fill.gaps'><p>Fills gaps</p></a></li>
<li><a href='#get.chance'><p>TDS chance proportion</p></a></li>
<li><a href='#get.decluttered'><p>Get decluttering matrix indicating where to show/hide reference lines</p></a></li>
<li><a href='#get.differences'><p>Get vector of difference in dominance rates</p></a></li>
<li><a href='#get.dominance.rates'><p>Get TDS dominance rates</p></a></li>
<li><a href='#get.mat.diff.sign'><p>Pairwise comparisons</p></a></li>
<li><a href='#get.significance'><p>TDS significance proportion</p></a></li>
<li><a href='#get.significance.diff'><p>Get least significant differences for pairwise comparisons</p></a></li>
<li><a href='#get.smooth'><p>Convenience function for curve smoothing</p></a></li>
<li><a href='#get.times'><p>Get times</p></a></li>
<li><a href='#lengthwhichis.na'><p>Count observations with missing data</p></a></li>
<li><a href='#make.palettes'><p>Convenience function for getting a pretty palette and highlight colours</p></a></li>
<li><a href='#plot_pca.trajectories'><p>Plot trajectories based on Temporal Check-All-That-Apply (TCATA) data</p></a></li>
<li><a href='#pretty_palette'><p>Get a pretty palette of colours</p></a></li>
<li><a href='#similarity.tcata.repeatability'><p>Quantify TCATA assessor repeatability</p></a></li>
<li><a href='#similarity.tcata.replication'><p>Quantify TCATA assessor replication</p></a></li>
<li><a href='#std.time'><p>Time standardize results</p></a></li>
<li><a href='#TCATA+20data+20set+3A+20orange+20juice'><p>TCATA data set: orange juice</p></a></li>
<li><a href='#TCATA+20data+20set+3A+20Syrah+20wines'><p>TCATA data set: Syrah wines</p></a></li>
<li><a href='#tcata.diff.plot'><p>TCATA difference plot</p></a></li>
<li><a href='#tcata.line.plot'><p>Temporal Check-All-That-Apply (TCATA) curve</p></a></li>
<li><a href='#TDS+20data+20set+3A+20orange+20juice'><p>TDS data set: orange juice</p></a></li>
<li><a href='#TDS+20data+20set+3A+20snack+20bars'><p>TDS data set: snack bars</p></a></li>
<li><a href='#tds.diff.plot'><p>Plot TDS difference curves</p></a></li>
<li><a href='#tds.plot'><p>Plot TDS curves</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Temporal Sensory Data Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.9.23</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-9-5</td>
</tr>
<tr>
<td>Author:</td>
<td>J.C. Castura <a href="https://orcid.org/0000-0002-1640-833X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>J.C. Castura &lt;jcastura@compusense.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis and visualization of data from temporal sensory methods, including for temporal check-all-that-apply (TCATA) and temporal dominance of sensations (TDS). Methods are mainly from manuscripts by Castura, J.C., Antúnez, L., Giménez, A., and Ares, G. (2016) &lt;<a href="https://doi.org/10.1016%2Fj.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>&gt;, Castura, Baker, and Ross (2016) &lt;<a href="https://doi.org/10.1016%2Fj.foodqual.2016.06.011">doi:10.1016/j.foodqual.2016.06.011</a>&gt;, and Pineau et al. (2009) &lt;<a href="https://doi.org/10.1016%2Fj.foodqual.2009.04.005">doi:10.1016/j.foodqual.2009.04.005</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, stats, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-05 16:53:46 UTC; jcastura</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-06 01:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='tempR'>tempR</h2><span id='topic+tempR'></span><span id='topic+tempR-package'></span>

<h3>Description</h3>

<p>Analysis and visualization of data from temporal sensory methods, including for temporal check-all-that-apply (TCATA) and temporal dominance of sensations (TDS).
</p>

<hr>
<h2 id='adjust.brightness'>Adjust color brightness</h2><span id='topic+adjust.brightness'></span>

<h3>Description</h3>

<p>Select suitable colors for highlighting plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjust.brightness(rgb.in, percent = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjust.brightness_+3A_rgb.in">rgb.in</code></td>
<td>
<p><code>rgb</code> of input color</p>
</td></tr>
<tr><td><code id="adjust.brightness_+3A_percent">percent</code></td>
<td>
<p>the degree to which input color will be modified/brightened</p>
</td></tr>
</table>


<h3>Value</h3>

<p>hex hex code for new color
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(rgb.in &lt;- c(col2rgb("red")))
adjust.brightness(rgb.in, percent = 10)
</code></pre>

<hr>
<h2 id='bootstrap.band'>Get bootstrap confidence bands for attribute selections</h2><span id='topic+bootstrap.band'></span>

<h3>Description</h3>

<p>Get bootstrap confidence bands for TCATA attribute citation rates or TDS attribute dominance rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap.band(X, boot = 999, alpha = 0.05, return.bias = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap.band_+3A_x">X</code></td>
<td>
<p>data frame of indicator data (with possible values <code>0</code> or <code>1</code>)</p>
</td></tr>
<tr><td><code id="bootstrap.band_+3A_boot">boot</code></td>
<td>
<p>number of virtual panels</p>
</td></tr>
<tr><td><code id="bootstrap.band_+3A_alpha">alpha</code></td>
<td>
<p>alpha level for bootstrap confidence bands</p>
</td></tr>
<tr><td><code id="bootstrap.band_+3A_return.bias">return.bias</code></td>
<td>
<p>indicates whether to return bias associated with bootstrap mean value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Get bootstrap confidence bands for TCATA attribute citation rates or TDS attribute dominance rates.
</p>


<h3>Value</h3>

<p><code>lcl</code> lower <code>100(alpha/2)%</code> bootstrap confidence limit
</p>
<p><code>ccl</code> upper <code>100(1 - alpha/2)%</code> bootstrap confidence limit
</p>
<p><code>bias</code> provided if <code>output.bias = TRUE</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- ojtcata[ojtcata$samp == 1 &amp; ojtcata$attribute == "Sweetness",  -c(1:4)]
x.boot.ci &lt;- bootstrap.band(x, boot = 99) # 99 is only for illustrative purposes
x.boot.ci
</code></pre>

<hr>
<h2 id='citation.counts'>Counts TCATA Citations and Observations for a Product and a Comparison Set</h2><span id='topic+citation.counts'></span>

<h3>Description</h3>

<p>Calculates how many times a specified product was checked and how many times a comparison set was checked.
The number of evaluations for the product and comparison set are also calculated,
along with a reference and decluttering matrix for plotting in <code><a href="#topic+tcata.line.plot">tcata.line.plot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>citation.counts(x, product.name = "", product.col = 1,
attribute.col = 2, results.col = NULL, comparison = "average")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="citation.counts_+3A_x">x</code></td>
<td>
<p>matrix of TCATA 0/1 data with (Assessors x Products x Reps x Attributes) in rows with row headers and (Times) in columns</p>
</td></tr>
<tr><td><code id="citation.counts_+3A_product.name">product.name</code></td>
<td>
<p>name of the product for which to calculate how many times a product was checked and not checked</p>
</td></tr>
<tr><td><code id="citation.counts_+3A_product.col">product.col</code></td>
<td>
<p>index of column in <code>x</code> that contains the product identities</p>
</td></tr>
<tr><td><code id="citation.counts_+3A_attribute.col">attribute.col</code></td>
<td>
<p>index of column in <code>x</code> that contains the attribute identities</p>
</td></tr>
<tr><td><code id="citation.counts_+3A_results.col">results.col</code></td>
<td>
<p>indices of columns in <code>x</code> that contain the raw (0/1) data</p>
</td></tr>
<tr><td><code id="citation.counts_+3A_comparison">comparison</code></td>
<td>
<p>specifies whether the comparison will be with the average of <em>all</em> products (<code>"average"</code> (default)) or with the average of the <em>other</em> products (<code>"other"</code>, i.e. excludes the product specified by <code>product.name</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list object with three elements:
</p>

<ul>
<li><p><code>P1</code> matrix of counts for product specified by <code>product.name</code>
(attributes are in rows; times are in columns).
</p>
</li>
<li><p><code>Pn</code> number of observations for <code>product.name</code>
</p>
</li>
<li><p><code>C1</code> matrix of counts for comparison set specified by <code>comparison</code>
(dimensions equal to <code>P1</code>.
</p>
</li>
<li><p><code>Cn</code> number of observations for the comparison set defined by <code>comparison</code>
</p>
</li>
<li><p><code>ref</code> a matrix of citation proportions for the comparison set specified
by <code>comparison</code> (dimensions equal to <code>P1</code>; can be used to draw a reference line;
see <code><a href="#topic+tcata.line.plot">tcata.line.plot</a></code>
</p>
</li>
<li><p><code>declutter</code> a matrix for decluttering in a line plot
(dimensions equal to <code>P1</code>; see <code><a href="#topic+get.decluttered">get.decluttered</a></code></p>
</li></ul>



<h3>References</h3>

<p>Castura, J.C., Antúnez, L., Giménez, A., Ares, G. (2016). Temporal check-all-that-apply (TCATA): A novel temporal sensory method for characterizing products. <em>Food Quality and Preference</em>, 47, 79-90. <a href="https://doi.org/10.1016/j.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>
</p>
<p>Meyners, M., Castura, J.C. (2018). The analysis of temporal check-all-that-apply (TCATA) data. <em>Food Quality and Preference</em>, 67, 67-76. <a href="https://doi.org/10.1016/j.foodqual.2017.02.003">doi:10.1016/j.foodqual.2017.02.003</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tcata.line.plot">tcata.line.plot</a></code>, <code><a href="#topic+get.decluttered">get.decluttered</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using 'ojtcata' data set
data(ojtcata)

# comparison of Orange Juice 3 vs. all other OJs (1, 2, 4, 5, 6)
oj3.v.other &lt;- citation.counts(ojtcata, product.name = "3", product.col = 2,
       attribute.col = 4, results.col = 5:25, comparison = "other")

# show results
oj3.v.other

times &lt;- get.times(colnames(ojtcata)[-c(1:4)])
attributes &lt;- unique(ojtcata$attribute)
palettes &lt;- make.palettes(length(attributes))

# plot results
tcata.line.plot(oj3.v.other$P1, n = oj3.v.other$Pn,
   attributes = attributes, times = times,
   line.col = palettes$pal, reference = oj3.v.other$ref, ref.lty = 3,
   declutter = oj3.v.other$declutter, highlight = TRUE, highlight.lwd = 4,
   highlight.col = palettes$pal.light,
   height = 7, width = 11, legend.cex = 0.7, main = "Product 3 vs. Other Products")
</code></pre>

<hr>
<h2 id='convert.tcata'>Convert TCATA data</h2><span id='topic+convert.tcata'></span>

<h3>Description</h3>

<p>Converts TCATA data from a set of onset-offset times to an indicator vector (<code>0</code>s and <code>1</code>s). Also works for TDS data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert.tcata(X, times, decimal.places = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert.tcata_+3A_x">X</code></td>
<td>
<p>matrix with onset (start) times in first column and offset (stop) times in second column</p>
</td></tr>
<tr><td><code id="convert.tcata_+3A_times">times</code></td>
<td>
<p>time slices for output indicator vector</p>
</td></tr>
<tr><td><code id="convert.tcata_+3A_decimal.places">decimal.places</code></td>
<td>
<p>decimal places used in <code>times</code>; used for naming of the indices of <code>out.vec</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>out.vec indictor vector(<code>0</code>s and <code>1</code>s)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- rbind(c(3.18, 6.83), c(8.46, 11.09), c(18.61, 21.80))
times &lt;- seq(0, 25, by = 0.01)
Xnew &lt;- convert.tcata(X, times)
Xnew
</code></pre>

<hr>
<h2 id='convert.tcategory'>Convert Temporal Category data</h2><span id='topic+convert.tcategory'></span>

<h3>Description</h3>

<p>Converts Temporal Category data from a set of onset-offset times and ratings to an vector of ratings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert.tcategory(X, in.scores, times, decimal.places = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert.tcategory_+3A_x">X</code></td>
<td>
<p>matrix with onset (start) times in first column and offset (stop) times in second column</p>
</td></tr>
<tr><td><code id="convert.tcategory_+3A_in.scores">in.scores</code></td>
<td>
<p>vector of category values corresponding to rows of <code>X</code></p>
</td></tr>
<tr><td><code id="convert.tcategory_+3A_times">times</code></td>
<td>
<p>time slices for output vector</p>
</td></tr>
<tr><td><code id="convert.tcategory_+3A_decimal.places">decimal.places</code></td>
<td>
<p>decimal places used in <code>times</code>; used for naming of the indices of <code>out.vec</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>out.vec indictor vector(<code>0</code>s and <code>1</code>s)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- rbind(c(3.18, 6.83), c(8.46, 11.09), c(18.61, 21.80))
in.scores &lt;- c(7, 6, 5)
times &lt;- seq(0, 25, by = 0.01)
Xnew &lt;- convert.tcategory(X, in.scores, times)
Xnew
</code></pre>

<hr>
<h2 id='count.selections'>Count attribute selections</h2><span id='topic+count.selections'></span>

<h3>Description</h3>

<p>Count the number of times that the attribute was selected (or optionally: deselected) in a single TCATA or TDS evaluation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>count.selections(x, deselections = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="count.selections_+3A_x">x</code></td>
<td>
<p>vector of binary data (with possible values <code>0</code> or <code>1</code>)</p>
</td></tr>
<tr><td><code id="count.selections_+3A_deselections">deselections</code></td>
<td>
<p>set to <code>TRUE</code> if purpose is to count the number of deselections</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Count the number of times that the attribute was selected (or, optionally, deselected) in a single TCATA or TDS evaluation.
</p>


<h3>Value</h3>

<p>count of selections (or deselections if <code>deselections = TRUE</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bars)
paste0(bars[1, -c(1:4)], collapse = "")
# this attribute was checked 3 times and unchecked 2 times
count.selections(bars[1, -c(1:4)])
count.selections(bars[1, -c(1:4)], deselections = TRUE)
</code></pre>

<hr>
<h2 id='dist.city.block'>Calculate city block distance between two matrices</h2><span id='topic+dist.city.block'></span>

<h3>Description</h3>

<p>Calculates the city block distance between two matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist.city.block(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist.city.block_+3A_x">x</code></td>
<td>
<p>first matrix</p>
</td></tr>
<tr><td><code id="dist.city.block_+3A_y">y</code></td>
<td>
<p>second matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cbdist city block distance between <code>x</code> and <code>y</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- matrix(0, nrow = 5, ncol = 7)
  y &lt;- matrix(1, nrow = 5, ncol = 7)
  dist.city.block(x, y)

  y &lt;- matrix(c(rep(0, 15), rep(1, 20)), nrow = 5, ncol = 7)
  dist.city.block(x, y)
</code></pre>

<hr>
<h2 id='draw.hcross'>Draw h-cross, range box, and box to enclose h-box</h2><span id='topic+draw.hcross'></span>

<h3>Description</h3>

<p>Draw h-cross, range box, and box to enclose h-cross, described
by Castura, Rutledge, Ross &amp; Næs (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.hcross(rangebox = NULL, hcross = NULL,
rbox.col = "black", rbox.lty = "dotted", rbox.lwd = 4.5,
hbox.col = "lightgrey", hbox.lty = "solid", hbox.lwd = 4.5,
hcross.col = "black",hcross.lty = "solid",
hcross.signif.lwd = 7, hcross.nsd.lwd = 3.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.hcross_+3A_rangebox">rangebox</code></td>
<td>
<p>matrix where columns 1 and 2 are x and y dimensions and
rows 1 and 2 are the minimum and maximum values</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_hcross">hcross</code></td>
<td>
<p>matrix where columns 1 and 2 are x and y dimensions and
rows 1 and 2 are the half-width of the confidence interval, which is often
95% thus approximately 2x the standard error</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_rbox.col">rbox.col</code></td>
<td>
<p>line color for the range box (default: <code>"black"</code>)</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_rbox.lty">rbox.lty</code></td>
<td>
<p>line type for the range box (default: <code>"dotted"</code>)</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_rbox.lwd">rbox.lwd</code></td>
<td>
<p>line width for the range box (default: <code>4.5</code>)</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_hbox.col">hbox.col</code></td>
<td>
<p>line color for the box enclosing the h-cross
(default: <code>"lightgrey"</code>)</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_hbox.lty">hbox.lty</code></td>
<td>
<p>line type for the box enclosing the h-cross
(default: <code>"dotted"</code>)</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_hbox.lwd">hbox.lwd</code></td>
<td>
<p>line width for the box enclosing the h-cross
(default: <code>4.5</code>)</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_hcross.col">hcross.col</code></td>
<td>
<p>line color for the h-cross (default: <code>"solid"</code>)</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_hcross.lty">hcross.lty</code></td>
<td>
<p>line type for the h-cross (default: <code>"solid"</code>)</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_hcross.signif.lwd">hcross.signif.lwd</code></td>
<td>
<p>line width for the h-cross where there is a
significant difference (default: <code>7</code>)</p>
</td></tr>
<tr><td><code id="draw.hcross_+3A_hcross.nsd.lwd">hcross.nsd.lwd</code></td>
<td>
<p>line width for the h-cross where there is a
significant difference (default: <code>3.5</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Draw h-cross, range box, and box to enclose h-box.
</p>


<h3>References</h3>

<p>Castura, J.C., Rutledge, D.N., Ross, C.F., &amp; Næs, T. (2022). Discriminability and uncertainty in principal component analysis (PCA) of temporal check-all-that-apply (TCATA) data. <em>Food Quality and Preference</em>, 96, 104370. <a href="https://doi.org/10.1016/j.foodqual.2021.104370">doi:10.1016/j.foodqual.2021.104370</a>
</p>

<hr>
<h2 id='fill.gaps'>Fills gaps</h2><span id='topic+fill.gaps'></span>

<h3>Description</h3>

<p>Replace gaps in TDS and TCATA data with replacement responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill.gaps(y, subst = 0, repl = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fill.gaps_+3A_y">y</code></td>
<td>
<p>vector (or data frame) of Bernoulli data which may contain gaps</p>
</td></tr>
<tr><td><code id="fill.gaps_+3A_subst">subst</code></td>
<td>
<p>value occurring in a gap (which represents real data outside a gap). Default is <code>0</code>.</p>
</td></tr>
<tr><td><code id="fill.gaps_+3A_repl">repl</code></td>
<td>
<p>value occurring for a response (used to replace gap values). Default is <code>1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>out vector (or data frame) of Bernoulli data with filled gaps
</p>


<h3>Examples</h3>

<pre><code class='language-R'># vector with gaps: x with NA gaps (e.g. due to attribute cuing)
(x &lt;- rep(c(rep(NA, 4), rep(1, 4)), 2))
fill.gaps(x, subst = NA)

# array with gaps: y with an gap of 0s (e.g. due to attribute fading)
(y &lt;- structure(c(0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0,
                  1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0),
                .Dim = c(3L, 10L),
                .Dimnames = list(1:3, 1:10)))
fill.gaps(y)
</code></pre>

<hr>
<h2 id='get.chance'>TDS chance proportion</h2><span id='topic+get.chance'></span>

<h3>Description</h3>

<p>Obtains the TDS chance proportion based on the number of attributes, as proposed by Pineau et al. (2009; Eq. 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.chance(attributes = c(), include.stop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.chance_+3A_attributes">attributes</code></td>
<td>
<p>number of attributes used in the TDS ballot.</p>
</td></tr>
<tr><td><code id="get.chance_+3A_include.stop">include.stop</code></td>
<td>
<p>defaut is <code>FALSE</code>. Default should be kept if time standardization is applied. Optionally, set to <code>TRUE</code> if analyzing data on the raw timeline.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pineau, N., Schlich, P., Cordelle, S., Mathonnière, C., Issanchou, S., Imbert, A., Rogeaux, M., Etiévant, P., &amp; Köster, E. (2009). Temporal dominance of sensations: Construction of the TDS curves and comparison with time–intensity.  <em>Food Quality and Preference</em>, 20, 450–455. <a href="https://doi.org/10.1016/j.foodqual.2009.04.005">doi:10.1016/j.foodqual.2009.04.005</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using 'bars' data set
attributes &lt;- unique(bars$attribute)
chance &lt;- get.chance(attributes)
chance
</code></pre>

<hr>
<h2 id='get.decluttered'>Get decluttering matrix indicating where to show/hide reference lines</h2><span id='topic+get.decluttered'></span>

<h3>Description</h3>

<p>Declutter TCATA curves by hiding reference lines from plots showing TCATA curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.decluttered(x = x, n.x = n.x, y = y, n.y = n.y, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.decluttered_+3A_x">x</code></td>
<td>
<p>selections for sample of interest (can be a vector if several samples of interest)</p>
</td></tr>
<tr><td><code id="get.decluttered_+3A_n.x">n.x</code></td>
<td>
<p>evaluations of <code>x</code> (can be a vector if several samples of interest)</p>
</td></tr>
<tr><td><code id="get.decluttered_+3A_y">y</code></td>
<td>
<p>selections for comparison (can be a vector if several comparisons will be made)</p>
</td></tr>
<tr><td><code id="get.decluttered_+3A_n.y">n.y</code></td>
<td>
<p>evaluations of <code>y</code> (can be a vector if several comparisons of interest)</p>
</td></tr>
<tr><td><code id="get.decluttered_+3A_alpha">alpha</code></td>
<td>
<p>significance level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>declutter vector in which <code>1</code> indicates &quot;show&quot; and <code>NA</code> indicates &quot;hide&quot;
</p>


<h3>References</h3>

<p>Castura, J.C., Antúnez, L., Giménez, A., Ares, G. (2016). Temporal check-all-that-apply (TCATA): A novel temporal sensory method for characterizing products. <em>Food Quality and Preference</em>, 47, 79-90. <a href="https://doi.org/10.1016/j.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+fisher.test">fisher.test</a></code>, <code><a href="#topic+citation.counts">citation.counts</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# functionality of get.decluttered() is conveniently provided in citation.counts()

# Data set: ojtcata
# Get declutter matrix for comparison of Product 2 vs. average of all products
data(ojtcata)
oj2.v.all &lt;- citation.counts(ojtcata, product.name = "2", product.col = 2,
       attribute.col = 4, results.col = 5:25, comparison = "average")
oj2.v.all$declutter

# same as

p2.declutter &lt;- get.decluttered(x = c(oj2.v.all$P1), n.x = oj2.v.all$Pn,
                                y = c(oj2.v.all$C1), n.y = oj2.v.all$Cn)
(p2.declutter &lt;- matrix(p2.declutter, nrow = nrow(oj2.v.all$P1)))
</code></pre>

<hr>
<h2 id='get.differences'>Get vector of difference in dominance rates</h2><span id='topic+get.differences'></span>

<h3>Description</h3>

<p>Get vector of difference in dominance rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.differences(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.differences_+3A_x">x</code></td>
<td>
<p>matrix of dominance indicators for a single product<code>x</code>attribute (rows = evaluations, columns = times)</p>
</td></tr>
<tr><td><code id="get.differences_+3A_y">y</code></td>
<td>
<p>matrix of dominance indicators for a different product (same attribute)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>out vector of differences in dominance rates
</p>


<h3>References</h3>

<p>Pineau, N., Schlich, P., Cordelle, S., Mathonnière, C., Issanchou, S., Imbert, A., Rogeaux, M., Etiévant, P., &amp; Köster, E. (2009). Temporal dominance of sensations: Construction of the TDS curves and comparison with time–intensity.  <em>Food Quality and Preference</em>, 20, 450–455. <a href="https://doi.org/10.1016/j.foodqual.2009.04.005">doi:10.1016/j.foodqual.2009.04.005</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using 'bars' data set
bars.m &lt;- aggregate(bars[, -c(1:4)], list(sample = bars$sample, attribute = bars$attribute), mean)
bars.m &lt;- bars.m[order(bars.m$sample, bars.m$attribute), ]
attributes &lt;- bars.m$attribute[bars.m$sample == 1]
times &lt;- get.times(colnames(bars.m)[-c(1:2)])
bar1 &lt;- bars.m[bars.m$sample == 1 &amp; bars.m$attribute == "Caramelized Flavour", -c(1:2)]
bar2 &lt;- bars.m[bars.m$sample == 2 &amp; bars.m$attribute == "Caramelized Flavour", -c(1:2)]
b.diff &lt;- get.differences(bar1, bar2)
round(b.diff, 3)

# toy example
x &lt;- data.frame(t10 = c( NA,  0,  0,  0,  1,  1,  0,  0,  1,  0, NA),
                t15 = c(  1,  0,  0,  1,  1,  1,  0,  1,  0,  1,  0),
                t20 = c(  1,  1,  1,  1,  1,  1,  1,  0,  1, NA,  0))
y &lt;- data.frame(t10 = c( NA, NA,  0,  0,  1,  1,  0,  0,  0,  0, NA),
                t15 = c(  0,  0,  0,  0,  1,  0,  1,  1,  0,  1,  1),
                t20 = c(  1,  0,  1,  1,  0,  0,  1, NA,  1, NA,  0))
get.differences(x, y)
</code></pre>

<hr>
<h2 id='get.dominance.rates'>Get TDS dominance rates</h2><span id='topic+get.dominance.rates'></span>

<h3>Description</h3>

<p>Get TDS dominance rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.dominance.rates(citations, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.dominance.rates_+3A_citations">citations</code></td>
<td>
<p>matrix of dominance counts</p>
</td></tr>
<tr><td><code id="get.dominance.rates_+3A_n">n</code></td>
<td>
<p>number of observations (evaluations) per cell</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pineau, N., Schlich, P., Cordelle, S., Mathonnière, C., Issanchou, S., Imbert, A., Rogeaux, M., Etiévant, P., &amp; Köster, E. (2009). Temporal dominance of sensations: Construction of the TDS curves and comparison with time–intensity.  <em>Food Quality and Preference</em>, 20, 450–455. <a href="https://doi.org/10.1016/j.foodqual.2009.04.005">doi:10.1016/j.foodqual.2009.04.005</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rbind(c( 6,  6,  8, 14, 16, 22, 22, 21, 13, 11, 14,  7,  7,  6,  5,  3),
           c(14, 24, 31, 36, 37, 39, 44, 48, 51, 55, 48, 40, 30, 20, 10,  5),
           c( 7,  8,  9, 15, 17, 21, 21, 20, 21, 22, 18, 17, 17, 20, 20, 20),
           c(44, 23, 23, 26,  1,  2,  2,  2,  2,  3,  4,  7, 15, 14, 18, 22),
           c(20, 30, 20,  0, 20,  7,  2,  0,  4,  0,  7, 20, 22, 31, 38, 41))
colnames(x) &lt;- 0:15
get.dominance.rates(x, n = 91)
</code></pre>

<hr>
<h2 id='get.mat.diff.sign'>Pairwise comparisons</h2><span id='topic+get.mat.diff.sign'></span>

<h3>Description</h3>

<p>p-value for pairwise comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.mat.diff.sign(x = x, y = y, n.x = n.x, n.y = n.x, test.type = "f")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.mat.diff.sign_+3A_x">x</code></td>
<td>
<p>citations for product x</p>
</td></tr>
<tr><td><code id="get.mat.diff.sign_+3A_y">y</code></td>
<td>
<p>citations for product y</p>
</td></tr>
<tr><td><code id="get.mat.diff.sign_+3A_n.x">n.x</code></td>
<td>
<p>total observations for x</p>
</td></tr>
<tr><td><code id="get.mat.diff.sign_+3A_n.y">n.y</code></td>
<td>
<p>total observations for y</p>
</td></tr>
<tr><td><code id="get.mat.diff.sign_+3A_test.type">test.type</code></td>
<td>
<p>So far only Fisher's exact test is implemented (<code>"f"</code>)</p>
</td></tr>
</table>


<h3>References</h3>

<p>Castura, J.C., Antúnez, L., Giménez, A., Ares, G. (2016). Temporal check-all-that-apply (TCATA): A novel temporal sensory method for characterizing products. <em>Food Quality and Preference</em>, 47, 79-90. <a href="https://doi.org/10.1016/j.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+fisher.test">fisher.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Toy TCATA citations data for two samples: s1, s2
s1 &lt;- t(data.frame(sweet =  c(10, 23, 25, 26, 26, 43, 44),
                   bitter = c( 4, 18, 19, 27, 36, 43, 54),
                   sour = c(40, 53, 85, 70, 46, 33, 24)))
s2 &lt;- t(data.frame(sweet = c(11, 33, 45, 46, 56, 43, 44),
                   bitter = c( 0, 11, 11, 14, 25, 35, 34),
                   sour = c(30, 33, 35, 20, 26, 23, 24)))
colnames(s1) &lt;- colnames(s2) &lt;- paste0("time_", seq(5, 35, by = 5), "s")
n &lt;- 90
signif &lt;- get.mat.diff.sign(s1, s2, n, n)
signif
</code></pre>

<hr>
<h2 id='get.significance'>TDS significance proportion</h2><span id='topic+get.significance'></span>

<h3>Description</h3>

<p>Obtains the TDS significance proportion based on the number of observations and chance, as proposed by Pineau et al. (2009; Eq. 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.significance(chance, n, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.significance_+3A_chance">chance</code></td>
<td>
<p>chance proportion; see <code><a href="#topic+get.chance">get.chance</a></code>.</p>
</td></tr>
<tr><td><code id="get.significance_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="get.significance_+3A_alpha">alpha</code></td>
<td>
<p>significance level for binomial test of 2 independent proportions (based on normal approximation; see: Pineau et al., 2009, Eq. 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TDS significance level proposed by Pineau et al. (2009, Eq. 1) provides a simple and widely used heuristic approach for contextualizing observed dominance rates, but should not be used for statistical inference.
</p>


<h3>References</h3>

<p>Pineau, N., Schlich, P., Cordelle, S., Mathonnière, C., Issanchou, S., Imbert, A., Rogeaux, M., Etiévant, P., &amp; Köster, E. (2009). Temporal dominance of sensations: Construction of the TDS curves and comparison with time–intensity.  <em>Food Quality and Preference</em>, 20, 450–455. <a href="https://doi.org/10.1016/j.foodqual.2009.04.005">doi:10.1016/j.foodqual.2009.04.005</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using 'bars' data set
attributes &lt;- unique(bars$attribute)
chance &lt;- get.chance(attributes)
signif &lt;- get.significance(chance, nrow(unique(bars[, 1:2])))
signif
</code></pre>

<hr>
<h2 id='get.significance.diff'>Get least significant differences for pairwise comparisons</h2><span id='topic+get.significance.diff'></span>

<h3>Description</h3>

<p>Get least significant differences for pairwise comparisons (see Pineau et al., 2009, Eq. 2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.significance.diff(x, y, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.significance.diff_+3A_x">x</code></td>
<td>
<p>matrix of dominance data (<code>0</code>/<code>1</code>) related to one entity</p>
</td></tr>
<tr><td><code id="get.significance.diff_+3A_y">y</code></td>
<td>
<p>matrix of dominance data (<code>0</code>/<code>1</code>) related to another entity</p>
</td></tr>
<tr><td><code id="get.significance.diff_+3A_alpha">alpha</code></td>
<td>
<p>significance for one-sided test (default <code>0.05</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculation of least significant differences for TDS difference curves based on Pineau et al. (2009, Eq. 2). The absolute value of the observed dominance rate for a give attribute*time must exceed the corresponding least significant difference calculated here to be considered significant.
</p>


<h3>Value</h3>

<p>out least significant difference (at level <code>alpha</code>) for dominance differences in matrix
</p>


<h3>References</h3>

<p>Pineau, N., Schlich, P., Cordelle, S., Mathonnière, C., Issanchou, S., Imbert, A., Rogeaux, M., Etiévant, P., &amp; Köster, E. (2009). Temporal dominance of sensations: Construction of the TDS curves and comparison with time–intensity.  <em>Food Quality and Preference</em>, 20, 450–455. <a href="https://doi.org/10.1016/j.foodqual.2009.04.005">doi:10.1016/j.foodqual.2009.04.005</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># toy data example
x &lt;- data.frame(t10 = c(rep(NA, 15), rep(0, 50), rep(1, 20)),
                t15 = c(rep(NA,  4), rep(0, 61), rep(1, 20)),
                t20 = c(rep(0, 55), rep(1, 30)))
y &lt;- data.frame(t10 = c(rep(NA, 15), rep(0, 50), rep(1, 20)),
                t15 = c(rep(NA,  0), rep(0, 21), rep(1, 64)),
                t20 = c( rep(0, 35), rep(1, 50)))
signif.xy &lt;- get.significance.diff(x, y)
#compare with observed differences
diff.xy &lt;- get.differences(x, y)
abs(diff.xy) &gt; signif.xy

# real data example - differences between Bar 1 and Bar 2 on the attribute "Grain Flavour"
attributes &lt;- unique(bars$attribute)
times &lt;- get.times(colnames(bars)[-c(1:4)])
bar1 &lt;- bars[bars$sample == 1 &amp; bars$attribute == "Grain Flavour", -c(1:4)]
bar2 &lt;- bars[bars$sample == 2 &amp; bars$attribute == "Grain Flavour", -c(1:4)]
signif.1vs2 &lt;- get.significance.diff(bar1, bar2)
# review observed difference in dominance rates vs. least significant differences
diff.1vs2 &lt;- get.differences(bar1, bar2)
abs(diff.1vs2) &gt; signif.1vs2
# differences between samples start at 1.1s and occur throughout the 45.0 evaluation period
</code></pre>

<hr>
<h2 id='get.smooth'>Convenience function for curve smoothing</h2><span id='topic+get.smooth'></span>

<h3>Description</h3>

<p>Smooth TCATA curves, constraining smooth within <code>low.bound</code> and <code>up.bound</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.smooth(y, w = NULL, spar = 0.5, low.bound = 0, up.bound = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.smooth_+3A_y">y</code></td>
<td>
<p>the vector of proportions (or counts) to be smoothed. If a data frame is provided then smoothing is conducted on each row.</p>
</td></tr>
<tr><td><code id="get.smooth_+3A_w">w</code></td>
<td>
<p>an optional vector of weights; see <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code></p>
</td></tr>
<tr><td><code id="get.smooth_+3A_spar">spar</code></td>
<td>
<p>smoothing parameter; see <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code></p>
</td></tr>
<tr><td><code id="get.smooth_+3A_low.bound">low.bound</code></td>
<td>
<p>lower bound for smoothed proportions</p>
</td></tr>
<tr><td><code id="get.smooth_+3A_up.bound">up.bound</code></td>
<td>
<p>upper bound for smoothed proportions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>out smoothed vector (or data frame with smoothed rows)
</p>


<h3>References</h3>

<p>Castura, J.C., Antúnez, L., Giménez, A., Ares, G. (2016). Temporal check-all-that-apply (TCATA): A novel temporal sensory method for characterizing products. <em>Food Quality and Preference</em>, 47, 79-90. <a href="https://doi.org/10.1016/j.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, <code><a href="stats.html#topic+predict">predict</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using 'syrah' data set
low1 &lt;- t(syrah[seq(3, 1026, by = 6), -c(1:4)])
colnames(low1) &lt;- 10:180
x &lt;- get.smooth(low1)
round(x, 3)
</code></pre>

<hr>
<h2 id='get.times'>Get times</h2><span id='topic+get.times'></span>

<h3>Description</h3>

<p>Convenience function to convert exported time labels, e.g. from character format c('time_0.1s', 'time_0.2s', ...) or related format to numeric format c(0.1, 0.2, ...).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.times(time.char, trim.left = "time_", trim.right = "s")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.times_+3A_time.char">time.char</code></td>
<td>
<p>vector of characters containing the time</p>
</td></tr>
<tr><td><code id="get.times_+3A_trim.left">trim.left</code></td>
<td>
<p>string to be trimmed from left</p>
</td></tr>
<tr><td><code id="get.times_+3A_trim.right">trim.right</code></td>
<td>
<p>string to be trimmed from right</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Convenience function for getting times from column headers from common data export formats.
</p>


<h3>Value</h3>

<p>times vector of times in numeric format
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get.times(colnames(bars)[-c(1:4)])

(sample.colnames &lt;- paste0("X", 0:30))
get.times(sample.colnames, trim.left = "X", trim.right = "")
</code></pre>

<hr>
<h2 id='lengthwhichis.na'>Count observations with missing data</h2><span id='topic+lengthwhichis.na'></span>

<h3>Description</h3>

<p>Count observations with missing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lengthwhichis.na(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lengthwhichis.na_+3A_x">x</code></td>
<td>
<p>vector data which may contain missings</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>count</code> of observations where data are missing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(rep(NA,18), rep(1,18), rep(0,10), rep(NA, 10))
lengthwhichis.na(x)
</code></pre>

<hr>
<h2 id='make.palettes'>Convenience function for getting a pretty palette and highlight colours</h2><span id='topic+make.palettes'></span>

<h3>Description</h3>

<p>Make a vector of n pretty colours, and n matching highlight colours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.palettes(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.palettes_+3A_n">n</code></td>
<td>
<p>number of colours for each palette</p>
</td></tr>
</table>


<h3>Value</h3>

<p>pal A character vector, <code>cv</code>, of colours that look pretty.
</p>
<p>pal.light A character vector, <code>cv</code>, of matching highlight colours that look pretty.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>make.palettes(8)
</code></pre>

<hr>
<h2 id='plot_pca.trajectories'>Plot trajectories based on Temporal Check-All-That-Apply (TCATA) data</h2><span id='topic+plot_pca.trajectories'></span>

<h3>Description</h3>

<p>Plot trajectories following PCA on multiblock TCATA proportions, or same for Temporal Dominance of Sensations (TDS) proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pca.trajectories(in.pca = in.pca, products.times = matrix(NA),
attributes = c(), type = "smooth", span = 0.75, biplot = "distance",
flip = c(FALSE, FALSE), dims = c(1, 2),
att.offset.x = c(), att.offset.y = c(), att.cex = 1, inflate.factor = NA,
xlab = "_auto_", ylab = "_auto_", xlim = NULL, ylim = NULL,
attributes.col = "red", attributes.pch = 17,
lwd = 1, traj.lab.loc = 0, traj.col = c(grDevices::grey(1/2)), traj.points = NA,
traj.col.seg = NA, traj.cex = 1, traj.lab = c(), traj.lab.cex = 1,
arrow.loc = NA, arrow.length = 0.1, arrow.col = NA, arrow.lwd = NA,
contrails = list(), main = "", save.format = "eps", save.as = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_pca.trajectories_+3A_in.pca">in.pca</code></td>
<td>
<p>Any <code>list</code> object with components <code>sdev</code>, <code>rotation</code>, and <code>x</code>. Most often it is a <code>prcomp</code> object obtained from PCA on a matrix of proportions (or, if there is no missing data, on counts) with Product*Times in rows and Attributes in columns.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_products.times">products.times</code></td>
<td>
<p>a 2-column matrix, with an ascending sort order on products (column 1) and a secondary ascending sort on times (column 2), corresponding to the rows of the matrix submitted to prcomp to obtain <code>"in.pca"</code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_attributes">attributes</code></td>
<td>
<p>a vector of attribute labels, corresponding to the attributes of the matrix submitted to prcomp to obtain <code>"in.pca"</code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_type">type</code></td>
<td>
<p>Determines how trajectories are drawn. Possible values are <code>"smooth"</code> (default) or <code>"raw"</code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_span">span</code></td>
<td>
<p>A tuning parameter used if smoothing trajectories using the <code>loess</code> function.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_biplot">biplot</code></td>
<td>
<p>Controls the type of biplot displayed. Possible values are <code>"distance"</code> (plots trajectories based on scores, and attributes based on eigenvectors multiplied by the <code>"inflation.factor"</code>), or <code>"correlation"</code> (plots trajectories based on scores divided by the sqrt of their respective eigenvalues, and attributes based on eigenvectors multiplied by the sqrt of their respective eigenvalues).</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_flip">flip</code></td>
<td>
<p>a vector of two logical values. Value indicates whether to mirror the coordinates in the x and y dimensions respectively. Default is <code>c(FALSE, FALSE)</code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_dims">dims</code></td>
<td>
<p>a vector of two integers, specifying the principal componts to display. Defaults is <code>"c(1, 2)"</code>, i.e. PC1 vs. PC2.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_att.offset.x">att.offset.x</code></td>
<td>
<p>A vector of numeric values corresponding to the labels in <code>"attributes"</code>. Used to adjust the horizontal position of attribute labels to make the plot more readable.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_att.offset.y">att.offset.y</code></td>
<td>
<p>A vector of numeric values corresponding to the labels in <code>"attributes"</code>. Used to adjust the vertical position of attribute labels to make the plot more readable.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_att.cex">att.cex</code></td>
<td>
<p>Attribute text size.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_inflate.factor">inflate.factor</code></td>
<td>
<p>Scalar controlling the position of attribute labels. If <code>"NA"</code> (default), then this scalar is set to the largest absolute score divided by the largest absolute eigenvector based on the dimensions used. Use <code>"1"</code> for no inflation. Applies only when <code>biplot = "distance"</code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_xlab">xlab</code></td>
<td>
<p>Label for x axis.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_ylab">ylab</code></td>
<td>
<p>Label for y axis.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_xlim">xlim</code></td>
<td>
<p>Permits control of the x limit. Limits can be specified using a vector of 2 (ascending) numbers. If a single number is provided then values are selected such that the limits are 20% beyond the smallest and largest x coordinates, respectively. If unspecified then control over x axis limits is given to the plot function in R.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_ylim">ylim</code></td>
<td>
<p>Permits control of the x limit using the same logic as is used for <code>"xlim"</code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_attributes.col">attributes.col</code></td>
<td>
<p>Color used to display attribute labels (see <code>"attributes"</code>).</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_attributes.pch">attributes.pch</code></td>
<td>
<p>Symbol for attribute coordinates.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_lwd">lwd</code></td>
<td>
<p>Trajectory line width.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_traj.lab.loc">traj.lab.loc</code></td>
<td>
<p>Indicates where along the trajectory the trajectory label will be positioned. <code>"1"</code> indicates the start of the trajectory. The value <code>"0"</code> (default) is a special convention indicating the end of the trajectory.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_traj.col">traj.col</code></td>
<td>
<p>A vector of colors for trajectories. If not specified then all trajectories are shown in grey.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_traj.points">traj.points</code></td>
<td>
<p>Specifies the position of markers along smoothed trajectories, and used to indicate the progression of time.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_traj.col.seg">traj.col.seg</code></td>
<td>
<p>A vector of colors for segments along trajectories. If <code>NA</code> (default) then no segments along the trajectories appear in a color other than those specified by <code>"traj.col"</code>. This parameter applies to smoothed trajectories only.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_traj.cex">traj.cex</code></td>
<td>
<p>Used with <code>"traj.points"</code> for smoothed trajectories. Controls the size of symbol displayed.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_traj.lab">traj.lab</code></td>
<td>
<p>A vector of character labels that identify the trajectories. If unspecified, then products are identified by ascending natural numbers.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_traj.lab.cex">traj.lab.cex</code></td>
<td>
<p>Text size of <code>traj.lab</code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_arrow.loc">arrow.loc</code></td>
<td>
<p>Trajectory arrows locations for direction marker(s).</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_arrow.length">arrow.length</code></td>
<td>
<p>Trajectory arrows length. See <code>length</code> parameter in <code><a href="graphics.html#topic+arrows">arrows</a></code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_arrow.col">arrow.col</code></td>
<td>
<p>Trajectory arrows color. See <code>col</code> parameter in <code><a href="graphics.html#topic+arrows">arrows</a></code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_arrow.lwd">arrow.lwd</code></td>
<td>
<p>Trajectory arrows line width. See <code>lwd</code> parameter in <code><a href="graphics.html#topic+arrows">arrows</a></code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_contrails">contrails</code></td>
<td>
<p>list of data.frame objects with columns x, y, count, col; x and y are coordinates, count is the number of values at the coordinate, and col is the rbg colour.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_main">main</code></td>
<td>
<p>plot title; see <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_save.format">save.format</code></td>
<td>
<p>If indicated, this will be the file type for the save image. Defaults to <code>"eps"</code> (eps format). Other possible values are <code>""</code> (not saved) or <code>"png"</code> (png format).</p>
</td></tr>
<tr><td><code id="plot_pca.trajectories_+3A_save.as">save.as</code></td>
<td>
<p>The filename. Must be provided if the file will be saved.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Castura, J.C., Antúnez, L., Giménez, A., Ares, G. (2016). Temporal check-all-that-apply (TCATA): A novel temporal sensory method for characterizing products. <em>Food Quality and Preference</em>, 47, 79-90. <a href="https://doi.org/10.1016/j.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>
</p>
<p>Castura, J.C., Baker, A.K., &amp; Ross, C.F. (2016). Using contrails and animated sequences to visualize uncertainty in dynamic sensory profiles obtained from temporal check-all-that-apply (TCATA) data. <em>Food Quality and Preference</em>, 54, 90-100. <a href="https://doi.org/10.1016/j.foodqual.2016.06.011">doi:10.1016/j.foodqual.2016.06.011</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+prcomp">prcomp</a></code>, <code><a href="graphics.html#topic+par">par</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using 'syrah' data set
syrah.pca &lt;- prcomp(syrah[1:248, -c(1:4)], scale. = FALSE)
plot_pca.trajectories(syrah.pca, products.times = syrah[1:248, c(1, 4)],
                      attributes = colnames(syrah)[-c(1:4)], type = "raw")

# now with smoothing; may need to play with the span parameter to get appropriate smoothing
plot_pca.trajectories(syrah.pca, products.times = syrah[1:248, c(1, 4)],
                      attributes = colnames(syrah)[-c(1:4)], type = "smooth", span = 0.3)

# plots at each time point (trajectories join 2 points so start at timepoint 2, i.e., 11 s)
x &lt;- 11:14 # for brevity show only the first 4 timeslices
# x &lt;- 11:41 # uncomment this line to to run a longer demo
pca.list &lt;- list()
for(i in seq_along(x)){
  pca.list[[x[i]-10]] &lt;- syrah.pca
  pca.list[[x[i]-10]]$x &lt;- pca.list[[x[i]-10]]$x[1:((x[i]-9)*6), ]
  plot_pca.trajectories(pca.list[[x[i]-10]], products.times = syrah[1:((x[i]-9)*6), c(1, 4)],
                        attributes = colnames(syrah)[-c(1:4)], type = "raw", inflate.factor = 1.5)
  Sys.sleep(3/4)
  # save plot if saving stills for a video; see Castura, Baker, &amp; Ross (2016, Video 1)
}

</code></pre>

<hr>
<h2 id='pretty_palette'>Get a pretty palette of colours</h2><span id='topic+pretty_palette'></span>

<h3>Description</h3>

<p>Create a vector of n pretty colours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pretty_palette(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pretty_palette_+3A_n">n</code></td>
<td>
<p>number of colours in the palette</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cv A character vector, <code>cv</code>, of colours that look pretty.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pretty_palette(8)
</code></pre>

<hr>
<h2 id='similarity.tcata.repeatability'>Quantify TCATA assessor repeatability</h2><span id='topic+similarity.tcata.repeatability'></span>

<h3>Description</h3>

<p>Quantify TCATA assessor repeatability using city block distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>similarity.tcata.repeatability(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="similarity.tcata.repeatability_+3A_x">X</code></td>
<td>
<p>list of matrices, where each matrix is a TCATA data (given as an indicator matrix) for assessor of interest for one rep</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similarity between repeated evaluations given by a TCATA assessor is quantified. The repeatability index can take on values between <code>0</code> and <code>1</code>, which indicate complete dissimilarity (non-repeatability) and complete similarity (repeatability), respectively.
</p>


<h3>Value</h3>

<p>repeatability.index average city block distance between matrices from replicated evaluations
</p>


<h3>References</h3>

<p>Castura, J.C., Antúnez, L., Giménez, A., Ares, G. (2016). Temporal check-all-that-apply (TCATA): A novel temporal sensory method for characterizing products. <em>Food Quality and Preference</em>, 47, 79-90. <a href="https://doi.org/10.1016/j.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Toy data from one TCATA assessor on a product over three sessions: rep1, rep2, rep3
  rep1 &lt;- rbind(rep(0, 7),
                rep(0, 7),
                c(0, 0, 0, 1, 1, 1, 1),
                c(0, 0, 0, 1, 1, 1, 1),
                c(0, 0, 0, 1, 1, 1, 0))
  rep2 &lt;- rbind(c(0, 0, 0, 1, 1, 1, 0),
                rep(0, 7),
                c(0, 1, 1, 1, 1, 1, 0),
                rep(1, 7),
                c(0, 0, 0, 1, 1, 1, 1))
  rep3 &lt;- rbind(rep(0, 7),
                rep(0, 7),
                rep(1, 7),
                rep(1, 7),
                rep(1, 7))
  rep.data &lt;- list(rep1, rep2, rep3)

  # Quantify similarity of assessor a1 to the other assessors
  similarity.tcata.repeatability(rep.data)
</code></pre>

<hr>
<h2 id='similarity.tcata.replication'>Quantify TCATA assessor replication</h2><span id='topic+similarity.tcata.replication'></span>

<h3>Description</h3>

<p>Quantify TCATA assessor replication using city block distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>similarity.tcata.replication(this.assessor, other.assessors)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="similarity.tcata.replication_+3A_this.assessor">this.assessor</code></td>
<td>
<p>TCATA data (given as an indicator matrix) for assessor of interest</p>
</td></tr>
<tr><td><code id="similarity.tcata.replication_+3A_other.assessors">other.assessors</code></td>
<td>
<p>TCATA data (given as an indicator matrix) for other assessors</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similarity between one TCATA assessor and other assessors on the panel is quantified. The replication index can take on values between <code>0</code> and <code>1</code>, which indicate complete dissimilarity (disagreement) and complete similarity (agreement), respectively.
</p>


<h3>Value</h3>

<p>replication.index city block distance between this assessor and other assessors
</p>


<h3>References</h3>

<p>Castura, J.C., Antúnez, L., Giménez, A., Ares, G. (2016). Temporal check-all-that-apply (TCATA): A novel temporal sensory method for characterizing products. <em>Food Quality and Preference</em>, 47, 79-90. <a href="https://doi.org/10.1016/j.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Toy TCATA data for three assessors: a1, a2, a3
  a1 &lt;- rbind(rep(0, 7),
              rep(0, 7),
              c(0, 0, 0, 1, 1, 1, 1),
              c(0, 0, 0, 1, 1, 1, 1),
              c(0, 0, 0, 1, 1, 1, 0))
  a2 &lt;- rbind(c(0, 0, 0, 1, 1, 1, 0),
              rep(0, 7),
              c(0, 1, 1, 1, 1, 1, 0),
              rep(1, 7),
              c(0, 0, 0, 1, 1, 1, 1))
  a3 &lt;- rbind(rep(0, 7),
              rep(0, 7),
              rep(1, 7),
              rep(1, 7),
              rep(1, 7))

  # Quantify similarity of assessor a1 to the other assessors
  similarity.tcata.replication(a1, rbind(a2, a3))
</code></pre>

<hr>
<h2 id='std.time'>Time standardize results</h2><span id='topic+std.time'></span>

<h3>Description</h3>

<p>Set results for a temporal evaluation to a timescale by trimming off time prior to the first onset and following the last offset time, and express the remaining times in terms of percentiles [0, 100].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>std.time(X, trim.left = TRUE, trim.right = TRUE, scale = TRUE, missing = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="std.time_+3A_x">X</code></td>
<td>
<p>vector (or data frame) of indicator data.</p>
</td></tr>
<tr><td><code id="std.time_+3A_trim.left">trim.left</code></td>
<td>
<p>Trim on the left? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="std.time_+3A_trim.right">trim.right</code></td>
<td>
<p>Trim on the right? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="std.time_+3A_scale">scale</code></td>
<td>
<p>Set to a [0, 1] scale? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="std.time_+3A_missing">missing</code></td>
<td>
<p>indicator for missing data; default is <code>0</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>out vector (or data frame) of trimmed and/or standardized indicator (<code>0</code>/<code>1</code>) data
</p>


<h3>References</h3>

<p>Castura, J.C. (2019). Investigating temporal sensory data via a graph theoretic approach. <em>Food Quality and Preference</em>, 79, 103787. <a href="https://doi.org/10.1016/j.foodqual.2019.103787">doi:10.1016/j.foodqual.2019.103787</a>
</p>
<p>Lenfant, F., Loret, C., Pineau, N., Hartmann, C., &amp; Martin, N. (2009). Perception of oral food breakdown. The concept of sensory trajectory. <em>Appetite</em>, 52, 659-667.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># vector - toy data example
x &lt;- rep(c(rep(0,18), rep(1,18)), 2)
names(x) &lt;- 1:72
x           # raw time
std.time(x) # standardized time

# data frame - toy data example
y &lt;- data.frame(rbind(c(c(rep(0,18),
                           rep(1,18)),
                           rep(0, 4)),
                           c(rep(c(rep(0,9),
                           rep(1,9)), 2),
                           1, rep(0, 3)),
                           rep(0, 40)))
colnames(y) &lt;- 1:40
y           # raw time
std.time(y) # standardized time

# time standardization using 'bars' data set
# only sample 1 will be done (for illustrative purposes)
eval1 &lt;- unique(bars[bars$sample == 1, (1:3)])
bar1.std &lt;- data.frame(unique(bars[bars$sample == 1, (1:4)]), matrix(0, ncol = 101))

for (e in 1:nrow(eval1)){
  bar1.std[bar1.std$assessor == eval1$assessor[e] &amp;
             bar1.std$session == eval1$session[e] &amp;
             bar1.std$sample == eval1$sample[e],
             -c(1:4)] &lt;- std.time(bars[bars$assessor == eval1$assessor[e] &amp;
                                         bars$session == eval1$session[e] &amp;
                                         bars$sample == eval1$sample[e],
                                           -c(1:4)])
}
colnames(bar1.std)[5:ncol(bar1.std)] &lt;- 0:100
head(bar1.std)
</code></pre>

<hr>
<h2 id='TCATA+20data+20set+3A+20orange+20juice'>TCATA data set: orange juice</h2><span id='topic+ojtcata'></span>

<h3>Description</h3>

<p>Raw results from 20-s TCATA evaluations of six orange juice samples by 50 consumers.</p>


<h3>Format</h3>

<p>A data frame with 1800 rows (50 consumers * 6 samples * 6 attributes) and 25 columns (4 headers + 21 time slices)
</p>

<ul>
<li><p> [, 1] cons (int) consumer id
</p>
</li>
<li><p> [, 2] samp (chr) sample id
</p>
</li>
<li><p> [, 3] samp_pos (int) position of sample in serving order
</p>
</li>
<li><p> [, 4] attribute (chr) sensory attribute
</p>
</li>
<li><p> [, 5:25]  time_<code>99</code>s (int) value is <code>1</code> if attribute is selected at time slice; otherwise value is <code>0</code>
</p>
</li></ul>



<h3>References</h3>

<p>Ares, G., Jaeger, S. R., Antúnez, L., Vidal, L, Giménez, A., Coste, B., Picallo, A., &amp; Castura, J.C. (2016). Comparison of TCATA and TDS for dynamic sensory characterization of food products. <em>Food Research International</em>, 78, 148-158. <a href="https://doi.org/10.1016/j.foodres.2015.10.023">doi:10.1016/j.foodres.2015.10.023</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>head(ojtcata) # review first 6 rows of 'ojtcata' data set
</code></pre>

<hr>
<h2 id='TCATA+20data+20set+3A+20Syrah+20wines'>TCATA data set: Syrah wines</h2><span id='topic+syrah'></span>

<h3>Description</h3>

<p>TCATA citation proportions for three wine treatments evaluated using a two-sip evaluation protocol.
</p>


<h3>Format</h3>

<p>A data frame with 1026 rows (3 treatments * 2 sips * 171 time slices) and 13 columns:
</p>

<ul>
<li><p> [, 1] WineSip (chr) Code for wine and sip
</p>
</li>
<li><p> [, 2] Wine (chr) Code for wine (H=high, L=low, A=adjusted)
</p>
</li>
<li><p> [, 3] Sip (int) Sip number
</p>
</li>
<li><p> [, 4] Time (int) Time, in seconds
</p>
</li>
<li><p> [, 5] Astringency (num) citation proportions
</p>
</li>
<li><p> [, 6] Bitter (num) citation proportions
</p>
</li>
<li><p> [, 7] Dark Fruit (num) citation proportions
</p>
</li>
<li><p> [, 8] Earthy (num) citation proportions
</p>
</li>
<li><p> [, 9] Green (num) citation proportions
</p>
</li>
<li><p> [,10] Heat (num) citation proportions
</p>
</li>
<li><p> [,11] Red Fruit (num) citation proportions
</p>
</li>
<li><p> [,12] Spices (num) citation proportions
</p>
</li>
<li><p> [,13] Sour (num) citation proportions
</p>
</li></ul>



<h3>References</h3>

<p>Baker, A.K., Castura, J.C., &amp; Ross, C.F. (2016). Temporal check-all-that-apply characterization of Syrah wine finish. <em>Journal of Food Science</em>, 81, S1521-S1529. <a href="https://doi.org/10.1111/1750-3841.13328">doi:10.1111/1750-3841.13328</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(syrah, 3) # review first 3 rows of 'syrah' data set
</code></pre>

<hr>
<h2 id='tcata.diff.plot'>TCATA difference plot</h2><span id='topic+tcata.diff.plot'></span>

<h3>Description</h3>

<p>Plots TCATA difference curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tcata.diff.plot(x1 = x1, x2 = NA, n1 = 1, n2 = NA,
attributes = c(), times = c(), lwd = 1,
declutter = NA, get.decluttered = FALSE, emphasis = NA, alpha = 0.05, emphasis.lwd = 3,
main = "", height = 8, width = 12,
xlab = "Time", ylab = "Difference in citation proportion",
axes.font = 1, axes.cex = 1, line.col = c(), x.increment = 5,
legend.cex = 1, legend.font = 1, save.as = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tcata.diff.plot_+3A_x1">x1</code></td>
<td>
<p>matrix of difference proportions, or of counts if <code>n1</code> specified. If <code>mat2</code> specified then proportions or counts apply to first sample. Attributes are in rows, times in columns.</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_x2">x2</code></td>
<td>
<p>matrix of proportions for second sample, or of counts if <code>n2</code> specified.</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_n1">n1</code></td>
<td>
<p>number of observations for first sample</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_n2">n2</code></td>
<td>
<p>number of observations for second sample</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_attributes">attributes</code></td>
<td>
<p>vector of attribute labels for row in <code>x1</code> (and <code>x2</code>)</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_times">times</code></td>
<td>
<p>vector of times for columns in <code>x1</code> (and <code>x2</code>)</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_lwd">lwd</code></td>
<td>
<p>Line width</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_declutter">declutter</code></td>
<td>
<p>indicator matrix with same dimensions of <code>x1</code> to suppress output</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_get.decluttered">get.decluttered</code></td>
<td>
<p>if <code>TRUE</code> then calculates the <code>declutter</code>  matrix from <code>get.mat.diff.sign</code></p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_emphasis">emphasis</code></td>
<td>
<p>set to <code>1</code> to emphasize significant differences</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_alpha">alpha</code></td>
<td>
<p>significance level for entrywise test of <code>x1</code> and <code>x2</code> (if counts)</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_emphasis.lwd">emphasis.lwd</code></td>
<td>
<p>line weight for emphasizing significant differences</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_main">main</code></td>
<td>
<p>plot title; see <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_height">height</code></td>
<td>
<p>plot height</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_width">width</code></td>
<td>
<p>plot width</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_xlab">xlab</code></td>
<td>
<p>label for x axis</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_axes.font">axes.font</code></td>
<td>
<p>Font for axes labels; see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_axes.cex">axes.cex</code></td>
<td>
<p>Size for axes labels.</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_line.col">line.col</code></td>
<td>
<p>line color for attribute lines</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_x.increment">x.increment</code></td>
<td>
<p>increment between time labels on x axis</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_legend.cex">legend.cex</code></td>
<td>
<p>symbol size for legend</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_legend.font">legend.font</code></td>
<td>
<p>Font for the legend; see <code><a href="graphics.html#topic+text">text</a></code>.</p>
</td></tr>
<tr><td><code id="tcata.diff.plot_+3A_save.as">save.as</code></td>
<td>
<p>Filename to use if file will be saved.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Castura, J.C., Antúnez, L., Giménez, A., Ares, G. (2016). Temporal check-all-that-apply (TCATA): A novel temporal sensory method for characterizing products. <em>Food Quality and Preference</em>, 47, 79-90. <a href="https://doi.org/10.1016/j.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># difference between High and Low ethanol wines (sip 1)
x.diff.raw &lt;- t(syrah[seq(1, 1026, by = 6), -c(1:4)]) -
                t(syrah[seq(3, 1026, by = 6), -c(1:4)])
x.diff.smooth &lt;- get.smooth(x.diff.raw, low.bound = -1, up.bound = 1)
colnames(x.diff.smooth) &lt;- colnames(x.diff.raw) &lt;- times &lt;- 10:180
tcata.diff.plot(x1 = x.diff.smooth, attributes = rownames(x.diff.smooth), times = times, lwd = 2,
                main = "Sip 1 differences: High-ethanol wine - Low-ethanol wine")

# an example based on the syrah data set (truncated for efficiency)
n &lt;- 52
H1 &lt;- t(syrah[seq(1, 126, by = 6), -c(1:4)] * n)
L1 &lt;- t(syrah[seq(3, 126, by = 6), -c(1:4)] * n)
colnames(H1) &lt;- colnames(L1) &lt;- times &lt;- 10:30
tcata.diff.plot(x1 = H1, x2 = L1, n1 = n, n2 = n,
                attributes = rownames(H1), get.decluttered = TRUE, lwd = 2)
</code></pre>

<hr>
<h2 id='tcata.line.plot'>Temporal Check-All-That-Apply (TCATA) curve</h2><span id='topic+tcata.line.plot'></span>

<h3>Description</h3>

<p>Plots TCATA curves based on count or proportion data. Can also be used for plotting Temporal Dominance of Sensations (TDS) curves based on dominance counts or proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tcata.line.plot(X, n = 1, attributes = c(), times = c(),
lwd = 1, lty = 1, line.col = c(),
emphasis = NA, emphasis.col = c(), emphasis.lty = 1, emphasis.lwd = 3,
declutter = NA,
reference = NA, ref.col = c(), ref.lty = 2, ref.lwd = 1,
highlight = FALSE, highlight.col = c(), highlight.lty = 1, highlight.lwd = 5,
xlab = "Time", ylab = "Citation proportion", axes.font = 1,
axes.cex = 1, xlim = c(), las = 0,
x.increment = 5, box = FALSE,
legend.cex = 1, legend.font = 1, legend.pos = "topleft", legend.ncol = 2,
height = 8, width = 12, main = "",
save.format = "", save.as = "" )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tcata.line.plot_+3A_x">X</code></td>
<td>
<p>matrix of proportions (or, if there is no missing data, on counts), typically with Attributes in rows and times in columns.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_n">n</code></td>
<td>
<p>The number of observations if <code>X</code> is a count matrix. Keep <code>n = 1</code> if <code>X</code> is a matrix of proportions.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_attributes">attributes</code></td>
<td>
<p>a vector of attribute labels, corresponding to the attributes in <code>X</code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_times">times</code></td>
<td>
<p>a vector of time, corresponding to the times in <code>X</code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_lwd">lwd</code></td>
<td>
<p>line width for attribute curves that matches either <code>attributes</code> or <code>X</code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_lty">lty</code></td>
<td>
<p>line types for attribute curves that matches either <code>attributes</code> or <code>X</code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_line.col">line.col</code></td>
<td>
<p>attribute curves colours that matches <code>attributes</code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_emphasis">emphasis</code></td>
<td>
<p>matrix matching <code>X</code> in its dimensions, with a numeric value corresponding to points requiring emphasis, and <code>NA</code> for points without emphasis.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_emphasis.col">emphasis.col</code></td>
<td>
<p>vector colours for attributes corresponding to rows of <code>X</code>; taken from <code>line.col</code> if not specified.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_emphasis.lty">emphasis.lty</code></td>
<td>
<p>either a line type (<code>lty</code>) for all emphasis lines .</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_emphasis.lwd">emphasis.lwd</code></td>
<td>
<p>line weight associated with the emphasis line.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_declutter">declutter</code></td>
<td>
<p>a matrix with the same dimensions as <code>X</code>; give the value <code>1</code> to show a proportion in <code>X</code> and <code>reference</code> (if given), otherwise give <code>0</code> or <code>NA</code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_reference">reference</code></td>
<td>
<p>a matrix with the same dimensions as <code>X</code>; give the value <code>1</code> if <code>reference</code> will be shown (allowing finer control than <code>declutter</code>), otherwise give <code>0</code> or <code>NA</code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_ref.col">ref.col</code></td>
<td>
<p><code>reference</code> line colour.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_ref.lty">ref.lty</code></td>
<td>
<p><code>reference</code> line type.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_ref.lwd">ref.lwd</code></td>
<td>
<p><code>reference</code> line width.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_highlight">highlight</code></td>
<td>
<p>TRUE if differences will be highlighted; otherwise FALSE</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_highlight.col">highlight.col</code></td>
<td>
<p>a vector of colours for attributes corresponding to rows of <code>X</code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_highlight.lty">highlight.lty</code></td>
<td>
<p>line type associated with the highlighting.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_highlight.lwd">highlight.lwd</code></td>
<td>
<p>line weight associated with the highlighting line.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_xlab">xlab</code></td>
<td>
<p>label for the x axis.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_ylab">ylab</code></td>
<td>
<p>label for the y axis.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_axes.font">axes.font</code></td>
<td>
<p>font for axes labels; see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_axes.cex">axes.cex</code></td>
<td>
<p>size for axes labels.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_xlim">xlim</code></td>
<td>
<p>x limits specified using a vector of 2 (ascending) numbers.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_las">las</code></td>
<td>
<p>numeric in 0,1,2,3; the style of the axis labels. See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_x.increment">x.increment</code></td>
<td>
<p>interval between times when labelling the x axis.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_box">box</code></td>
<td>
<p>draw box around plot area; see: <code><a href="graphics.html#topic+box">box</a></code></p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_legend.cex">legend.cex</code></td>
<td>
<p>size of markers shown in the legend.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_legend.font">legend.font</code></td>
<td>
<p>font for the legend; see <code><a href="graphics.html#topic+text">text</a></code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_legend.pos">legend.pos</code></td>
<td>
<p>location of plot legend; defaults to <code>"topleft"</code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_legend.ncol">legend.ncol</code></td>
<td>
<p>number of columns in legend.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_height">height</code></td>
<td>
<p>window height.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_width">width</code></td>
<td>
<p>window width.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_main">main</code></td>
<td>
<p>plot title; see <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_save.format">save.format</code></td>
<td>
<p>If indicated, this will be the fle type for the save image. Defaults to <code>"eps"</code> (eps format). Other possible values are <code>""</code> (not saved) or <code>"png"</code> (png format).</p>
</td></tr>
<tr><td><code id="tcata.line.plot_+3A_save.as">save.as</code></td>
<td>
<p>Filename if the file will be saved.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Castura, J.C., Antúnez, L., Giménez, A., Ares, G. (2016). Temporal check-all-that-apply (TCATA): A novel temporal sensory method for characterizing products. <em>Food Quality and Preference</em>, 47, 79-90. <a href="https://doi.org/10.1016/j.foodqual.2015.06.017">doi:10.1016/j.foodqual.2015.06.017</a>
</p>
<p>Meyners, M., Castura, J.C. (2018). The analysis of temporal check-all-that-apply (TCATA) data. <em>Food Quality and Preference</em>, 67, 67-76. <a href="https://doi.org/10.1016/j.foodqual.2017.02.003">doi:10.1016/j.foodqual.2017.02.003</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using 'syrah' data set
low1 &lt;- t(syrah[seq(3, 1026, by = 6), -c(1:4)])
colnames(low1) &lt;- 10:180
tcata.line.plot(get.smooth(low1), lwd = 2, main = "Low-ethanol wine (Sip 1)")

# example using 'ojtcata' data set
data(ojtcata)
# comparison of Orange Juice 1 vs. Other OJs (2 to 6)
oj1.v.other &lt;- citation.counts(ojtcata, product.name = "1", product.col = 2,
       attribute.col = 4, results.col = 5:25, comparison = "other")
times &lt;- get.times(colnames(ojtcata)[-c(1:4)])
attributes &lt;- unique(ojtcata$attribute)
palettes &lt;- make.palettes(length(attributes))

# plot results
tcata.line.plot(oj1.v.other$P1, n = oj1.v.other$Pn,
   attributes = attributes, times = times,
   line.col = palettes$pal, reference = oj1.v.other$ref, ref.lty = 3,
   declutter = oj1.v.other$declutter, highlight = TRUE, highlight.lwd = 4,
   highlight.col = palettes$pal.light,
   height = 7, width = 11, legend.cex = 0.7, main = "Product 1 vs. Other Products")

# example showing plots similar to those in Meyners &amp; Castura (2018)
# comparison of Orange Juice 1 vs. All OJs (1 to 6)
oj1.v.all &lt;- citation.counts(ojtcata, product.name = "1", product.col = 2,
       attribute.col = 4, results.col = 5:25, comparison = "average")
lty.mat &lt;- matrix(1,nrow=6,ncol=21)
lty.mat[, 1:3] &lt;- c(rep(NA,8),rep(c(1,NA),4), 1, 1)
lty.mat[2, 9:12] &lt;- lty.mat[5, 8] &lt;- 3
tcata.line.plot(oj1.v.all$P1, n = oj1.v.all$Pn, attributes = attributes,
                times = times, line.col = palettes$pal, lty = lty.mat, lwd = 2,
                height = 7, width = 11, legend.cex = 0.7, main = "Product 1 vs. All Products")
</code></pre>

<hr>
<h2 id='TDS+20data+20set+3A+20orange+20juice'>TDS data set: orange juice</h2><span id='topic+ojtds'></span>

<h3>Description</h3>

<p>Raw results from 20-s TDS evaluations of six orange juice samples by 50 consumers.</p>


<h3>Format</h3>

<p>A data frame with 1800 rows (50 consumers * 6 samples * 6 attributes) and 25 columns (4 headers + 21 time slices)
</p>

<ul>
<li><p> [, 1] cons (int) consumer id
</p>
</li>
<li><p> [, 2] samp (chr) sample id
</p>
</li>
<li><p> [, 3] samp_pos (int) position of sample in serving order
</p>
</li>
<li><p> [, 4] attribute (chr) sensory attribute
</p>
</li>
<li><p> [, 5:25]  time_<code>99</code>s (int) value is <code>1</code> if attribute is selected at time slice; otherwise value is <code>0</code>
</p>
</li></ul>



<h3>References</h3>

<p>Ares, G., Jaeger, S. R., Antúnez, L., Vidal, L, Giménez, A., Coste, B., Picallo, A., &amp; Castura, J.C. (2016). Comparison of TCATA and TDS for dynamic sensory characterization of food products. <em>Food Research International</em>, 78, 148-158. <a href="https://doi.org/10.1016/j.foodres.2015.10.023">doi:10.1016/j.foodres.2015.10.023</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>head(ojtds) # review first 6 rows of 'ojtds' data set
</code></pre>

<hr>
<h2 id='TDS+20data+20set+3A+20snack+20bars'>TDS data set: snack bars</h2><span id='topic+bars'></span>

<h3>Description</h3>

<p>Raw TDS results from 24 assessors who evaluated four snack bars in triplicate.</p>


<h3>Format</h3>

<p>A data frame with 1440 rows (24 assessors * 3 sessions * 4 samples * 5 attributes) and 455 columns (4 header rows + 451 time slices)
</p>

<ul>
<li><p> [,1] 	assessor (chr) assessor id
</p>
</li>
<li><p> [,2] 	session (chr) session id
</p>
</li>
<li><p> [,3] 	sample (chr) sample id
</p>
</li>
<li><p> [,4]  attribute (chr) sensory attribute
</p>
</li>
<li><p> [,5:455]  time_<code>99.9</code>s (chr) value is <code>1</code> if attribute is dominant at time slice; otherwise value is <code>0</code>
</p>
</li></ul>



<h3>References</h3>

<p>Findlay, C.J., Castura, J.C., &amp; Valeriote, E. (2014). Temporal methods: A comparative study of four different techniques. In <em>17th IUFoST Congress</em>. 17-21 August. Montréal, Québec, Canada.</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(bars, 2) # review first 2 rows of 'bars' data set
</code></pre>

<hr>
<h2 id='tds.diff.plot'>Plot TDS difference curves</h2><span id='topic+tds.diff.plot'></span>

<h3>Description</h3>

<p>Plots TDS difference curves based on differences in dominance counts or dominace rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tds.diff.plot(
  X,
  times = NULL,
  attributes = NULL,
  xlab = "Time (seconds)",
  ylab = "Dominance rate",
  line.col = 1,
  lty = 1,
  lwd = 1,
  main = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tds.diff.plot_+3A_x">X</code></td>
<td>
<p>matrix of differences in dominance rates (Attributes in rows, Times in columns).</p>
</td></tr>
<tr><td><code id="tds.diff.plot_+3A_times">times</code></td>
<td>
<p>a vector of times, corresponding to the times in <code>X</code>.</p>
</td></tr>
<tr><td><code id="tds.diff.plot_+3A_attributes">attributes</code></td>
<td>
<p>a vector of attribute labels, corresponding to the attributes in <code>X</code>.</p>
</td></tr>
<tr><td><code id="tds.diff.plot_+3A_xlab">xlab</code>, <code id="tds.diff.plot_+3A_ylab">ylab</code></td>
<td>
<p>Labels for the x and y axes; see <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
<tr><td><code id="tds.diff.plot_+3A_line.col">line.col</code></td>
<td>
<p>A vector of colors for lines corresponding to <code>attributes</code>; see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="tds.diff.plot_+3A_lty">lty</code>, <code id="tds.diff.plot_+3A_lwd">lwd</code></td>
<td>
<p>line type and weight for attributes; see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="tds.diff.plot_+3A_main">main</code></td>
<td>
<p>plot title; see <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently the differences in dominance rates are always displayed. Suppression of differences in dominances rates within a threshold range is not yet implemented.
</p>


<h3>References</h3>

<p>Pineau, N., Schlich, P., Cordelle, S., Mathonnière, C., Issanchou, S., Imbert, A., Rogeaux, M., Etiévant, P., &amp; Köster, E. (2009). Temporal dominance of sensations: Construction of the TDS curves and comparison with time–intensity.  <em>Food Quality and Preference</em>, 20, 450–455. <a href="https://doi.org/10.1016/j.foodqual.2009.04.005">doi:10.1016/j.foodqual.2009.04.005</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using 'bars' data set
bars.m &lt;- aggregate(bars[, -c(1:4)], list(samples = bars$sample, attribute = bars$attribute), mean)
bars.m &lt;- bars.m[order(bars.m$sample, bars.m$attribute), ]
attributes &lt;- unique(bars$attribute)
times &lt;- get.times(colnames(bars.m)[-c(1:2)])
bar1 &lt;- bars.m[bars.m$sample == 1, -c(1:2)]
bar2 &lt;- bars.m[bars.m$sample == 2, -c(1:2)]
diff.1vs2 &lt;- get.smooth(bar1 - bar2, low.bound = -1, up.bound = 1)
tds.diff.plot(diff.1vs2, times = times, attributes = attributes,
                lwd = 2, main = "TDS Differences (Bar 1 - Bar 2)")

# suppose we only want to show the curves where the difference in dominance rate
# is significantly different
# get samples sizes and dominance counts for each product
bars.s &lt;- aggregate(bars[, -c(1:4)], list(samples = bars$sample, attribute = bars$attribute), sum)
bars.s &lt;- bars.s[order(bars.s$sample, bars.s$attribute), ]
bar1.s &lt;- bars.s[bars.s$sample == 1, -c(1:2)]
bar2.s &lt;- bars.s[bars.s$sample == 2, -c(1:2)]
bar1.n &lt;- nrow(unique(bars[bars$sample == 1, 1:2]))
bar2.n &lt;- nrow(unique(bars[bars$sample == 2, 1:2]))

# prop.test2 is a wrapper for prop.test (with its default parameters)
# thus it will run chi-squared test with Yates continuity correction
prop.test2 &lt;-  function(x1, x2, n1, n2, alpha = 0.05){
  return((suppressWarnings(prop.test(c(x1,x2), c(n1, n2),
          alternative = "two.sided"))$p.value &lt; alpha) %in% TRUE)
}
# find significant pairwise comparison, treating data as if independent
diff_1v2.signif &lt;- mapply(prop.test2, unlist(bar1.s), unlist(bar2.s), bar1.n, bar2.n)
# update smoothed difference matrix with NA where non-significant pairs
diff_1v2.signif[!diff_1v2.signif] &lt;- NA
diff.1vs2 &lt;- diff.1vs2 + diff_1v2.signif - 1
# line segments that are non-significant are missing/NA so not plotted
tds.diff.plot(diff.1vs2, times = times, attributes = attributes,
              lwd = 2, main = "TDS Differences (Bar 1 - Bar 2)")
</code></pre>

<hr>
<h2 id='tds.plot'>Plot TDS curves</h2><span id='topic+tds.plot'></span>

<h3>Description</h3>

<p>Plots TDS curves based on dominance rates, showing chance and significance lines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tds.plot(X, attributes = NULL, times = NULL, chance = NULL, signif = NULL,
 line.col = 1, lty = 1, lwd = 1, las = 0, xlab = "Time (seconds)",
 ylab = "Dominance rate", main = "", height = 8, width = 12, box = FALSE, save.as = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tds.plot_+3A_x">X</code></td>
<td>
<p>matrix of dominance rates (Attributes in rows, Times in columns).</p>
</td></tr>
<tr><td><code id="tds.plot_+3A_attributes">attributes</code></td>
<td>
<p>a vector of attribute labels, corresponding to the attributes in <code>X</code>.</p>
</td></tr>
<tr><td><code id="tds.plot_+3A_times">times</code></td>
<td>
<p>a vector of times, corresponding to the times in <code>X</code>.</p>
</td></tr>
<tr><td><code id="tds.plot_+3A_chance">chance</code></td>
<td>
<p>proportion indicating the chance level, usually <code>1/length(attributes)</code> or <code>1/(1+length(attributes))</code>.</p>
</td></tr>
<tr><td><code id="tds.plot_+3A_signif">signif</code></td>
<td>
<p>significance level associated with the number of observations and <code>chance</code>.</p>
</td></tr>
<tr><td><code id="tds.plot_+3A_line.col">line.col</code></td>
<td>
<p>A vector of colors for lines corresponding to <code>attributes</code>; see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="tds.plot_+3A_lty">lty</code>, <code id="tds.plot_+3A_lwd">lwd</code></td>
<td>
<p>line type and weight for attributes; see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="tds.plot_+3A_las">las</code></td>
<td>
<p>numeric in 0,1,2,3; the style of the axis labels. See: <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="tds.plot_+3A_xlab">xlab</code>, <code id="tds.plot_+3A_ylab">ylab</code></td>
<td>
<p>Labels for the x and y axes; see <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
<tr><td><code id="tds.plot_+3A_main">main</code></td>
<td>
<p>plot title; see <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
<tr><td><code id="tds.plot_+3A_height">height</code></td>
<td>
<p>Window height.</p>
</td></tr>
<tr><td><code id="tds.plot_+3A_width">width</code></td>
<td>
<p>Window width.</p>
</td></tr>
<tr><td><code id="tds.plot_+3A_box">box</code></td>
<td>
<p>draw box around plot area; see: <code><a href="graphics.html#topic+box">box</a></code></p>
</td></tr>
<tr><td><code id="tds.plot_+3A_save.as">save.as</code></td>
<td>
<p>Filename if the file will be saved.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pineau, N., Schlich, P., Cordelle, S., Mathonnière, C., Issanchou, S., Imbert, A., Rogeaux, M., Etiévant, P., &amp; Köster, E. (2009). Temporal dominance of sensations: Construction of the TDS curves and comparison with time–intensity.  <em>Food Quality and Preference</em>, 20, 450–455. <a href="https://doi.org/10.1016/j.foodqual.2009.04.005">doi:10.1016/j.foodqual.2009.04.005</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example using 'bars' data set
bars.m &lt;- aggregate(bars[, -c(1:4)], list(sample = bars$sample, attribute = bars$attribute), mean)
bars.m &lt;- bars.m[order(bars.m$sample, bars.m$attribute), ]
attributes &lt;- as.character(bars.m$attribute[bars.m$sample == 1])
times &lt;- get.times(colnames(bars.m)[-c(1:2)])
chance &lt;- get.chance(attributes)
signif &lt;- get.significance(chance, nrow(unique(bars[, 1:2])))
tds.plot(get.smooth(bars.m[bars.m$sample == 1, -c(1:2)]), attributes = attributes,
         times = times, chance = chance, signif = signif,
         lwd = 2, main = "Bar 1")

# it is possible to hide the portion of the plot below the significance line:
rect(-2, -0.2, times[length(times)]+2, signif, col = "white", border = "transparent")
# re-add axes &amp; significance line
axis(1, labels = seq(0, 45, by = 5), at = seq(0, 45, by = 5))
axis(2)
abline(h=signif, lty=3, col = "grey")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
