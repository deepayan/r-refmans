<!DOCTYPE html><html lang="en"><head><title>Help for package TSVC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TSVC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confint'><p>Confidence intervals for Varying Coefficient Trees</p></a></li>
<li><a href='#confint.TSVC'><p>Confidence intervals for Varying Coefficient Trees</p></a></li>
<li><a href='#plot.TSVC'><p>Plotting of Varying Coefficient Trees</p></a></li>
<li><a href='#predict.TSVC'><p>Prediction from Varying Coefficient Trees</p></a></li>
<li><a href='#summary.TSVC'><p>Summary of Tree-Structured Varying Coefficient Models</p></a></li>
<li><a href='#TSVC'><p>Tree-Structured Modelling of Varying Coefficients</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tree-Structured Modelling of Varying Coefficients</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-20</td>
</tr>
<tr>
<td>Depends:</td>
<td>plotrix, mgcv, VGAM, tibble, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>AER</td>
</tr>
<tr>
<td>Description:</td>
<td>Fitting tree-structured varying coefficient models (Berger et al. (2019), &lt;<a href="https://doi.org/10.1007%2Fs11222-018-9804-8">doi:10.1007/s11222-018-9804-8</a>&gt;). Simultaneous detection of covariates with varying coefficients and effect modifiers that induce varying coefficients if they are present. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-20 13:38:31 UTC; berger</td>
</tr>
<tr>
<td>Author:</td>
<td>Moritz Berger [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Moritz Berger &lt;moritz.berger@imbie.uni-bonn.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-20 14:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='confint'>Confidence intervals for Varying Coefficient Trees</h2><span id='topic+confint'></span>

<h3>Description</h3>

<p>Confidence intervals for Varying Coefficient Trees
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confint(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint_+3A_object">object</code></td>
<td>
<p>a fitted object of class <code><a href="#topic+TSVC">TSVC</a></code>.</p>
</td></tr>
<tr><td><code id="confint_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>

<hr>
<h2 id='confint.TSVC'>Confidence intervals for Varying Coefficient Trees</h2><span id='topic+confint.TSVC'></span>

<h3>Description</h3>

<p>Construct parametric bootstrap percentile confidence intervals of effects of covariates that vary with the values of one or several effect modifiers. The basic method 
is described in Spuck et al. (2025).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TSVC'
confint(
  object,
  bootstrap_n = 500,
  alpha = 0.05,
  post_pruning = NULL,
  splits_max = 5,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.TSVC_+3A_object">object</code></td>
<td>
<p>a fitted object of class <code><a href="#topic+TSVC">TSVC</a></code>.</p>
</td></tr>
<tr><td><code id="confint.TSVC_+3A_bootstrap_n">bootstrap_n</code></td>
<td>
<p>the number of bootstrap samples to be drawn.</p>
</td></tr>
<tr><td><code id="confint.TSVC_+3A_alpha">alpha</code></td>
<td>
<p>significance level <code class="reqn">alpha</code> of the confidence interval.</p>
</td></tr>
<tr><td><code id="confint.TSVC_+3A_post_pruning">post_pruning</code></td>
<td>
<p>method to select the maximal number of splits; can be <code>"AIC"</code> or <code>"BIC"</code>. If <code>NULL</code> (default), no post-pruning is performed.</p>
</td></tr>
<tr><td><code id="confint.TSVC_+3A_splits_max">splits_max</code></td>
<td>
<p>maximal number of splits to be considered. If <code>post_pruning</code> is <code>NULL</code> it is ignored.</p>
</td></tr>
<tr><td><code id="confint.TSVC_+3A_trace">trace</code></td>
<td>
<p>if <code>TRUE</code>, information about the estimation progress is printed.</p>
</td></tr>
<tr><td><code id="confint.TSVC_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method is so far mainly put to the test for gaussian (family=gaussian) and binary (family=binary(link=&quot;logit&quot;)) outcome. It should be taken with care for 
differently scaled outcomes.
</p>


<h3>Author(s)</h3>

<p>Moritz Berger &lt;Moritz.Berger@imbie.uni-bonn.de&gt; <br /> <a href="https://www.imbie.uni-bonn.de/people/dr-moritz-berger/">https://www.imbie.uni-bonn.de/people/dr-moritz-berger/</a> 
</p>
<p>Nikolai Spuck &lt;Spuck@imbie.uni-bonn.de&gt; <br /> <a href="https://www.imbie.uni-bonn.de/people/nikolai-spuck/">https://www.imbie.uni-bonn.de/people/nikolai-spuck/</a>
</p>


<h3>References</h3>

<p>Berger, M., G. Tutz and M. Schmid (2019). Tree-Structured Modelling of Varying Coefficients. Statistics and Computing 29, 217-229,
https://doi.org/10.1007/s11222-018-9804-8. 
</p>
<p>Spuck, N., M. Schmid, M. Monin and M. Berger (2025). Confidence intervals for tree-structured varying coefficients. Computational Statistics and Data Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TSVC">TSVC</a></code>, <code><a href="#topic+plot.TSVC">plot.TSVC</a></code>, <code><a href="#topic+predict.TSVC">predict.TSVC</a></code>, <code><a href="#topic+summary.TSVC">summary.TSVC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Swiss Labour Market 
library(AER)
data("SwissLabor")

# recode factors 
sl &lt;- SwissLabor
sl$participation &lt;- as.numeric(sl$participation)-1
sl$foreign       &lt;- as.numeric(sl$foreign)-1

## Not run: 
fit1 &lt;- TSVC(participation~income+age, data=sl, family=binomial(link="logit"), 
perm_test=FALSE, test_linear=FALSE, splits_max=3)
confint(fit1, bootstrap_n=500, alpha=0.05, trace=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.TSVC'>Plotting of Varying Coefficient Trees</h2><span id='topic+plot.TSVC'></span>

<h3>Description</h3>

<p>Visualization of trees of effects of covariates that vary with the values of one or several effect modifiers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TSVC'
plot(
  x,
  variable,
  ellipse_a = 0.8,
  ellipse_b = 0.2,
  ellipse_x = 0,
  ellipse_y = 0,
  branch_adj = 0,
  cex.lines = 2,
  cex.branches = 1,
  cex.coefs = 1,
  cex.main = 1,
  cex.numbers = 1,
  draw_numbers = TRUE,
  title = NULL,
  decimals = 3,
  confint = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.TSVC_+3A_x">x</code></td>
<td>
<p>a fitted object of class <code><a href="#topic+TSVC">TSVC</a></code>.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_variable">variable</code></td>
<td>
<p>name of the variable, for which the tree shall be plotted.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_ellipse_a">ellipse_a</code></td>
<td>
<p>controls width of ellipses containing coefficient estimates.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_ellipse_b">ellipse_b</code></td>
<td>
<p>controls height of ellipses containing coefficient estimates.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_ellipse_x">ellipse_x</code></td>
<td>
<p>controls location on x-axis of ellipses containing coefficient estimates.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_ellipse_y">ellipse_y</code></td>
<td>
<p>controls location on y-axis of ellipses containing coefficient estimates.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_branch_adj">branch_adj</code></td>
<td>
<p>vertical adjustment of branch labels.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_cex.lines">cex.lines</code></td>
<td>
<p>width of branches of the tree.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_cex.branches">cex.branches</code></td>
<td>
<p>size of the labels of the tree.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_cex.coefs">cex.coefs</code></td>
<td>
<p>size of the coefficients in the terminal nodes of the tree.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_cex.main">cex.main</code></td>
<td>
<p>size of the title of the tree.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_cex.numbers">cex.numbers</code></td>
<td>
<p>size of the internally used node number.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_draw_numbers">draw_numbers</code></td>
<td>
<p>if <code>true</code>, internally used node numbers are displayed.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_title">title</code></td>
<td>
<p>optional title, which is addded to the tree; if <code>title=NULL</code> the title is the name of the variable in the data.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_decimals">decimals</code></td>
<td>
<p>number of decimals of coefficient estimates. Per default the coefficient estimates are displayed with three decimals.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_confint">confint</code></td>
<td>
<p>optional fitted object of class <code><a href="#topic+confint.TSVC">confint.TSVC</a></code> with confidence intervals to be plotted 
in the terminal nodes of the tree; if <code>confint=NULL</code> (default) only the coefficient estimates will be plotted.</p>
</td></tr>
<tr><td><code id="plot.TSVC_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Moritz Berger &lt;Moritz.Berger@imbie.uni-bonn.de&gt; <br /> <a href="https://www.imbie.uni-bonn.de/people/dr-moritz-berger/">https://www.imbie.uni-bonn.de/people/dr-moritz-berger/</a>
</p>


<h3>References</h3>

<p>Berger, M., G. Tutz and M. Schmid (2019). Tree-Structured Modelling of Varying Coefficients. Statistics and Computing 29, 217-229,
https://doi.org/10.1007/s11222-018-9804-8.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TSVC">TSVC</a></code>, <code><a href="#topic+predict.TSVC">predict.TSVC</a></code>, <code><a href="#topic+summary.TSVC">summary.TSVC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Swiss Labour Market 
library(AER)
data("SwissLabor")

# recode factors 
sl &lt;- SwissLabor
sl$participation &lt;- as.numeric(sl$participation)-1
sl$foreign       &lt;- as.numeric(sl$foreign)-1

## Not run: 
fit1 &lt;- TSVC(participation~income+age, data=sl, family=binomial(link="logit"), 
             nperm=1000, trace=TRUE)
plot(fit1, "income")

fit2 &lt;- TSVC(participation~income+age, data=sl, family=binomial(link="logit"), 
perm_test=FALSE, test_linear=FALSE, splits_max=3)
set.seed(20012025)
ci2  &lt;- confint(fit2, bootstrap_n=500, alpha=0.05, trace=TRUE)
plot(fit2, variable="income", confint=ci2, ellipse_y=0, draw_numbers=FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='predict.TSVC'>Prediction from Varying Coefficient Trees</h2><span id='topic+predict.TSVC'></span>

<h3>Description</h3>

<p>Obtains predictions from a fitted TSVC object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TSVC'
predict(object, X_new = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.TSVC_+3A_object">object</code></td>
<td>
<p>a fitted object of class <code><a href="#topic+TSVC">TSVC</a></code>.</p>
</td></tr>
<tr><td><code id="predict.TSVC_+3A_x_new">X_new</code></td>
<td>
<p>optionally, data frame of class <code><a href="base.html#topic+data.frame">data.frame</a></code> which contains the variables with which to predict. If <code>NULL</code>, the fitted 
linear predictors are use.</p>
</td></tr>
<tr><td><code id="predict.TSVC_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+predict.glm">predict.glm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predict.TSVC</code> is a wrapper function of <code>predict.glm</code>, which obtains predictions for objects of class <code><a href="stats.html#topic+glm">glm</a></code>. Further
arguments can be passed to <code>predict.glm</code> via the '...'-argument.
</p>


<h3>Author(s)</h3>

<p>Moritz Berger &lt;moritz.berger@imbie.uni-bonn.de&gt; <br /> <a href="https://www.imbie.uni-bonn.de/people/dr-moritz-berger/">https://www.imbie.uni-bonn.de/people/dr-moritz-berger/</a>
</p>


<h3>References</h3>

<p>Berger, M., G. Tutz and M. Schmid (2019). Tree-Structured Modelling of Varying Coefficients. Statistics and Computing 29, 217-229,
https://doi.org/10.1007/s11222-018-9804-8.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TSVC">TSVC</a></code>, <code><a href="#topic+plot.TSVC">plot.TSVC</a></code>, <code><a href="#topic+summary.TSVC">summary.TSVC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Swiss Labour Market 
library(AER)
data("SwissLabor")

# recode factors
sl &lt;- SwissLabor
sl$participation &lt;- as.numeric(sl$participation)-1
sl$foreign       &lt;- as.numeric(sl$foreign)-1

X_new &lt;- data.frame("income"=c(10,12), "age"=c(4.5,5.8))

## Not run: 
fit1 &lt;- TSVC(participation~income+age, data=sl, family=binomial(link="logit"), 
             nperm=1000, trace=TRUE)
predict(fit1, X_new, type="response")

## End(Not run)


</code></pre>

<hr>
<h2 id='summary.TSVC'>Summary of Tree-Structured Varying Coefficient Models</h2><span id='topic+summary.TSVC'></span><span id='topic+print.summary.TSVC'></span>

<h3>Description</h3>

<p>Summary for an object of class <code>TSVC</code>, with an overview of all executed splits during the fitting process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TSVC'
summary(object, ...)

## S3 method for class 'summary.TSVC'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.TSVC_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+TSVC">TSVC</a></code>.</p>
</td></tr>
<tr><td><code id="summary.TSVC_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.TSVC_+3A_x">x</code></td>
<td>
<p>object of class <code><a href="#topic+summary.TSVC">summary.TSVC</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>"summary.TSVC"</code>. An object of class <code>"summary.TSVC"</code> is a list containing the 
following components: 
</p>
<table role = "presentation">
<tr><td><code>stats</code></td>
<td>
<p>overview of detected varying coefficients, responsible effect modifiers and executed splits.</p>
</td></tr>
<tr><td><code>nosplits</code></td>
<td>
<p>total number of executed splits during the fitting process.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Moritz Berger &lt;Moritz.Berger@imbie.uni-bonn.de&gt; <br /> <a href="https://www.imbie.uni-bonn.de/people/dr-moritz-berger/">https://www.imbie.uni-bonn.de/people/dr-moritz-berger/</a>
</p>


<h3>References</h3>

<p>Berger, M., G. Tutz and M. Schmid (2019). Tree-Structured Modelling of Varying Coefficients. Statistics and Computing 29, 217-229,
https://doi.org/10.1007/s11222-018-9804-8.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TSVC">TSVC</a></code>, <code><a href="#topic+plot.TSVC">plot.TSVC</a></code>, <code><a href="#topic+predict.TSVC">predict.TSVC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Swiss Labour Market 
library(AER)
data("SwissLabor")

# recode factors
sl &lt;- SwissLabor
sl$participation &lt;- as.numeric(sl$participation)-1
sl$foreign       &lt;- as.numeric(sl$foreign)-1

## Not run: 
fit1 &lt;- TSVC(participation~income+age, data=sl, family=binomial(link="logit"), 
             nperm=1000, trace=TRUE)
summary(fit1)

## End(Not run)


</code></pre>

<hr>
<h2 id='TSVC'>Tree-Structured Modelling of Varying Coefficients</h2><span id='topic+TSVC'></span><span id='topic+print.TSVC'></span>

<h3>Description</h3>

<p>A function to fit tree-structured varying coefficient (TSVC) models. By recursive splitting the method allows to simultaneously detect covariates 
with varying coefficients and the effect modifiers that induce varying coefficients if they are present. The basic method is described in 
Berger, Tutz and Schmid (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSVC(
  formula,
  data,
  family = gaussian,
  alpha = 0.05,
  nperm = 1000,
  nodesize_min = 5,
  bucket_min = 1,
  depth_max = NULL,
  splits_max = NULL,
  perm_test = TRUE,
  test_linear = FALSE,
  gpd_approx = FALSE,
  effmod = NULL,
  notmod = NULL,
  only_effmod = NULL,
  smooth = NULL,
  split_intercept = FALSE,
  sb_slope = NULL,
  sb_slope_c = FALSE,
  n_quantile = 20,
  trace = FALSE,
  ...
)

## S3 method for class 'TSVC'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TSVC_+3A_formula">formula</code></td>
<td>
<p>object of class <code><a href="stats.html#topic+formula">formula</a></code>: a symbolic description of the (linear) model to be fit. See also details.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_data">data</code></td>
<td>
<p>data frame of class <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the variables in the model.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model (as for <code><a href="stats.html#topic+glm">glm</a></code>). 
This can be a character string naming a family function, a family function or the result of a call to a family function. 
See <code><a href="stats.html#topic+family">family</a></code> for details of family functions.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_alpha">alpha</code></td>
<td>
<p>significance level <code class="reqn">alpha</code> for the permutation tests.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_nperm">nperm</code></td>
<td>
<p>number of permutations used for the permutation tests.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_nodesize_min">nodesize_min</code></td>
<td>
<p>minimum number of observations that must exist in a node in order for a split to be attempted.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_bucket_min">bucket_min</code></td>
<td>
<p>the minimum number of observations in any terminal node.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_depth_max">depth_max</code></td>
<td>
<p>maximum depth of any node in each tree, with the root node counted as depth 0. If <code>NULL</code> (default), the size of the trees is not restricted.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_splits_max">splits_max</code></td>
<td>
<p>maximum number of splits performed. If <code>NULL</code> (default), the number of splits is not restricted.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_perm_test">perm_test</code></td>
<td>
<p>if <code>FALSE</code>, no permutation tests are performed, but each tree is grown until the minimum node size constraint is reached.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_test_linear">test_linear</code></td>
<td>
<p>should linear effects that were not modified during iteration tested for significance?</p>
</td></tr>
<tr><td><code id="TSVC_+3A_gpd_approx">gpd_approx</code></td>
<td>
<p>if <code>TRUE</code>, the p-value of the permutation test is approximated by a generalized Pareto distribution (Knijnenburg et al., 2009).</p>
</td></tr>
<tr><td><code id="TSVC_+3A_effmod">effmod</code></td>
<td>
<p>optional vector of covariates that serve as effect modifier. If <code>NULL</code> (default), all covariates are considered as potential effect modifiers.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_notmod">notmod</code></td>
<td>
<p>optional list of class <code><a href="base.html#topic+list">list</a></code> containing pairs of covariate/effect modifier that are not considered as candidates for splitting during iteration.
If <code>NULL</code> (default), all combinations of covariates and potential effect modifiers are considered for splitting.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_only_effmod">only_effmod</code></td>
<td>
<p>optional vector of covariates that serve as effect modifier, only. If <code>NULL</code> (default), all effect modifiers are included in the predictor of the model and 
are allowed to be modified.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_smooth">smooth</code></td>
<td>
<p>optional vector of covariates with a smooth effect on the response. The (smooth) effects fo these variables are not allowed to be modified.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_split_intercept">split_intercept</code></td>
<td>
<p>if <code>TRUE</code>, the intercept is allowed to be modified by the covariates. If <code>FALSE</code> (default), the intercept is set constant.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_sb_slope">sb_slope</code></td>
<td>
<p>optional vector of covariates that are allowed to be modified by itself. Such an effect corresponds to a structural break in the slope.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_sb_slope_c">sb_slope_c</code></td>
<td>
<p>if <code>TRUE</code> the structural breaks in the covariates specified in <code>sb_slope</code> are forced to be without discontinuity. Need to be used with care 
in a multivariable setting, where the covariates in <code>sb_slope</code> are also allowed to be modified by other effect modifiers.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_n_quantile">n_quantile</code></td>
<td>
<p>the number of splits considered for numeric effect modifiers (with decimal values), determined by the corresponding 
quantiles of the effect modifiers. Per default this is set to 20, which uses percentiles.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_trace">trace</code></td>
<td>
<p>if <code>TRUE</code>, information about the estimation progress is printed.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="TSVC_+3A_x">x</code></td>
<td>
<p>object of class <code>TSVC</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A typical <a href="stats.html#topic+formula">formula</a> has the form <code>response ~ covariates</code>, where <code>response</code> is the name of the response variable and <code>covariates</code> is a
series of variables that are incorporated in the model. 
</p>
<p>With p covariates, <code>TSVC</code> expects a formula of the form <code class="reqn">y ~ x_1+...+x_p</code>. If no further specifications are made (<code>effmod=NULL</code>, <code>notmod=NULL</code>, <code>only_effmod=NULL</code>) it is assumed that each covariate <code class="reqn">x_j, j = {1,...,p}</code> 
can be modified by all the other variables <code class="reqn">x_m, m = {1,...,p} \ j</code>. 
</p>
<p>Remark: Significance of each split is verified by permutation tests. The result of the permutation tests 
can strongly depend on the number of permutations <code>nperm</code>.
</p>
<p>Note: The algorithm currently does not support splitting of/by factor variables. If a factor variable is included in the <a href="stats.html#topic+formula">formula</a> of the model, the variable will not serve as 
effect modifier and its effect will not be modified.
</p>


<h3>Value</h3>

<p>Object of class <code>"TSVC"</code>. An object of class <code>"TSVC"</code> is a list containing the following components: 
</p>
<table role = "presentation">
<tr><td><code>splits</code></td>
<td>
<p>matrix with detailed information about all executed splits during the fitting process.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>list of estimated coefficients for covariates with and without varying coefficients (including a non-varying intercept).</p>
</td></tr>
<tr><td><code>pvalues</code></td>
<td>
<p>p-values of each permuation test during the fitting process.</p>
</td></tr>
<tr><td><code>pvalues_linear</code></td>
<td>
<p>p-values of the permutation tests on the linear effects in the last step of the algorithm.</p>
</td></tr>
<tr><td><code>devs</code></td>
<td>
<p>maximal value statistics <code class="reqn">T_m</code> of the selected effect modifier in each iteration during the fitting process.</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>critical values of each permutation test during the fitting process.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>response vector.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>matrix of all the variables (covariates and effect modifiers) for model fitting.</p>
</td></tr>
<tr><td><code>sb</code></td>
<td>
<p>variables for which a structural break in the slope was allowed.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>internally fitted model in the last iteration of class <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="mgcv.html#topic+gam">gam</a></code>.</p>
</td></tr>
<tr><td><code>all_models</code></td>
<td>
<p>list of internally fitted models of class <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="mgcv.html#topic+gam">gam</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Moritz Berger &lt;Moritz.Berger@imbie.uni-bonn.de&gt; <br /> <a href="https://www.imbie.uni-bonn.de/people/dr-moritz-berger/">https://www.imbie.uni-bonn.de/people/dr-moritz-berger/</a>
</p>


<h3>References</h3>

<p>Berger, M., G. Tutz and M. Schmid (2019). Tree-Structured Modelling of Varying Coefficients. Statistics and Computing 29, 217-229,
https://doi.org/10.1007/s11222-018-9804-8.
</p>
<p>Hastie, T. and R. Tibshirani (1993). Varying-coefficient models. Journal of the Royal Statistical Society B 55, 757-796.
</p>
<p>Hothorn T., K. Hornik and A. Zeileis (2006). Unbiased recursive partitioning: A conditional inference framework. Journal of Computational 
and Graphical Statistics 15(3), 651-674. 
</p>
<p>Knijnenburg, T.A., L.F., Wessels, M.J. Reinders and I. Shmulevich (2009). Fewer permutations, more accurate P-values. Bioinformatics, 25, i161-i168.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.TSVC">plot.TSVC</a></code>, <code><a href="#topic+predict.TSVC">predict.TSVC</a></code>, <code><a href="#topic+summary.TSVC">summary.TSVC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Swiss Labour Market 
library(AER)
data("SwissLabor")

# recode factors
sl &lt;- SwissLabor
sl$participation &lt;- as.numeric(sl$participation)-1
sl$foreign       &lt;- as.numeric(sl$foreign)-1

## Not run: 
fit1 &lt;- TSVC(participation~income+age, data=sl, family=binomial(link="logit"), 
             nperm=300, trace=TRUE)
print(fit1)
class(fit$model) # glm 

# In fit2, variable 'foreign' does not serve as effect modifier 
# and the effect of 'foreign' is not modified by the other variables.
# That means 'foreign' is assumed to only have simple linear effect on the response. 
fit2 &lt;- TSVC(participation~income+age+foreign, data=sl, family=binomial(link="logit"), 
             nperm=300, trace=TRUE, effmod=c("income","age"), 
             notmod=list(c("foreign","income"),c("foreign","age")))
print(fit2)

# In fit3, variable 'age' does only serve as effect modifier. That means the effect of 'age' 
# is not included in the predictor of the model.    
fit3 &lt;- TSVC(participation~income+age+foreign, data=sl, family=binomial(link="logit"),
             nperm=300, trace=TRUE, only_effmod="age")
print(fit3)  

# In fit4, the intercept is allowed to be modified by 'age' and 'income'. 
# The two covariates, however, are not allowed to modify each other. 
fit4 &lt;- TSVC(participation~income+age, data=sl, family=binomial(link="logit"),
             nperm=300, trace=TRUE, split_intercept=TRUE,
             notmod=list(c("income","age"), c("age", "income")))
print(fit4)    


# In fit5, variable 'age' has a smooth effect on the response. 
# Hence, the (smooth) effect of 'age' will not be modified by the other variables.  
fit5 &lt;- TSVC(participation~income+age+foreign, data=sl, family=binomial(link="logit"),
             nperm=300, trace=TRUE, smooth="age")                     
print(fit5)
class(fit5$model) # gam      

# In fit6, the intercept is allowed to be modified by 'age' and 'income', but the two variables are 
# not included in the predictor of the model. Here, no permutation tests are performed, but the 
# tree is pruned by a minimum node size constraint. 
fit6 &lt;- TSVC(participation~income+age, data=sl, family=binomial(link="logit"),
             perm_test=FALSE, nodesize_min=100, bucket_min=100, trace=TRUE, split_intercept=TRUE,
             effmod=c("income","age"), only_effmod = c("income", "age"))   
print(fit6)                          


## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
