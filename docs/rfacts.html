<!DOCTYPE html><html lang="en-US"><head><title>Help for package rfacts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rfacts}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rfacts-package'><p>rfacts: interface to FACTS on Unix-like systems</p></a></li>
<li><a href='#facts_engines'><p>Engine-specific trial simulation functions</p></a></li>
<li><a href='#facts_results'><p>Read trial simulation results</p></a></li>
<li><a href='#get_csv_files'><p>List FACTS-generated CSV files</p></a></li>
<li><a href='#get_facts_engine'><p>Get the FACTS engine function matching your FACTS file</p></a></li>
<li><a href='#get_facts_file_example'><p>Locate an example FACTS file</p></a></li>
<li><a href='#get_facts_scenarios'><p>List the names of simulation scenarios</p></a></li>
<li><a href='#get_facts_version'><p>Get FACTS version matching your FACTS file</p></a></li>
<li><a href='#get_facts_versions'><p>List supported FACTS versions</p></a></li>
<li><a href='#get_param_dirs'><p>List the directories containing param files</p></a></li>
<li><a href='#get_param_files'><p>List the paths to the param files</p></a></li>
<li><a href='#overwrite_csv_files'><p>Overwrite FACTS CSV output files</p></a></li>
<li><a href='#prep_param_files'><p>Arrange the param files for the engines ahead of time.</p></a></li>
<li><a href='#read_facts'><p>Read parts of FACTS files.</p></a></li>
<li><a href='#reset_rfacts_paths'><p>Reset system dependency info</p></a></li>
<li><a href='#rfacts_paths'><p>Read paths to rfacts system dependencies</p></a></li>
<li><a href='#rfacts_sitrep'><p>Check configuration of system dependencies</p></a></li>
<li><a href='#run_engine'><p>Run trial simulations</p></a></li>
<li><a href='#run_facts'><p>Run FACTS</p></a></li>
<li><a href='#run_flfll'><p>Generate param files to prepare for trial simulations</p></a></li>
<li><a href='#write_facts'><p>Write modified FACTS files.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>R Interface to 'FACTS' on Unix-Like Systems</td>
</tr>
<tr>
<td>Description:</td>
<td>The 'rfacts' package is an R interface to the
  Fixed and Adaptive Clinical Trial Simulator ('FACTS')
  on Unix-like systems. It programmatically invokes 'FACTS' to run clinical
  trial simulations, and it aggregates simulation output data
  into tidy data frames. These capabilities provide end-to-end
  automation for large-scale simulation pipelines, and
  they enhance computational reproducibility.
  For more information on 'FACTS' itself,
  please visit <a href="https://www.berryconsultants.com/software/">https://www.berryconsultants.com/software/</a>.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://elilillyco.github.io/rfacts/">https://elilillyco.github.io/rfacts/</a>,
<a href="https://github.com/EliLillyCo/rfacts">https://github.com/EliLillyCo/rfacts</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/EliLillyCo/rfacts/issues">https://github.com/EliLillyCo/rfacts/issues</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>FACTS Linux engines (&gt;= 6.2.4), FLFLL (&gt;= 6.2.4),
Mono (&gt;= 5.20.1.19)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>digest (&ge; 0.6.25), fs (&ge; 1.3.1), tibble (&ge; 2.1.3), utils,
xml2 (&ge; 1.2.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr (&ge; 0.8.4), knitr (&ge; 1.28), rmarkdown (&ge; 2.1),
testthat (&ge; 3.0.0), withr (&ge; 2.2.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-19 12:53:54 UTC; landau</td>
</tr>
<tr>
<td>Author:</td>
<td>William Michael Landau
    <a href="https://orcid.org/0000-0003-1878-3253"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Eli Lilly and Company [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>William Michael Landau &lt;will.landau@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-19 13:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rfacts-package'>rfacts: interface to FACTS on Unix-like systems</h2><span id='topic+rfacts-package'></span><span id='topic+rfacts'></span>

<h3>Description</h3>

<p>Call FACTS from R.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts") # example FACTS file
out &lt;- run_facts(
  facts_file,
  n_sims = 4,
  verbose = FALSE
)
# What results files do we have?
head(get_csv_files(out))
# Read all the "patients*.csv" files with `read_patients(out)`.
# For each scenario, we have files named
# patients00001.csv, patients00002.csv, patients00003.csv,
# and patients00004.csv.
read_patients(out)
}
</code></pre>

<hr>
<h2 id='facts_engines'>Engine-specific trial simulation functions</h2><span id='topic+facts_engines'></span><span id='topic+run_engine_aipf_contin'></span><span id='topic+run_engine_aipf_dichot'></span><span id='topic+run_engine_aipf_tte'></span><span id='topic+run_engine_contin'></span><span id='topic+run_engine_crm'></span><span id='topic+run_engine_dichot'></span><span id='topic+run_engine_multep'></span><span id='topic+run_engine_tte'></span>

<h3>Description</h3>

<p>These functions are the inner functions called by
<code><a href="#topic+run_engine">run_engine()</a></code>. In this help file, only the most common engine functions
are listed. To identify the appropriate engine function
for your FACTS file, call <code><a href="#topic+get_facts_engine">get_facts_engine()</a></code>.
</p>

<ul>
<li> <p><code><a href="#topic+run_engine_aipf_contin">run_engine_aipf_contin()</a></code>: Enrichment continuous.
</p>
</li>
<li> <p><code><a href="#topic+run_engine_aipf_dichot">run_engine_aipf_dichot()</a></code>: Enrichment dichotomous.
</p>
</li>
<li> <p><code><a href="#topic+run_engine_aipf_tte">run_engine_aipf_tte()</a></code>: Enrichment time to event.
</p>
</li>
<li> <p><code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>: Core continuous.
</p>
</li>
<li> <p><code><a href="#topic+run_engine_crm">run_engine_crm()</a></code>: continual reassessment method (CRM).
</p>
</li>
<li> <p><code><a href="#topic+run_engine_dichot">run_engine_dichot()</a></code>: Core dichotomous.
</p>
</li>
<li> <p><code><a href="#topic+run_engine_multep">run_engine_multep()</a></code>: Multiple endpoint.
</p>
</li>
<li> <p><code><a href="#topic+run_engine_tte">run_engine_tte()</a></code>: Time to event.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>run_engine_aipf_contin(
  param_files,
  n_sims = 1L,
  mode = c("", "r"),
  seed = NULL,
  analysis_data = NULL,
  analysis_mode = NULL,
  current_week = NULL,
  execdata = NULL,
  final = NULL,
  interim = NULL,
  mcmc_num = NULL,
  verbose = FALSE,
  version = NULL
)

run_engine_aipf_dichot(
  param_files,
  n_sims = 1L,
  mode = c("", "r"),
  seed = NULL,
  analysis_data = NULL,
  analysis_mode = NULL,
  current_week = NULL,
  execdata = NULL,
  final = NULL,
  interim = NULL,
  mcmc_num = NULL,
  verbose = FALSE,
  version = NULL
)

run_engine_aipf_tte(
  param_files,
  n_sims = 1L,
  mode = c("", "r"),
  seed = NULL,
  analysis_data = NULL,
  analysis_mode = NULL,
  current_week = NULL,
  execdata = NULL,
  final = NULL,
  interim = NULL,
  mcmc_num = NULL,
  verbose = FALSE,
  version = NULL
)

run_engine_contin(
  param_files,
  n_sims = 1L,
  mode = c("s", "r", "p"),
  seed = NULL,
  analysis_data = NULL,
  analysis_mode = NULL,
  arm_selection = NULL,
  armsdropped = NULL,
  complete_data_analysis = NULL,
  current_week = NULL,
  execdata = NULL,
  final = NULL,
  fsimdata = NULL,
  fsimexp = NULL,
  fsimparam = NULL,
  interim = NULL,
  keepfiles = NULL,
  mcmc_num = NULL,
  noadapt = NULL,
  s2_aux_paramfile = NULL,
  stage = NULL,
  verbose = FALSE,
  version = NULL
)

run_engine_crm(
  param_files,
  n_sims = 1L,
  mode = c("s", ""),
  directory = ".",
  allocator = NULL,
  charting_info = NULL,
  estimator = NULL,
  force_cohort = NULL,
  reduced_priority = NULL,
  version = NULL,
  verbose = FALSE
)

run_engine_dichot(
  param_files,
  n_sims = 1L,
  mode = c("s", "r", "p"),
  seed = NULL,
  analysis_data = NULL,
  analysis_mode = NULL,
  arm_selection = NULL,
  armsdropped = NULL,
  complete_data_analysis = NULL,
  current_week = NULL,
  execdata = NULL,
  final = NULL,
  fsimdata = NULL,
  fsimexp = NULL,
  fsimparam = NULL,
  interim = NULL,
  keepfiles = NULL,
  mcmc_num = NULL,
  noadapt = NULL,
  s2_aux_paramfile = NULL,
  stage = NULL,
  verbose = FALSE,
  version = NULL
)

run_engine_multep(
  param_files,
  n_sims = 1L,
  mode = c("s", "r", "p"),
  seed = NULL,
  analysis_data = NULL,
  analysis_mode = NULL,
  arm_selection = NULL,
  armsdropped = NULL,
  complete_data_analysis = NULL,
  current_week = NULL,
  execdata = NULL,
  final = NULL,
  fsimdata = NULL,
  fsimexp = NULL,
  fsimparam = NULL,
  interim = NULL,
  keepfiles = NULL,
  mcmc_num = NULL,
  noadapt = NULL,
  s2_aux_paramfile = NULL,
  stage = NULL,
  verbose = FALSE,
  version = NULL
)

run_engine_tte(
  param_files,
  n_sims = 1L,
  mode = c("s", "r", "p"),
  seed = NULL,
  analysis_data = NULL,
  analysis_mode = NULL,
  arm_selection = NULL,
  armsdropped = NULL,
  complete_data_analysis = NULL,
  current_week = NULL,
  execdata = NULL,
  final = NULL,
  fsimdata = NULL,
  fsimexp = NULL,
  fsimparam = NULL,
  interim = NULL,
  keepfiles = NULL,
  mcmc_num = NULL,
  noadapt = NULL,
  s2_aux_paramfile = NULL,
  stage = NULL,
  verbose = FALSE,
  version = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="facts_engines_+3A_param_files">param_files</code></td>
<td>
<p>Character vector of file paths or the output
of <code><a href="#topic+prep_param_files">prep_param_files()</a></code>. If a character vector, the elements
can be directories containing <code style="white-space: pre;">&#8288;*.param&#8288;</code> files or the paths to the
<code style="white-space: pre;">&#8288;*.param&#8288;</code> files themselves.
Such a directory is returned by <code><a href="#topic+run_flfll">run_flfll()</a></code>.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_n_sims">n_sims</code></td>
<td>
<p>Positive integer, number of simulations per param file.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_mode">mode</code></td>
<td>
<p>Character scalar: <code>"s"</code> for simulation mode in non-enrichment
designs, <code>""</code> for simulation mode in enrichment designs,
<code>"r"</code> for execution mode, and <code>"p"</code> for prediction mode.
For the CRM engine, <code>mode</code> needs to be <code>"s"</code> or <code>""</code>.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_seed">seed</code></td>
<td>
<p>Positive integer, random number generator seed for the
actual trial simulations. Use this <code>seed</code> argument instead of
<code>flfll_seed</code> (<code><a href="#topic+run_facts">run_facts()</a></code>, <code><a href="#topic+run_flfll">run_flfll()</a></code>) to control
pseudo-randomness in the actual trial simulations. <code>flfll_seed</code>
only controls how the <code style="white-space: pre;">&#8288;*.param&#8288;</code> files are generated.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_analysis_data">analysis_data</code></td>
<td>
<p>Character, analysis mode patient data file name.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_analysis_mode">analysis_mode</code></td>
<td>
<p>Logical, whether to activate analysis mode.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_current_week">current_week</code></td>
<td>
<p>Numeric, current time in weeks.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_execdata">execdata</code></td>
<td>
<p>Character, name of the execution mode patient file.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_final">final</code></td>
<td>
<p>Logical, whether to do the final analysis.
For execution mode only.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_interim">interim</code></td>
<td>
<p>Integer, interim number.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_mcmc_num">mcmc_num</code></td>
<td>
<p>Integer, MCMC file number. For analysis mode only.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to print progress information to the R
console.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_version">version</code></td>
<td>
<p>Character scalar, version of FACTS corresponding to the
FACTS file. Get by calling <code><a href="#topic+get_facts_version">get_facts_version()</a></code> on your FACTS file.
See possible versions with <code><a href="#topic+get_facts_versions">get_facts_versions()</a></code>.
Do not supply <code>version</code> to <code><a href="#topic+run_engine">run_engine()</a></code>. <code><a href="#topic+run_engine">run_engine()</a></code>
detects the version automatically from the FACTS file and
passes it to the appropriate engine function.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_arm_selection">arm_selection</code></td>
<td>
<p>Logical, whether to activate arm selection.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_armsdropped">armsdropped</code></td>
<td>
<p>Character, a comma-separated collection of integers
indicating dropped arms.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_complete_data_analysis">complete_data_analysis</code></td>
<td>
<p>Logical, whether to do a complete
data analysis.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_fsimdata">fsimdata</code></td>
<td>
<p>Character, prediction mode patient data file name.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_fsimexp">fsimexp</code></td>
<td>
<p>Logical. For expert use only.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_fsimparam">fsimparam</code></td>
<td>
<p>Character, name of the prediction mode <code style="white-space: pre;">&#8288;*.param&#8288;</code> file.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_keepfiles">keepfiles</code></td>
<td>
<p>Logical, whether to deactivate cleanup of
extraneous staged design files.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_noadapt">noadapt</code></td>
<td>
<p>Logical, whether to deactivate adaptive actions
in prediction mode.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_s2_aux_paramfile">s2_aux_paramfile</code></td>
<td>
<p>Character, name of the stage 2 execution
auxiliary <code style="white-space: pre;">&#8288;*.param&#8288;</code> file.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_stage">stage</code></td>
<td>
<p>Integer, trial design stage. For staged designs only.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_directory">directory</code></td>
<td>
<p>Character, working directory. CRM only.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_allocator">allocator</code></td>
<td>
<p>Logical, allocator/execution/recommender mode. CRM only.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_charting_info">charting_info</code></td>
<td>
<p>Logical, unused.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_estimator">estimator</code></td>
<td>
<p>Logical, use estimator. CRM only.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_force_cohort">force_cohort</code></td>
<td>
<p>Logical, whether to force small cohort run-in to end.
CRM only.</p>
</td></tr>
<tr><td><code id="facts_engines_+3A_reduced_priority">reduced_priority</code></td>
<td>
<p>Logical, whether to run at reduced priority.
CRM only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you need to repeatedly invoke an engine, as with most
trial execution mode workflows, these engine functions may be slow
on their own. To avoid the most severe sources of slowness,
consider running <code><a href="#topic+prep_param_files">prep_param_files()</a></code>
and then passing the result to one of the individual engine
functions (such as <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>).
</p>


<h3>Value</h3>

<p>Nothing.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_engine">run_engine()</a></code>, <code><a href="#topic+get_facts_file_example">get_facts_file_example()</a></code>,
<code><a href="#topic+get_facts_engine">get_facts_engine()</a></code>, <code><a href="#topic+run_facts">run_facts()</a></code>, <code><a href="#topic+run_flfll">run_flfll()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>facts_file &lt;- get_facts_file_example("contin.facts")
# Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
out &lt;- run_flfll(facts_file, verbose = FALSE) # Generate param files.
# Identify which engine you need.
get_facts_engine(facts_file)
# Run the sims with the engine function or `run_engine()`.
run_engine_contin(out, n_sims = 1, verbose = FALSE, version = "6.2.5")
read_patients(out)
}
</code></pre>

<hr>
<h2 id='facts_results'>Read trial simulation results</h2><span id='topic+facts_results'></span><span id='topic+read_patients'></span><span id='topic+read_weeks'></span><span id='topic+read_mcmc'></span><span id='topic+read_s1_mcmc'></span><span id='topic+read_s1_weeks'></span><span id='topic+read_s1_patients'></span><span id='topic+read_s2_patients'></span><span id='topic+read_s2_weeks'></span><span id='topic+read_s2_mcmc'></span><span id='topic+read_master_mcmc'></span><span id='topic+read_master_patients'></span><span id='topic+read_master_weeks'></span><span id='topic+read_cohorts'></span><span id='topic+read_simulations'></span><span id='topic+read_csv_special'></span>

<h3>Description</h3>

<p>These functions read trial simulation results. The results were
computed by FACTS (via <code><a href="#topic+run_facts">run_facts()</a></code> or <code><a href="#topic+run_engine">run_engine()</a></code> or
one of the engine functions such as <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>)
and are stored in CSV files. Different functions read different types
of output. The functions are named according to the CSV files they read.
For example, <code>read_patients()</code> reads all files named
<code>patients00001.csv</code>, <code>patients00002.csv</code>, etc. The most important
functions are <code>read_patients()</code> and <code>read_weeks()</code>.
The <code style="white-space: pre;">&#8288;read_s1*()&#8288;</code>, <code style="white-space: pre;">&#8288;read_s2*()&#8288;</code>, and <code style="white-space: pre;">&#8288;read_master*()&#8288;</code> functions
are for staged designs. The <code>read_csv_special()</code> function allows you to
supply a custom file name prefix such as &quot;patients&quot;,
but be warned: not every kind of CSV output file is tested in <code>rfacts</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_patients(csv_files)

read_weeks(csv_files)

read_mcmc(csv_files)

read_s1_mcmc(csv_files)

read_s1_weeks(csv_files)

read_s1_patients(csv_files)

read_s2_patients(csv_files)

read_s2_weeks(csv_files)

read_s2_mcmc(csv_files)

read_master_mcmc(csv_files)

read_master_patients(csv_files)

read_master_weeks(csv_files)

read_cohorts(csv_files)

read_simulations(csv_files)

read_csv_special(csv_files, prefix, numbered = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="facts_results_+3A_csv_files">csv_files</code></td>
<td>
<p>Character vector of file paths.
Either the directories containing the trial simulation
results or the actual CSV file files themselves.</p>
</td></tr>
<tr><td><code id="facts_results_+3A_prefix">prefix</code></td>
<td>
<p>Character, name of the prefix for <code>read_csv_special()</code>.
<code>read_weeks(x)</code> is equivalent to <code>read_csv_special(x, prefix = "weeks")</code>.
Be careful: not all kinds of CSV output are tested. We can only
guarantee the file types with special functions will be read
correctly, e.g. <code>read_patients()</code> and <code>read_weeks()</code>.</p>
</td></tr>
<tr><td><code id="facts_results_+3A_numbered">numbered</code></td>
<td>
<p>Logical. If <code>TRUE</code>,
only read the numbered files like <code>patients00001.csv</code>,
<code>weeks00017.csv</code>, etc. If <code>FALSE</code>, only list the non-numbered files
like <code>simulations.csv</code> and <code>simulations_freq_locf.csv</code>.
Avoid <code>summary.csv</code> files. They are not reliable on Linux.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of trial simulation data. Each <code style="white-space: pre;">&#8288;read_*()&#8288;</code> function
returns different information, but all the <code style="white-space: pre;">&#8288;read_*()&#8288;</code> functions
support the following columns:
</p>

<ul>
<li> <p><code>facts_file</code>: character, the base name of the FACTS file.
</p>
</li>
<li> <p><code>facts_scenario</code>: character, the name of the simulation scenario
from FACTS. Usually, this factors in the virtual subject response
(VSR) profile, accrual profile (how fast do patients enroll?)
and dropout profile (how fast do they drop out?).
</p>
</li>
<li> <p><code>facts_sim</code>: integer, numeric index of the CSV file name. For example,
the <code>facts_sim</code> of <code>patients00012.csv</code> is <code>12</code>. In trial execution mode,
all these indices are 00000, so <code>facts_id</code> is much
safer than <code>facts_sim</code> for packetized trial execution mode.
</p>
</li>
<li> <p><code>facts_id</code>: character, random unique id of each CSV file being read.
Different for every call to <code>read_patients()</code> etc.
Safer than <code>facts_sim</code> for aggregation over simulations.
</p>
</li>
<li> <p><code>facts_output</code>: character, type of output is in the data frame:
<code>"patients"</code> for patients files, <code>"weeks"</code> for weeks files,
<code>"mcmc"</code> for MCMC files, etc. These names adhere to established
conventions in FACTS.
</p>
</li>
<li> <p><code>facts_csv</code>: character, full path to the original CSV files where
FACTS stored the simulation output. Required for <code><a href="#topic+overwrite_csv_files">overwrite_csv_files()</a></code>.
</p>
</li>
<li> <p><code>facts_header</code>: a character vector of <code style="white-space: pre;">&#8288;\n&#8288;</code>-delimited CSV file headers.
Required for <code><a href="#topic+overwrite_csv_files">overwrite_csv_files()</a></code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+get_facts_file_example">get_facts_file_example()</a></code>, <code><a href="#topic+run_facts">run_facts()</a></code>, <code><a href="#topic+run_flfll">run_flfll()</a></code>,
<code><a href="#topic+run_engine">run_engine()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts")
out &lt;- run_facts(
  facts_file,
  n_sims = 4,
  verbose = FALSE
)
# What results files do we have?
head(get_csv_files(out))
# Read all the "patients*.csv" files with `read_patients(out)`.
# For each scenario, we have files named
# patients00001.csv, patients00002.csv, patients00003.csv,
# and patients00004.csv.
read_patients(out)
}
</code></pre>

<hr>
<h2 id='get_csv_files'>List FACTS-generated CSV files</h2><span id='topic+get_csv_files'></span>

<h3>Description</h3>

<p>List output CSV files in a directory or directories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_csv_files(csv_files, numbered = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_csv_files_+3A_csv_files">csv_files</code></td>
<td>
<p>Character vector of directories containing
numbered CSV files</p>
</td></tr>
<tr><td><code id="get_csv_files_+3A_numbered">numbered</code></td>
<td>
<p>Logical. If <code>TRUE</code>,
only list the numbered files like <code>patients00001.csv</code>,
<code>weeks00017.csv</code>, etc. If <code>FALSE</code>, only list the non-numbered files
like <code>simulations.csv</code> and <code>simulations_freq_locf.csv</code>.
Avoid <code>summary.csv</code> files. They are not reliable on Linux.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of names of CSV files.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>facts_file &lt;- get_facts_file_example("contin.facts")
# Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
out &lt;- run_facts(
  facts_file,
  n_sims = 2L,
  verbose = FALSE
)
get_csv_files(out)
}
</code></pre>

<hr>
<h2 id='get_facts_engine'>Get the FACTS engine function matching your FACTS file</h2><span id='topic+get_facts_engine'></span>

<h3>Description</h3>

<p>Identify the correct <code style="white-space: pre;">&#8288;run_engine_*()&#8288;</code> function
for your FACTS file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_facts_engine(facts_file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_facts_engine_+3A_facts_file">facts_file</code></td>
<td>
<p>Character, name of a FACTS file.
Usually has a <code style="white-space: pre;">&#8288;*.facts&#8288;</code> file extension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For most cases, it is sufficient to call <code><a href="#topic+run_facts">run_facts()</a></code>,
or to call <code><a href="#topic+run_flfll">run_flfll()</a></code> followed by <code><a href="#topic+run_engine">run_engine()</a></code>. But either way,
you will need to know the arguments of the <code style="white-space: pre;">&#8288;run_engine_*()&#8288;</code> function
that corresponds to your FACTS file. Even if you are not calling this
<code style="white-space: pre;">&#8288;run_engine_*()&#8288;</code> directly, you will need to pass the arguments to <code>...</code>
in <code><a href="#topic+run_facts">run_facts()</a></code> or <code><a href="#topic+run_engine">run_engine()</a></code>. <code>get_facts_engine()</code>
identifies the correct <code style="white-space: pre;">&#8288;run_engine_*()&#8288;</code> function so you can open the
help file and read about the arguments, e.g. <code>?run_engine_contin</code>.
</p>


<h3>Value</h3>

<p>Character, the name of a FACTS engine function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_facts">run_facts()</a></code>, <code><a href="#topic+run_engine">run_engine()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts")
out &lt;- run_flfll(facts_file, verbose = FALSE) # Generate param files.
# Find the appropriate FACTS engine function.
get_facts_engine(facts_file)
# Read about the function arguments.
# You can pass these arguments to `...` in `run_facts()`
# or `run_engine()` or just call `run_engine_contin()` directly.
# ?run_engine_contin
# Call the FACTS engine function to run simulations.
# Alternatively, you could just call `run_engine()`.
run_engine_contin(out, n_sims = 1, verbose = FALSE, version = "6.2.5")
# See the results.
read_patients(out)
}
</code></pre>

<hr>
<h2 id='get_facts_file_example'>Locate an example FACTS file</h2><span id='topic+get_facts_file_example'></span>

<h3>Description</h3>

<p>Get the path to an example FACTS file inside rfacts itself.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_facts_file_example(facts_file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_facts_file_example_+3A_facts_file">facts_file</code></td>
<td>
<p>Character, name of a FACTS file.
Usually has a <code style="white-space: pre;">&#8288;*.facts&#8288;</code> file extension.
Does not include the directory name.
Possible choices:
</p>

<ul>
<li><p> &quot;aipf_contin.facts&quot; - Enrichment continuous.
</p>
</li>
<li><p> &quot;aipf_dichot.facts&quot; - Enrichment dichotomous.
</p>
</li>
<li><p> &quot;aipf_tte.facts&quot; - Enrichment time to event.
</p>
</li>
<li><p> &quot;broken.facts&quot; - A broken FACTS file.
</p>
</li>
<li><p> &quot;contin.facts&quot; - Core continuous.
</p>
</li>
<li><p> &quot;crm.facts&quot; - N-CRM design.
</p>
</li>
<li><p> &quot;dichot.facts&quot; - Core dichotomous.
</p>
</li>
<li><p> &quot;multep.facts&quot; - Multiple endpoints.
</p>
</li>
<li><p> &quot;staged.facts&quot; - Staged design.
</p>
</li>
<li><p> &quot;tte.facts&quot; - Time to event.
</p>
</li>
<li><p> &quot;unsupported.facts&quot; - FACTS file with an unsupported engine type.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>rfacts</code> package comes with some example FACTS files.
Use the <code>get_facts_file_example()</code> function to get the full path
to an example FACTS file. Use this file to try out <code><a href="#topic+run_flfll">run_flfll()</a></code>,
<code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>, etc.
</p>


<h3>Value</h3>

<p>Character, the path to a FACTS file included with <code>rfacts</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_facts">run_facts()</a></code>, <code><a href="#topic+run_flfll">run_flfll()</a></code>, <code><a href="#topic+run_engine">run_engine()</a></code>, <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts")
facts_file
out &lt;- run_facts(
  facts_file,
  n_sims = 1,
  verbose = FALSE
)
read_patients(out)
}
</code></pre>

<hr>
<h2 id='get_facts_scenarios'>List the names of simulation scenarios</h2><span id='topic+get_facts_scenarios'></span>

<h3>Description</h3>

<p>Get the names of the simulation scenarios of a FACTS file.
without actually running any simulations.
These names usually come from the virtual subject response (VSR)
scenarios, the accrual profiles, and the dropout profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_facts_scenarios(facts_file, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_facts_scenarios_+3A_facts_file">facts_file</code></td>
<td>
<p>Character, name of a FACTS file.
Usually has a <code style="white-space: pre;">&#8288;*.facts&#8288;</code> file extension.</p>
</td></tr>
<tr><td><code id="get_facts_scenarios_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to print progress to the R console.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of FACTS simulation scenarios.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_param_dirs">get_param_dirs()</a></code>, <code><a href="#topic+run_facts">run_facts()</a></code>, <code><a href="#topic+run_flfll">run_flfll()</a></code>,
<code><a href="#topic+run_engine">run_engine()</a></code>, <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts")
get_facts_scenarios(facts_file)
}
</code></pre>

<hr>
<h2 id='get_facts_version'>Get FACTS version matching your FACTS file</h2><span id='topic+get_facts_version'></span>

<h3>Description</h3>

<p>Get the version of FACTS compatible with
your <code style="white-space: pre;">&#8288;*.facts&#8288;</code> file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_facts_version(facts_file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_facts_version_+3A_facts_file">facts_file</code></td>
<td>
<p>Character, name of a FACTS file.
Usually has a <code style="white-space: pre;">&#8288;*.facts&#8288;</code> file extension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A version string.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_facts_versions">get_facts_versions()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>facts_file &lt;- get_facts_file_example("contin.facts")
facts_file
get_facts_version(facts_file)
</code></pre>

<hr>
<h2 id='get_facts_versions'>List supported FACTS versions</h2><span id='topic+get_facts_versions'></span>

<h3>Description</h3>

<p>List versions of FACTS supported by <code>rfacts</code>.
You can supply any of these versions to functions engine-specific
functions such as <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_facts_versions()
</code></pre>


<h3>Details</h3>

<p>If your FACTS file does not perfectly agree
with one of the supported versions, <code>rfacts</code> will try to find
the best version for you, either
</p>

<ol>
<li><p> The greatest supported version less than or equal to the
one in the FACTS file, or
</p>
</li>
<li><p> The lowest supported version if (1) does not exist.
</p>
</li></ol>



<h3>Value</h3>

<p>A character vector of supported FACTS versions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_facts_version">get_facts_version()</a></code>, <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
get_facts_versions()
}
</code></pre>

<hr>
<h2 id='get_param_dirs'>List the directories containing param files</h2><span id='topic+get_param_dirs'></span>

<h3>Description</h3>

<p>Get the directory paths containing param files.
This helps us run FACTS simulation scenarios one at a time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_param_dirs(param_files)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_param_dirs_+3A_param_files">param_files</code></td>
<td>
<p>Character, path to a top-level
directory containing param files. <code><a href="#topic+run_flfll">run_flfll()</a></code> and <code><a href="#topic+run_facts">run_facts()</a></code>
return paths you can supply to <code>param_files</code> in <code>get_param_dirs()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When you run <code><a href="#topic+run_flfll">run_flfll()</a></code> or <code><a href="#topic+run_facts">run_facts()</a></code>, <code>rfacts</code>
creates a directory. This directory has a bunch of
subdirectories, each corresponding to a single simulation scenario
(VSR profile x accrual profile x dropout profile, etc).
</p>


<h3>Value</h3>

<p>Character vector of FACTS simulation scenario directories.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_facts_scenarios">get_facts_scenarios()</a></code>, <code><a href="#topic+run_facts">run_facts()</a></code>, <code><a href="#topic+run_flfll">run_flfll()</a></code>,
<code><a href="#topic+run_engine">run_engine()</a></code>, <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts")
param_files &lt;- run_flfll(facts_file, verbose = FALSE)
scenarios &lt;- get_param_dirs(param_files)
scenarios
scenario &lt;- scenarios[1]
run_engine_contin(scenario, n_sims = 2, verbose = FALSE, version = "6.2.5")
read_patients(scenario)
}
</code></pre>

<hr>
<h2 id='get_param_files'>List the paths to the param files</h2><span id='topic+get_param_files'></span>

<h3>Description</h3>

<p>List the paths to the all the param files
in a directory or directories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_param_files(param_files)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_param_files_+3A_param_files">param_files</code></td>
<td>
<p>Character vector of directories containing param files.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of paths to param files.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts")
dir &lt;- run_flfll(facts_file, verbose = FALSE)
get_param_files(dir)
}
</code></pre>

<hr>
<h2 id='overwrite_csv_files'>Overwrite FACTS CSV output files</h2><span id='topic+overwrite_csv_files'></span>

<h3>Description</h3>

<p><code><a href="#topic+read_patients">read_patients()</a></code> and friends read
CSV output files from FACTS and return special aggregated data frames.
<code>overwite_csv_files()</code> accepts such an aggregated data frame
and writes the content to the original CSV files it came from.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>overwrite_csv_files(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="overwrite_csv_files_+3A_x">x</code></td>
<td>
<p>An aggregated data frame from <code><a href="#topic+read_patients">read_patients()</a></code>
or similar function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>facts_file &lt;- get_facts_file_example("contin.facts")
# Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
out &lt;- run_facts(facts_file, n_sims = 2)
pats &lt;- read_patients(out)
head(pats$visit_1)
pats$visit_1 &lt;- 0
overwrite_csv_files(pats)
pats2 &lt;- read_patients(out)
head(pats2$visit_1)
}
</code></pre>

<hr>
<h2 id='prep_param_files'>Arrange the param files for the engines ahead of time.</h2><span id='topic+prep_param_files'></span>

<h3>Description</h3>

<p>If you call <code>prep_param_files()</code> ahead of time, subsequent calls
to the engines will initialize much faster. This is useful in situations
like trial execution mode, which require calling an engine function
on each new simulation. This function does not actually modify
the param files themselves on disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_param_files(param_files)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prep_param_files_+3A_param_files">param_files</code></td>
<td>
<p>A character vector of param files and/or directories
containing param files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>prep_param_files()</code> searches for the required <code style="white-space: pre;">&#8288;*.param&#8288;</code> files
groups them by directory, sorts them, and returns the result
as a list of special <code>param_files</code> objects.
(It does not modify the actual contents of the <code style="white-space: pre;">&#8288;*.param`` files.) This preprocessing step is fast when executed once, but slow when executed thousands of times. So if you need to call a &#8288;</code>run_engine_*()<code style="white-space: pre;">&#8288;function repeatedly, consider passing it an object from&#8288;</code>prep_param_files()'.
</p>


<h3>Value</h3>

<p>A list of special <code>"params_files"</code> objects
that the engine functions can process fast.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_flfll">run_flfll()</a></code>, <code><a href="#topic+run_engine">run_engine()</a></code>, <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts")
out &lt;- run_flfll(facts_file, verbose = FALSE)
param_files &lt;- prep_param_files(out) # For speed.
param_files # Shows where the param files live and how they are organized.
run_engine_contin(
  param_files,
  n_sims = 2,
  verbose = FALSE,
  version = "6.2.5"
)
# Slower: run_engine_contin(out, n_sims = 2, verbose = FALSE) # nolint
}
</code></pre>

<hr>
<h2 id='read_facts'>Read parts of FACTS files.</h2><span id='topic+read_facts'></span>

<h3>Description</h3>

<p>Read specific fields of a FACTS file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_facts(facts_file, fields)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_facts_+3A_facts_file">facts_file</code></td>
<td>
<p>Character of length 1, path to FACTS XML file to read.</p>
</td></tr>
<tr><td><code id="read_facts_+3A_fields">fields</code></td>
<td>
<p>Data frame defining the kind of XML data to be read.
It must have one row per field definition and the following columns:
</p>

<ol>
<li> <p><code>field</code>: custom name of the field.
</p>
</li>
<li> <p><code>type</code>: value of the &quot;type&quot; attribute of the <code style="white-space: pre;">&#8288;&lt;parameterSets&gt;&#8288;</code> tag.
</p>
</li>
<li> <p><code>set</code>: value of the &quot;name&quot; attribute of the <code style="white-space: pre;">&#8288;&lt;parameterSet&gt;&#8288;</code> tag.
</p>
</li>
<li> <p><code>property</code>: value of the &quot;name&quot; attribute of the <code style="white-space: pre;">&#8288;&lt;property&gt;&#8288;</code> tag.
</p>
</li></ol>
</td></tr>
</table>


<h3>Details</h3>

<p>A FACTS file has a special kind of XML format.
Most of the content sits in an overarching <code style="white-space: pre;">&#8288;&lt;facts&gt;&#8288;</code> tag,
then a <code style="white-space: pre;">&#8288;&lt;parameterSets&gt;&#8288;</code> tag, then a
<code style="white-space: pre;">&#8288;&lt;parameterSet&gt;&#8288;</code> tag, then a <code style="white-space: pre;">&#8288;&lt;property&gt;&#8288;</code> tag.
For example, here is the part of a FACTS file that controls
the weeks between interims.
</p>
<div class="sourceCode xml"><pre>&lt;facts&gt;
  &lt;parameterSets type="NucleusParameterSet"&gt;
    &lt;parameterSet name="nucleus"&gt;
      &lt;property name="update_freq_save"&gt;4&lt;/property&gt;
</pre></div>
<p>To use the <code>read_facts()</code> function, you must first identify
the parts of the FACTS file you want to read using the <code>fields</code> argument.
To read the above part of the XML, you would first define the
<code>update_freq_save</code> field.
</p>
<div class="sourceCode r"><pre>fields &lt;- tibble::tibble(
  field = "my_interval",
  type = "NucleusParameterSet",
  set = "nucleus",
  property = "update_freq_save"
)
</pre></div>
<p>and then call <code>read_facts(input = "your_file.facts", fields = fields)</code>.
</p>


<h3>Value</h3>

<p>A one-row <code>tibble</code> with the requested fields from the FACTS file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>facts_file &lt;- get_facts_file_example("contin.facts")
fields &lt;- data.frame(
  field = c("my_subjects", "my_vsr"),
  type = c("NucleusParameterSet", "EfficacyParameterSet"),
  set = c("nucleus", "resp2"),
  property = c("max_subjects", "true_endpoint_response")
)
read_facts(facts_file = facts_file, fields = fields)
</code></pre>

<hr>
<h2 id='reset_rfacts_paths'>Reset system dependency info</h2><span id='topic+reset_rfacts_paths'></span>

<h3>Description</h3>

<p>Reset system dependency information
based on the current value of the <code>RFACTS_PATHS</code>
environment variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reset_rfacts_paths()
</code></pre>


<h3>Dependencies</h3>

<p><code>rfacts</code> has strict system requirements, and the installations
vary from system to system. You need to specify the locations of
system executables in a CSV file that lists the path and metadata
of each executable. This file must have one row per executable
and the following columns.
</p>

<ul>
<li> <p><code>executable_type</code>: Must be &quot;mono&quot;, &quot;flfll&quot;, or &quot;engine&quot; to
denote the general type of the executable.
</p>
</li>
<li> <p><code>facts_version</code>: The version of FACTS with which this executable
is compatible.
</p>
</li>
<li> <p><code>path</code>: File path to the executable.
</p>
</li>
<li> <p><code>engine_name</code>: For engines only. Name of the engine.
Must be one of the engine types in the example CSV file at
<code>system.file("example_paths.csv", package = "rfacts")</code>.
</p>
</li>
<li> <p><code>param_set</code>: For engines only. Parameter set designation listed in the
XML code of FACTS files for that engine. See
<code>system.file("example_paths.csv", package = "rfacts")</code>
for examples.
</p>
</li>
<li> <p><code>param_type</code>: For engines only. Parameter type designation listed in the
XML code of FACTS files for that engine. See
<code>system.file("example_paths.csv", package = "rfacts")</code>
for examples.
</p>
</li></ul>

<p>When you call a trial simulation function in <code>rfacts</code>,
the package automatically reads this file
and memorizes the contents for later use. The file at
<code>system.file("example_paths.csv", package = "rfacts")</code>
(<code>inst/example_paths.csv</code> in the package source.)
has an example of such a file. All the columns in that file
are required, and you may, remove, or modify rows to fit
your specific system.
</p>
<p>To enable <code>rfacts</code> to find this CSV file, you need to
set the <code>RFACTS_PATHS</code> environment variable to the
path to this file. The easiest way to do this is call
<code>usethis::edit_r_environ()</code> to edit your <code>.Renviron</code> file
and then add a new line with something like
<code style="white-space: pre;">&#8288;RFACTS_PATHS=/path/to/file/paths.csv&#8288;</code>. Then,
restart your R session and call <code>Sys.getenv("RFACTS_PATHS")</code>
to verify that this environment variable was set correctly.
</p>
<p>The <code>rfacts_sitrep()</code> function inspects the current system dependency
info and ensures each executable exists and has the correct permissions.
</p>
<p>If you change the <code>RFACTS_PATHS</code> environment variable,
you need to call <code><a href="#topic+reset_rfacts_paths">reset_rfacts_paths()</a></code> or restart R
for the changes to take effect.
</p>


<h3>See Also</h3>

<p>rfacts_paths, rfacts_sitrep
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
reset_rfacts_paths()
}
</code></pre>

<hr>
<h2 id='rfacts_paths'>Read paths to rfacts system dependencies</h2><span id='topic+rfacts_paths'></span>

<h3>Description</h3>

<p>Read the file specified by the <code>RFACTS_PATHS</code>
environment variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rfacts_paths()
</code></pre>


<h3>Value</h3>

<p>A data frame with paths and other metadata about <code>rfacts</code>
system dependencies
</p>


<h3>Dependencies</h3>

<p><code>rfacts</code> has strict system requirements, and the installations
vary from system to system. You need to specify the locations of
system executables in a CSV file that lists the path and metadata
of each executable. This file must have one row per executable
and the following columns.
</p>

<ul>
<li> <p><code>executable_type</code>: Must be &quot;mono&quot;, &quot;flfll&quot;, or &quot;engine&quot; to
denote the general type of the executable.
</p>
</li>
<li> <p><code>facts_version</code>: The version of FACTS with which this executable
is compatible.
</p>
</li>
<li> <p><code>path</code>: File path to the executable.
</p>
</li>
<li> <p><code>engine_name</code>: For engines only. Name of the engine.
Must be one of the engine types in the example CSV file at
<code>system.file("example_paths.csv", package = "rfacts")</code>.
</p>
</li>
<li> <p><code>param_set</code>: For engines only. Parameter set designation listed in the
XML code of FACTS files for that engine. See
<code>system.file("example_paths.csv", package = "rfacts")</code>
for examples.
</p>
</li>
<li> <p><code>param_type</code>: For engines only. Parameter type designation listed in the
XML code of FACTS files for that engine. See
<code>system.file("example_paths.csv", package = "rfacts")</code>
for examples.
</p>
</li></ul>

<p>When you call a trial simulation function in <code>rfacts</code>,
the package automatically reads this file
and memorizes the contents for later use. The file at
<code>system.file("example_paths.csv", package = "rfacts")</code>
(<code>inst/example_paths.csv</code> in the package source.)
has an example of such a file. All the columns in that file
are required, and you may, remove, or modify rows to fit
your specific system.
</p>
<p>To enable <code>rfacts</code> to find this CSV file, you need to
set the <code>RFACTS_PATHS</code> environment variable to the
path to this file. The easiest way to do this is call
<code>usethis::edit_r_environ()</code> to edit your <code>.Renviron</code> file
and then add a new line with something like
<code style="white-space: pre;">&#8288;RFACTS_PATHS=/path/to/file/paths.csv&#8288;</code>. Then,
restart your R session and call <code>Sys.getenv("RFACTS_PATHS")</code>
to verify that this environment variable was set correctly.
</p>
<p>The <code>rfacts_sitrep()</code> function inspects the current system dependency
info and ensures each executable exists and has the correct permissions.
</p>
<p>If you change the <code>RFACTS_PATHS</code> environment variable,
you need to call <code><a href="#topic+reset_rfacts_paths">reset_rfacts_paths()</a></code> or restart R
for the changes to take effect.
</p>


<h3>See Also</h3>

<p>rfacts_sitrep
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
rfacts_paths()
}
</code></pre>

<hr>
<h2 id='rfacts_sitrep'>Check configuration of system dependencies</h2><span id='topic+rfacts_sitrep'></span>

<h3>Description</h3>

<p>Examine the file paths to executables and check
that they exist and have the correct permissions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rfacts_sitrep()
</code></pre>


<h3>Value</h3>

<p>A data frame of information on the status of each executable.
</p>


<h3>Dependencies</h3>

<p><code>rfacts</code> has strict system requirements, and the installations
vary from system to system. You need to specify the locations of
system executables in a CSV file that lists the path and metadata
of each executable. This file must have one row per executable
and the following columns.
</p>

<ul>
<li> <p><code>executable_type</code>: Must be &quot;mono&quot;, &quot;flfll&quot;, or &quot;engine&quot; to
denote the general type of the executable.
</p>
</li>
<li> <p><code>facts_version</code>: The version of FACTS with which this executable
is compatible.
</p>
</li>
<li> <p><code>path</code>: File path to the executable.
</p>
</li>
<li> <p><code>engine_name</code>: For engines only. Name of the engine.
Must be one of the engine types in the example CSV file at
<code>system.file("example_paths.csv", package = "rfacts")</code>.
</p>
</li>
<li> <p><code>param_set</code>: For engines only. Parameter set designation listed in the
XML code of FACTS files for that engine. See
<code>system.file("example_paths.csv", package = "rfacts")</code>
for examples.
</p>
</li>
<li> <p><code>param_type</code>: For engines only. Parameter type designation listed in the
XML code of FACTS files for that engine. See
<code>system.file("example_paths.csv", package = "rfacts")</code>
for examples.
</p>
</li></ul>

<p>When you call a trial simulation function in <code>rfacts</code>,
the package automatically reads this file
and memorizes the contents for later use. The file at
<code>system.file("example_paths.csv", package = "rfacts")</code>
(<code>inst/example_paths.csv</code> in the package source.)
has an example of such a file. All the columns in that file
are required, and you may, remove, or modify rows to fit
your specific system.
</p>
<p>To enable <code>rfacts</code> to find this CSV file, you need to
set the <code>RFACTS_PATHS</code> environment variable to the
path to this file. The easiest way to do this is call
<code>usethis::edit_r_environ()</code> to edit your <code>.Renviron</code> file
and then add a new line with something like
<code style="white-space: pre;">&#8288;RFACTS_PATHS=/path/to/file/paths.csv&#8288;</code>. Then,
restart your R session and call <code>Sys.getenv("RFACTS_PATHS")</code>
to verify that this environment variable was set correctly.
</p>
<p>The <code>rfacts_sitrep()</code> function inspects the current system dependency
info and ensures each executable exists and has the correct permissions.
</p>
<p>If you change the <code>RFACTS_PATHS</code> environment variable,
you need to call <code><a href="#topic+reset_rfacts_paths">reset_rfacts_paths()</a></code> or restart R
for the changes to take effect.
</p>


<h3>See Also</h3>

<p>rfacts_paths
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
rfacts_sitrep()
}
</code></pre>

<hr>
<h2 id='run_engine'>Run trial simulations</h2><span id='topic+run_engine'></span>

<h3>Description</h3>

<p>For fine control over trial simulations,
you must first call <code><a href="#topic+run_flfll">run_flfll()</a></code> and then call either <code><a href="#topic+run_engine">run_engine()</a></code>
or one of the specific engine functions (such as <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>).
The engines read the <code style="white-space: pre;">&#8288;*.param&#8288;</code> files generated by
<code><a href="#topic+run_flfll">run_flfll()</a></code>, run the trial simulations, and save output
to a bunch of CSV files. You can find these CSV output files next to
the <code style="white-space: pre;">&#8288;*.param&#8288;</code> files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_engine(facts_file, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_engine_+3A_facts_file">facts_file</code></td>
<td>
<p>Character, name of a FACTS file.
Usually has a <code style="white-space: pre;">&#8288;*.facts&#8288;</code> file extension.</p>
</td></tr>
<tr><td><code id="run_engine_+3A_...">...</code></td>
<td>
<p>Named arguments to the appropriate inner engine function,
such as <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>. Use <code><a href="#topic+get_facts_engine">get_facts_engine()</a></code>
to identify the appropriate engine function for your FACTS file.
Then, open the help file of that function to read about the arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you need to repeatedly invoke an engine, as with most
trial execution mode workflows, <code><a href="#topic+run_engine">run_engine()</a></code> is slow.
Instead, consider running <code><a href="#topic+prep_param_files">prep_param_files()</a></code>
and then passing the result to one of the individual engine
functions (such as <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>).
</p>


<h3>Value</h3>

<p>Nothing.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_facts_file_example">get_facts_file_example()</a></code>, <code><a href="#topic+run_flfll">run_flfll()</a></code>,
<code><a href="#topic+get_facts_engine">get_facts_engine()</a></code>, <code><a href="#topic+prep_param_files">prep_param_files()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts") # example FACTS file
out &lt;- run_flfll(facts_file, verbose = FALSE) # Generate param files.
# Run the simulations.
run_engine(
  facts_file,
  param_files = out,
  n_sims = 1,
  verbose = FALSE
)
read_patients(out)
}
</code></pre>

<hr>
<h2 id='run_facts'>Run FACTS</h2><span id='topic+run_facts'></span>

<h3>Description</h3>

<p>Run FACTS trial simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_facts(
  facts_file,
  output_path = tempfile(),
  log_path = output_path,
  n_burn = NULL,
  n_mcmc = NULL,
  n_weeks_files = 10000,
  n_patients_files = 10000,
  n_mcmc_files = 0,
  n_mcmc_thin = NULL,
  flfll_seed = NULL,
  flfll_offset = NULL,
  n_sims,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_facts_+3A_facts_file">facts_file</code></td>
<td>
<p>Character, name of a FACTS file.
Usually has a <code style="white-space: pre;">&#8288;*.facts&#8288;</code> file extension.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_output_path">output_path</code></td>
<td>
<p>Character, directory path to the files to generate.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_log_path">log_path</code></td>
<td>
<p>Character, path to the log file generated by FLFLL.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_n_burn">n_burn</code></td>
<td>
<p>Number of burn-in iterations for the MCMC.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_n_mcmc">n_mcmc</code></td>
<td>
<p>Number of MCMC iterations used in inference.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_n_weeks_files">n_weeks_files</code></td>
<td>
<p>Number of <code>weeks*.csv</code> files to save in <code>output_path</code>.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_n_patients_files">n_patients_files</code></td>
<td>
<p>Number of <code>patients*.csv</code> files to save in
<code>output_path</code>.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_n_mcmc_files">n_mcmc_files</code></td>
<td>
<p>Number of <code>mcmc*.csv</code> files to save in
<code>output_path</code>.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_n_mcmc_thin">n_mcmc_thin</code></td>
<td>
<p>Number of thinning iterations for the MCMC.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_flfll_seed">flfll_seed</code></td>
<td>
<p>Positive integer, random number generator seed for FLFLL.
This seed is only used for stochastic preprocessing steps for generating
the <code style="white-space: pre;">&#8288;*.param&#8288;</code> files. It is not the random number generator seed
for the actual trial simulations. To set the trial simulation seed,
use the <code>seed</code> argument of <code><a href="#topic+run_facts">run_facts()</a></code>, <code><a href="#topic+run_engine">run_engine()</a></code>, or
one of the specific <code style="white-space: pre;">&#8288;run_engine*()&#8288;</code> functions.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_flfll_offset">flfll_offset</code></td>
<td>
<p>Integer, offset for the random number generator.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_n_sims">n_sims</code></td>
<td>
<p>Positive integer, number of simulations per param file.</p>
</td></tr>
<tr><td><code id="run_facts_+3A_...">...</code></td>
<td>
<p>Named arguments to the appropriate FACTS engine function.
Use <code><a href="#topic+get_facts_engine">get_facts_engine()</a></code> to identify the appropriate
engine function and then open the help file of that function to read
about the arguments, e.g. <code>?run_engine_contin</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+run_facts">run_facts()</a></code> calls <code><a href="#topic+run_flfll">run_flfll()</a></code> and then <code><a href="#topic+run_engine">run_engine()</a></code>.
For finer control over trial simulation, you can call these
latter two functions individually.
</p>


<h3>Value</h3>

<p>Character, path to the directory with FACTS output.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_flfll">run_flfll()</a></code>, <code><a href="#topic+run_engine">run_engine()</a></code>, <code><a href="#topic+get_facts_engine">get_facts_engine()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts") # example FACTS file
out &lt;- run_facts(
  facts_file,
  n_sims = 4,
  verbose = FALSE
)
# What results files do we have?
head(get_csv_files(out))
# Read all the "patients*.csv" files with `read_patients(out)`.
# For each scenario, we have files named
# patients00001.csv, patients00002.csv, patients00003.csv,
# and patients00004.csv.
read_patients(out)
}
</code></pre>

<hr>
<h2 id='run_flfll'>Generate param files to prepare for trial simulations</h2><span id='topic+run_flfll'></span>

<h3>Description</h3>

<p>Generate the preparatory files required for simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_flfll(
  facts_file,
  output_path = tempfile(),
  log_path = output_path,
  n_burn = NULL,
  n_mcmc = NULL,
  n_weeks_files = 10000,
  n_patients_files = 10000,
  n_mcmc_files = 0,
  n_mcmc_thin = NULL,
  flfll_seed = NULL,
  flfll_offset = NULL,
  verbose = FALSE,
  max_sims = 99999L
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_flfll_+3A_facts_file">facts_file</code></td>
<td>
<p>Character, name of a FACTS file.
Usually has a <code style="white-space: pre;">&#8288;*.facts&#8288;</code> file extension.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_output_path">output_path</code></td>
<td>
<p>Character, directory path to the files to generate.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_log_path">log_path</code></td>
<td>
<p>Character, path to the log file generated by FLFLL.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_n_burn">n_burn</code></td>
<td>
<p>Number of burn-in iterations for the MCMC.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_n_mcmc">n_mcmc</code></td>
<td>
<p>Number of MCMC iterations used in inference.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_n_weeks_files">n_weeks_files</code></td>
<td>
<p>Number of <code>weeks*.csv</code> files to save in <code>output_path</code>.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_n_patients_files">n_patients_files</code></td>
<td>
<p>Number of <code>patients*.csv</code> files to save in
<code>output_path</code>.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_n_mcmc_files">n_mcmc_files</code></td>
<td>
<p>Number of <code>mcmc*.csv</code> files to save in
<code>output_path</code>.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_n_mcmc_thin">n_mcmc_thin</code></td>
<td>
<p>Number of thinning iterations for the MCMC.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_flfll_seed">flfll_seed</code></td>
<td>
<p>Positive integer, random number generator seed for FLFLL.
This seed is only used for stochastic preprocessing steps for generating
the <code style="white-space: pre;">&#8288;*.param&#8288;</code> files. It is not the random number generator seed
for the actual trial simulations. To set the trial simulation seed,
use the <code>seed</code> argument of <code><a href="#topic+run_facts">run_facts()</a></code>, <code><a href="#topic+run_engine">run_engine()</a></code>, or
one of the specific <code style="white-space: pre;">&#8288;run_engine*()&#8288;</code> functions.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_flfll_offset">flfll_offset</code></td>
<td>
<p>Integer, offset for the random number generator.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to print progress information to the
R console.</p>
</td></tr>
<tr><td><code id="run_flfll_+3A_max_sims">max_sims</code></td>
<td>
<p>Positive integer of length 1, maximum number of simulations
that will be allowed to run for certain engines like CRM
in subsequent calls to the engine. If the <code>n_sims</code> argument
of the engine is larger than <code>max_sims</code>, only <code>max_sims</code>
simulations will be run. The <code>max_sims</code> argument
only applies to FLFLL &gt;= 6.4.1
and only needs to be set manually if you are manually calling
<code>run_flfll()</code> and then the engine instead of just <code><a href="#topic+run_facts">run_facts()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For advanced control over trial simulations, you must first call
<code><a href="#topic+run_flfll">run_flfll()</a></code> and then call one of the engine functions
such as <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>.
<code><a href="#topic+run_flfll">run_flfll()</a></code> generates the preparatory <code style="white-space: pre;">&#8288;*.param&#8288;</code> files that the
<code style="white-space: pre;">&#8288;run_engine_*()&#8288;</code> functions understand.
You will pass these <code style="white-space: pre;">&#8288;*.param&#8288;</code> files or their parent
directory to <code>param_files</code> argument of <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code> etc.
</p>


<h3>Value</h3>

<p>Character, the value of <code>output_path</code>.
<code>output_path</code> is the directory path to the files generated by
<code>run_flfll()</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_facts_file_example">get_facts_file_example()</a></code>, <code><a href="#topic+run_engine">run_engine()</a></code>, <code><a href="#topic+run_engine_contin">run_engine_contin()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Can only run if system dependencies are configured:
if (file.exists(Sys.getenv("RFACTS_PATHS"))) {
facts_file &lt;- get_facts_file_example("contin.facts") # example FACTS file
out &lt;- run_flfll(facts_file, verbose = FALSE) # Generate param files.
# Run the simulations.
run_engine(
  facts_file,
  param_files = out,
  n_sims = 1,
  verbose = FALSE
)
read_patients(out)
}
</code></pre>

<hr>
<h2 id='write_facts'>Write modified FACTS files.</h2><span id='topic+write_facts'></span>

<h3>Description</h3>

<p>Write modified versions of existing FACTS files.
This function can be used to tweak properties of a FACTS file
such as maximum sample size, number of weeks between interims,
allocation ratios, data generation parameters,
and analysis priors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_facts(fields, values, default_dir = "_facts")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_facts_+3A_fields">fields</code></td>
<td>
<p>Data frame defining the kind of XML data to be replaced.
It must have one row per field definition and the following columns:
</p>

<ol>
<li> <p><code>field</code>: custom name of the field.
</p>
</li>
<li> <p><code>type</code>: value of the &quot;type&quot; attribute of the <code style="white-space: pre;">&#8288;&lt;parameterSets&gt;&#8288;</code> tag.
</p>
</li>
<li> <p><code>set</code>: value of the &quot;name&quot; attribute of the <code style="white-space: pre;">&#8288;&lt;parameterSet&gt;&#8288;</code> tag.
</p>
</li>
<li> <p><code>property</code>: value of the &quot;name&quot; attribute of the <code style="white-space: pre;">&#8288;&lt;property&gt;&#8288;</code> tag.
</p>
</li></ol>
</td></tr>
<tr><td><code id="write_facts_+3A_values">values</code></td>
<td>
<p>Data frame defining the FACTS files to generate.
Must have one row per FACTS file and a column called <code>facts_file</code>
with the names of the input FACTS files. An <code>output</code> column with the
names of the output FACTS files is recommended but not required.
(If <code>output</code> is not specified, the output FACTS files will be
written to automatically generated paths inside <code>default_dir</code>.)
Other columns must have names corresponding to elements of <code>fields$field</code>
and contain values to insert into the FACTS files. These columns could
be vectors or lists of vectors. In the former case, each element
is a scalar replacement to a property. In the latter case,
an XML property receives an entire vector as an item list,
and the vector must be the same length as the original item list.</p>
</td></tr>
<tr><td><code id="write_facts_+3A_default_dir">default_dir</code></td>
<td>
<p>Directory to write the output FACTS files
if <code>values</code> has no <code>output</code> column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A FACTS file has a special kind of XML format.
Most of the content sits in an overarching <code style="white-space: pre;">&#8288;&lt;facts&gt;&#8288;</code> tag,
then a <code style="white-space: pre;">&#8288;&lt;parameterSets&gt;&#8288;</code> tag, then a
<code style="white-space: pre;">&#8288;&lt;parameterSet&gt;&#8288;</code> tag, then a <code style="white-space: pre;">&#8288;&lt;property&gt;&#8288;</code> tag.
For example, here is the part of a FACTS file that controls
the weeks between interims.
</p>
<div class="sourceCode xml"><pre>&lt;facts&gt;
  &lt;parameterSets type="NucleusParameterSet"&gt;
    &lt;parameterSet name="nucleus"&gt;
      &lt;property name="update_freq_save"&gt;4&lt;/property&gt;
</pre></div>
<p>To use the <code>write_facts()</code> function, you must first identify
the parts of the FACTS file you want to modify (the <code>fields</code> argument)
then the values that should be substituted in (the <code>values</code> argument).
Given the XML above, to create new FACTS files with intervals
5 and 6 instead of 4, you would set
</p>
<div class="sourceCode r"><pre>fields &lt;- tibble::tibble(
  field = "my_interval",
  type = "NucleusParameterSet",
  set = "nucleus",
  property = "update_freq_save"
)
values &lt;- tibble::tibble(
  facts_file = "your_facts_file.facts",
  output = "output_file.facts",
  my_interval = c(5, 6)
)
</pre></div>
<p>and then call <code>write_facts(fields = fields, values = values)</code>.
</p>


<h3>Value</h3>

<p>The function writes FACTS XML files and
returns a character vector with the paths to those files.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Identify a source FACTS file.
facts_file &lt;- get_facts_file_example("contin.facts")
# Create 4 new FACTS files with different numbers of max patients.
fields &lt;- data.frame(
  field = "my_subjects",
  type = "NucleusParameterSet",
  set = "nucleus",
  property = "max_subjects"
)
values &lt;- data.frame(
  facts_file = facts_file,
  output = c("_facts/out1000.facts", "_facts/out2000.facts"),
  my_subjects = c(1000, 2000)
)
default_dir &lt;- tempfile()
write_facts(fields = fields, values = values, default_dir = default_dir)
list.files("_facts")
unlink("_facts", recursive = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
