<!DOCTYPE html><html lang="en"><head><title>Help for package mHG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mHG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mHG-package'>
<p>Minimum-Hypergeometric Test</p></a></li>
<li><a href='#mHG.pval.calc'>
<p>Calculate the p-value of a minimum-hypergeometric (mHG) statistic.</p></a></li>
<li><a href='#mHG.statistic.calc'>
<p>Calculate the minimum-hypergeometric (mHG) statistic.</p></a></li>
<li><a href='#mHG.statistic.info-class'><p>Class <code>"mHG.statistic.info"</code></p></a></li>
<li><a href='#mHG.test'>
<p>Perform Minimum-Hypergeometric test.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Minimum-Hypergeometric Test</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-08-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Kobi Perl</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kobi Perl &lt;kobipe3@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Runs a minimum-hypergeometric (mHG) test as described in: Eden, E. (2007). Discovering Motifs in Ranked Lists of DNA Sequences. Haifa. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-08-18 07:25:39 UTC; kobip_000</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-08-18 07:57:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='mHG-package'>
Minimum-Hypergeometric Test
</h2><span id='topic+mHG-package'></span><span id='topic+mHG'></span>

<h3>Description</h3>

<p>Sometimes when running a hypergeometric test to check for enrichment for a feature in a group versus the background, the separation between the group and the background is done arbitrarily by setting a threshold on some other property. 
When the correct threshold is unknown, different thresholds can be tried, and the minimal p-value of the hypergeometric tests can be retreived.
If the elements can be sorted according to the property, it is possible to perform the hypergeometric tests on groups of increasing size.
The minimum over all the tests is the minimum hypergeometric statistic, or mHG.
The mHG is not a p-value by itself, as multiple tests were performed, without correcting for this.
The package provides means to calculate the statistic (mHG.statistic.calc), to fix the p-value (mHG.pval.calc) or to perform the entire test at once (mHG.test).
This is an R implementation of the algorithm described in:<br />
<cite>Eden, E. (2007). Discovering Motifs in Ranked Lists of DNA Sequences. Haifa. 
Retrieved from http://bioinfo.cs.technion.ac.il/people/zohar/thesis/eran.pdf</cite>
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mHG</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-05-18</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> methods</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The package provides means to calculate the statistic (<code>mHG.statistic.calc</code>), to fix the p-value (<code>mHG.pval.calc</code>) or to perform the entire test at once (<code>mHG.test</code>).
</p>


<h3>Author(s)</h3>

<p>Kobi Perl &lt;kobipe3@gmail.com&gt;
</p>


<h3>References</h3>

<p><cite>Eden, E. (2007). Discovering Motifs in Ranked Lists of DNA Sequences. Haifa. 
Retrieved from http://bioinfo.cs.technion.ac.il/people/zohar/thesis/eran.pdf</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mHG.statistic.calc">mHG.statistic.calc</a></code>
<code><a href="#topic+mHG.pval.calc">mHG.pval.calc</a></code>
<code><a href="#topic+mHG.test">mHG.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 50
B &lt;- 15
lambdas &lt;- numeric(50)
lambdas[sample(N, B)] &lt;- 1
t &lt;- mHG.test(lambdas)
t &lt;- mHG.test(lambdas, n_max = 20)
</code></pre>

<hr>
<h2 id='mHG.pval.calc'>
Calculate the p-value of a minimum-hypergeometric (mHG) statistic.
</h2><span id='topic+mHG.pval.calc'></span>

<h3>Description</h3>

<p>Calculates the p-value associated with the (minimum-hypergeometric) mHG statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mHG.pval.calc(p, N, B, n_max = N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mHG.pval.calc_+3A_p">p</code></td>
<td>

<p>the mHG statistic. It is marked as p as it represents an &quot;uncorrected&quot; p-value.
</p>
</td></tr>
<tr><td><code id="mHG.pval.calc_+3A_n">N</code></td>
<td>

<p>total number of white and black balls (according to the hypergeometric problem definition).
</p>
</td></tr>
<tr><td><code id="mHG.pval.calc_+3A_b">B</code></td>
<td>

<p>number of black balls.
</p>
</td></tr>
<tr><td><code id="mHG.pval.calc_+3A_n_max">n_max</code></td>
<td>

<p>the algorithm will calculate the p-value under the assumption that only the
first <code class="reqn">n_{max}</code> partitions were taken into account in determining the mHG statistic.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">O(NB)</code> running time, <code class="reqn">O(NB)</code> space.
</p>


<h3>Value</h3>

<p>the p-value of the test.
</p>


<h3>Author(s)</h3>

<p>Kobi Perl
</p>


<h3>References</h3>

<p><cite>Eden, E. (2007). Discovering Motifs in Ranked Lists of DNA Sequences. Haifa. 
Retrieved from http://bioinfo.cs.technion.ac.il/people/zohar/thesis/eran.pdf
(pages 11-12, 19-20)</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 50
B &lt;- 15
lambdas &lt;- numeric(50)
lambdas[sample(N, B)] &lt;- 1
p &lt;- mHG.statistic.calc(lambdas)@mHG
p.corrected &lt;- mHG.pval.calc(p, N, B) # Could have used mHG.test directly
</code></pre>

<hr>
<h2 id='mHG.statistic.calc'>
Calculate the minimum-hypergeometric (mHG) statistic.
</h2><span id='topic+mHG.statistic.calc'></span>

<h3>Description</h3>

<p>Calculates the minimum-hypergeometric (mHG) statistic.
<br /> mHG definition: <code class="reqn">mHG(\lambda)=min_{1&lt;=n&lt;N} HGT(b_n(\lambda))</code>
<br /> Where HGT is the hypergeometric tail: <code class="reqn">HGT(b;N,B,n)=Probability(X&gt;=b)</code>, 
<br /> and <code class="reqn">b_n=\sum\limits_{i=1}^n \lambda_i</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mHG.statistic.calc(lambdas, n_max = length(lambdas))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mHG.statistic.calc_+3A_lambdas">lambdas</code></td>
<td>

<p><code class="reqn">\{0,1\}^N</code>, sorted from top to bottom.
</p>
</td></tr>
<tr><td><code id="mHG.statistic.calc_+3A_n_max">n_max</code></td>
<td>

<p>the algorithm will only consider the first <code class="reqn">n_{max}</code> partitions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">O(n_{max}+B^2*log(B))</code> running time, <code class="reqn">O(B)</code> space.
</p>


<h3>Value</h3>

<p>Instance of the class <code>mHG.statistic.info</code> (stores the statistics, and for which n and <code class="reqn">b_n</code> it was obtained).
If several n give the same mHG, the smallest one is chosen.
</p>


<h3>Author(s)</h3>

<p>Kobi Perl
</p>


<h3>References</h3>

<p><cite>Eden, E. (2007). Discovering Motifs in Ranked Lists of DNA Sequences. Haifa. 
Retrieved from http://bioinfo.cs.technion.ac.il/people/zohar/thesis/eran.pdf
(pages 10-11, 18-19)</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mHG.statistic.info-class">mHG.statistic.info-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 50
B &lt;- 15
lambdas &lt;- numeric(50)
lambdas[sample(N, B)] &lt;- 1
mHG.statistic.info &lt;- mHG.statistic.calc(lambdas)@mHG
</code></pre>

<hr>
<h2 id='mHG.statistic.info-class'>Class <code>"mHG.statistic.info"</code></h2><span id='topic+mHG.statistic.info-class'></span>

<h3>Description</h3>

<p>Summarizes data about the minimum-hypergeometric (mHG) statistic of a {0,1}^N vector.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("mHG.statistic.info", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>mHG</code>:</dt><dd><p>The actual statistic.</p>
</dd>
<dt><code>n</code>:</dt><dd><p>The index in which the minimum was obtained.</p>
</dd>
<dt><code>b</code>:</dt><dd><p><code class="reqn">\sum\limits_{i=1}^n \lambda_i</code>.</p>
</dd>
</dl>



<h3>Methods</h3>

<p>No methods defined with class &quot;mHG.statistic.info&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p>Kobi Perl
</p>


<h3>References</h3>

<p><cite>Eden, E. (2007). Discovering Motifs in Ranked Lists of DNA Sequences. Haifa. 
Retrieved from http://bioinfo.cs.technion.ac.il/people/zohar/thesis/eran.pdf
(page 10)</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mHG.statistic.calc">mHG.statistic.calc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("mHG.statistic.info")
</code></pre>

<hr>
<h2 id='mHG.test'>
Perform Minimum-Hypergeometric test.
</h2><span id='topic+mHG.test'></span>

<h3>Description</h3>

<p>Performs a minimum-hypergeometric (mHG) test.
The null-hypothesis is that provided list was randomly and equiprobable selected from all lists containing N entries, B of which are 1s.
The alternative hypothesis is that the 1s tend to appear at the top of the list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mHG.test(lambdas, n_max = length(lambdas))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mHG.test_+3A_lambdas">lambdas</code></td>
<td>

<p><code class="reqn">\{0,1\}^N</code>, sorted from top to bottom.
</p>
</td></tr>
<tr><td><code id="mHG.test_+3A_n_max">n_max</code></td>
<td>

<p>the algorithm will only consider the first <code class="reqn">n_{max}</code> partitions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">O(NB)</code> running time, <code class="reqn">O(NB)</code> space.
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the following components:	
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>The mHG statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value for the test.</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<ul>
<li><p> N - total number of white and black balls.</p>
</li>
<li><p> B - number of black balls.</p>
</li>
<li><p> n_max - Max partition considered by the algorithm.</p>
</li></ul>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The index for which the mHG was obtained (smallest one if several n give the same mHG).</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p><code class="reqn">\sum\limits_{i=1}^n \lambda_i</code>.</p>
</td></tr>	
</table>


<h3>Author(s)</h3>

<p>Kobi Perl
</p>


<h3>References</h3>

<p><cite>Eden, E. (2007). Discovering Motifs in Ranked Lists of DNA Sequences. Haifa. 
Retrieved from http://bioinfo.cs.technion.ac.il/people/zohar/thesis/eran.pdf
(pages 10-12, 18-20)</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 50
B &lt;- 15
lambdas &lt;- numeric(50)
lambdas[sample(N, B)] &lt;- 1
t &lt;- mHG.test(lambdas)
t &lt;- mHG.test(lambdas, n_max = 20)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
