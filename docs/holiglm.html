<!DOCTYPE html><html><head><title>Help for package holiglm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {holiglm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#holiglm-package'><p>Holistic Generalized Linear Models Package</p></a></li>
<li><a href='#active_coefficients'><p>Obtain all Active Coefficients</p></a></li>
<li><a href='#agg_binomial'><p>Aggregate Binomial Data</p></a></li>
<li><a href='#as.OP.hglm_model'><p>Convert to OP</p></a></li>
<li><a href='#bike'><p>Bike Sharing Dataset</p></a></li>
<li><a href='#coef.hglm'><p>Extract Model Coefficients</p></a></li>
<li><a href='#cov_matrix'><p>Construct Covariance matrix</p></a></li>
<li><a href='#group_equal'><p>Group Equal Constraint</p></a></li>
<li><a href='#group_inout'><p>In-Out Constraint</p></a></li>
<li><a href='#group_sparsity'><p>Group Sparsity Constraint</p></a></li>
<li><a href='#hglm'><p>Fitting Holistic Generalized Linear Models</p></a></li>
<li><a href='#hglm_fit'><p>Fitting Holistic Generalized Linear Models</p></a></li>
<li><a href='#hglm_model'><p>Create a HGLM Model</p></a></li>
<li><a href='#hglmc'><p>Generic Functions for <code>hglmc</code> Objects</p></a></li>
<li><a href='#include'><p>Include Constraint</p></a></li>
<li><a href='#k_max'><p>Constraint on the Number of Covariates</p></a></li>
<li><a href='#linear'><p>Linear Constraint</p></a></li>
<li><a href='#lower'><p>Lower Bound</p></a></li>
<li><a href='#pairwise_sign_coherence'><p>Pairwise Sign Coherence</p></a></li>
<li><a href='#predict.hglm'><p>Predict Method for HGLM Fits</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#rhglm'><p>Random HGLM Data</p></a></li>
<li><a href='#rho_max'><p>Constraint on the Pairwise Correlation of Covariates</p></a></li>
<li><a href='#scale_constraint_matrix'><p>Scale Linear Constraint Matrix</p></a></li>
<li><a href='#sign_coherence'><p>Sign Coherence Constraint</p></a></li>
<li><a href='#solution.hglm'><p>Extract Solution</p></a></li>
<li><a href='#update_objective'><p>Update the Model Object</p></a></li>
<li><a href='#upper'><p>Upper Bound</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Holistic Generalized Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Holistic generalized linear models (HGLMs) extend generalized linear models (GLMs) by enabling the possibility to add further constraints to the model. The 'holiglm' package simplifies estimating HGLMs using convex optimization. Additional information about the package can be found in the reference manual, the 'README' and the accompanying paper &lt;<a href="https://doi.org/10.18637%2Fjss.v108.i07">doi:10.18637/jss.v108.i07</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), ROI.plugin.ecos</td>
</tr>
<tr>
<td>Imports:</td>
<td>slam, checkmate, MASS, SuppDists, ROI (&ge; 0.3-0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ROI.plugin.scs, tinytest (&ge; 1.0.0), parallel, knitr,
rmarkdown, bookdown, DiagrammeR</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-15 14:58:12 UTC; bschwendinger</td>
</tr>
<tr>
<td>Author:</td>
<td>Benjamin Schwendinger [aut, cre],
  Florian Schwendinger [aut],
  Laura Vana [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Benjamin Schwendinger &lt;benjaminschwe@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-15 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='holiglm-package'>Holistic Generalized Linear Models Package</h2><span id='topic+holiglm-package'></span><span id='topic+_PACKAGE'></span>

<h3>Description</h3>

<p>The holistic generalized linear models package simplifies
estimating generalized linear models under constraints.
The constraints can be used to,
</p>

<ul>
<li><p> bound the domains of specific covariates,
</p>
</li>
<li><p> impose linear constraints on the covariates,
</p>
</li>
<li><p> induce sparsity via best subset selection,
</p>
</li>
<li><p> impose sparsity on groups of variables,
</p>
</li>
<li><p> restrict the pairwise correlation between the selected coefficients,
</p>
</li>
<li><p> impose sign coherence constraints on selected covariates and
</p>
</li>
<li><p> force all predictors within a group either to be selected or not.
</p>
</li></ul>

<p>This sophisticated constraints are internally implemented via conic optimization.
However, the package is designed such that the user, is not required to
be familiar with conic optimization but is only required to have basic <span class="rlang"><b>R</b></span> knowledge.
</p>


<h3>Author(s)</h3>


<ul>
<li><p> Benjamin Schwendinger (<strong>Maintainer</strong> <a href="mailto:benjaminschwe@gmail.com">benjaminschwe@gmail.com</a>)
</p>
</li>
<li><p> Florian Schwendinger
</p>
</li>
<li><p> Laura Vana
</p>
</li></ul>



<h3>References</h3>

<p><strong>Holistic regression</strong> <br />
Schwendinger, B., Schwendinger, F., &amp; Vana, L. (2024).
Holistic Generalized Linear Models.
<a href="https://doi.org/10.18637/jss.v108.i07">doi:10.18637/jss.v108.i07</a>.
</p>
<p>Bertsimas, D., &amp; King, A. (2016).
OR Forum-An Algorithmic Approach to Linear Regression
Operations Research 64(1):2-16.
<a href="https://doi.org/10.1287/opre.2015.1436">doi:10.1287/opre.2015.1436</a>
</p>
<p>Bertsimas, D., &amp; Li, M. L. (2020).
Scalable Holistic Linear Regression.
Operations Research Letters 48 (3): 203–8.
<a href="https://doi.org/10.1016/j.orl.2020.02.008">doi:10.1016/j.orl.2020.02.008</a>.
</p>
<p><strong>Constrained regression</strong> <br />
McDonald, J. W., &amp; Diamond, I. D. (1990).
On the Fitting of Generalized Linear Models with Nonnegativity Parameter Constraints.
Biometrics, 46 (1): 201–206.
<a href="https://doi.org/10.2307/2531643">doi:10.2307/2531643</a>
</p>
<p>Slawski, M., &amp; Hein, M. (2013).
Non-negative least squares for high-dimensional linear models: Consistency and sparse recovery without regularization.
Electronic Journal of Statistics, 7: 3004-3056.
<a href="https://doi.org/10.1214/13-EJS868">doi:10.1214/13-EJS868</a>
</p>
<p>Carrizosa, E., Olivares-Nadal, A. V., &amp; Ramírez-Cobo, P. (2020).
Integer Constraints for Enhancing Interpretability in Linear Regression.
SORT. Statistics and Operations Research Transactions, 44: 67-98.
<a href="https://doi.org/10.2436/20.8080.02.95">doi:10.2436/20.8080.02.95</a>.
</p>
<p>Lawson, C. L., &amp; Hanson, R. J. (1995).
Solving least squares problems. Society for Industrial and Applied Mathematics.
Society for Industrial and Applied Mathematics.
<a href="https://doi.org/10.1137/1.9781611971217">doi:10.1137/1.9781611971217</a>
</p>
<p><strong>Generalized Linear Models</strong> <br />
McCullagh, P., &amp; Nelder, J. A. (2019).
Generalized Linear Models (2nd ed.)
Routledge.
<a href="https://doi.org/10.1201/9780203753736">doi:10.1201/9780203753736</a>.
</p>
<p><strong>Conic Optimization</strong> <br />
Boyd, S., &amp; Vandenberghe, L. (2004).
Convex Optimization (1st ed.)
Cambridge University Press.
<a href="https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf">https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf</a>.
<a href="https://doi.org/10.1017/cbo9780511804441">doi:10.1017/cbo9780511804441</a>
</p>
<p>Theußl, S., Schwendinger, F., &amp; Hornik, K. (2020).
ROI: An Extensible R Optimization Infrastructure.
Journal of Statistical Software 94 (15): 1–64.
<a href="https://doi.org/10.18637/jss.v094.i15">doi:10.18637/jss.v094.i15</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hglm">hglm</a></code>, <code><a href="#topic+holiglm">holiglm</a></code>
</p>

<hr>
<h2 id='active_coefficients'>Obtain all Active Coefficients</h2><span id='topic+active_coefficients'></span><span id='topic+acoef'></span>

<h3>Description</h3>

<p>The function returns a logical vector which is <code>TRUE</code> for all
active (i.e., non-zero) coefficients in the fitted model and <code>FALSE</code> otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>active_coefficients(object, ...)

acoef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="active_coefficients_+3A_object">object</code></td>
<td>
<p>an object inheriting from <code>"hglm"</code> or <code>"hglm.fit"</code>
from which the active coefficients obtained from.</p>
</td></tr>
<tr><td><code id="active_coefficients_+3A_...">...</code></td>
<td>
<p>optional arguments currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical vector giving the active coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
fit &lt;- hglm(y ~ ., constraints = k_max(3), data = dat)
active_coefficients(fit)
</code></pre>

<hr>
<h2 id='agg_binomial'>Aggregate Binomial Data</h2><span id='topic+agg_binomial'></span>

<h3>Description</h3>

<p>A simple function for aggregating binomial data, from
a form where <code>y</code> contains only <code>0</code> and <code>1</code>
and <code>X</code> could contain duplicated rows, into a format where
<code>y</code> is the matrix of counted successes and failures
and <code>X</code> does not contain duplicates. If <code>X</code> contains
factor variables, the model matrix corresponding to <code>X</code>
will be returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agg_binomial(formula, data, as_list = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agg_binomial_+3A_formula">formula</code></td>
<td>
<p>a formula object defining the aggregation.</p>
</td></tr>
<tr><td><code id="agg_binomial_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> to be aggregated.</p>
</td></tr>
<tr><td><code id="agg_binomial_+3A_as_list">as_list</code></td>
<td>
<p>a logical giving if the return value
should be a <code>list</code>. If <code>FALSE</code> the return value
is a <code>data.frame</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> (or <code>data.frame</code>) containing aggregated
binomial data with counted successes and failures.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
data &lt;- data.frame(y = rbinom(50, 1, 0.7),
                   a = factor(sample(c(1, 2), 50, TRUE)),
                   b = factor(sample(c(1, 2, 3), 50, TRUE)))
agg_binomial(y ~ ., data)
</code></pre>

<hr>
<h2 id='as.OP.hglm_model'>Convert to OP</h2><span id='topic+as.OP.hglm_model'></span>

<h3>Description</h3>

<p>Convert an object of class <code>"hglm_model"</code> into a <span class="pkg">ROI</span> optimization problem (<code><a href="ROI.html#topic+OP">OP</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hglm_model'
as.OP(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.OP.hglm_model_+3A_x">x</code></td>
<td>
<p>an object inheriting from <code>"hglm_model"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is mainly for internal use and advanced users which want of
alter the model object or the underlying optimization problem.
This function converts the model object created by <code><a href="#topic+hglm_model">hglm_model</a></code>
into a conic optimization problem solveable via <code><a href="ROI.html#topic+ROI_solve">ROI_solve</a></code>.
</p>


<h3>Value</h3>

<p>A <span class="pkg">ROI</span> object of class <code>"OP"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
# Use hglm with option dry_run
model &lt;- hglm(y ~ ., data = dat, dry_run = TRUE)
op &lt;- as.OP(model)
# User hglm_model
x &lt;- model.matrix(y ~ ., data = dat)
model &lt;- hglm_model(x, dat[["y"]])
op &lt;- as.OP(model)
</code></pre>

<hr>
<h2 id='bike'>Bike Sharing Dataset</h2><span id='topic+bike'></span>

<h3>Description</h3>

<p>This data set contains the daily count of rented bikes from the the Capital Bikeshare system
in Washington D.C., USA, for the years 2011 and 2012. The dataset is already prepared
(correct types + factor encodings) for model building.
</p>


<h3>Format</h3>

<p>A data.frame of dimension 731 x 12 containing daily data related
to related bikes.
</p>

<dl>
<dt>dteday</dt><dd><p>a date vector giving the date of the rental.</p>
</dd>
<dt>season</dt><dd><p>a factor with levels 'spring', 'summer', 'fall' and 'winter'.</p>
</dd>
<dt>year</dt><dd><p>a factor with levels '2011' and '2012'.</p>
</dd>
<dt>mnth</dt><dd><p>a factor with levels 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov' and 'Dec'.</p>
</dd>
<dt>holiday</dt><dd><p>a boolean vector indicating if the day is a holiday.</p>
</dd>
<dt>weathersit</dt><dd><p>a factor with levels 'good', 'neutral', 'bad' and 'very bad' giving the weather situation.</p>
</dd>
<dt>temp</dt><dd><p>a numeric vector containing max-normalized temperature in Celsius with 41 as maximum.</p>
</dd>
<dt>atemp</dt><dd><p>a numeric vector containing max-normalized feeling temperature in Celsius with 50 as maximum.</p>
</dd>
<dt>hum</dt><dd><p>a numeric vector containing max-normalized humidity with 100 as maximum.</p>
</dd>
<dt>windspeed</dt><dd><p>a numeric vector containing max-normalized windspeed with 67 as maximum.</p>
</dd>
<dt>cnt</dt><dd><p>an integer vector containing counts of rented bikes.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://archive.ics.uci.edu/">https://archive.ics.uci.edu/</a>
</p>


<h3>References</h3>

<p>Fanaee-T, Hadi. (2013). Bike Sharing Dataset. UCI Machine Learning Repository.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("bike")
hglm(formula = cnt ~ ., data=bike, family="poisson")

</code></pre>

<hr>
<h2 id='coef.hglm'>Extract Model Coefficients</h2><span id='topic+coef.hglm'></span>

<h3>Description</h3>

<p>The function returns different types of coefficients for a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hglm'
coef(object, type = c("unscaled", "scaled", "selected"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.hglm_+3A_object">object</code></td>
<td>
<p>an object inheriting from <code>"hglm"</code> or <code>"hglm.fit"</code>
from which the coefficients are obtained from.</p>
</td></tr>
<tr><td><code id="coef.hglm_+3A_type">type</code></td>
<td>
<p>Default value is <code>"unscaled"</code>. Allowed values are
<code>"unscaled"</code>, <code>"scaled"</code> and <code>"selected"</code>.</p>
</td></tr>
<tr><td><code id="coef.hglm_+3A_...">...</code></td>
<td>
<p>optional arguments currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The types <code>"scaled"</code> and <code>"unscaled"</code> refer to the coefficients
of the scaled/unscaled optimization problem. Type <code>"selected"</code> refers
to the active coefficients in the model <code><a href="#topic+active_coefficients">active_coefficients</a></code>.
</p>


<h3>Value</h3>

<p>a vector containing the unscaled, scaled or selected coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(1000, 1:3)
fit &lt;- hglm(y ~ ., data = dat)
coef(fit)
coef(fit, type="scaled")
coef(fit, type="selected")
</code></pre>

<hr>
<h2 id='cov_matrix'>Construct Covariance matrix</h2><span id='topic+cov_matrix'></span>

<h3>Description</h3>

<p>Utility function for constructing covariance matrices based on
a simple triplet format (<code><a href="slam.html#topic+simple_triplet_matrix">simple_triplet_matrix</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_matrix(k, i, j, v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cov_matrix_+3A_k">k</code></td>
<td>
<p>an integer giving the number of rows and columns of the constructed
covariance matrix.</p>
</td></tr>
<tr><td><code id="cov_matrix_+3A_i">i</code></td>
<td>
<p>an integer vector giving the row indices.</p>
</td></tr>
<tr><td><code id="cov_matrix_+3A_j">j</code></td>
<td>
<p>an integer vector giving the row indices.</p>
</td></tr>
<tr><td><code id="cov_matrix_+3A_v">v</code></td>
<td>
<p>a numeric vector giving the corresponding values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dense <code>matrix</code> of covariances.
</p>


<h3>See Also</h3>

<p>Other simulation: 
<code><a href="#topic+rhglm">rhglm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cov_matrix(5, c(1, 2), c(2, 3), c(0.8, 0.9))
</code></pre>

<hr>
<h2 id='group_equal'>Group Equal Constraint</h2><span id='topic+group_equal'></span>

<h3>Description</h3>

<p>Forces all covariates in the specified group to have the same coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_equal(vars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_equal_+3A_vars">vars</code></td>
<td>
<p>a vector specifying the indices or names of the covariates to which the constraint shall be applied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, 3, 4, 5, 6))
constraints &lt;- group_equal(vars = c("x1", "x3"))
hglm(y ~ ., constraints = constraints, data = dat)
</code></pre>

<hr>
<h2 id='group_inout'>In-Out Constraint</h2><span id='topic+group_inout'></span>

<h3>Description</h3>

<p>Forces coefficients of the covariates in the specified group to be either all zero or all nonzero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_inout(vars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_inout_+3A_vars">vars</code></td>
<td>
<p>a vector specifying the indices or names of the covariates to which the constraint shall be applied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, 3, 4, 5, 6))
constraints &lt;- group_inout(c("x1", "x2", "x3"))
hglm(y ~ ., constraints = constraints, data = dat)
</code></pre>

<hr>
<h2 id='group_sparsity'>Group Sparsity Constraint</h2><span id='topic+group_sparsity'></span>

<h3>Description</h3>

<p>Constraint which restricts the number of covariates selected from a specific group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_sparsity(vars, k = 1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_sparsity_+3A_vars">vars</code></td>
<td>
<p>a vector specifying the indices or names of the covariates to which the group constraint 
shall be applied.</p>
</td></tr>
<tr><td><code id="group_sparsity_+3A_k">k</code></td>
<td>
<p>an integer giving the maximum number of covariates to be included in the model from the specified group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, 0, 4, 5, 0))
constraints &lt;- group_sparsity(c("x1", "x2", "x5"), 1L)
hglm(y ~ ., constraints = constraints, data = dat)
</code></pre>

<hr>
<h2 id='hglm'>Fitting Holistic Generalized Linear Models</h2><span id='topic+hglm'></span><span id='topic+holiglm'></span><span id='topic+hglm_seq'></span>

<h3>Description</h3>

<p>Fit a generalized linear model under holistic constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hglm(
  formula,
  family = gaussian(),
  data,
  constraints = NULL,
  weights = NULL,
  scaler = c("auto", "center_standardization", "center_minmax", "standardization",
    "minmax", "off"),
  scale_response = NULL,
  big_m = 100,
  solver = "auto",
  control = list(),
  dry_run = FALSE,
  object_size = c("normal", "big")
)

holiglm(
  formula,
  family = gaussian(),
  data,
  constraints = NULL,
  weights = NULL,
  scaler = c("auto", "center_standardization", "center_minmax", "standardization",
    "minmax", "off"),
  scale_response = NULL,
  big_m = 100,
  solver = "auto",
  control = list(),
  dry_run = FALSE,
  object_size = c("normal", "big")
)

hglm_seq(
  k_seq,
  formula,
  family = gaussian(),
  data,
  constraints = NULL,
  weights = NULL,
  scaler = c("auto", "center_standardization", "center_minmax", "standardization",
    "minmax", "off"),
  big_m = 100,
  solver = "auto",
  control = list(),
  object_size = c("normal", "big"),
  parallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hglm_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>"formula"</code> giving the symbolic description
of the model to be fitted.</p>
</td></tr>
<tr><td><code id="hglm_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> or <code>matrix</code> giving the data for the estimation.</p>
</td></tr>
<tr><td><code id="hglm_+3A_constraints">constraints</code></td>
<td>
<p>a list of 'HGLM' constraints stored in a list of class <code>"lohglmc"</code>.
Use <code>NULL</code> to turn off constraints.</p>
</td></tr>
<tr><td><code id="hglm_+3A_weights">weights</code></td>
<td>
<p>an optional vector of 'prior weights' to be used for the estimation.</p>
</td></tr>
<tr><td><code id="hglm_+3A_scaler">scaler</code></td>
<td>
<p>a character string giving the name of the scaling function (default is <code>"auto"</code>)
to be employed for the covariates. This typically does not need to be changed.</p>
</td></tr>
<tr><td><code id="hglm_+3A_scale_response">scale_response</code></td>
<td>
<p>a boolean whether the response shall be standardized or not. Can only
be used with family <code>gaussian()</code>. Default is <code>TRUE</code> for
family <code>gaussian()</code> and <code>FALSE</code> for other families.</p>
</td></tr>
<tr><td><code id="hglm_+3A_big_m">big_m</code></td>
<td>
<p>an upper bound for the coefficients, needed for the big-M constraint.
Required to inherit from <code>"hglmc"</code>. Currently constraints created by
<code>group_sparsity()</code>, <code>group_inout()</code>,
<code>include()</code> and <code>group_equal()</code> use the big-M value specified here.</p>
</td></tr>
<tr><td><code id="hglm_+3A_solver">solver</code></td>
<td>
<p>a character string giving the name of the solver to be used for the estimation.</p>
</td></tr>
<tr><td><code id="hglm_+3A_control">control</code></td>
<td>
<p>a list of control parameters passed to <code>ROI_solve</code>.</p>
</td></tr>
<tr><td><code id="hglm_+3A_dry_run">dry_run</code></td>
<td>
<p>a logical; if <code>TRUE</code> the model is not fit but only constructed.</p>
</td></tr>
<tr><td><code id="hglm_+3A_object_size">object_size</code></td>
<td>
<p>a character string giving the object size, allowed values
are <code>"normal"</code> and <code>"big"</code>. If <code>"big"</code> is choosen, also
the <span class="pkg">ROI</span> solution and the <code>"hglm_model"</code> object are returned.</p>
</td></tr>
<tr><td><code id="hglm_+3A_k_seq">k_seq</code></td>
<td>
<p>an integer vector giving the values of <code>k_max</code> for which the model
should be estimated.</p>
</td></tr>
<tr><td><code id="hglm_+3A_parallel">parallel</code></td>
<td>
<p>whether estimation of sequence shall be parallelized</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the case of binding linear constraints the standard errors are corrected,
more information about the correction can be found in
Schwendinger, Schwendinger and Vana (2024) <a href="https://doi.org/10.18637/jss.v108.i07">doi:10.18637/jss.v108.i07</a>.
</p>


<h3>Value</h3>

<p>An object of class <code>"hglm"</code> inheriting from <code>"glm"</code>.
</p>


<h3>References</h3>

<p>Schwendinger B., Schwendinger F., Vana L. (2024).
Holistic Generalized Linear Models
<a href="https://doi.org/10.18637/jss.v108.i07">doi:10.18637/jss.v108.i07</a>
</p>
<p>Bertsimas, D., &amp; King, A. (2016).
OR Forum-An Algorithmic Approach to Linear Regression
Operations Research 64(1):2-16.
<a href="https://doi.org/10.1287/opre.2015.1436">doi:10.1287/opre.2015.1436</a>
</p>
<p>McCullagh, P., &amp; Nelder, J. A. (2019).
Generalized Linear Models (2nd ed.)
Routledge.
<a href="https://doi.org/10.1201/9780203753736">doi:10.1201/9780203753736</a>.
</p>
<p>Dobson, A. J., &amp; Barnett, A. G. (2018).
An Introduction to Generalized Linear Models (4th ed.)
Chapman and Hall/CRC.
<a href="https://doi.org/10.1201/9781315182780">doi:10.1201/9781315182780</a>
</p>
<p>Chares, Robert. (2009).
“Cones and Interior-Point Algorithms for Structured Convex Optimization involving Powers and Exponentials.”
</p>
<p>Chen, J., &amp; Chen, Z. (2008).
Extended Bayesian information criteria for model selection with large model spaces.
Biometrika, 95 (3): 759–771.
Oxford University Press.
<a href="https://doi.org/10.1093/biomet/asn034">doi:10.1093/biomet/asn034</a>
</p>
<p>Zhu, J., Wen, C., Zhu, J., Zhang, H., &amp; Wang, X. (2020).
A polynomial algorithm for best-subset selection problem.
Proceedings of the National Academy of Sciences, 117 (52): 33117–33123.
<a href="https://doi.org/10.1073/pnas.2014241117">doi:10.1073/pnas.2014241117</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
hglm(y ~ ., constraints = NULL, data = dat)
# estimation without constraints
hglm(y ~ ., constraints = NULL, data = dat)
# estimation with an upper bound on the number of coefficients to be selected
hglm(y ~ ., constraints = k_max(3), data = dat)
# estimation without intercept
hglm(y ~ . - 1, data = dat)

</code></pre>

<hr>
<h2 id='hglm_fit'>Fitting Holistic Generalized Linear Models</h2><span id='topic+hglm_fit'></span>

<h3>Description</h3>

<p>Fit a generalized linear model under constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hglm_fit(
  model,
  constraints = NULL,
  big_m,
  solver = "auto",
  control = list(),
  dry_run = FALSE,
  object_size = c("normal", "big")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hglm_fit_+3A_model">model</code></td>
<td>
<p>a 'HGLM' model (object of class <code>"hglm_model"</code>).</p>
</td></tr>
<tr><td><code id="hglm_fit_+3A_constraints">constraints</code></td>
<td>
<p>a list of 'HGLM' constraints stored in a list of class <code>"lohglmc"</code>.</p>
</td></tr>
<tr><td><code id="hglm_fit_+3A_big_m">big_m</code></td>
<td>
<p>an upper bound for the coefficients, needed for the big-M constraint.
Required to inherit from <code>"hglmc"</code>. Currently constraints created by
<code>group_sparsity()</code>, <code>group_inout()</code>,
<code>include()</code> and <code>group_equal()</code> use the big-M set here.</p>
</td></tr>
<tr><td><code id="hglm_fit_+3A_solver">solver</code></td>
<td>
<p>a character string giving the name of the solver to be used for the estimation.</p>
</td></tr>
<tr><td><code id="hglm_fit_+3A_control">control</code></td>
<td>
<p>a list of control parameters passed to <code>ROI_solve</code>.</p>
</td></tr>
<tr><td><code id="hglm_fit_+3A_dry_run">dry_run</code></td>
<td>
<p>a logical if <code>TRUE</code> the model is not fit but only constructed.</p>
</td></tr>
<tr><td><code id="hglm_fit_+3A_object_size">object_size</code></td>
<td>
<p>a character string giving the object size, allowed values
are <code>"normal"</code> and <code>"big"</code>. If <code>"big"</code> is choosen, also
the <span class="pkg">ROI</span> solution and the <code>"hglm_model"</code> object are returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>"hglm.fit"</code> inheriting from <code>"glm"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
x &lt;- model.matrix(y ~ ., data = dat)
model &lt;- hglm_model(x, y = dat[["y"]])
fit &lt;- hglm_fit(model, constraints = k_max(3))
</code></pre>

<hr>
<h2 id='hglm_model'>Create a HGLM Model</h2><span id='topic+hglm_model'></span>

<h3>Description</h3>

<p>Create a HGLM model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hglm_model(
  x,
  y,
  family = gaussian(),
  weights = NULL,
  frame = NULL,
  solver = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hglm_model_+3A_x">x</code></td>
<td>
<p>a numeric matrix giving the design matrix.</p>
</td></tr>
<tr><td><code id="hglm_model_+3A_y">y</code></td>
<td>
<p>a vector giving the response variables.</p>
</td></tr>
<tr><td><code id="hglm_model_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model.</p>
</td></tr>
<tr><td><code id="hglm_model_+3A_weights">weights</code></td>
<td>
<p>an optional vector of 'prior weights' to be used for the estimation.</p>
</td></tr>
<tr><td><code id="hglm_model_+3A_frame">frame</code></td>
<td>
<p>an optional model frame object.</p>
</td></tr>
<tr><td><code id="hglm_model_+3A_solver">solver</code></td>
<td>
<p>a character string giving the name of the solver to be used for the estimation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>No standardization prior to fitting the model takes place. If a x or y standardization is wanted, the user has to do this beforehand.
</p>


<h3>Value</h3>

<p>An object of class <code>"hglm_model"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
x &lt;- model.matrix(y ~ ., data = dat)
hglm_model(x, y = dat[["y"]])
</code></pre>

<hr>
<h2 id='hglmc'>Generic Functions for <code>hglmc</code> Objects</h2><span id='topic+hglmc'></span><span id='topic+c.hglmc'></span><span id='topic+is.hglmc'></span>

<h3>Description</h3>

<p>Generic functions for holistic 'GLM' constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hglmc'
c(...)

is.hglmc(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hglmc_+3A_...">...</code></td>
<td>
<p>multiple objects inheriting from <code>"hglmc"</code> to be combined.</p>
</td></tr>
<tr><td><code id="hglmc_+3A_x">x</code></td>
<td>
<p>an R object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'HGLM' constraints are all of class <code>"hglmc"</code>
and can be combined with the typical combine function <code>c()</code>.
To verify that an object is a 'HGLM' constraint, the function
<code>is.hglmc</code> can be used.
</p>


<h3>Value</h3>

<p>The combine function <code>c()</code> returns an object of class <code>"hglmc"</code>.
The <code>is.hglmc</code> function returns <code>TRUE</code> if the object inherits
from class <code>"hglmc"</code> otherwise <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>constraints &lt;- c(k_max(7), pairwise_sign_coherence())
is.hglmc(constraints)
</code></pre>

<hr>
<h2 id='include'>Include Constraint</h2><span id='topic+include'></span>

<h3>Description</h3>

<p>Ensures that all covariates specified by <code>vars</code> coefficients are active.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>include(vars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="include_+3A_vars">vars</code></td>
<td>
<p>an integer vector specifying the indices for covariates which have to be in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, 3, 4, 5, 6))
constraints &lt;- include(vars = c("x1", "x3"))
hglm(y ~ ., constraints = constraints, data = dat)
</code></pre>

<hr>
<h2 id='k_max'>Constraint on the Number of Covariates</h2><span id='topic+k_max'></span>

<h3>Description</h3>

<p>Constraint on the maximum number of covariates to be used in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k_max(k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="k_max_+3A_k">k</code></td>
<td>
<p>an positive integer with <code class="reqn">k \leq k_{max}</code> giving the maximum number of covariates to be used in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>Note</h3>


<ul>
<li><p> If an intercept is used, the upper bound on <code class="reqn">k_{max} + 1</code> is given by number of columns of the model matrix.
</p>
</li>
<li><p> If no intercept is used, the upper bound on <code class="reqn">k_{max}</code> is given by number of columns of the model matrix.    
</p>
</li></ul>



<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
hglm(y ~ ., constraints = k_max(3), data = dat)
</code></pre>

<hr>
<h2 id='linear'>Linear Constraint</h2><span id='topic+linear'></span>

<h3>Description</h3>

<p>Linear Constraint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linear(L, dir, rhs, on_big_m = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linear_+3A_l">L</code></td>
<td>
<p>a named vector or matrix defining the linear constraints on the coefficients of the covariates.</p>
</td></tr>
<tr><td><code id="linear_+3A_dir">dir</code></td>
<td>
<p>a character vector giving the direction of the linear constraints.</p>
</td></tr>
<tr><td><code id="linear_+3A_rhs">rhs</code></td>
<td>
<p>a numeric vector giving the right hand side of the linear constraint.</p>
</td></tr>
<tr><td><code id="linear_+3A_on_big_m">on_big_m</code></td>
<td>
<p>a logical indicating if the constraint should be imposed on the big-M related binary variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>References</h3>

<p>Lawson, C. L., &amp; Hanson, R. J. (1995).
Solving least squares problems. Society for Industrial and Applied Mathematics.
Society for Industrial and Applied Mathematics.
<a href="https://doi.org/10.1137/1.9781611971217">doi:10.1137/1.9781611971217</a>
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># vector constraint
beta &lt;- c(1, -2, 3)
dat &lt;- rhglm(100, beta)
constraints &lt;- c(linear(c(x1 = 2, x2 = 1), "==", 0), rho_max(1))
hglm(y ~ ., data = dat, constraints = constraints)

# matrix constraint
dat &lt;- rhglm(100, c(1, -2, 3, 4, 5, 6, 7))
mat &lt;- diag(2)
colnames(mat) &lt;- c("x1", "x5")
constraints &lt;- c(linear(mat, c("==", "=="), c(-1, 3)), rho_max(1))
hglm(y ~ ., data = dat, constraints = constraints)

</code></pre>

<hr>
<h2 id='lower'>Lower Bound</h2><span id='topic+lower'></span>

<h3>Description</h3>

<p>Set a lower bound on the coefficients of specific covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lower(kvars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lower_+3A_kvars">kvars</code></td>
<td>
<p>a named vector giving the lower bounds. The names should correspond to the names
of the covariates in the model matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>References</h3>

<p>McDonald, J. W., &amp; Diamond, I. D. (1990).
On the Fitting of Generalized Linear Models with Nonnegativity Parameter Constraints.
Biometrics, 46 (1): 201–206.
<a href="https://doi.org/10.2307/2531643">doi:10.2307/2531643</a>
</p>
<p>Slawski, M., &amp; Hein, M. (2013).
Non-negative least squares for high-dimensional linear models: Consistency and sparse recovery without regularization.
Electronic Journal of Statistics, 7: 3004-3056.
<a href="https://doi.org/10.1214/13-EJS868">doi:10.1214/13-EJS868</a>
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
constraints &lt;- lower(c(x2 = 0, x5 = 1))
hglm(y ~ ., constraints = constraints, data = dat)

# non-negative least squares
dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
constraints &lt;- lower(setNames(double(5), paste0("x", 1:5)))
hglm(y ~ ., constraints = constraints, data = dat)
</code></pre>

<hr>
<h2 id='pairwise_sign_coherence'>Pairwise Sign Coherence</h2><span id='topic+pairwise_sign_coherence'></span>

<h3>Description</h3>

<p>Ensures that coefficients of covariates which exhibit strong pairwise correlation
have a coherent sign.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairwise_sign_coherence(
  rho = 0.8,
  exclude = "(Intercept)",
  big_m = 100,
  eps = 1e-06,
  use = c("everything", "all.obs", "complete.obs", "na.or.complete",
    "pairwise.complete.obs"),
  method = c("pearson", "kendall", "spearman")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairwise_sign_coherence_+3A_rho">rho</code></td>
<td>
<p>a value in the range [0,1] specifying the maximum
allowed collinearity between pairs of covariates.</p>
</td></tr>
<tr><td><code id="pairwise_sign_coherence_+3A_exclude">exclude</code></td>
<td>
<p>a character vector giving the names of the covariates to be
excluded from the constraint (default is &quot;(Intercept)&quot;).</p>
</td></tr>
<tr><td><code id="pairwise_sign_coherence_+3A_big_m">big_m</code></td>
<td>
<p>a double giving the big-M parameter.</p>
</td></tr>
<tr><td><code id="pairwise_sign_coherence_+3A_eps">eps</code></td>
<td>
<p>a double giving the epsilon for the equal sign constraint.
Since most numerical solvers can only handle constraints up to some epsilon,
e.g., the constraint <code class="reqn">A x \geq b</code> is typically transformed to
<code class="reqn">|A x - b| \geq 0</code>. By providing an <code>eps</code><code class="reqn"> &gt; 0</code> and changing
the constraint to <code class="reqn">|A x - b| \geq</code> <code>eps</code> we can ensure <code class="reqn">|A x - b| &gt; 0</code>.</p>
</td></tr>
<tr><td><code id="pairwise_sign_coherence_+3A_use">use</code></td>
<td>
<p>an optional character string giving a method for computing
covariances in the presence of missing values.
The parameter is passed to <code><a href="stats.html#topic+cor">cor</a></code>,
therefore see <code><a href="stats.html#topic+cor">cor</a></code> for more information.</p>
</td></tr>
<tr><td><code id="pairwise_sign_coherence_+3A_method">method</code></td>
<td>
<p>a character string indicating which correlation coefficient
is to be computed.
The parameter is passed to <code><a href="stats.html#topic+cor">cor</a></code>,
therefore see <code><a href="stats.html#topic+cor">cor</a></code> for more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>References</h3>

<p>Carrizosa, E., Olivares-Nadal, A. V., &amp; Ramírez-Cobo, P. (2020).
Integer Constraints for Enhancing Interpretability in Linear Regression.
SORT. Statistics and Operations Research Transactions, 44: 67-98.
<a href="https://doi.org/10.2436/20.8080.02.95">doi:10.2436/20.8080.02.95</a>.
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>constraints &lt;- c(k_max(7), pairwise_sign_coherence())
</code></pre>

<hr>
<h2 id='predict.hglm'>Predict Method for HGLM Fits</h2><span id='topic+predict.hglm'></span>

<h3>Description</h3>

<p>Obtains predictions from a fitted holistic generalized linear model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hglm'
predict(object, newdata = NULL, type = c("link", "response"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.hglm_+3A_object">object</code></td>
<td>
<p>a fitted object of class inheriting from &quot;hglm&quot;.</p>
</td></tr>
<tr><td><code id="predict.hglm_+3A_newdata">newdata</code></td>
<td>
<p>an optional data frame containing new observations for which
predictions are to be made. If ommitted, the fitted linear predictors are
used.</p>
</td></tr>
<tr><td><code id="predict.hglm_+3A_type">type</code></td>
<td>
<p>the type of predictions to be made. Possible values are
<code>"link"</code> (default) or <code>"response"</code>. If <code>"link"</code>, the
predictions are in the link scale; if <code>"response"</code>, the predictions
are transformed to the response scale.</p>
</td></tr>
<tr><td><code id="predict.hglm_+3A_...">...</code></td>
<td>
<p>optional arguments currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of predicted values. If <code>type = "link"</code>, the predicted
values are in the link scale; if <code>type = "response"</code>, the predicted
values are in the response scale.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
fit &lt;- hglm(y ~ ., constraints = k_max(3), data = dat)
pred &lt;- predict(fit)
pred2 &lt;- predict(fit, newdata=dat)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+as.OP'></span><span id='topic+solution'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ROI</dt><dd><p><code><a href="ROI.html#topic+OP">as.OP</a></code>, <code><a href="ROI.html#topic+solution">solution</a></code></p>
</dd>
</dl>

<hr>
<h2 id='rhglm'>Random HGLM Data</h2><span id='topic+rhglm'></span>

<h3>Description</h3>

<p>A simple data generator for testing and example purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rhglm(
  n,
  beta,
  sigma = diag(length(beta) - 1L),
  family = gaussian(),
  truncate_mu = FALSE,
  as_list = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rhglm_+3A_n">n</code></td>
<td>
<p>the number of observations to be created.</p>
</td></tr>
<tr><td><code id="rhglm_+3A_beta">beta</code></td>
<td>
<p>a numeric vector giving the magnitude of the coefficients
(the first element is assumed to be the intercept).</p>
</td></tr>
<tr><td><code id="rhglm_+3A_sigma">sigma</code></td>
<td>
<p>a positive-definite symmetric matrix giving the covariance
structure of the covariates (passed to <code>MASS::mvrnorm</code>).</p>
</td></tr>
<tr><td><code id="rhglm_+3A_family">family</code></td>
<td>
<p>the family of the inverse link.</p>
</td></tr>
<tr><td><code id="rhglm_+3A_truncate_mu">truncate_mu</code></td>
<td>
<p>a logical giving if mu should be truncated if necessary.</p>
</td></tr>
<tr><td><code id="rhglm_+3A_as_list">as_list</code></td>
<td>
<p>a logical (default is <code>FALSE</code>), if <code>TRUE</code> a <code>list</code> is returned
otherwise a <code>data.frame</code> is returned.</p>
</td></tr>
<tr><td><code id="rhglm_+3A_...">...</code></td>
<td>
<p>addtional optional parameters. The arguments are passed to the
random variables generating function of the response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> (or <code>list</code>) containing the generated data.
</p>


<h3>See Also</h3>

<p>Other simulation: 
<code><a href="#topic+cov_matrix">cov_matrix</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rhglm(10, 1:5)
rhglm(10, 1:5, family = binomial())
</code></pre>

<hr>
<h2 id='rho_max'>Constraint on the Pairwise Correlation of Covariates</h2><span id='topic+rho_max'></span>

<h3>Description</h3>

<p>Constraint which ensures that only one covariate out of a pair of covariates with a correlation of at least <code>rho</code>
will be included in the final model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rho_max(
  rho = 0.8,
  exclude = "(Intercept)",
  use = c("everything", "all.obs", "complete.obs", "na.or.complete",
    "pairwise.complete.obs"),
  method = c("pearson", "kendall", "spearman")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rho_max_+3A_rho">rho</code></td>
<td>
<p>a value in the range [0,1] specifying, the maximum
allowed collinearity between pairs of covariates.</p>
</td></tr>
<tr><td><code id="rho_max_+3A_exclude">exclude</code></td>
<td>
<p>variables to be excluded form the pairwise
correlation constraints (default is <code>"(Intercept)"</code>).</p>
</td></tr>
<tr><td><code id="rho_max_+3A_use">use</code></td>
<td>
<p>an optional character string giving a method for computing
co-variances in the presence of missing values.
The parameter is passed to <code><a href="stats.html#topic+cor">cor</a></code>,
therefore see <code><a href="stats.html#topic+cor">cor</a></code> for more information.</p>
</td></tr>
<tr><td><code id="rho_max_+3A_method">method</code></td>
<td>
<p>a character string indicating which correlation coefficient
is to be computed. See <code><a href="stats.html#topic+cor">cor</a></code>
for more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>beta &lt;- 1:3
Sigma &lt;- cov_matrix(k = length(beta) - 1L, 1, 2, 0.9)
dat &lt;- rhglm(100, beta, sigma = Sigma)
hglm(y ~ ., constraints = rho_max(0.8), data = dat)
</code></pre>

<hr>
<h2 id='scale_constraint_matrix'>Scale Linear Constraint Matrix</h2><span id='topic+scale_constraint_matrix'></span>

<h3>Description</h3>

<p>Auxiliary function to scale the linear constraint matrices
to be consistent with the scaled model matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_constraint_matrix(L, xs, ys = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_constraint_matrix_+3A_l">L</code></td>
<td>
<p>a matrix giving the linear constraints.</p>
</td></tr>
<tr><td><code id="scale_constraint_matrix_+3A_xs">xs</code></td>
<td>
<p>a vector of length <code>ncol(L)</code> giving the scaling
of the model matrix.</p>
</td></tr>
<tr><td><code id="scale_constraint_matrix_+3A_ys">ys</code></td>
<td>
<p>a double giving the scaling of the response.</p>
</td></tr>
</table>

<hr>
<h2 id='sign_coherence'>Sign Coherence Constraint</h2><span id='topic+sign_coherence'></span>

<h3>Description</h3>

<p>Constraint which ensures that the coefficients of the specified covariates have
a coherent sign.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sign_coherence(vars, big_m = 100, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sign_coherence_+3A_vars">vars</code></td>
<td>
<p>a character vector giving the names of the covariates the
constraint should be applied to.</p>
</td></tr>
<tr><td><code id="sign_coherence_+3A_big_m">big_m</code></td>
<td>
<p>a double giving the big-M parameter.</p>
</td></tr>
<tr><td><code id="sign_coherence_+3A_eps">eps</code></td>
<td>
<p>a double giving the epsilon used to ensure that the constraint holds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>References</h3>

<p>Carrizosa, E., Olivares-Nadal, A. V., &amp; Ramírez-Cobo, P. (2020).
Integer Constraints for Enhancing Interpretability in Linear Regression.
SORT. Statistics and Operations Research Transactions, 44: 67-98.
<a href="https://doi.org/10.2436/20.8080.02.95">doi:10.2436/20.8080.02.95</a>.
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+upper">upper</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, -2, 3, 4, 5, 6))
constraints &lt;- sign_coherence(c("x1", "x3"))
hglm(y ~ ., constraints = constraints, data = dat)
</code></pre>

<hr>
<h2 id='solution.hglm'>Extract Solution</h2><span id='topic+solution.hglm'></span>

<h3>Description</h3>

<p>The solution of the underlying optimization problem,
can be accessed via the method <code>'solution'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hglm'
solution(
  x,
  type = c("primal", "dual", "aux", "psd", "msg", "objval", "status", "status_code"),
  force = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="solution.hglm_+3A_x">x</code></td>
<td>
<p>an object of type <code>'hglm'</code>.</p>
</td></tr>
<tr><td><code id="solution.hglm_+3A_type">type</code></td>
<td>
<p>a character giving the name of the solution to be extracted.</p>
</td></tr>
<tr><td><code id="solution.hglm_+3A_force">force</code></td>
<td>
<p>a logical to control the return value in the case that the
status code is equal to 1 (i.e. something went wrong).
By default force is <code>FALSE</code> and a solution is only provided
if the status code is equal to 0 (i.e. success). If force is <code>TRUE</code>
the status code is ignored and solutions are returned also
where the solver signaled an issue.</p>
</td></tr>
<tr><td><code id="solution.hglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the extracted solution.
</p>

<hr>
<h2 id='update_objective'>Update the Model Object</h2><span id='topic+update_objective'></span>

<h3>Description</h3>

<p>Update the Model Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_objective(model, op)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_objective_+3A_model">model</code></td>
<td>
<p>an object inheriting from <code>"hglm_model"</code>.</p>
</td></tr>
<tr><td><code id="update_objective_+3A_op">op</code></td>
<td>
<p>an <code><a href="ROI.html#topic+OP">OP</a></code> giving the new objective.</p>
</td></tr>
</table>

<hr>
<h2 id='upper'>Upper Bound</h2><span id='topic+upper'></span>

<h3>Description</h3>

<p>Set a upper bound on the coefficient of specific covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upper(kvars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="upper_+3A_kvars">kvars</code></td>
<td>
<p>a named vector giving the upper bounds. The names should correspond to the names
of the covariates in the model matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A holistic generalized model constraint, object inheriting from class <code>"hglmc"</code>.
</p>


<h3>References</h3>

<p>McDonald, J. W., &amp; Diamond, I. D. (1990).
On the Fitting of Generalized Linear Models with Nonnegativity Parameter Constraints.
Biometrics, 46 (1): 201–206.
<a href="https://doi.org/10.2307/2531643">doi:10.2307/2531643</a>
</p>
<p>Slawski, M., &amp; Hein, M. (2013).
Non-negative least squares for high-dimensional linear models: Consistency and sparse recovery without regularization.
Electronic Journal of Statistics, 7: 3004-3056.
<a href="https://doi.org/10.1214/13-EJS868">doi:10.1214/13-EJS868</a>
</p>


<h3>See Also</h3>

<p>Other Constraint-Constructors: 
<code><a href="#topic+group_equal">group_equal</a>()</code>,
<code><a href="#topic+group_inout">group_inout</a>()</code>,
<code><a href="#topic+group_sparsity">group_sparsity</a>()</code>,
<code><a href="#topic+include">include</a>()</code>,
<code><a href="#topic+k_max">k_max</a>()</code>,
<code><a href="#topic+linear">linear</a>()</code>,
<code><a href="#topic+lower">lower</a>()</code>,
<code><a href="#topic+pairwise_sign_coherence">pairwise_sign_coherence</a>()</code>,
<code><a href="#topic+rho_max">rho_max</a>()</code>,
<code><a href="#topic+sign_coherence">sign_coherence</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- rhglm(100, c(1, 2, -3, 4, 5, -6))
constraints &lt;- upper(c(x1 = 0, x4 = 1))
hglm(y ~ ., constraints = constraints, data = dat)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
