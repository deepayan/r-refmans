<!DOCTYPE html><html lang="en"><head><title>Help for package Certara.Xpose.NLME</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Certara.Xpose.NLME}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eta_vs_cov'><p>ETAs vs covariate Plot</p></a></li>
<li><a href='#get_overallNlme'><p>Access NLME model overall fit results</p></a></li>
<li><a href='#get_prmNlme'><p>Access NLME model parameter estimates</p></a></li>
<li><a href='#nlme.cov.splom'><p>Create covariates scatterplot</p></a></li>
<li><a href='#nlme.par.vs.cov'><p>Plot parameter estimates against covariates</p></a></li>
<li><a href='#nlme.ranpar.vs.cov'><p>Plot random parameter estimates against covariates</p></a></li>
<li><a href='#nlme.var.vs.cov'><p>Build multiple plots for selected variable vs covariates</p></a></li>
<li><a href='#prm_vs_cov'><p>Parameter vs covariate Plot</p></a></li>
<li><a href='#res_vs_cov'><p>Residuals vs covariate plot</p></a></li>
<li><a href='#xpdb_ex_Nlme'><p>XposeNlme examples</p></a></li>
<li><a href='#xplot_box'><p>Default xpose box plot function</p></a></li>
<li><a href='#xposeNlme'><p>Creates xpose database from Certara.RsNLME output files</p></a></li>
<li><a href='#xposeNlmeModel'><p>Creates xpose database from Certara.RsNLME objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Enhances 'xpose' Diagnostics for Pharmacometric Models from
'Certara.RsNLME' and Phoenix NLME</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Facilitates the creation of 'xpose' data objects from Nonlinear Mixed
      Effects (NLME) model outputs produced by 'Certara.RsNLME' or Phoenix NLME. This
      integration enables users to utilize all 'ggplot2'-based plotting functions available
      in 'xpose' for thorough model diagnostics and data visualization. Additionally, the 
      package introduces specialized plotting functions tailored for covariate model
      evaluation, extending the analytical capabilities beyond those offered by 'xpose' alone.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://certara.github.io/R-Xpose-NLME/">https://certara.github.io/R-Xpose-NLME/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>Certara.RsNLME, data.table, gridExtra, jsonlite, readr,
testthat</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, egg, GGally, ggplot2, magrittr, purrr, rlang, scales,
stringr, tibble, xpose</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-23 19:57:01 UTC; jcraig</td>
</tr>
<tr>
<td>Author:</td>
<td>James Craig [aut, cre],
  Michael Tomashevskiy [aut],
  Soltanshahi Fred [aut],
  Shuhua Hu [ctb],
  Certara USA, Inc [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James Craig &lt;james.craig@certara.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-28 15:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='eta_vs_cov'>ETAs vs covariate Plot</h2><span id='topic+eta_vs_cov'></span>

<h3>Description</h3>

<p>Plot ETAs against a continuous or categorical covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eta_vs_cov(
  xpdb,
  covariate,
  mapping = NULL,
  drop_fixed = FALSE,
  group = "ID",
  type = "bpls",
  title = "ETAs vs @x | @run",
  subtitle = "Based on @nind individuals",
  caption = "@dir",
  tag = NULL,
  log = NULL,
  guide = FALSE,
  onlyfirst = TRUE,
  facets,
  .problem,
  quiet,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eta_vs_cov_+3A_xpdb">xpdb</code></td>
<td>
<p>An xpose database object.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_covariate">covariate</code></td>
<td>
<p>Character; String of covariate name</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_mapping">mapping</code></td>
<td>
<p>List of aesthetics mappings to be used for the xpose plot
(e.g. <code>point_color</code>).</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_drop_fixed">drop_fixed</code></td>
<td>
<p>Logical; Logic specifying whether ETAs having same value
for the given covariate value should be removed from plotting</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_group">group</code></td>
<td>
<p>Grouping variable to be used for lines. <code>ID</code> by default</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_type">type</code></td>
<td>
<p>Character; String setting the type of plot to be used.
Must be 'b' for categorical covariates,
one or a combination of 'p','l','s' for continuous covariates.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_title">title</code></td>
<td>
<p>Character; Plot title. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_subtitle">subtitle</code></td>
<td>
<p>Character; Plot subtitle. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_caption">caption</code></td>
<td>
<p>Character; Page caption. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_tag">tag</code></td>
<td>
<p>Character; Plot identification tag. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_log">log</code></td>
<td>
<p>Character; String assigning logarithmic scale to axes, can be either &rdquo;,
'x', y' or 'xy'.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_guide">guide</code></td>
<td>
<p>Logical; Should the guide (e.g. reference distribution) be displayed.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_onlyfirst">onlyfirst</code></td>
<td>
<p>Logical; Should the data be filtered to retain first value for each group/facet.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_facets">facets</code></td>
<td>
<p>Either a character string to use <code><a href="ggforce.html#topic+facet_wrap_paginate">facet_wrap_paginate</a></code>
or a formula to use <code><a href="ggforce.html#topic+facet_grid_paginate">facet_grid_paginate</a></code>.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_.problem">.problem</code></td>
<td>
<p>The $problem number to be used. By default returns
the last estimation problem.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_quiet">quiet</code></td>
<td>
<p>Logical, if <code>FALSE</code> messages are printed to the console.</p>
</td></tr>
<tr><td><code id="eta_vs_cov_+3A_...">...</code></td>
<td>
<p>Any additional aesthetics to be passed on <code><a href="xpose.html#topic+xplot_scatter">xplot_scatter</a></code>
or <code><a href="#topic+xplot_box">xplot_box</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>xpose_plot</code>, <code>ggplot</code>, and <code>gg</code>. This object represents a customized plot created using <code>ggplot2</code>.
The <code>xpose_plot</code> class provides additional metadata and integration with <code>xpose</code> workflows, allowing for advanced
customization and compatibility with other <code>xpose</code> functions. Users can interact with the plot object as they
would with any <code>ggplot2</code> object, including modifying aesthetics, adding layers, or saving the plot.
</p>


<h3>Layers mapping</h3>

<p>Plots can be customized by mapping arguments to specific layers. The naming convention is
layer_option where layer is one of the names defined in the list below and option is
any option supported by this layer e.g. boxplot_fill = 'blue', etc.
</p>

<ul>
<li><p> box plot: options to <code>geom_boxplot</code>
</p>
</li>
<li><p> point plot: options to <code>geom_point</code>
</p>
</li>
<li><p> line plot: options to <code>geom_line</code>
</p>
</li>
<li><p> smooth plot: options to <code>geom_smooth</code>
</p>
</li>
<li><p> xscale: options to <code>scale_x_continuous</code> or <code>scale_x_log10</code>
</p>
</li>
<li><p> yscale: options to <code>scale_y_continuous</code> or <code>scale_y_log10</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="xpose.html#topic+xplot_scatter">xplot_scatter</a></code> <code><a href="#topic+xplot_box">xplot_box</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eta_vs_cov(xpose::xpdb_ex_pk,
  covariate = "WT",
  type = "ps",
  smooth_color = "red",
  point_color = "green",
  point_shape = "square",
  point_alpha = .5,
  point_size = 3
)

eta_vs_cov(xpose::xpdb_ex_pk,
  covariate = "AGE",
  type = "ps",
  facets = DOSE ~ variable,
  guide = TRUE,
  guide_color = "red",
  guide_slope = 0,
  guide_intercept = 0
)

</code></pre>

<hr>
<h2 id='get_overallNlme'>Access NLME model overall fit results</h2><span id='topic+get_overallNlme'></span>

<h3>Description</h3>

<p>Access model fit diagnostics from an xpdb object generated by
xposeNlme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_overallNlme(xpdb, .problem = 1, .subprob = 0, .method = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_overallNlme_+3A_xpdb">xpdb</code></td>
<td>
<p>An <code>xpose</code> data base object from which the model output file data
will be extracted. Only objects generated by <code>xposeNlme</code> are supported.</p>
</td></tr>
<tr><td><code id="get_overallNlme_+3A_.problem">.problem</code></td>
<td>
<p>The problem to be used.</p>
</td></tr>
<tr><td><code id="get_overallNlme_+3A_.subprob">.subprob</code></td>
<td>
<p>The subproblem to be used.</p>
</td></tr>
<tr><td><code id="get_overallNlme_+3A_.method">.method</code></td>
<td>
<p>The estimation method to be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble for single problem/subproblem.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xposeNlme">xposeNlme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Store the parameter table
prmOverall &lt;- get_overallNlme(xpdb_ex_Nlme)

</code></pre>

<hr>
<h2 id='get_prmNlme'>Access NLME model parameter estimates</h2><span id='topic+get_prmNlme'></span>

<h3>Description</h3>

<p>Access model parameter estimates from an xpdb object generated by
xposeNlme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_prmNlme(
  xpdb,
  .problem = 1,
  .subprob = 0,
  .method = NULL,
  digits = 6,
  show_all = FALSE,
  level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_prmNlme_+3A_xpdb">xpdb</code></td>
<td>
<p>An <code>xpose</code> data base object from which the model output
file data will be extracted. Only objects generated by <code>xposeNlme</code> are supported.</p>
</td></tr>
<tr><td><code id="get_prmNlme_+3A_.problem">.problem</code></td>
<td>
<p>The problem to be used.</p>
</td></tr>
<tr><td><code id="get_prmNlme_+3A_.subprob">.subprob</code></td>
<td>
<p>The subproblem to be used.</p>
</td></tr>
<tr><td><code id="get_prmNlme_+3A_.method">.method</code></td>
<td>
<p>The estimation method to be used.</p>
</td></tr>
<tr><td><code id="get_prmNlme_+3A_digits">digits</code></td>
<td>
<p>Integer specifying the number of significant digits to be displayed.</p>
</td></tr>
<tr><td><code id="get_prmNlme_+3A_show_all">show_all</code></td>
<td>
<p>Logical specifying whether the 0 off-diagonal omega elements
should be removed from the output or not.</p>
</td></tr>
<tr><td><code id="get_prmNlme_+3A_level">level</code></td>
<td>
<p>Numeric specifying confidence level to compute confidence intervals,
which are calculated based on Student’s t distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble for single problem/subproblem.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xposeNlme">xposeNlme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Store the parameter table
prm &lt;- get_prmNlme(xpdb_ex_Nlme)

# Set the desired number of significant digits to display results

# Note: To have results displayed in the number of significant digits
#  specified in the digits argument, one needs to make sure that
#  the value of pillar.sigfig option (default value is 3) is greater
#  than or equal to this specified value.

options(pillar.sigfig = 6)
get_prmNlme(xpdb_ex_Nlme, digits = 4)

</code></pre>

<hr>
<h2 id='nlme.cov.splom'>Create covariates scatterplot</h2><span id='topic+nlme.cov.splom'></span>

<h3>Description</h3>

<p>Use to create covariates scatterplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlme.cov.splom(
  xpdb,
  covColNames,
  ggupper = list(continuous = "cor", combo = "box_no_facet", discrete = "count", na =
    "na"),
  gglower = list(continuous = GGally::wrap("smooth", alpha = 0.3, size = 0.1), combo =
    "facethist", discrete = "facetbar", na = "na"),
  ggdiag = list(continuous = "densityDiag", discrete = "barDiag", na = "naDiag"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nlme.cov.splom_+3A_xpdb">xpdb</code></td>
<td>
<p>An xpose database object.</p>
</td></tr>
<tr><td><code id="nlme.cov.splom_+3A_covcolnames">covColNames</code></td>
<td>
<p>Character vector of covariates to build the matrix</p>
</td></tr>
<tr><td><code id="nlme.cov.splom_+3A_ggupper">ggupper</code></td>
<td>
<p>See <code><a href="GGally.html#topic+ggpairs">ggpairs</a>()</code> upper argument.</p>
</td></tr>
<tr><td><code id="nlme.cov.splom_+3A_gglower">gglower</code></td>
<td>
<p>See <code><a href="GGally.html#topic+ggpairs">ggpairs</a>()</code> lower argument.</p>
</td></tr>
<tr><td><code id="nlme.cov.splom_+3A_ggdiag">ggdiag</code></td>
<td>
<p>See <code><a href="GGally.html#topic+ggpairs">ggpairs</a>()</code> diag argument.</p>
</td></tr>
<tr><td><code id="nlme.cov.splom_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to <code><a href="GGally.html#topic+ggpairs">ggpairs</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="GGally.html#topic+ggmatrix">ggmatrix</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nlme.cov.splom(xpdb = xpdb_ex_Nlme,
covColNames = c("sex", "wt", "age")
)

</code></pre>

<hr>
<h2 id='nlme.par.vs.cov'>Plot parameter estimates against covariates</h2><span id='topic+nlme.par.vs.cov'></span>

<h3>Description</h3>

<p>Use to create a stack of plots of parameter estimates plotted against covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlme.par.vs.cov(xpdb, covColNames, nrow = 1, ncol = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nlme.par.vs.cov_+3A_xpdb">xpdb</code></td>
<td>
<p>An xpose database object.</p>
</td></tr>
<tr><td><code id="nlme.par.vs.cov_+3A_covcolnames">covColNames</code></td>
<td>
<p>Character vector of covariates to build the matrix.</p>
</td></tr>
<tr><td><code id="nlme.par.vs.cov_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows.</p>
</td></tr>
<tr><td><code id="nlme.par.vs.cov_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns; if ncol=1, each gtable object is treated separately.</p>
</td></tr>
<tr><td><code id="nlme.par.vs.cov_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to <code><a href="egg.html#topic+ggarrange">ggarrange</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of <code><a href="gtable.html#topic+gtable">gtable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nlme.par.vs.cov(
  xpdb = xpdb_ex_Nlme,
  covColNames = c("sex", "wt", "age")
)

</code></pre>

<hr>
<h2 id='nlme.ranpar.vs.cov'>Plot random parameter estimates against covariates</h2><span id='topic+nlme.ranpar.vs.cov'></span>

<h3>Description</h3>

<p>Use to create a stack of plots of random parameter estimates plotted against covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlme.ranpar.vs.cov(xpdb, covColNames, nrow = 1, ncol = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nlme.ranpar.vs.cov_+3A_xpdb">xpdb</code></td>
<td>
<p>An xpose database object.</p>
</td></tr>
<tr><td><code id="nlme.ranpar.vs.cov_+3A_covcolnames">covColNames</code></td>
<td>
<p>Character vector of covariates to build the matrix.</p>
</td></tr>
<tr><td><code id="nlme.ranpar.vs.cov_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows.</p>
</td></tr>
<tr><td><code id="nlme.ranpar.vs.cov_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns; if ncol=1, each gtable object is treated separately.</p>
</td></tr>
<tr><td><code id="nlme.ranpar.vs.cov_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to <code><a href="egg.html#topic+ggarrange">ggarrange</a>()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of <code><a href="gtable.html#topic+gtable">gtable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nlme.ranpar.vs.cov(xpdb = xpose::xpdb_ex_pk,
covColNames = c("SEX", "CLCR", "AGE")
)

</code></pre>

<hr>
<h2 id='nlme.var.vs.cov'>Build multiple plots for selected variable vs covariates</h2><span id='topic+nlme.var.vs.cov'></span>

<h3>Description</h3>

<p>The type of plot depends on the type of covariate: boxplot for categorical,
geom_point and geom_smooth for continuous.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlme.var.vs.cov(xpdb, covColNames, nrow = 1, ncol = 1, yVar = "WRES", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nlme.var.vs.cov_+3A_xpdb">xpdb</code></td>
<td>
<p>An xpose database object.</p>
</td></tr>
<tr><td><code id="nlme.var.vs.cov_+3A_covcolnames">covColNames</code></td>
<td>
<p>Character vector of covariates to build the matrix.</p>
</td></tr>
<tr><td><code id="nlme.var.vs.cov_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows.</p>
</td></tr>
<tr><td><code id="nlme.var.vs.cov_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns; if ncol=1, each gtable object is treated separately.</p>
</td></tr>
<tr><td><code id="nlme.var.vs.cov_+3A_yvar">yVar</code></td>
<td>
<p>Variable from xpdb data to build a plot.</p>
</td></tr>
<tr><td><code id="nlme.var.vs.cov_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to <code><a href="egg.html#topic+ggarrange">ggarrange</a>()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of <code><a href="gtable.html#topic+gtable">gtable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nlme.var.vs.cov(
  xpdb = xpdb_ex_Nlme,
  covColNames = c("sex", "wt", "age"),
  yVar = "WRES",
  nrow = 2,
  ncol = 2
  )
</code></pre>

<hr>
<h2 id='prm_vs_cov'>Parameter vs covariate Plot</h2><span id='topic+prm_vs_cov'></span>

<h3>Description</h3>

<p>Plot Parameters against a continuous or categorical covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prm_vs_cov(
  xpdb,
  covariate,
  mapping = NULL,
  drop_fixed = FALSE,
  group = "ID",
  type = "bpls",
  title = "Parameters vs @x | @run",
  subtitle = "Based on @nind individuals",
  caption = "@dir",
  tag = NULL,
  log = NULL,
  guide = FALSE,
  onlyfirst = FALSE,
  facets,
  .problem,
  quiet,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prm_vs_cov_+3A_xpdb">xpdb</code></td>
<td>
<p>An xpose database object.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_covariate">covariate</code></td>
<td>
<p>Character; String of covariate name</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_mapping">mapping</code></td>
<td>
<p>List of aesthetics mappings to be used for the xpose plot
(e.g. <code>point_color</code>).</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_drop_fixed">drop_fixed</code></td>
<td>
<p>Logical; logic specifying whether structural parameters having same value
for the given covariate value should be removed from plotting</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_group">group</code></td>
<td>
<p>Grouping variable to be used for lines. <code>ID</code> by default</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_type">type</code></td>
<td>
<p>Character; String setting the type of plot to be used.
Must be 'b' for categorical covariates,
one or a combination of 'p','l','s' for continuous covariates.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_title">title</code></td>
<td>
<p>Character; Plot title. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_subtitle">subtitle</code></td>
<td>
<p>Character; Plot subtitle. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_caption">caption</code></td>
<td>
<p>Character; Page caption. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_tag">tag</code></td>
<td>
<p>Character; Plot identification tag. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_log">log</code></td>
<td>
<p>Character; String assigning logarithmic scale to axes, can be either &rdquo;,
'x', y' or 'xy'.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_guide">guide</code></td>
<td>
<p>Logical; Enable guide display (e.g. unity line).</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_onlyfirst">onlyfirst</code></td>
<td>
<p>Logical; Should the data be filtered to retain first value for each group/facet.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_facets">facets</code></td>
<td>
<p>Either a character string to use <code><a href="ggforce.html#topic+facet_wrap_paginate">facet_wrap_paginate</a></code>
or a formula to use <code><a href="ggforce.html#topic+facet_grid_paginate">facet_grid_paginate</a></code>.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_.problem">.problem</code></td>
<td>
<p>The $problem number to be used. By default returns
the last estimation problem.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_quiet">quiet</code></td>
<td>
<p>Logical, if <code>FALSE</code> messages are printed to the console.</p>
</td></tr>
<tr><td><code id="prm_vs_cov_+3A_...">...</code></td>
<td>
<p>Any additional aesthetics to be passed on <code><a href="xpose.html#topic+xplot_scatter">xplot_scatter</a></code>
or <code><a href="#topic+xplot_box">xplot_box</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>xpose_plot</code>, <code>ggplot</code>, and <code>gg</code>. This object represents a customized plot created using <code>ggplot2</code>.
The <code>xpose_plot</code> class provides additional metadata and integration with <code>xpose</code> workflows, allowing for advanced
customization and compatibility with other <code>xpose</code> functions. Users can interact with the plot object as they
would with any <code>ggplot2</code> object, including modifying aesthetics, adding layers, or saving the plot.
</p>


<h3>Layers mapping</h3>

<p>Plots can be customized by mapping arguments to specific layers. The naming convention is
layer_option where layer is one of the names defined in the list below and option is
any option supported by this layer e.g. boxplot_fill = 'blue', etc.
</p>

<ul>
<li><p> box plot: options to <code>geom_boxplot</code>
</p>
</li>
<li><p> point plot: options to <code>geom_point</code>
</p>
</li>
<li><p> line plot: options to <code>geom_line</code>
</p>
</li>
<li><p> smooth plot: options to <code>geom_smooth</code>
</p>
</li>
<li><p> xscale: options to <code>scale_x_continuous</code> or <code>scale_x_log10</code>
</p>
</li>
<li><p> yscale: options to <code>scale_y_continuous</code> or <code>scale_y_log10</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="xpose.html#topic+xplot_scatter">xplot_scatter</a></code> <code><a href="#topic+xplot_box">xplot_box</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prm_vs_cov(xpose::xpdb_ex_pk,
  covariate = "AGE", type = "ps",
  log = "y",
  yscale_breaks = scales::trans_breaks("log10", function(x) 10^x),
  yscale_labels = scales::trans_format("log10", scales::math_format(10^.x)),
  caption = NULL
)

prm_vs_cov(xpose::xpdb_ex_pk,
  covariate = "SEX",
  type = "b",
  boxplot_fill = "blue",
  boxplot_color = "black",
  boxplot_outlier.color = "red"
)

</code></pre>

<hr>
<h2 id='res_vs_cov'>Residuals vs covariate plot</h2><span id='topic+res_vs_cov'></span>

<h3>Description</h3>

<p>Plot Residuals against a continuous or categorical covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>res_vs_cov(
  xpdb,
  mapping = NULL,
  covariate,
  res = "CWRES",
  group = "ID",
  type = "bpls",
  title = "Residuals vs @x | @run",
  subtitle = "Based on @nind individuals",
  caption = "@dir",
  tag = NULL,
  log = NULL,
  guide = TRUE,
  facets,
  .problem,
  quiet,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="res_vs_cov_+3A_xpdb">xpdb</code></td>
<td>
<p>An xpose database object.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_mapping">mapping</code></td>
<td>
<p>List of aesthetics mappings to be used for the xpose plot
(e.g. <code>point_color</code>).</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_covariate">covariate</code></td>
<td>
<p>Character; String of covariate name</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_res">res</code></td>
<td>
<p>Character; String of residual name; CWRES by default.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_group">group</code></td>
<td>
<p>Grouping variable to be used for lines. <code>ID</code> by default</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_type">type</code></td>
<td>
<p>Character; String setting the type of plot to be used.
Must be 'b' for categorical covariates,
one or a combination of 'p','l','s' for continuous covariates.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_title">title</code></td>
<td>
<p>Character; Plot title. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_subtitle">subtitle</code></td>
<td>
<p>Character; Plot subtitle. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_caption">caption</code></td>
<td>
<p>Character; Page caption. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_tag">tag</code></td>
<td>
<p>Character; Plot identification tag. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_log">log</code></td>
<td>
<p>Character; String assigning logarithmic scale to axes, can be either &rdquo;,
'x', y' or 'xy'.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_guide">guide</code></td>
<td>
<p>Logical; Should the guide (e.g. reference distribution) be displayed.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_facets">facets</code></td>
<td>
<p>Either a character string to use <code><a href="ggforce.html#topic+facet_wrap_paginate">facet_wrap_paginate</a></code>
or a formula to use <code><a href="ggforce.html#topic+facet_grid_paginate">facet_grid_paginate</a></code>.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_.problem">.problem</code></td>
<td>
<p>The $problem number to be used. By default returns
the last estimation problem.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_quiet">quiet</code></td>
<td>
<p>Logical, if <code>FALSE</code> messages are printed to the console.</p>
</td></tr>
<tr><td><code id="res_vs_cov_+3A_...">...</code></td>
<td>
<p>Any additional aesthetics to be passed on <code><a href="xpose.html#topic+xplot_scatter">xplot_scatter</a></code>
or <code><a href="#topic+xplot_box">xplot_box</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>xpose_plot</code>, <code>ggplot</code>, and <code>gg</code>. This object represents a customized plot created using <code>ggplot2</code>.
The <code>xpose_plot</code> class provides additional metadata and integration with <code>xpose</code> workflows, allowing for advanced
customization and compatibility with other <code>xpose</code> functions. Users can interact with the plot object as they
would with any <code>ggplot2</code> object, including modifying aesthetics, adding layers, or saving the plot.
</p>


<h3>Layers mapping</h3>

<p>Plots can be customized by mapping arguments to specific layers. The naming convention is
layer_option where layer is one of the names defined in the list below and option is
any option supported by this layer e.g. <code>boxplot_fill = 'blue'</code>, etc.
</p>

<ul>
<li><p> box plot: options to <code>geom_boxplot</code>
</p>
</li>
<li><p> point plot: options to <code>geom_point</code>
</p>
</li>
<li><p> line plot: options to <code>geom_line</code>
</p>
</li>
<li><p> smooth plot: options to <code>geom_smooth</code>
</p>
</li>
<li><p> xscale: options to <code>scale_x_continuous</code> or <code>scale_x_log10</code>
</p>
</li>
<li><p> yscale: options to <code>scale_y_continuous</code> or <code>scale_y_log10</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="xpose.html#topic+xplot_scatter">xplot_scatter</a></code> <code><a href="#topic+xplot_box">xplot_box</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res_vs_cov(xpose::xpdb_ex_pk,
  covariate = "SEX",
  type = "b",
  res = "WRES"
)

res_vs_cov(xpose::xpdb_ex_pk,
  covariate = "AGE",
  type = "ps",
  res = c("CWRES", "WRES", "IRES", "IWRES")
)

</code></pre>

<hr>
<h2 id='xpdb_ex_Nlme'>XposeNlme examples</h2><span id='topic+xpdb_ex_Nlme'></span>

<h3>Description</h3>

<p>One compartment NLME model with 3 covariates
<code>xpose_data</code> example built from simulated values.
</p>


<h3>Format</h3>

<p>An <code>xpose::xpose_data</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(xpdb_ex_Nlme)

</code></pre>

<hr>
<h2 id='xplot_box'>Default xpose box plot function</h2><span id='topic+xplot_box'></span>

<h3>Description</h3>

<p>Manually generate categorical covariate box plots against eta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xplot_box(
  xpdb,
  mapping = NULL,
  type = "b",
  guide = FALSE,
  yscale = "continuous",
  title = NULL,
  subtitle = NULL,
  caption = NULL,
  tag = NULL,
  plot_name = "box_plot",
  gg_theme,
  xp_theme,
  opt,
  quiet,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xplot_box_+3A_xpdb">xpdb</code></td>
<td>
<p>An xpose database object.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_mapping">mapping</code></td>
<td>
<p>List of aesthetics mappings to be used for the xpose plot
(e.g. <code>point_color</code>).</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_type">type</code></td>
<td>
<p>String setting the type of plot to be used. Only 'b' applicable.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_guide">guide</code></td>
<td>
<p>Enable guide display (e.g. unity line).</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_yscale">yscale</code></td>
<td>
<p>Scale type for y axis (e.g. 'continuous', 'discrete', 'log10').</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_title">title</code></td>
<td>
<p>Plot title. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_subtitle">subtitle</code></td>
<td>
<p>Plot subtitle. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_caption">caption</code></td>
<td>
<p>Page caption. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_tag">tag</code></td>
<td>
<p>Plot identification tag. Use <code>NULL</code> to remove.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_plot_name">plot_name</code></td>
<td>
<p>Name to be used by <code>xpose::xpose_save()</code> when saving the plot.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_gg_theme">gg_theme</code></td>
<td>
<p>A complete ggplot2 theme object (e.g.
<code>ggplot2::theme_classic</code>), a function returning a complete
ggplot2 theme, or a change to the current <code>gg_theme</code>.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_xp_theme">xp_theme</code></td>
<td>
<p>A complete xpose theme object (e.g.
<code><a href="xpose.html#topic+theme_xp_default">theme_xp_default</a></code>) or a list of modifications to the current
<code>xp_theme</code> (e.g. <code>list(point_color = 'red', line_linetype =
'dashed')</code>).</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_opt">opt</code></td>
<td>
<p>A list of options in order to create appropriate data input for
ggplot2. For more information see <code><a href="xpose.html#topic+data_opt">data_opt</a></code>.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_quiet">quiet</code></td>
<td>
<p>Logical, if <code>FALSE</code> messages are printed to the console.</p>
</td></tr>
<tr><td><code id="xplot_box_+3A_...">...</code></td>
<td>
<p>Any additional aesthetics to be passed on <code><a href="xpose.html#topic+xplot_scatter">xplot_scatter</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>xpose_plot</code>, <code>ggplot</code>, and <code>gg</code>. This object represents a customized plot created using <code>ggplot2</code>.
The <code>xpose_plot</code> class provides additional metadata and integration with <code>xpose</code> workflows, allowing for advanced
customization and compatibility with other <code>xpose</code> functions. Users can interact with the plot object as they
would with any <code>ggplot2</code> object, including modifying aesthetics, adding layers, or saving the plot.
</p>


<h3>Faceting</h3>

<p>Every xpose plot function has built-in faceting functionalities. Faceting arguments
are passed to the functions <code><a href="ggforce.html#topic+facet_wrap_paginate">facet_wrap_paginate</a></code> when the <code>facets</code>
argument is a character string (e.g. <code>facets = c('SEX', 'MED1')</code>) or
<code><a href="ggforce.html#topic+facet_grid_paginate">facet_grid_paginate</a></code> when facets is a formula (e.g. <code>facets = SEX~MED1</code>).
All xpose plot functions accept all the arguments for the <code><a href="ggforce.html#topic+facet_wrap_paginate">facet_wrap_paginate</a></code>
and <code><a href="ggforce.html#topic+facet_grid_paginate">facet_grid_paginate</a></code> functions e.g. <code>dv_vs_ipred(xpdb_ex_pk,
facets = SEX~MED1, ncol = 3, nrow = 3, page = 1, margins = TRUE, labeller = 'label_both')</code>.
</p>
<p>Faceting options can either be defined in plot functions (e.g. <code>dv_vs_ipred(xpdb_ex_pk,
facets = 'SEX')</code>) or assigned globally to an xpdb object via the <code>xp_theme</code> (e.g. <code>xpdb
&lt;- update_themes(xpdb_ex_pk, xp_theme = list(facets = 'SEX'))</code>). In the latter example all plots
generate from this xpdb will automatically be stratified by 'SEX'.
</p>
<p>By default, some plot functions use a custom stratifying variable named 'variable', e.g.
<code>eta_distrib()</code>. When using the <code>facets</code> argument, 'variable' needs to be added manually
e.g. <code>facets = c('SEX', 'variable')</code> or <code>facets = c('SEX', 'variable')</code>, but is optional,
when using the <code>facets</code> argument in <code>xp_theme</code> variable is automatically added whenever needed.
</p>


<h3>Layers mapping</h3>

<p>Plots can be customized by mapping arguments to specific layers. The naming convention is
layer_option where layer is one of the names defined in the list below and option is
any option supported by this layer e.g. boxplot_fill = 'blue', etc.
</p>

<ul>
<li><p> box plot: options to <code>geom_boxplot</code>
</p>
</li>
<li><p> yscale: options to <code>scale_y_continuous</code> or <code>scale_y_log10</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="xpose.html#topic+xplot_scatter">xplot_scatter</a></code> <code><a href="xpose.html#topic+xplot_qq">xplot_qq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Categorical Covariate MED1 vs ETA1
xplot_box(xpose::xpdb_ex_pk, ggplot2::aes(x = MED1, y = ETA1))

# Categorical Covariate SEX vs CL
xplot_box(xpose::xpdb_ex_pk, ggplot2::aes(x = SEX, y = CL))

</code></pre>

<hr>
<h2 id='xposeNlme'>Creates xpose database from Certara.RsNLME output files</h2><span id='topic+xposeNlme'></span>

<h3>Description</h3>

<p>Imports results of an NLME run into xpose database
Use to import NLME model output files into <code>xpdb</code> object that is compatible
with existing model diagnostic function in <code>Xpose</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xposeNlme(
  dir = "",
  modelName = "",
  dmpFile = "dmp.txt",
  dmp.txt = NULL,
  dataFile = "data1.txt",
  logFile = "nlme7engine.log",
  ConvergenceData = NULL,
  progresstxt = "progress.txt"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xposeNlme_+3A_dir">dir</code></td>
<td>
<p>Path to NLME Run directory. Current working directory is used if <code>dir</code> not given.</p>
</td></tr>
<tr><td><code id="xposeNlme_+3A_modelname">modelName</code></td>
<td>
<p>name of the model to be written in <code>xpdb$summary$value</code> with run label</p>
</td></tr>
<tr><td><code id="xposeNlme_+3A_dmpfile">dmpFile</code></td>
<td>
<p>NLME generated output file.</p>
</td></tr>
<tr><td><code id="xposeNlme_+3A_dmp.txt">dmp.txt</code></td>
<td>
<p>NLME generated output from dmpFile (substitutes dmpFile if presented).</p>
</td></tr>
<tr><td><code id="xposeNlme_+3A_datafile">dataFile</code></td>
<td>
<p>Input file for NLME Run.</p>
</td></tr>
<tr><td><code id="xposeNlme_+3A_logfile">logFile</code></td>
<td>
<p>engine log file</p>
</td></tr>
<tr><td><code id="xposeNlme_+3A_convergencedata">ConvergenceData</code></td>
<td>
<p>optional data frame with Nlme convergence info.</p>
</td></tr>
<tr><td><code id="xposeNlme_+3A_progresstxt">progresstxt</code></td>
<td>
<p>optional NLME-generated file 'progress.txt' with convergence info.
<code>ConvergenceData</code> has more priority if both are given.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Not all functionality from the <code>xpose</code> package is supported.
</p>


<h3>Value</h3>

<p><code>xpdb</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# files in arguments supposed to be in the current working directory:
xp &lt;- xposeNlme(
  dir = getwd(),
  modelName = "PMLModel",
  dmpFile = "dmp.txt",
  dataFile = "data1.txt",
  logFile = "nlme7engine.log",
  progresstxt = "progress.txt"
)

# using dmp.txt structure and Convergence Data loaded previously:
xp &lt;- xposeNlme(
  dir = "~/Model1/",
  modelName = "Model1",
  dmp.txt = dmp.txt,
  dataFile = "Data.csv",
  logFile = "nlme7engine.log",
  ConvergenceData = ConvergenceData
)

# explore unique covariate plots specific to Certara.Xpose.NLME:
nlme.cov.splom(xp, covColNames = c("AGE", "WT"))
nlme.par.vs.cov(xp, covColNames = c("AGE", "WT"))

res_vs_cov(xp, covariate = "AGE", res = "IWRES")

# or use existing plotting functions from the xpose package
library(xpose)
dv_vs_pred(xp)
res_vs_idv(xp)


</code></pre>

<hr>
<h2 id='xposeNlmeModel'>Creates xpose database from Certara.RsNLME objects</h2><span id='topic+xposeNlmeModel'></span>

<h3>Description</h3>

<p>Imports results of an NLME run into xpose database
Use to import NLME model object and NLME object output
into <code>xpdb</code> object that is compatible
with existing model diagnostic function in <code>Xpose</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xposeNlmeModel(model, fitmodelOutput)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xposeNlmeModel_+3A_model">model</code></td>
<td>
<p>NlmePmlModel model class object generated by <code>Certara.RsNLME</code>
package</p>
</td></tr>
<tr><td><code id="xposeNlmeModel_+3A_fitmodeloutput">fitmodelOutput</code></td>
<td>
<p>the output object of <code>Certara.RsNLME::fitmodel()</code> run.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Not all functionality from the <code>xpose</code> package is supported.
</p>


<h3>Value</h3>

<p><code>xpdb</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(Certara.RsNLME)
library(Certara.Xpose.NLME)

model &lt;- pkmodel(
  parameterization = "Clearance",
  numCompartments = 2,
  data = pkData,
  ID = "Subject",
  Time = "Act_Time",
  A1 = "Amount",
  CObs = "Conc"
)

fit &lt;- fitmodel(model)

xp &lt;- xposeNlmeModel(
  model = model,
  fitmodelOutput = fit
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
