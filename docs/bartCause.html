<!DOCTYPE html><html><head><title>Help for package bartCause</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bartCause}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bartc'><p>Causal Inference using Bayesian Additive Regression Trees</p></a></li>
<li><a href='#bartc-generics'><p>Generic Methods for <code>bartcFit</code> Objects</p></a></li>
<li><a href='#bartc-plot'><p>Plot methods for <code>bartc</code></p></a></li>
<li><a href='#summary.bartcFit'><p>Summary for <code>bartcFit</code> Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-05-01</td>
</tr>
<tr>
<td>Title:</td>
<td>Causal Inference using Bayesian Additive Regression Trees</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1-0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dbarts (&ge; 0.9-16), methods, stats, graphics, parallel, utils,
grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 0.9-0), lme4, rpart, tmle, stan4bart</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains a variety of methods to generate typical causal inference estimates using Bayesian Additive Regression Trees (BART) as the underlying regression model (Hill (2012) &lt;<a href="https://doi.org/10.1198%2Fjcgs.2010.08162">doi:10.1198/jcgs.2010.08162</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/vdorie/bartCause">https://github.com/vdorie/bartCause</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/vdorie/bartCause/issues">https://github.com/vdorie/bartCause/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-01 22:09:40 UTC; vdorie</td>
</tr>
<tr>
<td>Author:</td>
<td>Vincent Dorie <a href="https://orcid.org/0000-0002-9576-3064"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Jennifer Hill <a href="https://orcid.org/0000-0003-4983-2206"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vincent Dorie &lt;vdorie@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-01 23:24:53 UTC</td>
</tr>
</table>
<hr>
<h2 id='bartc'>Causal Inference using Bayesian Additive Regression Trees</h2><span id='topic+bartc'></span>

<h3>Description</h3>

<p>Fits a collection of treatment and response models using the Bayesian Additive
Regression Trees (BART) algorithm, producing estimates of treatment effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bartc(response, treatment, confounders, parametric, data, subset, weights,
      method.rsp = c("bart", "tmle", "p.weight"),
      method.trt = c("bart", "glm", "none"),
      estimand   = c("ate", "att", "atc"),
      group.by = NULL,
      commonSup.rule = c("none", "sd", "chisq"),
      commonSup.cut  = c(NA_real_, 1, 0.05),
      args.rsp = list(), args.trt = list(),
      p.scoreAsCovariate = TRUE, use.ranef = TRUE, group.effects = FALSE,
      crossvalidate = FALSE,
      keepCall = TRUE, verbose = TRUE,
      seed = NA_integer_,
      ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bartc_+3A_response">response</code></td>
<td>

<p>A vector of the outcome variable, or a reference to such in the <code>data</code>
argument. Can be continuous or binary.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_treatment">treatment</code></td>
<td>

<p>A vector of the binary treatment variable, or a reference to <code>data</code>.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_confounders">confounders</code></td>
<td>

<p>A matrix or data frame of covariates to be used in estimating the treatment
and response model. Can also be the right-hand-side of a formula (e.g.
<code>x1 + x2 + ...</code>). The <code>data</code> argument will be searched if
supplied.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_parametric">parametric</code></td>
<td>

<p>The right-hand-side of a formula (e.g. <code>x1 + x2 + (1 | g) ...</code>) giving the
equation of a parametric form to be used for estimating the mean structure.
See the details section below.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_data">data</code></td>
<td>

<p>An optional data frame or named list containing the <code>response</code>,
<code>treatment</code>, and <code>confounders</code>.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_subset">subset</code></td>
<td>

<p>An optional vector using to subset the data. Can refer to <code>data</code> if
provided.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_weights">weights</code></td>
<td>

<p>An optional vector of population weights used in model fitting and
estimating the treatment effect. Can refer to <code>data</code> if provided.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_method.rsp">method.rsp</code></td>
<td>

<p>A character string specifying which method to use when fitting the response
surface and estimating the treatment effect. Options are: <code>"bart"</code> -
fit the response surface with BART and take the average of the individual
treatment effect estimates, <code>"p.weight"</code> - fit the response surface
with BART but compute the treatment effect estimate by using a propensity
score weighted sum of individual effects, and <code>"tmle"</code> - as above, but
further adjust the individual estimates using the Targeted Minimum Loss
based Estimation (TMLE) adjustment.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_method.trt">method.trt</code></td>
<td>

<p>A character string specifying which method to use when fitting the treatment
assignment mechanism, or a vector/matrix of propensity scores. Character
string options are: <code>"bart"</code> - fit BART directly to the treatment
variable, <code>"glm"</code> - fit a generalized linear model with a binomial
response and all confounders added linearly, and <code>"none"</code> - do no
propensity score estimation. Cannot be <code>"none"</code> if the response model
requires propensity scores. When supplied as a matrix, it should be of
dimensions equal to the number of observations times the number of samples
used in any response model.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_estimand">estimand</code></td>
<td>

<p>A character string specifying which causal effect to target. Options are
<code>"ate"</code> - average treatment effect, <code>"att"</code> - average treatment
effect on the treated, and <code>"atc"</code> - average treatment effect on the
controls.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_group.by">group.by</code></td>
<td>

<p>An optional factor that, when present, causes the treatment effect estimate
to be calculated within each group.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_commonsup.rule">commonSup.rule</code></td>
<td>

<p>Rule for exclusion of observations lacking in common support. Options are
<code>"none"</code> - no suppression, <code>"sd"</code> - exclude units whose predicted
counterfactual standard deviation is extreme compared to the maximum
standard deviation under those units' observed treatment condition, where
extreme refers to the distribution of all standard deviations of observed
treatment conditions, <code>"chisq"</code> - exclude observations according to
ratio of the variance of posterior predicted counterfactual to the posterior
variance of the observed condition, having a Chi Squared distribution with
one degree of freedom under the null hypothesis of have equal distributions.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_commonsup.cut">commonSup.cut</code></td>
<td>

<p>Cutoffs for <code>commonSup.rule</code>. Ignored for <code>"none"</code>, when
<code>commonSup.rule</code> is <code>"sd"</code>, refers to how many standard deviations
of the distribution of posterior variance for counterfactuals an observation
can be above the maximum of posterior variances for that treatment
condition. When <code>commonSup.rule</code> is <code>"chisq"</code>, is the <code class="reqn">p</code>
value used for rejection of the hypothesis of equal variances.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_p.scoreascovariate">p.scoreAsCovariate</code></td>
<td>

<p>A logical such that when <code>TRUE</code>, the propensity score is added to the
response model as a covariate. When used, this is equivalent to the 
'ps-BART' method described by described by Hahn, Murray, and Carvalho.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_use.ranef">use.ranef</code></td>
<td>

<p>Logical specifying if <code>group.by</code> variable - when present - should be
included as a &quot;random&quot; or &quot;fixed&quot; effect. If true,
<code><a href="dbarts.html#topic+rbart_vi">rbart</a></code> will be used for BART models. Using random
effects for treatment assignment mechanisms of type <code>"glm"</code> require
that the <code><a href="lme4.html#topic+lme4-package">lme4</a></code> package be available.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_group.effects">group.effects</code></td>
<td>

<p>Logical specifying if effects should be calculated within groups if the
<code>group.by</code> variable is provided. Response methods of <code>"tmle"</code> and
<code>"p.weight"</code> are such that if group effects are calculated, then the
population effect is not provided.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_keepcall">keepCall</code></td>
<td>

<p>A logical such that when <code>FALSE</code>, the call to <code>bartc</code> is not kept.
This can reduce the  amount of information printed by
<code><a href="#topic+summary.bartcFit">summary</a></code> when passing in data as literals.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_crossvalidate">crossvalidate</code></td>
<td>

<p>One of <code>TRUE</code>, <code>FALSE</code>, <code>"trt"</code>, or <code>"rsp"</code>. Enables
code to attempt to estimate the optimal end-node sensitivity parameter. This
uses a rudimentary Bayesian optimization routine and can be extremely slow.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_verbose">verbose</code></td>
<td>

<p>A logical that when <code>TRUE</code> prints information as the model is fit.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_seed">seed</code></td>
<td>

<p>Optional integer specifying the desired pRNG <a href="base.html#topic+set.seed">seed</a>. It should not be needed
when running single-threaded - <code><a href="base.html#topic+set.seed">set.seed</a></code> will suffice, and can be used to
obtain reproducible results when multi-threaded. See Reproducibility section of
<code><a href="dbarts.html#topic+bart2">bart2</a></code>.
</p>
</td></tr>
<tr><td><code id="bartc_+3A_args.rsp">args.rsp</code>, <code id="bartc_+3A_args.trt">args.trt</code>, <code id="bartc_+3A_...">...</code></td>
<td>
 
<p>Further arguments to the treatment and response model fitting algorithms.
Arguments passed to the main function as ... will be used in both models.
<code>args.rsp</code> and <code>args.trt</code> can be used to set parameters in a
single fit, and will override other values. See <code><a href="stats.html#topic+glm">glm</a></code> and
<code><a href="dbarts.html#topic+bart2">bart2</a></code> for reference.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bartc</code> represents a collection of methods that primarily use the
Bayesian Additive Regression Trees (BART) algorithm to estimate causal
treatment effects with binary treatment variables and continuous or binary
outcomes. This requires models to be fit to the response surface (distribution
of the response as a function of treatment and confounders,
<code class="reqn">p(Y(1), Y(0) | X)</code> and optionally for treatment assignment mechanism
(probability of receiving treatment, i.e. propensity score,
<code class="reqn">Pr(Z = 1 | X)</code>). The response surface model is used to impute
counterfactuals, which may then be adjusted together with the propensity score
to produce estimates of effects.
</p>
<p>Similar to <code><a href="stats.html#topic+lm">lm</a></code>, models can be specified symbolically. When the
<code>data</code> term is present, it will be added to the search path for the
<code>response</code>, <code>treatment</code>, and <code>confounders</code> variables. The
confounders must be specified devoid of any &quot;left hand side&quot;, as they appear
in both of the models.
</p>
<p><strong>Response Surface</strong>
</p>
<p>The response surface methods included are:
</p>

<ul>
<li> <p><code>"bart"</code> - use BART to fit the response surface and produce
individual estimates <code class="reqn">\hat{Y}(1)_i</code> and
<code class="reqn">\hat{Y}(0)_i</code>. Treatment effect estimates are
obtained by averaging the difference of these across the population of
interest.
</p>
</li>
<li> <p><code>"p.weight"</code> - individual effects are estimated as in
<code>"bart"</code>, but treatment effect estimates are obtained by using a
propensity score weighted average. For the average treatment effect on
the treated, these weights are <code class="reqn">p(z_i | x_i) / (\sum z / n)</code>. For
ATC, replace <code class="reqn">z</code> with <code class="reqn">1 - z</code>. For ATE, <code>"p.weight"</code> is
equal to <code>"bart"</code>.
</p>
</li>
<li> <p><code>"tmle"</code> - individual effects are estimated as in <code>"bart"</code>
and a weighted average is taken as in <code>"p.weight"</code>, however the
response surface estimates and propensity scores are corrected by
using the Targeted Minimum Loss based Estimation method.
</p>
</li></ul>

<p><strong>Treatment Assignment</strong>
</p>
<p>The treatment assignment models are:
</p>

<ul>
<li> <p><code>"bart"</code> - fit a binary BART directly to the treatment using all
the confounders.
</p>
</li>
<li> <p><code>"none"</code> - no modeling is done. Only applies when using response
method <code>"bart"</code> and <code>p.scoreAsCovariate</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>"glm"</code> - fit a binomial generalized linear model with logistic
link and confounders included as linear terms.
</p>
</li>
<li><p> Finally, a vector or matrix of propensity scores can be supplied.
Propensity score matrices should have a number of rows equal to the
number of observations in the data and a number of columns equal to
the number of posterior samples.
</p>
</li></ul>

<p><strong>Parametrics</strong>
</p>
<p><code>bartc</code> uses the <code>stan4bart</code> package, when available, to fit semi-
parametric surfaces. Equations can be given as to <code><a href="stats.html#topic+lm">lm</a></code>. Grouping
structures are also permitted, and use the syntax of <code><a href="lme4.html#topic+lmer">lmer</a></code>.
</p>
<p><strong>Generics</strong>
</p>
<p>For a fitted model, the easiest way to analyze the resulting fit is to use the
<a href="#topic+bartc-generics">generics</a> <code>fitted</code>, <code>extract</code>, and
<code>predict</code> to analyze specific quantities and
<code><a href="#topic+summary.bartcFit">summary</a></code> to aggregate those values into
targets (e.g. ATE, ATT, or ATC).
</p>
<p><strong>Common Support Rules</strong>
</p>
<p>Common support, or that the probability of receiving all treatment conditions
is non-zero within every area of the covariate space
(<code class="reqn">P(Z = 1 | X = x) &gt; 0</code> for all <code class="reqn">x</code> in the inferential sample), can be
enforced by excluding observations with high posterior uncertainty.
<code>bartc</code> supports two common support rules through <code>commonSup.rule</code>
argument:
</p>

<ul>
<li> <p><code>"sd"</code> - observations are cut from the inferential sample if:
<code class="reqn">s_i^{f(1-z)} &gt; m_z + a \times sd(s_j^{f(z)}</code>,
where <code class="reqn">s_i^{f(1-z)}</code> is the posteriors standard
deviation of the predicted counterfactual for observation <code class="reqn">i</code>,
<code class="reqn">s_j^f(z)</code> is the posterior standard deviation of the prediction
for the observed treatment condition of observation <code class="reqn">j</code>,
<code class="reqn">sd(s_j^{f(z)}</code> is the empirical standard deviation
of those quantities, and
<code class="reqn">m_z = max_j \{s_j^{f(z)}\}</code> for all <code class="reqn">j</code>
in the same treatment group, i.e. <code class="reqn">Z_j = z</code>. <code class="reqn">a</code> is a constant
to be passed in using <code>commonSup.cut</code> and its default is 1.
</p>
</li>
<li> <p><code>"chisq"</code> - observations are cut from the inferential sample if:
<code class="reqn">(s_i^{f(1-z)} / s_i^{f(z)})^2 &gt; q_\alpha</code>,
where <code class="reqn">s_i</code> are as above and <code class="reqn">q_\alpha</code>, is the upper
<code class="reqn">\alpha</code> percentile of a <code class="reqn">\chi^2</code> distribution with one degree
of freedom, corresponding to a null hypothesis of equal variance. The
default for <code class="reqn">\alpha</code> is 0.05, and it is specified using the
<code>commonSup.cut</code> parameter.
</p>
</li></ul>

<p><strong>Special Arguments</strong>
</p>
<p>Some default arguments are unconventional or are passed in a unique fashion.
</p>

<ul>
<li><p> If <code>n.chains</code> is missing, unlike in <code><a href="dbarts.html#topic+bart2">bart2</a></code> a default
of 10 is used.
</p>
</li>
<li><p> For <code>method.rsp == "tmle"</code>, a special <code>arg.trt</code> of
<code>posteriorOfTMLE</code> determines if the TMLE correction should be
applied to each posterior sample (<code>TRUE</code>), or just the posterior
mean (<code>FALSE</code>).
</p>
</li></ul>

<p><strong>Missing Data</strong>
</p>
<p>Missingness is allowed only in the response. If some response values are
<code>NA</code>, the BART models will be trained just for where data are available
and those values will be used to make predictions for the missing
observations. Missing observations are not used when calculating statistics
for assessing common support, although they may still be excluded on those
grounds. Further, missing observations may not be compatible with response
method <code>"tmle"</code>.
</p>


<h3>Value</h3>

<p><code>bartc</code> returns an object of class <code>bartcFit</code>. Information about the
object can be derived by using methods <code><a href="#topic+bartc-generics">summary</a></code>,
<code><a href="#topic+plot_sigma">plot_sigma</a></code>, <code><a href="#topic+plot_est">plot_est</a></code>, <code><a href="#topic+plot_indiv">plot_indiv</a></code>,
and <code><a href="#topic+plot_support">plot_support</a></code>. Numerical quantities are recovered with the
<code><a href="#topic+bartc-generics">fitted</a></code> and
<code><a href="#topic+bartc-generics">extract</a></code> generics. Predictions for new
observations are obtained with <code><a href="#topic+bartc-generics">predict</a></code>.
</p>
<p>Objects of class <code>bartcFit</code> are lists containing items:
</p>
<table>
<tr><td><code>method.rsp</code></td>
<td>
<p>character string specifying the method used to fit
the response surface</p>
</td></tr>
<tr><td><code>method.trt</code></td>
<td>
<p>character string specifying the method used to fit
the treatment assignment mechanism</p>
</td></tr>
<tr><td><code>estimand</code></td>
<td>
<p>character string specifying the targeted causal
effect</p>
</td></tr>
<tr><td><code>fit.rsp</code></td>
<td>
<p>object containing the fitted response model</p>
</td></tr>
<tr><td><code>data.rsp</code></td>
<td>
<p><code><a href="dbarts.html#topic+dbartsData">dbartsData</a></code> object used when fitting the
response model</p>
</td></tr>
<tr><td><code>fit.trt</code></td>
<td>
<p>object containing the fitted treatment model</p>
</td></tr>
<tr><td><code>group.by</code></td>
<td>
<p>optional factor vector containing the groups in which
treatment effects are estimated</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>matrix or array of posterior samples of the treatment effect
estimate</p>
</td></tr>
<tr><td><code>p.score</code></td>
<td>
<p>the vector of propensity scores used as a covariate in
the response model, when applicable</p>
</td></tr>
<tr><td><code>samples.p.score</code></td>
<td>
<p>matrix or array of posterior samples of the
propensity score, when applicable</p>
</td></tr>
<tr><td><code>mu.hat.obs</code></td>
<td>
<p>samples from the posterior of the expected value for
individual responses under the observed treatment
regime</p>
</td></tr>
<tr><td><code>mu.hat.cf</code></td>
<td>
<p>samples from the posterior of the expected value for
individual responses under the counterfactual
treatment</p>
</td></tr>
<tr><td><code>name.trt</code></td>
<td>
<p>character string giving the name of the treatment
variable in the data of <code>fit.rsp</code></p>
</td></tr>
<tr><td><code>trt</code></td>
<td>
<p>vector of treatment assignments</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>how <code>bartc</code> was called</p>
</td></tr>
<tr><td><code>n.chains</code></td>
<td>
<p>number of independent posterior sampler chains in 
response model</p>
</td></tr>
<tr><td><code>commonSup.rule</code></td>
<td>
<p>common support rule used for suppressing
observations</p>
</td></tr>
<tr><td><code>commonSup.cut</code></td>
<td>
<p>common support parameter used to set cutoff when
suppressing observations</p>
</td></tr>
<tr><td><code>sd.obs</code></td>
<td>
<p>vector of standard deviations of individual posterior
predictors for observed treatment conditions</p>
</td></tr>
<tr><td><code>sd.cf</code></td>
<td>
<p>vector of standard deviations of individual posterior
predictors for counterfactuals</p>
</td></tr>
<tr><td><code>commonSup.sub</code></td>
<td>
<p>logical vector expressing which observations are
used when estimating treatment effects</p>
</td></tr>
<tr><td><code>use.ranef</code></td>
<td>
<p>logical for whether ranef models were used; only added
when true</p>
</td></tr>
<tr><td><code>group.effects</code></td>
<td>
<p>logical for whether group-level estimates are
made; only added when true</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>a random seed for use when drawing from the posterior
predictive distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vincent Dorie: <a href="mailto:vdorie@gmail.com">vdorie@gmail.com</a>.
</p>


<h3>References</h3>

<p>Chipman, H., George, E. and McCulloch R. (2010)
BART: Bayesian additive regression trees.
<em>The Annals of Applied Statistics</em> <b>4(1)</b>, 266&ndash;298.
The Institute of Mathematical Statistics.
<a href="https://doi.org/10.1214/09-AOAS285">doi:10.1214/09-AOAS285</a>.
</p>
<p>Hill, J. L. (2011)
Bayesian Nonparametric Modeling for Causal Inference.
<em>Journal of Computational and Graphical Statistics</em> <b>20(1)</b>, 217&ndash;240.
Taylor &amp; Francis.
<a href="https://doi.org/10.1198/jcgs.2010.08162">doi:10.1198/jcgs.2010.08162</a>.
</p>
<p>Hill, J. L. and Su Y. S. (2013)
Assessing Lack of Common Support in Causal Inference Using Bayesian Nonparametrics: Implications for Evaluating the Effect of Breastfeeding on Children's Cognitive Outcomes
<em>The Annals of Applied Statistics</em> <b>7(3)</b>, 1386&ndash;1420.
The Institute of Mathematical Statistics.
<a href="https://doi.org/10.1214/13-AOAS630">doi:10.1214/13-AOAS630</a>.
</p>
<p>Carnegie, N. B. (2019)
Comment: Contributions of Model Features to BART Causal Inference Performance Using ACIC 2016 Competition Data
<em>Statistical Science</em> <b>34(1)</b>, 90&ndash;93.
The Institute of Mathematical Statistics.
<a href="https://doi.org/10.1214/18-STS682">doi:10.1214/18-STS682</a>
</p>
<p>Hahn, P. R., Murray, J. S., and Carvalho, C. M. (2020)
Bayesian Regression Tree Models for Causal Inference: Regularization, Confounding, and Heterogeneous Effects (with Discussion).
<em>Bayesian Analysis</em> <b>15(3)</b>, 965&ndash;1056.
International Society for Bayesian Analysis.
<a href="https://doi.org/10.1214/19-BA1195">doi:10.1214/19-BA1195</a>.
</p>


<h3>See Also</h3>

<p><code><a href="dbarts.html#topic+bart2">bart2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## fit a simple linear model
n &lt;- 100L
beta.z &lt;- c(.75, -0.5,  0.25)
beta.y &lt;- c(.5,   1.0, -1.5)
sigma &lt;- 2

set.seed(725)
x &lt;- matrix(rnorm(3 * n), n, 3)
tau &lt;- rgamma(1L, 0.25 * 16 * rgamma(1L, 1 * 32, 32), 16)

p.score &lt;- pnorm(x %*% beta.z)
z &lt;- rbinom(n, 1, p.score)

mu.0 &lt;- x %*% beta.y
mu.1 &lt;- x %*% beta.y + tau

y &lt;- mu.0 * (1 - z) + mu.1 * z + rnorm(n, 0, sigma)

# low parameters only for example
fit &lt;- bartc(y, z, x, n.samples = 100L, n.burn = 15L, n.chains = 2L)
summary(fit)

## example to show refitting under the common support rule
fit2 &lt;- refit(fit, commonSup.rule = "sd")
fit3 &lt;- bartc(y, z, x, subset = fit2$commonSup.sub,
              n.samples = 100L, n.burn = 15L, n.chains = 2L)
</code></pre>

<hr>
<h2 id='bartc-generics'>Generic Methods for <code>bartcFit</code> Objects</h2><span id='topic+bartc-generics'></span><span id='topic+extract'></span><span id='topic+fitted.bartcFit'></span><span id='topic+extract.bartcFit'></span><span id='topic+refit'></span><span id='topic+refit.bartcFit'></span><span id='topic+predict.bartcFit'></span>

<h3>Description</h3>

<p>Visual exploratory data analysis and model fitting diagnostics for causal inference models fit
using the <code><a href="#topic+bartc">bartc</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bartcFit'
fitted(object,
       type = c("pate", "sate", "cate", "mu.obs", "mu.cf", "mu.0",
                "mu.1", "y.cf", "y.0", "y.1", "icate", "ite",
                "p.score", "p.weights"),
       sample = c("inferential", "all"),
       ...)

extract(object, ...)

## S3 method for class 'bartcFit'
extract(object,
        type = c("pate", "sate", "cate", "mu.obs", "mu.cf", "mu.0",
                 "mu.1", "y.cf", "y.0", "y.1", "icate", "ite",
                 "p.score", "p.weights", "sigma"),
        sample = c("inferential", "all"),
        combineChains = TRUE,
        ...)

## S3 method for class 'bartcFit'
predict(object, newdata,
        group.by,
        type = c("mu", "y", "mu.0", "mu.1", "y.0", "y.1", "icate", "ite",
                 "p.score"),
        combineChains = TRUE,
        ...)

refit(object, newresp, ...)

## S3 method for class 'bartcFit'
refit(object,
      newresp = NULL,
      commonSup.rule = c("none", "sd", "chisq"),
      commonSup.cut  = c(NA_real_, 1, 0.05),
      ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bartc-generics_+3A_object">object</code></td>
<td>

<p>Object of class <code>bartcFit</code>.
</p>
</td></tr>
<tr><td><code id="bartc-generics_+3A_type">type</code></td>
<td>

<p>Which quantity to return. See details for a description of possible values.
</p>
</td></tr>
<tr><td><code id="bartc-generics_+3A_sample">sample</code></td>
<td>

<p>Return information for either the <code>"inferential"</code> (e.g. treated observations when the estimand is
<code>att</code>) or <code>"all"</code> observations.
</p>
</td></tr>
<tr><td><code id="bartc-generics_+3A_combinechains">combineChains</code></td>
<td>

<p>If the models were fit with more than one chain, results retain the chain structure unless
<code>combineChains</code> is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="bartc-generics_+3A_newresp">newresp</code></td>
<td>

<p>Not presently used, but provided for compatibility with other definitions of the <code>refit</code> generic.
</p>
</td></tr>
<tr><td><code id="bartc-generics_+3A_newdata">newdata</code></td>
<td>

<p>Data corresponding to the confounders in a <code><a href="#topic+bartc">bartc</a></code> fit.
</p>
</td></tr>
<tr><td><code id="bartc-generics_+3A_group.by">group.by</code></td>
<td>

<p>Optional grouping variable. See definition of <code>group.by</code> in <code><a href="#topic+bartc">bartc</a></code>.
</p>
</td></tr>
<tr><td><code id="bartc-generics_+3A_commonsup.rule">commonSup.rule</code>, <code id="bartc-generics_+3A_commonsup.cut">commonSup.cut</code></td>
<td>
<p>As in <code><a href="#topic+bartc">bartc</a></code>.</p>
</td></tr>
<tr><td><code id="bartc-generics_+3A_...">...</code></td>
<td>

<p>Additional parameters passed up the generic method chain.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>fitted</code> returns the values that would serve as predictions for an object returned by the
<code><a href="#topic+bartc">bartc</a></code> function, while <code>extract</code> instead returns the full matrix or array of posterior
samples. The possible options are:
</p>

<ul>
<li> <p><code>"pate", "sate", "cate"</code> - various target quantities; see <code><a href="#topic+summary.bartcFit">summary</a></code>
</p>
</li>
<li> <p><code>"mu"</code> - predict only: expected value; requires user-supplied treatment variable in
<code>newdata</code>
</p>
</li>
<li> <p><code>"y"</code> - predict only: sample of the response; requires user-supplied treatment variable in
<code>newdata</code>
</p>
</li>
<li> <p><code>"mu.obs"</code> - (samples from the posterior of) the expected value under the observed
treatment condition, i.e.
<code class="reqn">\hat{mu}_i(1) * z_i + \hat{mu}_i(0) * (1 - z_i)</code>
</p>
</li>
<li> <p><code>"mu.cf"</code> - the expected value under the counterfactual treatment condition, i.e.
<code class="reqn">\hat{mu}_i(1) * (1 - z_i) + \hat{mu}_i(0) * z_i)</code>
</p>
</li>
<li> <p><code>"mu.0"</code> - the expected value under the control condition
</p>
</li>
<li> <p><code>"mu.1"</code> - the expected value under the treated condition
</p>
</li>
<li> <p><code>"y.cf"</code> - samples of the response under the the counterfactual treatment condition, i.e.
<code class="reqn">\hat{y}_i(1 - z_i))</code>; values are obtained by adding noise to <code>mu.cf</code>
using the posterior predictive distribution
</p>
</li>
<li> <p><code>"y.0"</code> - observed responses under the control together with predicted under the treated, i.e.
<code class="reqn">\hat{y}_i(1) * z_i + y(0) * (1 - z_i)</code>
</p>
</li>
<li> <p><code>"y.1"</code> - observed responses under the treatment together with predicted under the control, i.e.
<code class="reqn">y_i(1) * z_i + \hat{y}(0) * (1 - z_i)</code>
</p>
</li>
<li> <p><code>"ite"</code> - (sample) individual treatment effect estimates, i.e.
<code class="reqn">(y_i(z_i) - y_i(1 - z_i)) * (2z_i - 1)</code>; uses observed responses and posterior
predicted counterfactuals
</p>
</li>
<li> <p><code>"icate"</code> - individual conditional average treatment effect estimates, i.e.
<code class="reqn">\hat{mu}_i(1) - \hat{mu}_i(0)</code>
</p>
</li>
<li> <p><code>"p.score"</code> - probability that each observation is assigned to the treatment group
</p>
</li>
<li> <p><code>"p.weights"</code> - weights assigned to each individual difference if the response method
is <code>"p.weight"</code>
</p>
</li>
<li> <p><code>"sigma"</code> - residual standard deviation from continuous response models
</p>
</li></ul>

<p><code>refit</code> exists to allow the same regressions to be used to calculate estimates under different
common support rules. To refit those models on a subset, see the examples in <code><a href="#topic+bartc">bartc</a></code>.
</p>
<p><code>predict</code> allows the fitted model to be used to make predictions on an out-of-sample set.
Requires model to be fit with <code>keepTrees</code> equal to <code>TRUE</code>. As &lsquo;<code>y</code>&rsquo; values are
all considered out of sample, the posterior predictive distribution is always used when relevant.
</p>


<h3>Value</h3>

<p>For <code>fitted</code>, <code>extract</code>, and <code>predict</code>, a matrix, array, or vector depending on the
dimensions of the result and the number of chains. For the following, when <code>n.chains</code> is one
the dimension is dropped.
</p>

<ul>
<li> <p><code>"pate"</code>, <code>"sate"</code>, or <code>"cate"</code> - with <code>fitted</code>, a scalar; with
<code>extract</code>, <code>n.chains x n.samples</code>
</p>
</li>
<li> <p><code>"p.score"</code> - depending on the fitting method, samples may or not be present; when samples
are absent, a vector is returned for both functions; when present, the same as <code>"y"</code>.
</p>
</li>
<li><p> all other types - with <code>fitted</code>, a vector of length equal to the number of
observations (<code>n.obs</code>); with <code>extract</code> or <code>predict</code>, a matrix or array of
dimensions <code>n.chains x n.samples x n.obs</code>.
</p>
</li></ul>

<p>For <code>refit</code>, an object of class <code>bartcFit</code>.
</p>


<h3>Author(s)</h3>

<p>Vincent Dorie: <a href="mailto:vdorie@gmail.com">vdorie@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bartc">bartc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## fit a simple linear model
n &lt;- 100L
beta.z &lt;- c(.75, -0.5,  0.25)
beta.y &lt;- c(.5,   1.0, -1.5)
sigma &lt;- 2

set.seed(725)
x &lt;- matrix(rnorm(3 * n), n, 3)
tau &lt;- rgamma(1L, 0.25 * 16 * rgamma(1L, 1 * 32, 32), 16)

p.score &lt;- pnorm(x %*% beta.z)
z &lt;- rbinom(n, 1, p.score)

mu.0 &lt;- x %*% beta.y
mu.1 &lt;- x %*% beta.y + tau

y &lt;- mu.0 * (1 - z) + mu.1 * z + rnorm(n, 0, sigma)

# low parameters only for example
fit &lt;- bartc(y, z, x, n.samples = 100L, n.burn = 15L, n.chains = 2L)

# compare fit to linear model
lm.fit &lt;- lm(y ~ z + x)

plot(fitted(fit, type = "mu.obs"), fitted(lm.fit))

# rank order sample individual treatment effect estimates and plot
ites   &lt;- extract(fit, type = "ite")
ite.m  &lt;- apply(ites, 2, mean)
ite.sd &lt;- apply(ites, 2, sd)
ite.lb &lt;- ite.m - 2 * ite.sd
ite.ub &lt;- ite.m + 2 * ite.sd

ite.o &lt;- order(ite.m)

plot(NULL, type = "n",
     xlim = c(1, length(ite.m)), ylim = range(ite.lb, ite.ub),
     xlab = "effect order", ylab = "individual treatment effect")
lines(rbind(seq_along(ite.m), seq_along(ite.m), NA),
      rbind(ite.lb[ite.o], ite.ub[ite.o], NA), lwd = 0.5)
points(seq_along(ite.m), ite.m[ite.o], pch = 20)

</code></pre>

<hr>
<h2 id='bartc-plot'>Plot methods for <code>bartc</code></h2><span id='topic+bartc-plot'></span><span id='topic+plot_sigma'></span><span id='topic+plot_est'></span><span id='topic+plot_indiv'></span><span id='topic+plot_support'></span>

<h3>Description</h3>

<p>Visual exploratory data analysis and model fitting diagnostics for causal inference models fit
using the <code><a href="#topic+bartc">bartc</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sigma(x, main = "Traceplot sigma", 
           xlab = "iteration", ylab = "sigma",
           lty = 1:x$n.chains,
           ...)

plot_est(x, main = paste("Traceplot", x$estimand),
         xlab = "iteration", ylab = x$estimand,
         lty = 1:x$n.chains, col = NULL,
         ...)

plot_indiv(x, main = "Histogram Individual Quantities",
           type = c("icate", "mu.obs", "mu.cf", "mu.0",
                    "mu.1", "y.cf", "y.0", "y.1", "ite"),
           xlab = "treatment effect",
           breaks = 20,
           ...)

plot_support(x, main = "Common Support Scatterplot",
             xvar = "tree.1", yvar = "tree.2",
             sample = c("inferential", "all"),
             xlab = NULL, ylab = NULL,
             pch.trt = 21, bg.trt = "black",
             pch.ctl = pch.trt, bg.ctl = NA,
             pch.sup = pch.trt, bg.sup = NA, col.sup = "red", cex.sup = 1.5,
             legend.x = "topleft", legend.y = NULL,
             ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bartc-plot_+3A_x">x</code></td>
<td>

<p>Object of class <code>bartcFit</code>.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_main">main</code></td>
<td>

<p>Character title of plot.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_xlab">xlab</code></td>
<td>

<p>Character label of <code class="reqn">x</code> axis. For <code>plot_support</code>, if <code>NULL</code> a default will be used.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_ylab">ylab</code></td>
<td>

<p>Character label of <code class="reqn">y</code> axis. For <code>plot_support</code>, if <code>NULL</code> a default will be used.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_lty">lty</code></td>
<td>

<p>For line plots (<code>plot_sigma</code>, <code>plot_est</code>), models use the values of <code>lty</code> to
visually distinguish each chain.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_col">col</code></td>
<td>

<p>For line plots, use <code>col</code> vector to distinguish between groups (if any).
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_breaks">breaks</code></td>
<td>

<p>Argument to <code><a href="graphics.html#topic+hist">hist</a></code>.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_type">type</code></td>
<td>

<p>The individual quantity to be plotted. See <code><a href="#topic+bartc-generics">fitted</a></code>.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_xvar">xvar</code></td>
<td>

<p>Variable for use on <code class="reqn">x</code> axis.  Can be one of <code>"tree.XX"</code>, <code>"pca.XX"</code>, <code>"css"</code>, 
any individual level quantity accepted by <code><a href="#topic+bartc-generics">fitted</a></code>, the number or 
name of a column used to fit the response model, or a given vector. See below for details.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_sample">sample</code></td>
<td>

<p>Return information for either the <code>"inferential"</code> (e.g. treated observations when the estimand is
<code>att</code>) or <code>"all"</code> observations.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_yvar">yvar</code></td>
<td>

<p>Variable for use on the <code class="reqn">y</code> axis, of the same form as <code>xvar</code>.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_pch.trt">pch.trt</code></td>
<td>

<p><code>pch</code> point value used when plotting treatment observations.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_bg.trt">bg.trt</code></td>
<td>

<p><code>bg</code> background value used when plotting treatment observations.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_pch.ctl">pch.ctl</code></td>
<td>

<p><code>pch</code> point value used when plotting control observations.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_bg.ctl">bg.ctl</code></td>
<td>

<p><code>bg</code> background value used when plotting treatment observations.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_pch.sup">pch.sup</code></td>
<td>

<p><code>pch</code> point value used when plotting suppressed observations.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_bg.sup">bg.sup</code></td>
<td>

<p><code>bg</code> background value used when plotting suppressed observations.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_col.sup">col.sup</code></td>
<td>

<p><code>col</code> color value used when plotting suppressed observations.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_cex.sup">cex.sup</code></td>
<td>

<p><code>cex</code> size value used when plotting suppressed observations.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_legend.x">legend.x</code></td>
<td>

<p>x value passed to <code><a href="graphics.html#topic+legend">legend</a></code>. If <code>NULL</code>, legend plotting is skipped.
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_legend.y">legend.y</code></td>
<td>

<p>Optional y value passed to <code>legend</code>
</p>
</td></tr>
<tr><td><code id="bartc-plot_+3A_...">...</code></td>
<td>

<p>Optional graphical parameters.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces various plots using objects fit by <code><a href="#topic+bartc">bartc</a></code>. <code>plot_sigma</code> and <code>plot_est</code>
are traditional parameter trace plots that can be used to diagnose the convergence of the posterior
sampler. If the <code>bartc</code> model is fit with <code>n.chains</code> greater than one, by default each chain
will be plotted with its own line type.
</p>
<p><code>plot_indiv</code> produces a simple histogram of the distribution of the estimates of the individual
effects, taken as the average of their posterior samples.
</p>
<p><code>plot_support</code> is used to visualize the common support diagnostic in the form of a scatterplot.
Points that the diagnostic excludes are outlined in red. The contents of the <code class="reqn">x</code> and <code class="reqn">y</code> axes
are controlled by the <code>xvar</code> and <code>yvar</code> arguments respectively and can be of the form:
</p>

<ul>
<li> <p><code>"tree.XX"</code> - Variable number <code>"XX"</code> as selected by variable importance in predicting
individual treatment effects using a tree fit by <code><a href="rpart.html#topic+rpart">rpart</a></code>. <code>"XX"</code> must be a number
not exceeding the number of continuous variables used to fit the response model.
</p>
</li>
<li> <p><code>"pca.XX"</code> - <code>"XX"</code>th principal component axis.
</p>
</li>
<li> <p><code>"css"</code> - The common support statistic.
</p>
</li>
<li> <p><code>"y"</code> - Observed response variable.
</p>
</li>
<li> <p><code>"y0"</code> - Predicted values for the response under the control as obtained by <code><a href="stats.html#topic+fitted">fitted</a></code>.
</p>
</li>
<li> <p><code>"y1"</code> - Predicted values for the response under the treatment  <code><a href="stats.html#topic+fitted">fitted</a></code>.
</p>
</li>
<li> <p><code>"indiv.diff"</code> - Individual treatment effect estimates, or <code class="reqn">\hat{y}(1) - \hat{y}(0)</code>.
</p>
</li>
<li> <p><code>"p.score"</code> - Propensity score used to fit the response model (if applicable).
</p>
</li>
<li> <p><code>"p.weights"</code> - Weights used when taking average of individual differences for response method
<code>"p.weight"</code>.
</p>
</li>
<li><p> predictor columns - Given by name or number.
</p>
</li>
<li><p> supplied vector - Any vector of length equal to the number of observations.
</p>
</li></ul>



<h3>Value</h3>

<p>None, although plotting occurs as a side-effect.
</p>


<h3>Author(s)</h3>

<p>Vincent Dorie: <a href="mailto:vdorie@gmail.com">vdorie@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bartc">bartc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate fake data using a simple linear model
n &lt;- 100L
beta.z &lt;- c(.75, -0.5,  0.25)
beta.y &lt;- c(.5,   1.0, -1.5)
sigma &lt;- 2

set.seed(725)
x &lt;- matrix(rnorm(3 * n), n, 3)
tau &lt;- rgamma(1L, 0.25 * 16 * rgamma(1L, 1 * 32, 32), 16)

p.score &lt;- pnorm(x %*% beta.z)
z &lt;- rbinom(n, 1, p.score)

mu.0 &lt;- x %*% beta.y
mu.1 &lt;- x %*% beta.y + tau

y &lt;- mu.0 * (1 - z) + mu.1 * z + rnorm(n, 0, sigma)

# run with low parameters only for example
fit &lt;- bartc(y, z, x, n.samples = 100L, n.burn = 15L, n.chains = 2L,
             n.threads = 1L,
             commonSup.rule = "sd")


## plot specific functions

# sigma plot can be used to access convergence of chains
plot_sigma(fit)

# show points lacking common support
plot_support(fit, xvar = "tree.1", yvar = "css", legend.x = NULL)

# see example in ?"bartc-generics" for rank-ordered individual effects plot
</code></pre>

<hr>
<h2 id='summary.bartcFit'>Summary for <code>bartcFit</code> Objects</h2><span id='topic+summary.bartcFit'></span>

<h3>Description</h3>

<p>Summarizes <code>bartc</code> fits by calculating target quantities and uncertainty estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bartcFit'
summary(object,
                           target = c("pate", "sate", "cate"),
                           ci.style = c("norm", "quant", "hpd"), ci.level = 0.95,
                           pate.style = c("ppd", "var.exp"),
                           ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.bartcFit_+3A_object">object</code></td>
<td>

<p>Object of class <code>bartcFit</code>.
</p>
</td></tr>
<tr><td><code id="summary.bartcFit_+3A_target">target</code></td>
<td>

<p>Treatment effect to calculate. One of <code>"pate"</code> - population average treatment effect,
<code>"sate"</code> - sample average treatment effect, and <code>"cate"</code> - conditional average
treatment effect.
</p>
</td></tr>
<tr><td><code id="summary.bartcFit_+3A_ci.style">ci.style</code></td>
<td>

<p>Means of calculating confidence intervals (posterior credible regions). Options include
<code>"norm"</code> - use a normal approximation, <code>"quant"</code> - the empirical quantites of the
posterior samples, and <code>"hpd"</code> - region of highest posterior density.
</p>
</td></tr>
<tr><td><code id="summary.bartcFit_+3A_ci.level">ci.level</code></td>
<td>

<p>Level of confidence for intervals.
</p>
</td></tr>
<tr><td><code id="summary.bartcFit_+3A_pate.style">pate.style</code></td>
<td>

<p>For target <code>"pate"</code>, calculate uncertainty by using <code>"ppd"</code> - the posterior
predictive distribution or <code>"var.exp"</code> a variance expansion formula.
</p>
</td></tr>
<tr><td><code id="summary.bartcFit_+3A_...">...</code></td>
<td>
 
<p>Not used at moment, but present to match <code>summary</code> generic signature.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary</code> produces a numeric and qualitative summary of a <code><a href="#topic+bartc">bartc</a></code> fit.
</p>
<p><strong>Target Types</strong>
</p>
<p>The SATE and PATE involve calculating predicted response values under different treatment conditions.
When using <code><a href="#topic+bartc-generics">extract</a></code> or <code>fitted</code>, these values are simulated directly
from the posterior predictive distribution. However, since these quantities all have the same expected
value, in order to provide consistent results <code>summary</code> only uses those simulations to derive
credible intervals. Thus the estimates for CATE, SATE, and PATE all should be reported as the same
but with increasing degrees of uncertainty.
</p>
<p><strong>Grouped Data</strong>
</p>
<p>If a model is fit with a supplied grouping variable and <code>group.effects = TRUE</code>, the estimates
will also be reported within groups. When possible, the last line corresponds to the population. Within
group estimates for resposne methods such as <code>"tmle"</code> cannot easily be extrapolated to the
population at large - the means will combine based on the sample sizes but the uncertainty estimates
will lack correlations.
</p>


<h3>Value</h3>

<p>An object of class <code>bartcFit.summary</code> equivalent to a list with named items:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>how <code>bartc</code> was called</p>
</td></tr>
<tr><td><code>method.rsp</code></td>
<td>
<p>character string specifying the method used to fit the response surface</p>
</td></tr>
<tr><td><code>method.trt</code></td>
<td>
<p>character string specifying the method used to fit the treatment assignment
mechanism</p>
</td></tr>
<tr><td><code>ci.info</code></td>
<td>
<p>a named list with items <code>target</code>, <code>ci.style</code>, <code>ci.level</code>, and
<code>pate.style</code> as passed to <code>summary</code></p>
</td></tr>
<tr><td><code>n.obs</code></td>
<td>
<p>total number of observations</p>
</td></tr>
<tr><td><code>n.samples</code></td>
<td>
<p>number of samples within any one chain</p>
</td></tr>
<tr><td><code>n.chains</code></td>
<td>
<p>total number of chains</p>
</td></tr>
<tr><td><code>commonSup.rule</code></td>
<td>
<p>common support rule used when fitting object to produce estimates</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>a <code>data.frame</code> with columns <code>"estimate"</code> - the target,
<code>"sd"</code> - standard deviation of posterior of estimate,
<code>"ci.lower"</code> - lower bound of credible region,
<code>"ci.upper"</code> - upper bound of credible region,
and optionally <code>"n.cut"</code> - how many observations were dropped using 
common support rule</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vincent Dorie: <a href="mailto:vdorie@gmail.com">vdorie@gmail.com</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
