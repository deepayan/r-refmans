<!DOCTYPE html><html><head><title>Help for package lodr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lodr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.lod_lm'>
<p>Extract lod_lm Coefficients</p></a></li>
<li><a href='#fitted.lod_lm'>
<p>Extract lod_lm residuals</p></a></li>
<li><a href='#LOD_bootstrap_fit'>
<p>Rcpp Code for Computing Standard Errors When Fitting Linear Models with Covariates Subject to a Limit of Detection (LOD)</p></a></li>
<li><a href='#lod_data_ex'><p>Simulated data with covariates subject to limits of detection</p></a></li>
<li><a href='#LOD_fit'>
<p>Rcpp Code for Fitting Linear Models with Covariates Subject to a Limit of Detection (LOD)</p></a></li>
<li><a href='#lod_lm'>
<p>Fitting Linear Models with Covariates Subject to a Limit of Detection (LOD)</p></a></li>
<li><a href='#residuals.lod_lm'>
<p>Extract lod_lm residuals</p></a></li>
<li><a href='#summary.lod_lm'>
<p>Summarizing Linear Model Fits with Covariates Subject to a Limit of Detection</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Linear Model Fitting with LOD Covariates</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-04-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Kevin Donovan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kevin Donovan &lt;kmdono02@ad.unc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to fit linear regression model to data while taking into account covariates with lower limit of detection (LOD).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.2), Rdpack</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-09 20:50:14 UTC; KevinD</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-10 17:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.lod_lm'>
Extract lod_lm Coefficients
</h2><span id='topic+coef.lod_lm'></span>

<h3>Description</h3>

<p>Extracts estimates regression coefficients from object of class &quot;<code>lod_lm</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lod_lm'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.lod_lm_+3A_object">object</code></td>
<td>
<p>An object of class &quot;<code>lod_lm</code>&quot;, usually, a result of a call to <code>lod_lm</code></p>
</td></tr>
<tr><td><code id="coef.lod_lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Coefficients extracted from <code>object</code> as a named numeric vector.
</p>


<h3>Author(s)</h3>

<p>Kevin Donovan, kmdono02@ad.unc.edu.
</p>
<p>Maintainer: Kevin Donovan &lt;kmdono02@ad.unc.edu&gt;
</p>


<h3>References</h3>

<p>May RC, Ibrahim JG, Chu H (2011).
&ldquo;Maximum likelihood estimation in generalized linear models with multiple covariates subject to detection limits.&rdquo;
<em>Statistics in medicine</em>, <b>30</b>(20), 2551&ndash;2561.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitted.lod_lm">fitted.lod_lm</a></code> and <code><a href="#topic+residuals.lod_lm">residuals.lod_lm</a></code> for related methods; <code><a href="#topic+lod_lm">lod_lm</a></code> for model fitting.
</p>
<p>The generic functions <code><a href="stats.html#topic+fitted">fitted</a></code> and <code><a href="stats.html#topic+residuals">residuals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> library(lodr)
 ## Using example dataset provided in lodr package: lod_data_ex
 ## 3 covariates: x1, x2, x3 with x2 and x3 subject to a lower limit of
 ## detection of 0

 ## nSamples set to 100 for computational speed/illustration purposes only.  
 ## At least 250 is recommended.  Same for boots=0; results in NAs returned for standard errors
 fit &lt;- lod_lm(data=lod_data_ex, frmla=y~x1+x2+x3, lod=c(0,0),
                   var_LOD=c("x2", "x3"), nSamples=100, boots=0)
 coef(fit)
</code></pre>

<hr>
<h2 id='fitted.lod_lm'>
Extract lod_lm residuals
</h2><span id='topic+fitted.lod_lm'></span>

<h3>Description</h3>

<p>Extracts fitted values from object of class &quot;<code>lod_lm</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lod_lm'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.lod_lm_+3A_object">object</code></td>
<td>
<p>An object of class &quot;<code>lod_lm</code>&quot;, usually, a result of a call to <code>lod_lm</code></p>
</td></tr>
<tr><td><code id="fitted.lod_lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For subjects with covariates outside of limits of detection, when computing fitted values the values for these covariates are set according to method specified by argument <code>fill_in_method</code> in call to <code>lod_lm</code>.
</p>


<h3>Value</h3>

<p>Fitted values extracted from <code>object</code> as a named numeric vector.
</p>


<h3>Author(s)</h3>

<p>Kevin Donovan, kmdono02@ad.unc.edu.
</p>
<p>Maintainer: Kevin Donovan &lt;kmdono02@ad.unc.edu&gt;
</p>


<h3>References</h3>

<p>May RC, Ibrahim JG, Chu H (2011).
&ldquo;Maximum likelihood estimation in generalized linear models with multiple covariates subject to detection limits.&rdquo;
<em>Statistics in medicine</em>, <b>30</b>(20), 2551&ndash;2561.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coef.lod_lm">coef.lod_lm</a></code> and <code><a href="#topic+residuals.lod_lm">residuals.lod_lm</a></code> for related methods; <code><a href="#topic+lod_lm">lod_lm</a></code> for model fitting.
</p>
<p>The generic functions <code><a href="stats.html#topic+coef">coef</a></code> and <code><a href="stats.html#topic+residuals">residuals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lodr)
## Using example dataset provided in lodr package: lod_data_ex
## 3 covariates: x1, x2, x3 with x2 and x3 subject to a lower limit of
## detection of 0

## nSamples set to 100 for computational speed/illustration purposes only.  
## At least 250 is recommended.  Same for boots=0; results in NAs returned for standard errors
 
fit &lt;- lod_lm(data=lod_data_ex, frmla=y~x1+x2+x3, lod=c(0,0),
                  var_LOD=c("x2", "x3"), nSamples=100, boots=0)
 fitted(fit)
</code></pre>

<hr>
<h2 id='LOD_bootstrap_fit'>
Rcpp Code for Computing Standard Errors When Fitting Linear Models with Covariates Subject to a Limit of Detection (LOD)
</h2><span id='topic+LOD_bootstrap_fit'></span>

<h3>Description</h3>

<p><code>LOD_bootstrap_fit</code> calls Rcpp code to compute linear model regression parameter standard errors in C++, taking into account covariates with limits of detection per the method detailed in May et al. (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LOD_bootstrap_fit(num_of_boots, y_data, x_data, no_of_samples, threshold, 
max_iterations, LOD_u_l)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LOD_bootstrap_fit_+3A_num_of_boots">num_of_boots</code></td>
<td>
<p>number denoting the number of bootstrap resamples to use to compute the regression parameter standard errors.</p>
</td></tr>
<tr><td><code id="LOD_bootstrap_fit_+3A_y_data">y_data</code></td>
<td>
<p>numeric vector consisting of data of the model's outcome variable.</p>
</td></tr>
<tr><td><code id="LOD_bootstrap_fit_+3A_x_data">x_data</code></td>
<td>
<p>column-named matrix consisting of data of the model's covariates with each column representing one covariate, with values outside of the limit(s) of detection marked as <code>NA</code>.  A columns of ones must be included if the model has an intercept term.  Note that for valid inference, order of the covariates/columns in the matrix must be as follows from left to right: those with no LOD followed by those with an LOD.</p>
</td></tr>
<tr><td><code id="LOD_bootstrap_fit_+3A_no_of_samples">no_of_samples</code></td>
<td>
<p>an integer specifying the number of samples to generate for each subject with covariate values outside of their limits of detection.  For more details, see May et al. (2011).</p>
</td></tr>
<tr><td><code id="LOD_bootstrap_fit_+3A_threshold">threshold</code></td>
<td>
<p>number denoting the minimum difference in the regression parameter estimates needed for convergence of the model fitting procedure.</p>
</td></tr>
<tr><td><code id="LOD_bootstrap_fit_+3A_max_iterations">max_iterations</code></td>
<td>
<p>number denoting the maximum number of iterations allowed in the model fitting procedure.</p>
</td></tr>
<tr><td><code id="LOD_bootstrap_fit_+3A_lod_u_l">LOD_u_l</code></td>
<td>
<p>numeric matrix consisting of the lower and upper limits of detection for all covariates in the model as the columns, with each covariate containing its own row, in the same order as the covariates in <code>x_data</code>.  If no limit of detection exists, the corresponding matrix entry is marked with an <code>NA</code>.  An entry for the intercept (<code>NA</code> in each column) must be included if applicable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to complete the standard error computations done when fitting a linear model by calling <a href="#topic+lod_lm">lod_lm</a>; the standard error computations are done in C++ to minimize computation time.
</p>


<h3>Value</h3>

<p><code>LOD_bootstrap_fit</code> returns a list which each component being a numeric vector consisting of the last iteration's regression parameter estimates when fitting the model on a bootstrap resample of the input data.
</p>


<h3>Author(s)</h3>

<p>Kevin Donovan, kmdono02@ad.unc.edu.
</p>
<p>Maintainer: Kevin Donovan &lt;kmdono02@ad.unc.edu&gt;
</p>


<h3>References</h3>

<p>May RC, Ibrahim JG, Chu H (2011).
&ldquo;Maximum likelihood estimation in generalized linear models with multiple covariates subject to detection limits.&rdquo;
<em>Statistics in medicine</em>, <b>30</b>(20), 2551&ndash;2561.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lod_lm">lod_lm</a></code> is the recommended function for fitting a linear model with covariates subject to limits of detection, which uses <code>LOD_fit</code>.  <code><a href="#topic+LOD_fit">LOD_fit</a></code> is used to compute the regression parameter estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lodr)
## Using example dataset provided in lodr package: lod_data_ex
## 3 covariates: x1, x2, x3 with x2 and x3 subject to a lower limit of
## detection of 0

# Replace values marked as under limit of detection using 0 with NA,
# add column of ones for intercept
lod_data_with_int &lt;-
  as.matrix(cbind("Intercept"=rep(1, dim(lod_data_ex)[1]), lod_data_ex))

lod_data_ex_edit &lt;-
  apply(lod_data_with_int, MARGIN = 2, FUN=function(x){ifelse(x==0, NA, x)})

# Fit model with bootstrap procedure, report regression parameter estimate standard errors
LOD_matrix &lt;- cbind(c(NA, NA, -100, -100), c(NA, NA, 0, 0))

## no_of_samples set to 50 for computational speed/illustration purposes only.  
## At least 250 is recommended.  
## Same for num_of_boots=5; at least 25 is recommended
 
bootstrap_fit_object &lt;-
  LOD_bootstrap_fit(num_of_boots=5, y_data=lod_data_ex_edit[,2],
                    x_data=lod_data_ex_edit[,-2],
                    no_of_samples=50,
                    threshold=0.001, max_iterations=100, LOD_u_l=LOD_matrix)

boot_SEs &lt;- apply(do.call("rbind", bootstrap_fit_object), 2, sd)
names(boot_SEs) &lt;- names(lod_data_with_int[,-2])

boot_SEs
</code></pre>

<hr>
<h2 id='lod_data_ex'>Simulated data with covariates subject to limits of detection</h2><span id='topic+lod_data_ex'></span>

<h3>Description</h3>

<p>A simulated dataset containing a generic outcome varible and three covariates,
two of which are subject to a lower limit of detection of 0, with a sample size
of 100.  See Details for information on how these data were generated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lod_data_ex
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 rows and 4 variables:
</p>

<dl>
<dt>y</dt><dd><p>Outcome</p>
</dd>
<dt>x1</dt><dd><p>First covariate , no limits of detection</p>
</dd>
<dt>x2</dt><dd><p>Second covariate, lower limit of detection of 0</p>
</dd>
<dt>x3</dt><dd><p>Third covariate, lower limit of detection of 0</p>
</dd>
</dl>


<h3>Details</h3>

<p>Each of the covariates were generated independently from 100 independent draws from 
the standard normal distributon.  The outcome variable was generated from
a linear model with these three covariates, along with an intercept of 1, 
a residual variance of 1, and regression coefficients of 1 for each covariates.
Then for two of the covariates, to reflect a lower limit of detection of 0, values below 
this limit were set to 0.  This results in a 50 percent probability of being below the limit of detection for each of the 
two corresponding covariates.
</p>

<hr>
<h2 id='LOD_fit'>
Rcpp Code for Fitting Linear Models with Covariates Subject to a Limit of Detection (LOD)
</h2><span id='topic+LOD_fit'></span>

<h3>Description</h3>

<p><code>LOD_fit</code> calls Rcpp code to compute linear model regression parameter estimates in C++, taking into account covariates with limits of detection per the method detailed in May et al. (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LOD_fit(y_data, x_data, mean_x_preds, beta, sigma_2_y, sigma_x_preds, no_of_samples, 
threshold, max_iterations, LOD_u_l)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LOD_fit_+3A_y_data">y_data</code></td>
<td>
<p>numeric vector consisting of data of the model's outcome variable</p>
</td></tr>
<tr><td><code id="LOD_fit_+3A_x_data">x_data</code></td>
<td>
<p>column-named matrix consisting of data of the model's covariates with each column representing one covariate, with values outside of the limit(s) of detection marked as <code>NA</code>.  A columns of ones must be included if the model has an intercept term.</p>
</td></tr>
<tr><td><code id="LOD_fit_+3A_mean_x_preds">mean_x_preds</code></td>
<td>
<p>numeric vector consisting of initial estimates of the means for each covariate, in the same order as the covariates in <code>x_data</code></p>
</td></tr>
<tr><td><code id="LOD_fit_+3A_beta">beta</code></td>
<td>
<p>numeric vector consisting of initial estimates of the regression parameters for each covariate, in the same order as the covariates in <code>x_data</code></p>
</td></tr>
<tr><td><code id="LOD_fit_+3A_sigma_2_y">sigma_2_y</code></td>
<td>
<p>an initial estimate of the variance of the outcome variable</p>
</td></tr>
<tr><td><code id="LOD_fit_+3A_sigma_x_preds">sigma_x_preds</code></td>
<td>
<p>numeric matrix consisting of an initial estimate of the covariance matrix for the model's covariates, in the same order as the covariates in <code>x_data</code></p>
</td></tr>
<tr><td><code id="LOD_fit_+3A_no_of_samples">no_of_samples</code></td>
<td>
<p>an integer specifying the number of samples to generate for each subject with covariate values outside of their limits of detection.  For more details, see May et al. (2011).</p>
</td></tr>
<tr><td><code id="LOD_fit_+3A_threshold">threshold</code></td>
<td>
<p>number denoting the minimum difference in the regression parameter estimates needed for convergence of the model fitting procedure.</p>
</td></tr>
<tr><td><code id="LOD_fit_+3A_max_iterations">max_iterations</code></td>
<td>
<p>number denoting the maximum number of iterations allowed in the model fitting procedure.</p>
</td></tr>
<tr><td><code id="LOD_fit_+3A_lod_u_l">LOD_u_l</code></td>
<td>
<p>numeric matrix consisting of the lower and upper limits of detection for all covariates in the model as the columns, with each covariate containing its own row, in the same order as the covariates in <code>x_data</code>.  If no limit of detection exists, the corresponding matrix entry is marked with an <code>NA</code>.  An entry for the intercept (<code>NA</code> in each column) must be included if applicable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to complete the model fitting computations done when calling <a href="#topic+lod_lm">lod_lm</a>; the fitting computations are done in C++ to minimize computation time.
</p>


<h3>Value</h3>

<p><code>LOD_fit</code> returns a list containing the following components:
</p>
<table>
<tr><td><code>y_expand_last_int</code></td>
<td>
<p>a numeric vector consisting of the outcome data with duplicate entries for subjects with covariates outside of their limits of detection per the corresponding resampling procedure, from the last iteration of the model fitting procedure.</p>
</td></tr>
<tr><td><code>x_data_return_last_int</code></td>
<td>
<p>a numeric matrix consisting of the covariate data with sampled values for covariates of subjects with covariates outside of their limits of detection, from the last iteration of the model fitting procedure.</p>
</td></tr>
<tr><td><code>beta_estimates</code></td>
<td>
<p>a numeric matrix consisting of the regression parameter estimates from each iteration of the model fitting procedure.</p>
</td></tr>
<tr><td><code>beta_estimate_last_iteration</code></td>
<td>
<p>a numeric vector consisting of the regression parameter estimates from the last iteration of the model fitting procedure.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Donovan, kmdono02@ad.unc.edu.
</p>
<p>Maintainer: Kevin Donovan &lt;kmdono02@ad.unc.edu&gt;
</p>


<h3>References</h3>

<p>May RC, Ibrahim JG, Chu H (2011).
&ldquo;Maximum likelihood estimation in generalized linear models with multiple covariates subject to detection limits.&rdquo;
<em>Statistics in medicine</em>, <b>30</b>(20), 2551&ndash;2561.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lod_lm">lod_lm</a></code> is the recommended function for fitting a linear model with covariates subject to limits of detection, which uses <code>LOD_fit</code>.  <code><a href="#topic+LOD_bootstrap_fit">LOD_bootstrap_fit</a></code> is used to compute regression parameter estimate standard errors using bootstrap resampling.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lodr)
## Using example dataset provided in lodr package: lod_data_ex
## 3 covariates: x1, x2, x3 with x2 and x3 subject to a lower limit of
## detection of 0

# Replace values marked as under limit of detection using 0 with NA,
# add column of ones for intercept
lod_data_with_int &lt;-
  as.matrix(cbind("Intercept"=rep(1, dim(lod_data_ex)[1]), lod_data_ex))

lod_data_ex_edit &lt;-
  data.frame(apply(lod_data_with_int, MARGIN = 2, FUN=function(x){ifelse(x==0, NA, x)}))

# Fit linear model to dataset with only subjects without covariates under
# limit of detection to get initial estimate for the regression parameters.
beta_inital_est &lt;- coef(lm(y~x1+x2+x3, data=lod_data_ex_edit))

# Get initial estimates of mean vector and covariance matrix for covariates and variance of outcome,
# again using data from subjects without covariates under limit of detection

mean_x_inital &lt;- colMeans(lod_data_ex_edit[,c(-1,-2)], na.rm = TRUE)
sigma_x_inital &lt;- cov(lod_data_ex_edit[,c(-1,-2)], use="pairwise.complete.obs")
sigma_2_y_inital &lt;- sigma(lm(y~x1+x2+x3, data=lod_data_ex_edit))^2

# Fit model, report regression parameter estimates from last iteration
LOD_matrix &lt;- cbind(c(NA, NA, -100, -100), c(NA, NA, 0, 0))

## no_of_samples set to 100 for computational speed/illustration purposes only.  
## At least 250 is recommended.
 
fit_object &lt;-
LOD_fit(y_data=lod_data_ex_edit[,2],
        x_data=as.matrix(lod_data_ex_edit[,-2]),
        mean_x_preds=mean_x_inital, beta=beta_inital_est, sigma_2_y=sigma_2_y_inital,
        sigma_x_preds=sigma_x_inital, no_of_samples=100,
        threshold=0.001, max_iterations=100, LOD_u_l=LOD_matrix)

fit_object$beta_estimate_last_iteration
</code></pre>

<hr>
<h2 id='lod_lm'>
Fitting Linear Models with Covariates Subject to a Limit of Detection (LOD)
</h2><span id='topic+lod_lm'></span><span id='topic+print.lod_lm'></span>

<h3>Description</h3>

<p><code>lod_lm</code> is used to fit linear models while taking into account limits of detection for corresponding covariates.  It carries out the method detailed in May et al. (2011) with regression coefficient standard errors calculated using bootstrap resampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lod_lm(data, frmla, lod=NULL, var_LOD=NULL, nSamples = 250,
fill_in_method="mean", convergenceCriterion = 0.001, boots = 25)

## S3 method for class 'lod_lm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lod_lm_+3A_data">data</code></td>
<td>
<p>a required data frame (or object coercible by <a href="base.html#topic+as.data.frame">as.data.frame</a> to a data frame) containing the variables in the model.  If not specified, a corresponding error is returned.</p>
</td></tr>
<tr><td><code id="lod_lm_+3A_x">x</code></td>
<td>
<p>An object of class &quot;<code>lod_lm</code>&quot;, usually, a result of a call to <code>lod_lm</code></p>
</td></tr>
<tr><td><code id="lod_lm_+3A_frmla">frmla</code></td>
<td>
<p>an object of class &quot;<a href="stats.html#topic+formula">formula</a>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under 'Details'.</p>
</td></tr>
<tr><td><code id="lod_lm_+3A_lod">lod</code></td>
<td>
<p>a numeric vector (or object coercible by <a href="base.html#topic+as.numeric">as.numeric</a>) specifying the limit of detection for each covariates specified in <code>var_LOD</code> (in the same order as the covariates in <code>var_LOD</code>).  Default is <code>NULL</code>, representing no covariates having limits of detection, which calls <code>lm</code>.</p>
</td></tr>
<tr><td><code id="lod_lm_+3A_var_lod">var_LOD</code></td>
<td>
<p>a character vector specifying which covariates in the model (<code>frmla</code>) are subject to limits of detection.  Default is <code>NULL</code>, representing no covariates having limits of detection, which calls <code>lm</code>.</p>
</td></tr>
<tr><td><code id="lod_lm_+3A_nsamples">nSamples</code></td>
<td>
<p>an integer specifying the number of samples to generate for each subject with covariate values outside of their limits of detection.  For more details, see May et al. (2011).  The default is 250.</p>
</td></tr>
<tr><td><code id="lod_lm_+3A_fill_in_method">fill_in_method</code></td>
<td>
<p>a string specifying how values outside of the limits of detection should be handled when calculating residuals and fitted values.  Default is &quot;mean&quot;, which uses the mean covariate value.  Another choice is &quot;LOD&quot; which uses the lower limit of detection.</p>
</td></tr>
<tr><td><code id="lod_lm_+3A_convergencecriterion">convergenceCriterion</code></td>
<td>
<p>a number specifying the smallest difference between iterations required for the regression coefficient estimation process to complete.  The default is 0.001.</p>
</td></tr>
<tr><td><code id="lod_lm_+3A_boots">boots</code></td>
<td>
<p>a number specifying the number of bootstrap resamples used for the standard error estimation process for the regression coefficient estimates.  The default is 25.</p>
</td></tr>
<tr><td><code id="lod_lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models for <code>lod_lm</code> are specified the same as models for <code>lm</code>.  A typical model as the form <code>response ~ terms</code> where <code>response</code> is the (numeric) response vector and <code>terms</code> is a series of terms separated by <code>+</code> which specifies a linear predictor for <code>response</code>.  A formula has an implied intercept term.
</p>
<p>In the dataset used with lod_lm, values outside of the limits of detection need to be denoted by the value of the lower limit of detection.  Observations with values marked as missing by <code>NA</code> are removed by the model fit procedure as done with <code>lm</code>.
</p>


<h3>Value</h3>

<p><code>lod_lm</code> returns an object of <a href="base.html#topic+class">class</a>) &quot;<code>lod_lm</code>&quot; if arguments <code>lod</code> and <code>var_LOD</code> are not <code>NULL</code>, otherwise it returns <a href="base.html#topic+class">class</a>) &quot;<code>lm</code>&quot;.  The function <code>summary</code> prints a summary of the results in the same format as with an object of <a href="base.html#topic+class">class</a>) &quot;<code>lm</code>&quot;.  The generic accessor functions <code>coef</code>, <code>fitted</code> and <code>residuals</code> extract various useful features of the value returned by <code>lod_lm</code>.
</p>
<p>An object of <a href="base.html#topic+class">class</a>) &quot;<code>lod_lm</code>&quot; is a list containing the following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>boot_SE</code></td>
<td>
<p>a named vector of regression coefficient estimate bootstrap standard error estimates.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted mean values for subjects with covariates within their limits of detection.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals, that is response minus fitted values, for subjects with covariates within their limits of detection.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the model frame used.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the <code><a href="stats.html#topic+terms">terms</a></code> object used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Donovan, kmdono02@ad.unc.edu.
</p>
<p>Maintainer: Kevin Donovan &lt;kmdono02@ad.unc.edu&gt;
</p>


<h3>References</h3>

<p>May RC, Ibrahim JG, Chu H (2011).
&ldquo;Maximum likelihood estimation in generalized linear models with multiple covariates subject to detection limits.&rdquo;
<em>Statistics in medicine</em>, <b>30</b>(20), 2551&ndash;2561.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.lod_lm">summary.lod_lm</a></code> for summaries of the results from <code>lod_lm</code>
</p>
<p>The generic functions <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code> and <code><a href="stats.html#topic+residuals">residuals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lodr)
## Using example dataset provided in lodr package: lod_data_ex
## 3 covariates: x1, x2, x3 with x2 and x3 subject to a lower limit of
## detection of 0

## nSamples set to 100 for computational speed/illustration purposes only.  
## At least 250 is recommended.  Same for boots=0; results in NAs returned for standard errors

fit &lt;- lod_lm(data=lod_data_ex, frmla=y~x1+x2+x3, lod=c(0,0),
                  var_LOD=c("x2", "x3"), nSamples=100, boots=0)
 summary(fit)
</code></pre>

<hr>
<h2 id='residuals.lod_lm'>
Extract lod_lm residuals
</h2><span id='topic+residuals.lod_lm'></span>

<h3>Description</h3>

<p>Extracts residuals from object of class &quot;<code>lod_lm</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lod_lm'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.lod_lm_+3A_object">object</code></td>
<td>
<p>An object of class &quot;<code>lod_lm</code>&quot;, usually, a result of a call to <code>lod_lm</code></p>
</td></tr>
<tr><td><code id="residuals.lod_lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For subjects with covariates outside of limits of detection, when computing residuals the values for these covariates are set according to method specified by argument <code>fill_in_method</code> in call to <code>lod_lm</code>.
</p>


<h3>Value</h3>

<p>Residuals extracted from <code>object</code> as a named numeric vector.
</p>


<h3>Author(s)</h3>

<p>Kevin Donovan, kmdono02@ad.unc.edu.
</p>
<p>Maintainer: Kevin Donovan &lt;kmdono02@ad.unc.edu&gt;
</p>


<h3>References</h3>

<p>May RC, Ibrahim JG, Chu H (2011).
&ldquo;Maximum likelihood estimation in generalized linear models with multiple covariates subject to detection limits.&rdquo;
<em>Statistics in medicine</em>, <b>30</b>(20), 2551&ndash;2561.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitted.lod_lm">fitted.lod_lm</a></code> and <code><a href="#topic+coef.lod_lm">coef.lod_lm</a></code> for related methods; <code><a href="#topic+lod_lm">lod_lm</a></code> for model fitting.
</p>
<p>The generic functions <code><a href="stats.html#topic+coef">coef</a></code> and <code><a href="stats.html#topic+fitted">fitted</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lodr)
## Using example dataset provided in lodr package: lod_data_ex
## 3 covariates: x1, x2, x3 with x2 and x3 subject to a lower limit of
## detection of 0

## nSamples set to 100 for computational speed/illustration purposes only.  
## At least 250 is recommended.  Same for boots=0; results in NAs returned for standard errors

fit &lt;- lod_lm(data=lod_data_ex, frmla=y~x1+x2+x3, lod=c(0,0),
                  var_LOD=c("x2", "x3"), nSamples=100, boots=0)
 residuals(fit)
</code></pre>

<hr>
<h2 id='summary.lod_lm'>
Summarizing Linear Model Fits with Covariates Subject to a Limit of Detection
</h2><span id='topic+summary.lod_lm'></span><span id='topic+print.summary.lod_lm'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;<code>lod_lm</code>&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lod_lm'
summary(object, ...)

## S3 method for class 'summary.lod_lm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.lod_lm_+3A_object">object</code></td>
<td>
<p>An object of class &quot;<code>lod_lm</code>&quot;, usually, a result of a call to <a href="#topic+lod_lm">lod_lm</a></p>
</td></tr>
<tr><td><code id="summary.lod_lm_+3A_x">x</code></td>
<td>
<p>An object of class &quot;<code>summary.lod_lm</code>&quot;, usually, a result of a call to <a href="#topic+summary.lod_lm">summary.lod_lm</a></p>
</td></tr>
<tr><td><code id="summary.lod_lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.summary.lod_lm</code> prints a table containing the coefficient estimates, standard errors, etc. from the <code>lod_lm</code> fit.
</p>


<h3>Value</h3>

<p>The function <code>summary.lod_lm</code> returns a list of summary statistics of the fitted linear model given in <code>object</code>, using the components (list elements) &quot;<code>call</code>&quot; and &quot;<code>terms</code>&quot; from its argument, plus
</p>
<table>
<tr><td><code>residuals</code></td>
<td>
<p>residuals computed by <code>lod_lm</code></p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>a <code>p x 4</code> matrix  for the estimated coefficient, its standard error, t-statistic and corresponding (two-sided) p-value.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the square root of the estimated variance of the random error.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom, a vector <code>(p, n-p)</code>, where <code>p</code> is the number of regression coefficients and n is the sample size of the data used in the model fitting</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Donovan, kmdono02@ad.unc.edu.
</p>
<p>Maintainer: Kevin Donovan &lt;kmdono02@ad.unc.edu&gt;
</p>


<h3>References</h3>

<p>May RC, Ibrahim JG, Chu H (2011).
&ldquo;Maximum likelihood estimation in generalized linear models with multiple covariates subject to detection limits.&rdquo;
<em>Statistics in medicine</em>, <b>30</b>(20), 2551&ndash;2561.
</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+lod_lm">lod_lm</a></code>, <code><a href="base.html#topic+summary">summary</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lodr)
## Using example dataset provided in lodr package: lod_data_ex
## 3 covariates: x1, x2, x3 with x2 and x3 subject to a lower limit of
## detection of 0

## nSamples set to 100 for computational speed/illustration purposes only.  
## At least 250 is recommended.  Same for boots=0; results in NAs returned for standard errors

fit &lt;- lod_lm(data=lod_data_ex, frmla=y~x1+x2+x3, lod=c(0,0),
                  var_LOD=c("x2", "x3"), nSamples=100, boots=0)
 summary(fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
