<!DOCTYPE html><html><head><title>Help for package MultiCOAP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultiCOAP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gendata_simu_multi2'><p>Generate simulated data</p></a></li>
<li><a href='#MSFRVI'><p>Fit the multi-study covariate-augmented linear factor model via variational inference</p></a></li>
<li><a href='#MultiCOAP'><p>Fit the multi-study covariate-augmented overdispersed Poisson factor model via variational inference</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>High-Dimensional Covariate-Augmented Overdispersed Multi-Study
Poisson Factor Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Wei Liu [aut, cre],
  Qingzhi Zhong [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wei Liu &lt;liuweideng@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We introduce factor models designed to jointly analyze high-dimensional count data from multiple studies by extracting study-shared and specified factors. Our factor models account for heterogeneous noises and overdispersion among counts with augmented covariates. We propose an efficient and speedy variational estimation procedure for estimating model parameters, along with a novel criterion for selecting the optimal number of factors and the rank of regression coefficient matrix. More details can be referred to Liu et al. (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2402.15071">doi:10.48550/arXiv.2402.15071</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>irlba, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, Rcpp (&ge; 1.0.10)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/feiyoung/MultiCOAP">https://github.com/feiyoung/MultiCOAP</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/feiyoung/MultiCOAP/issues">https://github.com/feiyoung/MultiCOAP/issues</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-06 10:36:51 UTC; Liuxianju</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-07 10:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='gendata_simu_multi2'>Generate simulated data</h2><span id='topic+gendata_simu_multi2'></span>

<h3>Description</h3>

<p>Generate simulated data from covariate-augmented Poisson factor models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gendata_simu_multi2(
  seed = 1,
  nvec = c(100, 300),
  a_interval = c(0, 1),
  p = 50,
  d = 3,
  q = 3,
  qs = rep(2, length(nvec)),
  rank0 = 3,
  rho = c(rhoA = 1, rhoB = 1, rhoZ = 1),
  sigma2_eps = 1,
  seed.beta = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gendata_simu_multi2_+3A_seed">seed</code></td>
<td>
<p>a postive integer, the random seed for reproducibility of data generation process.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_nvec">nvec</code></td>
<td>
<p>a  vector with postive integers, specify the sample size in each study/source.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_a_interval">a_interval</code></td>
<td>
<p>a numeric vector with two elements, specify the range of offset term values in each study.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_p">p</code></td>
<td>
<p>a postive integer, specify the dimension of count variables.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_d">d</code></td>
<td>
<p>a postive integer,  specify the dimension of covariate matrix.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_q">q</code></td>
<td>
<p>a postive integer,  specify the number of study-shared factors.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_qs">qs</code></td>
<td>
<p>a  vector with postive integers, specify the number of study-specified factors.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_rank0">rank0</code></td>
<td>
<p>a postive integer, specify the rank of the coefficient matrix.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_rho">rho</code></td>
<td>
<p>a numeric vector with length 3 and positive elements, specify the signal strength of regression coefficient and loading matrices, respectively.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_sigma2_eps">sigma2_eps</code></td>
<td>
<p>a positive real, the variance of overdispersion error.</p>
</td></tr>
<tr><td><code id="gendata_simu_multi2_+3A_seed.beta">seed.beta</code></td>
<td>
<p>a postive integer, the random seed for fixing the regression coefficient matrix and loading matrix generation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return a list including the following components: 
(1) Xlist, the list consisting of high-dimensional count matrices from multiple studies; (2) aList: the known normalization term (offset) for each study; (3) Zlist, the list consisting of covariate matrix;
(4) bbeta0, the true regression coefficient matrix; (5) A0, the loading matrix of study-shared factors;  (6) Blist, the list consisting of loading matrices of study-specified factors;
(7)lambdavec, the variance vector of the random error vector; (8)Flist, the list composed by study-shared factor matrices; (9) Hlist, the list composed by study-specified factor matrices; 
(10) rank0, the rank of underlying regression coefficient matrix;  (11) q, the number of study-shared factors; (12)qs, the numbers of study-specified factors.
</p>


<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seed &lt;- 1; nvec &lt;- c(100,300); p&lt;- 300;
d &lt;- 3; q&lt;- 3; qs &lt;- rep(2,2)
datlist &lt;- gendata_simu_multi2(seed=seed, nvec=nvec, p=p, d=d, q=3, qs=qs)
str(datlist)
</code></pre>

<hr>
<h2 id='MSFRVI'>Fit the multi-study covariate-augmented linear factor model via variational inference</h2><span id='topic+MSFRVI'></span>

<h3>Description</h3>

<p>Fit the multi-study covariate-augmented linear factor model via variational inference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MSFRVI(
  XList,
  ZList,
  q = 15,
  qs = rep(2, length(XList)),
  rank_use = NULL,
  aList = NULL,
  epsELBO = 1e-05,
  maxIter = 30,
  verbose = TRUE,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MSFRVI_+3A_xlist">XList</code></td>
<td>
<p>A length-M list, where each component represents a matrix and is the observed response matrix from each source/study. Ideally, each matrix should be continuous.</p>
</td></tr>
<tr><td><code id="MSFRVI_+3A_zlist">ZList</code></td>
<td>
<p>a length-M list with each component a matrix that is the covariate matrix from each study.</p>
</td></tr>
<tr><td><code id="MSFRVI_+3A_q">q</code></td>
<td>
<p>an optional integer, specify the number of study-shared factors; default as 15.</p>
</td></tr>
<tr><td><code id="MSFRVI_+3A_qs">qs</code></td>
<td>
<p>a integer vector with length M, specify the number of study-specifed factors; default as 2.</p>
</td></tr>
<tr><td><code id="MSFRVI_+3A_rank_use">rank_use</code></td>
<td>
<p>an optional integer, specify the rank of the regression coefficient matrix; default as NULL, which means that rank is the dimension of covariates in Z.</p>
</td></tr>
<tr><td><code id="MSFRVI_+3A_alist">aList</code></td>
<td>
<p>an optional length-M list with each component a vector, the normalization factors of each study; default as full-one vector.</p>
</td></tr>
<tr><td><code id="MSFRVI_+3A_epselbo">epsELBO</code></td>
<td>
<p>an optional positive vlaue, tolerance of relative variation rate of the envidence lower bound value, defualt as '1e-5'.</p>
</td></tr>
<tr><td><code id="MSFRVI_+3A_maxiter">maxIter</code></td>
<td>
<p>the maximum iteration of the VEM algorithm. The default is 30.</p>
</td></tr>
<tr><td><code id="MSFRVI_+3A_verbose">verbose</code></td>
<td>
<p>a logical value, whether output the information in iteration.</p>
</td></tr>
<tr><td><code id="MSFRVI_+3A_seed">seed</code></td>
<td>
<p>an optional integer, specify the random seed for reproducibility in initialization.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return a list including the following components: (1) F, a list composed by the posterior estimation of study-shared factor matrix for each study; (2) H,  a list composed by the posterior estimation of study-specified factor matrix for each study; 
(3) Sf, a list consisting of the posterior estimation of covariance matrix of study-shared factors for each study; (4) Sh, a list consisting of the posterior estimation of covariance matrix of study-specified factors for each study;
(5) A, the loading matrix corresponding to study-shared factors; (6) B, a list composed by the loading matrices corresponding to the study-specified factors;
(7) bbeta, the estimated regression  coefficient matrix; (8) invLambda, the inverse of the estimated variances of error;  (9) ELBO: the ELBO value when algorithm stops; (7) ELBO_seq: the sequence of ELBO values.
(11) qrlist, the number of factors and rank of regression coefficient matrix used in fitting;  (12) time.use, the elapsed time for model fitting.
</p>


<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MultiCOAP">MultiCOAP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seed &lt;- 1; nvec &lt;- c(100,300); p&lt;- 300;
d &lt;- 3; q&lt;- 3; qs &lt;- rep(2,2)
datlist &lt;- gendata_simu_multi2(seed=seed, nvec=nvec, p=p, d=d, q=3, qs=qs)
XList &lt;- lapply(datlist$Xlist,  function(x) log(1+x))
fit_msfavi &lt;- MSFRVI(XList, ZList = datlist$Zlist, q=3, qs=qs, rank_use = d)
str(fit_msfavi)
</code></pre>

<hr>
<h2 id='MultiCOAP'>Fit the multi-study covariate-augmented overdispersed Poisson factor model via variational inference</h2><span id='topic+MultiCOAP'></span>

<h3>Description</h3>

<p>Fit the high-dimensional multi-study covariate-augmented overdispersed Poisson factor model via variational inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MultiCOAP(
  XcList,
  ZList,
  q = 15,
  qs = rep(2, length(XcList)),
  rank_use = NULL,
  aList = NULL,
  init = c("MSFRVI", "LFM"),
  epsELBO = 1e-05,
  maxIter = 30,
  verbose = TRUE,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MultiCOAP_+3A_xclist">XcList</code></td>
<td>
<p>a length-M list with each component a count matrix, which is the observed count matrix from each source/study.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_zlist">ZList</code></td>
<td>
<p>a length-M list with each component a matrix that is the covariate matrix from each study.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_q">q</code></td>
<td>
<p>an optional integer, specify the number of study-shared factors; default as 15.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_qs">qs</code></td>
<td>
<p>a integer vector with length M, specify the number of study-specifed factors; default as 2.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_rank_use">rank_use</code></td>
<td>
<p>an optional integer, specify the rank of the regression coefficient matrix; default as NULL, which means that rank is the dimension of covariates in Z.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_alist">aList</code></td>
<td>
<p>an optional length-M list with each component a vector, the normalization factors of each study; default as full-one vector.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_init">init</code></td>
<td>
<p>an optional string, specify the initialization method, default as &quot;MSFRVI&quot;.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_epselbo">epsELBO</code></td>
<td>
<p>an optional positive vlaue, tolerance of relative variation rate of the envidence lower bound value, defualt as '1e-5'.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_maxiter">maxIter</code></td>
<td>
<p>the maximum iteration of the VEM algorithm. The default is 30.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_verbose">verbose</code></td>
<td>
<p>a logical value, whether output the information in iteration.</p>
</td></tr>
<tr><td><code id="MultiCOAP_+3A_seed">seed</code></td>
<td>
<p>an optional integer, specify the random seed for reproducibility in initialization.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>init="MSFRVI"</code>, it will use the results from multi-study linear factor model as initial values; If <code>init="LFM"</code>, it will use the results from linear factor model by combing data from all studies as initials.
</p>


<h3>Value</h3>

<p>return a list including the following components: (1) F, a list composed by the posterior estimation of study-shared factor matrix for each study; (2) H,  a list composed by the posterior estimation of study-specified factor matrix for each study; 
(3) Sf, a list consisting of the posterior estimation of covariance matrix of study-shared factors for each study; (4) Sh, a list consisting of the posterior estimation of covariance matrix of study-specified factors for each study;
(5) A, the loading matrix corresponding to study-shared factors; (6) B, a list composed by the loading matrices corresponding to the study-specified factors;
(7) bbeta, the estimated regression  coefficient matrix; (8) invLambda, the inverse of the estimated variances of error;  (9) ELBO: the ELBO value when algorithm stops; (7) ELBO_seq: the sequence of ELBO values.
(11) qrlist, the number of factors and rank of regression coefficient matrix used in fitting;  (12) time.use, the elapsed time for model fitting.
</p>


<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MSFRVI">MSFRVI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seed &lt;- 1; nvec &lt;- c(100,300); p&lt;- 300;
d &lt;- 3; q&lt;- 3; qs &lt;- rep(2,2)
datlist &lt;- gendata_simu_multi2(seed=seed, nvec=nvec, p=p, d=d, q=3, qs=qs)
fit_mcoap &lt;- MultiCOAP(datlist$Xlist, ZList = datlist$Zlist, q=3, qs=qs, rank_use = d)
str(fit_mcoap)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
