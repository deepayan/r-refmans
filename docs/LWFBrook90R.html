<!DOCTYPE html><html lang="en"><head><title>Help for package LWFBrook90R</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LWFBrook90R}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#LWFBrook90R-package'><p>LWFBrook90R: A package for simulating water fluxes, soil moisture and drought</p>
stress using the SVAT Model LWF-Brook90.</a></li>
<li><a href='#approx_standprop'><p>Create a daily sequence of stand properties from parameters using</p>
interpolation</a></li>
<li><a href='#calc_globrad'><p>Calculate global solar radiation from sunshine duration hours</p></a></li>
<li><a href='#calc_vegperiod'><p>Calculate the dates of budburst and beginning of leaf fall</p></a></li>
<li><a href='#correct_prec'><p>Correct rain gauge precipitation data for wind and evaporation errors after</p>
Richter (1995)</a></li>
<li><a href='#extract_layer_output'><p>Extracts values from layer data and organizes layer-wise variables in columns</p></a></li>
<li><a href='#make_rootden'><p>Generates a root density depth function for soil layers</p></a></li>
<li><a href='#make_seasLAI'><p>Construct the seasonal course of leaf area index from parameters</p></a></li>
<li><a href='#make_standprop'><p>Create daily plant characteristics from parameters and options</p></a></li>
<li><a href='#param_to_rlwfbrook90'><p>Create a parameter vector for the r_lwfbrook90-function</p></a></li>
<li><a href='#plant_b90'><p>Interpolate plant properties using the 'b90' method.</p></a></li>
<li><a href='#plant_coupmodel'><p>Interpolate plant properties using the 'Coupmodel' method.</p></a></li>
<li><a href='#plant_linear'><p>Interpolate plant properties using the 'linear' method.</p></a></li>
<li><a href='#process_outputs_LWFB90'><p>Aggregate and group model outputs similar to ancient LWFB90 textfile outputs (.ASC-files)</p></a></li>
<li><a href='#ptfs'><p>Functions to derive soil hydraulic properties from soil properties</p></a></li>
<li><a href='#r_lwfbrook90'><p>Interface function to the LWF-Brook90 model</p></a></li>
<li><a href='#replace_vecelements'><p>Replace elements in a data.frame or vector of length &gt; 1 by name</p></a></li>
<li><a href='#run_LWFB90'><p>Run the LWF-Brook90 hydrologic model</p></a></li>
<li><a href='#run_multi_LWFB90'><p>Make a multirun simulation using a set of variable input parameters.</p></a></li>
<li><a href='#run_multisite_LWFB90'><p>Make a multi-site simulation using lists of climate, soil, and</p>
parameter input objects.</a></li>
<li><a href='#set_optionsLWFB90'><p>Create a list of model control options</p></a></li>
<li><a href='#set_outputLWFB90'><p>Select output for LWF-Brook90</p></a></li>
<li><a href='#set_paramLWFB90'><p>Create the list of model parameters</p></a></li>
<li><a href='#slb1_meteo'><p>Meteorological Data from the Solling Beech and Spruce experimental site</p></a></li>
<li><a href='#slb1_prec2013_hh'><p>Hourly precipitation data from Solling Beech experimental site 'SLB1' for year 2013</p></a></li>
<li><a href='#slb1_soil'><p>Soil profile data from the Solling Beech experimental site 'SLB1'</p></a></li>
<li><a href='#slb1_standprop'><p>Annual stand properties of the Solling Beech experimental site 'SLB1'</p></a></li>
<li><a href='#soil_to_param'><p>Split up soil into materials and soil nodes.</p></a></li>
<li><a href='#standprop_yearly_to_param'><p>Transfer standproperties height, maxlai, sai, densef, age to parameter list obeject</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Simulate Evapotranspiration and Soil Moisture with the SVAT
Model LWF-Brook90</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a flexible and easy-to use interface for the soil vegetation 
    atmosphere transport (SVAT) model LWF-BROOK90, written in Fortran.
    The model simulates daily transpiration, interception, soil and snow evaporation, 
    streamflow and soil water fluxes through a soil profile covered with vegetation, 
    as described in Hammel &amp; Kennel (2001, ISBN:978-3-933506-16-0) and Federer et al. (2003) 
    &lt;<a href="https://doi.org/10.1175/1525-7541(2003)004%3C1276:SOAETS%3E2.0.CO;2">doi:10.1175/1525-7541(2003)004%3C1276:SOAETS%3E2.0.CO;2</a>&gt;. A set of high-level functions
    for model set up, execution and parallelization provides easy access to plot-level SVAT 
    simulations, as well as multi-run and large-scale applications. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://pschmidtwalter.github.io/LWFBrook90R/">https://pschmidtwalter.github.io/LWFBrook90R/</a>,
<a href="https://github.com/pschmidtwalter/LWFBrook90R">https://github.com/pschmidtwalter/LWFBrook90R</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pschmidtwalter/LWFBrook90R/issues">https://github.com/pschmidtwalter/LWFBrook90R/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, data.table (&ge; 1.10.4), vegperiod (&ge; 0.3.0), foreach
(&ge; 1.5.0), iterators (&ge; 1.0.12), doFuture (&ge; 0.10.0), future
(&ge; 1.19.0), parallelly (&ge; 1.30.0), progressr (&ge; 0.6.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, roxygen2, testthat</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-16 09:58:10 UTC; pschmidt</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Schmidt-Walter
    <a href="https://orcid.org/0000-0003-2699-0893"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Volodymyr Trotsiuk
    <a href="https://orcid.org/0000-0002-8363-656X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Klaus Hammel [aut],
  Martin Kennel [aut],
  Anthony Federer [aut],
  Tobias Hohenbrink <a href="https://orcid.org/0000-0002-5227-0171"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Gisbert Hetkamp [aut],
  Robert Nuske <a href="https://orcid.org/0000-0001-9773-2061"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Bavarian State Institute of Forestry (LWF) [cph, fnd],
  Northwest German Forest Research Institute (NW-FVA) [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Schmidt-Walter &lt;paulsw@posteo.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-16 10:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='LWFBrook90R-package'>LWFBrook90R: A package for simulating water fluxes, soil moisture and drought
stress using the SVAT Model LWF-Brook90.</h2><span id='topic+LWFBrook90R'></span><span id='topic+LWFBrook90R-package'></span>

<h3>Description</h3>

<p>The central function <code>run_LWFB90()</code> creates model input from model
control options, parameters, climate and soil data, executes the model code
and returns the model results. The model control options thereby let the user
select different methods for defining phenology and leaf area index
seasonality, root density depth distributions, and inter-annual variation of
stand properties. Additionally, a set of pedotransfer functions is provided
to derive hydraulic parameters from soil physical properties. For an
introduction to the basic usage see <code>vignette('intro_LWFB90')</code>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Paul Schmidt-Walter <a href="mailto:paulsw@posteo.de">paulsw@posteo.de</a> (<a href="https://orcid.org/0000-0003-2699-0893">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Volodymyr Trotsiuk (<a href="https://orcid.org/0000-0002-8363-656X">ORCID</a>)
</p>
</li>
<li><p> Klaus Hammel
</p>
</li>
<li><p> Martin Kennel
</p>
</li>
<li><p> Anthony Federer
</p>
</li>
<li><p> Tobias Hohenbrink (<a href="https://orcid.org/0000-0002-5227-0171">ORCID</a>)
</p>
</li>
<li><p> Gisbert Hetkamp
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Robert Nuske (<a href="https://orcid.org/0000-0001-9773-2061">ORCID</a>) [contributor]
</p>
</li>
<li><p> Bavarian State Institute of Forestry (LWF) [copyright holder, funder]
</p>
</li>
<li><p> Northwest German Forest Research Institute (NW-FVA) [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://pschmidtwalter.github.io/LWFBrook90R/">https://pschmidtwalter.github.io/LWFBrook90R/</a>
</p>
</li>
<li> <p><a href="https://github.com/pschmidtwalter/LWFBrook90R">https://github.com/pschmidtwalter/LWFBrook90R</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/pschmidtwalter/LWFBrook90R/issues">https://github.com/pschmidtwalter/LWFBrook90R/issues</a>
</p>
</li></ul>


<hr>
<h2 id='approx_standprop'>Create a daily sequence of stand properties from parameters using
interpolation</h2><span id='topic+approx_standprop'></span>

<h3>Description</h3>

<p>Uses yearly values of inter-annual vegetation development values (e.g. sai,
height, densef, age) and interpolates them to a daily sequence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approx_standprop(
  x_yrs,
  y,
  y_ini = NULL,
  xout_yrs = x_yrs,
  use_growthperiod = FALSE,
  startdoy = 121,
  enddoy = 279,
  approx.method = "constant",
  return_xout = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="approx_standprop_+3A_x_yrs">x_yrs</code></td>
<td>
<p>A sequence of years or a single year.</p>
</td></tr>
<tr><td><code id="approx_standprop_+3A_y">y</code></td>
<td>
<p>Vector of the same length as <code>x_yrs</code>. If <code>approx.method = 'linear'</code>,
the values are interpreted to be valid at the end of the respective year in
<code>x_yrs</code></p>
</td></tr>
<tr><td><code id="approx_standprop_+3A_y_ini">y_ini</code></td>
<td>
<p>Initial value used as a starting point for linear interpolation.
Interpreted to be valid at the 1st of January of the first year in <code>x_yrs</code>.
Ignored if <code>approx.method = 'constant'</code>.</p>
</td></tr>
<tr><td><code id="approx_standprop_+3A_xout_yrs">xout_yrs</code></td>
<td>
<p>Vector of years for which output is generated. May be
longer or shorter than <code>x_yrs</code>. For years outside <code>x_yrs</code>, the value of the
closest data extrem is returned.</p>
</td></tr>
<tr><td><code id="approx_standprop_+3A_use_growthperiod">use_growthperiod</code></td>
<td>
<p>Logical: Use startdoy and enddoy for linear
interpolation? If TRUE, yearly changes take place between startdoy and
enddoy, othe wise from end of year to end of the year after.</p>
</td></tr>
<tr><td><code id="approx_standprop_+3A_startdoy">startdoy</code></td>
<td>
<p>A single value or vector of the same length as <code>x_yrs</code>, with
the day of year when growth begins.</p>
</td></tr>
<tr><td><code id="approx_standprop_+3A_enddoy">enddoy</code></td>
<td>
<p>A single value or vector of the same length as <code>x_yrs</code>, with
the day of year when growth cessates.</p>
</td></tr>
<tr><td><code id="approx_standprop_+3A_approx.method">approx.method</code></td>
<td>
<p>Name of interpolation method ('constant' or 'linear').</p>
</td></tr>
<tr><td><code id="approx_standprop_+3A_return_xout">return_xout</code></td>
<td>
<p>Logical: If true, daily values of <code>y</code> and a date vector are
returned in a data.frame.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>approx.method = 'constant'</code>, the value of <code>y</code> is
returned for the whole respective year in <code>x_yrs</code>, which results in
a yearly changing step function. If <code>approx.method = 'linear'</code>, the
values of <code>y</code> are interpolated between the years in <code>x_yrs</code>,
and interpreted to be reached at the 31st of December of the respective
<code>x_yrs.</code> In this case, <code>y_ini</code> is required as an initial value,
from which the sequence is interpolated to the first value of <code>y.</code> The
linear changes are either accomplished between 31st to 31st of December of
the years in <code>x_yrs</code>, or during the growing season only
(<code>use_growingperiod = TRUE</code>).
</p>


<h3>Value</h3>

<p>A vector of interpolated daily values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>years &lt;- 2002:2004
height_yearly &lt;- c(20.2,20.8,21.3)

# constant 'interpolation'
height_c &lt;- approx_standprop(x_yrs = years,
                             y = height_yearly)

# linear interpolation
height_ini &lt;- 19.1
height_l &lt;- approx_standprop(x_yrs=years,
                             y = height_yearly,
                             y_ini = height_ini,
                             approx.method = 'linear')

# use growthperiod
height_l_gp &lt;- approx_standprop(x_yrs = years,
                                y = height_yearly,
                                y_ini = height_ini,
                                use_growthperiod = TRUE,
                                startdoy = 121,
                                enddoy = 279,
                                approx.method = 'linear')

dates &lt;- seq.Date(from = as.Date(paste0(min(years),"-01-01")),
                  to = as.Date(paste0(max(years),"-12-31")),
                  by = "day")
plot(dates, height_c,
     type = "l", lwd = 2, col = "black",
     ylim = c(19,22), ylab = "height [m]", xlab = "", xpd = TRUE)
lines(dates, height_l,
      col = "blue", lwd = 2)
lines(dates, height_l_gp,
      col = "green", lwd = 2)
legend("topleft", legend = c("'constant'", "'linear'",
                             "'linear', 'use_growthperiod'"),
       col  = c("black", "blue", "green"),  lwd = 2, pch = NULL,
       bty = "n")
</code></pre>

<hr>
<h2 id='calc_globrad'>Calculate global solar radiation from sunshine duration hours</h2><span id='topic+calc_globrad'></span>

<h3>Description</h3>

<p>Uses functions taken from the 'sirad' package to determine astronomical
daylength and extraterrestrial radiation, from which global radiation is
calculated using the Angström-formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_globrad(dates, sunhours, lat, a0 = 0.25, b0 = 0.5, full_output = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_globrad_+3A_dates">dates</code></td>
<td>
<p>Date vector</p>
</td></tr>
<tr><td><code id="calc_globrad_+3A_sunhours">sunhours</code></td>
<td>
<p>Vector of sunshine duration hours, same length as dates.</p>
</td></tr>
<tr><td><code id="calc_globrad_+3A_lat">lat</code></td>
<td>
<p>Latitude in decimal degrees.</p>
</td></tr>
<tr><td><code id="calc_globrad_+3A_a0">a0</code></td>
<td>
<p>Angström parameter a, defaults to 0.25.</p>
</td></tr>
<tr><td><code id="calc_globrad_+3A_b0">b0</code></td>
<td>
<p>Angström parameter b, defaults to 0.5.</p>
</td></tr>
<tr><td><code id="calc_globrad_+3A_full_output">full_output</code></td>
<td>
<p>Return extraterrestrial radiation and daylength along with
global radiation?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A sequence of global radiation in MJ/(m² d) with the length of dates,
or (if <code>full_output = TRUE</code>) a <code>data.frame</code> holding day of year,
dates, sunhours, daylength, and extraterrestrial and calculated global
solar radiation. A warning is generated if some sunshine duration hours are
higher than the expected daylength at the specified latitude.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dates &lt;- seq.Date(as.Date("2002-01-01"), as.Date("2003-12-31"), by = 'day')
calc_globrad(dates, sunhours = runif(365, 0, 7),lat = 52.8)
calc_globrad(dates, sunhours = runif(365, 0, 7),lat = 52.8, full_output = TRUE)
</code></pre>

<hr>
<h2 id='calc_vegperiod'>Calculate the dates of budburst and beginning of leaf fall</h2><span id='topic+calc_vegperiod'></span>

<h3>Description</h3>

<p>Wrapper for <code><a href="vegperiod.html#topic+vegperiod">vegperiod</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_vegperiod(
  budburst_method,
  leaffall_method,
  dates = NULL,
  tavg = NULL,
  out_yrs = NULL,
  budburstdoy.fixed = 121,
  leaffalldoy.fixed = 279,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_vegperiod_+3A_budburst_method">budburst_method</code></td>
<td>
<p>name of model for estimating budburst day of year.
Either 'fixed' or one of the values accepted by the 'start.method'-argument
of the function <code><a href="vegperiod.html#topic+vegperiod">vegperiod</a></code>.</p>
</td></tr>
<tr><td><code id="calc_vegperiod_+3A_leaffall_method">leaffall_method</code></td>
<td>
<p>name of model for estimating day of year when leaffall
begin. Either 'fixed' or one of the values accepted by the
'end.method'-argument of the function <code><a href="vegperiod.html#topic+vegperiod">vegperiod</a></code>.</p>
</td></tr>
<tr><td><code id="calc_vegperiod_+3A_dates">dates</code></td>
<td>
<p>date vector passed to <code><a href="vegperiod.html#topic+vegperiod">vegperiod</a></code>,
ignored if both leaffall_method and budburst_method = 'fixed'</p>
</td></tr>
<tr><td><code id="calc_vegperiod_+3A_tavg">tavg</code></td>
<td>
<p>vector of daily mean air temperature (deg C) passed to
<code><a href="vegperiod.html#topic+vegperiod">vegperiod</a></code>, ignored if <code>leaffall_method =
'fixed'</code> and <code>budburst_method = 'fixed'</code>.</p>
</td></tr>
<tr><td><code id="calc_vegperiod_+3A_out_yrs">out_yrs</code></td>
<td>
<p>integer vector of the years to be returned. If not
specified, values for the years in <code>dates</code> will be returned.</p>
</td></tr>
<tr><td><code id="calc_vegperiod_+3A_budburstdoy.fixed">budburstdoy.fixed</code></td>
<td>
<p>vector of values to be returned if
<code>budburst_method = 'fixed'</code>.</p>
</td></tr>
<tr><td><code id="calc_vegperiod_+3A_leaffalldoy.fixed">leaffalldoy.fixed</code></td>
<td>
<p>vector of values to be returned if
<code>leaffall_method = 'fixed'</code>.</p>
</td></tr>
<tr><td><code id="calc_vegperiod_+3A_...">...</code></td>
<td>
<p>additional argument passed to <code><a href="vegperiod.html#topic+vegperiod">vegperiod</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with columns <code>year</code>, <code>start</code>, <code>end</code>. If
<code>budburst_method = 'fixed'</code> or <code>leaffall_method = 'fixed'</code>,
<code>start</code> and <code>end</code> contain the values specified in
<code>budburstdoy.fixed</code> and <code>leaffalldoy.fixed</code> respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fixed budburst and leaffall doy
calc_vegperiod(out_yrs = 2001:2010,
               budburst_method = "fixed",
               leaffall_method = "fixed",
               budburstdoy.fixed = floor(runif(10, 120,130)),
               leaffalldoy.fixed = floor(runif(2, 260,280)))

# dynamic budburst and leaffall using air temperature
data(slb1_meteo)

calc_vegperiod(budburst_method = "Menzel",
               leaffall_method = "fixed",
               leaffalldoy.fixed = 280,
               dates = slb1_meteo$dates,
               tavg = slb1_meteo$tmean,
               species = "Fagus sylvatica",
               est.prev = 3)

calc_vegperiod(budburst_method = "Menzel",
               leaffall_method = "ETCCDI",
               dates = slb1_meteo$dates,
               tavg = slb1_meteo$tmean,
               species = "Quercus robur",
               est.prev = 3)
</code></pre>

<hr>
<h2 id='correct_prec'>Correct rain gauge precipitation data for wind and evaporation errors after
Richter (1995)</h2><span id='topic+correct_prec'></span>

<h3>Description</h3>

<p>Correct rain gauge precipitation data for wind and evaporation errors after
Richter (1995)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct_prec(month, tavg, prec, station.exposure = "mg", full_output = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="correct_prec_+3A_month">month</code></td>
<td>
<p>Vector of months.</p>
</td></tr>
<tr><td><code id="correct_prec_+3A_tavg">tavg</code></td>
<td>
<p>Vector of air temperature values (deg C). Same length as
<code>month</code>.</p>
</td></tr>
<tr><td><code id="correct_prec_+3A_prec">prec</code></td>
<td>
<p>Vector of measured rainfall vales (mm). Same length as
<code>month</code>.</p>
</td></tr>
<tr><td><code id="correct_prec_+3A_station.exposure">station.exposure</code></td>
<td>
<p>Situation of the weather station where prec was
measured: one of 'frei', 'lg', 'mg', 'sg' (corresponding to full exposure,
low protected, moderate protected, strong protected situation).</p>
</td></tr>
<tr><td><code id="correct_prec_+3A_full_output">full_output</code></td>
<td>
<p>Logical wether to return the full data set additionally
including input data, correction coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of corrected rainfall data, or (if <code>full_output ==
  TRUE</code>) a data.table containing the input objects, the month, the
precipitation type ('N4So': liquid rain, summer; 'N4Wi' liquid rain,
winter; 'N8' = sleet, 'N7' = snow), correction coefficients epsilon and b,
and the corrected rainfall.
</p>


<h3>References</h3>

<p>Richter, D. (1995)
Ergebnisse methodischer Untersuchungen zur Korrektur des systematischen
Messfehlers des Hellmann-Niederschlagsmessers.
<em>Berichte des Deutschen Wetterdienstes</em>, <b>194</b>, 93 pp, Offenbach,
Germany
</p>


<h3>Examples</h3>

<pre><code class='language-R'>clim &lt;- slb1_meteo[as.integer(format(slb1_meteo$dates,"%Y")) %in% 2001:2005,]
clim$month &lt;- as.integer(format(clim$dates, "%m"))

prec_meas &lt;- clim$prec
correct_prec_frei &lt;- with(clim,
                       correct_prec(month, tmean, prec, station.exposure = "frei"))
correct_prec_lg &lt;- with(clim,
                     correct_prec(month, tmean, prec, station.exposure = "lg"))
correct_prec_mg &lt;- with(clim,
                     correct_prec(month, tmean, prec, station.exposure = "mg"))
correct_prec_sg &lt;- with(clim,
                     correct_prec(month, tmean, prec, station.exposure = "sg"))

plot(clim$dates, cumsum(correct_prec_frei),
type = "l", col = "violet", xlab = "dates", ylab = "cum. precipitation (mm)")
lines(clim$dates, cumsum(correct_prec_lg), col = "blue")
lines(clim$dates, cumsum(correct_prec_mg), col = "green")
lines(clim$dates, cumsum(correct_prec_sg), col = "red")
lines(clim$dates, cumsum(prec_meas))
legend('bottomright', c('frei', "lg", "mg", "sg"),
       col = c("violet", "blue", "green", "red", "black"),
       lty = 1, pch = NULL )
</code></pre>

<hr>
<h2 id='extract_layer_output'>Extracts values from layer data and organizes layer-wise variables in columns</h2><span id='topic+extract_layer_output'></span>

<h3>Description</h3>

<p>Convenience function to reorganize soil layer time series data from
<code>layer_output</code> list entry produced with <code><a href="#topic+run_LWFB90">run_LWFB90</a></code>. The data is tansformed to a
wide format, by casting the variables with the layer number using data.table's
<code><a href="data.table.html#topic+dcast">dcast</a></code>-function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_layer_output(
  x,
  layers = NULL,
  value_vars = NULL,
  layer_index_name = "nl",
  sep = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_layer_output_+3A_x">x</code></td>
<td>
<p>Data.frame or data.table with layer data organized in rows and
identified by a layer index column named <code>layer_index_nm</code>.</p>
</td></tr>
<tr><td><code id="extract_layer_output_+3A_layers">layers</code></td>
<td>
<p>Integer vector to select a subset of layers. If not supplied,
values from all layers will be returned.</p>
</td></tr>
<tr><td><code id="extract_layer_output_+3A_value_vars">value_vars</code></td>
<td>
<p>Character vector containing names of value-variables to be
extracted from <code>x</code>. If not supplied, <code>value_vars</code> will be
guessed.</p>
</td></tr>
<tr><td><code id="extract_layer_output_+3A_layer_index_name">layer_index_name</code></td>
<td>
<p>Column containing layer index. Defaults to 'nl' as in
<code>layer_output</code>.</p>
</td></tr>
<tr><td><code id="extract_layer_output_+3A_sep">sep</code></td>
<td>
<p>Separation character for constructig names from variable name and
layer index.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table with the layers' values of the variables organized in
columns with the names being made up of the variable name and the layer index.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a data.frame with monthly values
# identifiers: layer number, yr and mo
df &lt;- expand.grid(nl = 1:5,
                  yr = 2002,
                  mo = 1:12)
df

#add a value variable
df$var &lt;- runif(nrow(df), -1,0)

extract_layer_output(df)

# add more variables
df$var1 &lt;- runif(nrow(df), 1,2)
df$var2 &lt;- runif(nrow(df), 2,3)

# extract specific layers
extract_layer_output(df,layers = 2:4, sep = "_layer")

#extract specific variables
extract_layer_output(df, layers = 2:4, value_vars = c("var1", "var2"), sep = "_layer")
</code></pre>

<hr>
<h2 id='make_rootden'>Generates a root density depth function for soil layers</h2><span id='topic+make_rootden'></span>

<h3>Description</h3>

<p>Generates a root density depth function for soil layers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_rootden(
  soilnodes,
  maxrootdepth = min(soilnodes),
  method = "betamodel",
  beta = 0.97,
  rootdat = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_rootden_+3A_soilnodes">soilnodes</code></td>
<td>
<p>Vector of soil layer depth limits (including the top and the
bottom of the profile) for which the relative root distribution will be
calculated (m, negative downwards).</p>
</td></tr>
<tr><td><code id="make_rootden_+3A_maxrootdepth">maxrootdepth</code></td>
<td>
<p>The maximum rooting depth (m, negative downwards) below
which relative root length density will be set to zero (not applying when
<code>method = 'table'</code>).</p>
</td></tr>
<tr><td><code id="make_rootden_+3A_method">method</code></td>
<td>
<p>Method name for the root depth distribution. Possible values
are 'betamodel', 'table', 'linear', 'constant'. See details.</p>
</td></tr>
<tr><td><code id="make_rootden_+3A_beta">beta</code></td>
<td>
<p>Parameter of the root distribution function.</p>
</td></tr>
<tr><td><code id="make_rootden_+3A_rootdat">rootdat</code></td>
<td>
<p>data.frame with a given root depth density distribution.
Columns are depth limits ('upper' and 'lower' in m, negative downwards) and
relative root densities of fine or absorbing roots ('rootden') per unit
stonefree volume. Only used when <code>method = 'table'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>method = 'betamodel'</code> calculates the relative root length
densities of the soil layers from the cumulative proportion of roots
derived by the model after Gale &amp; Grigal (1987). <code>method = 'table'</code>
distributes the relative root densities provided by <code>rootdat</code> to the
soil layers, under preservation of total root mass. <code>method =
  'linear'</code> returns linearly decreasing root densities with a value of 1 at
the top of the soil profile to 0 at <code>maxrootdepth</code>. <code>method =
  'constant'</code> returns a uniform root distribution with a relative root length
density of 1 for all soil layers above <code>'maxrootdepth'</code>.
</p>


<h3>Value</h3>

<p>Vector of relative root length densities for the soil layers framed
by <code>soilnodes</code>. Length is one less than <code>length(soilnodes)</code>.
</p>


<h3>References</h3>

<p>Gale, M.R. &amp; Grigal D.F. (1987): &quot;Vertical root distributions of northern tree
species in relation to successional status.&quot;
<em>Canadian Journal of Forest Research</em>, <em>17:829-834</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>depths &lt;- c(max(slb1_soil$upper), slb1_soil$lower)
roots_beta &lt;- make_rootden(soilnodes = depths,
                              maxrootdepth = -1,4,
                              beta = 0.97,
                              method = "betamodel")

rootden_table &lt;- data.frame(
  upper = c(0.03,0,-0.02, -0.15, -0.35, -0.5, -0.65,-0.9,-1.1,-1.3),
  lower = c(0,-0.02, -0.15, -0.35, -0.5, -0.65,-0.9,-1.1,-1.3,-1.6),
  rootden = c(10,15, 35, 15, 7.5, 4, 12, 2, 2, 0))

roots_table &lt;- make_rootden(soilnodes = depths,
                               method = "table",
                               rootdat = rootden_table)

roots_linear &lt;- make_rootden(soilnodes = depths,
                                maxrootdepth = -1.4,
                                method = 'linear')

roots_constant &lt;- make_rootden(soilnodes = depths,
                                  maxrootdepth = -1.4,
                                  method = 'const')

plot(roots_constant, slb1_soil$lower +runif(n=length(slb1_soil$lower), -0.02,0.02),
     type = 's', lwd = 1.5,ylab = "soil depth [m]",xlab = "relative root density",
     xlim = c(0,1), col = "red")

lines(roots_linear, slb1_soil$lower,
      type = 's', col = "blue", lwd = 1.5)

lines(roots_beta*10, slb1_soil$lower, type = 's', col = "brown", lwd = 1.5)

lines(roots_table/100, slb1_soil$lower,
      type = 's', col = "green", lwd = 1.5)


legend("bottomright", c("'betamodel'","'table'","'linear'", "'constant'"),seg.len = 1.5,
       pch = NULL, lwd =1.5, col = c("brown", "green", "blue", "red"), bty = "n")
</code></pre>

<hr>
<h2 id='make_seasLAI'>Construct the seasonal course of leaf area index from parameters</h2><span id='topic+make_seasLAI'></span>

<h3>Description</h3>

<p>A daily sequence of leaf area index is derived from maximum and minimum
values, dates and shape parameters using different methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_seasLAI(
  method = "b90",
  year,
  maxlai,
  winlaifrac = 0,
  budburst_doy = 121,
  leaffall_doy = 279,
  emerge_dur = 28,
  leaffall_dur = 58,
  shp_optdoy = 220,
  shp_budburst = 0.5,
  shp_leaffall = 10,
  lai_doy = c(1, 121, 150, 280, 320, 365),
  lai_frac = c(0, 0, 0.5, 1, 0.5, 0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_seasLAI_+3A_method">method</code></td>
<td>
<p>Name of method for generating the sequence. Must be one of
&quot;b90&quot;, &quot;linear&quot;, &quot;Coupmodel&quot;.</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_year">year</code></td>
<td>
<p>Vector of years to be returned.</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_maxlai">maxlai</code></td>
<td>
<p>Maximum leaf are index.</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_winlaifrac">winlaifrac</code></td>
<td>
<p>Fraction of <code>maxlai</code> during winter (ignored when
<code>method = 'linear'</code>).</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_budburst_doy">budburst_doy</code></td>
<td>
<p>Budburst day of year (ignored when <code>method =
'linear'</code>).</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_leaffall_doy">leaffall_doy</code></td>
<td>
<p>Day of year when leaf fall begins (ignored when
<code>method = 'linear'</code>).</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_emerge_dur">emerge_dur</code></td>
<td>
<p>Number of days from budburst until maximum leaf area index
is reached.</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_leaffall_dur">leaffall_dur</code></td>
<td>
<p>Number of days until minimum leaf are index is reached.</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_shp_optdoy">shp_optdoy</code></td>
<td>
<p>Day of year when optimum value is reached (required when
<code>method = "Coupmodel"</code>).</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_shp_budburst">shp_budburst</code></td>
<td>
<p>Shape parameter for the growth phase (required when
<code>method = "Coupmodel"</code>).</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_shp_leaffall">shp_leaffall</code></td>
<td>
<p>Shape parameter growth cessation (required when
<code>method = "Coupmodel"</code>).</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_lai_doy">lai_doy</code></td>
<td>
<p>Integer vector of days of years.</p>
</td></tr>
<tr><td><code id="make_seasLAI_+3A_lai_frac">lai_frac</code></td>
<td>
<p>Vector of values of fractional leaf area index corresponding
to lai_doy (required when <code>method = "linear"</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of daily lai values covering the years specified.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Intraannual courses of leaf area index
lai_b90 &lt;- make_seasLAI(method = "b90",
                       year = 2001,
                       maxlai = 5,
                       winlaifrac = 0,
                       budburst_doy = 121,
                       leaffall_doy = 280,
                       emerge_dur = 15,
                       leaffall_dur = 30)

lai_doy &lt;- c(1,110,117,135,175,220,250,290,365)
lai_frac &lt;- c(0.1,0.1,0.5,0.7,1.2,1.2,1.0,0.1,0.1)
lai_linear &lt;- make_seasLAI(method = "linear",
                          year = 2001,
                          maxlai = 5,
                          lai_doy = lai_doy,
                          lai_frac = lai_frac)

lai_coupmodel &lt;- make_seasLAI(method = "Coupmodel",
                             year = 2001,
                             maxlai = 5,
                             winlaifrac = 0.1,
                             budburst_doy = 110,
                             leaffall_doy = 280,
                             shp_optdoy = 180,
                             shp_budburst = 0.5,
                             shp_leaffall = 5)

plot(lai_b90, type = "n", xlab = "doy", ylab = "lai [m²/m²]", ylim = c(0,6))
lines(lai_b90, col ="green",lwd = 2,)
lines(lai_linear, col ="red",lwd = 2)
lines(lai_coupmodel, col ="blue",lwd = 2)

# incorparating between-year variability
years &lt;- 2001:2003
lai &lt;- make_seasLAI(method = "Coupmodel",
                   year = years,
                   maxlai = c(4,6,5),
                   budburst_doy = c(100,135,121),
                   leaffall_doy = 280,
                   shp_budburst = c(3,1,0.3),
                   shp_leaffall = 3,
                   shp_optdoy =c(210,180,240) )

dates &lt;- seq.Date(as.Date("2001-01-01"), as.Date("2003-12-31"), by = "day")
plot(dates,lai, col = "green", ylab = "lai [m²/m²]",
     type ="l", xlab = "", lwd = 2)
</code></pre>

<hr>
<h2 id='make_standprop'>Create daily plant characteristics from parameters and options</h2><span id='topic+make_standprop'></span>

<h3>Description</h3>

<p>Creates daily sequences of 'age', 'height', 'sai', 'densef', and 'lai' from
parameters and options using <code><a href="#topic+approx_standprop">approx_standprop</a></code> and
<code><a href="#topic+make_seasLAI">make_seasLAI</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_standprop(options_b90, param_b90, out_yrs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_standprop_+3A_options_b90">options_b90</code></td>
<td>
<p>A list of model control options.</p>
</td></tr>
<tr><td><code id="make_standprop_+3A_param_b90">param_b90</code></td>
<td>
<p>A parameter list-object.</p>
</td></tr>
<tr><td><code id="make_standprop_+3A_out_yrs">out_yrs</code></td>
<td>
<p>Years for which values are returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame containing daily sequences of 'age', 'height', 'sai',
'densef', and 'lai'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>options_b90 &lt;- set_optionsLWFB90()
param_b90 &lt;- set_paramLWFB90()

standprop &lt;- make_standprop(options_b90,
                            param_b90,
                            out_yrs = 2002:2004)
plot(standprop$dates, standprop$lai, type = "l")
</code></pre>

<hr>
<h2 id='param_to_rlwfbrook90'>Create a parameter vector for the r_lwfbrook90-function</h2><span id='topic+param_to_rlwfbrook90'></span>

<h3>Description</h3>

<p>The <code>param</code> vector for <code><a href="#topic+r_lwfbrook90">r_lwfbrook90</a></code> is created from model
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>param_to_rlwfbrook90(param_b90, imodel)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="param_to_rlwfbrook90_+3A_param_b90">param_b90</code></td>
<td>
<p>A named list of model parameters.</p>
</td></tr>
<tr><td><code id="param_to_rlwfbrook90_+3A_imodel">imodel</code></td>
<td>
<p>Name of hydraulic model ('MvG' or 'CH')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical vector with the parameters in the right order for
<code><a href="#topic+r_lwfbrook90">r_lwfbrook90</a></code>.
</p>

<hr>
<h2 id='plant_b90'>Interpolate plant properties using the 'b90' method.</h2><span id='topic+plant_b90'></span>

<h3>Description</h3>

<p>Creates a daily sequence for one year from parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plant_b90(minval, maxval, doy.incr, incr.dur, doy.decr, decr.dur, maxdoy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plant_b90_+3A_minval">minval</code></td>
<td>
<p>Minimum value.</p>
</td></tr>
<tr><td><code id="plant_b90_+3A_maxval">maxval</code></td>
<td>
<p>Maximum value.</p>
</td></tr>
<tr><td><code id="plant_b90_+3A_doy.incr">doy.incr</code></td>
<td>
<p>Day of year when increasing from <code>minval</code> to
<code>maxval</code> begins.</p>
</td></tr>
<tr><td><code id="plant_b90_+3A_incr.dur">incr.dur</code></td>
<td>
<p>Duration (number of days) since  <code>doy.incr</code> until
<code>maxval</code> is reached.</p>
</td></tr>
<tr><td><code id="plant_b90_+3A_doy.decr">doy.decr</code></td>
<td>
<p>Day of year when decreasing to <code>minval</code> begins.</p>
</td></tr>
<tr><td><code id="plant_b90_+3A_decr.dur">decr.dur</code></td>
<td>
<p>Duration (number of days) since <code>doy.incr</code> until
<code>minval</code> is reached.</p>
</td></tr>
<tr><td><code id="plant_b90_+3A_maxdoy">maxdoy</code></td>
<td>
<p>Length of the year, 366 for leap years, 365 for normal years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length <code>maxdoy</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(plant_b90(minval = 0,maxval=1,
doy.incr = 121,incr.dur = 28,
doy.decr = 280, decr.dur = 50,
maxdoy = 365))
</code></pre>

<hr>
<h2 id='plant_coupmodel'>Interpolate plant properties using the 'Coupmodel' method.</h2><span id='topic+plant_coupmodel'></span>

<h3>Description</h3>

<p>Creates a daily sequence for one year from parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plant_coupmodel(
  minval,
  maxval,
  doy.incr,
  doy.max,
  doy.min,
  shape.incr,
  shape.decr,
  maxdoy
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plant_coupmodel_+3A_minval">minval</code></td>
<td>
<p>Minimum value.</p>
</td></tr>
<tr><td><code id="plant_coupmodel_+3A_maxval">maxval</code></td>
<td>
<p>Maximum value.</p>
</td></tr>
<tr><td><code id="plant_coupmodel_+3A_doy.incr">doy.incr</code></td>
<td>
<p>Day of year when increasing from <code>minval</code> to
<code>maxval</code> begins.</p>
</td></tr>
<tr><td><code id="plant_coupmodel_+3A_doy.max">doy.max</code></td>
<td>
<p>Day of year when <code>maxval</code> is reached.</p>
</td></tr>
<tr><td><code id="plant_coupmodel_+3A_doy.min">doy.min</code></td>
<td>
<p>Day of year when <code>minval</code> is reached again.</p>
</td></tr>
<tr><td><code id="plant_coupmodel_+3A_shape.incr">shape.incr</code></td>
<td>
<p>Shape parameter of the increasing phase.</p>
</td></tr>
<tr><td><code id="plant_coupmodel_+3A_shape.decr">shape.decr</code></td>
<td>
<p>Shape parameter of the decreasing phase.</p>
</td></tr>
<tr><td><code id="plant_coupmodel_+3A_maxdoy">maxdoy</code></td>
<td>
<p>Length of the year, 366 for leap years, 365 for normal years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length <code>maxdoy</code>.
</p>


<h3>References</h3>

<p>Jansson, P.-E. &amp; Karlberg, L. (2004): &quot;Coupled heat and mass transfer model for
soil-plant-atmosphere systems.&quot;
<em>Royal Institute of Technolgy, Dept of Civil and Environmental Engineering Stockholm</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(plant_coupmodel(0,5, 121, 200, 280, 0.3, 3, 365))

</code></pre>

<hr>
<h2 id='plant_linear'>Interpolate plant properties using the 'linear' method.</h2><span id='topic+plant_linear'></span>

<h3>Description</h3>

<p>Creates a daily sequence for one year from doy/value pairs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plant_linear(doys, values, maxdoy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plant_linear_+3A_doys">doys</code></td>
<td>
<p>Integer vector of dates (days of year).</p>
</td></tr>
<tr><td><code id="plant_linear_+3A_values">values</code></td>
<td>
<p>Numeric vector of values.</p>
</td></tr>
<tr><td><code id="plant_linear_+3A_maxdoy">maxdoy</code></td>
<td>
<p>Integer length of the year, 366 for leap years, 365 for normal
years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length <code>maxdoy</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doys &lt;- c(110,200,250,280)
values &lt;-  c(0,0.8,1,0)
maxdoy &lt;- 365
plot(plant_linear(doys = doys, values = values, maxdoy = 365))
</code></pre>

<hr>
<h2 id='process_outputs_LWFB90'>Aggregate and group model outputs similar to ancient LWFB90 textfile outputs (.ASC-files)</h2><span id='topic+process_outputs_LWFB90'></span>

<h3>Description</h3>

<p>Returns selected groups of variables in the chosen temporal aggregation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_outputs_LWFB90(x, selection = set_outputLWFB90(), prec_interval = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_outputs_LWFB90_+3A_x">x</code></td>
<td>
<p>Named list with items <code>x$output</code> and/or <code>x$layer_output</code>
(e.g. as returned by <code><a href="#topic+run_LWFB90">run_LWFB90</a></code>)</p>
</td></tr>
<tr><td><code id="process_outputs_LWFB90_+3A_selection">selection</code></td>
<td>
<p>A [7,5]-matrix with row and column names, flagging the
desired groups of variables at specified time intervals (see
<code><a href="#topic+set_outputLWFB90">set_outputLWFB90</a></code>).</p>
</td></tr>
<tr><td><code id="process_outputs_LWFB90_+3A_prec_interval">prec_interval</code></td>
<td>
<p>The precipitation interval of the simulation
that produced <code>x</code>. If available, the value <code>x$model_input$options_b90$prec_interval</code> is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list containing the selected groups of variables in the
desired temporal resolution. The names are constructed from
<code>selection</code>'s row names and column names, suffixed by '.ASC' as a
reminiscence to the former text file output of LWF-Brook90.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("slb1_soil")
data("slb1_meteo")
opts &lt;- set_optionsLWFB90(startdate = as.Date("2002-06-01"), enddate = as.Date("2002-06-05"))
parms &lt;- set_paramLWFB90()
soil &lt;- cbind(slb1_soil, hydpar_wessolek_tab(texture = slb1_soil$texture))

outsel &lt;- set_outputLWFB90()
outsel[,] &lt;- 1L

res &lt;- run_LWFB90(options_b90 = opts,
           param_b90 = parms,
           climate = slb1_meteo,
           soil = soil)

# Calculate output-aggregations using the returned object
process_outputs_LWFB90(res, selection = outsel)

# or calculate aggregations at run time by passing the function via output_fun-arg
run_LWFB90(options_b90 = opts,
           param_b90 = parms,
           climate = slb1_meteo,
           soil = soil,
           rtrn_input = FALSE,
           output_fun = process_outputs_LWFB90,
           selection = outsel)$output_fun

</code></pre>

<hr>
<h2 id='ptfs'>Functions to derive soil hydraulic properties from soil properties</h2><span id='topic+ptfs'></span><span id='topic+hydpar_puh2'></span><span id='topic+hydpar_hypres'></span><span id='topic+hydpar_hypres_tab'></span><span id='topic+hydpar_wessolek_tab'></span><span id='topic+hydpar_ff_b90'></span>

<h3>Description</h3>

<p>A set of pedotransfer functions for deriving Mualem - van Genuchten
parameters from soil physical properties of soil horizons, such as soil
texture, bulk density and carbon content.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hydpar_puh2(clay, silt, sand, bd, oc.pct = 0.5)

hydpar_hypres(clay, silt, bd, oc.pct = 0.1, topsoil = TRUE, humconv = 1.72)

hydpar_hypres_tab(texture, topsoil)

hydpar_wessolek_tab(texture)

hydpar_ff_b90(n = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ptfs_+3A_clay">clay</code>, <code id="ptfs_+3A_silt">silt</code>, <code id="ptfs_+3A_sand">sand</code></td>
<td>
<p>Numeric vectors of clay, silt, sand in mass %.
Particle size ranges for clay, silt and sand correspond to &lt;2, 2-63, and
63-2000 <code class="reqn">\mu m</code>. For <code><a href="#topic+hydpar_hypres">hydpar_hypres</a></code>, the particle
size limit between silt and sand should be 50 <code class="reqn">\mu m</code>.</p>
</td></tr>
<tr><td><code id="ptfs_+3A_bd">bd</code></td>
<td>
<p>Numeric vector of bulk density in g cm-3.</p>
</td></tr>
<tr><td><code id="ptfs_+3A_oc.pct">oc.pct</code></td>
<td>
<p>Numeric vector of organic carbon content in mass %.</p>
</td></tr>
<tr><td><code id="ptfs_+3A_topsoil">topsoil</code></td>
<td>
<p>Logical: Is the sample from the topsoil? Used in
<code><a href="#topic+hydpar_hypres_tab">hydpar_hypres_tab</a></code>.</p>
</td></tr>
<tr><td><code id="ptfs_+3A_humconv">humconv</code></td>
<td>
<p>Conversion factor from oc.pct to organic matter percent.
Default: 1.72. Only for <code>hydpar_hypres_tab</code>.</p>
</td></tr>
<tr><td><code id="ptfs_+3A_texture">texture</code></td>
<td>
<p>Character vector of soil texture classes. For
<code>hydpar_wessolek_tab</code> classes according to KA5 (AG Boden 2005) have to
be provided. When using <code><a href="#topic+hydpar_hypres_tab">hydpar_hypres_tab</a></code>, texture classes
according to FAO (1990) have to provided.</p>
</td></tr>
<tr><td><code id="ptfs_+3A_n">n</code></td>
<td>
<p>An integer value specifying the number of rows of the returned
data.frame (i.e. the number of repetitions of the MvG-Parameter set, only
for <code>hydpar_ff_hamken</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>hydpar_puh2</code> derives Mualem - van Genuchten (MvG) parameters
using the regression functions developed by Puhlmann &amp; von Wilpert (2011).
The equations of Wösten et al. (1999) are available via <code>hydpar_hypres</code>,
and their tabulated values for soil texture classes can be derived using the
function <code>hydpar_hypres_tab</code>. The table of MvG parameters from Wesselok
et al. (2009; Tab. 10) is accessible by <code>hydpar_wessolek_tab</code>. For this
function, soil texture classes after the German texture classification system
(KA5, AG Boden 2005) have to be provided. To derive hydraulic parameters of
forest floor horizons, the function <code>hydpar_ff_b90</code> can be used. It
returns the single MvG parameter set for forest floor horizons reported by
Hammel &amp; Kennel (2001) in their original LWF-Brook90 publication.
</p>


<h3>Value</h3>

<p>A data.frame with the following variables: </p>

<dl>
<dt>ths</dt><dd><p>Saturation water content fraction</p>
</dd> <dt>thr</dt><dd><p>Residual water
content fraction</p>
</dd> <dt>npar</dt><dd><p>N parameter of the van Genuchten water
retention function</p>
</dd> <dt>mpar</dt><dd><p>M parameter of the van Genuchten water
retention function</p>
</dd> <dt>alpha</dt><dd><p>Alpha parameter of the van Genuchten water
retention function (1/m)</p>
</dd> <dt>ksat</dt><dd><p>Saturated hyraulic conductivity
parameter of Mualem hydraulic conductivity function (mm/d)</p>
</dd>
<dt>tort</dt><dd><p>Tortuosity parameter of Mualem hydraulic conductivity function</p>
</dd>
</dl>



<h3>References</h3>

<p>AG Boden (2005)
Bodenkundliche Kartieranleitung
Schweizerbart'sche Verlagsbuchhandlung, Stuttgart
</p>
<p>Food and Agriculture Organisation (FAO) (1990)
Guidelines for soil description
FAO/ISRIC, Rome, 3rd edition
</p>
<p>Hammel K &amp; Kennel M (2001)
Charakterisierung und Analyse der Wasserverfügbarkeit und des Wasserhaushalts
von Waldstandorten in Bayern mit dem Simulationsmodell BROOK90.
<em>Forstliche Forschungsberichte München</em> 185
</p>
<p>Puhlmann H, von Wilpert K (2011)
Testing and development of pedotransfer functions for water retention and
hydraulic conductivity of forest soils.
<em>Waldökologie, Landschaftsforschung und Naturschutz</em> 12, pp. 61-71
</p>
<p>Wessolek G, Kaupenjohann M and Renger H (2009)
Bodenphysikalische Kennwerte und Berechnungsverfahren für die Praxis.
<em>Bodenökologie und Bodengenese</em> 40, Berlin, Germany
</p>
<p>Woesten JHM, Lilly A, Nemes A, Le Bas C  (1999)
Development and use of a database of hydraulic properties of European soils.
<em>Geoderma</em> 90, pp. 169-185
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
hydpar_puh2(clay = c(10,20), silt = c(40,20), sand = c(50,60), bd = c(1.6, 1.4))

hydpar_hypres(20,20,1.5,2)

hydpar_hypres_tab(texture = c("C","MF"), topsoil = c(TRUE,FALSE))

hydpar_wessolek_tab(c("Us", "Ls2", "mSfS"))

hydpar_ff_b90(n = 5)
</code></pre>

<hr>
<h2 id='r_lwfbrook90'>Interface function to the LWF-Brook90 model</h2><span id='topic+r_lwfbrook90'></span>

<h3>Description</h3>

<p>Passes input data matrices to the Fortran model code and returns the results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r_lwfbrook90(
  siteparam,
  climveg,
  param,
  pdur,
  soil_materials,
  soil_nodes,
  precdat = NULL,
  output_log = TRUE,
  chk_input = TRUE,
  timelimit = Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="r_lwfbrook90_+3A_siteparam">siteparam</code></td>
<td>
<p>A [1,9] matrix with site level information: start year,
start doy, latitude, initial snow, initial groundwater, precipitation
interval, a snow cover's  liquid water (SNOWLQ) and cold content (CC).</p>
</td></tr>
<tr><td><code id="r_lwfbrook90_+3A_climveg">climveg</code></td>
<td>
<p>A matrix with 15 columns of climatic and vegetation data:
year, month, day, global radiation in MJ/(m² d), tmax (deg C), tmin (deg
C), vappres (kPa), wind (m/s), prec (mm), mesfl (mm), densef (-), stand
height (m), lai (m²/m²), sai (m²/m²), stand age (years).</p>
</td></tr>
<tr><td><code id="r_lwfbrook90_+3A_param">param</code></td>
<td>
<p>A numeric vector of model input parameters (for the right order
see <code><a href="#topic+param_to_rlwfbrook90">param_to_rlwfbrook90</a></code>).</p>
</td></tr>
<tr><td><code id="r_lwfbrook90_+3A_pdur">pdur</code></td>
<td>
<p>a [1,12]-matrix of precipitation durations (hours) for each
month.</p>
</td></tr>
<tr><td><code id="r_lwfbrook90_+3A_soil_materials">soil_materials</code></td>
<td>
<p>A matrix of the 8 soil materials parameters. When
imodel = 1 (Mualem-van Genuchten), these refer to: mat, ths, thr, alpha
(1/m), npar, ksat (mm/d), tort (-), stonef (-). When imodel = 2
(Clapp-Hornberger): mat, thsat, thetaf, psif (kPa), bexp, kf (mm/d), wetinf
(-), stonef (-).</p>
</td></tr>
<tr><td><code id="r_lwfbrook90_+3A_soil_nodes">soil_nodes</code></td>
<td>
<p>A matrix of the soil model layers with columns nl (layer
number), layer midpoint (m), thickness (mm), mat, psiini (kPa), rootden
(-).</p>
</td></tr>
<tr><td><code id="r_lwfbrook90_+3A_precdat">precdat</code></td>
<td>
<p>A matrix of precipitation interval data with 6 columns: year,
month, day, interval-number (1:precint), prec, mesflp.</p>
</td></tr>
<tr><td><code id="r_lwfbrook90_+3A_output_log">output_log</code></td>
<td>
<p>Logical whether to print runtime output to console.</p>
</td></tr>
<tr><td><code id="r_lwfbrook90_+3A_chk_input">chk_input</code></td>
<td>
<p>Logical whether to check for NaNs in model inputs.</p>
</td></tr>
<tr><td><code id="r_lwfbrook90_+3A_timelimit">timelimit</code></td>
<td>
<p>Integer to set elapsed time limits for running the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the daily and soil layer model outputs, along with
an error code of the simulation (see <code><a href="#topic+run_LWFB90">run_LWFB90</a></code>.
</p>

<hr>
<h2 id='replace_vecelements'>Replace elements in a data.frame or vector of length &gt; 1 by name</h2><span id='topic+replace_vecelements'></span>

<h3>Description</h3>

<p>Replace elements in a data.frame or vector of length &gt; 1 by name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_vecelements(x, varnms, vals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="replace_vecelements_+3A_x">x</code></td>
<td>
<p>A vector or data.frame.</p>
</td></tr>
<tr><td><code id="replace_vecelements_+3A_varnms">varnms</code></td>
<td>
<p>Variable names to match: Specify position by name and index.</p>
</td></tr>
<tr><td><code id="replace_vecelements_+3A_vals">vals</code></td>
<td>
<p>Vector of values to insert at the specified positions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector or data.frame in x with the elements 'varnms' replaced by
vals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>soil_materials &lt;- data.frame(ths = rep(0.4,3), alpha = rep(23.1, 3))

varnms = c("soil_materials.ths3", "soil_materials.ths1", "soil_materials.alpha2")
vals = c(0.999, 0.001, 99)
soil_materials
replace_vecelements(soil_materials, varnms, vals)

x &lt;- set_paramLWFB90()[["pdur"]]
varnms &lt;- c("pdur2", "pdur12")
vals &lt;- c(0,10)
x
replace_vecelements(x, varnms, vals)
</code></pre>

<hr>
<h2 id='run_LWFB90'>Run the LWF-Brook90 hydrologic model</h2><span id='topic+run_LWFB90'></span>

<h3>Description</h3>

<p>Sets up the input objects for the LWF-Brook90 hydrologic model, starts the
model, and returns the selected results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_LWFB90(
  options_b90,
  param_b90,
  climate,
  precip = NULL,
  soil = NULL,
  output_fun = NULL,
  rtrn_input = TRUE,
  rtrn_output = TRUE,
  chk_input = TRUE,
  run = TRUE,
  timelimit = Inf,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_LWFB90_+3A_options_b90">options_b90</code></td>
<td>
<p>Named list of model control options. Use
<code><a href="#topic+set_optionsLWFB90">set_optionsLWFB90</a></code> to generate a list with default model
control options.</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_param_b90">param_b90</code></td>
<td>
<p>Named list of model input parameters. Use
<code><a href="#topic+set_paramLWFB90">set_paramLWFB90</a></code> to generate a list with default model
parameters.</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_climate">climate</code></td>
<td>
<p>Data.frame with daily climatic data, or a function that
returns a suitable data.frame. See details for the required variables.</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_precip">precip</code></td>
<td>
<p>Data.frame with columns 'dates' and 'prec' to supply
precipitation data separately from climate data. Can be used to provide
sub-day resolution precipitation data to LWFBrook90. For each day in dates,
1 (daily resolution) to 240 values of precipitation can be provided, with
the number of values per day defined in <code>options_b90$prec_interval</code>.</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_soil">soil</code></td>
<td>
<p>Data.frame containing the hydraulic properties of the soil
layers. See section 'Soil parameters'</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_output_fun">output_fun</code></td>
<td>
<p>A function or a list of functions of the form
<code>f(x,...)</code>, where <code>x</code> is the object regularly returned by
<code>run_LWFB90</code>. During function evaluation, <code>x</code> contains model
input and selected output objects, irrespective of <code>rtrn_input</code> and
<code>rtrn_output</code>. Can be used to  aggregate output on-the-fly, and is
especially useful if the function is evaluated within a large multi-run
application, for which the output might overload the memory. (see
<code><a href="#topic+run_multi_LWFB90">run_multi_LWFB90</a></code> and <code><a href="#topic+run_multisite_LWFB90">run_multisite_LWFB90</a></code>).</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_rtrn_input">rtrn_input</code></td>
<td>
<p>Logical: append <code>param_b90</code>, <code>options_b90</code>, and
daily plant properties (<code>standprop_daily</code>, as derived from parameters)
to the result?</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_rtrn_output">rtrn_output</code></td>
<td>
<p>Logical: return the simulation results select via
<code>output</code>?</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_chk_input">chk_input</code></td>
<td>
<p>Logical wether to check <code>param_b90</code>,
<code>options_b90</code>, <code>climate</code>, <code>precip</code>, and <code>soil</code> for
completeness and consistency.</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_run">run</code></td>
<td>
<p>Logical: run LWF-Brook90 or only return model input objects?
Useful to inspect the effects of options and parameters on model input.
Default is TRUE.</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_timelimit">timelimit</code></td>
<td>
<p>Integer to set elapsed time limits (seconds) for running LWF-Brook90.</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_verbose">verbose</code></td>
<td>
<p>Logical: print messages to the console? Default is FALSE.</p>
</td></tr>
<tr><td><code id="run_LWFB90_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>output_fun</code> and/or
<code>climate</code>, if the latter is a function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the selected model output (if <code>rtrn_output ==
  TRUE</code>), the model input (if <code>rtrn_input == TRUE</code>, except for
<code>climate</code>), and the return values of <code>output_fun</code> if specified.
</p>


<h3>Climate input data</h3>

<p>The <code>climate</code> data.frame (or function) must
contain (return) the following variables in columns named 'dates' (Date),
'tmax' (deg C), 'tmin' (deg C), 'tmean' (deg C), 'windspeed' (m/s), 'prec'
(mm) , 'vappres' (kPa), and either 'globrad' ( MJ/(m²d) ) or 'sunhours' (h).
When using <code>sunhours</code>, please set <code>options_b90$fornetrad =
 'sunhours'</code>.
</p>


<h3>Soil input parameters</h3>

<p>Each row of <code>soil</code> represents one layer,
containing the layers' boundaries and soil hydraulic parameters. The column
names for the upper and lower layer boundaries are 'upper' and 'lower' (m,
negative downwards). When using <code>options_b90$imodel = 'MvG'</code>, the
hydraulic parameters are 'ths', 'thr', 'alpha' (1/m), 'npar', 'ksat' (mm/d)
and 'tort'.  With <code>options_b90$imodel = 'CH'</code>, the parameters are
'thsat', 'thetaf', 'psif' (kPa), 'bexp', 'kf' (mm/d), and 'wetinf'. For both
parameterizations, the volume fraction of stones has to be named 'gravel'.
If the <code>soil</code> argument is not provided, list items <code>soil_nodes</code>
and <code>soil_materials</code> of <code>param_b90</code> are used for the simulation.
These have to be set up in advance, see <code><a href="#topic+soil_to_param">soil_to_param</a></code>.
</p>


<h3>Outputs</h3>


<table>
<tr>
 <td style="text-align: left;">
<strong>Name</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td><td style="text-align: center;"> <strong>Unit</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
yr </td><td style="text-align: left;"> year </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
mo </td><td style="text-align: left;"> month </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
da </td><td style="text-align: left;"> day of month </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
doy </td><td style="text-align: left;"> day of year </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
aa </td><td style="text-align: left;"> average available energy above canopy </td><td style="text-align: center;"> W/m2 </td>
</tr>
<tr>
 <td style="text-align: left;">
adef </td><td style="text-align: left;"> available water deficit in root zone </td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
asubs </td><td style="text-align: left;"> average available energy below canopy </td><td style="text-align: center;"> W/m2 </td>
</tr>
<tr>
 <td style="text-align: left;">
awat </td><td style="text-align: left;"> total available soil water in layers with roots between -6.18 kPa and <code>param_b90$psicr</code> </td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
balerr </td><td style="text-align: left;"> error in water balance (daily value, output at the day's last precipitation interval) </td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
byfl </td><td style="text-align: left;"> total bypass flow </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
cc </td><td style="text-align: left;"> cold content of snowpack (positive) </td><td style="text-align: center;"> MJ m-2 </td>
</tr>
<tr>
 <td style="text-align: left;">
dsfl </td><td style="text-align: left;"> downslope flow </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
evap </td><td style="text-align: left;"> evapotranspiration </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
flow </td><td style="text-align: left;"> total streamflow </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
gwat </td><td style="text-align: left;"> groundwater storage below soil layers </td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
gwfl </td><td style="text-align: left;"> groundwater flow </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
intr </td><td style="text-align: left;"> intercepted rain </td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
ints </td><td style="text-align: left;"> intercepted snow </td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
irvp </td><td style="text-align: left;"> evaporation of intercepted rain </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
isvp </td><td style="text-align: left;"> evaporation of intercepted snow </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
lngnet </td><td style="text-align: left;"> net longwave radiation </td><td style="text-align: center;"> W/m2 </td>
</tr>
<tr>
 <td style="text-align: left;">
nits </td><td style="text-align: left;"> total number of iterations </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
pint </td><td style="text-align: left;"> potential interception for a canopy always wet </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
pslvp </td><td style="text-align: left;"> potential soil evaporation </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
ptran </td><td style="text-align: left;"> potential transpiration </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
relawat </td><td style="text-align: left;"> relative available soil water in layers with roots </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
rfal </td><td style="text-align: left;"> rainfall </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
rint </td><td style="text-align: left;"> rain interception catch rate </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
rnet </td><td style="text-align: left;"> rainfall to soil surface </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
rsno </td><td style="text-align: left;"> rain on snow </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
rthr </td><td style="text-align: left;"> rain throughfall rate </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
sthr </td><td style="text-align: left;"> snow throughfall rate </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
safrac </td><td style="text-align: left;"> source area fraction </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
seep </td><td style="text-align: left;"> seepage loss </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
sfal </td><td style="text-align: left;"> snowfall </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
sint </td><td style="text-align: left;"> snow interception catch rate </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
slfl </td><td style="text-align: left;"> input to soil surface </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
slvp </td><td style="text-align: left;"> evaporation rate from soil </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
slrad </td><td style="text-align: left;"> average solar radiation on slope over daytime </td><td style="text-align: center;"> W/m2 </td>
</tr>
<tr>
 <td style="text-align: left;">
solnet </td><td style="text-align: left;"> net solar radiation on slope over daytime </td><td style="text-align: center;"> W/m2 </td>
</tr>
<tr>
 <td style="text-align: left;">
smlt </td><td style="text-align: left;"> snowmelt </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
snow </td><td style="text-align: left;"> snowpack water equivalent </td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
snowlq </td><td style="text-align: left;"> liquid water content of snow on the ground </td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
snvp </td><td style="text-align: left;"> evaporation from snowpack </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
srfl </td><td style="text-align: left;"> source area flow </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
stres </td><td style="text-align: left;"> tran / ptran (daily value, output at the day's last precipitation interval) </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
swat </td><td style="text-align: left;"> total soil water in all layers</td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
tran </td><td style="text-align: left;"> transpiration </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
vrfln </td><td style="text-align: left;"> vertical matrix drainage from lowest layer </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Layer outputs</h3>


<table>
<tr>
 <td style="text-align: left;">
<strong>Name</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td><td style="text-align: center;"> <strong>Unit</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
yr </td><td style="text-align: left;"> year </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
mo </td><td style="text-align: left;"> month </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
da </td><td style="text-align: left;"> day of month </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
doy </td><td style="text-align: left;"> day of year </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
nl </td><td style="text-align: left;"> index of soil layer </td><td style="text-align: center;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
swati </td><td style="text-align: left;"> soil water volume in layer </td><td style="text-align: center;"> mm </td>
</tr>
<tr>
 <td style="text-align: left;">
theta </td><td style="text-align: left;"> water content of soil layer, mm water / mm soil matrix </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
wetnes </td><td style="text-align: left;"> wetness of soil layer, fraction of saturation </td><td style="text-align: center;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
psimi </td><td style="text-align: left;"> matric soil water potential for soil layer </td><td style="text-align: center;"> kPa </td>
</tr>
<tr>
 <td style="text-align: left;">
infl </td><td style="text-align: left;"> infiltration to soil water in soil layer </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
byfl </td><td style="text-align: left;"> bypass flow from soil layer </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
tran </td><td style="text-align: left;"> transpiration from soil layer </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
vrfl </td><td style="text-align: left;"> vertical matrix drainage from soil layer </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
dsfl </td><td style="text-align: left;"> downslope drainage from layer </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
ntfl </td><td style="text-align: left;"> net flow into soil layer </td><td style="text-align: center;"> mm/d </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># Set up lists containing model control options and model parameters:
param_b90 &lt;- set_paramLWFB90()
options_b90 &lt;- set_optionsLWFB90()

# Set start and end Dates for the simulation
options_b90$startdate &lt;- as.Date("2003-06-01")
options_b90$enddate &lt;- as.Date("2003-06-30")

# Derive soil hydraulic properties from soil physical properties
# using pedotransfer functions
soil &lt;- cbind(slb1_soil, hydpar_wessolek_tab(slb1_soil$texture))

# Run LWF-Brook90
b90.result &lt;- run_LWFB90(options_b90 = options_b90,
                        param_b90 = param_b90,
                        climate = slb1_meteo,
                        soil = soil)

# use a function to be performed on the output:
# aggregate soil water storage down to a specific layer
agg_swat &lt;- function(x, layer) {
  out &lt;- aggregate(swati~yr+doy,
                   x$SWATDAY.ASC,
                   FUN = sum,
                   subset = nl &lt;= layer)
  out[order(out$yr, out$doy),]}

# run model without returning the selected output.
b90.aggswat &lt;- run_LWFB90(options_b90 = options_b90,
                         param_b90 = param_b90,
                         climate = slb1_meteo,
                         soil = soil,
                         output_fun = list(swat = agg_swat),
                         rtrn_output = FALSE,
                         layer = 10)  # passed to output_fun
str(b90.aggswat$output_fun$swat)
</code></pre>

<hr>
<h2 id='run_multi_LWFB90'>Make a multirun simulation using a set of variable input parameters.</h2><span id='topic+run_multi_LWFB90'></span>

<h3>Description</h3>

<p>Wrapper function for <code><a href="#topic+run_LWFB90">run_LWFB90</a></code> to make multiple simulations
parallel, with varying input parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_multi_LWFB90(
  paramvar,
  param_b90,
  paramvar_nms = names(paramvar),
  cores = 2,
  show_progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_multi_LWFB90_+3A_paramvar">paramvar</code></td>
<td>
<p>Data.frame of variable input parameters. For each row, a
simulation is performed, with the elements in <code>param_b90</code> being
replaced by the respective column of <code>paramvar</code>. All parameter names
(column names) in <code>paramvar</code> must be found in <code>param_b90</code>. See
section <code>Parameter updating</code>.</p>
</td></tr>
<tr><td><code id="run_multi_LWFB90_+3A_param_b90">param_b90</code></td>
<td>
<p>Named list of parameters, in which the parameters defined in
<code>paramvar</code> will be replaced.</p>
</td></tr>
<tr><td><code id="run_multi_LWFB90_+3A_paramvar_nms">paramvar_nms</code></td>
<td>
<p>Names of the parameters in <code>paramvar</code> to be replaced
in <code>param_b90</code>.</p>
</td></tr>
<tr><td><code id="run_multi_LWFB90_+3A_cores">cores</code></td>
<td>
<p>Number of CPUs to use for parallel processing. Default is 2.</p>
</td></tr>
<tr><td><code id="run_multi_LWFB90_+3A_show_progress">show_progress</code></td>
<td>
<p>Logical: Show progress bar? Default is TRUE. See also
section <code>Progress bar</code> below.</p>
</td></tr>
<tr><td><code id="run_multi_LWFB90_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+run_LWFB90">run_LWFB90</a></code>: provide
at least the arguments that have no defaults such as <code>options_b90</code> and
<code>climate</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list with the results of the single runs as returned by
<code><a href="#topic+run_LWFB90">run_LWFB90</a></code>. Simulation or processing errors are passed on.
</p>


<h3>Parameter updating</h3>

<p>The transfer of values from a row in <code>paramvar</code> to <code>param_b90</code>
before each single run simulation is done by matching names from
<code>paramvar</code> and <code>param_b90</code>. In order to address data.frame or
vector elements in <code>param_b90</code> by a column name in <code>paramvar</code>, the
respective column name has to be set up from its name and index in
<code>param_b90</code>. To replace, e.g., the 2nd value of <code>ths</code> in the
<code>soil_materials</code> data.frame, the respective column name in
<code>paramvar</code> has to be called 'soil_materials.ths2'. In order to replace
the 3rd value of <code>maxlai</code> vector in <code>param_b90</code>, the column has to
be named 'maxlai3'.
</p>


<h3>Data management</h3>

<p>The returned list of single run results can become very large, if many
simulations are performed and the selected output contains daily resolution
data sets, especially daily layer-wise soil moisture data. To not overload
memory, it is advised to reduce the returned simulation results to a minimum,
by carefully selecting the output, and make use of the option to pass a list
of functions to <code><a href="#topic+run_LWFB90">run_LWFB90</a></code> via argument <code>output_fun</code>.
These functions perform directly on the output of a single run simulation,
and can be used for aggregating model output on-the-fly, or for writing
results to a file or database. The regular output of
<code><a href="#topic+run_LWFB90">run_LWFB90</a></code> can be suppressed by setting <code>rtrn.output =
FALSE</code>, for exclusively returning the output of such functions.
</p>


<h3>Progress bar</h3>

<p>This function provides a progress bar via the package <a href="https://CRAN.R-project.org/package=progressr"><span class="pkg">progressr</span></a> if
<code>show_progress=TRUE</code>. The parallel computation is then wrapped with
<code>progressr::with_progress()</code> to enable progress reporting from
distributed calculations. The appearance of the progress bar (including
audible notification) can be customized by the user for the entire session
using <code>progressr::handlers()</code> (see <code>vignette('progressr-intro')</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("slb1_meteo")
data("slb1_soil")

# Set up lists containing model control options and model parameters:
parms &lt;- set_paramLWFB90()
# choose the 'Coupmodel' shape option for the annual lai dynamic,
# with fixed budburst and leaf fall dates:
opts &lt;- set_optionsLWFB90(startdate = as.Date("2003-06-01"),
                                 enddate = as.Date("2003-06-30"),
                                 lai_method = 'Coupmodel',
                                 budburst_method = 'fixed',
                                 leaffall_method = 'fixed')

# Derive soil hydraulic properties from soil physical properties using pedotransfer functions
soil &lt;- cbind(slb1_soil, hydpar_wessolek_tab(slb1_soil$texture))

#set up data.frame with variable parameters
n &lt;- 10
set.seed(2021)
vary_parms &lt;- data.frame(shp_optdoy = runif(n,180,240),
                         shp_budburst = runif(n, 0.1,1),
                         winlaifrac = runif(n, 0,0.5),
                         budburstdoy = runif(n,100,150),
                         soil_materials.ths3 = runif(n, 0.3,0.5), # ths of material 3
                         maxlai = runif(n,2,7))

# add the soil as soil_nodes and soil materials to param_b90, so ths3 can be looked up
parms[c("soil_nodes", "soil_materials")] &lt;- soil_to_param(soil)

# Make a Multirun-Simulation
b90.multi &lt;- run_multi_LWFB90(paramvar = vary_parms,
                        param_b90 = parms,
                        options_b90 = opts,
                        climate = slb1_meteo)
names(b90.multi)

# extract results
evapday &lt;- data.table::rbindlist(
  lapply(b90.multi, FUN = function(x) { x$output[,c("yr", "doy", "evap")] }),
  idcol = "srun")

evapday$dates &lt;- as.Date(paste(evapday$yr, evapday$doy),"%Y %j")

srun_nms &lt;- unique(evapday$srun)

with(evapday[evapday$srun == srun_nms[1], ],
     plot(dates, cumsum(evap), type = "n",
          ylim = c(0,100))
)
for (i in 1:length(b90.multi)){
  with(evapday[evapday$srun == srun_nms[i], ],
       lines(dates, cumsum(evap)))
}


</code></pre>

<hr>
<h2 id='run_multisite_LWFB90'>Make a multi-site simulation using lists of climate, soil, and
parameter input objects.</h2><span id='topic+run_multisite_LWFB90'></span>

<h3>Description</h3>

<p>Wrapper function for <code><a href="#topic+run_LWFB90">run_LWFB90</a></code> to make multiple parallel
simulations of one or several parameter sets, for a series of sites with
individual climate and soil, or individual parameter sets for each
climate/soil combinations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_multisite_LWFB90(
  options_b90,
  param_b90,
  soil = NULL,
  climate,
  climate_args = NULL,
  all_combinations = FALSE,
  cores = 2,
  show_progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_multisite_LWFB90_+3A_options_b90">options_b90</code></td>
<td>
<p>Named list of model control options to be used in all
simulations</p>
</td></tr>
<tr><td><code id="run_multisite_LWFB90_+3A_param_b90">param_b90</code></td>
<td>
<p>Named list of parameters to be used in all simulations, or a
list of multiple parameter sets.</p>
</td></tr>
<tr><td><code id="run_multisite_LWFB90_+3A_soil">soil</code></td>
<td>
<p>Data.frame with soil properties to be used in all simulations, or
a list of data.frames with different soil profiles.</p>
</td></tr>
<tr><td><code id="run_multisite_LWFB90_+3A_climate">climate</code></td>
<td>
<p>Data.frame with climate data, or a list of climate
data.frames. Alternatively, a function can be supplied that returns a
data.frame. Arguments to the function can be passed via
<code>climate_args</code>.</p>
</td></tr>
<tr><td><code id="run_multisite_LWFB90_+3A_climate_args">climate_args</code></td>
<td>
<p>List of named lists of arguments passed to
<code>climate</code>, if this is a function.</p>
</td></tr>
<tr><td><code id="run_multisite_LWFB90_+3A_all_combinations">all_combinations</code></td>
<td>
<p>Logical: Set up and run all possible combinations of
individual <code>param_b90</code>, <code>climate</code> and <code>soil</code> objects?
Default is <code>FALSE</code>, running one object or the list of <code>param_b90</code>
objects for a series of climate/soil combinations.</p>
</td></tr>
<tr><td><code id="run_multisite_LWFB90_+3A_cores">cores</code></td>
<td>
<p>Number of cores to use for parallel processing.</p>
</td></tr>
<tr><td><code id="run_multisite_LWFB90_+3A_show_progress">show_progress</code></td>
<td>
<p>Logical: Show progress bar? Default is <code>TRUE</code>. See
also section <code>Progress bar</code> below.</p>
</td></tr>
<tr><td><code id="run_multisite_LWFB90_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="#topic+run_LWFB90">run_LWFB90</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list with the results of the single runs as returned by
<code><a href="#topic+run_LWFB90">run_LWFB90</a></code>. Simulation or processing errors are passed on. The
names of the returned list entries are concatenated from the names of the
input list entries in the following form: &lt;climate&gt; &lt;soil&gt; &lt;param_b90&gt;. If
<code>climate</code> is a function, the names for &lt;climate&gt; are taken from the
names of <code>climate_args</code>.
</p>


<h3>Data management</h3>

<p>The returned list of single run results can become very large, if many
simulations are performed and the selected output contains daily resolution
data sets, especially daily layer-wise soil moisture data. To not overload
memory, it is advised to reduce the returned simulation results to a minimum,
by carefully selecting the output, and make use of the option to pass a list
of functions to <code><a href="#topic+run_LWFB90">run_LWFB90</a></code> via argument <code>output_fun</code>.
These functions perform directly on the output of a single run simulation,
and can be used for aggregating model output on-the-fly, or for writing
results to a file or database. The regular output of
<code><a href="#topic+run_LWFB90">run_LWFB90</a></code> can be suppressed by setting <code>rtrn.output =
FALSE</code>, for exclusively returning the output of such functions.
To provide full flexibility, the names of the current <code>soil</code>,
<code>param_b90</code>, and <code>climate</code> are automatically passed as additional
arguments (<code>soil_nm</code>, <code>param_nm</code>,<code>clim_nm</code>) to
<code><a href="#topic+run_LWFB90">run_LWFB90</a></code> and in this way become available to functions passed
via <code>output_fun</code>. In order to not overload the memory with climate input
data, it is advised to provide a function instead of a list of <code>climate</code>
data.frames, and specify its arguments for individual sites in
<code>climate_args</code>, in case many sites with individual climates will be
simulated.
</p>


<h3>Progress bar</h3>

<p>This function provides a progress bar via the package <a href="https://CRAN.R-project.org/package=progressr"><span class="pkg">progressr</span></a> if
<code>show_progress=TRUE</code>. The parallel computation is then wrapped with
<code>progressr::with_progress()</code> to enable progress reporting from
distributed calculations. The appearance of the progress bar (including
audible notification) can be customized by the user for the entire session
using <code>progressr::handlers()</code> (see <code>vignette('progressr-intro')</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("slb1_meteo")
data("slb1_soil")

opts &lt;- set_optionsLWFB90(budburst_method = "Menzel", enddate = as.Date("2002-12-31"))

# define parameter sets
param_l &lt;- list(spruce = set_paramLWFB90(maxlai = 5,
                                         budburst_species = "Picea abies (frueh)",
                                         winlaifrac = 0.8),
                beech = set_paramLWFB90(maxlai = 6,
                                        budburst_species = "Fagus sylvatica",
                                        winlaifrac = 0))

soil &lt;- cbind(slb1_soil, hydpar_wessolek_tab(slb1_soil$texture))

# define list of soil objects
soils &lt;- list(soil1 = soil, soil2 = soil)

# define list of climate objects
climates &lt;- list(clim1 = slb1_meteo, clim2 = slb1_meteo)

# run two parameter sets on a series of climate and soil-objects
res &lt;- run_multisite_LWFB90(param_b90 = param_l,
                      options_b90 = opts,
                      soil = soils,
                      climate = climates)
names(res)

# set up and run individual parameter sets for individual locations

# set up location parameters
loc_parm &lt;- data.frame(loc_id = names(climates),
                       coords_y = c(48.0, 54.0),
                       eslope = c(30,0),
                       aspect = c(180,0))

# create input list of multiple param_b90 list objects
param_l &lt;- lapply(names(climates), function(x, loc_parms) {
  parms &lt;- set_paramLWFB90()
  parms[match(names(loc_parm),names(parms), nomatch = 0)] &lt;-
    loc_parm[loc_parm$loc_id == x, which(names(loc_parm) %in% names(parms))]
  parms
}, loc_parm = loc_parm)

names(param_l) &lt;- c("locpar1", "locpar2")

res &lt;- run_multisite_LWFB90(param_b90 = param_l,
                      options_b90 = opts,
                      soil = soils,
                      climate = climates)
names(res)

</code></pre>

<hr>
<h2 id='set_optionsLWFB90'>Create a list of model control options</h2><span id='topic+set_optionsLWFB90'></span>

<h3>Description</h3>

<p>Create a list of model control options
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_optionsLWFB90(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_optionsLWFB90_+3A_...">...</code></td>
<td>
<p>Named values to be included in return value.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>startdate</dt><dd><p>start date of the simulation.</p>
</dd>
<dt>enddate</dt><dd><p>end date of the simulation.</p>
</dd>
<dt>fornetrad</dt><dd><p>use global solar radiation (<code>='globrad'</code>) or sunshine
duration hours (<code>='sunhours'</code>) for net radiation calculation?</p>
</dd>
<dt>prec_interval</dt><dd><p>number of precipitation intervals per day (default is
1). If <code>prec_interval &gt; 1</code>, the <code>precip</code>-argument has to be
provided to <code><a href="#topic+run_LWFB90">run_LWFB90</a></code></p>
</dd>
<dt>correct_prec</dt><dd><p>correct precipitation data for wind and evaporation losses
using <code><a href="#topic+correct_prec">correct_prec</a></code>?</p>
</dd> <dt>budburst_method</dt><dd><p>name of method for
budburst calculation. If <code>'constant'</code> or <code>'fixed'</code>, budburst day
of year from parameters is used. All other methods calculate budburst day
of year dynamically from airtemperatures, and the method name is passed to
the <code>start.method</code>-argument of  <code><a href="vegperiod.html#topic+vegperiod">vegperiod</a></code>.</p>
</dd>
<dt>leaffall_method</dt><dd><p>name of method for leaffall calculation. If
<code>'constant'</code> or <code>'fixed'</code>, beginning of leaffall (day of year)
from parameters is used. All other methods calculate budburst day of year
dynamically from temperatures, and the method name is passed to the
<code>end.method</code>-argument of <code><a href="vegperiod.html#topic+vegperiod">vegperiod</a></code>.</p>
</dd>
<dt>standprop_input</dt><dd><p>name of input for longterm (interannual) plant
development. <code>standprop_input = 'parameters'</code>: yearly values of stand
properties height, sai, densef, lai are taken from individual parameters,
<code>standprop_input = 'table'</code>:  values from <code>standprop_table</code>
provided in parameters are used.</p>
</dd> <dt>standprop_interp</dt><dd><p>interpolation
method for aboveground stand properties. <code>'linear'</code> or
<code>'constant'</code>, see <code>approx.method</code>-argument of
<code><a href="#topic+approx_standprop">approx_standprop</a></code>.</p>
</dd> <dt>use_growthperiod</dt><dd><p>Should
yearly changes of stand properties (growth) only take place during the
growth period? If <code>TRUE</code>, linear interpolation of height, sai, densef
and age are made from budburst until leaffall. During winter values are
constant. Beginning and end of the growth period are taken from parameters
<code>budburstdoy</code> and <code>leaffalldoy</code>. See <code>use_growthperiod</code>-argument of
<code><a href="#topic+approx_standprop">approx_standprop</a></code>.</p>
</dd> <dt>lai_method</dt><dd><p>name of method for
constructing seasonal course leaf area index development from parameters.
Passed to <code>method</code>-argument of <code><a href="#topic+make_seasLAI">make_seasLAI</a></code>. </p>
</dd>
<dt>imodel</dt><dd><p>name of retention &amp; conductivity model: &quot;CH&quot; for
Clapp/Hornberger, &quot;MvG&quot; for Mualem/van Genuchten</p>
</dd> <dt>root_method</dt><dd><p>method
name of the root length density depth distribution function. Any of the
names accepted by <code><a href="#topic+make_rootden">make_rootden</a></code> are allowed. Additionally,
<code>'soilvar'</code> can be used if the root length density depth distribution
is specified in column 'rootden' in the <code>soil</code>-data.frame</p>
</dd>
</dl>



<h3>Value</h3>

<p>A list of model control options for use as
<code>options_b90</code>-argument in <code><a href="#topic+run_LWFB90">run_LWFB90</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Default options
options_b90 &lt;- set_optionsLWFB90()
# Include specific options
options_b90_dynamic_phenology &lt;- set_optionsLWFB90(budburst_method = 'Menzel',
leaffall_method ='vonWilpert')
</code></pre>

<hr>
<h2 id='set_outputLWFB90'>Select output for LWF-Brook90</h2><span id='topic+set_outputLWFB90'></span>

<h3>Description</h3>

<p>Returns a <code>[7,5]</code> matrix with a default selection of LWF-Brook90 output
data sets for the use as 'output'-argument <code><a href="#topic+run_LWFB90">run_LWFB90</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_outputLWFB90(output = NULL, edit = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_outputLWFB90_+3A_output">output</code></td>
<td>
<p>optional <code>[7,5]</code>-matrix, which is opened on R's
data-editor if <code>edit = TRUE</code>. If no matrix is passed, a default
selection of output values is returned opened in R's data-editor.</p>
</td></tr>
<tr><td><code id="set_outputLWFB90_+3A_edit">edit</code></td>
<td>
<p>open R's data-editor ?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>[7,5]</code>-matrix containing <code>0</code> and <code>1</code> for use as
<code>output</code>-argument in <code><a href="#topic+run_LWFB90">run_LWFB90</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create matrix with default selection
output &lt;- set_outputLWFB90()
output

# modify
output[,] &lt;- 0L
output[,3] &lt;- 1L
output["Evap", c("Ann","Mon")] &lt;- 1L
output
</code></pre>

<hr>
<h2 id='set_paramLWFB90'>Create the list of model parameters</h2><span id='topic+set_paramLWFB90'></span>

<h3>Description</h3>

<p>Create the list of model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_paramLWFB90(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_paramLWFB90_+3A_...">...</code></td>
<td>
<p>Named arguments to be included in return value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with model parameters for use as <code>param_b90</code>-argument in
<code><a href="#topic+run_LWFB90">run_LWFB90</a></code>.
</p>


<h3>List of input parameters</h3>


<table>
<tr>
 <td style="text-align: left;">
 <strong>Name</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td><td style="text-align: center;"> <strong>Unit</strong> </td><td style="text-align: left;"> <strong>Group</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
 czr          </td><td style="text-align: left;"> Ratio of roughness length to mean height for smooth closed canopies for heights greater than HR when LAI&gt;LPC. Default: 0.05 </td><td style="text-align: center;"> -                 </td><td style="text-align: left;"> Canopy                 </td>
</tr>
<tr>
 <td style="text-align: left;">
 czs          </td><td style="text-align: left;"> Ratio of roughness length to mean height for smooth closed canopies for heights less than HS when LAI&gt;LPC. Default: 0.13 </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Canopy                 </td>
</tr>
<tr>
 <td style="text-align: left;">
 hr           </td><td style="text-align: left;"> Smallest height to which CZR applies. Default: 10 </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Canopy                 </td>
</tr>
<tr>
 <td style="text-align: left;">
 hs           </td><td style="text-align: left;"> Largest height to which CZS applies. Default: 1</td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Canopy                 </td>
</tr>
<tr>
 <td style="text-align: left;">
 lpc          </td><td style="text-align: left;"> Minimum leaf area index defining a closed canopy. Default: 4</td><td style="text-align: center;"> -                 </td><td style="text-align: left;"> Canopy                 </td>
</tr>
<tr>
 <td style="text-align: left;">
 lwidth       </td><td style="text-align: left;"> Average leaf width. Default: 0.1</td><td style="text-align: center;"> m  </td><td style="text-align: left;"> Canopy                 </td>
</tr>
<tr>
 <td style="text-align: left;">
 nn           </td><td style="text-align: left;"> Eddy diffusivity extinction coefficient within canopy. Default: 2.5</td><td style="text-align: center;"> -                 </td><td style="text-align: left;"> Canopy                 </td>
</tr>
<tr>
 <td style="text-align: left;">
 rhotp        </td><td style="text-align: left;"> Ratio of total leaf area to projected area. Default: 2</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Canopy                 </td>
</tr>
<tr>
 <td style="text-align: left;">
 zminh        </td><td style="text-align: left;"> Reference height for weather data above the canopy top height. Default: 2</td><td style="text-align: center;"> m </td><td style="text-align: left;"> Canopy                 </td>
</tr>
<tr>
 <td style="text-align: left;">
 dslope       </td><td style="text-align: left;"> Slope for downslope-flow. Default: 0 </td><td style="text-align: center;"> deg               </td><td style="text-align: left;"> Flow </td>
</tr>
<tr>
 <td style="text-align: left;">
 bypar        </td><td style="text-align: left;"> Switch to allow (1) or prevent (0) bypass flow in deeper layers. Default: 0 </td><td style="text-align: center;"> -</td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 drain        </td><td style="text-align: left;"> Switch for lower boundary condition to be free drainage (1) or no flow (0). Default: 1  </td><td style="text-align: center;"> -</td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 slopelen     </td><td style="text-align: left;"> Slope length for downslope-flow. Default: 200   </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 gsc          </td><td style="text-align: left;"> Rate constant for ground water discharge (remember that a first order groundwater reservoir is placed below the soil profile), for value 0 there is no discharge. Default: 0  </td><td style="text-align: center;"> d-1               </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 gsp          </td><td style="text-align: left;"> Seepage fraction of groundwater discharge. Default: </td><td style="text-align: center;"> -  </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 ilayer       </td><td style="text-align: left;"> Number of layers from top to which infiltration is distributed. Default: 0</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 imperv       </td><td style="text-align: left;"> Fraction of area which has an impermeable surface (like roads). Default: 0 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 infexp       </td><td style="text-align: left;"> Shape parameter for distribution of infiltration in first ILayer, for value 0 infiltration is in top layer only. Default: 0 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 qffc         </td><td style="text-align: left;"> Quickflow fraction of infiltrating water at field capacity, for value 0 there is no quickflow (bypass or surface) unless soil profile surface becomes saturated. Default: 0  </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 qfpar        </td><td style="text-align: left;"> Quickflow shape parameter. Default: 1 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 qlayer       </td><td style="text-align: left;"> Number of layers which are considered for generation of surface or source area flow. Default: 0</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 water_table_depth </td><td style="text-align: left;"> Depth of the water table for a constant head boundary. -9999 means gravitational flow boundary. Default: -9999</td><td style="text-align: center;"> m                  </td><td style="text-align: left;"> Flow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 gwatini      </td><td style="text-align: left;"> Initial value of groundwater storage. Default: 0</td><td style="text-align: center;"> mm                  </td><td style="text-align: left;"> Initial                </td>
</tr>
<tr>
 <td style="text-align: left;">
 snowini      </td><td style="text-align: left;"> Initial value of water content of snow pack. Default: 0</td><td style="text-align: center;"> mm </td><td style="text-align: left;"> Initial                </td>
</tr>
<tr>
 <td style="text-align: left;">
 snowlqini    </td><td style="text-align: left;"> Initial value of liquid water content of snow pack. Default: 0</td><td style="text-align: center;"> mm </td><td style="text-align: left;"> Initial                </td>
</tr>
<tr>
 <td style="text-align: left;">
 snowccini    </td><td style="text-align: left;"> Initial value of cold content of snow pack (positive). Default: 0</td><td style="text-align: center;">  MJ m-2 </td><td style="text-align: left;"> Initial                </td>
</tr>
<tr>
 <td style="text-align: left;">
 intrainini   </td><td style="text-align: left;"> Initial value of intercepted rain. Default: 0</td><td style="text-align: center;"> mm                  </td><td style="text-align: left;"> Initial                </td>
</tr>
<tr>
 <td style="text-align: left;">
 intsnowini   </td><td style="text-align: left;"> Initial value of intercepted snow. Default: 0</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Initial                </td>
</tr>
<tr>
 <td style="text-align: left;">
 psiini       </td><td style="text-align: left;"> Initial pressure head of soil layers. May have the same length as row.names(soil). Default: -6.3 </td><td style="text-align: center;"> kPa                </td><td style="text-align: left;"> Initial  </td>
</tr>
<tr>
 <td style="text-align: left;">
 cintrl       </td><td style="text-align: left;"> Maximum interception storage of rain per unit LAI. Default: 0.15 </td><td style="text-align: center;"> mm                </td><td style="text-align: left;"> Interception           </td>
</tr>
<tr>
 <td style="text-align: left;">
 cintrs       </td><td style="text-align: left;"> Maximum interception storage of rain per unit SAI. Default: 0.15</td><td style="text-align: center;"> mm                </td><td style="text-align: left;"> Interception           </td>
</tr>
<tr>
 <td style="text-align: left;">
 cintsl       </td><td style="text-align: left;"> Maximum interception storage of snow per unit LAI. Default: 0.6 </td><td style="text-align: center;"> mm                </td><td style="text-align: left;"> Interception           </td>
</tr>
<tr>
 <td style="text-align: left;">
 cintss       </td><td style="text-align: left;"> Maximum interception storage of snow per unit SAI. Default: 0.6 </td><td style="text-align: center;"> mm                </td><td style="text-align: left;"> Interception           </td>
</tr>
<tr>
 <td style="text-align: left;">
 frintlai     </td><td style="text-align: left;"> Intercepted fraction of rain per unit LAI. Default: 0.06 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Interception           </td>
</tr>
<tr>
 <td style="text-align: left;">
 frintsai     </td><td style="text-align: left;"> Intercepted fraction of rain per unit SAI. Default: 0.06</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Interception           </td>
</tr>
<tr>
 <td style="text-align: left;">
 fsintlai     </td><td style="text-align: left;"> Intercepted fraction of snow per unit LAI. Default: 0.04 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Interception           </td>
</tr>
<tr>
 <td style="text-align: left;">
 fsintsai     </td><td style="text-align: left;"> Intercepted fraction of snow per unit SAI. Default: 0.04 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Interception           </td>
</tr>
<tr>
 <td style="text-align: left;">
 pdur         </td><td style="text-align: left;"> Average duration of precipitation events for each month of the year. Default: rep(4,12) </td><td style="text-align: center;"> hours                  </td><td style="text-align: left;"> Interception           </td>
</tr>
<tr>
 <td style="text-align: left;">
 alb          </td><td style="text-align: left;"> Albedo of soil/vegetation surface without snow. Default: 0.2 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 albsn        </td><td style="text-align: left;"> Albedo of soil/vegetation surface with snow. Default: 0.5 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 c1           </td><td style="text-align: left;"> Intercept of relation of solar radiation to sunshine duration. Default:  0.25</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 c2           </td><td style="text-align: left;"> Intercept of relation of solar radiation to sunshine duration. Default: 0.5                                                                                                    </td><td style="text-align: center;"> -                 </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 c3           </td><td style="text-align: left;"> Constant between 0 and 1 that determines the cloud correction to net longwave radiation from sunshine duration. Default: 0.2</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 fetch        </td><td style="text-align: left;"> Fetch upwind of the weather station at which wind speed was measured. Default: 5000 </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 ksnvp        </td><td style="text-align: left;"> Correction factor for snow evaporation. Default: 0.3 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 wndrat       </td><td style="text-align: left;"> Average ratio of nighttime to daytime wind speed. Default: 0.3</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 z0s          </td><td style="text-align: left;"> Surface roughness of snow cover. Default: 0.001 </td><td style="text-align: center;"> m                </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 z0w          </td><td style="text-align: left;"> Roughness length at the weather station at which wind speed was measured. Default: 0.005 (Grass) </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 coords_x     </td><td style="text-align: left;"> Longitude value (decimal degrees) of the simulation location (has no effect on simulation results). Default: 9.91 </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 coords_y     </td><td style="text-align: left;"> Latitude value (decimal degrees) of the simulation location. Default: 51.54 </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 zw           </td><td style="text-align: left;"> Height at which wind speed was measured. Default: 2 </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 eslope       </td><td style="text-align: left;"> Slope for evapotranspiration and snowmelt calculation. Default:  0</td><td style="text-align: center;"> deg               </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 aspect       </td><td style="text-align: left;"> Mean exposition of soil surface at soil profile (north: 0, east: 90, south: 180, west: 270). Default: 0</td><td style="text-align: center;"> deg               </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 obsheight    </td><td style="text-align: left;"> Mean height of obstacles on soil surface (grass, furrows etc.), used to calculate soil surface roughness. Default: 0.025 </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 prec_corr_statexp </td><td style="text-align: left;"> Station exposure situation of prec measurements (passed to <code><a href="#topic+correct_prec">correct_prec</a></code> Default: 'mg' </td><td style="text-align: center;">                  </td><td style="text-align: left;"> Meteo                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 dpsimax      </td><td style="text-align: left;"> Maximum potential difference considered equal. Default: 5e-04 </td><td style="text-align: center;"> kPa               </td><td style="text-align: left;"> Numerical              </td>
</tr>
<tr>
 <td style="text-align: left;">
 dswmax       </td><td style="text-align: left;"> Maximum change allowed in SWATI. Default: 0.05 </td><td style="text-align: center;"> percent of SWATMX </td><td style="text-align: left;"> Numerical              </td>
</tr>
<tr>
 <td style="text-align: left;">
 dtimax       </td><td style="text-align: left;"> Maximum iteration time step. Default: 0.5 </td><td style="text-align: center;"> d                 </td><td style="text-align: left;"> Numerical              </td>
</tr>
<tr>
 <td style="text-align: left;">
 budburst_species </td><td style="text-align: left;"> Name of tree species for estimating budburst doy using Menzel-model (passed to <code><a href="vegperiod.html#topic+vegperiod">vegperiod</a></code>) Default: 'Fagus sylvatica' </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 budburstdoy  </td><td style="text-align: left;"> Budburst day of year - passed to <code><a href="#topic+make_seasLAI">make_seasLAI</a></code>. Default: 121</td><td style="text-align: center;"> doy                  </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 emergedur    </td><td style="text-align: left;"> Leaf growth duration until maxlai is reached.. Default: 28</td><td style="text-align: center;"> d                 </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 height       </td><td style="text-align: left;"> Plant height. Default: 25 </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 height_ini   </td><td style="text-align: left;"> Initial plant height at the beginning of the simulation. Used when <code>options_b90$standprop_interp = 'linear'</code> (see <code><a href="#topic+approx_standprop">approx_standprop</a></code>). Default: 25 </td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 leaffalldoy  </td><td style="text-align: left;"> Day of year when leaf fall begins - passed to <code><a href="#topic+make_seasLAI">make_seasLAI</a></code> Default: 279</td><td style="text-align: center;"> doy               </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 leaffalldur  </td><td style="text-align: left;"> Number of days until minimum lai is reached - passed to <code><a href="#topic+make_seasLAI">make_seasLAI</a></code> Default: 58 </td><td style="text-align: center;"> d                 </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 sai          </td><td style="text-align: left;"> Steam area index. Default: 1 </td><td style="text-align: center;"> -                 </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 sai_ini      </td><td style="text-align: left;"> Initial stem area index at the beginning of the simulation. Used when <code>options_b90$standprop_interp = 'linear'</code> (see <code><a href="#topic+approx_standprop">approx_standprop</a></code>), Default: 1 </td><td style="text-align: center;"> -                 </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 shp_leaffall  </td><td style="text-align: left;"> Shape parameter for leaf fall phase - passed to <code><a href="#topic+make_seasLAI">make_seasLAI</a></code> Default: 0.3</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 shp_budburst  </td><td style="text-align: left;"> Shape parameter for leaf growth phase - passed to <code><a href="#topic+make_seasLAI">make_seasLAI</a></code> Default: 3</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 shp_optdoy </td><td style="text-align: left;"> Day of year when optimum value is reached - passed to <code><a href="#topic+make_seasLAI">make_seasLAI</a></code> Default: 210 </td><td style="text-align: center;"> doy               </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 lai_doy </td><td style="text-align: left;"> Day of year values for lai-interpolation - passed to <code><a href="#topic+make_seasLAI">make_seasLAI</a></code> </td><td style="text-align: center;"> doy               </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 lai_frac </td><td style="text-align: left;"> Fractional lai values for lai interpolation, corresponding to lai_doy - passed to <code><a href="#topic+make_seasLAI">make_seasLAI</a></code> Default: 210 </td><td style="text-align: center;"> doy               </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 winlaifrac   </td><td style="text-align: left;"> Minimum LAI as a fraction of maxlai. Default: 0 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 standprop_table </td><td style="text-align: left;"> Data.frame with yearly values of vegetation properties with columns 'year','age', 'height', 'maxlai', 'sai', 'densef' </td><td style="text-align: center;">                   </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 cs           </td><td style="text-align: left;"> Ratio of projected stem area index to canopy height. Default: 0.035 </td><td style="text-align: center;"> m-1</td><td style="text-align: left;"> Plant</td>
</tr>
<tr>
 <td style="text-align: left;">
 densef       </td><td style="text-align: left;"> Density factor for MaxLAI, CS, RtLen, RPlant, not &lt;.001, 1 for typical stand. Default: 1</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 densef_ini   </td><td style="text-align: left;"> Initial density factor at the beginning of the simulation. Used when <code>options_b90$standprop_interp = 'linear'</code> (see <code><a href="#topic+approx_standprop">approx_standprop</a></code>). Default: 1 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Plant</td>
</tr>
<tr>
 <td style="text-align: left;">
 maxlai       </td><td style="text-align: left;"> Maximum projected leaf area index - passed to <code><a href="#topic+make_seasLAI">make_seasLAI</a></code> Default: 5 </td><td style="text-align: center;"> - </td><td style="text-align: left;"> Plant                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 radex        </td><td style="text-align: left;"> Extinction coefficient for solar radiation and net radiation in the canopy. Default: 0.5</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Potential Transpiration </td>
</tr>
<tr>
 <td style="text-align: left;">
 cvpd         </td><td style="text-align: left;"> Vapour pressure deficit at which leaf conductance is halved. Default: 2</td><td style="text-align: center;"> kPa               </td><td style="text-align: left;"> Potential Transpiration</td>
</tr>
<tr>
 <td style="text-align: left;">
 glmax        </td><td style="text-align: left;"> Maximum leaf vapour conductance when stomata are fully open. Default: 0.0053 </td><td style="text-align: center;"> m s-1             </td><td style="text-align: left;"> Potential Transpiration</td>
</tr>
<tr>
 <td style="text-align: left;">
 glmin        </td><td style="text-align: left;"> Minimum leaf vapour conductance when stomata are closed. Default: 0.0003</td><td style="text-align: center;"> m s-1             </td><td style="text-align: left;"> Potential Transpiration</td>
</tr>
<tr>
 <td style="text-align: left;">
 r5           </td><td style="text-align: left;"> Solar radiation level at which leaf conductance is half of its value at RM. Default: 100</td><td style="text-align: center;"> W m-2             </td><td style="text-align: left;"> Potential Transpiration</td>
</tr>
<tr>
 <td style="text-align: left;">
 rm           </td><td style="text-align: left;"> Nominal maximum solar shortwave radiation possible on a leaf (to reach glmax). Default: 1000 </td><td style="text-align: center;"> W m-2             </td><td style="text-align: left;"> Potential Transpiration</td>
</tr>
<tr>
 <td style="text-align: left;">
 t1           </td><td style="text-align: left;"> Lower suboptimal temperature threshold for stomata opening - temperature relation. Default: 10</td><td style="text-align: center;"> deg C             </td><td style="text-align: left;"> Potential Transpiration</td>
</tr>
<tr>
 <td style="text-align: left;">
 t2           </td><td style="text-align: left;"> Upper suboptimal temperature threshold for stomata opening - temperature relation. Default: 30 </td><td style="text-align: center;"> deg C             </td><td style="text-align: left;"> Potential Transpiration</td>
</tr>
<tr>
 <td style="text-align: left;">
 th           </td><td style="text-align: left;"> Upper temperature threshold for stomata closure. Default: 40 </td><td style="text-align: center;"> deg C             </td><td style="text-align: left;"> Potential Transpiration</td>
</tr>
<tr>
 <td style="text-align: left;">
 tl           </td><td style="text-align: left;"> Lower temperature threshold for stomata closure. Default: 0</td><td style="text-align: center;"> deg C             </td><td style="text-align: left;"> Potential Transpiration</td>
</tr>
<tr>
 <td style="text-align: left;">
 betaroot     </td><td style="text-align: left;"> Shape parameter for rootlength density depth distribution. Default: 0.97 </td><td style="text-align: center;"> -                 </td><td style="text-align: left;"> Roots                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 maxrootdepth </td><td style="text-align: left;"> Maximum root depth (positive downward) - passed to make_rootden. Default: -1.5 </td><td style="text-align: center;"> m                </td><td style="text-align: left;"> Roots                  </td>
</tr>
<tr>
 <td style="text-align: left;">
 rootden_table </td><td style="text-align: left;"> Data.frame of relative root density depth distribution with columns 'depth' and 'rootden' </td><td style="text-align: center;">                   </td><td style="text-align: left;"> Roots</td>
</tr>
<tr>
 <td style="text-align: left;">
 rstemp       </td><td style="text-align: left;"> Base temperature for snow-rain transition. Default: -0.5 </td><td style="text-align: center;"> deg C              </td><td style="text-align: left;"> Snow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 ccfac        </td><td style="text-align: left;"> Cold content factor. Default: 0.3 </td><td style="text-align: center;"> MJ m-2 d-1 K-1    </td><td style="text-align: left;"> Snow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 grdmlt       </td><td style="text-align: left;"> Rate of groundmelt of snowpack. Default: 0.35 </td><td style="text-align: center;"> mm d-1            </td><td style="text-align: left;"> Snow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 laimlt       </td><td style="text-align: left;"> Parameter for snowmelt dependence on LAI. Default: 0.2 </td><td style="text-align: center;"> -                 </td><td style="text-align: left;"> Snow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 maxlqf       </td><td style="text-align: left;"> Maximum liquid water fraction of Snow. Default: 0.05 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Snow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 melfac       </td><td style="text-align: left;"> Degree day melt factor for open. Default: 1.5</td><td style="text-align: center;"> MJ m-2 d-1 K-1    </td><td style="text-align: left;"> Snow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 saimlt       </td><td style="text-align: left;"> Parameter for snowmelt dependence on SAI. Default: 0.5 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Snow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 snoden       </td><td style="text-align: left;"> Snow density. Default: 0.3 </td><td style="text-align: center;"> mm mm-1           </td><td style="text-align: left;"> Snow                   </td>
</tr>
<tr>
 <td style="text-align: left;">
 rssa         </td><td style="text-align: left;"> Soil evaporation resistance at field capacity. Default: 100 </td><td style="text-align: center;"> s m-1  </td><td style="text-align: left;"> Soilevap               </td>
</tr>
<tr>
 <td style="text-align: left;">
 rssb         </td><td style="text-align: left;"> Exponent in relation of RSS to water potential. Default: 1 </td><td style="text-align: center;"> - </td><td style="text-align: left;"> Soilevap               </td>
</tr>
<tr>
 <td style="text-align: left;">
 soil_nodes   </td><td style="text-align: left;"> Data.frame with soil nodes discretization passed to LWF-Brook90 </td><td style="text-align: center;"> - </td><td style="text-align: left;"> Soil               </td>
</tr>
<tr>
 <td style="text-align: left;">
 soil_materials </td><td style="text-align: left;"> Data.frame with soil materials (hydrualic parameters) passed to LWF-Brook90 </td><td style="text-align: center;"> -  </td><td style="text-align: left;"> Soil               </td>
</tr>
<tr>
 <td style="text-align: left;">
 age_ini      </td><td style="text-align: left;"> Age of stand (for root development). Default: 100 </td><td style="text-align: center;"> a                 </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 initrdep     </td><td style="text-align: left;"> Initial root depth. Default: 0.25</td><td style="text-align: center;"> m                 </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 initrlen     </td><td style="text-align: left;"> Initial water-absorbing root length per unit area. Default: 12</td><td style="text-align: center;"> m/m-2             </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 rgroper      </td><td style="text-align: left;"> Period of net root growth. A value of 0 prevents root growth. Default: 0 </td><td style="text-align: center;"> a                  </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 rgrorate     </td><td style="text-align: left;"> Vertical root growth rate. Default: 0.03 </td><td style="text-align: center;"> m a-1             </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 fxylem       </td><td style="text-align: left;"> Fraction of internal plant resistance to water flow that is in the Xylem. Default: 0.5 </td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 maxrlen      </td><td style="text-align: left;"> Total length of fine roots per unit ground area. Default: 3000 </td><td style="text-align: center;"> m m-2             </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 mxkpl        </td><td style="text-align: left;"> Maximum internal conductivity for water flow through the plants. Default: 8 </td><td style="text-align: center;"> mm d-1 MPa-1      </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 nooutf       </td><td style="text-align: left;"> Switch that prevents outflow from the root to the soil when the soil is dry. Default: 1</td><td style="text-align: center;"> -                  </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 psicr        </td><td style="text-align: left;"> Critical leaf water potential at which stomates close. Default: -2 </td><td style="text-align: center;"> MPa               </td><td style="text-align: left;"> Water supply           </td>
</tr>
<tr>
 <td style="text-align: left;">
 rrad         </td><td style="text-align: left;"> Average radius of the fine or water-absorbing roots. Default: 0.35 </td><td style="text-align: center;"> mm                </td><td style="text-align: left;"> Water supply
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># Default parameter
parms &lt;- set_paramLWFB90()
# Include specific parameters
parms_maxlai &lt;- set_paramLWFB90(maxlai = c(4,6,5), height =20)
</code></pre>

<hr>
<h2 id='slb1_meteo'>Meteorological Data from the Solling Beech and Spruce experimental site</h2><span id='topic+slb1_meteo'></span>

<h3>Description</h3>

<p>A dataset containing daily weather variables for the period 1960-2013
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slb1_meteo
</code></pre>


<h3>Format</h3>

<p>A data.frame with 19724 rows and 9 variables
</p>

<dl>
<dt>dates</dt><dd><p>date</p>
</dd>
<dt>tmin</dt><dd><p>daily minimum temperature, deg C</p>
</dd>
<dt>tmax</dt><dd><p>daily maximum temperature, deg C</p>
</dd>
<dt>tmean</dt><dd><p>daily mean temperature, deg C</p>
</dd>
<dt>prec</dt><dd><p>daily sum of precipitation, mm</p>
</dd>
<dt>relhum</dt><dd><p>relative Humidity, %</p>
</dd>
<dt>globrad</dt><dd><p>daily sum of global radiation, MJ/m²</p>
</dd>
<dt>windspeed</dt><dd><p>daily mean wind speed measured at 10 m above ground, m/s</p>
</dd>
<dt>vappres</dt><dd><p>daily vapour pressure, kPa</p>
</dd>
</dl>


<hr>
<h2 id='slb1_prec2013_hh'>Hourly precipitation data from Solling Beech experimental site 'SLB1' for year 2013</h2><span id='topic+slb1_prec2013_hh'></span>

<h3>Description</h3>

<p>Hourly precipitation data from Solling Beech experimental site 'SLB1' for year 2013
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slb1_prec2013_hh
</code></pre>


<h3>Format</h3>

<p>A data.frame with 8760 rows and 2 variables
</p>

<dl>
<dt>dates</dt><dd><p>date</p>
</dd>
<dt>prec</dt><dd><p>hourly sum of precipitation, mm</p>
</dd>
</dl>


<hr>
<h2 id='slb1_soil'>Soil profile data from the Solling Beech experimental site 'SLB1'</h2><span id='topic+slb1_soil'></span>

<h3>Description</h3>

<p>A dataset containing the soil horizons' physical properties
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slb1_soil
</code></pre>


<h3>Format</h3>

<p>A data.frame with 21 rows and 10 variables
</p>

<dl>
<dt>horizon</dt><dd><p>horizon symbol</p>
</dd>
<dt>upper</dt><dd><p>upper layer boundary, m</p>
</dd>
<dt>lower</dt><dd><p>lower layer boundary, m</p>
</dd>
<dt>texture</dt><dd><p>soil texture according to German soil texture classification system</p>
</dd>
<dt>bd</dt><dd><p>bulk density of the fine earth, g/cm³</p>
</dd>
<dt>gravel</dt><dd><p>fraction of coarse material </p>
</dd>
<dt>sand</dt><dd><p>sand content, mass-% </p>
</dd>
<dt>silt</dt><dd><p>silt content, mass-% </p>
</dd>
<dt>clay</dt><dd><p>clay content, mass-% </p>
</dd>
<dt>c_org</dt><dd><p>organic carbon content, mass-%</p>
</dd>
</dl>


<hr>
<h2 id='slb1_standprop'>Annual stand properties of the Solling Beech experimental site 'SLB1'</h2><span id='topic+slb1_standprop'></span>

<h3>Description</h3>

<p>A dataset containing the forests's stand properties
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slb1_standprop
</code></pre>


<h3>Format</h3>

<p>A data.frame with 49 rows and 7 variables
</p>

<dl>
<dt>year</dt><dd><p>Year of observation</p>
</dd>
<dt>species</dt><dd><p>Tree species</p>
</dd>
<dt>age</dt><dd><p>age of the main stand</p>
</dd>
<dt>height</dt><dd><p>average height of the trees, m</p>
</dd>
<dt>maxlai</dt><dd><p>maximum leaf area index, m²/m²</p>
</dd>
<dt>sai</dt><dd><p>stem area index, m²/m²</p>
</dd>
<dt>densef</dt><dd><p>stand density</p>
</dd>
</dl>


<hr>
<h2 id='soil_to_param'>Split up soil into materials and soil nodes.</h2><span id='topic+soil_to_param'></span>

<h3>Description</h3>

<p>Split up soil into materials and soil nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soil_to_param(soil, imodel = "MvG")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soil_to_param_+3A_soil">soil</code></td>
<td>
<p>Data.frame with soil layer boundaries ('upper', 'lower') and
hydraulic parameters. When imodel = 'MvG', columns of soil have to be named 'ths', 'thr',
'alpha', 'npar', 'ksat', 'tort', 'gravel'. When imodel = 'CH', columns have to be named
thsat , 'thetaf','psif', 'bexp','kf', 'wetinf', 'gravel'.</p>
</td></tr>
<tr><td><code id="soil_to_param_+3A_imodel">imodel</code></td>
<td>
<p>Name of the hydraulic model ('MvG' or 'CH')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with data.frames 'soil_nodes' and 'soil_materials'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(slb1_soil)
soil &lt;- slb1_soil
soil &lt;- cbind(soil, hydpar_wessolek_tab(soil$texture))
str(soil)

soil_layers_materials &lt;- soil_to_param(soil)
soil_layers_materials
</code></pre>

<hr>
<h2 id='standprop_yearly_to_param'>Transfer standproperties height, maxlai, sai, densef, age to parameter list obeject</h2><span id='topic+standprop_yearly_to_param'></span>

<h3>Description</h3>

<p>Takes a data.frame of yearly stand properties, trims/extends the columns height, maxlai,
sai, densef, and age for the years in <code>out_yrs</code>, and updates the provided parameter list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standprop_yearly_to_param(standprop_yearly, param_b90, out_yrs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="standprop_yearly_to_param_+3A_standprop_yearly">standprop_yearly</code></td>
<td>
<p>A data.frame or data.table with columns 'year', 'height', 'maxlai', 'sai', 'densef', 'age'.</p>
</td></tr>
<tr><td><code id="standprop_yearly_to_param_+3A_param_b90">param_b90</code></td>
<td>
<p>A list object to update.</p>
</td></tr>
<tr><td><code id="standprop_yearly_to_param_+3A_out_yrs">out_yrs</code></td>
<td>
<p>Vector of years for which parameters should be updated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The param_b90 list-object with updated items maxlai, height, height_ini,
sai, sai_ini, densef, densef_ini, age, age_ini.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param_b90 &lt;- set_paramLWFB90()
dat &lt;- slb1_standprop

years &lt;- 2002:2005
param.new &lt;- standprop_yearly_to_param(dat,
                                       param_b90,
                                       years)

identical(param.new$maxlai, dat$maxlai[dat$year %in% years])
identical(param.new$height, dat$height[dat$year %in% years])
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
