<!DOCTYPE html><html><head><title>Help for package kyotil</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {kyotil}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#age_calc'>
<p>Age Calculation</p></a></li>
<li><a href='#auc'><p>AUC</p></a></li>
<li><a href='#base.functions'>
<p>Some Base Functions</p></a></li>
<li><a href='#binaryloess'>
<p>Using loess to Check Functional Form for Logistic Regression</p></a></li>
<li><a href='#cox.zph.2'>
<p>Test the Proportional Hazards Assumption of a Cox Regression (a slightly modified version)</p></a></li>
<li><a href='#crossvalidation'>
<p>Cross Validation Functions</p></a></li>
<li><a href='#Deming'>
<p>Fit Deming regression.</p></a></li>
<li><a href='#DMHeatMap'>
<p>Better Heatmap Function</p></a></li>
<li><a href='#get_count_from_xy_coor'>
<p>Imaging analysis for spatial region</p></a></li>
<li><a href='#get.sim.res'>
<p>Read simulation results</p></a></li>
<li><a href='#getK'><p>getK</p></a></li>
<li><a href='#iorw'>
<p>Causal Mediation Analysis of Cowling et al.</p></a></li>
<li><a href='#kid'>
<p>Dataset from Cowling et al.</p></a></li>
<li><a href='#kyotil'><p>kyotil</p></a></li>
<li><a href='#make.timedep.dataset'>
<p>Create Dataset for Time-dependent Covariate Proportional Hazard Model Analaysi</p></a></li>
<li><a href='#math.functions'>
<p>Math Functions</p></a></li>
<li><a href='#matrix.array.functions'>
<p>Matrix and Array Functions</p></a></li>
<li><a href='#matrix2'>
<p>Matrix Functions that May Be Faster than</p></a></li>
<li><a href='#misc'>
<p>Misc Functions</p></a></li>
<li><a href='#p.adj.perm'>
<p>Permutation-based Multitesting P Values Adjustment</p></a></li>
<li><a href='#plotting'>
<p>Plotting Functions</p></a></li>
<li><a href='#print.functions'>
<p>Print Functions</p></a></li>
<li><a href='#random.functions'>
<p>Random Functions</p></a></li>
<li><a href='#regression.model.functions'>
<p>Regression Model Functions</p></a></li>
<li><a href='#roc'><p>ROC and AUC</p></a></li>
<li><a href='#sim.dat.tvarying.two'>
<p>Simulation Functions for Time-dependent Proportional Hazard Model</p></a></li>
<li><a href='#stat.functions'>
<p>Stat Functions</p></a></li>
<li><a href='#string.functions'><p>String Functions</p></a></li>
<li><a href='#testing.functions'>
<p>Testing Functions</p></a></li>
<li><a href='#VEplot'>
<p>Vaccine Efficacy Plots</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Version:</td>
<td>2024.5-8</td>
</tr>
<tr>
<td>Title:</td>
<td>Utility Functions for Statistical Analysis Report Generation and
Monte Carlo Studies</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RUnit, R.rsp, lme4, nlme, xtable, MASS, splines, survival,
abind, pracma, VGAM, copula, mvtnorm, Hmisc, RColorBrewer, zoo,
doParallel, Exact, survey, magick</td>
</tr>
<tr>
<td>Description:</td>
<td>Helper functions for creating formatted summary of regression models, writing publication-ready tables to latex files, and running Monte Carlo experiments.</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-06 17:42:20 UTC; Youyi</td>
</tr>
<tr>
<td>Author:</td>
<td>Youyi Fong [cre],
  Krisztian Sebestyen [aut],
  Han Sunwoo [aut],
  Jason Becker [ctb],
  Bendix Carstensen [ctb],
  Daryl Morris [ctb],
  Josh Pasek [ctb],
  Dennis Chao [ctb],
  Andri Signorell [ctb],
  Sue Li [ctb],
  Jonathan Bartlett [ctb],
  Christophe Dutang [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Youyi Fong &lt;youyifong@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-06 19:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='age_calc'>
Age Calculation
</h2><span id='topic+age_calc'></span>

<h3>Description</h3>

<p>Calculate age, by Jason P Becker, modified very slightly in how arguments are passed to the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_calc(dob, enddate = Sys.Date(), units = c("days","months","years"), precise = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_calc_+3A_dob">dob</code></td>
<td>

<p>POSIXlt or Date. Birthday 
</p>
</td></tr>
<tr><td><code id="age_calc_+3A_enddate">enddate</code></td>
<td>

<p>POSIXlt or Date. Date to compute age
</p>
</td></tr>
<tr><td><code id="age_calc_+3A_units">units</code></td>
<td>

<p>string. Choose a unit.
</p>
</td></tr>
<tr><td><code id="age_calc_+3A_precise">precise</code></td>
<td>

<p>Boolean. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jason P Becker
</p>


<h3>References</h3>

<p>http://blog.jsonbecker.com/2013/12/calculating-age-with-precision-in-r.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
age_calc (dob=strptime("29OCT2002", format="%d%b%Y"), 
    enddate=strptime("30OCT2003", format="%d%b%Y"), units='years', precise=TRUE)
age_calc (dob=strptime("29OCT2002", format="%d%b%Y"), 
    enddate=strptime("30DEC2003", format="%d%b%Y"), units='years', precise=FALSE)

</code></pre>

<hr>
<h2 id='auc'>AUC</h2><span id='topic+auc'></span><span id='topic+ratio'></span><span id='topic+trainauc'></span><span id='topic+coef.auc'></span><span id='topic+predict.auc'></span><span id='topic+print.auc'></span><span id='topic+summary.auc'></span><span id='topic+ratio.glm'></span><span id='topic+ratio.auc'></span><span id='topic+trainauc.glm'></span><span id='topic+trainauc.auc'></span>

<h3>Description</h3>

<p>AUC methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'auc'
coef(object, ...) 
## S3 method for class 'auc'
predict(object, newdata, case.percentage = NULL, ...) 
## S3 method for class 'auc'
print(x, ...) 
## S3 method for class 'auc'
summary(object, ...) 
## S3 method for class 'auc'
trainauc(fit, training.data = NULL, ...)
## S3 method for class 'auc'
ratio(fit)

## S3 method for class 'glm'
trainauc(fit, ...)
## S3 method for class 'glm'
ratio(fit)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auc_+3A_fit">fit</code></td>
<td>
<p>an object that inherits from class 'auc' such as 'rauc' or 'sauc'</p>
</td></tr>
<tr><td><code id="auc_+3A_object">object</code></td>
<td>
<p>an object that inherits from class 'auc' such as 'rauc' or 'sauc'</p>
</td></tr>
<tr><td><code id="auc_+3A_x">x</code></td>
<td>
<p>an object that inherits from class 'auc' such as <code>rauc</code>, <code>sauc</code> or <code>sauc.dca</code>.</p>
</td></tr>
<tr><td><code id="auc_+3A_newdata">newdata</code></td>
<td>
<p>data at which to predict</p>
</td></tr>
<tr><td><code id="auc_+3A_case.percentage">case.percentage</code></td>
<td>
<p>used for class prediction, defaults to NULL</p>
</td></tr>
<tr><td><code id="auc_+3A_training.data">training.data</code></td>
<td>
<p>data frame used to compute auc based on a fit obtained by a call to  <code>rauc</code>, <code>sauc</code> or <code>sauc.dca</code></p>
</td></tr>
<tr><td><code id="auc_+3A_...">...</code></td>
<td>
<p>arguments passed to or from methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Youyi Fong <a href="mailto:youyifong@gmail.com">youyifong@gmail.com</a><br />
Krisztian Sebestyen <br />
</p>

<hr>
<h2 id='base.functions'>
Some Base Functions
</h2><span id='topic+cbinduneven'></span><span id='topic+binary'></span><span id='topic+binary2'></span><span id='topic+f2c'></span><span id='topic+ftoi'></span><span id='topic+keepWarnings'></span><span id='topic+meanmed'></span><span id='topic+myaggregate'></span><span id='topic+myreshapewide'></span><span id='topic+mysapply'></span><span id='topic+myscale'></span><span id='topic+mytable'></span><span id='topic+mysystem'></span><span id='topic+mytapply'></span><span id='topic+read.sv'></span><span id='topic+read.tsv'></span><span id='topic+table.prop'></span><span id='topic+unix'></span><span id='topic+table.cases'></span><span id='topic+table.cases.3'></span><span id='topic+multi.outer'></span><span id='topic+myreshapelong'></span><span id='topic+mycor'></span>

<h3>Description</h3>

<p>cbinduneven binds together a list of matrixes/dataframes of different lengths, rows are matched by names
binary returns binary representation of an integer. 
binary2 returns binary representatin of an integer with leading 0, the length of string is n.
mysystem can call any exe file that is in the PATH
f2c convert temperature from f to c/
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
mytable (..., exclude = if (useNA == "no") c(NA, NaN), useNA = "ifany", 
  dnn = list.names(...), deparse.level = 1) 

cbinduneven(li)

binary(i)

multi.outer (f, ... ) 

myreshapelong(dat, cols.to.be.stacked, label.cols.to.be.stacked, new.col.name)

binary2(i, n)

f2c(f)

ftoi(f)

keepWarnings(expr)

meanmed(x, na.rm = FALSE)


myaggregate(x, by, FUN, new.col.name = "aggregate.value", ...)

myreshapewide(formula, dat, idvar, keep.extra.col=FALSE)

mysapply(X, FUN, ..., simplify = TRUE, USE.NAMES = TRUE, ret.mat = TRUE)

myscale(x)

mysystem(cmd, ...)

mytapply(X, INDEX, FUN = NULL, ..., simplify = TRUE)

read.sv(file, header = TRUE, ...)

read.tsv(file, header = TRUE, sep = "\t", ...)

table.prop(x,y=NULL,digit=1,style=2,whole.table.add.to.1=FALSE,useNA="ifany",
    add.perc=FALSE, add.total.column = FALSE)

table.cases  (case,group,include.all=TRUE,desc="cases")
table.cases.3(case,group1,group2)

unix()

mycor (x, use = "everything", method = c("pearson", "kendall", "spearman"), 
    alternative = c("two.sided", "less", "greater"), exact = NULL, 
    conf.level = 0.95, continuity = FALSE, 
    digits.coef=2, digits.pval=3,
    ...) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="base.functions_+3A_exclude">exclude</code></td>
<td>

<p>exclude
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_dnn">dnn</code></td>
<td>

<p>dnn
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_deparse.level">deparse.level</code></td>
<td>

<p>deparse.level
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_add.total.column">add.total.column</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_use">use</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_method">method</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_alternative">alternative</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_exact">exact</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_conf.level">conf.level</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_continuity">continuity</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_digits.coef">digits.coef</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_digits.pval">digits.pval</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_cols.to.be.stacked">cols.to.be.stacked</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_label.cols.to.be.stacked">label.cols.to.be.stacked</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_li">li</code></td>
<td>
<p>a list</p>
</td></tr>  
<tr><td><code id="base.functions_+3A_i">i</code></td>
<td>

<p>tbdi
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_n">n</code></td>
<td>

<p>tbdn
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_f">f</code></td>
<td>
<p>In multi.out, f is a function.</p>
</td></tr>
<tr><td><code id="base.functions_+3A_case">case</code></td>
<td>
<p>vector of 0/1</p>
</td></tr>
<tr><td><code id="base.functions_+3A_group">group</code></td>
<td>
<p>vector of multi-group indicators</p>
</td></tr>
<tr><td><code id="base.functions_+3A_formula">formula</code></td>
<td>

<p>a formula object.</p>
</td></tr>
<tr><td><code id="base.functions_+3A_expr">expr</code></td>
<td>

<p>tbdexpr
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_na.rm">na.rm</code></td>
<td>

<p>tbdna.rm
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_desc">desc</code></td>
<td>

<p>tbdby
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_by">by</code></td>
<td>

<p>tbdby
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_whole.table.add.to.1">whole.table.add.to.1</code></td>
<td>

<p>Boolean
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_new.col.name">new.col.name</code></td>
<td>

<p>tbdnew.col.name
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_...">...</code></td>
<td>

<p>tbd...
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_dat">dat</code></td>
<td>

<p>tbddat
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_idvar">idvar</code></td>
<td>

<p>tbdidvar
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_x">X</code></td>
<td>

<p>tbdX
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_simplify">simplify</code></td>
<td>

<p>tbdsimplify
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_use.names">USE.NAMES</code></td>
<td>

<p>tbdUSE.NAMES
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_ret.mat">ret.mat</code></td>
<td>

<p>tbdret.mat
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_cmd">cmd</code></td>
<td>

<p>tbdcmd
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_index">INDEX</code></td>
<td>

<p>tbdINDEX
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_file">file</code></td>
<td>

<p>tbdfile
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_header">header</code></td>
<td>

<p>tbdheader
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_sep">sep</code></td>
<td>

<p>tbdsep
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_y">y</code></td>
<td>

<p>tbdy
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_digit">digit</code></td>
<td>

<p>tbddigit
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_style">style</code></td>
<td>

<p>tbdstyle
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_fun">FUN</code></td>
<td>

<p>tbdFUN
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_keep.extra.col">keep.extra.col</code></td>
<td>

<p>tbdFUN
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_usena">useNA</code></td>
<td>

<p>tbdFUN
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_add.perc">add.perc</code></td>
<td>

<p>tbdFUN
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_include.all">include.all</code></td>
<td>

<p>tbdFUN
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_group1">group1</code></td>
<td>

<p>tbdFUN
</p>
</td></tr>
<tr><td><code id="base.functions_+3A_group2">group2</code></td>
<td>

<p>tbdFUN
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
binary(5) ###  101
binary2(5, 4)

a=data.frame("x"=1:2)
b=data.frame("y"=3:5);#rownames(b)[3]=""
cbinduneven(list(a,b))

## Not run: 
# the formula in myreshapewide can only have one variable in the right hand side
    myreshapewide(fi~week, dat, c("ptid","stim"))

    myreshapelong(dat.201.neut, cols.to.be.stacked=c("MN.3","SF162","SVA.MLV"), 
        label.cols.to.be.stacked="antigen", new.col.name="y")

    myaggregate(subset(dat.poc, select=c(HIV, trt)), list(dat.poc$f), function(x) 
      with(x, c(fisher.test(HIV, trt)$estimate, fisher.test(HIV, trt)$p.value)))



## End(Not run)

</code></pre>

<hr>
<h2 id='binaryloess'>
Using loess to Check Functional Form for Logistic Regression
</h2><span id='topic+binaryloess'></span>

<h3>Description</h3>

<p>This function plots a smoothed line of how the average value of Y changes with X in order to check functional form for logistic regression. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binaryloess(x, y, scale = c("logit", "linear"), span = 0.7, weights = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binaryloess_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="binaryloess_+3A_y">y</code></td>
<td>

<p>tbdy
</p>
</td></tr>
<tr><td><code id="binaryloess_+3A_scale">scale</code></td>
<td>

<p>tbdscale
</p>
</td></tr>
<tr><td><code id="binaryloess_+3A_span">span</code></td>
<td>

<p>smoothing parameter, passed to loess. If less than 1, the neighbourhood includes proportion a of the points. If greater than 1, all points are used, with the maximum distance assumed to be a^(1/p) times the actual maximum distance for p explanatory variables.
<br />
Missing records are removed first.
</p>
</td></tr>
<tr><td><code id="binaryloess_+3A_weights">weights</code></td>
<td>

<p>sampling weights, passed to loess
</p>
</td></tr>
<tr><td><code id="binaryloess_+3A_...">...</code></td>
<td>

<p>passed to plotting function
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function comes from Jonathan Bartlett ()https://thestatsgeek.com/2014/09/13/checking-functional-form-in-logistic-regression-using-loess/).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234)
n &lt;- 1000
x &lt;- rnorm(n)
xb &lt;- -2+x
pr &lt;- exp(xb)/(1+exp(xb))
y=rbern(n, pr)

par(mfrow=c(1,2))
binaryloess(x, y, scale = "logit", span = 0.7, weights = NULL, ylab="logit(p)")
binaryloess(x, y, scale = "linear", span = 0.7, weights = NULL, ylab="prob")

</code></pre>

<hr>
<h2 id='cox.zph.2'>
Test the Proportional Hazards Assumption of a Cox Regression (a slightly modified version)
</h2><span id='topic+cox.zph.2'></span>

<h3>Description</h3>

<p>A slightly modified test of the proportional hazards assumption for a Cox regression model fit (coxph). This version corrects some conservativeness of the test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cox.zph.2(fit, transform = "km", global = TRUE, exact=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cox.zph.2_+3A_fit">fit</code></td>
<td>

<p>fit
</p>
</td></tr>
<tr><td><code id="cox.zph.2_+3A_transform">transform</code></td>
<td>

<p>transform
</p>
</td></tr>
<tr><td><code id="cox.zph.2_+3A_global">global</code></td>
<td>

<p>global
</p>
</td></tr>
<tr><td><code id="cox.zph.2_+3A_exact">exact</code></td>
<td>

<p>Boolean. If FALSE, this function is an identical copy of cox.zph. If TRUE, it computes the variance of the test statistic exactly, instead of approximately.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the model uses time-dependent covariates, the approximation used in Grambsch and Therneau resulted in conservativeness of the test. This is &quot;fixed&quot; here at a cost of up to 2.5 times longer execution time. 
</p>


<h3>References</h3>

<p>Fong, Y. and Halloran, M Elizabeth and Gilbert, P.  Using Time-Dependent Age Group in Cox Regression Analysis of Vaccine Efficacy Trials, Just Another Epi Journal, in prep.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+cox.zph">cox.zph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
fit &lt;- coxph(Surv(futime, fustat) ~ age + ecog.ps,  
             data=ovarian) 
temp &lt;- cox.zph(fit) 
print(temp)        
temp.2 &lt;- cox.zph.2(fit) 
print(temp.2)        

</code></pre>

<hr>
<h2 id='crossvalidation'>
Cross Validation Functions
</h2><span id='topic+sample.for.cv'></span><span id='topic+get.kfold.splits'></span><span id='topic+get.splits'></span><span id='topic+kfold.split'></span><span id='topic+lpo.split'></span><span id='topic+ran.kfold.split'></span>

<h3>Description</h3>

<p>Cross validation utility functions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
sample.for.cv (dat, v, seed)
get.kfold.splits (dat, k, seed)
kfold.split (k, n1, n0)
ran.kfold.split(k, n1, n0, replicates)
lpo.split(n1, n0)
get.splits (dat, cv.scheme=c("LPO","5fold","50xrandom4:1"), seed) 


</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossvalidation_+3A_dat">dat</code></td>
<td>
<p>a data frame. One of the columns must be named y and y should be 0/1 with 1 for case and 0 for control</p>
</td></tr>
<tr><td><code id="crossvalidation_+3A_v">v</code></td>
<td>
<p>v-fold cross validation</p>
</td></tr>
<tr><td><code id="crossvalidation_+3A_seed">seed</code></td>
<td>
<p>seed for random number generators</p>
</td></tr>
<tr><td><code id="crossvalidation_+3A_k">k</code></td>
<td>

<p>var.equal
</p>
</td></tr>
<tr><td><code id="crossvalidation_+3A_n1">n1</code></td>
<td>

<p>var.equal
</p>
</td></tr>
<tr><td><code id="crossvalidation_+3A_n0">n0</code></td>
<td>

<p>var.equal
</p>
</td></tr>
<tr><td><code id="crossvalidation_+3A_replicates">replicates</code></td>
<td>

<p>var.equal
</p>
</td></tr>
<tr><td><code id="crossvalidation_+3A_cv.scheme">cv.scheme</code></td>
<td>

<p>var.equal
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>sample.for.cv: case and controls are sampled separately.
</p>


<h3>Value</h3>

<p>sample.for.cv returns a list of two vector of integers: train and test, which refer to the rows of dat
</p>

<hr>
<h2 id='Deming'>
Fit Deming regression.
</h2><span id='topic+Deming'></span><span id='topic+coef.Deming'></span><span id='topic+vcov.Deming'></span><span id='topic+getFixedEf.Deming'></span><span id='topic+predict.Deming'></span><span id='topic+summary.Deming'></span>

<h3>Description</h3>

<p>Deming regression fit. Assume x and y variances are the same. Slightly modified from MethComp R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Deming(x, y, vr = sdr^2, sdr = sqrt(vr), boot = TRUE, keep.boot = FALSE, 
    alpha = 0.05) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Deming_+3A_x">x</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="Deming_+3A_y">y</code></td>
<td>

<p>tbdy
</p>
</td></tr>
<tr><td><code id="Deming_+3A_vr">vr</code></td>
<td>

<p>tbdvr
</p>
</td></tr>
<tr><td><code id="Deming_+3A_sdr">sdr</code></td>
<td>

<p>tbdsdr
</p>
</td></tr>
<tr><td><code id="Deming_+3A_boot">boot</code></td>
<td>

<p>tbdboot
</p>
</td></tr>
<tr><td><code id="Deming_+3A_keep.boot">keep.boot</code></td>
<td>

<p>tbdkeep.boot
</p>
</td></tr>
<tr><td><code id="Deming_+3A_alpha">alpha</code></td>
<td>

<p>tbdalpha
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
set.seed(1)
x=rnorm(100,0,1)
y=x+rnorm(100,0,.5)
x=x+rnorm(100,0,.5)
fit=Deming(x,y, boot=TRUE)
summary(fit)
plot(x,y)
abline(fit)
# compare with lm fit
fit.1=lm(y~x, data.frame(x,y))
summary(fit.1)
abline(fit.1, col=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='DMHeatMap'>
Better Heatmap Function
</h2><span id='topic+DMHeatMap'></span>

<h3>Description</h3>

<p>Makes a heatmap representation of correaltion coefficients easier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DMHeatMap(x, Rowv = TRUE, Colv = if (symm) "Rowv" else TRUE,
 distfun = dist, hclustfun = hclust, dendrogram =
 c("both", "row", "column", "none"), symm = FALSE,
 scale = c("none", "row", "column"), na.rm = TRUE, revC
 = identical(Colv, "Rowv"), add.expr, breaks, symbreaks
 = min(x &lt; 0, na.rm = TRUE) || scale != "none", col =
 "heat.colors", colsep, rowsep, sepcolor = "white",
 sepwidth = c(0.05, 0.05), cellnote, notecex = 1,
 notecol = "cyan", na.color = par("bg"), trace =
 c("column", "row", "both", "none"), tracecol = "cyan",
 hline = median(breaks), vline = median(breaks),
 linecol = tracecol, margins = c(5, 5), ColSideColors,
 RowSideColors, cexRow = 0.2 + 1/log10(nr), cexCol =
 0.2 + 1/log10(nc), labRow = NULL, labCol = NULL,
 labColor = NULL, axis = TRUE, heatmapOnly = FALSE, key
 = TRUE, keysize = 1.5, density.info = c("histogram",
 "density", "none"), denscol = tracecol, symkey = min(x
 &lt; 0, na.rm = TRUE) || symbreaks, densadj = 0.25, main
 = NULL, xlab = NULL, ylab = NULL, lmat = NULL, lhei =
 NULL, lwid = NULL, lower.left.only = TRUE, legend =
 TRUE, legend.x = "topright", verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DMHeatMap_+3A_x">x</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_axis">axis</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_heatmaponly">heatmapOnly</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_verbose">verbose</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_legend.x">legend.x</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_legend">legend</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_rowv">Rowv</code></td>
<td>

<p>tbdRowv
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_colv">Colv</code></td>
<td>

<p>tbdColv
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_distfun">distfun</code></td>
<td>

<p>tbddistfun
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_hclustfun">hclustfun</code></td>
<td>

<p>tbdhclustfun
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_dendrogram">dendrogram</code></td>
<td>

<p>tbddendrogram
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_symm">symm</code></td>
<td>

<p>tbdsymm
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_scale">scale</code></td>
<td>

<p>tbdscale
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_na.rm">na.rm</code></td>
<td>

<p>tbdna.rm
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_revc">revC</code></td>
<td>

<p>tbdrevC
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_add.expr">add.expr</code></td>
<td>

<p>tbdadd.expr
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_breaks">breaks</code></td>
<td>

<p>tbdbreaks
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_symbreaks">symbreaks</code></td>
<td>

<p>tbdsymbreaks
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_col">col</code></td>
<td>

<p>tbdcol
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_colsep">colsep</code></td>
<td>

<p>tbdcolsep
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_rowsep">rowsep</code></td>
<td>

<p>tbdrowsep
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_sepcolor">sepcolor</code></td>
<td>

<p>tbdsepcolor
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_sepwidth">sepwidth</code></td>
<td>

<p>tbdsepwidth
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_cellnote">cellnote</code></td>
<td>

<p>tbdcellnote
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_notecex">notecex</code></td>
<td>

<p>tbdnotecex
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_notecol">notecol</code></td>
<td>

<p>tbdnotecol
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_na.color">na.color</code></td>
<td>

<p>tbdna.color
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_trace">trace</code></td>
<td>

<p>tbdtrace
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_tracecol">tracecol</code></td>
<td>

<p>tbdtracecol
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_hline">hline</code></td>
<td>

<p>tbdhline
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_vline">vline</code></td>
<td>

<p>tbdvline
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_linecol">linecol</code></td>
<td>

<p>tbdlinecol
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_margins">margins</code></td>
<td>

<p>tbdmargins
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_colsidecolors">ColSideColors</code></td>
<td>

<p>tbdColSideColors
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_rowsidecolors">RowSideColors</code></td>
<td>

<p>tbdRowSideColors
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_cexrow">cexRow</code></td>
<td>

<p>tbdcexRow
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_cexcol">cexCol</code></td>
<td>

<p>tbdcexCol
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_labrow">labRow</code></td>
<td>

<p>tbdlabRow
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_labcol">labCol</code></td>
<td>

<p>tbdlabCol
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_labcolor">labColor</code></td>
<td>

<p>tbdlabColor
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_key">key</code></td>
<td>

<p>tbdkey
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_keysize">keysize</code></td>
<td>

<p>tbdkeysize
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_density.info">density.info</code></td>
<td>

<p>tbddensity.info
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_denscol">denscol</code></td>
<td>

<p>tbddenscol
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_symkey">symkey</code></td>
<td>

<p>tbdsymkey
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_densadj">densadj</code></td>
<td>

<p>tbddensadj
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_main">main</code></td>
<td>

<p>tbdmain
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_xlab">xlab</code></td>
<td>

<p>tbdxlab
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_ylab">ylab</code></td>
<td>

<p>tbdylab
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_lmat">lmat</code></td>
<td>

<p>tbdlmat
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_lhei">lhei</code></td>
<td>

<p>tbdlhei
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_lwid">lwid</code></td>
<td>

<p>tbdlwid
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_lower.left.only">lower.left.only</code></td>
<td>

<p>tbdlower.left.only
</p>
</td></tr>
<tr><td><code id="DMHeatMap_+3A_...">...</code></td>
<td>

<p>tbd...
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
cor=matrix(runif(15),5,3)
breaks=c(-1,-.7,-.5,-.3,-.1,.1,.3,.5,.7,1)
hU=DMHeatMap(cor, trace="none", symm=FALSE,dendrogram="none", col=RColorBrewer::brewer.pal(
    length(breaks)-1,"RdYlGn"), distfun = function(c) as.dist(1 - c), cexRow =1.5, cexCol =1.5, 
    lmat=rbind( c(2, 1), c(4,3) ), lhei=c(4, 1 ), breaks=breaks, margins=c(2,2), key = FALSE, 
    Rowv=NA, lower.left.only=FALSE)


</code></pre>

<hr>
<h2 id='get_count_from_xy_coor'>
Imaging analysis for spatial region
</h2><span id='topic+get_count_from_xy_coor'></span>

<h3>Description</h3>

<p>Counting the number of masks in a rectangular region
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_count_from_xy_coor(file, topleft, bottomright, image, plot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_count_from_xy_coor_+3A_file">file</code></td>
<td>

<p>_sizes_coordinates.txt
</p>
</td></tr>
<tr><td><code id="get_count_from_xy_coor_+3A_topleft">topleft</code></td>
<td>

<p>topleft (x,y) coordiate for a rectangular box
</p>
</td></tr>
<tr><td><code id="get_count_from_xy_coor_+3A_bottomright">bottomright</code></td>
<td>

<p>bottomright: bottomright (x,y) coordiate for a rectangular box  
</p>
</td></tr> 
<tr><td><code id="get_count_from_xy_coor_+3A_image">image</code></td>
<td>

<p>image: an image for plotting
</p>
</td></tr> 
<tr><td><code id="get_count_from_xy_coor_+3A_plot">plot</code></td>
<td>

<p>plot: plot=TRUE shows image with rectangular box
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function counts cells inside of rectangular box made by the topleft and bottomright xy-coordinates.
</p>


<h3>Value</h3>

<p>The number of masks inside of the rectangular box 
</p>


<h3>Author(s)</h3>

<p>Sunwoo Han
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#get_count_from_xy_coor(file='M926910_Position1_CD3-BUV395_sizes_coordinates.txt', 
  #topleft=c(500,0), bottomright=c(1392,500), 
  #image='M926910_Position1_CD3-BUV395.tiff', plot=TRUE)
</code></pre>

<hr>
<h2 id='get.sim.res'>
Read simulation results
</h2><span id='topic+get.sim.res'></span><span id='topic+MCsummary'></span><span id='topic+getFormattedMCSummary'></span>

<h3>Description</h3>

<p>Go through a folder and read all files and combine the results into a multidimensional array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.sim.res (dir, res.name="res", verbose=TRUE)
MCsummary (dir, res.name = "res", exclude.some = TRUE,
                 exclude.col = 1, verbose = TRUE)
getFormattedMCSummary (path, sim, nn, fit.method, exclude.some = TRUE,
                 exclude.col = 1, verbose = TRUE, coef.0 = NULL, digit1
                 = 2, sum.est = c("mean", "median"), sum.sd =
                 c("median", "mean"), style = 1, keep.intercept =
                 FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.sim.res_+3A_dir">dir</code></td>
<td>
<p>directory of MC result files</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_path">path</code></td>
<td>
<p>partial path to the directory of MC result files</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_res.name">res.name</code></td>
<td>
<p>name of the R object saved in the files, default is res, but may be others</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_verbose">verbose</code></td>
<td>
<p>Boolean</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_sim">sim</code></td>
<td>
<p>a string to denote simulation setting</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_nn">nn</code></td>
<td>
<p>a vector of sample sizes</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_fit.method">fit.method</code></td>
<td>
<p>a string to denote fitting method. sim, nn and fit.method together forms the name of the directory containing MC result files</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_exclude.col">exclude.col</code></td>
<td>
<p>column number</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_exclude.some">exclude.some</code></td>
<td>
<p>whether to exclude MC results that are extreme</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_coef.0">coef.0</code></td>
<td>
<p>simulation truth</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_digit1">digit1</code></td>
<td>
<p>digits</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_sum.est">sum.est</code></td>
<td>
<p>use mean or median as location estimate summary</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_sum.sd">sum.sd</code></td>
<td>
<p>use mean or median as sd estimate summary</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_style">style</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="get.sim.res_+3A_keep.intercept">keep.intercept</code></td>
<td>
<p>whether to include intercept in the table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depends on package abind to combine arrays from files.
</p>


<h3>Value</h3>

<p>A multidimensional array.
</p>

<hr>
<h2 id='getK'>getK</h2><span id='topic+getK'></span><span id='topic+getK'></span>

<h3>Description</h3>

<p><code>getK</code> calculates the kernel matrix between X and itself and returns a n by n matrix. Alternatively, it calculates the kernel matrix between X and X2 and returns a n by n2 matrix. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getK (X,kernel,para=NULL,X2=NULL,C = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getK_+3A_x">X</code></td>
<td>
<p>covariate matrix with dimension n by d. Note this is not the paired difference of covariate matrix.</p>
</td></tr>
<tr><td><code id="getK_+3A_kernel">kernel</code></td>
<td>
<p>string specifying type of kernel:
polynomial or p (1 + &lt;x,y&gt;)^para, <br />
rbf or r exp(-para*||x-y||^2), <br />
linear or l &lt;x,y&gt;, <br />
ibs or i 0.5*mean(2.0 - |x-y|) or sum(w*(2.0 - |x-y|))/sum(w), with x[i],y[i] in {0,1,2} and weights 'w' given in 'para'. <br />
hamming or h for sum(x == y) with x[i],y[i] binary, <br />
no default.
</p>
</td></tr>
<tr><td><code id="getK_+3A_para">para</code></td>
<td>
<p>parameter of the kernel fucntion. for <code>ibs</code> or <code>hamming</code>, para can be a vector of weights.</p>
</td></tr>
<tr><td><code id="getK_+3A_x2">X2</code></td>
<td>
<p>optional second covariate matrix with dimension n2 by d</p>
</td></tr>
<tr><td><code id="getK_+3A_c">C</code></td>
<td>
<p>logical. If TRUE, kernels are computed by custom routines in C, which may be more memory efficient, and faster too for ibs and hamming kernels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>IBS stands for 'Identical By State'. If 'x','y' are in in {0,1,2} then <br />
IBS(x,y) = 0 if |x-y|=2, 1 if |x-y|=1, 2 if |x-y|=0, or IBS(x,y) = 2.0 - |x-y|. <br />
K(u,v) = sum(IBS(u[i],v[i])) / 2K where K = length(u). <br />
The 'hamming' kernel is the equivalent of the 'ibs' kernel for binary data. 
Note that 'hamming' kernel is based on hamming similarity(!), not on dissimilarity distance.
</p>
<p>Within in the code, C is default to TRUE for ibs and hamming kernels and FALSE otherwise.
</p>


<h3>Value</h3>

<p>A kernel matrix.
</p>


<h3>Author(s)</h3>

<p>Youyi Fong <a href="mailto:youyifong@gmail.com">youyifong@gmail.com</a><br />
Krisztian Sebestyen <a href="mailto:ksebestyen@gmail.com">ksebestyen@gmail.com</a><br />
Shuxin Yin <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
X = cbind(x1=rnorm(n=5), x2=rnorm(n=5))
dim(X)
X2 = cbind(x1=rnorm(n=3), x2=rnorm(n=3))
dim(X2)

K = getK(X,"linear")
dim(K)

K = getK(X,"linear",X2=X2)
dim(K)
K1 = getK(X2,"l",X2=X)
dim(K1)
all(K==t(K1))


# RBF kernel
K = getK(X,"rbf",para=1,X2=X2)
K1 = getK(X2,"r",para=1,X2=X)
all(K==t(K1))


# IBS kernel for ternary data 
X &lt;- as.matrix(expand.grid(0:2,0:2))
K = getK(X,kernel = 'ibs')

# add weight
w = runif(ncol(X))
K = getK(X,kernel = 'ibs',para = w) 


# IBS kernel for binary data via option 'h' for 'hamming similarity measure'
X &lt;- as.matrix(expand.grid(0:1,0:1))
K=getK(X,kernel = 'h')

</code></pre>

<hr>
<h2 id='iorw'>
Causal Mediation Analysis of Cowling et al.
</h2><span id='topic+iorw'></span><span id='topic+print.iorw'></span>

<h3>Description</h3>

<p>Estimate the total, direct, and indirect effects using IORW method (inverse odds ratio weighting) and compute 95
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iorw(formula.effect, formula.mediators, data, family =
 NULL, nboot = 10000, numCores = 1, save.steps = FALSE,
 verbose = FALSE)

## S3 method for class 'iorw'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iorw_+3A_formula.effect">formula.effect</code></td>
<td>

<p>a formula object for the total and direct effect regression. The first term on the right is assumed to be the binary treatment/exposure variable.
</p>
</td></tr>
<tr><td><code id="iorw_+3A_formula.mediators">formula.mediators</code></td>
<td>

<p>a formula object for logistic regression. It should be of the form: ~ mediation marker1 + mediation marker2.
</p>
</td></tr>
<tr><td><code id="iorw_+3A_data">data</code></td>
<td>

<p>a data frame.
</p>
</td></tr>
<tr><td><code id="iorw_+3A_family">family</code></td>
<td>

<p>if Cox regression, leave as NULL; otherwise, it will be passed to glm().
</p>
</td></tr>
<tr><td><code id="iorw_+3A_nboot">nboot</code></td>
<td>

<p>an integer. Number of bootstrap replicates.
</p>
</td></tr>
<tr><td><code id="iorw_+3A_numcores">numCores</code></td>
<td>

<p>an interger. Number of cores to use for parallel procesing.
</p>
</td></tr>
<tr><td><code id="iorw_+3A_save.steps">save.steps</code></td>
<td>

<p>boolean. Whether or not to save the fits from the three steps and the weights.
</p>
</td></tr>
<tr><td><code id="iorw_+3A_x">x</code></td>
<td>

<p>Object of type iorw
</p>
</td></tr>
<tr><td><code id="iorw_+3A_verbose">verbose</code></td>
<td>

<p>boolean. 
</p>
</td></tr>
<tr><td><code id="iorw_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to the print function. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Code by Cowling and Lim was downloaded from https://datadryad.org/stash/dataset/doi:10.5061/dryad.cv37539
<br />
If a bootstrap replicate generates warnings during regression, NA will be returned for that replicate. The number of such occurrences is recorded in an attribute of boot.perc in the return value.
<br />
It does not handle sampling weights yet.
</p>


<h3>Value</h3>

<p>Point estimates and percentile bootstrap confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Youyi Fong, based on code by Cowling and Lim
</p>


<h3>References</h3>

<p>Cowling, B. J., Lim, W. W., Perera, R. A., Fang, V. J., Leung, G. M., Peiris, J. M., &amp; Tchetgen Tchetgen, E. J. (2019). Influenza hemagglutination-inhibition antibody titer as a mediator of vaccine-induced protection for influenza B. Clinical Infectious Diseases, 68(10), 1713-1717.
<br />
Nguyen, Q. C., Osypuk, T. L., Schmidt, N. M., Glymour, M. M., &amp; Tchetgen Tchetgen, E. J. (2015). Practical guidance for conducting mediation analysis with multiple mediators using inverse odds ratio weighting. American journal of epidemiology, 181(5), 349-356.
<br />
Tchetgen Tchetgen, E. J. (2013). Inverse odds ratio-weighted estimation for causal mediation analysis. Statistics in medicine, 32(26), 4567-4580.
<br />
Imai, K., Keele, L., &amp; Tingley, D. (2010). A general approach to causal mediation analysis. Psychological methods, 15(4), 309.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#### Cox regression

# without adjusting for baseline markers
library(survival)
formula.effect=Surv(surv_time, flu)~vaccine+age
formula.mediators=~log2(postvax.B.Brisbane/5)
res.1=iorw(formula.effect, formula.mediators, kid, nboot=10, numCores=1); res.1
stopifnot(max(abs(res.1$boot[1,] - c(0.2029779,0.6070105,0.3039110,0.4283389,0.2124268)))&lt;1e-6)

# adjust for baseline markers
formula.effect=Surv(surv_time, flu)~vaccine+log2(prevax.B.Brisbane)+age
formula.mediators=~log2(postvax.B.Brisbane/5)
res.2=iorw(formula.effect, formula.mediators, kid, nboot=10, numCores=1); res.2


#### Logistic regression

# without adjusting for baseline markers
formula.effect=flu~vaccine+age
formula.mediators=~log2(postvax.B.Brisbane/5)
res.3=iorw(formula.effect, formula.mediators, kid, family=binomial(), nboot=10, numCores=1); res.3
stopifnot(max(abs(res.3$boot[1,] - c(0.1960024,0.6154349,0.2937164,0.4145470,0.2168644)))&lt;1e-6)

# adjust for baseline markers
formula.effect=flu~vaccine+log2(prevax.B.Brisbane)+age
formula.mediators=~log2(postvax.B.Brisbane/5)
res.4=iorw(formula.effect, formula.mediators, kid, family=binomial(), nboot=10, numCores=1); res.4






</code></pre>

<hr>
<h2 id='kid'>
Dataset from Cowling et al. 
</h2><span id='topic+kid'></span>

<h3>Description</h3>

<p>Influenza immune response biomarkers dataset. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("kid")</code></pre>


<h3>Format</h3>

<p>A data frame with 736 observations on the following 10 variables.
</p>

<dl>
<dt><code>hhID</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>intervention</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>vaccine</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>vaccine.date</code></dt><dd><p>a Date</p>
</dd>
<dt><code>postvax.date</code></dt><dd><p>a Date</p>
</dd>
<dt><code>prevax.B.Brisbane</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>postvax.B.Brisbane</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>surv_time</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>flu</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>References</h3>

<p>Cowling, B. J., Lim, W. W., Perera, R. A., Fang, V. J., Leung, G. M., Peiris, J. M., &amp; Tchetgen Tchetgen, E. J. (2019). Influenza hemagglutination-inhibition antibody titer as a mediator of vaccine-induced protection for influenza B. Clinical Infectious Diseases, 68(10), 1713-1717.
</p>

<hr>
<h2 id='kyotil'>kyotil</h2><span id='topic+kyotil'></span>

<h3>Description</h3>

<p>Utility functions by Youyi Fong and Krisz Sebestyen, and some functions copied from other packages for convenience (acknowledged on their manual pages).
</p>
<p>Most useful functions: mypostscript/mypdf, mytex, 
</p>
<p>See the Index link below for a list of available functions.
</p>
<p>The package depends on Hmisc. The main reason for that, besides the usefulness of the package, is Hmisc depends on ggplot2, which also define 
</p>

<hr>
<h2 id='make.timedep.dataset'>
Create Dataset for Time-dependent Covariate Proportional Hazard Model Analaysi
</h2><span id='topic+make.timedep.dataset'></span>

<h3>Description</h3>

<p>Returns a data frame that is suitable for time-dependent covariate Cox model fit. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.timedep.dataset(dat, X, d, baseline.ageyrs, t.1, t.2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.timedep.dataset_+3A_dat">dat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="make.timedep.dataset_+3A_x">X</code></td>
<td>

<p>string. Name of the followup time column in dat. Unit needs to be years.
</p>
</td></tr>
<tr><td><code id="make.timedep.dataset_+3A_d">d</code></td>
<td>

<p>string. Name of the followup time column in dat.
</p>
</td></tr>
<tr><td><code id="make.timedep.dataset_+3A_baseline.ageyrs">baseline.ageyrs</code></td>
<td>

<p>string. Name of the followup time column in dat.
</p>
</td></tr>
<tr><td><code id="make.timedep.dataset_+3A_t.1">t.1</code></td>
<td>

<p>numerical. Cutoff for age group
</p>
</td></tr>
<tr><td><code id="make.timedep.dataset_+3A_t.2">t.2</code></td>
<td>

<p>numerical. Second cutoff for age group 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assumes that the followup length is such that only one change of age group is possible.
</p>


<h3>Value</h3>

<p>Returns a data frame with the following columns added:  tstart, tstop, .timedep.agegrp, .baseline.agegrp
</p>
<table>
<tr><td><code>tstart</code></td>
<td>
<p>left bound of time interval</p>
</td></tr>
<tr><td><code>tstop</code></td>
<td>
<p>right bound of time interval</p>
</td></tr>
<tr><td><code>.timedep.agegrp</code></td>
<td>
<p>time-dependent age group</p>
</td></tr>
<tr><td><code>.baseline.agegrp</code></td>
<td>
<p>baseline age group</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Youyi Fong
</p>


<h3>References</h3>

<p>Therneau, T. and Crowson, C. Using Time Dependent Covariates and Time Dependent Coefficients in the Cox Model. A vignette from the R package surival.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(survival)

n=3000; followup.length=5; incidence.density=0.015; age.sim="continuous"

dat.0=sim.dat.tvarying.two(n, followup.length, incidence.density, age.sim, seed=1)
dat=subset(dat.0, for.non.tvarying.ana, select=c(ptid, X, d, baseline.age, trt))
dat.timedep = make.timedep.dataset (dat, "X", "d", "baseline.age", 6)
coxph(Surv(tstart,tstop,d) ~ trt*.timedep.agegrp, dat.timedep)


</code></pre>

<hr>
<h2 id='math.functions'>
Math Functions
</h2><span id='topic+math.functions'></span><span id='topic+as.binary'></span><span id='topic+binom.coef'></span><span id='topic+expit'></span><span id='topic+logDiffExp'></span><span id='topic+logit'></span><span id='topic+logMeanExp'></span><span id='topic+logSumExp'></span><span id='topic+logSumExpFor2'></span><span id='topic+permn'></span><span id='topic+Stirling2'></span><span id='topic+interpolate'></span>

<h3>Description</h3>

<p>H calculates entropy. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
as.binary(n, base = 2, r = FALSE)

binom.coef(n, m)

expit(x)

logDiffExp(logx1, logx2)

logit(x)

logMeanExp(logx, B = NULL)

logSumExp(logx)

logSumExpFor2(logx, logy)

permn(x, fun = NULL, ...)

Stirling2(n, m)

interpolate(pt1, pt2, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="math.functions_+3A_n">n</code></td>
<td>

<p>tbdn
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_base">base</code></td>
<td>

<p>tbdbase
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_r">r</code></td>
<td>

<p>tbdr
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_m">m</code></td>
<td>

<p>tbdm
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_pt1">pt1</code></td>
<td>
<p>a vector of length 2</p>
</td></tr>
<tr><td><code id="math.functions_+3A_pt2">pt2</code></td>
<td>
<p>a vector of length 2</p>
</td></tr>
<tr><td><code id="math.functions_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_logx1">logx1</code></td>
<td>

<p>tbdlogx1
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_logx2">logx2</code></td>
<td>

<p>tbdlogx2
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_logx">logx</code></td>
<td>

<p>tbdlogx
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_b">B</code></td>
<td>

<p>tbdB
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_logy">logy</code></td>
<td>

<p>tbdlogy
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_fun">fun</code></td>
<td>

<p>tbdfun
</p>
</td></tr>
<tr><td><code id="math.functions_+3A_...">...</code></td>
<td>

<p>tbd...
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>H(rep(1/5,5))
H(rep(3,5))
</code></pre>

<hr>
<h2 id='matrix.array.functions'>
Matrix and Array Functions
</h2><span id='topic+matrix.array.functions'></span><span id='topic+matrix.functions'></span><span id='topic+array.functions'></span><span id='topic+AR1'></span><span id='topic+concatList'></span><span id='topic+EXCH'></span><span id='topic+fill.jagged.array'></span><span id='topic+getMidPoints'></span><span id='topic+getUpperRight'></span><span id='topic+last'></span><span id='topic+mix'></span><span id='topic+rep.data.frame'></span><span id='topic+rep.matrix'></span><span id='topic+rep.matrix.block'></span><span id='topic+shift.left'></span><span id='topic+shift.right'></span><span id='topic+thin.rows'></span><span id='topic+ThinRows'></span><span id='topic+tr'></span>

<h3>Description</h3>

<p>concatList returns a string that concatenates the elements of the input list or array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
AR1(p, w)

concatList(lis, sep = "")

EXCH(p, rho)

fill.jagged.array(a)

getMidPoints(x)

getUpperRight(matri, func = NULL)

last(x, n = 1, ...)

mix(a, b)

## S3 method for class 'data.frame'
rep(x, times = 1, ...)

## S3 method for class 'matrix'
rep(x, times = 1, each = 1, by.row = TRUE, ...)

## S3 method for class 'matrix.block'
rep(x, times = 2, ...)

shift.left(x, k = 1)

shift.right(x, k = 1)

thin.rows(dat, thin.factor = 10)

ThinRows(dat, thin.factor = 10)

tr(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix.array.functions_+3A_p">p</code></td>
<td>

<p>tbdp
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_w">w</code></td>
<td>

<p>tbdw
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_lis">lis</code></td>
<td>

<p>list or array
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_sep">sep</code></td>
<td>

<p>tbdsep
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_rho">rho</code></td>
<td>

<p>tbdrho
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_a">a</code></td>
<td>

<p>tbda
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_matri">matri</code></td>
<td>

<p>tbdmatri
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_func">func</code></td>
<td>

<p>tbdfunc
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_n">n</code></td>
<td>

<p>tbdn
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_...">...</code></td>
<td>

<p>tbd...
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_b">b</code></td>
<td>

<p>tbdb
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_times">times</code></td>
<td>

<p>tbdtimes
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_each">each</code></td>
<td>

<p>tbdeach
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_by.row">by.row</code></td>
<td>

<p>tbdby.row
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_k">k</code></td>
<td>

<p>tbdk
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_dat">dat</code></td>
<td>

<p>tbddat
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_thin.factor">thin.factor</code></td>
<td>

<p>tbdthin.factor
</p>
</td></tr>
<tr><td><code id="matrix.array.functions_+3A_m">m</code></td>
<td>

<p>tbdm
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
concatList(1:3,"_")
</code></pre>

<hr>
<h2 id='matrix2'>
Matrix Functions that May Be Faster than 
</h2><span id='topic+DXD'></span><span id='topic+tXDX'></span><span id='topic+symprod'></span><span id='topic+txSy'></span><span id='topic+.as.double'></span>

<h3>Description</h3>

<p>DXD computes D %*% X  %*% D, where D is a diagonal matrix. tXDX computes t(X) %*% D  %*% X. symprod computes S %*% X for symmetric S. txSy computes t(x) %*% S %*% y for symmetric S.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
DXD(d1, X, d2)

tXDX(X,D)

symprod(S, X)

txSy(x, S, y)

.as.double(x, stripAttributes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix2_+3A_d1">d1</code></td>
<td>
<p>a diagonal matrix or an array</p>
</td></tr>
<tr><td><code id="matrix2_+3A_d2">d2</code></td>
<td>
<p>a diagonal matrix or an array</p>
</td></tr>
<tr><td><code id="matrix2_+3A_x">x</code></td>
<td>
<p>array</p>
</td></tr>
<tr><td><code id="matrix2_+3A_y">y</code></td>
<td>
<p>array</p>
</td></tr>
<tr><td><code id="matrix2_+3A_s">S</code></td>
<td>
<p>symmetric matrix</p>
</td></tr>
<tr><td><code id="matrix2_+3A_x">X</code></td>
<td>
<p>matix</p>
</td></tr>
<tr><td><code id="matrix2_+3A_d">D</code></td>
<td>
<p>matix</p>
</td></tr>
<tr><td><code id="matrix2_+3A_stripattributes">stripAttributes</code></td>
<td>
<p>boolean</p>
</td></tr>
</table>


<h3>Details</h3>

<p>.as.double does not copying whereas as.double(x) for older versions of R when using .C(DUP = FALSE) make duplicate copy of x. 
In addition, even if x is a 'double', since x has attributes (dim(x)) as.double(x) duplicates
</p>
<p>The functions do not check whether S is symmetric. If it is not symmetric, then the result will be wrong.
DXD offers a big gain, while symprod and txSy gains are more incremental.
</p>


<h3>Author(s)</h3>

<p>Krisztian Sebestyen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
d1=1:3
d2=4:6
X=matrix(1:9,3,3)
all(DXD(d1, X, d2) == diag(d1) %*% X %*% diag(d2))

S=matrix(c(1,2,3,2,4,5,3,5,8),3,3)
X=matrix(1:9,3,3)
all( symprod(S, X) == S %*% X )

x=1:3
y=4:6
S=matrix(c(1,2,3,2,4,5,3,5,8),3,3)
txSy(x, S, y) == drop(t(x)%*%S%*%y)



</code></pre>

<hr>
<h2 id='misc'>
Misc Functions
</h2><span id='topic+pava'></span><span id='topic+summ'></span><span id='topic+empty2na'></span><span id='topic+predict.pcc'></span><span id='topic+rank.inv.norm'></span><span id='topic+INT'></span><span id='topic+dec_to_binary'></span>

<h3>Description</h3>

<p>Misc functions. summ computes iterative sum, sort of like diff.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
pava (x, wt = rep(1, length(x)))
summ(x)
empty2na(x) 
## S3 method for class 'pcc'
predict(object, newdat, ...)
rank.inv.norm(x)
INT(x)
dec_to_binary (x,d) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="misc_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="misc_+3A_d">d</code></td>
<td>

<p>number of digits in the returned binary representation, including leading 0's
</p>
</td></tr>
<tr><td><code id="misc_+3A_wt">wt</code></td>
<td>

<p>tbdvar.equal
</p>
</td></tr>
<tr><td><code id="misc_+3A_object">object</code></td>
<td>

<p>tbdvar.equal
</p>
</td></tr>
<tr><td><code id="misc_+3A_newdat">newdat</code></td>
<td>

<p>tbdvar.equal
</p>
</td></tr>
<tr><td><code id="misc_+3A_...">...</code></td>
<td>

<p>tbdvar.equal
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>rank.inv.norm: rank-based inverse normal/gaussian transformation
</p>
<p>dec_to_binary covert a decimal number to a binary representation with d digits
</p>


<h3>Value</h3>

<p>summ returns 
</p>

<hr>
<h2 id='p.adj.perm'>
Permutation-based Multitesting P Values Adjustment
</h2><span id='topic+p.adj.perm'></span>

<h3>Description</h3>

<p>An implementation of Westfall and Young
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.adj.perm(p.unadj, p.perms, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.adj.perm_+3A_p.unadj">p.unadj</code></td>
<td>

<p>p.unadj
</p>
</td></tr>
<tr><td><code id="p.adj.perm_+3A_p.perms">p.perms</code></td>
<td>

<p>p.perms
</p>
</td></tr>
<tr><td><code id="p.adj.perm_+3A_alpha">alpha</code></td>
<td>

<p>alpha
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This implementation is not as fast as the implementation from the package multtest. But ususally the step to create p.perms is the rate-limiting step.  <br />
<br />
</p>
<p>The smallest of the Westfall and Young FWER-controlling multitesting adjusted p values coincides with the p value for testing a global null without any assumptions. 
But for the multitesting adjustment to hold, it requires the subset pivotality condition.
</p>


<h3>Author(s)</h3>

<p>Sue Li, sli@fredhutch.org
</p>


<h3>References</h3>

<p>Westfall, P. H., &amp; Young, S. S. (1993). Resampling-based multiple testing: Examples and methods for p-value adjustment (Vol. 279). John Wiley &amp; Sons.
<br />
Westfall, P. H., &amp; Troendle, J. F. (2008). Multiple testing with minimal assumptions. Biometrical Journal: Journal of Mathematical Methods in Biosciences, 50(5), 745-755.
</p>

<hr>
<h2 id='plotting'>
Plotting Functions</h2><span id='topic+abline.pt.slope'></span><span id='topic+wtd.hist'></span><span id='topic+abline.pts'></span><span id='topic+abline.shade'></span><span id='topic+abline.shade.2'></span><span id='topic+butterfly.plot'></span><span id='topic+empty.plot'></span><span id='topic+getMfrow'></span><span id='topic+whiskers'></span><span id='topic+myforestplot'></span><span id='topic+my.interaction.plot'></span><span id='topic+myboxplot'></span><span id='topic+myplot'></span><span id='topic+myboxplot.formula'></span><span id='topic+myboxplot.data.frame'></span><span id='topic+myboxplot.list'></span><span id='topic+mylegend'></span><span id='topic+mymatplot'></span><span id='topic+mypairs'></span><span id='topic+myhist'></span><span id='topic+mypdf'></span><span id='topic+mypng'></span><span id='topic+mypostscript'></span><span id='topic+panel.cor'></span><span id='topic+panel.hist'></span><span id='topic+panel.nothing'></span><span id='topic+corplot'></span><span id='topic+corplot.default'></span><span id='topic+corplot.formula'></span><span id='topic+add.mtext.label'></span><span id='topic+mydev.off'></span><span id='topic+myfigure'></span><span id='topic+mylines'></span><span id='topic+mytiff'></span><span id='topic+myplot.loess'></span>

<h3>Description</h3>

<p>mypostscript and mypdf sets the width and height based on mfrow input. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
myplot (object, ...) 

## S3 method for class 'loess'
myplot(object, xlab="x", ylab="fitted", ...)

whiskers (x, s, ...) 

abline.pt.slope(pt1, slope, x2=NULL, ...)

abline.pts(pt1, pt2 = NULL)

butterfly.plot(dat, dat2 = NULL, add = FALSE, xaxislabels = rep("", 4), x.ori = 0, 
    xlab = "", ylab = "", cex.axis = 1, ...)

empty.plot()

add.mtext.label (text, cex = 1.4, adj = -0.2) 
mydev.off(file = "temp", ext = c("pdf"), res = 200, mydev =
                 NULL, silent = TRUE)
getMfrow(len)

myhist (x, add.norm=TRUE, col.norm="blue", ...)

myforestplot(dat, xlim = NULL, xlab = "", main = "", col.1 = "red",
 col.2 = "blue", plot.labels = TRUE, order = FALSE,
 decreasing = FALSE, vline = TRUE, cols = NULL, log =
 "", null.val = NULL)

my.interaction.plot(dat, x.ori = 0, xaxislabels = rep("", 2), cex.axis = 1, add = FALSE,
    xlab = "", ylab = "", pcol = NULL, lcol = NULL, ...)

myboxplot(object, ...)

## S3 method for class 'formula'
myboxplot(formula, data, cex = 0.5, xlab = "", ylab = "", main =
 "", box = TRUE, at = NULL, na.action = NULL, p.val =
 NULL, pch = 1, col = 1, test = "",
 friedman.test.formula = NULL, reshape.formula = NULL,
 reshape.id = NULL, jitter = TRUE, add.interaction =
 FALSE, drop.unused.levels = TRUE, bg.pt = NULL, add =
 FALSE, seed = 1, write.p.at.top = FALSE, ...)
    
## S3 method for class 'data.frame'
myboxplot(object, cex = 0.5, ylab = "", xlab = "", main = "",
 box = TRUE, at = NULL, pch = 1, col = 1, test = "",
 paired = FALSE, ...)

## S3 method for class 'list'
myboxplot(object, paired = FALSE, ...)

abline.shade.2(x, col=c(0,1,0))
abline.shade(pt, type = 5, col = c(0, 1, 0), alpha = 0.3)


mylegend(legend, x, y=NULL, lty = NULL, bty = "n", ...)

mymatplot(x, y, type = "b", lty = c(1, 2, 1, 2, 1, 2), pch =
                 NULL, col = rep(c("darkgray", "black"), each = 3),
                 xlab = NULL, ylab = "", draw.x.axis = TRUE, bg = NA,
                 lwd = 1, at = NULL, make.legend = TRUE, legend = NULL,
                 impute.missing.for.line = TRUE, legend.x = 9,
                 legend.title = NULL, legend.cex = 1, legend.lty = lty,
                 legend.inset = 0, xaxt = "s", y.intersp = 1.5,
                 x.intersp = 0.3, text.width = NULL, add = FALSE, ...
)
                          
mypairs(dat, ladder = FALSE, show.data.cloud = TRUE,
 ladder.add.line = T, ladder.add.text = T, ...)

wtd.hist (x, breaks = "Sturges", freq = NULL, probability = !freq, 
    include.lowest = TRUE, right = TRUE, density = NULL, angle = 45, 
    col = NULL, border = NULL, main = paste("Histogram of", xname), 
    xlim = range(breaks), ylim = NULL, xlab = xname, ylab, axes = TRUE, 
    plot = TRUE, labels = FALSE, nclass = NULL, weight = NULL, 
    ...) 

mylines(x, y, type = "l", ...)

myfigure(mfrow = c(1, 1), mfcol = NULL, width = NULL, 
    height = NULL, oma = NULL, mar = NULL, main.outer = FALSE, bg=NULL) 


mypdf(...)

mypng(...)
mytiff(...)

mypostscript(file = "temp", mfrow = c(1, 1), mfcol = NULL, width =
                 NULL, height = NULL, ext = c("eps", "pdf", "png",
                 "tiff"), oma = NULL, mar = NULL, main.outer = FALSE,
                 save2file = TRUE, res = 200, silent = TRUE, ...)

panel.cor(x, y, digits = 2, prefix = "", cex.cor, cor., leading0
 = FALSE, cex.cor.dep = TRUE, ...)

panel.hist(x, ...)

panel.nothing(x, ...)

corplot(object, ...)

## Default S3 method:
corplot(object, y, ...)

## S3 method for class 'formula'
corplot(formula, data, main = "", method = c("pearson",
 "spearman"), col = 1, cex = 0.5, add.diagonal.line =
 TRUE, add.lm.fit = FALSE, add.loess.fit = FALSE,
 col.lm = 2, add.deming.fit = FALSE, col.deming = 4,
 add = FALSE, log = "", same.xylim = FALSE, xlim =
 NULL, ylim = NULL, ...)



</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotting_+3A_silent">silent</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_legend.lty">legend.lty</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_cex.cor.dep">cex.cor.dep</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_add.loess.fit">add.loess.fit</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_leading0">leading0</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_null.val">null.val</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_write.p.at.top">write.p.at.top</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_text.width">text.width</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_text">text</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_cex">cex</code></td>
<td>

<p>tbdcex
</p>
</td></tr>
<tr><td><code id="plotting_+3A_adj">adj</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_file">file</code></td>
<td>

<p>tbdfile
</p>
</td></tr>
<tr><td><code id="plotting_+3A_ext">ext</code></td>
<td>

<p>tbdext
</p>
</td></tr>
<tr><td><code id="plotting_+3A_res">res</code></td>
<td>

<p>resolution.
</p>
</td></tr>
<tr><td><code id="plotting_+3A_add.norm">add.norm</code></td>
<td>
<p>Boolean, whether to add normal approximation density line</p>
</td></tr>
<tr><td><code id="plotting_+3A_col.norm">col.norm</code></td>
<td>
<p>string, color of added normal density line</p>
</td></tr>
<tr><td><code id="plotting_+3A_pt1">pt1</code></td>
<td>

<p>tbdpt1
</p>
</td></tr>
<tr><td><code id="plotting_+3A_s">s</code></td>
<td>

<p>tbdslope
</p>
</td></tr>
<tr><td><code id="plotting_+3A_ladder">ladder</code></td>
<td>

<p>tbdslope
</p>
</td></tr>
<tr><td><code id="plotting_+3A_slope">slope</code></td>
<td>

<p>tbdslope
</p>
</td></tr>
<tr><td><code id="plotting_+3A_friedman.test.formula">friedman.test.formula</code></td>
<td>

<p>tbdslope
</p>
</td></tr>
<tr><td><code id="plotting_+3A_reshape.id">reshape.id</code></td>
<td>

<p>tbdslope
</p>
</td></tr>
<tr><td><code id="plotting_+3A_impute.missing.for.line">impute.missing.for.line</code></td>
<td>

<p>tbdslope
</p>
</td></tr>
<tr><td><code id="plotting_+3A_cor.">cor.</code></td>
<td>

<p>tbdslope
</p>
</td></tr>
<tr><td><code id="plotting_+3A_mydev">mydev</code></td>
<td>

<p>tbdslope
</p>
</td></tr>
<tr><td><code id="plotting_+3A_jitter">jitter</code></td>
<td>
<p>Boolean</p>
</td></tr>
<tr><td><code id="plotting_+3A_add.interaction">add.interaction</code></td>
<td>
<p>Boolean</p>
</td></tr>
<tr><td><code id="plotting_+3A_...">...</code></td>
<td>

<p>tbd...
</p>
</td></tr>
<tr><td><code id="plotting_+3A_xaxt">xaxt</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_breaks">breaks</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_freq">freq</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_bg.pt">bg.pt</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_probability">probability</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_include.lowest">include.lowest</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_right">right</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_density">density</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_angle">angle</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_border">border</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_axes">axes</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_plot">plot</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_labels">labels</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_nclass">nclass</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_weight">weight</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_pt2">pt2</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_pt">pt</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_alpha">alpha</code></td>
<td>

<p>tbdpt2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_dat">dat</code></td>
<td>

<p>tbddat
</p>
</td></tr>
<tr><td><code id="plotting_+3A_lwd">lwd</code></td>
<td>

<p>line width.
</p>
</td></tr>
<tr><td><code id="plotting_+3A_x.intersp">x.intersp</code></td>
<td>

<p>controls the look of legend.
</p>
</td></tr>
<tr><td><code id="plotting_+3A_y.intersp">y.intersp</code></td>
<td>

<p>controls the look of legend.
</p>
</td></tr>
<tr><td><code id="plotting_+3A_legend.inset">legend.inset</code></td>
<td>

<p>legend inset
</p>
</td></tr>
<tr><td><code id="plotting_+3A_dat2">dat2</code></td>
<td>

<p>tbddat2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_add">add</code></td>
<td>

<p>tbdadd
</p>
</td></tr>
<tr><td><code id="plotting_+3A_log">log</code></td>
<td>

<p>log
</p>
</td></tr>
<tr><td><code id="plotting_+3A_add.lm.fit">add.lm.fit</code></td>
<td>

<p>lm fit
</p>
</td></tr>
<tr><td><code id="plotting_+3A_add.deming.fit">add.deming.fit</code></td>
<td>

<p>add 
</p>
</td></tr>
<tr><td><code id="plotting_+3A_col.lm">col.lm</code></td>
<td>

<p>col
</p>
</td></tr>
<tr><td><code id="plotting_+3A_col.deming">col.deming</code></td>
<td>

<p>col
</p>
</td></tr>
<tr><td><code id="plotting_+3A_reshape.formula">reshape.formula</code></td>
<td>

<p>a formula object.
</p>
</td></tr>
<tr><td><code id="plotting_+3A_xaxislabels">xaxislabels</code></td>
<td>

<p>tbdxaxislabels
</p>
</td></tr>
<tr><td><code id="plotting_+3A_x.ori">x.ori</code></td>
<td>

<p>tbdx.ori
</p>
</td></tr>
<tr><td><code id="plotting_+3A_xlab">xlab</code></td>
<td>

<p>tbdxlab
</p>
</td></tr>
<tr><td><code id="plotting_+3A_ylab">ylab</code></td>
<td>

<p>tbdylab
</p>
</td></tr>
<tr><td><code id="plotting_+3A_cex.axis">cex.axis</code></td>
<td>

<p>tbdcex.axis
</p>
</td></tr>
<tr><td><code id="plotting_+3A_len">len</code></td>
<td>

<p>tbdlen
</p>
</td></tr>
<tr><td><code id="plotting_+3A_same.xylim">same.xylim</code></td>
<td>
<p>Boolean. Whether xlim and ylim should be the same
</p>
</td></tr>
<tr><td><code id="plotting_+3A_xlim">xlim</code></td>
<td>

<p>tbdxlim
</p>
</td></tr>
<tr><td><code id="plotting_+3A_ylim">ylim</code></td>
<td>

<p>tbdxlim
</p>
</td></tr>
<tr><td><code id="plotting_+3A_main">main</code></td>
<td>

<p>tbdmain
</p>
</td></tr>
<tr><td><code id="plotting_+3A_col.1">col.1</code></td>
<td>

<p>tbdcol.1
</p>
</td></tr>
<tr><td><code id="plotting_+3A_col.2">col.2</code></td>
<td>

<p>tbdcol.2
</p>
</td></tr>
<tr><td><code id="plotting_+3A_pcol">pcol</code></td>
<td>

<p>tbdpcol
</p>
</td></tr>
<tr><td><code id="plotting_+3A_lcol">lcol</code></td>
<td>

<p>tbdlcol
</p>
</td></tr>
<tr><td><code id="plotting_+3A_object">object</code></td>
<td>

<p>tbdobject
</p>
</td></tr>
<tr><td><code id="plotting_+3A_formula">formula</code></td>
<td>

<p>tbdformula
</p>
</td></tr>
<tr><td><code id="plotting_+3A_data">data</code></td>
<td>

<p>tbddata
</p>
</td></tr>
<tr><td><code id="plotting_+3A_box">box</code></td>
<td>

<p>tbdbox
</p>
</td></tr>
<tr><td><code id="plotting_+3A_at">at</code></td>
<td>

<p>tbdat
</p>
</td></tr>
<tr><td><code id="plotting_+3A_pch">pch</code></td>
<td>

<p>tbdpch
</p>
</td></tr>
<tr><td><code id="plotting_+3A_col">col</code></td>
<td>

<p>tbdcol
</p>
</td></tr>
<tr><td><code id="plotting_+3A_test">test</code></td>
<td>

<p>string. For example, &quot;t&quot;,&quot;w&quot;,&quot;f&quot;,&quot;k&quot;, &quot;tw&quot;
</p>
</td></tr>
<tr><td><code id="plotting_+3A_legend">legend</code></td>
<td>

<p>tbdlegend
</p>
</td></tr>
<tr><td><code id="plotting_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="plotting_+3A_lty">lty</code></td>
<td>

<p>tbdlty
</p>
</td></tr>
<tr><td><code id="plotting_+3A_bty">bty</code></td>
<td>

<p>tbdbty
</p>
</td></tr>
<tr><td><code id="plotting_+3A_type">type</code></td>
<td>

<p>tbdtype
</p>
</td></tr>
<tr><td><code id="plotting_+3A_make.legend">make.legend</code></td>
<td>

<p>tbdmake.legend
</p>
</td></tr>
<tr><td><code id="plotting_+3A_legend.x">legend.x</code></td>
<td>

<p>tbdlegend.x
</p>
</td></tr>
<tr><td><code id="plotting_+3A_legend.title">legend.title</code></td>
<td>

<p>tbdlegend.title
</p>
</td></tr>
<tr><td><code id="plotting_+3A_legend.cex">legend.cex</code></td>
<td>

<p>tbdlegend.cex
</p>
</td></tr>
<tr><td><code id="plotting_+3A_draw.x.axis">draw.x.axis</code></td>
<td>

<p>tbddraw.x.axis
</p>
</td></tr>
<tr><td><code id="plotting_+3A_bg">bg</code></td>
<td>

<p>tbdbg
</p>
</td></tr>
<tr><td><code id="plotting_+3A_method">method</code></td>
<td>

<p>tbdmethod
</p>
</td></tr>
<tr><td><code id="plotting_+3A_mfrow">mfrow</code></td>
<td>

<p>tbdmfrow
</p>
</td></tr>
<tr><td><code id="plotting_+3A_mfcol">mfcol</code></td>
<td>

<p>tbdmfcol
</p>
</td></tr>
<tr><td><code id="plotting_+3A_width">width</code></td>
<td>

<p>tbdwidth
</p>
</td></tr>
<tr><td><code id="plotting_+3A_height">height</code></td>
<td>

<p>tbdheight
</p>
</td></tr>
<tr><td><code id="plotting_+3A_oma">oma</code></td>
<td>

<p>tbdoma
</p>
</td></tr>
<tr><td><code id="plotting_+3A_mar">mar</code></td>
<td>

<p>tbdmar
</p>
</td></tr>
<tr><td><code id="plotting_+3A_main.outer">main.outer</code></td>
<td>

<p>tbdmain.outer
</p>
</td></tr>
<tr><td><code id="plotting_+3A_save2file">save2file</code></td>
<td>

<p>tbdsave2file
</p>
</td></tr>
<tr><td><code id="plotting_+3A_y">y</code></td>
<td>

<p>tbdy
</p>
</td></tr>
<tr><td><code id="plotting_+3A_digits">digits</code></td>
<td>

<p>tbddigits
</p>
</td></tr>
<tr><td><code id="plotting_+3A_prefix">prefix</code></td>
<td>

<p>tbdprefix
</p>
</td></tr>
<tr><td><code id="plotting_+3A_cex.cor">cex.cor</code></td>
<td>

<p>cex cor
</p>
</td></tr>
<tr><td><code id="plotting_+3A_plot.labels">plot.labels</code></td>
<td>
<p>Boolean</p>
</td></tr>
<tr><td><code id="plotting_+3A_order">order</code></td>
<td>
<p>Boolean</p>
</td></tr>
<tr><td><code id="plotting_+3A_decreasing">decreasing</code></td>
<td>
<p>Boolean</p>
</td></tr>
<tr><td><code id="plotting_+3A_add.diagonal.line">add.diagonal.line</code></td>
<td>

<p>tbdadd.diagonal.line
</p>
</td></tr>
<tr><td><code id="plotting_+3A_x2">x2</code></td>
<td>

<p>tbdadd.diagonal.line
</p>
</td></tr>
<tr><td><code id="plotting_+3A_vline">vline</code></td>
<td>

<p>tbdadd.diagonal.line
</p>
</td></tr>
<tr><td><code id="plotting_+3A_cols">cols</code></td>
<td>

<p>tbdadd.diagonal.line
</p>
</td></tr>
<tr><td><code id="plotting_+3A_na.action">na.action</code></td>
<td>

<p>tbdadd.diagonal.line
</p>
</td></tr>
<tr><td><code id="plotting_+3A_drop.unused.levels">drop.unused.levels</code></td>
<td>

<p>tbdadd.diagonal.line
</p>
</td></tr>
<tr><td><code id="plotting_+3A_p.val">p.val</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="plotting_+3A_seed">seed</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="plotting_+3A_paired">paired</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="plotting_+3A_show.data.cloud">show.data.cloud</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="plotting_+3A_ladder.add.line">ladder.add.line</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="plotting_+3A_ladder.add.text">ladder.add.text</code></td>
<td>

<p>tbdx
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>myboxplot shows data points along with boxes. The data poins are jittered and the pattern of jittering is made reproducible in repeated calls. The test can only take one type of test currently.
</p>
<p>myforestplot is modified from code from Allan deCamp/SCHARP.
dat should have three columns. first column should be point estimate, second and third lci and uci, fourth p value. 
col.1 is the color used for CIs that do not include null, col.2 is used for CIs that do include null.
If order is TRUE, the rows are ordered by the first column of dat. descreasing can be used to change the behavior of order.
</p>
<p>corplot.formula uses MethComp::Deming by Bendix Carstensen to fit Deming regression.
</p>
<p>wtd.hist is copied from weights package, author: Josh Pasek.
</p>
<p>mymatplot will use na.approx (zoo) to fill in NA before plotting in order to draw continuous lines. The filled-in values will not be shown as points.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1)
x=1:50+rnorm(50,0,4)
y=1:50+rnorm(50,0,4)
dat=data.frame(x, y)
corplot(y~x,dat,add.lm.fit=TRUE,add.deming.fit=TRUE,col.lm="red",col.deming="blue")

dat=data.frame(y=c(1:10,2:11), x=rep(c("a","b"),each=10), ptid=c(1:10,1:10))
par(mfrow=c(1,2))
myboxplot(y~x, dat, test="w", jitter=FALSE)
myboxplot(y~x, dat, test="f", add.interaction=TRUE, reshape.formula=y~x, reshape.id="ptid")


myboxplot(list(jitter(1:10), jitter(3:12)), test="w")
myboxplot(list(jitter(1:10), jitter(3:12)), test="w", paired=TRUE)

## Not run: 
myfigure(mfrow=c(1,2))
    plot(1:10)
    plot(1:10)
mydev.off(ext="png,pdf", file="tmp")

## End(Not run)



#myboxplot x axis may look weird if log="xy"

</code></pre>

<hr>
<h2 id='print.functions'>
Print Functions
</h2><span id='topic+myprint'></span><span id='topic+myprint.default'></span><span id='topic+myprint.matrix'></span><span id='topic+formatInt'></span><span id='topic+formatDouble'></span><span id='topic+make.latex.coef.table'></span><span id='topic+mytex'></span><span id='topic+mytex.begin'></span><span id='topic+mytex.end'></span><span id='topic+mywrite'></span><span id='topic+mywrite.csv'></span><span id='topic+roundup'></span><span id='topic+mysanitize.numbers'></span><span id='topic+mysanitize.text'></span>

<h3>Description</h3>

<p>roundup prints a specified number of digits after decimal point even if 0s are needed at the end. 
formatInt prints a specified number of digits before decimal point even if 0s are needed at the beginning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
myprint(object, ...)

## Default S3 method:
myprint(..., newline = TRUE, digits = 3, print.name=TRUE)

## S3 method for class 'matrix'
myprint(object, ...)

formatInt(x, digits, fill = "0", ...)

make.latex.coef.table(models, model.names = NULL, row.major = FALSE, round.digits = NULL)

mysanitize.text(str) 
mysanitize.numbers(x) 

mytex(dat = NULL, file.name = "temp", digits = NULL, display
                 = NULL, align = "r", include.rownames = TRUE,
                 include.colnames = TRUE, col.headers = NULL, comment =
                 FALSE, floating = FALSE, lines = TRUE, hline.after =
                 NULL, add.to.row = NULL, sanitize.text.function =
                 NULL, append = FALSE, preamble = "", input.foldername
                 = NULL, save2input.only = NULL, caption = NULL, label
                 = paste("tab", last(strsplit(file.name, "/")[[1]]),
                 sep = " "), table.placement = "h!",
                 add.clear.page.between.tables = FALSE, longtable =
                 FALSE, verbose = FALSE, silent = TRUE, ...)

mytex.begin(file.name, preamble = "")

mytex.end(file.name)

mywrite(x, ...)

mywrite.csv(x, file = "tmp", row.names = FALSE, digits = NULL,
                 silent = TRUE, ...)

roundup (value, digits, na.to.empty=TRUE, remove.leading0=TRUE) 

formatDouble(value, digits, na.to.empty=TRUE, remove.leading0=TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.functions_+3A_silent">silent</code></td>
<td>

<p>tbdnewline
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_input.foldername">input.foldername</code></td>
<td>

<p>tbdnewline
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_object">object</code></td>
<td>

<p>tbdnewline
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_newline">newline</code></td>
<td>

<p>tbdnewline
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_print.name">print.name</code></td>
<td>

<p>tbddigits
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_save2input.only">save2input.only</code></td>
<td>
<p>Boolean</p>
</td></tr>
<tr><td><code id="print.functions_+3A_include.colnames">include.colnames</code></td>
<td>
<p>Boolean</p>
</td></tr>
<tr><td><code id="print.functions_+3A_col.headers">col.headers</code></td>
<td>
<p>string. Column headers</p>
</td></tr>
<tr><td><code id="print.functions_+3A_comment">comment</code></td>
<td>
<p>Boolean, whether to include the version and timestamp comment</p>
</td></tr>
<tr><td><code id="print.functions_+3A_hline.after">hline.after</code></td>
<td>
<p>vector</p>
</td></tr>
<tr><td><code id="print.functions_+3A_add.to.row">add.to.row</code></td>
<td>
<p>a list</p>
</td></tr>
<tr><td><code id="print.functions_+3A_sanitize.text.function">sanitize.text.function</code></td>
<td>
<p>a function</p>
</td></tr>
<tr><td><code id="print.functions_+3A_str">str</code></td>
<td>

<p>tbdvalue
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_remove.leading0">remove.leading0</code></td>
<td>

<p>tbdvalue
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_caption">caption</code></td>
<td>

<p>tbdvalue
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_longtable">longtable</code></td>
<td>

<p>tbdvalue
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_label">label</code></td>
<td>
<p> default to be the same as file.name stem
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_table.placement">table.placement</code></td>
<td>

<p>tbdvalue
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_na.to.empty">na.to.empty</code></td>
<td>

<p>tbdvalue
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_value">value</code></td>
<td>

<p>tbdvalue
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_digits">digits</code></td>
<td>

<p>tbddigits
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_fill">fill</code></td>
<td>

<p>tbdfill
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_models">models</code></td>
<td>

<p>tbdmodels
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_model.names">model.names</code></td>
<td>

<p>tbdmodel.names
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_row.major">row.major</code></td>
<td>

<p>tbdrow.major
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_round.digits">round.digits</code></td>
<td>

<p>tbdround.digits
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_dat">dat</code></td>
<td>

<p>tbddat
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_file.name">file.name</code></td>
<td>

<p>tbdfile.name
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_display">display</code></td>
<td>

<p>tbddisplay
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_align">align</code></td>
<td>

<p>tbdalign
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_append">append</code></td>
<td>

<p>tbdappend
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_preamble">preamble</code></td>
<td>

<p>tbdpreamble
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_include.rownames">include.rownames</code></td>
<td>

<p>tbdinclude.rownames
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_floating">floating</code></td>
<td>

<p>tbdfloating
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_lines">lines</code></td>
<td>

<p>tbdlines
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_...">...</code></td>
<td>

<p>tbd...
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_verbose">verbose</code></td>
<td>

<p>tbd...
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_file">file</code></td>
<td>

<p>tbdfile
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_row.names">row.names</code></td>
<td>

<p>tbdrow.names
</p>
</td></tr>
<tr><td><code id="print.functions_+3A_add.clear.page.between.tables">add.clear.page.between.tables</code></td>
<td>

<p>tbdrow.names
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
roundup (3.1, 2) # 3.10

formatInt(3, 2) # 03


## Not run:  

# demo of dimnames
tab=diag(1:4); rownames(tab)&lt;-colnames(tab)&lt;-1:4; names(dimnames(tab))=c("age","height")
# for greek letter in the labels, we need sanitize.text.function=identity
rownames(tab)[1]="$\alpha$"
# note that to use caption, floating needs to be TRUE
mytex (tab, file="tmp1", sanitize.text.function=identity, 
    caption="This is a caption .........................", caption.placement="top",
    floating=TRUE)

# col.headers has to have the RIGHT number of columns 
# but align is more flexible, may not need to include the rownames col
tab=diag(1:4); rownames(tab)&lt;-colnames(tab)&lt;-1:4
mytex (tab, file="tmp", include.rownames = TRUE, 
    align=c("c","c","c|","c","c"), col.headers=
    "\hline\n &amp; \multicolumn{2}{c|}{Vaccine} &amp; \multicolumn{2}{c}{Control} \\ \n")
# not include rownames
mytex (tab, file="tmp", include.rownames = FALSE, 
    align=c("c","c","c|","c","c"), col.headers=
    "\hline\n     \multicolumn{2}{c|}{Vaccine} &amp; \multicolumn{2}{c}{Control} \\ \n") 
# It should work even if some rownames are duplicated
tab=diag(1:4); rownames(tab)=rep(1,4); colnames(tab)&lt;-1:4
mytex (tab, file="tmp", include.rownames = TRUE, 
    align=c("c","c|","c","c"), col.headers=
    "\hline\n &amp; \multicolumn{2}{c|}{Vaccine} &amp; \multicolumn{2}{c}{Control} \\ \n") 


# add.to.rows
tab=diag(1:4); rownames(tab)&lt;-1:4; colnames(tab)&lt;-c("a","b","c","d")
mytex (tab, file="tmp",
    add.to.row=list( list(0,2),
        c("          \multicolumn{5}{l}{Heading 1} \\ \n",
          "\hline\n \multicolumn{5}{l}{Heading 2}\\ \n"
    ))
)



## End(Not run)



</code></pre>

<hr>
<h2 id='random.functions'>
Random Functions
</h2><span id='topic+dbern'></span><span id='topic+rbigamma'></span><span id='topic+rbilogistic'></span><span id='topic+dcorbern'></span><span id='topic+dmixnorm'></span><span id='topic+dnorm.norm.gamma'></span><span id='topic+rbern'></span><span id='topic+rejective.sampling'></span><span id='topic+rnorm.ar'></span><span id='topic+rmixnorm'></span><span id='topic+rnorm.norm.gamma'></span><span id='topic+rdoublexp'></span><span id='topic+ddoublexp'></span><span id='topic+qdoublexp'></span><span id='topic+pdoublexp'></span><span id='topic+rbidoublexp'></span>

<h3>Description</h3>

<p>Generate samples from random variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
dbern(x, prob, log = FALSE)

dcorbern(x, p, a, log = FALSE)

dmixnorm(x, mix.p, sd1, sd2, log = FALSE)

dnorm.norm.gamma(x, p, same.distr = FALSE, log = FALSE)

rbern(n, prob, generalized = FALSE)

rbigamma(n, shape.1, shape.2, rate.1, rate.2, rho)

rbilogistic(n, loc.1, loc.2, scale.1, scale.2, rho) 

rejective.sampling(N, n, pik)

rnorm.ar(n, sd, rho)

rnorm.norm.gamma(n, mu.0, lambda, alpha, beta)

rmixnorm (n, mix.p, mu1, mu2, sd1, sd2)

rdoublexp(n, location=0, scale=1) 
ddoublexp(x, location=0, scale=1) 
qdoublexp(p, location=0, scale=1) 
pdoublexp(q, location=0, scale=1) 

rbidoublexp(n, loc.1, loc.2, scale.1, scale.2, rho) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="random.functions_+3A_q">q</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_location">location</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_scale">scale</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_prob">prob</code></td>
<td>

<p>tbdprob
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_log">log</code></td>
<td>

<p>tbdlog
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_p">p</code></td>
<td>

<p>tbdp
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_a">a</code></td>
<td>

<p>tbda
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_mix.p">mix.p</code></td>
<td>

<p>tbdmix.p
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_sd1">sd1</code></td>
<td>

<p>tbdsd1
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_sd2">sd2</code></td>
<td>

<p>tbdsd2
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_same.distr">same.distr</code></td>
<td>

<p>tbdsame.distr
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_n">n</code></td>
<td>

<p>tbdn
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_generalized">generalized</code></td>
<td>

<p>tbdgeneralized
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_n">N</code></td>
<td>

<p>tbdN
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_pik">pik</code></td>
<td>

<p>tbdpik
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_mu">mu</code></td>
<td>

<p>tbdmu
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_mu1">mu1</code></td>
<td>

<p>tbdmu
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_mu2">mu2</code></td>
<td>

<p>tbdmu
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_sd">sd</code></td>
<td>

<p>tbdsd
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_alpha">alpha</code></td>
<td>

<p>tbdalpha
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_mu.0">mu.0</code></td>
<td>

<p>tbdmu.0
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_lambda">lambda</code></td>
<td>

<p>tbdlambda
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_beta">beta</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_loc.1">loc.1</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_loc.2">loc.2</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_scale.1">scale.1</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_scale.2">scale.2</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_rate.1">rate.1</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_rate.2">rate.2</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_shape.1">shape.1</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_shape.2">shape.2</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
<tr><td><code id="random.functions_+3A_rho">rho</code></td>
<td>

<p>tbdbeta
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>rbern generates Bernoulli random variables.<br />
rbilogistic generates a bivariate logistic distribution for correlation coefficient 0.5, or [-0.271, 0.478]. <br />
In the former case it is generated by calling <code>rbilogis</code>, part of the VGAM package; in the latter case it is generated via the AMH copular.<br />
rnorm.ar simulate autoregressive normal random variables, correlation is rho^d between x_1 and x_(1+d)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1)
rbern(n=10, p=1/2)
rbern(n=2, p=c(.999,.001))

## Not run: 
tmp=replicate(1e4, rnorm.cor(10, 1, .81))
round(cor(t(tmp)),2)

## End(Not run)
</code></pre>

<hr>
<h2 id='regression.model.functions'>
Regression Model Functions
</h2><span id='topic+coef.geese'></span><span id='topic+coef.tps'></span><span id='topic+getFixedEf'></span><span id='topic+getFixedEf.coxph'></span><span id='topic+getFixedEf.gam'></span><span id='topic+getFixedEf.tps'></span><span id='topic+getFixedEf.gee'></span><span id='topic+getFixedEf.geese'></span><span id='topic+getFixedEf.glm'></span><span id='topic+getFixedEf.svyglm'></span><span id='topic+getFixedEf.svy_vglm'></span><span id='topic+getFixedEf.svycoxph'></span><span id='topic+getFixedEf.inla'></span><span id='topic+getFixedEf.lm'></span><span id='topic+getFixedEf.glmerMod'></span><span id='topic+getFixedEf.merMod'></span><span id='topic+getVarComponent.glmerMod'></span><span id='topic+getVarComponent.mer'></span><span id='topic+getVarComponent.merMod'></span><span id='topic+getFixedEf.lmerMod'></span><span id='topic+getFixedEf.lme'></span><span id='topic+getFixedEf.logistf'></span><span id='topic+getFixedEf.matrix'></span><span id='topic+getFixedEf.mer'></span><span id='topic+getFixedEf.MIresult'></span><span id='topic+getFixedEf2'></span><span id='topic+getFormattedSummary'></span><span id='topic+getVarComponent'></span><span id='topic+getVarComponent.hyperpar.inla'></span><span id='topic+getVarComponent.matrix'></span><span id='topic+getVarComponent.lmerMod'></span><span id='topic+interaction.table'></span><span id='topic+predict.geese'></span><span id='topic+predict.tps'></span><span id='topic+residuals.geese'></span><span id='topic+vcov.geese'></span><span id='topic+vcov.tps'></span><span id='topic+vcov.logistf'></span><span id='topic+risk.cal'></span>

<h3>Description</h3>

<p>getFormattedSummary prints a table of regression coefficient estimates and standard errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
getFormattedSummary(fits, type = 12, est.digits = 2, se.digits = 2,
 robust, random = FALSE, VE = FALSE, to.trim = FALSE,
 rows = NULL, coef.direct = FALSE, trunc.large.est =
 TRUE, scale.factor = 1, p.digits = 3, remove.leading0
 = FALSE, p.adj.method = "fdr", ...)

getVarComponent(object, ...)

getFixedEf(object, ...)

risk.cal(risk, binary.outcome, weights = NULL, ngroups = NULL, 
    cuts = NULL, main = "", add = FALSE, show.emp.risk = TRUE, 
    lcol = 2, ylim = NULL, scale = c("logit", "risk"))
interaction.table(fit, v1, v2, v1.type = "continuous", v2.type = "continuous",
logistic.regression = TRUE)


## S3 method for class 'coxph'
getFixedEf(object, exp=FALSE,robust=FALSE, ...)

## S3 method for class 'gam'
getFixedEf(object, ...)

## S3 method for class 'gee'
getFixedEf(object, exp = FALSE, ...)

## S3 method for class 'geese'
getFixedEf(object, robust = TRUE, ...)
## S3 method for class 'tps'
getFixedEf(object, exp=FALSE, robust=TRUE, ...)

## S3 method for class 'glm'
 getFixedEf(object, exp = FALSE, robust = TRUE, ret.robcov = FALSE, 
    ...)  

## S3 method for class 'svyglm'
 getFixedEf(object, exp = FALSE, robust = TRUE, ...)  
## S3 method for class 'svy_vglm'
 getFixedEf(object, exp = FALSE, robust = TRUE, ...)  

## S3 method for class 'svycoxph'
 getFixedEf(object, exp = FALSE, robust = TRUE, ...)  

## S3 method for class 'inla'
getFixedEf(object, ...)

## S3 method for class 'lm'
getFixedEf(object, ...)

## S3 method for class 'lme'
getFixedEf(object, ...)

## S3 method for class 'logistf'
getFixedEf(object, exp = FALSE, ...)

## S3 method for class 'matrix'
getFixedEf(object, ...)

## S3 method for class 'MIresult'
getFixedEf(object, ...)

## S3 method for class 'hyperpar.inla'
getVarComponent(object, transformation = NULL, ...)

## S3 method for class 'matrix'
getVarComponent(object, ...)

## S3 method for class 'geese'
coef(object, ...)
## S3 method for class 'tps'
coef(object, ...)

## S3 method for class 'geese'
predict(object, x, ...)
## S3 method for class 'tps'
predict(object, newdata = NULL, type = c("link", "response"), ...)

## S3 method for class 'geese'
residuals(object, y, x,...)

## S3 method for class 'geese'
vcov(object, ...)
## S3 method for class 'tps'
vcov(object, robust, ...)

## S3 method for class 'logistf'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regression.model.functions_+3A_...">...</code></td>
<td>

<p>tbd...
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_object">object</code></td>
<td>

<p>tbdobject
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_fit">fit</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_coef.direct">coef.direct</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_robust">robust</code></td>
<td>
<p>Boolean, whether to return robust variance estimate
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_exp">exp</code></td>
<td>

<p>tbdexp
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_remove.leading0">remove.leading0</code></td>
<td>

<p>tbdexp
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_p.adj.method">p.adj.method</code></td>
<td>

<p>tbdexp
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_cuts">cuts</code></td>
<td>

<p>tbdfits
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_ret.robcov">ret.robcov</code></td>
<td>

<p>tbdfits
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_fits">fits</code></td>
<td>

<p>tbdfits
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_type">type</code></td>
<td>

<p>tbdtype
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_est.digits">est.digits</code></td>
<td>

<p>tbdest.digits
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_se.digits">se.digits</code></td>
<td>

<p>tbdse.digits
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_p.digits">p.digits</code></td>
<td>

<p>tbdse.digits
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_random">random</code></td>
<td>

<p>tbdrandom
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_ve">VE</code></td>
<td>

<p>tbdrandom
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_transformation">transformation</code></td>
<td>

<p>tbdtransformation
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_weights">weights</code></td>
<td>

<p>tbdv1
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_v1">v1</code></td>
<td>

<p>tbdv1
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_v2">v2</code></td>
<td>

<p>tbdv2
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_v1.type">v1.type</code></td>
<td>

<p>tbdv1.type
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_v2.type">v2.type</code></td>
<td>

<p>tbdv2.type
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_logistic.regression">logistic.regression</code></td>
<td>

<p>tbdlogistic.regression
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_newdata">newdata</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_y">y</code></td>
<td>

<p>tbdy
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_to.trim">to.trim</code></td>
<td>

<p>tbdy
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_rows">rows</code></td>
<td>

<p>tbdy
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_risk">risk</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_binary.outcome">binary.outcome</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_ngroups">ngroups</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_main">main</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_add">add</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_show.emp.risk">show.emp.risk</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_lcol">lcol</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_ylim">ylim</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_scale">scale</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_trunc.large.est">trunc.large.est</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
<tr><td><code id="regression.model.functions_+3A_scale.factor">scale.factor</code></td>
<td>

<p>tbdfit
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>getFormattedSummary: from a list of fits, say lmer, inla fits, return formatted summary controlled by &quot;type&quot;. For a matrix, return Monte Carlo variance
random=TRUE returns variance components
type=1: est
type=2: est (se)
type=3: est (2.5 percent, 97.5 percent)
type=4: est   se
</p>
<p>getFixedEf returns a matrix, first column coef, second column se, 
</p>
<p>getFixedEf.matrix used to get mean and sd from a jags or winbugs sample, getVarComponent.matrix and getFixedEf.matrix do the same thing. Each column of samples is a variable
</p>
<p>interaction.table expects coef and vcov to work with fit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
## Page 9: Plant Weight Data.
ctl &lt;- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt &lt;- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group &lt;- gl(2, 10, 20, labels = c("Ctl","Trt"))
weight &lt;- c(ctl, trt)
lm.D9 &lt;- lm(weight ~ group)
glm.D9 &lt;- glm(weight ~ group)
getFormattedSummary (list(lm.D9, glm.D9), robust=FALSE)

</code></pre>

<hr>
<h2 id='roc'>ROC and AUC</h2><span id='topic+computeRoc'></span><span id='topic+fastauc'></span><span id='topic+plotRoc'></span><span id='topic+addRoc'></span><span id='topic+classification.error'></span>

<h3>Description</h3>

<p>ROC/AUC methods.
<code>fastauc</code> calculates the AUC using a sort operation, instead of summing over pairwise differences in R. <br />
<code>computeRoc</code> computes an ROC curve. <br />
<code>plotRoc</code> plots an ROC curve. <br />
<code>addRoc</code> adds an ROC curve to a plot. <br />
<code>classification.error</code> computes classification error <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastauc (score, outcome, t0 = 0, t1 = 1, reverse.sign.if.nece = TRUE, quiet = FALSE)
computeRoc (score, outcome, reverse.sign.if.nece = TRUE, cutpoints
         = NULL)
plotRoc(x, add = FALSE, type = "l", diag.line=TRUE,...)
addRoc (x,...)
classification.error(score, outcome, threshold=NULL, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roc_+3A_score">score</code></td>
<td>
<p>a vector. Linear combination or score.</p>
</td></tr>
<tr><td><code id="roc_+3A_outcome">outcome</code></td>
<td>
<p>a vector of 0 and 1. Outcome.</p>
</td></tr>
<tr><td><code id="roc_+3A_t0">t0</code></td>
<td>
<p>a number between 0 and 1 that is the lower boundary of pAUC</p>
</td></tr>
<tr><td><code id="roc_+3A_t1">t1</code></td>
<td>
<p>a number between 0 and 1 that is the upper boundary of pAUC</p>
</td></tr>
<tr><td><code id="roc_+3A_reverse.sign.if.nece">reverse.sign.if.nece</code></td>
<td>
<p>a boolean. If TRUE, score is multiplied by -1 if AUC is less than 0.5.</p>
</td></tr>
<tr><td><code id="roc_+3A_x">x</code></td>
<td>
<p>a list of two elements: sensitivity and specificity.</p>
</td></tr>
<tr><td><code id="roc_+3A_diag.line">diag.line</code></td>
<td>
<p>boolean. If TRUE, a diagonal line is plotted</p>
</td></tr>
<tr><td><code id="roc_+3A_add">add</code></td>
<td>
<p>boolean. If TRUE, add to existing plot. If FALSE, create a new plot.</p>
</td></tr>
<tr><td><code id="roc_+3A_quiet">quiet</code></td>
<td>
<p>boolean</p>
</td></tr>
<tr><td><code id="roc_+3A_cutpoints">cutpoints</code></td>
<td>
<p>cutpoints</p>
</td></tr>
<tr><td><code id="roc_+3A_threshold">threshold</code></td>
<td>
<p>threshold</p>
</td></tr>
<tr><td><code id="roc_+3A_verbose">verbose</code></td>
<td>
<p>boolean</p>
</td></tr>
<tr><td><code id="roc_+3A_type">type</code></td>
<td>
<p>line type for <code>lines</code></p>
</td></tr>
<tr><td><code id="roc_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>plot</code> or <code>lines</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions originally come from Thomas Lumley and Tianxi Cai et al.<br />
</p>


<h3>Value</h3>

<p><code>computeRoc</code> returns a list of sensitivity and specificity. <br />
<code>plotRoc</code>  and <code>addRoc</code> plots ROC curves.<br />
</p>


<h3>Author(s)</h3>

<p>Shuxin Yin <br />
Youyi Fong <a href="mailto:youyifong@gmail.com">youyifong@gmail.com</a><br />
Krisztian Sebestyen <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n=1e2
score=c(rnorm(n/2,1), rnorm(n/2,0))
outcome=rep(1:0, each=n/2)
# cannot print due to r cmd check
#plotRoc(computeRoc(score, outcome))

# commented out b/c slower on pc and cause note when r cmd check
## test, fastauc2 is a version without all the checking
#score=rnorm(1e5)
#outcome=rbinom(1e5,1,.5)
#system.time(for (i in 1:1e2) fastauc(score,outcome)) # 4.9 sec
#system.time(for (i in 1:1e2) fastauc2(score,outcome)) # 3.8 sec


</code></pre>

<hr>
<h2 id='sim.dat.tvarying.two'>
Simulation Functions for Time-dependent Proportional Hazard Model
</h2><span id='topic+sim.dat.tvarying.two'></span><span id='topic+sim.dat.tvarying.three'></span>

<h3>Description</h3>

<p>sim.dat.tvarying.three simulates from a model with time varing age group variale of three levels, sim.dat.tvarying.two two.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.dat.tvarying.three(n, followup.length, incidence.density, 
    age.sim = c("tvaryinggroup", "baselinegroup", "continuous","bt"),
    random.censoring.rate = 0.05, seed)
    
sim.dat.tvarying.two(n, followup.length, incidence.density, 
    age.sim = c("tvaryinggroup", "baselinegroup", "continuous","bt"), 
    random.censoring.rate = 0.05, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.dat.tvarying.two_+3A_n">n</code></td>
<td>

<p>integer. Sample size.</p>
</td></tr>
<tr><td><code id="sim.dat.tvarying.two_+3A_followup.length">followup.length</code></td>
<td>

<p>numeric. Length of followup, in years.
</p>
</td></tr>
<tr><td><code id="sim.dat.tvarying.two_+3A_incidence.density">incidence.density</code></td>
<td>

<p>numeric. Incidence rate per year.
</p>
</td></tr>
<tr><td><code id="sim.dat.tvarying.two_+3A_age.sim">age.sim</code></td>
<td>

<p>string. Choose between one of three possibilities. tvaryinggroup: age group is time-varying covariate; baselinegroup: age group is a baseline covariate; continuous: age is a continuous covariate; bt: age group by treatment interaction uses baseline age group, while age group main effect uses time-dependent age group
</p>
</td></tr>
<tr><td><code id="sim.dat.tvarying.two_+3A_random.censoring.rate">random.censoring.rate</code></td>
<td>

<p>numeric. Amount of random censoring.
</p>
</td></tr>
<tr><td><code id="sim.dat.tvarying.two_+3A_seed">seed</code></td>
<td>

<p>integer. Random number generator seed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In sim.dat.tvarying.three, baseline age is uniformly distributed between 2.0 and 16.0, and divivded into three groups at 6 and 12.
In sim.dat.tvarying.two, baseline age is uniformly distributed between 2.0 and 12.0, and divivded into two groups at 6.
</p>


<h3>Value</h3>

<p>Return a data frame with the following columns:
</p>
<table>
<tr><td><code>ptid</code></td>
<td>
<p>subject identifier</p>
</td></tr>
<tr><td><code>trt</code></td>
<td>
<p>treatment indicator 0/1</p>
</td></tr>
<tr><td><code>for.non.tvarying.ana</code></td>
<td>
<p>Boolean, used to subset dataset for non-time dependent analysis</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>censoring time</p>
</td></tr>
<tr><td><code>baseline.age</code></td>
<td>
<p>age years at baseline</p>
</td></tr>
<tr><td><code>agegrp</code></td>
<td>
<p>a factor with levels <code>[0,6)</code> <code>[6,12)</code> <code>[12,100)</code></p>
</td></tr>
<tr><td><code>baseline.agegrp</code></td>
<td>
<p>a factor with levels <code>[0,6)</code> <code>[6,12)</code> <code>[12,100)</code></p>
</td></tr>
<tr><td><code>tstart</code></td>
<td>
<p>left bound of time interval</p>
</td></tr>
<tr><td><code>tstop</code></td>
<td>
<p>right bound of time interval</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>event indicator</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>followup time, in years</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Youyi Fong
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.timedep.dataset">make.timedep.dataset</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(survival)

dat=sim.dat.tvarying.three(n=6000,followup.length=3, incidence.density=0.05, 
    age.sim="tvaryinggroup", seed=1)
f.tvarying = Surv(tstart,tstop,d) ~ trt*agegrp 
f =          Surv(X,d)            ~ trt*baseline.agegrp 
fits=list()
fits[["tvarying"]]=coxph(f.tvarying, dat)
fits[["baseline"]]=coxph(f, subset(dat, for.non.tvarying.ana))
fits







</code></pre>

<hr>
<h2 id='stat.functions'>
Stat Functions
</h2><span id='topic+stat.functions'></span><span id='topic+mutual.info'></span><span id='topic+H'></span><span id='topic+cor.mixed'></span><span id='topic+cor.mixed.default'></span><span id='topic+cor.mixed.vector'></span><span id='topic+cor.mixed.formula'></span><span id='topic+info.cor'></span><span id='topic+yule.y'></span><span id='topic+kappacor'></span><span id='topic+l.measure'></span><span id='topic+skew'></span>

<h3>Description</h3>

<p>H calculates entropy. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
H(p, logbase = c("e", "2"))

mutual.info(two.way.table, logbase = c("e", "2"))

cor.mixed(x, ...)

## Default S3 method:
 cor.mixed(x, na.fun, method=c("pearson","spearman"), ...)
## S3 method for class 'vector'
 cor.mixed(x, y, na.fun, method=c("pearson","spearman"), ...) 
## S3 method for class 'formula'
 cor.mixed(formula, data, na.fun, method=c("pearson","spearman"), ...) 

skew (x, na.rm = FALSE) 

info.cor(two.way.table)

yule.y(two.by.two.matrix)

kappacor(two.by.two.matrix, weight = c(1, 1), maximum = FALSE)

l.measure(two.by.two.matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat.functions_+3A_p">p</code></td>
<td>

<p>either a count vector or a probability vector, but can not be a vector of membership indicator
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_logbase">logbase</code></td>
<td>

<p>tbdlogbase
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_na.rm">na.rm</code></td>
<td>

<p>tbdlogbase
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_two.way.table">two.way.table</code></td>
<td>

<p>tbdtwo.way.table
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_...">...</code></td>
<td>

<p>tbd...
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_na.fun">na.fun</code></td>
<td>

<p>tbdna.fun
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_method">method</code></td>
<td>

<p>tbdmethod
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_y">y</code></td>
<td>

<p>tbdy
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_formula">formula</code></td>
<td>

<p>tbdformula
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_data">data</code></td>
<td>

<p>tbddata
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_two.by.two.matrix">two.by.two.matrix</code></td>
<td>

<p>tbdtwo.by.two.matrix
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_weight">weight</code></td>
<td>

<p>tbdweight
</p>
</td></tr>
<tr><td><code id="stat.functions_+3A_maximum">maximum</code></td>
<td>

<p>tbdmaximum
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>H(rep(1/5,5))
H(rep(3,5))
</code></pre>

<hr>
<h2 id='string.functions'>String Functions</h2><span id='topic+string.functions'></span><span id='topic++25.+25'></span><span id='topic+contain'></span><span id='topic+escapeUnderline'></span><span id='topic+fileStem'></span><span id='topic+firstIndex'></span><span id='topic+getExt'></span><span id='topic+getFileStem'></span><span id='topic+getStem'></span><span id='topic+lastIndex'></span><span id='topic+remove.prefix'></span><span id='topic+trim'></span>

<h3>Description</h3>

<p> %+% concatenates its arguments and returns a string.</p>


<h3>Usage</h3>

<pre><code class='language-R'>

a %.% b

contain(s1, s2)
trim (x, trim.trailing=TRUE, trim.leading=TRUE)  

escapeUnderline(name)

fileStem(file.name)

firstIndex(s1, s2)

getExt(file.name)

getFileStem(file.name)

getStem(file.name)

lastIndex(s1, s2)

remove.prefix(s, sep = "_")

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="string.functions_+3A_a">a</code></td>
<td>

<p>a
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_b">b</code></td>
<td>

<p>b
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_s1">s1</code></td>
<td>

<p>s1
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_s2">s2</code></td>
<td>

<p>s2
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_name">name</code></td>
<td>

<p>name
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_file.name">file.name</code></td>
<td>

<p>file.name
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_s">s</code></td>
<td>

<p>s
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_sep">sep</code></td>
<td>

<p>sep
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_x">x</code></td>
<td>

<p>sep
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_trim.leading">trim.leading</code></td>
<td>

<p>sep
</p>
</td></tr>
<tr><td><code id="string.functions_+3A_trim.trailing">trim.trailing</code></td>
<td>

<p>sep
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
x=1
x %.% "b" %.% "c"

</code></pre>

<hr>
<h2 id='testing.functions'>
Testing Functions
</h2><span id='topic+hosmerlem'></span><span id='topic+myfisher.test'></span><span id='topic+quick.t.test'></span><span id='topic+mycor.test'></span><span id='topic+signtest'></span><span id='topic+tukey.mtest'></span><span id='topic+vector.t.test'></span>

<h3>Description</h3>

<p>Testing functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
hosmerlem(y, yhat, g = 10)

quick.t.test(x, y, var.equal = FALSE)

signtest(x)

tukey.mtest(mu, ms, n)

vector.t.test(mean.x, mean.y, var.x, var.y, n)

myfisher.test(x,y,...)

mycor.test(x, method = c("pearson", "kendall", "spearman"), idx =
 NULL) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testing.functions_+3A_...">...</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_y">y</code></td>
<td>

<p>tbdy
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_yhat">yhat</code></td>
<td>

<p>tbdyhat
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_g">g</code></td>
<td>

<p>tbdg
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_x">x</code></td>
<td>

<p>tbdx
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_var.equal">var.equal</code></td>
<td>

<p>tbdvar.equal
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_method">method</code></td>
<td>

<p>tbdmethod
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_mu">mu</code></td>
<td>

<p>tbdmu
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_ms">ms</code></td>
<td>

<p>tbdms
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_n">n</code></td>
<td>

<p>tbdn
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_mean.x">mean.x</code></td>
<td>

<p>tbdmean.x
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_mean.y">mean.y</code></td>
<td>

<p>tbdmean.y
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_var.x">var.x</code></td>
<td>

<p>tbdvar.x
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_var.y">var.y</code></td>
<td>

<p>tbdvar.y
</p>
</td></tr>
<tr><td><code id="testing.functions_+3A_idx">idx</code></td>
<td>

<p>tbdvar.y
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
signtest(runif(10))
</code></pre>

<hr>
<h2 id='VEplot'>
Vaccine Efficacy Plots</h2><span id='topic+VEplot'></span><span id='topic+VEplot.cox.zph'></span><span id='topic+VEplot.glm'></span><span id='topic+myplot.cox.zph'></span>

<h3>Description</h3>

<p>Vaccine efficacy plots. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
VEplot (object, ...) 
 
## S3 method for class 'cox.zph'
 VEplot(object, resid = TRUE, se = TRUE, df = 4, nsmo = 40, 
    var, ylab="VE", xlab="Time", xaxt="s", cex.axis=1, ...) 

## S3 method for class 'glm'
VEplot(object, X1, X2, x, ...)

## S3 method for class 'cox.zph'
 myplot(object, resid = TRUE, se = TRUE, df = 4, nsmo = 40, var, 
    coef.transform=NULL, 
    ylab=NULL, 
    xlab="Time", xaxt="s", cex.axis=1, 
    ...) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VEplot_+3A_object">object</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="VEplot_+3A_resid">resid</code></td>
<td>
<p>Boolean, whether to plot residuals</p>
</td></tr>
<tr><td><code id="VEplot_+3A_se">se</code></td>
<td>
<p>Boolean, whether to plot confidence band</p>
</td></tr>
<tr><td><code id="VEplot_+3A_df">df</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code id="VEplot_+3A_nsmo">nsmo</code></td>
<td>
<p>number of points used to plot the fitted spline</p>
</td></tr>
<tr><td><code id="VEplot_+3A_var">var</code></td>
<td>
<p>estimated variance matrix from the Cox model fit</p>
</td></tr>
<tr><td><code id="VEplot_+3A_xlab">xlab</code></td>
<td>
<p>x label</p>
</td></tr>
<tr><td><code id="VEplot_+3A_xaxt">xaxt</code></td>
<td>
<p>x axis</p>
</td></tr>
<tr><td><code id="VEplot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>cex for axis</p>
</td></tr>
<tr><td><code id="VEplot_+3A_ylab">ylab</code></td>
<td>
<p>y label</p>
</td></tr>
<tr><td><code id="VEplot_+3A_coef.transform">coef.transform</code></td>
<td>
<p>a function to transform Cox hazard ratio estimate</p>
</td></tr>
<tr><td><code id="VEplot_+3A_x1">X1</code></td>
<td>
<p>a matrix of dimension k by p, where k is the length of x (see below) and p is the length of coef(object)</p>
</td></tr>
<tr><td><code id="VEplot_+3A_x2">X2</code></td>
<td>
<p>a matrix of dimension k by p, where k is the length of x (see below) and p is the length of coef(object)</p>
</td></tr>
<tr><td><code id="VEplot_+3A_x">x</code></td>
<td>
<p>a vector of length k that represents the x coordinate of the VE plot</p>
</td></tr>
<tr><td><code id="VEplot_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>VEplot and myplot.cox.zph are extensions of survival::plot.cox.zph to plot VE curve and other transformations.
</p>
<p>myplot.cox.zph adds the following parameters to the original list of parameters in plot.cox.zph:
coef.transform: a function to transform the coefficients
ylab: y axis label 
xlab: x axis label
</p>
<p>VEplot.glm computes a series of k VEs: for i in 1...k, VE[i] = P(Y=1|X1[i,])/P(Y=1|X2[i,]). It returns a 3 by k matrix, whose first row contains VE estimates and the second and third rows contain lower and upper bounds, respectively.
</p>


<h3>Author(s)</h3>

<p>Youyi Fong, Dennis Chao
</p>


<h3>References</h3>

<p>Durham, Longini, Halloran, Clemens, Azhar and Rao (1998) &quot;Estimation of vaccine efficacy in the presence of waning: application to cholera vaccines.&quot; American Journal of Epidemiology 147(10): 948-959.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(survival)
vfit &lt;- coxph(Surv(time,status) ~ trt + factor(celltype) + 
              karno + age, data=veteran, x=TRUE) 
temp &lt;- cox.zph(vfit) 

par(mfrow=c(2,2))
for (v in c("trt","age")) {
    VEplot(temp, var=v, resid=FALSE, main=v, ylab="VE", cex.axis=1.5)
    plot(temp, var=v, resid=FALSE, main=v)
}

library(survival)
fit &lt;- glm(status ~ trt + trt*age, data=veteran) 
summary(fit)
age=seq(min(veteran$age),max(veteran$age),length=10)
out = VEplot(fit, X1=cbind(1,1,age,1*age), X2=cbind(1,0,age,0*age), x=age)
out

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
