<!DOCTYPE html><html><head><title>Help for package braidrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {braidrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#braidrm-package'>
<p>Fitting Dose Response with the BRAID Combined Action Model</p></a></li>
<li><a href='#braidrm'>
<p>BRAID Synergy Dose-Response Modeling</p></a></li>
<li><a href='#calcBRAIDconfint'>
<p>Calculate General BRAID Confidence Intervals</p></a></li>
<li><a href='#es1data'><p>Results from Ewings-Sarcoma Experiments</p></a></li>
<li><a href='#es1plates'><p>Plate Information from Ewings-Sarcoma Experiments</p></a></li>
<li><a href='#es8olatmz'><p>Results from Ewings-Sarcoma Experiments</p></a></li>
<li><a href='#evalBRAIDrsm'><p> Calculate BRAID Surface Values</p></a></li>
<li><a href='#evalHillEqn'>
<p>Calculate and Invert Hill Equation</p></a></li>
<li><a href='#findBestBRAID'><p> Select Best Fitting BRAID Surface Model</p></a></li>
<li><a href='#findBestHill'>
<p>Fit Hill Model with Model Selection</p></a></li>
<li><a href='#getBRAIDbootstrap'>
<p>Bootstrap BRAID Parameter Confidence Intervals</p></a></li>
<li><a href='#getHillBootstrap'>
<p>Bootstrap Hill Equation Parameter Confidence Intervals</p></a></li>
<li><a href='#hillConcCorrect'>
<p>Hill-Based Concentration Correction</p></a></li>
<li><a href='#invertBRAIDrsm'><p> Invert BRAID Response Function</p></a></li>
<li><a href='#runBRAIDanalysis'>
<p>Run Full BRAID Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fitting Dose Response with the BRAID Combined Action Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.71</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-03-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Nathaniel R. Twarog</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nathaniel R. Twarog &lt;nathaniel.twarog@stjude.org&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions for evaluating, analyzing, and fitting combined action dose response surfaces with the Bivariate Response to Additive Interacting Dose (BRAID) model of combined action.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-03-07 20:36:10 UTC; ntwarog</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-03-08 00:13:04</td>
</tr>
</table>
<hr>
<h2 id='braidrm-package'>
Fitting Dose Response with the BRAID Combined Action Model
</h2><span id='topic+braidrm-package'></span>

<h3>Description</h3>

<p>This package provides functions necessary for evaluating, analyzing, and fitting combined action dose response surfaces with the
Bivariate Response to Additive Interacting Dose (BRAID) model of combined action.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> braidrm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.66</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-01-26</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 3)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>A mathematical description of the BRAID surface model can be found in <code><a href="#topic+evalBRAIDrsm">evalBRAIDrsm</a></code>. The heart of the package is the
function <code><a href="#topic+braidrm">braidrm</a></code>, which takes a set of paired concentrations and measured responses and fits a particular
instantiation of the BRAID model to the data.  Bootstrapped confidence intervals on all fit parameters can be constructed by
<code><a href="#topic+braidrm">braidrm</a></code>, or afterwards by the function <code><a href="#topic+getBRAIDbootstrap">getBRAIDbootstrap</a></code>. Known BRAID surfaces can be evaluated or
inverted using the calculating functions <code><a href="#topic+evalBRAIDrsm">evalBRAIDrsm</a></code> and <code><a href="#topic+invertBRAIDrsm">invertBRAIDrsm</a></code>. As analysis of combined dose
response is closely linked to single agent dose response, we have provided several simple functions for analyzing such
relationships, such as <code><a href="#topic+findBestHill">findBestHill</a></code>.  Finally, we also provide the more complete analytic functions
<code><a href="#topic+findBestBRAID">findBestBRAID</a></code> and <code><a href="#topic+runBRAIDanalysis">runBRAIDanalysis</a></code>, which perform a series of BRAID surface fits (and in the case of
<code><a href="#topic+runBRAIDanalysis">runBRAIDanalysis</a></code>, single agent fits) to simplify the process of implementing a BRAID analysis pipeline.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog &lt;nathaniel.twarog@stjude.org&gt;
</p>

<hr>
<h2 id='braidrm'>
BRAID Synergy Dose-Response Modeling
</h2><span id='topic+braidrm'></span><span id='topic+braidrm.default'></span><span id='topic+braidrm.formula'></span><span id='topic+print.braidrm'></span><span id='topic+summary.braidrm'></span><span id='topic+print.summary.braidrm'></span>

<h3>Description</h3>

<p>Calculates the best fit BRAID response surface given the concentrations of two drugs and the 
response of a measured target to the combination of those drugs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
braidrm(model,data,getCIs=TRUE,fixed="kappa2",startparv=NULL,llims=NULL,ulims=NULL,...)
## S3 method for class 'formula'
braidrm(model,data,...)
## S3 method for class 'braidrm'
print(x, ...)
## S3 method for class 'braidrm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="braidrm_+3A_model">model</code></td>
<td>
<p> a two-column array containing concentrations of Drug 1 and Drug 2 in each dose pair, or a symbolic formula (e.g.
<code>act ~ conc1+conc2</code>) specifying which variables are to be fit </p>
</td></tr>
<tr><td><code id="braidrm_+3A_data">data</code></td>
<td>
<p> if <code>model</code> is an array, a vector of measurements of  response to the concentrations of Drug 1 and Drug 2;
if <code>model</code> is a formula, a data frame containing the columns specified in <code>formula</code> </p>
</td></tr>
<tr><td><code id="braidrm_+3A_getcis">getCIs</code></td>
<td>
<p> determines if confidence intervals will be calculated for all response surface parameters being fit.
Parameters are fit using a bootstrapping approach which resamples residuals and refits the new data. </p>
</td></tr>
<tr><td><code id="braidrm_+3A_fixed">fixed</code></td>
<td>
<p> parameter specifying which parameters of the full BRAID model will be fit.  See Details for a full description
of this highly critical parameter </p>
</td></tr>
<tr><td><code id="braidrm_+3A_startparv">startparv</code></td>
<td>
<p> an optional parameter specifying starting parameter values for the optimization.  The relationship between
<code>startparv</code> and <code>fixed</code> is rather subtle, and is discussed below in the Details section.</p>
</td></tr>
<tr><td><code id="braidrm_+3A_llims">llims</code></td>
<td>
<p> a vector of lower limits on parameters being fit.  May have length 10, or length equal to the number of
free parameters being fit.  Any parameters that do not require a limit can have a value of <code>NA</code>.  If <code>NULL</code> (the
default), <code>llims</code> is calculated from the starting values in <code>startparv</code> (or the values calculated for <code>startparv</code>
if <code>startparv</code> is not specified). </p>
</td></tr>
<tr><td><code id="braidrm_+3A_ulims">ulims</code></td>
<td>
<p> a vector of upper limits on parameters being fit.  Follows same behavior as <code>llims</code>. </p>
</td></tr>
<tr><td><code id="braidrm_+3A_x">x</code></td>
<td>
<p> the object of class &quot;braidrm&quot; to be printed </p>
</td></tr>
<tr><td><code id="braidrm_+3A_object">object</code></td>
<td>
<p> the object of class &quot;braidrm&quot; to be summarized </p>
</td></tr>
<tr><td><code id="braidrm_+3A_...">...</code></td>
<td>
<p> Not used </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed to give as much control as is reasonably possible over which parameters are optimized and how the
optimization behaves.  However, implementing this much control can be quite complicated, and despite our efforts to make the
function intuitive and transparent, the interface is still quite unwieldy.  A great deal can be accomplished with the function
simply using the model nicknames &quot;kappa1&quot; and &quot;kappa2&quot; (which constrain the two maximal effects to be equal or allow them to vary
independently, respectively); if these are sufficient for you, feel free to ignore the remainder of this section.
</p>
<p>The parameter <code>fixed</code> is used to control which parameters are fit by the optimization, and in the case of the three maximal
effect parameters, how the parameters are constrained with respect to one another. <code>fixed</code> may be specified in one of three
forms: a raw vector, an index vector, or a model nickname.  There are seven model nicknames; using them is equivalent to using
the corresponding index vector as specified in the following table:
</p>

<table>
<tr>
 <td style="text-align: left;">
kappa1 </td><td style="text-align: left;"> 1,2,3,4,6,7,10 </td>
</tr>
<tr>
 <td style="text-align: left;">
kappa2 (default) </td><td style="text-align: left;"> 1,2,3,4,6,7,8,9 </td>
</tr>
<tr>
 <td style="text-align: left;">
kappa3 </td><td style="text-align: left;"> 1,2,3,4,6,7,8,9,10 </td>
</tr>
<tr>
 <td style="text-align: left;">
delta1 </td><td style="text-align: left;"> 1,2,3,4,5,7,10 </td>
</tr>
<tr>
 <td style="text-align: left;">
delta2 </td><td style="text-align: left;"> 1,2,3,4,5,7,8,9 </td>
</tr>
<tr>
 <td style="text-align: left;">
delta3 </td><td style="text-align: left;"> 1,2,3,4,5,7,8,9,10 </td>
</tr>
<tr>
 <td style="text-align: left;">
ebraid </td><td style="text-align: left;"> 1,2,3,4,5,6,7,8,9,10 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>An index vector specifies which parameters vary in the optimization by listing their indices in the full ten parameter vector; a
raw vector specifies which parameters vary by setting the corresponding values equal to <code>NA</code>.  The remaining values in a raw
vector specify the values at which the fixed parameters are fixed, unless these values are overridden by <code>startparv</code>
</p>
<p><code>startparv</code> specifies the starting values for the optimization; one can input a vector in <code>startparv</code> that specifies
only the values of varying parameters, but the remaining values must be specified in a raw vector in <code>fixed</code>.  If a full-length
ten-element vector is provided for <code>starparv</code>, the values of fixed parameters are taken from that vector, regardless of the
type of input in <code>fixed</code>.
</p>
<p>For parameters one through seven, the presence or absence of each parameter in the optimization is quite simple: either the parameter
is fixed at the specified (or calculated) value, or it varies between the specified (or calculated) optimization limits.  Parameters
eight through ten, however, which specify the maximal effect parameters, are more complicated.  The complication is introduced by the
fact that the parameters can be fixed <em>or</em> constrained to be equal to one another, which introduce the same number of degrees of
freedom, but very different optimization behaviors.  How the different possibilities for <code>fixed</code> and <code>startparv</code> influence
the optimization behavior (for as many possibilities as we could think of) is described by the following table. In the table <code class="reqn">W</code>,
<code class="reqn">X</code>, <code class="reqn">Y</code>, and <code class="reqn">Z</code> represent arbitrary but distinct valid values while ~ represents any valid (non-<code>NA</code>) value; in
addition, all <code>startparv</code> vectors are assumed to be complete ten-element vectors (incomplete vectors will simply be extended
with the corresponding values in <code>fixed</code>).
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>fixed</b> </td><td style="text-align: left;"> <b>startparv</b> </td><td style="text-align: left;"> <b>Behavior</b> </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,8,9,10) or </td><td style="text-align: left;"> Any </td><td style="text-align: left;">  All three maximal effect parameters vary independently,</td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,<code>NA</code>,<code>NA</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> with <code class="reqn">E_f</code> constrained to be a larger effect than <code class="reqn">E_{f,A}</code> and </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,8,9) or </td><td style="text-align: left;"> <code>NULL</code> </td><td style="text-align: left;"> <code class="reqn">E_{f,A}</code> and <code class="reqn">E_{f,B}</code> vary independently and <code class="reqn">E_f</code> is </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,<code>NA</code>,~) </td><td style="text-align: left;"> </td><td style="text-align: left;"> constrained to vary with the larger effect of <code class="reqn">E_{f,A}</code> and </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,8,9) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">X</code>, <code class="reqn">X</code>) or </td><td style="text-align: left;"> <code class="reqn">E_{f,A}</code> and <code class="reqn">E_{f,B}</code> vary independently and <code class="reqn">E_f</code> is </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,<code>NA</code>,~) </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>, <code class="reqn">X</code>) or </td><td style="text-align: left;"> constrained to vary with the larger effect of <code class="reqn">E_{f,A}</code> and </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">Y</code>, <code class="reqn">X</code>, <code class="reqn">X</code>) </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,8,9) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>) or </td><td style="text-align: left;">  <code class="reqn">E_f</code> is fixed at the value <code class="reqn">Y</code>, while <code class="reqn">E_{f,A}</code> and <code class="reqn">E_{f,B}</code> vary </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,<code>NA</code>,~) </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">Z</code>, <code class="reqn">Y</code>) </td><td style="text-align: left;"> independently and are constrained to be smaller effects </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> than <code class="reqn">Y</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,10) or </td><td style="text-align: left;"> <code>NULL</code> </td><td style="text-align: left;"> All maximal parameters are constrained to vary as a </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code class="reqn">X</code>,<code class="reqn">X</code>,<code>NA</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> single parameter. </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code class="reqn">X</code>,<code class="reqn">Y</code>,<code>NA</code>) </td><td style="text-align: left;"> <code>NULL</code> </td><td style="text-align: left;"> If <code class="reqn">X</code> is larger than <code class="reqn">Y</code>, <code class="reqn">E_f</code> and <code class="reqn">E_{f,A}</code> are constrained to </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> vary as a single parameter above <code class="reqn">Y</code>, and <code class="reqn">E_{f,B}</code> is fixed</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;">  at <code class="reqn">Y</code>. Otherwise, the roles of A and B are reversed. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,10) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">X</code>, <code class="reqn">X</code>) </td><td style="text-align: left;"> All maximal parameters are constrained to vary as a </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,~,~,<code>NA</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> single parameter. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,10) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>, <code class="reqn">X</code>) </td><td style="text-align: left;"> <code class="reqn">E_f</code> and <code class="reqn">E_{f,A}</code> are constrained to vary as a single </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,~,~,<code>NA</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> parameter above <code class="reqn">Y</code>, and <code class="reqn">E_{f,B}</code> is fixed at <code class="reqn">Y</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,10) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">Y</code>, <code class="reqn">X</code>, <code class="reqn">X</code>) </td><td style="text-align: left;"> <code class="reqn">E_f</code> and <code class="reqn">E_{f,B}</code> are constrained to vary as a single </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,~,~,<code>NA</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> parameter above <code class="reqn">Y</code>, and <code class="reqn">E_{f,A}</code> is fixed at <code class="reqn">Y</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,10) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>, <code class="reqn">Z</code>) </td><td style="text-align: left;"> <code class="reqn">E_f</code> is constrained to vary above the larger effect of <code class="reqn">X</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,~,~,<code>NA</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> and <code class="reqn">Y</code>, <code class="reqn">E_{f,A}</code> is fixed at <code class="reqn">X</code>, and <code class="reqn">E_{f,B}</code> is fixed at <code class="reqn">Y</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,8,10) or </td><td style="text-align: left;"> <code>NULL</code> or </td><td style="text-align: left;">  <code class="reqn">E_{f,A}</code> varies freely, and <code class="reqn">E_{f,B}</code> and <code class="reqn">E_f</code> are constrained to </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,~,<code>NA</code>) </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, ~, <code class="reqn">X</code>, <code class="reqn">X</code>) </td><td style="text-align: left;"> vary as a single parameter with a larger effect than <code class="reqn">E_{f,A}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,8,10) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, ~, <code class="reqn">X</code>, <code class="reqn">Y</code>) </td><td style="text-align: left;"> <code class="reqn">E_{f,A}</code> varies freely, <code class="reqn">E_{f,B}</code> is fixed at <code class="reqn">X</code> and <code class="reqn">E_f</code> varies </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,~,<code>NA</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> freely constrained to be a larger effect than <code class="reqn">E_{f,A}</code> and </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,9,10) or </td><td style="text-align: left;"> <code>NULL</code> or </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code> varies freely, and <code class="reqn">E_{f,A}</code> and <code class="reqn">E_f</code> are constrained to </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,~,<code>NA</code>,<code>NA</code>) </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, ~, <code class="reqn">X</code>) </td><td style="text-align: left;"> vary as a single parameter with a larger effect than <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,9,10) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, ~, <code class="reqn">Y</code>) </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code> varies freely, <code class="reqn">E_{f,A}</code> is fixed at <code class="reqn">X</code> and <code class="reqn">E_f</code> varies </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,~,<code>NA</code>,<code>NA</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> freely constrained to be a larger effect than <code class="reqn">E_{f,A}</code> and </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,8) or </td><td style="text-align: left;"> <code>NULL</code> </td><td style="text-align: left;"> <code class="reqn">E_{f,A}</code> varies freely, <code class="reqn">E_{f,B}</code> is fixed at <code class="reqn">X</code> (or calculated </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,<code class="reqn">X</code>,<code class="reqn">X</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> starting value), and <code class="reqn">E_f</code> is constrained to vary with </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> the larger effect of <code class="reqn">E_{f,A}</code> and <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,<code class="reqn">X</code>,<code class="reqn">Y</code>) </td><td style="text-align: left;"> <code>NULL</code> </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code> is fixed at <code class="reqn">X</code>, <code class="reqn">E_f</code> is fixed at <code class="reqn">Y</code>, and <code class="reqn">E_{f,A}</code> varies </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> freely constrained to be a smaller effect than <code class="reqn">Y</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,8) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">X</code>, <code class="reqn">X</code>) or </td><td style="text-align: left;"> <code class="reqn">E_{f,A}</code> varies freely, <code class="reqn">E_{f,B}</code> is fixed at <code class="reqn">X</code>, and <code class="reqn">E_f</code> is </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,~,~) </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">Y</code>, <code class="reqn">X</code>, <code class="reqn">X</code>) or </td><td style="text-align: left;"> constrained to vary with the larger effect of <code class="reqn">E_{f,A}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">Y</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>) </td><td style="text-align: left;"> and <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,8) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>) or </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code> is fixed at <code class="reqn">X</code>, <code class="reqn">E_f</code> is fixed at <code class="reqn">Y</code>, and <code class="reqn">E_{f,A}</code> varies </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code>NA</code>,~,~) </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">Z</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>) </td><td style="text-align: left;"> freely constrained to be a smaller effect than <code class="reqn">Y</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,9) or </td><td style="text-align: left;"> <code>NULL</code> </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code> varies freely, <code class="reqn">E_{f,A}</code> is fixed at <code class="reqn">X</code> (or calculated </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code class="reqn">X</code>,<code>NA</code>,<code class="reqn">X</code>) </td><td style="text-align: left;"> </td><td style="text-align: left;"> starting value), and <code class="reqn">E_f</code> is constrained to vary with </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> the larger effect of <code class="reqn">E_{f,A}</code> and <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,<code class="reqn">X</code>,<code>NA</code>,<code class="reqn">Y</code>) </td><td style="text-align: left;"> <code>NULL</code> </td><td style="text-align: left;"> <code class="reqn">E_{f,A}</code> is fixed at <code class="reqn">X</code>, <code class="reqn">E_f</code> is fixed at <code class="reqn">Y</code>, and <code class="reqn">E_{f,B}</code> varies </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td><td style="text-align: left;"> freely constrained to be a smaller effect than <code class="reqn">Y</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,9) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">X</code>, <code class="reqn">X</code>) or </td><td style="text-align: left;"> <code class="reqn">E_{f,B}</code> varies freely, <code class="reqn">E_{f,A}</code> is fixed at <code class="reqn">X</code>, and <code class="reqn">E_f</code> is </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,~,<code>NA</code>,~) </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>, <code class="reqn">X</code>) or </td><td style="text-align: left;"> constrained to vary with the larger effect of <code class="reqn">E_{f,A}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>, <code class="reqn">Y</code>) </td><td style="text-align: left;"> and <code class="reqn">E_{f,B}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>,9) or </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">X</code>, <code class="reqn">Y</code>) or </td><td style="text-align: left;"> <code class="reqn">E_{f,A}</code> is fixed at <code class="reqn">X</code>, <code class="reqn">E_f</code> is fixed at <code class="reqn">Y</code>, and <code class="reqn">E_{f,B}</code> varies </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,~,<code>NA</code>,~) </td><td style="text-align: left;"> (<code class="reqn">\ldots</code>, <code class="reqn">X</code>, <code class="reqn">Z</code>, <code class="reqn">Y</code>) </td><td style="text-align: left;"> freely constrained to be a smaller effect than <code class="reqn">Y</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
Index: (<code class="reqn">\ldots</code>) or </td><td style="text-align: left;"> Any </td><td style="text-align: left;"> All three values are fixed, and do not vary. </td>
</tr>
<tr>
 <td style="text-align: left;">
Raw: (<code class="reqn">\ldots</code>,~,~,~) </td><td style="text-align: left;"> </td><td style="text-align: left;"> 
</td>
</tr>

</table>



<h3>Value</h3>

<p>An object of class 'braidrm', including the elements
</p>
<table>
<tr><td><code>conc1</code></td>
<td>
<p> Concentrations of drug 1 used in the fit </p>
</td></tr>
<tr><td><code>conc2</code></td>
<td>
<p> Concentrations of drug 2 used in the fit </p>
</td></tr>
<tr><td><code>act</code></td>
<td>
<p> Reponse to drugs 1 and 2 used in the fit </p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> Value of best-fit response surface at concentrations of drugs 1 and 2 used in the fit </p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> Difference between actual measurements and fitted values </p>
</td></tr>
<tr><td><code>ostart</code></td>
<td>
<p> The full 10-parameter starting parameter vector used in the optimization </p>
</td></tr>
<tr><td><code>fixed</code></td>
<td>
<p> Vector describing which parameters were fit </p>
</td></tr>
<tr><td><code>mlims</code></td>
<td>
<p> Array containing upper and lower parameter bounds used in the optimization </p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p> Estimates of fitted parameters </p>
</td></tr>
<tr><td><code>fullpar</code></td>
<td>
<p> Full parameter vector including best-fit parameters </p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> From <code>optim</code>, indicates if optimization successfully converged </p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p> From <code>optim</code>, describes results of non-linear optimization </p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> Function call </p>
</td></tr>
</table>
<p>If <code>getCIs</code> is TRUE, then the following elements are also included
</p>
<table>
<tr><td><code>ciPass</code></td>
<td>
<p> TRUE if a sufficient proportion of bootstrapping trials successfully converged, FALSE otherwise </p>
</td></tr>
<tr><td><code>ciLevs</code></td>
<td>
<p> Two-element vector specifying the lower and upper percentiles of the desired confidence interval. Defaults
to 0.025 and 0.975 for a 95% confidence interval. </p>
</td></tr>
<tr><td><code>ciVec</code></td>
<td>
<p> Assuming 'ciPass' is true, a vector containing the lower and upper bounds on the confidence intervals of
all free parameters </p>
</td></tr>
<tr><td><code>bCoefs</code></td>
<td>
<p> A matrix containing the best-fit parameter values from all bootstrapping trials.  Useful for calculating
confidence intervals on other values, such as EC99 </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Nathaniel R. Twarog </p>


<h3>See Also</h3>

 <p><code><a href="#topic+getBRAIDbootstrap">getBRAIDbootstrap</a></code>, <code><a href="#topic+calcBRAIDconfint">calcBRAIDconfint</a></code>, <code><a href="#topic+evalBRAIDrsm">evalBRAIDrsm</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz)
summary(braidrm(act~conc1+conc2,es8olatmz,getCIs=FALSE))
## Not run: 
summary(braidrm(cbind(es8olatmz$conc1,es8olatmz$conc2),es8olatmz$act))
summary(braidrm(act~conc1+conc2,es8olatmz,fixed="delta2"))
summary(braidrm(act~conc1+conc2,es8olatmz,fixed=c(1,2,3,4,6,8,9)))
summary(braidrm(act~conc1+conc2,es8olatmz,llims=c(NA,NA,NA,NA,NA,NA,NA,-4,-4,-4)))

## End(Not run)
</code></pre>

<hr>
<h2 id='calcBRAIDconfint'>
Calculate General BRAID Confidence Intervals
</h2><span id='topic+calcBRAIDconfint'></span>

<h3>Description</h3>

<p>Produces confidence intervals for any general calculable property of a BRAID surface, based on a
given BRAID surface fit (with bootstrapped coefficients).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcBRAIDconfint(bfit, parfunc, civals = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcBRAIDconfint_+3A_bfit">bfit</code></td>
<td>
<p> A BRAID surface fit of class <code>braidrm</code>, with bootstrapped coefficients </p>
</td></tr>
<tr><td><code id="calcBRAIDconfint_+3A_parfunc">parfunc</code></td>
<td>
<p> A function to calculate a property of a response surface.  <code>parfunc</code> must take a ten-element BRAID 
parameter vector as input, and return a single numeric value or a numeric vector of a fixed length as output.</p>
</td></tr>
<tr><td><code id="calcBRAIDconfint_+3A_civals">civals</code></td>
<td>
<p> Values specifying the lower and upper bound of the confidence interval(s) to be calculated. If <code>NULL</code>
(the default), the values of the <code>ciLevs</code> property of <code>bfit</code> will be used. NOTE: using a wider percentile
here than was used to estimate the bootstrapped coefficients can lead to an unstable confidence interval.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>parfunc</code> produces a single value as output, a vector of three values: the second value is the estimate of the best
BRAID surface fit, while the first and third values represent the lower and upper bounds of the calculated confidence interval.
If <code>parfunc</code> produces a vector as output, an array of width three: the second column is the estimate of the best BRAID
surface fit, while the first and third columns represent the lower and upper bounds of the calculated confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+braidrm">braidrm</a></code>,<code><a href="#topic+getBRAIDbootstrap">getBRAIDbootstrap</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz)

brd &lt;- braidrm(act~conc1+conc2,es8olatmz,fixed=c(NA,NA,NA,NA,1,NA,NA,-4,-4,-4))
potci &lt;- calcBRAIDconfint(brd,function(parv) invertBRAIDrsm(-1,DA=10^-7,parv=parv))
## Not run: 
pconc &lt;- exp(seq(log(10^-6),log(10^-3),length=100))
effci &lt;- calcBRAIDconfint(brd,function(parv) evalBRAIDrsm(10^-7,pconc,parv))

## End(Not run)
</code></pre>

<hr>
<h2 id='es1data'>Results from Ewings-Sarcoma Experiments</h2><span id='topic+es1data'></span><span id='topic+es1extdata'></span><span id='topic+es8data'></span><span id='topic+es8extdata'></span><span id='topic+ew8data'></span>

<h3>Description</h3>

<p>These data frames contain the results of a series of cytotoxicity experiments
on cell-lines from the pediatric cancer Ewings' sarcoma.  Data frames describe
results from several different experiments or sets of experiments:
</p>

<dl>
<dt>es1data</dt><dd><p>Experiment combining three PARP inhibitors with standard-of-care DNA damaging
agents in the ES1 cell line.</p>
</dd>
<dt>es1extdata</dt><dd><p>Follow up experiments combining BMN 673 and SN-38 with several additional
mechanistic classes in the ES1 cell line.</p>
</dd>
<dt>es8data</dt><dd><p>Experiment combining three PARP inhibitors with standard-of-care DNA damaging
agents in the ES8 cell line.</p>
</dd>
<dt>es8extdata</dt><dd><p>Follow up experiments combining BMN 673 and SN-38 with several additional
mechanistic classes in the ES8 cell line.</p>
</dd>
<dt>ew8data</dt><dd><p>Experiment combining three PARP inhibitors with standard-of-care DNA damaging
agents in the EW8 cell line.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>data(ewings)</code></pre>


<h3>Format</h3>

<p>Data frames containing the following columns:
</p>

<dl>
<dt>plate</dt><dd><p>The number of the plate this measurement was taken from</p>
</dd>
<dt>well</dt><dd><p>The name of the well (e.g. &quot;A01&quot;) this measurement was taken from</p>
</dd>
<dt>compound1</dt><dd><p>The compound drugged in decreasing concentration across this plate (DMSO if none)</p>
</dd>
<dt>compound2</dt><dd><p>The compound drugged in decreasing concentration down this plate (DMSO if none)</p>
</dd>
<dt>conc1</dt><dd><p>The concentration (in molar) of the first compound in this well</p>
</dd>
<dt>conc2</dt><dd><p>The concentration (in molar) of the second compound in this well</p>
</dd>
<dt>act</dt><dd><p>The base-10 logarithm of CellTiter-Glo intensity in this well normalized to intensity
in negative control wells on the same plate</p>
</dd>
<dt>date</dt><dd><p>The date on which the experiment using this plate was run</p>
</dd>
</dl>


<hr>
<h2 id='es1plates'>Plate Information from Ewings-Sarcoma Experiments</h2><span id='topic+es1plates'></span><span id='topic+es1extplates'></span><span id='topic+es8plates'></span><span id='topic+es8extplates'></span><span id='topic+ew8plates'></span>

<h3>Description</h3>

<p>These data frames describe the compounds used in each of plates tested
in a series of cytotoxicity experiments on cell-lines from the pediatric
cancer Ewings' sarcoma.  Data frames describe plates from several different
experiments or sets of experiments:
</p>

<dl>
<dt>es1plates</dt><dd><p>Experiment combining three PARP inhibitors with standard-of-care DNA damaging
agents in the ES1 cell line.</p>
</dd>
<dt>es1extplates</dt><dd><p>Follow up experiments combining BMN 673 and SN-38 with several additional
mechanistic classes in the ES1 cell line.</p>
</dd>
<dt>es8plates</dt><dd><p>Experiment combining three PARP inhibitors with standard-of-care DNA damaging
agents in the ES8 cell line.</p>
</dd>
<dt>es8extplates</dt><dd><p>Follow up experiments combining BMN 673 and SN-38 with several additional
mechanistic classes in the ES8 cell line.</p>
</dd>
<dt>ew8plates</dt><dd><p>Experiment combining three PARP inhibitors with standard-of-care DNA damaging
agents in the EW8 cell line.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>data(ewings)</code></pre>


<h3>Format</h3>

<p>Data frames containing the following columns:
</p>

<dl>
<dt>plate</dt><dd><p>The number of a plate run in a particular experiment</p>
</dd>
<dt>compound1</dt><dd><p>The compound drugged in decreasing concentration across the plate (DMSO if none)</p>
</dd>
<dt>compound2</dt><dd><p>The compound drugged in decreasing concentration down the plate (DMSO if none)</p>
</dd>
<dt>posmean</dt><dd><p>The average base-10 logarithm of CellTiter-Glo intensity in positive control wells
on the plate, normalized to intensity in negative control wells on the same plate</p>
</dd>
<dt>date</dt><dd><p>The date on which the experiment using that plate was run</p>
</dd>
</dl>


<hr>
<h2 id='es8olatmz'>Results from Ewings-Sarcoma Experiments</h2><span id='topic+es8olatmz'></span>

<h3>Description</h3>

<p>This data frames contain the results of a single combination of the PARP inhibitor
olaparib and the DNA-damaging agent temozolomide in a cytotoxicity experiment on the
Ewings' sarcoma cell line ES8 run on April 4, 2014. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(es8olatmz)</code></pre>


<h3>Format</h3>

<p>A data frame containing the following columns:
</p>

<dl>
<dt>plate</dt><dd><p>The number of the plate this measurement was taken from</p>
</dd>
<dt>well</dt><dd><p>The name of the well (e.g. &quot;A01&quot;) this measurement was taken from</p>
</dd>
<dt>compound1</dt><dd><p>The compound drugged in decreasing concentration across this plate (DMSO if none)</p>
</dd>
<dt>compound2</dt><dd><p>The compound drugged in decreasing concentration down this plate (DMSO if none)</p>
</dd>
<dt>conc1</dt><dd><p>The concentration (in molar) of the first compound in this well</p>
</dd>
<dt>conc2</dt><dd><p>The concentration (in molar) of the second compound in this well</p>
</dd>
<dt>act</dt><dd><p>The base-10 logarithm of CellTiter-Glo intensity in this well normalized to intensity
in negative control wells on the same plate</p>
</dd>
<dt>date</dt><dd><p>The date on which the experiment using this plate was run</p>
</dd>
</dl>


<hr>
<h2 id='evalBRAIDrsm'> Calculate BRAID Surface Values </h2><span id='topic+evalBRAIDrsm'></span>

<h3>Description</h3>

<p>Calculates the value of the Bivariate Response to Additive Interacting Doses (BRAID) surface model for the given concentration
pairs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalBRAIDrsm(DA, DB, parv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evalBRAIDrsm_+3A_da">DA</code></td>
<td>
<p> vector of concentrations of drug A </p>
</td></tr>
<tr><td><code id="evalBRAIDrsm_+3A_db">DB</code></td>
<td>
<p> vector of concentrations of drug B </p>
</td></tr>
<tr><td><code id="evalBRAIDrsm_+3A_parv">parv</code></td>
<td>
<p> ten-element vector specifying the full set of parameters for the BRAID surface (see Details below) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full ten-parameter BRAID model, which we refer to as the <em>extended BRAID</em> or <em>eBRAID</em> model is defined as:
</p>
<p style="text-align: center;"><code class="reqn">E(D_A,D_B) = E_0 + \frac{E_f-E_0}{1+{{\tilde{D}}_{AB}}^{-\delta\sqrt{n_a n_b}}}</code>
</p>

<p style="text-align: center;"><code class="reqn">{\tilde{D}}_{AB} = {{\tilde{D}}_A}^\frac{1}{\delta\sqrt{n_a n_b}}+{{\tilde{D}}_B}^\frac{1}{\delta\sqrt{n_a n_b}}
		+\kappa\sqrt{{{\tilde{D}}_A}^\frac{1}{\delta\sqrt{n_a n_b}}
		{{\tilde{D}}_B}^\frac{1}{\delta\sqrt{n_a n_b}}}</code>
</p>

<p style="text-align: center;"><code class="reqn">{\tilde{D}}_A = \frac{\left(\frac{E_{f,A}-E_0}{E_f-E_0}\right)\left(\frac{D_A}{{ID}_{M,A}}\right)^{n_a}}
		{1+\left(1-\frac{E_{f,A}-E_0}{E_f-E_0}\right)\left(\frac{D_A}{{ID}_{M,A}}\right)^{n_a}}</code>
</p>

<p style="text-align: center;"><code class="reqn">{\tilde{D}}_B = \frac{\left(\frac{E_{f,B}-E_0}{E_f-E_0}\right)\left(\frac{D_B}{{ID}_{M,B}}\right)^{n_b}}
		{1+\left(1-\frac{E_{f,B}-E_0}{E_f-E_0}\right)\left(\frac{D_B}{{ID}_{M,B}}\right)^{n_b}}</code>
</p>

<p>The parameters of this equation must satisfy <code class="reqn">n_a&gt;0</code>, <code class="reqn">n_b&gt;0</code>, <code class="reqn">\delta&gt;0</code>, <code class="reqn">\kappa&gt; -2</code>,
<code class="reqn">sign(E_f-E_0)=sign(E_{f,A}-E_0)=sign(E_{f,B}-E_0)</code>,
<code class="reqn">|E_f-E_0|\geq|E_{f,A}-E_0|</code>, and <code class="reqn">|E_f-E_0|\geq|E_{f,B}-E_0|</code>. With this
definition, the ten-element parameter vector is [<code class="reqn">{ID}_{M,A}</code>, <code class="reqn">{ID}_{M,B}</code>, <code class="reqn">n_a</code>, <code class="reqn">n_b</code>,
<code class="reqn">\delta</code>, <code class="reqn">\kappa</code>, <code class="reqn">E_0</code>, <code class="reqn">E_{f,A}</code>, <code class="reqn">E_{f,B}</code>, <code class="reqn">E_f</code>]. The simpler standard BRAID
model, as described in Twarog <em>et al.</em> is obtained by setting <code class="reqn">\delta</code> equal to 1 and setting <code class="reqn">E_f</code> such that
<code class="reqn">|E_f-E_0|</code> is equal to the maximum of <code class="reqn">|E_{f,A}-E_0|</code> and <code class="reqn">|E_{f,B}-E_0|</code>.  Assuming that
this sets <code class="reqn">E_f</code> equal to <code class="reqn">E_{f,A}</code>, this causes the equation for <code class="reqn">{\tilde{D}}_A</code> to simplify to
</p>
<p style="text-align: center;"><code class="reqn">{\tilde{D}}_A = \left(\frac{D_A}{{ID}_{M,A}}\right)^{n_a}</code>
</p>



<h3>Value</h3>

<p> A vector of response values corresponding to the pairs of concentrations in <code>DA</code> and <code>DB</code> </p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+braidrm">braidrm</a></code>, <code><a href="#topic+invertBRAIDrsm">invertBRAIDrsm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc1 &lt;- rep(seq(0,3*10^-6,length=50),each=50)
conc2 &lt;- rep(seq(0,3*10^-6,length=50),times=50)

# Additive surface
act &lt;- evalBRAIDrsm(conc1,conc2,parv=c(10^-6,10^-6,1.5,1.5,1,0,0,100,100,100))
# A BRAID additive surface is not a Loewe additive surface
act &lt;- evalBRAIDrsm(conc1,conc2,parv=c(10^-6,10^-6,1,3,1,0,0,100,100,100))
# BRAID antagonism
act &lt;- evalBRAIDrsm(conc1,conc2,parv=c(10^-6,10^-6,1.5,1.5,1,-1,0,100,100,100))
# delta-BRAID synergy
act &lt;- evalBRAIDrsm(conc1,conc2,parv=c(10^-6,10^-6,1.5,1.5,1.75,0,0,100,100,100))
# Differing final effects
act &lt;- evalBRAIDrsm(conc1,conc2,parv=c(10^-6,10^-6,1.5,1.5,1,0,0,75,100,100))
</code></pre>

<hr>
<h2 id='evalHillEqn'>
Calculate and Invert Hill Equation
</h2><span id='topic+evalHillEqn'></span><span id='topic+invertHillEqn'></span>

<h3>Description</h3>

<p>Calculates the response of a four-parameter Hill (or log-logistic) dose-response model, or determines the concentrations which
yield the given response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalHillEqn(conc, parv)
invertHillEqn(val, parv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evalHillEqn_+3A_conc">conc</code></td>
<td>
<p> a vector of concentrations to be passed as input into the model</p>
</td></tr>
<tr><td><code id="evalHillEqn_+3A_parv">parv</code></td>
<td>
<p> a four-element vector specifying the full parameter set of a particular Hill model </p>
</td></tr>
<tr><td><code id="evalHillEqn_+3A_val">val</code></td>
<td>
<p> a vector of responses to be inverted in a particular Hill model </p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is some ambiguity in how the parameters of a Hill or log-logistic model are specified.  We have chosen to use the following
equation:
</p>
<p style="text-align: center;"><code class="reqn">E(D) = E_0 + \frac{E_f-E_0}{1+\left(\frac{D}{{ID}_M}\right)^{-n}}</code>
</p>

<p>where the Hill slope <code class="reqn">n</code> is always positive.  Using this equation, the parameter vector for a Hill model is
(<code class="reqn">n</code>,<code class="reqn">E_0</code>,<code class="reqn">E_f</code>,<code class="reqn">ln{{ID}_M}</code>) (note that the fourth parameter value is log-transformed in the
parameter vector).
</p>


<h3>Value</h3>

<p>For <code>evalHillEqn</code> a vector of responses resulting from the given concentrations.  For <code>invertHillEqn</code>, a vector
of concentrations that produce the given responses; responses beyond the model's maximal effect will produce a value of <code>Inf</code>,
while responses that do not reach the model's baseline effect produce a value of 0.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+findBestHill">findBestHill</a></code>, <code><a href="#topic+hillConcCorrect">hillConcCorrect</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>act &lt;- evalHillEqn(exp(seq(log(10^-8),log(10^-5),length=100)),parv=c(2,0,100,log(10^-6)))
ec90 &lt;- invertHillEqn(90,parv=c(2,0,100,log(10^-6)))
</code></pre>

<hr>
<h2 id='findBestBRAID'> Select Best Fitting BRAID Surface Model </h2><span id='topic+findBestBRAID'></span><span id='topic+findBestBRAID.default'></span><span id='topic+findBestBRAID.formula'></span>

<h3>Description</h3>

<p>Fits several BRAID surface models to the given data, and selects the most parsimonious model using the Akaike information criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
findBestBRAID(model, data, defaults, startparv=NULL, llims=NULL,
				ulims=NULL, itype=1, getCIs=TRUE, crossval=TRUE, ...)
## S3 method for class 'formula'
findBestBRAID(model, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findBestBRAID_+3A_model">model</code></td>
<td>
<p> a two-column array containing concentrations of Drug 1 and Drug 2 in each dose pair, or a symbolic formula (e.g.
<code>act ~ conc1+conc2</code>) specifying which variables are to be fit </p>
</td></tr>
<tr><td><code id="findBestBRAID_+3A_data">data</code></td>
<td>
<p> if <code>model</code> is an array, a vector of measurements of  response to the concentrations of Drug 1 and Drug 2;
if <code>model</code> is a formula, a data frame containing the columns specified in <code>formula</code> </p>
</td></tr>
<tr><td><code id="findBestBRAID_+3A_defaults">defaults</code></td>
<td>
<p> two-element vector specifying the default initial and maximal effects for the response surface.  These values
will be used in several of the models that are tried (see Details below).</p>
</td></tr>
<tr><td><code id="findBestBRAID_+3A_startparv">startparv</code></td>
<td>
<p> an optional parameter specifying starting parameter values for the optimization </p>
</td></tr>
<tr><td><code id="findBestBRAID_+3A_llims">llims</code></td>
<td>
<p> a ten-element vector of lower limits on parameters being fit.   Any parameters that do not require a limit can
have a value of <code>NA</code>.  If <code>NULL</code> (the default), <code>llims</code> is calculated from the starting values in <code>startparv</code>
(or the values calculated for <code>startparv</code> if <code>startparv</code> is not specified). </p>
</td></tr>
<tr><td><code id="findBestBRAID_+3A_ulims">ulims</code></td>
<td>
<p> a vector of upper limits on parameters being fit.  Follows same behavior as <code>llims</code>. </p>
</td></tr>
<tr><td><code id="findBestBRAID_+3A_itype">itype</code></td>
<td>
<p> an integer that specifies the type of interaction(s) that is assumed in the models.  The default is 1, which
assumes that the interaction parameter <code class="reqn">\kappa</code> is varying.  See details below for other possible values. </p>
</td></tr>
<tr><td><code id="findBestBRAID_+3A_getcis">getCIs</code></td>
<td>
<p> determines if confidence intervals will be calculated for all response surface parameters being fit.
Parameters are fit using a bootstrapping approach which resamples residuals and refits the new data. </p>
</td></tr>
<tr><td><code id="findBestBRAID_+3A_crossval">crossval</code></td>
<td>
<p> if <code>TRUE</code>, goodness of fit is determined by randomly assigning data points to four blocks, and evaluating
goodness of fit on each block by fitting the remaining three.  If <code>FALSE</code>, all data points are fit once, and goodness of fit
is determined using the residuals from that fit.  It is advisable not to use cross-validation when a relatively small number of
data points are available, especially on the margins (when drug A or drug B has concentration 0). </p>
</td></tr>
<tr><td><code id="findBestBRAID_+3A_...">...</code></td>
<td>
<p> Not used </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because experiments do not reliably capture the full range of responses that a combination can produce, estimation of the initial
and maximal effect parameters for a BRAID surface can be highly unstable.  This function fits at least 10 distinct BRAID surface
models to the given data, and selects the model which best balances simplicity with goodness of fit.  For each interaction type
(see below), the following 10 models are fit:
</p>

<ul>
<li><p> The initial effect parameter <code class="reqn">E_0</code> varies freely, and the two maximal effect parameters <code class="reqn">E_{f,A}</code> and
<code class="reqn">E_{f,B}</code> vary freely independently of one another.
</p>
</li>
<li><p> The initial effect parameter <code class="reqn">E_0</code> is fixed at the default value, and the two maximal effect parameters
<code class="reqn">E_{f,A}</code> and <code class="reqn">E_{f,B}</code> vary freely independently of one another.
</p>
</li>
<li><p> The initial effect parameter <code class="reqn">E_0</code> the maximal effect parameter <code class="reqn">E_{f,A}</code> vary freely, and the
maximal effect parameter <code class="reqn">E_{f,B}</code> is fixed at the default value.
</p>
</li>
<li><p> The initial effect parameter <code class="reqn">E_0</code> the maximal effect parameter <code class="reqn">E_{f,B}</code> vary freely, and the
maximal effect parameter <code class="reqn">E_{f,A}</code> is fixed at the default value.
</p>
</li>
<li><p> The initial effect parameter <code class="reqn">E_0</code> varies freely, and the two maximal effect parameters <code class="reqn">E_{f,A}</code> and
<code class="reqn">E_{f,B}</code> are constrained to vary as a single parameter <code class="reqn">E_f</code>.
</p>
</li>
<li><p> The initial effect parameter <code class="reqn">E_0</code> varies freely, and the two maximal effect parameters <code class="reqn">E_{f,A}</code> and
<code class="reqn">E_{f,B}</code> are fixed at the default value.
</p>
</li>
<li><p> The initial effect parameter <code class="reqn">E_0</code> the two maximal effect parameter <code class="reqn">E_{f,B}</code> are fixed at the default
values, and the maximal effect parameter <code class="reqn">E_{f,A}</code> varies freely.
</p>
</li>
<li><p> The initial effect parameter <code class="reqn">E_0</code> the two maximal effect parameter <code class="reqn">E_{f,A}</code> are fixed at the default
values, and the maximal effect parameter <code class="reqn">E_{f,B}</code> varies freely.
</p>
</li>
<li><p> The initial effect parameter <code class="reqn">E_0</code> is fixed at the default value,, and the two maximal effect parameters
<code class="reqn">E_{f,A}</code> and <code class="reqn">E_{f,B}</code> are constrained to vary as a single parameter <code class="reqn">E_f</code>.
</p>
</li>
<li><p> The initial effect parameter <code class="reqn">E_0</code> and the two maximal effect parameters <code class="reqn">E_{f,A}</code> and <code class="reqn">E_{f,B}</code>
are all fixed at the default values.
</p>
</li></ul>

<p>In all models, the potencies of the two drugs (represented by <code class="reqn">{ID}_{M,A}</code> and <code class="reqn">{ID}_{M,B}</code>) and the Hill
slopes of both drugs (represented by <code class="reqn">n_a</code> and <code class="reqn">n_b</code>) vary freely.  Which of the interaction parameters
<code class="reqn">\kappa</code> and <code class="reqn">\delta</code> varies depends on the parameter <code>itype</code>, as follows:
</p>

<ul>
<li> <p><code>itype = 1</code>: <code class="reqn">\kappa</code> varies freely in all models; <code class="reqn">\delta</code> is fixed at 1 (10 models total).
</p>
</li>
<li> <p><code>itype = 2</code>: <code class="reqn">\delta</code> varies freely in all models; <code class="reqn">\kappa</code> is fixed at 0 (10 models total).
</p>
</li>
<li> <p><code>itype = 3</code>: Either <code class="reqn">\kappa</code> or <code class="reqn">\delta</code> (but not both) vary freely in all models (20 models total).
</p>
</li>
<li> <p><code>itype = 4</code>: Either <code class="reqn">\kappa</code> or <code class="reqn">\delta</code> or both vary freely in all models (30 models total).
</p>
</li>
<li> <p><code>itype = 5</code>: <code class="reqn">\kappa</code> is fixed at 0 and <code class="reqn">\delta</code> is fixed at 1 in all models (10 models total).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of the class 'braidrm', with elements as described in <code><a href="#topic+braidrm">braidrm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+braidrm">braidrm</a></code>, <code><a href="#topic+getBRAIDbootstrap">getBRAIDbootstrap</a></code>, <code><a href="#topic+runBRAIDanalysis">runBRAIDanalysis</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz)
## Not run: summary(findBestBRAID(cbind(es8olatmz$conc1,es8olatmz$conc2),
				es8olatmz$act,defaults=c(0,-2.7)))
## End(Not run)
## Not run: summary(findBestBRAID(act~conc1+conc2,es8olatmz,defaults=c(0,-2.7),itype=2))
summary(findBestBRAID(act~conc1+conc2,es8olatmz,defaults=c(0,-4),getCIs=FALSE))
</code></pre>

<hr>
<h2 id='findBestHill'>
Fit Hill Model with Model Selection
</h2><span id='topic+findBestHill'></span><span id='topic+findBestHill.default'></span><span id='topic+findBestHill.formula'></span>

<h3>Description</h3>

<p>Fits the given concentration and response data with several Hill (or log-likelihood) models, and selects the model that best
balances simplicity and accuracy according to the Akaike Information Criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
findBestHill(model,data,defaults,startparv=NULL,llims=NULL,ulims=NULL,...)
## S3 method for class 'formula'
findBestHill(model,data,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findBestHill_+3A_model">model</code></td>
<td>
<p> a vector of concentrations, or a symbolic formula (e.g. <code>act ~ conc</code>) specifying which variables are to be fit </p>
</td></tr>
<tr><td><code id="findBestHill_+3A_data">data</code></td>
<td>
<p> if <code>model</code> is a vector, a vector of measurements of response to the concentrations set down in <code>conc</code>;
if <code>model</code> is formula, a data frame containing the columns specified in <code>formula</code> </p>
</td></tr>
<tr><td><code id="findBestHill_+3A_defaults">defaults</code></td>
<td>
<p> two-element vector specifying the default initial and maximal effects for the Hill model.  These values will
be used in several of the models that are tried (see Details below).</p>
</td></tr>
<tr><td><code id="findBestHill_+3A_startparv">startparv</code></td>
<td>
<p> an optional parameter specifying starting parameter values for the optimization.  Any parameters that do not
have a starting value can have a value of NA (and will be estimated from the concentrations and responses.</p>
</td></tr>
<tr><td><code id="findBestHill_+3A_llims">llims</code></td>
<td>
<p> a four-element vector of lower limits on parameters being fit.  Any parameters that do not require a limit can
have a value of NA.  If NULL (the default), <code>llims</code> is calculated from the starting values in <code>startparv</code> (or the values
calculated for <code>startparv</code> if <code>startparv</code> is not specified). </p>
</td></tr>
<tr><td><code id="findBestHill_+3A_ulims">ulims</code></td>
<td>
<p> a vector of upper limits on parameters being fit.  Follows same behavior as <code>llims</code>. </p>
</td></tr>
<tr><td><code id="findBestHill_+3A_...">...</code></td>
<td>
<p> Not used </p>
</td></tr>
</table>


<h3>Details</h3>

<p>As many dose response experiments fail to capture the full sigmoidal behavior of a compound, estimation of the initial and maximal
effect parameters for a four-parameter Hill equation (see <code><a href="#topic+evalHillEqn">evalHillEqn</a></code> for a description of the equation used in this
package) can be quite unstable.  To avoid estimation of wildly divergent parameters and overfitting, this function fits a
four-parameter Hill equation to the given data four times, with the initial and maximal effect parameters either varying freely or
fixed to the provided default values.  The most parsimonious model is selected from the four fits according to the Akaike Information
Criterion.  The model also fits a constant flat function to the data; though this fifth &quot;model&quot; is not included in the model
selection, it is included in the output for reference, as a check that the given data shows any signal at all.
</p>


<h3>Value</h3>

<p>A list describing the results of the model fits, with the following components:
</p>
<table>
<tr><td><code>conc</code></td>
<td>
<p>The vector of concentrations used in the fit</p>
</td></tr>
<tr><td><code>act</code></td>
<td>
<p>The vector of responses used in the fit</p>
</td></tr>
<tr><td><code>bestModIdx</code></td>
<td>
<p>The index of the model among those fit which yielded the most parsimonious fit</p>
</td></tr>
<tr><td><code>bestModName</code></td>
<td>
<p>The name of the best-fit model.  The names of the models are
</p>

<ol>
<li><p> &quot;m2p&quot;: A model in which both the initial and maximal effect parameters are fixed to the default values
</p>
</li>
<li><p> &quot;m3puc&quot;: A model in which the initial effect parameter varies freely
</p>
</li>
<li><p> &quot;m3plc&quot;: A model in which the maximal effect parameter varies freely
</p>
</li>
<li><p> &quot;m4p&quot;: A model in which both the initial and maximal effect parameters vary freely
</p>
</li></ol>

<p>The fifth &quot;model&quot;, a constant linear fit, is named &quot;Lin&quot;, but will not be selected by the model selection.
</p>
</td></tr>
<tr><td><code>mlims</code></td>
<td>
<p>A matrix of upper and lower limits applied to the four Hill parameters in the fit</p>
</td></tr>
<tr><td><code>allfits</code></td>
<td>
<p>A list of the five fits (including the trivial linear fit) applied to the data.  Each fit is described by a list
with the following components:
</p>

<ul>
<li><p> coefficients: The full four-element parameter vector describing the best-fit Hill equation in this model (or the single
parameter for the constant linear fit)
</p>
</li>
<li><p> parv: The vector of best-fit values for only those parameters which varied freely in the model
</p>
</li>
<li><p> pinds: A vector of parameter indices indicating which of the four Hill parameters varied in this model
</p>
</li>
<li><p> AIC: The Akaike Information Criterion value for this model
</p>
</li></ul>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evalHillEqn">evalHillEqn</a></code>, <code><a href="#topic+getHillBootstrap">getHillBootstrap</a></code>, <code><a href="#topic+runBRAIDanalysis">runBRAIDanalysis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz)
drv &lt;- es8olatmz$compound2=="DMSO"
hfit &lt;- findBestHill(es8olatmz$conc1[drv],es8olatmz$act[drv],defaults=c(0,-2.7))
coef(hfit$allfits[[hfit$bestModIdx]])
hfit &lt;- findBestHill(act~conc1,es8olatmz[drv,],defaults=c(0,-4))
coef(hfit$allfits[[hfit$bestModIdx]])
</code></pre>

<hr>
<h2 id='getBRAIDbootstrap'>
Bootstrap BRAID Parameter Confidence Intervals
</h2><span id='topic+getBRAIDbootstrap'></span>

<h3>Description</h3>

<p>Estimate bootstrapped confidence intervals of a BRAID surface fit's parameters, by sampling residuals
and refitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBRAIDbootstrap(bfit, ciLevs = c(0.025, 0.975),numBoot=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBRAIDbootstrap_+3A_bfit">bfit</code></td>
<td>
<p> a BRAID surface fit of class 'braidrm' </p>
</td></tr>
<tr><td><code id="getBRAIDbootstrap_+3A_cilevs">ciLevs</code></td>
<td>
<p> a two-element vector specifying the lower and upper percentiles of the desired confidence interval. The default
value of <code>c(0.025, 0.975)</code> results in a 95% confidence interval.</p>
</td></tr>
<tr><td><code id="getBRAIDbootstrap_+3A_numboot">numBoot</code></td>
<td>
<p> the number of bootstrapped coefficients to be calculated.  If <code>NULL</code> (the default), number of
bootstrapped coefficients is determined from the width of the interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function constructs bootstrapped confidence intervals for objects of class <code>braidrm</code>.  If the input already has
bootstrapped confidence intervals (or has tried and failed to generate them), this function will throw a warning and
return the input model.
</p>


<h3>Value</h3>

<p>An object of class <code>braidrm</code>, with the new elements:
</p>
<table>
<tr><td><code>ciPass</code></td>
<td>
<p> TRUE if a sufficient proportion of bootstrapping trials successfully converged, FALSE otherwise </p>
</td></tr>
<tr><td><code>ciLevs</code></td>
<td>
<p> Two-element vector specifying the lower and upper percentiles of the desired confidence interval. Defaults
to 0.025 and 0.975 for a 95% confidence interval. </p>
</td></tr>
<tr><td><code>ciVec</code></td>
<td>
<p> Assuming 'ciPass' is true, a vector containing the lower and upper bounds on the confidence intervals of
all free parameters </p>
</td></tr>
<tr><td><code>bCoefs</code></td>
<td>
<p> Array containing the best-fit parameter values from all bootstrapping trials.  Useful for calculating
confidence intervals on other values. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+braidrm">braidrm</a></code>, <code><a href="#topic+calcBRAIDconfint">calcBRAIDconfint</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz)

brd &lt;- braidrm(act~conc1+conc2,es8olatmz,getCIs=FALSE,fixed=c(NA,NA,NA,NA,1,NA,NA,-4,-4,-4))
summary(getBRAIDbootstrap(brd))
## Not run: summary(getBRAIDbootstrap(brd,ciLevs=c(0.05,0.95)))
</code></pre>

<hr>
<h2 id='getHillBootstrap'>
Bootstrap Hill Equation Parameter Confidence Intervals
</h2><span id='topic+getHillBootstrap'></span>

<h3>Description</h3>

<p>Uses sampling residuals with replacement to bootstrap a distribution of Hill equation parameters for the construction
of confidence intervals on those parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHillBootstrap(hfitl, ciLevs = c(0.025,0.975), mi = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getHillBootstrap_+3A_hfitl">hfitl</code></td>
<td>
<p>a list of Hill equation model fits produced by <code><a href="#topic+findBestHill">findBestHill</a></code></p>
</td></tr>
<tr><td><code id="getHillBootstrap_+3A_cilevs">ciLevs</code></td>
<td>
<p>a two-element vector specifying the lower and upper percentiles of the desired confidence intervals. Default
is <code>c(0.025,0.975)</code>, which yields a 95% confidence interval.</p>
</td></tr>
<tr><td><code id="getHillBootstrap_+3A_mi">mi</code></td>
<td>
<p>index of the desired model to bootstrap and construct confidence intervals on.  If <code>NULL</code> (the default), the
value of <code>bestModIdx</code> in <code>hfitl</code> will be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the same form as produced by <code><a href="#topic+findBestHill">findBestHill</a></code>, with the following additional components:
</p>
<table>
<tr><td><code>ciPass</code></td>
<td>
<p>TRUE if at least 50% of bootstrapping trials result in a converged fit</p>
</td></tr>
<tr><td><code>ciLevs</code></td>
<td>
<p>Equal to the input parameter <code>ciLevs</code></p>
</td></tr>
<tr><td><code>ciMInd</code></td>
<td>
<p>Index of the model used to construct the bootstrapped confidence interval</p>
</td></tr>
<tr><td><code>ciVec</code></td>
<td>
<p>Vector of lower and upper bounds of confidence intervals on all freely varying parameters, in order</p>
</td></tr>
<tr><td><code>bCoefs</code></td>
<td>
<p>Four column array containing complete Hill equation parameters for all resampled fits</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+findBestHill">findBestHill</a></code>, <code><a href="#topic+evalHillEqn">evalHillEqn</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz)
drv &lt;- es8olatmz$compound2=="DMSO"
hfit &lt;- findBestHill(act~conc1,es8olatmz[drv,],defaults=c(0,-2.7))
hfit1 &lt;- getHillBootstrap(hfit)

# Setting 'mi' to 4 constructs a confidence interval on the four-
# parameter Hill model, overriding the 'best' model index
hfit2 &lt;- getHillBootstrap(hfit,ciLevs=c(0.05,0.95),mi=4)
</code></pre>

<hr>
<h2 id='hillConcCorrect'>
Hill-Based Concentration Correction
</h2><span id='topic+hillConcCorrect'></span>

<h3>Description</h3>

<p>Estimates actual underlying concentrations leading to a given set of response measurements based on the assumption that
actual concentrations are log-normally distributed around target concentrations, response errors are normally distributed, and
the actual underlying relationship between concentration and response is represented by the given Hill dose-response model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hillConcCorrect(conc, act, parv, sigr = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hillConcCorrect_+3A_conc">conc</code></td>
<td>
<p> a vector of expected or target concentrations, around which actual concentrations are assumed to be log-normally
distributed </p>
</td></tr>
<tr><td><code id="hillConcCorrect_+3A_act">act</code></td>
<td>
<p> a vector of response values </p>
</td></tr>
<tr><td><code id="hillConcCorrect_+3A_parv">parv</code></td>
<td>
<p> a four-parameter vector specifying a Hill model as described in <code><a href="#topic+evalHillEqn">evalHillEqn</a></code> which is assumed to
be the actual relationship between concentration and response  </p>
</td></tr>
<tr><td><code id="hillConcCorrect_+3A_sigr">sigr</code></td>
<td>
<p> the estimated ratio of the noises in response- and log (base10) concentration-space </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that <code class="reqn">\hat{c}</code> is a given target concentration, and <code class="reqn">c</code> is the actual concentration in given well, plate, or
condition.  Suppose also that <code class="reqn">y</code> is the actual response that would result from the concentration in the given Hill
dose-response model, and <code class="reqn">\hat{y}</code> is the measured response value.  This function assumes that
</p>
<p style="text-align: center;"><code class="reqn">\hat{y} \sim N(y,\sigma)</code>
</p>

<p style="text-align: center;"><code class="reqn">\log_{10} c \sim N(\log_{10}\hat{c},\frac{\sigma}{r})</code>
</p>

<p>for some <code class="reqn">\sigma</code>, where <code class="reqn">N</code> is a normal distribution, and <code class="reqn">r</code> is the ratio specified by the parameter <code>sigr</code>.
Based on these assumptions, the function uses Bayes' rule to calculate the maximum likelihood estimate of <code class="reqn">c</code> for every given
value of <code class="reqn">\hat{c}</code> and <code class="reqn">\hat{y}</code>.
</p>


<h3>Value</h3>

<p>A vector of concentrations representing the maximum likelihood estimates of the actual concentrations which produced the
given responses.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evalHillEqn">evalHillEqn</a></code>, <code><a href="#topic+runBRAIDanalysis">runBRAIDanalysis</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz)
drv &lt;- es8olatmz$compound2=="DMSO"
hfit &lt;- findBestHill(act~conc1,es8olatmz[drv,],defaults=c(0,-2.7))
drvpos &lt;- drv &amp; es8olatmz$conc1&gt;0
cconc &lt;- hillConcCorrect(es8olatmz$conc1[drvpos],es8olatmz$act[drvpos],
			coef(hfit$allfits[[hfit$bestModIdx]]),sigr=1)
</code></pre>

<hr>
<h2 id='invertBRAIDrsm'> Invert BRAID Response Function </h2><span id='topic+invertBRAIDrsm'></span>

<h3>Description</h3>

<p>Determines which drug concentrations, when paired with the given input concentrations, produce the given response
values.  Useful for estimating potentiation of one compound by presence of the other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invertBRAIDrsm(val, DA=NULL, DB=NULL, parv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="invertBRAIDrsm_+3A_val">val</code></td>
<td>
<p> Effect value or values to be inverted.  If a single value, it will be repeated for all values of
<code>DA</code> or <code>DB</code> which are input. </p>
</td></tr>
<tr><td><code id="invertBRAIDrsm_+3A_da">DA</code></td>
<td>
<p> Concentrations of drug A to be inverted.  If NULL (the default), the concentrations in <code>DB</code> will
be inverted and the concentrations of drug A will be estimated. </p>
</td></tr>
<tr><td><code id="invertBRAIDrsm_+3A_db">DB</code></td>
<td>
<p> Concentrations of drug B to be inverted.  If NULL (the default), the concentrations in <code>DA</code> will
be inverted and the concentrations of drug B will be estimated. </p>
</td></tr>
<tr><td><code id="invertBRAIDrsm_+3A_parv">parv</code></td>
<td>
<p> 10-element vector specifying the full set of parameters for the BRAID surface </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of concentrations which, when paired with the given concentrations, produce the given values.  If <code>DA</code>
is NULL, the vector contains the concentrations of drug A corresponding to the concentrations of drug B given in
<code>DB</code>.  If <code>concB</code> is null, the vector contains the concentrations of drug B corresponding to the
concentrations of drug A give in <code>DA</code>.  Exactly one of these two inputs must be NULL.
</p>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+braidrm">braidrm</a></code>, <code><a href="#topic+evalBRAIDrsm">evalBRAIDrsm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>level &lt;- 90
doses &lt;- c(0,10^-8,10^-7,10^-6)
ec90A &lt;- invertBRAIDrsm(level,DB=doses,parv=c(10^-6,10^-6,1.5,1.5,1,1.8,0,100,100,100))
</code></pre>

<hr>
<h2 id='runBRAIDanalysis'>
Run Full BRAID Analysis
</h2><span id='topic+runBRAIDanalysis'></span>

<h3>Description</h3>

<p>Performs a complete analysis of combined action data using the BRAID model.  The behaviors of both drugs alone (if such
doses are included) are fit using a Hill equation; if desired, the resulting Hill equation fits can be used to correct
uncertain or noisy input concentrations for use in combination analysis.  All measurements of the two drugs (in isolation
or in combination) are then fit using the BRAID equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runBRAIDanalysis(data, defaults, llims = NULL, ulims = NULL, itype = 1,
					compounds = NULL, corrconc = FALSE, corrsigr = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runBRAIDanalysis_+3A_data">data</code></td>
<td>
<p> a data frame containing all measurements to be fit.  Must conatin columns named &quot;conc1&quot;, &quot;conc2&quot;, and &quot;act&quot;; other
columns may be required (see Details below). </p>
</td></tr>
<tr><td><code id="runBRAIDanalysis_+3A_defaults">defaults</code></td>
<td>
<p> a two-element vector containing default values for the initial and maximal effects of the combination; used by
<code><a href="#topic+findBestBRAID">findBestBRAID</a></code> to select best BRAID model </p>
</td></tr>
<tr><td><code id="runBRAIDanalysis_+3A_llims">llims</code></td>
<td>
<p> a ten-element vector of lower limits on parameters being fit.   Any parameters that do not require a limit can
have a value of <code>NA</code>. </p>
</td></tr>
<tr><td><code id="runBRAIDanalysis_+3A_ulims">ulims</code></td>
<td>
<p> a vector of upper limits on parameters being fit.  Follows same behavior as <code>llims</code>. </p>
</td></tr>
<tr><td><code id="runBRAIDanalysis_+3A_itype">itype</code></td>
<td>
<p> an integer that specifies the type of interaction(s) that is assumed in the models.  Used by
<code><a href="#topic+findBestBRAID">findBestBRAID</a></code> </p>
</td></tr>
<tr><td><code id="runBRAIDanalysis_+3A_compounds">compounds</code></td>
<td>
<p> an optional parameter specifying which compounds are to be fit; this requires that compounds be identified in
the input data frame <code>data</code>. </p>
</td></tr>
<tr><td><code id="runBRAIDanalysis_+3A_corrconc">corrconc</code></td>
<td>
<p> boolean specifying whether input concentrations will be corrected according to individual dose response using
<code><a href="#topic+hillConcCorrect">hillConcCorrect</a></code>  </p>
</td></tr>
<tr><td><code id="runBRAIDanalysis_+3A_corrsigr">corrsigr</code></td>
<td>
<p> the ratio of noise in measurement to noise the base-10 logarithm of concentration; used by
<code><a href="#topic+hillConcCorrect">hillConcCorrect</a></code> if <code>corrconc</code> is <code>TRUE</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This convenience function is intended as a blueprint for a complete BRAID model analysis.  Though users of this package can
develop their own approaches to applying the BRAID model to combined action data (indeed we encourage it), this function
encapsulates our overall strategy for fitting the BRAID equation.  The input parameter <code>data</code> must contain all measurements
to be fit, with the columns &quot;conc1&quot;, &quot;conc2&quot;, and &quot;act&quot; containing the corresponding inputs and outputs.  If no other columns
required (based on the values of other parameters), &quot;conc1&quot; is assumed to describe the concentration of drug A, and &quot;conc2&quot; the
concentration of drug B, with values of 0 for &quot;conc1&quot; or &quot;conc2&quot; corresponding to conditions with Drug B or Drug A alone,
respectively.
</p>
<p>If <code>data</code> contains measurements from multiple combinations, the identity of the compounds to be analyzed must be specified
in the parameter <code>compounds</code>.  Further, the input data frame <code>data</code> must contain columns named &quot;compound1&quot; and &quot;compound2&quot;
that specify which two compounds were used in each measurement.  Measurements will be used in which &quot;compound1&quot; is equal to the
first element of <code>compounds</code> or &quot;conc1&quot; is equal to 0, and in which &quot;compound2&quot; is equal to the second element of
<code>compounds</code> or &quot;conc2 is equal to 0.  Note that this means measurements in which &quot;conc1&quot; and &quot;conc2&quot; are both equal to 0
will be used in any analysis.
</p>
<p>For concentrations to be corrected in the combination analysis, there must be a correspondence between concentrations of each drug
alone and concentrations used in combination; in our implementation, this is assumed to be the result of a shared drugging plate,
such that measurements corresponding to the same well are given the same actual concentration of drug.  As a result, if
<code>corrconc</code> is set to <code>TRUE</code>, each measurement must be associated with a well specified in a column named &quot;well&quot;.
</p>


<h3>Value</h3>

<p>A list with the following componenents:
</p>
<table>
<tr><td><code>concs</code></td>
<td>
<p> A two-column array containing the concentrations of the first and second drugs used in the analysis.  This will
only inlcude measurements from the input frame <code>data</code> that contained drug A alone, drug B alone, or drug A and B in
combination. Even if <code>corrconc</code> is <code>TRUE</code>, this array will contain the original, uncorrected concentrations. To access
the corrected concentrations, use the <code>conc1</code> and <code>conc2</code> elements of the component <code>braidFit</code> (described below). </p>
</td></tr>
<tr><td><code>act</code></td>
<td>
<p> The measured response values corresponding to the concentration pairs in <code>concs</code>. </p>
</td></tr>
<tr><td><code>corrconc</code></td>
<td>
<p> The value of the input parameter <code>corrconc</code>. </p>
</td></tr>
<tr><td><code>corrsigr</code></td>
<td>
<p> The value of the input parameter <code>corrsigr</code>. </p>
</td></tr>
<tr><td><code>braidFit</code></td>
<td>
<p> The best BRAID model fit as determined by <code><a href="#topic+findBestBRAID">findBestBRAID</a></code>. </p>
</td></tr>
<tr><td><code>hfit1</code></td>
<td>
<p> A set of Hill model fits to the behavior of drug A in isolation, as output by <code><a href="#topic+findBestHill">findBestHill</a></code>. If no
data points for drug A in isolation are included, this component is <code>NULL</code>. </p>
</td></tr>
<tr><td><code>hfit2</code></td>
<td>
<p> A set of Hill model fits to the behavior of drug B in isolation, as output by <code><a href="#topic+findBestHill">findBestHill</a></code>. If no
data points for drug B in isolation are included, this component is <code>NULL</code>. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nathaniel R. Twarog
</p>


<h3>See Also</h3>

<p><code><a href="#topic+braidrm">braidrm</a></code>, <code><a href="#topic+findBestBRAID">findBestBRAID</a></code>, <code><a href="#topic+findBestHill">findBestHill</a></code>, <code><a href="#topic+hillConcCorrect">hillConcCorrect</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es8olatmz)
# Note that 'es8olatmz' contains all necessary column names, including
# 'conc1','conc2','act','compound1','compound2', and, for concentration
# correction, 'well'
## Not run: brdAnalysis &lt;- runBRAIDanalysis(es8olatmz,defaults=c(0,-2.7),corrconc=TRUE)
brdAnalysis &lt;- runBRAIDanalysis(es8olatmz,defaults=c(0,-4))
summary(brdAnalysis$braidFit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
