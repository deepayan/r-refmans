<!DOCTYPE html><html><head><title>Help for package glmmPen</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {glmmPen}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adaptControl'><p>Control of Metropolis-within-Gibbs Adaptive Random Walk Sampling Procedure</p>
</p>
<p>Controls the adaptive random walk Metropolis-within-Gibbs sampling procedure.</p></a></li>
<li><a href='#basal'><p>Basal dataset: A composition of cancer datasets with top scoring pairs</p>
(TSPs) as covariates and binary response indicating if the subject's cancer
subtype was basal-like.
</p>
<p>A dataset composed of four datasets combined from studies that contain</p>
gene expression data from subjects with several types of cancer.
Two of these datasets contain gene expression data for subjects with
Pancreatic Ductal Adenocarcinoma (PDAC), one dataset contains data for
subjects with Breast Cancer, and the fourth dataset contains data for subjects
with Bladder Cancer. The response of interest is whether or not the subject's
cancer subtype was the basal-like subtype.
See articles Rashid et al. (2020) &quot;Modeling Between-Study Heterogeneity for
Improved Replicability in Gene Signature Selection and Clinical Prediction&quot;
and Moffitt et al. (2015) &quot;Virtual microdissection identifies distinct tumor- and
stroma-specific subtypes of pancreatic ductal adenocarcinoma&quot;
for further details on these four datasets.</a></li>
<li><a href='#glmm'><p>Fit a Generalized Mixed Model via Monte Carlo Expectation Conditional Minimization (MCECM)</p></a></li>
<li><a href='#glmm_FA'><p>Fit a Generalized Mixed Model via Monte Carlo Expectation Conditional Minimization (MCECM)</p></a></li>
<li><a href='#glmmPen'><p>Fit Penalized Generalized Mixed Models via Monte Carlo Expectation Conditional</p>
Minimization (MCECM)</a></li>
<li><a href='#glmmPen_FA'><p>Fit Penalized Generalized Mixed Models via Monte Carlo Expectation Conditional</p>
Minimization (MCECM)</a></li>
<li><a href='#lambdaControl'><p>Control of Penalization Parameters and Selection Criteria</p></a></li>
<li><a href='#LambdaSeq'><p>Calculation of Penalty Parameter Sequence (Lambda Sequence)</p></a></li>
<li><a href='#optimControl'><p>Control of Penalized Generalized Linear Mixed Model Fitting</p></a></li>
<li><a href='#pglmmObj-class'><p>Class <code>pglmmObj</code> of Fitted Penalized Generalized Mixed-Effects Models for</p>
package <code>glmmPen</code></a></li>
<li><a href='#phmm'><p>Fit a Proportional Hazards Mixed Model via Monte Carlo Expectation Conditional Minimization (MCECM)</p>
using a Piecewise Constant Hazard Mixed Model Approximation</a></li>
<li><a href='#phmm_FA'><p>Fit a Proportional Hazards Mixed Model via Monte Carlo Expectation Conditional Minimization (MCECM) using</p>
a Piecewise Constant Hazard Mixed Model Approximation</a></li>
<li><a href='#phmmPen'><p>Fit Penalized Proportional Hazards Mixed Models via Monte Carlo Expectation Conditional</p>
Minimization (MCECM) using a Piecewise Constant Hazard Mixed Model Approximation</a></li>
<li><a href='#phmmPen_FA'><p>Fit a Penalized Proportional Hazards Mixed Model via</p>
Monte Carlo Expectation Conditional Minimization (MCECM) using
a Piecewise Constant Hazard Mixed Model Approximation</a></li>
<li><a href='#plot_mcmc'><p>Plot Diagnostics for MCMC Posterior Draws of the Random Effects</p></a></li>
<li><a href='#rControl'><p>Control of Latent Factor Model Number Estimation</p>
</p>
<p>Constructs the control structure for the estimation of the</p>
number of latent factors (r) for use within the <code>glmmPen_FA</code> and
<code>glmm_FA</code> estimation procedures.</a></li>
<li><a href='#sim.data'><p>Simulates data to use for the <code>glmmPen</code> package</p></a></li>
<li><a href='#survival_data'><p>Convert Input Survival Data Into Long-Form Data Needed for Fitting a Piecewise</p>
Exponential Model</a></li>
<li><a href='#survivalControl'><p>Control for Fitting Piecewise Constant Hazard Mixed Models as an Approximation to Fitting</p>
Cox Proportional Hazards Mixed Models</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>High Dimensional Penalized Generalized Linear Mixed Models
(pGLMM)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.4.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-18</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits high dimensional penalized generalized linear 
    mixed models using 
    the Monte Carlo Expectation Conditional Minimization (MCECM) algorithm. 
    The purpose of the package is to perform variable selection on both the fixed and 
    random effects simultaneously for generalized linear mixed models.
    The package supports fitting of Binomial, Gaussian, and Poisson data with canonical links, and
    supports penalization using the MCP, SCAD, or LASSO penalties. The MCECM algorithm
    is described in Rashid et al. (2020) &lt;<a href="https://doi.org/10.1080%2F01621459.2019.1671197">doi:10.1080/01621459.2019.1671197</a>&gt;.
    The techniques used in the minimization portion of the procedure (the M-step) are
    derived from the procedures of the 'ncvreg' package (Breheny and Huang (2011) 
    &lt;<a href="https://doi.org/10.1214%2F10-AOAS388">doi:10.1214/10-AOAS388</a>&gt;) and 'grpreg' package (Breheny and Huang (2015)
    &lt;<a href="https://doi.org/10.1007%2Fs11222-013-9424-2">doi:10.1007/s11222-013-9424-2</a>&gt;), with
    appropriate modifications to account for the estimation and penalization of
    the random effects. The 'ncvreg' and 'grpreg' packages also describe the MCP, SCAD, 
    and LASSO penalties.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, Matrix, methods, ncvreg, reshape2, rstan (&ge; 2.18.1),
stringr, mvtnorm, MASS, survival, rstantools, RcppParallel (&ge;
5.0.1)</td>
</tr>
<tr>
<td>Depends:</td>
<td>lme4, bigmemory, Rcpp (&ge; 0.12.0), R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), bigmemory, Rcpp (&ge; 0.12.0), RcppArmadillo,
RcppEigen (&ge; 0.3.3.3.0), rstan (&ge; 2.18.1), StanHeaders (&ge;
2.18.0), RcppParallel (&ge; 5.0.1)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-18 16:59:25 UTC; hheiling</td>
</tr>
<tr>
<td>Author:</td>
<td>Hillary Heiling [aut, cre],
  Naim Rashid [aut],
  Quefeng Li [aut],
  Joseph Ibrahim [aut]</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hillary Heiling &lt;hmheiling@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-18 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adaptControl'>Control of Metropolis-within-Gibbs Adaptive Random Walk Sampling Procedure
Controls the adaptive random walk Metropolis-within-Gibbs sampling procedure.</h2><span id='topic+adaptControl'></span>

<h3>Description</h3>

<p>Control of Metropolis-within-Gibbs Adaptive Random Walk Sampling Procedure
</p>
<p>Controls the adaptive random walk Metropolis-within-Gibbs sampling procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adaptControl(batch_length = 100, offset = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adaptControl_+3A_batch_length">batch_length</code></td>
<td>
<p>positive integer specifying the number of posterior samples to collect
before the proposal variance is adjusted based on the acceptance rate of the last 
<code>batch_length</code> accepted posterior samples. Default is set to 100. Batch length restricted
to be no less than 50.</p>
</td></tr>
<tr><td><code id="adaptControl_+3A_offset">offset</code></td>
<td>
<p>non-negative integer specifying an offset value for the increment of the proposal
variance adjustment. Optionally used to ensure the required diminishing adaptation condition. 
Default set to 0.
<code style="white-space: pre;">&#8288;
increment = min(0.01, 1 / sqrt(batch*batch_length + offset))
&#8288;</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function returns a list (inheriting from class &quot;<code>adaptControl</code>&quot;) 
containing parameter specifications for the adaptive random walk sampling procedure.
</p>

<hr>
<h2 id='basal'>Basal dataset: A composition of cancer datasets with top scoring pairs
(TSPs) as covariates and binary response indicating if the subject's cancer
subtype was basal-like.
A dataset composed of four datasets combined from studies that contain 
gene expression data from subjects with several types of cancer.
Two of these datasets contain gene expression data for subjects with 
Pancreatic Ductal Adenocarcinoma (PDAC), one dataset contains data for 
subjects with Breast Cancer, and the fourth dataset contains data for subjects 
with Bladder Cancer. The response of interest is whether or not the subject's
cancer subtype was the basal-like subtype.
See articles Rashid et al. (2020) &quot;Modeling Between-Study Heterogeneity for
Improved Replicability in Gene Signature Selection and Clinical Prediction&quot;
and Moffitt et al. (2015) &quot;Virtual microdissection identifies distinct tumor- and 
stroma-specific subtypes of pancreatic ductal adenocarcinoma&quot; 
for further details on these four datasets.</h2><span id='topic+basal'></span>

<h3>Description</h3>

<p>Basal dataset: A composition of cancer datasets with top scoring pairs
(TSPs) as covariates and binary response indicating if the subject's cancer
subtype was basal-like.
</p>
<p>A dataset composed of four datasets combined from studies that contain 
gene expression data from subjects with several types of cancer.
Two of these datasets contain gene expression data for subjects with 
Pancreatic Ductal Adenocarcinoma (PDAC), one dataset contains data for 
subjects with Breast Cancer, and the fourth dataset contains data for subjects 
with Bladder Cancer. The response of interest is whether or not the subject's
cancer subtype was the basal-like subtype.
See articles Rashid et al. (2020) &quot;Modeling Between-Study Heterogeneity for
Improved Replicability in Gene Signature Selection and Clinical Prediction&quot;
and Moffitt et al. (2015) &quot;Virtual microdissection identifies distinct tumor- and 
stroma-specific subtypes of pancreatic ductal adenocarcinoma&quot; 
for further details on these four datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("basal")
</code></pre>


<h3>Format</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>y</dt><dd><p>binary response vector; 1 indicates that the subject's cancer
was of the basal-like subtype, 0 otherwise</p>
</dd>
<dt>X</dt><dd><p>matrix of 50 top scoring pair (TSP) covariates</p>
</dd>
<dt>group</dt><dd><p>factor indicating which cancer study the observation belongs to,
which are given the following descriptions:
UNC PDAC, TCGA PDAC, TCGA Bladder Cancer, and UNC Breast Cancer</p>
</dd>
<dt>Z</dt><dd><p>model matrix for random effects; organized first by variable, then
by group (i.e. by cancer study)</p>
</dd>
</dl>


<hr>
<h2 id='glmm'>Fit a Generalized Mixed Model via Monte Carlo Expectation Conditional Minimization (MCECM)</h2><span id='topic+glmm'></span>

<h3>Description</h3>

<p><code>glmm</code> is used to fit a single generalized mixed model via Monte Carlo 
Expectation Conditional Minimization (MCECM). Unlike <code>glmmPen</code>, no model selection 
is performed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmm(
  formula,
  data = NULL,
  family = "binomial",
  covar = NULL,
  offset = NULL,
  optim_options = optimControl(),
  adapt_RW_options = adaptControl(),
  trace = 0,
  tuning_options = lambdaControl(),
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmm_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed effects and 
random effects part of the model, with the response on the left of a ~ operator and the terms, 
separated by + operators, on the right. Random-effects terms are distinguished by vertical bars 
(&quot;|&quot;) separating expression for design matrices from the grouping factor. <code>formula</code> should be 
of the same format needed for <code><a href="lme4.html#topic+glmer">glmer</a></code> in package <span class="pkg">lme4</span>. 
Only one grouping factor 
will be recognized. The random effects covariates need to be a subset of the fixed effects covariates.
The offset must be specified outside of the formula in the 'offset' argument.</p>
</td></tr>
<tr><td><code id="glmm_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>. If <code>data</code> is 
omitted, variables will be taken from the environment of <code>formula</code>.</p>
</td></tr>
<tr><td><code id="glmm_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. 
Currently, the <code>glmmPen</code> algorithm allows the Binomial (&quot;binomial&quot; or binomial()), 
Gaussian (&quot;gaussian&quot; or gaussian()), and Poisson (&quot;poisson&quot; or poisson()) families
with canonical links only. See <code><a href="#topic+phmmPen">phmmPen</a></code> for variable selection within
proportional hazards mixed models for survival data.</p>
</td></tr>
<tr><td><code id="glmm_+3A_covar">covar</code></td>
<td>
<p>character string specifying whether the covariance matrix should be unstructured
(&quot;unstructured&quot;) or diagonal with no covariances between variables (&quot;independent&quot;).
Default is set to <code>NULL</code>. If <code>covar</code> is set to <code>NULL</code> and the number of random effects
predictors (not including the intercept) is 
greater than or equal to 10 (i.e. high dimensional), then the algorithm automatically assumes an 
independent covariance structure and <code>covar</code> is set to &quot;independent&quot;. Otherwise if <code>covar</code>
is set to <code>NULL</code> and the number of random effects predictors is less than 10, then the
algorithm automatically assumes an unstructured covariance structure and <code>covar</code> is set to &quot;unstructured&quot;.</p>
</td></tr>
<tr><td><code id="glmm_+3A_offset">offset</code></td>
<td>
<p>This can be used to specify an <em>a priori</em> known component to be included in the 
linear predictor during fitting. Default set to <code>NULL</code> (no offset). If the data 
argument is not <code>NULL</code>, this should be a numeric vector of length equal to the 
number of cases (the length of the response vector). 
If the data argument specifies a data.frame, the offset
argument should specify the name of a column in the data.frame.</p>
</td></tr>
<tr><td><code id="glmm_+3A_optim_options">optim_options</code></td>
<td>
<p>a structure of class &quot;optimControl&quot; created 
from function <code><a href="#topic+optimControl">optimControl</a></code> that specifies several optimization parameters. See the 
documentation for <code><a href="#topic+optimControl">optimControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="glmm_+3A_adapt_rw_options">adapt_RW_options</code></td>
<td>
<p>a list of class &quot;adaptControl&quot; from function <code><a href="#topic+adaptControl">adaptControl</a></code> 
containing the control parameters for the adaptive random walk Metropolis-within-Gibbs procedure. 
Ignored if <code><a href="#topic+optimControl">optimControl</a></code> parameter <code>sampler</code> is set to &quot;stan&quot; (default) or &quot;independence&quot;.</p>
</td></tr>
<tr><td><code id="glmm_+3A_trace">trace</code></td>
<td>
<p>an integer specifying print output to include as function runs. Default value is 0. 
See Details for more information about output provided when trace = 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="glmm_+3A_tuning_options">tuning_options</code></td>
<td>
<p>a list of class &quot;selectControl&quot; or &quot;lambdaControl&quot; resulting from 
<code><a href="#topic+selectControl">selectControl</a></code> or <code><a href="#topic+lambdaControl">lambdaControl</a></code> containing additional control parameters.
When function <code>glmm</code> is used,the algorithm may be run using one specific set of
penalty parameters <code>lambda0</code> and <code>lambda1</code> by specifying such values in <code>lambdaControl()</code>. 
The default for <code>glmm</code> is to run the model fit with no penalization (<code>lambda0</code> = <code>lambda1</code> = 0).
When function <code>glmmPen</code> is run, <code>tuning_options</code> is specified using <code>selectControl()</code>. 
See the <code><a href="#topic+lambdaControl">lambdaControl</a></code> and <code><a href="#topic+selectControl">selectControl</a></code> documentation for further details.</p>
</td></tr>
<tr><td><code id="glmm_+3A_progress">progress</code></td>
<td>
<p>a logical value indicating if additional output should be given showing the
progress of the fit procedure. If <code>TRUE</code>, such output includes iteration-level information
for the fit procedure (iteration number EM_iter,
number of MCMC samples nMC, average Euclidean distance between current coefficients and coefficients
from t&ndash;defined in <code><a href="#topic+optimControl">optimControl</a></code>&ndash;iterations back EM_conv, 
and number of non-zero fixed and random effects covariates
not including the intercept). Additionally, <code>progress = TRUE</code>
gives some other information regarding the progress of the variable selection 
procedure, including the model selection criteria and log-likelihood estimates
for each model fit.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="glmm_+3A_...">...</code></td>
<td>
<p>additional arguments that could be passed into <code>glmmPen</code>. See <code><a href="#topic+glmmPen">glmmPen</a></code>
for further details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>glmm</code> function can be used to fit a single generalized mixed model.
While this approach is meant to be used in the case where the user knows which
covariates belong in the fixed and random effects and no penalization is required, one is
allowed to specify non-zero fixed and random effects penalties using <code><a href="#topic+lambdaControl">lambdaControl</a></code>
and the (...) arguments. The (...) allow for specification of penalty-related arguments; see
<code><a href="#topic+glmmPen">glmmPen</a></code> for details. For a high dimensional situation, the user may want to fit a 
minimal penalty model using a small penalty for the fixed and random effects and save the posterior
samples from this minimal penalty model for use in any BIC-ICQ calculations during selection within <code>glmmPen</code>. 
Specifying a file name in the 'BICq_posterior' argument will save the posterior samples from the 
<code>glmm</code> model into a big.matrix with this file name, see the Details section of 
<code><a href="#topic+glmmPen">glmmPen</a></code> for additional details.
</p>


<h3>Value</h3>

<p>A reference class object of class <code><a href="#topic+pglmmObj">pglmmObj</a></code> for which many methods are 
available (e.g. <code>methods(class = "pglmmObj")</code>)
</p>

<hr>
<h2 id='glmm_FA'>Fit a Generalized Mixed Model via Monte Carlo Expectation Conditional Minimization (MCECM)</h2><span id='topic+glmm_FA'></span>

<h3>Description</h3>

<p><code>glmm_FA</code> is used to fit a single generalized linear mixed model via Monte Carlo 
Expectation Conditional Minimization (MCECM) using a factor model decomposition of
the random effects. No model selection is performed. 
This function uses a factor model decomposition on the random effects. This assumption
reduces the latent space in the E-step (Expectation step) of the algorithm,
which reduces the computational complexity of the algorithm. This improves
the speed of the algorithm and enables the scaling of the algorithm to larger dimensions.
Besides the modeling of the random effects, this function is similar to <code><a href="#topic+glmm">glmm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmm_FA(
  formula,
  data = NULL,
  family = "binomial",
  offset = NULL,
  r_estimation = rControl(),
  optim_options = optimControl(),
  adapt_RW_options = adaptControl(),
  trace = 0,
  tuning_options = lambdaControl(),
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmm_FA_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed effects and 
random effects part of the model, with the response on the left of a ~ operator and the terms, 
separated by + operators, on the right. Random-effects terms are distinguished by vertical bars 
(&quot;|&quot;) separating expression for design matrices from the grouping factor. <code>formula</code> should be 
of the same format needed for <code><a href="lme4.html#topic+glmer">glmer</a></code> in package <span class="pkg">lme4</span>. 
Only one grouping factor 
will be recognized. The random effects covariates need to be a subset of the fixed effects covariates.
The offset must be specified outside of the formula in the 'offset' argument.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>. If <code>data</code> is 
omitted, variables will be taken from the environment of <code>formula</code>.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. 
Currently, the <code>glmmPen</code> algorithm allows the Binomial (&quot;binomial&quot; or binomial()), 
Gaussian (&quot;gaussian&quot; or gaussian()), and Poisson (&quot;poisson&quot; or poisson()) families
with canonical links only. See <code><a href="#topic+phmmPen">phmmPen</a></code> for variable selection within
proportional hazards mixed models for survival data.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_offset">offset</code></td>
<td>
<p>This can be used to specify an <em>a priori</em> known component to be included in the 
linear predictor during fitting. Default set to <code>NULL</code> (no offset). If the data 
argument is not <code>NULL</code>, this should be a numeric vector of length equal to the 
number of cases (the length of the response vector). 
If the data argument specifies a data.frame, the offset
argument should specify the name of a column in the data.frame.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_r_estimation">r_estimation</code></td>
<td>
<p>a list of class &quot;rControl&quot; from function <code><a href="#topic+rControl">rControl</a></code> 
containing the control parameters for the estimation of the number of latent
factors to use in the <code>glmmPen_FA</code> and <code>glmm_FA</code> estimation procedures.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_optim_options">optim_options</code></td>
<td>
<p>a structure of class &quot;optimControl&quot; created 
from function <code><a href="#topic+optimControl">optimControl</a></code> that specifies several optimization parameters. See the 
documentation for <code><a href="#topic+optimControl">optimControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_adapt_rw_options">adapt_RW_options</code></td>
<td>
<p>a list of class &quot;adaptControl&quot; from function <code><a href="#topic+adaptControl">adaptControl</a></code> 
containing the control parameters for the adaptive random walk Metropolis-within-Gibbs procedure. 
Ignored if <code><a href="#topic+optimControl">optimControl</a></code> parameter <code>sampler</code> is set to &quot;stan&quot; (default) or &quot;independence&quot;.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_trace">trace</code></td>
<td>
<p>an integer specifying print output to include as function runs. Default value is 0. 
See Details for more information about output provided when trace = 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_tuning_options">tuning_options</code></td>
<td>
<p>a list of class &quot;selectControl&quot; or &quot;lambdaControl&quot; resulting from 
<code><a href="#topic+selectControl">selectControl</a></code> or <code><a href="#topic+lambdaControl">lambdaControl</a></code> containing additional control parameters.
When function <code>glmm</code> is used,the algorithm may be run using one specific set of
penalty parameters <code>lambda0</code> and <code>lambda1</code> by specifying such values in <code>lambdaControl()</code>. 
The default for <code>glmm</code> is to run the model fit with no penalization (<code>lambda0</code> = <code>lambda1</code> = 0).
When function <code>glmmPen</code> is run, <code>tuning_options</code> is specified using <code>selectControl()</code>. 
See the <code><a href="#topic+lambdaControl">lambdaControl</a></code> and <code><a href="#topic+selectControl">selectControl</a></code> documentation for further details.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_progress">progress</code></td>
<td>
<p>a logical value indicating if additional output should be given showing the
progress of the fit procedure. If <code>TRUE</code>, such output includes iteration-level information
for the fit procedure (iteration number EM_iter,
number of MCMC samples nMC, average Euclidean distance between current coefficients and coefficients
from t&ndash;defined in <code><a href="#topic+optimControl">optimControl</a></code>&ndash;iterations back EM_conv, 
and number of non-zero fixed and random effects covariates
not including the intercept). Additionally, <code>progress = TRUE</code>
gives some other information regarding the progress of the variable selection 
procedure, including the model selection criteria and log-likelihood estimates
for each model fit.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="glmm_FA_+3A_...">...</code></td>
<td>
<p>additional arguments that could be passed into <code>glmmPen_FA</code>. 
See <code><a href="#topic+glmmPen_FA">glmmPen_FA</a></code> for further details (e.g. arguments related to variable selection
that could be used to fit a single penalized GLMM model).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>glmm_FA</code> function can be used to fit a single generalized linear mixed model.
While this approach is meant to be used in the case where the user knows which
covariates belong in the fixed and random effects and no penalization is required, one is
allowed to specify non-zero fixed and random effects penalties using <code><a href="#topic+lambdaControl">lambdaControl</a></code>
and the (...) arguments. The (...) allow for specification of penalty-related arguments; see
<code><a href="#topic+glmmPen_FA">glmmPen_FA</a></code> for details. For a high dimensional situation, the user may want to fit a 
full model using a small penalty for the fixed and random effects and save the posterior
draws from this full model for use in any BIC-ICQ calculations during selection within <code>glmmPen_FA</code>. 
Specifying a file name in the 'BICq_posterior' argument will save the posterior draws from the 
<code>glmm_FA</code> model into a big.matrix with this file name, see the Details section of 
<code><a href="#topic+glmmPen_FA">glmmPen_FA</a></code> for additional details.
</p>


<h3>Value</h3>

<p>A reference class object of class <code><a href="#topic+pglmmObj">pglmmObj</a></code> for which many methods are 
available (e.g. <code>methods(class = "pglmmObj")</code>)
</p>

<hr>
<h2 id='glmmPen'>Fit Penalized Generalized Mixed Models via Monte Carlo Expectation Conditional 
Minimization (MCECM)</h2><span id='topic+glmmPen'></span>

<h3>Description</h3>

<p><code>glmmPen</code> is used to fit penalized generalized mixed models via Monte Carlo Expectation 
Conditional Minimization (MCECM). The purpose of the function is to perform 
variable selection on both the fixed and random effects simultaneously for the
generalized linear mixed model. <code>glmmPen</code> selects the best model using 
BIC-type selection criteria (see <code><a href="#topic+selectControl">selectControl</a></code> documentation for 
further details). To improve the speed of the algorithm, consider setting
<code>var_restrictions</code> = &quot;fixef&quot; within the <code><a href="#topic+optimControl">optimControl</a></code> options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmmPen(
  formula,
  data = NULL,
  family = "binomial",
  covar = NULL,
  offset = NULL,
  fixef_noPen = NULL,
  penalty = c("MCP", "SCAD", "lasso"),
  alpha = 1,
  gamma_penalty = switch(penalty[1], SCAD = 4, 3),
  optim_options = optimControl(),
  adapt_RW_options = adaptControl(),
  trace = 0,
  tuning_options = selectControl(),
  BICq_posterior = NULL,
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmmPen_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed effects and 
random effects part of the model, with the response on the left of a ~ operator and the terms, 
separated by + operators, on the right. Random-effects terms are distinguished by vertical bars 
(&quot;|&quot;) separating expression for design matrices from the grouping factor. <code>formula</code> should be 
of the same format needed for <code><a href="lme4.html#topic+glmer">glmer</a></code> in package <span class="pkg">lme4</span>. 
Only one grouping factor 
will be recognized. The random effects covariates need to be a subset of the fixed effects covariates.
The offset must be specified outside of the formula in the 'offset' argument.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>. If <code>data</code> is 
omitted, variables will be taken from the environment of <code>formula</code>.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. 
Currently, the <code>glmmPen</code> algorithm allows the Binomial (&quot;binomial&quot; or binomial()), 
Gaussian (&quot;gaussian&quot; or gaussian()), and Poisson (&quot;poisson&quot; or poisson()) families
with canonical links only. See <code><a href="#topic+phmmPen">phmmPen</a></code> for variable selection within
proportional hazards mixed models for survival data.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_covar">covar</code></td>
<td>
<p>character string specifying whether the covariance matrix should be unstructured
(&quot;unstructured&quot;) or diagonal with no covariances between variables (&quot;independent&quot;).
Default is set to <code>NULL</code>. If <code>covar</code> is set to <code>NULL</code> and the number of random effects
predictors (not including the intercept) is 
greater than or equal to 10 (i.e. high dimensional), then the algorithm automatically assumes an 
independent covariance structure and <code>covar</code> is set to &quot;independent&quot;. Otherwise if <code>covar</code>
is set to <code>NULL</code> and the number of random effects predictors is less than 10, then the
algorithm automatically assumes an unstructured covariance structure and <code>covar</code> is set to &quot;unstructured&quot;.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_offset">offset</code></td>
<td>
<p>This can be used to specify an <em>a priori</em> known component to be included in the 
linear predictor during fitting. Default set to <code>NULL</code> (no offset). If the data 
argument is not <code>NULL</code>, this should be a numeric vector of length equal to the 
number of cases (the length of the response vector). 
If the data argument specifies a data.frame, the offset
argument should specify the name of a column in the data.frame.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_fixef_nopen">fixef_noPen</code></td>
<td>
<p>Optional vector of 0's and 1's of the same length as the number of fixed effects covariates
used in the model. Value 0 indicates the variable should not have its fixed effect coefficient
penalized, 1 indicates that it can be penalized. Order should correspond to the same order of the 
fixed effects given in the formula.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_penalty">penalty</code></td>
<td>
<p>character describing the type of penalty to use in the variable selection procedure.
Options include 'MCP', 'SCAD', and 'lasso'. Default is MCP penalty. If the random effect covariance
matrix is &quot;unstructured&quot;, then a group MCP, group SCAD, or group LASSO penalty is used on the 
random effects coefficients. See Breheny and Huang (2011) &lt;doi:10.1214/10-AOAS388&gt; 
and Breheny and Huang (2015) &lt;doi:10.1007/s11222-013-9424-2&gt; for details of these penalties.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_alpha">alpha</code></td>
<td>
<p>Tuning parameter for the Mnet estimator which controls the relative contributions 
from the MCP/SCAD/LASSO penalty and the ridge, or L2, penalty. <code>alpha=1</code> is equivalent to 
the MCP/SCAD/LASSO penalty, while <code>alpha=0</code> is equivalent to ridge regression. However,
<code>alpha=0</code> is not supported; <code>alpha</code> may be arbitrarily small, but not exactly zero</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_gamma_penalty">gamma_penalty</code></td>
<td>
<p>The scaling factor of the MCP and SCAD penalties. Not used by LASSO penalty.
Default is 4.0 for SCAD and 3.0 for MCP. See Breheny and Huang (2011) &lt;doi:10.1214/10-AOAS388&gt; 
and Breheny and Huang (2015) &lt;doi:10.1007/s11222-013-9424-2&gt; for further details.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_optim_options">optim_options</code></td>
<td>
<p>a structure of class &quot;optimControl&quot; created 
from function <code><a href="#topic+optimControl">optimControl</a></code> that specifies several optimization parameters. See the 
documentation for <code><a href="#topic+optimControl">optimControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_adapt_rw_options">adapt_RW_options</code></td>
<td>
<p>a list of class &quot;adaptControl&quot; from function <code><a href="#topic+adaptControl">adaptControl</a></code> 
containing the control parameters for the adaptive random walk Metropolis-within-Gibbs procedure. 
Ignored if <code><a href="#topic+optimControl">optimControl</a></code> parameter <code>sampler</code> is set to &quot;stan&quot; (default) or &quot;independence&quot;.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_trace">trace</code></td>
<td>
<p>an integer specifying print output to include as function runs. Default value is 0. 
See Details for more information about output provided when trace = 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_tuning_options">tuning_options</code></td>
<td>
<p>a list of class &quot;selectControl&quot; or &quot;lambdaControl&quot; resulting from 
<code><a href="#topic+selectControl">selectControl</a></code> or <code><a href="#topic+lambdaControl">lambdaControl</a></code> containing additional control parameters.
When function <code>glmm</code> is used,the algorithm may be run using one specific set of
penalty parameters <code>lambda0</code> and <code>lambda1</code> by specifying such values in <code>lambdaControl()</code>. 
The default for <code>glmm</code> is to run the model fit with no penalization (<code>lambda0</code> = <code>lambda1</code> = 0).
When function <code>glmmPen</code> is run, <code>tuning_options</code> is specified using <code>selectControl()</code>. 
See the <code><a href="#topic+lambdaControl">lambdaControl</a></code> and <code><a href="#topic+selectControl">selectControl</a></code> documentation for further details.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_bicq_posterior">BICq_posterior</code></td>
<td>
<p>an optional character string expressing the path and file 
basename of a file combination that 
will file-back or currently file-backs a <code>big.matrix</code> of the posterior samples from the 
minimal penalty model used for the BIC-ICQ calculation used for model selection. T
(BIC-ICQ reference: Ibrahim et al (2011)
&lt;doi:10.1111/j.1541-0420.2010.01463.x&gt;). 
If this argument is
specified as <code>NULL</code> (default) and BIC-ICQ calculations are requested (see <code><a href="#topic+selectControl">selectControl</a></code>)
for details), the posterior samples
will be saved in the file combination 'BICq_Posterior_Draws.bin' and 'BICq_Posterior_Draws.desc'
in the working directory.
See 'Details' section for additional details about the required format of <code>BICq_posterior</code>
and the file-backed big matrix.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_progress">progress</code></td>
<td>
<p>a logical value indicating if additional output should be given showing the
progress of the fit procedure. If <code>TRUE</code>, such output includes iteration-level information
for the fit procedure (iteration number EM_iter,
number of MCMC samples nMC, average Euclidean distance between current coefficients and coefficients
from t&ndash;defined in <code><a href="#topic+optimControl">optimControl</a></code>&ndash;iterations back EM_conv, 
and number of non-zero fixed and random effects covariates
not including the intercept). Additionally, <code>progress = TRUE</code>
gives some other information regarding the progress of the variable selection 
procedure, including the model selection criteria and log-likelihood estimates
for each model fit.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="glmmPen_+3A_...">...</code></td>
<td>
<p>additional arguments that could be passed into <code>glmmPen</code>. See <code><a href="#topic+glmmPen_FA">glmmPen_FA</a></code>
and <code><a href="#topic+phmmPen_FA">phmmPen_FA</a></code> for further details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>BICq_posterior</code> details: If the <code>BIC_option</code> in <code><a href="#topic+selectControl">selectControl</a></code> 
(<code>tuning_options</code>) is specified 
to be 'BICq', this requests the calculation of the BIC-ICQ criterion during the selection
process. For the BIC-ICQ criterion to be calculated, a minimal penalty model assuming a small valued 
lambda penalty needs to be fit, and the posterior samples from this minimal penalty model need to be used. 
In order to avoid repetitive calculations of
this minimal penalty model (i.e. if the user wants to re-run <code>glmmPen</code> with a different
set of penalty parameters), a <code>big.matrix</code> of these 
posterior samples will be file-backed as two files: a backing file with extension '.bin' and a 
descriptor file with extension '.desc'. The <code>BICq_posterior</code> argument should contain a 
path and a filename of the form &quot;./path/filename&quot; such that the backingfile and
the descriptor file would then be saved as &quot;./path/filename.bin&quot; and &quot;./path/filename.desc&quot;, respectively.
If <code>BICq_posterior</code> is set to <code>NULL</code>, then by default, the backingfile and descriptor
file are saved in the working directory as &quot;BICq_Posterior_Draws.bin&quot; and &quot;BICq_Posterior_Draws.desc&quot;.
If the big matrix of posterior samples is already file-backed, <code>BICq_posterior</code> should
specify the path and basename of the appropriate files (again of form &quot;./path/filename&quot;); 
the minimal penalty model 
will not be fit again and the big.matrix of 
posterior samples will be read using the <code>attach.big.matrix</code> function of the
<code>bigmemory</code> package and used in the BIC-ICQ 
calculations. If the appropriate files do not exist or <code>BICq_posterior</code> 
is specified as <code>NULL</code>, the minimal penalty model will be fit and the minimal penalty model posterior
samples will be saved as specified above. The algorithm will save 10^4 posterior samples automatically.
</p>
<p>Trace details: The value of 0 (default) does not output any extra information. The value of 1
additionally outputs the updated coefficients, updated covariance matrix values, and the
number of coordinate descent iterations used for the M step for each
EM iteration. When pre-screening procedure is used and/or if the BIC-ICQ criterion is
requested, trace = 1 gives additional information about the penalties used
for the 'minimal penalty model' fit procedure. If Stan is not used as the E-step sampling mechanism, 
the value of 2 outputs all of the above plus gibbs acceptance rate information
for the adaptive random walk and independence samplers and the updated proposal standard deviation
for the adaptive random walk.
</p>


<h3>Value</h3>

<p>A reference class object of class <code><a href="#topic+pglmmObj">pglmmObj</a></code> for which many methods are 
available (e.g. <code>methods(class = "pglmmObj")</code>, see ?pglmmObj for additional documentation)
</p>

<hr>
<h2 id='glmmPen_FA'>Fit Penalized Generalized Mixed Models via Monte Carlo Expectation Conditional 
Minimization (MCECM)</h2><span id='topic+glmmPen_FA'></span>

<h3>Description</h3>

<p><code>glmmPen_FA</code> is used to fit penalized generalized linear mixed models via 
Monte Carlo Expectation Conditional Minimization (MCECM) using a factor model decomposition of
the random effects. The purpose of the function is to perform 
variable selection on both the fixed and random effects simultaneously for the
generalized linear mixed model. 
This function uses a factor model decomposition on the random effects. This assumption
reduces the latent space in the E-step (Expectation step) of the algorithm,
which reduces the computational complexity of the algorithm. This improves
the speed of the algorithm and enables the scaling of the algorithm to larger dimensions.
Besides the modeling of the random effects, this function is similar to <code><a href="#topic+glmmPen">glmmPen</a></code>.
<code>glmmPen_FA</code> selects the best model using 
BIC-type selection criteria (see <code><a href="#topic+selectControl">selectControl</a></code> documentation for 
further details). 
Function is currently available for Binomial and Poisson families with canonical links.
To improve the speed of the algorithm, consider setting
<code>var_restrictions</code> = &quot;fixef&quot; within the <code><a href="#topic+optimControl">optimControl</a></code> options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmmPen_FA(
  formula,
  data = NULL,
  family = "binomial",
  offset = NULL,
  r_estimation = rControl(),
  fixef_noPen = NULL,
  penalty = c("MCP", "SCAD", "lasso"),
  alpha = 1,
  gamma_penalty = switch(penalty[1], SCAD = 4, 3),
  optim_options = optimControl(),
  adapt_RW_options = adaptControl(),
  trace = 0,
  tuning_options = selectControl(),
  BICq_posterior = NULL,
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmmPen_FA_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed effects and 
random effects part of the model, with the response on the left of a ~ operator and the terms, 
separated by + operators, on the right. Random-effects terms are distinguished by vertical bars 
(&quot;|&quot;) separating expression for design matrices from the grouping factor. <code>formula</code> should be 
of the same format needed for <code><a href="lme4.html#topic+glmer">glmer</a></code> in package <span class="pkg">lme4</span>. 
Only one grouping factor 
will be recognized. The random effects covariates need to be a subset of the fixed effects covariates.
The offset must be specified outside of the formula in the 'offset' argument.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>. If <code>data</code> is 
omitted, variables will be taken from the environment of <code>formula</code>.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. 
Currently, the <code>glmmPen</code> algorithm allows the Binomial (&quot;binomial&quot; or binomial()), 
Gaussian (&quot;gaussian&quot; or gaussian()), and Poisson (&quot;poisson&quot; or poisson()) families
with canonical links only. See <code><a href="#topic+phmmPen">phmmPen</a></code> for variable selection within
proportional hazards mixed models for survival data.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_offset">offset</code></td>
<td>
<p>This can be used to specify an <em>a priori</em> known component to be included in the 
linear predictor during fitting. Default set to <code>NULL</code> (no offset). If the data 
argument is not <code>NULL</code>, this should be a numeric vector of length equal to the 
number of cases (the length of the response vector). 
If the data argument specifies a data.frame, the offset
argument should specify the name of a column in the data.frame.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_r_estimation">r_estimation</code></td>
<td>
<p>a list of class &quot;rControl&quot; from function <code><a href="#topic+rControl">rControl</a></code> 
containing the control parameters for the estimation of the number of latent
factors to use in the <code>glmmPen_FA</code> and <code>glmm_FA</code> estimation procedures.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_fixef_nopen">fixef_noPen</code></td>
<td>
<p>Optional vector of 0's and 1's of the same length as the number of fixed effects covariates
used in the model. Value 0 indicates the variable should not have its fixed effect coefficient
penalized, 1 indicates that it can be penalized. Order should correspond to the same order of the 
fixed effects given in the formula.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_penalty">penalty</code></td>
<td>
<p>character describing the type of penalty to use in the variable selection procedure.
Options include 'MCP', 'SCAD', and 'lasso'. Default is MCP penalty. If the random effect covariance
matrix is &quot;unstructured&quot;, then a group MCP, group SCAD, or group LASSO penalty is used on the 
random effects coefficients. See Breheny and Huang (2011) &lt;doi:10.1214/10-AOAS388&gt; 
and Breheny and Huang (2015) &lt;doi:10.1007/s11222-013-9424-2&gt; for details of these penalties.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_alpha">alpha</code></td>
<td>
<p>Tuning parameter for the Mnet estimator which controls the relative contributions 
from the MCP/SCAD/LASSO penalty and the ridge, or L2, penalty. <code>alpha=1</code> is equivalent to 
the MCP/SCAD/LASSO penalty, while <code>alpha=0</code> is equivalent to ridge regression. However,
<code>alpha=0</code> is not supported; <code>alpha</code> may be arbitrarily small, but not exactly zero</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_gamma_penalty">gamma_penalty</code></td>
<td>
<p>The scaling factor of the MCP and SCAD penalties. Not used by LASSO penalty.
Default is 4.0 for SCAD and 3.0 for MCP. See Breheny and Huang (2011) &lt;doi:10.1214/10-AOAS388&gt; 
and Breheny and Huang (2015) &lt;doi:10.1007/s11222-013-9424-2&gt; for further details.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_optim_options">optim_options</code></td>
<td>
<p>a structure of class &quot;optimControl&quot; created 
from function <code><a href="#topic+optimControl">optimControl</a></code> that specifies several optimization parameters. See the 
documentation for <code><a href="#topic+optimControl">optimControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_adapt_rw_options">adapt_RW_options</code></td>
<td>
<p>a list of class &quot;adaptControl&quot; from function <code><a href="#topic+adaptControl">adaptControl</a></code> 
containing the control parameters for the adaptive random walk Metropolis-within-Gibbs procedure. 
Ignored if <code><a href="#topic+optimControl">optimControl</a></code> parameter <code>sampler</code> is set to &quot;stan&quot; (default) or &quot;independence&quot;.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_trace">trace</code></td>
<td>
<p>an integer specifying print output to include as function runs. Default value is 0. 
See Details for more information about output provided when trace = 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_tuning_options">tuning_options</code></td>
<td>
<p>a list of class &quot;selectControl&quot; or &quot;lambdaControl&quot; resulting from 
<code><a href="#topic+selectControl">selectControl</a></code> or <code><a href="#topic+lambdaControl">lambdaControl</a></code> containing additional control parameters.
When function <code>glmm</code> is used,the algorithm may be run using one specific set of
penalty parameters <code>lambda0</code> and <code>lambda1</code> by specifying such values in <code>lambdaControl()</code>. 
The default for <code>glmm</code> is to run the model fit with no penalization (<code>lambda0</code> = <code>lambda1</code> = 0).
When function <code>glmmPen</code> is run, <code>tuning_options</code> is specified using <code>selectControl()</code>. 
See the <code><a href="#topic+lambdaControl">lambdaControl</a></code> and <code><a href="#topic+selectControl">selectControl</a></code> documentation for further details.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_bicq_posterior">BICq_posterior</code></td>
<td>
<p>an optional character string expressing the path and file 
basename of a file combination that 
will file-back or currently file-backs a <code>big.matrix</code> of the posterior samples from the 
minimal penalty model used for the BIC-ICQ calculation used for model selection. T
(BIC-ICQ reference: Ibrahim et al (2011)
&lt;doi:10.1111/j.1541-0420.2010.01463.x&gt;). 
If this argument is
specified as <code>NULL</code> (default) and BIC-ICQ calculations are requested (see <code><a href="#topic+selectControl">selectControl</a></code>)
for details), the posterior samples
will be saved in the file combination 'BICq_Posterior_Draws.bin' and 'BICq_Posterior_Draws.desc'
in the working directory.
See 'Details' section for additional details about the required format of <code>BICq_posterior</code>
and the file-backed big matrix.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_progress">progress</code></td>
<td>
<p>a logical value indicating if additional output should be given showing the
progress of the fit procedure. If <code>TRUE</code>, such output includes iteration-level information
for the fit procedure (iteration number EM_iter,
number of MCMC samples nMC, average Euclidean distance between current coefficients and coefficients
from t&ndash;defined in <code><a href="#topic+optimControl">optimControl</a></code>&ndash;iterations back EM_conv, 
and number of non-zero fixed and random effects covariates
not including the intercept). Additionally, <code>progress = TRUE</code>
gives some other information regarding the progress of the variable selection 
procedure, including the model selection criteria and log-likelihood estimates
for each model fit.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="glmmPen_FA_+3A_...">...</code></td>
<td>
<p>additional arguments that could be passed into <code>glmmPen_FA</code>. 
See <code><a href="#topic+phmmPen_FA">phmmPen_FA</a></code> for further details (e.g. <code>survival_options</code> argument).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>BICq_posterior</code> details: If the <code>BIC_option</code> in <code><a href="#topic+selectControl">selectControl</a></code> 
(<code>tuning_options</code>) is specified 
to be 'BICq', this requests the calculation of the BIC-ICQ criterion during the selection
process. For the BIC-ICQ criterion to be calculated, a full model assuming a small valued 
lambda penalty needs to be fit, and the posterior draws from this full model need to be used. 
In order to avoid repetitive calculations of
this full model (i.e. if the user wants to re-run <code>glmmPen</code> with a different
set of penalty parameters), a <code>big.matrix</code> of these 
posterior draws will be file-backed as two files: a backing file with extention '.bin' and a 
descriptor file with extension '.desc'. The <code>BICq_posterior</code> argument should contain a 
path and a filename with no extension of the form &quot;./path/filename&quot; such that the backingfile and
the descriptor file would then be saved as &quot;./path/filename.bin&quot; and &quot;./path/filename.desc&quot;, respectively.
If <code>BICq_posterior</code> is set to <code>NULL</code>, then by default, the backingfile and descriptor
file are saved in the working directory as &quot;BICq_Posterior_Draws.bin&quot; and &quot;BICq_Posterior_Draws.desc&quot;.
If the big matrix of posterior draws is already file-backed, <code>BICq_posterior</code> should
specify the path and basename of the appropriate files (again of form &quot;./path/filename&quot;); 
the full model 
will not be fit again and the big.matrix of 
posterior draws will be read using the <code>attach.big.matrix</code> function of the
<code>bigmemory</code> package and used in the BIC-ICQ 
calcuations. If the appropriate files do not exist or <code>BICq_posterior</code> 
is specified as <code>NULL</code>, the full model will be fit and the full model posterior
draws will be saved as specified above. The algorithm will save 10^4 posterior draws automatically.
</p>
<p>Trace details: The value of 0 (default) does not output any extra information. The value of 1
additionally outputs the updated coefficients, updated covariance matrix values, and the
number of coordinate descent iterations used for the M step for each
EM iteration. When pre-screening procedure is used and/or if the BIC-ICQ criterion is
requested, trace = 1 gives additional information about the penalties used
for the 'full model' fit procedure. If Stan is not used as the E-step sampling mechanism, 
the value of 2 outputs all of the above plus gibbs acceptance rate information
for the adaptive random walk and independence samplers and the updated proposal standard deviation
for the adaptive random walk.
</p>


<h3>Value</h3>

<p>A reference class object of class <code><a href="#topic+pglmmObj">pglmmObj</a></code> for which many methods are 
available (e.g. <code>methods(class = "pglmmObj")</code>, see ?pglmmObj for additional documentation)
</p>

<hr>
<h2 id='lambdaControl'>Control of Penalization Parameters and Selection Criteria</h2><span id='topic+lambdaControl'></span><span id='topic+selectControl'></span>

<h3>Description</h3>

<p>Constructs control structures for penalized mixed model fitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambdaControl(lambda0 = 0, lambda1 = 0)

selectControl(
  lambda0_seq = NULL,
  lambda1_seq = NULL,
  nlambda = 10,
  search = c("abbrev", "full_grid"),
  BIC_option = c("BICq", "BICh", "BIC", "BICNgrp"),
  logLik_calc = switch(BIC_option[1], BICq = FALSE, TRUE),
  lambda.min = NULL,
  pre_screen = TRUE,
  lambda.min.presc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambdaControl_+3A_lambda0">lambda0</code></td>
<td>
<p>a non-negative numeric penalty parameter for the fixed effects coefficients</p>
</td></tr>
<tr><td><code id="lambdaControl_+3A_lambda1">lambda1</code></td>
<td>
<p>a non-negative numeric penalty parameter for the (grouped) random effects
covariance coefficients</p>
</td></tr>
<tr><td><code id="lambdaControl_+3A_lambda0_seq">lambda0_seq</code>, <code id="lambdaControl_+3A_lambda1_seq">lambda1_seq</code></td>
<td>
<p>a sequence of non-negative numeric penalty parameters for 
the fixed 
and random effect coefficients (<code>lambda0_seq</code> and <code>lambda1_seq</code>, respectively). 
If <code>NULL</code>, then a sequence will be automatically 
calculated. See 'Details' section for more details on these default calculations.</p>
</td></tr>
<tr><td><code id="lambdaControl_+3A_nlambda">nlambda</code></td>
<td>
<p>positive integer specifying number of penalty parameters
to use for the fixed and random effects penalty parameters. Default set to 10. Only used
if either <code>lambda0_seq</code> or <code>lambda1_seq</code> remain unspecified by the user
(one or both of these arguments set to <code>NULL</code>) and, consequently, one or more default sequences need
to be calculated.</p>
</td></tr>
<tr><td><code id="lambdaControl_+3A_search">search</code></td>
<td>
<p>character string of &quot;abbrev&quot; (default) or &quot;full_grid&quot; indicating if the search of models over 
the penalty parameter space should be the full grid search (total number of models equals
'nlambda'^2 or length('lambda0_seq')*length('lambda1_seq')) or an abbreviated grid search.
The abbreviated grid search is described in more detail in the Details section. Te authors
highly recommend the abbreviated grid search.</p>
</td></tr>
<tr><td><code id="lambdaControl_+3A_bic_option">BIC_option</code></td>
<td>
<p>character string specifying the selection criteria used to select the 'best' model.
Default &quot;BICq&quot; option specifies the BIC-ICQ criterion (Ibrahim et al (2011)
&lt;doi:10.1111/j.1541-0420.2010.01463.x&gt;),
which requires a fit of 
a 'minimum penalty' model; a small penalty (the minimum of the penalty sequence) 
is used for the fixed and random effects. See &quot;Details&quot; section for what these 
small penalties will be.
The &quot;BICh&quot; option utilizes the hybrid BIC value described in 
Delattre, Lavielle, and Poursat (2014) &lt;doi:10.1214/14-EJS890&gt;.
The regular &quot;BIC&quot; option penalty term uses (total non-zero coefficients)*(length(y) = total number
observations). The &quot;BICNgrp&quot; option penalty term uses (total non-zero coefficients)*(nlevels(group) = number
groups).</p>
</td></tr>
<tr><td><code id="lambdaControl_+3A_loglik_calc">logLik_calc</code></td>
<td>
<p>logical value specifying if the log likelihood (and log-likelihood based 
calculations BIC, BICh, and BICNgrp) should be calculated for all of the models in the selection procedure. 
If BIC-ICQ is used for selection, the log-likelihood is not needed for each model. 
However, if users are interested
in comparing the best models from BIC-ICQ and other BIC-type selection criteria, setting
<code>logLik_calc</code> to <code>TRUE</code> will calculate these other quantities for all of the models.</p>
</td></tr>
<tr><td><code id="lambdaControl_+3A_lambda.min">lambda.min</code></td>
<td>
<p>numeric fraction between 0 and 1. The sequence of the lambda penalty parameters
ranges from the maximum lambda where all fixed and random effects are penalized to 0 and 
a minimum lambda value, which equals a small fraction of the maximum lambda. The parameter 
<code>lambda.min</code> specifies this fraction. Default value is set to <code>NULL</code>, which
automatically selects <code>lambda.min</code> to equal 0.01 when the number of observations is
greater than the number of fixed effects predictors and 0.05 otherwise.
Only used
if either <code>lambda0_seq</code> or <code>lambda1_seq</code> remain unspecified by the user
(one or both of these sequence arguments set to <code>NULL</code>) and, consequently, 
one or more default sequences need
to be calculated.</p>
</td></tr>
<tr><td><code id="lambdaControl_+3A_pre_screen">pre_screen</code></td>
<td>
<p>logical value indicating whether pre-screening should be performed before
model selection (default <code>TRUE</code>). If the number of random effects covariates
considered is 4 or less, then
no pre-screening will be performed. Pre-screening removes random effects from consideration
during the model selection process, which can significantly speed up the algorithm.
See &quot;Details&quot; section for a further discussion.</p>
</td></tr>
<tr><td><code id="lambdaControl_+3A_lambda.min.presc">lambda.min.presc</code></td>
<td>
<p>numeric fraction between 0 and 1. During pre-screening and the 
minimal penalty
model fit for the BIC-ICQ calculation, the small penalty used on the random effect is
the fraction <code>lambda.min.presc</code> multiplied by the maximum penalty parameter that penalizes
all fixed and random effects to 0. If left as <code>NULL</code>, the default value is 0.01 when the number
of random effect covariates is 10 or less and 0.05 otherwise.
Only used if <code>lambda1_seq</code> remains unspecified by the user
(this argument set to <code>NULL</code> so the random effects penalty parameter sequence
needs to be automatically calculated) AND either the pre-screening procedure is selected by the argument
<code>pre_screen</code> or the BIC-ICQ is selected as the model selection criteria,
i.e., <code>BIC_option</code> = &quot;BICq&quot;. See the &quot;Details&quot; section for a further discussion.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If left as the default <code>NULL</code> values, 
the <code>lambda0_seq</code> and <code>lambda1_seq</code> numeric sequences are 
automatically calculated. The sequence will be calculated in the same manner as 
<code>ncvreg</code> calculates the range: the max value (let's denote this as <code>lambda_max</code>) 
penalizes all fixed and random effects to 0, the min value is a 
small portion of max (<code>lambda.min</code>*<code>lambda_max</code>), and the sequence is composed of 
<code>nlambda</code> values ranging from these min and max values spread evenly on the log scale. 
Unlike <code>ncvreg</code>, the order of penalty
values used in the algorithm must run from the min lambda to the max lambda (as opposed to 
running from max lambda to min lambda). The length of the sequence is specified by <code>nlambda</code>. 
By default, these sequences are calculated using <code><a href="#topic+LambdaSeq">LambdaSeq</a></code>.
</p>
<p>The <code>lambda0</code> and <code>lambda1</code> arguments used within the <code><a href="#topic+glmm">glmm</a></code> function 
allow for a user to fit a model with a single 
non-zero penalty parameter combination. However, this is generally not recommended. 
</p>
<p>Abbreviated grid search: The abbreviated grid search proceeds in two stages. In stage 1, the
algorithm fits the following series of models: the fixed effects penalty parameter remains a
fixed value evaluated at the minimum of the fixed effects penalty parameters, and all
random effects penalty parameters are examined. The 'best' model from this first stage of models
determines the optimum random effect penalty parameter. In stage 2, the algorithm fits the 
following series of models: the random effects penalty parameter remains fixed at the value of
the optimum random effect penalty parameter (from stage 1) and all fixed effects penalty
parameters are considered. The best overall model is the best model from stage 2. This reduces the 
number of models considered to length('lambda0_seq') + length('lambda1_seq'). The authors found
that this abbreviated grid search worked well in simulations, and performed considerably
faster than the full grid search that examined all possible fixed and random effect penalty
parameter combinations.
</p>
<p>The arguments <code>nlambda</code> and <code>lambda.min</code> are only used
if one or both of the <code>lambda0_seq</code> and <code>lambda1_seq</code> penalty sequences
(corresponding to the fixed and random effects penalty sequences, respectively) 
remain unspecified by the user (one or both of these arguments left as <code>NULL</code>),
indicating that the algorithm needs to calculate default penalty sequences.
</p>
<p>The argument <code>lambda.min.presc</code> is only used under the following condition:
<code>lambda1_seq</code> remains unspecified by the user
(this argument set to <code>NULL</code> so the random effects penalty parameter sequence
needs to be calculated) AND either the pre-screening procedure is selected by the argument
<code>pre_screen</code> or the BIC-ICQ is selected as the model selection criteria,
i.e., <code>BIC_option</code> = &quot;BICq&quot;. 
If <code>lambda1_seq</code> is specified by the user, the minimum
value in that sequence will be used as the random effect penalty in the
pre-screening procedure and/or the minimal penalty model for the BIC-ICQ calculation.
</p>
<p>BIC-ICQ calculation: This model selection criteria requires the fitting of a 'minimal penalty'
model, which fits a model with a small penalty on the fixed and random effects.
For the fixed effects penalty, the minimal penalty is: (a) 0 if the number of fixed 
effects covariates is 4 or less or (b) the minimum fixed effect penalty from the fixed
effects penalty sequence (either from the default sequence or from the sequence
specified by the user). For the random effects penalty, the minimal penalty
is (a) 0 if the number of random 
effects covariates is 4 or less; (b) the minimum random effect penalty 
from the random effects penalty sequence specified by the user, or 
(c) <code>lambda.min.presc</code> multiplied to the <code>lambda_max</code> maximum penalty
specified above when a default random effects penalty sequence is calculated.
</p>
<p>Pre-screening: The minimum fixed effects penalty used in the pre-screening stage 
will be the minimum penalty of the fixed effects penalty sequence, <code>lambda0_seq</code>.
The minimum random effects penalty used in the pre-screening stage will be either 
(a) the minimum random effects penalty in the sequence <code>lambda1_seq</code> 
if this sequence specified by the user, or (b) <code>lambda.min.pres</code> x <code>lambda_max</code>,
where <code>lambda_max</code> was described above.
</p>


<h3>Value</h3>

<p>The *Control functions return a list (inheriting from class &quot;<code>pglmmControl</code>&quot;) 
containing parameter values that determine settings for variable selection.
</p>

<hr>
<h2 id='LambdaSeq'>Calculation of Penalty Parameter Sequence (Lambda Sequence)</h2><span id='topic+LambdaSeq'></span>

<h3>Description</h3>

<p>Calculates the sequence of penalty parameters used in the model selection procedure.
This function calls functions from package <code>ncvreg</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LambdaSeq(
  X,
  y,
  family,
  offset = NULL,
  alpha = 1,
  lambda.min = NULL,
  nlambda = 10,
  penalty.factor = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LambdaSeq_+3A_x">X</code></td>
<td>
<p>matrix of standardized fixed effects (see <code>std</code> function in <code>ncvreg</code> 
documenation). X should not include intercept.</p>
</td></tr>
<tr><td><code id="LambdaSeq_+3A_y">y</code></td>
<td>
<p>numeric vector of response values. If &quot;survival&quot; family, <code>y</code> are the event indicator
values (0 if censored, 1 if event)</p>
</td></tr>
<tr><td><code id="LambdaSeq_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. 
Currently, the <code>glmmPen</code> algorithm allows the Binomial (&quot;binomial&quot; or binomial()), 
Gaussian (&quot;gaussian&quot; or gaussian()), and Poisson (&quot;poisson&quot; or poisson()) families
with canonical links only. See <code><a href="#topic+phmmPen">phmmPen</a></code> for variable selection within
proportional hazards mixed models for survival data.</p>
</td></tr>
<tr><td><code id="LambdaSeq_+3A_offset">offset</code></td>
<td>
<p>numeric vector that can be used to specify an a priori known component 
to be included in the linear predictor during fitting. 
This should be <code>NULL</code> or a numeric vector of length equal to the number of observations</p>
</td></tr>
<tr><td><code id="LambdaSeq_+3A_alpha">alpha</code></td>
<td>
<p>Tuning parameter for the Mnet estimator which controls the relative contributions 
from the MCP/SCAD/LASSO penalty and the ridge, or L2, penalty. <code>alpha=1</code> is equivalent to 
the MCP/SCAD/LASSO penalty, while <code>alpha=0</code> is equivalent to ridge regression. However,
<code>alpha=0</code> is not supported; <code>alpha</code> may be arbitrarily small, but not exactly zero</p>
</td></tr>
<tr><td><code id="LambdaSeq_+3A_lambda.min">lambda.min</code></td>
<td>
<p>numeric fraction between 0 and 1. The sequence of the lambda penalty parameters
ranges from the maximum lambda where all fixed and random effects are penalized to 0 and 
a minimum lambda value, which equals a small fraction of the maximum lambda. The parameter 
<code>lambda.min</code> specifies this fraction. Default value is set to <code>NULL</code>, which
automatically selects <code>lambda.min</code> to equal 0.01 when the number of observations is
greater than the number of fixed effects predictors and 0.05 otherwise.
Only used
if either <code>lambda0_seq</code> or <code>lambda1_seq</code> remain unspecified by the user
(one or both of these sequence arguments set to <code>NULL</code>) and, consequently, 
one or more default sequences need
to be calculated.</p>
</td></tr>
<tr><td><code id="LambdaSeq_+3A_nlambda">nlambda</code></td>
<td>
<p>positive integer specifying number of penalty parameters (lambda) with 
which to fit a model.</p>
</td></tr>
<tr><td><code id="LambdaSeq_+3A_penalty.factor">penalty.factor</code></td>
<td>
<p>an optional numeric vector equal to the <code>fixef_noPen</code> argument
in <code><a href="#topic+glmmPen">glmmPen</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric sequence of penalty parameters of length <code>nlambda</code> ranging from the
minimum penalty parameter (first element) equal to fraction <code>lambda.min</code> multiplied by the 
maximum penalty parameter to the maximum penalty parameter (last element)
</p>

<hr>
<h2 id='optimControl'>Control of Penalized Generalized Linear Mixed Model Fitting</h2><span id='topic+optimControl'></span>

<h3>Description</h3>

<p>Constructs the control structure for the optimization of the penalized mixed model fit algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimControl(
  var_restrictions = c("none", "fixef"),
  conv_EM = 0.0015,
  conv_CD = 5e-04,
  nMC_burnin = NULL,
  nMC_start = NULL,
  nMC_max = NULL,
  nMC_report = 5000,
  maxitEM = NULL,
  maxit_CD = 50,
  M = 10000,
  t = 2,
  mcc = 2,
  sampler = c("stan", "random_walk", "independence"),
  var_start = "recommend",
  step_size = 1,
  standardization = TRUE,
  convEM_type = c("AvgEuclid1", "maxdiff", "AvgEuclid2", "Qfun"),
  B_init_type = c("deterministic", "data", "random")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimControl_+3A_var_restrictions">var_restrictions</code></td>
<td>
<p>character string indicating how the random effect covariance
matrix should be initialized at the beginning of the algorithm
when penalties are applied to the coefficients. 
If &quot;none&quot; (default), all random effect predictors are initialized to have non-zero variances.
If &quot;fixef&quot;, the code first examines the initialized fixed effects (initialized using a regular
penalized GLM), and only the random effect predictors that are initialized with non-zero fixed effects
are initialized with non-zero variances.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_conv_em">conv_EM</code></td>
<td>
<p>a non-negative numeric convergence criteria for the convergence of the 
EM algorithm. Default is 0.0015. 
EM algorithm is considered to have converge if the average Euclidean 
distance between the current coefficient estimates and the coefficient estimates from 
<code>t</code> EM iterations back is less than <code>conv_EM</code> <code>mcc</code> times in a row.
See <code>t</code> and <code>mcc</code> for more details.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_conv_cd">conv_CD</code></td>
<td>
<p>a non-negative numeric convergence criteria for the convergence of the 
grouped coordinate descent loop within the M step of the EM algorithm. Default 0.0005.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_nmc_burnin">nMC_burnin</code></td>
<td>
<p>positive integer specifying the number of posterior samples to use as
burn-in for each E step in the EM algorithm. If set to <code>NULL</code>, the algorithm inputs
the following defaults: Default 250 when the number of random effects 
predictors is less than or equal to 10; default 100 otherwise. Function will not allow <code>nMC_burnin</code>
to be less than 100.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_nmc_start">nMC_start</code></td>
<td>
<p>a positive integer for the initial number of Monte Carlo draws. If set to
<code>NULL</code>, the algorithm inputs the following defaults: Default 250 when 
the number of random effects predictors is less than or equal to 10; default 100 otherwise.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_nmc_max">nMC_max</code></td>
<td>
<p>a positive integer for the maximum number of allowed Monte Carlo draws used
in each step of the EM algorithm. If set to <code>NULL</code>, the algorithm inputs the following 
defaults: When the number of random effect covariates is greater than 10,
the default is set to 1000; when the number of random effect covariates is
10 or less, the default is set to 2500.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_nmc_report">nMC_report</code></td>
<td>
<p>a positive integer for the number of posterior samples to save from the final
model. These posterior samples can be used for diagnostic purposes, see <code><a href="#topic+plot_mcmc">plot_mcmc</a></code>.
Default set to 5000.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_maxitem">maxitEM</code></td>
<td>
<p>a positive integer for the maximum number of allowed EM iterations. 
If set to <code>NULL</code>, then the algorithm inputs the following defaults:
Default equals 50 for the Binomial and Poisson families, 65 for the Gaussian family.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_maxit_cd">maxit_CD</code></td>
<td>
<p>a positive integer for the maximum number of allowed iterations for the
coordinate descent algorithms used within the M-step of each EM iteration. Default equals 50.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_m">M</code></td>
<td>
<p>positive integer specifying the number of posterior samples to use within the 
Pajor log-likelihood calculation. Default is 10^4; minimum allowed value is 5000.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_t">t</code></td>
<td>
<p>the convergence criteria is based on the average Euclidean distance between 
the most recent coefficient estimates and the coefficient estimates from <code>t</code> EM iterations back.
Positive integer, default equals 2.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_mcc">mcc</code></td>
<td>
<p>the number of times the convergence criteria must be met before the algorithm is
seen as having converged (mcc for 'meet condition counter'). Default set to 2. Value restricted 
to be no less than 2.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_sampler">sampler</code></td>
<td>
<p>character string specifying whether the posterior samples of the random effects
should be drawn using Stan (default, from package rstan) or the Metropolis-within-Gibbs procedure 
incorporating an adaptive random walk sampler (&quot;random_walk&quot;) or an
independence sampler (&quot;independence&quot;). If using the random walk sampler, see <code><a href="#topic+adaptControl">adaptControl</a></code>
for some additional control structure parameters.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_var_start">var_start</code></td>
<td>
<p>either the character string &quot;recommend&quot; or a positive number specifying the 
starting values to initialize the variance of the covariance matrix. For <code><a href="#topic+glmmPen">glmmPen</a></code>,
the default &quot;recommend&quot; first
fits a simple model with a fixed and random intercept only using the <a href="lme4.html#topic+lme4">lme4</a> package. The 
random intercept variance estimate from this model is then multiplied by 2 and used as the 
starting variance. For <code><a href="#topic+glmmPen_FA">glmmPen_FA</a></code>, the default is set to 0.10 (see <code>B_init_type</code> 
for further information).</p>
</td></tr>
<tr><td><code id="optimControl_+3A_step_size">step_size</code></td>
<td>
<p>positive numeric value indicating the starting step size to use in the 
Majorization-Minimization scheme of the M-step. Only relevant when the distributional assumption
used is not Binomial or Gaussian with canonical links (e.g. Poisson with log link)</p>
</td></tr>
<tr><td><code id="optimControl_+3A_standardization">standardization</code></td>
<td>
<p>logical value indicating whether covariates should
standardized (<code>TRUE</code>, default) or unstandardized (<code>FALSE</code>) before being
used within the algorithm. If <code>standardization = TRUE</code>, then the standardized covariates
will also be used to create the Z matrix used in the estimation of the random effects.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_convem_type">convEM_type</code></td>
<td>
<p>character string indicating the type of convergence criteria to 
use within the EM algorithm to determine when a model has converged. The default is &quot;AvgEuclid1&quot;,
which calculates the average Euclidean distance between the most recent coefficient vector and
the coefficient vector <code>t</code> EM iterations back (Euclidean distance divided by the number
of non-zero coefficients <code>t</code> EM iterations back). Alternative convergence options include
&quot;maxdiff&quot;, which determines convergence based on the maximum difference between the coefficient vectors; 
&quot;AvgEuclid2&quot;, which is similar to &quot;AvgEuclid1&quot; except it divides the Euclidean distance by the square-root
of the number of non-zero coefficients; and &quot;Qfun&quot;, which determines convergence based on
the relative difference in the Q-function estimates calculated with the most recent coefficient vector 
and the coefficient vector <code>t</code> EM iterations back.</p>
</td></tr>
<tr><td><code id="optimControl_+3A_b_init_type">B_init_type</code></td>
<td>
<p>character string indicating how the B matrix within the <code><a href="#topic+glmmPen_FA">glmmPen_FA</a></code>
method should be initialized. (This argument is not used within the <code><a href="#topic+glmmPen">glmmPen</a></code> function.)
The default &quot;deterministic&quot; initializes all non-zero variance and 
covariance values of the random effect covariance matrix to the value of <code>var_start</code>,
such that each non-zero element of the B matrix is <code>sqrt(var_start / r)</code> (where <code>r</code> is
the number of latent factors). Option &quot;data&quot; is similar to &quot;deterministic&quot;, but the 
<code>var_start</code> value is the default data-driven variance estimate used in <code><a href="#topic+glmmPen">glmmPen</a></code> 
(see argument <code>var_start</code> for more details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several arguments are set to a default value of <code>NULL</code>. If these arguments 
are left as <code>NULL</code> by the user, then these values will be filled in with appropriate
default values as specified above, which may depend on the number of random effects or
the family of the data. If the user
specifies particular values for these arguments, no additional modifications to these 
arguments will be done within the algorithm.
</p>


<h3>Value</h3>

<p>Function returns a list inheriting from class <code>optimControl</code>
containing fit and optimization criteria values used in optimization routine.
</p>

<hr>
<h2 id='pglmmObj-class'>Class <code>pglmmObj</code> of Fitted Penalized Generalized Mixed-Effects Models for 
package <code>glmmPen</code></h2><span id='topic+pglmmObj-class'></span><span id='topic+pglmmObj'></span><span id='topic+show+2C'></span><span id='topic+pglmmObj-method+2C'></span><span id='topic+coef.pglmmObj+2C'></span><span id='topic+fitted.pglmmObj+2C'></span><span id='topic+fixef.pglmmObj+2C'></span><span id='topic+formula.pglmmObj+2C'></span><span id='topic+logLik.pglmmObj+2C'></span><span id='topic+model.frame.pglmmObj+2C'></span><span id='topic+model.matrix.pglmmObj+2C'></span><span id='topic+plot.pglmmObj+2C'></span><span id='topic+predict.pglmmObj+2C'></span><span id='topic+print.pglmmObj+2C'></span><span id='topic+ranef.pglmmObj+2C'></span><span id='topic+residuals.pglmmObj+2C'></span><span id='topic+sigma.pglmmObj+2C'></span><span id='topic+summary.pglmmObj'></span><span id='topic+fixef.pglmmObj'></span><span id='topic+ranef.pglmmObj'></span><span id='topic+sigma.pglmmObj'></span><span id='topic+coef.pglmmObj'></span><span id='topic+family.pglmmObj'></span><span id='topic+nobs.pglmmObj'></span><span id='topic+ngrps.pglmmObj'></span><span id='topic+formula.pglmmObj'></span><span id='topic+model.frame.pglmmObj'></span><span id='topic+model.matrix.pglmmObj'></span><span id='topic+fitted.pglmmObj'></span><span id='topic+predict.pglmmObj'></span><span id='topic+residuals.pglmmObj'></span><span id='topic+print.pglmmObj'></span><span id='topic+logLik.pglmmObj'></span><span id='topic+BIC.pglmmObj'></span><span id='topic+plot.pglmmObj'></span>

<h3>Description</h3>

<p>The functions <code><a href="#topic+glmm">glmm</a></code>, <code><a href="#topic+glmmPen">glmmPen</a></code>, 
<code><a href="#topic+glmm_FA">glmm_FA</a></code>, and <code><a href="#topic+glmmPen_FA">glmmPen_FA</a></code> from the package <code>glmmPen</code> 
output the reference class object of type <code>pglmmObj</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pglmmObj'
fixef(object, ...)

## S3 method for class 'pglmmObj'
ranef(object, ...)

## S3 method for class 'pglmmObj'
sigma(object, ...)

## S3 method for class 'pglmmObj'
coef(object, ...)

## S3 method for class 'pglmmObj'
family(object, ...)

## S3 method for class 'pglmmObj'
nobs(object, ...)

## S3 method for class 'pglmmObj'
ngrps(object, ...)

## S3 method for class 'pglmmObj'
formula(x, fixed.only = FALSE, random.only = FALSE, ...)

## S3 method for class 'pglmmObj'
model.frame(formula, fixed.only = FALSE, ...)

## S3 method for class 'pglmmObj'
model.matrix(object, type = c("fixed", "random"), ...)

## S3 method for class 'pglmmObj'
fitted(object, fixed.only = TRUE, ...)

## S3 method for class 'pglmmObj'
predict(
  object,
  newdata = NULL,
  type = c("link", "response"),
  fixed.only = TRUE,
  ...
)

## S3 method for class 'pglmmObj'
residuals(object, type = c("deviance", "pearson", "response", "working"), ...)

## S3 method for class 'pglmmObj'
print(x, digits = c(fef = 4, ref = 4), ...)

## S3 method for class 'pglmmObj'
summary(
  object,
  digits = c(fef = 4, ref = 4),
  resid_type = switch(object$family$family, gaussian = "pearson", "deviance"),
  ...
)

## S3 method for class 'pglmmObj'
logLik(object, ...)

## S3 method for class 'pglmmObj'
BIC(object, ...)

## S3 method for class 'pglmmObj'
plot(x, fixed.only = FALSE, type = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pglmmObj-class_+3A_object">object</code></td>
<td>
<p>pglmmObj object output from <code>glmm</code>, <code>glmmPen</code>, or <code>glmmPen_FineSearch</code></p>
</td></tr>
<tr><td><code id="pglmmObj-class_+3A_...">...</code></td>
<td>
<p>potentially further arguments passed from other methods</p>
</td></tr>
<tr><td><code id="pglmmObj-class_+3A_x">x</code></td>
<td>
<p>an R object of class <code>pglmmObj</code></p>
</td></tr>
<tr><td><code id="pglmmObj-class_+3A_fixed.only">fixed.only</code></td>
<td>
<p>logical value; default <code>TRUE</code> indicates that only the 
fixed effects 
should be used in the fitted value/prediction, while <code>FALSE</code> indicates that both the fixed and 
random effects posterior modes should be used in the fitted value/prediction</p>
</td></tr>
<tr><td><code id="pglmmObj-class_+3A_random.only">random.only</code></td>
<td>
<p>logical value used in <code>formula</code>; <code>TRUE</code> indicates that 
only the formula elements relating to the random effects should be returned</p>
</td></tr>
<tr><td><code id="pglmmObj-class_+3A_formula">formula</code></td>
<td>
<p>in the case of model.frame, a <code>pglmmObj</code> object</p>
</td></tr>
<tr><td><code id="pglmmObj-class_+3A_type">type</code></td>
<td>
<p>See details of <code>type</code> options for each function under &quot;Functions&quot; section.</p>
</td></tr>
<tr><td><code id="pglmmObj-class_+3A_newdata">newdata</code></td>
<td>
<p>optional new data.frame containing the same variables used in the model fit procedure</p>
</td></tr>
<tr><td><code id="pglmmObj-class_+3A_digits">digits</code></td>
<td>
<p>number of significant digits for printing; default of 4</p>
</td></tr>
<tr><td><code id="pglmmObj-class_+3A_resid_type">resid_type</code></td>
<td>
<p>type of residuals to summarize in output. See <code>predict.pglmmObj</code>
for residual options available.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The pglmmObj object returns the following items:
</p>
<table>
<tr><td><code>fixef</code></td>
<td>
<p>vector of fixed effects coefficients</p>
</td></tr>
<tr><td><code>ranef</code></td>
<td>
<p>matrix of random effects coefficients for each 
explanatory variable for each level of the grouping factor</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>random effects covariance matrix</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>if family is Gaussian, returns the residual error variance</p>
</td></tr>
<tr><td><code>posterior_samples</code></td>
<td>
<p>Samples from the posterior distribution of the random effects,
taken at the end of the model fit (after convergence or after maximum iterations allowed).
Can be used for diagnositics purposes. Note: These posterior samples are from a single chain.</p>
</td></tr>
<tr><td><code>sampling</code></td>
<td>
<p>character string for type of sampling used to calculate the posterior samples
in the E-step of the algorithm</p>
</td></tr>
<tr><td><code>results_all</code></td>
<td>
<p>matrix of results from all model fits during variable selection (if selection
performed). Output for each model includes: penalty parameters for fixed (lambda0) and random 
(lambda1) effects, BIC-derived quantities and the log-likelihood 
(note: the arguments <code>BIC_option</code> and <code>logLik_calc</code> in <code><a href="#topic+selectControl">selectControl</a></code>
determine which of these quantities are calculated for each model), 
the number of non-zero fixed and random effects (includes intercept),
number of EM iterations used for model fit, whether or not the 
model converged (0 for no vs 1 for yes), and the fixed and random effects coefficients</p>
</td></tr>
<tr><td><code>results_optim</code></td>
<td>
<p>results from the 'best' model fit; see results_all for details. 
BICh, BIC, BICNgrp, and LogLik computed for this best model if not previously calculated.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>Family</p>
</td></tr>
<tr><td><code>penalty_info</code></td>
<td>
<p>list of penalty information</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>arguments plugged into <code>glmm</code>, <code>glmmPen</code>, <code>glmm_FA</code>, or 
<code>glmmPen_FA</code></p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>formula</p>
</td></tr>
<tr><td><code>fixed_vars</code></td>
<td>
<p>names of fixed effects variables</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>list of data used in model fit, including the response y, the fixed effects 
covariates matrix X, the random effects model matrix Z (which is composed of values from the 
standardized fixed effects model matrix), 
the grouping factor, offset, model frame,
and standarization information used to standardize the fixed effects covariates</p>
</td></tr>
<tr><td><code>optinfo</code></td>
<td>
<p>Information about the optimization of the 'best' model</p>
</td></tr>
<tr><td><code>control_info</code></td>
<td>
<p>optimization parameters used for the model fit</p>
</td></tr>
<tr><td><code>Estep_init</code></td>
<td>
<p>materials that can be used to initialize another E-step, if desired</p>
</td></tr>
<tr><td><code>Gibbs_info</code></td>
<td>
<p>list of materials to perform diagnositics on the Metropolis-within-Gibbs
sample chains, including the Gibbs acceptance rates (included for both the independence
and adaptive random walk samplers) and the final proposal standard deviations 
(included for the adaptive random walk sampler only))</p>
</td></tr>
<tr><td><code>r_estimation</code></td>
<td>
<p>list of output related to estimation of number of latent common 
factors, r. Only relevant for the output of functions <code>glmm_FA</code> and 
<code>glmmPen_FA</code>, which are currently in development and are not yet ready for
general use.</p>
</td></tr>
</table>
<p>showClass(&quot;pglmmObj&quot;)
methods(class = &quot;pglmmObj&quot;)
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>fixef.pglmmObj</code>: Provides the fixed effects coefficients
</p>
</li>
<li> <p><code>ranef.pglmmObj</code>: Provides the random effects posterior modes for each explanatory variable
for each level of the grouping factor
</p>
</li>
<li> <p><code>sigma.pglmmObj</code>: Provides the random effect covariance matrix. If family is Gaussian,
also returns the standard deviation of the residual error.
</p>
</li>
<li> <p><code>coef.pglmmObj</code>: Computes the sum of the fixed effects 
coefficients and the random effect posterior modes 
for each explanatory variable for each level of each grouping factor.
</p>
</li>
<li> <p><code>family.pglmmObj</code>: Family of the fitted GLMM
</p>
</li>
<li> <p><code>nobs.pglmmObj</code>: Number of observations used in the model fit
</p>
</li>
<li> <p><code>ngrps.pglmmObj</code>: Number of levels in the grouping factor
</p>
</li>
<li> <p><code>formula.pglmmObj</code>: Formula used for the model fit. Can return the full
formula, or just the formula elements relating to the fixed effects
(fixed.only = TRUE) or random effects (random.only = TRUE)
</p>
</li>
<li> <p><code>model.frame.pglmmObj</code>: Returns the model frame
</p>
</li>
<li> <p><code>model.matrix.pglmmObj</code>: Returns the model matrix of either the fixed (type = &quot;fixed&quot;) or 
random effects (type = &quot;random&quot;)
</p>
</li>
<li> <p><code>fitted.pglmmObj</code>: Fitted values, i.e., the linear predictor of the model.
</p>
</li>
<li> <p><code>predict.pglmmObj</code>: Predictions for the model corresponding to 
the pglmmObj output object from the glmmPen package functions. The function
<code>predict</code> can predict either the linear predictor of the model or the
expected mean of the response, as specified by the <code>type</code> argument.
Argument <code>type</code>: character string for type of predictors: &quot;link&quot; (default), 
which generates the linear predictor,
and &quot;response&quot;, which generates the expected mean values of the response.
</p>
</li>
<li> <p><code>residuals.pglmmObj</code>: Residuals for the pglmmObj output object from the glmmPen package functions.
Argument <code>type</code>: character string for type of residuals to report. Options include &quot;deviance&quot; (default), 
&quot;pearson&quot;, &quot;response&quot;, and &quot;working&quot;, which specify the deviance residuals, Pearson residuals,
the difference between the actual response y and the expected mean response (y - mu), and the
working residuals (y - mu) / mu
</p>
</li>
<li> <p><code>print.pglmmObj</code>: Prints a selection of summary information of fitted model
</p>
</li>
<li> <p><code>summary.pglmmObj</code>: Returns a list of summary statistics of the fitted model.
</p>
</li>
<li> <p><code>logLik.pglmmObj</code>: Returns the log-likelihood using the Corrected Arithmetic Mean estimator
with importance sampling weights developed by Pajor (2017). Degrees of freedom
give the sum of the non-zero fixed and random effects coefficients.
Citation: Pajor, A. (2017). Estimating the marginal likelihood using the arithmetic mean identity. 
Bayesian Analysis, 12(1), 261-287.
</p>
</li>
<li> <p><code>BIC.pglmmObj</code>: Returns BIC, BICh (hybrid BIC developed by Delattre et al., citation:
Delattre, M., Lavielle, M., &amp; Poursat, M. A. (2014). A note on BIC in mixed-effects models. 
Electronic journal of statistics, 8(1), 456-475.), BICNgrps (BIC using N = number of groups
in the penalty term), and possibly BIC-ICQ (labeled as &quot;BICq&quot;) if the argument <code>BIC_option</code>
was set to &quot;BICq&quot; in <code><a href="#topic+selectControl">selectControl</a></code> (citation for BIC-ICQ: 
Ibrahim, J. G., Zhu, H., Garcia, R. I., &amp; Guo, R. (2011). 
Fixed and random effects selection in mixed effects models. Biometrics, 67(2), 495-503.)
</p>
</li>
<li> <p><code>plot.pglmmObj</code>: Plot residuals for the pglmmObj output object from the glmmPen package.
Argument <code>type</code>: character string for type of residuals to report. Options include &quot;deviance&quot; 
(default for non-Gaussian family), &quot;pearson&quot; (default for Gaussian family), 
&quot;response&quot;, and &quot;working&quot;, which specify the deviance residuals, Pearson residuals,
the difference between the actual response y and the expected mean response (y - mu), and the
working residuals (y - mu) / mu
</p>
</li></ul>

<hr>
<h2 id='phmm'>Fit a Proportional Hazards Mixed Model via Monte Carlo Expectation Conditional Minimization (MCECM)
using a Piecewise Constant Hazard Mixed Model Approximation</h2><span id='topic+phmm'></span>

<h3>Description</h3>

<p><code>phmm</code> is used to approximate a single proportional hazards mixed model 
using a piecewise constant hazard mixed model approximation
via Monte Carlo Expectation Conditional Minimization (MCECM). No model selection is performed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phmm(
  formula,
  data = NULL,
  covar = NULL,
  offset = NULL,
  optim_options = optimControl(),
  adapt_RW_options = adaptControl(),
  trace = 0,
  tuning_options = lambdaControl(),
  survival_options = survivalControl(),
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phmm_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed effects and 
random effects part of the model, with the response on the left of a ~ operator and the terms, 
separated by + operators, on the right. 
The response must be a <code>Surv</code> object (see
<code><a href="survival.html#topic+Surv">Surv</a></code> from the <code>survival</code> package).
Random-effects terms are distinguished by vertical bars 
(&quot;|&quot;) separating expression for design matrices from the grouping factor. <code>formula</code> should be 
of the same format needed for <code><a href="lme4.html#topic+glmer">glmer</a></code> in package <span class="pkg">lme4</span>. 
Only one grouping factor 
will be recognized. The random effects covariates need to be a subset of the fixed effects covariates.
The offset must be specified outside of the formula in the 'offset' argument.</p>
</td></tr>
<tr><td><code id="phmm_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>. If <code>data</code> is 
omitted, variables will be taken from the environment of <code>formula</code>.</p>
</td></tr>
<tr><td><code id="phmm_+3A_covar">covar</code></td>
<td>
<p>character string specifying whether the covariance matrix should be unstructured
(&quot;unstructured&quot;) or diagonal with no covariances between variables (&quot;independent&quot;).
Default is set to <code>NULL</code>. If <code>covar</code> is set to <code>NULL</code> and the number of random effects
predictors (not including the intercept) is 
greater than or equal to 10 (i.e. high dimensional), then the algorithm automatically assumes an 
independent covariance structure and <code>covar</code> is set to &quot;independent&quot;. Otherwise if <code>covar</code>
is set to <code>NULL</code> and the number of random effects predictors is less than 10, then the
algorithm automatically assumes an unstructured covariance structure and <code>covar</code> is set to &quot;unstructured&quot;.</p>
</td></tr>
<tr><td><code id="phmm_+3A_offset">offset</code></td>
<td>
<p>This can be used to specify an <em>a priori</em> known component to be included in the 
linear predictor during fitting. Default set to <code>NULL</code> (no offset). If the data 
argument is not <code>NULL</code>, this should be a numeric vector of length equal to the 
number of cases (the length of the response vector). 
If the data argument specifies a data.frame, the offset
argument should specify the name of a column in the data.frame.</p>
</td></tr>
<tr><td><code id="phmm_+3A_optim_options">optim_options</code></td>
<td>
<p>a structure of class &quot;optimControl&quot; created 
from function <code><a href="#topic+optimControl">optimControl</a></code> that specifies several optimization parameters. See the 
documentation for <code><a href="#topic+optimControl">optimControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="phmm_+3A_adapt_rw_options">adapt_RW_options</code></td>
<td>
<p>a list of class &quot;adaptControl&quot; from function <code><a href="#topic+adaptControl">adaptControl</a></code> 
containing the control parameters for the adaptive random walk Metropolis-within-Gibbs procedure. 
Ignored if <code><a href="#topic+optimControl">optimControl</a></code> parameter <code>sampler</code> is set to &quot;stan&quot; (default) or &quot;independence&quot;.</p>
</td></tr>
<tr><td><code id="phmm_+3A_trace">trace</code></td>
<td>
<p>an integer specifying print output to include as function runs. Default value is 0. 
See Details for more information about output provided when trace = 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="phmm_+3A_tuning_options">tuning_options</code></td>
<td>
<p>a list of class &quot;selectControl&quot; or &quot;lambdaControl&quot; resulting from 
<code><a href="#topic+selectControl">selectControl</a></code> or <code><a href="#topic+lambdaControl">lambdaControl</a></code> containing additional control parameters.
When function <code>glmm</code> is used,the algorithm may be run using one specific set of
penalty parameters <code>lambda0</code> and <code>lambda1</code> by specifying such values in <code>lambdaControl()</code>. 
The default for <code>glmm</code> is to run the model fit with no penalization (<code>lambda0</code> = <code>lambda1</code> = 0).
When function <code>glmmPen</code> is run, <code>tuning_options</code> is specified using <code>selectControl()</code>. 
See the <code><a href="#topic+lambdaControl">lambdaControl</a></code> and <code><a href="#topic+selectControl">selectControl</a></code> documentation for further details.</p>
</td></tr>
<tr><td><code id="phmm_+3A_survival_options">survival_options</code></td>
<td>
<p>a structure of class &quot;survivalControl&quot; created 
from function <code><a href="#topic+survivalControl">survivalControl</a></code> that specifies several parameters needed to 
properly fit the input survival data using a piecewise constant hazard mixed model. See the 
documentation for <code><a href="#topic+survivalControl">survivalControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="phmm_+3A_progress">progress</code></td>
<td>
<p>a logical value indicating if additional output should be given showing the
progress of the fit procedure. If <code>TRUE</code>, such output includes iteration-level information
for the fit procedure (iteration number EM_iter,
number of MCMC samples nMC, average Euclidean distance between current coefficients and coefficients
from t&ndash;defined in <code><a href="#topic+optimControl">optimControl</a></code>&ndash;iterations back EM_conv, 
and number of non-zero fixed and random effects covariates
not including the intercept). Additionally, <code>progress = TRUE</code>
gives some other information regarding the progress of the variable selection 
procedure, including the model selection criteria and log-likelihood estimates
for each model fit.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="phmm_+3A_...">...</code></td>
<td>
<p>additional arguments that could be passed into <code>phmmPen</code>. 
See <code><a href="#topic+phmmPen">phmmPen</a></code>
for further details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>phmm</code> function can be used to approximate a single proportional hazards
mixed model using a piecewise constant hazard mixed model.
While this approach is meant to be used in the case where the user knows which
covariates belong in the fixed and random effects and no penalization is required, one is
allowed to specify non-zero fixed and random effects penalties using <code><a href="#topic+lambdaControl">lambdaControl</a></code>
and the (...) arguments. The (...) allow for specification of penalty-related arguments; see
<code><a href="#topic+glmmPen">glmmPen</a></code> and <code><a href="#topic+glmmPen_FA">glmmPen_FA</a></code>for details. 
For a high dimensional situation, the user may want to fit a 
full model using a small penalty for the fixed and random effects and save the posterior
draws from this full model for use in any BIC-ICQ calculations during selection within <code>phmmPen</code>. 
Specifying a file name in the 'BICq_posterior' argument will save the posterior draws from the 
<code>phmm</code> model into a big.matrix with this file name, see the Details section of 
<code><a href="#topic+phmmPen">phmmPen</a></code> for additional details.
</p>


<h3>Value</h3>

<p>A reference class object of class <code><a href="#topic+pglmmObj">pglmmObj</a></code> for which many methods are 
available (e.g. <code>methods(class = "pglmmObj")</code>)
</p>

<hr>
<h2 id='phmm_FA'>Fit a Proportional Hazards Mixed Model via Monte Carlo Expectation Conditional Minimization (MCECM) using
a Piecewise Constant Hazard Mixed Model Approximation</h2><span id='topic+phmm_FA'></span>

<h3>Description</h3>

<p><code>phmm_FA</code> is used to fit a single piecewise constant hazard mixed model as an
approximation to a proportional hazards mixed model via Monte Carlo 
Expectation Conditional Minimization (MCECM). This piecewise constant hazard mixed model
uses a factor model decomposition of
the random effects. No model selection is performed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phmm_FA(
  formula,
  data = NULL,
  offset = NULL,
  r_estimation = rControl(),
  optim_options = optimControl(),
  adapt_RW_options = adaptControl(),
  trace = 0,
  tuning_options = lambdaControl(),
  survival_options = survivalControl(),
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phmm_FA_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed effects and 
random effects part of the model, with the response on the left of a ~ operator and the terms, 
separated by + operators, on the right. 
The response must be a <code>Surv</code> object (see
<code><a href="survival.html#topic+Surv">Surv</a></code> from the <code>survival</code> package).
Random-effects terms are distinguished by vertical bars 
(&quot;|&quot;) separating expression for design matrices from the grouping factor. <code>formula</code> should be 
of the same format needed for <code><a href="lme4.html#topic+glmer">glmer</a></code> in package <span class="pkg">lme4</span>. 
Only one grouping factor 
will be recognized. The random effects covariates need to be a subset of the fixed effects covariates.
The offset must be specified outside of the formula in the 'offset' argument.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>. If <code>data</code> is 
omitted, variables will be taken from the environment of <code>formula</code>.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_offset">offset</code></td>
<td>
<p>This can be used to specify an <em>a priori</em> known component to be included in the 
linear predictor during fitting. Default set to <code>NULL</code> (no offset). If the data 
argument is not <code>NULL</code>, this should be a numeric vector of length equal to the 
number of cases (the length of the response vector). 
If the data argument specifies a data.frame, the offset
argument should specify the name of a column in the data.frame.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_r_estimation">r_estimation</code></td>
<td>
<p>a list of class &quot;rControl&quot; from function <code><a href="#topic+rControl">rControl</a></code> 
containing the control parameters for the estimation of the number of latent
factors to use in the <code>glmmPen_FA</code> and <code>glmm_FA</code> estimation procedures.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_optim_options">optim_options</code></td>
<td>
<p>a structure of class &quot;optimControl&quot; created 
from function <code><a href="#topic+optimControl">optimControl</a></code> that specifies several optimization parameters. See the 
documentation for <code><a href="#topic+optimControl">optimControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_adapt_rw_options">adapt_RW_options</code></td>
<td>
<p>a list of class &quot;adaptControl&quot; from function <code><a href="#topic+adaptControl">adaptControl</a></code> 
containing the control parameters for the adaptive random walk Metropolis-within-Gibbs procedure. 
Ignored if <code><a href="#topic+optimControl">optimControl</a></code> parameter <code>sampler</code> is set to &quot;stan&quot; (default) or &quot;independence&quot;.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_trace">trace</code></td>
<td>
<p>an integer specifying print output to include as function runs. Default value is 0. 
See Details for more information about output provided when trace = 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_tuning_options">tuning_options</code></td>
<td>
<p>a list of class &quot;selectControl&quot; or &quot;lambdaControl&quot; resulting from 
<code><a href="#topic+selectControl">selectControl</a></code> or <code><a href="#topic+lambdaControl">lambdaControl</a></code> containing additional control parameters.
When function <code>glmm</code> is used,the algorithm may be run using one specific set of
penalty parameters <code>lambda0</code> and <code>lambda1</code> by specifying such values in <code>lambdaControl()</code>. 
The default for <code>glmm</code> is to run the model fit with no penalization (<code>lambda0</code> = <code>lambda1</code> = 0).
When function <code>glmmPen</code> is run, <code>tuning_options</code> is specified using <code>selectControl()</code>. 
See the <code><a href="#topic+lambdaControl">lambdaControl</a></code> and <code><a href="#topic+selectControl">selectControl</a></code> documentation for further details.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_survival_options">survival_options</code></td>
<td>
<p>a structure of class &quot;survivalControl&quot; created 
from function <code><a href="#topic+survivalControl">survivalControl</a></code> that specifies several parameters needed to 
properly fit the input survival data using a piecewise constant hazard mixed model. See the 
documentation for <code><a href="#topic+survivalControl">survivalControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_progress">progress</code></td>
<td>
<p>a logical value indicating if additional output should be given showing the
progress of the fit procedure. If <code>TRUE</code>, such output includes iteration-level information
for the fit procedure (iteration number EM_iter,
number of MCMC samples nMC, average Euclidean distance between current coefficients and coefficients
from t&ndash;defined in <code><a href="#topic+optimControl">optimControl</a></code>&ndash;iterations back EM_conv, 
and number of non-zero fixed and random effects covariates
not including the intercept). Additionally, <code>progress = TRUE</code>
gives some other information regarding the progress of the variable selection 
procedure, including the model selection criteria and log-likelihood estimates
for each model fit.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="phmm_FA_+3A_...">...</code></td>
<td>
<p>additional arguments that could be passed into <code>phmmPen_FA</code>. 
See <code><a href="#topic+phmmPen_FA">phmmPen_FA</a></code>
for further details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>phmm_FA</code> function can be used to approximate a single proportional hazards
mixed model using a piecewise constant hazard mixed model.
While this approach is meant to be used in the case where the user knows which
covariates belong in the fixed and random effects and no penalization is required, one is
allowed to specify non-zero fixed and random effects penalties using <code><a href="#topic+lambdaControl">lambdaControl</a></code>
and the (...) arguments. The (...) allow for specification of penalty-related arguments; see
<code><a href="#topic+phmmPen_FA">phmmPen_FA</a></code> for details. For a high dimensional situation, the user may want to fit a 
full model using a small penalty for the fixed and random effects and save the posterior
draws from this full model for use in any BIC-ICQ calculations during selection within <code>phmmPen_FA</code>. 
Specifying a file name in the 'BICq_posterior' argument will save the posterior draws from the 
<code>phmm_FA</code> model into a big.matrix with this file name, see the Details section of 
<code><a href="#topic+phmmPen_FA">phmmPen_FA</a></code> for additional details.
</p>


<h3>Value</h3>

<p>A reference class object of class <code><a href="#topic+pglmmObj">pglmmObj</a></code> for which many methods are 
available (e.g. <code>methods(class = "pglmmObj")</code>)
</p>

<hr>
<h2 id='phmmPen'>Fit Penalized Proportional Hazards Mixed Models via Monte Carlo Expectation Conditional 
Minimization (MCECM) using a Piecewise Constant Hazard Mixed Model Approximation</h2><span id='topic+phmmPen'></span>

<h3>Description</h3>

<p><code>phmmPen_FA</code> is used to fit penalized proportional hazards mixed models 
using a piecewise constant hazard mixed model approximation via 
Monte Carlo Expectation Conditional Minimization (MCECM). 
The purpose of the function is to perform 
variable selection on both the fixed and random effects simultaneously for the
piecewise constant hazard mixed model. 
<code>phmmPen</code> selects the best model using 
BIC-type selection criteria (see <code><a href="#topic+selectControl">selectControl</a></code> documentation for 
further details). 
To improve the speed of the algorithm, consider setting
<code>var_restrictions</code> = &quot;fixef&quot; within the <code><a href="#topic+optimControl">optimControl</a></code> options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phmmPen(
  formula,
  data = NULL,
  covar = NULL,
  offset = NULL,
  fixef_noPen = NULL,
  penalty = c("MCP", "SCAD", "lasso"),
  alpha = 1,
  gamma_penalty = switch(penalty[1], SCAD = 4, 3),
  optim_options = optimControl(),
  adapt_RW_options = adaptControl(),
  trace = 0,
  tuning_options = selectControl(),
  survival_options = survivalControl(),
  BICq_posterior = NULL,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phmmPen_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed effects and 
random effects part of the model, with the response on the left of a ~ operator and the terms, 
separated by + operators, on the right. 
The response must be a <code>Surv</code> object (see
<code><a href="survival.html#topic+Surv">Surv</a></code> from the <code>survival</code> package).
Random-effects terms are distinguished by vertical bars 
(&quot;|&quot;) separating expression for design matrices from the grouping factor. <code>formula</code> should be 
of the same format needed for <code><a href="lme4.html#topic+glmer">glmer</a></code> in package <span class="pkg">lme4</span>. 
Only one grouping factor 
will be recognized. The random effects covariates need to be a subset of the fixed effects covariates.
The offset must be specified outside of the formula in the 'offset' argument.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>. If <code>data</code> is 
omitted, variables will be taken from the environment of <code>formula</code>.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_covar">covar</code></td>
<td>
<p>character string specifying whether the covariance matrix should be unstructured
(&quot;unstructured&quot;) or diagonal with no covariances between variables (&quot;independent&quot;).
Default is set to <code>NULL</code>. If <code>covar</code> is set to <code>NULL</code> and the number of random effects
predictors (not including the intercept) is 
greater than or equal to 10 (i.e. high dimensional), then the algorithm automatically assumes an 
independent covariance structure and <code>covar</code> is set to &quot;independent&quot;. Otherwise if <code>covar</code>
is set to <code>NULL</code> and the number of random effects predictors is less than 10, then the
algorithm automatically assumes an unstructured covariance structure and <code>covar</code> is set to &quot;unstructured&quot;.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_offset">offset</code></td>
<td>
<p>This can be used to specify an <em>a priori</em> known component to be included in the 
linear predictor during fitting. Default set to <code>NULL</code> (no offset). If the data 
argument is not <code>NULL</code>, this should be a numeric vector of length equal to the 
number of cases (the length of the response vector). 
If the data argument specifies a data.frame, the offset
argument should specify the name of a column in the data.frame.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_fixef_nopen">fixef_noPen</code></td>
<td>
<p>Optional vector of 0's and 1's of the same length as the number of fixed effects covariates
used in the model. Value 0 indicates the variable should not have its fixed effect coefficient
penalized, 1 indicates that it can be penalized. Order should correspond to the same order of the 
fixed effects given in the formula.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_penalty">penalty</code></td>
<td>
<p>character describing the type of penalty to use in the variable selection procedure.
Options include 'MCP', 'SCAD', and 'lasso'. Default is MCP penalty. If the random effect covariance
matrix is &quot;unstructured&quot;, then a group MCP, group SCAD, or group LASSO penalty is used on the 
random effects coefficients. See Breheny and Huang (2011) &lt;doi:10.1214/10-AOAS388&gt; 
and Breheny and Huang (2015) &lt;doi:10.1007/s11222-013-9424-2&gt; for details of these penalties.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_alpha">alpha</code></td>
<td>
<p>Tuning parameter for the Mnet estimator which controls the relative contributions 
from the MCP/SCAD/LASSO penalty and the ridge, or L2, penalty. <code>alpha=1</code> is equivalent to 
the MCP/SCAD/LASSO penalty, while <code>alpha=0</code> is equivalent to ridge regression. However,
<code>alpha=0</code> is not supported; <code>alpha</code> may be arbitrarily small, but not exactly zero</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_gamma_penalty">gamma_penalty</code></td>
<td>
<p>The scaling factor of the MCP and SCAD penalties. Not used by LASSO penalty.
Default is 4.0 for SCAD and 3.0 for MCP. See Breheny and Huang (2011) &lt;doi:10.1214/10-AOAS388&gt; 
and Breheny and Huang (2015) &lt;doi:10.1007/s11222-013-9424-2&gt; for further details.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_optim_options">optim_options</code></td>
<td>
<p>a structure of class &quot;optimControl&quot; created 
from function <code><a href="#topic+optimControl">optimControl</a></code> that specifies several optimization parameters. See the 
documentation for <code><a href="#topic+optimControl">optimControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_adapt_rw_options">adapt_RW_options</code></td>
<td>
<p>a list of class &quot;adaptControl&quot; from function <code><a href="#topic+adaptControl">adaptControl</a></code> 
containing the control parameters for the adaptive random walk Metropolis-within-Gibbs procedure. 
Ignored if <code><a href="#topic+optimControl">optimControl</a></code> parameter <code>sampler</code> is set to &quot;stan&quot; (default) or &quot;independence&quot;.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_trace">trace</code></td>
<td>
<p>an integer specifying print output to include as function runs. Default value is 0. 
See Details for more information about output provided when trace = 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_tuning_options">tuning_options</code></td>
<td>
<p>a list of class &quot;selectControl&quot; or &quot;lambdaControl&quot; resulting from 
<code><a href="#topic+selectControl">selectControl</a></code> or <code><a href="#topic+lambdaControl">lambdaControl</a></code> containing additional control parameters.
When function <code>glmm</code> is used,the algorithm may be run using one specific set of
penalty parameters <code>lambda0</code> and <code>lambda1</code> by specifying such values in <code>lambdaControl()</code>. 
The default for <code>glmm</code> is to run the model fit with no penalization (<code>lambda0</code> = <code>lambda1</code> = 0).
When function <code>glmmPen</code> is run, <code>tuning_options</code> is specified using <code>selectControl()</code>. 
See the <code><a href="#topic+lambdaControl">lambdaControl</a></code> and <code><a href="#topic+selectControl">selectControl</a></code> documentation for further details.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_survival_options">survival_options</code></td>
<td>
<p>a structure of class &quot;survivalControl&quot; created 
from function <code><a href="#topic+survivalControl">survivalControl</a></code> that specifies several parameters needed to 
properly fit the input survival data using a piecewise constant hazard mixed model. See the 
documentation for <code><a href="#topic+survivalControl">survivalControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_bicq_posterior">BICq_posterior</code></td>
<td>
<p>an optional character string expressing the path and file 
basename of a file combination that 
will file-back or currently file-backs a <code>big.matrix</code> of the posterior samples from the 
minimal penalty model used for the BIC-ICQ calculation used for model selection. T
(BIC-ICQ reference: Ibrahim et al (2011)
&lt;doi:10.1111/j.1541-0420.2010.01463.x&gt;). 
If this argument is
specified as <code>NULL</code> (default) and BIC-ICQ calculations are requested (see <code><a href="#topic+selectControl">selectControl</a></code>)
for details), the posterior samples
will be saved in the file combination 'BICq_Posterior_Draws.bin' and 'BICq_Posterior_Draws.desc'
in the working directory.
See 'Details' section for additional details about the required format of <code>BICq_posterior</code>
and the file-backed big matrix.</p>
</td></tr>
<tr><td><code id="phmmPen_+3A_progress">progress</code></td>
<td>
<p>a logical value indicating if additional output should be given showing the
progress of the fit procedure. If <code>TRUE</code>, such output includes iteration-level information
for the fit procedure (iteration number EM_iter,
number of MCMC samples nMC, average Euclidean distance between current coefficients and coefficients
from t&ndash;defined in <code><a href="#topic+optimControl">optimControl</a></code>&ndash;iterations back EM_conv, 
and number of non-zero fixed and random effects covariates
not including the intercept). Additionally, <code>progress = TRUE</code>
gives some other information regarding the progress of the variable selection 
procedure, including the model selection criteria and log-likelihood estimates
for each model fit.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>BICq_posterior</code> details: If the <code>BIC_option</code> in <code><a href="#topic+selectControl">selectControl</a></code> 
(<code>tuning_options</code>) is specified 
to be 'BICq', this requests the calculation of the BIC-ICQ criterion during the selection
process. For the BIC-ICQ criterion to be calculated, a full model assuming a small valued 
lambda penalty needs to be fit, and the posterior draws from this full model need to be used. 
In order to avoid repetitive calculations of
this full model (i.e. if the user wants to re-run <code>phmmPen</code> with a different
set of penalty parameters), a <code>big.matrix</code> of these 
posterior draws will be file-backed as two files: a backing file with extention '.bin' and a 
descriptor file with extension '.desc'. The <code>BICq_posterior</code> argument should contain a 
path and a filename with no extension of the form &quot;./path/filename&quot; such that the backingfile and
the descriptor file would then be saved as &quot;./path/filename.bin&quot; and &quot;./path/filename.desc&quot;, respectively.
If <code>BICq_posterior</code> is set to <code>NULL</code>, then by default, the backingfile and descriptor
file are saved in the working directory as &quot;BICq_Posterior_Draws.bin&quot; and &quot;BICq_Posterior_Draws.desc&quot;.
If the big matrix of posterior draws is already file-backed, <code>BICq_posterior</code> should
specify the path and basename of the appropriate files (again of form &quot;./path/filename&quot;); 
the full model 
will not be fit again and the big.matrix of 
posterior draws will be read using the <code>attach.big.matrix</code> function of the
<code>bigmemory</code> package and used in the BIC-ICQ 
calcuations. If the appropriate files do not exist or <code>BICq_posterior</code> 
is specified as <code>NULL</code>, the full model will be fit and the full model posterior
draws will be saved as specified above. The algorithm will save 10^4 posterior draws automatically.
</p>
<p>Trace details: The value of 0 (default) does not output any extra information. The value of 1
additionally outputs the updated coefficients, updated covariance matrix values, and the
number of coordinate descent iterations used for the M step for each
EM iteration. When pre-screening procedure is used and/or if the BIC-ICQ criterion is
requested, trace = 1 gives additional information about the penalties used
for the 'full model' fit procedure. If Stan is not used as the E-step sampling mechanism, 
the value of 2 outputs all of the above plus gibbs acceptance rate information
for the adaptive random walk and independence samplers and the updated proposal standard deviation
for the adaptive random walk.
</p>


<h3>Value</h3>

<p>A reference class object of class <code><a href="#topic+pglmmObj">pglmmObj</a></code> for which many methods are 
available (e.g. <code>methods(class = "pglmmObj")</code>, see ?pglmmObj for additional documentation)
</p>

<hr>
<h2 id='phmmPen_FA'>Fit a Penalized Proportional Hazards Mixed Model via 
Monte Carlo Expectation Conditional Minimization (MCECM) using
a Piecewise Constant Hazard Mixed Model Approximation</h2><span id='topic+phmmPen_FA'></span>

<h3>Description</h3>

<p><code>phmmPen_FA</code> is used to approximate penalized proportional hazards mixed models using
using a piecewise constant hazard mixed survival model approximation via 
Monte Carlo Expectation Conditional Minimization (MCECM) and a factor model decomposition of
the random effects. 
The purpose of the function is to perform 
variable selection on both the fixed and random effects simultaneously for the
piecewise constant hazard mixed model. 
This function uses a factor model decomposition on the random effects. This assumption
reduces the latent space in the E-step (Expectation step) of the algorithm,
which reduces the computational complexity of the algorithm. This improves
the speed of the algorithm and enables the
scaling of the algorithm to larger dimensions.
<code>phmmPen_FA</code> selects the best model using 
BIC-type selection criteria (see <code><a href="#topic+selectControl">selectControl</a></code> documentation for 
further details). 
To improve the speed of the algorithm, consider setting
<code>var_restrictions</code> = &quot;fixef&quot; within the <code><a href="#topic+optimControl">optimControl</a></code> options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phmmPen_FA(
  formula,
  data = NULL,
  offset = NULL,
  r_estimation = rControl(),
  fixef_noPen = NULL,
  penalty = c("MCP", "SCAD", "lasso"),
  alpha = 1,
  gamma_penalty = switch(penalty[1], SCAD = 4, 3),
  optim_options = optimControl(),
  adapt_RW_options = adaptControl(),
  trace = 0,
  tuning_options = selectControl(),
  survival_options = survivalControl(),
  BICq_posterior = NULL,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phmmPen_FA_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed effects and 
random effects part of the model, with the response on the left of a ~ operator and the terms, 
separated by + operators, on the right. 
The response must be a <code>Surv</code> object (see
<code><a href="survival.html#topic+Surv">Surv</a></code> from the <code>survival</code> package).
Random-effects terms are distinguished by vertical bars 
(&quot;|&quot;) separating expression for design matrices from the grouping factor. <code>formula</code> should be 
of the same format needed for <code><a href="lme4.html#topic+glmer">glmer</a></code> in package <span class="pkg">lme4</span>. 
Only one grouping factor 
will be recognized. The random effects covariates need to be a subset of the fixed effects covariates.
The offset must be specified outside of the formula in the 'offset' argument.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>. If <code>data</code> is 
omitted, variables will be taken from the environment of <code>formula</code>.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_offset">offset</code></td>
<td>
<p>This can be used to specify an <em>a priori</em> known component to be included in the 
linear predictor during fitting. Default set to <code>NULL</code> (no offset). If the data 
argument is not <code>NULL</code>, this should be a numeric vector of length equal to the 
number of cases (the length of the response vector). 
If the data argument specifies a data.frame, the offset
argument should specify the name of a column in the data.frame.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_r_estimation">r_estimation</code></td>
<td>
<p>a list of class &quot;rControl&quot; from function <code><a href="#topic+rControl">rControl</a></code> 
containing the control parameters for the estimation of the number of latent
factors to use in the <code>glmmPen_FA</code> and <code>glmm_FA</code> estimation procedures.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_fixef_nopen">fixef_noPen</code></td>
<td>
<p>Optional vector of 0's and 1's of the same length as the number of fixed effects covariates
used in the model. Value 0 indicates the variable should not have its fixed effect coefficient
penalized, 1 indicates that it can be penalized. Order should correspond to the same order of the 
fixed effects given in the formula.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_penalty">penalty</code></td>
<td>
<p>character describing the type of penalty to use in the variable selection procedure.
Options include 'MCP', 'SCAD', and 'lasso'. Default is MCP penalty. If the random effect covariance
matrix is &quot;unstructured&quot;, then a group MCP, group SCAD, or group LASSO penalty is used on the 
random effects coefficients. See Breheny and Huang (2011) &lt;doi:10.1214/10-AOAS388&gt; 
and Breheny and Huang (2015) &lt;doi:10.1007/s11222-013-9424-2&gt; for details of these penalties.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_alpha">alpha</code></td>
<td>
<p>Tuning parameter for the Mnet estimator which controls the relative contributions 
from the MCP/SCAD/LASSO penalty and the ridge, or L2, penalty. <code>alpha=1</code> is equivalent to 
the MCP/SCAD/LASSO penalty, while <code>alpha=0</code> is equivalent to ridge regression. However,
<code>alpha=0</code> is not supported; <code>alpha</code> may be arbitrarily small, but not exactly zero</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_gamma_penalty">gamma_penalty</code></td>
<td>
<p>The scaling factor of the MCP and SCAD penalties. Not used by LASSO penalty.
Default is 4.0 for SCAD and 3.0 for MCP. See Breheny and Huang (2011) &lt;doi:10.1214/10-AOAS388&gt; 
and Breheny and Huang (2015) &lt;doi:10.1007/s11222-013-9424-2&gt; for further details.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_optim_options">optim_options</code></td>
<td>
<p>a structure of class &quot;optimControl&quot; created 
from function <code><a href="#topic+optimControl">optimControl</a></code> that specifies several optimization parameters. See the 
documentation for <code><a href="#topic+optimControl">optimControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_adapt_rw_options">adapt_RW_options</code></td>
<td>
<p>a list of class &quot;adaptControl&quot; from function <code><a href="#topic+adaptControl">adaptControl</a></code> 
containing the control parameters for the adaptive random walk Metropolis-within-Gibbs procedure. 
Ignored if <code><a href="#topic+optimControl">optimControl</a></code> parameter <code>sampler</code> is set to &quot;stan&quot; (default) or &quot;independence&quot;.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_trace">trace</code></td>
<td>
<p>an integer specifying print output to include as function runs. Default value is 0. 
See Details for more information about output provided when trace = 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_tuning_options">tuning_options</code></td>
<td>
<p>a list of class &quot;selectControl&quot; or &quot;lambdaControl&quot; resulting from 
<code><a href="#topic+selectControl">selectControl</a></code> or <code><a href="#topic+lambdaControl">lambdaControl</a></code> containing additional control parameters.
When function <code>glmm</code> is used,the algorithm may be run using one specific set of
penalty parameters <code>lambda0</code> and <code>lambda1</code> by specifying such values in <code>lambdaControl()</code>. 
The default for <code>glmm</code> is to run the model fit with no penalization (<code>lambda0</code> = <code>lambda1</code> = 0).
When function <code>glmmPen</code> is run, <code>tuning_options</code> is specified using <code>selectControl()</code>. 
See the <code><a href="#topic+lambdaControl">lambdaControl</a></code> and <code><a href="#topic+selectControl">selectControl</a></code> documentation for further details.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_survival_options">survival_options</code></td>
<td>
<p>a structure of class &quot;survivalControl&quot; created 
from function <code><a href="#topic+survivalControl">survivalControl</a></code> that specifies several parameters needed to 
properly fit the input survival data using a piecewise constant hazard mixed model. See the 
documentation for <code><a href="#topic+survivalControl">survivalControl</a></code> for more details on defaults.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_bicq_posterior">BICq_posterior</code></td>
<td>
<p>an optional character string expressing the path and file 
basename of a file combination that 
will file-back or currently file-backs a <code>big.matrix</code> of the posterior samples from the 
minimal penalty model used for the BIC-ICQ calculation used for model selection. T
(BIC-ICQ reference: Ibrahim et al (2011)
&lt;doi:10.1111/j.1541-0420.2010.01463.x&gt;). 
If this argument is
specified as <code>NULL</code> (default) and BIC-ICQ calculations are requested (see <code><a href="#topic+selectControl">selectControl</a></code>)
for details), the posterior samples
will be saved in the file combination 'BICq_Posterior_Draws.bin' and 'BICq_Posterior_Draws.desc'
in the working directory.
See 'Details' section for additional details about the required format of <code>BICq_posterior</code>
and the file-backed big matrix.</p>
</td></tr>
<tr><td><code id="phmmPen_FA_+3A_progress">progress</code></td>
<td>
<p>a logical value indicating if additional output should be given showing the
progress of the fit procedure. If <code>TRUE</code>, such output includes iteration-level information
for the fit procedure (iteration number EM_iter,
number of MCMC samples nMC, average Euclidean distance between current coefficients and coefficients
from t&ndash;defined in <code><a href="#topic+optimControl">optimControl</a></code>&ndash;iterations back EM_conv, 
and number of non-zero fixed and random effects covariates
not including the intercept). Additionally, <code>progress = TRUE</code>
gives some other information regarding the progress of the variable selection 
procedure, including the model selection criteria and log-likelihood estimates
for each model fit.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>BICq_posterior</code> details: If the <code>BIC_option</code> in <code><a href="#topic+selectControl">selectControl</a></code> 
(<code>tuning_options</code>) is specified 
to be 'BICq', this requests the calculation of the BIC-ICQ criterion during the selection
process. For the BIC-ICQ criterion to be calculated, a full model assuming a small valued 
lambda penalty needs to be fit, and the posterior draws from this full model need to be used. 
In order to avoid repetitive calculations of
this full model (i.e. if the user wants to re-run <code>phmmPen</code> with a different
set of penalty parameters), a <code>big.matrix</code> of these 
posterior draws will be file-backed as two files: a backing file with extention '.bin' and a 
descriptor file with extension '.desc'. The <code>BICq_posterior</code> argument should contain a 
path and a filename with no extension of the form &quot;./path/filename&quot; such that the backingfile and
the descriptor file would then be saved as &quot;./path/filename.bin&quot; and &quot;./path/filename.desc&quot;, respectively.
If <code>BICq_posterior</code> is set to <code>NULL</code>, then by default, the backingfile and descriptor
file are saved in the working directory as &quot;BICq_Posterior_Draws.bin&quot; and &quot;BICq_Posterior_Draws.desc&quot;.
If the big matrix of posterior draws is already file-backed, <code>BICq_posterior</code> should
specify the path and basename of the appropriate files (again of form &quot;./path/filename&quot;); 
the full model 
will not be fit again and the big.matrix of 
posterior draws will be read using the <code>attach.big.matrix</code> function of the
<code>bigmemory</code> package and used in the BIC-ICQ 
calcuations. If the appropriate files do not exist or <code>BICq_posterior</code> 
is specified as <code>NULL</code>, the full model will be fit and the full model posterior
draws will be saved as specified above. The algorithm will save 10^4 posterior draws automatically.
</p>
<p>Trace details: The value of 0 (default) does not output any extra information. The value of 1
additionally outputs the updated coefficients, updated covariance matrix values, and the
number of coordinate descent iterations used for the M step for each
EM iteration. When pre-screening procedure is used and/or if the BIC-ICQ criterion is
requested, trace = 1 gives additional information about the penalties used
for the 'full model' fit procedure. If Stan is not used as the E-step sampling mechanism, 
the value of 2 outputs all of the above plus gibbs acceptance rate information
for the adaptive random walk and independence samplers and the updated proposal standard deviation
for the adaptive random walk.
</p>


<h3>Value</h3>

<p>A reference class object of class <code><a href="#topic+pglmmObj">pglmmObj</a></code> for which many methods are 
available (e.g. <code>methods(class = "pglmmObj")</code>, see ?pglmmObj for additional documentation)
</p>

<hr>
<h2 id='plot_mcmc'>Plot Diagnostics for MCMC Posterior Draws of the Random Effects</h2><span id='topic+plot_mcmc'></span>

<h3>Description</h3>

<p>Provides graphical diagnostics of the random effect posterior draws from the (best) model.
Availabile diagnostics include the sample path, histograms, cummulative sums, and autocorrelation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_mcmc(
  object,
  plots = "sample.path",
  grps = "all",
  vars = "all",
  numeric_grp_order = FALSE,
  bin_width = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_mcmc_+3A_object">object</code></td>
<td>
<p>an object of class <code>pglmmObj</code></p>
</td></tr>
<tr><td><code id="plot_mcmc_+3A_plots">plots</code></td>
<td>
<p>a character string or a vector of character strings specifying which graphical
diagnostics to provide. Options include a sample path plot (default, &quot;sample.path&quot;), 
autocorrelation plots (&quot;autocorr&quot;), histograms (&quot;histogram&quot;), cumulative sum plots (&quot;cumsum&quot;),
and all four possible plot options (&quot;all&quot;). While the &quot;all&quot; option will produce all four
possible plots, subsets of the types of plots (e.g. sample path plots and autocorrelation plots
only) can be specified with a vector of the relevant character strings 
(e.g. c(&quot;sample.path&quot;,&quot;autocorr&quot;))</p>
</td></tr>
<tr><td><code id="plot_mcmc_+3A_grps">grps</code></td>
<td>
<p>a character string or a vector of character strings specifying which groups 
should have diagnostics provided. The names of the groups match the input group factor levels.
Default is set to 'all' for all groups.</p>
</td></tr>
<tr><td><code id="plot_mcmc_+3A_vars">vars</code></td>
<td>
<p>a character string or a vector of character strings specifying which variables
should have diagnostics provided. Default is set to
'all', which picks all variables with non-zero random effects.
Tip: can find the names of the random effect variables in
the output sigma matrix found in the <code>pglmmObj</code> object, run <code>sigma(object)</code>.</p>
</td></tr>
<tr><td><code id="plot_mcmc_+3A_numeric_grp_order">numeric_grp_order</code></td>
<td>
<p>if TRUE, specifies that the groups factor should be converted to numeric 
values. This option could be used to ensure that the organization of the groups is in the 
proper numeric order (e.g. groups with levels 1-10 are ordered 1-10, not 1, 10, 2-9).</p>
</td></tr>
<tr><td><code id="plot_mcmc_+3A_bin_width">bin_width</code></td>
<td>
<p>optional binwidth argument for <code>geom_histogram</code> from the <code>ggplot2</code> 
package. Default set to <code>NULL</code>, which specifies the default <code>geom_histogram</code> binwidth. 
This argument only applies if the &quot;histogram&quot; plot type is selected.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of ggplot graphics, each faceted by group and random effect variable. 
Type of plots specified in the <code>plots</code> argument.
</p>

<hr>
<h2 id='rControl'>Control of Latent Factor Model Number Estimation
Constructs the control structure for the estimation of the 
number of latent factors (r) for use within the <code>glmmPen_FA</code> and
<code>glmm_FA</code> estimation procedures.</h2><span id='topic+rControl'></span>

<h3>Description</h3>

<p>Control of Latent Factor Model Number Estimation
</p>
<p>Constructs the control structure for the estimation of the 
number of latent factors (r) for use within the <code>glmmPen_FA</code> and
<code>glmm_FA</code> estimation procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rControl(
  r = NULL,
  r_max = NULL,
  r_est_method = "GR",
  size = 25,
  sample = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rControl_+3A_r">r</code></td>
<td>
<p>positive integer specifying number of latent common factors to assume 
in the model. If <code>NULL</code> (default), this value estimated from the data. See 
<code>r_est_method</code> for available estimation procedures, and the Details
section for further details on the general estimation procedure.
If <code>r</code> is specified, the no estimation procedure is performed and the algorithm
uses the input value or r. All other parameters for this function are
relevant for the estimation procedure.</p>
</td></tr>
<tr><td><code id="rControl_+3A_r_max">r_max</code></td>
<td>
<p>positive integer specifying maximum number of latent factors to consider.
If <code>NULL</code> (default), this value is automatically calculated.</p>
</td></tr>
<tr><td><code id="rControl_+3A_r_est_method">r_est_method</code></td>
<td>
<p>character string indicating method used to estimate number
of latent factors <code>r</code>. Default &quot;GR&quot; uses the Growth Ratio method of
Ahn and Horenstein (2013) (&lt;doi:10.3982/ECTA8968&gt;). 
Other available options include &quot;ER&quot; for
the Eigenvalue Ratio method of Ahn and Horenstein (2013) (&lt;doi:10.3982/ECTA8968&gt;) 
and &quot;BN1&quot; or &quot;BN2&quot;,
the Bai and Ng (2002) method (&lt;dio:10.1111/1468-0262.00273&gt;) using one of two penalties: 
(1) <code>(d + p) / (d p) log(d p/(d+p))</code> or
(2) <code>(d + p) / (d p) log(min(d,p))</code> where d is the number of groups in
the data and p is the number of total random effect covariates (including the intercept)</p>
</td></tr>
<tr><td><code id="rControl_+3A_size">size</code></td>
<td>
<p>positive integer specifying the total number of pseudo random
effect estimates to use in the estimation procedure for the number of latent factors
r, which is restricted to be no less than 25. If this <code>size</code> is greater
than the number of groups in the data (i.e.~the number of levels of the grouping
variable), then a sampling procedure is used to increase the number of pseudo estimates
to the value of <code>size</code> if the value of <code>sample</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rControl_+3A_sample">sample</code></td>
<td>
<p>logical value indicating if the total number of pseudo random effect
estimates to use in the estimation procedure for the number of latent common factors r
should be larger than the number of unique groups in the data, where the number 
of pseudo estimates are increased to the value of <code>size</code> using a sampling 
procedure. Default is <code>FALSE</code>. If <code>TRUE</code>, the sampling procedure is only
performed if the value of <code>size</code> is greater than the number of groups in the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of <code>r</code> procedure: For each level of the group variable separately,
we identify the observations within that group and 
fit a regular penalized generalized linear model where the penalty value is the
minimum fixed effect penalty. These group-specific estimates, which we label as 'pseudo random effects',
are placed into a matrix <code>G</code>
(rows = number of levels of the grouping variable, columns = number of random effect covariates),
and this pseudo random effects matrix is treated as the observed outcome matrix used in
the &quot;GR&quot;, &quot;ER&quot;, and &quot;BN&quot; estimation procedures described above in the description of <code>r_est_method</code>.
</p>

<hr>
<h2 id='sim.data'>Simulates data to use for the <code><a href="#topic+glmmPen">glmmPen</a></code> package</h2><span id='topic+sim.data'></span><span id='topic+sim.data.FA'></span><span id='topic+sim.data.piecewise.exp'></span>

<h3>Description</h3>

<p>Simulates data to use for testing the <code><a href="#topic+glmmPen">glmmPen</a></code> package.
<code>sim.data</code> simulates data for <code><a href="#topic+glmmPen">glmmPen</a></code>,
<code>sim.data.FA</code> simulates data for <code><a href="#topic+glmmPen_FA">glmmPen_FA</a></code>,
and <code>sim.data.piecewise.exp</code> simulates data for <code><a href="#topic+phmmPen">phmmPen</a></code> and <code><a href="#topic+phmmPen_FA">phmmPen_FA</a></code>.
Possible parameters to specify includes number of total covariates,
number of non-zero fixed and random effects, and the magnitude
of the random effect covariance values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.data(
  n,
  ptot,
  pnonzero,
  nstudies,
  sd_raneff = 1,
  family = "binomial",
  corr = NULL,
  seed,
  imbalance = 0,
  beta = NULL,
  pnonzerovar = 0,
  sd_x = 1
)

sim.data.FA(
  n,
  ptot,
  pnonzero,
  nstudies,
  sd_raneff = 0,
  family = "binomial",
  B = NULL,
  r = 2,
  corr = NULL,
  seed,
  imbalance = 0,
  beta = NULL,
  pnonzerovar = 0,
  sd_x = 1
)

sim.data.piecewise.exp(
  n,
  ptot,
  pnonzero,
  nstudies,
  sd_raneff = 0,
  B = NULL,
  r = 2,
  cut_points = c(0, 0.5, 1, 1.5, 2),
  lhaz_vals = c(-1.5, 1, 2.7, 3.7, 6.8),
  cens_type = c("exp", "unif"),
  cens_max = 5,
  exp_rate = 0.15,
  seed,
  imbalance = 0,
  beta = NULL,
  pnonzerovar = 0,
  sd_x = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.data_+3A_n">n</code></td>
<td>
<p>integer specifying total number of samples to generate</p>
</td></tr>
<tr><td><code id="sim.data_+3A_ptot">ptot</code></td>
<td>
<p>integer specifying total number of covariates to generate 
(values randomly generated from the standard normal distribution)</p>
</td></tr>
<tr><td><code id="sim.data_+3A_pnonzero">pnonzero</code></td>
<td>
<p>integer specifying how may of the covariates should have
non-zero fixed and random effects</p>
</td></tr>
<tr><td><code id="sim.data_+3A_nstudies">nstudies</code></td>
<td>
<p>number of studies/groups to have in the data</p>
</td></tr>
<tr><td><code id="sim.data_+3A_sd_raneff">sd_raneff</code></td>
<td>
<p>non-negative value specifying the standard deviation of the
random effects covariance matrix (applied to the non-zero random effects)</p>
</td></tr>
<tr><td><code id="sim.data_+3A_family">family</code></td>
<td>
<p>character string specifying which family to generate data from.
Family options include &quot;binomial&quot; (default), &quot;poisson&quot;, and &quot;gaussian&quot;.</p>
</td></tr>
<tr><td><code id="sim.data_+3A_corr">corr</code></td>
<td>
<p>optional value to specify correlation between covariates
in the model matrix. Default <code>NULL</code>, only available within <code>sim.data</code>.</p>
</td></tr>
<tr><td><code id="sim.data_+3A_seed">seed</code></td>
<td>
<p>integer to use for the setting of a random seed</p>
</td></tr>
<tr><td><code id="sim.data_+3A_imbalance">imbalance</code></td>
<td>
<p>integer of 0 or 1 indicating whether the observations should
be equally distributed among the groups (0) or unequally distributed (1).</p>
</td></tr>
<tr><td><code id="sim.data_+3A_beta">beta</code></td>
<td>
<p>numeric vector of the fixed effects (including intercept)</p>
</td></tr>
<tr><td><code id="sim.data_+3A_pnonzerovar">pnonzerovar</code></td>
<td>
<p>non-negative integer specifying the number of 
covariates with a zero-valued fixed effect but a non-zero random effect.</p>
</td></tr>
<tr><td><code id="sim.data_+3A_sd_x">sd_x</code></td>
<td>
<p>non-negative value specifying the standard deviation of the
simulated covariates (drawn from a normal distribution with mean 0,
standard deviation <code>sd_x</code>)</p>
</td></tr>
<tr><td><code id="sim.data_+3A_b">B</code></td>
<td>
<p>matrix specifying the factor loadings matrix for the random effects,
only used within <code>sim.data.FA</code>.
Dimensions: number of columns is the number of random effects (including the intercept),
and number of rows is the number of latent common factors (<code>r</code>).
The random effect covariance matrix is specified as Sigma = B x t(B) + diag(sd_raneff)</p>
</td></tr>
<tr><td><code id="sim.data_+3A_r">r</code></td>
<td>
<p>positive integer specifying number of latent common factors that describe the random effects,
only used within <code>sim.data.FA</code></p>
</td></tr>
<tr><td><code id="sim.data_+3A_cut_points">cut_points</code></td>
<td>
<p>vector of cut points to use for the time intervals when simulating piecewise 
exponential data. Length of cut points must equal length of <code>lhaz_vals</code>, and the 
value of the first cut point must be 0.</p>
</td></tr>
<tr><td><code id="sim.data_+3A_lhaz_vals">lhaz_vals</code></td>
<td>
<p>vector of the log baseline hazard values for each time interval (which
correspond to the time intervals defined by the <code>cut_points</code> argument) within
piecewise exponential data. Hazards are assumed to be constant within each time interval.</p>
</td></tr>
<tr><td><code id="sim.data_+3A_cens_type">cens_type</code></td>
<td>
<p>character specifying type of censoring to implement. Default &quot;unif&quot; specifies
uniform censoring from 0 to <code>cens_max</code>. The option &quot;exp&quot; specifies exponential
censoring with rate <code>exp_rate</code></p>
</td></tr>
<tr><td><code id="sim.data_+3A_cens_max">cens_max</code></td>
<td>
<p>numeric value used to characterize the range of the uniform censoring procedure 
(from 0 to <code>cens_max</code>)</p>
</td></tr>
<tr><td><code id="sim.data_+3A_exp_rate">exp_rate</code></td>
<td>
<p>numeric value used to characterize the exponential censoring rate (where rate
is defined as the rate used in <code><a href="stats.html#topic+rexp">rexp</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing the following elements:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>vector of the response</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>model matrix for the fixed effects</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>model matrix for the random effects, organized first by variable
and then by group</p>
</td></tr>
<tr><td><code>pnonzero</code></td>
<td>
<p>number of non-zero fixed effects</p>
</td></tr>
<tr><td><code>z1</code></td>
<td>
<p>values of the random effects for each variable for each level of 
the grouping factor</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>grouping factor</p>
</td></tr>
<tr><td><code>X0</code></td>
<td>
<p>model matrix for just the non-zero fixed effects</p>
</td></tr>
</table>

<hr>
<h2 id='survival_data'>Convert Input Survival Data Into Long-Form Data Needed for Fitting a Piecewise
Exponential Model</h2><span id='topic+survival_data'></span>

<h3>Description</h3>

<p>Converts the input survival data with one row or element corresponding to a 
single observation or subject into a long-form dataset where one observation or subject
contributes <code>j</code> rows, where <code>j</code> is the number of time intervals that 
a subject survived at least part-way through.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survival_data(y, X, Z, group, offset_fit = NULL, survival_options)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survival_data_+3A_y">y</code></td>
<td>
<p>response, which must be a <code>Surv</code> object (see
<code><a href="survival.html#topic+Surv">Surv</a></code> from the <code>survival</code> package)</p>
</td></tr>
<tr><td><code id="survival_data_+3A_x">X</code></td>
<td>
<p>matrix of fixed effects covariates</p>
</td></tr>
<tr><td><code id="survival_data_+3A_z">Z</code></td>
<td>
<p>matrix of random effects covariates</p>
</td></tr>
<tr><td><code id="survival_data_+3A_group">group</code></td>
<td>
<p>vector specifying the group assignment for each subject</p>
</td></tr>
<tr><td><code id="survival_data_+3A_offset_fit">offset_fit</code></td>
<td>
<p>vector specifying the offset. 
This can be used to specify an <em>a priori</em> known component to be included in the 
linear predictor during fitting. Default set to <code>NULL</code> (no offset). If the data 
argument is not <code>NULL</code>, this should be a numeric vector of length equal to the 
number of cases (the length of the response vector).</p>
</td></tr>
<tr><td><code id="survival_data_+3A_survival_options">survival_options</code></td>
<td>
<p>a structure of class &quot;survivalControl&quot; created 
from function <code><a href="#topic+survivalControl">survivalControl</a></code> that specifies several parameters needed to 
properly fit the input survival data using a piecewise constant hazard mixed model. See the 
documentation for <code><a href="#topic+survivalControl">survivalControl</a></code> for more details on defaults.</p>
</td></tr>
</table>

<hr>
<h2 id='survivalControl'>Control for Fitting Piecewise Constant Hazard Mixed Models as an Approximation to Fitting 
Cox Proportional Hazards Mixed Models</h2><span id='topic+survivalControl'></span>

<h3>Description</h3>

<p>Constructs the control structure for additional parameters needed to
properly fit survival data using a piecewise constant hazard mixed model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survivalControl(
  cut_num = 8,
  interval_type = c("equal", "manual", "group"),
  cut_points = NULL,
  time_scale = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survivalControl_+3A_cut_num">cut_num</code></td>
<td>
<p>positive integer specifying the number of time intervals to include in
the piecewise constant hazard model assumptions for the sampling step. Default is 8.
General recommendation: use between 5 and 10 intervals. See the Details section for
additional information.</p>
</td></tr>
<tr><td><code id="survivalControl_+3A_interval_type">interval_type</code></td>
<td>
<p>character specifying how the time intervals are calculated.
Options include 'equal' (default), 'manual', or 'group'.
If 'equal' (default),  time intervals
are calculated such that there are approximately equal numbers of events per time 
interval.
If 'manual', the user needs to input
their own cut points (see <code>cut_points</code> for details).
If 'group', time intervals are calculated such that there are approximately
equal numbers of events per time interval AND there are at least 4 events observed
by each group within each time interval. The input number of time intervals <code>cut_num</code>
may be modified to a lower number in order to accomplish this goal. 
This option is generally difficult to perform when there are 
a large number of groups in the data.</p>
</td></tr>
<tr><td><code id="survivalControl_+3A_cut_points">cut_points</code></td>
<td>
<p>numeric vector specifying the value of the cut points to use
in the calculation of the time intervals for the piecewise constant hazard model. 
If <code>interval_type</code> set to 'equal' or 'group', then this argument is not utilized.
If <code>interval_type</code> set to 'manual', then this argument is required.
First value must be 0, and all values must be ordered smallest to largest.</p>
</td></tr>
<tr><td><code id="survivalControl_+3A_time_scale">time_scale</code></td>
<td>
<p>positive numeric value (greater than 1) used to scale the time variable 
in the survival data. In order to calculate the piecewise constant hazard mixed model,
the log of the time a subject survived within a particular time interval
is used as an offset in the model fit. Sometimes multiplying the time scale
by a factor greater than 1 improves the stability of the model fit algorithm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the piecewise constant hazard model, there is an assumption that the 
time line of the data can be cut into <code>cut_num</code>
time intervals and the baseline hazard is constant within
each of these time intervals. In the fit algorithm, we estimate
these baseline hazard values (specifically, we estimate the log of the baseline
hazard values). By default, we determine cut points by specifying the total number of cuts
to make (<code>cut_num</code>) and then specifying time values for cut points such
that each time interval has an approximately equal number 
of events (<code>interval_type = equal</code>).
The authors of this package have found simulations to work well using this default <code>interval_type = equal</code>,
but if desired, users can further specify that each group has at least some (4) events observed
within each time interval. 
Regardless of the <code>interval_type</code> choice, users should be aware that 
having too many cut points could result in having too few
events for each time interval needed for a stable estimation of the baseline hazard estimates.
Additionally, data with few events could result in too few events per time interval
even for a small number of cut points. 
Alternatively, having too few cut points could result in a sub-par approximation of the baseline hazard, 
which can lead to biased estimation for the coefficients corresponding to the input variables of interest.
We generally recommend having
8 total time intervals (more broadly, between 5 and 10 total time intervals). Warnings or errors
will occur for cases when there are 1 or 0 events for a time interval. 
If this happens, either adjust the <code>cut_num</code> value appropriately,
or in the case when the data simply has a very small number of events,
consider not using this software for your estimation purposes.
</p>


<h3>Value</h3>

<p>Function returns a list inheriting from class <code>survivalControl</code>
containing fit and optimization criteria values used in optimization routine.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
