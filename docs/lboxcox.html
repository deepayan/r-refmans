<!DOCTYPE html><html><head><title>Help for package lboxcox</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lboxcox}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#box_cox_new'><p>Box-Cox transform</p></a></li>
<li><a href='#depress'><p>Depression dataset</p></a></li>
<li><a href='#lbc_maxlik'><p>Train a Logistic Box-Cox model using MaxLik</p></a></li>
<li><a href='#lbc_train'><p>Train a Logistic Box-Cox model</p></a></li>
<li><a href='#lboxcox_maxLik.predict'><p>Lboxcox MaxLik Prediction Function</p></a></li>
<li><a href='#LogLikeFun'><p>Log Likelihood of Logistic Box-Cox</p></a></li>
<li><a href='#LogLikeFun_new'><p>New Log Likelihood of Logistic Box-Cox</p></a></li>
<li><a href='#median_effect'><p>Calculates the &quot;slope&quot; of the Logistic Box-Cox model</p></a></li>
<li><a href='#ScoreFun'><p>Log Likelihood Gradient of Logistic Box-Cox</p></a></li>
<li><a href='#ScoreFun_new'><p>New Log Likelihood Gradient of Logistic Box-Cox</p></a></li>
<li><a href='#svyglm_ms'><p>Svyglm of MaxLik_ms</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Implementation of Logistic Box-Cox Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-12</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Li Xing &lt;sfulxing@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a logistic box-cox model. This model is fully described in Xing, L. et al. (2021) &lt;<a href="https://doi.org/10.1002%2Fcjs.11587">doi:10.1002/cjs.11587</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.50)</td>
</tr>
<tr>
<td>Imports:</td>
<td>survey, maxLik, doParallel, foreach, MASS, dplyr, R.utils</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-15 22:20:10 UTC; xushiyu</td>
</tr>
<tr>
<td>Author:</td>
<td>Li Xing [cre, aut],
  Shiyu Xu [aut],
  Jing Wang [aut],
  Kohlton Booth [aut],
  Xuekui Zhang [aut],
  Igor Burstyn [aut],
  Paul Gustafson [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-15 23:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='box_cox_new'>Box-Cox transform</h2><span id='topic+box_cox_new'></span>

<h3>Description</h3>

<p>This function processes the box cox transform on varibles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>box_cox_new(formula, mydata, ixx, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="box_cox_new_+3A_formula">formula</code></td>
<td>
<p>a formula of the form y ~ x + z1 + z2 where y is a binary response variable, x is a continuous predictor variable, and z1, z2, ... are  covariates</p>
</td></tr>
<tr><td><code id="box_cox_new_+3A_mydata">mydata</code></td>
<td>
<p>dataset used in box cox transform</p>
</td></tr>
<tr><td><code id="box_cox_new_+3A_ixx">ixx</code></td>
<td>
<p>continuous predictor</p>
</td></tr>
<tr><td><code id="box_cox_new_+3A_lambda">lambda</code></td>
<td>
<p>lambda used in box cox transform</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data set after transform, contains transformed ixx
</p>

<hr>
<h2 id='depress'>Depression dataset</h2><span id='topic+depress'></span>

<h3>Description</h3>

<p>The depress data frame has 8,893 rows and 5 columns from the National Health and Nutrition Examination Survey (NHANES) 2009–2010.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>depress
</code></pre>


<h3>Format</h3>

<p>Sample survey data
</p>

<dl>
<dt>depression</dt><dd><p>binary response variable indicating whether the participant has depression (=1) or not (=0)</p>
</dd>
<dt>mercury</dt><dd><p>a numeric vector giving the log-transformed total blood mercury in micro-grams per litre</p>
</dd>
<dt>age</dt><dd><p>0 of particiapant is female and 1 if they are male</p>
</dd>
<dt>gender</dt><dd><p>age of the participant</p>
</dd>
<dt>weight</dt><dd><p>a numeric vector giving the sampling-weight.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Xing, L., Zhang, X., Burstyn, I., &amp; Gustafson, P. (2021). On logistic Box–Cox regression for flexibly estimating the shape and strength of exposure‐disease relationships. Canadian Journal of Statistics, 49(3), 808-825.
</p>

<hr>
<h2 id='lbc_maxlik'>Train a Logistic Box-Cox model using MaxLik</h2><span id='topic+lbc_maxlik'></span>

<h3>Description</h3>

<p>Train the given formula using a Logistic Box-Cox model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lbc_maxlik(
  formula,
  weight_column_name,
  data,
  init = NULL,
  svy_lambda_vector = seq(0, 2, length = 4),
  init_lambda_vector = seq(0, 2, length = 100),
  num_cores = 1,
  seed,
  iterlim,
  timelim
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lbc_maxlik_+3A_formula">formula</code></td>
<td>
<p>a formula of the form y ~ x + z1 + z2 where y is a binary response variable, x is a continuous predictor variable, and z1, z2, ... are  covariates</p>
</td></tr>
<tr><td><code id="lbc_maxlik_+3A_weight_column_name">weight_column_name</code></td>
<td>
<p>the name of the column in 'data' containing the survey weights.</p>
</td></tr>
<tr><td><code id="lbc_maxlik_+3A_data">data</code></td>
<td>
<p>dataframe containing the dataset to train on</p>
</td></tr>
<tr><td><code id="lbc_maxlik_+3A_init">init</code></td>
<td>
<p>initial estimates for the coefficients. If NULL the svyglm model will be used</p>
</td></tr>
<tr><td><code id="lbc_maxlik_+3A_svy_lambda_vector">svy_lambda_vector</code></td>
<td>
<p>values of lambda used in training svyglm model. Best model is used for initial coefficient estimates. If init is not NULL this parameter is ignored.</p>
</td></tr>
<tr><td><code id="lbc_maxlik_+3A_init_lambda_vector">init_lambda_vector</code></td>
<td>
<p>values of lambda used in finding the optimal lambda with the best loglikelihood</p>
</td></tr>
<tr><td><code id="lbc_maxlik_+3A_num_cores">num_cores</code></td>
<td>
<p>the number of cores used when finding the best svyglm model. If init is not NULL this parameter is ignored.</p>
</td></tr>
<tr><td><code id="lbc_maxlik_+3A_seed">seed</code></td>
<td>
<p>set seed for MaxLik function</p>
</td></tr>
<tr><td><code id="lbc_maxlik_+3A_iterlim">iterlim</code></td>
<td>
<p>Maximum number of iterations of MaxLik</p>
</td></tr>
<tr><td><code id="lbc_maxlik_+3A_timelim">timelim</code></td>
<td>
<p>Maximum iteration time of MaxLik</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class 'maxLik' from the 'maxLik' package. Contains the coefficient estimates that maximizes likelhood among other statistics.
</p>


<h3>Note</h3>

<p>This is reliant on the following work:
</p>
<p>Henningsen, A., Toomet, O. (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics, 26(3), 443-458.
</p>
<p>Microsoft Corporation, Weston, S. (2020). foreach: Provides Foreach Looping Construct. R package version 1.5.1.
</p>
<p>Microsoft Corporation, Weston, S. (2020). doParallel: Foreach Parallel Adaptor for the 'parallel' Package. R package version 1.0.16.
</p>

<hr>
<h2 id='lbc_train'>Train a Logistic Box-Cox model</h2><span id='topic+lbc_train'></span>

<h3>Description</h3>

<p>Train the given formula using a Logistic Box-Cox model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lbc_train(
  formula,
  weight_column_name,
  data,
  init = NULL,
  svy_lambda_vector = seq(0, 2, length = 100),
  num_cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lbc_train_+3A_formula">formula</code></td>
<td>
<p>a formula of the form y ~ x + z1 + z2 where y is a binary response variable, x is a continuous predictor variable, and z1, z2, ... are  covariates</p>
</td></tr>
<tr><td><code id="lbc_train_+3A_weight_column_name">weight_column_name</code></td>
<td>
<p>the name of the column in 'data' containing the survey weights.</p>
</td></tr>
<tr><td><code id="lbc_train_+3A_data">data</code></td>
<td>
<p>dataframe containing the dataset to train on</p>
</td></tr>
<tr><td><code id="lbc_train_+3A_init">init</code></td>
<td>
<p>initial estimates for the coefficients. If NULL the svyglm model will be used</p>
</td></tr>
<tr><td><code id="lbc_train_+3A_svy_lambda_vector">svy_lambda_vector</code></td>
<td>
<p>values of lambda used in training svyglm model. Best model is used for initial coefficient estimates. If init is not NULL this parameter is ignored.</p>
</td></tr>
<tr><td><code id="lbc_train_+3A_num_cores">num_cores</code></td>
<td>
<p>the number of cores used when finding the best svyglm model. If init is not NULL this parameter is ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class 'maxLik' from the 'maxLik' package. Contains the coefficient estimates that maximizes likelhood among other statistics.
</p>


<h3>Note</h3>

<p>This is reliant on the following work:
</p>
<p>Henningsen, A., Toomet, O. (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics, 26(3), 443-458.
</p>
<p>Microsoft Corporation, Weston, S. (2020). foreach: Provides Foreach Looping Construct. R package version 1.5.1.
</p>
<p>Microsoft Corporation, Weston, S. (2020). doParallel: Foreach Parallel Adaptor for the 'parallel' Package. R package version 1.0.16.
</p>

<hr>
<h2 id='lboxcox_maxLik.predict'>Lboxcox MaxLik Prediction Function</h2><span id='topic+lboxcox_maxLik.predict'></span>

<h3>Description</h3>

<p>Give the predicted p value of given LBC MaxLik model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lboxcox_maxLik.predict(myMaxLikfit, newdata, formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lboxcox_maxLik.predict_+3A_mymaxlikfit">myMaxLikfit</code></td>
<td>
<p>Fitted model using lboxcox_maxLik model</p>
</td></tr>
<tr><td><code id="lboxcox_maxLik.predict_+3A_newdata">newdata</code></td>
<td>
<p>Given data for prediction</p>
</td></tr>
<tr><td><code id="lboxcox_maxLik.predict_+3A_formula">formula</code></td>
<td>
<p>a formula of the form y ~ x + z1 + z2 where y is a binary response variable, x is a continuous predictor variable, and z1, z2, ... are  covariates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p value
</p>


<h3>Note</h3>

<p>This is reliant on the following work:
</p>

<hr>
<h2 id='LogLikeFun'>Log Likelihood of Logistic Box-Cox</h2><span id='topic+LogLikeFun'></span>

<h3>Description</h3>

<p>This function gives the log likelihood of the Box-Cox model.
Main purpose is to be an input to the maxLik function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LogLikeFun(bb, ixx, iyy, iw, iZZ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LogLikeFun_+3A_bb">bb</code></td>
<td>
<p>current values for the intercept and slope coefficients</p>
</td></tr>
<tr><td><code id="LogLikeFun_+3A_ixx">ixx</code></td>
<td>
<p>continuous predictor</p>
</td></tr>
<tr><td><code id="LogLikeFun_+3A_iyy">iyy</code></td>
<td>
<p>binary outcome</p>
</td></tr>
<tr><td><code id="LogLikeFun_+3A_iw">iw</code></td>
<td>
<p>sample weight</p>
</td></tr>
<tr><td><code id="LogLikeFun_+3A_izz">iZZ</code></td>
<td>
<p>covariates to be incorporated in the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the log likelihood estimate for the coefficients in 'bb'
</p>

<hr>
<h2 id='LogLikeFun_new'>New Log Likelihood of Logistic Box-Cox</h2><span id='topic+LogLikeFun_new'></span>

<h3>Description</h3>

<p>This function gives the log likelihood of the Box-Cox model.
Main purpose is to be an input to the maxLik function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LogLikeFun_new(bb, ixx, iyy, iw, iZZ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LogLikeFun_new_+3A_bb">bb</code></td>
<td>
<p>current values for the intercept and slope coefficients</p>
</td></tr>
<tr><td><code id="LogLikeFun_new_+3A_ixx">ixx</code></td>
<td>
<p>continuous predictor</p>
</td></tr>
<tr><td><code id="LogLikeFun_new_+3A_iyy">iyy</code></td>
<td>
<p>binary outcome</p>
</td></tr>
<tr><td><code id="LogLikeFun_new_+3A_iw">iw</code></td>
<td>
<p>sample weight</p>
</td></tr>
<tr><td><code id="LogLikeFun_new_+3A_izz">iZZ</code></td>
<td>
<p>covariates to be incorporated in the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the log likelihood estimate for the coefficients in 'bb'
</p>

<hr>
<h2 id='median_effect'>Calculates the &quot;slope&quot; of the Logistic Box-Cox model</h2><span id='topic+median_effect'></span>

<h3>Description</h3>

<p>Calculates a number that represents the overall gradient measurement between the predictor and log-odds of the risk
</p>
<p>Calculates a number that represents the overall gradient measurement between the predictor and log-odds of the risk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>median_effect(formula, weight_column_name, data, trained_model)

median_effect(formula, weight_column_name, data, trained_model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="median_effect_+3A_formula">formula</code></td>
<td>
<p>the formula used to train the logistic box-cox model</p>
</td></tr>
<tr><td><code id="median_effect_+3A_weight_column_name">weight_column_name</code></td>
<td>
<p>the name of the column in 'data' containing the survey weights</p>
</td></tr>
<tr><td><code id="median_effect_+3A_data">data</code></td>
<td>
<p>dataframe containing the dataset to train on</p>
</td></tr>
<tr><td><code id="median_effect_+3A_trained_model">trained_model</code></td>
<td>
<p>the already trained model. The output of 'lbc_train'</p>
</td></tr>
</table>

<hr>
<h2 id='ScoreFun'>Log Likelihood Gradient of Logistic Box-Cox</h2><span id='topic+ScoreFun'></span>

<h3>Description</h3>

<p>This function gives the gradient of the log likelihood of the Box-Cox model.
Main purpose is to be an input to the maxLik function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ScoreFun(bb, ixx, iyy, iw, iZZ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ScoreFun_+3A_bb">bb</code></td>
<td>
<p>initial values for the intercept and slope coefficients</p>
</td></tr>
<tr><td><code id="ScoreFun_+3A_ixx">ixx</code></td>
<td>
<p>continuous predictor</p>
</td></tr>
<tr><td><code id="ScoreFun_+3A_iyy">iyy</code></td>
<td>
<p>binary outcome</p>
</td></tr>
<tr><td><code id="ScoreFun_+3A_iw">iw</code></td>
<td>
<p>sample weight</p>
</td></tr>
<tr><td><code id="ScoreFun_+3A_izz">iZZ</code></td>
<td>
<p>covariates to be incorporated in the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the gradient of the log likelihood estimate for the coefficients in 'bb'
</p>

<hr>
<h2 id='ScoreFun_new'>New Log Likelihood Gradient of Logistic Box-Cox</h2><span id='topic+ScoreFun_new'></span>

<h3>Description</h3>

<p>This function gives the gradient of the log likelihood of the Box-Cox model.
Main purpose is to be an input to the maxLik function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ScoreFun_new(init, ixx, iyy, iw, iZZ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ScoreFun_new_+3A_init">init</code></td>
<td>
<p>initial values for the intercept and slope coefficients</p>
</td></tr>
<tr><td><code id="ScoreFun_new_+3A_ixx">ixx</code></td>
<td>
<p>continuous predictor</p>
</td></tr>
<tr><td><code id="ScoreFun_new_+3A_iyy">iyy</code></td>
<td>
<p>binary outcome</p>
</td></tr>
<tr><td><code id="ScoreFun_new_+3A_iw">iw</code></td>
<td>
<p>sample weight</p>
</td></tr>
<tr><td><code id="ScoreFun_new_+3A_izz">iZZ</code></td>
<td>
<p>covariates to be incorporated in the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the gradient of the log likelihood estimate for the coefficients in 'bb'
</p>

<hr>
<h2 id='svyglm_ms'>Svyglm of MaxLik_ms</h2><span id='topic+svyglm_ms'></span>

<h3>Description</h3>

<p>This function gives the initial value list used in MaxLik_ms function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svyglm_ms(
  formula,
  data,
  lambda_vector = seq(0, 2, length = 100),
  weight_column_name = NULL,
  num_cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svyglm_ms_+3A_formula">formula</code></td>
<td>
<p>formula used in model</p>
</td></tr>
<tr><td><code id="svyglm_ms_+3A_data">data</code></td>
<td>
<p>dataframe containing the dataset to train on</p>
</td></tr>
<tr><td><code id="svyglm_ms_+3A_lambda_vector">lambda_vector</code></td>
<td>
<p>values of lambda used in training svyglm model.</p>
</td></tr>
<tr><td><code id="svyglm_ms_+3A_weight_column_name">weight_column_name</code></td>
<td>
<p>the name of the column in 'data' containing the survey weights.</p>
</td></tr>
<tr><td><code id="svyglm_ms_+3A_num_cores">num_cores</code></td>
<td>
<p>the number of cores used when finding the best svyglm model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>initial value list used in MaxLik_ms function
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
