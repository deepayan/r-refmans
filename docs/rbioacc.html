<!DOCTYPE html><html><head><title>Help for package rbioacc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rbioacc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rbioacc-package'><p>The 'rbioacc' package.</p></a></li>
<li><a href='#.fonte'><p>A simple implementation of to pivot_longer of tidyr</p></a></li>
<li><a href='#.index_col_exposure'><p>Return column matching &quot;expw&quot;, &quot;exps&quot;, &quot;expf&quot;, &quot;exppw&quot; of a <code>data.frame</code></p></a></li>
<li><a href='#.index_col_metabolite'><p>Return column matching &quot;concX&quot; of a <code>data.frame</code> where X is metabolite</p></a></li>
<li><a href='#.is_equal_rmInf'><p>Check if two vectors <code>x</code> and <code>y</code> are equal after remove <code>Inf</code></p></a></li>
<li><a href='#bioacc_metric'><p>Biaccumulation metrics</p></a></li>
<li><a href='#Chiro_Creuzot'><p>Data on Chironomus with several exposure routes.</p></a></li>
<li><a href='#Chironomus_benzoapyrene'><p>Data on Chironomus exposed to benzoapyrene</p></a></li>
<li><a href='#corrMatrix'><p>Correlations between parameters: colored matrix</p></a></li>
<li><a href='#corrPlot'><p>Correlations between parameters: pairs plot</p></a></li>
<li><a href='#df_ppc'><p>PPC data.frame</p></a></li>
<li><a href='#df_PriorPost'><p>Data frame of Posterior over Prior</p></a></li>
<li><a href='#equations'><p>Equations of the mathematical model used for the fit</p></a></li>
<li><a href='#exposure_names'><p>Retrieve exposure routes names from object</p></a></li>
<li><a href='#Exposure_Sialis_lutaria'><p>Data on Sialis lutaria exposure time series</p></a></li>
<li><a href='#fitTK'><p>Posterior predictive check</p></a></li>
<li><a href='#Gammarus_azoxistrobine_1d_Rosch2017'><p>Data on Gammarus exposed to azoxistrobine</p></a></li>
<li><a href='#Internal_Sialis_lutaria'><p>Data on Sialis lutaria internal time series</p></a></li>
<li><a href='#Male_Gammarus_Merged'><p>Male <code>Gammarus fossarum</code> exposed to Hg spiked water.</p>
Three exposure concentrations were tested in triplicates. The duration of the
accumulation phase is 4 days for 0.0000708021 and 0.000283208
<code class="reqn">\mu g.m L^{-1}</code> exposure concentrations, and 7 days for 0.000141604
<code class="reqn">\mu g.m L^{-1}</code> exposure concentration.</a></li>
<li><a href='#Male_Gammarus_seanine_growth'><p>Male <code>Gammarus pulex</code> exposed to seanine spiked water. A single exposure</p>
concentration was tested. The duration of the accumulation phase is 1.417
days. Three metabolites were quantified. The growth of organism was included.</a></li>
<li><a href='#Male_Gammarus_Single'><p>Bio-accumulation data set for <em>Gammarus fossarum</em> exposed to Hg spiked water.</p></a></li>
<li><a href='#mcmcTraces'><p>Traces of MCMC iterations</p></a></li>
<li><a href='#modelData'><p>Create a list giving data and parameters to use in the model inference.</p></a></li>
<li><a href='#modelData_ode'><p>Create a list giving data and parameters to use in the model inference.</p></a></li>
<li><a href='#Oncorhynchus_two'><p>Data on Oncorhynchus exposition</p></a></li>
<li><a href='#plot_exposure'><p>Plot exposure profile</p></a></li>
<li><a href='#plot_PriorPost'><p>Plot Posterior over Prior</p></a></li>
<li><a href='#plot.bioaccMetric'><p>Plot function for object of class <code>bioaccMetric</code></p></a></li>
<li><a href='#plot.fitTK'><p>Plotting method for <code>fitTK</code> objects</p></a></li>
<li><a href='#plot.predictTK'><p>Plotting method for <code>predictTK</code> objects</p></a></li>
<li><a href='#predict.fitTK'><p>Prediction function using <code>fitTK</code> object</p></a></li>
<li><a href='#psrf'><p>Potential Scale Reduction Factors (PSRF) of the parameters</p></a></li>
<li><a href='#quantile_table'><p>Quantiles of parameters</p></a></li>
<li><a href='#replace_'><p>Replace element of a vector</p></a></li>
<li><a href='#t95'><p>Return the time at 95% depuration of the parent component</p></a></li>
<li><a href='#waic'><p>Widely Applicable Information Criterion (WAIC)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Inference and Prediction of ToxicoKinetic (TK) Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>The MOSAICbioacc application is a turnkey package providing bioaccumulation
    factors (BCF/BMF/BSAF) from a toxicokinetic (TK) model fitted to
    accumulation-depuration data. It is designed to fulfil the requirements
    of regulators when examining applications for market authorization of active
    substances. See Ratier et al. (2021) &lt;<a href="https://doi.org/10.1101%2F2021.09.08.459421">doi:10.1101/2021.09.08.459421</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.in2p3.fr/mosaic-software/rbioacc">https://gitlab.in2p3.fr/mosaic-software/rbioacc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.in2p3.fr/mosaic-software/rbioacc/-/issues">https://gitlab.in2p3.fr/mosaic-software/rbioacc/-/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, methods, Rcpp, rstan (&ge; 2.26.0), rstantools (&ge;
2.1.1), ggmcmc, GGally, loo, stringr, stats, zoo</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp, RcppEigen (&ge; 0.3.3.3.0), RcppParallel
(&ge; 5.0.1), rstan (&ge; 2.26.0), StanHeaders (&ge; 2.26.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-26 20:22:27 UTC; virgile</td>
</tr>
<tr>
<td>Author:</td>
<td>Virgile Baudrot [aut, cre],
  Sandrine Charles [aut],
  Ophélia Gestin [ctb],
  Miléna Kaag [aut],
  Christelle Lopes [ctb],
  Gauthier Multari [ctb],
  Alain Pavé [ctb],
  Aude Ratier [aut],
  Aurélie Siberchicot [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Virgile Baudrot &lt;virgile.baudrot@qonfluens.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-27 01:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rbioacc-package'>The 'rbioacc' package.</h2><span id='topic+rbioacc-package'></span><span id='topic+rbioacc'></span>

<h3>Description</h3>

<p>A DESCRIPTION OF THE PACKAGE
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Virgile Baudrot <a href="mailto:virgile.baudrot@qonfluens.com">virgile.baudrot@qonfluens.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Sandrine Charles
</p>
</li>
<li><p> Miléna Kaag
</p>
</li>
<li><p> Aude Ratier
</p>
</li>
<li><p> Aurélie Siberchicot
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Ophélia Gestin [contributor]
</p>
</li>
<li><p> Christelle Lopes [contributor]
</p>
</li>
<li><p> Gauthier Multari [contributor]
</p>
</li>
<li><p> Alain Pavé [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>Stan Development Team (NA). RStan: the R interface to Stan. R package version NA. https://mc-stan.org
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://gitlab.in2p3.fr/mosaic-software/rbioacc">https://gitlab.in2p3.fr/mosaic-software/rbioacc</a>
</p>
</li>
<li><p> Report bugs at <a href="https://gitlab.in2p3.fr/mosaic-software/rbioacc/-/issues">https://gitlab.in2p3.fr/mosaic-software/rbioacc/-/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.fonte'>A simple implementation of to pivot_longer of tidyr</h2><span id='topic+.fonte'></span>

<h3>Description</h3>

<p>A simple implementation of to pivot_longer of tidyr
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.fonte(df, names_to, values_to)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".fonte_+3A_df">df</code></td>
<td>
<p>A data frame to pivot.</p>
</td></tr>
<tr><td><code id=".fonte_+3A_names_to">names_to</code></td>
<td>
<p>A string specifying the name of the column to create from
the data stored in the column names of <code>df</code>.</p>
</td></tr>
<tr><td><code id=".fonte_+3A_values_to">values_to</code></td>
<td>
<p>A string specifying the name of the column to create from
the data stored in cell values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The data frame with a &quot;lengthens&quot; shape: more rows, less columns
</p>

<hr>
<h2 id='.index_col_exposure'>Return column matching &quot;expw&quot;, &quot;exps&quot;, &quot;expf&quot;, &quot;exppw&quot; of a <code>data.frame</code></h2><span id='topic+.index_col_exposure'></span>

<h3>Description</h3>

<p>Return column matching &quot;expw&quot;, &quot;exps&quot;, &quot;expf&quot;, &quot;exppw&quot; of a <code>data.frame</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.index_col_exposure(data_frame)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".index_col_exposure_+3A_data_frame">data_frame</code></td>
<td>
<p>a dataframe</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numeric
</p>

<hr>
<h2 id='.index_col_metabolite'>Return column matching &quot;concX&quot; of a <code>data.frame</code> where X is metabolite</h2><span id='topic+.index_col_metabolite'></span>

<h3>Description</h3>

<p>Return column matching &quot;concX&quot; of a <code>data.frame</code> where X is metabolite
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.index_col_metabolite(data_frame)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".index_col_metabolite_+3A_data_frame">data_frame</code></td>
<td>
<p>a dataframe</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numeric
</p>

<hr>
<h2 id='.is_equal_rmInf'>Check if two vectors <code>x</code> and <code>y</code> are equal after remove <code>Inf</code></h2><span id='topic+.is_equal_rmInf'></span>

<h3>Description</h3>

<p>Check if two vectors <code>x</code> and <code>y</code> are equal after remove <code>Inf</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.is_equal_rmInf(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".is_equal_rmInf_+3A_x">x</code></td>
<td>
<p>A vector</p>
</td></tr>
<tr><td><code id=".is_equal_rmInf_+3A_y">y</code></td>
<td>
<p>A vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value
</p>

<hr>
<h2 id='bioacc_metric'>Biaccumulation metrics</h2><span id='topic+bioacc_metric'></span><span id='topic+bioacc_metric.fitTK'></span>

<h3>Description</h3>

<p>Biaccumulation metrics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bioacc_metric(fit, ...)

## S3 method for class 'fitTK'
bioacc_metric(fit, type = "k", route = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bioacc_metric_+3A_fit">fit</code></td>
<td>
<p>An <code>stanFit</code> object</p>
</td></tr>
<tr><td><code id="bioacc_metric_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="bioacc_metric_+3A_type">type</code></td>
<td>
<p>A string with the type of metric: <code>k</code> for the kinetics
BioConcentration Factor, <code>ss</code> for the steady state BioConcentration Factor.</p>
</td></tr>
<tr><td><code id="bioacc_metric_+3A_route">route</code></td>
<td>
<p>Provide exposure route: <code>all</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame
</p>

<hr>
<h2 id='Chiro_Creuzot'>Data on Chironomus with several exposure routes.</h2><span id='topic+Chiro_Creuzot'></span>

<h3>Description</h3>

<p>Data on Chironomus with several exposure routes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Chiro_Creuzot)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 24 observations on the following four variables:
</p>

<dl>
<dt><code>time</code></dt><dd><p>A vector of class <code>numeric</code> with the time points in
days.</p>
</dd>
<dt><code>expw</code></dt><dd><p>A vector of class <code>numeric</code> with the exposure
in water.</p>
</dd>
<dt><code>expw</code></dt><dd><p>A vector of class <code>numeric</code> with the exposure
in pore water.</p>
</dd>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>integer</code> for replicate
identification.</p>
</dd>
<dt><code>conc</code></dt><dd><p>A vector of class <code>numeric</code> with concentration
in organism.</p>
</dd>
<dt><code>concm1</code></dt><dd><p>A vector of class <code>numeric</code> with metabolite
concentration in organism.</p>
</dd>
<dt><code>concm2</code></dt><dd><p>A vector of class <code>numeric</code> with metabolite
concentration in organism.</p>
</dd>
</dl>


<hr>
<h2 id='Chironomus_benzoapyrene'>Data on Chironomus exposed to benzoapyrene</h2><span id='topic+Chironomus_benzoapyrene'></span>

<h3>Description</h3>

<p>Data on Chironomus exposed to benzoapyrene
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Chironomus_benzoapyrene)
</code></pre>

<hr>
<h2 id='corrMatrix'>Correlations between parameters: colored matrix</h2><span id='topic+corrMatrix'></span>

<h3>Description</h3>

<p>Correlations between parameters: colored matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corrMatrix(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corrMatrix_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>fitTK</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A heatmap of class <code>ggplot</code>.
</p>

<hr>
<h2 id='corrPlot'>Correlations between parameters: pairs plot</h2><span id='topic+corrPlot'></span>

<h3>Description</h3>

<p>Correlations between parameters: pairs plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corrPlot(fit, plots = c("all", "deterministic", "stochastic"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corrPlot_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>fitTK</code></p>
</td></tr>
<tr><td><code id="corrPlot_+3A_plots">plots</code></td>
<td>
<p>A string selecting the parameters. Defaults is <code>"all"</code> and select all parameters.
Deterministc parameters can be selected by setting <code>"deterministic"</code> and
stochastic parameter with <code>"stochastic"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pairsplot of class <code>ggmatrix</code> containing planes of parameter pairs (lower triangle), marginal posterior distribution of each parameter (diagonal) and Pearson correlation coefficients (upper triangle)
</p>

<hr>
<h2 id='df_ppc'>PPC data.frame</h2><span id='topic+df_ppc'></span><span id='topic+df_ppc.fitTK'></span><span id='topic+ppc'></span><span id='topic+ppc.fitTK'></span>

<h3>Description</h3>

<p>This is the generic <code>ppc</code> S3 method for plots of the predicted
values along with 95\
versus the observed values for <code>fitTK</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_ppc(fit, ...)

## S3 method for class 'fitTK'
df_ppc(fit, ...)

ppc(fit, ...)

## S3 method for class 'fitTK'
ppc(fit, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_ppc_+3A_fit">fit</code></td>
<td>
<p>And object returned by fitTK</p>
</td></tr>
<tr><td><code id="df_ppc_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The black points show the observed number of survivors (pooled
replicates, on <code class="reqn">X</code>-axis) against the corresponding predicted
number (<code class="reqn">Y</code>-axis). Predictions come along with 95\
intervals, which are depicted in green when they contain the
observed value and in red otherwise. Samples with equal observed
value are shifted on the <code class="reqn">X</code>-axis. For that reason, the
bisecting line (y = x), is represented by steps when observed
values are low. That way we ensure green intervals do intersect the
bisecting line.
</p>


<h3>Value</h3>

<p>A data frame with median and 95\
</p>
<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='df_PriorPost'>Data frame of Posterior over Prior</h2><span id='topic+df_PriorPost'></span><span id='topic+df_PriorPost.fitTK'></span>

<h3>Description</h3>

<p>Data frame of Posterior over Prior
</p>
<p>Data frame of Posterior over Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_PriorPost(fit, ...)

## S3 method for class 'fitTK'
df_PriorPost(fit, select = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_PriorPost_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>fitTK</code> returned by the function <code>fitTK()</code>.</p>
</td></tr>
<tr><td><code id="df_PriorPost_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
<tr><td><code id="df_PriorPost_+3A_select">select</code></td>
<td>
<p>A string selecting the parameters. Defaults is <code>"all"</code> and
select all parameters.Deterministc parameters can be selected by setting
<code>"deterministic"</code> and stochastic parameter with <code>"stochastic"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>data.frame</code>
</p>

<hr>
<h2 id='equations'>Equations of the mathematical model used for the fit</h2><span id='topic+equations'></span>

<h3>Description</h3>

<p>Equations of the mathematical model used for the fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>equations(fit, object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="equations_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>fitTK</code></p>
</td></tr>
<tr><td><code id="equations_+3A_object">object</code></td>
<td>
<p>The data.frame used as the base as the fit object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of strings each containing an equation
</p>

<hr>
<h2 id='exposure_names'>Retrieve exposure routes names from object</h2><span id='topic+exposure_names'></span>

<h3>Description</h3>

<p>Retrieve exposure routes names from object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exposure_names(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exposure_names_+3A_object">object</code></td>
<td>
<p>a data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of string
</p>

<hr>
<h2 id='Exposure_Sialis_lutaria'>Data on Sialis lutaria exposure time series</h2><span id='topic+Exposure_Sialis_lutaria'></span>

<h3>Description</h3>

<p>Data on Sialis lutaria exposure time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Exposure_Sialis_lutaria)
</code></pre>

<hr>
<h2 id='fitTK'>Posterior predictive check</h2><span id='topic+fitTK'></span><span id='topic+fitTK.stanTKdataCST'></span><span id='topic+fitTK.stanTKdataVAR'></span>

<h3>Description</h3>

<p>Posterior predictive check
</p>
<p>Bayesian inference of TK model with Stan
</p>
<p>Bayesian inference of TK model with variable exposure profile (BETA version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitTK(stanTKdata, ...)

## S3 method for class 'stanTKdataCST'
fitTK(stanTKdata, ...)

## S3 method for class 'stanTKdataVAR'
fitTK(stanTKdata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitTK_+3A_stantkdata">stanTKdata</code></td>
<td>
<p>List of Data require for computing</p>
</td></tr>
<tr><td><code id="fitTK_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>rstan::sampling</code> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>fitTK</code> containing two object: <code>stanTKdata</code>
the data set used for inference and <code>stanfit</code>  returned by <code>rstan::sampling</code>
</p>

<hr>
<h2 id='Gammarus_azoxistrobine_1d_Rosch2017'>Data on Gammarus exposed to azoxistrobine</h2><span id='topic+Gammarus_azoxistrobine_1d_Rosch2017'></span>

<h3>Description</h3>

<p>Data on Gammarus exposed to azoxistrobine
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Gammarus_azoxistrobine_1d_Rosch2017)
</code></pre>

<hr>
<h2 id='Internal_Sialis_lutaria'>Data on Sialis lutaria internal time series</h2><span id='topic+Internal_Sialis_lutaria'></span>

<h3>Description</h3>

<p>Data on Sialis lutaria internal time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Internal_Sialis_lutaria)
</code></pre>

<hr>
<h2 id='Male_Gammarus_Merged'>Male <code>Gammarus fossarum</code> exposed to Hg spiked water.
Three exposure concentrations were tested in triplicates. The duration of the
accumulation phase is 4 days for 0.0000708021 and 0.000283208
<code class="reqn">\mu g.m L^{-1}</code> exposure concentrations, and 7 days for 0.000141604
<code class="reqn">\mu g.m L^{-1}</code> exposure concentration.</h2><span id='topic+Male_Gammarus_Merged'></span>

<h3>Description</h3>

<p>Male <code>Gammarus fossarum</code> exposed to Hg spiked water.
Three exposure concentrations were tested in triplicates. The duration of the
accumulation phase is 4 days for 0.0000708021 and 0.000283208
<code class="reqn">\mu g.m L^{-1}</code> exposure concentrations, and 7 days for 0.000141604
<code class="reqn">\mu g.m L^{-1}</code> exposure concentration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Male_Gammarus_Merged)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 72 observations on the following four variables:
</p>

<dl>
<dt><code>time</code></dt><dd><p>A vector of class <code>numeric</code> with the time points in
days.</p>
</dd>
<dt><code>expw</code></dt><dd><p>A vector of class <code>numeric</code> with Hg
exposure in water in <code class="reqn">\mu g.m L^{-1}</code>.</p>
</dd>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>integer</code> for replicate
identification.</p>
</dd>
<dt><code>conc</code></dt><dd><p>A vector of class <code>numeric</code> with Hg concentration
in organism in <code class="reqn">\mu g.m L^{-1}</code>.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ciccia, T. (2019). Accumulation et devenir du mercure chez
l'espèce sentinelle Gammarus fossarum : de l'expérimentation au développement
d'un modèle toxicocinétique multi-compartiments.
Rapport de stage de Master 2, INRAE.
</p>

<hr>
<h2 id='Male_Gammarus_seanine_growth'>Male <code>Gammarus pulex</code> exposed to seanine spiked water. A single exposure
concentration was tested. The duration of the accumulation phase is 1.417
days. Three metabolites were quantified. The growth of organism was included.</h2><span id='topic+Male_Gammarus_seanine_growth'></span>

<h3>Description</h3>

<p>Male <code>Gammarus pulex</code> exposed to seanine spiked water. A single exposure
concentration was tested. The duration of the accumulation phase is 1.417
days. Three metabolites were quantified. The growth of organism was included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Male_Gammarus_seanine_growth)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 22 observations on the following four variables:
</p>

<dl>
<dt><code>time</code></dt><dd><p>A vector of class <code>numeric</code> with the time points in
days.</p>
</dd>
<dt><code>expw</code></dt><dd><p>A vector of class <code>numeric</code> with seanine
exposure in water in <code class="reqn">\mu g.m L^{-1}</code>.</p>
</dd>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>integer</code> for replicate
identification.</p>
</dd>
<dt><code>conc</code></dt><dd><p>A vector of class <code>numeric</code> with concentration
in organism.</p>
</dd>
<dt><code>concm1</code></dt><dd><p>A vector of class <code>numeric</code> with metabolite
concentration in organism.</p>
</dd>
<dt><code>concm2</code></dt><dd><p>A vector of class <code>numeric</code> with metabolite
concentration in organism.</p>
</dd>
<dt><code>concm3</code></dt><dd><p>A vector of class <code>numeric</code> with metabolite
concentration in organism.</p>
</dd>
<dt><code>growth</code></dt><dd><p>A vector of class <code>numeric</code> with growth of the
organism.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ashauer, R. et al. (2012). Significance of xenobiotic metabolism
for bioaccumulation kinetics of organic chemicals in Gammarus pulex.
Environmental Science Technology, 46: 3498-3508.
</p>

<hr>
<h2 id='Male_Gammarus_Single'>Bio-accumulation data set for <em>Gammarus fossarum</em> exposed to Hg spiked water.</h2><span id='topic+Male_Gammarus_Single'></span>

<h3>Description</h3>

<p>Male <em>Gammarus fossarum</em> exposed to Hg spiked water.
A single exposure concentration was tested. The duration of the accumulation
phase is 4 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Male_Gammarus_Single)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 23 observations on the following four variables:
</p>

<dl>
<dt><code>time</code></dt><dd><p>A vector of class <code>numeric</code> with the time points in
days.</p>
</dd>
<dt><code>expw</code></dt><dd><p>A vector of class <code>numeric</code> with Hg
exposure in water in <code class="reqn">\mu g.m L^{-1}</code>.</p>
</dd>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>integer</code> for replicate
identification.</p>
</dd>
<dt><code>conc</code></dt><dd><p>A vector of class <code>numeric</code> with Hg concentration
in organism in <code class="reqn">\mu g.m L^{-1}</code>.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ciccia, T. (2019). Accumulation et devenir du mercure chez
l'espèce sentinelle Gammarus fossarum : de l'expérimentation au développement
d'un modèle toxicocinétique multi-compartiments.
Rapport de stage de Master 2, INRAE.
</p>

<hr>
<h2 id='mcmcTraces'>Traces of MCMC iterations</h2><span id='topic+mcmcTraces'></span>

<h3>Description</h3>

<p>Traces of MCMC iterations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmcTraces(fit, plots = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmcTraces_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>fitTK</code></p>
</td></tr>
<tr><td><code id="mcmcTraces_+3A_plots">plots</code></td>
<td>
<p>A string selecting the parameters. Defaults is <code>"all"</code> and select all parameters.
Deterministc parameters can be selected by setting <code>"deterministic"</code> and
stochastic parameter with <code>"stochastic"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A traceplot of class <code>ggplot</code>.
</p>

<hr>
<h2 id='modelData'>Create a list giving data and parameters to use in the model inference.</h2><span id='topic+modelData'></span><span id='topic+modelData.data.frame'></span>

<h3>Description</h3>

<p>Create a list giving data and parameters to use in the model inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelData(object, ...)

## S3 method for class 'data.frame'
modelData(object, time_accumulation, elimination_rate = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelData_+3A_object">object</code></td>
<td>
<p>An object of class <code>data.frame</code></p>
</td></tr>
<tr><td><code id="modelData_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="modelData_+3A_time_accumulation">time_accumulation</code></td>
<td>
<p>A scalar givin accumulation time</p>
</td></tr>
<tr><td><code id="modelData_+3A_elimination_rate">elimination_rate</code></td>
<td>
<p>A scalar for the elimination rate. Default is <code>NA</code>.
To remove elimination rate, set <code>elimination_rate = 0</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with data and parameters require for model inference.
</p>

<hr>
<h2 id='modelData_ode'>Create a list giving data and parameters to use in the model inference.</h2><span id='topic+modelData_ode'></span>

<h3>Description</h3>

<p>Create a list giving data and parameters to use in the model inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelData_ode(
  df_exposure,
  df_internal,
  y0 = 1,
  t0 = -0.001,
  unifMax = 10,
  time_accumulation = NULL,
  minK = -5,
  maxK = 5,
  ...
)

modelData_ode(
  df_exposure,
  df_internal,
  y0 = 1,
  t0 = -0.001,
  unifMax = 10,
  time_accumulation = NULL,
  minK = -5,
  maxK = 5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelData_ode_+3A_df_exposure">df_exposure</code></td>
<td>
<p>Dataframe of exposure with 2 column (<code>time</code> and <code>value</code>)</p>
</td></tr>
<tr><td><code id="modelData_ode_+3A_df_internal">df_internal</code></td>
<td>
<p>Dataframe of internal concentration with 2 column (<code>time</code> and <code>value</code>)</p>
</td></tr>
<tr><td><code id="modelData_ode_+3A_y0">y0</code></td>
<td>
<p>Initial concentration</p>
</td></tr>
<tr><td><code id="modelData_ode_+3A_t0">t0</code></td>
<td>
<p>initial time point</p>
</td></tr>
<tr><td><code id="modelData_ode_+3A_unifmax">unifMax</code></td>
<td>
<p>Hyperparameter value</p>
</td></tr>
<tr><td><code id="modelData_ode_+3A_time_accumulation">time_accumulation</code></td>
<td>
<p>Time of accumulation</p>
</td></tr>
<tr><td><code id="modelData_ode_+3A_mink">minK</code></td>
<td>
<p>Hyperparameter value</p>
</td></tr>
<tr><td><code id="modelData_ode_+3A_maxk">maxK</code></td>
<td>
<p>Hyperparameter value</p>
</td></tr>
<tr><td><code id="modelData_ode_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with data and parameters require for model inference.
</p>

<hr>
<h2 id='Oncorhynchus_two'>Data on Oncorhynchus exposition</h2><span id='topic+Oncorhynchus_two'></span>

<h3>Description</h3>

<p>Data on Oncorhynchus exposition
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Oncorhynchus_two)
</code></pre>

<hr>
<h2 id='plot_exposure'>Plot exposure profile</h2><span id='topic+plot_exposure'></span>

<h3>Description</h3>

<p>Plot exposure profile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_exposure(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_exposure_+3A_object">object</code></td>
<td>
<p>a data frame with exposure column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plot_PriorPost'>Plot Posterior over Prior</h2><span id='topic+plot_PriorPost'></span><span id='topic+plot_PriorPost.fitTK'></span><span id='topic+plot_PriorPost.df_PP'></span>

<h3>Description</h3>

<p>Plot Posterior over Prior
</p>
<p>Plot Posterior over Prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_PriorPost(x, ...)

## S3 method for class 'fitTK'
plot_PriorPost(x, select = "all", ...)

## S3 method for class 'df_PP'
plot_PriorPost(x, select = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_PriorPost_+3A_x">x</code></td>
<td>
<p>A data.frame of class <code>df_PP</code> returned by the function <code>df_PriorPost()</code>.</p>
</td></tr>
<tr><td><code id="plot_PriorPost_+3A_...">...</code></td>
<td>
<p>addition arguments</p>
</td></tr>
<tr><td><code id="plot_PriorPost_+3A_select">select</code></td>
<td>
<p>A string selecting the parameters. Defaults is <code>"all"</code> and select all parameters.
Deterministic parameters can be selected by setting <code>"deterministic"</code> and
stochastic parameter with <code>"stochastic"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of class <code>ggplot</code>.
</p>
<p>A plot of class <code>ggplot</code>.
</p>

<hr>
<h2 id='plot.bioaccMetric'>Plot function for object of class <code>bioaccMetric</code></h2><span id='topic+plot.bioaccMetric'></span>

<h3>Description</h3>

<p>Plot function for object of class <code>bioaccMetric</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bioaccMetric'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.bioaccMetric_+3A_x">x</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="plot.bioaccMetric_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plot.fitTK'>Plotting method for <code>fitTK</code> objects</h2><span id='topic+plot.fitTK'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the
<code>fitTK</code>.  It plots the fit obtained for each
variable in the original dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitTK'
plot(x, time_interp = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fitTK_+3A_x">x</code></td>
<td>
<p>And object returned by fitTK</p>
</td></tr>
<tr><td><code id="plot.fitTK_+3A_time_interp">time_interp</code></td>
<td>
<p>A vector with additional time point to interpolate.
Time point of the original data set are conserved.</p>
</td></tr>
<tr><td><code id="plot.fitTK_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plot.predictTK'>Plotting method for <code>predictTK</code> objects</h2><span id='topic+plot.predictTK'></span><span id='topic+plot.predictTKstan'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the
<code>predictTK</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predictTK'
plot(x, ...)

## S3 method for class 'predictTKstan'
plot(x, add_data = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.predictTK_+3A_x">x</code></td>
<td>
<p>An object of class <code>predictTK</code> returned by predict</p>
</td></tr>
<tr><td><code id="plot.predictTK_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
<tr><td><code id="plot.predictTK_+3A_add_data">add_data</code></td>
<td>
<p>logical TRUE or FALSE to add the orignal data of the fit object
<code>x</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='predict.fitTK'>Prediction function using <code>fitTK</code> object</h2><span id='topic+predict.fitTK'></span><span id='topic+predict_stan'></span><span id='topic+predict_manual'></span>

<h3>Description</h3>

<p>Use when parameter are manually given by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitTK'
predict(object, data, mcmc_size = NULL, fixed_init = TRUE, ...)

predict_stan(
  object,
  data,
  mcmc_size = NULL,
  fixed_init = TRUE,
  time_interp = NULL,
  iter = 1000,
  ...
)

predict_manual(
  param,
  data,
  time_accumulation = NULL,
  C0 = 0,
  G0 = NA,
  gmax = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.fitTK_+3A_object">object</code></td>
<td>
<p>An object of <code>stanfit</code></p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_data">data</code></td>
<td>
<p>A data set with one column <code>time</code> and 1 to 4 exposure</p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_mcmc_size">mcmc_size</code></td>
<td>
<p>Size of mcmc chain if needed to be reduced</p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_fixed_init">fixed_init</code></td>
<td>
<p>If <code>TRUE</code> fix the initial conditions of internal concentration.
columns with name in <code>expw</code>, <code>exps</code>, <code>expf</code> and <code>exppw</code></p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_time_interp">time_interp</code></td>
<td>
<p>A vector with additional time point to interpolate.
Time point of the original data set are conserved.</p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_iter">iter</code></td>
<td>
<p>Number of time steps</p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_param">param</code></td>
<td>
<p>A dataframe with name of parameters <code>kee</code>, <code>keg</code>, <code>ku1</code>,
<code>ku2</code>, ...,  <code>km1</code>, <code>km2</code>, ... and <code>kem1</code>, <code>kem2</code>, ...,
<code>sigmaConc</code>, <code>sigmaCmet</code> (if metabolites) and <code>sigmaGrowth</code> (if growth).
The parameter <code>kee</code> is mandatory.</p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_time_accumulation">time_accumulation</code></td>
<td>
<p>the time of accumulation.</p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_c0">C0</code></td>
<td>
<p>Gives the initial conditions of internal concentration.</p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_g0">G0</code></td>
<td>
<p>initial condition of G0 (require if <code>keg</code> is provided)</p>
</td></tr>
<tr><td><code id="predict.fitTK_+3A_gmax">gmax</code></td>
<td>
<p>gmax (require if <code>keg</code> is provided)
columns with name in <code>expw</code>, <code>exps</code>, <code>expf</code> and <code>exppw</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>predictTK</code>
</p>
<p>An object of class <code>predictTK</code>
</p>

<hr>
<h2 id='psrf'>Potential Scale Reduction Factors (PSRF) of the parameters</h2><span id='topic+psrf'></span>

<h3>Description</h3>

<p>Potential Scale Reduction Factors (PSRF) of the parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psrf(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psrf_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>fitTK</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>data.frame</code> with two columns: PSRF and parameter
</p>
<p>a data frame with Potential Scale Reduction Factors
</p>

<hr>
<h2 id='quantile_table'>Quantiles of parameters</h2><span id='topic+quantile_table'></span>

<h3>Description</h3>

<p>Quantiles of parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantile_table(fit, probs = c(0.025, 0.5, 0.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile_table_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>fitTK</code></p>
</td></tr>
<tr><td><code id="quantile_table_+3A_probs">probs</code></td>
<td>
<p>Scalar or Vector of quantiles.
Default is 0.025, 0.5 and 0.975 giving median and 95% credible interval</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with quantiles
</p>

<hr>
<h2 id='replace_'>Replace element of a vector</h2><span id='topic+replace_'></span>

<h3>Description</h3>

<p>Replace element of a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_(x, from, to)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace__+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="replace__+3A_from">from</code></td>
<td>
<p>a vector of elements to replace</p>
</td></tr>
<tr><td><code id="replace__+3A_to">to</code></td>
<td>
<p>a vector with replacing elements</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
replace_(1:10,c(2,4,5,8), c(0,0,0,0))
replace_(c(1,2,2,3,2),c(3,2), c(4,5))


</code></pre>

<hr>
<h2 id='t95'>Return the time at 95% depuration of the parent component</h2><span id='topic+t95'></span>

<h3>Description</h3>

<p>Return the time at 95% depuration of the parent component
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t95(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t95_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>fitTK</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric object
</p>

<hr>
<h2 id='waic'>Widely Applicable Information Criterion (WAIC)</h2><span id='topic+waic'></span>

<h3>Description</h3>

<p>Compute WAIC using the <code>waic()</code> method of the loo package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>waic(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="waic_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>fitTK</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric containing the WAIC
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
