<!DOCTYPE html><html><head><title>Help for package logspline</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {logspline}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dlogspline'><p>Logspline Density Estimation</p></a></li>
<li><a href='#doldlogspline'><p>Logspline Density Estimation - 1992 version</p></a></li>
<li><a href='#logspline'><p> Logspline Density Estimation</p></a></li>
<li><a href='#logspline-internal'><p>Internal logspline functions</p></a></li>
<li><a href='#oldlogspline'><p> Logspline Density Estimation - 1992 version</p></a></li>
<li><a href='#oldlogspline.to.logspline'><p>Logspline Density Estimation - 1992 to 1997 version</p></a></li>
<li><a href='#plot.logspline'><p>Logspline Density Estimation</p></a></li>
<li><a href='#plot.oldlogspline'><p>Logspline Density Estimation - 1992 version</p></a></li>
<li><a href='#summary.logspline'><p>Logspline Density Estimation</p></a></li>
<li><a href='#summary.oldlogspline'><p> Logspline Density Estimation - 1992 version</p></a></li>
<li><a href='#unstrip'><p>Reformat data as vector or matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.1.21</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-26</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Charles Kooperberg &lt;clk@fredhutch.org&gt;</td>
</tr>
<tr>
<td>Title:</td>
<td>Routines for Logspline Density Estimation</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains routines for logspline density estimation.
	The function oldlogspline() uses the same algorithm as the logspline package
	version 1.0.x; i.e. the Kooperberg and Stone (1992) 
	algorithm (with an improved interface).  The recommended routine logspline()
	uses an algorithm from Stone et al (1997)  &lt;<a href="https://doi.org/10.1214%2Faos%2F1031594728">doi:10.1214/aos/1031594728</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Charles Kooperberg [aut, cre],
  Cleve Moler [ctb] (LINPACK routines in src),
  Jack Dongarra [ctb] (LINPACK routines in src)</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-26 19:04:54 UTC; clk</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-26 20:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='dlogspline'>Logspline Density Estimation</h2><span id='topic+dlogspline'></span><span id='topic+plogspline'></span><span id='topic+qlogspline'></span><span id='topic+rlogspline'></span>

<h3>Description</h3>

<p>Density (<code>dlogspline</code>), cumulative probability (<code>plogspline</code>), quantiles
(<code>qlogspline</code>), and  random samples (<code>rlogspline</code>) from 
a logspline density that was fitted using
the 1997 knot addition and deletion algorithm (<code><a href="#topic+logspline">logspline</a></code>). 
The 1992 algorithm is available using the <code><a href="#topic+oldlogspline">oldlogspline</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlogspline(q, fit, log = FALSE) 
plogspline(q, fit) 
qlogspline(p, fit) 
rlogspline(n, fit) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dlogspline_+3A_q">q</code></td>
<td>

<p>vector of quantiles. Missing values (NAs) are allowed. 
</p>
</td></tr>
<tr><td><code id="dlogspline_+3A_p">p</code></td>
<td>

<p>vector of probabilities. Missing values (NAs) are allowed. 
</p>
</td></tr>
<tr><td><code id="dlogspline_+3A_n">n</code></td>
<td>

<p>sample size. If <code>length(n)</code> is larger than 1, then 
<code>length(n)</code> random values are returned.
</p>
</td></tr>
<tr><td><code id="dlogspline_+3A_fit">fit</code></td>
<td>

<p><code>logspline</code> object, typically the result of <code><a href="#topic+logspline">logspline</a></code>.
</p>
</td></tr>
<tr><td><code id="dlogspline_+3A_log">log</code></td>
<td>

<p>should dlogspline return densities (TRUE) or log-densities (FALSE)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Elements of <code>q</code> or <code>p</code> that are missing will cause the 
corresponding elements of the result to be missing. 
</p>


<h3>Value</h3>

<p>Densities (<code>dlogspline</code>), probabilities (<code>plogspline</code>), quantiles (<code>qlogspline</code>), 
or a random sample (<code>rlogspline</code>) from a <code>logspline</code> density that was fitted using
knot addition and deletion.
</p>


<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg and Charles J. Stone.  Logspline density estimation
for censored data (1992). <em>Journal of Computational and Graphical
Statistics</em>, <b>1</b>, 301&ndash;328.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong. 
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+logspline">logspline</a></code>,      
<code><a href="#topic+plot.logspline">plot.logspline</a></code>,
<code><a href="#topic+summary.logspline">summary.logspline</a></code>,
<code><a href="#topic+oldlogspline">oldlogspline</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
fit &lt;- logspline(x)
qq &lt;- qlogspline((1:99)/100, fit)
plot(qnorm((1:99)/100), qq)                  # qq plot of the fitted density
pp &lt;- plogspline((-250:250)/100, fit)
plot((-250:250)/100, pp, type = "l")
lines((-250:250)/100,pnorm((-250:250)/100))  # asses the fit of the distribution
dd &lt;- dlogspline((-250:250)/100, fit)
plot((-250:250)/100, dd, type = "l")
lines((-250:250)/100, dnorm((-250:250)/100)) # asses the fit of the density
rr &lt;- rlogspline(100, fit)                   # random sample from fit
</code></pre>

<hr>
<h2 id='doldlogspline'>Logspline Density Estimation - 1992 version </h2><span id='topic+doldlogspline'></span><span id='topic+poldlogspline'></span><span id='topic+qoldlogspline'></span><span id='topic+roldlogspline'></span>

<h3>Description</h3>

<p>Probability density function (<code>doldlogspline</code>), distribution
function (<code>poldlogspline</code>), quantiles 
(<code>qoldlogspline</code>), and  random samples (<code>roldlogspline</code>) from
a logspline density that was fitted using
the 1992 knot deletion algorithm (<code><a href="#topic+oldlogspline">oldlogspline</a></code>). 
The 1997 algorithm using knot
deletion and addition is available using the <code><a href="#topic+logspline">logspline</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doldlogspline(q, fit) 
poldlogspline(q, fit) 
qoldlogspline(p, fit) 
roldlogspline(n, fit) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="doldlogspline_+3A_q">q</code></td>
<td>

<p>vector of quantiles. Missing values (NAs) are allowed. 
</p>
</td></tr>
<tr><td><code id="doldlogspline_+3A_p">p</code></td>
<td>

<p>vector of probabilities. Missing values (NAs) are allowed. 
</p>
</td></tr>
<tr><td><code id="doldlogspline_+3A_n">n</code></td>
<td>

<p>sample size. If <code>length(n)</code> is larger than 1, then 
<code>length(n)</code> random values are returned.
</p>
</td></tr>
<tr><td><code id="doldlogspline_+3A_fit">fit</code></td>
<td>

<p><code>oldlogspline</code> object, typically the result of <code><a href="#topic+oldlogspline">oldlogspline</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Elements of  <code>q</code> or <code>p</code> that are missing will cause the 
corresponding elements of the result to be missing. 
</p>


<h3>Value</h3>

<p> Densities (<code>doldlogspline</code>), probabilities (<code>poldlogspline</code>), quantiles (<code>qoldlogspline</code>), 
or a random sample (<code>roldlogspline</code>)
from an <code>oldlogspline</code> density that was fitted using
knot deletion.
</p>


<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg and Charles J. Stone.  Logspline density estimation
for censored data (1992). <em>Journal of Computational and Graphical
Statistics</em>, <b>1</b>, 301&ndash;328.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

<p><code><a href="#topic+logspline">logspline</a></code>,
<code><a href="#topic+oldlogspline">oldlogspline</a></code>,
<code><a href="#topic+plot.oldlogspline">plot.oldlogspline</a></code>,
<code><a href="#topic+summary.oldlogspline">summary.oldlogspline</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
fit &lt;- oldlogspline(x)
qq &lt;- qoldlogspline((1:99)/100, fit)
plot(qnorm((1:99)/100), qq)                  # qq plot of the fitted density
pp &lt;- poldlogspline((-250:250)/100, fit)
plot((-250:250)/100, pp, type = "l")
lines((-250:250)/100, pnorm((-250:250)/100)) # asses the fit of the distribution
dd &lt;- doldlogspline((-250:250)/100, fit)
plot((-250:250)/100, dd, type = "l")
lines((-250:250)/100, dnorm((-250:250)/100)) # asses the fit of the density
rr &lt;- roldlogspline(100, fit)                # random sample from fit
</code></pre>

<hr>
<h2 id='logspline'> Logspline Density Estimation </h2><span id='topic+logspline'></span>

<h3>Description</h3>

<p>Fits a <code>logspline</code> density using splines to approximate the log-density
using 
the 1997 knot addition and deletion algorithm (<code><a href="#topic+logspline">logspline</a></code>). 
The 1992 algorithm is available using the <code><a href="#topic+oldlogspline">oldlogspline</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logspline(x, lbound, ubound, maxknots = 0, knots, nknots = 0, penalty,
silent = TRUE, mind = -1, error.action = 2) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logspline_+3A_x">x</code></td>
<td>
<p> data vector. The data needs to be uncensored. <code><a href="#topic+oldlogspline">oldlogspline</a></code>
can deal with right- left- and interval-censored data.  </p>
</td></tr>
<tr><td><code id="logspline_+3A_lbound">lbound</code>, <code id="logspline_+3A_ubound">ubound</code></td>
<td>

<p>lower/upper bound for the support of the density. For example, if there 
is a priori knowledge that the density equals zero to the left of 0, 
and has a discontinuity at 0, 
the user could specify <code>lbound = 0</code>. However, if the density is  
essentially zero near 0, one does not need to specify <code>lbound</code>. 
</p>
</td></tr>
<tr><td><code id="logspline_+3A_maxknots">maxknots</code></td>
<td>

<p>the maximum number of knots. The routine stops adding knots 
when this number of knots is reached. 
The method has an automatic rule 
for selecting maxknots if this parameter is not specified. 
</p>
</td></tr>
<tr><td><code id="logspline_+3A_knots">knots</code></td>
<td>

<p>ordered vector of values (that should cover the complete range of the 
observations), which forces the method to start with these knots. 
Overrules knots.	 
If <code>knots</code> is not specified, a default knot-placement rule is employed. 
</p>
</td></tr>
<tr><td><code id="logspline_+3A_nknots">nknots</code></td>
<td>

<p>forces the method to start with <code>nknots</code> knots. 
The method has an automatic rule 
for selecting <code>nknots</code> if this parameter is not specified. 
</p>
</td></tr>
<tr><td><code id="logspline_+3A_penalty">penalty</code></td>
<td>

<p>the parameter to be used in the AIC criterion. The method chooses 
the number of knots that minimizes
<code>-2 * loglikelihood + penalty * (number of knots - 1)</code>. 
The default 
is to use a penalty parameter of <code>penalty = log(samplesize)</code> as in BIC. The effect of 
this parameter is summarized in <code><a href="#topic+summary.logspline">summary.logspline</a></code>. 
</p>
</td></tr>
<tr><td><code id="logspline_+3A_silent">silent</code></td>
<td>

<p>should diagnostic output be printed? 
</p>
</td></tr>
<tr><td><code id="logspline_+3A_mind">mind</code></td>
<td>

<p>minimum distance, in order statistics, between knots. 
</p>
</td></tr>
<tr><td><code id="logspline_+3A_error.action">error.action</code></td>
<td>
<p>how should <code>logspline</code> deal with non-convergence problems? Very-very rarely
in some extreme situations
<code>logspline</code> has convergence problems. The only two situations that I am aware of are when
there is effectively a sharp bound, but this bound was not specified, or when the data is severly
rounded. <code>logspline</code> can deal with this in three ways. If <code>error.action</code> is 2, the same
data is rerun with the slightly more stable, but less flexible <code>oldlogspline</code>. The object is translated
in a <code>logspline</code> object using <code>oldlogspline.to.logspline</code>, so this is almost
invisible to the user. It is particularly useful when you run simulation studies, as he code can
seemlessly continue. Only the <code>lbound</code> and <code>ubound</code> options are passed on to
<code>oldlogspline</code>, other options revert to the default. If <code>error.action</code> is 1, a warning is printed,
and <code>logspline</code> returns nothing (but does not crash). This is useful if you run a
simulation, but do not like to revert to <code>oldlogspline</code>. If <code>error.action</code> is 0, the
code crashes using the <code>stop</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of the class <code>logspline</code>, that is intended as input for
<code><a href="#topic+plot.logspline">plot.logspline</a></code> (summary plots), 
<code><a href="#topic+summary.logspline">summary.logspline</a></code> (fitting summary), 
<code><a href="#topic+dlogspline">dlogspline</a></code> (densities), 
<code><a href="#topic+plogspline">plogspline</a></code> (probabilities),
<code><a href="#topic+qlogspline">qlogspline</a></code> (quantiles),
<code><a href="#topic+rlogspline">rlogspline</a></code> (random numbers from the fitted distribution).
</p>
<p>The object has the following members: 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the command that was executed.</p>
</td></tr>
<tr><td><code>nknots</code></td>
<td>
<p>the number of knots in the model that was selected.</p>
</td></tr>
<tr><td><code>coef.pol</code></td>
<td>
<p>coefficients of the polynomial part of the spline.
The first coefficient is the constant term and
the second is the linear term.</p>
</td></tr>
<tr><td><code>coef.kts</code></td>
<td>
<p>coefficients of the knots  part of the spline.
The <code>k</code>-th element is the coefficient 
of <code class="reqn">(x-t(k))^3_+</code> (where <code class="reqn">x^3_+</code> means the positive part of the third power
of <code class="reqn">x</code>, 
and <code class="reqn">t(k)</code> means knot <code>k</code>).</p>
</td></tr>
<tr><td><code>knots</code></td>
<td>
<p>vector of the locations of the knots in the <code>logspline</code> model.</p>
</td></tr>
<tr><td><code>maxknots</code></td>
<td>
<p>the largest number of knots minus one considered during fitting
(i.e. with <code>maxknots = 6</code> the maximum number of knots is 5).</p>
</td></tr>
<tr><td><code>penalty</code></td>
<td>
<p>the penalty that was used.  </p>
</td></tr>
<tr><td><code>bound</code></td>
<td>

<p>first element: 0 - <code>lbound</code> was <code class="reqn">-\inf</code> 1 it was something else; second 
element: <code>lbound</code>, if specified; third element: 0 - <code>ubound</code> was <code class="reqn">\inf</code>, 
1 it was something else; fourth element: <code>ubound</code>, if specified. 
</p>
</td></tr>
<tr><td><code>samples</code></td>
<td>
<p>the sample size.</p>
</td></tr>
<tr><td><code>logl</code></td>
<td>
<p>matrix with 3 columns. Column one: number of knots; column two:
model fitted during addition (1) or deletion (2); column 3: log-likelihood.</p>
</td></tr>
<tr><td><code>range</code></td>
<td>
<p>range of the input data.</p>
</td></tr>
<tr><td><code>mind</code></td>
<td>
<p>minimum distance in order statistics between knots required during fitting
(the actual minimum distance may be much larger).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg and Charles J. Stone.  Logspline density estimation
for censored data (1992). <em>Journal of Computational and Graphical
Statistics</em>, <b>1</b>, 301&ndash;328.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+plot.logspline">plot.logspline</a></code>, 
<code><a href="#topic+summary.logspline">summary.logspline</a></code>,
<code><a href="#topic+dlogspline">dlogspline</a></code>, 
<code><a href="#topic+plogspline">plogspline</a></code>,
<code><a href="#topic+qlogspline">qlogspline</a></code>, <br />
<code><a href="#topic+rlogspline">rlogspline</a></code>,
<code><a href="#topic+oldlogspline">oldlogspline</a>,</code>
<code><a href="#topic+oldlogspline.to.logspline">oldlogspline.to.logspline</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- rnorm(100)
fit &lt;- logspline(y)       
plot(fit)
#
# as (4 == length(-2, -1, 0, 1, 2) -1), this forces these initial knots,
# and does no knot selection
fit &lt;- logspline(y, knots = c(-2, -1, 0, 1, 2), maxknots = 4, penalty = 0)  
#
# the following example give one of the rare examples where logspline
# crashes, and this shows the use of error.action = 2.
#
set.seed(118)
zz &lt;- rnorm(300)
zz[151:300] &lt;- zz[151:300]+5
zz &lt;- round(zz)
fit &lt;- logspline(zz)
#
# you could rerun this with 
# fit &lt;- logspline(zz, error.action=0)
# or
# fit &lt;- logspline(zz, error.action=1)
</code></pre>

<hr>
<h2 id='logspline-internal'>Internal logspline functions</h2><span id='topic+logcensor'></span><span id='topic+nlogcensor'></span><span id='topic+nlogcensorx'></span><span id='topic+pqlsd'></span><span id='topic+rpqlsd'></span>

<h3>Description</h3>

<p>Internal logspline functions</p>


<h3>Details</h3>

<p>These are not intended for use by users.</p>


<h3>Author(s)</h3>

<p>Charles Kooperberg</p>

<hr>
<h2 id='oldlogspline'> Logspline Density Estimation - 1992 version </h2><span id='topic+oldlogspline'></span>

<h3>Description</h3>

<p>Fits a <code>logspline</code> density using splines to approximate the log-density
using 
the 1992 knot deletion algorithm (<code><a href="#topic+oldlogspline">oldlogspline</a></code>). 
The 1997 algorithm using knot
deletion and addition is available using the <code><a href="#topic+logspline">logspline</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oldlogspline(uncensored, right, left, interval, lbound,
ubound, nknots, knots, penalty, delete = TRUE) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oldlogspline_+3A_uncensored">uncensored</code></td>
<td>

<p>vector of uncensored observations from the distribution whose density is 
to be estimated. If there are no uncensored observations, this argument can 
be omitted. However, either <code>uncensored</code> or <code>interval</code> must be specified. 
</p>
</td></tr>
<tr><td><code id="oldlogspline_+3A_right">right</code></td>
<td>

<p>vector of right censored observations from the distribution 
whose density is to be estimated. If there are no right censored 
observations, this argument can be omitted. 
</p>
</td></tr>
<tr><td><code id="oldlogspline_+3A_left">left</code></td>
<td>

<p>vector of left censored observations from the distribution 
whose density is to be estimated. If there are no left censored 
observations, this argument can be omitted. 
</p>
</td></tr>
<tr><td><code id="oldlogspline_+3A_interval">interval</code></td>
<td>

<p>two column matrix of lower and upper bounds of observations 
that are interval censored from the distribution whose density is 
to be estimated. If there are no interval censored observations, this 
argument can be omitted. 
</p>
</td></tr>
<tr><td><code id="oldlogspline_+3A_lbound">lbound</code>, <code id="oldlogspline_+3A_ubound">ubound</code></td>
<td>

<p>lower/upper bound for the support of the density. For example, if there 
is a priori knowledge that the density equals zero to the left of 0, 
and has a discontinuity at 0, 
the user could specify <code>lbound = 0</code>. However, if the density is  
essentially zero near 0, one does not need to specify <code>lbound</code>. The
default for <code>lbound</code> is <code>-inf</code> and the default for
<code>ubound</code> is <code>inf</code>.
</p>
</td></tr>
<tr><td><code id="oldlogspline_+3A_nknots">nknots</code></td>
<td>

<p>forces the method to start with nknots knots (<code>delete = TRUE</code>) or to fit a 
density with nknots knots (<code>delete = FALSE</code>). The method has an automatic rule 
for selecting nknots if this parameter is not specified. 
</p>
</td></tr>
<tr><td><code id="oldlogspline_+3A_knots">knots</code></td>
<td>

<p>ordered vector of values (that should cover the complete range of the 
observations), which forces the method to start with these knots (<code>delete = TRUE</code>)
or to fit a density with these knots <code>delete = FALSE</code>). Overrules <code>nknots</code>. 
If <code>knots</code> is not specified, a default knot-placement rule is employed. 
</p>
</td></tr>
<tr><td><code id="oldlogspline_+3A_penalty">penalty</code></td>
<td>

<p>the parameter to be used in the AIC criterion. The method chooses 
the number of knots that minimizes <code>-2 * loglikelihood + penalty * (number of knots - 1)</code>. 
The default is to use  a penalty parameter of <code>penalty = log(samplesize)</code> as in BIC. The effect of 
this parameter is summarized in <code><a href="#topic+summary.oldlogspline">summary.oldlogspline</a></code>. 
</p>
</td></tr>
<tr><td><code id="oldlogspline_+3A_delete">delete</code></td>
<td>

<p>should stepwise knot deletion be employed? 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of the class <code>oldlogspline</code>, that is intended as input for
<code><a href="#topic+plot.oldlogspline">plot.oldlogspline</a></code>, 
<code><a href="#topic+summary.oldlogspline">summary.oldlogspline</a></code>, 
<code><a href="#topic+doldlogspline">doldlogspline</a></code> (densities), 
<code><a href="#topic+poldlogspline">poldlogspline</a></code> (probabilities),<br />
<code><a href="#topic+qoldlogspline">qoldlogspline</a></code> (quantiles),
<code><a href="#topic+roldlogspline">roldlogspline</a></code> (random numbers from the fitted distribution).
The function <code><a href="#topic+oldlogspline.to.logspline">oldlogspline.to.logspline</a></code> can translate an object of the class
<code>oldlogspline</code> to an object of the class <code>logspline</code>.
</p>
<p>The object has the following members: 
</p>
<table>
<tr><td><code>call</code></td>
<td>

<p>the command that was executed. 
</p>
</td></tr>
<tr><td><code>knots</code></td>
<td>

<p>vector of the locations of the knots in the <code>oldlogspline</code> model. 
old
</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>

<p>coefficients of the spline. The first coefficient is the constant term, 
the second is the linear term and the k-th <code class="reqn">(k&gt;2)</code> is the coefficient 
of <code class="reqn">(x-t(k-2))^3_+</code> (where <code class="reqn">x^3_+</code> means the positive part of the third power
of <code class="reqn">x</code>, 
and <code class="reqn">t(k-2)</code> means knot <code class="reqn">k-2</code>). If a coefficient is zero the corresponding 
knot was deleted from the model. 
</p>
</td></tr>
<tr><td><code>bound</code></td>
<td>

<p>first element: 0 - <code>lbound</code> was <code class="reqn">-\inf</code> 1 it was something else; second 
element: <code>lbound</code>, if specified; third element: 0 - <code>ubound</code> was <code class="reqn">\inf</code>, 
1 it was something else; fourth element: <code>ubound</code>, if specified. 
</p>
</td></tr>
<tr><td><code>logl</code></td>
<td>

<p>the <code>k</code>-th element is the log-likelihood of the fit with <code>k+2</code> knots. 
</p>
</td></tr>
<tr><td><code>penalty</code></td>
<td>

<p>the penalty that was used. 
</p>
</td></tr>
<tr><td><code>sample</code></td>
<td>

<p>the sample size that was used. 
</p>
</td></tr>
<tr><td><code>delete</code></td>
<td>

<p>was stepwise knot deletion employed? 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg and Charles J. Stone.  Logspline density estimation
for censored data (1992). <em>Journal of Computational and Graphical
Statistics</em>, <b>1</b>, 301&ndash;328.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+logspline">logspline</a></code>,      
<code><a href="#topic+oldlogspline">oldlogspline</a></code>,
<code><a href="#topic+plot.oldlogspline">plot.oldlogspline</a></code>,
<code><a href="#topic+summary.oldlogspline">summary.oldlogspline</a></code>,<br />
<code><a href="#topic+doldlogspline">doldlogspline</a></code>,
<code><a href="#topic+poldlogspline">poldlogspline</a></code>,
<code><a href="#topic+qoldlogspline">qoldlogspline</a></code>,
<code><a href="#topic+roldlogspline">roldlogspline</a></code>,
<code><a href="#topic+oldlogspline.to.logspline">oldlogspline.to.logspline</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># A simple example
y &lt;- rnorm(100)
fit &lt;- oldlogspline(y)       
plot(fit)
# An example involving censoring and a lower bound
y &lt;- rlnorm(1000)
censoring &lt;- rexp(1000) * 4
delta &lt;- 1 * (y &lt;= censoring)
y[delta == 0] &lt;- censoring[delta == 0]
fit &lt;- oldlogspline(y[delta == 1], y[delta == 0], lbound = 0)
</code></pre>

<hr>
<h2 id='oldlogspline.to.logspline'>Logspline Density Estimation - 1992 to 1997 version </h2><span id='topic+oldlogspline.to.logspline'></span>

<h3>Description</h3>

<p>Translates an <code>oldlogspline</code> object in an
<code>logspline</code> object. This routine is mostly used in <code>logspline</code>,
as it allows the routine to use <code>oldlogspline</code> for some situations
where <code>logspline</code> crashes. The other use is when you have censored data,
and thus have to use <code>oldlogspline</code> to fit, but wish to use the
auxiliary routines from <code>logspline</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>oldlogspline.to.logspline(obj, data) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oldlogspline.to.logspline_+3A_obj">obj</code></td>
<td>

<p>object of class <code>logspline</code>
</p>
</td></tr>
<tr><td><code id="oldlogspline.to.logspline_+3A_data">data</code></td>
<td>

<p>the original data. Used to compute the <code>range</code> component of the
new object. if <code>data</code> is not available, the 1/(n+1) and n/(n+1)
quantiles of the fitted distribution are used for <code>range</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p> object of the class <code>logspline</code>. The <code>call</code> component
of the new object is not useful. The <code>delete</code> component of the old
object is ignored.</p>


<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg and Charles J. Stone.  Logspline density estimation
for censored data (1992). <em>Journal of Computational and Graphical
Statistics</em>, <b>1</b>, 301&ndash;328.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

<p><code><a href="#topic+logspline">logspline</a></code>,
<code><a href="#topic+oldlogspline">oldlogspline</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
fit.old &lt;- oldlogspline(x)
fit.translate &lt;- oldlogspline.to.logspline(fit.old,x)
fit.new &lt;- logspline(x)
plot(fit.new)
plot(fit.old,add=TRUE,col=2)
#
# should look almost the same, the differences are the
# different fitting routines
#
</code></pre>

<hr>
<h2 id='plot.logspline'>Logspline Density Estimation </h2><span id='topic+plot.logspline'></span>

<h3>Description</h3>

<p>Plots a <code>logspline</code> density, distribution function, hazard 
function or survival function 
from 
a logspline density that was fitted using
the 1997 knot addition and deletion algorithm (<code><a href="#topic+logspline">logspline</a></code>). 
The 1992 algorithm is available using the <code><a href="#topic+oldlogspline">oldlogspline</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logspline'
plot(x, n = 100, what = "d", add = FALSE, xlim, xlab = "",
ylab = "", type = "l", ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.logspline_+3A_x">x</code></td>
<td>
<p><code>logspline</code> object, typically the result of <code><a href="#topic+logspline">logspline</a></code>.</p>
</td></tr>
<tr><td><code id="plot.logspline_+3A_n">n</code></td>
<td>
<p>the number of equally spaced points at which to plot the density.  </p>
</td></tr>
<tr><td><code id="plot.logspline_+3A_what">what</code></td>
<td>
<p>what should be plotted: 
<code>"d"</code> (density), <code>"p"</code> (distribution function), <code>"s"</code> (survival 
function) or <code>"h"</code> (hazard function).  </p>
</td></tr>
<tr><td><code id="plot.logspline_+3A_add">add</code></td>
<td>
<p>should the plot be added to an existing plot.</p>
</td></tr>
<tr><td><code id="plot.logspline_+3A_xlim">xlim</code></td>
<td>

<p>range of data on which to plot. Default is from the 1th to the 99th percentile of
the density, extended by 10% on each end.</p>
</td></tr>
<tr><td><code id="plot.logspline_+3A_xlab">xlab</code>, <code id="plot.logspline_+3A_ylab">ylab</code></td>
<td>
<p>labels plotted on the axes.  </p>
</td></tr>
<tr><td><code id="plot.logspline_+3A_type">type</code></td>
<td>
<p>type of plot.</p>
</td></tr>
<tr><td><code id="plot.logspline_+3A_...">...</code></td>
<td>
<p>other plotting options, as desired</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a plot of a <code><a href="#topic+logspline">logspline</a></code> fit at <code>n</code> equally 
spaced points roughly covering the support of the density. (Use 
<code>xlim = c(from, to)</code> to change the range of these points.) 
</p>


<h3>Author(s)</h3>

<p>Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg and Charles J. Stone.  Logspline density estimation
for censored data (1992). <em>Journal of Computational and Graphical
Statistics</em>, <b>1</b>, 301&ndash;328.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

<p><code><a href="#topic+logspline">logspline</a></code>,      
<code><a href="#topic+summary.logspline">summary.logspline</a></code>,
<code><a href="#topic+dlogspline">dlogspline</a></code>,
<code><a href="#topic+plogspline">plogspline</a></code>,
<code><a href="#topic+qlogspline">qlogspline</a></code>,
<code><a href="#topic+rlogspline">rlogspline</a></code>,
</p>
<p><code><a href="#topic+oldlogspline">oldlogspline</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- rnorm(100)
fit &lt;- logspline(y)       
plot(fit) 
</code></pre>

<hr>
<h2 id='plot.oldlogspline'>Logspline Density Estimation - 1992 version </h2><span id='topic+plot.oldlogspline'></span>

<h3>Description</h3>

<p>Plots an <code>oldlogspline</code> density, distribution function, hazard 
function or survival function 
from 
a logspline density that was fitted using
the 1992 knot deletion algorithm.
The 1997 algorithm using knot
deletion and addition is available using the <code><a href="#topic+logspline">logspline</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'oldlogspline'
plot(x, n = 100, what = "d", xlim, xlab = "", ylab = "",
type = "l", add = FALSE, ...) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.oldlogspline_+3A_x">x</code></td>
<td>
<p><code>logspline</code> object, typically the result of <code><a href="#topic+logspline">logspline</a></code>.</p>
</td></tr>
<tr><td><code id="plot.oldlogspline_+3A_n">n</code></td>
<td>
<p>the number of equally spaced points at which to plot the density.  </p>
</td></tr>
<tr><td><code id="plot.oldlogspline_+3A_what">what</code></td>
<td>
<p>what should be plotted: 
<code>"d"</code> (density), <code>"p"</code> (distribution function), <code>"s"</code> (survival 
function) or <code>"h"</code> (hazard function).  </p>
</td></tr>
<tr><td><code id="plot.oldlogspline_+3A_xlim">xlim</code></td>
<td>

<p>range of data on which to plot. Default is from the 1th to the 99th percentile of
the density, extended by 10% on each end.</p>
</td></tr>
<tr><td><code id="plot.oldlogspline_+3A_xlab">xlab</code>, <code id="plot.oldlogspline_+3A_ylab">ylab</code></td>
<td>
<p>labels plotted on the axes.  </p>
</td></tr>
<tr><td><code id="plot.oldlogspline_+3A_type">type</code></td>
<td>
<p>type of plot.</p>
</td></tr>
<tr><td><code id="plot.oldlogspline_+3A_add">add</code></td>
<td>
<p>should the plot be added to an existing plot.</p>
</td></tr>
<tr><td><code id="plot.oldlogspline_+3A_...">...</code></td>
<td>
<p>other plotting options, as desired</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a plot of a <code><a href="#topic+oldlogspline">oldlogspline</a></code> fit at <code>n</code> equally
spaced points roughly covering the support of the density. (Use
<code>xlim=c(from,to)</code> to change the range of these points.)
</p>


<h3>Author(s)</h3>

<p>Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg and Charles J. Stone.  Logspline density estimation
for censored data (1992). <em>Journal of Computational and Graphical
Statistics</em>, <b>1</b>, 301&ndash;328.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

<p><code><a href="#topic+logspline">logspline</a></code>,
<code><a href="#topic+oldlogspline">oldlogspline</a></code>,
<code><a href="#topic+summary.oldlogspline">summary.oldlogspline</a></code>,
<code><a href="#topic+doldlogspline">doldlogspline</a></code>,
<code><a href="#topic+poldlogspline">poldlogspline</a></code>,<br />
<code><a href="#topic+qoldlogspline">qoldlogspline</a></code>,
<code><a href="#topic+roldlogspline">roldlogspline</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- rnorm(100)
fit &lt;- oldlogspline(y)       
plot(fit) 
</code></pre>

<hr>
<h2 id='summary.logspline'>Logspline Density Estimation </h2><span id='topic+summary.logspline'></span><span id='topic+print.logspline'></span>

<h3>Description</h3>

<p> This function summarizes both the stepwise selection process of the
model fitting by <code><a href="#topic+logspline">logspline</a></code>, as well as the final model
that was selected using AIC/BIC. A
<code>logspline</code> object was fit using the 1997 knot addition and deletion algorithm.
The 1992 algorithm is available using the <code><a href="#topic+oldlogspline">oldlogspline</a></code> function.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logspline'
summary(object, ...) 
## S3 method for class 'logspline'
print(x, ...) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.logspline_+3A_object">object</code>, <code id="summary.logspline_+3A_x">x</code></td>
<td>
<p><code>logspline</code> object, typically the result of <code><a href="#topic+logspline">logspline</a></code></p>
</td></tr>
<tr><td><code id="summary.logspline_+3A_...">...</code></td>
<td>
<p> other arguments are ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These function produce identical printed output. The main body 
is a table with five columns: the first column is a possible number 
of knots for the fitted model; 
</p>
<p>the second column is the log-likelihood for the fit; 
</p>
<p>the third column is <code>-2 * loglikelihood + penalty * (number of knots - 1)</code>, 
which is the AIC criterion; <code><a href="#topic+logspline">logspline</a></code> selected the model with 
the smallest value of AIC; 
</p>
<p>the fourth and fifth columns give the 
endpoints of the interval of values of penalty that would yield the 
model with the indicated number of knots. (<code>NA</code>s imply that the model is 
not optimal for any choice of <code>penalty</code>.) At the bottom of the table the 
number of knots corresponding to the selected model is reported, as is 
the value of penalty that was used. 
</p>


<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg and Charles J. Stone.  Logspline density estimation
for censored data (1992). <em>Journal of Computational and Graphical
Statistics</em>, <b>1</b>, 301&ndash;328.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+logspline">logspline</a></code>,      
<code><a href="#topic+plot.logspline">plot.logspline</a></code>,
<code><a href="#topic+dlogspline">dlogspline</a></code>,
<code><a href="#topic+plogspline">plogspline</a></code>,
<code><a href="#topic+qlogspline">qlogspline</a></code>,
<code><a href="#topic+rlogspline">rlogspline</a></code>,<br />
<code><a href="#topic+oldlogspline">oldlogspline</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- rnorm(100)
fit &lt;- logspline(y)       
summary(fit) 
</code></pre>

<hr>
<h2 id='summary.oldlogspline'> Logspline Density Estimation - 1992 version </h2><span id='topic+summary.oldlogspline'></span><span id='topic+print.oldlogspline'></span>

<h3>Description</h3>

<p> This function summarizes both the stepwise selection process of the
model fitting by <code><a href="#topic+oldlogspline">oldlogspline</a></code>, as well as the final model
that was selected using AIC/BIC. A
<code>logspline</code> object was fit using
the 1992 knot deletion algorithm (<code><a href="#topic+oldlogspline">oldlogspline</a></code>). 
The 1997 algorithm using knot
deletion and addition is available using the <code><a href="#topic+logspline">logspline</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'oldlogspline'
summary(object, ...) 
## S3 method for class 'oldlogspline'
print(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.oldlogspline_+3A_object">object</code>, <code id="summary.oldlogspline_+3A_x">x</code></td>
<td>

<p><code>oldlogspline</code> object, typically the result of <code><a href="#topic+oldlogspline">oldlogspline</a></code>
</p>
</td></tr>
<tr><td><code id="summary.oldlogspline_+3A_...">...</code></td>
<td>
<p> other arguments are ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These function produces the same printed output. The main body 
is a table with five columns: the first column is a possible number 
of knots for the fitted model; 
</p>
<p>the second column is the log-likelihood for the fit; 
</p>
<p>the third column is <code>-2 * loglikelihood + penalty * (number of knots - 1)</code>,
which is the AIC criterion; <code><a href="#topic+logspline">logspline</a></code> selected the model with
the smallest value of AIC;
</p>
<p>the fourth and fifth columns give the 
endpoints of the interval of values of penalty that would yield the 
model with the indicated number of knots. (<code>NA</code>s imply that the model is 
not optimal for any choice of <code>penalty</code>.) At the bottom of the table the 
number of knots corresponding to the selected model is reported, as is 
the value of penalty that was used. 
</p>


<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg and Charles J. Stone.  Logspline density estimation
for censored data (1992). <em>Journal of Computational and Graphical
Statistics</em>, <b>1</b>, 301&ndash;328.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

<p><code><a href="#topic+logspline">logspline</a></code>,
<code><a href="#topic+oldlogspline">oldlogspline</a></code>,
<code><a href="#topic+plot.oldlogspline">plot.oldlogspline</a></code>,
<code><a href="#topic+doldlogspline">doldlogspline</a></code>,
<code><a href="#topic+poldlogspline">poldlogspline</a></code>,<br />
<code><a href="#topic+qoldlogspline">qoldlogspline</a></code>,
<code><a href="#topic+roldlogspline">roldlogspline</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- rnorm(100)
fit &lt;- oldlogspline(y)       
summary(fit) 
</code></pre>

<hr>
<h2 id='unstrip'>Reformat data as vector or matrix</h2><span id='topic+unstrip'></span>

<h3>Description</h3>

<p>This function tries to convert a date.frame or a matrix to a no-frills matrix without labels,
and a vector or time-series to a no-frills vector without labels.</p>


<h3>Usage</h3>

<pre><code class='language-R'>unstrip(x) </code></pre>


<h3>Arguments</h3>

 <table>
<tr><td><code id="unstrip_+3A_x">x</code></td>
<td>
<p> one- or two-dimensional object.</p>
</td></tr> </table>


<h3>Details</h3>

<p>Many of the functions for <code><a href="#topic+logspline">logspline</a></code>, <code><a href="#topic+oldlogspline">oldlogspline</a></code>, 
were written in the &ldquo;before data.frame&rdquo; era;
<code>unstrip</code> attempts to keep all these functions useful with more advanced input objects.
In particular, many of these functions call <code>unstrip</code> before doing anything else.</p>


<h3>Value</h3>

<p>If <code>x</code> is two-dimensional a  matrix
without names, if <code>x</code> is one-dimensional  a numerical vector</p>


<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(co2)
unstrip(co2)
data(iris)
unstrip(iris)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
