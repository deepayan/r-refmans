<!DOCTYPE html><html><head><title>Help for package rSAFE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rSAFE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rSAFE-package'><p>rSAFE: Surrogate-Assisted Feature Extraction</p></a></li>
<li><a href='#apartments'><p>Apartments data</p></a></li>
<li><a href='#HR_data'><p>Why are our best and most experienced employees leaving prematurely?</p></a></li>
<li><a href='#plot.safe_extractor'><p>Plotting Transformations of the SAFE Extractor Object</p></a></li>
<li><a href='#print.safe_extractor'><p>Printing Summary of the SAFE Extractor Object</p></a></li>
<li><a href='#safe_extraction'><p>Creating SAFE Extractor - an Object Used for Surrogate-Assisted Feature Extraction</p></a></li>
<li><a href='#safely_detect_changepoints'><p>Identifying Changes in a Series Using PELT Algorithm</p></a></li>
<li><a href='#safely_detect_interactions'><p>Detecting Interactions via Permutation Approach</p></a></li>
<li><a href='#safely_select_variables'><p>Performing Feature Selection on the Dataset with Transformed Variables</p></a></li>
<li><a href='#safely_transform_categorical'><p>Calculating a Transformation of Categorical Feature Using Hierarchical Clustering</p></a></li>
<li><a href='#safely_transform_continuous'><p>Calculating a Transformation of a Continuous Feature Using PDP/ALE Plot</p></a></li>
<li><a href='#safely_transform_data'><p>Performing Transformations on All Features in the Dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Surrogate-Assisted Feature Extraction</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a model agnostic tool for white-box model trained on features extracted from a black-box model. For more information see: Gosiewska et al. (2020) &lt;<a href="https://doi.org/10.1016%2Fj.dss.2021.113556">doi:10.1016/j.dss.2021.113556</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>DALEX, dendextend, ggplot2, ggpubr, grDevices, ingredients,
sets, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gbm, knitr, pander, randomForest, rmarkdown, spelling,
testthat, vdiffr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ModelOriented/rSAFE">https://github.com/ModelOriented/rSAFE</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ModelOriented/rSAFE/issues">https://github.com/ModelOriented/rSAFE/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-13 12:48:01 UTC; alicj</td>
</tr>
<tr>
<td>Author:</td>
<td>Alicja Gosiewska [aut, cre],
  Anna Gierlak [aut],
  Przemyslaw Biecek [aut, ths],
  Michal Burdukiewicz
    <a href="https://orcid.org/0000-0001-8926-582X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alicja Gosiewska &lt;alicjagosiewska@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-13 13:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rSAFE-package'>rSAFE: Surrogate-Assisted Feature Extraction</h2><span id='topic+rSAFE'></span><span id='topic+rSAFE-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Provides a model agnostic tool for white-box model trained on features extracted from a black-box model. For more information see: Gosiewska et al. (2020) doi: <a href="https://doi.org/10.1016/j.dss.2021.113556">10.1016/j.dss.2021.113556</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Alicja Gosiewska <a href="mailto:alicjagosiewska@gmail.com">alicjagosiewska@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Anna Gierlak <a href="mailto:anna.gierlak@op.pl">anna.gierlak@op.pl</a>
</p>
</li>
<li><p> Przemyslaw Biecek [thesis advisor]
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Michal Burdukiewicz (<a href="https://orcid.org/0000-0001-8926-582X">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ModelOriented/rSAFE">https://github.com/ModelOriented/rSAFE</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ModelOriented/rSAFE/issues">https://github.com/ModelOriented/rSAFE/issues</a>
</p>
</li></ul>


<hr>
<h2 id='apartments'>Apartments data</h2><span id='topic+apartments'></span><span id='topic+apartmentsTest'></span>

<h3>Description</h3>

<p>Datasets <code>apartments</code> and <code>apartmentsTest</code> are artificial,
generated from the same model.
Structure of the dataset is copied from real dataset from <code>PBImisc</code> package,
but they were generated in a way to mimic effect of Anscombe quartet for complex black box models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(apartments)
</code></pre>


<h3>Format</h3>

<p>a data frame with 1000 rows and 6 columns
</p>


<h3>Details</h3>


<ul>
<li><p> m2.price - price per square meter
</p>
</li>
<li><p> surface - apartment area in square meters
</p>
</li>
<li><p> no.rooms - number of rooms (correlated with surface)
</p>
</li>
<li><p> district - district in which apartment is located, factor with 10 levels
(Bemowo, Bielany, Mokotow, Ochota, Praga, Srodmiescie, Ursus, Ursynow, Wola, Zoliborz)
</p>
</li>
<li><p> floor - floor
</p>
</li>
<li><p> construction.year - construction year
</p>
</li></ul>


<hr>
<h2 id='HR_data'>Why are our best and most experienced employees leaving prematurely?</h2><span id='topic+HR_data'></span>

<h3>Description</h3>

<p>A dataset from Kaggle competition Human Resources Analytics.
https://www.kaggle.com/
</p>


<h3>Format</h3>

<p>A data frame with 14999 rows and 10 variables
</p>


<h3>Details</h3>


<ul>
<li><p>  satisfaction_level Level of satisfaction (0-1)
</p>
</li>
<li><p>  last_evaluation Time since last performance evaluation (in Years)
</p>
</li>
<li><p>  number_project  Number of projects completed while at work
</p>
</li>
<li><p>  average_monthly_hours  Average monthly hours at workplace
</p>
</li>
<li><p>  time_spend_company  Number of years spent in the company
</p>
</li>
<li><p>  work_accident  Whether the employee had a workplace accident
</p>
</li>
<li><p>  left  Whether the employee left the workplace or not (1 or 0) Factor
</p>
</li>
<li><p>  promotion_last_5years  Whether the employee was promoted in the last five years
</p>
</li>
<li><p>  sales  Department in which they work for
</p>
</li>
<li><p>  salary  Relative level of salary (high)
</p>
</li></ul>



<h3>Source</h3>

<p>Dataset HR-analytics from <a href="https://www.kaggle.com">https://www.kaggle.com</a>
</p>

<hr>
<h2 id='plot.safe_extractor'>Plotting Transformations of the SAFE Extractor Object</h2><span id='topic+plot.safe_extractor'></span>

<h3>Description</h3>

<p>Plotting Transformations of the SAFE Extractor Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'safe_extractor'
plot(x, ..., variable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.safe_extractor_+3A_x">x</code></td>
<td>
<p>safe_extractor object containing information about variables transformations created with safe_extraction() function</p>
</td></tr>
<tr><td><code id="plot.safe_extractor_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
<tr><td><code id="plot.safe_extractor_+3A_variable">variable</code></td>
<td>
<p>character, name of the variable to be plotted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot object
</p>

<hr>
<h2 id='print.safe_extractor'>Printing Summary of the SAFE Extractor Object</h2><span id='topic+print.safe_extractor'></span>

<h3>Description</h3>

<p>Printing Summary of the SAFE Extractor Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'safe_extractor'
print(x, ..., variable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.safe_extractor_+3A_x">x</code></td>
<td>
<p>safe_extractor object containing information about variables transformations created with safe_extraction() function</p>
</td></tr>
<tr><td><code id="print.safe_extractor_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
<tr><td><code id="print.safe_extractor_+3A_variable">variable</code></td>
<td>
<p>character, name of the variable to be plotted. If this argument
is not specified then transformations for all variables are printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, prints the structure of the object
</p>

<hr>
<h2 id='safe_extraction'>Creating SAFE Extractor - an Object Used for Surrogate-Assisted Feature Extraction</h2><span id='topic+safe_extraction'></span>

<h3>Description</h3>

<p>The safe_extraction() function creates a SAFE-extractor object which may be used later
for surrogate feature extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safe_extraction(
  explainer,
  response_type = "ale",
  grid_points = 50,
  N = 200,
  penalty = "MBIC",
  nquantiles = 10,
  no_segments = 2,
  method = "complete",
  B = 500,
  collapse = "_",
  interactions = FALSE,
  inter_param = 0.25,
  inter_threshold = 0.25,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="safe_extraction_+3A_explainer">explainer</code></td>
<td>
<p>DALEX explainer created with explain() function</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_response_type">response_type</code></td>
<td>
<p>character, type of response to be calculated, one of: &quot;pdp&quot;, &quot;ale&quot;.
If features are uncorrelated, one can use &quot;pdp&quot; type - otherwise &quot;ale&quot; is strongly recommended.</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_grid_points">grid_points</code></td>
<td>
<p>number of points on x-axis used for creating the PD/ALE plot, default 50</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_n">N</code></td>
<td>
<p>number of observations from the dataset used for creating the PD/ALE plot, default 200</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_penalty">penalty</code></td>
<td>
<p>penalty for introducing another changepoint,
one of &quot;AIC&quot;, &quot;BIC&quot;, &quot;SIC&quot;, &quot;MBIC&quot;, &quot;Hannan-Quinn&quot; or numeric non-negative value</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_nquantiles">nquantiles</code></td>
<td>
<p>the number of quantiles used in integral approximation</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_no_segments">no_segments</code></td>
<td>
<p>numeric, a number of segments variable is to be divided into in case of founding no breakpoints</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_method">method</code></td>
<td>
<p>the agglomeration method to be used in hierarchical clustering, one of:
&quot;ward.D&quot;, &quot;ward.D2&quot;, &quot;single&quot;, &quot;complete&quot;, &quot;average&quot;, &quot;mcquitty&quot;, &quot;median&quot;, &quot;centroid&quot;</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_b">B</code></td>
<td>
<p>number of reference datasets used to calculate gap statistics</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_collapse">collapse</code></td>
<td>
<p>a character string to separate original levels while combining them to the new one</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_interactions">interactions</code></td>
<td>
<p>logical, if interactions between variables are to be taken into account</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_inter_param">inter_param</code></td>
<td>
<p>numeric, a positive value indicating which of single observation non-additive effects
are to be regarded as significant, the higher value the higher non-additive effect has to be to be taken
into account</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_inter_threshold">inter_threshold</code></td>
<td>
<p>numeric, a value from <code style="white-space: pre;">&#8288;[0,1]&#8288;</code> interval indicating which interactions should be returned
as significant. It corresponds to the percentage of observations for which interaction measure is greater
than inter_param - if this percentage is less than inter_threshold then interaction effect is ignored.</p>
</td></tr>
<tr><td><code id="safe_extraction_+3A_verbose">verbose</code></td>
<td>
<p>logical, if progress bar is to be printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>safe_extractor object containing information about variables transformation
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safely_transform_categorical">safely_transform_categorical</a></code>, <code><a href="#topic+safely_transform_continuous">safely_transform_continuous</a></code>, <code><a href="#topic+safely_detect_interactions">safely_detect_interactions</a></code>, <code><a href="#topic+safely_transform_data">safely_transform_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(DALEX)
library(randomForest)
library(rSAFE)

data &lt;- apartments[1:500,]
set.seed(111)
model_rf &lt;- randomForest(m2.price ~ construction.year + surface + floor +
                           no.rooms + district, data = data)
explainer_rf &lt;- explain(model_rf, data = data[,2:6], y = data[,1], verbose = FALSE)
safe_extractor &lt;- safe_extraction(explainer_rf, grid_points = 30, N = 100, verbose = FALSE)
print(safe_extractor)
plot(safe_extractor, variable = "construction.year")

</code></pre>

<hr>
<h2 id='safely_detect_changepoints'>Identifying Changes in a Series Using PELT Algorithm</h2><span id='topic+safely_detect_changepoints'></span>

<h3>Description</h3>

<p>The safely_detect_changepoints() function calculates the optimal positioning
and number of changepoints for given data and penalty. It uses a PELT algorithm
with a nonparametric cost function based on the empirical distribution.
The implementation is inspired by the code available on https://github.com/rkillick/changepoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safely_detect_changepoints(data, penalty = "MBIC", nquantiles = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="safely_detect_changepoints_+3A_data">data</code></td>
<td>
<p>a vector within which you wish to find changepoints</p>
</td></tr>
<tr><td><code id="safely_detect_changepoints_+3A_penalty">penalty</code></td>
<td>
<p>penalty for introducing another changepoint,
one of &quot;AIC&quot;, &quot;BIC&quot;, &quot;SIC&quot;, &quot;MBIC&quot;, &quot;Hannan-Quinn&quot; or numeric non-negative value</p>
</td></tr>
<tr><td><code id="safely_detect_changepoints_+3A_nquantiles">nquantiles</code></td>
<td>
<p>the number of quantiles used in integral approximation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of optimal changepoint positions (last observations of each segment)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safely_transform_continuous">safely_transform_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(rSAFE)

data &lt;- rep(c(2,7), each=4)
safely_detect_changepoints(data)

set.seed(123)
data &lt;- c(rnorm(15, 0), rnorm(20, 2), rnorm(30, 8))
safely_detect_changepoints(data)
safely_detect_changepoints(data, penalty = 25)
</code></pre>

<hr>
<h2 id='safely_detect_interactions'>Detecting Interactions via Permutation Approach</h2><span id='topic+safely_detect_interactions'></span>

<h3>Description</h3>

<p>The safely_detect_interactions() function detects second-order interactions based on predictions
made by a surrogate model. For each pair of features it performs values permutation in order
to evaluate their non_additive effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safely_detect_interactions(
  explainer,
  inter_param = 0.5,
  inter_threshold = 0.5,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="safely_detect_interactions_+3A_explainer">explainer</code></td>
<td>
<p>DALEX explainer created with explain() function</p>
</td></tr>
<tr><td><code id="safely_detect_interactions_+3A_inter_param">inter_param</code></td>
<td>
<p>numeric, a positive value indicating which of single observation non-additive effects
are to be regarded as significant, the higher value the higher non-additive effect has to be to be taken
into account</p>
</td></tr>
<tr><td><code id="safely_detect_interactions_+3A_inter_threshold">inter_threshold</code></td>
<td>
<p>numeric, a value from <code style="white-space: pre;">&#8288;[0,1]&#8288;</code> interval indicating which interactions should be returned
as significant. It corresponds to the percentage of observations for which interaction measure is greater
than inter_param - if this percentage is less than inter_threshold then interaction effect is ignored.</p>
</td></tr>
<tr><td><code id="safely_detect_interactions_+3A_verbose">verbose</code></td>
<td>
<p>logical, if progress bar is to be printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe object containing interactions effects greater than or equal to the specified inter_threshold
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safe_extraction">safe_extraction</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(DALEX)
library(randomForest)
library(rSAFE)

data &lt;- apartments[1:500,]
set.seed(111)
model_rf &lt;- randomForest(m2.price ~ construction.year + surface + floor +
                           no.rooms + district, data = data)
explainer_rf &lt;- explain(model_rf, data = data[,2:6], y = data[,1])
safely_detect_interactions(explainer_rf, inter_param = 0.25,
                          inter_threshold = 0.2, verbose = TRUE)

</code></pre>

<hr>
<h2 id='safely_select_variables'>Performing Feature Selection on the Dataset with Transformed Variables</h2><span id='topic+safely_select_variables'></span>

<h3>Description</h3>

<p>The safely_select_variables() function selects variables from dataset returned
by safely_transform_data() function. For each original variable exactly one variable is chosen
</p>

<ul>
<li><p> either original one or transformed one. The choice is based on the AIC value
for linear model (regression) or logistic regression (classification).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>safely_select_variables(
  safe_extractor,
  data,
  y = NULL,
  which_y = NULL,
  class_pred = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="safely_select_variables_+3A_safe_extractor">safe_extractor</code></td>
<td>
<p>object containing information about variables transformations created with safe_extraction() function</p>
</td></tr>
<tr><td><code id="safely_select_variables_+3A_data">data</code></td>
<td>
<p>data, original dataset or the one returned by safely_transform_data() function.
If data do not contain transformed variables then transformation is done inside this function using 'safe_extractor' argument.
Data may contain response variable or not - if it does then 'which_y' argument must be given,
otherwise 'y' argument should be provided.</p>
</td></tr>
<tr><td><code id="safely_select_variables_+3A_y">y</code></td>
<td>
<p>vector of responses, must be given if data does not contain it</p>
</td></tr>
<tr><td><code id="safely_select_variables_+3A_which_y">which_y</code></td>
<td>
<p>numeric or character (optional), must be given if data contains response values</p>
</td></tr>
<tr><td><code id="safely_select_variables_+3A_class_pred">class_pred</code></td>
<td>
<p>numeric or character, used only in multi-classification problems.
If response vector has more than two levels, then 'class_pred' should indicate the class of interest
which will denote failure - all other classes will stand for success.</p>
</td></tr>
<tr><td><code id="safely_select_variables_+3A_verbose">verbose</code></td>
<td>
<p>logical, if progress bar is to be printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of variables names, selected based on AIC values
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safely_transform_data">safely_transform_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(DALEX)
library(randomForest)
library(rSAFE)

data &lt;- apartments[1:500,]
set.seed(111)
model_rf &lt;- randomForest(m2.price ~ construction.year + surface + floor +
                           no.rooms + district, data = data)
explainer_rf &lt;- explain(model_rf, data = data[,2:6], y = data[,1])
safe_extractor &lt;- safe_extraction(explainer_rf, verbose = FALSE)
safely_select_variables(safe_extractor, data, which_y = "m2.price", verbose = FALSE)

</code></pre>

<hr>
<h2 id='safely_transform_categorical'>Calculating a Transformation of Categorical Feature Using Hierarchical Clustering</h2><span id='topic+safely_transform_categorical'></span>

<h3>Description</h3>

<p>The safely_transform_categorical() function calculates a transformation function
for the categorical variable using predictions obtained from black box model and hierarchical clustering.
The gap statistic criterion is used to determine the optimal number of clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safely_transform_categorical(
  explainer,
  variable,
  method = "complete",
  B = 500,
  collapse = "_"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="safely_transform_categorical_+3A_explainer">explainer</code></td>
<td>
<p>DALEX explainer created with explain() function</p>
</td></tr>
<tr><td><code id="safely_transform_categorical_+3A_variable">variable</code></td>
<td>
<p>a feature for which the transformation function is to be computed</p>
</td></tr>
<tr><td><code id="safely_transform_categorical_+3A_method">method</code></td>
<td>
<p>the agglomeration method to be used in hierarchical clustering, one of:
&quot;ward.D&quot;, &quot;ward.D2&quot;, &quot;single&quot;, &quot;complete&quot;, &quot;average&quot;, &quot;mcquitty&quot;, &quot;median&quot;, &quot;centroid&quot;</p>
</td></tr>
<tr><td><code id="safely_transform_categorical_+3A_b">B</code></td>
<td>
<p>number of reference datasets used to calculate gap statistics</p>
</td></tr>
<tr><td><code id="safely_transform_categorical_+3A_collapse">collapse</code></td>
<td>
<p>a character string to separate original levels while combining them to the new one</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of information on the transformation of given variable
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safe_extraction">safe_extraction</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(DALEX)
library(randomForest)
library(rSAFE)

data &lt;- apartments[1:500,]
set.seed(111)
model_rf &lt;- randomForest(m2.price ~ construction.year + surface + floor +
                           no.rooms + district, data = data)
explainer_rf &lt;- explain(model_rf, data = data[,2:6], y = data[,1])
safely_transform_categorical(explainer_rf, "district")

</code></pre>

<hr>
<h2 id='safely_transform_continuous'>Calculating a Transformation of a Continuous Feature Using PDP/ALE Plot</h2><span id='topic+safely_transform_continuous'></span>

<h3>Description</h3>

<p>The safely_transform_continuous() function calculates a transformation function
for the continuous variable using a PD/ALE plot obtained from black box model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safely_transform_continuous(
  explainer,
  variable,
  response_type = "ale",
  grid_points = 50,
  N = 200,
  penalty = "MBIC",
  nquantiles = 10,
  no_segments = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="safely_transform_continuous_+3A_explainer">explainer</code></td>
<td>
<p>DALEX explainer created with explain() function</p>
</td></tr>
<tr><td><code id="safely_transform_continuous_+3A_variable">variable</code></td>
<td>
<p>a feature for which the transformation function is to be computed</p>
</td></tr>
<tr><td><code id="safely_transform_continuous_+3A_response_type">response_type</code></td>
<td>
<p>character, type of response to be calculated, one of: &quot;pdp&quot;, &quot;ale&quot;.
If features are uncorrelated, one can use &quot;pdp&quot; type - otherwise &quot;ale&quot; is strongly recommended.</p>
</td></tr>
<tr><td><code id="safely_transform_continuous_+3A_grid_points">grid_points</code></td>
<td>
<p>number of points on x-axis used for creating the PD/ALE plot, default 50</p>
</td></tr>
<tr><td><code id="safely_transform_continuous_+3A_n">N</code></td>
<td>
<p>number of observations from the dataset used for creating the PD/ALE plot, default 200</p>
</td></tr>
<tr><td><code id="safely_transform_continuous_+3A_penalty">penalty</code></td>
<td>
<p>penalty for introducing another changepoint,
one of &quot;AIC&quot;, &quot;BIC&quot;, &quot;SIC&quot;, &quot;MBIC&quot;, &quot;Hannan-Quinn&quot; or numeric non-negative value</p>
</td></tr>
<tr><td><code id="safely_transform_continuous_+3A_nquantiles">nquantiles</code></td>
<td>
<p>the number of quantiles used in integral approximation</p>
</td></tr>
<tr><td><code id="safely_transform_continuous_+3A_no_segments">no_segments</code></td>
<td>
<p>numeric, a number of segments variable is to be divided into in case of founding no breakpoints</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of information on the transformation of given variable
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safe_extraction">safe_extraction</a></code>, <code><a href="#topic+safely_detect_changepoints">safely_detect_changepoints</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(DALEX)
library(randomForest)
library(rSAFE)

data &lt;- apartments[1:500,]
set.seed(111)
model_rf &lt;- randomForest(m2.price ~ construction.year + surface + floor +
                           no.rooms + district, data = data)
explainer_rf &lt;- explain(model_rf, data = data[,2:6], y = data[,1])
safely_transform_continuous(explainer_rf, "construction.year")

</code></pre>

<hr>
<h2 id='safely_transform_data'>Performing Transformations on All Features in the Dataset</h2><span id='topic+safely_transform_data'></span>

<h3>Description</h3>

<p>The safely_transform_data() function creates new variables in dataset
using safe_extractor object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safely_transform_data(safe_extractor, data, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="safely_transform_data_+3A_safe_extractor">safe_extractor</code></td>
<td>
<p>object containing information about variables transformations created with safe_extraction() function</p>
</td></tr>
<tr><td><code id="safely_transform_data_+3A_data">data</code></td>
<td>
<p>data for which features are to be transformed</p>
</td></tr>
<tr><td><code id="safely_transform_data_+3A_verbose">verbose</code></td>
<td>
<p>logical, if progress bar is to be printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data with extra columns containing newly created variables
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safe_extraction">safe_extraction</a></code>, <code><a href="#topic+safely_select_variables">safely_select_variables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(DALEX)
library(randomForest)
library(rSAFE)

data &lt;- apartments[1:500,]
set.seed(111)
model_rf &lt;- randomForest(m2.price ~ construction.year + surface + floor +
                           no.rooms + district, data = data)
explainer_rf &lt;- explain(model_rf, data = data[,2:6], y = data[,1])
safe_extractor &lt;- safe_extraction(explainer_rf, verbose = FALSE)
safely_transform_data(safe_extractor, data, verbose = FALSE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
