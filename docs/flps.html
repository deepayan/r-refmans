<!DOCTYPE html><html><head><title>Help for package flps</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {flps}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#binary'><p>binary.rda</p></a></li>
<li><a href='#continuous'><p>continuous.rda</p></a></li>
<li><a href='#flps_plot'><p>Make plots related to FLPS models</p></a></li>
<li><a href='#flps-package'><p>Fully latent principal stratification</p></a></li>
<li><a href='#graded'><p>graded.rda</p></a></li>
<li><a href='#importModel'><p>Import compiled Stan object</p></a></li>
<li><a href='#makeInpData'><p>Generate a matrix style data for simulation</p></a></li>
<li><a href='#makeSimData'><p>Generate Fully Latent Principal Stratification data for simulation</p></a></li>
<li><a href='#modelBuilder'><p>Generate compiled Stan object to facilitate the analysis</p></a></li>
<li><a href='#plot.flps'><p>Plot</p></a></li>
<li><a href='#print.flps'><p>Print results</p></a></li>
<li><a href='#runFLPS'><p>Conduct fully latent principal stratification</p></a></li>
<li><a href='#summary.flps'><p>Summarize the results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fully-Latent Principal Stratification</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-14</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation and analysis of Fully-Latent Principal Stratification (FLPS) with measurement models. Sales &amp; Pane (2019). &lt;<a href="https://doi.org/10.1214%2F18-AOAS1196">doi:10.1214/18-AOAS1196</a>&gt;. This package is supported by the Institute of Education Sciences, U.S. Department of Education, through Grant R305D210036.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>rstan, Rcpp (&ge; 1.0.8.3), methods, mirt, MASS, utils, stats,
mvtnorm, ggplot2, glue</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, rmarkdown, lavaan, data.table</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'flps-package.r' 'load_rstan.r' 'make_FLPSdata.r' 'run_FLPS.r'
'priors.r' 'sim_gen_measurement.r' 'sim_gen_structure.r'
'sim_gen_standata.r' 'sim_make_data.r' 'z_utils.r'
'z_validate.r' 'plot_function.r' 'summary_function.r'
'data_desc.r' 'zzz.r'</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://sooyongl.github.io/flps/">https://sooyongl.github.io/flps/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-02 21:44:00 UTC; lee</td>
</tr>
<tr>
<td>Author:</td>
<td>Sooyong Lee [aut, cre],
  Adam Sales [aut],
  Hyeon-Ah Kang [aut],
  Tiffany Whittaker [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sooyong Lee &lt;sooyongl09@utexas.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-02 22:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='binary'>binary.rda</h2><span id='topic+binary'></span>

<h3>Description</h3>

<p>A data set containing binary items information.
Example data regenerated from CTA1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binary
</code></pre>


<h3>Format</h3>

<p>A data frame with variables:
</p>

<dl>
<dt>schid</dt><dd><p>School ID</p>
</dd>
<dt>id</dt><dd><p>Student ID</p>
</dd>
<dt>sex</dt><dd><p>0 = boys; 1 = girls</p>
</dd>
<dt>race</dt><dd><p>0 = White; 1 = Others</p>
</dd>
<dt>pretest</dt><dd><p>Pre test scores</p>
</dd>
<dt>stdscore</dt><dd><p>Standardized scores</p>
</dd>
<dt>cm_sex</dt><dd><p>Cluster-mean of sex</p>
</dd>
<dt>cm_race</dt><dd><p>Cluster-mean of race</p>
</dd>
<dt>cm_pretest</dt><dd><p>Cluster-mean of Pre test scores</p>
</dd>
<dt>cm_stdscore</dt><dd><p>Cluster-mean of of Standardized scores</p>
</dd>
<dt>trt</dt><dd><p>Treatment assignment; 0 = control, 1 = treatment</p>
</dd>
<dt>Y</dt><dd><p>Outcome</p>
</dd>
<dt>q1</dt><dd><p>Binary item</p>
</dd>
<dt>q2</dt><dd><p>Binary item</p>
</dd>
<dt>q3</dt><dd><p>Binary item</p>
</dd>
<dt>q4</dt><dd><p>Binary item</p>
</dd>
<dt>q5</dt><dd><p>Binary item</p>
</dd>
<dt>q6</dt><dd><p>Binary item</p>
</dd>
<dt>q7</dt><dd><p>Binary item</p>
</dd>
<dt>q8</dt><dd><p>Binary item</p>
</dd>
<dt>q9</dt><dd><p>Binary item</p>
</dd>
<dt>q10</dt><dd><p>Binary item</p>
</dd>
<dt>q11</dt><dd><p>Binary item</p>
</dd>
<dt>q12</dt><dd><p>Binary item</p>
</dd>
<dt>q13</dt><dd><p>Binary item</p>
</dd>
<dt>q14</dt><dd><p>Binary item</p>
</dd>
<dt>q15</dt><dd><p>Binary item</p>
</dd>
<dt>q16</dt><dd><p>Binary item</p>
</dd>
<dt>q17</dt><dd><p>Binary item</p>
</dd>
<dt>q18</dt><dd><p>Binary item</p>
</dd>
<dt>q19</dt><dd><p>Binary item</p>
</dd>
<dt>q20</dt><dd><p>Binary item</p>
</dd>
</dl>



<h3>Source</h3>

<p>CTA1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(binary)
summary(binary)
</code></pre>

<hr>
<h2 id='continuous'>continuous.rda</h2><span id='topic+continuous'></span>

<h3>Description</h3>

<p>A data set containing continuous items information.
Example data regenerated from CTA1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>continuous
</code></pre>


<h3>Format</h3>

<p>A data frame with variables:
</p>

<dl>
<dt>schid</dt><dd><p>School ID</p>
</dd>
<dt>id</dt><dd><p>Student ID</p>
</dd>
<dt>sex</dt><dd><p>0 = boys; 1 = girls</p>
</dd>
<dt>race</dt><dd><p>0 = White; 1 = Others</p>
</dd>
<dt>pretest</dt><dd><p>Pre test scores</p>
</dd>
<dt>stdscore</dt><dd><p>Standardized scores</p>
</dd>
<dt>cm_sex</dt><dd><p>Cluster-mean of sex</p>
</dd>
<dt>cm_race</dt><dd><p>Cluster-mean of race</p>
</dd>
<dt>cm_pretest</dt><dd><p>Cluster-mean of Pre test scores</p>
</dd>
<dt>cm_stdscore</dt><dd><p>Cluster-mean of of Standardized scores</p>
</dd>
<dt>trt</dt><dd><p>Treatment assignment; 0 = control, 1 = treatment</p>
</dd>
<dt>Y</dt><dd><p>Outcome</p>
</dd>
<dt>q1</dt><dd><p>Continuous item</p>
</dd>
<dt>q2</dt><dd><p>Continuous item</p>
</dd>
<dt>q3</dt><dd><p>Continuous item</p>
</dd>
<dt>q4</dt><dd><p>Continuous item</p>
</dd>
<dt>q5</dt><dd><p>Continuous item</p>
</dd>
<dt>q6</dt><dd><p>Continuous item</p>
</dd>
<dt>q7</dt><dd><p>Continuous item</p>
</dd>
<dt>q8</dt><dd><p>Continuous item</p>
</dd>
<dt>q9</dt><dd><p>Continuous item</p>
</dd>
<dt>q10</dt><dd><p>Continuous item</p>
</dd>
<dt>q11</dt><dd><p>Continuous item</p>
</dd>
<dt>q12</dt><dd><p>Continuous item</p>
</dd>
<dt>q13</dt><dd><p>Continuous item</p>
</dd>
<dt>q14</dt><dd><p>Continuous item</p>
</dd>
<dt>q15</dt><dd><p>Continuous item</p>
</dd>
<dt>q16</dt><dd><p>Continuous item</p>
</dd>
<dt>q17</dt><dd><p>Continuous item</p>
</dd>
<dt>q18</dt><dd><p>Continuous item</p>
</dd>
<dt>q19</dt><dd><p>Continuous item</p>
</dd>
<dt>q20</dt><dd><p>Continuous item</p>
</dd>
</dl>



<h3>Source</h3>

<p>CTA1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(continuous)
summary(continuous)
</code></pre>

<hr>
<h2 id='flps_plot'>Make plots related to FLPS models</h2><span id='topic+flps_plot'></span>

<h3>Description</h3>

<p>Make plots related to FLPS models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flps_plot(object, type = "latent")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flps_plot_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+flps">flps</a></code> object</p>
</td></tr>
<tr><td><code id="flps_plot_+3A_type">type</code></td>
<td>
<p>a character indicating the type of plots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object that can be further customized
using the <span class="pkg">ggplot2</span> package.
</p>

<hr>
<h2 id='flps-package'>Fully latent principal stratification</h2><span id='topic+flps-package'></span><span id='topic+flps'></span>

<h3>Description</h3>

<p>The FLPS package conducts Bayesian analysis for fully latent principal stratification via rstan.
</p>


<h3>Details</h3>

<p>The 'flps' package.
</p>


<h3>Author(s)</h3>

<p>Sooyong Lee <a href="mailto:sooyongl09@gmail.com">sooyongl09@gmail.com</a>
</p>


<h3>References</h3>

<p>Sales, A. C., &amp; Pane, J. F. (2019). The role of mastery learning in an intelligent tutoring system: Principal stratification on a latent variable. The Annals of Applied Statistics, 13(1), 420-443.
Lee, S., Adam, S., Kang, H.-A., &amp; Whittaker, T. A. (2022). Fully latent principal
stratification: Combining ps with model-based measurement models. In The annual
meeting of the psychometric society (pp. 287â€“298).
</p>

<hr>
<h2 id='graded'>graded.rda</h2><span id='topic+graded'></span>

<h3>Description</h3>

<p>A data set containing graded response items information.
Example data regenerated from CTA1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graded
</code></pre>


<h3>Format</h3>

<p>A data frame with variables:
</p>

<dl>
<dt>schid</dt><dd><p>School ID</p>
</dd>
<dt>id</dt><dd><p>Student ID</p>
</dd>
<dt>sex</dt><dd><p>0 = boys; 1 = girls</p>
</dd>
<dt>race</dt><dd><p>0 = White; 1 = Others</p>
</dd>
<dt>pretest</dt><dd><p>Pre test scores</p>
</dd>
<dt>stdscore</dt><dd><p>Standardized scores</p>
</dd>
<dt>cm_sex</dt><dd><p>Cluster-mean of sex</p>
</dd>
<dt>cm_race</dt><dd><p>Cluster-mean of race</p>
</dd>
<dt>cm_pretest</dt><dd><p>Cluster-mean of Pre test scores</p>
</dd>
<dt>cm_stdscore</dt><dd><p>Cluster-mean of of Standardized scores</p>
</dd>
<dt>trt</dt><dd><p>Treatment assignment; 0 = control, 1 = treatment</p>
</dd>
<dt>Y</dt><dd><p>Outcome</p>
</dd>
<dt>q1</dt><dd><p>Graded response item</p>
</dd>
<dt>q2</dt><dd><p>Graded response item</p>
</dd>
<dt>q3</dt><dd><p>Graded response item</p>
</dd>
<dt>q4</dt><dd><p>Graded response item</p>
</dd>
<dt>q5</dt><dd><p>Graded response item</p>
</dd>
<dt>q6</dt><dd><p>Graded response item</p>
</dd>
<dt>q7</dt><dd><p>Graded response item</p>
</dd>
<dt>q8</dt><dd><p>Graded response item</p>
</dd>
<dt>q9</dt><dd><p>Graded response item</p>
</dd>
<dt>q10</dt><dd><p>Graded response item</p>
</dd>
<dt>q11</dt><dd><p>Graded response item</p>
</dd>
<dt>q12</dt><dd><p>Graded response item</p>
</dd>
<dt>q13</dt><dd><p>Graded response item</p>
</dd>
<dt>q14</dt><dd><p>Graded response item</p>
</dd>
<dt>q15</dt><dd><p>Graded response item</p>
</dd>
<dt>q16</dt><dd><p>Graded response item</p>
</dd>
<dt>q17</dt><dd><p>Graded response item</p>
</dd>
<dt>q18</dt><dd><p>Graded response item</p>
</dd>
<dt>q19</dt><dd><p>Graded response item</p>
</dd>
<dt>q20</dt><dd><p>Graded response item</p>
</dd>
</dl>



<h3>Source</h3>

<p>CTA1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(graded)
summary(graded)
</code></pre>

<hr>
<h2 id='importModel'>Import compiled Stan object</h2><span id='topic+importModel'></span>

<h3>Description</h3>

<p>Import compiled Stan object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importModel(lv_type, multilevel = FALSE, lv_randomeffect = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importModel_+3A_lv_type">lv_type</code></td>
<td>
<p>a character indicating the type of FLPS model.</p>
</td></tr>
<tr><td><code id="importModel_+3A_multilevel">multilevel</code></td>
<td>
<p>a logical indicating multilevel Stan model.</p>
</td></tr>
<tr><td><code id="importModel_+3A_lv_randomeffect">lv_randomeffect</code></td>
<td>
<p>A logical indicating whether to estimate random effects for latent variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a Stan compiled stanmodel object generated by <code>modelBuilder</code>
</p>

<hr>
<h2 id='makeInpData'>Generate a matrix style data for simulation</h2><span id='topic+makeInpData'></span>

<h3>Description</h3>

<p><code><a href="#topic+makeInpData">makeInpData</a></code> is a function for generating a data based on
the given information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeInpData(
  N,
  R2Y,
  R2eta,
  omega,
  tau0,
  tau1,
  betaL,
  betaY,
  linear = TRUE,
  ydist = "n",
  lambda,
  nitem,
  nfac = 1,
  lvmodel,
  fcovmat,
  item.missing = TRUE,
  misspec = FALSE,
  cov.res = 0,
  relsize = 0.6
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeInpData_+3A_n">N</code></td>
<td>
<p>a numeric indicating sample size.</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_r2y">R2Y</code></td>
<td>
<p>a numeric indicating predictive power of covariates.</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_r2eta">R2eta</code></td>
<td>
<p>a numeric indicating Predictive power of latent variable</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_omega">omega</code></td>
<td>
<p>a numeric indicating the size of effect of latent factor on
the outcome.</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_tau0">tau0</code></td>
<td>
<p>a numeric indicating the size of difference in the outcome
between the treatment and the control.</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_tau1">tau1</code></td>
<td>
<p>a numeric indicating the principal effect</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_betal">betaL</code></td>
<td>
<p>a numeric vector indicating the effects of covariates on the latent factor</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_betay">betaY</code></td>
<td>
<p>a numeric vector indicating the effects of covariates on the outcome</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_linear">linear</code></td>
<td>
<p>a logical whether the relationship between the outcome and covariates is linear (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_ydist">ydist</code></td>
<td>
<p>a character indicating the outcome distribution (default is <code>n</code>).</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_lambda">lambda</code></td>
<td>
<p>a numeric indicating the mean of Worked problems/person.
(extent to which covariates predict eta).</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_nitem">nitem</code></td>
<td>
<p>a numeric indicating the number of maximum measurement items
given to students.</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_nfac">nfac</code></td>
<td>
<p>a numeric indicating the number of latent factors</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_lvmodel">lvmodel</code></td>
<td>
<p>a character specifying a type of latent variable model.</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_fcovmat">fcovmat</code></td>
<td>
<p>a matrix indicating the variance-covariance matrix of latent
factors when nfac &gt; 1</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_item.missing">item.missing</code></td>
<td>
<p>a logical to make the measurement item data missing for
the control group (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_misspec">misspec</code></td>
<td>
<p>a logical to allow cross-loadings across latent factors
when nfac &gt; 1 (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_cov.res">cov.res</code></td>
<td>
<p>a logical to allow for residual correlations
(only for CFA model) (default is <code>0</code>).</p>
</td></tr>
<tr><td><code id="makeInpData_+3A_relsize">relsize</code></td>
<td>
<p>a numeric indicating the degree to which the latent factor explain the variances of continuous items (only for CFA model) (default is <code>0.6</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing all the data related to population values and running FLPS.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sdat &lt;- makeInpData(
N       = 200,  # sample size
R2Y     = 0.2,  # r^2 of outcome
R2eta   = 0.5,  # r^2 of eta by one covariates
omega   = 0.2,  # the effect of eta
tau0    = 0.13, # direct effect
tau1    = -0.06,# interaction effect between Z and eta
betaL   = 0.2,
betaY   = 0.4,
lambda  = 0.8,  # the proportion of administered items
nitem    = 10,   # the total number of items
nfac    = 1,    # the number of latent factors
lvmodel = '2pl' )
</code></pre>

<hr>
<h2 id='makeSimData'>Generate Fully Latent Principal Stratification data for simulation</h2><span id='topic+makeSimData'></span>

<h3>Description</h3>

<p><code><a href="#topic+makeInpData">makeInpData</a></code> is a function for generating a data based on
the given information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeSimData(
  N,
  R2Y,
  R2eta,
  omega,
  tau0,
  tau1,
  betaL,
  betaY,
  linear = TRUE,
  ydist = "n",
  lambda,
  nitem,
  nfac,
  lvmodel,
  fcovmat,
  item.missing = TRUE,
  misspec = FALSE,
  cov.res = 0,
  relsize = 0.6
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeSimData_+3A_n">N</code></td>
<td>
<p>a numeric indicating sample size.</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_r2y">R2Y</code></td>
<td>
<p>a numeric indicating predictive power of covariates.</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_r2eta">R2eta</code></td>
<td>
<p>a numeric indicating Predictive power of latent variable</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_omega">omega</code></td>
<td>
<p>a numeric indicating the size of effect of latent factor on
the outcome.</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_tau0">tau0</code></td>
<td>
<p>a numeric indicating the size of difference in the outcome
between the treatment and the control.</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_tau1">tau1</code></td>
<td>
<p>a numeric indicating the principal effect</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_betal">betaL</code></td>
<td>
<p>a numeric vector indicating the effects of covariates on the latent factor</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_betay">betaY</code></td>
<td>
<p>a numeric vector indicating the effects of covariates on the outcome</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_linear">linear</code></td>
<td>
<p>a logical whether the relationship between the outcome and covariates is linear (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_ydist">ydist</code></td>
<td>
<p>a character indicating the outcome distribution (default is <code>n</code>).</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_lambda">lambda</code></td>
<td>
<p>a numeric indicating the mean of Worked problems/person.
(extent to which covariates predict eta).</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_nitem">nitem</code></td>
<td>
<p>a numeric indicating the number of maximum measurement items
given to students.</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_nfac">nfac</code></td>
<td>
<p>a numeric indicating the number of latent factors</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_lvmodel">lvmodel</code></td>
<td>
<p>a character specifying a type of latent variable model.</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_fcovmat">fcovmat</code></td>
<td>
<p>a matrix indicating the variance-covariance matrix of latent
factors when nfac &gt; 1</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_item.missing">item.missing</code></td>
<td>
<p>a logical to make the measurement item data missing for
the control group (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_misspec">misspec</code></td>
<td>
<p>a logical to allow cross-loadings across latent factors
when nfac &gt; 1 (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_cov.res">cov.res</code></td>
<td>
<p>a logical to allow for residual correlations
(only for CFA model) (default is <code>0</code>).</p>
</td></tr>
<tr><td><code id="makeSimData_+3A_relsize">relsize</code></td>
<td>
<p>a numeric indicating the degree to which the latent factor explain the variances of continuous items (only for CFA model) (default is <code>0.6</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing all the data related to population values and running FLPS.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sdat &lt;- makeSimData(
N       = 200,  # sample size
R2Y     = 0.2,  # r^2 of outcome
R2eta   = 0.5,  # r^2 of eta by one covariates
omega   = 0.2,  # the effect of eta
tau0    = 0.13, # direct effect
tau1    = -0.06,# interaction effect between Z and eta
betaL   = 0.2,
betaY   = 0.4,
lambda  = 0.8,  # the proportion of administered items
nitem    = 10,   # the total number of items
nfac    = 1,    # the number of latent factors
lvmodel = '2pl' )

</code></pre>

<hr>
<h2 id='modelBuilder'>Generate compiled Stan object to facilitate the analysis</h2><span id='topic+modelBuilder'></span>

<h3>Description</h3>

<p>Generate compiled Stan object to facilitate the analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelBuilder(lv_type, multilevel = FALSE, lv_randomeffect = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelBuilder_+3A_lv_type">lv_type</code></td>
<td>
<p>A character string specifying the type of FLPS model</p>
</td></tr>
<tr><td><code id="modelBuilder_+3A_multilevel">multilevel</code></td>
<td>
<p>a logical indicating multilevel Stan model.</p>
</td></tr>
<tr><td><code id="modelBuilder_+3A_lv_randomeffect">lv_randomeffect</code></td>
<td>
<p>A logical indicating whether to estimate random effects for latent variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>There's no return, but the compiled objects are saved in the package
root directory.
</p>

<hr>
<h2 id='plot.flps'>Plot</h2><span id='topic+plot.flps'></span>

<h3>Description</h3>

<p>Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flps'
plot(x, type = NULL, pars = c("tau0", "tau1"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.flps_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+flps">flps</a></code></p>
</td></tr>
<tr><td><code id="plot.flps_+3A_type">type</code></td>
<td>
<p>a string for the type of plot</p>
</td></tr>
<tr><td><code id="plot.flps_+3A_pars">pars</code></td>
<td>
<p>a character vector indicating the target parameters</p>
</td></tr>
<tr><td><code id="plot.flps_+3A_...">...</code></td>
<td>
<p>additional options for future development</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object that can be further customized
using the <span class="pkg">ggplot2</span> package.
</p>

<hr>
<h2 id='print.flps'>Print results</h2><span id='topic+print.flps'></span>

<h3>Description</h3>

<p>Print results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.flps_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+flps">flps</a></code></p>
</td></tr>
<tr><td><code id="print.flps_+3A_...">...</code></td>
<td>
<p>additional options for future development</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Results of FLPS model are printed via the <span class="pkg">rstan</span> package.
</p>

<hr>
<h2 id='runFLPS'>Conduct fully latent principal stratification</h2><span id='topic+runFLPS'></span>

<h3>Description</h3>

<p>Conduct fully latent principal stratification
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runFLPS(
  inp_data = NULL,
  compiled_stan = NULL,
  outcome = NULL,
  trt = NULL,
  covariate = NULL,
  lv_model = NULL,
  lv_type = NULL,
  multilevel = FALSE,
  lv_randomeffect = FALSE,
  priors_input = NULL,
  stan_options = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runFLPS_+3A_inp_data">inp_data</code></td>
<td>
<p>A matrix or data frame containing the input data.</p>
</td></tr>
<tr><td><code id="runFLPS_+3A_compiled_stan">compiled_stan</code></td>
<td>
<p>An object of S4 class stanmodel produced by the
<code>modelBuilder</code> function.</p>
</td></tr>
<tr><td><code id="runFLPS_+3A_outcome">outcome</code></td>
<td>
<p>A character string specifying the outcome variable's name.</p>
</td></tr>
<tr><td><code id="runFLPS_+3A_trt">trt</code></td>
<td>
<p>A character string specifying the treatment or control group variable's name.</p>
</td></tr>
<tr><td><code id="runFLPS_+3A_covariate">covariate</code></td>
<td>
<p>A character string specifying the covariate variable names.</p>
</td></tr>
<tr><td><code id="runFLPS_+3A_lv_model">lv_model</code></td>
<td>
<p>A description of the latent variable model using syntax
akin to the <span class="pkg">lavaan</span> package. Key operators include:
</p>

<ul>
<li> <p><code>=~</code> : Denotes associations between factors and indicators (e.g., F1 =~ v1 + v2 + v3). All indicators associated with the corresponding factor should be
written in the same line with <code>+</code>.
</p>
</li>
<li> <p><code>+</code> : Specifies a series of indicators.
</p>
</li></ul>
</td></tr>
<tr><td><code id="runFLPS_+3A_lv_type">lv_type</code></td>
<td>
<p>A character string indicating the type of latent variable models.</p>
</td></tr>
<tr><td><code id="runFLPS_+3A_multilevel">multilevel</code></td>
<td>
<p>A logical indicating if a multilevel structure is present.</p>
</td></tr>
<tr><td><code id="runFLPS_+3A_lv_randomeffect">lv_randomeffect</code></td>
<td>
<p>A logical indicating whether to estimate random effects for latent variables.</p>
</td></tr>
<tr><td><code id="runFLPS_+3A_priors_input">priors_input</code></td>
<td>
<p>A list specifying the priors or defaults to N(0, 5) if not provided.
Relevant parameters: <code>tau0</code> (group difference), <code>tau1</code> (principal effects),
and <code>omega</code> (effect of latent factors on outcome).
Ensure that the lengths of <code>tau1</code> and <code>omega</code> match the number of factors.
Examples:
</p>

<ul>
<li> <p><code>list(tau0 = c(0, 1), tau1 = c(0.5, 1))</code> : Mean and variance for normal priors.
</p>
</li>
<li> <p><code>list(tau1 = list(c(0.5, 1), c(-0.4, 1)))</code> : For two factors.
</p>
</li></ul>
</td></tr>
<tr><td><code id="runFLPS_+3A_stan_options">stan_options</code></td>
<td>
<p>A list of options for [rstan::stan()], specified as 'name = value'.</p>
</td></tr>
<tr><td><code id="runFLPS_+3A_...">...</code></td>
<td>
<p>Additional parameters for the latent variable models, such as <code>nclass = 2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>flps</code> encompassing a <code><a href="rstan.html#topic+stanfit">stanfit</a></code> object.
Components include:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>Function call with arguments.</p>
</td></tr>
<tr><td><code>inp_data</code></td>
<td>
<p>The input data frame provided.</p>
</td></tr>
<tr><td><code>flps_model</code></td>
<td>
<p>The Stan syntax used in [rstan::stan()].</p>
</td></tr>
<tr><td><code>flps_data</code></td>
<td>
<p>Data list used for [rstan::stan()].</p>
</td></tr>
<tr><td><code>flps_fit</code></td>
<td>
<p>Resulting <code><a href="rstan.html#topic+stanfit">stanfit</a></code> object.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>A numeric; Time taken for computation</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>[rstan::stan()]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
inp_data &lt;- flps::makeInpData(
  N       = 200,
  R2Y     = 0.2,
  R2eta   = 0.5,
  omega   = 0.2,
  tau0    = 0.23,
  tau1    = -0.16,
  betaL   = 0.1,
  betaY   = 0.2,
  lambda  = 0.8,
  nitem    = 10,
  nfac    = 1,
  lvmodel = 'rasch' )

res &lt;- runFLPS(
   inp_data = inp_data,
   outcome = "Y",
   trt = "Z",
   covariate = c("X1"),
   lv_type = "rasch",
   lv_model = "F =~ v1 + v2 + v3 + v4 + v5 + v6 + v7 + v8 + v9 + v10",
   stan_options = list(iter = 1000, warmup = 500, cores = 1, chains = 2)
   )


</code></pre>

<hr>
<h2 id='summary.flps'>Summarize the results</h2><span id='topic+summary.flps'></span>

<h3>Description</h3>

<p>Summarize the results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flps'
summary(object, type = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.flps_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+flps">flps</a></code></p>
</td></tr>
<tr><td><code id="summary.flps_+3A_type">type</code></td>
<td>
<p>a string for the part of FLPS model</p>
</td></tr>
<tr><td><code id="summary.flps_+3A_...">...</code></td>
<td>
<p>additional options for future development</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary of FLPS model are printed via the <span class="pkg">rstan</span> package.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
