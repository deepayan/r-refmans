<!DOCTYPE html><html lang="en-US"><head><title>Help for package httpcache</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {httpcache}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#buildCacheKey'><p>Construct a unique cache key for a request</p></a></li>
<li><a href='#cache-api'><p>HTTP Cache API</p></a></li>
<li><a href='#cache-management'><p>Manage the HTTP cache</p></a></li>
<li><a href='#cached-http-verbs'><p>Cache-aware versions of httr verbs</p></a></li>
<li><a href='#cachedPOST'><p>Cache the response of a POST</p></a></li>
<li><a href='#cacheLogSummary'><p>Summarize cache performance from a log</p></a></li>
<li><a href='#dropCache'><p>Invalidate cache</p></a></li>
<li><a href='#halt'><p>Stop, log, and no call</p></a></li>
<li><a href='#loadLogfile'><p>Read in a httpcache log file</p></a></li>
<li><a href='#logMessage'><p>Log a message</p></a></li>
<li><a href='#requestLogSummary'><p>Summarize HTTP requests from a log</p></a></li>
<li><a href='#saveCache'><p>Save and load cache state</p></a></li>
<li><a href='#startLog'><p>Enable logging</p></a></li>
<li><a href='#uncached'><p>Context manager to temporarily turn cache off if it is on</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Query Cache for HTTP Clients</td>
</tr>
<tr>
<td>Description:</td>
<td>In order to improve performance for HTTP API clients, 'httpcache'
    provides simple tools for caching and invalidating cache. It includes the
    HTTP verb functions GET, PUT, PATCH, POST, and DELETE, which are drop-in
    replacements for those in the 'httr' package. These functions are cache-aware
    and provide default settings for cache invalidation suitable for RESTful
    APIs; the package also enables custom cache-management strategies.
    Finally, 'httpcache' includes a basic logging framework to facilitate the
    measurement of HTTP request time and cache performance.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://enpiar.com/r/httpcache/">https://enpiar.com/r/httpcache/</a>,
<a href="https://github.com/nealrichardson/httpcache/">https://github.com/nealrichardson/httpcache/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nealrichardson/httpcache/issues">https://github.com/nealrichardson/httpcache/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>digest, httr (&ge; 1.0.0), utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>httptest (&ge; 3.0.0), knitr, rmarkdown, spelling</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-10 21:17:00 UTC; enpiar</td>
</tr>
<tr>
<td>Author:</td>
<td>Neal Richardson [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Neal Richardson &lt;neal.p.richardson@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-10 23:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='buildCacheKey'>Construct a unique cache key for a request</h2><span id='topic+buildCacheKey'></span>

<h3>Description</h3>

<p>This function encapsulates the logic of making a cache key, allowing other
code or libraries to access the HTTP cache programmatically.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildCacheKey(url, query = NULL, body = NULL, extras = c())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buildCacheKey_+3A_url">url</code></td>
<td>
<p>character request URL</p>
</td></tr>
<tr><td><code id="buildCacheKey_+3A_query">query</code></td>
<td>
<p>Optional query parameters for the request</p>
</td></tr>
<tr><td><code id="buildCacheKey_+3A_body">body</code></td>
<td>
<p>Optional request body</p>
</td></tr>
<tr><td><code id="buildCacheKey_+3A_extras">extras</code></td>
<td>
<p>character Optional additional annotations to include in the
cache key.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character value, starting with <code>url</code> and including hashed query
and body values if provided, to be used as the cache key for this request.
</p>

<hr>
<h2 id='cache-api'>HTTP Cache API</h2><span id='topic+cache-api'></span><span id='topic+hitCache'></span><span id='topic+getCache'></span><span id='topic+setCache'></span>

<h3>Description</h3>

<p>These functions provide access to what's stored in the cache.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hitCache(key)

getCache(key)

setCache(key, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cache-api_+3A_key">key</code></td>
<td>
<p>character, typically a URL or similar</p>
</td></tr>
<tr><td><code id="cache-api_+3A_value">value</code></td>
<td>
<p>For <code>setCache</code>, an R object to set in the cache for <code>key</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>hitCache</code> returns logical whether <code>key</code> exists in the
cache. <code>getCache</code> returns the value stored in the cache, or <code>NULL</code>
if there is nothing cached. <code>setCache</code> is called for its side effects.
</p>

<hr>
<h2 id='cache-management'>Manage the HTTP cache</h2><span id='topic+cache-management'></span><span id='topic+cacheOn'></span><span id='topic+cacheOff'></span><span id='topic+clearCache'></span>

<h3>Description</h3>

<p>These functions turn the cache on and off and clear the contents of the
query cache.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cacheOn()

cacheOff()

clearCache()
</code></pre>


<h3>Value</h3>

<p>Nothing. Functions are run for their side effects.
</p>

<hr>
<h2 id='cached-http-verbs'>Cache-aware versions of httr verbs</h2><span id='topic+cached-http-verbs'></span><span id='topic+GET'></span><span id='topic+PUT'></span><span id='topic+POST'></span><span id='topic+PATCH'></span><span id='topic+DELETE'></span>

<h3>Description</h3>

<p>These functions set, read from, and bust the HTTP query cache. They wrap
the similarly named functions in the httr package and can be used as
drop-in replacements for them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GET(url, ...)

PUT(url, ..., drop = dropCache(url))

POST(url, ..., drop = dropOnly(url))

PATCH(url, ..., drop = dropCache(url))

DELETE(url, ..., drop = dropCache(url))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cached-http-verbs_+3A_url">url</code></td>
<td>
<p>character URL of the request</p>
</td></tr>
<tr><td><code id="cached-http-verbs_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the httr functions</p>
</td></tr>
<tr><td><code id="cached-http-verbs_+3A_drop">drop</code></td>
<td>
<p>For <code>PUT</code>, <code>PATCH</code>, <code>POST</code>, and <code>DELETE</code>,
code to be executed after the request. This is intended to be for supplying
cache-invalidation logic. By default, <code>POST</code> drops cache only for
the specified <code>url</code> (i.e. <code><a href="#topic+dropOnly">dropOnly()</a></code>), while the other
verbs drop cache for the request URL and for any URLs nested below it
(i.e. <code><a href="#topic+dropCache">dropCache()</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>GET</code> checks the cache before making an HTTP request, and if there is a cache
miss, it sets the response from the request into the cache for future
requests. The other verbs, assuming a more or less RESTful API, would be
assumed to modify server state, and thus they should trigger cache
invalidation. They have default cache-invalidation strategies, but you can
override them as desired.
</p>


<h3>Value</h3>

<p>The corresponding httr response object, potentially read from cache
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dropCache">dropCache()</a></code> <code><a href="#topic+cachedPOST">cachedPOST()</a></code>
</p>

<hr>
<h2 id='cachedPOST'>Cache the response of a POST</h2><span id='topic+cachedPOST'></span>

<h3>Description</h3>

<p>Some APIs have resources where a POST is used to send a command that returns
content and doesn't modify state. In this case, it's more like a GET. This
may occur where one might normally GET but the request URI would be too long
for the server to accept. <code>cachedPOST</code> thus behaves more like
<code>GET</code>, checking for a cached response before performing the request and
setting cache if the request is successful. It does no cache dropping, unlike
<code><a href="#topic+POST">POST()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cachedPOST(url, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cachedPOST_+3A_url">url</code></td>
<td>
<p>character URL of the request</p>
</td></tr>
<tr><td><code id="cachedPOST_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the httr functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The corresponding httr response object, potentially read from cache
</p>

<hr>
<h2 id='cacheLogSummary'>Summarize cache performance from a log</h2><span id='topic+cacheLogSummary'></span>

<h3>Description</h3>

<p>Summarize cache performance from a log
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cacheLogSummary(logdf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cacheLogSummary_+3A_logdf">logdf</code></td>
<td>
<p>A logging data.frame, as loaded by <code><a href="#topic+loadLogfile">loadLogfile()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing counts of cache hit/set/drop events, plus a
cache hit rate.
</p>

<hr>
<h2 id='dropCache'>Invalidate cache</h2><span id='topic+dropCache'></span><span id='topic+dropOnly'></span><span id='topic+dropPattern'></span>

<h3>Description</h3>

<p>These functions let you control cache invalidation. <code>dropOnly</code>
invalidates cache only for the specified URL. <code>dropPattern</code> uses
regular expression matching to invalidate cache. <code>dropCache</code> is a
convenience wrapper around <code>dropPattern</code> that invalidates cache for
any resources that start with the given URL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dropCache(x)

dropOnly(x)

dropPattern(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dropCache_+3A_x">x</code></td>
<td>
<p>character URL or regular expression</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing. Functions are run for their side effects.
</p>

<hr>
<h2 id='halt'>Stop, log, and no call</h2><span id='topic+halt'></span>

<h3>Description</h3>

<p>Wrapper around <code><a href="base.html#topic+stop">base::stop()</a></code> that logs the error message and then stops
with call.=FALSE by default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>halt(..., call. = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="halt_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>stop</code></p>
</td></tr>
<tr><td><code id="halt_+3A_call.">call.</code></td>
<td>
<p>logical: print the call? Default is <code>FALSE</code>, unlike <code>stop</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing. Raises an error.
</p>

<hr>
<h2 id='loadLogfile'>Read in a httpcache log file</h2><span id='topic+loadLogfile'></span>

<h3>Description</h3>

<p>Read in a httpcache log file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadLogfile(filename, scope = c("CACHE", "HTTP"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadLogfile_+3A_filename">filename</code></td>
<td>
<p>character name of the log file, passed to
<code><a href="utils.html#topic+read.table">utils::read.delim()</a></code></p>
</td></tr>
<tr><td><code id="loadLogfile_+3A_scope">scope</code></td>
<td>
<p>character optional means of selecting only certain log
messages. By default, only &quot;CACHE&quot; and &quot;HTTP&quot; log messages are kept. Other
logged messages, such as &quot;ERROR&quot; messages from <code><a href="#topic+halt">halt()</a></code>, will be
dropped from the resulting data.frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame of log results.
</p>

<hr>
<h2 id='logMessage'>Log a message</h2><span id='topic+logMessage'></span>

<h3>Description</h3>

<p>Log a message
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logMessage(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logMessage_+3A_...">...</code></td>
<td>
<p>Strings to pass to <code><a href="base.html#topic+cat">base::cat()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>

<hr>
<h2 id='requestLogSummary'>Summarize HTTP requests from a log</h2><span id='topic+requestLogSummary'></span>

<h3>Description</h3>

<p>Summarize HTTP requests from a log
</p>


<h3>Usage</h3>

<pre><code class='language-R'>requestLogSummary(logdf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="requestLogSummary_+3A_logdf">logdf</code></td>
<td>
<p>A logging data.frame, as loaded by <code><a href="#topic+loadLogfile">loadLogfile()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing counts of HTTP requests by verb, as well as
summaries of time spent waiting on HTTP requests.
</p>

<hr>
<h2 id='saveCache'>Save and load cache state</h2><span id='topic+saveCache'></span><span id='topic+loadCache'></span>

<h3>Description</h3>

<p>Warm your query cache from a previous session by saving out the cache and
loading it back in.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveCache(file)

loadCache(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveCache_+3A_file">file</code></td>
<td>
<p>character file path to write the cache data to, in <code>.rds</code> format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing; called for side effects.
</p>

<hr>
<h2 id='startLog'>Enable logging</h2><span id='topic+startLog'></span>

<h3>Description</h3>

<p>Enable logging
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startLog(filename = "", append = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="startLog_+3A_filename">filename</code></td>
<td>
<p>character: a filename/path where the log can be written out.
If <code>""</code>, messages will print to <code>stdout</code> (the screen). See <code><a href="base.html#topic+cat">base::cat()</a></code>.</p>
</td></tr>
<tr><td><code id="startLog_+3A_append">append</code></td>
<td>
<p>logical: if the file already exists, append to it? Default
is <code>FALSE</code>, and if not in append mode, if the <code>filename</code> exists,
it will be deleted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing.
</p>

<hr>
<h2 id='uncached'>Context manager to temporarily turn cache off if it is on</h2><span id='topic+uncached'></span>

<h3>Description</h3>

<p>If you don't want to store the response of a GET request in the cache,
wrap it in <code>uncached()</code>. It will neither read from nor write to cache.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uncached(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uncached_+3A_...">...</code></td>
<td>
<p>Things to evaluate with caching off</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>uncached</code> will not invalidate cache records, if present. It only ignores
them.
</p>


<h3>Value</h3>

<p>Whatever ... returns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>uncached(GET("http://httpbin.org/get"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
