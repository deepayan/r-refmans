<!DOCTYPE html><html><head><title>Help for package diffudist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {diffudist}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eigenMapMatMult'><p>Matrix Multiplication using RcppEigen</p></a></li>
<li><a href='#eigenMatMult'><p>Matrix Multiplication using RcppEigen</p></a></li>
<li><a href='#get_ddm_from_eigendec'><p>Distance Matrix from Laplacian spectral decomposition</p></a></li>
<li><a href='#get_diffusion_probability_matrix'><p>Diffusion Probability Matrix</p></a></li>
<li><a href='#get_diffusion_probability_matrix_from_T'><p>Diffusion probability matrix from transition matrix</p></a></li>
<li><a href='#get_distance_matrix'><p>Diffusion Distance Matrix</p></a></li>
<li><a href='#get_distance_matrix_from_T'><p>Diffusion distance matrix from a custom transition matrix</p></a></li>
<li><a href='#get_laplacian'><p>Evaluate a Laplacian Matrix</p></a></li>
<li><a href='#get_mean_distance_matrix'><p>Mean distance matrix</p></a></li>
<li><a href='#get_spectral_decomp'><p>Laplacian Spectral Decomposition</p></a></li>
<li><a href='#plot_distance_matrix'><p>Plot distance matrix</p></a></li>
<li><a href='#plotHeatmap'><p>Plot distance matrix as heatmap</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Diffusion Distance for Complex Networks</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gbertagnolli.github.io/diffudist/">https://gbertagnolli.github.io/diffudist/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gbertagnolli/diffudist/issues/">https://github.com/gbertagnolli/diffudist/issues/</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Enables the evaluation of diffusion distances for complex single-layer networks.
    Given a network one can define different types of Laplacian (or transition)
    matrices corresponding to different continuous-time random walks dynamics on the network. 
    This package enables the evaluation of Laplacians, stochastic matrices, and the 
    corresponding diffusion distance matrices. The metric structure induced by the network-driven
    process is richer and more robust than the one given by shortest-paths and allows to study 
    the geometry induced by different types of diffusion-like communication mechanisms taking 
    place on complex networks. 
    For more details see: De Domenico, M. (2017) &lt;<a href="https://doi.org/10.1103%2Fphysrevlett.118.168301">doi:10.1103/physrevlett.118.168301</a>&gt; and 
    Bertagnolli, G. and De Domenico, M. (2021) &lt;<a href="https://doi.org/10.1103%2FPhysRevE.103.042301">doi:10.1103/PhysRevE.103.042301</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>expm, ggdendro, ggplot2, grid, igraph, Matrix, stats,
RColorBrewer, Rcpp (&ge; 1.0.10), reshape2, rlang, viridis</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, cowplot, parallelDist, strex, tidyr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-27 10:16:57 UTC; giulia</td>
</tr>
<tr>
<td>Author:</td>
<td>Giulia Bertagnolli
    <a href="https://orcid.org/0000-0001-8637-0632"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Manlio De Domenico
    <a href="https://orcid.org/0000-0001-5158-8594"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giulia Bertagnolli &lt;giulia.bertagnolli@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-27 19:42:40 UTC</td>
</tr>
</table>
<hr>
<h2 id='eigenMapMatMult'>Matrix Multiplication using RcppEigen</h2><span id='topic+eigenMapMatMult'></span>

<h3>Description</h3>

<p>Matrix multiplication of the two matrices in input, without copy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenMapMatMult(A, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigenMapMatMult_+3A_a">A</code></td>
<td>
<p>numeric matrix of dimension <code class="reqn">m \times n</code></p>
</td></tr>
<tr><td><code id="eigenMapMatMult_+3A_b">B</code></td>
<td>
<p>numeric matrix of dimension <code class="reqn">n \times l</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>C matrix of dimension <code class="reqn">m \times p</code> of the row-column product of A and B and C
</p>

<hr>
<h2 id='eigenMatMult'>Matrix Multiplication using RcppEigen</h2><span id='topic+eigenMatMult'></span>

<h3>Description</h3>

<p>Matrix multiplication of the two matrices in input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenMatMult(A, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigenMatMult_+3A_a">A</code></td>
<td>
<p>numeric matrix of dimension <code class="reqn">m \times n</code></p>
</td></tr>
<tr><td><code id="eigenMatMult_+3A_b">B</code></td>
<td>
<p>numeric matrix of dimension <code class="reqn">n \times l</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>C matrix of dimension <code class="reqn">m \times p</code> of the row-column product of A and B and C
</p>

<hr>
<h2 id='get_ddm_from_eigendec'>Distance Matrix from Laplacian spectral decomposition</h2><span id='topic+get_ddm_from_eigendec'></span>

<h3>Description</h3>

<p>Returns the diffusion distance matrix when the spectrum (more precisely,
the eigendecomposition) of the Laplacian is provided as
input (useful to speed up batch calculations).
</p>
<p>For instance, the random walk normalised Laplacian <code class="reqn">I - D^{-1}A</code>,
which generates the classical continuous-time random walk over a network,
can be easily and obtained from the spectral decomposition of the symmetric
normalised Laplacian
<code class="reqn">\mathcal{L} = D^{-\frac{1}{2}} L D^{-\frac{1}{2}} = D^{-\frac{1}{2}} (D - A) D^{-\frac{1}{2}}</code>.
More specifically,
<code class="reqn">\bar{L} = I - D^{-1} A = D^{-\frac{1}{2}} \mathcal{L} D^{\frac{1}{2}}</code>
and, since <code class="reqn">\mathcal{L}</code> is symmetric it can be decomposed into
<code class="reqn">\mathcal{L} = \sum_{l = 1}^N \lambda_l u_l u_l^T</code>, hence
</p>
<p style="text-align: center;"><code class="reqn">\bar{L} = \sum_{l = 1}^N \lambda_l u^R_l u^L_l</code>
</p>
<p> where
<code class="reqn">u^L_l = u_l^T D^{\frac{1}{2}}</code> and <code class="reqn">u^R_l = u_l D^{-\frac{1}{2}}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ddm_from_eigendec(tau, Q, Q_inv, lambdas, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ddm_from_eigendec_+3A_tau">tau</code></td>
<td>
<p>diffusion time (scalar)</p>
</td></tr>
<tr><td><code id="get_ddm_from_eigendec_+3A_q">Q</code></td>
<td>
<p>eigenvector matrix</p>
</td></tr>
<tr><td><code id="get_ddm_from_eigendec_+3A_q_inv">Q_inv</code></td>
<td>
<p>inverse of the eigenvector matrix</p>
</td></tr>
<tr><td><code id="get_ddm_from_eigendec_+3A_lambdas">lambdas</code></td>
<td>
<p>eigenvalues (vector)</p>
</td></tr>
<tr><td><code id="get_ddm_from_eigendec_+3A_verbose">verbose</code></td>
<td>
<p>whether warnings have to be printed or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The diffusion distance matrix <code class="reqn">D_t</code>, a square numeric matrix
of the Euclidean distances between the rows of the stochastic matrix
<code class="reqn">P(t) = e^{-\tau L}</code>, where <code class="reqn">-L</code> is the Laplacian generating a
continuous-time random walk (Markov chain) over the network.
The matrix exponential is here computed using the given eigendecomposition
of the Laplacian matrix <code class="reqn">e^{-\tau L} = Q e^{-\tau \Lambda} Q^{-1}</code>.
</p>


<h3>References</h3>

<p>Bertagnolli, G., &amp; De Domenico, M. (2021). Diffusion geometry of multiplex and
interdependent systems. Physical Review E, 103(4), 042301.
<a href="https://doi.org/10.1103/PhysRevE.103.042301">doi:10.1103/PhysRevE.103.042301</a>
<a href="https://arxiv.org/abs/2006.13032">arXiv: 2006.13032</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_spectral_decomp">get_spectral_decomp</a></code>
</p>

<hr>
<h2 id='get_diffusion_probability_matrix'>Diffusion Probability Matrix</h2><span id='topic+get_diffusion_probability_matrix'></span><span id='topic+getDiffusionProbabilityMatrix'></span><span id='topic+get_diffu_Pt'></span>

<h3>Description</h3>

<p>Returns a matrix where each entry encodes the diffusion probability between two nodes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_diffusion_probability_matrix(
  g,
  tau,
  type = "Normalized Laplacian",
  weights = NULL,
  verbose = TRUE
)

getDiffusionProbabilityMatrix(g, tau, type = "Normalized Laplacian", weights = NULL,
                                     verbose = TRUE)

get_diffu_Pt(
  g,
  tau,
  type = "Normalized Laplacian",
  weights = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_diffusion_probability_matrix_+3A_g">g</code></td>
<td>
<p>a single-layer network</p>
</td></tr>
<tr><td><code id="get_diffusion_probability_matrix_+3A_tau">tau</code></td>
<td>
<p>diffusion time</p>
</td></tr>
<tr><td><code id="get_diffusion_probability_matrix_+3A_type">type</code></td>
<td>
<p>default &quot;Normalized Laplacian&quot;. The type of Laplacian (i.e. of
dynamics) to consider. Other types available are:
</p>

<dl>
<dt>Laplacian</dt><dd><p>for the classical combinatorial Laplacian matrix;
it governs the diffusion dynamics on the network</p>
</dd>
<dt>Normalized Laplacian</dt><dd><p>for the Laplacian matrix normalized by degree
matrix, the so-called classical random walk normalized Laplacian;
it governs stochastic walks on the network</p>
</dd>
<dt>Quantum Laplacian</dt><dd><p>for the Laplacian matrix normalized to be
symmetric; it governs quantum walks on the network</p>
</dd>
<dt>MERW normalized Laplacian</dt><dd><p>the maximal-entropy random walk (RW)
normalized Laplacian; it governs stochastic walks on the network,
in which the random walker moves according to a maximal-entropy RW [1].</p>
</dd>
</dl>

<p>Note that you can type abbreviations, e.g. &quot;L&quot;, &quot;N&quot;, &quot;Q&quot;, &quot;M&quot; for the
respective types (case is ignored). The argument match is done through
<code><a href="strex.html#topic+match_arg">match_arg</a></code>.</p>
</td></tr>
<tr><td><code id="get_diffusion_probability_matrix_+3A_weights">weights</code></td>
<td>
<p>edge weights, representing the strength/intensity (not the cost!) of each link.
if weights is NULL (the default) and g has an edge attribute called weight, then
it will be used automatically.
If this is NA then no weights are used (even if the graph has a weight attribute).</p>
</td></tr>
<tr><td><code id="get_diffusion_probability_matrix_+3A_verbose">verbose</code></td>
<td>
<p>default <code>TRUE</code>. If information on the type of Laplacian
or on edge weights should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix <code class="reqn">exp^{-\tau L}</code>, exponential of a Laplacian matrix.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>getDiffusionProbabilityMatrix()</code>: Old deprecated function
</p>
</li></ul>


<h3>References</h3>

<p>De Domenico, M. (2017). Diffusion Geometry Unravels the Emergence of
Functional Clusters in Collective Phenomena. Physical Review Letters.
<a href="https://doi.org/10.1103/PhysRevLett.118.168301">doi:10.1103/PhysRevLett.118.168301</a>
</p>
<p>Bertagnolli, G., &amp; De Domenico, M. (2021). Diffusion geometry of multiplex and
interdependent systems. Physical Review E, 103(4), 042301.
<a href="https://doi.org/10.1103/PhysRevE.103.042301">doi:10.1103/PhysRevE.103.042301</a>
<a href="https://arxiv.org/abs/2006.13032">arXiv: 2006.13032</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_laplacian">get_laplacian</a>, <a href="#topic+get_distance_matrix">get_distance_matrix</a></code>
</p>

<hr>
<h2 id='get_diffusion_probability_matrix_from_T'>Diffusion probability matrix from transition matrix</h2><span id='topic+get_diffusion_probability_matrix_from_T'></span><span id='topic+get_diffu_Pt_from_T'></span><span id='topic+get_diffu_Pt_from_Pi'></span><span id='topic+get_diffusion_probability_matrix_from_Pi'></span>

<h3>Description</h3>

<p>Description here
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_diffusion_probability_matrix_from_T(Pi, tau)

get_diffu_Pt_from_T(Pi, tau)

get_diffu_Pt_from_Pi(Pi, tau)

get_diffusion_probability_matrix_from_Pi(Pi, tau)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_diffusion_probability_matrix_from_T_+3A_pi">Pi</code></td>
<td>
<p>Transition matrix. We do not use <code>T</code> to avoid conflicts
with the abbreviation for <code>TRUE</code>), instead we indicated the transition
matrix with the capital greek letter <code class="reqn">\Pi</code> in the equations and
<code>Pi</code> in the code.</p>
</td></tr>
<tr><td><code id="get_diffusion_probability_matrix_from_T_+3A_tau">tau</code></td>
<td>
<p>diffusion time</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code class="reqn">exp^{-\tau (I - \Pi)}</code>, exponential of the normalized Laplacian
matrix corresponding to the given transition rate matrix (or transition
probability matrix of a discrete-time Markov chain).
</p>


<h3>References</h3>

<p>De Domenico, M. (2017). Diffusion Geometry Unravels the Emergence of
Functional Clusters in Collective Phenomena. Physical Review Letters.
<a href="https://doi.org/10.1103/PhysRevLett.118.168301">doi:10.1103/PhysRevLett.118.168301</a>
</p>
<p>Bertagnolli, G., &amp; De Domenico, M. (2020). Diffusion Geometry of Multiplex
and Interdependent Systems.
<a href="https://arxiv.org/abs/2006.13032">arxiv preprint arxiv:2006.13032</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_diffusion_probability_matrix">get_diffusion_probability_matrix</a></code>
</p>

<hr>
<h2 id='get_distance_matrix'>Diffusion Distance Matrix</h2><span id='topic+get_distance_matrix'></span><span id='topic+getDistanceMatrix'></span><span id='topic+get_DDM'></span>

<h3>Description</h3>

<p>Returns a matrix where each entry encodes the diffusion distance
between two nodes of a network.
</p>
<p>The diffusion distance at time <code class="reqn">\tau</code> between nodes <code class="reqn">i, j \in G</code>
is defined as
</p>
<p style="text-align: center;"><code class="reqn">D_{\tau}(i, j) = \vert \mathbf{p}(t|i) - \mathbf{p}(t|j) \vert_2</code>
</p>

<p>with <code class="reqn">\mathbf{p}(t|i) = (e^{- \tau L})_{i\cdot} = \mathbf{e}_i e^{- \tau L}</code>
indicating the i-th row of the stochastic matrix <code class="reqn">e^{- \tau L}</code> and
representing the probability (row) vector of a random walk dynamics
corresponding to the initial condition <code class="reqn">\mathbf{e}_i</code>, i.e. the random
walker is in node <code class="reqn">i</code> at time <code class="reqn">\tau = 0</code> with probability 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_distance_matrix(
  g,
  tau,
  type = "Normalized Laplacian",
  weights = NULL,
  as_dist = FALSE,
  verbose = TRUE
)

getDistanceMatrix(g, tau, type = "Normalized Laplacian", weights = NULL,
                         verbose = TRUE)

get_DDM(
  g,
  tau,
  type = "Normalized Laplacian",
  weights = NULL,
  as_dist = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_distance_matrix_+3A_g">g</code></td>
<td>
<p>a (single-layer) network</p>
</td></tr>
<tr><td><code id="get_distance_matrix_+3A_tau">tau</code></td>
<td>
<p>diffusion time</p>
</td></tr>
<tr><td><code id="get_distance_matrix_+3A_type">type</code></td>
<td>
<p>default &quot;Normalized Laplacian&quot;. The type of Laplacian (i.e. of
dynamics) to consider. Other types available are:
</p>

<dl>
<dt>Laplacian</dt><dd><p>for the classical combinatorial Laplacian matrix;
it governs the diffusion dynamics on the network</p>
</dd>
<dt>Normalized Laplacian</dt><dd><p>for the Laplacian matrix normalized by degree
matrix, the so-called classical random walk normalized Laplacian;
it governs stochastic walks on the network</p>
</dd>
<dt>Quantum Laplacian</dt><dd><p>for the Laplacian matrix normalized to be
symmetric; it governs quantum walks on the network</p>
</dd>
<dt>MERW normalized Laplacian</dt><dd><p>the maximal-entropy random walk (RW)
normalized Laplacian; it governs stochastic walks on the network,
in which the random walker moves according to a maximal-entropy RW [1].</p>
</dd>
</dl>

<p>Note that you can type abbreviations, e.g. &quot;L&quot;, &quot;N&quot;, &quot;Q&quot;, &quot;M&quot; for the
respective types (case is ignored). The argument match is done through
<code><a href="strex.html#topic+match_arg">match_arg</a></code>.</p>
</td></tr>
<tr><td><code id="get_distance_matrix_+3A_weights">weights</code></td>
<td>
<p>edge weights, representing the strength/intensity (not the cost!)
of each link. If weights is NULL (the default) and g has an edge attribute
called weight, then it will be used automatically.
If this is NA then no weights are used (even if the graph has a weight attribute).</p>
</td></tr>
<tr><td><code id="get_distance_matrix_+3A_as_dist">as_dist</code></td>
<td>
<p>If the function should return a matrix or an object of class &quot;dist&quot; as
returned from [stats::as.dist]. Default is FALSE if the number of nodes is smaller
than 1000.</p>
</td></tr>
<tr><td><code id="get_distance_matrix_+3A_verbose">verbose</code></td>
<td>
<p>default TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The diffusion distance matrix <code class="reqn">D_t</code>, a square numeric matrix
of the <code class="reqn">L^2</code>-norm distances between posterior probability vectors, i.e.
Euclidean distances between the rows of the stochastic matrix
<code class="reqn">P(t) = e^{-\tau L}</code>, where <code class="reqn">-L = -(I - T)</code> is the generator of the
continuous-time random walk (Markov chain) of given <code>type</code> over network
<code>g</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>getDistanceMatrix()</code>: Old deprecated function
</p>
</li></ul>


<h3>References</h3>

<p>De Domenico, M. (2017). Diffusion Geometry Unravels the Emergence of
Functional Clusters in Collective Phenomena. Physical Review Letters.
<a href="https://doi.org/10.1103/PhysRevLett.118.168301">doi:10.1103/PhysRevLett.118.168301</a>
</p>
<p>Bertagnolli, G., &amp; De Domenico, M. (2021). Diffusion geometry of multiplex and
interdependent systems. Physical Review E, 103(4), 042301.
<a href="https://doi.org/10.1103/PhysRevE.103.042301">doi:10.1103/PhysRevE.103.042301</a>
<a href="https://arxiv.org/abs/2006.13032">arXiv: 2006.13032</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_diffusion_probability_matrix">get_diffusion_probability_matrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>g &lt;- igraph::sample_pa(10, directed = FALSE)
dm_crw &lt;- get_distance_matrix(g, tau = 1)
dm_merw &lt;- get_distance_matrix(g, tau = 1, type = "MERW")
</code></pre>

<hr>
<h2 id='get_distance_matrix_from_T'>Diffusion distance matrix from a custom transition matrix</h2><span id='topic+get_distance_matrix_from_T'></span><span id='topic+get_DDM_from_T'></span><span id='topic+get_distance_matrix_from_Pi'></span><span id='topic+get_DDM_from_Pi'></span>

<h3>Description</h3>

<p>Returns a matrix where each entry encodes the diffusion distance
between two nodes of a network, given a transition matrix on the network
and a diffusion time.
</p>
<p>The diffusion distance at time <code class="reqn">\tau</code> between nodes <code class="reqn">i, j \in G</code>
is defined as
</p>
<p style="text-align: center;"><code class="reqn">D_{\tau}(i, j) = \vert \mathbf{p}(t|i) - \mathbf{p}(t|j) \vert_2</code>
</p>

<p>with <code class="reqn">\mathbf{p}(t|i) = (e^{- \tau L})_{i\cdot} = \mathbf{e}_i e^{- \tau L}</code>
indicating the i-th row of the stochastic matrix <code class="reqn">e^{- \tau L}</code> and
representing the probability (row) vector of a random walk dynamics
corresponding to the initial condition <code class="reqn">\mathbf{e}_i</code>, i.e. the random
walker is in node <code class="reqn">i</code> at time <code class="reqn">\tau = 0</code> with probability 1.
</p>
<p>The Laplacian <code class="reqn">L</code> is the normalised laplacian corresponding to the
given transition matrix, i.e. <code class="reqn">L = I - Pi</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_distance_matrix_from_T(Pi, tau, verbose = TRUE)

get_DDM_from_T(Pi, tau, verbose = TRUE)

get_distance_matrix_from_Pi(Pi, tau, verbose = TRUE)

get_DDM_from_Pi(Pi, tau, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_distance_matrix_from_T_+3A_pi">Pi</code></td>
<td>
<p>a transition matrix (it should be a stochastic matrix)</p>
</td></tr>
<tr><td><code id="get_distance_matrix_from_T_+3A_tau">tau</code></td>
<td>
<p>diffusion time</p>
</td></tr>
<tr><td><code id="get_distance_matrix_from_T_+3A_verbose">verbose</code></td>
<td>
<p>default TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The diffusion distance matrix <code class="reqn">D_t</code>, a square numeric matrix
of the <code class="reqn">L^2</code>-norm distances between posterior probability vectors, i.e.
Euclidean distances between the rows of the stochastic matrix
<code class="reqn">P(t) = e^{-\tau L}</code>, where <code class="reqn">-L = -(I - T)</code> is the generator of the
continuous-time random walk (Markov chain) corresponding to the
discrete-time transition matrix <code class="reqn">T=</code><code>Pi</code>.
</p>


<h3>References</h3>

<p>De Domenico, M. (2017). Diffusion Geometry Unravels the Emergence of
Functional Clusters in Collective Phenomena. Physical Review Letters.
<a href="https://doi.org/10.1103/PhysRevLett.118.168301">doi:10.1103/PhysRevLett.118.168301</a>
</p>
<p>Bertagnolli, G., &amp; De Domenico, M. (2021). Diffusion geometry of multiplex and
interdependent systems. Physical Review E, 103(4), 042301.
<a href="https://doi.org/10.1103/PhysRevE.103.042301">doi:10.1103/PhysRevE.103.042301</a>
<a href="https://arxiv.org/abs/2006.13032">arXiv: 2006.13032</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_distance_matrix">get_distance_matrix</a> <a href="#topic+get_diffusion_probability_matrix">get_diffusion_probability_matrix</a>,
<a href="#topic+get_diffusion_probability_matrix_from_T">get_diffusion_probability_matrix_from_T</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>g &lt;- igraph::sample_pa(10, directed = FALSE)
dm &lt;- get_distance_matrix(g, tau = 1)
</code></pre>

<hr>
<h2 id='get_laplacian'>Evaluate a Laplacian Matrix</h2><span id='topic+get_laplacian'></span><span id='topic+getLaplacianMatrix'></span>

<h3>Description</h3>

<p>Returns a specific Laplacian matrix corresponding to the chosen
dynamics type and network. The available types are:
</p>

<dl>
<dt>Laplacian</dt><dd><p>for the classical combinatorial Laplacian matrix;
it governs the diffusion dynamics on the network</p>
</dd>
<dt>Normalized Laplacian</dt><dd><p>for the Laplacian matrix normalized by degree
matrix, the so-called classical random walk normalized Laplacian;
it governs stochastic walks on the network</p>
</dd>
<dt>Quantum Laplacian</dt><dd><p>for the Laplacian matrix normalized to be
symmetric; it governs quantum walks on the network</p>
</dd>
<dt>MERW normalized Laplacian</dt><dd><p>the maximal-entropy random walk (RW)
normalized Laplacian; it governs stochastic walks on the network,
in which the random walker moves according to a maximal-entropy RW [1].</p>
</dd>
</dl>

<p>The maximum entropy random walk (MERW) chooses the stochastic matrix which
maximizes <code class="reqn">H(S)</code>, so that the walker can explore every walk of the
same length with equal probability.
Let <code class="reqn">\lambda_N, \phi</code> be the leading eigenvalue and
corresponding right eigenvector of the adjacency matrix <code class="reqn">A</code>. Then the
transition matrix corresponding to the discrete-time random walk is
<code class="reqn">\Pi_{ij} = \frac{A_{ij}}{\lambda_N}\frac{\phi_j}{\phi_i}.</code>
The MERW (normalized) Laplacian is then given by <code class="reqn">I - \Pi</code>.
Note that we use the notation <code class="reqn">\Pi</code> and <code>Pi</code> to avoid confusion
with the abbreviation <code>T</code> for the logical <code>TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_laplacian(g, type = "Laplacian", weights = NULL, verbose = TRUE)

getLaplacianMatrix(g, type = "Laplacian", weights = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_laplacian_+3A_g">g</code></td>
<td>
<p>a network</p>
</td></tr>
<tr><td><code id="get_laplacian_+3A_type">type</code></td>
<td>
<p>the type of Laplacian matrix. default <code>"Laplacian"</code>, the
combinatorial Laplacian. Other types:
<code>c("Normalized Laplacian", "Quantum Laplacian", "MERW Normalized
  Laplacian")</code>.
Note that you can type abbreviations, e.g. &quot;L&quot;, &quot;N&quot;, &quot;Q&quot;, &quot;M&quot; for the
respective types (case is ignored). The argument match is done through
<code><a href="strex.html#topic+match_arg">match_arg</a></code>.</p>
</td></tr>
<tr><td><code id="get_laplacian_+3A_weights">weights</code></td>
<td>
<p>edge weights, representing the strength/intensity (not the cost!) of each link.
if weights is NULL (the default) and g has an edge attribute called weight, then
it will be used automatically.
If this is NA then no weights are used (even if the graph has a weight attribute).</p>
</td></tr>
<tr><td><code id="get_laplacian_+3A_verbose">verbose</code></td>
<td>
<p>default <code>TRUE</code>. If information on the type of Laplacian
or on edge weights should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the ('type') Laplacian matrix of network 'g'
</p>


<h3>References</h3>

<p>[1] Burda, Z., et al. (2009). Phys Rev. Lett. 102 160602(April), 1–4.
<a href="https://doi.org/10.1103/PhysRevLett.102.160602">doi:10.1103/PhysRevLett.102.160602</a>
</p>

<hr>
<h2 id='get_mean_distance_matrix'>Mean distance matrix</h2><span id='topic+get_mean_distance_matrix'></span><span id='topic+getMeanDistanceMatrix'></span>

<h3>Description</h3>

<p>Given a sequence of distance matrices, expected to correspond to sequential increasing values of time, calculate the average distance between any pairs of nodes
shortest-path (or geodesic) distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mean_distance_matrix(DM_list)

getMeanDistanceMatrix(DM_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mean_distance_matrix_+3A_dm_list">DM_list</code></td>
<td>
<p>list of distance matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean-distance matrix
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>getMeanDistanceMatrix()</code>: Old deprecated function
</p>
</li></ul>


<h3>References</h3>

<p>De Domenico, M. (2017). Diffusion Geometry Unravels the Emergence of
Functional Clusters in Collective Phenomena. Physical Review Letters.
<a href="https://doi.org/10.1103/PhysRevLett.118.168301">doi:10.1103/PhysRevLett.118.168301</a>
</p>
<p>Bertagnolli, G., &amp; De Domenico, M. (2020). Diffusion Geometry of Multiplex
and Interdependent Systems.
<a href="https://arxiv.org/abs/2006.13032">arxiv preprint arxiv:2006.13032</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_diffusion_probability_matrix">get_diffusion_probability_matrix</a></code>, <code><a href="#topic+get_distance_matrix">get_distance_matrix</a></code>
</p>

<hr>
<h2 id='get_spectral_decomp'>Laplacian Spectral Decomposition</h2><span id='topic+get_spectral_decomp'></span>

<h3>Description</h3>

<p>Returns the eigenvalue spectrum together with eigenvectors of a Laplacian
corresponding to a network. This involves computing the eigendecomposition of
a (symmetric) matrix, so it is computationally intense and may take some time.
The decomposition of the normalized Laplacian <code class="reqn">L = I - D^{-1}A</code> takes
is computed through the decomposition of its symmetric version
<code class="reqn">L = D^{-\frac{1}{2}}AD^{-\frac{1}{2}}</code>. See the package vignette for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_spectral_decomp(g, type = "Normalized Laplacian", verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_spectral_decomp_+3A_g">g</code></td>
<td>
<p>the network in the [igraph] format</p>
</td></tr>
<tr><td><code id="get_spectral_decomp_+3A_type">type</code></td>
<td>
<p>the Laplacian type, default &quot;Normalized Laplacian&quot;.
At the moment this is the only available option. For other types of Laplacians
one should get autonomously the eigendecomposition, e.g. using <a href="base.html#topic+eigen">eigen</a>.
See the package vignette for an example.</p>
</td></tr>
<tr><td><code id="get_spectral_decomp_+3A_verbose">verbose</code></td>
<td>
<p>whether warnings have to be printed or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lambdas the eigenvalues of the Laplacian
</p>
<p>'u_L' the matrix of left eigenvectors (rows)
</p>
<p>'u_R' the matrix of right eigenvectors (columns)
</p>


<h3>References</h3>

<p>Bertagnolli, G., &amp; De Domenico, M. (2021). Diffusion geometry of multiplex and
interdependent systems. Physical Review E, 103(4), 042301.
<a href="https://doi.org/10.1103/PhysRevE.103.042301">doi:10.1103/PhysRevE.103.042301</a>
<a href="https://arxiv.org/abs/2006.13032">arXiv: 2006.13032</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_laplacian">get_laplacian</a></code> <code><a href="#topic+get_ddm_from_eigendec">get_ddm_from_eigendec</a></code>
</p>

<hr>
<h2 id='plot_distance_matrix'>Plot distance matrix</h2><span id='topic+plot_distance_matrix'></span>

<h3>Description</h3>

<p>Plot a heatmap of the distance matrix using <a href="ggplot2.html#topic+geom_tile">geom_tile</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_distance_matrix(
  DM,
  col_palette = viridis(n = 11),
  log_scale = FALSE,
  cex = 1,
  show_dendro = TRUE,
  title = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_distance_matrix_+3A_dm">DM</code></td>
<td>
<p>a distance matrix</p>
</td></tr>
<tr><td><code id="plot_distance_matrix_+3A_col_palette">col_palette</code></td>
<td>
<p>a colour palette, previously it was set to the 'spectral'
palette of <a href="RColorBrewer.html#topic+brewer.pal">brewer.pal</a> but now it is, by default, to the
color-blind firendly <a href="viridis.html#topic+viridis">viridis</a>.</p>
</td></tr>
<tr><td><code id="plot_distance_matrix_+3A_log_scale">log_scale</code></td>
<td>
<p>logical. Default FALSE</p>
</td></tr>
<tr><td><code id="plot_distance_matrix_+3A_cex">cex</code></td>
<td>
<p>numerical value by which text should be magnified (default font
size in <a href="ggplot2.html#topic+theme">theme</a> is 11)</p>
</td></tr>
<tr><td><code id="plot_distance_matrix_+3A_show_dendro">show_dendro</code></td>
<td>
<p>If the dendrogram resulting from <a href="stats.html#topic+hclust">hclust</a> should
be shown. Default TRUE</p>
</td></tr>
<tr><td><code id="plot_distance_matrix_+3A_title">title</code></td>
<td>
<p>Title of the plot passed to <a href="ggplot2.html#topic+labs">labs</a>. No title by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot <a href="ggplot2.html#topic+ggplot">ggplot</a>
</p>

<hr>
<h2 id='plotHeatmap'>Plot distance matrix as heatmap</h2><span id='topic+plotHeatmap'></span>

<h3>Description</h3>

<p>'r lifecycle::badge(&quot;deprecated&quot;)'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotHeatmap(
  DM,
  colPalette = NULL,
  log.scale = FALSE,
  cex = 1,
  showDendrogram = TRUE,
  title = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotHeatmap_+3A_dm">DM</code></td>
<td>
<p>a distance matrix</p>
</td></tr>
<tr><td><code id="plotHeatmap_+3A_colpalette">colPalette</code></td>
<td>
<p>'r lifecycle::badge(&quot;deprecated&quot;)' in the new function <a href="#topic+plot_distance_matrix">plot_distance_matrix</a>
it is called <code>col_palette</code></p>
</td></tr>
<tr><td><code id="plotHeatmap_+3A_log.scale">log.scale</code></td>
<td>
<p>'r lifecycle::badge(&quot;deprecated&quot;)' in the new function <a href="#topic+plot_distance_matrix">plot_distance_matrix</a>
it is called <code>log_scale</code></p>
</td></tr>
<tr><td><code id="plotHeatmap_+3A_cex">cex</code></td>
<td>
<p>numerical value by which text should be magnified (default font
size in [ggplot2:theme] is 11)</p>
</td></tr>
<tr><td><code id="plotHeatmap_+3A_showdendrogram">showDendrogram</code></td>
<td>
<p>'r lifecycle::badge(&quot;deprecated&quot;)' in the new function <a href="#topic+plot_distance_matrix">plot_distance_matrix</a>
it is called <code>show_dendro</code></p>
</td></tr>
<tr><td><code id="plotHeatmap_+3A_title">title</code></td>
<td>
<p>Title of the plot passed to <a href="ggplot2.html#topic+labs">labs</a>. No title by
default</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="ggplot2.html#topic+ggplot">ggplot</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
