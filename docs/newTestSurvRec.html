<!DOCTYPE html><html lang="en"><head><title>Help for package newTestSurvRec</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {newTestSurvRec}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#newTestSurvRec-package'><p>package newTestSurvRec</p></a></li>
<li><a href='#DataColonDukesABvsC'><p>Re-hospitalization of patients with colorectal cancer</p></a></li>
<li><a href='#DataColonDukesABvsD'><p>Re-hospitalization of patients with colorectal cancer</p></a></li>
<li><a href='#DataColonDukesCvsD'><p>Rehospitalization of patients with colorectal cancer</p></a></li>
<li><a href='#Dif.Surv.Rec'><p>This function computes statistical difference between two survival curves</p></a></li>
<li><a href='#fit.Data.Survrecu'><p>This function let to adjust the IDs the database</p></a></li>
<li><a href='#FitSurvRec'><p>Compute a Survival Curve for Recurrent Event Data given a variable of group</p></a></li>
<li><a href='#is.Survrecu'><p>This function verify if the formula type of survival recurrent is object type newTestSurvRec</p></a></li>
<li><a href='#MMC.TestSurvRec'><p>Migratory Motor Complex</p></a></li>
<li><a href='#Plot.Cusum.Events'><p>Plot data with recurrent events</p></a></li>
<li><a href='#Plot.Data.Events'><p>Plot data with recurrent events</p></a></li>
<li><a href='#Plot.Event.Rec'><p>This function plots the ocurrence of a event in two scales time</p></a></li>
<li><a href='#Plot.Surv.Rec'><p>Plots of thesurvival function from an object with class newTestSurvRec, using PHS or WC models</p></a></li>
<li><a href='#Print.Summary'><p>Function to print summary of statistics tests to comparison of the survival curves of the groups with recurrent events</p></a></li>
<li><a href='#PSH.fit'><p>Estimator of the survival curve  using the estimator developed by Pena, Strawderman and Hollander</p></a></li>
<li><a href='#Qsearch.Fractil'><p>Calculate the survival time to a selected quantile</p></a></li>
<li><a href='#Survrecu'><p>Create a Survival recurrent object type newTestSurvRec</p></a></li>
<li><a href='#TBCplapyr'><p>Data  in patients with bladder cancer treated with placebo or pyridoxine</p></a></li>
<li><a href='#TBCplathi'><p>Data in patients with bladder cancer treated as placebo or thiotepa</p></a></li>
<li><a href='#TBCpyrthi'><p>Data in patients with bladder cancers and treated with pyridoxine or thiotepa</p></a></li>
<li><a href='#WC.fit'><p>Survival function estimator for recurrence time data using the estimator developed by Wang and Chang</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Tests to Compare Curves with Recurrent Events</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-04-01</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Author:</td>
<td>Dr Carlos Miguel Martinez Manrique</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carlos Martinez &lt;cmmm7031@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the routines to compare the survival curves with recurrent events, including the estimations of survival curves. The first model is a  model for recurrent event, when the data are correlated or not  correlated. It was proposed by Wang and Chang (1999) &lt;<a href="https://doi.org/10.2307%2F2669690">doi:10.2307/2669690</a>&gt;. In the independent case, the survival function can be  estimated by the generalization of the limit product model of Pena (2001) &lt;<a href="https://doi.org/10.1198%2F016214501753381922">doi:10.1198/016214501753381922</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-04-13 11:14:56 UTC; Usuario 1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-04-16 09:01:31 UTC</td>
</tr>
</table>
<hr>
<h2 id='newTestSurvRec-package'>package newTestSurvRec</h2><span id='topic+newTestSurvRec-package'></span><span id='topic+newTestSurvRec'></span>

<h3>Description</h3>

<p>package newTestSurvRec</p>


<h3>Details</h3>

<p>Recurrent events are common in many areas: <em>psychology, engineering, medicine, physics, astronomy, biology, economics</em> and <em>so on</em>. Such events are very common in the real world: <em>viral diseases, carcinogenic tumors, machinery and equipment failures, births, murders, rain, industrial accidents, car accidents</em>  and <em>so on</em>. The availability of computerized tools for the analysis is indispensable. The survival analysis is a branch of statistics that allows us to model the time until the occurrence of an events. In general, the objectives of analysis are: the modeling of the survival function to estimate the risk or benefit of the occurrence of an event, the probability occurrence of this event and comparing population groups. The development of tools for the statistical analysis of recurrent event is relatively recent and are not fully known. The purpose of this package is to present statistical tests for the analysis of recurrent event data. <b>Martinez</b> <em>et al. </em>(<b>2009</b>) published a statistical test to compare survival curves of two groups with recurrent events. The hypothesis of the problem is:
</p>
<p style="text-align: center;"><code class="reqn">\bold{H_{o} : S_{1}(t) = S_{2}(t)}</code>
</p>
 
<p style="text-align: center;"><code class="reqn">\bold{H_{1} : S_{1}(t) \neq S_{2}(t)}</code>
</p>

<p>Where, <code class="reqn">S_{1}(t)</code> and <code class="reqn">S_{2}(t)</code> are the survival curves of the both group. The statistic of test is,
</p>
<p style="text-align: center;"><code class="reqn">Z=\frac{\sum^{\,}_{t\leq\,z}w_{z}\left[\Delta\,N(s,z;r)-E\left\{\Delta\,N(s,z;r)\right\} \right]}{\sqrt{\sum^{\,}_{t\leq\,z}w^{2}_{z}Var\left\{\Delta\,N(s,z;r) \right\}}}</code>
</p>

<p>The statistic Z has a normal asymptotic behavior. Its square has a chi-square approximate behavior with a degree of freedom.
So,</p>
<p style="text-align: center;"><code class="reqn">\Delta\,N(s, z; 1) = N(s, z+\Delta\,z; 1) - N(s, z; 1)</code>
</p>

<p>Now, <code class="reqn">\Delta\,z</code> is approaches to zero and as <code class="reqn">\Delta\,N(s, z; 1)</code> has a hyper-geometric behavior and expected value is equal to 
</p>
<p style="text-align: center;"><code class="reqn">Y(s, z; 1)\Delta\,N(s, z)/Y(s, z)</code>
</p>
 
<p>and variance equal to,
</p>
<p style="text-align: center;"><code class="reqn">Var\left[\Delta\,N(s, z; 1) \right]=\frac{Y(s,z)-Y(s,z;1)}{Y(s,z)-1}Y(s,z;1)\frac{\Delta\,N(s,z)}{Y(s,z)}\left[1-\frac{\Delta\,N(s,z)}{Y(s,z)}\right]</code>
</p>

<p>This author proposed various types of weights <code class="reqn">(w_{z})</code>,
</p>
<p style="text-align: center;"><code class="reqn">w_{z}=\left[S(z)\right]^{\gamma}\left[1-S(z)\right]^{\eta}\frac{\left[Y(s,z)\right]^{\alpha}}{\left[Y(s,z)+1\right]^{\beta}}</code>
</p>

<p>The appropriate selection of weights depends on the behavior of the curves. With the selection of the values of the parameters <code class="reqn">(\alpha,\;\beta,\;\gamma\;and \;\eta)</code>, on the proposal, is possible  adjust its behavior. With the proposal, we are able of make studies on survival analysis with recurrent events and generate tests for analysis others, including the classical tests type: <b>logrank, Gehan, Peto-Peto, Fleming-Harrington</b> and so on. Note that, if all parameters are zero, <code class="reqn">w_{z} = 1</code>, its generates the test type logrank for recurrent events. If, <code class="reqn">\alpha = 1</code> and the other parameters are zero <code class="reqn">w_{z} = Y(s,z)</code>, its generates the test type <b>Gehan</b>. If, <code class="reqn">\gamma=1</code> and the other parameters are zero <code class="reqn">w_{z} = S(z)</code>, its generate the test of <b>Peto-Peto</b>. If, <code class="reqn">\gamma = 1</code> and <code class="reqn">\eta = 1</code> and the rest of the parameters are zero, its generate <b>Fleming-Harrington</b> test. On the other hand, if you analyze the test statistical of comparison for recurrent events, it depends on the counting processes <b>N</b> and <b>Y</b>, which are doubles indexed. The index S measures calendar time and Z index measures the gap times. So, if the observation time tends to infinity and unity event study can only occur once in each unit and the statistical comparison becomes the weighted classical statistical comparison of groups of the survival analysis. We can conclude that test proposed by <b>Martinez</b> <em>et al.</em>(<b>2009</b>) are useful on diverse fields of research, such as: <em>medicine, public health, insurance, social science, reliability</em> and <em> others.</em>
</p>


<h3>Note</h3>

<p>This package have some functions that them were originally performed by the survrec package, which solved the adjustment problem of the PSH and WC estimators using Fortran routines. With the permission of the author, Dr. Juan R. Gonzalez, the algorithm of base was taken, modified, the algorithm, WC estimator was reprogrammed and adapted to the needs of the newTestSurvRec package and thus avoid dependence. Thanks to Dr. Gonzalez</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>).Pruebas no parametricas para comparar curvas de supervivencia de dos grupos  que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.// <b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de  naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.// <b>Pena E., Strawderman R., Hollander, M. (2001)</b>. Nonparametric Estimation with Recurrent  Event Data. <em>J.A.S.A.</em> 96, 1299-1315.</p>


<h3>See Also</h3>

<p>Dif.Surv.Rec, Plot.Event, Rec,Plot.Surv. Rec, Print.Summary, Plot.Cusum.Events</p>


<h3>Examples</h3>

<pre><code class='language-R'>##library(newTestSurvRec)
getOption("defaultPackages")
XL&lt;-data(TBCplapyr)
XL
Plot.Event.Rec(TBCplapyr)
Dif.Surv.Rec(TBCplapyr,'all',1,1,0,0)
Print.Summary(TBCplapyr)
</code></pre>

<hr>
<h2 id='DataColonDukesABvsC'>Re-hospitalization of patients with colorectal cancer</h2><span id='topic+DataColonDukesABvsC'></span>

<h3>Description</h3>

<p>This data set contains the re-hospitalization times of patients diagnosed with stage AB and  patients diagnosed with stage C.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DataColonDukesABvsC)</code></pre>


<h3>Format</h3>

<p> A data frame with 655 observations on the following 10 variables.
</p>
<p>This data.frame contains the following columns
</p>
<dl>
<dt><code>j</code></dt><dd><p>Observation number</p>
</dd>
<dt><code>Iden</code></dt><dd><p>identification of each subject. Repeated for each recurrence</p>
</dd>
<dt><code>id</code></dt><dd><p>identification of each subject. Repeated for each recurrence</p>
</dd>
<dt><code>Tinicio</code></dt><dd><p>Initial time of observation just before each recurrence</p>
</dd>
<dt><code>time</code></dt><dd><p>re-hospitalization o censoring gaptime</p>
</dd>
<dt><code>Tcal</code></dt><dd><p>re-hospitalization o censoring calendar time</p>
</dd>
<dt><code>event</code></dt><dd><p>censoring status. All event are 1 for each subject excepting last one that it is 0</p>
</dd>
<dt><code>chemoter</code></dt><dd><p>Did patient receive chemotherapy? 1: No or 2:Yes</p>
</dd>
<dt><code>dukes</code></dt><dd><p>Dukes tumor stage: 1:A-B or 2:C</p>
</dd>
<dt><code>distance</code></dt><dd><p>distance from living place to hospital 1:&lt;=30 Km. or  2:&gt;30 Km.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The patients included in the study have been operated between January 1996 and December 1998. For each patient, we have considered this date as the beginning of the observational period. All patients were followed until June 2002. Consequently, the length of the monitoring period can differ for each patient, depending on its surgery date. The first inter occurrence time has been considered as the time between the surgical intervention and the first hospitalization related to cancer. Four hundred and three patients with colon and rectum cancer have been included in the study. Information about their sex (male or female), age ( 60, 60-74 or  75), and tumor stage using Dukes classification (A-B, C, or D) have been recorded. The following inter- occurrence times have been considered as the difference between the last hospitalization and the current one. Only re-admissions related to cancer have been considered.</p>


<h3>Source</h3>

<p>This data were obtained from <b>Gonzalez, J.R.</b> <em>et al.</em> (<b>2009</b>)</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>). Pruebas no parametricas para comparar curvas de supervivencia de dos grupos que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.// <b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de  naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.//<b>Gonzalez, J.R., Fernandez, E., Moreno, V.</b> <em>et al.</em> Gender differences in hospital readmission among colorectal cancer patients. Currently submited to J.C.O.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DataColonDukesABvsC)</code></pre>

<hr>
<h2 id='DataColonDukesABvsD'>Re-hospitalization of patients with colorectal cancer</h2><span id='topic+DataColonDukesABvsD'></span>

<h3>Description</h3>

<p>This data contains re-hospitalization times of patients diagnosed with stage AB and patients diagnosed with stage D.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DataColonDukesABvsD)</code></pre>


<h3>Format</h3>

<p>A data frame with 527 observations on the following 10 variables
</p>
<p>This data.frame contains the following columns:
</p>
<dl>
<dt><code>j</code></dt><dd><p>Observation number</p>
</dd>
<dt><code>Iden</code></dt><dd><p>Observation of each subject. Repeated for each recurrence</p>
</dd>
<dt><code>id</code></dt><dd><p>Observation of each subject. Repeated for each recurrence</p>
</dd>
<dt><code>Tinicio</code></dt><dd><p>Initial time of observation just before each recurrence</p>
</dd>
<dt><code>time</code></dt><dd><p>re-hospitalization o censoring gaptime</p>
</dd>
<dt><code>Tcal</code></dt><dd><p>re-hospitalization o censoring calendar time</p>
</dd>
<dt><code>event</code></dt><dd><p>censoring status. All event are 1 for each subject excepting last one that it is 0</p>
</dd>
<dt><code>chemoter</code></dt><dd><p>Did patient receive chemotherapy? 1: No or 2:Yes</p>
</dd>
<dt><code>dukes</code></dt><dd><p>Dukes tumoral stage: 1:A-B or 3:D</p>
</dd>
<dt><code>distance</code></dt><dd><p>distance from living place to hospital 1:&lt;=30 Km. or 2:&gt;30 Km.</p>
</dd>
</dl>



<h3>Details</h3>

<p>See details on DataColonDukesABvs</p>


<h3>Source</h3>

<p>This data were obtained from <b>Gonzalez, J. R.</b> <em>et al.</em> (<b>2009</b>)</p>


<h3>References</h3>

<p><b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.// <b>Gonzalez, J.R., Fernandez, E., Moreno, V. </b> <em>et al.</em> Gender differences in hospital readmission among colorectal cancer patients. Currently submited to J.C.O.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DataColonDukesABvsD)
XL&lt;-data(DataColonDukesABvsD)
print(XL)
</code></pre>

<hr>
<h2 id='DataColonDukesCvsD'>Rehospitalization of patients with colorectal cancer</h2><span id='topic+DataColonDukesCvsD'></span>

<h3>Description</h3>

<p>This data contains the re-hospitalization times of patients diagnosed with stage C and patients diagnosed with stage D</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DataColonDukesCvsD)</code></pre>


<h3>Format</h3>

<p> A data frame with 537 observations on the following 10 variables
</p>
<p>This data.frame contains the following columns
</p>
<dl>
<dt><code>j</code></dt><dd><p>Observation number</p>
</dd>
<dt><code>Iden</code></dt><dd><p>identification of each subject. Repeated for each recurrence</p>
</dd>
<dt><code>id</code></dt><dd><p>identification of each subject. Repeated for each recurrence</p>
</dd>
<dt><code>Tinicio</code></dt><dd><p>Initial time of observation just before each recurrence</p>
</dd>
<dt><code>time</code></dt><dd><p>re-hospitalization o censoring gaptime</p>
</dd>
<dt><code>Tcal</code></dt><dd><p>re-hospitalization o censoring calendar time</p>
</dd>
<dt><code>event</code></dt><dd><p>censoring status. All event are 1 for each subject excepting last one that it is 0</p>
</dd>
<dt><code>chemoter</code></dt><dd><p>Did patient receive chemotherapy? 1: No or 2:Yes</p>
</dd>
<dt><code>dukes</code></dt><dd><p>Dukes tumor stage: 2:C  or 3:D</p>
</dd>
<dt><code>distance</code></dt><dd><p>distance from living place to hospital 1:<code class="reqn">&lt;</code>=30 Km. or 2:<code class="reqn">&gt;</code>30 Km.</p>
</dd>
</dl>



<h3>Details</h3>

<p>See details on DataColonDukesABvs</p>


<h3>Source</h3>

<p>This data were obtained from <b>Gonzalez, J.R.</b> <em>et al.</em> (<b>2009</b>)</p>


<h3>References</h3>

 <p><b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de  naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.//<b>Gonzalez, J.R., Fernandez, E., Moreno, V.</b> <em>et al.</em> Gender differences in hospital re-admission among colorectal cancer patients. Currently submited to J.C.O.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DataColonDukesCvsD)
XL&lt;-data(DataColonDukesCvsD)
print(XL)
</code></pre>

<hr>
<h2 id='Dif.Surv.Rec'>This function computes statistical difference between two survival curves</h2><span id='topic+Dif.Surv.Rec'></span>

<h3>Description</h3>

<p>p-values of these tests are computed.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dif.Surv.Rec(XX, type, alfa, beta,gamma,eta)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Dif.Surv.Rec_+3A_xx">XX</code></td>
<td>
<p>Object type recurrent events data</p>
</td></tr>
<tr><td><code id="Dif.Surv.Rec_+3A_type">type</code></td>
<td>
<p>&quot;LRrec&quot;,&quot;Grec&quot;,&quot;TWrec&quot;,&quot;PPrec&quot;,&quot;PMrec&quot;,&quot;FHrec&quot;,&quot;CMrec&quot;,&quot;Mrec&quot;,&quot;all&quot;</p>
</td></tr>
<tr><td><code id="Dif.Surv.Rec_+3A_alfa">alfa</code></td>
<td>
<p>The appropriate choice, see <code class="reqn">w_{z}</code>. Defect value is equal zero</p>
</td></tr>
<tr><td><code id="Dif.Surv.Rec_+3A_beta">beta</code></td>
<td>
<p>The appropriate choice, see <code class="reqn">w_{z}</code>. Defect value is equal zero</p>
</td></tr>
<tr><td><code id="Dif.Surv.Rec_+3A_gamma">gamma</code></td>
<td>
<p>The appropriate choice, see <code class="reqn">w_{z}</code>. Defect value is equal zero</p>
</td></tr>
<tr><td><code id="Dif.Surv.Rec_+3A_eta">eta</code></td>
<td>
<p>The appropriate choice, see <code class="reqn">w_{z}</code>. Defect value is equal zero</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function contains tests to compare survival curves with recurrent events. The curves are estimated using <b>Pena-Strawderman-Hollander</b> or  <b>Wang-Chang</b> estimator.
<b>GPLE or PSH model</b>: <b>Pena</b> <em>et al.</em> (<b>2001</b>) defined an estimator of the survival function to recurrent 
events or <b>Kaplan-Meier</b> estimator <b>GPLE</b>. They used two counting processes <b>N</b> and <b>Y</b>. The PSH estimator was defined as,
</p>
<p style="text-align: center;"><code class="reqn">\hat{S}(z) =\prod_{t\leq\,z}\left[1-\frac{\Delta\,N\left(s,z\right)}{Y\left(s,z\right)}\right]</code>
</p>

<p>The authors considered two time scales: one related to calendar time (S) and other related to inter occurrences time (T). So, the counting process <b>N(s, z)</b> represents the number of observed events in the calendar period <code class="reqn">[0,s]</code> with <code class="reqn">t\leq\,z</code> and <b>Y(s, z)</b> represents the number of observed events in the period <code class="reqn">[0,s]</code> with <code class="reqn">t\geq\,z</code>. The product-limit estimator was developed by <b>Pena, Strawderman</b> and <b>Hollander</b>, called PSH. This estimator is useful when the inter occurrence times are assumed to 
represents IID sample from some underlying distribution F. The <b>GPLE</b> estimator is defined as: A fundamental assumption of this approach is that individuals have been previously and properly classified in groups according to a stratification variable denote by <em>r</em>. Thus, the estimator of the survival curve by each group is defined as,
</p>
<p style="text-align: center;"><code class="reqn">\hat{S}_{r}(z) =\prod_{t\leq\,z}\left[1-\frac{\Delta\,N\left(s,z;r\right)}{Y\left(s,z;r\right)}\right]\!\nabla\:r\:=\!1,2.</code>
</p>

<p><b>WC model</b>: <b>Wang-Chang</b> (<b>1999</b>) proposed an estimator of the common marginal survivor function in the case where within-unit inter occurrences times are correlated. The correlation structure considered by Wang and Chang (1999) is quite general and contains, the cases particular, both the i.i.d. and multiplicative frailty model as special cases. The WC estimator was defined using two new processes,<code class="reqn">d^{*}</code> and <code class="reqn">R^{*}</code>. 
</p>
<p style="text-align: center;"><code class="reqn">\hat{S}(t) =\prod_{T\leq\,t}\left[1-\frac{d^{*}\left(T_{k}\right)}{R^{*}\left(T_{k}\right)}\right]</code>
</p>

<p>The authors try take into account in the definition of <code class="reqn">N</code> and <code class="reqn">Y</code> that an individual may have more than one event. In fact, this estimator has the same way as the GPLE estimator but using these two different processes. the index <code class="reqn">d^{*}</code> represents the sum of the proportion of individuals of the inter occurrences times which are equal to <code class="reqn">t</code> when there is at least one event. On the other hand,  <code class="reqn">R^{*}</code> represents an average of the individuals that are at risk time <code class="reqn">t</code>, where for each individual the average is the number of failures or censored times at least equal to <code class="reqn">t</code>. This average is done regarding the number of events that there are to each individual and in case <code class="reqn">K</code> is 0 is divided by 1. For definition more formal see Martinez (2009) and Pena <em>et. al</em> (2001). The WC estimator of S eliminates the bias for the product-limit estimator developed by PSH (2001) when the inter occurrences times are correlated within units.However, when applied to i.i.d. inter occurrence times, this estimator is not expected to perform as well as the PSH estimator, especially with regard to efficiency.</p>


<h3>Value</h3>

<p># Dif.Surv.Rec(TBCplapyr,&quot;all&quot;,0,0,0,0). Values returned
</p>

<table>
<tr>
 <td style="text-align: left;">
 Nomb.Est</td><td style="text-align: left;">  Chi.square</td><td style="text-align: left;">   p.value</td>
</tr>
<tr>
 <td style="text-align: left;">
 LRrec   </td><td style="text-align: left;">  0.3052411 </td><td style="text-align: left;"> 0.5806152</td>
</tr>
<tr>
 <td style="text-align: left;">
 Grec    </td><td style="text-align: left;">  1.4448446 </td><td style="text-align: left;"> 0.2293570</td>
</tr>
<tr>
 <td style="text-align: left;">
 TWrec   </td><td style="text-align: left;">  0.9551746 </td><td style="text-align: left;"> 0.3284056</td>
</tr>
<tr>
 <td style="text-align: left;">
 PPrec   </td><td style="text-align: left;">  1.1322772 </td><td style="text-align: left;"> 0.2872901</td>
</tr>
<tr>
 <td style="text-align: left;">
 PMrec   </td><td style="text-align: left;">  1.1430319 </td><td style="text-align: left;"> 0.2850126</td>
</tr>
<tr>
 <td style="text-align: left;">
 PPrrec  </td><td style="text-align: left;">  1.1834042 </td><td style="text-align: left;"> 0.2766641</td>
</tr>
<tr>
 <td style="text-align: left;">
 HFrec   </td><td style="text-align: left;">  0.3052411 </td><td style="text-align: left;"> 0.5806152</td>
</tr>
<tr>
 <td style="text-align: left;">
 CMrec   </td><td style="text-align: left;">  0.3052411 </td><td style="text-align: left;"> 0.5806152</td>
</tr>
<tr>
 <td style="text-align: left;">
 Mrec    </td><td style="text-align: left;">  1.5298763 </td><td style="text-align: left;"> 0.2161310</td>
</tr>
<tr>
 <td style="text-align: left;">
 </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>).Pruebas no parametricas para comparar curvas de supervivencia de dos grupos  que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.//<b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.</p>


<h3>See Also</h3>

<p>Plot.Event.Rec, Plot.Surv.Rec, Print.Summary</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TBCplapyr)
#Return the p-values of the all tests
Dif.Surv.Rec(TBCplapyr,"all",0,0,0,0)
#Return the p-value of the LRrec test
Dif.Surv.Rec(TBCplapyr)
#Return the p-value of the Grec test
Dif.Surv.Rec(TBCplapyr,"Grec")
#Return the p-values of the CMrec tests
#The CMrec test with this parameters generates LRrec test
Dif.Surv.Rec(TBCplapyr,"all",0,0,0,0)
#The CMrec test with this parameters generates Grec test
Dif.Surv.Rec(TBCplapyr,"all",0,0,1,0)
#The CMrec test with this parameters generates TWrec test
Dif.Surv.Rec(TBCplapyr,"all",0,0,0.5,0)
</code></pre>

<hr>
<h2 id='fit.Data.Survrecu'>This function let to adjust the IDs the database</h2><span id='topic+fit.Data.Survrecu'></span>

<h3>Description</h3>

<p>This function let to adjust the ID's the database in case that it is not have the order  numeric correct. Observation: this function only let to adjust the id variable not sort the rest of the data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.Data.Survrecu(x)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.Data.Survrecu_+3A_x">x</code></td>
<td>
<p>a database type dataframe</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns the correct numeric order for the dataframe</p>


<h3>Note</h3>

<p>The last id on each unit of the database to have be a censored data and the occurrences  have that to precede to this last it.</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>).Pruebas no parametricas para comparar curvas de supervivencia de dos grupos que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.//<b>Pena E., Strawderman R., Hollander M. (2001)</b>. Nonparametric Estimation with Recurrent  Event Data. <em>J.A.S.A.</em> 96, 1299-1315</p>


<h3>See Also</h3>

<p>FitSurvRec, Survrecu, is.Survrecu</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MMC.TestSurvRec)
ID&lt;-fit.Data.Survrecu(Survrecu(MMC.TestSurvRec$id,MMC.TestSurvRec$time,
                               MMC.TestSurvRec$event))
ID
fit&lt;-PSH.fit(Survrecu(ID,MMC.TestSurvRec$time,
                               MMC.TestSurvRec$event))
fit$time
fit$surv
plot(fit$time,fit$surv)

 
data(DataColonDukesABvsD)
XL&lt;-data(DataColonDukesABvsD)
DataColonDukesABvsD$Iden
Y&lt;-fit.Data.Survrecu(Survrecu(DataColonDukesABvsD$Iden,DataColonDukesABvsD$time,
                                  DataColonDukesABvsD$event))
Y
fit&lt;-WC.fit(Survrecu(Y,DataColonDukesABvsD$time,DataColonDukesABvsD$event))
fit$time
fit$surv
plot(fit$time,fit$surv)
print(data.frame(time=fit$time,n.event=fit$n.event, 
                     Surv=fit$survfunc,std.error=fit$std.error))


</code></pre>

<hr>
<h2 id='FitSurvRec'>Compute a Survival Curve for Recurrent Event Data given a variable of group</h2><span id='topic+FitSurvRec'></span>

<h3>Description</h3>

<p>Computes an estimate of a survival curve for recurrent event data using either the <em>Pena, Strawderman and  Hollander</em>or <em>Wang and Chang</em> estimators. It also computes the asymptotic standard errors. The resulting object of class Survrecu is plotted.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitSurvRec(formula, data, type = "pena-strawderman-hollander", ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitSurvRec_+3A_formula">formula</code></td>
<td>
<p>A formula object. If a formula object is supplied it must have a Survrecu object as the response on the left of the operatorand a term on the right. For a single survival curve as  part of the formula is required.</p>
</td></tr>
<tr><td><code id="FitSurvRec_+3A_data">data</code></td>
<td>
<p>a data frame in wich to interpret the variables named in the formula.</p>
</td></tr>
<tr><td><code id="FitSurvRec_+3A_type">type</code></td>
<td>
<p>a character string specifying the type of survival curve. Possible value are &quot;pena- strawderman-hollander&quot; or &quot;wang-chang&quot;. The default is &quot;pena,-strawderman-hollander&quot;.</p>
</td></tr>
<tr><td><code id="FitSurvRec_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the type of estimator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the help details of PSH.fit or WC.fit depending on the type chosen</p>


<h3>Value</h3>

<p>A FitSurvRec object. Methods defined for FitSurvRec objects are provided for print, lines and plot.</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>).Pruebas no parametricas para comparar curvas de supervivencia de dos grupos  que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.//<b>Pena E., Strawderman R., Hollander M. (2001)</b>. Nonparametric Estimation with Recurrent  Event Data. <em>J.A.S.A.</em> 96, 1299-1315</p>


<h3>See Also</h3>

<p>is.Survrecu, Survrecu, PSH.fit, Plot.Event.Rec, Plot.Surv.Rec, Print.Summary</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MMC.TestSurvRec)
# fit a PSH survival function and plot it
fitPSH&lt;-FitSurvRec(Survrecu(id,time,event)~1,data=MMC.TestSurvRec)
plot(fitPSH$time,fitPSH$survfunc,type="s" ,ylim=c(0,1),
     xlim=c(0,max(fitPSH$time)))
title(main = list("Survival Curve with Recurrent Event Data", 
      cex = 0.8, font = 2.3, col = "dark blue"))
mtext("Research Group: AVANCE USE R!", cex = 0.7, font = 2, 
      col = "dark blue", line = 1)
mtext("Software made by: Dr. Carlos Martinez", cex = 0.6, font = 2, 
      col = "dark red", line = 0)
 
fitWC&lt;-FitSurvRec(Survrecu(id,time,event)~1,data=MMC.TestSurvRec,
              type="wang-chang")
plot(fitWC$time,fitWC$survfunc,type="s" ,ylim=c(0,1),xlim=c(0,max(fitWC$time)))
  	  title(main = list("Survival Curve with Recurrent Event Data", 
       cex = 0.8, font = 2.3, col = "dark blue"))
        mtext("Research Group: AVANCE USE R!", cex = 0.7, font = 2, 
       col = "dark blue", line = 1)
        mtext("Software made by: Dr. Carlos Martinez", cex = 0.6, font = 2, 
       col = "dark red", line = 0)
              
</code></pre>

<hr>
<h2 id='is.Survrecu'>This function verify if the formula type of survival recurrent is object type newTestSurvRec</h2><span id='topic+is.Survrecu'></span>

<h3>Description</h3>

<p>To verify if the create object type Survrecu is a formula model type newTestSurvRec</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.Survrecu(x)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.Survrecu_+3A_x">x</code></td>
<td>
<p>Object type formula of the class newTestSurvRec</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>False</code></td>
<td>
<p>if the object is not type formula</p>
</td></tr>
<tr><td><code>True</code></td>
<td>
<p>if the object is type formula</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral. <em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.// <b>Pena E., Strawderman R., Hollander, M. (2001)</b>. Nonparametric Estimation with Recurrent Event Data. <em>J.A.S.A.</em> 96, 1299-1315</p>


<h3>See Also</h3>

<p>FitSurvRec, Dif.Surv.Rec, Survrecu, FitSurvRec</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MMC.TestSurvRec)
x&lt;-Survrecu(MMC.TestSurvRec$id,MMC.TestSurvRec$time,MMC.TestSurvRec$event)~1
is.Survrecu(x)
</code></pre>

<hr>
<h2 id='MMC.TestSurvRec'>Migratory Motor Complex</h2><span id='topic+MMC.TestSurvRec'></span>

<h3>Description</h3>

<p>This contains the Migratoty Motor Complex data</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MMC.TestSurvRec)</code></pre>


<h3>Format</h3>

<p>A data frame with 99 observations on the following 5 variables.
</p>

<dl>
<dt><code>j</code></dt><dd><p>Number of the observation on dataset</p>
</dd>
<dt><code>id</code></dt><dd><p>ID of each subject. Repeated for each recurrence</p>
</dd>
<dt><code>time</code></dt><dd><p>recurrence o censoring time</p>
</dd>
<dt><code>event</code></dt><dd><p>censoring status. All event are 1 for each subject excepting last one that it is 0</p>
</dd>
<dt><code>group</code></dt><dd><p>A factor with levels <code>Females</code> <code>Males</code></p>
</dd>
</dl>
 

<h3>Details</h3>

<p>The data correspond a study from the Section for Gastroenterology of  Department of Internal Medicine, Ulleal University Hospital of Oslo.
</p>


<h3>Source</h3>

<p><b>Husebye E, Skar V, Aalen O. and Osnes M</b> (<b>1990</b>), Digestive Diseases and Sciences.</p>


<h3>References</h3>

<p><b>Husebye E, Skar V, Aalen O.O., Osnes M.</b>(<b>1990</b>). Digital ambulatory manometry of the small intestine in healthy adults. Estimates of variation within and between individuals and statistical management of incomplete MMC periods. Digestive Diseases and Sciences.35:1057: 65.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MMC.TestSurvRec)
XL&lt;-data(MMC.TestSurvRec)
print(XL)
Print.Summary(MMC.TestSurvRec)
## maybe str(MMC.TestSurvRec) ; plot(MMC.TestSurvRec) ...
</code></pre>

<hr>
<h2 id='Plot.Cusum.Events'>Plot data with recurrent events</h2><span id='topic+Plot.Cusum.Events'></span>

<h3>Description</h3>

<p>This function plot data with recurrent events</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.Cusum.Events(yy, xy = 1, xf= 1, colevent = "blue", colcensor = "red",
                                             ltyx = 1, lwdx = 1)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.Cusum.Events_+3A_yy">yy</code></td>
<td>
<p>Data type recurrent events. Examples: TBCplapyr, TBCplathi or TBCpyrthi</p>
</td></tr>
<tr><td><code id="Plot.Cusum.Events_+3A_xy">xy</code></td>
<td>
<p>Initial unit to start the plotted</p>
</td></tr>
<tr><td><code id="Plot.Cusum.Events_+3A_xf">xf</code></td>
<td>
<p>Final unit of the plotted</p>
</td></tr>
<tr><td><code id="Plot.Cusum.Events_+3A_colevent">colevent</code></td>
<td>
<p>It is color that identifies the event</p>
</td></tr>
<tr><td><code id="Plot.Cusum.Events_+3A_colcensor">colcensor</code></td>
<td>
<p>it is color that identifies the censor</p>
</td></tr>
<tr><td><code id="Plot.Cusum.Events_+3A_ltyx">ltyx</code></td>
<td>
<p>The line type. Line types can either be specified as an integer (0<code class="reqn">=</code>&quot;blank&quot;, 1<code class="reqn">=</code>&quot;solid&quot; (default),2<code class="reqn">=</code>&quot;dashed&quot;,3<code class="reqn">=</code>&quot;dotted&quot;,4<code class="reqn">=</code>&quot;dotdash&quot;, 5<code class="reqn">=</code>&quot;longdash&quot;, 6<code class="reqn">=</code>&quot;twodash&quot;) or as one of the character strings: &quot;blank&quot;, &quot;solid&quot;, &quot;dashed&quot;,&quot;dotted&quot;, &quot;dotdash&quot;,&quot; longdash&quot;, or &quot;twodash&quot;, where blank uses invisible lines (i.e., does not draw them)</p>
</td></tr>
<tr><td><code id="Plot.Cusum.Events_+3A_lwdx">lwdx</code></td>
<td>
<p>The line width, a positive number, defaulting to 1. The interpretation is device-specific, and some devices do not implement line widths less than one. (See the help on the device for details of the interpretation.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function print and plot as max 5 units each intent.</p>


<h3>Value</h3>

<p>Print the data correspond to the selects units</p>


<h3>Note</h3>

<p>This graph is useful because it facilitates the processes of counting in the units</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.</p>


<h3>See Also</h3>

<p>Plot.Data, Events, Plot. Surv.Rec</p>


<h3>Examples</h3>

<pre><code class='language-R'>XL&lt;-data(TBCplapyr)
 #TBCplapyr
 # See, the unit number 1 to 24
 Plot.Cusum.Events(TBCplapyr,1,24,"green","red",2,1)
 # See, the unit number 10 to 12
 Plot.Cusum.Events(TBCplapyr,10,12,"pink","blue",1,3)
 # See, the unit number 5 to 9
 Plot.Cusum.Events(TBCplapyr,5,11,,,2,3)
</code></pre>

<hr>
<h2 id='Plot.Data.Events'>Plot data with recurrent events</h2><span id='topic+Plot.Data.Events'></span>

<h3>Description</h3>

<p>This function plot data with recurrent events</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.Data.Events(yy, paciente, inicio, dias, censored, especiales,
                                          colevent="red",colcensor="blue")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.Data.Events_+3A_yy">yy</code></td>
<td>
<p>Data type recurrent events. Examples: TBCplapyr, TBCplathi or TBCpyrthi</p>
</td></tr>
<tr><td><code id="Plot.Data.Events_+3A_paciente">paciente</code></td>
<td>
<p>Vector of number of units on the data base</p>
</td></tr>
<tr><td><code id="Plot.Data.Events_+3A_inicio">inicio</code></td>
<td>
<p>Vector, its assumed that the units are observed from one time equal to zero.</p>
</td></tr>
<tr><td><code id="Plot.Data.Events_+3A_dias">dias</code></td>
<td>
<p>Vector of the periods of observations of the study untis</p>
</td></tr>
<tr><td><code id="Plot.Data.Events_+3A_censored">censored</code></td>
<td>
<p>vector of times of censorship for each unit</p>
</td></tr>
<tr><td><code id="Plot.Data.Events_+3A_especiales">especiales</code></td>
<td>
<p>Three-column matrix containing the identification of the units of study in each observation, the times of occurrence of the event or censorship and type of event.</p>
</td></tr>
<tr><td><code id="Plot.Data.Events_+3A_colevent">colevent</code></td>
<td>
<p>Color event identifier.</p>
</td></tr>
<tr><td><code id="Plot.Data.Events_+3A_colcensor">colcensor</code></td>
<td>
<p> Color censored data identifier.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot shows the recuurence of the events on the time</p>


<h3>Value</h3>

<p>This function returned the pictorial representation of the set of recurrence events data</p>


<h3>Note</h3>

<p>We recommend users to use routines similar to the example.</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>).Pruebas no parametricas para comparar curvas de supervivencia de dos grupos que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.// <b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.</p>


<h3>See Also</h3>

<p>Dif.Surv.Rec, Plot.Surv.Rec, Print.Summary</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TBCplapyr)
XL&lt;-data(TBCplapyr)
p&lt;-ncol(TBCplapyr)
N&lt;-nrow(TBCplapyr)
censor&lt;-matrix(TBCplapyr$event)
especiales&lt;-matrix(data=0,nrow(TBCplapyr),3)
especiales[,1]&lt;-matrix(TBCplapyr$id)
especiales[,2]&lt;-matrix(TBCplapyr$Tcal)
especiales[,3]&lt;-matrix(TBCplapyr$event)
niveles&lt;-levels(factor(especiales[,1]))
for(i in 1:N){
for(j in 1:nrow(matrix(niveles))){
if (as.character(especiales[i,1])==niveles[j]) especiales[i,1]&lt;-j}}
StudyPeriod&lt;-matrix(data=0,nrow(matrix(niveles)),1)
start&lt;-matrix(data=0,nrow(matrix(niveles)),1)
k&lt;-0
for(j in 1:N){if (TBCplapyr$event[j]==0){k&lt;-k+1;StudyPeriod[k,1]&lt;-TBCplapyr$Tcal[j]}}
units&lt;-matrix(1:nrow(matrix(niveles)),nrow(matrix(niveles)),1)
Plot.Data.Events(TBCplapyr,units,start,StudyPeriod,censor,especiales,"black","blue")
Plot.Data.Events(TBCplapyr,units,start,StudyPeriod,censor,especiales,"red","black")
</code></pre>

<hr>
<h2 id='Plot.Event.Rec'>This function plots the ocurrence of a event in two scales time</h2><span id='topic+Plot.Event.Rec'></span>

<h3>Description</h3>

<p>Recurrent events are plotted. A plot is returned. The counting processes are a powerful tools in survival analysis. These process consider two scale time, a calendar time and a gap time. This idea originally provides from <b>Gill </b> (<b>1981</b>) and the concept was extended by <b>Pena</b> <em>et al. </em> (<b>2001</b>).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.Event.Rec(yy, xy, xf)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.Event.Rec_+3A_yy">yy</code></td>
<td>
<p>Object type recurrent events data. Example: TBCplapyr</p>
</td></tr>
<tr><td><code id="Plot.Event.Rec_+3A_xy">xy</code></td>
<td>
<p>Identification of the unit to plotted. 'xy = 1' is defect value.</p>
</td></tr>
<tr><td><code id="Plot.Event.Rec_+3A_xf">xf</code></td>
<td>
<p>Argument to plot the ocurrent events of the unit 'xf'. 'xf = 1' is defect value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot is returned.<b> Pena </b> <em>et al.</em> (<b>2001</b>) designed a special graphic, that allows to count the occurrence of events per unit time. Doubly-indexed processes illustration for an case. The graphic shows a case followed during 24.01 months. This patient presents four recurrences at months 7, 10, 16 and 24 from the beginning of study. This fact implies that interoccurrence. times are 7, 3, 6, 8 and the censored time correspond to 0.01 months. Let us assume that we are interested in computing the single processes, N(t) and Y (t) for a selected interoccurrence time t = 5. In this case N(t = 5) = 1 and Y (t = 5) = 3. For the calendar time scale, s = 20, we have N(s = 20) = 3 and Y (s = 20) = 1. Now, let us assume that we would like to know double-indexed processes for both selected interoccurrence and calendar times. Using both time scales we observe that <code class="reqn">N_{14}(s = 20,t = 5)=1</code>, <code class="reqn">Y_{14}(s = 20, t = 5) = 2 </code> and <code class="reqn">\Delta\,N_{14}(s = 20,t = 6) = 1</code>.
</p>


<h3>Author(s)</h3>

<p>Dr. <b> Carlos M. Martinez M.</b> &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.// <b>Pena E., Strawderman R., Hollander, M. </b> (<b>2001</b>). Nonparametric Estimation with Recurrent Event Data. <em> J.A.S.A.</em> 96, 1299-1315.// <b>Gill, R. </b>(<b>1981</b>) Testing with replacement and the product-limit estimator. <em> Ann. Statist.</em>, 9, 853-860.
</p>


<h3>See Also</h3>

<p>Dif.Surv.Rec, Plot.Data.Events</p>


<h3>Examples</h3>

<pre><code class='language-R'>XL&lt;-data(TBCplapyr)
# See, the unit number 14
Plot.Event.Rec(TBCplapyr,14,14)
# See, the unit number 5 
Plot.Event.Rec(TBCplapyr,5,5)
</code></pre>

<hr>
<h2 id='Plot.Surv.Rec'>Plots of thesurvival function from an object with class newTestSurvRec, using PHS or WC models</h2><span id='topic+Plot.Surv.Rec'></span>

<h3>Description</h3>

<p>The survival curves are plotted. Both curves are estimates using PSH o WC estimator. This package is available in language R. This important clearly, that the PHS estimator is of valid use when it assumed that the inter-occurrence times are  IID. Its obvious that this assumption is restrictive in biomedical applications and its use is more valid on the field of engineering. For WC estimated not import if the data is correlated.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.Surv.Rec(XX,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.Surv.Rec_+3A_xx">XX</code></td>
<td>
<p>Data type recurrent events. Example: TBCplapyr</p>
</td></tr>
<tr><td><code id="Plot.Surv.Rec_+3A_...">...</code></td>
<td>
<p>Other objects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The survival curves for both groups are plotted.</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b> &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>).Pruebas no parametricas para comparar curvas de supervivencia de dos grupos que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.// <b>Pena E., Strawderman R., Hollander M.</b> (<b>2001</b>). Nonparametric Estimation with Recurrent Event Data. <em>J.A.S.A.</em> 96, 1299-1315.</p>


<h3>See Also</h3>

<p>Plot.Event.Rec, Dif.Surv.Rec</p>


<h3>Examples</h3>

<pre><code class='language-R'>XL&lt;-data(TBCplapyr)
Plot.Surv.Rec(TBCplapyr)</code></pre>

<hr>
<h2 id='Print.Summary'>Function to print summary of statistics tests to comparison of the survival curves of the groups with recurrent events</h2><span id='topic+Print.Summary'></span>

<h3>Description</h3>

<p>Returns matrices that contain the estimations of the survival curves for both groups. The estimations of survival curves of both groups are made using PSH estimator. The p.values of the tests are returned.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Print.Summary(XX,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Print.Summary_+3A_xx">XX</code></td>
<td>
<p>Object type recurrent events data</p>
</td></tr>
<tr><td><code id="Print.Summary_+3A_...">...</code></td>
<td>
<p>other objects</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Dif.Surv.Rec(XX,...)
</p>


<h3>Value</h3>

<p>Put object type recurrent events data. 
#Print.Summary(TBCplapyr). #Values returned:
</p>

<table>
<tr>
 <td style="text-align: left;">
 time </td><td style="text-align: left;">  n.event</td><td style="text-align: left;">  n.risk</td><td style="text-align: left;">  Surv_G1 </td><td style="text-align: left;"> std.error</td>
</tr>
<tr>
 <td style="text-align: left;">
    1 </td><td style="text-align: left;">        2</td><td style="text-align: left;">     127</td><td style="text-align: left;">  0.984</td><td style="text-align: left;">    0.0110</td>
</tr>
<tr>
 <td style="text-align: left;">
    2 </td><td style="text-align: left;">        9</td><td style="text-align: left;">     124</td><td style="text-align: left;">  0.913</td><td style="text-align: left;">    0.0243</td>
</tr>
<tr>
 <td style="text-align: left;">
    3 </td><td style="text-align: left;">       14</td><td style="text-align: left;">     113</td><td style="text-align: left;">  0.800</td><td style="text-align: left;">    0.0340</td>
</tr>
<tr>
 <td style="text-align: left;">
    4 </td><td style="text-align: left;">        9</td><td style="text-align: left;">      98</td><td style="text-align: left;">  0.726</td><td style="text-align: left;">    0.0380</td>
</tr>
<tr>
 <td style="text-align: left;">
   ...</td><td style="text-align: left;">       ..</td><td style="text-align: left;">      ..</td><td style="text-align: left;">  .....</td><td style="text-align: left;">    ......</td>
</tr>
<tr>
 <td style="text-align: left;">
   ...</td><td style="text-align: left;">       ..</td><td style="text-align: left;">      ..</td><td style="text-align: left;">  .....</td><td style="text-align: left;">    ......</td>
</tr>
<tr>
 <td style="text-align: left;">   
   29 </td><td style="text-align: left;">        1</td><td style="text-align: left;">      18</td><td style="text-align: left;">  0.244</td><td style="text-align: left;">    0.0422</td>
</tr>
<tr>
 <td style="text-align: left;">
   31 </td><td style="text-align: left;">        1</td><td style="text-align: left;">      13</td><td style="text-align: left;">  0.225</td><td style="text-align: left;">    0.0427</td>
</tr>
<tr>
 <td style="text-align: left;">
   35 </td><td style="text-align: left;">        1</td><td style="text-align: left;">       9</td><td style="text-align: left;">  0.200</td><td style="text-align: left;">    0.0439</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;">
  time</td><td style="text-align: left;"> n.event</td><td style="text-align: left;"> n.risk</td><td style="text-align: left;"> Surv_G2 </td><td style="text-align: left;"> std.error</td>
</tr>
<tr>
 <td style="text-align: left;">
     1</td><td style="text-align: left;">       3</td><td style="text-align: left;">     84</td><td style="text-align: left;"> 0.964</td><td style="text-align: left;">    0.0199</td>
</tr>
<tr>
 <td style="text-align: left;">
     2</td><td style="text-align: left;">       6</td><td style="text-align: left;">     81</td><td style="text-align: left;"> 0.893</td><td style="text-align: left;">    0.0327</td>
</tr>
<tr>
 <td style="text-align: left;">
     3</td><td style="text-align: left;">      12</td><td style="text-align: left;">     73</td><td style="text-align: left;"> 0.746</td><td style="text-align: left;">    0.0447</td>
</tr>
<tr>
 <td style="text-align: left;">
     4</td><td style="text-align: left;">      10</td><td style="text-align: left;">     61</td><td style="text-align: left;"> 0.624</td><td style="text-align: left;">    0.0494</td>
</tr>
<tr>
 <td style="text-align: left;">
   ...</td><td style="text-align: left;">      ..</td><td style="text-align: left;">     ..</td><td style="text-align: left;"> .....</td><td style="text-align: left;">    ......</td>
</tr>
<tr>
 <td style="text-align: left;">
   ...</td><td style="text-align: left;">      ..</td><td style="text-align: left;">     ..</td><td style="text-align: left;"> .....</td><td style="text-align: left;">    ......</td>
</tr>
<tr>
 <td style="text-align: left;">  
    15</td><td style="text-align: left;">       1</td><td style="text-align: left;">     17</td><td style="text-align: left;"> 0.283</td><td style="text-align: left;">    0.0514</td>
</tr>
<tr>
 <td style="text-align: left;">
    42</td><td style="text-align: left;">       1</td><td style="text-align: left;">      6</td><td style="text-align: left;"> 0.236</td><td style="text-align: left;">    0.0582</td>
</tr>
<tr>
 <td style="text-align: left;">
    44</td><td style="text-align: left;">       1</td><td style="text-align: left;">      5</td><td style="text-align: left;"> 0.189</td><td style="text-align: left;">    0.0599</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Group Median
</p>

<table>
<tr>
 <td style="text-align: left;">
        Group</td><td style="text-align: left;"> Median</td>
</tr>
<tr>
 <td style="text-align: left;">
 Pooled Group</td><td style="text-align: left;">      8</td>
</tr>
<tr>
 <td style="text-align: left;">
    1er Group</td><td style="text-align: left;">      9</td>
</tr>
<tr>
 <td style="text-align: left;">
    2do Group</td><td style="text-align: left;">      6</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;">
 Nomb.Est</td><td style="text-align: left;">  Chi.square</td><td style="text-align: left;">   p.value</td>
</tr>
<tr>
 <td style="text-align: left;">
 LRrec   </td><td style="text-align: left;">  0.3052411 </td><td style="text-align: left;"> 0.5806152</td>
</tr>
<tr>
 <td style="text-align: left;">
 Grec    </td><td style="text-align: left;">  1.4448446 </td><td style="text-align: left;"> 0.2293570</td>
</tr>
<tr>
 <td style="text-align: left;">
 TWrec   </td><td style="text-align: left;">  0.9551746 </td><td style="text-align: left;"> 0.3284056</td>
</tr>
<tr>
 <td style="text-align: left;">
 PPrec   </td><td style="text-align: left;">  1.1322772 </td><td style="text-align: left;"> 0.2872901</td>
</tr>
<tr>
 <td style="text-align: left;">
 PMrec   </td><td style="text-align: left;">  1.1430319 </td><td style="text-align: left;"> 0.2850126</td>
</tr>
<tr>
 <td style="text-align: left;">
 PPrrec  </td><td style="text-align: left;">  1.1834042 </td><td style="text-align: left;"> 0.2766641</td>
</tr>
<tr>
 <td style="text-align: left;">
 HFrec   </td><td style="text-align: left;">  0.3052411 </td><td style="text-align: left;"> 0.5806152</td>
</tr>
<tr>
 <td style="text-align: left;">
 CMrec   </td><td style="text-align: left;">  0.3052411 </td><td style="text-align: left;"> 0.5806152</td>
</tr>
<tr>
 <td style="text-align: left;">
 Mrec    </td><td style="text-align: left;">  1.5298763 </td><td style="text-align: left;"> 0.2161310</td>
</tr>
<tr>
 <td style="text-align: left;">
 </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b> &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.</p>


<h3>See Also</h3>

<p>Dif.Surv.Rec, Plot.Surv.Rec</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TBCplapyr)
Print.Summary(TBCplapyr)
</code></pre>

<hr>
<h2 id='PSH.fit'>Estimator of the survival curve  using the estimator developed by Pena, Strawderman and Hollander</h2><span id='topic+PSH.fit'></span>

<h3>Description</h3>

<p> Estimation of survival function for recurrence time data by means the generalized product limit estimator (PLE) method developed by Pena, Strawderman and Hollander. The resulting object of class Survrecu is plotted by plot, before it is returned.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PSH.fit(x, tvals)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PSH.fit_+3A_x">x</code></td>
<td>
<p>a survival recurrent event object</p>
</td></tr>
<tr><td><code id="PSH.fit_+3A_tvals">tvals</code></td>
<td>
<p>vector of times where the survival function can be estimated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimator computed by this object is the nonparametric estimator of the inter-event time survivor function under the assumption of a renewal or IID model. This generalizes the product-limit estimator to the situation where the event is recurrent. For details and the theory behind this estimator, please refer to Pena, Strawderman and Hollander (2001, JASA).</p>


<h3>Value</h3>

<p>Value returned
</p>
<table role = "presentation">
<tr><td><code>n</code></td>
<td>
<p>number of unit or subjects observed.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>vector of number of recurrences in each subject (length n)</p>
</td></tr>
<tr><td><code>failed</code></td>
<td>
<p>vector of number of recurrences in each subject (length n*m). Vector ordered (e.g. times of first unit, times of second unit, ..., times of n-unit)</p>
</td></tr>
<tr><td><code>censored</code></td>
<td>
<p>vector of times of censorship for each subject (length n)</p>
</td></tr>
<tr><td><code>numdistinct</code></td>
<td>
<p>number of distinct failures times.</p>
</td></tr>
<tr><td><code>distinct</code></td>
<td>
<p>vector of distinct failures times.</p>
</td></tr>
<tr><td><code>AtRisk</code></td>
<td>
<p>matrix of number of persons-at-risk at each distinct time and for each subject</p>
</td></tr>
<tr><td><code>survfunc</code></td>
<td>
<p>vector of survival estimated in distinct times</p>
</td></tr>
<tr><td><code>tvals</code></td>
<td>
<p>copy of argument.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function was originally performed by the survrec package, which solved the adjustment problem of the PSH estimator using Fortran routines. With the permission of its author, the algorithm of the packet base was taken, modified, the algorithm of the PSH estimates was reprogrammed and adapted to the needs of the newTestSurvRec package and thus avoid dependence.</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Pena, E.A., Strawderman, R. and Hollander  M.</b> (<b>2001</b>). Nonparametric Estimation with Recurrent Event Data. <em>J. Amer. Statist. Assoc.</em> 96, 1299-1315.// <b>Pena E., Strawderman R., Hollander, M.</b> (<b>2001</b>). Nonparametric Estimation with Recurrent Event Data. <em>J.A.S.A.</em> 96, 1299-1315.</p>


<h3>See Also</h3>

<p>WC.fit, Survrecu, Plot.Event.Rec, Plot.Surv.Rec, Print.Summary</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MMC.TestSurvRec)
fitPSHa&lt;-PSH.fit(Survrecu(MMC.TestSurvRec$id,MMC.TestSurvRec$time,
                          MMC.TestSurvRec$event))
fitPSHa$surv
fitPSHa$time
plot(fitPSHa$time,fitPSHa$survfunc,type="s" ,ylim=c(0,1),xlim=c(0,max(fitPSHa$time)))
  	  title(main = list("Survival Curve with Recurrent Event Data", 
        cex = 0.8, font = 2.3, col = "dark blue"))
mtext("Research Group: AVANCE USE R!", cex = 0.7, font = 2, 
        col = "dark blue", line = 1)
mtext("Software made by: Dr. Carlos Martinez", cex = 0.6, font = 2, 
        col = "dark red", line = 0)
</code></pre>

<hr>
<h2 id='Qsearch.Fractil'>Calculate the survival time to a selected quantile</h2><span id='topic+Qsearch.Fractil'></span>

<h3>Description</h3>

<p>Auxiliary function called from Dif.Surv.Rec function. Given a FitSurvRec object we obtain the quantile from a survival function using PHS o WC estimators.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qsearch.Fractil(fr, qr = 0.5)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Qsearch.Fractil_+3A_fr">fr</code></td>
<td>
<p>FitSurvRec object</p>
</td></tr>
<tr><td><code id="Qsearch.Fractil_+3A_qr">qr</code></td>
<td>
<p>quantile. Default is 0.5</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the time in a selected quantile</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>). Pruebas no parametricas para comparar curvas de supervivencia de dos grupos  que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.// <b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.</p>


<h3>See Also</h3>

<p>FitSurvRe, Survrecu, is.Survrecu</p>


<h3>Examples</h3>

<pre><code class='language-R'>XL&lt;-data(MMC.TestSurvRec)
fit&lt;-FitSurvRec(Survrecu(id,time,event)~1,data=MMC.TestSurvRec)
# 35th percentile from the survival function
Qsearch.Fractil(fit,q=0.35)
	 </code></pre>

<hr>
<h2 id='Survrecu'>Create a Survival recurrent object type newTestSurvRec</h2><span id='topic+Survrecu'></span>

<h3>Description</h3>

<p>Create a survival recurrent object, usually used as a response variable in a model formula</p>


<h3>Usage</h3>

<pre><code class='language-R'>Survrecu(id, time, event)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Survrecu_+3A_id">id</code></td>
<td>
<p>Identifier of each subject. This value is the same for all recurrent times of each subject.</p>
</td></tr>
<tr><td><code id="Survrecu_+3A_time">time</code></td>
<td>
<p>time of recurrence. For each subject the last time are censored.</p>
</td></tr>
<tr><td><code id="Survrecu_+3A_event">event</code></td>
<td>
<p>The status indicator, 0=no recurrence 1=recurrence. Only these values are accepted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class newTestSurvRec is returned. newTestSurRec object is implemented as a matrix of 3 colummns. No method for print. In the case of is.Survrecu, a logical value TRUE if x inherits from class Survrecu, otherwise an FALSE.</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.</p>


<h3>See Also</h3>

<p>FitSurvRec, is.Survrecu</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MMC.TestSurvRec)
Survrecu(MMC.TestSurvRec$id,MMC.TestSurvRec$time,MMC.TestSurvRec$event)~1</code></pre>

<hr>
<h2 id='TBCplapyr'>Data  in patients with bladder cancer treated with placebo or pyridoxine</h2><span id='topic+TBCplapyr'></span>

<h3>Description</h3>

<p>This database corresponds to the time of recurrence of tumors in 78 patients with bladder cancer. Patients were randomly assigned to treatments: placebo (47 patients) and pyridoxine (31 patients). Data type data.frame with 222 observations on 8 variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(TBCplapyr)</code></pre>


<h3>Format</h3>

<p> A data frame with 222 observations on the following 9 variables.
</p>

<dl>
<dt><code>j</code></dt><dd><p>Observation number</p>
</dd>
<dt><code>id</code></dt><dd><p>ID of each unit. Repeated for each recurrence</p>
</dd>
<dt><code>Tinicio</code></dt><dd><p>Inicial time</p>
</dd>
<dt><code>time</code></dt><dd><p>recurrence o censoring time. For each unit the last time is censored</p>
</dd>
<dt><code>Tcal</code></dt><dd><p>Time if observation for each unit</p>
</dd>
<dt><code>event</code></dt><dd><p>censoring status. 1 = occurrence of the event in the unit and 0 right censored time</p>
</dd>
<dt><code>strata</code></dt><dd><p>Number of strata</p>
</dd>
<dt><code>trt</code></dt><dd><p>a factor with levels <code class="reqn">Placebo</code> or <code class="reqn">Pyridoxine</code></p>
</dd>
<dt><code>group</code></dt><dd><p>A factor with levels. Group identification</p>
</dd>
</dl>



<h3>Details</h3>

<p>Experiment <b>Byar</b>(<b>1980</b>). The database Byar experiment is used and the time (months) of recurrence of tumors in 116 sick patients with superficial bladder cancer is measured. These patients were randomly allocated to the following treatments: placebo (47 patients), pyridoxine (31 patients) and thiotepa (38 patients). </p>


<h3>Source</h3>

<p><b>Andrews D. </b>, <b>Herzberg A.</b>, (<b>1985</b>). Data. A collections of problems from many fields for the student and reserarch worker, Springer series in statistics, Springer-Verlag, USA</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>).Pruebas no parametricas para comparar curvas de supervivencia de dos grupos que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.// <b>Martinez, C. (2009)</b>. Generalizacion de algunas pruebas clasicas de comparacion de curvas de supervivencia al caso de eventos de naturaleza recurrente. Tesis doctoral.<em> Universidad Central de Venezuela (UCV)</em>. Caracas-Venezuela.// <b>Pena E., Strawderman R., Hollander M.</b> (<b>2001</b>). Nonparametric Estimation with Recurrent Event Data. <em>J.A.S.A.</em> 96, 1299-1315.</p>


<h3>Examples</h3>

<pre><code class='language-R'>XL&lt;-data(TBCplapyr)
XL&lt;-data(TBCplapyr)
print(XL)
Print.Summary(TBCplapyr)
</code></pre>

<hr>
<h2 id='TBCplathi'>Data in patients with bladder cancer treated as placebo or thiotepa</h2><span id='topic+TBCplathi'></span>

<h3>Description</h3>

<p>This database corresponds to the time of recurrence of tumors of 85 patients with bladder cancer. Patients were randomly assigned to treatments: placebo (47 patients) and thiotepa (38 patients). Data type data.frame with 217 observations on 8 variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(TBCplathi)</code></pre>


<h3>Format</h3>

<p> A data frame with 217 observations on the following 9 variables.
</p>

<dl>
<dt><code>j</code></dt><dd><p>Observation number</p>
</dd>
<dt><code>id</code></dt><dd><p>ID of each unit. Repeated for each recurrence</p>
</dd>
<dt><code>Tinicio</code></dt><dd><p>Inicial time</p>
</dd>
<dt><code>time</code></dt><dd><p>recurrence o censoring time. For each unit the last time is censored</p>
</dd>
<dt><code>Tcal</code></dt><dd><p>Time if observation for each unit</p>
</dd>
<dt><code>event</code></dt><dd><p>censoring status. 1 = ocurrence of the event in the unit and 0 right censored time</p>
</dd>
<dt><code>strata</code></dt><dd><p>Number of strata</p>
</dd>
<dt><code>trt</code></dt><dd><p>a factor with levels <code class="reqn">Placebo</code> or <code class="reqn">Thiotepa</code></p>
</dd>
<dt><code>group</code></dt><dd><p>A factor with levels. Group identificator</p>
</dd>
</dl>



<h3>Details</h3>

<p>Experiment <b>Byar</b> (<b>1980</b>). The database Byar experiment is used and the time (months) of recurrence of tumors in 116 sick patients with superficial bladder cancer is measured. These patients were randomly allocated to the following treatments: placebo (47 patients), pyridoxine (31 patients) and thiotepa (38 patients).</p>


<h3>Source</h3>

<p><b>Andrews D.</b>, <b>Herzberg A.</b>, (<b>1985</b>). Data. A collections of problems from many fields for the student and reserarch worker, <em>Springer series in statistics, Springer-Verlag</em>, USA</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>).Pruebas no parametricas para comparar curvas de supervivencia de dos grupos que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.// <b>Pena E., Strawderman R., Hollander M.</b> (<b>2001</b>). Nonparametric Estimation with Recurrent  Event Data. <em>J.A.S.A.</em> 96, 1299-1315.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TBCplathi)
XL&lt;-data(TBCplathi)
print(XL)
Print.Summary(TBCplathi)
## maybe str(TBCplathi) ; plot(TBCplathi) ...
</code></pre>

<hr>
<h2 id='TBCpyrthi'>Data in patients with bladder cancers and treated with pyridoxine or thiotepa</h2><span id='topic+TBCpyrthi'></span>

<h3>Description</h3>

<p>This database corresponds to the time of recurrence of tumors of 69 patients with bladder cancer. Patients were randomly assigned to treatments: pyridoxine (38 patients) and thiotepa (31 patients). Data type data.frame with 171 observations on 8 variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(TBCpyrthi)</code></pre>


<h3>Format</h3>

<p> A data frame with 171 observations on the following 9 variables.
</p>

<dl>
<dt><code>j</code></dt><dd><p>Observation number</p>
</dd>
<dt><code>id</code></dt><dd><p>ID of each unit. Repeated for each recurrence</p>
</dd>
<dt><code>Tinicio</code></dt><dd><p>Inicial time</p>
</dd>
<dt><code>time</code></dt><dd><p>recurrence o censoring time. For each unit the last time is censored</p>
</dd>
<dt><code>Tcal</code></dt><dd><p>Time if observation for each unit</p>
</dd>
<dt><code>event</code></dt><dd><p>censoring status. 1 = ocurrence of the event in the unit and' 0 right censored time</p>
</dd>
<dt><code>strata</code></dt><dd><p>Number of strata</p>
</dd>
<dt><code>trt</code></dt><dd><p>a factor with levels <code class="reqn">Pyridoxine</code> or <code class="reqn">Thiotepa</code></p>
</dd>
<dt><code>group</code></dt><dd><p>A factor with levels. Group identificator</p>
</dd>
</dl>



<h3>Details</h3>

<p>Experiment <b>Byar</b> (<b>1980</b>). The database Byar experiment is used and the time (months) of recurrence of tumors in 116 sick patients with superficial bladder cancer is measured. These patients were randomly allocated to the following treatments: placebo (47 patients), pyridoxine (31 patients) and thiotepa (38 patients).</p>


<h3>Source</h3>

<p><b>Andrews D., Herzberg A.</b>, (<b>1985</b>). Data. A collections of problems from many fields for the student and reserarch worker, <em>Springer series in statistics, Springer-Verlag</em>, USA</p>


<h3>References</h3>

<p><b>Martinez C., Ramirez, G., Vasquez M.</b> (<b>2009</b>).Pruebas no parametricas para comparar curvas de supervivencia de dos grupos  que experimentan eventos recurrentes. Propuestas. <em>Revista Ingenieria U.C.</em>,Vol 16, 3, 45-55.//<b>Pena E., Strawderman R., Hollander M.</b> (<b>2001</b>). Nonparametric Estimation with Recurrent Event Data. <em>J.A.S.A.</em> 96, 1299-1315.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TBCpyrthi)
XL&lt;-data(TBCpyrthi)
print(XL)
Print.Summary(TBCpyrthi)
## maybe str(TBCpyrthi) ; plot(TBCpyrthi) ...
</code></pre>

<hr>
<h2 id='WC.fit'>Survival function estimator for recurrence time data using the estimator developed by Wang and Chang</h2><span id='topic+WC.fit'></span>

<h3>Description</h3>

<p>Estimation of survival function for correlated by the product limit estimator PLE method developed by Wang and Chang.</p>


<h3>Usage</h3>

<pre><code class='language-R'>WC.fit(x, tvals)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WC.fit_+3A_x">x</code></td>
<td>
<p>a survival recurrent event object</p>
</td></tr>
<tr><td><code id="WC.fit_+3A_tvals">tvals</code></td>
<td>
<p>vector of times where the survival function can be estimated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wang-Chang (1999) proposed an estimator of the common marginal survivor function in the case where within-unit inter-occurrence times are correlated. The correlation structure considered by Wang and Chang (1999) is quite general and contains, in particular, both the i.i.d. and multiplicative (hence gamma) frailty model as special cases. This estimator removes the bias noted for the product-limit estimator developed by Pena, Strawderman and Hollander (PSH, 2001) when inter-occurrence times are correlated within units. However, when applied to i.i.d. inter-occurrence times, this estimator is not expected to perform as well as the PSH estimator, especially with regard to efficiency.</p>


<h3>Value</h3>

<p>Value returned
</p>
<table role = "presentation">
<tr><td><code>n</code></td>
<td>
<p>number of unit or subjects observed.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>vector of number of recurrences in each subject (length n)</p>
</td></tr>
<tr><td><code>failed</code></td>
<td>
<p>vector of number of recurrences in each subject (length n*m). Vector ordered (e.g. times of first unit, times of second unit, ..., times of n-unit)</p>
</td></tr>
<tr><td><code>censored</code></td>
<td>
<p>vector of times of censorship for each subject (length n)</p>
</td></tr>
<tr><td><code>numdistinct</code></td>
<td>
<p>number of distinct failures times.</p>
</td></tr>
<tr><td><code>distinct</code></td>
<td>
<p>vector of distinct failures times.</p>
</td></tr>
<tr><td><code>AtRisk</code></td>
<td>
<p>matrix of number of persons-at-risk at each distinct time and for each subject</p>
</td></tr>
<tr><td><code>survfunc</code></td>
<td>
<p>vector of survival estimated in distinct times</p>
</td></tr>
<tr><td><code>tvals</code></td>
<td>
<p>copy of argument.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function was originally performed by the survrec package, which solved the adjustment problem of the WC estimator using Fortran routines. With the permission of its author, the algorithm was taken, modified, the algorithm, WC estimator was reprogrammed and adapted to the needs of the newTestSurvRec package and thus avoid dependence.</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Wang, M. C. and Chang, S.H.</b> (<b>1999</b>). Nonparametric Estimation of a Recurrent Survival Function. <em>J. Amer. Statist. Assoc.</em> 94, 146-153.// <b>Pena E., Strawderman R., Hollander M.</b> (<b>2001</b>). Nonparametric Estimation with Recurrent
Event Data. <em>J.A.S.A.</em> 96, 1299-1315.</p>


<h3>See Also</h3>

<p>PSH.fit, Plot.Event.Rec, Plot.Surv.Rec, Print.Summary</p>


<h3>Examples</h3>

<pre><code class='language-R'>XL&lt;-data(MMC.TestSurvRec)
#-------------------------------------------------------------------------------------
fitPSHa&lt;-PSH.fit(Survrecu(MMC.TestSurvRec$id,MMC.TestSurvRec$time,
                        MMC.TestSurvRec$event))
fitPSHa$surv
fitPSHa$time
plot(fitPSHa$time,fitPSHa$survfunc,type="s" ,ylim=c(0,1),
        xlim=c(0,max(fitPSHa$time)))
title(main = list("Survival Curve with Recurrent Event Data", 
        cex = 0.8, font = 2.3, col = "dark blue"))
mtext("Research Group: AVANCE USE R!", cex = 0.7, font = 2, 
        col = "dark blue", line = 1)
mtext("Software made by: Dr. Carlos Martinez", cex = 0.6, font = 2, 
        col = "dark red", line = 0)


fitWCa&lt;-WC.fit(Survrecu(MMC.TestSurvRec$id,MMC.TestSurvRec$time,
                        MMC.TestSurvRec$event))
fitWCa$surv
fitWCa$time
plot(fitWCa$time,fitWCa$survfunc,type="s" ,ylim=c(0,1),
        xlim=c(0,max(fitWCa$time)))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
