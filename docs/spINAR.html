<!DOCTYPE html><html lang="en"><head><title>Help for package spINAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spINAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#spINAR-package'><p>(Semi)parametric estimation and bootstrapping of INAR models</p></a></li>
<li><a href='#spinar_boot'><p>(Semi)parametric INAR bootstrap procedure</p></a></li>
<li><a href='#spinar_est'><p>Semiparametric estimation of INAR models</p></a></li>
<li><a href='#spinar_est_param'><p>Parametric estimation of INAR models</p></a></li>
<li><a href='#spinar_penal'><p>Penalized semiparametric estimation of INAR models</p></a></li>
<li><a href='#spinar_penal_val'><p>Validated penalized semiparametric estimation of INAR models</p></a></li>
<li><a href='#spinar_sim'><p>Simulation of (semi)parametric integer autoregressive (INAR) models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>(Semi)Parametric Estimation and Bootstrapping of INAR Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-08</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maxime Faymonville &lt;faymonville@statistik.tu-dortmund.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Semiparametric and parametric estimation of INAR models including a finite sample refinement (Faymonville et al. (2022) &lt;<a href="https://doi.org/10.1007%2Fs10260-022-00655-0">doi:10.1007/s10260-022-00655-0</a>&gt;) for the semiparametric setting introduced in Drost et al. (2009) &lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2008.00687.x">doi:10.1111/j.1467-9868.2008.00687.x</a>&gt;, different procedures to bootstrap INAR data (Jentsch, C. and Weiß, C.H. (2017) &lt;<a href="https://doi.org/10.3150%2F18-BEJ1057">doi:10.3150/18-BEJ1057</a>&gt;) and flexible simulation of INAR data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate (&ge; 1.8.5), progress, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MFaymon/spINAR">https://github.com/MFaymon/spINAR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MFaymon/spINAR/issues">https://github.com/MFaymon/spINAR/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-08 13:32:13 UTC; faymonville</td>
</tr>
<tr>
<td>Author:</td>
<td>Maxime Faymonville
    <a href="https://orcid.org/0000-0001-5565-0711"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Javiera Riffo <a href="https://orcid.org/0000-0002-5372-7196"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Jonas Rieger <a href="https://orcid.org/0000-0002-0007-4478"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Carsten Jentsch <a href="https://orcid.org/0000-0001-7824-1697"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Christian H. Weiß <a href="https://orcid.org/0000-0001-8739-6631"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-08 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='spINAR-package'>(Semi)parametric estimation and bootstrapping of INAR models</h2><span id='topic+spINAR'></span><span id='topic+spINAR-package'></span>

<h3>Description</h3>

<p>Semiparametric and parametric estimation of INAR models
including a finite sample refinement for the semiparametric setting, different
procedures to bootstrap INAR data and flexible simulation of INAR data.
</p>


<h3>Semiparametric INAR Model</h3>

<p>The package provides a flexible simulation of INAR data by inserting a user-defined
pmf argument in the <code><a href="#topic+spinar_sim">spinar_sim</a></code> function. Using <code><a href="#topic+spinar_est">spinar_est</a></code>,
it allows for semiparametric estimation of the INAR model along Drost et al. (2009)
and additionally, it includes a small sample refinement <code><a href="#topic+spinar_penal">spinar_penal</a></code>
(Faymonville et al., 2022) together with a validation of the upcoming penalization
parameters (<code><a href="#topic+spinar_penal_val">spinar_penal_val</a></code>). Furthermore, it contains a semiparametric
INAR bootstrap procedure implemented in <code><a href="#topic+spinar_boot">spinar_boot</a></code> (Jentsch and Weiß, 2017).
</p>


<h3>Parametric INAR Model</h3>

<p>In addition to the semiparametric model, the package also allows for parametric simulation
(<code><a href="#topic+spinar_sim">spinar_sim</a></code>), parametric estimation (<code><a href="#topic+spinar_est_param">spinar_est_param</a></code>) and
parametric bootstrapping (<code><a href="#topic+spinar_boot">spinar_boot</a></code>) of INAR data.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Maxime Faymonville <a href="mailto:faymonville@statistik.tu-dortmund.de">faymonville@statistik.tu-dortmund.de</a> (<a href="https://orcid.org/0000-0001-5565-0711">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Javiera Riffo <a href="mailto:javiera.riffo@tu-dortmund.de">javiera.riffo@tu-dortmund.de</a> (<a href="https://orcid.org/0000-0002-5372-7196">ORCID</a>)
</p>
</li>
<li><p> Jonas Rieger <a href="mailto:rieger@statistik.tu-dortmund.de">rieger@statistik.tu-dortmund.de</a> (<a href="https://orcid.org/0000-0002-0007-4478">ORCID</a>)
</p>
</li>
<li><p> Carsten Jentsch <a href="mailto:jentsch@statistik.tu-dortmund.de">jentsch@statistik.tu-dortmund.de</a> (<a href="https://orcid.org/0000-0001-7824-1697">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Christian H. Weiß <a href="mailto:weissc@hsu-hh.de">weissc@hsu-hh.de</a> (<a href="https://orcid.org/0000-0001-8739-6631">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>Faymonville, M., Jentsch, C., Weiß, C.H. and Aleksandrov, B. (2022).
&quot;Semiparametric Estimation of INAR Models using Roughness Penalization&quot;.
Statistical Methods &amp; Applications. <a href="https://doi.org/10.1007/s10260-022-00655-0">doi:10.1007/s10260-022-00655-0</a>.
</p>
<p>Jentsch, C. and Weiß, C. H. (2017), “Bootstrapping INAR Models”.
Bernoulli 25(3), pp. 2359&ndash;2408. <a href="https://doi.org/10.3150/18-BEJ1057">doi:10.3150/18-BEJ1057</a>.
</p>
<p>Drost, F., Van den Akker, R. and Werker, B. (2009), “Efficient estimation of
auto-regression parameters and innovation distributions for semiparametric
integer-valued AR(p) models”. Journal of the Royal Statistical Society.
Series B 71(2), pp. 467&ndash;485. <a href="https://doi.org/10.1111/j.1467-9868.2008.00687.x">doi:10.1111/j.1467-9868.2008.00687.x</a>.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/MFaymon/spINAR">https://github.com/MFaymon/spINAR</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/MFaymon/spINAR/issues">https://github.com/MFaymon/spINAR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='spinar_boot'>(Semi)parametric INAR bootstrap procedure</h2><span id='topic+spinar_boot'></span>

<h3>Description</h3>

<p>INAR bootstrap procedures for the semiparametric and the parametric INAR setting, where the latter allows for
moment- and maximum likelihood-based estimation and Poisson, geometrically and negative binomially distributed innovations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spinar_boot(
  x,
  p,
  B,
  setting,
  type = "mom",
  distr = "poi",
  M = 100,
  level = 0.05,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spinar_boot_+3A_x">x</code></td>
<td>
<p>[<code>integer</code>]<br />
vector with integer observations.</p>
</td></tr>
<tr><td><code id="spinar_boot_+3A_p">p</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
order of the INAR model, where <code class="reqn">\code{p} \in \{1,2\}</code>.</p>
</td></tr>
<tr><td><code id="spinar_boot_+3A_b">B</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
number of bootstrap repetitions.</p>
</td></tr>
<tr><td><code id="spinar_boot_+3A_setting">setting</code></td>
<td>
<p>[<code>string(1)</code>]<br />
estimation setting <code class="reqn">\in \code{\{"sp", "p"\}}</code>, where <code>"sp"</code> defines a semiparametric setting and
<code>"p"</code> a parametric setting.</p>
</td></tr>
<tr><td><code id="spinar_boot_+3A_type">type</code></td>
<td>
<p>[<code>string(1)</code>]<br />
type of estimation <code class="reqn">\in \code{\{"mom", "ml"\}}</code>, where <code>"mom"</code> (default) performs moment-based estimation and
<code>"ml"</code> maximum likelihood-based estimation.</p>
</td></tr>
<tr><td><code id="spinar_boot_+3A_distr">distr</code></td>
<td>
<p>[<code>string(1)</code>]<br />
parametric family of innovation distribution <code class="reqn">\in  \code{\{"poi", "geo", "nb"\}}</code>, where <code>"poi"</code> (default) denotes
Poi(<code>lambda</code>), <code>"geo"</code> Geo(<code>prob</code>) and <code>"nb"</code> NB(<code>r</code>, <code>prob</code>) distributions.</p>
</td></tr>
<tr><td><code id="spinar_boot_+3A_m">M</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
upper limit for the innovations.</p>
</td></tr>
<tr><td><code id="spinar_boot_+3A_level">level</code></td>
<td>
<p>[<code>numeric(1)</code>]<br />
level for the bootstrap confidence intervals (percentile interval and Hall's percentile interval
(bootstrap-t-interval without studentization)).</p>
</td></tr>
<tr><td><code id="spinar_boot_+3A_progress">progress</code></td>
<td>
<p>[<code>logical(1)</code>]<br />
Should a nice progress bar be shown? Turning it off, could lead to significantly
faster calculation. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>[<code>named list</code>] with entries
</p>

<dl>
<dt><code>x_star</code></dt><dd><p>[<code>matrix</code>] of bootstrap observations with
<code>length(x)</code> rows and <code>B</code> columns.</p>
</dd>
<dt><code>parameters_star</code></dt><dd><p>[<code>matrix</code>] of bootstrap estimated
parameters with <code>B</code> rows.
If <code>setting = "sp"</code>, each row contains
the estimated coefficients <code class="reqn">\code{alpha}_1,...,\code{alpha}_p</code> and the
estimated entries of the pmf <code class="reqn">\code{pmf}_0, \code{pmf}_1</code>, ... where
<code class="reqn">\code{pmf}_i</code> represents the probability of an innovation being equal
to <code class="reqn">i</code>.
If <code>setting = "p"</code>, each row contains the estimated
coefficients <code class="reqn">\code{alpha}_1,...,\code{alpha}_p</code> and the estimated
parameter(s) of the innovation distribution.</p>
</dd>
<dt><code>bs_ci_percentile</code></dt><dd><p>[<code>named matrix</code>] with the lower and
upper bounds of the bootstrap percentile confidence intervals for each
parameter in <code>parameters_star</code>.</p>
</dd>
<dt><code>bs_ci_hall</code></dt><dd><p>[<code>named matrix</code>] with the lower and
upper bounds of Hall's bootstrap percentile confidence intervals for each
parameter in <code>parameters_star</code>.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># generate data
dat1 &lt;- spinar_sim(n = 200, p = 1, alpha = 0.5,
                   pmf = c(0.3, 0.3, 0.2, 0.1, 0.1))
dat2 &lt;- spinar_sim(n = 200, p = 2, alpha = c(0.2, 0.3),
                   pmf = dgeom(0:60, 0.5))


# semiparametric INAR(1) bootstrap
spinar_boot(x = dat1, p = 1, B = 50, setting = "sp")
# parametric Geo-INAR(2) bootstrap using moment-based estimation
spinar_boot(x = dat2, p = 2, B = 50, setting = "p", type = "mom", distr = "geo")


</code></pre>

<hr>
<h2 id='spinar_est'>Semiparametric estimation of INAR models</h2><span id='topic+spinar_est'></span>

<h3>Description</h3>

<p>Semiparametric estimation of the autoregressive parameters and the innovation
distribution of INAR(<code>p</code>) models, <code class="reqn">\code{p} \in \{1,2\}</code>. The
estimation is conducted by maximizing the conditional likelihood of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spinar_est(x, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spinar_est_+3A_x">x</code></td>
<td>
<p>[<code>integer</code>]<br />
vector with integer observations.</p>
</td></tr>
<tr><td><code id="spinar_est_+3A_p">p</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
order of the INAR model, where <code class="reqn">\code{p} \in \{1,2\}</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector containing the estimated coefficients <code class="reqn">\code{alpha}_1,...,\code{alpha}_p</code> and the estimated entries
of the pmf <code class="reqn">\code{pmf}_0, \code{pmf}_1</code>,... where <code class="reqn">\code{pmf}_i</code> represents the probability of
an innovation being equal to <code class="reqn">i</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
dat1 &lt;- spinar_sim(n = 200, p = 1, alpha = 0.5,
                   pmf = c(0.3, 0.3, 0.2, 0.1, 0.1))
dat2 &lt;- spinar_sim(n = 200, p = 2, alpha = c(0.2, 0.3),
                   pmf = c(0.25, 0.2, 0.15, 0.1, 0.1, 0.1, 0.1))


# semiparametric estimation of INAR(1) model
spinar_est(x = dat1, p = 1)
# semiparametric estimation of INAR(2) model
spinar_est(x = dat2, p = 2)

</code></pre>

<hr>
<h2 id='spinar_est_param'>Parametric estimation of INAR models</h2><span id='topic+spinar_est_param'></span>

<h3>Description</h3>

<p>Parametric estimation of the autoregressive parameters and the innovation distribution of INAR(<code>p</code>) models,
<code class="reqn">\code{p} \in \{1,2\}</code>, with Poisson, geometrically or negative binomially distributed innovations. The estimation can either be
moment- or maximum likelihood-based.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spinar_est_param(x, p, type, distr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spinar_est_param_+3A_x">x</code></td>
<td>
<p>[<code>integer</code>]<br />
vector with integer observations.</p>
</td></tr>
<tr><td><code id="spinar_est_param_+3A_p">p</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
order of the INAR model, where <code class="reqn">\code{p} \in \{1,2\}</code>.</p>
</td></tr>
<tr><td><code id="spinar_est_param_+3A_type">type</code></td>
<td>
<p>[<code>string(1)</code>]<br />
type of estimation <code class="reqn">\in \code{\{"mom", "ml"\}}</code>, where <code>"mom"</code> performs moment-based estimation and
<code>"ml"</code> maximum likelihood-based estimation.</p>
</td></tr>
<tr><td><code id="spinar_est_param_+3A_distr">distr</code></td>
<td>
<p>[<code>string(1)</code>]<br />
parametric family of innovation distribution <code class="reqn">\in  \code{\{'poi', 'geo', 'nb'\}}</code>, where <code>"poi"</code> denotes
Poi(<code>lambda</code>), <code>"geo"</code> Geo(<code>prob</code>) and <code>"nb"</code> NB(<code>r</code>, <code>prob</code>) distributions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named vector containing the estimated coefficients <code class="reqn">\code{alpha}_1,...,\code{alpha}_p</code> and the estimated parameter(s)
of the innovation distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
# Poi-INAR(1) data
dat1 &lt;- spinar_sim(n = 200, p = 1, alpha = 0.5, pmf = dpois(0:20, 1))
# Geo-INAR(2) data
dat2 &lt;- spinar_sim(n = 200, p = 2, alpha = c(0.2, 0.3),
                   pmf = dgeom(0:60, 0.5))
# NB-INAR(1) data
dat3 &lt;- spinar_sim(n = 200, p = 1, alpha = 0.5, pmf = dnbinom(0:40, 2, 2/3))

# moment-based parametric estimation of Poi-INAR(1) model
spinar_est_param(x = dat1, p = 1, type = "mom", distr = "poi")
# moment-based parametric estimation of Geo-INAR(2) model
spinar_est_param(x = dat2, p = 2, type = "mom", distr = "geo")
# maximum likelihood-based parametric estimation of NB-INAR(1) model
spinar_est_param(x = dat3, p = 1, type = "ml", distr = "nb")

</code></pre>

<hr>
<h2 id='spinar_penal'>Penalized semiparametric estimation of INAR models</h2><span id='topic+spinar_penal'></span>

<h3>Description</h3>

<p>Semiparametric penalized estimation of the autoregressive parameters and the innovation distribution of INAR(<code>p</code>) models,
<code class="reqn">\code{p} \in \{1,2\}</code>. The estimation is conducted by maximizing the penalized conditional likelihood of the model. If both
penalization parameters are set to zero, the function coincides to the spinar_est function of this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spinar_penal(x, p, penal1 = 0, penal2 = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spinar_penal_+3A_x">x</code></td>
<td>
<p>[<code>integer</code>]<br />
vector with integer observations.</p>
</td></tr>
<tr><td><code id="spinar_penal_+3A_p">p</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
order of the INAR model, where <code class="reqn">\code{p} \in \{1,2\}</code>.</p>
</td></tr>
<tr><td><code id="spinar_penal_+3A_penal1">penal1</code></td>
<td>
<p><code class="reqn">L_1</code> penalization parameter (default value zero results in no <code class="reqn">L_1</code> penalization)</p>
</td></tr>
<tr><td><code id="spinar_penal_+3A_penal2">penal2</code></td>
<td>
<p><code class="reqn">L_2</code> penalization parameter (default value zero results in  no <code class="reqn">L_2</code> penalization)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector containing the penalized estimated coefficients <code class="reqn">\code{alpha}_1,...,\code{alpha}_p</code> and the penalized
estimated entries of the pmf <code class="reqn">\code{pmf}_0, \code{pmf}_1</code>,... where <code class="reqn">\code{pmf}_i</code> represents the probability of
an innovation being equal to <code class="reqn">i</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
dat1 &lt;- spinar_sim(n = 50, p = 1, alpha = 0.5,
                   pmf = c(0.3, 0.25, 0.2, 0.15, 0.1))

# penalized semiparametric estimation
spinar_penal(x = dat1, p = 1, penal1 = 0, penal2 = 0.1)

</code></pre>

<hr>
<h2 id='spinar_penal_val'>Validated penalized semiparametric estimation of INAR models</h2><span id='topic+spinar_penal_val'></span>

<h3>Description</h3>

<p>Semiparametric penalized estimation of the autoregressive parameters and the innovation distribution of INAR(<code>p</code>) models,
<code class="reqn">\code{p} \in \{1,2\}</code>. The estimation is conducted by maximizing the penalized conditional likelihood of the model.
Included is a possible validation of one or both penalization parameters. If no validation is wanted, the function coincides
to the spinar_penal function of this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spinar_penal_val(
  x,
  p,
  validation,
  penal1 = NA,
  penal2 = NA,
  over = NA,
  folds = 10,
  init1 = 1,
  init2 = 1,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spinar_penal_val_+3A_x">x</code></td>
<td>
<p>[<code>integer</code>]<br />
vector with integer observations.</p>
</td></tr>
<tr><td><code id="spinar_penal_val_+3A_p">p</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
order of the INAR model, where <code class="reqn">\code{p} \in \{1,2\}</code>.</p>
</td></tr>
<tr><td><code id="spinar_penal_val_+3A_validation">validation</code></td>
<td>
<p>[<code>logical(1)</code>]<br />
indicates whether validation is wanted.</p>
</td></tr>
<tr><td><code id="spinar_penal_val_+3A_penal1">penal1</code></td>
<td>
<p>[<code>numeric(1)</code>]<br />
<code class="reqn">L_1</code> penalization parameter.
It will be ignored if <code>validation = TRUE</code> and <code>over</code> <code class="reqn">\in \{"both", "L_1"\}</code>. It is mandatory if <code>validation = FALSE</code>.</p>
</td></tr>
<tr><td><code id="spinar_penal_val_+3A_penal2">penal2</code></td>
<td>
<p>[<code>numeric(1)</code>]<br />
<code class="reqn">L_2</code> penalization parameter.
It will be ignored if <code>validation = TRUE</code> and <code>over</code> <code class="reqn">\in \{"both", "L_2"\}</code>. It is mandatory if <code>validation = FALSE</code>.</p>
</td></tr>
<tr><td><code id="spinar_penal_val_+3A_over">over</code></td>
<td>
<p>[<code>string(1)</code>]<br />
validation over <code>"both"</code> penalization parameters or only over <code>"L_1"</code> or <code>"L_2"</code>.
It is mandatory if <code>validation = TRUE</code>, otherwise it will be ignored.</p>
</td></tr>
<tr><td><code id="spinar_penal_val_+3A_folds">folds</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
number of folds for (cross) validation.</p>
</td></tr>
<tr><td><code id="spinar_penal_val_+3A_init1">init1</code></td>
<td>
<p>[<code>numeric(1)</code>]<br />
initial value for penal1 in validation. Default value is init1 = 1.</p>
</td></tr>
<tr><td><code id="spinar_penal_val_+3A_init2">init2</code></td>
<td>
<p>[<code>numeric(1)</code>]<br />
initial value for penal2 in validation. Default value is init2 = 1</p>
</td></tr>
<tr><td><code id="spinar_penal_val_+3A_progress">progress</code></td>
<td>
<p>[<code>logical(1)</code>]<br />
Should a nice progress bar be shown? Turning it off, could lead to significantly
faster calculation. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>validation = FALSE</code>, the function returns a vector containing the penalized estimated coefficients
<code class="reqn">\code{alpha}_1,...,\code{alpha}_p</code> and the penalized estimated entries of the pmf <code class="reqn">\code{pmf}_0, \code{pmf}_1</code>... where <code class="reqn">\code{pmf}_i</code> represents the probability of
an innovation being equal to <code class="reqn">i</code>.
</p>
<p>If <code>validation = TRUE</code>, the function returns a named list, where the first entry contains
the penalized estimated coefficients <code class="reqn">\code{alpha}_1,...,\code{alpha}_p</code> and the penalized estimated entries of the pmf <code class="reqn">\code{pmf}_0, \code{pmf}_1</code>,... where <code class="reqn">\code{pmf}_i</code> represents the probability of
an innovation being equal to <code class="reqn">i</code>. The second (and if <code>over = both</code> also the third entry) contain(s) the validated penalization parameter(s).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
dat1 &lt;- spinar_sim(n = 50, p = 1, alpha = 0.5,
                   pmf = c(0.3, 0.3, 0.2, 0.1, 0.1))


# penalized semiparametric estimation with validation over L1
spinar_penal_val(x = dat1, p = 1, validation = TRUE, penal2 = 0.1,
                 over = "L1")
# penalized semiparametric estimation with validation over both L1 and L2
spinar_penal_val(x = dat1, p = 1, validation = TRUE, over = "both")

</code></pre>

<hr>
<h2 id='spinar_sim'>Simulation of (semi)parametric integer autoregressive (INAR) models</h2><span id='topic+spinar_sim'></span>

<h3>Description</h3>

<p>Generating INAR(p) observations,
where <code>p</code> <code class="reqn">\in \{1,2\}</code>. It allows for general pmfs
which can be generated parametrically or &quot;manually&quot; (semiparametrically).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spinar_sim(n, p, alpha, pmf, prerun = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spinar_sim_+3A_n">n</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
number of observations.</p>
</td></tr>
<tr><td><code id="spinar_sim_+3A_p">p</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
lag of the INAR(<code>p</code>) model, where <code>p</code> <code class="reqn">\in \{1,2\}</code>.</p>
</td></tr>
<tr><td><code id="spinar_sim_+3A_alpha">alpha</code></td>
<td>
<p>[<code>integer(p)</code>]<br />
vector of INAR coefficients <code class="reqn">\code{alpha}_1,...,\code{alpha}_p</code>.</p>
</td></tr>
<tr><td><code id="spinar_sim_+3A_pmf">pmf</code></td>
<td>
<p>[<code>numeric</code>]<br />
vector of probability mass function
<code class="reqn">\code{pmf}_0,..., \code{pmf}_k</code> where <code class="reqn">\code{pmf}_i</code>
represents the probability of an innovation being equal to <code class="reqn">i</code>.</p>
</td></tr>
<tr><td><code id="spinar_sim_+3A_prerun">prerun</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
number of observations which are generated additionally and then omitted
(to ensure stationarity).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with <code class="reqn">n</code> INAR(<code>p</code>) observations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate (semiparametrically) 100 INAR(1) observations with
# alpha_1 = 0.5 and a manually set pmf
spinar_sim(n = 100, p = 1, alpha = 0.5, pmf = c(0.3, 0.3, 0.2, 0.1, 0.1))

# generate 100 obervations of an INAR(2) model with
# alpha_1 = 0.2, alpha_2 = 0.3 and Poi(1)-innovations
spinar_sim(n = 100, p = 2, alpha = c(0.2, 0.3), pmf = dpois(0:20,1))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
