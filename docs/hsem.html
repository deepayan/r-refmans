<!DOCTYPE html><html lang="en"><head><title>Help for package hsem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hsem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hsem-package'><p>Hierarchical Structural Equation Models</p></a></li>
<li><a href='#hsemfit'>
<p>Fitting Hierarchical Structural Equation Models using</p>
h-likelihood Approach</a></li>
<li><a href='#hsemmodeling'><p>Defining the Fixed and Random Models for the Mean and Dispersion parameters in HSEMs</p></a></li>
<li><a href='#ml2'>
<p>simulated urge to smoke data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hierarchical Structural Equation Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Rezzy Eko Caraka [aut, cre],
  Maengseok Noh [aut],
  Youngjo Lee [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rezzy Eko Caraka &lt;rezzyekocaraka@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We present this package for fitting structural equation models using the hierarchical likelihood method. This package allows extended structural equation model, including dynamic structural equation model. We illustrate the use of our packages with well-known data sets. Therefore, this package are able to handle two serious problems inadmissible solution and factor indeterminacy &lt;<a href="https://doi.org/10.3390%2Fsym13040657">doi:10.3390/sym13040657</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), methods, Matrix, numDeriv, boot, mvtnorm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-12 07:11:18 UTC; Noh</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-12 10:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='hsem-package'>Hierarchical Structural Equation Models</h2><span id='topic+hsem-package'></span>

<h3>Description</h3>

<p>This package allows different models for multivariate reponse variables with a hierarchical structural equation models (HSEMs).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> hsem</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-08-25</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Unlimited</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This is version 1.0 of the hsem package.
</p>


<h3>Author(s)</h3>

<p>Rezzy Eko Caraka, Maengseok Noh, Youngjo Lee
</p>
<p>Maintainer: Rezzy Eko Caraka &lt;rezzyekocaraka@gmail.com&gt;
</p>

<hr>
<h2 id='hsemfit'>
Fitting Hierarchical Structural Equation Models using
h-likelihood Approach
</h2><span id='topic+hsemfit'></span>

<h3>Description</h3>

<p>The hsemfit is used to fit a hierarchical structural equation models (HSEMs) allowing
different models for multivariate reponse variables. A variety of distributions and link
functions for both response and the random effects are allowed. To call the fitting function
hsemfit, models for the mean and dispersion must be specified by hsemmodleing object
preferably created by calling the hsemmodeling function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>hsemfit(RespDist = "gaussian", BinomialDen = NULL, 
DataMain, MeanModel,DispersionModel = NULL, 
PhiFix = NULL, LamFix = NULL, structure = "correlated", 
mord = 0, dord = 1, convergence = 1e-05, 
Init_Corr = NULL, EstimateCorrelations = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hsemfit_+3A_respdist">RespDist</code></td>
<td>
<p>The distribution of the response is set by the option <code>RespDist</code>. The user can set
it to: &quot;gaussian&quot; (default), &quot;binomial&quot;, &quot;poisson&quot;, or &quot;gamma&quot;.</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_binomialden">BinomialDen</code></td>
<td>
<p>When <code>RespDist</code>=&quot;binomial&quot;, one should use the option <code>BinomialDen</code> to specify
the denominator for the binomial distribution. This should be &quot;NULL&quot; (default)
or a numeric vector of length equal to the length of <code>DataMain</code>. When specified
as <code>BinomialDen</code>=NULL and <code>RespDist</code>=&quot;binomial&quot;, the denominator is 1.
</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_datamain">DataMain</code></td>
<td>
<p>The option <code>DataMain</code> determines the data frame to be used (non-optional).</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_meanmodel">MeanModel</code></td>
<td>
<p>For the mean model, this option requries <code>DGHLMMODELING</code> object which
should specified by the option Model=&quot;mean&quot;.</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_dispersionmodel">DispersionModel</code></td>
<td>
<p>For the overdispersion model, this option requries <code>DGHLMMODELING</code> object
which should be specified by the option Model=&quot;dispersion&quot;.</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_phifix">PhiFix</code></td>
<td>
<p>The option for overdispersion parameters (phi) to be estimated or maintaned constant.
Specifying defaults such as <code>PhiFix</code> =NULL implies that phi is to be estimated. If not, phi is fixed at a value
specified by <code>PhiFix</code>.</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_lamfix">LamFix</code></td>
<td>
<p>The option for random-effect variance (lambda) to be estimated or maintaned constant.
Specifying defaults such as <code>LamFix</code> =NULL implies that lambda is to be estimated. If not, lambda is fixed at a value
specified by <code>LamFix</code>.
</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_structure">structure</code></td>
<td>
<p>The option <code>structure</code> determines structure of random effects. When <code>structure</code>=&quot;correlated&quot; (or &quot;shared&quot;),
correlated (or shared) random-effects model is specified.</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_mord">mord</code></td>
<td>
<p>The option <code>mord</code> specifies the order of Laplace approximation to the marginal
likelihood for fitting the mean parameters. The choice is either 0 or 1 (default).
</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_dord">dord</code></td>
<td>
<p>The option <code>dord</code> specifies the order of adjusted
profile likelihood for fitting the dispersion parameters. The choice is either 1
(default) or 2.
</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_convergence">convergence</code></td>
<td>
<p>Setting this option determines the criterion for convergence, which is computed
as the absolute difference between the values of all the estimated parameters in
the previous and current iterations. The default criterion is 1e-06.
</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_init_corr">Init_Corr</code></td>
<td>
<p>Setting initial values of correlation (or shared parameters) between random effects</p>
</td></tr>
<tr><td><code id="hsemfit_+3A_estimatecorrelations">EstimateCorrelations</code></td>
<td>
<p>Correlation are estimated or fixed when <code>EstimateCorrelations</code>=TRUE (default) or <code>EstimateCorrelations</code>=FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>res</code></td>
<td>
<p>the output class resulted from jointfit_correlated.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ml2)

MM1&lt;-hsemmodeling(Model="mean",Link="identity",
   LinPred=urge~urge1+dep1+(1|id)+(urge1|id)+(dep1|id),
   RandDist=c("gaussian","gaussian","gaussian"))
DM1&lt;-hsemmodeling(Model="dispersion",Link = "log", 
   LinPred=phi~(1|id),RandDist=c("gaussian"))
MM2&lt;-hsemmodeling(Model="mean",Link="identity",
   LinPred=dep~urge1+dep1+(1|id)+(urge1|id)+(dep1|id),
   RandDist=c("gaussian","gaussian","gaussian"))
DM2&lt;-hsemmodeling(Model="dispersion",Link = "log", 
   LinPred=phi~(1|id),RandDist=c("gaussian"))
res&lt;-hsemfit(RespDist=c("gaussian","gaussian"),DataMain=list(ml2,ml2),
   structure="independent",MeanModel=list(MM1,MM2),
   DispersionModel=list(DM1,DM2))
</code></pre>

<hr>
<h2 id='hsemmodeling'>Defining the Fixed and Random Models for the Mean and Dispersion parameters in HSEMs</h2><span id='topic+hsemmodeling'></span>

<h3>Description</h3>

<p>The hsemmodeling specifies a GLM, HGLM, DHGLM model for the mean parameters (mu), and a GLM, HGLM 
model for the overdispersion parameters (phi). GLM for mu, and GLM for phi are specified by adding only fixed terms to the linear predictors 
for the mu and phi, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hsemmodeling(Model="mean",Link=NULL,LinPred="constant",RandDist=NULL,
Offset=NULL,LMatrix=NULL,LinkRandVariance=NULL,LinPredRandVariance=NULL,
RandDistRandVariance="gaussian",
LinkRandVariance2=NULL,LinPredRandVariance2=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hsemmodeling_+3A_model">Model</code></td>
<td>
<p>This option specifies a GLM, HGLM or DHGLM model for mu when Model=&quot;mean&quot; (default), 
and a GLM or HGLM for phi when Model=&quot;dispersion&quot;.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_link">Link</code></td>
<td>
<p>The link function for the linear predictor is
specified by the option Link. For Model=&quot;mean&quot;, Link can be &quot;identity&quot;,
&quot;logit&quot;, &quot;probit&quot;, &quot;cloglog&quot;, &quot;log&quot;, or &quot;inverse&quot;. 
For Model=&quot;dispersion&quot;, the choice is either &quot;log&quot; or &quot;inverse&quot;. 
The default, specified as NULL link, is &quot;identity&quot; for Model=&quot;mean&quot; and
&quot;log&quot; for Model=&quot;dispersion&quot;.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_linpred">LinPred</code></td>
<td>
<p>The option LinPred specifies the fixed and
random terms for the linear predictor for mu when specified as Model=&quot;mean&quot;
or for phi when Model=&quot;dispersion&quot;. For Model=&quot;mean&quot;, LinPred=y~x1+x2+(1|id1)+(1|id2)
specifies y as the main response, x1 and x2 as fixed covariates and id1 and id2 as random terms.
For Model=&quot;dispersion&quot;, the main response should be phi, e.g. phi~x1+x2+(1|id1)+(1|id2). This option
can specify the model without random effects, e.g., LinPred=phi~x1+x2. The default is &quot;constant&quot;, which is set 
to intercept only the model for the corresponding linear predictors.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_randdist">RandDist</code></td>
<td>
<p>The option RandDist specifies the
distributions of the random terms represented in the option LinPred.
It is set as a vector of distribution names from &quot;gaussain&quot; (default),
&quot;beta&quot;, &quot;gamma&quot;, or &quot;inverse-gamma&quot; when Model=&quot;mean&quot;.
For Model=&quot;dispersion&quot;, the choice is &quot;gaussian&quot; (default), &quot;gamma&quot;, or &quot;inverse-gamma&quot;. 
When more than one random terms are specified, e.g., <code>y~x1+x2+(1|id1)+(1|id2)</code>
in the option LinPred, the different distributions for each random term can be specified, e.g.,
c(&quot;gaussian&quot;, &quot;gamma&quot;), which assumes normal distribution for
the random term &quot;id1&quot; and gamma distribution for the random term &quot;id2&quot;, respectively.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_offset">Offset</code></td>
<td>
<p>The option Offset can be used to
specify a known component to be included in the linear predictor specified by LinPred
during fitting. This should be the default (NULL) or a numeric
vector of length equal to that of the appropriate data.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_lmatrix">LMatrix</code></td>
<td>
<p>The option LMatrix sets a matrix that is used as a
post-multiplier for the model matrix of the corresponding random effects. This
option allows correlation structures to be defined for random effects. For
example, when specified as Model=&quot;mean&quot; and Lmatrix=L1+L2, the
linear predictor for mu takes X beta + Z1 L1 r1 + Z2 L2 r2, where
Z1 and Z2 are the model matrices for the random effects v1=L1 r1 and
v2=L2 r2, specified in the option LinPred.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_linkrandvariance">LinkRandVariance</code></td>
<td>
<p>The option LinkRandVariance
specifies the link function for the linear
predictor of the random-effect variances.
The choice is either &quot;log&quot; (default) or &quot;inverse&quot;. When more than two random terms are specified in the option LinPred,
the user can set different link functions, e.g., LinkRandVariance=c(&quot;log&quot;,&quot;inverse&quot;) for each random term.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_linpredrandvariance">LinPredRandVariance</code></td>
<td>
<p>The option LinPredRandVariance specifies the
fixed and random terms for the linear predictor of the random-effect
variances for Model=&quot;mean&quot;. When y~x1+x2+(1|id1)+(1|id2) is specified in the option LinPred, 
</p>
<p>LinPredRandVariance=c(lambda~xx1+(1|id11),lambda~xx2+(1|id12))
specifies xx1 and xx2 as fixed covariates and id11 and id12 as random terms in the lienar predictors for the variances of the random terms id1 and id2, respectively.
For Model=&quot;dispersion&quot;, the random term is not allowed in the linear predictor of the random-effect variance.
The default (NULL) is set to intercept only model for the corresponding linear predictors.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_randdistrandvariance">RandDistRandVariance</code></td>
<td>
<p>The option RandDistRandVariance specifies the
distributions for the random terms in the LinPredRandVariance.
The choice is &quot;gaussian&quot; (default), &quot;gamma&quot;, or &quot;inverse-gamma&quot;.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_linkrandvariance2">LinkRandVariance2</code></td>
<td>
<p>This option specifies the link function for the linear
predictor of the variance of random effects, which are specified in the option
LinPredRandVariance. The choice is either &quot;log&quot; (default) or &quot;inverse&quot;.</p>
</td></tr>
<tr><td><code id="hsemmodeling_+3A_linpredrandvariance2">LinPredRandVariance2</code></td>
<td>
<p>This option specifies the fixed terms for the linear
predictor of the variance of random effects, which is specified in the option LinPredRandVariance. 
For example, when LinPredRandVariance=c(lambda~xx1+(1|id11),lambda~xx1+(1|id12))
is specified, LinPredRandVariance2=c(~xxx1,~xxx2) specifies
xxx1 and xxx2 as fixed covariates for the linear predictor of random-effect variances for id11 and id12, respectively.
The default (NULL) is set to constant variance for the random effects in LinPredRandVariance.</p>
</td></tr>
</table>

<hr>
<h2 id='ml2'>
simulated urge to smoke data 
</h2><span id='topic+ml2'></span>

<h3>Description</h3>

<p>By using an example for urge to smoke in the McNeish and
Hamaker (2020), this data set is a simulated subset. It
consists of 10 repetitions on regular time scales for 20
different individuals. For response variable, urge to Smoke is on a standardized scale average 0
and the standard deviation 1.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ml2")</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations on the following 6 variables.
</p>

<dl>
<dt><code>urge</code></dt><dd><p>standardized urge to smoke</p>
</dd> 
<dt><code>urge1</code></dt><dd><p>previous urge to smoke</p>
</dd> 
<dt><code>dep</code></dt><dd><p>standardized depression</p>
</dd> 
<dt><code>dep1</code></dt><dd><p> previous depression</p>
</dd>
<dt><code>id</code></dt><dd><p> individual indicator</p>
</dd>
<dt><code>time</code></dt><dd><p>time indicator</p>
</dd> 
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
