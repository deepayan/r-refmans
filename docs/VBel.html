<!DOCTYPE html><html><head><title>Help for package VBel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VBel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#VBel-package'>
<p>Variational Bayes for Fast and Accurate Empirical Likelihood Inference</p></a></li>
<li><a href='#compute_AEL'><p>Compute the Adjusted Empirical Likelihood</p></a></li>
<li><a href='#compute_GVA'><p>Compute the Full-Covariance Gaussian VB Empirical Likelihood Posterior</p></a></li>
<li><a href='#diagnostic_plot'><p>Check the convergence of a data set computed by <code>compute_GVA</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Variational Bayes for Fast and Accurate Empirical Likelihood
Inference</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-05-28</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes the Gaussian variational approximation of the Bayesian 
    empirical likelihood posterior. This is an implementation of the function 
    found in Yu, W., &amp; Bondell, H. D. (2023) &lt;<a href="https://doi.org/10.1080%2F01621459.2023.2169701">doi:10.1080/01621459.2023.2169701</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.12), stats</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jlimrasc/VBel">https://github.com/jlimrasc/VBel</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jlimrasc/VBel/issues">https://github.com/jlimrasc/VBel/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>mvtnorm, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-31 06:33:57 UTC; jerem</td>
</tr>
<tr>
<td>Author:</td>
<td>Wei-Chang Yu <a href="https://orcid.org/0000-0002-0399-3779"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Jeremy Lim [cre, aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jeremy Lim &lt;jeremy.lim@unimelb.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-04 09:47:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='VBel-package'>
Variational Bayes for Fast and Accurate Empirical Likelihood Inference
</h2><span id='topic+VBel-package'></span><span id='topic+VBel'></span>

<h3>Description</h3>

<p>Computes the Gaussian variational approximation of the Bayesian 
    empirical likelihood posterior. This is an implementation of the function 
    found in Yu, W., &amp; Bondell, H. D. (2023) &lt;doi:10.1080/01621459.2023.2169701&gt;.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> VBel</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Variational Bayes for Fast and Accurate Empirical Likelihood
Inference</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-05-28</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(
    person("Wei-Chang", "Yu", , "weichang.yu@unimelb.edu.au", role = c("aut"),
    comment = c(ORCID = "0000-0002-0399-3779")),
    person("Jeremy", "Lim", , "jeremy.lim@unimelb.edu.au", role = c("cre", "aut"))
  )</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Computes the Gaussian variational approximation of the Bayesian 
    empirical likelihood posterior. This is an implementation of the function 
    found in Yu, W., &amp; Bondell, H. D. (2023) &lt;doi:10.1080/01621459.2023.2169701&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 3)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> Rcpp (&gt;= 1.0.12), stats</td>
</tr>
<tr>
 <td style="text-align: left;">
LinkingTo: </td><td style="text-align: left;"> Rcpp, RcppEigen</td>
</tr>
<tr>
 <td style="text-align: left;">
Encoding: </td><td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
 <td style="text-align: left;">
Roxygen: </td><td style="text-align: left;"> list(markdown = TRUE)</td>
</tr>
<tr>
 <td style="text-align: left;">
RoxygenNote: </td><td style="text-align: left;"> 7.3.1</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://github.com/jlimrasc/VBel</td>
</tr>
<tr>
 <td style="text-align: left;">
BugReports: </td><td style="text-align: left;"> https://github.com/jlimrasc/VBel/issues</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> mvtnorm, testthat (&gt;= 3.0.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Config/testthat/edition: </td><td style="text-align: left;"> 3</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Wei-Chang Yu [aut] (&lt;https://orcid.org/0000-0002-0399-3779&gt;),
  Jeremy Lim [cre, aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Jeremy Lim &lt;jeremy.lim@unimelb.edu.au&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Archs: </td><td style="text-align: left;"> x64</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
VBel-package            Variational Bayes for Fast and Accurate
                        Empirical Likelihood Inference
compute_AEL             Compute the Adjusted Empirical Likelihood
compute_GVA             Compute the Full-Covariance Gaussian VB
                        Empirical Likelihood Posterior
diagnostic_plot         Check the convergence of a data set computed by
                        'compute_GVA'
</pre>


<h3>Author(s)</h3>

<p>Wei-Chang Yu [aut] (&lt;https://orcid.org/0000-0002-0399-3779&gt;),
  Jeremy Lim [cre, aut]
</p>
<p>Maintainer: Jeremy Lim &lt;jeremy.lim@unimelb.edu.au&gt;
</p>


<h3>References</h3>

<p><a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.2023.2169701">https://www.tandfonline.com/doi/abs/10.1080/01621459.2023.2169701</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute_AEL">compute_AEL()</a></code> for choice of R and/or C++ computation of AEL
</p>
<p><code><a href="#topic+compute_GVA">compute_GVA()</a></code> for choice of R and/or C++ computation of GVA
</p>
<p><code><a href="#topic+diagnostic_plot">diagnostic_plot()</a></code> for verifying convergence of computed GVA data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#ansGVARcppPure &lt;- compute_GVA(mu, C_0, h, delthh, delth_logpi, z, lam0, rho, 
#elip, a, iters, iters2, fullCpp = TRUE)
#diagnostic_plot(ansGVARcppPure)
</code></pre>

<hr>
<h2 id='compute_AEL'>Compute the Adjusted Empirical Likelihood</h2><span id='topic+compute_AEL'></span>

<h3>Description</h3>

<p>Evaluates the AEL for a given data set, moment conditions and parameter values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_AEL(th, h, lam0, a, z, iters, useR_forz, returnH)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_AEL_+3A_th">th</code></td>
<td>
<p>Vector or scalar theta</p>
</td></tr>
<tr><td><code id="compute_AEL_+3A_h">h</code></td>
<td>
<p>User-defined function, outputs array</p>
</td></tr>
<tr><td><code id="compute_AEL_+3A_lam0">lam0</code></td>
<td>
<p>Initial vector for lambda</p>
</td></tr>
<tr><td><code id="compute_AEL_+3A_a">a</code></td>
<td>
<p>Scalar constant</p>
</td></tr>
<tr><td><code id="compute_AEL_+3A_z">z</code></td>
<td>
<p>n-1 by d matrix</p>
</td></tr>
<tr><td><code id="compute_AEL_+3A_iters">iters</code></td>
<td>
<p>Number of iterations using Newton-Raphson for estimation of lambda (default: 500)</p>
</td></tr>
<tr><td><code id="compute_AEL_+3A_user_forz">useR_forz</code></td>
<td>
<p>Bool whether to calculate the function first in R (True) or call the function in C (False) (default: True)</p>
</td></tr>
<tr><td><code id="compute_AEL_+3A_returnh">returnH</code></td>
<td>
<p>Whether to return calculated values of h, H matrix and lambda</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value for the Adjusted Empirical Likelihood function
computed evaluated at a given theta value
</p>


<h3>Author(s)</h3>

<p>Wei Chang Yu, Jeremy Lim
</p>


<h3>References</h3>

<p>Yu, W., &amp; Bondell, H. D. (2023). Variational Bayes for Fast and
Accurate Empirical Likelihood Inference. Journal of the American Statistical
Association, 1â€“13. <a href="https://doi.org/10.1080/01621459.2023.2169701">doi:10.1080/01621459.2023.2169701</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate toy variables
set.seed(1)
x     &lt;- runif(30, min = -5, max = 5)
elip  &lt;- rnorm(30, mean = 0, sd = 1)
y     &lt;- 0.75 - x + elip

# Set initial values for AEL computation
lam0  &lt;- matrix(c(0,0), nrow = 2)
th    &lt;- matrix(c(0.8277, -1.0050), nrow = 2)
a     &lt;- 0.00001
iters &lt;- 10

# Define Dataset and h-function
z &lt;- cbind(x, y)
h &lt;- function(z, th) {
    xi      &lt;- z[1]
    yi      &lt;- z[2]
    h_zith  &lt;- c(yi - th[1] - th[2] * xi, xi*(yi - th[1] - th[2] * xi))
    matrix(h_zith, nrow = 2)
}
ansAELRcpp &lt;- compute_AEL(th, h, lam0, a, z, iters, useR_forz = TRUE)
</code></pre>

<hr>
<h2 id='compute_GVA'>Compute the Full-Covariance Gaussian VB Empirical Likelihood Posterior</h2><span id='topic+compute_GVA'></span>

<h3>Description</h3>

<p>Requires a given data set, moment conditions and parameter values and returns
a list of the final mean and variance-covariance along with an array of the
in-between calculations at each iteration for analysis of convergence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_GVA(
  mu,
  C,
  h,
  delthh,
  delth_logpi,
  z,
  lam0,
  rho,
  elip,
  a,
  iters,
  iters2,
  fullCpp,
  verbosity
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_GVA_+3A_mu">mu</code></td>
<td>
<p>Column vector, initial value of Gaussian VB mean</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_c">C</code></td>
<td>
<p>Lower Triangular Matrix, initial value of Gaussian VB Cholesky</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_h">h</code></td>
<td>
<p>User-defined moment-condition function, outputs a k x 1 matrix containing the kth row of h. Function must take two arguments: zi and theta for h(zi,th)</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_delthh">delthh</code></td>
<td>
<p>User defined function, outputs k x p Jacobian matrix of h(zi,th) with respect to theta</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_delth_logpi">delth_logpi</code></td>
<td>
<p>User-defined function, outputs p x 1 matrix, derivative of log prior function</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_z">z</code></td>
<td>
<p>Data matrix, n-1 x d matrix</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_lam0">lam0</code></td>
<td>
<p>Initial guess for lambda, k x 1 matrix</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_rho">rho</code></td>
<td>
<p>Scalar (between 0 to 1, reccomended to be close to 1) ADADELTA accumulation constant</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_elip">elip</code></td>
<td>
<p>Scalar numeric stability constant. Should be specified with a small value</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_a">a</code></td>
<td>
<p>Scalar AEL constant, must be &gt;0, small values recommended</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_iters">iters</code></td>
<td>
<p>Number of iterations for GVA (default:10,000)</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_iters2">iters2</code></td>
<td>
<p>Number of iterations for Log AEL (default:500)</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_fullcpp">fullCpp</code></td>
<td>
<p>Bool whether to calculate the main section in cpp (TRUE) or only partially (FALSE, doing all the AEL calculations in R before handing values to cpp) (default: TRUE)</p>
</td></tr>
<tr><td><code id="compute_GVA_+3A_verbosity">verbosity</code></td>
<td>
<p>Integer for how often to print updates on current iteration number (default:500)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:  </p>

<ol>
<li><p> mu_FC: VB Posterior Mean at final iteration. A vector of
size p x 1
</p>
</li>
<li><p> C_FC: VB Posterior Variance-Covariance (Cholesky) at
final iteration. A lower-triangular matrix of size p x p
</p>
</li>
<li><p> mu_FC_arr: VB Posterior Mean for each iteration. A matrix
of size p x (iters + 1)
</p>
</li>
<li><p> C_FC_arr: VB Posterior Variance-Covariance (Cholesky) for
each iteration. An array of size p x p x (iters + 1)
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Wei Chang Yu, Jeremy Lim
</p>


<h3>References</h3>

<p>Yu, W., &amp; Bondell, H. D. (2023). Variational Bayes for Fast and
Accurate Empirical Likelihood Inference. Journal of the American Statistical
Association, 1â€“13. <a href="https://doi.org/10.1080/01621459.2023.2169701">doi:10.1080/01621459.2023.2169701</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
x    &lt;- runif(30, min = -5, max = 5)
elip &lt;- rnorm(30, mean = 0, sd = 1)
y    &lt;- 0.75 - x + elip
lam0 &lt;- matrix(c(0,0), nrow = 2)
th   &lt;- matrix(c(0.8277, -1.0050), nrow = 2)
a    &lt;- 0.00001
z    &lt;- cbind(x, y)
h    &lt;- function(z, th) {
    xi     &lt;- z[1]
    yi     &lt;- z[2]
    h_zith &lt;- c(yi - th[1] - th[2] * xi, xi*(yi - th[1] - th[2] * xi))
    matrix(h_zith, nrow = 2)
}

delthh &lt;- function(z, th) {
    xi &lt;- z[1]
    matrix(c(-1, -xi, -xi, -xi^2), 2, 2)
}

n     &lt;- 31
reslm &lt;- lm(y ~ x)
mu    &lt;- matrix(unname(reslm$coefficients),2,1)
C_0   &lt;- unname(t(chol(vcov(reslm))))

delth_logpi &lt;- function(theta) { -0.0001 * mu }
elip        &lt;- 10^-5
iters       &lt;- 10
iters2      &lt;- 50
rho         &lt;- 0.9

# -----------------------------
# Main
# -----------------------------
ansGVARcppHalf &lt;-compute_GVA(mu, C_0, h, delthh, delth_logpi, z, lam0, 
rho, elip, a, iters, iters2, fullCpp = FALSE)
ansGVARcppPure &lt;-compute_GVA(mu, C_0, h, delthh, delth_logpi, z, lam0, 
rho, elip, a, iters, iters2, fullCpp = TRUE)

</code></pre>

<hr>
<h2 id='diagnostic_plot'>Check the convergence of a data set computed by <code>compute_GVA</code></h2><span id='topic+diagnostic_plot'></span>

<h3>Description</h3>

<p>Plots mu and variance in a time series plot to check for convergence of the
computed data (i.e. Full-Covariance Gaussian VB Empirical Likelihood
Posterior)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostic_plot(dataList, muList, cList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagnostic_plot_+3A_datalist">dataList</code></td>
<td>
<p>Named list of data generated from <a href="#topic+compute_GVA">compute_GVA</a></p>
</td></tr>
<tr><td><code id="diagnostic_plot_+3A_mulist">muList</code></td>
<td>
<p>Array of indices of mu_arr to plot. (default:all)</p>
</td></tr>
<tr><td><code id="diagnostic_plot_+3A_clist">cList</code></td>
<td>
<p>Matrix of indices of variance to plot, 2xn matrix, each row is
(col,row) of variance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of variance of C_FC
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate toy variables
seedNum &lt;- 100
set.seed(seedNum)
n       &lt;- 100
p       &lt;- 10
lam0    &lt;- matrix(0, nrow = p)

# Calculate z
mean    &lt;- rep(1, p)
sigStar &lt;- matrix(0.4, p, p) + diag(0.6, p)
z       &lt;- mvtnorm::rmvnorm(n = n-1, mean = mean, sigma = sigStar)

# Calculate intermediate variables
zbar    &lt;- 1/(n-1) * matrix(colSums(z), nrow = p)
sumVal  &lt;- matrix(0, nrow = p, ncol = p)
for (i in 1:p) {
zi      &lt;- matrix(z[i,], nrow = p)
sumVal  &lt;- sumVal + (zi - zbar) %*% matrix(zi - zbar, ncol = p)
}
sigHat  &lt;- 1/(n-2) * sumVal

# Initial values for GVA
mu_0    &lt;- matrix(zbar, p, 1)
C_0     &lt;- 1/sqrt(n) * t(chol(sigHat))

# Define h-function
h       &lt;- function(zi, th) { matrix(zi - th, nrow = 10) }

# Define h-gradient function
delthh  &lt;- function(z, th) { -diag(p) }

# Set other initial values
delth_logpi &lt;- function(theta) {-0.0001 * theta}
elip    &lt;- 10^-5
T       &lt;- 5 # Number of iterations for GVA
T2      &lt;- 5 # Number of iterations for AEL
rho     &lt;- 0.9
a       &lt;- 0.00001

ansGVA &lt;-compute_GVA(mu_0, C_0, h, delthh, delth_logpi, z, lam0, rho, elip, 
a, T, T2, fullCpp = TRUE)

diagnostic_plot(ansGVA)
diagnostic_plot(ansGVA, muList = c(1,4))
diagnostic_plot(ansGVA, cList = matrix(c(1,1, 5,6, 3,3), ncol = 2))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
