<!DOCTYPE html><html><head><title>Help for package GORCure</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GORCure}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GORCure-package'>
<p>Fit Generalized Odds Rate Mixture Cure Model with Interval Censored Data</p></a></li>
<li><a href='#GORMC'>
<p>Fitting the GORMC model with interval censored data.</p></a></li>
<li><a href='#plot.predict.GORMC'>
<p>Plot the predicted survival curves.</p></a></li>
<li><a href='#predict.GORMC'>
<p>Predict cure rate and overall survival curve for a new subject.</p></a></li>
<li><a href='#summary.GORMC'>
<p>Summary table of hypothesis tests for the coefficients in the GORMC model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fit Generalized Odds Rate Mixture Cure Model with Interval
Censored Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-01-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Jie Zhou, Jiajia Zhang, Wenbin Lu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jie Zhou &lt;zhoujie02569@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Generalized Odds Rate Mixture Cure (GORMC) model is a flexible model of fitting survival data with a cure fraction, including the Proportional Hazards Mixture Cure (PHMC) model and the Proportional Odds Mixture Cure Model as special cases. This package fit the GORMC model with interval censored data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.0),stats,graphics,survival,ICsurv,pracma,MASS</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-01-13 01:26:04 UTC; gazhou</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-01-13 19:25:30</td>
</tr>
</table>
<hr>
<h2 id='GORCure-package'>
Fit Generalized Odds Rate Mixture Cure Model with Interval Censored Data
</h2><span id='topic+GORCure-package'></span><span id='topic+GORCure'></span>

<h3>Description</h3>

<p>Generalized Odds Rate Mixture Cure (GORMC) model is a flexible cure model which includes the Proportional Hazards Mixture
Cure (PHMC) model and the Proportional Odds Mixture Cure (POMC) model as special cases. When the survival data is interval
censored, this package provides an efficient solution for the GORMC model based on a gamma-possion data augmentation.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> GORCure</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-01-12</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The main function is GORMC, which produces the estimates for coefficients and the covariance matrix. The summary function 
can be used to get the test results of the coefficients. The predict function can be used to obtain the estimated cure rate
and survival curve for an individual with specified covariates for the cure rate and survival parts separatly. The plot 
function can be applied to generate the predicted survival curve for that individual.
</p>


<h3>Author(s)</h3>

<p>Jie Zhou, Jiajia Zhang, Wenbin Lu
</p>
<p>Maintainer: Jie Zhou &lt;zhoujie02569@gmail.com&gt;
</p>


<h3>References</h3>

<p>Zhou, J., Zhang, J. and Lu, W. (2017+). Computationally Efficient Estimation for the Generalized Odds Rate Mixture Cure Model with Interval Censored Data.
</p>

<hr>
<h2 id='GORMC'>
Fitting the GORMC model with interval censored data.
</h2><span id='topic+GORMC'></span>

<h3>Description</h3>

<p>The Generalized Odds Rate Mixture Cure model is fitted for interval censored survival data. The EM algorithm facilitated 
by a gamma-poisson data augmentation is applied for estimating the coefficients in both the cure rate part and the survival
part. The covariance matrix has closed forms based on the Louis method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GORMC(survfun = formula(data), curefun = formula(data), data = parent.frame(), 
r = 0, n.int = 5, order = 3, max.iter = 1000, cov.rate = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GORMC_+3A_survfun">survfun</code></td>
<td>

<p>A formula for the survival part in the GORMC model, defined using the Surv function and type=&ldquo;interval2&quot;.
</p>
</td></tr>
<tr><td><code id="GORMC_+3A_curefun">curefun</code></td>
<td>

<p>The formula of predictors of the cure rate part in the GORMC model.
</p>
</td></tr>
<tr><td><code id="GORMC_+3A_data">data</code></td>
<td>

<p>The interval censored sorvival data, including the left and right end points of the time intervals and the covariates for
the cure rate part and the survival part. If a subject is left(right) censored, the left(right) end point of the subject 
should be defined as &ldquo;NA&quot;, see example. 
</p>
</td></tr>
<tr><td><code id="GORMC_+3A_r">r</code></td>
<td>

<p>The transformation parameter in the GORMC model, should be greater than or equal to 0. r=0 refers to the PHMC model and
r=1 refers to the POMC model. The default is 0.
</p>
</td></tr>
<tr><td><code id="GORMC_+3A_n.int">n.int</code></td>
<td>

<p>Number of interior knots of the splines. Default is 5.
</p>
</td></tr>
<tr><td><code id="GORMC_+3A_order">order</code></td>
<td>

<p>Order of the spline basis functions. Default is 3, i.e. the cubic splines.
</p>
</td></tr>
<tr><td><code id="GORMC_+3A_max.iter">max.iter</code></td>
<td>

<p>The maximum number of interations for the EM algorithm. Default is 1000.
</p>
</td></tr>
<tr><td><code id="GORMC_+3A_cov.rate">cov.rate</code></td>
<td>

<p>The bound for convergence of the algorithm, which defined as the difference between the log-likelihood values of two 
consecutive iterations smaller than this value. Default is 0.001.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula defined for &ldquo;survfun&quot; is based on the Surv() function, where the left and right end points of the time interval
are included and the type is equal to &ldquo;interval2&quot;. The left(right) end points of left(right) censored individuals should
be defined as &ldquo;NA&quot; in the data frame before running the function.\ 
The transformation parameter r is a nonnegative number corresponding to a specific model in the GORMC family of models.
Special cases include the PHMC model(r=0) and the POMC model(r=1). Other positive numbers can also be specified. The 
grid search method is suggested to find the best model in practice. That is, try a sequence of r values and choose the
one with the greatest log-likelihood value. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>ParEst</code></td>
<td>
<p>A list includes the estimated coefficients (Eta,Beta,gl), the whole hessian matrix (Hessian), AIC, and the 
log-likelihood value(loglik).</p>
</td></tr>
<tr><td><code>ParVcov</code></td>
<td>
<p>The estimated covariance matrix of the coefficients Eta and Beta.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The estimated hessian matrix can be very large and sometimes not invertable. In which case, we try the QR decomposition,
g-inverse or even numerical methods to get the covariance matrix. Different values of hess in the ParVcov indicating the
different cases.
hess=0:the hessian matrix is invertable;
hess=1:the QR decomposition is applied to solve the hessian matrix;
hess=2:the g-inverce is applied to the hessian matrix;
hess=3:the hessian matrix is obtained from numerical methods.
The variance estimates may be unreliable for the cases when hess&gt;0.
</p>


<h3>References</h3>

<p>Zhou, J., Zhang, J. and Lu, W. (2017+). Computationally Efficient Estimation for the Generalized Odds Rate Mixture Cure Model with Interval Censored Data. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Hemophilia)
head(Hemophilia)
# Set Left/Right Interval End Points as NA
Hemophilia$L[Hemophilia$d1==1]&lt;-Hemophilia$R[Hemophilia$d3==1]&lt;-NA

# Fit PHMC Model (r=0)
fit&lt;-GORMC(survfun=Surv(L,R)~Low+Medium+High,curefun=~Low+Medium+High,
data=Hemophilia,r=0)
summary(fit)

# Fit POMC Model (r=1)
# fit&lt;-GORMC(survfun=Surv(L,R)~Low+Medium+High,curefun=~Low+Medium+High,
# data=Hemophilia,r=1)
# summary(fit)

# Predict Cure Rate and Survival Curve for a New Individual
# Specify coveriate vectors for new.z and new.x
pred1&lt;-predict(fit,new.z=c(1,0,0,0),new.x=c(0,0,0))
pred2&lt;-predict(fit,new.z=c(1,1,0,0),new.x=c(1,0,0))
pred3&lt;-predict(fit,new.z=c(1,0,1,0),new.x=c(0,1,0))
pred4&lt;-predict(fit,new.z=c(1,0,0,1),new.x=c(0,0,1))

# Obtain Cure Rates
pred1$CureRate
pred2$CureRate
pred3$CureRate
pred4$CureRate

# Plot the Survival Curves
plot(pred1,xlab="Time",ylab="Survival Probability",ylim=c(0,1))
lines(pred2$Survival,col=2)
lines(pred3$Survival,col=3)
lines(pred4$Survival,col=4)
legend(0,0.3,c("None","Low","Medium","High"),lty=1,col=1:4)

# Not run: Grid Search r
# rr&lt;-seq(0,2,0.2)
# logl&lt;-numeric()
# for(i in 1:length(rr)){
# fit&lt;-GORMC(survfun=Surv(L,R)~Low+Medium+High,curefun=~Low+Medium+High,
# data=Hemophilia,r=rr[i])
# logl[i]&lt;-fit$ParEst$loglik
# }
# plot(rr,logl,type="l",xlab="r",ylab="Log-likelihood")
</code></pre>

<hr>
<h2 id='plot.predict.GORMC'>
Plot the predicted survival curves.
</h2><span id='topic+plot.predict.GORMC'></span>

<h3>Description</h3>

<p>Plot the predicted survival curve of the new subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predict.GORMC'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.predict.GORMC_+3A_x">x</code></td>
<td>

<p>An object from the predict.GORMC function.
</p>
</td></tr>
<tr><td><code id="plot.predict.GORMC_+3A_...">...</code></td>
<td>

<p>Other plot arguments.
</p>
</td></tr>
</table>

<hr>
<h2 id='predict.GORMC'>
Predict cure rate and overall survival curve for a new subject.
</h2><span id='topic+predict.GORMC'></span>

<h3>Description</h3>

<p>Based on the predicted model, cure rate and survival probabilities are calculated for a new individual with specific 
covariate values. The new.x specifies the covariate vector of the survival part and the new.z specifies that in the 
cure rate part. If no values are specified, zeros will be used and the baseline survival probabilities are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GORMC'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.GORMC_+3A_object">object</code></td>
<td>

<p>An object from the function GORMC.
</p>
</td></tr>
<tr><td><code id="predict.GORMC_+3A_...">...</code></td>
<td>

<p>Other argumetns including new.x and new.z. See details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a new subject, new.x and new.z correspond to the covariate vector in the survival part and the cure rate part. The 
first input of new.z is always 1 corresponding to the intercept. 
tp is an argument specifying the time points at which survival probabilities will be predicted. If no value specified for tp, a sequence of equally spaced time points from 0 to the largest observation time will be used and the total length of the sequence is defined by an argument len. The default value of len is 100.
</p>


<h3>Value</h3>

<table>
<tr><td><code>CureRate</code></td>
<td>
<p>Estimated cure rate of the new subject.</p>
</td></tr>
<tr><td><code>Survival</code></td>
<td>
<p>A data frame including the time points and survival probabilities.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.GORMC'>
Summary table of hypothesis tests for the coefficients in the GORMC model.
</h2><span id='topic+summary.GORMC'></span>

<h3>Description</h3>

<p>Estimates, standard errors, test statistics and p values are presented for each coefficient in the GORMC model. The &ldquo;INC&quot;
indicate the covariate is in the cure rate (incidence) part, &ldquo;LAT&quot; indicate the covariate is in the survival (latency)
part.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GORMC'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.GORMC_+3A_object">object</code></td>
<td>

<p>An object from the function GORMC.
</p>
</td></tr>
<tr><td><code id="summary.GORMC_+3A_...">...</code></td>
<td>

<p>Other auguments to be specified.
</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
