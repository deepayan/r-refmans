<!DOCTYPE html><html><head><title>Help for package gofcat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gofcat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#brant.test'><p>Brant Test of the Proportional Odds Assumption</p></a></li>
<li><a href='#erroR'><p>Performance metrics for categorical models</p></a></li>
<li><a href='#Fishing'><p>Choice of Fishing Mode</p></a></li>
<li><a href='#hosmerlem'><p>Hosmer-Lemeshow Test for Categorical Response Models</p></a></li>
<li><a href='#lipsitz'><p>Lipsitz Test for Categorical Response Models</p></a></li>
<li><a href='#LR.test'><p>Likelihood Ratio Test of the Proportional Odds Assumption</p></a></li>
<li><a href='#print.brant'><p>Print method for an object of class brant</p></a></li>
<li><a href='#print.erroR'><p>Print method for an object of class erroR</p></a></li>
<li><a href='#print.hosmerlem'><p>Print method for an object of class hosmerlem</p></a></li>
<li><a href='#print.lipsitz'><p>Print method for an object of class lipsitz</p></a></li>
<li><a href='#print.LRT'><p>Print method for an object of class LRT</p></a></li>
<li><a href='#print.pulkroben'><p>Print method for an object of class pulkroben</p></a></li>
<li><a href='#print.Rsquared'><p>Print method for an object of class r-squared</p></a></li>
<li><a href='#pulkroben'><p>Pulkstenis-Robinson Test for Categorical Response Models</p></a></li>
<li><a href='#retinopathy'><p>Retinopathy</p></a></li>
<li><a href='#Rsquared'><p>R-squared for Categorical Response Models</p></a></li>
<li><a href='#vaso'><p>Vasoconstriction and Breathing</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Goodness-of-Fit Measures for Categorical Response Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>A post-estimation method for categorical response models (CRM). 
    Inputs from objects of class serp(), clm(), polr(), multinom(), mlogit(), 
    vglm() and glm() are currently supported. Available tests include the 
    Hosmer-Lemeshow tests for the binary, multinomial and ordinal logistic 
    regression; the Lipsitz and the Pulkstenis-Robinson tests for the ordinal 
    models. The proportional odds, adjacent-category, and constrained continuation-ratio 
    models are particularly supported at ordinal level. Tests for the proportional 
    odds assumptions in ordinal models are also possible with the Brant and the 
    Likelihood-Ratio tests. Moreover, several summary measures of predictive strength 
    (Pseudo R-squared), and some useful error metrics, including, the brier 
    score, misclassification rate and logloss are also available for the 
    binary, multinomial and ordinal models. Ugba, E. R. and Gertheiss, J. (2018) 
    <a href="http://www.statmod.org/workshops_archive_proceedings_2018.html">http://www.statmod.org/workshops_archive_proceedings_2018.html</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, crayon, stats, Matrix, epiR, reshape, stringr, VGAM (&ge;
1.1-4)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>True</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>serp, dfidx, mlogit, nnet, ordinal, MASS, testthat, covr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-13 01:48:42 UTC; EJIKE</td>
</tr>
<tr>
<td>Author:</td>
<td>Ejike R. Ugba <a href="https://orcid.org/0000-0003-2572-0023"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ejike R. Ugba &lt;ejike.ugba@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-14 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='brant.test'>Brant Test of the Proportional Odds Assumption</h2><span id='topic+brant.test'></span>

<h3>Description</h3>

<p>Provides the means of testing the parallel regression assumption
in the ordinal regression  models. Also available is the likelihood ratio test,
LR.test().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brant.test(model, global= FALSE, call = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brant.test_+3A_model">model</code></td>
<td>
<p>a single model object to be tested.</p>
</td></tr>
<tr><td><code id="brant.test_+3A_global">global</code></td>
<td>
<p>default to FALSE. When TRUE, a global test is made for the factor
variables instead of the individual factor levels.</p>
</td></tr>
<tr><td><code id="brant.test_+3A_call">call</code></td>
<td>
<p>when TRUE the model call is printed alongside test results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parallel regression assumption for the ordinal regression  model
can be tested With this function. The brant test (Brant, 1990) is currently
available for objects of class: serp(), clm(), polr() and vglm(). Objects of class
serp() should have the <code>slope</code> argument set to 'parallel', while objects of
class vglm() should have the <code>model</code> argument TRUE, if not, the model is
automatically updated to include the object 'model'. Moreover, family in
vglm() must be either &quot;cumulative&quot; or &quot;propodds&quot;, with the parallel argument TRUE.
</p>


<h3>Value</h3>

<table>
<tr><td><code>model</code></td>
<td>
<p>call of the model tested</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom</p>
</td></tr>
<tr><td><code>global</code></td>
<td>
<p>logical vector of TRUE or FALSE</p>
</td></tr>
<tr><td><code>modeltype</code></td>
<td>
<p>character vector of the class of model tested</p>
</td></tr>
<tr><td><code>Terms</code></td>
<td>
<p>original model terms</p>
</td></tr>
<tr><td><code>vnames</code></td>
<td>
<p>character vector of variable names used in the model</p>
</td></tr>
<tr><td><code>chisq</code></td>
<td>
<p>realized values of the chi-square statistic</p>
</td></tr>
<tr><td><code>rdf</code></td>
<td>
<p>residual degrees of freedom</p>
</td></tr>
<tr><td><code>rDev</code></td>
<td>
<p>residual deviance</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>the p-values of test</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>a logical vector</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brant, R. (1990). Assessing proportionality in the proportional odds model
for ordinal logistic regression. <em>Biometrics</em>, 46, 1171-1178.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LR.test">LR.test</a></code>, <code><a href="#topic+hosmerlem">hosmerlem</a></code>, <code><a href="#topic+lipsitz">lipsitz</a></code>,
<code><a href="#topic+pulkroben">pulkroben</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(serp)

set.seed(1)
n &lt;- 200
y &lt;- ordered(rbinom(n, 2, 0.5))
x1 &lt;- factor(rbinom(n, 2, 0.7))
x2 &lt;- runif(n)

## proportional odds model
sp &lt;- serp(y ~ x1 * x2, link = "logit", slope = "parallel", reverse = TRUE)

brant.test(sp)
brant.test(sp, global = TRUE, call=TRUE)

</code></pre>

<hr>
<h2 id='erroR'>Performance metrics for categorical models</h2><span id='topic+erroR'></span>

<h3>Description</h3>

<p>Calculates common error metrics of fitted binary and
multi-categorical response models. Available measures include: the
brier score, logloss and misclassification error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>erroR(model, type = c("brier", "logloss", "misclass"), thresh = 5e-1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="erroR_+3A_model">model</code></td>
<td>
<p>a model object or data.frame of observed and predicted values.
The following class of objects can be directly passed to the <code>erroR</code>
function: glm(), vglm(), serp(), polr(), clm(), mlogit() and multinom(). Other
Other class of objects require providing a data.frame of observed and predicted
values.</p>
</td></tr>
<tr><td><code id="erroR_+3A_type">type</code></td>
<td>
<p>specifies the type of error metrics</p>
</td></tr>
<tr><td><code id="erroR_+3A_thresh">thresh</code></td>
<td>
<p>resets the default misclassification threshold</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>value</code></td>
<td>
<p>a numeric vector of the realized error value.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>a character vector of error type.</p>
</td></tr>
<tr><td><code>threshold</code></td>
<td>
<p>a numeric vector of the misclassification threshold.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+Rsquared">Rsquared</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(serp)

set.seed(1)
n &lt;- 100
y &lt;- factor(rbinom(n, 1, 0.3))
x &lt;- rnorm(n)
#p &lt;- runif(n)

m1 &lt;- glm(y ~ x, family = binomial())

erroR(m1, type = "brier")
erroR(m1, type = "logloss")
erroR(m1, type = "misclass")
erroR(m1, type = "misclass", thresh=0.3)

# using data.frame
df &lt;- data.frame(y, fitted(m1))
erroR(df, type = "brier")

m2 &lt;- serp(rating ~ temp + contact, slope = "parallel", link = "logit",
           data = wine)
erroR(m2, type = "brier")
erroR(m2, type = "logloss")
erroR(m2, type = "misclass")

</code></pre>

<hr>
<h2 id='Fishing'>Choice of Fishing Mode</h2><span id='topic+Fishing'></span>

<h3>Description</h3>

<p>A sample of 1182 individuals in the United-States for the choice of
4 alternative fishing modes.
</p>


<h3>Format</h3>

<p>A data frame containing :
</p>
<p>- mode: recreation mode choice, one of : beach, pier, boat and charter,
- price.beach: price for beach mode
- price.pier: price for pier mode,
- price.boat: price for private boat mode,
- price.charter: price for charter boat mode,
- catch.beach: catch rate for beach mode,
- catch.pier: catch rate for pier mode,
- catch.boat: catch rate for private boat mode,
- catch.charter: catch rate for charter boat mode,
- income: monthly income,
</p>


<h3>Source</h3>

<p>Cameron A, Trivedi P (2005). Microeconometrics. Cambridge University Press.
https://EconPapers.repec.org/RePEc:cup:cbooks:9780521848053.
</p>


<h3>References</h3>

<p>Herriges JA, Kling CL (1999). “Nonlinear Income Effects in Random Utility
Models.” The Review of Economics and Statistics, 81(1), 62-72.
doi: 10.1162/003465399767923827
</p>


<h3>See Also</h3>

<p><code><a href="#topic+retinopathy">retinopathy</a></code>, <code><a href="#topic+vaso">vaso</a></code>
</p>

<hr>
<h2 id='hosmerlem'>Hosmer-Lemeshow Test for Categorical Response Models</h2><span id='topic+hosmerlem'></span>

<h3>Description</h3>

<p>This is a post estimation goodness-of-fit test for categorical
response models. It currently supports the binary, multinomial and ordinal
logistic regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hosmerlem(model, group = 10, tables = FALSE, customFreq = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hosmerlem_+3A_model">model</code></td>
<td>
<p>a model object or data.frame of observed and estimated
values. The following class of objects can be directly passed to the function:
glm(), vglm(), serp(), polr(), clm(), and mlogit(). Other class of objects
require providing a data.frame of observed and predicted values.</p>
</td></tr>
<tr><td><code id="hosmerlem_+3A_group">group</code></td>
<td>
<p>Default to 10. The number of groups to be formed from the
original observations.</p>
</td></tr>
<tr><td><code id="hosmerlem_+3A_tables">tables</code></td>
<td>
<p>Default to FALSE. When TRUE, both the observed and the
expected frequency tables are printed alongside test results.</p>
</td></tr>
<tr><td><code id="hosmerlem_+3A_customfreq">customFreq</code></td>
<td>
<p>a vector of custom group frequencies to be used instead of
the default equal group frequencies. The vector should, however, sum up to
the total number of original observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implemented tests are discussed in Hosmer and Lemeshow (1980)
(for the binary case), Fagerland, Hosmer, and Bofin (2008);
Fagerland and Hosmer (2012) (for the multinomial case) and
Fagerland and Hosmer (2013, 2016, 2017) (for the ordinal case). In each
of the three settings, one makes a split of the original observations into k
groups (10 by default), after ranking the observations by ordinal
scores (OS). Ties are separated following an additional ranking based on the
observed values. A Pearson chi-squared statistic is thereafter obtained
from a (k X c) expected and observed frequency tables. The Hosmerlem()
function automatically dictates which of the three HL tests to run based on
the type of model supplied or by inspecting the class/level of response
category in the supplied data.frame of predicted and observed values.
</p>
<p>On the choice of k-groups, Fagerland and Hosmer (2013, 2016) recommend
using ten groups. It is believed that number of groups below six
adversely affects the heterogeneity within groups thereby resulting in a
test with low power. Also having too many groups could lead to a sparsely
populated contingency tables, affecting the distributional assumptions of
the test statistic. The test statistic follows the chi-squared distribution
with (k - 2)(r - 1) + (r - 2) degrees of freedom. Where k and r are
respectively the number of groups and response category. For chi-square
estimation to hold, it is recommended to have the percentage of estimated
frequencies greater than 80 percent of all estimated frequencies
(Fagerland and Hosmer, 2017).
</p>
<p>Finally, it is particularly recommended to compare the results of the
ordinal Hosmer-Lemeshow test with the lipsitz and the Pulkstenis-Robinson
tests (Fagerland and Hosmer, 2016; 2017).
</p>


<h3>Value</h3>

<table>
<tr><td><code>chi.sq</code></td>
<td>
<p>realized value of the chi-square statistic.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>table of observed frequencies.</p>
</td></tr>
<tr><td><code>expected</code></td>
<td>
<p>table of estimated frequencies.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>percentage of estimated frequencies greater than one.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>a character vector indicating the type of HL-test conducted.</p>
</td></tr>
<tr><td><code>tables</code></td>
<td>
<p>TRUE or FALSE logical vector.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hosmer, D. W. and Lemeshow, S. (1980). Goodness of fit tests for the multiple
logistic regression model. <em>Communications in Statistics-Theory and
Methods</em>, 9, 1043-1069.
</p>
<p>Fagerland, M. W., Hosmer, D. W. and Bofin, A. M. (2008). Multinomial
goodness-of-fit tests for logistic regression models. <em>Statistics in
Medicine</em>, 27, 4238-4253.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2012). A generalized Hosmer-Lemeshow
goodness-of-fit test for multinomial logistic regression models.
<em>Stata Journal</em>, 12, 447-453.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2013). A goodness-of-fit test for the
proportional odds regression model. <em>Statistics in Medicine</em>,
32, 2235-2249.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2016). Tests for goodness of fit in
ordinal logistic regression models. <em>Journal of Statistical
Computation and Simulation</em>, 86, 3398-3418.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2017). How to test for goodness of fit
in ordinal logistic regression models. <em>Stata Journal</em>, 17, 668-686.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lipsitz">lipsitz</a></code>, <code><a href="#topic+pulkroben">pulkroben</a></code>, <code><a href="#topic+brant.test">brant.test</a></code>,
<code><a href="#topic+LR.test">LR.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(VGAM)

# Binary L-H test
set.seed(1)
gm &lt;- glm(rbinom(100,1,0.5) ~ rnorm(100), family=binomial)
hosmerlem(gm, group = 10, customFreq = NULL, tables = TRUE)

# multinomial L-H test
vg &lt;- vglm(RET ~ DIAB + GH + BP, model = TRUE,
           family = multinomial(parallel = TRUE), data = retinopathy)
hosmerlem(vg)

# ordinal L-H test
## proportional odds model
cu &lt;- update(vg, family = cumulative(link = 'logitlink', parallel = TRUE))
hosmerlem(cu, tables=TRUE)
hosmerlem(cu, group = 5, tables=TRUE, customFreq = c(rep(100,5), 113))

## adjacent category model
ac &lt;- update(vg, family = acat(parallel = TRUE))
hosmerlem(ac)

## continuation ratio model
cr &lt;- update(vg, family = cratio(parallel = TRUE))
hosmerlem(cr)

## using data.frame
y &lt;- ordered(retinopathy$RET)
df &lt;- data.frame(y, fitted.values(cr))
hosmerlem(df, tables = TRUE)

</code></pre>

<hr>
<h2 id='lipsitz'>Lipsitz Test for Categorical Response Models</h2><span id='topic+lipsitz'></span>

<h3>Description</h3>

<p>This provides a post estimation goodness-of-fit test for
the ordinal response models. Supported models include the proportional odds,
adjacent-category, and constrained continuation-ratio models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lipsitz(model, group = 10, customFreq = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lipsitz_+3A_model">model</code></td>
<td>
<p>a model object or data.frame of observed and estimated
values. The following class of objects can be directly passed to the
<code>lipsitz</code> function: vglm(), serp(), polr(), and clm(). Other class of
objects require providing a data.frame of observed and predicted values.</p>
</td></tr>
<tr><td><code id="lipsitz_+3A_group">group</code></td>
<td>
<p>Default to 10. The number of groups to be formed from the
original observations.</p>
</td></tr>
<tr><td><code id="lipsitz_+3A_customfreq">customFreq</code></td>
<td>
<p>a vector of custom group frequencies to be used instead of
the default equal group frequencies. The vector should, however, sum up to
the total number of original observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similar to the ordinal Hosmer-Lemeshow test (<code><a href="#topic+hosmerlem">hosmerlem</a></code>),
the Lipsitz test also group the observations into k separate groups using
the ordinal scores of the estimated values. According to Lipsitz, Fitzmaurice,
and Molenberghs (1996), the number of groups should be such that 6 &lt;= k &lt; n/5r,
with r the number of response category. An indicator variable is used to
denote the observations belonging to each group, producing additional pseudo
variables with which the original model is updated. Supposing the original
model fits correctly, then the coefficients of the pseudo variables all equal
zero. The likelihood ratio statistic calculated from the log likelihoods of
the original and the refitted models is subsequently compared with the
chi-squared distribution with k - 1 degrees of freedom.
</p>
<p>The Lipsitz test compliments the ordinal Hosmer-Lemeshow and the
Pulkstenis-Robinson tests. Fagerland and Hosmer (2013, 2016, 2017)
recommend comparing the three test.
</p>


<h3>Value</h3>

<table>
<tr><td><code>LR</code></td>
<td>
<p>the realized value of the likelihood ratio statistic.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>newVar</code></td>
<td>
<p>a numeric vector of the newly generated variable.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fagerland, M. W. and Hosmer, D. W. (2013). A goodness-of-fit test for the
proportional odds regression model. <em>Statistics in Medicine</em>,
32, 2235-2249.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2016). Tests for goodness of fit in
ordinal logistic regression models. <em>Journal of Statistical
Computation and Simulation</em>, 86, 3398-3418.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2017). How to test for goodness of fit
in ordinal logistic regression models. <em>Stata Journal</em>, 17, 668-686.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hosmerlem">hosmerlem</a></code>, <code><a href="#topic+pulkroben">pulkroben</a></code>, <code><a href="#topic+brant.test">brant.test</a></code>,
<code><a href="#topic+LR.test">LR.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(VGAM)

set.seed(1)
n &lt;- 200
y &lt;- ordered(rbinom(n, 2, 0.5))
x1 &lt;- factor(rbinom(n, 1, 0.7))
x2 &lt;- runif(n)

## proportional odds model
vg &lt;- vglm(y ~ x1 + x2, model = TRUE,
           family = cumulative(link = "logitlink", parallel = TRUE))
lipsitz(vg, group=6)

## adjacent category model
ac &lt;- update(vg, family = acat(parallel = TRUE))
lipsitz(ac)

## continuation ratio model
cr &lt;- update(vg, family = cratio(parallel = TRUE))
lipsitz(cr)

</code></pre>

<hr>
<h2 id='LR.test'>Likelihood Ratio Test of the Proportional Odds Assumption</h2><span id='topic+LR.test'></span>

<h3>Description</h3>

<p>Provides the means of testing the parallel regression assumption
in the ordinal regression  models. Also available is the brant.test().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LR.test(model, call=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LR.test_+3A_model">model</code></td>
<td>
<p>a single model object to be tested.</p>
</td></tr>
<tr><td><code id="LR.test_+3A_call">call</code></td>
<td>
<p>a logical vector to indicate if the model call should be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parallel regression assumption for the ordinal regression  model
can be tested With this function. It currently supports objects of class
serp() and vglm().
</p>


<h3>Value</h3>

<table>
<tr><td><code>model</code></td>
<td>
<p>the call of the model tested</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom</p>
</td></tr>
<tr><td><code>rdf</code></td>
<td>
<p>residual degrees of freedom</p>
</td></tr>
<tr><td><code>rdev</code></td>
<td>
<p>residual deviance</p>
</td></tr>
<tr><td><code>LRT</code></td>
<td>
<p>likelihood ratio test statistic</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>the p-values of test</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>a logical vector</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+brant.test">brant.test</a></code>, <code><a href="#topic+hosmerlem">hosmerlem</a></code>, <code><a href="#topic+lipsitz">lipsitz</a></code>,
<code><a href="#topic+pulkroben">pulkroben</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(serp)

sp &lt;- serp(ordered(RET) ~ DIAB + GH + BP, link="logit",
           slope="parallel", reverse=TRUE, data = retinopathy)
LR.test(sp, call = TRUE)

</code></pre>

<hr>
<h2 id='print.brant'>Print method for an object of class brant</h2><span id='topic+print.brant'></span>

<h3>Description</h3>

<p>Prints out a summary table of brant-test for an object of class brant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'brant'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.brant_+3A_x">x</code></td>
<td>
<p>An object of class <code>brant</code>.</p>
</td></tr>
<tr><td><code id="print.brant_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+brant.test">brant.test</a></code>
</p>

<hr>
<h2 id='print.erroR'>Print method for an object of class erroR</h2><span id='topic+print.erroR'></span>

<h3>Description</h3>

<p>Prints out a vector of name and calculated error value of fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'erroR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.erroR_+3A_x">x</code></td>
<td>
<p>An object of class <code>erroR</code>.</p>
</td></tr>
<tr><td><code id="print.erroR_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+erroR">erroR</a></code>
</p>

<hr>
<h2 id='print.hosmerlem'>Print method for an object of class hosmerlem</h2><span id='topic+print.hosmerlem'></span>

<h3>Description</h3>

<p>Prints out a summary table of the goodness-of-fit test for binary,
multinomial and ordinal models.
class LRI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hosmerlem'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.hosmerlem_+3A_x">x</code></td>
<td>
<p>An object of class <code>hosmerlem</code>.</p>
</td></tr>
<tr><td><code id="print.hosmerlem_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hosmerlem">hosmerlem</a></code>
</p>

<hr>
<h2 id='print.lipsitz'>Print method for an object of class lipsitz</h2><span id='topic+print.lipsitz'></span>

<h3>Description</h3>

<p>Prints out a summary table of the goodness-of-fit test for an object of
class lipsitz.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lipsitz'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.lipsitz_+3A_x">x</code></td>
<td>
<p>An object of class <code>lipsitz</code>.</p>
</td></tr>
<tr><td><code id="print.lipsitz_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lipsitz">lipsitz</a></code>
</p>

<hr>
<h2 id='print.LRT'>Print method for an object of class LRT</h2><span id='topic+print.LRT'></span>

<h3>Description</h3>

<p>Prints out a summary table of the likelihood ratio test for an object of
class LRI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LRT'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.LRT_+3A_x">x</code></td>
<td>
<p>An object of class <code>LRI</code>.</p>
</td></tr>
<tr><td><code id="print.LRT_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LR.test">LR.test</a></code>
</p>

<hr>
<h2 id='print.pulkroben'>Print method for an object of class pulkroben</h2><span id='topic+print.pulkroben'></span>

<h3>Description</h3>

<p>Prints out a summary table of the goodness-of-fit test for an object of
class pulkroben.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pulkroben'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.pulkroben_+3A_x">x</code></td>
<td>
<p>An object of class <code>pulkroben</code>.</p>
</td></tr>
<tr><td><code id="print.pulkroben_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pulkroben">pulkroben</a></code>
</p>

<hr>
<h2 id='print.Rsquared'>Print method for an object of class r-squared</h2><span id='topic+print.Rsquared'></span>

<h3>Description</h3>

<p>Prints out a vector of name and value of an R2 of a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Rsquared'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.Rsquared_+3A_x">x</code></td>
<td>
<p>An object of class <code>rsquared</code>.</p>
</td></tr>
<tr><td><code id="print.Rsquared_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rsquared">Rsquared</a></code>
</p>

<hr>
<h2 id='pulkroben'>Pulkstenis-Robinson Test for Categorical Response Models</h2><span id='topic+pulkroben'></span>

<h3>Description</h3>

<p>This provides a post estimation goodness-of-fit test for
the ordinal response models. Supported models include the proportional odds,
adjacent-category, and constrained continuation-ratio models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pulkroben(model, test = c("chisq", "deviance"), tables = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pulkroben_+3A_model">model</code></td>
<td>
<p>a model object or data.frame of observed and estimated
values. The following class of objects can be directly passed to the
<code>pulkroben</code> function: vglm(), serp(), polr(), and clm(). Other class of
objects require providing a data.frame of observed and predicted values.</p>
</td></tr>
<tr><td><code id="pulkroben_+3A_test">test</code></td>
<td>
<p>chooses between the chi-squared and the deviance test statistic.</p>
</td></tr>
<tr><td><code id="pulkroben_+3A_tables">tables</code></td>
<td>
<p>Default to FALSE. When TRUE, both the observed and the
expected frequency tables are printed alongside test results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pulkstenis-Robinson test groups the observations using the covariate
patterns obtained from the categorical covariates. Each covariate pattern
is subsequently split in two based on the median ordinal scores. The test
statistic (chi-sq or deviance) is obtaned using the tabulated observed and
estimated frequencies. Assuming c is the number of covariate patterns, r the
number of response categories and k the number of categorical variables in
the model, the test statistic approximates the chi-sq distribution with
(2c - 1)(r - 1) - k - 1 degrees of freedom (Pulkstenis and Robinson (2004)).
As recommended in Fagerland and Hosmer (2016, 2017), this test should
be compared with the Hosmer-Lemeshow and the Lipsitz tests.
</p>


<h3>Value</h3>

<table>
<tr><td><code>stat</code></td>
<td>
<p>realized value of the chi-square or deviance statistic.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test statistic.</p>
</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>a table of the observed frequencies.</p>
</td></tr>
<tr><td><code>expected</code></td>
<td>
<p>a table of the estimated frequencies.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>percentage of estimated frequencies greater than one.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>a character vector of the type of test statistic used.</p>
</td></tr>
<tr><td><code>tables</code></td>
<td>
<p>a TRUE or FALSE logical vector.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pulkstenis, E. and Robinson, T. J. (2004). Goodness-of-fit tests for ordinal
response regression models. <em>Statistics in Medicine</em> 23, 999-1014.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2016). Tests for goodness of fit in
ordinal logistic regression models. <em>Journal of Statistical
Computation and Simulation</em>, 86, 3398-3418.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2017). How to test for goodness of fit
in ordinal logistic regression models. <em>Stata Journal</em>, 17, 668-686.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hosmerlem">hosmerlem</a></code>, <code><a href="#topic+lipsitz">lipsitz</a></code>, <code><a href="#topic+brant.test">brant.test</a></code>,
<code><a href="#topic+LR.test">LR.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(VGAM)

set.seed(1)
n &lt;- 200
y &lt;- ordered(rbinom(n, 2, 0.5))
x1 &lt;- factor(rbinom(n, 1, 0.7))
x2 &lt;- runif(n)

## proportional odds model
vg &lt;- vglm(y ~ x1 + x2, model = TRUE,
           family = cumulative(link = "logitlink", parallel = TRUE))
pulkroben(vg, tables = TRUE)

## adjacent category model
ac &lt;- update(vg, family = acat(parallel = TRUE))
pulkroben(ac, tables = TRUE)

## continuation ratio model
cr &lt;- update(vg, family = cratio(parallel = TRUE))
pulkroben(cr, tables = TRUE)

</code></pre>

<hr>
<h2 id='retinopathy'>Retinopathy</h2><span id='topic+retinopathy'></span>

<h3>Description</h3>

<p>The <code>retinopathy</code> data contains information on persons with retinopathy.
</p>


<h3>Format</h3>

<p>A data frame with 613 observations on the following 5 variables:
- RET: RET=1: no retinopathy, RET=2 nonproliferative retinopathy,
RET=3 advanced retinopathy or blind
- SM: SM=1: smoker, SM=0: non-smoker
- DIAB: diabetes duration in years
- GH: glycosylated hemoglobin measured in percent
- BP: diastolic blood pressure in mmHg
</p>


<h3>References</h3>

<p>Bender and  Grouven (1998), Using binary logistic regression models for
ordinal data with non-proportional odds, <em>J. Clin. Epidemiol.</em>,
51, 809-816.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vaso">vaso</a></code>, <code><a href="#topic+Fishing">Fishing</a></code>
</p>

<hr>
<h2 id='Rsquared'>R-squared for Categorical Response Models</h2><span id='topic+Rsquared'></span>

<h3>Description</h3>

<p>computes the summary measures of predictive strength (i.e., pseudo-R2s)
of several categorical outcome models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rsquared(model, measure)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rsquared_+3A_model">model</code></td>
<td>
<p>single model object for which R2 is determined.</p>
</td></tr>
<tr><td><code id="Rsquared_+3A_measure">measure</code></td>
<td>
<p>selects any of the different measures available.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Rsquared</code> provides different R2 indices for both binary and
multi-categorical response models. Supported classes include: <code>glm</code>,
<code>vglm</code>, <code>clm</code>, <code>polr</code>, <code>multinom</code>, <code>mlogit</code>,
<code>serp</code>. In other words, mainly models with binary or multi-categorical
outcomes are supported. The non-likelihood based measures, including the Mckelvey,
Tjur and Efron R2s are only available for binary models, while the rest of the
measures (likelihood-based) are all available for both binary and
multi-categorical models. The Ugba &amp; Gertheiss's R2 in particular, computes
the recently proposed modification of the popular Mcfadden's R2. The likelihood
ratio index in the said R2 is penalized using either a square-root or logarithmic
stabilizing function of the response category. The two approaches yield practically
the same result.
</p>


<h3>Value</h3>

<table>
<tr><td><code>measure</code></td>
<td>
<p>the name of the R-squared calculated.</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>realized value of the computed R2.</p>
</td></tr>
<tr><td><code>adj</code></td>
<td>
<p>adjusted R2, only available when McFadden's R2 is computed.</p>
</td></tr>
<tr><td><code>sqrt.R2</code></td>
<td>
<p>Modified R2 with a square root penalty, only available when
the Ugba &amp; Gertheiss's R2 is computed.</p>
</td></tr>
<tr><td><code>log.R2</code></td>
<td>
<p>Modified R2 with a logarithmic penalty, only available when
the Ugba &amp; Gertheiss's is computed.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Long, J.S. (1997). <em>Regression Models for Categorical and Limited
Dependent Variables</em>. California: Sage Publications.
</p>
<p>Ugba, E. R. and Gertheiss, J. (2018). An Augmented Likelihood Ratio Index
for Categorical Response Models. In <em>Proceedings of 33rd International
Workshop on Statistical Modelling</em>, Bristol, 293-298.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+erroR">erroR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(serp)

pom &lt;- serp(ordered(RET) ~ DIAB + GH + BP, link="logit",
            slope = "parallel", reverse = TRUE, data = retinopathy)
Rsquared(pom, measure = "mcfadden")
Rsquared(pom, measure = "ugba")

</code></pre>

<hr>
<h2 id='vaso'>Vasoconstriction and Breathing</h2><span id='topic+vaso'></span>

<h3>Description</h3>

<p>A binary data on the neural constriction of vasculature. Three test persons
inhaled a certain amount of air with different rates. In some cases a
vasoconstriction occurred at their skin. The objective of the study was to
indicate a correlation between breathing and vasoconstriction.
The test persons repeated the test 9, 8, 22 times, making a total of
39 observations.
</p>


<h3>Format</h3>

<p>A data frame with 39 observations on the following 3 variables:
- vol: amount of air
- rate: rate of breathing
- vaso: condition of vasculature: no vasoconstriction = 1, vasoconstriction = 2
</p>


<h3>Source</h3>

<p>Data Archive Department of Statistics, LMU Munich.
</p>


<h3>References</h3>

<p>Finney, D. J. (1971) <em>Probit Analysis</em>. 3rd edition. Cambridge
University Press.
</p>
<p>Pregibon, D. (1982) Resistant fits for some commonly used logistic models.
Appl. Stat. <b>29</b>, 15&ndash;24.
</p>
<p>Hastie, T. J. and Tibshirani, R. J. (1990) <em>Generalized Additve Models</em>.
Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+retinopathy">retinopathy</a></code>, <code><a href="#topic+Fishing">Fishing</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
