<!DOCTYPE html><html lang="en"><head><title>Help for package massiveGST</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {massiveGST}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cut_by_logit2NES'><p>Trim the table of results.</p></a></li>
<li><a href='#cut_by_NES'><p>Trim the table of results.</p></a></li>
<li><a href='#cut_by_significance'><p>Trim the table of results.</p></a></li>
<li><a href='#geneSets.sim'><p>Compute the similarities between a collection of gene sets.</p></a></li>
<li><a href='#get_geneProfile'><p>Load a gene-profile from a txt file.</p></a></li>
<li><a href='#get_geneSets_from_local_files'><p>Load the gene-sets collection from local gmt files</p></a></li>
<li><a href='#get_geneSets_from_msigdbr'><p>Get the gene-sets from the msigdbr package.</p></a></li>
<li><a href='#massiveGST'><p>massive Gene-Sets Test with Mann-Whitney-Wilcoxon statistics.</p></a></li>
<li><a href='#massiveORT'><p>A wrapper to fisher.test to get over representation analysis of gene sets.</p></a></li>
<li><a href='#plot.mGST'><p>Graphical rendering of the enrichment analysis.</p></a></li>
<li><a href='#pre_ranked_list'><p>FGFR3-TACC3 fusion positive gene profile</p></a></li>
<li><a href='#save_as_tsv'><p>Save the results in tab-separeted value file</p></a></li>
<li><a href='#save_as_xls'><p>Save the results in xls file format</p></a></li>
<li><a href='#summary.mGST'><p>Generate summary tables</p></a></li>
<li><a href='#write_geneSets_to_gmt'><p>Save a collection of gene-sets in a .gmt file format.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Competitive Gene Sets Test with the Mann-Whitney-Wilcoxon Test</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-28</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stefano Maria Pagnotta &lt;pagnotta@unisannio.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Friendly implementation of the Mann-Whitney-Wilcoxon test for competitive gene set enrichment analysis.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0), formattable (&ge; 0.2.1), msigdbr (&ge; 7.4.0),
WriteXLS (&ge; 6.3.0), igraph (&ge; 1.2.6), visNetwork (&ge; 2.0.9)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="https://github.com/stefanoMP/massiveGST&amp;gt;">https://github.com/stefanoMP/massiveGST&gt;</a>,
&lt;<a href="http://www.massivegenesetstest.org/&amp;gt;">http://www.massivegenesetstest.org/&gt;</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-29 12:26:00 UTC; stefano</td>
</tr>
<tr>
<td>Author:</td>
<td>Stefano Maria Pagnotta
    <a href="https://orcid.org/0000-0002-8298-9777"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-29 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cut_by_logit2NES'>Trim the table of results.</h2><span id='topic+cut_by_logit2NES'></span>

<h3>Description</h3>

<p>This function trims the table of results from massiveGST function retaining the rows with a logit2NES below the specified threshold.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cut_by_logit2NES(ttable, logit2NES_threshold = 0.58)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cut_by_logit2NES_+3A_ttable">ttable</code></td>
<td>
<p>a data frame of &quot;mGST&quot; class coming from massiveGST function. </p>
</td></tr>
<tr><td><code id="cut_by_logit2NES_+3A_logit2nes_threshold">logit2NES_threshold</code></td>
<td>
<p>a real value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame.</p>


<h3>Note</h3>

<p>the functions cut_by_NES, cut_by_logit2NES, and cut_by_significance can be nested.</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>References</h3>

<p>Cerulo, Pagnotta (2022) <a href="https://doi.org/10.3390/e24050739">doi:10.3390/e24050739</a></p>


<h3>See Also</h3>

<p><a href="#topic+massiveGST">massiveGST</a>,  <a href="#topic+cut_by_NES">cut_by_NES</a>, <a href="#topic+cut_by_significance">cut_by_significance</a>, 
</p>
<p><a href="#topic+summary.mGST">summary.mGST</a>, <a href="#topic+plot.mGST">plot.mGST</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

# run the function
ans &lt;- massiveGST(geneProfile, geneSets, alternative = "two.sided")

head(ans)

cut_by_logit2NES(ans)
cut_by_logit2NES(cut_by_significance(ans))

plot(cut_by_logit2NES(ans))

</code></pre>

<hr>
<h2 id='cut_by_NES'>Trim the table of results.</h2><span id='topic+cut_by_NES'></span>

<h3>Description</h3>

<p>This function trims the table of results from massiveGST function retaining the rows with a NES below the specified threshold.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cut_by_NES(ttable, NES_threshold = 0.6)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cut_by_NES_+3A_ttable">ttable</code></td>
<td>
<p>a data frame of 'mGST' class coming from massiveGST function. </p>
</td></tr>
<tr><td><code id="cut_by_NES_+3A_nes_threshold">NES_threshold</code></td>
<td>
<p>a real value between 0.0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame.</p>


<h3>Note</h3>

<p>the functions cut_by_NES, cut_by_logit2NES, and cut_by_significance can be nested. In the case the test has alternative = 'two.sided', it is better to use cut_by_logit2NES for a symmetric trim of both directions.</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>References</h3>

<p>Cerulo, Pagnotta (2022) <a href="https://doi.org/10.3390/e24050739">doi:10.3390/e24050739</a></p>


<h3>See Also</h3>

<p><a href="#topic+massiveGST">massiveGST</a>, <a href="#topic+cut_by_logit2NES">cut_by_logit2NES</a>,  <a href="#topic+cut_by_significance">cut_by_significance</a>, 
<a href="#topic+summary.mGST">summary.mGST</a>, <a href="#topic+plot.mGST">plot.mGST</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

# run the function
ans &lt;- massiveGST(geneProfile, geneSets, alternative = "greater")

head(ans)
cut_by_NES(ans, NES_threshold = .65)
summary(cut_by_NES(ans, NES_threshold = .65))

</code></pre>

<hr>
<h2 id='cut_by_significance'>Trim the table of results.</h2><span id='topic+cut_by_significance'></span>

<h3>Description</h3>

<p>This function trims the table of results from massiveGST function according to the significance required.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cut_by_significance(ttable, 
  level_of_significance = 0.05, 
  where = c("BH.value", "bonferroni", "p.value")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cut_by_significance_+3A_ttable">ttable</code></td>
<td>
<p>a data frame of &quot;mGST&quot; class coming from massiveGST function. </p>
</td></tr>
<tr><td><code id="cut_by_significance_+3A_level_of_significance">level_of_significance</code></td>
<td>
<p>a real value between 0.0 and 1.</p>
</td></tr>
<tr><td><code id="cut_by_significance_+3A_where">where</code></td>
<td>
<p>a character string specifying where the level_of_significance has to be applied to the output;  must be one of &quot;p.value&quot;, &quot;BH.value&quot; (default), and &quot;bonferroni&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BH.value is the adjustment of p-values according to Benijamini and Hockberg's method;  B.value is the adjustment of p-values according to Bonferroni's method.</p>


<h3>Value</h3>

<p>A data frame.</p>


<h3>Note</h3>

<p>the functions cut_by_NES, cut_by_logit2NES, and cut_by_significance can be nested.</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>References</h3>

<p>Cerulo, Pagnotta (2022) <a href="https://doi.org/10.3390/e24050739">doi:10.3390/e24050739</a></p>


<h3>See Also</h3>

<p><a href="#topic+massiveGST">massiveGST</a>, <a href="#topic+cut_by_logit2NES">cut_by_logit2NES</a>, <a href="#topic+cut_by_NES">cut_by_NES</a>,  
<a href="#topic+summary.mGST">summary.mGST</a>, <a href="#topic+plot.mGST">plot.mGST</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

# run the function
ans &lt;- massiveGST(geneProfile, geneSets, alternative = "two.sided")

head(ans)
cut_by_significance(ans)

cut_by_significance(ans, level_of_significance = 0.05, where = "p")
cut_by_logit2NES(cut_by_significance(ans))

summary(cut_by_significance(ans, level_of_significance = 0.05, where = "bonferroni"))

plot(cut_by_significance(ans, level_of_significance = 0.05, where = "bonferroni"))

</code></pre>

<hr>
<h2 id='geneSets.sim'>Compute the similarities between a collection of gene sets.</h2><span id='topic+geneSets.sim'></span>

<h3>Description</h3>

<p>Compute the similarities between a collection of gene sets using a convex function of the Jaccard and overlap indeces.</p>


<h3>Usage</h3>

<pre><code class='language-R'>geneSets.sim(gs, eps = 0.25)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geneSets.sim_+3A_gs">gs</code></td>
<td>
<p>a character vector of gene-sets.</p>
</td></tr>
<tr><td><code id="geneSets.sim_+3A_eps">eps</code></td>
<td>
<p>a real value between 0.0 and 1.0 controlling the contribution of the Jaccard and overlap similaties to their convex combination; eps = 0.25 (default), see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The similarity between the gene-set is computed a convex combination of the Jaccard and overlap similarities. See the reference for further details.</p>


<h3>Value</h3>

<p>returns an object of class &quot;dist&quot;, where the values are the similaties between gene sets.
</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>References</h3>

<p>Cerulo, Pagnotta (2022) <a href="https://doi.org/10.3390/e24050739">doi:10.3390/e24050739</a></p>


<h3>See Also</h3>

<p><a href="stats.html#topic+dist">dist</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")[1:5]

# compute the similarities
geneSets.sim(geneSets)
ssim &lt;- geneSets.sim(geneSets)
ssim &lt;- as.matrix(ssim)
diag(ssim) &lt;- 1
ssim
</code></pre>

<hr>
<h2 id='get_geneProfile'>Load a gene-profile from a txt file.</h2><span id='topic+get_geneProfile'></span>

<h3>Description</h3>

<p>Load a gene-profile from a txt file.</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_geneProfile(ffile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_geneProfile_+3A_ffile">ffile</code></td>
<td>
<p>a character string or a list of a character pointing to a local file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The txt file contains two columuns separated by a tabulation. The first column is the gene name ( or entrez, ensembl, etc); the second column are the numeric values associated with each gene. The profile do not need to be sorted.
</p>
<p>As an example, see the file in /massiveGST/extdata/pre_ranked_list.txt
</p>
<p>See the path in the example below.
</p>


<h3>Value</h3>

<p>A named list of numeric values.</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>See Also</h3>

<p><a href="#topic+pre_ranked_list">pre_ranked_list</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
fname
geneProfile &lt;- get_geneProfile(fname)
class(geneProfile)
head(geneProfile)
tail(geneProfile)
</code></pre>

<hr>
<h2 id='get_geneSets_from_local_files'>Load the gene-sets collection from local gmt files</h2><span id='topic+get_geneSets_from_local_files'></span>

<h3>Description</h3>

<p>Load the gene-sets collection from local gmt files</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_geneSets_from_local_files(ffiles)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_geneSets_from_local_files_+3A_ffiles">ffiles</code></td>
<td>
<p>a character string or a list of a character pointing to local files</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector list of gene-sets</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>See Also</h3>

<p><a href="#topic+get_geneSets_from_msigdbr">get_geneSets_from_msigdbr</a>, <a href="#topic+write_geneSets_to_gmt">write_geneSets_to_gmt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

tmp &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

fname1 &lt;- file.path(tempdir(), "h1.gmt")
write_geneSets_to_gmt(tmp, fileName = fname1)

fname2 &lt;- file.path(tempdir(), "h2.gmt")
write_geneSets_to_gmt(tmp, fileName = fname2)

# getting one collection
geneSets &lt;- get_geneSets_from_local_files(fname1)
length(geneSets)

# getting two collections
geneSets &lt;- get_geneSets_from_local_files(c(fname1, fname2))
length(geneSets)

</code></pre>

<hr>
<h2 id='get_geneSets_from_msigdbr'>Get the gene-sets from the msigdbr package.</h2><span id='topic+get_geneSets_from_msigdbr'></span>

<h3>Description</h3>

<p>This is a wrapper for extraction a gene-sets collection as a vector list to match the data structure for massiveGST function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_geneSets_from_msigdbr(category, what, subcategory = NULL, species = "Homo sapiens")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_geneSets_from_msigdbr_+3A_category">category</code></td>
<td>
<p>MSigDB collection abbreviation, such as H or C1.
</p>
</td></tr>
<tr><td><code id="get_geneSets_from_msigdbr_+3A_what">what</code></td>
<td>
<p>a character string specifying the code representation of the genes; must be one of  &quot;gene_symbol&quot;, &quot;entrez_gene&quot;, &quot;ensembl_gene&quot;, &quot;human_gene_symbol&quot;, &quot;human_entrez_gene&quot;, &quot;human_ensembl_gene&quot;; 
</p>
</td></tr>
<tr><td><code id="get_geneSets_from_msigdbr_+3A_subcategory">subcategory</code></td>
<td>
<p>MSigDB sub-collection abbreviation, such as CGP or BP; NULL (default)
</p>
</td></tr>
<tr><td><code id="get_geneSets_from_msigdbr_+3A_species">species</code></td>
<td>
<p>Species name, such as 'Homo sapiens' or 'Mus musculus'.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector list of gene-sets</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>See Also</h3>

<p><a href="msigdbr.html#topic+msigdbr">msigdbr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

class(geneSets)
head(geneSets, 3)
</code></pre>

<hr>
<h2 id='massiveGST'>massive Gene-Sets Test with Mann-Whitney-Wilcoxon statistics.</h2><span id='topic+massiveGST'></span>

<h3>Description</h3>

<p>Perform a competitive gene set enrichment analysis by applying the Mann-Withney-Wilcoxon test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>massiveGST(gene_profile, gene_sets, 
  cols_to_remove = NULL, 
  alternative = c("two.sided", "less", "greater")
  )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="massiveGST_+3A_gene_profile">gene_profile</code></td>
<td>
<p>a named list of values; the names have to match the names of genes in the gene-set.</p>
</td></tr>
<tr><td><code id="massiveGST_+3A_gene_sets">gene_sets</code></td>
<td>
<p>a character vector of gene-sets.</p>
</td></tr>
<tr><td><code id="massiveGST_+3A_cols_to_remove">cols_to_remove</code></td>
<td>
<p>a list of colnames to eventually remove from the output.</p>
</td></tr>
<tr><td><code id="massiveGST_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis of the MWW test;  must be one of &quot;two.sided&quot; (default), &quot;greater&quot; or &quot;less&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns
</p>
<table role = "presentation">
<tr><td><code>size</code></td>
<td>
<p>Original size of the gene-set.</p>
</td></tr>
<tr><td><code>actualSize</code></td>
<td>
<p>Size of the gene-set after the match with the gene-profile.</p>
</td></tr>
<tr><td><code>NES</code></td>
<td>
<p>(Normalized Enrichment Score) the strength of the association of the gene-set with the gene profile; also the percentile rank of the gene-set in the universe of the genes ouside the gene-set.</p>
</td></tr>
<tr><td><code>odd</code></td>
<td>
<p>odd transformation of the NES.</p>
</td></tr>
<tr><td><code>logit2NES</code></td>
<td>
<p>logit transformation of the NES.</p>
</td></tr>
<tr><td><code>abs_logit2NES</code></td>
<td>
<p>absolute value of the logit2NES in the case of &quot;two.sided&quot; alternative.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-values associated with the gene-set.</p>
</td></tr>
<tr><td><code>BH.value</code></td>
<td>
<p>Benijamini and Hockberg adjustment of the p.values.</p>
</td></tr>
<tr><td><code>B.value</code></td>
<td>
<p>Bonferroni adjustment of the p.values.</p>
</td></tr>
<tr><td><code>relevance</code></td>
<td>
<p>marginal ordering of the table.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>References</h3>

<p>Cerulo, Pagnotta (2022) <a href="https://doi.org/10.3390/e24050739">doi:10.3390/e24050739</a></p>


<h3>See Also</h3>

<p><a href="#topic+summary.mGST">summary.mGST</a>, <a href="#topic+plot.mGST">plot.mGST</a>, <a href="#topic+cut_by_logit2NES">cut_by_logit2NES</a>, <a href="#topic+cut_by_NES">cut_by_NES</a>, <a href="#topic+cut_by_significance">cut_by_significance</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

# run the function
ans &lt;- massiveGST(geneProfile, geneSets, alternative = "two.sided")

ans

</code></pre>

<hr>
<h2 id='massiveORT'>A wrapper to fisher.test to get over representation analysis of gene sets.</h2><span id='topic+massiveORT'></span>

<h3>Description</h3>

<p>The function massiveORT essentially is a wrapper to the function fisher.test in charge to 1) arrange the input to feed fisher.test in sequence for each gene set, 2) arrange the output in a data frame compatible with the other function of the package, and 3) compute the universe of genes for the analysis. </p>


<h3>Usage</h3>

<pre><code class='language-R'>massiveORT(gene_list, gene_sets, universe = NULL, 
          alternative = c("greater", "less", "two.sided"))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="massiveORT_+3A_gene_list">gene_list</code></td>
<td>
<p>a list of gene names, or gene ids that have to match the corresponidng in the gene-set.</p>
</td></tr>
<tr><td><code id="massiveORT_+3A_gene_sets">gene_sets</code></td>
<td>
<p>a character vector of gene-sets.</p>
</td></tr>
<tr><td><code id="massiveORT_+3A_universe">universe</code></td>
<td>
<p>a list of gene, or gene ids, that defines the universe for the analysis (see details); NULL by default.</p>
</td></tr>
<tr><td><code id="massiveORT_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis of the fisher.test; must be one of &quot;two.sided&quot;, &quot;greater&quot; (default) or &quot;less&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to define externally or compute the universe of reference of the analysis. By default (universe = NULL), the universe is computed starting from the gene names contributing at least once in each gene set. </p>


<h3>Value</h3>

<p>A data frame with columns
</p>
<table role = "presentation">
<tr><td><code>universe_size</code></td>
<td>
<p>size of the universe of genes.</p>
</td></tr>
<tr><td><code>geneList_size</code></td>
<td>
<p>size of intersection between the gene list and the universe.</p>
</td></tr>
<tr><td><code>geneSet_size</code></td>
<td>
<p>size of intersection between the gene set and the universe.</p>
</td></tr>
<tr><td><code>geneList_in_GenesSet_size</code></td>
<td>
<p>size of the intersection between the geneList and the geneSet.</p>
</td></tr>
<tr><td><code>odds_ratio</code></td>
<td>
<p>odd ratio coming from the fisher.test</p>
</td></tr>
<tr><td><code>log2_odds_ratio</code></td>
<td>
<p>log2 transformation of odds_ratio.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-values associated with the gene-set coming from the fisher.test</p>
</td></tr>
<tr><td><code>BH.value</code></td>
<td>
<p>Benijamini and Hockberg adjustment of the p.values</p>
</td></tr>
<tr><td><code>B.value</code></td>
<td>
<p>Bonferroni adjustment of the p.values</p>
</td></tr>
<tr><td><code>relevance</code></td>
<td>
<p>marginal ordering of the table.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>References</h3>

<p>Cerulo, Pagnotta (2022) <a href="https://doi.org/10.3390/e24050739">doi:10.3390/e24050739</a></p>


<h3>See Also</h3>

<p><a href="stats.html#topic+fisher.test">fisher.test</a>, <a href="#topic+cut_by_significance">cut_by_significance</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)
geneList &lt;- names(head(geneProfile, 1000))

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "C5", subcategory = "CC", what = "gene_symbol")
geneSets &lt;- geneSets[1:250]

# run the function
ans &lt;- massiveORT(geneList, geneSets)
cut_by_significance(ans)

plot(cut_by_significance(ans), geneSets,as.network = TRUE)
</code></pre>

<hr>
<h2 id='plot.mGST'>Graphical rendering of the enrichment analysis.</h2><span id='topic+plot.mGST'></span>

<h3>Description</h3>

<p>This function displays the enrichment analysis results both as a bar-plot and a network of gene-sets.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mGST'
plot(x, 
  gene_sets = NULL, 
  order_by = "logit2NES", 
  top = 30, 
  eps = 0.25, 
  as.network = FALSE, 
  similarity_threshold = 1/3, 
  manipulation = FALSE, 
  autoResize = TRUE, 
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mGST_+3A_x">x</code></td>
<td>
<p>a data structure coming from the massiveGST function</p>
</td></tr>
<tr><td><code id="plot.mGST_+3A_gene_sets">gene_sets</code></td>
<td>
<p>a character vector of gene-sets; mandatory for the network display</p>
</td></tr>
<tr><td><code id="plot.mGST_+3A_order_by">order_by</code></td>
<td>
<p>a character string specifying whick should be the ordering in the bar-plot; must be one of &quot;relevance&quot;, &quot;NES&quot;, &quot;logit2NES&quot; (default), &quot;p.value&quot;, &quot;BH.value&quot;, and &quot;bonferroni&quot;. These are the same options of <a href="#topic+summary.mGST">summary.mGST</a></p>
</td></tr>
<tr><td><code id="plot.mGST_+3A_top">top</code></td>
<td>
<p>an integer value controlling how many gene-sets have to be displaued in the bar-plot; top = 30 (default)</p>
</td></tr>
<tr><td><code id="plot.mGST_+3A_as.network">as.network</code></td>
<td>
<p>a logical value to switch to a network display; as.network = FALSE (default)</p>
</td></tr>
<tr><td><code id="plot.mGST_+3A_similarity_threshold">similarity_threshold</code></td>
<td>
<p>a real value to cut the similarities between gene-stes below this value; similarity_threshold = 1/3 (default)</p>
</td></tr>
<tr><td><code id="plot.mGST_+3A_eps">eps</code></td>
<td>
<p>a real value between 0.0 and 1.0 controlling the contribution of the Jaccard and overlap similaties to their convex combination; eps = 0.25 (default), see details.</p>
</td></tr>
<tr><td><code id="plot.mGST_+3A_manipulation">manipulation</code></td>
<td>
<p>a logical value allowing to manipulate the network; manipulation = FALSE (default); see <a href="visNetwork.html#topic+visOptions">visOptions</a></p>
</td></tr>
<tr><td><code id="plot.mGST_+3A_autoresize">autoResize</code></td>
<td>
<p>a logical value allowing to resize the network; resize = TRUE (default); see <a href="visNetwork.html#topic+visOptions">visOptions</a></p>
</td></tr>
<tr><td><code id="plot.mGST_+3A_...">...</code></td>
<td>
<p>other graphical parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function display the results of enrichment analysis both as a bar-plot and a network.
</p>
<p>The network rendering is with the visNetwork package. 
</p>
<p>The similarity between the gene-set is computed a convex combination of the Jaccard and overlap similarities. See the reference for further details.</p>


<h3>Value</h3>

<p>In the case of network display, an object from the visNetwork package.
</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>References</h3>

<p>Cerulo, Pagnotta (2022) <a href="https://doi.org/10.3390/e24050739">doi:10.3390/e24050739</a></p>


<h3>See Also</h3>

<p><a href="#topic+massiveGST">massiveGST</a>, <a href="visNetwork.html#topic+visNetwork">visNetwork</a>, <a href="visNetwork.html#topic+visOptions">visOptions</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

# run the function
ans &lt;- massiveGST(geneProfile, geneSets, alternative = "two.sided")

# to get the bar-plot
plot(cut_by_significance(ans, level_of_significance = 0.01))

# to get the network of the gene-sets
plot(cut_by_significance(ans, level_of_significance = 0.01), 
     gene_sets = geneSets, as.network = TRUE)
</code></pre>

<hr>
<h2 id='pre_ranked_list'>FGFR3-TACC3 fusion positive gene profile</h2><span id='topic+pre_ranked_list'></span>

<h3>Description</h3>

<p>This gene-profile comes from the paper in reference. It compares 9 FGFR3-TACC3 fusion positive samples versus 535 other samples in the GBM study from TCGA (Agilent platform). 
</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>References</h3>

<p>Frattini et al. &quot;A metabolic function of FGFR3-TACC3 gene fusions in cancer&quot; <em>Nature volume 553, 2018</em> <a href="https://doi.org/10.1038/nature25171">doi:10.1038/nature25171</a></p>

<hr>
<h2 id='save_as_tsv'>Save the results in tab-separeted value file</h2><span id='topic+save_as_tsv'></span>

<h3>Description</h3>

<p>Save the data frame coming from the massiveGST function as tab-separeted value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_as_tsv(x, file_name = "massiveGST.tsv", sep = "\t", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="save_as_tsv_+3A_x">x</code></td>
<td>
<p>a data frame of &quot;mGST&quot; class coming from massiveGST function.</p>
</td></tr>
<tr><td><code id="save_as_tsv_+3A_file_name">file_name</code></td>
<td>
<p>a character value (&quot;massiveGST.tsv&quot; as default)</p>
</td></tr>
<tr><td><code id="save_as_tsv_+3A_sep">sep</code></td>
<td>
<p>a character value</p>
</td></tr>
<tr><td><code id="save_as_tsv_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>See Also</h3>

<p><a href="#topic+massiveGST">massiveGST</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

# run the function
ans &lt;- massiveGST(geneProfile, geneSets, alternative = "two.sided")

# save the results
fname &lt;- file.path(tempdir(), "massiveGST_results.tsv")
save_as_tsv(ans, file_name = fname)

</code></pre>

<hr>
<h2 id='save_as_xls'>Save the results in xls file format</h2><span id='topic+save_as_xls'></span>

<h3>Description</h3>

<p>Save the data frame coming from the massiveGST function as Excel 2003 (XLS) or Excel 2007 (XLSX) files</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_as_xls(x, file_name = "massiveGST.xls", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="save_as_xls_+3A_x">x</code></td>
<td>
<p>a data frame of &quot;mGST&quot; class coming from massiveGST function.</p>
</td></tr>
<tr><td><code id="save_as_xls_+3A_file_name">file_name</code></td>
<td>
<p>a character value (&quot;massiveGST.xls&quot; as default)</p>
</td></tr>
<tr><td><code id="save_as_xls_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>See Also</h3>

<p><a href="WriteXLS.html#topic+WriteXLS">WriteXLS</a>, <a href="#topic+massiveGST">massiveGST</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

# run the function
ans &lt;- massiveGST(geneProfile, geneSets, alternative = "two.sided")

# save the results
fname &lt;- file.path(tempdir(), "massiveGST_results.xls")
save_as_xls(ans, file_name = fname)

</code></pre>

<hr>
<h2 id='summary.mGST'>Generate summary tables</h2><span id='topic+summary.mGST'></span>

<h3>Description</h3>

<p>This method handles the result of massiveGST function, to provide views of the table.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mGST'
summary(object, 
  cols_to_remove = "link", 
  order_by = c("relevance", "NES", "logit2NES", "p.value", "BH.value", "bonferroni"), 
  top = NULL, 
  as.formattable = FALSE, 
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mGST_+3A_object">object</code></td>
<td>
<p>a data structure coming from the massiveGST function</p>
</td></tr>
<tr><td><code id="summary.mGST_+3A_cols_to_remove">cols_to_remove</code></td>
<td>
<p>A character list of the columns to remove from the output.</p>
</td></tr>
<tr><td><code id="summary.mGST_+3A_order_by">order_by</code></td>
<td>
<p>a character string specifying which marginal ordering has to be applied to the output;  must be one of &quot;relevance&quot; (default), &quot;NES&quot;, &quot;logit2NES&quot;, &quot;p.value&quot;, &quot;BH.value&quot;, and &quot;bonferroni&quot;</p>
</td></tr>
<tr><td><code id="summary.mGST_+3A_top">top</code></td>
<td>
<p>an integer to trim the table to the first 'top' rows.</p>
</td></tr>
<tr><td><code id="summary.mGST_+3A_as.formattable">as.formattable</code></td>
<td>
<p>a logical value (default = FALSE) to provide a formatted output with the help of formattable package.</p>
</td></tr>
<tr><td><code id="summary.mGST_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame.</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>See Also</h3>

<p><a href="#topic+massiveGST">massiveGST</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

# run the function
ans &lt;- massiveGST(geneProfile, geneSets, alternative = "two.sided")

summary(ans)
summary(ans, as.formattable = TRUE, order_by = "NES", top = 10)

</code></pre>

<hr>
<h2 id='write_geneSets_to_gmt'>Save a collection of gene-sets in a .gmt file format.</h2><span id='topic+write_geneSets_to_gmt'></span>

<h3>Description</h3>

<p>Write a collection of gene sets as arranged in this package in a gmt file format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_geneSets_to_gmt(gs, fileName)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_geneSets_to_gmt_+3A_gs">gs</code></td>
<td>
<p>a character vector of gene-sets</p>
</td></tr>
<tr><td><code id="write_geneSets_to_gmt_+3A_filename">fileName</code></td>
<td>
<p>a character value; &quot;gene_sets.gmt&quot; (default)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.</p>


<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>See Also</h3>

<p><a href="#topic+get_geneSets_from_msigdbr">get_geneSets_from_msigdbr</a>, <a href="#topic+get_geneSets_from_local_files">get_geneSets_from_local_files</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(massiveGST)

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "H", what = "gene_symbol")

# save the gene-sets
fname &lt;- file.path(tempdir(), "hallmarks.gmt")
write_geneSets_to_gmt(geneSets, fileName = fname)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
