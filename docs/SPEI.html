<!DOCTYPE html><html><head><title>Help for package SPEI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SPEI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Datasets'><p>Data sets for illustrating the functions in the SPEI package.</p></a></li>
<li><a href='#Drought-indices'><p>Calculation of the Standardized Precipitation-Evapotranspiration</p>
Index (SPEI) and the Standardized Precipitation Index (SPI).</a></li>
<li><a href='#Generalized-Logistic'><p>Generalized Logistic maximum likelihood function</p></a></li>
<li><a href='#Generic-methods-for-spei-objects'><p>Generic methods for <code>spei</code> objects.</p></a></li>
<li><a href='#Kernel-functions'><p>Time kernel for computing the SPEI at different time scales.</p></a></li>
<li><a href='#Potential-evapotranspiration'><p>Computation of potential and reference evapotranspiration.</p></a></li>
<li><a href='#SPEI'><p>SPEI.</p></a></li>
<li><a href='#SPEINews'><p>SPEINews</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.8.1</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculation of the Standardized Precipitation-Evapotranspiration
Index</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of functions for computing potential evapotranspiration and several widely used drought indices including the Standardized Precipitation-Evapotranspiration Index (SPEI).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lmomco, lmom, TLMoments, reshape, ggplot2, checkmate, zoo,
lubridate</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://spei.csic.es">https://spei.csic.es</a>, <a href="https://github.com/sbegueria/SPEI">https://github.com/sbegueria/SPEI</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sbegueria/SPEI/issues">https://github.com/sbegueria/SPEI/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-02 09:33:30 UTC; sbegueria</td>
</tr>
<tr>
<td>Author:</td>
<td>Santiago Beguería [aut, cre],
  Sergio M. Vicente-Serrano [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Santiago Beguería &lt;santiago.begueria@csic.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-02 13:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='Datasets'>Data sets for illustrating the functions in the SPEI package.</h2><span id='topic+Datasets'></span><span id='topic+wichita'></span><span id='topic+balance'></span><span id='topic+cabinda'></span><span id='topic+cruts4'></span>

<h3>Description</h3>

<p>Data used in the examples of the SPEI package:
<code>wichita</code> dataset: monthly climate in Wichita (Kansas, lat=37.6475,
elevation=402.6 m. a.s.l.) since January 1980;
<code>balance</code> dataset: monthly climatic water balance (precipitation
minus potential evapotranspiration) at eleven locations around the World,
since January 1900;
<code>cabinda</code>: one year of data for computing Penman-Monteith ET0 from
Allen et al. (1998);
<code>cruts4</code>: 120 years of monthly climatic water balance (precipitation
minus reference evapotranspiration) data at six grid points from
CRU TS 4.05.
</p>


<h3>Format</h3>

<p><code>wichita</code> dataset: a data frame with:
</p>

<dl>
<dt>YEAR</dt><dd><p> monthly precipitation totals, in mm.</p>
</dd>
<dt>MONTH</dt><dd><p> monthly precipitation totals, in mm.</p>
</dd>
<dt>PRCP</dt><dd><p> monthly precipitation totals, in mm.</p>
</dd>
<dt>TMAX</dt><dd><p> monthly mean daily maximum temperature, in ºC.</p>
</dd>
<dt>TMIN</dt><dd><p> monthly mean daily minimum temperature, in ºC.</p>
</dd>
<dt>TMED</dt><dd><p> monthly mean temperature, in ºC.</p>
</dd>
<dt>AWND</dt><dd><p> monthly mean wind speed, in km h-1</p>
</dd>
<dt>ACSH</dt><dd><p> monthly mean sun hours, in h.</p>
</dd>
<dt>ACSH</dt><dd><p> monthly mean cloud cover, in %.</p>
</dd>
</dl>

<p><code>balance</code> dataset: a data frame with monthly climatic water balance
(precipitation minus potential evapotranspiration) at Indore (India),
Kimberley (South Africa), Albuquerque (US), Valencia (Spain),
Wien (Austria), Abashiri (Japan), Tampa (US), Sao Paulo (Brazil),
Lahore (India), Punta Arenas (Chile) and Helsinki (Finland), in mm.
<code>cabinda</code> dataset: a data frame with one year of monthly climatic data
at Cabinda (Angola, -5.33S 12.11E 20 m), with:
</p>

<dl>
<dt>mon</dt><dd><p> month of the year</p>
</dd>
<dt>Tmin</dt><dd><p> monthly mean daily minimum temperature, in ºC.</p>
</dd>
<dt>Tmax</dt><dd><p> monthly mean daily maximum temperature, in ºC.</p>
</dd>
<dt>RH</dt><dd><p> monthly mean relative humidity, in %.</p>
</dd>
<dt>U2</dt><dd><p> monthly mean wind speed, in km h-1</p>
</dd>
<dt>tsun</dt><dd><p> monthly mean sunshine hours, in h.</p>
</dd>
<dt>Rs</dt><dd><p> monthly mean daily incoming solar radiation, MJ m-2 d-1.</p>
</dd>
<dt>ET0</dt><dd><p> monthly ET0 from the original publication, in mm.</p>
</dd>
</dl>

<p><code>cruts4</code> dataset: an array  with 120 years of monthly climatic water
balance (precipitation minus reference evapotranspiration) data at six grid
points from CRU TS 4.05 data set. The array has dimensions [time=1440,
longitude=2, latitude=3], with time starting in January 1900. Longitudes
are (0.25, 0.75), and latitudes (42.25, 42.75, 43.25), corresponding to the
Central Pyrenees between Spain and France.
</p>


<h3>Details</h3>

<p>See description.
</p>


<h3>Author(s)</h3>

<p>Data ported to R by S. Beguería.
</p>


<h3>Source</h3>

<p>The <code>wichita</code> data were obtained from the Global Historical Climatology
Network (GHCN, <a href="http://www.ncei.noaa.gov/">http://www.ncei.noaa.gov/</a>. Data for the <code>balance</code>
dataset were extracted from CRU TS V3.1 and from the 20th Century Reanalysis
V2 data set.
Data for the <code>balance</code> dataset were taken from Allen et al. (1998),
page 69, figure 18.
The <code>cruts4</code> data were obtained from the CRU (Climatic Research Unit,
University of East Anglia <a href="https://crudata.uea.ac.uk/">https://crudata.uea.ac.uk/</a>) TS V4.05
data set.
</p>


<h3>References</h3>

<p>S.M. Vicente-Serrano, S. Beguería, J.I. López-Moreno. 2010. A Multi-scalar
drought index sensitive to global warming: The Standardized Precipitation
Evapotranspiration Index – SPEI. <em>Journal of Climate</em> <b>23</b>: 1696,
DOI: 10.1175/2009JCLI2909.1.
</p>
<p>R.G. Allen, L.S. Pereira, D. Raes, M. Smith. 1998. <em>JCrop
evapotranspiration - Guidelines for computing crop water requirements - FAO
Irrigation and drainage  paper 56</em>. FAO, Rome. ISBN 92-5-104219-5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wichita)
names(wichita)
summary(wichita)
data(balance)
summary(balance)
data(cruts4)
summary(cruts4)

</code></pre>

<hr>
<h2 id='Drought-indices'>Calculation of the Standardized Precipitation-Evapotranspiration
Index (SPEI) and the Standardized Precipitation Index (SPI).</h2><span id='topic+Drought-indices'></span><span id='topic+spei'></span><span id='topic+spei+2C'></span><span id='topic+spi'></span>

<h3>Description</h3>

<p>Given a time series of the climatic water balance (precipitation minus
potential evapotranspiration), gives a time series of the Standardized
Precipitation-Evapotranspiration Index (SPEI).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spei(
 data,
 scale,
 kernel = list(type = 'rectangular', shift = 0),
 distribution = 'log-Logistic',
 fit = 'ub-pwm',
 na.rm = FALSE,
 ref.start=NULL,
 ref.end=NULL,
 keep.x=FALSE,
 params=NULL,
 verbose=TRUE,
 ...)

spi(
 data,
 scale,
 kernel = list(type = 'rectangular', shift = 0),
 distribution = 'Gamma',
 fit = 'ub-pwm',
 na.rm = FALSE,
 ref.start=NULL,
 ref.end=NULL,
 keep.x=FALSE,
 params=NULL,
 verbose=TRUE,
 ...)

spi(
  data,
  scale,
  kernel = list(type = "rectangular", shift = 0),
  distribution = "Gamma",
  fit = "ub-pwm",
  na.rm = FALSE,
  ref.start = NULL,
  ref.end = NULL,
  keep.x = FALSE,
  params = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Drought-indices_+3A_data">data</code></td>
<td>
<p>a vector, matrix or data frame with time ordered values
of precipitation (for the SPI) or of the climatic balance
precipitation minus potential evapotranspiration (for the SPEI).</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_scale">scale</code></td>
<td>
<p>an integer, representing the time scale at which
the SPEI / SPI will be computed.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_kernel">kernel</code></td>
<td>
<p>optional, a list defining the type of kernel used
for computing the SPEI / SPI at scales higher than one. Defaults
to unshifted rectangular kernel.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_distribution">distribution</code></td>
<td>
<p>optional, name of the distribution function
to be used for computing the SPEI / SPI (one of 'log-Logistic',
'Gamma' and 'PearsonIII'). Defaults to 'log-Logistic' for <code>spei</code>,
and to 'Gamma' for <code>spi</code>.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_fit">fit</code></td>
<td>
<p>optional, name of the method used for computing the
distribution function parameters (one of 'ub-pwm', 'pp-pwm' and
'max-lik'). Defaults to 'ub-pwm'.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_na.rm">na.rm</code></td>
<td>
<p>optional, a logical value indicating whether NA values
should be stripped from the computations. Defaults to FALSE, i.e.
no NA are allowed in the data.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_ref.start">ref.start</code></td>
<td>
<p>optional, starting point of the reference period
used for computing the index. Defaults to NULL, indicating that the
first value in data will be used as starting point.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_ref.end">ref.end</code></td>
<td>
<p>optional, ending point of the reference period used
for computing the index. Defaults to NULL, indicating that the last
value in data will be used as ending point.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_keep.x">keep.x</code></td>
<td>
<p>optional, a logical value indicating whether the data used
for fitting the model should be kept. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_params">params</code></td>
<td>
<p>optional, an array of parameters for computing the
spei. This option overrides computation of fitting parameters.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_verbose">verbose</code></td>
<td>
<p>optional, logical, report the computation options during
calculation. Either 'TRUE' (default) or 'FALSE'.</p>
</td></tr>
<tr><td><code id="Drought-indices_+3A_...">...</code></td>
<td>
<p>other possible parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>spei</code> and <code>spi</code> functions allow computing the SPEI
and the SPI indices. These are climatic proxies widely used for drought
quantification and monitoring. Both functions are identical (in fact,
<code>spi</code> is just a wrapper for <code>spei</code>), but they are kept
separated for clarity. Basically, the functions standardize a variable
following a log-Logistic (or Gamma, or PearsonIII) distribution function
(i.e., they transform it to a standard Gaussian variate with zero mean
and standard deviation of one).
</p>


<h3>Value</h3>

<p>Functions <code>spei</code> and <code>spi</code> return an object of class <code>spei</code>.
The generic functions <code>print</code> and <code>summary</code> can be used to obtain
summaries of the results. The generic accessor functions <code>coefficients</code>
and <code>fitted</code> extract useful features of the object.
</p>
<p>An object of class <code>spei</code> is a list containing at least the
following components:
</p>

<ul>
<li><p> call: the call to <code>spei</code> or <code>spi</code> used to generate the
object.
</p>
</li>
<li><p> fitted: time series with the values of the Standardized
Precipitation-Evapotranspiration Index (SPEI) or the Standardized
Precipitation Index (SPI). If data consists of several columns the
function will treat each column as independent data, and the result will
be a multivariate time series. The names of the columns in <code>data</code>
will be used as column names in fitted.
</p>
</li>
<li><p> coefficients: an array with the values of the coefficients of the
distribution function fitted to the data. The first dimension of the
array contains the three (or two) coefficients, the second dimension will
typically consist of twelve values corresponding to each month, and the
third dimension will be equal to the number of columns (series) in
<code>data</code>. If a time scale greater than one has been used then the
first elements will have NA value since the kernel can not be applied.
The first element with valid data will be the one corresponding to the
time scale chosen.
</p>
</li>
<li><p> scale: the <code>scale</code> parameter used to generate the object.
</p>
</li>
<li><p> kernel: the parameters and values of the kernel used to generate
the object.
</p>
</li>
<li><p> distribution: the distribution function used to generate the object.
</p>
</li>
<li><p> fit: the fitting method used to generate the object.
</p>
</li>
<li><p> na.action: the value of the na.action parameter used.
</p>
</li>
<li><p> data: if requested, the input data used.
</p>
</li></ul>



<h3>Input data</h3>

<p>The input variable is a time ordered series of precipitation values
for <code>spi</code>, or a series of the climatic water balance (precipitation
minus potential evapotranspiration) for <code>spei</code>. When used with the
default options, it would yield values of both indices exactly as defined
in the references given below.
</p>
<p>The SPEI and the SPI were defined for monthly data. Since the PDFs of the
data are not homogenous from month to month, the data is split into twelve
series (one for each month) and independent PDFs are fit to each series. If
<code>data</code> is a vector or a matrix it will be treated as a sequence of
monthly values starting in January. If it is a (univariate or multivariate)
time series then the function <code><a href="stats.html#topic+cycle">cycle</a></code> will be used to determine
the position of each observation within the year (month), allowing the data
to start in a month other than January.
</p>


<h3>Time scales</h3>

<p>An important advantage of the SPEI and the SPI is that they can be computed
at different time scales. This way it is possible to incorporate the
influence of the past values of the variable in the computation enabling
the index to adapt to the memory of the system under study. The magnitude of
this memory is controlled by parameter <code>scale</code>. For example, a value of
six would imply that data from the current month and of the past five months
will be used for computing the SPEI or SPI value for a given month. By
default all past data will have the same weight in computing the index, as
it was originally proposed in the references below. Other kernels, however,
are available through parameter <code>kernel</code>. The parameter <code>kernel</code>
is a list defining the shape of the kernel and a time shift. These
parameters are then passed to the function <code><a href="#topic+kern">kern</a></code>.
</p>


<h3>Probability distributions</h3>

<p>Following the original definitions <code>spei</code> uses a log-Logistic
distribution by default, and <code>spi</code> uses a Gamma distribution. This
behavior can be modified, however, through parameter <code>distribution</code>.
</p>


<h3>Fitting methods</h3>

<p>The default method for parameter fitting is based on unbiased Probability
Weighted Moments ('ub-pwm'), but other methods can be used through parameter
<code>fit</code>. A valid alternative is the plotting-position PWM ('pp-pwm')
method. For the log-Logistic distribution, also the maximum likelihood
method ('max-lik') is available.
</p>


<h3>User-provided parameters</h3>

<p>An option exists to override parameter fitting and provide user default
parameters. This is activated with the parameter <code>params</code>. The exact
values provided to this parameter depend on the distribution function being
used. For log-Logistic and PearsonIII it should be a three-dimensional array
with dimensions (3,number of series in data,12), containing twelve parameter
triads (xi, alpha, kappa) for each data series, one for each month. For
Gamma, a three-dimensional array with dimensions (2,number of series
in data,12),  containing twelve parameter pairs (alpha, beta). It is a good
idea to look at the coefficients slot of a previously fit <code>spei</code> spei
object in order to understand the structure of the parameter array. The
parameter <code>distribution</code> is still used under this option in order to
know what distribution function should be used.
</p>


<h3>Reference period</h3>

<p>The default behavior of the functions is using all the values provided in
<code>data</code> for parameter fitting. However, this can be modified with help
of parameters <code>ref.start</code>  and <code>ref.end</code>. These parameters allow
defining a subset of values that will be used  for parameter fitting, i.e.
a reference period. The functions, however, will compute the  values of the
indices for the whole data set. For these options to work it is necessary
that <code>data</code> will be a time series object. The starting and ending
points of the reference period  will then be defined as pairs of year and
month values, e.g. c(1900,1).
</p>


<h3>Processing large datasets</h3>

<p>It is possible to use the <code>spei</code> and <code>spi</code> functions for
processing multivariate datasets at once. If a matrix or data frame is
supplied as <code>data</code>, with time series of precipitation or precipitation
minus potential evapotranspiration arranged in columns, the result would be
a matrix (data frame) of spi or spei series. This makes processing large
datasets extremely easy, since no loops need to be used.
</p>


<h3>Author(s)</h3>

<p>Santiago Beguería and Sergio M. Vicente-Serrano. Maintainer:
Santiago Beguería.
</p>


<h3>References</h3>

<p>S.M. Vicente-Serrano, S. Beguería, J.I. López-Moreno. 2010. A Multi-scalar
drought index sensitive
to global warming: The Standardized Precipitation Evapotranspiration
Index – SPEI. <em>Journal of Climate</em> <b>23</b>: 1696,
DOI: 10.1175/2009JCLI2909.1.
</p>
<p>S. Beguería, S.M Vicente-Serrano, F. Reig, B. Latorre. 2014. Standardized
precipitation evapotranspiration index (SPEI) revisited: parameter fitting,
evapotranspiration models, tools, datasets and drought monitoring.
<em>International Journal of Climatology</em> <b>34</b>(10): 3001-3023.
</p>
<p><a href="http://spei.csic.es">http://spei.csic.es</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern">kern</a></code> for different kernel functions available.
<code><a href="#topic+thornthwaite">thornthwaite</a></code>,
<code><a href="#topic+hargreaves">hargreaves</a></code> and <code><a href="#topic+penman">penman</a></code> for ways of calculating
potential evapotranspiration.
<code><a href="#topic+summary.spei">summary.spei</a></code> and <code><a href="#topic+print.spei">print.spei</a></code> for summaries of
<code>spei</code> objects.
<code><a href="#topic+plot.spei">plot.spei</a></code> for plotting <code>spei</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load data
data(wichita)

# Compute potential evapotranspiration (PET) and climatic water
# balance (BAL).
wichita$PET &lt;- thornthwaite(wichita$TMED, 37.6475)
wichita$BAL &lt;- wichita$PRCP - wichita$PET

# Convert to a ts (time series) for convenience
wichita &lt;- ts(wichita[, -c(1, 2)], end = c(2011, 10), frequency = 12)
plot(wichita)

# One and twelve-months SPEI
spei1 &lt;- spei(wichita[, "BAL"], 1)
spei12 &lt;- spei(wichita[, "BAL"], 12)
class(spei1)
plot(spei1)
plot(spei12)

# Extract information from `spei` object: summary, call function,
# fitted values, and coefficients
summary(spei1)
names(spei1)
spei1$call
spei1$fitted
spei1$coefficients

# Plot `spei` object
par(mfrow = c(2, 1))
plot(spei1, main = "Wichita, SPEI-1")
plot(spei12, main = "Wichita, SPEI-12")

# One and tvelwe-months SPI
spi_1 &lt;- spi(wichita[, "PRCP"], 1)
spi_12 &lt;- spi(wichita[, "PRCP"], 12)

par(mfrow = c(2, 1))
plot(spi_1, "Wichita, SPI-1")
plot(spi_12, "Wichita, SPI-12")

# Time series not starting in January
plot(spei(ts(wichita[, "BAL"], freq = 12, start = c(1980, 6)), 12))

# Using a particular reference period (1980-2000) for computing the
# parameters. This may result in unexpected values (Inf, NaN) if data
# outside the reference period are way higher or lower than those within
# the reference period.
plot(spei(ts(wichita[, "BAL"], freq = 12, start = c(1980, 6)), 12,
  ref.start = c(1980, 1), ref.end = c(2000, 1)
))

# Using different kernels
spei24 &lt;- spei(wichita[, "BAL"], 24)
spei24_gau &lt;- spei(wichita[, "BAL"], 24,
  kernel = list(type = "gaussian", shift = 0)
)
par(mfrow = c(2, 1))
plot(spei24)
plot(spei24_gau)
dev.off()

# Using different methods (distributions)
spi_gam &lt;- spi(wichita[, "PRCP"], 12, distribution = "Gamma")
spi_pe3 &lt;- spi(wichita[, "PRCP"], 12, distribution = "PearsonIII")
plot(spi_gam$fitted, spi_pe3$fitted)
grid()

# Using custom (user provided) parameters
coe &lt;- spei1$coefficients
dim(coe)
spei(wichita[, "BAL"], 1, params = coe)

# Matrix input (computing data from several stations at one)
# Dataset `balance` contains time series of the climatic water balance at
# 12 locations. Note that input must be provided as matrix.
data(balance)
head(balance)
bal_spei12 &lt;- spei(as.matrix(balance), 12)
plot(bal_spei12)

# 3-d array input (computing data from a gridded spatio-temporal dataset)
# Dataset cruts4 contains monthly time series of the climatic water balance
# at six locations, in a gridded format (3-d array).
data(cruts4)
dim(cruts4)
spei_12 &lt;- spei(cruts4, 12)
dim(spei_12$fitted)

# Modding the plot
# Since plot.spei() returns a ggplot object, it is possible to add or tweak
# parts of the plot.
require(ggplot2)
plot(spei(wichita[, "BAL"], 12)) +
  ggtitle("SPEI1 at Wichita") +
  scale_fill_manual(values = c("blue", "red")) + # classic SPEI look
  scale_color_manual(values = c("blue", "red")) + # classic SPEI look
  theme_classic() +
  theme(legend.position = "bottom")


</code></pre>

<hr>
<h2 id='Generalized-Logistic'>Generalized Logistic maximum likelihood function</h2><span id='topic+Generalized-Logistic'></span><span id='topic+parglo.maxlik'></span>

<h3>Description</h3>

<p>Maximum likelihood fitting function for
generalized logistic distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parglo.maxlik(x, ini)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Generalized-Logistic_+3A_x">x</code></td>
<td>
<p>vector of quantiles for which to evaluate the PDF.</p>
</td></tr>
<tr><td><code id="Generalized-Logistic_+3A_ini">ini</code></td>
<td>
<p>a vector of initial values of the parameters to be fit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used internally by <code>spei</code>
and <code>spi</code> and is supposed to never be needed by the
regular user. Initial values for maximum likelihood estimation
can be provided by <code>parglo</code>.
</p>


<h3>Value</h3>

<p>a list of parameters of a generalized Logistic
distribution function
</p>


<h3>Author(s)</h3>

<p>Santiago Beguería
</p>


<h3>References</h3>

<p>S.M. Vicente-Serrano, S. Beguería, J.I. López-Moreno. 2010.
A Multi-scalar drought index sensitive to global warming:
The Standardized Precipitation Evapotranspiration Index – SPEI.
<em>Journal of Climate</em> <b>23</b>: 1696, DOI: 10.1175/2009JCLI2909.1.
</p>

<hr>
<h2 id='Generic-methods-for-spei-objects'>Generic methods for <code>spei</code> objects.</h2><span id='topic+Generic-methods-for-spei-objects'></span><span id='topic+print.spei'></span><span id='topic+plot.spei'></span><span id='topic+summary.spei'></span>

<h3>Description</h3>

<p>Generic methods for extracting information and plotting <code>spei</code> objects.
</p>
<p>See print.spei
</p>
<p>See print.spei
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spei'
print(x, ...)
## S3 method for class 'spei'
summary(object, ...)
## S3 method for class 'spei'
plot(x, ...)

## S3 method for class 'spei'
summary(object, ...)

## S3 method for class 'spei'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Generic-methods-for-spei-objects_+3A_x">x</code></td>
<td>
<p>an object of class <code>spei</code>.</p>
</td></tr>
<tr><td><code id="Generic-methods-for-spei-objects_+3A_...">...</code></td>
<td>
<p>additional parameters, not used at present.</p>
</td></tr>
<tr><td><code id="Generic-methods-for-spei-objects_+3A_object">object</code></td>
<td>
<p>an object of class <code>spei</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions allow extracting information and plotting
<code>spei</code> objects. <code>print</code> yields the fitted values, i.e. a time
series of SPEI or SPI values. <code>summary</code> reports the function call,
the parameters of the PDF used, and the time series of SPEI or SPI values.
<code>plot</code> produces a plot of the time series of SPEI or SPI values, with
blue and red colors for positive and negative values, respectively. If a
reference period was used in the function call it is shown by a shaded area.
In the event that NA or Inf values were produced, these are shown by
circles.
</p>
<p>See print.spei
</p>
<p>See print.spei
</p>


<h3>Author(s)</h3>

<p>Santiago Beguería
</p>


<h3>References</h3>

<p>S.M. Vicente-Serrano, S. Beguería, J.I. López-Moreno. 2010. A Multi-scalar
drought index sensitive to global warming: The Standardized Precipitation
Evapotranspiration Index – SPEI. <em>Journal of Climate</em> <b>23</b>: 1696,
DOI: 10.1175/2009JCLI2909.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples of use in the help page of the spei() function.

</code></pre>

<hr>
<h2 id='Kernel-functions'>Time kernel for computing the SPEI at different time scales.</h2><span id='topic+Kernel-functions'></span><span id='topic+kern'></span><span id='topic+kern.plot'></span>

<h3>Description</h3>

<p>Function <code>kern</code> is used internally by
<code><a href="#topic+spei">spei</a></code>
and <code><a href="#topic+spi">spi</a></code>for computing drought indices at different
time scales.
</p>
<p>See kern
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kern(scale, type = "rectangular", shift = 0)

kern.plot(scale = 12, shift = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kernel-functions_+3A_scale">scale</code></td>
<td>
<p>numeric, time scale or length of the kernel.</p>
</td></tr>
<tr><td><code id="Kernel-functions_+3A_type">type</code></td>
<td>
<p>character, shape of the kernel function.</p>
</td></tr>
<tr><td><code id="Kernel-functions_+3A_shift">shift</code></td>
<td>
<p>numeric, shifting of the kernel peak.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Drought indices, such as the SPEI or the SPI, are usually
computed at different time scales to adapt to the different response
times of systems affected by drought. This is accomplished by applying
a kernel function to the data prior to computation of the SPEI.
Application of a kernel has the effect of smoothing the temporal
variability of the resulting SPEI, allowing for the major patterns
to emerge from the noise. Other way of considering it is that the
kernel allows incorporating information of previous time steps into the
calculation of the current time step, so the resulting values of the
SPEI adapt to the memory of the system under study.
</p>
<p>The most common kernel function is rectangular, i.e. all the data
of the previous <em>n</em> time steps are given equal weight. This
was the way the Standardized Precipitation Index (SPI) was defined,
and it is also the way the SPEI is computed. This would be the default
option for the <code>kern</code> function. However, data from the past can be
thought of as having a decreasing influence in the current state of the
system as the temporal lag between them increases. The function
<code>kern</code> allows weighting the past data as a function of the time
lapse, according to a series of pre-defined shapes. Available options
are 'rectangular' (default), 'triangular', 'circular' and 'gaussian'.
</p>
<p>By default the highest weight will be given to the observation of the
current month. However, it is possible to modify this by setting the
<code>shift</code> parameter to a value higher than zero. This will cause
the highest weight be given to the <em>n</em> antecedent observation.
</p>
<p><code>kern.plot</code> produces plots of the weighting factor against the
time lag for the four different kernel shapes so they can be compared.
</p>
<p>See kern
</p>


<h3>Value</h3>

<p>A vector of length equal to <code>scale</code> with weights used for
computing the drought index.
</p>


<h3>Author(s)</h3>

<p>Santiago Beguería
</p>


<h3>References</h3>

<p>S.M. Vicente-Serrano, S. Beguería, J.I. López-Moreno. 2010.
A Multi-scalar drought index sensitive to global warming: The
Standardized Precipitation Evapotranspiration Index – SPEI.
<em>Journal of Climate</em> <b>23</b>: 1696, DOI: 10.1175/2009JCLI2909.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A rectangular kernel with a time scale of 12 and no shift
kern(12)
# A gaussian kernel with a time scale of 12 and no shift
kern(12,'gaussian')
# Comparison of the four kernels, with and without shift
kern.plot(12)
kern.plot(12,2)


</code></pre>

<hr>
<h2 id='Potential-evapotranspiration'>Computation of potential and reference evapotranspiration.</h2><span id='topic+Potential-evapotranspiration'></span><span id='topic+hargreaves'></span><span id='topic+thornthwaite'></span><span id='topic+penman'></span>

<h3>Description</h3>

<p>Potential evapotranspiration (PET) is the amount of evaporation and
transpiration that would occur if a sufficient water source were available.
Reference evapotranspiration (ETo) is the amount of evaporation and
transpiration from a reference vegetation of grass. They are usually
considered equivalent. This set of functions calculate PET or ETo according
to the Thornthwaite, Hargreaves or Penman-Monteith equations.
</p>
<p>See hargreaves
</p>
<p>See hargreaves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thornthwaite(Tave, lat, na.rm = FALSE, verbose=TRUE)

hargreaves(Tmin, Tmax, Ra = NULL, lat = NULL, Pre = NULL, na.rm = FALSE,
verbose=TRUE)

penman(Tmin, Tmax, U2, Ra = NULL, lat = NULL, Rs = NULL, tsun = NULL,
       CC = NULL, ed = NULL, Tdew = NULL, RH = NULL, P = NULL, P0 = NULL,
       CO2 = NULL, z = NULL, crop='short', na.rm = FALSE, method='ICID',
       verbose=TRUE)

penman(
  Tmin,
  Tmax,
  U2 = NULL,
  Ra = NULL,
  lat = NULL,
  Rs = NULL,
  tsun = NULL,
  CC = NULL,
  ed = NULL,
  Tdew = NULL,
  RH = NULL,
  P = NULL,
  P0 = NULL,
  CO2 = NULL,
  z = NULL,
  crop = "short",
  na.rm = FALSE,
  method = "ICID",
  verbose = TRUE
)

thornthwaite(Tave, lat, na.rm = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Potential-evapotranspiration_+3A_tmin">Tmin</code></td>
<td>
<p>a numeric vector, tsvector, matrix, tsmatrix, or 3-d array of
monthly mean daily minimum temperatures, ºC.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_tmax">Tmax</code></td>
<td>
<p>a numeric vector, tsvector, matrix, tsmatrix, or 3-d array of
monthly mean daily maximum temperatures, ºC.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_ra">Ra</code></td>
<td>
<p>optional, a numeric vector, tsvector, matrix, tsmatrix, or 3-d
array of monthly mean daily external radiation, MJ m-2 d-1.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_lat">lat</code></td>
<td>
<p>a numeric vector or matrix with the latitude of the site or
sites, in degrees.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_pre">Pre</code></td>
<td>
<p>optional, a numeric vector, tsvector, matrix, tsmatrix, or 3-d
array  of monthly total precipitation, mm.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_na.rm">na.rm</code></td>
<td>
<p>optional, a logical value indicating whether NA values should
be stripped from the computations.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_verbose">verbose</code></td>
<td>
<p>optional, logical, report the computation options during
calculation. Either 'TRUE' (default) or 'FALSE'.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_u2">U2</code></td>
<td>
<p>a numeric vector, tsvector, matrix, tsmatrix, or 3-d array of
monthly mean daily wind speeds at 2 m height, m s-1.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_rs">Rs</code></td>
<td>
<p>optional, a numeric vector, tsvector, matrix, tsmatrix, or 3-d
array of monthly mean daily incoming solar radiation, MJ m-2 d-1.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_tsun">tsun</code></td>
<td>
<p>optional, a numeric vector, tsvector, matrix, tsmatrix, or 3-d
array of monthly mean daily bright sunshine hours, h.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_cc">CC</code></td>
<td>
<p>optional, numeric a vector, matrix or time series of monthly
mean cloud cover, %.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_ed">ed</code></td>
<td>
<p>optional, numeric a vector, matrix or time series of monthly
mean actual vapor pressure at 2 m height, kPa.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_tdew">Tdew</code></td>
<td>
<p>optional, a numeric vector, tsvector, matrix, tsmatrix,
or 3-d array of monthly mean daily dewpoint temperature (used for
estimating ed), ºC.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_rh">RH</code></td>
<td>
<p>optional, a numeric vector, tsvector, matrix, tsmatrix,
or 3-d array of monthly mean relative humidity (used for estimating ed), %.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_p">P</code></td>
<td>
<p>optional, a numeric vector, tsvector, matrix, tsmatrix,
or 3-d array of monthly mean atmospheric pressure at surface, kPa.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_p0">P0</code></td>
<td>
<p>optional, a numeric vector, tsvector, matrix, tsmatrix,
or 3-d array of monthly mean atmospheric pressure at sea level (used for
estimating P), kPa.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_co2">CO2</code></td>
<td>
<p>optional, a single numeric value, a numeric vector,
or a tsvector of monthly mean CO2 atmospheric concentration, ppm.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_z">z</code></td>
<td>
<p>optional, a numeric vector or matrix of the elevation of the
site or sites, m above sea level.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_crop">crop</code></td>
<td>
<p>optional, character string, type of reference crop. Either
one of 'short' (default) or 'tall'.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_method">method</code></td>
<td>
<p>optional, character string, Penman-Monteith calculation
method. Either one of 'ICID' (default), 'FAO', or 'ASCE'.</p>
</td></tr>
<tr><td><code id="Potential-evapotranspiration_+3A_tave">Tave</code></td>
<td>
<p>a numeric vector, tsvector, matrix, tsmatrix, or 3-d array of
monthly mean temperatures, ºC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>thornthwaite</code> computes the monthly potential
evapotranspiration (PE) according to the Thornthwaite (1948) equation.
It is the simplest of the three methods, and can be used when only
mean temperature data are available.
</p>
<p><code>hargreaves</code> computes the monthly reference evapotranspiration (ETo)
of a grass crop based on the original Hargreaves equation (1994). However,
if precipitation data <code>Pre</code> is provided a modified form due to Droogers
and Allen (2002) will be used; this equation corrects ETo using
the amount of rain of each month as a proxy for irradiation The Hargreaves
method requires data on the mean external radiation, <code>Ra</code>. If <code>Ra</code> is not available it
can be estimated from the latitude <code>lat</code> and the month of the year.
</p>
<p><code>penman</code> calculates the monthly reference evapotranspiration (ETo) of
a hypothetical reference crop according to the Penman-Monteith equation
(Monteith, 1965). This is widely considered the most accurate method for
estimating ETo, and is the method recommended by the UN Food and Agriculture
Organization (FAO). There are several methods which simplify the original
Penman-Monteith equation and are used in practice. Here we follow by default
the procedure described in Allen et al. (1994), aka the 'ICID' method.
However, other versions are also implemented and can be used by setting the
<code>method</code> parameter to the appropriate value. The FAO-56 method
(Allen et al., 1998) can be used by setting <code>method</code> to 'FAO',
while the variation of the American Society of Civil Engineers (Walter et
al., 2002 is used when setting it to 'ASCE'.
By default the original parameterization corresponding to a short reference
crop of 0.12 m height is used, although the parameterization for a tall
reference crop of 0.5 m height (Walter et al. (2002) can also be used,
by setting the <code>crop</code> parameter to 'tall'.
The method requires data on the incoming solar radiation, <code>Rs</code>;
since this is seldom available, the code will estimate it from data on the
bright sunshine duration <code>tsun</code>, or alternatively from data on the
percent cloud cover <code>CC</code>. Similarly, if data on the saturation water
pressure <code>ed</code> are not available, it is possible to estimate it from
the dew point temperature <code>Tdew</code>, from the relative humidity <code>RH</code>
or even from the minimum temperature <code>Tmin</code> (sorted from least to most
uncertain method). Similarly, the atmospheric surface pressure <code>P</code>
required for computing the psychrometric constant can be calculated from the
atmospheric pressure at sea level <code>P0</code> and the elevation <code>z</code>,
or else it will be assumed to be constant (101.3 kPa). If no wind speed
data <code>U2</code> are available, a constant value of 2 m per second is used.
Custom CO2 atmospheric concentration <code>CO2</code> can also be provided,
following Yang et al. (2019).
</p>
<p>The function will produce an error message if a valid combination of input
parameters is not provided.
If <code>verbose</code> is 'TRUE' (the default value), a message will be produced
informing on the computation options selected.
</p>
<p>The function accepts data in a variety of formats, including 1-D vectors,
2-D matrices and 3-D arrays.
The input data format will determine the output format.
Vector input can be used for single-station data. Matrix input can be used
to produce output for a number of locations, where each column in the matrix
will be considered as one location. 3-D arrays can be used to process
gridded data, with the first dimension being time and the two other
dimensions representing spatial coordinates. See the examples below for a
guidance on how to use these options.
</p>
<p>If the main input object (<code>Tave</code>, <code>Tmin</code>, <code>Tmax</code>) is a time
series then the function <code><a href="stats.html#topic+cycle">cycle</a></code> will be used to determine the
position of each observation within the
year (month), allowing the data to start in a month different than January.
If no time information is provided, then the input data will be treated as
a sequence of monthly values starting in January.
</p>
<p>See hargreaves
</p>
<p>See hargreaves
</p>


<h3>Value</h3>

<p>A vector, matrix or 3-d array with the values of monthly potential
or reference evapotranspiration, in mm.
</p>
<p>A time series with the values of monthly potential or reference
evapotranspiration, in mm.
If the input is a matrix or a multivariate time series each column will be
treated as independent data (e.g., different observatories), and the output
will be a multivariate time series.
</p>
<p>A time series with the values of monthly potential or reference
evapotranspiration, in mm. If the input is a matrix or a multivariate time
series each column will be treated as independent data (e.g., diferent
observatories), and the output will be a multivariate time series.
</p>


<h3>Author(s)</h3>

<p>Santiago Beguería
</p>


<h3>References</h3>

<p>Thornthwaite, C. W., 1948. An approach toward a rational classification of
climate.
<em>Geographical Review</em> <b>38</b>: 55–94. DOI:10.2307/2107309.
</p>
<p>Hargreaves G.H., 1994. Defining and using reference evapotranspiration.
<em>Journal of Irrigation and Drainage Engineering</em> <b>120</b>: 1132–1139.
</p>
<p>Droogers P., Allen R. G., 2002. Estimating reference evapotranspiration
under inaccurate data conditions. <em>Irrigation and Drainage Systems</em>
<b>16</b>: 33–45.
</p>
<p>Monteith, J. L., 1965. Evaporation and environment. <em>Symposia of the
Society for Experimental Biology</em> <b>19</b>: 205–234.
</p>
<p>Allen R. G., Smith M., Pereira L. S., Perrier A., 1994. An update for the
calculation of reference evapotranspiration. <em>ICID Bulletin of the
International Commission on Irrigation and Drainage</em>, 35–92.
</p>
<p>Allen R.G., Pereira L.S.,Raes D., Smith, M., 1998. <em>J. Crop
evapotranspiration - Guidelines for computing crop water requirements - FAO
Irrigation and drainage paper 56</em>. FAO, Rome. ISBN 92-5-104219-5.
</p>
<p>Walter I.A. and 14 co-authors, 2002. <em>The ASCE standardized reference
evapotranspiration equation.</em> Rep. Task Com. on Standardized Reference
Evapotranspiration July 9, 2002, EWRI–Am. Soc. Civil Engr., Reston, VA,
57 pp.
</p>
<p>Yang, Y., Roderick, M.L., Zhang, S. McVicar, T., Donohue, R.J., 2019.
Hydrologic implications of vegetation response to elevated CO2 in climate
projections. <em>Nature Climate Change</em> <b>9</b>: 44–48.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load data for Tampa, lat=37.6475N, elevation=402.6 m. a.s.l.
# Data consists on monthly values since January 1980

data(wichita)
attach(wichita)
names(wichita)

# PET following Thornthwaite
tho &lt;- thornthwaite(TMED, 37.6475)

# ETo by Hargreaves
har &lt;- hargreaves(TMIN, TMAX, lat = 37.6475)

# ETo by Penman, based on sun hours, ignore NAs
pen &lt;- penman(TMIN, TMAX, AWND, tsun = TSUN, lat = 37.6475, z = 402.6, na.rm = TRUE)

# Penman, based on cloud cover
pen2 &lt;- penman(TMIN, TMAX, AWND, CC = ACSH, lat = 37.6475, z = 402.6, na.rm = TRUE)

# Penman, with constant wind
pen3 &lt;- penman(TMIN, TMAX, tsun = TSUN, lat = 37.6475, z = 402.6, na.rm = TRUE)

# Plot them together
plot(ts(cbind(tho, har, pen, pen2, pen3), fr = 12))

# Compare between methods
pairs(cbind(tho, har, pen, pen2, pen3))

# Input data as a time series vector; note that only the first parameter
# needs to be a `ts` object.

thornthwaite(ts(TMED, start = c(1980, 1), frequency = 12), 37.6475)
hargreaves(ts(TMIN, start = c(1980, 1), frequency = 12), TMAX, lat = 37.6475)
penman(ts(TMIN, start = c(1980, 1), frequency = 12), TMAX, AWND,
  tsun = TSUN,
  lat = 37.6475, z = 402.6, na.rm = TRUE
)

# Input data as a time series. Consider the data started in June 1980
thornthwaite(ts(TMED, start = c(1980, 6), frequency = 12), 37.6475)

# Comparison with example from Allen et al. (1998), p. 69, fig. 18:
# Data from Cabinda, Angola (-5.33S, 12.11E, 20 m a.s.l.)

data(cabinda)
pen.cab &lt;- penman(cabinda$Tmin, cabinda$Tmax, cabinda$U2,
  Rs = cabinda$Rs, tsun = cabinda$tsun, RH = cabinda$RH, lat = -5.33, z = 20
)
plot(cabinda$ET0, pen.cab)
abline(0, 1, lt = "dashed")
summary(lm(pen.cab ~ cabinda$ET0))$r.squared

# Matrix input (data from several stations)
# Replicating Wichita data twice to simulate data at two locations.

tmin &lt;- cbind(TMIN, TMIN + 1.5)
tmax &lt;- cbind(TMAX, TMAX + 1.5)
lat &lt;- c(37.6475, 35.000)
har &lt;- hargreaves(tmin, tmax, lat = lat, na.rm = TRUE)
plot(har)
abline(0, 1)
plot(ts(har, fr = 12))

# Array input (gridded data)
# Replicating Wichita data to simulate data from a grid. Note that the time
# dimension (`nt`) comes first. Latitude is provided as a 2-d array.

nt &lt;- length(TMIN)
tmin &lt;- array(TMIN, dim = c(nt, 2, 2))
tmax &lt;- array(TMAX, dim = c(nt, 2, 2))
lat &lt;- array(c(40, 30, 40, 30), dim = c(2, 2))
har &lt;- hargreaves(tmin, tmax, lat = lat, na.rm = TRUE)
dim(har)

# Different Penman-Monteith flavors

pen_icid &lt;- penman(TMIN, TMAX, AWND,
  tsun = TSUN, lat = 37.6475, z = 402.6,
  na.rm = TRUE, method = "ICID"
)
pen_asce &lt;- penman(TMIN, TMAX, AWND,
  tsun = TSUN, lat = 37.6475, z = 402.6,
  na.rm = TRUE, method = "ASCE"
)
pen_fao &lt;- penman(TMIN, TMAX, AWND,
  tsun = TSUN, lat = 37.6475, z = 402.6,
  na.rm = TRUE, method = "FAO"
)
plot(ts(cbind(pen_icid, pen_asce, pen_fao), fr = 12))

# Different CO2 concentrations

# Default (300 ppm)
pen_300 &lt;- penman(TMIN, TMAX, AWND,
  tsun = TSUN, lat = 37.6475, z = 402.6,
  na.rm = TRUE
)
# Increased to 450 ppm
pen_450 &lt;- penman(TMIN, TMAX, AWND,
  tsun = TSUN, lat = 37.6475, z = 402.6,
  CO2 = 450, na.rm = TRUE
)
plot(pen_450, pen_300)
abline(0, 1)
# Increasing from 300 to 450
co2 &lt;- seq(300, 450, length.out = length(TMIN))
pen_co2 &lt;- penman(TMIN, TMAX, AWND,
  tsun = TSUN, lat = 37.6475, z = 402.6,
  CO2 = co2, na.rm = TRUE
)
plot(ts(cbind(pen_300, pen_co2), fr = 12))

</code></pre>

<hr>
<h2 id='SPEI'>SPEI.</h2><span id='topic+SPEI'></span>

<h3>Description</h3>

<p>A set of functions for computing potential evapotranspiration and several
widely used drought indices including the Standardized
Precipitation-Evapotranspiration Index (SPEI).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> SPEI</td>
</tr>
<tr>
 <td style="text-align: left;">
  Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 1.8</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2023-01-20</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL version 2 or newer</td>
</tr>
<tr>
 <td style="text-align: left;">
  LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Functions <code><a href="#topic+spei">spei</a></code> and <code><a href="#topic+spi">spi</a></code> are the workhorse of the
SPEI library. Other functions such as <code><a href="#topic+kern">kern</a></code>,
<code><a href="#topic+parglo.maxlik">parglo.maxlik</a></code> is an auxiliary low-level function and
will not be used directly by the typical user. Functions for computing
potential evapotranspiration are provided, too, for helping computing
the SPEI. They are: <code><a href="#topic+thornthwaite">thornthwaite</a></code>,
<code><a href="#topic+hargreaves">hargreaves</a></code> and <code><a href="#topic+penman">penman</a></code>.
</p>


<h3>Author(s)</h3>

<p>Santiago Beguería and Sergio M. Vicente-Serrano
Maintainer: Santiago Beguería
Contributors: Fergus Reig
</p>


<h3>References</h3>

<p>S.M. Vicente-Serrano, S. Beguería, J.I. López-Moreno. 2010. A Multi-scalar
drought index sensitive to global warming: The Standardized Precipitation
Evapotranspiration Index – SPEI. <em>Journal of Climate</em> <b>23</b>: 1696,
DOI: 10.1175/2009JCLI2909.1.
</p>
<p><a href="https://spei.csic.es">https://spei.csic.es</a>
</p>

<hr>
<h2 id='SPEINews'>SPEINews</h2><span id='topic+SPEINews'></span>

<h3>Description</h3>

<p>Show the NEWS file of the <span class="pkg">SPEI</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPEINews()
</code></pre>


<h3>Details</h3>

<p>(See description)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
