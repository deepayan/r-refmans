<!DOCTYPE html><html lang="en-GB"><head><title>Help for package ADSIHT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ADSIHT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ADSIHT-package'><p>ADSIHT: Adaptive Double Sparse Iterative Hard Thresholding</p></a></li>
<li><a href='#ADSIHT'><p>Adaptive Double Sparse Iterative Hard Thresholding Algorithm (ADSIHT)</p></a></li>
<li><a href='#ADSIHT.ML'><p>ADSIHT in multi-task learning framework</p></a></li>
<li><a href='#gen.data'><p>Generate simulated data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Adaptive Double Sparse Iterative Hard Thresholding</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-5</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yanhang Zhang &lt;zhangyh98@ruc.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Solving the high-dimensional double sparse linear regression via iterative hard thresholding algorithm. For more details, please see Zhang et al. (2024, &lt;<a href="https://doi.org/10.48550%2FarXiv.2305.04182">doi:10.48550/arXiv.2305.04182</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, mvnfast, Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-11 03:21:08 UTC; Yanhang</td>
</tr>
<tr>
<td>Author:</td>
<td>Yanhang Zhang [aut, cre],
  Zhifan Li [aut],
  Jianxin Yin [aut],
  Shixiang Liu [aut],
  Lingren Kong [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-11 17:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='ADSIHT-package'>ADSIHT: Adaptive Double Sparse Iterative Hard Thresholding</h2><span id='topic+ADSIHT-package'></span>

<h3>Description</h3>

<p>Solving the high-dimensional double sparse linear regression via iterative hard thresholding algorithm. For more details, please see Zhang et al. (2024, <a href="https://doi.org/10.48550/arXiv.2305.04182">doi:10.48550/arXiv.2305.04182</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Yanhang Zhang <a href="mailto:zhangyh98@ruc.edu.cn">zhangyh98@ruc.edu.cn</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Zhifan Li <a href="mailto:zhifanli@bimsa.cn">zhifanli@bimsa.cn</a>
</p>
</li>
<li><p> Jianxin Yin <a href="mailto:jyin@ruc.edu.cn">jyin@ruc.edu.cn</a>
</p>
</li>
<li><p> Shixiang Liu <a href="mailto:liushixiang_stat@ruc.edu.cn">liushixiang_stat@ruc.edu.cn</a>
</p>
</li>
<li><p> Lingren Kong <a href="mailto:lingrenkong@ruc.edu.cn">lingrenkong@ruc.edu.cn</a>
</p>
</li></ul>


<hr>
<h2 id='ADSIHT'>Adaptive Double Sparse Iterative Hard Thresholding Algorithm (ADSIHT)</h2><span id='topic+ADSIHT'></span>

<h3>Description</h3>

<p>An implementation of the sparse group selection in linear regression model via ADSIHT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ADSIHT(
  x,
  y,
  group,
  s0,
  kappa = 0.9,
  ic.type = c("dsic", "loss"),
  ic.scale = 3,
  ic.coef = 3,
  L = 5,
  weight = rep(1, nrow(x)),
  coef1 = 1,
  coef2 = 1,
  eta = 0.8,
  max_iter = 20,
  method = "ols"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ADSIHT_+3A_x">x</code></td>
<td>
<p>Input matrix, of dimension <code class="reqn">n \times p</code>; each row is an observation
vector and each column is a predictor.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_y">y</code></td>
<td>
<p>The response variable of <code>n</code> observations.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_group">group</code></td>
<td>
<p>A vector indicating which group each variable belongs to
For variables in the same group, they should be located in adjacent columns of <code>x</code>
and their corresponding index in <code>group</code> should be the same.
Denote the first group as <code>1</code>, the second <code>2</code>, etc.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_s0">s0</code></td>
<td>
<p>A vector that controls the degrees with group.
Default is <code class="reqn">d^((l-1)/(L-1))</code> : <code class="reqn">1 \leq l \leq L</code>, where d is the maximum group size.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_kappa">kappa</code></td>
<td>
<p>A parameter that controls the rapid of the decrease of threshold. Default is 0.9.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_ic.type">ic.type</code></td>
<td>
<p>The type of criterion for choosing the support size.
Available options are <code>"dsic"</code>, <code>"loss"</code>.
Default is <code>"dsic"</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_ic.scale">ic.scale</code></td>
<td>
<p>A non-negative value used for multiplying the penalty term
in information criterion. Default: <code>ic.scale = 3</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_ic.coef">ic.coef</code></td>
<td>
<p>A non-negative value used for multiplying the penalty term
for choosing the optimal stopping time. Default: <code>ic.coef = 3</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_l">L</code></td>
<td>
<p>The length of the sequence of s0. Default: <code>L = 5</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_weight">weight</code></td>
<td>
<p>The weight of the samples, with the default value set to 1 for each sample.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_coef1">coef1</code></td>
<td>
<p>A positive value to control the sub-optimal stopping time.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_coef2">coef2</code></td>
<td>
<p>A positive value to control the overall stopping time. A small value leads to larger search range.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_eta">eta</code></td>
<td>
<p>A parameter controls the step size in the gradient descent step.
Default: <code>eta = 0.8</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_max_iter">max_iter</code></td>
<td>
<p>A parameter that controls the maximum number of line search, ignored if <code>OLS</code> is employed.</p>
</td></tr>
<tr><td><code id="ADSIHT_+3A_method">method</code></td>
<td>
<p>Whether <code>ols</code> (default) or <code>linesearch</code> method should be employed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> object comprising:
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>A <code class="reqn">p</code>-by-<code>length(s0)</code> matrix of coefficients, stored in column format.</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>A <code>length(s0)</code> vector of intercepts</p>
</td></tr></table>
<p>.
</p>
<table role = "presentation">
<tr><td><code>lambda</code></td>
<td>
<p>A <code>length(s0)</code> vector of threshold values</p>
</td></tr>
<tr><td><code>A_out</code></td>
<td>
<p>The selected variables given threshold value in <code>lambda</code>.</p>
</td></tr>
<tr><td><code>ic</code></td>
<td>
<p>The values of the specified criterion for each fitted model given threshold <code>lamdba</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanhang Zhang, Zhifan Li, Shixiang Liu, Jianxin Yin.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 200
m &lt;- 100
d &lt;- 10
s &lt;- 5
s0 &lt;- 5
data &lt;- gen.data(n, m, d, s, s0)
fit &lt;- ADSIHT(data$x, data$y, data$group)
fit$A_out[which.min(fit$ic)]
</code></pre>

<hr>
<h2 id='ADSIHT.ML'>ADSIHT in multi-task learning framework</h2><span id='topic+ADSIHT.ML'></span>

<h3>Description</h3>

<p>An implementation of the sparse group selection in linear regression model via ADSIHT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ADSIHT.ML(
  x_list,
  y_list,
  group_list,
  s0,
  kappa = 0.9,
  ic.type = c("dsic", "loss"),
  ic.scale = 3,
  ic.coef = 3,
  L = 5,
  weight,
  coef1 = 1,
  coef2 = 1,
  eta = 0.8,
  max_iter = 20,
  method = "ols"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ADSIHT.ML_+3A_x_list">x_list</code></td>
<td>
<p>The list of input matrix.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_y_list">y_list</code></td>
<td>
<p>The list of response variable.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_group_list">group_list</code></td>
<td>
<p>A vector indicating which group each variable belongs to
For variables in the same group, they should be located in adjacent columns of <code>x</code>
and their corresponding index in <code>group</code> should be the same.
Denote the first group as <code>1</code>, the second <code>2</code>, etc.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_s0">s0</code></td>
<td>
<p>A vector that controls the degrees with group.
Default is <code class="reqn">d^((l-1)/(L-1))</code> : <code class="reqn">1 \leq l \leq L</code>, where d is the maximum group size.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_kappa">kappa</code></td>
<td>
<p>A parameter that controls the rapid of the decrease of threshold. Default is 0.9.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_ic.type">ic.type</code></td>
<td>
<p>The type of criterion for choosing the support size.
Available options are <code>"dsic"</code>, <code>"loss"</code>.
Default is <code>"dsic"</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_ic.scale">ic.scale</code></td>
<td>
<p>A non-negative value used for multiplying the penalty term
in information criterion. Default: <code>ic.scale = 3</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_ic.coef">ic.coef</code></td>
<td>
<p>A non-negative value used for multiplying the penalty term
for choosing the optimal stopping time. Default: <code>ic.coef = 3</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_l">L</code></td>
<td>
<p>The length of the sequence of s0. Default: <code>L = 5</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_weight">weight</code></td>
<td>
<p>The weight of the samples, with the default value set to 1 for each sample.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_coef1">coef1</code></td>
<td>
<p>A positive value to control the sub-optimal stopping time.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_coef2">coef2</code></td>
<td>
<p>A positive value to control the overall stopping time. A small value leads to larger search range.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_eta">eta</code></td>
<td>
<p>A parameter controls the step size in the gradient descent step.
Default: <code>eta = 0.8</code>.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_max_iter">max_iter</code></td>
<td>
<p>A parameter that controls the maximum number of line search, ignored if <code>OLS</code> is employed.</p>
</td></tr>
<tr><td><code id="ADSIHT.ML_+3A_method">method</code></td>
<td>
<p>Whether <code>ols</code> (default) or <code>linesearch</code> method should be employed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> object comprising:
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>A <code class="reqn">p</code>-by-<code>length(s0)</code> matrix of coefficients, stored in column format.</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>A <code>length(s0)</code> vector of intercepts</p>
</td></tr></table>
<p>.
</p>
<table role = "presentation">
<tr><td><code>lambda</code></td>
<td>
<p>A <code>length(s0)</code> vector of threshold values</p>
</td></tr>
<tr><td><code>A_out</code></td>
<td>
<p>The selected variables given threshold value in <code>lambda</code>.</p>
</td></tr>
<tr><td><code>ic</code></td>
<td>
<p>The values of the specified criterion for each fitted model given threshold <code>lamdba</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanhang Zhang, Zhifan Li, Shixiang Liu, Jianxin Yin.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 200
p &lt;- 100
K &lt;- 4
s &lt;- 5
s0 &lt;- 2
x_list &lt;- lapply(1:K, function(x) matrix(rnorm(n*p, 0, 1), nrow = n))
vec &lt;- rep(0, K * p)
non_sparse_groups &lt;- sample(1:p, size = s, replace = FALSE)
for (group in non_sparse_groups) {
 group_indices &lt;- seq(group, K * p, by = p)
 non_zero_indices &lt;- sample(group_indices, size = s0, replace = FALSE)
 vec[non_zero_indices] &lt;- rep(2, s0)
}
y_list &lt;- lapply(1:K, function(i) return(
  y = x_list[[i]] %*% vec[((i-1)*p+1):(i*p)]+rnorm(n, 0, 0.5))
)
fit &lt;- ADSIHT.ML(x_list, y_list)
fit$A_out[, which.min(fit$ic)]
</code></pre>

<hr>
<h2 id='gen.data'>Generate simulated data</h2><span id='topic+gen.data'></span>

<h3>Description</h3>

<p>Generate simulated data for sparse group linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.data(
  n,
  m,
  d,
  s,
  s0,
  cor.type = 1,
  beta.type = 1,
  rho = 0.5,
  sigma1 = 1,
  sigma2 = 1,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen.data_+3A_n">n</code></td>
<td>
<p>The number of observations.</p>
</td></tr>
<tr><td><code id="gen.data_+3A_m">m</code></td>
<td>
<p>The number of groups of interest.</p>
</td></tr>
<tr><td><code id="gen.data_+3A_d">d</code></td>
<td>
<p>The group size of each group. Only even group structure is allowed here.</p>
</td></tr>
<tr><td><code id="gen.data_+3A_s">s</code></td>
<td>
<p>The number of important groups in the underlying regression model.</p>
</td></tr>
<tr><td><code id="gen.data_+3A_s0">s0</code></td>
<td>
<p>The number of important variables in each important group.</p>
</td></tr>
<tr><td><code id="gen.data_+3A_cor.type">cor.type</code></td>
<td>
<p>The structure of correlation.
<code>cor.type = 1</code> denotes the independence structure,
where the covariance matrix has <code class="reqn">(i,j)</code> entry equals <code class="reqn">I(i \neq j)</code>.
<code>cor.type = 2</code> denotes the exponential structure,
where the covariance matrix has <code class="reqn">(i,j)</code> entry equals <code class="reqn">rho^{|i-j|}</code>.
<code>cor.type = 3</code> denotes the constant structure,
where the non-diagonal entries of covariance
matrix are <code class="reqn">rho</code> and diagonal entries are 1.</p>
</td></tr>
<tr><td><code id="gen.data_+3A_beta.type">beta.type</code></td>
<td>
<p>The structure of coefficients.
<code>beta.type = 1</code> denotes the homogenous setup,
where each entry has the same magnitude.
<code>beta.type = 2</code> denotes the heterogeneous structure,
where the coefficients are drawn from a normal distribution.</p>
</td></tr>
<tr><td><code id="gen.data_+3A_rho">rho</code></td>
<td>
<p>A parameter used to characterize the pairwise correlation in
predictors. Default is <code>0.5</code>..</p>
</td></tr>
<tr><td><code id="gen.data_+3A_sigma1">sigma1</code></td>
<td>
<p>The value controlling the strength of the gaussian noise. A large value implies strong noise. Default <code>sigma1 = 1</code>.</p>
</td></tr>
<tr><td><code id="gen.data_+3A_sigma2">sigma2</code></td>
<td>
<p>The value controlling the strength of the coefficients. A large value implies large coefficients. Default <code>sigma2 = 1</code>.</p>
</td></tr>
<tr><td><code id="gen.data_+3A_seed">seed</code></td>
<td>
<p>random seed. Default: <code>seed = 1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> object comprising:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>Design matrix of predictors.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Response variable.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The coefficients used in the underlying regression model.</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>The group index of each variable.</p>
</td></tr>
<tr><td><code>true.group</code></td>
<td>
<p>The important groups in the sparse group linear model.</p>
</td></tr>
<tr><td><code>true.variable</code></td>
<td>
<p>The important variables in the sparse group linear model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanhang Zhang, Zhifan Li, Jianxin Yin.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate simulated data
n &lt;- 200
m &lt;- 100
d &lt;- 10
s &lt;- 5
s0 &lt;- 5
data &lt;- gen.data(n, m, d, s, s0)
str(data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
