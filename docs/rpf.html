<!DOCTYPE html><html><head><title>Help for package rpf</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rpf}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#An introduction'><p>rpf - Response Probability Functions</p></a></li>
<li><a href='#as.IFAgroup'><p>Convert an OpenMx MxModel object into an IFA group</p></a></li>
<li><a href='#bestToOmit'><p>Identify the columns with most missing data</p></a></li>
<li><a href='#ChenThissen1997'><p>Computes local dependence indices for all pairs of items</p></a></li>
<li><a href='#Class rpf.1dim'><p>The base class for 1 dimensional response probability functions.</p></a></li>
<li><a href='#Class rpf.1dim.drm'><p>Unidimensional dichotomous item models (1PL, 2PL, and 3PL).</p></a></li>
<li><a href='#Class rpf.1dim.gpcmp'><p>Unidimensional generalized partial credit monotonic polynomial.</p></a></li>
<li><a href='#Class rpf.1dim.graded'><p>The base class for 1 dimensional graded response probability functions.</p></a></li>
<li><a href='#Class rpf.1dim.grm'><p>The unidimensional graded response item model.</p></a></li>
<li><a href='#Class rpf.1dim.grmp'><p>Unidimensional graded response monotonic polynomial.</p></a></li>
<li><a href='#Class rpf.1dim.lmp'><p>Unidimensional logistic function of a monotonic polynomial.</p></a></li>
<li><a href='#Class rpf.base'><p>The base class for response probability functions.</p></a></li>
<li><a href='#Class rpf.mdim'><p>The base class for multi-dimensional response probability functions.</p></a></li>
<li><a href='#Class rpf.mdim.drm'><p>Multidimensional dichotomous item models (M1PL, M2PL, and M3PL).</p></a></li>
<li><a href='#Class rpf.mdim.graded'><p>The base class for multi-dimensional graded response probability</p>
functions.</a></li>
<li><a href='#Class rpf.mdim.grm'><p>The multidimensional graded response item model.</p></a></li>
<li><a href='#Class rpf.mdim.mcm'><p>The multiple-choice response item model (both unidimensional and</p>
multidimensional models have the same parameterization).</a></li>
<li><a href='#Class rpf.mdim.nrm'><p>The nominal response item model (both unidimensional and</p>
multidimensional models have the same parameterization).</a></li>
<li><a href='#collapseCategoricalCells'><p>Collapse small sample size categorical frequency counts</p></a></li>
<li><a href='#compressDataFrame'><p>Compress a data frame into unique rows and frequencies</p></a></li>
<li><a href='#crosstabTest'><p>Monte-Carlo test for cross-tabulation tables</p></a></li>
<li><a href='#EAPscores'><p>Compute Expected A Posteriori (EAP) scores</p></a></li>
<li><a href='#expandDataFrame'><p>Expand summary table of patterns and frequencies</p></a></li>
<li><a href='#fromFactorLoading'><p>Convert factor loadings to response function slopes</p></a></li>
<li><a href='#fromFactorThreshold'><p>Convert factor thresholds to response function intercepts</p></a></li>
<li><a href='#itemOutcomeBySumScore'><p>Produce an item outcome by observed sum-score table</p></a></li>
<li><a href='#kct'><p>Knox Cube Test dataset</p></a></li>
<li><a href='#logit'><p>Transform from [0,1] to the reals</p></a></li>
<li><a href='#LSAT6'><p>Description of LSAT6 data</p></a></li>
<li><a href='#LSAT7'><p>Description of LSAT7 data</p></a></li>
<li><a href='#multinomialFit'><p>Multinomial fit test</p></a></li>
<li><a href='#observedSumScore'><p>Compute the observed sum-score</p></a></li>
<li><a href='#omitItems'><p>Omit the given items</p></a></li>
<li><a href='#omitMostMissing'><p>Omit items with the most missing data</p></a></li>
<li><a href='#orderCompletely'><p>Order a data.frame by missingness and all columns</p></a></li>
<li><a href='#ordinal.gamma'><p>Compute the ordinal gamma association statistic</p></a></li>
<li><a href='#ptw2011.gof.test'><p>Compute the P value that the observed and expected tables come from the same distribution</p></a></li>
<li><a href='#read.flexmirt'><p>Read a flexMIRT PRM file</p></a></li>
<li><a href='#rpf.1dim.fit'><p>Calculate item and person Rasch fit statistics</p></a></li>
<li><a href='#rpf.1dim.moment'><p>Calculate cell central moments</p></a></li>
<li><a href='#rpf.1dim.residual'><p>Calculate residuals</p></a></li>
<li><a href='#rpf.1dim.stdresidual'><p>Calculate standardized residuals</p></a></li>
<li><a href='#rpf.dLL'><p>Item parameter derivatives</p></a></li>
<li><a href='#rpf.drm'><p>Create a dichotomous response model</p></a></li>
<li><a href='#rpf.dTheta'><p>Item derivatives with respect to the location in the latent space</p></a></li>
<li><a href='#rpf.gpcmp'><p>Create monotonic polynomial generalized partial credit (GPC-MP) model</p></a></li>
<li><a href='#rpf.grm'><p>Create a graded response model</p></a></li>
<li><a href='#rpf.grmp'><p>Create monotonic polynomial graded response (GR-MP) model</p></a></li>
<li><a href='#rpf.id_of'><p>Convert an rpf item model name to an ID</p></a></li>
<li><a href='#rpf.info'><p>Map an item model, item parameters, and person trait score into a</p>
information vector</a></li>
<li><a href='#rpf.lmp'><p>Create logistic function of a monotonic polynomial (LMP) model</p></a></li>
<li><a href='#rpf.logprob'><p>Map an item model, item parameters, and person trait score into a</p>
probability vector</a></li>
<li><a href='#rpf.mcm'><p>Create a multiple-choice response model</p></a></li>
<li><a href='#rpf.mean.info'><p>Find the point where an item provides mean maximum information</p></a></li>
<li><a href='#rpf.mean.info1'><p>Find the point where an item provides mean maximum information</p></a></li>
<li><a href='#rpf.modify'><p>Create a similar item specification with the given number of factors</p></a></li>
<li><a href='#rpf.nrm'><p>Create a nominal response model</p></a></li>
<li><a href='#rpf.numParam'><p>Length of the item parameter vector</p></a></li>
<li><a href='#rpf.numSpec'><p>Length of the item model vector</p></a></li>
<li><a href='#rpf.ogive'><p>The ogive constant</p></a></li>
<li><a href='#rpf.paramInfo'><p>Retrieve a description of the given parameter</p></a></li>
<li><a href='#rpf.prob'><p>Map an item model, item parameters, and person trait score into a</p>
probability vector</a></li>
<li><a href='#rpf.rescale'><p>Rescale item parameters</p></a></li>
<li><a href='#rpf.rparam'><p>Generates item parameters</p></a></li>
<li><a href='#rpf.sample'><p>Randomly sample response patterns given a list of items</p></a></li>
<li><a href='#science'><p>Liking for Science dataset</p></a></li>
<li><a href='#SitemFit'><p>Compute the S fit statistic for a set of items</p></a></li>
<li><a href='#SitemFit1'><p>Compute the S fit statistic for 1 item</p></a></li>
<li><a href='#stripData'><p>Strip data and scores from an IFA group</p></a></li>
<li><a href='#sumScoreEAP'><p>Compute the sum-score EAP table</p></a></li>
<li><a href='#sumScoreEAPTest'><p>Conduct the sum-score EAP distribution test</p></a></li>
<li><a href='#tabulateRows'><p>Tabulate data.frame rows</p></a></li>
<li><a href='#toFactorLoading'><p>Convert response function slopes to factor loadings</p></a></li>
<li><a href='#toFactorThreshold'><p>Convert response function intercepts to factor thresholds</p></a></li>
<li><a href='#write.flexmirt'><p>Write a flexMIRT PRM file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Response Probability Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.14</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-21</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joshua Pritikin &lt;jpritikin@pobox.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Factor out logic
    and math common to Item Factor Analysis fitting, diagnostics, and
    analysis. It is envisioned as core support code suitable for more
    specialized IRT packages to build upon. Complete access to optimized C
    functions are made available with R_RegisterCCallable().
    This software is described in Pritikin &amp; Falk (2020) &lt;<a href="https://doi.org/10.1177%2F0146621620929431">doi:10.1177/0146621620929431</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jpritikin/rpf">https://github.com/jpritikin/rpf</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, parallel, R (&ge; 2.14.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.2), mvtnorm, lifecycle</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, roxygen2, ggplot2, reshape2, gridExtra, numDeriv,
knitr, mirt, markdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>lifecycle</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Collate:</td>
<td>'init.R' 'classes.R' 'fit.R' 'drm.R' 'nrm.R' 'mcm.R' 'grm.R'
'LSAT.R' 'sample.R' 'dataframe.R' 'diagnose.R' 'science.R'
'kct.R' 'openmx.R' 'flexmirt.R' 'util.R' 'lmp.R' 'grmp.R'
'gpcmp.R' 'RcppExports.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 18:49:00 UTC; joshua</td>
</tr>
<tr>
<td>Author:</td>
<td>Joshua Pritikin [cre, aut],
  Jonathan Weeks [ctb],
  Li Cai [ctb],
  Carrie Houts [ctb],
  Phil Chalmers [ctb],
  Michael D. Hunter [ctb],
  Carl F. Falk [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-21 23:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='An+20introduction'>rpf - Response Probability Functions</h2><span id='topic+An+20introduction'></span><span id='topic+rpf-package'></span>

<h3>Description</h3>

<p>Factor out logic and math common
to Item Factor Analysis fitting, diagnostics, and analysis.  It is
envisioned as core support code suitable for more specialized IFA
packages to build upon.
</p>


<h3>Details</h3>

<p>This package provides optimized, low-level functions to map
parameters to response probabilities for dichotomous (1PL, 2PL and
3PL) <code><a href="#topic+rpf.drm">rpf.drm</a></code> and polytomous (graded response
<code><a href="#topic+rpf.grm">rpf.grm</a></code>, partial credit/generalized partial credit
(via the nominal model), and nominal <code><a href="#topic+rpf.nrm">rpf.nrm</a></code> items.
</p>
<p>Item model parameters are passed around as a numeric vector. A 1D
matrix is also acceptable. Regardless of model, parameters are
always ordered as follows: discrimination/slope (&quot;a&quot;),
difficulty/intercept (&quot;b&quot;), and pseudo guessing/upper-bound (&quot;g&quot;/&quot;u&quot;). If
person ability ranges from negative to positive then
probabilities are output from incorrect to correct. That is, a low
ability person (e.g., ability = -2) will be more likely to get an
item incorrect than correct. For example, a dichotomous model that
returns [.25, .75] indicates a probability of .25 for incorrect
and .75 for correct.  A polytomous model will have the most
incorrect probability at index 1 and the most correct probability
at the maximum index.
</p>
<p>All models are always in the logistic metric. To obtain normal
ogive discrimination parameters, divide slope parameters by
<code><a href="#topic+rpf.ogive">rpf.ogive</a></code>. Item models are estimated in
slope-intercept form. Input/output matrices arranged in the way
most convenient for low-level processing in C. The maximum
absolute logit is 35 because f(x) := 1-exp(x) loses accuracy around f(-35)
and equals 1 at f(-38) due to the limited accuracy of double
precision floating point.
</p>
<p>This package could also accrete functions to support plotting (but
not the actual plot functions).
</p>


<h3>References</h3>

<p>Pritikin, J. N., Hunter, M. D., &amp; Boker, S. M.
(2015). Modular open-source software for Item Factor Analysis.
Educational and Psychological Measurement, 75(3), 458-474
</p>
<p>Thissen, D. and Steinberg, L. (1986). A taxonomy of
item response models. <em>Psychometrika 51</em>(4), 567-577.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+rpf.rparam">rpf.rparam</a></code> to create item parameters.
</p>

<hr>
<h2 id='as.IFAgroup'>Convert an OpenMx MxModel object into an IFA group</h2><span id='topic+as.IFAgroup'></span>

<h3>Description</h3>

<p>When &ldquo;minItemsPerScore&rdquo; is passed, EAP scores will be computed
from the data and stored. Scores are required for some diagnostic
tests. See discussion of &ldquo;minItemsPerScore&rdquo; in <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.IFAgroup(
  mxModel,
  data = NULL,
  container = NULL,
  ...,
  minItemsPerScore = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.IFAgroup_+3A_mxmodel">mxModel</code></td>
<td>
<p>MxModel object</p>
</td></tr>
<tr><td><code id="as.IFAgroup_+3A_data">data</code></td>
<td>
<p>observed data (otherwise the data will be taken from the mxModel)</p>
</td></tr>
<tr><td><code id="as.IFAgroup_+3A_container">container</code></td>
<td>
<p>an MxModel in which to search for the latent distribution matrices</p>
</td></tr>
<tr><td><code id="as.IFAgroup_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="as.IFAgroup_+3A_minitemsperscore">minItemsPerScore</code></td>
<td>
<p>minimum number of items required to compute a score (also see description)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a groups with item parameters and latent distribution
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p><a href="https://cran.r-project.org/package=ifaTools">ifaTools</a>
</p>

<hr>
<h2 id='bestToOmit'>Identify the columns with most missing data</h2><span id='topic+bestToOmit'></span>

<h3>Description</h3>

<p>If a reference column is given then only rows that are not missing
on the reference column are considered. Otherwise all rows are
considered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bestToOmit(grp, omit, ref = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bestToOmit_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="bestToOmit_+3A_omit">omit</code></td>
<td>
<p>the maximum number of items to omit</p>
</td></tr>
<tr><td><code id="bestToOmit_+3A_ref">ref</code></td>
<td>
<p>the reference column (optional)</p>
</td></tr>
</table>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p>Other scoring: 
<code><a href="#topic+EAPscores">EAPscores</a>()</code>,
<code><a href="#topic+itemOutcomeBySumScore">itemOutcomeBySumScore</a>()</code>,
<code><a href="#topic+observedSumScore">observedSumScore</a>()</code>,
<code><a href="#topic+omitItems">omitItems</a>()</code>,
<code><a href="#topic+omitMostMissing">omitMostMissing</a>()</code>,
<code><a href="#topic+sumScoreEAP">sumScoreEAP</a>()</code>
</p>

<hr>
<h2 id='ChenThissen1997'>Computes local dependence indices for all pairs of items</h2><span id='topic+ChenThissen1997'></span><span id='topic+chen.thissen.1997'></span>

<h3>Description</h3>

<p>Item Factor Analysis makes two assumptions: (1) that the latent
distribution is reasonably approximated by the multivariate Normal
and (2) that items are conditionally independent. This test
examines the second assumption. The presence of locally dependent
items can inflate the precision of estimates causing a test to
seem more accurate than it really is.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ChenThissen1997(
  grp,
  ...,
  data = NULL,
  inames = NULL,
  qwidth = 6,
  qpoints = 49,
  method = "pearson",
  .twotier = TRUE,
  .parallel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ChenThissen1997_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="ChenThissen1997_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="ChenThissen1997_+3A_data">data</code></td>
<td>
<p>data <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="ChenThissen1997_+3A_inames">inames</code></td>
<td>
<p>a subset of items to examine</p>
</td></tr>
<tr><td><code id="ChenThissen1997_+3A_qwidth">qwidth</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="ChenThissen1997_+3A_qpoints">qpoints</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="ChenThissen1997_+3A_method">method</code></td>
<td>
<p>method to use to calculate P values. The default is the
Pearson X^2 statistic. Use &quot;lr&quot; for the similar likelihood ratio statistic.</p>
</td></tr>
<tr><td><code id="ChenThissen1997_+3A_.twotier">.twotier</code></td>
<td>
<p>whether to enable the two-tier optimization</p>
</td></tr>
<tr><td><code id="ChenThissen1997_+3A_.parallel">.parallel</code></td>
<td>
<p>whether to take advantage of multiple CPUs (default TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Statically significant entries suggest that the item pair has
local dependence. Since log(.01)=-4.6, an absolute magitude of 5
is a reasonable cut-off. Positive entries indicate that the two
item residuals are more correlated than expected. These items may share an
unaccounted for latent dimension. Consider a redesign of the items
or the use of testlets for scoring. Negative entries indicate that
the two item residuals are less correlated than expected.
</p>


<h3>Value</h3>

<p>a list with raw, pval and detail. The pval matrix is a
lower triangular matrix of log P values with the sign
determined by relative association between the observed and
expected tables (see <code><a href="#topic+ordinal.gamma">ordinal.gamma</a></code>)
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>References</h3>

<p>Chen, W.-H. &amp; Thissen, D. (1997). Local dependence
indexes for item pairs using Item Response Theory. <em>Journal
of Educational and Behavioral Statistics, 22</em>(3), 265-289.
</p>
<p>Thissen, D., Steinberg, L., &amp; Mooney, J. A. (1989). Trace lines for testlets: A use
of multiple-categorical-response models. <em>Journal of Educational Measurement,
26</em> (3), 247&ndash;260.
</p>
<p>Wainer, H. &amp; Kiely, G. L. (1987). Item clusters and computerized
adaptive testing: A case for testlets.  <em>Journal of
Educational measurement, 24</em>(3), 185&ndash;201.
</p>


<h3>See Also</h3>

<p><a href="https://github.com/jpritikin/ifaTools">ifaTools</a>
</p>
<p>Other diagnostic: 
<code><a href="#topic+SitemFit1">SitemFit1</a>()</code>,
<code><a href="#topic+SitemFit">SitemFit</a>()</code>,
<code><a href="#topic+multinomialFit">multinomialFit</a>()</code>,
<code><a href="#topic+rpf.1dim.fit">rpf.1dim.fit</a>()</code>,
<code><a href="#topic+sumScoreEAPTest">sumScoreEAPTest</a>()</code>
</p>

<hr>
<h2 id='Class+20rpf.1dim'>The base class for 1 dimensional response probability functions.</h2><span id='topic+Class+20rpf.1dim'></span><span id='topic+rpf.1dim-class'></span>

<h3>Description</h3>

<p>The base class for 1 dimensional response probability functions.
</p>

<hr>
<h2 id='Class+20rpf.1dim.drm'>Unidimensional dichotomous item models (1PL, 2PL, and 3PL).</h2><span id='topic+Class+20rpf.1dim.drm'></span><span id='topic+rpf.1dim.drm-class'></span>

<h3>Description</h3>

<p>Unidimensional dichotomous item models (1PL, 2PL, and 3PL).
</p>

<hr>
<h2 id='Class+20rpf.1dim.gpcmp'>Unidimensional generalized partial credit monotonic polynomial.</h2><span id='topic+Class+20rpf.1dim.gpcmp'></span><span id='topic+rpf.1dim.gpcmp-class'></span>

<h3>Description</h3>

<p>Unidimensional generalized partial credit monotonic polynomial.
</p>

<hr>
<h2 id='Class+20rpf.1dim.graded'>The base class for 1 dimensional graded response probability functions.</h2><span id='topic+Class+20rpf.1dim.graded'></span><span id='topic+rpf.1dim.graded-class'></span>

<h3>Description</h3>

<p>This class contains methods common to both the generalized partial
credit model and the graded response model.
</p>

<hr>
<h2 id='Class+20rpf.1dim.grm'>The unidimensional graded response item model.</h2><span id='topic+Class+20rpf.1dim.grm'></span><span id='topic+rpf.1dim.grm-class'></span>

<h3>Description</h3>

<p>The unidimensional graded response item model.
</p>

<hr>
<h2 id='Class+20rpf.1dim.grmp'>Unidimensional graded response monotonic polynomial.</h2><span id='topic+Class+20rpf.1dim.grmp'></span><span id='topic+rpf.1dim.grmp-class'></span>

<h3>Description</h3>

<p>Unidimensional graded response monotonic polynomial.
</p>

<hr>
<h2 id='Class+20rpf.1dim.lmp'>Unidimensional logistic function of a monotonic polynomial.</h2><span id='topic+Class+20rpf.1dim.lmp'></span><span id='topic+rpf.1dim.lmp-class'></span>

<h3>Description</h3>

<p>Unidimensional logistic function of a monotonic polynomial.
</p>

<hr>
<h2 id='Class+20rpf.base'>The base class for response probability functions.</h2><span id='topic+Class+20rpf.base'></span><span id='topic+rpf.base-class'></span><span id='topic++24+2Crpf.base-method'></span><span id='topic++24+3C-+2Crpf.base-method'></span>

<h3>Description</h3>

<p>Item specifications should not be modified after creation.
</p>

<hr>
<h2 id='Class+20rpf.mdim'>The base class for multi-dimensional response probability functions.</h2><span id='topic+Class+20rpf.mdim'></span><span id='topic+rpf.mdim-class'></span>

<h3>Description</h3>

<p>The base class for multi-dimensional response probability functions.
</p>

<hr>
<h2 id='Class+20rpf.mdim.drm'>Multidimensional dichotomous item models (M1PL, M2PL, and M3PL).</h2><span id='topic+Class+20rpf.mdim.drm'></span><span id='topic+rpf.mdim.drm-class'></span>

<h3>Description</h3>

<p>Multidimensional dichotomous item models (M1PL, M2PL, and M3PL).
</p>

<hr>
<h2 id='Class+20rpf.mdim.graded'>The base class for multi-dimensional graded response probability
functions.</h2><span id='topic+Class+20rpf.mdim.graded'></span><span id='topic+rpf.mdim.graded-class'></span>

<h3>Description</h3>

<p>This class contains methods common to both the generalized partial
credit model and the graded response model.
</p>

<hr>
<h2 id='Class+20rpf.mdim.grm'>The multidimensional graded response item model.</h2><span id='topic+Class+20rpf.mdim.grm'></span><span id='topic+rpf.mdim.grm-class'></span>

<h3>Description</h3>

<p>The multidimensional graded response item model.
</p>

<hr>
<h2 id='Class+20rpf.mdim.mcm'>The multiple-choice response item model (both unidimensional and
multidimensional models have the same parameterization).</h2><span id='topic+Class+20rpf.mdim.mcm'></span><span id='topic+rpf.mdim.mcm-class'></span>

<h3>Description</h3>

<p>The multiple-choice response item model (both unidimensional and
multidimensional models have the same parameterization).
</p>

<hr>
<h2 id='Class+20rpf.mdim.nrm'>The nominal response item model (both unidimensional and
multidimensional models have the same parameterization).</h2><span id='topic+Class+20rpf.mdim.nrm'></span><span id='topic+rpf.mdim.nrm-class'></span>

<h3>Description</h3>

<p>The nominal response item model (both unidimensional and
multidimensional models have the same parameterization).
</p>

<hr>
<h2 id='collapseCategoricalCells'>Collapse small sample size categorical frequency counts</h2><span id='topic+collapseCategoricalCells'></span>

<h3>Description</h3>

<p>Collapse small sample size categorical frequency counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collapseCategoricalCells(observed, expected, minExpected = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collapseCategoricalCells_+3A_observed">observed</code></td>
<td>
<p>the observed frequency table</p>
</td></tr>
<tr><td><code id="collapseCategoricalCells_+3A_expected">expected</code></td>
<td>
<p>the expected frequency table</p>
</td></tr>
<tr><td><code id="collapseCategoricalCells_+3A_minexpected">minExpected</code></td>
<td>
<p>the minimum expected cell frequency
</p>
<p>Pearson's X^2 test requires some minimum frequency per cell to
avoid an inflated false positive rate. This function will merge
cells with the lowest frequency counts until all the counts are
above the minimum threshold. Cells that have been merged are filled
with NAs. The resulting tables and number of merged cells is
returned.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>O = matrix(c(7,31,42,20,0), 1,5)
E = matrix(c(3,39,50,8,0), 1,5)
collapseCategoricalCells(O,E,9)
</code></pre>

<hr>
<h2 id='compressDataFrame'>Compress a data frame into unique rows and frequencies</h2><span id='topic+compressDataFrame'></span>

<h3>Description</h3>

<p>Compress a data frame into unique rows and frequency counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compressDataFrame(tabdata, freqColName = "freq", .asNumeric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compressDataFrame_+3A_tabdata">tabdata</code></td>
<td>
<p>An object of class <code>data.frame</code></p>
</td></tr>
<tr><td><code id="compressDataFrame_+3A_freqcolname">freqColName</code></td>
<td>
<p>Column name to contain the frequencies</p>
</td></tr>
<tr><td><code id="compressDataFrame_+3A_.asnumeric">.asNumeric</code></td>
<td>
<p>logical. Whether to cast the frequencies to the numeric type</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a compressed data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- as.data.frame(matrix(c(sample.int(2, 30, replace=TRUE)), 10, 3))
compressDataFrame(df)
</code></pre>

<hr>
<h2 id='crosstabTest'>Monte-Carlo test for cross-tabulation tables</h2><span id='topic+crosstabTest'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This is for developers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosstabTest(ob, ex, trials)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crosstabTest_+3A_ob">ob</code></td>
<td>
<p>observed table</p>
</td></tr>
<tr><td><code id="crosstabTest_+3A_ex">ex</code></td>
<td>
<p>expected table</p>
</td></tr>
<tr><td><code id="crosstabTest_+3A_trials">trials</code></td>
<td>
<p>number of Monte-Carlo trials</p>
</td></tr>
</table>

<hr>
<h2 id='EAPscores'>Compute Expected A Posteriori (EAP) scores</h2><span id='topic+EAPscores'></span>

<h3>Description</h3>

<p>If you have missing data then you must specify
<code>minItemsPerScore</code>.  This option will set scores to NA when
there are too few items to make an accurate score estimate.  If
you are using the scores as point estimates without considering
the standard error then you should set <code>minItemsPerScore</code> as
high as you can tolerate. This will increase the amount of missing
data but scores will be more accurate. If you are carefully
considering the standard errors of the scores then you can set
<code>minItemsPerScore</code> to 1. This will mimic the behavior of most
other IFA software wherein scores are estimated if there is at
least 1 non-NA item for the score. However, it may make more sense
to set <code>minItemsPerScore</code> to 0. When set to 0, all NA rows
are scored to the prior distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EAPscores(grp, ..., compressed = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EAPscores_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="EAPscores_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="EAPscores_+3A_compressed">compressed</code></td>
<td>
<p>output one score per observed data row even when freqColumn is set (default FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Output is not affected by the presence of a <code>weightColumn</code>.
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p>Other scoring: 
<code><a href="#topic+bestToOmit">bestToOmit</a>()</code>,
<code><a href="#topic+itemOutcomeBySumScore">itemOutcomeBySumScore</a>()</code>,
<code><a href="#topic+observedSumScore">observedSumScore</a>()</code>,
<code><a href="#topic+omitItems">omitItems</a>()</code>,
<code><a href="#topic+omitMostMissing">omitMostMissing</a>()</code>,
<code><a href="#topic+sumScoreEAP">sumScoreEAP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- list()
spec[1:3] &lt;- list(rpf.grm(outcomes=3))
param &lt;- sapply(spec, rpf.rparam)
data &lt;- rpf.sample(5, spec, param)
colnames(param) &lt;- colnames(data)
grp &lt;- list(spec=spec, param=param, data=data, minItemsPerScore=1L)
EAPscores(grp)
</code></pre>

<hr>
<h2 id='expandDataFrame'>Expand summary table of patterns and frequencies</h2><span id='topic+expandDataFrame'></span>

<h3>Description</h3>

<p>Expand a summary table of unique response patterns to a full sized
data-set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expandDataFrame(tabdata, freqName = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expandDataFrame_+3A_tabdata">tabdata</code></td>
<td>
<p>An object of class <code>data.frame</code> with the unique response patterns and the number of frequencies</p>
</td></tr>
<tr><td><code id="expandDataFrame_+3A_freqname">freqName</code></td>
<td>
<p>Column name containing the frequencies</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame with all the response patterns
</p>


<h3>Author(s)</h3>

<p>Based on code by Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LSAT7)
expandDataFrame(LSAT7, freqName="freq")
</code></pre>

<hr>
<h2 id='fromFactorLoading'>Convert factor loadings to response function slopes</h2><span id='topic+fromFactorLoading'></span>

<h3>Description</h3>

<p>Convert factor loadings to response function slopes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fromFactorLoading(loading, ogive = rpf.ogive)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fromFactorLoading_+3A_loading">loading</code></td>
<td>
<p>a matrix with items in the rows and factors in the columns</p>
</td></tr>
<tr><td><code id="fromFactorLoading_+3A_ogive">ogive</code></td>
<td>
<p>the ogive constant (default <a href="#topic+rpf.ogive">rpf.ogive</a>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a slope matrix with items in the columns and factors in the rows
</p>


<h3>See Also</h3>

<p>Other factor model equivalence: 
<code><a href="#topic+fromFactorThreshold">fromFactorThreshold</a>()</code>,
<code><a href="#topic+toFactorLoading">toFactorLoading</a>()</code>,
<code><a href="#topic+toFactorThreshold">toFactorThreshold</a>()</code>
</p>

<hr>
<h2 id='fromFactorThreshold'>Convert factor thresholds to response function intercepts</h2><span id='topic+fromFactorThreshold'></span>

<h3>Description</h3>

<p>Convert factor thresholds to response function intercepts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fromFactorThreshold(threshold, loading, ogive = rpf.ogive)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fromFactorThreshold_+3A_threshold">threshold</code></td>
<td>
<p>a matrix with items in the columns and thresholds in the rows</p>
</td></tr>
<tr><td><code id="fromFactorThreshold_+3A_loading">loading</code></td>
<td>
<p>a matrix with items in the rows and factors in the columns</p>
</td></tr>
<tr><td><code id="fromFactorThreshold_+3A_ogive">ogive</code></td>
<td>
<p>the ogive constant (default <a href="#topic+rpf.ogive">rpf.ogive</a>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an item intercept matrix with items in the columns and intercepts in the rows
</p>


<h3>See Also</h3>

<p>Other factor model equivalence: 
<code><a href="#topic+fromFactorLoading">fromFactorLoading</a>()</code>,
<code><a href="#topic+toFactorLoading">toFactorLoading</a>()</code>,
<code><a href="#topic+toFactorThreshold">toFactorThreshold</a>()</code>
</p>

<hr>
<h2 id='itemOutcomeBySumScore'>Produce an item outcome by observed sum-score table</h2><span id='topic+itemOutcomeBySumScore'></span>

<h3>Description</h3>

<p>Produce an item outcome by observed sum-score table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itemOutcomeBySumScore(grp, mask, interest)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="itemOutcomeBySumScore_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="itemOutcomeBySumScore_+3A_mask">mask</code></td>
<td>
<p>a vector of logicals indicating which items to include</p>
</td></tr>
<tr><td><code id="itemOutcomeBySumScore_+3A_interest">interest</code></td>
<td>
<p>index or name of the item of interest</p>
</td></tr>
</table>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p>Other scoring: 
<code><a href="#topic+EAPscores">EAPscores</a>()</code>,
<code><a href="#topic+bestToOmit">bestToOmit</a>()</code>,
<code><a href="#topic+observedSumScore">observedSumScore</a>()</code>,
<code><a href="#topic+omitItems">omitItems</a>()</code>,
<code><a href="#topic+omitMostMissing">omitMostMissing</a>()</code>,
<code><a href="#topic+sumScoreEAP">sumScoreEAP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
spec &lt;- list()
spec[1:3] &lt;- rpf.grm(outcomes=3)
param &lt;- sapply(spec, rpf.rparam)
data &lt;- rpf.sample(5, spec, param)
colnames(param) &lt;- colnames(data)
grp &lt;- list(spec=spec, param=param, data=data)
itemOutcomeBySumScore(grp, c(FALSE,TRUE,TRUE), 1L)
</code></pre>

<hr>
<h2 id='kct'>Knox Cube Test dataset</h2><span id='topic+kct'></span><span id='topic+kct.items'></span><span id='topic+kct.people'></span>

<h3>Description</h3>

<p>These data from Wright &amp; Stone (1979, p. 31) were fit with
Winsteps 3.73 using a 1PL model (slope fixed to 1).
</p>


<h3>References</h3>

<p>Wright, B. D. &amp; Stone, M. H. (1979). <em>Best Test Design: Rasch Measurement.</em> Univ of Chicago Social Research.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kct)
</code></pre>

<hr>
<h2 id='logit'>Transform from [0,1] to the reals</h2><span id='topic+logit'></span>

<h3>Description</h3>

<p>The logit function is a standard transformation from [0,1] (such
as a probability) to the real number line. This function is
exactly the same as qlogis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logit(p, location = 0, scale = 1, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logit_+3A_p">p</code></td>
<td>
<p>a number between 0 and 1</p>
</td></tr>
<tr><td><code id="logit_+3A_location">location</code></td>
<td>
<p>see qlogis</p>
</td></tr>
<tr><td><code id="logit_+3A_scale">scale</code></td>
<td>
<p>see qlogis</p>
</td></tr>
<tr><td><code id="logit_+3A_lower.tail">lower.tail</code></td>
<td>
<p>see qlogis</p>
</td></tr>
<tr><td><code id="logit_+3A_log.p">log.p</code></td>
<td>
<p>see qlogis</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>qlogis, plogis
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logit(.5)  # 0
logit(.25) # -1.098
logit(0)   # -Inf
</code></pre>

<hr>
<h2 id='LSAT6'>Description of LSAT6 data</h2><span id='topic+LSAT6'></span>

<h3>Description</h3>

<p>Data from Thissen (1982); contains 5 dichotomously scored
items obtained from the Law School Admissions Test, section 6.
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Thissen, D. (1982). Marginal maximum likelihood estimation for the one-parameter logistic model.
<em>Psychometrika, 47</em>, 175-186.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LSAT6)
</code></pre>

<hr>
<h2 id='LSAT7'>Description of LSAT7 data</h2><span id='topic+LSAT7'></span>

<h3>Description</h3>

<p>Data from Bock &amp; Lieberman (1970); contains 5 dichotomously scored
items obtained from the Law School Admissions Test, section 7.
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Bock, R. D., &amp; Lieberman, M. (1970). Fitting a response model for <em>n</em>
dichotomously scored items. <em>Psychometrika, 35</em>(2), 179-197.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LSAT7)
</code></pre>

<hr>
<h2 id='multinomialFit'>Multinomial fit test</h2><span id='topic+multinomialFit'></span>

<h3>Description</h3>

<p>For degrees of freedom, we use the number of observed statistics
(incorrect) instead of the number of possible response patterns
(correct) (see Bock, Giibons, &amp; Muraki, 1998, p. 265). This is not
a huge problem because this test is becomes poorly calibrated when
the multinomial table is sparse. For more accurate p-values, you
can conduct a Monte-Carlo simulation study (see examples).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multinomialFit(
  grp,
  independenceGrp,
  ...,
  method = "lr",
  log = TRUE,
  .twotier = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multinomialFit_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="multinomialFit_+3A_independencegrp">independenceGrp</code></td>
<td>
<p>the independence group</p>
</td></tr>
<tr><td><code id="multinomialFit_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="multinomialFit_+3A_method">method</code></td>
<td>
<p>lr (default) or pearson</p>
</td></tr>
<tr><td><code id="multinomialFit_+3A_log">log</code></td>
<td>
<p>whether to report p-value in log units</p>
</td></tr>
<tr><td><code id="multinomialFit_+3A_.twotier">.twotier</code></td>
<td>
<p>whether to use the two-tier optimization (default TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rows with missing data are ignored.
</p>
<p>The full information test is described in Bartholomew &amp; Tzamourani
(1999, Section 3).
</p>
<p>For CFI and TLI, you must provide an <code>independenceGrp</code>.
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>References</h3>

<p>Bartholomew, D. J., &amp; Tzamourani, P. (1999). The
goodness-of-fit of latent trait models in attitude
measurement. <em>Sociological Methods and Research, 27</em>(4), 525-546.
</p>
<p>Bock, R. D., Gibbons, R., &amp; Muraki, E. (1988). Full-information
item factor analysis. <em>Applied Psychological Measurement, 12</em>(3),
261-280.
</p>


<h3>See Also</h3>

<p>Other diagnostic: 
<code><a href="#topic+ChenThissen1997">ChenThissen1997</a>()</code>,
<code><a href="#topic+SitemFit1">SitemFit1</a>()</code>,
<code><a href="#topic+SitemFit">SitemFit</a>()</code>,
<code><a href="#topic+rpf.1dim.fit">rpf.1dim.fit</a>()</code>,
<code><a href="#topic+sumScoreEAPTest">sumScoreEAPTest</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create an example IFA group
grp &lt;- list(spec=list())
grp$spec[1:10] &lt;- rpf.grm()
grp$param &lt;- sapply(grp$spec, rpf.rparam)
colnames(grp$param) &lt;- paste("i", 1:10, sep="")
grp$mean &lt;- 0
grp$cov &lt;- diag(1)
grp$uniqueFree &lt;- sum(grp$param != 0)
grp$data &lt;- rpf.sample(1000, grp=grp)

# Monte-Carlo simulation study
mcReps &lt;- 3    # increase this to 10,000 or so
stat &lt;- rep(NA, mcReps)
for (rx in 1:mcReps) {
   t1 &lt;- grp
   t1$data &lt;- rpf.sample(grp=grp)
   stat[rx] &lt;- multinomialFit(t1)$statistic
}
sum(multinomialFit(grp)$statistic &gt; stat)/mcReps   # better p-value
</code></pre>

<hr>
<h2 id='observedSumScore'>Compute the observed sum-score</h2><span id='topic+observedSumScore'></span>

<h3>Description</h3>

<p>When <code>summary=TRUE</code>, tabulation uses row frequency
multiplied by row weight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observedSumScore(grp, ..., mask, summary = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observedSumScore_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="observedSumScore_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="observedSumScore_+3A_mask">mask</code></td>
<td>
<p>a vector of logicals indicating which items to include</p>
</td></tr>
<tr><td><code id="observedSumScore_+3A_summary">summary</code></td>
<td>
<p>whether to return a summary (default) or per-row scores</p>
</td></tr>
</table>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p>Other scoring: 
<code><a href="#topic+EAPscores">EAPscores</a>()</code>,
<code><a href="#topic+bestToOmit">bestToOmit</a>()</code>,
<code><a href="#topic+itemOutcomeBySumScore">itemOutcomeBySumScore</a>()</code>,
<code><a href="#topic+omitItems">omitItems</a>()</code>,
<code><a href="#topic+omitMostMissing">omitMostMissing</a>()</code>,
<code><a href="#topic+sumScoreEAP">sumScoreEAP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- list()
spec[1:3] &lt;- rpf.grm(outcomes=3)
param &lt;- sapply(spec, rpf.rparam)
data &lt;- rpf.sample(5, spec, param)
colnames(param) &lt;- colnames(data)
grp &lt;- list(spec=spec, param=param, data=data)
observedSumScore(grp)
</code></pre>

<hr>
<h2 id='omitItems'>Omit the given items</h2><span id='topic+omitItems'></span>

<h3>Description</h3>

<p>Omit the given items
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omitItems(grp, excol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="omitItems_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="omitItems_+3A_excol">excol</code></td>
<td>
<p>vector of column names to omit</p>
</td></tr>
</table>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p>Other scoring: 
<code><a href="#topic+EAPscores">EAPscores</a>()</code>,
<code><a href="#topic+bestToOmit">bestToOmit</a>()</code>,
<code><a href="#topic+itemOutcomeBySumScore">itemOutcomeBySumScore</a>()</code>,
<code><a href="#topic+observedSumScore">observedSumScore</a>()</code>,
<code><a href="#topic+omitMostMissing">omitMostMissing</a>()</code>,
<code><a href="#topic+sumScoreEAP">sumScoreEAP</a>()</code>
</p>

<hr>
<h2 id='omitMostMissing'>Omit items with the most missing data</h2><span id='topic+omitMostMissing'></span>

<h3>Description</h3>

<p>Items with no missing data are never omitted, regardless of the
number of items requested.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omitMostMissing(grp, omit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="omitMostMissing_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="omitMostMissing_+3A_omit">omit</code></td>
<td>
<p>the maximum number of items to omit</p>
</td></tr>
</table>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p>Other scoring: 
<code><a href="#topic+EAPscores">EAPscores</a>()</code>,
<code><a href="#topic+bestToOmit">bestToOmit</a>()</code>,
<code><a href="#topic+itemOutcomeBySumScore">itemOutcomeBySumScore</a>()</code>,
<code><a href="#topic+observedSumScore">observedSumScore</a>()</code>,
<code><a href="#topic+omitItems">omitItems</a>()</code>,
<code><a href="#topic+sumScoreEAP">sumScoreEAP</a>()</code>
</p>

<hr>
<h2 id='orderCompletely'>Order a data.frame by missingness and all columns</h2><span id='topic+orderCompletely'></span>

<h3>Description</h3>

<p>Completely order all rows in a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orderCompletely(observed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="orderCompletely_+3A_observed">observed</code></td>
<td>
<p>a data.frame holding ordered factors in every column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the sorted order of the rows
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- as.data.frame(matrix(c(sample.int(2, 30, replace=TRUE)), 10, 3))
mask &lt;- matrix(c(sample.int(3, 30, replace=TRUE)), 10, 3) == 1
df[mask] &lt;- NA
df[orderCompletely(df),]
</code></pre>

<hr>
<h2 id='ordinal.gamma'>Compute the ordinal gamma association statistic</h2><span id='topic+ordinal.gamma'></span>

<h3>Description</h3>

<p>Compute the ordinal gamma association statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordinal.gamma(mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ordinal.gamma_+3A_mat">mat</code></td>
<td>
<p>a cross tabulation matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>Agresti, A. (1990). Categorical data analysis. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example data from Agresti (1990, p. 21)
jobsat &lt;- matrix(c(20,22,13,7,24,38,28,18,80,104,81,54,82,125,113,92), nrow=4, ncol=4)
ordinal.gamma(jobsat)
</code></pre>

<hr>
<h2 id='ptw2011.gof.test'>Compute the P value that the observed and expected tables come from the same distribution</h2><span id='topic+ptw2011.gof.test'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This test is an alternative to Pearson's X^2
goodness-of-fit test.  In contrast to Pearson's X^2, no ad hoc cell
collapsing is needed to avoid an inflated false positive rate
in situations of sparse cell frequences.
The statistic rapidly converges to the Monte-Carlo estimate
as the number of draws increases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptw2011.gof.test(observed, expected)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptw2011.gof.test_+3A_observed">observed</code></td>
<td>
<p>observed matrix</p>
</td></tr>
<tr><td><code id="ptw2011.gof.test_+3A_expected">expected</code></td>
<td>
<p>expected matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The P value indicating whether the two tables come from
the same distribution. For example, a significant result (P &lt;
alpha level) rejects the hypothesis that the two matrices are from
the same distribution.
</p>


<h3>References</h3>

<p>Perkins, W., Tygert, M., &amp; Ward, R. (2011). Computing
the confidence levels for a root-mean-square test of
goodness-of-fit. <em>Applied Mathematics and Computations,
217</em>(22), 9072-9084.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>draws &lt;- 17
observed &lt;- matrix(c(.294, .176, .118, .411), nrow=2) * draws
expected &lt;- matrix(c(.235, .235, .176, .353), nrow=2) * draws
ptw2011.gof.test(observed, expected)  # not signficiant
</code></pre>

<hr>
<h2 id='read.flexmirt'>Read a flexMIRT PRM file</h2><span id='topic+read.flexmirt'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This was last updated in 2017 and may no longer work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.flexmirt(fname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.flexmirt_+3A_fname">fname</code></td>
<td>
<p>file name</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Load the item parameters from a flexMIRT PRM file.
</p>


<h3>Value</h3>

<p>a list of groups as described in the details
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>

<hr>
<h2 id='rpf.1dim.fit'>Calculate item and person Rasch fit statistics</h2><span id='topic+rpf.1dim.fit'></span>

<h3>Description</h3>

<p>Note: These statistics are only appropriate if all discrimination
parameters are fixed equal and items are conditionally independent
(see <code><a href="#topic+ChenThissen1997">ChenThissen1997</a></code>).  A best effort is made to
cope with missing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.1dim.fit(
  spec,
  params,
  responses,
  scores,
  margin,
  group = NULL,
  wh.exact = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.1dim.fit_+3A_spec">spec</code></td>
<td>
<p>list of item response models <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="rpf.1dim.fit_+3A_params">params</code></td>
<td>
<p>matrix of item parameters, 1 per column <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="rpf.1dim.fit_+3A_responses">responses</code></td>
<td>
<p>persons in rows and items in columns <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="rpf.1dim.fit_+3A_scores">scores</code></td>
<td>
<p>model derived person scores <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="rpf.1dim.fit_+3A_margin">margin</code></td>
<td>
<p>for people 1, for items 2</p>
</td></tr>
<tr><td><code id="rpf.1dim.fit_+3A_group">group</code></td>
<td>
<p>spec, params, data, and scores can be provided in a list instead of as arguments</p>
</td></tr>
<tr><td><code id="rpf.1dim.fit_+3A_wh.exact">wh.exact</code></td>
<td>
<p>whether to use the exact Wilson-Hilferty transformation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Exact distributional properties of these statistics are unknown
(Masters &amp; Wright, 1997, p. 112).  For details on the calculation,
refer to Wright &amp; Masters (1982, p. 100).
</p>
<p>The Wilson-Hilferty transformation is biased for less than 25 items.
Consider wh.exact=FALSE for less than 25 items.
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>
<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>References</h3>

<p>Masters, G. N. &amp; Wright, B. D. (1997). The Partial
Credit Model. In W. van der Linden &amp; R. K. Kambleton (Eds.),
<em>Handbook of modern item response theory</em>
(pp. 101-121). Springer.
</p>
<p>Wilson, E. B., &amp; Hilferty, M. M. (1931). The distribution of
chi-square. <em>Proceedings of the National Academy of Sciences of the
United States of America,</em> 17, 684-688.
</p>
<p>Wright, B. D. &amp; Masters, G. N. (1982). <em>Rating Scale
Analysis.</em> Chicago: Mesa Press.
</p>


<h3>See Also</h3>

<p>Other diagnostic: 
<code><a href="#topic+ChenThissen1997">ChenThissen1997</a>()</code>,
<code><a href="#topic+SitemFit1">SitemFit1</a>()</code>,
<code><a href="#topic+SitemFit">SitemFit</a>()</code>,
<code><a href="#topic+multinomialFit">multinomialFit</a>()</code>,
<code><a href="#topic+sumScoreEAPTest">sumScoreEAPTest</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kct)
responses &lt;- kct.people[,paste("V",2:19, sep="")]
rownames(responses) &lt;- kct.people$NAME
colnames(responses) &lt;- kct.items$NAME
scores &lt;- kct.people$MEASURE
params &lt;- cbind(1, kct.items$MEASURE, logit(0), logit(1))
rownames(params) &lt;- kct.items$NAME
items&lt;-list()
items[1:18] &lt;- rpf.drm()
params[,2] &lt;- -params[,2]
rpf.1dim.fit(items, t(params), responses, scores, 2, wh.exact=TRUE)
</code></pre>

<hr>
<h2 id='rpf.1dim.moment'>Calculate cell central moments</h2><span id='topic+rpf.1dim.moment'></span>

<h3>Description</h3>

<p>Popular central moments include 2 (variance) and 4 (kurtosis).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.1dim.moment(spec, params, scores, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.1dim.moment_+3A_spec">spec</code></td>
<td>
<p>list of item models</p>
</td></tr>
<tr><td><code id="rpf.1dim.moment_+3A_params">params</code></td>
<td>
<p>data frame of item parameters, 1 per row</p>
</td></tr>
<tr><td><code id="rpf.1dim.moment_+3A_scores">scores</code></td>
<td>
<p>model derived person scores</p>
</td></tr>
<tr><td><code id="rpf.1dim.moment_+3A_m">m</code></td>
<td>
<p>which moment</p>
</td></tr>
</table>


<h3>Value</h3>

<p>moment matrix
</p>

<hr>
<h2 id='rpf.1dim.residual'>Calculate residuals</h2><span id='topic+rpf.1dim.residual'></span>

<h3>Description</h3>

<p>Calculate residuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.1dim.residual(spec, params, responses, scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.1dim.residual_+3A_spec">spec</code></td>
<td>
<p>list of item models</p>
</td></tr>
<tr><td><code id="rpf.1dim.residual_+3A_params">params</code></td>
<td>
<p>data frame of item parameters, 1 per row</p>
</td></tr>
<tr><td><code id="rpf.1dim.residual_+3A_responses">responses</code></td>
<td>
<p>persons in rows and items in columns</p>
</td></tr>
<tr><td><code id="rpf.1dim.residual_+3A_scores">scores</code></td>
<td>
<p>model derived person scores</p>
</td></tr>
</table>


<h3>Value</h3>

<p>residuals
</p>

<hr>
<h2 id='rpf.1dim.stdresidual'>Calculate standardized residuals</h2><span id='topic+rpf.1dim.stdresidual'></span>

<h3>Description</h3>

<p>Calculate standardized residuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.1dim.stdresidual(spec, params, responses, scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.1dim.stdresidual_+3A_spec">spec</code></td>
<td>
<p>list of item models</p>
</td></tr>
<tr><td><code id="rpf.1dim.stdresidual_+3A_params">params</code></td>
<td>
<p>data frame of item parameters, 1 per row</p>
</td></tr>
<tr><td><code id="rpf.1dim.stdresidual_+3A_responses">responses</code></td>
<td>
<p>persons in rows and items in columns</p>
</td></tr>
<tr><td><code id="rpf.1dim.stdresidual_+3A_scores">scores</code></td>
<td>
<p>model derived person scores</p>
</td></tr>
</table>


<h3>Value</h3>

<p>standardized residuals
</p>

<hr>
<h2 id='rpf.dLL'>Item parameter derivatives</h2><span id='topic+rpf.dLL'></span><span id='topic+rpf.dLL+2Crpf.base+2Cnumeric+2Cnumeric+2Cnumeric-method'></span><span id='topic+rpf.dLL+2Crpf.base+2Cnumeric+2CNULL+2Cnumeric-method'></span><span id='topic+_rpf_dLL'></span>

<h3>Description</h3>

<p>Evaluate the partial derivatives of the log likelihood with
respect to each parameter at <code>where</code> with <code>weight</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.dLL(m, param, where, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.dLL_+3A_m">m</code></td>
<td>
<p>item model</p>
</td></tr>
<tr><td><code id="rpf.dLL_+3A_param">param</code></td>
<td>
<p>item parameters</p>
</td></tr>
<tr><td><code id="rpf.dLL_+3A_where">where</code></td>
<td>
<p>location in the latent space</p>
</td></tr>
<tr><td><code id="rpf.dLL_+3A_weight">weight</code></td>
<td>
<p>per outcome weights (typically derived by observation)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is not easy to write an example for this function. To evaluate
the derivative, you need to sum the derivatives across a
quadrature. You also need response outcome weights at each
quadrature point. It is not anticipated that this function will be
often used in R code. It's mainly to expose a C-level function for
occasional debugging.
</p>


<h3>Value</h3>

<p>first and second order partial derivatives of the log
likelihood evaluated at <code>where</code>. For p parameters, the first
p values are the first derivative and the next p(p+1)/2 columns
are the lower triangle of the second derivative.
</p>


<h3>See Also</h3>

<p>The numDeriv package.
</p>

<hr>
<h2 id='rpf.drm'>Create a dichotomous response model</h2><span id='topic+rpf.drm'></span>

<h3>Description</h3>

<p>For slope vector a, intercept c, pseudo-guessing parameter g,
upper bound u, and latent ability vector theta, the response probability
function is
</p>
<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=0|a,c,g,u,\theta) = 1- \mathrm P(\mathrm{pick}=1|a,c,g,u,\theta)
</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=1|a,c,g,u,\theta) = g+(u-g)\frac{1}{1+\exp(-(a\theta + c))}
</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>rpf.drm(factors = 1, multidimensional = TRUE, poor = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.drm_+3A_factors">factors</code></td>
<td>
<p>the number of factors</p>
</td></tr>
<tr><td><code id="rpf.drm_+3A_multidimensional">multidimensional</code></td>
<td>
<p>whether to use a multidimensional model.
Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rpf.drm_+3A_poor">poor</code></td>
<td>
<p>if TRUE, use the traditional parameterization of
the 1d model instead of the slope-intercept parameterization</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The pseudo-guessing and upper bound parameter are specified in
logit units (see <code><a href="#topic+logit">logit</a></code>).
</p>
<p>For discussion on the choice of priors see Cai, Yang, and
Hansen (2011, p. 246).
</p>


<h3>Value</h3>

<p>an item model
</p>


<h3>References</h3>

<p>Cai, L., Yang, J. S., &amp; Hansen, M. (2011). Generalized
Full-Information Item Bifactor Analysis.  <em>Psychological
Methods, 16</em>(3), 221-248.
</p>


<h3>See Also</h3>

<p>Other response model: 
<code><a href="#topic+rpf.gpcmp">rpf.gpcmp</a>()</code>,
<code><a href="#topic+rpf.grmp">rpf.grmp</a>()</code>,
<code><a href="#topic+rpf.grm">rpf.grm</a>()</code>,
<code><a href="#topic+rpf.lmp">rpf.lmp</a>()</code>,
<code><a href="#topic+rpf.mcm">rpf.mcm</a>()</code>,
<code><a href="#topic+rpf.nrm">rpf.nrm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- rpf.drm()
rpf.prob(spec, rpf.rparam(spec), 0)
</code></pre>

<hr>
<h2 id='rpf.dTheta'>Item derivatives with respect to the location in the latent space</h2><span id='topic+rpf.dTheta'></span><span id='topic+_rpf_dTheta'></span><span id='topic+rpf.dTheta+2Crpf.base+2Cnumeric+2Cnumeric+2Cnumeric-method'></span><span id='topic+rpf.dTheta+2Crpf.base+2Cnumeric+2Cmatrix+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Evaluate the partial derivatives of the response probability with
respect to ability. See <a href="#topic+rpf.info">rpf.info</a> for an application.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.dTheta(m, param, where, dir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.dTheta_+3A_m">m</code></td>
<td>
<p>item model</p>
</td></tr>
<tr><td><code id="rpf.dTheta_+3A_param">param</code></td>
<td>
<p>item parameters</p>
</td></tr>
<tr><td><code id="rpf.dTheta_+3A_where">where</code></td>
<td>
<p>location in the latent distribution</p>
</td></tr>
<tr><td><code id="rpf.dTheta_+3A_dir">dir</code></td>
<td>
<p>if more than 1 factor, a basis vector</p>
</td></tr>
</table>

<hr>
<h2 id='rpf.gpcmp'>Create monotonic polynomial generalized partial credit (GPC-MP) model</h2><span id='topic+rpf.gpcmp'></span>

<h3>Description</h3>

<p>This model is a polytomous model proposed by Falk &amp; Cai (2016) and is based
on the generalized partial credit model (Muraki, 1992).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.gpcmp(outcomes = 2, q = 0, multidimensional = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.gpcmp_+3A_outcomes">outcomes</code></td>
<td>
<p>The number of possible response categories.</p>
</td></tr>
<tr><td><code id="rpf.gpcmp_+3A_q">q</code></td>
<td>
<p>a non-negative integer that controls the order of the
polynomial (2q+1) with a default of q=0 (1st order polynomial = generalized partial credit model).</p>
</td></tr>
<tr><td><code id="rpf.gpcmp_+3A_multidimensional">multidimensional</code></td>
<td>
<p>whether to use a multidimensional model.
Defaults to <code>FALSE</code>. The multidimensional version is not yet
available.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GPC-MP replaces the linear predictor part of the
generalized partial credit model with a monotonic polynomial,
<code class="reqn">m(\theta;\omega,\xi,\mathbf{\alpha},\mathbf{\tau})</code>.
The response function for category k is:
</p>
<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=k|\omega,\xi,\alpha,\tau,\theta)
= \frac{\exp(\sum_{v=0}^k (\xi_k + m(\theta;\omega,\xi,\mathbf{\alpha},\mathbf{\tau})))}{\sum_{u=0}^{K-1}\exp(\sum_{v=0}^u (\xi_u + m(\theta;\omega,\xi,\mathbf{\alpha},\mathbf{\tau})))}
</code>
</p>

<p>where <code class="reqn">\mathbf{\alpha}</code> and <code class="reqn">\mathbf{\tau}</code> are vectors
of length q. The GPC-MP uses the same parameterization for the polynomial
as described for the logistic function of a monotonic polynomial (LMP).
See also (<code><a href="#topic+rpf.lmp">rpf.lmp</a></code>).
</p>
<p>The order of the polynomial is always odd and is controlled by
the user specified non-negative integer, q. The model contains
1+(outcomtes-1)+2*q parameters and are used as input to the <code><a href="#topic+rpf.prob">rpf.prob</a></code>
function in the following order:
<code class="reqn">\omega</code> - natural log of the slope of the item model when q=0,
<code class="reqn">\xi</code> - a (outcomes-1)-length vector of intercept parameters,
<code class="reqn">\alpha</code> and <code class="reqn">\tau</code> - two parameters that control bends in
the polynomial. These latter parameters are repeated in the same order for
models with q&gt;0. For example, a q=2 polynomial with 3 categories will have an item
parameter vector of: <code class="reqn">\omega, \xi_1, \xi_2, \alpha_1, \tau_1, \alpha_2, \tau_2</code>.
</p>
<p>Note that the GPC-MP reduces to the LMP when the number of
categories is 2, and the GPC-MP reduces to the generalized partial
credit model when the order of the polynomial is 1 (i.e., q=0).
</p>


<h3>Value</h3>

<p>an item model
</p>


<h3>References</h3>

<p>Falk, C. F., &amp; Cai, L. (2016). Maximum marginal likelihood
estimation of a monotonic polynomial generalized partial credit model with
applications to multiple group analysis. <em>Psychometrika, 81</em>, 434-460.
<a href="https://doi.org/10.1007/s11336-014-9428-7">doi:10.1007/s11336-014-9428-7</a>
</p>
<p>Muraki, E. (1992). A generalized partial credit model: Application of an EM algorithm. <em>Applied Psychological Measurement, 16,</em> 159176.
</p>


<h3>See Also</h3>

<p>Other response model: 
<code><a href="#topic+rpf.drm">rpf.drm</a>()</code>,
<code><a href="#topic+rpf.grmp">rpf.grmp</a>()</code>,
<code><a href="#topic+rpf.grm">rpf.grm</a>()</code>,
<code><a href="#topic+rpf.lmp">rpf.lmp</a>()</code>,
<code><a href="#topic+rpf.mcm">rpf.mcm</a>()</code>,
<code><a href="#topic+rpf.nrm">rpf.nrm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- rpf.gpcmp(5,2) # 5-category, 3rd order polynomial
theta&lt;-seq(-3,3,.1)
p&lt;-rpf.prob(spec, c(1.02,3.48,2.5,-.25,-1.64,.89,-8.7,-.74,-8.99),theta)

</code></pre>

<hr>
<h2 id='rpf.grm'>Create a graded response model</h2><span id='topic+rpf.grm'></span>

<h3>Description</h3>

<p>For outcomes k in 0 to K, slope vector a, intercept vector c, and latent ability vector theta,
the response probability function is
</p>
<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=0|a,c,\theta) = 1- \mathrm P(\mathrm{pick}=1|a,c_1,\theta)
</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=k|a,c,\theta) = \frac{1}{1+\exp(-(a\theta + c_k))} - \frac{1}{1+\exp(-(a\theta + c_{k+1}))}
</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=K|a,c,\theta) = \frac{1}{1+\exp(-(a\theta + c_K))}
</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>rpf.grm(outcomes = 2, factors = 1, multidimensional = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.grm_+3A_outcomes">outcomes</code></td>
<td>
<p>The number of choices available</p>
</td></tr>
<tr><td><code id="rpf.grm_+3A_factors">factors</code></td>
<td>
<p>the number of factors</p>
</td></tr>
<tr><td><code id="rpf.grm_+3A_multidimensional">multidimensional</code></td>
<td>
<p>whether to use a multidimensional model.
Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The graded response model was designed for a item with a series of
dependent parts where a higher score implies that easier parts of
the item were surmounted. If there is any chance your polytomous
item has independent parts then consider <code><a href="#topic+rpf.nrm">rpf.nrm</a></code>.
If your categories cannot cross then the graded response model
provides a little more information than the nominal model.
Stronger a priori assumptions offer provide more power at the cost
of flexibility.
</p>


<h3>Value</h3>

<p>an item model
</p>


<h3>See Also</h3>

<p>Other response model: 
<code><a href="#topic+rpf.drm">rpf.drm</a>()</code>,
<code><a href="#topic+rpf.gpcmp">rpf.gpcmp</a>()</code>,
<code><a href="#topic+rpf.grmp">rpf.grmp</a>()</code>,
<code><a href="#topic+rpf.lmp">rpf.lmp</a>()</code>,
<code><a href="#topic+rpf.mcm">rpf.mcm</a>()</code>,
<code><a href="#topic+rpf.nrm">rpf.nrm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- rpf.grm()
rpf.prob(spec, rpf.rparam(spec), 0)
</code></pre>

<hr>
<h2 id='rpf.grmp'>Create monotonic polynomial graded response (GR-MP) model</h2><span id='topic+rpf.grmp'></span>

<h3>Description</h3>

<p>The GR-MP model replaces the linear predictor of the graded
response model (Samejima, 1969, 1972) with a monotonic polynomial (Falk, conditionally accepted).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.grmp(outcomes = 2, q = 0, multidimensional = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.grmp_+3A_outcomes">outcomes</code></td>
<td>
<p>The number of possible response categories. When equal to 2, the model reduces
to the logistic function of a monotonic polynomial (LMP).</p>
</td></tr>
<tr><td><code id="rpf.grmp_+3A_q">q</code></td>
<td>
<p>a non-negative integer that controls the order of the
polynomial (2q+1) with a default of q=0 (1st order polynomial = graded response model).</p>
</td></tr>
<tr><td><code id="rpf.grmp_+3A_multidimensional">multidimensional</code></td>
<td>
<p>whether to use a multidimensional model.
Defaults to <code>FALSE</code>. The multidimensional version is not yet
available.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given its relationship to the graded response model, the GR-MP
is constructed in an analogous way:
</p>
<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=0|\lambda,\alpha,\tau,\theta) = 1- \frac{1}{1+\exp(-(\xi_1 + m(\theta;\lambda,\mathbf{\alpha},\mathbf{\tau})))}
</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=k|\lambda,\alpha,\tau,\theta) = \frac{1}{1+\exp(-(\xi_k + m(\theta;\lambda,\mathbf{\alpha},\mathbf{\tau})))} - \frac{1}{1+\exp(-(\xi_{k+1} + m(\theta,\lambda,\mathbf{\alpha},\mathbf{\tau}))}
</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=K|\lambda,\alpha,\tau,\theta) = \frac{1}{1+\exp(-(\xi_K + m(\theta;\lambda,\mathbf{\alpha},\mathbf{\tau}))}
</code>
</p>

<p>The order of the polynomial is always odd and is controlled by
the user specified non-negative integer, q. The model contains
1+(outcomtes-1)+2*q parameters and are used as input to the <code><a href="#topic+rpf.prob">rpf.prob</a></code>
or <code><a href="#topic+rpf.dTheta">rpf.dTheta</a></code> functions in the following order:
<code class="reqn">\lambda</code> - slope of the item model when q=0,
<code class="reqn">\xi</code> - a (outcomes-1)-length vector of intercept parameters,
<code class="reqn">\alpha</code> and <code class="reqn">\tau</code> - two parameters that control bends in
the polynomial. These latter parameters are repeated in the same order for
models with q&gt;0.  For example, a q=2 polynomial with 3 categories will have an item
parameter vector of: <code class="reqn">\lambda, \xi_1, \xi_2, \alpha_1, \tau_1, \alpha_2, \tau_2</code>.
</p>
<p>As with other monotonic polynomial-based item models
(e.g., <code><a href="#topic+rpf.lmp">rpf.lmp</a></code>), the polynomial looks like the
following:
</p>
<p style="text-align: center;"><code class="reqn">m(\theta;\lambda,\alpha,\tau) = b_1\theta + b_2\theta^2 + \dots + b_{2q+1}\theta^{2q+1}
</code>
</p>

<p>However, the coefficients, b, are not directly estimated, but are a function of the
item parameters, and the parameterization of the GR-MP is different than
that currently appearing for the logistic function of a monotonic
polynomial (LMP; <code><a href="#topic+rpf.lmp">rpf.lmp</a></code>) and monotonic polynomial generalized partial credit
(GPC-MP; <code><a href="#topic+rpf.gpcmp">rpf.gpcmp</a></code>) models. In particular, the polynomial is
parameterized such that boundary descrimination functions for the GR-MP will
be all monotonically increasing or decreasing for any given item. This allows
the possibility of items that load either negatively or positively on the latent
trait, as is common with reverse-worded items in non-cognitive tests (e.g., personality).
</p>
<p>The derivative <code class="reqn">m'(\theta;\lambda,\alpha,\tau)</code> is
parameterized in the following way:
</p>
<p style="text-align: center;"><code class="reqn"> m'(\theta;\lambda,\alpha,\tau) = \left\{\begin{array}{ll}\lambda \prod_{u=1}^q(1-2\alpha_{u}\theta + (\alpha_{u}^2 + \exp(\tau_{u}))\theta^2) &amp;  \mbox{if } q &gt; 0 \\
 \lambda &amp; \mbox{if } q = 0\end{array} \right.</code>
</p>

<p>Note that the only difference between the GR-MP and these other models
is that <code class="reqn">\lambda</code> is not re-parameterized and may take on
negative values. When <code class="reqn">\lambda</code> is negative, it is analogous
to having a negative loading or a monotonically decreasing function.
</p>


<h3>Value</h3>

<p>an item model
</p>


<h3>References</h3>

<p>Falk, C. F. (conditionally accepted). The monotonic polynomial
graded response model: Implementation and a comparative study. <em>Applied Psychological
Measurement</em>.
</p>
<p>Samejima, F. (1969). Estimation of latent ability using a response pattern of graded scores. <em>Psychometric Monographs</em>, 17.
</p>
<p>Samejima, F. (1972). A general model of free-response data. <em>Psychometric Monographs</em>, 18.
</p>


<h3>See Also</h3>

<p>Other response model: 
<code><a href="#topic+rpf.drm">rpf.drm</a>()</code>,
<code><a href="#topic+rpf.gpcmp">rpf.gpcmp</a>()</code>,
<code><a href="#topic+rpf.grm">rpf.grm</a>()</code>,
<code><a href="#topic+rpf.lmp">rpf.lmp</a>()</code>,
<code><a href="#topic+rpf.mcm">rpf.mcm</a>()</code>,
<code><a href="#topic+rpf.nrm">rpf.nrm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- rpf.grmp(5,2) # 5-category, 3rd order polynomial
theta&lt;-seq(-3,3,.1)
p&lt;-rpf.prob(spec, c(2.77,2,1,0,-1,.89,-8.7,-.74,-8.99),theta)
</code></pre>

<hr>
<h2 id='rpf.id_of'>Convert an rpf item model name to an ID</h2><span id='topic+rpf.id_of'></span>

<h3>Description</h3>

<p>This is an internal function and should not be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.id_of(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.id_of_+3A_name">name</code></td>
<td>
<p>name of the item model (string)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the integer ID assigned to the given model
</p>

<hr>
<h2 id='rpf.info'>Map an item model, item parameters, and person trait score into a
information vector</h2><span id='topic+rpf.info'></span>

<h3>Description</h3>

<p>Map an item model, item parameters, and person trait score into a
information vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.info(ii, ii.p, where, basis = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.info_+3A_ii">ii</code></td>
<td>
<p>an item model</p>
</td></tr>
<tr><td><code id="rpf.info_+3A_ii.p">ii.p</code></td>
<td>
<p>item parameters</p>
</td></tr>
<tr><td><code id="rpf.info_+3A_where">where</code></td>
<td>
<p>the location in the latent distribution</p>
</td></tr>
<tr><td><code id="rpf.info_+3A_basis">basis</code></td>
<td>
<p>if more than 1 factor, a positive basis vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fisher information
</p>


<h3>References</h3>

<p>Dodd, B. G., De Ayala, R. J. &amp; Koch,
W. R. (1995). Computerized adaptive testing with polytomous items.
<em>Applied psychological measurement 19</em>(1), 5-22.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>i1 &lt;- rpf.drm()
i1.p &lt;- c(.6,1,.1,.95)
theta &lt;- seq(0,3,.05)
plot(theta, rpf.info(i1, i1.p, t(theta)), type="l")
</code></pre>

<hr>
<h2 id='rpf.lmp'>Create logistic function of a monotonic polynomial (LMP) model</h2><span id='topic+rpf.lmp'></span>

<h3>Description</h3>

<p>This model is a dichotomous response model originally proposed by
Liang (2007) and is implemented using the parameterization by
Falk &amp; Cai (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.lmp(q = 0, multidimensional = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.lmp_+3A_q">q</code></td>
<td>
<p>a non-negative integer that controls the order of the
polynomial (2q+1) with a default of q=0 (1st order polynomial = 2PL).</p>
</td></tr>
<tr><td><code id="rpf.lmp_+3A_multidimensional">multidimensional</code></td>
<td>
<p>whether to use a multidimensional model.
Defaults to <code>FALSE</code>. The multidimensional version is not yet
available.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LMP model replaces the linear predictor part of the
two-parameter logistic function with a monotonic polynomial,
<code class="reqn">m(\theta,\omega,\xi,\mathbf{\alpha},\mathbf{\tau})</code>,
</p>
<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=1|\omega,\xi,\mathbf{\alpha},\mathbf{\tau},\theta)
= \frac{1}{1+\exp(-(\xi + m(\theta;\omega,\mathbf{\alpha},\mathbf{\tau})))}
</code>
</p>

<p>where <code class="reqn">\mathbf{\alpha}</code> and <code class="reqn">\mathbf{\tau}</code> are vectors
of length q.
</p>
<p>The order of the polynomial is always odd and is controlled by
the user specified non-negative integer, q. The model contains
2+2*q parameters and are used in conjunction with the <code><a href="#topic+rpf.prob">rpf.prob</a></code>
or <code><a href="#topic+rpf.dTheta">rpf.dTheta</a></code> function in the following order:
<code class="reqn">\omega</code> - the natural log of the slope of the item model when q=0,
<code class="reqn">\xi</code> - the intercept,
<code class="reqn">\alpha</code> and <code class="reqn">\tau</code> - two parameters that control bends in
the polynomial. These latter parameters are repeated in the same order for
models with q&gt;0. For example, a q=2 polynomial with have an item
parameter vector of: <code class="reqn">\omega, \xi, \alpha_1, \tau_1, \alpha_2, \tau_2</code>.
</p>
<p>In general, the polynomial looks like the following:
</p>
<p style="text-align: center;"><code class="reqn">m(\theta;\omega,\alpha,\tau) = b_1\theta + b_2\theta^2 + \dots + b_{2q+1}\theta^{2q+1}
</code>
</p>

<p>However, the coefficients, b, are not directly estimated, but are a function of the
item parameters. In particular, the derivative <code class="reqn">m'(\theta;\omega,\alpha,\tau)</code> is
parameterized in the following way:
</p>
<p style="text-align: center;"><code class="reqn">m'(\theta;\omega,\alpha,\tau) = \left\{\begin{array}{ll}\exp(\omega) \prod_{u=1}^q(1-2\alpha_{u}\theta + (\alpha_{u}^2 + \exp(\tau_{u}))\theta^2) &amp;  \mbox{if } q &gt; 0 \\
 \exp(\omega) &amp; \mbox{if } q = 0\end{array} \right.</code>
</p>

<p>See Falk &amp; Cai (2016) for more details as to how the polynomial is constructed.
At the lowest order polynomial (q=0) the model reduces to the
two-parameter logistic (2PL) model. However, parameterization of the
slope parameter, <code class="reqn">\omega</code>, is currently different than
the 2PL (i.e., slope = exp(<code class="reqn">\omega</code>)). This parameterization
ensures that the response function is always monotonically increasing
without requiring constrained optimization.
</p>
<p>For an alternative parameterization that releases constraints
on <code class="reqn">\omega</code>, allowing for monotonically decreasing functions,
see <code><a href="#topic+rpf.grmp">rpf.grmp</a></code>. And for polytomous items, see both
<code><a href="#topic+rpf.grmp">rpf.grmp</a></code> and <code><a href="#topic+rpf.gpcmp">rpf.gpcmp</a></code>.
</p>


<h3>Value</h3>

<p>an item model
</p>


<h3>References</h3>

<p>Falk, C. F., &amp; Cai, L. (2016). Maximum marginal likelihood
estimation of a monotonic polynomial generalized partial credit model with
applications to multiple group analysis. <em>Psychometrika, 81</em>, 434-460.
<a href="https://doi.org/10.1007/s11336-014-9428-7">doi:10.1007/s11336-014-9428-7</a>
</p>
<p>Liang (2007). <em>A semi-parametric approach to estimating item response
functions</em>. Unpublished doctoral dissertation, Department of Psychology,
The Ohio State University.
</p>


<h3>See Also</h3>

<p>Other response model: 
<code><a href="#topic+rpf.drm">rpf.drm</a>()</code>,
<code><a href="#topic+rpf.gpcmp">rpf.gpcmp</a>()</code>,
<code><a href="#topic+rpf.grmp">rpf.grmp</a>()</code>,
<code><a href="#topic+rpf.grm">rpf.grm</a>()</code>,
<code><a href="#topic+rpf.mcm">rpf.mcm</a>()</code>,
<code><a href="#topic+rpf.nrm">rpf.nrm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- rpf.lmp(1) # 3rd order polynomial
theta&lt;-seq(-3,3,.1)
p&lt;-rpf.prob(spec, c(-.11,.37,.24,-.21),theta)

spec &lt;- rpf.lmp(2) # 5th order polynomial
p&lt;-rpf.prob(spec, c(.69,.71,-.5,-8.48,.52,-3.32),theta)
</code></pre>

<hr>
<h2 id='rpf.logprob'>Map an item model, item parameters, and person trait score into a
probability vector</h2><span id='topic+rpf.logprob'></span><span id='topic+rpf.logprob+2Crpf.1dim+2Cnumeric+2Cnumeric-method'></span><span id='topic+rpf.logprob+2Crpf.1dim+2Cnumeric+2Cmatrix-method'></span><span id='topic+rpf.logprob+2Crpf.mdim+2Cnumeric+2Cmatrix-method'></span><span id='topic+rpf.logprob+2Crpf.mdim+2Cnumeric+2Cnumeric-method'></span><span id='topic+rpf.logprob+2Crpf.mdim+2Cnumeric+2CNULL-method'></span><span id='topic+_rpf_logprob'></span>

<h3>Description</h3>

<p>Note that in general, exp(rpf.logprob(..)) != rpf.prob(..) because
the range of logits is much wider than the range of probabilities
due to limitations of floating point numerical precision.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.logprob(m, param, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.logprob_+3A_m">m</code></td>
<td>
<p>an item model</p>
</td></tr>
<tr><td><code id="rpf.logprob_+3A_param">param</code></td>
<td>
<p>item parameters</p>
</td></tr>
<tr><td><code id="rpf.logprob_+3A_theta">theta</code></td>
<td>
<p>the trait score(s)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of probabilities. For dichotomous items,
probabilities are returned in the order incorrect, correct.
Although redundent, both incorrect and correct probabilities are
returned in the dichotomous case for API consistency with
polytomous item models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>i1 &lt;- rpf.drm()
i1.p &lt;- rpf.rparam(i1)
rpf.logprob(i1, c(i1.p), -1)   # low trait score
rpf.logprob(i1, c(i1.p), c(0,1))    # average and high trait score
</code></pre>

<hr>
<h2 id='rpf.mcm'>Create a multiple-choice response model</h2><span id='topic+rpf.mcm'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.mcm(outcomes = 2, numChoices = 5, factors = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.mcm_+3A_outcomes">outcomes</code></td>
<td>
<p>the number of possible outcomes</p>
</td></tr>
<tr><td><code id="rpf.mcm_+3A_numchoices">numChoices</code></td>
<td>
<p>the number of choices available</p>
</td></tr>
<tr><td><code id="rpf.mcm_+3A_factors">factors</code></td>
<td>
<p>the number of factors</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function instantiates a multiple-choice response
model.
</p>


<h3>Value</h3>

<p>an item model
</p>


<h3>Author(s)</h3>

<p>Jonathan Weeks &lt;weeksjp@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other response model: 
<code><a href="#topic+rpf.drm">rpf.drm</a>()</code>,
<code><a href="#topic+rpf.gpcmp">rpf.gpcmp</a>()</code>,
<code><a href="#topic+rpf.grmp">rpf.grmp</a>()</code>,
<code><a href="#topic+rpf.grm">rpf.grm</a>()</code>,
<code><a href="#topic+rpf.lmp">rpf.lmp</a>()</code>,
<code><a href="#topic+rpf.nrm">rpf.nrm</a>()</code>
</p>

<hr>
<h2 id='rpf.mean.info'>Find the point where an item provides mean maximum information</h2><span id='topic+rpf.mean.info'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This is a point estimate of the mean difficulty of items that do
not offer easily interpretable parameters such as the Generalized
PCM. Since the information curve may not be unimodal, this
function integrates across the latent space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.mean.info(spec, param, grain = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.mean.info_+3A_spec">spec</code></td>
<td>
<p>list of item specs</p>
</td></tr>
<tr><td><code id="rpf.mean.info_+3A_param">param</code></td>
<td>
<p>list or matrix of item parameters</p>
</td></tr>
<tr><td><code id="rpf.mean.info_+3A_grain">grain</code></td>
<td>
<p>the step size for numerical integration (optional)</p>
</td></tr>
</table>

<hr>
<h2 id='rpf.mean.info1'>Find the point where an item provides mean maximum information</h2><span id='topic+rpf.mean.info1'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.mean.info1(spec, iparam, grain = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.mean.info1_+3A_spec">spec</code></td>
<td>
<p>an item spec</p>
</td></tr>
<tr><td><code id="rpf.mean.info1_+3A_iparam">iparam</code></td>
<td>
<p>an item parameter vector</p>
</td></tr>
<tr><td><code id="rpf.mean.info1_+3A_grain">grain</code></td>
<td>
<p>the step size for numerical integration (optional)</p>
</td></tr>
</table>

<hr>
<h2 id='rpf.modify'>Create a similar item specification with the given number of factors</h2><span id='topic+rpf.modify'></span><span id='topic+rpf.modify+2Crpf.mdim.drm+2Cnumeric-method'></span><span id='topic+rpf.modify+2Crpf.mdim.graded+2Cnumeric-method'></span><span id='topic+rpf.modify+2Crpf.mdim.nrm+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Create a similar item specification with the given number of factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.modify(m, factors)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.modify_+3A_m">m</code></td>
<td>
<p>item model</p>
</td></tr>
<tr><td><code id="rpf.modify_+3A_factors">factors</code></td>
<td>
<p>the number of factors/dimensions</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>s1 &lt;- rpf.grm(factors=3)
rpf.rparam(s1)
s2 &lt;- rpf.modify(s1, 1)
rpf.rparam(s2)
</code></pre>

<hr>
<h2 id='rpf.nrm'>Create a nominal response model</h2><span id='topic+rpf.nrm'></span>

<h3>Description</h3>

<p>This function instantiates a nominal response model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.nrm(outcomes = 3, factors = 1, T.a = "trend", T.c = "trend")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.nrm_+3A_outcomes">outcomes</code></td>
<td>
<p>The number of choices available</p>
</td></tr>
<tr><td><code id="rpf.nrm_+3A_factors">factors</code></td>
<td>
<p>the number of factors</p>
</td></tr>
<tr><td><code id="rpf.nrm_+3A_t.a">T.a</code></td>
<td>
<p>the T matrix for slope parameters</p>
</td></tr>
<tr><td><code id="rpf.nrm_+3A_t.c">T.c</code></td>
<td>
<p>the T matrix for intercept parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The transformation matrices T.a and T.c are chosen by the analyst
and not estimated.  The T matrices must be invertible square
matrices of size outcomes-1. As a shortcut, either T matrix
can be specified as &quot;trend&quot; for a Fourier basis or as &quot;id&quot; for an
identity basis. The response probability function is
</p>
<p style="text-align: center;"><code class="reqn">a = T_a \alpha</code>
</p>

<p style="text-align: center;"><code class="reqn">c = T_c \gamma</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathrm P(\mathrm{pick}=k|s,a_k,c_k,\theta) = C\ \frac{1}{1+\exp(-(s \theta a_k + c_k))}</code>
</p>

<p>where <code class="reqn">a_k</code> and <code class="reqn">c_k</code> are the result of multiplying two vectors
of free parameters <code class="reqn">\alpha</code> and <code class="reqn">\gamma</code> by fixed matrices <code class="reqn">T_a</code> and <code class="reqn">T_c</code>, respectively;
<code class="reqn">a_0</code> and <code class="reqn">c_0</code> are fixed to 0 for identification;
and <code class="reqn">C</code> is a normalizing factor to ensure that <code class="reqn">\sum_k \mathrm P(\mathrm{pick}=k) = 1</code>.
</p>


<h3>Value</h3>

<p>an item model
</p>


<h3>References</h3>

<p>Thissen, D., Cai, L., &amp; Bock, R. D. (2010). The
Nominal Categories Item Response Model. In M. L. Nering &amp;
R. Ostini (Eds.), <em>Handbook of Polytomous Item Response
Theory Models</em> (pp. 43&ndash;75). Routledge.
</p>


<h3>See Also</h3>

<p>Other response model: 
<code><a href="#topic+rpf.drm">rpf.drm</a>()</code>,
<code><a href="#topic+rpf.gpcmp">rpf.gpcmp</a>()</code>,
<code><a href="#topic+rpf.grmp">rpf.grmp</a>()</code>,
<code><a href="#topic+rpf.grm">rpf.grm</a>()</code>,
<code><a href="#topic+rpf.lmp">rpf.lmp</a>()</code>,
<code><a href="#topic+rpf.mcm">rpf.mcm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- rpf.nrm()
rpf.prob(spec, rpf.rparam(spec), 0)
# typical parameterization for the Generalized Partial Credit Model
gpcm &lt;- function(outcomes) rpf.nrm(outcomes, T.c=lower.tri(diag(outcomes-1),TRUE) * -1)
spec &lt;- gpcm(4)
rpf.prob(spec, rpf.rparam(spec), 0)
</code></pre>

<hr>
<h2 id='rpf.numParam'>Length of the item parameter vector</h2><span id='topic+rpf.numParam'></span><span id='topic+rpf.numParam+2Crpf.base-method'></span><span id='topic+rpf_numParam_wrapper'></span>

<h3>Description</h3>

<p>Length of the item parameter vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.numParam(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.numParam_+3A_m">m</code></td>
<td>
<p>item model</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>rpf.numParam(rpf.grm(outcomes=3))
rpf.numParam(rpf.nrm(outcomes=3))
</code></pre>

<hr>
<h2 id='rpf.numSpec'>Length of the item model vector</h2><span id='topic+rpf.numSpec'></span><span id='topic+rpf.numSpec+2Crpf.base-method'></span><span id='topic+rpf_numSpec_wrapper'></span>

<h3>Description</h3>

<p>Length of the item model vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.numSpec(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.numSpec_+3A_m">m</code></td>
<td>
<p>item model</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>rpf.numSpec(rpf.grm(outcomes=3))
rpf.numSpec(rpf.nrm(outcomes=3))
</code></pre>

<hr>
<h2 id='rpf.ogive'>The ogive constant</h2><span id='topic+rpf.ogive'></span>

<h3>Description</h3>

<p>The ogive constant can be multiplied by the discrimination
parameter to obtain a response curve very similar to the Normal
cumulative distribution function (Haley, 1952; Molenaar, 1974).
Recently, Savalei (2006) proposed a new constant of 1.749 based on
Kullback-Leibler information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.ogive
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 1.
</p>


<h3>Details</h3>

<p>In recent years, the logistic has grown in favor, and therefore,
this package does not offer any special support for this
transformation (Baker &amp; Kim, 2004, pp. 14-18).
</p>


<h3>References</h3>

<p>Camilli, G. (1994). Teacher's corner: Origin of the
scaling constant d=1.7 in Item Response Theory. <em>Journal of
Educational and Behavioral Statistics, 19</em>(3), 293-295.
</p>
<p>Baker &amp; Kim (2004). <em>Item Response Theory: Parameter
Estimation Techniques.</em> Marcel Dekker, Inc.
</p>
<p>Haley, D. C. (1952). <em>Estimation of the dosage mortality
relationship when the dose is subject to error</em> (Technical Report
No. 15). Stanford University Applied Mathematics and Statistics
Laboratory, Stanford, CA.
</p>
<p>Molenaar, W. (1974). De logistische en de normale kromme [The
logistic and the normal curve]. <em>Nederlands Tijdschrift voor de
Psychologie</em> 29, 415-420.
</p>
<p>Savalei, V. (2006). Logistic approximation to the normal: The KL
rationale. <em>Psychometrika, 71</em>(4), 763&ndash;767.
</p>

<hr>
<h2 id='rpf.paramInfo'>Retrieve a description of the given parameter</h2><span id='topic+rpf.paramInfo'></span><span id='topic+rpf.paramInfo+2Crpf.base-method'></span><span id='topic+rpf_paramInfo_wrapper'></span>

<h3>Description</h3>

<p>Retrieve a description of the given parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.paramInfo(m, num = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.paramInfo_+3A_m">m</code></td>
<td>
<p>item model</p>
</td></tr>
<tr><td><code id="rpf.paramInfo_+3A_num">num</code></td>
<td>
<p>vector of parameters (defaults to all)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the type, upper bound, and lower bound
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rpf.paramInfo(rpf.drm())
</code></pre>

<hr>
<h2 id='rpf.prob'>Map an item model, item parameters, and person trait score into a
probability vector</h2><span id='topic+rpf.prob'></span><span id='topic+rpf.prob+2Crpf.1dim+2Cnumeric+2Cnumeric-method'></span><span id='topic+rpf.prob+2Crpf.mdim+2Cnumeric+2CNULL-method'></span><span id='topic+rpf.prob+2Crpf.mdim+2Cnumeric+2Cnumeric-method'></span><span id='topic+rpf.prob+2Crpf.mdim+2Cnumeric+2Cmatrix-method'></span><span id='topic+rpf.prob+2Crpf.base+2Cdata.frame+2Cnumeric-method'></span><span id='topic+rpf.prob+2Crpf.base+2Cmatrix+2Cnumeric-method'></span><span id='topic+rpf.prob+2Crpf.base+2Cmatrix+2Cmatrix-method'></span><span id='topic+rpf.prob+2Crpf.1dim+2Cnumeric+2Cmatrix-method'></span><span id='topic+rpf.prob+2Crpf.1dim.grm+2Cnumeric+2Cnumeric-method'></span><span id='topic+rpf.prob+2Crpf.mdim.grm+2Cnumeric+2Cnumeric-method'></span><span id='topic+rpf.prob+2Crpf.mdim.nrm+2Cnumeric+2Cmatrix-method'></span><span id='topic+rpf.prob+2Crpf.mdim.mcm+2Cnumeric+2Cmatrix-method'></span><span id='topic+rpf.prob+2Crpf.mdim.grm+2Cnumeric+2Cmatrix-method'></span><span id='topic+_rpf_prob'></span>

<h3>Description</h3>

<p>This function is known by many names in the literature. When
plotted against latent trait, it is often called a traceline, item
characteristic curve, or item response function. Sometimes the word
'category' or 'outcome' is used in place of 'item'. For example,
'item response function' might become 'category response
function'. All these terms refer to the same thing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.prob(m, param, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.prob_+3A_m">m</code></td>
<td>
<p>an item model</p>
</td></tr>
<tr><td><code id="rpf.prob_+3A_param">param</code></td>
<td>
<p>item parameters</p>
</td></tr>
<tr><td><code id="rpf.prob_+3A_theta">theta</code></td>
<td>
<p>the trait score(s)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of probabilities. For dichotomous items,
probabilities are returned in the order incorrect, correct.
Although redundent, both incorrect and correct probabilities are
returned in the dichotomous case for API consistency with
polytomous item models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>i1 &lt;- rpf.drm()
i1.p &lt;- rpf.rparam(i1)
rpf.prob(i1, c(i1.p), -1)   # low trait score
rpf.prob(i1, c(i1.p), c(0,1))    # average and high trait score
</code></pre>

<hr>
<h2 id='rpf.rescale'>Rescale item parameters</h2><span id='topic+rpf.rescale'></span><span id='topic+_rpf_rescale'></span><span id='topic+rpf.rescale+2Crpf.base+2Cnumeric+2Cnumeric+2Cmatrix-method'></span>

<h3>Description</h3>

<p>Adjust item parameters for changes in mean and covariance of the
latent distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.rescale(m, param, mean, cov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.rescale_+3A_m">m</code></td>
<td>
<p>item model</p>
</td></tr>
<tr><td><code id="rpf.rescale_+3A_param">param</code></td>
<td>
<p>item parameters</p>
</td></tr>
<tr><td><code id="rpf.rescale_+3A_mean">mean</code></td>
<td>
<p>vector of means</p>
</td></tr>
<tr><td><code id="rpf.rescale_+3A_cov">cov</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- rpf.grm()
p1 &lt;- rpf.rparam(spec)
testPoint &lt;- rnorm(1)
move &lt;- rnorm(1)
cov &lt;- as.matrix(rlnorm(1))
Icov &lt;- solve(cov)
padj &lt;- rpf.rescale(spec, p1, move, cov)
pr1 &lt;- rpf.prob(spec, padj, (testPoint-move) %*% Icov)
pr2 &lt;- rpf.prob(spec, p1, testPoint)
abs(pr1 - pr2) &lt; 1e9
</code></pre>

<hr>
<h2 id='rpf.rparam'>Generates item parameters</h2><span id='topic+rpf.rparam'></span><span id='topic+rpf.rparam+2Crpf.1dim.drm-method'></span><span id='topic+rpf.rparam+2Crpf.mdim.drm-method'></span><span id='topic+rpf.rparam+2Crpf.1dim.graded-method'></span><span id='topic+rpf.rparam+2Crpf.mdim.graded-method'></span><span id='topic+rpf.rparam+2Crpf.mdim.nrm-method'></span><span id='topic+rpf.rparam+2Crpf.mdim.mcm-method'></span><span id='topic+rpf.rparam+2Crpf.1dim.lmp-method'></span><span id='topic+rpf.rparam+2Crpf.1dim.grmp-method'></span><span id='topic+rpf.rparam+2Crpf.1dim.gpcmp-method'></span>

<h3>Description</h3>

<p>This function generates random item parameters. The version
argument is available if you are writing a test that depends on
reproducable random parameters (using <code>set.seed</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.rparam(m, version = 2L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.rparam_+3A_m">m</code></td>
<td>
<p>an item model</p>
</td></tr>
<tr><td><code id="rpf.rparam_+3A_version">version</code></td>
<td>
<p>the version of random parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>item parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>i1 &lt;- rpf.drm()
rpf.rparam(i1)
</code></pre>

<hr>
<h2 id='rpf.sample'>Randomly sample response patterns given a list of items</h2><span id='topic+rpf.sample'></span>

<h3>Description</h3>

<p>Returns a random sample of response patterns given a list of item
models and parameters. If <code>grp</code> is given then theta, items, params,
mean, and cov can be omitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpf.sample(
  theta,
  items,
  params,
  ...,
  prefix = "i",
  mean = NULL,
  cov = NULL,
  mcar = 0,
  grp = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpf.sample_+3A_theta">theta</code></td>
<td>
<p>either a vector (for 1 dimension) or a matrix (for &gt;1
dimension) of person abilities or the number of response patterns
to generate randomly</p>
</td></tr>
<tr><td><code id="rpf.sample_+3A_items">items</code></td>
<td>
<p>a list of item models</p>
</td></tr>
<tr><td><code id="rpf.sample_+3A_params">params</code></td>
<td>
<p>a list or matrix of item parameters. If omitted, random item
parameters are generated for each item model.</p>
</td></tr>
<tr><td><code id="rpf.sample_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="rpf.sample_+3A_prefix">prefix</code></td>
<td>
<p>Column names are taken from param or items.
If no column names are available, some will be generated using
the given prefix.</p>
</td></tr>
<tr><td><code id="rpf.sample_+3A_mean">mean</code></td>
<td>
<p>mean vector of latent distribution (optional)</p>
</td></tr>
<tr><td><code id="rpf.sample_+3A_cov">cov</code></td>
<td>
<p>covariance matrix of latent distribution (optional)</p>
</td></tr>
<tr><td><code id="rpf.sample_+3A_mcar">mcar</code></td>
<td>
<p>proportion of generated data to set to NA (missing completely at random)</p>
</td></tr>
<tr><td><code id="rpf.sample_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame of response patterns
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+sample">sample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 1 dimensional items
i1 &lt;- rpf.drm()
i1.p &lt;- rpf.rparam(i1)
i2 &lt;- rpf.nrm(outcomes=3)
i2.p &lt;- rpf.rparam(i2)
rpf.sample(5, list(i1,i2), list(i1.p, i2.p))
</code></pre>

<hr>
<h2 id='science'>Liking for Science dataset</h2><span id='topic+science'></span><span id='topic+sfif'></span><span id='topic+sfpf'></span><span id='topic+sfsf'></span><span id='topic+sfxf'></span>

<h3>Description</h3>

<p>These data are from Wright &amp; Masters (1982, p. 18).
</p>


<h3>Details</h3>

<p>All items were fit to a 3 category Partial Credit Model (PCM)
using Ministep 3.75.0.
</p>


<h3>References</h3>

<p>Wright, B. D. &amp; Masters, G. N. (1982). <em>Rating Scale
Analysis.</em> Chicago: Mesa Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(science)
</code></pre>

<hr>
<h2 id='SitemFit'>Compute the S fit statistic for a set of items</h2><span id='topic+SitemFit'></span>

<h3>Description</h3>

<p>Runs <code><a href="#topic+SitemFit1">SitemFit1</a></code> for every item and accumulates
the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SitemFit(
  grp,
  ...,
  method = "pearson",
  log = TRUE,
  qwidth = 6,
  qpoints = 49L,
  alt = FALSE,
  omit = 0L,
  .twotier = TRUE,
  .parallel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SitemFit_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="SitemFit_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="SitemFit_+3A_method">method</code></td>
<td>
<p>whether to use a pearson or rms test</p>
</td></tr>
<tr><td><code id="SitemFit_+3A_log">log</code></td>
<td>
<p>whether to return p-values in log units</p>
</td></tr>
<tr><td><code id="SitemFit_+3A_qwidth">qwidth</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="SitemFit_+3A_qpoints">qpoints</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="SitemFit_+3A_alt">alt</code></td>
<td>
<p>whether to include the item of interest in the denominator</p>
</td></tr>
<tr><td><code id="SitemFit_+3A_omit">omit</code></td>
<td>
<p>number of items to omit (a single number) or a list of the length the number of items</p>
</td></tr>
<tr><td><code id="SitemFit_+3A_.twotier">.twotier</code></td>
<td>
<p>whether to enable the two-tier optimization</p>
</td></tr>
<tr><td><code id="SitemFit_+3A_.parallel">.parallel</code></td>
<td>
<p>whether to take advantage of multiple CPUs (default TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of output from <code><a href="#topic+SitemFit1">SitemFit1</a></code>
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p>Other diagnostic: 
<code><a href="#topic+ChenThissen1997">ChenThissen1997</a>()</code>,
<code><a href="#topic+SitemFit1">SitemFit1</a>()</code>,
<code><a href="#topic+multinomialFit">multinomialFit</a>()</code>,
<code><a href="#topic+rpf.1dim.fit">rpf.1dim.fit</a>()</code>,
<code><a href="#topic+sumScoreEAPTest">sumScoreEAPTest</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>grp &lt;- list(spec=list())
grp$spec[1:20] &lt;- list(rpf.grm())
grp$param &lt;- sapply(grp$spec, rpf.rparam)
colnames(grp$param) &lt;- paste("i", 1:20, sep="")
grp$mean &lt;- 0
grp$cov &lt;- diag(1)
grp$free &lt;- grp$param != 0
grp$data &lt;- rpf.sample(500, grp=grp)
SitemFit(grp)
</code></pre>

<hr>
<h2 id='SitemFit1'>Compute the S fit statistic for 1 item</h2><span id='topic+SitemFit1'></span>

<h3>Description</h3>

<p>Implements the Kang &amp; Chen (2007) polytomous extension to
S statistic of Orlando &amp; Thissen (2000). Rows with
missing data are ignored, but see the <code>omit</code> option.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SitemFit1(
  grp,
  item,
  free = 0,
  ...,
  method = "pearson",
  log = TRUE,
  qwidth = 6,
  qpoints = 49L,
  alt = FALSE,
  omit = 0L,
  .twotier = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SitemFit1_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_item">item</code></td>
<td>
<p>the item of interest</p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_free">free</code></td>
<td>
<p>the number of free parameters involved in estimating the item (to adjust the df)</p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_method">method</code></td>
<td>
<p>whether to use a pearson or rms test</p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_log">log</code></td>
<td>
<p>whether to return p-values in log units</p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_qwidth">qwidth</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_qpoints">qpoints</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a></p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_alt">alt</code></td>
<td>
<p>whether to include the item of interest in the denominator</p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_omit">omit</code></td>
<td>
<p>number of items to omit or a character vector with the names of the items to omit when calculating the observed and expected sum-score tables</p>
</td></tr>
<tr><td><code id="SitemFit1_+3A_.twotier">.twotier</code></td>
<td>
<p>whether to enable the two-tier optimization</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This statistic is good at finding a small number of misfitting
items among a large number of well fitting items. However, be
aware that misfitting items can cause other items to misfit.
</p>
<p>Observed tables cannot be computed when data is
missing. Therefore, you can optionally omit items with the
greatest number of responses missing relative to the item of
interest.
</p>
<p>Pearson is slightly more powerful than RMS in most cases I
examined.
</p>
<p>Setting <code>alt</code> to <code>TRUE</code> causes the tables to match
published articles. However, the default setting of <code>FALSE</code>
probably provides slightly more power when there are less than 10
items.
</p>
<p>The name of the test, &quot;S&quot;, probably stands for sum-score.
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>References</h3>

<p>Kang, T. and Chen, T. T. (2007). An investigation of
the performance of the generalized S-Chisq item-fit index for
polytomous IRT models. ACT Research Report Series.
</p>
<p>Orlando, M. and Thissen, D. (2000). Likelihood-Based
Item-Fit Indices for Dichotomous Item Response Theory Models.
<em>Applied Psychological Measurement, 24</em>(1), 50-64.
</p>


<h3>See Also</h3>

<p>Other diagnostic: 
<code><a href="#topic+ChenThissen1997">ChenThissen1997</a>()</code>,
<code><a href="#topic+SitemFit">SitemFit</a>()</code>,
<code><a href="#topic+multinomialFit">multinomialFit</a>()</code>,
<code><a href="#topic+rpf.1dim.fit">rpf.1dim.fit</a>()</code>,
<code><a href="#topic+sumScoreEAPTest">sumScoreEAPTest</a>()</code>
</p>

<hr>
<h2 id='stripData'>Strip data and scores from an IFA group</h2><span id='topic+stripData'></span>

<h3>Description</h3>

<p>In addition, the freqColumn and weightColumn are reset to NULL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stripData(grp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stripData_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same group without associated data.
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- list()
spec[1:3] &lt;- list(rpf.grm(outcomes=3))
param &lt;- sapply(spec, rpf.rparam)
data &lt;- rpf.sample(5, spec, param)
colnames(param) &lt;- colnames(data)
grp &lt;- list(spec=spec, param=param, data=data, minItemsPerScore=1L)
grp$score &lt;- EAPscores(grp)
str(grp)
grp &lt;- stripData(grp)
str(grp)
</code></pre>

<hr>
<h2 id='sumScoreEAP'>Compute the sum-score EAP table</h2><span id='topic+sumScoreEAP'></span>

<h3>Description</h3>

<p>Observed tables cannot be computed when data is
missing. Therefore, you can optionally omit items with the
greatest number of responses missing when conducting the
distribution test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumScoreEAP(grp, ..., qwidth = 6, qpoints = 49L, .twotier = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumScoreEAP_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="sumScoreEAP_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="sumScoreEAP_+3A_qwidth">qwidth</code></td>
<td>
<p>DEPRECATED</p>
</td></tr>
<tr><td><code id="sumScoreEAP_+3A_qpoints">qpoints</code></td>
<td>
<p>DEPRECATED</p>
</td></tr>
<tr><td><code id="sumScoreEAP_+3A_.twotier">.twotier</code></td>
<td>
<p>whether to enable the two-tier optimization</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When two-tier covariance structure is detected, EAP scores are
only reported for primary factors. It is possible to compute EAP
scores for specific factors, but it is not clear why this would be
useful because they are conditional on the specific factor sum
scores. Moveover, the algorithm to compute them efficiently has not been
published yet (as of Jun 2014).
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>See Also</h3>

<p>Other scoring: 
<code><a href="#topic+EAPscores">EAPscores</a>()</code>,
<code><a href="#topic+bestToOmit">bestToOmit</a>()</code>,
<code><a href="#topic+itemOutcomeBySumScore">itemOutcomeBySumScore</a>()</code>,
<code><a href="#topic+observedSumScore">observedSumScore</a>()</code>,
<code><a href="#topic+omitItems">omitItems</a>()</code>,
<code><a href="#topic+omitMostMissing">omitMostMissing</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see Thissen, Pommerich, Billeaud, &amp; Williams (1995, Table 2)
 spec &lt;- list()
 spec[1:3] &lt;- list(rpf.grm(outcomes=4))

 param &lt;- matrix(c(1.87, .65, 1.97, 3.14,
                   2.66, .12, 1.57, 2.69,
                   1.24, .08, 2.03, 4.3), nrow=4)
 # fix parameterization
 param &lt;- apply(param, 2, function(p) c(p[1], p[2:4] * -p[1]))

 grp &lt;- list(spec=spec, mean=0, cov=matrix(1,1,1), param=param)
 sumScoreEAP(grp)
</code></pre>

<hr>
<h2 id='sumScoreEAPTest'>Conduct the sum-score EAP distribution test</h2><span id='topic+sumScoreEAPTest'></span>

<h3>Description</h3>

<p>Conduct the sum-score EAP distribution test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumScoreEAPTest(grp, ..., qwidth = 6, qpoints = 49L, .twotier = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumScoreEAPTest_+3A_grp">grp</code></td>
<td>
<p>a list containing the model and data. See the details section.</p>
</td></tr>
<tr><td><code id="sumScoreEAPTest_+3A_...">...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr><td><code id="sumScoreEAPTest_+3A_qwidth">qwidth</code></td>
<td>
<p>DEPRECATED</p>
</td></tr>
<tr><td><code id="sumScoreEAPTest_+3A_qpoints">qpoints</code></td>
<td>
<p>DEPRECATED</p>
</td></tr>
<tr><td><code id="sumScoreEAPTest_+3A_.twotier">.twotier</code></td>
<td>
<p>whether to enable the two-tier optimization</p>
</td></tr>
</table>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>


<h3>References</h3>

<p>Li, Z., &amp; Cai, L. (2018). Summed Score Likelihood-Based Indices for
Testing Latent Variable Distribution Fit in
Item Response Theory. <em>Educational and
Psychological Measurement, 78</em>(5), 857-886.
</p>


<h3>See Also</h3>

<p>Other diagnostic: 
<code><a href="#topic+ChenThissen1997">ChenThissen1997</a>()</code>,
<code><a href="#topic+SitemFit1">SitemFit1</a>()</code>,
<code><a href="#topic+SitemFit">SitemFit</a>()</code>,
<code><a href="#topic+multinomialFit">multinomialFit</a>()</code>,
<code><a href="#topic+rpf.1dim.fit">rpf.1dim.fit</a>()</code>
</p>

<hr>
<h2 id='tabulateRows'>Tabulate data.frame rows</h2><span id='topic+tabulateRows'></span>

<h3>Description</h3>

<p>Like <code>tabulate</code> but entire rows are the unit of tabulation.
The data.frame is not sorted, but must be sorted already.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tabulateRows(observed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tabulateRows_+3A_observed">observed</code></td>
<td>
<p>a sorted data.frame holding ordered factors in every column</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+orderCompletely">orderCompletely</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- as.data.frame(matrix(c(sample.int(2, 30, replace=TRUE)), 10, 3))
df &lt;- df[orderCompletely(df),]
tabulateRows(df)
</code></pre>

<hr>
<h2 id='toFactorLoading'>Convert response function slopes to factor loadings</h2><span id='topic+toFactorLoading'></span>

<h3>Description</h3>

<p>All slopes are divided by the ogive constant. Then the following
transformation is applied to the slope matrix,
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toFactorLoading(slope, ogive = rpf.ogive)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="toFactorLoading_+3A_slope">slope</code></td>
<td>
<p>a matrix with items in the columns and slopes in the rows</p>
</td></tr>
<tr><td><code id="toFactorLoading_+3A_ogive">ogive</code></td>
<td>
<p>the ogive constant (default <a href="#topic+rpf.ogive">rpf.ogive</a>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">\frac{\mathrm{slope}}{\left[ 1 + \mathrm{rowSums}(\mathrm{slope}^2) \right]^\frac{1}{2}}</code>
</p>



<h3>Value</h3>

<p>a factor loading matrix with items in the rows and factors in the columns
</p>


<h3>See Also</h3>

<p>Other factor model equivalence: 
<code><a href="#topic+fromFactorLoading">fromFactorLoading</a>()</code>,
<code><a href="#topic+fromFactorThreshold">fromFactorThreshold</a>()</code>,
<code><a href="#topic+toFactorThreshold">toFactorThreshold</a>()</code>
</p>

<hr>
<h2 id='toFactorThreshold'>Convert response function intercepts to factor thresholds</h2><span id='topic+toFactorThreshold'></span>

<h3>Description</h3>

<p>Convert response function intercepts to factor thresholds
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toFactorThreshold(intercept, slope, ogive = rpf.ogive)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="toFactorThreshold_+3A_intercept">intercept</code></td>
<td>
<p>a matrix with items in the columns and intercepts in the rows</p>
</td></tr>
<tr><td><code id="toFactorThreshold_+3A_slope">slope</code></td>
<td>
<p>a matrix with items in the columns and slopes in the rows</p>
</td></tr>
<tr><td><code id="toFactorThreshold_+3A_ogive">ogive</code></td>
<td>
<p>the ogive constant (default <a href="#topic+rpf.ogive">rpf.ogive</a>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a factor threshold matrix with items in the columns and factor thresholds in the rows
</p>


<h3>See Also</h3>

<p>Other factor model equivalence: 
<code><a href="#topic+fromFactorLoading">fromFactorLoading</a>()</code>,
<code><a href="#topic+fromFactorThreshold">fromFactorThreshold</a>()</code>,
<code><a href="#topic+toFactorLoading">toFactorLoading</a>()</code>
</p>

<hr>
<h2 id='write.flexmirt'>Write a flexMIRT PRM file</h2><span id='topic+write.flexmirt'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This was last updated in 2017 and may no longer work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.flexmirt(groups, file = NULL, fileEncoding = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.flexmirt_+3A_groups">groups</code></td>
<td>
<p>a list of groups each with items and latent parameters</p>
</td></tr>
<tr><td><code id="write.flexmirt_+3A_file">file</code></td>
<td>
<p>the destination file name</p>
</td></tr>
<tr><td><code id="write.flexmirt_+3A_fileencoding">fileEncoding</code></td>
<td>
<p>how to encode the text file (optional)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Formats item parameters in the way that flexMIRT expects to read
them.
</p>
<p>NOTE: Support for the graded response model may not be complete.
</p>


<h3>Format of a group</h3>

<p>A model, or group within a model, is represented as a named list.
</p>

<dl>
<dt>spec</dt><dd><p>list of response model objects</p>
</dd>
<dt>param</dt><dd><p>numeric matrix of item parameters</p>
</dd>
<dt>free</dt><dd><p>logical matrix of indicating which parameters are free (TRUE) or fixed (FALSE)</p>
</dd>
<dt>mean</dt><dd><p>numeric vector giving the mean of the latent distribution</p>
</dd>
<dt>cov</dt><dd><p>numeric matrix giving the covariance of the latent distribution</p>
</dd>
<dt>data</dt><dd><p>data.frame containing observed item responses, and optionally,
weights and frequencies</p>
</dd>
<dt>score</dt><dd><p>factors scores with response patterns in rows</p>
</dd>
<dt>weightColumn</dt><dd><p>name of the data column containing the numeric row weights (optional)</p>
</dd>
<dt>freqColumn</dt><dd><p>name of the data column containing the integral row frequencies (optional)</p>
</dd>
<dt>qwidth</dt><dd><p>width of the quadrature expressed in Z units</p>
</dd>
<dt>qpoints</dt><dd><p>number of quadrature points</p>
</dd>
<dt>minItemsPerScore</dt><dd><p>minimum number of non-missing items when estimating factor scores</p>
</dd>
</dl>

<p>The <code>param</code> matrix stores items parameters by column. If a
column has more rows than are required to fully specify a model
then the extra rows are ignored.  The order of the items in
<code>spec</code> and order of columns in <code>param</code> are assumed to
match. All items should have the same number of latent dimensions.
Loadings on latent dimensions are given in the first few rows and
can be named by setting rownames. Item names are assigned by
<code>param</code> colnames.
</p>
<p>Currently only a multivariate normal distribution is available,
parameterized by the <code>mean</code> and <code>cov</code>. If <code>mean</code> and
<code>cov</code> are not specified then a standard normal distribution is
assumed. The quadrature consists of equally spaced points. For
example, <code>qwidth=2</code> and <code>qpoints=5</code> would produce points
-2, -1, 0, 1, and 2. The quadrature specification is part of the
group and not passed as extra arguments for the sake of
consistency. As currently implemented, OpenMx uses EAP scores to
estimate latent distribution parameters. By default, the exact same
EAP scores should be produced by <a href="#topic+EAPscores">EAPscores</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
