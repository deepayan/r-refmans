<!DOCTYPE html><html><head><title>Help for package betaper</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {betaper}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adonis_pertables'>
<p>Function to assess the efects of taxonomic uncertainty on permutational multivariate analysis of variance using distance matrices</p></a></li>
<li><a href='#Amazonia'><p> Tree abundance and soil data in Western Amazonia</p></a></li>
<li><a href='#cca_pertables'>
<p>Function to assess the efects of taxonomic uncertainty on [Partial] Constrained Correspondence Analysis</p></a></li>
<li><a href='#HCP'><p> Tree counts in tropical montane forest fragments</p></a></li>
<li><a href='#mantel_pertables'>
<p>Function to assess the efects of taxonomic uncertainty on Mantel tests</p></a></li>
<li><a href='#pertables'>
<p>Function to incorporate the effect of taxonomic uncertainty on multivariate analyses of ecological data.</p></a></li>
<li><a href='#rda_pertables'>
<p>Function to assess the efects of taxonomic uncertainty on [Partial] Redundance Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Taxonomic Uncertainty on Multivariate Analyses of Ecological
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Luis Cayuela and Marcelino de la Cruz</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luis Cayuela &lt;luis.cayuela@urjc.es&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>vegan, parallel</td>
</tr>
<tr>
<td>Description:</td>
<td>Permutational method to incorporate taxonomic uncertainty  and some functions to assess its effects on parameters of some widely used multivariate methods in ecology, as explained in Cayuela et al. (2011) &lt;<a href="https://doi.org/10.1111%2Fj.1600-0587.2009.05899.x">doi:10.1111/j.1600-0587.2009.05899.x</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-24 16:23:16 UTC; marcelino</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-24 17:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='adonis_pertables'> 
Function to assess the efects of taxonomic uncertainty on permutational multivariate analysis of variance using distance matrices
</h2><span id='topic+adonis_pertables'></span><span id='topic+print.adonis_pertables'></span><span id='topic+plot.adonis_pertables'></span>

<h3>Description</h3>

<p>This function asses the effects of taxonomic uncertainty on the R2 coefficients and the p-values of a permutational multivariate analysis of variance using distance matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adonis_pertables(formula = X ~ ., data, permutations = 5, method = "bray")
## S3 method for class 'adonis_pertables'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adonis_pertables_+3A_formula">formula</code></td>
<td>
<p>A typical model formula such as 'Y ~ A + B*C', but where 'Y' is a pertables object (i.e. a list of simulated community data matrices obtained with <code><a href="#topic+pertables">pertables</a></code>; 'A', 'B', and 'C' may be factors or continuous variables.</p>
</td></tr>
<tr><td><code id="adonis_pertables_+3A_data">data</code></td>
<td>
<p>The data frame from which 'A', 'B', and 'C' would be drawn.</p>
</td></tr>
<tr><td><code id="adonis_pertables_+3A_permutations">permutations</code></td>
<td>
<p>Number of replicate permutations used for the hypothesis tests (F tests) for each simulated community data matrices obtained with <code>pertables</code>.</p>
</td></tr>
<tr><td><code id="adonis_pertables_+3A_method">method</code></td>
<td>
<p>The name of any method used in 'vegdist' to calculate pairwise distances.</p>
</td></tr>
<tr><td><code id="adonis_pertables_+3A_x">x</code></td>
<td>
<p><code>adonis_pertables</code> object to plot.</p>
</td></tr>
<tr><td><code id="adonis_pertables_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters passed to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>adonis_pertables</code> returns an object of class<code>adonis_pertables</code>, basically a list with the following components:
</p>
<table>
<tr><td><code>raw</code></td>
<td>
<p>An object of class <code>adonis</code>, i.e. the results of applying <code><a href="vegan.html#topic+mantel">mantel</a></code> to the original biological data table without the unidentified species. This includes p-values for each explanatory variable showing the probability of obtaining the same F statistic under different scenarios of taxonomic uncertainty.</p>
</td></tr>
<tr><td><code>simulation</code></td>
<td>
<p>A list with the results of the simulation: <code>F</code>, i.e. a data.frame with all the simulated pseudo-F (columns) for each explanatory variable (rows); <code>R2</code>, i.e. a data.frame with all the simulated R2 coefficients (columns) for each explanatory variable (rows); <code>pvalue</code>, i.e. a data.frame with all the simulated p-values (columns) for each explanatory variable (rows); <code>R2.quant</code>, i.e. a data.frame with the summary of <code>R2</code> by quantiles; <code>p.quant</code>,, i.e. a data.frame with the summary of <code>pvalue</code> by quantiles.</p>
</td></tr>
</table>
<p>The objects of class <code>adonis_pertables</code> have  <code>print</code> and <code>plot</code> S3 methods for a simple access to results. See the examples. 
</p>


<h3>Author(s)</h3>

<p>Luis Cayuela and Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Cayuela, L., De la Cruz, M. and Ruokolainen, K. (2011). A method to incorporate the effect of taxonomic uncertainty on multivariate analyses of ecological data. <em>Ecography</em>, 34: 94-102. <a href="http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x">http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x</a>.   
</p>


<h3>See Also</h3>

<p><code>pertables</code>, <code><a href="vegan.html#topic+adonis">adonis</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> 


data(Amazonia)
data(soils)

# Define a new index that includes the terms used in the \code{Amazonia} dataset to define
# undetermined taxa at different taxonomic levels

index.Amazon &lt;- c(paste("sp.", rep(1:20), sep=""), "Indet.", "indet.")

# Generate a pertables object (i.e. a list of biological data tables simulated from taxonomic
# uncertainty)
 ## Not run: 
Amazonia100 &lt;- pertables(Amazonia, index=index.Amazon, nsim=100)

# Assess the effects of taxonomic uncertainty on a PERMANOVA (i.e., adonis) test:

Amazonia.adonis &lt;- adonis_pertables(Amazonia100 ~ Ca + K + Mg + Na, data=soils)

Amazonia.adonis

plot(Amazonia.adonis)

## End(Not run)
# Fast example for Rcheck

Amazonia4.p2 &lt;- pertables.p2(Amazonia[1:50,], index=index.Amazon, nsim=4, ncl=2, iseed=4)
set.seed(2)
Amazonia.adonis &lt;- adonis_pertables(Amazonia4.p2  ~ Ca + K + Mg + Na, data=soils)

Amazonia.adonis

plot(Amazonia.adonis)

</code></pre>

<hr>
<h2 id='Amazonia'> Tree abundance and soil data in Western Amazonia</h2><span id='topic+Amazonia'></span><span id='topic+soils'></span>

<h3>Description</h3>

<p>The <code>Amazonia</code> data frame has tree counts in nine 0.16-hectare inventory plots in Western Amazonia. <code>soils</code> contains data on soil
cations at each location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Amazonia)
data(soils)
</code></pre>


<h3>Format</h3>

<p><code>Amazonia</code> is a data frame with 1188 observations (species) and 12 columns (taxonomic descripcion and sites). The three first columns 
refer to family, genus and specific species Latin names. Columns 4 to 12 have tree abundance data for nine inventory plots.
</p>
<p><code>soils</code> is a data frame with 9 observations (inventory plots) and 4 columns (variables). Soil variables (Ca, K, Mg, Na) are given in cmol/kg.
</p>


<h3>Details</h3>

<p>Data from Western Amazonia includes tree inventories at nine lowland sites (approximately 100-150 m above sea level) near Iquitos, Peru. 
The sites were selected to represent regional variations in geology and were distributed along a soil nutrient gradient ranging from poor 
loamy soils to richer clayey soils. Each inventory consisted of 20 x 20 m plots (0.16 ha total area) distributed along 1.3-km transects. 
At each site, K. Ruokolainen and colleagues identified to species or morphospecies all woody, free-standing stems of &gt; 2.5 cm dbh. The 
full inventories sampled 3980 individuals from 1188 species or morphospecies.
</p>


<h3>References</h3>

<p>Higgins, M.A. &amp; Ruokolainen, K. 2004. Rapid tropical forest inventory: a comparison of techniques based on inventory data from western 
Amazonia. <em>Conservation Biology</em> 18(3): 799-811.
</p>
<p>Ruokolainen, K., Tuomisto, H., Macia, M.J., Higgins, M.A. &amp; Yli-Halla, M. 2007. Are floristic and edaphic patterns in Amazonian rain forests 
congruent for trees, pteridophytes and Melastomataceae? <em>Journal of Tropical Ecology</em> 23: 13-25.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Amazonia)
data(soils)
</code></pre>

<hr>
<h2 id='cca_pertables'>
Function to assess the efects of taxonomic uncertainty on [Partial] Constrained Correspondence Analysis
</h2><span id='topic+cca_pertables'></span><span id='topic+plot.cca_pertables'></span><span id='topic+print.cca_pertables'></span>

<h3>Description</h3>

<p>This function asses the effects of taxonomic uncertainty on two widely used parameters of a [Partial] Constrained Correspondence Analysis, i.e. the 'percentage explained variance' (sometimes referred to as <em>R-squared</em>) and the <em>pseudo-F</em>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cca_pertables(fml, data,  scale = FALSE,...)
## S3 method for class 'cca_pertables'
 plot(x, pch = 18, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cca_pertables_+3A_fml">fml</code></td>
<td>

<p>Model formula, where the left hand side gives a pertables object (i.e. a list of simulated community data matrices obtained with <code><a href="#topic+pertables">pertables</a></code>, right hand side gives the constraining variables, and conditioning variables can be given within a special function <code>Condition</code>.
</p>
</td></tr>
<tr><td><code id="cca_pertables_+3A_data">data</code></td>
<td>

<p>Data frame containing the variables on the right hand side of the model formula.
</p>
</td></tr>
<tr><td><code id="cca_pertables_+3A_scale">scale</code></td>
<td>

<p>Scale species to unit variance (like correlations).
</p>
</td></tr>
<tr><td><code id="cca_pertables_+3A_x">x</code></td>
<td>
<p><code>cca_pertables</code> object to plot.
</p>
</td></tr>
<tr><td><code id="cca_pertables_+3A_pch">pch</code></td>
<td>
<p>Plotting 'character', i.e., symbol to use in the CCA plot. See  <code><a href="graphics.html#topic+points">points</a></code> for examples of use of this graphical argument.</p>
</td></tr>
<tr><td><code id="cca_pertables_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters passed to plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper to submit a <code><a href="#topic+pertables">pertables</a></code> object to <code><a href="vegan.html#topic+cca">cca</a></code> function of the <span class="pkg">vegan</span> package. See the documentation of <code><a href="vegan.html#topic+cca">cca</a></code> for details about <code>formula</code> and <code>Condition</code> use.</p>


<h3>Value</h3>

<p><code>cca_pertables</code> returns  an object of class <code>cca_pertables</code>, basically a list with the following components:
</p>
<table>
<tr><td><code>raw</code></td>
<td>
<p>An object of class class<code>cca</code>. The results of applying <code><a href="vegan.html#topic+cca">cca</a></code> to the original biological data table without the unidentified species.</p>
</td></tr>
<tr><td><code>simulation</code></td>
<td>
<p>A list with the results of the simulation: <code>results</code>, i.e. a data.frame with all the simulated R-squared and pseudo-F values; <code>cca.quant</code>, i.e. a data.frame with the summary of <code>results</code> by quantiles; <code>sites</code> i.e. a list with the scores of  the sites of all the simulated data tables and <code>biplot</code>, i.e.  a list with the scores of the environmental data in all the analyses</p>
</td></tr>
</table>
<p>The objects of class <code>cca_pertables</code> have <code>print</code> and <code>plot</code> S3 methods for a simple access to results. See the examples. 
</p>


<h3>Author(s)</h3>

<p>Luis Cayuela and Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Cayuela, L., De la Cruz, M. and Ruokolainen, K. (2011). A method to incorporate the effect of taxonomic uncertainty on multivariate analyses of ecological data. <em>Ecography</em>, 34: 94-102. <a href="http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x">http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x</a>.   
</p>


<h3>See Also</h3>

<p><code>pertables</code>, <code><a href="vegan.html#topic+cca">cca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(Amazonia)
data(soils)

# Define a new index that includes the terms used in the \code{Amazonia} dataset to define
# undetermined taxa at different taxonomic levels

index.Amazon &lt;- c(paste("sp.", rep(1:20), sep=""), "Indet.", "indet.")

# Generate a pertables object (i.e. a list of biological data tables simulated from taxonomic
# uncertainty)
  ## Not run: 

Amazonia100 &lt;- pertables(Amazonia, index=index.Amazon, nsim=100)

# Assess the effects of taxonomic uncertainty on a CCA analysis of biological data explained
# by all the environmental variables of the soil data:

Amazonia.cca &lt;- cca_pertables(Amazonia100 ~., data=soils)

Amazonia.cca

plot(Amazonia.cca)

## End(Not run)
# Fast example for Rcheck

Amazonia4.p2 &lt;- pertables.p2(Amazonia[1:50,], index=index.Amazon, nsim=4, ncl=2, iseed=4)
set.seed(2)
Amazonia.cca &lt;- cca_pertables(Amazonia4.p2 ~., data=soils)
Amazonia.cca

plot(Amazonia.cca)

</code></pre>

<hr>
<h2 id='HCP'> Tree counts in tropical montane forest fragments</h2><span id='topic+HCP'></span><span id='topic+HCP.coords'></span>

<h3>Description</h3>

<p><code>HCP</code> has tree abundance data from 16 forest fragments located in the Highlands of Chiapas, southern Mexico. <code>HCP.coords</code> 
contains the geographical UTM coordinates for the 16 forest fragments' centroids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HCP)
data(HCP.coords)	
</code></pre>


<h3>Format</h3>

<p><code>HCP</code> is a data frame with 231 observations and 19 variables. The three first columns contain family, genus and specific species Latin 
names. Columns 4 to 19 have tree abundance data for the 16 forest fragments. <code>HCP.coords</code> is a data frame with two columns and 16 rows.
</p>


<h3>References</h3>

<p>Cayuela, L., Golicher, D.J., Rey Benayas, J.M., Gonzalez-Espinosa, M. &amp; Ramirez-Marcial, N. 2006. Fragmentation, disturbance and tree diversity 
conservation in tropical montane forests. <em>Journal of Applied Ecology</em> 43: 1172-1181.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HCP)
data(HCP.coords)
</code></pre>

<hr>
<h2 id='mantel_pertables'>
Function to assess the efects of taxonomic uncertainty on Mantel tests
</h2><span id='topic+mantel_pertables'></span><span id='topic+plot.mantel_pertables'></span><span id='topic+print.mantel_pertables'></span>

<h3>Description</h3>

<p>This function asses the effects of taxonomic uncertainty on the coefficient of correlation and the p-values of a Mantel test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mantel_pertables(pertab, env, dist.method = "bray", binary = FALSE,
			cor.method = "pearson", permutations = 100)
## S3 method for class 'mantel_pertables'
 plot(x, xlab = "Environmental distance",
			ylab = "Sorensen's similarity index", pch = 19, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mantel_pertables_+3A_pertab">pertab</code></td>
<td>

<p>A pertables object (i.e. a list of simulated community data matrices obtained with <code><a href="#topic+pertables">pertables</a></code>.
</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_env">env</code></td>
<td>

<p>Data frame with the environmental variables.
</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_dist.method">dist.method</code></td>
<td>

<p>Method to compute the dissimilarity matrices from the biological and environmental data tables. One of the methods described in  function <code><a href="vegan.html#topic+vegdist">vegdist</a></code> of the package <span class="pkg">vegan</span>.
</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_binary">binary</code></td>
<td>

<p>Value for the argument <code>binary</code> in the function <code><a href="vegan.html#topic+vegdist">vegdist</a></code> of the package <span class="pkg">vegan</span>.
</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_cor.method">cor.method</code></td>
<td>

<p>Correlation method, as accepted by <code><a href="stats.html#topic+cor">cor</a></code>: &quot;pearson&quot;, &quot;spearman&quot; or &quot;kendall&quot;. 
</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_permutations">permutations</code></td>
<td>

<p>Number of permutations in assessing significance.
</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_x">x</code></td>
<td>

<p><code>mantel_pertables</code> object to plot.
</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_xlab">xlab</code></td>
<td>

<p>Label to name x-axis
</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_ylab">ylab</code></td>
<td>

<p>Label to name y-axis
</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_pch">pch</code></td>
<td>
<p>Plotting 'character', i.e., symbol to use in the distance decay plot. See  <code><a href="graphics.html#topic+points">points</a></code> for examples of use of this graphical argument.</p>
</td></tr>
<tr><td><code id="mantel_pertables_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters passed to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mantel_pertables</code> returns an object of class<code>mantel_pertables</code>, basically a list with the following components:
</p>
<table>
<tr><td><code>mantel</code></td>
<td>
<p>A list with two components: <code>mantel.raw</code>, an object of class <code>'mantel'</code>, i.e. the results of applying <code><a href="vegan.html#topic+mantel">mantel</a></code> to the original biological data table without the unidentified species, and <code>ptax</code>, a p-value showing the probability of obtaining the same mantel statistic under different scenarios of taxonomic uncertainty.</p>
</td></tr>
<tr><td><code>simulation</code></td>
<td>
<p>A list with the results of the simulation: <code>results</code>, i.e. a data.frame with all the simulated mantel statistics and p-values; <code>mantel.quant</code>, i.e. a data.frame with the summary of <code>results</code> by quantiles; <code>vegdist</code>, i.e. a list with all the dissimilarity matrices employed.</p>
</td></tr>
</table>
<p>The objects of class <code>mantel_pertables</code> have <code>print</code> and <code>plot</code> S3 methods for a simple access to results. See the examples. 
</p>


<h3>Author(s)</h3>

<p>Luis Cayuela and Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Cayuela, L., De la Cruz, M. and Ruokolainen, K. (2011). A method to incorporate the effect of taxonomic uncertainty on multivariate analyses of ecological data. <em>Ecography</em>, 34: 94-102. <a href="http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x">http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x</a>.   
</p>


<h3>See Also</h3>

<p><code>pertables</code>, <code><a href="vegan.html#topic+mantel">mantel</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>


data(Amazonia)
data(soils)

# Define a new index that includes the terms used in the \code{Amazonia} dataset to define
# undetermined taxa at different taxonomic levels

index.Amazon &lt;- c(paste("sp.", rep(1:20), sep=""), "Indet.", "indet.")

## Not run: 
# Generate a pertables object (i.e. a list of biological data tables simulated from taxonomic
# uncertainty)

Amazonia100 &lt;- pertables(Amazonia, index=index.Amazon, nsim=100)

# Assess the effects of taxonomic uncertainty on a Mantel test of biological dissimilarity
# correlated to soil dissimilarity among sites:

Amazonia.mantel &lt;- mantel_pertables(pertab=Amazonia100, env=soils, dist.method = "bray")

Amazonia.mantel

plot(Amazonia.mantel)

## End(Not run)
# Fast example for Rcheck

Amazonia4.p2 &lt;- pertables.p2(Amazonia[1:50,], index=index.Amazon, nsim=4, ncl=2, iseed=4)
set.seed(2)
Amazonia.mantel &lt;- mantel_pertables(pertab=Amazonia4.p2, env=soils, dist.method = "bray")

Amazonia.mantel

plot(Amazonia.mantel)

</code></pre>

<hr>
<h2 id='pertables'>
Function to incorporate the effect of taxonomic uncertainty on multivariate analyses of ecological data.
</h2><span id='topic+pertables'></span><span id='topic+pertables.p2'></span><span id='topic+print.pertables'></span>

<h3>Description</h3>

<p>This function implements a permutational method to incorporate taxonomic uncertainty on multivariate analyses typically used in the analysis of ecological data. The procedure is based on iterative randomizations that randomly re-assign non identified species in each site to any of the other species found in the remaining sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pertables(data, index = NULL, nsim = 100)
pertables.p2(data, index = NULL, nsim = 100, ncl=2, iseed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pertables_+3A_data">data</code></td>
<td>

<p>Community data matrix. The three first columns are factors referring to the family, genus and species specific names. 
The remaining columns are numeric vectors indicating species abundances at each site. 
</p>
</td></tr>
<tr><td><code id="pertables_+3A_index">index</code></td>
<td>

<p>List of additional parameters to determine the level at which species have been identified. Default values include 'Indet', 
'indet', 'sp', 'sp1' to 'sp100', 'sp 1' to 'sp 100', &rdquo;, and ' '.
</p>
</td></tr>
<tr><td><code id="pertables_+3A_nsim">nsim</code></td>
<td>

<p>Number of simulations of species' identities, i.e., number of data tables to simulate.
</p>
</td></tr>
<tr><td><code id="pertables_+3A_ncl">ncl</code></td>
<td>

<p>Number of clusters for parallel simulation.
</p>
</td></tr>
<tr><td><code id="pertables_+3A_iseed">iseed</code></td>
<td>

<p>An integer to be supplied to clusterSetRNGStream, or NULL not to set reproducible seeds.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The procedure is implemented in two sequential steps:
</p>
<p>Step 1. Morphospecies identified only to genus are randomly re-assigned with the same probability within the group of species and morphospecies that share the same genus, provided they are not found in the same sites. In the re-assignment of the species identity, the species considered can also receive its own identity. For instance, let's assume we have three floristic inventories. In site A we have <em>Eugenia sp1</em> and <em>E. nesiotica</em>. In site B we have <em>Eugenia nesiotica</em>, <em>E. principium</em> and <em>E. salamensis</em>. In site C we have <em>Eugenia sp2</em> and <em>E. salamensis</em>. <em>Eugenia sp1</em> can be thus re-identified with equal probability as <em>Eugenia sp2, E. principium, E. salamensis</em> or just maintain its own identity (<em>Eugenia sp1</em>). In the latter case, this means that we assume that <em>E. sp1</em> is a completely different species, although we do not know its true identity. On the contrary, we cannot re-identify <em>E. sp1</em> as <em>E. nesiotica</em> because they were found in the same site, so we are quite certain that <em>E. sp1</em> is different from <em>E. nesiotica</em>. The same is applied to species identified only to family and fully unidentified species. Note that when collating inventories from different researchers, we must rename all unidentified species. This is because two researchers can use the same label, e.g. <em>Eugenia sp1</em>, even though this name does not necessarily refer to the same species. For a verification of the biological identity of <em>Eugenia sp1</em> one would need to cross-check the vouchers bearing the same name.
</p>
<p>Step 2. Step 1 is iterated <em>nsim</em> times. As a result, <em>nsim</em> matrices are obtained, all of which contain the same number of sites but variable number of species depending on the resulting re-assignment of morphospecies, The process can be time-consuming if community data matrices are large.
</p>
<p>Function <code>pertables.p2</code> implements a parallelized version which considerably reduces computation time.
</p>


<h3>Value</h3>

<p>The function return a list of class <code>pertables</code> with the following components
</p>
<table>
<tr><td><code>taxunc</code></td>
<td>
<p>Summary of the number of species fully identified (0), identified to genus (1), identified to family (2), or fully undetermined (3).</p>
</td></tr>
<tr><td><code>pertables</code></td>
<td>
<p>A list with all the simulated data matrices.</p>
</td></tr>
<tr><td><code>raw</code></td>
<td>
<p>The raw data matrix, without the unidentified especies.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Cayuela and Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Cayuela, L., De la Cruz, M. and Ruokolainen, K. (2011). A method to incorporate the effect of taxonomic uncertainty on multivariate analyses of ecological data. <em>Ecography</em>, 34: 94-102. <a href="http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x">http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x</a>.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Amazonia)
data(soils)

# Define a new index that includes the terms used in the \code{Amazonia} dataset to define
# undetermined taxa at different taxonomic levels

index.Amazon &lt;- c(paste("sp.", rep(1:20), sep=""), "Indet.", "indet.")

#Generate a pertables object (i.e. a list of biological data tables simulated from taxonomic
# uncertainty)
 
 ## Not run: 
# compare prformance of pertables and pertables.p2
nsim &lt;-100
ncl &lt;-2
gc()
t0&lt;- Sys.time()
 Amazonia100&lt;- pertables(Amazonia, index=index.Amazon, nsim=nsim)
 Sys.time()-t0
gc()
t0&lt;- Sys.time()
 Amazonia100.p2&lt;- pertables.p2(Amazonia, index=index.Amazon, nsim=nsim, ncl=ncl)
 Sys.time()-t0

## End(Not run)
# Example for Rcheck

Amazonia4.p2&lt;- pertables.p2(Amazonia, index=index.Amazon, nsim=4, ncl=2)

</code></pre>

<hr>
<h2 id='rda_pertables'>
Function to assess the efects of taxonomic uncertainty on [Partial] Redundance Analysis
</h2><span id='topic+rda_pertables'></span><span id='topic+plot.rda_pertables'></span><span id='topic+print.rda_pertables'></span>

<h3>Description</h3>

<p>This function asses the effects of taxonomic uncertainty on two widely used parameters of a [Partial] Redundance Analysis, i.e. the 'percentage explained variance' (sometimes referred to as <em>R-squared</em>) and the <em>'pseudo-F' </em>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rda_pertables(fml, data, scale=FALSE,...)
## S3 method for class 'rda_pertables'
 plot(x, pch = 18, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rda_pertables_+3A_fml">fml</code></td>
<td>

<p>Model formula, where the left hand side gives a pertables object (i.e. a list of simulated community data matrices obtained with <code><a href="#topic+pertables">pertables</a></code>,  right hand side gives the constraining variables, and conditioning variables can be given within a special function <code>Condition</code>.
</p>
</td></tr>
<tr><td><code id="rda_pertables_+3A_data">data</code></td>
<td>

<p>Data frame containing the variables on the right hand side of the model formula.
</p>
</td></tr>
<tr><td><code id="rda_pertables_+3A_scale">scale</code></td>
<td>

<p>Scale species to unit variance (like correlations).
</p>
</td></tr>
<tr><td><code id="rda_pertables_+3A_x">x</code></td>
<td>
<p>rda_pertables object to plot.
</p>
</td></tr>
<tr><td><code id="rda_pertables_+3A_pch">pch</code></td>
<td>
<p>Plotting 'character', i.e., symbol to use in the RDA plot. See  <code><a href="graphics.html#topic+points">points</a></code> for examples of use of this graphical argument.</p>
</td></tr>
<tr><td><code id="rda_pertables_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters passed to plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper to submit a <code><a href="#topic+pertables">pertables</a></code> object to <code>rda</code> function of the <span class="pkg">vegan</span> package. See the documentation of <code><a href="vegan.html#topic+cca">cca</a></code> for details about <code>formula</code> and <code>Condition</code> use. </p>


<h3>Value</h3>

<p><code>rda_pertables</code> returns  an object of class<code>'rda_pertables'</code>, basically a list with the following components:
</p>
<table>
<tr><td><code>raw</code></td>
<td>
<p>An object of class class<code>'rda'</code>. The results of applying <code>rda</code> to the original biological data table without the unidentified species.</p>
</td></tr>
<tr><td><code>simulation</code></td>
<td>
<p>A list with the results of the simulation: <code>'results'</code>, i.e. a data.frame with all the simulated R-squared and pseudo-F values; <code>'rda.quant'</code>, i.e. a data.frame with the summary of <code>'results'</code> by quantiles; <code>'sites'</code> i.e. a list with the scores of  the sites of all the simulated data tables and  <code>'biplot'</code>, i.e.  a list with the scores of the environmental data in all the analyses</p>
</td></tr>
</table>
<p>The objects of class <code>'rda_pertables'</code> have  <code>print</code>  and <code>plot</code> S3 methods for a simple access to results. See the examples. 
</p>


<h3>Author(s)</h3>

<p>Luis Cayuela and Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Cayuela, L., De la Cruz, M. and Ruokolainen, K. (2011). A method to incorporate the effect of taxonomic uncertainty on multivariate analyses of ecological data. <em>Ecography</em>, 34: 94-102. <a href="http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x">http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x</a>.   
</p>


<h3>See Also</h3>

<p><code>pertables</code>, <code><a href="vegan.html#topic+cca">cca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> 


data(Amazonia)
data(soils)

# Define a new index that includes the terms used in the \code{Amazonia} dataset to define
# undetermined taxa at different taxonomic levels

index.Amazon &lt;- c(paste("sp.", rep(1:20), sep=""), "Indet.", "indet.")


#Generate a pertables object (i.e. a list of biological data tables simulated from taxonomic
# uncertainty)
 ## Not run: 
Amazonia100 &lt;- pertables(Amazonia, index=index.Amazon, nsim=100)

# Assess the effects of taxonomic uncertainty on a RDA analysis of biological data explained
# by all the environmental variables of the soil data:

Amazonia.rda &lt;- rda_pertables(Amazonia100 ~., data=soils)

Amazonia.rda

plot(Amazonia.rda)
 

## End(Not run)

# Fast example for Rcheck

Amazonia4.p2 &lt;- pertables.p2(Amazonia[1:50,], index=index.Amazon, nsim=4, ncl=2, iseed=4)
set.seed(2)
Amazonia.rda &lt;- rda_pertables(Amazonia4.p2 ~., data=soils)

Amazonia.rda

plot(Amazonia.rda)
 

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
