<!DOCTYPE html><html><head><title>Help for package UpSetVP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {UpSetVP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#UpSetVP-package'><p>Visualization of Variation Partitioning and Hierarchical Partitioning</p></a></li>
<li><a href='#baima'><p>EcM Fungal Data with Environmental Variables</p></a></li>
<li><a href='#barplot_hp'><p>Visualization of HP Using Column Diagram</p></a></li>
<li><a href='#upset_vp'><p>Visualization of VPA and HP Using UpSetVP Diagram</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>An Alternative Visualization of VPA and HP in Canonical Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Yao Liu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yao Liu &lt;lyao222lll@nwafu.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Using matrix layout to visualize the unique, common, or individual contribution of each predictor (or matrix of predictors) towards explained variation on canonical analysis. These contributions were derived from variance partitioning analysis (VPA) and hierarchical partitioning (HP), applying the algorithm of Lai J., Zou Y., Zhang J., Peres-Neto P. (2022) Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package.Methods in Ecology and Evolution, 13: 782-788 &lt;<a href="https://doi.org/10.1111%2F2041-210X.13800">doi:10.1111/2041-210X.13800</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/LiuXYh/UpSetVP">https://github.com/LiuXYh/UpSetVP</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/LiuXYh/UpSetVP/issues">https://github.com/LiuXYh/UpSetVP/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rdacca.hp, ggplot2, patchwork, grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>adespatial</td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-30</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-30 15:20:22 UTC; dell</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-03 10:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='UpSetVP-package'>Visualization of Variation Partitioning and Hierarchical Partitioning</h2><span id='topic+UpSetVP'></span><span id='topic+UpSetVP-package'></span>

<h3>Description</h3>

<p>UpSetVP using UpSet matrix layout to visualize the unique, common and individual contribution of each predictor (or matrix) towards explained variation on canonical analysis.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/LiuXYh/UpSetVP">https://github.com/LiuXYh/UpSetVP</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/LiuXYh/UpSetVP/issues">https://github.com/LiuXYh/UpSetVP/issues</a>
</p>
</li></ul>


<hr>
<h2 id='baima'>EcM Fungal Data with Environmental Variables</h2><span id='topic+baima'></span><span id='topic+baima.fun'></span><span id='topic+baima.env'></span>

<h3>Description</h3>

<p>Ectomycorrhizal (EcM) fungal community and environmental data were excerpted from Gong et al. (2022). Sampling was conducted along the elevation gradient (2,900 m to 4,500 m) in the eastern slope of Baima Snow Mountain during both dry (November 2017) and wet (August 2018) seasons after studying community compositions of the host plants of EcM fungi.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(baima.fun)

data(baima.env)
</code></pre>


<h3>Format</h3>

<p>263 samples from the root tips were excerpted. There are two linked data sets: <code>baima.fun</code>, a data frame containing 3,099 amplicon sequence variants (ASVs) of root associated EcM fungi; <code>baima.env</code>, a data frame containing 14 environmental variables.
</p>
<p>The fields in the environmental data are:
</p>

<dl>
<dt>environmental_medium</dt><dd><p>Sample type</p>
</dd>
<dt>latitude</dt><dd><p>Latitude</p>
</dd>
<dt>lontitude</dt><dd><p>Lontitude</p>
</dd>
<dt>altitude</dt><dd><p>Elevation (m)</p>
</dd>
<dt>season</dt><dd><p>Season, a factor with levels <code>dry</code> and <code>wet</code></p>
</dd>
<dt>em.GR</dt><dd><p>Richness of EcM plant at genus level</p>
</dd>
<dt>em.abun</dt><dd><p>The number of individuals of each EcM genus</p>
</dd>
<dt>sea.MT</dt><dd><p>Dry-season and wet-season mean temperature</p>
</dd>
<dt>pH</dt><dd><p>Soil pH</p>
</dd>
<dt>TP</dt><dd><p>Total phosphorus (g/kg)</p>
</dd>
<dt>TK</dt><dd><p>Total potassium (g/kg)</p>
</dd>
<dt>AN</dt><dd><p>Alkaline-hydrolysable nitrogen (mg/kg)</p>
</dd>
<dt>AP</dt><dd><p>Available phosphorus (mg/kg)</p>
</dd>
<dt>AK</dt><dd><p>Available potassium (mg/kg)</p>
</dd>
</dl>



<h3>References</h3>

<p>Gong S, Feng B, Jian S P, et al. Elevation Matters More than Season in Shaping the Heterogeneity of Soil and Root Associated Ectomycorrhizal Fungal Community. Microbiology spectrum, 2022, 10(1): e01950-21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(baima.fun)
data(baima.env)
</code></pre>

<hr>
<h2 id='barplot_hp'>Visualization of HP Using Column Diagram</h2><span id='topic+barplot_hp'></span>

<h3>Description</h3>

<p>Visualization of individual effects in hierarchical partitioning (HP) using column diagram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>barplot_hp(
  x,
  order.var = TRUE,
  decreasing.var = TRUE,
  cutoff = -1,
  col.fill = "valid",
  col.color = NULL,
  col.width = 0.6,
  show.effect = TRUE,
  effect.cex = 2.7,
  title.cex = 10,
  axis.cex = 8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barplot_hp_+3A_x">x</code></td>
<td>
<p>A <code><a href="rdacca.hp.html#topic+rdacca.hp">rdacca.hp</a></code> object, which contains the output of HP from canonical analysis.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_order.var">order.var</code></td>
<td>
<p>The predictors in the matrix layout should be ordered by. Default is <code>TRUE</code>, which orders the predictors by their effect values. IF <code>FALSE</code>, sort by the order of predictors in input data.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_decreasing.var">decreasing.var</code></td>
<td>
<p>If <code>order.var=TRUE</code>, how the predictors should be ordered. Default is <code>TRUE</code>, from greatest to least.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_cutoff">cutoff</code></td>
<td>
<p>Effect values below <code>cutoff</code> will not be displayed, default is <code>-1</code>. Note: Negative values due to adjustment of R-squared mean negligible contributions, but they are included in the computation of the total contribution of each predictor category.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_col.fill">col.fill</code></td>
<td>
<p>How the bars should be colored. Options include <code>"valid"</code> (according to the validity of effects) or <code>"vars"</code> (color by predictors), default is <code>"valid"</code>.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_col.color">col.color</code></td>
<td>
<p>Color of bars.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_col.width">col.width</code></td>
<td>
<p>Width of bars, default is <code>0.6</code>.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_show.effect">show.effect</code></td>
<td>
<p>Show the effect values above bars, default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_effect.cex">effect.cex</code></td>
<td>
<p>Font size of the effect values, default is <code>2.7</code>.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_title.cex">title.cex</code></td>
<td>
<p>Font size of axis titles, default is <code>10</code>.</p>
</td></tr>
<tr><td><code id="barplot_hp_+3A_axis.cex">axis.cex</code></td>
<td>
<p>Font size of axis labels, default is <code>8</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to visualize the object of <code><a href="rdacca.hp.html#topic+rdacca.hp">rdacca.hp</a></code> (Lai et al. 2022), which calculates the individual effects of predictor variables or groups of predictor variables in canonical analysis based on HP.
</p>


<h3>Value</h3>

<p>Returns a ggplot2.
</p>


<h3>References</h3>

<p>Lai J, Zou Y, Zhang J, et al. Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package. Methods in Ecology and Evolution, 2022.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(rdacca.hp)

## A simple example of partial dbRDA
data(baima.fun)
data(baima.env)

# Bray-Curtis index was used to calculate community composition dissimilarity
baima.fun.bray &lt;- vegdist(baima.fun, method = "bray")

# Quantify the individual effects of soil properties on EcM fungal community composition
soil &lt;- baima.env[c("pH", "TP", "TK", "AN", "AP", "AK")]
baima.soil.vp &lt;- rdacca.hp(baima.fun.bray, soil, method = "dbRDA", type = "adjR2")

# Plot individual effects
barplot_hp(baima.soil.vp, col.fill = "var", 
 col.color = c("#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69"))

</code></pre>

<hr>
<h2 id='upset_vp'>Visualization of VPA and HP Using UpSetVP Diagram</h2><span id='topic+upset_vp'></span>

<h3>Description</h3>

<p>Visualization of variance partitioning analysis (VPA) and hierarchical partitioning (HP) with unlimited number of predictor variables (or matrices of predictors) using UpSet matrix layout.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upset_vp(
  x,
  plot.hp = TRUE,
  order.part = "effect",
  decreasing.part = TRUE,
  order.var = TRUE,
  decreasing.var = TRUE,
  cutoff = -1,
  nVar = 30,
  col.width = 0.6,
  pch.size = 3,
  line.lwd = 0.5,
  show.effect = TRUE,
  effect.cex = 2.7,
  title.cex = 10,
  axis.cex = 8,
  height.ratio = c(2, 1),
  width.ratio = c(1, 3)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="upset_vp_+3A_x">x</code></td>
<td>
<p>A <code><a href="rdacca.hp.html#topic+rdacca.hp">rdacca.hp</a></code> object, which contains the output of VPA and HP from canonical analysis.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_plot.hp">plot.hp</code></td>
<td>
<p>The default is <code>TRUE</code>, which plots the individual effect for each predictor on left column diagram. If <code>FALSE</code>, compute and plot the sum of unique effect and common effect for each predictor.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_order.part">order.part</code></td>
<td>
<p>How the VPA components in matrix layout should be ordered. Options include <code>"effect"</code> (order the intersections by their effects) or <code>"degree"</code> (sort by the number of predictors involved in the intersection), default is <code>"effect"</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_decreasing.part">decreasing.part</code></td>
<td>
<p>How the intersections in <code>order.part</code> should be ordered. Default is <code>TRUE</code>, <code>"effect"</code> is decreasing (from greatest to least) or <code>"degree"</code> is increasing (from least to greatest).</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_order.var">order.var</code></td>
<td>
<p>The predictors in the matrix layout should be ordered by. Default is <code>TRUE</code>, which orders the predictors by their effects. IF <code>FALSE</code>, sort by the order of predictors in input data.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_decreasing.var">decreasing.var</code></td>
<td>
<p>If <code>order.var=TRUE</code>, how the predictors should be ordered. Default is <code>TRUE</code>, from greatest to least.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_cutoff">cutoff</code></td>
<td>
<p>Effects below <code>cutoff</code> will not be displayed, default is <code>-1</code>. Note: Negative effects due to adjustment of R-squared mean negligible contributions, but they are included in the computation of the total contribution of each predictor category.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_nvar">nVar</code></td>
<td>
<p>Number of components in VPA to plot, default is <code>30</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_col.width">col.width</code></td>
<td>
<p>Width of bars in column diagram, default is <code>0.6</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_pch.size">pch.size</code></td>
<td>
<p>Size of points in matrix diagram, default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_line.lwd">line.lwd</code></td>
<td>
<p>Width of lines in matrix diagram, default is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_show.effect">show.effect</code></td>
<td>
<p>Show the relative importance of predictors (unique, common, or individual effects) above bars, default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_effect.cex">effect.cex</code></td>
<td>
<p>Font size of the effects, default is <code>2.7</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_title.cex">title.cex</code></td>
<td>
<p>Font size of axis titles, default is <code>10</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_axis.cex">axis.cex</code></td>
<td>
<p>Font size of axis labels, default is <code>8</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_height.ratio">height.ratio</code></td>
<td>
<p>Ratio between matrix and top column diagram, default is <code>c(2, 1)</code>.</p>
</td></tr>
<tr><td><code id="upset_vp_+3A_width.ratio">width.ratio</code></td>
<td>
<p>Ratio between matrix and left column diagram, default is <code>c(1, 3)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>UpSetVP diagram is an extension of UpSet technique (Conway et al. 2017; Lex et al. 2014) to canonical analysis and is used to visualize the object of <code><a href="rdacca.hp.html#topic+rdacca.hp">rdacca.hp</a></code> (Lai et al. 2022). The matrix layout enables the effective representation of relative importance of predictors, such as the unique effects and common effects in VPA, as well as additional summary statistics or individual effects in HP. UpSetVP diagram could, in principle, allow visualization of any number of predictor variables or groups of predictor variables. But considering the interpretability of data, we would like to recommend that the number of predictors (or groups of predictors) no more than 7.
</p>


<h3>Value</h3>

<p>Returns a ggplot2.
</p>


<h3>References</h3>

<p>Conway J R, Lex A, Gehlenborg N. UpSetR: an R package for the visualization of intersecting sets and their properties. Bioinformatics, 2017, 33(18): 2938-2940.
</p>
<p>Gong S, Feng B, Jian S P, et al. Elevation Matters More than Season in Shaping the Heterogeneity of Soil and Root Associated Ectomycorrhizal Fungal Community. Microbiology spectrum, 2022, 10(1): e01950-21.
</p>
<p>Lai J, Zou Y, Zhang J, et al. Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package. Methods in Ecology and Evolution, 2022.
</p>
<p>Lex A, Gehlenborg N, Strobelt H, et al. UpSet: visualization of intersecting sets. IEEE transactions on visualization and computer graphics, 2014, 20(12): 1983-1992.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(rdacca.hp)

## A simple example of partial dbRDA
data(baima.fun)
data(baima.env)

# Bray-Curtis index was used to calculate community composition dissimilarity
baima.fun.bray &lt;- vegdist(baima.fun, method = "bray")

# The relative importance of individual soil properties on EcM fungal community compositionon
soil &lt;- baima.env[c("pH", "TP", "TK", "AN", "AP", "AK")]
baima.soil.vp &lt;- rdacca.hp(baima.fun.bray, soil,
  method = "dbRDA", var.part = TRUE, type = "adjR2")

# Plot unique, common, as well as individual effects
upset_vp(baima.soil.vp, plot.hp = TRUE)

## Example was referenced from Gong et al. (2022)
if(requireNamespace("adespatial", quietly = TRUE)) {

# Distance-based Moran's eigenvector maps (dbMEM) was used to extract spatial relationships
space.dbmem &lt;- adespatial::dbmem(baima.env[c("latitude", "lontitude")])
  
  # The relative importance of groups of environmental factors on EcM fungal community composition
  env.list &lt;- list(
    elevation = baima.env["altitude"],
    season = baima.env["season"],
    space = data.frame(space.dbmem)[1:2],
    host = baima.env[c("em.GR", "em.abun")],
    climate = baima.env["sea.MT"],
    soil = baima.env[c("pH", "TP", "TK", "AN", "AP", "AK")]
  )
  baima.env.vp &lt;- rdacca.hp(baima.fun.bray, env.list,
    method = "dbRDA", var.part = TRUE, type = "adjR2")
  
  # Plot unique, common, as well as individual effects
  upset_vp(baima.env.vp, plot.hp = TRUE, order.part = "degree")
}

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
