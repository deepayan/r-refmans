<!DOCTYPE html><html><head><title>Help for package gemtc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gemtc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#atrialFibrillation'><p>Prevention of stroke in atrial fibrillation patients</p></a></li>
<li><a href='#blobbogram'><p>Plot a blobbogram (AKA forest plot)</p></a></li>
<li><a href='#blocker'><p>Beta blockers to prevent mortality after myocardial infarction</p></a></li>
<li><a href='#certolizumab'><p>Certolizumab Pegol (CZP) for Rheumatoid Arthritis</p></a></li>
<li><a href='#depression'><p>Treatment response in major depression</p></a></li>
<li><a href='#dietfat'><p>Effects of low-fat diets on mortality</p></a></li>
<li><a href='#gemtc-package'><p>GeMTC: Network meta-analysis in R</p></a></li>
<li><a href='#hfPrevention'><p>Statins versus placebo in primary and secondary prevention of heart failure</p></a></li>
<li><a href='#ll.call'><p>Call a likelihood/link-specific function</p></a></li>
<li><a href='#mtc.anohe'><p>Analysis of heterogeneity (ANOHE)</p></a></li>
<li><a href='#mtc.data.studyrow'><p>Convert one-study-per-row datasets</p></a></li>
<li><a href='#mtc.deviance'><p>Inspect residual deviance</p></a></li>
<li><a href='#mtc.hy.prior'><p>Set priors for the heterogeneity parameter</p></a></li>
<li><a href='#mtc.model'><p>Generate network meta-analysis models</p></a></li>
<li><a href='#mtc.network'><p>Create an mtc.network</p></a></li>
<li><a href='#mtc.nodesplit'><p>Node-splitting analysis of inconsistency</p></a></li>
<li><a href='#mtc.run'><p>Running an <code>mtc.model</code> using an MCMC sampler</p></a></li>
<li><a href='#parkinson'><p>Mean off-time reduction in Parkinson's disease</p></a></li>
<li><a href='#plotCovariateEffect'><p>Plot treatment effects versus covariate values</p></a></li>
<li><a href='#rank.probability'><p>Calculating rank-probabilities</p></a></li>
<li><a href='#relative.effect'><p>Calculating relative effects</p></a></li>
<li><a href='#relative.effect.table'><p>Table of relative effects</p></a></li>
<li><a href='#smoking'><p>Psychological treatments to aid smoking cessation</p></a></li>
<li><a href='#thrombolytic'><p>Thrombolytic treatment after acute myocardial infarction</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-21</td>
</tr>
<tr>
<td>Title:</td>
<td>Network Meta-Analysis Using Bayesian Methods</td>
</tr>
<tr>
<td>Author:</td>
<td>Gert van Valkenhoef, Joel Kuiper</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gert van Valkenhoef &lt;gert@gertvv.nl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Network meta-analyses (mixed treatment comparisons) in the Bayesian
    framework using JAGS. Includes methods to assess heterogeneity and
    inconsistency, and a number of standard visualizations.
    van Valkenhoef et al. (2012) &lt;<a href="https://doi.org/10.1002%2Fjrsm.1054">doi:10.1002/jrsm.1054</a>&gt;;
    van Valkenhoef et al. (2015) &lt;<a href="https://doi.org/10.1002%2Fjrsm.1167">doi:10.1002/jrsm.1167</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), coda (&ge; 0.13)</td>
</tr>
<tr>
<td>Imports:</td>
<td>igraph (&ge; 1.0), meta (&ge; 2.1), plyr (&ge; 1.8), graphics,
grDevices, stats, utils, grid, rjags (&ge; 4-0), truncnorm,
Rglpk, forcats (&ge; 0.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 0.8), Matrix</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gertvv/gemtc">https://github.com/gertvv/gemtc</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Collate:</td>
<td>'anohe.R' 'arrayize.R' 'blobbogram.R' 'template.R' 'code.R'
'data.R' 'deviance.R' 'forest.R' 'solveLP.R' 'inits.R'
'likelihoods.R' 'll-helper.counts.R' 'll.binom.cloglog.R'
'll.binom.log.R' 'll.binom.logit.R' 'll.call.R'
'll.normal.identity.R' 'll.poisson.log.R'
'minimum.diameter.spanning.tree.R' 'mtc.data.studyrow.R'
'mtc.hy.prior.R' 'mtc.model.R' 'mtc.model.consistency.R'
'mtc.model.nodesplit.R' 'mtc.model.regression.R'
'mtc.model.ume.R' 'mtc.model.use.R' 'mtc.network.R'
'stopIfNotConsistent.R' 'mtc.result.R' 'mtc.run.R'
'nodesplit.R' 'plotCovariateEffect.R' 'priors.R'
'rank.probability.R' 'regression.R' 'relative.effect.R'
'relative.effect.table.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-21 18:18:18 UTC; gert</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-21 19:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='atrialFibrillation'>Prevention of stroke in atrial fibrillation patients</h2><span id='topic+atrialFibrillation'></span>

<h3>Description</h3>

<p>A dataset of 25 trials investigating 17 treatments for stroke prevention in atrial fibrillation patients. The main outcome is the number of patients with a stroke, and a covariate captures the proportion of patients with a prior stroke.
</p>
<p>Data are take from Table 1 of Cooper et al. (2009), with the following corrections applied: SPAF 3 and AFASAK 2 do not have a treatment 13 arm, and SPAF 1 does not contain treatment 5, but treatment 6. Thanks to prof. Cooper for providing the original analysis dataset.</p>


<h3>Format</h3>

<p>A network meta-regression dataset containing 60 rows of arm-based data (responders and sample size).</p>


<h3>Source</h3>

<p>Cooper et al. (2009),
<em>Adressing between-study heterogeneity and inconsistency in mixed treatment comparisons: Application to stroke prevention treatments in individuals with non-rheumatic atrial fibrillation</em>,
Statistics in Medicine 28:1861-1881.
[<a href="https://doi.org/10.1002/sim.3594">doi:10.1002/sim.3594</a>]
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Build a model similar to Model 4(b) from Cooper et al. (2009):
classes &lt;- list("control"=c("01"),
                "anti-coagulant"=c("02","03","04","09"),
                "anti-platelet"=c("05","06","07","08","10","11","12","16","17"),
                "mixed"=c("13","14","15"))

regressor &lt;- list(coefficient='shared',
                  variable='stroke',
                  classes=classes)

model &lt;- mtc.model(atrialFibrillation,
                   type="regression",
                   regressor=regressor,
                   om.scale=10)

## Not run: 
result &lt;- mtc.run(model)
## End(Not run)
</code></pre>

<hr>
<h2 id='blobbogram'>Plot a blobbogram (AKA forest plot)</h2><span id='topic+blobbogram'></span><span id='topic+forest'></span>

<h3>Description</h3>

<p><code>blobbogram</code> is a flexible function for creating blobbograms (forest plots), making no specific assumptions about the data being plotted. It supports column and row grouping as well as pagination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blobbogram(data, id.label="Study", ci.label="Mean (95% CI)",
    left.label=NULL, right.label=NULL, center.label=NULL,
    log.scale=FALSE, xlim=NULL, styles=NULL,
    grouped=TRUE, group.labels=NULL,
    columns=NULL, column.labels=NULL,
    column.groups=NULL, column.group.labels=NULL,
    digits=2,
    ask=dev.interactive(orNone=TRUE),
    draw.no.effect=TRUE)

forest(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blobbogram_+3A_data">data</code></td>
<td>
<p>A data frame containing one row for each confidence interval to be visualized.
The data format is described below.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_id.label">id.label</code></td>
<td>
<p>Label to show above the row-id column.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_ci.label">ci.label</code></td>
<td>
<p>Label to show above the confidence intervals.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_left.label">left.label</code></td>
<td>
<p>Label to show on the left-hand side of the no-difference line.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_right.label">right.label</code></td>
<td>
<p>Label to show on the right-hand side of the no-difference line.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_center.label">center.label</code></td>
<td>
<p>Label to show center-aligned with the no-difference line.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_log.scale">log.scale</code></td>
<td>
<p>If TRUE, the confidence intervals are given on a log scale, and axis labels will be <code>exp()</code> transformed.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_xlim">xlim</code></td>
<td>
<p>The scale limits of the plot, if the confidence interval exceeds these limits an arrow will be shown at the limit. If unspecified, limits will be chosen that encompass all confidence intervals.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_styles">styles</code></td>
<td>
<p>A data frame describing the different row styles. By default, the styles &quot;normal&quot;, &quot;pooled&quot; and &quot;group&quot; are defined.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_grouped">grouped</code></td>
<td>
<p>If TRUE, and group.labels are specified, rows will be grouped according to the &quot;group&quot; column given in the data argument.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_group.labels">group.labels</code></td>
<td>
<p>Vector of group labels.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_columns">columns</code></td>
<td>
<p>Additional user-defined columns to be shown (names of columns given in the data argument).</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_column.labels">column.labels</code></td>
<td>
<p>A vector of labels for the user-defined columns.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_column.groups">column.groups</code></td>
<td>
<p>Column groups, a numeric vector specifying the column group for each column.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_column.group.labels">column.group.labels</code></td>
<td>
<p>A vector of labels for the column groups.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_digits">digits</code></td>
<td>
<p>The number of (significant) digits to print.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_ask">ask</code></td>
<td>
<p>If TRUE, a prompt will be displayed before generating the
next page of a multi-page plot.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_draw.no.effect">draw.no.effect</code></td>
<td>
<p>If TRUE, draw the no-effect line.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_x">x</code></td>
<td>
<p>An object to create a forest plot of.</p>
</td></tr>
<tr><td><code id="blobbogram_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>forest</code> function is a generic S3 method (definition compatible with the <code>meta</code> package). This package defines methods for <code>mtc.result</code> and <code>mtc.relative.effect.table</code>.
</p>
<p>The <code>blobbogram</code> function creates a blobbogram (forest plot) from the given data (point estimates and confidence intervals) and meta-data (labels, column specifications, column groups, row groups, styles) using the <code>grid</code> package.
If the plot would not fit the device's graphics region, the content is broken up into multiple plots generated in sequence (pagination).
</p>
<p>The <code>data</code> argument is given as a data frame containing the following columns:
</p>

<ul>
<li><p>id: identifier (label) for this row.
</p>
</li>
<li><p>group (optional): row group this row belongs to (indexes into the <code>group.labels</code> argument).
</p>
</li>
<li><p>pe: point estimate.
</p>
</li>
<li><p>ci.l: lower confidence interval limit.
</p>
</li>
<li><p>ci.u: upper confidence interval limit.
</p>
</li>
<li><p>style: the style to apply to this row (defined in the <code>styles</code> argument).
</p>
</li></ul>

<p>Additional user-defined columns can be specified using the <code>columns</code> and <code>column.labels</code> arguments.
</p>
<p>The <code>styles</code> argument is given as a data frame containing the following columns:
</p>

<ul>
<li><p>style: name of the style.
</p>
</li>
<li><p>weight: font weight.
</p>
</li>
<li><p>pe.style: symbol to draw for the point estimate (&quot;circle&quot; or &quot;square&quot;, currently).
</p>
</li></ul>



<h3>Value</h3>

<p>None.
</p>


<h3>Note</h3>

<p>This method should not be considered stable.
We intend to generalize it further and possibly provide it in a separate package.
The interface may change at any time.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef, Joël Kuiper</p>


<h3>See Also</h3>

<p><code>meta::forest</code>, <code>grid::Grid</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- read.table(textConnection('
id               group pe       ci.l ci.u style      value.A    value.B 
"Study 1"  1         0.35 0.08 0.92 "normal" "2/46"     "7/46" 
"Study 2"  1         0.43 0.15 1.14 "normal" "4/50"     "8/49" 
"Study 3"  2         0.31 0.07 0.74 "normal" "2/97"     "10/100"
"Study 4"  2         0.86 0.34 2.90 "normal" "9/104"    "6/105" 
"Study 5"  2         0.33 0.10 0.72 "normal" "4/74"     "14/74" 
"Study 6"  2         0.47 0.23 0.91 "normal" "11/120" "22/129"
"Pooled"     NA      0.42 0.15 1.04 "pooled" NA             NA 
'), header=TRUE)
data$pe &lt;- log(data$pe)
data$ci.l &lt;- log(data$ci.l)
data$ci.u &lt;- log(data$ci.u)

blobbogram(data, group.labels=c('GROUP 1', 'GROUP 2'),
    columns=c('value.A', 'value.B'), column.labels=c('r/n', 'r/n'),
    column.groups=c(1, 2), grouped=TRUE,
    column.group.labels=c('Intervention', 'Control'),
    id.label="Trial", ci.label="Odds Ratio (95% CrI)", log.scale=TRUE)
</code></pre>

<hr>
<h2 id='blocker'>Beta blockers to prevent mortality after myocardial infarction</h2><span id='topic+blocker'></span>

<h3>Description</h3>

<p>A dataset of 22 trials investigating beta blockers versus control to prevent mortality after myocardial infarction. Number of events and sample size.</p>


<h3>Format</h3>

<p>A meta-analysis dataset containing 44 rows of arm-based data (responders and sample size).</p>


<h3>Source</h3>

<p>S. Dias, A.J. Sutton, A.E. Ades, and N.J. Welton (2013a),
<em>A Generalized Linear Modeling Framework for Pairwise and Network Meta-analysis of Randomized Controlled Trials</em>,
Medical Decision Making 33(5):607-617.
[<a href="https://doi.org/10.1177/0272989X12458724">doi:10.1177/0272989X12458724</a>]
</p>
<p>J.B. Carlin (1992),
<em>Meta-analysis for 2 × 2 tables: a Bayesian approach</em>,
Statistics in Medicine 11(2):141-158.
[<a href="https://doi.org/10.1002/sim.4780110202">doi:10.1002/sim.4780110202</a>]
</p>

<hr>
<h2 id='certolizumab'>Certolizumab Pegol (CZP) for Rheumatoid Arthritis</h2><span id='topic+certolizumab'></span>

<h3>Description</h3>

<p>A dataset of 12 trials investigating 6 treatments and placebo for rheumatoid arthritis. The main outcome is the number of patients who improved by at least 50% on the American College of Rheumatology scale (ACR50) at 6 Months. A covariate is present for the mean disease duration at baseline (years).</p>


<h3>Format</h3>

<p>A network meta-regression dataset containing 24 rows of arm-based data (responders and sample size).</p>


<h3>Source</h3>

<p>S. Dias, A.J. Sutton, N.J. Welton, and A.E. Ades (2013b),
<em>Heterogeneity - Subgroups, Meta-Regression, Bias, and Bias-Adjustment</em>,
Medical Decision Making 33(5):618-640. <br />
[<a href="https://doi.org/10.1177/0272989X13485157">doi:10.1177/0272989X13485157</a>]
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run RE regression model with informative heterogeneity prior

regressor &lt;- list(coefficient='shared',
                  variable='diseaseDuration',
                  control='Placebo')

# sd ~ half-Normal(mean=0, sd=0.32)
hy.prior &lt;- mtc.hy.prior(type="std.dev", distr="dhnorm", 0, 9.77)

model &lt;- mtc.model(certolizumab,
                   type="regression",
                   regressor=regressor,
                   hy.prior=hy.prior)

## Not run: 
result &lt;- mtc.run(model)
## End(Not run)
</code></pre>

<hr>
<h2 id='depression'>Treatment response in major depression</h2><span id='topic+depression'></span>

<h3>Description</h3>

<p>A dataset of 111 trials investigating 12 treatments for major depression on treatment response. Treatment response was defined as a reduction of at least 50% from the baseline score on the HAM-D or MADRS at week 8 (or, if not available, another time between week 6 and 12).</p>


<h3>Format</h3>

<p>A network meta-analysis dataset containing 224 rows of arm-based data (responders and sample size).</p>


<h3>Source</h3>

<p>Cipriani et al. (2009),
<em>Comparative efficacy and acceptability of 12 new-generation antidepressants: a multiple-treatments meta-analysis</em>,
Lancet 373(9665):746-758.
[<a href="https://doi.org/10.1016/S0140-6736%2809%2960046-5">doi:10.1016/S0140-6736(09)60046-5</a>]
</p>

<hr>
<h2 id='dietfat'>Effects of low-fat diets on mortality</h2><span id='topic+dietfat'></span>

<h3>Description</h3>

<p>A dataset of 10 trials investigating low-fat diet versus control diet for mortality. Number of events and exposure in person-years.</p>


<h3>Format</h3>

<p>A meta-analysis dataset containing 20 rows of arm-based data (responders, exposure, and sample size).</p>


<h3>Source</h3>

<p>S. Dias, A.J. Sutton, A.E. Ades, and N.J. Welton (2013a),
<em>A Generalized Linear Modeling Framework for Pairwise and Network Meta-analysis of Randomized Controlled Trials</em>,
Medical Decision Making 33(5):607-617.
[<a href="https://doi.org/10.1177/0272989X12458724">doi:10.1177/0272989X12458724</a>]
</p>
<p>Hooper et al. (2000),
<em>Reduced or modified dietary fat for preventing cardiovascular disease</em>,
Cochrane Database of Systematic Reviews 2:CD002137.
[<a href="https://doi.org/10.1002/14651858.CD002137">doi:10.1002/14651858.CD002137</a>]
</p>

<hr>
<h2 id='gemtc-package'>GeMTC: Network meta-analysis in R</h2><span id='topic+mtc'></span><span id='topic+gemtc'></span><span id='topic+gemtc-package'></span>

<h3>Description</h3>

<p>An R package for performing network meta-analyses (mixed treatment comparisons).
</p>


<h3>Details</h3>

<p>Network meta-analysis, or mixed treatment comparison (MTC) is a technique to meta-analyze networks of trials comparing two or more treatments at the same time [Dias et al. 2013a].
Using a Bayesian hierarchical model, all direct and indirect comparisons are taken into account to arrive at a single consistent estimate of the effect of all included treatments based on all included studies.
</p>
<p>This package allows the automated generation of network meta-analysis models [van Valkenhoef et al. 2012], inclusing both fixed effect and random effects network meta-analysis, node-splitting models to identify inconsistency, and network meta-regression models.
Models are estimated using JAGS (through the <code>rjags</code> package).
</p>
<p>It is possible to get reproducible results, but as JAGS uses its own pseudo-random number generator, this is somewhat more involved. See <code><a href="#topic+mtc.model">mtc.model</a></code> for details.
</p>
<p>The source for GeMTC is available under the GPL-3 on <a href="https://github.com/gertvv/gemtc">Github</a>.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef</p>


<h3>References</h3>

<p>S. Dias, N.J. Welton, D.M. Caldwell, and A.E. Ades (2010),
<em>Checking consistency in mixed treatment comparison meta-analysis</em>,
Statistics in Medicine 29(7-8, Sp. Iss. SI):932-944.<br />
[<a href="https://doi.org/10.1002/sim.3767">doi:10.1002/sim.3767</a>]
</p>
<p>S. Dias, A.J. Sutton, A.E. Ades, and N.J. Welton (2013a),
<em>A Generalized Linear Modeling Framework for Pairwise and Network Meta-analysis of Randomized Controlled Trials</em>,
Medical Decision Making 33(5):607-617.
[<a href="https://doi.org/10.1177/0272989X12458724">doi:10.1177/0272989X12458724</a>]
</p>
<p>S. Dias, A.J. Sutton, N.J. Welton, and A.E. Ades (2013b),
<em>Heterogeneity - Subgroups, Meta-Regression, Bias, and Bias-Adjustment</em>,
Medical Decision Making 33(5):618-640. <br />
[<a href="https://doi.org/10.1177/0272989X13485157">doi:10.1177/0272989X13485157</a>]
</p>
<p>S. Dias, N.J. Welton, A.J. Sutton, D.M. Caldwell, G. Lu, and A.E. Ades (2013c),
<em>Inconsistency in Networks of Evidence Based on Randomized Controlled Trials</em>,
Medical Decision Making 33(5):641-656.
[<a href="https://doi.org/10.1177/0272989X12455847">doi:10.1177/0272989X12455847</a>]
</p>
<p>A. Gelman, A. Jakulin, M. Grazia Pittau, Y.-S. Su (2008),
<em>A weakly informative default prior distribution for logistic and other regression models</em>,
The Annals of Applied Statistics 2(4):1360-1383.
[<a href="https://doi.org/10.1214/08-AOAS191">doi:10.1214/08-AOAS191</a>]
</p>
<p>R.M. Turner, J. Davey, M.J. Clarke, S.G. Thompson, J.P.T. Higgins (2012),
<em>Predicting the extent of heterogeneity in meta-analysis, using empirical data from the Cochrane Database of Systematic Reviews</em>,
International Journal of Epidemiology 41(3):818-827.
[<a href="https://doi.org/10.1093/ije/dys041">doi:10.1093/ije/dys041</a>]
</p>
<p>G. van Valkenhoef, G. Lu, B. de Brock, H. Hillege, A.E. Ades, and N.J. Welton (2012),
<em>Automating network meta-analysis</em>,
Research Synthesis Methods 3(4):285-299.
[<a href="https://doi.org/10.1002/jrsm.1054">doi:10.1002/jrsm.1054</a>]
</p>
<p>G. van Valkenhoef, S. Dias, A.E. Ades, and N.J. Welton (2015),
<em>Automated generation of node-splitting models for assessment of inconsistency in network meta-analysis</em>,
Research Synthesis Methods, accepted manuscript.
[<a href="https://doi.org/10.1002/jrsm.1167">doi:10.1002/jrsm.1167</a>]
</p>
<p>G. van Valkenhoef et al. (draft),
<em>Modeling inconsistency as heterogeneity in network meta-analysis</em>,
draft manuscript.
</p>
<p>D.E. Warn, S.G. Thompson, and D.J. Spiegelhalter (2002),
<em>Bayesian random effects meta-analysis of trials with binary outcomes: methods for the absolute risk difference and relative risk scales</em>,
Statistics in Medicine 21(11):1601-1623.
[<a href="https://doi.org/10.1002/sim.1189">doi:10.1002/sim.1189</a>]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtc.network">mtc.network</a></code>,
<code><a href="#topic+mtc.model">mtc.model</a></code>,
<code><a href="#topic+mtc.run">mtc.run</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the example network and generate a consistency model:
model &lt;- mtc.model(smoking, type="consistency")

# Load pre-generated samples instead of runing the model:
## Not run: results &lt;- mtc.run(model, thin=10)
results &lt;- readRDS(system.file("extdata/luades-smoking-samples.rds", package="gemtc"))

# Print a basic statistical summary of the results:
summary(results)
## Iterations = 5010:25000
## Thinning interval = 10 
## Number of chains = 4 
## Sample size per chain = 2000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##         Mean     SD Naive SE Time-series SE
## d.A.B 0.4965 0.4081 0.004563       0.004989
## d.A.C 0.8359 0.2433 0.002720       0.003147
## d.A.D 1.1088 0.4355 0.004869       0.005280
## sd.d  0.8465 0.1913 0.002139       0.002965
## 
## 2. Quantiles for each variable:
## 
##          2.5%    25%    50%    75% 97.5%
## d.A.B -0.2985 0.2312 0.4910 0.7530 1.341
## d.A.C  0.3878 0.6720 0.8273 0.9867 1.353
## d.A.D  0.2692 0.8197 1.0983 1.3824 2.006
## sd.d   0.5509 0.7119 0.8180 0.9542 1.283
</code></pre>

<hr>
<h2 id='hfPrevention'>Statins versus placebo in primary and secondary prevention of heart failure</h2><span id='topic+hfPrevention'></span>

<h3>Description</h3>

<p>A dataset of 19 trials comparing statins versus placebo or usual care for cholesterol lowering. The main outcome is the number of deaths. Trials are either primary prevention (no previous heart disease; secondary = 0) or secondary prevention (previous heart disease; secondary = 1).</p>


<h3>Format</h3>

<p>A meta-regression dataset containing 38 rows of arm-based data (responders and sample size).</p>


<h3>Source</h3>

<p>S. Dias, A.J. Sutton, N.J. Welton, and A.E. Ades (2013b),
<em>Heterogeneity - Subgroups, Meta-Regression, Bias, and Bias-Adjustment</em>,
Medical Decision Making 33(5):618-640. <br />
[<a href="https://doi.org/10.1177/0272989X13485157">doi:10.1177/0272989X13485157</a>]
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Build a model similar to Program 1(a) from Dias et al. (2013b):
regressor &lt;- list(coefficient='shared',
                  variable='secondary',
                  control='control')

model &lt;- mtc.model(hfPrevention,
                   type="regression",
                   regressor=regressor,
                   hy.prior=mtc.hy.prior("std.dev", "dunif", 0, 5))

## Not run: 
result &lt;- mtc.run(model)
## End(Not run)
</code></pre>

<hr>
<h2 id='ll.call'>Call a likelihood/link-specific function</h2><span id='topic+ll.call'></span>

<h3>Description</h3>

<p>GeMTC implements various likelihood/link combinations.
Functionality specific to the likelihood/link is handled by methods with names ending in
<code>.&lt;likelihood&gt;.&lt;link&gt;</code>. 
This convenience function calls such methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ll.call(fnName, model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ll.call_+3A_fnname">fnName</code></td>
<td>
<p>The name of the function to call. See details for available functions.</p>
</td></tr>
<tr><td><code id="ll.call_+3A_model">model</code></td>
<td>
<p>An object of S3 class <code>mtc.model</code> describing a network meta-analysis model, or a
list containing elements named 'likelihood' and 'link'.</p>
</td></tr>
<tr><td><code id="ll.call_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following methods currently need to be implemented to implement a likelihood/link:
</p>

<ul>
<li><p><code>mtc.arm.mle</code>: calculates a (corrected) maximum likelihood estimate for an arm-level
effect. Used to generate starting values.
</p>
</li>
<li><p><code>mtc.rel.mle</code>: calculates a (corrected) maximum likelihood estimate for a relative
effect. Used to generate starting values.
</p>
</li>
<li><p><code>mtc.code.likelihood</code>: generates JAGS code implementing the likelihood.
</p>
</li>
<li><p><code>scale.log</code>: returns TRUE if plots should use the log scale.
</p>
</li>
<li><p><code>scale.name</code>: returns the user-facing name of the outcome metric.
</p>
</li>
<li><p><code>scale.limit.inits</code>: returns an upper and lower bound for the initial values, because
some initial values might trigger boundary conditions such as probability 0 or 1 for the binomial.
</p>
</li>
<li><p><code>required.columns.ab</code>: returns the required columns for arm-based data.
</p>
</li></ul>

<p>The first two methods can now also be used to selectively apply continuity corrections in case the maximum likelihood estimates are used for other purposes. <code>mtc.arm.mle</code> has an additional <code>k=0.5</code> argument to specify the correction factor. <code>mtc.rel.mle</code> has arguments <code>correction.force=TRUE</code> to force application of the continuity correction even if unnecessary, <code>correction.type="constant"</code> to specify the type of correction (specify <code>"reciprocal"</code>) for a correction proportional to the reciprocal of the size of the other arm, and <code>correction.magnitude=1</code> to specify the (total) magnitude of the correction. These corrections apply only for count data, and will be ignored for continuous likelihood/links.
</p>


<h3>Value</h3>

<p>The return value of the called function.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtc.model">mtc.model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The "model" may be a stub.
model &lt;- list(likelihood="poisson", link="log")

ll.call("scale.name", model)
# "Hazard Ratio"

ll.call("mtc.arm.mle", model, c('responders'=12, 'exposure'=80))
#      mean         sd
#-1.8562980  0.1118034
</code></pre>

<hr>
<h2 id='mtc.anohe'>Analysis of heterogeneity (ANOHE)</h2><span id='topic+mtc.anohe'></span><span id='topic+plot.mtc.anohe'></span><span id='topic+print.mtc.anohe'></span><span id='topic+summary.mtc.anohe'></span><span id='topic+plot.mtc.anohe.summary'></span><span id='topic+print.mtc.anohe.summary'></span>

<h3>Description</h3>

<p>(EXPERIMENTAL)
Generate an analysis of heterogeneity for the given network. Three types of model are estimated: unrelated study effects, unrelated mean effects, and consistency. Output of the <code>summary</code> function can passed to <code>plot</code> for a visual representation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtc.anohe(network, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtc.anohe_+3A_network">network</code></td>
<td>
<p>An object of S3 class <code><a href="#topic+mtc.network">mtc.network</a></code>.</p>
</td></tr>
<tr><td><code id="mtc.anohe_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code><a href="#topic+mtc.run">mtc.run</a></code> or <code><a href="#topic+mtc.model">mtc.model</a></code>. This can be used to set the likelihood/link or the number of iterations, for example.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Analysis of heterogeneity is intended to be a unified set of statistics and a visual display that allows the simultaneous assessment of both heterogeneity and inconsistency in network meta-analysis <a href="#topic+gemtc-package">[van Valkenhoef et al. 2014b (draft)]</a>.
</p>
<p><code>mtc.anohe</code> returns the MCMC results for all three types of model. To get appropriate summary statistics, call <code>summary()</code> on the results object. The summary can be plotted.
</p>
<p>To control parameters of the MCMC estimation, see <code><a href="#topic+mtc.run">mtc.run</a></code>.
To specify the likelihood/link or to control other model parameters, see <code><a href="#topic+mtc.model">mtc.model</a></code>.
The <code>...</code> arguments are first matched against <code><a href="#topic+mtc.run">mtc.run</a></code>, and those that do not match are passed to <code><a href="#topic+mtc.model">mtc.model</a></code>.
</p>


<h3>Value</h3>

<p>For <code>mtc.anohe</code>:
an object of class <code>mtc.anohe</code>. This is a list with the following elements: 
</p>
<table>
<tr><td><code>result.use</code></td>
<td>
<p>The result for the USE model (see <code><a href="#topic+mtc.run">mtc.run</a></code>).</p>
</td></tr>
<tr><td><code>result.ume</code></td>
<td>
<p>The result for the UME model (see <code><a href="#topic+mtc.run">mtc.run</a></code>).</p>
</td></tr>
<tr><td><code>result.cons</code></td>
<td>
<p>The result for the consistency model (see <code><a href="#topic+mtc.run">mtc.run</a></code>).</p>
</td></tr>
</table>
<p>For <code>summary</code>:
an object of class <code>mtc.anohe.summary</code>. This is a list with the following elements: 
</p>
<table>
<tr><td><code>cons.model</code></td>
<td>
<p>Generated consistency model.</p>
</td></tr>
<tr><td><code>studyEffects</code></td>
<td>
<p>Study-level effect summaries (multi-arm trials downweighted).</p>
</td></tr>
<tr><td><code>pairEffects</code></td>
<td>
<p>Pair-wise pooled effect summaries (from the UME model).</p>
</td></tr>
<tr><td><code>consEffects</code></td>
<td>
<p>Consistency effect summaries.</p>
</td></tr>
<tr><td><code>indEffects</code></td>
<td>
<p>Indirect effect summaries (back-calculated).</p>
</td></tr>
<tr><td><code>isquared.comp</code></td>
<td>
<p>Per-comparison I-squared statistics.</p>
</td></tr>
<tr><td><code>isquared.glob</code></td>
<td>
<p>Global I-squared statistics.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This method should not be considered stable. It is an experimental feature and heavily work in progress. The interface may change at any time.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef, Joël Kuiper</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtc.model">mtc.model</a></code>
<code><a href="#topic+mtc.run">mtc.run</a></code>
</p>

<hr>
<h2 id='mtc.data.studyrow'>Convert one-study-per-row datasets</h2><span id='topic+mtc.data.studyrow'></span>

<h3>Description</h3>

<p>Converts datasets in the one-study-per-row format to one-arm-per-row format used by GeMTC</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtc.data.studyrow(data,
  armVars=c('treatment'='t', 'responders'='r', 'sampleSize'='n'),
  nArmsVar='na',
  studyVars=c(),
  studyNames=1:nrow(data),
  treatmentNames=NA,
  patterns=c('%s..', '%s..%d.'))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtc.data.studyrow_+3A_data">data</code></td>
<td>
<p>Data in one-study-per-row format.</p>
</td></tr>
<tr><td><code id="mtc.data.studyrow_+3A_armvars">armVars</code></td>
<td>
<p>Vector of per-arm variables. The name of each component will be the column name in the resulting dataset. The column name in the source dataset is derived from the value of each component.</p>
</td></tr>
<tr><td><code id="mtc.data.studyrow_+3A_narmsvar">nArmsVar</code></td>
<td>
<p>Variable holding the number of arms for each study.</p>
</td></tr>
<tr><td><code id="mtc.data.studyrow_+3A_studyvars">studyVars</code></td>
<td>
<p>Vector of per-study variables. The name of each component will be the column name in the resulting dataset. The column name in the source dataset is derived from the value of each component.</p>
</td></tr>
<tr><td><code id="mtc.data.studyrow_+3A_studynames">studyNames</code></td>
<td>
<p>Vector of study names.</p>
</td></tr>
<tr><td><code id="mtc.data.studyrow_+3A_treatmentnames">treatmentNames</code></td>
<td>
<p>Vector of treatment names.</p>
</td></tr>
<tr><td><code id="mtc.data.studyrow_+3A_patterns">patterns</code></td>
<td>
<p>Patterns to generate column names in the source dataset. The first is for per-study variables, the second for per-arm variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Maps the one-study-per-row format that is widely used and convenient for BUGS models to the one-arm-per-row format used by GeMTC.
As the primary purpose is to input datasets from BUGS models, the defaults work for the standard BUGS data table format.
In most cases, it should be possible to just copy/paste the BUGS data table (without the final 'END') and <code>read.table</code> it into R, then apply <code>mtc.data.studyrow</code>.
In many cases, the resulting table can be processed directly by <code><a href="#topic+mtc.network">mtc.network</a></code>.
</p>


<h3>Value</h3>

<p>A data table with the requested columns.</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtc.network">mtc.network</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example taken from the NICE DSU TSD series in Evidence Synthesis, #2
## Dopamine agonists for the treatment of Parkinson's

# Read the bugs-formatted data
data.src &lt;- read.table(textConnection('
t[,1]	t[,2]	t[,3]	y[,1]	y[,2]	y[,3]	se[,1]	se[,2]	se[,3]	na[]
1	3	NA	-1.22	-1.53	NA	0.504	0.439	NA	2
1	2	NA	-0.7	-2.4	NA	0.282	0.258	NA	2
1	2	4	-0.3	-2.6	-1.2	0.505	0.510	0.478	3
3	4	NA	-0.24	-0.59	NA	0.265	0.354	NA	2
3	4	NA	-0.73	-0.18	NA	0.335	0.442	NA	2
4	5	NA	-2.2	-2.5	NA	0.197	0.190	NA	2
4	5	NA	-1.8	-2.1	NA	0.200	0.250	NA	2'), header=TRUE)

# Convert the data, setting treatment names
data &lt;- mtc.data.studyrow(data.src,
  armVars=c('treatment'='t', 'mean'='y', 'std.err'='se'),
  treatmentNames=c('Placebo', 'DA1', 'DA2', 'DA3', 'DA4'))

# Check that the data are correct
print(data)

# Create a network
network &lt;- mtc.network(data)
</code></pre>

<hr>
<h2 id='mtc.deviance'>Inspect residual deviance</h2><span id='topic+mtc.deviance'></span><span id='topic+plot.mtc.deviance'></span><span id='topic+mtc.devplot'></span><span id='topic+mtc.levplot'></span>

<h3>Description</h3>

<p>Inspect the posterior residual deviance and summarize it using plots</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtc.deviance(result)

mtc.devplot(x, ...)
mtc.levplot(x, ...)

## S3 method for class 'mtc.deviance'
plot(x, auto.layout=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtc.deviance_+3A_result">result</code></td>
<td>
<p>An object of class <code><a href="#topic+mtc.result">mtc.result</a></code>.</p>
</td></tr>
<tr><td><code id="mtc.deviance_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+mtc.deviance">mtc.deviance</a></code>.</p>
</td></tr>
<tr><td><code id="mtc.deviance_+3A_auto.layout">auto.layout</code></td>
<td>
<p>If <code>TRUE</code>, the separate plots will be shown as panels on a single page.</p>
</td></tr>
<tr><td><code id="mtc.deviance_+3A_...">...</code></td>
<td>
<p>Graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mtc.devplot</code> will generate a stem plot of the posterior deviance per arm (if there are only arm-based data) or the mean per data point deviance per study (if there are contrast-based data).
</p>
<p><code>mtc.levplot</code> will plot the leverage versus the square root of the residual deviance (mean per data point for each study).
</p>
<p>The generic plot function will display both on a single page (unless <code>auto.layout=FALSE</code>).
</p>


<h3>Value</h3>

<p><code>mtc.deviance</code> returns the deviance statistics of a <code>mtc.result</code>.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtc.run">mtc.run</a></code>
</p>

<hr>
<h2 id='mtc.hy.prior'>Set priors for the heterogeneity parameter</h2><span id='topic+mtc.hy.prior'></span><span id='topic+mtc.hy.empirical.lor'></span>

<h3>Description</h3>

<p>These functions generate priors for the heterogeneity parameter in <code><a href="#topic+mtc.model">mtc.model</a></code>. 
Priors can be set explicitly or, for outcomes on the log odds-ratio scale, based on empirical research.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtc.hy.prior(type, distr, ...)

mtc.hy.empirical.lor(outcome.type, comparison.type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtc.hy.prior_+3A_type">type</code></td>
<td>
<p>Type of heterogeneity prior: 'std.dev', 'var', or 'prec' for standard deviation, variance, or precision respectively.</p>
</td></tr>
<tr><td><code id="mtc.hy.prior_+3A_distr">distr</code></td>
<td>
<p>Prior distribution name (JAGS syntax). Typical ones would be 'dunif' (uniform), 'dgamma' (Gamma), or 'dlnorm' (log-normal). Use 'dhnorm' for the half-normal. Note that, as in JAGS, the precision (and not the variance or standard deviation) is used for the normal distribution and its derivatives.</p>
</td></tr>
<tr><td><code id="mtc.hy.prior_+3A_...">...</code></td>
<td>
<p>Arguments to the <code>distr</code>. Can be numerical values or &quot;om.scale&quot; for the estimated outcome measure scale (see <code><a href="#topic+mtc.model">mtc.model</a></code>)</p>
</td></tr>
<tr><td><code id="mtc.hy.prior_+3A_outcome.type">outcome.type</code></td>
<td>
<p>The type of outcome to get an empirical prior for. Can be one of 'mortality' (all-cause mortality), 'semi-objective' (e.g. cause-specific mortality, major morbidity event, drop-outs), or 'subjective' (e.g. pain, mental health, dichotomous biomarkers).</p>
</td></tr>
<tr><td><code id="mtc.hy.prior_+3A_comparison.type">comparison.type</code></td>
<td>
<p>The type of comparison to get an empirical prior for. Can be one of 'pharma-control' (pharmacological interventions versus control), 'pharma-pharma' (pharmacological versus pharmacological interventions) and 'non-pharma' (any other comparisons).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generated prior is a list, the structure of which may change without notice. It can be converted to JAGS compatible code using <code>as.character</code>.
</p>
<p>Empirical priors for the log odds-ratio (LOR) are taken from <a href="#topic+gemtc-package">[Turner et al. 2012]</a>.
</p>


<h3>Value</h3>

<p>A value to be passed to <code><a href="#topic+mtc.model">mtc.model</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtc.model">mtc.model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># NOTE: the mtc.run commands below are for illustrative purposes, such a small
# number of iterations should obviously not be used in practice.

# set a uniform prior standard deviation
model1 &lt;- mtc.model(smoking, hy.prior=mtc.hy.prior("std.dev", "dunif", 0, 2))
result &lt;- mtc.run(model1, n.adapt=10, n.iter=10)

# set an empirical (log-normal) prior on the variance
model2 &lt;- mtc.model(smoking, hy.prior=mtc.hy.empirical.lor("subjective", "non-pharma"))
result &lt;- mtc.run(model2, n.adapt=10, n.iter=10)

# set a gamma prior on the precision
model3 &lt;- mtc.model(smoking, hy.prior=mtc.hy.prior("prec", "dgamma", 0.01, 0.01))
result &lt;- mtc.run(model3, n.adapt=10, n.iter=10)
</code></pre>

<hr>
<h2 id='mtc.model'>Generate network meta-analysis models</h2><span id='topic+mtc.model'></span><span id='topic+plot.mtc.model'></span><span id='topic+summary.mtc.model'></span><span id='topic+print.mtc.model'></span>

<h3>Description</h3>

<p>The <code>mtc.model</code> function generates network meta-analysis models from an <code>mtc.network</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtc.model(network, type = "consistency", factor = 2.5, n.chain = 4,
  likelihood=NULL, link=NULL, linearModel="random",
  om.scale=NULL, hy.prior=mtc.hy.prior("std.dev", "dunif", 0, "om.scale"),
  re.prior.sd=15 * om.scale, dic=TRUE, powerAdjust=NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtc.model_+3A_network">network</code></td>
<td>
<p>An object of S3 class <code>mtc.network</code></p>
</td></tr>
<tr><td><code id="mtc.model_+3A_type">type</code></td>
<td>
<p>A string literal indicating the type of model (allowed values are &quot;consistency&quot;, &quot;regression&quot;, &quot;nodesplit&quot;, &quot;ume&quot;, or &quot;use&quot;).</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_factor">factor</code></td>
<td>
<p>Variance scaling factor for the starting values</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_n.chain">n.chain</code></td>
<td>
<p>Number of chains in the model</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_likelihood">likelihood</code></td>
<td>
<p>The likelihood to be used. If unspecified, a suitable likelihood will be inferred for the given data.</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_link">link</code></td>
<td>
<p>The link function to be used. If unspecified, a suitable link function will be inferred for the given data.</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_linearmodel">linearModel</code></td>
<td>
<p>The type of linear model to be generated. Can be &quot;random&quot; for a random effects model, or &quot;fixed&quot; for a fixed effect model.</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_om.scale">om.scale</code></td>
<td>
<p>Outcome measure scale. Represents a &quot;very large&quot; difference on the analysis' outcome scale. This is used to set vague priors. For the log odds-ratio, values between 2 and 5 are considered reasonable. For continuous outcomes, this depends heavily on the specific outcome. If left unspecified, it is determined from the data.</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_hy.prior">hy.prior</code></td>
<td>
<p>Heterogeneity prior. See <code><a href="#topic+mtc.hy.prior">mtc.hy.prior</a></code>.</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_re.prior.sd">re.prior.sd</code></td>
<td>
<p>Standard deviation for the relative effects prior (normal distribution).</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_dic">dic</code></td>
<td>
<p>When set to TRUE, deviance and fitted values will be monitored to allow computation of the Deviance Information Criterion (DIC) at residual.</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_poweradjust">powerAdjust</code></td>
<td>
<p>Optional: the name of a column in the studies data frame of the <code>mtc.network</code>. This column must contain values between 0 and 1. The likelihood for each study will be adjusted by inflating the variance, where 0 means the study is excluded and 1 means it receives full weight. See details for more.</p>
</td></tr>
<tr><td><code id="mtc.model_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the type-specific model generation function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>mtc.model</code> function generates an object of S3 class <code>mtc.model</code>, which can be
visualized by the generic <code>plot</code> function or summarized by the generic <code>summary</code> function.
</p>
<p>These likelihood/links are supported:
</p>

<ul>
<li><p>normal/identity: for continuous (mean difference) data.
</p>
<p>Required columns: <code>[mean, std.err]</code> or <code>[mean, std.dev, sampleSize]</code>.
</p>
<p>Result: relative mean difference.
</p>
</li>
<li><p>binom/logit: for dichotomous data.
</p>
<p>Required columns <code>[responders, sampleSize]</code>.
</p>
<p>Result: (log) odds ratio.
</p>
</li>
<li><p>binom/log: for dichotomous data.
</p>
<p>Required columns <code>[responders, sampleSize]</code>.
</p>
<p>Result: (log) risk ratio.
</p>
</li>
<li><p>binom/cloglog: for rate (survival) data - equal follow-up in each arm.
</p>
<p>Required columns <code>[responders, sampleSize]</code>.
</p>
<p>Result: (log) hazard ratio.
</p>
</li>
<li><p>poisson/log: for rate (survival) data.
</p>
<p>Required columns <code>[responders, exposure]</code>.
</p>
<p>Result: (log) hazard ratio.
</p>
</li></ul>

<p>Most likelihood/links follow <a href="#topic+gemtc-package">[Dias et al. 2013a]</a>, and the binom/log model follows <a href="#topic+gemtc-package">[Warn et al. 2002]</a>.
</p>
<p>The following model types are supported:
</p>

<ul>
<li><p><code>consistency</code>: ordinary consistency model. No additional parameters. <a href="#topic+gemtc-package">[Dias et al. 2013a, van Valkenhoef et al. 2012]</a>
</p>
</li>
<li><p><code>nodesplit</code>: node-splitting model. Removes both arms used to estimate the direct evidence from the network of indirect evidence, rather than just one of those arms. This means that three-arm trials do not contribute any evidence in the network of indirect evidence. When relative effect data are present, these are transformed appropriately (using an assumption of normality) to enable this direct/indirect evidence split. Additional parameters: <code>t1</code> and <code>t2</code>, which indicate the comparison to be split. <a href="#topic+gemtc-package">[Dias et al. 2010, van Valkenhoef et al. 2015]</a>
</p>
</li>
<li><p><code>regression</code>: meta-regression model. Additional parameters: <code>regressor</code>, which indicates how to structure the treatment-interaction model for the regression. See below for details.
</p>
</li>
<li><p><code>use</code>: unrelated study effects. Models the effects within each study as if the studies are independent. No additional parameters. <a href="#topic+gemtc-package">[van Valkenhoef et al. (draft)]</a>
</p>
</li>
<li><p><code>ume</code>: unrelated mean effects. Models the effects within each comparison as if they are independent. Does not properly handle multi-arm trials, and warns when they are present in the network. No additional parameters. <a href="#topic+gemtc-package">[Dias et al. 2013b, van Valkenhoef et al. (draft)]</a>
</p>
</li></ul>

<p>Regressor specification: a list with elements: <code>variable</code>, <code>coefficient</code>, and either <code>control</code> or <code>classes</code>.
The <code>variable</code> is the name of the covariate to include in the regression analysis, and must be a column of the studies data frame in the network.
The regressor variable is automatically centered and standardized using the method recommended by <a href="#topic+gemtc-package">Gelman et al. (2008)</a>.
The <code>coefficient</code> indicates the type of treatment-interaction model: &quot;shared&quot;, &quot;unrelated&quot;, or &quot;exchangeable&quot;.
<code>control</code>, if specified, must be the ID of a treatment in the network.
All other treatments have a coefficient relative to the control, which can be the same for all treatments (&quot;shared&quot;), different for all treatments (&quot;unrelated&quot;) or exchangeable between treatments (&quot;exchangeable&quot;).
<code>classes</code> is a named list of treatment classes, the first of which will act as the control class.
Each class is a vector of treatment IDs from the network.
Only &quot;shared&quot; coefficients can currently be used, meaning a single coefficient per class (except the control class).
See also <code><a href="#topic+atrialFibrillation">atrialFibrillation</a></code>, <code><a href="#topic+certolizumab">certolizumab</a></code>, and <code><a href="#topic+hfPrevention">hfPrevention</a></code> for examples of meta-regression analyses.
</p>
<p>Studies can be downweighted by using the <code>powerAdjust</code> argument, which applies a variance inflation (also known as &quot;power prior&quot;) to the likelihood.
This allows a weight <code class="reqn">\alpha_i \in [0, 1]</code> to be specified for each study <code class="reqn">i</code>.
The log-likelihood will be multiplied by a factor <code class="reqn">\alpha_i</code>, or equivalently for normal distributions the variance will be multiplied by <code class="reqn">1/\alpha_i</code>.
Setting <code class="reqn">\alpha_i = 0</code> will completely exclude that study, whereas setting <code class="reqn">\alpha_i = 1</code> will weight it fully.
Essentially, down-weighted models modify the data and hence model fit statistics such as DIC can not be compared between models with different weightings.
</p>


<h3>Value</h3>

<p>An object of class <code>mtc.model</code>.
The following elements are descriptive:
</p>
<table>
<tr><td><code>type</code></td>
<td>
<p>The type of model</p>
</td></tr>
<tr><td><code>network</code></td>
<td>
<p>Network the model was generated from</p>
</td></tr>
<tr><td><code>tree</code></td>
<td>
<p>Spanning tree formed by the basic parameters</p>
</td></tr>
<tr><td><code>var.scale</code></td>
<td>
<p>The scaling factor used to over-disperse starting values</p>
</td></tr>
<tr><td><code>likelihood</code></td>
<td>
<p>The likelihood used</p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p>The link function used</p>
</td></tr>
<tr><td><code>om.scale</code></td>
<td>
<p>The scale for the variance parameters</p>
</td></tr>
<tr><td><code>regressor</code></td>
<td>
<p>Regressor specification (regression models only): includes additional elements &quot;center&quot; and &quot;scale&quot; describing how the regressor input was standardized</p>
</td></tr>
</table>
<p>These elements determine the model run by JAGS:
</p>
<table>
<tr><td><code>n.chain</code></td>
<td>
<p>The number of chains</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>Model code in JAGS syntax. Use <code>cat()</code> for proper formatting.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Data in JAGS compatible format</p>
</td></tr>
<tr><td><code>inits</code></td>
<td>
<p>Initial values in JAGS compatible format</p>
</td></tr>
<tr><td><code>monitors</code></td>
<td>
<p>The nodes of the JAGS model to monitor</p>
</td></tr>
<tr><td><code>dic</code></td>
<td>
<p>Whether to compute the DIC</p>
</td></tr>
</table>
<p>These latter fields can be modified to alter the statistical model, but such changes may break the model or assumptions made elsewhere in the package.
</p>


<h3>Visualization</h3>

<p>Calling the generic plot method on an S3 <code>mtc.model</code> object
will show a graph with the treatments as vertices and the comparisons as edges.
The lines with solid arrows represent basic parameters, and the other lines represent comparisons that are not associated with any parameter but do have direct evidence from trials.
</p>

<p>The example code will generate the following graph:
</p>
<p><img src="../help/figures/parkinson.png" alt="Graph showing structure of a consistency model generated from parkison example data" />


The default layout algorithm is <code>igraph::layout.circle</code>, other layout algorithms can be used by passing them as an optional argument called <code>layout</code> to <code>plot</code>.
The <code>igraph::layout.fruchterman.reingold</code> algorithm also seems to produce nice results and may be better for large graphs.
</p>


<h3>Reproducible results</h3>

<p>It is possible to get reproducible results, but as JAGS uses its own pseudo-random number generator, this is somewhat more involved.
</p>
<p><code>mtc.model</code> generates random numbers using the R functions (for example to generate initial values). Therefore, <code>set.seed</code> must be called before calling <code>mtc.model</code>.
</p>
<p>Then, before calling <code>mtc.run</code>, the random number generator type and seed must be set for each of the chains. This can be done as documented in <code>jags.model</code>, by setting the <code>.RNG.name</code> and <code>.RNG.seed</code> for each chain in <code>model$inits</code>. See below for an example.</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef, Joël Kuiper</p>


<h3>See Also</h3>


<p><code><a href="#topic+mtc.network">mtc.network</a></code>, <code><a href="#topic+mtc.run">mtc.run</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random effects consistency model for Parkinson network
model &lt;- mtc.model(parkinson)
plot(model)
summary(model)

# Fixed effect meta-regression for heart failure prevention
regressor &lt;- list(coefficient='shared',
                  variable='secondary',
                  control='control')

model &lt;- mtc.model(hfPrevention,
                   type="regression",
                   regressor=regressor,
                   linearModel="fixed")

# Reproducible results
# Set the R RNG seed
set.seed(42)
model &lt;- mtc.model(parkinson, likelihood='normal', link='identity')
# By default, the model will have 4 chains - generate a seed for each
seeds &lt;- sample.int(4, n = .Machine$integer.max)
# Apply JAGS RNG settings to each chain
model$inits &lt;- mapply(c, model$inits, list(
  list(.RNG.name="base::Wichmann-Hill", .RNG.seed=seeds[1]),
  list(.RNG.name="base::Marsaglia-Multicarry", .RNG.seed=seeds[2]),
  list(.RNG.name="base::Super-Duper", .RNG.seed=seeds[3]),
  list(.RNG.name="base::Mersenne-Twister", .RNG.seed=seeds[4])), SIMPLIFY=FALSE)
</code></pre>

<hr>
<h2 id='mtc.network'>Create an mtc.network</h2><span id='topic+mtc.network'></span><span id='topic+plot.mtc.network'></span>

<h3>Description</h3>

<p>Creates an object of class <code>mtc.network</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>mtc.network(data.ab=data, treatments=NULL, description="Network",
            data.re=NULL, studies=NULL, data=NULL)

## S3 method for class 'mtc.network'
plot(x, layout=igraph::layout.circle, dynamic.edge.width=TRUE, use.description=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtc.network_+3A_data.ab">data.ab</code></td>
<td>
<p>Arm-level data.
A data frame defining the arms of each study, containing the columns &lsquo;study&rsquo; and &lsquo;treatment&rsquo;, where
&lsquo;treatment&rsquo; must refer to an existing treatment ID if treatments were specified.
Further columns define the data per arm, and depend on the likelihood/link to be used.
See <code><a href="#topic+mtc.model">mtc.model</a></code> for supported likelihood/links and their data requirements.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_data.re">data.re</code></td>
<td>
<p>Relative effect data.
A data frame defining the arms of each study, containing the columns &lsquo;study&rsquo; and &lsquo;treatment&rsquo;, where
&lsquo;treatment&rsquo; must refer to an existing treatment ID if treatments were specified.
The column &lsquo;diff&rsquo; specifies the mean difference between the current arm and the baseline arm; set &lsquo;diff=NA&rsquo; for the baseline arm.
The column &lsquo;std.err&rsquo; specifies the standard error of the mean difference (for non-baseline arms).
For trials with more than two arms, specify the standard error of the mean of the baseline arm in
&lsquo;std.err&rsquo;, as this determines the covariance of the differences.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_treatments">treatments</code></td>
<td>
<p>Optional.
A data frame with columns &lsquo;id&rsquo; and &lsquo;description&rsquo; defining the treatments or a vector giving the treatment IDs.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_studies">studies</code></td>
<td>
<p>Optional.
A data frame with a &lsquo;study&rsquo; column naming the studies and additional columns containing covariate values.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_description">description</code></td>
<td>
<p>Optional. Short description of the network.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_data">data</code></td>
<td>
<p>Deprecated. Arm-level data; automatically assigned to data.ab if it is not specified.
Present for compatibility with older versions.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_x">x</code></td>
<td>
<p>An mtc.network object.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_layout">layout</code></td>
<td>
<p>An igraph-compatible layout.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_dynamic.edge.width">dynamic.edge.width</code></td>
<td>
<p>If set to TRUE, dynamically set the edge width based on the number of studies.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_use.description">use.description</code></td>
<td>
<p>Display treatment descriptions instead of treatment IDs.</p>
</td></tr>
<tr><td><code id="mtc.network_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>plot.igraph</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>One-arm trials are automatically removed, which results in a warning.
</p>
<p>Also see <code><a href="#topic+mtc.data.studyrow">mtc.data.studyrow</a></code> for a convenient way to import data from the one-study-per-row format, which is very popular for BUGS code.
</p>


<h3>Value</h3>

<p>For <code>mtc.network</code>, an object of the class <code>mtc.network</code> which is a list containing:
</p>
<table>
<tr><td><code>description</code></td>
<td>
<p>A short description of the network</p>
</td></tr>
<tr><td><code>treatments</code></td>
<td>
<p>A data frame describing the treatments</p>
</td></tr>
<tr><td><code>data.ab</code></td>
<td>
<p>A data frame containing the network data (arm-level)</p>
</td></tr>
<tr><td><code>data.re</code></td>
<td>
<p>A data frame containing the network data (relative effects)</p>
</td></tr>
<tr><td><code>studies</code></td>
<td>
<p>A data frame containing study-level information (covariates)</p>
</td></tr>
</table>
<p>These are cleaned up and standardized versions of the arguments provided, or generated defaults for &lsquo;treatments&rsquo; if the argument was omitted.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef, Joël Kuiper</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtc.data.studyrow">mtc.data.studyrow</a></code>,
<code><a href="#topic+mtc.model">mtc.model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a new network by specifying all information.
treatments &lt;- read.table(textConnection('
  id  description
  A   "Treatment A"
  B   "Treatment B"
  C   "Treatment C"'), header=TRUE)
data &lt;- read.table(textConnection('
  study  treatment  responders  sampleSize
  01     A          2           100
  01     B          5           100
  02     B          6           110
  02     C          1           110
  03     A          3           60
  03     C          4           80
  03     B          7           80'), header=TRUE)
network &lt;- mtc.network(data, description="Example", treatments=treatments)
plot(network)

# Create a new network by specifying only the data.
data &lt;- read.table(textConnection('
  study  treatment  mean   std.dev  sampleSize
  01     A          -1.12  0.6      15
  01     B          -1.55  0.5      16
  02     A          -0.8   0.7      33
  02     B          -1.1   0.5      31'), header=TRUE)
network &lt;- mtc.network(data)

# Print the network
print(network)
## MTC dataset: Network
##   study treatment  mean std.dev sampleSize
## 1     1         A -1.12     0.6         15
## 2     1         B -1.55     0.5         16
## 3     2         A -0.80     0.7         33
## 4     2         B -1.10     0.5         31
</code></pre>

<hr>
<h2 id='mtc.nodesplit'>Node-splitting analysis of inconsistency</h2><span id='topic+mtc.nodesplit'></span><span id='topic+mtc.nodesplit.comparisons'></span><span id='topic+plot.mtc.nodesplit'></span><span id='topic+print.mtc.nodesplit'></span><span id='topic+summary.mtc.nodesplit'></span><span id='topic+plot.mtc.nodesplit.summary'></span><span id='topic+print.mtc.nodesplit.summary'></span>

<h3>Description</h3>

<p>Generate and run an ensemble of node-splitting models, results of which can be jointly summarized and plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtc.nodesplit(network, comparisons=mtc.nodesplit.comparisons(network), ...)
mtc.nodesplit.comparisons(network)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtc.nodesplit_+3A_network">network</code></td>
<td>
<p>An object of S3 class <code><a href="#topic+mtc.network">mtc.network</a></code>.</p>
</td></tr>
<tr><td><code id="mtc.nodesplit_+3A_comparisons">comparisons</code></td>
<td>
<p>Data frame specifying the comparisons to be split. The frame has two columns: 't1' and 't2'.</p>
</td></tr>
<tr><td><code id="mtc.nodesplit_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code><a href="#topic+mtc.run">mtc.run</a></code> or <code><a href="#topic+mtc.model">mtc.model</a></code>. This can be used to set the likelihood/link or the number of iterations, for example.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mtc.nodesplit</code> returns the MCMC results for all relevant node-splitting models <a href="#topic+gemtc-package">[van Valkenhoef et al. 2015]</a>. To get appropriate summary statistics, call <code>summary()</code> on the results object. The summary can be plotted.
See <code><a href="#topic+mtc.model">mtc.model</a></code> for details on how the node-splitting models are generated.
</p>
<p>To control parameters of the MCMC estimation, see <code><a href="#topic+mtc.run">mtc.run</a></code>.
To specify the likelihood/link or to control other model parameters, see <code><a href="#topic+mtc.model">mtc.model</a></code>.
The <code>...</code> arguments are first matched against <code><a href="#topic+mtc.run">mtc.run</a></code>, and those that do not match are passed to <code><a href="#topic+mtc.model">mtc.model</a></code>.
</p>
<p><code>mtc.nodesplit.comparisons</code> returns a data frame enumerating all comparisons that can reasonably be split (i.e. have independent indirect evidence).
</p>


<h3>Value</h3>

<p>For <code>mtc.nodesplit</code>:
an object of class <code>mtc.nodesplit</code>. This is a list with the following elements: 
</p>
<table>
<tr><td><code>d.X.Y</code></td>
<td>
<p>For each comparison (t1=X, t2=Y), the MCMC results</p>
</td></tr>
<tr><td><code>consistency</code></td>
<td>
<p>The consistency model results</p>
</td></tr>
</table>
<p>For <code>summary</code>:
an object of class <code>mtc.nodesplit.summary</code>. This is a list with the following elements: 
</p>
<table>
<tr><td><code>dir.effect</code></td>
<td>
<p>Summary of direct effects for each split comparison</p>
</td></tr>
<tr><td><code>ind.effect</code></td>
<td>
<p>Summary of indirect effects for each split comparison</p>
</td></tr>
<tr><td><code>cons.effect</code></td>
<td>
<p>Summary of consistency model effects for each split comparison</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>Inconsistency p-values for each split comparison</p>
</td></tr>
<tr><td><code>cons.model</code></td>
<td>
<p>The generated consistency model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef, Joël Kuiper</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtc.model">mtc.model</a></code>
<code><a href="#topic+mtc.run">mtc.run</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run all relevant node-splitting models
## Not run:  result.ns &lt;- mtc.nodesplit(parkinson, thin=50) 
# (read results from file instead of running:)
result.ns &lt;- readRDS(system.file('extdata/parkinson.ns.rds', package='gemtc'))

# List the individual models 
names(result.ns)

# Time series plots and convergence diagnostics for d.A.C model
plot(result.ns$d.A.C)
gelman.diag(result.ns$d.A.C, multivariate=FALSE)

# Overall summary and plot
summary.ns &lt;- summary(result.ns)
print(summary.ns)
plot(summary.ns)
</code></pre>

<hr>
<h2 id='mtc.run'>Running an <code>mtc.model</code> using an MCMC sampler</h2><span id='topic+mtc.run'></span><span id='topic+mtc.result'></span><span id='topic+summary.mtc.result'></span><span id='topic+plot.mtc.result'></span><span id='topic+forest.mtc.result'></span><span id='topic+print.mtc.result'></span><span id='topic+as.mcmc.list.mtc.result'></span>

<h3>Description</h3>

<p>The function <code>mtc.run</code> is used to generate samples from a object of type <code>mtc.model</code> using a MCMC sampler.
The resulting <code>mtc.result</code> object can be coerced to an <code>mcmc.list</code> for further analysis of the dataset using the <code>coda</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtc.run(model, sampler = NA, n.adapt = 5000, n.iter = 20000, thin = 1)

## S3 method for class 'mtc.result'
summary(object, ...)
## S3 method for class 'mtc.result'
plot(x, ...)
## S3 method for class 'mtc.result'
forest(x, use.description=FALSE, ...)
## S3 method for class 'mtc.result'
print(x, ...)
## S3 method for class 'mtc.result'
as.mcmc.list(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtc.run_+3A_model">model</code></td>
<td>
<p>An object of S3 class <code>mtc.model</code> describing a network meta-analysis model.</p>
</td></tr>
<tr><td><code id="mtc.run_+3A_sampler">sampler</code></td>
<td>
<p>Deprecated: gemtc now only supports the JAGS sampler. Specifying a sampler will result in a warning or error. This argument will be removed in future versions.</p>
</td></tr>
<tr><td><code id="mtc.run_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Amount of adaptation (or tuning) iterations.</p>
</td></tr>
<tr><td><code id="mtc.run_+3A_n.iter">n.iter</code></td>
<td>
<p>Amount of simulation iterations.</p>
</td></tr>
<tr><td><code id="mtc.run_+3A_thin">thin</code></td>
<td>
<p>Thinning factor.</p>
</td></tr>
<tr><td><code id="mtc.run_+3A_object">object</code></td>
<td>
<p>Object of S3 class <code>mtc.result</code>.</p>
</td></tr>
<tr><td><code id="mtc.run_+3A_x">x</code></td>
<td>
<p>Object of S3 class <code>mtc.result</code>.</p>
</td></tr>
<tr><td><code id="mtc.run_+3A_use.description">use.description</code></td>
<td>
<p>Display treatment descriptions instead of treatment IDs.</p>
</td></tr>
<tr><td><code id="mtc.run_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mtc.result</code>. This is a list with the following elements: 
</p>
<table>
<tr><td><code>samples</code></td>
<td>
<p>The samples resulting from running the MCMC model, in <code>mcmc.list</code> format.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>The <code>mtc.model</code> used to produce the samples.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>Residual deviance statistics, a list with the following elements. <code>DIC</code>: deviance information criterion at residual (Dbar + pD). <code>Dbar</code>: mean sum of residual deviance. <code>pD</code>: sum of leverage, also known as the effective number of parameters. <code>dev.ab</code>: mean posterior residual deviance of each arm (for arm-based data). <code>fit.ab</code>: deviance at the posterior mean of te fitted values (for arm-based data). <code>dev.re</code>: mean posterior residual deviance of each study (for relative-effect data). <code>fit.re</code>: deviance at the posterior mean of the fitted values (for relative-effect data).</p>
</td></tr>
</table>
<p>The object can be coerced to an <code>mcmc.list</code> from the <code>coda</code> package by the generic S3 method <code>as.mcmc.list</code>.
</p>


<h3>Analysis of the results</h3>

<p>Convergence of the model can be assessed using methods from the <code>coda</code> package.
For example the Brooks-Gelman-Rubin method (<code>coda::gelman.diag</code>, <code>coda::gelman.plot</code>).
The <code>summary</code> also provides useful information, such as the MCMC error and the time series and densities given by <code>plot</code> should also be inspected.
</p>
<p>The <code>forest</code> function can provide forest plots for <code>mtc.result</code> objects.
This is especially useful in combination with the <code><a href="#topic+relative.effect">relative.effect</a></code> function that can be used to calculate relative effects compared to any baseline for consistency models.
The <code><a href="#topic+rank.probability">rank.probability</a></code> function calculates rank probabilities for consistency models.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef, Joël Kuiper</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtc.model">mtc.model</a></code>
</p>
<p><code><a href="#topic+relative.effect.table">relative.effect.table</a></code>,
<code><a href="#topic+relative.effect">relative.effect</a></code>,
<code><a href="#topic+rank.probability">rank.probability</a></code>
</p>
<p><code>coda::gelman.diag</code>,
<code>coda::gelman.plot</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- mtc.model(smoking)

## Not run: results &lt;- mtc.run(model, thin=10)
results &lt;- readRDS(system.file("extdata/luades-smoking-samples.rds", package="gemtc"))

# Convergence diagnostics
gelman.plot(results)

# Posterior summaries
summary(results)
## Iterations = 5010:25000
## Thinning interval = 10 
## Number of chains = 4 
## Sample size per chain = 2000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##         Mean     SD Naive SE Time-series SE
## d.A.B 0.4965 0.4081 0.004563       0.004989
## d.A.C 0.8359 0.2433 0.002720       0.003147
## d.A.D 1.1088 0.4355 0.004869       0.005280
## sd.d  0.8465 0.1913 0.002139       0.002965
## 
## 2. Quantiles for each variable:
## 
##          2.5%    25%    50%    75% 97.5%
## d.A.B -0.2985 0.2312 0.4910 0.7530 1.341
## d.A.C  0.3878 0.6720 0.8273 0.9867 1.353
## d.A.D  0.2692 0.8197 1.0983 1.3824 2.006
## sd.d   0.5509 0.7119 0.8180 0.9542 1.283

plot(results) # Shows time-series and density plots of the samples
forest(results) # Shows a forest plot
</code></pre>

<hr>
<h2 id='parkinson'>Mean off-time reduction in Parkinson's disease</h2><span id='topic+parkinson'></span><span id='topic+parkinson_diff'></span><span id='topic+parkinson_shared'></span>

<h3>Description</h3>

<p>A dataset of seven trials investigating four treatments and placebo for Parkinson's disease. The outcome is mean off-time reduction.</p>


<h3>Format</h3>

 
<ul>
<li><p>parkinson: A network meta-analysis dataset containing fifteen rows of arm-based data (mean, standard deviation, and sample size).
</p>
</li>
<li><p>parkinson_diff: A network meta-analysis dataset containing fifteen rows of contrast-based data.
</p>
</li>
<li><p>parkinson_shared: A network meta-analysis dataset containing mixed arm-based and contrast-based data.
</p>
</li></ul>
 

<h3>Source</h3>

<p>Franchini et al. (2012),
<em>Accounting for correlation in network meta-analysis with multi-arm trials</em>,
Research Synthesis Methods, 3(2):142-160.
[<a href="https://doi.org/10.1002/jrsm.1049">doi:10.1002/jrsm.1049</a>]
</p>

<hr>
<h2 id='plotCovariateEffect'>Plot treatment effects versus covariate values</h2><span id='topic+plotCovariateEffect'></span>

<h3>Description</h3>

<p>The plot will show the median treatment effect and the 95% credible interval on the y-axis and the covariate value on the x-axis.
One plot page will be generated per pair of treatments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCovariateEffect(result, t1, t2, xlim=NULL, ylim=NULL,
                    ask=dev.interactive(orNone=TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCovariateEffect_+3A_result">result</code></td>
<td>
<p>Results object - created by <code>mtc.result</code></p>
</td></tr>
<tr><td><code id="plotCovariateEffect_+3A_t1">t1</code></td>
<td>
<p>A list of baseline treatments to calculate treatment effects against. Will be extended to match the length of t2.</p>
</td></tr>
<tr><td><code id="plotCovariateEffect_+3A_t2">t2</code></td>
<td>
<p>A list of treatments to calculate the effects for. Will be extended to match the length of t1.
If left empty and t1 is a single treatment, effects of all treatments except t1 will be calculated.</p>
</td></tr>
<tr><td><code id="plotCovariateEffect_+3A_xlim">xlim</code></td>
<td>
<p>The x-axis limits.</p>
</td></tr>
<tr><td><code id="plotCovariateEffect_+3A_ylim">ylim</code></td>
<td>
<p>The y-axis limits.</p>
</td></tr>
<tr><td><code id="plotCovariateEffect_+3A_ask">ask</code></td>
<td>
<p>If TRUE, a prompt will be displayed before generating the next page of a multi-page plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Default x-axis limits will be set to three standard deviations above and below the centering value of the covariate.
The y-axis limits will be set based on the minimum and maximum 95% CrI limits among the set of effects computed.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef</p>


<h3>See Also</h3>

<p><code><a href="#topic+relative.effect">relative.effect</a></code>, <code><a href="#topic+mtc.run">mtc.run</a></code>
</p>

<hr>
<h2 id='rank.probability'>Calculating rank-probabilities</h2><span id='topic+rank.probability'></span><span id='topic+print.mtc.rank.probability'></span><span id='topic+plot.mtc.rank.probability'></span><span id='topic+sucra'></span><span id='topic+rank.quantiles'></span>

<h3>Description</h3>

<p>Rank probabilities indicate the probability for each treatment to be best, second best, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank.probability(result, preferredDirection=1, covariate=NA)

## S3 method for class 'mtc.rank.probability'
print(x, ...)
## S3 method for class 'mtc.rank.probability'
plot(x, ...)

sucra(ranks)
rank.quantiles(ranks, probs=c("2.5%"=0.025, "50%"=0.5, "97.5%"=0.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rank.probability_+3A_result">result</code></td>
<td>
<p>Object of S3 class <code>mtc.result</code> to be used in creation of the rank probability table</p>
</td></tr>
<tr><td><code id="rank.probability_+3A_preferreddirection">preferredDirection</code></td>
<td>
<p>Preferential direction of the outcome. Set 1 if higher values are preferred, -1 if lower values are preferred.</p>
</td></tr>
<tr><td><code id="rank.probability_+3A_covariate">covariate</code></td>
<td>
<p>(Regression analyses only) Value of the covariate at which to compute rank probabilities.</p>
</td></tr>
<tr><td><code id="rank.probability_+3A_x">x</code></td>
<td>
<p>An object of S3 class <code>rank.probability</code>.</p>
</td></tr>
<tr><td><code id="rank.probability_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="rank.probability_+3A_ranks">ranks</code></td>
<td>
<p>A ranking matrix where the treatments are the rows (e.g. the result of rank.probability).</p>
</td></tr>
<tr><td><code id="rank.probability_+3A_probs">probs</code></td>
<td>
<p>Probabilities at which to give quantiles.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each MCMC iteration, the treatments are ranked by their effect relative to an arbitrary baseline.
A frequency table is constructed from these rankings and normalized by the number of iterations to give the rank probabilities.
</p>


<h3>Value</h3>

<p><code>rank.probability</code>: A matrix (with class <code>mtc.rank.probability</code>) with the treatments as rows and the ranks as columns.
<code>sucra</code>: A vector of SUCRA values.
<code>rank.quantiles</code>: A matrix with treatments as rows and quantiles as columns, giving the quantile ranks (by default, the median and 2.5% and 97.5% ranks).
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef, Joël Kuiper</p>


<h3>See Also</h3>

<p><code><a href="#topic+relative.effect">relative.effect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- mtc.model(smoking)
# To save computation time we load the samples instead of running the model
## Not run: results &lt;- mtc.run(model)
results &lt;- readRDS(system.file("extdata/luades-smoking-samples.rds", package="gemtc"))

ranks &lt;- rank.probability(results)
print(ranks)
## Rank probability; preferred direction = 1
##       [,1]     [,2]     [,3]     [,4]
## A 0.000000 0.003000 0.105125 0.891875
## B 0.057875 0.175875 0.661500 0.104750
## C 0.228250 0.600500 0.170875 0.000375
## D 0.713875 0.220625 0.062500 0.003000

print(sucra(ranks))
##          A          B          C          D
## 0.03670833 0.39591667 0.68562500 0.88175000

print(rank.quantiles(ranks))
##   2.5% 50% 97.5%
## A    3   4     4
## B    1   3     4
## C    1   2     3
## D    1   1     3

plot(ranks) # plot a cumulative rank plot
plot(ranks, beside=TRUE) # plot a 'rankogram'
</code></pre>

<hr>
<h2 id='relative.effect'>Calculating relative effects</h2><span id='topic+relative.effect'></span>

<h3>Description</h3>

<p>Calculates the relative effects of pairs of treatments.</p>


<h3>Usage</h3>

<pre><code class='language-R'>relative.effect(result, t1, t2 = c(), preserve.extra = TRUE, covariate = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relative.effect_+3A_result">result</code></td>
<td>
<p>An object of S3 class <code>mtc.result</code> to derive the relative effects from.</p>
</td></tr>
<tr><td><code id="relative.effect_+3A_t1">t1</code></td>
<td>
<p>A list of baselines to calculate a relative effects against. Will be extended to match the length of t2.</p>
</td></tr>
<tr><td><code id="relative.effect_+3A_t2">t2</code></td>
<td>
<p>A list of treatments to calculate the relative effects for. Will be extended to match the length of t1.
If left empty and t1 is a single treatment, relative effects of all treatments except t1 will be calculated.</p>
</td></tr>
<tr><td><code id="relative.effect_+3A_preserve.extra">preserve.extra</code></td>
<td>
<p>Indicates whether to preserve extra parameters such as the sd.d.</p>
</td></tr>
<tr><td><code id="relative.effect_+3A_covariate">covariate</code></td>
<td>
<p>(Regression analyses only) Value of the covariate at which to compute relative effects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an <code>mtc.results</code> object containing the calculated relative effects.
</p>
<p>Note that this method stores the raw samples, which may result in excessive memory usage. You may want to consider using <code><a href="#topic+relative.effect.table">relative.effect.table</a></code> instead.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef, Joël Kuiper</p>


<h3>See Also</h3>

<p><code><a href="#topic+rank.probability">rank.probability</a></code>,
<code><a href="#topic+relative.effect.table">relative.effect.table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- mtc.model(smoking)
# To save computation time we load the samples instead of running the model
## Not run: results &lt;- mtc.run(model)
results &lt;- readRDS(system.file("extdata/luades-smoking-samples.rds", package="gemtc"))

# Creates a forest plot of the relative effects
forest(relative.effect(results, "A"))

summary(relative.effect(results, "B", c("A", "C", "D")))
## Iterations = 5010:25000
## Thinning interval = 10 
## Number of chains = 4 
## Sample size per chain = 2000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##          Mean     SD Naive SE Time-series SE
## d.B.A -0.4965 0.4081 0.004563       0.004989
## d.B.C  0.3394 0.4144 0.004634       0.004859
## d.B.D  0.6123 0.4789 0.005354       0.005297
## sd.d   0.8465 0.1913 0.002139       0.002965
## 
## 2. Quantiles for each variable:
## 
##          2.5%     25%     50%     75%  97.5%
## d.B.A -1.3407 -0.7530 -0.4910 -0.2312 0.2985
## d.B.C -0.4809  0.0744  0.3411  0.5977 1.1702
## d.B.D -0.3083  0.3005  0.6044  0.9152 1.5790
## sd.d   0.5509  0.7119  0.8180  0.9542 1.2827
</code></pre>

<hr>
<h2 id='relative.effect.table'>Table of relative effects</h2><span id='topic+relative.effect.table'></span><span id='topic+forest.mtc.relative.effect.table'></span><span id='topic+print.mtc.relative.effect.table'></span><span id='topic+as.data.frame.mtc.relative.effect.table'></span>

<h3>Description</h3>

<p>Generates a table of the relative effects of all pairs of treatments. Unlike <code><a href="#topic+relative.effect">relative.effect</a></code>, this method stores summaries only, not raw samples.</p>


<h3>Usage</h3>

<pre><code class='language-R'>relative.effect.table(result, covariate=NA)

## S3 method for class 'mtc.relative.effect.table'
print(x, ...)
## S3 method for class 'mtc.relative.effect.table'
forest(x, t1, use.description=FALSE, ...)
## S3 method for class 'mtc.relative.effect.table'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relative.effect.table_+3A_result">result</code></td>
<td>
<p>An object of S3 class <code>mtc.result</code> to derive the relative effects from.</p>
</td></tr>
<tr><td><code id="relative.effect.table_+3A_covariate">covariate</code></td>
<td>
<p>(Regression analyses only) Value of the covariate at which to compute relative effects.</p>
</td></tr>
<tr><td><code id="relative.effect.table_+3A_x">x</code></td>
<td>
<p>An object of S3 class <code>mtc.relative.effect.table</code>.</p>
</td></tr>
<tr><td><code id="relative.effect.table_+3A_t1">t1</code></td>
<td>
<p>Baseline treatment for the Forest plot.</p>
</td></tr>
<tr><td><code id="relative.effect.table_+3A_use.description">use.description</code></td>
<td>
<p>Display treatment descriptions instead of treatment IDs.</p>
</td></tr>
<tr><td><code id="relative.effect.table_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an <code>mtc.relative.effect.table</code> object containing the quantiles of the calculated relative effects of all pair-wise comparisons among the treatments.
</p>
<p>The result will be pretty printed as an n-by-n table of relative treatment effects.
It can also be used to produce Forest plots against any arbitrary baseline.
Finally, the <code>as.data.frame</code> generic method makes it possible to export the table for use in Excel or other spreadsheet software, using the core R methods <code>write.csv</code> or <code>write.csv2</code>.
</p>


<h3>Author(s)</h3>

<p>Gert van Valkenhoef</p>


<h3>See Also</h3>

<p><code><a href="#topic+relative.effect">relative.effect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- mtc.model(smoking)
# To save computation time we load the samples instead of running the model
## Not run: results &lt;- mtc.run(model)
results &lt;- readRDS(system.file("extdata/luades-smoking-samples.rds", package="gemtc"))

# Creates a forest plot of the relative effects
tbl &lt;- relative.effect.table(results)

# Print the n*n table
print(tbl)

# Plot effect relative to treatment "C"
forest(tbl, "C")

# Write to CSV (e.g. to import to Excel, then use in a Word table)
## Not run: write.csv(tbl, "smoking-effects.csv")
# Note: use write.csv2 for Western European locales
</code></pre>

<hr>
<h2 id='smoking'>Psychological treatments to aid smoking cessation</h2><span id='topic+smoking'></span>

<h3>Description</h3>

<p>A dataset of 24 trials investigating four psychological treatments and no treatment for smoking cessation. The outcome is the number of people who stopped smoking.</p>


<h3>Format</h3>

<p>A network meta-analysis dataset containing 50 rows of arm-based data (responders and sample size).</p>


<h3>Source</h3>

<p>Lu and Ades (2006),
<em>Assessing Evidence Inconsistency in Mixed Treatment Comparisons</em>,
Journal of the American Statistical Society, 101(474):447-459.
[<a href="https://doi.org/10.1198/016214505000001302">doi:10.1198/016214505000001302</a>]
</p>
<p>Hasselblad (1998),
<em>Meta-analysis of multitreatment studies</em>,
Medical Decision Making 18(1):37-43.
[<a href="https://doi.org/10.1177/0272989X9801800110">doi:10.1177/0272989X9801800110</a>]
</p>

<hr>
<h2 id='thrombolytic'>Thrombolytic treatment after acute myocardial infarction</h2><span id='topic+thrombolytic'></span>

<h3>Description</h3>

<p>A dataset of 28 trials investigating eight thrombolytic treatments administered after a myocardial infarction. The outcome is mortality after 30-35 days.</p>


<h3>Format</h3>

<p>A network meta-analysis dataset containing 58 rows of arm-based data (responders and sample size).</p>


<h3>Source</h3>

<p>Lu and Ades (2006),
<em>Assessing Evidence Inconsistency in Mixed Treatment Comparisons</em>,
Journal of the American Statistical Society, 101(474):447-459.
[<a href="https://doi.org/10.1198/016214505000001302">doi:10.1198/016214505000001302</a>]
</p>
<p>Boland et al. (2003),
<em>Early thrombolysis for the treatment of acute myocardial infarction: a systematic review and economic evaluation</em>,
Health Technology Assessment 7(15):1-136.
[<a href="https://doi.org/10.3310/hta7150">doi:10.3310/hta7150</a>]
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
