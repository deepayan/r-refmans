<!DOCTYPE html><html><head><title>Help for package ReturnCurves</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<script type="text/javascript" src="mathjax-config.js"></script>
<script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ReturnCurves}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ReturnCurves-package'><p>Estimation of Return Curves</p></a></li>
<li><a href='#adf_est'><p>Estimation of the Angular Dependence Function (ADF)</p></a></li>
<li><a href='#adf_est.class'><p>An S4 class to represent the estimation of the Angular Dependence Function</p></a></li>
<li><a href='#adf_gof'><p>Goodness of fit of the Angular Dependence function estimates</p></a></li>
<li><a href='#adf_gof.class'><p>An S4 class to represent the Goodness-of-Fit of the Angular Dependence Function estimates</p></a></li>
<li><a href='#airdata'><p>Air pollution data</p></a></li>
<li><a href='#marggpd'><p>Assessing the Marginal Tail Fits</p></a></li>
<li><a href='#marggpd.class'><p>An S4 class to represent the assessment of the the Marginal Tail Fits</p></a></li>
<li><a href='#margtransf'><p>Marginal Transformation</p></a></li>
<li><a href='#margtransf.class'><p>An S4 class to represent the Marginal Transformation</p></a></li>
<li><a href='#plot+2Cadf_est.class+2CANY-method'><p>Visualisation of the Angular Dependence Function estimates</p></a></li>
<li><a href='#plot+2Cadf_gof.class+2CANY-method'><p>Visualisation of the Goodness-of-Fit of the Angular Dependence Function estimates</p></a></li>
<li><a href='#plot+2Cmarggpd.class+2CANY-method'><p>Visualisation of the assessment of the Marginal Tail Fits</p></a></li>
<li><a href='#plot+2Cmargtransf.class+2CANY-method'><p>Visualisation of the Marginal Transformation</p></a></li>
<li><a href='#plot+2Crc_est.class+2CANY-method'><p>Visualisation of the Return Curve estimates</p></a></li>
<li><a href='#plot+2Crc_gof.class+2CANY-method'><p>Visualisation of the Goodness-of-Fit of the Return Curve estimates</p></a></li>
<li><a href='#plot+2Crc_unc.class+2CANY-method'><p>Visualisation of the Uncertainty of the Return Curve estimates</p></a></li>
<li><a href='#rc_est'><p>Estimation of the Return Curve</p></a></li>
<li><a href='#rc_est.class'><p>An S4 class to represent the estimation of the Return Curve</p></a></li>
<li><a href='#rc_gof'><p>Goodness of fit of the Return Curve estimates</p></a></li>
<li><a href='#rc_gof.class'><p>An S4 class to represent the Goodness-of-Fit of the Return Curve estimates</p></a></li>
<li><a href='#rc_unc'><p>Uncertainty of the Return Curve estimates</p></a></li>
<li><a href='#rc_unc.class'><p>An S4 class to represent the Uncertainty of the Return Curve estimates</p></a></li>
<li><a href='#runShiny'><p>Complementary Shiny app for the ReturnCurves package</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of Return Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-24</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lídia André &lt;l.andre@lancaster.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates the p-probability return curve proposed by Murphy-Barltrop et al. (2023) &lt;<a href="https://doi.org/10.1002%2Fenv.2797">doi:10.1002/env.2797</a>&gt;. Implements pointwise and smooth estimation of the angular dependence function introduced by Wadsworth and Tawn (2013) &lt;<a href="https://doi.org/10.3150%2F12-BEJ471">doi:10.3150/12-BEJ471</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>evd, ismev, Rdpack, mathjaxr, ggplot2 (&ge; 3.4.4), gridExtra,
methods, stats, shiny, tools, DT, shinydashboard, openair</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack, mathjaxr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'adf_est.R' 'adf_gof.R' 'adf_properties.R' 'bootstrap.R'
'composite_likelihood.R' 'heffernantawn.R'
'marginal_transform.R' 'min_projection_hill.R' 'rc_exp.R'
'rc_est.R' 'rc_gof.R' 'rc_uncertainty.R'
'ReturnCurves-package.R' 'airdata.R' 'runShiny.R' 'marggpd.R'</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-03 17:40:21 UTC; andrel</td>
</tr>
<tr>
<td>Author:</td>
<td>Lídia André [aut, cre],
  Callum Murphy-Barltrop [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-04 11:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ReturnCurves-package'>Estimation of Return Curves</h2><span id='topic+ReturnCurves'></span><span id='topic+ReturnCurves-package'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>Implements the estimation of the \(p\)-probability return curve (Murphy-Barltrop et al. 2023), 
as well as a pointwise and smooth estimation of the angular dependence function (Wadsworth and Tawn 2013).
</p>


<h3>Available functions</h3>

<p><code><a href="#topic+adf_est">adf_est</a></code>: Estimation of the Angular Dependence Function (ADF)
</p>
<p><code><a href="#topic+adf_gof">adf_gof</a></code>: Goodness of fit of the Angular Dependence Function estimates
</p>
<p><code><a href="#topic+airdata">airdata</a></code>: Air pollution data
</p>
<p><code><a href="#topic+marggpd">marggpd</a></code>: Assessing the Marginal Tail Fits
</p>
<p><code><a href="#topic+margtransf">margtransf</a></code>: Marginal Transformation
</p>
<p><code><a href="#topic+rc_est">rc_est</a></code>: Return Curve estimation
</p>
<p><code><a href="#topic+rc_gof">rc_gof</a></code>: Goodness of fit of the Return Curve estimates
</p>
<p><code><a href="#topic+rc_unc">rc_unc</a></code>: Uncertainty of the Return Curve estimates
</p>
<p><code><a href="#topic+runShiny">runShiny</a></code>: Complementary Shiny app for the ReturnCurves package
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Lídia André <a href="mailto:l.andre@lancaster.ac.uk">l.andre@lancaster.ac.uk</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Callum Murphy-Barltrop <a href="mailto:callum.murphy-barltrop@tu-dresden.de">callum.murphy-barltrop@tu-dresden.de</a>
</p>
</li></ul>



<h3>References</h3>

<p>Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2023).
&ldquo;New estimation methods for extremal bivariate return curves.&rdquo;
<em>Environmetrics</em>, <b>34</b>(5).
ISSN 1099095X, <a href="https://doi.org/10.1002/env.2797">doi:10.1002/env.2797</a>.<br /><br /> Wadsworth JL, Tawn JA (2013).
&ldquo;A new representation for multivariate tail probabilities.&rdquo;
<em>Bernoulli</em>, <b>19</b>(5B), 2689-2714.
ISSN 13507265, <a href="https://doi.org/10.3150/12-BEJ471">doi:10.3150/12-BEJ471</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

# Marginal Transformation
margdata &lt;- margtransf(airdata)

head(margdata@dataexp)

# Return Curves estimation

prob &lt;- 1/n

retcurve &lt;- rc_est(margdata = margdata, p = prob, method = "hill")

head(retcurve@rc)

# ADF estimation
lambda &lt;- adf_est(margdata = margdata, method = "hill")

head(lambda@adf)

</code></pre>

<hr>
<h2 id='adf_est'>Estimation of the Angular Dependence Function (ADF)</h2><span id='topic+adf_est'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>Estimation of the angular dependence function \(\lambda(\omega)\) introduced by Wadsworth and Tawn (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adf_est(
  margdata,
  w = NULL,
  method = c("hill", "cl"),
  q = 0.95,
  qalphas = rep(0.95, 2),
  k = 7,
  constrained = FALSE,
  tol = 1e-04,
  par_init = rep(0, k - 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adf_est_+3A_margdata">margdata</code></td>
<td>
<p>An S4 object of class <code>margtransf.class</code>. See <code><a href="#topic+margtransf">margtransf</a></code> for more details.</p>
</td></tr>
<tr><td><code id="adf_est_+3A_w">w</code></td>
<td>
<p>Sequence of rays between <code>0</code> and <code>1</code>. Default is <code>NULL</code>, where a pre-defined grid is used.</p>
</td></tr>
<tr><td><code id="adf_est_+3A_method">method</code></td>
<td>
<p>String that indicates which method is used for the estimation of the angular dependence function. Must either be <code>"hill"</code>, to use the Hill estimator (Hill 1975), or <code>"cl"</code> to use the smooth estimator based on Bernstein-Bezier polynomials estimated by composite maximum likelihood.</p>
</td></tr>
<tr><td><code id="adf_est_+3A_q">q</code></td>
<td>
<p>Marginal quantile used to define the threshold \(u_\omega\) of the min-projection variable \(T^1\) at ray \(\omega\) \(\left(t^1_\omega = t_\omega - u_\omega | t_\omega > u_\omega\right)\), and/or Hill estimator (Hill 1975). Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="adf_est_+3A_qalphas">qalphas</code></td>
<td>
<p>A vector containing the marginal quantile used for the Heffernan and Tawn conditional extremes model (Heffernan and Tawn 2004) for each variable, if <code>constrained = TRUE</code>. Default is <code>rep(0.95, 2)</code>.</p>
</td></tr>
<tr><td><code id="adf_est_+3A_k">k</code></td>
<td>
<p>Polynomial degree for the Bernstein-Bezier polynomials used for the estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>7</code>.</p>
</td></tr>
<tr><td><code id="adf_est_+3A_constrained">constrained</code></td>
<td>
<p>Logical. If <code>FALSE</code> (default) no knowledge of the conditional extremes parameters is incorporated in the angular dependence function estimation.</p>
</td></tr>
<tr><td><code id="adf_est_+3A_tol">tol</code></td>
<td>
<p>Convergence tolerance for the composite maximum likelihood procedure. Success is declared when the difference of log-likelihood values between iterations does not exceed this value. Default is <code>0.0001</code>.</p>
</td></tr>
<tr><td><code id="adf_est_+3A_par_init">par_init</code></td>
<td>
<p>Initial values for the parameters \(\beta\) of the Bernstein-Bezier polynomials used for estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>rep(0, k-1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The angular dependence function \(\lambda(\omega)\) can be estimated through a pointwise estimator, obtained with the Hill estimator, or via a smoother approach, obtained using Bernstein-Bezier polynomials and estimated via composite likelihood methods. 
</p>
<p>Knowledge of the conditional extremes framework introduced by Heffernan and Tawn (2004) can be incorporated by setting <code>constrained = TRUE</code>.
Let \(\alpha^1_{x\mid y}=\alpha_{x\mid y} / (1+\alpha_{x\mid y})\) and \(\alpha^1_{y\mid x}=1 /(1+\alpha_{y\mid x})\) with \(\alpha_{x\mid y}\) and \(\alpha_{y\mid x}\) 
being the conditional extremes parameters. After obtaining \(\hat{\alpha}_{x\mid y}\) and \(\hat{\alpha}_{y\mid x}\) via maximum likelihood estimation, 
\(\lambda(\omega)=\max\lbrace \omega, 1-\omega\rbrace\) for \(\omega \in [0, \hat{\alpha}^1_{x\mid y})\cup (\hat{\alpha}^1_{y\mid x}, 1]\) and    
is estimated as before for \(\omega \in [\hat{\alpha}^1_{x\mid y},\hat{\alpha}^1_{y\mid x}]\). For more details see Murphy-Barltrop et al. (2024).
</p>


<h3>Value</h3>

<p>An object of S4 class <code>adf_est.class</code>. This object returns the arguments of the function and two extra slots: 
</p>
<table>
<tr><td><code>interval:</code></td>
<td>
<p>A vector containing the maximum likelihood estimates from the conditional extremes model, \(\hat{\alpha}^1_{x\mid y}\) and \(\hat{\alpha}^1_{y\mid x}\), if <code>constrained = TRUE</code>. If <code>constrained = FALSE</code>, then <code>c(0, 1)</code> is returned; we note that this has no meaningful interpretation as the estimation is performed in an unconstrained interval.</p>
</td></tr>
<tr><td><code>adf:</code></td>
<td>
<p>A vector containing the estimates of the angular dependence function.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Heffernan JE, Tawn JA (2004).
&ldquo;A conditional approach for multivariate extreme values (with discussion).&rdquo;
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>66</b>(3), 497-546.
<a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x">doi:10.1111/j.1467-9868.2004.02050.x</a>, https://rss.onlinelibrary.wiley.com/doi/pdf/10.1111/j.1467-9868.2004.02050.x.<br /><br /> Hill BM (1975).
&ldquo;A Simple General Approach to Inference About the Tail of a Distribution.&rdquo;
<em>The Annals of Statistics</em>, <b>3</b>(5), 1163 &ndash; 1174.
<a href="https://doi.org/10.1214/aos/1176343247">doi:10.1214/aos/1176343247</a>.<br /><br /> Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2024).
&ldquo;Improving estimation for asymptotically independent bivariate extremes via global estimators for the angular dependence function.&rdquo;
2303.13237.<br /><br /> Wadsworth JL, Tawn JA (2013).
&ldquo;A new representation for multivariate tail probabilities.&rdquo;
<em>Bernoulli</em>, <b>19</b>(5B), 2689-2714.
ISSN 13507265, <a href="https://doi.org/10.3150/12-BEJ471">doi:10.3150/12-BEJ471</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

margdata &lt;- margtransf(airdata)

lambda &lt;- adf_est(margdata = margdata, method = "hill")

plot(lambda)

# To see the the S4 object's slots
str(lambda)

# To access the estimates of the ADF
lambda@adf

# If constrained = T, the MLE estimates for the conditional extremes model
# can be accessed as
lambda@interval

</code></pre>

<hr>
<h2 id='adf_est.class'>An S4 class to represent the estimation of the Angular Dependence Function</h2><span id='topic+adf_est.class'></span>

<h3>Description</h3>

<p>An S4 class to represent the estimation of the Angular Dependence Function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adf_est.class(
  dataexp,
  w,
  method,
  q,
  qalphas,
  k,
  constrained,
  tol,
  par_init,
  interval,
  adf
)
</code></pre>


<h3>Slots</h3>


<dl>
<dt><code>dataexp</code></dt><dd><p>A matrix containing the data on standard exponential margins.</p>
</dd>
<dt><code>w</code></dt><dd><p>Sequence of rays between <code>0</code> and <code>1</code>. Default is <code>NULL</code>, where a pre-defined grid is used.</p>
</dd>
<dt><code>method</code></dt><dd><p>String that indicates which method is used for the estimation of the angular dependence function. Must either be <code>"hill"</code>, to use the Hill estimator (Hill 1975), or <code>"cl"</code> to use the smooth estimator based on Bernstein-Bezier polynomials estimated by composite maximum likelihood.</p>
</dd>
<dt><code>q</code></dt><dd><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Marginal quantile used to define the threshold \(u_\omega\) of the min-projection variable \(T^1\) at ray \(\omega\) \(\left(t^1_\omega = t_\omega - u_\omega | t_\omega > u_\omega\right)\), and/or Hill estimator (Hill 1975). Default is <code>0.95</code>.</p>
</dd>
<dt><code>qalphas</code></dt><dd><p>A vector containing the marginal quantiles used for the Heffernan and Tawn conditional extremes model (Heffernan and Tawn 2004) for each variable, if <code>constrained = TRUE</code>. Default is <code>rep(0.95, 2)</code>.</p>
</dd>
<dt><code>k</code></dt><dd><p>Polynomial degree for the Bernstein-Bezier polynomials used for the estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>7</code>.</p>
</dd>
<dt><code>constrained</code></dt><dd><p>Logical. If <code>FALSE</code> (Default) no knowledge of the conditional extremes parameters is incorporated in the angular dependence function estimation.</p>
</dd>
<dt><code>tol</code></dt><dd><p>Convergence tolerance for the composite maximum likelihood procedure. Success is declared when the difference of log-likelihood values between iterations does not exceed this value. Default is <code>0.0001</code>.</p>
</dd>
<dt><code>par_init</code></dt><dd><p>Initial values for the parameters \(\beta\) of the Bernstein-Bezier polynomials used for estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>rep(0, k-1)</code>.</p>
</dd>
<dt><code>interval</code></dt><dd><p>Maximum likelihood estimates \(\hat{\alpha}^1_{x\mid y}\) and \(\hat{\alpha}^1_{y\mid x}\) from the conditional extremes model if <code>constrained = TRUE</code>.</p>
</dd>
<dt><code>adf</code></dt><dd><p>A vector containing the estimates of the angular dependence function.</p>
</dd>
</dl>


<h3>References</h3>

<p>Heffernan JE, Tawn JA (2004).
&ldquo;A conditional approach for multivariate extreme values (with discussion).&rdquo;
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>66</b>(3), 497-546.
<a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x">doi:10.1111/j.1467-9868.2004.02050.x</a>, https://rss.onlinelibrary.wiley.com/doi/pdf/10.1111/j.1467-9868.2004.02050.x.<br /><br /> Hill BM (1975).
&ldquo;A Simple General Approach to Inference About the Tail of a Distribution.&rdquo;
<em>The Annals of Statistics</em>, <b>3</b>(5), 1163 &ndash; 1174.
<a href="https://doi.org/10.1214/aos/1176343247">doi:10.1214/aos/1176343247</a>.<br /><br /> Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2024).
&ldquo;Improving estimation for asymptotically independent bivariate extremes via global estimators for the angular dependence function.&rdquo;
2303.13237.
</p>

<hr>
<h2 id='adf_gof'>Goodness of fit of the Angular Dependence function estimates</h2><span id='topic+adf_gof'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>Assessment of the goodness of fit of the angular dependence function estimates \(\lambda(\omega)\) following the procedure of Murphy-Barltrop et al. (2024).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adf_gof(adf, ray, blocksize = 1, nboot = 250, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adf_gof_+3A_adf">adf</code></td>
<td>
<p>An S4 object of class <code>adf_est.class</code>. See <code><a href="#topic+adf_est">adf_est</a></code> for more details.</p>
</td></tr>
<tr><td><code id="adf_gof_+3A_ray">ray</code></td>
<td>
<p>Ray \(\omega\) to be considered on the goodness of fit assessment.</p>
</td></tr>
<tr><td><code id="adf_gof_+3A_blocksize">blocksize</code></td>
<td>
<p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</td></tr>
<tr><td><code id="adf_gof_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</td></tr>
<tr><td><code id="adf_gof_+3A_alpha">alpha</code></td>
<td>
<p>Significance level to compute the \((1-\alpha)\)% tolerance intervals. Default is <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define the min-projection variable as \(t^1_\omega = t_\omega - u_\omega | t_\omega > u_\omega\), then
variable \(\lambda(\omega)T^1_\omega \sim Exp(1)\) as \(u_\omega \to \infty\) for all \(\omega \in [0,1]\). 
</p>
<p>Let \(F^{-1}_E\) denote the inverse of the cumulative distribution function of a standard exponential variable and \(T^1_{(i)}\) denote the \(i\)-th ordered increasing statistic, \(i = 1, \ldots, n\). 
Function <code>plot</code> shows a QQ plot between the model and empirical exponential quantiles, i.e. points \(\left(F^{-1}_E\left(\frac{i}{n+1}\right), T^1_{(i)}\right)\),
along with the line \(y=x\). Uncertainty is obtained via a (block) bootstrap procedure and shown by the grey region on the plot.
A good fit is shown by agreement of model and empirical quantiles, i.e. points should lie close to the line \(y=x\). 
In addition, line \(y = x\) should mainly lie within the \((1-\alpha)\)% tolerance intervals.
</p>
<p>We note that, if the grid for \(\omega\) used to estimate the Angular Dependence Function (ADF) does not contain <code>ray</code>, then the closest \(\omega\) in the grid is used to assess the goodness-of-fit of the ADF.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>adf_gof.class</code>. This object returns the arguments of the function and an extra slot <code>gof</code> which is a list containing: 
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>A vector containing the model quantiles.</p>
</td></tr> 
<tr><td><code>empirical</code></td>
<td>
<p>A vector containing the empirical quantiles.</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>A vector containing the lower bound of the tolerance interval.</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>A vector containing the upper bound of the tolerance interval.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>It is recommended to assess the goodness-of-fit of \(\lambda(\omega)\) for a few values of \(\omega\).
</p>


<h3>References</h3>

<p>Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2024).
&ldquo;Improving estimation for asymptotically independent bivariate extremes via global estimators for the angular dependence function.&rdquo;
2303.13237.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

margdata &lt;- margtransf(airdata)

lambda &lt;- adf_est(margdata = margdata, method = "hill")

# blocksize to account for temporal dependence
gof &lt;- adf_gof(adf = lambda, ray = 0.4, blocksize = 10)

plot(gof)

# To see the the S4 object's slots
str(gof)

# To access the list of vectors
gof@gof

</code></pre>

<hr>
<h2 id='adf_gof.class'>An S4 class to represent the Goodness-of-Fit of the Angular Dependence Function estimates</h2><span id='topic+adf_gof.class'></span>

<h3>Description</h3>

<p>An S4 class to represent the Goodness-of-Fit of the Angular Dependence Function estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adf_gof.class(adf, ray, blocksize, nboot, alpha, gof)
</code></pre>


<h3>Slots</h3>


<dl>
<dt><code>adf</code></dt><dd><p>An S4 object of class <code>adf_est.class</code>.</p>
</dd>
<dt><code>ray</code></dt><dd><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Ray \(\omega\) to be considered on the goodness of fit assessment.</p>
</dd>
<dt><code>blocksize</code></dt><dd><p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</dd>
<dt><code>nboot</code></dt><dd><p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>Significance level to compute the \((1-\alpha)\)% confidence intervals. Default is <code>0.05</code>.</p>
</dd>
<dt><code>gof</code></dt><dd><p>A list containing the model and empirical exponential quantiles, and the lower and upper bound of the confidence interval.</p>
</dd>
</dl>

<hr>
<h2 id='airdata'>Air pollution data</h2><span id='topic+airdata'></span>

<h3>Description</h3>

<p>Air pollution data from Marylebone, London (UK), between December and February 
of 1998 to 2005. It contains daily measurements of air pollutant concentrations of NOx and
PM10. The dataset is a subset of the data from the <code>openair</code> package and
consists of <code>1427</code> observations.
</p>


<h3>Format</h3>

<p>Data frame with 1427 observations (rows) and 2 variables (columns):
</p>

<dl>
<dt>nox</dt><dd><p>Vector containing daily measurements of NOx, in parts per billion.</p>
</dd>
<dt>pm10</dt><dd><p>Vector containing daily measurements of PM10, in ug/m3.</p>
</dd>
</dl>



<h3>Source</h3>

<p><code>airdata</code> is a subset of the data provided in the <code><a href="openair.html#topic+openair">openair</a></code> R package.
</p>

<hr>
<h2 id='marggpd'>Assessing the Marginal Tail Fits</h2><span id='topic+marggpd'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>Assessment of the marginal tail fits for each margin following the marginal transformation procedure <code><a href="#topic+margtransf">margtransf</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marggpd(margdata, blocksize = 1, nboot = 250, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marggpd_+3A_margdata">margdata</code></td>
<td>
<p>An S4 object of class <code>margtransf.class</code>. See <code><a href="#topic+margtransf">margtransf</a></code> for more details.</p>
</td></tr>
<tr><td><code id="marggpd_+3A_blocksize">blocksize</code></td>
<td>
<p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</td></tr>
<tr><td><code id="marggpd_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</td></tr>
<tr><td><code id="marggpd_+3A_alpha">alpha</code></td>
<td>
<p>Significance level to compute the \((1-\alpha)\)% tolerance intervals. Default is <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let \(X^{GPD}_{(i)}\) denote the \(i\)-th ordered increasing statistic 
\((i = 1, \ldots, n)\) of the exceedances, i.e., \(X^{GPD}= (X-u \mid X >u),\) 
\(n_{exc}\) denote the sample size of these exceedances, and \(F_{GPD}^{-1}\) denote the 
inverse of the cumulative distribution function of a generalised Pareto distribution (GPD).
Function <code>plot</code> shows QQ plots between the model and empirical GPD quantiles for both variables, i.e, for 
the first variable points \(\left(F^{-1}_{GPD}\left(\frac{i}{n_{exc}+1}\right) + u, X^{GPD}_{(i)} + u\right)\), 
along with the line \(y=x\). 
</p>
<p>Uncertainty on the empirical quantiles is obtained via a (block) bootstrap procedure and shown by the grey region on the plot.
A good fit is shown by agreement of model and empirical quantiles, i.e. points should lie close to the line \(y=x\). 
In addition, line \(y = x\) should mainly lie within the \((1-\alpha)\)% tolerance intervals.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>marggpd.class</code>. This object returns the arguments of the function and an extra slot <code>marggpd</code> which is a list containing: 
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>A list containing the model quantiles for each variable.</p>
</td></tr> 
<tr><td><code>empirical</code></td>
<td>
<p>A list containing the empirical quantiles for each variable.</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>A list containing the lower bounds of the tolerance intervals for each variable.</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>A list containing the upper bounds of the tolerance intervals for each variable.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

margdata &lt;- margtransf(airdata)

# blocksize to account for temporal dependence
marggpd &lt;- marggpd(margdata = margdata, blocksize = 10)

plot(marggpd)

# To see the the S4 object's slots
str(marggpd)

# To access the list of lists
marggpd@marggpd

</code></pre>

<hr>
<h2 id='marggpd.class'>An S4 class to represent the assessment of the the Marginal Tail Fits</h2><span id='topic+marggpd.class'></span>

<h3>Description</h3>

<p>An S4 class to represent the assessment of the the Marginal Tail Fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marggpd.class(margdata, blocksize, nboot, alpha, marggpd)
</code></pre>


<h3>Slots</h3>


<dl>
<dt><code>margdata</code></dt><dd><p>An S4 object of class <code>margtransf.class</code>. See <code><a href="#topic+margtransf">margtransf</a></code> for more details.</p>
</dd>
<dt><code>blocksize</code></dt><dd><p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</dd>
<dt><code>nboot</code></dt><dd><p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>Significance level to compute the \((1-\alpha)\)% confidence intervals. Default is <code>0.05</code>.</p>
</dd>
<dt><code>gof</code></dt><dd><p>A list containing the model and empirical exponential quantiles, and the lower and upper bound of the confidence interval.</p>
</dd>
</dl>

<hr>
<h2 id='margtransf'>Marginal Transformation</h2><span id='topic+margtransf'></span>

<h3>Description</h3>

<p>Marginal transformation of a  bivariate random vector to standard exponential margins following Coles and Tawn (1991). Variables within each margin are assumed identically distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>margtransf(data, qmarg = rep(0.95, 2), constrainedshape = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="margtransf_+3A_data">data</code></td>
<td>
<p>A matrix containing the data on the original margins.</p>
</td></tr>
<tr><td><code id="margtransf_+3A_qmarg">qmarg</code></td>
<td>
<p>A vector containing the marginal quantile used to fit the Generalised Pareto Distribution (GPD) for each variable. Default is <code>rep(0.95, 2)</code>.</p>
</td></tr>
<tr><td><code id="margtransf_+3A_constrainedshape">constrainedshape</code></td>
<td>
<p>Logical. If <code>TRUE</code> (Default), the estimated shape parameter of the Generalised Pareto Distribution (GPD) is constrained to lie strictly above <code>-1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Given a threshold value \(u\), each stationary random vector 
is transformed by using the empirical cumulative distribution function 
(cdf) below \(u\), and a Generalise Pareto Distribution (GPD) fit above \(u\).    
</p>
<p>The option to constrain \(\xi > -1\) is included as \(\xi \leq -1\) implies that the fitted
upper endpoint of the distribution's support is the maximum data point. This situation is rarely encountered in practice.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>margtransf.class</code>. This object returns the arguments of the function, a slot <code>parameters</code> containing a matrix with the shape and scale parameters of the Generalised Pareto Distribution (GPD) for each variable, a slot <code>thresh</code> containing a vector with the threshold \(u\) above which the GPD is fitted, and a slot <code>dataexp</code> containing a matrix with the data on standard exponential margins. 
</p>
<p>The <code>plot</code> function takes an object of S4 class <code>margtransf.class</code>, and a <code>which</code> argument specifying the type of plot desired (see <strong>Examples</strong>):
</p>
<table>
<tr><td><code>"hist"</code></td>
<td>
<p>Plots the marginal distributions of the two variables on original and standard exponential margins.</p>
</td></tr>
<tr><td><code>"ts"</code></td>
<td>
<p>Plots the time series of the two variables on original and standard exponential margins.</p>
</td></tr>
<tr><td><code>"joint"</code></td>
<td>
<p>Plots the joint distribution of the two variables on original and standard exponential margins.</p>
</td></tr>
<tr><td><code>"all"</code></td>
<td>
<p>Plots all the above mentioned plots (default).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Coles SG, Tawn JA (1991).
&ldquo;Modelling Extreme Multivariate Events.&rdquo;
<em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <b>53</b>(2), 377&ndash;392.
ISSN 00359246, <a href="https://doi.org/10.1111/j.2517-6161.1991.tb01830.x">doi:10.1111/j.2517-6161.1991.tb01830.x</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

margdata &lt;- margtransf(airdata)

# Plots the marginal distributions of X and Y on original vs standard exponential margins
plot(margdata, which = "hist") 

# Plots the time series of X and Y on original vs standard exponential margins
plot(margdata, which = "ts") 

# Plots the joint distribution of X and Y on original vs standard exponential margins
plot(margdata, which = "joint") 

# Plots all the available plots
plot(margdata, which = "all") 

# To see the the S4 object's slots
str(margdata)

# To access the matrix with the data on standard exponential margins
margdata@dataexp

</code></pre>

<hr>
<h2 id='margtransf.class'>An S4 class to represent the Marginal Transformation</h2><span id='topic+margtransf.class'></span>

<h3>Description</h3>

<p>An S4 class to represent the Marginal Transformation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>margtransf.class(data, qmarg, constrainedshape, parameters, thresh, dataexp)
</code></pre>


<h3>Slots</h3>


<dl>
<dt><code>data</code></dt><dd><p>A matrix containing the data on the original margins.</p>
</dd>
<dt><code>qmarg</code></dt><dd><p>A vector containing the marginal quantile used to fit the Generalised Pareto Distribution (GPD) for each variable. Default is <code>rep(0.95, 2)</code>.</p>
</dd>
<dt><code>constrainedshape</code></dt><dd><p>Logical. If <code>TRUE</code> (Default), the estimated shape parameter of the Generalised Pareto Distribution (GPD) is constrained to strictly above <code>-1</code>.</p>
</dd>
<dt><code>parameters</code></dt><dd><p>A vector containing the scale and shape parameters of the Generalised Pareto Distribution (GPD).</p>
</dd>
<dt><code>thresh</code></dt><dd><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> A vector containing the threshold \(u\) above which the Generalised Pareto Distribution (GPD) is fitted.</p>
</dd>
<dt><code>dataexp</code></dt><dd><p>A matrix containing the data on standard exponential margins.</p>
</dd>
</dl>

<hr>
<h2 id='plot+2Cadf_est.class+2CANY-method'>Visualisation of the Angular Dependence Function estimates</h2><span id='topic+plot+2Cadf_est.class+2CANY-method'></span><span id='topic+plot+2Cadf_est.class'></span>

<h3>Description</h3>

<p>Plot method for an S4 object returned by <code><a href="#topic+adf_est">adf_est</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'adf_est.class,ANY'
plot(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cadf_est.class+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>An instance of an S4 class produced by <code><a href="#topic+adf_est">adf_est</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object showing a comparison between the Angular Dependence Function (ADF) estimates and the lower bound max\(\lbrace \omega, 1-\omega\rbrace\).
</p>

<hr>
<h2 id='plot+2Cadf_gof.class+2CANY-method'>Visualisation of the Goodness-of-Fit of the Angular Dependence Function estimates</h2><span id='topic+plot+2Cadf_gof.class+2CANY-method'></span><span id='topic+plot+2Cadf_gof.class'></span>

<h3>Description</h3>

<p>Plot method for an S4 object returned by <code><a href="#topic+adf_gof">adf_gof</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'adf_gof.class,ANY'
plot(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cadf_gof.class+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>An instance of an S4 class produced by <code><a href="#topic+adf_gof">adf_gof</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object showing the QQ-plot between the model and empirical exponential quantiles.
</p>

<hr>
<h2 id='plot+2Cmarggpd.class+2CANY-method'>Visualisation of the assessment of the Marginal Tail Fits</h2><span id='topic+plot+2Cmarggpd.class+2CANY-method'></span><span id='topic+plot+2Cmarggpd.class'></span>

<h3>Description</h3>

<p>Plot method for an S4 object returned by <code><a href="#topic+marggpd">marggpd</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'marggpd.class,ANY'
plot(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cmarggpd.class+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>An instance of an S4 class produced by <code><a href="#topic+marggpd">marggpd</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object showing the QQ-plot between the model and empirical generalised Pareto distribution quantiles.
</p>

<hr>
<h2 id='plot+2Cmargtransf.class+2CANY-method'>Visualisation of the Marginal Transformation</h2><span id='topic+plot+2Cmargtransf.class+2CANY-method'></span><span id='topic+plot+2Cmargtransf.class'></span>

<h3>Description</h3>

<p>Plot method for an S4 object returned by <code><a href="#topic+margtransf">margtransf</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'margtransf.class,ANY'
plot(x, which = c("all", "hist", "ts", "joint"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cmargtransf.class+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>An instance of an S4 class produced by <code><a href="#topic+margtransf">margtransf</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B2Cmargtransf.class+2B2CANY-method_+3A_which">which</code></td>
<td>
<p>String that indicates which type of plot to show. Must either be <code>"all"</code> (Default), <code>"hist"</code>, <code>"ts"</code> or <code>"joint"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object showing:
</p>
<table>
<tr><td><code>which = "hist"</code></td>
<td>
<p>histograms of each variable on original and standard exponential margins.</p>
</td></tr>
<tr><td><code>which = "ts"</code></td>
<td>
<p>time series of each variable on original and standard exponential margins.</p>
</td></tr>
<tr><td><code>which = "joint"</code></td>
<td>
<p>joint distribution on original and standard exponential margins.</p>
</td></tr>
<tr><td><code>which = "all"</code></td>
<td>
<p>all the available plots.</p>
</td></tr>
</table>

<hr>
<h2 id='plot+2Crc_est.class+2CANY-method'>Visualisation of the Return Curve estimates</h2><span id='topic+plot+2Crc_est.class+2CANY-method'></span><span id='topic+plot+2Crc_est.class'></span>

<h3>Description</h3>

<p>Plot method for an S4 object returned by <code><a href="#topic+rc_est">rc_est</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'rc_est.class,ANY'
plot(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Crc_est.class+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>An instance of an S4 class produced by <code><a href="#topic+rc_est">rc_est</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object showing the original data with the estimated Return Curve.
</p>

<hr>
<h2 id='plot+2Crc_gof.class+2CANY-method'>Visualisation of the Goodness-of-Fit of the Return Curve estimates</h2><span id='topic+plot+2Crc_gof.class+2CANY-method'></span><span id='topic+plot+2Crc_gof.class'></span>

<h3>Description</h3>

<p>Plot method for an S4 object returned by <code><a href="#topic+rc_gof">rc_gof</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'rc_gof.class,ANY'
plot(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Crc_gof.class+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>An instance of an S4 class produced by <code><a href="#topic+rc_gof">rc_gof</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object comparing the true and median estimates of the empirical probability of lying in a survival region.
</p>

<hr>
<h2 id='plot+2Crc_unc.class+2CANY-method'>Visualisation of the Uncertainty of the Return Curve estimates</h2><span id='topic+plot+2Crc_unc.class+2CANY-method'></span><span id='topic+plot+2Crc_unc.class'></span>

<h3>Description</h3>

<p>Plot method for an S4 object returned by <code><a href="#topic+rc_unc">rc_unc</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'rc_unc.class,ANY'
plot(x, which = c("rc", "median", "mean", "all"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Crc_unc.class+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>An instance of an S4 class produced by <code><a href="#topic+rc_unc">rc_unc</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B2Crc_unc.class+2B2CANY-method_+3A_which">which</code></td>
<td>
<p>String that indicates which return curve estimates to show. Must either be <code>"rc"</code> (Default), <code>"median"</code>, <code>"mean"</code> or <code>"all"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object showing:
</p>
<table>
<tr><td><code>which = "rc"</code></td>
<td>
<p>Plots the estimated Return Curve and its uncertainty.</p>
</td></tr>
<tr><td><code>which = "median"</code></td>
<td>
<p>Plots the median estimates of the Return Curve and its uncertainty.</p>
</td></tr>
<tr><td><code>which = "mean"</code></td>
<td>
<p>Plots the mean estimates of the Return Curve and its uncertainty.</p>
</td></tr>
<tr><td><code>which = "all"</code></td>
<td>
<p>Plots all the estimated Return Curve, the median and mean estimates of the Return Curve, and its uncertainty.</p>
</td></tr>
</table>

<hr>
<h2 id='rc_est'>Estimation of the Return Curve</h2><span id='topic+rc_est'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Estimation of the \(p\)-probability return curve following Murphy-Barltrop et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rc_est(
  margdata,
  w = NULL,
  p,
  method = c("hill", "cl"),
  q = 0.95,
  qalphas = rep(0.95, 2),
  k = 7,
  constrained = FALSE,
  tol = 0.001,
  par_init = rep(0, k - 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rc_est_+3A_margdata">margdata</code></td>
<td>
<p>An S4 object of class <code>margtransf.class</code>. See <code><a href="#topic+margtransf">margtransf</a></code> for more details.</p>
</td></tr>
<tr><td><code id="rc_est_+3A_w">w</code></td>
<td>
<p>Sequence of rays between <code>0</code> and <code>1</code>. Default is <code>NULL</code>, where a pre-defined grid is used.</p>
</td></tr>
<tr><td><code id="rc_est_+3A_p">p</code></td>
<td>
<p>Curve survival probability. Must be \(p < 1-q\) and \(p < 1-q_\alpha\).</p>
</td></tr>
<tr><td><code id="rc_est_+3A_method">method</code></td>
<td>
<p>String that indicates which method is used for the estimation of the angular dependence function. Must either be <code>"hill"</code>, to use the Hill estimator (Hill 1975), or <code>"cl"</code> to use the smooth estimator based on Bernstein-Bezier polynomials estimated by composite maximum likelihood.</p>
</td></tr>
<tr><td><code id="rc_est_+3A_q">q</code></td>
<td>
<p>Marginal quantile used to define the threshold \(u_\omega\) of the min-projection variable \(T^1\) at ray \(\omega\) \(\left(t^1_\omega = t_\omega - u_\omega | t_\omega > u_\omega\right)\), and/or Hill estimator (Hill 1975). Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="rc_est_+3A_qalphas">qalphas</code></td>
<td>
<p>A vector containing the marginal quantile used for the Heffernan and Tawn conditional extremes model (Heffernan and Tawn 2004) for each variable, if <code>constrained = TRUE</code>. Default is <code>rep(0.95, 2)</code>.</p>
</td></tr>
<tr><td><code id="rc_est_+3A_k">k</code></td>
<td>
<p>Polynomial degree for the Bernstein-Bezier polynomials used for the estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>7</code>.</p>
</td></tr>
<tr><td><code id="rc_est_+3A_constrained">constrained</code></td>
<td>
<p>Logical. If <code>FALSE</code> (default) no knowledge of the conditional extremes parameters is incorporated in the angular dependence function estimation.</p>
</td></tr>
<tr><td><code id="rc_est_+3A_tol">tol</code></td>
<td>
<p>Convergence tolerance for the composite maximum likelihood procedure. Success is declared when the difference of log-likelihood values between iterations does not exceed this value. Default is <code>0.0001</code>.</p>
</td></tr>
<tr><td><code id="rc_est_+3A_par_init">par_init</code></td>
<td>
<p>Initial values for the parameters \(\beta\) of the Bernstein-Bezier polynomials used for estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default is <code>rep(0, k-1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a probability \(p\) and a joint survival function \(Pr(X>x, Y>y)\), 
the \(p\)-probability return curve is defined as 
\[RC(p):=\left\lbrace(x, y) \in R^2: Pr(X>x, Y>y)=p\right\rbrace.\] 
</p>
<p>This method focuses on estimation of \(RC(p)\) for small \(p\) near \(0\), so that \((X,Y)\) are in the tail of the distribution.
</p>
<p>\(Pr(X>x, Y>y)\) is estimated using the angular dependence function \(\lambda(\omega)\) introduced by Wadsworth and Tawn (2013). More details on how to estimate \(\lambda(\omega)\) can be found in <code><a href="#topic+adf_est">adf_est</a></code>.
</p>
<p>The return curve estimation \(\hat{RC}(p)\) is done on standard exponential margins and then back transformed onto the original margins.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>rc_est.class</code>. This object returns the arguments of the function and extra slot <code>rc</code> 
</p>
<table>
<tr><td><code>interval:</code></td>
<td>
<p>A vector containing the maximum likelihood estimates from the conditional extremes model, \(\hat{\alpha}^1_{x\mid y}\) and \(\hat{\alpha}^1_{y\mid x}\), if <code>constrained = TRUE</code>. If <code>constrained = FALSE</code>, then <code>c(0, 1)</code> is returned; we note that this has no meaningful interpretation as the estimation is performed in an unconstrained interval.</p>
</td></tr>
<tr><td><code>rc:</code></td>
<td>
<p>A matrix with the estimates of the Return Curve.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Heffernan JE, Tawn JA (2004).
&ldquo;A conditional approach for multivariate extreme values (with discussion).&rdquo;
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>66</b>(3), 497-546.
<a href="https://doi.org/10.1111/j.1467-9868.2004.02050.x">doi:10.1111/j.1467-9868.2004.02050.x</a>, https://rss.onlinelibrary.wiley.com/doi/pdf/10.1111/j.1467-9868.2004.02050.x.<br /><br /> Hill BM (1975).
&ldquo;A Simple General Approach to Inference About the Tail of a Distribution.&rdquo;
<em>The Annals of Statistics</em>, <b>3</b>(5), 1163 &ndash; 1174.
<a href="https://doi.org/10.1214/aos/1176343247">doi:10.1214/aos/1176343247</a>.<br /><br /> Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2023).
&ldquo;New estimation methods for extremal bivariate return curves.&rdquo;
<em>Environmetrics</em>, <b>34</b>(5).
ISSN 1099095X, <a href="https://doi.org/10.1002/env.2797">doi:10.1002/env.2797</a>.<br /><br /> Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2024).
&ldquo;Improving estimation for asymptotically independent bivariate extremes via global estimators for the angular dependence function.&rdquo;
2303.13237.<br /><br /> Wadsworth JL, Tawn JA (2013).
&ldquo;A new representation for multivariate tail probabilities.&rdquo;
<em>Bernoulli</em>, <b>19</b>(5B), 2689-2714.
ISSN 13507265, <a href="https://doi.org/10.3150/12-BEJ471">doi:10.3150/12-BEJ471</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

prob &lt;- 10/n

margdata &lt;- margtransf(airdata)

retcurve &lt;- rc_est(margdata = margdata, p = prob, method = "hill")

plot(retcurve)

# To see the the S4 object's slots
str(retcurve)

# To access the return curve estimation
retcurve@rc

# If constrained = T, the MLE estimates for the conditional extremes model
# can be accessed as
retcurve@interval

</code></pre>

<hr>
<h2 id='rc_est.class'>An S4 class to represent the estimation of the Return Curve</h2><span id='topic+rc_est.class'></span>

<h3>Description</h3>

<p>An S4 class to represent the estimation of the Return Curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rc_est.class(
  data,
  qmarg,
  constrainedshape,
  w,
  p,
  method,
  q,
  qalphas,
  k,
  constrained,
  tol,
  par_init,
  interval,
  rc
)
</code></pre>


<h3>Slots</h3>


<dl>
<dt><code>data</code></dt><dd><p>A matrix containing the data on the original margins.</p>
</dd>
<dt><code>qmarg</code></dt><dd><p>A vector containing the marginal quantile used to fit the Generalised Pareto Distribution (GPD) for each variable. Default is <code>rep(0.95, 2)</code>.</p>
</dd>
<dt><code>constrainedshape</code></dt><dd><p>Logical. If <code>TRUE</code> (Default), the estimated shape parameter of the Generalised Pareto Distribution (GPD) is constrained to strictly above <code>-1</code>.</p>
</dd>
<dt><code>w</code></dt><dd><p>Sequence of rays between <code>0</code> and <code>1</code>. Default is <code>seq(0, 1, by = 0.01)</code>.</p>
</dd>
<dt><code>method</code></dt><dd><p>String that indicates which method is used for the estimation of the angular dependence function. Must either be <code>"hill"</code>, to use the Hill estimator (Hill 1975), or <code>"cl"</code> to use the smooth estimator based on Bernstein-Bezier polynomials estimated by composite maximum likelihood.</p>
</dd>
<dt><code>p</code></dt><dd><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Curve survival probability. Must be \(p < 1-q\) and \(p < 1-q_\alpha\).</p>
</dd>
<dt><code>q</code></dt><dd><p>Marginal quantile used for the min-projection variable \(T^1\) at angle \(\omega\) \(\left(t^1_\omega = t_\omega - u_\omega | t_\omega > u_\omega\right)\), and/or Hill estimator (Hill 1975). Default is <code>0.95</code>.</p>
</dd>
<dt><code>qalphas</code></dt><dd><p>A vector containing the marginal quantile used for the Heffernan and Tawn conditional extremes model (Heffernan and Tawn 2004) for each variable, if <code>constrained = TRUE</code>. Default set to <code>rep(0.95, 2)</code>.</p>
</dd>
<dt><code>k</code></dt><dd><p>Polynomial degree for the Bernstein-Bezier polynomials used for the estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default set to <code>7</code>.</p>
</dd>
<dt><code>constrained</code></dt><dd><p>Logical. If <code>FALSE</code> (default) no knowledge of the conditional extremes parameters is incorporated in the angular dependence function estimation.</p>
</dd>
<dt><code>tol</code></dt><dd><p>Convergence tolerance for the composite maximum likelihood procedure. Default set to <code>0.0001</code>.</p>
</dd>
<dt><code>par_init</code></dt><dd><p>Initial values for the parameters \(\beta\) of the Bernstein-Bezier polynomials used for estimation of the angular dependence function with the composite likelihood method (Murphy-Barltrop et al. 2024). Default set to a vector of <code>0</code> of length <code>k-1</code>.</p>
</dd>
<dt><code>interval</code></dt><dd><p>Maximum likelihood estimates \(\hat{\alpha}^1_{x\mid y}\) and \(\hat{\alpha}^1_{y\mid x}\) from the conditional extremes model if <code>constrained = TRUE</code>.</p>
</dd>
<dt><code>rc</code></dt><dd><p>A matrix containing the estimates of the Return Curve.</p>
</dd>
</dl>

<hr>
<h2 id='rc_gof'>Goodness of fit of the Return Curve estimates</h2><span id='topic+rc_gof'></span>

<h3>Description</h3>

<p>Assessment of the goodness-of-fit of the return curve estimates following the approach of Murphy-Barltrop et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rc_gof(retcurve, blocksize = 1, nboot = 250, nangles = 150, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rc_gof_+3A_retcurve">retcurve</code></td>
<td>
<p>An S4 object of class <code>rc_est.class</code>. See <code><a href="#topic+rc_est">rc_est</a></code> for more details.</p>
</td></tr>
<tr><td><code id="rc_gof_+3A_blocksize">blocksize</code></td>
<td>
<p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</td></tr>
<tr><td><code id="rc_gof_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</td></tr>
<tr><td><code id="rc_gof_+3A_nangles">nangles</code></td>
<td>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Number of angles \(m\) in the interval \((0, \pi/2)\) (Murphy-Barltrop et al. 2023). Default is <code>150</code> angles.</p>
</td></tr>
<tr><td><code id="rc_gof_+3A_alpha">alpha</code></td>
<td>
<p>Significance level to compute the \((1-\alpha)\)% confidence intervals. Default is <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a return curve RC(\(p\)), the probability of lying in a survival region is \(p\). 
Let \[\boldsymbol{\Theta}:= \left\lbrace \frac{\pi(m+1-j)}{2(m+1)} \mid 1\leq j\leq m\right\rbrace\] be a set of angles decreasing from near \(\pi/2\) to \(0\).
For each angle \(\theta_j\in \boldsymbol{\Theta,}\) and corresponding point in the estimated return curve \(\lbrace (\hat{x}_{\theta_j}, \hat{y}_{\theta_j}) \rbrace\), 
the empirical probability \(\hat{p}_j\) of lying in the survival region is given by the proportion of points in the region
\((\hat{x}_{\theta_j}, \infty) \times (\hat{y}_{\theta_j}, \infty)\).
</p>
<p>Thus, for each angle \(\theta_j\in \boldsymbol{\Theta,}\) a (block) bootstrap procedure to the original data set is applied, and
the empirical probabilities \(\hat{p}_j\) estimated. Then, the median and \((1-\alpha)\)% pointwise confidence intervals are obtained for each \(\theta_j\).
Function <code>plot</code> shows the median of \(\hat{p}_j\), the confidence intervals and the true probability \(p\); ideally, this value should be contained in the confidence region.
</p>
<p>We note that due to the use of empirical probabilities, the value of \(p\) should be within the range of the data and not too extreme.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>rc_gof.class</code>. This object returns the arguments of the function and an extra slot <code>gof</code> which is a list containing:
</p>
<table>
<tr><td><code>median</code></td>
<td>
<p>A vector containing the median of the empirical probability of lying in a survival region.</p>
</td></tr> 
<tr><td><code>lower</code></td>
<td>
<p>A vector containing the lower bound of the confidence interval.</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>A vector containing the upper bound of the confidence interval.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2023).
&ldquo;New estimation methods for extremal bivariate return curves.&rdquo;
<em>Environmetrics</em>, <b>34</b>(5).
ISSN 1099095X, <a href="https://doi.org/10.1002/env.2797">doi:10.1002/env.2797</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

prob &lt;- 10/n

margdata &lt;- margtransf(airdata)

rc_orig &lt;- rc_est(margdata = margdata, p = prob, method = "hill")

# blocksize to account for temporal dependence
gof &lt;- rc_gof(retcurve = rc_orig, blocksize = 10)

plot(gof)

# To see the the S4 object's slots
str(gof)

# To access the list of vectors
gof@gof

</code></pre>

<hr>
<h2 id='rc_gof.class'>An S4 class to represent the Goodness-of-Fit of the Return Curve estimates</h2><span id='topic+rc_gof.class'></span>

<h3>Description</h3>

<p>An S4 class to represent the Goodness-of-Fit of the Return Curve estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rc_gof.class(retcurve, blocksize, nboot, alpha, gof)
</code></pre>


<h3>Slots</h3>


<dl>
<dt><code>retcurve</code></dt><dd><p>An S4 object of class <code>rc_est.class</code>.</p>
</dd>
<dt><code>blocksize</code></dt><dd><p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</dd>
<dt><code>nboot</code></dt><dd><p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</dd>
<dt><code>nangles</code></dt><dd><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Number of angles \(m\) in the interval \((0, \pi/2)\) (Murphy-Barltrop et al. 2023). Default is <code>150</code> angles.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>Significance level to compute the \((1-\alpha)\)% confidence intervals. Default is <code>0.05</code>.</p>
</dd>
<dt><code>gof</code></dt><dd><p>A list containing the median of the empirical probability and the lower and upper bound of the confidence interval.</p>
</dd>
</dl>

<hr>
<h2 id='rc_unc'>Uncertainty of the Return Curve estimates</h2><span id='topic+rc_unc'></span>

<h3>Description</h3>

<p>Uncertainty assessment of the return curve estimates following the procedure of Murphy-Barltrop et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rc_unc(retcurve, blocksize = 1, nboot = 250, nangles = 150, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rc_unc_+3A_retcurve">retcurve</code></td>
<td>
<p>An S4 object of class <code>rc_est.class</code>. See <code><a href="#topic+rc_est">rc_est</a></code> for more details.</p>
</td></tr>
<tr><td><code id="rc_unc_+3A_blocksize">blocksize</code></td>
<td>
<p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</td></tr>
<tr><td><code id="rc_unc_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</td></tr>
<tr><td><code id="rc_unc_+3A_nangles">nangles</code></td>
<td>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Number of angles \(m\) in the interval \((0, \pi/2)\) (Murphy-Barltrop et al. 2023). Default is <code>150</code> angles.</p>
</td></tr>
<tr><td><code id="rc_unc_+3A_alpha">alpha</code></td>
<td>
<p>Significance level to compute the \((1-\alpha)\)% confidence intervals. Default is <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a set of angles \[\boldsymbol{\Theta}:= \left\lbrace \frac{\pi(m+1-j)}{2(m+1)} \mid 1\leq j\leq m\right\rbrace\] decreasing from near \(\pi/2\) to \(0\), 
and let \(L_\theta:=\left\lbrace(x,y)\in R^2_+ | \tan(\theta)=y/x\right\rbrace\) denote the line segment intersecting the origin with gradient \(\tan(\theta) > 0.\)
For each \(\theta\in \boldsymbol{\Theta},\) \(L_\theta\) intersects the estimated \(\hat{RC}(p)\) exactly once, i.e. \(\lbrace(\hat{x}_\theta, \hat{y}_\theta)\rbrace:= \hat{RC}(p)\cap L_\theta.\) 
Uncertainty of the return curve is then quantified by the distribution of \(\hat{d}_\theta:=(\hat{x}^2_\theta + \hat{y}^2_\theta)^{1/2}\) via a (block) bootstrap procedure. 
</p>
<p>This procedure is as follows; for \(k = 1, \ldots, \) <code>nboot</code>:
</p>
<p>1. (Block) bootstrap the original data set; 
</p>
<p>2. For each \(\theta\in \boldsymbol{\Theta},\) obtain \(\hat{d}_{\theta,k}\) for the corresponding return curve point estimate.
</p>
<p>Full details can be found in Murphy-Barltrop et al. (2023)
</p>


<h3>Value</h3>

<p>An object of S4 class <code>rc_unc.class</code>. This object returns the arguments of the function and an extra slot <code>unc</code> which is a list containing:
</p>
<table>
<tr><td><code>median</code></td>
<td>
<p>A vector containing the median estimates of the return curve.</p>
</td></tr> 
<tr><td><code>mean</code></td>
<td>
<p>A vector containing the mean estimates of the return curve.</p>
</td></tr> 
<tr><td><code>lower</code></td>
<td>
<p>A vector containing the lower bound of the confidence interval.</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>A vector containing the upper bound of the confidence interval.</p>
</td></tr>
</table>
<p>The <code>plot</code> function takes an object of S4 class <code>rc_unc.class</code>, and a <code>which</code> argument specifying the type of plot desired (see <strong>Examples</strong>):
</p>
<table>
<tr><td><code>"rc"</code></td>
<td>
<p>Plots the estimated Return Curve and its uncertainty (default).</p>
</td></tr>
<tr><td><code>"median"</code></td>
<td>
<p>Plots the median estimates of the Return Curve and its uncertainty.</p>
</td></tr>
<tr><td><code>"mean"</code></td>
<td>
<p>Plots the mean estimates of the Return Curve and its uncertainty.</p>
</td></tr>
<tr><td><code>"all"</code></td>
<td>
<p>Plots the estimated Return Curve, the median and mean estimates of the Return Curve together, and the associated uncertainty.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Murphy-Barltrop CJR, Wadsworth JL, Eastoe EF (2023).
&ldquo;New estimation methods for extremal bivariate return curves.&rdquo;
<em>Environmetrics</em>, <b>34</b>(5).
ISSN 1099095X, <a href="https://doi.org/10.1002/env.2797">doi:10.1002/env.2797</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ReturnCurves)

data(airdata)

n &lt;- dim(airdata)[1]

prob &lt;- 10/n

margdata &lt;- margtransf(airdata)

rc_orig &lt;- rc_est(margdata = margdata, p = prob, method = "hill")


# Set nboot = 50 for an illustrative example
# blocksize to account for temporal dependence
unc &lt;- rc_unc(rc_orig, blocksize = 10) 

# Plots the estimated Return Curve 
plot(unc, which = "rc") 

# Plots the median estimates of the Return Curve
plot(unc, which = "median") 

# Plots the mean estimates of the Return Curve
plot(unc, which = "mean") 

# Plots the estimated Return Curve and its the median and mean estimates
plot(unc, which = "all") 

# To see the the S4 object's slots
str(unc)

# To access the list of vectors
unc@unc


</code></pre>

<hr>
<h2 id='rc_unc.class'>An S4 class to represent the Uncertainty of the Return Curve estimates</h2><span id='topic+rc_unc.class'></span>

<h3>Description</h3>

<p>An S4 class to represent the Uncertainty of the Return Curve estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rc_unc.class(retcurve, blocksize, nboot, nangles, alpha, unc)
</code></pre>


<h3>Slots</h3>


<dl>
<dt><code>retcurve</code></dt><dd><p>An S4 object of class <code>rc_est.class</code>.</p>
</dd>
<dt><code>blocksize</code></dt><dd><p>Size of the blocks for the block bootstrap procedure. If <code>1</code> (default), then a standard bootstrap approach is applied.</p>
</dd>
<dt><code>nboot</code></dt><dd><p>Number of bootstrap samples to be taken. Default is <code>250</code> samples.</p>
</dd>
<dt><code>nangles</code></dt><dd><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Number of angles \(m\) in the interval \((0, \pi/2)\) (Murphy-Barltrop et al. 2023). Default is <code>150</code> angles.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>Significance level to compute the \((1-\alpha)\)% confidence intervals. Default is <code>0.05</code>.</p>
</dd>
<dt><code>unc</code></dt><dd><p>A list containing the median and mean estimates of the Return Curve, and the lower and upper bound of the confidence interval.</p>
</dd>
</dl>

<hr>
<h2 id='runShiny'>Complementary Shiny app for the ReturnCurves package</h2><span id='topic+runShiny'></span>

<h3>Description</h3>

<p>Launches the R Shiny app complementary to the <code><a href="#topic+ReturnCurves-package">ReturnCurves-package</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runShiny()
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
