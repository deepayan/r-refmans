<!DOCTYPE html><html><head><title>Help for package HUM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HUM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CalcGene'>
<p>Calculate HUM value</p></a></li>
<li><a href='#CalcROC'>
<p>Calculate ROC points</p></a></li>
<li><a href='#Calculate3D'>
<p>Plot the 3D-ROC curve</p></a></li>
<li><a href='#CalculateHUM_Ex'>
<p>Calculate HUM value</p></a></li>
<li><a href='#CalculateHUM_Plot'>
<p>Plot 2D-ROC curve</p></a></li>
<li><a href='#CalculateHUM_ROC'>
<p>Calculate HUM value</p></a></li>
<li><a href='#CalculateHUM_seq'>
<p>Calculate HUM value</p></a></li>
<li><a href='#dataset'>
<p>simulated data</p></a></li>
<li><a href='#HUM-package'>
<p>HUM calculation</p></a></li>
<li><a href='#sim'>
<p>desease data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Compute HUM Value and Visualize ROC Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Natalia Novoselova,Junxi Wang,Jialiang Li, Frank Pessler,Frank Klawonn</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Natalia Novoselova &lt;novos65@mail.ru&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for computing HUM (Hypervolume Under the Manifold) value to estimate features ability
             to discriminate the class labels, visualizing the ROC curve for two or three class labels
             (Natalia Novoselova, Cristina Della Beffa, Junxi Wang, Jialiang Li, Frank Pessler, Frank Klawonn
             (2014) &lt;<a href="https://doi.org/10.1093%2Fbioinformatics%2Fbtu086">doi:10.1093/bioinformatics/btu086</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>rgl</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.13.0),gtools,Rcpp (&ge; 0.12.1)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://public.ostfalia.de/~klawonn/HUM.htm">https://public.ostfalia.de/~klawonn/HUM.htm</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-21 13:11:44 UTC; novosel</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-21 13:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CalcGene'>
Calculate HUM value
</h2><span id='topic+CalcGene'></span>

<h3>Description</h3>

<p>This is the auxiliary function of the HUM package. It computes a HUM value for individual feature and returns a &ldquo;List&rdquo; object, consisting of HUM value and the best permutation of class labels in &ldquo;seq&rdquo; vector. This &ldquo;seq&rdquo; vector can be passed to the function <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcGene(s_data, seqAll, prodValue)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcGene_+3A_s_data">s_data</code></td>
<td>
<p>a list, which contains the vectors of sorted feature values for individual class labels.
</p>
</td></tr>
<tr><td><code id="CalcGene_+3A_seqall">seqAll</code></td>
<td>
<p>a numeric matrix of all the permutations of the class labels, where each row corresponds to individual permutation vector.
</p>
</td></tr>
<tr><td><code id="CalcGene_+3A_prodvalue">prodValue</code></td>
<td>
<p>a numeric value, which is the product of the sizes of feature vectors, corresponding to analized class labels.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function's main job is to compute the maximal HUM value between the all possible permutations of class labels for individual feature, selected for analysis. See the &ldquo;Value&rdquo; section to this page for more details.
</p>


<h3>Value</h3>

<p>The data must be provided without missing values in order to process. A returned list consists of the following fields: 
</p>
<table>
<tr><td><code>HUM</code></td>
<td>
<p>a list of HUM values for the specified number of analyzed features</p>
</td></tr>
<tr><td><code>seq</code></td>
<td>
<p>a list of vectors, each containing the sequence of class labels</p>
</td></tr>
</table>


<h3>Errors</h3>

<p>If there exists NA values for features or class labels no HUM value can be calculated and an error is triggered with
message &ldquo;Values are missing&rdquo;.
</p>


<h3>References</h3>

<p>Li, J. and Fine, J. P. (2008): ROC Analysis with Multiple Tests and Multiple Classes: methodology and its application in microarray studies.<em>Biostatistics</em>. 9 (3): 566-576.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalculateHUM_Ex">CalculateHUM_Ex</a></code>, <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim)
# Basic example
indexF=3;
indexClass=2;
indexLabel=c("Normal","OrthArthr")
s_data=NULL;
prodValue=1;
for(i in 1:length(indexLabel))
{
  index=which(sim[,indexClass]==indexLabel[i])
  vrem=sort(sim[index,indexF])
  s_data=c(s_data,list(vrem))
  prodValue=prodValue*length(index)
}
len=length(indexLabel)
seqAll=permutations(len,len,1:len)
out=CalcGene(s_data, seqAll, prodValue)
</code></pre>

<hr>
<h2 id='CalcROC'>
Calculate ROC points
</h2><span id='topic+CalcROC'></span>

<h3>Description</h3>

<p>This is the auxiliary function of the HUM package. It computes a point coordinates for plotting ROC curve and returns a &ldquo;List&rdquo; object,  consisting of sensitivity and specificity values for 2D-ROC curve and 3D-points for 3D-ROC curve, the optimal threshold values with the corresponding feature values and the accuracy of the classifier (feature).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcROC(s_data, seq, thresholds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcROC_+3A_s_data">s_data</code></td>
<td>
<p>a list, which contains the vectors of sorted feature values for individual class labels.
</p>
</td></tr>
<tr><td><code id="CalcROC_+3A_seq">seq</code></td>
<td>
<p>a numeric vector, containing the particular permutation of class labels.
</p>
</td></tr>
<tr><td><code id="CalcROC_+3A_thresholds">thresholds</code></td>
<td>
<p>a numeric vector, containing the values of thresholds for calculating ROC curve coordinates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function's main job is to compute the point coordinates to plot the 2D- or 3D-ROC curve, the optimal threshold values and the accuracy of classifier. See the &ldquo;Value&rdquo; section to this page for more details. The optimal threshold for two-class problem is the pair of sensitivity and specificity values for the selected feature. The optimal threshold for three-class problem is the 3D-point with the coordinates presenting the fraction of the correctly classified data objects for each class. The calculation of the optimal threshold is described in section &ldquo;Threshold&rdquo;.
</p>


<h3>Value</h3>

<p>The data must be provided without missing values in order to process. A returned list consists of the following fields: 
</p>
<table>
<tr><td><code>Sn</code></td>
<td>
<p>a specificity values for 2D-ROC construction and the first coordinate for 3D-ROC construction</p>
</td></tr>
<tr><td><code>Sp</code></td>
<td>
<p>a sensitivity values for 2D-ROC construction and the second coordinate for 3D-ROC construction</p>
</td></tr>
<tr><td><code>S3</code></td>
<td>
<p>the third coordinate for 3D-ROC construction</p>
</td></tr>
<tr><td><code>optSn</code></td>
<td>
<p>the optimal specificity value for 2D-ROC construction and the first coordinate of the op-timal threshold for 3D-ROC construction</p>
</td></tr>
<tr><td><code>optSp</code></td>
<td>
<p>the optimal sensitivity value for 2D-ROC construction and the second coordinate of the optimal threshold for 3D-ROC construction</p>
</td></tr>
<tr><td><code>optS3</code></td>
<td>
<p>the third coordinate of the optimal threshold for 3D-ROC construction
</p>
</td></tr>
<tr><td><code>optThre</code></td>
<td>
<p>the feature value according to the optimal threshold (optSn,optSp) for two-class problem</p>
</td></tr>
<tr><td><code>optThre1</code></td>
<td>
<p>the first feature value according to the optimal threshold (optSn,optSp,optS3) for three-class problem</p>
</td></tr>
<tr><td><code>optThre2</code></td>
<td>
<p>the second feature value according to the optimal threshold (optSn,optSp,optS3) for three-class problem</p>
</td></tr>
<tr><td><code>accuracy</code></td>
<td>
<p>the accuracy of classifier (feature) for the optimal threshold</p>
</td></tr>
</table>


<h3>Threshold</h3>

<p>The optimal threshold value is calculated for two-class problem as the pair &ldquo;(optSn, optSp)&rdquo; corresponding to the maximal value of &ldquo;Sn+Sp&rdquo;. According to &ldquo;(optSn, optSp)&rdquo; the corresponding feature threshold value &ldquo;optThre&rdquo; is calculated.
The optimal threshold value is calculated for three-class problem as the pair &ldquo;(optSn, optSp,optS3)&rdquo; corresponding to the maximal value of &ldquo;Sn+Sp+S3&rdquo;.According to &ldquo;(optSn, optSp,optS3)&rdquo; the corresponding feature threshold values &ldquo;optThre1,optThre2&rdquo; are calculated.
The accuracy of the classifier is the mean value of dQuote(optSn, optSp) for two-class problem and the mean value of &ldquo;(optSn, optSp,optS3)&rdquo; for three-class problem.
</p>


<h3>Errors</h3>

<p>If there exists NA values for features or class labels no HUM value can be calculated and an error is triggered with
message &ldquo;Values are missing&rdquo;.
</p>


<h3>References</h3>

<p>Li, J. and Fine, J. P. (2008): ROC Analysis with Multiple Tests and Multiple Classes: methodology and its application in microarray studies.<em>Biostatistics</em>. 9 (3): 566-576.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalculateHUM_Ex">CalculateHUM_Ex</a></code>, <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim)
indexF=names(sim[,c(3,4),drop = FALSE])
indexClass=2
label=unique(sim[,indexClass])
indexLabel=label[1:3]
out=CalculateHUM_seq(sim,indexF,indexClass,indexLabel)
HUM&lt;-out$HUM
seq&lt;-out$seq

indexL=NULL
for(i in 1:length(indexLabel))
{
  indexL=c(indexL,which(label==indexLabel[i]))
}
  
indexEach=NULL
indexUnion=NULL

for(i in 1:length(label))
{
  vrem=which(sim[,indexClass]==label[i])
  indexEach=c(indexEach,list(vrem))
  if(length(intersect(label[i],indexLabel))==1)
    indexUnion=union(indexUnion,vrem)
}
s_data=NULL
dataV=sim[,indexF[1]]  #single feature
prodValue=1
for (j in 1:length(indexLabel))
{
  vrem=sort(dataV[indexEach[[indexL[j]]]])

  s_data=c(s_data,list(vrem))
  prodValue = prodValue*length(vrem)
}
#calculate the threshold values for plot of 2D ROC and 3D ROC
thresholds &lt;- sort(unique(dataV[indexUnion]))
thresholds=(c(-Inf, thresholds) + c(thresholds, +Inf))/2
  
out=CalcROC(s_data,seq[,indexF[1]], thresholds)
</code></pre>

<hr>
<h2 id='Calculate3D'>
Plot the 3D-ROC curve
</h2><span id='topic+Calculate3D'></span>

<h3>Description</h3>

<p>This is the main function of the HUM package. It plots the 3D-ROC curve using the point coordinates, computed by the function <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>. Optionally visualizes the optimal threshold point, which gives the maximal accuracy of the classifier(feature) (see <code><a href="#topic+CalcROC">CalcROC</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Calculate3D(sel,Sn,Sp,S3,optSn,optSp,optS3,thresholds,HUM,name,print.optim=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Calculate3D_+3A_sel">sel</code></td>
<td>
<p>a character value, which is the name of the selected feature.
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_sn">Sn</code></td>
<td>
<p>a numeric vector of the x-coordinates of the ROC curve..
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_sp">Sp</code></td>
<td>
<p>a numeric vector of the y-coordinates of the ROC curve.
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_s3">S3</code></td>
<td>
<p>a numeric vector of the z-coordinates of the ROC curve.
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_optsn">optSn</code></td>
<td>
<p>the first coordinate of the optimal threshold
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_optsp">optSp</code></td>
<td>
<p>the second coordinate of the optimal threshold
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_opts3">optS3</code></td>
<td>
<p>the third coordinate of the optimal threshold
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_thresholds">thresholds</code></td>
<td>
<p>a numeric vector with threshold values to calculate point coordinates.
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_hum">HUM</code></td>
<td>
<p>a numeric vector of HUM values, calculated using function. 
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_name">name</code></td>
<td>
<p>a character vector of class labels.
</p>
</td></tr>
<tr><td><code id="Calculate3D_+3A_print.optim">print.optim</code></td>
<td>
<p>a boolean parameter to plot the optimal threshold point on the graph. The default value is TRUE. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function's main job is to plot the 3D-ROC curve according to the given point coordinates.
</p>


<h3>Value</h3>

<p>The function doesn't return any value.
</p>


<h3>Errors</h3>

<p>If there exists NA values for specificity or sensitivity values, or HUM values the plotting fails and an error is triggered with message &ldquo;Values are missing&rdquo;
</p>


<h3>References</h3>

<p>Li, J. and Fine, J. P. (2008): ROC Analysis with Multiple Tests and Multiple Classes: methodology and its application in microarray studies.<em>Biostatistics</em>. 9 (3): 566-576.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalculateHUM_seq">CalculateHUM_seq</a></code>, <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim)
indexF=names(sim[,c(3),drop = FALSE])
indexClass=2
label=unique(sim[,indexClass])
indexLabel=label[1:3]
out=CalculateHUM_seq(sim,indexF,indexClass,indexLabel)
HUM&lt;-out$HUM
seq&lt;-out$seq
out=CalculateHUM_ROC(sim,indexF,indexClass,indexLabel,seq)
Calculate3D(indexF,out$Sn,out$Sp,out$S3,out$optSn,out$optSp,out$optS3,
out$thresholds,HUM,indexLabel[seq])
</code></pre>

<hr>
<h2 id='CalculateHUM_Ex'>
Calculate HUM value
</h2><span id='topic+CalculateHUM_Ex'></span>

<h3>Description</h3>

<p>This is the main function of the HUM package. It computes a HUM value and returns a &ldquo;List&rdquo; object, consisting of HUM value and the best permutation of class labels in &ldquo;seq&rdquo; vector. This &ldquo;seq&rdquo; vector can be passed to the function <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculateHUM_Ex(data,indexF,indexClass,allLabel,amountL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalculateHUM_Ex_+3A_data">data</code></td>
<td>
<p>a dataset, a matrix of feature values for several cases, the additional column with class labels is provided. Class labels could be numerical or character values. The maximal number of classes is ten. The <code>indexClass</code> determines the column with class labels.
</p>
</td></tr>
<tr><td><code id="CalculateHUM_Ex_+3A_indexf">indexF</code></td>
<td>
<p>a numeric or character vector, containing the column numbers or column names of the analyzed features.
</p>
</td></tr>
<tr><td><code id="CalculateHUM_Ex_+3A_indexclass">indexClass</code></td>
<td>
<p>a numeric or character value, containing the column number or column name of the class labels.
</p>
</td></tr>
<tr><td><code id="CalculateHUM_Ex_+3A_alllabel">allLabel</code></td>
<td>
<p>a character vector, containing the column names of the class labels, selected for the analysis.</p>
</td></tr>
<tr><td><code id="CalculateHUM_Ex_+3A_amountl">amountL</code></td>
<td>
<p>a character vector, containing the column names of the class labels, selected for the analysis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function's main job is to compute the maximal HUM value between the all possible permutations of class labels, selected for analysis. See the
&ldquo;Value&rdquo; section to this page for more details. Before
returning, it will call the <code><a href="#topic+CalcGene">CalcGene</a></code> function to calculate the HUM value for each case (object).
</p>
<p>Data can be provided in matrix form, where the rows correspond to cases with feature values and class label. The columns contain the values of individual features and the separate column contains class labels. The maximal number of class labels equals 10. The computational efficiency of the function descrease in the case of more than 1000 cases with more than 6 class labels..
</p>


<h3>Value</h3>

<p>The data must be provided without missing values in order to process. A returned list consists of th the following fields: 
</p>
<table>
<tr><td><code>HUM</code></td>
<td>
<p>a list of HUM values for the specified number of analyzed features</p>
</td></tr>
<tr><td><code>seq</code></td>
<td>
<p>a list of vectors, each containing the sequence of class labels</p>
</td></tr>
</table>


<h3>Errors</h3>

<p>If there exists NA values for features or class labels no HUM value can be calculated and an error is triggered with
message &ldquo;Values are missing&rdquo;.
</p>


<h3>References</h3>

<p>Li, J. and Fine, J. P. (2008): ROC Analysis with Multiple Tests and Multiple Classes: methodology and its application in microarray studies.<em>Biostatistics</em>. 9 (3): 566-576.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalculateHUM_seq">CalculateHUM_seq</a></code>, <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim)
# Basic example
indexF=c(3,4);
indexClass=2;
allLabel=c("Normal","OrthArthr","OA","Early")
amountL=2
out=CalculateHUM_Ex(sim,indexF,indexClass,allLabel,amountL)
</code></pre>

<hr>
<h2 id='CalculateHUM_Plot'>
Plot 2D-ROC curve
</h2><span id='topic+CalculateHUM_Plot'></span>

<h3>Description</h3>

<p>This is the main function of the HUM package. It plots the 2D-ROC curve using the point coordinates, computed by the function <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>.Optionally visualizes the optimal threshold point, which gives the maximal accuracy of the classifier(feature) (see <code><a href="#topic+CalcROC">CalcROC</a></code>). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculateHUM_Plot(sel,Sn,Sp,optSn,optSp,HUM,print.optim=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalculateHUM_Plot_+3A_sel">sel</code></td>
<td>
<p>a character value, which is the name of the selected feature.
</p>
</td></tr>
<tr><td><code id="CalculateHUM_Plot_+3A_sn">Sn</code></td>
<td>
<p>a numeric vector of the x-coordinates of the ROC curve, which is the specificity values of the standard ROC analysis..
</p>
</td></tr>
<tr><td><code id="CalculateHUM_Plot_+3A_sp">Sp</code></td>
<td>
<p>a numeric vector of the y-coordinates of the ROC curve, which is the sensitivity values of the standard ROC analysis..
</p>
</td></tr>
<tr><td><code id="CalculateHUM_Plot_+3A_optsn">optSn</code></td>
<td>
<p>the optimal specificity value for 2D-ROC construction
</p>
</td></tr>
<tr><td><code id="CalculateHUM_Plot_+3A_optsp">optSp</code></td>
<td>
<p>the optimal sensitivity value for 2D-ROC construction
</p>
</td></tr>
<tr><td><code id="CalculateHUM_Plot_+3A_hum">HUM</code></td>
<td>
<p>a numeric vector of HUM values, calculated using function <code><a href="#topic+CalculateHUM_seq">CalculateHUM_seq</a></code> or <code><a href="#topic+CalculateHUM_Ex">CalculateHUM_Ex</a></code>.
</p>
</td></tr>
<tr><td><code id="CalculateHUM_Plot_+3A_print.optim">print.optim</code></td>
<td>
<p>a boolean parameter to plot the optimal threshold point on the graph. The default value is TRUE. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function's main job is to plot the 2D-ROC curve according to the given point coordinates.
</p>


<h3>Value</h3>

<p>The function doesn't return any value.
</p>


<h3>Errors</h3>

<p>If there exists NA values for specificity or sensitivity values, or HUM values the plotting fails and an error is triggered with message &ldquo;Values are missing&rdquo;.
</p>


<h3>References</h3>

<p>Li, J. and Fine, J. P. (2008): ROC Analysis with Multiple Tests and Multiple Classes: methodology and its application in microarray studies.<em>Biostatistics</em>. 9 (3): 566-576.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalculateHUM_seq">CalculateHUM_seq</a></code>, <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim)
# Basic example
indexF=names(sim[,c(3),drop = FALSE])
indexClass=2
label=unique(sim[,indexClass])
indexLabel=label[1:2]
out=CalculateHUM_seq(sim,indexF,indexClass,indexLabel)
HUM&lt;-out$HUM
seq&lt;-out$seq
out=CalculateHUM_ROC(sim,indexF,indexClass,indexLabel,seq)
CalculateHUM_Plot(indexF,out$Sn,out$Sp,out$optSn,out$optSp,HUM)
</code></pre>

<hr>
<h2 id='CalculateHUM_ROC'>
Calculate HUM value
</h2><span id='topic+CalculateHUM_ROC'></span>

<h3>Description</h3>

<p>This is the  function of the HUM package for computing th enpoints for ROC curve. It returns a &ldquo;List&rdquo; object, consisting of sensitivity and specificity values for 2D-ROC curve and 3D-points for 3D-ROC curve. Also the optimal threshold values are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculateHUM_ROC(data,indexF,indexClass,indexLabel,seq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalculateHUM_ROC_+3A_data">data</code></td>
<td>
<p>a dataset, a matrix of feature values for several cases, the additional column with class labels is provided. Class labels could be numerical or character values. The maximal number of classes is ten. The <code>indexClass</code> determines the column with class labels.
</p>
</td></tr>
<tr><td><code id="CalculateHUM_ROC_+3A_indexf">indexF</code></td>
<td>
<p>a numeric or character vector, containing the column numbers or column names of the analyzed features.
</p>
</td></tr>
<tr><td><code id="CalculateHUM_ROC_+3A_indexclass">indexClass</code></td>
<td>
<p>a numeric or character value, containing the column number or column name of the class labels.
</p>
</td></tr>
<tr><td><code id="CalculateHUM_ROC_+3A_indexlabel">indexLabel</code></td>
<td>
<p>a character vector, containing the column names of the class labels, selected for the analysis.</p>
</td></tr>
<tr><td><code id="CalculateHUM_ROC_+3A_seq">seq</code></td>
<td>
<p>a numeric matrix, containing the permutation of the class labels for all features.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function's main job is to compute the point coordinates to plot the 2D- or 3D-ROC curve and the optimal threshold values. See the &ldquo;Value&rdquo; section to this page for more details. The function calls the <code><a href="#topic+CalcROC">CalcROC</a></code> to calculate the point coordinates, optimal thresholds and accuracy of classifier (feature) in the threshold.
</p>
<p>Data can be provided in matrix form, where the rows correspond to cases with feature values and class label. The columns contain the values of individual features and the separate column contains class labels. The maximal number of class labels equals 10.
</p>


<h3>Value</h3>

<p>The data must be provided without missing values in order to process. A returned list consists of th the following fields: 
</p>
<table>
<tr><td><code>Sn</code></td>
<td>
<p>a specificity values for 2D-ROC construction and the first coordinate for 3D-ROC construction</p>
</td></tr>
<tr><td><code>Sp</code></td>
<td>
<p>a sensitivity values for 2D-ROC construction and the second coordinate for 3D-ROC construction</p>
</td></tr>
<tr><td><code>S3</code></td>
<td>
<p>the third coordinate for 3D-ROC construction</p>
</td></tr>
<tr><td><code>optSn</code></td>
<td>
<p>the optimal specificity value for 2D-ROC construction and the first coordinate of the op-timal threshold for 3D-ROC construction</p>
</td></tr>
<tr><td><code>optSp</code></td>
<td>
<p>the optimal sensitivity value for 2D-ROC construction and the second coordinate of the optimal threshold for 3D-ROC construction</p>
</td></tr>
<tr><td><code>optS3</code></td>
<td>
<p>the third coordinate of the optimal threshold for 3D-ROC construction</p>
</td></tr>
</table>


<h3>Errors</h3>

<p>If there exists NA values for features or class labels no HUM value can be calculated and an error is triggered with
message &ldquo;Values are missing&rdquo;.
</p>


<h3>References</h3>

<p>Li, J. and Fine, J. P. (2008): ROC Analysis with Multiple Tests and Multiple Classes: methodology and its application in microarray studies.<em>Biostatistics</em>. 9 (3): 566-576.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalculateHUM_Ex">CalculateHUM_Ex</a></code>, <code><a href="#topic+CalculateHUM_seq">CalculateHUM_seq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim)
# Basic example
indexF=names(sim[,c(3),drop = FALSE])
indexClass=2
label=unique(sim[,indexClass])
indexLabel=label[1:2]
out=CalculateHUM_seq(sim,indexF,indexClass,indexLabel)
HUM&lt;-out$HUM
seq&lt;-out$seq
out=CalculateHUM_ROC(sim,indexF,indexClass,indexLabel,seq)
</code></pre>

<hr>
<h2 id='CalculateHUM_seq'>
Calculate HUM value
</h2><span id='topic+CalculateHUM_seq'></span>

<h3>Description</h3>

<p>This is the main function of the HUM package. It computes a HUM value and returns a &ldquo;List&rdquo; object, consisting of HUM value and the best permutation of class labels in &ldquo;seq&rdquo; vector. This &ldquo;seq&rdquo; vector can be passed to the function <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculateHUM_seq(data,indexF,indexClass,indexLabel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalculateHUM_seq_+3A_data">data</code></td>
<td>
<p>a dataset, a matrix of feature values for several cases, the additional column with class labels is provided. Class labels could be numerical or character values. The maximal number of classes is ten. The <code>indexClass</code> determines the column with class labels.</p>
</td></tr>
<tr><td><code id="CalculateHUM_seq_+3A_indexf">indexF</code></td>
<td>
<p>a numeric or character vector, containing the column numbers or column names of the analyzed features.</p>
</td></tr>
<tr><td><code id="CalculateHUM_seq_+3A_indexclass">indexClass</code></td>
<td>
<p>a numeric or character value, containing the column number or column name of the class labels.</p>
</td></tr>
<tr><td><code id="CalculateHUM_seq_+3A_indexlabel">indexLabel</code></td>
<td>
<p>a character vector, containing the column names of the class labels, selected for the analysis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function's main job is to compute the maximal HUM value between the all possible permutations of class labels, selected for analysis. See the
&ldquo;Value&rdquo; section to this page for more details. Before
returning, it will call the <code><a href="#topic+CalcGene">CalcGene</a></code> function to calculate the HUM value for each feature (object).
</p>
<p>Data can be provided in matrix form, where the rows correspond to cases with feature values and class label. The columns contain the values of individual features and the separate column contains class labels. The maximal number of class labels equals 10. The computational efficiency of the function descrease in the case of more than 1000 cases with more than 6 class labels..
</p>


<h3>Value</h3>

<p>The data must be provided without missing values in order to process. A returned list consists of th the following fields: 
</p>
<table>
<tr><td><code>HUM</code></td>
<td>
<p>a list of HUM values for the specified number of analyzed features</p>
</td></tr>
<tr><td><code>seq</code></td>
<td>
<p>a list of vectors, each containing the sequence of class labels</p>
</td></tr>
</table>


<h3>Errors</h3>

<p>If there exists NA values for features or class labels no HUM value can be calculated and an error is triggered with
message &ldquo;Values are missing&rdquo;.
</p>


<h3>References</h3>

<p>Li, J. and Fine, J. P. (2008): ROC Analysis with Multiple Tests and Multiple Classes: methodology and its application in microarray studies.<em>Biostatistics</em>. 9 (3): 566-576.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalculateHUM_Ex">CalculateHUM_Ex</a></code>, <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim)
# Basic example
indexF=names(sim[,c(3,4)])
indexClass=2
label=unique(sim[,indexClass])
indexLabel=label[1:3]
out=CalculateHUM_seq(sim,indexF,indexClass,indexLabel)
</code></pre>

<hr>
<h2 id='dataset'>
simulated data
</h2><span id='topic+dataset'></span>

<h3>Description</h3>

<p>This data file consists of six simulated predictors or variables with three class categories. For each class category the values are independently generated from the normal distribution with the mean µ1, µ2 and µ3 and the variances held at unity. The means are varied such that the problems range from near-separable problems, to near-random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataset)</code></pre>


<h3>Format</h3>

<p>A data.frame containing 300 observations of six variables.</p>


<h3>Source</h3>

<p>Landgrebe T, Duin R (2006) A simplified extension of the Area under the ROC to the multiclass domain. In: Proceedings 17th Annual Symposium of the Pattern Recognition Association of South Africa. PRASA, pp. 241–245.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sim">sim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load the dataset
data(dataset)
</code></pre>

<hr>
<h2 id='HUM-package'>
HUM calculation
</h2><span id='topic+HUM-package'></span><span id='topic+HUM'></span>

<h3>Description</h3>

<p>Functions to calculate AUC (area under curve) value  for two classes and HUM (hypervolume under manifold) for more class labels in order to estimate the informativity of features to outcome. Tools for visualizing ROC curve in 2D- and 3D-space.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> HUM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-10-25</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 3)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The basic unit of the HUM package is the <code><a href="#topic+CalculateHUM_seq">CalculateHUM_seq</a></code> function. It will calculate the AUC in case of two class labels and HUM for more than two class labels for the input features. Function <code><a href="#topic+CalculateHUM_Ex">CalculateHUM_Ex</a></code> is the extension of main function and provides the possibility to calculate all the combinations of <code>amountL</code> from all the class labels. Function  <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code> calculates the point coordinates in order to plot the 2D- and 3D-ROC curve, accuracy and the optimal threshold for the classifier (feature). The Functions <code><a href="#topic+CalcGene">CalcGene</a></code> and <code><a href="#topic+CalcROC">CalcROC</a></code> are the auxiliar function to perform the calculation. Function <code><a href="#topic+CalcROC">CalcROC</a></code> calculates the point coordinates of a single feature for two-class or three-class problem, the optimal threshold for the 2-D and 3-D ROC curve and the corresponding feature values, the accuracy of the classifier (feature) for the optimal threshold.
</p>


<h3>Functions</h3>


<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+CalculateHUM_seq">CalculateHUM_seq</a></code> </td><td style="text-align: left;"> Calculate a maximal HUM value amd the corresponding permutation of class labels</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+CalculateHUM_Ex">CalculateHUM_Ex</a></code> </td><td style="text-align: left;"> Calculate the HUM values with exaustive serach for specified number of class labels </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+CalculateHUM_ROC">CalculateHUM_ROC</a></code> </td><td style="text-align: left;"> Function to construct and plot the 2D- or 3d-ROC curve </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+CalcGene">CalcGene</a></code> </td><td style="text-align: left;"> Compute the HUM value for one feature </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+CalcROC">CalcROC</a></code> </td><td style="text-align: left;"> Compute the point coordinates to plot the 2D- or 3D-ROC curve </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+CalculateHUM_Plot">CalculateHUM_Plot</a></code> </td><td style="text-align: left;"> Plot the 2D-ROC curve </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+Calculate3D">Calculate3D</a></code> </td><td style="text-align: left;"> Plot the 3D-ROC curve </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Dataset</h3>

<p>This package comes with one simulated dataset and a real dataset of 92 patients with 11 features with disease.
</p>


<h3>Installing and using</h3>

<p>To install this package, make sure you are connected to the internet and issue the following command in the R prompt:
</p>
<pre>
    install.packages("HUM")
  </pre>
<p>To load the package in R:
</p>
<pre>
    library(HUM)
  </pre>


<h3>Author(s)</h3>

<p>Natalia Novoselova, Frank Pessler
</p>
<p>Maintainer: Natalia Novoselova &lt;novos65@mail.ru&gt;
</p>


<h3>References</h3>

<p>Li, J. and Fine, J. P. (2008): ROC Analysis with Multiple Tests and Multiple Classes: methodology and its application in microarray studies.<em>Biostatistics</em>. 9 (3): 566-576.
</p>


<h3>See Also</h3>

<p>CRAN packages <span class="pkg">pROC</span>, or Bioconductor's <span class="pkg">roc</span>
for ROC curves.
</p>
<p>CRAN packages <span class="pkg">Rcpp</span>, <span class="pkg">gtools</span>, <span class="pkg">rgl</span> employed in this package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim)

# Compute the HUM value with all possible class label permutation
indexF=c(3,4);
indexClass=2;
label=unique(sim[,indexClass])
indexLabel=label[1:3]
out=CalculateHUM_seq(sim,indexF,indexClass,indexLabel)
# Compute the HUM value with exaustive search of all class label combinations
## Not run: data(sim)
indexF=c(3,4);
indexClass=2;
labels=unique(sim[,indexClass])
amountL=4;
out=CalculateHUM_Ex(sim,indexF,indexClass,labels,amountL)

## End(Not run)
# Calculate the coordinates for 2D- or 3D- ROC curve and the optimal threshold point
## Not run: data(sim)
indexF=names(sim[,c(3),drop = FALSE])
indexClass=2
label=unique(sim[,indexClass])
indexLabel=label[1:3]
out=CalculateHUM_seq(sim,indexF,indexClass,indexLabel)
HUM&lt;-out$HUM
seq&lt;-out$seq
out=CalculateHUM_ROC(sim,indexF,indexClass,indexLabel,seq)

## End(Not run)
</code></pre>

<hr>
<h2 id='sim'>
desease data
</h2><span id='topic+sim'></span>

<h3>Description</h3>

<p>The data set corresponds to absolute (cells/mm2) or relative (percentage of the cell type in question of the entire inflammatory cell population) densities of 5 major inflammatory cell types in synovial tissue specimens from normal human joints (“Normal”) and from patients with osteoarthritis (“OA”), non-inflammatory orthopedic arthropathies (“Orth.A”), early unclassified arthritis (“EA”), rheumatoid arthritis (“RA”), and chronic septic arthritis (“SeA”). An analysis of this data set with binary and multicategory ROC analysis has been published in Della Beffa PLOS One 2013, which also contains additional details about the data set. The dataset consists of 92 cases with 11 features and disease code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sim)</code></pre>


<h3>Format</h3>

<p>A data.frame containing 92 observations of 11 variables.</p>


<h3>Source</h3>

<p>Cristina Della Beffa, Elisabeth Slansky, Claudia Pommerenke, Frank Klawonn, Jialiang Li, Lie Dai, H. Ralph Schumacher Jr., Frank Pessler (2013). The Relative Composition of the Inflammatory Infiltrate as an Additional Tool for Synovial Tissue Classification. PLoS ONE. 8(8): e72494.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dataset">dataset</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load the dataset
data(sim)
# CD15
with(sim, by(CD15,Disease,mean))

# CD20
with(sim,tapply(CD20, Disease, FUN = mean))
with(sim, table(CD20=ifelse(CD20&lt;=mean(CD20), "1", "2"), Disease))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
