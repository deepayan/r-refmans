<!DOCTYPE html><html><head><title>Help for package kantorovich</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {kantorovich}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#edistances'><p>Extremal distances</p></a></li>
<li><a href='#ejoinings'><p>Extreme joinings</p></a></li>
<li><a href='#kantorovich'><p>Kantorovich distance</p></a></li>
<li><a href='#kantorovich_CVX'><p>Computes Kantorovich distance with CVX</p></a></li>
<li><a href='#kantorovich_glpk'><p>Computes Kantorovich distance with GLPK</p></a></li>
<li><a href='#kantorovich_lp'><p>Computes Kantorovich distance with lp_solve</p></a></li>
<li><a href='#kantorovich_ompr'><p>Computes Kantorovich distance with 'ompr'</p></a></li>
<li><a href='#kantorovich-package'>
<p>Kantorovich Distance Between Probability Measures</p></a></li>
<li><a href='#names.bigq'><p>Names for bigq vectors</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Kantorovich Distance Between Probability Measures</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Stéphane Laurent</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stéphane Laurent &lt;laurent_step@outlook.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes the Kantorovich distance between two probability
    measures on a finite set. The Kantorovich distance is also known as
    the Monge-Kantorovich distance or the first Wasserstein distance.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/stla/kantorovich">https://github.com/stla/kantorovich</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/stla/kantorovich/issues">https://github.com/stla/kantorovich/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>CVXR, gmp, lpSolve, methods, rcdd, Rglpk, slam, utils, ompr,
ompr.roi, ROI.plugin.glpk</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GMP (https://gmplib.org/)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-22 18:44:07 UTC; SDL96354</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-22 19:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='edistances'>Extremal distances</h2><span id='topic+edistances'></span>

<h3>Description</h3>

<p>Compute the distances at the extreme joinings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>edistances(mu, nu, dist = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="edistances_+3A_mu">mu</code></td>
<td>
<p>(row margins) probability measure in numeric or bigq/character mode</p>
</td></tr>
<tr><td><code id="edistances_+3A_nu">nu</code></td>
<td>
<p>(column margins) probability measure in numeric or bigq/character mode</p>
</td></tr>
<tr><td><code id="edistances_+3A_dist">dist</code></td>
<td>
<p>function or matrix, the distance to be minimized on average.
If <code>NULL</code>, the 0-1 distance is used.</p>
</td></tr>
<tr><td><code id="edistances_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>dist</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components: the extreme joinings in a list and the distances in a vector.
</p>


<h3>Note</h3>

<p>This function, called by <code><a href="#topic+kantorovich">kantorovich</a></code>, is rather for internal purpose.
</p>

<hr>
<h2 id='ejoinings'>Extreme joinings</h2><span id='topic+ejoinings'></span>

<h3>Description</h3>

<p>Return extreme joinings between <code>mu</code> and <code>nu</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ejoinings(mu, nu, zeros = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ejoinings_+3A_mu">mu</code></td>
<td>
<p>(row margins) probability measure in numeric or bigq/character mode</p>
</td></tr>
<tr><td><code id="ejoinings_+3A_nu">nu</code></td>
<td>
<p>(column margins) probability measure in numeric or bigq/character mode</p>
</td></tr>
<tr><td><code id="ejoinings_+3A_zeros">zeros</code></td>
<td>
<p>logical; in case when <code>mu</code> and <code>nu</code> have different lengths,
set <code>FALSE</code> to remove lines or columns full of zeros</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the extreme joinings (matrices).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- nu &lt;- c(0.5, 0.5)
ejoinings(mu, nu)
# use exact arithmetic
library(gmp)
mu &lt;- nu &lt;- as.bigq(c(0.5,0.5))
ejoinings(mu, nu)
# different lengths example
mu &lt;- setNames(as.bigq(c(1,2,4), 7), c("a", "b", "c"))
nu &lt;- setNames(as.bigq(c(3,1), 4), c("b", "c"))
ejoinings(mu, nu)

</code></pre>

<hr>
<h2 id='kantorovich'>Kantorovich distance</h2><span id='topic+kantorovich'></span>

<h3>Description</h3>

<p>Compute the Kantorovich distance between two probability measures on a finite set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kantorovich(mu, nu, dist = NULL, details = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kantorovich_+3A_mu">mu</code></td>
<td>
<p>(row margins) probability measure in numeric or bigq/character mode</p>
</td></tr>
<tr><td><code id="kantorovich_+3A_nu">nu</code></td>
<td>
<p>(column margins) probability measure in numeric or bigq/character mode</p>
</td></tr>
<tr><td><code id="kantorovich_+3A_dist">dist</code></td>
<td>
<p>function or matrix, the distance to be minimized on average;
if <code>NULL</code>, the 0-1 distance is used.</p>
</td></tr>
<tr><td><code id="kantorovich_+3A_details">details</code></td>
<td>
<p>prints the joinings achieving the Kantorovich distance and
returns them in the <code>"joinings"</code> attribute of the output</p>
</td></tr>
<tr><td><code id="kantorovich_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>dist</code> (only if it is a function)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function firstly computes all the extreme joinings of <code>mu</code>
and <code>nu</code>, then evaluates the average distance for each of them, and
then returns the minimal one.
</p>


<h3>Value</h3>

<p>The Kantorovich distance between <code>mu</code> and <code>nu</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- c(1/7, 2/7, 4/7)
nu &lt;- c(1/4, 1/4, 1/2)
kantorovich(mu, nu)
library(gmp)
mu &lt;- as.bigq(c(1,2,4), 7)
nu &lt;- as.bigq(c(1,1,1), c(4,4,2))
kantorovich(mu, nu)
mu &lt;- c("1/7", "2/7", "4/7")
nu &lt;- c("1/4", "1/4", "1/2")
kantorovich(mu, nu, details=TRUE)

</code></pre>

<hr>
<h2 id='kantorovich_CVX'>Computes Kantorovich distance with CVX</h2><span id='topic+kantorovich_CVX'></span>

<h3>Description</h3>

<p>Kantorovich distance using the <code>CVXR</code> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kantorovich_CVX(
  mu,
  nu,
  dist = NULL,
  solution = FALSE,
  stop_if_fail = TRUE,
  solver = "ECOS",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kantorovich_CVX_+3A_mu">mu</code></td>
<td>
<p>(row margins) probability measure in numeric mode</p>
</td></tr>
<tr><td><code id="kantorovich_CVX_+3A_nu">nu</code></td>
<td>
<p>(column margins) probability measure in numeric mode</p>
</td></tr>
<tr><td><code id="kantorovich_CVX_+3A_dist">dist</code></td>
<td>
<p>matrix, the distance to be minimized on average;
if <code>NULL</code>, the 0-1 distance is used.</p>
</td></tr>
<tr><td><code id="kantorovich_CVX_+3A_solution">solution</code></td>
<td>
<p>logical; if <code>TRUE</code> the solution is returned in the
<code>"solution"</code> attributes of the output</p>
</td></tr>
<tr><td><code id="kantorovich_CVX_+3A_stop_if_fail">stop_if_fail</code></td>
<td>
<p>logical; if <code>TRUE</code>, an error is returned in the
case when no solution is found; if <code>FALSE</code>, the output of
<code><a href="CVXR.html#topic+psolve">psolve</a></code> is returned with a warning</p>
</td></tr>
<tr><td><code id="kantorovich_CVX_+3A_solver">solver</code></td>
<td>
<p>the <code>CVX</code> solver, passed to <code><a href="CVXR.html#topic+psolve">psolve</a></code></p>
</td></tr>
<tr><td><code id="kantorovich_CVX_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code><a href="CVXR.html#topic+psolve">psolve</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- c(1/7,2/7,4/7)
nu &lt;- c(1/4,1/4,1/2)
kantorovich_CVX(mu, nu)

</code></pre>

<hr>
<h2 id='kantorovich_glpk'>Computes Kantorovich distance with GLPK</h2><span id='topic+kantorovich_glpk'></span>

<h3>Description</h3>

<p>Kantorovich distance using the <code>Rglpk</code> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kantorovich_glpk(
  mu,
  nu,
  dist = NULL,
  solution = FALSE,
  stop_if_fail = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kantorovich_glpk_+3A_mu">mu</code></td>
<td>
<p>(row margins) probability measure in numeric mode</p>
</td></tr>
<tr><td><code id="kantorovich_glpk_+3A_nu">nu</code></td>
<td>
<p>(column margins) probability measure in numeric mode</p>
</td></tr>
<tr><td><code id="kantorovich_glpk_+3A_dist">dist</code></td>
<td>
<p>matrix, the distance to be minimized on average;
if <code>NULL</code>, the 0-1 distance is used.</p>
</td></tr>
<tr><td><code id="kantorovich_glpk_+3A_solution">solution</code></td>
<td>
<p>logical; if <code>TRUE</code> the solution is returned in the
<code>"solution"</code> attributes of the output</p>
</td></tr>
<tr><td><code id="kantorovich_glpk_+3A_stop_if_fail">stop_if_fail</code></td>
<td>
<p>logical; if <code>TRUE</code>, an error is returned in the
case when no solution is found; if <code>FALSE</code>, the output of
<code><a href="Rglpk.html#topic+Rglpk_solve_LP">Rglpk_solve_LP</a></code> is returned with a warning</p>
</td></tr>
<tr><td><code id="kantorovich_glpk_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="Rglpk.html#topic+Rglpk_solve_LP">Rglpk_solve_LP</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- c(1/7,2/7,4/7)
nu &lt;- c(1/4,1/4,1/2)
kantorovich_glpk(mu, nu)

</code></pre>

<hr>
<h2 id='kantorovich_lp'>Computes Kantorovich distance with lp_solve</h2><span id='topic+kantorovich_lp'></span>

<h3>Description</h3>

<p>Kantorovich distance using the <code>lpSolve</code> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kantorovich_lp(mu, nu, dist = NULL, solution = FALSE, lp.object = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kantorovich_lp_+3A_mu">mu</code></td>
<td>
<p>(row margins) probability measure in numeric mode</p>
</td></tr>
<tr><td><code id="kantorovich_lp_+3A_nu">nu</code></td>
<td>
<p>(column margins) probability measure in numeric mode</p>
</td></tr>
<tr><td><code id="kantorovich_lp_+3A_dist">dist</code></td>
<td>
<p>matrix, the distance to be minimized on average;
if <code>NULL</code>, the 0-1 distance is used.</p>
</td></tr>
<tr><td><code id="kantorovich_lp_+3A_solution">solution</code></td>
<td>
<p>logical, to use only if <code>lp.object=FALSE</code>;
if <code>TRUE</code> the solution is returned in the <code>"solution"</code> attributes
of the output</p>
</td></tr>
<tr><td><code id="kantorovich_lp_+3A_lp.object">lp.object</code></td>
<td>
<p>logical, if <code>FALSE</code>, the output is the Kantorovich
distance; if <code>TRUE</code>, the output is a <code><a href="lpSolve.html#topic+lp.object">lp.object</a></code></p>
</td></tr>
<tr><td><code id="kantorovich_lp_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="lpSolve.html#topic+lp">lp</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- c(1/7,2/7,4/7)
nu &lt;- c(1/4,1/4,1/2)
kantorovich_lp(mu, nu)

</code></pre>

<hr>
<h2 id='kantorovich_ompr'>Computes Kantorovich distance with 'ompr'</h2><span id='topic+kantorovich_ompr'></span>

<h3>Description</h3>

<p>Kantorovich distance using the <code>ompr</code> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kantorovich_ompr(mu, nu, dist = NULL, solution = FALSE, stop_if_fail = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kantorovich_ompr_+3A_mu">mu</code></td>
<td>
<p>(row margins) probability measure in numeric mode</p>
</td></tr>
<tr><td><code id="kantorovich_ompr_+3A_nu">nu</code></td>
<td>
<p>(column margins) probability measure in numeric mode</p>
</td></tr>
<tr><td><code id="kantorovich_ompr_+3A_dist">dist</code></td>
<td>
<p>matrix, the distance to be minimized on average;
if <code>NULL</code>, the 0-1 distance is used.</p>
</td></tr>
<tr><td><code id="kantorovich_ompr_+3A_solution">solution</code></td>
<td>
<p>logical; if <code>TRUE</code> the solution is returned in the
<code>"solution"</code> attributes of the output</p>
</td></tr>
<tr><td><code id="kantorovich_ompr_+3A_stop_if_fail">stop_if_fail</code></td>
<td>
<p>logical; if <code>TRUE</code>, an error is returned in the
case when no solution is found; if <code>FALSE</code>, the output of
<code><a href="ompr.html#topic+solve_model">solve_model</a></code> is returned with a warning</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The <code>glpk</code> solver is the one used to solve the problem.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- c(1/7,2/7,4/7)
nu &lt;- c(1/4,1/4,1/2)
kantorovich_ompr(mu, nu)

</code></pre>

<hr>
<h2 id='kantorovich-package'>
Kantorovich Distance Between Probability Measures
</h2><span id='topic+kantorovich-package'></span>

<h3>Description</h3>

<p>Computes the Kantorovich distance between two probability measures on a
finite set, also known as the earth mover's distance. The Kantorovich
distance is not a &quot;unique&quot; distance: it is defined by a given distance on
the two finite sets (generally equal). Note that the default distance is the
0-1 distance and with this choice the Kantorovich computation is totally
useless (see the vignette). Computing the Kantoroich distance is a linear
programming problem, and several methods are provided in the package. In
particular there is an exact method available when the probability weights
are rational numbers and when the distances are rational numbers as well.
A benchmark suggests that the faster methods are those using the 'CVXR'
package.
</p>
<p>To learn more, start with the vignettes:
<code>browseVignettes(package="kantorovich")</code>.
</p>
<p>If you encounter a bug, or if you have a suggestion to improve the package, please file an issue on the Github repo <a href="https://github.com/stla/kantorovich">https://github.com/stla/kantorovich</a>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> kantorovich</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 3.1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-08-22</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Stéphane Laurent
</p>

<hr>
<h2 id='names.bigq'>Names for bigq vectors</h2><span id='topic+names.bigq'></span>

<h3>Description</h3>

<p>Names for bigq vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bigq'
names(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="names.bigq_+3A_x">x</code></td>
<td>
<p>a <code>bigq</code> vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the names of <code>x</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
