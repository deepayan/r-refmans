<!DOCTYPE html><html><head><title>Help for package EXRQ</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EXRQ}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#est.gamma.func'><p>Estimation of the Extreme Value Index on the Original Scale</p></a></li>
<li><a href='#Estc.func'><p>Estimation of the C vector</p></a></li>
<li><a href='#EVI.CFG.func'><p>Hill Estimator of the Extreme Value Index</p></a></li>
<li><a href='#PowT.1tau.func'><p>Estimation for Quantile Power Transformation Model</p></a></li>
<li><a href='#qpareto'><p>Quantile of the Pareto Distribution</p></a></li>
<li><a href='#rpareto'><p>Random Generation for the Pareto Distribution</p></a></li>
<li><a href='#select.k.func'><p>Selection of the Tuning Parameter k</p></a></li>
<li><a href='#testC.EVI'><p>Testing the Constancy of EVI Over Covariates</p></a></li>
<li><a href='#ThreeStage'><p>Three-Stage Extreme Conditional Quantile Estimator</p></a></li>
<li><a href='#TwoStage'><p>Two-Stage Extreme Conditional Quantile Estimator</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extreme Regression of Quantiles</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-07-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Huixia Judy Wang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Huixia Judy Wang &lt;judywang@gwu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation for high conditional quantiles based on quantile regression.</td>
</tr>
<tr>
<td>Depends:</td>
<td>quantreg, mnormt</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-07-06 15:57:38 UTC; jwang1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-07-06 23:48:41</td>
</tr>
</table>
<hr>
<h2 id='est.gamma.func'>Estimation of the Extreme Value Index on the Original Scale</h2><span id='topic+est.gamma.func'></span>

<h3>Description</h3>

<p>This function estimates the extreme value index on the original scale based on the estimated intermediate conditional quantiles
on the transformed scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.gamma.func(taus, Lam.Q, lam, a = 0, tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est.gamma.func_+3A_taus">taus</code></td>
<td>
<p>a grid of intermediate high quantile levels</p>
</td></tr>
<tr><td><code id="est.gamma.func_+3A_lam.q">Lam.Q</code></td>
<td>
<p>a vector of the same length as taus, representing the estimated intermediate conditional quantiles of Y (at taus) on the transformed scale</p>
</td></tr>
<tr><td><code id="est.gamma.func_+3A_lam">lam</code></td>
<td>
<p>the power-transformation parameter</p>
</td></tr>
<tr><td><code id="est.gamma.func_+3A_a">a</code></td>
<td>
<p>location shift parameter in the power transformation (introduced to avoid negative y values)</p>
</td></tr>
<tr><td><code id="est.gamma.func_+3A_tol">tol</code></td>
<td>
<p>the tolerance level for checking quantile crossing issue</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following components.
</p>
<p>gamma.x: the estimated EVI. If quantile crossing is too severe,
which suggests that the estimated intermediate conditional quantiles are unstable, then NA is returned.
</p>
<p>Q: the estimated conditional quantile of Y on the original scale
</p>

<hr>
<h2 id='Estc.func'>Estimation of the C vector</h2><span id='topic+Estc.func'></span>

<h3>Description</h3>

<p>This function estimates the C vector involved in the function test.EVI for testing the constancy of EVI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Estc.func(y, x, tau = 0.99, M = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Estc.func_+3A_y">y</code></td>
<td>
<p>a vector of n untransformed responses</p>
</td></tr>
<tr><td><code id="Estc.func_+3A_x">x</code></td>
<td>
<p>a n x p matrix of n observations and p predictors</p>
</td></tr>
<tr><td><code id="Estc.func_+3A_tau">tau</code></td>
<td>
<p>an upper quantile level close to one</p>
</td></tr>
<tr><td><code id="Estc.func_+3A_m">M</code></td>
<td>
<p>a constant larger than one that is used for estimating the c vector and thus K(x) function. The default is two</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A p-dimensional vector is returned.
</p>

<hr>
<h2 id='EVI.CFG.func'>Hill Estimator of the Extreme Value Index</h2><span id='topic+EVI.CFG.func'></span>

<h3>Description</h3>

<p>Hill Estimator of the Extreme Value Index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EVI.CFG.func(x, tol = 1e-04, min.prop = 0.3, taus)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EVI.CFG.func_+3A_x">x</code></td>
<td>
<p>the estimated quantiles at intermediate quantile levels</p>
</td></tr>
<tr><td><code id="EVI.CFG.func_+3A_tol">tol</code></td>
<td>
<p>the tolerance level used for checking quantile crossing</p>
</td></tr>
<tr><td><code id="EVI.CFG.func_+3A_min.prop">min.prop</code></td>
<td>
<p>the minimum proportion of quantiles that are estimated higher than the adjacent lower quantiles</p>
</td></tr>
<tr><td><code id="EVI.CFG.func_+3A_taus">taus</code></td>
<td>
<p>the corresponding quantile levels</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the extreme value index using Hill estimator based on the estimated
intermediate quantiles.
</p>


<h3>Value</h3>

<p>The estimated extreme value index is returned. If the proportion of cases with quantile crossing is too high, an NA is returned.
</p>


<h3>References</h3>

<p>Chernozhukov, C., Fernandez-Val, I., and Galichon, A. (2010).
Quantile and probability curves without crossing. Econometrica, 78, 1093-1125.
</p>

<hr>
<h2 id='PowT.1tau.func'>Estimation for Quantile Power Transformation Model</h2><span id='topic+PowT.1tau.func'></span>

<h3>Description</h3>

<p>This function estimates the power transformation
parameter at a single given quantile level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PowT.1tau.func(y, x, tau, lams = seq(-2, 2, 0.1), a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PowT.1tau.func_+3A_y">y</code></td>
<td>
<p>a vector of length n representing the response</p>
</td></tr>
<tr><td><code id="PowT.1tau.func_+3A_x">x</code></td>
<td>
<p>a n x p matrix of n observations and p predictors</p>
</td></tr>
<tr><td><code id="PowT.1tau.func_+3A_tau">tau</code></td>
<td>
<p>the quantile level of interest</p>
</td></tr>
<tr><td><code id="PowT.1tau.func_+3A_lams">lams</code></td>
<td>
<p>a set of transformation parameters for grid search</p>
</td></tr>
<tr><td><code id="PowT.1tau.func_+3A_a">a</code></td>
<td>
<p>the location shift</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the transformation parameter lam following
the estimation method in Mu and He (2007) such that the conditional
quantile of the transformed response is linear in covariates.
The transformed response is defined as
</p>
<p style="text-align: center;"><code class="reqn">\Lambda(y) =
{(y+a)^\lambda-1}\lambda, if \lambda \neq 0; =log(y+a) if \lambda=0.
</code>
</p>



<h3>Value</h3>

<p>A list is returned with the following components
</p>
<p>lam: the estimated transformation parameter
</p>
<p>coef: the estimated quantile coefficient from the power-transformed linear quantile regression
</p>


<h3>References</h3>

<p>Mu, Y. and He, X. (2007). Power transformation toward a linear
regression quantile. Journal of the American Statistical Association, 102, 269-279.
</p>

<hr>
<h2 id='qpareto'>Quantile of the Pareto Distribution</h2><span id='topic+qpareto'></span>

<h3>Description</h3>

<p>Quantile of the Pareto Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qpareto(p, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qpareto_+3A_p">p</code></td>
<td>
<p>the quantile level</p>
</td></tr>
<tr><td><code id="qpareto_+3A_gamma">gamma</code></td>
<td>
<p>the shape parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the pth quantile
</p>

<hr>
<h2 id='rpareto'>Random Generation for the Pareto Distribution</h2><span id='topic+rpareto'></span>

<h3>Description</h3>

<p>Random Generation for the Pareto Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpareto(n, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpareto_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="rpareto_+3A_gamma">gamma</code></td>
<td>
<p>the shape parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of n i.i.d. random variables from the Pareto distribution
</p>

<hr>
<h2 id='select.k.func'>Selection of the Tuning Parameter k</h2><span id='topic+select.k.func'></span>

<h3>Description</h3>

<p>This function selects the tuning parameter k, the number of upper order statistics involved in Hill estimator of EVI among a grid of points
following the method described in Section 3.3 of Wang and Li (2013). The method selects k as the value that minimizes the discrepancy between
the estimated x-dependent EVI on the transformed scale and lam times the estimated x-dependent EVI on the original scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.k.func(y, x, Lam.y, lam, a, max.tau, grid.k, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select.k.func_+3A_y">y</code></td>
<td>
<p>a vector of n untransformed responses</p>
</td></tr>
<tr><td><code id="select.k.func_+3A_x">x</code></td>
<td>
<p>a n x p matrix of n observations and p predictors</p>
</td></tr>
<tr><td><code id="select.k.func_+3A_lam.y">Lam.y</code></td>
<td>
<p>a vector of n power-transformed responses</p>
</td></tr>
<tr><td><code id="select.k.func_+3A_lam">lam</code></td>
<td>
<p>the power-transformation parameter</p>
</td></tr>
<tr><td><code id="select.k.func_+3A_a">a</code></td>
<td>
<p>location shift parameter in the power transformation (introduced to avoid negative y values)</p>
</td></tr>
<tr><td><code id="select.k.func_+3A_max.tau">max.tau</code></td>
<td>
<p>the upper bound of the intermediate quantile levels</p>
</td></tr>
<tr><td><code id="select.k.func_+3A_grid.k">grid.k</code></td>
<td>
<p>the grid for the number of upper order statistics involved in Hill estimator</p>
</td></tr>
<tr><td><code id="select.k.func_+3A_n">n</code></td>
<td>
<p>the number of observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the selected k is returned
</p>


<h3>References</h3>

<p>Wang, H. and Li, D. (2013). Estimation of conditional high quantiles through power transformation. Journal of the American Statistical Association, 108, 1062-1074.
</p>

<hr>
<h2 id='testC.EVI'>Testing the Constancy of EVI Over Covariates</h2><span id='topic+testC.EVI'></span>

<h3>Description</h3>

<p>This function tests whether the extreme value index of Y, gamma(x), is constant or varying across the covariate x by using the test procedure
described in Section 3.4 of Wang and Li (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testC.EVI(y, x, grid.lam = seq(-2, 2, 0.1), grid.k, tau.lam = 0.9,
  u.x = 0, a = 0, M = 2, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testC.EVI_+3A_y">y</code></td>
<td>
<p>a vector of n untransformed responses</p>
</td></tr>
<tr><td><code id="testC.EVI_+3A_x">x</code></td>
<td>
<p>a n x p matrix of n observations and p predictors</p>
</td></tr>
<tr><td><code id="testC.EVI_+3A_grid.lam">grid.lam</code></td>
<td>
<p>a grid of points for power-transformation parameter</p>
</td></tr>
<tr><td><code id="testC.EVI_+3A_grid.k">grid.k</code></td>
<td>
<p>a grid of points for k, the number of upper order statistics involved in Hill estimator</p>
</td></tr>
<tr><td><code id="testC.EVI_+3A_tau.lam">tau.lam</code></td>
<td>
<p>the quantile level used for estimating the transformation parameter</p>
</td></tr>
<tr><td><code id="testC.EVI_+3A_u.x">u.x</code></td>
<td>
<p>the proportion to be trimmed in the x direction</p>
</td></tr>
<tr><td><code id="testC.EVI_+3A_a">a</code></td>
<td>
<p>location shift parameter in the power transformation (introduced to avoid negative y values)</p>
</td></tr>
<tr><td><code id="testC.EVI_+3A_m">M</code></td>
<td>
<p>a constant larger than one that is used for estimating the c vector and thus K(x) function. The default is two</p>
</td></tr>
<tr><td><code id="testC.EVI_+3A_tol">tol</code></td>
<td>
<p>the tolerance level for checking quantile crossing issue</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following components
</p>
<p>lam: the estimated power-transformation parameter
</p>
<p>k: the selected tuning parameter k, the number of upper order statistics involved in Hill estimator
</p>
<p>Tm: the proposed test statistic
</p>
<p>scaledTm: the standardized test statistic
</p>
<p>pval.iid: the p-value based on iid assumption, that is, assuming that K(x)=1
</p>
<p>pval.nid: the p-value based on estimated K(x)=(X'C)^(1/EVI)
</p>
<p>gamma.bar: the pooled EVI estimator
</p>
<p>hat.gamma: a N-dimensional vector consisting of the estimated x-dependent EVI at x=xstar
</p>
<p>xstar: a N x p matrix of N observations and p predictors
</p>


<h3>References</h3>

<p>Wang, H. and Li, D. (2013). Estimation of conditional high quantiles through power transformation. Journal of the American Statistical Association, 108, 1062-1074.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EXRQ)
n=500
tau.e = c(0.99, 0.993, 0.995)
set.seed(12368819)
x1 = runif(n, -1, 1)
x2 = runif(n, -1, 1)
sqrty = 2 + x1 + x2 + (1+0.8*x1)*rpareto(n, 0.5)
x = as.matrix(cbind(x1, x2))
y = sqrty^2
out = testC.EVI(y, x, grid.lam=seq(-0.5, 1.5, 0.1), grid.k=50, tau.lam=0.9)
(Tval = out$scaledTm)
(pval.iid = out$pval.iid)
(pval.nid = out$pval.nid)
</code></pre>

<hr>
<h2 id='ThreeStage'>Three-Stage Extreme Conditional Quantile Estimator</h2><span id='topic+ThreeStage'></span>

<h3>Description</h3>

<p>Provides the estimation of extreme conditional quantile using the three-stage estimation method in Wang and Li (2013). Specifically the function estimates
the tau.e-th conditional quantile of Y given x=xstar based on the power-transformed quantile regression model and extreme value theory. The method is based
on Hill estimator for the extreme value index and works for heavy-tailed distributions (on the original scale).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ThreeStage(y, x, xstar, tau.e, grid.lam = seq(-2, 2, 0.1), grid.k, tau.lam,
  a = 0, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ThreeStage_+3A_y">y</code></td>
<td>
<p>a vector of n responses</p>
</td></tr>
<tr><td><code id="ThreeStage_+3A_x">x</code></td>
<td>
<p>a n x p matrix of n observations and p predictors</p>
</td></tr>
<tr><td><code id="ThreeStage_+3A_xstar">xstar</code></td>
<td>
<p>a m x p matrix of m observations and p predictors</p>
</td></tr>
<tr><td><code id="ThreeStage_+3A_tau.e">tau.e</code></td>
<td>
<p>the extreme quantile level of interest</p>
</td></tr>
<tr><td><code id="ThreeStage_+3A_grid.lam">grid.lam</code></td>
<td>
<p>the set of lambda (transformation parameter) values for grid search</p>
</td></tr>
<tr><td><code id="ThreeStage_+3A_grid.k">grid.k</code></td>
<td>
<p>the grid for the number of upper order statistics involved in Hill estimator;
used for searching for the data-adaptive k. If the lenfth of grid.k is 1, then k is fixed at grid.k and no selection is performed.</p>
</td></tr>
<tr><td><code id="ThreeStage_+3A_tau.lam">tau.lam</code></td>
<td>
<p>the quantile level used for estimating the transformation parameter</p>
</td></tr>
<tr><td><code id="ThreeStage_+3A_a">a</code></td>
<td>
<p>location shift parameter in the power transformation (introduced to avoid negative y values)</p>
</td></tr>
<tr><td><code id="ThreeStage_+3A_tol">tol</code></td>
<td>
<p>the tolerance level for checking quantile crossing issue</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following components
</p>
<p>lam: the estimated power-transformation parameter
</p>
<p>k: the selected k, the number of upper order statistics involved in Hill estimator
</p>
<p>gamma.x: the estimated x-dependent extreme value index (EVI)
</p>
<p>cgmma: the pooled EVI estimation
</p>
<p>Q3Stage: the three-stage estimator of the tau.e-th conditional quantile of Y given xstar based on the x-dependent EVI estimation
</p>
<p>Q3StageP: the three-stage estimator of the tau.e-th conditional quantile of Y given xstar based on the pooled EVI estimation
</p>


<h3>References</h3>

<p>Wang, H. and Li, D. (2013). Estimation of conditional high quantiles through power transformation. Journal of the American Statistical Association, 108, 1062-1074.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TwoStage">TwoStage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#A simulation example (sqrt transformation, heteroscedastic error)
library(EXRQ)
n=500
tau.e = c(0.99, 0.993, 0.995)
set.seed(12368819)
x1 = runif(n, -1, 1)
x2 = runif(n, -1, 1)
sqrty = 2 + x1 + x2 + (1+0.8*x1)*rpareto(n, 0.5)
x = as.matrix(cbind(x1, x2))
y = sqrty^2
xstar = rbind(c(-0.5,0),c(0,-0.5),c(0,0),c(0.5,0),c(0,0.5))
## 3Stage estimator
out.3stage &lt;- ThreeStage(y, x, xstar, tau.e, grid.lam=seq(-0.5, 1.5, 0.1), grid.k=50, tau.lam=0.9)
</code></pre>

<hr>
<h2 id='TwoStage'>Two-Stage Extreme Conditional Quantile Estimator</h2><span id='topic+TwoStage'></span>

<h3>Description</h3>

<p>This function provides the Two-Stage estimator in Wang, Li and He (2012) for conditional extreme quantiles based
on covariate-dependent extreme value index estimation. The intermediate conditional quantile is
estimated by quantile regression of the response on the original scale without any transformation.
The method is based on Hill estimator for the extreme value index and works for heavy-tailed distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TwoStage(y, x, xstar, tau.e, k, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TwoStage_+3A_y">y</code></td>
<td>
<p>a vector of length n representing the response</p>
</td></tr>
<tr><td><code id="TwoStage_+3A_x">x</code></td>
<td>
<p>a n x p matrix of n observations and p predictors</p>
</td></tr>
<tr><td><code id="TwoStage_+3A_xstar">xstar</code></td>
<td>
<p>a m x p matrix of m observations and p predictors representing
the covariate of interest</p>
</td></tr>
<tr><td><code id="TwoStage_+3A_tau.e">tau.e</code></td>
<td>
<p>the extreme quantile level of interest</p>
</td></tr>
<tr><td><code id="TwoStage_+3A_k">k</code></td>
<td>
<p>the number of upper order statistics used in Hill estimator</p>
</td></tr>
<tr><td><code id="TwoStage_+3A_tol">tol</code></td>
<td>
<p>the tolerance level used for checking quantile crossing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following commponents is returned
</p>
<p>Q2Stage: the estimated (extrapolated) conditional extreme quantile of the response given x=xstar at the quantile level tau.e
</p>
<p>gamma.x: the estimated covariate-dependent extreme value index (Hill estimator associated with x=xstar)
</p>


<h3>References</h3>

<p>Wang, H., Li, D., and He, X. (2012). Estimation of high conditional quantiles for heavytailed
distributions, Journal of the American Statistical Association, 107, 1453-1464.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ThreeStage">ThreeStage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#A simulation example (sqrt transformation, heteroscedastic error)
library(EXRQ)
n=500
tau.e = c(0.99, 0.993, 0.995)
set.seed(12368819)
x1 = runif(n, -1, 1)
x2 = runif(n, -1, 1)
sqrty = 2 + x1 + x2 + (1+0.8*x1)*rpareto(n, 0.5)
x = as.matrix(cbind(x1, x2))
y = sqrty^2
xstar = rbind(c(-0.5,0),c(0,-0.5),c(0,0),c(0.5,0),c(0,0.5))
## 2Stage method in Wang, Li and He (2012), no transformation
out.2stage &lt;- TwoStage(y, x, xstar, tau.e, k=50)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
