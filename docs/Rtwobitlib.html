<!DOCTYPE html><html lang="en"><head><title>Help for package Rtwobitlib</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rtwobitlib}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pkgconfig'><p>Compiler configuration arguments for use of Rtwobitlib</p></a></li>
<li><a href='#twobit_roundtrip'><p>Read/write a .2bit file</p></a></li>
<li><a href='#twobit_seqstats'><p>Extract sequence lengths and letter counts from a .2bit file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>'2bit' 'C' Library</td>
</tr>
<tr>
<td>Description:</td>
<td>A trimmed down copy of the "kent-core source tree"
	turned into a 'C' library for manipulation of '.2bit' files.
	See <a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format7">https://genome.ucsc.edu/FAQ/FAQformat.html#format7</a>
	for a quick overview of the '2bit' format. The "kent-core source tree"
	can be found here: <a href="https://github.com/ucscGenomeBrowser/kent-core/">https://github.com/ucscGenomeBrowser/kent-core/</a>.
	Only the '.c' and '.h' files from the source tree that are related
	to manipulation of '.2bit' files were kept. Note that the package
	is primarily useful to developers of other R packages who wish
	to use the '2bit' 'C' library in their own 'C'/'C++' code.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hpages/Rtwobitlib">https://github.com/hpages/Rtwobitlib</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hpages/Rtwobitlib/issues">https://github.com/hpages/Rtwobitlib/issues</a></td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.9</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>tools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-18 18:47:21 UTC; hpages</td>
</tr>
<tr>
<td>Author:</td>
<td>Hervé Pagès [aut, cre],
  UC Regents [cph] (all the '.c' and '.h' files in src/kent/)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hervé Pagès &lt;hpages.on.github@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-20 01:00:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='pkgconfig'>Compiler configuration arguments for use of Rtwobitlib</h2><span id='topic+pkgconfig'></span>

<h3>Description</h3>

<p>The <code>pkgconfig</code> function prints values for <code>PKG_LIBS</code>
and <code>PKG_CPPFLAGS</code> variables for use in <code>Makevars</code> files.
It is not meant for the end user.
See <code>vignette("Rtwobitlib")</code> for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkgconfig(opt=c("PKG_LIBS", "PKG_CPPFLAGS"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pkgconfig_+3A_opt">opt</code></td>
<td>

<p>Either <code>"PKG_LIBS"</code> or <code>"PKG_CPPFLAGS"</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function prints the <code>PKG_LIBS</code> or <code>PKG_CPPFLAGS</code> value
and returns an invisible <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pkgconfig("PKG_LIBS")

pkgconfig("PKG_CPPFLAGS")
</code></pre>

<hr>
<h2 id='twobit_roundtrip'>Read/write a .2bit file</h2><span id='topic+twobit_read'></span><span id='topic+twobit_write'></span>

<h3>Description</h3>

<p>Read/write a character vector representing DNA sequences from/to
a file in <em>2bit</em> format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twobit_read(filepath)

twobit_write(x, filepath, use.long=FALSE, skip.dups=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twobit_roundtrip_+3A_filepath">filepath</code></td>
<td>

<p>A single string (character vector of length 1) containing a path
to the file to read or write.
</p>
</td></tr>
<tr><td><code id="twobit_roundtrip_+3A_x">x</code></td>
<td>

<p>A named character vector representing DNA sequences. The names on
the vector should be unique and the sequences should only contain
A's, C's, G's, T's, or N's, in uppercase or lowercase.
</p>
</td></tr>
<tr><td><code id="twobit_roundtrip_+3A_use.long">use.long</code></td>
<td>

<p>By default the <em>2bit</em> format cannot store more than 4Gb of sequence
data in total. Set <code>use.long</code> to <code>TRUE</code> if your sequence data
is bigger than that.
</p>
</td></tr>
<tr><td><code id="twobit_roundtrip_+3A_skip.dups">skip.dups</code></td>
<td>

<p>By default duplicate sequence names are an error. By setting
<code>skip.dups</code> to <code>FALSE</code>, sequences with a duplicated name will
be skipped with a warning.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>twobit_read()</code>: A named character vector containing the DNA
sequences loaded from the file.
</p>
<p>For <code>twobit_write()</code>: <code>filepath</code> returned invisibly.
</p>


<h3>References</h3>

<p>A quick overview of the <em>2bit</em> format:
<a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format7">https://genome.ucsc.edu/FAQ/FAQformat.html#format7</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+twobit_seqstats">twobit_seqstats</a></code> and <code><a href="#topic+twobit_seqlengths">twobit_seqlengths</a></code> to
extract the sequence lengths and letter counts from a <code>.2bit</code> file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Read:
inpath &lt;- system.file(package="Rtwobitlib", "extdata", "sacCer2.2bit")
dna &lt;- twobit_read(inpath)
names(dna)
nchar(dna)

## Write:
outpath &lt;- twobit_write(dna, tempfile())

## Sanity checks:
library(tools)
stopifnot(md5sum(inpath) == md5sum(outpath))
stopifnot(identical(nchar(dna), twobit_seqlengths(inpath)))
</code></pre>

<hr>
<h2 id='twobit_seqstats'>Extract sequence lengths and letter counts from a .2bit file</h2><span id='topic+twobit_seqstats'></span><span id='topic+twobit_seqlengths'></span>

<h3>Description</h3>

<p>Extract the lengths and letter counts of the DNA sequences stored
in a <code>.2bit</code> file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twobit_seqstats(filepath)

twobit_seqlengths(filepath)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twobit_seqstats_+3A_filepath">filepath</code></td>
<td>

<p>A single string (character vector of length 1) containing a path
to a <code>.2bit</code> file.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>twobit_seqlengths(filepath)</code> is a shortcut for
<code>twobit_seqstats(filepath)[ , "seqlengths"]</code> that is also a
much more efficient way to get the sequence lengths as it does not
need to load the sequence data in memory.
</p>


<h3>Value</h3>

<p>For <code>twobit_seqstats()</code>: An integer matrix with one row per sequence
in the <code>.2bit</code> file and 6 columns. The rownames on the matrix are the
sequence names and the colnames are: <code>seqlengths</code>, <code>A</code>, <code>C</code>,
<code>G</code>, <code>T</code>, <code>N</code>. Columns <code>A</code>, <code>C</code>, <code>G</code>, <code>T</code>,
and <code>N</code> contain the letter count for each sequence.
</p>
<p>For <code>twobit_seqlengths()</code>: A named integer vector where the names
are the sequence names and the values the corresponding lengths.
</p>


<h3>References</h3>

<p>A quick overview of the <em>2bit</em> format:
<a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format7">https://genome.ucsc.edu/FAQ/FAQformat.html#format7</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+twobit_read">twobit_read</a></code> and <code><a href="#topic+twobit_write">twobit_write</a></code> to read/write a
character vector representing DNA sequences from/to a file in <em>2bit</em>
format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>filepath &lt;- system.file(package="Rtwobitlib", "extdata", "sacCer2.2bit")

twobit_seqstats(filepath)

twobit_seqlengths(filepath)

## Sanity checks:
sacCer2_seqstats &lt;- twobit_seqstats(filepath)
stopifnot(
  identical(sacCer2_seqstats[ , 1], twobit_seqlengths(filepath)),
  all.equal(rowSums(sacCer2_seqstats[ , -1]), sacCer2_seqstats[ , 1])
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
