<!DOCTYPE html><html lang="en"><head><title>Help for package pacotest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pacotest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pacotest-package'>
<p>Testing for Partial Copulas and the Simplifying Assumption in Vine Copulas</p></a></li>
<li><a href='#pacotest'><p>Testing for the Partial Copula and the Simplifying Assumption for a Single Bivariate Conditional Copula</p></a></li>
<li><a href='#pacotestRvineSeq'>
<p>Sequentially Testing the Simplifying Assumption for R-Vine Copulas</p></a></li>
<li><a href='#pacotestRvineSingleCopula'>
<p>Testing for a Single (j-1)-th Order Partial Copula in a R-Vine Copula</p></a></li>
<li><a href='#pacotestset'><p>Create and Alter a Pacotest Options List</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Testing for Partial Copulas and the Simplifying Assumption in
Vine Copulas</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Malte S. Kurz &lt;mkurz-software@gmx.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines for two different test types, the Constant Conditional Correlation (CCC) test and the Vectorial Independence (VI) test are provided (Kurz and Spanhel (2022) &lt;<a href="https://doi.org/10.1214%2F22-EJS2051">doi:10.1214/22-EJS2051</a>&gt;). The tests can be applied to check whether a conditional copula coincides with its partial copula. Functions to test whether a regular vine copula satisfies the so-called simplifying assumption or to test a single copula within a regular vine copula to be a (j-1)-th order partial copula are available. The CCC test comes with a decision tree approach to allow testing in high-dimensional settings.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.4), VineCopula (&ge; 2.0.5), numDeriv, ggplot2(&ge;
2.0.0), gridExtra, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, covr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MalteKurz/pacotest/issues">https://github.com/MalteKurz/pacotest/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-04 12:22:30 UTC; runner</td>
</tr>
<tr>
<td>Author:</td>
<td>Malte S. Kurz [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-04 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pacotest-package'>
Testing for Partial Copulas and the Simplifying Assumption in Vine Copulas
</h2><span id='topic+pacotest-package'></span>

<h3>Description</h3>

<p>The <span class="pkg">pacotest</span> package provides functions, which allow to test for partial copulas and the simplifying assumption in vine copulas.
The package consists of two different test types, the Constant Conditional Correlation (CCC) test and the Vectorial Independence (VI) test.
The function <code><a href="#topic+pacotestset">pacotestset</a></code> can be used to create and alter pacotest options lists and the function <code><a href="#topic+pacotest">pacotest</a></code> can be used to test for the partial copula and the simplifying assumption for a single bivariate conditional copula.
</p>
<p>The function <code><a href="#topic+pacotestRvineSeq">pacotestRvineSeq</a></code> can be used with a <a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a> from the <a href="VineCopula.html#topic+VineCopula-package">VineCopula-package</a> to test all pair-copulas being building blocks in a R-vine copula to be (j-1)-th order partial copulas, which is equivalent to testing the simplifying assumption.
A single building blog of a R-vine copula could be tested to be a (j-1)-th order partial copula by applying the function <code><a href="#topic+pacotestRvineSingleCopula">pacotestRvineSingleCopula</a></code> to a <a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a> from the <a href="VineCopula.html#topic+VineCopula-package">VineCopula-package</a>.
</p>


<h3>Author(s)</h3>

<p>Malte S. Kurz
</p>


<h3>References</h3>

<p>Hobaek-Haff, I., K. Aas and A. Frigessi (2010), &quot;On the simplified pair-copula construction &ndash; Simply useful or too simplistic?&quot;, Journal of Multivariate Analysis 101(5), pp. 1296-1310.
</p>
<p>Kojadinovic, I. and M. Holmes (2009), &quot;Tests of independence among continuous random vectors based on Cramer-von Mises functionals of the empirical copula process&quot;, Journal of Multivariate Analysis 100(6), pp. 1137-1154.
</p>
<p>Kurz, M. S. and F. Spanhel (2022), &quot;Testing the simplifying assumption in high-dimensional vine copulas&quot;, Electronic Journal of Statistics 16 (2), pp. 5226-5276.
</p>
<p>Quessy, J.-F. (2010), &quot;Applications and asymptotic power of marginal-free tests of stochastic vectorial independence&quot;, Journal of Statistical Planning and Inference 140(11), pp. 3058-3075.
</p>
<p>Spanhel, F. and M. S. Kurz (2019), &quot;Simplified vine copula models: Approximations based on the simplifying assumption&quot;, Electronic Journal of Statistics 13 (1), pp. 1254-1291.
</p>
<p>Spanhel, F. and M. S. Kurz (2016), &quot;The partial copula: Properties and associated dependence measures&quot;, Statistics &amp; Probability Letters 119, pp. 76-83.
</p>


<h3>See Also</h3>

<p>Development for <span class="pkg">pacotest</span> can be followed via the GitHub repository at <a href="https://github.com/MalteKurz/pacotest">https://github.com/MalteKurz/pacotest</a>.
</p>

<hr>
<h2 id='pacotest'>Testing for the Partial Copula and the Simplifying Assumption for a Single Bivariate Conditional Copula</h2><span id='topic+pacotest'></span>

<h3>Description</h3>

<p>The function can be used to test for the partial copula and the simplifying assumption for a bivariate conditional copula using different tests. Two different test types, the Constant Conditional Correlation (CCC) test and the Vectorial Independence (VI) test are implemented. For all tests different options can be set by generating a pacotest options list using the <code><a href="#topic+pacotestset">pacotestset</a></code> function.</p>


<h3>Arguments</h3>

 
<table role = "presentation">
<tr><td><code id="pacotest_+3A_u">U</code></td>
<td>

<p>A (n x 2) matrix of [0,1] data (probability integral transforms), which are the arguments of the  conditional copula of (Y,Z)|W for which the simplifying assumption should be tested. The first column is given by the conditional distribution function of Y|W evaluated at the observed values of Y and W. Analogously, the second column is defined as the conditional distribution function of Z|W evaluated at the observed values of Z and W. If the probability integral transforms are obtained from the partial vine copula (PVC), i.e., partial probability integral transforms (PPITs) are used, the function can be used to test for (j-1)-th order partial copulas. 
</p>
</td></tr>
<tr><td><code id="pacotest_+3A_w">W</code></td>
<td>

<p>A (n x K) matrix of observed values for the vector of random variables on which the conditioning is done.
</p>
</td></tr>
<tr><td><code id="pacotest_+3A_pacotestoptions">pacotestOptions</code></td>
<td>

<p>A options list generated by the <code><a href="#topic+pacotestset">pacotestset</a></code> function or the test type as a string, i.e., <code>CCC</code> or <code>VI</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Applying a test with default options (cf. <code><a href="#topic+pacotestset">pacotestset</a></code>) and with known (i.e., not estimated) PITs (probability integral transforms) in <code>U</code>.
</p>
<pre>out = pacotest(U,W,'CCC')</pre>
<pre>out = pacotest(U,W,'VI')</pre>
<p>Applying a test with options specified in <code>pacotestOptions</code>
</p>
<pre>out = pacotest(U,W,pacotestOptions)</pre>
<p>Note that when calling <code>pacotest(U,W,'CCC')</code>, the default options for the CCC test are used (cf. <code><a href="#topic+pacotestset">pacotestset</a></code>), but the two parameters <code>withEstUncert = FALSE</code> and <code>estUncertWithRanks = FALSE</code> are altered. In contrast when calling <code>pacotestOptions = pacotestset('CCC')</code>, the two parameters are set to <code>withEstUncert = TRUE</code> and <code>estUncertWithRanks = TRUE</code>. For the CCC test, under the default setting, it is assumed that estimated PPITs are provided and the test statistic is computed under consideration of estimation uncertainty of the probability integral transforms, i.e., <code>withEstUncert = TRUE</code> and <code>estUncertWithRanks = TRUE</code>. To apply <code>pacotest</code> with <code>withEstUncert = TRUE</code>, three additional inputs have to be provided (<code>data</code>, <code>svcmDataFrame</code> and <code>cPitData</code>).
</p>
<p>In the vine copula context, PPITs are usually estimated and not known. Therefore, in the vine copula context it is recommended to use the functions <code><a href="#topic+pacotestRvineSeq">pacotestRvineSeq</a></code> or <code><a href="#topic+pacotestRvineSingleCopula">pacotestRvineSingleCopula</a></code> instead of <code><a href="#topic+pacotest">pacotest</a></code>. These functions automatically pass through the additional arguments <code>data</code>, <code>svcmDataFrame</code>, <code>cPitData</code> to the function <code><a href="#topic+pacotest">pacotest</a></code> and the CCC test can be applied in its default setting with consideration of estimation uncertainty of the probability integral transforms, i.e., <code>withEstUncert = TRUE</code> and <code>estUncertWithRanks = TRUE</code>.
</p>


<h3>Value</h3>

<p>A list which can, depending on the chosen test, consist of the following elements:
</p>
<table role = "presentation">
<tr><td><code>pValue</code></td>
<td>

<p>The p-value of the test.
</p>
</td></tr>
<tr><td><code>testStat</code></td>
<td>

<p>The value of the test statistic.
</p>
</td></tr>
<tr><td><code>decisionTree</code></td>
<td>

<p>The decision tree used to partition the support Lambda0 of the conditioning variable W. It is provided as a list consisting of three nodes (<code>CentralNode</code>, <code>LeftNode</code> and <code>RightNode</code>) represented as lists and the variable <code>LeavesForFinalComparison</code>. Each node consists of the <code>Variable</code> used to perform the split, the corresponding <code>Quantile</code> and <code>Threshold</code>.
</p>
</td></tr>
<tr><td><code>S</code></td>
<td>

<p>The bootstrapped values of the test statistic (only for the test type <code>VI</code>).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Malte S. Kurz
</p>


<h3>References</h3>

<p>Kurz, M. S. and F. Spanhel (2022), &quot;Testing the simplifying assumption in high-dimensional vine copulas&quot;, Electronic Journal of Statistics 16 (2), pp. 5226-5276.
</p>
<p>Spanhel, F. and M. S. Kurz (2019), &quot;Simplified vine copula models: Approximations based on the simplifying assumption&quot;, Electronic Journal of Statistics 13 (1), pp. 1254-1291.
</p>
<p>Spanhel, F. and M. S. Kurz (2016), &quot;The partial copula: Properties and associated dependence measures&quot;, Statistics &amp; Probability Letters 119, pp. 76-83.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pacotest-package">pacotest-package</a></code>, <code><a href="#topic+pacotestset">pacotestset</a></code>, <code><a href="#topic+pacotestRvineSeq">pacotestRvineSeq</a></code>, <code><a href="#topic+pacotestRvineSingleCopula">pacotestRvineSingleCopula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#####################
# Generate an options list, e.g., the constant conditional correlation (CCC)
# test with default options. We use known PITs and don't estimate the parameters
# in the lower trees of the vine copulas and therefore additionally alter the
# two parameters withEstUncert and estUncertWithRanks to FALSE.
pacotestOptions=pacotestset(testType='CCC', withEstUncert = FALSE, estUncertWithRanks = FALSE)

#####################
# Use the specified options to test for the simplifying assumption

##### Example 1: Non-simplified three-dim. C-Vine #####
# Simulate from a three-dimensional C-Vine copula with C_12 and C_13
# being product copulas and C_23|1 being a Frank copula with
# functional parameter theta(x_{1}) = (4x_{1}-2)^3
N = 500
X = matrix(runif(3*N),N,3)
theta = (4*X[,1]-2)^3

etheta = expm1(-theta);
X[,3] = -1/theta*log(1+etheta/(exp(-theta*X[,2])*(1/X[,3]-1)+1));

Result = pacotest(X[,c(2,3)],X[,1],pacotestOptions)
Result$pValue

##### Example 2: Non-simplified three-dim. C-Vine #####
# Simulate from a three-dimensional C-Vine copula with C_12 and C_13
# being product copulas and C_23|1 being a Frank copula with
# functional parameter theta(x_{1}) = 12 + 8*sin(0.4(3x_{1}+2)^2)
X = matrix(runif(3*N),N,3)
theta = 12 + 8*sin(0.4*(3*X[,1]+2)^2)

etheta = expm1(-theta);
X[,3] = -1/theta*log(1+etheta/(exp(-theta*X[,2])*(1/X[,3]-1)+1));

Result = pacotest(X[,c(2,3)],X[,1],pacotestOptions)
Result$pValue

##### Example 3: Simplified three-dim. C-Vine #####
# Simulate from a three-dimensional C-Vine copula with C_12 and C_13
# being Clayton copulas with parameter theta and C_23|1 being a Clayton copula with
# functional parameter theta(x_{1}) = theta / (1+theta)
W = matrix(runif(3*N),N,3)
X = matrix(NA,N,3)
theta = 2

X[,1] = W[,1]
X[,2] = (W[,1]^(-theta)*(W[,2]^((-theta)/(1+theta))-1)+1)^(-1/theta);
theta_23_1 = theta /(1+theta)
X[,3] = (W[,2]^(-theta_23_1)*(W[,3]^((-theta_23_1)/(1+theta_23_1))-1)+1)^(-1/theta_23_1);
X[,3] = (W[,1]^(-theta)*(X[,3]^((-theta)/(1+theta))-1)+1)^(-1/theta);

# Get pseudo-observations from the conditional copula C_23|1
U = matrix(NA,N,2)
U[,1] = (X[,1]^theta*(X[,2]^(-theta)-1)+1)^(-(1+theta)/theta);
U[,2] = (X[,1]^theta*(X[,3]^(-theta)-1)+1)^(-(1+theta)/theta);
Result = pacotest(U,X[,1],pacotestOptions)
Result$pValue
</code></pre>

<hr>
<h2 id='pacotestRvineSeq'>
Sequentially Testing the Simplifying Assumption for R-Vine Copulas
</h2><span id='topic+pacotestRvineSeq'></span>

<h3>Description</h3>

<p>The function can be used to test the simplifying assumption for R-vine copulas in a sequential manner. Each pair-copula from the second tree on is tested to be a (j-1)-th order partial copula. To apply the function one needs to provide the data and a specified/estimated R-vine copula model in form of a <a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a> from the <a href="VineCopula.html#topic+VineCopula-package">VineCopula-package</a>. Additionally, a pacotest options list, which can be generated with the <code><a href="#topic+pacotestset">pacotestset</a></code> function, needs to be provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pacotestRvineSeq(data, RVM, pacotestOptions,
  level = 0.05, illustration = 2, stopIfRejected = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pacotestRvineSeq_+3A_data">data</code></td>
<td>

<p>A (n x d) matrix (or data frame) of [0,1] data (i.e. uniform margins).
</p>
</td></tr>
<tr><td><code id="pacotestRvineSeq_+3A_rvm">RVM</code></td>
<td>

<p>An <a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a> object (<a href="VineCopula.html#topic+VineCopula-package">VineCopula-package</a>) which includes the structure, the pair-copula families and parameters of an R-vine copula.
</p>
</td></tr>
<tr><td><code id="pacotestRvineSeq_+3A_pacotestoptions">pacotestOptions</code></td>
<td>

<p>A options list generated by the <code><a href="#topic+pacotestset">pacotestset</a></code> function or the test type as string, i.e., <code>CCC</code> or <code>VI</code>.
</p>
</td></tr>
<tr><td><code id="pacotestRvineSeq_+3A_level">level</code></td>
<td>

<p>The level of the test.
</p>
</td></tr>
<tr><td><code id="pacotestRvineSeq_+3A_illustration">illustration</code></td>
<td>

<p>Either 1 or 2. If illustration = 1, the p-value for each test for a (j-1)-th order partial copula is displayed. If illustration = 2, a progress information is displayed for each tree. It consists of the individual test level and the number of H0 rejections.
</p>
</td></tr>
<tr><td><code id="pacotestRvineSeq_+3A_stopifrejected">stopIfRejected</code></td>
<td>

<p>A logical variable indicating whether the sequential test procedure should be stopped in the first tree where an H0 for one of the conditional copulas is rejected.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list consisting of the following elements:
</p>
<table role = "presentation">
<tr><td><code>pacotestResultLists</code></td>
<td>

<p>A matrix in the same structure like the <code>Matrix</code>, <code>family</code>, <code>par</code>, etc. entries in the <a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a> object from the <a href="VineCopula.html#topic+VineCopula-package">VineCopula-package</a>. Each entry of the matrix is a list containing the test result from a test for a (j-1)-th order partial copula obtained from a call to <code><a href="#topic+pacotest">pacotest</a></code>. Depending on the chosen test, it could consist of different elements. A documentation of the <code>pacotestResultLists</code> can be found in the documentation of <code><a href="#topic+pacotest">pacotest</a></code>.
</p>
</td></tr>
<tr><td><code>pValues</code></td>
<td>

<p>A matrix in the same structure like the <code>Matrix</code>, <code>family</code>, <code>par</code>, etc. entries in the <a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a> object from the <a href="VineCopula.html#topic+VineCopula-package">VineCopula-package</a>. Each entry of the matrix is a p-value corresponding to the test result from a test for a (j-1)-th order partial copula.
</p>
</td></tr>
<tr><td><code>testResultSummary</code></td>
<td>

<p>A data.frame summarizing the test results.
The first column, <code>Tree</code>, is the tree number.
The second column, <code>NumbOfRejections</code>, is the number of of rejections in the corresponding tree.
The third column, <code>IndividualTestLevel</code>, is the level at which each individual test has been performed.
The fourth column, <code>Interpretation</code>, provides an interpretation of the test result.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Malte S. Kurz
</p>


<h3>References</h3>

<p>Kurz, M. S. and F. Spanhel (2022), &quot;Testing the simplifying assumption in high-dimensional vine copulas&quot;, Electronic Journal of Statistics 16 (2), pp. 5226-5276.
</p>
<p>Spanhel, F. and M. S. Kurz (2019), &quot;Simplified vine copula models: Approximations based on the simplifying assumption&quot;, Electronic Journal of Statistics 13 (1), pp. 1254-1291.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pacotest-package">pacotest-package</a></code>, <code><a href="#topic+pacotest">pacotest</a></code>, <code><a href="#topic+pacotestset">pacotestset</a></code>, <code><a href="#topic+pacotestRvineSingleCopula">pacotestRvineSingleCopula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample data and R-vine copula selection are taken
# from the documentation of RVineStructureSelect
# of the VineCopula package.

# Obtain sample data
data(daxreturns, package ="VineCopula")
dataSet = daxreturns[1:750,1:4]

# Specify an R-vine copula model
# (can be obtained by calling: RVM = VineCopula::RVineStructureSelect(dataSet))
vineStructure = matrix(c(3,4,1,2,0,2,4,1,0,0,1,4,0,0,0,4),4,4)
families = matrix(c(0,5,2,2,0,0,2,14,0,0,0,14,0,0,0,0),4,4)
par = matrix(c(0,0.8230664,0.1933472,0.6275062,
             0,0,0.2350109,1.6619945,
             0,0,0,1.599363,
             0,0,0,0),4,4)
par2 = matrix(c(0,0,11.757700,4.547847,
             0,0,17.15717,0,
             0,0,0,0,0,0,0,0),4,4)
RVM = VineCopula::RVineMatrix(vineStructure, families, par, par2)


# Specify a pacotestOptions list:
pacotestOptions = pacotestset('CCC')

# Test for the simplifying assumption.
pacotestResultList = pacotestRvineSeq(dataSet, RVM,
                                      pacotestOptions)
</code></pre>

<hr>
<h2 id='pacotestRvineSingleCopula'>
Testing for a Single (j-1)-th Order Partial Copula in a R-Vine Copula
</h2><span id='topic+pacotestRvineSingleCopula'></span>

<h3>Description</h3>

<p>The function can be used to test a single copula in a R-vine copula to be a (j-1)-th order partial copula.
To apply the function one needs to provide the data and a specified/estimated R-vine copula model in form of a <a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a> from the <a href="VineCopula.html#topic+VineCopula-package">VineCopula-package</a>.
Additionally, a pacotest options list, which can be generated with the <code><a href="#topic+pacotestset">pacotestset</a></code> function, needs to be provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pacotestRvineSingleCopula(data, RVM, pacotestOptions, tree, copulaNumber)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pacotestRvineSingleCopula_+3A_data">data</code></td>
<td>

<p>A (n x d) matrix (or data frame) of [0,1] data (i.e. uniform margins).
</p>
</td></tr>
<tr><td><code id="pacotestRvineSingleCopula_+3A_rvm">RVM</code></td>
<td>

<p>An <a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a> object (<a href="VineCopula.html#topic+VineCopula-package">VineCopula-package</a>) which includes the structure, the pair-copula families and parameters of an R-vine copula.
</p>
</td></tr>
<tr><td><code id="pacotestRvineSingleCopula_+3A_pacotestoptions">pacotestOptions</code></td>
<td>

<p>A options list generated by the <code><a href="#topic+pacotestset">pacotestset</a></code> function or the test type as string, i.e., <code>CCC</code> or <code>VI</code>.
</p>
</td></tr>
<tr><td><code id="pacotestRvineSingleCopula_+3A_tree">tree</code></td>
<td>

<p>The tree number (j&gt;=2) of the copula which should be tested to be a (j-1)-th order partial copula.
</p>
</td></tr>
<tr><td><code id="pacotestRvineSingleCopula_+3A_copulanumber">copulaNumber</code></td>
<td>

<p>The number (1&lt;= copulaNumber &lt;= j-1) of the copula in the normalized <a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a> which should be tested to be a (j-1)-th order partial copula.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which can, depending on the chosen test, consist of the following elements:
</p>
<table role = "presentation">
<tr><td><code>pValue</code></td>
<td>

<p>The p-value of the test.
</p>
</td></tr>
<tr><td><code>testStat</code></td>
<td>

<p>The value of the test statistic.
</p>
</td></tr>
<tr><td><code>decisionTree</code></td>
<td>

<p>The decision tree used to partition the support Lmabda0 of the conditioning variable W. It is provided as a list consisting of three nodes (<code>CentralNode</code>, <code>LeftNode</code> and <code>RightNode</code>) represented as lists and the variable <code>LeavesForFinalComparison</code>. Each node consists of the <code>Variable</code> used to perform the split, the corresponding <code>Quantile</code> and <code>Threshold</code>.
</p>
</td></tr>
<tr><td><code>S</code></td>
<td>

<p>The bootstrapped values of the test statistic (only for the test type <code>VI</code>).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Malte S. Kurz
</p>


<h3>References</h3>

<p>Kurz, M. S. and F. Spanhel (2022), &quot;Testing the simplifying assumption in high-dimensional vine copulas&quot;, Electronic Journal of Statistics 16 (2), pp. 5226-5276.
</p>
<p>Spanhel, F. and M. S. Kurz (2019), &quot;Simplified vine copula models: Approximations based on the simplifying assumption&quot;, Electronic Journal of Statistics 13 (1), pp. 1254-1291.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pacotest-package">pacotest-package</a></code>, <code><a href="#topic+pacotest">pacotest</a></code>, <code><a href="#topic+pacotestset">pacotestset</a></code>, <code><a href="#topic+pacotestRvineSeq">pacotestRvineSeq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample data and R-vine copula selection are taken
# from the documentation of RVineStructureSelect
# of the VineCopula package.

# Obtain sample data
data(daxreturns, package ="VineCopula")
dataSet = daxreturns[1:750,1:4]

# Specify an R-vine copula model
# (can be obtained by calling: RVM = VineCopula::RVineStructureSelect(dataSet))
vineStructure = matrix(c(3,4,1,2,0,2,4,1,0,0,1,4,0,0,0,4),4,4)
families = matrix(c(0,5,2,2,0,0,2,14,0,0,0,14,0,0,0,0),4,4)
par = matrix(c(0,0.8230664,0.1933472,0.6275062,
             0,0,0.2350109,1.6619945,
             0,0,0,1.599363,
             0,0,0,0),4,4)
par2 = matrix(c(0,0,11.757700,4.547847,
             0,0,17.15717,0,
             0,0,0,0,0,0,0,0),4,4)
RVM = VineCopula::RVineMatrix(vineStructure, families, par, par2)

# Specify a pacotestOptions list:
# For illustrating the functioning of the decision tree,
# grouped scatterplots and a decision tree plot are activated.
pacotestOptions = pacotestset(testType='CCC',
                               groupedScatterplots = TRUE,
                               decisionTreePlot = TRUE)

# Test for a 2-nd order partial copula
# corresponding to the variables BAYN.DE,BMW.DE
# and conditioning set ALV.DE,BAS.DE
tree = 3
copulaNumber = 1

pacotestResultList = pacotestRvineSingleCopula(dataSet, RVM,
                                                pacotestOptions, tree, copulaNumber)
</code></pre>

<hr>
<h2 id='pacotestset'>Create and Alter a Pacotest Options List</h2><span id='topic+pacotestset'></span>

<h3>Description</h3>

<p> The function creates or updates a list object, which is required for applying the <code><a href="#topic+pacotest">pacotest</a></code> function.</p>


<h3>Arguments</h3>

 
<table role = "presentation">
<tr><td><code id="pacotestset_+3A_pacotestoptions">pacotestOptions</code></td>
<td>

<p>A options list for the <code><a href="#topic+pacotest">pacotest</a></code> function generated by the <code><a href="#topic+pacotestset">pacotestset</a></code> function.
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_testtype">testType</code></td>
<td>

<p>A string which specifies the type of the test for testing the simplifying assumption.
</p>
<p>Possible values: <code>CCC</code> | <code>VI</code>
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_grouping">grouping</code></td>
<td>

<p>For <code>testType = CCC</code>:
</p>
<p>The grouping method which is used to obtain a partitioning of the support of the conditioning variable W.
</p>
<p>Possible values: <code>TreeCCC</code> | <code>SumMedian</code> | <code>SumThirdsI</code> | <code>SumThirdsII</code> | <code>SumThirdsIII</code> | <code>SumQuartiles</code> | <code>ProdMedian</code> | <code>ProdThirdsI</code> | <code>ProdThirdsII</code> | <code>ProdThirdsIII</code> | <code>ProdQuartiles</code> | <code>TreeEC</code>
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_expminsamplesize">expMinSampleSize</code></td>
<td>

<p>For <code>testType = CCC</code> with <code>grouping = TreeCCC | TreeEC</code>:
</p>
<p>The minimum number of observations which are allocated to a group in the decision tree learning process. The default value is <code>100</code>.
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_agginfo">aggInfo</code></td>
<td>

<p>For <code>testType = CCC</code> with <code>grouping = TreeCCC | TreeEC</code>:
</p>
<p>The method used for aggregating information in the conditioning set. The information in the conditioning set can be aggregated by either taking the mean of all variables or the pairwise mean. The result is added as an additional variable which can be used by the decision tree to partition the support of the conditioning variable W.
</p>
<p>Possible values: <code>none</code> | <code>meanAll</code> | <code>meanPairwise</code>
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_withestuncert">withEstUncert</code></td>
<td>

<p>For <code>testType = CCC</code>:
</p>
<p>A logical variable indicating whether the asymptotic-variance covariance matrix of the estimated correlations should be corrected for the estimation uncertainty of the probability integral transforms.
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_estuncertwithranks">estUncertWithRanks</code></td>
<td>

<p>For <code>testType = CCC</code>:
</p>
<p>A logical variable indicating whether the asymptotic-variance covariance matrix of the estimated correlations should be corrected for the estimation uncertainty induced by using a semiparametric estimator for the vine copula, i.e., empirical cdf's for the univariate margins and parametric copula families as building blocks of the R-vine copula.
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_finalcomparison">finalComparison</code></td>
<td>

<p>For <code>testType = CCC</code> with <code>grouping = TreeCCC | TreeEC</code>:
</p>
<p>A variable specifying whether at the end of the decision tree all subsets being part of the partition are compared against each other or whether only the pair with the highest value of the test statistic is used.
</p>
<p>Possible values: <code>pairwiseMax</code> | <code>all</code>
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_penaltyparams">penaltyParams</code></td>
<td>

<p>For <code>testType = CCC</code> with <code>grouping = TreeCCC | TreeEC</code>:
</p>
<p>A vector of length two, specifying the functional form of the penalty. The penalty is a function of the sample size n and chosen to be lambda(n) = cn^(-beta). The first entry of the vector is specifying the level c of the penalty and needs to be a positive real number. The second entry of the vector is specifying the power beta of the penalty and needs to be chosen from the interval (0,1).
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_gamma0partition">gamma0Partition</code></td>
<td>

<p>For <code>testType = CCC</code> with <code>grouping = TreeCCC | TreeEC</code>:
</p>
<p>The gamma0 partition. I.e., the partition which is favoured via the penalty under the H0.
</p>
<p>Possible values: <code>SumMedian</code> | <code>SumThirdsI</code> | <code>SumThirdsII</code> | <code>SumThirdsIII</code> | <code>SumQuartiles</code> | <code>ProdMedian</code> | <code>ProdThirdsI</code> | <code>ProdThirdsII</code> | <code>ProdThirdsIII</code> | <code>ProdQuartiles</code>
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_groupedscatterplots">groupedScatterplots</code></td>
<td>

<p>For <code>testType = CCC</code>:
</p>
<p>A logical whether grouped scatterplots should be produced.
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_decisiontreeplot">decisionTreePlot</code></td>
<td>

<p>For <code>testType = CCC</code>:
</p>
<p>A logical whether the partition of the support of W should be illustrated as a decision tree plot.
</p>
</td></tr>
<tr><td><code id="pacotestset_+3A_numbboot">numbBoot</code></td>
<td>
<p>For <code>testType = VI</code>:
</p>
<p>The number of bootstrap replications for computing p-values using the multiplier bootstrap approach.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calling without any arguments prints all possible options.
</p>
<pre>pacotestset()</pre>
<p>Calling with a string, that specifies the test type, gives back a option list with the default values corresponding to each test.
</p>
<pre>pacotestOptions = pacotestset('CCC')</pre>
<pre>pacotestOptions = pacotestset('VI')</pre>
<p>Calling with pairs of parameter names and values creates an <code>pacotestOptions</code> list in which the named parameters have the specified values.
</p>
<pre>pacotestOptions = pacotestset('Name1',Value1,'Name2',Value2,...)</pre>
<p>Calling with an existing <code>pacotestOptions</code> list checks the list for consistency.
</p>
<pre>pacotestset(pacotestOptions)</pre>
<p>Calling with an existing <code>pacotestOptions</code> list and pairs of parameter names and values creates a copy of the existing list, where the named parameters are updated with the provided values.
</p>
<pre>pacotestOptionsNew = pacotestset(pacotestOptions,'Name1',Value1,'Name2',Value2,...)</pre>


<h3>Value</h3>

<p>The function returns a <code>pacotestOptions</code> list which can be used as input argument for the functions <code><a href="#topic+pacotest">pacotest</a></code>, <code><a href="#topic+pacotestRvineSeq">pacotestRvineSeq</a></code> and <code><a href="#topic+pacotestRvineSingleCopula">pacotestRvineSingleCopula</a></code>.
</p>


<h3>Author(s)</h3>

<p>Malte S. Kurz
</p>


<h3>References</h3>

<p>Kurz, M. S. and F. Spanhel (2022), &quot;Testing the simplifying assumption in high-dimensional vine copulas&quot;, Electronic Journal of Statistics 16 (2), pp. 5226-5276.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pacotest-package">pacotest-package</a></code>, <code><a href="#topic+pacotest">pacotest</a></code>, <code><a href="#topic+pacotestRvineSeq">pacotestRvineSeq</a></code>, <code><a href="#topic+pacotestRvineSingleCopula">pacotestRvineSingleCopula</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
