<!DOCTYPE html><html><head><title>Help for package glmbb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {glmbb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#crabs'><p>Horseshoe Crab Mating Data</p></a></li>
<li><a href='#glmbb'><p>All Hierarchical or Graphical Models for Generalized Linear Model</p></a></li>
<li><a href='#isGraphical'><p>Hierarchical and Graphical Models</p></a></li>
<li><a href='#summary.glmbb'><p>Summarize GLM Model Selection via Branch and Bound</p></a></li>
<li><a href='#tidy.formula.hierarchical'><p>Shorten a Hierarchical Formula</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.5-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-21</td>
</tr>
<tr>
<td>Title:</td>
<td>All Hierarchical or Graphical Models for Generalized Linear
Model</td>
</tr>
<tr>
<td>Author:</td>
<td>Charles J. Geyer &lt;charlie@stat.umn.edu&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Charles J. Geyer &lt;charlie@stat.umn.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>digest, stats</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Description:</td>
<td>Find all hierarchical models of specified generalized linear
    model with information criterion (AIC, BIC, or AICc) within specified
    cutoff of minimum value.  Alternatively, find all such graphical models.
    Use branch and bound algorithm so we do not have to fit all models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/cjgeyer/glmbb">https://github.com/cjgeyer/glmbb</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-21 18:45:50 UTC; geyer</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-21 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='crabs'>Horseshoe Crab Mating Data</h2><span id='topic+crabs'></span>

<h3>Description</h3>

<p>Data on horseshoe crabs (<em>Limulus polyphemus</em>).  Response
is number of males surrounding a breeding female, color (factor), condition
(factor), weight (quantitative), and width (quantitative) of the female.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(crabs)</code></pre>


<h3>Format</h3>

<p>A data frame with 173 observations on 6 variables.
Individuals (rows of the data frame) are female horseshoe crabs.
Variables other than <code>satell</code> refer to these females.
The variables are
</p>

<dl>
<dt>color</dt><dd><p>color. The colors given in
Agresti are &ldquo;light medium&rdquo;, &ldquo;medium&rdquo;, &ldquo;dark medium&rdquo;,
and &ldquo;dark&rdquo;.  Here they are abbreviated to <code>light</code>,
<code>medium</code>, <code>dark</code>, and <code>darker</code>, respectively.</p>
</dd>
<dt>spine</dt><dd><p>spine condition.  The conditions given in Agresti are
&ldquo;both good&rdquo;, &ldquo;one worn or broken&rdquo;, and
&ldquo;both worn or broken&rdquo;.
Here they are abbreviated to <code>good</code>, <code>middle</code>, <code>bad</code>,
respectively.</p>
</dd>
<dt>width</dt><dd><p>carapace width in centimeters</p>
</dd>
<dt>satell</dt><dd><p>number of satellites, which males clustering around the
female in addition to the male with which she is breeding.</p>
</dd>
<dt>weight</dt><dd><p>weight in grams.</p>
</dd>
<dt>y</dt><dd><p>shorthand for <code>as.numeric(satell &gt; 0)</code>.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Quoting from the abstract of Brockmann (1996). &ldquo;Horseshoe crabs
arrive on the beach in pairs and spawn ... during ... high tides.
Unattached males also come to the beach, crowd around the nesting couples
and compete with attached males for fertilizations. Satellite males form
large groups around some couples while ignoring others, resulting in
a nonrandom distribution that cannot be explained by local environmental
conditions or habitat selection.&rdquo;
</p>


<h3>Source</h3>

<p>Agresti, A. (2013)
<em>Categorical Data Analysis</em>,
Wiley, Hoboken, NJ., Section 4.3.2,
<a href="http://users.stat.ufl.edu/~aa/cda/data.html">http://users.stat.ufl.edu/~aa/cda/data.html</a>
</p>
<p>Brockmann, H. J. (1996)
Satellite Male Groups in Horseshoe Crabs, <em>Limulus polyphemus</em>,
<em>Ethology</em>, <b>102</b>, 1&ndash;21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(crabs)
  gout &lt;- glm(satell ~ color + spine + width + weight, family = poisson,
      data = crabs)
</code></pre>

<hr>
<h2 id='glmbb'>All Hierarchical or Graphical Models for Generalized Linear Model</h2><span id='topic+glmbb'></span>

<h3>Description</h3>

<p>Find all hierarchical submodels of specified GLM with
information criterion (AIC, BIC, or AICc) within specified cutoff
of minimum value.  Alternatively, all such graphical models.
Use branch and bound algorithm so we do not have to fit all
models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmbb(big, little = ~ 1, family = poisson, data,
    criterion = c("AIC", "AICc", "BIC"), cutoff = 10,
    trace = FALSE, graphical = FALSE, BIC.option = c("length", "sum"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmbb_+3A_big">big</code></td>
<td>
<p>an object of class <code>"<a href="stats.html#topic+formula">formula</a>"</code> specifying
the largest model to be considered.  Model specified must be hierarchical.
(See also <code><a href="stats.html#topic+glm">glm</a></code> and <code><a href="stats.html#topic+formula">formula</a></code> and
&lsquo;Details&rsquo; section below.)</p>
</td></tr>
<tr><td><code id="glmbb_+3A_little">little</code></td>
<td>
<p>a formula specifying the smallest model to be considered.
The response may be omitted and if not omitted is ignored (the response
is taken from <code>big</code>).  Default is <code>~ 1</code>. Model specified must
be nested within the model specified by <code>big</code>.</p>
</td></tr>
<tr><td><code id="glmbb_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link
function to be used in the model.  This can be a
character string naming a family function, a family function or the
result of a call to a family function.  (See <code><a href="stats.html#topic+family">family</a></code>
for details of family functions.)</p>
</td></tr>
<tr><td><code id="glmbb_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a data frame)
containing the variables in the models.  If not found in <code>data</code>, the
variables are taken from <code>environment(big)</code>,
typically the environment from which <code>glmbb</code> is called.</p>
</td></tr>
<tr><td><code id="glmbb_+3A_criterion">criterion</code></td>
<td>
<p>a character string specifying the information criterion,
must be one of <code>"AIC"</code> (Akaike Information Criterion, the default),
<code>"BIC"</code> (Bayes Information Criterion) or <code>"AICc"</code> (AIC corrected
for sample size).   See section on AICc below.</p>
</td></tr>
<tr><td><code id="glmbb_+3A_cutoff">cutoff</code></td>
<td>
<p>a nonnegative real number. This function finds all
hierarchical models that are submodels of <code>big</code> and supermodels of
<code>little</code> with information criterion less than or equal to the
cutoff plus the minimum information criterion over all these models.</p>
</td></tr>
<tr><td><code id="glmbb_+3A_trace">trace</code></td>
<td>
<p>logical.  Emit debug info if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="glmbb_+3A_graphical">graphical</code></td>
<td>
<p>logical.  If <code>TRUE</code> search only over graphical models
rather than hierarchical models.</p>
</td></tr>
<tr><td><code id="glmbb_+3A_bic.option">BIC.option</code></td>
<td>
<p>a character string specifying the sample size <code class="reqn">n</code>
to be used in calculating BIC (ignored if <code>criterion ! = "BIC"</code>),
must be either <code>"length"</code> or <code>"sum"</code> meaning either the
length of the response vector (or number of rows if the response
&ldquo;vector&rdquo; is actually a matrix) or the sum of the response
(number of individuals classified if we are doing categorical
data analysis).  See section about BIC below.  May be abbreviated.</p>
</td></tr>
<tr><td><code id="glmbb_+3A_...">...</code></td>
<td>
<p>additional named or unnamed arguments to be passed
to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Typical value for <code>big</code> is something like <code>foo ~ bar * baz * qux</code>
where <code>foo</code> is the response variable (or matrix when family is
<code><a href="stats.html#topic+binomial">binomial</a></code> or <code><a href="stats.html#topic+quasibinomial">quasibinomial</a></code>,
see <code><a href="stats.html#topic+glm">glm</a></code>) and <code>bar</code>, <code>baz</code>, and <code>qux</code>
are all the predictors that are considered for inclusion in models.
</p>
<p>A model is hierarchical if it includes all lower-order interactions for each
term.  This is automatically what formulas with all variables connected by
stars (<code>*</code>) do, like the example above.
But other specifications are possible.
For example, <code>foo ~ (bar + baz + qux)^2</code> specifies the model with all
main effects, and all two-way interactions, but no three-way interaction,
and this is hierarchical.
</p>
<p>A model <code class="reqn">m_1</code> is nested within a model <code class="reqn">m_1</code> if all terms
in <code class="reqn">m_1</code> are also terms in <code class="reqn">m_2</code>.  The default little model
<code>~ 1</code> is nested within every model except those specified to have
no intercept by <code>0 +</code> or some such (see <code><a href="stats.html#topic+formula">formula</a></code>).
</p>
<p>The interaction graph of a model is the undirected graph whose node set is
the predictor variables in the model and whose edge set has one edge for each
pair of variables that are in an interaction term.  A clique in a graph is
a maximal complete subgraph.  A model is graphical if it is hierarchical
and has an interaction term for the variables in each clique.
When <code>graphical = TRUE</code> only graphical models are considered.
</p>


<h3>Value</h3>

<p>An object of class <code>"glmbb"</code> containing at least the following
components:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>the model frame, a data frame containing all the variables.</p>
</td></tr>
<tr><td><code>little</code></td>
<td>
<p>the argument <code>little</code>.</p>
</td></tr>
<tr><td><code>big</code></td>
<td>
<p>the argument <code>big</code>.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>the argument <code>criterion</code>.</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>the argument <code>cutoff</code>.</p>
</td></tr>
<tr><td><code>envir</code></td>
<td>
<p>an R environment object containing all of the fits done.</p>
</td></tr>
<tr><td><code>min.crit</code></td>
<td>
<p>the minimum value of the criterion.</p>
</td></tr>
<tr><td><code>graphical</code></td>
<td>
<p>the argument <code>graphical</code>.</p>
</td></tr>
</table>


<h3>BIC</h3>

<p>It is unclear what the sample size, the <code class="reqn">n</code> in the BIC penalty
<code class="reqn">n \log(p)</code> should be.  Before version 0.4 of this package
the BIC was taken to be the result of applying R generic function <code>BIC</code>
to the fitted object produced by R function <code>glm</code>.  This is generally
wrong whenever we think we are doing categorical data analysis
(Raftery, 1986; Kass and Raftery, 1995).  Whether we consider the sampling
scheme to be Poisson, multinomial, or product multinomial (and binomial
is a special case of product multinomial) the sample size is the total
number of individuals classified and is the only thing that is
considered as going to infinity in the usual asymptotics for categorical
data analysis.  This the option <code>BIC.option = "sum"</code> should always
be used for categorical data analysis.
</p>


<h3>AICc</h3>

<p>AICc was derived by Hurvich and Tsai only for normal response models.
Burnham and Anderson (2002, p. 378) recommend it for other models when
no other small sample correction is known, but this is not backed up
by any theoretical derivation.
</p>


<h3>References</h3>

<p>Burnham, K. P. and Anderson, D. R. (2002)
<em>Model Selection and Multimodel Inference: A Practical
Information-Theoretic Approach</em>, second edition.
Springer, New York.
</p>
<p>Hand, D. J. (1981)
Branch and bound in statistical data analysis.
<em>The Statistician</em>, <b>30</b>, 1&ndash;13.
</p>
<p>Hurvich, C. M. and Tsai, C.-L. (1989)
Regression and time series model selection in small samples.
<em>Biometrika</em>, <b>76</b>, 297&ndash;307.
</p>
<p>Kass, R. E. and Raftery, A. E. (1995)
Bayes factors.
<em>Journal of the American Statistical Association</em>,
<b>90</b>, 773&ndash;795.
</p>
<p>Raftery, A. E. (1986)
A note on Bayes factors for log-linear contingency table models
with vague prior information.
<em>Journal of the Royal Statistical Society, Series B</em>,
<b>48</b>, 249&ndash;250.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+family">family</a></code>,
<code><a href="stats.html#topic+formula">formula</a></code>,
<code><a href="stats.html#topic+glm">glm</a></code>,
<code><a href="#topic+isGraphical">isGraphical</a></code>,
<code><a href="#topic+isHierarchical">isHierarchical</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crabs)
gout &lt;- glmbb(satell ~ (color + spine + width + weight)^3,
    criterion = "BIC", data = crabs)
summary(gout)
</code></pre>

<hr>
<h2 id='isGraphical'>Hierarchical and Graphical Models</h2><span id='topic+asGraphical'></span><span id='topic+isGraphical'></span><span id='topic+asHierarchical'></span><span id='topic+isHierarchical'></span>

<h3>Description</h3>

<p>Say whether a formula corresponds to a hierarchical model or
a graphical model.  Or return a formula for a hierarchical or
a graphical model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asGraphical(formula)
isGraphical(formula)
asHierarchical(formula)
isHierarchical(formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isGraphical_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>"<a href="stats.html#topic+formula">formula</a>"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A model is hierarchical if for every interaction it contains all
the main effects and lower-order interactions for variables in that
interaction.
</p>
<p>The interaction graph of a model is the undirected graph whose node set is the
predictor variables in the model and whose edge set has one edge for each
pair of variables that are in an interaction term.  A clique in a graph is
a maximal complete subgraph.  A model is graphical if it is hierarchical
and has an interaction term for the variables in each clique.
</p>


<h3>Value</h3>

<p>For &ldquo;is&rdquo; functions, logical.  <code>TRUE</code> if and only if
the model is hierarchical or graphical, as the case may be.
</p>
<p>For &ldquo;as&rdquo; functions, a formula for the smallest supermodel
of the given model that is hierarchical or graphical, as the case may be.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>isHierarchical(~ u * v)
isHierarchical(~ u : v)

isGraphical(~ u * v + u * w)
isGraphical(~ (u + v + w)^2)

asHierarchical(~ u:v + v:w)
asGraphical(~ (u + v + w)^2)
</code></pre>

<hr>
<h2 id='summary.glmbb'>Summarize GLM Model Selection via Branch and Bound</h2><span id='topic+summary.glmbb'></span><span id='topic+print.summary.glmbb'></span>

<h3>Description</h3>

<p>These functions are all <code><a href="utils.html#topic+methods">methods</a></code>
for class <code>glmbb</code> or <code>summary.glmbb</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmbb'
summary(object, cutoff, ...)

## S3 method for class 'summary.glmbb'
print(x, digits = max(3, getOption("digits") - 3),
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.glmbb_+3A_object">object</code></td>
<td>
<p>an object of class <code>"glmbb"</code>, usually, a result of a
call to <code><a href="#topic+glmbb">glmbb</a></code>.</p>
</td></tr>
<tr><td><code id="summary.glmbb_+3A_cutoff">cutoff</code></td>
<td>
<p>a nonnegative real number. Only report on models having
criterion value no larger than the minimum value plus <code>cutoff</code>.
This argument may be omitted, in which case <code>object$cutoff</code> is
used.</p>
</td></tr>
<tr><td><code id="summary.glmbb_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.glmbb"</code>, usually, a result of a
call to <code>summary.glmbb</code>.</p>
</td></tr>
<tr><td><code id="summary.glmbb_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.glmbb_+3A_...">...</code></td>
<td>
<p>not used.  Required by their generics.</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>Let <code>criterion</code> denote the vector of criterion (AIC, BIC, or AICc)
values for all of the models evaluated in the search.  Those with
criterion value greater than <code>min(criterion) + cutoff</code> are tossed.
</p>
<p>We also define a vector <code>weight</code> by
</p>
<pre>w &lt;- exp(- criterion / 2)
weight &lt;- w / sum(w)</pre>
<p>except that it is calculated differently to avoid overflow.
These are so-called Akaike weights.  They may or may not provide some
guide as to how to deal with these models.  For more see Burnham and
Anderson (2002).
</p>


<h3>Value</h3>

<p><code>summary.glmbb</code> returns an object of class <code>"summary.glmbb"</code>, a
list with components
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p>a data frame having variables
</p>

<dl>
<dt><code>criterion</code></dt><dd><p>the vector <code>criterion</code> described
in the Details section, in sorted order.</p>
</dd>
<dt><code>weight</code></dt><dd><p>the corresponding Akaike weights.</p>
</dd>
<dt><code>formula</code></dt><dd><p>the corresponding formulas describing
the corresponding models.</p>
</dd>
</dl>

</td></tr>
<tr><td><code>cutoff.search</code></td>
<td>
<p>the <code>cutoff</code> argument to the call to <code>glmbb</code>
that produced <code>object</code>.</p>
</td></tr>
<tr><td><code>cutoff.summary</code></td>
<td>
<p>the <code>cutoff</code> argument to the call to
<code>summary.glmbb</code>.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>a character variable giving the name of the criterion
(AIC, BIC, or AICc). Not to be confused with <code>results$criterion</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Burnham, K. P. and Anderson, D. R. (2002).
<em>Model Selection and Multimodel Inference: A Practical
Information-Theoretic Approach</em>, 2nd ed.
Springer-Verlag, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For examples see those in help(glmbb)
</code></pre>

<hr>
<h2 id='tidy.formula.hierarchical'>Shorten a Hierarchical Formula</h2><span id='topic+tidy.formula.hierarchical'></span>

<h3>Description</h3>

<p>Simplify a formula, assuming it is hierarchical, that is,
an interaction implies all lower-order interactions and main
effects involving the same variables are in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidy.formula.hierarchical(formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tidy.formula.hierarchical_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>"<a href="stats.html#topic+formula">formula</a>"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string coercible to a formula equivalent to the input.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tidy.formula.hierarchical(y ~ u + v + w + u:v + u:w + v:w + u:v:w)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
