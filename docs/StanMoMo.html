<!DOCTYPE html><html><head><title>Help for package StanMoMo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {StanMoMo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apc_stan'><p>Bayesian Age-Period-Cohort model with 'Stan'</p></a></li>
<li><a href='#boxplot_post_dist'><p>Boxplot for the posterior distribution</p></a></li>
<li><a href='#cbd_stan'><p>Bayesian Cairns-Blake-Dowd (CBD) model with Stan</p></a></li>
<li><a href='#compute_weights_BMA'><p>Compute the model evidence/marginal likelihood via bridge sampling (or via the harmonic mean estimator if bridge sampling fails)</p></a></li>
<li><a href='#extract_map'><p>Function to get the a posterior means of the parameters based on a stanfit object</p></a></li>
<li><a href='#fit_mo_mo'><p>Wrapper function to fit and forecast mortality models</p></a></li>
<li><a href='#FRMaleData'><p>Deaths and Exposures Data of French Males</p></a></li>
<li><a href='#lc_stan'><p>Bayesian Lee-Carter with Stan</p></a></li>
<li><a href='#m6_stan'><p>Bayesian M6 model with Stan</p></a></li>
<li><a href='#mortality_weights'><p>Model averaging/weighting via future-out stacking or pseudo-BMA weighting</p></a></li>
<li><a href='#rh_stan'><p>Bayesian Renshaw-Haberman model with Stan</p></a></li>
<li><a href='#sim_death_apc'><p>Simulation of death counts from the Age-Period-Cohort mortality model</p></a></li>
<li><a href='#sim_death_cbd'><p>Simulation of death counts from the CBD model</p></a></li>
<li><a href='#sim_death_lc'><p>Simulation of death counts from the Lee-Carter mortality model</p></a></li>
<li><a href='#sim_death_m6'><p>Simulation of death counts from the M6 model</p></a></li>
<li><a href='#sim_death_mix_cbd_rh'><p>Simulation of death counts from a hybrid model that averages the mortality</p>
rates from the cbd and rh models</a></li>
<li><a href='#sim_death_rh'><p>Simulation of death counts from the Renshaw-Haberman mortality model</p></a></li>
<li><a href='#sim_mortality_data'><p>Simulation of mortality data from various models</p></a></li>
<li><a href='#StanMoMo-package'><p>The 'StanMoMo' package.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Mortality Modelling with 'Stan'</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of popular mortality models using the 'rstan' 
    package, which provides the R interface to the 'Stan' C++ library for 
    Bayesian estimation. The package supports well-known models proposed in the 
    actuarial and demographic literature including the Lee-Carter (1992) 
    &lt;<a href="https://doi.org/10.1080%2F01621459.1992.10475265">doi:10.1080/01621459.1992.10475265</a>&gt; and the Cairns-Blake-Dowd (2006) 
    &lt;<a href="https://doi.org/10.1111%2Fj.1539-6975.2006.00195.x">doi:10.1111/j.1539-6975.2006.00195.x</a>&gt; models. By a simple call, the user 
    inputs deaths and exposures and the package outputs the MCMC simulations for
    each parameter, the log likelihoods and predictions. Moreover, the package 
    includes tools for model selection and Bayesian model averaging by leave 
    future-out validation.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>loo, methods, RcppParallel, Rcpp (&ge; 0.12.0), rstan (&ge;
2.26.0), rstantools (&ge; 2.0.0), tidyverse, dplyr, tibble, httr,
bridgesampling, stats, utils, tidyselect, latex2exp, tidyr,
ggplot2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
rstan (&ge; 2.26.0), StanHeaders (&ge; 2.26.0), RcppParallel</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, shinystan, Cairo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kabarigou/StanMoMo">https://github.com/kabarigou/StanMoMo</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kabarigou/StanMoMo/issues">https://github.com/kabarigou/StanMoMo/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-23 19:52:51 UTC; Karim Barigou</td>
</tr>
<tr>
<td>Author:</td>
<td>Karim Barigou <a href="https://orcid.org/0000-0003-3389-9596"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Pierre-Olivier Goffard
    <a href="https://orcid.org/0000-0002-2667-6207"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karim Barigou &lt;karim290492@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-23 21:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='apc_stan'>Bayesian Age-Period-Cohort model with 'Stan'</h2><span id='topic+apc_stan'></span>

<h3>Description</h3>

<p>Fit and Forecast Bayesian APC model. The model can be fitted with a Poisson or
Negative-Binomial distribution. The function outputs posteriors distributions for each parameter,
predicted death rates and log-likelihoods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apc_stan(
  death,
  exposure,
  forecast,
  validation = 0,
  family = c("poisson", "nb"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apc_stan_+3A_death">death</code></td>
<td>
<p>Matrix of deaths.</p>
</td></tr>
<tr><td><code id="apc_stan_+3A_exposure">exposure</code></td>
<td>
<p>Matrix of exposures.</p>
</td></tr>
<tr><td><code id="apc_stan_+3A_forecast">forecast</code></td>
<td>
<p>Number of years to forecast.</p>
</td></tr>
<tr><td><code id="apc_stan_+3A_validation">validation</code></td>
<td>
<p>Number of years for validation.</p>
</td></tr>
<tr><td><code id="apc_stan_+3A_family">family</code></td>
<td>
<p>specifies the random component of the mortality model. <code>"Poisson"</code> assumes a
Poisson model with log link and <code>"nb"</code> assumes a negative-binomial model
with log link and overdispersion parameter <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code id="apc_stan_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>rstan::sampling</code> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The created model is either a log-Poisson or a log-Negative-Binomial version of
the APC model:
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t} \sim \mathcal{P}(\mu_{x,t} e_{x,t})</code>
</p>

<p>or
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t}\sim NB\left(\mu_{x,t} e_{x,t},\phi\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\log \mu_{xt} = \alpha_x + \kappa_t + \gamma_{t-x}.</code>
</p>

<p>To ensure the identifiability of th model, we impose
</p>
<p style="text-align: center;"><code class="reqn">\kappa_1=0, \gamma_1=0,\gamma_C=0,</code>
</p>

<p>where <code class="reqn">C</code> represents the most recent cohort in the data.
</p>
<p>For the priors, we assume that
</p>
<p style="text-align: center;"><code class="reqn">\alpha_x \sim N(0,100),\frac{1}{\phi} \sim Half-N(0,1).</code>
</p>

<p>For the period term, similar to the LC model, we consider a random walk with drift:
</p>
<p style="text-align: center;"><code class="reqn">\kappa_{t}=c+\kappa_{t-1}+\epsilon_{t},\epsilon_{t}\sim N(0,\sigma^2)</code>
</p>

<p>with the following hyperparameters assumptions: <code class="reqn">c \sim N(0,10),\sigma \sim Exp(0.1)</code>.
</p>
<p>For the cohort term, we consider a second order autoregressive process (AR(2)):
</p>
<p style="text-align: center;"><code class="reqn">\gamma_{c}=\psi_1 \gamma_{c-1}+\psi_2 \gamma_{c-2}+\epsilon^{\gamma}_{t},\quad \epsilon^{\gamma}_{t}\sim N(0,\sigma_{\gamma}).</code>
</p>

<p>To close the model specification, we impose some vague priors assumptions on the hyperparameters:
</p>
<p style="text-align: center;"><code class="reqn">\psi_1,\psi_2 \sim N(0,10),\quad \sigma_{\gamma}\sim Exp(0.1).</code>
</p>



<h3>Value</h3>

<p>An object of class <code>stanfit</code> returned by <code>rstan::sampling</code>
</p>


<h3>References</h3>

<p>Cairns, A. J. G., Blake, D., Dowd, K., Coughlan, G. D., Epstein, D.,
Ong, A., &amp; Balevich, I. (2009). A quantitative comparison of stochastic
mortality models using data from England and Wales and the United States.
North American Actuarial Journal, 13(1), 1-35.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#10-year forecasts for French data for ages 50-90 and years 1970-2017 with a log-Poisson model
ages.fit&lt;-70:90
years.fit&lt;-1990:2010
deathFR&lt;-FRMaleData$Dxt[formatC(ages.fit),formatC(years.fit)]
exposureFR&lt;-FRMaleData$Ext[formatC(ages.fit),formatC(years.fit)]
iterations&lt;-50 # Toy example, consider at least 2000 iterations
fitAPC=apc_stan(death = deathFR,exposure=exposureFR, forecast = 5, family = "poisson",
iter=iterations,chains=1)


</code></pre>

<hr>
<h2 id='boxplot_post_dist'>Boxplot for the posterior distribution</h2><span id='topic+boxplot_post_dist'></span>

<h3>Description</h3>

<p>The function generates boxplots for the posterior distribution of the main parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxplot_post_dist(stan_fit, parm_name, ages, years)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxplot_post_dist_+3A_stan_fit">stan_fit</code></td>
<td>
<p>stan fit object</p>
</td></tr>
<tr><td><code id="boxplot_post_dist_+3A_parm_name">parm_name</code></td>
<td>
<p>string to indicate the name of the parameter, to choose from c('a', 'b', 'g', 'k', 'k2', 'phi')</p>
</td></tr>
<tr><td><code id="boxplot_post_dist_+3A_ages">ages</code></td>
<td>
<p>range of ages</p>
</td></tr>
<tr><td><code id="boxplot_post_dist_+3A_years">years</code></td>
<td>
<p>range of years</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Posterior distribution shown as boxplots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

years &lt;- 1990:2017
ages &lt;- 50:90
cohorts &lt;- sort(unique(as.vector(sapply(years, function(year) year - ages))))
death &lt;- FRMaleData$Dxt[formatC(ages),formatC(years)]
exposure &lt;- FRMaleData$Ext[formatC(ages),formatC(years)]
iterations&lt;-50 # Toy example, consider at least 2000 iterations
stan_fit &lt;- fit_mo_mo("m6", death , exposure, ages, 0, 5, "nb", 1, 4,
log_marg = FALSE,iter=iterations)
boxplot_post_dist(stan_fit, "k", ages, years)
boxplot_post_dist(stan_fit, "g", ages, years)


</code></pre>

<hr>
<h2 id='cbd_stan'>Bayesian Cairns-Blake-Dowd (CBD) model with Stan</h2><span id='topic+cbd_stan'></span>

<h3>Description</h3>

<p>Fit and Forecast Bayesian CBD model. The model can be fitted with a Poisson or
Negative-Binomial distribution. The function outputs posteriors distributions for each parameter,
predicted death rates and log-likelihoods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cbd_stan(
  death,
  exposure,
  age,
  forecast,
  validation = 0,
  family = c("poisson", "nb"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cbd_stan_+3A_death">death</code></td>
<td>
<p>Matrix of deaths.</p>
</td></tr>
<tr><td><code id="cbd_stan_+3A_exposure">exposure</code></td>
<td>
<p>Matrix of exposures.</p>
</td></tr>
<tr><td><code id="cbd_stan_+3A_age">age</code></td>
<td>
<p>Vector of ages.</p>
</td></tr>
<tr><td><code id="cbd_stan_+3A_forecast">forecast</code></td>
<td>
<p>Number of years to forecast.</p>
</td></tr>
<tr><td><code id="cbd_stan_+3A_validation">validation</code></td>
<td>
<p>Number of years for validation.</p>
</td></tr>
<tr><td><code id="cbd_stan_+3A_family">family</code></td>
<td>
<p>specifies the random component of the mortality model. <code>"Poisson"</code> assumes a
Poisson model with log link and <code>"nb"</code> assumes a negative-binomial model
with log link and overdispersion parameter <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code id="cbd_stan_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>rstan::sampling</code> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The created model is either a log-Poisson or a log-Negative-Binomial version of
the CBD model:
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t} \sim \mathcal{P}(\mu_{x,t} e_{x,t})</code>
</p>

<p>or
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t}\sim NB\left(\mu_{x,t} e_{x,t},\phi\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\log \mu_{xt} = \kappa_t^{(1)} + (x-\bar{x})\kappa_t^{(2)},</code>
</p>

<p>where <code class="reqn">\bar{x}</code> is the average age in the data.
</p>
<p>For the period terms, we consider a multivariate random walk with drift:
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\kappa}_{t}=\boldsymbol{c}+\boldsymbol{\kappa}_{t-1}+\boldsymbol{\epsilon}_{t}^{\kappa},\quad \bm{\kappa}_{t}=\left(\begin{array}{c}\kappa_{t}^{(1)} \\\kappa_{t}^{(2)}\end{array}\right), \quad \boldsymbol{\epsilon}_{t}^{\kappa} \sim N\left(\mathbf{0}, \Sigma\right),</code>
</p>

<p>with normal priors: <code class="reqn">\boldsymbol{c} \sim N(0,10)</code>.
</p>
<p>The variance-covariance matrix of the error term is defined by
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma}=\left(\begin{array}{cc}\sigma_1^{2} &amp; \rho_{\Sigma} \sigma_1 \sigma_2 \\\rho_{\Sigma} \sigma_1 \sigma_{Y} &amp; \sigma_2^{2}\end{array}\right)</code>
</p>

<p>where the variance coefficients have independent exponential priors: <code class="reqn">\sigma_1, \sigma_2 \sim Exp(0.1)</code>
and the correlation parameter has a uniform prior: <code class="reqn">\rho_{\Sigma} \sim U\left[-1,1\right]</code>.
As for the other models, the overdispersion parameter has a prior distribution given by
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{\phi} \sim Half-N(0,1).</code>
</p>



<h3>Value</h3>

<p>An object of class <code>stanfit</code> returned by <code>rstan::sampling</code>
</p>


<h3>References</h3>

<p>Cairns, A. J. G., Blake, D., &amp; Dowd, K. (2006). A Two-Factor Model for
Stochastic Mortality with Parameter Uncertainty: Theory and Calibration.
Journal of Risk and Insurance, 73(4), 687-718.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#10-year forecasts for French data for ages 50-90 and years 1970-2017 with a log-NB model
ages.fit&lt;-50:90
years.fit&lt;-1970:2017
deathFR&lt;-FRMaleData$Dxt[formatC(ages.fit),formatC(years.fit)]
exposureFR&lt;-FRMaleData$Ext[formatC(ages.fit),formatC(years.fit)]
iterations&lt;-50 # Toy example, consider at least 2000 iterations
fitCBD=cbd_stan(death = deathFR,exposure=exposureFR, age=ages.fit, forecast = 10,
family = "poisson",iter=iterations,chains=1)

</code></pre>

<hr>
<h2 id='compute_weights_BMA'>Compute the model evidence/marginal likelihood via bridge sampling (or via the harmonic mean estimator if bridge sampling fails)</h2><span id='topic+compute_weights_BMA'></span>

<h3>Description</h3>

<p>Compute the model evidence/marginal likelihood via bridge sampling (or via the harmonic mean estimator if bridge sampling fails)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_weights_BMA(stan_fits, mortality_models)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_weights_BMA_+3A_stan_fits">stan_fits</code></td>
<td>
<p>list of Stan model fits where the marginal likelihood was computed via bridge sampling</p>
</td></tr>
<tr><td><code id="compute_weights_BMA_+3A_mortality_models">mortality_models</code></td>
<td>
<p>vector of mortality models names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with model evidence for BMA
</p>

<hr>
<h2 id='extract_map'>Function to get the a posterior means of the parameters based on a stanfit object</h2><span id='topic+extract_map'></span>

<h3>Description</h3>

<p>Function to get the a posterior means of the parameters based on a stanfit object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_map(stan_fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_map_+3A_stan_fit">stan_fit</code></td>
<td>
<p>a stanfit object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list with the point estimates of the parameters
</p>

<hr>
<h2 id='fit_mo_mo'>Wrapper function to fit and forecast mortality models</h2><span id='topic+fit_mo_mo'></span>

<h3>Description</h3>

<p>Wrapper function to fit and forecast mortality models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_mo_mo(
  mortality_model = "lc",
  death,
  exposure,
  ages = 50:90,
  validation = 0,
  forecast = 1,
  family = "nb",
  chains = 1,
  cores = 4,
  log_marg = FALSE,
  iter = 2000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_mo_mo_+3A_mortality_model">mortality_model</code></td>
<td>
<p>name of the mortality model</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_death">death</code></td>
<td>
<p>death matrix</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_exposure">exposure</code></td>
<td>
<p>exposure matrix</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_ages">ages</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_validation">validation</code></td>
<td>
<p>size of the validation set</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_forecast">forecast</code></td>
<td>
<p>number of calendar years to be forecast</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_family">family</code></td>
<td>
<p>underlying count distribution</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_chains">chains</code></td>
<td>
<p>number of Markov chains</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_cores">cores</code></td>
<td>
<p>number of cores used</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_log_marg">log_marg</code></td>
<td>
<p>Do we compute the marginal likelihood or not?</p>
</td></tr>
<tr><td><code id="fit_mo_mo_+3A_iter">iter</code></td>
<td>
<p>Length of the Markov chain trajectory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a stanfit object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

years &lt;- 1990:2017
ages &lt;- 50:90
cohorts &lt;- sort(unique(as.vector(sapply(years, function(year) year - ages))))
death &lt;- FRMaleData$Dxt[formatC(ages),formatC(years)]
exposure &lt;- FRMaleData$Ext[formatC(ages),formatC(years)]
stan_fit &lt;- fit_mo_mo("m6", death , exposure, ages, 0, 5, "nb", 1, 4,
log_marg = FALSE,iter=50)
boxplot_post_dist(stan_fit, "k", ages, years)
boxplot_post_dist(stan_fit, "g", ages, years)


</code></pre>

<hr>
<h2 id='FRMaleData'>Deaths and Exposures Data of French Males</h2><span id='topic+FRMaleData'></span>

<h3>Description</h3>

<p>List containing deaths and exposures of French Male for ages 0-110 and years 1816-2017.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FRMaleData
</code></pre>


<h3>Format</h3>

<p>A list of 2 matrices
</p>

<dl>
<dt>Dxt</dt><dd><p>Matrix of deaths, with 111 rows (ages) and 202 columns (years)</p>
</dd>
<dt>Ext</dt><dd><p>Matrix of exposures, with 111 rows (ages) and 202 columns (years)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Human Mortality Database <a href="https://www.mortality.org/">https://www.mortality.org/</a>
</p>


<h3>References</h3>

<p>Human Mortality Database (2011).   University of California,  Berkeley (USA), and Max Planck Institute
for Demographic Research (Germany). Available at <a href="https://www.mortality.org/">https://www.mortality.org/</a>
</p>

<hr>
<h2 id='lc_stan'>Bayesian Lee-Carter with Stan</h2><span id='topic+lc_stan'></span>

<h3>Description</h3>

<p>Fit and Forecast Bayesian Lee-Carter model. The model can be fitted with a Poisson or
Negative-Binomial distribution. The function outputs posteriors distributions for each parameter,
predicted death rates and log-likelihoods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lc_stan(
  death,
  exposure,
  forecast,
  validation = 0,
  family = c("poisson", "nb"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lc_stan_+3A_death">death</code></td>
<td>
<p>Matrix of deaths.</p>
</td></tr>
<tr><td><code id="lc_stan_+3A_exposure">exposure</code></td>
<td>
<p>Matrix of exposures.</p>
</td></tr>
<tr><td><code id="lc_stan_+3A_forecast">forecast</code></td>
<td>
<p>Number of years to forecast.</p>
</td></tr>
<tr><td><code id="lc_stan_+3A_validation">validation</code></td>
<td>
<p>Number of years for validation.</p>
</td></tr>
<tr><td><code id="lc_stan_+3A_family">family</code></td>
<td>
<p>specifies the random component of the mortality model. <code>"Poisson"</code> assumes a
Poisson model with log link and <code>"nb"</code> assumes a negative-binomial model
with log link and overdispersion parameter <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code id="lc_stan_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>rstan::sampling</code> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The created model is either a log-Poisson or a log-Negative-Binomial version of
the Lee-Carter model:
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t} \sim \mathcal{P}(\mu_{x,t} e_{x,t})</code>
</p>

<p>or
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t}\sim NB\left(\mu_{x,t} e_{x,t},\phi\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\log \mu_{xt} = \alpha_x + \beta_x\kappa_t.</code>
</p>

<p>To ensure the identifiability of th model, we impose
</p>
<p style="text-align: center;"><code class="reqn">\sum_x\beta_x = 1,\kappa_1=0.</code>
</p>

<p>For the priors, the model chooses relatively wide priors:
</p>
<p style="text-align: center;"><code class="reqn">\alpha_x \sim N(0,100),\beta_{x} \sim Dir(1,\dots,1),\frac{1}{\phi} \sim Half-N(0,1).</code>
</p>

<p>For the period term, we consider a first order autoregressive process (AR(1)) with linear trend:
</p>
<p style="text-align: center;"><code class="reqn">\kappa_{t}=c+\kappa_{t-1}+\epsilon_{t},\epsilon_{t}\sim N(0,\sigma^2)</code>
</p>

<p>with <code class="reqn">c \sim N(0,10),\sigma \sim Exp(0.1)</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>stanfit</code> returned by <code>rstan::sampling</code>.
</p>


<h3>References</h3>

<p>Lee, R. D., &amp; Carter, L. R. (1992). Modeling and forecasting U.S. mortality.
Journal of the American Statistical Association, 87(419), 659-671.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#10-year forecasts for French data for ages 50-90 and years 1970-2017 with a log-Poisson model
ages.fit&lt;-50:90
years.fit&lt;-1970:2017
deathFR&lt;-FRMaleData$Dxt[formatC(ages.fit),formatC(years.fit)]
exposureFR&lt;-FRMaleData$Ext[formatC(ages.fit),formatC(years.fit)]
iterations&lt;-50 # Toy example, consider at least 2000 iterations
fitLC=lc_stan(death = deathFR,exposure=exposureFR, forecast = 10,
family = "poisson",iter=iterations,chains=1)


</code></pre>

<hr>
<h2 id='m6_stan'>Bayesian M6 model with Stan</h2><span id='topic+m6_stan'></span>

<h3>Description</h3>

<p>Fit and Forecast Bayesian M6 model (CBD with cohort effect) introduced in Cairns et al (2009).
The model can be fitted with a Poisson or Negative-Binomial distribution. The function outputs posteriors distributions for each parameter,
predicted death rates and log-likelihoods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m6_stan(
  death,
  exposure,
  forecast,
  age,
  validation = 0,
  family = c("poisson", "nb"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m6_stan_+3A_death">death</code></td>
<td>
<p>Matrix of deaths.</p>
</td></tr>
<tr><td><code id="m6_stan_+3A_exposure">exposure</code></td>
<td>
<p>Matrix of exposures.</p>
</td></tr>
<tr><td><code id="m6_stan_+3A_forecast">forecast</code></td>
<td>
<p>Number of years to forecast.</p>
</td></tr>
<tr><td><code id="m6_stan_+3A_age">age</code></td>
<td>
<p>Vector of ages.</p>
</td></tr>
<tr><td><code id="m6_stan_+3A_validation">validation</code></td>
<td>
<p>Number of years for validation.</p>
</td></tr>
<tr><td><code id="m6_stan_+3A_family">family</code></td>
<td>
<p>specifies the random component of the mortality model. <code>"Poisson"</code> assumes a
Poisson model with log link and <code>"nb"</code> assumes a negative-binomial model
with log link and overdispersion parameter <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code id="m6_stan_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>rstan::sampling</code> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The created model is either a log-Poisson or a log-Negative-Binomial version of
the M6 model:
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t} \sim \mathcal{P}(\mu_{x,t} e_{x,t})</code>
</p>

<p>or
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t}\sim NB\left(\mu_{x,t} e_{x,t},\phi\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\log \mu_{xt} = \kappa_t^{(1)} + (x-\bar{x})\kappa_t^{(2)}+\gamma_{t-x},</code>
</p>

<p>where <code class="reqn">\bar{x}</code> is the average age in the data.
</p>
<p>To ensure the identifiability of th model, we impose
</p>
<p style="text-align: center;"><code class="reqn">\gamma_1=0,\gamma_C=0,</code>
</p>

<p>where <code class="reqn">C</code> represents the most recent cohort in the data.
</p>
<p>For the period terms, we consider a multivariate random walk with drift:
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\kappa}_{t}=\boldsymbol{c}+ \boldsymbol{\kappa}_{t-1}+\boldsymbol{\epsilon}_{t}^{\kappa},\quad \boldsymbol{\kappa}_{t}=\left(\begin{array}{c}\kappa_{t}^{(1)} \\\kappa_{t}^{(2)}\end{array}\right), \quad \boldsymbol{\epsilon}_{t}^{\kappa} \sim N\left(\mathbf{0}, \Sigma\right),</code>
</p>

<p>with normal priors: <code class="reqn">\boldsymbol{c} \sim N(0,10)</code>.
</p>
<p>The variance-covariance matrix of the error term is defined by
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma}=\left(\begin{array}{cc}\sigma_1^{2} &amp; \rho_{\Sigma} \sigma_1 \sigma_2 \\\rho_{\Sigma} \sigma_1 \sigma_{Y} &amp; \sigma_2^{2}\end{array}\right)</code>
</p>

<p>where the variance coefficients have independent exponential priors: <code class="reqn">\sigma_1, \sigma_2 \sim Exp(0.1)</code>
and the correlation parameter has a uniform prior: <code class="reqn">\rho_{\Sigma} \sim U\left[-1,1\right]</code>.
As for the other models, the overdispersion parameter has a prior distribution given by
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{\phi} \sim Half-N(0,1).</code>
</p>

<p>For the cohort term, we consider a second order autoregressive process (AR(2)):
</p>
<p style="text-align: center;"><code class="reqn">\gamma_{c}=\psi_1 \gamma_{c-1}+\psi_2 \gamma_{c-2}+\epsilon^{\gamma}_{t},\quad \epsilon^{\gamma}_{t}\sim N(0,\sigma_{\gamma}).</code>
</p>

<p>To close the model specification, we impose some vague priors assumptions on the hyperparameters:
</p>
<p style="text-align: center;"><code class="reqn">\psi_1,\psi_2 \sim N(0,10),\quad \sigma_{\gamma}\sim Exp(0.1).</code>
</p>



<h3>Value</h3>

<p>An object of class <code>stanfit</code> returned by <code>rstan::sampling</code>.
</p>


<h3>References</h3>

<p>Cairns, A. J. G., Blake, D., Dowd, K., Coughlan, G. D., Epstein, D.,
Ong, A., &amp; Balevich, I. (2009). A quantitative comparison of stochastic
mortality models using data from England and Wales and the United States.
North American Actuarial Journal, 13(1), 1-35.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#10-year forecasts for French data for ages 50-90 and years 1970-2017 with a log-Poisson model
ages.fit&lt;-70:90
years.fit&lt;-1990:2010
deathFR&lt;-FRMaleData$Dxt[formatC(ages.fit),formatC(years.fit)]
exposureFR&lt;-FRMaleData$Ext[formatC(ages.fit),formatC(years.fit)]
iterations&lt;-50 # Toy example, consider at least 2000 iterations
fitM6=m6_stan(death = deathFR,exposure=exposureFR, age=ages.fit,forecast = 5,
family = "poisson",iter=iterations,chains=1)



</code></pre>

<hr>
<h2 id='mortality_weights'>Model averaging/weighting via future-out stacking or pseudo-BMA weighting</h2><span id='topic+mortality_weights'></span>

<h3>Description</h3>

<p>Mortality Model averaging via stacking of predictive distributions and Pseudo-BMA weighting. Based on Yao et al. (2018) but adapted by Barigou et al. (2021)
for mortality forecasting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mortality_weights(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mortality_weights_+3A_x">X</code></td>
<td>
<p>A list of stanfit objects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Mortality model averaging via stacking of predictive distributions or pseudo-BMA weighting.
Both approaches were proposed in Yao et al. (2018) based leave-one-out cross-validation which is not suited for forecasting.
Barigou et al. (2021) adapted both approaches based on leave-future-out validation which is more appropriate for mortality forecasting.
</p>
<p>The stacking method combines all models by maximizing the leave-future-out
predictive density of the combination distribution. That is, it finds the
optimal linear combining weights for maximizing the leave-future-out log score.
</p>
<p>The pseudo-BMA method finds the relative weights proportional to the expected
log predictive density of each model.
</p>
<p>Similar to Yao et al. (2018), we recommend stacking for averaging predictive distributions
as pseudo-BMA tends to select only one model.
</p>


<h3>Value</h3>

<p>A matrix containing one weight for each model and each approach.
</p>


<h3>References</h3>

<p>Yao, Y., Vehtari, A., Simpson, D., &amp; Gelman, A. (2018). Using stacking to average Bayesian predictive distributions (with discussion).
Bayesian Analysis, 13(3), 917-1007.
</p>
<p>Barigou K., Goffard P-O., Loisel S., Salhi Y. (2021). Bayesian model averaging for mortality forecasting using leave-future-out validation.
arXiv preprint arXiv:2103.15434.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#10-year forecasts for French data for ages 50-90 and years 1970-2017 with a log-Poisson model
#where the 10 last years are held out for validation. We search for the model weights between
#the Lee-Carter model and the RH model (Lee-Carter with cohort effect).
ages.fit&lt;-50:90
years.fit&lt;-1970:2017
deathFR&lt;-FRMaleData$Dxt[formatC(ages.fit),formatC(years.fit)]
exposureFR&lt;-FRMaleData$Ext[formatC(ages.fit),formatC(years.fit)]
iterations&lt;-1000 # Toy example, consider at least 2000 iterations
fitLC=lc_stan(death = deathFR,exposure=exposureFR, forecast = 10, validation=10,
family = "poisson",iter=iterations,chains=1)
fitRH=rh_stan(death = deathFR,exposure=exposureFR, forecast = 10, validation=10,
family = "poisson",iter=iterations,chains=1)
model_weights&lt;-mortality_weights(list(fitLC,fitRH))


</code></pre>

<hr>
<h2 id='rh_stan'>Bayesian Renshaw-Haberman model with Stan</h2><span id='topic+rh_stan'></span>

<h3>Description</h3>

<p>Fit and Forecast Bayesian Renshaw-Haberman model (Lee-Carter with cohort effect) introduced in Renshaw and Haberman (2006).
The model can be fitted with a Poisson or Negative-Binomial distribution. The function outputs posteriors distributions for each parameter,
predicted death rates and log-likelihoods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rh_stan(
  death,
  exposure,
  forecast,
  validation = 0,
  family = c("poisson", "nb"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rh_stan_+3A_death">death</code></td>
<td>
<p>Matrix of deaths.</p>
</td></tr>
<tr><td><code id="rh_stan_+3A_exposure">exposure</code></td>
<td>
<p>Matrix of exposures.</p>
</td></tr>
<tr><td><code id="rh_stan_+3A_forecast">forecast</code></td>
<td>
<p>Number of years to forecast.</p>
</td></tr>
<tr><td><code id="rh_stan_+3A_validation">validation</code></td>
<td>
<p>Number of years for validation.</p>
</td></tr>
<tr><td><code id="rh_stan_+3A_family">family</code></td>
<td>
<p>specifies the random component of the mortality model. <code>"Poisson"</code> assumes a
Poisson model with log link and <code>"nb"</code> assumes a negative-binomial model
with log link and overdispersion parameter <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code id="rh_stan_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>rstan::sampling</code> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The created model is either a log-Poisson or a log-Negative-Binomial version of
the Renshaw-Haberman model:
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t} \sim \mathcal{P}(\mu_{x,t} e_{x,t})</code>
</p>

<p>or
</p>
<p style="text-align: center;"><code class="reqn">D_{x,t}\sim NB\left(\mu_{x,t} e_{x,t},\phi\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\log \mu_{xt} = \alpha_x + \beta_x\kappa_t+\gamma_{t-x}.</code>
</p>

<p>To ensure the identifiability of th model, we impose
</p>
<p style="text-align: center;"><code class="reqn">\kappa_1=0, \gamma_1=0,\sum gamma_i =0, \gamma_C=0,</code>
</p>

<p>where <code class="reqn">C</code> represents the most recent cohort in the data.
</p>
<p>For the priors, the model chooses wide priors:
</p>
<p style="text-align: center;"><code class="reqn">\alpha_x \sim N(0,100),\beta_{x} \sim Dir(1,\dots,1),\frac{1}{\phi} \sim Half-N(0,1).</code>
</p>

<p>For the period term, we consider the standard random walk with drift:
</p>
<p style="text-align: center;"><code class="reqn">\kappa_{t}=c+\kappa_{t-1}+\epsilon_{t},\epsilon_{t}\sim N(0,\sigma^2)</code>
</p>

<p>with <code class="reqn">c \sim N(0,10),\sigma \sim Exp(0.1)</code>.
</p>
<p>For the cohort term, we consider a second order autoregressive process (AR(2)):
</p>
<p style="text-align: center;"><code class="reqn">\gamma_{c}=\psi_1 \gamma_{c-1}+\psi_2 \gamma_{c-2}+\epsilon^{\gamma}_{t},\quad \epsilon^{\gamma}_{t}\sim N(0,\sigma_{\gamma}).</code>
</p>

<p>To close the model specification, we impose some vague priors assumptions on the hyperparameters:
</p>
<p style="text-align: center;"><code class="reqn">\psi_1,\psi_2 \sim N(0,10),\quad \sigma_{\gamma}\sim Exp(0.1).</code>
</p>



<h3>Value</h3>

<p>An object of class <code>stanfit</code> returned by <code>rstan::sampling</code>.
</p>


<h3>References</h3>

<p>Renshaw, A. E., &amp; Haberman, S. (2006). A cohort-based extension to the
Lee-Carter model for mortality reduction factors.
Insurance: Mathematics and Economics, 38(3), 556-570.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#10-year forecasts for French data for ages 50-90 and years 1970-2017 with a log-Poisson model
ages.fit&lt;-70:90
years.fit&lt;-1990:2010
deathFR&lt;-FRMaleData$Dxt[formatC(ages.fit),formatC(years.fit)]
exposureFR&lt;-FRMaleData$Ext[formatC(ages.fit),formatC(years.fit)]
iterations&lt;-50 # Toy example, consider at least 2000 iterations
fitRH=rh_stan(death = deathFR,exposure=exposureFR, forecast = 5, family = "poisson",
iter=iterations,chains=1)


</code></pre>

<hr>
<h2 id='sim_death_apc'>Simulation of death counts from the Age-Period-Cohort mortality model</h2><span id='topic+sim_death_apc'></span>

<h3>Description</h3>

<p>Simulation of death counts from the Age-Period-Cohort mortality model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_death_apc(a, k, g, phi, years, ages, exposure)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_death_apc_+3A_a">a</code></td>
<td>
<p>vector of age component</p>
</td></tr>
<tr><td><code id="sim_death_apc_+3A_k">k</code></td>
<td>
<p>vector of period component</p>
</td></tr>
<tr><td><code id="sim_death_apc_+3A_g">g</code></td>
<td>
<p>vector of cohort component</p>
</td></tr>
<tr><td><code id="sim_death_apc_+3A_phi">phi</code></td>
<td>
<p>dispersion parameter</p>
</td></tr>
<tr><td><code id="sim_death_apc_+3A_years">years</code></td>
<td>
<p>vector of calendar years</p>
</td></tr>
<tr><td><code id="sim_death_apc_+3A_ages">ages</code></td>
<td>
<p>vectors of ages</p>
</td></tr>
<tr><td><code id="sim_death_apc_+3A_exposure">exposure</code></td>
<td>
<p>matrix of exposure data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of death count
</p>

<hr>
<h2 id='sim_death_cbd'>Simulation of death counts from the CBD model</h2><span id='topic+sim_death_cbd'></span>

<h3>Description</h3>

<p>Simulation of death counts from the CBD model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_death_cbd(k, k2, phi, years, ages, exposure)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_death_cbd_+3A_k">k</code></td>
<td>
<p>first vector of period component</p>
</td></tr>
<tr><td><code id="sim_death_cbd_+3A_k2">k2</code></td>
<td>
<p>second vector of period component</p>
</td></tr>
<tr><td><code id="sim_death_cbd_+3A_phi">phi</code></td>
<td>
<p>dispersion parameter</p>
</td></tr>
<tr><td><code id="sim_death_cbd_+3A_years">years</code></td>
<td>
<p>vector of calendar years</p>
</td></tr>
<tr><td><code id="sim_death_cbd_+3A_ages">ages</code></td>
<td>
<p>vectors of ages</p>
</td></tr>
<tr><td><code id="sim_death_cbd_+3A_exposure">exposure</code></td>
<td>
<p>matrix of exposure data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of death count
</p>

<hr>
<h2 id='sim_death_lc'>Simulation of death counts from the Lee-Carter mortality model</h2><span id='topic+sim_death_lc'></span>

<h3>Description</h3>

<p>Simulation of death counts from the Lee-Carter mortality model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_death_lc(a, b, k, phi, exposure)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_death_lc_+3A_a">a</code></td>
<td>
<p>vector of age component</p>
</td></tr>
<tr><td><code id="sim_death_lc_+3A_b">b</code></td>
<td>
<p>vector of age/year component</p>
</td></tr>
<tr><td><code id="sim_death_lc_+3A_k">k</code></td>
<td>
<p>vector of year component</p>
</td></tr>
<tr><td><code id="sim_death_lc_+3A_phi">phi</code></td>
<td>
<p>dispersion parameter</p>
</td></tr>
<tr><td><code id="sim_death_lc_+3A_exposure">exposure</code></td>
<td>
<p>matrix of exposure data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of death count
</p>

<hr>
<h2 id='sim_death_m6'>Simulation of death counts from the M6 model</h2><span id='topic+sim_death_m6'></span>

<h3>Description</h3>

<p>Simulation of death counts from the M6 model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_death_m6(k, k2, g, phi, years, ages, exposure)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_death_m6_+3A_k">k</code></td>
<td>
<p>first vector of period component</p>
</td></tr>
<tr><td><code id="sim_death_m6_+3A_k2">k2</code></td>
<td>
<p>second vector of period component</p>
</td></tr>
<tr><td><code id="sim_death_m6_+3A_g">g</code></td>
<td>
<p>vector of cohort component</p>
</td></tr>
<tr><td><code id="sim_death_m6_+3A_phi">phi</code></td>
<td>
<p>dispersion parameter</p>
</td></tr>
<tr><td><code id="sim_death_m6_+3A_years">years</code></td>
<td>
<p>vector of calendar years</p>
</td></tr>
<tr><td><code id="sim_death_m6_+3A_ages">ages</code></td>
<td>
<p>vectors of ages</p>
</td></tr>
<tr><td><code id="sim_death_m6_+3A_exposure">exposure</code></td>
<td>
<p>matrix of exposure data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of death count
</p>

<hr>
<h2 id='sim_death_mix_cbd_rh'>Simulation of death counts from a hybrid model that averages the mortality
rates from the cbd and rh models</h2><span id='topic+sim_death_mix_cbd_rh'></span>

<h3>Description</h3>

<p>Simulation of death counts from a hybrid model that averages the mortality
rates from the cbd and rh models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_death_mix_cbd_rh(params_cbd, params_rh, years, ages, exposure, q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_death_mix_cbd_rh_+3A_params_cbd">params_cbd</code></td>
<td>
<p>named list that contains the parameters of the cbd model</p>
</td></tr>
<tr><td><code id="sim_death_mix_cbd_rh_+3A_params_rh">params_rh</code></td>
<td>
<p>named list that contains the parameters of the rh model</p>
</td></tr>
<tr><td><code id="sim_death_mix_cbd_rh_+3A_years">years</code></td>
<td>
<p>vector of calendar year</p>
</td></tr>
<tr><td><code id="sim_death_mix_cbd_rh_+3A_ages">ages</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="sim_death_mix_cbd_rh_+3A_exposure">exposure</code></td>
<td>
<p>matrix of exposure data</p>
</td></tr>
<tr><td><code id="sim_death_mix_cbd_rh_+3A_q">q</code></td>
<td>
<p>mixing parameter (0 &lt;- rh, 1 &lt;- cbd)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of death count
</p>

<hr>
<h2 id='sim_death_rh'>Simulation of death counts from the Renshaw-Haberman mortality model</h2><span id='topic+sim_death_rh'></span>

<h3>Description</h3>

<p>Simulation of death counts from the Renshaw-Haberman mortality model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_death_rh(a, b, k, g, phi, years, ages, exposure)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_death_rh_+3A_a">a</code></td>
<td>
<p>vector of age component</p>
</td></tr>
<tr><td><code id="sim_death_rh_+3A_b">b</code></td>
<td>
<p>vector of age/year component</p>
</td></tr>
<tr><td><code id="sim_death_rh_+3A_k">k</code></td>
<td>
<p>vector of period component</p>
</td></tr>
<tr><td><code id="sim_death_rh_+3A_g">g</code></td>
<td>
<p>vector of cohort component</p>
</td></tr>
<tr><td><code id="sim_death_rh_+3A_phi">phi</code></td>
<td>
<p>dispersion parameter</p>
</td></tr>
<tr><td><code id="sim_death_rh_+3A_years">years</code></td>
<td>
<p>vector of calendar years</p>
</td></tr>
<tr><td><code id="sim_death_rh_+3A_ages">ages</code></td>
<td>
<p>vectors of ages</p>
</td></tr>
<tr><td><code id="sim_death_rh_+3A_exposure">exposure</code></td>
<td>
<p>matrix of exposure data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of death count
</p>

<hr>
<h2 id='sim_mortality_data'>Simulation of mortality data from various models</h2><span id='topic+sim_mortality_data'></span>

<h3>Description</h3>

<p>Simulation of mortality data from various models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_mortality_data(a, k, k2, b, g, phi, years, ages, exposure, mortality_model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_mortality_data_+3A_a">a</code></td>
<td>
<p>vector of age component</p>
</td></tr>
<tr><td><code id="sim_mortality_data_+3A_k">k</code></td>
<td>
<p>first vector of time component</p>
</td></tr>
<tr><td><code id="sim_mortality_data_+3A_k2">k2</code></td>
<td>
<p>second vector of time component</p>
</td></tr>
<tr><td><code id="sim_mortality_data_+3A_b">b</code></td>
<td>
<p>vector of age/time component</p>
</td></tr>
<tr><td><code id="sim_mortality_data_+3A_g">g</code></td>
<td>
<p>vector of cohort component</p>
</td></tr>
<tr><td><code id="sim_mortality_data_+3A_phi">phi</code></td>
<td>
<p>dispersion parameter</p>
</td></tr>
<tr><td><code id="sim_mortality_data_+3A_years">years</code></td>
<td>
<p>vector of calendar year</p>
</td></tr>
<tr><td><code id="sim_mortality_data_+3A_ages">ages</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="sim_mortality_data_+3A_exposure">exposure</code></td>
<td>
<p>matrix of exposure</p>
</td></tr>
<tr><td><code id="sim_mortality_data_+3A_mortality_model">mortality_model</code></td>
<td>
<p>name of the mortality model that we simulate from</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of death counts
</p>

<hr>
<h2 id='StanMoMo-package'>The 'StanMoMo' package.</h2><span id='topic+StanMoMo-package'></span><span id='topic+StanMoMo'></span>

<h3>Description</h3>

<p>The <span class="pkg">StanMoMo</span> package performs Bayesian Mortality Modeling with
<strong>Stan</strong> for a variety of popular mortality models.
The current package supports the Lee-Carter model, the Renshaw-Haberman model,
the Age-Period-Cohort model, the Cairns-Blake-Dowd model and the M6 model. By a simple call, the user inputs deaths and exposures and the package outputs the MCMC simulations for each parameter,
the log likelihoods and predictions. Moreover, the package includes tools for model selection and Bayesian model averaging
by leave-future-out validation.
</p>


<h3>References</h3>

<p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.19.3. https://mc-stan.org
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
