<!DOCTYPE html><html lang="en"><head><title>Help for package depthTools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {depthTools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#centralPlot'><p> Plot of the central curves</p></a></li>
<li><a href='#classDS'><p>Distance to the Trimmed Mean Classification Method</p></a></li>
<li><a href='#classTAD'><p>Weighted Trimmed Mean Distance Classification Method</p></a></li>
<li><a href='#MBD'><p> Computation of the Modified Band Depth</p></a></li>
<li><a href='#prostate'><p>Gene Expression Data from Tumoral and Normal Prostate Samples and Labels</p></a></li>
<li><a href='#R.test'><p>Rank Test Based on the Modified Band Depth</p></a></li>
<li><a href='#scalecurve'><p> Computation and Representation of the Scale Curve</p></a></li>
<li><a href='#tmean'><p> Modified Band Depth-Based Alpha Trimmed Mean</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-05-23</td>
</tr>
<tr>
<td>Title:</td>
<td>Depth Tools Package</td>
</tr>
<tr>
<td>Author:</td>
<td>Sara Lopez-Pintado &lt;sl2929@columbia.edu&gt; and Aurora Torrente
        &lt;etorrent@est-econ.uc3m.es&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aurora Torrente &lt;etorrent@est-econ.uc3m.es&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.8.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of different statistical tools for the 
        description and analysis of gene expression data based on the 
        concept of data depth, namely, the scale curves for 
        visualizing the dispersion of one or various groups of samples 
        (e.g. types of tumors), a rank test to decide whether two groups 
        of samples come from a single distribution and two methods of
        supervised classification techniques, the DS and TAD methods. 
        All these techniques are based on the Modified Band Depth, which
        is a recent notion of depth with a low computational cost, what 
        renders it very appropriate for high dimensional data such as 
        gene expression data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-23 09:06:28 UTC; mtl</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-24 04:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='centralPlot'> Plot of the central curves </h2><span id='topic+centralPlot'></span>

<h3>Description</h3>

 
<p><code>centralPlot</code> plots distinctly the [np] most central observations, where [np] is the largest integer smaller than np, and the remaining most external ones, according to the modified band depth. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centralPlot(x, p=0.5,col.c='red',col.e='slategray',lty=c(1,3),gradient=FALSE,
            gradient.ramp=NULL,main=NULL,cex=1,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="centralPlot_+3A_x">x</code></td>
<td>
<p> a data matrix containing the observations (samples) by rows and the variables (genes) by columns. </p>
</td></tr>
<tr><td><code id="centralPlot_+3A_p">p</code></td>
<td>
<p> proportion of most central samples to be displayed.</p>
</td></tr>
<tr><td><code id="centralPlot_+3A_col.c">col.c</code></td>
<td>
<p> the color for the central samples, either as a character string or as a number. Ignored if gradient is TRUE.</p>
</td></tr> 
<tr><td><code id="centralPlot_+3A_col.e">col.e</code></td>
<td>
<p> the color for the external samples.</p>
</td></tr> 
<tr><td><code id="centralPlot_+3A_lty">lty</code></td>
<td>
<p> a vector of two components with the line type of the central and external curves.</p>
</td></tr>
<tr><td><code id="centralPlot_+3A_gradient">gradient</code></td>
<td>
<p> a logical value. If TRUE then the most central curves are plotted with colors according to the gradient.ramp parameter.</p>
</td></tr>
<tr><td><code id="centralPlot_+3A_gradient.ramp">gradient.ramp</code></td>
<td>
<p> an optional vector of two components containing the first and last colors of the palette used to color the most central curves.</p>
</td></tr>
<tr><td><code id="centralPlot_+3A_main">main</code></td>
<td>
<p> a character string for the plot title.</p>
</td></tr>
<tr><td><code id="centralPlot_+3A_cex">cex</code></td>
<td>
<p> the magnification to be used for the legend.</p>
</td></tr>
<tr><td><code id="centralPlot_+3A_...">...</code></td>
<td>
<p> further graphical parameters to be passed to 'plot'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>centralPlot</code> allows to visualise the most central curves within the dataset.</p>


<h3>Author(s)</h3>

<p> Sara Lopez-Pintado <a href="mailto:sl2929@columbia.edu">sl2929@columbia.edu</a> and 
Aurora Torrente <a href="mailto:etorrent@est-econ.uc3m.es">etorrent@est-econ.uc3m.es</a></p>


<h3>References</h3>

<p>Lopez-Pintado, S. <em>et al.</em> (2010). Robust depth-based tools for the analysis of gene expression data. <em>Biostatistics</em>, 11 (2), 254-264.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## simulated data
  set.seed(0)  
  x &lt;- matrix(rnorm(100),10,10)
  centralPlot(x,p=0.2)

  ## real data
  data(prostate)
  prost.x&lt;-prostate[,1:100]
  prost.y&lt;-prostate[,101]
  centralPlot(prost.x[prost.y==0,], p=0.5)  ## 50 % most central normal samples
  centralPlot(prost.x[prost.y==1,], p=0.5, gradient=TRUE, main='Tumor samples')  
                                            ## 50 % most central tumoral samples
</code></pre>

<hr>
<h2 id='classDS'>Distance to the Trimmed Mean Classification Method </h2><span id='topic+classDS'></span>

<h3>Description</h3>

<p>Implementation of the classification technique based on assigning each observation to the group that minimizes the distance of the observation to the trimmed mean of the group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classDS(xl,yl,xt,alpha=0.2)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="classDS_+3A_xl">xl</code></td>
<td>
<p>an <code>nxp</code> data matrix containing the observations (samples) from the learning set by rows and the variables (genes) by columns </p>
</td></tr>
<tr><td><code id="classDS_+3A_yl">yl</code></td>
<td>
<p>a vector of length <code>n</code> containing the class each observations in <code>xl</code> belongs to </p>
</td></tr>
<tr><td><code id="classDS_+3A_xt">xt</code></td>
<td>
<p>an <code>mxp</code> data matrix containing the observations (samples) from the test set by rows and the variables (genes) by columns </p>
</td></tr>
<tr><td><code id="classDS_+3A_alpha">alpha</code></td>
<td>
<p>the proportion of observations that are trimmed out when computing the mean. 0.2 by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This classification method proceeds by first computing the alpha trimmed mean corresponding to each group from the learning set, then computing the distance from a new observation to each trimmed mean. The new sample will then be assigned to the group that minimizes such distance. At the moment, only the Euclidean distance is implemented.</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pred</code></td>
<td>
<p>the vector of length <code>m</code> containing the predicted class of observations in matrix <code>xt</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Sara Lopez-Pintado <a href="mailto:sl2929@columbia.edu">sl2929@columbia.edu</a> and 
</p>
<p>Aurora Torrente <a href="mailto:etorrent@est-econ.uc3m.es">etorrent@est-econ.uc3m.es</a></p>


<h3>References</h3>

<p>Lopez-Pintado, S. <em>et al.</em> (2010). Robust depth-based tools for the analysis of gene expression data. <em>Biostatistics</em>, 11 (2), 254-264.
</p>


<h3>See Also</h3>

<p>classTAD</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## simulated data
  set.seed(10)
  xl &lt;- matrix(rnorm(100),10,10); xl[1:5,]&lt;-xl[1:5,]+1
  yl &lt;- c(rep(0,5),rep(1,5))
  xt &lt;- matrix(rnorm(100),10,10)
  classDS(xl,yl,xt)

  ## real data
  data(prostate)
  prost.x&lt;-prostate[,1:100]
  prost.y&lt;-prostate[,101]
  set.seed(1)
  learning &lt;- sample(50,40,replace=FALSE) 
  yl &lt;- prost.y[learning]   
  xl &lt;- prost.x[learning,]
  training &lt;- c(1:nrow(prost.x))[-learning]
  yt.real &lt;- prost.y[training]
  xt &lt;- prost.x[training,] 
  yt.estimated &lt;- classDS(xl,yl,xt)
  yt.real==yt.estimated
  
</code></pre>

<hr>
<h2 id='classTAD'>Weighted Trimmed Mean Distance Classification Method </h2><span id='topic+classTAD'></span>

<h3>Description</h3>

<p>Implementation of the classification technique based on assigning each observation to the group that minimizes the trimmed average distance of the given observation to the deepest points of each group in the learning set, weighted by the depth of these points in their own group. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classTAD(xl,yl,xt,alpha=0)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="classTAD_+3A_xl">xl</code></td>
<td>
<p>an <code>nxp</code> data matrix containing the observations (samples) from the learning set by rows and the variables (genes) by columns </p>
</td></tr>
<tr><td><code id="classTAD_+3A_yl">yl</code></td>
<td>
<p>a vector of length <code>n</code> containing the class each observations in <code>xl</code> belongs to </p>
</td></tr>
<tr><td><code id="classTAD_+3A_xt">xt</code></td>
<td>
<p>an <code>mxp</code> data matrix containing the observations (samples) from the test set by rows and the variables (genes) by columns </p>
</td></tr>
<tr><td><code id="classTAD_+3A_alpha">alpha</code></td>
<td>
<p>an optional value for the proportion of observations that are trimmed out when computing the mean. 0 by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method classifies a given observation <code>x</code> into one of <code>g</code> groups, of sizes <code>n1,...,ng</code>, but taking into account only the <code>m=min{n1,...,ng}</code> deepest elements of each group in the learning set. Additionally, this number can be reduced in a proportion <code>alpha</code>. The distance of <code>x</code> to these <code>m</code> elements is averaged and weighted with the depth of each element with respect to its own group.</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pred</code></td>
<td>
<p>the vector of length <code>m</code> containing the predicted class of observations in matrix <code>xt</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Sara Lopez-Pintado <a href="mailto:sl2929@columbia.edu">sl2929@columbia.edu</a> and 
</p>
<p>Aurora Torrente <a href="mailto:etorrent@est-econ.uc3m.es">etorrent@est-econ.uc3m.es</a></p>


<h3>References</h3>

<p>Lopez-Pintado, S. <em>et al.</em> (2010). Robust depth-based tools for the analysis of gene expression data. <em>Biostatistics</em>, 11 (2), 254-264.
</p>


<h3>See Also</h3>

<p>classDS</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## simulated data
  set.seed(0)
  xl &lt;- matrix(rnorm(100),10,10); xl[1:5,]&lt;-xl[1:5,]+1
  yl &lt;- c(rep(0,5),rep(1,5))
  xt &lt;- matrix(rnorm(100),10,10)
  classTAD(xl,yl,xt)
  
  ## real data
  data(prostate)
  prost.x&lt;-prostate[,1:100]
  prost.y&lt;-prostate[,101]
  set.seed(0)
  learning &lt;- sample(50,40,replace=FALSE) 
  yl &lt;- prost.y[learning]   
  xl &lt;- prost.x[learning,]
  training &lt;- c(1:nrow(prost.x))[-learning]
  yt.real &lt;- prost.y[training]
  xt &lt;- prost.x[training,] 
  yt.estimated &lt;- classTAD(xl,yl,xt)
  yt.real==yt.estimated
</code></pre>

<hr>
<h2 id='MBD'> Computation of the Modified Band Depth </h2><span id='topic+MBD'></span>

<h3>Description</h3>

 
<p><code>MBD</code> computes the modified band depth of each observation within a sample which either includes or not the given observation.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MBD(x, xRef=NULL, plotting=TRUE, grayscale=FALSE, band=FALSE, band.limits=NULL, 
     lty=1, lwd=2, col=NULL, cold=NULL, colRef=NULL, ylim=NULL, cex=1,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MBD_+3A_x">x</code></td>
<td>
<p> a data matrix containing the observations (samples) by rows and the variables (genes) by columns.</p>
</td></tr>
<tr><td><code id="MBD_+3A_xref">xRef</code></td>
<td>
<p> an optional data matrix containing the sample of observations with respect to the modified band depth is computed. If unprovided, then all elements in matrix x are taken into account to compute the depth.</p>
</td></tr>
<tr><td><code id="MBD_+3A_plotting">plotting</code></td>
<td>
<p> logical value. If TRUE then the observations in the data matrix x are plotted, in parallel coordinates.</p>
</td></tr>
<tr><td><code id="MBD_+3A_grayscale">grayscale</code></td>
<td>
<p> logical value. If TRUE then a different color from a given color palette is assigned to each sample, according to its depth.</p>
</td></tr>
<tr><td><code id="MBD_+3A_band">band</code></td>
<td>
<p> logical value. If TRUE then the convex hull (a polygon) of the bands formed by the percentage p of most internal samples are represented. Different values of p can be set with the argument band.limits.</p>
</td></tr>
<tr><td><code id="MBD_+3A_band.limits">band.limits</code></td>
<td>
<p> a vector of values in the range 0-1 giving the proportion p of most central curves to be considered to form a band.</p>
</td></tr>
<tr><td><code id="MBD_+3A_lty">lty</code></td>
<td>
<p> the line type for drawing both the data set and the reference set.</p>
</td></tr>
<tr><td><code id="MBD_+3A_lwd">lwd</code></td>
<td>
<p> the line width for both the data set and the reference set. The thickness of the deepest point is increased by 0.5 with respect to the thickest line drawn.</p>
</td></tr>
<tr><td><code id="MBD_+3A_col">col</code></td>
<td>
<p> the color specification for the data set, except for the deepest point. If grayscale is true and no color is specified, then the depth of each point is represented in grayscale colors, with higher intensities corresponding to smaller depths.</p>
</td></tr>
<tr><td><code id="MBD_+3A_cold">cold</code></td>
<td>
<p> the color used to plot the deepest point.</p>
</td></tr>
<tr><td><code id="MBD_+3A_colref">colRef</code></td>
<td>
<p> the color specification for the reference data set.</p>
</td></tr>
<tr><td><code id="MBD_+3A_ylim">ylim</code></td>
<td>
<p> numeric vector giving the y coordinates range.</p>
</td></tr>
<tr><td><code id="MBD_+3A_cex">cex</code></td>
<td>
<p> the magnification used for the legend.</p>
</td></tr>
<tr><td><code id="MBD_+3A_...">...</code></td>
<td>
<p>  graphical parameters (see 'par') and any further arguments of 'plot'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The modified band depth is the average proportion of components of the considered observation that are between the corresponding components of all possible pairs of elements in the sample with respect to the depth is computed. The depth is efficiently obtained using the multiplicity of each value in the data matrix ordered by columns rather than exhaustively searching for all pairs of samples.</p>


<h3>Value</h3>

<p>a list containing: 
</p>
<table role = "presentation">
<tr><td><code>ordering</code></td>
<td>
<p>vector giving the ordering of the samples according to their corresponding depths </p>
</td></tr>
<tr><td><code>MBD</code></td>
<td>
<p>vector of the computed depths </p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Sara Lopez-Pintado <a href="mailto:sl2929@columbia.edu">sl2929@columbia.edu</a> and 
</p>
<p>Aurora Torrente <a href="mailto:etorrent@est-econ.uc3m.es">etorrent@est-econ.uc3m.es</a>
</p>


<h3>References</h3>

<p>Lopez-Pintado, S. and Romo, J. (2009). On the concept of depth for functional data. <em>Journal of the American Statistical Association</em>, 104, 486-503.
</p>
<p>Lopez-Pintado, S. <em>et al.</em> (2010). Robust depth-based tools for the analysis of gene expression data. <em>Biostatistics</em>, 11 (2), 254-264.
</p>


<h3>See Also</h3>

<p>scalecurve, R.test</p>


<h3>Examples</h3>

<pre><code class='language-R'>## MBD of all elements within a sample
  
  ## simulated data
  set.seed(0)
  x &lt;- matrix(rnorm(1000),100,10)
  x.depths.1&lt;-MBD(x,plotting=TRUE)
 
  ## real data
  data(prostate)
  prost.x&lt;-prostate[,1:100]
  prost.y&lt;-prostate[,101]
  normal.depths&lt;-MBD(prost.x[prost.y==0,],plotting=TRUE,
                     main="Normal samples")  
  tumor.depths&lt;-MBD(prost.x[prost.y==1,],plotting=TRUE, band=TRUE,
                    band.limits=c(.33,.67,1),grayscale=TRUE)



## MBD of a vector with respect to a set of observations

  ## simulated data
  set.seed(0)
  v &lt;- matrix(c(2,1,0,3,-2,1,2,1,0,3,-2,1,rnorm(3)),3,5)
  xR &lt;- matrix(rnorm(100),20,5)
  depths&lt;-MBD(v,xR,plotting=TRUE)

  # MBD of normal prostate samples with respect to tumoral ones
  normal.depths&lt;-MBD(prost.x[prost.y==0,],prost.x[prost.y==1,],
                     plotting=TRUE)
  normal.depths&lt;-MBD(prost.x[prost.y==0,],prost.x[prost.y==1,],plotting=TRUE, 
                    band=TRUE,band.limits=c(.33,.67,1),grayscale=TRUE)

</code></pre>

<hr>
<h2 id='prostate'>Gene Expression Data from Tumoral and Normal Prostate Samples and Labels</h2><span id='topic+prostate'></span>

<h3>Description</h3>

<p>Normalized subset from Singh et al. (2002) data included in the <code>prostate</code> dataset. The raw data comprise the expression of 52 tumoral and 50 non-tumoral prostate samples, obtained using the Affymetrix technology. The data were preprocessed by setting thresholds at 10 and 16000 units, excluding genes whose expression varied less than 5-fold relatively or less than 500 units absolutely between the sample, applying a base 10 logarithmic transformation, and standardising each experiment to zero mean and unit variance across the genes. The 100 most variable genes were selected following the B/W criterion (Dudoit et al. (2002)) and a random selection of 25 normal samples and 25 tumour samples was performed.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(prostate)</code></pre>


<h3>Format</h3>

<p>a 50x101 matrix containing in the first 100 columns the gene expression data of 25 plus 25 randomly selected tumor and normal prostate samples at the 100 most variable genes, selected by the B/W criterion; the last column contains the sample type: 0=normal, 1=tumor.
</p>


<h3>Source</h3>

<p>The data are described in Singh et al. (2002).</p>


<h3>References</h3>

<p> Singh <em>et al</em>. (2002). Gene expression correlates of clinincal prostate cancer behavior, <em>Cancer cell</em>, 1 (2), 203-209.
</p>
<p>Dudoit <em>et al</em>. (2002). Comparison of discrimination methods for the classification of tumors using gene expression data, <em>Journal of the American Statistical Association</em>, 97 (457), 77-87.
</p>

<hr>
<h2 id='R.test'>Rank Test Based on the Modified Band Depth </h2><span id='topic+R.test'></span>

<h3>Description</h3>

 
<p><code>R.test</code> performs the rank test based on the modified band depth, to decide whether two samples come from a single parent distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R.test(x,y,n,m,seed=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="R.test_+3A_x">x</code></td>
<td>
<p>a data matrix containing the observations (samples) by rows and the variables (genes) by columns from the first population </p>
</td></tr>
<tr><td><code id="R.test_+3A_y">y</code></td>
<td>
<p>a data matrix containing the observations (samples) by rows and the variables (genes) by columns from the second population </p>
</td></tr>
<tr><td><code id="R.test_+3A_n">n</code></td>
<td>
<p>size of the first sample (less or equal than the number of rows in <code>x</code>)</p>
</td></tr>
<tr><td><code id="R.test_+3A_m">m</code></td>
<td>
<p>size of the second sample (less or equal than the number of rows in <code>y</code>)</p>
</td></tr>
<tr><td><code id="R.test_+3A_seed">seed</code></td>
<td>
<p>seed to inizialize the random number generation. 0 by default</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a population P from which a sample of <code>n</code> vectors is drawn, and another population P' from which a second sample of <code>m</code> vectors is obtained, assume there is a third reference sample (from the same population as the largest sample), whose size is also larger than <code>n</code> and <code>m</code>. <code>R.test</code> identifies the largest sample as the one to be split into test and reference samples and verifies if there are enough observations to run the test. Then, the rank test calculates the proportions R and R' of elements from the reference sample whose depths are less or equal than those from the other samples, relative to the reference one, respectively, and order these values from smallest to highest, giving them a rank from 1 to <code>n+m</code>. The statistic sum of the ranks of values R' (from the second population) has the distribution of a sum of m elements randomly drawn from 1 to <code>n+m</code> without replacement. </p>


<h3>Value</h3>

<p>a list containing: 
</p>
<table role = "presentation">
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the rank test </p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the statistic W of the rank test </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Sara Lopez-Pintado <a href="mailto:sl2929@columbia.edu">sl2929@columbia.edu</a> and 
</p>
<p>Aurora Torrente <a href="mailto:etorrent@est-econ.uc3m.es">etorrent@est-econ.uc3m.es</a></p>


<h3>References</h3>

<p>Lopez-Pintado, S. <em>et al.</em> (2010). Robust depth-based tools for the analysis of gene expression data. <em>Biostatistics</em>, 11 (2), 254-264.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Rank test for samples from the same population
  x &lt;- matrix(rnorm(100),10,10)
  R.test(x,x,4,4)$p.value

  ## real data
  data(prostate)
  prost.x&lt;-prostate[,1:100]
  prost.y&lt;-prostate[,101]
  normal&lt;-prost.x[prost.y==0,]
  R.test(normal,normal,10,10)$p.value


##  Rank test for samples from different populations
  x &lt;- matrix(rnorm(100),10,10)
  y &lt;- matrix(rnorm(100,5),10,10)
  R.test(x,y,4,4)$p.value

  ## real data
  tumor&lt;-prost.x[prost.y==1,]
  R.test(normal,tumor,10,10)$p.value


</code></pre>

<hr>
<h2 id='scalecurve'> Computation and Representation of the Scale Curve </h2><span id='topic+scalecurve'></span>

<h3>Description</h3>

 
<p><code>scalecurve</code> computes the scale curve of a given group, based on the modified band depth, at a given value p as the area of the band delimited by the [np] most central observations, where [np] is the largest integer smaller than np.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scalecurve(x,y=NULL,xlab="p",ylab="A(p)",main="Scale curve",lwd=2,
           ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scalecurve_+3A_x">x</code></td>
<td>
<p> a data matrix containing the observations (samples) by rows and the variables (genes) by columns </p>
</td></tr>
<tr><td><code id="scalecurve_+3A_y">y</code></td>
<td>
<p> an optional vector (numeric or factor) of length equal to the number of rows in <code>x</code>, containing the class of each observation. If unprovided, then all the elements in <code>x</code> are assumed to belong to a single class </p>
</td></tr>
<tr><td><code id="scalecurve_+3A_xlab">xlab</code></td>
<td>
<p> label in the x axis</p>
</td></tr> 
<tr><td><code id="scalecurve_+3A_ylab">ylab</code></td>
<td>
<p> label in the y axis </p>
</td></tr>
<tr><td><code id="scalecurve_+3A_main">main</code></td>
<td>
<p> plot title</p>
</td></tr>
<tr><td><code id="scalecurve_+3A_lwd">lwd</code></td>
<td>
<p> line widths for the corresponding scale curve(s)</p>
</td></tr>
<tr><td><code id="scalecurve_+3A_...">...</code></td>
<td>
<p> graphical parameters to be passed to 'plot'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The scale curve measures the increase in the area of the band determined by the fraction p most central curves, where p moves from 0 to 1, thus providing a measure of the sample dispersion. If the data set is represented in parallel coordinates, then the area is computed using the trapezoid formula.</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>r</code></td>
<td>
<p>the value of the scale curve at equidistant values of p, determined by the number of observation within each class. If <code>y</code> is not provided, then <code>r</code> is a vector, otherwise is a list with as many components as classes described by <code>y</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Sara Lopez-Pintado <a href="mailto:sl2929@columbia.edu">sl2929@columbia.edu</a> and 
</p>
<p>Aurora Torrente <a href="mailto:etorrent@est-econ.uc3m.es">etorrent@est-econ.uc3m.es</a></p>


<h3>References</h3>

<p>Lopez-Pintado, S. <em>et al.</em> (2010). Robust depth-based tools for the analysis of gene expression data. <em>Biostatistics</em>, 11 (2), 254-264.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## scale curve of a single data set
  ## simulated data
  set.seed(0)  
  x &lt;- matrix(rnorm(100),10,10)
  scalecurve(x)

  ## real data
  data(prostate)
  prost.x&lt;-prostate[,1:100]
  prost.y&lt;-prostate[,101]
  scalecurve(prost.x[prost.y==0,])  ## scale curve of normal samples
  scalecurve(prost.x[prost.y==1,])  ## scale curve of tumoral samples
  
## scalecurve of different groups 
  ## simulated data
  x &lt;- matrix(rnorm(100),10,10)
  y &lt;- c(rep("tumoral",5),rep("normal",5))
  scalecurve(x,y)

  ## real data
  labels&lt;-prost.y 
  labels[prost.y==0]&lt;-"normal"; labels[prost.y==1]&lt;-"tumoral"
  scalecurve(prost.x,labels)  
</code></pre>

<hr>
<h2 id='tmean'> Modified Band Depth-Based Alpha Trimmed Mean </h2><span id='topic+tmean'></span>

<h3>Description</h3>

 
<p><code>tmean</code> computes the mean of the deepest observations within the sample, their depths given by the Modified Band Depth, trimming out the proportion <code>alpha</code> of the outest observations. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tmean(x,alpha=0.2,plotting=FALSE,new=TRUE,cols=c(1,4,8),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tmean_+3A_x">x</code></td>
<td>
<p> an <code>nxd</code> data matrix containing the observations (samples) by rows and the variables (genes) by columns </p>
</td></tr>
<tr><td><code id="tmean_+3A_alpha">alpha</code></td>
<td>
<p> the proportion of observations that are trimmed out when computing the mean. 0.2 by default.</p>
</td></tr>
<tr><td><code id="tmean_+3A_plotting">plotting</code></td>
<td>
<p> a logical value. If TRUE then a plot is built. If alpha has length 1, then the trimmed mean, the samples used for its computation and the discarded ones are plotted with different colors, according to the values of cols, below. If alpha has length greater than 1, then a plot with several trimmed means is constructed. The first element in cols is used to determine a color palette, from cols[1] (for the smallest value in alpha) to 'gray' (for the greatest value in alpha).</p>
</td></tr>
<tr><td><code id="tmean_+3A_new">new</code></td>
<td>
<p> a logical value. If alpha has length 1 or plotting is FALSE, then it is ignored. If TRUE, a new plot is started; otherwise, the new trimmed means are added to the existing plot.</p>
</td></tr>
<tr><td><code id="tmean_+3A_cols">cols</code></td>
<td>
<p> a vector of length 3 containing, in the following ordering, the colors for depicting the trimmed mean, the trimmed collection of samples and the samples which are not taken into account in the computation of the trimmed mean.</p>
</td></tr>
<tr><td><code id="tmean_+3A_...">...</code></td>
<td>
<p> graphical parameters (see 'par') and any further arguments of 'plot'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rows of matrix <code>x</code>, corresponding to genes, are ordered from center outward, that is, starting with the deepest one(s) and ending with the less deep one(s), according to MBD. The alpha-trimmed mean is computed by first removing the proportion <code>alpha</code> of less deep points, and then computing the component-wise average of the remaining observations.</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>tm</code></td>
<td>
<p>the alpha-trimmed mean vector of length p of matrix <code>x</code></p>
</td></tr>
<tr><td><code>tm.x</code></td>
<td>
<p>the deespest points of x after removing the proportion <code>alpha</code> of less deep points </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Sara Lopez-Pintado <a href="mailto:sl2929@columbia.edu">sl2929@columbia.edu</a> and 
</p>
<p>Aurora Torrente <a href="mailto:etorrent@est-econ.uc3m.es">etorrent@est-econ.uc3m.es</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(50)
  x &lt;- matrix(rnorm(100),10,10)
  m.x&lt;-apply(x,2,mean)
  t.x&lt;-tmean(x,plotting=TRUE, lty=1)

  t.x.seq &lt;- tmean(x,alpha=c(0,0.25,0.5,0.75),plotting=TRUE, lty=1, cols=2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
