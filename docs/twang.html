<!DOCTYPE html><html><head><title>Help for package twang</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {twang}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AOD'><p>Subset of Alcohol and Other Drug treatment data</p></a></li>
<li><a href='#bal.stat'><p>Calculate weighted balance statistics</p></a></li>
<li><a href='#bal.table'><p>Compute the balance table.</p></a></li>
<li><a href='#boxplot.mnps'><p>Boxplot for 'mnps' objects</p></a></li>
<li><a href='#boxplot.ps'><p>Boxplot for 'ps' objects</p></a></li>
<li><a href='#desc.wts'><p>Diagnosis of weights</p></a></li>
<li><a href='#displayPlots'><p>Display plots</p></a></li>
<li><a href='#dx.wts'><p>Compute diagnostics assessing covariates balance.</p></a></li>
<li><a href='#egsingle'><p>US Sustaining Effects study</p></a></li>
<li><a href='#get.weights'><p>Extract propensity score weights.</p></a></li>
<li><a href='#get.weights.num'><p>Get numerators to stabilize propensity score weights for 'iptw' fits.</p></a></li>
<li><a href='#get.weights.unstab'><p>Extract unstabilized propensity score weights for 'iptw' fits</p></a></li>
<li><a href='#iptw'><p>Inverse probability of treatment weighting for marginal structural models.</p></a></li>
<li><a href='#iptwExLong'><p>Example data for iptw function (long version)</p></a></li>
<li><a href='#iptwExWide'><p>Example data for iptw function (wide version)</p></a></li>
<li><a href='#lalonde'><p>Lalonde's National Supported Work Demonstration data</p></a></li>
<li><a href='#lindner'><p>Lindner Center data on 996 PCI patients analyzed by Kereiakes et al. (2000)</p></a></li>
<li><a href='#means.table'><p>Extract table of means from an'mnps' object</p></a></li>
<li><a href='#mnIptwExLong'><p>Example data for iptw function (long version, more than two treatments).</p></a></li>
<li><a href='#mnIptwExWide'><p>Example data for iptw function (wide version, more than two treatments)</p></a></li>
<li><a href='#mnps'><p>Propensity score estimation for multiple treatments</p></a></li>
<li><a href='#plot.dxwts'><p>Plot <code>dxwts</code></p></a></li>
<li><a href='#plot.iptw'><p>Plots for <code>iptw</code> objects</p></a></li>
<li><a href='#plot.mniptw'><p>Plot <code>mniptw</code></p></a></li>
<li><a href='#plot.mnps'><p>Plots for <code>mnps</code> objects</p></a></li>
<li><a href='#plot.ps'><p>Plots for <code>ps</code> objects</p></a></li>
<li><a href='#print.dxwts'><p>Default print statement for <code>dxwts</code> class</p></a></li>
<li><a href='#print.iptw'><p>Default print statement for <code>iptw</code> class</p></a></li>
<li><a href='#print.mniptw'><p>Default print statement for <code>mniptw</code> class</p></a></li>
<li><a href='#print.mnps'><p>Default print statement for <code>mnps</code> class</p></a></li>
<li><a href='#print.ps'><p>Default print statement for <code>ps</code> class</p></a></li>
<li><a href='#print.summary.iptw'><p>Produces a summary table for <code>iptw</code> object</p></a></li>
<li><a href='#print.summary.mniptw'><p>Produces a summary table for <code>mniptw</code> object</p></a></li>
<li><a href='#print.summary.mnps'><p>Produces a summary table for <code>mnps</code> object</p></a></li>
<li><a href='#print.summary.ps'><p>Produces a summary table for <code>ps</code> object</p></a></li>
<li><a href='#ps'><p>Gradient boosted propensity score estimation</p></a></li>
<li><a href='#raceprofiling'><p>Traffic stop data</p></a></li>
<li><a href='#sensitivity'><p>Function to run sensitivity analysis described in Ridgeway's paper;</p>
currently works only for ATT.</a></li>
<li><a href='#stop.methods'><p>Stop methods (e.g. &quot;es.mean&quot;, &quot;ks.mean&quot;, etc.) object, used only for backward compatibility</p></a></li>
<li><a href='#summary.iptw'><p>Summarize a <code>iptw</code> object</p></a></li>
<li><a href='#summary.mniptw'><p>Summarize a <code>mniptw</code> object</p></a></li>
<li><a href='#summary.mnps'><p>Summarize a <code>mnps</code> object</p></a></li>
<li><a href='#summary.ps'><p>Summarize a <code>ps</code> object</p></a></li>
<li><a href='#twang-package'><p>twang: Toolkit for Weighting and Analysis of Nonequivalent Groups</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-28</td>
</tr>
<tr>
<td>Title:</td>
<td>Toolkit for Weighting and Analysis of Nonequivalent Groups</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew Cefalu, Greg Ridgeway, Dan McCaffrey, Andrew Morral, Beth Ann Griffin, and Lane Burgette</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lane Burgette &lt;burgette@rand.org&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>gbm (&ge; 1.5-3), survey, xtable, lattice, latticeExtra,
MatrixModels, data.table, ggplot2, xgboost</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for propensity score
        estimating and weighting, nonresponse weighting, and diagnosis
        of the weights.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-05 16:57:17 UTC; burgette</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-06 00:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AOD'>Subset of Alcohol and Other Drug treatment data</h2><span id='topic+AOD'></span>

<h3>Description</h3>

<p>A small subset of the data from McCaffrey et al. (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AOD)</code></pre>


<h3>Format</h3>

<p>A data frame with 600 observations on the following 10 variables.
</p>

<dl>
<dt><code>treat</code></dt><dd><p>Treatment that each study subject received. Either community, metcbt5, or scy. </p>
</dd>
<dt><code>suf12</code></dt><dd><p>outcome variable, substance use frequency at 12 month follow-up</p>
</dd>
<dt><code>illact</code></dt><dd><p>covariate, illicit activities scale</p>
</dd>
<dt><code>crimjust</code></dt><dd><p>covariate, criminal justice involvement</p>
</dd>
<dt><code>subprob</code></dt><dd><p>covariate, substance use problem scale</p>
</dd>
<dt><code>subdep</code></dt><dd><p>covariate, substance use dependence scale</p>
</dd>
<dt><code>white</code></dt><dd><p>1 if non-Hispanic white, 0 otherwise</p>
</dd>
</dl>



<h3>References</h3>

<p>McCaffrey, DF, BA Griffin, D Almirall, ME Slaughter, R Ramchand and LF Burgette (2013). A tutorial on 
propensity score estimation for multiple treatments using generalized boosted models.  Statistics in Medicine.
</p>

<hr>
<h2 id='bal.stat'>Calculate weighted balance statistics</h2><span id='topic+bal.stat'></span>

<h3>Description</h3>

<p>'bal.stat' compares the treatment and control subjects by means, standard 
deviations, effect size, and KS statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bal.stat(
  data,
  vars = NULL,
  treat.var,
  w.all,
  sampw,
  get.means = TRUE,
  get.ks = TRUE,
  na.action = "level",
  estimand,
  multinom,
  fillNAs = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bal.stat_+3A_data">data</code></td>
<td>
<p>A data frame containing the data</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_vars">vars</code></td>
<td>
<p>A vector of character strings with the names of the variables 
on which the function will assess the balance</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_treat.var">treat.var</code></td>
<td>
<p>The name of the treatment variable</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_w.all">w.all</code></td>
<td>
<p>Oobservation weights (e.g. propensity score weights, sampling 
weights, or both)</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_sampw">sampw</code></td>
<td>
<p>Sampling weights. These are passed in addition to 'w.all' because
the &quot;unweighted&quot; results shoud be adjusted for sample weights (though not propensity
score weights).</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_get.means">get.means</code></td>
<td>
<p>logical. If 'TRUE' then 'bal.stat' will compute means
and variances</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_get.ks">get.ks</code></td>
<td>
<p>logical. If 'TRUE' then 'bal.stat' will compute KS statistics</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_na.action">na.action</code></td>
<td>
<p>A character string indicating how 'bal.stat' should 
handle missing values. Current options are &quot;level&quot;, &quot;exclude&quot;, or &quot;lowest&quot;</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_estimand">estimand</code></td>
<td>
<p>Either &quot;ATT&quot; or &quot;ATE&quot;</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_multinom">multinom</code></td>
<td>
<p>logical. 'TRUE' if used for multinomial propensity scores.</p>
</td></tr>
<tr><td><code id="bal.stat_+3A_fillnas">fillNAs</code></td>
<td>
<p>logical. If 'TRUE', fills in zeros for missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'bal.stat' calls  auxiliary functions for each variable and assembles
the results in a table.
</p>


<h3>Value</h3>

<p>'get.means' and 'get.ks' manipulate the inclusion of certain 
columns in the returned result.
</p>


<h3>References</h3>

<p>Dan McCaffrey, G. Ridgeway, Andrew Morral (2004). &quot;Propensity
Score Estimation with Boosted Regression for Evaluating Adolescent
Substance Abuse Treatment&quot;, *Psychological Methods* 9(4):403-425.
</p>


<h3>See Also</h3>

<p>The example for [ps] contains an example of the use of [bal.table]
</p>

<hr>
<h2 id='bal.table'>Compute the balance table.</h2><span id='topic+bal.table'></span>

<h3>Description</h3>

<p>Extract the balance table from <a href="#topic+ps">ps</a>, <a href="#topic+dx.wts">dx.wts</a>, and <a href="#topic+mnps">mnps</a> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bal.table(
  x,
  digits = 3,
  collapse.to = c("pair", "covariate", "stop.method")[1],
  subset.var = NULL,
  subset.treat = NULL,
  subset.stop.method = NULL,
  es.cutoff = 0,
  ks.cutoff = 0,
  p.cutoff = 1,
  ks.p.cutoff = 1,
  timePeriods = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bal.table_+3A_x">x</code></td>
<td>
<p>A <a href="#topic+ps">ps</a> or <a href="#topic+dx.wts">dx.wts</a> object.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_digits">digits</code></td>
<td>
<p>The number of digits that the numerical entries
should be rounded to. Default: 3.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_collapse.to">collapse.to</code></td>
<td>
<p>For <code>mnps</code> ATE objects, the comparisons
can be given for all pairs (default), summarized by pre-treatment
covariate and stop.method, or as a single summary for each stop.method.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_subset.var">subset.var</code></td>
<td>
<p>Eliminate all but a specified subset of covariates.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_subset.treat">subset.treat</code></td>
<td>
<p>Subset to either all pairs that include a specified
treatment or a single pair of treatments.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_subset.stop.method">subset.stop.method</code></td>
<td>
<p>Subset to either all pairs that include a specified
treatment or a single pair of treatments.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_es.cutoff">es.cutoff</code></td>
<td>
<p>Subsets to comparisons with absolute ES values bigger than
<code>es.cutoff</code>. Default: 0.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_ks.cutoff">ks.cutoff</code></td>
<td>
<p>Subsets to comparisons with KS values bigger than
<code>ks.cutoff</code>. Default: 0.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_p.cutoff">p.cutoff</code></td>
<td>
<p>Subsets to comparisons with t- or chi-squared p-values
no bigger than <code>p.cutoff</code>. Default: 1.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_ks.p.cutoff">ks.p.cutoff</code></td>
<td>
<p>Subsets to comparisons with t- or chi-squared p-values
no bigger than <code>p.cutoff</code>. Default: 1.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_timeperiods">timePeriods</code></td>
<td>
<p>Used to subset times for iptw fits.</p>
</td></tr>
<tr><td><code id="bal.table_+3A_...">...</code></td>
<td>
<p>Additional arugments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bal.table</code> is a generic function for extracting balance
tables from <a href="#topic+ps">ps</a> and <a href="#topic+dx.wts">dx.wts</a> objects. These objects
usually have several sets of candidate weights, one for an unweighted
analysis and perhaps several <code>stop.methods</code>. <code>bal.table</code>
will return a table for each set of weights combined into a list. Each list
component will be named as given in the <code>x</code>, usually the name of the
<code>stop.method</code>. The balance table labeled &ldquo;unw&rdquo; indicates the
unweighted analysis.
</p>


<h3>Value</h3>

<p>Returns a data frame containing the balance information.
</p>

<ul>
<li> <p><code>tx.mn</code> The mean of the treatment group.
</p>
</li>
<li> <p><code>tx.sd</code> The standard deviation of the treatment group.
</p>
</li>
<li> <p><code>ct.mn</code> The mean of the control group.
</p>
</li>
<li> <p><code>ct.sd</code> The standard deviation of the control group.
</p>
</li>
<li> <p><code>std.eff.sz</code> The standardized effect size, (tx.mn-ct.mn)/tx.sd.
If tx.sd is small or 0, the standardized effect size can be large or INF.
Therefore, standardized effect sizes greater than 500 are set to NA.
</p>
</li>
<li> <p><code>stat</code> The t-statistic for numeric variables and the chi-square
statistic for continuous variables.
</p>
</li>
<li> <p><code>p</code> The p-value for the test associated with <code>stat</code>
<code>ks</code> The KS statistic.
</p>
</li>
<li> <p><code>ks.pval</code> The KS p-value computed using the analytic approximation,
which does not necessarily work well with a lot of ties.
</p>
</li></ul>


<hr>
<h2 id='boxplot.mnps'>Boxplot for 'mnps' objects</h2><span id='topic+boxplot.mnps'></span>

<h3>Description</h3>

<p>This function produces a collection of diagnostic plots for mnps objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mnps'
boxplot(
  x,
  stop.method = NULL,
  color = TRUE,
  figureRows = NULL,
  singlePlot = NULL,
  multiPage = FALSE,
  time = NULL,
  print = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxplot.mnps_+3A_x">x</code></td>
<td>
<p>A 'ps' object</p>
</td></tr>
<tr><td><code id="boxplot.mnps_+3A_stop.method">stop.method</code></td>
<td>
<p>Only 1 'stop.method' can be presented at a time for 'mnps' objects. 
Use a numeric indicator of which 'stop.method' (among those specified when fitting
the 'mnps' object) should be used.</p>
</td></tr>
<tr><td><code id="boxplot.mnps_+3A_color">color</code></td>
<td>
<p>If 'FALSE', a grayscale figure will be returned.</p>
</td></tr>
<tr><td><code id="boxplot.mnps_+3A_figurerows">figureRows</code></td>
<td>
<p>The number of rows in the figure. Defaults to the number of panels.</p>
</td></tr>
<tr><td><code id="boxplot.mnps_+3A_singleplot">singlePlot</code></td>
<td>
<p>If multiple sets of boxplots are produced, 'singlePlot' can be used
to select only one. For example, 'singlePlot = 2' would return only the second set
of boxplots.</p>
</td></tr>
<tr><td><code id="boxplot.mnps_+3A_multipage">multiPage</code></td>
<td>
<p>When multiple frames of a figure are produced, 'multiPage = TRUE' will
print each frame on a different page. This is intended for situations where the graphical
output is being saved to a file.</p>
</td></tr>
<tr><td><code id="boxplot.mnps_+3A_time">time</code></td>
<td>
<p>For use with iptw fits.</p>
</td></tr>
<tr><td><code id="boxplot.mnps_+3A_print">print</code></td>
<td>
<p>If 'FALSE', the figure is returned but not printed.</p>
</td></tr>
<tr><td><code id="boxplot.mnps_+3A_...">...</code></td>
<td>
<p>Additional arguments that are passed to boxplot function, which may bepassed to
the underlying 'lattice' package plotting functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces lattice-style graphics of diagnostic plots.
</p>


<h3>References</h3>

<p>Dan McCaffrey, G. Ridgeway, Andrew Morral (2004). &quot;Propensity
Score Estimation with Boosted Regression for Evaluating Adolescent
Substance Abuse Treatment&quot;, *Psychological Methods* 9(4):403-425.
</p>


<h3>See Also</h3>

<p>[mnps]
</p>

<hr>
<h2 id='boxplot.ps'>Boxplot for 'ps' objects</h2><span id='topic+boxplot.ps'></span>

<h3>Description</h3>

<p>This function produces a collection of diagnostic plots for ps objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ps'
boxplot(x, subset = NULL, color = TRUE, time = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxplot.ps_+3A_x">x</code></td>
<td>
<p>A 'ps' object</p>
</td></tr>
<tr><td><code id="boxplot.ps_+3A_subset">subset</code></td>
<td>
<p>If multiple 'stop.method' rules were used in the 'ps()' call, 'subset' 
restricts the plots of a subset of the stopping rules that were employed. This argument
expects a subset of the integers from 1 to k, if k 'stop.method's were used.</p>
</td></tr>
<tr><td><code id="boxplot.ps_+3A_color">color</code></td>
<td>
<p>If 'FALSE', a grayscale figure will be returned.</p>
</td></tr>
<tr><td><code id="boxplot.ps_+3A_time">time</code></td>
<td>
<p>For use with iptw fits.</p>
</td></tr>
<tr><td><code id="boxplot.ps_+3A_...">...</code></td>
<td>
<p>Additional arguments that are passed to boxplot function, which may bepassed to
the underlying 'lattice' package plotting functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces lattice-style graphics of diagnostic plots.
</p>


<h3>References</h3>

<p>Dan McCaffrey, G. Ridgeway, Andrew Morral (2004). &quot;Propensity
Score Estimation with Boosted Regression for Evaluating Adolescent
Substance Abuse Treatment&quot;, *Psychological Methods* 9(4):403-425.
</p>


<h3>See Also</h3>

<p>[ps]
</p>

<hr>
<h2 id='desc.wts'>Diagnosis of weights</h2><span id='topic+desc.wts'></span>

<h3>Description</h3>

<p><code>desc.wts</code> assesses the quality of a set of weights on balancing a treatment
and control group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>desc.wts(data, 
         w, 
         sampw = sampw,
         vars = NULL, 
         treat.var, 
         tp, 
         na.action = "level",
         perm.test.iters=0,
         verbose=TRUE,
         alerts.stack,
         estimand, multinom = FALSE, fillNAs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="desc.wts_+3A_data">data</code></td>
<td>
<p> a data frame containing the dataset </p>
</td></tr>
<tr><td><code id="desc.wts_+3A_w">w</code></td>
<td>
<p> a vector of weights equal to <code>nrow(data)</code> </p>
</td></tr>
<tr><td><code id="desc.wts_+3A_sampw">sampw</code></td>
<td>
<p>sampling weights, if provided</p>
</td></tr>
<tr><td><code id="desc.wts_+3A_vars">vars</code></td>
<td>
<p> a vector of variable names corresponding to <code>data</code> </p>
</td></tr>
<tr><td><code id="desc.wts_+3A_treat.var">treat.var</code></td>
<td>
<p> the name of the treatment variable </p>
</td></tr>
<tr><td><code id="desc.wts_+3A_tp">tp</code></td>
<td>
<p>a title for the method &ldquo;type&quot; used to create the weights, used
to label the results</p>
</td></tr>
<tr><td><code id="desc.wts_+3A_na.action">na.action</code></td>
<td>
<p>a string indicating the method for handling missing data</p>
</td></tr>
<tr><td><code id="desc.wts_+3A_perm.test.iters">perm.test.iters</code></td>
<td>
<p>an non-negative integer giving the number of iterations
of the permutation test for the KS statistic. If <code>perm.test.iters=0</code>
then the function returns an analytic approximation to the p-value. This
argument is ignored is <code>x</code> is a <code>ps</code> object. Setting
<code>perm.test.iters=200</code> will yield precision to within 3% if the true
p-value is 0.05. Use <code>perm.test.iters=500</code> to be within 2%</p>
</td></tr>
<tr><td><code id="desc.wts_+3A_verbose">verbose</code></td>
<td>
<p> if TRUE, lots of information will be printed to monitor the
the progress of the fitting </p>
</td></tr>
<tr><td><code id="desc.wts_+3A_alerts.stack">alerts.stack</code></td>
<td>
<p> an object for collecting warnings issued during the analyses </p>
</td></tr>
<tr><td><code id="desc.wts_+3A_estimand">estimand</code></td>
<td>
<p>the estimand of interest: either &quot;ATT&quot; or &quot;ATE&quot;</p>
</td></tr>
<tr><td><code id="desc.wts_+3A_multinom">multinom</code></td>
<td>
<p>Indicator that weights are from a propsensity score analysis with 3 or more treatment groups.</p>
</td></tr>
<tr><td><code id="desc.wts_+3A_fillnas">fillNAs</code></td>
<td>
<p>If <code>TRUE</code> fills NAs with zeros.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>desc.wts</code> calls <code><a href="#topic+bal.stat">bal.stat</a></code> to assess covariate balance.
If <code>perm.test.iters&gt;0</code> it will call <code><a href="#topic+bal.stat">bal.stat</a></code> multiple
times to compute Monte Carlo p-values for the KS statistics and the maximum KS
statistic. It assembles the results into a list object, which usually becomes 
the <code>desc</code> component of ps objects that <code><a href="#topic+ps">ps</a></code> returns.
</p>


<h3>Value</h3>

<p>See the description of the <code>desc</code> component of the <code>ps</code> object that 
<code><a href="#topic+ps">ps</a></code> returns
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ps">ps</a></code> </p>

<hr>
<h2 id='displayPlots'>Display plots</h2><span id='topic+displayPlots'></span>

<h3>Description</h3>

<p>Display plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>displayPlots(ptList, figureRows, singlePlot, multiPage, bxpt = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="displayPlots_+3A_ptlist">ptList</code></td>
<td>
<p>A list of plots to display.</p>
</td></tr>
<tr><td><code id="displayPlots_+3A_figurerows">figureRows</code></td>
<td>
<p>The number of rows in the figure.</p>
</td></tr>
<tr><td><code id="displayPlots_+3A_singleplot">singlePlot</code></td>
<td>
<p>An integer indicating the index of the plot to display.</p>
</td></tr>
<tr><td><code id="displayPlots_+3A_multipage">multiPage</code></td>
<td>
<p>Whether to display plots on multiple pages.</p>
</td></tr>
<tr><td><code id="displayPlots_+3A_bxpt">bxpt</code></td>
<td>
<p>Whether to display boxplots. Default: 'FALSE'.</p>
</td></tr>
</table>

<hr>
<h2 id='dx.wts'>Compute diagnostics assessing covariates balance.</h2><span id='topic+dx.wts'></span>

<h3>Description</h3>

<p><code>dx.wts</code> takes a <code>ps</code> object or a set of propensity scores and
computes diagnostics assessing covariates balance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dx.wts(
  x,
  data,
  estimand,
  vars = NULL,
  treat.var,
  x.as.weights = TRUE,
  sampw = NULL,
  perm.test.iters = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dx.wts_+3A_x">x</code></td>
<td>
<p>A data frame, matrix, or vector of propensity score weights or a ps
object. <code>x</code> can also be a data frame, matrix, or vector of
propensity scores if <code>x.as.weights=FALSE</code>.</p>
</td></tr>
<tr><td><code id="dx.wts_+3A_data">data</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="dx.wts_+3A_estimand">estimand</code></td>
<td>
<p>The estimand of interest: either &quot;ATT&quot; or &quot;ATE&quot;.</p>
</td></tr>
<tr><td><code id="dx.wts_+3A_vars">vars</code></td>
<td>
<p>A vector of character strings naming variables in <code>data</code> on
which to assess balance.</p>
</td></tr>
<tr><td><code id="dx.wts_+3A_treat.var">treat.var</code></td>
<td>
<p>A character string indicating which variable in <code>data</code>
contains the 0/1 treatment group indicator.</p>
</td></tr>
<tr><td><code id="dx.wts_+3A_x.as.weights">x.as.weights</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether <code>x</code>
specifies propensity score weights or propensity scores.
Ignored if <code>x</code> is a ps object. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="dx.wts_+3A_sampw">sampw</code></td>
<td>
<p>Optional sampling weights. If <code>x</code> is a <code>ps</code> object, then the
sampling weights should have been passed to <a href="#topic+ps">ps</a> and
not specified here. <code>dx.wts</code> will issue a warning if
<code>x</code> is a <code>ps</code> object and <code>sampw</code> is also specified.</p>
</td></tr>
<tr><td><code id="dx.wts_+3A_perm.test.iters">perm.test.iters</code></td>
<td>
<p>A non-negative integer giving the number of iterations
of the permutation test for the KS statistic. If <code>perm.test.iters=0</code>,
then the function returns an analytic approximation to the p-value. This
argument is ignored is <code>x</code> is a <code>ps</code> object. Setting
<code>perm.test.iters=200</code> will yield precision to within 3% if the true
p-value is 0.05. Use <code>perm.test.iters=500</code> to be within 2%.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a balance table that compares unweighted and weighted means and
standard deviations, computes effect sizes, and KS statistics to assess the
ability of the propensity scores to balance the treatment and control groups.
</p>


<h3>Value</h3>

<p>Returns a list containing
</p>

<ul>
<li> <p><code>treat</code> The vector of 0/1 treatment assignment indicators.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+ps">ps</a>
</p>

<hr>
<h2 id='egsingle'>US Sustaining Effects study</h2><span id='topic+egsingle'></span>

<h3>Description</h3>

<p>A subset of the mathematics scores from the U.S. Sustaining Effects Study. 
The subset consists of information on 1721 students from 60 schools. This 
dataset is available in the <code>mlmRev</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(egsingle)</code></pre>


<h3>Format</h3>

<p>A data frame with 7230 observations on the following 12 variables.
</p>

<dl>
<dt><code>schoolid</code></dt><dd><p>a factor of school identifiers</p>
</dd>
<dt><code>childid</code></dt><dd><p>a factor of student identifiers</p>
</dd>
<dt><code>year</code></dt><dd><p>a numeric vector indicating the year of the test</p>
</dd>
<dt><code>grade</code></dt><dd><p>a numeric vector indicating the student's grade</p>
</dd>
<dt><code>math</code></dt><dd><p>a numeric vector of test scores on the IRT scale score 
metric</p>
</dd>
<dt><code>retained</code></dt><dd><p>a factor with levels <code>0</code> <code>1</code> indicating if
the student has been retained in a grade.</p>
</dd>
<dt><code>female</code></dt><dd><p>a factor with levels <code>Female</code> <code>Male</code></p>
</dd>
<dt><code>black</code></dt><dd><p>a factor with levels <code>0</code> <code>1</code> indicating if the student is Black</p>
</dd>
<dt><code>hispanic</code></dt><dd><p>a factor with levels <code>0</code> <code>1</code> indicating if the student is Hispanic</p>
</dd>
<dt><code>size</code></dt><dd><p>a numeric vector indicating the number of students enrolled in the school</p>
</dd>
<dt><code>lowinc</code></dt><dd><p>a numeric vector giving the percentage of low-income students in the school</p>
</dd>
<dt><code>mobility</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Reproduced from the<code>mlmRev</code> package for use in the
section on nonresponse weighting in the <code>twang</code> package
vignette. These data are distributed with the HLM software package
(Bryk, Raudenbush, and Congdon, 1996). Conversion to the R format is
described in Doran and Lockwood (2006).
</p>


<h3>References</h3>

<p>Doran, H.C. and J.R. Lockwood (2006). &ldquo;Fitting value-added models in R,&rdquo;
<em>Journal of Educational and Behavioral Statistics</em>, 31(1)
</p>

<hr>
<h2 id='get.weights'>Extract propensity score weights.</h2><span id='topic+get.weights'></span>

<h3>Description</h3>

<p>Extracts propensity score weights from a ps or mnps object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.weights(ps1, stop.method = NULL, estimand = NULL, withSampW = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.weights_+3A_ps1">ps1</code></td>
<td>
<p>A <code>ps</code> or <code>mnps</code> object.</p>
</td></tr>
<tr><td><code id="get.weights_+3A_stop.method">stop.method</code></td>
<td>
<p>Indicates which set of weights to retrieve from the <code>ps</code> object.</p>
</td></tr>
<tr><td><code id="get.weights_+3A_estimand">estimand</code></td>
<td>
<p>Indicates whether the weights are for the average treatment effect on
the treated (ATT) or the average treatment effect on the population (ATE). By default,
<code>get.weights</code> will use the estimand used to fit the <code>ps</code> object.</p>
</td></tr>
<tr><td><code id="get.weights_+3A_withsampw">withSampW</code></td>
<td>
<p>Whether to return weights with sample weights multiplied in, if they were
provided in the original <code>ps</code> or <code>mnps</code> call. Default: <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Weights for ATT are 1 for the treatment cases and p/(1-p) for the control cases.
Weights for ATE are 1/p for the treatment cases and 1/(1-p) for the control cases.
</p>


<h3>Value</h3>

<p>Returns a vector of weights.
</p>


<h3>See Also</h3>

<p><a href="#topic+ps">ps</a>, <a href="#topic+mnps">mnps</a>
</p>

<hr>
<h2 id='get.weights.num'>Get numerators to stabilize propensity score weights for 'iptw' fits.</h2><span id='topic+get.weights.num'></span>

<h3>Description</h3>

<p>Forms numerators to stabilize weights for an iptw object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.weights.num(iptw, fitList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.weights.num_+3A_iptw">iptw</code></td>
<td>
<p>An 'iptw&ldquo; object.</p>
</td></tr>
<tr><td><code id="get.weights.num_+3A_fitlist">fitList</code></td>
<td>
<p>A list containing objects with an associated &quot;fitted&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns numerator of stabilized weights to be used in conjunction with 
'get.weights.unstab'
</p>


<h3>See Also</h3>

<p>[iptw]
</p>

<hr>
<h2 id='get.weights.unstab'>Extract unstabilized propensity score weights for 'iptw' fits</h2><span id='topic+get.weights.unstab'></span>

<h3>Description</h3>

<p>Extracts propensity score weights from an 'iptw' or 'mniptw'  object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.weights.unstab(x, stop.method = NULL, withSampW = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.weights.unstab_+3A_x">x</code></td>
<td>
<p>An 'iptw' or 'mniptw' object.</p>
</td></tr>
<tr><td><code id="get.weights.unstab_+3A_stop.method">stop.method</code></td>
<td>
<p>The twop method used for the fit of interest.</p>
</td></tr>
<tr><td><code id="get.weights.unstab_+3A_withsampw">withSampW</code></td>
<td>
<p>Returns weights with sample weights multiplied in, if they were 
provided in the original 'iptw' call. Default: 'TRUE'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Weights are the reciprocal of the product of the probability of receiving
the treatment received.
</p>


<h3>Value</h3>

<p>Returns a data.frame of weights.
</p>


<h3>See Also</h3>

<p>[iptw]
</p>

<hr>
<h2 id='iptw'>Inverse probability of treatment weighting for marginal structural models.</h2><span id='topic+iptw'></span>

<h3>Description</h3>

<p><code>iptw</code> calculates propensity scores for sequential treatments using gradient boosted logistic
regression and diagnoses the resulting propensity scores using a variety of
methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iptw(
  formula,
  data,
  timeInvariant = NULL,
  cumulative = TRUE,
  timeIndicators = NULL,
  ID = NULL,
  priorTreatment = TRUE,
  n.trees = 10000,
  interaction.depth = 3,
  shrinkage = 0.01,
  bag.fraction = 1,
  n.minobsinnode = 10,
  perm.test.iters = 0,
  print.level = 2,
  verbose = TRUE,
  stop.method = c("es.max"),
  sampw = NULL,
  version = "gbm",
  ks.exact = NULL,
  n.keep = 1,
  n.grid = 25,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iptw_+3A_formula">formula</code></td>
<td>
<p>Either a single formula (long format) or a list with formulas.</p>
</td></tr>
<tr><td><code id="iptw_+3A_data">data</code></td>
<td>
<p>The dataset, includes treatment assignment as well as covariates.</p>
</td></tr>
<tr><td><code id="iptw_+3A_timeinvariant">timeInvariant</code></td>
<td>
<p>An optional formula (with no left-hand variable) specifying time-invariant
chararacteristics.</p>
</td></tr>
<tr><td><code id="iptw_+3A_cumulative">cumulative</code></td>
<td>
<p>If <code>TRUE</code>, the time t model includes time-varying characteristics from times 1
through t-1. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="iptw_+3A_timeindicators">timeIndicators</code></td>
<td>
<p>For long format fits, a vector of times for each observation.</p>
</td></tr>
<tr><td><code id="iptw_+3A_id">ID</code></td>
<td>
<p>For long format fits, a vector of numeric identifiers for unique analytic units.</p>
</td></tr>
<tr><td><code id="iptw_+3A_priortreatment">priorTreatment</code></td>
<td>
<p>For long format fits, includes treatment levels from previous times if <code>TRUE</code>. This
argument is ignored for wide format fits. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="iptw_+3A_n.trees">n.trees</code></td>
<td>
<p>Number of gbm iterations passed on to <code><a href="gbm.html#topic+gbm">gbm</a></code>.</p>
</td></tr>
<tr><td><code id="iptw_+3A_interaction.depth">interaction.depth</code></td>
<td>
<p>A positive integer denoting the tree depth used in
gradient boosting. Default: 3.</p>
</td></tr>
<tr><td><code id="iptw_+3A_shrinkage">shrinkage</code></td>
<td>
<p>A numeric value between 0 and 1 denoting the learning rate.
See <code><a href="gbm.html#topic+gbm">gbm</a></code> for more details. Default: 0.01.</p>
</td></tr>
<tr><td><code id="iptw_+3A_bag.fraction">bag.fraction</code></td>
<td>
<p>A numeric value between 0 and 1 denoting the fraction of
the observations randomly selected in each iteration of the gradient
boosting algorithm to propose the next tree. See <code><a href="gbm.html#topic+gbm">gbm</a></code> for
more details. Default: 1.0.</p>
</td></tr>
<tr><td><code id="iptw_+3A_n.minobsinnode">n.minobsinnode</code></td>
<td>
<p>An integer specifying the minimum number of observations 
in the terminal nodes of the trees used in the gradient boosting. See <code><a href="gbm.html#topic+gbm">gbm</a></code> for
more details. Default: 10.</p>
</td></tr>
<tr><td><code id="iptw_+3A_perm.test.iters">perm.test.iters</code></td>
<td>
<p>A non-negative integer giving the number of iterations
of the permutation test for the KS statistic. If <code>perm.test.iters=0</code>
then the function returns an analytic approximation to the p-value. Setting
<code>perm.test.iters=200</code> will yield precision to within 3% if the true
p-value is 0.05. Use <code>perm.test.iters=500</code> to be within 2%. Default: 0.</p>
</td></tr>
<tr><td><code id="iptw_+3A_print.level">print.level</code></td>
<td>
<p>The amount of detail to print to the screen. Default: 2.</p>
</td></tr>
<tr><td><code id="iptw_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, lots of information will be printed to monitor the
the progress of the fitting. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="iptw_+3A_stop.method">stop.method</code></td>
<td>
<p>A method or methods of measuring and summarizing balance across pretreatment
variables. Current options are <code>ks.mean</code>, <code>ks.max</code>, <code>es.mean</code>, and <code>es.max</code>. <code>ks</code> refers to the
Kolmogorov-Smirnov statistic and es refers to standardized effect size. These are summarized
across the pretreatment variables by either the maximum (<code>.max</code>) or the mean (<code>.mean</code>). 
Default: <code>c("es.max")</code>.</p>
</td></tr>
<tr><td><code id="iptw_+3A_sampw">sampw</code></td>
<td>
<p>Optional sampling weights.</p>
</td></tr>
<tr><td><code id="iptw_+3A_version">version</code></td>
<td>
<p><code>"gbm"</code>, <code>"xgboost"</code>, or <code>"legacy"</code>, indicating which version of the twang package to use.
</p>

<dl>
<dt><code>"gbm"</code></dt><dd><p> uses gradient boosting from the <code><a href="gbm.html#topic+gbm">gbm</a></code> package.</p>
</dd>
<dt><code>"xgboost"</code></dt><dd><p> uses gradient boosting from the <code><a href="xgboost.html#topic+xgboost">xgboost</a></code> package.</p>
</dd>
<dt><code>"legacy"</code></dt><dd><p> uses the prior implementation of the <code><a href="#topic+ps">ps</a></code> function.</p>
</dd>
</dl>

<p>Default: <code>"gbm"</code>.</p>
</td></tr>
<tr><td><code id="iptw_+3A_ks.exact">ks.exact</code></td>
<td>
<p><code>NULL</code> or a logical indicating whether the
Kolmogorov-Smirnov p-value should be based on an approximation of exact
distribution from an unweighted two-sample Kolmogorov-Smirnov test. If
<code>NULL</code>, the approximation based on the exact distribution is computed
if the product of the effective sample sizes is less than 10,000.
Otherwise, an approximation based on the asymptotic distribution is used.
**Warning:** setting <code>ks.exact = TRUE</code> will add substantial
computation time for larger sample sizes. Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="iptw_+3A_n.keep">n.keep</code></td>
<td>
<p>A numeric variable indicating the algorithm should only
consider every <code>n.keep</code>-th iteration of the propensity score model and
optimize balance over this set instead of all iterations. Default: 1.</p>
</td></tr>
<tr><td><code id="iptw_+3A_n.grid">n.grid</code></td>
<td>
<p>A numeric variable that sets the grid size for an initial
search of the region most likely to minimize the <code>stop.method</code>. A
value of <code>n.grid=50</code> uses a 50 point grid from <code>1:n.trees</code>. It
finds the minimum, say at grid point 35. It then looks for the actual
minimum between grid points 34 and 36. If specified with <code>n.keep&gt;1</code>, <code>n.grid</code> 
corresponds to a grid of points on the kept iterations as defined by '<code>n.keep</code>. Default: 25.</p>
</td></tr>
<tr><td><code id="iptw_+3A_...">...</code></td>
<td>
<p>Additional arguments that are passed to ps function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For user more comfortable with the options of <code><a href="xgboost.html#topic+xgboost">xgboost</a></code>],
the options for <code>iptw</code> controlling the behavior of the gradient boosting
algorithm can be specified using the <code><a href="xgboost.html#topic+xgboost">xgboost</a></code> naming
scheme. This includes <code>nrounds</code>, <code>max_depth</code>, <code>eta</code>, and
<code>subsample</code>. In addition, the list of parameters passed to
<code><a href="xgboost.html#topic+xgboost">xgboost</a></code> can be specified with <code>params</code>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>iptw</code>, a list containing
</p>

<dl>
<dt><code>psList</code></dt><dd><p> A list of <code><a href="#topic+ps">ps</a></code> objects with length equal to the number of time periods.</p>
</dd>
<dt><code>estimand</code></dt><dd><p> The specified estimand.</p>
</dd>
<dt><code>stop.methods</code></dt><dd><p> The stopping rules used to optimize <code>iptw</code> balance.</p>
</dd>
<dt><code>nFits</code></dt><dd><p> The number of <code><a href="#topic+ps">ps</a></code> objects (i.e., the number of distinct time points).</p>
</dd>
<dt><code>uniqueTimes</code></dt><dd><p> The unique times in the specified model.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+ps">ps</a></code>, <code><a href="#topic+mnps">mnps</a></code>, <code><a href="gbm.html#topic+gbm">gbm</a></code>, <code><a href="xgboost.html#topic+xgboost">xgboost</a></code>, <code><a href="#topic+plot.iptw">plot</a></code>, <code><a href="#topic+bal.table">bal.table</a></code>
</p>

<hr>
<h2 id='iptwExLong'>Example data for iptw function (long version)</h2><span id='topic+iptwExLong'></span>

<h3>Description</h3>

<p>These data are simulated to demonstrate the <code>iptw</code> function in the &quot;long&quot; data format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lindner)</code></pre>


<h3>Format</h3>

<p>A list with a covariate matrix and outcomes.
</p>

<dl>
<dt>covariates</dt><dd><p>Time-invariant covariates are <code>gender</code> and <code>age</code>. The time-varying covariate is <code>use</code>. The reatment indicator is given by <code>tx</code>. An individual level identifier is given in <code>ID</code>, and the time period is <code>time</code>. </p>
</dd>
<dt>outcome</dt><dd><p>Vector of post-treatment outcomes.</p>
</dd>   
</dl>


<hr>
<h2 id='iptwExWide'>Example data for iptw function (wide version)</h2><span id='topic+iptwExWide'></span>

<h3>Description</h3>

<p>These data are simulated to demonstrate the <code>iptw</code> function in the &quot;wide&quot; data format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lindner)</code></pre>


<h3>Format</h3>

<p>A list with a covariate matrix and outcomes.
</p>

<dl>
<dt>gender</dt><dd><p>Gender.</p>
</dd>
<dt>age</dt><dd><p>Age.</p>
</dd>
<dt>use0</dt><dd><p>Baseline substance use</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>use1</dt><dd><p>Use following first time period treatment.</p>
</dd>
<dt>use2</dt><dd><p>Use following second time period treatment.</p>
</dd>
<dt>tx1</dt><dd><p>Treatment indicator (first time period).</p>
</dd>
<dt>tx2</dt><dd><p>Treatment indicator (second time period).</p>
</dd>
<dt>tx3</dt><dd><p>Treatment indicator (third time period).</p>
</dd>
<dt>covariates</dt><dd><p>Time-invariant covariates are <code>gender</code> and <code>age</code>. The time-varying covariate is <code>use</code>. The reatment indicator is given by <code>tx</code>. An individual level identifier is given in <code>ID</code>, and the time period is <code>time</code>. </p>
</dd>
<dt>outcome</dt><dd><p>Post-treatment outcomes.</p>
</dd>   
</dl>


<hr>
<h2 id='lalonde'>Lalonde's National Supported Work Demonstration data</h2><span id='topic+lalonde'></span>

<h3>Description</h3>

<p>One of the datasets used by Dehejia and Wahba in their paper &quot;Causal Effects 
in Non-Experimental Studies: Reevaluating the Evaluation of Training Programs.&quot;
Also used as an example dataset in the <code>MatchIt</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lalonde)</code></pre>


<h3>Format</h3>

<p>A data frame with 614 observations on the following 10 variables.
</p>

<dl>
<dt><code>treat</code></dt><dd><p>1 if treated in the National Supported Work Demonstration,
0 if from the Current Population Survey</p>
</dd>
<dt><code>age</code></dt><dd><p>age</p>
</dd>
<dt><code>educ</code></dt><dd><p>years of education</p>
</dd>
<dt><code>black</code></dt><dd><p>1 if black, 0 otherwise</p>
</dd>
<dt><code>hispan</code></dt><dd><p>1 if Hispanic, 0 otherwise</p>
</dd>
<dt><code>married</code></dt><dd><p>1 if married, 0 otherwise</p>
</dd>
<dt><code>nodegree</code></dt><dd><p>1 if no degree, 0 otherwise</p>
</dd>
<dt><code>re74</code></dt><dd><p>earnings in 1974 (pretreatment)</p>
</dd>
<dt><code>re75</code></dt><dd><p>earnings in 1975 (pretreatment)</p>
</dd>
<dt><code>re78</code></dt><dd><p>earnings in 1978 (outcome)</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://www.columbia.edu/~rd247/nswdata.html
http://cran.r-project.org/src/contrib/Descriptions/MatchIt.html
</p>


<h3>References</h3>

<p>Lalonde, R. (1986). Evaluating the econometric evaluations of training programs
with experimental data. American Economic Review 76: 604-620.
</p>
<p>Dehejia, R.H. and Wahba, S. (1999). Causal Effects in Nonexperimental Studies: 
Re-Evaluating the Evaluation of Training Programs. Journal of the American 
Statistical Association 94: 1053-1062.
</p>

<hr>
<h2 id='lindner'>Lindner Center data on 996 PCI patients analyzed by Kereiakes et al. (2000)</h2><span id='topic+lindner'></span>

<h3>Description</h3>

<p>These data are adapted from the <code>lindner</code> dataset in the <code>USPS</code> package.
The description comes from that package, except for the variable <code>sixMonthSurvive</code>, which 
is a recode of <code>lifepres</code>
</p>
<p>Data from an observational study of 996 patients receiving an initial
Percutaneous Coronary Intervention (PCI) at Ohio Heart Health, Christ Hospital,
Cincinnati in 1997 and followed for at least 6 months by the staff of the Lindner Center.
The patients thought to be more severely diseased were assigned to treatment with abciximab
(an expensive, high-molecular-weight IIb/IIIa cascade blocker); in fact, only 298 (29.9
percent) of patients received usual-care-alone with their initial PCI.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lindner)</code></pre>


<h3>Format</h3>

<p>A data frame of 10 variables collected on 996 patients; no NAs.
</p>

<dl>
<dt>lifepres</dt><dd><p>Mean life years preserved due to survival for at least 6 months following
PCI; numeric value of either 11.4 or 0.</p>
</dd>
<dt>cardbill</dt><dd><p>Cardiac related costs incurred within 6 months of patient's initial PCI;
numeric value in 1998 dollars; costs were truncated by death for the 26 patients with
lifepres == 0.</p>
</dd>
<dt>abcix</dt><dd><p>Numeric treatment selection indicator; 0 implies usual PCI care alone; 1
implies usual PCI care deliberately augmented by either planned or rescue treatment
with abciximab.</p>
</dd>
<dt>stent</dt><dd><p>Coronary stent deployment; numeric, with 1 meaning YES and 0 meaning NO.</p>
</dd>
<dt>height</dt><dd><p>Height in centimeters; numeric integer from 108 to 196.</p>
</dd>
<dt>female</dt><dd><p>Female gender; numeric, with 1 meaning YES and 0 meaning NO.</p>
</dd>
<dt>diabetic</dt><dd><p>Diabetes mellitus diagnosis; numeric, with 1 meaning YES and 0 meaning NO.</p>
</dd>
<dt>acutemi</dt><dd><p>Acute myocardial infarction within the previous 7 days; numeric, with 1
meaning YES and 0 meaning NO.</p>
</dd>
<dt>ejecfrac</dt><dd><p>Left ejection fraction; numeric value from 0 percent to 90 percent.</p>
</dd>
<dt>ves1proc</dt><dd><p>Number of vessels involved in the patient's initial PCI procedure; numeric
integer from 0 to 5.</p>
</dd>
<dt>sixMonthSurvive</dt><dd><p>Survival at six months &mdash; a recoded version of <code>lifepres</code>.</p>
</dd>   
</dl>



<h3>References</h3>

<p>Kereiakes DJ, Obenchain RL, Barber BL, et al.  Abciximab provides cost
effective survival advantage in high volume interventional practice.
<em>Am Heart J</em> 2000; <b>140</b>: 603-610.
</p>
<p>Obenchain RL. (2009) <b>USPSinR.pdf</b>  ../R_HOME/library/USPS  40 pages.
</p>

<hr>
<h2 id='means.table'>Extract table of means from an'mnps' object</h2><span id='topic+means.table'></span>

<h3>Description</h3>

<p>Extracts table of means from an mnps object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>means.table(mnps, stop.method = 1, includeSD = FALSE, digits = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="means.table_+3A_mnps">mnps</code></td>
<td>
<p>An 'mnps' object.</p>
</td></tr>
<tr><td><code id="means.table_+3A_stop.method">stop.method</code></td>
<td>
<p>Indicates which set of weights to retrieve from the 'ps' object. 
Either the name of the stop.method used, or a natural number with 1, for example,
.  indicating the first stop.method specified.</p>
</td></tr>
<tr><td><code id="means.table_+3A_includesd">includeSD</code></td>
<td>
<p>Indicates whether standard deviations as well as means are to be displayed.
By default, they are not displayed.</p>
</td></tr>
<tr><td><code id="means.table_+3A_digits">digits</code></td>
<td>
<p>If not 'NULL', results will be rounded to the specified number of digits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a table with weighted and unweighted means and standardized effect sizes,
and &ndash; if requested &ndash; standard deviations.
</p>


<h3>Value</h3>

<p>'A table of means, standardized effect sizes, and perhaps standard deviations,
by treatment group.
</p>


<h3>See Also</h3>

<p>[mnps]
</p>

<hr>
<h2 id='mnIptwExLong'>Example data for iptw function (long version, more than two treatments).</h2><span id='topic+mnIptwExLong'></span>

<h3>Description</h3>

<p>These data are simulated to demonstrate the <code>iptw</code> function in the &quot;long&quot; data format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lindner)</code></pre>


<h3>Format</h3>

<p>A list with a covariate matrix and outcomes.
</p>

<dl>
<dt>covariates</dt><dd><p>Time-invariant covariates are <code>gender</code> and <code>age</code>. The time-varying covariate is <code>use</code>. The reatment indicator is given by <code>tx</code>. An individual level identifier is given in <code>ID</code>, and the time period is <code>time</code>. </p>
</dd>
<dt>outcome</dt><dd><p>Vector of post-treatment outcomes.</p>
</dd>   
</dl>


<hr>
<h2 id='mnIptwExWide'>Example data for iptw function (wide version, more than two treatments)</h2><span id='topic+mnIptwExWide'></span>

<h3>Description</h3>

<p>These data are simulated to demonstrate the <code>iptw</code> function in the &quot;wide&quot; data format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lindner)</code></pre>


<h3>Format</h3>

<p>A list with a covariate matrix and outcomes.
</p>

<dl>
<dt>gender</dt><dd><p>Gender.</p>
</dd>
<dt>age</dt><dd><p>Age.</p>
</dd>
<dt>use0</dt><dd><p>Baseline substance use</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>use1</dt><dd><p>Use following first time period treatment.</p>
</dd>
<dt>use2</dt><dd><p>Use following second time period treatment.</p>
</dd>
<dt>tx1</dt><dd><p>Treatment indicator (first time period).</p>
</dd>
<dt>tx2</dt><dd><p>Treatment indicator (second time period).</p>
</dd>
<dt>tx3</dt><dd><p>Treatment indicator (third time period).</p>
</dd>
<dt>covariates</dt><dd><p>Time-invariant covariates are <code>gender</code> and <code>age</code>. The time-varying covariate is <code>use</code>. The reatment indicator is given by <code>tx</code>. An individual level identifier is given in <code>ID</code>, and the time period is <code>time</code>. </p>
</dd>
<dt>outcome</dt><dd><p>Post-treatment outcomes.</p>
</dd>   
</dl>


<hr>
<h2 id='mnps'>Propensity score estimation for multiple treatments</h2><span id='topic+mnps'></span>

<h3>Description</h3>

<p><code>mnps</code> calculates propensity scores for more than two treatment groups using gradient boosted
logistic regression, and diagnoses the resulting propensity scores using a variety of methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnps(
  formula,
  data,
  n.trees = 10000,
  interaction.depth = 3,
  shrinkage = 0.01,
  bag.fraction = 1,
  n.minobsinnode = 10,
  perm.test.iters = 0,
  print.level = 2,
  verbose = TRUE,
  estimand = "ATE",
  stop.method = c("es.max"),
  sampw = NULL,
  version = "gbm",
  ks.exact = NULL,
  n.keep = 1,
  n.grid = 25,
  treatATT = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnps_+3A_formula">formula</code></td>
<td>
<p>A formula for the propensity score model with the treatment
indicator on the left side of the formula and the potential
confounding variables on the right side.</p>
</td></tr>
<tr><td><code id="mnps_+3A_data">data</code></td>
<td>
<p>The dataset, includes treatment assignment as well as covariates.</p>
</td></tr>
<tr><td><code id="mnps_+3A_n.trees">n.trees</code></td>
<td>
<p>Number of gbm iterations passed on to <code><a href="gbm.html#topic+gbm">gbm</a></code>. Default: 10000.</p>
</td></tr>
<tr><td><code id="mnps_+3A_interaction.depth">interaction.depth</code></td>
<td>
<p>A positive integer denoting the tree depth used in
gradient boosting. Default: 3.</p>
</td></tr>
<tr><td><code id="mnps_+3A_shrinkage">shrinkage</code></td>
<td>
<p>A numeric value between 0 and 1 denoting the learning rate.
See <code><a href="gbm.html#topic+gbm">gbm</a></code> for more details. Default: 0.01.</p>
</td></tr>
<tr><td><code id="mnps_+3A_bag.fraction">bag.fraction</code></td>
<td>
<p>A numeric value between 0 and 1 denoting the fraction of
the observations randomly selected in each iteration of the gradient
boosting algorithm to propose the next tree. See <code><a href="gbm.html#topic+gbm">gbm</a></code> for
more details. Default: 1.0.</p>
</td></tr>
<tr><td><code id="mnps_+3A_n.minobsinnode">n.minobsinnode</code></td>
<td>
<p>An integer specifying the minimum number of observations 
in the terminal nodes of the trees used in the gradient boosting. See <code><a href="gbm.html#topic+gbm">gbm</a></code> for
more details. Default: 10.</p>
</td></tr>
<tr><td><code id="mnps_+3A_perm.test.iters">perm.test.iters</code></td>
<td>
<p>A non-negative integer giving the number of iterations
of the permutation test for the KS statistic. If <code>perm.test.iters=0</code>
then the function returns an analytic approximation to the p-value. Setting
<code>perm.test.iters=200</code> will yield precision to within 3% if the true
p-value is 0.05. Use <code>perm.test.iters=500</code> to be within 2%. Default: 0.</p>
</td></tr>
<tr><td><code id="mnps_+3A_print.level">print.level</code></td>
<td>
<p>The amount of detail to print to the screen. Default: 2.</p>
</td></tr>
<tr><td><code id="mnps_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, lots of information will be printed to monitor the
the progress of the fitting. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="mnps_+3A_estimand">estimand</code></td>
<td>
<p><code>"ATE"</code> (average treatment effect) or <code>"ATT"</code> (average treatment
effect on the treated) : the causal effect of interest. ATE estimates the
change in the outcome if the treatment were applied to the entire
population versus if the control were applied to the entire population. ATT
estimates the analogous effect, averaging only over the treated population.
Default: <code>"ATE"</code>.</p>
</td></tr>
<tr><td><code id="mnps_+3A_stop.method">stop.method</code></td>
<td>
<p>A method or methods of measuring and summarizing balance across pretreatment
variables. Current options are <code>ks.mean</code>, <code>ks.max</code>, <code>es.mean</code>, and <code>es.max</code>. <code>ks</code> refers to the
Kolmogorov-Smirnov statistic and <code>es</code> refers to standardized effect size. These are summarized
across the pretreatment variables by either the maximum (<code>.max</code>) or the mean (<code>.mean</code>). 
Default: <code>c("es.mean")</code>.</p>
</td></tr>
<tr><td><code id="mnps_+3A_sampw">sampw</code></td>
<td>
<p>Optional sampling weights.</p>
</td></tr>
<tr><td><code id="mnps_+3A_version">version</code></td>
<td>
<p><code>"gbm"</code>, <code>"xgboost"</code>, or <code>"legacy"</code>, indicating which version of the twang package to use.
</p>

<dl>
<dt><code>"gbm"</code></dt><dd><p> uses gradient boosting from the <code><a href="gbm.html#topic+gbm">gbm</a></code> package.</p>
</dd>
<dt><code>"xgboost"</code></dt><dd><p> uses gradient boosting from the <code><a href="xgboost.html#topic+xgboost">xgboost</a></code> package.</p>
</dd>
<dt><code>"legacy"</code></dt><dd><p> uses the prior implementation of the <code><a href="#topic+ps">ps</a></code> function.</p>
</dd>
</dl>

<p>Default: <code>"gbm"</code>.</p>
</td></tr>
<tr><td><code id="mnps_+3A_ks.exact">ks.exact</code></td>
<td>
<p><code>NULL</code> or a logical indicating whether the
Kolmogorov-Smirnov p-value should be based on an approximation of exact
distribution from an unweighted two-sample Kolmogorov-Smirnov test. If
<code>NULL</code>, the approximation based on the exact distribution is computed
if the product of the effective sample sizes is less than 10,000.
Otherwise, an approximation based on the asymptotic distribution is used.
**Warning:** setting <code>ks.exact = TRUE</code> will add substantial
computation time for larger sample sizes. Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="mnps_+3A_n.keep">n.keep</code></td>
<td>
<p>A numeric variable indicating the algorithm should only
consider every <code>n.keep</code>-th iteration of the propensity score model and
optimize balance over this set instead of all iterations. Default: 1.</p>
</td></tr>
<tr><td><code id="mnps_+3A_n.grid">n.grid</code></td>
<td>
<p>A numeric variable that sets the grid size for an initial
search of the region most likely to minimize the <code>stop.method</code>. A
value of <code>n.grid=50</code> uses a 50 point grid from <code>1:n.trees</code>. It
finds the minimum, say at grid point 35. It then looks for the actual
minimum between grid points 34 and 36. If specified with <code>n.keep&gt;1</code>, <code>n.grid</code> 
corresponds to a grid of points on the kept iterations as defined by <code>n.keep</code>. Default: 25.</p>
</td></tr>
<tr><td><code id="mnps_+3A_treatatt">treatATT</code></td>
<td>
<p>If the estimand is specified to be ATT, this argument is 
used to specify which treatment condition is considered 'the treated'.
It must be one of the levels of the treatment variable. It is ignored for
ATE analyses.</p>
</td></tr>
<tr><td><code id="mnps_+3A_...">...</code></td>
<td>
<p>Additional arguments that are passed to <code><a href="#topic+ps">ps</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For user more comfortable with the options of <code><a href="xgboost.html#topic+xgboost">xgboost</a></code>,
the options for <code>mnps</code> controlling the behavior of the gradient boosting
algorithm can be specified using the <code><a href="xgboost.html#topic+xgboost">xgboost</a></code> naming
scheme. This includes <code>nrounds</code>, <code>max_depth</code>, <code>eta</code>, and
<code>subsample</code>. In addition, the list of parameters passed to
<code><a href="xgboost.html#topic+xgboost">xgboost</a></code> can be specified with <code>params</code>.
</p>
<p>Note that unlike earlier versions of <code>twang</code>, the plotting functions are
no longer included in the <code>mnps</code> function. See <code><a href="#topic+plot.mnps">plot</a></code> for
details of the plots.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>mnps</code>, which consists of the following.  
</p>

<dl>
<dt><code>psList</code></dt><dd><p> A list of <code><a href="#topic+ps">ps</a></code> objects with length equal to the number of time periods.</p>
</dd>
<dt><code>nFits</code></dt><dd><p> The number of <code><a href="#topic+ps">ps</a></code> objects (i.e., the number of distinct time points).</p>
</dd>
<dt><code>estimand</code></dt><dd><p> The specified estimand.</p>
</dd>
<dt><code>treatATT</code></dt><dd><p> For ATT fits, the treatment category that is considered &quot;the treated&quot;.</p>
</dd>
<dt><code>treatLev</code></dt><dd><p> The levels of the treatment variable.</p>
</dd>
<dt><code>levExceptTreatAtt</code></dt><dd><p> The levels of the treatment variable, excluding the <code>treatATT</code> level.</p>
</dd>
<dt><code>data</code></dt><dd><p> The data used to fit the model.</p>
</dd>
<dt><code>treatVar</code></dt><dd><p> The vector of treatment indicators.</p>
</dd>
<dt><code>stopMethods</code></dt><dd><p> The stopping rules specified in the call to <code>mnps</code>.</p>
</dd>
<dt><code>sampw</code></dt><dd><p> Sampling weights provided to <code>mnps</code>, if any.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Lane Burgette '&lt;burgette@rand.org&gt;', Beth Ann Griffin '&lt;bethg@rand.org&gt;',
Dan Mc- Caffrey '&lt;danielm@rand.org&gt;'
</p>


<h3>References</h3>

<p>Dan McCaffrey, G. Ridgeway, Andrew Morral (2004). &quot;Propensity
Score Estimation with Boosted Regression for Evaluating Adolescent
Substance Abuse Treatment&quot;, *Psychological Methods* 9(4):403-425.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ps">ps</a></code>, <code><a href="gbm.html#topic+gbm">gbm</a></code>, <code><a href="xgboost.html#topic+xgboost">xgboost</a></code>, <code><a href="#topic+plot.mnps">plot</a></code>, <code><a href="#topic+bal.table">bal.table</a></code>
</p>

<hr>
<h2 id='plot.dxwts'>Plot <code>dxwts</code></h2><span id='topic+plot.dxwts'></span>

<h3>Description</h3>

<p>Plot <code>dxwts</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dxwts'
plot(x, plots = "es", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dxwts_+3A_x">x</code></td>
<td>
<p>An <code>dxwts</code> object.</p>
</td></tr>
<tr><td><code id="plot.dxwts_+3A_plots">plots</code></td>
<td>
<p>An indicator of which type of plot is desired. The options are
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;"optimize" or 1&#8288;</code> A plot of the balance criteria as a function of the GBM
iteration.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"boxplot" or 2&#8288;</code> Boxplots of the propensity scores for the treatment and
control cases
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"es" or 3&#8288;</code> Plots of the standardized effect size of the pre-treatment
variables before and after reweighing
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"t" or 4&#8288;</code> Plots of the p-values from t-statistics comparing means of
treated and control subjects for pretreatment variables, before and after
weighting.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"ks" or 5&#8288;</code> Plots of the p-values from Kolmogorov-Smirnov statistics
comparing distributions of pretreatment variables of treated and control
subjects, before and after weighting.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.dxwts_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.iptw'>Plots for <code>iptw</code> objects</h2><span id='topic+plot.iptw'></span>

<h3>Description</h3>

<p>This function produces a collection of diagnostic plots for <code>iptw</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'iptw'
plot(
  x,
  plots = "optimize",
  subset = NULL,
  color = TRUE,
  timePeriods = NULL,
  multiPage = FALSE,
  figureRows = NULL,
  hline = c(0.1, 0.5, 0.8),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.iptw_+3A_x">x</code></td>
<td>
<p>An <code>iptw</code> object.</p>
</td></tr>
<tr><td><code id="plot.iptw_+3A_plots">plots</code></td>
<td>
<p>An indicator of which type of plot is desired. The options are
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;"optimize" or 1&#8288;</code> A plot of the balance criteria as a function of the GBM
iteration.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"boxplot" or 2&#8288;</code> Boxplots of the propensity scores for the treatment and
control cases
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"es" or 3&#8288;</code> Plots of the standardized effect size of the pre-treatment
variables before and after reweighing
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"t" or 4&#8288;</code> Plots of the p-values from t-statistics comparing means of
treated and control subjects for pretreatment variables, before and after
weighting.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"ks" or 5&#8288;</code> Plots of the p-values from Kolmogorov-Smirnov statistics
comparing distributions of pretreatment variables of treated and control
subjects, before and after weighting.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.iptw_+3A_subset">subset</code></td>
<td>
<p>Used to restrict which of the <code>stop.method</code>s will be used
in the figure. For example <code>subset = c(1,3)</code> would indicate that the
first and third <code>stop.method</code>s (in alphabetical order of those specified
in the original call to <code>iptw</code>) should be included in the figure.</p>
</td></tr>
<tr><td><code id="plot.iptw_+3A_color">color</code></td>
<td>
<p>If <code>color = FALSE</code>, figures will be gray scale. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.iptw_+3A_timeperiods">timePeriods</code></td>
<td>
<p>The number of distinct time points. If <code>NULL</code>, this is assumed to be the number
of <code>ps</code> objects (i.e., the number of distinct time points).</p>
</td></tr>
<tr><td><code id="plot.iptw_+3A_multipage">multiPage</code></td>
<td>
<p>When multiple frames of a figure are produced, <code>multiPage = TRUE</code> will print each
frame on a different page. This is intended for situations where the graphical output is being
saved to a file. Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.iptw_+3A_figurerows">figureRows</code></td>
<td>
<p>The figure rows, passed to <a href="#topic+displayPlots">displayPlots</a>. Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.iptw_+3A_hline">hline</code></td>
<td>
<p>Arguments passed to <code>panel.abline</code>.</p>
</td></tr>
<tr><td><code id="plot.iptw_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces lattice-style graphics of diagnostic plots.
</p>


<h3>References</h3>

<p>Dan McCaffrey, G. Ridgeway, Andrew Morral (2004). &quot;Propensity
Score Estimation with Boosted Regression for Evaluating Adolescent
Substance Abuse Treatment&quot;, <em>Psychological Methods</em> 9(4):403-425.
</p>


<h3>See Also</h3>

<p><a href="#topic+iptw">iptw</a>
</p>

<hr>
<h2 id='plot.mniptw'>Plot <code>mniptw</code></h2><span id='topic+plot.mniptw'></span>

<h3>Description</h3>

<p>Plot <code>mniptw</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mniptw'
plot(
  x,
  plots = "optimize",
  pairwiseMax = TRUE,
  figureRows = NULL,
  color = TRUE,
  subset = NULL,
  treatments = NULL,
  singlePlot = NULL,
  multiPage = FALSE,
  timePeriods = NULL,
  hline = c(0.1, 0.5, 0.8),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mniptw_+3A_x">x</code></td>
<td>
<p>An <code>iptw</code> object.</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_plots">plots</code></td>
<td>
<p>An indicator of which type of plot is desired. The options are
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;"optimize" or 1&#8288;</code> A plot of the balance criteria as a function of the GBM
iteration.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"boxplot" or 2&#8288;</code> Boxplots of the propensity scores for the treatment and
control cases
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"es" or 3&#8288;</code> Plots of the standardized effect size of the pre-treatment
variables before and after reweighing
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"t" or 4&#8288;</code> Plots of the p-values from t-statistics comparing means of
treated and control subjects for pretreatment variables, before and after
weighting.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"ks" or 5&#8288;</code> Plots of the p-values from Kolmogorov-Smirnov statistics
comparing distributions of pretreatment variables of treated and control
subjects, before and after weighting.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_pairwisemax">pairwiseMax</code></td>
<td>
<p>If <code>FALSE</code>, the plots for the underlying <code>ps</code> fits
will be returned.  Otherwise, pairwise maxima will be returned.</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_figurerows">figureRows</code></td>
<td>
<p>The figure rows, passed to <a href="#topic+displayPlots">displayPlots</a>. Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_color">color</code></td>
<td>
<p>If <code>color = FALSE</code>, figures will be gray scale. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_subset">subset</code></td>
<td>
<p>Used to restrict which of the <code>stop.method</code>s will be used
in the figure. For example <code>subset = c(1,3)</code> would indicate that the
first and third <code>stop.method</code>s (in alphabetical order of those specified
in the original call to <code>iptw</code>) should be included in the figure.</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_treatments">treatments</code></td>
<td>
<p>Only applicable when <code>pairwiseMax</code> is <code>FALSE</code> and <code>plots</code> 3, 4, and 5.
If left at <code>NULL</code>, panels for all treatment pairs are created.  If one level of the treatment
variable is specified, plots comparing that treatment to all others are produced.  If two
levels are specified, a comparison for that single pair is produced.</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_singleplot">singlePlot</code></td>
<td>
<p>For Plot calls that produce multiple plots, specifying an integer value of
<code>singlePlot</code> will return only the corresponding plot.  E.g., specifying <code>singlePlot = 2</code>
will return the second plot.</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_multipage">multiPage</code></td>
<td>
<p>When multiple frames of a figure are produced, <code>multiPage = TRUE</code> will print each
frame on a different page. This is intended for situations where the graphical output is being
saved to a file. Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_timeperiods">timePeriods</code></td>
<td>
<p>The number of distinct time points. If <code>NULL</code>, this is assumed to be the number
of <code>ps</code> objects (i.e., the number of distinct time points).</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_hline">hline</code></td>
<td>
<p>Arguments passed to <code>panel.abline</code>.</p>
</td></tr>
<tr><td><code id="plot.mniptw_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.mnps'>Plots for <code>mnps</code> objects</h2><span id='topic+plot.mnps'></span>

<h3>Description</h3>

<p>This function produces a collection of diagnostic plots for <code>mnps</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mnps'
plot(
  x,
  plots = "optimize",
  pairwiseMax = TRUE,
  figureRows = NULL,
  color = TRUE,
  subset = NULL,
  treatments = NULL,
  singlePlot = NULL,
  multiPage = FALSE,
  time = NULL,
  print = TRUE,
  hline = c(0.1, 0.5, 0.8),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mnps_+3A_x">x</code></td>
<td>
<p>An <code>mnps</code> object.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_plots">plots</code></td>
<td>
<p>An indicator of which type of plot is desired. The options are
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;"optimize" or 1&#8288;</code> A plot of the balance criteria as a function of the GBM
iteration.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"boxplot" or 2&#8288;</code> Boxplots of the propensity scores for the treatment and
control cases
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"es" or 3&#8288;</code> Plots of the standardized effect size of the pre-treatment
variables before and after reweighing
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"t" or 4&#8288;</code> Plots of the p-values from t-statistics comparing means of
treated and control subjects for pretreatment variables, before and after
weighting.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"ks" or 5&#8288;</code> Plots of the p-values from Kolmogorov-Smirnov statistics
comparing distributions of pretreatment variables of treated and control
subjects, before and after weighting.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.mnps_+3A_pairwisemax">pairwiseMax</code></td>
<td>
<p>If <code>FALSE</code>, the plots for the underlying <code>ps</code> fits
will be returned.  Otherwise, pairwise maxima will be returned.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_figurerows">figureRows</code></td>
<td>
<p>The number of rows of figures that should be used.
If left as <code>NULL</code>, twang tries to find a reasonable value.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_color">color</code></td>
<td>
<p>If <code>color = FALSE</code>, figures will be gray scale. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_subset">subset</code></td>
<td>
<p>Used to restrict which of the <code>stop.method</code>s will be used
in the figure. For example <code>subset = c(1,3)</code> would indicate that the
first and third <code>stop.method</code>s (in alphabetical order of those specified
in the original call to <code>mnps</code>) should be included in the figure.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_treatments">treatments</code></td>
<td>
<p>Only applicable when <code>pairwiseMax</code> is <code>FALSE</code> and <code>plots</code> 3, 4, and 5.
If left at <code>NULL</code>, panels for all treatment pairs are created.  If one level of the treatment
variable is specified, plots comparing that treatment to all others are produced.  If two
levels are specified, a comparison for that single pair is produced.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_singleplot">singlePlot</code></td>
<td>
<p>For Plot calls that produce multiple plots, specifying an integer value of
<code>singlePlot</code> will return only the corresponding plot.  E.g., specifying <code>singlePlot = 2</code>
will return the second plot.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_multipage">multiPage</code></td>
<td>
<p>When multiple frames of a figure are produced, <code>multiPage = TRUE</code> will print each
frame on a different page. This is intended for situations where the graphical output is being
saved to a file.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_time">time</code></td>
<td>
<p>For use with <code>iptw</code>.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_print">print</code></td>
<td>
<p>If <code>FALSE</code>, the figure is returned but not printed. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_hline">hline</code></td>
<td>
<p>Arguments passed to <code>panel.abline</code>.</p>
</td></tr>
<tr><td><code id="plot.mnps_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces lattice-style graphics of diagnostic plots.
</p>


<h3>References</h3>

<p>Dan McCaffrey, G. Ridgeway, Andrew Morral (2004). &quot;Propensity
Score Estimation with Boosted Regression for Evaluating Adolescent
Substance Abuse Treatment&quot;, <em>Psychological Methods</em> 9(4):403-425.
</p>


<h3>See Also</h3>

<p><a href="#topic+mnps">mnps</a>
</p>

<hr>
<h2 id='plot.ps'>Plots for <code>ps</code> objects</h2><span id='topic+plot.ps'></span>

<h3>Description</h3>

<p>This function produces a collection of diagnostic plots for <code>ps</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ps'
plot(x, plots = "optimize", subset = NULL, color = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ps_+3A_x">x</code></td>
<td>
<p>A <code>ps</code> object.</p>
</td></tr>
<tr><td><code id="plot.ps_+3A_plots">plots</code></td>
<td>
<p>An indicator of which type of plot is desired. The options are
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;"optimize" or 1&#8288;</code> A plot of the balance criteria as a function of the GBM
iteration.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"boxplot" or 2&#8288;</code> Boxplots of the propensity scores for the treatment and
control cases
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"es" or 3&#8288;</code> Plots of the standardized effect size of the pre-treatment
variables before and after reweighing
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"t" or 4&#8288;</code> Plots of the p-values from t-statistics comparing means of
treated and control subjects for pretreatment variables, before and after
weighting.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"ks" or 5&#8288;</code> Plots of the p-values from Kolmogorov-Smirnov statistics
comparing distributions of pretreatment variables of treated and control
subjects, before and after weighting.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.ps_+3A_subset">subset</code></td>
<td>
<p>If multiple <code>stop.method</code> rules were used in the <code>ps()</code> call,
<code>subset</code> restricts the plots of a subset of the stopping rules that were
employed. This argument expects a subset of the integers from 1 to k,
if k <code>stop.method</code>s were used.</p>
</td></tr>
<tr><td><code id="plot.ps_+3A_color">color</code></td>
<td>
<p>If <code>color = FALSE</code>, figures will be gray scale. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.ps_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces lattice-style graphics of diagnostic plots.
</p>


<h3>References</h3>

<p>Dan McCaffrey, G. Ridgeway, Andrew Morral (2004). &quot;Propensity
Score Estimation with Boosted Regression for Evaluating Adolescent
Substance Abuse Treatment&quot;, <em>Psychological Methods</em> 9(4):403-425.
</p>


<h3>See Also</h3>

<p><a href="#topic+ps">ps</a>
</p>

<hr>
<h2 id='print.dxwts'>Default print statement for <code>dxwts</code> class</h2><span id='topic+print.dxwts'></span>

<h3>Description</h3>

<p>Default print statement for <code>dxwts</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dxwts'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.dxwts_+3A_x">x</code></td>
<td>
<p>A <code>dxwts</code> object</p>
</td></tr>
<tr><td><code id="print.dxwts_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.iptw'>Default print statement for <code>iptw</code> class</h2><span id='topic+print.iptw'></span>

<h3>Description</h3>

<p>Default print statement for <code>iptw</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'iptw'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.iptw_+3A_x">x</code></td>
<td>
<p>A <code>iptw</code> object</p>
</td></tr>
<tr><td><code id="print.iptw_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.mniptw'>Default print statement for <code>mniptw</code> class</h2><span id='topic+print.mniptw'></span>

<h3>Description</h3>

<p>Default print statement for <code>mniptw</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mniptw'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mniptw_+3A_x">x</code></td>
<td>
<p>A <code>mniptw</code> object</p>
</td></tr>
<tr><td><code id="print.mniptw_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.mnps'>Default print statement for <code>mnps</code> class</h2><span id='topic+print.mnps'></span>

<h3>Description</h3>

<p>Default print statement for <code>mnps</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mnps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mnps_+3A_x">x</code></td>
<td>
<p>A <code>mnps</code> object</p>
</td></tr>
<tr><td><code id="print.mnps_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.ps'>Default print statement for <code>ps</code> class</h2><span id='topic+print.ps'></span>

<h3>Description</h3>

<p>Default print statement for <code>ps</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.ps_+3A_x">x</code></td>
<td>
<p>An <code>ps</code> object</p>
</td></tr>
<tr><td><code id="print.ps_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.iptw'>Produces a summary table for <code>iptw</code> object</h2><span id='topic+print.summary.iptw'></span>

<h3>Description</h3>

<p>Produces a summary table for <code>iptw</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.iptw'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.iptw_+3A_x">x</code></td>
<td>
<p>An <code>iptw</code> object</p>
</td></tr>
<tr><td><code id="print.summary.iptw_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.mniptw'>Produces a summary table for <code>mniptw</code> object</h2><span id='topic+print.summary.mniptw'></span>

<h3>Description</h3>

<p>Produces a summary table for <code>mniptw</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.mniptw'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.mniptw_+3A_x">x</code></td>
<td>
<p>An <code>mniptw</code> object</p>
</td></tr>
<tr><td><code id="print.summary.mniptw_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.mnps'>Produces a summary table for <code>mnps</code> object</h2><span id='topic+print.summary.mnps'></span>

<h3>Description</h3>

<p>Produces a summary table for <code>mnps</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.mnps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.mnps_+3A_x">x</code></td>
<td>
<p>An <code>mnps</code> object</p>
</td></tr>
<tr><td><code id="print.summary.mnps_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.ps'>Produces a summary table for <code>ps</code> object</h2><span id='topic+print.summary.ps'></span>

<h3>Description</h3>

<p>Produces a summary table for <code>ps</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.ps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.ps_+3A_x">x</code></td>
<td>
<p>An <code>ps</code> object</p>
</td></tr>
<tr><td><code id="print.summary.ps_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='ps'>Gradient boosted propensity score estimation</h2><span id='topic+ps'></span>

<h3>Description</h3>

<p><code>ps</code> calculates propensity scores using gradient boosted logistic
regression and diagnoses the resulting propensity scores using a variety of
methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ps(
  formula = formula(data),
  data,
  n.trees = 10000,
  interaction.depth = 3,
  shrinkage = 0.01,
  bag.fraction = 1,
  n.minobsinnode = 10,
  perm.test.iters = 0,
  print.level = 2,
  verbose = TRUE,
  estimand = "ATE",
  stop.method = c("ks.mean", "es.mean"),
  sampw = NULL,
  version = "gbm",
  ks.exact = NULL,
  n.keep = 1,
  n.grid = 25,
  keep.data = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ps_+3A_formula">formula</code></td>
<td>
<p>An object of class <code><a href="stats.html#topic+formula">formula</a></code>: a symbolic
description of the propensity score model to be fit with the treatment
indicator on the left side of the formula and the potential confounding
variables on the right side.</p>
</td></tr>
<tr><td><code id="ps_+3A_data">data</code></td>
<td>
<p>A dataset that includes the treatment indicator as well as the
potential confounding variables.</p>
</td></tr>
<tr><td><code id="ps_+3A_n.trees">n.trees</code></td>
<td>
<p>Number of gbm iterations passed on to <code><a href="gbm.html#topic+gbm">gbm</a></code>. Default: 10000.</p>
</td></tr>
<tr><td><code id="ps_+3A_interaction.depth">interaction.depth</code></td>
<td>
<p>A positive integer denoting the tree depth used in
gradient boosting. Default: 3.</p>
</td></tr>
<tr><td><code id="ps_+3A_shrinkage">shrinkage</code></td>
<td>
<p>A numeric value between 0 and 1 denoting the learning rate.
See <code><a href="gbm.html#topic+gbm">gbm</a></code> for more details. Default: 0.01.</p>
</td></tr>
<tr><td><code id="ps_+3A_bag.fraction">bag.fraction</code></td>
<td>
<p>A numeric value between 0 and 1 denoting the fraction of
the observations randomly selected in each iteration of the gradient
boosting algorithm to propose the next tree. See <code><a href="gbm.html#topic+gbm">gbm</a></code> for
more details. Default: 1.0.</p>
</td></tr>
<tr><td><code id="ps_+3A_n.minobsinnode">n.minobsinnode</code></td>
<td>
<p>An integer specifying the minimum number of observations 
in the terminal nodes of the trees used in the gradient boosting.  See <code><a href="gbm.html#topic+gbm">gbm</a></code> for
more details. Default: 10.</p>
</td></tr>
<tr><td><code id="ps_+3A_perm.test.iters">perm.test.iters</code></td>
<td>
<p>A non-negative integer giving the number of iterations
of the permutation test for the KS statistic. If <code>perm.test.iters=0</code>
then the function returns an analytic approximation to the p-value. Setting
<code>perm.test.iters=200</code> will yield precision to within 3% if the true
p-value is 0.05. Use <code>perm.test.iters=500</code> to be within 2%. Default: 0.</p>
</td></tr>
<tr><td><code id="ps_+3A_print.level">print.level</code></td>
<td>
<p>The amount of detail to print to the screen. Default: 2.</p>
</td></tr>
<tr><td><code id="ps_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, lots of information will be printed to monitor the
the progress of the fitting. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ps_+3A_estimand">estimand</code></td>
<td>
<p><code>"ATE"</code> (average treatment effect) or <code>"ATT"</code> (average treatment
effect on the treated) : the causal effect of interest. ATE estimates the
change in the outcome if the treatment were applied to the entire
population versus if the control were applied to the entire population. ATT
estimates the analogous effect, averaging only over the treated population.
Default: <code>"ATE"</code>.</p>
</td></tr>
<tr><td><code id="ps_+3A_stop.method">stop.method</code></td>
<td>
<p>A method or methods of measuring and summarizing balance across pretreatment
variables. Current options are <code>ks.mean</code>, <code>ks.max</code>, <code>es.mean</code>, and <code>es.max</code>. <code>ks</code> refers to the
Kolmogorov-Smirnov statistic and es refers to standardized effect size. These are summarized
across the pretreatment variables by either the maximum (<code>.max</code>) or the mean (<code>.mean</code>). 
Default: <code>c("ks.mean", "es.mean")</code>.</p>
</td></tr>
<tr><td><code id="ps_+3A_sampw">sampw</code></td>
<td>
<p>Optional sampling weights.</p>
</td></tr>
<tr><td><code id="ps_+3A_version">version</code></td>
<td>
<p><code>"gbm"</code>, <code>"xgboost"</code>, or <code>"legacy"</code>, indicating which version of the twang package to use.
</p>

<dl>
<dt><code>"gbm"</code></dt><dd><p> uses gradient boosting from the <code><a href="gbm.html#topic+gbm">gbm</a></code> package,</p>
</dd>
<dt><code>"xgboost"</code></dt><dd><p> uses gradient boosting from the <code><a href="xgboost.html#topic+xgboost">xgboost</a></code> package, and</p>
</dd>
<dt><code>"legacy"</code></dt><dd><p> uses the prior implementation of the <code>ps</code> function.</p>
</dd>
</dl>

<p>Default: <code>"gbm"</code>.</p>
</td></tr>
<tr><td><code id="ps_+3A_ks.exact">ks.exact</code></td>
<td>
<p><code>NULL</code> or a logical indicating whether the
Kolmogorov-Smirnov p-value should be based on an approximation of exact
distribution from an unweighted two-sample Kolmogorov-Smirnov test. If
<code>NULL</code>, the approximation based on the exact distribution is computed
if the product of the effective sample sizes is less than 10,000.
Otherwise, an approximation based on the asymptotic distribution is used.
**Warning:** setting <code>ks.exact = TRUE</code> will add substantial
computation time for larger sample sizes. Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ps_+3A_n.keep">n.keep</code></td>
<td>
<p>A numeric variable indicating the algorithm should only
consider every <code>n.keep</code>-th iteration of the propensity score model and
optimize balance over this set instead of all iterations. Default: 1.</p>
</td></tr>
<tr><td><code id="ps_+3A_n.grid">n.grid</code></td>
<td>
<p>A numeric variable that sets the grid size for an initial
search of the region most likely to minimize the <code>stop.method</code>. A
value of <code>n.grid=50</code> uses a 50 point grid from <code>1:n.trees</code>. It
finds the minimum, say at grid point 35. It then looks for the actual
minimum between grid points 34 and 36. If specified with <code>n.keep&gt;1</code>, <code>n.grid</code> 
corresponds to a grid of points on the kept iterations as defined by <code>n.keep</code>. Default: 25.</p>
</td></tr>
<tr><td><code id="ps_+3A_keep.data">keep.data</code></td>
<td>
<p>A logical variable indicating whether or not the data is saved in 
the resulting <code>ps</code> object. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ps_+3A_...">...</code></td>
<td>
<p>Additional arguments that are passed to <code>ps</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For user more comfortable with the options of <code><a href="xgboost.html#topic+xgboost">xgboost</a></code>,
the options for <code>ps</code> controlling the behavior of the gradient boosting
algorithm can be specified using the <code><a href="xgboost.html#topic+xgboost">xgboost</a></code> naming
scheme. This includes <code>nrounds</code>, <code>max_depth</code>, <code>eta</code>, and
<code>subsample</code>. In addition, the list of parameters passed to
<code><a href="xgboost.html#topic+xgboost">xgboost</a></code> can be specified with <code>params</code>.
</p>
<p>Note that unlike earlier versions of 'twang', the plotting functions are
no longer included in the <code>ps</code> function. See  <code><a href="#topic+plot.ps">plot</a></code> for
details of the plots.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>ps</code>, a list containing 
</p>

<dl>
<dt><code>gbm.obj</code></dt><dd><p> The returned <code><a href="gbm.html#topic+gbm">gbm</a></code> or <code><a href="xgboost.html#topic+xgboost">xgboost</a></code> object.</p>
</dd>
<dt><code>treat</code></dt><dd><p> The vector of treatment indicators.</p>
</dd>
<dt><code>treat.var</code></dt><dd><p> The treatment variable.</p>
</dd>
<dt><code>desc</code></dt><dd><p> A list containing balance tables for each method selected in
<code>stop.methods</code>. Includes a component for the unweighted
analysis names &ldquo;unw&rdquo;. Each <code>desc</code> component includes
a list with the following components
</p>

<dl>
<dt><code>ess</code></dt><dd><p> The effective sample size of the control group.</p>
</dd>
<dt><code>n.treat</code></dt><dd><p> The number of subjects in the treatment group.</p>
</dd>
<dt><code>n.ctrl</code></dt><dd><p> The number of subjects in the control group.</p>
</dd>
<dt><code>max.es</code></dt><dd><p> The largest effect size across the covariates.</p>
</dd>
<dt><code>mean.es</code></dt><dd><p> The mean absolute effect size.</p>
</dd>
<dt><code>max.ks</code></dt><dd><p> The largest KS statistic across the covariates.</p>
</dd>
<dt><code>mean.ks</code></dt><dd><p> The average KS statistic across the covariates.</p>
</dd>
<dt><code>bal.tab</code></dt><dd><p> a (potentially large) table summarizing the quality of the 
weights for equalizing the distribution of features across 
the two groups. This table is best extracted using the
<code><a href="#topic+bal.table">bal.table</a></code> method. See the help for <code><a href="#topic+bal.table">bal.table</a></code> for details
on the table's contents.</p>
</dd>
<dt><code>n.trees</code></dt><dd><p> The estimated optimal number of gradient boosted
iterations to optimize the loss function for the associated 
<code>stop.methods</code>.</p>
</dd>
<dt><code>ps</code></dt><dd><p> a data frame containing the estimated propensity scores. Each
column is associated with one of the methods selected in <code>stop.methods</code>.</p>
</dd>
<dt><code>w</code></dt><dd><p> a data frame containing the propensity score weights. Each
column is associated with one of the methods selected in <code>stop.methods</code>.</p>
</dd>
</dl>
<p>If sampling weights are given then these are incorporated into these weights.
</p>
<dl>
<dt><code>estimand</code></dt><dd><p> The estimand of interest (ATT or ATE).</p>
</dd>
</dl>
</dd>
<dt><code>datestamp</code></dt><dd><p> Records the date of the analysis.</p>
</dd>
<dt><code>parameters</code></dt><dd><p> Saves the <code>ps</code> call.</p>
</dd>
<dt><code>alerts</code></dt><dd><p> Text containing any warnings accumulated during the estimation.</p>
</dd>
<dt><code>iters</code></dt><dd><p> A sequence of iterations used in the GBM fits used by <code><a href="#topic+plot.ps">plot</a></code> function.</p>
</dd>
<dt><code>balance</code></dt><dd><p> The balance measures for the pretreatment covariates used in plotting, with a column for each
<code>stop.method</code>.</p>
</dd>
<dt><code>balance.ks</code></dt><dd><p> The KS balance measures for the pretreatment covariates used in plotting, with a column for each
covariate.</p>
</dd>
<dt><code>balance.es</code></dt><dd><p> The standard differences for the pretreatment covariates used in plotting, with a column for each
covariate.</p>
</dd>
<dt><code>ks</code></dt><dd><p> The KS balance measures for the pretreatment covariates on a finer grid, with a column for each
covariate.</p>
</dd>
<dt><code>es</code></dt><dd><p> The standard differences for the pretreatment covariates on a finer grid, with a column for each
covariate.</p>
</dd>
<dt><code>n.trees</code></dt><dd><p> Maximum number of trees considered in GBM fit.</p>
</dd>
<dt><code>data</code></dt><dd><p> Data as specified in the <code>data</code> argument.</p>
</dd>
</dl>



<h3>References</h3>

<p>Dan McCaffrey, G. Ridgeway, Andrew Morral (2004). &quot;Propensity
Score Estimation with Boosted Regression for Evaluating Adolescent
Substance Abuse Treatment&quot;, *Psychological Methods* 9(4):403-425.
</p>


<h3>See Also</h3>

<p><code><a href="gbm.html#topic+gbm">gbm</a></code>, <code><a href="xgboost.html#topic+xgboost">xgboost</a></code>, <code><a href="#topic+plot.ps">plot</a></code>, <code><a href="#topic+bal.table">bal.table</a></code>
</p>

<hr>
<h2 id='raceprofiling'>Traffic stop data</h2><span id='topic+raceprofiling'></span>

<h3>Description</h3>

<p>Simulated example data for assessing race bias in traffic stop outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(raceprofiling)</code></pre>


<h3>Format</h3>

<p>A data frame with 5000 observations on the following 10 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>an ID for each traffic stop</p>
</dd>
<dt><code>nhood</code></dt><dd><p>a factor indicating the neighborhood in which the stop 
occurred.</p>
</dd>
<dt><code>reason</code></dt><dd><p>The reason for the stop, mechanical/registration 
violations, dangerous moving violation, non-dangerous moving violation</p>
</dd>
<dt><code>resident</code></dt><dd><p>an indicator whether the driver is a resident of the 
city</p>
</dd>
<dt><code>age</code></dt><dd><p>driver's age</p>
</dd>
<dt><code>male</code></dt><dd><p>an indicator whether the driver was male</p>
</dd>
<dt><code>race</code></dt><dd><p>the race of the driver, with levels <code>A</code>, <code>B</code>, 
<code>H</code>, <code>W</code></p>
</dd>
<dt><code>hour</code></dt><dd><p>the hour of the stop (24-hour clock)</p>
</dd>
<dt><code>month</code></dt><dd><p>and ordered factor indicating in which month the stop 
took place</p>
</dd>
<dt><code>citation</code></dt><dd><p>an indicator of whether the driver received a citation</p>
</dd>
</dl>



<h3>Source</h3>

<p>This is simulated data to demonstrate how to use <code>twang</code> to adjust 
estimates of racial bias for important factors. This dataset does not represent
real data from any real law enforcement agency.
</p>


<h3>References</h3>

<p>G. Ridgeway (2006). &ldquo;Assessing the effect of race bias in 
post-traffic stop outcomes using propensity scores,&rdquo; <em>Journal of 
Quantitative Criminology</em> 22(1). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(raceprofiling)

# the first five lines of the dataset
raceprofiling[1:5,]
</code></pre>

<hr>
<h2 id='sensitivity'>Function to run sensitivity analysis described in Ridgeway's paper;
currently works only for ATT.</h2><span id='topic+sensitivity'></span>

<h3>Description</h3>

<p>Performs the sensitivity analyses described in Ridgeway (2006).
This is a beta version of this functionality. Please let the developers
know if you have problems with it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity(ps1, data, outcome, order.by.importance = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensitivity_+3A_ps1">ps1</code></td>
<td>
<p>A 'ps' object.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_data">data</code></td>
<td>
<p>The dataset including the outcomes</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_outcome">outcome</code></td>
<td>
<p>The outcome of interest.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_order.by.importance">order.by.importance</code></td>
<td>
<p>Orders the output by relative importance of covariates.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_verbose">verbose</code></td>
<td>
<p>If 'TRUE', extra information will be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the following
* 'tx' Summary for treated observations.
* 'ctrl' Summary for control observations.
</p>


<h3>References</h3>

<p>Ridgeway, G. (2006). &quot;The effect of race bias in post-traffic stop
outcomes using propensity scores&quot;, *Journal of Quantitative Criminology* 22(1):1-29.
</p>

<hr>
<h2 id='stop.methods'>Stop methods (e.g. &quot;es.mean&quot;, &quot;ks.mean&quot;, etc.) object, used only for backward compatibility</h2><span id='topic+stop.methods'></span>

<h3>Description</h3>

<p>In older versions of twang, the 'ps' function specified the 'stop.method' in a different
manner. This 'stop.methods' object is used to ensure backward compatibility; new twang
users should not make use of it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stop.methods
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 1 rows and 6 columns.
</p>


<h3>Details</h3>

<p>This is merely a vector with the names of the stopping rules.
</p>

<hr>
<h2 id='summary.iptw'>Summarize a <code>iptw</code> object</h2><span id='topic+summary.iptw'></span>

<h3>Description</h3>

<p>Computes summary information about a stored <code>iptw</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'iptw'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.iptw_+3A_object">object</code></td>
<td>
<p>An <code>iptw</code> object.</p>
</td></tr>
<tr><td><code id="summary.iptw_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compresses the information in the <code>desc</code> component of the <code>iptw</code> object
into a short summary table describing the size of the dataset and the quality of
the propensity score weights.
</p>


<h3>Value</h3>

<p>See <a href="#topic+iptw">iptw</a> for details on the returned table.
</p>


<h3>See Also</h3>

<p><a href="#topic+iptw">iptw</a>
</p>

<hr>
<h2 id='summary.mniptw'>Summarize a <code>mniptw</code> object</h2><span id='topic+summary.mniptw'></span>

<h3>Description</h3>

<p>Summarize a <code>mniptw</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mniptw'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mniptw_+3A_object">object</code></td>
<td>
<p>A <code>mniptw</code> object.</p>
</td></tr>
<tr><td><code id="summary.mniptw_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.mnps'>Summarize a <code>mnps</code> object</h2><span id='topic+summary.mnps'></span>

<h3>Description</h3>

<p>Computes summary information about a stored <code>mnps</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mnps'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mnps_+3A_object">object</code></td>
<td>
<p>An <code>mnps</code> object.</p>
</td></tr>
<tr><td><code id="summary.mnps_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compresses the information in the <code>desc</code> component of the <code>mnps</code> object
into a short summary table describing the size of the dataset and the quality of
the propensity score weights.
</p>


<h3>Value</h3>

<p>See <a href="#topic+mnps">mnps</a> for details on the returned table.
</p>


<h3>See Also</h3>

<p><a href="#topic+mnps">mnps</a>
</p>

<hr>
<h2 id='summary.ps'>Summarize a <code>ps</code> object</h2><span id='topic+summary.ps'></span>

<h3>Description</h3>

<p>Computes summary information about a stored <code>ps</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ps'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ps_+3A_object">object</code></td>
<td>
<p>An <code>ps</code> object.</p>
</td></tr>
<tr><td><code id="summary.ps_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compresses the information in the <code>desc</code> component of the <code>ps</code> object
into a short summary table describing the size of the dataset and the quality of
the propensity score weights.
</p>


<h3>Value</h3>

<p>See <a href="#topic+ps">ps</a> for details on the returned table.
</p>


<h3>See Also</h3>

<p><a href="#topic+ps">ps</a>
</p>

<hr>
<h2 id='twang-package'>twang: Toolkit for Weighting and Analysis of Nonequivalent Groups</h2><span id='topic+twang'></span><span id='topic+twang-package'></span>

<h3>Description</h3>

<p>Provides functions for propensity score estimating and weighting, nonresponse weighting, and diagnosis of the weights.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
