<!DOCTYPE html><html lang="en"><head><title>Help for package lbreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lbreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lbreg-package'>
<p>Log-Binomial Regression with Constrained Optimization</p></a></li>
<li><a href='#Birth'><p>Birth Weight Data</p></a></li>
<li><a href='#Caesarian'><p>Caesarian Infection Dataset</p></a></li>
<li><a href='#Death'><p>Death Penalty Data</p></a></li>
<li><a href='#Evans'><p>Evans County dataset</p></a></li>
<li><a href='#Heart'><p>Heart Dataset</p></a></li>
<li><a href='#HL_test'><p>Hosmer-Lemeshow Goodness of Fit Test</p></a></li>
<li><a href='#lbreg'><p>Log-Binomial regression</p></a></li>
<li><a href='#PCS'><p>PCS Dataset</p></a></li>
<li><a href='#predict.lbreg'>
<p>Predict method for Log-Binomial regression.</p></a></li>
<li><a href='#relrisk'><p>Regression Adjusted Relative Risks</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Log-Binomial Regression with Constrained Optimization</td>
</tr>
<tr>
<td>Description:</td>
<td>Maximum likelihood estimation of log-binomial regression with special functionality when the MLE is on the boundary of the parameter space.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Bernardo B. Andrade </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bernardo Andrade &lt;bbandrade@unb.br&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-13 13:57:19 UTC; root</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-13 14:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='lbreg-package'>
Log-Binomial Regression with Constrained Optimization
</h2><span id='topic+lbreg-package'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation of log-binomial regression with special functionality when the MLE is on the boundary of the parameter space.
</p>
<p>Package <code>lbreg</code> performs maximum likelihood estimation of Log-Binomial Regression. 
The main functions are <code><a href="#topic+lbreg">lbreg</a></code> which provides a shortcut to <code><a href="stats.html#topic+constrOptim">constrOptim</a></code> 
to estimate LBR coefficients and <code><a href="#topic+relrisk">relrisk</a></code> which takes lbreg results to 
produce estimated relative risks and associated confidence intervals and prediction. Results
differ from <code><a href="stats.html#topic+glm">glm</a></code> when the MLE is on the boundary of the parameter space as 
explained in the reference below (Andrade, Andrade (2018)).
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> lbreg</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Log-Binomial Regression with Constrained Optimization</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Maximum likelihood estimation of log-binomial regression with special functionality when the MLE is on the boundary of the parameter space.</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-12-13</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Bernardo B. Andrade </td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Bernardo Andrade &lt;bbandrade@unb.br&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> MASS</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
Birth                   Birth Weight Data
Caesarian               Caesarian Infection Dataset
Death                   Death Penalty Data
Evans                   Evans County dataset
HL_test                 Hosmer-Lemeshow Goodness of Fit Test
Heart                   Heart Dataset
PCS                     PCS Dataset
lbreg                   Log-Binomial regression
lbreg-package           Log-Binomial Regression with Constrained
                        Optimization
predict.lbreg           Predict method for Log-Binomial regression.
relrisk                 Regression Adjusted Relative Risks
</pre>


<h3>Author(s)</h3>

<p>Bernardo B. Andrade 
</p>
<p>Maintainer: Bernardo Andrade &lt;bbandrade@unb.br&gt;
</p>


<h3>References</h3>

<p>Andrade, BB; Andrade JML (2018) Some results for Maximum Likelihood Estimation of Adjusted Relative Risks. 
Communications in Statistics - Theory and Methods.
</p>

<hr>
<h2 id='Birth'>Birth Weight Data</h2><span id='topic+Birth'></span>

<h3>Description</h3>

<p>Data used by Wacholder (1986) to illustrate the use of log binomial 
regression for estimating adjusted relative risks  of  a  low-birthweight  baby. </p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Birth")</code></pre>


<h3>Format</h3>

<p>A data frame with 900 observations on the following 5 variables.
</p>

<dl>
<dt><code>lowbw</code></dt><dd><p>low birth weight delivery (1=yes) </p>
</dd>
<dt><code>alc</code></dt><dd><p>mother's alcohol drinking frequency (1=Light, 2=Moderate, 3=Heavy)</p>
</dd>
<dt><code>smo</code></dt><dd><p>mother smoked (1=no)</p>
</dd>		
<dt><code>soc</code></dt><dd><p>mother's social status (1=I and II (lower), 2=III (middle), 3=IV and V (upper))</p>
</dd>
</dl>



<h3>Source</h3>

<p>Stata's online manual  http://www.stata.com/manuals13/rbinreg.pdf
</p>


<h3>References</h3>

<p>Wright JT, Waterson EJ, Barrison PJ, et al. (1983). Alcohol consumption, pregnancy and	low birthweight. Lancet 1:663-665.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Birth)
dim(Birth)
names(Birth)

</code></pre>

<hr>
<h2 id='Caesarian'>Caesarian Infection Dataset</h2><span id='topic+Caesarian'></span>

<h3>Description</h3>

<p>Adapted dataset from Fahrmeir et al (2013): grouped data on infections of 251 mothers after a 
C-section collected at the clinical center of the University of Munich.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Caesarian")</code></pre>


<h3>Format</h3>

<p>A data frame with 7 rows and 5 variables.
</p>

<dl>
<dt><code>n1</code></dt><dd><p>Caesarians with infections.</p>
</dd>
<dt><code>n0</code></dt><dd><p>Caesarians without infections.</p>
</dd>
<dt><code>NPLAN</code></dt><dd><p> = 1 if C-section was not planned.</p>
</dd>
<dt><code>RISK</code></dt><dd><p>= 1 if risk factors existed.</p>
</dd>
<dt><code>ANTIB</code></dt><dd><p> = 1 if antibiotics were administered as prophylaxis.</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://www.uni-goettingen.de/de/551625.html
</p>


<h3>References</h3>

<p>Fahrmeir, L., Kneib, Th., Lang, S., Marx, B. (2013) Regression - Models, Methods and Applications. Springer. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Caesarian)
Caesarian
# no observations for case (RISK=0, NPLAN=1, ANTIB=1)
y = Caesarian[,1:2]
cbind(Caesarian[,3:5], total=rowSums(y))
colSums(y)
</code></pre>

<hr>
<h2 id='Death'>Death Penalty Data</h2><span id='topic+Death'></span>

<h3>Description</h3>

<p>See references. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Death")</code></pre>


<h3>Format</h3>

<p>A data frame with 147 observations on the following 6 variables.
</p>

<dl>
<dt><code>death</code></dt><dd><p>death = 1, life in prison = 0</p>
</dd>
<dt><code>blackd</code></dt><dd><p>black defendant = 1</p>
</dd>
<dt><code>whitvic</code></dt><dd><p>white victim = 1</p>
</dd>
<dt><code>serious</code></dt><dd><p>a measure of crime seriousness</p>
</dd>
<dt><code>culp</code></dt><dd><p>a measure of culpability</p>
</dd>
<dt><code>serious2</code></dt><dd><p>another measure of crime seriousness</p>
</dd>
</dl>



<h3>Source</h3>

<p>SAS Institute Inc. (2006). Logistic regression using the SAS system: Theory and application.
SAS Publishing, Cary, NC: SAS Institute Inc; http://ftp.sas.com/~samples/A55770
</p>


<h3>References</h3>

<p>Petersen MR, Deddens JA (2010). Maximum Likelihood Estimation of the Log-Binomial
Model. Communications in Statistics: Theory and Methods, 39, 874-883.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Death)
dim(Death)
names(Death)
</code></pre>

<hr>
<h2 id='Evans'>Evans County dataset</h2><span id='topic+Evans'></span>

<h3>Description</h3>

<p>Data from cohort study in which white males in Evans County 
were followed for 7 years, with coronary
heart disease as the outcome of interest.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Evans")</code></pre>


<h3>Format</h3>

<p>A data frame with 609 observations on the following 9 variables.
</p>

<dl>
<dt><code>CDH</code></dt><dd><p>outcome variable; 1 = coronary heart disease</p>
</dd>
<dt><code>CAT</code></dt><dd><p>1 = high, 0 = normal catecholamine level</p>
</dd>
<dt><code>AGE</code></dt><dd><p>age (in years)</p>
</dd>
<dt><code>CHL</code></dt><dd><p>cholesterol, mg/dl</p>
</dd>
<dt><code>SMK</code></dt><dd><p>1 = subject has ever smoked</p>
</dd>
<dt><code>ECG</code></dt><dd><p>1 = presence of electrocardiogram abnormality</p>
</dd>
<dt><code>DBP</code></dt><dd><p>diastolic blood pressure, mmHg</p>
</dd>
<dt><code>SBP</code></dt><dd><p>systolic blood pressure, mmHg</p>
</dd>
<dt><code>HPT</code></dt><dd><p>1 = SBP greater than or equal to 160 or DBP greater than or equal to 95</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://web1.sph.emory.edu/dkleinb/logreg3.htm#data
</p>


<h3>References</h3>

<p>D. Kleinbaum and M. Klein (2010) Survival Analysis: A Self-Learning Text. 3rd ed. Springer. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Evans)
dim(Evans)
names(Evans)

</code></pre>

<hr>
<h2 id='Heart'>Heart Dataset</h2><span id='topic+Heart'></span>

<h3>Description</h3>

<p>Heart attack data from the ASSENT-2 study.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Heart")</code></pre>


<h3>Format</h3>

<p>A data frame with 16,949 observations on the following 5 variables.
</p>

<dl>
<dt><code>Heart</code></dt><dd><p>binary response; 1 = death</p>
</dd>
<dt><code>age</code></dt><dd><p>categorized into &lt;65, 65-75 or &gt;75 years</p>
</dd>
<dt><code>severity</code></dt><dd><p>Killip class I, II, or III/IV</p>
</dd>
<dt><code>region</code></dt><dd><p>code for three USA regions</p>
</dd>
<dt><code>onset</code></dt><dd><p>treatment delay categorized into &lt;2, 2-4 or &gt;4 hours</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://biostatistics.oxfordjournals.org/content/13/1/179/suppl/DC1
</p>


<h3>References</h3>

<p>ASSENT-2 INVESTIGATORS (1999). Single-bolus tenecteplase compared with front-loaded alteplase in acute
myocardial infarction: the ASSENT-2 double-blind randomised trial. Lancet 354, 716-722.
</p>
<p>Ian C. Marschner and Alexandra C. Gillett (2012)
Relative risk regression: reliable and flexible methods for log-binomial models.
Biostatistics 13, 179-192 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Heart)
dim(Heart)
names(Heart)

</code></pre>

<hr>
<h2 id='HL_test'>Hosmer-Lemeshow Goodness of Fit Test</h2><span id='topic+HL_test'></span>

<h3>Description</h3>

<p>The HL decile-of-risk test.  Validity of the test
assumes that the number of covariate patterns
is close to the number of observations which is violated 
when many observations have the same covariate pattern
and several ties will impact the required ordering and 
grouping (by deciles) of observations. 
This is less likely when there is at least one 
continuous covariate. 
Not valid for grouped data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> HL_test(object, g = 10) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HL_test_+3A_object">object</code></td>
<td>
<p>  object of class 'lbreg'. </p>
</td></tr>
<tr><td><code id="HL_test_+3A_g">g</code></td>
<td>
<p>  number of groups </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements
</p>
<table role = "presentation">
<tr><td><code>X2</code></td>
<td>
<p>HL statistic</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>p-value for the test from Chi Squared with df = g-2</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernardo B. Andrade </p>


<h3>References</h3>

<p>Hosmer D W, Lemeshow S 2000. Applied Logistic Regression. New York, USA: John Wiley and Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lbreg">lbreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(lbreg)

# data preparation
data(PCS)
w &lt;- PCS
w &lt;- w[,-1]
w$race &lt;- factor(w$race)
w$dpros &lt;- factor(w$dpros)
w$dcaps &lt;- factor(w$dcaps)

fm &lt;- lbreg(tumor ~ ., data=w)

HL_test(fm)
</code></pre>

<hr>
<h2 id='lbreg'>Log-Binomial regression</h2><span id='topic+lbreg'></span>

<h3>Description</h3>

<p>Fitting a Log-Binomial Regression Model</p>


<h3>Usage</h3>

<pre><code class='language-R'>lbreg(formula, data, start.beta, tol=0.9999, delta=1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lbreg_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="lbreg_+3A_data">data</code></td>
<td>
 
<p>an optional data frame containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which lbreg is called.
</p>
</td></tr>
<tr><td><code id="lbreg_+3A_start.beta">start.beta</code></td>
<td>

<p>starting values for the parameters in the linear predictor. If missing, the default value explained in 
Andrade and Andrade (2018) is used according to the choice of <code>delta</code>.
</p>
</td></tr>
<tr><td><code id="lbreg_+3A_tol">tol</code></td>
<td>

<p>defaults to 0.9999; threshold for declaring a probability on the boundary (p = 1). 
</p>
</td></tr>
<tr><td><code id="lbreg_+3A_delta">delta</code></td>
<td>

<p>defaults to 1. See reference below.
</p>
</td></tr>
<tr><td><code id="lbreg_+3A_...">...</code></td>
<td>
<p> not used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses <code><a href="stats.html#topic+constrOptim">constrOptim</a></code> with the BFGS method in order
to perform maximum likelihood estimation of the log-binomial regression model
as described in the reference below. When the MLE is the interior of the parameter space results 
should agree with <code>glm(...,family=binomial(link='log'))</code>.
<code>lbreg</code> uses the adaptive logarithimic barrier algorithm rather than 
iteratively weighted least squares (<code>glm</code>).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Active</code></td>
<td>
<p>matrix of active constraints.</p>
</td></tr>
<tr><td><code>barrier.value</code></td>
<td>
<p>same as in <code>constrOptim</code>.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>named vector of estimated regression coefficients.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>same as in <code>constrOptim</code>.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>cook.distance</code></td>
<td>
<p>Cook's distance.</p>
</td></tr> 
<tr><td><code>data</code></td>
<td>
<p>the data argument.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>residual deviance.</p>
</td></tr>
<tr><td><code>dev.resid</code></td>
<td>
<p>deviance residuals.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>fitted probabilities.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula supplied.</p>
</td></tr>
<tr><td><code>hat.matrix</code></td>
<td>
<p>hat matrix for GLMs (whose diagonal contains leverage values).</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>maximized loglikelihood.</p>
</td></tr>
<tr><td><code>outer.iterations</code></td>
<td>
<p>same as in <code>constrOptim</code>.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>Pearson residuals.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>standard errors of estimated coefficients.</p>
</td></tr>
<tr><td><code>start.beta</code></td>
<td>
<p>starting values used by <code>constrOptim</code>.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>variance-covariance matrix of estimates.</p>
</td></tr>
<tr><td><code>vcov0</code></td>
<td>
<p>inverse of observed Fisher information; should be equal to vcov if 
there are no active constraints (Active = NULL).</p>
</td></tr>
<tr><td><code>X2</code></td>
<td>
<p>sum of squared residuals (variance-inflation estimate (dispersion) = X2/df).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernardo B. Andrade 
</p>


<h3>References</h3>

<p>Andrade, BB; Andrade JML (2018) Some results for Maximum Likelihood Estimation of Adjusted Relative Risks. 
Communications in Statistics - Theory and Methods.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code> <code>(family=binomial(link='log'))</code>, <code><a href="#topic+relrisk">relrisk</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(lbreg)

# data preparation
data(PCS)  # ungrouped data
w &lt;- PCS
w &lt;- w[,-1]
w$race &lt;- factor(w$race)
w$dpros &lt;- factor(w$dpros)
w$dcaps &lt;- factor(w$dcaps)

# log-binomial regression
fm &lt;- lbreg(tumor ~ ., data=w)
fm
coef(fm)
summary(fm)


# grouped data
require(lbreg)
data(Caesarian)
m1 &lt;- lbreg( cbind(n1, n0) ~ RISK + NPLAN + ANTIB, data=Caesarian)
summary(m1)

# dispersion estimate based on deviance residuals
sum(m1$dev.res^2)  
# dispersion estimate based on Pearson residuals (reported in the summary above)
sum(m1$residuals^2)/(8-4)  

predict(m1, newdata=data.frame(RISK=0, NPLAN=1, ANTIB=1))

# m0 &lt;- glm( cbind(n1, n0) ~ RISK + NPLAN + ANTIB, data=Dat, family=binomial(link='log'))
# summary(m0)


</code></pre>

<hr>
<h2 id='PCS'>PCS Dataset</h2><span id='topic+PCS'></span>

<h3>Description</h3>

<p>Prostate Cancer Study</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("PCS")</code></pre>


<h3>Format</h3>

<p>A data frame with 380 observations on the following 9 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Identification Code; 1 - 380</p>
</dd>
<dt><code>tumor</code></dt><dd><p>Tumor Penetration of Prostatic Capsule,	0 = No Penetration</p>
</dd>
<dt><code>age</code></dt><dd><p>in years</p>
</dd>
<dt><code>race</code></dt><dd><p>Race; 1= White, 2 = Black</p>
</dd>
<dt><code>dpros</code></dt><dd><p>Results of the Digital Rectal Exam, 4 levels</p>
</dd>
<dt><code>dcaps</code></dt><dd><p>Detection of Capsular Involvement in Rectal Exam; 	1 = No, 2 = Yes	</p>
</dd>
<dt><code>psa</code></dt><dd><p>antigen mg/ml</p>
</dd>
<dt><code>vol</code></dt><dd><p>Tumor Volume Obtained from Ultrasound, cm3</p>
</dd>
<dt><code>gleason</code></dt><dd><p>Total Gleason Score; 0 - 10</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://www.umass.edu/statdata/statdata/data/pros.txt
</p>


<h3>References</h3>

<p>Hosmer and Lemeshow (2000) Applied Logistic Regression, Wiley.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PCS)
## View(PCS)
## str(PCS) ; plot(PCS) ...
</code></pre>

<hr>
<h2 id='predict.lbreg'>
Predict method for Log-Binomial regression.
</h2><span id='topic+predict.lbreg'></span>

<h3>Description</h3>

<p>Predicted values based on 'lbreg' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lbreg'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.lbreg_+3A_object">object</code></td>
<td>
<p>Object of class inheriting from &quot;lbreg&quot;
</p>
</td></tr>
<tr><td><code id="predict.lbreg_+3A_newdata">newdata</code></td>
<td>
  
<p>a data frame with covariate values with which to predict. If omitted, the fitted probabilities are returned.
</p>
</td></tr>
<tr><td><code id="predict.lbreg_+3A_...">...</code></td>
<td>
<p> not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If newdata is omitted the predictions are simply the fitted values stored in the object supplied.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Active</code></td>
<td>
<p>active restrictions (taking newdata into account).</p>
</td></tr>
<tr><td><code>coef.pred</code></td>
<td>
<p>regression coefficients re-estimated to satisfy possibly new restrictions imposed by newdata. See reference below.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>same as in the object supplied.</p>
</td></tr>
<tr><td><code>se.pred</code></td>
<td>
<p>estimated standard errors of predictions.</p>
</td></tr>
<tr><td><code>tol</code></td>
<td>
<p>same as in the object supplied.</p>
</td></tr>
<tr><td><code>ypred</code></td>
<td>
<p>predicted probabilities for newdata.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernardo B. Andrade 
</p>


<h3>References</h3>

<p>Andrade, BB; Andrade JML (2018) Some results for Maximum Likelihood Estimation of Adjusted Relative Risks. 
Communications in Statistics - Theory and Methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(lbreg)

# data preparation
data(PCS)
w &lt;- PCS
w &lt;- w[,-1]
w$race &lt;- factor(w$race)
w$dpros &lt;- factor(w$dpros)
w$dcaps &lt;- factor(w$dcaps)

# log-binomial regression
fm &lt;- lbreg(tumor ~ ., data=w)
novo &lt;- data.frame(age=c(41, 32), race=c(1,2), dpros=c(2,4), 
                   dcaps=c(1,1), psa=c(7.24,3.25), vol=c(4.3,5.6), 
                   gleason=c(2,8))
predict(fm, newdata=novo)
</code></pre>

<hr>
<h2 id='relrisk'>Regression Adjusted Relative Risks
</h2><span id='topic+relrisk'></span>

<h3>Description</h3>

<p>This function calculates the relative risks RR adjusted for 
covariates (acting on a previous log-binomial regression fit) 
and confidence intervals (by default 95 percent) for the estimated RR. 
The confidence interval is calculated from the log(RR) and backtransformed. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relrisk(object, alpha = 0.05, dispersion = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="relrisk_+3A_object">object</code></td>
<td>
<p>object of class 'lbreg'.</p>
</td></tr>
<tr><td><code id="relrisk_+3A_alpha">alpha</code></td>
<td>
<p>1 - desired confidence level.</p>
</td></tr>
<tr><td><code id="relrisk_+3A_dispersion">dispersion</code></td>
<td>
<p>logical. <code>TRUE</code> if standard errors should be adjusted for dispersion estimate based on Pearson residuals.</p>
</td></tr> 
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>value</code></td>
<td>
<p>table with estimated relative risks, lower and upper bounds of condifidence intervals.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernardo B. Andrade </p>


<h3>References</h3>

<p>Andrade, BB; Andrade JML (2018) Some results for Maximum Likelihood Estimation of Adjusted Relative Risks. 
Communications in Statistics - Theory and Methods.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lbreg">lbreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(lbreg)

# ungrouped data
# data preparation
data(PCS)
w &lt;- PCS
w &lt;- w[,-1]
w$race &lt;- factor(w$race)
w$dpros &lt;- factor(w$dpros)
w$dcaps &lt;- factor(w$dcaps)

# log-binomial regression
fm &lt;- lbreg(tumor ~ ., data=w)

# relative risks
relrisk(fm)
relrisk(fm, alpha=.10)

# grouped data 
require(lbreg)
data(Caesarian)
m1 &lt;- lbreg( cbind(n1, n0) ~ RISK + NPLAN + ANTIB, data=Caesarian)
relrisk(m1)
relrisk(m1, dispersion=TRUE)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
