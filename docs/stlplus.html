<!DOCTYPE html><html lang="en"><head><title>Help for package stlplus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stlplus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot_cycle'><p>Cycle-Subseries Plot for an stlplus Object</p></a></li>
<li><a href='#plot_rembycycle'><p>Plot of Remainder Component by Cycle-Subseries</p></a></li>
<li><a href='#plot_seasonal'><p>Seasonal Diagnostic Plot for an stlplus Object</p></a></li>
<li><a href='#plot_trend'><p>Trend Diagnostic Plot for an stlplus Object</p></a></li>
<li><a href='#plot.stlplus'><p>Lattice plot of the raw, seasonal, trend, and remainder components</p></a></li>
<li><a href='#seasonal'><p>Accessor functions for elements of an stl and stlplus object</p></a></li>
<li><a href='#stlplus'><p>Seasonal Decomposition of Time Series by Loess</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Enhanced Seasonal Decomposition of Time Series by Loess</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-01-05</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ryan Hafen &lt;rhafen@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Decompose a time series into seasonal, trend, and remainder
    components using an implementation of Seasonal Decomposition of Time
    Series by Loess (STL) that provides several enhancements over the STL
    method in the stats package.  These enhancements include handling missing
    values, providing higher order (quadratic) loess smoothing with automated
    parameter choices, frequency component smoothing beyond the seasonal and
    trend components, and some basic plot methods for diagnostics.</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>lattice, yaImpute, stats, Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hafen/stlplus">https://github.com/hafen/stlplus</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hafen/stlplus/issues">https://github.com/hafen/stlplus/issues</a></td>
</tr>
<tr>
<td>Note:</td>
<td>This is experimental software distributed free of charge and
comes with no warranty!  Exercise professional caution.</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-01-06 09:27:21 UTC; hafen</td>
</tr>
<tr>
<td>Author:</td>
<td>Ryan Hafen [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-01-06 10:42:19</td>
</tr>
</table>
<hr>
<h2 id='plot_cycle'>Cycle-Subseries Plot for an stlplus Object</h2><span id='topic+plot_cycle'></span>

<h3>Description</h3>

<p>Plots the seasonal component by cycle-subseries, with lines emanating
from the midmean of the values within each cycle-subseries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cycle(x, layout = c(x$pars$n.p, 1), col = "#0080ff", xlab = "Time",
  ylab = "Seasonal", panel = function(x, y, ...) {    
  lattice::panel.segments(x, rep(.midmean(y), length(x)), x, y, col = col) },
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_cycle_+3A_x">x</code></td>
<td>
<p>object of class <code>"stlplus"</code>.</p>
</td></tr>
<tr><td><code id="plot_cycle_+3A_layout">layout</code>, <code id="plot_cycle_+3A_col">col</code>, <code id="plot_cycle_+3A_xlab">xlab</code>, <code id="plot_cycle_+3A_ylab">ylab</code>, <code id="plot_cycle_+3A_panel">panel</code>, <code id="plot_cycle_+3A_...">...</code></td>
<td>
<p>parameters to be passed to <code>xyplot()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>"trellis"</code>.
</p>


<h3>References</h3>

<p>R. B. Cleveland, W. S. Cleveland, J. E.  McRae, and I. Terpenning (1990) STL:  A  Seasonal-Trend  Decomposition  Procedure Based on Loess. <em>Journal of Official Statistics</em>, <b>6</b>, 3&ndash;73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stlplus">stlplus</a></code>
</p>

<hr>
<h2 id='plot_rembycycle'>Plot of Remainder Component by Cycle-Subseries</h2><span id='topic+plot_rembycycle'></span>

<h3>Description</h3>

<p>Plots the remainder component by cycle-subseries with a loess line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_rembycycle(x, col = "darkgray", locol = "black", lolwd = 2,
  xlab = "Time", ylab = "Remainder", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_rembycycle_+3A_x">x</code></td>
<td>
<p>object of class <code>"stlplus"</code>.</p>
</td></tr>
<tr><td><code id="plot_rembycycle_+3A_col">col</code>, <code id="plot_rembycycle_+3A_locol">locol</code>, <code id="plot_rembycycle_+3A_lolwd">lolwd</code>, <code id="plot_rembycycle_+3A_xlab">xlab</code>, <code id="plot_rembycycle_+3A_ylab">ylab</code>, <code id="plot_rembycycle_+3A_...">...</code></td>
<td>
<p>parameters to be passed to <code>xyplot()</code>. <code>locol</code> and <code>lolwd</code> are the line color and width for the loess line.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>"trellis"</code>.
</p>


<h3>References</h3>

<p>R. B. Cleveland, W. S. Cleveland, J. E.  McRae, and I. Terpenning (1990) STL:  A  Seasonal-Trend  Decomposition  Procedure Based on Loess. <em>Journal of Official Statistics</em>, <b>6</b>, 3&ndash;73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stlplus">stlplus</a></code>
</p>

<hr>
<h2 id='plot_seasonal'>Seasonal Diagnostic Plot for an stlplus Object</h2><span id='topic+plot_seasonal'></span>

<h3>Description</h3>

<p>Plots each cycle-subseries of the detrended data (or equivalently,
seasonal plus remainder), with the mean subtracted.  The fitted seasonal
component is plotted as a line through the points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_seasonal(x, col = c("darkgray", "black"), lwd = 2, xlab = "Time",
  ylab = "Centered Seasonal + Remainder", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_seasonal_+3A_x">x</code></td>
<td>
<p>object of class <code>"stlplus"</code>.</p>
</td></tr>
<tr><td><code id="plot_seasonal_+3A_col">col</code>, <code id="plot_seasonal_+3A_lwd">lwd</code>, <code id="plot_seasonal_+3A_xlab">xlab</code>, <code id="plot_seasonal_+3A_ylab">ylab</code>, <code id="plot_seasonal_+3A_...">...</code></td>
<td>
<p>parameters to be passed to <code>xyplot()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Helps decide how much of the variation in the data other than the trend should go into the seasonal component, and how much in the remainder.
</p>


<h3>Value</h3>

<p>object of class <code>"trellis"</code>.
</p>


<h3>References</h3>

<p>R. B. Cleveland, W. S. Cleveland, J. E.  McRae, and I. Terpenning (1990) STL:  A  Seasonal-Trend  Decomposition  Procedure Based on Loess. <em>Journal of Official Statistics</em>, <b>6</b>, 3&ndash;73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stlplus">stlplus</a></code>
</p>

<hr>
<h2 id='plot_trend'>Trend Diagnostic Plot for an stlplus Object</h2><span id='topic+plot_trend'></span>

<h3>Description</h3>

<p>Plots the trend+remainder with the trend component overlaid, and the
remainder component in a separate panel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_trend(x, xlab = "Time", ylab = "Trend", span = 0.3, type = c("p",
  "l"), scales = list(y = list(relation = "free")), lwd = c(1, 1),
  col = c("darkgray", "black", "darkgray"), layout = c(1, 2),
  between = list(y = 0.5), strip = FALSE, strip.left = TRUE,
  as.table = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_trend_+3A_x">x</code></td>
<td>
<p>object of class <code>"stlplus"</code>.</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_xlab">xlab</code>, <code id="plot_trend_+3A_ylab">ylab</code>, <code id="plot_trend_+3A_span">span</code>, <code id="plot_trend_+3A_type">type</code>, <code id="plot_trend_+3A_scales">scales</code>, <code id="plot_trend_+3A_lwd">lwd</code>, <code id="plot_trend_+3A_col">col</code>, <code id="plot_trend_+3A_layout">layout</code></td>
<td>
<p>parameters to be passed to
xyplot.</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_between">between</code>, <code id="plot_trend_+3A_strip">strip</code>, <code id="plot_trend_+3A_strip.left">strip.left</code>, <code id="plot_trend_+3A_as.table">as.table</code>, <code id="plot_trend_+3A_...">...</code></td>
<td>
<p>parameters to be passed to
xyplot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>"trellis"</code>.
</p>


<h3>References</h3>

<p>R. B. Cleveland, W. S. Cleveland, J. E.  McRae, and I. Terpenning (1990) STL:  A  Seasonal-Trend  Decomposition  Procedure Based on Loess. <em>Journal of Official Statistics</em>, <b>6</b>, 3&ndash;73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stlplus">stlplus</a></code>
</p>

<hr>
<h2 id='plot.stlplus'>Lattice plot of the raw, seasonal, trend, and remainder components</h2><span id='topic+plot.stlplus'></span>

<h3>Description</h3>

<p>Lattice plot of the raw, seasonal, trend, and remainder components.  If post-trend smoothing was done, these components will be plotted instead of the trend component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stlplus'
plot(x, scales = list(y = list(relation = "sliced")),
  type = "l", as.table = TRUE, strip = FALSE, strip.left = TRUE,
  between = list(y = 0.5), layout = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.stlplus_+3A_x">x</code></td>
<td>
<p>object of class <code>"stlplus"</code>.</p>
</td></tr>
<tr><td><code id="plot.stlplus_+3A_scales">scales</code>, <code id="plot.stlplus_+3A_type">type</code>, <code id="plot.stlplus_+3A_as.table">as.table</code>, <code id="plot.stlplus_+3A_strip">strip</code>, <code id="plot.stlplus_+3A_strip.left">strip.left</code>, <code id="plot.stlplus_+3A_between">between</code>, <code id="plot.stlplus_+3A_layout">layout</code>, <code id="plot.stlplus_+3A_...">...</code></td>
<td>
<p>parameters to be passed to xyplot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>"trellis"</code>.
</p>


<h3>References</h3>

<p>R. B. Cleveland, W. S. Cleveland, J. E.  McRae, and I. Terpenning (1990) STL:  A  Seasonal-Trend  Decomposition  Procedure Based on Loess. <em>Journal of Official Statistics</em>, <b>6</b>, 3&ndash;73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stlplus">stlplus</a></code>
</p>

<hr>
<h2 id='seasonal'>Accessor functions for elements of an stl and stlplus object</h2><span id='topic+fc'></span><span id='topic+fitted.stl'></span><span id='topic+fitted.stlplus'></span><span id='topic+getraw'></span><span id='topic+predict.stl'></span><span id='topic+predict.stlplus'></span><span id='topic+remainder'></span><span id='topic+remainder.stl'></span><span id='topic+remainder.stlplus'></span><span id='topic+seasonal'></span><span id='topic+seasonal.stl'></span><span id='topic+seasonal.stlplus'></span><span id='topic+time.stl'></span><span id='topic+time.stlplus'></span><span id='topic+trend'></span><span id='topic+trend.stl'></span><span id='topic+trend.stlplus'></span>

<h3>Description</h3>

<p>Retrieves the raw, seasonal, trend, remainder, or time components from an stlplus object.  The methods <code>seasonal.stl</code>, ... also exist as a convenience for extracting components from R's <code>stl()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seasonal(object)

trend(object)

remainder(object)

getraw(object)

## S3 method for class 'stlplus'
remainder(object)

## S3 method for class 'stlplus'
fitted(object, ...)

## S3 method for class 'stlplus'
predict(object, ...)

## S3 method for class 'stlplus'
seasonal(object)

## S3 method for class 'stlplus'
trend(object)

fc(object, fcnum = 1)

## S3 method for class 'stlplus'
time(x, ...)

## S3 method for class 'stl'
remainder(object)

## S3 method for class 'stl'
seasonal(object)

## S3 method for class 'stl'
trend(object)

## S3 method for class 'stl'
time(x, ...)

## S3 method for class 'stl'
predict(object, ...)

## S3 method for class 'stl'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seasonal_+3A_fcnum">fcnum</code></td>
<td>
<p>number of post-trend smoothing frequency component.</p>
</td></tr>
<tr><td><code id="seasonal_+3A_x">x</code>, <code id="seasonal_+3A_object">object</code></td>
<td>
<p>object of class <code>"stl"</code> or <code>"stlplus"</code>.</p>
</td></tr>
<tr><td><code id="seasonal_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of either the <code>getraw</code> time series, the <code>seasonal</code>, <code>trend</code>, or <code>remainder</code> components, or the <code>time</code> values of the time series.  If <code>time</code>s are requested but were not supplied in the initial <code>stlplus</code> call, the <code>1:n</code> vector is returned, where <code>n</code> is the number of data points.  The <code>fitted</code> method returns the sum of the seasonal and trend.
</p>


<h3>Note</h3>

<p>The <code>fitted</code> and <code>predict</code> methods are equivalent.  For objects of class <code>"stlplus"</code>, these functions return the sum of all components but the remainder, including post-trend smoothing components.  Note also that the <code>trend</code> method for objects of class <code>"stlplus"</code> only returns the trend component from the STL iterations, even when post-trend smoothing is done.
</p>


<h3>References</h3>

<p>R. B. Cleveland, W. S. Cleveland, J.E.  McRae, and I. Terpenning (1990) STL:  A  Seasonal-Trend  Decomposition  Procedure Based on Loess. <em>Journal of Official Statistics</em>, <b>6</b>, 3&ndash;73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stlplus">stlplus</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>co2.stl &lt;- stlplus(co2, t = as.vector(stats::time(co2)), n.p=12, l.window=13,
t.window=19, s.window=35, s.degree=1, sub.labels = substr(month.name, 1, 3))

plot(seasonal(co2.stl))
</code></pre>

<hr>
<h2 id='stlplus'>Seasonal Decomposition of Time Series by Loess</h2><span id='topic+stlplus'></span><span id='topic+stlplus.ts'></span><span id='topic+stlplus.zoo'></span>

<h3>Description</h3>

<p>Decompose a time series into seasonal, trend and irregular components using <code>loess</code>, acronym STL.  A new implementation of STL.  Allows for NA values, local quadratic smoothing,  post-trend smoothing, and endpoint blending.  The usage is very similar to that of R's built-in <code>stl()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stlplus(x, t = NULL, n.p, s.window, s.degree = 1, t.window = NULL,
  t.degree = 1, fc.window = NULL, fc.degree = NULL, fc.name = NULL,
  l.window = NULL, l.degree = t.degree, s.jump = ceiling(s.window/10),
  t.jump = ceiling(t.window/10), l.jump = ceiling(l.window/10),
  fc.jump = NULL, critfreq = 0.05, s.blend = 0, t.blend = 0,
  l.blend = t.blend, fc.blend = NULL, inner = 2, outer = 1,
  sub.labels = NULL, sub.start = 1, zero.weight = 0.000001,
  details = FALSE, ...)

## S3 method for class 'ts'
stlplus(x, t = as.numeric(stats::time(x)), n.p = frequency(x),
  s.window, s.degree = 1, t.window = NULL, t.degree = 1,
  fc.window = NULL, fc.degree = NULL, fc.name = NULL, l.window = NULL,
  l.degree = t.degree, s.jump = ceiling(s.window/10),
  t.jump = ceiling(t.window/10), l.jump = ceiling(l.window/10),
  fc.jump = NULL, critfreq = 0.05, s.blend = 0, t.blend = 0,
  l.blend = t.blend, fc.blend = NULL, inner = 2, outer = 1,
  sub.labels = NULL, sub.start = 1, zero.weight = 0.000001,
  details = FALSE, ...)

## S3 method for class 'zoo'
stlplus(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stlplus_+3A_x">x</code></td>
<td>
<p>vector of time series values, in order of time.  If <code>x</code> is a time series object, then <code>t</code> and <code>n.p</code> do not need to be specified, although they still can be.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_t">t</code></td>
<td>
<p>times at which the time series values were observed.  Not required.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_n.p">n.p</code></td>
<td>
<p>periodicity of the seasonal component.  In R's <code>stl</code> function, this is the frequency of the time series.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_s.window">s.window</code></td>
<td>
<p>either the character string <code>"periodic"</code> or the span (in lags) of the loess window for seasonal extraction, which should be odd.  This has no default.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_s.degree">s.degree</code></td>
<td>
<p>degree of locally-fitted polynomial in seasonal extraction.  Should be 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_t.window">t.window</code></td>
<td>
<p>the span (in lags) of the loess window for trend extraction, which should be odd.  If <code>NULL</code>, the default, <code>nextodd(ceiling((1.5*period) / (1-(1.5/s.window))))</code>, is taken.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_t.degree">t.degree</code></td>
<td>
<p>degree of locally-fitted polynomial in trend extraction.  Should be 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_fc.window">fc.window</code></td>
<td>
<p>vector of lengths of windows for loess smoothings for other trend frequency components after the original STL decomposition has been obtained.  The smoothing is applied to the data with the STL seasonal component removed.  A frequency component is computed by a loess fit with the window length equal to the first element of fc.window, the component is removed, another component is computed with the window length equal to the second element of fc.window, and so forth. In most cases, the values of the argument should be decreasing, that is, the frequency bands of the fitted components should increase. The robustness weights from original STL are used as weights in the loess fitting if specified.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_fc.degree">fc.degree</code></td>
<td>
<p>vector of degrees of locally-fitted polynomial in the loess smoothings for the frequency components specified in fc.window. Values of 0, 1 and 2 are allowed. If the length of fc.degree is less than that of fc.window, the former is expanded to the length of the latter using rep; thus, giving the value 1 specifies a degree of 1 for all components.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_fc.name">fc.name</code></td>
<td>
<p>vector of names of the post-trend smoothing operations specified by <code>fc.window</code> and <code>fc.degree</code> (optional).</p>
</td></tr>
<tr><td><code id="stlplus_+3A_l.window">l.window</code></td>
<td>
<p>the span (in lags) of the loess window of the low-pass filter used for each subseries.  Defaults to the smallest odd integer greater than or equal to <code>n.p</code> which is recommended since it prevents competition between the trend and seasonal components.  If not an odd integer its given value is increased to the next odd one.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_l.degree">l.degree</code></td>
<td>
<p>degree of locally-fitted polynomial for the subseries low-pass filter.  Should be 0, 1, or 2.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_s.jump">s.jump</code>, <code id="stlplus_+3A_t.jump">t.jump</code>, <code id="stlplus_+3A_l.jump">l.jump</code>, <code id="stlplus_+3A_fc.jump">fc.jump</code></td>
<td>
<p>integers at least one to increase speed of the respective smoother.  Linear interpolation happens between every <code>*.jump</code>th value.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_critfreq">critfreq</code></td>
<td>
<p>the critical frequency to use for automatic calculation of smoothing windows for the trend and high-pass filter.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_s.blend">s.blend</code>, <code id="stlplus_+3A_t.blend">t.blend</code>, <code id="stlplus_+3A_l.blend">l.blend</code>, <code id="stlplus_+3A_fc.blend">fc.blend</code></td>
<td>
<p>vectors of proportion of blending to degree 0 polynomials at the endpoints of the series.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_inner">inner</code></td>
<td>
<p>integer; the number of &lsquo;inner&rsquo; (backfitting) iterations; usually very few (2) iterations suffice.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_outer">outer</code></td>
<td>
<p>integer; the number of &lsquo;outer&rsquo; robustness iterations.  Default is 0, but Recommended if outliers are present.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_sub.labels">sub.labels</code></td>
<td>
<p>optional vector of length n.p that contains the labels of the subseries in their natural order (such as month name, day of week, etc.), used for strip labels when plotting.  All entries must be unique.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_sub.start">sub.start</code></td>
<td>
<p>which element of sub.labels does the series begin with.  See details.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_zero.weight">zero.weight</code></td>
<td>
<p>value to use as zero for zero weighting</p>
</td></tr>
<tr><td><code id="stlplus_+3A_details">details</code></td>
<td>
<p>if <code>TRUE</code>, returns a list of the results of all the intermediate iterations.</p>
</td></tr>
<tr><td><code id="stlplus_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The seasonal component is found by <em>loess</em> smoothing the seasonal sub-series (the series of all January values, ...); if <code>s.window = "periodic"</code> smoothing is effectively replaced by taking the mean. The seasonal values are removed, and the remainder smoothed to find the trend. The overall level is removed from the seasonal component and added to the trend component. This process is iterated a few times.  The <code>remainder</code> component is the residuals from the seasonal plus trend fit.
</p>
<p>Cycle-subseries labels are useful for plotting and can be specified through the sub.labels argument.  Here is an example for how the sub.labels and sub.start parameters might be set for one situation.  Suppose we have a daily series with n.p=7 (fitting a day-of-week component).  Here, sub.labels could be set to c(&quot;Sun&quot;, &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;).  Now, if the series starts with a Wednesday value, then one would specify sub.labels=4, since Wednesday is the fourth element of sub.labels.  This ensures that the labels in the plots to start the plotting with Sunday cycle-subseries instead of Wednesday.
</p>


<h3>Value</h3>

<p>returns an object of class <code>"stlplus"</code>, containing
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>data frame containing all of the components: <code>raw</code>, <code>seasonal</code>, <code>trend</code>, <code>remainder</code>, <code>weights</code>.</p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>list of parameters used in the procedure.</p>
</td></tr>
<tr><td><code>fc.number</code></td>
<td>
<p>number of post-trend frequency components fitted.</p>
</td></tr>
<tr><td><code>fc</code></td>
<td>
<p>data frame of the post-trend frequency components.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>vector of time values corresponding to the raw values, if specified.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code>sub.labels</code></td>
<td>
<p>the cycle-subseries labels.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is a complete re-implementation of the STL algorithm, with the loess part in C and the rest in R.  Moving a lot of the code to R makes it easier to experiment with the method at a very minimal speed cost.  Recoding in C instead of using R's built-in loess results in better performance, especially for larger series.
</p>


<h3>Author(s)</h3>

<p>Ryan Hafen
</p>


<h3>References</h3>

<p>R. B. Cleveland, W. S. Cleveland, J. E.  McRae, and I. Terpenning (1990) STL:  A  Seasonal-Trend  Decomposition  Procedure Based on Loess. <em>Journal of Official Statistics</em>, <b>6</b>, 3&ndash;73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.stlplus">plot.stlplus</a></code> for plotting the components, <code><a href="#topic+getraw">getraw</a></code>, <code><a href="#topic+seasonal">seasonal</a></code>, <code><a href="#topic+trend">trend</a></code>, <code><a href="#topic+remainder">remainder</a></code> for accessing the components.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>co2_stl &lt;- stlplus(co2, t = as.vector(time(co2)), n.p = 12,
  l.window = 13, t.window = 19, s.window = 35, s.degree = 1,
  sub.labels = substr(month.name, 1, 3))

plot(co2_stl, ylab = "CO2 Concentration (ppm)", xlab = "Time (years)")
plot_seasonal(co2_stl)
plot_trend(co2_stl)
plot_cycle(co2_stl)
plot_rembycycle(co2_stl)

# post-trend smoothing

co2_stl_pt &lt;- stlplus(co2, t = as.vector(time(co2)), n.p = 12,
  l.window = 13, t.window = 19, s.window = 35, s.degree = 1,
  sub.labels = substr(month.name, 1, 3),
  fc.degree = c(1, 2), fc.window = c(201, 35),
  fc.name = c("long-term", "so. osc."))

plot(co2_stl_pt, scales = list(y = list(relation = "free")),
  ylab = "CO2 Concentration (ppm)", xlab = "Time (years)",
  aspect = 0.25, type = c("l", "g"))

# with NAs

y &lt;- co2
y[201:224] &lt;- NA

y_stl &lt;- stlplus(y, l.window = 13, t.window = 19, s.window = 35,
  s.degree = 1, sub.labels = substr(month.name, 1, 3))

plot(y_stl, ylab = "CO2 Concentration (ppm)", xlab = "Time (years)", type = c("l", "g"))
plot_seasonal(y_stl)
plot_trend(y_stl)
plot_cycle(y_stl)
plot_rembycycle(y_stl)

# if you don't want to use a time series object:
y_stl &lt;- stlplus(y, t = as.vector(time(y)), n.p = 12,
  l.window = 13, t.window = 19, s.window = 35, s.degree = 1,
  sub.labels = substr(month.name, 1, 3))

# with an outlier
y2 &lt;- co2
y2[200] &lt;- 300

y2_stl &lt;- stlplus(y2, t = as.vector(time(y2)), n.p = 12,
  l.window = 13, t.window = 19, s.window = 35, s.degree = 1,
  sub.labels = substr(month.name, 1, 3), outer = 10)

plot(y2_stl, ylab = "CO2 Concentration (ppm)", xlab = "Time (years)")
plot_seasonal(y2_stl)
plot_trend(y2_stl)
plot_cycle(y2_stl)
plot_rembycycle(y2_stl)

# compare to R's stl

x1 &lt;- stlplus(co2, t = as.vector(time(co2)), n.p = 12,
  l.window = 13, t.window = 19, s.window = 11, s.degree = 1,
  sub.labels = substr(month.name, 1, 3))

x2 &lt;- stl(co2, l.window = 13, t.window = 19, s.window = 11, s.degree = 1)

# will be different due to interpolation differences
plot(seasonal(x1) - seasonal(x2))

# but not if all jump parameters are 1
x1 &lt;- stlplus(co2, t = as.vector(time(co2)), n.p = 12,
  l.window = 13, t.window = 19, s.window = 11, s.degree = 1,
  sub.labels = substr(month.name, 1, 3),
  s.jump = 1, t.jump = 1, l.jump = 1)

x2 &lt;- stl(co2, l.window = 13, t.window = 19, s.window = 11, s.degree = 1,
  s.jump = 1, t.jump = 1, l.jump = 1)

plot(seasonal(x1) - seasonal(x2))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
