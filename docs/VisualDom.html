<!DOCTYPE html><html><head><title>Help for package VisualDom</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VisualDom}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#estim_WLMC'><p>Estimates the wavelet local multiple correlation</p></a></li>
<li><a href='#plot_dominant_WLMC'><p>Plot as a heat map the 'dominant' variable/s contained in the output of the function 'estim_WLMC'</p></a></li>
<li><a href='#plot_estim_WLMC'><p>Plot as a heat map the correlation coefficients contained in the output of the function 'estim_WLMC'</p></a></li>
<li><a href='#rdata_climate'><p>Climate data set to exemplify the use of the functions contained in <em>VisualDom</em></p></a></li>
<li><a href='#rdata_Lorenz'><p>Data set generated via the Lorenz system and used to exemplify the functions contained in <em>VisualDom</em></p></a></li>
<li><a href='#VisualDom-package'><p>Visualize Dominant Variables in Wavelet Multiple Correlation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualize Dominant Variables in Wavelet Multiple Correlation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josué M. Polanco-Martínez &lt;josue.m.polanco@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), waveslim, wavemulcor, plot3D</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates and plots as a heat map the correlation coefficients obtained via the wavelet local multiple correlation 'WLMC' (Fernández-Macho 2018) and the 'dominant' variable/s, i.e., the variable/s that maximizes the multiple correlation through time and scale (Polanco-Martínez et al. 2020, Polanco-Martínez 2022). We improve the graphical outputs of WLMC proposing a didactic and useful way to visualize the 'dominant' variable(s) for a set of time series. The WLMC was designed for financial time series, but other kinds of data (e.g., climatic, ecological, etc.) can be used. The functions contained in 'VisualDom' are highly flexible since these contains several parameters to personalize the time series under analysis and the heat maps. In addition, we have also included two data sets (named 'rdata_climate' and 'rdata_Lorenz') to exemplify the use of the functions contained in 'VisualDom'. Methods derived from Fernández-Macho (2018) &lt;<a href="https://doi.org/10.1016%2Fj.physa.2017.11.050">doi:10.1016/j.physa.2017.11.050</a>&gt;, Polanco-Martínez et al. (2020) &lt;<a href="https://doi.org/10.1038%2Fs41598-020-77767-8">doi:10.1038/s41598-020-77767-8</a>&gt; and Polanco-Martínez (2023, in press). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-06 11:30:05 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-23 23:05:39 UTC; jomopo</td>
</tr>
<tr>
<td>Author:</td>
<td>Josué M. Polanco-Martínez
    <a href="https://orcid.org/0000-0001-7164-0185"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cph,
    cre]</td>
</tr>
</table>
<hr>
<h2 id='estim_WLMC'>Estimates the wavelet local multiple correlation 
</h2><span id='topic+estim_WLMC'></span><span id='topic+estimation_WLMC'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+estim_WLMC">estim_WLMC</a></code> function estimates the wavelet local multiple correlation (WLMC) for a set of multivariate time series. The function is based mainly on the work of Fernández-Macho (2018) and to lesser extent in the work of Polanco-Martínez et al. (2020). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estim_WLMC(inputdata, wf="la8", J, window, M, Ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estim_WLMC_+3A_inputdata">inputdata</code></td>
<td>
 
<p>A matrix of N columns by P rows: the first column is time (regular/evenly spaced) and the other columns are the variables under study. 
</p>
</td></tr>
<tr><td><code id="estim_WLMC_+3A_wf">wf</code></td>
<td>

<p>Name of the wavelet filter used in the wavelet transform (MODWT) decomposition. There are several wavelet filters to be used, but we use by default the Daubechies orthonormal compactly supported wavelet of length L=8, that is, &ldquo;la8&rdquo;. 
</p>
</td></tr>
<tr><td><code id="estim_WLMC_+3A_j">J</code></td>
<td>

<p>The  maximum level of the MODWT decomposition. It is recommended to use <code class="reqn">log2(N) - 3</code>, where N is the number of rows or elements of <code>inputdata</code> (Fernández-Macho 2018, Polanco-Martínez et al. 2020). 
</p>
</td></tr>
<tr><td><code id="estim_WLMC_+3A_window">window</code></td>
<td>

<p>Weight or window function, by the default is the Gaussian window (<em>gaussian</em>) but other five window functions can be used, e.g., uniform, Bartlett's triangular, Cleveland's tricube, Wendland's truncated power or Epanechnikov's parabolic. Please look at the function <code>wave.local.multiple.correlation</code> from the <span class="rlang"><b>R</b></span> package wavemulcor (Fernandez-Macho 2018).
</p>
</td></tr>
<tr><td><code id="estim_WLMC_+3A_m">M</code></td>
<td>
 
<p>The length of the weight/window function, it is recommended to use <code class="reqn">N/8</code>, where N is the number of rows or columns (Fernández-Macho 2018, Polanco-Martínez et al. 2020).
</p>
</td></tr>
<tr><td><code id="estim_WLMC_+3A_ymaxr">Ymaxr</code></td>
<td>
 
<p>This parameter is used to indicate which variable will be used to maximize the multiple correlation for each wavelet scale, by default is 'NULL', that is, we do not define a priori an specific variable but instead let the WLMC select one (Fernández-Macho 2018, Polanco-Martínez et al. 2020). 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+estim_WLMC">estim_WLMC</a></code> function estimates the WLMC for multivariate time series including the correlation coefficients and their statistical significance. The <code><a href="#topic+estim_WLMC">estim_WLMC</a></code> function uses the function <code>wave.local.multiple.correlation</code> (package:wavemulcor) to estimate the wavelet local multiple correlation, and the functions <code>modwt</code> and <code>brick.wall</code> (package:waveslim) to carry out the wavelet decomposition of the time series under study.
</p>


<h3>Value</h3>

<p>Outputs: 
A list named <code>LISTvals</code> that contains four elements: <code>CORCOEF</code> that contains the correlation coefficients, <code>CIlo</code> and <code>CIup</code> are the lower and upper confidence intervals (CI), and <code>YmaxR</code> contains the indices (numbers from 1 to the number of columns or variables) of the corresponding variables whose correlation is calculated against a linear combination of the rest. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br />
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a> <br />
Acknowledgement:<br /> 
We acknowledge to the Excellence Unit GECOS (reference number CLU-2019-03), Universidad de Salamanca for its funding support. 
</p>


<h3>References</h3>

<p>Fernández-Macho, J. (2018). Time-localized wavelet multiple regression and correlation. Physica A: Statistical Mechanics and its Applications, 492, 1226-1238. &lt;URL: doi: <a href="https://doi.org/10.1016/j.physa.2017.11.050">10.1016/j.physa.2017.11.050</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M., Fernández-Macho, J., &amp; Medina-Elizalde, M. (2020). Dynamic wavelet correlation analysis for multivariate climate time series. Scientific Reports, 10(1), 1-11. &lt;URL: doi: <a href="https://doi.org/10.1038/s41598-020-77767-8">10.1038/s41598-020-77767-8</a>&gt;. <br /> 
</p>
<p>Whitcher, B., Guttorp, P., &amp; Percival, D. B. (2000). Wavelet analysis of covariance with application to atmospheric time series. Journal of Geophysical Research: Atmospheres, 105(D11), 14941-14962. &lt;URL: doi: <a href="https://doi.org/10.1029/2000JD900110">10.1029/2000JD900110</a>&gt;.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# We reproduce Figure 3 left presented in Polanco-Martínez et al. (2020). 
inputdata  &lt;- rdata_climate
N          &lt;- nrow(inputdata)
wf         &lt;- "la8"               
window     &lt;- "gaussian"          
J          &lt;- 7 
M          &lt;- 168 

output_WLMC &lt;- estim_WLMC(inputdata, wf=wf, J=J, window=window, M=M, Ymaxr=NULL) 

</code></pre>

<hr>
<h2 id='plot_dominant_WLMC'>Plot as a heat map the 'dominant' variable/s contained in the output of the function 'estim_WLMC'
</h2><span id='topic+plot_dominant_WLMC'></span><span id='topic+plot_dominante_WLMC'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+plot_dominant_WLMC">plot_dominant_WLMC</a></code> function plots as a heat map the 'dominant' (that is, the variable/s that maximizes the multiple correlation through time and scale) variable/s of the time series analysed. This function also plots the time series under analysis and discern the correlation coefficients that are not statistically significant, which are plotted as blanks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_dominant_WLMC(inputdata, LISTvals, J, fac=1, FLAG=TRUE, FLAGNA=1, 
                   COLS=c(1:5), LTY=c(rep(1,5)), LWD=c(rep(1.2,5)), 
                   DIST=c(seq(0,10,2)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_dominant_WLMC_+3A_inputdata">inputdata</code></td>
<td>
 
<p>A matrix of N columns by P rows: the first column is time (regular/evenly spaced) and the other columns are the variables under study. 
</p>
</td></tr>
<tr><td><code id="plot_dominant_WLMC_+3A_listvals">LISTvals</code></td>
<td>

<p>Output of the function <code><a href="#topic+estim_WLMC">estim_WLMC</a></code>. This is a list that contains: (1) CORCOEF (correlation coefficients), (2) CIlo (CI lower bounds), (3) CIup (CI upper bounds), and (4) YmaxR (the index numbers, from 1 to number of variables, of the variable whose correlation is calculated against a linear combination of the rest).
</p>
</td></tr>
<tr><td><code id="plot_dominant_WLMC_+3A_j">J</code></td>
<td>

<p>The  maximum level of the MODWT decomposition. It is recommended to use <code class="reqn">log2(N) - 3</code>, where N is the number of rows or elements of <code>inputdata</code> (Fernández-Macho 2018, Polanco-Martínez et al. 2020). 
</p>
</td></tr>
<tr><td><code id="plot_dominant_WLMC_+3A_fac">fac</code></td>
<td>

<p>This factor is used to scale the wavelet time-scales or 'periods' when the time scale is not the unit, by the default is 1. 
</p>
</td></tr>
<tr><td><code id="plot_dominant_WLMC_+3A_flag">FLAG</code></td>
<td>

<p>This 'flag' is used to plot the Y axis of the multivariate time series if the number of these series is less than four, by default is TRUE. 
</p>
</td></tr>
<tr><td><code id="plot_dominant_WLMC_+3A_flagna">FLAGNA</code></td>
<td>

<p>This is used to plot (by the default is 1) or not (please us 0) the correlation coefficients that are/not statistically significant. 
</p>
</td></tr>
<tr><td><code id="plot_dominant_WLMC_+3A_cols">COLS</code></td>
<td>

<p>The colors used to plot the multivariate time series. 
</p>
</td></tr>
<tr><td><code id="plot_dominant_WLMC_+3A_lty">LTY</code></td>
<td>

<p>The type of lines used to plot the multivariate time series.
</p>
</td></tr>
<tr><td><code id="plot_dominant_WLMC_+3A_lwd">LWD</code></td>
<td>

<p>The tick sizes used to plot the multivariate time series. 
</p>
</td></tr>
<tr><td><code id="plot_dominant_WLMC_+3A_dist">DIST</code></td>
<td>

<p>This parameter is used to define the distances between the Y axis when the multivariate time series are plotted. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+plot_dominant_WLMC">plot_dominant_WLMC</a></code> function plots as a heat map the 'dominant' variable/s, that is, the variable/s that maximizes the multiple correlation through time and scale of the variables (time series) analysed. This function also plot the time series under analysis and discern the correlation coefficients that are not statistically significant, we use blanks to plot these coefficients.
</p>


<h3>Value</h3>

<p>A plot of the time series under analysis and a heat map (a multi-plot via screen) of the dominant variable/s whose correlation coefficients are statistically significant. This multi-plot can be saved in your preferred format.
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br />
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a> <br />
Acknowledgement:<br /> 
We acknowledge to the Excellence Unit GECOS (reference number CLU-2019-03), Universidad de Salamanca for its funding support. 
</p>


<h3>References</h3>

<p>Fernández-Macho, J. (2018). Time-localized wavelet multiple regression and correlation. Physica A: Statistical Mechanics and its Applications, 492, 1226-1238. &lt;URL: doi: <a href="https://doi.org/10.1016/j.physa.2017.11.050">10.1016/j.physa.2017.11.050</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M., Fernández-Macho, J., &amp; Medina-Elizalde, M. (2020). Dynamic wavelet correlation analysis for multivariate climate time series. Scientific Reports, 10(1), 1-11. &lt;URL: doi: <a href="https://doi.org/10.1038/s41598-020-77767-8">10.1038/s41598-020-77767-8</a>&gt;. <br /> 
</p>
<p>Whitcher, B., Guttorp, P., &amp; Percival, D. B. (2000). Wavelet analysis of covariance with application to atmospheric time series. Journal of Geophysical Research: Atmospheres, 105(D11), 14941-14962. &lt;URL: doi: <a href="https://doi.org/10.1029/2000JD900110">10.1029/2000JD900110</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J.M. (2023, in press), A computational and graphical approach to analyze the dynamic wavelet correlation among components of a nonlinear dynamical system, Journal of Applied Nonlinear Dynamics, 1-13.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We reproduce Figure 3 below presented in Polanco-Martínez (2023). 
#\donttest{
inputdata  &lt;- rdata_Lorenz 
N          &lt;- nrow(inputdata)
wf         &lt;- "la8"               
window     &lt;- "gaussian"          
J          &lt;- 6 
M          &lt;- 20 

LISTvals &lt;- estim_WLMC(inputdata, wf=wf, J=J, window=window, M=M, Ymaxr=NULL) 

plot_dominant_WLMC(inputdata, LISTvals=LISTvals, J=J, fac=0.05, 
  FLAG=TRUE, FLAGNA=1, COLS=c("blue", "green", "red"), 
  LTY=c(rep(1,5)), LWD=c(rep(1.2,5)), DIST=c(seq(0, 10, 2.75)))
#}
</code></pre>

<hr>
<h2 id='plot_estim_WLMC'>Plot as a heat map the correlation coefficients contained in the output of the function 'estim_WLMC'
</h2><span id='topic+plot_estim_WLMC'></span><span id='topic+plot_estimation_WLMC'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+plot_estim_WLMC">plot_estim_WLMC</a></code> function plots as a heat map the output of the <code><a href="#topic+estim_WLMC">estim_WLMC</a></code> function. One of the features of <code><a href="#topic+plot_estim_WLMC">plot_estim_WLMC</a></code> is that this function discern the correlation coefficients that are not statistically significant, which use blanks to plot these coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_estim_WLMC(inputdata, LISTvals, J, fac=1, FLAG=TRUE, FLAGNA=1, 
                COLS=c(1:5), LTY=c(rep(1,5)), LWD=c(rep(1.2,5)), 
                DIST=c(seq(0,10,2)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_estim_WLMC_+3A_inputdata">inputdata</code></td>
<td>
 
<p>A matrix of N columns by P rows: the first column is time (regular/evenly spaced) and the other columns are the variables under study. 
</p>
</td></tr>
<tr><td><code id="plot_estim_WLMC_+3A_listvals">LISTvals</code></td>
<td>

<p>Output of the function <code><a href="#topic+estim_WLMC">estim_WLMC</a></code>. This is a list that contains: (1) CORCOEF (correlation coefficients), (2) CIlo (CI lower bounds ), (3) CIup (CI upper bounds), and (4) YmaxR (the index numbers, from 1 to number of variables, of the variable whose correlation is calculated against a linear combination of the rest).
</p>
</td></tr>
<tr><td><code id="plot_estim_WLMC_+3A_j">J</code></td>
<td>

<p>The  maximum level of the MODWT decomposition. It is recommended to use <code class="reqn">log2(N) - 3</code>, where N is the number of rows or elements of <code>inputdata</code> (Fernández-Macho 2018, Polanco-Martínez et al. 2020). 
</p>
</td></tr>
<tr><td><code id="plot_estim_WLMC_+3A_fac">fac</code></td>
<td>

<p>This factor is used to scale the wavelet time-scales or 'periods' when the time scale is not the unit, by the default is 1. 
</p>
</td></tr>
<tr><td><code id="plot_estim_WLMC_+3A_flag">FLAG</code></td>
<td>

<p>This 'flag' is used to plot the Y axis of the multivariate time series if the number of these series is less than four, by default is TRUE. 
</p>
</td></tr>
<tr><td><code id="plot_estim_WLMC_+3A_flagna">FLAGNA</code></td>
<td>

<p>This is used to plot (by the default is 1) or not (please us 0) the correlation coefficients that are/not statistically significant. 
</p>
</td></tr>
<tr><td><code id="plot_estim_WLMC_+3A_cols">COLS</code></td>
<td>

<p>The colors used to plot the multivariate time series. 
</p>
</td></tr>
<tr><td><code id="plot_estim_WLMC_+3A_lty">LTY</code></td>
<td>

<p>The type of lines used to plot the multivariate time series.
</p>
</td></tr>
<tr><td><code id="plot_estim_WLMC_+3A_lwd">LWD</code></td>
<td>

<p>The tick sizes used to plot the multivariate time series. 
</p>
</td></tr>
<tr><td><code id="plot_estim_WLMC_+3A_dist">DIST</code></td>
<td>

<p>This parameter is used to define the distances between the Y axis when the multivariate time series are plotted. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+plot_estim_WLMC">plot_estim_WLMC</a></code> function plots as a heat map the output of the <code><a href="#topic+estim_WLMC">estim_WLMC</a></code> function. This function plot the multivariate time series under analysis and the aforementioned heat map. Another feature of <code><a href="#topic+plot_estim_WLMC">plot_estim_WLMC</a></code> is that this function plot the correlation coefficients that are/not statistically significant, which use blanks to plot the coefficients that are not significant. 
</p>


<h3>Value</h3>

<p>Outputs: 
A plot of the time series under analysis and a heat map (a multi-plot via screen) of the wavelet correlation coefficients statistically significant. This multi-plot can be saved in your preferred format.
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br />
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a> <br />
Acknowledgement:<br /> 
We acknowledge to the Excellence Unit GECOS (reference number CLU-2019-03), Universidad de Salamanca for its funding support. 
</p>


<h3>References</h3>

<p>Fernández-Macho, J. (2018). Time-localized wavelet multiple regression and correlation. Physica A: Statistical Mechanics and its Applications, 492, 1226-1238. &lt;URL: doi: <a href="https://doi.org/10.1016/j.physa.2017.11.050">10.1016/j.physa.2017.11.050</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M., Fernández-Macho, J., &amp; Medina-Elizalde, M. (2020). Dynamic wavelet correlation analysis for multivariate climate time series. Scientific Reports, 10(1), 1-11. &lt;URL: doi: <a href="https://doi.org/10.1038/s41598-020-77767-8">10.1038/s41598-020-77767-8</a>&gt;. <br /> 
</p>
<p>Whitcher, B., Guttorp, P., &amp; Percival, D. B. (2000). Wavelet analysis of covariance with application to atmospheric time series. Journal of Geophysical Research: Atmospheres, 105(D11), 14941-14962. &lt;URL: doi: <a href="https://doi.org/10.1029/2000JD900110">10.1029/2000JD900110</a>&gt;.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# We reproduce Figure 3 left presented in Polanco-Martínez et al. (2020). 
inputdata  &lt;- rdata_climate
N          &lt;- nrow(inputdata)
wf         &lt;- "la8"               
window     &lt;- "gaussian"          
J          &lt;- 7 
M          &lt;- 168 

LISTvals &lt;- estim_WLMC(inputdata, wf=wf, J=J, window=window, M=M, Ymaxr=NULL) 

plot_estim_WLMC(inputdata, LISTvals=LISTvals, J=J, fac=1, FLAG=TRUE, 
  FLAGNA=1, COLS=c("blue", "green", "red"), LTY=c(rep(1,5)), 
  LWD=c(rep(1.2,5)), DIST=c(seq(0, 10, 2.75)))

</code></pre>

<hr>
<h2 id='rdata_climate'>Climate data set to exemplify the use of the functions contained in <em>VisualDom</em> 
</h2><span id='topic+rdata_climate'></span>

<h3>Description</h3>

<p>The data set <code><a href="#topic+rdata_climate">rdata_climate</a></code> contains four columns: the first one (named 'Time') are years from 500 to 1850, the following three columns are the MDRSST (Sea Surface Temperatures anomalies from the Main Developed Region for tropical cyclones) (Mann et al. 2009a), the ENSO (El Niño-Southern Oscillation SST anomalies, el Niño 3 region) (Mann et al. 2009b) and the AMO (The North Atlantic Multidecadal Oscillation SST anomalies) (Mann et al. 2009b).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rdata_climate)
</code></pre>


<h3>Format</h3>

<p>One file in ASCII format containing 4 columns and 1350 rows, columns are separated by spaces. 
</p>


<h3>Source</h3>

<p>Mann, M.E., Woodruff, J.D., Donnelly, J.P. and Zhang, Z. (2009a). Atlantic hurricanes and climate over the past 1,500 years. Nature 460, 880-883. &lt;URL: doi: <a href="https://doi.org/10.1038/nature08219">10.1038/nature08219</a>&gt;. <br />
</p>
<p>Mann, M.E.  Ghang, Z., Rutherford, S., Bradley, R.S., Hughes, M.K., Shindel, Ammann, C., Faluvegi, G. and Ni, F. (2009b). Global signatures and dynamical origins of the Little Ice Age and Medieval Climate Anomaly. Science 326, 1256-1260. &lt;URL: doi: <a href="https://doi.org/10.1126/science.1177303">10.1126/science.1177303</a>&gt;. <br />
</p>
<p>Mann, M.E. (2022), Supplemental Information for Mann et al (2009) Nature Article, &lt;URL: <a href="http://www.meteo.psu.edu/holocene/public_html/Nature09/index.htm">http://www.meteo.psu.edu/holocene/public_html/Nature09/index.htm</a>&gt;, accessed: 2022-09-20. <br />
</p>

<hr>
<h2 id='rdata_Lorenz'>Data set generated via the Lorenz system and used to exemplify the functions contained in <em>VisualDom</em> 
</h2><span id='topic+rdata_Lorenz'></span>

<h3>Description</h3>

<p>The data set <code><a href="#topic+rdata_Lorenz">rdata_Lorenz</a></code> contains four columns: the first column is time (unitless) and the following three columns are the X, Y, Z components of the Lorenz system. The Lorenz system consists of three coupled first-order ordinary differential equations and is without a doubt one of the most famous nonlinear dynamical mathematical models, and represents a paradigmatic example for both theoretical and numerical investigations in checking some results in chaos theory (Polanco-Martínez 2022). For more details on how the <code><a href="#topic+rdata_Lorenz">rdata_Lorenz</a></code> was created see Polanco-Martínez (2023). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rdata_Lorenz)
</code></pre>


<h3>Format</h3>

<p>One file in ASCII format containing 4 columns and 500 rows, columns are separated by spaces. 
</p>


<h3>Source</h3>

<p>Fernández-Macho, J. (2018). Time-localized wavelet multiple regression and correlation. Physica A: Statistical Mechanics and its Applications, 492, 1226-1238. &lt;URL: doi: <a href="https://doi.org/10.1016/j.physa.2017.11.050">10.1016/j.physa.2017.11.050</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M., Fernández-Macho, J., &amp; Medina-Elizalde, M. (2020). Dynamic wavelet correlation analysis for multivariate climate time series. Scientific Reports, 10(1), 1-11. &lt;URL: doi: <a href="https://doi.org/10.1038/s41598-020-77767-8">10.1038/s41598-020-77767-8</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J.M. (2023, in press), A computational and graphical approach to analyze the dynamic wavelet correlation among components of a nonlinear dynamical system, Journal of Applied Nonlinear Dynamics, 1-13. <br /> 
</p>

<hr>
<h2 id='VisualDom-package'>Visualize Dominant Variables in Wavelet Multiple Correlation
</h2><span id='topic+VisualDom-package'></span><span id='topic+VisualDom'></span>

<h3>Description</h3>

<p>'VisualDom' estimates and plots as a heat map the correlation coefficients obtained via the wavelet local multiple correlation 'WLMC' (Fernández-Macho 2018). We improve the graphical outputs of WLMC proposing a didactic and useful way to visualize the 'dominant' variable(s) that the maximizes the multiple correlation through time for a set of time series (Polanco-Martínez et al. 2020; Polanco-Martínez 2023). The WLMC was designed for financial time series, but other kinds of data (e.g., climatic, ecological, etc.) can be used. 'VisualDom' contains three functions: (1) 'estim_WLMC': estimates the wavelet local multiple correlation; (2) 'plot_estim_WLMC': plots the time series under analysis and a heat map the correlation coefficients obtained via 'estim_WLMC'; (3) 'plot_dominant_WLMC': this function also plot the time series under study and a heat maps of the dominant variable/s using the outputs of 'estim_WLMC'. The functions contained in 'VisualDom' are highly flexible since these contains several parameters to personalize the time series under analysis and the heat maps. In addition, we have also included two data sets (named 'rdata_climate' and 'rdata_Lorenz') to exemplify the use of the functions contained in 'VisualDom'. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> VisualDom</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.8</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-12-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2) </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>VisualDom package contains three functions: (1) <code><a href="#topic+estim_WLMC">estim_WLMC</a></code> that estimates the wavelet local multiple correlation (WLMC); (2) <code><a href="#topic+plot_estim_WLMC">plot_estim_WLMC</a></code> that plots the time series under analysis and the correlation coefficients as a heat map obtained via <code><a href="#topic+estim_WLMC">estim_WLMC</a></code>; and (3) <code><a href="#topic+plot_dominant_WLMC">plot_dominant_WLMC</a></code> that plots the time series under study and the dominant variable/s as a heat maps, this function also use the output of <code><a href="#topic+estim_WLMC">estim_WLMC</a></code>. </p>


<h3>Note</h3>

<p>Dependencies: <em>wavemulcor</em>, <em>waveslim</em>, <em>plot3D</em>. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br />
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a> <br />
Acknowledgement:<br /> 
We acknowledge to the Excellence Unit GECOS (reference number CLU-2019-03), Universidad de Salamanca for its funding support. </p>


<h3>References</h3>

<p>Fernández-Macho, J. (2018). Time-localized wavelet multiple regression and correlation. Physica A: Statistical Mechanics and its Applications, 492, 1226-1238. &lt;URL: doi: <a href="https://doi.org/10.1016/j.physa.2017.11.050">10.1016/j.physa.2017.11.050</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M., Fernández-Macho, J., &amp; Medina-Elizalde, M. (2020). Dynamic wavelet correlation analysis for multivariate climate time series. Scientific Reports, 10(1), 1-11. &lt;URL: doi: <a href="https://doi.org/10.1038/s41598-020-77767-8">10.1038/s41598-020-77767-8</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J.M. (2023, in press). A computational and gaphical approach to analyze the dynamic wavelet correlation among   components of a nonlinear dynamical system. Journal of Applied Nonlinear Dynamics, 1-13. <br />
</p>
<p>Whitcher, B., Guttorp, P., &amp; Percival, D. B. (2000). Wavelet analysis of covariance with application to atmospheric time series. Journal of Geophysical Research: Atmospheres, 105(D11), 14941-14962. &lt;URL: doi: <a href="https://doi.org/10.1029/2000JD900110">10.1029/2000JD900110</a>&gt;.  
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
