<!DOCTYPE html><html><head><title>Help for package condSURV</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {condSURV}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#condSURV-package'><p>condSURV:A package for</p>
nonparametric estimation of the survival functions for ordered multivariate
failure time data.</a></li>
<li><a href='#Beran'><p>Estimation of the conditional distribution function of the response, given</p>
the covariate under random censoring.</a></li>
<li><a href='#bladderCS'><p>Bladder Cancer Recurrences.</p></a></li>
<li><a href='#colonCS'><p>Chemotherapy for Stage B/C colon cancer.</p></a></li>
<li><a href='#gbcsCS'><p>German Breast Cancer Study Data.</p></a></li>
<li><a href='#KM'><p>Kaplan-Meier product-limit estimate of survival.</p></a></li>
<li><a href='#KMW'><p>Kaplan-Meier weights.</p></a></li>
<li><a href='#LLW'><p>Local linear weights.</p></a></li>
<li><a href='#NWW'><p>Nadaraya-Watson weights.</p></a></li>
<li><a href='#PKM'><p>Presmoothed Kaplan-Meier product-limit estimate of survival.</p></a></li>
<li><a href='#PKMW'><p>Presmoothed Kaplan-Meier weights.</p></a></li>
<li><a href='#plot.survCS'><p>Plot for an object of class &quot;survCS&quot;.</p></a></li>
<li><a href='#summary.survCS'><p>Summarizing fits of <code>survCS</code> class</p></a></li>
<li><a href='#survCOND'><p>Conditional survival probabilities based on the Kaplan-Meier weights,</p>
Landmark approaches and Inverse probability of censoring weighted.</a></li>
<li><a href='#survCS'><p>Create a survCS object.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of the Conditional Survival Function for Ordered
Multivariate Failure Time Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Luis Meira-Machado and Marta Sestelo</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marta Sestelo &lt;sestelo@uvigo.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Method to implement some newly developed methods for the
    estimation of the conditional survival function. See Meira-Machado, 
    Sestelo and Goncalves (2016) &lt;<a href="https://doi.org/10.1002%2Fbimj.201500038">doi:10.1002/bimj.201500038</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>KernSmooth, np, survival, doParallel, parallel, doRNG, foreach</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-28 17:16:32 UTC; sestelo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-01 08:22:44 UTC</td>
</tr>
</table>
<hr>
<h2 id='condSURV-package'>condSURV:A package for
nonparametric estimation of the survival functions for ordered multivariate
failure time data.</h2><span id='topic+condSURV-package'></span><span id='topic+condSURV'></span>

<h3>Description</h3>

<p>Newly developed methods for the estimation of the conditional survival
function are implemented in this package. The condSURV package implements
nonparametric and semiparametric estimators for these quantities. The
package also implements feasible estimation methods for these quantities
conditionally on current or past covariate measures. Other related
estimators are also implemented in the package. One of these estimators is
the Kaplan-Meier estimator typically assumed to estimate the survival
function. A modification of the Kaplan-Meier estimator, based on a
preliminary estimation (presmoothing) of the censoring probability for the
survival time, given the available information is also implemented.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo.
</p>
<p>Maintainer: Marta Sestelo, sestelo@uvigo.es
</p>


<h3>References</h3>

<p>L. Meira-Machado, M. Sestelo, and A. Goncalves (2016).
Nonparametric estimation of the survival function for ordered multivariate
failure time data: a comparative study. Biometrical Journal, 58(3),
623&ndash;634.
</p>

<hr>
<h2 id='Beran'>Estimation of the conditional distribution function of the response, given
the covariate under random censoring.</h2><span id='topic+Beran'></span>

<h3>Description</h3>

<p>Computes the conditional survival probability P(T &gt; y|Z = z)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Beran(
  time,
  status,
  covariate,
  delta,
  x,
  y,
  kernel = "gaussian",
  bw,
  lower.tail = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Beran_+3A_time">time</code></td>
<td>
<p>The survival time of the process.</p>
</td></tr>
<tr><td><code id="Beran_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the total time of the process; 0 if the
total time is censored and 1 otherwise.</p>
</td></tr>
<tr><td><code id="Beran_+3A_covariate">covariate</code></td>
<td>
<p>Covariate values for obtaining estimates for the
conditional probabilities.</p>
</td></tr>
<tr><td><code id="Beran_+3A_delta">delta</code></td>
<td>
<p>Censoring indicator of the covariate.</p>
</td></tr>
<tr><td><code id="Beran_+3A_x">x</code></td>
<td>
<p>The first time (or covariate value) for obtaining estimates for the
conditional probabilities. If missing, 0 will be used.</p>
</td></tr>
<tr><td><code id="Beran_+3A_y">y</code></td>
<td>
<p>The total time for obtaining estimates for the conditional
probabilities.</p>
</td></tr>
<tr><td><code id="Beran_+3A_kernel">kernel</code></td>
<td>
<p>A character string specifying the desired kernel. See details
below for possible options. Defaults to &quot;gaussian&quot; where the gaussian
density kernel will be used.</p>
</td></tr>
<tr><td><code id="Beran_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.</p>
</td></tr>
<tr><td><code id="Beran_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if FALSE (default), probabilities are <code class="reqn">P(T &gt; y|Z =
z)</code> otherwise, <code class="reqn">P(T &lt;= y|Z = z)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options for argument window are &quot;gaussian&quot;, &quot;epanechnikov&quot;,
&quot;tricube&quot;, &quot;boxcar&quot;, &quot;triangular&quot;, &quot;quartic&quot; or &quot;cosine&quot;.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>References</h3>

<p>R. Beran. Nonparametric regression with randomly censored
survival data. Technical report, University of California, Berkeley, 1981.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
obj &lt;- with(colonCS, survCS(time1, event1, Stime, event))

#P(T&gt;y|age=45)
library(KernSmooth)
h &lt;- dpik(colonCS$age)
Beran(time = obj$Stime, status = obj$event, covariate = colonCS$age,
x = 45, y = 730, bw = h)

#P(T&lt;=y|age=45)
Beran(time = obj$Stime, status = obj$event, covariate = colonCS$age,
x = 45, y = 730, bw = h, lower.tail = TRUE)

</code></pre>

<hr>
<h2 id='bladderCS'>Bladder Cancer Recurrences.</h2><span id='topic+bladderCS'></span>

<h3>Description</h3>

<p>bladderCS is a data frame with 8 variables and 85 observations.  Data on
recurrences of bladder cancer, used by many people to demonstrate
methodology for recurrent event modelling.
</p>


<h3>Format</h3>

<p>A data frame with 85 observations on the following 8 variables.
Below a brief description is given for some of these variables.
</p>

<dl>
<dt>t1</dt><dd><p>Time to first recurrence/censoring, whichever occurs first.</p>
</dd>
<dt>e1</dt><dd><p>Recurrence/censoring indicator (first recurrence=1) for the first
time (t1).</p>
</dd> <dt>t2</dt><dd><p>Time to second recurrence/censoring, whichever occurs
first.</p>
</dd> <dt>e2</dt><dd><p>Recurrence/censoring indicator (second recurrence=1) for
the second time (t2)</p>
</dd> <dt>t3</dt><dd><p>Time to recurrence/censoring, whichever
occurs first.</p>
</dd> <dt>e3</dt><dd><p>Recurrence/censoring indicator (third recurrence=1)
for the third time (t3)</p>
</dd> <dt>t4</dt><dd><p>Time to fourth recurrence/censoring,
whichever occurs first.</p>
</dd> <dt>e4</dt><dd><p>Recurrence/censoring indicator (fourth
recurrence=1) for the fourth time (t4)</p>
</dd>
</dl>



<h3>References</h3>

<p>Byar, D. (1980) Veterans administration study of chemoprophylaxis for
recurrent stage i bladder tumors: Comparisons of placebo, pyridoxine and
topical thiotepa. Bladder Tumors and Other Topics in Urological Oncology,
18:363&ndash;370.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(bladderCS)
  head(bladderCS)

</code></pre>

<hr>
<h2 id='colonCS'>Chemotherapy for Stage B/C colon cancer.</h2><span id='topic+colonCS'></span>

<h3>Description</h3>

<p>These are data from one of the first successful trials of adjuvant
chemotherapy for colon cancer. Levamisole is a low-toxicity compound
previously used to treat worm infestations in animals; 5-FU is a moderately
toxic (as these things go) chemotherapy agent.
</p>


<h3>Format</h3>

<p>A data frame with 929 observations on the following 15 variables.
Below a brief description is given for some of these variables. </p>

<dl>
<dt>time1</dt><dd><p>Time to recurrence/censoring/death, whichever occurs first.</p>
</dd>
<dt>event1</dt><dd><p>Recurrence/censoring indicator (recurrence=1, alive=0).</p>
</dd>
<dt>Stime</dt><dd><p>Time to censoring/death, whichever occurs first.</p>
</dd>
<dt>event</dt><dd><p>Death/censoring indicator (death=1, alive=0).</p>
</dd>
<dt>rx</dt><dd><p>Treatment - Obs(ervation), Lev(amisole), Lev(amisole)+5-FU.</p>
</dd>
<dt>sex</dt><dd><p>Sex indicator (male=1, female=0).</p>
</dd> <dt>age</dt><dd><p>Age in years.</p>
</dd>
<dt>obstruct</dt><dd><p>Obstruction of colon by tumour.</p>
</dd> <dt>perfor</dt><dd><p>Perforation
of colon.</p>
</dd> <dt>adhere</dt><dd><p>Adherence to nearby organs.</p>
</dd> <dt>nodes</dt><dd><p>Number of
lymph nodes with detectable cancer.</p>
</dd> <dt>differ</dt><dd><p>Differentiation of tumour
(1=well, 2=moderate, 3=poor).</p>
</dd> <dt>extent</dt><dd><p>Extent of local spread
(1=submucosa, 2=muscle, 3=serosa, 4=contiguous structures).</p>
</dd>
<dt>surg</dt><dd><p>Time from surgery to registration (0=short, 1=long).</p>
</dd>
<dt>node4</dt><dd><p>More than 4 positive lymph nodes.</p>
</dd> </dl>



<h3>Source</h3>

<p>The study is originally described in Laurie (1989).The main report
is found in Moertel (1990). This data set is closest to that of the final
report in Moertel (1991). A version of the data with less follow-up time was
used in the paper by Lin (1994).
</p>


<h3>References</h3>

<p>JA Laurie, CG Moertel, TR Fleming, HS Wieand, JE Leigh, J Rubin,
GW McCormack, JB Gerstner, JE Krook and J Malliard. Surgical adjuvant
therapy of large-bowel carcinoma: An evaluation of levamisole and the
combination of levamisole and fluorouracil: The North Central Cancer
Treatment Group and the Mayo Clinic. Journal of Clinical Oncology,
7:1447-1456, 1989.
</p>
<p>DY Lin. Cox regression analysis of multivariate failure time data: the
marginal approach. Statistics in Medicine, 13:2233-2247, 1994.
</p>
<p>CG Moertel, TR Fleming, JS MacDonald, DG Haller, JA Laurie, PJ Goodman, JS
Ungerleider, WA Emerson, DC Tormey, JH Glick, MH Veeder and JA Maillard.
Levamisole and fluorouracil for adjuvant therapy of resected colon
carcinoma. New England Journal of Medicine, 332:352-358, 1990.
</p>
<p>CG Moertel, TR Fleming, JS MacDonald, DG Haller, JA Laurie, CM Tangen, JS
Ungerleider, WA Emerson, DC Tormey, JH Glick, MH Veeder and JA Maillard.
Fluorouracil plus Levamisole as and effective adjuvant therapy after
resection of stage II colon carcinoma: a final report. Annals of Internal
Medicine, 122:321-326, 1991.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(colonCS)
head(colonCS)

</code></pre>

<hr>
<h2 id='gbcsCS'>German Breast Cancer Study Data.</h2><span id='topic+gbcsCS'></span>

<h3>Description</h3>

<p>gbcsCS is a data frame with 16 variables and 686 observations. Cancer
clinical trials are a rich source for examples of applications of methods
for the analysis of time to event. Willi Sauerbrei and Patrick Royston have
graciously provided us with data obtained from the German Breast Cancer
Study Group, which they used to illustrate methods for building prognostic
models (Sauerbrei and Royston, 1999). In the main study, a total of 720
patients with primary node positive breast cancer were recruited between
July 1984, and December 1989, (see Schmoor, Olschweski and Schumacher M.
1996 and Schumacher et al. (1994)).
</p>


<h3>Format</h3>

<p>A data frame with 686 observations on the following 16 variables.
Below a brief description is given for some of these variables. </p>

<dl>
<dt>rectime</dt><dd><p>Time to recurrence/censoring, whichever occurs
first.</p>
</dd>
<dt>censrec</dt><dd><p>Recurrence/censoring indicator (recurrence=1,
alive=0).</p>
</dd>
<dt>survtime</dt><dd><p>Time to censoring/death, whichever occurs
first.</p>
</dd>
<dt>censdead</dt><dd><p>Death/censoring indicator (death=1, alive=0).</p>
</dd>
<dt>age</dt><dd><p>Age in years.</p>
</dd>
<dt>size</dt><dd><p>Tumour size.</p>
</dd>
</dl>
<p>#' </p>
<dl>
<dt>deathdate</dt><dd></dd>
<dt>diagdateb</dt><dd></dd>
<dt>estrg_recp</dt><dd></dd>
<dt>grade</dt><dd></dd>
<dt>hormone</dt><dd></dd>
<dt>id</dt><dd></dd>
<dt>nodes</dt><dd></dd>
<dt>prog_recp</dt><dd></dd>
<dt>recdate</dt><dd></dd>
<dt>menopause</dt><dd></dd>
</dl>



<h3>References</h3>

<p>Schmoor, C., Sauerbrei, W. Bastert, G., Schumacher, M. (2000).
Role of Isolated Locoregional Recurrence of Breast Cancer: Results of Four
Prospective Studies. Journal of Clinical Oncology, 18(8), 1696-1708.
</p>
<p>Schumacher, M., Bastert, G., Bojar, H., Hiibner, K., Olschewski, M.,
Sauerbrei, W., Schmoor, C., Beyerle, C., Neumann, R.L.A. and Rauschecker,
H.F. for the German Breast Cancer Study Group (GBSG) (1994). A randomized 2
x 2 trial evaluating hormonal treatment and the duration of chemotherapy in
node-positive breast cancer patients. Journal of Clinical Oncology, 12,
2086-2093.
</p>
<p>Hosmer, D.W. and Lemeshow, S. and May, S. (2008). Applied Survival Analysis:
Regression Modeling of Time to Event Data: Second Edition, John Wiley and
Sons Inc., New York, NY
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(gbcsCS)
head(gbcsCS)

</code></pre>

<hr>
<h2 id='KM'>Kaplan-Meier product-limit estimate of survival.</h2><span id='topic+KM'></span>

<h3>Description</h3>

<p>This function provides survival estimates using the product-limit
Kaplan-Meier estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KM(time, status, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KM_+3A_time">time</code></td>
<td>
<p>Survival time of the process.</p>
</td></tr>
<tr><td><code id="KM_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if
the survival time is censored and 1 otherwise.</p>
</td></tr>
<tr><td><code id="KM_+3A_t">t</code></td>
<td>
<p>The time for obtaining survival estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>References</h3>

<p>E. Kaplan and P. Meier. Nonparametric estimation from incomplete
observations. Journal of the American Statistical Association, 53:457-481,
1958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PKM">PKM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(survival)
obj &lt;- with(colonCS, survCS(time1, event1, Stime, event))
KM(time = obj$Stime, status = obj$event, t = 1095)

fit &lt;- survfit(Surv(obj$Stime, obj$event) ~ 1, data = obj)
summary(fit, time = 1095)$surv


</code></pre>

<hr>
<h2 id='KMW'>Kaplan-Meier weights.</h2><span id='topic+KMW'></span>

<h3>Description</h3>

<p>This function returns a vector with the Kaplan-Meier weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KMW(time, status)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KMW_+3A_time">time</code></td>
<td>
<p>Survival time of the process.</p>
</td></tr>
<tr><td><code id="KMW_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if
the survival time is censored and 1 otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with Kaplan-Meier weights.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>References</h3>

<p>E. Kaplan and P. Meier. Nonparametric estimation from incomplete
observations. Journal of the American Statistical Association, 53:457-481,
1958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PKMW">PKMW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
obj &lt;- with(colonCS, survCS(time1, event1, Stime, event))
kmw &lt;- KMW(time = obj$Stime, status = obj$event)

require(survival)
colon.surv &lt;- survfit(Surv(Stime, event) ~ 1, obj)
times &lt;- summary(colon.surv)$time
surv &lt;- summary(colon.surv)$surv
nevent &lt;- summary(colon.surv)$n.event
p &lt;- match(obj$Stime, times)
kmw2 &lt;- -diff(c(1, surv))/nevent
kmw2 &lt;- kmw2[p]*obj$event
kmw2[is.na(kmw2)] &lt;- 0
all.equal(kmw, kmw2)


</code></pre>

<hr>
<h2 id='LLW'>Local linear weights.</h2><span id='topic+LLW'></span>

<h3>Description</h3>

<p>Computes local linear weights based on Kernel smoothing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LLW(x, kernel = "gaussian", bw, t1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LLW_+3A_x">x</code></td>
<td>
<p>Covariate values for obtaining estimates for the conditional
probabilities. If missing, unconditioned probabilities will be computed.</p>
</td></tr>
<tr><td><code id="LLW_+3A_kernel">kernel</code></td>
<td>
<p>A character string specifying the desired kernel. See details
below for possible options. Defaults to &quot;gaussian&quot; where the gaussian
density kernel will be used.</p>
</td></tr>
<tr><td><code id="LLW_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.</p>
</td></tr>
<tr><td><code id="LLW_+3A_t1">t1</code></td>
<td>
<p>Covariate value to compute the weight at.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options for argument window are &quot;gaussian&quot;, &quot;epanechnikov&quot;,
&quot;tricube&quot;, &quot;boxcar&quot;, &quot;triangular&quot;, &quot;quartic&quot; or &quot;cosine&quot;.
</p>


<h3>Value</h3>

<p>A vector with local linear weights.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NWW">NWW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
LLW(x = colonCS$age, bw = 3, t1 = 60)

</code></pre>

<hr>
<h2 id='NWW'>Nadaraya-Watson weights.</h2><span id='topic+NWW'></span>

<h3>Description</h3>

<p>Computes the Nadaraya-Watson weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NWW(covariate, x, kernel = "gaussian", bw)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NWW_+3A_covariate">covariate</code></td>
<td>
<p>Covariate values for obtaining weights.</p>
</td></tr>
<tr><td><code id="NWW_+3A_x">x</code></td>
<td>
<p>Covariate value to compute the weight at.</p>
</td></tr>
<tr><td><code id="NWW_+3A_kernel">kernel</code></td>
<td>
<p>A character string specifying the desired kernel. See details
below for possible options. Defaults to &quot;gaussian&quot; where the gaussian
density kernel will be used.</p>
</td></tr>
<tr><td><code id="NWW_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options for argument window are &quot;gaussian&quot;, &quot;epanechnikov&quot;,
&quot;tricube&quot;, &quot;boxcar&quot;, &quot;triangular&quot;, &quot;quartic&quot; or &quot;cosine&quot;.
</p>


<h3>Value</h3>

<p>A vector with Nadaraya-Watson weights.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LLW">LLW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
NWW(covariate = colonCS$age, x=40, kernel = "gaussian", bw = 3)

</code></pre>

<hr>
<h2 id='PKM'>Presmoothed Kaplan-Meier product-limit estimate of survival.</h2><span id='topic+PKM'></span>

<h3>Description</h3>

<p>This function provides survival estimates using the presmoothed
product-limit Kaplan-Meier estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PKM(time, status, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PKM_+3A_time">time</code></td>
<td>
<p>Survival time of the process.</p>
</td></tr>
<tr><td><code id="PKM_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if
the survival time is censored and 1 otherwise.</p>
</td></tr>
<tr><td><code id="PKM_+3A_t">t</code></td>
<td>
<p>The time for obtaining survival estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>References</h3>

<p>R. Cao, I. Lopez-de Ullibarri, P. Janssen, and N. Veraverbeke.
Presmoothed kaplan-meier and nelsonaalen estimators. Journal of
Nonparametric Statistics, 17:31-56, 2005.
</p>
<p>G. Dikta. On semiparametric random censorship models. Journal of Statistical
Planning and Inference, 66:253-279, 1998.
</p>
<p>E. Kaplan and P. Meier. Nonparametric estimation from incomplete
observations. Journal of the American Statistical Association, 53:457-481,
1958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KM">KM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
obj &lt;- with(colonCS, survCS(time1, event1, Stime, event))
PKM(time = obj$Stime, status = obj$event, t = 1095)

</code></pre>

<hr>
<h2 id='PKMW'>Presmoothed Kaplan-Meier weights.</h2><span id='topic+PKMW'></span>

<h3>Description</h3>

<p>This function returns a vector with the presmoothed Kaplan-Meier weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PKMW(time, status)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PKMW_+3A_time">time</code></td>
<td>
<p>Survival time of the process.</p>
</td></tr>
<tr><td><code id="PKMW_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if
the survival time is censored and 1 otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with presmoothed Kaplan-Meier weights.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>References</h3>

<p>R. Cao, I. Lopez-de Ullibarri, P. Janssen, and N. Veraverbeke.
Presmoothed kaplan-meier and nelsonaalen estimators. Journal of
Nonparametric Statistics, 17:31-56, 2005.
</p>
<p>G. Dikta. On semiparametric random censorship models. Journal of Statistical
Planning and Inference, 66:253-279, 1998.
</p>
<p>E. Kaplan and P. Meier. Nonparametric estimation from incomplete
observations. Journal of the American Statistical Association, 53:457-481,
1958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KMW">KMW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
obj &lt;- with(colonCS, survCS(time1, event1, Stime, event))
PKMW(time = obj$Stime, status = obj$event)

</code></pre>

<hr>
<h2 id='plot.survCS'>Plot for an object of class &quot;survCS&quot;.</h2><span id='topic+plot.survCS'></span>

<h3>Description</h3>

<p>It draws the estimated conditional survival probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survCS'
plot(
  x = object,
  y = NULL,
  conf = NULL,
  type = NULL,
  conftype = NULL,
  col = 1:6,
  confcol = 1:6,
  lty = 1,
  conflty = 2,
  xlab = "Time",
  ylab = "Survival",
  ylim = NULL,
  xlim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.survCS_+3A_x">x</code></td>
<td>
<p>An object of class &quot;survCS&quot;.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_y">y</code></td>
<td>
<p><code>NULL</code></p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_conf">conf</code></td>
<td>
<p>Draw the confidence intervals into the plot. By default it is
<code>NULL</code>, they are drawn if the &quot;surv&quot; object contains them.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_type">type</code></td>
<td>
<p>The type of plot that should be drawn. See details
<code><a href="graphics.html#topic+par">par</a></code> for possible options. Defaults to &quot;s&quot; for the draw be
stair steps.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_conftype">conftype</code></td>
<td>
<p>The type of plot that should be drawn for confidence
intervals.  See details <code><a href="graphics.html#topic+par">par</a></code> for possible options. Defaults to
&quot;s&quot; for the draw be stair steps.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_col">col</code></td>
<td>
<p>Vector of colors. Colors are used cyclically.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_confcol">confcol</code></td>
<td>
<p>Vector of colors for the confidence intervals.  Colors are
used cyclically.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_lty">lty</code></td>
<td>
<p>The line type. Line types can either be specified as an integer
(0 = blank, 1 = solid (default), 2 = dashed, 3 = dotted, 4 = dotdash, 5 =
longdash, 6 = twodash).  See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_conflty">conflty</code></td>
<td>
<p>The line type for confidence intervals. Line types can either
be specified as an integer (0 = blank, 1 = solid (default), 2 = dashed, 3 =
dotted, 4 = dotdash, 5 = longdash, 6 = twodash).</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_xlab">xlab</code></td>
<td>
<p>A title for the <code>x</code> axis: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_ylab">ylab</code></td>
<td>
<p>A title for the <code>y</code> axis: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_ylim">ylim</code></td>
<td>
<p>The <code>y</code> limits of the plot.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_xlim">xlim</code></td>
<td>
<p>The <code>x</code> limits of the plot.</p>
</td></tr>
<tr><td><code id="plot.survCS_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit1 &lt;- survCOND(survCS(time1, event1, Stime, event) ~ 1, x = 365,
   data = colonCS, method = "LDM", conf = TRUE)

plot(fit1, xlab = "Time (days)", ylab = "S(y|365)", ylim = c(0.5, 1))

fit4 &lt;- survCOND(survCS(time1, event1, Stime, event) ~ rx,
   x = 365, data = colonCS, method = "LDM")

plot(fit4, xlab = "Time (days)", ylab = "S(y|365)", ylim = c(0.5, 1))


</code></pre>

<hr>
<h2 id='summary.survCS'>Summarizing fits of <code>survCS</code> class</h2><span id='topic+summary.survCS'></span><span id='topic+print.survCS'></span>

<h3>Description</h3>

<p>Returns a a data.frame or list containing the estimates of the conditional
survival, its confidence limits and other information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survCS'
summary(object, times = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.survCS_+3A_object">object</code></td>
<td>
<p>A fitted <code>survCS</code> object as produced by
<code>survCOND()</code>.</p>
</td></tr>
<tr><td><code id="summary.survCS_+3A_times">times</code></td>
<td>
<p>Vector of times; the returned data frame will contain 1 row for
each time. Missing values are not allowed.</p>
</td></tr>
<tr><td><code id="summary.survCS_+3A_...">...</code></td>
<td>
<p>For future methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame or a list containing the following components:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>The total time for obtaining the estimates of the conditional
survival probabilities.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>Estimates of the conditional survival probability.</p>
</td></tr>
<tr><td><code>lower 95% CI</code></td>
<td>
<p>The lower conditional survival probabilities of the interval.</p>
</td></tr>
<tr><td><code>upper 95% CI</code></td>
<td>
<p>The upper conditional survival probabilities of the interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>References</h3>

<p>L. Meira-Machado, M. Sestelo, and A. Goncalves (2016).
Nonparametric estimation of the survival function for ordered multivariate
failure time data: a comparative study. Biometrical Journal, 58(3),
623&ndash;634.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- survCOND(survCS(time1, event1, Stime, event) ~ 1, x = 365,
data = colonCS, method = "LDM", conf = TRUE, n.boot = 50, cluster = FALSE)
summary(fit)
summary(fit, times = c(400, 1000, 2900))


</code></pre>

<hr>
<h2 id='survCOND'>Conditional survival probabilities based on the Kaplan-Meier weights,
Landmark approaches and Inverse probability of censoring weighted.</h2><span id='topic+survCOND'></span>

<h3>Description</h3>

<p>Provides estimates for the conditional survival probabilities based on
Kaplan-Meier weighted estimators, the Landmark approaches and Inverse
probability of censoring weighted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survCOND(
  formula,
  x,
  y,
  lower.tail = FALSE,
  method = "LDM",
  presmooth = FALSE,
  conf = TRUE,
  n.boot = 200,
  data,
  conf.level = 0.95,
  z.value,
  bw = "dpik",
  window = "gaussian",
  method.weights = "NW",
  cluster = FALSE,
  ncores = NULL,
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survCOND_+3A_formula">formula</code></td>
<td>
<p>A formula object, which must have a <code>survCS</code> object as
the response on the left of the <code>~</code> operator and, if desired, a term on
the right. The term may be a qualitative or quantitative variable.  For a
single survival curve the right hand side should be ~ 1.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_x">x</code></td>
<td>
<p>Time or vector of times for the condional event(s).</p>
</td></tr>
<tr><td><code id="survCOND_+3A_y">y</code></td>
<td>
<p>The total time for obtaining estimates for the conditional survival
probabilities.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_lower.tail">lower.tail</code></td>
<td>
<p>vector of logical values with the same size as 'x'. If 'x'
has dimension one and if <code>lower.tail = FALSE</code> (default), probabilities are <code class="reqn">P(T
&gt; y|T1 &gt; x)</code> otherwise, <code class="reqn">P(T &gt; y|T1 &lt;= x)</code>.  If the conditional event is
2-dimensional, then, for example, given <code class="reqn">x = c(x1, x2)</code> and <code>lower.tail =
c(TRUE, FALSE)</code> must be used to obtain probabilities <code class="reqn">P(T &gt; y|T1 &lt;= x1, T2 &gt;
x2)</code>. Multi-dimensional conditional events are introduced similarly.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_method">method</code></td>
<td>
<p>The method used to compute the conditional survival function.
Possible options are &quot;LDM&quot; and &quot;KMW&quot;. Defaults to &quot;LDM&quot;.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_presmooth">presmooth</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the presmoothed landmark
estimator of the conditional survival function is computed. Only valid for
method = &quot;LDM&quot;.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap samples. Defaults to 200 samples.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_data">data</code></td>
<td>
<p>A data frame in which to interpret the variables named in the
<code>formula</code> argument.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to
95%).</p>
</td></tr>
<tr><td><code id="survCOND_+3A_z.value">z.value</code></td>
<td>
<p>The value of the covariate on the right hand side of formula
at which the conditional survival probabilities are computed. For
quantitative covariates, i.e. of class integer and numeric.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.  Use
&quot;dpik&quot; for the KernSmooth package based selector or &quot;np&quot; for the 'npudensbw'
function of the np package.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_window">window</code></td>
<td>
<p>A character string specifying the desired kernel.  See details
below for possible options. Defaults to &quot;gaussian&quot; where the gaussian
density kernel will be used.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_method.weights">method.weights</code></td>
<td>
<p>A character string specifying the desired weights
method. Possible options are &quot;NW&quot; for the Nadaraya-Watson weights and &quot;LL&quot;
for local linear weights. Defaults to &quot;NW&quot;.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If <code>TRUE</code> (default), the bootstrap
procedure for the confidence intervals is parallelized.  Note that there are
cases (e.g., a low number of bootstrap repetitions) that R will gain in
performance through serial computation. R takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing, it does
not worth parallelize.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used in
the parallelized procedure. If <code>NULL</code> (default), the number of cores to
be used is equal to the number of cores of the machine - 1.</p>
</td></tr>
<tr><td><code id="survCOND_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether NA values should be stripped
in the computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options for argument window are &quot;gaussian&quot;, &quot;epanechnikov&quot;,
&quot;tricube&quot;, &quot;boxcar&quot;, &quot;triangular&quot;, &quot;quartic&quot; or &quot;cosine&quot;.
</p>


<h3>Value</h3>

<p>An object of class &quot;survCS&quot; and one of the following four classes:
&quot;KMW&quot;, &quot;LMD&quot;, &quot;PLDM&quot; and &quot;IPCW&quot;. Objects are implemented as a list with
elements: </p>
<table>
<tr><td><code>est</code></td>
<td>
<p>data.frame with estimates of the conditional
probabilities.</p>
</td></tr> <tr><td><code>estimate</code></td>
<td>
<p>Estimates of the conditional survival
probability.</p>
</td></tr> <tr><td><code>LCI</code></td>
<td>
<p>The lower conditional survival probabilities of the
interval.</p>
</td></tr> <tr><td><code>UCI</code></td>
<td>
<p>The upper conditional survival probabilities of the
interval.</p>
</td></tr> <tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence.</p>
</td></tr> <tr><td><code>y</code></td>
<td>
<p>The total time
for obtaining the estimates of the conditional survival probabilities.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>The first time for obtaining the estimates of the conditional
survival probabilities.</p>
</td></tr> <tr><td><code>Nlevels</code></td>
<td>
<p>The number of levels of the
covariate. Provides important information when the covariate at the right
hand side of formula is of class factor.</p>
</td></tr> <tr><td><code>conf</code></td>
<td>
<p>logical; if FALSE
(default) the pointwise confidence bands are not given.</p>
</td></tr> <tr><td><code>callp</code></td>
<td>
<p>The
expression of the estimated probability.</p>
</td></tr> <tr><td><code>levels</code></td>
<td>
<p>The levels of the
qualitative covariate (if it is of class factor) on the right hand side of
formula.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>References</h3>

<p>L. Meira-Machado, M. Sestelo, and A. Goncalves (2016).
Nonparametric estimation of the survival function for ordered multivariate
failure time data: a comparative study. Biometrical Journal, 58(3),
623&ndash;634.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

   fit &lt;- survCOND(survCS(time1, event1, Stime, event) ~ 1, x = 365, y = 730,
   data = colonCS, method = "KMW", conf = FALSE)

   fit1 &lt;- survCOND(survCS(time1, event1, Stime, event) ~ 1, x = 365,
   data = colonCS, method = "LDM", conf = FALSE)

   fit2 &lt;- survCOND(survCS(time1, event1, Stime, event) ~ 1, x = 365,
   data = colonCS, method = "LDM", lower.tail = TRUE, conf = FALSE)

   fit3 &lt;- survCOND(survCS(time1, event1, Stime, event) ~ 1, x = 365,
   y = c(730, 1095, 1460), data = colonCS, method = "LDM", presmooth = TRUE,
   lower.tail = TRUE, conf = TRUE, n.boot = 100, conf.level = 0.95,
   cluster = FALSE)

   fit4 &lt;- survCOND(survCS(time1, event1, Stime, event) ~ rx, x = 365,
   data = colonCS, method = "LDM", conf = FALSE)

   fit5 &lt;- survCOND(survCS(time1, event1, Stime, event) ~ factor(sex),
   x = 365, data = colonCS, method = "LDM", conf = FALSE)

  ## Not run: 
   fit6 &lt;- survCOND(survCS(time1, event1, Stime, event) ~ age,
   x = 365, y = 730, z.value = 48, data = colonCS, conf = TRUE)
   
## End(Not run)





</code></pre>

<hr>
<h2 id='survCS'>Create a survCS object.</h2><span id='topic+survCS'></span>

<h3>Description</h3>

<p>Creates a &quot;survCS&quot; object, usually used as a response variable in a model
formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survCS(time1, event1, Stime, event, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survCS_+3A_time1">time1</code></td>
<td>
<p>First time or censoring time.</p>
</td></tr>
<tr><td><code id="survCS_+3A_event1">event1</code></td>
<td>
<p>Indicator of the first time; 0 if the first time is censored
and 1 otherwise.</p>
</td></tr>
<tr><td><code id="survCS_+3A_stime">Stime</code></td>
<td>
<p>The total time of the process.</p>
</td></tr>
<tr><td><code id="survCS_+3A_event">event</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if
the total time is censored and 1 otherwise.</p>
</td></tr>
<tr><td><code id="survCS_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arguments in this function must be introduced in the following order: time1,
event1, time2, ..., Stime and event, where time1, time2, ..., Stime are
ordered event times and event1, event2,..., event their corresponding
indicator statuses.
</p>


<h3>Value</h3>

<p>An object of class &quot;survCS&quot; and of class &quot;surv&quot;. &quot;survCS&quot; objects
are implemented as a single dataframe.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado and Marta Sestelo
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

with(colonCS, survCS(time1, event1, Stime, event))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
