<!DOCTYPE html><html><head><title>Help for package ra4bayesmeta</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ra4bayesmeta}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ra4bayesmeta-package'>
<p>Reference Analysis for Bayesian Meta-Analysis</p></a></li>
<li><a href='#aa'>
<p>Auricular acupuncture data</p></a></li>
<li><a href='#aom'>
<p>Acute otitis media data</p></a></li>
<li><a href='#cal_h_dist'>
<p>Calibration of the Hellinger distance</p></a></li>
<li><a href='#dsgc'>
<p>Density function of the square-root generalized conventional (SGC) benchmark prior</p></a></li>
<li><a href='#dsigc'>
<p>Density function of the square-root inverse generalized conventional (SIGC) benchmark prior</p></a></li>
<li><a href='#fit_models_RA'>
<p>Model fitting for reference analysis using 2 benchmarks:</p>
Posterior inference for benchmark and actual heterogeneity priors</a></li>
<li><a href='#fit_models_RA_5bm'>
<p>Model fitting for reference analysis using 5 benchmarks:</p>
Posterior inference for benchmark and actual heterogeneity priors</a></li>
<li><a href='#H'>
<p>Hellinger distance between two probability densities</p></a></li>
<li><a href='#H_fits'>
<p>Hellinger distance between marignal posterior densities of two bayesmeta fits</p></a></li>
<li><a href='#H_normal'>
<p>Approximate moment-based Hellinger distance computation between two probability densities</p></a></li>
<li><a href='#m_inf_sgc'>
<p>Optimization function for the SGC(m) prior: Adjust the prior to a target</p>
relative latent model complexity (RLMC)</a></li>
<li><a href='#M_inf_sigc'>
<p>Optimization function for the SIGC(M) prior: Adjust the prior to a target</p>
relative latent model complexity (RLMC)</a></li>
<li><a href='#m_j_sgc'>
<p>Optimization function for the SGC(m) prior: Approximate Jeffreys reference posterior</p></a></li>
<li><a href='#M_j_sigc'>
<p>Optimization function for the SIGC(m) prior: Approximate Jeffreys reference posterior</p></a></li>
<li><a href='#plot_RA'>
<p>Reference analysis plot based on a data frame using 2 benchmarks:</p>
Plot heterogeneity benchmark priors and the
corresponding marginal posteriors</a></li>
<li><a href='#plot_RA_5bm'>
<p>Reference analysis plot based on a data frame using 5 benchmarks:</p>
Plot heterogeneity benchmark priors and the
corresponding marginal posteriors</a></li>
<li><a href='#plot_RA_fits'>
<p>Reference analysis plot based on bayesmeta fits:</p>
Plot heterogeneity benchmark priors and the
corresponding marginal posteriors</a></li>
<li><a href='#post_mu_fe'>
<p>Normal posterior for the overall mean parameter in the fixed effects model</p></a></li>
<li><a href='#post_RA'>
<p>Posterior reference analysis based on a data frame using 2 benchmarks</p></a></li>
<li><a href='#post_RA_3bm'>
<p>Posterior reference analysis based on a data frame using 3 benchmarks</p></a></li>
<li><a href='#post_RA_fits'>
<p>Posterior reference analysis based on bayesmeta fits</p></a></li>
<li><a href='#pri_RA_5bm'>
<p>Prior reference analysis based on a data frame using 5 benchmarks</p></a></li>
<li><a href='#pri_RA_fits'>
<p>Prior reference analysis based on bayesmeta fits</p></a></li>
<li><a href='#rti'>
<p>Respiratory tract infections data</p></a></li>
<li><a href='#sigma_ref'>
<p>Reference standard deviation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Reference Analysis for Bayesian Meta-Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Manuela Ott [aut, cre],
  Malgorzata Roos [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Manuela Ott &lt;manuela.c.ott@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functionality for performing a principled reference analysis in the Bayesian normal-normal hierarchical model used for Bayesian meta-analysis, as described in Ott, Plummer and Roos (2021) &lt;<a href="https://doi.org/10.1002%2Fsim.9076">doi:10.1002/sim.9076</a>&gt;. Computes a reference posterior, induced by a minimally informative improper reference prior for the between-study (heterogeneity) standard deviation. Determines additional proper anti-conservative (and conservative) prior benchmarks. Includes functions for reference analyses at both the posterior and the prior level, which, given the data, quantify the informativeness of a heterogeneity prior of interest relative to the minimally informative reference prior and the proper prior benchmarks. The functions operate on data sets which are compatible with the 'bayesmeta' package.</td>
</tr>
<tr>
<td>Depends:</td>
<td>bayesmeta, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-06 18:16:38 UTC; mott@SNFBERN.CH</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-06 20:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ra4bayesmeta-package'>
Reference Analysis for Bayesian Meta-Analysis
</h2><span id='topic+ra4bayesmeta-package'></span>

<h3>Description</h3>

<p>Functionality for performing a principled reference analysis in the Bayesian normal-normal hierarchical model (NNHM) used for Bayesian meta-analysis.
Focuses on the choice of the prior for the between-study (heterogeneity) standard deviation <code class="reqn">\tau</code>.
Implements the methodology proposed in Ott et al. (2021).
</p>
<p>The posterior reference analysis applies the Hellinger distance
to quantify the informativeness
of an actual heterogeneity prior of interest by
comparing the corresponding marginal posteriors
(for different parameters in the NNHM)
with posterior benchmarks.
The prior reference analysis
quantifies the informativeness
of an actual heterogeneity prior given the data by
computing its Hellinger distance to prior benchmarks.
</p>
<p>The main posterior benchmark used is Jeffreys reference posterior
induced by a minimally informative improper reference prior (denoted by J) for the heterogeneity.
Two alternative proposals for additional posterior benchmarks are implemented.
The first, simpler proposal is described in Ott et al. (2021) and uses a benchmark induced by
an anti-conservative half-normal heterogeneity prior (denoted by HN0).
This benchmark allows us to discriminate between anti-conservative and conservative heterogeneity priors with respect to the reference prior.
The second, more involved proposal is introduced in the Supplementary Material of Ott et al. (2021) and uses up to four additional benchmarks induced by proper priors.
These benchmarks allow us to discriminate between strongly anti-conservative, reference affine, and strongly conservative heterogeneity priors.
All four benchmark priors belong to two closely related parametric families, the
so-called &quot;square-root generalized conventional&quot; (SGC) and
&quot;inverse square-root generalized conventional&quot; (SIGC) distributions,
which are derived from prior distributions for variance components
described in Berger &amp; Deely (1988).
Note that most of these prior benchmarks also depend on the data set considered.
</p>
<p>Functions which implement this second proposal use 3 benchmarks for the posterior reference analysis (Jeffreys reference posterior and two additional benchmarks induced by a highly anti-conservative heterogeneity prior SGC(<code class="reqn">m_{inf}</code>) and a highly conservative heterogeneity prior SIGC(<code class="reqn">M_{inf}</code>), respectively) and 5 benchmarks for the prior reference analysis (Jeffreys reference prior and 4 proper priors) and have a corresponding suffix <code>_3bm</code> or <code>_5bm</code>.
The corresponding functions without such a suffix implement the first proposal based on 2 heterogeneity benchmark priors (the half-normal and Jeffreys reference prior).
</p>
<p>The main functions <code>post_RA</code> and <code>post_RA_3bm</code>
perform the reference analysis at the posterior level based on a data frame as input.
The functions <code>fit_models_RA</code> and <code>fit_models_RA_5bm</code> compute the benchmark heterogeneity priors and
corresponding (marginal) posteriors for a given data frame.
The more flexible functions <code>post_RA_fits</code>
and <code>pri_RA_fits</code>
perform
the reference analysis at the posterior level
and prior level
based on the provided benchmark and actual model fits (of class <code>bayesmeta</code>),
so that alternative benchmarks heterogeneity priors can also be used.
Functions for plotting the densities of the heterogeneity priors and
marginal posteriors for different parameters are also provided.
The functions operate on data frames which are compatible with the bayesmeta R package on CRAN.
</p>


<h3>Details</h3>

<p>Package: ra4bayesmeta
</p>
<p>Type: Package
</p>
<p>Title: Reference Analysis for Bayesian Meta-Analysis
</p>
<p>Version: 1.0-8
</p>
<p>Date: 2023-10-06
</p>
<p>Author: Manuela Ott [aut, cre], Malgorzata Roos [aut]
</p>
<p>Maintainer: Manuela Ott &lt;manuela.c.ott@gmail.com&gt;
</p>
<p>Depends: bayesmeta
</p>
<p>License: GPL (&gt;=2)
</p>


<h3>Author(s)</h3>

<p>Manuela Ott, Malgorzata Roos
</p>
<p>Maintainer: Manuela Ott &lt;manuela.c.ott@gmail.com&gt;
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Berger, J. O., Deely, J. (1988). A Bayesian approach to ranking and selection of
related means with alternatives to analysis-of-variance methodology. <em>Journal of the
American Statistical Association</em> <b>83(402)</b>, 364&ndash;373.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># auricular acupuncture (AA) data set
data(aa)

# it takes several seconds to run each of the following functions
# posterior reference analysis
# for standard HN and HC heterogeneity priors
# using the HN0 and J benchmarks
post_RA(df=aa, tau.prior=
               list(function(t)dhalfnormal(t, scale=1),
                    function(t)dhalfcauchy(t, scale=1)))

# posterior reference analysis
# for standard HN and HC heterogeneity priors
# using 3 benchmarks (SGC(m_inf), J and SIGC(M_inf) priors)
post_RA_3bm(df=aa, tau.prior=
                   list(function(t)dhalfnormal(t, scale=1),
                        function(t)dhalfcauchy(t, scale=1)))


# plot the marginal posteriors for the effect mu
# using the HN0 and J benchmarks
plot_RA(df=aa, tau.prior=
               list(function(t)dhalfnormal(t, scale=1),
                    function(t)dhalfcauchy(t, scale=1)),
        type="post.mu", xlim=c(-1,1.5), ylim=c(0,2.5),
        legend=TRUE, legend.tau.prior=c("HN(1)", "HC(1)"))
         
</code></pre>

<hr>
<h2 id='aa'>
Auricular acupuncture data
</h2><span id='topic+aa'></span>

<h3>Description</h3>

<p>Meta-analysis data set including 4 randomized, controlled trials comparing treatment completion among
cocaine dependents treated with auricular acupuncture versus sham acupuncture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aa)</code></pre>


<h3>Format</h3>

<p>A data frame with 4 observations on the following 7 variables:
</p>

<dl>
<dt><code>study</code></dt><dd><p>character string, label of the study</p>
</dd>

<dt><code>f.t</code></dt><dd><p>integer, number of persons who did not complete treatment among those treated with auricular acupuncture </p>
</dd>
<dt><code>n.t</code></dt><dd><p>integer, number of persons treated with auricular acupuncture</p>
</dd>
<dt><code>f.c</code></dt><dd><p>integer, number of persons who did not complete treatment among those treated with sham acupuncture</p>
</dd>
<dt><code>n.c</code></dt><dd><p>integer, number of persons treated with sham acupuncture (control group)</p>
</dd>
<dt><code>y</code></dt><dd><p>numeric, log odds ratio estimates for the individual trials</p>
</dd>
<dt><code>sigma</code></dt><dd><p>numeric, standard error of the log odds ratio estimate for the individual trials</p>
</dd>
</dl>



<h3>Details</h3>

<p>This data set was originally analyzed by Gates et al. (2006) and reanalyzed by Bodnar et al. (2017).
</p>
<p>The log odds ratio estimates and standard errors were computed using the <code>escalc</code> function in the
package <code>metafor</code>.
</p>


<h3>Source</h3>

<p>Bodnar, O., Link, A., Arendacka, B., Possolo, A., Elster, C. (2017). Bayesian estimation in random effects meta-analysis using a non-informative prior. 
<em>Statistics in Medicine</em> <b>36</b>, 378&ndash;399.
</p>


<h3>References</h3>

<p>Gates S, Smith LA, Foxcroft D. Auricular acupuncture for cocaine dependence. <em>Cochrane Database of Systematic Reviews 2006</em>,
Issue 1. Art. No.: CD005192. <a href="https://doi.org/10.1002/14651858.CD005192.pub2">doi:10.1002/14651858.CD005192.pub2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aa)
str(aa)
# forest plot
forest(x=aa$y, sei=aa$sigma, xlab="log odds ratio")
</code></pre>

<hr>
<h2 id='aom'>
Acute otitis media data
</h2><span id='topic+aom'></span>

<h3>Description</h3>

<p>Meta-analysis data set including 5 studies on treatment failure of short course (less
than 7 days) versus long course (&gt; 7 days) antibiotics for acute otitis media in children.
The outcome considered is treatment failure at 8-19 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aom)</code></pre>


<h3>Format</h3>

<p>A data frame with 5 observations on the following 7 variables:
</p>

<dl>
<dt><code>study</code></dt><dd><p>character string, label of the study</p>
</dd>

<dt><code>f.t</code></dt><dd><p>integer, number of patients for whom the short course antibiotics treatment failed</p>
</dd>
<dt><code>n.t</code></dt><dd><p>integer, number of patients receiving short course antibiotics</p>
</dd>
<dt><code>f.c</code></dt><dd><p>integer, number of patients for whom the long course antibiotics treatment failed</p>
</dd>
<dt><code>n.c</code></dt><dd><p>integer, number of patients receiving long course antibiotics</p>
</dd>
<dt><code>y</code></dt><dd><p>numeric, log odds ratio estimates for the individual studies</p>
</dd>
<dt><code>sigma</code></dt><dd><p>numeric, standard error of the log odds ratio estimate for the individual studies</p>
</dd>
</dl>



<h3>Details</h3>

<p>This data set has been analyzed in Kozyrskyj et al. (2000) and 
reanalyzed by Lambert et al. (2005).
Senn (2007, Section 2) discusses problems in this data set.
In particular, one arm of one study has been included twice in the data set.
</p>
<p>The counts <code>f.t</code>, <code>n.t</code>, <code>f.c</code> and <code>n.c</code> and the
names of the studies are taken from Senn (2007),
who reproduces the data set given in Kozyrskyj et al. (2000, Analysis 2.2).
The log odds ratio estimates and standard errors were computed using the <code>escalc</code> function in the
package <code>metafor</code> and 
are identical to the estimates used in Lambert et al. (2005).
</p>


<h3>Source</h3>

<p>Senn, S. (2007). Trying to be precise about vagueness. <em>Statistics in Medicine</em>, <b>26</b>, 1417&ndash;1430. <a href="https://doi.org/10.1002/sim.2639">doi:10.1002/sim.2639</a>
</p>


<h3>References</h3>

<p>Kozyrskyj, A., Klassen, T. P., Moffatt, M., Harvey K. (2000).
Short-course antibiotics for acute otitis media.
<em>Cochrane Database of Systematic Reviews</em>, Issue 2, Art. No.: CD001095.
<a href="https://doi.org/10.1002/14651858.CD001095">doi:10.1002/14651858.CD001095</a>
</p>
<p>Lambert, P., Sutton, A., Burton, P., Abrams, K., Jones, D. (2005). How vague is
vague? A simulation study of the impact of the use of vague prior distributions in
MCMC using WinBUGS. <em>Statistics in Medicine</em> <b>24(15)</b>, 2401&ndash;2428.
<a href="https://doi.org/10.1002/sim.2112">doi:10.1002/sim.2112</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aom)
str(aom)
# forest plot
forest(x=aom$y, sei=aom$sigma, xlab="log odds ratio")
</code></pre>

<hr>
<h2 id='cal_h_dist'>
Calibration of the Hellinger distance
</h2><span id='topic+cal_h_dist'></span>

<h3>Description</h3>

<p>By default (if <code>output="shift"</code>), this function returns
the mean of a unit-variance normal distribution,
such that the Hellinger distance between this distribution and
the standard normal distribution equals the given value.
Offers the option to return the area of overlap (if <code>output="ao"</code>) between these two unit-variance
normal distributions instead.
Gives an intuitive interpretation of Hellinger distance values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cal_h_dist(h, output="shift")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cal_h_dist_+3A_h">h</code></td>
<td>

<p>vector of Hellinger distances, consisting of real numbers in [0,1]
</p>
</td></tr>
<tr><td><code id="cal_h_dist_+3A_output">output</code></td>
<td>

<p>either <code>"shift"</code> or <code>"ao"</code>. Specifies if the output should be given as
the shift between two unit-varaince normal distributions or as the area of overlap (AO) between
these unit-varaince normal distributions
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a given Hellinger distance h, there is a mean <code class="reqn">\mu(h)</code>, such that
</p>
<p style="text-align: center;"><code class="reqn">H(N(\mu(h), 1), N(0, 1))=h,</code>
</p>

<p>where H denotes the Hellinger distance.
See Roos et al. (2015), Sect. 2.2 for details.
</p>
<p>If <code>output="shift"</code>, the function returns the shift <code class="reqn">\mu(h)</code> between
the two unit-variance normal distributions.
If <code>output="ao"</code>, the function returns
the area of overlap between the <code class="reqn">N(\mu(h), 1)</code> and <code class="reqn">N(0, 1)</code> distributions.
This area of overlap is given by
</p>
<p style="text-align: center;"><code class="reqn">AO(\mu(h)) = \Phi(\mu(h)/2 ;\mu(h), 1) + 1 - \Phi(\mu(h)/2 ;0, 1),</code>
</p>

<p>where <code class="reqn">\Phi(. ;\mu, \sigma^2)</code> denotes the cumulative distribution function of
the normal distribution with mean <code class="reqn">\mu</code> and variance <code class="reqn">\sigma^2</code>.
See Ott et al. (2021, Section 3.5) for more information on this area of overlap calibration.
</p>


<h3>Value</h3>

<p>A vector of means (if <code>output="shift"</code>) or areas of overlap (if <code>output="ao"</code>), respectively.
</p>


<h3>References</h3>

<p>Roos, M., Martins, T., Held, L., Rue, H. (2015). Sensitivity analysis for Bayesian hierarchical models.
<em>Bayesian Analysis</em> <b>10(2)</b>, 321&ndash;349.
<a href="https://projecteuclid.org/euclid.ba/1422884977">https://projecteuclid.org/euclid.ba/1422884977</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># calibration in terms of shifts
cal_h_dist(h=c(0.1, 0.5, 0.9))
# calibration in terms of areas of overlap
cal_h_dist(h=c(0.1, 0.5, 0.9), output="ao")
</code></pre>

<hr>
<h2 id='dsgc'>
Density function of the square-root generalized conventional (SGC) benchmark prior
</h2><span id='topic+dsgc'></span>

<h3>Description</h3>

<p>Density function of the SGC distribution described in the Supplementary Material of Ott et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsgc(x, m, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dsgc_+3A_x">x</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="dsgc_+3A_m">m</code></td>
<td>

<p>real number in <code class="reqn">(1,\infty)</code>.
</p>
</td></tr>
<tr><td><code id="dsgc_+3A_c">C</code></td>
<td>

<p>non-negative real number.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The density function with domain <code class="reqn">[0, \infty)</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
   \pi(x) = 2(m-1)Cx(1+Cx^2)^{-m}
</code>
</p>

<p>for <code class="reqn">x &gt;= 0</code>.
This is the transformation of the density function for
variance components given in equation (2.15) in Berger &amp; Deely (1988)
to the standard deviation scale.
See the Supplementary Material of Ott et al. (2021), Section 2.2, for more information.
</p>
<p>For meta-analsis data sets, Ott et al. (2021) choose
<code class="reqn">C=\sigma_{ref}^{-2}</code>,
where <code class="reqn">\sigma_{ref}</code> is the reference standard deviation (see function <code><a href="#topic+sigma_ref">sigma_ref</a></code>) of the
data set,
which is defined as the geometric mean of the standard deviations
of the individual studies.
</p>


<h3>Value</h3>

<p>Value of the density function at locations x, where <code class="reqn">x &gt;= 0</code>. Vector of non-negative real numbers.
</p>


<h3>References</h3>

<p>Berger, J. O., Deely, J. (1988). A Bayesian approach to ranking and selection of
related means with alternatives to analysis-of-variance methodology. <em>Journal of the
American Statistical Association</em> <b>83(402)</b>, 364&ndash;373.
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dsigc">dsigc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dsgc(x=c(0.1,0.5,1), m=1.2, C=10)
</code></pre>

<hr>
<h2 id='dsigc'>
Density function of the square-root inverse generalized conventional (SIGC) benchmark prior
</h2><span id='topic+dsigc'></span>

<h3>Description</h3>

<p>Density function of the SIGC distribution described in the Supplementary Material of Ott et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsigc(x, M, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dsigc_+3A_x">x</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="dsigc_+3A_m">M</code></td>
<td>

<p>real number in <code class="reqn">(1,\infty)</code>.
</p>
</td></tr>
<tr><td><code id="dsigc_+3A_c">C</code></td>
<td>

<p>non-negative real number.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The density function with domain <code class="reqn">[0, \infty)</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
   \pi(x) = 4(M-1)Cx^{-5}(1+Cx^{-4})^{-M}
</code>
</p>

<p>for <code class="reqn">x &gt;= 0</code>.
This density is obtained
if the density function for
variance components given in equation (2.15) in Berger &amp; Deely (1988)
is assigned to the precision (i.e. the inverse of the variance) and
then transformed to the standard deviation scale.
See the Supplementary Material of Ott et al. (2021), Section 2.2, for more information.
</p>
<p>For meta-analsis data sets, Ott et al. (2021) choose
<code class="reqn">C=\sigma_{ref}^{-2}</code>,
where <code class="reqn">\sigma_{ref}</code> is the reference standard deviation (see function <code><a href="#topic+sigma_ref">sigma_ref</a></code>) of the
data set,
which is defined as the geometric mean of the standard deviations
of the individual studies.
</p>


<h3>Value</h3>

<p>Value of the density function at locations x, where <code class="reqn">x &gt;= 0</code>. Vector of non-negative real numbers.
</p>


<h3>References</h3>

<p>Berger, J. O., Deely, J. (1988). A Bayesian approach to ranking and selection of
related means with alternatives to analysis-of-variance methodology. <em>Journal of the
American Statistical Association</em> <b>83(402)</b>, 364&ndash;373.
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dsgc">dsgc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dsigc(x=c(0.1,0.5,1), M=1.2, C=10)
</code></pre>

<hr>
<h2 id='fit_models_RA'>
Model fitting for reference analysis using 2 benchmarks:
Posterior inference for benchmark and actual heterogeneity priors
</h2><span id='topic+fit_models_RA'></span>

<h3>Description</h3>

<p>Computes the posterior distribution of the
parameters in a random-effects meta-analysis (expressed
as a normal-normal hierarchical model) for
two benchmark heterogeneity priors and
the actual heterogeneity prior(s) specified.
Applies the function <code>bayesmeta</code> from the package bayesmeta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_models_RA(df, tau.prior = list(), scale.hn0 = 1/500,
              mu.mean = 0, mu.sd = 4, interval.type = "central")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_models_RA_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_+3A_tau.prior">tau.prior</code></td>
<td>

<p>list of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_+3A_scale.hn0">scale.hn0</code></td>
<td>

<p>scale parameter of the half-normal benchmark prior (usually small, so that the benchmark is anti-conservative).
</p>
</td></tr>
<tr><td><code id="fit_models_RA_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_+3A_interval.type">interval.type</code></td>
<td>

<p>the type of (credible, prediction, shrinkage) interval to be returned by default.
Either &quot;central&quot; for equal-tailed intervals or &quot;shortest&quot; for shortest intervals. Defaults to &quot;central&quot;. See also the corresponding argument in the <code>bayesmeta</code> function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two heterogeneity benchmark priors used are
introduced in Ott et al. (2021, Section 3.4),
where they are denoted by
HN0 and J.
Note that &quot;J&quot; refers to Jeffreys reference prior,
which is improper, but leads to a proper posterior if
there are at least two studies in the meta-analysis data set.
HN0 is a half-normal prior with scale parameter <code>scale.hn0</code>.
</p>
<p>Decreasing the scale parameter <code>scale.hn0</code> of the half-normal benchmarks
leads to a more anti-conservative (i.e. its mass is more concentrated near 0) HN0 benchmark prior.
However, <code>scale.hn0</code> cannot be chosen arbitrarily small
since too small values lead to numerical problems in the <code>bayesmeta</code> function
used to fit the models.
To verify how anti-conservative the HN0 benchmark is,
one can compare the marginal posterior for the overall mean parameter mu
with the corresponding posterior for the fixed effects model,
e.g. by using the function <code>plot_RA</code>.
The better the match between these two marginal posteriors,
the more anti-conservative the HN0 benchmark is.
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.
</p>


<h3>Value</h3>

<p>A list containing the model fits, namely
a list of lists of class <code>bayesmeta</code>.
This list has length <code class="reqn">2</code> + length(<code>tau.prior</code>)
and contains one element for each heterogeneity prior considered
(2 benchmark priors and the actual priors specified),
in the following order:
</p>
<table>
<tr><td><code>fit.hn0</code></td>
<td>
<p> for the half-normal HN0 benchmark prior with scale parameter <code>scale.hn0</code></p>
</td></tr>
<tr><td><code>fit.j</code></td>
<td>
<p> for Jeffreys (improper) reference prior</p>
</td></tr>
<tr><td><code>fit.actual_1</code></td>
<td>
<p> for the first prior in the list <code>tau.prior</code> (if specified)</p>
</td></tr>
<tr><td><code>fit.actual_2</code></td>
<td>
<p> for the second prior in the list <code>tau.prior</code> (if specified)</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p> ...</p>
</td></tr>
<tr><td><code>fit.actual_n</code></td>
<td>
<p> for the nth prior in the list <code>tau.prior</code> (if specified)</p>
</td></tr>
</table>
<p>See <code><a href="bayesmeta.html#topic+bayesmeta">bayesmeta</a></code> in the package bayesmeta
for information on the structure of the lists of class <code>bayesmeta</code>.
</p>


<h3>Warning </h3>

<p>If <code>fit_models_RA</code> ends with an error or warning,
we recommend to increase the value of the parameter <code>scale.hn0</code>
for the anti-conservative benchmark prior.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="bayesmeta.html#topic+bayesmeta">bayesmeta</a></code> in the package bayesmeta,
<code><a href="#topic+plot_RA">plot_RA</a></code>,
<code><a href="#topic+fit_models_RA_5bm">fit_models_RA_5bm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set
data(aa)  
# one actual half-normal and the "DuMouchel" heterogeneity prior
# it takes a few seconds to run this function
fit_models_RA(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=0.5),
                                    "DuMouchel"))
                                    
</code></pre>

<hr>
<h2 id='fit_models_RA_5bm'>
Model fitting for reference analysis using 5 benchmarks:
Posterior inference for benchmark and actual heterogeneity priors
</h2><span id='topic+fit_models_RA_5bm'></span>

<h3>Description</h3>

<p>Computes the posterior distribution of the
parameters in a random-effects meta-analysis (expressed
as a normal-normal hierarchical model) for
each of five benchmark heterogeneity priors and
the actual heterogeneity prior(s) specified.
Applies the function <code>bayesmeta</code> from the package bayesmeta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_models_RA_5bm(df, tau.prior=list(), compute.J.bm=TRUE,
                  m_J=NA, M_J=NA, upper.J=3, digits.J=2,
                  m_inf=NA, M_inf=NA, rlmc0=0.0001, rlmc1=0.9999,
                  mu.mean=0, mu.sd=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_models_RA_5bm_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_tau.prior">tau.prior</code></td>
<td>

<p>list of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_compute.j.bm">compute.J.bm</code></td>
<td>

<p>logical. Specifies if the parameter values of the two benchmarks priors
SGC(<code class="reqn">m_J</code>) and SIGC(<code class="reqn">M_J</code>) and the corresponding marginal posteriors should be computed.
Defaults to <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_m_j">m_J</code></td>
<td>

<p>parameter value <code class="reqn">m=m_J</code> of the SGC(<code class="reqn">m</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_j_sgc</code> and the arguments
<code>df</code>, <code>upper.J</code>, <code>digits.J</code>, <code>mu.mean</code> and <code>mu.sd</code>.

</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_m_j">M_J</code></td>
<td>

<p>parameter value <code class="reqn">M=M_J</code> of the SIGC(<code class="reqn">M</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_j_sigc</code> and the arguments
<code>df</code>, <code>upper.J</code>, <code>digits.J</code>, <code>mu.mean</code> and <code>mu.sd</code>.

</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_upper.j">upper.J</code></td>
<td>

<p>upper bound for the parameters <code>M_J</code> and <code>m_J</code>. Real number in <code class="reqn">(1,\infty)</code>. Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_digits.j">digits.J</code></td>
<td>

<p>specifies the desired precision of the parameter values <code class="reqn">M_J</code> and <code class="reqn">m_J</code>, i.e. to how many digits these two values
should be determined. Possible values are 1,2,3. Defaults to 2.
Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_m_inf">m_inf</code></td>
<td>

<p>parameter value <code class="reqn">m=m_{inf}</code> of the SGC(<code class="reqn">m</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 0.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_inf_sgc</code>, such that the median RLMC is
approximately equal to <code>rlmc0</code>.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_m_inf">M_inf</code></td>
<td>

<p>parameter value <code class="reqn">M=M_{inf}</code> of the SIGC(<code class="reqn">M</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 1.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_inf_sigc</code>, such that the median RLMC is
approximately equal to <code>rlmc1</code>.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_rlmc0">rlmc0</code></td>
<td>

<p>RLMC target value for the SGC(<code class="reqn">m_{inf}</code>) benchmark prior (typically close to 0).
Is required only if <code>m_inf=NA</code>.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_rlmc1">rlmc1</code></td>
<td>

<p>RLMC target value for the SIGC(<code class="reqn">M_{inf}</code>) benchmark prior (typically close to 1).
Is required only if <code>M_inf=NA</code>.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td></tr>
<tr><td><code id="fit_models_RA_5bm_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The five heterogeneity benchmark priors used are
introduced in the Supplementary Material of Ott et al. (2021, Sections 2.2.1, 2.5 and 2.6, see also Section 3.4 of Ott et al. (2021) for Jeffreys reference prior),
where they are denoted by
SGC(<code class="reqn">m_{inf}</code>), SIGC(<code class="reqn">M_J</code>), SGC(<code class="reqn">m_J</code>), SIGC(<code class="reqn">M_{inf}</code>)
and Jeffreys.
Note that &quot;Jeffreys&quot; refers to Jeffreys reference prior,
which is improper, but leads to a proper posterior if
there are at least two studies in the meta-analysis data set.
</p>
<p>If the fits induced by the SIGC(<code class="reqn">M_J</code>) and SGC(<code class="reqn">m_J</code>) benchmarks
are not needed for the analysis (such as for the posterior reference analysis
proposed in the Supplementary Material of Ott et al. (2021), see for example Table 8 for illustration),
specifying
<code>compute.J.bm=FALSE</code> may reduce the
computation time by several minutes.
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.
</p>


<h3>Value</h3>

<p>A list with two elements:
The first element named &quot;fits&quot; is a list containing the model fits and the
second element called &quot;par&quot; is a named vector giving the parameter values
of the benchmark priors.
The vector &quot;par&quot; has the following five components:
<code>m_inf</code>, <code>M_J</code>, <code>m_J</code>, <code>M_inf</code> and <code>C</code>.
</p>
<p>The element &quot;fits&quot; is a list of lists of class <code>bayesmeta</code>.
This list has length <code class="reqn">5</code> + length(<code>tau.prior</code>)
and contains one element for each heterogeneity prior considered
(5 benchmark priors and the actual priors specified),
in the following order:
</p>
<table>
<tr><td><code>fit.SGC.m_inf</code></td>
<td>
<p> for SGC(<code>m_inf</code>) benchmark prior</p>
</td></tr>
<tr><td><code>fit.SIGC.M_J</code></td>
<td>
<p> for SIGC(<code>M_J</code>) benchmark prior</p>
</td></tr>
<tr><td><code>fit.SGC.m_J</code></td>
<td>
<p> for SGC(<code>m_J</code>) benchmark prior</p>
</td></tr>
<tr><td><code>fit.SIGC.M_inf</code></td>
<td>
<p> for SIGC(<code>M_inf</code>) benchmark prior</p>
</td></tr>
<tr><td><code>fit.j</code></td>
<td>
<p> for Jeffreys (improper) reference prior</p>
</td></tr>
<tr><td><code>fit.actual_1</code></td>
<td>
<p> for the first prior in the list <code>tau.prior</code> (if specified)</p>
</td></tr>
<tr><td><code>fit.actual_2</code></td>
<td>
<p> for the second prior in the list <code>tau.prior</code> (if specified)</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p> ...</p>
</td></tr>
<tr><td><code>fit.actual_n</code></td>
<td>
<p> for the nth prior in the list <code>tau.prior</code> (if specified)</p>
</td></tr>
</table>
<p>See <code><a href="bayesmeta.html#topic+bayesmeta">bayesmeta</a></code> in the package bayesmeta
for information on the structure of the lists of class <code>bayesmeta</code>.
</p>


<h3>Warning </h3>

<p>This function may take several minutes to run if the parameter <code>m_J</code> and/or <code>M_J</code>
is not specified,
especially if the desired precision is <code>digits.J=2</code> or even <code>digits.J=3</code>.
</p>
<p>If <code>fit_models_RA</code> ends with an error or warning,
we recommend to check the values of the parameters <code>M_J</code>, <code>m_J</code> and <code>M_inf</code>
for the benchmark priors.
The choice of these parameters can be studied by using the functions
<code>M_j_sigc</code>, <code>m_j_sgc</code> and <code>M_inf_sigc</code>.
If one of the parameters <code>m_inf</code>, <code>M_J</code>, <code>m_J</code> or <code>M_inf</code>
has a value larger than 5*10^6, a warning message will be displayed,
since such large parameter values may lead to numerical problems
in the <code>bayesmeta</code> function.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="bayesmeta.html#topic+bayesmeta">bayesmeta</a></code> in the package bayesmeta,
<code><a href="#topic+m_j_sgc">m_j_sgc</a></code>, <code><a href="#topic+M_j_sigc">M_j_sigc</a></code>,
<code><a href="#topic+m_inf_sgc">m_inf_sgc</a></code>, <code><a href="#topic+M_inf_sigc">M_inf_sigc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set with one
# actual half-normal and the "DuMouchel" heterogeneity prior
data(aa)
# warning: it takes ca. 7 min. to run this function
fit_models_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                        "DuMouchel"))

# computation is much faster if m_J and M_J are specified
fit_models_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                        "DuMouchel"),
                  m_J = 1.35, M_J = 1.3)

</code></pre>

<hr>
<h2 id='H'>
Hellinger distance between two probability densities
</h2><span id='topic+H'></span>

<h3>Description</h3>

<p>Computes the Hellinger distance between the
two probability density functions specified
using numerical integration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H(dens1, dens2, lower=-Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="H_+3A_dens1">dens1</code></td>
<td>

<p>function returning the first probability density.
</p>
</td></tr>
<tr><td><code id="H_+3A_dens2">dens2</code></td>
<td>

<p>function returning the second probability density.
</p>
</td></tr>
<tr><td><code id="H_+3A_lower">lower</code></td>
<td>

<p>lower end of the common domain of two density functions. Usually equal to <code class="reqn">-\infty</code> or 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Hellinger distance is defined in Le Cam (1986) and also given in
Roos et al. (2015, Sect. 2.1).
</p>


<h3>Value</h3>

<p>A real number in [0,1].
</p>


<h3>References</h3>

<p>Le Cam, L. (1986). Asymptotic Methods in Statistical Decision Theory. Springer.
</p>
<p>Roos, M., Martins, T., Held, L., Rue, H. (2015). Sensitivity analysis for Bayesian hierarchical models.
<em>Bayesian Analysis</em> <b>10(2)</b>, 321&ndash;349.
<a href="https://projecteuclid.org/euclid.ba/1422884977">https://projecteuclid.org/euclid.ba/1422884977</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+H_normal">H_normal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>H(dens1=function(x) dhalfnormal(x, scale=0.5),
  dens2=function(x) dhalfnormal(x, scale=1), lower=0)
H(dens1=function(x) dhalfnormal(x, scale=0.5),
  dens2=function(x) dhalfcauchy(x, scale=1), lower=0)
</code></pre>

<hr>
<h2 id='H_fits'>
Hellinger distance between marignal posterior densities of two bayesmeta fits
</h2><span id='topic+H_fits'></span>

<h3>Description</h3>

<p>Computes the Hellinger distance between the
marginal posterior densities extracted from two bayesmeta fits,
for the selected parameter of interest.
Offers the option to select between integral-based and approximate moment-based computation of Hellinger distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H_fits(fit1, fit2, parameter = "mu", individual = NA,
       method = "integral")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="H_fits_+3A_fit1">fit1</code></td>
<td>

<p>first model fit of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
</p>
</td></tr>
<tr><td><code id="H_fits_+3A_fit2">fit2</code></td>
<td>

<p>second model fit of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
</p>
</td></tr>
<tr><td><code id="H_fits_+3A_parameter">parameter</code></td>
<td>

<p>parameter for which the the marginal posterior densities should be compared. Possible values are <code>"mu", "tau", "theta_new"</code> and <code>"theta"</code> (<code>"theta"</code> refers to the random effects and is used in combination  with the individual argment).
</p>
</td></tr>
<tr><td><code id="H_fits_+3A_individual">individual</code></td>
<td>

<p>integer <code class="reqn">&lt;= k</code>, where <code class="reqn">k</code> is the number of studies in the meta-analysis data set. Specifies which random effect parameter to consider (according to the order of the studies in the data set). Is used only if <code>parameter = "theta"</code>.
</p>
</td></tr>
<tr><td><code id="H_fits_+3A_method">method</code></td>
<td>

<p>method for Hellinger distance computation. Either <code>"integral"</code> for integral-based computation or <code>"moment"</code> for approximate moment-based calculation using a normal approximation. Defaults to <code>"integral"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the random effects model for meta-analysis, the parameter mu is the overall mean parameter, tau is the between-study (heterogeneity) standard deviation, theta_new is the predicted effect for a new study and theta_i is the random effect parameter for study i.
</p>
<p>If integral-based computation (<code>method = "integral"</code>) of Hellinger distances is selected (the default), numerical integration is applied to obtain the Hellinger distance between the two marginal posterior densities (by using the function <code>H</code>).
If moment-based computation (<code>method = "moment"</code>) is selected, the marginal densities are first approximated by normal densities with the same means and standard deviations and then the Hellinger distance between these normal densities can be obtained by an analytical formula (implemented in the function <code>H_normal</code>).
</p>


<h3>Value</h3>

<p>A real number in [0,1].
</p>


<h3>Warning </h3>

<p>If the integral-based method is used to compute Hellinger distances (<code>method = "integral"</code>),
numerical problems may occur in some cases, which may lead to implausible outputs.
Therefore, we generally recommend to double-check the results of the integral-based method using the moment-based method (<code>method = "moment"</code>) - especially if the former results are implausibe. If large differences between the two methods are observed, we recommend to rely on the moment-based method unless a normal approximation of the involved densities is inappropriate.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+H">H</a></code>,
<code><a href="#topic+H_normal">H_normal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aa)  
 # fit under Jeffreys reference heterogeneity prior
fit1 &lt;- bayesmeta(y = aa[ , "y"], sigma = aa[, "sigma"],
                  mu.prior.mean = 0, mu.prior.sd = 4,
                  tau.prior = "Jeffreys")
# fit under standard half-normal heterogeneity prior
fit2 &lt;- bayesmeta(y = aa[ , "y"], sigma = aa[, "sigma"],
                  mu.prior.mean = 0, mu.prior.sd = 4,
                  tau.prior = function(t) dhalfnormal(t, scale = 1))
# Hellinger distance between the marginal posteriors for mu
H_fits(fit1, fit2)
# moment-based calculation
H_fits(fit1, fit2, method = "moment")
# Hellinger distance between the marginal posteriors for theta_2
# (random effect parameter)
H_fits(fit1, fit2, parameter = "theta", individual = 2)

</code></pre>

<hr>
<h2 id='H_normal'>
Approximate moment-based Hellinger distance computation between two probability densities
</h2><span id='topic+H_normal'></span>

<h3>Description</h3>

<p>Computes the Hellinger distance between the
two probability densities with the given means and standard deviations
using a normal approximation and moment-matching.
Applies a moment-based analytical formula, which is exact for normal densities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H_normal(mean1, sd1, mean2, sd2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="H_normal_+3A_mean1">mean1</code></td>
<td>

<p>mean of the first density.
</p>
</td></tr>
<tr><td><code id="H_normal_+3A_sd1">sd1</code></td>
<td>

<p>standard deviation of the first density.
</p>
</td></tr>
<tr><td><code id="H_normal_+3A_mean2">mean2</code></td>
<td>

<p>mean of the second density.
</p>
</td></tr>
<tr><td><code id="H_normal_+3A_sd2">sd2</code></td>
<td>

<p>standard deviation of the second density.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Hellinger distance between two normal densities can be computed analytically and it only depends on the means and the standard deviations of these two densities.
Any density can be approximated to the first order by a normal distribution.
Thus, this moment-based formula can also be applied to non-normal densities to obtain an approximate estimate of the Hellinger distance.
This approximation relies on moment-matching, i.e. the non-normal densities are approximated by normal densities with the same means and standard deviations.
See Roos et al. (2021), Section 3.3, for the formula and for additional information.
</p>
<p>Note that the Hellinger distance is invariant with respect to one-to-one transformations of both densities. For the between-study standard deviation <code class="reqn">\tau</code>, the density of <code class="reqn">log(\tau)</code> can be approximated by a normal density.
</p>


<h3>Value</h3>

<p>A real number in [0,1].
</p>


<h3>References</h3>

<p>Roos, M., Hunanyan, S., Bakka, H., &amp; Rue, H. (2021). Sensitivity and identification
quantification by a relative latent model complexity perturbation
in Bayesian meta-analysis.
<em>Biometrical Journal</em> <b>63</b>, 1555&ndash;1574.
<a href="https://doi.org/10.1002/bimj.202000193">doi:10.1002/bimj.202000193</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+H">H</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>H_normal(mean1 = 0, sd1 = 1, mean2 = 1, sd2 = 2)
</code></pre>

<hr>
<h2 id='m_inf_sgc'>
Optimization function for the SGC(m) prior: Adjust the prior to a target
relative latent model complexity (RLMC)
</h2><span id='topic+m_inf_sgc'></span>

<h3>Description</h3>

<p>Computes the parameter value <code class="reqn">m=m_{inf}</code> of the SGC(<code class="reqn">m</code>) prior,
such that the relative latent model complexity (RLMC) with respect
to the reference threshold is approximately <code>rlmc</code>.
The reference threshold is chosen as the (1-<code>alpha</code>)-quantile of the
SGC(<code class="reqn">m_{inf}</code>) prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m_inf_sgc(rlmc, alpha=0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m_inf_sgc_+3A_rlmc">rlmc</code></td>
<td>

<p>target RLMC value. Real number in <code class="reqn">(0,1)</code>.
</p>
</td></tr>
<tr><td><code id="m_inf_sgc_+3A_alpha">alpha</code></td>
<td>

<p>determines the (1-<code>alpha</code>)-quantile of the SGC(<code class="reqn">m</code>) prior,
which is used as reference threshold. Defaults to 0.5 (i.e. the median).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the Supplementary Material of Ott et al. (2021), Section 2.3.1,
for the formulas and explanations.
Note that the parameter value <code class="reqn">m_{inf}</code> does not depend
on the data set considered.
</p>


<h3>Value</h3>

<p>Parameter value <code class="reqn">m=m_{inf}</code> of the SGC(<code class="reqn">m</code>) prior. Real number &gt; 1.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+M_inf_sigc">M_inf_sigc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># extreme RLMC target value close to 0 used in Ott et al. (2021)
m_inf_sgc(rlmc=0.0001)

# 25% quantile instead of the median as ref. threshold
m_inf_sgc(rlmc=0.0001, alpha=0.75)
</code></pre>

<hr>
<h2 id='M_inf_sigc'>
Optimization function for the SIGC(M) prior: Adjust the prior to a target
relative latent model complexity (RLMC)
</h2><span id='topic+M_inf_sigc'></span>

<h3>Description</h3>

<p>Computes the parameter value <code class="reqn">M=M_{inf}</code> of the SIGC(<code class="reqn">M</code>) prior,
such that the relative latent model complexity (RLMC) with respect
to the reference threshold is approximately <code>rlmc</code>.
The reference threshold is chosen as the (1-<code>alpha</code>)-quantile of the
SIGC(<code class="reqn">M_{inf}</code>) prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>M_inf_sigc(rlmc, df, alpha=0.5, truncation=5*10^6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="M_inf_sigc_+3A_rlmc">rlmc</code></td>
<td>

<p>target RLMC value. Real number in <code class="reqn">(0,1)</code>.
</p>
</td></tr>
<tr><td><code id="M_inf_sigc_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;sigma&quot; containing the standard errors of the estimates for the individual studies.
</p>
</td></tr>
<tr><td><code id="M_inf_sigc_+3A_alpha">alpha</code></td>
<td>

<p>determines the (1-<code>alpha</code>)-quantile of the SIGC(<code class="reqn">M</code>) prior,
which is used as reference threshold. Defaults to 0.5 (i.e. the median).
</p>
</td></tr>
<tr><td><code id="M_inf_sigc_+3A_truncation">truncation</code></td>
<td>

<p>upper bound for the parameter value <code class="reqn">M</code>.
Defaults to the empirically determined value 5*10^6.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the Supplementary Material of Ott et al. (2021), Section 2.3.2,
for the formulas and explanations.
Note that the parameter value <code class="reqn">M_{inf}</code> does depend
on the data set considered.
</p>


<h3>Value</h3>

<p>Parameter value <code class="reqn">M=M_{inf}</code> of the SIGC(<code class="reqn">M</code>) prior. Real number &gt; 1.
</p>


<h3>Warning </h3>

<p>Occasionally, the formula for <code class="reqn">M_{inf}</code> given in the Supplementary Material of
Ott et al. (2021, Section 2.3.2)
yields values larger than 5*10^6. This can cause numerical problems in the
<code>bayesmeta</code> function.
Therefore, we truncate the parameter value at the
empirically determined threshold 5*10^6 by default.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+m_inf_sgc">m_inf_sgc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># extreme RLMC target value close to 1 used in Ott et al. (2021)
# for the aurigular acupuncture (AA) data set
data(aa)
M_inf_sigc(df=aa, rlmc=0.9999)
# for the respiratory tract infections (RTI) data set
data(rti)
M_inf_sigc(df=rti, rlmc=0.9999)

# 75% quantile instead of the median as ref. threshold
M_inf_sigc(df=rti, rlmc=0.9999, alpha=0.25)
</code></pre>

<hr>
<h2 id='m_j_sgc'>
Optimization function for the SGC(m) prior: Approximate Jeffreys reference posterior
</h2><span id='topic+m_j_sgc'></span>

<h3>Description</h3>

<p>Numerically determines the parameter value <code class="reqn">m=m_J</code> of the SGC(<code class="reqn">m</code>) prior,
such that the Hellinger distance between the marginal posteriors for the heterogeneity
standard deviation <code class="reqn">\tau</code> induced by the SGC(<code class="reqn">m_J</code>) and Jeffreys (improper) reference prior
is minimal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m_j_sgc(df, upper=3, digits=2, mu.mean=0, mu.sd=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m_j_sgc_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="m_j_sgc_+3A_upper">upper</code></td>
<td>

<p>upper bound for parameter <code class="reqn">m</code>. Real number in <code class="reqn">(1,\infty)</code>.
</p>
</td></tr>
<tr><td><code id="m_j_sgc_+3A_digits">digits</code></td>
<td>

<p>specifies the desired precision of the parameter value <code class="reqn">m=m_J</code>, i.e. to how many digits this value
should be determined. Possible values are 1,2,3. Defaults to 2.
</p>
</td></tr>
<tr><td><code id="m_j_sgc_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td></tr>
<tr><td><code id="m_j_sgc_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the Supplementary Material of Ott et al. (2021, Section 2.6) for details.
</p>


<h3>Value</h3>

<p>Parameter value <code class="reqn">m=m_J</code> of the SGC(<code class="reqn">m</code>) prior. Real number &gt; 1.
</p>


<h3>Warning </h3>

<p>This function takes several minutes to run if the desired precision
is <code>digits=2</code> and even longer for higher precision.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+M_j_sigc">M_j_sigc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set
data(aa)
# warning: it takes ca. 2 min. to run this function
m_j_sgc(df=aa, digits=1)

</code></pre>

<hr>
<h2 id='M_j_sigc'>
Optimization function for the SIGC(m) prior: Approximate Jeffreys reference posterior
</h2><span id='topic+M_j_sigc'></span>

<h3>Description</h3>

<p>Numerically determines the parameter value <code class="reqn">M=M_J</code> of the SIGC(<code class="reqn">M</code>) prior,
such that the Hellinger distance between the marginal posteriors for the heterogeneity
standard deviation <code class="reqn">\tau</code> induced by the SIGC(<code class="reqn">M_J</code>) prior and Jeffreys (improper) reference prior
is minimal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>M_j_sigc(df, upper=3, digits=2, mu.mean=0, mu.sd=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="M_j_sigc_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="M_j_sigc_+3A_upper">upper</code></td>
<td>

<p>upper bound for parameter <code class="reqn">M</code>. Real number in <code class="reqn">(1,\infty)</code>.
</p>
</td></tr>
<tr><td><code id="M_j_sigc_+3A_digits">digits</code></td>
<td>

<p>specifies the desired precision of the parameter value <code class="reqn">M=M_J</code>, i.e. to how many digits this value
should be determined. Possible values are 1,2,3. Defaults to 2.
</p>
</td></tr>
<tr><td><code id="M_j_sigc_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td></tr>
<tr><td><code id="M_j_sigc_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the Supplementary Material of Ott et al. (2021, Section 2.6) for details.
</p>


<h3>Value</h3>

<p>Parameter value <code class="reqn">M=M_J</code> of the SIGC(M) prior. Real number &gt; 1.
</p>


<h3>Warning </h3>

<p>This function takes several minutes to run if the desired precision
is <code>digits=2</code> and even longer for higher precision.
</p>
<p>For some data sets, the optimal parameter value <code class="reqn">M=M_J</code> is very large
(e.g. of order 9*10^5).
If this function returns <code class="reqn">M_J</code>=<code>upper</code>, then
the optimal parameter value may be larger than <code>upper</code>.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+m_j_sgc">m_j_sgc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set
data(aa)
# warning: it takes ca. 2 min. to run this function
M_j_sigc(df=aa, digits=1)

</code></pre>

<hr>
<h2 id='plot_RA'>
Reference analysis plot based on a data frame using 2 benchmarks:
Plot heterogeneity benchmark priors and the
corresponding marginal posteriors
</h2><span id='topic+plot_RA'></span>

<h3>Description</h3>

<p>Plots the proper half-normal benchmark heterogeneity prior proposed in Ott et al. (2021)
and the corresponding marginal benchmark posteriors for different parameters in the
NNHM. Also displays the marginal Jeffreys reference posterior,
which is induced by an improper reference prior.
Displays the specified actual heterogeneity priors in <code>tau.prior</code>
and the corresponding marginal posteriors as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_RA(df, tau.prior = list(),
        type = "pri.tau", improper.prior = NULL, show.sigma.i = FALSE,
        xlim, ylim, legend = FALSE,
        pos.legend = "topright", legend.tau.prior = c(),
        xlab = NULL, bty = "o",
        scale.hn0 = 1/500, mu.mean = 0, mu.sd = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_RA_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_tau.prior">tau.prior</code></td>
<td>

<p>list (maximum length 5) of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_type">type</code></td>
<td>

<p>specifies if heterogeneity priors or marginal posterior densities for
a given parameter should be plotted.
Options are <code>"pri.tau"</code> for heterogeneity priors, <code>"post.mu"</code> for the marg. posterior of the main effect mu, <code>"post.tau"</code> for the marg. posterior of the heterogeneity tau and
<code>"post.theta.new"</code> for the marg. posterior of the predicted effect theta_new in a new study.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_improper.prior">improper.prior</code></td>
<td>

<p>vector of integers specifying the positions of the improper priors in the list <code>tau.prior</code>
or NULL (the default). Determines which prior densities should not be plotted. Applies only to <code>type = "pri.tau"</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_show.sigma.i">show.sigma.i</code></td>
<td>

<p>logical. Specifies if the standard errors of the estimates for the individual studies (the entries of the column &quot;sigma&quot; in the data frame <code>df</code>) should be added to the density plot as dots. Defaults to FALSE. Applies only to <code>type = "pri.tau"</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_xlim">xlim</code></td>
<td>

<p>a vector of two real numbers. Limits of the x-axis. (First number &gt;= 0 for densities for tau.)
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_ylim">ylim</code></td>
<td>

<p>a vector of two real non-negative numbers. Limits of the y-axis.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_legend">legend</code></td>
<td>

<p>logical. Specifies if a legend should be added to the plot. Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_pos.legend">pos.legend</code></td>
<td>

<p>a character string specifing the position of the legend in the plot.
Options are all the keywords accepted by
the <code>legend</code> function in the graphics package, i.e.
<code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> and <code>"center"</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_legend.tau.prior">legend.tau.prior</code></td>
<td>

<p>a vector of character strings or expressions of the same length
as the list <code>tau.prior</code>. Determines the legend entries corresponding to
the actual heterogeneity priors specified in <code>tau.prior</code>,
in the same order as the priors in that list.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_xlab">xlab</code></td>
<td>

<p>x-axis label. If unspecified or set to NULL (the default), a default label specifying
the paramter of interest is used.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_bty">bty</code></td>
<td>

<p>the type of box to be drawn around the legend. The allowed values are &quot;o&quot; (the default) and &quot;n&quot;.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_scale.hn0">scale.hn0</code></td>
<td>

<p>scale parameter of the half-normal benchmark prior (usually a small number to
obtain an anti-conservative benchmark which has most of its probability mass close to 0).
Defaults to 0.002.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td></tr>
<tr><td><code id="plot_RA_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two heterogeneity benchmark priors used are
introduced in Ott et al. (2021, Section 3.4)
and they are denoted by
HN0 and J.
Note that the latter Jeffreys reference prior J
is improper, but leads to a proper posterior if
there are at least two studies in the meta-analysis data set.
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.
</p>
<p>If you wish to adapt the colors, line types or line widths of the plotted densities,
we suggest to compute the models fits first by using the function <code>fit_models_RA</code>
and then to apply the more flexible function <code>plot_RA_fits</code>
operating on model fits of class <code>bayesmeta</code>.
</p>


<h3>Value</h3>

<p>No return value, produces graphical output only.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_RA_fits">plot_RA_fits</a></code>,
<code><a href="#topic+plot_RA_5bm">plot_RA_5bm</a></code>,
<code><a href="#topic+fit_models_RA">fit_models_RA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set with two
# actual half-normal and half-Cauchy heterogeneity priors
data(aa)
# it takes a few seconds to run each of the following functions
# prior densities
plot_RA(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                              function(t)dhalfcauchy(t, scale=1)),
        type="pri.tau", xlim=c(0,2), ylim=c(0,3), legend=TRUE,
        legend.tau.prior=c("HN(1)", "HC(1)"))

# marginal posterior for the effect mu
plot_RA(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                              function(t)dhalfcauchy(t, scale=1)),
        type="post.mu", xlim=c(-1.5,2), ylim=c(0,3), legend=TRUE,
        legend.tau.prior=c("HN(1)", "HC(1)"))
        
</code></pre>

<hr>
<h2 id='plot_RA_5bm'>
Reference analysis plot based on a data frame using 5 benchmarks:
Plot heterogeneity benchmark priors and the
corresponding marginal posteriors
</h2><span id='topic+plot_RA_5bm'></span>

<h3>Description</h3>

<p>Plots the four proper benchmark heterogeneity priors proposed in the Supplementary Material of Ott et al. (2021)
and the corresponding marginal benchmark posteriors for different parameters in the
NNHM. Also displays the marginal Jeffreys reference posterior,
which is induced by an improper reference prior.
Displays the specified actual heterogeneity priors in <code>tau.prior</code>
and the corresponding marginal posteriors as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_RA_5bm(df, tau.prior=list(), type="pri.tau",
            improper.prior = NULL, show.sigma.i = FALSE,
            xlim, ylim,
            m_J=NA, M_J=NA, upper.J=3, digits.J=2,
            m_inf=NA, M_inf=NA, rlmc0=0.0001, rlmc1=0.9999,
            legend=FALSE, pos.legend="topright", legend.tau.prior=c(),
            xlab = NULL, bty = "o",
            mu.mean=0, mu.sd=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_RA_5bm_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_tau.prior">tau.prior</code></td>
<td>

<p>list (maximum length 5) of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_type">type</code></td>
<td>

<p>specifies if heterogeneity priors or marginal posterior densities for
a given parameter should be plotted.
Options are <code>"pri.tau"</code> for heterogeneity priors, <code>"post.mu"</code> for the marg. posterior of the main effect mu, <code>"post.tau"</code> for the marg. posterior of the heterogeneity tau and
<code>"post.theta.new"</code> for the marg. posterior of the predicted effect theta_new in a new study.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_improper.prior">improper.prior</code></td>
<td>

<p>vector of integers specifying the position of the improper priors in the list <code>tau.prior</code>
or NULL (the default). Determines which prior densities should not be plotted. Applies only to <code>type = "pri.tau"</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_show.sigma.i">show.sigma.i</code></td>
<td>

<p>logical. Specifies if the standard errors of the estimates for the individual studies (the entries of the column &quot;sigma&quot; in the data frame <code>df</code>) should be added to the density plot as dots. Defaults to FALSE. Applies only to <code>type = "pri.tau"</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_xlim">xlim</code></td>
<td>

<p>a vector of two real numbers. Limits of the x-axis. (First number &gt;= 0 for densities for tau.)
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_ylim">ylim</code></td>
<td>

<p>a vector of two real non-negative numbers. Limits of the y-axis.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_m_j">m_J</code></td>
<td>

<p>parameter value <code class="reqn">m=m_J</code> of the SGC(<code class="reqn">m</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_j_sgc</code> and some other parameters.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_m_j">M_J</code></td>
<td>

<p>parameter value <code class="reqn">M=M_J</code> of the SIGC(<code class="reqn">M</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_j_sigc</code> and some other parameters.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_upper.j">upper.J</code></td>
<td>

<p>upper bound for the parameters <code>M_J</code> and <code>m_J</code>. Real number in <code class="reqn">(1,\infty)</code>. Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_digits.j">digits.J</code></td>
<td>

<p>specifies the desired precision of the parameter values <code class="reqn">M_J</code> and <code class="reqn">m_J</code>, i.e. to how many digits these two values
should be determined. Possible values are 1,2,3. Defaults to 2.
Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_m_inf">m_inf</code></td>
<td>

<p>parameter value <code class="reqn">m=m_{inf}</code> of the SGC(<code class="reqn">m</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 0.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_inf_sgc</code>, such that the median RLMC is
approximately equal to <code>rlmc0</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_m_inf">M_inf</code></td>
<td>

<p>parameter value <code class="reqn">M=M_{inf}</code> of the SIGC(<code class="reqn">M</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 1.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_inf_sigc</code>, such that the median RLMC is
approximately equal to <code>rlmc1</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_rlmc0">rlmc0</code></td>
<td>

<p>RLMC target value for the SGC(<code class="reqn">m_{inf}</code>) benchmark prior (typically close to 0).
Is required only if <code>m_inf=NA</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_rlmc1">rlmc1</code></td>
<td>

<p>RLMC target value for the SIGC(<code class="reqn">M_{inf}</code>) benchmark prior (typically close to 1).
Is required only if <code>M_inf=NA</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_legend">legend</code></td>
<td>

<p>logical. Specifies if a legend should be added to the plot. Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_pos.legend">pos.legend</code></td>
<td>

<p>a character string specifing the position of the legend in the plot.
Options are all the keywords accepted by
the <code>legend</code> function in the graphics package, i.e.
<code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> and <code>"center"</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_legend.tau.prior">legend.tau.prior</code></td>
<td>

<p>a vector of character strings or expressions of the same length
as the list <code>tau.prior</code>. Determines the legend entries corresponding to
the actual heterogeneity priors specified in <code>tau.prior</code>,
in the same order as the priors in that list.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_xlab">xlab</code></td>
<td>

<p>x-axis label. If unspecified or set to NULL (the default), a default label specifying
the paramter of interest is used.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_bty">bty</code></td>
<td>

<p>the type of box to be drawn around the legend. The allowed values are &quot;o&quot; (the default) and &quot;n&quot;.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td></tr>
<tr><td><code id="plot_RA_5bm_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The five heterogeneity benchmark priors used are
introduced in the Supplementary Material of Ott et al. (2021, Sections 2.2.1, 2.5 and 2.6, see also Section 3.4 of Ott et al. (2021) for Jeffreys reference prior),
where they are denoted by
SGC(<code class="reqn">m_{inf}</code>), SIGC(<code class="reqn">M_J</code>), SGC(<code class="reqn">m_J</code>), SIGC(<code class="reqn">M_{inf}</code>)
and Jeffreys.
Note that the latter Jeffreys reference prior
is improper, but leads to a proper posterior if
there are at least two studies in the meta-analysis data set.
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.
</p>
<p>If you wish to adapt the colors, line types or line widths of the plotted densities,
we suggest to compute the models fits first by using the function <code>fit_models_RA</code>
and then to apply the more flexible function <code>plot_RA_fits</code>
operating on model fits of class <code>bayesmeta</code>.
</p>


<h3>Value</h3>

<p>No return value, produces graphical output only.
</p>


<h3>Warning </h3>

<p>This function may take several minutes to run if the parameter <code>m_J</code> and/or <code>M_J</code>
is not specified,
especially if the desired precision is <code>digits.J=2</code> or even <code>digits.J=3</code>.
</p>
<p>A warning message will be displayed if one of the parameters <code>m_inf</code>, <code>M_J</code>, <code>m_J</code> or <code>M_inf</code>
has a value larger than 5*10^6, since this may lead to numerical problems
in the <code>bayesmeta</code> function
used for computation of the marginal posteriors.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_models_RA_5bm">fit_models_RA_5bm</a></code>, <code><a href="#topic+plot_RA_fits">plot_RA_fits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set with two
# actual half-normal and half-Cauchy heterogeneity priors
data(aa)
 
# prior densities
# warning: it takes ca. 8 min. to run this function
# (computation is much faster if m_J and M_J are specified)
plot_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                  function(t)dhalfcauchy(t, scale=1)),
            type="pri.tau", xlim=c(0,2), ylim=c(0,3), legend=TRUE,
            legend.tau.prior=c("HN(1)", "HC(1)"))

# marginal posterior for the effect mu
# warning: it takes ca. 7 min. to run this function
plot_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                  function(t)dhalfcauchy(t, scale=1)),
            type="post.mu", xlim=c(-1.5,2), ylim=c(0,3), legend=TRUE,
            legend.tau.prior=c("HN(1)", "HC(1)"))
            
</code></pre>

<hr>
<h2 id='plot_RA_fits'>
Reference analysis plot based on bayesmeta fits:
Plot heterogeneity benchmark priors and the
corresponding marginal posteriors
</h2><span id='topic+plot_RA_fits'></span>

<h3>Description</h3>

<p>Plots the benchmark heterogeneity priors inducing the specified model fits <code>fits.bm</code>
and the corresponding marginal benchmark posteriors for different parameters in the
NNHM.
Also displays the actual heterogeneity priors inducing the specified actual model fits <code>fits.actual</code>
and the corresponding marginal posteriors.
All bayesmeta fits should be based on the same data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_RA_fits(fits.actual, fits.bm, type="pri.tau", xlim, ylim,
             legend=FALSE, pos.legend="topright",
             legend.tau.prior=c(), bty="o",
             col.actual=c("red","lightpink3","darkgreen","green",
                          "violetred")[1:length(fits.actual)],
             col.bm=c("cyan","black","blue","darkgray",
                      "dodgerblue")[1:length(fits.bm)],
             lty.actual=rep(2, times=length(col.actual)),
             lty.bm=rep(1, times=length(col.bm)),
             lwd.actual=rep(2, times=length(col.actual)),
             lwd.bm=rep(2, times=length(col.bm)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_RA_fits_+3A_fits.actual">fits.actual</code></td>
<td>

<p>a list of model fits (max. 5 fits) of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_fits.bm">fits.bm</code></td>
<td>

<p>a list of model fits (max. 5 fits) of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
To be used as benchmarks.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_type">type</code></td>
<td>

<p>specifies if heterogeneity priors or marginal posterior densities for
a given parameter should be plotted.
Options are <code>"pri.tau"</code> for heterogeneity priors, <code>"post.mu"</code> for the marg. posterior of the main effect mu, <code>"post.tau"</code> for the marg. posterior of the heterogeneity tau and
<code>"post.theta.new"</code> for the marg. posterior of the predicted effect theta_new in a new study.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_xlim">xlim</code></td>
<td>

<p>a vector of two real numbers. Limits of the x-axis. (First number &gt;= 0 for densities for tau.)
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_ylim">ylim</code></td>
<td>

<p>a vector of two real non-negative numbers. Limits of the y-axis.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_legend">legend</code></td>
<td>

<p>logical. Specifies if a legend should be added to the plot. Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_pos.legend">pos.legend</code></td>
<td>

<p>a character string specifing the position of the legend in the plot.
Options are all the keywords accepted by
the <code>legend</code> function in the graphics package, i.e.
<code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> and <code>"center"</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_legend.tau.prior">legend.tau.prior</code></td>
<td>

<p>a vector of character strings or expressions with one
entry for each fit in <code>fits.actual</code> and <code>fits.bm</code>
(i.e. a vector of length length(<code>fits.actual</code>)+length(<code>fits.bm</code>)).
Determines the legend entries corresponding to
the actual und benchmark fits specified,
in the same order as in the list c(<code>fits.actual</code>, <code>fits.bm</code>).
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_bty">bty</code></td>
<td>

<p>the type of box to be drawn around the legend. The allowed values are &quot;o&quot; (the default) and &quot;n&quot;.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_col.actual">col.actual</code></td>
<td>

<p>vector of color specifications for the lines representing the actual fits in
<code>fits.actual</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.actual)</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_col.bm">col.bm</code></td>
<td>

<p>vector of color specifications for the lines representing the benchmark fits in
<code>fits.bm</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.bm)</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_lty.actual">lty.actual</code></td>
<td>

<p>vector of line type specifications for the lines representing the actual fits in
<code>fits.actual</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.actual)</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_lty.bm">lty.bm</code></td>
<td>

<p>vector of line type specifications for the lines representing the benchmark fits in
<code>fits.bm</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.bm)</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_lwd.actual">lwd.actual</code></td>
<td>

<p>numeric vector specifying the width of the lines representing the actual fits in
<code>fits.actual</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.actual)</code>.
</p>
</td></tr>
<tr><td><code id="plot_RA_fits_+3A_lwd.bm">lwd.bm</code></td>
<td>

<p>numeric vector specifying the width of the lines representing the benchmark fits in
<code>fits.bm</code>, in the same order as in that list.
Vector of minimum length <code>length(fits.bm)</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two alternative suggestions for posterior benchmarks are provided
in Ott et al. (2021, Section 3.4) and its Supplementary Material (Section 2.5) and they
can be computed using the functions <code>fit_models_RA</code> and <code>fit_models_RA_5bm</code>,
respectively.
</p>


<h3>Value</h3>

<p>No return value, produces graphical output only.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="bayesmeta.html#topic+bayesmeta">bayesmeta</a></code> in the package bayesmeta,
<code><a href="#topic+fit_models_RA">fit_models_RA</a></code>, <code><a href="#topic+plot_RA">plot_RA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set with two
# actual half-normal and half-Cauchy heterogeneity priors
data(aa)
  
# compute the model fits
fits &lt;- fit_models_RA(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                            function(t)dhalfcauchy(t, scale=1)))
# plot the HN0 benchmark prior (do not show the improper J benchmark)
fits.bm.pri &lt;- fits[1]
# benchmark fits under HN0 and J priors
fits.bm.post &lt;- fits[1:2]
fits.actual &lt;- fits[3:4]

# prior densities
plot_RA_fits(fits.actual=fits.actual, fits.bm=fits.bm.pri,
             type="pri.tau", xlim=c(0, 2), ylim=c(0, 3),
             legend=TRUE,
             legend.tau.prior=c("HN(1)", "HC(1)", "HN0"))

# marginal posterior for the effect mu
plot_RA_fits(fits.actual=fits.actual, fits.bm=fits.bm.post,
             type="post.mu", xlim=c(-1.5, 1.5), ylim=c(0, 3),
             legend=TRUE,
             legend.tau.prior=c("HN(1)", "HC(1)",
             "HN0", "J"))
             
</code></pre>

<hr>
<h2 id='post_mu_fe'>
Normal posterior for the overall mean parameter in the fixed effects model
</h2><span id='topic+post_mu_fe'></span>

<h3>Description</h3>

<p>This function computes the mean and the standard deviation of the
normal posterior distribution for the overall mean parameter mu in the fixed effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_mu_fe(df, mu.mean = 0, mu.sd = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_mu_fe_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="post_mu_fe_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the overall mean parameter mu. Defaults to 0.
</p>
</td></tr>
<tr><td><code id="post_mu_fe_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the overall mean parameter mu. Defaults to 4.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the fixed effects model, the normal posterior for the overall mean parameter mu can be computed analytically (under the common assumption of a normal prior on mu)
since this is a conjugate Bayesian normal-normal model.
See for example Ott et al. (2021), Equation (2) for the formula
(<code>mu.mean</code> corresponds to <code class="reqn">\nu</code> and <code>mu.sd</code> corresponds to <code class="reqn">\gamma</code>).
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale (Roever, 2020).
</p>


<h3>Value</h3>

<p>A list with two elements: the first element &quot;mean&quot; and the second element &quot;sd&quot;, which refer to the mean and the standard deviation of the normal posterior of mu.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Roever C. Bayesian random-effects meta-analysis using the bayesmeta R package (2020). <em>Journal of Statistical Software</em> <b>93(6)</b>, 1&ndash;51.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load the aurigular acupuncture (AA) data set
data(aa)
# normal prior for log odds ratios suggested by Roever (2020)
post_mu_fe(df=aa, mu.mean=0, mu.sd=4)
</code></pre>

<hr>
<h2 id='post_RA'>
Posterior reference analysis based on a data frame using 2 benchmarks
</h2><span id='topic+post_RA'></span>

<h3>Description</h3>

<p>Computes a table of posterior estimates and informativeness values
for the marginal posterior distributions
of different parameters in the NNHM
induced by the actual heterogeneity priors specified in <code>tau.prior</code>.
Also provides the same estimates for the
posterior benchmarks proposed in Ott et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_RA(df, tau.prior = list(function(x) dhalfnormal(x, scale = 1)),
        show.re = FALSE,
        estimate = "median", ci.method = "central",
        H.dist.method = "integral",
        scale.hn0 = 1/500, mu.mean = 0, mu.sd = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_RA_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="post_RA_+3A_tau.prior">tau.prior</code></td>
<td>

<p>list of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td></tr>
<tr><td><code id="post_RA_+3A_show.re">show.re</code></td>
<td>

<p>logical. If <code>TRUE</code>, the estimates for the random effect parameters <code class="reqn">\theta_i</code> are also shown. Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="post_RA_+3A_estimate">estimate</code></td>
<td>

<p>type of posterior point estimate. Either <code>"median"</code> for the posterior median or <code>"mean"</code> for the posterior mean. Defaults to <code>"median"</code>.
</p>
</td></tr>
<tr><td><code id="post_RA_+3A_ci.method">ci.method</code></td>
<td>

<p>method for computation of 95% credible intervals (CrIs). Either <code>"central"</code> for equal-tailed CrIs or <code>"shortest"</code> for shortest CrIs. Defaults to <code>"central"</code>.
</p>
</td></tr>
<tr><td><code id="post_RA_+3A_h.dist.method">H.dist.method</code></td>
<td>

<p>method for computation of Hellinger distances between marginal posterior densities. Either <code>"integral"</code> for integral-based computation or <code>"moment"</code> for approximate moment-based calculation using a normal approximation. Defaults to <code>"integral"</code>.
</p>
</td></tr>
<tr><td><code id="post_RA_+3A_scale.hn0">scale.hn0</code></td>
<td>

<p>scale parameter of the half-normal benchmark prior (usually a small number to
obtain an anti-conservative benchmark which has most of its probability mass close to 0).
Defaults to 0.002.
</p>
</td></tr>
<tr><td><code id="post_RA_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu. Defaults to 0.
</p>
</td></tr>
<tr><td><code id="post_RA_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu. Defaults to 4.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two posterior benchmarks used are
introduced in Ott et al. (2021, Section 3.4),
where they are denoted by
<code class="reqn">po_{J}(\Psi)</code> and <code class="reqn">po_{HN0}(\Psi)</code>.
Here, <code class="reqn">\Psi \in \{ \mu, \tau, \theta_1, ..., \theta_k, \theta_{new}  \}</code>
denotes the parameter of interest in the NNHM,
where <code class="reqn">\theta_{i}</code> is the random effect in the <code class="reqn">i</code>th study and
<code class="reqn">\theta_{new}</code> the predicted effect for a new study.
For the overall mean parameter <code class="reqn">\mu</code>,
we additionally consider the fixed-effects model benchmark
<code class="reqn">po_{FE}(\mu)</code>.
</p>
<p>Note that Jeffreys reference posterior <code class="reqn">po_{J}</code> is proper if
there are at least two studies in the meta-analysis data set.
It is based on the improper Jeffreys reference prior,
which is minimally informative given the data.
The computation of the informativeness values is described in
Ott et al. (2021, Section 3.6).
</p>
<p>The absolute value of the signed informativeness quantifies how close the
actual posterior and the reference posterior <code class="reqn">po_{J}</code> are.
If the signed informativeness is negative, then the actual prior is anti-conservative  with respect to Jeffreys reference prior J (that is puts more weight on smaller values for <code class="reqn">\tau</code> than J).
If the signed informativeness is positive, then the actual prior is conservative  with respect to Jeffreys reference prior J (that is puts more weight on larger values for <code class="reqn">\tau</code> than J).
</p>
<p>If integral-based computation (<code>H.dist.method = "integral"</code>) of Hellinger distances is selected (the default), numerical integration is applied to obtain the Hellinger distance between the two marginal posterior densities (by using the function <code>H</code>).
If moment-based computation (<code>H.dist.method = "moment"</code>) is selected, the marginal densities are first approximated by normal densities with the same means and standard deviations and then the Hellinger distance between these normal densities can be obtained by an analytical formula (implemented in the function <code>H_normal</code>).
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.
</p>


<h3>Value</h3>

<p>A matrix with 6 columns and a number of columns depending on the number
of actual heterogeneity priors specified and the parameters of interests in the NNHM
(if <code>show.re = FALSE</code>, then there are 3 parameters of interest (<code class="reqn">\mu, \tau, \theta_{new}</code>) and the matrix has <code class="reqn">3*(n+2)+1</code> rows, where
where <code class="reqn">n</code>=length(<code>tau.prior</code>) is the number of actual heterogeneity priors specified;
if <code>show.re = TRUE</code>, then the matrix has <code class="reqn">(k+3)*(n+2)+1</code> rows, where
<code class="reqn">k</code> is the number of studies in the meta-analysis data set
(so that there are <code class="reqn">k+3</code> parameters of interest).)
</p>
<p>The row names specify the parameter in the NNHM for which the marginal posterior is considered,
followed by the heterogeneity prior used to compute that posterior.
HN0, J and FE denote the three benchmark priors introduced in Ott et al. (2021).
<code>pri_act_i</code> denotes the i-th prior in the <code>tau.prior</code> list.
</p>
<p>The 6 columns provide the following estimates:
</p>

<dl>
<dt><code>estimate</code>:</dt><dd><p> posterior point estimate (median or mean)</p>
</dd>
<dt><code>CrI_low</code>:</dt><dd><p> lower limit of the 95% credible interval</p>
</dd>
<dt><code>CrI_up</code>:</dt><dd><p> upper limit of the 95% credible interval</p>
</dd>
<dt><code>length_CrI</code>:</dt><dd><p> length of the 95% credible interval</p>
</dd>
<dt><code>H(po_HN0, po_act)</code>:</dt><dd><p> Hellinger distance between the posterior benchmark <code class="reqn">po_{HN0}(\Psi)</code> and the marginal posterior induced by the heterogeneity prior listed on the left, for the parameter <code class="reqn">\Psi</code> listed on the left</p>
</dd>
<dt><code>signed_inf</code>:</dt><dd><p> Signed informativeness, i.e. <code class="reqn">sign(H(po_{HN0}, po_{act}) - H(po_{HN0}, po_{J})) H(po_{act}, po_{J})</code>, for the marginal posterior induced by the heterogeneity prior listed on the left, for the parameter <code class="reqn">\Psi</code> listed on the left</p>
</dd>
</dl>



<h3>Warning </h3>

<p>If the integral-based method is used to compute Hellinger distances (<code>H.dist.method = "integral"</code>),
numerical problems may occur in some cases, which may lead to implausible outputs.
Therefore, we generally recommend to double-check the results of the integral-based method using the moment-based method (<code>H.dist.method = "moment"</code>) - especially if the former results are implausibe. If large differences between the two methods are observed, we recommend to rely on the moment-based method unless a normal approximation of the involved densities is inappropriate.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+post_RA_fits">post_RA_fits</a></code>,
<code><a href="#topic+post_RA_3bm">post_RA_3bm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set with two
# actual half-normal heterogeneity priors
data(aa)
# it takes a few seconds to run this function
post_RA(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=0.5),
                              function(t)dhalfnormal(t, scale=1)))
                              
</code></pre>

<hr>
<h2 id='post_RA_3bm'>
Posterior reference analysis based on a data frame using 3 benchmarks
</h2><span id='topic+post_RA_3bm'></span>

<h3>Description</h3>

<p>Computes a table of Hellinger distances between marginal posterior distributions
for different parameters in the NNHM
induced by the actual heterogeneity priors specified in <code>tau.prior</code> and
posterior benchmarks proposed in the Supplementary Material of Ott et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_RA_3bm(df, tau.prior=list(function(x) dhalfnormal(x, scale=1)),
            H.dist.method = "integral",
            m_inf=NA, M_inf=NA, rlmc0=0.0001, rlmc1=0.9999,
            mu.mean=0, mu.sd=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_RA_3bm_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="post_RA_3bm_+3A_tau.prior">tau.prior</code></td>
<td>

<p>list of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td></tr>
<tr><td><code id="post_RA_3bm_+3A_h.dist.method">H.dist.method</code></td>
<td>

<p>method for computation of Hellinger distances between marginal posterior densities. Either <code>"integral"</code> for integral-based computation or <code>"moment"</code> for approximate moment-based calculation using a normal approximation. Defaults to <code>"integral"</code>.
</p>
</td></tr>
<tr><td><code id="post_RA_3bm_+3A_m_inf">m_inf</code></td>
<td>

<p>parameter value <code class="reqn">m=m_{inf}</code> of the SGC(<code class="reqn">m</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 0.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_inf_sgc</code>, such that the median RLMC is
approximately equal to <code>rlmc0</code>.
</p>
</td></tr>
<tr><td><code id="post_RA_3bm_+3A_m_inf">M_inf</code></td>
<td>

<p>parameter value <code class="reqn">M=M_{inf}</code> of the SIGC(<code class="reqn">M</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 1.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_inf_sigc</code>, such that the median RLMC is
approximately equal to <code>rlmc1</code>.
</p>
</td></tr>
<tr><td><code id="post_RA_3bm_+3A_rlmc0">rlmc0</code></td>
<td>

<p>RLMC target value for the SGC(<code class="reqn">m_{inf}</code>) benchmark prior (typically close to 0).
Is required only if <code>m_inf=NA</code>.
</p>
</td></tr>
<tr><td><code id="post_RA_3bm_+3A_rlmc1">rlmc1</code></td>
<td>

<p>RLMC target value for the SIGC(<code class="reqn">M_{inf}</code>) benchmark prior (typically close to 1).
Is required only if <code>M_inf=NA</code>.
</p>
</td></tr>
<tr><td><code id="post_RA_3bm_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td></tr>
<tr><td><code id="post_RA_3bm_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The three posterior benchmarks used are
introduced in the Supplementary Material of Ott et al. (2021, Sections 2.2.1 and 2.5, see also Section 3.4 in Ott at al. (2021) for Jeffreys reference prior),
where they are denoted by
<code class="reqn">po_{m_{inf}}(\Psi)</code>, <code class="reqn">po_{J}(\Psi)</code> and <code class="reqn">po_{M_{inf}}(\Psi)</code>.
Here, <code class="reqn">\Psi \in \{ \mu, \tau, \theta_1, ..., \theta_k, \theta_{new}  \}</code>
denotes the parameter of interest in the NNHM,
where <code class="reqn">\theta_{i}</code> is the random effect in the <code class="reqn">i</code>th study and
<code class="reqn">\theta_{new}</code> the predicted effect for a new study.
</p>
<p>Note that Jeffreys reference posterior <code class="reqn">po_{J}</code> is proper if
there are at least two studies in the meta-analysis data set.
It is based on the improper Jeffreys reference prior,
which is minimally informative given the data.
</p>
<p>If integral-based computation (<code>H.dist.method = "integral"</code>) of Hellinger distances is selected (the default), numerical integration is applied to obtain the Hellinger distance between the two marginal posterior densities (by using the function <code>H</code>).
If moment-based computation (<code>H.dist.method = "moment"</code>) is selected, the marginal densities are first approximated by normal densities with the same means and standard deviations and then the Hellinger distance between these normal densities can be obtained by an analytical formula (implemented in the function <code>H_normal</code>).
</p>
<p>The default values for <code>mu.mean</code> and <code>mu.sd</code>
are suitable for effects mu on the log odds (ratio) scale.
</p>


<h3>Value</h3>

<p>A list with two elements:
The first element named &quot;table&quot; is a matrix containing the Hellinger distance estimates and the
second element called &quot;par&quot; is a named vector giving the parameter values
of the benchmark priors.
The vector &quot;par&quot; has the following three components:
<code>m_inf</code>, <code>M_inf</code> and <code>C</code>.
</p>
<p>The matrix &quot;table&quot; contains the Hellinger distance estimates between marginal posteriors
and has <code class="reqn">3</code> columns and <code class="reqn">n*(k+3)</code> rows,
where <code class="reqn">n</code>=length(<code>tau.prior</code>) is the number of actual heterogeneity priors specified
and <code class="reqn">k</code> is the number of studies in the meta-analysis data set
(so that there are <code class="reqn">k+3</code> parameters of interest).
</p>
<p>The columns of the matrix give the following Hellinger distance estimates
between two marginal posteriors (for the parameter of interest <code class="reqn">\Psi</code> varying with rows)
induced by the following two heterogeneity priors
(from left to right):
</p>

<dl>
<dt><code>H(po_{m_inf}, po_act)</code>:</dt><dd><p> benchmark prior SGC(m_inf) and actual prior</p>
</dd>
<dt><code>H(po_J, po_act)</code>:</dt><dd><p> Jeffreys reference prior <code class="reqn">\pi_J</code> and actual prior</p>
</dd>
<dt><code>H(po_{M_inf}, po_act)</code>:</dt><dd><p> benchmark prior SIGC(M_inf) and actual prior</p>
</dd>
</dl>

<p>The actual heterogenity prior and the parameter of interest <code class="reqn">\Psi</code> vary
with the rows in the following order:
</p>

<dl>
<dt><code>mu, pri_act_1</code>:</dt><dd> <p><code class="reqn">\Psi=\mu</code> and first actual prior in <code>tau.prior</code></p>
</dd>
<dt><code>mu, pri_act_2</code>:</dt><dd> <p><code class="reqn">\Psi=\mu</code> and second actual prior in <code>tau.prior</code></p>
</dd>
<dt>... </dt><dd> </dd>
<dt><code>mu, pri_act_n</code>:</dt><dd> <p><code class="reqn">\Psi=\mu</code> and nth actual prior in <code>tau.prior</code></p>
</dd>
<dt><code>tau, pri_act_1</code>:</dt><dd> <p><code class="reqn">\Psi=\tau</code> and first actual prior in <code>tau.prior</code></p>
</dd>
<dt>... </dt><dd> </dd>
<dt><code>tau, pri_act_n</code>:</dt><dd> <p><code class="reqn">\Psi=\tau</code> and nth actual prior</p>
</dd>
<dt><code>theta_1, pri_act_1</code>:</dt><dd> <p><code class="reqn">\Psi=\theta_1</code> and first actual prior</p>
</dd>
<dt>... </dt><dd> </dd>
<dt><code>theta_k, pri_act_n</code>:</dt><dd> <p><code class="reqn">\Psi=\theta_k</code> and nth actual prior</p>
</dd>
<dt><code>theta_new, pri_act_1</code>:</dt><dd> <p><code class="reqn">\Psi=\theta_{new}</code> and first actual prior</p>
</dd>
<dt>... </dt><dd> </dd>
<dt><code>theta_new, pri_act_n</code>:</dt><dd> <p><code class="reqn">\Psi=\theta_{new}</code> and nth actual prior</p>
</dd>
</dl>



<h3>Warnings </h3>

<p>A warning message will be displayed if one of the parameters <code>m_inf</code> or <code>M_inf</code>
has a value larger than 5*10^6, since this may lead to numerical problems
in the <code>bayesmeta</code> function
used for computation of the marginal posteriors.
</p>
<p>If the integral-based method is used to compute Hellinger distances (<code>H.dist.method = "integral"</code>),
numerical problems may occur in some cases, which may lead to implausible outputs.
Therefore, we generally recommend to double-check the results of the integral-based method using the moment-based method (<code>H.dist.method = "moment"</code>) - especially if the former results are implausibe. If large differences between the two methods are observed, we recommend to rely on the moment-based method unless a normal approximation of the involved densities is inappropriate.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+post_RA_fits">post_RA_fits</a></code>,
<code><a href="#topic+pri_RA_5bm">pri_RA_5bm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set with two
# actual half-normal heterogeneity priors
data(aa)
# it takes several seconds to run this function
post_RA_3bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=0.5),
                                  function(t)dhalfnormal(t, scale=1)))

</code></pre>

<hr>
<h2 id='post_RA_fits'>
Posterior reference analysis based on bayesmeta fits
</h2><span id='topic+post_RA_fits'></span>

<h3>Description</h3>

<p>Computes a table of Hellinger distances between marginal posterior distributions
for different parameters in the NNHM
between the actual model fits in <code>fits.actual</code> and
the benchmark fits in <code>fits.bm</code>.
All fits should be based on the same data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_RA_fits(fits.actual, fits.bm,
             H.dist.method = "integral")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_RA_fits_+3A_fits.actual">fits.actual</code></td>
<td>

<p>a list of model fits of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
</p>
</td></tr>
<tr><td><code id="post_RA_fits_+3A_fits.bm">fits.bm</code></td>
<td>

<p>a list of model fits of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
To be used as benchmarks.
</p>
</td></tr>
<tr><td><code id="post_RA_fits_+3A_h.dist.method">H.dist.method</code></td>
<td>

<p>method for computation of Hellinger distances between marginal posterior densities. Either <code>"integral"</code> for integral-based computation or <code>"moment"</code> for approximate moment-based calculation using a normal approximation. Defaults to <code>"integral"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two alternative suggestions for posterior benchmarks are provided
in Ott et al. (2021, Section 3.4) and its Supplementary Material (Section 2.5) and they
can be computed using the functions <code>fit_models_RA</code> and <code>fit_models_RA_5bm</code>,
respectively.
</p>
<p>If integral-based computation (<code>H.dist.method = "integral"</code>) of Hellinger distances is selected (the default), numerical integration is applied to obtain the Hellinger distance between the two marginal posterior densities (by using the function <code>H</code>).
If moment-based computation (<code>H.dist.method = "moment"</code>) is selected, the marginal densities are first approximated by normal densities with the same means and standard deviations and then the Hellinger distance between these normal densities can be obtained by an analytical formula (implemented in the function <code>H_normal</code>).
</p>


<h3>Value</h3>

<p>A matrix of Hellinger distance estimates between marginal posteriors
with <code class="reqn">n.bm</code> columns and <code class="reqn">n.act*(k+3)</code> rows,
where <code class="reqn">n.bm</code>=length(<code>fits.bm</code>) is the number of benchmark fits specified,
<code class="reqn">n.act</code>=length(<code>fits.actual</code>) the number of actual fits specified
and
<code class="reqn">k</code> the number of studies in the meta-analysis data set
(so that there are <code class="reqn">k+3</code> parameters <code class="reqn">\Psi \in \{ \mu, \tau, \theta_1, ..., \theta_k, \theta_{new}  \}</code> of potential interest in the NNHM).
</p>
<p>The columns of the matrix give the following Hellinger distance estimates
between two marginal posteriors (for the parameter of interest <code class="reqn">\Psi</code> varying with rows)
induced by the following two heterogeneity priors
(from left to right):
</p>

<dl>
<dt><code>H(po_{bm_1}, po_act)</code>:</dt><dd><p> first benchmark prior bm_1 inducing the fit <code>fits.bm[[1]]</code> and actual prior</p>
</dd>
<dt><code>H(po_{bm_2}, po_act)</code>:</dt><dd><p> second benchmark prior bm_2 inducing the fit <code>fits.bm[[2]]</code> and actual prior</p>
</dd>
<dt>... </dt><dd><p> ... </p>
</dd>
<dt><code>H(po_{bm_{n.bm}}, po_act)</code>:</dt><dd><p> last benchmark prior bm_n.bm inducing the fit <code>fits.bm[[n.bm]]</code> and actual prior</p>
</dd>
</dl>

<p>The actual heterogenity prior and the parameter of interest <code class="reqn">\Psi</code> vary
with the rows in the following order:
</p>

<dl>
<dt><code>mu, pri_act_1</code>:</dt><dd> <p><code class="reqn">\Psi=\mu</code> and first actual prior in <code>tau.prior</code></p>
</dd>
<dt><code>mu, pri_act_2</code>:</dt><dd> <p><code class="reqn">\Psi=\mu</code> and second actual prior in <code>tau.prior</code></p>
</dd>
<dt>... </dt><dd><p> ...</p>
</dd>
<dt><code>mu, pri_act_n</code>:</dt><dd> <p><code class="reqn">\Psi=\mu</code> and nth actual prior in <code>tau.prior</code></p>
</dd>
<dt><code>tau, pri_act_1</code>:</dt><dd> <p><code class="reqn">\Psi=\tau</code> and first actual prior in <code>tau.prior</code></p>
</dd>
<dt>... </dt><dd><p> ...</p>
</dd>
<dt><code>tau, pri_act_n</code>:</dt><dd> <p><code class="reqn">\Psi=\tau</code> and nth actual prior</p>
</dd>
<dt><code>theta_1, pri_act_1</code>:</dt><dd> <p><code class="reqn">\Psi=\theta_1</code> and first actual prior</p>
</dd>
<dt>... </dt><dd><p> ...</p>
</dd>
<dt><code>theta_k, pri_act_n</code>:</dt><dd> <p><code class="reqn">\Psi=\theta_k</code> and nth actual prior</p>
</dd>
<dt><code>theta_new, pri_act_1</code>:</dt><dd> <p><code class="reqn">\Psi=\theta_{new}</code> and first actual prior</p>
</dd>
<dt>... </dt><dd><p> ...</p>
</dd>
<dt><code>theta_new, pri_act_n</code>:</dt><dd> <p><code class="reqn">\Psi=\theta_{new}</code> and nth actual prior</p>
</dd>
</dl>



<h3>Warning </h3>

<p>If the integral-based method is used to compute Hellinger distances (<code>H.dist.method = "integral"</code>),
numerical problems may occur in some cases, which may lead to implausible outputs.
Therefore, we generally recommend to double-check the results of the integral-based method using the moment-based method (<code>H.dist.method = "moment"</code>) - especially if the former results are implausibe. If large differences between the two methods are observed, we recommend to rely on the moment-based method unless a normal approximation of the involved densities is inappropriate.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="bayesmeta.html#topic+bayesmeta">bayesmeta</a></code> in the package bayesmeta,
<code><a href="#topic+fit_models_RA">fit_models_RA</a></code>,
<code><a href="#topic+post_RA">post_RA</a></code>,
<code><a href="#topic+pri_RA_fits">pri_RA_fits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set
data(aa)
 # compute the model fits  % this example takes &gt; 5 sec. to run
# actual standard half-normal and half-Cauchy heterogeneity priors
fits &lt;- fit_models_RA(df=aa, tau.prior=
                             list(function(t)dhalfnormal(t, scale=1),
                                  function(t)dhalfcauchy(t, scale=1)))
# benchmark fits under HN0 and J (Jeffreys) priors
fits.bm.post &lt;- fits[c(1,2)]
fits.actual &lt;- fits[c(3,4)]
post_RA_fits(fits.actual=fits.actual, fits.bm=fits.bm.post)

</code></pre>

<hr>
<h2 id='pri_RA_5bm'>
Prior reference analysis based on a data frame using 5 benchmarks
</h2><span id='topic+pri_RA_5bm'></span>

<h3>Description</h3>

<p>Computes a table of Hellinger distance estimates between the
actual heterogeneity prior(s) specified and
four benchmark heterogeneity priors
proposed in the Supplementary Material of Ott et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pri_RA_5bm(df, tau.prior=list(function(x) dhalfnormal(x, scale=1)),
           m_J=NA, M_J=NA, upper.J=3, digits.J=2,
           m_inf=NA, M_inf=NA, rlmc0=0.0001, rlmc1=0.9999,
           mu.mean=0, mu.sd=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pri_RA_5bm_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;y&quot; containing the (transformed) effect estimates for the individual studies and
one column &quot;sigma&quot; containing the standard errors of these estimates.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_tau.prior">tau.prior</code></td>
<td>

<p>list of prior specifications, which are <em>either</em> functions returning the probability densities of the actual priors of interest for the heterogeneity parameter tau <em>or</em> character strings specifying priors implemented in the <code>bayesmeta</code> function. See the documentation of the argument <code>tau.prior</code> of the <code>bayesmeta</code> function for details.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_m_j">m_J</code></td>
<td>

<p>parameter value <code class="reqn">m=m_J</code> of the SGC(<code class="reqn">m</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_j_sgc</code> and some other parameters.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_m_j">M_J</code></td>
<td>

<p>parameter value <code class="reqn">M=M_J</code> of the SIGC(<code class="reqn">M</code>) prior,
which induces a marignal posterior for the heterogeneity standard deviation tau   close to Jeffreys reference posterior (wrt the Hellinger distance).
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_j_sigc</code> and some other parameters.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_upper.j">upper.J</code></td>
<td>

<p>upper bound for the parameters <code>M_J</code> and <code>m_J</code>. Real number in <code class="reqn">(1,\infty)</code>. Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_digits.j">digits.J</code></td>
<td>

<p>specifies the desired precision of the parameter values <code class="reqn">M_J</code> and <code class="reqn">m_J</code>, i.e. to how many digits these two values
should be determined. Possible values are 1,2,3. Defaults to 2.
Is required only if <code>M_J=NA</code> or <code>m_J=NA</code>.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_m_inf">m_inf</code></td>
<td>

<p>parameter value <code class="reqn">m=m_{inf}</code> of the SGC(<code class="reqn">m</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 0.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>m_inf_sgc</code>, such that the median RLMC is
approximately equal to <code>rlmc0</code>.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_m_inf">M_inf</code></td>
<td>

<p>parameter value <code class="reqn">M=M_{inf}</code> of the SIGC(<code class="reqn">M</code>) prior,
such that the median relative latent model complexity (RLMC) is close to 1.
If set to <code>NA</code> (the default), this parameter is computed
using the function <code>M_inf_sigc</code>, such that the median RLMC is
approximately equal to <code>rlmc1</code>.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_rlmc0">rlmc0</code></td>
<td>

<p>RLMC target value for the SGC(<code class="reqn">m_{inf}</code>) benchmark prior (typically close to 0).
Is required only if <code>m_inf=NA</code>.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_rlmc1">rlmc1</code></td>
<td>

<p>RLMC target value for the SIGC(<code class="reqn">M_{inf}</code>) benchmark prior (typically close to 1).
Is required only if <code>M_inf=NA</code>.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_mu.mean">mu.mean</code></td>
<td>

<p>mean of the normal prior for the effect mu.
</p>
</td></tr>
<tr><td><code id="pri_RA_5bm_+3A_mu.sd">mu.sd</code></td>
<td>

<p>standard deviation of the normal prior for the effect mu.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methodology for a prior reference analysis and the four proper heterogeneity benchmark priors used are
introduced in the Supplementary Material of Ott et al. (2021, Sections 2.5 and 2.6).
There, these four benchmark priors are denoted by
SGC(<code class="reqn">m_J</code>), SIGC(<code class="reqn">M_J</code>), SGC(<code class="reqn">m_{inf}</code>) and SIGC(<code class="reqn">M_{inf}</code>).
</p>


<h3>Value</h3>

<p>A list with two elements:
The first element named &quot;table&quot; is a matrix containing the Hellinger distance estimates and the
second element called &quot;par&quot; is a named vector giving the parameter values
of the benchmark priors.
The vector &quot;par&quot; has the following five components:
<code>m_inf</code>, <code>M_J</code>, <code>m_J</code>, <code>M_inf</code> and <code>C</code>.
</p>
<p>The matrix &quot;table&quot; contains the Hellinger distance estimates between actual and benchmark
heterogeneity priors
and has <code class="reqn">4</code> columns and <code class="reqn">n</code> rows,
where <code class="reqn">n</code> is the number of actual heterogeneity priors specified,
i.e. the length of the list <code>tau.prior</code>.
</p>
<p>The columns of the matrix give the following Hellinger distance estimates
between two heterogeneity priors
(from left to right):
</p>

<dl>
<dt><code>H(SGC(m_inf), pri_act)</code>:</dt><dd><p> benchmark prior SGC(m_inf) and actual prior</p>
</dd>
<dt><code>H(SIGC(M_J), pri_act)</code>:</dt><dd><p> benchmark prior SIGC(M_J) and actual prior</p>
</dd>
<dt><code>H(SGC(m_J), pri_act)</code>:</dt><dd><p> benchmark prior SGC(m_J) and actual prior</p>
</dd>
<dt><code>H(SIGC(M_inf), pri_act)</code>:</dt><dd><p> benchmark prior SIGC(M_inf) and actual prior</p>
</dd>
</dl>

<p>Each row corresponds to one actual heterogeneity prior
specified in the list <code>tau.prior</code>, in the same order
as in that list. Thus, the row names are:
</p>

<dl>
<dt><code>pri_act_1</code>:</dt><dd><p> first actual prior in <code>tau.prior</code></p>
</dd>
<dt><code>pri_act_2</code>:</dt><dd><p> second actual prior in <code>tau.prior</code></p>
</dd>
<dt>...</dt><dd></dd>
<dt><code>pri_act_n</code>:</dt><dd><p> nth (last) actual prior in <code>tau.prior</code></p>
</dd>
</dl>



<h3>Warning </h3>

<p>This function may take several minutes to run if the parameter <code>m_J</code> and/or <code>M_J</code>
is not specified,
especially if the desired precision is <code>digits.J=2</code> or even <code>digits.J=3</code>.
</p>


<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+post_RA_3bm">post_RA_3bm</a></code>,
<code><a href="#topic+pri_RA_fits">pri_RA_fits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set with one
# actual half-normal and the "DuMouchel" heterogeneity prior
data(aa)
# warning: it takes ca. 7 min. to run this function
pri_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                 "DuMouchel"))
                                 
# computation is much faster if m_J and M_J are specified
pri_RA_5bm(df=aa, tau.prior=list(function(t)dhalfnormal(t, scale=1),
                                 "DuMouchel"),
           m_J = 1.35, M_J = 1.3)
</code></pre>

<hr>
<h2 id='pri_RA_fits'>
Prior reference analysis based on bayesmeta fits
</h2><span id='topic+pri_RA_fits'></span>

<h3>Description</h3>

<p>Computes a table of Hellinger distance estimates between the
benchmark heterogeneity priors inducing the specified model fits in <code>fits.bm</code>
and the actual heterogenity priors inducing the specified actual model fits in <code>fits.actual</code>.
All fits should be based on the same data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pri_RA_fits(fits.actual, fits.bm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pri_RA_fits_+3A_fits.actual">fits.actual</code></td>
<td>

<p>a list of model fits of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
</p>
</td></tr>
<tr><td><code id="pri_RA_fits_+3A_fits.bm">fits.bm</code></td>
<td>

<p>a list of model fits of class bayesmeta, computed with
the <code>bayesmeta</code> function in the package bayesmeta.
To be used as benchmarks.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two alternative suggestions for benchmark priors are provided
in Ott et al. (2021, Section 3.4) and its Supplementary Material (Sections 2.5 and 2.6).
These benchmark priors and the corresponding fits
can be computed using the functions <code>fit_models_RA</code> and <code>fit_models_RA_5bm</code>,
respectively.
</p>


<h3>Value</h3>

<p>A matrix of Hellinger distance estimates between actual and benchmark
heterogeneity priors
with <code class="reqn">n.bm</code> columns and <code class="reqn">n.act</code> rows,
where <code class="reqn">n.bm</code>=length(<code>fit.bms</code>) is the number of benchmark fits specified and
<code class="reqn">n.act</code>=length(<code>fit.actual</code>) the number of actual fits specified.
</p>
<p>The columns of the matrix give the following Hellinger distance estimates
between two heterogeneity priors
(from left to right):
</p>

<dl>
<dt><code>H(pri_bm_1, pri_act)</code>:</dt><dd><p> first benchmark prior bm_1 inducing the fit <code>fits.bm[[1]]</code> and actual prior</p>
</dd>
<dt><code>H(pri_bm_2, pri_act)</code>:</dt><dd><p> second benchmark prior bm_2 inducing the fit <code>fits.bm[[2]]</code> and actual prior</p>
</dd>
<dt>... </dt><dd><p> ... </p>
</dd>
<dt><code>H(pri_bm_n.bm, pri_act)</code>:</dt><dd><p> last benchmark prior bm_n.bm inducing the fit <code>fits.bm[[n.bm]]</code> and actual prior</p>
</dd>
</dl>

<p>Each row correspond to one actual heterogeneity prior
inducing one of the fits in <code>fits.actual</code>, in the same order
as in that list. Thus, the row names are:
</p>

<dl>
<dt><code>pri_act_1</code>:</dt><dd><p> first actual prior in <code>tau.prior</code></p>
</dd>
<dt><code>pri_act_2</code>:</dt><dd><p> second actual prior in <code>tau.prior</code></p>
</dd>
<dt>...</dt><dd><p> ...</p>
</dd>
<dt><code>pri_act_n</code>:</dt><dd><p> nth (last) actual prior in <code>tau.prior</code></p>
</dd>
</dl>



<h3>References</h3>

<p>Ott, M., Plummer, M., Roos, M. (2021). Supplementary Material:
How vague is vague? How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em>.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>
<p>Ott, M., Plummer, M., Roos, M. (2021). How vague is vague?
How informative is informative? Reference analysis for
Bayesian meta-analysis. <em>Statistics in Medicine</em> <b>40</b>, 4505&ndash;4521.
<a href="https://doi.org/10.1002/sim.9076">doi:10.1002/sim.9076</a>
</p>


<h3>See Also</h3>

<p><code><a href="bayesmeta.html#topic+bayesmeta">bayesmeta</a></code> in the package bayesmeta,
<code><a href="#topic+fit_models_RA_5bm">fit_models_RA_5bm</a></code>,
<code><a href="#topic+post_RA_fits">post_RA_fits</a></code>,
<code><a href="#topic+pri_RA_5bm">pri_RA_5bm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for aurigular acupuncture (AA) data set
data(aa)
# compute the model fits  % function with long running time
# two actual half-normal heterogeneity priors
# warning: it takes ca. 7 min. to run this function
fits &lt;- fit_models_RA_5bm(df=aa, tau.prior=
                                 list(function(t)dhalfnormal(t, scale=0.5),
                                      function(t)dhalfnormal(t, scale=1)))[[1]]
# benchmark fits under SGC(m_inf), SIGC(M_J), SGC(m_J) and SIGC(M_inf) priors
fits.bm.pri &lt;- fits[1:4]
# actual fits under HN priors
fits.actual &lt;- fits[c(6,7)]
# prior reference analysis
pri_RA_fits(fits.actual=fits.actual, fits.bm=fits.bm.pri)

</code></pre>

<hr>
<h2 id='rti'>
Respiratory tract infections data
</h2><span id='topic+rti'></span>

<h3>Description</h3>

<p>Meta-analysis data set including 22 randomized, controlled clinical
trials on the prevention of respiratory tract infections
by selective decontamination of the digestive tract
in intensive care unit patients.
The patients in the treated group received oral antibiotics, and those in the control groups received no prophylaxis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rti)</code></pre>


<h3>Format</h3>

<p>A data frame with 22 observations on the following 7 variables:
</p>

<dl>
<dt><code>study</code></dt><dd><p>character string, label of the study</p>
</dd>

<dt><code>f.t</code></dt><dd><p>integer, number of patients who became cases of respiratory tract infections among those receiving antibiotics</p>
</dd>
<dt><code>n.t</code></dt><dd><p>integer, number of patients receiving antibiotics</p>
</dd>
<dt><code>f.c</code></dt><dd><p>integer, number of patients who became cases of respiratory tract infections among those receiving no prophylaxis</p>
</dd>
<dt><code>n.c</code></dt><dd><p>integer, number of patients receiving no prophylaxis (control group)</p>
</dd>
<dt><code>y</code></dt><dd><p>numeric, log odds ratio estimates for the individual trials</p>
</dd>
<dt><code>sigma</code></dt><dd><p>numeric, standard error of the log odds ratio estimate for the individual trials</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data set was originally analyzed by the Selective Decontamination of the Digestive Tract Trialists' Collaborative Group (1993) and reanalyzed by Bodnar et al. (2017).
Overall, 3836 patients are included in these 22 trials.
</p>
<p>The log odds ratio estimates and standard errors were computed using the <code>escalc</code> function in the
package <code>metafor</code> using the option of adding 0.5 to all cells in tables including zeros (argument <code>to="only0"</code>)
as described in Bodnar et al. (2017).
</p>


<h3>Source</h3>

<p>Bodnar, O., Link, A., Arendacka, B., Possolo, A., Elster, C. (2017). Bayesian estimation in random effects meta-analysis using a non-informative prior.
<em>Statistics in Medicine</em> <b>36</b>, 378&ndash;399.
</p>


<h3>References</h3>

<p>Selective Decontamination of the Digestive Tract Trialists' Collaborative Group (1993). Meta-analysis of randomised controlled
trials of selective decontamination of the digestive tract. <em>British Medical Journal</em> <b>307(6903)</b>, 525&ndash;532.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rti)
str(rti)
# forest plot
forest(x=rti$y, sei=rti$sigma, xlab="log odds ratio")
</code></pre>

<hr>
<h2 id='sigma_ref'>
Reference standard deviation
</h2><span id='topic+sigma_ref'></span>

<h3>Description</h3>

<p>Computes the reference standard deviation of the
given meta-analysis data set.
The reference standard deviation is defined as the geometric mean
of the standard deviations of the individual studies
(Sorbye &amp; Rue 2014, equation (7)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigma_ref(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigma_ref_+3A_df">df</code></td>
<td>

<p>data frame with one column &quot;sigma&quot; containing the standard errors of the estimates for the individual studies.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The reference standard deviation of the data set. Non-negative real number.
</p>


<h3>References</h3>

<p>Sorbye, S., Rue, H. (2014). Scaling intrinsic Gaussian Markov random field priors in
spatial modelling. <em>Spatial Statistics</em> <b>8</b>, 39&ndash;51.
<a href="https://doi.org/10.1016/j.spasta.2013.06.004">doi:10.1016/j.spasta.2013.06.004</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># reference sd for resporiratory tract infections (RTI) data
data(rti)
sigma_ref(df=rti)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
