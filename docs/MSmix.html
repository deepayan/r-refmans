<!DOCTYPE html><html><head><title>Help for package MSmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MSmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bicMSmix'><p>BIC and AIC for mixtures of Mallows models with Spearman distance</p></a></li>
<li><a href='#bootstrapMSmix'><p>Bootstrap confidence intervals for mixtures of Mallows models with Spearman distance</p></a></li>
<li><a href='#confintMSmix'><p>Hessian-based confidence intervals for mixtures of Mallows models with Spearman distance</p></a></li>
<li><a href='#data_augmentation'><p>Data augmentation of partial rankings</p></a></li>
<li><a href='#data_completion'><p>Completion of partial rankings with reference full rankings</p></a></li>
<li><a href='#data_conversion'><p>Switch data format from rankings to orderings and vice versa</p></a></li>
<li><a href='#data_description'><p>Descriptive summaries for partial rankings</p></a></li>
<li><a href='#expected_spear_dist'><p>Expectation of the Spearman distance</p></a></li>
<li><a href='#fitMSmix'><p>MLE of mixtures of Mallows models with Spearman distance via EM algorithms</p></a></li>
<li><a href='#likMSmix'><p>(Log-)likelihood for mixtures of Mallows models with Spearman distance</p></a></li>
<li><a href='#MSmix-package'><p>Finite Mixtures of Mallows Models with Spearman Distance for Full and Partial Rankings</p></a></li>
<li><a href='#partition_fun_spear'><p>Partition function of the Mallows model with Spearman distance</p></a></li>
<li><a href='#plot.data_descr'><p>Plot descriptive statistics for partial rankings</p></a></li>
<li><a href='#plot.dist'><p>Plot the Spearman distance matrix</p></a></li>
<li><a href='#plot.emMSmix'><p>Plot the MLEs for the fitted mixture of Mallows models with Spearman distance</p></a></li>
<li><a href='#ranks_antifragility'><p>Antifragility Data (complete rankings)</p></a></li>
<li><a href='#ranks_beers'><p>Beers Data (partial rankings with covariate)</p></a></li>
<li><a href='#ranks_read_genres'><p>Reading Genres Data (partial rankings with covariates)</p></a></li>
<li><a href='#ranks_sports'><p>Sports Data (complete rankings with covariates)</p></a></li>
<li><a href='#rMSmix'><p>Random samples from a mixture of Mallows models with Spearman distance</p></a></li>
<li><a href='#spear_dist'><p>Spearman distance</p></a></li>
<li><a href='#spear_dist_distr'><p>Spearman distance distribution under the uniform ranking model</p></a></li>
<li><a href='#summary.emMSmix'><p>Summary of the fitted mixture of Mallows models with Spearman distance</p></a></li>
<li><a href='#var_spear_dist'><p>Variance of the Spearman distance</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Finite Mixtures of Mallows Models with Spearman Distance for
Full and Partial Rankings</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cristina Mollica &lt;cristina.mollica@uniroma1.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit and analysis of finite Mixtures of Mallows models with Spearman Distance for full and partial rankings with arbitrary missing positions. Inference is conducted within the maximum likelihood framework via Expectation-Maximization algorithms. Estimation uncertainty is tackled via diverse versions of bootstrapping as well as via Hessian-based standard errors calculations. The most relevant reference of the methods is Crispino, Mollica, Astuti and Tardella (2023) &lt;<a href="https://doi.org/10.1007%2Fs11222-023-10266-8">doi:10.1007/s11222-023-10266-8</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>BayesMallows (&ge; 2.0.1), bmixture (&ge; 1.7.0), data.table (&ge;
1.15.0), dplyr (&ge; 1.1.4), factoextra (&ge; 1.0.7), fields (&ge;
15.2.0), foreach (&ge; 1.5.2), ggbump (&ge; 0.1.0), ggplot2 (&ge;
3.4.4), gridExtra (&ge; 2.3.0), methods (&ge; 4.3.1), Rankcluster
(&ge; 0.98.0), RColorBrewer (&ge; 1.1.3), Rcpp (&ge; 1.0.12), reshape
(&ge; 0.8.9), rlang (&ge; 1.1.3), spsUtil (&ge; 0.2.2), stats (&ge;
4.3.1), stringr (&ge; 1.5.1)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>doParallel</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Cristina Mollica <a href="https://orcid.org/0000-0001-9152-6021"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Marta Crispino <a href="https://orcid.org/0000-0002-1818-1298"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Lucia Modugno <a href="https://orcid.org/0009-0003-7212-3237"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Luca Tardella <a href="https://orcid.org/0000-0002-5703-3909"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-19 00:19:26 UTC; cristina</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-21 14:30:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='bicMSmix'>BIC and AIC for mixtures of Mallows models with Spearman distance</h2><span id='topic+bicMSmix'></span><span id='topic+aicMSmix'></span>

<h3>Description</h3>

<p><code>bicMSmix</code> and <code>aicMSmix</code> compute, respectively, the Bayesian Information Criterion (BIC) and the Akaike Information Criterion (AIC) for a mixture of Mallow models with Spearman distance fitted on partial rankings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bicMSmix(rho, theta, weights, rankings)

aicMSmix(rho, theta, weights, rankings)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bicMSmix_+3A_rho">rho</code></td>
<td>
<p>Integer <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the component-specific consensus rankings in each row.</p>
</td></tr>
<tr><td><code id="bicMSmix_+3A_theta">theta</code></td>
<td>
<p>Numeric vector of <code class="reqn">G</code> non-negative component-specific precision parameters.</p>
</td></tr>
<tr><td><code id="bicMSmix_+3A_weights">weights</code></td>
<td>
<p>Numeric vector of <code class="reqn">G</code> positive mixture weights (normalization is not necessary).</p>
</td></tr>
<tr><td><code id="bicMSmix_+3A_rankings">rankings</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with partial rankings in each row. Missing positions must be coded as <code>NA</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The (log-)likelihood evaluation is performed by augmenting the partial rankings with the set of all compatible full rankings (see <code><a href="#topic+data_augmentation">data_augmentation</a></code>), and then the marginal likelihood is computed.
</p>
<p>When <code class="reqn">n\leq 20</code>, the (log-)likelihood is exactly computed, otherwise it is approximated with the method introduced by Crispino et al. (2023).
</p>


<h3>Value</h3>

<p>The BIC or AIC value.
</p>


<h3>References</h3>

<p>Crispino M, Mollica C, Modugno L, Casadio Tarabusi E, and Tardella L (2024+). MSmix: An R Package for clustering partial rankings via mixtures of Mallows Models with Spearman distance. <em>(submitted)</em>
</p>
<p>Crispino M, Mollica C, Astuti V and Tardella L (2023). Efficient and accurate inference for mixtures of Mallows models with Spearman distance. <em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>
<p>Schwarz G (1978). Estimating the dimension of a model. <em>The Annals of Statistics</em>, <b>6</b>(2), pages 461â€“464, DOI: 10.1002/sim.6224.
</p>
<p>Sakamoto Y, Ishiguro M, and Kitagawa G (1986). <em>Akaike Information Criterion Statistics</em>. Dordrecht, The Netherlands: D. Reidel Publishing Company.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+likMSmix">likMSmix</a></code>, <code><a href="#topic+data_augmentation">data_augmentation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Simulate rankings from a 2-component mixture of Mallow models with Spearman distance.
set.seed(12345)
rank_sim &lt;- rMSmix(sample_size = 50, n_items = 12, n_clust = 2)
str(rank_sim)
rankings &lt;- rank_sim$samples
# Fit the true model.
set.seed(12345)
fit &lt;- fitMSmix(rankings = rankings, n_clust = 2, n_start = 10)
# Comparing the BIC at the true parameter values and at the MLE.
bicMSmix(rho = rank_sim$rho, theta = rank_sim$theta, weights = rank_sim$weights,
       rankings = rank_sim$samples)
bicMSmix(rho = fit$mod$rho, theta = fit$mod$theta, weights = fit$mod$weights,
       rankings = rank_sim$samples)
aicMSmix(rho = rank_sim$rho, theta = rank_sim$theta, weights = rank_sim$weights,
       rankings = rank_sim$samples)
aicMSmix(rho = fit$mod$rho, theta = fit$mod$theta, weights = fit$mod$weights,
       rankings = rank_sim$samples)


## Example 2. Simulate rankings from a basic Mallow model with Spearman distance.
set.seed(54321)
rank_sim &lt;- rMSmix(sample_size = 50, n_items = 8, n_clust = 1)
str(rank_sim)
# Let us censor the observations to be top-5 rankings.
rank_sim$samples[rank_sim$samples &gt; 5] &lt;- NA
rankings &lt;- rank_sim$samples
# Fit the true model with the two EM algorithms.
set.seed(54321)
fit_em &lt;- fitMSmix(rankings = rankings, n_clust = 1, n_start = 10)
set.seed(54321)
fit_mcem &lt;- fitMSmix(rankings = rankings, n_clust = 1, n_start = 10, mc_em = TRUE)
# Compare the BIC at the true parameter values and at the MLEs.
bicMSmix(rho = rank_sim$rho, theta = rank_sim$theta, weights = rank_sim$weights,
       rankings = rank_sim$samples)
bicMSmix(rho = fit_em$mod$rho, theta = fit_em$mod$theta, weights = fit_em$mod$weights,
       rankings = rank_sim$samples)
bicMSmix(rho = fit_mcem$mod$rho, theta = fit_mcem$mod$theta, weights = fit_mcem$mod$weights,
       rankings = rank_sim$samples)
aicMSmix(rho = rank_sim$rho, theta = rank_sim$theta, weights = rank_sim$weights,
       rankings = rank_sim$samples)
aicMSmix(rho = fit_em$mod$rho, theta = fit_em$mod$theta, weights = fit_em$mod$weights,
       rankings = rank_sim$samples)
aicMSmix(rho = fit_mcem$mod$rho, theta = fit_mcem$mod$theta, weights = fit_mcem$mod$weights,
       rankings = rank_sim$samples)

</code></pre>

<hr>
<h2 id='bootstrapMSmix'>Bootstrap confidence intervals for mixtures of Mallows models with Spearman distance</h2><span id='topic+bootstrapMSmix'></span><span id='topic+plot.bootMSmix'></span>

<h3>Description</h3>

<p>Return the bootstrap confidence intervals for the parameters of a mixture of Mallow models with Spearman distance fitted on partial rankings.
</p>
<p><code>plot</code> method for class <code>"bootMSmix"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrapMSmix(
  rankings,
  n_boot = 50,
  conf_level = 0.95,
  n_clust = 1,
  z_hat = (if (n_clust == 1) NULL),
  type = (if (n_clust == 1) "non-parametric" else "soft"),
  rho_mle = NULL,
  theta_mle = NULL,
  n_start = 10,
  mc_em = FALSE,
  item_names = NULL,
  all = FALSE
)

## S3 method for class 'bootMSmix'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrapMSmix_+3A_rankings">rankings</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with partial rankings in each row. Missing positions must be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_n_boot">n_boot</code></td>
<td>
<p>Number of desired bootstrap samples. Defaults to 50.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_conf_level">conf_level</code></td>
<td>
<p>Value in the interval (0,1) indicating the desired confidence level of the interval estimates. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_n_clust">n_clust</code></td>
<td>
<p>Number of mixture components. Defaults to 1.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_z_hat">z_hat</code></td>
<td>
<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">G</code> matrix of the estimated component membership probabilities. This coincides with the object <code>z_hat</code> returned by <code>fitMSmix</code>, needed when <code>n_clust &gt; 1</code>.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_type">type</code></td>
<td>
<p>Character string indicating which bootstrap method must be used. Options are: <code>"soft"</code>, <code>"separated"</code>, <code>"non-parametric"</code>, <code>"parametric"</code>. Defaults to <code>"soft"</code> when <code>n_clust &gt; 1</code> and to <code>"non-parametric"</code> when <code>n_clust = 1</code>. See Details.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_rho_mle">rho_mle</code></td>
<td>
<p>Integer <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the MLE of the component-specific consensus rankings in each row. Needed when <code>type = parametric</code>. When <code>NULL</code>, the MLEs are automatically computed.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_theta_mle">theta_mle</code></td>
<td>
<p>Numeric vector with the MLE of the <code class="reqn">G</code> component-specific precision parameters. Needed for parametric bootstrap. When <code>NULL</code>, the MLEs are automatically computed.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_n_start">n_start</code></td>
<td>
<p>Number of starting points for the MLE on each bootstrap sample. Defaults to 10.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_mc_em">mc_em</code></td>
<td>
<p>Logical: whether the Monte Carlo EM algorithm must be used for MLE on partial rankings. Ignored when <code>rankings</code> does not contain any partial sequence. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_item_names">item_names</code></td>
<td>
<p>Character vector for the names of the items. Defaults to NULL, meaning that <code>colnames(rankings)</code> is used and, if not available, <code>item_names</code> is set equal to <code>"Item1","Item2",...</code>.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_all">all</code></td>
<td>
<p>Logical: whether the bootstrap samples of the MLEs for all the parameters must be returned. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_x">x</code></td>
<td>
<p>An object of class <code>"bootMSmix"</code> returned by <code>bootstrapMSmix</code>.</p>
</td></tr>
<tr><td><code id="bootstrapMSmix_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>n_clust &gt; 1</code>, two types of bootstrap are available: 1) <code>type = "soft"</code> (default), which is
the soft-separated bootstrap (Crispino et al., 2024+) and returns confidence intervals for all
the parameters of the mixture of Mallow models with Spearman distance; 2) <code>type = "separated"</code>, which is the separated bootstrap
(Taushanov and Berchtold, 2019) and returns bootstrap samples for the component-specific
consensus rankings and precisions.
</p>
<p>When <code>n_clust = 1</code>, <code>type</code> can be either <code>"non-parametric"</code> (default) or
<code>"parametric"</code>, where the latter supports full rankings only.
</p>


<h3>Value</h3>

<p>An object of class <code>"bootMSmix"</code>, namely a list with the following named components:
</p>

<dl>
<dt><code>itemwise_ci_rho</code></dt><dd><p>The bootstrap itemwise confidence intervals for the component-specific consensus rankings.</p>
</dd>
<dt><code>ci_boot_theta</code></dt><dd><p>The bootstrap confidence intervals for the component-specific precisions.</p>
</dd>
<dt><code>ci_boot_weights</code></dt><dd><p>The bootstrap confidence intervals for the mixture weights. Returned when <code>n_clust &gt; 1</code> and <code>type == "soft"</code>, otherwise <code>NULL</code>.</p>
</dd>
<dt><code>boot</code></dt><dd><p>List containing all the <code>n_boot</code> bootstrap parameters. Returned when <code>all = TRUE</code>, otherwise <code>NULL</code>.</p>
</dd>
</dl>

<p>The <code>boot</code> sublist contains the following named components:
</p>

<dl>
<dt><code>rho_boot</code></dt><dd><p>List of length <code>n_clust</code> with the bootstrap MLEs of the consensus rankings. Each element of the list is an integer <code>n_boot</code> <code class="reqn">\times</code> <code>n_items</code> matrix containing, in each row, the bootstrap MLEs of the consensus ranking for a specific component.</p>
</dd>
<dt><code>theta_boot</code></dt><dd><p>Numeric <code>n_boot</code><code class="reqn">\times</code> <code>n_clust</code> matrix with the bootstrap MLEs of the component-specific precision parameters in each row.</p>
</dd>
<dt><code>weights_boot</code></dt><dd><p>Numeric <code>n_boot</code><code class="reqn">\times</code> <code>n_clust</code> matrix with the bootstrap MLEs of the mixture weights in each row. Returned when  <code>n_clust &gt; 1</code> and <code>type = "soft"</code>, otherwise <code>NULL</code>.</p>
</dd>
</dl>

<p>For the component-specific bootstrap consensus ranking estimates, a heatmap is returned.
</p>
<p>For the component-specific precisions and weights (for the latter when <code class="reqn">G &gt; 1</code>), a kernel density plot is returned.
</p>


<h3>References</h3>

<p>Crispino M, Mollica C, Modugno L, Casadio Tarabusi E, and Tardella L (2024+). MSmix: An R Package for clustering partial rankings via mixtures of Mallows Models with Spearman distance. <em>(submitted)</em>
</p>
<p>Taushanov Z and Berchtold A (2019). Bootstrap validation of the estimated parameters in mixture models used for clustering. <em>Journal de la sociÃ©tÃ© franÃ§aise de statistique</em>, <b>160</b>(1).
</p>
<p>Efron B (1982). The Jackknife, the Bootstrap, and Other Resampling Plans. Philadelphia, <em>Pa. :Society for Industrial and Applied Mathematics</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Compute the bootstrap 95% confidence intervals for the Antifragility dataset.
# Let us assume no clusters.
set.seed(12345)
fit &lt;- fitMSmix(rankings = ranks_antifragility, n_clust = 1, n_start = 1)
# Apply non-parametric bootstrap procedure.
boot_np &lt;- bootstrapMSmix(rankings = ranks_antifragility, n_clust = 1, n_boot = 200)
boot_np
# Apply parametric bootstrap procedure and set all = TRUE
# to return the bootstrap MLEs of the consensus ranking.
boot_p &lt;- bootstrapMSmix(rankings = ranks_antifragility, n_clust = 1, n_boot = 200,
                       rho_mle = fit$mod$rho, theta_mle = fit$mod$theta,
                       type = "parametric", all = TRUE)
plot(boot_p)


## Example 2. Compute the bootstrap 95% confidence intervals for the Antifragility dataset.
# Let us assume 2 clusters and apply soft bootstrap.
set.seed(12345)
fit &lt;- fitMSmix(rankings = ranks_antifragility, n_clust = 2, n_start = 20)
# Apply soft bootstrap procedure.
boot_soft &lt;- bootstrapMSmix(rankings = ranks_antifragility, n_clust = 2, z_hat = fit$mod$z_hat,
                      n_boot = 500, n_start = 20, all = TRUE)
plot(boot_soft)
# Apply separated bootstrap and compare results.
boot_sep &lt;- bootstrapMSmix(rankings = ranks_antifragility, n_clust = 2, z_hat = fit$mod$z_hat,
                      n_boot = 500, n_start = 20,
                      rho_mle = fit$mod$rho, theta_mle = fit$mod$theta,
                      type = "separated", all = TRUE)
plot(boot_sep)

</code></pre>

<hr>
<h2 id='confintMSmix'>Hessian-based confidence intervals for mixtures of Mallows models with Spearman distance</h2><span id='topic+confintMSmix'></span>

<h3>Description</h3>

<p>Return the Hessian-based confidence intervals of the continuous parameters of a mixture of Mallow models with Spearman distance, namely the component-specific precisions and weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confintMSmix(
  n_items,
  sample_size,
  theta_mle,
  weights_mle = (if (length(theta_mle) == 1) NULL),
  z_hat = (if (length(theta_mle) == 1) NULL),
  conf_level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confintMSmix_+3A_n_items">n_items</code></td>
<td>
<p>Number of items.</p>
</td></tr>
<tr><td><code id="confintMSmix_+3A_sample_size">sample_size</code></td>
<td>
<p>Number of rankings in the observed sample.</p>
</td></tr>
<tr><td><code id="confintMSmix_+3A_theta_mle">theta_mle</code></td>
<td>
<p>Numeric vector with the MLEs of the <code class="reqn">G</code> component-specific precision parameters.</p>
</td></tr>
<tr><td><code id="confintMSmix_+3A_weights_mle">weights_mle</code></td>
<td>
<p>Numeric vector with the MLEs of the <code class="reqn">G</code> mixture weights.</p>
</td></tr>
<tr><td><code id="confintMSmix_+3A_z_hat">z_hat</code></td>
<td>
<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">G</code> matrix of the estimated component membership probabilities. This coincides with the object <code>z_hat</code> returned by <code>fitMSmix</code>, needed when <code>n_clust &gt; 1</code>.</p>
</td></tr>
<tr><td><code id="confintMSmix_+3A_conf_level">conf_level</code></td>
<td>
<p>Value in the interval (0,1) indicating the desired confidence level of the interval estimates. Defaults to 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following named components:
</p>
<table>
<tr><td><code>ci_theta</code></td>
<td>
<p>The confidence intervals for the precision parameters.</p>
</td></tr>
<tr><td><code>ci_weights</code></td>
<td>
<p>The confidence intervals for the mixture weights. Returned when <code class="reqn">G&gt;1</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Crispino M, Mollica C, Modugno L, Casadio Tarabusi E, and Tardella L (2024+). MSmix: An R Package for clustering partial rankings via mixtures of Mallows Models with Spearman distance. <em>(submitted)</em>
</p>
<p>Marden JI (1995). Analyzing and modeling rank data. <em>Monographs on Statistics and Applied Probability</em> (64). Chapman &amp; Hall, ISSN: 0-412-99521-2. London.
</p>
<p>Mclachlan G and Peel D (2000). Finite Mixture Models. <em>Vol. 299. New York: Wiley</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Simulate rankings from a 2-component mixture of Mallow models with Spearman distance.
set.seed(123)
d_sim &lt;- rMSmix(sample_size = 75, n_items = 8, n_clust = 2)
str(d_sim)
# Fit the true model.
rankings &lt;- d_sim$samples
set.seed(123)
fit &lt;- fitMSmix(rankings = rankings, n_clust = 2, n_start = 10)
# Compute the hessian-based confidence intervals for the MLEs of the weights and precisions.
confintMSmix(n_items = ncol(rankings), sample_size = nrow(rankings),
                theta_mle = fit$mod$theta, weights_mle = fit$mod$weights,
                z_hat = fit$mod$z_hat)

</code></pre>

<hr>
<h2 id='data_augmentation'>Data augmentation of partial rankings</h2><span id='topic+data_augmentation'></span>

<h3>Description</h3>

<p>For a given partial ranking matrix, generate all possible full rankings which are compatible with each partially ranked sequence. Partial rankings with at most 10 missing positions and arbitrary patterns of censoring are supported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_augmentation(rankings, subset = NULL, fill_single_na = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data_augmentation_+3A_rankings">rankings</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with partial rankings in each row. Missing positions must be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="data_augmentation_+3A_subset">subset</code></td>
<td>
<p>Optional logical or integer vector specifying the subset of observations, i.e. rows of the <code>rankings</code>, to be kept. Missing values are taken as <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="data_augmentation_+3A_fill_single_na">fill_single_na</code></td>
<td>
<p>Logical: whether single missing positions in the row of <code>rankings</code> must be filled in prior to data augmentation. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data augmentation of a full ranking returns the complete ranking itself arranged in a row vector. The function can be applied on partial observations expressed in ordering format as well. A message informs the user when the augmentation may be heavy, before proceeding.
</p>


<h3>Value</h3>

<p>A list of <code class="reqn">N</code> elements corresponding to the matrices of full rankings compatible with each partial sequence.
</p>


<h3>References</h3>

<p>Crispino M, Mollica C, Astuti V and Tardella L (2023). Efficient and accurate inference for mixtures of Mallows models with Spearman distance. <em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Data augmentation of a single partial top-9 ranking.
data_augmentation(c(3, 7, 5, 1, NA, 4, NA, 8, 2, 6, NA, 9))

## Example 2. Data augmentation of partial rankings with different censoring patterns.
rank_data &lt;- rbind(c(NA, 4, NA, 1, NA),
                   c(NA, NA, NA, NA, 1),
                   c(2, NA, 1, NA, 3),
                   c(4, 2, 3, 5, 1),
                   c(NA, 4, 1, 3, 2))
data_augmentation(rank_data)



</code></pre>

<hr>
<h2 id='data_completion'>Completion of partial rankings with reference full rankings</h2><span id='topic+data_completion'></span>

<h3>Description</h3>

<p>Deterministic completion of partial rankings with the relative positions of the unranked items in the reference full rankings. Partial rankings with arbitrary patterns of censoring are supported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_completion(rankings, reference_rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data_completion_+3A_rankings">rankings</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the partial rankings to be completed in each row. Missing positions must be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="data_completion_+3A_reference_rho">reference_rho</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix whose rows represent the reference full rankings to be used to complete the partial rankings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments <code>rankings</code> and <code>reference_rho</code> must be matrices with the same dimension.
</p>
<p>The completion of a full ranking returns the complete ranking itself.
</p>


<h3>Value</h3>

<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the completed rankings in each row.
</p>


<h3>References</h3>

<p>Crispino M, Mollica C, Modugno L, Casadio Tarabusi E, and Tardella L (2024+). MSmix: An R Package for clustering partial rankings via mixtures of Mallows Models with Spearman distance. <em>(submitted)</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Completion of a single partial ranking.
data_completion(rankings = c(3, NA, NA, 1, NA), reference_rho = c(4, 5, 1, 3, 2))

## Example 2. Completion of partial rankings with arbitrary censoring patterns.
data_completion(rankings = rbind(c(3, NA, NA, 7, 2, NA, NA), c(NA, 6, NA, 5, NA, NA, 1),7:1),
                reference_rho = rbind(c(4, 5, 6, 1, 3, 7, 2), 7:1, 1:7))

</code></pre>

<hr>
<h2 id='data_conversion'>Switch data format from rankings to orderings and vice versa</h2><span id='topic+data_conversion'></span>

<h3>Description</h3>

<p>Convert the format of the input dataset from rankings to orderings and vice versa. Differently from existing analogous functions supplied by other <code>R</code> packages, <code>data_conversion</code> supports also partial rankings/orderings with arbitrary patterns of censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_conversion(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data_conversion_+3A_data">data</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with partial sequences whose format has to be converted in each row. Missing entries must be coded as <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix of partial sequences with the inverse format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Switch the data format for a single complete observation.
data_conversion(c(4, 5, 1, 3, 2))

## Example 2. Switch the data format for partial sequences with arbitrary censoring patterns.
data_conversion(rbind(c(NA, 2, 5, NA, NA), c(4, NA, 2, NA, 3), c(4, 5, 1, NA, NA),
                      c(NA, NA, NA, NA, 2), c(NA, 5, 2, 1, 3), c(3, 5, 1, 2, 4)))

</code></pre>

<hr>
<h2 id='data_description'>Descriptive summaries for partial rankings</h2><span id='topic+data_description'></span><span id='topic+print.data_descr'></span>

<h3>Description</h3>

<p>Compute various data summaries for a partial ranking dataset. Differently from existing analogous functions supplied by other <code>R</code> packages, <code>data_description</code> supports partial observations with arbitrary patterns of censoring.
</p>
<p><code>print</code> method for class <code>"data_descr"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_description(
  rankings,
  marg = TRUE,
  borda_ord = FALSE,
  paired_comp = TRUE,
  subset = NULL,
  item_names = NULL
)

## S3 method for class 'data_descr'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data_description_+3A_rankings">rankings</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with partial rankings in each row. Missing positions must be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="data_description_+3A_marg">marg</code></td>
<td>
<p>Logical: whether the first-order marginals have to be computed. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="data_description_+3A_borda_ord">borda_ord</code></td>
<td>
<p>Logical: whether, in the summary statistics, the items must be ordered according to the Borda ranking (i.e., mean rank vector). Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="data_description_+3A_paired_comp">paired_comp</code></td>
<td>
<p>Logical: whether the pairwise comparison matrix has to be computed. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="data_description_+3A_subset">subset</code></td>
<td>
<p>Optional logical or integer vector specifying the subset of observations, i.e. rows of the <code>rankings</code>, to be kept. Missing values are taken as <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="data_description_+3A_item_names">item_names</code></td>
<td>
<p>Character vector for the names of the items. Defaults to <code>NULL</code>, meaning that <code>colnames(rankings)</code> is used and, if not available, <code>item_names</code> is set equal to <code>"Item1","Item2",...</code>.</p>
</td></tr>
<tr><td><code id="data_description_+3A_x">x</code></td>
<td>
<p>An object of class <code>"data_descr"</code> returned by <code><a href="#topic+data_description">data_description</a></code>.</p>
</td></tr>
<tr><td><code id="data_description_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implementation of <code>data_description</code> is similar to that of <code>rank_summaries</code> from the <code>PLMIX</code> package. Differently from the latter, <code>data_description</code> works with any kind of partial rankings (not only top rankings) and allows to summarize subsamples thanks to the additional <code>subset</code> argument.
</p>
<p>The Borda ranking, obtained from the ordering of the mean rank vector, corresponds to the MLE of the consensus ranking of the Mallow model with Spearman distance. If <code>mean_rank</code> contains some <code>NA</code>s, the corresponding items occupy the bottom positions in the <code>borda_ordering</code> according to the order they appear in <code>item_names</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"data_descr"</code>, which is a list with the following named components:
</p>
<table>
<tr><td><code>n_ranked</code></td>
<td>
<p>Integer vector of length <code class="reqn">N</code> with the number of items ranked in each partial sequence.</p>
</td></tr>
<tr><td><code>n_ranked_distr</code></td>
<td>
<p>Frequency distribution of the <code>n_ranked</code> vector.</p>
</td></tr>
<tr><td><code>n_ranks_by_item</code></td>
<td>
<p>Integer <code class="reqn">3</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the number of times that each item has been ranked or not. The last row contains the total by column, i.e. the sample size <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code>mean_rank</code></td>
<td>
<p>Mean rank vector.</p>
</td></tr>
<tr><td><code>borda_ordering</code></td>
<td>
<p>Character vector corresponding to the Borda ordering. This is obtained from the ranking of the mean rank vector.</p>
</td></tr>
<tr><td><code>marginals</code></td>
<td>
<p>Integer <code class="reqn">n</code><code class="reqn">\times</code><code class="reqn">n</code> matrix of the first-order marginals in each column: the <code class="reqn">(j,i)</code>-th entry indicates the number of times that item <code class="reqn">i</code> is ranked in position <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code>pc</code></td>
<td>
<p>Integer <code class="reqn">n</code><code class="reqn">\times</code><code class="reqn">n</code> pairwise comparison matrix: the <code class="reqn">(i,i')</code>-th entry indicates the number of times that item <code class="reqn">i</code> is preferred to item <code class="reqn">i'</code>.</p>
</td></tr>
<tr><td><code>rankings</code></td>
<td>
<p>When <code>borda_ord = TRUE</code>, an integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix corresponding to <code>rankings</code> with columns rearranged according to the Borda ordering, otherwise the input <code>rankings</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Mollica C and Tardella L (2020). PLMIX: An R package for modelling and clustering partially ranked data. <em>Journal of Statistical Computation and Simulation</em>, <b>90</b>(5), pages 925&ndash;959, ISSN: 0094-9655, DOI: 10.1080/00949655.2020.1711909.
</p>
<p>Marden JI (1995). Analyzing and modeling rank data. <em>Monographs on Statistics and Applied Probability</em> (64). Chapman &amp; Hall, ISSN: 0-412-99521-2. London.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.data_descr">plot.data_descr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Sample statistics for the Antifragility dataset.
descr &lt;- data_description(rankings = ranks_antifragility)
descr

## Example 2. Sample statistics for the Sports dataset.
r_sports &lt;- ranks_sports[, 1:8]
descr &lt;- data_description(rankings = r_sports, borda_ord = TRUE)
descr

## Example 3. Sample statistics for the Sports dataset by gender.
r_sports &lt;- ranks_sports[, 1:8]
desc_f &lt;- data_description(rankings = r_sports, subset = (ranks_sports$Gender == "Female"))
desc_m &lt;- data_description(rankings = r_sports, subset = (ranks_sports$Gender == "Male"))
desc_f
desc_m

</code></pre>

<hr>
<h2 id='expected_spear_dist'>Expectation of the Spearman distance</h2><span id='topic+expected_spear_dist'></span>

<h3>Description</h3>

<p>Compute (either the exact or the approximate) (log-)expectation of the Spearman distance under the Mallow model with Spearman distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expected_spear_dist(theta, n_items, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expected_spear_dist_+3A_theta">theta</code></td>
<td>
<p>Non-negative precision parameter.</p>
</td></tr>
<tr><td><code id="expected_spear_dist_+3A_n_items">n_items</code></td>
<td>
<p>Number of items.</p>
</td></tr>
<tr><td><code id="expected_spear_dist_+3A_log">log</code></td>
<td>
<p>Logical: whether the expected Spearman distance on the log scale must be returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code class="reqn">n\leq 20</code>, the expectation is exactly computed by relying on the Spearman distance distribution provided by OEIS Foundation Inc. (2023). When <code class="reqn">n&gt;20</code>, it is approximated with the method introduced by Crispino et al. (2023).
</p>
<p>The expected Spearman distance is independent of the consensus ranking of the Mallow model with Spearman distance due to the right-invariance of the metric. When <code class="reqn">\theta=0</code>, this is equal to <code class="reqn">\frac{n^3-n}{6}</code>, which is the expectation of the Spearman distance under the uniform (null) model.
</p>


<h3>Value</h3>

<p>Either the exact or the approximate (log-)expected value of the Spearman distance under the Mallow model with Spearman distance.
</p>


<h3>References</h3>

<p>Crispino M, Mollica C, Astuti V and Tardella L (2023). Efficient and accurate inference for mixtures of Mallows models with Spearman distance. <em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>
<p>OEIS Foundation Inc. (2023). The On-Line Encyclopedia of Integer Sequences, Published electronically at <a href="https://oeis.org">https://oeis.org</a>.
</p>
<p>Kendall MG (1970). Rank correlation methods. 4th ed. Griffin London.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spear_dist_distr">spear_dist_distr</a></code>, <code><a href="#topic+partition_fun_spear">partition_fun_spear</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Expected Spearman distance under the uniform (null) model, coinciding with (n^3-n)/6.
n_items &lt;- 10
expected_spear_dist(theta = 0, n_items = n_items, log = FALSE)
(n_items^3-n_items)/6

## Example 2. Expected Spearman distance.
expected_spear_dist(theta = 0.5, n_items = 10, log = FALSE)

## Example 3. Log-expected Spearman distance as a function of theta.
expected_spear_dist_vec &lt;- Vectorize(expected_spear_dist, vectorize.args = "theta")
curve(suppressMessages(expected_spear_dist_vec(x, n_items = 10)),
  from = 0, to = 0.1, lwd = 2, col = 2, ylim = c(3, 5.5),
  xlab = expression(theta), ylab = expression(log(E[theta](D))),
  main = "Log-expected Spearman distance")

## Example 4. Log-expected Spearman distance for varying number of items
# and values of the concentration parameter.
expected_spear_dist_vec &lt;- Vectorize(expected_spear_dist, vectorize.args = "theta")
curve(suppressMessages(expected_spear_dist_vec(x, n_items = 10)),
  from = 0, to = 0.1, lwd = 2, col = 2, ylim = c(3, 9),
  xlab = expression(theta), ylab = expression(log(E[theta](D))),
  main = "Log-expected Spearman distance")
curve(suppressMessages(expected_spear_dist_vec(x, n_items = 20)), add = TRUE, col = 3, lwd = 2)
curve(suppressMessages(expected_spear_dist_vec(x, n_items = 30)), add = TRUE, col = 4, lwd = 2)
legend("topright", legend = c(expression(n == 10), expression(n == 20), expression(n == 30)),
  col = 2:4, lwd = 2, bty = "n")

</code></pre>

<hr>
<h2 id='fitMSmix'>MLE of mixtures of Mallows models with Spearman distance via EM algorithms</h2><span id='topic+fitMSmix'></span><span id='topic+print.emMSmix'></span>

<h3>Description</h3>

<p>Perform the MLE of mixtures of Mallows model with Spearman distance on full and partial rankings via EM algorithms.
Partial rankings with arbitrary missing positions are supported.
</p>
<p><code>print</code> method for class <code>"emMSmix"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitMSmix(
  rankings,
  n_clust = 1,
  n_start = 1,
  n_iter = 200,
  mc_em = FALSE,
  eps = 10^(-6),
  plot_log_lik = FALSE,
  init = list(list(rho = NULL, theta = NULL, weights = NULL))[rep(1, n_start)],
  plot_log_lik_part = FALSE,
  parallel = FALSE,
  theta_max = 3,
  tune_theta = 1,
  subset = NULL,
  item_names = NULL
)

## S3 method for class 'emMSmix'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitMSmix_+3A_rankings">rankings</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with partial rankings in each row. Missing positions must be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_n_clust">n_clust</code></td>
<td>
<p>Number of mixture components. Defaults to 1.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_n_start">n_start</code></td>
<td>
<p>Number of starting points. Defaults to 1.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_n_iter">n_iter</code></td>
<td>
<p>Maximum number of EM iterations. Defaults to 200.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_mc_em">mc_em</code></td>
<td>
<p>Logical: whether the Monte Carlo EM algorithm must be used for MLE on partial rankings completion, see Details. Ignored when <code>rankings</code> does not contain any partial sequence. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_eps">eps</code></td>
<td>
<p>Positive tolerance value for the convergence of the EM algorithm. Defaults to <code class="reqn">10^{-6}</code>.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_plot_log_lik">plot_log_lik</code></td>
<td>
<p>Logical: whether the iterative log-likelihood values (based on full or augmented rankings) must be plotted. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_init">init</code></td>
<td>
<p>List of <code>n_start</code> lists with the starting values of the parameters to initialize the EM algorithm. Each list must contain three named objects, namely: 1) <code>rho</code>: integer <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the component-specific consensus rankings in each row; 2) <code>theta</code>: numeric vector of <code class="reqn">G</code> non-negative component-specific precision parameters; 3) <code>weights</code>: numeric vector of <code class="reqn">G</code> positive mixture weights. Defaults to <code>NULL</code>, meaning that the starting points are automatically generated from the uniform distribution.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_plot_log_lik_part">plot_log_lik_part</code></td>
<td>
<p>Logical: whether the iterative observed-data log-likelihood values (based on partial rankings) must be plotted. Ignored when <code>rankings</code> does not contain any partial sequence or <code><a href="#topic+data_augmentation">data_augmentation</a></code> cannot be applied. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_parallel">parallel</code></td>
<td>
<p>Logical: whether parallelization over multiple initializations must be used. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_theta_max">theta_max</code></td>
<td>
<p>Positive upper bound for the precision parameters. Defaults to 3.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_tune_theta">tune_theta</code></td>
<td>
<p>Positive tuning constant affecting the precision parameters in the Monte Carlo step. Ignored when <code>rankings</code> does not contain any partial sequence or <code>mc_em = FALSE</code>. Defaults to 1.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_subset">subset</code></td>
<td>
<p>Optional logical or integer vector specifying the subset of observations, i.e. rows of the <code>rankings</code>, to be kept. Missing values are taken as <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_item_names">item_names</code></td>
<td>
<p>Character vector for the names of the items. Defaults to <code>NULL</code>, meaning that <code>colnames(rankings)</code> is used and, if not available, <code>item_names</code> is set equal to <code>"Item1","Item2",...</code>.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_x">x</code></td>
<td>
<p>An object of class <code>"emMSmix"</code> returned by <code>fitMSmix</code>.</p>
</td></tr>
<tr><td><code id="fitMSmix_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The EM algorithms are launched from <code>n_start</code> initializations and the best solution in terms of maximized
log-likelihood value (based on full or augmented rankings) is returned.
</p>
<p>When <code>mc_em = FALSE</code>, the scheme introduced by Crispino et al. (2023) is performed, where partial
rankings are augmented with all compatible full rankings. This type of data augmentation is
supported up to 10 missing positions in the partial rankings.
</p>
<p>When <code>mc_em = TRUE</code>. the - computationally more efficient - Monte Carlo EM algorithm
introduced by Crispino et al. (2024+) is implemented. In the case of a large number
of censored positions and sample sizes, the <code>mc_em = TRUE</code> must be preferred.
</p>


<h3>Value</h3>

<p>An object of class <code>"emMSmix"</code>, namely a list with the following named components:
</p>

<dl>
<dt><code>mod</code></dt><dd><p>List of named objects describing the best fitted model in terms of maximized log-likelihood over the <code>n_start</code> initializations. See Details.</p>
</dd>
<dt><code>max_log_lik</code></dt><dd><p>Maximized log-likelihood values for each initialization.</p>
</dd>
<dt><code>partial_data</code></dt><dd><p>Logical: whether the dataset includes some partially-ranked sequences.</p>
</dd>
<dt><code>convergence</code></dt><dd><p>Binary convergence indicators of the EM algorithm for each initialization: 1 = convergence has been achieved, 0 = otherwise.</p>
</dd>
<dt><code>record</code></dt><dd><p>Best log-likelihood values sequentially achieved over the <code>n_start</code> initializations.</p>
</dd>
</dl>

<p>The <code>mod</code> sublist contains the following named objects:
</p>

<dl>
<dt><code>rho</code></dt><dd><p>Integer <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the MLEs of the component-specific consensus rankings in each row.</p>
</dd>
<dt><code>theta</code></dt><dd><p>Numeric vector with the MLEs of the <code class="reqn">G</code> component-specific precision parameters.</p>
</dd>
<dt><code>weights</code></dt><dd><p>Numeric vector with the MLEs of the <code class="reqn">G</code> mixture weights.</p>
</dd>
<dt><code>z_hat</code></dt><dd><p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">G</code> matrix of the estimated posterior component membership probabilities. Returned when <code>n_clust &gt; 1</code>, otherwise <code>NULL</code>.</p>
</dd>
<dt><code>map_classification</code></dt><dd><p>Integer vector of <code class="reqn">N</code> mixture component memberships based on the MAP allocation from the <code>z_hat</code> matrix. Returned when <code>n_clust &gt; 1</code>, otherwise <code>NULL</code>.</p>
</dd>
<dt><code>log_lik</code></dt><dd><p>Numeric vector of the log-likelihood values (based on full or augmented rankings) at each iteration.</p>
</dd>
<dt><code>max_log_lik_part</code></dt><dd><p>Observed-data log-likelihood value (based on partial rankings) of the fitted model. Returned when <code>rankings</code> contains some partial sequences that can be completed with <code>data_augmentation</code>, otherwise <code>NULL</code>. See Details.</p>
</dd>
<dt><code>bic</code></dt><dd><p>BIC value of the fitted model.</p>
</dd>
<dt><code>bic_part</code></dt><dd><p>BIC value of the fitted model based on <code>max_log_lik_part</code>. Returned when <code>rankings</code> contains some partial sequences that can be completed with <code><a href="#topic+data_augmentation">data_augmentation</a></code>, otherwise <code>NULL</code>. See Details.</p>
</dd>
<dt><code>conv</code></dt><dd><p>Binary convergence indicator: 1 = convergence has been achieved, 0 = otherwise.</p>
</dd>
<dt><code>augmented_rankings</code></dt><dd><p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with rankings completed through the Monte Carlo step in each row. Returned when <code>rankings</code> contains some partial sequences and <code>mc_em = TRUE</code>, otherwise <code>NULL</code>.</p>
</dd>
</dl>



<h3>References</h3>

<p>Crispino M, Mollica C, Modugno L, Casadio Tarabusi E, and Tardella L (2024+). MSmix: An R Package for clustering partial rankings via mixtures of Mallows Models with Spearman distance. <em>(submitted)</em>
</p>
<p>Crispino M, Mollica C, Astuti V and Tardella L (2023). Efficient and accurate inference for mixtures of Mallows models with Spearman distance. <em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>
<p>SÃ¸rensen Ã˜, Crispino M, Liu Q and Vitelli V (2020). BayesMallows: An R Package for the Bayesian Mallows Model. <em>The R Journal</em>, <b>12</b>(1), pages 324&ndash;342, DOI: 10.32614/RJ-2020-026.
</p>
<p>Beckett LA (1993). Maximum likelihood estimation in Mallowsâ€™s model using partially ranked data. In <em>Probability models and statistical analyses for ranking data</em>, pages 92&ndash;107. Springer New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.emMSmix">summary.emMSmix</a></code>, <code><a href="#topic+plot.emMSmix">plot.emMSmix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1. Fit the 3-component mixture of Mallow models with Spearman distance
## to the Antifragility dataset.
set.seed(123)
mms_fit &lt;- fitMSmix(rankings = ranks_antifragility, n_clust = 3, n_start = 10)
mms_fit$mod$rho; mms_fit$mod$theta; mms_fit$mod$weights

## Example 2. Fit the Mallow model with Spearman distance
## to simulated partial rankings through data augmentation
rank_data &lt;- rbind(c(NA, 4, NA, 1, NA), c(NA, NA, NA, NA, 1), c(2, NA, 1, NA, 3),
                   c(4, 2, 3, 5, 1), c(NA, 4, 1, 3, 2))
mms_fit &lt;- fitMSmix(rankings = rank_data, n_start = 10)
mms_fit$mod$rho; mms_fit$mod$theta

## Example 3. Fit the Mallow model with Spearman distance
## to the Reading genres dataset through Monte Carlo EM.
top5_read &lt;- ranks_read_genres[, 1:11]
mms_fit &lt;- fitMSmix(rankings = top5_read, n_start = 10, mc_em = TRUE)
mms_fit$mod$rho; mms_fit$mod$theta

</code></pre>

<hr>
<h2 id='likMSmix'>(Log-)likelihood for mixtures of Mallows models with Spearman distance</h2><span id='topic+likMSmix'></span>

<h3>Description</h3>

<p>Compute the (log-)likelihood for the parameters of a mixture of Mallow models with Spearman distance on partial rankings.
Partial rankings with arbitrary missing positions are supported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likMSmix(
  rho,
  theta,
  weights = (if (length(theta) == 1) NULL),
  rankings,
  log = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="likMSmix_+3A_rho">rho</code></td>
<td>
<p>Integer <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the component-specific consensus rankings in each row.</p>
</td></tr>
<tr><td><code id="likMSmix_+3A_theta">theta</code></td>
<td>
<p>Numeric vector of <code class="reqn">G</code> non-negative component-specific precision parameters.</p>
</td></tr>
<tr><td><code id="likMSmix_+3A_weights">weights</code></td>
<td>
<p>Numeric vector of <code class="reqn">G</code> positive mixture weights (normalization is not necessary).</p>
</td></tr>
<tr><td><code id="likMSmix_+3A_rankings">rankings</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with partial rankings in each row. Missing positions must be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="likMSmix_+3A_log">log</code></td>
<td>
<p>Logical: whether the log-likelihood must be returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The (log-)likelihood evaluation is performed by augmenting the partial rankings with the set of all compatible full rankings (see <code><a href="#topic+data_augmentation">data_augmentation</a></code>), and then the marginal likelihood is computed.
</p>
<p>When <code class="reqn">n\leq 20</code>, the (log-)likelihood is exactly computed. When <code class="reqn">n&gt;20</code>, the model normalizing constant is not available and the (log-)likelihood is approximated with the method introduced by Crispino et al. (2023).
</p>


<h3>Value</h3>

<p>The (log)-likelihood value.
</p>


<h3>References</h3>

<p>Crispino M, Mollica C, Modugno L, Casadio Tarabusi E, and Tardella L (2024+). MSmix: An R Package for clustering partial rankings via mixtures of Mallows Models with Spearman distance. <em>(submitted)</em>
</p>
<p>Crispino M, Mollica C, Astuti V and Tardella L (2023). Efficient and accurate inference for mixtures of Mallows models with Spearman distance. <em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bicMSmix">bicMSmix</a></code>, <code><a href="#topic+aicMSmix">aicMSmix</a></code>, <code><a href="#topic+data_augmentation">data_augmentation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Likelihood of a full ranking of n=5 items under the uniform (null) model.
likMSmix(rho = 1:5, theta = 0, weights = 1, rankings = c(3,5,2,1,4), log = FALSE)
# corresponds to...
1/factorial(5)

## Example 2. Simulate rankings from a 2-component mixture of Mallow models with Spearman distance.
set.seed(12345)
d_sim &lt;- rMSmix(sample_size = 75, n_items = 8, n_clust = 2)
str(d_sim)
# Fit the true model.
rankings &lt;- d_sim$samples
fit &lt;- fitMSmix(rankings = rankings, n_clust = 2, n_start = 10)
# Compare log-likelihood values of the true parameter values and the MLE.
likMSmix(rho = d_sim$rho, theta = d_sim$theta, weights = d_sim$weights,
       rankings = d_sim$samples)
likMSmix(rho = fit$mod$rho, theta = fit$mod$theta, weights = fit$mod$weights,
       rankings = d_sim$samples)

## Example 3. Simulate rankings from a basic Mallow model with Spearman distance.
set.seed(12345)
d_sim &lt;- rMSmix(sample_size = 25, n_items = 6)
str(d_sim)
# Censor data to be partial top-3 rankings.
rankings &lt;- d_sim$samples
rankings[rankings&gt;3] &lt;- NA
# Fit the true model with data augmentation.
set.seed(12345)
fit &lt;- fitMSmix(rankings = rankings, n_clust = 1, n_start = 10)
# Compare log-likelihood values of the true parameter values and the MLEs.
likMSmix(rho = d_sim$rho, theta = d_sim$theta, weights = d_sim$weights,
       rankings = d_sim$samples)
likMSmix(rho = fit$mod$rho, theta = fit$mod$theta, weights = fit$mod$weights,
       rankings = d_sim$samples)

</code></pre>

<hr>
<h2 id='MSmix-package'>Finite Mixtures of Mallows Models with Spearman Distance for Full and Partial Rankings</h2><span id='topic+MSmix-package'></span><span id='topic+MSmix'></span>

<h3>Description</h3>

<p>The <span class="pkg">MSmix</span> package provides functions to fit and analyze finite
Mixtures of Mallows models with Spearman distance (a.k.a. <code class="reqn">\theta</code>-model)
for full and partial rankings with arbitrary missing positions.
Inference is conducted within the maximum likelihood (ML) framework via EM algorithms.
Estimation uncertainty is tackled via diverse versions of bootstrapping
as well as via Hessian-based standard errors calculations.
</p>


<h3>Details</h3>

<p>The <em>Mallows model</em> is one of the most popular and frequently applied
parametric distributions to analyze rankings of a finite set of items.
However, inference for this model is challenging due to the intractability
of the normalizing constant, also referred to as <em>partition function</em>.
The present package performs ML estimation (MLE) of the Mallows model with Spearman distance
from full and partial rankings with arbitrary censoring patterns.
Thanks to the novel approximation of the model normalizing constant introduced by
Crispino, Mollica, Astuti and Tardella (2023), as well as the existence of
a closed-form expression of the MLE of the consensus ranking, <span class="pkg">MSmix</span> can address inference
even for a large number of items (currently the upper limit is <code class="reqn">n\leq 170</code>).
The package also allows to account for unobserved sample heterogeneity through MLE of
<em>finite mixtures of Mallows models with Spearman distance</em> via EM algorithms, in order to
perform a model-based clustering of partial rankings into groups with similar preferences.
</p>
<p>Computational efficiency is achieved with the use of a hybrid language, combining <code>R</code> and <code>C++</code> code,
and the possibility of parallel computation.
</p>
<p>In addition to inferential techniques, the package provides various
functions for data manipulation, simulation, descriptive summary and model selection.
</p>
<p>Specific S3 classes and methods are also supplied to enhance the usability
and foster exchange with other packages.
</p>
<p>The suite of functions available in the <span class="pkg">MSmix</span> package is composed of:
</p>
<p><strong>Ranking data manipulation</strong>
</p>

<dl>
<dt><code><a href="#topic+data_conversion">data_conversion</a></code></dt><dd><p>From rankings to orderings and vice versa.</p>
</dd>
<dt><code><a href="#topic+data_completion">data_completion</a></code></dt><dd><p>Deterministic completion of partial rankings
with full reference rankings.</p>
</dd>
<dt><code><a href="#topic+data_augmentation">data_augmentation</a></code></dt><dd><p>Generate all full rankings compatible with
partial rankings.</p>
</dd>
</dl>

<p><strong>Ranking data simulation</strong>
</p>

<dl>
<dt><code><a href="#topic+rMSmix">rMSmix</a></code></dt><dd><p>Random samples from finite mixtures of Mallows models
with Spearman distance.</p>
</dd>
</dl>

<p><strong>Ranking data description</strong>
</p>

<dl>
<dt><code><a href="#topic+data_description">data_description</a></code></dt><dd><p>Descriptive summaries for partial rankings.</p>
</dd>
</dl>

<p><strong>Model estimation</strong>
</p>

<dl>
<dt><code><a href="#topic+fitMSmix">fitMSmix</a></code></dt><dd><p>MLE of mixtures of Mallows models with Spearman distance via EM algorithms.</p>
</dd>
<dt><code><a href="#topic+likMSmix">likMSmix</a></code></dt><dd><p>Likelihood evaluation for mixtures of Mallows models with Spearman distance.</p>
</dd>
</dl>

<p><strong>Model selection</strong>
</p>

<dl>
<dt><code><a href="#topic+bicMSmix">bicMSmix</a></code></dt><dd><p>BIC value for the fitted mixture of Mallows models with Spearman distance.</p>
</dd>
<dt><code><a href="#topic+aicMSmix">aicMSmix</a></code></dt><dd><p>AIC value for the fitted mixture of Mallows models with Spearman distance.</p>
</dd>
</dl>

<p><strong>Estimation uncertainty</strong>
</p>

<dl>
<dt><code><a href="#topic+bootstrapMSmix">bootstrapMSmix</a></code></dt><dd><p>Bootstrap confidence intervals for mixtures of Mallows models with Spearman distance.</p>
</dd>
<dt><code><a href="#topic+confintMSmix">confintMSmix</a></code></dt><dd><p>Hessian-based confidence intervals for mixtures of Mallows models with Spearman distance.</p>
</dd>
</dl>

<p><strong>Spearman distance utilities</strong>
</p>

<dl>
<dt><code><a href="#topic+spear_dist">spear_dist</a></code></dt><dd><p>Spearman distance computation for full rankings.</p>
</dd>
<dt><code><a href="#topic+spear_dist_distr">spear_dist_distr</a></code></dt><dd><p>Spearman distance distribution
under the uniform (null) model.</p>
</dd>
<dt><code><a href="#topic+partition_fun_spear">partition_fun_spear</a></code></dt><dd><p>Partition function of the Mallows model with Spearman distance.</p>
</dd>
<dt><code><a href="#topic+expected_spear_dist">expected_spear_dist</a></code></dt><dd><p>Expected Spearman distance under the Mallows model with Spearman distance.</p>
</dd>
<dt><code><a href="#topic+var_spear_dist">var_spear_dist</a></code></dt><dd><p>Variance of the Spearman distance under the Mallows model with Spearman distance.</p>
</dd>
</dl>

<p><strong>S3 class methods</strong> </p>

<dl>
<dt><code><a href="#topic+plot.emMSmix">plot.emMSmix</a></code></dt><dd><p>Plot the MLEs of mixtures of Mallows models with Spearman distance.</p>
</dd>
<dt><code><a href="#topic+summary.emMSmix">summary.emMSmix</a></code></dt><dd><p>Summary of the MLEs of mixtures of Mallows models with Spearman distance.</p>
</dd>
<dt><code><a href="#topic+plot.data_descr">plot.data_descr</a></code></dt><dd><p>Plot the descriptive statistics for partial rankings.</p>
</dd>
<dt><code><a href="#topic+plot.dist">plot.dist</a></code></dt><dd><p>Plot the Spearman distance matrix for full rankings.</p>
</dd>
</dl>

<p><strong>Datasets</strong>
</p>

<dl>
<dt><code><a href="#topic+ranks_antifragility">ranks_antifragility</a></code></dt><dd><p>Antifragility features of innovative startups (full rankings).</p>
</dd>
<dt><code><a href="#topic+ranks_beers">ranks_beers</a></code></dt><dd><p>Beer preference data (partial missing at random rankings with covariate).</p>
</dd>
<dt><code><a href="#topic+ranks_read_genres">ranks_read_genres</a></code></dt><dd><p>Reading preference data (partial top-5 rankings with covariates).</p>
</dd>
<dt><code><a href="#topic+ranks_sports">ranks_sports</a></code></dt><dd><p>Sport preferences and habits (full rankings with covariates).</p>
</dd>
</dl>

<p>Some quantities frequently recalled in the
manual are the following:
</p>

<dl>
<dt><code class="reqn">N</code></dt><dd><p>Sample size.</p>
</dd>
<dt><code class="reqn">n</code></dt><dd><p>Number of possible items.</p>
</dd>
<dt><code class="reqn">G</code></dt><dd><p>Number of mixture components.</p>
</dd>
</dl>

<p>Data must be supplied as an integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with partial rankings in each row and missing positions denoted as NA (rank = 1 indicates the
most-liked item). Partial sequences with a single missing entry are
automatically filled in, as they correspond to full rankings. In the present setting, ties are not allowed.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica, Marta Crispino, Lucia Modugno and Luca Tardella
</p>
<p>Maintainer: Cristina Mollica &lt;<a href="mailto:cristina.mollica@uniroma1.it">cristina.mollica@uniroma1.it</a>&gt;
</p>


<h3>References</h3>

<p>Crispino M, Mollica C, Astuti V and Tardella L (2023). Efficient
and accurate inference for mixtures of Mallows models with Spearman distance.
<em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>
<p>Crispino M, Mollica C, Modugno L, Casadio Tarabusi E, and
Tardella L (2024+). MSmix: An R Package for clustering partial rankings
via mixtures of Mallows models with Spearman distance. <em>(submitted)</em>.
</p>

<hr>
<h2 id='partition_fun_spear'>Partition function of the Mallows model with Spearman distance</h2><span id='topic+partition_fun_spear'></span>

<h3>Description</h3>

<p>Compute (either the exact or the approximate) (log-)partition function of the Mallow model with Spearman distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partition_fun_spear(theta, n_items, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partition_fun_spear_+3A_theta">theta</code></td>
<td>
<p>Non-negative precision parameter.</p>
</td></tr>
<tr><td><code id="partition_fun_spear_+3A_n_items">n_items</code></td>
<td>
<p>Number of items.</p>
</td></tr>
<tr><td><code id="partition_fun_spear_+3A_log">log</code></td>
<td>
<p>Logical: whether the partition function on the log scale must be returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code class="reqn">n\leq 20</code>, the partition is exactly computed by relying on the Spearman distance distribution provided by OEIS Foundation Inc. (2023). When <code class="reqn">n&gt;20</code>, it is approximated with the method introduced by Crispino et al. (2023).
</p>
<p>The partition function is independent of the consensus ranking of the Mallow model with Spearman distance due to the right-invariance of the metric. When <code class="reqn">\theta=0</code>, the partition function is equivalent to <code class="reqn">n!</code>, which is the normalizing constant of the uniform (null) model.
</p>


<h3>Value</h3>

<p>Either the exact or the approximate (log-)partition function of the Mallow model with Spearman distance.
</p>


<h3>References</h3>

<p>Crispino M, Mollica C, Astuti V and Tardella L (2023). Efficient and accurate inference for mixtures of Mallows models with Spearman distance. <em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>
<p>OEIS Foundation Inc. (2023). The On-Line Encyclopedia of Integer Sequences, Published electronically at <a href="https://oeis.org">https://oeis.org</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spear_dist_distr">spear_dist_distr</a></code>, <code><a href="#topic+expected_spear_dist">expected_spear_dist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Partition function of the uniform (null) model, coinciding with n!.
partition_fun_spear(theta = 0, n_items = 10, log = FALSE)
factorial(10)

## Example 2. Partition function of the Mallow model with Spearman distance.
partition_fun_spear(theta = 0.5, n_items = 10, log = FALSE)

## Example 3. Log-partition function of the Mallow model with Spearman distance
## as a function of theta.
partition_fun_spear_vec &lt;- Vectorize(partition_fun_spear, vectorize.args = "theta")
curve(suppressMessages(partition_fun_spear_vec(x, n_items = 10)), from = 0, to = 0.1, lwd = 2,
  xlab = expression(theta), ylab = expression(log(Z(theta))),
  main = "Log-partition function of the Mallow model with Spearman distance",
  ylim = c(7, log(factorial(10))))

## Example 4. Log-partition function of the Mallow model with Spearman distance
## for varying number of items
# and values of the concentration parameter.
partition_fun_spear_vec &lt;- Vectorize(partition_fun_spear, vectorize.args = "theta")
curve(suppressMessages(partition_fun_spear_vec(x, n_items = 10)),
  from = 0, to = 0.1, lwd = 2, col = 2,
  xlab = expression(theta), ylab = expression(log(Z(theta))),
  main = "Log-partition function of the Mallow model with Spearman distance",
  ylim = c(0, log(factorial(30))))
curve(suppressMessages(partition_fun_spear_vec(x, n_items = 20)), add = TRUE, col = 3, lwd = 2)
curve(suppressMessages(partition_fun_spear_vec(x, n_items = 30)), add = TRUE, col = 4, lwd = 2)
legend("topright", legend = c(expression(n == 10), expression(n == 20), expression(n == 30)),
  col = 2:4, lwd = 2, bty = "n")

</code></pre>

<hr>
<h2 id='plot.data_descr'>Plot descriptive statistics for partial rankings</h2><span id='topic+plot.data_descr'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>"data_descr"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data_descr'
plot(
  x,
  cex_text_mean = 1,
  cex_symb_mean = 12,
  cex_text_pc = 3,
  cex_range_pc = c(8, 20),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.data_descr_+3A_x">x</code></td>
<td>
<p>An object of class <code>"data_descr"</code> returned by <code><a href="#topic+data_description">data_description</a></code>.</p>
</td></tr>
<tr><td><code id="plot.data_descr_+3A_cex_text_mean">cex_text_mean</code></td>
<td>
<p>Positive scalar: the magnification to be used for all the labels in the plot for the mean rank vector. Defaults to 1.</p>
</td></tr>
<tr><td><code id="plot.data_descr_+3A_cex_symb_mean">cex_symb_mean</code></td>
<td>
<p>Positive scalar: the magnification to be used for the symbols in the pictogram of the mean rank vector. Defaults to 12.</p>
</td></tr>
<tr><td><code id="plot.data_descr_+3A_cex_text_pc">cex_text_pc</code></td>
<td>
<p>Positive scalar: the magnification to be used for all the labels in the bubble plot of the paired comparison frequencies. Defaults to 3.</p>
</td></tr>
<tr><td><code id="plot.data_descr_+3A_cex_range_pc">cex_range_pc</code></td>
<td>
<p>Numeric vector indicating the range of values to be used on each axis in the bubble plot of the paired comparison frequencies. Defaults to <code>c(8,20)</code>.</p>
</td></tr>
<tr><td><code id="plot.data_descr_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produce 5 plots to display descriptive summaries of the partial ranking dataset, namely: i) a barplot of the frequency distribution (%) of the number of ranked items (i.e., the length of the partial sequences), ii) a basic pictogram of the mean rank vector, iii) a heatmap of the first-order marginals, iv) the ecdf of the marginal rank distributions and v) a bubble plot of the pairwise comparison matrix.
</p>


<h3>References</h3>

<p>Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data_description">data_description</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Plot sample statistics for the Antifragility dataset.
desc &lt;- data_description(ranks_antifragility)
plot(desc)

## Example 2. Plot sample statistics for the Sports dataset.
r_sports &lt;- ranks_sports[, 1:8]
desc &lt;- data_description(rankings = r_sports, borda_ord = TRUE)
plot(desc, cex_text_mean = 1.2)

## Example 3. Plot sample statistics for the Sports dataset by gender.
r_sports &lt;- ranks_sports[, 1:8]
desc_f &lt;- data_description(rankings = r_sports, subset = (ranks_sports$Gender == "Female"))
plot(desc_f, cex_text_mean = 1.2)
desc_m &lt;- data_description(rankings = r_sports, subset = (ranks_sports$Gender == "Male"))
plot(desc_m, cex_text_mean = 1.2)


</code></pre>

<hr>
<h2 id='plot.dist'>Plot the Spearman distance matrix</h2><span id='topic+plot.dist'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>"dist"</code>. It is useful to preliminary explore the presence of patterns (groups) of similar preferences in the ranking dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist'
plot(
  x,
  order = TRUE,
  show_labels = TRUE,
  lab_size = 3,
  gradient = list(low = "#00AFBB", mid = "white", high = "#FC4E07"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dist_+3A_x">x</code></td>
<td>
<p>An object of class <code>"dist"</code>, returned by <code>spear_dist</code> when setting the argument <code>rho = NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.dist_+3A_order">order</code></td>
<td>
<p>Logical: whether the rows of the distance matrix must be ordered. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.dist_+3A_show_labels">show_labels</code></td>
<td>
<p>Logical: whether the labels must be displayed on the axes. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.dist_+3A_lab_size">lab_size</code></td>
<td>
<p>Positive scalar: the magnification of the labels on the axes. Defaults to 3.</p>
</td></tr>
<tr><td><code id="plot.dist_+3A_gradient">gradient</code></td>
<td>
<p>List of three elements with the colors for low, mid and high values of the distances in the heatmap. The element <code>mid</code> can take the value of NULL.</p>
</td></tr>
<tr><td><code id="plot.dist_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It can take a few seconds if the size of the distance matrix is large.
</p>
<p>The heatmap can be also obtained by setting the arguments <code>rho = NULL</code> and <code>plot_dist_mat = TRUE</code> when applying <code><a href="#topic+spear_dist">spear_dist</a></code>.
</p>


<h3>Value</h3>

<p>Produce a heatmap of the Spearman distance matrix between all pairs of full rankings.
</p>


<h3>References</h3>

<p>Alboukadel K and Mundt F (2020). factoextra: Extract and Visualize the Results of Multivariate Data Analyses. R package version 1.0.7. <a href="https://CRAN.R-project.org/package=factoextra">https://CRAN.R-project.org/package=factoextra</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spear_dist">spear_dist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Plot the Spearman distance matrix of the Antifragility ranking dataset.
dist_mat &lt;- spear_dist(rankings = ranks_antifragility)
plot(dist_mat, show_labels = FALSE)

## Example 2. Plot the Spearman distance matrix of the Sports ranking dataset.
n &lt;- 8
dist_mat &lt;- spear_dist(rankings = ranks_sports[, 1:n])
plot(dist_mat, show_labels = FALSE)
# Plot the Spearman distance matrix for the subsample of males.
dist_m &lt;- spear_dist(rankings = ranks_sports[, 1:n], subset = ranks_sports$Gender == "Male")
plot(dist_m)


</code></pre>

<hr>
<h2 id='plot.emMSmix'>Plot the MLEs for the fitted mixture of Mallows models with Spearman distance</h2><span id='topic+plot.emMSmix'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>"emMSmix"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emMSmix'
plot(x, max_scale_w = 20, mar_lr = 0.4, mar_tb = 0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.emMSmix_+3A_x">x</code></td>
<td>
<p>An object of class <code>"emMSmix"</code> returned by <code>fitMSmix</code>.</p>
</td></tr>
<tr><td><code id="plot.emMSmix_+3A_max_scale_w">max_scale_w</code></td>
<td>
<p>Positive scalar: maximum magnification of the dots in the bump plot, set proportional to the MLEs of the weights. Defaults to 20.</p>
</td></tr>
<tr><td><code id="plot.emMSmix_+3A_mar_lr">mar_lr</code></td>
<td>
<p>Numeric: margin for the left and right side of the plot. Defaults to 0.4.</p>
</td></tr>
<tr><td><code id="plot.emMSmix_+3A_mar_tb">mar_tb</code></td>
<td>
<p>Numeric: margin for the bottom and top side of the plot. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="plot.emMSmix_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produce a bump plot to compare the component-specific consensus rankings of the fitted mixture of Mallow models with Spearman distance. The size of the dots of each consensus ranking is proportional to the weight of the corresponding component. When <code>n_clust &gt; 1</code>, It also returns a heatmap of the estimated coponent membership probabilities.
</p>


<h3>References</h3>

<p>Sjoberg D (2020). ggbump: Bump Chart and Sigmoid Curves. R package version 0.1.10. <a href="https://CRAN.R-project.org/package=ggbump">https://CRAN.R-project.org/package=ggbump</a>.
</p>
<p>Wickham H et al. (2019). Welcome to the tidyverse. <em>Journal of Open Source Software</em>, <b>4</b>(43), 1686, DOI: 10.21105/joss.01686.
</p>
<p>Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitMSmix">fitMSmix</a></code>, <code><a href="#topic+summary.emMSmix">summary.emMSmix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1. Fit a 3-component mixture of Mallow models with Spearman distance
## to the Antifragility dataset.
set.seed(123)
mms_fit &lt;- fitMSmix(rankings = ranks_antifragility, n_clust = 3, n_start = 10)
plot(mms_fit)


</code></pre>

<hr>
<h2 id='ranks_antifragility'>Antifragility Data (complete rankings)</h2><span id='topic+ranks_antifragility'></span>

<h3>Description</h3>

<p>The Antifragility dataset came up from an on-line survey conducted during spring 2021 by Sapienza University of Rome in collaboration with the Italian incubator Digital Magics, to investigate the construct of antifragility in innovative startups. Antifragility reflects the capacity of a firm/organization/company to adapt and improve its activity in the case of stresses, volatility and disorders triggered by critical and unexpected events, such as the COVID-19 outbreak which motivated the survey. On the basis of their experience and knowledge, a sample of <code class="reqn">N=99</code> startups provided their complete rankings of <code class="reqn">n=7</code> desirable antifragility properties in order of importance. The antifragility features are: 1 = Absorption, 2 = Redundancy, 3 = Small stressors, 4 = Non-monotonicity, 5 = Requisite variety, 6 = Emergence and 7 = Uncoupling.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ranks_antifragility)</code></pre>


<h3>Format</h3>

<p>A data frame gathering <code class="reqn">N=99</code> complete rankings of the <code class="reqn">n=7</code> antifragility features in each row (rank 1 = most preferred item). The definition of the antifragility aspects is detailed below:
</p>

<dl>
<dt>Absorption</dt><dd><p>Ability to absorb stress and shocks while remaining in the planned state.</p>
</dd>
<dt>Redundancy</dt><dd><p>Overcapacity to defend from risks and prevent faults.</p>
</dd>
<dt>Small_stressors</dt><dd><p>Ability to exert low levels of stress on the organization.</p>
</dd>
<dt>Non_monotonicity</dt><dd><p>Capacity to learn from failures and errors.</p>
</dd>
<dt>Requisite_variety</dt><dd><p>Need for regulatory agents (i.e., government agency) to monitor and control organizationâ€™s outcomes and behaviors.</p>
</dd>
<dt>Emergence</dt><dd><p>Existence of cause-effect relationships between organizationâ€™s activity at micro level and its outcomes at macro level.</p>
</dd>
<dt>Uncoupling</dt><dd><p>Existence of strong interconnection between agents inside and outside the organization.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ghasemi A and Alizadeh M (2017). Evaluating organizational antifragility via fuzzy logic. The case of an Iranian company producing banknotes and security paper. <em>Operations research and decisions</em>, <b>27</b>(2), pages 21&ndash;43, DOI: 10.5277/ord170202.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(ranks_antifragility)
head(ranks_antifragility)
</code></pre>

<hr>
<h2 id='ranks_beers'>Beers Data (partial rankings with covariate)</h2><span id='topic+ranks_beers'></span>

<h3>Description</h3>

<p>The Beers dataset was collected through an on-line survey on beer preferences administrated to the participants of the 2018 Pint of Science festival held in Grenoble. A sample of <code class="reqn">N=105</code> respondents provided their partial rankings of <code class="reqn">n=20</code> beers according to their personal preferences. The dataset also includes a covariate concerning respondents' residence.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ranks_beers)</code></pre>


<h3>Format</h3>

<p>A data frame gathering <code class="reqn">N=105</code> partial rankings of the beers in the first <code class="reqn">n=20</code> columns (rank 1 = most preferred item) and an individual covariate in the last column. Partial rankings have missing at random positions coded as <code>NA</code>. The variables are detailed below:
</p>

<dl>
<dt>Stella_Artois</dt><dd><p>Rank assigned to Stella Artois.</p>
</dd>
<dt>Kwak_Brasserie</dt><dd><p>Rank assigned to Kwak Brasserie.</p>
</dd>
<dt>Kronenbourg_Kronenbourg</dt><dd><p>Rank assigned to Kronenbourg (Kronenbourg).</p>
</dd>
<dt>Faro_Timmermans</dt><dd><p>Rank assigned to Faro Timmermans.</p>
</dd>
<dt>Kronenbourg_1664</dt><dd><p>Rank assigned to 1664 (Kronenbourg).</p>
</dd>
<dt>Chimay_Triple</dt><dd><p>Rank assigned to Chimay Triple.</p>
</dd>
<dt>Pelforth_Brune</dt><dd><p>Rank assigned to Pelforth Brune.</p>
</dd>
<dt>Kronenbourg_Carlsberg</dt><dd><p>Rank assigned to Carlsberg (Kronenbourg).</p>
</dd>
<dt>Kronenbourg_Kanterbraeu</dt><dd><p>Rank assigned to Kanterbraeu (Kronenbourg).</p>
</dd>
<dt>Hoegaarden_Blanche</dt><dd><p>Rank assigned to Hoegaarden Blanche.</p>
</dd>
<dt>Grimbergen_Blonde</dt><dd><p>Rank assigned to Grimbergen Blonde.</p>
</dd>
<dt>Pietra_Brasserie</dt><dd><p>Rank assigned to Pietra Brasserie.</p>
</dd>
<dt>Affligem_Brasserie</dt><dd><p>Rank assigned to Affligem Brasserie.</p>
</dd>
<dt>La_Goudale</dt><dd><p>Rank assigned to La Goudale.</p>
</dd>
<dt>Leffe_Blonde</dt><dd><p>Rank assigned to Leffe Blonde.</p>
</dd>
<dt>Heineken</dt><dd><p>Rank assigned to Heineken.</p>
</dd>
<dt>Duvel_Brasserie</dt><dd><p>Rank assigned to Duvel Brasserie.</p>
</dd>
<dt>La_Choulette</dt><dd><p>Rank assigned to La Choulette.</p>
</dd>
<dt>Orval</dt><dd><p>Rank assigned to Orval.</p>
</dd>
<dt>Karmeliet_Triple</dt><dd><p>Rank assigned to Karmeliet Triple.</p>
</dd>
<dt>Residence</dt><dd><p>Residence.</p>
</dd>
</dl>



<h3>References</h3>

<p>Crispino M (2018). On-line questionnaire of the 2018 <em>Pint of Science festival</em> in Grenoble available at <a href="https://docs.google.com/forms/d/1TiOIyc-jFXZF2Hb9echxZL0ZOcmr95LIBIieQuI-UJc/viewform?ts=5ac3a382&amp;edit_requested=true">https://docs.google.com/forms/d/1TiOIyc-jFXZF2Hb9echxZL0ZOcmr95LIBIieQuI-UJc/viewform?ts=5ac3a382&amp;edit_requested=true</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(ranks_beers)
head(ranks_beers)
</code></pre>

<hr>
<h2 id='ranks_read_genres'>Reading Genres Data (partial rankings with covariates)</h2><span id='topic+ranks_read_genres'></span>

<h3>Description</h3>

<p>The Reading Genres dataset was collected through an on-line survey conducted in Italy to investigate reading preferences in the context of the 2019 project <em>Patto per la lettura â€“ Conta chi legge</em>. The questionnaire was administrated by the municipality of Latina (Latium, Italy), in collaboration with Sapienza University of Rome and the School of Government of the University of Tor Vergata. A sample of <code class="reqn">N=507</code> respondents provided their partial top-5 rankings of <code class="reqn">n=11</code> reading genres according to their personal preferences. The reading genres are: 1 = Classic, 2 = Novel, 3 = Thriller, 4 = Fantasy, 5 = Biography, 6 = Teenage, 7 = Horror, 8 = Comics, 9 = Poetry, 10 = Essay and 11 = Humor. The dataset also includes several covariates concerning respondents' socio-demographics characteristics and other free time activities.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ranks_read_genres)</code></pre>


<h3>Format</h3>

<p>A data frame gathering <code class="reqn">N=507</code> partial top-5 rankings of the reading genres in the first <code class="reqn">n=11</code> columns (rank 1 = most preferred item) and individual covariates in the remaining columns. Missing positions are coded as <code>NA</code>. The variables are detailed below:
</p>

<dl>
<dt>Classic</dt><dd><p>Rank assigned to Classic.</p>
</dd>
<dt>Novel</dt><dd><p>Rank assigned to Novel.</p>
</dd>
<dt>Thriller</dt><dd><p>Rank assigned to Thriller.</p>
</dd>
<dt>Fantasy</dt><dd><p>Rank assigned to Fantasy.</p>
</dd>
<dt>Biography</dt><dd><p>Rank assigned to Biography.</p>
</dd>
<dt>Teenage</dt><dd><p>Rank assigned to Teenage.</p>
</dd>
<dt>Horror</dt><dd><p>Rank assigned to Horror.</p>
</dd>
<dt>Comics</dt><dd><p>Rank assigned to Comics.</p>
</dd>
<dt>Poetry</dt><dd><p>Rank assigned to Poetry.</p>
</dd>
<dt>Essay</dt><dd><p>Rank assigned to Essay.</p>
</dd>
<dt>Humor</dt><dd><p>Rank assigned to Humor.</p>
</dd>
<dt>Gender</dt><dd><p>Gender.</p>
</dd>
<dt>Region</dt><dd><p>Italian region of residence.</p>
</dd>
<dt>Age</dt><dd><p>Age (years).</p>
</dd>
<dt>N_children</dt><dd><p>Number of children.</p>
</dd>
<dt>Education</dt><dd><p>Education level.</p>
</dd>
<dt>Final_mark</dt><dd><p>Final grade of the education degree, scaled in the interval [6,10].</p>
</dd>
<dt>N_books</dt><dd><p>Number of books read in the last 12 months.</p>
</dd>
</dl>



<h3>References</h3>

<p>Crispino M, Mollica C, Astuti V and Tardella L (2023). Efficient and accurate inference for mixtures of Mallows models with Spearman distance. <em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>
<p>Mollica (2019). On-line questionnaire of the Italian 2019 project <em>Patto per la lettura â€“ Conta chi legge</em> available at <a href="https://form.jotformeu.com/90275118835359">https://form.jotformeu.com/90275118835359</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(ranks_read_genres)
head(ranks_read_genres)
</code></pre>

<hr>
<h2 id='ranks_sports'>Sports Data (complete rankings with covariates)</h2><span id='topic+ranks_sports'></span>

<h3>Description</h3>

<p>The Sports dataset was collected through an on-line questionnaire on sport preferences and habits administered within the 2016 Big Data Analystics in Sports (BDsports) project, developed by the Big and Open Data Innovation Laboratory (BODaI-Lab) of the University of Brescia. A sample of <code class="reqn">N=647</code> respondents provided their complete rankings of <code class="reqn">n=8</code> popular sports according to their personal preferences. The sports are:
1 = Soccer, 2 = Swimming, 3 = Volleyball, 4 = Cycling, 5 = Basket, 6 = Boxe and martial arts, 7 = Tennis and 8 = Jogging. The dataset also includes several covariates concerning respondents' socio-demographics characteristics and other sport-related information.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ranks_sports)</code></pre>


<h3>Format</h3>

<p>A data frame gathering <code class="reqn">N=647</code> complete rankings of the sports in the first <code class="reqn">n=8</code> columns (rank 1 = most preferred item) and individual covariates in the remaining columns. The variables are detailed below:
</p>

<dl>
<dt>Soccer</dt><dd><p>Rank assigned to Soccer.</p>
</dd>
<dt>Swimming</dt><dd><p>Rank assigned to Swimming.</p>
</dd>
<dt>Volleyball</dt><dd><p>Rank assigned to Volleyball.</p>
</dd>
<dt>Cycling</dt><dd><p>Rank assigned to Cycling.</p>
</dd>
<dt>Basket</dt><dd><p>Rank assigned to Basket.</p>
</dd>
<dt>Boxe_and_martial_arts</dt><dd><p>Rank assigned to Boxe and Martial Arts.</p>
</dd>
<dt>Tennis</dt><dd><p>Rank assigned to Tennis.</p>
</dd>
<dt>Jogging</dt><dd><p>Rank assigned to Jogging.</p>
</dd>
<dt>Gender</dt><dd><p>Gender.</p>
</dd>
<dt>Birth_month</dt><dd><p>Month of birth.</p>
</dd>
<dt>Birth_year</dt><dd><p>Year of birth.</p>
</dd>
<dt>Education</dt><dd><p>Education level.</p>
</dd>
<dt>Residence</dt><dd><p>Geographical area of residence.</p>
</dd>
<dt>Work</dt><dd><p>Type of work.</p>
</dd>
<dt>Smoking</dt><dd><p>Smoking status.</p>
</dd>
<dt>Sport_frequency</dt><dd><p>Number of times per week that the respondent plays sports.</p>
</dd>
<dt>Sport_hours</dt><dd><p>Number of hours per week that the respondent watches sports.</p>
</dd>
<dt>Sport_played</dt><dd><p>Sport played by the respondent.</p>
</dd>
<dt>Personality</dt><dd><p>Main aspect of respondent's personality.</p>
</dd>
<dt>Sport_motivation</dt><dd><p>Main reason why the respondent plays sport.</p>
</dd>
<dt>Sport_type</dt><dd><p>Favorite sport type.</p>
</dd>
<dt>Sport_relationships</dt><dd><p>Do you think that sport, especially in team games, allows you to make new friends?</p>
</dd>
<dt>Water</dt><dd><p>Quantity of water consumed per day.</p>
</dd>
<dt>Alcohol</dt><dd><p>Frequency of alcohol consumption.</p>
</dd>
<dt>Fastfood</dt><dd><p>Frequency of fast food consumption.</p>
</dd>
<dt>Food_supplements</dt><dd><p>Opinion about the use of food supplements in sports.</p>
</dd>
<dt>Massmedia</dt><dd><p>Prevalent mass media used to inquire about sport.</p>
</dd>
<dt>TV_space</dt><dd><p>Do you think that sport currently occupies the space it deserves on TV? Rating from 1=definitely not to 7=definitely yes with 4=indifferent.</p>
</dd>
<dt>Magazine_space</dt><dd><p>Do you think that sport currently occupies the space it deserves on the magazines? Rating from 1=definitely not to 7=definitely yes with 4=indifferent.</p>
</dd>
<dt>Radio_space</dt><dd><p>Do you think that sport currently occupies the space it deserves on the radio? Rating from 1=definitely not to 7=definitely yes with 4=indifferent.</p>
</dd>
<dt>Internet_space</dt><dd><p>Do you think that sport currently occupies the space it deserves on internet? Rating from 1=definitely not to 7=definitely yes with 4=indifferent.</p>
</dd>
<dt>Paid_channels</dt><dd><p>Do you think it is right that some sports are only accessible on paid channels? Rating from 1=definitely not to 7=definitely yes with 4=indifferent.</p>
</dd>
<dt>Subscriptions</dt><dd><p>Any past or current subscription to a sport magazine/channel.</p>
</dd>
<dt>Psycol_well_being</dt><dd><p>Do you think that practicing sports affects psychological well-being? Rating from 1=definitely not to 7=definitely yes with 4=indifferent.</p>
</dd>
<dt>Physical_well_being</dt><dd><p>Do you think that practicing sports affects physical well-being? Rating from 1=definitely not to 7=definitely yes with 4=indifferent.</p>
</dd>
<dt>Sport_nutrition</dt><dd><p>Do you think nutrition affects sport? Rating from 1=definitely not to 7=definitely yes with 4=indifferent.</p>
</dd>
<dt>Overall_health</dt><dd><p>Do you think that practicing sports affects health? Rating from 1=definitely not to 7=definitely yes with 4=indifferent.</p>
</dd>
<dt>Stress</dt><dd><p>Self-reported stress level on a scale between 0 and 100.</p>
</dd>
<dt>Economic_status</dt><dd><p>Level of satisfaction for one's own economic status: 0=not at all, 1=a little bit, 2=enough, 3=satisfied, 4=a lot. It is the only covariate with some <code>NA</code>'s.</p>
</dd>
</dl>



<h3>References</h3>

<p>Simone, R., Cappelli, C. and Di Iorio, F., (2019). Modelling marginal ranking distributions: the uncertainty tree. <em>Pattern Recognition Letters</em>, <b>125</b>, pages 278&ndash;288, DOI: 10.1016/j.patrec.2019.04.026.
</p>
<p>Simone, R. and Iannario, M., (2018). Analysing sport data with clusters of opposite preferences. <em>Statistical Modelling</em>, <b>18</b>(5-6), pages 505&ndash;524, DOI: 10.1177/1471082X18798455.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(ranks_sports)
head(ranks_sports)
</code></pre>

<hr>
<h2 id='rMSmix'>Random samples from a mixture of Mallows models with Spearman distance</h2><span id='topic+rMSmix'></span>

<h3>Description</h3>

<p>Draw random samples of full rankings from a mixture of Mallow models with Spearman distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rMSmix(
  sample_size = 1,
  n_items,
  n_clust = 1,
  rho = NULL,
  theta = NULL,
  weights = NULL,
  uniform = FALSE,
  mh = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rMSmix_+3A_sample_size">sample_size</code></td>
<td>
<p>Number of full rankings to be sampled. Defaults to 1.</p>
</td></tr>
<tr><td><code id="rMSmix_+3A_n_items">n_items</code></td>
<td>
<p>Number of items.</p>
</td></tr>
<tr><td><code id="rMSmix_+3A_n_clust">n_clust</code></td>
<td>
<p>Number of mixture components. Defaults to 1.</p>
</td></tr>
<tr><td><code id="rMSmix_+3A_rho">rho</code></td>
<td>
<p>Integer <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the component-specific consensus rankings in each row. Defaults to <code>NULL</code>, meaning that the consensus rankings are randomly generated according to the sampling scheme indicated by the <code>uniform</code> argument. See Details.</p>
</td></tr>
<tr><td><code id="rMSmix_+3A_theta">theta</code></td>
<td>
<p>Numeric vector of <code class="reqn">G</code> non-negative component-specific precision parameters. Defaults to <code>NULL</code>, meaning that the concentrations are uniformly generated from an interval containing typical values for the precisions. See Details.</p>
</td></tr>
<tr><td><code id="rMSmix_+3A_weights">weights</code></td>
<td>
<p>Numeric vector of <code class="reqn">G</code> positive mixture weights (normalization is not necessary). Defaults to <code>NULL</code>, meaning that the mixture weights are randomly generated according to the sampling scheme indicated by the <code>uniform</code> argument. See Details.</p>
</td></tr>
<tr><td><code id="rMSmix_+3A_uniform">uniform</code></td>
<td>
<p>Logical: whether <code>rho</code> or <code>weights</code> have to be sampled uniformly on their support. When <code>uniform = FALSE</code> they are sampled, respectively, to ensure separation among mixture components and populated weights. Used when <code class="reqn">G&gt;1</code> and either <code>rho</code> or <code>weights</code> are <code>NULL</code> (see Details). Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="rMSmix_+3A_mh">mh</code></td>
<td>
<p>Logical: whether the samples must be drawn with the Metropolis-Hastings (MH) scheme implemented in the <code>BayesMallows</code> package, rather by direct sampling from the Mallows probability distribution. For <code>n_items &gt; 10</code>, the MH is always applied to speed up the sampling procedure. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>n_items &gt; 10</code> or <code>mh = TRUE</code>, the random samples are obtained by using the Metropolis-Hastings algorithm, described in Vitelli et al. (2018) and implemented in the <code>sample_mallows</code> function of the package <code>BayesMallows</code> package.
</p>
<p>When <code>theta = NULL</code> is not provided by the user, the concentration parameters are randomly generated from a uniform distribution on the interval <code class="reqn">(1/n^{2},3/n^{1.5})</code> of some typical values for the precisions.
</p>
<p>When <code>uniform = FALSE</code>, the mixing weights are sampled from a symmetric Dirichlet distribution with shape parameters all equal to <code class="reqn">2G</code>, to favor populated and balanced clusters;
the consensus parameters are sampled to favor well-separated clusters, i. e.,  at least at Spearman distance <code class="reqn">\frac{2}{G}\binom{n+1}{3}</code> from each other.
</p>


<h3>Value</h3>

<p>A list of the following named components:
</p>
<table>
<tr><td><code>samples</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the <code>sample_size</code> simulated full rankings in each row.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>Integer <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with the component-specific consensus rankings used for the simulation in each row.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Numeric vector of the <code class="reqn">G</code> component-specific precision parameters used for the simulation.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>Numeric vector of the <code class="reqn">G</code> mixture weights used for the simulation.</p>
</td></tr>
<tr><td><code>classification</code></td>
<td>
<p>Integer vector of the <code>sample_size</code> component membership labels.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Vitelli V, SÃ¸rensen Ã˜, Crispino M, Frigessi A and Arjas E (2018). Probabilistic Preference Learning with the Mallows Rank Model. <em>Journal of Machine Learning Research</em>, <b>18</b>(158), pages 1&ndash;49, ISSN: 1532-4435, <a href="https://jmlr.org/papers/v18/15-481.html">https://jmlr.org/papers/v18/15-481.html</a>.
</p>
<p>SÃ¸rensen Ã˜, Crispino M, Liu Q and Vitelli V (2020). BayesMallows: An R Package for the Bayesian Mallows Model. <em>The R Journal</em>, <b>12</b>(1), pages 324&ndash;342, DOI: 10.32614/RJ-2020-026.
</p>
<p>Chenyang Zhong (2021). Mallows permutation model with L1 and L2 distances I: hit and run algorithms and mixing times. arXiv: 2112.13456.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Drawing from a mixture with randomly generated parameters of separated clusters.
set.seed(12345)
rMSmix(sample_size = 50, n_items = 25, n_clust = 5)


## Example 2. Drawing from a mixture with uniformly generated parameters.
set.seed(12345)
rMSmix(sample_size = 100, n_items = 9, n_clust = 3, uniform = TRUE)


## Example 3.  Drawing from a mixture with customized parameters.
r_par &lt;- rbind(1:5, c(4, 5, 2, 1, 3))
t_par &lt;- c(0.01, 0.02)
w_par &lt;- c(0.4, 0.6)
set.seed(12345)
rMSmix(sample_size = 50, n_items = 5, n_clust = 2, theta = t_par, rho = r_par, weights = w_par)

</code></pre>

<hr>
<h2 id='spear_dist'>Spearman distance</h2><span id='topic+spear_dist'></span>

<h3>Description</h3>

<p>Compute either the Spearman distance between each row of a full ranking matrix and a reference complete ranking, or the Spearman distance matrix between the rows of a full ranking matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spear_dist(
  rankings,
  rho = NULL,
  subset = NULL,
  diag = FALSE,
  upper = FALSE,
  plot_dist_mat = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spear_dist_+3A_rankings">rankings</code></td>
<td>
<p>Integer <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">n</code> matrix with full rankings in each row.</p>
</td></tr>
<tr><td><code id="spear_dist_+3A_rho">rho</code></td>
<td>
<p>An optional full ranking whose Spearman distance from each row of <code>rankings</code> must be computed. Defaults to <code>NULL</code>, meaning that the Spearman distance matrix between all pairs of rows in <code>rankings</code> must be computed.</p>
</td></tr>
<tr><td><code id="spear_dist_+3A_subset">subset</code></td>
<td>
<p>Optional logical or integer vector specifying the subset of observations, i.e. rows of the <code>rankings</code>, to be kept. Missing values are taken as <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="spear_dist_+3A_diag">diag</code></td>
<td>
<p>Logical: whether the diagonal of the Spearman distance matrix must be returned. Used when <code>rho = NULL</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="spear_dist_+3A_upper">upper</code></td>
<td>
<p>Logical: whether the upper triangle of the Spearman distance matrix must be printed. Used when <code>rho = NULL</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="spear_dist_+3A_plot_dist_mat">plot_dist_mat</code></td>
<td>
<p>Logical: whether the Spearman distance matrix must be plotted. Used when <code>rho = NULL</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>rho = NULL</code>, <code>spear_dist</code> recalls the <code><a href="stats.html#topic+dist">dist</a></code> function from the <code>base</code> package to compute the squared Euclidian distance between full rankings; otherwise, it recalls the <code>compute_rank_distance</code> routine of the <code>BayesMallows</code> package, which implements several metrics for rankings.
</p>


<h3>Value</h3>

<p>When <code>rho = NULL</code>, an object of class <code>"dist"</code> corresponding to the Spearman distance matrix; otherwise, a vector with the Spearman distances between each row in <code>rankings</code> and <code>rho</code>.
</p>


<h3>References</h3>

<p>SÃ¸rensen Ã˜, Crispino M, Liu Q and Vitelli V (2020). BayesMallows: An R Package for the Bayesian Mallows Model. <em>The R Journal</em>, <b>12</b>(1), pages 324&ndash;342, DOI: 10.32614/RJ-2020-026.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.dist">plot.dist</a></code>, <code><a href="BayesMallows.html#topic+compute_rank_distance">compute_rank_distance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Spearman distance between two full rankings.
spear_dist(rankings = c(4, 8, 6, 9, 2, 11, 3, 5, 1, 12, 7, 10), rho = 1:12)

## Example 2. Spearman distance between the Antifragility ranking dataset and the Borda ranking.
borda &lt;- rank(data_description(rankings = ranks_antifragility)$mean_rank)
spear_dist(rankings = ranks_antifragility, rho = borda)

## Example 3. Spearman distance matrix of the Sports ranking dataset.
n &lt;- 8
dist_mat &lt;- spear_dist(rankings = ranks_sports[, 1:n])
dist_mat
# Spearman distance matrix for the subsample of females.
dist_f &lt;- spear_dist(rankings = ranks_sports[, 1:n], subset = ranks_sports$Gender == "Female")
dist_f

</code></pre>

<hr>
<h2 id='spear_dist_distr'>Spearman distance distribution under the uniform ranking model</h2><span id='topic+spear_dist_distr'></span>

<h3>Description</h3>

<p>Provide (either the exact or the approximate) frequency distribution of the Spearman distance under the uniform (null) ranking model. Currently, it works for <code class="reqn">n\leq 170</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spear_dist_distr(n_items, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spear_dist_distr_+3A_n_items">n_items</code></td>
<td>
<p>Number of items.</p>
</td></tr>
<tr><td><code id="spear_dist_distr_+3A_log">log</code></td>
<td>
<p>Logical: whether the frequencies must be reported on the log scale. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code class="reqn">n\leq 20</code>, the exact distribution provided by OEIS Foundation Inc. (2023) is returned by relying on a call to the <code>get_cardinalities</code> routine of the <code>BayesMallows</code> package.
</p>
<p>When <code class="reqn">20&lt;n\leq 170</code>, the approximate distribution introduced by Crispino et al. (2023) is returned.
</p>


<h3>Value</h3>

<p>A list of two named objects:
</p>
<table>
<tr><td><code>distances</code></td>
<td>
<p>All the possible Spearman distance values (i.e., the support of the distribution).</p>
</td></tr>
<tr><td><code>logcard</code></td>
<td>
<p>(Log)-frequencies corresponding to each value in <code>distances</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>OEIS Foundation Inc. (2023). The On-Line Encyclopedia of Integer Sequences, Published electronically at <a href="https://oeis.org">https://oeis.org</a>.
</p>
<p>Crispino M, Mollica C, Astuti V and Tardella L (2023). Efficient and accurate inference for mixtures of Mallows models with Spearman distance. <em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>
<p>SÃ¸rensen Ã˜, Crispino M, Liu Q and Vitelli V (2020). BayesMallows: An R Package for the Bayesian Mallows Model. <em>The R Journal</em>, <b>12</b>(1), pages 324&ndash;342, DOI: 10.32614/RJ-2020-026.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spear_dist">spear_dist</a></code>, <code><a href="#topic+expected_spear_dist">expected_spear_dist</a></code>, <code><a href="#topic+partition_fun_spear">partition_fun_spear</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Exact Spearman distance distribution for n=20 items.
distr &lt;- spear_dist_distr(n_items = 20, log = FALSE)
plot(distr$distances,distr$logcard,type='h',ylab = 'probability',xlab='d',
main='distribution of the spearman distance under the null model')


## Example 2. Approximate Spearman distance distribution for n=50 items with log-frequencies.
distr &lt;- spear_dist_distr(n_items = 50)
plot(distr$distances,distr$logcard,type='h',ylab = 'log-probability',xlab='d',
    main='log-distribution of the spearman distance under the null model')

</code></pre>

<hr>
<h2 id='summary.emMSmix'>Summary of the fitted mixture of Mallows models with Spearman distance</h2><span id='topic+summary.emMSmix'></span><span id='topic+print.summary.emMSmix'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>"emMSmix"</code>.
</p>
<p><code>print</code> method for class <code>"summary.emMSmix"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emMSmix'
summary(object, digits = 3, ...)

## S3 method for class 'summary.emMSmix'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.emMSmix_+3A_object">object</code></td>
<td>
<p>An object of class <code>"emMSmix"</code> returned by <code>fitMSmix</code>.</p>
</td></tr>
<tr><td><code id="summary.emMSmix_+3A_digits">digits</code></td>
<td>
<p>Integer: decimal places for rounding the numerical summaries. Defaults to 3.</p>
</td></tr>
<tr><td><code id="summary.emMSmix_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
<tr><td><code id="summary.emMSmix_+3A_x">x</code></td>
<td>
<p>An object of class <code>"summary.emMSmix"</code> returned by <code>summary.emMSmix</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following named components:
</p>
<table>
<tr><td><code>modal_rankings</code></td>
<td>
<p>Integer matrix with the MLEs of the <code class="reqn">G</code> component-specific consensus rankings in each row.</p>
</td></tr>
<tr><td><code>modal_orderings</code></td>
<td>
<p>Character matrix with the MLEs of the <code class="reqn">G</code> component-specific consensus orderings in each row.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Numeric vector of the MLEs of the <code class="reqn">G</code> precisions.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>Numeric vector of the MLEs of the <code class="reqn">G</code> mixture weights.</p>
</td></tr>
<tr><td><code>MAP_distr</code></td>
<td>
<p>Relative frequency distribution of the component memberships based on the MAP allocation.</p>
</td></tr>
<tr><td><code>conv_perc</code></td>
<td>
<p>Percentage of convergence of the EM algorithm over the multiple starting points.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC value (based on full or augmented rankings).</p>
</td></tr>
<tr><td><code>BIC_part</code></td>
<td>
<p>BIC value (based on partial rankings).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+fitMSmix">fitMSmix</a></code>, <code><a href="#topic+plot.emMSmix">plot.emMSmix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1. Fit and summary of a 3-component mixture of Mallow models with Spearman distance
## for the Antifragility dataset.
set.seed(123)
mms_fit &lt;- fitMSmix(rankings = ranks_antifragility, n_clust = 3, n_start = 10)
summary(mms_fit)


</code></pre>

<hr>
<h2 id='var_spear_dist'>Variance of the Spearman distance</h2><span id='topic+var_spear_dist'></span>

<h3>Description</h3>

<p>Compute (either the exact or the approximate) (log-)variance of the Spearman distance under the Mallow model with Spearman distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_spear_dist(theta, n_items, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var_spear_dist_+3A_theta">theta</code></td>
<td>
<p>Non-negative precision parameter.</p>
</td></tr>
<tr><td><code id="var_spear_dist_+3A_n_items">n_items</code></td>
<td>
<p>Number of items.</p>
</td></tr>
<tr><td><code id="var_spear_dist_+3A_log">log</code></td>
<td>
<p>Logical: whether the expected Spearman distance on the log scale must be returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code class="reqn">n\leq 20</code>, the variance is exactly computed by relying on the Spearman distance distribution
provided by OEIS Foundation Inc. (2023).
When <code class="reqn">n&gt;20</code>, it is approximated with the method introduced by Crispino et al. (2023).
</p>
<p>The variance of the Spearman distance is independent of the consensus ranking of the Mallow model with Spearman distance due to the right-invariance
of the metric.
When <code class="reqn">\theta=0</code>, this is equal to <code class="reqn">\frac{n^2(n-1)(n+1)^2}{36}</code>, which is the variance of the Spearman
distance under the uniform (null) model.
</p>


<h3>Value</h3>

<p>Either the exact or the approximate (log-)variance of the Spearman distance under the Mallow model with Spearman distance.
</p>


<h3>References</h3>

<p>Crispino M., Mollica C., Astuti V. and Tardella L. (2023). Efficient and accurate inference for mixtures of Mallows models with Spearman distance. <em>Statistics and Computing</em>, <b>33</b>(98), DOI: 10.1007/s11222-023-10266-8.
</p>
<p>OEIS Foundation Inc. (2023). The On-Line Encyclopedia of Integer Sequences, Published electronically at <a href="https://oeis.org">https://oeis.org</a>
</p>
<p>Kendall, M. G. (1970). Rank correlation methods. 4th ed. Griffin London.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1. Variance of the Spearman distance under the uniform (null) model,
## coinciding with n^2(n-1)(n+1)^2/36.
n_items &lt;- 10
var_spear_dist(theta = 0, n_items= n_items, log = FALSE)
n_items^2*(n_items-1)*(n_items+1)^2/36

## Example 2. Variance of the Spearman distance.
var_spear_dist(theta = 0.5, n_items = 10, log = FALSE)

## Example 3. Log-variance of the Spearman distance as a function of theta.
var_spear_dist_vec &lt;- Vectorize(var_spear_dist, vectorize.args = "theta")
curve(suppressMessages(var_spear_dist_vec(x, n_items = 10)),
  from = 0, to = 0.1, lwd = 2, col = 2,
  xlab = expression(theta), ylab = expression(log(V[theta](D))),
  main = "Log-variance of the Spearman distance")

## Example 4. Log--variance of the Spearman distance for varying number of items
# and values of the concentration parameter.
var_spear_dist_vec &lt;- Vectorize(var_spear_dist, vectorize.args = "theta")
curve(suppressMessages(var_spear_dist_vec(x, n_items = 10)),
  from = 0, to = 0.1, lwd = 2, col = 2, ylim = c(5, 14),
  xlab = expression(theta), ylab = expression(log(V[theta](D))),
  main = "Log-variance of the Spearman distance")
curve(suppressMessages(var_spear_dist_vec(x, n_items = 20)), add = TRUE, col = 3, lwd = 2)
curve(suppressMessages(var_spear_dist_vec(x, n_items = 30)), add = TRUE, col = 4, lwd = 2)
legend("topright", legend = c(expression(n == 10), expression(n == 20), expression(n == 30)),
  col = 2:4, lwd = 2, bty = "n")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
