<!DOCTYPE html><html><head><title>Help for package cIRT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cIRT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#center_matrix'><p>Center a Matrix</p></a></li>
<li><a href='#choice_matrix'><p>Choice Matrix Data</p></a></li>
<li><a href='#cIRT'><p>Generic Implementation of Choice IRT MCMC</p></a></li>
<li><a href='#cIRT-package'><p>cIRT: Choice Item Response Theory</p></a></li>
<li><a href='#direct_sum'><p>Direct Sum of Matrices</p></a></li>
<li><a href='#Generate_Choice'><p>Generate Observed Data from choice model</p></a></li>
<li><a href='#payout_matrix'><p>Payout Matrix Data</p></a></li>
<li><a href='#probitHLM'><p>Probit Hierarchical Level Model</p></a></li>
<li><a href='#riwishart'><p>Generate Random Inverse Wishart Distribution</p></a></li>
<li><a href='#rmvnorm'><p>Generate Random Multivariate Normal Distribution</p></a></li>
<li><a href='#rwishart'><p>Generate Random Wishart Distribution</p></a></li>
<li><a href='#survey_data'><p>Survey Data</p></a></li>
<li><a href='#Total_Tabulate'><p>Calculate Tabulated Total Scores</p></a></li>
<li><a href='#trial_matrix'><p>Trial Matrix Data</p></a></li>
<li><a href='#TwoPLChoicemcmc'><p>Two Parameter Choice IRT Model MCMC</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Choice Item Response Theory</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Jointly model the accuracy of cognitive responses and item choices
    within a Bayesian hierarchical framework as described by Culpepper and
    Balamuta (2015) &lt;<a href="https://doi.org/10.1007%2Fs11336-015-9484-7">doi:10.1007/s11336-015-9484-7</a>&gt;. In addition, the package
    contains the datasets used within the analysis of the paper.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://tmsalab.github.io/cIRT/">https://tmsalab.github.io/cIRT/</a>, <a href="https://github.com/tmsalab/cIRT">https://github.com/tmsalab/cIRT</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tmsalab/cIRT/issues">https://github.com/tmsalab/cIRT/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.8)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo (&ge; 0.10.8.1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, covr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-21 20:31:32 UTC; ronin</td>
</tr>
<tr>
<td>Author:</td>
<td>Steven Andrew Culpepper
    <a href="https://orcid.org/0000-0003-4226-6176"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cph],
  James Joseph Balamuta
    <a href="https://orcid.org/0000-0003-2826-8458"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cph,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James Joseph Balamuta &lt;balamut2@illinois.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-21 20:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='center_matrix'>Center a Matrix</h2><span id='topic+center_matrix'></span>

<h3>Description</h3>

<p>Obtains the mean of each column of the matrix and subtracts it from the
given matrix in a centering operation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>center_matrix(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="center_matrix_+3A_x">x</code></td>
<td>
<p>A <code>matrix</code> with any dimensions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The application of this function to a matrix mimics the use of a
centering matrix given by:
</p>
<p style="text-align: center;"><code class="reqn">{C_n} = {I_n} - \frac{1}{n}{11^T}</code>
</p>



<h3>Value</h3>

<p>A <code>matrix</code> with the same dimensions of X that has been centered.
</p>


<h3>Author(s)</h3>

<p>James Joseph Balamuta
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cIRT">cIRT()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nobs = 500
nvars = 20
x = matrix(rnorm(nobs * nvars), nrow = nobs, ncol = nvars) 
r_centered = scale(x) 
arma_centered1 = center_matrix(x)
</code></pre>

<hr>
<h2 id='choice_matrix'>Choice Matrix Data</h2><span id='topic+choice_matrix'></span>

<h3>Description</h3>

<p>This data set contains the subject's choices and point values for the
difficult questions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choice_matrix
</code></pre>


<h3>Format</h3>

<p>A data frame with 3780 observations on the following 5 variables.
</p>

<dl>
<dt><code>subject_id</code></dt><dd><p>Research Participant Subject ID. There are 102 IDs and each ID has 15 observations.</p>
</dd>
<dt><code>hard_q_id</code></dt><dd><p>The item ID of the hard question assigned to the student (16-30)</p>
</dd>
<dt><code>easy_q_id</code></dt><dd><p>The item ID of the easy question assigned to the student (1-15)</p>
</dd>
<dt><code>choose_hard_q</code></dt><dd><p>Selected either: Difficult Question (1) or Easy Question (0)</p>
</dd>
<dt><code>high_value</code></dt><dd><p>Range of values associated with Difficult Question that span from 12 to 16, repeated three times per subject</p>
</dd>
<dt><code>low_value</code></dt><dd><p>Range of values associated with Easy Question that span from 4 to 6, repeated five times per subject</p>
</dd>
<dt><code>is_correct_choice</code></dt><dd><p>Did the user select an item that was answered correctly?</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven Andrew Culpepper and James Joseph Balamuta
</p>


<h3>Source</h3>

<p>Choice38 Experiment at UIUC during Spring 2014 - Fall 2014
</p>

<hr>
<h2 id='cIRT'>Generic Implementation of Choice IRT MCMC</h2><span id='topic+cIRT'></span>

<h3>Description</h3>

<p>Builds a model using MCMC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cIRT(
  subject_ids,
  fixed_effects,
  B_elem_plus1,
  rv_effects,
  trial_matrix,
  choices_nk,
  burnit,
  chain_length = 10000L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cIRT_+3A_subject_ids">subject_ids</code></td>
<td>
<p>A <code>vector</code> that contains subject IDs for each line of
data in the choice vector (e.g. For 1 subject that
made 5 choices, we would have the number 1 appear
five times consecutively.)</p>
</td></tr>
<tr><td><code id="cIRT_+3A_fixed_effects">fixed_effects</code></td>
<td>
<p>A <code>matrix</code> with NK x P1 dimensions that acts as the
design matrix for terms WITHOUT theta.</p>
</td></tr>
<tr><td><code id="cIRT_+3A_b_elem_plus1">B_elem_plus1</code></td>
<td>
<p>A <code>V[[1]]</code> dimensional column <code>vector</code> indicating
which zeta_i relate to theta_i.</p>
</td></tr>
<tr><td><code id="cIRT_+3A_rv_effects">rv_effects</code></td>
<td>
<p>A <code>matrix</code> with NK x V dimensions for random effects
design matrix.</p>
</td></tr>
<tr><td><code id="cIRT_+3A_trial_matrix">trial_matrix</code></td>
<td>
<p>A <code>matrix</code> with N x J dimensions, where J denotes the
number of items presented. The matrix MUST contain
only 1's and 0's.</p>
</td></tr>
<tr><td><code id="cIRT_+3A_choices_nk">choices_nk</code></td>
<td>
<p>A <code>vector</code> with NK length that contains the choice
value e.g. 0 or 1.</p>
</td></tr>
<tr><td><code id="cIRT_+3A_burnit">burnit</code></td>
<td>
<p>An <code>int</code> that describes how many MCMC draws should be
discarded.</p>
</td></tr>
<tr><td><code id="cIRT_+3A_chain_length">chain_length</code></td>
<td>
<p>An <code>int</code> that controls how many MCMC draws there are.
(&gt; 0)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> that contains:
</p>

<dl>
<dt><code>as</code></dt><dd><p>A <code>matrix</code> of dimension chain_length x J</p>
</dd>
<dt><code>bs</code></dt><dd><p>A <code>matrix</code> of dimension chain_length x J</p>
</dd>
<dt><code>gs</code></dt><dd><p>A <code>matrix</code> of dimension chain_length x P_1</p>
</dd>
<dt><code>Sigma_zeta_inv</code></dt><dd><p>An <code>array</code> of dimension V x V x chain_length</p>
</dd>
<dt><code>betas</code></dt><dd><p>A <code>matrix</code> of dimension chain_length x P_2</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven Andrew Culpepper and James Joseph Balamuta
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TwoPLChoicemcmc">TwoPLChoicemcmc()</a></code>, <code><a href="#topic+probitHLM">probitHLM()</a></code>, <code><a href="#topic+center_matrix">center_matrix()</a></code>,
<code><a href="#topic+rmvnorm">rmvnorm()</a></code>, <code><a href="#topic+rwishart">rwishart()</a></code>, and <code><a href="#topic+riwishart">riwishart()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Variables
# Y = trial matix
# C = KN vector of binary choices
# N = #of subjects
# J = # of items
# K= # of choices
# atrue = true item discriminations
# btrue = true item locations
# thetatrue = true thetas/latent performance
# gamma = fixed effects coefficients
# Sig = random-effects variance-covariance
# subid = id variable for subjects

# Load the Package
library(cIRT)

# Load the Data
data(trial_matrix)
data(choice_matrix)

# Thurstone design matrices
all_nopractice = subset(all_data_trials, experiment_loop.thisN &gt; -1)
hard_items = choice_matrix$hard_q_id
easy_items = choice_matrix$easy_q_id

D_easy = model.matrix( ~ -1 + factor(easy_items))
D_hard = -1 * model.matrix( ~ -1 + factor(hard_items))[, -c(5, 10, 15)]

# Defining effect-coded contrasts
high_contrasts = rbind(-1, diag(4))
rownames(high_contrasts) = 12:16
low_contrasts = rbind(-1, diag(2))
rownames(low_contrasts) = 4:6

# Creating high &amp; low factors
high = factor(choice_matrix[, 'high_value'])
low = factor(choice_matrix[, 'low_value'])
contrasts(high) = high_contrasts
contrasts(low) = low_contrasts

fixed_effects = model.matrix( ~ high + low)
fixed_effects_base = fixed_effects[, 1]
fixed_effects_int = model.matrix( ~ high * low)


# Model with Thurstone D Matrix
system.time({
 out_model_thurstone = cIRT(
   choice_matrix[, 'subject_id'],
   cbind(fixed_effects[, -1], D_easy, D_hard),
   c(1:ncol(fixed_effects)),
   as.matrix(fixed_effects),
   as.matrix(trial_matrix),
   choice_matrix[, 'choose_hard_q'],
   20000,
   25000
 )
})


vlabels_thurstone = colnames(cbind(fixed_effects[, -1], D_easy, D_hard))
G_thurstone = t(apply(
 out_model_thurstone$gs0,
 2,
 FUN = quantile,
 probs = c(.5, .025, .975)
))

rownames(G_thurstone) = vlabels_thurstone
B_thurstone = t(apply(
 out_model_thurstone$beta,
 2,
 FUN = quantile,
 probs = c(.5, 0.025, .975)
))

rownames(B_thurstone) = colnames(fixed_effects)

S_thurstone = solve(
  apply(out_model_thurstone$Sigma_zeta_inv, c(1, 2), FUN = mean)
)

inv_sd = diag(1 / sqrt(diag(solve(
 apply(out_model_thurstone$Sigma_zeta_inv, c(1, 2),
       FUN = mean)
))))

inv_sd %*% S_thurstone %*% inv_sd
apply(out_model_thurstone$as, 2, FUN = mean)
apply(out_model_thurstone$bs, 2, FUN = mean)

## End(Not run)
</code></pre>

<hr>
<h2 id='cIRT-package'>cIRT: Choice Item Response Theory</h2><span id='topic+cIRT-package'></span><span id='topic+_PACKAGE'></span>

<h3>Description</h3>

<p>Jointly model the accuracy of cognitive responses and item choices within a Bayesian hierarchical framework as described by Culpepper and Balamuta (2015) &lt;doi:10.1007/s11336-015-9484-7&gt;. In addition, the package contains the datasets used within the analysis of the paper.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: James Joseph Balamuta <a href="mailto:balamut2@illinois.edu">balamut2@illinois.edu</a> (<a href="https://orcid.org/0000-0003-2826-8458">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Steven Andrew Culpepper <a href="mailto:sculpepp@illinois.edu">sculpepp@illinois.edu</a> (<a href="https://orcid.org/0000-0003-4226-6176">ORCID</a>) [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://tmsalab.github.io/cIRT/">https://tmsalab.github.io/cIRT/</a>
</p>
</li>
<li> <p><a href="https://github.com/tmsalab/cIRT">https://github.com/tmsalab/cIRT</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/tmsalab/cIRT/issues">https://github.com/tmsalab/cIRT/issues</a>
</p>
</li></ul>


<hr>
<h2 id='direct_sum'>Direct Sum of Matrices</h2><span id='topic+direct_sum'></span>

<h3>Description</h3>

<p>Computes the direct sum of all matrices passed in via the list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>direct_sum(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="direct_sum_+3A_x">x</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;field&lt;matrix&gt;&#8288;</code> or <code>list</code> containing matrices</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider matrix <code class="reqn">A</code> (<code class="reqn">M \times N</code>) and
<code class="reqn">B</code> (<code class="reqn">K \times P</code>). A direct sum is a diagonal matrix
<code class="reqn">A (+) B</code> with dimensions <code class="reqn">(m + k) x (n + p)</code>.
</p>


<h3>Value</h3>

<p>Matrix containing the direct sum of all matrices in the list.
</p>


<h3>Author(s)</h3>

<p>James Joseph Balamuta
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x = list(matrix(0, nrow = 5, ncol = 3),
         matrix(1, nrow = 5, ncol = 3))
direct_sum(x)

x = list(matrix(rnorm(15), nrow = 5, ncol = 3),
         matrix(rnorm(30), nrow = 5, ncol = 6),
         matrix(rnorm(18), nrow = 2, ncol = 9))
direct_sum(x)
</code></pre>

<hr>
<h2 id='Generate_Choice'>Generate Observed Data from choice model</h2><span id='topic+Generate_Choice'></span>

<h3>Description</h3>

<p>Generates observed cognitive and choice data from the IRT-Thurstone model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Generate_Choice(
  N,
  J,
  K,
  theta,
  as,
  bs,
  zeta,
  gamma,
  X,
  W,
  subject_ids,
  unique_subject_ids
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Generate_Choice_+3A_n">N</code></td>
<td>
<p>An <code>integer</code> for the number of observations.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_j">J</code></td>
<td>
<p>An <code>integer</code> for the number of items.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_k">K</code></td>
<td>
<p>An <code>integer</code> for the number of paired comparisons.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_theta">theta</code></td>
<td>
<p>A <code>vector</code> of latent cognitive variables.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_as">as</code></td>
<td>
<p>A <code>vector</code> of length J with item discriminations.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_bs">bs</code></td>
<td>
<p>A <code>vector</code> of length J with item locations.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_zeta">zeta</code></td>
<td>
<p>A <code>matrix</code> with dimensions N x V containing
random parameter estimates.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_gamma">gamma</code></td>
<td>
<p>A <code>vector</code> with dimensions P x 1 containing
fixed parameter estimates, where <code class="reqn">P = P_1 + P_2</code></p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_x">X</code></td>
<td>
<p>A <code>matrix</code> with dimensions N*K x P_1 containing
fixed effect design matrix without theta.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_w">W</code></td>
<td>
<p>A <code>matrix</code> with dimensions N*K x V containing
random effect variables.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_subject_ids">subject_ids</code></td>
<td>
<p>A <code>vector</code> with length NK x 1 containing
subject-choice IDs.</p>
</td></tr>
<tr><td><code id="Generate_Choice_+3A_unique_subject_ids">unique_subject_ids</code></td>
<td>
<p>A <code>vector</code> with length N x 1 containing
unique subject IDs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> that contains:
</p>

<dl>
<dt><code>Y</code></dt><dd><p>A <code>matrix</code> of dimension N by J</p>
</dd>
<dt><code>C</code></dt><dd><p>A <code>vector</code> of length NK</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven Andrew Culpepper and James Joseph Balamuta
</p>

<hr>
<h2 id='payout_matrix'>Payout Matrix Data</h2><span id='topic+payout_matrix'></span>

<h3>Description</h3>

<p>This data set contains the payout information for each subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>payout_matrix
</code></pre>


<h3>Format</h3>

<p>A data frame with 252 observations on the following 4 variables.
</p>

<dl>
<dt><code>Participant</code></dt><dd><p>Subject ID</p>
</dd>
<dt><code>cum_sum</code></dt><dd><p>Sum of all payouts</p>
</dd>
<dt><code>num_correct_choices</code></dt><dd><p>Total number of correct choices (out of 15)</p>
</dd>
<dt><code>num_correct_trials</code></dt><dd><p>Total number of correct trials (out of 30)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven Andrew Culpepper and James Joseph Balamuta
</p>


<h3>Source</h3>

<p>Choice38 Experiment at UIUC during Spring 2014 - Fall 2014
</p>

<hr>
<h2 id='probitHLM'>Probit Hierarchical Level Model</h2><span id='topic+probitHLM'></span>

<h3>Description</h3>

<p>Performs modeling procedure for a Probit Hierarchical Level Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probitHLM(
  unique_subject_ids,
  subject_ids,
  choices_nk,
  fixed_effects_design,
  rv_effects_design,
  B_elem_plus1,
  gamma,
  beta,
  theta,
  zeta_rv,
  WtW,
  Z_c,
  Wzeta_0,
  inv_Sigma_gamma,
  mu_gamma,
  Sigma_zeta_inv,
  S0,
  mu_beta,
  sigma_beta_inv
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probitHLM_+3A_unique_subject_ids">unique_subject_ids</code></td>
<td>
<p>A <code>vector</code> with length N x 1 containing
unique subject IDs.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_subject_ids">subject_ids</code></td>
<td>
<p>A <code>vector</code> with length N*K x 1 containing
subject IDs.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_choices_nk">choices_nk</code></td>
<td>
<p>A <code>vector</code> with length N*K x 1 containing
subject choices.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_fixed_effects_design">fixed_effects_design</code></td>
<td>
<p>A <code>matrix</code> with dimensions N*K x P containing
fixed effect variables.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_rv_effects_design">rv_effects_design</code></td>
<td>
<p>A <code>matrix</code> with dimensions N*K x V containing
random effect variables.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_b_elem_plus1">B_elem_plus1</code></td>
<td>
<p>A <code>V[[1]]</code> dimensional column <code>vector</code>
indicating which zeta_i relate to theta_i.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_gamma">gamma</code></td>
<td>
<p>A <code>vector</code> with dimensions P_1 x 1 containing
fixed parameter estimates.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_beta">beta</code></td>
<td>
<p>A <code>vector</code> with dimensions P_2 x 1 containing
random parameter estimates.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_theta">theta</code></td>
<td>
<p>A <code>vector</code> with dimensions N x 1 containing
subject understanding estimates.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_zeta_rv">zeta_rv</code></td>
<td>
<p>A <code>matrix</code> with dimensions N x V containing
random parameter estimates.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_wtw">WtW</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;field&lt;matrix&gt;&#8288;</code> P x P x N contains the
caching for direct sum.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_z_c">Z_c</code></td>
<td>
<p>A <code>vector</code> with dimensions N*K x 1</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_wzeta_0">Wzeta_0</code></td>
<td>
<p>A <code>vector</code> with dimensions N*K x 1</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_inv_sigma_gamma">inv_Sigma_gamma</code></td>
<td>
<p>A <code>matrix</code> with dimensions P x P that is the
prior inverse sigma matrix for gamma.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_mu_gamma">mu_gamma</code></td>
<td>
<p>A <code>vector</code> with length P x 1 that is the prior
mean vector for gamma.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_sigma_zeta_inv">Sigma_zeta_inv</code></td>
<td>
<p>A <code>matrix</code> with dimensions V x V that is the
prior inverse sigma matrix for zeta.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_s0">S0</code></td>
<td>
<p>A <code>matrix</code> with dimensions V x V that is the
prior sigma matrix for zeta.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_mu_beta">mu_beta</code></td>
<td>
<p>A <code>vector</code> with dimensions P_2 x 1, that is
the mean of beta.</p>
</td></tr>
<tr><td><code id="probitHLM_+3A_sigma_beta_inv">sigma_beta_inv</code></td>
<td>
<p>A <code>matrix</code> with dimensions P_2 x P_2, that is
the inverse sigma matrix of beta.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is implemented to decrease the amount of vectorizations
necessary.
</p>


<h3>Value</h3>

<p>A <code>list</code> that contains:
</p>

<dl>
<dt><code>zeta_1</code></dt><dd><p>A <code>vector</code> of length N</p>
</dd>
<dt><code>sigma_zeta_inv_1</code></dt><dd><p>A <code>matrix</code> of dimensions V x V</p>
</dd>
<dt><code>gamma_1</code></dt><dd><p>A <code>vector</code> of length P</p>
</dd>
<dt><code>beta_1</code></dt><dd><p>A <code>vector</code> of length V</p>
</dd>
<dt><code>B</code></dt><dd><p>A <code>matrix</code> of length V</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven Andrew Culpepper and James Joseph Balamuta
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rwishart">rwishart()</a></code> and <code><a href="#topic+TwoPLChoicemcmc">TwoPLChoicemcmc()</a></code>
</p>

<hr>
<h2 id='riwishart'>Generate Random Inverse Wishart Distribution</h2><span id='topic+riwishart'></span>

<h3>Description</h3>

<p>Creates a random inverse wishart distribution when given
degrees of freedom and a sigma matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>riwishart(df, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="riwishart_+3A_df">df</code></td>
<td>
<p>An <code>integer</code> that represents the degrees of freedom. (&gt; 0)</p>
</td></tr>
<tr><td><code id="riwishart_+3A_s">S</code></td>
<td>
<p>A <code>matrix</code> with dimensions m x m that provides Sigma,
the covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> that is an inverse wishart distribution.
</p>


<h3>Author(s)</h3>

<p>James Joseph Balamuta
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rwishart">rwishart()</a></code> and <code><a href="#topic+TwoPLChoicemcmc">TwoPLChoicemcmc()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Call with the following data:
riwishart(3, diag(2))
</code></pre>

<hr>
<h2 id='rmvnorm'>Generate Random Multivariate Normal Distribution</h2><span id='topic+rmvnorm'></span>

<h3>Description</h3>

<p>Creates a random Multivariate Normal when given number of obs, mean,
and sigma.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmvnorm(n, mu, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmvnorm_+3A_n">n</code></td>
<td>
<p>An <code>integer</code>, which gives the number of observations.  (&gt; 0)</p>
</td></tr>
<tr><td><code id="rmvnorm_+3A_mu">mu</code></td>
<td>
<p>A <code>vector</code> length m that represents the means of the normals.</p>
</td></tr>
<tr><td><code id="rmvnorm_+3A_s">S</code></td>
<td>
<p>A <code>matrix</code> with dimensions m x m that provides Sigma,
the covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> that is a Multivariate Normal distribution.
</p>


<h3>Author(s)</h3>

<p>James Joseph Balamuta
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TwoPLChoicemcmc">TwoPLChoicemcmc()</a></code> and <code><a href="#topic+probitHLM">probitHLM()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Call with the following data: 
rmvnorm(2, c(0,0), diag(2))
</code></pre>

<hr>
<h2 id='rwishart'>Generate Random Wishart Distribution</h2><span id='topic+rwishart'></span>

<h3>Description</h3>

<p>Creates a random wishart distribution when given degrees of freedom
and a sigma matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rwishart(df, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rwishart_+3A_df">df</code></td>
<td>
<p>An <code>integer</code>, which gives the degrees of freedom of the Wishart.
(&gt; 0)</p>
</td></tr>
<tr><td><code id="rwishart_+3A_s">S</code></td>
<td>
<p>A <code>matrix</code> with dimensions m x m that provides Sigma, the
covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> that is a Wishart distribution, aka the sample covariance
matrix of a Multivariate Normal Distribution
</p>


<h3>Author(s)</h3>

<p>James Joseph Balamuta
</p>


<h3>See Also</h3>

<p><code><a href="#topic+riwishart">riwishart()</a></code> and <code><a href="#topic+probitHLM">probitHLM()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Call with the following data:
rwishart(3, diag(2))

# Validation
set.seed(1337)
S = toeplitz((10:1)/10)
n = 10000
o = array(dim = c(10,10,n))
for(i in 1:n){
o[,,i] = rwishart(20, S)
}
mR = apply(o, 1:2, mean)
Va = 20*(S^2 + tcrossprod(diag(S)))
vR = apply(o, 1:2, var)
stopifnot(all.equal(vR, Va, tolerance = 1/16))
</code></pre>

<hr>
<h2 id='survey_data'>Survey Data</h2><span id='topic+survey_data'></span>

<h3>Description</h3>

<p>This data set contains the subject's responses survey questions administered
using Choice38.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survey_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 102 observations on the following 2 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Subject's Assigned Research ID</p>
</dd>
<dt><code>sex</code></dt><dd><p>Subject's sex:
</p>

<ul>
<li><p> Male
</p>
</li>
<li><p> Female
</p>
</li></ul>

</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven Andrew Culpepper and James Joseph Balamuta
</p>


<h3>Source</h3>

<p>Choice38 Experiment at UIUC during Spring 2014 - Fall 2014
</p>

<hr>
<h2 id='Total_Tabulate'>Calculate Tabulated Total Scores</h2><span id='topic+Total_Tabulate'></span>

<h3>Description</h3>

<p>Internal function to -2LL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Total_Tabulate(N, J, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Total_Tabulate_+3A_n">N</code></td>
<td>
<p>An <code>integer</code>, which gives the number of observations.  (&gt; 0)</p>
</td></tr>
<tr><td><code id="Total_Tabulate_+3A_j">J</code></td>
<td>
<p>An <code>integer</code>, which gives the number of items.  (&gt; 0)</p>
</td></tr>
<tr><td><code id="Total_Tabulate_+3A_y">Y</code></td>
<td>
<p>A N by J <code>matrix</code> of item responses.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of tabulated total scores.
</p>


<h3>Author(s)</h3>

<p>Steven Andrew Culpepper
</p>

<hr>
<h2 id='trial_matrix'>Trial Matrix Data</h2><span id='topic+trial_matrix'></span>

<h3>Description</h3>

<p>This data set contains the subject's responses to items.
Correct answers are denoted by 1 and incorrect answers are denoted by 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trial_matrix
</code></pre>


<h3>Format</h3>

<p>A data frame with 252 observations on the following 30 variables.
</p>

<dl>
<dt><code>t1</code></dt><dd><p>Subject's Response to Item 1.</p>
</dd>
<dt><code>t2</code></dt><dd><p>Subject's Response to Item 2.</p>
</dd>
<dt><code>t3</code></dt><dd><p>Subject's Response to Item 3.</p>
</dd>
<dt><code>t4</code></dt><dd><p>Subject's Response to Item 4.</p>
</dd>
<dt><code>t5</code></dt><dd><p>Subject's Response to Item 5.</p>
</dd>
<dt><code>t6</code></dt><dd><p>Subject's Response to Item 6.</p>
</dd>
<dt><code>t7</code></dt><dd><p>Subject's Response to Item 7.</p>
</dd>
<dt><code>t8</code></dt><dd><p>Subject's Response to Item 8.</p>
</dd>
<dt><code>t9</code></dt><dd><p>Subject's Response to Item 9.</p>
</dd>
<dt><code>t10</code></dt><dd><p>Subject's Response to Item 10.</p>
</dd>
<dt><code>t11</code></dt><dd><p>Subject's Response to Item 11.</p>
</dd>
<dt><code>t12</code></dt><dd><p>Subject's Response to Item 12.</p>
</dd>
<dt><code>t13</code></dt><dd><p>Subject's Response to Item 13.</p>
</dd>
<dt><code>t14</code></dt><dd><p>Subject's Response to Item 14.</p>
</dd>
<dt><code>t15</code></dt><dd><p>Subject's Response to Item 15.</p>
</dd>
<dt><code>t16</code></dt><dd><p>Subject's Response to Item 16.</p>
</dd>
<dt><code>t17</code></dt><dd><p>Subject's Response to Item 17.</p>
</dd>
<dt><code>t18</code></dt><dd><p>Subject's Response to Item 18.</p>
</dd>
<dt><code>t19</code></dt><dd><p>Subject's Response to Item 19.</p>
</dd>
<dt><code>t20</code></dt><dd><p>Subject's Response to Item 20.</p>
</dd>
<dt><code>t21</code></dt><dd><p>Subject's Response to Item 21.</p>
</dd>
<dt><code>t22</code></dt><dd><p>Subject's Response to Item 22.</p>
</dd>
<dt><code>t23</code></dt><dd><p>Subject's Response to Item 23.</p>
</dd>
<dt><code>t24</code></dt><dd><p>Subject's Response to Item 24.</p>
</dd>
<dt><code>t25</code></dt><dd><p>Subject's Response to Item 25.</p>
</dd>
<dt><code>t26</code></dt><dd><p>Subject's Response to Item 26.</p>
</dd>
<dt><code>t27</code></dt><dd><p>Subject's Response to Item 27.</p>
</dd>
<dt><code>t28</code></dt><dd><p>Subject's Response to Item 28.</p>
</dd>
<dt><code>t29</code></dt><dd><p>Subject's Response to Item 29.</p>
</dd>
<dt><code>t30</code></dt><dd><p>Subject's Response to Item 30.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven Andrew Culpepper and James Joseph Balamuta
</p>


<h3>Source</h3>

<p>Choice38 Experiment at UIUC during Spring 2014 - Fall 2014
</p>

<hr>
<h2 id='TwoPLChoicemcmc'>Two Parameter Choice IRT Model MCMC</h2><span id='topic+TwoPLChoicemcmc'></span>

<h3>Description</h3>

<p>Performs an MCMC routine for a two parameter IRT Model using Choice Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TwoPLChoicemcmc(
  unique_subject_ids,
  subject_ids,
  choices_nk,
  fixed_effects,
  B,
  rv_effects_design,
  gamma,
  beta,
  zeta_rv,
  Sigma_zeta_inv,
  Y,
  theta0,
  a0,
  b0,
  mu_xi0,
  Sig_xi0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TwoPLChoicemcmc_+3A_unique_subject_ids">unique_subject_ids</code></td>
<td>
<p>A <code>vector</code> with length <code class="reqn">N \times 1</code>
containing unique subject IDs.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_subject_ids">subject_ids</code></td>
<td>
<p>A <code>vector</code> with length <code class="reqn">NK \times 1</code>
containing subject IDs.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_choices_nk">choices_nk</code></td>
<td>
<p>A <code>vector</code> with length <code class="reqn">NK \times 1</code>
containing subject choices.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_fixed_effects">fixed_effects</code></td>
<td>
<p>A <code>matrix</code> with dimensions
<code class="reqn">NK \times P_1</code> containing
fixed effect design matrix without theta.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_b">B</code></td>
<td>
<p>A <code class="reqn">V</code> dimensional column <code>vector</code>
relating <code class="reqn">\theta_i</code> and
<code class="reqn">\zeta_i</code>.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_rv_effects_design">rv_effects_design</code></td>
<td>
<p>A <code>matrix</code> with dimensions
<code class="reqn">NK \times V</code> containing
random effect variables.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_gamma">gamma</code></td>
<td>
<p>A <code>vector</code> with dimensions <code class="reqn">P \times 1</code>
containing fixed parameter estimates,
where <code class="reqn">P = P_1 + P_2</code></p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_beta">beta</code></td>
<td>
<p>A <code>vector</code> with dimensions <code class="reqn">P_2</code>
containing random parameter estimates.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_zeta_rv">zeta_rv</code></td>
<td>
<p>A <code>matrix</code> with dimensions <code class="reqn">N \times V</code>
containing random parameter estimates.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_sigma_zeta_inv">Sigma_zeta_inv</code></td>
<td>
<p>A <code>matrix</code> with dimensions
<code class="reqn">P_2 \times P_2</code>.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_y">Y</code></td>
<td>
<p>A <code>matrix</code> of dimensions <code class="reqn">N \times J</code>
for Dichotomous item responses</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_theta0">theta0</code></td>
<td>
<p>A <code>vector</code> of length <code class="reqn">N \times 1</code>
for latent theta.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_a0">a0</code></td>
<td>
<p>A <code>vector</code> of length <code class="reqn">J</code>
for item discriminations.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_b0">b0</code></td>
<td>
<p>A <code>vector</code> of length <code class="reqn">J</code>
for item locations.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_mu_xi0">mu_xi0</code></td>
<td>
<p>A <code>vector</code> of dimension 2 (i.e. c(0,1)) that is a
prior for item parameter means.</p>
</td></tr>
<tr><td><code id="TwoPLChoicemcmc_+3A_sig_xi0">Sig_xi0</code></td>
<td>
<p>A <code>matrix</code> of dimension 2x2 (i.e. diag(2)) that
is a prior for item parameter vc matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> that contains:
</p>

<dl>
<dt><code>ai1</code></dt><dd><p>A <code>vector</code> of length J</p>
</dd>
<dt><code>bi1</code></dt><dd><p>A <code>vector</code> of length J</p>
</dd>
<dt><code>theta1</code></dt><dd><p>A <code>vector</code> of length N</p>
</dd>
<dt><code>Z_c</code></dt><dd><p>A <code>matrix</code> of length NK</p>
</dd>
<dt><code>Wzeta_0</code></dt><dd><p>A <code>matrix</code> of length NK</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Steven Andrew Culpepper and James Joseph Balamuta
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cIRT">cIRT()</a></code>, <code><a href="#topic+rmvnorm">rmvnorm()</a></code>, and <code><a href="#topic+riwishart">riwishart()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Call with the following data:
TwoPLChoicemcmc(cogDAT, theta0, a0, b0, mu_xi0, Sig_xi0)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
