<!DOCTYPE html><html><head><title>Help for package BLRPM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BLRPM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Beta.fun'><p>Beta function needed in objective function</p></a></li>
<li><a href='#BL.acc'><p>Accumulation of a precipitation stepfunction</p></a></li>
<li><a href='#BL.sim'><p>Simulating storms and cells</p></a></li>
<li><a href='#BL.stepfun'><p>BLRPM continous stepfunction of precipitation</p></a></li>
<li><a href='#BLRPM.class'><p>BLRPM class</p></a></li>
<li><a href='#BLRPM.est'><p>BLRPM Parameter Estimation function</p></a></li>
<li><a href='#BLRPM.OF'><p>BLRPM objective function for parameter estimation</p></a></li>
<li><a href='#BLRPM.sim'><p>Simulating precipitation with the BLRPM</p></a></li>
<li><a href='#Delta.fun'><p>Delta function needed in objective function</p></a></li>
<li><a href='#plot.BLRPM'><p>Plotting of an object of <code>class</code> BLRPM</p></a></li>
<li><a href='#TS.acc'><p>Accumulation of a time series</p></a></li>
<li><a href='#TS.stats'><p>calculating statistics of a time series needed for parameter estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stochastic Rainfall Generator Bartlett-Lewis Rectangular Pulse
Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-10-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Christoph Ritschel</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christoph Ritschel &lt;christoph.ritschel@met.fu-berlin.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R6</td>
</tr>
<tr>
<td>Description:</td>
<td>Due to a limited availability of observed high-resolution precipitation records with adequate length, simulations with stochastic precipitation models are used to generate series for subsequent studies [e.g. Khaliq and Cunmae, 1996, &lt;<a href="https://doi.org/10.1016%2F0022-1694%2895%2902894-3">doi:10.1016/0022-1694(95)02894-3</a>&gt;, Vandenberghe et al., 2011, &lt;<a href="https://doi.org/10.1029%2F2009WR008388">doi:10.1029/2009WR008388</a>&gt;]. This package contains an R implementation of the original Bartlett-Lewis rectangular pulse model (BLRPM), developed by Rodriguez-Iturbe et al. (1987) &lt;<a href="https://doi.org/10.1098%2Frspa.1987.0039">doi:10.1098/rspa.1987.0039</a>&gt;. It contains a function for simulating a precipitation time series based on storms and cells generated by the model with given or estimated model parameters. Additionally BLRPM parameters can be estimated from a given or simulated precipitation time series. The model simulations can be plotted in a three-layer plot including an overview of generated storms and cells by the model (which can also be plotted individually), a continuous step-function and a discrete precipitation time series at a chosen aggregation level. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-10-06 09:37:15 UTC; kruud</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-10-06 11:42:37 UTC</td>
</tr>
</table>
<hr>
<h2 id='Beta.fun'>Beta function needed in objective function</h2><span id='topic+Beta.fun'></span>

<h3>Description</h3>

<p><code>Beta.fun</code> is a help function for <code>OF</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Beta.fun(a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Beta.fun_+3A_a">a</code></td>
<td>
<p><code>value</code> specifying Parameter a</p>
</td></tr>
<tr><td><code id="Beta.fun_+3A_b">b</code></td>
<td>
<p><code>value</code> specifying Parameter b</p>
</td></tr>
</table>


<h3>Value</h3>

<p>beta returns value of <code>Beta.fun</code> for parameters a and b
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>

<hr>
<h2 id='BL.acc'>Accumulation of a precipitation stepfunction</h2><span id='topic+BL.acc'></span>

<h3>Description</h3>

<p><code>BL.acc</code> accumulates the BLRPM stepfunction for a given accumulation time <code>t.acc</code>
at a given accumulation level <code>acc.val</code>. An <code>offse</code> can be defined. The unit is typically hours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BL.acc(sfn, t.acc = 240, acc.val = 1, offset = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BL.acc_+3A_sfn">sfn</code></td>
<td>
<p>stepfunction of precipitation</p>
</td></tr>
<tr><td><code id="BL.acc_+3A_t.acc">t.acc</code></td>
<td>
<p><code>value</code> specifiying the length of accumulated time series [h]</p>
</td></tr>
<tr><td><code id="BL.acc_+3A_acc.val">acc.val</code></td>
<td>
<p><code>value</code> specifying the accumulation level [h]</p>
</td></tr>
<tr><td><code id="BL.acc_+3A_offset">offset</code></td>
<td>
<p><code>value</code> specifying the offset of the accumulated time series [h]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p.acc <code>data.frame</code>
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lambda &lt;- 4/240
gamma &lt;- 1/10
beta &lt;- 0.3
eta &lt;- 2
mux &lt;- 4
t.sim &lt;- 240
t.acc &lt;- t.sim
acc.val &lt;- 1
offset &lt;- 0

simulation &lt;- BL.sim(lambda,gamma,beta,eta,mux,t.sim)
sfn &lt;- BL.stepfun(simulation$cells)
ts &lt;- BL.acc(sfn,t.acc,acc.val,offset)
</code></pre>

<hr>
<h2 id='BL.sim'>Simulating storms and cells</h2><span id='topic+BL.sim'></span>

<h3>Description</h3>

<p>Bartlett-Lewis Rectangular Pulse Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BL.sim(lambda = 4/240, gamma = 1/10, beta = 0.3, eta = 2, mux = 4,
  t.sim = 240)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BL.sim_+3A_lambda">lambda</code></td>
<td>
<p>value specifying the generation rate of storms [1/h]</p>
</td></tr>
<tr><td><code id="BL.sim_+3A_gamma">gamma</code></td>
<td>
<p>value specifying the storm duration [1/h]</p>
</td></tr>
<tr><td><code id="BL.sim_+3A_beta">beta</code></td>
<td>
<p>value specifying the generation rate of cells [1/h]</p>
</td></tr>
<tr><td><code id="BL.sim_+3A_eta">eta</code></td>
<td>
<p>value specifying the cell duration [1/h]</p>
</td></tr>
<tr><td><code id="BL.sim_+3A_mux">mux</code></td>
<td>
<p>value specifying the cell intensity [mm/h]</p>
</td></tr>
<tr><td><code id="BL.sim_+3A_t.sim">t.sim</code></td>
<td>
<p>value specifying the simulation time [h]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model description (Rodriguez-Iturbe et al., 1987):
</p>
<p>The model is a combination of 2 poisson processes and simulates storms and cells.
During the given simulation time storms are generated in a poisson process with rate lambda.
Those storms are given a exponetially distributed duration with parameter gamma. 
During its duration the storm generates in a second poisson process cells with rate beta.
The first cell has to be instantaneous at the time of the storm arrival.
The cell duration is exponentially distributed with parameter eta. For the whole lifetime
each cell is given a constant intensity which is exponentially distributed with parameter 1/mux.
</p>
<p>Aggregation:
</p>
<p>The intensities of all cells alive at time t are summed up for total precipitation at time t.
</p>
<p>Parameter estimation:
</p>
<p>The model parameters (lambda,gamma,beta,eta,mux) can be estimated from simulated or 
observed precipitation time series using the method of moments. Certain moments, e.g. mean, variance 
can be calculated from the time series at different aggregation levels. These moments
can also be calculated theoretically from model parameters. Both sets of statistics can be 
compared in an objective function, similar to a squared error estimator. By numerical optimization
the model parameters can be tuned to match the time series characteristics. 
<code>BL.sim</code> generates model realisations of storms and cells by using given model
parameters <code>lambda,gamma,beta,eta,mux</code> for a given simulation time <code>t.sim</code>
</p>


<h3>Value</h3>

<p><code>BL.sim</code> returns storms; <code>data.frame</code> of all storms containing information about occurence time, end time and number of cells
</p>
<p><code>BL.sim</code> returns cells; <code>data.frame</code> of all cells containing information about occurence time, end time, intensity and storm index
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lambda &lt;- 4/240
gamma &lt;- 1/10
beta &lt;- 0.3
eta &lt;- 2
mux &lt;- 4
t.sim &lt;- 240
simulation &lt;- BL.sim(lambda,gamma,beta,eta,mux,t.sim)
</code></pre>

<hr>
<h2 id='BL.stepfun'>BLRPM continous stepfunction of precipitation</h2><span id='topic+BL.stepfun'></span>

<h3>Description</h3>

<p><code>BL.stepfun</code> calculates a continous stepfunction of precipitation from
the <code>data.frame</code> <code>cells</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BL.stepfun(cells)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BL.stepfun_+3A_cells">cells</code></td>
<td>
<p><code>data.frame</code> of all cells containing information about occurence time, end time, intensity and storm index</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sfn returns stepfunction of precipitation
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lambda &lt;- 4/240
gamma &lt;- 1/10
beta &lt;- 0.3
eta &lt;- 2
mux &lt;- 4
t.sim &lt;- 240
simulation &lt;- BL.sim(lambda,gamma,beta,eta,mux,t.sim)
stepfun &lt;- BL.stepfun(simulation$cells)
</code></pre>

<hr>
<h2 id='BLRPM.class'>BLRPM class</h2><span id='topic+BLRPM.class'></span>

<h3>Description</h3>

<p><code>BLRPM.class</code> defines a new class for objects of type BLRPM containing the information about storms,
cells, stepfunction and the precipitation time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BLRPM.class
</code></pre>


<h3>Format</h3>

<p>An object of class <code>R6ClassGenerator</code> of length 24.</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>

<hr>
<h2 id='BLRPM.est'>BLRPM Parameter Estimation function</h2><span id='topic+BLRPM.est'></span>

<h3>Description</h3>

<p><code>BLRPM.est</code> estimates the five Bartlett-Lewis rectangular pulse model parameters <code>lambda,gamma,beta,eta,mux</code>
for a given time series <code>data</code>. At first the time series statistics at given accumulation levels <code>acc.vals</code>
are calculated. These statistics are given over to the parameter estimation algorithm together with 
parameter starting values <code>par</code>. An objective function <code>O.Fun</code> can be specified, default is <code>BLRPM.OF</code>.
In addition the weights for different statistics and accumulation levels <code>weights.mean, weights.var, weights.cov, weights.pz</code>
can be specified. For the BLRPM objective function the user can select the measure of distance between observation
and model with <code>OF</code>: =1 quadratic, =2: quad extended, =3: absolute, =4: abs extended.
A <code>scale</code> parameter controls different cases in the objective function for differences in the scale of duration
parameters gamma and eta.   
If a debugging is wished, <code>debug</code> can be set to <code>TRUE</code> and a log file is created in working directory.
Several <code>optim</code> parameters can be also defined. For specifics see <code>?optim</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BLRPM.est(RR,acc.vals,pars.in,O.Fun,
weights.mean,weights.var,weights.cov,weights.pz,OF,debug,
scale,method,lower,upper,use.log,maxit,ndeps,trace)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BLRPM.est_+3A_rr">RR</code></td>
<td>
<p><code>vector</code> of a precipitation time series</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_acc.vals">acc.vals</code></td>
<td>
<p><code>vector</code> of different accumulation levels at which statistics are to be calculated</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_pars.in">pars.in</code></td>
<td>
<p><code>vector</code> specifying starting values of <code>lambda,gamma,beta,eta,mux</code> for optimization</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_o.fun">O.Fun</code></td>
<td>
<p><code>objective function</code> to be used during optimization</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_weights.mean">weights.mean</code></td>
<td>
<p><code>value</code> for weight for mean value at first accumulation level</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_weights.var">weights.var</code></td>
<td>
<p><code>vecotr</code> of weights for variances, has to have <code>length(acc.vals)</code></p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_weights.cov">weights.cov</code></td>
<td>
<p><code>vecotr</code> of weights for covariances, has to have <code>length(acc.vals)</code></p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_weights.pz">weights.pz</code></td>
<td>
<p><code>vecotr</code> of weights for probability of zero rainfall, has to have <code>length(acc.vals)</code></p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_of">OF</code></td>
<td>
<p><code>value</code> specifying the type of objective function. 1: quadratic, 2: quad symmetrized, 3: absolute, 4: abs symmetrized
Note: quadratic symmetrized proofed to be most effective and fastest</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_debug">debug</code></td>
<td>
<p>set <code>TRUE</code> if debugging is wished, default <code>FALSE</code>. Creates a log file in working directory</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_scale">scale</code></td>
<td>
<p><code>value</code> specifying the scaling between gamma and eta in the objective function</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_method">method</code></td>
<td>
<p><code>character</code> defining the method to be used in <code>optim</code>, preferences are: &quot;Nelder-Mead&quot;, &quot;BFGS&quot;, &quot;L-BFGS-B&quot;e</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_lower">lower</code></td>
<td>
<p><code>vector</code> specifying the lower boundary of parameters for &quot;L-BFGS-B&quot; method</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_upper">upper</code></td>
<td>
<p><code>vector</code> specifying the upper boundary of parameters for &quot;L-BFGS-B&quot; method</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_use.log">use.log</code></td>
<td>
<p><code>logical</code>, set <code>TRUE</code> if logarithmic parameters during optimization should be used. Advantage: zero as lower boundary for parameters</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_maxit">maxit</code></td>
<td>
<p><code>value</code> specifying the maximum number of itereations durion optimization</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_ndeps">ndeps</code></td>
<td>
<p><code>vector</code> specifying the change for each parameter during one interation step</p>
</td></tr>
<tr><td><code id="BLRPM.est_+3A_trace">trace</code></td>
<td>
<p><code>value</code> specifying output information of <code>optim</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>$est returns <code>vector</code> of estimated parameters <code>lambda,gamma,beta,eta,mux</code>
</p>
<p>$conv returns <code>value</code> of convergence of optimization, see <code>optim</code> for details
</p>
<p>$mess returns <code>character</code> message about optimization if using &quot;L-BFGS-B&quot; method
</p>
<p>$Z returns <code>value</code> of objective function for estimated parameters
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t.sim=240

lambda &lt;- 4/240
gamma &lt;- 1/10
beta &lt;- 0.3
eta &lt;- 2
mux &lt;- 4

pars &lt;- c(lambda,gamma,beta,eta,mux)

sim &lt;- BLRPM.sim(lambda,gamma,beta,eta,mux,t.sim)
est &lt;- BLRPM.est(sim$RR,pars.in=pars,method="BFGS",use.log=TRUE)

</code></pre>

<hr>
<h2 id='BLRPM.OF'>BLRPM objective function for parameter estimation</h2><span id='topic+BLRPM.OF'></span>

<h3>Description</h3>

<p><code>BLRPM.OF</code> is the objective function used for parameter estimation of the BLRPM parameters. 
Given a set of BLRPM parameters <code>par</code> this function calculates a set of model statistics at
given accumulation time steps <code>acc.vals</code>. These model statistics are compared with given
time series statistics <code>stats</code> in the objective function. The user is able to define <code>weights</code>
for each statistic (has to be the same length as statistics input vector). Option for debugging is given.
A <code>scale</code> parameter defines a criterium for which different kinds of model statistics are calculated.
This criterium is mainly based on the timescale difference between storm duration parameter gamma and cell duration
parameter eta.
If <code>use.log</code> is true, the objective function needs logarithmic input parameters. The value
of <code>OF</code> defines the kind of objective function to be used: 1= quadratic 2= quadratic extended 3= absolute 4= absolute extended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BLRPM.OF(par, stats, acc.vals = c(1, 3, 12, 24), weights = rep(1,
  length(stats)), debug = FALSE, scale = 1, use.log = TRUE, OF = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BLRPM.OF_+3A_par">par</code></td>
<td>
<p><code>vector</code> specifying the five model parameters (lambda,gamma,beta,eta,mux) at which the objective function is to be calculated</p>
</td></tr>
<tr><td><code id="BLRPM.OF_+3A_stats">stats</code></td>
<td>
<p><code>vector</code> specifying the time series statistics to which the model is compared to</p>
</td></tr>
<tr><td><code id="BLRPM.OF_+3A_acc.vals">acc.vals</code></td>
<td>
<p><code>vector</code> specifying the accumulation time steps at which the model statistics are calculated</p>
</td></tr>
<tr><td><code id="BLRPM.OF_+3A_weights">weights</code></td>
<td>
<p><code>vector</code> specifying the weight of each statistic in the objective function. 
Note: has to have the same length as <code>stats</code></p>
</td></tr>
<tr><td><code id="BLRPM.OF_+3A_debug">debug</code></td>
<td>
<p><code>logical</code> defining if debuggging of function has to be done</p>
</td></tr>
<tr><td><code id="BLRPM.OF_+3A_scale">scale</code></td>
<td>
<p><code>value</code> spacifying the scale factor for comparisson between duration parameters gamma and eta</p>
</td></tr>
<tr><td><code id="BLRPM.OF_+3A_use.log">use.log</code></td>
<td>
<p><code>logical</code> defining if input parameters are logarithmic</p>
</td></tr>
<tr><td><code id="BLRPM.OF_+3A_of">OF</code></td>
<td>
<p><code>value</code> specifying the type of objective function. 1: quadratic, 2: quad extended, 3: absolute, 4: abs extended</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Z returns value of objective function for input parameters and input statistics
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>

<hr>
<h2 id='BLRPM.sim'>Simulating precipitation with the BLRPM</h2><span id='topic+BLRPM.sim'></span>

<h3>Description</h3>

<p><code>BLRPM.sim</code> is the main function for simulating precipitation with the Bartlett-Lewis rectangular pulse model.
It generates storms and cells using the given five BLRPM parameters <code>lambda, gamma, beta, eta, mux</code> for a given
simulation time <code>t.sim</code>. The function <code>BLRPM.sim</code> then accumulates a precipitation time series of length 
<code>t.akk</code> (typically the same as t.sim) with an accumulation time step <code>interval</code> from the generated
storms and cells. An <code>offset</code> can be used to delay the precipitation time series for initialization reasons.
<code>BLRPM.sim</code> returns a list of different variables and data.frames: <code>Storms, Cells, Stepfun, Precip, time</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BLRPM.sim(lambda,gamma,beta,eta,mux,t.sim,t.acc,interval,offset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BLRPM.sim_+3A_lambda">lambda</code></td>
<td>
<p><code>value</code> specifying the expected storm generation rate [1/units.time]</p>
</td></tr>
<tr><td><code id="BLRPM.sim_+3A_gamma">gamma</code></td>
<td>
<p><code>value</code> specifying the expected storm duration[1/units.time]</p>
</td></tr>
<tr><td><code id="BLRPM.sim_+3A_beta">beta</code></td>
<td>
<p><code>value</code> specifying the expected cell generation rate [1/units.time]</p>
</td></tr>
<tr><td><code id="BLRPM.sim_+3A_eta">eta</code></td>
<td>
<p><code>value</code> specifying the expected cell duration [1/units.time]</p>
</td></tr>
<tr><td><code id="BLRPM.sim_+3A_mux">mux</code></td>
<td>
<p><code>value</code> specifying the expected cell intenstity [mm/unit.time]</p>
</td></tr>
<tr><td><code id="BLRPM.sim_+3A_t.sim">t.sim</code></td>
<td>
<p><code>value</code> specifying the simulation length [units.time]</p>
</td></tr>
<tr><td><code id="BLRPM.sim_+3A_t.acc">t.acc</code></td>
<td>
<p><code>value</code> specifying the length of the accumulated time series [units.time]. 
Note: if longer than t.sim only zeros are added after t.sim.</p>
</td></tr>
<tr><td><code id="BLRPM.sim_+3A_interval">interval</code></td>
<td>
<p><code>value</code> specifying the accumulation time step [units.time]</p>
</td></tr>
<tr><td><code id="BLRPM.sim_+3A_offset">offset</code></td>
<td>
<p><code>value</code> specifying the offset of the accumulated time series with 
respect to the start time of the simulation [units.time]. Note: negative values are not allowed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>$storms returns <code>data.frame</code> containing information about storms: start, end, number of cells
</p>
<p>$cells returns <code>data.frame</code> containing information about cells: start, end, intensity, storm index
</p>
<p>$sfn returns <code>stepfunction</code> used to accumulate precipitation time series
</p>
<p>$RR returns <code>vector</code> of accumulated precipitation with time step <code>interval</code> [mm/interval]
</p>
<p>$time returns <code>vector</code> of time steps [interval]
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lambda &lt;- 4/240
gamma &lt;- 1/10
beta &lt;- 0.3
eta &lt;- 2
mux &lt;- 4
t.sim &lt;- 240
t.acc &lt;- t.sim
interval &lt;- 1
offset &lt;- 0
simulation &lt;- BLRPM.sim(lambda,gamma,beta,eta,mux,t.sim,t.acc=t.sim,interval,offset)
</code></pre>

<hr>
<h2 id='Delta.fun'>Delta function needed in objective function</h2><span id='topic+Delta.fun'></span>

<h3>Description</h3>

<p><code>Delta.fun</code> is a help function for <code>OF</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Delta.fun(kappa, MStrich)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Delta.fun_+3A_kappa">kappa</code></td>
<td>
<p><code>value</code> specifying Parameter kappa</p>
</td></tr>
<tr><td><code id="Delta.fun_+3A_mstrich">MStrich</code></td>
<td>
<p><code>value</code> specifying dimension of error correction in objective function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Delta returns value of <code>Delta.fun</code> for kappa and MStrich
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>

<hr>
<h2 id='plot.BLRPM'>Plotting of an object of <code>class</code> BLRPM</h2><span id='topic+plot.BLRPM'></span>

<h3>Description</h3>

<p><code>plot.BLRPM</code> plots an object of <code>class</code> BLRPM returned by the function <code>BLRPM.sim</code> with an option to plot
either only the storms and cells or to additionally plot the stepfunction and the precipitation time series
in a multiframe plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BLRPM'
plot(x, ..., OSC = FALSE, start.time = NULL,
  end.time = NULL, legend = TRUE, c.axis = 1.5, c.lab = 1.5,
  c.legend = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.BLRPM_+3A_x">x</code></td>
<td>
<p><code>class</code> BLRPM object which is returned by function <code>BLRPM.sim</code></p>
</td></tr>
<tr><td><code id="plot.BLRPM_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods, such as <a href="graphics.html#topic+graphical+20parameters">graphical parameters</a> (see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="plot.BLRPM_+3A_osc">OSC</code></td>
<td>
<p><code>logical</code> determing type of plot. OSC=True only storms and cells are plotted. OSC=FALSE storms, cells, 
stepfunction and precipitation time series plotted.</p>
</td></tr>
<tr><td><code id="plot.BLRPM_+3A_start.time">start.time</code></td>
<td>
<p><code>numerical</code> value setting the starting time of a time window to be plotted. Default is NULL, therefore start time is 0</p>
</td></tr>
<tr><td><code id="plot.BLRPM_+3A_end.time">end.time</code></td>
<td>
<p><code>numerical</code> value setting the end time of a time window to be plotted. Default is NULL, meaning the plot will 
end with the last active cell</p>
</td></tr>
<tr><td><code id="plot.BLRPM_+3A_legend">legend</code></td>
<td>
<p><code>logical</code> setting the option for legend to be plotted or not</p>
</td></tr>
<tr><td><code id="plot.BLRPM_+3A_c.axis">c.axis</code></td>
<td>
<p><code>numerical</code> value for axis label size, default is 1.5</p>
</td></tr>
<tr><td><code id="plot.BLRPM_+3A_c.lab">c.lab</code></td>
<td>
<p><code>numerical</code> value for plot label size, default is 1.5</p>
</td></tr>
<tr><td><code id="plot.BLRPM_+3A_c.legend">c.legend</code></td>
<td>
<p><code>numerical</code> value for legend font size, default is 1.5</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lambda &lt;- 4/240
gamma &lt;- 1/10
beta &lt;- 0.3
eta &lt;- 2
mux &lt;- 4
t.sim &lt;- 240
t.acc &lt;- t.sim
interval &lt;- 1
offset &lt;- 0
simulation &lt;- BLRPM.sim(lambda,gamma,beta,eta,mux,t.sim,t.acc=t.sim,interval,offset)
plot(simulation,OSC=FALSE)

plot(simulation,OSC=TRUE,start.time=1,end.time=24)

</code></pre>

<hr>
<h2 id='TS.acc'>Accumulation of a time series</h2><span id='topic+TS.acc'></span>

<h3>Description</h3>

<p><code>TS.acc</code> accumulates a given time series <code>x</code> at a given accumulation level <code>acc.val</code>. Minimum value
for acc.val is 2 [unit time]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS.acc(x,acc.val)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS.acc_+3A_x">x</code></td>
<td>
<p><code>vector</code> of a time series</p>
</td></tr>
<tr><td><code id="TS.acc_+3A_acc.val">acc.val</code></td>
<td>
<p><code>value</code> specifying the accumulation level, minimum value is 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x.acc <code>TS.acc</code> returns a <code>vector</code> of an accumulated time series
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rgamma(1000,1)
x.2 &lt;- TS.acc(x,acc.val=2)
</code></pre>

<hr>
<h2 id='TS.stats'>calculating statistics of a time series needed for parameter estimation</h2><span id='topic+TS.stats'></span>

<h3>Description</h3>

<p><code>TS.stats</code> calculates statistics of a given time series <code>x</code> at given accumulation
levels <code>acc.vals</code>. The calculated statistics are the mean of the first accumulation level,
the variance, auto-covariance lag-1 and the probability of zero rainfall of all given accumulation 
levels of the time series. These statistics are needed for estimating the BLRPM parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS.stats(x,acc.vals)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS.stats_+3A_x">x</code></td>
<td>
<p><code>vector</code> of a time series</p>
</td></tr>
<tr><td><code id="TS.stats_+3A_acc.vals">acc.vals</code></td>
<td>
<p><code>vector</code> of accumulation levels, first value should be 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>stats <code>TS.stats</code> returns a <code>vector</code> of statistics calculated at given accumulation levels
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>time.series &lt;- rgamma(1000,shape=1)
statistics &lt;- TS.stats(time.series,acc.vals=c(1,3,12,24)) 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
