<!DOCTYPE html><html><head><title>Help for package ZIPFA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ZIPFA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cv_ZIPFA'><p>Cross validation for Zero Inflated Poisson factor analysis</p></a></li>
<li><a href='#EMzeropoisson_mat'><p>Zero Inflated Possion Regression</p></a></li>
<li><a href='#X'>
<p>A simulated data X.</p></a></li>
<li><a href='#ZIPFA'><p>Zero Inflated Poisson factor analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Zero Inflated Poisson Factor Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Tianchen Xu [aut, cre] (&lt;https://orcid.org/0000-0002-0102-7630&gt;),
  Ryan T. Demmer [aut],
  Gen Li [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tianchen Xu &lt;tx2155@columbia.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation methods for zero-inflated Poisson factor analysis (ZIPFA) on sparse data. 
    It provides estimates of coefficients in a new type of zero-inflated regression. 
    It provides a cross-validation method to determine the potential rank of the data in the ZIPFA 
    and conducts zero-inflated Poisson factor analysis based on the determined rank.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://zjph602xtc.github.io/ZIPFA/">https://zjph602xtc.github.io/ZIPFA/</a>,
<a href="https://arxiv.org/abs/1910.11985">https://arxiv.org/abs/1910.11985</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/zjph602xtc/ZIPFA/issues">https://github.com/zjph602xtc/ZIPFA/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, doParallel, foreach, optimx, trustOptim</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-31 19:54:40 UTC; Peter Xu</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-31 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cv_ZIPFA'>Cross validation for Zero Inflated Poisson factor analysis
</h2><span id='topic+cv_ZIPFA'></span>

<h3>Description</h3>

<p>To conduct a cross validation for Zero Inflated Poisson factor analysis to find the number of factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_ZIPFA(X, k, fold, tau = 0.1, cut = 0.8, tolLnlikelihood = 5e-4,
          iter = 20, tol = 1e-4, maxiter = 100, initialtau = 'iteration',
          Madj = TRUE, display = TRUE, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv_ZIPFA_+3A_x">X</code></td>
<td>
<p>The matrix to be decomposed.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_k">k</code></td>
<td>
<p>A vector containing the number of factors to try.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_fold">fold</code></td>
<td>
<p>The number of folds used in cross validation.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_tau">tau</code></td>
<td>
<p>Initial tau value to fit. Will be overwritten by the first value in <code>initial</code> argument.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_cut">cut</code></td>
<td>
<p>To delete columns that has more than 100('<code>Cut</code>')% zeros. <code>Cut = 1</code>, if no filtering.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_tollnlikelihood">tolLnlikelihood</code></td>
<td>
<p>The max percentage of log likelihood differences in two iterations.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_iter">iter</code></td>
<td>
<p>Max iterations.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_initialtau">initialtau</code></td>
<td>
<p>A character specifying the way to choose the initial value of tau at the beginning of EM iteration. <code>stable</code>: estimate tau from fitted beta in last round; <code>initial</code>: always use the initially assigned tau in <code>tau</code> or <code>initial</code>. Use the default tau = 0.1 if 'initial' is empty. <code>iteration</code>: use fitted tau in last round.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_tol">tol</code></td>
<td>
<p>Percentage of l2 norm change of [tau beta].</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_maxiter">maxiter</code></td>
<td>
<p>Max iteration number in the zero inflated poisson regression.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_madj">Madj</code></td>
<td>
<p>If TRUE then adjust for relative library size M.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_display">display</code></td>
<td>
<p>If TRUE display the fitting procedure.</p>
</td></tr>
<tr><td><code id="cv_ZIPFA_+3A_parallel">parallel</code></td>
<td>
<p>Use <code>doParallel</code> and <code>foreach</code> package to accelerate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function conducts cross validation on the zero-inflated Poisson factor analysis to determine the rank.
</p>


<h3>Value</h3>

<p>The function returns a matrix. Each row the CV likelihood of one fold. Each column is the result of number of factors in <code>k</code>.
</p>


<h3>Author(s)</h3>

<p>Tianchen Xu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(X)
cv_ZIPFA(X, fold = 10, k = c(3,4))


</code></pre>

<hr>
<h2 id='EMzeropoisson_mat'>Zero Inflated Possion Regression</h2><span id='topic+EMzeropoisson_mat'></span>

<h3>Description</h3>

<p>The zero inflated possion regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMzeropoisson_mat(data, tau = 0.1, initial = NULL, initialtau = 'iteration',
                  tol = 1e-4, maxiter = 100, Madj = FALSE, m = NULL,
                  display = TRUE, intercept = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMzeropoisson_mat_+3A_data">data</code></td>
<td>
<p>A matrix with the first columns is y and the rest columns are x.</p>
</td></tr>
<tr><td><code id="EMzeropoisson_mat_+3A_tau">tau</code></td>
<td>
<p>Initial tau value to fit. Will be overwritten by the first value in <code>initial</code> argument.</p>
</td></tr>
<tr><td><code id="EMzeropoisson_mat_+3A_initial">initial</code></td>
<td>
<p>A list of initial values for the fitting. <code>c(tau beta)</code>.</p>
</td></tr>
<tr><td><code id="EMzeropoisson_mat_+3A_initialtau">initialtau</code></td>
<td>
<p>A character specifying the way to choose the initial value of tau at the beginning of EM iteration. <code>stable</code>: estimate tau from fitted beta in last round; <code>initial</code>: always use the initially assigned tau in <code>tau</code> or <code>initial</code>. Use the default tau = 0.1 if 'initial' is empty. <code>iteration</code>: use fitted tau in last round.</p>
</td></tr>
<tr><td><code id="EMzeropoisson_mat_+3A_tol">tol</code></td>
<td>
<p>Percentage of l2 norm change of [tau beta].</p>
</td></tr>
<tr><td><code id="EMzeropoisson_mat_+3A_maxiter">maxiter</code></td>
<td>
<p>Max iteration number.</p>
</td></tr>
<tr><td><code id="EMzeropoisson_mat_+3A_madj">Madj</code></td>
<td>
<p>If TRUE then adjust for relative library size M.</p>
</td></tr>
<tr><td><code id="EMzeropoisson_mat_+3A_m">m</code></td>
<td>
<p>A vector containing relative library size M.</p>
</td></tr>
<tr><td><code id="EMzeropoisson_mat_+3A_display">display</code></td>
<td>
<p>If TRUE display the fitting procedure.</p>
</td></tr>
<tr><td><code id="EMzeropoisson_mat_+3A_intercept">intercept</code></td>
<td>
<p>If TRUE then the model contains an intercept.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the coefficients in a new type of zero-inflated Poisson regression where the underlying Poisson rate is negatively associated with true zero probability.
</p>


<h3>Value</h3>

<p>The function turns a matrix. Each row is fitted value in each iteration. The last row the final result. The first column is fitted tau. If <code>intercept</code> is ture, then the second column is the intercept, and the rest columns are other coefficients. If <code>intercept</code> is false, the rest columns are other coefficients.
</p>


<h3>Author(s)</h3>

<p>Tianchen Xu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 5000;
x1 = rnorm(n);
x2 = rnorm(n);
lam = exp(x1 - 2*x2 + 1.5);
y = rpois(n, lam)
tau = .75
p = 1/(1+lam^tau);
Z = rbinom(n, 1, p);
y[as.logical(Z)] = 0;

res = EMzeropoisson_mat(matrix(c(y,x1,x2),ncol=3), Madj = FALSE, intercept = TRUE)

</code></pre>

<hr>
<h2 id='X'>
A simulated data X.
</h2><span id='topic+X'></span>

<h3>Description</h3>

<p>For exmaple run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("X")</code></pre>


<h3>Format</h3>

<p>The format is:
int [1:200, 1:100] 1 1 1 0 0 0 0 0 0 2 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : NULL
..$ : chr [1:100] &quot;V1&quot; &quot;V2&quot; &quot;V3&quot; &quot;V4&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(X)
</code></pre>

<hr>
<h2 id='ZIPFA'>Zero Inflated Poisson factor analysis
</h2><span id='topic+ZIPFA'></span>

<h3>Description</h3>

<p>To conduct a Zero Inflated Poisson factor analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ZIPFA(X, k, tau = 0.1, cut = 0.8, tolLnlikelihood = 5e-4,
        iter = 20, tol = 1e-4, maxiter = 100, initialtau = 'iteration',
        Madj = TRUE, display = TRUE, missing = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ZIPFA_+3A_x">X</code></td>
<td>
<p>The matrix to be decomposed.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_k">k</code></td>
<td>
<p>The number of factors.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_tau">tau</code></td>
<td>
<p>Initial tau value to fit. Will be overwritten by the first value in <code>initial</code> argument.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_cut">cut</code></td>
<td>
<p>To delete columns that has more than 100('<code>Cut</code>')% zeros. <code>Cut = 1</code>, if no filtering.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_tollnlikelihood">tolLnlikelihood</code></td>
<td>
<p>The max percentage of log likelihood differences in two iterations.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_iter">iter</code></td>
<td>
<p>Max iterations.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_initialtau">initialtau</code></td>
<td>
<p>A character specifying the way to choose the initial value of tau at the beginning of EM iteration. <code>stable</code>: estimate tau from fitted beta in last round; <code>initial</code>: always use the initially assigned tau in <code>tau</code> or <code>initial</code>. Use the default tau = 0.1 if 'initial' is empty. <code>iteration</code>: use fitted tau in last round.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_tol">tol</code></td>
<td>
<p>Percentage of l2 norm change of [tau beta].</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_maxiter">maxiter</code></td>
<td>
<p>Max iteration number in the zero inflated poisson regression.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_madj">Madj</code></td>
<td>
<p>If TRUE then adjust for relative library size M.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_display">display</code></td>
<td>
<p>If TRUE display the fitting procedure.</p>
</td></tr>
<tr><td><code id="ZIPFA_+3A_missing">missing</code></td>
<td>
<p>Reserved for <code>cv_ZIPFA</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function conducts a zero-inflated Poisson factor analysis where the underlying Poisson rate is negatively associated with true zero probability.
</p>


<h3>Value</h3>

<table>
<tr><td><code>tau</code></td>
<td>
<p>Fitted tau value.</p>
</td></tr>
<tr><td><code>Ufit</code></td>
<td>
<p>A list containing fitted U matrix in each iteration. The last one is the final fit. </p>
</td></tr>
<tr><td><code>Vfit</code></td>
<td>
<p>A list containing fitted V matrix in each iteration. The last one is the final fit. </p>
</td></tr>
<tr><td><code>itr</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code>Likelihood</code></td>
<td>
<p>The likelihood for the training data.</p>
</td></tr>
<tr><td><code>CVLikelihood</code></td>
<td>
<p>The likelihood for the testing data (if applicable)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tianchen Xu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(X)
ZIPFA(X, k = 3)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
