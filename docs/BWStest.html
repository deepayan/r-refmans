<!DOCTYPE html><html><head><title>Help for package BWStest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BWStest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BWStest-package'><p>Baumgartner Weiss Schindler test of equal distributions.</p></a></li>
<li><a href='#bws_cdf'><p>CDF of the Baumgartner-Weiss-Schindler test under the null.</p></a></li>
<li><a href='#bws_stat'><p>Compute the test statistic of the Baumgartner-Weiss-Schindler test.</p></a></li>
<li><a href='#bws_test'><p>Perform the Baumgartner-Weiss-Schindler hypothesis test.</p></a></li>
<li><a href='#BWStest-NEWS'><p>News for package 'BWStest':</p></a></li>
<li><a href='#murakami_cdf'><p>Murakami test statistic distribution.</p></a></li>
<li><a href='#murakami_stat'><p>Compute Murakami's test statistic.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Steven E. Pav &lt;shabbychef@gmail.com&gt;</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-10</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>Title:</td>
<td>Baumgartner Weiss Schindler Test of Equal Distributions</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/shabbychef/BWStest/issues">https://github.com/shabbychef/BWStest/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Performs the 'Baumgartner-Weiss-Schindler' two-sample test of equal
   probability distributions, &lt;<a href="https://doi.org/10.2307%2F2533862">doi:10.2307/2533862</a>&gt;. Also performs
   similar rank-based tests for equal probability distributions due to
   Neuhauser &lt;<a href="https://doi.org/10.1080%2F10485250108832874">doi:10.1080/10485250108832874</a>&gt; and
   Murakami &lt;<a href="https://doi.org/10.1080%2F00949655.2010.551516">doi:10.1080/00949655.2010.551516</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>memoise, Rcpp (&ge; 0.12.3)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/shabbychef/BWStest">https://github.com/shabbychef/BWStest</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'BWStest.r' 'RcppExports.R' 'bws_test.r' 'zzz_murakami_dist.r'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-10 23:27:55 UTC; spav</td>
</tr>
<tr>
<td>Author:</td>
<td>Steven E. Pav <a href="https://orcid.org/0000-0002-4197-6195"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-10 23:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='BWStest-package'>Baumgartner Weiss Schindler test of equal distributions.</h2><span id='topic+BWStest-package'></span>

<h3>Description</h3>

<p>Baumgartner Weiss Schindler test.
</p>


<h3>Background</h3>

<p>The Baumgartner Weiss Schindler test is a two sample test of the null 
that the samples come from the same probability distribution, similar
to the Kolmogorv-Smirnov, Wilcoxon, and Cramer-Von Mises tests. It is
similar to the Cramer-Von Mises test in that it estimates the
square norm of the difference in CDFs of the two samples. However, the
Baumgartner Weiss Schindler test weights the integral by the variance
of the difference in CDFs, &quot;[emphasizing] the tails of the distributions,
which increases the power of the test for a lot of applications.&quot;
</p>


<h3>Legal Mumbo Jumbo</h3>

<p>BWStest is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>W. Baumgartner, P. Weiss, H. Schindler, 'A nonparametric test for the general two-sample problem', 
Biometrics 54, no. 3 (Sep., 1998): pp. 1129-1135. 
<a href="https://doi.org/10.2307/2533862">doi:10.2307/2533862</a>
</p>
<p>M. Neuhauser, 'Exact tests based on the Baumgartner-Weiss-Schindler Statistic&ndash;a survey', 
Statistical Papers 46, no. 1 (2005): pp. 1-30.
<a href="https://doi.org/10.1007/BF02762032">doi:10.1007/BF02762032</a>
</p>
<p>M. Neuhauser, 'One-sided two-sample and trend tests based on a modified 
Baumgartner-Weiss-Schindler statistic', J. Nonparametric Statistics 13, no.
5 (2001): pp 729-739.
<a href="https://doi.org/10.1080/10485250108832874">doi:10.1080/10485250108832874</a>
</p>
<p>H. Murakami, 'K-sample rank test based on modified Baumgartner statistic and
its power comparison', J. Jpn. Comp. Statist. 19, no. 1 (2006): pp. 1-13.
<a href="https://doi.org/10.5183/jjscs1988.19.1">doi:10.5183/jjscs1988.19.1</a>
</p>
<p>H. Murakami, 'Modified Baumgartner Statistics for the two-sample and
multisample problems: a numerical comparison', J. Stat. Comp. and Sim.
82, no. 5 (2012): pp. 711-728.
<a href="https://doi.org/10.1080/00949655.2010.551516">doi:10.1080/00949655.2010.551516</a>
</p>
<p>H. Murakami, 'Lepage type statistic based on the modified Baumgartner statistic',
Comp. Stat. &amp; Data Analysis 51 (2007): pp 5061-5067. 
<a href="https://doi.org/10.1016/j.csda.2006.04.026">doi:10.1016/j.csda.2006.04.026</a>
</p>

<hr>
<h2 id='bws_cdf'>CDF of the Baumgartner-Weiss-Schindler test under the null.</h2><span id='topic+bws_cdf'></span>

<h3>Description</h3>

<p>Computes the CDF of the Baumgartner-Weiss-Schindler test statistic under the
null hypothesis of equal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bws_cdf(b, maxj = 5L, lower_tail = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bws_cdf_+3A_b">b</code></td>
<td>
<p>a vector of BWS test statistics.</p>
</td></tr>
<tr><td><code id="bws_cdf_+3A_maxj">maxj</code></td>
<td>
<p>the maximum value of j to take in the approximate computation
of the CDF via equation (2.5). Baumgartner <em>et. al.</em> claim that a
value of 3 is sufficient.</p>
</td></tr>
<tr><td><code id="bws_cdf_+3A_lower_tail">lower_tail</code></td>
<td>
<p>boolean, when <code>TRUE</code> returns <code class="reqn">\Psi</code>, otherwise
compute the upper tail, <code class="reqn">1-\Psi</code>, which is more useful for hypothesis tests.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given value <code class="reqn">b</code>, computes the CDF of the BWS statistic under
the null, denoted as <code class="reqn">\Psi(b)</code> by 
Baumgartner <em>et al.</em>  The CDF is computed from 
equation (2.5) via numerical quadrature.
</p>
<p>The expression for the CDF contains the integral
</p>
<p style="text-align: center;"><code class="reqn">\int_0^1 \frac{1}{\sqrt{r^3 (1-r)}} \mathrm{exp}\left(\frac{rb}{8} - \frac{\pi^2 (4j+1)^2}{8rb}\right) \mathrm{dr}</code>
</p>

<p>By making the change of variables <code class="reqn">x = 2r - 1</code>, this can
be re-expressed as an integral of the form
</p>
<p style="text-align: center;"><code class="reqn">\int_{-1}^1 \frac{1}{\sqrt{1-x^2}} f(x) \mathrm{dx},</code>
</p>

<p>for some function <code class="reqn">f(x)</code> involving <code class="reqn">b</code> and <code class="reqn">j</code>. 
This integral can be approximated
via Gaussian quadrature using Chebyshev nodes (of the first kind), which
is the approach we take here.
</p>


<h3>Value</h3>

<p>A vector of the CDF of <code class="reqn">b</code>, <code class="reqn">\Psi(b)</code>.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>W. Baumgartner, P. Weiss, H. Schindler, 'A nonparametric test for the general two-sample problem', 
Biometrics 54, no. 3 (Sep., 1998): pp. 1129-1135. 
<a href="https://doi.org/10.2307/2533862">doi:10.2307/2533862</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bws_stat">bws_stat</a></code>, <code><a href="#topic+bws_test">bws_test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# do it 500 times
set.seed(123)
bvals &lt;- replicate(500, bws_stat(rnorm(50),rnorm(50)))
pvals &lt;- bws_cdf(bvals)
# these should be uniform!
 
  plot(ecdf(pvals)) 


# compare to Table 1 of Baumgartner et al.
bvals &lt;- c(1.933,2.493,3.076,3.880,4.500,5.990)
tab1v &lt;- c(0.9,0.95,0.975,0.990,0.995,0.999)
pvals &lt;- bws_cdf(bvals,lower_tail=TRUE)
show(data.frame(B=bvals,BWS_psi=tab1v,our_psi=pvals))

</code></pre>

<hr>
<h2 id='bws_stat'>Compute the test statistic of the Baumgartner-Weiss-Schindler test.</h2><span id='topic+bws_stat'></span>

<h3>Description</h3>

<p>Compute the Baumgartner-Weiss-Schindler test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bws_stat(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bws_stat_+3A_x">x</code></td>
<td>
<p>a vector.</p>
</td></tr>
<tr><td><code id="bws_stat_+3A_y">y</code></td>
<td>
<p>a vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given vectors <code class="reqn">X</code> and <code class="reqn">Y</code>, computes <code class="reqn">B_X</code> and <code class="reqn">B_Y</code> as
described by Baumgartner <em>et al.</em>, returning their average, <code class="reqn">B</code>.
The test statistic approximates the variance-weighted square norm of the
difference in CDFs of the two distributions. For sufficiently large sample
sizes (more than 20, say), under the null the test statistic approaches the asymptotic
value computed in <code><a href="#topic+bws_cdf">bws_cdf</a></code>.
</p>
<p>The test value is an approximation of
</p>
<p style="text-align: center;"><code class="reqn">\tilde{B} = \frac{mn}{m+n} \int_0^1 \frac{1}{z(1-z)} \left(F_X(z) - F_Y(z)\right)^2 \mathrm{dz},</code>
</p>

<p>where <code class="reqn">m</code> (<code class="reqn">n</code>) is the number of elements in <code class="reqn">X</code> (<code class="reqn">Y</code>), and
<code class="reqn">F_X(z)</code> (<code class="reqn">F_Y(z)</code>) is the CDF of <code class="reqn">X</code> (<code class="reqn">Y</code>).
</p>
<p>The test statistic is based only on the ranks of the input. If the same
monotonic transform is applied to both vectors, the result should be unchanged.
Moreover, the test is inherently two-sided, so swapping <code class="reqn">X</code> and <code class="reqn">Y</code>
should also leave the test statistic unchanged.
</p>


<h3>Value</h3>

<p>The BWS test statistic, <code class="reqn">B</code>.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>W. Baumgartner, P. Weiss, H. Schindler, 'A nonparametric test for the general two-sample problem', 
Biometrics 54, no. 3 (Sep., 1998): pp. 1129-1135. 
<a href="https://doi.org/10.2307/2533862">doi:10.2307/2533862</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bws_cdf">bws_cdf</a></code>, <code><a href="#topic+bws_test">bws_test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234)
x &lt;- runif(1000)
y &lt;- runif(100)
bval &lt;- bws_stat(x,y)
# check a monotonic transform:
ftrans &lt;- function(x) { log(1 + x) }
bval2 &lt;- bws_stat(ftrans(x),ftrans(y))
stopifnot(all.equal(bval,bval2))
# check commutivity
bval3 &lt;- bws_stat(y,x)
stopifnot(all.equal(bval,bval3))

</code></pre>

<hr>
<h2 id='bws_test'>Perform the Baumgartner-Weiss-Schindler hypothesis test.</h2><span id='topic+bws_test'></span>

<h3>Description</h3>

<p>Perform the Baumgartner-Weiss-Schindler hypothesis test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bws_test(
  x,
  y,
  method = c("default", "BWS", "Neuhauser", "B1", "B2", "B3", "B4", "B5"),
  alternative = c("two.sided", "greater", "less")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bws_test_+3A_x">x</code></td>
<td>
<p>a vector of the first sample.</p>
</td></tr>
<tr><td><code id="bws_test_+3A_y">y</code></td>
<td>
<p>a vector of the second sample.</p>
</td></tr>
<tr><td><code id="bws_test_+3A_method">method</code></td>
<td>
<p>a character string specifying the test statistic to use.
should be one of the following:
</p>

<dl>
<dt>default</dt><dd><p>This is &ldquo;Hobson's choice&rdquo;, which uses the classical
BWS test for two-sided alternative, but Neuhauser for one sided
alternatives.</p>
</dd>
<dt>BWS</dt><dd><p>Use the classical BWS test.</p>
</dd>
<dt>Neuhauser</dt><dd><p>Use Neuhauser's test.</p>
</dd>
<dt>B1</dt><dd><p>Use Murakami's <code class="reqn">B_1</code> test.</p>
</dd>
<dt>B2</dt><dd><p>Use Murakami's <code class="reqn">B_2</code> test, which is exactly Neuhauser's test.</p>
</dd>
<dt>B3</dt><dd><p>Use Murakami's <code class="reqn">B_3</code> test.</p>
</dd>
<dt>B4</dt><dd><p>Use Murakami's <code class="reqn">B_4</code> test.</p>
</dd>
<dt>B5</dt><dd><p>Use Murakami's <code class="reqn">B_5</code> test.</p>
</dd>
</dl>

<p>Only Neuhauser's test supports one-sided alternatives.</p>
</td></tr>
<tr><td><code id="bws_test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &ldquo;two.sided&rdquo; (default), &ldquo;greater&rdquo; or
&ldquo;less&rdquo;. You can specify just the initial letter.
&ldquo;greater&rdquo; corresponds to testing whether the survival function
of <code>x</code> is greater than that of <code>y</code>; equivalently one can
think of this as <code>x</code> being &lsquo;greater&rsquo; than <code>y</code>
in the sense of first order stochastic dominance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>htest</code>, a list of the test statistic,
the p-value, and the <code>method</code> noted.
</p>


<h3>Note</h3>

<p>The code will happily compute Murakami's <code class="reqn">B_3</code> through <code class="reqn">B_5</code>
for large sample sizes, even though nominal coverage is <em>not</em> achieved.
A warning will be thrown. User assumes all risk relying on results from this
function.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>W. Baumgartner, P. Weiss, H. Schindler, 'A nonparametric test for the general two-sample problem', 
Biometrics 54, no. 3 (Sep., 1998): pp. 1129-1135. 
<a href="https://doi.org/10.2307/2533862">doi:10.2307/2533862</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bws_test">bws_test</a></code>, <code><a href="#topic+bws_stat">bws_stat</a></code>,
<code><a href="#topic+murakami_stat">murakami_stat</a></code>, <code><a href="#topic+murakami_cdf">murakami_cdf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# under the null
set.seed(123)
x &lt;- rnorm(100)
y &lt;- rnorm(100)
hval &lt;- bws_test(x,y)

# under the alternative
set.seed(123)
x &lt;- rnorm(100)
y &lt;- rnorm(100,mean=1.0)
hval &lt;- bws_test(x,y)
show(hval)
stopifnot(hval$p.value &lt; 0.05)

# under the alternative with a one sided test.
set.seed(123)
x &lt;- rnorm(100)
y &lt;- rnorm(100,mean=0.7)
hval &lt;- bws_test(x,y,alternative='less')
show(hval)
stopifnot(hval$p.value &lt; 0.01)

hval &lt;- bws_test(x,y,alternative='greater')
stopifnot(hval$p.value &gt; 0.99)

hval &lt;- bws_test(x,y,alternative='two.sided')
stopifnot(hval$p.value &lt; 0.05)

</code></pre>

<hr>
<h2 id='BWStest-NEWS'>News for package 'BWStest':</h2><span id='topic+BWStest-NEWS'></span>

<h3>Description</h3>

<p>News for package 'BWStest'
</p>





<h3><a href="https://github.com/shabbychef/BWStest"></a> Version 0.2.3 (2023-10-10) </h3>


<ul>
<li><p> Update doi links.
</p>
</li></ul>



<h3><a href="https://github.com/shabbychef/BWStest"></a> Version 0.2.2 (2018-10-17) </h3>


<ul>
<li><p> Package maintenance&ndash;no new features.
</p>
</li></ul>



<h3><a href="https://github.com/shabbychef/BWStest"></a> Version 0.2.1 (2017-03-20) </h3>


<ul>
<li><p> Package maintenance&ndash;no new features.
</p>
</li>
<li><p> move github figures to location CRAN understands.
</p>
</li>
<li><p> package initialization mumbo jumbo, see Rcpp issue 636.
</p>
</li></ul>



<h3><a href="https://github.com/shabbychef/BWStest"></a> Version 0.2.0 (2016-04-29) </h3>


<ul>
<li><p> Adding Murakami statistics.
</p>
</li></ul>



<h3><a href="https://github.com/shabbychef/BWStest"></a> Version 0.1.0 (2016-04-07) </h3>


<ul>
<li><p> First CRAN release.
</p>
</li></ul>



<h3><a href="https://github.com/shabbychef/BWStest"></a> Initial Version 0.0.0 (2016-04-06) </h3>


<ul>
<li><p> Start work
</p>
</li></ul>


<hr>
<h2 id='murakami_cdf'>Murakami test statistic distribution.</h2><span id='topic+murakami_cdf'></span>

<h3>Description</h3>

<p>Estimates the CDF of the Murakami test statistics via permutations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>murakami_cdf(B, n1, n2, flavor = 0L, lower_tail = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="murakami_cdf_+3A_b">B</code></td>
<td>
<p>the Murakami test statistic or a vector of the same.</p>
</td></tr>
<tr><td><code id="murakami_cdf_+3A_n1">n1</code></td>
<td>
<p>number of elements in the first sample.</p>
</td></tr>
<tr><td><code id="murakami_cdf_+3A_n2">n2</code></td>
<td>
<p>number of elements in the second sample.</p>
</td></tr>
<tr><td><code id="murakami_cdf_+3A_flavor">flavor</code></td>
<td>
<p>the 'flavor' of the test statistic. See
<code><a href="#topic+murakami_stat">murakami_stat</a></code>.</p>
</td></tr>
<tr><td><code id="murakami_cdf_+3A_lower_tail">lower_tail</code></td>
<td>
<p>boolean, when <code>TRUE</code> returns the CDF, <code class="reqn">\Psi</code>, otherwise 
compute the upper tail, <code class="reqn">1-\Psi</code>, which is potentially more useful for hypothesis tests.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the Murakami test statistic <code class="reqn">B_j</code> for <code class="reqn">0 \le j \le 5</code>,
computes the CDF under the null that the two samples come from the same
distribution. The CDF is computed by permutation test and memoization.
</p>


<h3>Value</h3>

<p>a vector of the same size as <code>B</code> of the CDF under the null.
</p>


<h3>Note</h3>

<p>the CDF is approximately computed by evaluating the permutations up to
some reasonably small sample size (currently the cutoff is 9). When larger
sample sizes are used, the distribution of the test statistic may not
converge. This is apparently seen in flavors 3 through 5.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>W. Baumgartner, P. Weiss, H. Schindler, 'A nonparametric test for the general two-sample problem', 
Biometrics 54, no. 3 (Sep., 1998): pp. 1129-1135. 
<a href="https://doi.org/10.2307/2533862">doi:10.2307/2533862</a>
</p>
<p>M. Neuhauser, 'Exact tests based on the Baumgartner-Weiss-Schindler Statistic&ndash;a survey', 
Statistical Papers 46, no. 1 (2005): pp. 1-30.
<a href="https://doi.org/10.1007/BF02762032">doi:10.1007/BF02762032</a>
</p>
<p>M. Neuhauser, 'One-sided two-sample and trend tests based on a modified 
Baumgartner-Weiss-Schindler statistic', J. Nonparametric Statistics 13, no.
5 (2001): pp 729-739.
<a href="https://doi.org/10.1080/10485250108832874">doi:10.1080/10485250108832874</a>
</p>
<p>H. Murakami, 'K-sample rank test based on modified Baumgartner statistic and
its power comparison', J. Jpn. Comp. Statist. 19, no. 1 (2006): pp. 1-13.
<a href="https://doi.org/10.5183/jjscs1988.19.1">doi:10.5183/jjscs1988.19.1</a>
</p>
<p>H. Murakami, 'Modified Baumgartner Statistics for the two-sample and
multisample problems: a numerical comparison', J. Stat. Comp. and Sim.
82, no. 5 (2012): pp. 711-728.
<a href="https://doi.org/10.1080/00949655.2010.551516">doi:10.1080/00949655.2010.551516</a>
</p>
<p>H. Murakami, 'Lepage type statistic based on the modified Baumgartner statistic',
Comp. Stat. &amp; Data Analysis 51 (2007): pp 5061-5067. 
<a href="https://doi.org/10.1016/j.csda.2006.04.026">doi:10.1016/j.csda.2006.04.026</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+murakami_stat">murakami_stat</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# basic usage:
xv &lt;- seq(0,4,length.out=101)
yv &lt;- murakami_cdf(xv, n1=8, n2=6, flavor=1L)
plot(xv,yv)
zv &lt;- bws_cdf(xv)
lines(xv,zv,col='red')

# check under the null:

flavor &lt;- 1L
n1 &lt;- 8
n2 &lt;- 8
set.seed(1234)
Bvals &lt;- replicate(2000,murakami_stat(rnorm(n1),rnorm(n2),flavor))
# should be uniform:
plot(ecdf(murakami_cdf(Bvals,n1,n2,flavor)))


</code></pre>

<hr>
<h2 id='murakami_stat'>Compute Murakami's test statistic.</h2><span id='topic+murakami_stat'></span><span id='topic+murakami_stat_perms'></span>

<h3>Description</h3>

<p>Compute one of the modified Baumgartner-Weiss-Schindler test statistics proposed
by Murakami, or Neuhauser.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>murakami_stat(x, y, flavor = 0L)

murakami_stat_perms(nx, ny, flavor = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="murakami_stat_+3A_x">x</code></td>
<td>
<p>a vector of the first sample.</p>
</td></tr>
<tr><td><code id="murakami_stat_+3A_y">y</code></td>
<td>
<p>a vector of the second sample.</p>
</td></tr>
<tr><td><code id="murakami_stat_+3A_flavor">flavor</code></td>
<td>
<p>which &lsquo;flavor&rsquo; of test statistic.</p>
</td></tr>
<tr><td><code id="murakami_stat_+3A_nx">nx</code></td>
<td>
<p>the length of <code>x</code>, the first sample.</p>
</td></tr>
<tr><td><code id="murakami_stat_+3A_ny">ny</code></td>
<td>
<p>the length of <code>y</code>, the second sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given vectors <code class="reqn">X</code> and <code class="reqn">Y</code>, computes <code class="reqn">B_{jX}</code> and <code class="reqn">B_{jY}</code> 
for some <code class="reqn">j</code> as described by Murakami and by Neuhauser, returning either their 
their average or their average distance.
The test statistics approximate the weighted square norm of the
difference in CDFs of the two distributions. 
</p>
<p>The test statistic is based only on the ranks of the input. If the same
monotonic transform is applied to both vectors, the result should be unchanged.
</p>
<p>The various &lsquo;flavor&rsquo;s of test statistic are:
</p>

<dl>
<dt>0</dt><dd><p>The statistic of Baumgartner-Weiss-Schindler.</p>
</dd>
<dt>1</dt><dd><p>Murakami's <code class="reqn">B_1</code> statistic, from his 2006 paper.</p>
</dd>
<dt>2</dt><dd><p>Neuhauser's difference statistic, denoted by Murakami as <code class="reqn">B_2</code> in his 
2012 paper.</p>
</dd>
<dt>3</dt><dd><p>Murakami's <code class="reqn">B_3</code> statistic, from his 2012 paper.</p>
</dd>
<dt>4</dt><dd><p>Murakami's <code class="reqn">B_4</code> statistic, from his 2012 paper.</p>
</dd>
<dt>5</dt><dd><p>Murakami's <code class="reqn">B_5</code> statistic, from his 2012 paper, with a log weighting.</p>
</dd>
</dl>



<h3>Value</h3>

<p>The BWS test statistic, <code class="reqn">B_j</code>. For <code>murakami_stat_perms</code>, a vector of
the test statistics for <em>all</em> permutations of the input.
</p>


<h3>Note</h3>

<p><code>NA</code> and <code>NaN</code> are not yet dealt with!
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>W. Baumgartner, P. Weiss, H. Schindler, 'A nonparametric test for the general two-sample problem', 
Biometrics 54, no. 3 (Sep., 1998): pp. 1129-1135. 
<a href="https://doi.org/10.2307/2533862">doi:10.2307/2533862</a>
</p>
<p>M. Neuhauser, 'Exact tests based on the Baumgartner-Weiss-Schindler Statistic&ndash;a survey', 
Statistical Papers 46, no. 1 (2005): pp. 1-30.
<a href="https://doi.org/10.1007/BF02762032">doi:10.1007/BF02762032</a>
</p>
<p>M. Neuhauser, 'One-sided two-sample and trend tests based on a modified 
Baumgartner-Weiss-Schindler statistic', J. Nonparametric Statistics 13, no.
5 (2001): pp 729-739.
<a href="https://doi.org/10.1080/10485250108832874">doi:10.1080/10485250108832874</a>
</p>
<p>H. Murakami, 'K-sample rank test based on modified Baumgartner statistic and
its power comparison', J. Jpn. Comp. Statist. 19, no. 1 (2006): pp. 1-13.
<a href="https://doi.org/10.5183/jjscs1988.19.1">doi:10.5183/jjscs1988.19.1</a>
</p>
<p>H. Murakami, 'Modified Baumgartner Statistics for the two-sample and
multisample problems: a numerical comparison', J. Stat. Comp. and Sim.
82, no. 5 (2012): pp. 711-728.
<a href="https://doi.org/10.1080/00949655.2010.551516">doi:10.1080/00949655.2010.551516</a>
</p>
<p>H. Murakami, 'Lepage type statistic based on the modified Baumgartner statistic',
Comp. Stat. &amp; Data Analysis 51 (2007): pp 5061-5067. 
<a href="https://doi.org/10.1016/j.csda.2006.04.026">doi:10.1016/j.csda.2006.04.026</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bws_stat">bws_stat</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234)
x &lt;- runif(1000)
y &lt;- runif(100)
bval &lt;- murakami_stat(x,y,1)


nx &lt;- 6
ny &lt;- 5
# monte carlo
set.seed(1234)
repli &lt;- replicate(3000,murakami_stat(rnorm(nx),rnorm(ny),0L))
# under the null, perform the permutation test:
allem &lt;- murakami_stat_perms(nx,ny,0L)
plot(ecdf(allem)) 
lines(ecdf(repli),col='red') 


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
