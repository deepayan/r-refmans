<!DOCTYPE html><html><head><title>Help for package ensembleBMA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ensembleBMA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#brierScore'>
<p>Brier Scores</p></a></li>
<li><a href='#cdf'>
<p>Cummulative Distribution Function for ensemble forcasting models</p></a></li>
<li><a href='#combine'>
<p>Combine Compatible BMA Models</p></a></li>
<li><a href='#controlBMAgamma'>
<p>Control parameters for BMA wind speed modeling</p></a></li>
<li><a href='#controlBMAgamma0'>
<p>Control parameters for BMA precipitation modeling</p></a></li>
<li><a href='#controlBMAnormal'>
<p>Control parameters for BMA mixtures of normals</p></a></li>
<li><a href='#crps'>
<p>Continuous Ranked Probability Score</p></a></li>
<li><a href='#dateCheck'>
<p>Checks date format.</p></a></li>
<li><a href='#ensBMAtest'><p>Ensemble BMA Test Data Set</p></a></li>
<li><a href='#ensembleBMA'>
<p>BMA mixture model fit</p></a></li>
<li><a href='#ensembleBMAgamma'>
<p>BMA wind speed modeling</p></a></li>
<li><a href='#ensembleBMAgamma0'>
<p>BMA precipitation modeling</p></a></li>
<li><a href='#ensembleBMAnormal'>
<p>BMA mixture of normals modeling</p></a></li>
<li><a href='#ensembleData'>
<p>Create an ensembleData object</p></a></li>
<li><a href='#fitBMA'>
<p>BMA model fit to a training set</p></a></li>
<li><a href='#fitBMAgamma'>
<p>BMA wind speed model fit to a training set</p></a></li>
<li><a href='#fitBMAgamma0'>
<p>BMA precipitation model fit to a training set</p></a></li>
<li><a href='#fitBMAnormal'>
<p>BMA mixture of normals fit to a training set</p></a></li>
<li><a href='#julTOymdh'>
<p>Convert Julian dates to character format.</p></a></li>
<li><a href='#MAE'>
<p>Mean Absolute Error</p></a></li>
<li><a href='#modelParameters'>
<p>Extract model parameters</p></a></li>
<li><a href='#pit'>
<p>Probability Integral Transform for ensemble forcasting models</p></a></li>
<li><a href='#pitHist'>
<p>PIT Histogram</p></a></li>
<li><a href='#plot.ensembleBMA'>
<p>Plot the Predictive Distribution Function for ensemble forcasting models</p></a></li>
<li><a href='#plotProbcast'>
<p>Surface plots for forecast information.</p></a></li>
<li><a href='#prcpDJdata'>
<p>Precipitation Data</p></a></li>
<li><a href='#prcpFit'>
<p>BMA Model Fit to Precipitation Data</p></a></li>
<li><a href='#prcpGrid'>
<p>Gridded Ensemble Forecasts of Precipitation</p></a></li>
<li><a href='#quantileForecast'>
<p>Quantile forecasts at observation locations</p></a></li>
<li><a href='#srft'><p>Surface Temperature Ensemble Forecasts and Observations</p></a></li>
<li><a href='#srftGrid'><p>Gridded Surface Temperature Ensemble Forecasts</p></a></li>
<li><a href='#trainingData'>
<p>Extract Training Data</p></a></li>
<li><a href='#verifPlot'>
<p>Plot observations along with median, 10th and 90th percentile forecasts.</p></a></li>
<li><a href='#verifRankHist'>
<p>Verification Rank and Histogram</p></a></li>
<li><a href='#ymdhTOjul'>
<p>Convert to Julian dates.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>5.1.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-01</td>
</tr>
<tr>
<td>Title:</td>
<td>Probabilistic Forecasting using Ensembles and Bayesian Model
Averaging</td>
</tr>
<tr>
<td>Author:</td>
<td>Chris Fraley, Adrian E. Raftery, J. McLean Sloughter, Tilmann
        Gneiting, University of Washington.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chris Fraley &lt;fraley@u.washington.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), chron</td>
</tr>
<tr>
<td>Suggests:</td>
<td>fields, maps</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian Model Averaging to create probabilistic forecasts
        from ensemble forecasts and weather observations
 <a href="https://stat.uw.edu/sites/default/files/files/reports/2007/tr516.pdf">https://stat.uw.edu/sites/default/files/files/reports/2007/tr516.pdf</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-02 02:22:25 UTC; cfraley</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-02 07:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='brierScore'>
Brier Scores
</h2><span id='topic+brierScore'></span><span id='topic+brierScore.ensembleBMAgamma'></span><span id='topic+brierScore.ensembleBMAgamma0'></span><span id='topic+brierScore.ensembleBMAnormal'></span><span id='topic+brierScore.fitBMAgamma'></span><span id='topic+brierScore.fitBMAgamma0'></span><span id='topic+brierScore.fitBMAnormal'></span>

<h3>Description</h3>

<p>Computes Brier Scores for climatology, raw ensemble, and ensemble
forecasting models  given observation thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brierScore( fit, ensembleData, thresholds, dates = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brierScore_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="brierScore_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble
forecasts, verification observations and possibly dates. 
Missing values (indicated by <code>NA</code>) are allowed. \
This need not be the data used for the model <code>fit</code>, 
although it must include the same ensemble members.
</p>
</td></tr>
<tr><td><code id="brierScore_+3A_thresholds">thresholds</code></td>
<td>

<p>One or more threshold values for the Brier
score computations.
</p>
</td></tr>
<tr><td><code id="brierScore_+3A_dates">dates</code></td>
<td>

<p>The dates for which the Brier score will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitBMA</code>, 
which also ignores date information.
</p>
</td></tr> 
<tr><td><code id="brierScore_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame giving the Brier Scores for climatology 
(empirical distribution of the verifying observations),
ensemble (voting), and ensemble foreacsting models
for the specified thresholds. <br />
A logistic Brier score is also given for the <em>BMAgamma0</em> model.
</p>


<h3>References</h3>

<p>G. W. Brier,
Verification of forecasts expressed in terms of probability,
<em>Monthly Weather Review, 78:1&ndash;3, 1950</em>.
</p>
<p>T. Gneiting and A. E. Raftery, 
Strictly proper scoring rules, prediction and estimation, 
<em>Journal of the American Statistical Association 102:359&ndash;378, 2007.</em>
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMA">ensembleBMA</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")
  
  obs &lt;- paste("PCP24","obs", sep = ".")
  ens &lt;- paste("PCP24", ensMemNames, sep = ".")

  prcpTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs], 
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  prcpTestFit &lt;- ensembleBMAgamma0( prcpTestData, trainingDays = 30)

## End(Not run) 

  hist(prcpTestData$obs)

  brierScore(prcpTestFit, prcpTestData,
             thresholds = seq(from = 0, to = .5, by = .1))

</code></pre>

<hr>
<h2 id='cdf'>
Cummulative Distribution Function for ensemble forcasting models
</h2><span id='topic+cdf'></span><span id='topic+cdf.ensembleBMAgamma'></span><span id='topic+cdf.ensembleBMAgamma0'></span><span id='topic+cdf.ensembleBMAnormal'></span><span id='topic+cdf.fitBMAgamma'></span><span id='topic+cdf.fitBMAgamma0'></span><span id='topic+cdf.fitBMAnormal'></span><span id='topic+cdfBMAgamma'></span><span id='topic+cdfBMAgamma0'></span><span id='topic+cdfBMAnormal'></span>

<h3>Description</h3>

<p>Computes the cumulative distribution function (CDF)
of an ensemble forecasting model at observation locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf( fit, ensembleData, values, dates = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdf_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="cdf_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates. 
Missing values (indicated by <code>NA</code>) are allowed. \
This need not be the data used for the model <code>fit</code>, 
although it must include the same ensemble members. 
</p>
</td></tr>
<tr><td><code id="cdf_+3A_values">values</code></td>
<td>

<p>The vector of desired values at which the CDF of the ensemble
forecasting model is to be evaluated.
</p>
</td></tr>
<tr><td><code id="cdf_+3A_dates">dates</code></td>
<td>

<p>The dates for which the CDF will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitBMA</code>, 
which also ignores date information.
</p>
</td></tr>
<tr><td><code id="cdf_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is generic, and can be applied to any ensemble forecasting
model. <br />
Note the model may have been applied to a power transformation of the data,
but that information is included in the input <code>fit</code>, and
the output is transformed appropriately.
</p>


<h3>Value</h3>

<p>A vector of probabilities corresponding to the CDF at the desired values.
Useful for determining propability of freezing, precipitation, etc.
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155&ndash;1174, 2005</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley,
Probabilistic quantitative precipitation forecasting
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensemble and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMA">ensembleBMA</a></code>, 
<code><a href="#topic+fitBMA">fitBMA</a></code>, 
<code><a href="#topic+quantileForecast">quantileForecast</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")


## Not run: # R check
  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)

## End(Not run)

# for quick run only; use more training days for forecasting
  tempTestFit &lt;- ensembleBMAnormal( tempTestData[1:20,], trainingDays = 8)

  tempTestForc &lt;- quantileForecast( tempTestFit, tempTestData)
  range(tempTestForc)

  tempTestCDF &lt;- cdf( tempTestFit, tempTestData, 
                      values = seq(from=277, to=282, by = 1))

  tempTestCDF
</code></pre>

<hr>
<h2 id='combine'>
Combine Compatible BMA Models
</h2><span id='topic+combine'></span><span id='topic+combineCORE'></span><span id='topic+combine.ensembleBMAgamma'></span><span id='topic+combine.ensembleBMAgamma0'></span><span id='topic+combine.ensembleBMAnormal'></span>

<h3>Description</h3>

<p>Combines BMA models having the same characteristics for different dates. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine( x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine_+3A_x">x</code></td>
<td>

<p>An <code>ensembleBMA</code> model. 
</p>
</td></tr>
<tr><td><code id="combine_+3A_y">y</code></td>
<td>

<p>An <code>ensembleBMA</code> model having the same characteristics as
<code>x</code> except for dates.
</p>
</td></tr>
<tr><td><code id="combine_+3A_...">...</code></td>
<td>

<p>Other <code>ensembleBMA</code> models compatible with <code>x</code> and <code>y</code>.
</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>Input models are checked for compatibility, and entries from different
inputs having the same dates are eliminated. Dates are ordered
chronologically and ensemble members are ordered in the order in which
they occur in inout <code>x</code>.
</p>


<h3>Value</h3>

<p>An <code>ensembleBMA</code> model that merges the models from each input into 
a single model for the common dates.
</p>


<h3>References</h3>

<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensemble and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMA">ensembleBMA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")


  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  tempTestFit12 &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30,
                   dates = c("2008010100","2008010200"))

  tempTestFit34 &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30,
                   dates = c("2008010300","2008010400"))

## End(Not run)

# for quick run only; use more training days for forecasting
  tempTestFit12 &lt;- ensembleBMAnormal( tempTestData, trainingDays = 8,
                   dates = c("2008010100","2008010200"))

  tempTestFit34 &lt;- ensembleBMAnormal( tempTestData, trainingDays = 8.,
                   dates = c("2008010300","2008010400"))

  tempTestFit &lt;- combine( tempTestFit12, tempTestFit34)
</code></pre>

<hr>
<h2 id='controlBMAgamma'>
Control parameters for BMA wind speed modeling
</h2><span id='topic+controlBMAgamma'></span>

<h3>Description</h3>

<p>Specifies a list of values controling the Bayesian Model Averaging fit 
of a mixture of gammas to ensemble forecasts for wind speed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlBMAgamma(maxIter, tol, power = 1, startupSpeed = NULL, init, 
           optim.control = list(ndeps = rep( sqrt(.Machine$double.eps), 2)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlBMAgamma_+3A_maxiter">maxIter</code></td>
<td>

<p>An integer specifying an upper limit on the number of iterations'
for fitting  the BMA mixture via EM. The default is 
<code>Inf</code>, which sets no upper limit on the number of iterations, 
so that the convergence criterion based on <code>eps</code> is used.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma_+3A_tol">tol</code></td>
<td>

<p>A numeric convergence tolerance. The EM fit for the mixture of
gammas is terminated when the relative error in successive 
objective values in the M-step falls below <code>tol</code>.
The default is <code>sqrt(.Machine$double.eps)</code>, 
which is approximately <code>1.e-8</code> on IEEE compliant machines.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma_+3A_power">power</code></td>
<td>

<p>A scalar value giving the power by which the data will be
transformed to fit the model for mean of the observations.
The default is not to transform the data.
The untransformed forecast is used to fit the variance model.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma_+3A_startupspeed">startupSpeed</code></td>
<td>

<p>A scalar value giving a global value for the anemometer startup speed,
or the threshold below which a value of 0 is recorded. As this can
vary from station to station and network to network, it may be
preferable to include <code>startupSpeed</code> as part of the 
<code>ensembleData</code> object.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma_+3A_init">init</code></td>
<td>

<p>An optional list of initial values for variance coefficients
and weights. The default is to start with the variance coefficients
equal to 1, and with equal weights for each member of the ensemble.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma_+3A_optim.control">optim.control</code></td>
<td>

<p>Control parameters for the optim function used in the M-step of EM.
The default here is list(ndeps = rep( sqrt(.Machine$double.eps), 2)),
which assigns a smaller finite-difference step size than the
<code>optim</code> default of 1.e-3. To use the default control parameters for 
<code>optim</code>, set <code>optim.control=NULL</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list whose components are the input arguments and their assigned values. 
</p>


<h3>References</h3>

<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Ensemble Forecasting
using Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMAgamma">ensembleBMAgamma</a></code>, 
<code><a href="#topic+fitBMAgamma">fitBMAgamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")
  
  obs &lt;- paste("MAXWSP10","obs", sep = ".")
  ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")

  winsTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
   winsTestFit1 &lt;- ensembleBMAgamma(winsTestData, trainingDays = 30,
       control = controlBMAgamma(maxIter = 100, tol = 1.e-6,
   startupSpeed =1))

## End(Not run)

# for quick run only; use more training days for forecasting
   winsTestFit1 &lt;- ensembleBMAgamma(winsTestData[1:14,], trainingDays = 5,
      control = controlBMAgamma(maxIter = 100, tol = 1.e-6, startupSpeed = 1))
</code></pre>

<hr>
<h2 id='controlBMAgamma0'>
Control parameters for BMA precipitation modeling
</h2><span id='topic+controlBMAgamma0'></span>

<h3>Description</h3>

<p>Specifies a list of values controling the Bayesian Model Averaging fit 
of a mixture of gammas with a point mass at 0 to ensemble forecasts for
precipitation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlBMAgamma0(maxIter = Inf, tol = sqrt(.Machine$double.eps), 
                 power = (1/3), rainobs = 10, 
                 init = list(varCoefs = NULL, weights = NULL),
             optim.control = list(ndeps = rep( sqrt(.Machine$double.eps), 2)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlBMAgamma0_+3A_maxiter">maxIter</code></td>
<td>

<p>An integer specifying an upper limit on the number of iterations
for fitting  the BMA mixture via EM. The default is 
<code>Inf</code>, which sets no upper limit on the number of iterations, 
so that the convergence criterion based on <code>eps</code> is used.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma0_+3A_tol">tol</code></td>
<td>

<p>A numeric convergence tolerance. The EM fit for the mixture of
gammas is terminated when the relative error in successive 
objective values in the M-step falls below <code>tol</code>.
The default is <code>sqrt(.Machine$double.eps)</code>, 
which is approximately <code>1.e-8</code> on IEEE compliant machines.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma0_+3A_power">power</code></td>
<td>

<p>A scalar value giving the power by which the data will be
transformed to fit the models for the point mass at 0
and mean of nonzero observations. The default is to use the 1/3
power of the data.
The untransformed forecast is used to fit the variance model.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma0_+3A_rainobs">rainobs</code></td>
<td>

<p>An integer specifying a minimum number of observations with
nonzero precipitation in the training data. When necessary and
possible, the training period will be extended backward in
increments of days to meet the minimum requirement.
It is not possible to fit the BMA model for precipitation without
sufficient nonzero observations. The default minimum number is 10.
It many instances fewer nonzero observations may suffice, but it
could also be that more are needed to model precipitation in some
datasets.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma0_+3A_init">init</code></td>
<td>

<p>An optional list of initial values for variance coefficients
and weights. The default is to start with the variance coefficients
equal to 1, and with equal weights for each member of the ensemble.
</p>
</td></tr>
<tr><td><code id="controlBMAgamma0_+3A_optim.control">optim.control</code></td>
<td>

<p>Control parameters	for the	optim function used in the M-step of EM.
The default here is list(ndeps = rep( sqrt(.Machine$double.eps), 2)),
which assigns a smaller finite-difference step size than the
<code>optim</code> default of 1.e-3. To use the default control parameters for
<code>optim</code>, set <code>optim.control=NULL</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list whose components are the input arguments and their assigned values. 
</p>


<h3>References</h3>

<p>J. M. Sloughter, A. E. Raftery, T Gneiting and C. Fraley, 
Probabilistic quantitative precipitation forecasting 
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Ensemble Forecasting
using Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMAgamma0">ensembleBMAgamma0</a></code>, 
<code><a href="#topic+fitBMAgamma0">fitBMAgamma0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")
  
  obs &lt;- paste("PCP24","obs", sep = ".")
  ens &lt;- paste("PCP24", ensMemNames, sep = ".")

  prcpTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs], 
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  prcpTestFit1 &lt;- ensembleBMAgamma0( prcpTestData, trainingDays = 30,
       control = controlBMAgamma0(power = (1/4)))

## End(Not run)

# for quick run only; use more training days for forecasting
  prcpTestFit1 &lt;- ensembleBMAgamma0( prcpTestData[1:14,], trainingDays = 6,
       control = controlBMAgamma0(power = (1/4)))
</code></pre>

<hr>
<h2 id='controlBMAnormal'>
Control parameters for BMA mixtures of normals
</h2><span id='topic+controlBMAnormal'></span>

<h3>Description</h3>

<p>Specifies a list of values controling the Bayesian Model Averaging fit 
of a mixture of normals to ensemble forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlBMAnormal(maxIter, tol, equalVariance, biasCorrection, init) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlBMAnormal_+3A_maxiter">maxIter</code></td>
<td>

<p>An integer specifying an upper limit on the number of iterations
for fitting the BMA mixture via EM. The default is <code>Inf</code>, 
which sets no upper limit on the number of iterations, 
so that the convergence criterion based on <code>eps</code> is used.
</p>
</td></tr>
<tr><td><code id="controlBMAnormal_+3A_tol">tol</code></td>
<td>

<p>A numeric convergence tolerance. The EM fit for the mixture 
model is terminated when the relative error in successive 
objective values in the M-step falls below <code>tol</code>.
The default is <code>sqrt(.Machine$double.eps)</code>, 
which is approximately <code>1.e-8</code> on IEEE compliant machines.
</p>
</td></tr>
<tr><td><code id="controlBMAnormal_+3A_equalvariance">equalVariance</code></td>
<td>

<p>A logical value indicating whether or not the variances for
the mixture components should to be equal.
The default is to constrain them to be equal.
</p>
</td></tr>
<tr><td><code id="controlBMAnormal_+3A_biascorrection">biasCorrection</code></td>
<td>

<p>A character string describing the type of bias correction to be used.
</p>

<dl>
<dt><code>"regression"</code></dt><dd>
<p>The bias correction term is formed by regression on the forecast values 
(including an intercept).
</p>
</dd>
<dt><code>"additive"</code></dt><dd>
<p>The mean of the difference between observations 
and forecasts is used for bias correction.
</p>
</dd>
<dt><code>"none"</code></dt><dd>
<p>No bias correction.
</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="controlBMAnormal_+3A_init">init</code></td>
<td>

<p>An optional list of initial values for standard deviations 
and weights. The default is to start with all standard deviations
equal to 1, and with equal weights for each member of the ensemble.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list whose components are the input arguments and their assigned values. 
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155&ndash;1174, 2005</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensemble and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMAnormal">ensembleBMAnormal</a></code>, 
<code><a href="#topic+fitBMAnormal">fitBMAnormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  tempTestFit1 &lt;- ensembleBMAnormal(tempTestData, trainingDays = 30,
    control = controlBMAnormal(maxIter = 100, biasCorrection = "additive"))

## End(Not run)

# for quick run only; use more training days for forecasting
  tempTestFit1 &lt;- ensembleBMAnormal(tempTestData[1:20,], trainingDays = 5,
    control = controlBMAnormal(maxIter = 100, biasCorrection = "additive"))

</code></pre>

<hr>
<h2 id='crps'>
Continuous Ranked Probability Score
</h2><span id='topic+crps'></span><span id='topic+crps.ensembleBMAgamma'></span><span id='topic+crps.ensembleBMAgamma0'></span><span id='topic+crps.ensembleBMAnormal'></span><span id='topic+crps.ensembleBMAbvnormal'></span><span id='topic+crps.fitBMAgamma'></span><span id='topic+crps.fitBMAgamma0'></span><span id='topic+crps.fitBMAnormal'></span><span id='topic+crps.fitBMAbvnormal'></span><span id='topic+CRPS'></span><span id='topic+CRPS.default'></span>

<h3>Description</h3>

<p>Computes the continuous ranked probability score (CRPS)
for univariate ensemble forecasting models. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crps( fit, ensembleData, dates=NULL, nSamples=NULL, seed=NULL, ...)
CRPS( fit, ensembleData, dates=NULL, nSamples=NULL, seed=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crps_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="crps_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates. 
Missing values (indicated by <code>NA</code>) are allowed. \
This need not be the data used for the model <code>fit</code>, 
although it must include the same ensemble members. 
</p>
</td></tr>
<tr><td><code id="crps_+3A_nsamples">nSamples</code></td>
<td>

<p>The number of simulation samples for CRPS via simulation.
For the normal model, the default is analytic computation of the CRPS.
For the gamma model with a point mass at 0 (precipitation), 
the CRPS is always computed by simulation,
with default <code>nSamples = 10000</code>.
</p>
</td></tr>
<tr><td><code id="crps_+3A_seed">seed</code></td>
<td>

<p>Argument to <code>set.seed</code> for random number generation in simulation.
</p>
</td></tr>
<tr><td><code id="crps_+3A_dates">dates</code></td>
<td>

<p>The dates for which the CRPS will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitBMA</code>, 
which also ignores date information.
</p>
</td></tr>
<tr><td><code id="crps_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These methods are generic, and can be applied to all ensemble forecasting
models. <br />
For <code>gamma0</code> model for precipitation and the <code>gamma</code> model
for wind speed the CRPS is only available through simulation.
The default number of simulation samples is 10,000. <br />
Note that the <code>gamma0</code> model for precipitation and the
<code>gamma</code> model for wind speed may have been applied to a power
transformation of the data. <br />
For normal models for temperature and pressure, analytic computation 
of the CRPS is the default. CRPS will be computed via simulation for
normal models only if <code>nSamples</code> is set to a positive value. <br />
For the bivariate normal model for wind speed and direction, the
CRPS is computed for the marginal wind speed distribution.
</p>


<h3>Value</h3>

<p><code>crps</code> is a matrix giving the CRPS for each instance in the data
for both the raw ensemble and the median probabilistic forecast. <br />
<code>CRPS</code> is a vector giving the mean of the CRPS over all
instances for the raw ensemble and the median probabilistic forecast.
</p>


<h3>References</h3>

<p>T. Gneiting and A. E. Raftery,
Strictly proper scoring rules, prediction and estimation,
<em>Journal of the American Statistical Association 102:359&ndash;378, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMA">ensembleBMA</a></code>,
<code><a href="#topic+fitBMA">fitBMA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run: # R check
  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)

## End(Not run)

# for quick run only; use more training days for forecasting
  tempTestFit &lt;- ensembleBMAnormal( tempTestData[1:20,], trainingDays = 8)

  crpsValues &lt;- crps( tempTestFit, tempTestData)
  colMeans(crpsValues)

  CRPS( tempTestFit, tempTestData)
</code></pre>

<hr>
<h2 id='dateCheck'>
Checks date format.
</h2><span id='topic+dateCheck'></span><span id='topic+getHH'></span>

<h3>Description</h3>

<p>Checks that the character form of a vector of dates conforms to
YYYYMMDDHH or YYYYMMDD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dateCheck(YYYYMMDDHH)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dateCheck_+3A_yyyymmddhh">YYYYMMDDHH</code></td>
<td>

<p>A character vector (or its factor equivalent) of dates which
should be in the form YYYYMMDDHH or YYYYMMDD,
in which YYYY specifies the year, MM the month,
DD the day, and (optionally) HH the hour.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If both YYYYMMDDHH and YYYYMMDD are present,
the YYYYMMDD dates are assumed to be in error
even if HH == 00 for all of the longer dates. <br />
Requires the <code>chron</code> library.
</p>


<h3>Value</h3>

<p>A logical vector indicating whether or not each element of YYYYMMDDHH
has the correct format.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ymdhTOjul">ymdhTOjul</a>,<a href="#topic+julTOymdh">julTOymdh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   dateCheck(c("2008043000", "20080431", "20080501"))
</code></pre>

<hr>
<h2 id='ensBMAtest'>Ensemble BMA Test Data Set</h2><span id='topic+ensBMAtest'></span><span id='topic+tempTestFit'></span><span id='topic+prcpTestFit'></span><span id='topic+winsTestFit'></span>

<h3>Description</h3>

<p>This data set gives 48-hour forecasts for 2-m temperature,
precipitation accumulated over the last 24 hours, and maximum wind speed
at SeaTac (KSEA) and Portland (PDX) ariports in 2007/2008  initialized at 
00 hours UTC using a 12km grid. The forecasts are based on an 8 member 
version of the University of Washington mesoscale ensemble
(Grimit and Mass 2002; Eckel and Mass 2005). <br />
</p>


<h3>Format</h3>

<p>A data frame with 66 rows and 34 columns: <br />
<code>idate</code> the initialization date of each forecast/observation, 
format YYYYMMDDHH (categorical). <br />
<code>vdate</code> the validation date of each forecast/observation, 
format YYYYMMDDHH (categorical). <br />
<code>latitude</code>  the latitude of each forecast/observation (numeric). <br />
<code>longitude</code>  the longitude of each forecast/observation (numeric). <br />
<code>longitude</code>  the elevation (in meters) above sea level (numeric). <br />
<code>station</code> weather station identifier (categorical). <br />
<code>network</code> weather network identifier (categorical). 
<code>*.gfs,*.cmcg,*.eta,*.gasp,*.jma,*.ngps,*.tcwb</code> 
forecasts from the 8 members of the ensemble (numeric).
<code>*.obs</code> observed values for the weather parameters.
The prefix <code>*</code> is one of <code>T2</code> for temperature,
<code>PCP24</code> for precipitation, <code>MAXWSP10</code> for wind speed.<br />
</p>


<h3>Details</h3>

<p>Temperature is given in Kelvin. <br />
Precipitation amounts are quantized to hundredths of an inch. <br />
Maximum wind speed is defined as the maximum of the hourly
'instantaneous' wind speeds over the previous 18 hours, where an
hourly 'instantaneous' wind speed is a 2-minute average from the
period of two minutes before the hour to on the hour. <br />
The wind speed observations are measured at 10-m above the ground and
discretized when recorded by rounding to the
nearest meter per second. <br />
This is a small dataset provided for the purposes of testing.
Typically forecasting would be performed on much larger datasets.
</p>


<h3>References</h3>

<p>F. A. Eckel and C. F. Mass,
Effective mesoscale, short-range ensemble forecasting,
<em>Weather and Forecasting 20:328&ndash;350, 2005</em>.
</p>
<p>E. P. Grimit and C. F. Mass, 
Initial results of a mesoscale short-range ensemble forecasting system over
the Pacific Northwest, 
<em>Weather and Forecasting 17:192&ndash;205, 2002</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # R check

  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

#----------------------------------------------------------------------------

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)

  MAE( tempFit, tempTestData)
  CRPS( tempFit, tempTestData)

#----------------------------------------------------------------------------

  obs &lt;- paste("PCP24","obs", sep = ".")
  ens &lt;- paste("PCP24", ensMemNames, sep = ".")

  prcpTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs], 
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

  prcpTestFit &lt;- ensembleBMAgamma0( prcpTestData, trainingDays = 30)

  MAE( prcpTestFit, prcpTestData)
  CRPS( prcpTestFit, prcpTestData)

#----------------------------------------------------------------------------

  obs &lt;- paste("MAXWSP10","obs", sep = ".")
  ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")

  winsTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

   winsTestFit &lt;- ensembleBMAgamma(winsTestData, trainingDays = 30)

   MAE( winsTestFit, winsTestData)
   CRPS( winsTestFit, winsTestData)

## End(Not run)</code></pre>

<hr>
<h2 id='ensembleBMA'>
BMA mixture model fit
</h2><span id='topic+ensembleBMA'></span><span id='topic+getDates'></span><span id='topic+getExchangeable'></span><span id='topic+matchDates'></span><span id='topic+match2side'></span><span id='topic+modelDates'></span><span id='topic+modelDates.default'></span><span id='topic+modelMembers'></span><span id='topic+modelMembers.default'></span><span id='topic+matchEnsembleMembers'></span><span id='topic+matchEnsembleMembers.ensembleBMAgamma'></span><span id='topic+matchEnsembleMembers.ensembleBMAgamma0'></span><span id='topic+matchEnsembleMembers.ensembleBMAnormal'></span><span id='topic+matchEnsembleMembers.fitBMAgamma'></span><span id='topic+matchEnsembleMembers.fitBMAgamma0'></span><span id='topic+matchEnsembleMembers.fitBMAnormal'></span>

<h3>Description</h3>

<p>Fits a BMA mixture model to ensemble forecasts.
Allows specification of a model, training rule, and forecasting dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleBMA( ensembleData, trainingDays, dates = NULL, control = NULL,
             model = NULL, exchangeable = NULL, minCRPS = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleBMA_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with the 
corresponding verifying observations and their dates. 
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleBMA_+3A_dates">dates</code></td>
<td>

<p>The dates for which BMA forecasting models are desired. 
By default, this will be all dates in <code>ensembleData</code>
for which modeling is allowed given training rule.
</p>
</td></tr>
<tr><td><code id="ensembleBMA_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr>
<tr><td><code id="ensembleBMA_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. 
The default is <code>controlBMAnormal()</code> for normal models
and <code>controlBMAgamma0()</code> for gamma models with a point mass at 0.
</p>
</td></tr>
<tr><td><code id="ensembleBMA_+3A_model">model</code></td>
<td>

<p>A character string describing the BMA model to be fit. 
Current choices are <code>"normal"</code>, typically used for temperature 
or pressure data, and <code>"gamma0"</code>, 
typically used for precipitation data.
</p>
</td></tr>
<tr><td><code id="ensembleBMA_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The model fit will have equal weights and parameters within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
<tr><td><code id="ensembleBMA_+3A_mincrps">minCRPS</code></td>
<td>

<p>A logical variable indicating whether or not to add a postprocessing
step after a normal BMA fit to choose the standard deviation so as to
minimize the CRPS for the training data. This argument is used only
for normal models, and the default is to not do the CRPS minimization
for those models because it may require consderably more
computation time, expecially when there are many ensemble members.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If dates are specified in <code>dates</code> that cannot be forecast 
with the training rule, the corresponding BMA model parameter outputs will
be missing (<code>NA</code>) but not <code>NULL</code>. <br />
The training rule uses the number of days corresponding to its 
<code>length</code> regardless of whether or not the dates are consecutive.<br />
The following methods are available for the output of <code>ensembleBMA</code>:
<code>cdf</code>, <code>quantileForecast</code>,  <code>modelParameters</code>,  
<code>brierScore</code>, <code>crps</code>, <code>CRPS</code>  and <code>MAE</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>dateTable</code></td>
<td>

<p>The table of observations corresponding to the dates in <code>x</code>   
in chronological order.
</p>
</td></tr>
<tr><td><code>trainingDays</code></td>
<td>

<p>The number of days in the training period as specified in input.
</p>
</td></tr>
<tr><td><code>...</code></td>
<td>

<p>One or more components corresponding to fitted coefficients for the model.
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the mixture components for each ensemble
member at each date.
</p>
</td></tr>
<tr><td><code>power</code></td>
<td>

<p>A scalar value giving the power (if any) by which the data was
transformed for modeling.
The untransformed forecast is used to fit the variance model.
This is input as part of <code>control</code>,
and applies only to certain models.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian Model Averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155&ndash;1174, 2005</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley, 
Probabilistic quantitative precipitation forecasting 
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+ensembleBMAnormal">ensembleBMAnormal</a></code>, 
<code><a href="#topic+ensembleBMAgamma0">ensembleBMAgamma0</a></code>,
<code><a href="#topic+ensembleBMAgamma">ensembleBMAgamma</a></code>,
<code><a href="#topic+cdf">cdf</a></code>,
<code><a href="#topic+quantileForecast">quantileForecast</a></code>,
<code><a href="#topic+modelParameters">modelParameters</a></code>, 
<code><a href="#topic+brierScore">brierScore</a></code>,
<code><a href="#topic+crps">crps</a></code>,
<code><a href="#topic+MAE">MAE</a></code>,
<code><a href="#topic+controlBMAnormal">controlBMAnormal</a></code>,
<code><a href="#topic+controlBMAgamma0">controlBMAgamma0</a></code>,
<code><a href="#topic+controlBMAgamma">controlBMAgamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  tempTestFit &lt;- ensembleBMA( tempTestData, trainingDays = 30,
                              model = "normal")

## equivalent to
##    tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)

## End(Not run)

# for quick run only; use more training days for forecasting
  tempTestFit &lt;- ensembleBMA( tempTestData[1:20,], trainingDays = 8,
                              model = "normal")

  set.seed(0); exch &lt;- sample(1:length(ens),replace=TRUE)

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                exchangeable = exch,
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

# for quick run only; use more training days for forecasting
  tempTestFit &lt;- ensembleBMA( tempTestData[1:20,], trainingDays = 8,
                              model = "normal")
</code></pre>

<hr>
<h2 id='ensembleBMAgamma'>
BMA wind speed modeling 
</h2><span id='topic+ensembleBMAgamma'></span><span id='topic++5B.ensembleBMAgamma'></span>

<h3>Description</h3>

<p>Fits a Bayesian Model Averaging mixture of gammas
to ensemble forecasts. Intended for predicting wind speed. 
Allows specification of a training period and forecasting dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleBMAgamma( ensembleData, trainingDays, dates = NULL, 
                   control = controlBMAgamma(), exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleBMAgamma_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts 
with the corresponding verifying observations and their dates.
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleBMAgamma_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr>
<tr><td><code id="ensembleBMAgamma_+3A_dates">dates</code></td>
<td>

<p>The dates for which forecasting models are desired. 
By default, this will be all dates in <code>ensembleBMA</code> for which
modeling is allowed given the training rule.
</p>
</td></tr>
<tr><td><code id="ensembleBMAgamma_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. The defaults are
given by the function <code>controlBMAgamma0</code>.
</p>
</td></tr>
<tr><td><code id="ensembleBMAgamma_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The models fit will have equal weights and parameters within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output is for all of the <code>dates</code> in <code>ensembleBMA</code>, so there
will be missing entries denoted by <code>NA</code> for dates that are too recent 
to be forecast with  the training rule. <br />
The following methods are available for <code>ensembleBMAgamma0</code> objects:
<code>cdf</code>, <code>quantileForecast</code>,   <code>modelParameters</code>, 
<code>brierScore</code>, <code>crps</code>, <code>CRPS</code> and <code>MAE</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling day.
</p>
</td></tr>
<tr><td><code>prob0coefs</code></td>
<td>

<p>The fitted coefficients in the model for the point mass at 0 
(probability of zero precipitaion) for each member of the ensemble 
at each date. 
</p>
</td></tr>
<tr><td><code>biasCoefs</code></td>
<td>

<p>The fitted coefficients in the model for the mean of the gamma components
for each member of the ensemble at each date (bias correction).
</p>
</td></tr>
<tr><td><code>varCoefs</code></td>
<td>

<p>The fitted coefficients for the model for the variance of gamma
components for each date.
The coefficients are the same for all members of the ensemble.
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the gamma components for each ensemble member at each date.
</p>
</td></tr>
<tr><td><code>power</code></td>
<td>

<p>A scalar value giving to the power by which the data was transformed
to fit the models for the  point mass at 0 and the bias model. 
The untransformed forecast is used to fit the variance model.
This is input as part of <code>control</code>.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+controlBMAgamma">controlBMAgamma</a></code>, 
<code><a href="#topic+fitBMAgamma">fitBMAgamma</a></code>,
<code><a href="#topic+cdf">cdf</a></code>,
<code><a href="#topic+quantileForecast">quantileForecast</a></code>,
<code><a href="#topic+modelParameters">modelParameters</a></code>,
<code><a href="#topic+brierScore">brierScore</a></code>,
<code><a href="#topic+crps">crps</a></code>,
<code><a href="#topic+MAE">MAE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")
  
  obs &lt;- paste("MAXWSP10","obs", sep = ".")
  ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")

  winsTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  winsTestFit &lt;- ensembleBMAgamma(winsTestData, trainingDays = 30, 
                                  control = controlBMAgamma(startupSpeed = 1))

## equivalent to
##     winsTestFit &lt;- ensembleBMA(winsTestData, trainingDays = 30,
##                                model = "gamma")

## End(Not run)

# for quick run only; use more training days for forecasting
   winsTestFit &lt;- ensembleBMAgamma(winsTestData[1:14,], trainingDays = 5,
                            control = controlBMAgamma(startupSpeed = 1))
</code></pre>

<hr>
<h2 id='ensembleBMAgamma0'>
BMA precipitation modeling 
</h2><span id='topic+ensembleBMAgamma0'></span><span id='topic++5B.ensembleBMAgamma0'></span>

<h3>Description</h3>

<p>Fits a Bayesian Model Averaging mixture of gammas with a point mass at 0 
to ensemble forecasts. Intended for predicting precipitation. 
Allows specification of a training rule and forecasting dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleBMAgamma0( ensembleData, trainingDays, dates = NULL, 
                   control = controlBMAgamma0(), exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleBMAgamma0_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with the 
corresponding verifying observations and their dates. 
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleBMAgamma0_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr>
<tr><td><code id="ensembleBMAgamma0_+3A_dates">dates</code></td>
<td>

<p>The dates for which forecasting models are desired. 
By default, this will be all dates in <code>ensembleData</code> for which
modeling is allowed given the training rule.
</p>
</td></tr>
<tr><td><code id="ensembleBMAgamma0_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. The defaults are
given by the function <code>controlBMAgamma0</code>.
</p>
</td></tr>
<tr><td><code id="ensembleBMAgamma0_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The models fit will have equal weights and parameters within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output is for all of the <code>dates</code> in <code>ensembleBMA</code>, so there
will be missing entries denoted by <code>NA</code> for dates that are too recent 
to be forecast with  the training rule. <br />
The following methods are available for <code>ensembleBMAgamma0</code> objects:
<code>cdf</code>, <code>quantileForecast</code>,   <code>modelParameters</code>, 
<code>brierScore</code>, <code>crps</code>, <code>CRPS</code> and <code>MAE</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling day.
</p>
</td></tr>
<tr><td><code>prob0coefs</code></td>
<td>

<p>The fitted coefficients in the model for the point mass at 0 
(probability of zero precipitaion) for each member of the ensemble 
at each date. 
</p>
</td></tr>
<tr><td><code>biasCoefs</code></td>
<td>

<p>The fitted coefficients in the model for the mean of the gamma components
for each member of the ensemble at each date (bias correction).
</p>
</td></tr>
<tr><td><code>varCoefs</code></td>
<td>

<p>The fitted coefficients for the model for the variance of gamma
components for each date.
The coefficients are the same for all members of the ensemble.
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the gamma components for each ensemble member at each date.
</p>
</td></tr>
<tr><td><code>power</code></td>
<td>

<p>A scalar value giving to the power by which the data was transformed
to fit the models for the  point mass at 0 and the bias model. 
The untransformed forecast is used to fit the variance model.
This is input as part of <code>control</code>.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley, 
Probabilistic quantitative precipitation forecasting 
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+controlBMAgamma0">controlBMAgamma0</a></code>, 
<code><a href="#topic+fitBMAgamma0">fitBMAgamma0</a></code>,
<code><a href="#topic+cdf">cdf</a></code>,
<code><a href="#topic+quantileForecast">quantileForecast</a></code>,
<code><a href="#topic+modelParameters">modelParameters</a></code>,
<code><a href="#topic+brierScore">brierScore</a></code>,
<code><a href="#topic+crps">crps</a></code>,
<code><a href="#topic+MAE">MAE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")
  
  obs &lt;- paste("PCP24","obs", sep = ".")
  ens &lt;- paste("PCP24", ensMemNames, sep = ".")

  prcpTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs], 
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  prcpTestFit &lt;- ensembleBMAgamma0( prcpTestData, trainingDays = 30)

## equivalent to
##    prcpTestFit &lt;- ensembleBMA( prcpTestData, trainingDays = 30,
##                                model = "gamma0")

## End(Not run)

# for quick run only; use more training days for forecasting
  prcpTestFit &lt;- ensembleBMAgamma0( prcpTestData[3:16,], trainingDays = 6)
</code></pre>

<hr>
<h2 id='ensembleBMAnormal'>
BMA mixture of normals modeling
</h2><span id='topic+ensembleBMAnormal'></span><span id='topic++5B.ensembleBMAnormal'></span><span id='topic+crpsNormal'></span>

<h3>Description</h3>

<p>Fits a Bayesian Model Averaging mixture of normals to ensemble forecasts.
Allows specification of a training rule and forecasting dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleBMAnormal(ensembleData, trainingDays, dates = NULL, 
                  control = controlBMAnormal(), exchangeable = NULL,
                  minCRPS = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleBMAnormal_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with 
the corresponding verifying observations and their dates. 
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleBMAnormal_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr>
<tr><td><code id="ensembleBMAnormal_+3A_dates">dates</code></td>
<td>

<p>The dates for which BMA forecasting models are desired. 
By default, this will be all dates in <code>ensembleData</code>
for which modeling is allowed given the training rule.
</p>
</td></tr>
<tr><td><code id="ensembleBMAnormal_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. The defaults are
given by the function <code>controlBMAnormal</code>.
</p>
</td></tr>
<tr><td><code id="ensembleBMAnormal_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The modeling will have equal weights and parameters within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
<tr><td><code id="ensembleBMAnormal_+3A_mincrps">minCRPS</code></td>
<td>

<p>A logical variable indicating whether or not to add a postprocessing
step after the BMA fit to choose the standard deviation so as to
minimize the CRPS for the training data. The default is not to do
the CRPS minimization, because it can add considerable extra cost
to the computation, particularly when there are many ensemble members.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output is for all of the <code>dates</code> in <code>ensembleData</code>, so there
will be missing entries denoted by <code>NA</code> for dates that are too recent 
to be forecast with  the training rule. <br />
The following methods are available for <code>ensembleBMAnormal</code> objects:
<code>cdf</code>, <code>quantileForecast</code>, <code>modelParameters</code>,  
<code>brierScore</code>, <code>crps</code>, <code>CRPS</code> and <code>MAE</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling day.
</p>
</td></tr>
<tr><td><code>biasCoefs</code></td>
<td>

<p>The fitted bias-correction coefficients for each ensemble member at each date.
</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>

<p>The fitted standard deviations for the mixture of normals model
at each date.
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the normal components for each ensemble member at each date.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155-1174, 2005</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+controlBMAnormal">controlBMAnormal</a></code>, 
<code><a href="#topic+fitBMAnormal">fitBMAnormal</a></code>,
<code><a href="#topic+cdf">cdf</a></code>,
<code><a href="#topic+quantileForecast">quantileForecast</a></code>,
<code><a href="#topic+modelParameters">modelParameters</a></code>,
<code><a href="#topic+brierScore">brierScore</a></code>,
<code><a href="#topic+crps">crps</a></code>,
<code><a href="#topic+MAE">MAE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  #  R check
  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)

## equivalent to
##   tempTestFit &lt;- ensembleBMA( tempTestData, trainingDays = 30,
##                                model = "normal")

## End(Not run)

# for quick run only; use more training days for forecasting
 tempTestFit &lt;- ensembleBMAnormal( tempTestData[1:20,], trainingDays = 8)

</code></pre>

<hr>
<h2 id='ensembleData'>
Create an ensembleData object
</h2><span id='topic+ensembleData'></span><span id='topic+dataNA'></span><span id='topic+dataNobs'></span><span id='topic+dataObsLabels'></span><span id='topic+dataStartupSpeed'></span><span id='topic+dataVerifObs'></span><span id='topic+ensembleForecasts'></span><span id='topic+ensembleFhour'></span><span id='topic+ensembleGroups'></span><span id='topic+ensembleItime'></span><span id='topic+ensembleMembers'></span><span id='topic+ensembleSize'></span><span id='topic+ensembleValidDates'></span><span id='topic+dataObsLabels.ensembleData'></span><span id='topic+dataNA.ensembleData'></span><span id='topic+dataNobs.ensembleData'></span><span id='topic+dataStartupSpeed.ensembleData'></span><span id='topic+dataVerifObs.ensembleData'></span><span id='topic+ensembleMembers.ensembleData'></span><span id='topic+ensembleFhour.ensembleData'></span><span id='topic+ensembleForecasts.ensembleData'></span><span id='topic+ensembleGroups.ensembleData'></span><span id='topic+ensembleItime.ensembleData'></span><span id='topic+ensembleSize.ensembleData'></span><span id='topic+ensembleValidDates.ensembleData'></span><span id='topic++5B.ensembleData'></span><span id='topic+matchEnsembleMembers.default'></span><span id='topic+matchITandFH'></span><span id='topic+matchITandFH.default'></span><span id='topic+startupSpeed'></span><span id='topic+startupSpeed.ensembleData'></span>

<h3>Description</h3>

<p>Creates an <code>ensembleData</code> object including ensemble forecasts along
with dates and (optionally) observations. Other descriptive information
such as latitude, longitude, and station type may be included as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleData( forecasts, dates = NULL, observations = NULL, ...,
              forecastHour, initializationTime,
              startupSpeed = NULL, exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleData_+3A_forecasts">forecasts</code></td>
<td>

<p>A matrix or array (for vector quantities) 
with columns corresponding to forecasts from individual members 
of an ensemble and rows corresponding to forecasts for the same date.
</p>
</td></tr>
<tr><td><code id="ensembleData_+3A_dates">dates</code></td>
<td>

<p>A numeric or character vector or factor specifying the valid dates
for the forecasts. If numeric, it is interpreted as a Julian date
if it has an <code>origin</code> attribute specifying
the month, day, and year, e.g. <code>c(month = 1, day = 1, year = 2000)</code>.
Otherwise the character form of each date must be a string with format
format YYYYMMDDHH or YYYYMMDD, where YYYY is the year,
MM the monthn, DD the day, and (optionally) HH the hour.
</p>
</td></tr>
<tr><td><code id="ensembleData_+3A_observations">observations</code></td>
<td>

<p>Optional vector (or matrix for vector quantities) of observed weather 
conditions corresponding 
to the forecasts. Must be supplied if the data is to be
used for BMA modeling. 
</p>
</td></tr>
<tr><td><code id="ensembleData_+3A_...">...</code></td>
<td>

<p>A named list of additional attributes such as latitude,
longitude, and startupSpeed for wind speed.
</p>
</td></tr>
<tr><td><code id="ensembleData_+3A_forecasthour">forecastHour</code></td>
<td>

<p>A number giving the <em>forecast hour</em>, the time interval 
between the initialization and forecast times, in units of hours.
</p>
</td></tr>
<tr><td><code id="ensembleData_+3A_initializationtime">initializationTime</code></td>
<td>

<p>A number or character string giving the initialization time.
</p>
</td></tr>
<tr><td><code id="ensembleData_+3A_startupspeed">startupSpeed</code></td>
<td>

<p>A numeric value specifying a value  below which the anemometer
readings for wind speed will be recorded as zero. This value
is used for all stations when the startup speed is not explicity
specified as part of the data.
</p>
</td></tr>
<tr><td><code id="ensembleData_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of 
ensemble members that are exchangeable (indistinguishable).
The models fit will have equal weights and parameters
within each group.
The same names/labels should be used as for the forecasts.     
The default assumes that none of the ensemble members are
exhangeable.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use with  batch processing modeling functions (<code>ensembleBMA</code>
etc), instances <code>ensembleData</code> object are assumed
the same forecast hour and initialization time, which should be
specified as part of the object. <br />  
Methods for <code>ensembleData</code> objects include <code>ensembleSize</code>,
<code>ensembleForecasts</code>, <code>ensembleValidDates</code>. <br />
Subsetting is possible, but in the case of columns it applies only to
the ensemble forecasts. <br />
For vector wind computations, the velocity should be in the first 
column and the direction in the second.
</p>


<h3>Value</h3>

<p>An <code>ensembleData</code> object, incorporating forecasts and
(optionally) observations with the associated valid dates.
</p>


<h3>References</h3>

<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMA">ensembleBMA</a></code>, 
<code><a href="#topic+ensembleBMAgamma">ensembleBMAgamma</a></code>, 
<code><a href="#topic+ensembleBMAgamma0">ensembleBMAgamma0</a></code>, 
<code><a href="#topic+ensembleBMAnormal">ensembleBMAnormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")


  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check

  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)


## End(Not run)

  obs &lt;- paste("PCP24","obs", sep = ".")
  ens &lt;- paste("PCP24", ensMemNames, sep = ".")

  prcpTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs], 
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")
## Not run:  # R check

  prcpTestFit &lt;- ensembleBMAgamma0( prcpTestData, trainingDays = 30)


## End(Not run)

  obs &lt;- paste("MAXWSP10","obs", sep = ".")
  ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")

  winsTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check

 winsTestFit &lt;- ensembleBMAgamma(winsTestData, trainingDays = 30)


## End(Not run)

</code></pre>

<hr>
<h2 id='fitBMA'>
BMA model fit to a training set
</h2><span id='topic+fitBMA'></span>

<h3>Description</h3>

<p>Fits a Bayesian Modeling Averaging mixture model to a given training set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitBMA( ensembleData, control = NULL, model = NULL, exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitBMA_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and 
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included.  This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitBMA_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. 
The default is <code>controlBMAnormal()</code> for normal models
and <code>controlBMAgamma0()</code> for gamma models with a point mass at 0.
</p>
</td></tr>
<tr><td><code id="fitBMA_+3A_model">model</code></td>
<td>

<p>A character string describing the BMA model to be fit. 
Current choices are <code>"normal"</code> for temperature or pressure data,
and <code>"gamma0"</code> for precipitation data.
</p>
</td></tr>
<tr><td><code id="fitBMA_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The model fit will have equal weights and parameters 
within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a BMA model to a training data set. <br />
Methods available for <code>fitBMA</code> objects (the output of <code>fitBMA</code>)
include: <code>cdf</code>, <code>quantileForecast</code>, and
<code>modelParameters</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>...</code></td>
<td>

<p>One or more components corresponding to the coeffcients of the model.  
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the mixture components for each ensemble member.
</p>
</td></tr>
<tr><td><code>nIter</code></td>
<td>

<p>The number of EM iterations.
</p>
</td></tr>
<tr><td><code>power</code></td>
<td>

<p>A scalar value giving the power (if any) by which the data was transformed
for modeling.
The untransformed forecast is used to fit the variance model.
This is input as part of <code>control</code>,
and applies only to certain models.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155&ndash;1174, 2005</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley,
Probabilistic quantitative precipitation forecasting
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+ensembleBMA">ensembleBMA</a></code>,
<code><a href="#topic+fitBMAgamma">fitBMAgamma</a></code>, 
<code><a href="#topic+fitBMAgamma0">fitBMAgamma0</a></code>, 
<code><a href="#topic+fitBMAnormal">fitBMAnormal</a></code>, 
<code><a href="#topic+cdf">cdf</a></code>, 
<code><a href="#topic+quantileForecast">quantileForecast</a></code>, 
<code><a href="#topic+modelParameters">modelParameters</a></code>, 
<code><a href="#topic+controlBMAgamma">controlBMAgamma</a></code>,
<code><a href="#topic+controlBMAgamma0">controlBMAgamma0</a></code>,
<code><a href="#topic+controlBMAnormal">controlBMAnormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                dates = ensBMAtest[,"vdate"],
                                forecastHour = 48,
                                initializationTime = "00")

  tempTrain &lt;- trainingData( tempTestData, trainingDays = 30,
                             date  = "2008010100")

  tempTrainFit &lt;- fitBMA( tempTrain, model = "normal")

## equivalent to
##    tempTrainFit &lt;- fitBMAnormal( tempTrain)

  set.seed(0); exch &lt;- sample(1:length(ens),replace=TRUE)
  
  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                exchangeable = exch,
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                dates = ensBMAtest[,"vdate"],
                                forecastHour = 48,
                                initializationTime = "00")
</code></pre>

<hr>
<h2 id='fitBMAgamma'>
BMA wind speed model fit to a training set
</h2><span id='topic+fitBMAgamma'></span><span id='topic+inverseLogit'></span>

<h3>Description</h3>

<p>Fits a Bayesian Modeling Averaging mixture of gammas.
Intended for wind speed forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitBMAgamma( ensembleData, control = controlBMAgamma(), exchangeable = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitBMAgamma_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and 
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included. This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitBMAgamma_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. The defaults are
given by the function <code>controlBMAgamma</code>.
</p>
</td></tr>
<tr><td><code id="fitBMAgamma_+3A_exchangeable">exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The model fit will have equal weights and parameters within each group.
If supplied, this argument will override any specification of 
exchangeability in <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a BMA model to a training data set. <br />
It is called by <code>ensembleBMAgamma</code>, which can produce a sequence
of fits over a larger precipitation data set.  <br />
Methods available for the output of <code>fitBMA</code> include:
<code>cdf</code>, <code>quantileForecast</code>, and 
<code>modelParameters</code>. 
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>biasCoefs</code></td>
<td>

<p>The fitted coefficients in the model for the mean of nonzero observations
for each member of the ensemble (used for bias correction).
</p>
</td></tr>
<tr><td><code>varCoefs</code></td>
<td>

<p>The fitted coefficients for the model for the variance of nonzero 
observations (these are the same for all members of the ensemble).
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the gamma components for each ensemble member.
</p>
</td></tr>
<tr><td><code>nIter</code></td>
<td>

<p>The number of EM iterations.
</p>
</td></tr>
<tr><td><code>power</code></td>
<td>

<p>A scalar value giving to the power by which the data was transformed
to fit the models for the  point mass at 0 and the bias model. 
The untransformed forecast is used to fit the variance model.
This is input as part of <code>control</code>.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+controlBMAgamma">controlBMAgamma</a></code>, 
<code><a href="#topic+ensembleBMAgamma">ensembleBMAgamma</a></code>,
<code><a href="#topic+cdf">cdf</a></code>,
<code><a href="#topic+quantileForecast">quantileForecast</a></code>,
<code><a href="#topic+modelParameters">modelParameters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")
  
  obs &lt;- paste("MAXWSP10","obs", sep = ".")
  ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")

  winsTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                startupSpeed = 1,
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  winsTrain &lt;- trainingData( winsTestData, trainingDays = 30,
                             date = "2008010100")

## End(Not run)

# for quick run only; use more training days for forecasting
  winsTrain &lt;- trainingData( winsTestData, trainingDays = 10,
                             date = "2008010100")

  winsTrainFit &lt;- fitBMAgamma( winsTrain)

## equivalent to
##    winsTrainFit &lt;- fitBMA( winsTrain, model = "gamma")
</code></pre>

<hr>
<h2 id='fitBMAgamma0'>
BMA precipitation model fit to a training set
</h2><span id='topic+fitBMAgamma0'></span>

<h3>Description</h3>

<p>Fits a Bayesian Modeling Averaging mixture of gammas 
with a point mass at 0 to a given training set.
Intended for precipitation forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitBMAgamma0( ensembleData, control = controlBMAgamma0(), 
              exchangeable = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitBMAgamma0_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and 
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included. This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitBMAgamma0_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. The defaults are
given by the function <code>controlBMAgamma0</code>.
</p>
</td></tr>
<tr><td><code id="fitBMAgamma0_+3A_exchangeable">exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The model fit will have equal weights and parameters within each group.
If supplied, this argument will override any specification of 
exchangeability in <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a BMA model to a training data set. <br />
It is called by <code>ensembleBMAgamma0</code>, which can produce a sequence
of fits over a larger precipitation data set.  <br />
Methods available for the output of <code>fitBMA</code> include:
<code>cdf</code>, <code>quantileForecast</code>, and 
<code>modelParameters</code>. 
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>prob0coefs</code></td>
<td>

<p>The fitted coefficients in the model for the point mass at 0 
(probability of zero precipitation) for each member of the ensemble.
</p>
</td></tr>
<tr><td><code>biasCoefs</code></td>
<td>

<p>The fitted coefficients in the model for the mean of nonzero observations
for each member of the ensemble (used for bias correction).
</p>
</td></tr>
<tr><td><code>varCoefs</code></td>
<td>

<p>The fitted coefficients for the model for the variance of nonzero 
observations (these are the same for all members of the ensemble).
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the gamma components for each ensemble member.
</p>
</td></tr>
<tr><td><code>nIter</code></td>
<td>

<p>The number of EM iterations.
</p>
</td></tr>
<tr><td><code>power</code></td>
<td>

<p>A scalar value giving to the power by which the data was transformed
to fit the models for the  point mass at 0 and the bias model. 
The untransformed forecast is used to fit the variance model.
This is input as part of <code>control</code>.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley,
Probabilistic quantitative precipitation forecasting
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+controlBMAgamma0">controlBMAgamma0</a></code>, 
<code><a href="#topic+ensembleBMAgamma0">ensembleBMAgamma0</a></code>,
<code><a href="#topic+cdf">cdf</a></code>,
<code><a href="#topic+quantileForecast">quantileForecast</a></code>,
<code><a href="#topic+modelParameters">modelParameters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("PCP24","obs", sep = ".")
  ens &lt;- paste("PCP24", ensMemNames, sep = ".")

  prcpTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"], 
                                observations = ensBMAtest[,obs], 
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  prcpTrain &lt;- trainingData( prcpTestData, trainingDays = 30,
                             date = "2008010100")

## End(Not run)

# quick run only; use more training days for forecasting
  prcpTrain &lt;- trainingData( prcpTestData, trainingDays = 10,
                             date = "2008010100")

  prcpTrainFit &lt;- fitBMAgamma0( prcpTrain)

## equivalent to
##    prcpTrainFit &lt;- fitBMA( prcpTrain, model = "gamma0")

</code></pre>

<hr>
<h2 id='fitBMAnormal'>
BMA mixture of normals fit to a training set
</h2><span id='topic+fitBMAnormal'></span>

<h3>Description</h3>

<p>Fits a Bayesian Model Averaging mixture of normals to a given training set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitBMAnormal( ensembleData, control = controlBMAnormal(),
              exchangeable = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitBMAnormal_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and 
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included.  This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitBMAnormal_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. The defaults are
given by the function <code>controlBMAnormal</code>.
</p>
</td></tr>
<tr><td><code id="fitBMAnormal_+3A_exchangeable">exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The models have equal weights and parameters within each group.
If supplied, this argument will override any specification of 
exchangeability in <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a BMA model to a training data set. <br />
It is called by <code>ensembleBMAnormal</code>, which can produce a sequence
of fits over a larger data set.  <br />
Methods available for the output of <code>fitBMAnormal</code> include:
<code>cdf</code>, <code>quantileForecast</code>, and <code>modelParameters</code>. 
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>biasCoefs</code></td>
<td>

<p>The fitted bias-correction coefficients.
</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>

<p>The fitted standard deviations for the mixture of normals model
(equal or varying across components according to the <code>equalVariance</code>
setting in the <code>control</code> input).
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>The fitted BMA weights for the normal components for each ensemble member.
</p>
</td></tr>
<tr><td><code>nIter</code></td>
<td>

<p>The number of EM iterations.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian Model Averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155&ndash;1174, 2005</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+controlBMAnormal">controlBMAnormal</a></code>, 
<code><a href="#topic+ensembleBMAnormal">ensembleBMAnormal</a></code>,
<code><a href="#topic+cdf">cdf</a></code>,
<code><a href="#topic+quantileForecast">quantileForecast</a></code>,
<code><a href="#topic+modelParameters">modelParameters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                dates = ensBMAtest[,"vdate"],
                                forecastHour = 48,
                                initializationTime = "00")

  tempTrain &lt;- trainingData( tempTestData, trainingDays = 30,
                             date  = "2008010100")

  tempTrainFit &lt;- fitBMAnormal( tempTrain)
</code></pre>

<hr>
<h2 id='julTOymdh'>
Convert Julian dates to character format.
</h2><span id='topic+julTOymdh'></span>

<h3>Description</h3>

<p>Converts Julian dates to YYYYMMDDHH or YYYYMMDD character format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> julTOymdh( julianDates, origin = NULL, dropHour = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="julTOymdh_+3A_juliandates">julianDates</code></td>
<td>

<p>A numeric vector specifying Julian dates.
</p>
</td></tr>
<tr><td><code id="julTOymdh_+3A_origin">origin</code></td>
<td>

<p>A named vector specifying the month, day, and year for the
origin of the Julian dates. The default is
<code>c(month = 1, day = 1, year = 2000)</code>.
The default is <code>attr(julianDates, "origin")</code> if it exists.
</p>
</td></tr>
<tr><td><code id="julTOymdh_+3A_drophour">dropHour</code></td>
<td>

<p>A logical value indicating whether of not the hour information
should be drop from the specifiation of the dates if none of the
Julian dates are fractional.
The default is <code>attr(julianDates, "dropHour")</code> if it exists.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Requires the <code>chron</code> library.
</p>


<h3>Value</h3>

<p>A character vector or numeric equivalent of dates in the form
YYYYMMDDHH or YYYYMMDD, in which YYYY specifies the year, MM the
month, DD the day, and (optionally) HH the hour
corresponding to the Julian input.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dateCheck">dateCheck</a>,<a href="#topic+ymdhTOjul">ymdhTOjul</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  julianIdates &lt;- ymdhTOjul(ensBMAtest$idate)

  all.equal( julTOymdh(julianIdates), as.character(ensBMAtest$idate))

  all.equal( ymdhTOjul(ensBMAtest$vdate), julianIdates+2)
</code></pre>

<hr>
<h2 id='MAE'>
Mean Absolute Error
</h2><span id='topic+MAE'></span><span id='topic+MAE.default'></span>

<h3>Description</h3>

<p>Computes the mean absolute error (MAE) for ensemble forecasting models. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAE( fit, ensembleData, dates=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAE_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="MAE_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble
forecasts, verification observations and possibly dates.
Missing values (indicated by <code>NA</code>) are allowed. \
This need not be the data used for the model <code>fit</code>, 
although it must include the same ensemble members. 
</p>
</td></tr>
<tr><td><code id="MAE_+3A_dates">dates</code></td>
<td>

<p>The dates for which the CRPS and MAE will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
</p>
</td></tr>
<tr><td><code id="MAE_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is generic, and can be applied to all ensemble forecasting
models. <br />
Note the model may have been applied to a power transformation of the data,
but that information is included in the input <code>fit</code>, and
the output is transformed appropriately.
</p>


<h3>Value</h3>

<p>A vector giving the MAE for the  deterministic forecasts associated with
the raw ensemble and for the ensemble forecasting model.
This is the mean absolute difference of the raw ensemble medians and the 
observations,
and the mean absolute difference of the median forecast
and the observations (as in Sloughter et al. 2007). \
Note that Raftery et al. 2005 uses
the mean absolute difference of the raw ensemble means and the 
observations,
and the mean absolute difference of the BMA predictive mean and the
observations.
</p>


<h3>References</h3>

<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised in 2010). 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMA">ensembleBMA</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")
## Not run:  # R check
  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)

## End(Not run)

  MAE( tempTestFit, tempTestData)
</code></pre>

<hr>
<h2 id='modelParameters'>
Extract model parameters
</h2><span id='topic+modelParameters'></span><span id='topic+modelParameters.ensembleBMAgamma'></span><span id='topic+modelParameters.ensembleBMAgamma0'></span><span id='topic+modelParameters.ensembleBMAnormal'></span><span id='topic+modelParameters.fitBMAgamma'></span><span id='topic+modelParameters.fitBMAgamma0'></span><span id='topic+modelParameters.fitBMAnormal'></span>

<h3>Description</h3>

<p>Extracts model parameters for ensemble forecasting models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelParameters( fit, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelParameters_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="modelParameters_+3A_...">...</code></td>
<td>

<p>For ensemble fits involving dates, there is an additional <code>dates</code>
argument, giving a character representation  of the dates for which
model parameters are desired.  In this case <code>dates</code> must
correspond to the models in the fit and the default is to give
the model parameters for all available dates.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of parameters (including weights) corresponding to the
ensemble forecasting model for the specified dates. 
The list may also include a power by which the forecasts were
transformed to obtain the model parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMAgamma">ensembleBMAgamma</a></code>,
<code><a href="#topic+ensembleBMAgamma0">ensembleBMAgamma0</a></code>,
<code><a href="#topic+ensembleBMAnormal">ensembleBMAnormal</a></code>, 
<code><a href="#topic+fitBMAgamma">fitBMAgamma</a></code>,
<code><a href="#topic+fitBMAgamma0">fitBMAgamma0</a></code>,
<code><a href="#topic+fitBMAnormal">fitBMAnormal</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)

## End(Not run)

  modelParameters( tempTestFit, date = "2008010100")

  tempTrain &lt;- trainingData( tempTestData, date = "2008010100",
                             trainingDays = tempTestFit$training$days)

  tempTrainFit &lt;- fitBMAnormal( tempTrain)

  modelParameters( tempTrainFit)
</code></pre>

<hr>
<h2 id='pit'>
Probability Integral Transform for ensemble forcasting models
</h2><span id='topic+pit'></span><span id='topic+pit.ensembleBMAgamma'></span><span id='topic+pit.ensembleBMAgamma0'></span><span id='topic+pit.ensembleBMAnormal'></span><span id='topic+pit.fitBMAgamma'></span><span id='topic+pit.fitBMAgamma0'></span><span id='topic+pit.fitBMAnormal'></span>

<h3>Description</h3>

<p>Computes the probabilty integral transform (PIT)
of a BMA ensemble forecasting model at observation locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pit( fit, ensembleData, dates = NULL, randomizeATzero=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pit_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="pit_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates. 
Missing values (indicated by <code>NA</code>) are allowed. \
This need not be the data used for the model <code>fit</code>, 
although it must include the same ensemble members. 
</p>
</td></tr>
<tr><td><code id="pit_+3A_dates">dates</code></td>
<td>

<p>The dates for which the CDF will be computed.
These dates must be consistent with <code>fit</code> and 
<code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitBMA</code>, 
which also ignores date information.
</p>
</td></tr>
<tr><td><code id="pit_+3A_randomizeatzero">randomizeATzero</code></td>
<td>

<p>For the <code>gamma0</code> model for precipitation, observations should be
randomized at 0 for assessing the calibration. Has no effect for the
other models.
</p>
</td></tr>
<tr><td><code id="pit_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Most often used for computing PIT histograms to assess calibration of
forecasts, in which case the observations in <code>ensembleData</code> would
be those used in modeling <code>fit</code>. <br />
Instances in <code>ensembleData</code> without verifying observations 
are ignored. <br />
Note the model may have been applied to a power transformation of the data,
but that information is included in the input <code>fit</code>, and
the output is transformed appropriately. <br />
The PIT is a continuous analog of the verification rank.
</p>


<h3>Value</h3>

<p>The value of the BMA cumulative distribution function CDF
corresponding to the fit at the observed values in <code>ensembleData</code>. 
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155&ndash;1174, 2005</em>.
</p>
<p>T. Gneiting, F. Balabdaoui and A. Raftery,
Probabilistic forecasts, calibration and sharpness.
<em>Journal of the Royal Statistical Society, Series B 69:243&ndash;268, 2007</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T Gneiting and C. Fraley, 
Probabilistic quantitative precipitation forecasting 
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensemble and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pitHist">pitHist</a></code>,
<code><a href="#topic+verifRankHist">verifRankHist</a></code>,
<code><a href="#topic+ensembleBMA">ensembleBMA</a></code>, 
<code><a href="#topic+fitBMA">fitBMA</a></code>, 
<code><a href="#topic+quantileForecast">quantileForecast</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)

## End(Not run)

  tempTestForc &lt;- quantileForecast( tempTestFit, tempTestData)
  range(tempTestForc)

  tempTestPIT &lt;- pit( tempTestFit, tempTestData) 

</code></pre>

<hr>
<h2 id='pitHist'>
PIT Histogram
</h2><span id='topic+pitHist'></span>

<h3>Description</h3>

<p>Computes the probability integral transform of the obervations relative to
the BMA forecast, and  plots its histogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pitHist( fit, ensembleData, dates=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pitHist_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="pitHist_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates.
Missing values (indicated by <code>NA</code>) are allowed. \
This need not be the data used for the model <code>fit</code>,
although it must include the same ensemble members.
</p>
</td></tr>
<tr><td><code id="pitHist_+3A_dates">dates</code></td>
<td>

<p>The dates for which the CDF will be computed.
These dates must be consistent with <code>fit</code> and
<code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitBMA</code>,
which also ignores date information.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>PIT histograms are used to assess calibration of
forecasts, in which case the observations in <code>ensembleData</code> would
be those used in modeling <code>fit</code>. <br />
Instances in <code>ensembleData</code> without verifying observations
are ignored. <br />
In the case of the <code>gamma0</code> model for precipitation,
observations of zero precipitation are randomized within their
probabilistics range to avoid a false 
impression of bias.<br />
Note the model may have been applied to a power transformation of the data,
but that information is included in the input <code>fit</code>, and
the output is transformed appropriately. <br />
The PIT is a continuous analog of the verification rank.
</p>


<h3>Value</h3>

<p>The value of the BMA cumulative distribution function CDF
corresponding to the fit at the observed values in <code>ensembleData</code>.
The corresponding histogram is also plotted.
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155-1174, 2005</em>.
</p>
<p>T. Gneiting, F. Balabdaoui and A. Raftery,
Probabilistic forecasts, calibration and sharpness.
<em>Journal of the Royal Statistical Society, Series B 69:243&ndash;268, 2007</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley,
Probabilistic quantitative precipitation forecasting
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensemble and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+pit">pit</a></code>,   
<code><a href="#topic+verifRankHist">verifRankHist</a></code>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(srft)

  labels &lt;- c("CMCG","ETA","GASP","GFS","JMA","NGPS","TCWB","UKMO")

  srftData &lt;- ensembleData( forecasts = srft[ ,labels],
                            dates = srft$date,
                            observations = srft$obs,
                            latitude = srft$lat,
                            longitude = srft$lon,
                            forecastHour = 48,
                            initializationTime = "00")


## Not run: 
# this takes time
# the PIT should be evaluated over relatively long periods 

  srftFITall &lt;- ensembleBMA( srftData, model = "normal", trainingDays = 25)

  srftPIT &lt;- pitHist( srftFITall, srftData)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.ensembleBMA'>
Plot the Predictive Distribution Function for ensemble forcasting models
</h2><span id='topic+plot.ensembleBMA'></span><span id='topic+plot.ensembleBMAgamma'></span><span id='topic+plot.ensembleBMAgamma0'></span><span id='topic+plot.ensembleBMAnormal'></span><span id='topic+plot.fitBMA'></span><span id='topic+plot.fitBMAgamma'></span><span id='topic+plot.fitBMAgamma0'></span><span id='topic+plot.fitBMAnormal'></span><span id='topic+plotBMAgamma'></span><span id='topic+plotBMAgamma0'></span><span id='topic+plotBMAnormal'></span>

<h3>Description</h3>

<p>Plots the Predictive Distribution Function (PDF)
of an ensemble forecasting model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ensembleBMAgamma'
plot( x, ensembleData, dates=NULL, ask=TRUE, ...)
## S3 method for class 'ensembleBMAgamma0'
plot( x, ensembleData, dates=NULL, ask=TRUE, ...)
## S3 method for class 'ensembleBMAnormal'
plot( x, ensembleData, dates=NULL, ask=TRUE, ...)
## S3 method for class 'fitBMAgamma'
plot( x, ensembleData, dates=NULL, ...)
## S3 method for class 'fitBMAgamma0'
plot( x, ensembleData, dates=NULL, ...)
## S3 method for class 'fitBMAnormal'
plot( x, ensembleData, dates=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ensembleBMA_+3A_x">x</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="plot.ensembleBMA_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates. 
Missing values (indicated by <code>NA</code>) are allowed. \
This need not be the data used for the model <code>fit</code>, 
although it must include the same ensemble members. 
</p>
</td></tr>
<tr><td><code id="plot.ensembleBMA_+3A_dates">dates</code></td>
<td>

<p>The dates for which the PDF will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitBMA</code>, 
which also ignores date information.
</p>
</td></tr>
<tr><td><code id="plot.ensembleBMA_+3A_ask">ask</code></td>
<td>

<p>A logical value indicating whether or not the user should be prompted 
for the next plot.
</p>
</td></tr>
<tr><td><code id="plot.ensembleBMA_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is generic, and can be applied to any ensemble forecasting
model. <br />
The colored curves are the weighted PDFs of the ensemble members,
and the bold curve is the overall PDF. The vertical black line represents
the median forecast, and the dotted back lines represent the .1 and .9
quartiles. The vertical orange line is the verifying observation (if
any).<br />
Exchangeable members are represented in the plots by the weighted
group sum rather than by the indivdual weighted PDFs of each member.
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155&ndash;1174, 2005</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley,
Probabilistic quantitative precipitation forecasting
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190-202, 2010</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensemble and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run: # R check
  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)
  plot(tempTestFit, tempTestData)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotProbcast'>
Surface plots for forecast information.
</h2><span id='topic+plotProbcast'></span><span id='topic+binGrid'></span>

<h3>Description</h3>

<p>Produces contour, image, or perspective plot of a forecast
using loess prediction on a grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotProbcast( forecast, longitude, latitude, nGrid = 65,
                 type = c("image", "contour", "persp"), ..., 
                 interpolate = FALSE, span = 0.75, maps = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotProbcast_+3A_forecast">forecast</code></td>
<td>

<p>Numeric vector of forecasts.
</p>
</td></tr>
<tr><td><code id="plotProbcast_+3A_longitude">longitude</code></td>
<td>

<p>Numeric vector giving the longitude of each forecast location.
</p>
</td></tr>
<tr><td><code id="plotProbcast_+3A_latitude">latitude</code></td>
<td>

<p>Numeric vector giving the latitude of each forecast location.
</p>
</td></tr>
<tr><td><code id="plotProbcast_+3A_ngrid">nGrid</code></td>
<td>

<p>Number of grid points for <code>loess</code> interpolation. 
(Binning and interpolation are done on an <code>nGrid</code> by <code>nGrid</code> grid).
</p>
</td></tr>
<tr><td><code id="plotProbcast_+3A_type">type</code></td>
<td>

<p>A character string indicating the desired plot type.
Should be one of either <code>"contour"</code>, <code>"image"</code>, or
<code>"persp"</code>.
</p>
</td></tr>
<tr><td><code id="plotProbcast_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to the plotting method.
</p>
</td></tr>
<tr><td><code id="plotProbcast_+3A_interpolate">interpolate</code></td>
<td>

<p>A logical variable indicating whether or not a <code>loess</code>
fit should be used to interpolate the data to points on 
a grid. The default is to determine grid values by binning,
rather than interpolation.
</p>
</td></tr>
<tr><td><code id="plotProbcast_+3A_span">span</code></td>
<td>

<p>Smoothing parameter for <code>loess</code> (used only when
<code>interpolate = TRUE</code>).
The default value is <code>0.75</code>, which is 
the default for <code>loess</code>.
</p>
</td></tr>
<tr><td><code id="plotProbcast_+3A_maps">maps</code></td>
<td>

<p>A logical value indicating whether or not to include
a map outline. The default is to include an outline
if <code>type = "image"</code> and the <code>fields</code> library 
is loaded.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code>fields</code> library is loaded, a legend (and optionally
a map outline) will be included in image plots.
</p>


<h3>Value</h3>

<p>An image, contour, or perspective plot of the forecast.
</p>


<h3>References</h3>

<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+quantileForecast">quantileForecast</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(srft)

  labels &lt;- c("CMCG","ETA","GASP","GFS","JMA","NGPS","TCWB","UKMO")

  srftData &lt;- ensembleData( forecasts = srft[,labels],
                            dates = srft$date, observations = srft$obs,
                            latitude = srft$lat, longitude = srft$lon,
                            forecastHour = 48, initializationTime = "00")

## Not run:  # R check

  bmaFit &lt;- ensembleBMA( srftData, date = "2004012900", trainingDays = 25,
                         model = "normal")

  bmaForc &lt;- quantileForecast( bmaFit, srftData, date = "2004012900",  
                                  quantiles = c(.1, .5, .9))

  obs &lt;- srftData$date == "2004012900"
  lat &lt;- srftData$latitude[obs]
  lon &lt;- srftData$longitude[obs]

  plotProbcast( bmaForc[,"0.5"], lat, lon, 
                   type = "contour", interpolate = TRUE)
  title("Median Forecast")

  plotProbcast( srftData$obs[obs], lat, lon, 
                  type = "contour", interpolate = TRUE)
  title("Observed Surface Temperature")

  data(srftGrid)

  memberLabels &lt;- c("CMCG","ETA","GASP","GFS","JMA","NGPS","TCWB","UKMO")
 
  srftGridData &lt;- ensembleData(forecasts = srftGrid[,memberLabels],
      latitude = srftGrid[,"latitude"], longitude = srftGrid[,"longitude"],
                            forecastHour = 48, initializationTime = "00")

  gridForc &lt;- quantileForecast( bmaFit, srftGridData, 
                    date = "2004021400", quantiles = c( .1, .5, .9))

  library(fields)

  plotProbcast(gridForc[,"0.5"],lon=srftGridData$lon,
     lat=srftGridData$lat,type="image",col=rev(rainbow(100,start=0,end=0.85)))
  title("Median Grid Forecast for Surface Temperature", cex = 0.5)

  probFreeze &lt;- cdf( bmaFit, srftGridData,  date = "2004021400", 
                             value = 273.15)

  plotProbcast(probFreeze, lon=srftGridData$lon, lat=srftGridData$lat,
                   type="image",col=gray((32:0)/32))
  title("Probability of Freezing", cex = 0.5)


## End(Not run)</code></pre>

<hr>
<h2 id='prcpDJdata'>
Precipitation Data
</h2><span id='topic+prcpDJdata'></span>

<h3>Description</h3>

<p>A subset of daily 48 hour forecasts of 24 hour accumulated 
precipitation over the US Pacific Northwest region 
from December 2002 to January 2003 based 
on a 9 member version of the University of Washington mesoscale ensemble
(Grimit and Mass 2002; Eckel and Mass 2005). 
Precipitation amounts are quantized to hundredths of an inch. <br />
Note that forecasts are not available for some of the interim dates.
</p>


<h3>Format</h3>

<p>A data frame with 175 rows and 15 columns: <br />
<code>CENT,AVN,CMCG,ETA,GASP,JMA,NGAPS,TCWB,UKMO</code>
forecasts from the 9 members of the ensemble (numeric).<br />
<code>observation</code> the observed accumulated precipitation (numeric).<br />
<code>date</code> the date of each forecast/observation,
format YYYYMMDDHH (categorical). <br />
<code>station</code> weather station identifier (categorical). <br />
<code>latitude</code> the latitude of each weather station (numeric).<br />
<code>longitude</code> the longitude of each weather station (numeric). <br />
<code>elevation</code> the elevation of each weather station (numeric). 
</p>


<h3>Details</h3>

<p>This dataset is a small subset of the data used in Sloughter et al. (2006),
provided for the purposes of testing. Typically forecasting would be
performed on much larger datasets.
</p>


<h3>References</h3>

<p>E. P. Grimit and C. F. Mass, 
Initial results of a mesoscale short-range ensemble forecasting system over
the Pacific Northwest, 
<em>Weather and Forecasting 17:192&ndash;205, 2002</em>.
</p>
<p>F. A. Eckel and C. F. Mass, 
Effective mesoscale, short-range ensemble forecasting,
<em>Weather and Forecasting 20:328&ndash;350, 2005</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley, 
Probabilistic quantitative precipitation forecasting 
using Bayesian model averaging,
<em>Monthly Weather Review 135:3309&ndash;3320, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter, 
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting 
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # R check

 data(prcpDJdata)
 data(prcpFit)

 prcpForc &lt;- quantileForecast( prcpFit, prcpDJdata, date = "20030113",
                               quantiles = c( .1, .5, .9))

## End(Not run)</code></pre>

<hr>
<h2 id='prcpFit'>
BMA Model Fit to Precipitation Data
</h2><span id='topic+prcpFit'></span>

<h3>Description</h3>

<p>The <code>ensembleBMAgamma0</code> model fit with a 30 day training period to the 
precipitation data set from <br />
<em>http://www.stat.washington.edu/MURI</em>, 
which gives daily daily 48 hour forecasts of 24 hour accumulated 
precipitation over the US Pacific Northwest region from December 12, 2002
through March 31, 2005 on a 9 member version of the University of Washington 
mesoscale 
ensemble (Grimit and Mass 2002; Eckel and Mass 2005). 
Precipitation amounts are quantized to hundredths of an inch.
</p>


<h3>Format</h3>

<p>A list with the following arguments:
</p>

<dl>
<dt><code>dateTable</code></dt><dd>
<p>A named vector in which the names are the dates and the entries are
the number of observations for each date.
</p>
</dd>
<dt><code>trainingRule</code></dt><dd>
<p>The training rule used to compute the model fits.
</p>
</dd>
<dt><code>prob0coefs</code></dt><dd>
<p>The coefficients in the logistic regression for probability of zero precipitation.
</p>
</dd>
<dt><code>biasCoefs</code></dt><dd>
<p>The coefficients in the linear regression for bias correction.
</p>
</dd>
<dt><code>varCoefs</code></dt><dd>
<p>The variance coefficients of the models.
</p>
</dd>
<dt><code>weights</code></dt><dd>
<p>The BMA weights for the models.
</p>
</dd>
<dt><code>power</code></dt><dd>
<p>An scalar value giving the power by which the forecasts are transformed
for the BMA fitting.
</p>
</dd>
</dl>



<h3>References</h3>

<p>E. P. Grimit and C. F. Mass, 
Initial results of a mesoscale short-range ensemble forecasting system over
the Pacific Northwest, 
<em>Weather and Forecasting 17:192&ndash;205, 2002</em>.
</p>
<p>F. A. Eckel and C. F. Mass, 
Effective mesoscale, short-range ensemble forecasting,
<em>Weather and Forecasting 20:328&ndash;350, 2005</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley, 
Probabilistic quantitative precipitation forecasting 
using Bayesian model averaging,
<em>Monthly Weather Review 135:3309&ndash;3320, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # R check

  data(prcpFit)

  modelParameters(prcpFit, date = "20030113")

  data(prcpGrid) 

  prcpGridData &lt;- ensembleData(forecasts = prcpGrid[,1:9], 
                               latitude = prcpGrid[,"latitude"],
                               longitude = prcpGrid[,"longitude"],
                               forecsatHour = 48,
                               initializationTime = "00")

# probability of precipitation
  1 - cdf( prcpFit, prcpGridData, value = 0)

# probability of precipitation above 0.25 in
  1 - cdf( prcpFit, prcpGridData, date = "20030115", value = 25)
  

## End(Not run)</code></pre>

<hr>
<h2 id='prcpGrid'>
Gridded Ensemble Forecasts of Precipitation
</h2><span id='topic+prcpGrid'></span>

<h3>Description</h3>

<p>This data set gives 48-hour forecasts of 24 hour accumulated precipitation
on a grid of locations in the US Pacific Northwest 
initialized on  January 13, 2003 OOZ and valid on January 15, 2003 OOZ. 
The ensemble forecasts come from a nine member version of the 
University of Washington Mesoscale Ensemble 
(Grimit and Mass 2002; Eckel and Mass 2005).
Precipitation amounts are quantized to hundredths of an inch. 
</p>


<h3>Format</h3>

<p>A data frame with 8188 rows and 11 columns: <br />
<code>avn/gfs,cent,cmcg,eta,gasp,jma,ngps,tcwb,ukmo</code>
forecasts from the 9 members of the ensemble (numeric). <br />
<code>latitude</code> the latitude of each forecast (numeric). <br />
<code>longitude</code> the longitude of each forecast (numeric). <br />
</p>


<h3>References</h3>

<p>E. P. Grimit and C. F. Mass, 
Initial results of a mesoscale short-range ensemble forecasting system over
the Pacific Northwest, 
<em>Weather and Forecasting 17:192&ndash;205, 2002</em>.
</p>
<p>F. A. Eckel and C. F. Mass, 
Effective mesoscale, short-range ensemble forecasting,
<em>Weather and Forecasting 20:328&ndash;350, 2005</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley, 
Probabilistic quantitative precipitation forecasting 
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter, 
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Ensemble Forecasting 
using Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2009.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # R check

  data(prcpGrid) 

  prcpGridData &lt;- ensembleData(forecasts = prcpGrid[,1:9], 
                               latitude = prcpGrid[,"latitude"],
                               longitude = prcpGrid[,"longitude"],
                               forecastHour = 48,
                               initilaizationTime = "00")

  data(prcpFit)

# median forecast for Jan 15, 2003 at the grid points

  quantileForecast( prcpFit, prcpGridData, date = "20030115")
  

## End(Not run)</code></pre>

<hr>
<h2 id='quantileForecast'>
Quantile forecasts at observation locations
</h2><span id='topic+quantileForecast'></span><span id='topic+quantileForecast.ensembleBMAgamma'></span><span id='topic+quantileForecast.ensembleBMAgamma0'></span><span id='topic+quantileForecast.ensembleBMAnormal'></span><span id='topic+quantileForecast.ensembleBMAbvnormal'></span><span id='topic+quantileForecast.fitBMAgamma'></span><span id='topic+quantileForecast.fitBMAgamma0'></span><span id='topic+quantileForecast.fitBMAnormal'></span><span id='topic+quantileForecast.fitBMAbvnormal'></span><span id='topic+quantBMAgamma'></span><span id='topic+quantBMAgamma0'></span><span id='topic+quantBMAnormal'></span>

<h3>Description</h3>

<p>Computes quantiles for the probability distribution function
(PDF) for ensemble forecasting models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantileForecast( fit, ensembleData, quantiles = 0.5, dates=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantileForecast_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="quantileForecast_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble
forecasts, verification observations and possibly dates.
Missing values (indicated by <code>NA</code>) are allowed. \
This need not be the data used for the model <code>fit</code>, 
although it must include the same ensemble members. 
</p>
</td></tr>
<tr><td><code id="quantileForecast_+3A_quantiles">quantiles</code></td>
<td>

<p>The vector of desired quantiles for the PDF of the BMA mixture model.
</p>
</td></tr>
<tr><td><code id="quantileForecast_+3A_dates">dates</code></td>
<td>

<p>The dates for which the quantile forecasts will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
If <code>ensembleData</code> does not include dates, they will
be inferred from <code>fit</code> and <code>dates</code>. 
</p>
</td></tr>
<tr><td><code id="quantileForecast_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is generic, and can be applied to any ensemble forecasting
model. <br />
Note the model may have been applied to a power transformation of the data,
but that information is included in the input <code>fit</code>, and
the output is transformed appropriately. <br />
This can be used to compute prediction intervals for the PDF.  <br />
For the bivariate normal model for wind speed and direction, the
CRPS is computed for the marginal wind speed distribution.
</p>


<h3>Value</h3>

<p>A vector of forecasts corresponding to the desired quantiles.
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155&ndash;1174, 2005</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley, 
Probabilistic quantitative precipitation forecasting 
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMA">ensembleBMA</a></code>, 
<code><a href="#topic+fitBMA">fitBMA</a></code>, 
<code><a href="#topic+cdf">cdf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensMemNames, sep = ".")

  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                dates = ensBMAtest[,"vdate"],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                forecastHour = 48,
                                initializationTime = "00")

## Not run:  # R check
  tempTestFit &lt;- ensembleBMAnormal( tempTestData, trainingDays = 30)

## End(Not run)

  tempTestForc &lt;- quantileForecast( tempTestFit, tempTestData)


## Not run:  # R check

  data(srft)

  labels &lt;- c("CMCG","ETA","GASP","GFS","JMA","NGPS","TCWB","UKMO")

  srftData &lt;- ensembleData( forecasts = srft[ ,labels],
                            dates = srft$date,
                            observations = srft$obs,
                            latitude = srft$lat,
                            longitude = srft$lon,
                            forecastHour = 48,
                            initializationTime = "00")

  srftFit &lt;- ensembleBMAnormal(srftData, date = "2004013100",
                               trainingDays = 25)

  data(srftGrid)

  srftGridData &lt;- ensembleData(forecasts = srftGrid[ ,labels],
                               latitude = srftGrid$lat,
                               longitude = srftGrid$lon,
                               forecastHour = 48,
                               initializationTime = "00")

  srftGridForc &lt;- quantileForecast( srftFit, srftGridData, 
                     date = "2004013100")

## End(Not run)</code></pre>

<hr>
<h2 id='srft'>Surface Temperature Ensemble Forecasts and Observations</h2><span id='topic+srft'></span>

<h3>Description</h3>

<p>This data set gives 48-hour forecasts of 2-m surface temperature and the
associated observations for the US Pacific Northwest from January 1, 2004
to February 28, 2004. The ensemble forecasts come from an eight-member 
version of the University of Washington Mesoscale Ensemble 
(Grimit and Mass 2002; Eckel and Mass 2005). 
Temperatures are measured in kelvins. <br />
Note that forecasts are not available for some of the interim dates.
</p>


<h3>Format</h3>

<p>A data frame with 36826 rows and 15 columns: <br />
<code>CMCG,ETA,GASP,GFS,JMA,NGAPS,TCWB,UKMO</code>
forecasts from the 8 members of the ensemble (numeric). <br />
<code>observation</code> the observed surface temperature (numeric). <br />
<code>date</code>  the date of each forecast/observation set, 
in the format YYYYMMDDHH (categorical). <br />
<code>latitude</code> the latitude of each forecast (numeric). <br />
<code>longitude</code>  the longitude of each forecast (numeric). <br />
<code>station</code> weather station identifier (categorical). <br />
<code>type</code> weather station type (categorical). <br />
</p>


<h3>References</h3>

<p>F. A. Eckel and C. F. Mass, 
Effective mesoscale, short-range ensemble forecasting,
<em>Weather and Forecasting 20:328&ndash;350, 2005</em>.
</p>
<p>E. P. Grimit and C. F. Mass, 
Initial results of a mesoscale short-range ensemble forecasting system over
the Pacific Northwest, 
<em>Weather and Forecasting 17:192&ndash;205, 2002</em>.
</p>
<p>V. J. Berrocal, A. E. Raftery and T. Gneiting,
Combining spatial and ensemble information in probabilistic weather forecasts,
<em>Monthly Weather Review 133:1386&ndash;1402, 2007</em>.
</p>
<p>V. J. Berrocal, A. E. Raftery, T. Gneiting and R. C. Steed,
Probabilistic Weather Forecasting for Winter Road Maintenance,
<em>Journal of the American Statistical Association, 2010 (to appear)</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter, 
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting 
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # R check

  data(srft)

  labels &lt;- c("CMCG","ETA","GASP","GFS","JMA","NGPS","TCWB","UKMO")

  srftData &lt;- ensembleData( forecasts = srft[ ,labels],
                            dates = srft$date,
                            observations = srft$obs,
                            latitude = srft$lat,
                            longitude = srft$lon,
                            forecastHour = 48,
                            initializationTime = "00")

  srftFit &lt;- ensembleBMAnormal( srftData, date = "2004013100",
                                trainingDays = 25)

## End(Not run)</code></pre>

<hr>
<h2 id='srftGrid'>Gridded Surface Temperature Ensemble Forecasts</h2><span id='topic+srftGrid'></span>

<h3>Description</h3>

<p>This data set gives 48-hour forecasts of 2-m surface temperature
on a grid of locations in the US Pacific Northwest 
initialized on January 29, 2004 00UTC and valid on January 31, 2004 00UTC.
The ensemble forecasts come from an eight member version of the 
University of Washington Mesoscale Ensemble 
(Grimit and Mass 2002; Eckel and Mass 2005).
Temperatures are measured in kelvins. <br />
Note that forecasts are not available for some of the interim dates.
</p>


<h3>Format</h3>

<p>A data frame with 10098 rows and 10 columns: <br />
<code>CMCG,ETA,GASP,GFS,JMA,NGAPS,TCWB,UKMO</code>
forecasts from the 8 members of the ensemble (numeric). <br />
<code>latitude</code> the latitude of each forecast (numeric). <br />
<code>longitude</code> the longitude of each forecast (numeric). <br />
</p>


<h3>References</h3>

<p>F. A. Eckel and C. F. Mass, 
Effective mesoscale, short-range ensemble forecasting,
<em>Weather and Forecasting 20:328&ndash;350, 2005</em>.
</p>
<p>E. P. Grimit and C. F. Mass, 
Initial results of a mesoscale short-range ensemble forecasting system over
the Pacific Northwest, 
<em>Weather and Forecasting 17:192&ndash;205, 2002</em>.
</p>
<p>V. J. Berrocal, A. E. Raftery and T. Gneiting,
Combining spatial and ensemble information in probabilistic weather forecasts,
<em>Monthly Weather Review 133:1386&ndash;1402, 2007</em>.
</p>
<p>V. J. Berrocal, A. E. Raftery, T. Gneiting and R. C. Steed,
Probabilistic Weather Forecasting for Winter Road Maintenance,
<em>Journal of the American Statistical Association, 2010 (to appear)</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # R check
  data(srft)
  data(srftGrid)

  labels &lt;- c("CMCG","ETA","GASP","GFS","JMA","NGPS","TCWB","UKMO")

  srftData &lt;- ensembleData( forecasts = srft[ ,labels],
                            dates = srft$date,
                            observations = srft$obs,
                            latitude = srft$lat,
                            longitude = srft$lon,
                            forecastHour = 48,
                            initializationTime = "00")

  srftFit &lt;- ensembleBMAnormal( srftData, date = "2004013100",
                                trainingDays = 25)


  srftGridData &lt;- ensembleData( forecasts = srftGrid[ ,labels],
                                latitude = srftGrid$lat,
                                longitude = srftGrid$lon,
                                forecastHour = 48,
                                initializationTime = "00")

   CRPS( srtGridData, srftFit)

## End(Not run)</code></pre>

<hr>
<h2 id='trainingData'>
Extract Training Data
</h2><span id='topic+trainingData'></span>

<h3>Description</h3>

<p>Extracts a subset of an <code>ensembleData</code> object corresponding
to a given date and number of  training days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trainingData( ensembleData, trainingDays, date) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trainingData_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes, ensemble
forecasts, observations and dates.
</p>
</td></tr>
<tr><td><code id="trainingData_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer specifying the number of days in the training period.
</p>
</td></tr>
<tr><td><code id="trainingData_+3A_date">date</code></td>
<td>

<p>The date for which the training data is desired. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The most recent days are used for training
regardless of whether or not they are consecutive.
</p>


<h3>Value</h3>

<p>An <code>ensembleData</code> object corresponding to the training data for
the given date relative to <code>ensembleData</code>.
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155-1174, 2005</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley, 
Probabilistic quantitative precipitation forecasting 
using Bayesian model averaging,
<em>Monthly Weather Review 135:3309&ndash;3320, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleBMA">ensembleBMA</a></code>, 
<code><a href="#topic+fitBMA">fitBMA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  ensNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

  obs &lt;- paste("T2","obs", sep = ".")
  ens &lt;- paste("T2", ensNames, sep = ".")


  tempTestData &lt;- ensembleData( forecasts = ensBMAtest[,ens],
                                observations = ensBMAtest[,obs],
                                station = ensBMAtest[,"station"],
                                dates = ensBMAtest[,"vdate"],
                                forecastHour = 48,
                                initializationTime = "00")

  tempTrain &lt;- trainingData( tempTestData, trainingDays = 30,
                             date  = "2008010100")
 
  tempTrainFit &lt;- fitBMAnormal( tempTrain)

</code></pre>

<hr>
<h2 id='verifPlot'>
Plot observations along with median, 10th and 90th percentile forecasts.  
</h2><span id='topic+verifPlot'></span>

<h3>Description</h3>

<p>Computes the median, 10th and 90th percentile forecasts,
and plots the corresponding observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  verifPlot( fit, ensembleData, dates = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verifPlot_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="verifPlot_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates.
Missing values (indicated by <code>NA</code>) are allowed. \
This need not be the data used for the model <code>fit</code>,
although it must include the same ensemble members.
</p>
</td></tr>
<tr><td><code id="verifPlot_+3A_dates">dates</code></td>
<td>

<p>The dates for which the CDF will be computed.
These dates must be consistent with <code>fit</code> and
<code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitBMA</code>,
which also ignores date information.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix giving the median, 10th and 90th percentile forecasts for the 
ensemble data at the specified dates. 
If observations are available, they are plotted along with the forecasts
in order of increasing 90th percentile forecast. 
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155-1174, 2005</em>.
</p>
<p>T. Gneiting, F. Balabdaoui and A. Raftery,
Probabilistic forecasts, calibration and sharpness.
<em>Journal of the Royal Statistical Society, Series B 69:243&ndash;268, 2007</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley,
Probabilistic quantitative precipitation forecasting
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensemble and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+pit">pit</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(prcpFit)
  data(prcpDJdata)

  forc &lt;- verifPlot( prcpFit, prcpDJdata, date = "20030113")
</code></pre>

<hr>
<h2 id='verifRankHist'>
Verification Rank and Histogram
</h2><span id='topic+verifRankHist'></span>

<h3>Description</h3>

<p>Computes the rank of verifying observations
relative to the corresponding ensemble forecasts
and plots its histogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  verifRankHist( forecasts, observations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verifRankHist_+3A_forecasts">forecasts</code></td>
<td>

<p>A matrix of ensemble forecasts, in which the rows corresponds to
locations and times and the columns correspond to the individual
ensemble members.
</p>
</td></tr>
<tr><td><code id="verifRankHist_+3A_observations">observations</code></td>
<td>

<p>A vector of observations corresponding to the locations and times
of the forecasts.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The verification rank is used to assess calibration of a forecast
ensemble. A more uniform verification rank histogram
indicates better calibartion. 
</p>


<h3>Value</h3>

<p>A vector giving the rank of verifying observations relative
to the corresponding ensemble forecasts.
The verification rank historgram is plotted. 
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review 133:1155-1174, 2005</em>.
</p>
<p>T. Gneiting, F. Balabdaoui and A. Raftery,
Probabilistic forecasts, calibration and sharpness.
<em>Journal of the Royal Statistical Society, Series B 69:243&ndash;268, 2007</em>.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley,
Probabilistic quantitative precipitation forecasting
using Bayesian model averaging,
<em>Monthly Weather Review 135:3209&ndash;3220, 2007</em>.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensemble and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, 2007 (revised 2010).
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting,
Calibrating Multi-Model Forecast Ensembles
with Exchangeable and Missing Members using Bayesian Model Averaging,
<em>Monthly Weather Review 138:190&ndash;202, 2010</em>.
</p>
<p>J. M. Sloughter, T. Gneiting and A. E. Raftery, 
Probabilistic wind speed forecasting 
using ensembles and Bayesian model averaging,
<em>Journal of the American Statistical Association, 105:25&ndash;35, 2010</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleData">ensembleData</a></code>, 
<code><a href="#topic+pit">pit</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(srft)

  labels &lt;- c("CMCG","ETA","GASP","GFS","JMA","NGPS","TCWB","UKMO")

  srftData &lt;- ensembleData( forecasts = srft[ ,labels],
                            dates = srft$date,
                            observations = srft$obs,
                            latitude = srft$lat,
                            longitude = srft$lon,
                            forecastHour = 48,
                            initializationTime = "00")

  use &lt;- ensembleValidDates(srftData) &gt;= "2004013000"

  verifRankHist( ensembleForecasts(srftData[use,]),
                 dataVerifObs(srftData[use,]))
</code></pre>

<hr>
<h2 id='ymdhTOjul'>
Convert to Julian dates.
</h2><span id='topic+ymdhTOjul'></span>

<h3>Description</h3>

<p>Converts YYYYMMDDHH or YYYYMMDD dates to Julian dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ymdhTOjul( YYYYMMDDHH, origin = c(month = 1, day = 1, year = 2000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ymdhTOjul_+3A_yyyymmddhh">YYYYMMDDHH</code></td>
<td>

<p>A character vector (or its factor equivalent) of dates in the form
YYYYMMDDHH or YYYYMMDD, in which YYYY specifies the year, MM the
month, DD the day, and (optionally) HH the hour.
</p>
</td></tr>
<tr><td><code id="ymdhTOjul_+3A_origin">origin</code></td>
<td>

<p>A named vector specifying the month, day, and year for the
origin of the Julian dates. The default is
<code>c(month = 1, day = 1, year = 2000)</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Requires the <code>chron</code> library.
</p>


<h3>Value</h3>

<p>A vector of Julian dates corresponding to YYYYMMDDHH.
The vector has <code>"origin"</code> and <code>"dropHour"</code>
attributes which give the origin for the Julian output and
indicate whether or not the original format included the hour.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dateCheck">dateCheck</a>,<a href="#topic+julTOymdh">julTOymdh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ensBMAtest)

  julianVdates &lt;- ymdhTOjul(ensBMAtest$vdate)
  all.equal( julTOymdh(julianVdates), as.character(ensBMAtest$vdate))

  all.equal( ymdhTOjul(ensBMAtest$idate), julianVdates-2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
