<!DOCTYPE html><html><head><title>Help for package loewesadditivity</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {loewesadditivity}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#base_GIA'><p>Estimate GIA according to the base model</p></a></li>
<li><a href='#boot_GIA'><p>Helper function for the bootstrap results</p></a></li>
<li><a href='#calc_S'><p>Calculate S generally</p></a></li>
<li><a href='#calc_S_base'><p>Calculate S from given tau_1 for base model</p></a></li>
<li><a href='#cyrpa_ripr'><p>CyRPA and RIPR</p></a></li>
<li><a href='#design_experiment'><p>Helper function to generate code to run an experiment</p></a></li>
<li><a href='#design_grid'><p>Function to design an experimental grid of combinations</p></a></li>
<li><a href='#estimate_GIA'><p>Take in dose A and dose B combinations and estimate GIA</p></a></li>
<li><a href='#estimate_params'><p>Estimate the parameters for a given data set and model</p></a></li>
<li><a href='#fortify_gia_data'><p>Put GIA measurements into a dplyr format</p></a></li>
<li><a href='#get_ed_line'><p>Helper function to get the ED50 line</p></a></li>
<li><a href='#make_grid'><p>Make a grid of points</p></a></li>
<li><a href='#plot_curves'><p>Plot the surface and observations</p></a></li>
<li><a href='#plot_isobologram'><p>Plot the estimated isobologram</p></a></li>
<li><a href='#plot_surface'><p>Plot the surface and observations</p></a></li>
<li><a href='#rh5_ama1ron2'><p>RH5 and AMA1RON2</p></a></li>
<li><a href='#rh5_rh4'><p>RH5 and RH4</p></a></li>
<li><a href='#simulate_coverage'><p>Simulate a GIA model with an assumed error structure</p></a></li>
<li><a href='#SSE_GIA'><p>Calculate the Sum of Squared Error</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Loewe's Additivity</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate model parameters to determine whether two compounds have synergy, antagonism, or Loewe's Additivity.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0), knitr, rmarkdown, kableExtra, devtools</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, tidyr, magrittr, rlang, ggplot2, metR, gridExtra,
rootSolve, viridis</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-16 13:02:40 UTC; shannon</td>
</tr>
<tr>
<td>Author:</td>
<td>Shannon Gallagher [aut, cre],
  Michael Fay [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shannon Gallagher &lt;skgallagher19@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-24 17:00:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='base_GIA'>Estimate GIA according to the base model</h2><span id='topic+base_GIA'></span>

<h3>Description</h3>

<p>Estimate GIA according to the base model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>base_GIA(model_params, dose_A, dose_B, fn_list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="base_GIA_+3A_model_params">model_params</code></td>
<td>
<p>named vector of parameters to be used in function.  Specifically, the named parameters must be &quot;beta_A&quot;, &quot;beta_B&quot;, &quot;gamma_A&quot;, &quot;gamma_B&quot;, &quot;tau_1&quot;, and &quot;tau_2&quot;.  See details for more info.</p>
</td></tr>
<tr><td><code id="base_GIA_+3A_dose_a">dose_A</code></td>
<td>
<p>numeric vector of doses (e.g. mg/mL) of dose_A</p>
</td></tr>
<tr><td><code id="base_GIA_+3A_dose_b">dose_B</code></td>
<td>
<p>numeric vector of doses (e.g. mg/mL) of dose_B</p>
</td></tr>
<tr><td><code id="base_GIA_+3A_fn_list">fn_list</code></td>
<td>
<p>NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>estimated GIA for each combination of dose A and dose B
</p>


<h3>Details</h3>

<p>The equation is given in full as follows.  The GIA (%) is given a as a function of the model parameters and the doses <code class="reqn">A_i</code> and <code class="reqn">B_i</code>, respectively.  The doses scaled by the respective ED50s <code class="reqn">\beta_A</code> and <code class="reqn">\beta_B</code> are denoted by <code class="reqn">A_i^*</code> and <code class="reqn">B_i^*</code>, respectively.  The parameters <code class="reqn">\gamma_A</code> and <code class="reqn">\gamma_B</code> are shape parameters.  The parameters <code class="reqn">\tau_1</code> and <code class="reqn">\tau_2</code> are interaction parameters.  Finally, <code class="reqn">\lambda_i</code> is a weighted combination of dose A and dose B.
</p>
<p style="text-align: center;"><code class="reqn">GIA_i = 100\%(1 - e^{-\psi_i})</code>
</p>

<p style="text-align: center;"><code class="reqn">\psi_i = \log(2)u_i^{v_i}</code>
</p>

<p style="text-align: center;"><code class="reqn">u_i = A^*_i + B_i^* + \tau_1  A^*_i B^*_i</code>
</p>

<p style="text-align: center;"><code class="reqn">v_i = \lambda_i \gamma_A + (1-\lambda_i) \gamma_B + \tau_1 \tau_2\lambda_i (1 - \lambda_i) \gamma_A \gamma_B</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_i = \frac{A_i^*}{A_i^* + B_i^*}</code>
</p>

<p style="text-align: center;"><code class="reqn">A_i^* = A_i / \beta_A</code>
</p>

<p style="text-align: center;"><code class="reqn">B_i^* = B_i / \beta_B</code>
</p>



<h3>Examples</h3>

<pre><code class='language-R'>model_params &lt;- c("beta_A" = 1, "beta_B" = 2, "gamma_A" = .5,
"gamma_B" = .6,  "tau_1" = 1, "tau_2" = 0)
dose_A &lt;- c(0, 1, 0)
dose_B &lt;- c(0, 0, 1)
base_GIA(model_params, dose_A, dose_B)
</code></pre>

<hr>
<h2 id='boot_GIA'>Helper function for the bootstrap results</h2><span id='topic+boot_GIA'></span>

<h3>Description</h3>

<p>Helper function for the bootstrap results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot_GIA(
  par,
  gia_df,
  gia_est,
  n_boot = 100,
  alpha = 0.05,
  GIA_fn = base_GIA,
  S_fn = calc_S_base,
  fn_list = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot_GIA_+3A_par">par</code></td>
<td>
<p>named vector of parameters, that correspond to those used in 'GIA_fn'.</p>
</td></tr>
<tr><td><code id="boot_GIA_+3A_gia_df">gia_df</code></td>
<td>
<p>data frame with the following columns
</p>

<ul>
<li><p>dose_Adose A mg/mL
</p>
</li>
<li><p>dose_Bdose B mg/mL
</p>
</li>
<li><p>GIAGIA
</p>
</li></ul>
</td></tr>
<tr><td><code id="boot_GIA_+3A_gia_est">gia_est</code></td>
<td>
<p>estimated values of GIA (these will be used as the 'truth')</p>
</td></tr>
<tr><td><code id="boot_GIA_+3A_n_boot">n_boot</code></td>
<td>
<p>number of boot straps to use to estimate confidence intervals of the parameters, GIA estimates, and values of S.  The default is 100.  If n_boot = 0, then no bootstraps will be run and only the point estimates will be returned.</p>
</td></tr>
<tr><td><code id="boot_GIA_+3A_alpha">alpha</code></td>
<td>
<p>value of alpha.  Default is .05</p>
</td></tr>
<tr><td><code id="boot_GIA_+3A_gia_fn">GIA_fn</code></td>
<td>
<p>function to calculate the GIA from dose_A and dose_B combinations and given set of parameters.  Default is base_GIA</p>
</td></tr>
<tr><td><code id="boot_GIA_+3A_s_fn">S_fn</code></td>
<td>
<p>Function to calculate S. Default is calc_S_base</p>
</td></tr>
<tr><td><code id="boot_GIA_+3A_fn_list">fn_list</code></td>
<td>
<p>additional arguments to pass to GIA_fn</p>
</td></tr>
<tr><td><code id="boot_GIA_+3A_verbose">verbose</code></td>
<td>
<p>logical indicating whether we should print where we are in the process.  Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following elements
</p>

<ul>
<li><p>params_esta data frame of dimension # of params x 4 where each row in the data frame is a parameter and where the columns are the mean, lower, alpha/2 quantile,and upper,100 - alpha/2 quantile
</p>
</li>
<li><p>S_est a data frame of one row  x 4 where we provide the mean, lower, and upper estimates
</p>
</li>
<li><p>GIA_estthe original data with additional columns of the mean, lower, and upper estimates for each dose combination
</p>
</li></ul>


<hr>
<h2 id='calc_S'>Calculate S generally</h2><span id='topic+calc_S'></span>

<h3>Description</h3>

<p>Calculate S generally
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_S(best_pars, S_fn = calc_S_base, fn_list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_S_+3A_best_pars">best_pars</code></td>
<td>
<p>named vector of parameters.  &quot;tau_1&quot; must be a name.  As must &quot;tau_2&quot; and &quot;gamma_A&quot; and &quot;gamma_B&quot;</p>
</td></tr>
<tr><td><code id="calc_S_+3A_s_fn">S_fn</code></td>
<td>
<p>function to calculate</p>
</td></tr>
<tr><td><code id="calc_S_+3A_fn_list">fn_list</code></td>
<td>
<p>NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Hewlett's S for the given model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>best_pars &lt;- c("tau_1" = 0,
              "tau_2" = 1,
              "gamma_A" = 1,
               "gamma_B" = 1)
calc_S_base(best_pars) # should be 1
</code></pre>

<hr>
<h2 id='calc_S_base'>Calculate S from given tau_1 for base model</h2><span id='topic+calc_S_base'></span>

<h3>Description</h3>

<p>Calculate S from given tau_1 for base model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_S_base(best_pars, fn_list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_S_base_+3A_best_pars">best_pars</code></td>
<td>
<p>named vector of parameters.  &quot;tau_1&quot; must be a name.  As must &quot;tau_2&quot; and &quot;gamma_A&quot; and &quot;gamma_B&quot;</p>
</td></tr>
<tr><td><code id="calc_S_base_+3A_fn_list">fn_list</code></td>
<td>
<p>NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Hewlett's S for the base model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>best_pars &lt;- c("tau_1" = 0,
              "tau_2" = 1,
              "gamma_A" = 1,
               "gamma_B" = 1)
calc_S_base(best_pars) # should be 1
</code></pre>

<hr>
<h2 id='cyrpa_ripr'>CyRPA and RIPR</h2><span id='topic+cyrpa_ripr'></span>

<h3>Description</h3>

<p>The data is the raw data for a combination dose of CyRPA and RIPR.
</p>

<dl>
<dt>well</dt><dd><p> one of iRBC (the max), uRBC (the min), RPMI (??), or comb (which is short for combination)</p>
</dd>
<dt>RIPR</dt><dd><p>dose of RIPR in mg/mL</p>
</dd>
<dt>CyRPA</dt><dd><p>dose of CyRPA in mg/mL</p>
</dd>
<dt>expxyrepz</dt><dd><p>the results from experiment x, sub item y, repetition z</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>cyrpa_ripr
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 38 rows and 15 columns.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("cyrpa_ripr")
head(cyrpa_ripr)
</code></pre>

<hr>
<h2 id='design_experiment'>Helper function to generate code to run an experiment</h2><span id='topic+design_experiment'></span>

<h3>Description</h3>

<p>Helper function to generate code to run an experiment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design_experiment(
  levels_A = c(0, 1 * 2^(-4:2)),
  levels_B = c(0, 2 * 2^(-4:2)),
  par = c(beta_A = 1, beta_B = 2, gamma_A = 0.5, gamma_B = 0.5, tau_1 = 3, tau_2 = 0.05),
  n_rep = 1,
  n_sims = 100,
  noise_par = c(a0 = 3, a1 = 0.01)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="design_experiment_+3A_levels_a">levels_A</code></td>
<td>
<p>levels of A used in the combination</p>
</td></tr>
<tr><td><code id="design_experiment_+3A_levels_b">levels_B</code></td>
<td>
<p>levels of B used in the combination</p>
</td></tr>
<tr><td><code id="design_experiment_+3A_par">par</code></td>
<td>
<p>named vector of model parameters</p>
</td></tr>
<tr><td><code id="design_experiment_+3A_n_rep">n_rep</code></td>
<td>
<p>number of total repetitions of experiment</p>
</td></tr>
<tr><td><code id="design_experiment_+3A_n_sims">n_sims</code></td>
<td>
<p>number of simulations to run</p>
</td></tr>
<tr><td><code id="design_experiment_+3A_noise_par">noise_par</code></td>
<td>
<p>named vector with 'a0' and 'a1' which are used to generate noise for the GIA.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>prints out code to copy and paste into <code>R</code> to simulate the expected coverage of your experiment under your designed hypothesis
</p>

<hr>
<h2 id='design_grid'>Function to design an experimental grid of combinations</h2><span id='topic+design_grid'></span>

<h3>Description</h3>

<p>Function to design an experimental grid of combinations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design_grid(
  levels_A = c(0, 1 * 2^(-4:2)),
  levels_B = c(0, 2 * 2^(-4:2)),
  n_rep = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="design_grid_+3A_levels_a">levels_A</code></td>
<td>
<p>levels of A used in the combination</p>
</td></tr>
<tr><td><code id="design_grid_+3A_levels_b">levels_B</code></td>
<td>
<p>levels of B used in the combination</p>
</td></tr>
<tr><td><code id="design_grid_+3A_n_rep">n_rep</code></td>
<td>
<p>number of total repetitions of experiment</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns dose_A, dose_B, and GIA for all possible combinations
</p>

<hr>
<h2 id='estimate_GIA'>Take in dose A and dose B combinations and estimate GIA</h2><span id='topic+estimate_GIA'></span>

<h3>Description</h3>

<p>Take in dose A and dose B combinations and estimate GIA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_GIA(model_params, dose_A, dose_B, fn = base_GIA, fn_list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_GIA_+3A_model_params">model_params</code></td>
<td>
<p>named vector of parameters to be used in function</p>
</td></tr>
<tr><td><code id="estimate_GIA_+3A_dose_a">dose_A</code></td>
<td>
<p>numeric vector of doses (e.g. mg/mL) of dose_A</p>
</td></tr>
<tr><td><code id="estimate_GIA_+3A_dose_b">dose_B</code></td>
<td>
<p>numeric vector of doses (e.g. mg/mL) of dose_B</p>
</td></tr>
<tr><td><code id="estimate_GIA_+3A_fn">fn</code></td>
<td>
<p>the function used to calculate GIA.  The default is base_GIA.  See ?base_GIA for more details.</p>
</td></tr>
<tr><td><code id="estimate_GIA_+3A_fn_list">fn_list</code></td>
<td>
<p>additional parameters to pass to the function to estimate GIA</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of the same size of dose_A and dose_B where each entry is the estimated GIA for the combination of dose A and dose B
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model_params &lt;- c("beta_A" = 1, "beta_B" = 2, "gamma_A" = .5,
"gamma_B" = .6,  "tau_1" = 1, "tau_2" = 0)
dose_A &lt;- c(0, 1, 0)
dose_B &lt;- c(0, 0, 1)
estimate_GIA(model_params, dose_A, dose_B)
</code></pre>

<hr>
<h2 id='estimate_params'>Estimate the parameters for a given data set and model</h2><span id='topic+estimate_params'></span>

<h3>Description</h3>

<p>Estimate the parameters for a given data set and model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_params(
  data,
  init_params = c(beta_A = 0.25, beta_B = 0.25, gamma_A = 0.5, gamma_B = 0.5, tau_1 = 0,
    tau_2 = 0),
  n_boot = 100,
  GIA_fn = base_GIA,
  S_fn = calc_S_base,
  fn_list = NULL,
  alpha = 0.05,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_params_+3A_data">data</code></td>
<td>
<p>data frame with the following columns
</p>

<ul>
<li><p>dose_Adose A mg/mL
</p>
</li>
<li><p>dose_Bdose B mg/mL
</p>
</li>
<li><p>GIAGIA
</p>
</li></ul>
</td></tr>
<tr><td><code id="estimate_params_+3A_init_params">init_params</code></td>
<td>
<p>named vector of parameters, that correspond to those used in 'GIA_fn'.  These will be used as the initial guesses.  A default is provided.</p>
</td></tr>
<tr><td><code id="estimate_params_+3A_n_boot">n_boot</code></td>
<td>
<p>number of boot straps to use to estimate confidence intervals of the parameters, GIA estimates, and values of S.  The default is 100.  If n_boot = 0, then no bootstraps will be run and only the point estimates will be returned.</p>
</td></tr>
<tr><td><code id="estimate_params_+3A_gia_fn">GIA_fn</code></td>
<td>
<p>function to calculate the GIA from dose_A and dose_B combinations and given set of parameters.  Default is base_GIA</p>
</td></tr>
<tr><td><code id="estimate_params_+3A_s_fn">S_fn</code></td>
<td>
<p>Function to calculate S. Default is calc_S_base</p>
</td></tr>
<tr><td><code id="estimate_params_+3A_fn_list">fn_list</code></td>
<td>
<p>additional arguments to pass to GIA_fn</p>
</td></tr>
<tr><td><code id="estimate_params_+3A_alpha">alpha</code></td>
<td>
<p>alpha level used to produce CIs.  The bootstrap will use a two-tailed method.  The default is .05 to produce a 95% CI</p>
</td></tr>
<tr><td><code id="estimate_params_+3A_verbose">verbose</code></td>
<td>
<p>logical indicating whether we should print where we are in the process.  Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following elements
</p>

<ul>
<li><p>params_esta data frame of dimension # of params x 4 where each row in the data frame is a parameter and where the columns are the mean, lower, alpha/2 quantile,  and upper,100 - alpha/2 quantile
</p>
</li>
<li><p>S_est a data frame of one row  x 4 where we provide the mean, lower, and upper estimates
</p>
</li>
<li><p>GIA_estthe original data with additional columns of the mean, lower, and upper estimates for each dose combination
</p>
</li>
<li><p>SSESum of Square Error for the model under the best (mean) parameters
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- loewesadditivity::cyrpa_ripr
df$dose_A &lt;- df$CyRPA
df$dose_B &lt;- df$RIPR
data &lt;- fortify_gia_data(df)
model_params &lt;- c("beta_A" = .5, "beta_B" = .5,
                 "gamma_A" = .5, "gamma_B" = .5,
                 "tau_1" = 0, "tau_2" = 0)
n_boot &lt;- 10
GIA_fn &lt;- base_GIA
S_fn &lt;- calc_S_base
fn_list &lt;- NULL
alpha &lt;- .05
verbose &lt;- FALSE
out &lt;- estimate_params(data = data,
init_params = model_params,
n_boot = n_boot,
GIA_fn = GIA_fn,
S_fn = S_fn,
fn_list = fn_list,
alpha = alpha,
verbose = verbose)
names(out)
</code></pre>

<hr>
<h2 id='fortify_gia_data'>Put GIA measurements into a dplyr format</h2><span id='topic+fortify_gia_data'></span>

<h3>Description</h3>

<p>Put GIA measurements into a dplyr format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fortify_gia_data(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fortify_gia_data_+3A_data">data</code></td>
<td>
<p>data frame of GIA measurements
</p>

<dl>
<dt>well</dt><dd><p>one of &quot;IRBC&quot;, &quot;uRBC&quot;, &quot;RPMI&quot;, or &quot;comb&quot;</p>
</dd>
<dt>dose_A</dt><dd><p>dose of A in mg/mL</p>
</dd>
<dt>dose_B</dt><dd><p>dose of B in mg/mL</p>
</dd>
<dt>exp(X)(Y)rep(Z)</dt><dd><p> where X = 1 or 2, Y = a or b, and Z = 1, 2, or 3</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>long data frame with columns well, dose_A, dose_B, plate, exp_num (experiment number), plate (a or b), rep_num (repetition number), gia_mean, and average iRBC and uRBC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- loewesadditivity::rh5_ama1ron2
df$dose_A &lt;- df$RH5
df$dose_B &lt;- df$AMA1RON2
fortified_df &lt;- fortify_gia_data(df)
head(fortified_df)
</code></pre>

<hr>
<h2 id='get_ed_line'>Helper function to get the ED50 line</h2><span id='topic+get_ed_line'></span>

<h3>Description</h3>

<p>Helper function to get the ED50 line
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ed_line(
  grid_width = 50,
  par,
  GIA_fn = base_GIA,
  fn_list = NULL,
  ed_val = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ed_line_+3A_grid_width">grid_width</code></td>
<td>
<p>number of levels to find points at</p>
</td></tr>
<tr><td><code id="get_ed_line_+3A_par">par</code></td>
<td>
<p>named vector of parameters</p>
</td></tr>
<tr><td><code id="get_ed_line_+3A_gia_fn">GIA_fn</code></td>
<td>
<p>function to calculate GIA</p>
</td></tr>
<tr><td><code id="get_ed_line_+3A_fn_list">fn_list</code></td>
<td>
<p>additional parameters to pass to GIA_fn</p>
</td></tr>
<tr><td><code id="get_ed_line_+3A_ed_val">ed_val</code></td>
<td>
<p>Which line to compute.  Default is 50</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with the following columns
</p>

<dl>
<dt>dose_A</dt><dd><p>dose of A (unscaled)</p>
</dd>
<dt>dose_B</dt><dd><p>dose of B (unscaled)</p>
</dd>
<dt>GIA</dt><dd><p>value of GIA %</p>
</dd>
</dl>


<hr>
<h2 id='make_grid'>Make a grid of points</h2><span id='topic+make_grid'></span>

<h3>Description</h3>

<p>Make a grid of points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_grid(n = 40, par, Amax = 2, Bmax = 2, n_reps = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_grid_+3A_n">n</code></td>
<td>
<p>number of levels on each side (Total grid is n^2).  Default is 40</p>
</td></tr>
<tr><td><code id="make_grid_+3A_par">par</code></td>
<td>
<p>named vector of model parameters</p>
</td></tr>
<tr><td><code id="make_grid_+3A_amax">Amax</code></td>
<td>
<p>max amount of number of ED50s.  Default is 2</p>
</td></tr>
<tr><td><code id="make_grid_+3A_bmax">Bmax</code></td>
<td>
<p>max amount of number of ED50s.  Default is 2.</p>
</td></tr>
<tr><td><code id="make_grid_+3A_n_reps">n_reps</code></td>
<td>
<p>number of replicates to repeat entire grid/experiment.  Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with the following columns
</p>

<dl>
<dt>dose_A</dt><dd><p>unscaled dose of A</p>
</dd>
<dt>dose_B</dt><dd><p>unscaled dose o B</p>
</dd>
<dt>rep</dt><dd><p>replicate number</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 40
 par &lt;- c("beta_A" = 1, "beta_B" = 2)
out &lt;- make_grid(n = 2, par = par)
exp_out &lt;- data.frame(dose_A = c(0, 2, 0, 2),
                      dose_B = c(0, 0, 4, 4),
                      rep = 1)
</code></pre>

<hr>
<h2 id='plot_curves'>Plot the surface and observations</h2><span id='topic+plot_curves'></span>

<h3>Description</h3>

<p>Plot the surface and observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_curves(
  est_list,
  dose_A = "Dose A",
  dose_B = "Dose B",
  title = "Curves of Dose Combos",
  subtitle = "",
  base_size = 14
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_curves_+3A_est_list">est_list</code></td>
<td>
<p>output from <code>estimate_params</code></p>
</td></tr>
<tr><td><code id="plot_curves_+3A_dose_a">dose_A</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_curves_+3A_dose_b">dose_B</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_curves_+3A_title">title</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_curves_+3A_subtitle">subtitle</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_curves_+3A_base_size">base_size</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- loewesadditivity::cyrpa_ripr
df$dose_A &lt;- df$CyRPA
df$dose_B &lt;- df$RIPR
data &lt;- fortify_gia_data(df)
model_params &lt;- c("beta_A" = .5, "beta_B" = .5,
                 "gamma_A" = .5, "gamma_B" = .5,
                 "tau_1" = 0, "tau_2" = 0)
n_boot &lt;- 10
GIA_fn &lt;- base_GIA
S_fn &lt;- calc_S_base
fn_list &lt;- NULL
alpha &lt;- .05
verbose &lt;- FALSE
out &lt;- estimate_params(data = data,
init_params = model_params,
n_boot = n_boot,
GIA_fn = GIA_fn,
S_fn = S_fn,
fn_list = fn_list,
alpha = alpha,
verbose = verbose)
plots &lt;- plot_curves(out, dose_A = "CyRPA",
dose_B = "RIPR")

</code></pre>

<hr>
<h2 id='plot_isobologram'>Plot the estimated isobologram</h2><span id='topic+plot_isobologram'></span>

<h3>Description</h3>

<p>Plot the estimated isobologram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_isobologram(
  est_list,
  dose_A = "Dose A",
  dose_B = "Dose B",
  GIA_fn = base_GIA,
  fn_list = NULL,
  title = "Isobologram Dose Combos",
  subtitle = "",
  base_size = 14
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_isobologram_+3A_est_list">est_list</code></td>
<td>
<p>output from <code>estimate_params</code></p>
</td></tr>
<tr><td><code id="plot_isobologram_+3A_dose_a">dose_A</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_isobologram_+3A_dose_b">dose_B</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_isobologram_+3A_gia_fn">GIA_fn</code></td>
<td>
<p>function to calculate GIA</p>
</td></tr>
<tr><td><code id="plot_isobologram_+3A_fn_list">fn_list</code></td>
<td>
<p>additional arguments to pass to GIA fn</p>
</td></tr>
<tr><td><code id="plot_isobologram_+3A_title">title</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_isobologram_+3A_subtitle">subtitle</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_isobologram_+3A_base_size">base_size</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- loewesadditivity::cyrpa_ripr
df$dose_A &lt;- df$CyRPA
df$dose_B &lt;- df$RIPR
data &lt;- fortify_gia_data(df)
model_params &lt;- c("beta_A" = .5, "beta_B" = .5,
                 "gamma_A" = .5, "gamma_B" = .5,
                 "tau_1" = 0, "tau_2" = 0)
n_boot &lt;- 10
GIA_fn &lt;- base_GIA
S_fn &lt;- calc_S_base
fn_list &lt;- NULL
alpha &lt;- .05
verbose &lt;- FALSE
out &lt;- estimate_params(data = data,
init_params = model_params,
n_boot = n_boot,
GIA_fn = GIA_fn,
S_fn = S_fn,
fn_list = fn_list,
alpha = alpha,
verbose = verbose)
plot_curves(out, dose_A = "CyRPA",
dose_B = "RIPR")

</code></pre>

<hr>
<h2 id='plot_surface'>Plot the surface and observations</h2><span id='topic+plot_surface'></span>

<h3>Description</h3>

<p>Plot the surface and observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_surface(
  est_list,
  GIA_fn = base_GIA,
  fn_list = NULL,
  xlab = "Dose A",
  ylab = "Dose B",
  title = "Surface Plot of Doses",
  subtitle = "",
  base_size = 14
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_surface_+3A_est_list">est_list</code></td>
<td>
<p>output from <code>estimate_params</code></p>
</td></tr>
<tr><td><code id="plot_surface_+3A_gia_fn">GIA_fn</code></td>
<td>
<p>function to calculate GIA</p>
</td></tr>
<tr><td><code id="plot_surface_+3A_fn_list">fn_list</code></td>
<td>
<p>additional arguments to pass to GIA fn</p>
</td></tr>
<tr><td><code id="plot_surface_+3A_xlab">xlab</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_surface_+3A_ylab">ylab</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_surface_+3A_title">title</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_surface_+3A_subtitle">subtitle</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
<tr><td><code id="plot_surface_+3A_base_size">base_size</code></td>
<td>
<p>to pass to ggplot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- loewesadditivity::cyrpa_ripr
df$dose_A &lt;- df$CyRPA
df$dose_B &lt;- df$RIPR
data &lt;- fortify_gia_data(df)
model_params &lt;- c("beta_A" = .5, "beta_B" = .5,
                 "gamma_A" = .5, "gamma_B" = .5,
                 "tau_1" = 0, "tau_2" = 0)
n_boot &lt;- 10
GIA_fn &lt;- base_GIA
S_fn &lt;- calc_S_base
fn_list &lt;- NULL
alpha &lt;- .05
verbose &lt;- FALSE
out &lt;- estimate_params(data = data,
init_params = model_params,
n_boot = n_boot,
GIA_fn = GIA_fn,
S_fn = S_fn,
fn_list = fn_list,
alpha = alpha,
verbose = verbose)
plot_surface(out)
</code></pre>

<hr>
<h2 id='rh5_ama1ron2'>RH5 and AMA1RON2</h2><span id='topic+rh5_ama1ron2'></span>

<h3>Description</h3>

<p>The data is the raw data for a combination dose of RH5 and AMA1RON2.  The data was collected by PEOPLE and on DATE on this GRANT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rh5_ama1ron2
</code></pre>


<h3>Format</h3>

<p>a 38 x 15 data set where the columns are of the following format
</p>

<dl>
<dt>well</dt><dd><p> one of iRBC (the max), uRBC (the min), RPMI (??), or comb (which is short for combination)</p>
</dd>
<dt>AMA1RON2</dt><dd><p>dose of AMA1RON2 in mg/mL</p>
</dd>
<dt>RH5</dt><dd><p>dose of RH5 in mg/mL</p>
</dd>
<dt>expxyrepz</dt><dd><p>the results from experiment x, sub item y, repetition z</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>data("rh5_ama1ron2")
head(rh5_ama1ron2)
</code></pre>

<hr>
<h2 id='rh5_rh4'>RH5 and RH4</h2><span id='topic+rh5_rh4'></span>

<h3>Description</h3>

<p>The data is the raw data for a combination dose of RH5 and RH4.  The data was originally published in Williams et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rh5_rh4
</code></pre>


<h3>Format</h3>

<p>a 48 x 3 data set where the columns are of the following format
</p>

<dl>
<dt>RH4</dt><dd><p>dose of RH4 in mg/mL</p>
</dd>
<dt>RH5</dt><dd><p>dose of RH5 in mg/mL</p>
</dd>
<dt>GIA</dt><dd><p>Percent Growth inhibition assay averaged over two experiments</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>data("rh5_rh4")
head(rh5_rh4)
</code></pre>

<hr>
<h2 id='simulate_coverage'>Simulate a GIA model with an assumed error structure</h2><span id='topic+simulate_coverage'></span>

<h3>Description</h3>

<p>Simulate a GIA model with an assumed error structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_coverage(
  n_sims = 10,
  n_boot = 100,
  verbose = TRUE,
  experimental_grid,
  model_par,
  alpha = 0.05,
  noise_par = c(a0 = 2, a1 = 0.01),
  GIA_fn = base_GIA,
  S_fn = calc_S_base,
  fn_list = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_coverage_+3A_n_sims">n_sims</code></td>
<td>
<p>number of coverage simulations</p>
</td></tr>
<tr><td><code id="simulate_coverage_+3A_n_boot">n_boot</code></td>
<td>
<p>number of bootstraps to use in each simulation</p>
</td></tr>
<tr><td><code id="simulate_coverage_+3A_verbose">verbose</code></td>
<td>
<p>logical indicating whether we should use print statements.  Default is TRUE</p>
</td></tr>
<tr><td><code id="simulate_coverage_+3A_experimental_grid">experimental_grid</code></td>
<td>
<p>data frame with columns 'dose_A' and 'dose_B'</p>
</td></tr>
<tr><td><code id="simulate_coverage_+3A_model_par">model_par</code></td>
<td>
<p>named vector of parameters corresponding to those used in GIA_fn()</p>
</td></tr>
<tr><td><code id="simulate_coverage_+3A_alpha">alpha</code></td>
<td>
<p>alpha level used to produce confidence intervals for each bootstrap</p>
</td></tr>
<tr><td><code id="simulate_coverage_+3A_noise_par">noise_par</code></td>
<td>
<p>named vector for the noise parameter.  Must have names &quot;a0&quot; and &quot;a1&quot;.  See <code>?base_gia</code> for more details.</p>
</td></tr>
<tr><td><code id="simulate_coverage_+3A_gia_fn">GIA_fn</code></td>
<td>
<p>function used to calculate GIA.  Default is base_GIA().</p>
</td></tr>
<tr><td><code id="simulate_coverage_+3A_s_fn">S_fn</code></td>
<td>
<p>function to calculate S</p>
</td></tr>
<tr><td><code id="simulate_coverage_+3A_fn_list">fn_list</code></td>
<td>
<p>additional parameters to pass to GIA_fn</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the following entries
</p>

<dl>
<dt>interaction_cov</dt><dd><p>This is the percent of times 0 was in the (1-alpha)% confidence interval for the interaction term &quot;tau_1&quot; from the simulated results</p>
</dd>
<dt>params_cov</dt><dd><p>This is the percent of times the true model parameter (those from model_par) lies in the (marginal) 95% confidence interval for that model parameter.</p>
</dd>
<dt>tau_pos</dt><dd><p>This is the percent of times the (1-alpha)% CI of &quot;tau_1&quot; was completely above 0.</p>
</dd>
<dt>tau_neg</dt><dd><p>This is the percent of times (1-alpha)% CI of &quot;tau_1&quot; is completely below zero</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- loewesadditivity::cyrpa_ripr
df$dose_A &lt;- df$CyRPA
df$dose_B &lt;- df$RIPR
data &lt;- fortify_gia_data(df)
model_params &lt;- c("beta_A" = .247, "beta_B" = .224,
                  "gamma_A" = .734, "gamma_B" = .806,
                  "tau_1" = .28, "tau_2" = -.28)
experimental_grid &lt;- make_grid(par = model_params,
                               n = 5)
n_boot &lt;- 100
n_sims &lt;- 10
GIA_fn &lt;- base_GIA
S_fn &lt;- calc_S_base
fn_list &lt;- NULL
alpha &lt;- .05
verbose &lt;- TRUE
## NOT RUN
##out &lt;- simulate_coverage(n_sims = n_sims,
  ##                      n_boot = n_boot,
   ##                     verbose = TRUE,
    ##                    experimental_grid = experimental_grid,
     ##                   model_par = model_params,
     ##                   alpha = .05,
   ##                     noise_par = c("a0" = 3, "a1" = .01),
   ##                     GIA_fn = base_GIA,
   ##                     fn_list = NULL)
##out
</code></pre>

<hr>
<h2 id='SSE_GIA'>Calculate the Sum of Squared Error</h2><span id='topic+SSE_GIA'></span>

<h3>Description</h3>

<p>Calculate the Sum of Squared Error
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SSE_GIA(par, data, GIA_fn = base_GIA, fn_list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SSE_GIA_+3A_par">par</code></td>
<td>
<p>named vector of parameters</p>
</td></tr>
<tr><td><code id="SSE_GIA_+3A_data">data</code></td>
<td>

<ul>
<li><p>dose_Adose A mg/mL
</p>
</li>
<li><p>dose_Bdose B mg/mL
</p>
</li>
<li><p>GIAGIA
</p>
</li></ul>
</td></tr>
<tr><td><code id="SSE_GIA_+3A_gia_fn">GIA_fn</code></td>
<td>
<p>function to calculate GIA</p>
</td></tr>
<tr><td><code id="SSE_GIA_+3A_fn_list">fn_list</code></td>
<td>
<p>additional arguments to pass GIA_fn</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sum of square error between observed and estimated
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
