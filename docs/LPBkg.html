<!DOCTYPE html><html><head><title>Help for package LPBkg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LPBkg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BestM'><p>Chooses the size of the polynomial basis</p></a></li>
<li><a href='#c_alpha2'><p>Approximated quantiles</p></a></li>
<li><a href='#denoise'><p>Coefficients of the denoised comparison density estimator</p></a></li>
<li><a href='#dhatL2'><p>CD-plot and adjusted deviance test</p></a></li>
<li><a href='#Legj'><p>Evaluation of normalized shifted Legendre polynomials</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Detecting New Signals under Background Mismodelling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Sara Algeri &lt;salgeri@umn.edu&gt;, Haoran Liu&lt;liu00728@umn.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sara Algeri &lt;salgeri@umn.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Given a postulated model and a set of data, the comparison density is estimated and the deviance test is implemented in order to assess if the data distribution deviates significantly from the postulated model. Finally, the results are summarized in a CD-plot as described in Algeri S. (2019) &lt;<a href="https://arxiv.org/abs/1906.06615">arXiv:1906.06615</a>&gt;. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.1), polynom</td>
</tr>
<tr>
<td>Imports:</td>
<td>orthopolynom,Hmisc,grDevices,graphics,stats</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-03 21:11:08 UTC; salgeri</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-04 23:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BestM'>Chooses the size of the polynomial basis</h2><span id='topic+BestM'></span>

<h3>Description</h3>

<p>Computes the deviance p-values considering different sizes of the polynomial basis and selects the one for which the deviance p-value is the smallest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BestM(data, g, Mmax = 20, range = c(min(data),max(data)))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BestM_+3A_data">data</code></td>
<td>
<p>A vector of data. See details. </p>
</td></tr>
<tr><td><code id="BestM_+3A_g">g</code></td>
<td>
<p>The postulated model from which we want to assess if deviations occur.</p>
</td></tr>
<tr><td><code id="BestM_+3A_mmax">Mmax</code></td>
<td>
<p>The maximum size of the polynomial basis from which a suitable value <code>M</code> is selected (the default is 20). See details.</p>
</td></tr>
<tr><td><code id="BestM_+3A_range">range</code></td>
<td>
<p>Range of the data/ search region considered. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>data</code> collects the data for which we want to test if deviations occur from the postulated model specified in the argument <code>g</code>. As in Algeri, 2019, the sample specified under <code>data</code> corresponds to the source-free sample in the background calibration phase and to the physics sample in the signal search phase.
The value <code>M</code> selected determines the smoothness of the estimated comparison density, with smaller values of M leading to smoother estimates. The deviance test is used to select the value <code>M</code> which leads to the most significant deviation from the postulated model. The default value for <code>Mmax</code> is set to 20. Notice that numerical issues may
arise for larger values of <code>Mmax</code>.</p>


<h3>Value</h3>

<table>
<tr><td><code>pvals</code></td>
<td>
<p>The deviance test p-value obtained for each values of <code>M</code> (from 1 to <code>Mmax</code>) considered.</p>
</td></tr>
<tr><td><code>minp</code></td>
<td>
<p>The minimum value of the deviance p-values observed.</p>
</td></tr>
<tr><td><code>Msel</code></td>
<td>
<p>The value of <code>M</code> at which the minimum deviance p-values is achieved.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Algeri</p>


<h3>References</h3>

<p>S. Algeri, 2019. Detecting new signals under background mismodelling	&lt;arXiv:1906.06615&gt;. </p>


<h3>See Also</h3>

<p><code><a href="#topic+denoise">denoise</a></code>, <code><a href="#topic+dhatL2">dhatL2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Generating data
x&lt;-rnorm(1000,10,7)
data&lt;-x[x&gt;=10 &amp; x&lt;=20]

#Create suitable postulated quantile function of data
G&lt;-pnorm(20,5,15)-pnorm(10,5,15)
g&lt;-function(x){dnorm(x,5,15)/G}

Mmax=10
range=c(10,20)

BestM(data,g,Mmax,range)

</code></pre>

<hr>
<h2 id='c_alpha2'>Approximated quantiles</h2><span id='topic+c_alpha2'></span>

<h3>Description</h3>

<p>Approximates the quantiles of the supremum of the comparison density estimator using tube formulae and assuming that $H_0$ is true.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>c_alpha2(M, IDs, alpha = 0.05, c_interval = c(1, 10))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="c_alpha2_+3A_m">M</code></td>
<td>
<p>The size of the polynomial basis used to estimate the comparison density.</p>
</td></tr>
<tr><td><code id="c_alpha2_+3A_ids">IDs</code></td>
<td>
<p>The IDs of the polynomial terms to be used out of the <code>M</code> considered.</p>
</td></tr>
<tr><td><code id="c_alpha2_+3A_alpha">alpha</code></td>
<td>
<p>Desired significance level.</p>
</td></tr>
<tr><td><code id="c_alpha2_+3A_c_interval">c_interval</code></td>
<td>
<p>Lower and  upper bounds for the quantile being computed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Approximated quantile of order <code>1-alpha</code> of the supremum of the comparison density estimator.
</p>


<h3>Author(s)</h3>

<p>Sara Algeri</p>


<h3>References</h3>

<p>S. Algeri, 2019. Detecting new signals under background mismodelling	&lt;arXiv:1906.06615&gt;.
</p>
<p>L.A. Wasserman, 2005. All of Nonparametric Statistics. Springer Texts in Statistics.</p>


<h3>See Also</h3>

<p><code><a href="#topic+dhatL2">dhatL2</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>c_alpha2(5, c(2,4), alpha = 0.05, c_interval = c(1, 10))
</code></pre>

<hr>
<h2 id='denoise'>Coefficients of the denoised comparison density estimator</h2><span id='topic+denoise'></span>

<h3>Description</h3>

<p>Selects the largest coefficients according to the AIC or BIC criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>denoise(LP, n, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="denoise_+3A_lp">LP</code></td>
<td>
<p>Original vector of coefficients estimates. See details.</p>
</td></tr>
<tr><td><code id="denoise_+3A_n">n</code></td>
<td>
<p>The dimension of the sample on which the estimates in <code>LP</code> have been obtained.</p>
</td></tr>
<tr><td><code id="denoise_+3A_method">method</code></td>
<td>
<p>Either &ldquo;AIC&rdquo; or &ldquo;BIC&rdquo;. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Give a vector of <code>M</code> coefficient estimates, the largest is selected according to the AIC or BIC criterion as described in Algeri, 2019 and Mukhopadhyay, 2017. </p>


<h3>Value</h3>

<p>Selected coefficient estimates.
</p>


<h3>Author(s)</h3>

<p>Sara Algeri</p>


<h3>References</h3>

<p>S. Algeri, 2019. Detecting new signals under background mismodelling.	&lt;arXiv:1906.06615&gt;.
</p>
<p>S. Mukhopadhyay, 2017. Large-scale mode identification and data-driven sciences. Electronic Journal of Statistics 11 (2017), no. 1, 215&ndash;240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Legj">Legj</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating data
x&lt;-rnorm(1000,10,7)
xx&lt;-x[x&gt;=10 &amp; x&lt;=20]

#create suitable postulated quantile function
G&lt;-pnorm(20,5,15)-pnorm(10,5,15)
g&lt;-function(x){dnorm(x,5,15)/G}

#Vectorize quantile function
g&lt;-Vectorize(g)
u&lt;-g(xx)

Mmax=20
S&lt;- as.matrix(Legj(u=u,m=Mmax))
n&lt;-length(u)

LP &lt;- apply(S,FUN="mean",2)

denoise(LP,n=n,method="AIC")
</code></pre>

<hr>
<h2 id='dhatL2'>CD-plot and adjusted deviance test</h2><span id='topic+dhatL2'></span>

<h3>Description</h3>

<p>Construction of CD-plot and adjusted deviance test. The confidence bands are also adjusted for post-selection inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dhatL2(data, g, M = 6, Mmax = NULL, smooth = TRUE,
  criterion = "AIC", hist.u = TRUE, breaks = 20, ylim = c(0, 2.5),
  range = c(min(data),max(data)), sigma = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dhatL2_+3A_data">data</code></td>
<td>
<p>A vector of data. See details.</p>
</td></tr>
<tr><td><code id="dhatL2_+3A_g">g</code></td>
<td>
<p>The postulated model from which we want to assess if deviations occur.</p>
</td></tr>
<tr><td><code id="dhatL2_+3A_m">M</code></td>
<td>
<p>The desired size of the polynomial basis to be used.</p>
</td></tr>
<tr><td><code id="dhatL2_+3A_mmax">Mmax</code></td>
<td>
<p>The maximum size of the polynomial basis from which <code>M</code> was selected (the default is <code>20</code>). See details.</p>
</td></tr>
<tr><td><code id="dhatL2_+3A_smooth">smooth</code></td>
<td>
<p>A logical argument indicating if a denoised solution should be implemented. The default is <code>FALSE</code>, meaning that the full solution should be implemented. See details.</p>
</td></tr>
<tr><td><code id="dhatL2_+3A_criterion">criterion</code></td>
<td>
<p>If <code>smooth=TRUE</code>, the criterion with respect to which the denoising process should be implemented. The two possibilities are <code>"AIC"</code> or <code>"BIC"</code>. See details.</p>
</td></tr>
<tr><td><code id="dhatL2_+3A_hist.u">hist.u</code></td>
<td>
<p>A logical argument indicating if the CD-plot should be displayed or not. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="dhatL2_+3A_breaks">breaks</code></td>
<td>
<p>If <code>hist.u=TRUE</code>, the number of breaks of the CD-plot. The default is <code>20</code>.</p>
</td></tr>
<tr><td><code id="dhatL2_+3A_ylim">ylim</code></td>
<td>
<p>If <code>hist.u=TRUE</code>, the range of the y-axis of the CD-plot.</p>
</td></tr>
<tr><td><code id="dhatL2_+3A_range">range</code></td>
<td>
<p>Range of the data/search region considered. </p>
</td></tr>
<tr><td><code id="dhatL2_+3A_sigma">sigma</code></td>
<td>
<p>The significance level (in sigmas) with respect to which the confidence bands should be constructed. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>data</code> collects the data for which we want to test if its distribution deviates from the one of the postulated model specified in the argument <code>g</code>. In Algeri, 2019, the sample specified under <code>data</code> corresponds to the source-free sample in the background calibration phase and to the physics sample in the signal search phase.
The value <code>M</code> selected determines the smoothness of the estimated comparison density, with smaller values of <code>M</code> leading to smoother estimates. The deviance test is used to select the value <code>M</code> which leads to the most significant deviation from the postulated model. The default value for <code>Mmax</code> is set to <code>20</code>. Notice that numerical issues may
arise for larger values of <code>Mmax</code>.
If <code>smooth=TRUE</code> the largest coefficient estimates are selected according to either the AIC or BIC criterion as described in Algeri, 2019 and Mukhopadhyay, 2017.
If <code>Mmax&gt;1</code> and/or <code>smooth=TRUE</code>, post-selection Bonferroni's correction is automatically implemented to both the deviance test p-value and the confidence bands. The desired level of significance can be expressed as one minus the cdf of a standard normal evaluated at <code>sigma</code> (see Algeri, 2019).
</p>


<h3>Value</h3>

<table>
<tr><td><code>Deviance</code></td>
<td>
<p>Value of the deviance test statistic.</p>
</td></tr>
<tr><td><code>Dev_pvalue</code></td>
<td>
<p>Unadjusted p-value of the deviance test.</p>
</td></tr>
<tr><td><code>Dev_adj_pvalue</code></td>
<td>
<p>Post-selection Bonferroni adjusted p-value of the deviance test.</p>
</td></tr>
<tr><td><code>kstar</code></td>
<td>
<p>Number of coefficients selected by the denoising process. If <code>smooth=FALSE</code>, <code>kstar=M</code>.</p>
</td></tr>
<tr><td><code>dhat</code></td>
<td>
<p>Function corresponding to the estimated comparison density in the u domain.</p>
</td></tr>
<tr><td><code>dhat.x</code></td>
<td>
<p>Function corresponding to the estimated comparison density in the x domain.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>Function corresponding to the estimated standard errors of the comparison density in the u domain.</p>
</td></tr>
<tr><td><code>LBf1</code></td>
<td>
<p>Function corresponding to the lower bound of the confidence bands under  in u domain.</p>
</td></tr>
<tr><td><code>UBf1</code></td>
<td>
<p>Function corresponding to the upper bound of the confidence bands in u domain.</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p>Function corresponding to the estimated density of the data.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Vector of values corresponding to the cdf of the model specified in <code>g</code> evaluated at the vector <code>data</code>.</p>
</td></tr>
<tr><td><code>LP</code></td>
<td>
<p>Estimates of the coefficients.</p>
</td></tr>
<tr><td><code>G</code></td>
<td>
<p>Cumulative density function of the postulated model specified in the argument <code>g</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Algeri</p>


<h3>References</h3>

<p>S. Algeri, 2019. Detecting new signals under background mismodelling.	&lt;arXiv:1906.06615&gt;.
</p>
<p>S. Mukhopadhyay, 2017. Large-scale mode identification and data-driven sciences. Electronic Journal of Statistics 11 (2017), no. 1, 215&ndash;240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Legj">Legj</a></code>,<code><a href="#topic+BestM">BestM</a></code>,<code><a href="#topic+denoise">denoise</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generaing data
x&lt;-rnorm(1000,10,7)
xx&lt;-x[x&gt;=10 &amp; x&lt;=20]

#create suitable postulated quantile function of data
G&lt;-pnorm(20,5,15)-pnorm(10,5,15)
g&lt;-function(x){dnorm(x,5,15)/G}

#Choose best M
Mmax=20
range=c(10,20)
m&lt;-BestM(data=xx,g, Mmax,range)

# vectorize postulated quantile function
g&lt;-Vectorize(g)
u&lt;-g(xx)

#M has to be sufficient big, otherwise dhatL2 function will crush.
#So,here we set m eqaul 6 as an example
m&lt;-6
comp.density&lt;-dhatL2(data=xx,g, M=m, Mmax=Mmax,smooth=FALSE,criterion="AIC",hist.u=TRUE,breaks=20,
         ylim=c(0,2.5),range=range,sigma=2)
</code></pre>

<hr>
<h2 id='Legj'>Evaluation of normalized shifted Legendre polynomials</h2><span id='topic+Legj'></span>

<h3>Description</h3>

<p>Evaluates the a basis of normalized shifted Legendre polynomials over a specified data vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Legj(u, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Legj_+3A_u">u</code></td>
<td>
<p>Data vector on which the polynomials are to be evaluated.</p>
</td></tr>
<tr><td><code id="Legj_+3A_m">m</code></td>
<td>
<p>The size of the basis to be considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numerical values of the first <code>m</code> normalized shifted Legendre polynomials.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-rnorm(1000,10,7)
xx&lt;-x[x&gt;=10 &amp; x&lt;=20]
G&lt;-pnorm(20,5,15)-pnorm(10,5,15)
g&lt;-function(x){dnorm(x,5,15)/G}
g&lt;-Vectorize(g)
u&lt;-g(xx)
Mmax=20
s&lt;-as.matrix(Legj(u,Mmax))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
