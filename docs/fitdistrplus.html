<!DOCTYPE html><html lang="en"><head><title>Help for package fitdistrplus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fitdistrplus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fitdistrplus-package'><p>Overview of the <span class="pkg">fitdistrplus</span> package</p></a></li>
<li><a href='#bootdist'><p> Bootstrap simulation of uncertainty for non-censored data</p></a></li>
<li><a href='#bootdistcens'><p> Bootstrap simulation of uncertainty for censored data</p></a></li>
<li><a href='#CIcdfplot'><p>Empirical cumulative distribution function with pointwise confidence intervals on probabilities or on quantiles</p></a></li>
<li><a href='#danish'><p> Danish reinsurance claim dataset</p></a></li>
<li><a href='#dataFAQ'><p>Datasets for the FAQ</p></a></li>
<li><a href='#descdist'><p> Description of an empirical distribution for non-censored data</p></a></li>
<li><a href='#detectbound'><p> Detect bounds for density function</p></a></li>
<li><a href='#endosulfan'><p>Species Sensitivity Distribution (SSD) for endosulfan</p></a></li>
<li><a href='#fitdist'><p> Fit of univariate distributions to non-censored data</p></a></li>
<li><a href='#fitdistcens'><p>Fitting of univariate distributions to censored data</p></a></li>
<li><a href='#fluazinam'><p>Species-Sensitivity Distribution (SSD) for Fluazinam</p></a></li>
<li><a href='#fremale'><p>Fictive survival dataset of a french Male population</p></a></li>
<li><a href='#gofstat'><p> Goodness-of-fit statistics</p></a></li>
<li><a href='#graphcomp'><p>Graphical comparison of multiple fitted distributions (for non-censored data)</p></a></li>
<li><a href='#graphcompcens'><p>Graphical comparison of multiple fitted distributions for censored data</p></a></li>
<li><a href='#groundbeef'><p>Ground beef serving size data set</p></a></li>
<li><a href='#logLikplot'><p>(Log)likelihood plot for a fit using maximum likelihood</p></a></li>
<li><a href='#logLiksurface'><p>(Log)likelihood surfaces or (log)likelihood curves</p></a></li>
<li><a href='#mgedist'><p> Maximum goodness-of-fit fit of univariate continuous distributions</p></a></li>
<li><a href='#mledist'><p> Maximum likelihood fit of univariate distributions</p></a></li>
<li><a href='#mmedist'><p> Matching moment fit of univariate distributions</p></a></li>
<li><a href='#msedist'><p>Maximum spacing estimation of univariate distributions</p></a></li>
<li><a href='#plotdist'><p> Plot of empirical and theoretical distributions for non-censored data</p></a></li>
<li><a href='#plotdistcens'><p> Plot of empirical and theoretical distributions for censored data</p></a></li>
<li><a href='#prefit'><p>Pre-fitting procedure</p></a></li>
<li><a href='#qmedist'><p> Quantile matching fit of univariate distributions</p></a></li>
<li><a href='#quantile'><p>Quantile estimation from a fitted distribution</p></a></li>
<li><a href='#salinity'><p>Species-Sensitivity Distribution (SSD) for salinity tolerance</p></a></li>
<li><a href='#smokedfish'><p>Contamination data of Listeria monocytogenes in smoked fish</p></a></li>
<li><a href='#Surv2fitdistcens'><p>Handling of data formated as in the survival package for use in fitdistcens()</p></a></li>
<li><a href='#toxocara'><p>Parasite abundance in insular feral cats</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Help to Fit of a Parametric Distribution to Non-Censored or
Censored Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-2</td>
</tr>
<tr>
<td>Description:</td>
<td>Extends the fitdistr() function (of the MASS package) with several functions 
  to help the fit of a parametric distribution to non-censored or censored data. 
  Censored data may contain left censored, right censored and interval censored values, 
  with several lower and upper bounds. In addition to maximum likelihood estimation (MLE), 
  the package provides moment matching (MME), quantile matching (QME), maximum goodness-of-fit 
  estimation (MGE) and maximum spacing estimation (MSE) methods (available only for 
  non-censored data). Weighted versions of MLE, MME, QME and MSE are available. See e.g. 
  Casella &amp; Berger (2002), Statistical inference, Pacific Grove, for a general introduction 
  to parametric estimation.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), MASS, grDevices, survival, methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>actuar, rgenoud, mc2d, gamlss.dist, knitr, ggplot2,
GeneralizedHyperbolic, rmarkdown, Hmisc, bookdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://lbbe-software.github.io/fitdistrplus/">https://lbbe-software.github.io/fitdistrplus/</a>,
<a href="https://lbbe.univ-lyon1.fr/fr/fitdistrplus">https://lbbe.univ-lyon1.fr/fr/fitdistrplus</a>,
<a href="https://github.com/lbbe-software/fitdistrplus">https://github.com/lbbe-software/fitdistrplus</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lbbe-software/fitdistrplus/issues">https://github.com/lbbe-software/fitdistrplus/issues</a></td>
</tr>
<tr>
<td>Contact:</td>
<td>Marie-Laure Delignette-Muller
&lt;marielaure.delignettemuller@vetagro-sup.fr&gt; or Christophe
Dutang &lt;christophe.dutang@ensimag.fr&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-07 11:51:12 UTC; siberchicot</td>
</tr>
<tr>
<td>Author:</td>
<td>Marie-Laure Delignette-Muller
    <a href="https://orcid.org/0000-0001-5453-3994"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Christophe Dutang <a href="https://orcid.org/0000-0001-6732-1501"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Regis Pouillot [ctb],
  Jean-Baptiste Denis [ctb],
  Aurélie Siberchicot
    <a href="https://orcid.org/0000-0002-7638-8318"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aurélie Siberchicot &lt;aurelie.siberchicot@univ-lyon1.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-07 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fitdistrplus-package'>Overview of the <span class="pkg">fitdistrplus</span> package</h2><span id='topic+fitdistrplus'></span><span id='topic+fitdistrplus-package'></span>

<h3>Description</h3>

<p>The idea of this package emerged in 2008 from a collaboration between 
JB Denis, R Pouillot and ML Delignette who at this time worked in the
area of quantitative risk assessment. The implementation of this package 
was a part of a more general project named &quot;Risk assessment with R&quot; 
gathering different packages and 
hosted in <a href="https://r-forge.r-project.org/projects/riskassessment/">R-forge</a>.
</p>
<p>The <span class="pkg">fitdistrplus</span> package was first written by ML Delignette-Muller and made 
available in <a href="https://cran.r-project.org/package=fitdistrplus">CRAN</a> on 2009 and presented at the <a href="https://www.r-project.org/conferences/useR-2009/">2009 useR conference</a> in Rennes.
A few months after, C Dutang joined the project by
starting to participate to the implementation of the <span class="pkg">fitdistrplus</span> package.
The package has also been presented at the <a href="https://www.r-project.org/conferences/useR-2011/">2011 useR conference</a> and at the 2eme rencontres R in 2013 (https://r2013-lyon.sciencesconf.org/).
</p>
<p>Four vignettes are available within the package:
</p>

<ul>
<li><p> a <a href="https://lbbe-software.github.io/fitdistrplus/articles/fitdistrplus_vignette.html">general overview</a> of the package published in the 
Journal of Statistical Software (<a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>),
</p>
</li>
<li><p> a document answering the most <a href="https://lbbe-software.github.io/fitdistrplus/articles/FAQ.html">Frequently Asked Questions</a>,
</p>
</li>
<li><p> a document presenting a <a href="https://lbbe-software.github.io/fitdistrplus/articles/Optimalgo.html">benchmark of optimization algorithms</a> when finding parameters,
</p>
</li>
<li><p> a document about <a href="https://lbbe-software.github.io/fitdistrplus/articles/fitdistrplus_vignette.html">starting values</a>.
</p>
</li></ul>

<p>The <span class="pkg">fitdistrplus</span> package is a general package that aims at helping the fit of univariate parametric 
distributions to censored or
non-censored data. The two main functions are 
<code><a href="#topic+fitdist">fitdist</a></code> for fit on non-censored data and 
<code><a href="#topic+fitdistcens">fitdistcens</a></code> for fit on censored data. 
</p>
<p>The choice of candidate 
distributions to fit may be helped using functions <code><a href="#topic+descdist">descdist</a></code> and
<code><a href="#topic+plotdist">plotdist</a></code> for non-censored data and <code><a href="#topic+plotdistcens">plotdistcens</a></code>
for censored data). 
</p>
<p>Using functions <code><a href="#topic+fitdist">fitdist</a></code> and 
<code><a href="#topic+fitdistcens">fitdistcens</a></code>, different methods can be used to estimate the 
distribution parameters: 
</p>

<ul>
<li><p> maximum likelihood estimation by default (<code><a href="#topic+mledist">mledist</a></code>),
</p>
</li>
<li><p> moment matching estimation (<code><a href="#topic+mmedist">mmedist</a></code>), 
</p>
</li>
<li><p> quantile matching estimation (<code><a href="#topic+qmedist">qmedist</a></code>),
</p>
</li>
<li><p> maximum goodness-of-fit estimation (<code><a href="#topic+mgedist">mgedist</a></code>). 
</p>
</li></ul>

<p>For classical distributions initial values are automatically calculated
if not provided by the user.
Graphical functions <code><a href="#topic+plotdist">plotdist</a></code> and <code><a href="#topic+plotdistcens">plotdistcens</a></code> 
can be used to help a manual calibration of initial values for parameters
of non-classical distributions. Function <code><a href="#topic+prefit">prefit</a></code> is proposed
to help the definition of good starting values in the special case of
constrained parameters. In the case where maximum likelihood is chosen
as the estimation method, function <code><a href="#topic+llplot">llplot</a></code> enables to
visualize loglikelihood contours.
</p>
<p>The goodness-of-fit of fitted distributions (a single fit or multiple fits) can be explored
using different graphical functions (<code><a href="#topic+cdfcomp">cdfcomp</a></code>, <code><a href="#topic+denscomp">denscomp</a></code>,
<code><a href="#topic+qqcomp">qqcomp</a></code> and <code><a href="#topic+ppcomp">ppcomp</a></code> for non-censored data and
<code><a href="#topic+cdfcompcens">cdfcompcens</a></code> for censored data). Goodness-of-fit statistics are also 
provided for non-censored data using function <code><a href="#topic+gofstat">gofstat</a></code>.
</p>
<p>Bootstrap is proposed to quantify the uncertainty on parameter estimates
(functions <code><a href="#topic+bootdist">bootdist</a></code> and <code><a href="#topic+bootdistcens">bootdistcens</a></code>)
and also to quantify the uncertainty on CDF or quantiles estimated
from the fitted distribution (<code><a href="#topic+quantile">quantile</a></code> and <code><a href="#topic+CIcdfplot">CIcdfplot</a></code>).
</p>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>

<hr>
<h2 id='bootdist'> Bootstrap simulation of uncertainty for non-censored data</h2><span id='topic+bootdist'></span><span id='topic+plot.bootdist'></span><span id='topic+print.bootdist'></span><span id='topic+summary.bootdist'></span><span id='topic+density.bootdist'></span><span id='topic+plot.density.bootdist'></span><span id='topic+print.density.bootdist'></span>

<h3>Description</h3>

<p>Uses parametric or nonparametric bootstrap resampling in order to simulate uncertainty 
in the parameters of the distribution fitted to non-censored data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootdist(f, bootmethod = "param", niter = 1001, silent = TRUE, 
      parallel = c("no", "snow", "multicore"), ncpus)
## S3 method for class 'bootdist'
print(x, ...)
## S3 method for class 'bootdist'
plot(x, main = "Bootstrapped values of parameters", enhance = FALSE, 
    trueval = NULL, rampcol = NULL, nbgrid = 100, nbcol = 100, ...)
## S3 method for class 'bootdist'
summary(object, ...)
## S3 method for class 'bootdist'
density(..., bw = nrd0, adjust = 1, kernel = "gaussian")
## S3 method for class 'density.bootdist'
plot(x, mar=c(4,4,2,1), lty=NULL, col=NULL, lwd=NULL, ...)
## S3 method for class 'density.bootdist'
print(x, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootdist_+3A_f">f</code></td>
<td>
<p> An object of class <code>"fitdist"</code>, output of the <code><a href="#topic+fitdist">fitdist</a></code> function.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_bootmethod">bootmethod</code></td>
<td>
<p> A character string coding for the type of resampling : <code>"param"</code> 
for a parametric resampling and <code>"nonparam"</code> for a nonparametric resampling of data.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_niter">niter</code></td>
<td>
<p> The number of samples drawn by bootstrap.  </p>
</td></tr>
<tr><td><code id="bootdist_+3A_silent">silent</code></td>
<td>
<p>A logical to remove or show warnings and errors when bootstraping.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_parallel">parallel</code></td>
<td>
<p>The type of parallel operation to be used, <code>"snow"</code> or <code>"multicore"</code>
(the second one not being available on Windows),
or <code>"no"</code> if no parallel operation.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_ncpus">ncpus</code></td>
<td>
<p>Number of processes to be used in parallel operation : 
typically one would fix it to the number of available CPUs.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_x">x</code></td>
<td>
<p> An object of class <code>"bootdist"</code> or <code>"density.bootdist"</code>.  </p>
</td></tr>
<tr><td><code id="bootdist_+3A_object">object</code></td>
<td>
<p> An object of class <code>"bootdist"</code>.  </p>
</td></tr>
<tr><td><code id="bootdist_+3A_main">main</code></td>
<td>
<p>an overall title for the plot: see <code><a href="graphics.html#topic+title">title</a></code>,
default to <code>"Bootstrapped values of parameters"</code>.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_enhance">enhance</code></td>
<td>
<p>a logical to get an enhanced plot.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_trueval">trueval</code></td>
<td>
<p>when relevant, a numeric vector with the true value of 
parameters (for backfitting purposes).</p>
</td></tr>
<tr><td><code id="bootdist_+3A_rampcol">rampcol</code></td>
<td>
<p>colors to interpolate; must be a valid argument to 
<code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a>()</code>.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_nbgrid">nbgrid</code></td>
<td>
<p>Number of grid points in each direction. Can be scalar or a 
length-2 integer vector.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_nbcol">nbcol</code></td>
<td>
<p>An integer argument, the required number of colors</p>
</td></tr>
<tr><td><code id="bootdist_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods or <code>"bootdist"</code>
objects for <code>density</code>.</p>
</td></tr>
<tr><td><code id="bootdist_+3A_bw">bw</code>, <code id="bootdist_+3A_adjust">adjust</code>, <code id="bootdist_+3A_kernel">kernel</code></td>
<td>
<p>resp. the smoothing bandwidth, the scaling factor,
the kernel used, see <code><a href="stats.html#topic+density">density</a></code>.</p>
</td></tr>  
<tr><td><code id="bootdist_+3A_mar">mar</code></td>
<td>
<p>A numerical vector of the form <code>c(bottom, left, top, right)</code>, 
see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr> 
<tr><td><code id="bootdist_+3A_lty">lty</code>, <code id="bootdist_+3A_col">col</code>, <code id="bootdist_+3A_lwd">lwd</code></td>
<td>
<p>resp. the line type, the color, the line width, 
see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>Samples are drawn by parametric bootstrap (resampling from the distribution fitted by 
<code><a href="#topic+fitdist">fitdist</a></code>) or nonparametric bootstrap (resampling with replacement from the 
data set). On each bootstrap sample the function 
<code><a href="#topic+mledist">mledist</a></code>  (or <code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, <code><a href="#topic+mgedist">mgedist</a></code> 
according to the component <code>f$method</code> of the object of class <code>"fitdist"</code>) is 
used to estimate bootstrapped values of parameters. When that function fails
to converge, <code>NA</code> values are returned. Medians and 2.5 and 97.5 percentiles are 
computed by removing <code>NA</code> values. 
The medians and the 95 percent confidence intervals of parameters (2.5 and 97.5 
percentiles) are printed in the summary.
If inferior to the whole number of iterations, the number of iterations for which 
the function converges is also printed in the summary.
</p>
<p>By default (when <code>enhance=FALSE</code>), the plot of an object of class 
<code>"bootdist"</code> consists in a scatterplot or a matrix 
of scatterplots of the bootstrapped values of parameters.
It uses the function <code><a href="graphics.html#topic+stripchart">stripchart</a></code> when the fitted distribution
is characterized by only one parameter, the function <code><a href="base.html#topic+plot">plot</a></code> when there
are two paramters and the function <code><a href="graphics.html#topic+pairs">pairs</a></code> in other cases.
In these last cases, it provides a representation of the joint uncertainty distribution 
of the fitted parameters.
</p>
<p>When <code>enhance=TRUE</code>, a personalized plot version of <code><a href="graphics.html#topic+pairs">pairs</a></code> is used where
upper graphs are scatterplots and lower graphs are heatmap image using <code><a href="graphics.html#topic+image">image</a></code>
based on a kernel based estimator for the 2D density function (using <code>kde2d</code> from
MASS package).
Arguments <code>rampcol</code>, <code>nbgrid</code>, <code>nbcol</code> can be used to customize the plots.
Defautls values are <code>rampcol=c("green", "yellow", "orange", "red")</code>, <code>nbcol=100</code> 
(see <code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a>()</code>), <code>nbgrid=100</code> (see <code>kde2d</code>).
In addition, when fitting parameters on simulated datasets for backtesting purposes, an
additional argument <code>trueval</code> can be used to plot a cross at the true value.
</p>
<p>It is possible to accelerate the bootstrap using parallelization. We recommend you to
use <code>parallel = "multicore"</code>, or <code>parallel = "snow"</code> if you work on Windows,
and to fix <code>ncpus</code> to the number of available processors.
</p>
<p><code>density</code> computes the empirical density of <code>bootdist</code> objects using the
<code><a href="stats.html#topic+density">density</a></code> function (with Gaussian kernel by default). 
It returns an object of class <code>density.bootdist</code> for which <code>print</code>
and <code>plot</code> methods are provided.
</p>


<h3>Value</h3>

 
<p><code>bootdist</code> returns an object of class <code>"bootdist"</code>, a list with 6 components,
</p>
<table role = "presentation">
<tr><td><code>estim</code></td>
<td>
<p> a data frame containing the bootstrapped values of parameters.</p>
</td></tr>
<tr><td><code>converg</code></td>
<td>
<p> a vector containing the codes for convergence obtained if an iterative method is
used to estimate parameters on 
each bootstraped data set (and 0 if a closed formula is used).</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> A character string coding for the type of resampling : <code>"param"</code> for a parametric
resampling and <code>"nonparam"</code> for a nonparametric resampling. </p>
</td></tr>
<tr><td><code>nbboot</code></td>
<td>
<p> The number of samples drawn by bootstrap.</p>
</td></tr>   
<tr><td><code>CI</code></td>
<td>
<p> bootstrap medians and 95 percent confidence percentile intervals of parameters. </p>
</td></tr>
<tr><td><code>fitpart</code></td>
<td>
<p> The object of class <code>"fitdist"</code> on which the bootstrap procedure
was applied.</p>
</td></tr>
</table>
<p>Generic functions:
</p>
       
<dl>
<dt><code>print</code></dt><dd>
<p>The print of a <code>"bootdist"</code> object shows the bootstrap parameter estimates. If inferior to the whole number of bootstrap iterations, 
the number of iterations 
for which the estimation converges is also printed.
</p>
</dd>
<dt><code>summary</code></dt><dd>
<p>The summary provides the median and 2.5 and 97.5 percentiles of each parameter. If inferior to the whole number of bootstrap iterations, 
the number of iterations 
for which the estimation converges is also printed in the summary.
</p>
</dd>
<dt><code>plot</code></dt><dd>
<p>The plot shows the bootstrap estimates with <code><a href="graphics.html#topic+stripchart">stripchart</a></code> function
for univariate parameters and <code><a href="base.html#topic+plot">plot</a></code> function for multivariate parameters.
</p>
</dd>           
<dt><code>density</code></dt><dd>
<p>The density computes empirical densities and return an object of class <code>density.bootdist</code>.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Cullen AC and Frey HC (1999), <em>Probabilistic techniques in exposure assessment</em>.
Plenum Press, USA, pp. 181-241.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+fitdistrplus">fitdistrplus</a></code> for an overview of the package.
<code><a href="#topic+fitdist">fitdist</a></code>, <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, <code><a href="#topic+mmedist">mmedist</a></code>,
<code><a href="#topic+mgedist">mgedist</a></code>,
<code><a href="#topic+quantile.bootdist">quantile.bootdist</a></code> for another generic function to calculate 
quantiles from the fitted distribution and its bootstrap results
and <code><a href="#topic+CIcdfplot">CIcdfplot</a></code> for adding confidence intervals on quantiles
to a CDF plot of the fitted distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We choose a low number of bootstrap replicates in order to satisfy CRAN running times
# constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.


# (1) Fit of a gamma distribution to serving size data
# using default method (maximum likelihood estimation)
# followed by parametric bootstrap
#
data(groundbeef)
x1 &lt;- groundbeef$serving
f1 &lt;- fitdist(x1, "gamma")
b1 &lt;- bootdist(f1, niter=51)
print(b1)
plot(b1)
plot(b1, enhance=TRUE)
summary(b1)
quantile(b1)
CIcdfplot(b1, CI.output = "quantile")
density(b1)
plot(density(b1))

# (2) non parametric bootstrap on the same fit
#
b1b &lt;- bootdist(f1, bootmethod="nonparam", niter=51) 
summary(b1b)
quantile(b1b)


# (3) Fit of a normal distribution on acute toxicity values of endosulfan in log10 for
# nonarthropod invertebrates, using maximum likelihood estimation
# to estimate what is called a species sensitivity distribution 
# (SSD) in ecotoxicology, followed by estimation of the 5 percent quantile value of 
# the fitted distribution, what is called the 5 percent hazardous concentration (HC5)
# in ecotoxicology, with its two-sided 95 percent confidence interval calculated by 
# parametric bootstrap
#
data(endosulfan)
ATV &lt;- subset(endosulfan, group == "NonArthroInvert")$ATV
log10ATV &lt;- log10(subset(endosulfan, group == "NonArthroInvert")$ATV)
fln &lt;- fitdist(log10ATV, "norm")
bln &lt;- bootdist(fln, bootmethod = "param", niter=51)
quantile(bln, probs = c(0.05, 0.1, 0.2))

# (4) comparison of sequential and parallel versions of bootstrap
# to be tried with a greater number of iterations (1001 or more)
#

niter &lt;- 1001
data(groundbeef)
x1 &lt;- groundbeef$serving
f1 &lt;- fitdist(x1, "gamma")

# sequential version
ptm &lt;- proc.time()
summary(bootdist(f1, niter = niter))
proc.time() - ptm

# parallel version using snow
require("parallel")
ptm &lt;- proc.time()
summary(bootdist(f1, niter = niter, parallel = "snow", ncpus = 2))
proc.time() - ptm

# parallel version using multicore (not available on Windows)
ptm &lt;- proc.time()
summary(bootdist(f1, niter = niter, parallel = "multicore", ncpus = 2))
proc.time() - ptm


</code></pre>

<hr>
<h2 id='bootdistcens'> Bootstrap simulation of uncertainty for censored data</h2><span id='topic+bootdistcens'></span><span id='topic+plot.bootdistcens'></span><span id='topic+print.bootdistcens'></span><span id='topic+summary.bootdistcens'></span><span id='topic+density.bootdistcens'></span><span id='topic+plot.density.bootdistcens'></span><span id='topic+print.density.bootdistcens'></span>

<h3>Description</h3>

<p>Uses nonparametric bootstrap resampling in order to simulate uncertainty 
in the parameters of the distribution fitted to censored data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootdistcens(f, niter = 1001, silent = TRUE, 
      parallel = c("no", "snow", "multicore"), ncpus)
## S3 method for class 'bootdistcens'
print(x, ...)
## S3 method for class 'bootdistcens'
plot(x, ...)
## S3 method for class 'bootdistcens'
summary(object, ...)
## S3 method for class 'bootdistcens'
density(..., bw = nrd0, adjust = 1, kernel = "gaussian")
## S3 method for class 'density.bootdistcens'
plot(x, mar=c(4,4,2,1), lty=NULL, col=NULL, lwd=NULL, ...)
## S3 method for class 'density.bootdistcens'
print(x, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootdistcens_+3A_f">f</code></td>
<td>
<p> An object of class <code>"fitdistcens"</code>, output of the <code><a href="#topic+fitdistcens">fitdistcens</a></code> function.</p>
</td></tr>
<tr><td><code id="bootdistcens_+3A_niter">niter</code></td>
<td>
<p> The number of samples drawn by bootstrap.</p>
</td></tr>
<tr><td><code id="bootdistcens_+3A_silent">silent</code></td>
<td>
<p>A logical to remove or show warnings and errors when bootstraping.</p>
</td></tr>
<tr><td><code id="bootdistcens_+3A_parallel">parallel</code></td>
<td>
<p>The type of parallel operation to be used, <code>"snow"</code> or <code>"multicore"</code>
(the second one not being available on Windows),
or <code>"no"</code> if no parallel operation.</p>
</td></tr>
<tr><td><code id="bootdistcens_+3A_ncpus">ncpus</code></td>
<td>
<p>Number of processes to be used in parallel operation : 
typically one would fix it to the number of available CPUs.</p>
</td></tr>
<tr><td><code id="bootdistcens_+3A_x">x</code></td>
<td>
<p> An object of class <code>"bootdistcens"</code>.</p>
</td></tr>
<tr><td><code id="bootdistcens_+3A_object">object</code></td>
<td>
<p> An object of class <code>"bootdistcens"</code>.</p>
</td></tr>
<tr><td><code id="bootdistcens_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods or <code>"bootdistcens"</code>
objects for <code>density</code>.</p>
</td></tr>
<tr><td><code id="bootdistcens_+3A_bw">bw</code>, <code id="bootdistcens_+3A_adjust">adjust</code>, <code id="bootdistcens_+3A_kernel">kernel</code></td>
<td>
<p>resp. the smoothing bandwidth, the scaling factor,
the kernel used, see <code><a href="stats.html#topic+density">density</a></code>.</p>
</td></tr>  
<tr><td><code id="bootdistcens_+3A_mar">mar</code></td>
<td>
<p>A numerical vector of the form <code>c(bottom, left, top, right)</code>, 
see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr> 
<tr><td><code id="bootdistcens_+3A_lty">lty</code>, <code id="bootdistcens_+3A_col">col</code>, <code id="bootdistcens_+3A_lwd">lwd</code></td>
<td>
<p>resp. the line type, the color, the line width, 
see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Samples are drawn by 
nonparametric bootstrap (resampling with replacement from the data set). On each bootstrap sample the function 
<code><a href="#topic+mledist">mledist</a></code> is used to estimate bootstrapped values of parameters. When <code><a href="#topic+mledist">mledist</a></code> fails
to converge, <code>NA</code> values are returned. Medians and 2.5 and 97.5 percentiles are computed by removing
<code>NA</code> values. The medians and the 95 percent confidence intervals of parameters (2.5 and 97.5 percentiles) 
are printed in the summary.
If inferior to the whole number of iterations, the number of iterations for which <code><a href="#topic+mledist">mledist</a></code> converges 
is also printed in the summary.
</p>
<p>The plot of an object of class <code>"bootdistcens"</code> consists in a scatterplot or a matrix of scatterplots
of the bootstrapped values of parameters.
It uses the function <code><a href="graphics.html#topic+stripchart">stripchart</a></code> when the fitted distribution
is characterized by only one parameter, and the function <code><a href="base.html#topic+plot">plot</a></code> in other cases.
In these last cases, it provides
a representation of the joint uncertainty distribution of the fitted parameters.
</p>
<p>It is possible to accelerate the bootstrap using parallelization. We recommend you to
use <code>parallel = "multicore"</code>, or <code>parallel = "snow"</code> if you work on Windows,
and to fix <code>ncpus</code> to the number of available processors.
</p>
<p><code>density</code> computes the empirical density of <code>bootdistcens</code> objects using the
<code><a href="stats.html#topic+density">density</a></code> function (with Gaussian kernel by default). 
It returns an object of class <code>density.bootdistcens</code> for which <code>print</code>
and <code>plot</code> methods are provided.
</p>


<h3>Value</h3>

 
<p><code>bootdistcens</code> returns an object of class <code>"bootdistcens"</code>, a list with 6 components,
</p>
<table role = "presentation">
<tr><td><code>estim</code></td>
<td>
<p> a data frame containing the bootstrapped values of parameters.</p>
</td></tr>
<tr><td><code>converg</code></td>
<td>
<p> a vector containing the codes for convergence of the iterative method
used to estimate parameters on 
each bootstraped data set.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> A character string coding for the type of resampling : 
in this case <code>"nonparam"</code> as it is the only available method for censored data. </p>
</td></tr>
<tr><td><code>nbboot</code></td>
<td>
<p> The number of samples drawn by bootstrap.</p>
</td></tr>   
<tr><td><code>CI</code></td>
<td>
<p> bootstrap medians and 95 percent confidence percentile intervals of parameters. </p>
</td></tr>
<tr><td><code>fitpart</code></td>
<td>
<p> The object of class <code>"fitdistcens"</code> on which the bootstrap procedure
was applied.</p>
</td></tr>
</table>
<p>Generic functions:
</p>
       
<dl>
<dt><code>print</code></dt><dd>
<p>The print of a <code>"bootdistcens"</code> object shows the bootstrap parameter estimates. If inferior to the whole number of bootstrap iterations, 
the number of iterations 
for which the estimation converges is also printed.
</p>
</dd>
<dt><code>summary</code></dt><dd>
<p>The summary provides the median and 2.5 and 97.5 percentiles of each parameter. If inferior to the whole number of bootstrap iterations, 
the number of iterations 
for which the estimation converges is also printed in the summary.
</p>
</dd>
<dt><code>plot</code></dt><dd>
<p>The plot shows the bootstrap estimates with the <code><a href="graphics.html#topic+stripchart">stripchart</a></code> function
for univariate parameters and <code><a href="base.html#topic+plot">plot</a></code> function for multivariate parameters.
</p>
</dd>          
<dt><code>density</code></dt><dd>
<p>The density computes empirical densities and return an object of class <code>density.bootdistcens</code>.
</p>
</dd>
</dl>
   


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Cullen AC and Frey HC (1999), <em>Probabilistic techniques in exposure assessment</em>.
Plenum Press, USA, pp. 181-241.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+fitdistrplus">fitdistrplus</a></code> for an overview of the package.
<code><a href="#topic+fitdistcens">fitdistcens</a></code>, <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+quantile.bootdistcens">quantile.bootdistcens</a></code> 
for another generic function to calculate 
quantiles from the fitted distribution and its bootstrap results
and <code><a href="#topic+CIcdfplot">CIcdfplot</a></code> for adding confidence intervals on quantiles
to a CDF plot of the fitted distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We choose a low number of bootstrap replicates in order to satisfy CRAN running times
# constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.

# (1) Fit of a normal distribution to fluazinam data in log10
# followed by nonparametric bootstrap and calculation of quantiles
# with 95 percent confidence intervals
#
data(fluazinam)
(d1 &lt;-log10(fluazinam))
f1 &lt;- fitdistcens(d1, "norm")
b1 &lt;- bootdistcens(f1, niter = 51)
b1
summary(b1)
plot(b1)
quantile(b1)
CIcdfplot(b1, CI.output = "quantile")
plot(density(b1))

# (2) Estimation of the mean of the normal distribution 
# by maximum likelihood with the standard deviation fixed at 1 
# using the argument fix.arg
# followed by nonparametric bootstrap 
# and calculation of quantiles with 95 percent confidence intervals
#
f1b &lt;- fitdistcens(d1, "norm", start = list(mean = 1),fix.arg = list(sd = 1))
b1b &lt;- bootdistcens(f1b, niter = 51)
summary(b1b)
plot(b1b)
quantile(b1b)

# (3) comparison of sequential and parallel versions of bootstrap
# to be tried with a greater number of iterations (1001 or more)
#

niter &lt;- 1001
data(fluazinam)
d1 &lt;-log10(fluazinam)
f1 &lt;- fitdistcens(d1, "norm")

# sequential version
ptm &lt;- proc.time()
summary(bootdistcens(f1, niter = niter))
proc.time() - ptm

# parallel version using snow
require("parallel")
ptm &lt;- proc.time()
summary(bootdistcens(f1, niter = niter, parallel = "snow", ncpus = 2))
proc.time() - ptm

# parallel version using multicore (not available on Windows)
ptm &lt;- proc.time()
summary(bootdistcens(f1, niter = niter, parallel = "multicore", ncpus = 2))
proc.time() - ptm


</code></pre>

<hr>
<h2 id='CIcdfplot'>Empirical cumulative distribution function with pointwise confidence intervals on probabilities or on quantiles</h2><span id='topic+CIcdfplot'></span>

<h3>Description</h3>

   
<p><code>cdfband</code> plots the empirical cumulative distribution function with the bootstraped pointwise confidence intervals on probabilities of on quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIcdfplot(b, CI.output, CI.type = "two.sided", CI.level = 0.95, CI.col = "red", 
  CI.lty = 2, CI.fill = NULL, CI.only = FALSE, xlim, ylim, xlogscale = FALSE, 
  ylogscale = FALSE, main, xlab, ylab, datapch, datacol, fitlty, fitcol, fitlwd, 
  horizontals = TRUE, verticals = FALSE, do.points = TRUE, use.ppoints = TRUE, 
  a.ppoints = 0.5, name.points = NULL, lines01 = FALSE, plotstyle = "graphics", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CIcdfplot_+3A_b">b</code></td>
<td>
<p>One <code>"bootdist"</code> object.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_ci.output">CI.output</code></td>
<td>
<p> The quantity on which (bootstraped) bootstraped confidence intervals are computed: 
either <code>"probability"</code> or <code>"quantile"</code>).</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_ci.type">CI.type</code></td>
<td>
<p> Type of confidence intervals : either <code>"two.sided"</code> or one-sided 
intervals (<code>"less"</code> or <code>"greater"</code>).</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_ci.level">CI.level</code></td>
<td>
<p> The confidence level.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_ci.col">CI.col</code></td>
<td>
<p>the color of the confidence intervals.</p>
</td></tr>    
<tr><td><code id="CIcdfplot_+3A_ci.lty">CI.lty</code></td>
<td>
<p>the line type of the confidence intervals.</p>
</td></tr>    
<tr><td><code id="CIcdfplot_+3A_ci.fill">CI.fill</code></td>
<td>
<p>a color to fill the confidence area. Default is <code>NULL</code> corresponding to no filling.</p>
</td></tr>    
<tr><td><code id="CIcdfplot_+3A_ci.only">CI.only</code></td>
<td>
<p>A logical whether to plot empirical and fitted distribution functions 
or only the confidence intervals. Default to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_xlim">xlim</code></td>
<td>
<p>The <code class="reqn">x</code>-limits of the plot.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_ylim">ylim</code></td>
<td>
<p>The <code class="reqn">y</code>-limits of the plot.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_xlogscale">xlogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_ylogscale">ylogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <code class="reqn">y</code>-axis.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_main">main</code></td>
<td>
<p>A main title for the plot, see also <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">x</code>-axis, defaults to a description of <code>x</code>.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">y</code>-axis, defaults to a description of <code>y</code>.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_datapch">datapch</code></td>
<td>
<p>An integer specifying a symbol to be used in plotting data points, 
see also <code><a href="graphics.html#topic+points">points</a></code> (only for non censored data).</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_datacol">datacol</code></td>
<td>
<p>A specification of the color to be used in plotting data points.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_fitcol">fitcol</code></td>
<td>
<p>A (vector of) color(s) to plot fitted distributions. 
If there are fewer colors than fits they are recycled in the standard fashion.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_fitlty">fitlty</code></td>
<td>
<p>A (vector of) line type(s) to plot fitted distributions/densities. 
If there are fewer values than fits they are recycled in the standard fashion.
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_fitlwd">fitlwd</code></td>
<td>
<p>A (vector of) line size(s) to plot fitted distributions/densities. 
If there are fewer values than fits they are recycled in the standard fashion.
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_horizontals">horizontals</code></td>
<td>
<p>If <code>TRUE</code>, draws horizontal lines for the step empirical 
cdf function (only for non censored data). See also <code><a href="stats.html#topic+plot.stepfun">plot.stepfun</a></code>.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_verticals">verticals</code></td>
<td>
<p>If <code>TRUE</code>, draws also vertical lines for the empirical cdf function. 
Only taken into account if <code>horizontals=TRUE</code> (only for non censored data).</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_do.points">do.points</code></td>
<td>
<p>logical; if <code>TRUE</code>, also draw points at the x-locations. 
Default is TRUE (only for non censored data).</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_use.ppoints">use.ppoints</code></td>
<td>
<p>If <code>TRUE</code>, probability points of the empirical distribution
are defined using function <code><a href="stats.html#topic+ppoints">ppoints</a></code> as 
<code>(1:n - a.ppoints)/(n - 2a.ppoints + 1)</code> (only for non censored data).
If <code>FALSE</code>, probability points are simply defined as <code>(1:n)/n</code>. This argument 
is ignored for discrete data.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_a.ppoints">a.ppoints</code></td>
<td>
<p>If <code>use.ppoints=TRUE</code>, this is passed to function <code><a href="stats.html#topic+ppoints">ppoints</a></code>
(only for non censored data).</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_name.points">name.points</code></td>
<td>
<p>Label vector for points if they are drawn i.e. if do.points = TRUE (only for non censored data).</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_lines01">lines01</code></td>
<td>
<p>A logical to plot two horizontal lines at <code>h=0</code> and <code>h=1</code> for <code>cdfcomp</code>.</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_plotstyle">plotstyle</code></td>
<td>
<p><code>"graphics"</code> or <code>"ggplot"</code>. 
If <code>"graphics"</code>, the display is built with <code><a href="graphics.html#topic+graphics">graphics</a></code> functions. 
If <code>"ggplot"</code>, a graphic object output is created with <code>ggplot2</code> functions (the <code>ggplot2</code> package must be installed).</p>
</td></tr>
<tr><td><code id="CIcdfplot_+3A_...">...</code></td>
<td>
<p>Further graphical arguments passed to <code>matlines</code> or <code>polygon</code>,
respectively when <code>CI.fill=FALSE</code> and <code>CI.fill=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CIcdfplot</code> provides a plot of the empirical distribution using
<code><a href="#topic+cdfcomp">cdfcomp</a></code> or <code><a href="#topic+cdfcompcens">cdfcompcens</a></code>,
with bootstraped pointwise confidence intervals on probabilities (y values) 
or on quantiles (x values). 
Each interval is computed by evaluating the quantity of interest (probability
associated to an x value or quantile associated to an y value) using all the
bootstraped values of parameters to get a bootstraped sample
of the quantity of interest and then by calculating percentiles on this sample to get a
confidence interval (classically 2.5 and 97.5 percentiles for a 95 percent 
confidence level).
If <code>CI.fill != NULL</code>, then the whole confidence area is filled by the color <code>CI.fill</code>
thanks to the function <code>polygon</code>, otherwise only borders are drawn thanks to the function
<code>matline</code>. Further graphical arguments can be passed to these functions using 
the three dots arguments <code>...</code>.
</p>


<h3>Author(s)</h3>

 
<p>Christophe Dutang and Marie-Laure Delignette-Muller.
</p>


<h3>References</h3>

<p>Delignette-Muller ML and Dutang C (2015), 
<em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p>See also <code><a href="#topic+cdfcomp">cdfcomp</a></code>, <code><a href="#topic+cdfcompcens">cdfcompcens</a></code>,
<code><a href="#topic+bootdist">bootdist</a></code> and <code><a href="#topic+quantile">quantile</a></code>.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We choose a low number of bootstrap replicates in order to satisfy CRAN running times
# constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.

if (requireNamespace ("ggplot2", quietly = TRUE)) {ggplotEx &lt;- TRUE}

# (1) Fit of an exponential distribution
#

set.seed(123)
s1 &lt;- rexp(50, 1)
f1 &lt;- fitdist(s1, "exp")
b1 &lt;- bootdist(f1, niter= 11) #voluntarily low to decrease computation time

# plot 95 percent bilateral confidence intervals on y values (probabilities)
CIcdfplot(b1, CI.level= 95/100, CI.output = "probability")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", plotstyle = "ggplot")


# plot of the previous intervals as a band 
CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", 
  CI.fill = "pink", CI.col = "red")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", 
  CI.fill = "pink", CI.col = "red", plotstyle = "ggplot")

# plot of the previous intervals as a band without empirical and fitted dist. functions
CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", CI.only = TRUE,
  CI.fill = "pink", CI.col = "red")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", CI.only = TRUE,
  CI.fill = "pink", CI.col = "red", plotstyle = "ggplot")
  
# same plot without contours
CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", CI.only = TRUE,
  CI.fill = "pink", CI.col = "pink")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", CI.only = TRUE,
  CI.fill = "pink", CI.col = "pink", plotstyle = "ggplot")

# plot 95 percent bilateral confidence intervals on x values (quantiles)
CIcdfplot(b1, CI.level= 95/100, CI.output = "quantile")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "quantile", plotstyle = "ggplot")


# plot 95 percent unilateral confidence intervals on quantiles
CIcdfplot(b1, CI.level = 95/100, CI.output = "quant", CI.type = "less", 
  CI.fill = "grey80", CI.col = "black", CI.lty = 1)
if (ggplotEx) CIcdfplot(b1, CI.level = 95/100, CI.output = "quant", CI.type = "less", 
  CI.fill = "grey80", CI.col = "black", CI.lty = 1, plotstyle = "ggplot")
    
CIcdfplot(b1, CI.level= 95/100, CI.output = "quant", CI.type = "greater",
  CI.fill = "grey80", CI.col = "black", CI.lty = 1)
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "quant", CI.type = "greater",
  CI.fill = "grey80", CI.col = "black", CI.lty = 1, plotstyle = "ggplot")

# (2) Fit of a normal distribution on acute toxicity log-transformed values of 
# endosulfan for nonarthropod invertebrates, using maximum likelihood estimation
# to estimate what is called a species sensitivity distribution 
# (SSD) in ecotoxicology, followed by estimation of the 5, 10 and 20 percent quantile  
# values of the fitted distribution, which are called the 5, 10, 20 percent hazardous 
# concentrations (HC5, HC10, HC20) in ecotoxicology, with their
# confidence intervals, from a small number of bootstrap 
# iterations to satisfy CRAN running times constraint and plot of the band
# representing pointwise confidence intervals on any quantiles (any HCx values)
# For practical applications, we recommend to use at least niter=501 or niter=1001.
#

data(endosulfan)
log10ATV &lt;- log10(subset(endosulfan, group == "NonArthroInvert")$ATV)
namesATV &lt;- subset(endosulfan, group == "NonArthroInvert")$taxa
fln &lt;- fitdist(log10ATV, "norm")
bln &lt;- bootdist(fln, bootmethod ="param", niter=101)
quantile(bln, probs = c(0.05, 0.1, 0.2))
CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
          xlim = c(0,5), name.points=namesATV)
if (ggplotEx) CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
  xlim = c(0,5), name.points=namesATV, plotstyle = "ggplot")


# (3) Same type of example as example (2) from ecotoxicology
# with censored data
#
data(salinity)
log10LC50 &lt;-log10(salinity)
fln &lt;- fitdistcens(log10LC50,"norm")
bln &lt;- bootdistcens(fln, niter=101)
(HC5ln &lt;- quantile(bln,probs = 0.05))
CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
    xlab = "log10(LC50)",xlim=c(0.5,2),lines01 = TRUE)
if (ggplotEx) CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
                        xlab = "log10(LC50)",xlim=c(0.5,2),lines01 = TRUE, plotstyle = "ggplot")
# zoom around the HC5  
CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
          xlab = "log10(LC50)", lines01 = TRUE, xlim = c(0.8, 1.5), ylim = c(0, 0.1))
abline(h = 0.05, lty = 2) # line corresponding to a CDF of 5 percent

if (ggplotEx) CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
    xlab = "log10(LC50)", lines01 = TRUE, xlim = c(0.8, 1.5), ylim = c(0, 0.1), 
    plotstyle = "ggplot") +
  ggplot2::geom_hline(yintercept = 0.05, lty = 2) # line corresponding to a CDF of 5 percent

</code></pre>

<hr>
<h2 id='danish'> Danish reinsurance claim dataset </h2><span id='topic+danish'></span><span id='topic+danishuni'></span><span id='topic+danishmulti'></span>

<h3>Description</h3>

<p>The univariate dataset was collected at Copenhagen Reinsurance and 
comprise 2167 fire losses over the period 1980 to 1990. 
They have been adjusted for inflation to reflect 1985 
values and are expressed in millions of Danish Krone.
</p>
<p>The multivariate data set is the same data as above but the 
total claim has been divided 
into a building loss, a loss of contents 
and a loss of profits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(danishuni)
data(danishmulti)
</code></pre>


<h3>Format</h3>

 
<p><code>danishuni</code> contains two columns:
</p>

<dl>
<dt><code>Date</code></dt><dd><p>The day of claim occurence.</p>
</dd>
<dt><code>Loss</code></dt><dd><p>The total loss amount in millions of Danish Krone (DKK).</p>
</dd>
</dl>

<p><code>danishmulti</code> contains five columns:
</p>

<dl>
<dt><code>Date</code></dt><dd><p>The day of claim occurence.</p>
</dd>
<dt><code>Building</code></dt><dd><p>The loss amount (mDKK) of the building coverage.</p>
</dd>
<dt><code>Contents</code></dt><dd><p>The loss amount (mDKK) of the contents coverage.</p>
</dd>
<dt><code>Profits</code></dt><dd><p>The loss amount (mDKK) of the profit coverage.</p>
</dd>
<dt><code>Total</code></dt><dd><p>The total loss amount (mDKK).</p>
</dd>
</dl>

<p>All columns are numeric except Date columns of class Date. 
</p>


<h3>Source</h3>

<p>Embrechts, P., Kluppelberg, C. and Mikosch, T. (1997) <em>Modelling Extremal Events for Insurance and Finance</em>. Berlin: Springer.
</p>


<h3>References</h3>

 
<p>Dataset used in McNeil (1996), <em>Estimating the Tails of Loss Severity Distributions using Extreme Value Theory</em>, ASTIN Bull.
Davison, A. C. (2003) <em>Statistical Models</em>. Cambridge University Press. Page 278.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1) load of data
#
data(danishuni)


# (2) plot and description of data
#
plotdist(danishuni$Loss)


# (3) load of data
#
data(danishmulti)


# (4) plot and description of data
#
idx &lt;- sample(1:NROW(danishmulti), 10)
barplot(danishmulti$Building[idx], col = "grey25", 
  ylim = c(0, max(danishmulti$Total[idx])), main = "Some claims of danish data set")
barplot(danishmulti$Content[idx], add = TRUE, col = "grey50", axes = FALSE)
barplot(danishmulti$Profits[idx], add = TRUE, col = "grey75", axes = FALSE)
legend("topleft", legend = c("Building", "Content", "Profits"), 
  fill = c("grey25", "grey50", "grey75"))
</code></pre>

<hr>
<h2 id='dataFAQ'>Datasets for the FAQ</h2><span id='topic+dataFAQ'></span><span id='topic+dataFAQlog1'></span><span id='topic+dataFAQscale1'></span><span id='topic+dataFAQscale2'></span>

<h3>Description</h3>

<p>Datasets used in the FAQ vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataFAQlog1)
data(dataFAQscale1)
data(dataFAQscale2)
</code></pre>


<h3>Format</h3>

 
<p><code>dataFAQlog1</code>
<code>dataFAQscale1</code>
<code>dataFAQscale2</code> are vectors of numeric data.
</p>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>

<hr>
<h2 id='descdist'> Description of an empirical distribution for non-censored data</h2><span id='topic+descdist'></span><span id='topic+print.descdist'></span>

<h3>Description</h3>

<p>Computes descriptive parameters of an empirical distribution for non-censored data
and provides a skewness-kurtosis plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>descdist(data, discrete = FALSE, boot = NULL, method = "unbiased",
graph = TRUE, print = TRUE, obs.col = "red", obs.pch = 16, boot.col = "orange")

## S3 method for class 'descdist'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="descdist_+3A_data">data</code></td>
<td>
<p> A numeric vector.  </p>
</td></tr>
<tr><td><code id="descdist_+3A_discrete">discrete</code></td>
<td>
<p> If <code>TRUE</code>, the distribution is considered as discrete.  </p>
</td></tr>
<tr><td><code id="descdist_+3A_boot">boot</code></td>
<td>
<p> If not <code>NULL</code>, <code>boot</code> values of skewness and kurtosis are plotted from bootstrap
samples of <code>data</code>. <code>boot</code> must be fixed in this case to an integer above 10. </p>
</td></tr>
<tr><td><code id="descdist_+3A_method">method</code></td>
<td>
<p> &quot;unbiased&quot; for unbiased estimated values of statistics or &quot;sample&quot; for sample values. </p>
</td></tr>
<tr><td><code id="descdist_+3A_graph">graph</code></td>
<td>
<p> If <code>FALSE</code>, the skewness-kurtosis graph is not plotted. </p>
</td></tr>
<tr><td><code id="descdist_+3A_print">print</code></td>
<td>
<p> If <code>FALSE</code>, the descriptive parameters computed are not printed. </p>
</td></tr>
<tr><td><code id="descdist_+3A_obs.col">obs.col</code></td>
<td>
<p> Color used for the observed point on the skewness-kurtosis graph. </p>
</td></tr>
<tr><td><code id="descdist_+3A_obs.pch">obs.pch</code></td>
<td>
<p> plotting character used for the observed point on the skewness-kurtosis graph. </p>
</td></tr>
<tr><td><code id="descdist_+3A_boot.col">boot.col</code></td>
<td>
<p> Color used for bootstrap sample of points on the skewness-kurtosis graph. </p>
</td></tr>
<tr><td><code id="descdist_+3A_x">x</code></td>
<td>
<p>An object of class <code>"descdist"</code>.  </p>
</td></tr>
<tr><td><code id="descdist_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Minimum, maximum, median, mean, sample sd, and sample (if <code>method=="sample"</code>) or by default 
unbiased estimations of skewness and 
Pearsons's kurtosis values are printed (Sokal and Rohlf, 1995).
A skewness-kurtosis plot such as the one proposed by Cullen and Frey (1999) is given for the 
empirical distribution. On this plot, values for common distributions are also displayed as a tools 
to help the choice of distributions to fit to data. For some distributions (normal, uniform,
logistic, exponential for example), there is only one possible value for the skewness and the kurtosis
(for a normal distribution for example, skewness = 0 and kurtosis = 3), and the distribution 
is thus represented by a point on the plot. For other distributions, 
areas of possible values are represented, consisting in lines (gamma and lognormal distributions for example), 
or larger areas (beta distribution for example). The Weibull distribution is not represented on the graph but it 
is indicated on the legend that
shapes close to lognormal and gamma distributions may be obtained with this distribution.
</p>
<p>In order to take into account the uncertainty 
of the estimated values of kurtosis and skewness from data, the data set may be bootstraped by 
fixing the argument <code>boot</code> to an integer above 10. <code>boot</code> values of skewness and kurtosis 
corresponding to the <code>boot</code> bootstrap samples are then computed and reported in blue color on the 
skewness-kurtosis plot.
</p>
<p>If <code>discrete</code> is <code>TRUE</code>, 
the represented distributions are the Poisson, negative binomial distributions, 
and the normal distribution to which previous discrete distributions may converge. 
If <code>discrete</code> is <code>FALSE</code>, these are uniform, normal, logistic, lognormal, beta 
and gamma distributions.
</p>


<h3>Value</h3>

 
<p><code>descdist</code> returns a list with 7 components,
</p>
<table role = "presentation">
<tr><td><code>min</code></td>
<td>
<p> the minimum value  </p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p> the maximum value  </p>
</td></tr>
<tr><td><code>median</code></td>
<td>
<p> the median value  </p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p> the mean value  </p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p> the standard deviation sample or estimated value  </p>
</td></tr>
<tr><td><code>skewness</code></td>
<td>
<p> the skewness sample or estimated value  </p>
</td></tr>
<tr><td><code>kurtosis</code></td>
<td>
<p> the kurtosis sample or estimated value  </p>
</td></tr>    
<tr><td><code>method</code></td>
<td>
<p> the method specified in input (&quot;unbiased&quot; for unbiased 
estimated values of statistics or &quot;sample&quot; for sample values. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Cullen AC and Frey HC (1999), <em>Probabilistic techniques in exposure assessment</em>.
Plenum Press, USA, pp. 81-159.
</p>
<p>Evans M, Hastings N and Peacock B (2000), <em>Statistical distributions</em>.
John Wiley and Sons Inc, <a href="https://doi.org/10.1002/9780470627242">doi:10.1002/9780470627242</a>.
</p>
<p>Sokal RR and Rohlf FJ (1995), <em>Biometry</em>.
W.H. Freeman and Company, USA, pp. 111-115.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+plotdist">plotdist</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) Description of a sample from a normal distribution
# with and without uncertainty on skewness and kurtosis estimated by bootstrap 
#
set.seed(1234)
x1 &lt;- rnorm(100)
descdist(x1)
descdist(x1,boot=11)

# (2) Description of a sample from a beta distribution
# with uncertainty on skewness and kurtosis estimated by bootstrap
# with changing of default colors and plotting character for observed point
#
descdist(rbeta(100,shape1=0.05,shape2=1),boot=11,
 obs.col="blue", obs.pch = 15, boot.col="darkgreen")

# (3) Description of a sample from a gamma distribution
# with uncertainty on skewness and kurtosis estimated by bootstrap
# without plotting 
#
descdist(rgamma(100,shape=2,rate=1),boot=11,graph=FALSE)

# (4) Description of a sample from a Poisson distribution
# with uncertainty on skewness and kurtosis estimated by bootstrap 
#
descdist(rpois(100,lambda=2),discrete=TRUE,boot=11)

# (5) Description of serving size data
# with uncertainty on skewness and kurtosis estimated by bootstrap 
#
data(groundbeef)
serving &lt;- groundbeef$serving
descdist(serving, boot=11)
</code></pre>

<hr>
<h2 id='detectbound'> Detect bounds for density function</h2><span id='topic+detectbound'></span>

<h3>Description</h3>

<p>Manual detection of bounds of parameter of a density function/  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detectbound(distname, vstart, obs, fix.arg=NULL, echo=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detectbound_+3A_distname">distname</code></td>
<td>
<p> A character string <code>"name"</code> naming a distribution 
for which the corresponding density function <code>dname</code> 
must be classically defined. </p>
</td></tr>
<tr><td><code id="detectbound_+3A_vstart">vstart</code></td>
<td>
<p>A named vector giving the initial values of parameters 
of the named distribution. </p>
</td></tr>
<tr><td><code id="detectbound_+3A_obs">obs</code></td>
<td>
<p> A numeric vector for non censored data. </p>
</td></tr>
<tr><td><code id="detectbound_+3A_fix.arg">fix.arg</code></td>
<td>
<p>An optional named vector giving the values of fixed parameters of the named distribution. Default to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="detectbound_+3A_echo">echo</code></td>
<td>
<p>A logical to show some traces.</p>
</td></tr>    
</table>


<h3>Details</h3>

<p>This function manually tests the following bounds : -1, 0, and 1.
</p>


<h3>Value</h3>

 
<p><code>detectbound</code> returns a 2-row matrix with the lower bounds in the first
row and the upper bounds in the second row.
</p>


<h3>Author(s)</h3>

 
<p>Christophe Dutang and Marie-Laure Delignette-Muller.
</p>


<h3>References</h3>

 
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+fitdist">fitdist</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># case where the density returns a Not-an-Numeric value.
detectbound("exp", c(rate=3), 1:10)
detectbound("binom", c(size=3, prob=1/2), 1:10)
detectbound("nbinom", c(size=3, prob=1/2), 1:10)
</code></pre>

<hr>
<h2 id='endosulfan'>Species Sensitivity Distribution (SSD) for endosulfan</h2><span id='topic+endosulfan'></span>

<h3>Description</h3>

<p>Summary of 48- to 96-hour acute toxicity values (LC50 and EC50 values)
for exposure of Australian an Non-Australian taxa to endosulfan. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(endosulfan)
</code></pre>


<h3>Format</h3>

 
<p><code>endosulfan</code> is a data frame with 4 columns, named ATV for Acute Toxicity Value
(geometric mean of LC50 ou EC50 values in micrograms per liter),
Australian (coding for Australian or another origin), group 
(arthropods, fish or non-arthropod invertebrates) and taxa.
</p>


<h3>Source</h3>

 
<p>Hose, G.C., Van den Brink, P.J. 2004. Confirming the Species-Sensitivity Distribution Concept
for Endosulfan Using Laboratory, Mesocosms, and Field Data. <em>Archives of Environmental 
Contamination and Toxicology</em>, <b>47</b>, 511-520.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load of data
#
data(endosulfan)

# (2) plot and description of data for non Australian fish in decimal logarithm
#
log10ATV &lt;-log10(subset(endosulfan,(Australian == "no") &amp; (group == "Fish"))$ATV)
plotdist(log10ATV)
descdist(log10ATV,boot=11)

# (3) fit of a normal and a logistic distribution to data in log10
# (classical distributions used for SSD)
# and visual comparison of the fits
#
fln &lt;- fitdist(log10ATV,"norm")
summary(fln)

fll &lt;- fitdist(log10ATV,"logis")
summary(fll)

cdfcomp(list(fln,fll),legendtext=c("normal","logistic"),
xlab="log10ATV")

denscomp(list(fln,fll),legendtext=c("normal","logistic"),
xlab="log10ATV")

qqcomp(list(fln,fll),legendtext=c("normal","logistic"))
ppcomp(list(fln,fll),legendtext=c("normal","logistic"))

gofstat(list(fln,fll), fitnames = c("lognormal", "loglogistic"))

# (4) estimation of the 5 percent quantile value of 
# logistic fitted distribution (5 percent hazardous concentration  : HC5)
# with its two-sided 95 percent confidence interval calculated by 
# parametric bootstrap 
# with a small number of iterations to satisfy CRAN running times constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.
#
# in log10(ATV)
bll &lt;- bootdist(fll,niter=51)
HC5ll &lt;- quantile(bll,probs = 0.05)
# in ATV
10^(HC5ll$quantiles)
10^(HC5ll$quantCI)

# (5) estimation of the 5 percent quantile value of 
# the fitted logistic distribution (5 percent hazardous concentration  : HC5)
# with its one-sided 95 percent confidence interval (type "greater")
# calculated by 
# nonparametric bootstrap 
# with a small number of iterations to satisfy CRAN running times constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.
# 
# in log10(ATV)
bllnonpar &lt;- bootdist(fll,niter=51,bootmethod = "nonparam")
HC5llgreater &lt;- quantile(bllnonpar,probs = 0.05, CI.type="greater")
# in ATV
10^(HC5llgreater$quantiles)
10^(HC5llgreater$quantCI)

# (6) fit of a logistic distribution 
# by minimizing the modified Anderson-Darling AD2L distance
# cf. ?mgedist for definition of this distance
#

fllAD2L &lt;- fitdist(log10ATV,"logis",method="mge",gof="AD2L")
summary(fllAD2L)
plot(fllAD2L)
</code></pre>

<hr>
<h2 id='fitdist'> Fit of univariate distributions to non-censored data</h2><span id='topic+fitdist'></span><span id='topic+plot.fitdist'></span><span id='topic+print.fitdist'></span><span id='topic+summary.fitdist'></span><span id='topic+logLik.fitdist'></span><span id='topic+AIC.fitdist'></span><span id='topic+BIC.fitdist'></span><span id='topic+vcov.fitdist'></span><span id='topic+coef.fitdist'></span>

<h3>Description</h3>

<p>Fit of univariate distributions to non-censored data by maximum likelihood (mle), 
moment matching (mme), quantile matching (qme) or 
maximizing goodness-of-fit estimation (mge).
The latter is also known as minimizing distance estimation.
Generic methods are <code>print</code>, <code>plot</code>, 
<code>summary</code>, <code>quantile</code>, <code>logLik</code>, <code>AIC</code>, 
<code>BIC</code>, <code>vcov</code> and <code>coef</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitdist(data, distr, method = c("mle", "mme", "qme", "mge", "mse"), 
    start=NULL, fix.arg=NULL, discrete, keepdata = TRUE, keepdata.nb=100, 
    calcvcov=TRUE, ...)
    
## S3 method for class 'fitdist'
print(x, ...)

## S3 method for class 'fitdist'
plot(x, breaks="default", ...)

## S3 method for class 'fitdist'
summary(object, ...)

## S3 method for class 'fitdist'
logLik(object, ...)

## S3 method for class 'fitdist'
AIC(object, ..., k = 2)

## S3 method for class 'fitdist'
BIC(object, ...)

## S3 method for class 'fitdist'
vcov(object, ...)

## S3 method for class 'fitdist'
coef(object, ...)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitdist_+3A_data">data</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="fitdist_+3A_distr">distr</code></td>
<td>
<p>A character string <code>"name"</code> naming a distribution for which the corresponding
density function <code>dname</code>, the corresponding distribution function <code>pname</code> and the 
corresponding quantile function <code>qname</code> must be defined, or directly the density function.</p>
</td></tr>
<tr><td><code id="fitdist_+3A_method">method</code></td>
<td>
<p>A character string coding for the fitting method: 
<code>"mle"</code> for 'maximum likelihood estimation', <code>"mme"</code> for 'moment matching estimation', 
<code>"qme"</code> for 'quantile matching estimation', <code>"mge"</code> for 'maximum goodness-of-fit estimation'
and <code>"mse"</code> for 'maximum spacing estimation'.</p>
</td></tr>
<tr><td><code id="fitdist_+3A_start">start</code></td>
<td>
<p>A named list giving the initial values of parameters of the named distribution
or a function of data computing initial values and returning a named list.
This argument may be omitted (default) for some distributions for which reasonable 
starting values are computed (see the 'details' section of  <code><a href="#topic+mledist">mledist</a></code>). 
It may not be into account for closed-form formulas.</p>
</td></tr>
<tr><td><code id="fitdist_+3A_fix.arg">fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of the named distribution
or a function of data computing (fixed) parameter values and returning a named list. 
Parameters with fixed value are thus NOT estimated by this maximum likelihood procedure.
The use of this argument is not possible if <code>method="mme"</code> and a closed-form formula is used.</p>
</td></tr>
<tr><td><code id="fitdist_+3A_keepdata">keepdata</code></td>
<td>
<p>a logical. If <code>TRUE</code>, dataset is returned, 
otherwise only a sample subset is returned.</p>
</td></tr>
<tr><td><code id="fitdist_+3A_keepdata.nb">keepdata.nb</code></td>
<td>
<p>When <code>keepdata=FALSE</code>, the length (&gt;1) of the subset returned.</p>
</td></tr>
<tr><td><code id="fitdist_+3A_calcvcov">calcvcov</code></td>
<td>
<p>A logical indicating if (asymptotic) covariance matrix is required.</p>
</td></tr>
<tr><td><code id="fitdist_+3A_discrete">discrete</code></td>
<td>
<p> If TRUE, the distribution is considered as discrete.
If <code>discrete</code> is missing, 
<code>discrete</code> is automaticaly set to <code>TRUE</code> when <code>distr</code> belongs to 
<code>"binom"</code>, <code>"nbinom"</code>, <code>"geom"</code>,
<code>"hyper"</code> or <code>"pois"</code> and to <code>FALSE</code> in the other cases. It is thus recommended
to enter this argument when using another discrete distribution. This argument will not directly affect
the results of the fit but will be passed to functions <code><a href="#topic+gofstat">gofstat</a></code>, <code><a href="#topic+plotdist">plotdist</a></code> 
and <code><a href="#topic+cdfcomp">cdfcomp</a></code>.  </p>
</td></tr>
<tr><td><code id="fitdist_+3A_x">x</code></td>
<td>
<p>An object of class <code>"fitdist"</code>.  </p>
</td></tr>
<tr><td><code id="fitdist_+3A_object">object</code></td>
<td>
<p>An object of class <code>"fitdist"</code>.  </p>
</td></tr>
<tr><td><code id="fitdist_+3A_breaks">breaks</code></td>
<td>
<p>If <code>"default"</code> the histogram is plotted with the function <code>hist</code> 
with its default breaks definition. Else <code>breaks</code> is passed to the function <code>hist</code>.
This argument is not taken into account with discrete distributions: <code>"binom"</code>, 
<code>"nbinom"</code>, <code>"geom"</code>, <code>"hyper"</code> and <code>"pois"</code>. </p>
</td></tr>
<tr><td><code id="fitdist_+3A_k">k</code></td>
<td>
<p>penalty per parameter to be passed to the AIC generic function (2 by default).</p>
</td></tr>
<tr><td><code id="fitdist_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic functions, or to one of the functions
<code>"mledist"</code>,  <code>"mmedist"</code>, <code>"qmedist"</code> or <code>"mgedist"</code>
depending of the chosen method. See <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, 
<code><a href="#topic+mgedist">mgedist</a></code> for details on parameter estimation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the <code>distr</code> argument specifies the distribution by the
probability density function, the cumulative distribution function and
the quantile function (d, p, q).
</p>
<p>The four possible fitting methods are described below:
</p>

<dl>
<dt>When <code>method="mle"</code></dt><dd>
<p>Maximum likelihood estimation consists in maximizing the log-likelihood.
A numerical optimization is carried out in <code><a href="#topic+mledist">mledist</a></code> via <code>optim</code>
to find the best values (see <code><a href="#topic+mledist">mledist</a></code> for details).
</p>
</dd>
<dt>When <code>method="mme"</code></dt><dd>
<p>Moment matching estimation consists in equalizing theoretical and empirical moments.
Estimated values of the distribution parameters are computed by a closed-form 
formula for the following distributions : <code>"norm"</code>, <code>"lnorm"</code>, 
<code>"pois"</code>, <code>"exp"</code>, <code>"gamma"</code>, 
<code>"nbinom"</code>, <code>"geom"</code>, <code>"beta"</code>, <code>"unif"</code> and <code>"logis"</code>.
Otherwise the theoretical and the empirical moments are matched numerically, 
by minimization of the sum of squared differences between observed and theoretical moments. 
In this last case, further arguments are needed in the call to <code>fitdist</code>: <code>order</code> and <code>memp</code>
(see <code><a href="#topic+mmedist">mmedist</a></code> for details).
</p>
<p>Since Version 1.2-0, <code>mmedist</code> automatically computes the asymptotic covariance matrix, 
hence the theoretical moments <code>mdist</code> 
should be defined up to an order which equals to twice the maximal order given <code>order</code>.
</p>
</dd>
<dt>When <code>method = "qme"</code></dt><dd>
<p>Quantile matching estimation consists in equalizing theoretical and empirical quantile.
A numerical optimization is carried out in <code><a href="#topic+qmedist">qmedist</a></code> via <code>optim</code>
to minimize of the sum of squared differences between observed and theoretical quantiles.
The use of this method requires an additional argument <code>probs</code>, 
defined as the numeric vector of the probabilities for which the quantile(s) is(are) to be matched
(see <code><a href="#topic+qmedist">qmedist</a></code> for details).
</p>
</dd>
<dt>When <code>method = "mge"</code></dt><dd>
<p>Maximum goodness-of-fit estimation consists in maximizing a goodness-of-fit statistics.
A numerical optimization is carried out in <code><a href="#topic+mgedist">mgedist</a></code> via <code>optim</code>
to minimize the goodness-of-fit distance. The use of this method 
requires an additional argument <code>gof</code> coding for the goodness-of-fit distance chosen. 
One can use the classical Cramer-von Mises distance (<code>"CvM"</code>), the classical
Kolmogorov-Smirnov distance (<code>"KS"</code>), the classical Anderson-Darling distance (<code>"AD"</code>)
which gives more weight to the tails of the distribution, 
or one of the variants of this last distance proposed by Luceno (2006)
(see <code><a href="#topic+mgedist">mgedist</a></code> for more details). This method is not suitable for discrete distributions.
</p>
</dd>
<dt>When <code>method = "mse"</code></dt><dd>
<p>Maximum goodness-of-fit estimation consists in maximizing the average log spacing.
A numerical optimization is carried out in <code><a href="#topic+msedist">msedist</a></code> via <code>optim</code>.
</p>
</dd>
</dl>

<p>By default, direct optimization of the log-likelihood (or other criteria depending
of the chosen method) is performed using <code><a href="stats.html#topic+optim">optim</a></code>, 
with the &quot;Nelder-Mead&quot; method for distributions characterized by more than one parameter
and the &quot;BFGS&quot; method for distributions characterized by only one parameter. 
The optimization algorithm used in <code><a href="stats.html#topic+optim">optim</a></code> can be chosen or another optimization function
can be specified using ... argument (see <code><a href="#topic+mledist">mledist</a></code> for details).
<code>start</code> may be omitted (i.e. <code>NULL</code>) for some classic distributions
(see the 'details' section of  <code><a href="#topic+mledist">mledist</a></code>).
Note that when errors are raised by <code>optim</code>, it's a good idea to start by adding traces during
the optimization process by adding <code>control=list(trace=1, REPORT=1)</code> in ... argument.
</p>
<p>Once the parameter(s) is(are) estimated, <code>fitdist</code> computes the log-likelihood 
for every estimation method and for maximum likelihood estimation the standard errors of 
the estimates calculated from the Hessian at the solution found by <code>optim</code> 
or by the user-supplied function passed to mledist.
</p>
<p>By default (<code>keepdata = TRUE</code>), the object returned by <code>fitdist</code> contains 
the data vector given in input.
When dealing with large datasets, we can remove the original dataset from the output by
setting <code>keepdata = FALSE</code>. In such a case, only <code>keepdata.nb</code> points (at most) 
are kept by random subsampling <code>keepdata.nb</code>-2 points from the dataset and 
adding the minimum and the maximum. If combined with <code><a href="#topic+bootdist">bootdist</a></code>, and use with
non-parametric bootstrap be aware that bootstrap is performed on the subset
randomly selected in <code>fitdist</code>. Currently, the graphical comparisons of multiple fits 
is not available in this framework.
</p>
<p>Weighted version of the estimation process is available for <code>method = "mle", "mme", "qme"</code>
by using <code>weights=...</code>. See the corresponding man page for details.
Weighted maximum GOF estimation (when <code>method = "mge"</code>) is not allowed. 
It is not yet possible to take into account weighths in functions <code>plotdist</code>, 
<code>plot.fitdist</code>, <code>cdfcomp</code>, <code>denscomp</code>, <code>ppcomp</code>, 
<code>qqcomp</code>, <code>gofstat</code> and <code>descdist</code> (developments planned in the future).
</p>
<p>Once the parameter(s) is(are) estimated, <code><a href="#topic+gofstat">gofstat</a></code> allows to compute 
goodness-of-fit statistics.
</p>
<p>NB: if your data values are particularly small or large, a scaling may be needed 
before the optimization process. See example (14) in this man page and 
examples (14,15) in the test file of the package.
Please also take a look at the <code>Rmpfr</code> package available on CRAN for numerical
accuracy issues.
</p>


<h3>Value</h3>

 
<p><code>fitdist</code> returns an object of class <code>"fitdist"</code>, a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> the character string coding for the fitting method : 
<code>"mle"</code> for 'maximum likelihood estimation', 
<code>"mme"</code> for 'matching moment estimation',
<code>"qme"</code> for 'matching quantile estimation'
<code>"mge"</code> for 'maximum goodness-of-fit estimation'
and <code>"mse"</code> for 'maximum spacing estimation'.</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p> the estimated standard errors, <code>NA</code> if numerically not computable
or <code>NULL</code> if not available.</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p> the estimated correlation matrix, <code>NA</code> if numerically not computable
or <code>NULL</code> if not available.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p> the estimated variance-covariance matrix, <code>NULL</code> if not available
for the estimation method considered.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> the log-likelihood.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p> the Akaike information criterion.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p> the the so-called BIC or SBC (Schwarz Bayesian criterion).</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p> the length of the data set.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p> the data set.</p>
</td></tr>
<tr><td><code>distname</code></td>
<td>
<p> the name of the distribution.</p>
</td></tr>
<tr><td><code>fix.arg</code></td>
<td>
<p> the named list giving the values of parameters of the named distribution
that must be kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
if there are no such parameters. </p>
</td></tr>
<tr><td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p>
</td></tr>    
<tr><td><code>dots</code></td>
<td>
<p> the list of  further arguments passed in ... to be used in <code><a href="#topic+bootdist">bootdist</a></code> 
in iterative calls to <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+mmedist">mmedist</a></code>,
<code><a href="#topic+qmedist">qmedist</a></code>, <code><a href="#topic+mgedist">mgedist</a></code> or 
<code>NULL</code> if no such arguments.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of 
<code><a href="stats.html#topic+optim">optim</a></code>/<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> defined as below
or defined by the user in the user-supplied optimization function. 
<code>0</code> indicates successful convergence.
<code>1</code> indicates that the iteration limit of <code><a href="stats.html#topic+optim">optim</a></code> has been reached.
<code>10</code> indicates degeneracy of the Nealder-Mead simplex.
<code>100</code> indicates that <code><a href="stats.html#topic+optim">optim</a></code> encountered an internal error.</p>
</td></tr>    
<tr><td><code>discrete</code></td>
<td>
<p> the input argument or the automatic definition by the function to be passed
to functions <code><a href="#topic+gofstat">gofstat</a></code>, <code><a href="#topic+plotdist">plotdist</a></code> 
and <code><a href="#topic+cdfcomp">cdfcomp</a></code>. </p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or <code>NULL</code>.</p>
</td></tr>    
</table>
<p>Generic functions:
</p>
       
<dl>
<dt><code>print</code></dt><dd>
<p>The print of a <code>"fitdist"</code> object shows few traces about the fitting method and 
the fitted distribution.
</p>
</dd>
<dt><code>summary</code></dt><dd>
<p>The summary provides the parameter estimates of the fitted distribution, the log-likelihood, 
AIC and BIC statistics and when the maximum likelihood is used, the standard errors of the 
parameter estimates and the correlation matrix between parameter estimates.
</p>
</dd>
<dt><code>plot</code></dt><dd>
<p>The plot of an object of class &quot;fitdist&quot; returned by <code>fitdist</code> uses the function 
<code><a href="#topic+plotdist">plotdist</a></code>. An object of class &quot;fitdist&quot; or a list of objects of class
&quot;fitdist&quot; corresponding to various fits using the same data set may also be plotted
using a cdf plot (function <code><a href="#topic+cdfcomp">cdfcomp</a></code>),
a density plot(function <code><a href="#topic+denscomp">denscomp</a></code>),
a density Q-Q plot (function <code><a href="#topic+qqcomp">qqcomp</a></code>),
or a P-P plot (function <code><a href="#topic+ppcomp">ppcomp</a></code>).
</p>
</dd>
<dt><code>logLik</code></dt><dd><p> Extracts the estimated log-likelihood from the <code>"fitdist"</code> object.
</p>
</dd>
<dt><code>AIC</code></dt><dd><p> Extracts the AIC from the <code>"fitdist"</code> object.
</p>
</dd>
<dt><code>BIC</code></dt><dd><p> Extracts the estimated BIC from the <code>"fitdist"</code> object.
</p>
</dd>
<dt><code>vcov</code></dt><dd><p> Extracts the estimated var-covariance matrix from the <code>"fitdist"</code> object
(only available When <code>method = "mle"</code>).
</p>
</dd>
<dt><code>coef</code></dt><dd><p> Extracts the fitted coefficients from the <code>"fitdist"</code> object.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>I. Ibragimov and R. Has'minskii (1981), 
<em>Statistical Estimation - Asymptotic Theory</em>, Springer-Verlag, 
<a href="https://doi.org/10.1007/978-1-4899-0027-2">doi:10.1007/978-1-4899-0027-2</a>
</p>
<p>Cullen AC and Frey HC (1999), <em>Probabilistic techniques in exposure assessment</em>.
Plenum Press, USA, pp. 81-155.
</p>
<p>Venables WN and Ripley BD (2002), <em>Modern applied statistics with S</em>.
Springer, New York, pp. 435-446, <a href="https://doi.org/10.1007/978-0-387-21706-2">doi:10.1007/978-0-387-21706-2</a>.
</p>
<p>Vose D (2000), <em>Risk analysis, a quantitative guide</em>.
John Wiley &amp; Sons Ltd, Chischester, England, pp. 99-143.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+fitdistrplus">fitdistrplus</a></code> for an overview of the package.
See <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, 
<code><a href="#topic+mgedist">mgedist</a></code>, <code><a href="#topic+msedist">msedist</a></code> for details on parameter estimation.
See <code><a href="#topic+gofstat">gofstat</a></code> for goodness-of-fit statistics.
See <code><a href="#topic+plotdist">plotdist</a></code>, <code><a href="#topic+graphcomp">graphcomp</a></code>, <code><a href="#topic+CIcdfplot">CIcdfplot</a></code> for graphs
(with or without uncertainty and/or multiple fits).
See <code><a href="#topic+llplot">llplot</a></code> for (log-)likelihood plots in the
neighborhood of the fitted value.
See <code><a href="#topic+bootdist">bootdist</a></code> for bootstrap procedures 
and <code><a href="#topic+fitdistcens">fitdistcens</a></code> for censored-data fitting methods.
See <code><a href="stats.html#topic+optim">optim</a></code> for base R optimization procedures.
See <code><a href="#topic+quantile.fitdist">quantile.fitdist</a></code>, another generic function, which calculates 
quantiles from the fitted distribution.
See <code><a href="#topic+quantile">quantile</a></code> for base R quantile computation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1) fit of a gamma distribution by maximum likelihood estimation
#

data(groundbeef)
serving &lt;- groundbeef$serving
fitg &lt;- fitdist(serving, "gamma")
summary(fitg)
plot(fitg)
plot(fitg, demp = TRUE)
plot(fitg, histo = FALSE, demp = TRUE)
cdfcomp(fitg, addlegend=FALSE)
denscomp(fitg, addlegend=FALSE)
ppcomp(fitg, addlegend=FALSE)
qqcomp(fitg, addlegend=FALSE)


# (2) use the moment matching estimation (using a closed formula)
#

fitgmme &lt;- fitdist(serving, "gamma", method="mme")
summary(fitgmme)

# (3) Comparison of various fits 
#

fitW &lt;- fitdist(serving, "weibull")
fitg &lt;- fitdist(serving, "gamma")
fitln &lt;- fitdist(serving, "lnorm")
summary(fitW)
summary(fitg)
summary(fitln)
cdfcomp(list(fitW, fitg, fitln), legendtext=c("Weibull", "gamma", "lognormal"))
denscomp(list(fitW, fitg, fitln), legendtext=c("Weibull", "gamma", "lognormal"))
qqcomp(list(fitW, fitg, fitln), legendtext=c("Weibull", "gamma", "lognormal"))
ppcomp(list(fitW, fitg, fitln), legendtext=c("Weibull", "gamma", "lognormal"))
gofstat(list(fitW, fitg, fitln), fitnames=c("Weibull", "gamma", "lognormal"))

# (4) defining your own distribution functions, here for the Gumbel distribution
# for other distributions, see the CRAN task view 
# dedicated to probability distributions
#

dgumbel &lt;- function(x, a, b) 1/b*exp((a-x)/b)*exp(-exp((a-x)/b))
pgumbel &lt;- function(q, a, b) exp(-exp((a-q)/b))
qgumbel &lt;- function(p, a, b) a-b*log(-log(p))

fitgumbel &lt;- fitdist(serving, "gumbel", start=list(a=10, b=10))
summary(fitgumbel)
plot(fitgumbel)

# (5) fit discrete distributions (Poisson and negative binomial)
#

data(toxocara)
number &lt;- toxocara$number
fitp &lt;- fitdist(number,"pois")
summary(fitp)
plot(fitp)
fitnb &lt;- fitdist(number,"nbinom")
summary(fitnb)
plot(fitnb)

cdfcomp(list(fitp,fitnb))
gofstat(list(fitp,fitnb))

# (6) how to change the optimisation method?
#

data(groundbeef)
serving &lt;- groundbeef$serving
fitdist(serving, "gamma", optim.method="Nelder-Mead")
fitdist(serving, "gamma", optim.method="BFGS") 
fitdist(serving, "gamma", optim.method="SANN")

# (7) custom optimization function
#

#create the sample
set.seed(1234)
mysample &lt;- rexp(100, 5)
mystart &lt;- list(rate=8)

res1 &lt;- fitdist(mysample, dexp, start= mystart, optim.method="Nelder-Mead")

#show the result
summary(res1)

#the warning tell us to use optimise, because the Nelder-Mead is not adequate.

#to meet the standard 'fn' argument and specific name arguments, we wrap optimize, 
myoptimize &lt;- function(fn, par, ...) 
{
    res &lt;- optimize(f=fn, ..., maximum=FALSE)  
    #assume the optimization function minimize
    
    standardres &lt;- c(res, convergence=0, value=res$objective, 
        par=res$minimum, hessian=NA)
    
    return(standardres)
}

#call fitdist with a 'custom' optimization function
res2 &lt;- fitdist(mysample, "exp", start=mystart, custom.optim=myoptimize, 
    interval=c(0, 100))

#show the result
summary(res2)



# (8) custom optimization function - another example with the genetic algorithm
#

    #set a sample
    fit1 &lt;- fitdist(serving, "gamma")
    summary(fit1)

    #wrap genoud function rgenoud package
    mygenoud &lt;- function(fn, par, ...) 
    {
        require("rgenoud")
        res &lt;- genoud(fn, starting.values=par, ...)        
        standardres &lt;- c(res, convergence=0)
            
        return(standardres)
    }

    #call fitdist with a 'custom' optimization function
    fit2 &lt;- fitdist(serving, "gamma", custom.optim=mygenoud, nvars=2,    
        Domains=cbind(c(0, 0), c(10, 10)), boundary.enforcement=1, 
        print.level=1, hessian=TRUE)

    summary(fit2)


# (9) estimation of the standard deviation of a gamma distribution 
# by maximum likelihood with the shape fixed at 4 using the argument fix.arg
#

data(groundbeef)
serving &lt;- groundbeef$serving
f1c  &lt;- fitdist(serving,"gamma",start=list(rate=0.1),fix.arg=list(shape=4))
summary(f1c)
plot(f1c)

# (10) fit of a Weibull distribution to serving size data 
# by maximum likelihood estimation
# or by quantile matching estimation (in this example 
# matching first and third quartiles)
#

data(groundbeef)
serving &lt;- groundbeef$serving
fWmle &lt;- fitdist(serving, "weibull")
summary(fWmle)
plot(fWmle)
gofstat(fWmle)

fWqme &lt;- fitdist(serving, "weibull", method="qme", probs=c(0.25, 0.75))
summary(fWqme)
plot(fWqme)
gofstat(fWqme)


# (11) Fit of a Pareto distribution by numerical moment matching estimation
#


    require("actuar")
    #simulate a sample
    x4 &lt;- rpareto(1000, 6, 2)

    #empirical raw moment
    memp &lt;- function(x, order) mean(x^order)

    #fit
    fP &lt;- fitdist(x4, "pareto", method="mme", order=c(1, 2), memp="memp", 
      start=list(shape=10, scale=10), lower=1, upper=Inf)
    summary(fP)
    plot(fP)



# (12) Fit of a Weibull distribution to serving size data by maximum 
# goodness-of-fit estimation using all the distances available
# 

data(groundbeef)
serving &lt;- groundbeef$serving
(f1 &lt;- fitdist(serving, "weibull", method="mge", gof="CvM"))
(f2 &lt;- fitdist(serving, "weibull", method="mge", gof="KS"))
(f3 &lt;- fitdist(serving, "weibull", method="mge", gof="AD"))
(f4 &lt;- fitdist(serving, "weibull", method="mge", gof="ADR"))
(f5 &lt;- fitdist(serving, "weibull", method="mge", gof="ADL"))
(f6 &lt;- fitdist(serving, "weibull", method="mge", gof="AD2R"))
(f7 &lt;- fitdist(serving, "weibull", method="mge", gof="AD2L"))
(f8 &lt;- fitdist(serving, "weibull", method="mge", gof="AD2"))
cdfcomp(list(f1, f2, f3, f4, f5, f6, f7, f8))
cdfcomp(list(f1, f2, f3, f4, f5, f6, f7, f8), 
  xlogscale=TRUE, xlim=c(8, 250), verticals=TRUE)
denscomp(list(f1, f2, f3, f4, f5, f6, f7, f8))


# (13) Fit of a uniform distribution using maximum likelihood 
# (a closed formula is used in this special case where the loglikelihood is not defined),
# or maximum goodness-of-fit with Cramer-von Mises or Kolmogorov-Smirnov distance
# 

set.seed(1234)
u &lt;- runif(50, min=5, max=10)

fumle &lt;- fitdist(u, "unif", method="mle")
summary(fumle)
plot(fumle)
gofstat(fumle)

fuCvM &lt;- fitdist(u, "unif", method="mge", gof="CvM")
summary(fuCvM)
plot(fuCvM)
gofstat(fuCvM)

fuKS &lt;- fitdist(u, "unif", method="mge", gof="KS")
summary(fuKS)
plot(fuKS)
gofstat(fuKS)

# (14) scaling problem
# the simulated dataset (below) has particularly small values, hence without scaling (10^0),
# the optimization raises an error. The for loop shows how scaling by 10^i
# for i=1,...,6 makes the fitting procedure work correctly.

set.seed(1234)
x2 &lt;- rnorm(100, 1e-4, 2e-4)

for(i in 0:6)
        cat(i, try(fitdist(x2*10^i, "cauchy", method="mle")$estimate, silent=TRUE), "\n")

# (15) Fit of a normal distribution on acute toxicity values of endosulfan in log10 for
# nonarthropod invertebrates, using maximum likelihood estimation
# to estimate what is called a species sensitivity distribution 
# (SSD) in ecotoxicology, followed by estimation of the 5 percent quantile value of 
# the fitted distribution (which is called the 5 percent hazardous concentration, HC5,
# in ecotoxicology) and estimation of other quantiles.
#
data(endosulfan)
ATV &lt;- subset(endosulfan, group == "NonArthroInvert")$ATV
log10ATV &lt;- log10(subset(endosulfan, group == "NonArthroInvert")$ATV)
fln &lt;- fitdist(log10ATV, "norm")

quantile(fln, probs = 0.05)
quantile(fln, probs = c(0.05, 0.1, 0.2))


# (16) Fit of a triangular distribution using Cramer-von Mises or
# Kolmogorov-Smirnov distance
# 


set.seed(1234)
require("mc2d")
t &lt;- rtriang(100, min=5, mode=6, max=10)
fCvM &lt;- fitdist(t, "triang", method="mge", start = list(min=4, mode=6,max=9), gof="CvM")
fKS &lt;- fitdist(t, "triang", method="mge", start = list(min=4, mode=6,max=9), gof="KS")
cdfcomp(list(fCvM,fKS))


# (17) fit a non classical discrete distribution (the zero inflated Poisson distribution)
#

require("gamlss.dist")
set.seed(1234)
x &lt;- rZIP(n = 30, mu = 5, sigma = 0.2)
plotdist(x, discrete = TRUE)
fitzip &lt;- fitdist(x, "ZIP", start =  list(mu = 4, sigma = 0.15), discrete = TRUE, 
  optim.method = "L-BFGS-B", lower = c(0, 0), upper = c(Inf, 1))
summary(fitzip)
plot(fitzip)
fitp &lt;- fitdist(x, "pois")
cdfcomp(list(fitzip, fitp))
gofstat(list(fitzip, fitp))




# (18) examples with distributions in actuar (predefined starting values)
#

require("actuar")
x &lt;- c(2.3,0.1,2.7,2.2,0.4,2.6,0.2,1.,7.3,3.2,0.8,1.2,33.7,14.,
       21.4,7.7,1.,1.9,0.7,12.6,3.2,7.3,4.9,4000.,2.5,6.7,3.,63.,
       6.,1.6,10.1,1.2,1.5,1.2,30.,3.2,3.5,1.2,0.2,1.9,0.7,17.,
       2.8,4.8,1.3,3.7,0.2,1.8,2.6,5.9,2.6,6.3,1.4,0.8)
#log logistic
ft_llogis &lt;- fitdist(x,'llogis')

x &lt;- c(0.3837053, 0.8576858, 0.3552237, 0.6226119, 0.4783756, 0.3139799, 0.4051403, 
       0.4537631, 0.4711057, 0.5647414, 0.6479617, 0.7134207, 0.5259464, 0.5949068, 
       0.3509200, 0.3783077, 0.5226465, 1.0241043, 0.4384580, 1.3341520)
#inverse weibull
ft_iw &lt;- fitdist(x,'invweibull')


</code></pre>

<hr>
<h2 id='fitdistcens'>Fitting of univariate distributions to censored data</h2><span id='topic+fitdistcens'></span><span id='topic+plot.fitdistcens'></span><span id='topic+print.fitdistcens'></span><span id='topic+summary.fitdistcens'></span><span id='topic+logLik.fitdistcens'></span><span id='topic+AIC.fitdistcens'></span><span id='topic+BIC.fitdistcens'></span><span id='topic+vcov.fitdistcens'></span><span id='topic+coef.fitdistcens'></span>

<h3>Description</h3>

<p>Fits a univariate distribution to censored data by maximum likelihood.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitdistcens(censdata, distr, start=NULL, fix.arg=NULL, 
  keepdata = TRUE, keepdata.nb=100, calcvcov=TRUE, ...)

## S3 method for class 'fitdistcens'
print(x, ...)

## S3 method for class 'fitdistcens'
plot(x, ...)

## S3 method for class 'fitdistcens'
summary(object, ...)

## S3 method for class 'fitdistcens'
logLik(object, ...)

## S3 method for class 'fitdistcens'
AIC(object, ..., k = 2)

## S3 method for class 'fitdistcens'
BIC(object, ...)

## S3 method for class 'fitdistcens'
vcov(object, ...)

## S3 method for class 'fitdistcens'
coef(object, ...)

    
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitdistcens_+3A_censdata">censdata</code></td>
<td>
<p> A dataframe of two columns respectively named <code>left</code> 
and <code>right</code>, describing each observed value as an interval.
The <code>left</code> column contains either <code>NA</code> for left censored observations,
the left bound of the interval for interval censored observations,
or the observed value for non-censored observations.
The <code>right</code> column contains either <code>NA</code> for right censored observations,
the right bound of the interval for interval censored observations,
or the observed value for non-censored observations.  </p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_distr">distr</code></td>
<td>
<p> A character string <code>"name"</code> naming a distribution, for which the corresponding 
density function <code>dname</code> and the corresponding distribution function <code>pname</code>
must be defined, or directly the density function.</p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_start">start</code></td>
<td>
<p> A named list giving the initial values of parameters of the named distribution. 
This argument may be omitted for some distributions for which reasonable 
starting values are computed (see the 'details' section of  <code><a href="#topic+mledist">mledist</a></code>).  </p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_fix.arg">fix.arg</code></td>
<td>
<p> An optional named list giving the values of parameters of the named distribution
that must be kept fixed rather than estimated by maximum likelihood. </p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_x">x</code></td>
<td>
<p> an object of class <code>"fitdistcens"</code>.  </p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_object">object</code></td>
<td>
<p> an object of class <code>"fitdistcens"</code>.  </p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_keepdata">keepdata</code></td>
<td>
<p>a logical. If <code>TRUE</code>, dataset is returned, 
otherwise only a sample subset is returned.</p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_keepdata.nb">keepdata.nb</code></td>
<td>
<p>When <code>keepdata=FALSE</code>, the length of the subset returned.</p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_calcvcov">calcvcov</code></td>
<td>
<p>A logical indicating if (asymptotic) covariance matrix is required.</p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_k">k</code></td>
<td>
<p>penalty per parameter to be passed to the AIC generic function (2 by default).</p>
</td></tr>
<tr><td><code id="fitdistcens_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to generic functions,
to the function <code>plotdistcens</code> in order to control the type of ecdf-plot used for censored data, 
or to the function <code>mledist</code> 
in order to control the optimization method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Maximum likelihood estimations of the distribution parameters are computed using 
the function <code><a href="#topic+mledist">mledist</a></code>. 
By default direct optimization of the log-likelihood is performed using <code><a href="stats.html#topic+optim">optim</a></code>,
with the &quot;Nelder-Mead&quot; method for distributions characterized by more than one parameter
and the &quot;BFGS&quot; method for distributions characterized by only one parameter. 
The algorithm used in <code><a href="stats.html#topic+optim">optim</a></code> can be chosen or another optimization function
can be specified using ... argument (see <code><a href="#topic+mledist">mledist</a></code> for details).
<code>start</code> may be omitted (i.e. <code>NULL</code>) for some classic distributions
(see the 'details' section of  <code><a href="#topic+mledist">mledist</a></code>).
Note that when errors are raised by <code>optim</code>, it's a good idea to start by adding traces during
the optimization process by adding <code>control=list(trace=1, REPORT=1)</code> in ... argument.
</p>
<p>The function is not able to fit a uniform distribution.     
With the parameter estimates, the function returns the log-likelihood and the standard errors of 
the estimates calculated from the 
Hessian at the solution found by <code>optim</code> or by the user-supplied function passed to mledist.
</p>
<p>By default (<code>keepdata = TRUE</code>), the object returned by <code>fitdist</code> contains 
the data vector given in input.
When dealing with large datasets, we can remove the original dataset from the output by
setting <code>keepdata = FALSE</code>. In such a case, only <code>keepdata.nb</code> points (at most) 
are kept by random subsampling <code>keepdata.nb</code>-4 points from the dataset and 
adding the component-wise minimum and maximum. 
If combined with <code><a href="#topic+bootdistcens">bootdistcens</a></code>, be aware that bootstrap is performed on the subset
randomly selected in <code>fitdistcens</code>. Currently, the graphical comparisons of multiple fits 
is not available in this framework.
</p>
<p>Weighted version of the estimation process is available for <code>method = "mle"</code>
by using <code>weights=...</code>. See the corresponding man page for details.
It is not yet possible to take into account weighths in functions plotdistcens, 
plot.fitdistcens and cdfcompcens 
(developments planned in the future).
</p>
<p>Once the parameter(s) is(are) estimated, <code><a href="#topic+gofstat">gofstat</a></code> allows to compute 
goodness-of-fit statistics.
</p>


<h3>Value</h3>

 
<p><code>fitdistcens</code> returns an object of class <code>"fitdistcens"</code>, a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> the character string coding for the fitting method : 
only <code>"mle"</code> for 'maximum likelihood estimation'.</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p> the estimated standard errors.</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p> the estimated correlation matrix, <code>NA</code> if numerically not computable
or <code>NULL</code> if not available.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p> the estimated variance-covariance matrix, <code>NULL</code> if not available.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> the log-likelihood.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p> the Akaike information criterion.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p> the the so-called BIC or SBC (Schwarz Bayesian criterion).</p>
</td></tr>
<tr><td><code>censdata</code></td>
<td>
<p> the censored data set.</p>
</td></tr>
<tr><td><code>distname</code></td>
<td>
<p> the name of the distribution.</p>
</td></tr>
<tr><td><code>fix.arg</code></td>
<td>
<p> the named list giving the values of parameters of the named distribution
that must be kept fixed rather than estimated by maximum likelihood or 
<code>NULL</code> if there are no such parameters. </p>
</td></tr>
<tr><td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p>
</td></tr>    
<tr><td><code>dots</code></td>
<td>
<p> the list of  further arguments passed in ... to be used in <code>bootdistcens</code> to
control the optimization method used in iterative calls to <code>mledist</code> or 
<code>NULL</code> if no such arguments.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of 
<code><a href="stats.html#topic+optim">optim</a></code>/<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> defined as below
or defined by the user in the user-supplied optimization function. 
<code>0</code> indicates successful convergence.
<code>1</code> indicates that the iteration limit of <code><a href="stats.html#topic+optim">optim</a></code> has been reached.
<code>10</code> indicates degeneracy of the Nealder-Mead simplex.
<code>100</code> indicates that <code><a href="stats.html#topic+optim">optim</a></code> encountered an internal error.</p>
</td></tr> 
<tr><td><code>discrete</code></td>
<td>
<p>always <code>FALSE</code>.</p>
</td></tr>    
<tr><td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or <code>NULL</code>.</p>
</td></tr>
</table>
<p>Generic functions:
</p>
       
<dl>
<dt><code>print</code></dt><dd>
<p>The print of a <code>"fitdist"</code> object shows few traces about the fitting method and the fitted distribution.
</p>
</dd>
<dt><code>summary</code></dt><dd>
<p>The summary provides the parameter estimates of the fitted distribution, the log-likelihood, 
AIC and BIC statistics, the standard errors of the 
parameter estimates and the correlation matrix between parameter estimates.
</p>
</dd>
<dt><code>plot</code></dt><dd>
<p>The plot of an object of class <code>"fitdistcens"</code> returned by <code>fitdistcens</code> uses the 
function <code><a href="#topic+plotdistcens">plotdistcens</a></code>.
</p>
</dd>
<dt><code>logLik</code></dt><dd><p> Extracts the estimated log-likelihood from the <code>"fitdistcens"</code> object.
</p>
</dd>
<dt><code>AIC</code></dt><dd><p> Extracts the AIC from the <code>"fitdistcens"</code> object.
</p>
</dd>
<dt><code>BIC</code></dt><dd><p> Extracts the BIC from the <code>"fitdistcens"</code> object.
</p>
</dd>
<dt><code>vcov</code></dt><dd><p> Extracts the estimated var-covariance matrix from the <code>"fitdistcens"</code> object
(only available When <code>method = "mle"</code>).
</p>
</dd>
<dt><code>coef</code></dt><dd><p> Extracts the fitted coefficients from the <code>"fitdistcens"</code> object.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Venables WN and Ripley BD (2002), <em>Modern applied statistics with S</em>.
Springer, New York, pp. 435-446, <a href="https://doi.org/10.1007/978-0-387-21706-2">doi:10.1007/978-0-387-21706-2</a>.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+Surv2fitdistcens">Surv2fitdistcens</a></code> to convert <code>Surv</code> outputs to a
data frame appropriate for <code>fitdistcens</code>.
See <code><a href="#topic+plotdistcens">plotdistcens</a></code>, <code><a href="stats.html#topic+optim">optim</a></code> and 
<code><a href="#topic+quantile.fitdistcens">quantile.fitdistcens</a></code> for generic functions.
See <code><a href="#topic+gofstat">gofstat</a></code> for goodness-of-fit statistics.
See <code><a href="#topic+fitdistrplus">fitdistrplus</a></code> for an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) Fit of a lognormal distribution to bacterial contamination data
#
data(smokedfish)
fitsf  &lt;-  fitdistcens(smokedfish,"lnorm")
summary(fitsf)
# default plot using the Wang technique (see ?plotdiscens for details)
plot(fitsf)
# plot using the Turnbull algorithm (see ?plotdiscens for details)
# with confidence intervals for the empirical distribution
plot(fitsf, NPMLE = TRUE, NPMLE.method = "Turnbull", Turnbull.confint = TRUE)
# basic plot using intervals and points (see ?plotdiscens for details)
plot(fitsf, NPMLE = FALSE)
# plot of the same fit using the Turnbull algorithm in logscale
cdfcompcens(fitsf,main="bacterial contamination fits",
    xlab="bacterial concentration (CFU/g)",ylab="F",
    addlegend = FALSE,lines01 = TRUE, xlogscale = TRUE, xlim = c(1e-2,1e2))
# zoom on large values of F
cdfcompcens(fitsf,main="bacterial contamination fits",
    xlab="bacterial concentration (CFU/g)",ylab="F",
    addlegend = FALSE,lines01 = TRUE, xlogscale = TRUE, 
    xlim = c(1e-2,1e2),ylim=c(0.4,1))

# (2) Fit of a normal distribution on acute toxicity values 
# of fluazinam (in decimal logarithm) for
# macroinvertebrates and zooplancton, using maximum likelihood estimation
# to estimate what is called a species sensitivity distribution 
# (SSD) in ecotoxicology
#

data(fluazinam)
log10EC50 &lt;-log10(fluazinam)
fln &lt;- fitdistcens(log10EC50,"norm")
fln
summary(fln)
plot(fln)

# (3) defining your own distribution functions, here for the Gumbel distribution
# for other distributions, see the CRAN task view dedicated to 
# probability distributions
#

dgumbel  &lt;-  function(x,a,b) 1/b*exp((a-x)/b)*exp(-exp((a-x)/b))
pgumbel  &lt;-  function(q,a,b) exp(-exp((a-q)/b))
qgumbel  &lt;-  function(p,a,b) a-b*log(-log(p))
fg &lt;- fitdistcens(log10EC50,"gumbel",start=list(a=1,b=1))
summary(fg)
plot(fg)

# (4) comparison of fits of various distributions
# 

fll &lt;- fitdistcens(log10EC50,"logis")
summary(fll)

cdfcompcens(list(fln,fll,fg),legendtext=c("normal","logistic","gumbel"),
xlab = "log10(EC50)")

# (5) how to change the optimisation method?
#

fitdistcens(log10EC50,"logis",optim.method="Nelder-Mead")
fitdistcens(log10EC50,"logis",optim.method="BFGS") 
fitdistcens(log10EC50,"logis",optim.method="SANN") 

# (6) custom optimisation function - example with the genetic algorithm
#


    #wrap genoud function rgenoud package
    mygenoud  &lt;-  function(fn, par, ...) 
    {
        require("rgenoud")
        res  &lt;-  genoud(fn, starting.values=par, ...)        
        standardres  &lt;-  c(res, convergence=0)
            
        return(standardres)
    }

    # call fitdistcens with a 'custom' optimization function
    fit.with.genoud &lt;- fitdistcens(log10EC50,"logis", custom.optim=mygenoud, nvars=2,    
        Domains=cbind(c(0,0), c(5, 5)), boundary.enforcement=1, 
        print.level=1, hessian=TRUE)

    summary(fit.with.genoud)


# (7) estimation of the mean of a normal distribution 
# by maximum likelihood with the standard deviation fixed at 1 using the argument fix.arg
#
flnb &lt;- fitdistcens(log10EC50, "norm", start = list(mean = 1),fix.arg = list(sd = 1))

# (8) Fit of a lognormal distribution on acute toxicity values of fluazinam for
# macroinvertebrates and zooplancton, using maximum likelihood estimation
# to estimate what is called a species sensitivity distribution 
# (SSD) in ecotoxicology, followed by estimation of the 5 percent quantile value of 
# the fitted distribution (which is called the 5 percent hazardous concentration, HC5,
# in ecotoxicology) and estimation of other quantiles.

data(fluazinam)
log10EC50 &lt;-log10(fluazinam)
fln &lt;- fitdistcens(log10EC50,"norm")

quantile(fln, probs = 0.05)
quantile(fln, probs = c(0.05, 0.1, 0.2))

# (9) Fit of a lognormal distribution on 72-hour acute salinity tolerance (LC50 values)
# of riverine macro-invertebrates using maximum likelihood estimation

data(salinity)
log10LC50 &lt;-log10(salinity)
fln &lt;- fitdistcens(log10LC50,"norm")
plot(fln)

</code></pre>

<hr>
<h2 id='fluazinam'>Species-Sensitivity Distribution (SSD) for Fluazinam</h2><span id='topic+fluazinam'></span>

<h3>Description</h3>

<p>48-hour acute toxicity values (EC50 values) for exposure of macroinvertebrates and zooplancton to fluazinam.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fluazinam)</code></pre>


<h3>Format</h3>

 
<p><code>fluazinam</code> is a data frame with 2 columns named left and right, describing
each observed EC50 value (in micrograms per liter) as an interval. 
The left column contains either NA for
left censored observations, the left bound of the interval for interval censored
observations, or the observed value for non-censored observations. The right
column contains either NA for right censored observations, the right bound of
the interval for interval censored observations, or the observed value for noncensored
observations.
</p>


<h3>Source</h3>

<p>Hose, G.C., Van den Brink, P.J. 2004. The species sensitivity distribution approach compared 
to a microcosm study: A case study with the fungicide fluazinam. <em>Ecotoxicology
and Environmental Safety</em>, <b>73</b>, 109-122.</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load of data
#
data(fluazinam)

# (2) plot of data using Turnbull cdf plot
#
log10EC50 &lt;- log10(fluazinam)
plotdistcens(log10EC50)

# (3) fit of a lognormal and a logistic distribution to data
# (classical distributions used for species sensitivity 
# distributions, SSD, in ecotoxicology)
# and visual comparison of the fits using Turnbull cdf plot 
#
fln &lt;- fitdistcens(log10EC50, "norm")
summary(fln)

fll &lt;- fitdistcens(log10EC50, "logis")
summary(fll)

cdfcompcens(list(fln,fll), legendtext = c("normal", "logistic"), 
  xlab = "log10(EC50)")

# (4) estimation of the 5 percent quantile value of 
# the normal fitted distribution (5 percent hazardous concentration  : HC5)
# with its two-sided 95 percent confidence interval calculated by 
# non parametric bootstrap
# with a small number of iterations to satisfy CRAN running times constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.
#
# in log10(EC50)
bln &lt;- bootdistcens(fln, niter = 101)
HC5ln &lt;- quantile(bln, probs = 0.05)
# in EC50
10^(HC5ln$quantiles)
10^(HC5ln$quantCI)

# (5) estimation of the HC5 value
# with its one-sided 95 percent confidence interval (type "greater")
#
# in log10(EC50)
HC5lnb &lt;- quantile(bln, probs = 0.05, CI.type = "greater")

# in LC50
10^(HC5lnb$quantiles)
10^(HC5lnb$quantCI)
</code></pre>

<hr>
<h2 id='fremale'>Fictive survival dataset of a french Male population</h2><span id='topic+fremale'></span>

<h3>Description</h3>

<p>100 male individuals randomly taken from <code>frefictivetable</code> in <code>CASdatasets</code> package</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fremale)</code></pre>


<h3>Format</h3>

 
<p><code>fremale</code> is a data frame with 3 columns names <code>AgeIn</code>, <code>AgeOut</code>
respectively for entry age and exit age; <code>Death</code> a binary dummy: 1 indicating
the death of the individual; 0 a censored observation.
</p>


<h3>References</h3>

<p>See full dataset <code>frefictivetable</code> of <code>CASdatasets</code> at <a href="http://dutangc.perso.math.cnrs.fr/RRepository/">http://dutangc.perso.math.cnrs.fr/RRepository/</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load of data
#
data(fremale)
summary(fremale)
</code></pre>

<hr>
<h2 id='gofstat'> Goodness-of-fit statistics</h2><span id='topic+gofstat'></span><span id='topic+print.gofstat.fitdist'></span><span id='topic+print.gofstat.fitdistcens'></span>

<h3>Description</h3>

<p>Computes goodness-of-fit statistics for parametric distributions fitted to a same  
censored or non-censored data set.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofstat(f, chisqbreaks, meancount, discrete, fitnames=NULL) 
	
## S3 method for class 'gofstat.fitdist'
print(x, ...)
## S3 method for class 'gofstat.fitdistcens'
print(x, ...)
	
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gofstat_+3A_f">f</code></td>
<td>
<p> An object of class <code>"fitdist"</code> (or <code>"fitdistcens"</code> ), 
output of the function <code>fitdist()</code> (resp. <code>"fitdist()"</code>), or
a list of <code>"fitdist"</code> objects, or a list of <code>"fitdistcens"</code> objects.</p>
</td></tr>
<tr><td><code id="gofstat_+3A_chisqbreaks">chisqbreaks</code></td>
<td>
<p>Only usable for non censored data, a numeric vector defining the breaks of the cells used to compute the chi-squared
statistic. If omitted, these breaks are automatically computed from the data 
in order to reach roughly the same number of observations per cell, roughly equal to the argument
<code>meancount</code>, or sligthly more if there are some ties. </p>
</td></tr>
<tr><td><code id="gofstat_+3A_meancount">meancount</code></td>
<td>
<p>Only usable for non censored data, the mean number of observations per cell expected for the definition of the breaks 
of the cells used to compute the chi-squared statistic. This argument will not be taken into 
account if the breaks are directly defined in the argument <code>chisqbreaks</code>. If <code>chisqbreaks</code> 
and <code>meancount</code> are both omitted, <code>meancount</code> is fixed in order to obtain roughly 
<code class="reqn">(4n)^{2/5}</code> cells with <code class="reqn">n</code> the length of the dataset. </p>
</td></tr>
<tr><td><code id="gofstat_+3A_discrete">discrete</code></td>
<td>
<p>If <code>TRUE</code>, only the Chi-squared statistic and information criteria are computed.
If missing, <code>discrete</code> is passed from the first object of class <code>"fitdist"</code> of the list <code>f</code>.
For censored data this argument is ignored, as censored data are considered continuous.</p>
</td></tr>
<tr><td><code id="gofstat_+3A_fitnames">fitnames</code></td>
<td>
<p>A vector defining the names of the fits.</p>
</td></tr>
<tr><td><code id="gofstat_+3A_x">x</code></td>
<td>
<p>An object of class <code>"gofstat.fitdist"</code> or <code>"gofstat.fitdistcens"</code>.  </p>
</td></tr>
<tr><td><code id="gofstat_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For any type of data (censored or not), information criteria are calculated.
For non censored data, added Goodness-of-fit statistics are computed as described below. 
</p>
<p>The Chi-squared statistic is computed using cells defined 
by the argument 
<code>chisqbreaks</code> or cells automatically defined from data, in order 
to reach roughly the same number of observations per cell, roughly equal to the argument
<code>meancount</code>, or sligthly more if there are some ties. 
The choice to define cells from the empirical distribution (data), and not from the
theoretical distribution, was done to enable the comparison of Chi-squared values obtained
with different distributions fitted on a same data set.
If <code>chisqbreaks</code> and <code>meancount</code> 
are both omitted, <code>meancount</code> is fixed in order to obtain roughly <code class="reqn">(4n)^{2/5}</code> cells, 
with <code class="reqn">n</code> the length of the data set (Vose, 2000).
The Chi-squared statistic is not computed if the program fails
to define enough cells due to a too small dataset. When the Chi-squared statistic is computed, 
and if the degree of freedom (nb of cells - nb of parameters - 1)  of the corresponding distribution 
is strictly positive, the p-value of the Chi-squared test is returned.
</p>
<p>For continuous distributions, Kolmogorov-Smirnov, Cramer-von Mises and 
Anderson-Darling  and statistics are also computed, as defined by Stephens (1986). 
</p>
<p>An approximate Kolmogorov-Smirnov test is 
performed by assuming the distribution parameters known. The critical value defined by Stephens (1986) 
for a completely specified distribution is used to reject or not the 
distribution at the significance level 0.05. Because of this approximation, the result of the test
(decision of rejection of the distribution or not) is returned only for data sets with more 
than 30 observations. Note that this approximate test may be too conservative. 
</p>
<p>For data sets with more than 5 observations and for distributions for 
which the test is described by Stephens (1986) for maximum likelihood estimations 
(<code>"exp"</code>, <code>"cauchy"</code>, <code>"gamma"</code> and <code>"weibull"</code>),
the Cramer-von Mises and Anderson-darling tests are performed as described by Stephens (1986). 
Those tests take into 
account the fact that the parameters are not known but estimated from the data by maximum likelihood.
The result is the 
decision to reject or not the distribution at the significance level 0.05. Those tests are available
only for maximum likelihood estimations.
</p>
<p>Only recommended statistics are automatically printed, i.e.
Cramer-von Mises, Anderson-Darling and Kolmogorov statistics for continuous distributions and
Chi-squared statistics for discrete ones ( <code>"binom"</code>, 
<code>"nbinom"</code>, <code>"geom"</code>, <code>"hyper"</code> and <code>"pois"</code> ). 
</p>
<p>Results of the tests are not printed but stored in the output of the function. 
</p>


<h3>Value</h3>

 
<p><code>gofstat()</code> returns an object of class <code>"gofstat.fitdist"</code> or <code>"gofstat.fitdistcens"</code> with following components or a sublist of them (only aic, bic and nbfit for censored data) ,
</p>
<table role = "presentation">
<tr><td><code>chisq</code></td>
<td>
<p> a named vector with the Chi-squared statistics or <code>NULL</code> if not computed</p>
</td></tr>
<tr><td><code>chisqbreaks</code></td>
<td>
<p> common breaks used to define cells in the Chi-squared statistic </p>
</td></tr>
<tr><td><code>chisqpvalue</code></td>
<td>
<p> a named vector with the p-values of the Chi-squared statistic 
or <code>NULL</code> if not computed</p>
</td></tr>
<tr><td><code>chisqdf</code></td>
<td>
<p> a named vector with the degrees of freedom of the Chi-squared distribution
or <code>NULL</code> if not computed </p>
</td></tr>
<tr><td><code>chisqtable</code></td>
<td>
<p> a table with observed and theoretical counts used for the Chi-squared calculations </p>
</td></tr>
<tr><td><code>cvm</code></td>
<td>
<p> a named vector of the Cramer-von Mises statistics or <code>"not computed"</code> if not computed </p>
</td></tr>
<tr><td><code>cvmtest</code></td>
<td>
<p> a named vector of the decisions of the Cramer-von Mises test 
or <code>"not computed"</code> if not computed </p>
</td></tr>
<tr><td><code>ad</code></td>
<td>
<p> a named vector with the Anderson-Darling statistics or 
<code>"not computed"</code> if not computed </p>
</td></tr>
<tr><td><code>adtest</code></td>
<td>
<p> a named vector with the decisions of the Anderson-Darling test 
or <code>"not computed"</code> if not computed </p>
</td></tr>
<tr><td><code>ks</code></td>
<td>
<p> a named vector with the Kolmogorov-Smirnov statistic or 
<code>"not computed"</code> if not computed </p>
</td></tr>
<tr><td><code>kstest</code></td>
<td>
<p> a named vector with the decisions of the Kolmogorov-Smirnov test 
or <code>"not computed"</code> if not computed </p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>a named vector with the values of the Akaike's Information Criterion.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>a named vector with the values of the Bayesian Information Criterion.</p>
</td></tr>
<tr><td><code>discrete</code></td>
<td>
<p>the input argument or the automatic definition by the function from  the first
object of class <code>"fitdist"</code> of the list in input.</p>
</td></tr>
<tr><td><code>nbfit</code></td>
<td>
<p>Number of fits in argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Cullen AC and Frey HC (1999), <em>Probabilistic techniques in exposure assessment</em>.
Plenum Press, USA, pp. 81-155.
</p>
<p>Stephens MA (1986), <em>Tests based on edf statistics</em>. In Goodness-of-fit techniques (D'Agostino RB and
Stephens MA, eds), Marcel Dekker, New York, pp. 97-194.
</p>
<p>Venables WN and Ripley BD (2002), <em>Modern applied statistics with S</em>.
Springer, New York, pp. 435-446, <a href="https://doi.org/10.1007/978-0-387-21706-2">doi:10.1007/978-0-387-21706-2</a>.
</p>
<p>Vose D (2000), <em>Risk analysis, a quantitative guide</em>.
John Wiley &amp; Sons Ltd, Chischester, England, pp. 99-143.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+fitdist">fitdist</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1) fit of two distributions to the serving size data
# by maximum likelihood estimation
# and comparison of goodness-of-fit statistics
#

data(groundbeef)
serving &lt;- groundbeef$serving
(fitg &lt;- fitdist(serving, "gamma"))
gofstat(fitg)
(fitln &lt;- fitdist(serving, "lnorm"))
gofstat(fitln)

gofstat(list(fitg, fitln))


# (2) fit of two discrete distributions to toxocara data
# and comparison of goodness-of-fit statistics
#

data(toxocara)
number &lt;- toxocara$number

fitp &lt;- fitdist(number,"pois")
summary(fitp)
plot(fitp)

fitnb &lt;- fitdist(number,"nbinom")
summary(fitnb)
plot(fitnb)

gofstat(list(fitp, fitnb),fitnames = c("Poisson","negbin"))

# (3) Get Chi-squared results in addition to
#     recommended statistics for continuous distributions
#

set.seed(1234)
x4 &lt;- rweibull(n=1000,shape=2,scale=1)
# fit of the good distribution
f4 &lt;- fitdist(x4,"weibull")
plot(f4)

# fit of a bad distribution
f4b &lt;- fitdist(x4,"cauchy")
plot(f4b)

(g &lt;- gofstat(list(f4,f4b),fitnames=c("Weibull", "Cauchy")))
g$chisq
g$chisqdf
g$chisqpvalue
g$chisqtable

# and by defining the breaks
(g &lt;- gofstat(list(f4,f4b), 
chisqbreaks = seq(from = min(x4), to = max(x4), length.out = 10), fitnames=c("Weibull", "Cauchy")))
g$chisq
g$chisqdf
g$chisqpvalue
g$chisqtable

# (4) fit of two distributions on acute toxicity values 
# of fluazinam (in decimal logarithm) for
# macroinvertebrates and zooplancton
# and comparison of goodness-of-fit statistics
#

data(fluazinam)
log10EC50 &lt;-log10(fluazinam)
(fln &lt;- fitdistcens(log10EC50,"norm"))
plot(fln)
gofstat(fln)
(fll &lt;- fitdistcens(log10EC50,"logis"))
plot(fll)
gofstat(fll)

gofstat(list(fll, fln), fitnames = c("loglogistic", "lognormal"))


</code></pre>

<hr>
<h2 id='graphcomp'>Graphical comparison of multiple fitted distributions (for non-censored data)</h2><span id='topic+graphcomp'></span><span id='topic+cdfcomp'></span><span id='topic+denscomp'></span><span id='topic+qqcomp'></span><span id='topic+ppcomp'></span>

<h3>Description</h3>

   
<p><code>cdfcomp</code> plots the empirical cumulative distribution against fitted distribution functions,
<code>denscomp</code> plots the histogram against fitted density functions, 
<code>qqcomp</code> plots theoretical quantiles against empirical ones,
<code>ppcomp</code> plots theoretical probabilities against empirical ones.
Only <code>cdfcomp</code> is able to plot fits of a discrete distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfcomp(ft, xlim, ylim, xlogscale = FALSE, ylogscale = FALSE, main, xlab, ylab, 
    datapch, datacol, fitlty, fitcol, fitlwd, addlegend = TRUE, legendtext, 
    xlegend = "bottomright", ylegend = NULL, horizontals = TRUE, verticals = FALSE, 
    do.points = TRUE, use.ppoints = TRUE, a.ppoints = 0.5, name.points = NULL,
    lines01 = FALSE, discrete, add = FALSE, plotstyle = "graphics", 
    fitnbpts = 101, ...)
    
denscomp(ft, xlim, ylim, probability = TRUE, main, xlab, ylab, datacol, fitlty, 
    fitcol, fitlwd, addlegend = TRUE, legendtext, xlegend = "topright", ylegend = NULL, 
    demp = FALSE, dempcol = "black", plotstyle = "graphics", 
    discrete, fitnbpts = 101, fittype="l", ...)

qqcomp(ft, xlim, ylim, xlogscale = FALSE, ylogscale = FALSE, main, xlab, ylab, 
    fitpch, fitcol, fitlwd, addlegend = TRUE, legendtext, xlegend = "bottomright", 
    ylegend = NULL, use.ppoints = TRUE, a.ppoints = 0.5, line01 = TRUE, 
    line01col = "black", line01lty = 1, ynoise = TRUE, plotstyle = "graphics", ...)
    
ppcomp(ft, xlim, ylim, xlogscale = FALSE, ylogscale = FALSE, main, xlab, ylab, 
    fitpch, fitcol, fitlwd, addlegend = TRUE, legendtext, xlegend = "bottomright", 
    ylegend = NULL, use.ppoints = TRUE, a.ppoints = 0.5, line01 = TRUE, 
    line01col = "black", line01lty = 1, ynoise = TRUE, plotstyle = "graphics", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="graphcomp_+3A_ft">ft</code></td>
<td>
<p>One <code>"fitdist"</code> object or a list of objects of class <code>"fitdist"</code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_xlim">xlim</code></td>
<td>
<p>The <code class="reqn">x</code>-limits of the plot.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_ylim">ylim</code></td>
<td>
<p>The <code class="reqn">y</code>-limits of the plot.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_xlogscale">xlogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_ylogscale">ylogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <code class="reqn">y</code>-axis.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_main">main</code></td>
<td>
<p>A main title for the plot. See also <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">x</code>-axis, defaults to a description of <code>x</code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">y</code>-axis, defaults to a description of <code>y</code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_datapch">datapch</code></td>
<td>
<p>An integer specifying a symbol to be used in plotting data points. 
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_datacol">datacol</code></td>
<td>
<p>A specification of the color to be used in plotting data points.
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_fitcol">fitcol</code></td>
<td>
<p>A (vector of) color(s) to plot fitted distributions. 
If there are fewer colors than fits they are recycled in the standard fashion.
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_fitlty">fitlty</code></td>
<td>
<p>A (vector of) line type(s) to plot fitted distributions/densities. 
If there are fewer values than fits they are recycled in the standard fashion.
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_fitlwd">fitlwd</code></td>
<td>
<p>A (vector of) line size(s) to plot fitted distributions/densities. 
If there are fewer values than fits they are recycled in the standard fashion.
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_fitpch">fitpch</code></td>
<td>
<p>A (vector of) line type(s) to plot fitted quantiles/probabilities. 
If there are fewer values than fits they are recycled in the standard fashion.
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_fittype">fittype</code></td>
<td>
<p>The type of plot for fitted probabilities in the case of
discrete distributions: possible types are <code>"p"</code> for points,
<code>"l"</code> for lines and <code>"o"</code> for both overplotted 
(as in <code><a href="graphics.html#topic+plot.default">plot.default</a></code>).
<code>fittype</code> is not used for non-discrete distributions.</p>
</td></tr>  
<tr><td><code id="graphcomp_+3A_fitnbpts">fitnbpts</code></td>
<td>
<p>A numeric for the number of points to compute fitted probabilities 
or cumulative probabilities. Default to <code>101</code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_addlegend">addlegend</code></td>
<td>
<p>If <code>TRUE</code>, a legend is added to the plot.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_legendtext">legendtext</code></td>
<td>
<p>A character or expression vector of length <code class="reqn">\ge 1</code> to appear
in the legend. See also <code><a href="graphics.html#topic+legend">legend</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_xlegend">xlegend</code>, <code id="graphcomp_+3A_ylegend">ylegend</code></td>
<td>
<p>The <code class="reqn">x</code> and <code class="reqn">y</code> coordinates to be used to position the legend. 
They can be specified by keyword. 
If <code>plotstyle = "graphics"</code>, see <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code> and <code><a href="graphics.html#topic+legend">legend</a></code>.
If <code>plotstyle = "ggplot"</code>, the <code>xlegend</code> keyword must be one of <code>top</code>, <code>bottom</code>, 
<code>left</code>, or <code>right</code>. See also <code>guide_legend</code> in <code>ggplot2</code></p>
</td></tr>
<tr><td><code id="graphcomp_+3A_horizontals">horizontals</code></td>
<td>
<p>If <code>TRUE</code>, draws horizontal lines for the step empirical 
cumulative distribution function (ecdf). See also <code><a href="stats.html#topic+plot.stepfun">plot.stepfun</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_verticals">verticals</code></td>
<td>
<p>If <code>TRUE</code>, draws vertical lines for the empirical cumulative distribution 
function (ecdf). Only taken into account if <code>horizontals=TRUE</code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_do.points">do.points</code></td>
<td>
<p>If <code>TRUE</code> (by default), draws points at the x-locations. 
For large dataset (n &gt; 1e4), <code>do.points</code> is ignored and no point is drawn.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_use.ppoints">use.ppoints</code></td>
<td>
<p>If <code>TRUE</code>, probability points of the empirical distribution
are defined using function <code><a href="stats.html#topic+ppoints">ppoints</a></code> as <code>(1:n - a.ppoints)/(n - 2a.ppoints + 1)</code>.
If <code>FALSE</code>, probability points are simply defined as <code>(1:n)/n</code>. This argument is ignored 
for discrete data.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_a.ppoints">a.ppoints</code></td>
<td>
<p>If <code>use.ppoints=TRUE</code>, this is passed to the <code><a href="stats.html#topic+ppoints">ppoints</a></code> function.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_name.points">name.points</code></td>
<td>
<p>Label vector for points if they are drawn i.e. if do.points = TRUE (only for non censored data).</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_lines01">lines01</code></td>
<td>
<p>A logical to plot two horizontal lines at <code>h=0</code> and <code>h=1</code> for <code>cdfcomp</code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_line01">line01</code></td>
<td>
<p>A logical to plot an horizontal line <code class="reqn">y=x</code> for <code>qqcomp</code> and <code>ppcomp</code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_line01col">line01col</code>, <code id="graphcomp_+3A_line01lty">line01lty</code></td>
<td>
<p>Color and line type for <code>line01</code>. See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_demp">demp</code></td>
<td>
<p>A logical to add the empirical density on the plot, using the 
<code><a href="stats.html#topic+density">density</a></code> function.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_dempcol">dempcol</code></td>
<td>
<p>A color for the empirical density in case it is added on the plot (<code>demp=TRUE</code>).</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_ynoise">ynoise</code></td>
<td>
<p>A logical to add a small noise when plotting empirical 
quantiles/probabilities for <code>qqcomp</code> and <code>ppcomp</code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_probability">probability</code></td>
<td>
<p>A logical to use the probability scale for <code>denscomp</code>. See also <code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_discrete">discrete</code></td>
<td>
<p>If <code>TRUE</code>, the distributions are considered discrete.
When missing, <code>discrete</code> is set to <code>TRUE</code> if at least one 
object of the list <code>ft</code> is discrete.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_add">add</code></td>
<td>
<p>If <code>TRUE</code>, adds to an already existing plot. If <code>FALSE</code>, starts a new plot.
This parameter is not available when <code>plotstyle = "ggplot"</code>.</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_plotstyle">plotstyle</code></td>
<td>
<p><code>"graphics"</code> or <code>"ggplot"</code>. 
If <code>"graphics"</code>, the display is built with <code><a href="graphics.html#topic+graphics">graphics</a></code> functions. 
If <code>"ggplot"</code>, a graphic object output is created with <code>ggplot2</code> functions (the <code>ggplot2</code> package must be installed).</p>
</td></tr>
<tr><td><code id="graphcomp_+3A_...">...</code></td>
<td>
<p>Further graphical arguments passed to graphical functions used in <code>cdfcomp</code>, <code>denscomp</code>, <code>ppcomp</code> 
and <code>qqcomp</code> when <code>plotstyle = "graphics"</code>. 
When <code>plotstyle = "ggplot"</code>, these arguments are only used by the histogram plot (<code><a href="graphics.html#topic+hist">hist</a></code>) in the <code>denscomp</code> function.
When <code>plotstyle = "ggplot"</code>, the graphical output can be customized with relevant <code>ggplot2</code> functions after 
you store your output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cdfcomp</code> provides a plot of the empirical distribution and each fitted 
distribution in cdf, by default using the Hazen's rule
for the empirical distribution, with probability points defined as 
<code>(1:n - 0.5)/n</code>. If <code>discrete</code> is <code>TRUE</code>, probability points 
are always defined as <code>(1:n)/n</code>. For large dataset (<code>n &gt; 1e4</code>), no 
point is drawn but the line for <code>ecdf</code> is drawn instead.
Note that when <code>horizontals, verticals and do.points</code> are <code>FALSE</code>,
no empirical point is drawn, only the fitted cdf is shown.
</p>
<p><code>denscomp</code> provides a density plot of each fitted distribution
with the histogram of the data for conyinuous data. 
When <code>discrete=TRUE</code>, distributions are considered as discrete,
no histogram is plotted but <code>demp</code> is forced to <code>TRUE</code>
and fitted and empirical probabilities are plotted either with vertical lines
<code>fittype="l"</code>, with single points <code>fittype="p"</code> or
both lines and points <code>fittype="o"</code>.
</p>
<p><code>ppcomp</code> provides a plot of the probabilities of each fitted distribution
(<code class="reqn">x</code>-axis) against the empirical probabilities (<code class="reqn">y</code>-axis) by default defined as 
<code>(1:n - 0.5)/n</code> (data are assumed continuous). 
For large dataset (<code>n &gt; 1e4</code>), lines are drawn instead of pointss and customized with the <code>fitpch</code> parameter.
</p>
<p><code>qqcomp</code> provides a plot of the quantiles of each theoretical distribution (<code class="reqn">x</code>-axis)
against the empirical quantiles of the data (<code class="reqn">y</code>-axis), by default defining
probability points as <code>(1:n - 0.5)/n</code> for theoretical quantile calculation 
(data are assumed continuous). 
For large dataset (<code>n &gt; 1e4</code>), lines are drawn instead of points and customized with the <code>fitpch</code> parameter.
</p>
<p>By default a legend is added to these plots. Many graphical arguments are optional, 
dedicated to personalize the plots, and fixed to default values if omitted.
</p>


<h3>Value</h3>

 
<p><code>*comp</code> returns a list of drawn points and/or lines when <code>plotstyle == "graphics"</code>
or an object of class <code>"ggplot"</code> when <code>plotstyle == "ggplot"</code>.
</p>


<h3>Author(s)</h3>

 
<p>Christophe Dutang, Marie-Laure Delignette-Muller and Aurelie Siberchicot.
</p>


<h3>References</h3>

<p>Delignette-Muller ML and Dutang C (2015), 
<em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p>See <code><a href="base.html#topic+plot">plot</a></code>, <code><a href="graphics.html#topic+legend">legend</a></code>, <code><a href="stats.html#topic+ppoints">ppoints</a></code>, 
<code><a href="stats.html#topic+plot.stepfun">plot.stepfun</a></code> for classic plotting functions.
See <code><a href="#topic+CIcdfplot">CIcdfplot</a></code> and <code><a href="#topic+plotdist">plotdist</a></code> for other plot functions
of fitdistrplus.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) Plot various distributions fitted to serving size data
#
data(groundbeef)
serving &lt;- groundbeef$serving
fitW &lt;- fitdist(serving, "weibull")
fitln &lt;- fitdist(serving, "lnorm")
fitg &lt;- fitdist(serving, "gamma")

cdfcomp(list(fitW, fitln, fitg), horizontals = FALSE)
cdfcomp(list(fitW, fitln, fitg), horizontals = TRUE)
cdfcomp(list(fitW, fitln, fitg), horizontals = TRUE, verticals = TRUE, datacol = "purple")
cdfcomp(list(fitW, fitln, fitg), legendtext = c("Weibull", "lognormal", "gamma"),
  main = "ground beef fits", xlab = "serving sizes (g)",
  ylab = "F", xlim = c(0, 250), xlegend = "center", lines01 = TRUE)
denscomp(list(fitW, fitln, fitg), legendtext = c("Weibull", "lognormal", "gamma"),
  main = "ground beef fits", xlab = "serving sizes (g)", xlim = c(0, 250), xlegend = "topright")
ppcomp(list(fitW, fitln, fitg), legendtext = c("Weibull", "lognormal", "gamma"),
  main = "ground beef fits", xlegend = "bottomright", line01 = TRUE)
qqcomp(list(fitW, fitln, fitg), legendtext = c("Weibull", "lognormal", "gamma"),
  main = "ground beef fits", xlegend = "bottomright", line01 = TRUE,
  xlim = c(0, 300), ylim = c(0, 300), fitpch = 16)


# (2) Plot lognormal distributions fitted by 
# maximum goodness-of-fit estimation
# using various distances (data plotted in log scale)
#
data(endosulfan)
ATV &lt;- subset(endosulfan, group == "NonArthroInvert")$ATV
taxaATV &lt;- subset(endosulfan, group == "NonArthroInvert")$taxa
flnMGEKS &lt;- fitdist(ATV, "lnorm", method = "mge", gof = "KS")
flnMGEAD &lt;- fitdist(ATV, "lnorm", method = "mge", gof = "AD")
flnMGEADL &lt;- fitdist(ATV, "lnorm", method = "mge", gof = "ADL")
flnMGEAD2L &lt;- fitdist(ATV, "lnorm", method = "mge", gof = "AD2L")

cdfcomp(list(flnMGEKS, flnMGEAD, flnMGEADL, flnMGEAD2L),
  xlogscale = TRUE, main = "fits of a lognormal dist. using various GOF dist.",
  legendtext = c("MGE KS", "MGE AD", "MGE ADL", "MGE AD2L"),
  verticals = TRUE, xlim = c(1, 100000), name.points=taxaATV)
qqcomp(list(flnMGEKS, flnMGEAD, flnMGEADL, flnMGEAD2L),
  main = "fits of a lognormal dist. using various GOF dist.",
  legendtext = c("MGE KS", "MGE AD", "MGE ADL", "MGE AD2L"),
  xlogscale = TRUE, ylogscale = TRUE)
ppcomp(list(flnMGEKS, flnMGEAD, flnMGEADL, flnMGEAD2L),
  main = "fits of a lognormal dist. using various GOF dist.",
  legendtext = c("MGE KS", "MGE AD", "MGE ADL", "MGE AD2L"))


# (3) Plot normal and logistic distributions fitted by 
# maximum likelihood estimation
# using various plotting positions in cdf plots
#
data(endosulfan)
log10ATV &lt;-log10(subset(endosulfan, group == "NonArthroInvert")$ATV)
fln &lt;- fitdist(log10ATV, "norm")
fll &lt;- fitdist(log10ATV, "logis")

# default plot using Hazen plotting position: (1:n - 0.5)/n
cdfcomp(list(fln, fll), legendtext = c("normal", "logistic"), xlab = "log10ATV")

# plot using mean plotting position (named also Gumbel plotting position)
# (1:n)/(n + 1)
cdfcomp(list(fln, fll),legendtext = c("normal", "logistic"), xlab = "log10ATV",
  use.ppoints = TRUE, a.ppoints = 0)
    
# plot using basic plotting position: (1:n)/n
cdfcomp(list(fln, fll),legendtext = c("normal", "logistic"), xlab = "log10ATV",
  use.ppoints = FALSE)


# (4) Comparison of fits of two distributions fitted to discrete data
#
data(toxocara)
number &lt;- toxocara$number
fitp &lt;- fitdist(number, "pois")
fitnb &lt;- fitdist(number, "nbinom")
cdfcomp(list(fitp, fitnb), legendtext = c("Poisson", "negative binomial"))
denscomp(list(fitp, fitnb),demp = TRUE, legendtext = c("Poisson", "negative binomial"))
denscomp(list(fitp, fitnb),demp = TRUE, fittype = "l", dempcol = "black",
  legendtext = c("Poisson", "negative binomial"))
denscomp(list(fitp, fitnb),demp = TRUE, fittype = "p", dempcol = "black",
  legendtext = c("Poisson", "negative binomial"))
denscomp(list(fitp, fitnb),demp = TRUE, fittype = "o", dempcol = "black",
  legendtext = c("Poisson", "negative binomial"))


# (5) Customizing of graphical output and use of ggplot2
#
data(groundbeef)
serving &lt;- groundbeef$serving
fitW &lt;- fitdist(serving, "weibull")
fitln &lt;- fitdist(serving, "lnorm")
fitg &lt;- fitdist(serving, "gamma")
if (requireNamespace ("ggplot2", quietly = TRUE)) {
  denscomp(list(fitW, fitln, fitg), plotstyle = "ggplot")
  cdfcomp(list(fitW, fitln, fitg), plotstyle = "ggplot")
  qqcomp(list(fitW, fitln, fitg), plotstyle = "ggplot")
  ppcomp(list(fitW, fitln, fitg), plotstyle = "ggplot")
}

# customizing graphical output with graphics
denscomp(list(fitW, fitln, fitg), legendtext = c("Weibull", "lognormal", "gamma"),
  main = "ground beef fits", xlab = "serving sizes (g)", xlim = c(0, 250),
  xlegend = "topright", addlegend = FALSE)

# customizing graphical output with ggplot2
if (requireNamespace ("ggplot2", quietly = TRUE)) {
  dcomp &lt;- denscomp(list(fitW, fitln, fitg), legendtext = c("Weibull", "lognormal", "gamma"),
    xlab = "serving sizes (g)", xlim = c(0, 250),
    xlegend = "topright", plotstyle = "ggplot", breaks = 20, addlegend = FALSE)
  dcomp + ggplot2::theme_minimal() + ggplot2::ggtitle("Ground beef fits")
}

</code></pre>

<hr>
<h2 id='graphcompcens'>Graphical comparison of multiple fitted distributions for censored data</h2><span id='topic+graphcompcens'></span><span id='topic+cdfcompcens'></span><span id='topic+denscompcens'></span><span id='topic+qqcompcens'></span><span id='topic+ppcompcens'></span>

<h3>Description</h3>

   
<p><code>cdfcompcens</code> plots the empirical cumulative distribution against fitted distribution functions,
<code>qqcompcens</code> plots theoretical quantiles against empirical ones,
<code>ppcompcens</code> plots theoretical probabilities against empirical ones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfcompcens(ft, xlim, ylim, xlogscale = FALSE, ylogscale = FALSE, main, xlab, ylab, 
    datacol, fillrect, fitlty, fitcol, fitlwd, addlegend = TRUE, legendtext, 
    xlegend = "bottomright", ylegend = NULL, lines01 = FALSE, 
    Turnbull.confint = FALSE, 
    NPMLE.method = "Wang", 
    add = FALSE, plotstyle = "graphics", ...)
qqcompcens(ft, xlim, ylim, xlogscale = FALSE, ylogscale = FALSE, main, xlab, ylab,
      fillrect, fitcol, fitlwd, addlegend = TRUE, legendtext, xlegend = "bottomright", 
      ylegend = NULL, line01 = TRUE, line01col = "black", line01lty = 1, 
      ynoise = TRUE, NPMLE.method = "Wang", plotstyle = "graphics", ...)
ppcompcens(ft, xlim, ylim, xlogscale = FALSE, ylogscale = FALSE, main, xlab, ylab, 
      fillrect, fitcol, fitlwd, addlegend = TRUE, legendtext, xlegend = "bottomright", 
      ylegend = NULL, line01 = TRUE, line01col = "black", line01lty = 1, 
      ynoise = TRUE, NPMLE.method = "Wang", plotstyle = "graphics", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="graphcompcens_+3A_ft">ft</code></td>
<td>
<p>One <code>"fitdistcens"</code> object or a list of objects of class <code>"fitdistcens"</code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_xlim">xlim</code></td>
<td>
<p>The <code class="reqn">x</code>-limits of the plot.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_ylim">ylim</code></td>
<td>
<p>The <code class="reqn">y</code>-limits of the plot.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_xlogscale">xlogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_ylogscale">ylogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <code class="reqn">y</code>-axis.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_main">main</code></td>
<td>
<p>A main title for the plot, see also <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">x</code>-axis, defaults to a description of <code>x</code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">y</code>-axis, defaults to a description of <code>y</code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_datacol">datacol</code></td>
<td>
<p>A specification of the color to be used in plotting data points.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_fillrect">fillrect</code></td>
<td>
<p>A specification of the color to be used for filling rectanges
of non uniqueness of the empirical cumulative distribution 
(only used if <code>NPMLE.method</code> is equal to <code>"Wang"</code> in <code>cdfcompcens</code>).
Fix it to <code>NA</code> if you do not want to fill the rectangles.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_fitcol">fitcol</code></td>
<td>
<p>A (vector of) color(s) to plot fitted distributions. 
If there are fewer colors than fits they are recycled in the standard fashion.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_fitlty">fitlty</code></td>
<td>
<p>A (vector of) line type(s) to plot fitted distributions. 
If there are fewer values than fits they are recycled in the standard fashion.
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_fitlwd">fitlwd</code></td>
<td>
<p>A (vector of) line size(s) to plot fitted distributions. 
If there are fewer values than fits they are recycled in the standard fashion.
See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_addlegend">addlegend</code></td>
<td>
<p>If <code>TRUE</code>, a legend is added to the plot.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_legendtext">legendtext</code></td>
<td>
<p>A character or expression vector of length <code class="reqn">\geq 1</code> to appear
in the legend, see also <code><a href="graphics.html#topic+legend">legend</a></code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_xlegend">xlegend</code>, <code id="graphcompcens_+3A_ylegend">ylegend</code></td>
<td>
<p>The <code class="reqn">x</code> and <code class="reqn">y</code> coordinates to be used to position the legend.
They can be specified by keyword.
If <code>plotstyle = "graphics"</code>, see <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code> and <code><a href="graphics.html#topic+legend">legend</a></code>.
If <code>plotstyle = "ggplot"</code>, the <code>xlegend</code> keyword must be one of <code>top</code>, <code>bottom</code>, 
<code>left</code>, or <code>right</code>. See also <code>guide_legend</code> in <code>ggplot2</code></p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_lines01">lines01</code></td>
<td>
<p>A logical to plot two horizontal lines at <code>h=0</code> and <code>h=1</code>
for <code>cdfcompcens</code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_turnbull.confint">Turnbull.confint</code></td>
<td>
<p> if TRUE confidence intervals will be added to the Turnbull plot.
In that case NPMLE.method is forced to <code>"Turnbull"</code></p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_npmle.method">NPMLE.method</code></td>
<td>
<p>Three NPMLE techniques are provided, <code>"Wang"</code>, the default one,
rewritten from the package npsurv using function constrOptim from the package stats 
for optimisation, <code>"Turnbull.middlepoints"</code>, an older one which is implemented in 
the package survival and <code>"Turnbull.intervals"</code> that uses the same Turnbull algorithm 
from the package survival but associates an interval to each equivalence class instead of the 
middlepoint of this interval  (see details). Only <code>"Wang"</code> and
<code>"Turnbull.intervals"</code> enable the derivation of a Q-Q plot and a P-P plot.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_add">add</code></td>
<td>
<p>If <code>TRUE</code>, adds to an already existing plot. If <code>FALSE</code>, starts a new plot.
This parameter is not available when <code>plotstyle = "ggplot"</code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_line01">line01</code></td>
<td>
<p>A logical to plot an horizontal line <code class="reqn">y=x</code> for 
<code>qqcompcens</code> and <code>ppcompcens</code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_line01col">line01col</code>, <code id="graphcompcens_+3A_line01lty">line01lty</code></td>
<td>
<p>Color and line type for <code>line01</code>. See also <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_ynoise">ynoise</code></td>
<td>
<p>A logical to add a small noise when plotting empirical 
quantiles/probabilities for <code>qqcompcens</code> and <code>ppcompcens</code>. <code>ynoise</code> is only 
used when various
fits are plotted with the <code>"graphics"</code> <code>plotstyle</code>. 
Facets are used instead with the <code>"ggplot"</code> <code>plotstyle</code>.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_plotstyle">plotstyle</code></td>
<td>
<p><code>"graphics"</code> or <code>"ggplot"</code>. 
If <code>"graphics"</code>, the display is built with <code><a href="graphics.html#topic+graphics">graphics</a></code> functions. 
If <code>"ggplot"</code>, a graphic object output is created with <code>ggplot2</code> functions (the <code>ggplot2</code> package must be installed).
In <code>"cdfcompcens"</code>, <code>"ggplot"</code> graphics are only available with <code>"Wang"</code> NPMLE technique.</p>
</td></tr>
<tr><td><code id="graphcompcens_+3A_...">...</code></td>
<td>
<p>Further graphical arguments passed to graphical functions used in <code>cdfcompcens</code>, <code>ppcompcens</code> 
and <code>qqcompcens</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See details of <code><a href="#topic+plotdistcens">plotdistcens</a></code> for a detailed description of provided goddness-of-fit plots.
</p>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Turnbull BW (1974), <em>Nonparametric estimation of a survivorship function with doubly
censored data</em>.
Journal of American Statistical Association, 69, 169-173.
</p>
<p>Wang Y (2008), <em>Dimension-reduced nonparametric maximum likelihood computation
for interval-censored data</em>. Computational Statistics &amp; Data Analysis, 52, 2388-2402.
</p>
<p>Wang Y and Taylor SM (2013), <em>Efficient computation of nonparametric survival
functions via a hierarchical mixture formulation</em>. Statistics and Computing, 23, 713-725.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+plotdistcens">plotdistcens</a></code>, <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>, <code><a href="graphics.html#topic+legend">legend</a></code> and <code><a href="graphics.html#topic+par">par</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) Plot various distributions fitted to bacterial contamination data
#
data(smokedfish)
Clog10 &lt;- log10(smokedfish)

fitsfn &lt;- fitdistcens(Clog10,"norm")
summary(fitsfn)

fitsfl &lt;- fitdistcens(Clog10,"logis")
summary(fitsfl)

dgumbel &lt;- function(x,a,b) 1/b*exp((a-x)/b)*exp(-exp((a-x)/b))
pgumbel &lt;- function(q,a,b) exp(-exp((a-q)/b))
qgumbel &lt;- function(p,a,b) a-b*log(-log(p))
fitsfg&lt;-fitdistcens(Clog10,"gumbel",start=list(a=-3,b=3))
summary(fitsfg)

# CDF plot
cdfcompcens(list(fitsfn,fitsfl,fitsfg))
cdfcompcens(list(fitsfn,fitsfl,fitsfg),datacol="orange",fillrect = NA, 
  legendtext=c("normal","logistic","Gumbel"),
  main="bacterial contamination fits",
  xlab="bacterial concentration (CFU/g)",ylab="F",
  xlegend = "bottom",lines01 = TRUE)
# alternative Turnbull plot for the empirical cumulative distribution
# (default plot of the previous versions of the package)
cdfcompcens(list(fitsfn,fitsfl,fitsfg), NPMLE.method = "Turnbull.middlepoints")

# customizing graphical output with ggplot2
if (requireNamespace ("ggplot2", quietly = TRUE)) {
  cdfcompcens &lt;- cdfcompcens(list(fitsfn,fitsfl,fitsfg),datacol="orange",fillrect = NA, 
    legendtext=c("normal","logistic","Gumbel"),
    xlab="bacterial concentration (CFU/g)",ylab="F",
    xlegend = "bottom",lines01 = TRUE, plotstyle = "ggplot")
  cdfcompcens + ggplot2::theme_minimal() + ggplot2::ggtitle("Bacterial contamination fits")
}

# PP plot
ppcompcens(list(fitsfn,fitsfl,fitsfg))
ppcompcens(list(fitsfn,fitsfl,fitsfg), ynoise = FALSE)
par(mfrow = c(2,2))
ppcompcens(fitsfn)
ppcompcens(fitsfl)
ppcompcens(fitsfg)
par(mfrow = c(1,1))
if (requireNamespace ("ggplot2", quietly = TRUE)) {
  ppcompcens(list(fitsfn,fitsfl,fitsfg), plotstyle = "ggplot")
  ppcompcens(list(fitsfn,fitsfl,fitsfg), plotstyle = "ggplot", 
    fillrect = c("lightpink", "lightblue", "lightgreen"), 
    fitcol = c("red", "blue", "green"))
}

# QQ plot
qqcompcens(list(fitsfn,fitsfl,fitsfg))
qqcompcens(list(fitsfn,fitsfl,fitsfg), ynoise = FALSE)
par(mfrow = c(2,2))
qqcompcens(fitsfn)
qqcompcens(fitsfl)
qqcompcens(fitsfg)
par(mfrow = c(1,1))

if (requireNamespace ("ggplot2", quietly = TRUE)) {
  qqcompcens(list(fitsfn,fitsfl,fitsfg), ynoise = FALSE, plotstyle = "ggplot")
  qqcompcens(list(fitsfn,fitsfl,fitsfg), ynoise = FALSE, plotstyle = "ggplot", 
    fillrect = c("lightpink", "lightblue", "lightgreen"), 
    fitcol = c("red", "blue", "green"))
}

</code></pre>

<hr>
<h2 id='groundbeef'>Ground beef serving size data set</h2><span id='topic+groundbeef'></span>

<h3>Description</h3>

<p>Serving sizes collected in a French survey, for ground beef patties consumed by children under 5 years old.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(groundbeef)</code></pre>


<h3>Format</h3>

<p><code>groundbeef</code> is a data frame with 1 column (serving: serving sizes in grams)</p>


<h3>Source</h3>

 
<p>Delignette-Muller, M.L., Cornu, M. 2008. Quantitative risk assessment for <em>Escherichia coli</em> O157:H7 in 
frozen ground beef patties consumed by young children in French households. <em>International Journal 
of Food Microbiology</em>, <b>128</b>, 158-164.</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load of data
#
data(groundbeef)

# (2) description and plot of data
#
serving &lt;- groundbeef$serving
descdist(serving)
plotdist(serving)

# (3) fit of a Weibull distribution to data
#
fitW &lt;- fitdist(serving, "weibull")
summary(fitW)
plot(fitW)
gofstat(fitW)
</code></pre>

<hr>
<h2 id='logLikplot'>(Log)likelihood plot for a fit using maximum likelihood</h2><span id='topic+llplot'></span>

<h3>Description</h3>

   
<p><code>llplot</code> plots the (log)likelihood around the estimation for distributions fitted
by maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>llplot(mlefit, loglik = TRUE, expansion = 1, lseq = 50,
                   back.col = TRUE, nlev = 10, pal.col = terrain.colors(100),
                   fit.show = FALSE, fit.pch = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikplot_+3A_mlefit">mlefit</code></td>
<td>
<p>An object of class <code>"<a href="#topic+fitdist">fitdist</a>"</code> of <code>"<a href="#topic+fitdistcens">fitdistcens</a>"</code> obtained by maximum
likelihood (with <code>method = "mle"</code>)</p>
</td></tr>
<tr><td><code id="logLikplot_+3A_loglik">loglik</code></td>
<td>
<p>a logical to plot log-likelihood or likelihood function.</p>
</td></tr>
<tr><td><code id="logLikplot_+3A_expansion">expansion</code></td>
<td>
<p>a expansion factor to enlarge the default range of values explored 
for each parameter.</p>
</td></tr>
<tr><td><code id="logLikplot_+3A_lseq">lseq</code></td>
<td>
<p>length of sequences of parameters.</p>
</td></tr>
<tr><td><code id="logLikplot_+3A_back.col">back.col</code></td>
<td>
<p>logical (for llsurface only). Contours are plotted with a background
gradient of colors if TRUE.</p>
</td></tr>
<tr><td><code id="logLikplot_+3A_nlev">nlev</code></td>
<td>
<p>number of contour levels to plot.</p>
</td></tr>
<tr><td><code id="logLikplot_+3A_pal.col">pal.col</code></td>
<td>
<p>Palette of colors. Colors to be used as back (for llsurface only).</p>
</td></tr>
<tr><td><code id="logLikplot_+3A_fit.show">fit.show</code></td>
<td>
<p>a logical to plot the mle estimate.</p>
</td></tr>
<tr><td><code id="logLikplot_+3A_fit.pch">fit.pch</code></td>
<td>
<p>the type of point used to plot the mle estimate.</p>
</td></tr>
<tr><td><code id="logLikplot_+3A_...">...</code></td>
<td>
<p>Further graphical arguments passed to graphical functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>llplot</code> plots the (log)likelihood surface(s) (or curve if there there is only one 
estimated parameter) around the maximum likelihood estimation. 
It internally calls function <code><a href="#topic+llsurface">llsurface</a></code> 
and <code><a href="#topic+llcurve">llcurve</a></code>. When there is more than two estimated parameters, the
(log)likehood surface is plotted for each combination of two parameters, fixing
the other ones to their estimated value.
For each (log)likelihood surface, when <code>back.col</code> <code><a href="graphics.html#topic+image">image</a></code> 
(2D-plot) is used and when <code>nlev &gt; 0</code> <code><a href="graphics.html#topic+contour">contour</a></code> (2D-plot) is used to add
<code>nlev</code> contours. By default the range of values explored for each estimated
parameter is of 2 standard error around the mle estimate but this range can be expanded
(or contracted) using the argument <code>expansion</code>.
</p>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

<p>Delignette-Muller ML and Dutang C (2015), 
<em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+llsurface">llsurface</a></code> and <code><a href="#topic+llcurve">llcurve</a></code> 
for manual (log)likelihood plots (surface ou curve)
and <code><a href="base.html#topic+plot">plot</a></code>, <code><a href="graphics.html#topic+contour">contour</a></code>,
<code><a href="graphics.html#topic+image">image</a></code> for classic plotting functions.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) a distribution with one parameter
#

x &lt;- rexp(50)
fite &lt;- fitdist(x, "exp")
llplot(fite)
llplot(fite, col = "red", fit.show = TRUE)
llplot(fite, col = "red", fit.show = TRUE, loglik = FALSE)


# (2) a distribution with two parameters
# 

data(groundbeef)
serving &lt;- groundbeef$serving
fitg &lt;- fitdist(serving, "gamma")
llplot(fitg)

llplot(fitg, expansion = 2)
llplot(fitg, pal.col = heat.colors(100), fit.show = TRUE)
llplot(fitg, back.col = FALSE, nlev = 25, fit.show = TRUE)


# (3) a distribution with two parameters with one fixed
# 
fitg2 &lt;- fitdist(serving, "gamma", fix.arg = list(rate = 0.5))
llplot(fitg2, fit.show = TRUE)

# (4) a distribution with three parameters
# 


  data(endosulfan)
  ATV &lt;-endosulfan$ATV
  require("actuar")
  fBurr &lt;- fitdist(ATV, "burr", start = list(shape1 = 0.3, shape2 = 1, rate = 1))
  llplot(fBurr)
  llplot(fBurr, back.col = FALSE, fit.show = TRUE, fit.pch = 16)
  llplot(fBurr, nlev = 0, pal.col = rainbow(100), lseq = 100)


# (5) a distribution with two parameters fitted on censored data
# 
data(salinity)
fsal &lt;- fitdistcens(salinity, "lnorm")
llplot(fsal, fit.show = TRUE)
llplot(fsal, fit.show = TRUE, loglik = FALSE)


</code></pre>

<hr>
<h2 id='logLiksurface'>(Log)likelihood surfaces or (log)likelihood curves</h2><span id='topic+llsurface'></span><span id='topic+llcurve'></span>

<h3>Description</h3>

   
<p><code>llsurface</code> plots the likelihood surface for distributions with two or more parameters,
<code>llcurve</code> plots the likelihood curve for distributions with one or more parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>llsurface(data, distr, plot.arg, min.arg, max.arg,   lseq = 50, fix.arg = NULL,  
    loglik = TRUE, back.col = TRUE, nlev = 10, pal.col = terrain.colors(100), 
    weights = NULL, ...)    

llcurve(data, distr, plot.arg, min.arg, max.arg,   lseq = 50, fix.arg = NULL,  
    loglik = TRUE, weights = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLiksurface_+3A_data">data</code></td>
<td>
<p>A numeric vector for non censored data or a dataframe of two columns respectively named   left and right, describing each observed value as an interval for censored data. In that case the   left column contains either NA for left censored observations, the left bound of the interval for   interval censored observations, or the observed value for non-censored observations. The right      column contains either NA for right censored observations, the right bound of the interval for       interval censored observations, or the observed value for non-censored observations.</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_distr">distr</code></td>
<td>
<p>A character string &quot;name&quot; naming a distribution for which the corresponding density      function dname and the corresponding distribution function pname must be classically defined.</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_plot.arg">plot.arg</code></td>
<td>
<p>a two-element vector with the names of the two parameters that will 
vary for <code>llsurface</code>, only one element for <code>llcurve</code>.</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_min.arg">min.arg</code></td>
<td>
<p>a two-element vector with lower plotting bounds for 
<code>llsurface</code>, only one element for <code>llcurve</code>.</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_max.arg">max.arg</code></td>
<td>
<p>a two-element vector with upper plotting bounds for 
<code>llsurface</code>, only one element for <code>llcurve</code>.</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_lseq">lseq</code></td>
<td>
<p>length of sequences of parameters.</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_fix.arg">fix.arg</code></td>
<td>
<p>a named list with fixed value of other parameters.</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_loglik">loglik</code></td>
<td>
<p>a logical to plot log-likelihood or likelihood function.</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_back.col">back.col</code></td>
<td>
<p>logical (for llsurface only). Contours are plotted with a background
gradient of colors if TRUE.</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_nlev">nlev</code></td>
<td>
<p>number of contour levels to plot (for llsurface only).</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_pal.col">pal.col</code></td>
<td>
<p>Palette of colors. Colors to be used as back (for llsurface only).</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. 
Should be <code>NULL</code> or a numeric vector with strictly positive values 
(classically the number of occurences of each observation).</p>
</td></tr>
<tr><td><code id="logLiksurface_+3A_...">...</code></td>
<td>
<p>Further graphical arguments passed to graphical functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These two function are not intended to be called directly but is internally called in
<code><a href="#topic+llplot">llplot</a></code>. 
</p>
<p><code>llsurface</code> plots the likelihood surface for distributions with two 
varying parameters and other parameters fixed.
When <code>back.col</code>, <code><a href="graphics.html#topic+image">image</a></code> (2D-plot) is used.
When <code>nlev &gt; 0</code>, <code><a href="graphics.html#topic+contour">contour</a></code> (2D-plot) is used to add
<code>nlev</code> contours.
</p>
<p><code>llcurve</code> plots the likelihood curve for distributions with one 
varying parameter and other parameters fixed.
</p>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

<p>Delignette-Muller ML and Dutang C (2015), 
<em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+llplot">llplot</a></code> for an automatic (log)likelihood plots (surface ou curve)
of an object of class <code>"fitdist"</code> or <code>"fitdistcens"</code>
and <code><a href="base.html#topic+plot">plot</a></code>, <code><a href="graphics.html#topic+contour">contour</a></code>,
<code><a href="graphics.html#topic+image">image</a></code> for classic plotting functions.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) loglikelihood or likelihood curve
#

n &lt;- 100
set.seed(1234)
x &lt;- rexp(n)

llcurve(data = x, distr = "exp", plot.arg =  "rate", min.arg = 0, max.arg = 4)

llcurve(data = x, distr = "exp", plot.arg =  "rate", min.arg = 0, max.arg = 4, 
loglik = FALSE)

llcurve(data = x, distr = "exp", plot.arg =  "rate", min.arg = 0, max.arg = 4, 
  main = "log-likelihood for exponential distribution", col = "red")
abline(v = 1, lty = 2)


# (2) loglikelihood surface
# 

x &lt;- rnorm(n, 0, 1)

llsurface(data =x, distr="norm", plot.arg=c("mean", "sd"), 
          min.arg=c(-1, 0.5), max.arg=c(1, 3/2), back.col = FALSE,
          main="log-likelihood for normal distribution")
llsurface(data =x, distr="norm", plot.arg=c("mean", "sd"), 
          min.arg=c(-1, 0.5), max.arg=c(1, 3/2), 
          main="log-likelihood for normal distribution", 
          nlev = 20, pal.col = heat.colors(100),)
points(0, 1, pch="+", col="red")
llsurface(data =x, distr="norm", plot.arg=c("mean", "sd"), 
          min.arg=c(-1, 0.5), max.arg=c(1, 3/2), 
          main="log-likelihood for normal distribution", 
          nlev = 0, back.col = TRUE, pal.col = rainbow(100, s = 0.5, end = 0.8))
points(0, 1, pch="+", col="black")


</code></pre>

<hr>
<h2 id='mgedist'> Maximum goodness-of-fit fit of univariate continuous distributions</h2><span id='topic+mgedist'></span><span id='topic+mge'></span>

<h3>Description</h3>

<p>Fit of univariate continuous distribution by maximizing goodness-of-fit (or minimizing distance) for non censored data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mgedist(data, distr, gof = "CvM", start = NULL, fix.arg = NULL, optim.method = "default", 
  lower = -Inf, upper = Inf, custom.optim = NULL, silent = TRUE, gradient = NULL, 
  checkstartfix=FALSE, calcvcov=FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mgedist_+3A_data">data</code></td>
<td>
<p> A numeric vector for non censored data. </p>
</td></tr>
<tr><td><code id="mgedist_+3A_distr">distr</code></td>
<td>
<p> A character string <code>"name"</code> naming a distribution  for which the corresponding 
quantile function 
<code>qname</code> and the corresponding density distribution <code>dname</code> must be classically defined. </p>
</td></tr>
<tr><td><code id="mgedist_+3A_gof">gof</code></td>
<td>
<p>A character string coding for the name of the goodness-of-fit distance used : 
<code>"CvM"</code> for Cramer-von Mises distance, <code>"KS"</code> for Kolmogorov-Smirnov distance,
<code>"AD"</code> for Anderson-Darling distance, <code>"ADR"</code>, <code>"ADL"</code>, <code>"AD2R"</code>, 
<code>"AD2L"</code> and <code>"AD2"</code> for variants of
Anderson-Darling distance described by Luceno (2006).</p>
</td></tr>  
<tr><td><code id="mgedist_+3A_start">start</code></td>
<td>
<p>A named list giving the initial values of parameters of the named distribution
or a function of data computing initial values and returning a named list.
This argument may be omitted (default) for some distributions for which reasonable 
starting values are computed (see the 'details' section of  <code><a href="#topic+mledist">mledist</a></code>). </p>
</td></tr>
<tr><td><code id="mgedist_+3A_fix.arg">fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of the named distribution
or a function of data computing (fixed) parameter values and returning a named list. 
Parameters with fixed value are thus NOT estimated.</p>
</td></tr>
<tr><td><code id="mgedist_+3A_optim.method">optim.method</code></td>
<td>
 <p><code>"default"</code> or optimization method to pass to <code><a href="stats.html#topic+optim">optim</a></code>.  </p>
</td></tr>
<tr><td><code id="mgedist_+3A_lower">lower</code></td>
<td>
<p> Left bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="mgedist_+3A_upper">upper</code></td>
<td>
<p> Right bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="mgedist_+3A_custom.optim">custom.optim</code></td>
<td>
<p>a function carrying the optimization.</p>
</td></tr>
<tr><td><code id="mgedist_+3A_silent">silent</code></td>
<td>
<p>A logical to remove or show warnings when bootstraping.</p>
</td></tr>    
<tr><td><code id="mgedist_+3A_gradient">gradient</code></td>
<td>
<p>A function to return the gradient of the gof distance for the <code>"BFGS"</code>, <code>"CG"</code> 
and <code>"L-BFGS-B"</code> methods. If it is <code>NULL</code>, a finite-difference approximation will be used.</p>
</td></tr>
<tr><td><code id="mgedist_+3A_checkstartfix">checkstartfix</code></td>
<td>
<p>A logical to test starting and fixed values. Do not change it.</p>
</td></tr>      
<tr><td><code id="mgedist_+3A_calcvcov">calcvcov</code></td>
<td>
<p>A logical indicating if (asymptotic) covariance matrix is required.
(currently ignored)</p>
</td></tr>
<tr><td><code id="mgedist_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+constrOptim">constrOptim</a></code> or <code>custom.optim</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>mgedist</code> function numerically maximizes goodness-of-fit, 
or minimizes a goodness-of-fit distance coded by the argument 
<code>gof</code>. One may use one of the classical distances defined in Stephens (1986), 
the Cramer-von Mises distance (<code>"CvM"</code>), the
Kolmogorov-Smirnov distance (<code>"KS"</code>) or the Anderson-Darling distance (<code>"AD"</code>)
which gives more weight to the tails of the distribution,
or one of the variants of this last distance proposed by Luceno (2006). The right-tail AD (<code>"ADR"</code>)
gives more weight only to the right tail, the left-tail AD (<code>"ADL"</code>)
gives more weight only to the left tail. Either of the tails, or both of them, can receive even larger
weights by using second order Anderson-Darling Statistics (using <code>"AD2R"</code>, <code>"AD2L"</code> or <code>"AD2"</code>).
</p>
<p>The optimization process is the same as <code><a href="#topic+mledist">mledist</a></code>, see the 'details' section 
of that function.
</p>
<p>This function is not intended to be called directly but is internally called in
<code><a href="#topic+fitdist">fitdist</a></code> and <code><a href="#topic+bootdist">bootdist</a></code>.
</p>
<p>This function is intended to be used only with continuous distributions
and weighted maximum goodness-of-fit estimation is not allowed.
</p>
<p>NB: if your data values are particularly small or large, a scaling may be needed 
before the optimization process. See example (4).
</p>


<h3>Value</h3>

 
<p><code>mgedist</code> returns a list with following components,
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of <code><a href="stats.html#topic+optim">optim</a></code> defined as below
or defined by the user in the user-supplied optimization function. 
<code>0</code> indicates successful convergence.
<code>1</code> indicates that the iteration limit of <code><a href="stats.html#topic+optim">optim</a></code> has been reached.
<code>10</code> indicates degeneracy of the Nealder-Mead simplex.
<code>100</code> indicates that <code><a href="stats.html#topic+optim">optim</a></code> encountered an internal error.
</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>the minimal value reached for the criterion to minimize.</p>
</td></tr>    
<tr><td><code>hessian</code></td>
<td>
<p> a symmetric matrix computed by <code><a href="stats.html#topic+optim">optim</a></code> as an estimate of the Hessian
at the solution found or computed in the user-supplied optimization function. </p>
</td></tr>
<tr><td><code>optim.function</code></td>
<td>
<p>the name of the optimization function used for maximum likelihood.</p>
</td></tr>
<tr><td><code>optim.method</code></td>
<td>
<p>when <code><a href="stats.html#topic+optim">optim</a></code> is used, the name of the
algorithm used, the field <code>method</code> of the <code>custom.optim</code> function
otherwise.</p>
</td></tr>
<tr><td><code>fix.arg</code></td>
<td>
<p>the named list giving the values of parameters of the named distribution
that must kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
if there are no such parameters. </p>
</td></tr>
<tr><td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p>A two-element integer vector giving the number of calls 
to the log-likelihood function and its gradient respectively. 
This excludes those calls needed to compute the Hessian, if requested, 
and any calls to log-likelihood function to compute a finite-difference
approximation to the gradient. <code>counts</code> is returned by <code><a href="stats.html#topic+optim">optim</a></code>
or the user-supplied function or set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>optim.message</code></td>
<td>
<p>A character string giving any additional information 
returned by the optimizer, or <code>NULL</code>. To understand exactly the message,
see the source code.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> the log-likelihood value. </p>
</td></tr>
<tr><td><code>gof</code></td>
<td>
<p> the code of the goodness-of-fit distance maximized. </p>
</td></tr>   
</table>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

<p>Luceno A (2006), <em>Fitting the generalized Pareto distribution to data using
maximum goodness-of-fit estimators</em>. Computational Statistics and Data Analysis, 51, 904-917,
<a href="https://doi.org/10.1016/j.csda.2005.09.011">doi:10.1016/j.csda.2005.09.011</a>.
</p>
<p>Stephens MA (1986), <em>Tests based on edf statistics</em>. In Goodness-of-fit techniques (D'Agostino RB and
Stephens MA, eds), Marcel Dekker, New York, pp. 97-194.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, 
<code><a href="#topic+fitdist">fitdist</a></code> for other estimation methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1) Fit of a Weibull distribution to serving size data by maximum 
# goodness-of-fit estimation using all the distances available
# 

data(groundbeef)
serving &lt;- groundbeef$serving
mgedist(serving, "weibull", gof="CvM")
mgedist(serving, "weibull", gof="KS")
mgedist(serving, "weibull", gof="AD")
mgedist(serving, "weibull", gof="ADR")
mgedist(serving, "weibull", gof="ADL")
mgedist(serving, "weibull", gof="AD2R")
mgedist(serving, "weibull", gof="AD2L")
mgedist(serving, "weibull", gof="AD2")


# (2) Fit of a uniform distribution using Cramer-von Mises or
# Kolmogorov-Smirnov distance
# 

set.seed(1234)
u &lt;- runif(100,min=5,max=10)
mgedist(u,"unif",gof="CvM")
mgedist(u,"unif",gof="KS")

# (3) Fit of a triangular distribution using Cramer-von Mises or
# Kolmogorov-Smirnov distance
# 


require("mc2d")
set.seed(1234)
t &lt;- rtriang(100,min=5,mode=6,max=10)
mgedist(t,"triang",start = list(min=4, mode=6,max=9),gof="CvM")
mgedist(t,"triang",start = list(min=4, mode=6,max=9),gof="KS")


# (4) scaling problem
# the simulated dataset (below) has particularly small values, hence without scaling (10^0),
# the optimization raises an error. The for loop shows how scaling by 10^i
# for i=1,...,6 makes the fitting procedure work correctly.

set.seed(1234)
x2 &lt;- rnorm(100, 1e-4, 2e-4)
for(i in 6:0)
    cat(i, try(mgedist(x*10^i,"cauchy")$estimate, silent=TRUE), "\n")

</code></pre>

<hr>
<h2 id='mledist'> Maximum likelihood fit of univariate distributions</h2><span id='topic+mledist'></span><span id='topic+mle'></span>

<h3>Description</h3>

<p>Fit of univariate distributions using maximum likelihood for censored or non censored data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mledist(data, distr, start = NULL, fix.arg = NULL, optim.method = "default", 
    lower = -Inf, upper = Inf, custom.optim = NULL, weights = NULL, silent = TRUE, 
    gradient = NULL, checkstartfix=FALSE, calcvcov=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mledist_+3A_data">data</code></td>
<td>
<p> A numeric vector for non censored data or
a dataframe of two columns respectively named <code>left</code> 
and <code>right</code>, describing each observed value as an interval for censored data.
In that case the <code>left</code> column contains either <code>NA</code> for left censored observations,
the left bound of the interval for interval censored observations,
or the observed value for non-censored observations.
The <code>right</code> column contains either <code>NA</code> for right censored observations,
the right bound of the interval for interval censored observations,
or the observed value for non-censored observations. </p>
</td></tr>
<tr><td><code id="mledist_+3A_distr">distr</code></td>
<td>
<p> A character string <code>"name"</code> naming a distribution 
for which the corresponding density function <code>dname</code> 
and the corresponding distribution function <code>pname</code> must be classically defined. </p>
</td></tr>
<tr><td><code id="mledist_+3A_start">start</code></td>
<td>
<p>A named list giving the initial values of parameters of the named distribution
or a function of data computing initial values and returning a named list.
This argument may be omitted (default) for some distributions for which reasonable 
starting values are computed (see details). </p>
</td></tr>
<tr><td><code id="mledist_+3A_fix.arg">fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of the named distribution
or a function of data computing (fixed) parameter values and returning a named list. 
Parameters with fixed value are thus NOT estimated by this maximum likelihood procedure.</p>
</td></tr>
<tr><td><code id="mledist_+3A_optim.method">optim.method</code></td>
<td>
 <p><code>"default"</code> (see details) or an optimization method 
to pass to <code><a href="stats.html#topic+optim">optim</a></code>.  </p>
</td></tr>
<tr><td><code id="mledist_+3A_lower">lower</code></td>
<td>
<p>Left bounds on the parameters for the <code>"L-BFGS-B"</code> method 
(see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="mledist_+3A_upper">upper</code></td>
<td>
<p> Right bounds on the parameters for the <code>"L-BFGS-B"</code> method 
(see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="mledist_+3A_custom.optim">custom.optim</code></td>
<td>
<p>a function carrying the MLE optimisation (see details).</p>
</td></tr>
<tr><td><code id="mledist_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. 
Should be <code>NULL</code> or a numeric vector with strictly positive integers 
(typically the number of occurences of each observation). If non-<code>NULL</code>, 
weighted MLE is used, otherwise ordinary MLE.</p>
</td></tr>
<tr><td><code id="mledist_+3A_silent">silent</code></td>
<td>
<p>A logical to remove or show warnings when bootstraping.</p>
</td></tr>    
<tr><td><code id="mledist_+3A_gradient">gradient</code></td>
<td>
<p>A function to return the gradient of the log-likelihood for the <code>"BFGS"</code>, <code>"CG"</code> 
and <code>"L-BFGS-B"</code> methods. If it is <code>NULL</code>, a finite-difference approximation will be used,
see details.</p>
</td></tr>
<tr><td><code id="mledist_+3A_checkstartfix">checkstartfix</code></td>
<td>
<p>A logical to test starting and fixed values. Do not change it.</p>
</td></tr>    
<tr><td><code id="mledist_+3A_calcvcov">calcvcov</code></td>
<td>
<p>A logical indicating if (asymptotic) covariance matrix is required.</p>
</td></tr>
<tr><td><code id="mledist_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <code><a href="stats.html#topic+optim">optim</a></code>, 
<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> or <code>custom.optim</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is not intended to be called directly but is internally called in
<code><a href="#topic+fitdist">fitdist</a></code> and <code><a href="#topic+bootdist">bootdist</a></code> when used with the maximum likelihood method
and <code><a href="#topic+fitdistcens">fitdistcens</a></code> and <code><a href="#topic+bootdistcens">bootdistcens</a></code>. 
</p>
<p>It is assumed that the <code>distr</code> argument specifies the distribution by the
probability density function and the cumulative distribution function (d, p).
The quantile function and the random generator function (q, r) may be
needed by other function such as <code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, <code><a href="#topic+mgedist">mgedist</a></code>, 
<code><a href="#topic+fitdist">fitdist</a></code>,<code><a href="#topic+fitdistcens">fitdistcens</a></code>, <code><a href="#topic+bootdistcens">bootdistcens</a></code> and <code><a href="#topic+bootdist">bootdist</a></code>.
</p>
<p>For the following named distributions, reasonable starting values will 
be computed if <code>start</code> is omitted (i.e. <code>NULL</code>) : <code>"norm"</code>, <code>"lnorm"</code>,
<code>"exp"</code> and <code>"pois"</code>, <code>"cauchy"</code>, <code>"gamma"</code>, <code>"logis"</code>,
<code>"nbinom"</code> (parametrized by mu and size), <code>"geom"</code>, <code>"beta"</code>, <code>"weibull"</code>
from the <code>stats</code> package; 
<code>"invgamma"</code>, <code>"llogis"</code>, <code>"invweibull"</code>, <code>"pareto1"</code>, <code>"pareto"</code>,
<code>"lgamma"</code>, <code>"trgamma"</code>, <code>"invtrgamma"</code>
from the <code>actuar</code> package. 
Note that these starting values may not be good enough if the fit is poor. 
The function uses a closed-form formula to fit the uniform distribution.
If <code>start</code> is a list, then it should be a named list with the same names as in
the d,p,q,r functions of the chosen distribution.
If <code>start</code> is a function of data, then the function should return a named list with the same names as in
the d,p,q,r functions of the chosen distribution.
</p>
<p>The <code>mledist</code> function allows user to set a fixed values for some parameters.
As for <code>start</code>, if <code>fix.arg</code> is a list, then it should be a named list with the same names as in
the d,p,q,r functions of the chosen distribution.
If <code>fix.arg</code> is a function of data, then the function should return a named list with the 
same names as in the d,p,q,r functions of the chosen distribution.
</p>
<p>When <code>custom.optim=NULL</code> (the default), maximum likelihood estimations 
of the distribution parameters are computed with the R base <code><a href="stats.html#topic+optim">optim</a></code> or <code><a href="stats.html#topic+constrOptim">constrOptim</a></code>.
If no finite bounds (<code>lower=-Inf</code> and <code>upper=Inf</code>) are supplied,  
<code><a href="stats.html#topic+optim">optim</a></code> is used with the method specified by <code>optim.method</code>.
Note that <code>optim.method="default"</code> means <code>optim.method="Nelder-Mead"</code> for distributions 
with at least two parameters and <code>optim.method="BFGS"</code> for distributions with only one parameter.
If finite bounds are supplied (among <code>lower</code> and <code>upper</code>) and <code>gradient != NULL</code>, 
<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> is used.
If finite bounds are supplied (among <code>lower</code> and <code>upper</code>) and <code>gradient == NULL</code>, 
<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> is used when <code>optim.method="Nelder-Mead"</code>;
<code><a href="stats.html#topic+optim">optim</a></code> is used when <code>optim.method="L-BFGS-B"</code> or <code>"Brent"</code>;
in other case, an error is raised (same behavior as <code><a href="stats.html#topic+constrOptim">constrOptim</a></code>).
</p>
<p>When errors are raised by <code><a href="stats.html#topic+optim">optim</a></code>, it's a good idea to start by adding traces during
the optimization process by adding <code>control=list(trace=1, REPORT=1)</code>.
</p>
<p>If <code>custom.optim</code> is not <code>NULL</code>, then the user-supplied function is used 
instead of the R base <code><a href="stats.html#topic+optim">optim</a></code>. The <code>custom.optim</code> must have (at least) 
the following arguments
<code>fn</code> for the function to be optimized, <code>par</code> for the initialized parameters.
Internally the function to be optimized will also have other arguments, 
such as <code>obs</code> with observations and <code>ddistname</code>
with distribution name for non censored data (Beware of potential conflicts with optional
arguments of <code>custom.optim</code>). It is assumed that <code>custom.optim</code> should carry 
out a MINIMIZATION. 
Finally, it should return at least the following components <code>par</code> for the estimate, 
<code>convergence</code> for the convergence code, <code>value</code> for <code>fn(par)</code>, 
<code>hessian</code>, <code>counts</code> for the number of calls (function and gradient)
and <code>message</code> (default to <code>NULL</code>) for the error message 
when <code>custom.optim</code> raises an error, 
see the returned value of <code><a href="stats.html#topic+optim">optim</a></code>. 
See examples in <code><a href="#topic+fitdist">fitdist</a></code> and <code><a href="#topic+fitdistcens">fitdistcens</a></code>.
</p>
<p>Optionally, a vector of <code>weights</code> can be used in the fitting process. 
By default (when <code>weigths=NULL</code>), ordinary MLE is carried out, otherwise 
the specified weights are used to balance the log-likelihood contributions.
It is not yet possible to take into account weights in functions <code>plotdist</code>, 
<code>plotdistcens</code>, <code>plot.fitdist</code>, <code>plot.fitdistcens</code>, <code>cdfcomp</code>, 
<code>cdfcompcens</code>, <code>denscomp</code>, <code>ppcomp</code>, <code>qqcomp</code>, <code>gofstat</code>, 
<code>descdist</code>, <code>bootdist</code>, <code>bootdistcens</code> and <code>mgedist</code>.
(developments planned in the future).
</p>
<p>NB: if your data values are particularly small or large, a scaling may be needed 
before the optimization process. See Example (7).
</p>


<h3>Value</h3>

 
<p><code>mledist</code> returns a list with following components,
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of 
<code><a href="stats.html#topic+optim">optim</a></code>/<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> defined as below
or defined by the user in the user-supplied optimization function. 
<code>0</code> indicates successful convergence.
<code>1</code> indicates that the iteration limit of <code><a href="stats.html#topic+optim">optim</a></code> has been reached.
<code>10</code> indicates degeneracy of the Nealder-Mead simplex.
<code>100</code> indicates that <code><a href="stats.html#topic+optim">optim</a></code> encountered an internal error.
</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>the minimal value reached for the criterion to minimize.</p>
</td></tr>    
<tr><td><code>hessian</code></td>
<td>
<p>a symmetric matrix computed by <code><a href="stats.html#topic+optim">optim</a></code> as an estimate of the Hessian
at the solution found or computed in the user-supplied optimization function.
It is used in <code>fitdist</code> to estimate standard errors. </p>
</td></tr>
<tr><td><code>optim.function</code></td>
<td>
<p>the name of the optimization function used for maximum likelihood.</p>
</td></tr>
<tr><td><code>optim.method</code></td>
<td>
<p>when <code><a href="stats.html#topic+optim">optim</a></code> is used, the name of the
algorithm used, the field <code>method</code> of the <code>custom.optim</code> function
otherwise.</p>
</td></tr>
<tr><td><code>fix.arg</code></td>
<td>
<p>the named list giving the values of parameters of the named distribution
that must kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
if there are no such parameters. </p>
</td></tr>
<tr><td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p>A two-element integer vector giving the number of calls 
to the log-likelihood function and its gradient respectively. 
This excludes those calls needed to compute the Hessian, if requested, 
and any calls to log-likelihood function to compute a finite-difference
approximation to the gradient. <code>counts</code> is returned by <code><a href="stats.html#topic+optim">optim</a></code>
or the user-supplied function or set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>optim.message</code></td>
<td>
<p>A character string giving any additional information 
returned by the optimizer, or <code>NULL</code>. To understand exactly the message,
see the source code.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the log-likelihood value.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p><code>"closed formula"</code> if appropriate otherwise <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Venables WN and Ripley BD (2002), <em>Modern applied statistics with S</em>.
Springer, New York, pp. 435-446, <a href="https://doi.org/10.1007/978-0-387-21706-2">doi:10.1007/978-0-387-21706-2</a>.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, <code><a href="#topic+mgedist">mgedist</a></code>, 
<code><a href="#topic+fitdist">fitdist</a></code>,<code><a href="#topic+fitdistcens">fitdistcens</a></code> for other estimation methods,
<code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+constrOptim">constrOptim</a></code> for optimization routines,
<code><a href="#topic+bootdistcens">bootdistcens</a></code> and <code><a href="#topic+bootdist">bootdist</a></code> for bootstrap,
and <code><a href="#topic+llplot">llplot</a></code> for plotting the (log)likelihood.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1) basic fit of a normal distribution with maximum likelihood estimation
#

set.seed(1234)
x1 &lt;- rnorm(n=100)
mledist(x1,"norm")

# (2) defining your own distribution functions, here for the Gumbel distribution
# for other distributions, see the CRAN task view dedicated to probability distributions

dgumbel &lt;- function(x,a,b) 1/b*exp((a-x)/b)*exp(-exp((a-x)/b))
mledist(x1,"gumbel",start=list(a=10,b=5))

# (3) fit of a discrete distribution (Poisson)
#

set.seed(1234)
x2 &lt;- rpois(n=30,lambda = 2)
mledist(x2,"pois")

# (4) fit a finite-support distribution (beta)
#

set.seed(1234)
x3 &lt;- rbeta(n=100,shape1=5, shape2=10)
mledist(x3,"beta")


# (5) fit frequency distributions on USArrests dataset.
#

x4 &lt;- USArrests$Assault
mledist(x4, "pois")
mledist(x4, "nbinom")

# (6) fit a continuous distribution (Gumbel) to censored data.
#

data(fluazinam)
log10EC50 &lt;-log10(fluazinam)
# definition of the Gumbel distribution
dgumbel  &lt;-  function(x,a,b) 1/b*exp((a-x)/b)*exp(-exp((a-x)/b))
pgumbel  &lt;-  function(q,a,b) exp(-exp((a-q)/b))
qgumbel  &lt;-  function(p,a,b) a-b*log(-log(p))

mledist(log10EC50,"gumbel",start=list(a=0,b=2),optim.method="Nelder-Mead")

# (7) scaling problem
# the simulated dataset (below) has particularly small values, 
# hence without scaling (10^0),
# the optimization raises an error. The for loop shows how scaling by 10^i
# for i=1,...,6 makes the fitting procedure work correctly.

set.seed(1234)
x2 &lt;- rnorm(100, 1e-4, 2e-4)
for(i in 6:0)
    cat(i, try(mledist(x*10^i, "cauchy")$estimate, silent=TRUE), "\n")
        
 
# (17) small example for the zero-modified geometric distribution
#

dzmgeom &lt;- function(x, p1, p2) p1 * (x == 0) + (1-p1)*dgeom(x-1, p2) #pdf
x2 &lt;- c(2,  4,  0, 40,  4, 21,  0,  0,  0,  2,  5,  0,  0, 13,  2) #simulated dataset
initp1 &lt;- function(x) list(p1=mean(x == 0)) #init as MLE
mledist(x2, "zmgeom", fix.arg=initp1, start=list(p2=1/2))
</code></pre>

<hr>
<h2 id='mmedist'> Matching moment fit of univariate distributions</h2><span id='topic+mmedist'></span><span id='topic+mme'></span>

<h3>Description</h3>

<p>Fit of univariate distributions by matching moments (raw or centered) for non censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmedist(data, distr, order, memp, start = NULL, fix.arg = NULL, optim.method = "default", 
  lower = -Inf, upper = Inf, custom.optim = NULL, weights = NULL, silent = TRUE, 
  gradient = NULL, checkstartfix=FALSE, calcvcov=FALSE, ...) 

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mmedist_+3A_data">data</code></td>
<td>
<p>A numeric vector for non censored data.</p>
</td></tr>
<tr><td><code id="mmedist_+3A_distr">distr</code></td>
<td>
<p>A character string <code>"name"</code> naming a distribution (see 'details').</p>
</td></tr>
<tr><td><code id="mmedist_+3A_order">order</code></td>
<td>
<p>A numeric vector for the moment order(s). The length of this vector must be equal
to the number of parameters to estimate.</p>
</td></tr>
<tr><td><code id="mmedist_+3A_memp">memp</code></td>
<td>
<p>A function implementing empirical moments, raw or centered but has to be consistent with 
<code>distr</code> argument (and <code>weights</code> argument). 
See details below.
</p>
</td></tr>
<tr><td><code id="mmedist_+3A_start">start</code></td>
<td>
<p>A named list giving the initial values of parameters of the named distribution
or a function of data computing initial values and returning a named list.
This argument may be omitted (default) for some distributions for which reasonable 
starting values are computed (see the 'details' section of  <code><a href="#topic+mledist">mledist</a></code>). </p>
</td></tr>
<tr><td><code id="mmedist_+3A_fix.arg">fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of the named distribution
or a function of data computing (fixed) parameter values and returning a named list. 
Parameters with fixed value are thus NOT estimated.</p>
</td></tr>
<tr><td><code id="mmedist_+3A_optim.method">optim.method</code></td>
<td>
 <p><code>"default"</code> or optimization method to pass to <code><a href="stats.html#topic+optim">optim</a></code>.  </p>
</td></tr>
<tr><td><code id="mmedist_+3A_lower">lower</code></td>
<td>
<p> Left bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="mmedist_+3A_upper">upper</code></td>
<td>
<p> Right bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="mmedist_+3A_custom.optim">custom.optim</code></td>
<td>
<p>a function carrying the optimization .</p>
</td></tr>
<tr><td><code id="mmedist_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. 
Should be <code>NULL</code> or a numeric vector with strictly positive integers 
(typically the number of occurences of each observation). If non-<code>NULL</code>, 
weighted MME is used, otherwise ordinary MME.</p>
</td></tr>
<tr><td><code id="mmedist_+3A_silent">silent</code></td>
<td>
<p>A logical to remove or show warnings when bootstraping.</p>
</td></tr>        
<tr><td><code id="mmedist_+3A_gradient">gradient</code></td>
<td>
<p>A function to return the gradient of the squared difference for the <code>"BFGS"</code>, <code>"CG"</code> 
and <code>"L-BFGS-B"</code> methods. If it is <code>NULL</code>, a finite-difference approximation will be used,
see details.</p>
</td></tr>
<tr><td><code id="mmedist_+3A_checkstartfix">checkstartfix</code></td>
<td>
<p>A logical to test starting and fixed values. Do not change it.</p>
</td></tr>   
<tr><td><code id="mmedist_+3A_calcvcov">calcvcov</code></td>
<td>
<p>A logical indicating if (asymptotic) covariance matrix is required.</p>
</td></tr>
<tr><td><code id="mmedist_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <code><a href="stats.html#topic+optim">optim</a></code>, 
<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> or <code>custom.optim</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>The argument <code>distr</code> can be one of the base R distributions: <code>"norm"</code>, <code>"lnorm"</code>,
<code>"exp"</code> and <code>"pois"</code>, <code>"gamma"</code>, <code>"logis"</code>,
<code>"nbinom"</code> , <code>"geom"</code>, <code>"beta"</code> and <code>"unif"</code>.
In that case, no other arguments than <code>data</code> and <code>distr</code> are
required, because the estimate is computed by a closed-form formula.
For distributions characterized by one parameter (<code>"geom"</code>, <code>"pois"</code> and <code>"exp"</code>),
this parameter is simply estimated by matching theoretical and observed means, and for distributions 
characterized by two parameters, these parameters are estimated by matching theoretical and observed 
means and variances (Vose, 2000).
Note that for these closed-form formula, <code>fix.arg</code> cannot be used and <code>start</code> is ignored.
</p>
<p>The argument <code>distr</code> can also be the distribution name
as long as a corresponding <code>mdistr</code> function exists, e.g. <code>"pareto"</code> if <code>"mpareto"</code> exists.
In that case arguments arguments <code>order</code> and <code>memp</code> 
have to be supplied in order to carry out the matching numerically, by minimization of the
sum of squared differences between observed and theoretical moments. 
Optionnally other arguments can be supplied to control optimization (see the 'details' section of 
<code><a href="#topic+mledist">mledist</a></code> for details about arguments for the control of optimization). 
In that case, <code>fix.arg</code> can be used and <code>start</code> is taken into account.
</p>
<p>For non closed-form estimators, <code>memp</code> must be provided to compute empirical moments.
When <code>weights=NULL</code>, this function must have two arguments <code>x, order</code>: 
<code>x</code> the numeric vector of the data and <code>order</code> the order of the moment.
When <code>weights!=NULL</code>, this function must have three arguments <code>x, order, weights</code>: 
<code>x</code> the numeric vector of the data, <code>order</code> the order of the moment,
<code>weights</code> the numeric vector of weights. See examples below.
</p>
<p>Optionally, a vector of <code>weights</code> can be used in the fitting process. 
By default (when <code>weigths=NULL</code>), ordinary MME is carried out, otherwise 
the specified weights are used to compute (raw or centered) weighted moments.
For closed-form estimators, weighted mean and variance are computed by 
<code><a href="Hmisc.html#topic+wtd.stats">wtdmean</a></code> and <code><a href="Hmisc.html#topic+wtd.stats">wtdvar</a></code>
from the <code>Hmisc</code> package. When a numerical minimization
is used, weighted are expected to be computed by the <code>memp</code> function.
It is not yet possible to take into account weighths in functions <code>plotdist</code>, 
<code>plotdistcens</code>, <code>plot.fitdist</code>, <code>plot.fitdistcens</code>, <code>cdfcomp</code>, 
<code>cdfcompcens</code>, <code>denscomp</code>, <code>ppcomp</code>, <code>qqcomp</code>, <code>gofstat</code> 
and <code>descdist</code>
(developments planned in the future).
</p>
<p>This function is not intended to be called directly but is internally called in
<code><a href="#topic+fitdist">fitdist</a></code> and <code><a href="#topic+bootdist">bootdist</a></code> when used with the matching moments method. 
</p>
<p>Since Version 1.2-0, <code>mmedist</code> automatically computes the asymptotic covariance matrix
using I. Ibragimov and R. Has'minskii (1981), hence the theoretical moments <code>mdist</code> 
should be defined up to an order which equals to twice the maximal order given <code>order</code>.
For instance, the normal distribution, we fit against the expectation and the variance
and we need to have <code>mnorm</code> up to order <code class="reqn">2\times2=4</code>.
</p>


<h3>Value</h3>

 
<p><code>mmedist</code> returns a list with following components,
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of <code><a href="stats.html#topic+optim">optim</a></code> defined as below
or defined by the user in the user-supplied optimization function. 
<code>0</code> indicates successful convergence.
<code>1</code> indicates that the iteration limit of <code><a href="stats.html#topic+optim">optim</a></code> has been reached.
<code>10</code> indicates degeneracy of the Nealder-Mead simplex.
<code>100</code> indicates that <code><a href="stats.html#topic+optim">optim</a></code> encountered an internal error.
</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>the minimal value reached for the criterion to minimize.</p>
</td></tr>    
<tr><td><code>hessian</code></td>
<td>
<p> a symmetric matrix computed by <code><a href="stats.html#topic+optim">optim</a></code> as an estimate of the Hessian
at the solution found or computed in the user-supplied optimization function. </p>
</td></tr>
<tr><td><code>optim.function</code></td>
<td>
<p>(if appropriate) the name of the optimization function used for maximum likelihood.</p>
</td></tr>
<tr><td><code>optim.method</code></td>
<td>
<p>(if appropriate) when <code><a href="stats.html#topic+optim">optim</a></code> is used, the name of the
algorithm used, the field <code>method</code> of the <code>custom.optim</code> function
otherwise.</p>
</td></tr>
<tr><td><code>fix.arg</code></td>
<td>
<p>the named list giving the values of parameters of the named distribution
that must kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
if there are no such parameters. </p>
</td></tr>
<tr><td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p>A two-element integer vector giving the number of calls 
to the log-likelihood function and its gradient respectively. 
This excludes those calls needed to compute the Hessian, if requested, 
and any calls to log-likelihood function to compute a finite-difference
approximation to the gradient. <code>counts</code> is returned by <code><a href="stats.html#topic+optim">optim</a></code>
or the user-supplied function or set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>optim.message</code></td>
<td>
<p>A character string giving any additional information 
returned by the optimizer, or <code>NULL</code>. To understand exactly the message,
see the source code.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> the log-likelihood value. </p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>either <code>"closed formula"</code> or the name of the optimization method.</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p> the order of the moment(s) matched.</p>
</td></tr>        
<tr><td><code>memp</code></td>
<td>
<p> the empirical moment function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>I. Ibragimov and R. Has'minskii (1981), 
<em>Statistical Estimation - Asymptotic Theory</em>, Springer-Verlag, 
<a href="https://doi.org/10.1007/978-1-4899-0027-2">doi:10.1007/978-1-4899-0027-2</a>
</p>
<p>Evans M, Hastings N and Peacock B (2000), <em>Statistical distributions</em>. John Wiley and Sons Inc,
<a href="https://doi.org/10.1002/9780470627242">doi:10.1002/9780470627242</a>.
</p>
<p>Vose D (2000), <em>Risk analysis, a quantitative guide</em>.
John Wiley &amp; Sons Ltd, Chischester, England, pp. 99-143.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, <code><a href="#topic+mgedist">mgedist</a></code>, 
<code><a href="#topic+fitdist">fitdist</a></code>,<code><a href="#topic+fitdistcens">fitdistcens</a></code>, 
<code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="#topic+bootdistcens">bootdistcens</a></code> and <code><a href="#topic+bootdist">bootdist</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1) basic fit of a normal distribution with moment matching estimation
#

set.seed(1234)
n &lt;- 100
x1 &lt;- rnorm(n=n)
mmedist(x1, "norm")

#weighted
w &lt;- c(rep(1, n/2), rep(10, n/2))
mmedist(x1, "norm", weights=w)$estimate


# (2) fit a discrete distribution (Poisson)
#

set.seed(1234)
x2 &lt;- rpois(n=30,lambda = 2)
mmedist(x2, "pois")

# (3) fit a finite-support distribution (beta)
#

set.seed(1234)
x3 &lt;- rbeta(n=100,shape1=5, shape2=10)
mmedist(x3, "beta")


# (4) fit a Pareto distribution
#


  require("actuar")
  #simulate a sample
  x4  &lt;-  rpareto(1000, 6, 2)

  #empirical raw moment
  memp  &lt;-  function(x, order) mean(x^order)
  memp2 &lt;- function(x, order, weights) sum(x^order * weights)/sum(weights)

  #fit by MME
  mmedist(x4, "pareto", order=c(1, 2), memp=memp, 
    start=list(shape=10, scale=10), lower=1, upper=Inf)
  #fit by weighted MME
  w &lt;- rep(1, length(x4))
  w[x4 &lt; 1] &lt;- 2
  mmedist(x4, "pareto", order=c(1, 2), memp=memp2, weights=w,
    start=list(shape=10, scale=10), lower=1, upper=Inf)

</code></pre>

<hr>
<h2 id='msedist'>Maximum spacing estimation of univariate distributions</h2><span id='topic+msedist'></span><span id='topic+mse'></span>

<h3>Description</h3>

<p>Fit of univariate distribution by maximizing (log) spacings for non censored data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msedist(data, distr, phidiv="KL", power.phidiv=NULL, start = NULL, fix.arg = NULL, 
  optim.method = "default", lower = -Inf, upper = Inf, custom.optim = NULL, 
  weights=NULL, silent = TRUE, gradient = NULL, checkstartfix=FALSE, calcvcov=FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msedist_+3A_data">data</code></td>
<td>
<p> A numeric vector for non censored data. </p>
</td></tr>
<tr><td><code id="msedist_+3A_distr">distr</code></td>
<td>
<p> A character string <code>"name"</code> naming a distribution  for which the corresponding 
quantile function 
<code>qname</code> and the corresponding density distribution <code>dname</code> must be classically defined. </p>
</td></tr>
<tr><td><code id="msedist_+3A_phidiv">phidiv</code></td>
<td>
<p>A character string coding for the name of the phi-divergence used : 
<code>"KL"</code> for Kullback-Leibler information (corresponds to classic maximum spacing estimation),
<code>"J"</code> for Jeffreys' divergence, <code>"R"</code> for Renyi's divergence,
<code>"H"</code> for Hellinger distance, <code>"V"</code> for Vajda's measure of information, see details.</p>
</td></tr>  
<tr><td><code id="msedist_+3A_power.phidiv">power.phidiv</code></td>
<td>
<p>If relevant, a numeric for the power used in some phi-divergence : 
should be <code>NULL</code> when <code>phidiv="KL"</code> or <code>phidiv="J"</code> ,
should be positive and different from 1 when <code>phidiv="R"</code>,
should be greater or equal to 1 when <code>phidiv="H"</code> or <code>phidiv="V"</code>, see details.</p>
</td></tr>    
<tr><td><code id="msedist_+3A_start">start</code></td>
<td>
<p>A named list giving the initial values of parameters of the named distribution
or a function of data computing initial values and returning a named list.
This argument may be omitted (default) for some distributions for which reasonable 
starting values are computed (see the 'details' section of  <code><a href="#topic+mledist">mledist</a></code>). </p>
</td></tr>
<tr><td><code id="msedist_+3A_fix.arg">fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of the named distribution
or a function of data computing (fixed) parameter values and returning a named list. 
Parameters with fixed value are thus NOT estimated.</p>
</td></tr>
<tr><td><code id="msedist_+3A_optim.method">optim.method</code></td>
<td>
 <p><code>"default"</code> or optimization method to pass to <code><a href="stats.html#topic+optim">optim</a></code>.  </p>
</td></tr>
<tr><td><code id="msedist_+3A_lower">lower</code></td>
<td>
<p> Left bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="msedist_+3A_upper">upper</code></td>
<td>
<p> Right bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="msedist_+3A_custom.optim">custom.optim</code></td>
<td>
<p>a function carrying the optimization.</p>
</td></tr>
<tr><td><code id="msedist_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. 
Should be <code>NULL</code> or a numeric vector with strictly positive integers 
(typically the number of occurences of each observation). If non-<code>NULL</code>, 
weighted MSE is used, otherwise ordinary MSE.</p>
</td></tr>
<tr><td><code id="msedist_+3A_silent">silent</code></td>
<td>
<p>A logical to remove or show warnings when bootstraping.</p>
</td></tr>    
<tr><td><code id="msedist_+3A_gradient">gradient</code></td>
<td>
<p>A function to return the gradient of the gof distance for the <code>"BFGS"</code>, <code>"CG"</code> 
and <code>"L-BFGS-B"</code> methods. If it is <code>NULL</code>, a finite-difference approximation will be used.</p>
</td></tr>
<tr><td><code id="msedist_+3A_checkstartfix">checkstartfix</code></td>
<td>
<p>A logical to test starting and fixed values. Do not change it.</p>
</td></tr>  
<tr><td><code id="msedist_+3A_calcvcov">calcvcov</code></td>
<td>
<p>A logical indicating if (asymptotic) covariance matrix is required.
(currently ignored)</p>
</td></tr>
<tr><td><code id="msedist_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+constrOptim">constrOptim</a></code> or <code>custom.optim</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>msedist</code> function numerically maximizes a phi-divergence function of spacings,
where spacings are the differences of the cumulative distribution function evaluated at
the sorted dataset.
The classical maximum spacing estimation (MSE) was introduced by Cheng and Amin (1986) 
and Ranneby (1984) independently where the phi-diverence is the logarithm,
see Anatolyev and Kosenok (2005) for a link between MSE and maximum likelihood estimation.
</p>
<p>MSE was generalized by Ranneby and Ekstrom (1997) by allowing different phi-divergence
function. Generalized MSE maximizes
</p>
<p style="text-align: center;"><code class="reqn">
      S_n(\theta)=\frac{1}{n+1}\sum_{i=1}^{n+1} \phi\left(F(x_{(i)}; \theta)-F(x_{(i-1)}; \theta) \right),
    </code>
</p>

<p>where <code class="reqn">F(;\theta)</code> is the parametric distribution function to be fitted,
<code class="reqn">\phi</code> is the phi-divergence function,
<code class="reqn">x_{(1)}&lt;\dots&lt;x_{(n)}</code> is the sorted sample, 
<code class="reqn">x_{(0)}=-\infty</code>
and  <code class="reqn">x_{(n+1)}=+\infty</code>.
The possible phi-divergence function is
</p>

<ul>
<li><p> Kullback-Leibler information (when <code>phidiv="KL"</code> and corresponds to classical MSE) 
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=\log(x)</code>
</p>

</li>
<li><p> Jeffreys' divergence (when <code>phidiv="J"</code>) 
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=(1-x)\log(x)</code>
</p>

</li>
<li><p> Renyi's divergence (when <code>phidiv="R"</code> and <code>power.phidiv=alpha</code>) 
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=x^\alpha\times\textrm{sign}(1-\alpha) \textrm{ with } \alpha&gt;0, \alpha\neq 1
      </code>
</p>
 
</li>
<li><p> Hellinger distance (when <code>phidiv="H"</code> and <code>power.phidiv=p</code>)
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=-|1-x^{1/p}|^p \textrm{ with } p\ge 1
      </code>
</p>
 
</li>
<li><p> Vajda's measure of information (when <code>phidiv="V"</code> and <code>power.phidiv=beta</code>)
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=-|1-x|^\beta \textrm{ with } \beta\ge 1
      </code>
</p>
 
</li></ul>

<p>The optimization process is the same as <code><a href="#topic+mledist">mledist</a></code>, see the 'details' section 
of that function.
</p>
<p>This function is not intended to be called directly but is internally called in
<code><a href="#topic+fitdist">fitdist</a></code> and <code><a href="#topic+bootdist">bootdist</a></code>.
</p>
<p>This function is intended to be used only with non-censored data.
</p>
<p>NB: if your data values are particularly small or large, a scaling may be needed 
before the optimization process, see <code><a href="#topic+mledist">mledist</a></code>'s examples. 
</p>


<h3>Value</h3>

 
<p><code>msedist</code> returns a list with following components,
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of <code><a href="stats.html#topic+optim">optim</a></code> defined as below
or defined by the user in the user-supplied optimization function. 
<code>0</code> indicates successful convergence.
<code>1</code> indicates that the iteration limit of <code><a href="stats.html#topic+optim">optim</a></code> has been reached.
<code>10</code> indicates degeneracy of the Nealder-Mead simplex.
<code>100</code> indicates that <code><a href="stats.html#topic+optim">optim</a></code> encountered an internal error.
</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>the minimal value reached for the criterion to minimize.</p>
</td></tr>    
<tr><td><code>hessian</code></td>
<td>
<p> a symmetric matrix computed by <code><a href="stats.html#topic+optim">optim</a></code> as an estimate of the Hessian
at the solution found or computed in the user-supplied optimization function. </p>
</td></tr>
<tr><td><code>optim.function</code></td>
<td>
<p>the name of the optimization function used for maximum likelihood.</p>
</td></tr>
<tr><td><code>optim.method</code></td>
<td>
<p>when <code><a href="stats.html#topic+optim">optim</a></code> is used, the name of the
algorithm used, the field <code>method</code> of the <code>custom.optim</code> function
otherwise.</p>
</td></tr>
<tr><td><code>fix.arg</code></td>
<td>
<p>the named list giving the values of parameters of the named distribution
that must kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
if there are no such parameters. </p>
</td></tr>
<tr><td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p>A two-element integer vector giving the number of calls 
to the log-likelihood function and its gradient respectively. 
This excludes those calls needed to compute the Hessian, if requested, 
and any calls to log-likelihood function to compute a finite-difference
approximation to the gradient. <code>counts</code> is returned by <code><a href="stats.html#topic+optim">optim</a></code>
or the user-supplied function or set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>optim.message</code></td>
<td>
<p>A character string giving any additional information 
returned by the optimizer, or <code>NULL</code>. To understand exactly the message,
see the source code.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> the log-likelihood value.</p>
</td></tr>
<tr><td><code>phidiv</code></td>
<td>
<p>The character string coding for the name of the phi-divergence used
either <code>"KL"</code>, <code>"J"</code>, <code>"R"</code>, <code>"H"</code> or <code>"V"</code>.</p>
</td></tr>  
<tr><td><code>power.phidiv</code></td>
<td>
<p>Either <code>NULL</code> or a numeric for the power used in the phi-divergence.</p>
</td></tr>    
</table>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

<p>Anatolyev, S., and Kosenok, G. (2005). <em>An alternative to maximum likelihood
based on spacings</em>. Econometric Theory, 21(2), 472-476,
<a href="https://doi.org/10.1017/S0266466605050255">doi:10.1017/S0266466605050255</a>. 
</p>
<p>Cheng, R.C.H. and N.A.K. Amin (1983) <em>Estimating parameters in continuous univariate 
distributions with a shifted origin</em>. Journal of the Royal Statistical Society Series B 45, 394-403,
<a href="https://doi.org/10.1111/j.2517-6161.1983.tb01268.x">doi:10.1111/j.2517-6161.1983.tb01268.x</a>.
</p>
<p>Ranneby, B. (1984) <em>The maximum spacing method: An estimation method related to 
the maximum likelihood method</em>. Scandinavian Journal of Statistics 11, 93-112.
</p>
<p>Ranneby, B. and Ekstroem, M. (1997). <em>Maximum spacing estimates based
on different metrics</em>. Umea universitet.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, <code><a href="#topic+mgedist">mgedist</a></code>, 
<code><a href="#topic+fitdist">fitdist</a></code> for other estimation methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1) Fit of a Weibull distribution to serving size data by maximum 
# spacing estimation
# 

data(groundbeef)
serving &lt;- groundbeef$serving
msedist(serving, "weibull")



# (2) Fit of an exponential distribution 
# 

set.seed(123)
x1 &lt;- rexp(1e3)
#the convergence is quick
msedist(x1, "exp", control=list(trace=0, REPORT=1))

</code></pre>

<hr>
<h2 id='plotdist'> Plot of empirical and theoretical distributions for non-censored data</h2><span id='topic+plotdist'></span>

<h3>Description</h3>

<p>Plots an empirical distribution (non-censored data) with a theoretical one if specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotdist(data, distr, para, histo = TRUE, breaks = "default", 
  demp = FALSE, discrete, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotdist_+3A_data">data</code></td>
<td>
<p> A numeric vector.  </p>
</td></tr>
<tr><td><code id="plotdist_+3A_distr">distr</code></td>
<td>
<p> A character string <code>"name"</code> naming a distribution for which the corresponding 
density function <code>dname</code>, the corresponding distribution function <code>pname</code> and the corresponding
quantile function <code>qname</code> must be defined, or directly the density function. 
This argument may be omitted only if <code>para</code> is omitted. </p>
</td></tr>
<tr><td><code id="plotdist_+3A_para">para</code></td>
<td>
<p> A named list giving the parameters of the named distribution. This argument may be 
omitted only if <code>distr</code> is omitted.  </p>
</td></tr>
<tr><td><code id="plotdist_+3A_histo">histo</code></td>
<td>
<p>A logical to plot the histogram using the 
<code><a href="graphics.html#topic+hist">hist</a></code> function.</p>
</td></tr>
<tr><td><code id="plotdist_+3A_breaks">breaks</code></td>
<td>
<p> If <code>"default"</code> the histogram is plotted with the function <code>hist</code> 
with its default breaks definition. Else <code>breaks</code> is passed to the function <code>hist</code>.
This argument is not taken into account if <code>discrete</code> is <code>TRUE</code>. </p>
</td></tr>
<tr><td><code id="plotdist_+3A_demp">demp</code></td>
<td>
<p>A logical to plot the empirical density on the first plot 
(alone or superimposed on the histogram depending of the value of the argument <code>histo</code>) 
using the <code><a href="stats.html#topic+density">density</a></code> function.</p>
</td></tr>
<tr><td><code id="plotdist_+3A_discrete">discrete</code></td>
<td>
<p> If TRUE, the distribution is considered as discrete.
If both <code>distr</code> and <code>discrete</code> are missing, <code>discrete</code> is set
to <code>FALSE</code>. If <code>discrete</code> is missing but not  <code>distr</code>, 
<code>discrete</code> is set to <code>TRUE</code> when <code>distr</code> belongs to 
<code>"binom"</code>, <code>"nbinom"</code>,<code>"geom"</code>,
<code>"hyper"</code> or <code>"pois"</code>.  </p>
</td></tr>
<tr><td><code id="plotdist_+3A_...">...</code></td>
<td>
<p> further graphical arguments passed to graphical functions used in plotdist.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Empirical and, if specified, theoretical distributions are plotted
in density and in cdf. For the plot in density, the user can use the arguments
<code>histo</code> and <code>demp</code> to specify if he wants the histogram using the function 
<code><a href="graphics.html#topic+hist">hist</a></code>, the density plot using the function <code><a href="stats.html#topic+density">density</a></code>, or both
(at least one of the two arguments must be put to <code>"TRUE"</code>).
For continuous distributions, the function <code><a href="graphics.html#topic+hist">hist</a></code> is used with its default
breaks definition if <code>breaks</code> is <code>"default"</code> or passing <code>breaks</code> as an argument if it differs
from <code>"default"</code>. For continuous distribution and when a theoretical distribution is specified
by both arguments <code>distname</code> and <code>para</code>, Q-Q plot
(plot of the quantiles of the theoretical fitted distribution (x-axis) against the empirical quantiles of the data)
and P-P plot (i.e. for each value of the data set, plot of the cumulative density function of the fitted distribution
(x-axis) against the empirical cumulative density function (y-axis)) are also given (Cullen and Frey, 1999).
The function <code><a href="stats.html#topic+ppoints">ppoints</a></code> (with default parameter for argument a)
is used for the Q-Q plot, to generate the set of probabilities at 
which to evaluate the inverse distribution.
NOTE THAT FROM VERSION 0.4-3, <code><a href="stats.html#topic+ppoints">ppoints</a></code> is also used for P-P plot and cdf plot for continuous data.
To personalize the four plots proposed for continuous data, for example to change the plotting position, we recommend 
the use of functions <code><a href="#topic+cdfcomp">cdfcomp</a></code>, <code><a href="#topic+denscomp">denscomp</a></code>, <code><a href="#topic+qqcomp">qqcomp</a></code> and <code><a href="#topic+ppcomp">ppcomp</a></code>.
</p>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Cullen AC and Frey HC (1999), <em>Probabilistic techniques in exposure assessment</em>.
Plenum Press, USA, pp. 81-155.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+graphcomp">graphcomp</a></code>, <code><a href="#topic+descdist">descdist</a></code>, <code><a href="graphics.html#topic+hist">hist</a></code>,  <code><a href="base.html#topic+plot">plot</a></code>, <code><a href="#topic+plotdistcens">plotdistcens</a></code> and <code><a href="stats.html#topic+ppoints">ppoints</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) Plot of an empirical distribution with changing 
# of default line types for CDF and colors
# and optionally adding a density line
#
set.seed(1234)
x1 &lt;- rnorm(n=30)
plotdist(x1)
plotdist(x1,demp = TRUE)
plotdist(x1,histo = FALSE, demp = TRUE)
plotdist(x1, col="blue", type="b", pch=16)
plotdist(x1, type="s")

# (2) Plot of a discrete distribution against data
#
set.seed(1234)
x2 &lt;- rpois(n=30, lambda = 2)
plotdist(x2, discrete=TRUE)
plotdist(x2, "pois", para=list(lambda = mean(x2)))
plotdist(x2, "pois", para=list(lambda = mean(x2)), lwd="2")

# (3) Plot of a continuous distribution against data
#
xn &lt;- rnorm(n=100, mean=10, sd=5)
plotdist(xn, "norm", para=list(mean=mean(xn), sd=sd(xn)))
plotdist(xn, "norm", para=list(mean=mean(xn), sd=sd(xn)), pch=16)
plotdist(xn, "norm", para=list(mean=mean(xn), sd=sd(xn)), demp = TRUE)
plotdist(xn, "norm", para=list(mean=mean(xn), sd=sd(xn)), 
histo = FALSE, demp = TRUE)

# (4) Plot of serving size data
#
data(groundbeef)
plotdist(groundbeef$serving, type="s")

# (5) Plot of numbers of parasites with a Poisson distribution 
data(toxocara)
number &lt;- toxocara$number
plotdist(number, discrete = TRUE)
plotdist(number,"pois",para=list(lambda=mean(number)))

</code></pre>

<hr>
<h2 id='plotdistcens'> Plot of empirical and theoretical distributions for censored data</h2><span id='topic+plotdistcens'></span>

<h3>Description</h3>

<p>Plots an empirical distribution for censored data with a theoretical one if specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotdistcens(censdata, distr, para, leftNA = -Inf, rightNA = Inf,
    NPMLE = TRUE, Turnbull.confint = FALSE, 
    NPMLE.method = "Wang", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotdistcens_+3A_censdata">censdata</code></td>
<td>
<p> A dataframe of two columns respectively named <code>left</code> 
and <code>right</code>, describing each observed value as an interval.
The <code>left</code> column contains either <code>NA</code> for left censored observations,
the left bound of the interval for interval censored observations,
or the observed value for non-censored observations.
The <code>right</code> column contains either <code>NA</code> for right censored observations,
the right bound of the interval for interval censored observations,
or the observed value for non-censored observations.  </p>
</td></tr>
<tr><td><code id="plotdistcens_+3A_distr">distr</code></td>
<td>
<p> A character string <code>"name"</code> naming a distribution, for which the corresponding 
density function <code>dname</code> and the corresponding distribution function <code>pname</code>
must be defined, or directly the density function.</p>
</td></tr>
<tr><td><code id="plotdistcens_+3A_para">para</code></td>
<td>
<p> A named list giving the parameters of the named distribution. This argument may be 
omitted only if <code>distr</code> is omitted.  </p>
</td></tr>
<tr><td><code id="plotdistcens_+3A_leftna">leftNA</code></td>
<td>
<p> the real value of the left bound of left censored observations : <code>-Inf</code> 
or a finite value such as <code>0</code> for positive data for example.</p>
</td></tr>
<tr><td><code id="plotdistcens_+3A_rightna">rightNA</code></td>
<td>
<p> the real value of the right bound of right censored observations : <code>Inf</code>
or a finite value such as a realistic maximum value.</p>
</td></tr>
<tr><td><code id="plotdistcens_+3A_npmle">NPMLE</code></td>
<td>
<p> if TRUE an NPMLE (nonparametric maximum likelihood estimate) technique is 
used to estimate the cdf curve of the censored data
and previous arguments <code>leftNA</code> and <code>rightNA</code> are not used (see details)</p>
</td></tr>
<tr><td><code id="plotdistcens_+3A_turnbull.confint">Turnbull.confint</code></td>
<td>
<p> if TRUE confidence intervals will be added to the Turnbull plot.
In that case NPMLE.method is forced to <code>"Turnbull.middlepoints"</code></p>
</td></tr>
<tr><td><code id="plotdistcens_+3A_npmle.method">NPMLE.method</code></td>
<td>
<p>Three NPMLE techniques are provided, <code>"Wang"</code>, the default one,
rewritten from the package npsurv using function constrOptim from the package stats 
for optimisation, <code>"Turnbull.middlepoints"</code>, an older one which is implemented in 
the package survival and <code>"Turnbull.intervals"</code> that uses the same Turnbull algorithm 
from the package survival but associates an interval to each equivalence class instead of the 
middlepoint of this interval  (see details). Only <code>"Wang"</code> and
<code>"Turnbull.intervals"</code> enable the derivation of a Q-Q plot and a P-P plot.</p>
</td></tr>
<tr><td><code id="plotdistcens_+3A_...">...</code></td>
<td>
<p> further graphical arguments passed to other methods. The title of the plot 
can be modified using the argument <code>main</code> only for the CDF plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>NPMLE</code> is <code>TRUE</code>, and <code>NPMLE.method</code> is <code>"Wang"</code> ,
empirical distributions are plotted
in cdf using either the constrained Newton method (Wang, 2008)
or the hierarchical constrained Newton method (Wang, 2013) 
to compute the overall empirical cdf curve. 
If <code>NPMLE</code> is <code>TRUE</code>, and <code>NPMLE.method</code> is <code>"Turnbull.intervals"</code> ,
empirical are plotted
in cdf using the EM approach of Turnbull  (Turnbull, 1974).
In those two cases, grey rectangles represent areas
where the empirical distribution function is not unique. In cases
where a theoretical distribution is specified, two goodness-of-fit plots
are also provided, a Q-Q plot (plot of the quantiles of the theoretical fitted 
distribution (x-axis) against the empirical quantiles of the data) and a P-P plot
(i.e. for each value of the data set, plot of the cumulative density function 
of the fitted distribution (x-axis) against the empirical cumulative density function 
(y-axis)). Grey rectangles in a Q-Q plot or a P-P plot also represent areas of 
non uniqueness of empirical quantiles or probabilities, directly derived from 
non uniqueness areas of the empirical cumulative distribution.
</p>
<p>If <code>NPMLE</code> is <code>TRUE</code>, and <code>NPMLE.method</code> is <code>"Turnbull.middlepoints"</code>,
empirical and, if specified, theoretical distributions are plotted
in cdf using the EM approach of Turnbull (Turnbull, 1974) 
to compute the overall 
empirical cdf curve, with confidence intervals if <code>Turnbull.confint</code> is <code>TRUE</code>, 
by calls to functions <code><a href="survival.html#topic+survfit">survfit</a></code> and <code><a href="survival.html#topic+plot.survfit">plot.survfit</a></code> from the 
<code>survival</code> package. 
</p>
<p>If <code>NPMLE</code> is <code>FALSE</code> empirical and, if specified, theoretical distributions 
are plotted in cdf, with data directly reported as segments for interval, 
left and right censored data, 
and as points for non-censored data. Before plotting, observations are ordered and a rank r
is associated to each of them. Left censored observations are ordered
first, by their right bounds. Interval censored and non censored observations
are then ordered by their mid-points and, at last, right censored observations are
ordered by their left bounds. If <code>leftNA</code> (resp. <code>rightNA</code>) is finite,
left censored (resp. right censored) observations are considered as interval censored
observations and ordered by mid-points with non-censored and interval censored data.
It is sometimes necessary to fix <code>rightNA</code> or <code>leftNA</code> to a realistic 
extreme value, even if not exactly known, to obtain a reasonable global ranking of 
observations. After ranking, each of the n observations is plotted as a point (one x-value) 
or a segment (an interval of possible x-values),
with an y-value equal to r/n, r being the rank of each observation in the global ordering
previously described. This second method may be interesting but 
is certainly less rigorous than the other methods
that should be prefered.
</p>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Turnbull BW (1974), <em>Nonparametric estimation of a survivorship function with doubly
censored data</em>. Journal of American Statistical Association, 69, 169-173,
<a href="https://doi.org/10.2307/2285518">doi:10.2307/2285518</a>.
</p>
<p>Wang Y (2008), <em>Dimension-reduced nonparametric maximum likelihood computation
for interval-censored data</em>. Computational Statistics &amp; Data Analysis, 52, 2388-2402,
<a href="https://doi.org/10.1016/j.csda.2007.10.018">doi:10.1016/j.csda.2007.10.018</a>.
</p>
<p>Wang Y and Taylor SM (2013), <em>Efficient computation of nonparametric survival
functions via a hierarchical mixture formulation</em>. Statistics and Computing, 23, 713-725,
<a href="https://doi.org/10.1007/s11222-012-9341-9">doi:10.1007/s11222-012-9341-9</a>.
</p>
<p>Wang, Y., &amp; Fani, S. (2018), <em>Nonparametric maximum likelihood computation of a U-shaped hazard function</em>. Statistics and Computing, 28(1), 187-200,
<a href="https://doi.org/10.1007/s11222-017-9724-z">doi:10.1007/s11222-017-9724-z</a>.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+plotdist">plotdist</a></code>, <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) Plot of an empirical censored distribution (censored data) as a CDF
# using the default Wang method
#
data(smokedfish)
d1 &lt;- as.data.frame(log10(smokedfish))
plotdistcens(d1)

# (2) Add the CDF of a normal distribution 
#
plotdistcens(d1, "norm", para=list(mean = -1.6, sd = 1.5))

# (3) Various plots of the same empirical distribution 
#
# default Wang plot with representation of equivalence classess
plotdistcens(d1, NPMLE = TRUE, NPMLE.method = "Wang")
# same plot but using the Turnbull alorithm from the package survival
plotdistcens(d1, NPMLE = TRUE, NPMLE.method = "Wang")
# Turnbull plot with middlepoints (as in the package survival)
plotdistcens(d1, NPMLE = TRUE, NPMLE.method = "Turnbull.middlepoints")
# Turnbull plot with middlepoints and confidence intervals
plotdistcens(d1, NPMLE = TRUE, NPMLE.method = "Turnbull.middlepoints", Turnbull.confint = TRUE)
# with intervals and points
plotdistcens(d1,rightNA=3, NPMLE = FALSE)
# with intervals and points
# defining a minimum value for left censored values
plotdistcens(d1,leftNA=-3, NPMLE = FALSE)

</code></pre>

<hr>
<h2 id='prefit'>Pre-fitting procedure</h2><span id='topic+prefit'></span>

<h3>Description</h3>

<p>Search good starting values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
prefit(data, distr, method = c("mle", "mme", "qme", "mge"), 
  feasible.par, memp=NULL, order=NULL,
  probs=NULL, qtype=7, gof=NULL, fix.arg=NULL, lower, 
  upper, weights=NULL, silent=TRUE, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prefit_+3A_data">data</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="prefit_+3A_distr">distr</code></td>
<td>
<p>A character string <code>"name"</code> naming a distribution for which the corresponding
density function <code>dname</code>, the corresponding distribution function <code>pname</code> and the 
corresponding quantile function <code>qname</code> must be defined, or directly the density function.</p>
</td></tr>
<tr><td><code id="prefit_+3A_method">method</code></td>
<td>
<p>A character string coding for the fitting method: 
<code>"mle"</code> for 'maximum likelihood estimation', <code>"mme"</code> for 'moment matching estimation', 
<code>"qme"</code> for 'quantile matching estimation' and <code>"mge"</code> for 'maximum goodness-of-fit estimation'.</p>
</td></tr>
<tr><td><code id="prefit_+3A_feasible.par">feasible.par</code></td>
<td>
<p>A named list giving the initial values of parameters of the named distribution
or a function of data computing initial values and returning a named list.
This argument may be omitted (default) for some distributions for which reasonable 
starting values are computed (see the 'details' section of  <code><a href="#topic+mledist">mledist</a></code>). 
It may not be into account for closed-form formulas.</p>
</td></tr>
<tr><td><code id="prefit_+3A_order">order</code></td>
<td>
<p>A numeric vector for the moment order(s). The length of this vector must be equal
to the number of parameters to estimate.</p>
</td></tr>
<tr><td><code id="prefit_+3A_memp">memp</code></td>
<td>
<p>A function implementing empirical moments, raw or centered but has to be consistent with 
<code>distr</code> argument (and <code>weights</code> argument).</p>
</td></tr>
<tr><td><code id="prefit_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of the probabilities for which the quantile matching is done.
The length of this vector must be equal to the number of parameters to estimate.</p>
</td></tr>  
<tr><td><code id="prefit_+3A_qtype">qtype</code></td>
<td>
<p>The quantile type used by the R <code><a href="#topic+quantile">quantile</a></code> function to 
compute the empirical quantiles, (default 7 corresponds to the default quantile method in R).</p>
</td></tr>
<tr><td><code id="prefit_+3A_gof">gof</code></td>
<td>
<p>A character string coding for the name of the goodness-of-fit distance used : 
&quot;CvM&quot; for Cramer-von Mises distance,&quot;KS&quot; for Kolmogorov-Smirnov distance,
&quot;AD&quot; for Anderson-Darling distance, &quot;ADR&quot;, &quot;ADL&quot;, &quot;AD2R&quot;, &quot;AD2L&quot; and &quot;AD2&quot; for variants of
Anderson-Darling distance described by Luceno (2006).</p>
</td></tr>  
<tr><td><code id="prefit_+3A_fix.arg">fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of the named distribution
or a function of data computing (fixed) parameter values and returning a named list. 
Parameters with fixed value are thus NOT estimated by this maximum likelihood procedure.
The use of this argument is not possible if <code>method="mme"</code> and a closed-form formula is used.</p>
</td></tr>
<tr><td><code id="prefit_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. 
Should be <code>NULL</code> or a numeric vector. If non-<code>NULL</code>, 
weighted MLE is used, otherwise ordinary MLE.</p>
</td></tr>
<tr><td><code id="prefit_+3A_silent">silent</code></td>
<td>
<p>A logical to remove or show warnings.</p>
</td></tr>
<tr><td><code id="prefit_+3A_lower">lower</code></td>
<td>
<p>Lower bounds on the parameters.</p>
</td></tr>
<tr><td><code id="prefit_+3A_upper">upper</code></td>
<td>
<p>Upper bounds on the parameters.</p>
</td></tr>
<tr><td><code id="prefit_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic functions, or to one of the functions
<code>"mledist"</code>,  <code>"mmedist"</code>, <code>"qmedist"</code> or <code>"mgedist"</code>
depending of the chosen method. See <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, 
<code><a href="#topic+mgedist">mgedist</a></code> for details on parameter estimation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Searching good starting values is achieved by transforming the parameters 
(from their constraint interval to the real line) of the probability distribution.
Indeed, 
</p>

<ul>
<li><p> positive parameters in <code class="reqn">(0,Inf)</code> are transformed using the logarithm
(typically the scale parameter <code>sd</code> of a normal distribution, see <a href="stats.html#topic+Normal">Normal</a>), 
</p>
</li>
<li><p>  parameters in <code class="reqn">(1,Inf)</code> are transformed using the function <code class="reqn">log(x-1)</code>, 
</p>
</li>
<li><p> probability parameters in <code class="reqn">(0,1)</code> are transformed using the logit function <code class="reqn">log(x/(1-x))</code>
(typically the parameter <code>prob</code> of a geometric distribution, see <a href="stats.html#topic+Geometric">Geometric</a>), 
</p>
</li>
<li><p> negative probability parameters in <code class="reqn">(-1,0)</code> are transformed using the function <code class="reqn">log(-x/(1+x))</code>,
</p>
</li>
<li><p> real parameters are of course not transformed at all, 
typically the <code>mean</code> of a normal distribution, see <a href="stats.html#topic+Normal">Normal</a>.
</p>
</li></ul>

<p>Once parameters are transformed, an optimization is carried out by a quasi-Newton algorithm (typically BFGS)
and then we transform them back to original parameter value.
</p>


<h3>Value</h3>

 
<p>A named list.
</p>


<h3>Author(s)</h3>

 
<p>Christophe Dutang and Marie-Laure Delignette-Muller.
</p>


<h3>References</h3>

 
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+qmedist">qmedist</a></code>, 
<code><a href="#topic+mgedist">mgedist</a></code> for details on parameter estimation.
See <code><a href="#topic+fitdist">fitdist</a></code> for the main procedure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1) fit of a gamma distribution by maximum likelihood estimation
#
x &lt;- rgamma(1e3, 5/2, 7/2)

prefit(x, "gamma", "mle", list(shape=3, scale=3), lower=-Inf, upper=Inf)

</code></pre>

<hr>
<h2 id='qmedist'> Quantile matching fit of univariate distributions</h2><span id='topic+qmedist'></span><span id='topic+qme'></span>

<h3>Description</h3>

<p>Fit of univariate distribution by matching quantiles for non censored data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qmedist(data, distr, probs, start = NULL, fix.arg = NULL, qtype = 7, 
    optim.method = "default", lower = -Inf, upper = Inf, 
    custom.optim = NULL, weights = NULL, silent = TRUE, gradient = NULL, 
    checkstartfix=FALSE, calcvcov=FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qmedist_+3A_data">data</code></td>
<td>
<p> A numeric vector for non censored data. </p>
</td></tr>
<tr><td><code id="qmedist_+3A_distr">distr</code></td>
<td>
<p> A character string <code>"name"</code> naming a distribution  for which the corresponding 
quantile function 
<code>qname</code> and the corresponding density distribution <code>dname</code> must be classically defined. </p>
</td></tr>
<tr><td><code id="qmedist_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of the probabilities for which the quantile matching is done.
The length of this vector must be equal
to the number of parameters to estimate.</p>
</td></tr>  
<tr><td><code id="qmedist_+3A_start">start</code></td>
<td>
<p>A named list giving the initial values of parameters of the named distribution
or a function of data computing initial values and returning a named list.
This argument may be omitted (default) for some distributions for which reasonable 
starting values are computed (see the 'details' section of  <code><a href="#topic+mledist">mledist</a></code>). </p>
</td></tr>
<tr><td><code id="qmedist_+3A_fix.arg">fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of the named distribution
or a function of data computing (fixed) parameter values and returning a named list. 
Parameters with fixed value are thus NOT estimated.</p>
</td></tr>
<tr><td><code id="qmedist_+3A_qtype">qtype</code></td>
<td>
<p>The quantile type used by the R <code><a href="#topic+quantile">quantile</a></code> function to 
compute the empirical quantiles, (default 7 corresponds to the default quantile method in R).</p>
</td></tr>
<tr><td><code id="qmedist_+3A_optim.method">optim.method</code></td>
<td>
 <p><code>"default"</code> or optimization method to pass to <code><a href="stats.html#topic+optim">optim</a></code>.  </p>
</td></tr>
<tr><td><code id="qmedist_+3A_lower">lower</code></td>
<td>
<p> Left bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="qmedist_+3A_upper">upper</code></td>
<td>
<p> Right bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code><a href="stats.html#topic+optim">optim</a></code>).  </p>
</td></tr>
<tr><td><code id="qmedist_+3A_custom.optim">custom.optim</code></td>
<td>
<p>a function carrying the optimization.</p>
</td></tr>
<tr><td><code id="qmedist_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. 
Should be <code>NULL</code> or a numeric vector with strictly positive integers 
(typically the number of occurences of each observation). If non-<code>NULL</code>, 
weighted QME is used, otherwise ordinary QME.</p>
</td></tr>
<tr><td><code id="qmedist_+3A_silent">silent</code></td>
<td>
<p>A logical to remove or show warnings when bootstraping.</p>
</td></tr>        
<tr><td><code id="qmedist_+3A_gradient">gradient</code></td>
<td>
<p>A function to return the gradient of the squared difference for the <code>"BFGS"</code>, <code>"CG"</code> 
and <code>"L-BFGS-B"</code> methods. If it is <code>NULL</code>, a finite-difference approximation will be used,
see details.</p>
</td></tr>
<tr><td><code id="qmedist_+3A_checkstartfix">checkstartfix</code></td>
<td>
<p>A logical to test starting and fixed values. Do not change it.</p>
</td></tr>     
<tr><td><code id="qmedist_+3A_calcvcov">calcvcov</code></td>
<td>
<p>A logical indicating if (asymptotic) covariance matrix is required.
(currently ignored)</p>
</td></tr>
<tr><td><code id="qmedist_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <code><a href="stats.html#topic+optim">optim</a></code>, 
<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> or <code>custom.optim</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>qmedist</code> function carries out the quantile matching numerically, by minimization of the
sum of squared differences between observed and theoretical quantiles.
Note that for discrete distribution, the sum of squared differences is a step function and
consequently, the optimum is not unique, see the FAQ.
</p>
<p>The optimization process is the same as <code><a href="#topic+mledist">mledist</a></code>, see the 'details' section 
of that function.
</p>
<p>Optionally, a vector of <code>weights</code> can be used in the fitting process. 
By default (when <code>weigths=NULL</code>), ordinary QME is carried out, otherwise 
the specified weights are used to compute weighted quantiles used in the squared differences.
Weigthed quantiles are computed by <code><a href="Hmisc.html#topic+wtd.stats">wtdquantile</a></code> from the <code>Hmisc</code> package.
It is not yet possible to take into account weighths in functions <code>plotdist</code>, 
<code>plotdistcens</code>, <code>plot.fitdist</code>, <code>plot.fitdistcens</code>, <code>cdfcomp</code>, 
<code>cdfcompcens</code>, <code>denscomp</code>, <code>ppcomp</code>, <code>qqcomp</code>, <code>gofstat</code> 
and <code>descdist</code>
(developments planned in the future).
</p>
<p>This function is not intended to be called directly but is internally called in
<code><a href="#topic+fitdist">fitdist</a></code> and <code><a href="#topic+bootdist">bootdist</a></code>.
</p>


<h3>Value</h3>

 
<p><code>qmedist</code> returns a list with following components,
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of <code><a href="stats.html#topic+optim">optim</a></code> defined as below
or defined by the user in the user-supplied optimization function. 
<code>0</code> indicates successful convergence.
<code>1</code> indicates that the iteration limit of <code><a href="stats.html#topic+optim">optim</a></code> has been reached.
<code>10</code> indicates degeneracy of the Nealder-Mead simplex.
<code>100</code> indicates that <code><a href="stats.html#topic+optim">optim</a></code> encountered an internal error.
</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>the minimal value reached for the criterion to minimize.</p>
</td></tr>    
<tr><td><code>hessian</code></td>
<td>
<p> a symmetric matrix computed by <code><a href="stats.html#topic+optim">optim</a></code> as an estimate of the Hessian
at the solution found or computed in the user-supplied optimization function. </p>
</td></tr>
<tr><td><code>optim.function</code></td>
<td>
<p>the name of the optimization function used for maximum likelihood.</p>
</td></tr>
<tr><td><code>optim.method</code></td>
<td>
<p>when <code><a href="stats.html#topic+optim">optim</a></code> is used, the name of the
algorithm used, the field <code>method</code> of the <code>custom.optim</code> function
otherwise.</p>
</td></tr>
<tr><td><code>fix.arg</code></td>
<td>
<p>the named list giving the values of parameters of the named distribution
that must kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
if there are no such parameters. </p>
</td></tr>
<tr><td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p>A two-element integer vector giving the number of calls 
to the log-likelihood function and its gradient respectively. 
This excludes those calls needed to compute the Hessian, if requested, 
and any calls to log-likelihood function to compute a finite-difference
approximation to the gradient. <code>counts</code> is returned by <code><a href="stats.html#topic+optim">optim</a></code>
or the user-supplied function or set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>optim.message</code></td>
<td>
<p>A character string giving any additional information 
returned by the optimizer, or <code>NULL</code>. To understand exactly the message,
see the source code.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> the log-likelihood value. </p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p> the probability vector on which quantiles are matched. </p>
</td></tr>   
</table>


<h3>Author(s)</h3>

 
<p>Christophe Dutang and Marie Laure Delignette-Muller.
</p>


<h3>References</h3>

<p>Klugman SA, Panjer HH and Willmot GE (2012),
<em>Loss Models: From Data to Decissions</em>, 4th edition.
Wiley Series in Statistics for Finance, Business and Economics, p. 253,
<a href="https://doi.org/10.1198/tech.2006.s409">doi:10.1198/tech.2006.s409</a>.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+mmedist">mmedist</a></code>, <code><a href="#topic+mledist">mledist</a></code>, <code><a href="#topic+mgedist">mgedist</a></code>,
<code><a href="#topic+fitdist">fitdist</a></code> for other estimation methods and 
<code><a href="#topic+quantile">quantile</a></code> for empirical quantile estimation in R.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# (1) basic fit of a normal distribution 
#

set.seed(1234)
x1 &lt;- rnorm(n=100)
qmedist(x1, "norm", probs=c(1/3, 2/3))


# (2) defining your own distribution functions, here for the Gumbel 
# distribution for other distributions, see the CRAN task view dedicated 
# to probability distributions

dgumbel &lt;- function(x, a, b) 1/b*exp((a-x)/b)*exp(-exp((a-x)/b))
qgumbel &lt;- function(p, a, b) a - b*log(-log(p))
qmedist(x1, "gumbel", probs=c(1/3, 2/3), start=list(a=10,b=5))

# (3) fit a discrete distribution (Poisson)
#

set.seed(1234)
x2 &lt;- rpois(n=30,lambda = 2)
qmedist(x2, "pois", probs=1/2)

# (4) fit a finite-support distribution (beta)
#

set.seed(1234)
x3 &lt;- rbeta(n=100,shape1=5, shape2=10)
qmedist(x3, "beta", probs=c(1/3, 2/3))

# (5) fit frequency distributions on USArrests dataset.
#

x4 &lt;- USArrests$Assault
qmedist(x4, "pois", probs=1/2)
qmedist(x4, "nbinom", probs=c(1/3, 2/3))

</code></pre>

<hr>
<h2 id='quantile'>Quantile estimation from a fitted distribution</h2><span id='topic+quantile'></span><span id='topic+quantile.fitdist'></span><span id='topic+quantile.fitdistcens'></span><span id='topic+quantile.bootdist'></span><span id='topic+quantile.bootdistcens'></span><span id='topic+print.quantile.fitdist'></span><span id='topic+print.quantile.fitdistcens'></span><span id='topic+print.quantile.bootdist'></span><span id='topic+print.quantile.bootdistcens'></span>

<h3>Description</h3>

<p>Quantile estimation from a fitted distribution, optionally with confidence intervals calculated 
from the bootstrap result.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitdist'
quantile(x, probs = seq(0.1, 0.9, by=0.1), ...)
## S3 method for class 'fitdistcens'
quantile(x, probs = seq(0.1, 0.9, by=0.1), ...)
## S3 method for class 'bootdist'
quantile(x, probs = seq(0.1, 0.9, by=0.1),CI.type = "two.sided", 
  CI.level = 0.95, ...)
## S3 method for class 'bootdistcens'
quantile(x, probs = seq(0.1, 0.9, by=0.1),CI.type = "two.sided", 
  CI.level = 0.95, ...)
## S3 method for class 'quantile.fitdist'
print(x, ...)
## S3 method for class 'quantile.fitdistcens'
print(x, ...)
## S3 method for class 'quantile.bootdist'
print(x, ...)
## S3 method for class 'quantile.bootdistcens'
print(x, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantile_+3A_x">x</code></td>
<td>
<p> An object of class <code>"fitdist"</code>, <code>"fitdistcens"</code>, <code>"bootdist"</code>, <code>"bootdistcens"</code>
or <code>"quantile.fitdist"</code>, <code>"quantile.fitdistcens"</code>, <code>"quantile.bootdist"</code>, 
<code>"quantile.bootdistcens"</code> for the <code>print</code> generic function.  </p>
</td></tr>
<tr><td><code id="quantile_+3A_probs">probs</code></td>
<td>
<p> A numeric vector of probabilities with values in [0, 1] at which quantiles must be calculated.</p>
</td></tr>
<tr><td><code id="quantile_+3A_ci.type">CI.type</code></td>
<td>
<p> Type of confidence intervals : either <code>"two.sided"</code> or one-sided 
intervals (<code>"less"</code> or <code>"greater"</code>).</p>
</td></tr>
<tr><td><code id="quantile_+3A_ci.level">CI.level</code></td>
<td>
<p> The confidence level.</p>
</td></tr>
<tr><td><code id="quantile_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Quantiles of the parametric distribution are calculated for 
each probability specified in <code>probs</code>, using the estimated parameters.
When used with an object of class <code>"bootdist"</code> or <code>"bootdistcens"</code>, percentile 
confidence intervals and medians etimates 
are also calculated from the bootstrap result.
If <code>CI.type</code> is <code>two.sided</code>, 
the <code>CI.level</code> two-sided confidence intervals of quantiles are calculated.
If <code>CI.type</code> is <code>less</code> or <code>greater</code>, 
the <code>CI.level</code> one-sided confidence intervals of quantiles are calculated.
The print functions show the estimated quantiles with percentile confidence intervals
and median estimates when a bootstrap resampling has been done previously,
and the number of bootstrap iterations 
for which the estimation converges if it is inferior to the whole number of bootstrap iterations.
</p>


<h3>Value</h3>

 
<p><code>quantile</code> returns a list with 2 components (the first two described below) when called with an object
of class <code>"fitdist"</code> or <code>"fitdistcens"</code> and 8 components (described below)
when called with an object  of class
<code>"bootdist"</code> or <code>"bootdistcens"</code> :
</p>
<table role = "presentation">
<tr><td><code>quantiles</code></td>
<td>
<p> a dataframe containing the estimated quantiles for each probability value specified in 
the argument <code>probs</code> (one row, and as many columns as values in <code>probs</code>).</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>the numeric vector of probabilities at which quantiles are calculated.</p>
</td></tr>
<tr><td><code>bootquant</code></td>
<td>
<p> A data frame containing the bootstraped values for each quantile
(many rows, as specified in the call to <code><a href="#topic+bootdist">bootdist</a></code>  in  the argument <code>niter</code>, 
and as many columns as values in <code>probs</code>)</p>
</td></tr>
<tr><td><code>quantCI</code></td>
<td>
<p> If <code>CI.type</code> is <code>two.sided</code>, the two bounds of the  <code>CI.level</code> percent 
two.sided confidence interval for each quantile 
(two rows and as many columns as values in <code>probs</code>). If <code>CI.type</code> is <code>less</code>, 
right bound of the <code>CI.level</code> percent
one.sided confidence interval for each quantile (one row).
If <code>CI.type</code> is <code>greater</code>, left bound of the <code>CI.level</code> percent
one.sided confidence interval for each quantile (one row). </p>
</td></tr>
<tr><td><code>quantmedian</code></td>
<td>
<p>Median of bootstrap estimates (per probability).</p>
</td></tr>
<tr><td><code>CI.type</code></td>
<td>
<p> Type of confidence interval: either <code>"two.sided"</code> or one-sided 
intervals (<code>"less"</code> or <code>"greater"</code>).</p>
</td></tr>
<tr><td><code>CI.level</code></td>
<td>
<p> The confidence level.</p>
</td></tr>
<tr><td><code>nbboot</code></td>
<td>
<p> The number of samples drawn by bootstrap.</p>
</td></tr>
<tr><td><code>nbconverg</code></td>
<td>
<p> The number of iterations for which the optimization algorithm converges.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+fitdist">fitdist</a></code>, <code><a href="#topic+bootdist">bootdist</a></code>, <code><a href="#topic+fitdistcens">fitdistcens</a></code>, <code><a href="#topic+bootdistcens">bootdistcens</a></code> and <code><a href="#topic+CIcdfplot">CIcdfplot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) Fit of a normal distribution on acute toxicity log-transformed values of 
# endosulfan for nonarthropod invertebrates, using maximum likelihood estimation
# to estimate what is called a species sensitivity distribution 
# (SSD) in ecotoxicology, followed by estimation of the 5, 10 and 20 percent quantile  
# values of the fitted distribution, which are called the 5, 10, 20 percent hazardous 
# concentrations (HC5, HC10, HC20) in ecotoxicology, followed with calculations of their
# confidence intervals with various definitions, from a small number of bootstrap 
# iterations to satisfy CRAN running times constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.
#
data(endosulfan)
ATV &lt;- subset(endosulfan, group == "NonArthroInvert")$ATV
log10ATV &lt;- log10(subset(endosulfan, group == "NonArthroInvert")$ATV)
fln &lt;- fitdist(log10ATV, "norm")
quantile(fln, probs = c(0.05, 0.1, 0.2))
bln &lt;- bootdist(fln, bootmethod="param", niter=101)
quantile(bln, probs = c(0.05, 0.1, 0.2))
quantile(bln, probs = c(0.05, 0.1, 0.2), CI.type = "greater")
quantile(bln, probs = c(0.05, 0.1, 0.2), CI.level = 0.9)

# (2) Draw of 95 percent confidence intervals on quantiles of the 
# previously fitted distribution
#
cdfcomp(fln)
q1 &lt;- quantile(bln, probs = seq(0,1,length=101))
points(q1$quantCI[1,],q1$probs,type="l")
points(q1$quantCI[2,],q1$probs,type="l")

# (2b) Draw of 95 percent confidence intervals on quantiles of the 
# previously fitted distribution
# using the NEW function CIcdfplot
#
CIcdfplot(bln, CI.output = "quantile", CI.fill = "pink")

# (3) Fit of a distribution on acute salinity log-transformed tolerance 
# for riverine macro-invertebrates, using maximum likelihood estimation
# to estimate what is called a species sensitivity distribution 
# (SSD) in ecotoxicology, followed by estimation of the 5, 10 and 20 percent quantile
# values of the fitted distribution, which are called the 5, 10, 20 percent hazardous 
# concentrations (HC5, HC10, HC20) in ecotoxicology, followed with calculations of 
# their confidence intervals with various definitions.
# from a small number of bootstrap iterations to satisfy CRAN running times constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.
#
data(salinity)
log10LC50 &lt;-log10(salinity)
flncens &lt;- fitdistcens(log10LC50,"norm")
quantile(flncens, probs = c(0.05, 0.1, 0.2))
blncens &lt;- bootdistcens(flncens, niter = 101)
quantile(blncens, probs = c(0.05, 0.1, 0.2))
quantile(blncens, probs = c(0.05, 0.1, 0.2), CI.type = "greater")
quantile(blncens, probs = c(0.05, 0.1, 0.2), CI.level = 0.9)
</code></pre>

<hr>
<h2 id='salinity'>Species-Sensitivity Distribution (SSD) for salinity tolerance</h2><span id='topic+salinity'></span>

<h3>Description</h3>

<p>72-hour acute salinity tolerance (LC50 values) of riverine macro-invertebrates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(salinity)</code></pre>


<h3>Format</h3>

 
<p><code>salinity</code> is a data frame with 2 columns named left and right, describing
each observed LC50 value (in electrical condutivity, millisiemens per centimeter) as an interval. 
The left column contains either NA for left censored observations, the left bound of the interval 
for interval censored observations, or the observed value for non-censored observations. The right
column contains either NA for right censored observations, the right bound of the interval
for interval censored observations, or the observed value for noncensored observations.
</p>


<h3>Source</h3>

 
<p>Kefford, B.J., Nugegoda, D., Metzeling, L., Fields, E. 2006. Validating species sensitivity
distributions using salinity tolerance of riverine macroinvertebrates in
the southern Murray-darling Basin (Vitoria, Australia). <em>Canadian Journal of Fisheries
and Aquatic Science</em>, <b>63</b>, 1865-1877.</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load of data
#
data(salinity)

# (2) plot of data using Turnbull cdf plot
#
log10LC50 &lt;- log10(salinity)
plotdistcens(log10LC50)

# (3) fit of a normal and a logistic distribution to data in log10
# (classical distributions used for species sensitivity 
# distributions, SSD, in ecotoxicology))
# and visual comparison of the fits using Turnbull cdf plot 
#
fln &lt;- fitdistcens(log10LC50, "norm")
summary(fln)

fll &lt;- fitdistcens(log10LC50, "logis")
summary(fll)

cdfcompcens(list(fln, fll),legendtext = c("normal", "logistic"),
    xlab = "log10(LC50)", xlim = c(0.5, 2), lines01 = TRUE)

# (4) estimation of the 5 percent quantile value of 
# the normal fitted distribution (5 percent hazardous concentration  : HC5)
# with its two-sided 95 percent confidence interval calculated by 
# non parametric bootstrap
# from a small number of bootstrap iterations to satisfy CRAN running times constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.
#
# in log10(LC50)
bln &lt;- bootdistcens(fln, niter = 101)
HC5ln &lt;- quantile(bln, probs = 0.05)
# in LC50
10^(HC5ln$quantiles)
10^(HC5ln$quantCI)

# (5) estimation of the HC5 value
# with its one-sided 95 percent confidence interval (type "greater")
#
# in log10(LC50)
HC5lnb &lt;- quantile(bln, probs = 0.05, CI.type = "greater")

# in LC50
10^(HC5lnb$quantiles)
10^(HC5lnb$quantCI)

</code></pre>

<hr>
<h2 id='smokedfish'>Contamination data of Listeria monocytogenes in smoked fish</h2><span id='topic+smokedfish'></span>

<h3>Description</h3>

<p>Contamination data of <em>Listeria monocytogenes</em> in smoked fish on the Belgian market in the period 2005 to 2007.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(smokedfish)</code></pre>


<h3>Format</h3>

 
<p><code>smokedfish</code> is a data frame with 2 columns named left and right, describing
each observed value of <em>Listeria monocytogenes</em> concentration (in CFU/g) as an interval. 
The left column contains either NA for
left censored observations, the left bound of the interval for interval censored
observations, or the observed value for non-censored observations. The right
column contains either NA for right censored observations, the right bound of
the interval for interval censored observations, or the observed value for non-censored
observations.
</p>


<h3>Source</h3>

<p>Busschaert, P., Geereard, A.H., Uyttendaele, M., Van Impe, J.F., 2010. 
Estimating distributions out of qualitative and (semi) quantitative microbiological 
contamination data for use in risk assessment. <em>International Journal of Food Microbiology</em>. 
<b>138</b>, 260-269.</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load of data
#
data(smokedfish)

# (2) plot of data in CFU/g
#
plotdistcens(smokedfish)

# (3) plot of transformed data in log10[CFU/g]
#
Clog10 &lt;- log10(smokedfish)
plotdistcens(Clog10)

# (4) Fit of a normal distribution to data in log10[CFU/g]
#
fitlog10 &lt;- fitdistcens(Clog10, "norm")
summary(fitlog10)
plot(fitlog10)
</code></pre>

<hr>
<h2 id='Surv2fitdistcens'>Handling of data formated as in the survival package for use in fitdistcens()</h2><span id='topic+Surv2fitdistcens'></span>

<h3>Description</h3>

<p>Provide a function to prepare a data frame needed by fitdistcens() from 
data classically coded when using the Surv() function of the survival
package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Surv2fitdistcens(time, time2, event,
                      type = c('right', 'left', 'interval', 'interval2'))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Surv2fitdistcens_+3A_time">time</code></td>
<td>
<p>for right censored data, this is the follow up time. 
For interval data, the first argument is the starting time for the interval.</p>
</td></tr>
<tr><td><code id="Surv2fitdistcens_+3A_event">event</code></td>
<td>
<p>The status indicator, normally <code>0</code>=alive, <code>1</code>=dead. Other choices 
are <code>TRUE/FALSE</code> (<code>TRUE</code> = death) or <code>1/2</code> (<code>2</code>=death). 
For interval censored data, the status indicator is <code>0</code>=right censored, 
<code>1</code>=event at time, <code>2</code>=left censored, <code>3</code>=interval censored. 
For factor data, assume that it has only two levels with the second level
coding death.</p>
</td></tr>
<tr><td><code id="Surv2fitdistcens_+3A_time2">time2</code></td>
<td>
<p>ending time of the interval for interval censored. 
Intervals are assumed to be open on the left and closed 
on the right, (start, end].</p>
</td></tr>
<tr><td><code id="Surv2fitdistcens_+3A_type">type</code></td>
<td>
<p>character string specifying the type of censoring. Possible 
values are <code>"right"</code>, <code>"left"</code>, <code>"interval"</code>, <code>"interval2"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Surv2fitdistcens</code> makes a <code>data.frame</code> with two columns
respectively named <code>left</code> and <code>right</code>, describing each observed 
value as an interval as required in fitdistcens(): 
the <code>left</code> column contains either <code>NA</code> 
for left-censored observations, the left bound of the interval for 
interval-censored observations, or the observed value for non-censored observations.
The right column contains either <code>NA</code> for right-censored observations, 
the right bound of the interval for interval censored observations, 
or the observed value for non-censored observations.
</p>


<h3>Value</h3>

 
<p><code>Surv2fitdistcens</code> returns a data.frame with two columns 
respectively named <code>left</code> and <code>right</code>.
</p>


<h3>Author(s)</h3>

 
<p>Christophe Dutang and Marie-Laure Delignette-Muller.
</p>


<h3>References</h3>

 
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+fitdistrplus">fitdistrplus</a></code> for an overview of the package.
See <code><a href="#topic+fitdistcens">fitdistcens</a></code> for fitting of univariate distributions to censored data
and <code><a href="#topic+fremale">fremale</a></code> for the full dataset used in examples below.
See <code><a href="survival.html#topic+Surv">Surv</a></code> for survival objects which use the same arguments.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) randomized fictive survival data - right-censored
#
origdata &lt;- data.frame(rbind(
c(   43.01, 55.00,     0),
c(   36.37, 47.17,     0),
c(   33.10, 34.51,     0),
c(   71.00, 81.15,     1),
c(   80.89, 81.91,     1),
c(   67.81, 78.48,     1),
c(   73.98, 76.92,     1),
c(   53.19, 54.80,     1)))
colnames(origdata) &lt;- c("AgeIn", "AgeOut", "Death")

# add of follow-up time (for type = "right" in Surv())
origdata$followuptime &lt;- origdata$AgeOut - origdata$AgeIn
origdata

### use of default survival type "right"
# in Surv()
survival::Surv(time = origdata$followuptime, event = origdata$Death, type = "right")
# for fitdistcens()
Surv2fitdistcens(origdata$followuptime, event = origdata$Death, type = "right")

# use of survival type "interval" 
# in Surv()
survival::Surv(time = origdata$followuptime, time2 = origdata$followuptime, 
          event = origdata$Death, type = "interval")
# for fitdistcens()
Surv2fitdistcens(time = origdata$followuptime, time2 = origdata$followuptime, 
          event = origdata$Death, type = "interval") 

# use of survival type "interval2" 
origdata$survivalt1 &lt;- origdata$followuptime
origdata$survivalt2 &lt;- origdata$survivalt1
origdata$survivalt2[1:3] &lt;- Inf
origdata
survival::Surv(time = origdata$survivalt1, time2 = origdata$survivalt2, 
type = "interval2")
Surv2fitdistcens(origdata$survivalt1, time2 = origdata$survivalt2, 
                type = "interval2")


# (2) Other examples with various left, right and interval censored values
#
# with left censored data
(d1 &lt;- data.frame(time = c(2, 5, 3, 7), ind = c(0, 1, 1, 1)))
survival::Surv(time = d1$time, event = d1$ind, type = "left")
Surv2fitdistcens(time = d1$time, event = d1$ind, type = "left")

(d1bis &lt;- data.frame(t1 = c(2, 5, 3, 7), t2 = c(2, 5, 3, 7), 
  censtype = c(2, 1, 1, 1)))
survival::Surv(time = d1bis$t1, time2 = d1bis$t2, 
  event = d1bis$censtype, type = "interval")
Surv2fitdistcens(time = d1bis$t1, time2 = d1bis$t2, 
  event = d1bis$censtype, type = "interval")

# with interval, left and right censored data
(d2 &lt;- data.frame(t1 = c(-Inf, 2, 3, 4, 3, 7), t2 = c(2, 5, 3, 7, 8, Inf)))
survival::Surv(time = d2$t1, time2 = d2$t2, type = "interval2")
Surv2fitdistcens(time = d2$t1, time2 = d2$t2, type = "interval2")

(d2bis &lt;- data.frame(t1 = c(2, 2, 3, 4, 3, 7), t2 = c(2, 5, 3, 7, 8, 7), 
  censtype = c(2,3,1,3,3,0)))
survival::Surv(time = d2bis$t1, time2 = d2bis$t2, 
  event = d2bis$censtype, type = "interval")
Surv2fitdistcens(time = d2bis$t1, time2 = d2bis$t2, 
  event = d2bis$censtype, type = "interval")
</code></pre>

<hr>
<h2 id='toxocara'>Parasite abundance in insular feral cats</h2><span id='topic+toxocara'></span>

<h3>Description</h3>

<p>Toxocara cati abundance in feral cats living on Kerguelen island.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toxocara)</code></pre>


<h3>Format</h3>

<p><code>toxocara</code> is a data frame with 1 column (number: number of parasites in digestive tract)</p>


<h3>Source</h3>

 
<p>Fromont, E., Morvilliers, L., Artois, M., Pontier, D. 2001. Parasite richness and abundance in insular 
and mainland feral cats. <em>Parasitology</em>, <b>123</b>, 143-151.</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load of data
#
data(toxocara)

# (2) description and plot of data
#
number &lt;- toxocara$number
descdist(number, discrete = TRUE, boot = 11)
plotdist(number, discrete = TRUE)

# (3) fit of a Poisson distribution to data
#
fitp &lt;- fitdist(number, "pois")
summary(fitp)
plot(fitp)

# (4) fit of a negative binomial distribution to data
#
fitnb &lt;- fitdist(number, "nbinom")
summary(fitnb)
plot(fitnb)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
