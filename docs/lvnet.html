<!DOCTYPE html><html><head><title>Help for package lvnet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lvnet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EBIClvglasso'>
<p>Latent variable graphical LASSO using EBIC to select optimal tuning parameter</p></a></li>
<li><a href='#lassoSelect'>
<p>Update lvnatLasso results to select a different model</p></a></li>
<li><a href='#lav2lvnet'>
<p>Convert lavaan model to lvnet model matrices</p></a></li>
<li><a href='#lvglasso'>
<p>Latent variable graphical LASSO</p></a></li>
<li><a href='#lvnet'>
<p>Confirmatory Latent Variable Network Models</p></a></li>
<li><a href='#lvnetCompare'>
<p>Compare lvnet objects</p></a></li>
<li><a href='#lvnetLasso'>
<p>LASSO model selection</p></a></li>
<li><a href='#lvnetRefit'>
<p>Refit lvnet model to new data</p></a></li>
<li><a href='#lvnetSearch'>
<p>Step-wise exploratory search for optimal fitting model</p></a></li>
<li><a href='#plot.lvnet'>
<p>Plot model matrices</p></a></li>
<li><a href='#summary.lvnet'>
<p>Summary method for lvnet</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Latent Variable Network Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.5</td>
</tr>
<tr>
<td>Author:</td>
<td>Sacha Epskamp</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate, fit and compare Structural Equation Models (SEM) and network models (Gaussian Graphical Models; GGM) using OpenMx. Allows for two possible generalizations to include GGMs in SEM: GGMs can be used between latent variables (latent network modeling; LNM) or between residuals (residual network modeling; RNM). For details, see Epskamp, Rhemtulla and Borsboom (2017) &lt;<a href="https://doi.org/10.1007%2Fs11336-017-9557-x">doi:10.1007/s11336-017-9557-x</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>glasso, qgraph, Matrix, psych, mvtnorm, parallel, corpcor,
dplyr, methods, lavaan, semPlot</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), OpenMx</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-06-21 07:07:28 UTC; sachaepskamp</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-06-21 07:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='EBIClvglasso'>
Latent variable graphical LASSO using EBIC to select optimal tuning parameter
</h2><span id='topic+EBIClvglasso'></span>

<h3>Description</h3>

<p>This function minimizes the Extended Bayesian Information Criterion (EBIC; Chen and Chen, 2008) to choose the lvglasso tuning parameter. See <code><a href="#topic+lvglasso">lvglasso</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EBIClvglasso(S, n, nLatents, gamma = 0.5, nRho = 100, lambda, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EBIClvglasso_+3A_s">S</code></td>
<td>

<p>Sample variance-covariance matrix
</p>
</td></tr>
<tr><td><code id="EBIClvglasso_+3A_n">n</code></td>
<td>

<p>Sample Size
</p>
</td></tr>
<tr><td><code id="EBIClvglasso_+3A_nlatents">nLatents</code></td>
<td>

<p>Number of latent variables
</p>
</td></tr>
<tr><td><code id="EBIClvglasso_+3A_gamma">gamma</code></td>
<td>

<p>EBIC hyper-parameter
</p>
</td></tr>
<tr><td><code id="EBIClvglasso_+3A_nrho">nRho</code></td>
<td>

<p>Number of tuning parameters to test
</p>
</td></tr>
<tr><td><code id="EBIClvglasso_+3A_lambda">lambda</code></td>
<td>

<p>The lambda argument containing factor loadings, only used for starting values!
</p>
</td></tr>
<tr><td><code id="EBIClvglasso_+3A_...">...</code></td>
<td>

<p>Arguments sent to <code><a href="#topic+lvglasso">lvglasso</a></code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The optimal result of <code><a href="#topic+lvglasso">lvglasso</a></code>, with two more elements:
</p>
<table>
<tr><td><code>rho</code></td>
<td>
<p>The selected tuning parameter</p>
</td></tr>
<tr><td><code>ebic</code></td>
<td>
<p>The optimal EBIC</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>References</h3>

<p>Chen, J., &amp; Chen, Z. (2008). Extended Bayesian information criteria for model selection with large model spaces. Biometrika, 95(3), 759-771.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lvglasso">lvglasso</a></code>
</p>

<hr>
<h2 id='lassoSelect'>
Update lvnatLasso results to select a different model
</h2><span id='topic+lassoSelect'></span>

<h3>Description</h3>

<p>This function can be used to select a model using any fit index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lassoSelect(object, select, minimize = TRUE, refit = TRUE, lassoTol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lassoSelect_+3A_object">object</code></td>
<td>

<p>An <code>lvnetLasso</code> object
</p>
</td></tr>
<tr><td><code id="lassoSelect_+3A_select">select</code></td>
<td>

<p>A raw R expression using names used in the <code>object$fitMeasures</code> part of the output of <code>lvnet</code>
</p>
</td></tr>
<tr><td><code id="lassoSelect_+3A_minimize">minimize</code></td>
<td>

<p>Logical. Minimize or maximize?
</p>
</td></tr>
<tr><td><code id="lassoSelect_+3A_refit">refit</code></td>
<td>

<p>Logical. Should the new best model be refitted.
</p>
</td></tr>
<tr><td><code id="lassoSelect_+3A_lassotol">lassoTol</code></td>
<td>

<p>Tolerance for absolute values to be treated as zero in counting parameters.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load dataset:
library("lavaan")
data(HolzingerSwineford1939)
Data &lt;- HolzingerSwineford1939[,7:15]

# Measurement model:
Lambda &lt;- matrix(0, 9, 3)
Lambda[1:3,1] &lt;- NA
Lambda[4:6,2] &lt;- NA
Lambda[7:9,3] &lt;- NA

# Search best fitting omega_theta:
res &lt;- lvnetLasso(Data, "omega_theta", lambda = Lambda)
res$best
summary(res)

# Update to use EBIC:
resEBIC &lt;- lassoSelect(res, ebic)
summary(resEBIC)

# Update to use minimal fitting model with RMSEA &lt; 0.05:
resMinimal &lt;- lassoSelect(res, df * (rmsea &lt; 0.05), minimize = FALSE)
summary(resMinimal)

## End(Not run)
</code></pre>

<hr>
<h2 id='lav2lvnet'>
Convert lavaan model to lvnet model matrices
</h2><span id='topic+lav2lvnet'></span>

<h3>Description</h3>

<p>This function can be used to easily generate input matrices for lvnet based on a lavaan model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lav2lvnet(model, data, std.lv = TRUE, lavaanifyOps = list(auto = TRUE, std.lv = std.lv))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lav2lvnet_+3A_model">model</code></td>
<td>

<p>Lavaan model syntax
</p>
</td></tr>
<tr><td><code id="lav2lvnet_+3A_data">data</code></td>
<td>

<p>The dataset. Only used to extract order of variables names from the columnnames.
</p>
</td></tr>
<tr><td><code id="lav2lvnet_+3A_std.lv">std.lv</code></td>
<td>

<p>Should the model be identified by constraining latent variable variance to 1. Defaults to <code>TRUE</code> unlike lavaan! This is because the starting values work better for this identification.
</p>
</td></tr>
<tr><td><code id="lav2lvnet_+3A_lavaanifyops">lavaanifyOps</code></td>
<td>

<p>A list with other options sent to <code><a href="lavaan.html#topic+lavaanify">lavaanify</a></code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the model matrices for <code>lambda</code>, <code>psi</code>, <code>theta</code> and  <code>beta</code>
</p>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("lavaan")

# Load dataset:
data(HolzingerSwineford1939)
Data &lt;- HolzingerSwineford1939[,7:15]

# lavaan model
HS.model &lt;- '
visual  =~ x1 + x2 + x3
textual =~ x4 + x5 + x6
speed   =~ x7 + x8 + x9 '

# fit via lavaan:
lavFit &lt;- cfa(HS.model, HolzingerSwineford1939[7:15],std.lv=TRUE)

# Fit via lvnet:
mod &lt;- lav2lvnet(HS.model, HolzingerSwineford1939[7:15])
lvnetFit &lt;- lvnet(Data, lambda = mod$lambda, psi = mod$psi)

# Compare:
Compare &lt;- data.frame(
  lvnet = round(unlist(lvnetFit$fitMeasures)[c("npar","df","chisq","fmin","aic","bic",
                                              "rmsea","cfi","tli","nfi","logl")],3),
  lavaan = round(fitMeasures(lavFit)[c("npar","df","chisq","fmin","aic","bic","rmsea",
                                      "cfi","tli","nfi","logl")],3))

Compare

## End(Not run)
</code></pre>

<hr>
<h2 id='lvglasso'>
Latent variable graphical LASSO
</h2><span id='topic+lvglasso'></span>

<h3>Description</h3>

<p>The lvglasso algorithm to estimate network structures containing latent variables, as proposed by Yuan (2012). Uses the glasso package (Friedman, Hastie and Tibshirani, 2014) and mimics input and output of the <code><a href="glasso.html#topic+glasso">glasso</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lvglasso(S, nLatents, rho = 0, thr = 1e-04, maxit = 10000, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lvglasso_+3A_s">S</code></td>
<td>

<p>Sample variance-covariance matrix
</p>
</td></tr>
<tr><td><code id="lvglasso_+3A_nlatents">nLatents</code></td>
<td>

<p>Number of latent variables.
</p>
</td></tr>
<tr><td><code id="lvglasso_+3A_rho">rho</code></td>
<td>

<p>The LASSO tuning parameter
</p>
</td></tr>
<tr><td><code id="lvglasso_+3A_thr">thr</code></td>
<td>

<p>The threshold to use for convergence
</p>
</td></tr>
<tr><td><code id="lvglasso_+3A_maxit">maxit</code></td>
<td>

<p>Maximum number of iterations
</p>
</td></tr>
<tr><td><code id="lvglasso_+3A_lambda">lambda</code></td>
<td>

<p>The lambda argument containing factor loadings, only used for starting values!</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>lvglasso</code> containing the following elements:
</p>
<table>
<tr><td><code>w</code></td>
<td>
<p>The estimated variance-covariance matrix of both observed and latent variables</p>
</td></tr>
<tr><td><code>wi</code></td>
<td>
<p>The estimated inverse variance-covariance matrix of both observed and latent variables</p>
</td></tr>
<tr><td><code>pcor</code></td>
<td>
<p>Estimated partial correlation matrix of both observed and latent variables</p>
</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>Logical vector indicating which elements of w, wi and pcor are observed</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>The number of iterations used</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The estimated lambda matrix, when result is transformed to EFA model</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>The estimated theta matrix</p>
</td></tr>
<tr><td><code>omega_theta</code></td>
<td>
<p>The estimated omega_theta matrix</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>The estimated psi matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>References</h3>

<p>Yuan, M.  (2012).  Discussion:  Latent variable graphical model selection via convex optimization.The Annals of Statistics,40, 1968-1972.
</p>
<p>Jerome Friedman, Trevor Hastie and Rob Tibshirani (2014). glasso: Graphical lasso-estimation of Gaussian graphical models. R package version 1.8. http://CRAN.R-project.org/package=glasso
</p>

<hr>
<h2 id='lvnet'>
Confirmatory Latent Variable Network Models
</h2><span id='topic+lvnet'></span>

<h3>Description</h3>

<p>This function utilizes OpenMx (Boker et al., 2011, 2014) to confirmatory test latent variable network models between P manifests and M latents. See the details section for information about the modeling framework used. All the input matrices can be assigned R matrices with numbers indicating fixed values and NA indicating a value is free to estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lvnet(data, lambda, beta, omega_theta, delta_theta, omega_psi, delta_psi, psi, theta, 
        sampleSize, fitInd, fitSat, startValues = list(), scale = FALSE, nLatents,
        lasso = 0,  lassoMatrix, lassoTol = 1e-4, ebicTuning = 0.5, 
        mimic = c("lavaan","lvnet"), fitFunction = c("penalizedML", "ML"), exogenous)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lvnet_+3A_data">data</code></td>
<td>

<p>An N (sample size) x P matrix or data frame containing the raw data, or a P x P variance-covariance matrix.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_lambda">lambda</code></td>
<td>

<p>A P x M matrix indicating factor loadings. Defaults to a full NA P x M matrix if psi or omega_psi is not missing, or a P x 0 dummy matrix.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_beta">beta</code></td>
<td>

<p>An M x M  matrix indicating linear effects between latent variables. Defaults to an M x M  matrix containing only zeroes.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_omega_theta">omega_theta</code></td>
<td>

<p>A P x P matrix encoding the residual network structure. By default, theta is modeled instead.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_delta_theta">delta_theta</code></td>
<td>

<p>A P x P diagonal scaling matrix. Defaults to NA on all diagonal elements. Only used if omega_theta is modeled.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_omega_psi">omega_psi</code></td>
<td>

<p>An M x M  matrix containing the latent network structure. Dy default, psi is modeled instead.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_delta_psi">delta_psi</code></td>
<td>

<p>A diagonal M x M scaling matrix. Defaults to an identity matrix. Only used if omega_psi is modeled.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_psi">psi</code></td>
<td>

<p>An M x M  variance-covariance matrix between latents and latent residuals. Defaults to a full NA matrix.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_theta">theta</code></td>
<td>

<p>A P x P variance-covariance matrix of residuals of the observed variables. Defaults to a diagonal matrix containing NAs
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_samplesize">sampleSize</code></td>
<td>

<p>The sample size, only used if <code>data</code> is assigned a variance-covariance matrix.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_fitind">fitInd</code></td>
<td>

<p>The fit of the independence model. Used to speed up estimation fitting multiple models.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_fitsat">fitSat</code></td>
<td>

<p>The fit of the saturated model. Used to speed up estimation fitting multiple models.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_startvalues">startValues</code></td>
<td>

<p>An optional named list containing starting values of each model. e.g., <code>list(lambda = matrix(1,9,3))</code> would set the starting values of a 10 x 3 lambda matrix to ones.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_scale">scale</code></td>
<td>

<p>Logical, should data be standardized before running lvnet?
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_nlatents">nLatents</code></td>
<td>

<p>The number of latents. Allows for quick specification when <code>lambda</code> is missing. Not needed is <code>lambda</code> is assigned.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_lasso">lasso</code></td>
<td>

<p>The LASSO tuning parameter.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_lassomatrix">lassoMatrix</code></td>
<td>

<p>Character vector indicating the names of matrices to apply LASSO regularization on. e.g., <code>"omega_psi"</code> or  <code>"omega_theta"</code>.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_lassotol">lassoTol</code></td>
<td>

<p>Tolerance for absolute values to be treated as zero in counting parameters.
</p>
</td></tr>
<tr><td><code id="lvnet_+3A_ebictuning">ebicTuning</code></td>
<td>
<p>Tuning parameter used in extended Bayesian Information Criterion.</p>
</td></tr>
<tr><td><code id="lvnet_+3A_mimic">mimic</code></td>
<td>
<p>If set to <code>"lavaan"</code> (default), covariance matrix is rescaled and N is used rather than N - 1 in likelihood computation.</p>
</td></tr>
<tr><td><code id="lvnet_+3A_fitfunction">fitFunction</code></td>
<td>
<p>The fit function to be used. <code>penalizedML</code> will fit the penalized fit function and <code>ML</code> the maximum likelihood function.</p>
</td></tr>
<tr><td><code id="lvnet_+3A_exogenous">exogenous</code></td>
<td>
<p>Numeric vector indicating which variables are exogenous.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The modeling framework follows the all-y LISREL framework for Structural Equation Models (SEM; Hayduk, 1987) to model relationships between P observed variables and M latent variables:
</p>
<p>sigma = lambda * (I - beta)^(-1) psi (I - beta)^(-1 T) * lambda^T + theta
</p>
<p>Where Sigma is the P x P model-implied covariance matrix, lambda a P x M matrix of factor loadings, B an M x M matrix containing regression effects between latent variables, Psi a M x M covariance matrix of the latent variables/residuals and Theta a P x P covariance matrix of residuals of the observed indicators.
</p>
<p>The lvnet function allows for two extensions of this modeling framework. First, psi can be chosen to be modeled as follows:
</p>
<p>psi = delta_psi (I - omega_psi)^(-1) delta_psi
</p>
<p>In which delta_psi is a M x M diagonal scaling matrix and omega_psi a M x M matrix containing zeroes on the diagonal and partial correlation coefficients on the offdiagonal values of two latent variables conditioned on all other latent variables. omega_psi therefore corresponds to a Gaussian Graphical Model, or a network structure.
</p>
<p>Similarly, theta can be chosen to be modeled as follows:
</p>
<p>theta = delta_theta (I - omega_theta)^(-1) delta_theta
</p>
<p>In which delta_theta is a P x P diagonal scaling matrix and omega_theta a P x P matrix containing zeroes on the diagonal and partial correlation coefficients on the offdiagonal values of two residuals conditioned on all other residuals.
</p>
<p>Modeling  omega_psi is termed Latent Network Modeling (LNM) and modeling omega_theta is termed Residual Network Modeling (RNM). lvnet automatically chooses the appropriate modeling framework based on the input.
</p>


<h3>Value</h3>

<p>An <code>lvnet</code> object, which is a list containing the following elements:
</p>
<table>
<tr><td><code>matrices</code></td>
<td>
<p>A list containing thee estimated model matrices</p>
</td></tr>
<tr><td><code>sampleStats</code></td>
<td>
<p>A list containing the covariance matrix (<code>covMat</code>) and sample size <code>sampleSize</code></p>
</td></tr>
<tr><td><code>mxResults</code></td>
<td>
<p>The OpenMx object of the fitted model</p>
</td></tr>
<tr><td><code>fitMeasures</code></td>
<td>
<p>A named list containing the fit measures of the fitted model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>References</h3>

<p>Boker, S. M., Neale, M., Maes, H., Wilde, M., Spiegel, M., Brick, T., ... Fox, J. (2011).  OpenMx:  an open source extended structural equation modelingframework. Psychometrika, 76(2), 306-317
</p>
<p>Boker, S. M., Neale, M. C., Maes, H. H., Wilde, M. J., Spiegel, M., Brick, T. R., ..., Team OpenMx. (2014). Openmx 2.0 user guide [Computer software manual].
</p>
<p>Hayduk, L. A.  (1987).Structural equation modeling with LISREL: Essentials advances.  Baltimore, MD, USA: Johns Hopkins University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lvnetSearch">lvnetSearch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load dataset:
library("lavaan")
data(HolzingerSwineford1939)
Data &lt;- HolzingerSwineford1939[,7:15]

# Measurement model:
Lambda &lt;- matrix(0, 9, 3)
Lambda[1:3,1] &lt;- NA
Lambda[4:6,2] &lt;- NA
Lambda[7:9,3] &lt;- NA

# Fit CFA model:
CFA &lt;- lvnet(Data, lambda = Lambda)

# Latent network:
Omega_psi &lt;- matrix(c(
  0,NA,NA,
  NA,0,0,
  NA,0,0
),3,3,byrow=TRUE)

# Fit model:
LNM &lt;- lvnet(Data, lambda = Lambda, omega_psi=Omega_psi)

# Compare fit:
lvnetCompare(cfa=CFA,lnm=LNM)

# Summary:
summary(LNM)

# Plot latents:
plot(LNM, "factorStructure")
</code></pre>

<hr>
<h2 id='lvnetCompare'>
Compare lvnet objects
</h2><span id='topic+lvnetCompare'></span><span id='topic+anova.lvnet'></span>

<h3>Description</h3>

<p>Compares several results of <code><a href="#topic+lvnet">lvnet</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lvnetCompare(...)
## S3 method for class 'lvnet'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lvnetCompare_+3A_object">object</code></td>
<td>
<p>An <code>lvnet</code> object</p>
</td></tr>
<tr><td><code id="lvnetCompare_+3A_...">...</code></td>
<td>

<p>Any number of <code>lvnet</code> objects. Arguments can be named to make the resulting table named.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lvnet">lvnet</a></code>
</p>

<hr>
<h2 id='lvnetLasso'>
LASSO model selection
</h2><span id='topic+lvnetLasso'></span>

<h3>Description</h3>

<p>This function runs <code>lvnet</code> for a number of different tuning parameters, selects the best model based on some criterion and refits that model to obtain accurate parameter estimates. The <code><a href="#topic+lassoSelect">lassoSelect</a></code> function can afterwards be used to select a different model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lvnetLasso(data, lassoMatrix, lassoTol = 1e-04, nTuning = 20, 
  tuning.min = 0.01, tuning.max = 0.5, criterion = c("bic", "aic", 
  "ebic"), verbose = TRUE, refitFinal = TRUE, refitAll = FALSE, 
  nCores = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lvnetLasso_+3A_data">data</code></td>
<td>

<p>The data argument as used in <code><a href="#topic+lvnet">lvnet</a></code>
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_lassomatrix">lassoMatrix</code></td>
<td>

<p>Vector indicating the matrix or matrices to use in LASSO optmimization
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_lassotol">lassoTol</code></td>
<td>

<p>Tolerance for absolute values to be treated as zero in counting parameters.
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_ntuning">nTuning</code></td>
<td>

<p>Number of tuning parameters to estimate. 
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_tuning.min">tuning.min</code></td>
<td>

<p>Minimal tuning parameter
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_tuning.max">tuning.max</code></td>
<td>

<p>Maximal tuning parameter
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_criterion">criterion</code></td>
<td>

<p>Criterion to use in model selection
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_verbose">verbose</code></td>
<td>

<p>Should progress be printed to the console?
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_refitfinal">refitFinal</code></td>
<td>

<p>Logical, should the best fitting model be refitted without LASSO regularization?
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_refitall">refitAll</code></td>
<td>

<p>Logical, should *all* models be refitted without LASSO regularization (but with zeroes constrained) before evaluating fit criterium?
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_ncores">nCores</code></td>
<td>

<p>Number of cores to use in parallel computing.
</p>
</td></tr>
<tr><td><code id="lvnetLasso_+3A_...">...</code></td>
<td>

<p>Arguments sent to <code><a href="#topic+lvnet">lvnet</a></code>
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load dataset:
library("lavaan")
data(HolzingerSwineford1939)
Data &lt;- HolzingerSwineford1939[,7:15]

# Measurement model:
Lambda &lt;- matrix(0, 9, 3)
Lambda[1:3,1] &lt;- NA
Lambda[4:6,2] &lt;- NA
Lambda[7:9,3] &lt;- NA

# Search best fitting omega_theta:
## Not run: 
res &lt;- lvnetLasso(Data, "omega_theta", lambda = Lambda)
res$best
summary(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='lvnetRefit'>
Refit lvnet model to new data
</h2><span id='topic+lvnetRefit'></span>

<h3>Description</h3>

<p>Obtain fit indices from the estimated model parameters on a new dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lvnetRefit(lvnetObject, data, sampleSize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lvnetRefit_+3A_lvnetobject">lvnetObject</code></td>
<td>

<p>Output of <code><a href="#topic+lvnet">lvnet</a></code>.
</p>
</td></tr>
<tr><td><code id="lvnetRefit_+3A_data">data</code></td>
<td>

<p>New dataset or variance-covariance matrix.
</p>
</td></tr>
<tr><td><code id="lvnetRefit_+3A_samplesize">sampleSize</code></td>
<td>

<p>Sample size (if <code>data</code> is a variance-covariance matrix).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>

<hr>
<h2 id='lvnetSearch'>
Step-wise exploratory search for optimal fitting model
</h2><span id='topic+lvnetSearch'></span>

<h3>Description</h3>

<p>Performs stepwise search to optimize the structure of omega_theta, omega_psi, theta or psi. Starts at empty or full structure and iteratively adds or removes edges to optimize the criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lvnetSearch(data, matrix = c("omega_theta", "omega_psi", "theta", "psi"), 
          criterion = c("bic", "ebic","chisq","aic"), 
          start =  c("default","empty","full"),  alpha = 0.05, lambda, sampleSize, 
          maxIter,  nCores = 1, maxChange = 1, ...,  verbose = TRUE, file, 
          startValues = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lvnetSearch_+3A_data">data</code></td>
<td>

<p>The data argument as used in <code><a href="#topic+lvnet">lvnet</a></code>
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_matrix">matrix</code></td>
<td>

<p>Character string indicating the matrix to be optimized. Can be <code>"omega_theta"</code>, <code>"omega_psi"</code>, <code>"theta"</code> and <code>"psi"</code>.
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_criterion">criterion</code></td>
<td>

<p>Character string indicating the criterion to be used. <code>"AIC"</code> and <code>"BIC"</code> optimize the AIC or BIC respectively, and <code>"chisq"</code> performs chi-square tests to see if adding an edge significantly improves model fit or removing an edges does not significantly reduce model fit.
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_start">start</code></td>
<td>

<p>A character string indicating the structure of the matrix at the start of the algorithm. <code>"empty"</code> starts with a matrix with only zeroes and <code>"full"</code> starts with a matrix in which all elements are free to estimate. <code>"lvglasso"</code> employs the lvglasso algorithm (<code><a href="#topic+EBIClvglasso">EBIClvglasso</a></code> to find a starting structure for omega_theta and <code>"glasso"</code> employs the glasso algorithm to find a starting point for omega_psi (<code><a href="qgraph.html#topic+EBICglasso">EBICglasso</a></code>). <code>"default"</code> will lead to a full matrix if omega_psi or psi is optimized, and an empty matrix if omega_theta or theta is optimized.
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_alpha">alpha</code></td>
<td>

<p>The alpha level for chi-square significance testing.
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_lambda">lambda</code></td>
<td>

<p>The lambda argument as used in <code><a href="#topic+lvnet">lvnet</a></code>
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_samplesize">sampleSize</code></td>
<td>

<p>The sample size, only used if <code>data</code> is a covariance matrix.
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_maxiter">maxIter</code></td>
<td>

<p>The maximum number of edges to test. Defaults to M(M-1)/2
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_ncores">nCores</code></td>
<td>

<p>Number of cores to use in parallel estimation.
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_maxchange">maxChange</code></td>
<td>

<p>Set to higher than one to change multiple edges in each run. Each iteration, maxChange is reset to max(number of changed edges - 1, 1). Can result in instable results when searching <code>"omega_theta"</code>.
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_...">...</code></td>
<td>

<p>Arguments sent to <code><a href="#topic+lvnet">lvnet</a></code>
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_verbose">verbose</code></td>
<td>

<p>Logical if progress should be printed to the consile.
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_file">file</code></td>
<td>

<p>An optional character string containing a file name to store temporary results in.
</p>
</td></tr>
<tr><td><code id="lvnetSearch_+3A_startvalues">startValues</code></td>
<td>

<p>A list containing start values as used in <code><a href="#topic+lvnet">lvnet</a></code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>lvnetSearch</code>, which is a list containing:
</p>
<table>
<tr><td><code>best</code></td>
<td>
<p>The <code>lvnet</code> object of the best fitting model</p>
</td></tr>
<tr><td><code>modList</code></td>
<td>
<p>A list containing the chain of fitted models</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>The number of iterations used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lvnet">lvnet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load dataset:
library("lavaan")
data(HolzingerSwineford1939)
Data &lt;- HolzingerSwineford1939[,7:15]

# Measurement model:
Lambda &lt;- matrix(0, 9, 3)
Lambda[1:3,1] &lt;- NA
Lambda[4:6,2] &lt;- NA
Lambda[7:9,3] &lt;- NA

# Search best fitting omega_psi:
## Not run: 
res &lt;- lvnetSearch(Data, "omega_psi", lambda = Lambda)
res$best

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.lvnet'>
Plot model matrices
</h2><span id='topic+plot.lvnet'></span><span id='topic+plot.lvnetSearch'></span><span id='topic+plot.lvnetLasso'></span>

<h3>Description</h3>

<p>Plot method for <code>lvnet</code>. For <code>lvnetSearch</code> and <code>lvnetLasso</code> objects this is simply defined as <code>plot(object$best, ...)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'lvnet'
plot(x, what = c("factorStructure", "residual", "latent"), partial, 
        layout = "circle", ...)
 ## S3 method for class 'lvnetLasso'
plot(x, ...)
 ## S3 method for class 'lvnetSearch'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.lvnet_+3A_x">x</code></td>
<td>

<p>An <code>lvnet</code> object.
</p>
</td></tr>
<tr><td><code id="plot.lvnet_+3A_what">what</code></td>
<td>

<p>What to plot? <code>"factorStructure"</code> plots the factor loadings and latent correlations or network. <code>"residual"</code> the residual correlations or network and <code>"latent"</code> the latent correlations or network.
</p>
</td></tr>
<tr><td><code id="plot.lvnet_+3A_partial">partial</code></td>
<td>

<p>Plot partial correlations instead of correlations? Defaults to <code>TRUE</code> if <code>omega_psi</code> or <code>omega_theta</code> is estimated.
</p>
</td></tr>
<tr><td><code id="plot.lvnet_+3A_layout">layout</code></td>
<td>

<p>The layour argument as used in <code><a href="qgraph.html#topic+qgraph">qgraph</a></code>
</p>
</td></tr>
<tr><td><code id="plot.lvnet_+3A_...">...</code></td>
<td>

<p>Arguments sent to <code><a href="qgraph.html#topic+qgraph">qgraph</a></code>
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>

<hr>
<h2 id='summary.lvnet'>
Summary method for lvnet
</h2><span id='topic+summary.lvnet'></span><span id='topic+summary.lvnetSearch'></span><span id='topic+summary.lvnetLasso'></span>

<h3>Description</h3>

<p>Plot method for <code>lvnet</code>. For <code>lvnetSearch</code> and <code>lvnetLasso</code> objects this is simply defined as <code>summary(object$best, ...)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'lvnet'
summary(object, include = c("input", "chisq", "infcrit", "fitindices", 
        "rmsea", "parests"), digits = 3, ...)
  ## S3 method for class 'lvnetLasso'
summary(object, ...)
 ## S3 method for class 'lvnetSearch'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.lvnet_+3A_object">object</code></td>
<td>

<p>An <code>lvnet</code> object
</p>
</td></tr>
<tr><td><code id="summary.lvnet_+3A_include">include</code></td>
<td>

<p>Vector indicating what to include? <code>"input"</code> for the input used, <code>"chisq"</code> for the chi-square fit, <code>"infcrit"</code> for information criteria, <code>"fitindices"</code> for fit indices,  <code>"rmsea"</code> for the RMSEA, ans <code>"parests"</code> for parameter estimates.
</p>
</td></tr>
<tr><td><code id="summary.lvnet_+3A_digits">digits</code></td>
<td>

<p>Number of digits to round to.
</p>
</td></tr>
<tr><td><code id="summary.lvnet_+3A_...">...</code></td>
<td>

<p>Not used.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
