<!DOCTYPE html><html><head><title>Help for package proccalibrad</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {proccalibrad}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adf'><p>Convert to data.frame, without factors</p></a></li>
<li><a href='#check_for_matching_geolocation_files_mod02nrt'><p>Checks that every MODIS calibrated radiance project HDF has a matching MOD03 file</p></a></li>
<li><a href='#extract_fn_from_path'><p>Get the filename from a path</p></a></li>
<li><a href='#run_swath2grid_mod02nrt'><p>Run MRTSwath swath2grid tool</p></a></li>
<li><a href='#slashslash'><p>Remove double slash (slash a slash)</p></a></li>
<li><a href='#write_MRTSwath_param_file_mod02nrt'><p>Write a parameter control file for MRTSwath</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extraction of Bands from MODIS Calibrated Radiances MOD02 NRT</td>
</tr>
<tr>
<td>Version:</td>
<td>0.14</td>
</tr>
<tr>
<td>Author:</td>
<td>Rishabh Gupta &lt;rishabh.uk@gmail.com&gt;, Nicholas J. Matzke</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rishabh Gupta &lt;rishabh.uk@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Package for processing downloaded MODIS Calibrated radiances
    Product HDF files. Specifically, MOD02 calibrated radiance product files, and
    the associated MOD03 geolocation files (for MODIS-TERRA). The package will be
    most effective if the user installs MRTSwath (MODIS Reprojection Tool for swath
    products; <a href="https://lpdaac.usgs.gov/tools/modis_reprojection_tool_swath">https://lpdaac.usgs.gov/tools/modis_reprojection_tool_swath</a>, and
    adds the directory with the MRTSwath executable to the default R PATH by editing
    ~/.Rprofile.</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>MRTSwath</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-07-28 18:03:02 UTC; 500028930</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-07-31 08:54:00</td>
</tr>
</table>
<hr>
<h2 id='adf'>Convert to data.frame, without factors</h2><span id='topic+adf'></span>

<h3>Description</h3>

<p>Shortcut for: <code>as.data.frame(x, row.names=NULL, stringsAsFactors=FALSE)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adf(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adf_+3A_x">x</code></td>
<td>
<p>matrix or other object transformable to data.frame</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is useful for dealing with errors due to
automatic conversion of some columns to factors.  Another solution may be to prepend
<code>options(stringsAsFactors = FALSE)</code> at the start of one's script, to turn off all default stringsAsFactors silliness.
</p>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = matrix(c(1,2,3,4,5,6), nrow=3, ncol=2)
adf(x)
</code></pre>

<hr>
<h2 id='check_for_matching_geolocation_files_mod02nrt'>Checks that every MODIS calibrated radiance project HDF has a matching MOD03 file</h2><span id='topic+check_for_matching_geolocation_files_mod02nrt'></span>

<h3>Description</h3>

<p>Each MOD02 calibrated radiance product file requires a corresponding
MOD03 geolocation file to be successfully processed with the MRTSwath tool.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_for_matching_geolocation_files_mod02nrt(moddir = getwd(),
  modtxt = "MOD02", geoloctxt = "MOD03", return_geoloc = FALSE,
  return_product = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_for_matching_geolocation_files_mod02nrt_+3A_moddir">moddir</code></td>
<td>
<p>the string describing the directory containing the MOD02 and MOD03 files; both must be in the same directory.  Default: getwd(), which gives the present working directory.</p>
</td></tr>
<tr><td><code id="check_for_matching_geolocation_files_mod02nrt_+3A_modtxt">modtxt</code></td>
<td>
<p>the text string indicating which HDF files are the MODIS calibrated radiance product (or hypothetically, other product). Default: MOD02 (MODIS calibrated radiance product)</p>
</td></tr>
<tr><td><code id="check_for_matching_geolocation_files_mod02nrt_+3A_geoloctxt">geoloctxt</code></td>
<td>
<p>the text string indicating which HDF files are the MODIS geolocation files (or hypothetically, another set of files). Default: MOD03</p>
</td></tr>
<tr><td><code id="check_for_matching_geolocation_files_mod02nrt_+3A_return_geoloc">return_geoloc</code></td>
<td>
<p>if TRUE, return the list of unmatched geolocation files (e.g. MOD03 )</p>
</td></tr>
<tr><td><code id="check_for_matching_geolocation_files_mod02nrt_+3A_return_product">return_product</code></td>
<td>
<p>if TRUE, return the list of unmatched product files (e.g. MOD02)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MRTSwath is the MRT (MODIS Reprojection Tool) for the MODIS
</p>
<p>E.g. this calibrated radiance file:
</p>
<p>MOD021KM.A2016209.0515.005.NRT.hdf
</p>
<p>...goes with this corresponding geolocation file:
</p>
<p>MOD03.A2016209.0515.005.NRT.hdf
</p>
<p>...which is a large file (~30 MB) containing detailed information
on the position, tilt, etc. of the MODIS satellite.
MRTSwath tool needs one of each, however.
</p>


<h3>Value</h3>

<p>data.frame of matching files; or a list of non-matching files, if <code>return_geoloc</code> or <code>return_product</code> are TRUE.
</p>


<h3>Author(s)</h3>

<p>Rishabh Gupta <a href="mailto:rishabh.uk@gmail.com">rishabh.uk@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Check your working directory
moddir = getwd()

# Here are some example MODIS files in mod02nrt/extdata/
# Code excluded from CRAN check because it depends on modiscdata
## Not run: 
library(devtools)
library(modiscdata)
moddir = system.file("extdata/2002raw/", package="modiscdata")

# You need to have some e.g. MOD files in it (from the MODIS-TERRA platform)
list.files(path=moddir, pattern="MOD")
list.files(path=moddir, pattern="MOD")

# Check for matches (for MODIS-TERRA platform)
check_for_matching_geolocation_files_mod02nrt(moddir=moddir, modtxt="MOD02", geoloctxt="MOD03",
 return_geoloc=FALSE, return_product=FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='extract_fn_from_path'>Get the filename from a path</h2><span id='topic+extract_fn_from_path'></span>

<h3>Description</h3>

<p>The filename is split on slashes, and the last item is taken; this should be just
the filename.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_fn_from_path(fn_with_path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_fn_from_path_+3A_fn_with_path">fn_with_path</code></td>
<td>
<p>The filename, with partial or full path</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>fn</code> The extracted filename
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fn_with_path = "/Library/Frameworks/R.framework/Versions/2.15/Resources/library/
MOD021KM.A2016209.0515.005.NRT.hdf"
extract_fn_from_path(fn_with_path)

</code></pre>

<hr>
<h2 id='run_swath2grid_mod02nrt'>Run MRTSwath swath2grid tool</h2><span id='topic+run_swath2grid_mod02nrt'></span>

<h3>Description</h3>

<p>MRTSwath is the &quot;MODIS Reprojection Tool for swath products&quot;.  See:
<a href="https://lpdaac.usgs.gov/tools/modis_reprojection_tool_swath">https://lpdaac.usgs.gov/tools/modis_reprojection_tool_swath</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_swath2grid_mod02nrt(mrtpath = "swath2grid", prmfn = "tmpMRTparams.prm",
  tifsdir, modfn, geoloc_fn, ul_lon, ul_lat, lr_lon, lr_lat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_swath2grid_mod02nrt_+3A_mrtpath">mrtpath</code></td>
<td>
<p>This is the path to the MRTSwath executable <code>swath2grid</code>. If your <code>~/.Rprofile</code>
file has the location of <code>swath2grid</code> in the PATH, then you can just use <code>mrtpath="swath2grid"</code>.
Otherwise, the user must provide the full path to swath2grid.</p>
</td></tr>
<tr><td><code id="run_swath2grid_mod02nrt_+3A_prmfn">prmfn</code></td>
<td>
<p>The name of the parameter/control file which will be the input to MRTSwath's <code>swath2grid</code> function.</p>
</td></tr>
<tr><td><code id="run_swath2grid_mod02nrt_+3A_tifsdir">tifsdir</code></td>
<td>
<p>The directory to save the output TIF files in</p>
</td></tr>
<tr><td><code id="run_swath2grid_mod02nrt_+3A_modfn">modfn</code></td>
<td>
<p>The filename of the MODIS data</p>
</td></tr>
<tr><td><code id="run_swath2grid_mod02nrt_+3A_geoloc_fn">geoloc_fn</code></td>
<td>
<p>The filename of the corresponding geolocation file (annoyingly, this is a much larger
file than the data file!)</p>
</td></tr>
<tr><td><code id="run_swath2grid_mod02nrt_+3A_ul_lon">ul_lon</code></td>
<td>
<p>Upper left (ul) longitude (x-coordinate) for subsetting</p>
</td></tr>
<tr><td><code id="run_swath2grid_mod02nrt_+3A_ul_lat">ul_lat</code></td>
<td>
<p>Upper left (ul) latitude (y-coordinate) for subsetting</p>
</td></tr>
<tr><td><code id="run_swath2grid_mod02nrt_+3A_lr_lon">lr_lon</code></td>
<td>
<p>Lower right (lr) longitude (x-coordinate) for subsetting</p>
</td></tr>
<tr><td><code id="run_swath2grid_mod02nrt_+3A_lr_lat">lr_lat</code></td>
<td>
<p>Lower right (lr) latitude (y-coordinate) for subsetting</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you want this function to use MRTSwath tool successfully, you should
add the directory with the MRTSwath executable to the default R PATH
by editing <code>~/.Rprofile</code>.
</p>


<h3>Value</h3>

<p><code>cmdstr</code> The string giving the system command that ran <code>swath2grid</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+write_MRTSwath_param_file_mod02nrt">write_MRTSwath_param_file_mod02nrt</a></code>
</p>
<p><a href="http://landweb.nascom.nasa.gov/cgi-bin/QA_WWW/newPage.cgi?fileName=hdf_filename">http://landweb.nascom.nasa.gov/cgi-bin/QA_WWW/newPage.cgi?fileName=hdf_filename</a>
@cite NASA2001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#######################################################
# Run MRTSwath tool "swath2grid"
#######################################################

# Source MODIS files (both data and geolocation)
# Code excluded from CRAN check because it depends on modiscdata
## Not run: 
library(devtools)
library(modiscdata)
moddir = system.file("extdata/2002raw/", package="modiscdata")

# Get the matching data/geolocation file pairs
fns_df = check_for_matching_geolocation_files(moddir, modtxt="MOD02", geoloctxt="MOD03")
fns_df

# Resulting TIF files go in this directory
tifsdir = getwd()


# Box to subset
ul_lat = 13
ul_lon = -87
lr_lat = 8
lr_lon = -82

for (i in 1:nrow(fns_df))
	{

prmfn = write_MRTSwath_param_file_mod02nrt(prmfn="tmpMRTparams.prm", tifsdir=tifsdir,
 modfn=fns_df$mod02_fns[i], geoloc_fn=fns_df$mod03_fns[i], ul_lon=ul_lon, ul_lat=ul_lat,
  lr_lon=lr_lon, lr_lat=lr_lat)
print(scan(file=prmfn, what="character", sep="\n"))

run_swath2grid_mod02nrt(mrtpath="swath2grid", prmfn="tmpMRTparams.prm", tifsdir=tifsdir,
 modfn=fns_df$mod302_fns[i], geoloc_fn=fns_df$mod03_fns[i], ul_lon=ul_lon, ul_lat=ul_lat,
  lr_lon=lr_lon, lr_lat=lr_lat)

	}

list.files(tifsdir, pattern=".tif", full.names=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='slashslash'>Remove double slash (slash a slash)</h2><span id='topic+slashslash'></span>

<h3>Description</h3>

<p>Shortcut for: <code>gsub(pattern="//", replacement="/", x=tmpstr)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slashslash(tmpstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slashslash_+3A_tmpstr">tmpstr</code></td>
<td>
<p>a path that you want to remove double slashes from</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is useful for removing double slashes that can
appear in full pathnames due to inconsistencies in trailing
slashes in working directories etc.
</p>


<h3>Value</h3>

<p>outstr a string of the fixed path
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tmpstr = "/Library/Frameworks/R.framework/Versions/2.15/Resources/library/
MOD03.A2016209.0515.005.NRT.hdf"

outstr = slashslash(tmpstr)
outstr

</code></pre>

<hr>
<h2 id='write_MRTSwath_param_file_mod02nrt'>Write a parameter control file for MRTSwath</h2><span id='topic+write_MRTSwath_param_file_mod02nrt'></span>

<h3>Description</h3>

<p>MRTSwath is the &quot;MODIS Reprojection Tool for swath products&quot;.  See:
<a href="https://lpdaac.usgs.gov/tools/modis_reprojection_tool_swath">https://lpdaac.usgs.gov/tools/modis_reprojection_tool_swath</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_MRTSwath_param_file_mod02nrt(prmfn = "tmpMRTparams.prm", tifsdir, modfn,
  geoloc_fn, ul_lon, ul_lat, lr_lon, lr_lat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_MRTSwath_param_file_mod02nrt_+3A_prmfn">prmfn</code></td>
<td>
<p>The name of the parameter/control file which will be the input to MRTSwath's <code>swath2grid</code> function.</p>
</td></tr>
<tr><td><code id="write_MRTSwath_param_file_mod02nrt_+3A_tifsdir">tifsdir</code></td>
<td>
<p>The directory to save the output TIF files in</p>
</td></tr>
<tr><td><code id="write_MRTSwath_param_file_mod02nrt_+3A_modfn">modfn</code></td>
<td>
<p>The filename of the MODIS data</p>
</td></tr>
<tr><td><code id="write_MRTSwath_param_file_mod02nrt_+3A_geoloc_fn">geoloc_fn</code></td>
<td>
<p>The filename of the corresponding geolocation file (annoyingly, this is a much larger
file than the data file!)</p>
</td></tr>
<tr><td><code id="write_MRTSwath_param_file_mod02nrt_+3A_ul_lon">ul_lon</code></td>
<td>
<p>Upper left (ul) longitude (x-coordinate) for subsetting</p>
</td></tr>
<tr><td><code id="write_MRTSwath_param_file_mod02nrt_+3A_ul_lat">ul_lat</code></td>
<td>
<p>Upper left (ul) latitude (y-coordinate) for subsetting</p>
</td></tr>
<tr><td><code id="write_MRTSwath_param_file_mod02nrt_+3A_lr_lon">lr_lon</code></td>
<td>
<p>Lower right (lr) longitude (x-coordinate) for subsetting</p>
</td></tr>
<tr><td><code id="write_MRTSwath_param_file_mod02nrt_+3A_lr_lat">lr_lat</code></td>
<td>
<p>Lower right (lr) latitude (y-coordinate) for subsetting</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you want this function to use MRTSwath tool successfully, you should
add the directory with the MRTSwath executable to the default R PATH
by editing <code>~/.Rprofile</code>.
</p>
<p>This function hard-codes these options into the parameter file:<br />
* all the bands are extracted<br />
* the output file is a GeoTIFF<br />
* the output projection is Geographic (plain unprojected Latitude/Longitude)<br />
* the resampling is Nearest Neighbor (NN), which of course is the only one which makes sense when the pixels encode bytes that encode bits that encode discrete classification results, 0/1 error flags, etc.<br />
</p>
<p>MRTswath can do many other projections and output formats; users can modify this function to run those options.
</p>


<h3>Value</h3>

<p><code>prmfn</code> The name of the temporary parameter file
</p>


<h3>Author(s)</h3>

<p>Rishabh Gupta <a href="mailto:rishabh.uk@gmail.com">rishabh.uk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_swath2grid_mod02nrt">run_swath2grid_mod02nrt</a></code>
</p>
<p><a href="http://landweb.nascom.nasa.gov/cgi-bin/QA_WWW/newPage.cgi?fileName=hdf_filename">http://landweb.nascom.nasa.gov/cgi-bin/QA_WWW/newPage.cgi?fileName=hdf_filename</a>
@cite NASA2001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Source MODIS files (both data and geolocation)
# Code excluded from CRAN check because it depends on modiscdata
## Not run: 
library(devtools)
library(modiscdata)
moddir = system.file("extdata/2002raw/", package="modiscdata")

# Get the matching data/geolocation file pairs
fns_df = check_for_matching_geolocation_files_mod02nrt(moddir, modtxt="MOD02", geoloctxt="MOD03")
fns_df

# Resulting TIF files go in this directory
tifsdir = getwd()


# Box to subset
ul_lat = 13
ul_lon = -87
lr_lat = 8
lr_lon = -82

for (i in 1:nrow(fns_df))
	{

	prmfn = write_MRTSwath_param_file_mod02nrt(prmfn="tmpMRTparams.prm", tifsdir=tifsdir,
	 modfn=fns_df$mod02_fns[i], geoloc_fn=fns_df$mod03_fns[i], ul_lon=ul_lon, ul_lat=ul_lat,
	  lr_lon=lr_lon, lr_lat=lr_lat)
	print(scan(file=prmfn, what="character", sep="\n"))

	}

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
