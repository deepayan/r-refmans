<!DOCTYPE html><html lang="en"><head><title>Help for package QFASA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {QFASA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#QFASA'><p>QFASA: A package for Quantitative Fatty Acid Signature Analysis</p></a></li>
<li><a href='#AIT.dist'><p>Returns the distance between two compositional vectors using Aitchison's distance measure.</p></a></li>
<li><a href='#AIT.more'><p>Used to provide additional information on various model components</p>
evaluated at the optimal solution, i.e., using the QFASA diet estimates and
Aitchison distance measure.</a></li>
<li><a href='#AIT.obj'><p>Used in <code>solnp()</code> as the objective function to be minimized when</p>
Aitchison distance measure is chosen.</a></li>
<li><a href='#backward.elimination'><p>Returns diet estimates corresponding to a sample of predators based on a</p>
backward elimination algorithm that chooses the prey species to be included in
the modelling.</a></li>
<li><a href='#bal.diet.data'><p>Sample example of balanced repeatability diet estimates data with only two</p>
repeated measurements per predator.</a></li>
<li><a href='#bal.rep.CI'><p>Measure of Repeatability for Diet Estimates (Balanced Case)</p></a></li>
<li><a href='#bestBackwardModel'><p>Finds the species combination with the best (lowest) IC value achievable by</p>
dropping a single species from the prey.mat. Used for each iteration of
backward elimination.</a></li>
<li><a href='#bestForwardModel'><p>Finds the species combination with the best# (lowest) IC value achievable by</p>
adding a single species from full.prey.mat. Used for each iteration of
forward selection.</a></li>
<li><a href='#bestSubset'><p>Find the pair of starting species with the best (lowest) IC value among all</p>
possible pairs of species in prey.mat Used in forward selection when no
starting species are specified</a></li>
<li><a href='#beta.meths.CI'><p>Returns individual confidence intervals and simultaneous confidence intervals</p>
based on the zero-inflated beta distribution (not bias corrected - see note below).</a></li>
<li><a href='#beta.pval.k'><p>Calculate p-value of a given prey type diet proportion under the</p>
predator diets and estimated diet distribution provided.</a></li>
<li><a href='#bias.all'><p>Calculate bias correction for confidence intervals from <code>beta.meths.CI</code>.</p></a></li>
<li><a href='#bias.comp'><p>Calculate bias correction for confidence intervals.</p></a></li>
<li><a href='#bisect.beta.lim'><p>Find simultaneous and individual confidence intervals for diet</p>
proportions of a single prey species i.e. solve f(pio) = PVAL(pio)
= alpha1 and f(pio) = PVAL(pio) = alpha2 using bisection.</a></li>
<li><a href='#CC'><p>Fatty acid calibration coefficients.</p></a></li>
<li><a href='#chisq.CA'><p>Called by <code>create.d.mat()</code> to compute the chi-square distance.</p></a></li>
<li><a href='#chisq.dist'><p>Returns the distance between two compositional vectors using the chi-square distance.</p></a></li>
<li><a href='#comp.beta.pval.k'><p>Calculate p-value corresponding to a specified null value using bootstrapping</p></a></li>
<li><a href='#comp.gen.pseudo.seals'><p>Generate pseudo predators with ith predator having true diet</p>
given by ith row of diet.null.mat.</a></li>
<li><a href='#comp.p.beta'><p>Bootstrap statistic function: in this case it is the mean</p>
(meanBEZI) of the fitted (gamlss) ZIB distribution.</a></li>
<li><a href='#comp.rep'><p>Repeatability in Diet Estimates</p></a></li>
<li><a href='#comp.Tstar.beta'><p>Generate bootstrap replicates of diet proportion estimates for</p>
given prey species</a></li>
<li><a href='#conf.meth'><p>Confidence Intervals for Diet Proportions</p></a></li>
<li><a href='#create.d.mat'><p>Called by <code>testfordiff.ind.boot.fun()</code> to create a matrix of distances.</p></a></li>
<li><a href='#cs_distance.mat'><p>CALCULATE CS DISTANCE BETWEEN EACH TWO PREDATORS IN dataset</p></a></li>
<li><a href='#CS.more'><p>Used to provide additional information on various model components</p>
evaluated at the optimal solution, i.e., using the QFASA diet estimates and
chi-square distance measure.</a></li>
<li><a href='#CS.obj'><p>Used in <code>solnp()</code> as the objective function to be minimized when</p>
chi-square distance measure is chosen. Unlike <code>AIT.obj()</code> and <code>KL.obj()</code>,
does not require modifying zeros.</a></li>
<li><a href='#data.sim.beta'><p>Bootstrap ran.gen function:</p></a></li>
<li><a href='#dummy'><p>Roxygen commands</p></a></li>
<li><a href='#evaluateCombination'><p>Get nll and IC values for a pair of species (this is used in forward</p>
selection if the starting species are not specified; used on a list of all
possible combinations of two species)</a></li>
<li><a href='#evaluateModel'><p>Get nll and IC values for a given model (note that the model is determined by</p>
the species included in prey.mat - prey.mat is adjusted to add or remove
species before entering this function</a></li>
<li><a href='#FAset'><p>List of fatty acids used in sample prey and predator data sets,</p>
<code>preyFAs</code> and <code>predatorFAs</code> respectively.</a></li>
<li><a href='#forward.selection'><p>Returns diet estimates corresponding to a sample of predators based on a</p>
forward selection algorithm that chooses the prey species to be included in
the modelling.</a></li>
<li><a href='#gen.pseudo.seals'><p>Generate pseudo predators with ith predator having true diet</p>
given by ith row of diet.null.mat.</a></li>
<li><a href='#KL.dist'><p>Returns the distance between two compositional vectors using Kullback&ndash;Leibler</p>
distance measure.</a></li>
<li><a href='#KL.more'><p>Used to provide additional information on various model components</p>
evaluated at the optimal solution, i.e., using the QFASA diet estimates and
Kullback-Leibler distance measure.</a></li>
<li><a href='#KL.obj'><p>Used in <code>solnp()</code> as the objective function to be minimized when</p>
Kullback&ndash;Leibler distance measure is chosen.</a></li>
<li><a href='#likelihoodEstimates'><p>Get simplified MLE estimates</p></a></li>
<li><a href='#mean_geometric'><p>Returns the geometric mean of a compositional vector</p></a></li>
<li><a href='#MEANmeth'><p>Returns the multivariate mean FA signature of each prey group</p>
entered into the QFASA model. Result can be passed to prey.mat in
<code>p.QFASA()</code>.</a></li>
<li><a href='#mod.zeros.FA.sig'><p>Modifies the zeros for a single FA signature using the multiplicative</p>
replacement method (and same delta for every zero).</a></li>
<li><a href='#mod.zeros.FA.sig.mat'><p>Modifies the zeros for a sample of FA signatures using the multiplicative</p>
replacement method (and same delta for every zero).</a></li>
<li><a href='#multiplicativeReplacement'><p>Multiplicative replacement of zeroes</p></a></li>
<li><a href='#opt.beta.lim'><p>Find simultaneous confidence intervals for diet</p>
proportions of a single prey species i.e. solve f(pio) = PVAL(pio)
= alpha1.  Calls root finding function root.beta.</a></li>
<li><a href='#p.beta'><p>Bootstrap statistic function: in this case it is the mean</p>
(meanBEZI) of the fitted (gamlss) ZIB distribution.</a></li>
<li><a href='#p.MLE'><p>Returns simplified MLE diet estimates corresponding to a sample of predators.</p></a></li>
<li><a href='#p.MUFASA'><p>Returns MUFASA diet estimates corresponding to a sample of predators.</p></a></li>
<li><a href='#p.QFASA'><p>Returns QFASA diet estimates corresponding to a sample of predators.</p></a></li>
<li><a href='#p.sim.QFASA'><p>Simultaneous estimation of diet composition and calibration coefficients</p></a></li>
<li><a href='#p.SMUFASA'><p>Simultaneous maximum unified fatty acid signature analysis</p></a></li>
<li><a href='#POOLVARmeth'><p>Computes within species variance-covariance matrices on transformed scaled,</p>
along with a pooled estimate.</a></li>
<li><a href='#predatorFAs'><p>Predator fatty acid signatures. Each predator signature is a row</p>
with fatty acid proportions in columns.</a></li>
<li><a href='#prey.cluster'><p>Produces a dendrogram using distances between the mean</p>
FA signatures of the prey types.</a></li>
<li><a href='#prey.on.prey'><p>Each prey fatty acid signature is systematically removed from the</p>
supplied prey database and its QFASA diet estimate is obtained by
treating the individual as a predator.</a></li>
<li><a href='#preyFAs'><p>Prey fatty acid signatures. Each prey signature is a row with fatty</p>
acid proportions in columns.</a></li>
<li><a href='#pseudo.pred'><p>Generate a pseudo predator by sampling with replacement from prey database.</p></a></li>
<li><a href='#pseudo.pred.norm'><p>Generate a pseudo predator parametrically from multivariate normal</p>
distributions.</a></li>
<li><a href='#pseudo.pred.rep'><p>FUNCTION TO GENERATE ns PSEUDO SEALS WHERE ns IS THE NUMBER OF ROWS IN</p>
<code>diet.mat.seal</code> AND RETURNS THE CORRESPONDING QFASA DIET ESTIMATES.
ASSUMES EACH ROW IS A DIET VECTOR AND EACH COLUMN CORRESPONDS TO 1 PREY
SPECIES IN THE DIET</a></li>
<li><a href='#pseudo.pred.table'><p>FUNCTION TO GENERATE ns SEALS FOR EACH OF ny YEARS</p></a></li>
<li><a href='#pseudo.seal'><p>Generate a single pseudo predator FA signature</p></a></li>
<li><a href='#QFASA.const.eqn'><p>Returns <code>sum(alpha)</code> and used in <code>solnp()</code>.</p></a></li>
<li><a href='#rho.boot.fun'><p>RETURNS RHO AND THE BOOTSTRAP SAMPLE DETERMINED BY ind.</p></a></li>
<li><a href='#rho.jack.fun'><p>FUNCTION TO BE PASSED TO bootstrap::jackknife.</p></a></li>
<li><a href='#root.beta'><p>Find root (i.e. solve f(pio) = PVAL(pio) = alpha1 using either uniroot or optimize.</p></a></li>
<li><a href='#split_prey'><p>Splits prey database into a simulation set (1/3) and a modelling set (2/3).</p>
Returns a list:</a></li>
<li><a href='#testfordiff.ind.boot'><p>Called by <code>testfordiff.ind.pval()</code>.</p></a></li>
<li><a href='#testfordiff.ind.boot.fun'><p>Called by <code>testfordiff.ind.boot()</code>.</p></a></li>
<li><a href='#testfordiff.ind.pval'><p>Test for a difference between two independent samples of compositional data.</p>
Zeros of any type are allowed.</a></li>
<li><a href='#Tstar.beta'><p>Generate bootstrap replicates of diet proportion estimates for</p>
given prey species</a></li>
<li><a href='#two.factor.rep'><p>Measure of (unadjusted) repeatability</p></a></li>
<li><a href='#unbal.diet.data'><p>Sample example of unbalanced repeatability diet estimates data with a max of</p>
two repeated measurements per predator.</a></li>
<li><a href='#unbal.rep.CI'><p>Measure of Repeatability for Diet Estimates (Unbalanced/Missing Value Case)</p></a></li>
<li><a href='#unbal.rho.boot.fun'><p>RETURNS RHO AND THE BOOTSTRAP SAMPLE DETERMINED BY ind.</p></a></li>
<li><a href='#unbal.rho.jack.fun'><p>FUNCTION TO BE PASSED TO bootstrap::jackknife.</p></a></li>
<li><a href='#unbal.two.factor.rep'><p>Measure of (unadjusted) repeatability with missing values</p></a></li>
<li><a href='#uniroot.beta'><p>Use uniroot() to find roots and compare with bisection outcome</p></a></li>
<li><a href='#zeroEstimates'><p>Reintroduce excluded species to diet estimates as forced zeroes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Quantitative Fatty Acid Signature Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-08-27</td>
</tr>
<tr>
<td>Description:</td>
<td>Accurate estimates of the diets of predators are required
    in many areas of ecology, but for many species current methods are
    imprecise, limited to the last meal, and often biased. The diversity
    of fatty acids and their patterns in organisms, coupled with the
    narrow limitations on their biosynthesis, properties of digestion in
    monogastric animals, and the prevalence of large storage reservoirs of
    lipid in many predators, led to the development of quantitative
    fatty acid signature analysis (QFASA) to study predator diets.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, Rsolnp, boot, futile.logger, gamlss, gamlss.dist,
vegan, bootstrap, Compositional, TMB, compositions, MASS,
dplyr, mvtnorm,</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>TMB, Rcpp, RcppEigen,</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>plyr, knitr, rmarkdown, testthat, gtools</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cstewartGH/QFASA/issues">https://github.com/cstewartGH/QFASA/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=QFASA">https://CRAN.R-project.org/package=QFASA</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-27 17:32:37 UTC; cstewart</td>
</tr>
<tr>
<td>Author:</td>
<td>Connie Stewart [cre, aut, cph],
  Sara Iverson [aut, cph],
  Chris Field [aut],
  Don Bowen [aut],
  Wade Blanchard [aut],
  Shelley Lang [aut],
  Justin Kamerman [aut],
  Hongchang Bao [ctb],
  Holly Steeves [aut],
  Jennifer McNichol [aut],
  Tyler Rideout [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Connie Stewart &lt;connie.stewart@unb.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-27 19:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='QFASA'>QFASA: A package for Quantitative Fatty Acid Signature Analysis</h2><span id='topic+QFASA'></span><span id='topic+QFASA-package'></span>

<h3>Description</h3>

<p>Accurate estimates of the diets of predators are required
in many areas of ecology, but for many species current methods are
imprecise, limited to the last meal, and often biased. The diversity
of fatty acids and their patterns in organisms, coupled with the
narrow limitations on their biosynthesis, properties of digestion in
monogastric animals, and the prevalence of large storage reservoirs of
lipid in many predators, led us to propose the use of quantitative
fatty acid signature analysis (QFASA) to study predator diets.
</p>

<hr>
<h2 id='AIT.dist'>Returns the distance between two compositional vectors using Aitchison's distance measure.</h2><span id='topic+AIT.dist'></span>

<h3>Description</h3>

<p>Returns the distance between two compositional vectors using Aitchison's distance measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AIT.dist(x.1, x.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIT.dist_+3A_x.1">x.1</code></td>
<td>
<p>compositional vector</p>
</td></tr>
<tr><td><code id="AIT.dist_+3A_x.2">x.2</code></td>
<td>
<p>compositional vector</p>
</td></tr>
</table>


<h3>References</h3>

<p>Aitchison, J., (1992) On criteria for measures of compositional difference. Mathematical Geology, 24(4), pp.365-379.
</p>
<p>Connie Stewart (2017) An approach to measure distance between compositional diet estimates containing essential zeros, Journal of Applied Statistics, 44:7, 1137-1152, DOI: 10.1080/02664763.2016.1193846
</p>

<hr>
<h2 id='AIT.more'>Used to provide additional information on various model components
evaluated at the optimal solution, i.e., using the QFASA diet estimates and
Aitchison distance measure.</h2><span id='topic+AIT.more'></span>

<h3>Description</h3>

<p>Used to provide additional information on various model components
evaluated at the optimal solution, i.e., using the QFASA diet estimates and
Aitchison distance measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AIT.more(alpha, predator, prey.quantiles)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIT.more_+3A_alpha">alpha</code></td>
<td>
<p>compositional QFASA diet estimate.</p>
</td></tr>
<tr><td><code id="AIT.more_+3A_predator">predator</code></td>
<td>
<p>fatty acid signature of predator.</p>
</td></tr>
<tr><td><code id="AIT.more_+3A_prey.quantiles">prey.quantiles</code></td>
<td>
<p>matrix of fatty acid signatures of
prey. Each row contains an individual prey signature from a different
species.</p>
</td></tr>
</table>

<hr>
<h2 id='AIT.obj'>Used in <code>solnp()</code> as the objective function to be minimized when
Aitchison distance measure is chosen.</h2><span id='topic+AIT.obj'></span>

<h3>Description</h3>

<p>Used in <code>solnp()</code> as the objective function to be minimized when
Aitchison distance measure is chosen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AIT.obj(alpha, predator, prey.quantiles)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIT.obj_+3A_alpha">alpha</code></td>
<td>
<p>vector over which minimization takes place.</p>
</td></tr>
<tr><td><code id="AIT.obj_+3A_predator">predator</code></td>
<td>
<p>fatty acid signature of predator.</p>
</td></tr>
<tr><td><code id="AIT.obj_+3A_prey.quantiles">prey.quantiles</code></td>
<td>
<p>matrix of fatty acid signatures of
prey. Each row contains an individual prey signature from a different
species.</p>
</td></tr>
</table>

<hr>
<h2 id='backward.elimination'>Returns diet estimates corresponding to a sample of predators based on a
backward elimination algorithm that chooses the prey species to be included in
the modelling.</h2><span id='topic+backward.elimination'></span>

<h3>Description</h3>

<p>Returns diet estimates corresponding to a sample of predators based on a
backward elimination algorithm that chooses the prey species to be included in
the modelling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backward.elimination(
  pred.mat,
  prey.mat,
  cal.vec,
  FC,
  ext.fa,
  k = 2,
  cutoff = 0.1,
  silence = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backward.elimination_+3A_pred.mat">pred.mat</code></td>
<td>
<p>matrix containing the FA signatures of the predators, where
each row corresponds to a predator and each column to a FA.</p>
</td></tr>
<tr><td><code id="backward.elimination_+3A_prey.mat">prey.mat</code></td>
<td>
<p>data frame containing the FA signatures of the prey, where
each row corresponds to a single individual prey.
The first column must index the prey group, while the
remaining columns correspond to FAs.</p>
</td></tr>
<tr><td><code id="backward.elimination_+3A_cal.vec">cal.vec</code></td>
<td>
<p>numeric vector of calibration coefficients corresponding to
the FAs contained in the modelling subset ext.fa. A vector of
ones in the length of ext.fa may be used for modelling
without calibration coefficients.</p>
</td></tr>
<tr><td><code id="backward.elimination_+3A_fc">FC</code></td>
<td>
<p>numeric vector of the average lipid contents for each prey
group, in the order of the <em>alphabetized</em> prey groups.
vector of ones equal in length to the number of prey groups
may be used for modelling without adjustment for fat content.</p>
</td></tr>
<tr><td><code id="backward.elimination_+3A_ext.fa">ext.fa</code></td>
<td>
<p>character vector containing the subset of FAs to be used in
modelling.</p>
</td></tr>
<tr><td><code id="backward.elimination_+3A_k">k</code></td>
<td>
<p>scaling factor to be used in calculating the value of the
information criterion (IC). The default value of 2
corresponds to the Akaike Information Criterion. For a sample
of size n, k = log(n) corresponds to the Bayesian Information
Criterion. As this factor is numeric, values corresponding to
other IC may be used freely.</p>
</td></tr>
<tr><td><code id="backward.elimination_+3A_cutoff">cutoff</code></td>
<td>
<p>numeric proportion to be used as the threshold for the
candidacy for removal of a species in backward
elimination. If initial diet estimates for any
individual predator find a species to be present in
proportions greater than this threshold, that species
will not be considered for removal from the model. This
reduces computation times and safeguards against the
removal of species which may be present in the diets of
few predators. All species are considered candidates for
removal at a value of 1, while lower values are more
conservative. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="backward.elimination_+3A_silence">silence</code></td>
<td>
<p>if true, additional information is printed. Default is false.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses a backward elimination algorithm and the simplified
MLE method to choose the prey species to be included in the model and then
returns the diet estimates corresponding to these species.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>Diet_Estimates</code></td>
<td>
<p>A matrix of the diet estimates for each predator where
each row corresponds to a predator and each column to a prey species. The
estimates are expressed as proportions summing to one.</p>
</td></tr>
<tr><td><code>Selection_Order</code></td>
<td>
<p>A data frame summarizing each step of the algorithm,
giving the order of species removal and the corresponding IC values.</p>
</td></tr>
<tr><td><code>Selection_Tables</code></td>
<td>
<p>A list containing a data frame for each step of the
selection process, providing the IC values associated with removing any one
candidate species at that step.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><em>forward.selection()</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 ## This example takes some time to run.
 ## Please uncomment code below to run.

#library(dplyr)
#library(compositions)
## Package data: FAs
#data(FAset)
#fa.set = as.vector(unlist(FAset))

## Package data: Prey
#data(preyFAs)
#prey.sub=(preyFAs[,4:(ncol(preyFAs))])[fa.set]
#prey.sub=prey.sub/apply(prey.sub,1,sum)
#group=as.vector(preyFAs$Species)
#prey.sub = cbind(group,prey.sub)
#sort.preytype &lt;- order(prey.sub[, 1])
#prey.matrix &lt;- prey.sub[sort.preytype,]

## Package data: Predators
#data(predatorFAs)
#tombstone.info = predatorFAs[,1:4]
#predator.matrix = predatorFAs[,5:(ncol(predatorFAs))]
#npredators = nrow(predator.matrix)

## Package data: Fat content
#FC = preyFAs[,c(2,3)]
#FC = as.vector(tapply(FC$lipid,FC$Species,mean,na.rm=TRUE))

## Package data: Calibration coefficients
#data(CC)
#cal.vec = CC[,2]
#cal.mat = replicate(npredators, cal.vec)
#rownames(cal.mat) &lt;- CC$FA
#names(cal.vec) &lt;- rownames(cal.mat)

## QFASA (KL)
#sample.qfasa &lt;- p.QFASA(predator.matrix,MEANmeth(prey.matrix),cal.mat,
#dist.meas = 1,gamma=1,FC,
#start.val = rep(1,nrow(MEANmeth(prey.matrix))),fa.set)

## Backward Elimination
#sample.be &lt;- backward.elimination(predator.matrix, prey.matrix, cal.vec,FC,
#fa.set,cutoff = 0.01)

## Output
#be.estimates &lt;- sample.be$`Diet Estimates`
</code></pre>

<hr>
<h2 id='bal.diet.data'>Sample example of balanced repeatability diet estimates data with only two
repeated measurements per predator.</h2><span id='topic+bal.diet.data'></span>

<h3>Description</h3>

<p>Sample example of balanced repeatability diet estimates data with only two
repeated measurements per predator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bal.diet.data
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 predator diets (50 unique predators) and
13 variables:
</p>

<dl>
<dt>Seal.ID</dt><dd><p>Predator (1 to 50)</p>
</dd>
<dt>Year</dt><dd><p>Either 1 or 2</p>
</dd>
<dt>capelin</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>coho</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>eulachon</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>herring</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>mackerel</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>pilchard</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>pollock</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>sandlance</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>squid</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>surfsmelt_s</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>sufsmelt_lg</dt><dd><p>estimated diet proportion</p>
</dd>
</dl>


<hr>
<h2 id='bal.rep.CI'>Measure of Repeatability for Diet Estimates (Balanced Case)</h2><span id='topic+bal.rep.CI'></span>

<h3>Description</h3>

<p>Computes a measure of repeatability for a sample of predators with repeated
diet estimate measurements (Balanced Case)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bal.rep.CI(
  data,
  B,
  R,
  CI = TRUE,
  alpha,
  prey.database,
  fatcont.mat,
  dist.meas,
  ext.fa,
  gamma.QFASA = 1,
  gamma.rho = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bal.rep.CI_+3A_data">data</code></td>
<td>
<p>data frame of diet estimates. First column must denote the predator
and second column the second factor (eg. year or season).  Must contain
the same number of repeated measurements for each predator.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_b">B</code></td>
<td>
<p>number of pseudo predators samples to generate for bias calculation.
Default is set to 50 because is slow to run.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_r">R</code></td>
<td>
<p>number of bootstrap samples (i.e. <code>R</code> samples for each generated sample
of pseudo predators). Default is set to 100 because it is slow to run.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_ci">CI</code></td>
<td>
<p>indicates if a confidence interval for rho is to be calculated.
Default is FALSE since this is time consuming to obtain.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_alpha">alpha</code></td>
<td>
<p>a (1-alpha/2)X100 percent confidence interval is calculated for rho
if <code>CI=TRUE</code>.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_prey.database">prey.database</code></td>
<td>
<p>prey data base that was used to compute the QFASA diet
estimates in <code>data</code>. Will be used to generate pseudo predators.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_fatcont.mat">fatcont.mat</code></td>
<td>
<p>data frame or matrix of length equal to the number of prey
FA signatures in prey data base.  First column is name of species and
second column is lipid.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_dist.meas">dist.meas</code></td>
<td>
<p>distance measure to use in <code>p.QFASA</code>.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of FAs to use.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_gamma.qfasa">gamma.QFASA</code></td>
<td>
<p>if <code>dist.meas=3</code>, gamma is required.  Default is 1.</p>
</td></tr>
<tr><td><code id="bal.rep.CI_+3A_gamma.rho">gamma.rho</code></td>
<td>
<p>value of gamma to be used to compute CS distance
in repeatablity functions.  Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bias corrected measure of repeatability, estimate of the bias and
(if <code>CI=TRUE</code>) a confidence interval for the true repeatability.
</p>

<hr>
<h2 id='bestBackwardModel'>Finds the species combination with the best (lowest) IC value achievable by
dropping a single species from the prey.mat. Used for each iteration of
backward elimination.</h2><span id='topic+bestBackwardModel'></span>

<h3>Description</h3>

<p>Finds the species combination with the best (lowest) IC value achievable by
dropping a single species from the prey.mat. Used for each iteration of
backward elimination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bestBackwardModel(
  pred.mat,
  prey.mat,
  cal.vec,
  fat.vec,
  ext.fa,
  starting.estimates,
  k = 2,
  cutoff = 0.01,
  silence = FALSE
)
</code></pre>

<hr>
<h2 id='bestForwardModel'>Finds the species combination with the best# (lowest) IC value achievable by
adding a single species from full.prey.mat. Used for each iteration of
forward selection.</h2><span id='topic+bestForwardModel'></span>

<h3>Description</h3>

<p>Finds the species combination with the best# (lowest) IC value achievable by
adding a single species from full.prey.mat. Used for each iteration of
forward selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bestForwardModel(
  pred.mat,
  full.prey.mat,
  prey.mat,
  cal.vec,
  fat.vec,
  ext.fa,
  k = 2,
  silence = FALSE
)
</code></pre>

<hr>
<h2 id='bestSubset'>Find the pair of starting species with the best (lowest) IC value among all
possible pairs of species in prey.mat Used in forward selection when no
starting species are specified</h2><span id='topic+bestSubset'></span>

<h3>Description</h3>

<p>Find the pair of starting species with the best (lowest) IC value among all
possible pairs of species in prey.mat Used in forward selection when no
starting species are specified
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bestSubset(
  pred.mat,
  prey.mat,
  cal.vec,
  fat.vec,
  ext.fa,
  k = 2,
  silence = FALSE
)
</code></pre>

<hr>
<h2 id='beta.meths.CI'>Returns individual confidence intervals and simultaneous confidence intervals
based on the zero-inflated beta distribution (not bias corrected - see note below).</h2><span id='topic+beta.meths.CI'></span>

<h3>Description</h3>

<p>For details see:
Stewart, C. (2013)  Zero-Inflated Beta Distribution for Modeling the Proportions in
Quantitative Fatty Acid Signature Analysis.
Journal of Applied Statistics, 40(5), 985-992.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta.meths.CI(
  predator.mat,
  prey.mat,
  cal.mat = rep(1, length(ext.fa)),
  dist.meas,
  noise = 0,
  nprey,
  R.p,
  R.ps,
  R,
  p.mat,
  alpha,
  FC = rep(1, nrow(prey.mat)),
  ext.fa
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="beta.meths.CI_+3A_predator.mat">predator.mat</code></td>
<td>
<p>matrix containing the fatty acid signatures of the predators.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_prey.mat">prey.mat</code></td>
<td>
<p>prey database. A dataframe with first column a
Species label and other columns fatty acid proportions. Fatty
acid proportions are compositional.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_cal.mat">cal.mat</code></td>
<td>
<p>matrix of calibration coefficients of
predators. Each column corresponds to a different predator. At
least one calibration coefficient vector must be supplied.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_dist.meas">dist.meas</code></td>
<td>
<p>distance measure to use for estimation: 1=KL,
2=AIT or 3=CS</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_noise">noise</code></td>
<td>
<p>proportion of noise to include in the simulation.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_nprey">nprey</code></td>
<td>
<p>number of prey to sample from the the prey database
when generating pseudo-predators for the nuisance parameter
estimation.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_r.p">R.p</code></td>
<td>
<p>number of beta diet distributions to generate for the
nuisance parameters.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_r.ps">R.ps</code></td>
<td>
<p>number of pseudo predators to generate when estimating
nuisance parameters.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_r">R</code></td>
<td>
<p>number of bootstrap replicates to use when generating
p-values for confidence interval estimation.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_p.mat">p.mat</code></td>
<td>
<p>matrix of predator diet estimates for which we are
trying to find confidence intervals.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_alpha">alpha</code></td>
<td>
<p>confidence interval confidence level.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_fc">FC</code></td>
<td>
<p>vector of prey fat content. Note that this vector is
passed to the <code><a href="#topic+gen.pseudo.seals">gen.pseudo.seals</a></code> which expects fat
content values for individual prey samples while
<code><a href="#topic+pseudo.seal">pseudo.seal</a></code> and  <code><a href="#topic+p.QFASA">p.QFASA</a></code>
expect a species average.</p>
</td></tr>
<tr><td><code id="beta.meths.CI_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of fatty acids to be used to obtain QFASA diet
estimates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note:
</p>

<ul>
<li><p> These intervals are biased and should be corrected using the
output from <code><a href="#topic+bias.all">bias.all</a></code>.
</p>
</li>
<li> <p><code>CI.L.1</code> and <code>CI.U.1</code> contain the simultaneous
confidence intervals.
</p>
</li>
<li><p> Slow because of bisection and lots of repetition.
</p>
</li></ul>



<h3>Value</h3>

<p>Individual confidence intervals and simultaneous confidence
intervals based on the zero-inflated beta distribution. These
intervals are biased and should be corrected using the output
from <code><a href="#topic+bias.all">bias.all</a></code>. <code>ci.l.1</code> and <code>ci.u.1</code>
contain the simultaneous confidence intervals.
</p>


<h3>References</h3>

<p>Stewart, C. (2013) Zero-inflated beta distribution for
modeling the proportions in quantitative fatty acid signature
analysis. Journal of Applied Statistics, 40(5), 985-992.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#####  beta.meths.CI is deprecated.  Please use conf.meth! #####
## Fatty Acids
data(FAset)
fa.set = as.vector(unlist(FAset))

## Predators
data(predatorFAs)
tombstone.info = predatorFAs[,1:4]
predator.matrix = predatorFAs[, fa.set]
npredators = nrow(predator.matrix)

## Prey
prey.sub = preyFAs[, fa.set]
prey.sub = prey.sub / apply(prey.sub, 1, sum)
group = as.vector(preyFAs$Species)
prey.matrix.full = cbind(group,prey.sub)
prey.matrix = MEANmeth(prey.matrix.full)

## Calibration Coefficients
data(CC)
cal.vec = CC[CC$FA %in% fa.set, 2]
cal.mat = replicate(npredators, cal.vec)

# Note: uncomment examples to run. CRAN tests fail because execution time &gt; 5 seconds
# set.seed(1234)
# diet.est &lt;- p.QFASA(predator.mat = predator.matrix,
#                     prey.mat = prey.matrix,
#                     cal.mat = cal.mat,
#                     dist.meas = 2,
#                     start.val = rep(1,nrow(prey.matrix)),
#                     ext.fa = fa.set)[['Diet Estimates']]
#
# ci = beta.meths.CI(predator.mat = predator.matrix,
#                    prey.mat = prey.matrix.full,
#                    cal.mat = cal.mat,
#                    dist.meas = 2,
#                    nprey = 10,
#                    R.p = 1,
#                    R.ps = 10, #
#                    R = 1,
#                    p.mat = diet.est,
#                    alpha = 0.05,
#                    ext.fa = fa.set)

</code></pre>

<hr>
<h2 id='beta.pval.k'>Calculate p-value of a given prey type diet proportion under the
predator diets and estimated diet distribution provided.</h2><span id='topic+beta.pval.k'></span>

<h3>Description</h3>

<p>Calculate p-value of a given prey type diet proportion under the
predator diets and estimated diet distribution provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta.pval.k(par.list, R, diet.test.k, p.mat, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="beta.pval.k_+3A_par.list">par.list</code></td>
<td>
<p>a list of R.p lists of I beta distribution parameters phi
and theta that define diet proportion estimates for each of the
prey species. Effectively R.p beta distibutions for each of the
I prey species which we bootstrap to calculate p-values.</p>
</td></tr>
<tr><td><code id="beta.pval.k_+3A_r">R</code></td>
<td>
<p>number of bootstrap replicates to use in p-value estimation.</p>
</td></tr>
<tr><td><code id="beta.pval.k_+3A_diet.test.k">diet.test.k</code></td>
<td>
<p>diet proportion for which we want the p-value</p>
</td></tr>
<tr><td><code id="beta.pval.k_+3A_p.mat">p.mat</code></td>
<td>
<p>predator diet estimates.</p>
</td></tr>
<tr><td><code id="beta.pval.k_+3A_k">k</code></td>
<td>
<p>prey species index 1..I</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value p-value
</p>

<hr>
<h2 id='bias.all'>Calculate bias correction for confidence intervals from <code><a href="#topic+beta.meths.CI">beta.meths.CI</a></code>.</h2><span id='topic+bias.all'></span>

<h3>Description</h3>

<p>Calculate bias correction for confidence intervals from <code><a href="#topic+beta.meths.CI">beta.meths.CI</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bias.all(
  p.mat,
  prey.mat,
  cal.mat = rep(1, length(ext.fa)),
  fat.cont = rep(1, nrow(prey.mat)),
  R.bias,
  noise,
  nprey,
  specify.noise,
  dist.meas,
  ext.fa
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bias.all_+3A_p.mat">p.mat</code></td>
<td>
<p>matrix containing the fatty acid signatures of the predators.</p>
</td></tr>
<tr><td><code id="bias.all_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing a representative fatty acid signature</p>
</td></tr>
<tr><td><code id="bias.all_+3A_cal.mat">cal.mat</code></td>
<td>
<p>matrix of calibration factors where the <em>i</em> th
column is to be used with the <em>i</em> th predator. If modelling is
to be done without calibration coefficients, simply pass a
vector or matrix of ones.</p>
</td></tr>
<tr><td><code id="bias.all_+3A_fat.cont">fat.cont</code></td>
<td>
<p>prey fat content</p>
</td></tr>
<tr><td><code id="bias.all_+3A_r.bias">R.bias</code></td>
<td>
<p>bootstrap replicates</p>
</td></tr>
<tr><td><code id="bias.all_+3A_noise">noise</code></td>
<td>
<p>noise</p>
</td></tr>
<tr><td><code id="bias.all_+3A_nprey">nprey</code></td>
<td>
<p>number of prey</p>
</td></tr>
<tr><td><code id="bias.all_+3A_specify.noise">specify.noise</code></td>
<td>
<p>noise</p>
</td></tr>
<tr><td><code id="bias.all_+3A_dist.meas">dist.meas</code></td>
<td>
<p>distance measure</p>
</td></tr>
<tr><td><code id="bias.all_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of FA's to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Row 1 is Lambda CI, row 2 is Lambda skew, and row 3 is Beta CI
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fatty Acids
data(FAset)
fa.set = as.vector(unlist(FAset))

## Predators
data(predatorFAs)
tombstone.info = predatorFAs[,1:4]
predator.matrix = predatorFAs[, fa.set]
npredators = nrow(predator.matrix)

## Prey
prey.sub = preyFAs[, fa.set]
prey.sub = prey.sub / apply(prey.sub, 1, sum)
group = as.vector(preyFAs$Species)
prey.matrix.full = cbind(group,prey.sub)
prey.matrix = MEANmeth(prey.matrix.full)

## Calibration Coefficients
data(CC)
cal.vec = CC[CC$FA %in% fa.set, 2]
cal.mat = replicate(npredators, cal.vec)

# Note: uncomment examples to run. CRAN tests fail because execution time &gt; 5 seconds
# diet.est &lt;- p.QFASA(predator.mat = predator.matrix,
#                     prey.mat = prey.matrix,
#                     cal.mat = cal.mat,
#                     dist.meas = 2,
#                     start.val = rep(1,nrow(prey.matrix)),
#                     ext.fa = fa.set)[['Diet Estimates']]
#
# bias &lt;- bias.all(p.mat = diet.est,
#                  prey.mat = prey.matrix.full,
#                  cal.mat = cal.mat,
#                  R.bias = 10,
#                  noise = 0,
#                  nprey = 50,
#                  dist.meas = 2,
#                  ext.fa = fa.set)

</code></pre>

<hr>
<h2 id='bias.comp'>Calculate bias correction for confidence intervals.</h2><span id='topic+bias.comp'></span>

<h3>Description</h3>

<p>Calculate bias correction for confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bias.comp(diet.est, prey.mat, R.bias, dist.meas, ext.fa, gamma = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bias.comp_+3A_diet.est">diet.est</code></td>
<td>
<p>predator diet estimates</p>
</td></tr>
<tr><td><code id="bias.comp_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix of prey FA signatures</p>
</td></tr>
<tr><td><code id="bias.comp_+3A_r.bias">R.bias</code></td>
<td>
<p>number of replicates</p>
</td></tr>
<tr><td><code id="bias.comp_+3A_dist.meas">dist.meas</code></td>
<td>
<p>distance measure</p>
</td></tr>
<tr><td><code id="bias.comp_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of FA's to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>estimate of bias for each prey type
</p>

<hr>
<h2 id='bisect.beta.lim'>Find simultaneous and individual confidence intervals for diet
proportions of a single prey species i.e. solve f(pio) = PVAL(pio)
= alpha1 and f(pio) = PVAL(pio) = alpha2 using bisection.</h2><span id='topic+bisect.beta.lim'></span>

<h3>Description</h3>

<p>Assumptions: alpha1 &lt; alpha2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bisect.beta.lim(alpha1, alpha2, par.list, R, p.mat, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bisect.beta.lim_+3A_alpha1">alpha1</code></td>
<td>
<p>simultaneous confidence level</p>
</td></tr>
<tr><td><code id="bisect.beta.lim_+3A_alpha2">alpha2</code></td>
<td>
<p>individual confidence level</p>
</td></tr>
<tr><td><code id="bisect.beta.lim_+3A_par.list">par.list</code></td>
<td>
<p>a list of R.p lists of I beta distribution parameters phi
and theta that define diet proportion estimates for each of the
prey species. Effectively R.p beta distibutions for each of the
I prey species from which we bootstrap to calculate p-values.</p>
</td></tr>
<tr><td><code id="bisect.beta.lim_+3A_r">R</code></td>
<td>
<p>number of bootstrap replicates to use in p-value estimation.</p>
</td></tr>
<tr><td><code id="bisect.beta.lim_+3A_p.mat">p.mat</code></td>
<td>
<p>predator diet estimates.</p>
</td></tr>
<tr><td><code id="bisect.beta.lim_+3A_k">k</code></td>
<td>
<p>prey species index 1..I</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note:  Tried to minimize number of times have to compute a pvalue
since very slow.
</p>


<h3>Value</h3>

<p>upper and lower limits for individual and simultaneous
intervals respectively.
</p>

<hr>
<h2 id='CC'>Fatty acid calibration coefficients.</h2><span id='topic+CC'></span>

<h3>Description</h3>

<p>Fatty acid calibration coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CC
</code></pre>


<h3>Format</h3>

<p>A data frame with 66 observations and 2 variables:
</p>

<dl>
<dt>FA</dt><dd><p>fatty acid names</p>
</dd>
<dt>CC</dt><dd><p>calibration coefficient for corresponding fatty acid</p>
</dd>
</dl>


<hr>
<h2 id='chisq.CA'>Called by <code>create.d.mat()</code> to compute the chi-square distance.</h2><span id='topic+chisq.CA'></span>

<h3>Description</h3>

<p>Called by <code>create.d.mat()</code> to compute the chi-square distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq.CA(x1, x2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chisq.CA_+3A_x1">x1</code></td>
<td>
<p>vector</p>
</td></tr>
<tr><td><code id="chisq.CA_+3A_x2">x2</code></td>
<td>
<p>vector</p>
</td></tr>
</table>

<hr>
<h2 id='chisq.dist'>Returns the distance between two compositional vectors using the chi-square distance.</h2><span id='topic+chisq.dist'></span>

<h3>Description</h3>

<p>Returns the distance between two compositional vectors using the chi-square distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq.dist(x.1, x.2, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chisq.dist_+3A_x.1">x.1</code></td>
<td>
<p>compositional vector</p>
</td></tr>
<tr><td><code id="chisq.dist_+3A_x.2">x.2</code></td>
<td>
<p>compositional vector</p>
</td></tr>
<tr><td><code id="chisq.dist_+3A_gamma">gamma</code></td>
<td>
<p>power transform taken to be 1.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Stewart, C., Iverson, S. and Field, C. (2014) Testing for a change in
diet using fatty acid signatures.  Environmental and Ecological Statistics 21, pp. 775-792.
</p>
<p>Connie Stewart (2017) An approach to measure distance between compositional diet estimates containing essential zeros, Journal of Applied Statistics, 44:7, 1137-1152, DOI: 10.1080/02664763.2016.1193846
</p>

<hr>
<h2 id='comp.beta.pval.k'>Calculate p-value corresponding to a specified null value using bootstrapping</h2><span id='topic+comp.beta.pval.k'></span>

<h3>Description</h3>

<p>Calculate p-value corresponding to a specified null value using bootstrapping
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.beta.pval.k(par.list, R, diet.test.k, p.mat, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comp.beta.pval.k_+3A_par.list">par.list</code></td>
<td>
<p>a list of R.p lists of I beta distribution parameters phi
and theta that define diet proportion estimates for each of the
prey species. Effectively R.p beta distributions for each of the
I prey species which we bootstrap to calculate p-values.</p>
</td></tr>
<tr><td><code id="comp.beta.pval.k_+3A_r">R</code></td>
<td>
<p>number of bootstrap replicates to use in p-value estimation.</p>
</td></tr>
<tr><td><code id="comp.beta.pval.k_+3A_diet.test.k">diet.test.k</code></td>
<td>
<p>null value</p>
</td></tr>
<tr><td><code id="comp.beta.pval.k_+3A_p.mat">p.mat</code></td>
<td>
<p>predator diet estimates.</p>
</td></tr>
<tr><td><code id="comp.beta.pval.k_+3A_k">k</code></td>
<td>
<p>prey species index 1..I</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value p-value
</p>

<hr>
<h2 id='comp.gen.pseudo.seals'>Generate pseudo predators with ith predator having true diet
given by ith row of diet.null.mat.</h2><span id='topic+comp.gen.pseudo.seals'></span>

<h3>Description</h3>

<p>Generate pseudo predators with ith predator having true diet
given by ith row of diet.null.mat.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.gen.pseudo.seals(prey.mat, diet.null.mat, cal.mat, fat.cont, noise, nprey)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comp.gen.pseudo.seals_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing a representative FA signature
from each prey group (usually the mean). The first column must
index the prey group.</p>
</td></tr>
<tr><td><code id="comp.gen.pseudo.seals_+3A_diet.null.mat">diet.null.mat</code></td>
<td>
<p>null diet</p>
</td></tr>
<tr><td><code id="comp.gen.pseudo.seals_+3A_cal.mat">cal.mat</code></td>
<td>
<p>matrix of calibration coefficients where the <em>i</em> th
column is to be used with the <em>i</em> th predator.</p>
</td></tr>
<tr><td><code id="comp.gen.pseudo.seals_+3A_fat.cont">fat.cont</code></td>
<td>
<p>vector of fat content</p>
</td></tr>
<tr><td><code id="comp.gen.pseudo.seals_+3A_noise">noise</code></td>
<td>
<p>proportion of noise to add to the simulation.</p>
</td></tr>
<tr><td><code id="comp.gen.pseudo.seals_+3A_nprey">nprey</code></td>
<td>
<p>number of prey to sample.</p>
</td></tr>
</table>

<hr>
<h2 id='comp.p.beta'>Bootstrap statistic function: in this case it is the mean
(meanBEZI) of the fitted (gamlss) ZIB distribution.</h2><span id='topic+comp.p.beta'></span>

<h3>Description</h3>

<p>Bootstrap statistic function: in this case it is the mean
(meanBEZI) of the fitted (gamlss) ZIB distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.p.beta(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comp.p.beta_+3A_data">data</code></td>
<td>
<p>data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the expected value of the response for a fitted model
</p>

<hr>
<h2 id='comp.rep'>Repeatability in Diet Estimates</h2><span id='topic+comp.rep'></span>

<h3>Description</h3>

<p>Computes a measure of repeatability for a sample of predators with repeated
diet estimate measurements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.rep(
  data,
  prey.database,
  fatcont.mat,
  dist.meas,
  ext.fa,
  B = 50,
  R = 100,
  CI = FALSE,
  alpha = 0.05,
  gamma.QFASA = 1,
  gamma.rho = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comp.rep_+3A_data">data</code></td>
<td>
<p>data frame of diet estimates. First column must denote the predator
and second column the second factor (eg. year or season).</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_prey.database">prey.database</code></td>
<td>
<p>prey data base that was used to compute the QFASA diet
estimates in <code>data</code>. Will be used to generate pseudo predators.</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_fatcont.mat">fatcont.mat</code></td>
<td>
<p>data frame or matrix of length equal to the number of prey
FA signatures in prey data base.  First column is name of species and
second column is lipid.</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_dist.meas">dist.meas</code></td>
<td>
<p>distance measure to use in <code>p.QFASA</code>.</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of FAs to use.</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_b">B</code></td>
<td>
<p>number of pseudo predators samples to generate for bias calculation.
Default is set to 50 because is slow to run.</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_r">R</code></td>
<td>
<p>number of bootstrap samples (i.e. <code>R</code> samples for each generated sample
of pseudo predators). Default is set to 100 because it is slow to run.</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_ci">CI</code></td>
<td>
<p>indicates if a confidence interval for rho is to be calculated.
Default is FALSE since this is time consuming to obtain.</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_alpha">alpha</code></td>
<td>
<p>a (1-alpha/2)X100 percent confidence interval is calculated for rho
if <code>CI=TRUE</code>.</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_gamma.qfasa">gamma.QFASA</code></td>
<td>
<p>if <code>dist.meas=3</code>, gamma is required.  Default is 1.</p>
</td></tr>
<tr><td><code id="comp.rep_+3A_gamma.rho">gamma.rho</code></td>
<td>
<p>value of gamma to be used to compute CS distance
in repeatablity functions.  Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bias corrected measure of repeatability, estimate of the bias and
(if <code>CI=TRUE</code>) a confidence interval for the true repeatability.
</p>


<h3>References</h3>

<p>&quot;Repeatability for Compositional Diet Estimates with Zeros&quot;.
Contact Connie Stewart (cstewart@unb.ca).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 ##  These examples take some time to run.
 ##  Please uncomment code below to run them.

# data(preyFAs)
# data(FAset)

## Balanced Diet Data

#my.preybase &lt;- preyFAs[,-c(1,3)]
#my.preybase[,-1] &lt;- my.preybase[,-1]/rowSums(my.preybase[,-1])

#set.seed(10)

#comp.rep(data = bal.diet.data,prey.database=my.preybase,
#fatcont.mat = as.data.frame(preyFAs[,c(2,3)]),dist.meas=2,
#ext.fa = as.vector(unlist(FAset)))

## Unbalanced Diet Data

# my.preybase &lt;- preyFAs[,-c(1,3)]
# my.preybase[,-1] &lt;- my.preybase[,-1]/rowSums(my.preybase[,-1])

# set.seed(10)

# comp.rep(unbal.diet.data,my.preybase,as.data.frame(preyFAs[,c(2,3)]),2,
# as.vector(unlist(FAset)))
</code></pre>

<hr>
<h2 id='comp.Tstar.beta'>Generate bootstrap replicates of diet proportion estimates for
given prey species</h2><span id='topic+comp.Tstar.beta'></span>

<h3>Description</h3>

<p>Generate bootstrap replicates of diet proportion estimates for
given prey species
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.Tstar.beta(p.k, theta.boot, mu.null, phi.boot, R.boot)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comp.Tstar.beta_+3A_p.k">p.k</code></td>
<td>
<p>list of predator diet proportions for prey species k</p>
</td></tr>
<tr><td><code id="comp.Tstar.beta_+3A_theta.boot">theta.boot</code></td>
<td>
<p>distribution parameter</p>
</td></tr>
<tr><td><code id="comp.Tstar.beta_+3A_mu.null">mu.null</code></td>
<td>
<p>distribution parameter</p>
</td></tr>
<tr><td><code id="comp.Tstar.beta_+3A_phi.boot">phi.boot</code></td>
<td>
<p>distribution parameter</p>
</td></tr>
<tr><td><code id="comp.Tstar.beta_+3A_r.boot">R.boot</code></td>
<td>
<p>number of bootstrap replicates to create</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of diet proportion replicates
</p>

<hr>
<h2 id='conf.meth'>Confidence Intervals for Diet Proportions</h2><span id='topic+conf.meth'></span>

<h3>Description</h3>

<p>Returns simultaneous confidence intervals for the diet of each species in the
prey database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conf.meth(
  predator.mat,
  prey.mat,
  p.mat,
  cal.mat = rep(1, length(ext.fa)),
  dist.meas,
  FC = rep(1, nrow(prey.mat)),
  alpha = 0.05,
  nprey = 30,
  R.p = 1,
  R.ps = 100,
  R = 100,
  R.bias = 100,
  noise = 0,
  ext.fa
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conf.meth_+3A_predator.mat">predator.mat</code></td>
<td>
<p>matrix containing fatty acid signatures of the predators
with fatty acids summing to one.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_prey.mat">prey.mat</code></td>
<td>
<p>prey database. A data frame with first column a
Species label and other columns fatty acid proportions summing to one..</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_p.mat">p.mat</code></td>
<td>
<p>matrix of previously computed predator diet estimates needed for
confidence interval calculation.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_cal.mat">cal.mat</code></td>
<td>
<p>matrix or vector of calibration coefficients of
predators. Each COLUMN corresponds to a different predator. Default is a
vector of ones. The number of fatty acids should be the same as the number
of predator and prey fatty acids.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_dist.meas">dist.meas</code></td>
<td>
<p>distance measure to use for estimation: 1=KL,
2=AIT or 3=CS</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_fc">FC</code></td>
<td>
<p>vector of prey fat content, one for each individual in prey database.
Note that this vector is
passed to the <code><a href="#topic+gen.pseudo.seals">gen.pseudo.seals</a></code> which expects fat
content values for individual prey samples while
<code><a href="#topic+pseudo.seal">pseudo.seal</a></code> and  <code><a href="#topic+p.QFASA">p.QFASA</a></code>
expect a species average.  Default is a vector of ones.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_alpha">alpha</code></td>
<td>
<p>1-alpha is the family-wise or overall confidence level.
Default is 0.05 for an overall confidence level of 0.95.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_nprey">nprey</code></td>
<td>
<p>number of prey to sample from the prey database
when generating pseudo predators for the nuisance parameter
estimation using original QFASA simulating code. Default is 30.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_r.p">R.p</code></td>
<td>
<p>number of times to re-sample data.  Due to algorithm being slow,
the default parameter is 1.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_r.ps">R.ps</code></td>
<td>
<p>number of pseudo predators to generate when estimating
nuisance parameters.  Default is 100.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_r">R</code></td>
<td>
<p>number of bootstrap replicates to use when generating
p-values for confidence interval estimation.  Default is 100.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_r.bias">R.bias</code></td>
<td>
<p>number of replicates for bias computation.  Default is 100.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_noise">noise</code></td>
<td>
<p>proportion of noise to include in the generation of pseudo predators
using original QFASA simulating code.</p>
</td></tr>
<tr><td><code id="conf.meth_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of fatty acids to be used.  These should be the same as
those in predator.mat, prey.mat and cal.mat.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Intervals are biased corrected as recommended in Stewart, C. (2013).
Intervals are slow to obtain, particularly if there are many prey types.
See vignette on parallel execution to speed up calculations.
</p>


<h3>Value</h3>

<p>Simultaneous (1-alpha)*100
zero-inflated beta distribution.
</p>


<h3>References</h3>

<p>Stewart, C. (2013) Zero-inflated beta distribution for
modeling the proportions in quantitative fatty acid signature
analysis. Journal of Applied Statistics, 40(5), 985-992.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Reducing prey database to three species so that code below will run more quickly.
## Please uncomment code to run.

#set.seed(1234)
## Fatty Acids
#data(FAset)
#fa.set = as.vector(unlist(FAset))

## Sample of Predators
#data(predatorFAs)
#predator.matrix = predatorFAs[, -c(1:4)]
#predator.matrix.ext = predatorFAs[,fa.set]
#predator.matrix.ext = predator.matrix.ext/rowSums(predator.matrix.ext)

# Prey Database
#prey.red =
#preyFAs[preyFAs$Species=="capelin"|preyFAs$Species=="herring"|preyFAs$Species=="sandlance", ]
#prey.red = prey.red[,-c(1,3)]
#prey.red.ext = prey.red[,c("Species",fa.set)]
#prey.red.ext[,-1] &lt;- prey.red.ext[,-1]/rowSums(prey.red.ext[,-1])
#prey.red.ext.means = MEANmeth(prey.red.ext)

## Calibration Coefficients

#data(CC)
#cal.vec = CC[CC$FA %in% fa.set, 2]

#diet.est &lt;- p.QFASA(predator.mat = predator.matrix.ext,
#                    prey.mat = prey.red.ext.means,
#                    cal.mat = cal.vec,
#                   dist.meas = 2,
#                    start.val = rep(1,nrow(prey.red.ext.means)),
#                    ext.fa = fa.set)[['Diet Estimates']]

## conf.meth needs the full prey matrix unlike p.QFASA.
#ci &lt;- conf.meth(predator.mat = predator.matrix.ext, prey.mat = prey.red.ext, cal.mat = cal.vec,
#          p.mat = diet.est, dist.meas = 2, FC = preyFAs[,3],ext.fa = fa.set)
</code></pre>

<hr>
<h2 id='create.d.mat'>Called by <code>testfordiff.ind.boot.fun()</code> to create a matrix of distances.</h2><span id='topic+create.d.mat'></span>

<h3>Description</h3>

<p>Called by <code>testfordiff.ind.boot.fun()</code> to create a matrix of distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.d.mat(Y.1, Y.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.d.mat_+3A_y.1">Y.1</code></td>
<td>
<p>vector</p>
</td></tr>
<tr><td><code id="create.d.mat_+3A_y.2">Y.2</code></td>
<td>
<p>vector</p>
</td></tr>
</table>

<hr>
<h2 id='cs_distance.mat'>CALCULATE CS DISTANCE BETWEEN EACH TWO PREDATORS IN dataset</h2><span id='topic+cs_distance.mat'></span>

<h3>Description</h3>

<p>CALCULATE CS DISTANCE BETWEEN EACH TWO PREDATORS IN dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cs_distance.mat(dataset, alpha = 1)
</code></pre>

<hr>
<h2 id='CS.more'>Used to provide additional information on various model components
evaluated at the optimal solution, i.e., using the QFASA diet estimates and
chi-square distance measure.</h2><span id='topic+CS.more'></span>

<h3>Description</h3>

<p>Used to provide additional information on various model components
evaluated at the optimal solution, i.e., using the QFASA diet estimates and
chi-square distance measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CS.more(alpha, predator, prey.quantiles, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CS.more_+3A_alpha">alpha</code></td>
<td>
<p>compositional QFASA diet estimate.</p>
</td></tr>
<tr><td><code id="CS.more_+3A_predator">predator</code></td>
<td>
<p>fatty acid signature of predator.</p>
</td></tr>
<tr><td><code id="CS.more_+3A_prey.quantiles">prey.quantiles</code></td>
<td>
<p>matrix of fatty acid signatures of
prey. Each row contains an individual prey signature from a different
species.</p>
</td></tr>
<tr><td><code id="CS.more_+3A_gamma">gamma</code></td>
<td>
<p>power transform exponent (see <code>chisq.dist()</code>).</p>
</td></tr>
</table>

<hr>
<h2 id='CS.obj'>Used in <code>solnp()</code> as the objective function to be minimized when
chi-square distance measure is chosen. Unlike <code>AIT.obj()</code> and <code>KL.obj()</code>,
does not require modifying zeros.</h2><span id='topic+CS.obj'></span>

<h3>Description</h3>

<p>Used in <code>solnp()</code> as the objective function to be minimized when
chi-square distance measure is chosen. Unlike <code>AIT.obj()</code> and <code>KL.obj()</code>,
does not require modifying zeros.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CS.obj(alpha, predator, prey.quantiles, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CS.obj_+3A_alpha">alpha</code></td>
<td>
<p>vector over which minimization takes place.</p>
</td></tr>
<tr><td><code id="CS.obj_+3A_predator">predator</code></td>
<td>
<p>fatty acid signature of predator.</p>
</td></tr>
<tr><td><code id="CS.obj_+3A_prey.quantiles">prey.quantiles</code></td>
<td>
<p>matrix of fatty acid signatures of
prey. Each row contains an individual prey signature from a different
species.</p>
</td></tr>
<tr><td><code id="CS.obj_+3A_gamma">gamma</code></td>
<td>
<p>power transform exponent (see <code>chisq.dist()</code>).</p>
</td></tr>
</table>

<hr>
<h2 id='data.sim.beta'>Bootstrap ran.gen function:</h2><span id='topic+data.sim.beta'></span>

<h3>Description</h3>

<p>Bootstrap ran.gen function:
</p>
<p>Bootstrap ran.gen function:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.sim.beta(data, mle)

data.sim.beta(data, mle)
</code></pre>

<hr>
<h2 id='dummy'>Roxygen commands</h2><span id='topic+dummy'></span>

<h3>Description</h3>

<p>Roxygen commands
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dummy()
</code></pre>

<hr>
<h2 id='evaluateCombination'>Get nll and IC values for a pair of species (this is used in forward
selection if the starting species are not specified; used on a list of all
possible combinations of two species)</h2><span id='topic+evaluateCombination'></span>

<h3>Description</h3>

<p>Get nll and IC values for a pair of species (this is used in forward
selection if the starting species are not specified; used on a list of all
possible combinations of two species)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluateCombination(
  species.index,
  species.list,
  pred.mat,
  prey.mat,
  cal.vec,
  fat.vec,
  ext.fa,
  k = 2
)
</code></pre>

<hr>
<h2 id='evaluateModel'>Get nll and IC values for a given model (note that the model is determined by
the species included in prey.mat - prey.mat is adjusted to add or remove
species before entering this function</h2><span id='topic+evaluateModel'></span>

<h3>Description</h3>

<p>Get nll and IC values for a given model (note that the model is determined by
the species included in prey.mat - prey.mat is adjusted to add or remove
species before entering this function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluateModel(pred.mat, prey.mat, cal.vec, fat.vec, ext.fa, k = 2)
</code></pre>

<hr>
<h2 id='FAset'>List of fatty acids used in sample prey and predator data sets,
<code>preyFAs</code> and <code>predatorFAs</code> respectively.</h2><span id='topic+FAset'></span>

<h3>Description</h3>

<p>List of fatty acids used in sample prey and predator data sets,
<code>preyFAs</code> and <code>predatorFAs</code> respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FAset
</code></pre>


<h3>Format</h3>

<p>A data frame with 39 observations and 1 variable:
</p>

<dl>
<dt>FA</dt><dd><p>Fatty acid name</p>
</dd>
</dl>


<hr>
<h2 id='forward.selection'>Returns diet estimates corresponding to a sample of predators based on a
forward selection algorithm that chooses the prey species to be included in
the modelling.</h2><span id='topic+forward.selection'></span>

<h3>Description</h3>

<p>Returns diet estimates corresponding to a sample of predators based on a
forward selection algorithm that chooses the prey species to be included in
the modelling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forward.selection(
  pred.mat,
  prey.mat,
  cal.vec,
  FC,
  ext.fa,
  k = 2,
  min.spec = 5,
  starting.spec = NULL,
  silence = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forward.selection_+3A_pred.mat">pred.mat</code></td>
<td>
<p>matrix containing the FA signatures of the predators, where
each row corresponds to a predator and each column to a FA.</p>
</td></tr>
<tr><td><code id="forward.selection_+3A_prey.mat">prey.mat</code></td>
<td>
<p>data frame containing the FA signatures of the prey, where
each row corresponds to a single individual prey.
The first column must index the prey group, while the
remaining columns correspond to FAs.</p>
</td></tr>
<tr><td><code id="forward.selection_+3A_cal.vec">cal.vec</code></td>
<td>
<p>numeric vector of calibration coefficients corresponding to
the FAs contained in the modelling subset ext.fa. A vector of
ones in the length of ext.fa may be used for modelling
without calibration coefficients.</p>
</td></tr>
<tr><td><code id="forward.selection_+3A_fc">FC</code></td>
<td>
<p>numeric vector of the average lipid contents for each prey
group, in the order of the <em>alphabetized</em> prey groups.
vector of ones equal in length to the number of prey groups
may be used for modelling without adjustment for fat content.</p>
</td></tr>
<tr><td><code id="forward.selection_+3A_ext.fa">ext.fa</code></td>
<td>
<p>character vector containing the subset of FAs to be used in
modelling.</p>
</td></tr>
<tr><td><code id="forward.selection_+3A_k">k</code></td>
<td>
<p>scaling factor to be used in calculating the value of the
information criterion (IC). The default value of 2
corresponds to the Akaike Information Criterion. For a sample
of size n, k = log(n) corresponds to the Bayesian Information
Criterion. As this factor is numeric, values corresponding to
other IC may be used freely.</p>
</td></tr>
<tr><td><code id="forward.selection_+3A_min.spec">min.spec</code></td>
<td>
<p>optional integer value specifying the minimum final model
size for forward selection. By default, forward selection
will add species to the model until the value of the chosen
IC ceases to improve. If this parameter is increased, forward
selection will add the best available species up to the
specified minimum model size before continuing with the
default selection process.</p>
</td></tr>
<tr><td><code id="forward.selection_+3A_starting.spec">starting.spec</code></td>
<td>
<p>optional character vector specifying the starting
species for the forward selection algorithm. Where known,
two or more species may be specified to ensure their
inclusion in the final model, reducing computation times
for the algorithm.  The default is NULL.</p>
</td></tr>
<tr><td><code id="forward.selection_+3A_silence">silence</code></td>
<td>
<p>if true, additional information is printed. Default is false.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses a forward selection algorithm and the simplified
MLE method to choose the prey species to be included in the model and then
returns the diet estimates corresponding to these species.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>Diet_Estimates</code></td>
<td>
<p>A matrix of the diet estimates for each predator where
each row corresponds to a predator and each column to a prey species. The
estimates are expressed as proportions summing to one.</p>
</td></tr>
<tr><td><code>Selection_Order</code></td>
<td>
<p>A data frame summarizing each step of the algorithm,
giving the order of species selection and the corresponding IC values.</p>
</td></tr>
<tr><td><code>Selection_Tables</code></td>
<td>
<p>A list containing a data frame for each step of the
selection process, providing the IC values associated with adding any one
candidate species at that step.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><em>backward.elimination()</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 ## This example takes some time to run.
 ## Please uncomment code below to run.

#library(dplyr)
#library(compositions)
## Package data: FAs
#data(FAset)
#fa.set = as.vector(unlist(FAset))

## Package data: Prey
#data(preyFAs)
#prey.sub=(preyFAs[,4:(ncol(preyFAs))])[fa.set]
#prey.sub=prey.sub/apply(prey.sub,1,sum)
#group=as.vector(preyFAs$Species)
#prey.sub = cbind(group,prey.sub)
#sort.preytype &lt;- order(prey.sub[, 1])
#prey.matrix &lt;- prey.sub[sort.preytype,]

## Package data: Predators
#data(predatorFAs)
#tombstone.info = predatorFAs[,1:4]
#predator.matrix = predatorFAs[,5:(ncol(predatorFAs))]
#npredators = nrow(predator.matrix)

## Package data: Fat content
#FC = preyFAs[,c(2,3)]
#FC = as.vector(tapply(FC$lipid,FC$Species,mean,na.rm=TRUE))

## Package data: Calibration coefficients
#data(CC)
#cal.vec = CC[,2]
#cal.mat = replicate(npredators, cal.vec)
#rownames(cal.mat) &lt;- CC$FA
#names(cal.vec) &lt;- rownames(cal.mat)

## QFASA (KL)
#sample.qfasa &lt;- p.QFASA(predator.matrix,MEANmeth(prey.matrix),cal.mat,
#dist.meas = 1,gamma=1,FC,
#start.val = rep(1,nrow(MEANmeth(prey.matrix))),fa.set)

## Forward Selection
#sample.fs &lt;- forward.selection(predator.matrix,prey.matrix,cal.vec,FC,fa.set,
#min.spec = 5,starting.spec = c("capelin", "herring"))
## Output
#fs.estimates &lt;- sample.fs$`Diet Estimates`
</code></pre>

<hr>
<h2 id='gen.pseudo.seals'>Generate pseudo predators with ith predator having true diet
given by ith row of diet.null.mat.</h2><span id='topic+gen.pseudo.seals'></span>

<h3>Description</h3>

<p>Generate pseudo predators with ith predator having true diet
given by ith row of diet.null.mat.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.pseudo.seals(prey.mat, diet.null.mat, cal.mat, fat.cont, noise, nprey)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen.pseudo.seals_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing a representative FA signature
from each prey group (usually the mean). The first column must
index the prey group.</p>
</td></tr>
<tr><td><code id="gen.pseudo.seals_+3A_diet.null.mat">diet.null.mat</code></td>
<td>
<p>null diet</p>
</td></tr>
<tr><td><code id="gen.pseudo.seals_+3A_cal.mat">cal.mat</code></td>
<td>
<p>matrix of calibration coefficients where the <em>i</em> th
column is to be used with the <em>i</em> th predator.</p>
</td></tr>
<tr><td><code id="gen.pseudo.seals_+3A_fat.cont">fat.cont</code></td>
<td>
<p>vector of fat content</p>
</td></tr>
<tr><td><code id="gen.pseudo.seals_+3A_noise">noise</code></td>
<td>
<p>proportion of noise to add to the simulation.</p>
</td></tr>
<tr><td><code id="gen.pseudo.seals_+3A_nprey">nprey</code></td>
<td>
<p>number of prey to sample.</p>
</td></tr>
</table>

<hr>
<h2 id='KL.dist'>Returns the distance between two compositional vectors using Kullback&ndash;Leibler
distance measure.</h2><span id='topic+KL.dist'></span>

<h3>Description</h3>

<p>Returns the distance between two compositional vectors using Kullback&ndash;Leibler
distance measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KL.dist(x.1, x.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KL.dist_+3A_x.1">x.1</code></td>
<td>
<p>compositional vector</p>
</td></tr>
<tr><td><code id="KL.dist_+3A_x.2">x.2</code></td>
<td>
<p>compositional vector</p>
</td></tr>
</table>


<h3>References</h3>

<p>S.J. Iverson, C. Field, W.D. Bowen, and W. Blanchard (2004)  Quantitative
fatty acid signature analysis: A new method of estimating predator diets, Ecological
Monographs 72, pp. 211-235.
</p>

<hr>
<h2 id='KL.more'>Used to provide additional information on various model components
evaluated at the optimal solution, i.e., using the QFASA diet estimates and
Kullback-Leibler distance measure.</h2><span id='topic+KL.more'></span>

<h3>Description</h3>

<p>Used to provide additional information on various model components
evaluated at the optimal solution, i.e., using the QFASA diet estimates and
Kullback-Leibler distance measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KL.more(alpha, predator, prey.quantiles)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KL.more_+3A_alpha">alpha</code></td>
<td>
<p>compositional QFASA diet estimate.</p>
</td></tr>
<tr><td><code id="KL.more_+3A_predator">predator</code></td>
<td>
<p>fatty acid signature of predator.</p>
</td></tr>
<tr><td><code id="KL.more_+3A_prey.quantiles">prey.quantiles</code></td>
<td>
<p>matrix of fatty acid signatures of
prey. Each row contains an individual prey signature from a different
species.</p>
</td></tr>
</table>

<hr>
<h2 id='KL.obj'>Used in <code>solnp()</code> as the objective function to be minimized when
Kullback&ndash;Leibler distance measure is chosen.</h2><span id='topic+KL.obj'></span>

<h3>Description</h3>

<p>Used in <code>solnp()</code> as the objective function to be minimized when
Kullback&ndash;Leibler distance measure is chosen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KL.obj(alpha, predator, prey.quantiles)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KL.obj_+3A_alpha">alpha</code></td>
<td>
<p>vector over which minimization takes place.</p>
</td></tr>
<tr><td><code id="KL.obj_+3A_predator">predator</code></td>
<td>
<p>fatty acid signature of predator.</p>
</td></tr>
<tr><td><code id="KL.obj_+3A_prey.quantiles">prey.quantiles</code></td>
<td>
<p>matrix of fatty acid signatures of
prey. Each row contains an individual prey signature from a different
species.</p>
</td></tr>
</table>

<hr>
<h2 id='likelihoodEstimates'>Get simplified MLE estimates</h2><span id='topic+likelihoodEstimates'></span>

<h3>Description</h3>

<p>Get simplified MLE estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likelihoodEstimates(pred.mat, prey.mat, cal.mat, fat.vec, ext.fa)
</code></pre>

<hr>
<h2 id='mean_geometric'>Returns the geometric mean of a compositional vector</h2><span id='topic+mean_geometric'></span>

<h3>Description</h3>

<p>Returns the geometric mean of a compositional vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_geometric(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mean_geometric_+3A_x">x</code></td>
<td>
<p>compositional vector</p>
</td></tr>
</table>

<hr>
<h2 id='MEANmeth'>Returns the multivariate mean FA signature of each prey group
entered into the QFASA model. Result can be passed to prey.mat in
<code>p.QFASA()</code>.</h2><span id='topic+MEANmeth'></span>

<h3>Description</h3>

<p>Returns the multivariate mean FA signature of each prey group
entered into the QFASA model. Result can be passed to prey.mat in
<code>p.QFASA()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MEANmeth(prey.mat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MEANmeth_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing the FA signatures of the
prey. The first column indexes the prey group.</p>
</td></tr>
</table>

<hr>
<h2 id='mod.zeros.FA.sig'>Modifies the zeros for a single FA signature using the multiplicative
replacement method (and same delta for every zero).</h2><span id='topic+mod.zeros.FA.sig'></span>

<h3>Description</h3>

<p>Modifies the zeros for a single FA signature using the multiplicative
replacement method (and same delta for every zero).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mod.zeros.FA.sig(y, delta)
</code></pre>

<hr>
<h2 id='mod.zeros.FA.sig.mat'>Modifies the zeros for a sample of FA signatures using the multiplicative
replacement method (and same delta for every zero).</h2><span id='topic+mod.zeros.FA.sig.mat'></span>

<h3>Description</h3>

<p>Modifies the zeros for a sample of FA signatures using the multiplicative
replacement method (and same delta for every zero).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mod.zeros.FA.sig.mat(y.mat, delta)
</code></pre>

<hr>
<h2 id='multiplicativeReplacement'>Multiplicative replacement of zeroes</h2><span id='topic+multiplicativeReplacement'></span>

<h3>Description</h3>

<p>Multiplicative replacement of zeroes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiplicativeReplacement(compositional.mat, delta = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiplicativeReplacement_+3A_compositional.mat">compositional.mat</code></td>
<td>
<p>matrix containing compositional data (for example, FA signatures)
that may contain zeros.</p>
</td></tr>
<tr><td><code id="multiplicativeReplacement_+3A_delta">delta</code></td>
<td>
<p>imputed value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The compositional matrix with zeros modified.
</p>

<hr>
<h2 id='opt.beta.lim'>Find simultaneous confidence intervals for diet
proportions of a single prey species i.e. solve f(pio) = PVAL(pio)
= alpha1.  Calls root finding function root.beta.</h2><span id='topic+opt.beta.lim'></span>

<h3>Description</h3>

<p>Find simultaneous confidence intervals for diet
proportions of a single prey species i.e. solve f(pio) = PVAL(pio)
= alpha1.  Calls root finding function root.beta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opt.beta.lim(alpha1, par.list, R, p.mat, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opt.beta.lim_+3A_alpha1">alpha1</code></td>
<td>
<p>simultaneous confidence level</p>
</td></tr>
<tr><td><code id="opt.beta.lim_+3A_par.list">par.list</code></td>
<td>
<p>a list of R.p lists of I beta distribution parameters phi
and theta that define diet proportion estimates for each of the
prey species. Effectively R.p beta distributions for each of the
I prey species from which we bootstrap to calculate p-values.</p>
</td></tr>
<tr><td><code id="opt.beta.lim_+3A_r">R</code></td>
<td>
<p>number of bootstrap replicates to use in p-value estimation.</p>
</td></tr>
<tr><td><code id="opt.beta.lim_+3A_p.mat">p.mat</code></td>
<td>
<p>predator diet estimates.</p>
</td></tr>
<tr><td><code id="opt.beta.lim_+3A_k">k</code></td>
<td>
<p>prey species index 1...I</p>
</td></tr>
</table>


<h3>Value</h3>

<p>upper and lower limits simultaneous
intervals respectively.
</p>

<hr>
<h2 id='p.beta'>Bootstrap statistic function: in this case it is the mean
(meanBEZI) of the fitted (gamlss) ZIB distribution.</h2><span id='topic+p.beta'></span>

<h3>Description</h3>

<p>Bootstrap statistic function: in this case it is the mean
(meanBEZI) of the fitted (gamlss) ZIB distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.beta(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.beta_+3A_data">data</code></td>
<td>
<p>data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the expected value of the response for a fitted model
</p>

<hr>
<h2 id='p.MLE'>Returns simplified MLE diet estimates corresponding to a sample of predators.</h2><span id='topic+p.MLE'></span>

<h3>Description</h3>

<p>Computes the diet estimate for each predator in <em>pred.mat</em> using the
simplified MLE method, without the use of random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.MLE(pred.mat, prey.mat, cal.mat, FC, ext.fa)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.MLE_+3A_pred.mat">pred.mat</code></td>
<td>
<p>matrix containing the FA signatures of the predators.</p>
</td></tr>
<tr><td><code id="p.MLE_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing the FA signatures of the individual prey.
The first column must index the prey group.
<em>prey.mat</em> is the prey database.</p>
</td></tr>
<tr><td><code id="p.MLE_+3A_cal.mat">cal.mat</code></td>
<td>
<p>matrix of calibration factors where the <em>i</em> th
column is to be used with the <em>i</em> th predator. If modelling is to be
done without calibration coefficients, simply pass a vector or matrix of
ones.</p>
</td></tr>
<tr><td><code id="p.MLE_+3A_fc">FC</code></td>
<td>
<p>vector of fat content of length equal to the number of prey groups
or species.</p>
</td></tr>
<tr><td><code id="p.MLE_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of fatty acids to be used to obtain diet estimates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The assumed model is similar to the MUFASA model but the random
effects are replaced by the prey species' sample means to speed up
computations. Unlike <em>p.MUFASA</em>, this function does not require
integration and hence is much faster.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>Diet_Estimates</code></td>
<td>
<p>A matrix of the diet estimates for each predator where
each row corresponds to a predator and the columns to prey species.
The estimates are expressed as proportions summing to one.</p>
</td></tr>
<tr><td><code>Var_Epsilon</code></td>
<td>
<p>Optimized values of error variance.  See reference.</p>
</td></tr>
<tr><td><code>nll</code></td>
<td>
<p>Negative log likelihood values.  As per <em>solnp</em> documentation,
<em>nll</em> is a &quot;vector of function values during optimization
with last one the value at the optimal&quot;.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Steeves, Holly (2020) Maximum likelihood approach to diet
estimation and inference based on fatty acid signatures. PhD thesis available
at https://dalspace.library.dal.ca/handle/10222/80034.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##  This example takes some time to run.
## Please uncomment the code below to run.


#library(dplyr)
#library(compositions)


## Fatty Acids
#data(FAset)
#ext.fa &lt;- as.vector(unlist(FAset))

## Predators
#data(predatorFAs)
#pred.mat &lt;- predatorFAs[, -c(1:4)]
#n.pred &lt;- nrow(pred.mat)

## Prey
#data(preyFAs)
#prey.mat &lt;- preyFAs[, -c(1,3)]

#FC = preyFAs[,c(2,3)]
#FC = as.vector(tapply(FC$lipid,FC$Species,mean,na.rm=TRUE))

## Calibration Coefficients
#data(CC)
#cal.vec = CC[,2]
#cal.mat = replicate(n.pred, cal.vec)
#rownames(cal.mat) &lt;- CC$FA


## Diet Estimates
#mle.est &lt;- p.MLE(pred.mat, prey.mat, cal.mat, FC, ext.fa)
#mle.est$"Diet Estimates"
</code></pre>

<hr>
<h2 id='p.MUFASA'>Returns MUFASA diet estimates corresponding to a sample of predators.</h2><span id='topic+p.MUFASA'></span>

<h3>Description</h3>

<p>Computes the diet estimate for each predator in <em>pred.mat</em> using MLE
method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.MUFASA(pred.mat, prey.mat, cal.mat, FC, ext.fa)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.MUFASA_+3A_pred.mat">pred.mat</code></td>
<td>
<p>matrix containing the FA signatures of the predators.</p>
</td></tr>
<tr><td><code id="p.MUFASA_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing  FA signatures from each prey group
The first column must index the prey
group.  <em>prey.mat</em> is the prey database.</p>
</td></tr>
<tr><td><code id="p.MUFASA_+3A_cal.mat">cal.mat</code></td>
<td>
<p>matrix of calibration factors where the <em>i</em> th
column is to be used with the <em>i</em> th predator. If modelling is to be
done without calibration coefficients, simply pass a vector or matrix of
ones. <em>cal.mat</em> must contain names of FAs.</p>
</td></tr>
<tr><td><code id="p.MUFASA_+3A_fc">FC</code></td>
<td>
<p>vector of fat content of length equal to the number of prey groups
or species.</p>
</td></tr>
<tr><td><code id="p.MUFASA_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of fatty acids to be used to obtain QFASA diet estimates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>Diet_Estimates</code></td>
<td>
<p>A matrix of the diet estimates for each predator where
each row corresponds to a predator and the columns to prey species.
The estimates are expressed as proportions summing to one.</p>
</td></tr>
<tr><td><code>nll</code></td>
<td>
<p>Negative log likelihood values.  As per <em>solnp</em> documentation,
<em>nll</em> is &quot;Vector of function values during optimization with
last one the value at the optimal&quot;.</p>
</td></tr>
<tr><td><code>Var_Epsilon</code></td>
<td>
<p>Optimized values of error variance.  See reference.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Steeves, Holly (2020) Maximum likelihood approach to diet
estimation and inference based on fatty acid signatures. PhD thesis available
at https://dalspace.library.dal.ca/handle/10222/80034.
</p>


<h3>See Also</h3>

<p><em>p.MLE()</em> for a simplifed version of <em>p.MUFASA()</em> that is
faster to run.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 ## This example takes some time to run.
 ## Please uncomment code below to run.

#library(dplyr)
#library(compositions)
 ## Fatty Acids
#data(FAset)
#fa.set = as.vector(unlist(FAset))

## Predators
#data(predatorFAs)
#tombstone.info = predatorFAs[,1:4]
#predator.matrix = predatorFAs[,5:(ncol(predatorFAs))]
#npredators = nrow(predator.matrix)

## Prey
## Extracting a small number of species to speed up calculations for the example.
#data(preyFAs)
#prey.matrix = preyFAs[,-c(1,3)]
#spec.red &lt;-c("capelin", "herring", "mackerel", "pilchard", "sandlance")
#spec.red &lt;- sort(spec.red)
#prey.red &lt;- prey.matrix %&gt;% filter(Species %in% spec.red)

## Fat content
#FC = preyFAs[,c(2,3)]
#FC = FC %&gt;%  arrange(Species)
#FC.vec = tapply(FC$lipid,FC$Species,mean,na.rm=TRUE)
#FC.red &lt;- FC.vec[spec.red]

## Calibration Coefficients
#data(CC)
#cal.vec = CC[,2]
#cal.m = replicate(npredators, cal.vec)
#rownames(cal.m) &lt;- CC$FA

#M &lt;- p.MUFASA(predator.matrix, prey.red, cal.m, FC.red, fa.set)

## Diet EStimates

#M$Diet_Estimates

</code></pre>

<hr>
<h2 id='p.QFASA'>Returns QFASA diet estimates corresponding to a sample of predators.</h2><span id='topic+p.QFASA'></span>

<h3>Description</h3>

<p>Computes the diet estimate for each predator in <em>predator.mat</em> using
either the Kullback-Leibler Distance (KL), the Aitchison Distance
(AIT) or the Chi-Square Distance (CS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.QFASA(
  predator.mat,
  prey.mat,
  cal.mat,
  dist.meas,
  gamma = 1,
  FC = rep(1, nrow(prey.mat)),
  start.val = rep(0.99999, nrow(prey.mat)),
  ext.fa
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.QFASA_+3A_predator.mat">predator.mat</code></td>
<td>
<p>matrix containing the FA signatures of the predators.</p>
</td></tr>
<tr><td><code id="p.QFASA_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing a representative FA signature
from each prey group (usually the mean). The first column must
index the prey group. Note can use function <em>MEANmeth</em> to calculate the means.</p>
</td></tr>
<tr><td><code id="p.QFASA_+3A_cal.mat">cal.mat</code></td>
<td>
<p>matrix of calibration factors where the <em>i</em> th
column is to be used with the <em>i</em> th predator. If modelling is to be done without
calibration coefficients, simply pass a vector or matrix of ones.</p>
</td></tr>
<tr><td><code id="p.QFASA_+3A_dist.meas">dist.meas</code></td>
<td>
<p>distance measure to use for estimation: 1=KL,
2=AIT or 3=CS</p>
</td></tr>
<tr><td><code id="p.QFASA_+3A_gamma">gamma</code></td>
<td>
<p>parameter required for calculations using CS distance
(passed to CS.obj). Currently being set to 1.</p>
</td></tr>
<tr><td><code id="p.QFASA_+3A_fc">FC</code></td>
<td>
<p>vector of fat content of length equal to the number of prey groups
or species.</p>
</td></tr>
<tr><td><code id="p.QFASA_+3A_start.val">start.val</code></td>
<td>
<p>initial vector of parameters to be optimized</p>
</td></tr>
<tr><td><code id="p.QFASA_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of fatty acids to be used to obtain QFASA diet estimates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Before carrying out an analysis using QFASA, rows of prey database must be normalized to sum to one.
See Example for code that extracts a subset of FAs and then normalizes the prey database signatures.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>Diet Estimates</code></td>
<td>
<p>A matrix of the diet estimates for each predator where each row corresponds to a predator and the columns to prey species. The estimates are expressed as proportions summing to one.</p>
</td></tr>
<tr><td><code>Additional Measures</code></td>
<td>
<p>For each predator for which a diet estimate was obtained:</p>
</td></tr>
<tr><td><code>ModFAS</code></td>
<td>
<p>the value of the modelled fatty acid. These are expressed as proportions summing to one.</p>
</td></tr>
<tr><td><code>DistCont</code></td>
<td>
<p>The contribution of each fatty acid to the final minimized distance.</p>
</td></tr>
<tr><td><code>PropDistCont</code></td>
<td>
<p>The contribution of each fatty acid to the final minimized distance as a proportion of the total.</p>
</td></tr>
<tr><td><code>MinDist</code></td>
<td>
<p>The final minimized distance.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Iverson, Sara J., Field, Chris, Bowen, W. Don and
Blanchard, Wade (2004) Quantitative Fatty Acid Signature Analysis: A New
Method of Estimating Predator Diets. Ecological Monographs, 74(2), 211-235
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Fatty Acids
 data(FAset)
 fa.set = as.vector(unlist(FAset))

 ## Predators
 data(predatorFAs)
 tombstone.info = predatorFAs[,1:4]
 predator.matrix = predatorFAs[,5:(ncol(predatorFAs))]
 npredators = nrow(predator.matrix)

 ## Prey
 data(preyFAs)
 prey.sub=(preyFAs[,4:(ncol(preyFAs))])[fa.set]
 prey.sub=prey.sub/apply(prey.sub,1,sum)
 group=as.vector(preyFAs$Species)
 prey.matrix=cbind(group,prey.sub)
 prey.matrix=MEANmeth(prey.matrix)

 ## Fat Content

 FC = preyFAs[,c(2,3)]
 FC = as.vector(tapply(FC$lipid,FC$Species,mean,na.rm=TRUE))

 ## Calibration Coefficients
 data(CC)
 cal.vec = CC[,2]
 cal.mat = replicate(npredators, cal.vec)

 ## Run QFASA
 Q = p.QFASA(predator.matrix,
             prey.matrix,
             cal.mat,
             dist.meas = 1,
             gamma=1,
             FC,
             start.val = rep(1,nrow(prey.matrix)),
             fa.set)

## Diet Estimates
DietEst = Q$'Diet Estimates'

</code></pre>

<hr>
<h2 id='p.sim.QFASA'>Simultaneous estimation of diet composition and calibration coefficients</h2><span id='topic+p.sim.QFASA'></span>

<h3>Description</h3>

<p>Computes the diet estimate for each predator in <em>pred.sig</em> as well as an
overall estimate of the calibration coefficient vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.sim.QFASA(pred.sig, prey.mat, FC = rep(1, nrow(prey.mat)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.sim.QFASA_+3A_pred.sig">pred.sig</code></td>
<td>
<p>matrix containing the FA signatures of the predator</p>
</td></tr>
<tr><td><code id="p.sim.QFASA_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing a representative FA signature from each
prey group (usually the mean).  The first column must index
the prey group.</p>
</td></tr>
<tr><td><code id="p.sim.QFASA_+3A_fc">FC</code></td>
<td>
<p>vector of fat content of length equal to the number of prey groups
(or species)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Starting values for the diet estimates are equal proportions
and a vector of ones is used for the calibration coefficients.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>diet.est</code></td>
<td>
<p>A matrix of the diet estimates for each predator where each
row corresponds to a predator and the columns to prey species. The estimates
are expressed as proportions summing to one.</p>
</td></tr>
<tr><td><code>cc.est</code></td>
<td>
<p>Estimated vector of calibration coefficients</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bromaghin, Jeffrey F., Budge, Suzanne M.,  Thiemann, Gregory and
Rode, Karyn D. (2017) Simultaneous estimation of the diet composition and
calibration coefficients with fatty acid signature data.
Ecology and Evolution, 7(16), 6103-6113
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##  This example takes some time to run.
## Please uncomment code below to run.

## Fatty Acids
#data(FAset)
#fa.set = as.vector(unlist(FAset))

## Predators
#data(predatorFAs)
#tombstone.info = predatorFAs[,1:4]
#predator.matrix = predatorFAs[,5:(ncol(predatorFAs))]
#npredators = nrow(predator.matrix)

## Need predator and prey to have same length

#predator.ext &lt;- predator.matrix[fa.set]
#predator.ext &lt;- predator.ext/rowSums(predator.ext)

## Prey
#data(preyFAs)
#prey.sub=(preyFAs[,4:(ncol(preyFAs))])[fa.set]
#prey.sub=prey.sub/apply(prey.sub,1,sum)
#group=as.vector(preyFAs$Species)
#prey.matrix=cbind(group,prey.sub)
#prey.matrix=MEANmeth(prey.matrix)

## Fat Content
#FC = preyFAs[,c(2,3)]
#FC = as.vector(tapply(FC$lipid,FC$Species,mean,na.rm=TRUE))

#Q.sim &lt;-p.sim.QFASA(predator.ext,prey.matrix,FC)
## Average Diet Estimate
#round(colMeans(Q.sim[[1]]),3)
## Calibration Coefficients
#Q.sim[[2]]
</code></pre>

<hr>
<h2 id='p.SMUFASA'>Simultaneous maximum unified fatty acid signature analysis</h2><span id='topic+p.SMUFASA'></span>

<h3>Description</h3>

<p>Returns SMUFASA calibration coefficient estimates and an average diet among
a sample of predators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.SMUFASA(pred.mat, prey.mat, FC, ext.fa)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.SMUFASA_+3A_pred.mat">pred.mat</code></td>
<td>
<p>matrix containing the FA signatures of the predators.</p>
</td></tr>
<tr><td><code id="p.SMUFASA_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing FA signatures from each prey group.
The first column must index the prey group.
<em>prey.mat</em> is the prey database.</p>
</td></tr>
<tr><td><code id="p.SMUFASA_+3A_fc">FC</code></td>
<td>
<p>vector of fat content of length equal to the number of prey groups
or species.</p>
</td></tr>
<tr><td><code id="p.SMUFASA_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of fatty acids to be used to obtain estimates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calibration coefficients (CCs) are not supplied but are
instead estimated. While one overall diet is computed, the CCs can
be used in p.QFASA or p.MUFASA to estimate individual diet
estimates.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>Cal_Estimates</code></td>
<td>
<p>A vector of estimated calibration coefficients common
to all predators. The <em>k</em> th value corresponds to the <em>k</em> th
fatty acid. The estimates sum to the number of fatty acids.</p>
</td></tr>
<tr><td><code>Diet_Estimate</code></td>
<td>
<p>A vector of estimates of the average diet among the
predators. The estimates are expressed as proportions summing to one.</p>
</td></tr>
<tr><td><code>Var_Epsilon</code></td>
<td>
<p>Optimized values of error variance.</p>
</td></tr>
<tr><td><code>nll</code></td>
<td>
<p>Negative log likelihood values.  As per <em>solnp</em> documentation,
<em>nll</em> is &quot;Vector of function values during optimization with
last one the value at the optimal&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## This example takes some time to run.
## Please uncomment code below to run.

#library(dplyr)
#library(compositions)
## Fatty Acids
#data(FAset)
#fa.set = as.vector(unlist(FAset))

## Predators
#data(predatorFAs)
#tombstone.info = predatorFAs[,1:4]
#predator.matrix = predatorFAs[,5:(ncol(predatorFAs))]
#npredators = nrow(predator.matrix)

## Prey
## Extracting a small number of species to speed up calculations for the example.
#data(preyFAs)
#prey.matrix = preyFAs[,-c(1,3)]
#spec.red &lt;-c("capelin", "herring", "mackerel", "pilchard", "sandlance")
#spec.red &lt;- sort(spec.red)
#prey.red &lt;- prey.matrix %&gt;% filter(Species %in% spec.red)

## Fat content
#FC = preyFAs[,c(2,3)]
#FC = FC %&gt;%  arrange(Species)
#FC.vec = tapply(FC$lipid,FC$Species,mean,na.rm=TRUE)
#FC.red &lt;- FC.vec[spec.red]

#out &lt;- p.SMUFASA(predator.matrix, prey.red, FC.red, fa.set)

#out$Cal_Estimates

</code></pre>

<hr>
<h2 id='POOLVARmeth'>Computes within species variance-covariance matrices on transformed scaled,
along with a pooled estimate.</h2><span id='topic+POOLVARmeth'></span>

<h3>Description</h3>

<p>Computes within species variance-covariance matrices on transformed scaled,
along with a pooled estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POOLVARmeth(prey.mat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="POOLVARmeth_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix containing transformed FA signatures of the prey.
Note that the first column indexes prey type.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the variance-covariance matrix of each prey type as well as
a pooled estimate of the variance-covariance matrix
</p>

<hr>
<h2 id='predatorFAs'>Predator fatty acid signatures. Each predator signature is a row
with fatty acid proportions in columns.</h2><span id='topic+predatorFAs'></span>

<h3>Description</h3>

<p>Fatty acid signatures are subsetted for the chosen fatty acid set
and renormalized during the modelling so there is no need to subset
and/or renormalize prior to running p.QFASA. However, make sure that
the the same fatty acids appear in the predator and prey files (if a
FA appears in one but not the other the code will give you an
error).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predatorFAs
</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations and 70 variables:
</p>

<dl>
<dt>SampleCode</dt><dd><p>TODO</p>
</dd>
<dt>AnimalCode</dt><dd><p>TODO</p>
</dd>
<dt>SampleGroup</dt><dd><p>TODO</p>
</dd>
<dt>Biopsy</dt><dd><p>TODO</p>
</dd>
<dt>c12.0</dt><dd></dd>
<dt>c13.0</dt><dd></dd>
<dt>Iso14</dt><dd></dd>
<dt>c14.0</dt><dd></dd>
<dt>c14.1w9</dt><dd></dd>
<dt>c14.1w7</dt><dd></dd>
<dt>c14.1w5</dt><dd></dd>
<dt>Iso15</dt><dd></dd>
<dt>Anti15</dt><dd></dd>
<dt>c15.0</dt><dd></dd>
<dt>c15.1w8</dt><dd></dd>
<dt>c15.1w6</dt><dd></dd>
<dt>Iso16</dt><dd></dd>
<dt>c16.0</dt><dd></dd>
<dt>c16.1w11</dt><dd></dd>
<dt>c16.1w9</dt><dd></dd>
<dt>c16.1w7</dt><dd></dd>
<dt>c7Mec16.0</dt><dd></dd>
<dt>c16.1w5</dt><dd></dd>
<dt>c16.2w6</dt><dd></dd>
<dt>Iso17</dt><dd></dd>
<dt>c16.2w4</dt><dd></dd>
<dt>c16.3w6</dt><dd></dd>
<dt>c17.0</dt><dd></dd>
<dt>c16.3w4</dt><dd></dd>
<dt>c17.1</dt><dd></dd>
<dt>c16.4w3</dt><dd></dd>
<dt>c16.4w1</dt><dd></dd>
<dt>c18.0</dt><dd></dd>
<dt>c18.1w13</dt><dd></dd>
<dt>c18.1w11</dt><dd></dd>
<dt>c18.1w9</dt><dd></dd>
<dt>c18.1w7</dt><dd></dd>
<dt>c18.1w5</dt><dd></dd>
<dt>c18.2d5.11</dt><dd></dd>
<dt>c18.2w7</dt><dd></dd>
<dt>c18.2w6</dt><dd></dd>
<dt>c18.2w4</dt><dd></dd>
<dt>c18.3w6</dt><dd></dd>
<dt>c18.3w4</dt><dd></dd>
<dt>c18.3w3</dt><dd></dd>
<dt>c18.3w1</dt><dd></dd>
<dt>c18.4w3</dt><dd></dd>
<dt>c18.4w1</dt><dd></dd>
<dt>c20.0</dt><dd></dd>
<dt>c20.1w11</dt><dd></dd>
<dt>c20.1w9</dt><dd></dd>
<dt>c20.1w7</dt><dd></dd>
<dt>c20.2w9</dt><dd></dd>
<dt>c20.2w6</dt><dd></dd>
<dt>c20.3w6</dt><dd></dd>
<dt>c20.4w6</dt><dd></dd>
<dt>c20.3w3</dt><dd></dd>
<dt>c20.4w3</dt><dd></dd>
<dt>c20.5w3</dt><dd></dd>
<dt>c22.1w11</dt><dd></dd>
<dt>c22.1w9</dt><dd></dd>
<dt>c22.1w7</dt><dd></dd>
<dt>c22.2w6</dt><dd></dd>
<dt>c21.5w3</dt><dd></dd>
<dt>c22.4w6</dt><dd></dd>
<dt>c22.5w6</dt><dd></dd>
<dt>c22.4w3</dt><dd></dd>
<dt>c22.5w3</dt><dd></dd>
<dt>c22.6w3</dt><dd></dd>
<dt>c24.1w9</dt><dd></dd>
</dl>



<h3>Details</h3>

<p>Unlike the original QFASApack code the predator data can
contain as much tombstone data in columns as you wish but the
predator FA signatures must be extracted as a separate input in
order to run in p.QFASA.
</p>

<hr>
<h2 id='prey.cluster'>Produces a dendrogram using distances between the mean
FA signatures of the prey types.</h2><span id='topic+prey.cluster'></span>

<h3>Description</h3>

<p>Performs a hierarchical cluster analysis of mean prey
fatty acid signatures using function <code>hclust</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prey.cluster(prey.fa, method = "complete", dist.meas = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prey.cluster_+3A_prey.fa">prey.fa</code></td>
<td>
<p>data frame of prey fatty acid signature
samples. First column must be species used to group samples. Other columns
are assumed to be fatty acid proportions.</p>
</td></tr>
<tr><td><code id="prey.cluster_+3A_method">method</code></td>
<td>
<p>the agglomeration method to be used.  This should be
one of the possible methods in <code>hclust</code> such as <code>"single"</code>,
<code>"complete"</code> or  <code>"average"</code>.  Default is <code>"complete"</code>.</p>
</td></tr>
<tr><td><code id="prey.cluster_+3A_dist.meas">dist.meas</code></td>
<td>
<p>distance measure to use for calculating dissimilarities:
1=KL, 2=AIT or 3=CS.  Default is <code>AIT</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot (dendrogram)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fatty Acids
data(FAset)
fa.set = as.vector(unlist(FAset))

## prey.cluster requires full prey database.
data(preyFAs)
prey.sub=(preyFAs[,4:(ncol(preyFAs))])[fa.set]
prey.sub=prey.sub/apply(prey.sub,1,sum)
group=as.vector(preyFAs$Species)
prey.matrix=cbind(group,prey.sub)

prey.cluster(prey.matrix,method="average",dist.meas=3)
</code></pre>

<hr>
<h2 id='prey.on.prey'>Each prey fatty acid signature is systematically removed from the
supplied prey database and its QFASA diet estimate is obtained by
treating the individual as a predator.</h2><span id='topic+prey.on.prey'></span>

<h3>Description</h3>

<p>Each prey fatty acid signature is systematically removed from the
supplied prey database and its QFASA diet estimate is obtained by
treating the individual as a predator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prey.on.prey(preybase, dist.meas, gamma = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prey.on.prey_+3A_preybase">preybase</code></td>
<td>
<p>first column is name of species and remaining columns are fatty acids.</p>
</td></tr>
<tr><td><code id="prey.on.prey_+3A_dist.meas">dist.meas</code></td>
<td>
<p>see help file for <code><a href="#topic+p.QFASA">p.QFASA</a></code>.</p>
</td></tr>
<tr><td><code id="prey.on.prey_+3A_gamma">gamma</code></td>
<td>
<p>see help file for <code><a href="#topic+p.QFASA">p.QFASA</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>diet estimate
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(preyFAs)
my.preybase &lt;- preyFAs[, -c(1,3)]

# Note: uncomment examples to run. CRAN tests fail because execution time &gt; 5 seconds
# diets.out &lt;- prey.on.prey(my.preybase, 2)
# round(MEANmeth(diets.out), 3)
     
</code></pre>

<hr>
<h2 id='preyFAs'>Prey fatty acid signatures. Each prey signature is a row with fatty
acid proportions in columns.</h2><span id='topic+preyFAs'></span>

<h3>Description</h3>

<p>The prey file should contain all of the individual fatty acid signatures of
the prey and their lipid contents (where appropriate) - a matrix of
the mean values for the FAs (prey.matrix) by the designated prey
modelling group is then calculated using the MEANmeth function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preyFAs
</code></pre>


<h3>Format</h3>

<p>A data frame with 302 observations and 70 variables:
</p>

<dl>
<dt>Lab.Code</dt><dd><p>TODO</p>
</dd>
<dt>Species</dt><dd><p>TODO</p>
</dd>
<dt>lipid</dt><dd><p>TODO</p>
</dd>
<dt>c12.0</dt><dd></dd>
<dt>c13.0</dt><dd></dd>
<dt>Iso14</dt><dd></dd>
<dt>c14.0</dt><dd></dd>
<dt>c14.1w9</dt><dd></dd>
<dt>c14.1w7</dt><dd></dd>
<dt>c14.1w5</dt><dd></dd>
<dt>Iso15</dt><dd></dd>
<dt>Anti15</dt><dd></dd>
<dt>c15.0</dt><dd></dd>
<dt>c15.1w8</dt><dd></dd>
<dt>c15.1w6</dt><dd></dd>
<dt>Iso16</dt><dd></dd>
<dt>c16.0</dt><dd></dd>
<dt>c16.1w11</dt><dd></dd>
<dt>c16.1w9</dt><dd></dd>
<dt>c16.1w7</dt><dd></dd>
<dt>c7Me16.0</dt><dd></dd>
<dt>c16.1w5</dt><dd></dd>
<dt>c16.2w6</dt><dd></dd>
<dt>Iso17</dt><dd></dd>
<dt>c16.2w4</dt><dd></dd>
<dt>c16.3w6</dt><dd></dd>
<dt>c17.0</dt><dd></dd>
<dt>c16.3w4</dt><dd></dd>
<dt>c17.1</dt><dd></dd>
<dt>c16.3w1</dt><dd></dd>
<dt>c16.4w3</dt><dd></dd>
<dt>c16.4w1</dt><dd></dd>
<dt>c18.0</dt><dd></dd>
<dt>c18.1w13</dt><dd></dd>
<dt>c18.1w11</dt><dd></dd>
<dt>c18.1w9</dt><dd></dd>
<dt>c18.1w7</dt><dd></dd>
<dt>c18.1w5</dt><dd></dd>
<dt>c18.2d5.11</dt><dd></dd>
<dt>c18.2w7</dt><dd></dd>
<dt>c18.2w6</dt><dd></dd>
<dt>c18.2w4</dt><dd></dd>
<dt>c18.3w6</dt><dd></dd>
<dt>c18.3w4</dt><dd></dd>
<dt>c18.3w3</dt><dd></dd>
<dt>c18.3w1</dt><dd></dd>
<dt>c18.4w3</dt><dd></dd>
<dt>c18.4w1</dt><dd></dd>
<dt>c20.0</dt><dd></dd>
<dt>c20.1w11</dt><dd></dd>
<dt>c20.1w9</dt><dd></dd>
<dt>c20.1w7</dt><dd></dd>
<dt>c20.2w9</dt><dd></dd>
<dt>c20.2w6</dt><dd></dd>
<dt>c20.3w6</dt><dd></dd>
<dt>c20.4w6</dt><dd></dd>
<dt>c20.3w3</dt><dd></dd>
<dt>c20.4w3</dt><dd></dd>
<dt>c20.5w3</dt><dd></dd>
<dt>c22.1w11</dt><dd></dd>
<dt>c22.1w9</dt><dd></dd>
<dt>c22.1w7</dt><dd></dd>
<dt>c22.2w6</dt><dd></dd>
<dt>c21.5w3</dt><dd></dd>
<dt>c22.4w6</dt><dd></dd>
<dt>c22.5w6</dt><dd></dd>
<dt>c22.4w3</dt><dd></dd>
<dt>c22.5w3</dt><dd></dd>
<dt>c22.6w3</dt><dd></dd>
<dt>c24.1w9</dt><dd></dd>
</dl>



<h3>Details</h3>

<p>Like the predator .csv file you can have as many tombstone data
columns as required but there must be at least one column that
identifies the modelling group, in this case, Species.
</p>
<p>Unlike the predator data, the prey data is not subsetted and
renomalized during the modelling so the prey file needs to be
subsetted for the desired fatty acid set and renormalized to
sum to 1 prior to calculating the mean values.
</p>
<p>The full FA set is extracted from the data frame
(columns 4 onward), subsetted for the FA set in use and then
renormalized over 1. The modelling group names (the &quot;Species&quot; column
in this case) is then added back to the subsetted and renormalized
data (as the first column) and the average values calculated using
the MEANmeth function. Note that for the MEANmeth function to work
the modelling group name must be in the first column.
</p>

<hr>
<h2 id='pseudo.pred'>Generate a pseudo predator by sampling with replacement from prey database.</h2><span id='topic+pseudo.pred'></span>

<h3>Description</h3>

<p>Generates a single pseudo predator by sampling with replacement from prey database. To generate a sample of
pseudo predators, please refer to example code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo.pred(diet, preybase, cal.vec, fat.vec, preysize = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudo.pred_+3A_diet">diet</code></td>
<td>
<p>the &quot;true&quot; or &quot;desired&quot; diet of the pseudo predator with prey
species in alphabetical order (i.e.in the order of table(preyFAs[,2])).
A compositional vector of proportions that sums to one with length equal to
the number of prey species.</p>
</td></tr>
<tr><td><code id="pseudo.pred_+3A_preybase">preybase</code></td>
<td>
<p>prey database from which to generate the pseudo predator.  First column must provide the species name.</p>
</td></tr>
<tr><td><code id="pseudo.pred_+3A_cal.vec">cal.vec</code></td>
<td>
<p>vector of calibration coefficients whose length is the same as the number of fatty acids in prey database.</p>
</td></tr>
<tr><td><code id="pseudo.pred_+3A_fat.vec">fat.vec</code></td>
<td>
<p>vector of fat content whose length is the same as the number of species.</p>
</td></tr>
<tr><td><code id="pseudo.pred_+3A_preysize">preysize</code></td>
<td>
<p>number of prey to sample from prey database.  If preysize=1, then one prey is selected from each species.
Otherwise, a sample of n_k signatures (where n_k is sample size for species k) is obtained by sampling with replacement.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default is to re-sample all of the prey signatures within each species
(that is, preysize=2).  Alternatively, one prey may be randomly selected from each species yielding potentially more variable
pseudo-predators.
For details on simulating realistic predators signatures, see
Bromaghin, J. (2015)
Simulating realistic predator signatures in quantitative fatty acid signature analysis,
Ecological Informatics, 30, 68-71.
</p>


<h3>Value</h3>

<p>A simulated predator FA signature.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(preyFAs)

# Generating a sample of 10 pseudo predators each with "true" diet being
# (1/11,1/11,...1/11), no calibration effect and no fat content.  The QFASA diet estimate
# is then computed for each pseudo predator.

# Note: To incorporate calibration and fat content in a simulation study,
# one set of calibration and fat content is generally used to simulate the pseudo predator
# and another is used to estimate the diet.

set.seed(11)
p.mat &lt;- matrix(rep(NA,10*11),nrow=10)
for (i in 1: 10) {
    my.seal &lt;- pseudo.pred(rep(1/11,11),
                            preyFAs[,-c(1,3)],
                            rep(1,ncol(preyFAs[,-c(1,3)])-1),
                            rep(1,11))
     p.mat[i,] &lt;- p.QFASA(my.seal,
                          MEANmeth(preyFAs[,-c(1,3)]),
                          rep(1,length(my.seal)),
                          2,
                          ext.fa=colnames(preyFAs[,-c(1:3)]))$`Diet Estimates`
 }

# Can verify that average diet estimate of the 10 pseudo predators is close to
# "true" diet.

 colnames(p.mat) &lt;- as.vector(rownames(MEANmeth(preyFAs[,-c(1,3)])))
 round(apply(p.mat,2,mean),3)

</code></pre>

<hr>
<h2 id='pseudo.pred.norm'>Generate a pseudo predator parametrically from multivariate normal
distributions.</h2><span id='topic+pseudo.pred.norm'></span>

<h3>Description</h3>

<p>Generate a pseudo predator parametrically from multivariate normal
distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo.pred.norm(mu.mat, sigma.pool, diet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudo.pred.norm_+3A_mu.mat">mu.mat</code></td>
<td>
<p>matrix where each row represents the mean transformed FA
signature of each prey type</p>
</td></tr>
<tr><td><code id="pseudo.pred.norm_+3A_sigma.pool">sigma.pool</code></td>
<td>
<p>pooled variance-covariance matrix of the transformed
fatty acid signatures of prey types</p>
</td></tr>
<tr><td><code id="pseudo.pred.norm_+3A_diet">diet</code></td>
<td>
<p>the &quot;true&quot; or &quot;desired&quot; diet of the pseudo predator with prey
species in the same order as the rows of mu.mat. A compositional vector of
proportions that sums to one with length equal to
the number of prey species.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similar to <em>pseudo.pred</em> but instead generates the
pseudo-predators parametrically by assuming ilr transformed FA signatures
have a multivariate normal distribution.
</p>


<h3>Value</h3>

<p>A simulated predator FA signature.  See <em>pseudo.pred</em> for an
example illustrating how to generate a sample of pseudo predators.
</p>

<hr>
<h2 id='pseudo.pred.rep'>FUNCTION TO GENERATE ns PSEUDO SEALS WHERE ns IS THE NUMBER OF ROWS IN
<code>diet.mat.seal</code> AND RETURNS THE CORRESPONDING QFASA DIET ESTIMATES.
ASSUMES EACH ROW IS A DIET VECTOR AND EACH COLUMN CORRESPONDS TO 1 PREY
SPECIES IN THE DIET</h2><span id='topic+pseudo.pred.rep'></span>

<h3>Description</h3>

<p>FUNCTION TO GENERATE ns PSEUDO SEALS WHERE ns IS THE NUMBER OF ROWS IN
<code>diet.mat.seal</code> AND RETURNS THE CORRESPONDING QFASA DIET ESTIMATES.
ASSUMES EACH ROW IS A DIET VECTOR AND EACH COLUMN CORRESPONDS TO 1 PREY
SPECIES IN THE DIET
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo.pred.rep(
  diet.mat.seal,
  prey.database,
  fatcont.mat,
  dist.meas,
  ext.fa,
  gamma = 1
)
</code></pre>

<hr>
<h2 id='pseudo.pred.table'>FUNCTION TO GENERATE ns SEALS FOR EACH OF ny YEARS</h2><span id='topic+pseudo.pred.table'></span>

<h3>Description</h3>

<p>FUNCTION TO GENERATE ns SEALS FOR EACH OF ny YEARS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo.pred.table(
  diet.rep.mat,
  prey.database,
  fatcont.mat,
  dist.meas,
  ext.fa,
  gamma = 1
)
</code></pre>

<hr>
<h2 id='pseudo.seal'>Generate a single pseudo predator FA signature</h2><span id='topic+pseudo.seal'></span>

<h3>Description</h3>

<p>THIS IS THE NEW pseudo.seal FUNCTION THAT ALLOWS 1) FAT CONTENT
TO BE INCLUDED IN THE GENERATED SEALS AND 2) SOME SPECIES TO BE
TRULY ZERO (THAT IS,&quot;ZERO SPECIES&quot; DO NOT HAVE TO BE INCLUDED IN THE
&quot;NOISE&quot; )
NOTE:  IT IS ASSUMED THAT SUM(DIET) IS 1-NOISE
</p>
<p>THIS IS THE NEW pseudo.seal FUNCTION THAT ALLOWS 1) FAT CONTENT
TO BE INCLUDED IN THE GENERATED SEALS AND 2) SOME SPECIES TO BE
TRULY ZERO (THAT IS,&quot;ZERO SPECIES&quot; DO NOT HAVE TO BE INCLUDED IN THE
&quot;NOISE&quot; )
NOTE:  IT IS ASSUMED THAT SUM(DIET) IS 1-NOISE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo.seal(prey.sim, diet, noise, nprey, cal, fat.cont, specify.noise)

pseudo.seal(prey.sim, diet, noise, nprey, cal, fat.cont, specify.noise)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudo.seal_+3A_prey.sim">prey.sim</code></td>
<td>
<p>OUTPUT OF split.prey</p>
</td></tr>
<tr><td><code id="pseudo.seal_+3A_diet">diet</code></td>
<td>
<p>DIET COMPOSITION VECTOR  (NOTE: THIS VECTOR SHOULD SUM TO 1-NOISE.  THE NOISE WILL BE ADDED TO THE diet VECTOR.)</p>
</td></tr>
<tr><td><code id="pseudo.seal_+3A_noise">noise</code></td>
<td>
<p>AMOUNT OF NOISE</p>
</td></tr>
<tr><td><code id="pseudo.seal_+3A_nprey">nprey</code></td>
<td>
<p>nprey TOTAL NUMBER OF PREY TO BE SAMPLED</p>
</td></tr>
<tr><td><code id="pseudo.seal_+3A_cal">cal</code></td>
<td>
<p>CALIBRATION FACTORS</p>
</td></tr>
<tr><td><code id="pseudo.seal_+3A_fat.cont">fat.cont</code></td>
<td>
<p>VECTOR OF FAT CONTENT OF LENGTH=I (# OF SPECIES)</p>
</td></tr>
<tr><td><code id="pseudo.seal_+3A_specify.noise">specify.noise</code></td>
<td>
<p>A BOOLEAN VECTOR WITH TRUES DENOTING SPECIES TO USE IN NOISE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>seal.star SIMULATED SEAL FA SIGNATURE.
</p>
<p>seal.star SIMULATED SEAL FA SIGNATURE.
</p>

<hr>
<h2 id='QFASA.const.eqn'>Returns <code>sum(alpha)</code> and used in <code>solnp()</code>.</h2><span id='topic+QFASA.const.eqn'></span>

<h3>Description</h3>

<p>Returns <code>sum(alpha)</code> and used in <code>solnp()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QFASA.const.eqn(alpha, predator, prey.quantiles, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QFASA.const.eqn_+3A_alpha">alpha</code></td>
<td>
<p>vector over which minimization takes place.</p>
</td></tr>
<tr><td><code id="QFASA.const.eqn_+3A_predator">predator</code></td>
<td>
<p>fatty acid signature of predator.</p>
</td></tr>
<tr><td><code id="QFASA.const.eqn_+3A_prey.quantiles">prey.quantiles</code></td>
<td>
<p>matrix of fatty acid signatures of
prey. Each row contains an individual prey signature from a different
species.</p>
</td></tr>
<tr><td><code id="QFASA.const.eqn_+3A_gamma">gamma</code></td>
<td>
<p>power transform exponent (see chisq.dist).</p>
</td></tr>
</table>

<hr>
<h2 id='rho.boot.fun'>RETURNS RHO AND THE BOOTSTRAP SAMPLE DETERMINED BY ind.</h2><span id='topic+rho.boot.fun'></span>

<h3>Description</h3>

<p>RETURNS RHO AND THE BOOTSTRAP SAMPLE DETERMINED BY ind.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rho.boot.fun(ind, data, gamma.rho)
</code></pre>

<hr>
<h2 id='rho.jack.fun'>FUNCTION TO BE PASSED TO bootstrap::jackknife.</h2><span id='topic+rho.jack.fun'></span>

<h3>Description</h3>

<p>FUNCTION TO BE PASSED TO bootstrap::jackknife.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rho.jack.fun(ind, data, gamma.rho)
</code></pre>

<hr>
<h2 id='root.beta'>Find root (i.e. solve f(pio) = PVAL(pio) = alpha1 using either uniroot or optimize.</h2><span id='topic+root.beta'></span>

<h3>Description</h3>

<p>Find root (i.e. solve f(pio) = PVAL(pio) = alpha1 using either uniroot or optimize.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>root.beta(x1, x2, alpha, par.list, R, p.mat, k, low = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="root.beta_+3A_x1">x1</code></td>
<td>
<p>lower starting value</p>
</td></tr>
<tr><td><code id="root.beta_+3A_x2">x2</code></td>
<td>
<p>upper starting value</p>
</td></tr>
<tr><td><code id="root.beta_+3A_alpha">alpha</code></td>
<td>
<p>simultaneous confidence level</p>
</td></tr>
<tr><td><code id="root.beta_+3A_par.list">par.list</code></td>
<td>
<p>parameters needed to compute p-value by bootstrapping</p>
</td></tr>
<tr><td><code id="root.beta_+3A_r">R</code></td>
<td>
<p>number of bootstraps</p>
</td></tr>
<tr><td><code id="root.beta_+3A_p.mat">p.mat</code></td>
<td>
<p>predator diet estimates</p>
</td></tr>
<tr><td><code id="root.beta_+3A_k">k</code></td>
<td>
<p>prey species index 1...I</p>
</td></tr>
<tr><td><code id="root.beta_+3A_low">low</code></td>
<td>
<p>TRUE if computing lower interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>root which will be lower or upper CI limit
</p>

<hr>
<h2 id='split_prey'>Splits prey database into a simulation set (1/3) and a modelling set (2/3).
Returns a list:</h2><span id='topic+split_prey'></span>

<h3>Description</h3>

<p>1. simulation prey database
2. modelling prey database
</p>
<p>1. simulation prey database
2. modelling prey database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_prey(prey.mat)

split_prey(prey.mat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="split_prey_+3A_prey.mat">prey.mat</code></td>
<td>
<p>matrix of individual prey fatty acid signatures
where the first column denotes the prey type</p>
</td></tr>
</table>


<h3>Details</h3>

<p>IF number of samples of a prey type &lt;=5, then prey.mod AND prey.sim
are duplicated instead of split.
</p>
<p>IF number of samples of a prey type &lt;=5, then prey.mod AND prey.sim
are duplicated instead of split.
</p>

<hr>
<h2 id='testfordiff.ind.boot'>Called by <code>testfordiff.ind.pval()</code>.</h2><span id='topic+testfordiff.ind.boot'></span>

<h3>Description</h3>

<p>Called by <code>testfordiff.ind.pval()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testfordiff.ind.boot(data, ns1, R)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="testfordiff.ind.boot_+3A_data">data</code></td>
<td>
<p>sample of compositional data</p>
</td></tr>
<tr><td><code id="testfordiff.ind.boot_+3A_ns1">ns1</code></td>
<td>
<p>sample size of compdata.1</p>
</td></tr>
<tr><td><code id="testfordiff.ind.boot_+3A_r">R</code></td>
<td>
<p>number of bootstrap samples.  default is 500.</p>
</td></tr>
</table>

<hr>
<h2 id='testfordiff.ind.boot.fun'>Called by <code>testfordiff.ind.boot()</code>.</h2><span id='topic+testfordiff.ind.boot.fun'></span>

<h3>Description</h3>

<p>Called by <code>testfordiff.ind.boot()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testfordiff.ind.boot.fun(data, i, ns1, change.zero = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="testfordiff.ind.boot.fun_+3A_data">data</code></td>
<td>
<p>sample of compositional data</p>
</td></tr>
<tr><td><code id="testfordiff.ind.boot.fun_+3A_i">i</code></td>
<td>
<p>row index</p>
</td></tr>
<tr><td><code id="testfordiff.ind.boot.fun_+3A_ns1">ns1</code></td>
<td>
<p>sample size of compdata.1</p>
</td></tr>
<tr><td><code id="testfordiff.ind.boot.fun_+3A_change.zero">change.zero</code></td>
<td>
<p>tolerance</p>
</td></tr>
</table>

<hr>
<h2 id='testfordiff.ind.pval'>Test for a difference between two independent samples of compositional data.
Zeros of any type are allowed.</h2><span id='topic+testfordiff.ind.pval'></span>

<h3>Description</h3>

<p>Test for a difference between two independent samples of compositional data.
Zeros of any type are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testfordiff.ind.pval(compdata.1, compdata.2, R = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="testfordiff.ind.pval_+3A_compdata.1">compdata.1</code></td>
<td>
<p>sample of compositional data.</p>
</td></tr>
<tr><td><code id="testfordiff.ind.pval_+3A_compdata.2">compdata.2</code></td>
<td>
<p>sample of compositional data.</p>
</td></tr>
<tr><td><code id="testfordiff.ind.pval_+3A_r">R</code></td>
<td>
<p>number of bootstrap samples, default is 500.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value obtained through a multivariate permutation test with test statistic based
on chi-square distances.
</p>


<h3>References</h3>

<p>Stewart, C., Iverson, S. and Field, C. (2014) Testing for a change in
diet using fatty acid signatures.  Environmental and Ecological Statistics 21, pp. 775-792.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Prey
data(preyFAs)

## Capelin FA sig
capelin.sig=preyFAs[preyFAs$Species=="capelin",4:(ncol(preyFAs))]
capelin.sig=capelin.sig/apply(capelin.sig,1,sum)

## Sandlance FA sig
sandlance.sig=preyFAs[preyFAs$Species=="sandlance",4:(ncol(preyFAs))]
sandlance.sig=sandlance.sig/apply(sandlance.sig,1,sum)

# Note:
# # Uncomment examples to run. CRAN tests fail because execution time &gt; 5 seconds
# testfordiff.ind.pval(as.matrix(capelin.sig),as.matrix(sandlance.sig))


</code></pre>

<hr>
<h2 id='Tstar.beta'>Generate bootstrap replicates of diet proportion estimates for
given prey species</h2><span id='topic+Tstar.beta'></span>

<h3>Description</h3>

<p>Generate bootstrap replicates of diet proportion estimates for
given prey species
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tstar.beta(p.k, theta.boot, mu.null, phi.boot, R.boot)
</code></pre>


<h3>Value</h3>

<p>list of diet proportion replicates
</p>

<hr>
<h2 id='two.factor.rep'>Measure of (unadjusted) repeatability</h2><span id='topic+two.factor.rep'></span>

<h3>Description</h3>

<p>Measure of (unadjusted) repeatability
</p>


<h3>Usage</h3>

<pre><code class='language-R'>two.factor.rep(dataset, gamma = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="two.factor.rep_+3A_dataset">dataset</code></td>
<td>
<p>data frame of diet estimates. Columns 1 and 2 of
<code>dataset</code> must be the first and second factors in your two factor
ANOVA model where column 1 specifies the predator and column 2 the
year, season, etc...</p>
</td></tr>
<tr><td><code id="two.factor.rep_+3A_gamma">gamma</code></td>
<td>
<p>needed to compute CS distance.  Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We use absolute repeatability (or intraclass correlation coefficient).
The difference in the two types is discussed in:
McGraw and Wong (1996) Forming Inferences about some intraclass
correlation coefficients.  Psychological Methods. 1(1):30-46.
</p>


<h3>Value</h3>

<p>unadjusted consistent repeatability, unadjusted absolute repeatability
and the number of levels of second factor (eg. year, seasons, etc..)
</p>

<hr>
<h2 id='unbal.diet.data'>Sample example of unbalanced repeatability diet estimates data with a max of
two repeated measurements per predator.</h2><span id='topic+unbal.diet.data'></span>

<h3>Description</h3>

<p>Sample example of unbalanced repeatability diet estimates data with a max of
two repeated measurements per predator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unbal.diet.data
</code></pre>


<h3>Format</h3>

<p>A data frame with 96 predator diets (50 unique predators) and
13 variables:
</p>

<dl>
<dt>Seal.ID</dt><dd><p>Predator (1 to 50)</p>
</dd>
<dt>Year</dt><dd><p>Either 1 or 2</p>
</dd>
<dt>capelin</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>coho</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>eulachon</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>herring</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>mackerel</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>pilchard</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>pollock</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>sandlance</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>squid</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>surfsmelt_s</dt><dd><p>estimated diet proportion</p>
</dd>
<dt>sufsmelt_lg</dt><dd><p>estimated diet proportion</p>
</dd>
</dl>


<hr>
<h2 id='unbal.rep.CI'>Measure of Repeatability for Diet Estimates (Unbalanced/Missing Value Case)</h2><span id='topic+unbal.rep.CI'></span>

<h3>Description</h3>

<p>Computes a measure of repeatability for a sample of predators with repeated
diet estimate measurements (Unbalanced/Missing Value Case)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unbal.rep.CI(
  data,
  B,
  R,
  CI = TRUE,
  alpha,
  prey.database,
  fatcont.mat,
  dist.meas,
  ext.fa,
  gamma.QFASA = 1,
  gamma.rho = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unbal.rep.CI_+3A_data">data</code></td>
<td>
<p>data frame of diet estimates. First column must denote the predator
and second column the second factor (eg. year or season).  Need not contain
the same number of repeated measurements for each predator.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_b">B</code></td>
<td>
<p>number of pseudo predators samples to generate for bias calculation.
Default is set to 50 because is slow to run.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_r">R</code></td>
<td>
<p>number of bootstrap samples (i.e. <code>R</code> samples for each generated sample
of pseudo predators). Default is set to 100 because it is slow to run.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_ci">CI</code></td>
<td>
<p>indicates if a confidence interval for rho is to be calculated.
Default is FALSE since this is time consuming to obtain.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_alpha">alpha</code></td>
<td>
<p>a (1-alpha/2)X100 percent confidence interval is calculated for rho
if <code>CI=TRUE</code>.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_prey.database">prey.database</code></td>
<td>
<p>prey data base that was used to compute the QFASA diet
estimates in <code>data</code>. Will be used to generate pseudo predators.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_fatcont.mat">fatcont.mat</code></td>
<td>
<p>data frame or matrix of length equal to the number of prey
FA signatures in prey data base.  First column is name of species and
second column is lipid.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_dist.meas">dist.meas</code></td>
<td>
<p>distance measure to use in <code>p.QFASA</code>.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_ext.fa">ext.fa</code></td>
<td>
<p>subset of FAs to use.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_gamma.qfasa">gamma.QFASA</code></td>
<td>
<p>if <code>dist.meas=3</code>, gamma is required.  Default is 1.</p>
</td></tr>
<tr><td><code id="unbal.rep.CI_+3A_gamma.rho">gamma.rho</code></td>
<td>
<p>value of gamma to be used to compute CS distance
in repeatablity functions.  Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bias corrected measure of repeatability, estimate of the bias and
(if <code>CI=TRUE</code>) a confidence interval for the true repeatability.
</p>

<hr>
<h2 id='unbal.rho.boot.fun'>RETURNS RHO AND THE BOOTSTRAP SAMPLE DETERMINED BY ind.</h2><span id='topic+unbal.rho.boot.fun'></span>

<h3>Description</h3>

<p>RETURNS RHO AND THE BOOTSTRAP SAMPLE DETERMINED BY ind.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unbal.rho.boot.fun(ind, data, gamma.rho)
</code></pre>

<hr>
<h2 id='unbal.rho.jack.fun'>FUNCTION TO BE PASSED TO bootstrap::jackknife.</h2><span id='topic+unbal.rho.jack.fun'></span>

<h3>Description</h3>

<p>FUNCTION TO BE PASSED TO bootstrap::jackknife.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unbal.rho.jack.fun(ind, data, gamma.rho)
</code></pre>

<hr>
<h2 id='unbal.two.factor.rep'>Measure of (unadjusted) repeatability with missing values</h2><span id='topic+unbal.two.factor.rep'></span>

<h3>Description</h3>

<p>Measure of (unadjusted) repeatability with missing values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unbal.two.factor.rep(dataset, k.est.meth = 1, gamma = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unbal.two.factor.rep_+3A_dataset">dataset</code></td>
<td>
<p>data frame of diet estimates. Columns 1 and 2 of
<code>dataset</code> must be the first and second factors in your two factor
ANOVA model where column 1 specifies the predator and column 2 the
year, season, etc...  Missing values are allowed.</p>
</td></tr>
<tr><td><code id="unbal.two.factor.rep_+3A_k.est.meth">k.est.meth</code></td>
<td>
<p>default is 1 (harmonic mean).  See details below.</p>
</td></tr>
<tr><td><code id="unbal.two.factor.rep_+3A_gamma">gamma</code></td>
<td>
<p>needed to compute CS distance.  Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We use the modified measure of repeatability that uses an adjusted
degrees of freedom and takes into account the estimate of <code>k</code>.
When <code>k.est.meth=1</code>, the harmonic mean is used (see
p. 212 from Biometry Fourth Edition by Sokal and Rohlf) and when
<code>k.est.meth=2</code>,estimate is n_0 from Lessels and Boag (1987).
</p>


<h3>Value</h3>

<p>unadjusted consistent repeatability, unadjusted absolute repeatability
and a modified measure of repeatability.
</p>

<hr>
<h2 id='uniroot.beta'>Use uniroot() to find roots and compare with bisection outcome</h2><span id='topic+uniroot.beta'></span>

<h3>Description</h3>

<p>Use uniroot() to find roots and compare with bisection outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniroot.beta(x1, x2, alpha, par.list, R, p.mat, k)
</code></pre>

<hr>
<h2 id='zeroEstimates'>Reintroduce excluded species to diet estimates as forced zeroes</h2><span id='topic+zeroEstimates'></span>

<h3>Description</h3>

<p>Reintroduce excluded species to diet estimates as forced zeroes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zeroEstimates(estimates, prey.mat)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
