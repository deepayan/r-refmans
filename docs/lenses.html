<!DOCTYPE html><html><head><title>Help for package lenses</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lenses}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%.%'><p>Compose lenses</p></a></li>
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#attr_l'><p>Construct a lens into an attribute</p></a></li>
<li><a href='#attributes_l'><p>Attributes lens</p></a></li>
<li><a href='#body_l'><p>Body lens</p></a></li>
<li><a href='#c_l'><p>Convenient lens composition</p></a></li>
<li><a href='#class_l'><p>Class lens</p></a></li>
<li><a href='#colnames_l'><p>A lens into the column names of an object</p></a></li>
<li><a href='#cols_l'><p>Column lens</p></a></li>
<li><a href='#cond_il'><p>Conditional lens</p></a></li>
<li><a href='#diag_l'><p>Lens into the diagonal of a matrix</p></a></li>
<li><a href='#dim_l'><p>Dims lens</p></a></li>
<li><a href='#dimnames_l'><p>Dimnames lens</p></a></li>
<li><a href='#drop_while_il'><p>Conditional trim lens</p></a></li>
<li><a href='#env_l'><p>Environment lens</p></a></li>
<li><a href='#filter_il'><p>Filter lens</p></a></li>
<li><a href='#filter_l'><p>Filter lens</p></a></li>
<li><a href='#first_l'><p>A lens into the first element</p></a></li>
<li><a href='#formals_l'><p>Formals lens</p></a></li>
<li><a href='#id_l'><p>The identity (trivial lens)</p></a></li>
<li><a href='#index_l'><p>Construct a lens into an index/name</p></a></li>
<li><a href='#indexes_l'><p>Construct a lens into a subset of an object</p></a></li>
<li><a href='#last_l'><p>A lens into the last element</p></a></li>
<li><a href='#lens'><p>Construct a lens</p></a></li>
<li><a href='#levels_l'><p>Levels lens</p></a></li>
<li><a href='#lower_tri_l'><p>Lens into lower diagonal elements</p></a></li>
<li><a href='#map_l'><p>Promote a lens to apply to each element of a list</p></a></li>
<li><a href='#names_l'><p>A lens into the names of an object</p></a></li>
<li><a href='#oscope'><p>Bind data to a lens</p></a></li>
<li><a href='#over'><p>Map a function over a lens</p></a></li>
<li><a href='#over_map'><p>Map a function over a list lens</p></a></li>
<li><a href='#over_with'><p>Map a function over an in scope lens</p></a></li>
<li><a href='#reshape_l'><p>Lens into a new dimension(s)</p></a></li>
<li><a href='#rev_l'><p>Reverse lens</p></a></li>
<li><a href='#rownames_l'><p>A lens into the row names of an object</p></a></li>
<li><a href='#rows_l'><p>Row lens</p></a></li>
<li><a href='#select_l'><p>Tidyselect elements by name</p></a></li>
<li><a href='#send'><p>Set one lens to the view of another</p></a></li>
<li><a href='#send_over'><p>Set one lens to the view of another (transformed)</p></a></li>
<li><a href='#set'><p>Modify data with a lens</p></a></li>
<li><a href='#slab_l'><p>Slab lens</p></a></li>
<li><a href='#slice_l'><p>Slice lens</p></a></li>
<li><a href='#slot_l'><p>Slot lens</p></a></li>
<li><a href='#t_l'><p>Matrix transpose lens</p></a></li>
<li><a href='#take_l'><p>Construct a lens into a prefix of a vector</p></a></li>
<li><a href='#take_while_il'><p>Conditional head lens</p></a></li>
<li><a href='#to_l'><p>Promote a function to a <code>getter</code> lens</p></a></li>
<li><a href='#transpose_l'><p>Lens into a list of rows</p></a></li>
<li><a href='#unlist_l'><p>Unlist lens</p></a></li>
<li><a href='#upper_tri_l'><p>Lens into upper diagonal elements</p></a></li>
<li><a href='#view'><p>View data with a lens</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.0.3</td>
</tr>
<tr>
<td>Title:</td>
<td>Elegant Data Manipulation with Lenses</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for creating and using lenses to simplify data manipulation. Lenses are composable getter/setter pairs for working with data in a purely functional way. Inspired by the 'Haskell' library 'lens' (Kmett, 2012) <a href="https://hackage.haskell.org/package/lens">https://hackage.haskell.org/package/lens</a>. For a fairly comprehensive (and highly technical) history of lenses please see the 'lens' wiki <a href="https://github.com/ekmett/lens/wiki/History-of-Lenses">https://github.com/ekmett/lens/wiki/History-of-Lenses</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://cfhammill.github.io/lenses">http://cfhammill.github.io/lenses</a>,
<a href="https://github.com/cfhammill/lenses">https://github.com/cfhammill/lenses</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cfhammill/lenses/issues">https://github.com/cfhammill/lenses/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr, tidyselect, rlang</td>
</tr>
<tr>
<td>Collate:</td>
<td>'verbs.R' 'lens.R' 'array-lenses.R' 'base-lenses.R' 'utils.R'
'dataframe-lenses.R' 'utils-pipe.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-03 17:00:51 UTC; chammill</td>
</tr>
<tr>
<td>Author:</td>
<td>Chris Hammill [aut, cre, trl],
  Ben Darwin [aut, trl]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chris Hammill &lt;cfhammill@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-06 14:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25.+25'>Compose lenses</h2><span id='topic++25.+25'></span>

<h3>Description</h3>

<p>Compose two lenses to produce a new lens which represents
focussing first with the first lens, then with the second.
A <code>view</code> using the resulting composite lens will first <code>view</code> using
the first, then the second, while an <code>set</code> will <code>view</code> via the first lens,
<code>set</code> into the resulting piece with the second, and then replace the
updated structure in the first with <code>set</code>.  Lens composition
is analogous to the <code>.</code> syntax of object-oriented programming or to
a flipped version of function composition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l %.% m
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25.+2B25_+3A_l">l</code></td>
<td>
<p>the first <a href="#topic+lens">lens</a> (or an <a href="#topic+oscope">oscope</a>)</p>
</td></tr>
<tr><td><code id="+2B25.+2B25_+3A_m">m</code></td>
<td>
<p>the second lens</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  lst &lt;- list(b = c(3,4,5))
  lns &lt;- index_l("b") %.% index_l(2)
  lst %&gt;% view(lns)                 # returns 4
  lst %&gt;% set(lns, 1)              # returns list(b = c(3,2,5))
  lst                               # returns list(b = c(3,4,5))
</code></pre>

<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic++25+3E+25">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='attr_l'>Construct a lens into an attribute</h2><span id='topic+attr_l'></span>

<h3>Description</h3>

<p>The lens version of <code>attr</code> and <code>attr&lt;-</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attr_l(attrib)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attr_l_+3A_attrib">attrib</code></td>
<td>
<p>A length one character vector indicating
the attribute to lens into.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- structure(1:10, important = "attribute"))
view(x, attr_l("important"))
set(x, attr_l("important"), "feature")
</code></pre>

<hr>
<h2 id='attributes_l'>Attributes lens</h2><span id='topic+attributes_l'></span>

<h3>Description</h3>

<p>The lens equivalent of <a href="base.html#topic+attributes">attributes</a> and <a href="base.html#topic+attributes+3C-">attributes&lt;-</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attributes_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- structure(1:10, important = "attribute"))
view(x, attributes_l)
set(x, attributes_l, list(important = "feature"))
</code></pre>

<hr>
<h2 id='body_l'>Body lens</h2><span id='topic+body_l'></span>

<h3>Description</h3>

<p>A lens into the body of a function. The
lens equivalent of <a href="base.html#topic+body">body</a> and <a href="base.html#topic+body+3C-">body&lt;-</a>.
You probably shouldn't use this.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>inc2 &lt;- function(x) x + 2
view(inc2, body_l)
inc4 &lt;- set(inc2, body_l, quote(x + 4))
inc4(10)
</code></pre>

<hr>
<h2 id='c_l'>Convenient lens composition</h2><span id='topic+c_l'></span>

<h3>Description</h3>

<p>A lens version of <a href="purrr.html#topic+pluck">purrr::pluck</a>. Takes
a series element indicators and creates a composite
lens.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>c_l(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="c_l_+3A_...">...</code></td>
<td>
<p>index vectors or lenses</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> length one vectors are converted to <a href="#topic+index_l">index_l</a>,
</p>
</li>
<li><p> length one logical vectors and numeric vectors that are negative are
converted to <a href="#topic+indexes_l">indexes_l</a>,
</p>
</li>
<li><p> larger vectors are converted to <a href="#topic+indexes_l">indexes_l</a>,
</p>
</li>
<li><p> lenses are composed as is.
</p>
</li></ul>

<p>See examples for more
</p>


<h3>Examples</h3>

<pre><code class='language-R'>view(iris, c_l("Petal.Length", 10:20, 3))
sepal_l &lt;- index("Sepal.Length")
view(iris, c_l(sepal_l, id_l, 3))
</code></pre>

<hr>
<h2 id='class_l'>Class lens</h2><span id='topic+class_l'></span>

<h3>Description</h3>

<p>A lens into the class of an object. Lens
equivalent of <a href="base.html#topic+class">class</a> and <a href="base.html#topic+class+3C-">class&lt;-</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>class_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
view(x, class_l)
set(x, class_l, "super_integer")
</code></pre>

<hr>
<h2 id='colnames_l'>A lens into the column names of an object</h2><span id='topic+colnames_l'></span>

<h3>Description</h3>

<p>The lens version of <code>colnames</code> and <code>colnames&lt;-</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colnames_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:4, ncol = 2)
colnames(x) &lt;- c("first", "second")
x

view(x, colnames_l)
set(x, colnames_l, c("premiere", "deuxieme"))
</code></pre>

<hr>
<h2 id='cols_l'>Column lens</h2><span id='topic+cols_l'></span>

<h3>Description</h3>

<p>Create a lens into a set of columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cols_l(cols, drop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cols_l_+3A_cols">cols</code></td>
<td>
<p>the columns to focus on</p>
</td></tr>
<tr><td><code id="cols_l_+3A_drop">drop</code></td>
<td>
<p>whether or not to drop dimensions with length 1</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:4, ncol = 2)
colnames(x) &lt;- c("first", "second")
x

view(x, cols_l(1))
view(x, cols_l("second"))
set(x, cols_l(1), c(20,40))
</code></pre>

<hr>
<h2 id='cond_il'>Conditional lens</h2><span id='topic+cond_il'></span>

<h3>Description</h3>

<p><a href="#topic+view">view</a> is equivalent to <code>Filter(f,d)</code>,
<a href="#topic+set">set</a> replaces elements that satisfy <code>f</code> with elements
of x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cond_il(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cond_il_+3A_f">f</code></td>
<td>
<p>the predicate (logical) function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This lens is illegal because <code>set-view</code> is not satisfied,
multiple runs of the same lens will reference potentially
different elements.
</p>

<hr>
<h2 id='diag_l'>Lens into the diagonal of a matrix</h2><span id='topic+diag_l'></span>

<h3>Description</h3>

<p>A lens into a matrix's diagonal elements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diag_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>

<hr>
<h2 id='dim_l'>Dims lens</h2><span id='topic+dim_l'></span>

<h3>Description</h3>

<p>A lens into an objects dimensions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dim_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10

(y &lt;- set(x, dim_l, c(2,5)))
view(y, dim_l)
</code></pre>

<hr>
<h2 id='dimnames_l'>Dimnames lens</h2><span id='topic+dimnames_l'></span>

<h3>Description</h3>

<p>A lens into the dimnames of an object. Lens
equivalent of <a href="base.html#topic+dimnames">dimnames</a> and <a href="base.html#topic+dimnames+3C-">dimnames&lt;-</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dimnames_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:4, ncol = 2)
colnames(x) &lt;- c("first", "second")
x

view(x, dimnames_l)
set(x, dimnames_l, list(NULL, c("premiere", "deuxieme")))
</code></pre>

<hr>
<h2 id='drop_while_il'>Conditional trim lens</h2><span id='topic+drop_while_il'></span>

<h3>Description</h3>

<p>A lens into all elements starting from the first
element that doesn't satisfy a predicate. Essentially
the complement of <a href="#topic+take_while_il">take_while_il</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drop_while_il(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drop_while_il_+3A_f">f</code></td>
<td>
<p>the predicate (logical) function</p>
</td></tr>
</table>

<hr>
<h2 id='env_l'>Environment lens</h2><span id='topic+env_l'></span>

<h3>Description</h3>

<p>A lens into the environment of an object. This
is the lens version of <a href="base.html#topic+environment">environment</a> and <a href="base.html#topic+environment+3C-">environment&lt;-</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>env_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 10
f &lt;- (function(){x &lt;- 2; function() x + 1})()
f

f()
view(f, env_l)$x

g &lt;- over(f, env_l, parent.env)
g()
</code></pre>

<hr>
<h2 id='filter_il'>Filter lens</h2><span id='topic+filter_il'></span>

<h3>Description</h3>

<p>Create an illegal lens into the result of a filter. Arguments
are interpreted with non-standard evaluation as in
<a href="dplyr.html#topic+filter">dplyr::filter</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_il(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_il_+3A_...">...</code></td>
<td>
<p>unquoted NSE filter arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>head(view(iris, filter_il(Species == "setosa"))) 
head(over(iris,
          filter_il(Species == "setosa") %.% select_l(-Species),
          function(x) x + 10))
</code></pre>

<hr>
<h2 id='filter_l'>Filter lens</h2><span id='topic+filter_l'></span>

<h3>Description</h3>

<p>Create a lawful lens into the result of a filter. This
focuses only columns not involved in the filter condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_l(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_l_+3A_...">...</code></td>
<td>
<p>unquoted NSE filter arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>head(view(iris, filter_l(Species == "setosa"))) # Note Species is not seen
head(over(iris, filter_l(Species == "setosa"), function(x) x + 10))
</code></pre>

<hr>
<h2 id='first_l'>A lens into the first element</h2><span id='topic+first_l'></span>

<h3>Description</h3>

<p>Lens version of <code>x[[1]]</code> and <code>x[[1]] &lt;- val</code>
x &lt;- 1:10
view(x, first_l)
set(x, first_l, 50)
</p>
<p>[[1]: R:[1
[[1]: R:[1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>first_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>

<hr>
<h2 id='formals_l'>Formals lens</h2><span id='topic+formals_l'></span>

<h3>Description</h3>

<p>A lens equivalent of <a href="base.html#topic+formals">formals</a> and <a href="base.html#topic+formals+3C-">formals&lt;-</a>,
allowing you to change the formal arguments of
a function. As with <a href="#topic+body_l">body_l</a> you probably shouldn't
use this.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formals_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- function(x) x + y + 7
view(f, formals_l)

g &lt;- set(f, formals_l, list(x = 1, y = 2))
g()
</code></pre>

<hr>
<h2 id='id_l'>The identity (trivial lens)</h2><span id='topic+id_l'></span>

<h3>Description</h3>

<p>This lens focuses on the whole object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>id_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
view(x, id_l)
head(set(x, id_l, iris))
</code></pre>

<hr>
<h2 id='index_l'>Construct a lens into an index/name</h2><span id='topic+index_l'></span><span id='topic+index'></span>

<h3>Description</h3>

<p>This is the lens version of <code>[[</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>index_l(el)

index(el)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="index_l_+3A_el">el</code></td>
<td>
<p>The element the lens should point to
can be an <code>integer</code> or name.</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>index</code>: shorthand
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
view(x, index_l(1))
set(x, index(5), 50)
head(view(iris, index(2)))
</code></pre>

<hr>
<h2 id='indexes_l'>Construct a lens into a subset of an object</h2><span id='topic+indexes_l'></span><span id='topic+indexes'></span>

<h3>Description</h3>

<p>This is the lens version of <code>[</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indexes_l(els)

indexes(els)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indexes_l_+3A_els">els</code></td>
<td>
<p>a subset vector, can be <code>integer</code>, <code>character</code>
of <code>logical</code>, pointing to one or more elements of the object</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>indexes</code>: shorthand
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
view(x, indexes_l(3:5))
set(x, indexes_l(c(1,10)), NA)
head(view(iris, indexes_l(c("Sepal.Length", "Species"))))
</code></pre>

<hr>
<h2 id='last_l'>A lens into the last element</h2><span id='topic+last_l'></span>

<h3>Description</h3>

<p>Lens version of <code>x[[length(x)]]</code> and <code>x[[length(x)]] &lt;- val</code>
</p>
<p>[[length(x)]: R:[length(x)
[[length(x)]: R:[length(x)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>last_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
view(x, last_l)
set(x, last_l, 50)
</code></pre>

<hr>
<h2 id='lens'>Construct a lens</h2><span id='topic+lens'></span>

<h3>Description</h3>

<p>A <code>lens</code> represents the process of focusing on a specific part of a data structure.
We represent this via a <code>view</code> function and
an <code>set</code> function, roughly corresponding to object-oriented
&quot;getters&quot; and &quot;setters&quot; respectively.
Lenses can be composed to access or modify deeply nested
structures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lens(view, set, getter = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lens_+3A_view">view</code></td>
<td>
<p>A function that takes a data structure of a certain type
and returns a subpart of that structure</p>
</td></tr>
<tr><td><code id="lens_+3A_set">set</code></td>
<td>
<p>A function that takes a data structure of a certain type
and a value and returns a new data structure with the given subpart
replaced with the given value.  Note that <code>set</code> should not modify
the original data.</p>
</td></tr>
<tr><td><code id="lens_+3A_getter">getter</code></td>
<td>
<p>Default is <code>FALSE</code>, if <code>TRUE</code> the created lens cannot
be <code>set</code> into.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Lenses are popular in functional programming because
they allow you to build pure, compositional, and re-usable &quot;getters&quot; and &quot;setters&quot;.
</p>
<p>As noted in the README, using <code>lens</code> directly incurs the following obligations
(the &quot;Lens laws&quot;):
</p>

<ol>
<li><p> Get-Put: If you get (view) some data with a lens, and then
modify (set) the data with that value, you get the input data back.
</p>
</li>
<li><p> Put-Get: If you put (set) a value into some data with a lens,
then get that value with the lens, you get back what you put in.
</p>
</li>
<li><p> Put-Put: If you put a value into some data with a lens, and
then put another value with the same lens, it's the same as only
doing the second put.
</p>
</li></ol>

<p>&quot;Lenses&quot; which do not satisfy these properties should be documented accordingly.
By convention, such objects present in this library are suffixed by &quot;_il&quot; (&quot;illegal lens&quot;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>third_l &lt;- lens(view = function(d) d[[3]],
                set = function(d, x){ d[[3]] &lt;- x; d })
view(1:10, third_l) # returns 3
set(1:10, third_l, 10) # returns c(1:2, 10, 4:10)
</code></pre>

<hr>
<h2 id='levels_l'>Levels lens</h2><span id='topic+levels_l'></span>

<h3>Description</h3>

<p>A lens into the levels of an object. Usually
this is factor levels. Lens
equivalent of <a href="base.html#topic+levels">levels</a> and <a href="base.html#topic+levels+3C-">levels&lt;-</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>levels_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- factor(c("a", "b"))
view(x, levels_l)
set(x, levels_l, c("A", "B"))
</code></pre>

<hr>
<h2 id='lower_tri_l'>Lens into lower diagonal elements</h2><span id='topic+lower_tri_l'></span>

<h3>Description</h3>

<p>Create a lens into the lower diagonal elements
of a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lower_tri_l(diag = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lower_tri_l_+3A_diag">diag</code></td>
<td>
<p>whether or not to include the diagonal</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- matrix(1:9, ncol = 3))
view(x, lower_tri_l())
view(x, lower_tri_l(diag = TRUE))
set(x, lower_tri_l(), c(100, 200, 300))
</code></pre>

<hr>
<h2 id='map_l'>Promote a lens to apply to each element of a list</h2><span id='topic+map_l'></span>

<h3>Description</h3>

<p>Create a new lens that views and sets each element
of the list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_l(l)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_l_+3A_l">l</code></td>
<td>
<p>the lens to promote</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <a href="base.html#topic+lapply">lapply</a> under the hood for <a href="#topic+view">view</a>
and <a href="base.html#topic+mapply">mapply</a> under the hood for <a href="#topic+set">set</a>. This means
that <a href="#topic+set">set</a> can be given a list of values to set,
one for each element. If the input or update are
lists this lens always returns a list. If the input
and update are vectors this lens will return a vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(ex &lt;- replicate(10, sample(1:5), simplify = FALSE))
view(ex, map_l(index(1)))
set(ex, map_l(index(1)), 11:20)
</code></pre>

<hr>
<h2 id='names_l'>A lens into the names of an object</h2><span id='topic+names_l'></span>

<h3>Description</h3>

<p>The lens versions of <code>names</code> and <code>names&lt;-</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>names_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>view(iris, names_l)
head(set(iris, names_l, LETTERS[1:5]))
</code></pre>

<hr>
<h2 id='oscope'>Bind data to a lens</h2><span id='topic+oscope'></span>

<h3>Description</h3>

<p>To flatten lens composition, you can prespecify the data
the lens with be applied to by constructing an objectoscope.
These can be integrated easily with normal data pipelines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oscope(d, l = id_l)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oscope_+3A_d">d</code></td>
<td>
<p>The data for interest</p>
</td></tr>
<tr><td><code id="oscope_+3A_l">l</code></td>
<td>
<p>The lens to bind the data to. Defaults to the identity lens</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>list(a = 5, b = 1:3, c = 8) %&gt;%
  oscope()   %.%
  index_l("b") %.%
  index_l(1)   %&gt;%
  set(10)
</code></pre>

<hr>
<h2 id='over'>Map a function over a lens</h2><span id='topic+over'></span>

<h3>Description</h3>

<p>Get the data pointed to by a lens, apply a function
and replace it with the result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>over(d, l, f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="over_+3A_d">d</code></td>
<td>
<p>the data (or an <a href="#topic+oscope">oscope</a>)</p>
</td></tr>
<tr><td><code id="over_+3A_l">l</code></td>
<td>
<p>the lens (or the function if <code>d</code> is an <code>oscope</code>)</p>
</td></tr>
<tr><td><code id="over_+3A_f">f</code></td>
<td>
<p>the function (or nothing if <code>d</code> is an <code>oscope</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>third_l &lt;- index(3)
over(1:5, third_l, function(x) x + 2)
# returns c(1:2, 5, 4:5)  
</code></pre>

<hr>
<h2 id='over_map'>Map a function over a list lens</h2><span id='topic+over_map'></span>

<h3>Description</h3>

<p>Apply the specified function to each element
of the subobject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>over_map(d, l, f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="over_map_+3A_d">d</code></td>
<td>
<p>the data</p>
</td></tr>
<tr><td><code id="over_map_+3A_l">l</code></td>
<td>
<p>the lens</p>
</td></tr>
<tr><td><code id="over_map_+3A_f">f</code></td>
<td>
<p>the function to use, potentially a <code>~</code> specified anonymous function.</p>
</td></tr>
</table>

<hr>
<h2 id='over_with'>Map a function over an in scope lens</h2><span id='topic+over_with'></span>

<h3>Description</h3>

<p>Apply the specified function with named elements of
the viewed data in scope. Similar to <a href="dplyr.html#topic+mutate">dplyr::mutate</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>over_with(d, l, f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="over_with_+3A_d">d</code></td>
<td>
<p>the data</p>
</td></tr>
<tr><td><code id="over_with_+3A_l">l</code></td>
<td>
<p>the lens</p>
</td></tr>
<tr><td><code id="over_with_+3A_f">f</code></td>
<td>
<p>the function to use, potentially a <code>~</code> specified anonymous function.
The function body is quoted, and evaluated with <code>rlang::eval_tidy(..., data = view(d,l))</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>iris %&gt;% over_with(id_l, ~ Sepal.Length)
</code></pre>

<hr>
<h2 id='reshape_l'>Lens into a new dimension(s)</h2><span id='topic+reshape_l'></span>

<h3>Description</h3>

<p>Construct a lens that is a view of the data with
a new set of dimensions. Both <a href="#topic+view">view</a> and <a href="#topic+set">set</a> check
that the new dimensions match the number of elements of
the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reshape_l(dims)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reshape_l_+3A_dims">dims</code></td>
<td>
<p>a vector with the new dimensions</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:9
view(x, reshape_l(c(3,3)))
set(x, reshape_l(c(3,3)) %.% diag_l, 100)
</code></pre>

<hr>
<h2 id='rev_l'>Reverse lens</h2><span id='topic+rev_l'></span>

<h3>Description</h3>

<p>Lens into the <a href="base.html#topic+rev">rev</a>erse of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rev_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
view(x, rev_l)
set(x, rev_l, 11:20)
</code></pre>

<hr>
<h2 id='rownames_l'>A lens into the row names of an object</h2><span id='topic+rownames_l'></span>

<h3>Description</h3>

<p>The lens version of <code>rownames</code> and <code>rownames&lt;-</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rownames_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:4, ncol = 2)
rownames(x) &lt;- c("first", "second")
x

view(x, rownames_l)
set(x, rownames_l, c("premiere", "deuxieme"))
</code></pre>

<hr>
<h2 id='rows_l'>Row lens</h2><span id='topic+rows_l'></span>

<h3>Description</h3>

<p>Create a lens into a set of rows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rows_l(rows, drop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rows_l_+3A_rows">rows</code></td>
<td>
<p>the rows to focus on</p>
</td></tr>
<tr><td><code id="rows_l_+3A_drop">drop</code></td>
<td>
<p>whether or not to drop dimensions with length 1</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:4, ncol = 2)
rownames(x) &lt;- c("first", "second")
x

view(x, rows_l(1))
view(x, rows_l("second"))
set(x, rows_l(1), c(20,40))
</code></pre>

<hr>
<h2 id='select_l'>Tidyselect elements by name</h2><span id='topic+select_l'></span>

<h3>Description</h3>

<p>Create a lens into a named collection. On <a href="#topic+set">set</a>
names of the input are not changed. This generalizes <a href="dplyr.html#topic+select">dplyr::select</a>
to arbitrary named collections and allows updating.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_l(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_l_+3A_...">...</code></td>
<td>
<p>An expression to be interpreted by <a href="tidyselect.html#topic+vars_select">tidyselect::vars_select</a>
which is the same interpreter as <a href="dplyr.html#topic+select">dplyr::select</a></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>lets &lt;- setNames(seq_along(LETTERS), LETTERS)
set(lets, select_l(G:F, A, B), 1:4) # A and B are 3,4 for a quick check
</code></pre>

<hr>
<h2 id='send'>Set one lens to the view of another</h2><span id='topic+send'></span>

<h3>Description</h3>

<p>Set one lens to the view of another
</p>


<h3>Usage</h3>

<pre><code class='language-R'>send(d, l, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="send_+3A_d">d</code></td>
<td>
<p>the data</p>
</td></tr>
<tr><td><code id="send_+3A_l">l</code></td>
<td>
<p>the lens to view through</p>
</td></tr>
<tr><td><code id="send_+3A_m">m</code></td>
<td>
<p>the lens to set into</p>
</td></tr>
</table>

<hr>
<h2 id='send_over'>Set one lens to the view of another (transformed)</h2><span id='topic+send_over'></span>

<h3>Description</h3>

<p>Set one lens to the view of another (transformed)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>send_over(d, l, m, f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="send_over_+3A_d">d</code></td>
<td>
<p>the data</p>
</td></tr>
<tr><td><code id="send_over_+3A_l">l</code></td>
<td>
<p>the lens to view through</p>
</td></tr>
<tr><td><code id="send_over_+3A_m">m</code></td>
<td>
<p>the lens to set into</p>
</td></tr>
<tr><td><code id="send_over_+3A_f">f</code></td>
<td>
<p>the function to apply to the viewed data</p>
</td></tr>
</table>

<hr>
<h2 id='set'>Modify data with a lens</h2><span id='topic+set'></span>

<h3>Description</h3>

<p>Set the subcomponent of the data referred to by a lens
with a new value. See <a href="#topic+lens">lens</a> for details.  Merely dispatches
to the <code>set</code> component of the lens.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set(d, l, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_+3A_d">d</code></td>
<td>
<p>the data, or an <a href="#topic+oscope">oscope</a></p>
</td></tr>
<tr><td><code id="set_+3A_l">l</code></td>
<td>
<p>the lens, or in the case of an <code>oscope</code>, the replacement</p>
</td></tr>
<tr><td><code id="set_+3A_x">x</code></td>
<td>
<p>the replacement value, or nothing in the case of an <code>oscope</code></p>
</td></tr>
</table>

<hr>
<h2 id='slab_l'>Slab lens</h2><span id='topic+slab_l'></span>

<h3>Description</h3>

<p>Create a lens into a chunk of an array (hyperslab). Uses
the same syntactic rules as <code>[</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slab_l(..., drop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slab_l_+3A_...">...</code></td>
<td>
<p>arguments as they would be passed to <code>[</code> for example <code>x[3,5,7]</code>.</p>
</td></tr>
<tr><td><code id="slab_l_+3A_drop">drop</code></td>
<td>
<p>whether or not to drop dimensions with length 1. Only
applies to <code>view</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- matrix(1:4, ncol = 2))
view(x, slab_l(2,)) # x[2,, drop = FALSE]
view(x, slab_l(2, 2)) # x[2,2, drop = FALSE]
set(x, slab_l(1,1:2), c(10,20))
</code></pre>

<hr>
<h2 id='slice_l'>Slice lens</h2><span id='topic+slice_l'></span>

<h3>Description</h3>

<p>Create a lens into a specific slice of a specific
dimension of a multidimensional object. Not to be
confused with dplyr slice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slice_l(dimension, slice, drop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slice_l_+3A_dimension">dimension</code></td>
<td>
<p>the dimension to slice</p>
</td></tr>
<tr><td><code id="slice_l_+3A_slice">slice</code></td>
<td>
<p>the slice index</p>
</td></tr>
<tr><td><code id="slice_l_+3A_drop">drop</code></td>
<td>
<p>whether or not to drop dimensions with length 1.
Only applies to <a href="#topic+view">view</a>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- matrix(1:4, ncol = 2))
view(x, slice_l(1, 2)) # x[2,, drop = FALSE]
view(x, slice_l(2, 2)) # x[,2, drop = FALSE]
set(x, slice_l(1,1), c(10,20))
</code></pre>

<hr>
<h2 id='slot_l'>Slot lens</h2><span id='topic+slot_l'></span>

<h3>Description</h3>

<p>The lens equivalent of <code>@</code> and <code>@&lt;-</code>
for getting and setting S4 object slots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slot_l(slot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slot_l_+3A_slot">slot</code></td>
<td>
<p>the name of the slot</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>new_class &lt;- setClass("new_class", slots = c(x = "numeric"))
(x &lt;- new_class())

view(x, slot_l("x"))
set(x, slot_l("x"), 1:10)
</code></pre>

<hr>
<h2 id='t_l'>Matrix transpose lens</h2><span id='topic+t_l'></span>

<h3>Description</h3>

<p>Lens into the transpose of a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- matrix(1:4, ncol = 2))
view(x, t_l)
set(x, t_l, matrix(11:14, ncol = 2))
</code></pre>

<hr>
<h2 id='take_l'>Construct a lens into a prefix of a vector</h2><span id='topic+take_l'></span>

<h3>Description</h3>

<p>This constructs a lens into the first <code>n</code> elements
of an object or the if negative indexing is used,
as many as <code>length(x) - n</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>take_l(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="take_l_+3A_n">n</code></td>
<td>
<p>number of elements to take, or if negative the
number of elements at the end to not take.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
view(x, take_l(3))
view(x, take_l(-7))
set(x, take_l(2), c(100,200))
set(x, take_l(-8), c(100,200))
</code></pre>

<hr>
<h2 id='take_while_il'>Conditional head lens</h2><span id='topic+take_while_il'></span>

<h3>Description</h3>

<p>A lens into the elements from the beginning
of a structure until the last element that satisfies a
predicate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>take_while_il(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="take_while_il_+3A_f">f</code></td>
<td>
<p>the predicate (logical) function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This lens is illegal because <code>set-view</code> is not satisfied,
multiple runs of the same lens will reference potentially
different elements.
</p>

<hr>
<h2 id='to_l'>Promote a function to a <code>getter</code> lens</h2><span id='topic+to_l'></span>

<h3>Description</h3>

<p>Create a <code>getter</code> lens from a function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_l(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_l_+3A_f">f</code></td>
<td>
<p>The function to promote.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># This wouldn't make sense as a general legal lens, but fine as a `getter`
sqrt_l &lt;- to_l(sqrt)
iris_root &lt;- index(1) %.% index(1) %.% sqrt_l

sqrt(iris[[1]][[1]])
iris %&gt;% view(iris_root)
tryCatch(iris %&gt;% set(iris_root, 2)
       , error = function(e) "See, can't do that")

</code></pre>

<hr>
<h2 id='transpose_l'>Lens into a list of rows</h2><span id='topic+transpose_l'></span>

<h3>Description</h3>

<p>A lens that creates a list-of-rows view of a <code>data.frame</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transpose_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>

<hr>
<h2 id='unlist_l'>Unlist lens</h2><span id='topic+unlist_l'></span>

<h3>Description</h3>

<p>A lens between a list and an unrecursively <a href="base.html#topic+unlist">unlist</a>ed object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unlist_l
</code></pre>


<h3>Format</h3>

<p>An object of class <code>lens</code> of length 2.</p>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- list(x = list(y = 1:10)))
view(x, unlist_l)
set(x, unlist_l %.% unlist_l, rep("hello", 10))
</code></pre>

<hr>
<h2 id='upper_tri_l'>Lens into upper diagonal elements</h2><span id='topic+upper_tri_l'></span>

<h3>Description</h3>

<p>Create a lens into the upper diagonal elements
of a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upper_tri_l(diag = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="upper_tri_l_+3A_diag">diag</code></td>
<td>
<p>whether or not to include the diagonal
(x &lt;- matrix(1:9, ncol = 3))
view(x, upper_tri_l())
view(x, upper_tri_l(diag = TRUE))
set(x, upper_tri_l(), c(100, 200, 300))</p>
</td></tr>
</table>

<hr>
<h2 id='view'>View data with a lens</h2><span id='topic+view'></span>

<h3>Description</h3>

<p>Get the subcomponent of the data referred to by a lens.  This function
merely dispatches to the <code>view</code> component of the lens.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view(d, l)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_+3A_d">d</code></td>
<td>
<p>the data</p>
</td></tr>
<tr><td><code id="view_+3A_l">l</code></td>
<td>
<p>the lens</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
