<!DOCTYPE html><html><head><title>Help for package glmMisrep</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {glmMisrep}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gammaRegMisrepEM'><p>Fit a Gamma Misrepresentation Model using EM Algorithm</p></a></li>
<li><a href='#LnRegMisrepEM'>
<p>Fit a Lognormal Misrepresentation Model using EM Algorithm</p></a></li>
<li><a href='#MEPS14'>
<p>MEPS 2014 Full Year Consolidated Data File</p></a></li>
<li><a href='#nbRegMisrepEM'>
<p>Fit a Negative Binomial Misrepresentation Model using EM Algorithm</p></a></li>
<li><a href='#NormRegMisrepEM'>
<p>Fit a Linear Regression Misrepresentation Model using EM Algorithm</p></a></li>
<li><a href='#poisRegMisrepEM'>
<p>Fit a Poisson Misrepresentation Model using EM Algorithm</p></a></li>
<li><a href='#predict.misrepEM'>
<p>Predict method for 'misrepEM' Model Fits</p></a></li>
<li><a href='#summary.misrepEM'>
<p>Summarize a 'misrepEM' Model Fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Linear Models Adjusting for Misrepresentation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit Generalized Linear Models to continuous and count outcomes, as well as estimate the prevalence of misrepresentation of an important binary predictor. Misrepresentation typically arises when there is an incentive for the binary factor to be misclassified in one direction (e.g., in insurance settings where policy holders may purposely deny a risk status in order to lower the insurance premium). This is accomplished by treating a subset of the response variable as resulting from a mixture distribution. Model parameters are estimated via the Expectation Maximization algorithm and standard errors of the estimates are obtained from closed forms of the Observed Fisher Information. For an introduction to the models and the misrepresentation framework, see Xia et. al., (2023) <a href="https://variancejournal.org/article/73151-maximum-likelihood-approaches-to-misrepresentation-models-in-glm-ratemaking-model-comparisons">https://variancejournal.org/article/73151-maximum-likelihood-approaches-to-misrepresentation-models-in-glm-ratemaking-model-comparisons</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, poisson.glm.mix, stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-18 16:11:06 UTC; patri</td>
</tr>
<tr>
<td>Author:</td>
<td>Patrick Rafael [cre, aut],
  Xia Michelle [aut],
  Rexford Akakpo [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Patrick Rafael &lt;pbr2608@vt.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-18 17:43:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='gammaRegMisrepEM'>Fit a Gamma Misrepresentation Model using EM Algorithm</h2><span id='topic+gammaRegMisrepEM'></span>

<h3>Description</h3>

<p><code>gammaRegMisrepEM</code> is used to fit a Gamma regression model, adjusting for misrepresentation on a binary predictor. The function uses the Expectation Maximization algorithm and allows multiple additional correctly measured independent variables in the Gamma regression with a log-link function that is typically used in insurance claims modeling. Standard errors of model estimates are obtained from closed form expressions of the Observed Fisher Information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gammaRegMisrepEM(formula, v_star, data, lambda = c(0.6,0.4),
                 epsilon = 1e-08, maxit = 10000,
                 maxrestarts = 20, verb = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gammaRegMisrepEM_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under ‘Details’.</p>
</td></tr>
<tr><td><code id="gammaRegMisrepEM_+3A_v_star">v_star</code></td>
<td>
<p>a character specifying the name of the binary predictor that is suspected of being misrepresented.</p>
</td></tr>
<tr><td><code id="gammaRegMisrepEM_+3A_data">data</code></td>
<td>
<p>a dataframe containing the variables in the model.</p>
</td></tr>
<tr><td><code id="gammaRegMisrepEM_+3A_lambda">lambda</code></td>
<td>
<p>initial mixing proportions used to start the EM algorithm. A numeric vector of length two, with the second element being the prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code id="gammaRegMisrepEM_+3A_epsilon">epsilon</code></td>
<td>
<p>tolerance for convergence. Convergence is reached when the log-likelihood increases by less than epsilon.</p>
</td></tr>
<tr><td><code id="gammaRegMisrepEM_+3A_maxit">maxit</code></td>
<td>
<p>the maximum number of iterations the EM routine will run for.</p>
</td></tr>
<tr><td><code id="gammaRegMisrepEM_+3A_maxrestarts">maxrestarts</code></td>
<td>
<p>how many times the EM routine will attempt to converge. When conergence is not achieved, the EM routine restarts with new randomly selected mixing proportions.</p>
</td></tr>
<tr><td><code id="gammaRegMisrepEM_+3A_verb">verb</code></td>
<td>
<p>logical. If TRUE, the difference in new .vs. old log-likelihood and the current log-likelihood is printed to the console after every iteration. If TRUE, the user will also be notifed if the EM algorithm must restart with new mixing proportions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models for <code>gammaRegMisrepEM</code> are specified symbolically. Like the <code>lm</code> and <code>glm</code> functions, the model has the form <code>response ~ terms</code>, where <code>response</code> is the numeric response vector and <code>terms</code> is a series of terms which specifies a linear predictor for <code>response</code>.
</p>
<p>Currently, formula specification can accommodate the following expressions:
</p>

<ul>
<li><p>transformations of the response: <code>log(y) ~ x</code>
</p>
</li>
<li><p>polynomial terms: <code>y ~ x + I(x^2)</code>
</p>
</li>
<li><p>interactions: <code>y ~ x*z</code>
</p>
</li></ul>

<p>Including an offset term (e.g. <code>y ~ x + offset()</code>) is currently not supported.
</p>


<h3>Value</h3>

<p><code>gammaRegMisrepEM</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"misrepEM"</code>.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the results.
</p>
<p>An object of class <code>"misrepEM"</code> is a list containing the following 14 elements:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>the response used.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>numeric. The estimated prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>a numeric vector containing the estimated parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the final maximized log-likelihood.</p>
</td></tr>
<tr><td><code>posterior</code></td>
<td>
<p>a numeric vector. The posterior probability that the <em>i-th</em> observation is not misrepresented for observations where the suspected misrepresented variable is zero, based on the last iteration of the EM algorithm. The values are not meaningful for observations where the suspected misrepresented variable is one.</p>
</td></tr>
<tr><td><code>all.loglik</code></td>
<td>
<p>a numeric vector containing the log-likelihood at every iteration.</p>
</td></tr>
<tr><td><code>cov.estimates</code></td>
<td>
<p>the inverse of the observed fisher information matrix evaluated at the maximum likelihood estimates.</p>
</td></tr>
<tr><td><code>std.error</code></td>
<td>
<p>a numeric vector containing the standard errors of regression coefficients.</p>
</td></tr>
<tr><td><code>t.values</code></td>
<td>
<p>a numeric vector containing the standardized regression coefficients.</p>
</td></tr>
<tr><td><code>p.values</code></td>
<td>
<p>a numeric vector containing the <em>p-</em>values of the regression coefficients.</p>
</td></tr>
<tr><td><code>ICs</code></td>
<td>
<p>a numeric vector of length three containing the AIC, AICc, and BIC.</p>
</td></tr>
<tr><td><code>ft</code></td>
<td>
<p>a character containing the name of the function.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> indicating the model that was fit.</p>
</td></tr>
<tr><td><code>v_star_name</code></td>
<td>
<p>a character containing the name of the binary predictor suspected of misrepresentation.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Xia, Michelle, Rexford Akakpo, and Matthew Albaugh. &quot;Maximum Likelihood Approaches to Misrepresentation Models in GLM ratemaking: Model Comparisons.&quot; <em>Variance</em> 16.1 (2023).
</p>
<p>Akakpo, R. M., Xia, M., &amp; Polansky, A. M. (2019). Frequentist inference in insurance ratemaking models adjusting for misrepresentation. <em>ASTIN Bulletin: The Journal of the IAA, 49</em>(1), 117-146.
</p>
<p>Xia, M., Hua, L., &amp; Vadnais, G. (2018). Embedded predictive analysis of misrepresentation risk in GLM ratemaking models. <em>Variance, 12</em>(1), 39-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


set.seed(314159)

# Simulate data
n &lt;- 1000
p0 &lt;- 0.25

X1 &lt;- rbinom(n, 1, 0.4)
X2 &lt;- sample(x = c("a", "b", "c"), size = n, replace = TRUE)
X3 &lt;- rnorm(n, 0, 1)

theta0 &lt;- 0.3
V &lt;- rbinom(n,1,theta0)
V_star &lt;- V
V_star[V==1] &lt;- rbinom(sum(V==1),1,1-p0)

a0 &lt;- 1
a1 &lt;- 2
a2 &lt;- 0
a3 &lt;- -1
a4 &lt;- 4
a5 &lt;- 2

mu &lt;- rep(0, n)

for(i in 1:n){

  mu[i] &lt;- exp(a0 + a1*X1 + a4*X3 + a5*V )[i]

  if(X2[i] == "a" || X2[i] == "b"){

    mu[i] &lt;- mu[i]*exp(a2)

  }else{
    mu[i] &lt;- mu[i]*exp(a3)
  }

}

phi &lt;- 0.2
alpha0 &lt;- 1/phi
beta &lt;- 1/mu/phi
Y &lt;- rgamma(n, alpha0, beta)

data &lt;- data.frame(Y = Y, X1 = X1, X2 = X2, X3 = X3, V_star = V_star)

# "a" is the reference
data$X2 &lt;- as.factor(data$X2)

# Model with main effects:
gamma_mod &lt;- gammaRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star,
                              v_star = "V_star", data = data)

# The prevalence of misrepresentation;
(theta0 * p0) / (1 - theta0*(1-p0)) # 0.09677419

# Parameter estimates and estimated prevalence of
# misrepresentation (lambda);
summary(gamma_mod)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  0.99356    0.03013  32.97245   &lt;2e-16 ***
# X1           2.02152    0.03078  65.68276   &lt;2e-16 ***
# X2b         -0.00679    0.03708  -0.18309  0.85477
# X2c         -1.02578    0.03684 -27.84599   &lt;2e-16 ***
# X3           3.97883    0.01495 266.21973   &lt;2e-16 ***
# V_star       2.00437    0.03107  64.51234   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 5650.696 5650.841 5689.958
# ---
# Log-Likelihood
#      -2817.348
# ---
# Lambda:  0.1083894 std.err:  0.01160662


# Fitting an interaction between X2 and X3;

a6 &lt;- -2
a7 &lt;- 2

for(i in 1:n){

  if(X2[i] == "c"){
    mu[i] &lt;- mu[i]*exp(a6*X3[i])
  }else{
    if(X2[i] =="b"){
      mu[i] &lt;- mu[i]*exp(a7*X3[i])
    }
  }
}

beta &lt;- 1/mu/phi
Y &lt;- rgamma(n, alpha0, beta)

data$Y &lt;- Y

gamma_mod &lt;- gammaRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star + X2*X3,
                              v_star = "V_star", data = data)

summary(gamma_mod)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  0.96205    0.03086  31.17145   &lt;2e-16 ***
# X1           2.00411    0.03061  65.46734   &lt;2e-16 ***
# X2b         -0.00987    0.03682  -0.26818  0.78862
# X2c         -0.99957    0.03733 -26.77449   &lt;2e-16 ***
# X3           3.98282    0.02484 160.31083   &lt;2e-16 ***
# V_star       2.01107    0.03077  65.36550   &lt;2e-16 ***
# X2b:X3       1.95884    0.03573  54.82466   &lt;2e-16 ***
# X2c:X3      -1.98595    0.03567 -55.67827   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 5633.984 5634.207 5683.062
# ---
# Log-Likelihood
#      -2806.992
# ---
# Lambda:  0.1131951 std.err:  0.01181678


# Model fitting with a polynomial effect;

a8 &lt;- -0.5

mu &lt;- mu*exp(a8*X3^2)

beta &lt;- 1/mu/phi
Y &lt;- rgamma(n, alpha0, beta)

data$Y &lt;- Y

gamma_mod &lt;- gammaRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star + X2*X3 + I(X3^2),
                              v_star = "V_star", data = data)

summary(gamma_mod)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  1.04312    0.03164  32.96624   &lt;2e-16 ***
# X1           2.04411    0.02929  69.79020   &lt;2e-16 ***
# X2b         -0.10418    0.03512  -2.96620  0.00309  **
# X2c         -1.08910    0.03531 -30.84683   &lt;2e-16 ***
# X3           4.00265    0.02421 165.31001   &lt;2e-16 ***
# V_star       1.98741    0.02951  67.35719   &lt;2e-16 ***
# I(X3^2)     -0.51152    0.01350 -37.90112   &lt;2e-16 ***
# X2b:X3       1.98709    0.03598  55.22750   &lt;2e-16 ***
# X2c:X3      -2.03395    0.03692 -55.09491   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 4559.969 4560.236 4613.954
# ---
# Log-Likelihood
#      -2268.984
# ---
# Lambda:  0.111464 std.err:  0.01173143



</code></pre>

<hr>
<h2 id='LnRegMisrepEM'>
Fit a Lognormal Misrepresentation Model using EM Algorithm
</h2><span id='topic+LnRegMisrepEM'></span>

<h3>Description</h3>

<p><code>LnRegMisrepEM</code> is used to fit a Lognormal regression model, adjusting for misrepresentation on a binary predictor. The function uses the Expectation Maximization algorithm and allows multiple additional correctly measured independent variables in the Lognormal regression with an identity link function that is typically used in insurance claims modeling. Standard errors of model estimates are obtained from closed form expressions of the Observed Fisher Information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LnRegMisrepEM(formula, v_star, data, lambda = c(0.6,0.4),
                 epsilon = 1e-08, maxit = 10000,
                 maxrestarts = 20, verb = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LnRegMisrepEM_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under ‘Details’.</p>
</td></tr>
<tr><td><code id="LnRegMisrepEM_+3A_v_star">v_star</code></td>
<td>
<p>a character specifying the name of the binary predictor that is suspected of being misrepresented.</p>
</td></tr>
<tr><td><code id="LnRegMisrepEM_+3A_data">data</code></td>
<td>
<p>a dataframe containing the variables in the model.</p>
</td></tr>
<tr><td><code id="LnRegMisrepEM_+3A_lambda">lambda</code></td>
<td>
<p>initial mixing proportions used to start the EM algorithm. A numeric vector of length two, with the second element being the prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code id="LnRegMisrepEM_+3A_epsilon">epsilon</code></td>
<td>
<p>tolerance for convergence. Convergence is reached when the log-likelihood increases by less than epsilon.</p>
</td></tr>
<tr><td><code id="LnRegMisrepEM_+3A_maxit">maxit</code></td>
<td>
<p>the maximum number of iterations the EM routine will run for.</p>
</td></tr>
<tr><td><code id="LnRegMisrepEM_+3A_maxrestarts">maxrestarts</code></td>
<td>
<p>how many times the EM routine will attempt to converge. When conergence is not achieved, the EM routine restarts with new randomly selected mixing proportions.</p>
</td></tr>
<tr><td><code id="LnRegMisrepEM_+3A_verb">verb</code></td>
<td>
<p>logical. If TRUE, the difference in new .vs. old log-likelihood and the current log-likelihood is printed to the console after every iteration. If TRUE, the user will also be notifed if the EM algorithm must restart with new mixing proportions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Please note:</b> In the Log-Normal regression setting, the response is assumed to be Log-Normally distributed, so the function <code>LnRegMisrepEM</code> requires that the <code>formula</code> argument have a certain form: <code>log(response) ~ terms</code>. See 'Examples' for a demonstration.
</p>
<p>Models for <code>LnRegMisrepEM</code> are specified symbolically. Like the <code>lm</code> and <code>glm</code> functions, the model has the form <code>response ~ terms</code>, where <code>response</code> is the numeric response vector and <code>terms</code> is a series of terms which specifies a linear predictor for <code>response</code>.
</p>
<p>Currently, formula specification can accommodate the following expressions:
</p>

<ul>
<li><p>transformations of the response: <code>log(y) ~ x</code>
</p>
</li>
<li><p>polynomial terms: <code>y ~ x + I(x^2)</code>
</p>
</li>
<li><p>interactions: <code>y ~ x*z</code>
</p>
</li></ul>

<p>Including an offset term (e.g. <code>y ~ x + offset()</code>) is currently not supported.
</p>


<h3>Value</h3>

<p><code>LnRegMisrepEM</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"misrepEM"</code>.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the results.
</p>
<p>An object of class <code>"misrepEM"</code> is a list containing the following 14 elements:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>the response used.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>numeric. The estimated prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>a numeric vector containing the estimated parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the final maximized log-likelihood.</p>
</td></tr>
<tr><td><code>posterior</code></td>
<td>
<p>a numeric vector. The posterior probability that the <em>i-th</em> observation is not misrepresented for observations where the suspected misrepresented variable is zero, based on the last iteration of the EM algorithm. The values are not meaningful for observations where the suspected misrepresented variable is one.</p>
</td></tr>
<tr><td><code>all.loglik</code></td>
<td>
<p>a numeric vector containing the log-likelihood at every iteration.</p>
</td></tr>
<tr><td><code>cov.estimates</code></td>
<td>
<p>the inverse of the observed fisher information matrix evaluated at the maximum likelihood estimates.</p>
</td></tr>
<tr><td><code>std.error</code></td>
<td>
<p>a numeric vector containing the standard errors of regression coefficients.</p>
</td></tr>
<tr><td><code>t.values</code></td>
<td>
<p>a numeric vector containing the standardized regression coefficients.</p>
</td></tr>
<tr><td><code>p.values</code></td>
<td>
<p>a numeric vector containing the <em>p-</em>values of the regression coefficients.</p>
</td></tr>
<tr><td><code>ICs</code></td>
<td>
<p>a numeric vector of length three containing the AIC, AICc, and BIC.</p>
</td></tr>
<tr><td><code>ft</code></td>
<td>
<p>a character containing the name of the function.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> indicating the model that was fit.</p>
</td></tr>
<tr><td><code>v_star_name</code></td>
<td>
<p>a character containing the name of the binary predictor suspected of misrepresentation.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Xia, Michelle, Rexford Akakpo, and Matthew Albaugh. &quot;Maximum Likelihood Approaches to Misrepresentation Models in GLM ratemaking: Model Comparisons.&quot; <em>Variance</em> 16.1 (2023).
</p>
<p>Akakpo, R. M., Xia, M., &amp; Polansky, A. M. (2019). Frequentist inference in insurance ratemaking models adjusting for misrepresentation. <em>ASTIN Bulletin: The Journal of the IAA, 49</em>(1), 117-146.
</p>
<p>Xia, M., Hua, L., &amp; Vadnais, G. (2018). Embedded predictive analysis of misrepresentation risk in GLM ratemaking models. <em>Variance, 12</em>(1), 39-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
n &lt;- 1000
p0 &lt;- 0.25

X1 &lt;- rbinom(n, 1, 0.4)
X2 &lt;- sample(x = c("a", "b", "c"), size = n, replace = TRUE)
X3 &lt;- rnorm(n, 0, 1)

theta0 &lt;- 0.3
V &lt;- rbinom(n,1,theta0)
V_star &lt;- V
V_star[V==1] &lt;- rbinom(sum(V==1),1,1-p0)

a0 &lt;- 1
a1 &lt;- 2
a2 &lt;- 0
a3 &lt;- -1
a4 &lt;- 4
a5 &lt;- 2

mu &lt;- rep(0, n)

for(i in 1:n){

  mu[i] &lt;- exp(a0 + a1*X1 + a4*X3 + a5*V )[i]

  if(X2[i] == "a" || X2[i] == "b"){

    mu[i] &lt;- mu[i]*exp(a2)

  }else{
    mu[i] &lt;- mu[i]*exp(a3)
  }

}

sigma &lt;- 0.427
mu.norm &lt;- log(mu)-sigma^2/2
Y &lt;- rlnorm(n, mu.norm, sigma)

data &lt;- data.frame(Y = Y, X1 = X1, X2 = X2, X3 = X3, V_star = V_star)

# "a" is the reference
data$X2 &lt;- as.factor(data$X2)

# Model with main effects:
LN_mod &lt;- LnRegMisrepEM(formula = log(Y) ~ X1 + X2 + X3 + V_star,
                        v_star = "V_star", data = data)

# The prevalence of misrepresentation;
(theta0 * p0) / (1 - theta0*(1-p0)) # 0.09677419

# Parameter estimates and estimated prevalence of
# misrepresentation (lambda);
summary(LN_mod)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  1.00664    0.02874  35.02082   &lt;2e-16 ***
# X1           1.95903    0.02825  69.35263   &lt;2e-16 ***
# X2b          0.04106    0.03413   1.20303  0.22925
# X2c         -1.00367    0.03418 -29.36328   &lt;2e-16 ***
# X3           4.00031    0.01366 292.75312   &lt;2e-16 ***
# V_star       2.01422    0.02922  68.93902   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 5555.224 5555.370 5594.486
# ---
# Log-Likelihood
#      -2769.612
# ---
# Lambda:  0.11085 std.err:  0.01150365


# Fitting an interaction between X2 and X3;

a6 &lt;- -2
a7 &lt;- 2

for(i in 1:n){

  if(X2[i] == "c"){
    mu[i] &lt;- mu[i]*exp(a6*X3[i])
  }else{
    if(X2[i] =="b"){
      mu[i] &lt;- mu[i]*exp(a7*X3[i])
    }
  }
}

mu.norm &lt;- log(mu)-sigma^2/2
Y &lt;- rlnorm(n, mu.norm, sigma)

data$Y &lt;- Y

LN_mod &lt;- LnRegMisrepEM(formula = log(Y) ~ X1 + X2 + X3 + V_star + X2*X3,
                        v_star = "V_star", data = data)

summary(LN_mod)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  0.95064    0.02905  32.71943   &lt;2e-16 ***
# X1           2.04258    0.02876  71.02228   &lt;2e-16 ***
# X2b          0.00204    0.03463   0.05879  0.95314
# X2c         -0.97738    0.03469 -28.17315   &lt;2e-16 ***
# X3           3.97014    0.02341 169.61122   &lt;2e-16 ***
# V_star       2.01894    0.02967  68.04786   &lt;2e-16 ***
# X2b:X3       2.00436    0.03459  57.95433   &lt;2e-16 ***
# X2c:X3      -1.97573    0.03431 -57.59173   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 5505.180 5505.402 5554.257
# ---
# Log-Likelihood
#       -2742.59
# ---
# Lambda:  0.1055629 std.err:  0.01134298

# Model fitting with a polynomial effect;

a8 &lt;- -0.5

mu &lt;- mu*exp(a8*X3^2)

mu.norm &lt;- log(mu)-sigma^2/2
Y &lt;- rlnorm(n, mu.norm, sigma)

data$Y &lt;- Y

LN_mod &lt;- LnRegMisrepEM(formula = log(Y) ~ X1 + X2 + X3 + V_star + X2*X3 + I(X3^2),
                        v_star = "V_star", data = data)

summary(LN_mod)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  0.95591    0.03084  30.99533   &lt;2e-16 ***
# X1           2.00070    0.02878  69.52672   &lt;2e-16 ***
# X2b          0.09309    0.03480   2.67464   0.0076  **
# X2c         -0.96572    0.03455 -27.95530   &lt;2e-16 ***
# X3           3.96765    0.02378 166.82860   &lt;2e-16 ***
# V_star       2.00513    0.02967  67.58486   &lt;2e-16 ***
# I(X3^2)     -0.49043    0.00983 -49.90063   &lt;2e-16 ***
# X2b:X3       2.04614    0.03454  59.24411   &lt;2e-16 ***
# X2c:X3      -1.97248    0.03383 -58.30378   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 4537.485 4537.752 4591.470
# ---
# Log-Likelihood
#      -2257.742
# ---
# Lambda:  0.1061872 std.err:  0.01138758

</code></pre>

<hr>
<h2 id='MEPS14'>
MEPS 2014 Full Year Consolidated Data File
</h2><span id='topic+MEPS14'></span>

<h3>Description</h3>

<p>MEPS14 is a subset of the MEPS 2014 Full Year Consolidated Data File, as described in Xia et. al., (2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MEPS14")</code></pre>


<h3>Format</h3>

<p>A data frame with 13,301 observations on the following 7 variables:
</p>

<dl>
<dt><code>TOTEXP14</code></dt><dd><p>total medical expenditure.</p>
</dd>
<dt><code>OBTOTV14</code></dt><dd><p>total number of office-based visits.</p>
</dd>
<dt><code>UNINS14</code></dt><dd><p>uninsured status (1 - insured, 0 - uninsured).</p>
</dd>
<dt><code>SEX</code></dt><dd><p>sex (1 - male, 0 - female).</p>
</dd>
<dt><code>AGE14X</code></dt><dd><p>age.</p>
</dd>
<dt><code>ADSMOK42</code></dt><dd><p>smoking status (1 - yes, 0 - no).</p>
</dd>
<dt><code>RTHLTH53</code></dt><dd><p>perceieved health status (1 - excellent, 5 - poor).</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://meps.ahrq.gov/mepsweb/data_stats/download_data_files_detail.jsp?cboPufNumber=HC-171">https://meps.ahrq.gov/mepsweb/data_stats/download_data_files_detail.jsp?cboPufNumber=HC-171</a>
</p>


<h3>References</h3>

<p>Xia, Michelle, Rexford Akakpo, and Matthew Albaugh. &quot;Maximum Likelihood Approaches to Misrepresentation Models in GLM ratemaking: Model Comparisons.&quot; <em>Variance</em> 16.1 (2023).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Reproducing table 4 in Xia et. al., (2023).

data(MEPS14)

colMeans(MEPS14)
#    TOTEXP14     OBTOTV14      UNINS14          SEX       AGE14X     ADSMOK42     RTHLTH53
#5042.4647771    6.2260732    0.1242012    0.4153071   41.6628825    0.1670551    2.4319224

apply(MEPS14, 2, sd)
#    TOTEXP14     OBTOTV14      UNINS14          SEX       AGE14X     ADSMOK42     RTHLTH53
#1.358567e+04 1.272065e+01 3.298233e-01 4.927934e-01 1.332746e+01 3.730391e-01 1.074713e+00

sum(MEPS14$OBTOTV14 == 0 ) / nrow(MEPS14)
# [1] 0.1595369

sd(MEPS14$OBTOTV14 == 0)
# [1] 0.3661898

# Fit Gamma regression model with insured status as
# the misrepresented variable.
MEPS14$RTHLTH53 &lt;- as.factor(MEPS14$RTHLTH53)

gamma_fit &lt;- gammaRegMisrepEM(formula = TOTEXP14 ~ UNINS14
             + SEX + AGE14X + ADSMOK42 + RTHLTH53,
             v_star = "UNINS14", data = MEPS14)

# summary returns a table of summary statistics, including
# goodness of fits (AIC, AICc, BIC), as well as the
# estimated prevalence of misrepresentation.
summary(gamma_fit)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  8.03379    0.05341 150.41937   &lt;2e-16 ***
# UNINS14     -1.98132    0.03170 -62.49292   &lt;2e-16 ***
# SEX         -0.20427    0.02669  -7.65320   &lt;2e-16 ***
# AGE14X       0.02764    0.00099  27.83485   &lt;2e-16 ***
# ADSMOK42    -0.08868    0.03653  -2.42776  0.01521   *
# RTHLTH532    0.24923    0.03533   7.05469   &lt;2e-16 ***
# RTHLTH533    0.53860    0.03655  14.73488   &lt;2e-16 ***
# RTHLTH534    1.00615    0.04837  20.80026   &lt;2e-16 ***
# RTHLTH535    1.87845    0.08104  23.17833   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 241083.9 241083.9 241166.3
# ---
# Log-Likelihood
#      -120530.9
# ---
# Lambda:  0.7734337 std.err:  0.009628053


# Fit Lognormal regression model with insured status as
# the misrepresented variable.
LN_fit &lt;- LnRegMisrepEM(formula = log(TOTEXP14) ~ UNINS14
             + SEX + AGE14X + ADSMOK42 + RTHLTH53,
             v_star = "UNINS14", data = MEPS14)

summary(LN_fit)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  7.28974    0.05648 129.05986   &lt;2e-16 ***
# UNINS14     -1.29503    0.05496 -23.56317   &lt;2e-16 ***
# SEX         -0.29590    0.02808 -10.53844   &lt;2e-16 ***
# AGE14X       0.02460    0.00107  23.10180   &lt;2e-16 ***
# ADSMOK42    -0.07008    0.03756  -1.86591  0.06208   .
# RTHLTH532    0.26349    0.03831   6.87786   &lt;2e-16 ***
# RTHLTH533    0.47184    0.03942  11.97017   &lt;2e-16 ***
# RTHLTH534    1.05065    0.04990  21.05580   &lt;2e-16 ***
# RTHLTH535    1.94978    0.08067  24.16987   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 239726.4 239726.4 239808.8
# ---
# Log-Likelihood
#      -119852.2
# ---
# Lambda:  0.1110631 std.err:  0.02548188


# Fit Negative Binomial regression model with insured status as
# the misrepresented variable.
NB_fit &lt;- nbRegMisrepEM(formula = OBTOTV14 ~ UNINS14
             + SEX + AGE14X + ADSMOK42 + RTHLTH53,
             v_star = "UNINS14", data = MEPS14)


summary(NB_fit)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  2.00472    0.05463  36.69491   &lt;2e-16 ***
# UNINS14     -1.68638    0.03371 -50.02640   &lt;2e-16 ***
# SEX         -0.40917    0.02303 -17.76536   &lt;2e-16 ***
# AGE14X       0.01897    0.00087  21.91823   &lt;2e-16 ***
# ADSMOK42    -0.11391    0.03038  -3.74948  0.00018 ***
# RTHLTH532    0.20720    0.03183   6.50966   &lt;2e-16 ***
# RTHLTH533    0.36794    0.03240  11.35678   &lt;2e-16 ***
# RTHLTH534    0.72357    0.03978  18.18859   &lt;2e-16 ***
# RTHLTH535    1.24468    0.06281  19.81714   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 72788.71 72788.73 72871.16
# ---
# Log-Likelihood
#      -36383.35
# ---
# Lambda:  0.8351591 std.err:  0.009627158


# Fit Poisson regression model with smoking status as
# the misrepresented variable.
pois_fit &lt;- poisRegMisrepEM(formula = OBTOTV14 ~ UNINS14
             + SEX + AGE14X + ADSMOK42 + RTHLTH53,
             v_star = "UNINS14", data = MEPS14)

summary(pois_fit)

# Coefficients:
#             Estimate Std. Error    z value Pr(&gt;|z|)
# (Intercept)  2.27367    0.02276   99.87676   &lt;2e-16 ***
# UNINS14     -2.03719    0.00730 -279.00809   &lt;2e-16 ***
# SEX         -0.18594    0.01090  -17.05204   &lt;2e-16 ***
# AGE14X       0.01631    0.00042   38.90467   &lt;2e-16 ***
# ADSMOK42     0.09594    0.01313    7.30930   &lt;2e-16 ***
# RTHLTH532    0.14918    0.01641    9.09033   &lt;2e-16 ***
# RTHLTH533    0.31282    0.01620   19.31078   &lt;2e-16 ***
# RTHLTH534    0.75044    0.01793   41.85270   &lt;2e-16 ***
# RTHLTH535    1.09859    0.02265   48.49410   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 99599.31 99599.33 99674.27
# ---
# Log-Likelihood
#      -49789.66
# ---
# Lambda:  0.85957 std.err:  0.00348128


</code></pre>

<hr>
<h2 id='nbRegMisrepEM'>
Fit a Negative Binomial Misrepresentation Model using EM Algorithm
</h2><span id='topic+nbRegMisrepEM'></span>

<h3>Description</h3>

<p><code>nbRegMisrepEM</code> is used to fit a Negative Binomial regression model, adjusting for misrepresentation on a binary predictor. The function uses the Expectation Maximization algorithm and allows multiple additional correctly measured independent variables in the Negative Binomial regression with a log-link function that is typically used in insurance claims modeling. Standard errors of model estimates are obtained from closed form expressions of the Observed Fisher Information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbRegMisrepEM(formula, v_star, data, lambda = c(0.6,0.4),
                 epsilon = 1e-08, maxit = 10000,
                 maxrestarts = 20, verb = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbRegMisrepEM_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under ‘Details’.</p>
</td></tr>
<tr><td><code id="nbRegMisrepEM_+3A_v_star">v_star</code></td>
<td>
<p>a character specifying the name of the binary predictor that is suspected of being misrepresented.</p>
</td></tr>
<tr><td><code id="nbRegMisrepEM_+3A_data">data</code></td>
<td>
<p>a dataframe containing the variables in the model.</p>
</td></tr>
<tr><td><code id="nbRegMisrepEM_+3A_lambda">lambda</code></td>
<td>
<p>initial mixing proportions used to start the EM algorithm. A numeric vector of length two, with the second element being the prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code id="nbRegMisrepEM_+3A_epsilon">epsilon</code></td>
<td>
<p>tolerance for convergence. Convergence is reached when the log-likelihood increases by less than epsilon.</p>
</td></tr>
<tr><td><code id="nbRegMisrepEM_+3A_maxit">maxit</code></td>
<td>
<p>the maximum number of iterations the EM routine will run for.</p>
</td></tr>
<tr><td><code id="nbRegMisrepEM_+3A_maxrestarts">maxrestarts</code></td>
<td>
<p>how many times the EM routine will attempt to converge. When conergence is not achieved, the EM routine restarts with new randomly selected mixing proportions.</p>
</td></tr>
<tr><td><code id="nbRegMisrepEM_+3A_verb">verb</code></td>
<td>
<p>logical. If TRUE, the difference in new .vs. old log-likelihood and the current log-likelihood is printed to the console after every iteration. If TRUE, the user will also be notifed if the EM algorithm must restart with new mixing proportions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models for <code>nbRegMisrepEM</code> are specified symbolically. Like the <code>lm</code> and <code>glm</code> functions, the model has the form <code>response ~ terms</code>, where <code>response</code> is the numeric response vector and <code>terms</code> is a series of terms which specifies a linear predictor for <code>response</code>.
</p>
<p>Currently, formula specification can accommodate the following expressions:
</p>

<ul>
<li><p>transformations of the response: <code>log(y) ~ x</code>
</p>
</li>
<li><p>polynomial terms: <code>y ~ x + I(x^2)</code>
</p>
</li>
<li><p>interactions: <code>y ~ x*z</code>
</p>
</li></ul>

<p>Including an offset term (e.g. <code>y ~ x + offset()</code>) is currently not supported.
</p>


<h3>Value</h3>

<p><code>nbRegMisrepEM</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"misrepEM"</code>.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the results.
</p>
<p>An object of class <code>"misrepEM"</code> is a list containing the following 14 elements:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>the response used.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>numeric. The estimated prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>a numeric vector containing the estimated parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the final maximized log-likelihood.</p>
</td></tr>
<tr><td><code>posterior</code></td>
<td>
<p>a numeric vector. The posterior probability that the <em>i-th</em> observation is not misrepresented for observations where the suspected misrepresented variable is zero, based on the last iteration of the EM algorithm. The values are not meaningful for observations where the suspected misrepresented variable is one.</p>
</td></tr>
<tr><td><code>all.loglik</code></td>
<td>
<p>a numeric vector containing the log-likelihood at every iteration.</p>
</td></tr>
<tr><td><code>cov.estimates</code></td>
<td>
<p>the inverse of the observed fisher information matrix evaluated at the maximum likelihood estimates.</p>
</td></tr>
<tr><td><code>std.error</code></td>
<td>
<p>a numeric vector containing the standard errors of regression coefficients.</p>
</td></tr>
<tr><td><code>t.values</code></td>
<td>
<p>a numeric vector containing the standardized regression coefficients.</p>
</td></tr>
<tr><td><code>p.values</code></td>
<td>
<p>a numeric vector containing the <em>p-</em>values of the regression coefficients.</p>
</td></tr>
<tr><td><code>ICs</code></td>
<td>
<p>a numeric vector of length three containing the AIC, AICc, and BIC.</p>
</td></tr>
<tr><td><code>ft</code></td>
<td>
<p>a character containing the name of the function.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> indicating the model that was fit.</p>
</td></tr>
<tr><td><code>v_star_name</code></td>
<td>
<p>a character containing the name of the binary predictor suspected of misrepresentation.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Xia, Michelle, Rexford Akakpo, and Matthew Albaugh. &quot;Maximum Likelihood Approaches to Misrepresentation Models in GLM ratemaking: Model Comparisons.&quot; <em>Variance</em> 16.1 (2023).
</p>
<p>Akakpo, R. M., Xia, M., &amp; Polansky, A. M. (2019). Frequentist inference in insurance ratemaking models adjusting for misrepresentation. <em>ASTIN Bulletin: The Journal of the IAA, 49</em>(1), 117-146.
</p>
<p>Xia, M., Hua, L., &amp; Vadnais, G. (2018). Embedded predictive analysis of misrepresentation risk in GLM ratemaking models. <em>Variance, 12</em>(1), 39-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(314159)

# Simulate data
n &lt;- 1000
p0 &lt;- 0.25

X1 &lt;- rbinom(n, 1, 0.4)
X2 &lt;- sample(x = c("a", "b", "c"), size = n, replace = TRUE)
X3 &lt;- rnorm(n, 0, 1)

theta0 &lt;- 0.3
V &lt;- rbinom(n,1,theta0)
V_star &lt;- V
V_star[V==1] &lt;- rbinom(sum(V==1),1,1-p0)

a0 &lt;- 1
a1 &lt;- 2
a2 &lt;- 0
a3 &lt;- -1
a4 &lt;- 4
a5 &lt;- 2

mu &lt;- rep(0, n)

for(i in 1:n){

  mu[i] &lt;- exp(a0 + a1*X1 + a4*X3 + a5*V )[i]

  if(X2[i] == "a" || X2[i] == "b"){

    mu[i] &lt;- mu[i]*exp(a2)

  }else{
    mu[i] &lt;- mu[i]*exp(a3)
  }

}

Y &lt;- rnbinom(n, size = 1, mu = mu)

data &lt;- data.frame(Y = Y, X1 = X1, X2 = X2, X3 = X3, V_star = V_star)

# "a" is the reference
data$X2 &lt;- as.factor(data$X2)

# Model with main effects:
NB_mod &lt;- nbRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star,
                        v_star = "V_star", data = data)

# The prevalence of misrepresentation;
(theta0 * p0) / (1 - theta0*(1-p0)) # 0.09677419

# Parameter estimates and estimated prevalence of
# misrepresentation (lambda);
summary(NB_mod)

# Coefficients:
#             Estimate Std. Error  t value Pr(&gt;|t|)
# (Intercept)  0.94091    0.10797  8.71423   &lt;2e-16 ***
# X1           2.03485    0.09517 21.38182   &lt;2e-16 ***
# X2b          0.13346    0.10998  1.21356  0.22521
# X2c         -0.96514    0.11629 -8.29914   &lt;2e-16 ***
# X3           4.07667    0.05874 69.40599   &lt;2e-16 ***
# V_star       1.90011    0.09517 19.96485   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 7661.457 7661.602 7700.719
# ---
# Log-Likelihood
#      -3822.728
# ---
# Lambda:  0.093119 std.err:  0.02233344


# Fitting an interaction between X2 and X3;

a6 &lt;- -2
a7 &lt;- 2

for(i in 1:n){

  if(X2[i] == "c"){
    mu[i] &lt;- mu[i]*exp(a6*X3[i])
  }else{
    if(X2[i] =="b"){
      mu[i] &lt;- mu[i]*exp(a7*X3[i])
    }
  }
}

Y &lt;- rnbinom(n, size = 1, mu = mu)

data$Y &lt;- Y

NB_mod &lt;- nbRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star + X2*X3,
                        v_star = "V_star", data = data)

summary(NB_mod)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  0.89452    0.11135   8.03331   &lt;2e-16 ***
# X1           2.13269    0.08473  25.17143   &lt;2e-16 ***
# X2b         -0.01559    0.12545  -0.12429  0.90111
# X2c         -0.95827    0.11665  -8.21469   &lt;2e-16 ***
# X3           4.09454    0.09061  45.19049   &lt;2e-16 ***
# V_star       2.08187    0.08503  24.48402   &lt;2e-16 ***
# X2b:X3       1.84705    0.13130  14.06693   &lt;2e-16 ***
# X2c:X3      -2.11044    0.11910 -17.72024   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 7740.111 7740.334 7789.189
# ---
# Log-Likelihood
#      -3860.056
# ---
# Lambda:  0.08479587 std.err:  0.01901557


# Model fitting with a polynomial effect;

a8 &lt;- -0.5

mu &lt;- mu*exp(a8*X3^2)

Y &lt;- rnbinom(n, size = 1, mu = mu)

data$Y &lt;- Y

NB_mod &lt;- nbRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star + X2*X3 + I(X3^2),
                        v_star = "V_star", data = data)

summary(NB_mod)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  0.96498    0.11201   8.61478   &lt;2e-16 ***
# X1           2.09647    0.09310  22.51926   &lt;2e-16 ***
# X2b         -0.02546    0.13341  -0.19082   0.8487
# X2c         -1.08524    0.12751  -8.51091   &lt;2e-16 ***
# X3           4.03397    0.11939  33.78945   &lt;2e-16 ***
# V_star       1.99765    0.09395  21.26217   &lt;2e-16 ***
# I(X3^2)     -0.49023    0.05312  -9.22849   &lt;2e-16 ***
# X2b:X3       2.00513    0.14127  14.19333   &lt;2e-16 ***
# X2c:X3      -1.93432    0.13657 -14.16309   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 7181.267 7181.535 7235.253
# ---
# Log-Likelihood
#      -3579.634
# ---
# Lambda:  0.1039235 std.err:  0.02154315



</code></pre>

<hr>
<h2 id='NormRegMisrepEM'>
Fit a Linear Regression Misrepresentation Model using EM Algorithm
</h2><span id='topic+NormRegMisrepEM'></span>

<h3>Description</h3>

<p><code>NormRegMisrepEM</code> is used to fit a Linear regression model, adjusting for misrepresentation on a binary predictor. The function uses the Expectation Maximization algorithm and allows multiple additional correctly measured independent variables in the Normal regression with an identity link function that is typically used in insurance claims modeling. Standard errors of model estimates are obtained from closed form expressions of the Observed Fisher Information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NormRegMisrepEM(formula, v_star, data, lambda = c(0.6,0.4),
                 epsilon = 1e-08, maxit = 10000,
                 maxrestarts = 20, verb = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NormRegMisrepEM_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under ‘Details’.</p>
</td></tr>
<tr><td><code id="NormRegMisrepEM_+3A_v_star">v_star</code></td>
<td>
<p>a character specifying the name of the binary predictor that is suspected of being misrepresented.</p>
</td></tr>
<tr><td><code id="NormRegMisrepEM_+3A_data">data</code></td>
<td>
<p>a dataframe containing the variables in the model.</p>
</td></tr>
<tr><td><code id="NormRegMisrepEM_+3A_lambda">lambda</code></td>
<td>
<p>initial mixing proportions used to start the EM algorithm. A numeric vector of length two, with the second element being the prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code id="NormRegMisrepEM_+3A_epsilon">epsilon</code></td>
<td>
<p>tolerance for convergence. Convergence is reached when the log-likelihood increases by less than epsilon.</p>
</td></tr>
<tr><td><code id="NormRegMisrepEM_+3A_maxit">maxit</code></td>
<td>
<p>the maximum number of iterations the EM routine will run for.</p>
</td></tr>
<tr><td><code id="NormRegMisrepEM_+3A_maxrestarts">maxrestarts</code></td>
<td>
<p>how many times the EM routine will attempt to converge. When conergence is not achieved, the EM routine restarts with new randomly selected mixing proportions.</p>
</td></tr>
<tr><td><code id="NormRegMisrepEM_+3A_verb">verb</code></td>
<td>
<p>logical. If TRUE, the difference in new .vs. old log-likelihood and the current log-likelihood is printed to the console after every iteration. If TRUE, the user will also be notifed if the EM algorithm must restart with new mixing proportions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models for <code>NormRegMisrepEM</code> are specified symbolically. Like the <code>lm</code> and <code>glm</code> functions, the model has the form <code>response ~ terms</code>, where <code>response</code> is the numeric response vector and <code>terms</code> is a series of terms which specifies a linear predictor for <code>response</code>.
</p>
<p>Currently, formula specification can accommodate the following expressions:
</p>

<ul>
<li><p>transformations of the response: <code>log(y) ~ x</code>
</p>
</li>
<li><p>polynomial terms: <code>y ~ x + I(x^2)</code>
</p>
</li>
<li><p>interactions: <code>y ~ x*z</code>
</p>
</li></ul>

<p>Including an offset term (e.g. <code>y ~ x + offset()</code>) is currently not supported.
</p>


<h3>Value</h3>

<p><code>NormRegMisrepEM</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"misrepEM"</code>.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the results.
</p>
<p>An object of class <code>"misrepEM"</code> is a list containing the following 14 elements:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>the response used.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>numeric. The estimated prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>a numeric vector containing the estimated parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the final maximized log-likelihood.</p>
</td></tr>
<tr><td><code>posterior</code></td>
<td>
<p>a numeric vector. The posterior probability that the <em>i-th</em> observation is not misrepresented for observations where the suspected misrepresented variable is zero, based on the last iteration of the EM algorithm. The values are not meaningful for observations where the suspected misrepresented variable is one.</p>
</td></tr>
<tr><td><code>all.loglik</code></td>
<td>
<p>a numeric vector containing the log-likelihood at every iteration.</p>
</td></tr>
<tr><td><code>cov.estimates</code></td>
<td>
<p>the inverse of the observed fisher information matrix evaluated at the maximum likelihood estimates.</p>
</td></tr>
<tr><td><code>std.error</code></td>
<td>
<p>a numeric vector containing the standard errors of regression coefficients.</p>
</td></tr>
<tr><td><code>t.values</code></td>
<td>
<p>a numeric vector containing the standardized regression coefficients.</p>
</td></tr>
<tr><td><code>p.values</code></td>
<td>
<p>a numeric vector containing the <em>p-</em>values of the regression coefficients.</p>
</td></tr>
<tr><td><code>ICs</code></td>
<td>
<p>a numeric vector of length three containing the AIC, AICc, and BIC.</p>
</td></tr>
<tr><td><code>ft</code></td>
<td>
<p>a character containing the name of the function.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> indicating the model that was fit.</p>
</td></tr>
<tr><td><code>v_star_name</code></td>
<td>
<p>a character containing the name of the binary predictor suspected of misrepresentation.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Xia, Michelle, Rexford Akakpo, and Matthew Albaugh. &quot;Maximum Likelihood Approaches to Misrepresentation Models in GLM ratemaking: Model Comparisons.&quot; <em>Variance</em> 16.1 (2023).
</p>
<p>Akakpo, R. M., Xia, M., &amp; Polansky, A. M. (2019). Frequentist inference in insurance ratemaking models adjusting for misrepresentation. <em>ASTIN Bulletin: The Journal of the IAA, 49</em>(1), 117-146.
</p>
<p>Xia, M., Hua, L., &amp; Vadnais, G. (2018). Embedded predictive analysis of misrepresentation risk in GLM ratemaking models. <em>Variance, 12</em>(1), 39-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
n &lt;- 1000
p0 &lt;- 0.25

X1 &lt;- rbinom(n, 1, 0.4)
X2 &lt;- sample(x = c("a", "b", "c"), size = n, replace = TRUE)
X3 &lt;- rnorm(n, 0, 1)

theta0 &lt;- 0.3
V &lt;- rbinom(n,1,theta0)
V_star &lt;- V
V_star[V==1] &lt;- rbinom(sum(V==1),1,1-p0)

a0 &lt;- 1
a1 &lt;- 2
a2 &lt;- 0
a3 &lt;- -1
a4 &lt;- 4
a5 &lt;- 2

mu &lt;- rep(0, n)

for(i in 1:n){

  mu[i] &lt;- (a0 + a1*X1 + a4*X3 + a5*V )[i]

  if(X2[i] == "a" || X2[i] == "b"){

    mu[i] &lt;- mu[i] + a2

  }else{
    mu[i] &lt;- mu[i] + a3
  }

}

sigma &lt;- 0.427

Y &lt;- rnorm(n, mu, sigma)

data &lt;- data.frame(Y = Y, X1 = X1, X2 = X2, X3 = X3, V_star = V_star)

# "a" is the reference
data$X2 &lt;- as.factor(data$X2)

# Model with main effects:
norm_lm &lt;- NormRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star,
                              v_star = "V_star", data = data)

# The prevalence of misrepresentation;
(theta0 * p0) / (1 - theta0*(1-p0)) # 0.09677419

# Parameter estimates and estimated prevalence of
# misrepresentation (lambda);
summary(norm_lm)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  1.00624    0.02834  35.50820   &lt;2e-16 ***
# X1           1.95903    0.02825  69.35263   &lt;2e-16 ***
# X2b          0.04106    0.03413   1.20301  0.22926
# X2c         -1.00367    0.03418 -29.36328   &lt;2e-16 ***
# X3           4.00031    0.01366 292.75308   &lt;2e-16 ***
# V_star       2.01422    0.02922  68.93901   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 1674.683 1674.828 1713.945
# ---
# Log-Likelihood
#      -829.3415
# ---
# Lambda:  0.11085 std.err:  0.01150365

# Fitting an interaction between X2 and X3;

a6 &lt;- -2
a7 &lt;- 2

for(i in 1:n){

  if(X2[i] == "c"){
    mu[i] &lt;- mu[i] + a6*X3[i]
  }else{
    if(X2[i] =="b"){
      mu[i] &lt;- mu[i] + a7*X3[i]
    }
  }
}

Y &lt;- rnorm(n, mu, sigma)

data$Y &lt;- Y

norm_lm &lt;- NormRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star + X2*X3,
                              v_star = "V_star", data = data)

summary(norm_lm)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  0.94905    0.02866  33.11281   &lt;2e-16 ***
# X1           2.04258    0.02876  71.02223   &lt;2e-16 ***
# X2b          0.00204    0.03463   0.05880  0.95313
# X2c         -0.97738    0.03469 -28.17313   &lt;2e-16 ***
# X3           3.97014    0.02341 169.61108   &lt;2e-16 ***
# V_star       2.01894    0.02967  68.04780   &lt;2e-16 ***
# X2b:X3       2.00436    0.03459  57.95430   &lt;2e-16 ***
# X2c:X3      -1.97573    0.03431 -57.59168   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 1668.925 1669.148 1718.003
# ---
# Log-Likelihood
#      -824.4626
# ---
# Lambda:  0.1055629 std.err:  0.01134299

# Model fitting with a polynomial effect;

a8 &lt;- -0.5

mu &lt;- mu + a8*X3^2

Y &lt;- rnorm(n, mu, sigma)

data$Y &lt;- Y

norm_lm &lt;- NormRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star + X2*X3 + I(X3^2),
                              v_star = "V_star", data = data)

summary(norm_lm)

# Coefficients:
#             Estimate Std. Error   t value Pr(&gt;|t|)
# (Intercept)  0.95426    0.03050  31.28435   &lt;2e-16 ***
# X1           2.00070    0.02878  69.52668   &lt;2e-16 ***
# X2b          0.09309    0.03480   2.67463   0.0076  **
# X2c         -0.96572    0.03455 -27.95529   &lt;2e-16 ***
# X3           3.96765    0.02378 166.82865   &lt;2e-16 ***
# V_star       2.00513    0.02967  67.58481   &lt;2e-16 ***
# I(X3^2)     -0.49043    0.00983 -49.90057   &lt;2e-16 ***
# X2b:X3       2.04613    0.03454  59.24406   &lt;2e-16 ***
# X2c:X3      -1.97248    0.03383 -58.30381   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 1672.933 1673.200 1726.918
# ---
# Log-Likelihood
#      -825.4665
# ---
# Lambda:  0.1061873 std.err:  0.01138759

</code></pre>

<hr>
<h2 id='poisRegMisrepEM'>
Fit a Poisson Misrepresentation Model using EM Algorithm
</h2><span id='topic+poisRegMisrepEM'></span>

<h3>Description</h3>

<p><code>poisRegMisrepEM</code> is used to fit a Poisson regression model, adjusting for misrepresentation on a binary predictor. The function uses the Expectation Maximization algorithm and allows multiple additional correctly measured independent variables in the Poisson regression with a log-link function that is typically used in insurance claims modeling. Standard errors of model estimates are obtained from closed form expressions of the Observed Fisher Information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisRegMisrepEM(formula, v_star, data, lambda = c(0.6,0.4),
                 epsilon = 1e-08, maxit = 10000,
                 maxrestarts = 20, verb = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisRegMisrepEM_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under ‘Details’.</p>
</td></tr>
<tr><td><code id="poisRegMisrepEM_+3A_v_star">v_star</code></td>
<td>
<p>a character specifying the name of the binary predictor that is suspected of being misrepresented.</p>
</td></tr>
<tr><td><code id="poisRegMisrepEM_+3A_data">data</code></td>
<td>
<p>a dataframe containing the variables in the model.</p>
</td></tr>
<tr><td><code id="poisRegMisrepEM_+3A_lambda">lambda</code></td>
<td>
<p>initial mixing proportions used to start the EM algorithm. A numeric vector of length two, with the second element being the prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code id="poisRegMisrepEM_+3A_epsilon">epsilon</code></td>
<td>
<p>tolerance for convergence. Convergence is reached when the log-likelihood increases by less than epsilon.</p>
</td></tr>
<tr><td><code id="poisRegMisrepEM_+3A_maxit">maxit</code></td>
<td>
<p>the maximum number of iterations the EM routine will run for.</p>
</td></tr>
<tr><td><code id="poisRegMisrepEM_+3A_maxrestarts">maxrestarts</code></td>
<td>
<p>how many times the EM routine will attempt to converge. When conergence is not achieved, the EM routine restarts with new randomly selected mixing proportions.</p>
</td></tr>
<tr><td><code id="poisRegMisrepEM_+3A_verb">verb</code></td>
<td>
<p>logical. If TRUE, the difference in new .vs. old log-likelihood and the current log-likelihood is printed to the console after every iteration. If TRUE, the user will also be notifed if the EM algorithm must restart with new mixing proportions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models for <code>poisRegMisrepEM</code> are specified symbolically. Like the <code>lm</code> and <code>glm</code> functions, the model has the form <code>response ~ terms</code>, where <code>response</code> is the numeric response vector and <code>terms</code> is a series of terms which specifies a linear predictor for <code>response</code>.
</p>
<p>Currently, formula specification can accommodate the following expressions:
</p>

<ul>
<li><p>transformations of the response: <code>log(y) ~ x</code>
</p>
</li>
<li><p>polynomial terms: <code>y ~ x + I(x^2)</code>
</p>
</li>
<li><p>interactions: <code>y ~ x*z</code>
</p>
</li></ul>

<p>Including an offset term (e.g. <code>y ~ x + offset()</code>) is currently not supported.
</p>


<h3>Value</h3>

<p><code>poisRegMisrepEM</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"misrepEM"</code>.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the results.
</p>
<p>An object of class <code>"misrepEM"</code> is a list containing the following 14 elements:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>the response used.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>numeric. The estimated prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>a numeric vector containing the estimated parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the final maximized log-likelihood.</p>
</td></tr>
<tr><td><code>posterior</code></td>
<td>
<p>a numeric vector. The posterior probability that the <em>i-th</em> observation is not misrepresented for observations where the suspected misrepresented variable is zero, based on the last iteration of the EM algorithm. The values are not meaningful for observations where the suspected misrepresented variable is one.</p>
</td></tr>
<tr><td><code>all.loglik</code></td>
<td>
<p>a numeric vector containing the log-likelihood at every iteration.</p>
</td></tr>
<tr><td><code>cov.estimates</code></td>
<td>
<p>the inverse of the observed fisher information matrix evaluated at the maximum likelihood estimates.</p>
</td></tr>
<tr><td><code>std.error</code></td>
<td>
<p>a numeric vector containing the standard errors of regression coefficients.</p>
</td></tr>
<tr><td><code>z.values</code></td>
<td>
<p>a numeric vector containing the standardized regression coefficients.</p>
</td></tr>
<tr><td><code>p.values</code></td>
<td>
<p>a numeric vector containing the <em>p-</em>values of the regression coefficients.</p>
</td></tr>
<tr><td><code>ICs</code></td>
<td>
<p>a numeric vector of length three containing the AIC, AICc, and BIC.</p>
</td></tr>
<tr><td><code>ft</code></td>
<td>
<p>a character containing the name of the function.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> indicating the model that was fit.</p>
</td></tr>
<tr><td><code>v_star_name</code></td>
<td>
<p>a character containing the name of the binary predictor suspected of misrepresentation.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Xia, Michelle, Rexford Akakpo, and Matthew Albaugh. &quot;Maximum Likelihood Approaches to Misrepresentation Models in GLM ratemaking: Model Comparisons.&quot; <em>Variance</em> 16.1 (2023).
</p>
<p>Akakpo, R. M., Xia, M., &amp; Polansky, A. M. (2019). Frequentist inference in insurance ratemaking models adjusting for misrepresentation. <em>ASTIN Bulletin: The Journal of the IAA, 49</em>(1), 117-146.
</p>
<p>Xia, M., Hua, L., &amp; Vadnais, G. (2018). Embedded predictive analysis of misrepresentation risk in GLM ratemaking models. <em>Variance, 12</em>(1), 39-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(314159)

# Simulate data
n &lt;- 1000
p0 &lt;- 0.25

X1 &lt;- rbinom(n, 1, 0.4)
X2 &lt;- sample(x = c("a", "b", "c"), size = n, replace = TRUE)
X3 &lt;- rnorm(n, 0, 1)

theta0 &lt;- 0.3
V &lt;- rbinom(n,1,theta0)
V_star &lt;- V
V_star[V==1] &lt;- rbinom(sum(V==1),1,1-p0)

a0 &lt;- 1
a1 &lt;- 0.5
a2 &lt;- 0
a3 &lt;- -1
a4 &lt;- 2
a5 &lt;- 1

mu &lt;- rep(0, n)

for(i in 1:n){

  mu[i] &lt;- exp(a0 + a1*X1 + a4*X3 + a5*V )[i]

  if(X2[i] == "a" || X2[i] == "b"){

    mu[i] &lt;- mu[i]*exp(a2)

  }else{
    mu[i] &lt;- mu[i]*exp(a3)
  }

}

Y &lt;- rpois(n, mu)

data &lt;- data.frame(Y = Y, X1 = X1, X2 = X2, X3 = X3, V_star = V_star)

# "a" is the reference
data$X2 &lt;- as.factor(data$X2)

# Model with main effects:
pois_mod &lt;- poisRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star,
                            v_star = "V_star", data = data)

# The prevalence of misrepresentation;
(theta0 * p0) / (1 - theta0*(1-p0)) # 0.09677419

# Parameter estimates and estimated prevalence of
# misrepresentation (lambda);
summary(pois_mod)

# Coefficients:
#             Estimate Std. Error   z value Pr(&gt;|z|)
# (Intercept)  1.03519    0.02238  46.25615   &lt;2e-16 ***
# X1           0.49875    0.01297  38.45157   &lt;2e-16 ***
# X2b         -0.00007    0.01324  -0.00500  0.99601
# X2c         -0.98438    0.01926 -51.10084   &lt;2e-16 ***
# X3           1.97794    0.00878 225.20267   &lt;2e-16 ***
# V_star       0.99484    0.01290  77.14885   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 4170.836 4170.949 4205.190
# ---
# Log-Likelihood
#      -2078.418
# ---
# Lambda:  0.1039615 std.err:  0.01613403

# Fitting an interaction between X2 and X3;

a6 &lt;- -0.5
a7 &lt;- -0.5

for(i in 1:n){

  if(X2[i] == "c"){
    mu[i] &lt;- mu[i]*exp(a6*X3[i])
  }else{
    if(X2[i] =="b"){
      mu[i] &lt;- mu[i]*exp(a7*X3[i])
    }
  }
}

Y &lt;- rpois(n, mu)

data$Y &lt;- Y

pois_mod &lt;- poisRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star + X2*X3,
                            v_star = "V_star", data = data)

summary(pois_mod)

# Coefficients:
#             Estimate Std. Error   z value Pr(&gt;|z|)
# (Intercept)  0.98723    0.02917  33.84255   &lt;2e-16 ***
# X1           0.50135    0.01540  32.56094   &lt;2e-16 ***
# X2b         -0.03643    0.03655  -0.99648  0.31902
# X2c         -1.02315    0.05170 -19.79103   &lt;2e-16 ***
# X3           1.99527    0.01319 151.22592   &lt;2e-16 ***
# V_star       1.00917    0.01531  65.93335   &lt;2e-16 ***
# X2b:X3      -0.47260    0.02137 -22.11569   &lt;2e-16 ***
# X2c:X3      -0.49639    0.03018 -16.44530   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 4096.533 4096.714 4140.702
# ---
# Log-Likelihood
#      -2039.266
# ---
# Lambda:  0.1072814 std.err:  0.0162925

# Model fitting with a polynomial effect;

a8 &lt;- -1

mu &lt;- mu*exp(a8*X3^2)

Y &lt;- rpois(n, mu)

data$Y &lt;- Y

pois_mod &lt;- poisRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star + X2*X3 + I(X3^2),
                            v_star = "V_star", data = data)

summary(pois_mod)

# Coefficients:
#             Estimate Std. Error   z value Pr(&gt;|z|)
# (Intercept)  1.03291    0.04647  22.22701   &lt;2e-16 ***
# X1           0.43783    0.03453  12.68058   &lt;2e-16 ***
# X2b         -0.08042    0.05600  -1.43609  0.15098
# X2c         -1.02676    0.07523 -13.64912   &lt;2e-16 ***
# X3           2.03183    0.06317  32.16597   &lt;2e-16 ***
# V_star       0.98563    0.03415  28.86175   &lt;2e-16 ***
# I(X3^2)     -0.99795    0.03529 -28.27715   &lt;2e-16 ***
# X2b:X3      -0.45828    0.06499  -7.05189   &lt;2e-16 ***
# X2c:X3      -0.47648    0.08912  -5.34623   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 3269.698 3269.920 3318.775
# ---
# Log-Likelihood
#      -1624.849
# ---
# Lambda:  0.108672 std.err:  0.02181499


</code></pre>

<hr>
<h2 id='predict.misrepEM'>
Predict method for 'misrepEM' Model Fits
</h2><span id='topic+predict.misrepEM'></span>

<h3>Description</h3>

<p>Predicted values based on a fitted 'misrepEM' model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'misrepEM'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.misrepEM_+3A_object">object</code></td>
<td>
<p>a fit from one of <code>gammaRegMisrepEM</code>, <code>LnRegMisrepEM</code>, <code>NormRegMisrepEM</code>, <code>nbRegMisrepEM</code>, or <code>poisRegMisrepEM</code>.</p>
</td></tr>
<tr><td><code id="predict.misrepEM_+3A_newdata">newdata</code></td>
<td>
<p>a data frame containing predictors that are to be used to make predictions of the response. </p>
</td></tr>
<tr><td><code id="predict.misrepEM_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, only predictions made on the scale of the response variable are supported.
</p>
<p>Incomplete cases are automatically dropped, and predictions are made only on complete cases.
</p>


<h3>Value</h3>

<p><code>predict.misrepEM</code> returns a numeric vector of predictions.
</p>


<h3>References</h3>

<p>Xia, Michelle, Rexford Akakpo, and Matthew Albaugh. &quot;Maximum Likelihood Approaches to Misrepresentation Models in GLM ratemaking: Model Comparisons.&quot; <em>Variance</em> 16.1 (2023).
</p>
<p>Akakpo, R. M., Xia, M., &amp; Polansky, A. M. (2019). Frequentist inference in insurance ratemaking models adjusting for misrepresentation. <em>ASTIN Bulletin: The Journal of the IAA, 49</em>(1), 117-146.
</p>
<p>Xia, M., Hua, L., &amp; Vadnais, G. (2018). Embedded predictive analysis of misrepresentation risk in GLM ratemaking models. <em>Variance, 12</em>(1), 39-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
n &lt;- 2000
p0 &lt;- 0.25

X1 &lt;- rbinom(n, 1, 0.4)
X2 &lt;- rnorm(n, 0, 1)
X3 &lt;- rbeta(n, 2, 1)

theta0 &lt;- 0.3
V &lt;- rbinom(n,1,theta0)
V_star &lt;- V
V_star[V==1] &lt;- rbinom(sum(V==1),1,1-p0)

a0 &lt;- 1
a1 &lt;- 2
a2 &lt;- 0
a3 &lt;- 4
a4 &lt;- 2

mu &lt;- exp(a0 + a1*X1 + a2*X2 + a3*X3 + a4*V)

phi &lt;- 0.2
alpha0 &lt;- 1/phi
beta &lt;- 1/mu/phi
Y &lt;- rgamma(n, alpha0, beta)

data &lt;- data.frame(Y = Y, X1 = X1, X2 = X2, X3 = X3, V_star = V_star)

# Split data into training and testing sets
train &lt;- data[1:1800,]
test  &lt;- data[1801:2000,]

gamma_fit &lt;- gammaRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star,
                              v_star = "V_star", data = train)

# Predict on test set;
preds &lt;- predict(gamma_fit, newdata = test)

</code></pre>

<hr>
<h2 id='summary.misrepEM'>
Summarize a 'misrepEM' Model Fit
</h2><span id='topic+summary.misrepEM'></span><span id='topic+print.summary.misrepEM'></span>

<h3>Description</h3>

<p><code>summary</code> method for class 'misrepEM'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'misrepEM'
summary(object, ...)

## S3 method for class 'summary.misrepEM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.misrepEM_+3A_object">object</code></td>
<td>

<p>an object of class &quot;<code>misrepEM</code>&quot;, usually resulting from a call to one of <code><a href="#topic+gammaRegMisrepEM">gammaRegMisrepEM</a></code>, <code><a href="#topic+LnRegMisrepEM">LnRegMisrepEM</a></code>, <code><a href="#topic+NormRegMisrepEM">NormRegMisrepEM</a></code>, <code><a href="#topic+nbRegMisrepEM">nbRegMisrepEM</a></code> or <code><a href="#topic+poisRegMisrepEM">poisRegMisrepEM</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.misrepEM_+3A_x">x</code></td>
<td>

<p>an object of class &quot;<code>summary.misrepEM</code>&quot;, usually resulting from a call to <code>summary.misrepEM</code>.
</p>
</td></tr>
<tr><td><code id="summary.misrepEM_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.misrepEM</code> returns an object of class <code>"summary.misrepEM"</code>, a list of length 5 with the following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a <code>data.frame</code> of coefficients, standard errors, standardized coefficients, two-tailed p-values corresponding to the standardized coefficient based on a Student-t or Normal reference distribution, and 'significance stars.'</p>
</td></tr>
<tr><td><code>ICs</code></td>
<td>
<p>a named numeric vector of length three, containing the Akaike Information Criterion (AIC), the corrected AIC (AICc) and the Bayesian Information Criterion (BIC).</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>numeric. The log-likelihood of the fitted <code>misrepEM</code> model.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>numeric. The estimated prevalence of misrepresentation.</p>
</td></tr>
<tr><td><code>lambda_stderror</code></td>
<td>
<p>numeric. The standard error of the estimated prevalence of misrepresentation.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Xia, Michelle, Rexford Akakpo, and Matthew Albaugh. &quot;Maximum Likelihood Approaches to Misrepresentation Models in GLM ratemaking: Model Comparisons.&quot; <em>Variance</em> 16.1 (2023).
</p>
<p>Akakpo, R. M., Xia, M., &amp; Polansky, A. M. (2019). Frequentist inference in insurance ratemaking models adjusting for misrepresentation. <em>ASTIN Bulletin: The Journal of the IAA, 49</em>(1), 117-146.
</p>
<p>Xia, M., Hua, L., &amp; Vadnais, G. (2018). Embedded predictive analysis of misrepresentation risk in GLM ratemaking models. <em>Variance, 12</em>(1), 39-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
n &lt;- 2000
p0 &lt;- 0.25

X1 &lt;- rbinom(n, 1, 0.4)
X2 &lt;- rnorm(n, 0, 1)
X3 &lt;- rbeta(n, 2, 1)

theta0 &lt;- 0.3
V &lt;- rbinom(n,1,theta0)
V_star &lt;- V
V_star[V==1] &lt;- rbinom(sum(V==1),1,1-p0)

a0 &lt;- 1
a1 &lt;- 2
a2 &lt;- 0
a3 &lt;- 4
a4 &lt;- 2

mu &lt;- exp(a0 + a1*X1 + a2*X2 + a3*X3 + a4*V)

phi &lt;- 0.2
alpha0 &lt;- 1/phi
beta &lt;- 1/mu/phi
Y &lt;- rgamma(n, alpha0, beta)

data &lt;- data.frame(Y = Y, X1 = X1, X2 = X2, X3 = X3, V_star = V_star)

gamma_fit &lt;- gammaRegMisrepEM(formula = Y ~ X1 + X2 + X3 + V_star,
                              v_star = "V_star", data = data)

summary(gamma_fit)

# Coefficients:
#             Estimate Std. Error  t value Pr(&gt;|t|)
# (Intercept)  1.00137    0.03413 29.33857   &lt;2e-16 ***
# X1           2.01388    0.02154 93.48440   &lt;2e-16 ***
# X2          -0.00193    0.01038 -0.18589  0.85255
# X3           4.00101    0.04560 87.74528   &lt;2e-16 ***
# V_star       2.00567    0.02240 89.54515   &lt;2e-16 ***
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# ---
#      AIC     AICc      BIC
# 23362.50 23362.56 23401.71
# ---
# Log-Likelihood
#      -11674.25
# ---
# Lambda:  0.09635239 std.err:  0.007641834

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
