<!DOCTYPE html><html lang="en"><head><title>Help for package optedr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {optedr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_design'><p>Add two designs</p></a></li>
<li><a href='#add_points'><p>Update design given crosspoints and alpha</p></a></li>
<li><a href='#augment_design'><p>Augment Design</p></a></li>
<li><a href='#check_inputs'><p>Check Inputs</p></a></li>
<li><a href='#combinatorial_round'><p>Combinatorial round</p></a></li>
<li><a href='#crit'><p>Master function for the criterion function</p></a></li>
<li><a href='#crosspoints'><p>Calculate crosspoints</p></a></li>
<li><a href='#daugment_design'><p>D-Augment Design</p></a></li>
<li><a href='#dcrit'><p>Criterion function for D-Optimality</p></a></li>
<li><a href='#delete_points'><p>Remove low weight points</p></a></li>
<li><a href='#design_efficiency'><p>Efficiency between optimal design and a user given design</p></a></li>
<li><a href='#dsaugment_design'><p>Ds-Augment Design</p></a></li>
<li><a href='#dscrit'><p>Criterion function for Ds-Optimality</p></a></li>
<li><a href='#dsens'><p>Sensitivity function for D-Optimality</p></a></li>
<li><a href='#dssens'><p>Sensitivity function for Ds-Optimality</p></a></li>
<li><a href='#DsWFMult'><p>Cocktail Algorithm implementation for Ds-Optimality</p></a></li>
<li><a href='#DWFMult'><p>Cocktail Algorithm implementation for D-Optimality</p></a></li>
<li><a href='#eff'><p>Efficiency between two Information Matrices</p></a></li>
<li><a href='#efficient_round'><p>Efficient Round</p></a></li>
<li><a href='#findmax'><p>Find Maximum</p></a></li>
<li><a href='#findmaxval'><p>Find Maximum Value</p></a></li>
<li><a href='#findminval'><p>Find Minimum Value</p></a></li>
<li><a href='#get_augment_region'><p>Get Augment Regions</p></a></li>
<li><a href='#get_daugment_region'><p>Get D-augment region</p></a></li>
<li><a href='#get_dsaugment_region'><p>Get Ds-augment region</p></a></li>
<li><a href='#get_laugment_region'><p>Get L-augment region</p></a></li>
<li><a href='#getCross2'><p>Give effective limits to candidate points region</p></a></li>
<li><a href='#getPar'><p>Parity of the crosspoints</p></a></li>
<li><a href='#getStart'><p>Find where the candidate points region starts</p></a></li>
<li><a href='#gradient'><p>Gradient function</p></a></li>
<li><a href='#gradient22'><p>Gradient function for a subset of variables</p></a></li>
<li><a href='#icrit'><p>Criterion function for I-Optimality and L-Optimality</p></a></li>
<li><a href='#inf_mat'><p>Information Matrix</p></a></li>
<li><a href='#integrate_reg_int'><p>Integrate IM</p></a></li>
<li><a href='#isens'><p>Sensitivity function for I-Optimality</p></a></li>
<li><a href='#IWFMult'><p>Cocktail Algorithm implementation for L-, I- and A-Optimality (with matB = diag(k))</p></a></li>
<li><a href='#laugment_design'><p>L-Augment Design</p></a></li>
<li><a href='#opt_des'><p>Calculates the optimal design for a specified criterion</p></a></li>
<li><a href='#plot_convergence'><p>Plot Convergence of the algorithm</p></a></li>
<li><a href='#plot_sens'><p>Plot sensitivity function</p></a></li>
<li><a href='#plot.optdes'><p>Plot function for optdes</p></a></li>
<li><a href='#print.optdes'><p>Print function for optdes</p></a></li>
<li><a href='#sens'><p>Master function to calculate the sensitivity function</p></a></li>
<li><a href='#shiny_augment'><p>Shiny D-augment</p></a></li>
<li><a href='#shiny_optimal'><p>Shiny Optimal</p></a></li>
<li><a href='#summary.optdes'><p>Summary function for optdes</p></a></li>
<li><a href='#tr'><p>Trace</p></a></li>
<li><a href='#update_design'><p>Update Design with new point</p></a></li>
<li><a href='#update_design_total'><p>Merge close points of a design</p></a></li>
<li><a href='#update_sequence'><p>Deletes duplicates points</p></a></li>
<li><a href='#update_weights'><p>Update weight D-Optimality</p></a></li>
<li><a href='#update_weightsDS'><p>Update weight Ds-Optimality</p></a></li>
<li><a href='#update_weightsI'><p>Update weight I-Optimality</p></a></li>
<li><a href='#weight_function'><p>Weight function per distribution</p></a></li>
<li><a href='#WFMult'><p>Master function for the cocktail algorithm, that calls the appropriate one given the criterion.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Calculating Optimal and D-Augmented Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates D-, Ds-, A-, I- and L-optimal designs for non-linear models, via an implementation of the cocktail algorithm (Yu, 2011, &lt;<a href="https://doi.org/10.1007%2Fs11222-010-9183-2">doi:10.1007/s11222-010-9183-2</a>&gt;). Compares designs via their efficiency, and augments any design with a controlled efficiency. An efficient rounding function has been provided to transform approximate designs to exact designs.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kezrael/optedr">https://github.com/kezrael/optedr</a>,
<a href="https://github.com/Kezrael/optedr">https://github.com/Kezrael/optedr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Kezrael/optedr/issues">https://github.com/Kezrael/optedr/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), mockery, markdown, DT, shinydashboard,
shinyalert, plotly, hrbrthemes, shinyjs, orthopolynom,
magrittr, tidyverse</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, purrr, rlang, crayon, cli, dplyr, nleqslv, shiny,
utils</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-11 10:09:47 UTC; Carlos</td>
</tr>
<tr>
<td>Author:</td>
<td>Carlos de la Calle-Arroyo
    <a href="https://orcid.org/0000-0002-5099-888X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Jesús López-Fidalgo
    <a href="https://orcid.org/0000-0001-7502-8188"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Licesio J. Rodríguez-Aragón
    <a href="https://orcid.org/0000-0003-4970-3877"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carlos de la Calle-Arroyo &lt;carlos.calle.arroyo@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-11 10:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_design'>Add two designs</h2><span id='topic+add_design'></span>

<h3>Description</h3>

<p>Add two designs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_design(design_1, design_2, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_design_+3A_design_1">design_1</code></td>
<td>
<p>A dataframe with 'Point' and 'Weight' as columns that represent the first design to add</p>
</td></tr>
<tr><td><code id="add_design_+3A_design_2">design_2</code></td>
<td>
<p>A dataframe with 'Point' and 'Weight' as columns that represent the second design to add</p>
</td></tr>
<tr><td><code id="add_design_+3A_alpha">alpha</code></td>
<td>
<p>Weight of the first design</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A design as a dataframe with the weighted addition of the two designs
</p>

<hr>
<h2 id='add_points'>Update design given crosspoints and alpha</h2><span id='topic+add_points'></span>

<h3>Description</h3>

<p>Given a set of points, a weight and the design, the function adds these points
to the new design with uniform weight, and combined weight alpha
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_points(points, alpha, design)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_points_+3A_points">points</code></td>
<td>
<p>Points to be added to the design</p>
</td></tr>
<tr><td><code id="add_points_+3A_alpha">alpha</code></td>
<td>
<p>Combined weight of the new points to be added to the design</p>
</td></tr>
<tr><td><code id="add_points_+3A_design">design</code></td>
<td>
<p>A design as a dataframe with &quot;Point&quot; and &quot;Weight&quot; columns</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A design as a dataframe with &quot;Point&quot; and &quot;Weight&quot; columns that is the
addition of the design and the new points
</p>

<hr>
<h2 id='augment_design'>Augment Design</h2><span id='topic+augment_design'></span>

<h3>Description</h3>

<p>Augments a design. The user gives an initial design for which he would like to add points
and specifies the weight of the new points. Then he is prompted to choose a
minimum efficiency. After that, the candidate points region is calculated
and the user can choose the points and weights to add.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>augment_design(
  criterion,
  init_design,
  alpha,
  model,
  parameters,
  par_values,
  design_space,
  calc_optimal_design,
  par_int = NA,
  matB = NULL,
  distribution = NA,
  weight_fun = function(x) 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="augment_design_+3A_criterion">criterion</code></td>
<td>
<p>character variable with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
<tr><td><code id="augment_design_+3A_init_design">init_design</code></td>
<td>
<p>dataframe with &quot;Point&quot; and &quot;Weight&quot; columns that represents the initial design to augment</p>
</td></tr>
<tr><td><code id="augment_design_+3A_alpha">alpha</code></td>
<td>
<p>combined weight of the new points</p>
</td></tr>
<tr><td><code id="augment_design_+3A_model">model</code></td>
<td>
<p>formula that represents the model with x as the independent variable</p>
</td></tr>
<tr><td><code id="augment_design_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the unknown parameters of the model to estimate</p>
</td></tr>
<tr><td><code id="augment_design_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the initial values of the unknown parameters</p>
</td></tr>
<tr><td><code id="augment_design_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design</p>
</td></tr>
<tr><td><code id="augment_design_+3A_calc_optimal_design">calc_optimal_design</code></td>
<td>
<p>boolean parameter, if TRUE, the optimal design is calculated and efficiencies of the initial and augmented design are given</p>
</td></tr>
<tr><td><code id="augment_design_+3A_par_int">par_int</code></td>
<td>
<p>optional numeric vector with the index of the <code>parameters</code> of interest for Ds-optimality.</p>
</td></tr>
<tr><td><code id="augment_design_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for L-optimality.</p>
</td></tr>
<tr><td><code id="augment_design_+3A_distribution">distribution</code></td>
<td>
<p>character specifying the probability distribution of the response. Can be one of the following:
</p>

<ul>
<li><p> 'Homoscedasticity'
</p>
</li>
<li><p> 'Gamma', which can be used for exponential or normal heteroscedastic with constant relative error
</p>
</li>
<li><p> 'Poisson'
</p>
</li>
<li><p> 'Logistic'
</p>
</li>
<li><p> 'Log-Normal' (work in progress)
</p>
</li></ul>
</td></tr>
<tr><td><code id="augment_design_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe that represents the D-augmented design
</p>


<h3>Examples</h3>

<pre><code class='language-R'>init_des &lt;- data.frame("Point" = c(30, 60, 90), "Weight" = c(1/3, 1/3, 1/3))
augment_design("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), TRUE)
augment_design("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), FALSE)
</code></pre>

<hr>
<h2 id='check_inputs'>Check Inputs</h2><span id='topic+check_inputs'></span>

<h3>Description</h3>

<p>Function to check that the inputs given to the function <code>opt_des</code> are correct. If not, throws the
correspondent error message.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_inputs(
  criterion,
  model,
  parameters,
  par_values,
  design_space,
  init_design,
  join_thresh,
  delete_thresh,
  delta,
  tol,
  tol2,
  par_int,
  matB,
  reg_int,
  desired_output,
  weight_fun
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_inputs_+3A_criterion">criterion</code></td>
<td>
<p>character variable with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
<tr><td><code id="check_inputs_+3A_model">model</code></td>
<td>
<p>formula describing the model to calculate the optimal design. Must use x as the variable.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the parameters of the models, as written in the <code>formula</code>.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the parameters nominal values, in the same order as given in <code>parameters</code>.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_init_design">init_design</code></td>
<td>
<p>optional dataframe with the initial design for the algorithm. A dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="check_inputs_+3A_join_thresh">join_thresh</code></td>
<td>
<p>optional numeric value that states how close, in real units, two points must be in order to
be joined together by the join heuristic.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_delete_thresh">delete_thresh</code></td>
<td>
<p>optional numeric value with the minimum weight, over 1 total, that a point needs to have
in order to not be deleted from the design.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_delta">delta</code></td>
<td>
<p>optional numeric value in (0, 1), parameter of the algorithm.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_tol">tol</code></td>
<td>
<p>optional numeric value for the convergence of the weight optimizing algorithm.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_tol2">tol2</code></td>
<td>
<p>optional numeric value for the stop criterion: difference between maximum of sensitivity function
and optimality criterion.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_par_int">par_int</code></td>
<td>
<p>optional numeric vector with the index of the <code>parameters</code> of interest for Ds-optimality.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for L-optimality.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_reg_int">reg_int</code></td>
<td>
<p>optional numeric vector of two components with the bounds of the interest region for I-Optimality.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_desired_output">desired_output</code></td>
<td>
<p>not functional yet: decide which kind of output you want.</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response.</p>
</td></tr>
</table>

<hr>
<h2 id='combinatorial_round'>Combinatorial round</h2><span id='topic+combinatorial_round'></span>

<h3>Description</h3>

<p>Given an approximate design and a number of points, computes all the possible combinations of
roundings of each point to the nearest integer, keeps the ones that amount to the requested number of points,
and returns the one with the best value for the criterion function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combinatorial_round(
  design,
  n,
  criterion = NULL,
  model = NULL,
  parameters = NULL,
  par_values = NULL,
  weight_fun = function(x) 1,
  par_int = NULL,
  reg_int = NULL,
  matB = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combinatorial_round_+3A_design">design</code></td>
<td>
<p>either a dataframe with the design to round, or an object of class &quot;optdes&quot;. If the former,
the criterion, model and parameters must be specified. The dataframe should have two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="combinatorial_round_+3A_n">n</code></td>
<td>
<p>integer with the desired number of points of the resulting design.</p>
</td></tr>
<tr><td><code id="combinatorial_round_+3A_criterion">criterion</code></td>
<td>
<p>character variable with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
<tr><td><code id="combinatorial_round_+3A_model">model</code></td>
<td>
<p>formula describing the model. Must use x as the variable.</p>
</td></tr>
<tr><td><code id="combinatorial_round_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the parameters of the models, as written in the <code>formula</code>.</p>
</td></tr>
<tr><td><code id="combinatorial_round_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the parameters nominal values, in the same order as given in <code>parameters</code>.</p>
</td></tr>
<tr><td><code id="combinatorial_round_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response.</p>
</td></tr>
<tr><td><code id="combinatorial_round_+3A_par_int">par_int</code></td>
<td>
<p>optional numeric vector with the index of the <code>parameters</code> of interest for Ds-optimality.</p>
</td></tr>
<tr><td><code id="combinatorial_round_+3A_reg_int">reg_int</code></td>
<td>
<p>optional numeric vector with the ranges of integration, for I-optimality.</p>
</td></tr>
<tr><td><code id="combinatorial_round_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for L-optimality.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with the rounded design to n number of points
</p>


<h3>Examples</h3>

<pre><code class='language-R'>aprox_design &lt;- opt_des("D-Optimality", y ~ a * exp(-b / x), c("a", "b"), c(1, 1500), c(212, 422))
combinatorial_round(aprox_design, 27)
</code></pre>

<hr>
<h2 id='crit'>Master function for the criterion function</h2><span id='topic+crit'></span>

<h3>Description</h3>

<p>Depending on the criterion input, the function returns the output of the corresponding criterion function given
the information matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crit(criterion, M, k = 0, par_int = c(1), matB = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crit_+3A_criterion">criterion</code></td>
<td>
<p>character variable with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
<tr><td><code id="crit_+3A_m">M</code></td>
<td>
<p>information matrix for which the criterion value wants to be calculated.</p>
</td></tr>
<tr><td><code id="crit_+3A_k">k</code></td>
<td>
<p>numeric variable with the number of parameters of the model. Taken from the number of rows of the matrix if omitted.</p>
</td></tr>
<tr><td><code id="crit_+3A_par_int">par_int</code></td>
<td>
<p>numeric vector with the index of the parameters of interest of the model. Only for &quot;Ds-Optimality&quot;.</p>
</td></tr>
<tr><td><code id="crit_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for I- and L-optimality.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value of the optimality criterion for the information matrix.
</p>

<hr>
<h2 id='crosspoints'>Calculate crosspoints</h2><span id='topic+crosspoints'></span>

<h3>Description</h3>

<p>Given the parameters for augmenting a design, this function calculates the
crosspoints in the efficiency function that delimit the candidate points
region
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosspoints(val, sens, gridlength, tol, xmin, xmax)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crosspoints_+3A_val">val</code></td>
<td>
<p>Efficiency value to solve in the curve relationing the space of the design and efficiency of new design</p>
</td></tr>
<tr><td><code id="crosspoints_+3A_sens">sens</code></td>
<td>
<p>Sensitivity function of the design for the model</p>
</td></tr>
<tr><td><code id="crosspoints_+3A_gridlength">gridlength</code></td>
<td>
<p>Number of points in the grid to find the crosspoints</p>
</td></tr>
<tr><td><code id="crosspoints_+3A_tol">tol</code></td>
<td>
<p>Tolerance that establishes how close two points close to one another are considered the same</p>
</td></tr>
<tr><td><code id="crosspoints_+3A_xmin">xmin</code></td>
<td>
<p>Minimum of the space of the design</p>
</td></tr>
<tr><td><code id="crosspoints_+3A_xmax">xmax</code></td>
<td>
<p>Maximum of the space of the design</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of crosspoints that define the candidate points region
</p>

<hr>
<h2 id='daugment_design'>D-Augment Design</h2><span id='topic+daugment_design'></span>

<h3>Description</h3>

<p>D-Augments a design. The user gives an initial design for which he would like to add points
and specifies the weight of the new points. Then he is prompted to choose a
minimum efficiency. After that, the candidate points region is calculated
and the user can choose the points and weights to add.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daugment_design(
  init_design,
  alpha,
  model,
  parameters,
  par_values,
  design_space,
  calc_optimal_design,
  weight_fun = function(x) 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="daugment_design_+3A_init_design">init_design</code></td>
<td>
<p>dataframe with &quot;Point&quot; and &quot;Weight&quot; columns that represents the initial design to augment</p>
</td></tr>
<tr><td><code id="daugment_design_+3A_alpha">alpha</code></td>
<td>
<p>combined weight of the new points</p>
</td></tr>
<tr><td><code id="daugment_design_+3A_model">model</code></td>
<td>
<p>formula that represents the model with x as the independent variable</p>
</td></tr>
<tr><td><code id="daugment_design_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the unknown parameters of the model to estimate</p>
</td></tr>
<tr><td><code id="daugment_design_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the initial values of the unknown parameters</p>
</td></tr>
<tr><td><code id="daugment_design_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design</p>
</td></tr>
<tr><td><code id="daugment_design_+3A_calc_optimal_design">calc_optimal_design</code></td>
<td>
<p>boolean parameter, if TRUE, the optimal design is calculated and efficiencies of the initial and augmented design are given</p>
</td></tr>
<tr><td><code id="daugment_design_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe that represents the D-augmented design
</p>


<h3>See Also</h3>

<p>Other augment designs: 
<code><a href="#topic+dsaugment_design">dsaugment_design</a>()</code>,
<code><a href="#topic+laugment_design">laugment_design</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>init_des &lt;- data.frame("Point" = c(30, 60, 90), "Weight" = c(1/3, 1/3, 1/3))
augment_design("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), TRUE)
augment_design("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), FALSE)
</code></pre>

<hr>
<h2 id='dcrit'>Criterion function for D-Optimality</h2><span id='topic+dcrit'></span>

<h3>Description</h3>

<p>Calculates the value of the D-Optimality criterion function, which follows the expression:
</p>
<p style="text-align: center;"><code class="reqn">\phi_D = \left(\frac{1}{|M|}\right)^{1/k}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>dcrit(M, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dcrit_+3A_m">M</code></td>
<td>
<p>information matrix for which the criterion value wants to be calculated.</p>
</td></tr>
<tr><td><code id="dcrit_+3A_k">k</code></td>
<td>
<p>numeric variable with the number of parameters of the model. Taken from the number of rows of the matrix if omitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric value of the D-optimality criterion for the information matrix.
</p>

<hr>
<h2 id='delete_points'>Remove low weight points</h2><span id='topic+delete_points'></span>

<h3>Description</h3>

<p>Removes the points of a design with a weight lower than a threshold, <code>delta</code>, and distributes that weights
proportionally to the rest of the points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delete_points(design, delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="delete_points_+3A_design">design</code></td>
<td>
<p>The design from which to remove points as a dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="delete_points_+3A_delta">delta</code></td>
<td>
<p>The threshold from which the points with such a weight or lower will be removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The design without the removed points.
</p>

<hr>
<h2 id='design_efficiency'>Efficiency between optimal design and a user given design</h2><span id='topic+design_efficiency'></span>

<h3>Description</h3>

<p>Takes an optimal design provided from the function <code>opt_des</code> and a user given design and compares their
efficiency
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design_efficiency(design, opt_des_obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="design_efficiency_+3A_design">design</code></td>
<td>
<p>dataframe that represents the design. Must have two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="design_efficiency_+3A_opt_des_obj">opt_des_obj</code></td>
<td>
<p>an object given by the function <code>opt_des</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The efficiency as a value between 0 and 1
</p>


<h3>See Also</h3>

<p>opt_des
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result &lt;- opt_des("D-Optimality", y ~ a * exp(-b / x), c("a", "b"), c(1, 1500), c(212, 422))
design &lt;- data.frame("Point" = c(220, 240, 400), "Weight" = c(1 / 3, 1 / 3, 1 / 3))
design_efficiency(design, result)
</code></pre>

<hr>
<h2 id='dsaugment_design'>Ds-Augment Design</h2><span id='topic+dsaugment_design'></span>

<h3>Description</h3>

<p>Ds-Augments a design. The user gives an initial design for which he would like to add points
and specifies the weight of the new points. Then he is prompted to choose a
minimum efficiency. After that, the candidate points region is calculated
and the user can choose the points and weights to add.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsaugment_design(
  init_design,
  alpha,
  model,
  parameters,
  par_values,
  par_int,
  design_space,
  calc_optimal_design,
  weight_fun = function(x) 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dsaugment_design_+3A_init_design">init_design</code></td>
<td>
<p>dataframe with &quot;Point&quot; and &quot;Weight&quot; columns that represents the initial design to augment</p>
</td></tr>
<tr><td><code id="dsaugment_design_+3A_alpha">alpha</code></td>
<td>
<p>combined weight of the new points</p>
</td></tr>
<tr><td><code id="dsaugment_design_+3A_model">model</code></td>
<td>
<p>formula that represents the model with x as the independent variable</p>
</td></tr>
<tr><td><code id="dsaugment_design_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the unknown parameters of the model to estimate</p>
</td></tr>
<tr><td><code id="dsaugment_design_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the initial values of the unknown parameters</p>
</td></tr>
<tr><td><code id="dsaugment_design_+3A_par_int">par_int</code></td>
<td>
<p>optional numeric vector with the index of the <code>parameters</code> of interest for Ds-optimality.</p>
</td></tr>
<tr><td><code id="dsaugment_design_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design</p>
</td></tr>
<tr><td><code id="dsaugment_design_+3A_calc_optimal_design">calc_optimal_design</code></td>
<td>
<p>boolean parameter, if TRUE, the optimal design is calculated and efficiencies of the initial and augmented design are given</p>
</td></tr>
<tr><td><code id="dsaugment_design_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe that represents the Ds-augmented design
</p>


<h3>See Also</h3>

<p>Other augment designs: 
<code><a href="#topic+daugment_design">daugment_design</a>()</code>,
<code><a href="#topic+laugment_design">laugment_design</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>init_des &lt;- data.frame("Point" = c(30, 60, 90), "Weight" = c(1/3, 1/3, 1/3))
augment_design("Ds-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), par_int = c(1), TRUE)
augment_design("Ds-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), par_int = c(1), FALSE)

</code></pre>

<hr>
<h2 id='dscrit'>Criterion function for Ds-Optimality</h2><span id='topic+dscrit'></span>

<h3>Description</h3>

<p>Calculates the value of the Ds-Optimality criterion function, which follows the expression:
</p>
<p style="text-align: center;"><code class="reqn">\phi_{Ds} = \left(\frac{|M_{22}|}{|M|}\right)^{1/s}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>dscrit(M, par_int)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dscrit_+3A_m">M</code></td>
<td>
<p>information matrix for which the criterion value wants to be calculated.</p>
</td></tr>
<tr><td><code id="dscrit_+3A_par_int">par_int</code></td>
<td>
<p>numeric vector with the index of the parameters of interest of the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value of the Ds-optimality criterion for the information matrix.
</p>

<hr>
<h2 id='dsens'>Sensitivity function for D-Optimality</h2><span id='topic+dsens'></span>

<h3>Description</h3>

<p>Calculates the sensitivity function from the gradient vector and the Identity Matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsens(grad, M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dsens_+3A_grad">grad</code></td>
<td>
<p>A function in a single variable that returns the partial derivatives vector of the model.</p>
</td></tr>
<tr><td><code id="dsens_+3A_m">M</code></td>
<td>
<p>Information Matrix for the sensitivity function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The sensitivity function as a matrix of single variable.
</p>

<hr>
<h2 id='dssens'>Sensitivity function for Ds-Optimality</h2><span id='topic+dssens'></span>

<h3>Description</h3>

<p>Calculates the sensitivity function from the gradient vector, the Identity Matrix and the parameters of
interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dssens(grad, M, par_int)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dssens_+3A_grad">grad</code></td>
<td>
<p>A function in a single variable that returns the partial derivatives vector of the model.</p>
</td></tr>
<tr><td><code id="dssens_+3A_m">M</code></td>
<td>
<p>Information Matrix for the sensitivity function.</p>
</td></tr>
<tr><td><code id="dssens_+3A_par_int">par_int</code></td>
<td>
<p>Numeric vector of the indexes of the parameters of interest for Ds-Optimality.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The sensitivity function as a matrix of single variable.
</p>

<hr>
<h2 id='DsWFMult'>Cocktail Algorithm implementation for Ds-Optimality</h2><span id='topic+DsWFMult'></span>

<h3>Description</h3>

<p>Function that calculates the Ds-Optimal designs for the interest parameters given by <code>intPar</code>. The
rest of the parameters can help the convergence of the algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DsWFMult(
  init_design,
  grad,
  par_int,
  min,
  max,
  grid.length,
  join_thresh,
  delete_thresh,
  delta_weights,
  tol,
  tol2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DsWFMult_+3A_init_design">init_design</code></td>
<td>
<p>optional dataframe with the initial design for the algorithm. A dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DsWFMult_+3A_grad">grad</code></td>
<td>
<p>function of partial derivatives of the model.</p>
</td></tr>
<tr><td><code id="DsWFMult_+3A_par_int">par_int</code></td>
<td>
<p>numeric vector with the index of the <code>parameters</code> of interest. Only necessary when
the <code>criterion</code> chosen is 'Ds-Optimality'.</p>
</td></tr>
<tr><td><code id="DsWFMult_+3A_min">min</code></td>
<td>
<p>numeric value with the inferior bound of the space of the design.</p>
</td></tr>
<tr><td><code id="DsWFMult_+3A_max">max</code></td>
<td>
<p>numeric value with the upper bound of the space of the design.</p>
</td></tr>
<tr><td><code id="DsWFMult_+3A_grid.length">grid.length</code></td>
<td>
<p>numeric value that gives the grid to evaluate the sensitivity function when looking for a
maximum.</p>
</td></tr>
<tr><td><code id="DsWFMult_+3A_join_thresh">join_thresh</code></td>
<td>
<p>numeric value that states how close, in real units, two points must be in order to
be joined together by the join heuristic.</p>
</td></tr>
<tr><td><code id="DsWFMult_+3A_delete_thresh">delete_thresh</code></td>
<td>
<p>numeric value with the minimum weight, over 1 total, that a point needs to have
in order to not be deleted from the design.</p>
</td></tr>
<tr><td><code id="DsWFMult_+3A_delta_weights">delta_weights</code></td>
<td>
<p>numeric value in (0, 1), parameter of the algorithm.</p>
</td></tr>
<tr><td><code id="DsWFMult_+3A_tol">tol</code></td>
<td>
<p>numeric value for the convergence of the weight optimizing algorithm.</p>
</td></tr>
<tr><td><code id="DsWFMult_+3A_tol2">tol2</code></td>
<td>
<p>numeric value for the stop condition of the algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list correspondent to the output of the correspondent algorithm called, dependent on the criterion.
A list of two objects:
</p>

<ul>
<li><p> optdes: a dataframe with the optimal design in two columns, <code>Point</code> and <code>Weight</code>.
</p>
</li>
<li><p> sens: a plot with the sensitivity function to check for optimality of the design.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other cocktail algorithms: 
<code><a href="#topic+DWFMult">DWFMult</a>()</code>,
<code><a href="#topic+IWFMult">IWFMult</a>()</code>,
<code><a href="#topic+WFMult">WFMult</a>()</code>
</p>

<hr>
<h2 id='DWFMult'>Cocktail Algorithm implementation for D-Optimality</h2><span id='topic+DWFMult'></span>

<h3>Description</h3>

<p>Function that calculates the DsOptimal design. The rest of the parameters can help the convergence of the
algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DWFMult(
  init_design,
  grad,
  min,
  max,
  grid.length,
  join_thresh,
  delete_thresh,
  k,
  delta_weights,
  tol,
  tol2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DWFMult_+3A_init_design">init_design</code></td>
<td>
<p>optional dataframe with the initial design for the algorithm. A dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DWFMult_+3A_grad">grad</code></td>
<td>
<p>function of partial derivatives of the model.</p>
</td></tr>
<tr><td><code id="DWFMult_+3A_min">min</code></td>
<td>
<p>numeric value with the inferior bound of the space of the design.</p>
</td></tr>
<tr><td><code id="DWFMult_+3A_max">max</code></td>
<td>
<p>numeric value with the upper bound of the space of the design.</p>
</td></tr>
<tr><td><code id="DWFMult_+3A_grid.length">grid.length</code></td>
<td>
<p>numeric value that gives the grid to evaluate the sensitivity function when looking for a
maximum.</p>
</td></tr>
<tr><td><code id="DWFMult_+3A_join_thresh">join_thresh</code></td>
<td>
<p>numeric value that states how close, in real units, two points must be in order to
be joined together by the join heuristic.</p>
</td></tr>
<tr><td><code id="DWFMult_+3A_delete_thresh">delete_thresh</code></td>
<td>
<p>numeric value with the minimum weight, over 1 total, that a point needs to have
in order to not be deleted from the design.</p>
</td></tr>
<tr><td><code id="DWFMult_+3A_k">k</code></td>
<td>
<p>number of unknown parameters of the model.</p>
</td></tr>
<tr><td><code id="DWFMult_+3A_delta_weights">delta_weights</code></td>
<td>
<p>numeric value in (0, 1), parameter of the algorithm.</p>
</td></tr>
<tr><td><code id="DWFMult_+3A_tol">tol</code></td>
<td>
<p>numeric value for the convergence of the weight optimizing algorithm.</p>
</td></tr>
<tr><td><code id="DWFMult_+3A_tol2">tol2</code></td>
<td>
<p>numeric value for the stop condition of the algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list correspondent to the output of the correspondent algorithm called, dependent on the criterion.
A list of two objects:
</p>

<ul>
<li><p> optdes: a dataframe with the optimal design in two columns, <code>Point</code> and <code>Weight</code>.
</p>
</li>
<li><p> sens: a plot with the sensitivity function to check for optimality of the design.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other cocktail algorithms: 
<code><a href="#topic+DsWFMult">DsWFMult</a>()</code>,
<code><a href="#topic+IWFMult">IWFMult</a>()</code>,
<code><a href="#topic+WFMult">WFMult</a>()</code>
</p>

<hr>
<h2 id='eff'>Efficiency between two Information Matrices</h2><span id='topic+eff'></span>

<h3>Description</h3>

<p>Efficiency between two Information Matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eff(criterion, mat1, mat2, k = 0, intPars = c(1), matB = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eff_+3A_criterion">criterion</code></td>
<td>
<p>character variable with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
<tr><td><code id="eff_+3A_mat1">mat1</code></td>
<td>
<p>first information matrix, for the numerator.</p>
</td></tr>
<tr><td><code id="eff_+3A_mat2">mat2</code></td>
<td>
<p>second information matrix, for the denominator.</p>
</td></tr>
<tr><td><code id="eff_+3A_k">k</code></td>
<td>
<p>number of parameters of the model. Taken from the number of rows of the matrix if omitted.</p>
</td></tr>
<tr><td><code id="eff_+3A_intpars">intPars</code></td>
<td>
<p>numeric vector with the index of the parameters of interest of the model. Only for &quot;Ds-Optimality&quot;.</p>
</td></tr>
<tr><td><code id="eff_+3A_matb">matB</code></td>
<td>
<p>matrix of the integral of the information matrix over the interest region. Only for &quot;I-Optimality&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Efficiency of first design with respect to the second design, as a decimal number.
</p>

<hr>
<h2 id='efficient_round'>Efficient Round</h2><span id='topic+efficient_round'></span>

<h3>Description</h3>

<p>Takes an approximate design, and a number of points and converts the design to
an approximate design. It uses the multiplier (n - l/2) and evens the total
number of observations afterwards.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>efficient_round(design, n, tol = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="efficient_round_+3A_design">design</code></td>
<td>
<p>a dataframe with columns &quot;Point&quot; and &quot;Weight&quot; that represents a design</p>
</td></tr>
<tr><td><code id="efficient_round_+3A_n">n</code></td>
<td>
<p>an integer that represents the desired number of observations of the exact design</p>
</td></tr>
<tr><td><code id="efficient_round_+3A_tol">tol</code></td>
<td>
<p>optional parameter for the consideration of an integer in the rounding process</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with columns &quot;Point&quot; and &quot;Weight&quot; representing an exact design
with n observations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>design_test &lt;- data.frame("Point" = seq(1, 5, length.out = 7),
         "Weight" = c(0.1, 0.0001, 0.2, 0.134, 0.073, 0.2111, 0.2818))

efficient_round(design_test, 20)

exact_design &lt;- efficient_round(design_test, 21)
aprox_design &lt;- exact_design
aprox_design$Weight &lt;- aprox_design$Weight/sum(aprox_design$Weight)
</code></pre>

<hr>
<h2 id='findmax'>Find Maximum</h2><span id='topic+findmax'></span>

<h3>Description</h3>

<p>Searches the maximum of a function over a grid on a given interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findmax(sens, min, max, grid.length)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findmax_+3A_sens">sens</code></td>
<td>
<p>A single variable numeric function to evaluate.</p>
</td></tr>
<tr><td><code id="findmax_+3A_min">min</code></td>
<td>
<p>Minimum value of the search interval.</p>
</td></tr>
<tr><td><code id="findmax_+3A_max">max</code></td>
<td>
<p>Maximum value of the search interval.</p>
</td></tr>
<tr><td><code id="findmax_+3A_grid.length">grid.length</code></td>
<td>
<p>Length of the search interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value at which the maximum is obtained
</p>

<hr>
<h2 id='findmaxval'>Find Maximum Value</h2><span id='topic+findmaxval'></span>

<h3>Description</h3>

<p>Searches the maximum of a function over a grid on a given interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findmaxval(sens, min, max, grid.length)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findmaxval_+3A_sens">sens</code></td>
<td>
<p>A single variable numeric function to evaluate.</p>
</td></tr>
<tr><td><code id="findmaxval_+3A_min">min</code></td>
<td>
<p>Minimum value of the search interval.</p>
</td></tr>
<tr><td><code id="findmaxval_+3A_max">max</code></td>
<td>
<p>Maximum value of the search interval.</p>
</td></tr>
<tr><td><code id="findmaxval_+3A_grid.length">grid.length</code></td>
<td>
<p>Length of the search interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the maximum
</p>

<hr>
<h2 id='findminval'>Find Minimum Value</h2><span id='topic+findminval'></span>

<h3>Description</h3>

<p>Searches the maximum of a function over a grid on a given grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findminval(sens, min, max, grid.length)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findminval_+3A_sens">sens</code></td>
<td>
<p>a single variable numeric function to evaluate.</p>
</td></tr>
<tr><td><code id="findminval_+3A_min">min</code></td>
<td>
<p>minimum value of the search grid.</p>
</td></tr>
<tr><td><code id="findminval_+3A_max">max</code></td>
<td>
<p>maximum value of the search grid.</p>
</td></tr>
<tr><td><code id="findminval_+3A_grid.length">grid.length</code></td>
<td>
<p>length of the search grid.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the minimum
</p>

<hr>
<h2 id='get_augment_region'>Get Augment Regions</h2><span id='topic+get_augment_region'></span>

<h3>Description</h3>

<p>Given a model and criterion, calculates the candidate points region. The user gives an initial design for which
he would like to add points and specifies the weight of the new points. Then he is prompted
to choose a minimum efficiency. After that, the candidate points region is calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_augment_region(
  criterion,
  init_design,
  alpha,
  model,
  parameters,
  par_values,
  design_space,
  calc_optimal_design,
  par_int = NA,
  matB = NA,
  distribution = NA,
  weight_fun = function(x) 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_augment_region_+3A_criterion">criterion</code></td>
<td>
<p>character with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_augment_region_+3A_init_design">init_design</code></td>
<td>
<p>dataframe with &quot;Point&quot; and &quot;Weight&quot; columns that represents the initial design to augment</p>
</td></tr>
<tr><td><code id="get_augment_region_+3A_alpha">alpha</code></td>
<td>
<p>combined weight of the new points</p>
</td></tr>
<tr><td><code id="get_augment_region_+3A_model">model</code></td>
<td>
<p>formula that represent the model with x as the independent variable</p>
</td></tr>
<tr><td><code id="get_augment_region_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the unknown parameters of the model to estimate</p>
</td></tr>
<tr><td><code id="get_augment_region_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the initial values of the unknown parameters</p>
</td></tr>
<tr><td><code id="get_augment_region_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design</p>
</td></tr>
<tr><td><code id="get_augment_region_+3A_calc_optimal_design">calc_optimal_design</code></td>
<td>
<p>boolean parameter, if TRUE, the optimal design is calculated and efficiencies of the initial and augmented design are given</p>
</td></tr>
<tr><td><code id="get_augment_region_+3A_par_int">par_int</code></td>
<td>
<p>optional numeric vector with the index of the <code>parameters</code> of interest for Ds-optimality.</p>
</td></tr>
<tr><td><code id="get_augment_region_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for L-optimality.</p>
</td></tr>
<tr><td><code id="get_augment_region_+3A_distribution">distribution</code></td>
<td>
<p>character specifying the probability distribution of the response. Can be one of the following:
</p>

<ul>
<li><p> 'Homoscedasticity'
</p>
</li>
<li><p> 'Gamma', which can be used for exponential or normal heteroscedastic with constant relative error
</p>
</li>
<li><p> 'Poisson'
</p>
</li>
<li><p> 'Logistic'
</p>
</li>
<li><p> 'Log-Normal' (work in progress)
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_augment_region_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the points limiting the candidate points region
</p>


<h3>Examples</h3>

<pre><code class='language-R'>init_des &lt;- data.frame("Point" = c(30, 60, 90), "Weight" = c(1/3, 1/3, 1/3))
get_augment_region("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), TRUE)
get_augment_region("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), FALSE)
</code></pre>

<hr>
<h2 id='get_daugment_region'>Get D-augment region</h2><span id='topic+get_daugment_region'></span>

<h3>Description</h3>

<p>Given a model, calculates the candidate points region for D-Optimality. The user gives an initial
design for which he would like to add points and specifies the weight of the new points. Then he
is prompted to choose a minimum efficiency. After that, the candidate points region is calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_daugment_region(
  init_design,
  alpha,
  model,
  parameters,
  par_values,
  design_space,
  calc_optimal_design,
  weight_fun = function(x) 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_daugment_region_+3A_init_design">init_design</code></td>
<td>
<p>dataframe with &quot;Point&quot; and &quot;Weight&quot; columns that represents the initial design to augment</p>
</td></tr>
<tr><td><code id="get_daugment_region_+3A_alpha">alpha</code></td>
<td>
<p>combined weight of the new points</p>
</td></tr>
<tr><td><code id="get_daugment_region_+3A_model">model</code></td>
<td>
<p>formula that represent the model with x as the independent variable</p>
</td></tr>
<tr><td><code id="get_daugment_region_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the unknown parameters of the model to estimate</p>
</td></tr>
<tr><td><code id="get_daugment_region_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the initial values of the unknown parameters</p>
</td></tr>
<tr><td><code id="get_daugment_region_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design</p>
</td></tr>
<tr><td><code id="get_daugment_region_+3A_calc_optimal_design">calc_optimal_design</code></td>
<td>
<p>boolean parameter, if TRUE, the optimal design is calculated and efficiencies of the initial and augmented design are given</p>
</td></tr>
<tr><td><code id="get_daugment_region_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the points limiting the candidate points region
</p>


<h3>Examples</h3>

<pre><code class='language-R'>init_des &lt;- data.frame("Point" = c(30, 60, 90), "Weight" = c(1/3, 1/3, 1/3))
get_augment_region("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), TRUE)
get_augment_region("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), FALSE)
</code></pre>

<hr>
<h2 id='get_dsaugment_region'>Get Ds-augment region</h2><span id='topic+get_dsaugment_region'></span>

<h3>Description</h3>

<p>Given a model, calculates the candidate points region for Ds-Optimality. The user gives an initial
design for which he would like to add points and specifies the weight of the new points. Then he
is prompted to choose a minimum efficiency. After that, the candidate points region is calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dsaugment_region(
  init_design,
  alpha,
  model,
  parameters,
  par_values,
  par_int,
  design_space,
  calc_optimal_design,
  weight_fun = function(x) 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_dsaugment_region_+3A_init_design">init_design</code></td>
<td>
<p>dataframe with &quot;Point&quot; and &quot;Weight&quot; columns that represents the initial design to augment</p>
</td></tr>
<tr><td><code id="get_dsaugment_region_+3A_alpha">alpha</code></td>
<td>
<p>combined weight of the new points</p>
</td></tr>
<tr><td><code id="get_dsaugment_region_+3A_model">model</code></td>
<td>
<p>formula that represent the model with x as the independent variable</p>
</td></tr>
<tr><td><code id="get_dsaugment_region_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the unknown parameters of the model to estimate</p>
</td></tr>
<tr><td><code id="get_dsaugment_region_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the initial values of the unknown parameters</p>
</td></tr>
<tr><td><code id="get_dsaugment_region_+3A_par_int">par_int</code></td>
<td>
<p>optional numeric vector with the index of the <code>parameters</code> of interest for Ds-optimality.</p>
</td></tr>
<tr><td><code id="get_dsaugment_region_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design</p>
</td></tr>
<tr><td><code id="get_dsaugment_region_+3A_calc_optimal_design">calc_optimal_design</code></td>
<td>
<p>boolean parameter, if TRUE, the optimal design is calculated and efficiencies of the initial and augmented design are given</p>
</td></tr>
<tr><td><code id="get_dsaugment_region_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the points limiting the candidate points region
</p>


<h3>See Also</h3>

<p>Other augment region: 
<code><a href="#topic+get_laugment_region">get_laugment_region</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>init_des &lt;- data.frame("Point" = c(30, 60, 90), "Weight" = c(1/3, 1/3, 1/3))
get_augment_region("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), TRUE)
get_augment_region("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), FALSE)
</code></pre>

<hr>
<h2 id='get_laugment_region'>Get L-augment region</h2><span id='topic+get_laugment_region'></span>

<h3>Description</h3>

<p>Given a model, calculates the candidate points region for L-Optimality. The user gives an initial
design for which he would like to add points and specifies the weight of the new points. Then he
is prompted to choose a minimum efficiency. After that, the candidate points region is calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_laugment_region(
  init_design,
  alpha,
  model,
  parameters,
  par_values,
  design_space,
  calc_optimal_design,
  matB,
  weight_fun = function(x) 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_laugment_region_+3A_init_design">init_design</code></td>
<td>
<p>dataframe with &quot;Point&quot; and &quot;Weight&quot; columns that represents the initial design to augment</p>
</td></tr>
<tr><td><code id="get_laugment_region_+3A_alpha">alpha</code></td>
<td>
<p>combined weight of the new points</p>
</td></tr>
<tr><td><code id="get_laugment_region_+3A_model">model</code></td>
<td>
<p>formula that represent the model with x as the independent variable</p>
</td></tr>
<tr><td><code id="get_laugment_region_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the unknown parameters of the model to estimate</p>
</td></tr>
<tr><td><code id="get_laugment_region_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the initial values of the unknown parameters</p>
</td></tr>
<tr><td><code id="get_laugment_region_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design</p>
</td></tr>
<tr><td><code id="get_laugment_region_+3A_calc_optimal_design">calc_optimal_design</code></td>
<td>
<p>boolean parameter, if TRUE, the optimal design is calculated and efficiencies of the initial and augmented design are given</p>
</td></tr>
<tr><td><code id="get_laugment_region_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for L-optimality.</p>
</td></tr>
<tr><td><code id="get_laugment_region_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the points limiting the candidate points region
</p>


<h3>See Also</h3>

<p>Other augment region: 
<code><a href="#topic+get_dsaugment_region">get_dsaugment_region</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>init_des &lt;- data.frame("Point" = c(30, 60, 90), "Weight" = c(1/3, 1/3, 1/3))
get_augment_region("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), TRUE)
get_augment_region("D-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), FALSE)
</code></pre>

<hr>
<h2 id='getCross2'>Give effective limits to candidate points region</h2><span id='topic+getCross2'></span>

<h3>Description</h3>

<p>Given the start of the candidates points region, the parity of the crosspoints
and the boundaries of the space of the design returns the effective limits of
the candidate points region. Those points, taken in pairs from the first to
the last delimit the region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCross2(cross, min, max, start, par)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCross2_+3A_cross">cross</code></td>
<td>
<p>Vector of crosspoints in the sensitivity function given an efficiency and weight</p>
</td></tr>
<tr><td><code id="getCross2_+3A_min">min</code></td>
<td>
<p>Minimum of the space of the design</p>
</td></tr>
<tr><td><code id="getCross2_+3A_max">max</code></td>
<td>
<p>Maximum of the space of the design</p>
</td></tr>
<tr><td><code id="getCross2_+3A_start">start</code></td>
<td>
<p>Boolean that gives the effective start of the candidate points region</p>
</td></tr>
<tr><td><code id="getCross2_+3A_par">par</code></td>
<td>
<p>Boolean with the parity of the region</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of effective limits of the candidate points region. Taken
in pairs from the beginning delimit the region.
</p>

<hr>
<h2 id='getPar'>Parity of the crosspoints</h2><span id='topic+getPar'></span>

<h3>Description</h3>

<p>Determines if the number of crosspoints is even or odd given the vector
of crosspoints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPar(cross)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPar_+3A_cross">cross</code></td>
<td>
<p>Vector of crosspoints in the sensitivity function given an efficiency and weight</p>
</td></tr>
</table>


<h3>Value</h3>

<p>True if the number of crosspoints is even, false otherwise
</p>

<hr>
<h2 id='getStart'>Find where the candidate points region starts</h2><span id='topic+getStart'></span>

<h3>Description</h3>

<p>Given the crosspoints and the sensitivity function, this function
finds where the candidate points region starts, either on the extreme of
the space of the design or the first crosspoints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStart(cross, min, max, val, sens_opt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getStart_+3A_cross">cross</code></td>
<td>
<p>Vector of crosspoints in the sensitivity function given an efficiency and weight</p>
</td></tr>
<tr><td><code id="getStart_+3A_min">min</code></td>
<td>
<p>Minimum of the space of the design</p>
</td></tr>
<tr><td><code id="getStart_+3A_max">max</code></td>
<td>
<p>Maximum of the space of the design</p>
</td></tr>
<tr><td><code id="getStart_+3A_val">val</code></td>
<td>
<p>Value of the sensitivity function at the crosspoints</p>
</td></tr>
<tr><td><code id="getStart_+3A_sens_opt">sens_opt</code></td>
<td>
<p>Sensitivity function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>True if the candidate points region starts on the minimum, False otherwise
</p>

<hr>
<h2 id='gradient'>Gradient function</h2><span id='topic+gradient'></span>

<h3>Description</h3>

<p>Calculates the gradient function of a <code>model</code> with respect to the parameters, <code>char_vars</code>, evaluates
it at the provided <code>values</code> and returns the result as a function of the variable <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gradient(model, char_vars, values, weight_fun = function(x) 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gradient_+3A_model">model</code></td>
<td>
<p>formula describing the model, which must contain only <code>x</code>, the parameters defined in
<code>char_vars</code> and the numerical operators.</p>
</td></tr>
<tr><td><code id="gradient_+3A_char_vars">char_vars</code></td>
<td>
<p>character vector of the parameters of the model.</p>
</td></tr>
<tr><td><code id="gradient_+3A_values">values</code></td>
<td>
<p>numeric vector with the nominal values of the parameters in <code>char_vars</code>.</p>
</td></tr>
<tr><td><code id="gradient_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional function variable that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function depending on <code>x</code> that's the gradient of the <code>model</code> with respect to <code>char_vars</code>
</p>

<hr>
<h2 id='gradient22'>Gradient function for a subset of variables</h2><span id='topic+gradient22'></span>

<h3>Description</h3>

<p>Calculates the gradient function of a <code>model</code> with respect to a subset of the parameters given in
<code>par_int</code>, <code>char_vars</code>, evaluates it at the provided <code>values</code> and returns the result as
a function of the variable <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gradient22(model, char_vars, values, par_int, weight_fun = function(x) 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gradient22_+3A_model">model</code></td>
<td>
<p>formula describing the model, which must contain only <code>x</code>, the parameters defined in
<code>char_vars</code> and the numerical operators.</p>
</td></tr>
<tr><td><code id="gradient22_+3A_char_vars">char_vars</code></td>
<td>
<p>character vector of the parameters of the model.</p>
</td></tr>
<tr><td><code id="gradient22_+3A_values">values</code></td>
<td>
<p>numeric vector with the nominal values of the parameters in <code>char_vars</code>.</p>
</td></tr>
<tr><td><code id="gradient22_+3A_par_int">par_int</code></td>
<td>
<p>vector of indexes indicating the subset of variables to omit in the calculation of the gradient.</p>
</td></tr>
<tr><td><code id="gradient22_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function depending on <code>x</code> that's the gradient of the <code>model</code> with respect to <code>char_vars</code>
</p>

<hr>
<h2 id='icrit'>Criterion function for I-Optimality and L-Optimality</h2><span id='topic+icrit'></span>

<h3>Description</h3>

<p>Calculates the value of the I-Optimality criterion function, which follows the expression:
</p>
<p style="text-align: center;"><code class="reqn">\phi_I = Tr(M^{-1} \cdot B)</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>icrit(M, matB)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="icrit_+3A_m">M</code></td>
<td>
<p>information matrix for which the criterion value wants to be calculated.</p>
</td></tr>
<tr><td><code id="icrit_+3A_matb">matB</code></td>
<td>
<p>matrix of the integral of the information matrix over the interest region. Identity matrix for
A-Optimality.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value of the I-optimality criterion for the information matrix.
</p>

<hr>
<h2 id='inf_mat'>Information Matrix</h2><span id='topic+inf_mat'></span>

<h3>Description</h3>

<p>Given the gradient vector of a model in a single variable model and a design, calculates the information matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inf_mat(grad, design)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inf_mat_+3A_grad">grad</code></td>
<td>
<p>A function in a single variable that returns the partial derivatives vector of the model.</p>
</td></tr>
<tr><td><code id="inf_mat_+3A_design">design</code></td>
<td>
<p>A dataframe that represents the design. Must have two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>The information matrix of the design, a <code class="reqn">k\times k</code> matrix where k is the length of the gradient.
</p>

<hr>
<h2 id='integrate_reg_int'>Integrate IM</h2><span id='topic+integrate_reg_int'></span>

<h3>Description</h3>

<p>Integrates the information matrix over the region of interest to calculate matrix B to be used in I-Optimality
calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate_reg_int(grad, k, reg_int)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="integrate_reg_int_+3A_grad">grad</code></td>
<td>
<p>function of partial derivatives of the model.</p>
</td></tr>
<tr><td><code id="integrate_reg_int_+3A_k">k</code></td>
<td>
<p>number of unknown parameters of the model.</p>
</td></tr>
<tr><td><code id="integrate_reg_int_+3A_reg_int">reg_int</code></td>
<td>
<p>optional numeric vector of two components with the bounds of the interest region for I-Optimality.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The integrated information matrix.
</p>

<hr>
<h2 id='isens'>Sensitivity function for I-Optimality</h2><span id='topic+isens'></span>

<h3>Description</h3>

<p>Calculates the sensitivity function from the gradient vector, the Information Matrix and the integral of the
one-point Identity Matrix over the interest region. If instead the identity matrix is used, it can be used
for A-Optimality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isens(grad, M, matB)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isens_+3A_grad">grad</code></td>
<td>
<p>A function in a single variable that returns the partial derivatives vector of the model.</p>
</td></tr>
<tr><td><code id="isens_+3A_m">M</code></td>
<td>
<p>Information Matrix for the sensitivity function.</p>
</td></tr>
<tr><td><code id="isens_+3A_matb">matB</code></td>
<td>
<p>Matrix resulting from the integration of the one-point Information Matrix along the interest
region or lineal matrix for L-Optimality.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The sensitivity function as a matrix of single variable.
</p>

<hr>
<h2 id='IWFMult'>Cocktail Algorithm implementation for L-, I- and A-Optimality (with matB = diag(k))</h2><span id='topic+IWFMult'></span>

<h3>Description</h3>

<p>Function that calculates the I-Optimal designs given the matrix B (should be integral of the information matrix
over the interest region), or A-Optimal if given diag(k). The rest of the parameters can help the convergence
of the algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IWFMult(
  init_design,
  grad,
  matB,
  min,
  max,
  grid.length,
  join_thresh,
  delete_thresh,
  delta_weights,
  tol,
  tol2,
  criterion
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IWFMult_+3A_init_design">init_design</code></td>
<td>
<p>optional dataframe with the initial design for the algorithm. A dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="IWFMult_+3A_grad">grad</code></td>
<td>
<p>function of partial derivatives of the model.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for L-optimality.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_min">min</code></td>
<td>
<p>numeric value with the inferior bound of the space of the design.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_max">max</code></td>
<td>
<p>numeric value with the upper bound of the space of the design.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_grid.length">grid.length</code></td>
<td>
<p>numeric value that gives the grid to evaluate the sensitivity function when looking for a
maximum.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_join_thresh">join_thresh</code></td>
<td>
<p>numeric value that states how close, in real units, two points must be in order to
be joined together by the join heuristic.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_delete_thresh">delete_thresh</code></td>
<td>
<p>numeric value with the minimum weight, over 1 total, that a point needs to have
in order to not be deleted from the design.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_delta_weights">delta_weights</code></td>
<td>
<p>numeric value in (0, 1), parameter of the algorithm.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_tol">tol</code></td>
<td>
<p>numeric value for the convergence of the weight optimizing algorithm.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_tol2">tol2</code></td>
<td>
<p>numeric value for the stop condition of the algorithm.</p>
</td></tr>
<tr><td><code id="IWFMult_+3A_criterion">criterion</code></td>
<td>
<p>character variable with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>list correspondent to the output of the correspondent algorithm called, dependent on the criterion.
A list of two objects:
</p>

<ul>
<li><p> optdes: a dataframe with the optimal design in two columns, <code>Point</code> and <code>Weight</code>.
</p>
</li>
<li><p> sens: a plot with the sensitivity function to check for optimality of the design.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other cocktail algorithms: 
<code><a href="#topic+DWFMult">DWFMult</a>()</code>,
<code><a href="#topic+DsWFMult">DsWFMult</a>()</code>,
<code><a href="#topic+WFMult">WFMult</a>()</code>
</p>

<hr>
<h2 id='laugment_design'>L-Augment Design</h2><span id='topic+laugment_design'></span>

<h3>Description</h3>

<p>L-Augments a design. The user gives an initial design for which he would like to add points
and specifies the weight of the new points. Then he is prompted to choose a
minimum efficiency. After that, the candidate points region is calculated
and the user can choose the points and weights to add.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>laugment_design(
  init_design,
  alpha,
  model,
  parameters,
  par_values,
  design_space,
  calc_optimal_design,
  matB,
  weight_fun = function(x) 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="laugment_design_+3A_init_design">init_design</code></td>
<td>
<p>dataframe with &quot;Point&quot; and &quot;Weight&quot; columns that represents the initial design to augment</p>
</td></tr>
<tr><td><code id="laugment_design_+3A_alpha">alpha</code></td>
<td>
<p>combined weight of the new points</p>
</td></tr>
<tr><td><code id="laugment_design_+3A_model">model</code></td>
<td>
<p>formula that represents the model with x as the independent variable</p>
</td></tr>
<tr><td><code id="laugment_design_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the unknown parameters of the model to estimate</p>
</td></tr>
<tr><td><code id="laugment_design_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the initial values of the unknown parameters</p>
</td></tr>
<tr><td><code id="laugment_design_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design</p>
</td></tr>
<tr><td><code id="laugment_design_+3A_calc_optimal_design">calc_optimal_design</code></td>
<td>
<p>boolean parameter, if TRUE, the optimal design is calculated and efficiencies of the initial and augmented design are given</p>
</td></tr>
<tr><td><code id="laugment_design_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for L-optimality.</p>
</td></tr>
<tr><td><code id="laugment_design_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe that represents the L-augmented design
</p>


<h3>See Also</h3>

<p>Other augment designs: 
<code><a href="#topic+daugment_design">daugment_design</a>()</code>,
<code><a href="#topic+dsaugment_design">dsaugment_design</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>init_des &lt;- data.frame("Point" = c(30, 60, 90), "Weight" = c(1/3, 1/3, 1/3))
augment_design("I-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), TRUE)
augment_design("I-Optimality", init_des, 0.25, y ~ 10^(a-b/(c+x)), c("a","b","c"),
  c(8.07131,  1730.63, 233.426), c(1, 100), FALSE)

</code></pre>

<hr>
<h2 id='opt_des'>Calculates the optimal design for a specified criterion</h2><span id='topic+opt_des'></span>

<h3>Description</h3>

<p>The opt_des function calculates the optimal design for an optimality criterion and a model input from the user.
The parameters allows for the user to customize the parameters for the cocktail algorithm in case the default
set does not provide a satisfactory output. Depending on the criterion, additional details are necessary.
For 'Ds-Optimality' the par_int parameter is necessary. For 'I-Optimality' either the matB or reg_int must
be provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opt_des(
  criterion,
  model,
  parameters,
  par_values = c(1),
  design_space,
  init_design = NULL,
  join_thresh = -1,
  delete_thresh = 0.02,
  delta = 1/2,
  tol = 1e-05,
  tol2 = 1e-05,
  par_int = NULL,
  matB = NULL,
  reg_int = NULL,
  desired_output = c(1, 2),
  distribution = NA,
  weight_fun = function(x) 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opt_des_+3A_criterion">criterion</code></td>
<td>
<p>character variable with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
<tr><td><code id="opt_des_+3A_model">model</code></td>
<td>
<p>formula describing the model to calculate the optimal design. Must use x as the variable.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_parameters">parameters</code></td>
<td>
<p>character vector with the parameters of the models, as written in the <code>formula</code>.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_par_values">par_values</code></td>
<td>
<p>numeric vector with the parameters nominal values, in the same order as given in <code>parameters</code>.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_design_space">design_space</code></td>
<td>
<p>numeric vector with the limits of the space of the design.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_init_design">init_design</code></td>
<td>
<p>optional dataframe with the initial design for the algorithm. A dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="opt_des_+3A_join_thresh">join_thresh</code></td>
<td>
<p>optional numeric value that states how close, in real units, two points must be in order to
be joined together by the join heuristic.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_delete_thresh">delete_thresh</code></td>
<td>
<p>optional numeric value with the minimum weight, over 1 total, that a point needs to have
in order to not be deleted from the design.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_delta">delta</code></td>
<td>
<p>optional numeric value in (0, 1), parameter of the algorithm.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_tol">tol</code></td>
<td>
<p>optional numeric value for the convergence of the weight optimizing algorithm.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_tol2">tol2</code></td>
<td>
<p>optional numeric value for the stop criterion: difference between maximum of sensitivity function
and optimality criterion.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_par_int">par_int</code></td>
<td>
<p>optional numeric vector with the index of the <code>parameters</code> of interest for Ds-optimality.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for L-optimality.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_reg_int">reg_int</code></td>
<td>
<p>optional numeric vector of two components with the bounds of the interest region for I-Optimality.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_desired_output">desired_output</code></td>
<td>
<p>not functional yet: decide which kind of output you want.</p>
</td></tr>
<tr><td><code id="opt_des_+3A_distribution">distribution</code></td>
<td>
<p>character variable specifying the probability distribution of the response. Can be one of the following:
</p>

<ul>
<li><p> 'Homoscedasticity'
</p>
</li>
<li><p> 'Gamma', which can be used for exponential or normal heteroscedastic with constant relative error
</p>
</li>
<li><p> 'Poisson'
</p>
</li>
<li><p> 'Logistic'
</p>
</li>
<li><p> 'Log-Normal' (work in progress)
</p>
</li></ul>
</td></tr>
<tr><td><code id="opt_des_+3A_weight_fun">weight_fun</code></td>
<td>
<p>optional one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two objects:
</p>

<ul>
<li><p> optdes: a dataframe with the optimal design in two columns, <code>Point</code> and <code>Weight</code>.
</p>
</li>
<li><p> sens: a plot with the sensitivity function to check for optimality of the design.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>opt_des("D-Optimality", y ~ a * exp(-b / x), c("a", "b"), c(1, 1500), c(212, 422))
</code></pre>

<hr>
<h2 id='plot_convergence'>Plot Convergence of the algorithm</h2><span id='topic+plot_convergence'></span>

<h3>Description</h3>

<p>Plots the criterion value on each of the steps of the algorithm, both for optimizing weights and points,
against the total step number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_convergence(convergence)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_convergence_+3A_convergence">convergence</code></td>
<td>
<p>A dataframe with two columns:
</p>

<ul>
<li> <p><code>criteria</code> contains value of the criterion on each step.
</p>
</li>
<li> <p><code>step</code> contains number of the step.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object with the <code>criteria</code> in the <code>y</code> axis and <code>step</code> in the <code>x</code> axis.
</p>

<hr>
<h2 id='plot_sens'>Plot sensitivity function</h2><span id='topic+plot_sens'></span>

<h3>Description</h3>

<p>Plots the sensitivity function and the value of the Equivalence Theorem as an horizontal line, which helps
assess the optimality of the design of the given sensitivity function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sens(min, max, sens_function, criterion_value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_sens_+3A_min">min</code></td>
<td>
<p>Minimum of the space of the design, used in the limits of the representation.</p>
</td></tr>
<tr><td><code id="plot_sens_+3A_max">max</code></td>
<td>
<p>Maximum of the space of the design, used in the limits of the representation.</p>
</td></tr>
<tr><td><code id="plot_sens_+3A_sens_function">sens_function</code></td>
<td>
<p>A single variable function, the sensitivity function.</p>
</td></tr>
<tr><td><code id="plot_sens_+3A_criterion_value">criterion_value</code></td>
<td>
<p>A numeric value representing the other side of the inequality of the Equivalence Theorem.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object that represents the sensitivity function
</p>

<hr>
<h2 id='plot.optdes'>Plot function for optdes</h2><span id='topic+plot.optdes'></span>

<h3>Description</h3>

<p>Plot function for optdes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optdes'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.optdes_+3A_x">x</code></td>
<td>
<p>An object of class <code>optdes</code>.</p>
</td></tr>
<tr><td><code id="plot.optdes_+3A_...">...</code></td>
<td>
<p>Possible extra arguments for plotting dataframes</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>rri &lt;- opt_des(criterion = "I-Optimality", model = y ~ a * exp(-b / x),
  parameters = c("a", "b"), par_values = c(1, 1500), design_space = c(212, 422),
  reg_int = c(380, 422))
plot(rri)
</code></pre>

<hr>
<h2 id='print.optdes'>Print function for optdes</h2><span id='topic+print.optdes'></span>

<h3>Description</h3>

<p>Print function for optdes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optdes'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.optdes_+3A_x">x</code></td>
<td>
<p>An object of class <code>optdes</code>.</p>
</td></tr>
<tr><td><code id="print.optdes_+3A_...">...</code></td>
<td>
<p>Possible extra arguments for printing dataframes</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>rri &lt;- opt_des(criterion = "I-Optimality", model = y ~ a * exp(-b / x),
  parameters = c("a", "b"), par_values = c(1, 1500), design_space = c(212, 422),
  reg_int = c(380, 422))
print(rri)
</code></pre>

<hr>
<h2 id='sens'>Master function to calculate the sensitivity function</h2><span id='topic+sens'></span>

<h3>Description</h3>

<p>Calculates the sensitivity function given the desired <code>Criterion</code>, an information matrix and other
necessary values depending on the chosen criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sens(Criterion, grad, M, par_int = c(1), matB = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sens_+3A_criterion">Criterion</code></td>
<td>
<p>character variable with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
<tr><td><code id="sens_+3A_grad">grad</code></td>
<td>
<p>A function in a single variable that returns the partial derivatives vector of the model.</p>
</td></tr>
<tr><td><code id="sens_+3A_m">M</code></td>
<td>
<p>Information Matrix for the sensitivity function.</p>
</td></tr>
<tr><td><code id="sens_+3A_par_int">par_int</code></td>
<td>
<p>Numeric vector of the indexes of the parameters of interest for Ds-Optimality.</p>
</td></tr>
<tr><td><code id="sens_+3A_matb">matB</code></td>
<td>
<p>Matrix resulting from the integration of the one-point Information Matrix along the interest
region or lineal matrix for L-Optimality.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The sensitivity function as a matrix of single variable.
</p>

<hr>
<h2 id='shiny_augment'>Shiny D-augment</h2><span id='topic+shiny_augment'></span>

<h3>Description</h3>

<p>Launches the demo shiny application to D-augment several prespecified models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiny_augment()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>shiny_augment()
</code></pre>

<hr>
<h2 id='shiny_optimal'>Shiny Optimal</h2><span id='topic+shiny_optimal'></span>

<h3>Description</h3>

<p>Launches the demo shiny application to calculate optimal designs for Antoine's Equation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiny_optimal()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>shiny_optimal()
</code></pre>

<hr>
<h2 id='summary.optdes'>Summary function for optdes</h2><span id='topic+summary.optdes'></span>

<h3>Description</h3>

<p>Summary function for optdes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optdes'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.optdes_+3A_object">object</code></td>
<td>
<p>An object of class <code>optdes</code>.</p>
</td></tr>
<tr><td><code id="summary.optdes_+3A_...">...</code></td>
<td>
<p>Possible extra arguments for the summary</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>rri &lt;- opt_des(criterion = "I-Optimality", model = y ~ a * exp(-b / x),
  parameters = c("a", "b"), par_values = c(1, 1500), design_space = c(212, 422),
  reg_int = c(380, 422))
summary(rri)
</code></pre>

<hr>
<h2 id='tr'>Trace</h2><span id='topic+tr'></span>

<h3>Description</h3>

<p>Return the mathematical trace of a matrix, the sum of its diagonal elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tr(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tr_+3A_m">M</code></td>
<td>
<p>The matrix from which to calculate the trace.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The trace of the matrix.
</p>

<hr>
<h2 id='update_design'>Update Design with new point</h2><span id='topic+update_design'></span>

<h3>Description</h3>

<p>Updates a design adding a new point to it. If the added point is closer than <code>delta</code> to an existing
point of the design, the two points are merged together as their arithmetic average. Then updates the weights
to be equal to all points of the design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_design(design, xmax, delta, new_weight)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_design_+3A_design">design</code></td>
<td>
<p>Design to update. It's a dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="update_design_+3A_xmax">xmax</code></td>
<td>
<p>The point to add as a numeric value.</p>
</td></tr>
<tr><td><code id="update_design_+3A_delta">delta</code></td>
<td>
<p>Threshold which defines how close the new point has to be to any of the existing ones in order to
merge with them.</p>
</td></tr>
<tr><td><code id="update_design_+3A_new_weight">new_weight</code></td>
<td>
<p>Number with the weight for the new point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated design.
</p>

<hr>
<h2 id='update_design_total'>Merge close points of a design</h2><span id='topic+update_design_total'></span>

<h3>Description</h3>

<p>Takes a design and merge together all points that are closer between them than a certain threshold <code>delta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_design_total(design, delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_design_total_+3A_design">design</code></td>
<td>
<p>The design to update. It's a dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="update_design_total_+3A_delta">delta</code></td>
<td>
<p>Threshold which defines how close two points have to be to any of the existing ones in order to
merge with them.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated design.
</p>

<hr>
<h2 id='update_sequence'>Deletes duplicates points</h2><span id='topic+update_sequence'></span>

<h3>Description</h3>

<p>Within a vector of points, deletes points that are close enough (less than the tol parameter).
Returns the points without the &quot;duplicates&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_sequence(points, tol)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_sequence_+3A_points">points</code></td>
<td>
<p>Points to be updated</p>
</td></tr>
<tr><td><code id="update_sequence_+3A_tol">tol</code></td>
<td>
<p>Tolerance for which two points are considered the same</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The points without duplicates
</p>

<hr>
<h2 id='update_weights'>Update weight D-Optimality</h2><span id='topic+update_weights'></span>

<h3>Description</h3>

<p>Implementation of the weight update formula for D-Optimality used to optimize the weights of a design,
which is to be applied iteratively until no sizable changes happen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_weights(design, sens, k, delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_weights_+3A_design">design</code></td>
<td>
<p>Design to optimize the weights from. It's a dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="update_weights_+3A_sens">sens</code></td>
<td>
<p>Sensibility function for the design and model.</p>
</td></tr>
<tr><td><code id="update_weights_+3A_k">k</code></td>
<td>
<p>Number of parameters of the model.</p>
</td></tr>
<tr><td><code id="update_weights_+3A_delta">delta</code></td>
<td>
<p>A parameter of the algorithm that can be tuned. Must be <code class="reqn">0&lt; delta &lt; 1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the new weights of the design after one iteration.
</p>

<hr>
<h2 id='update_weightsDS'>Update weight Ds-Optimality</h2><span id='topic+update_weightsDS'></span>

<h3>Description</h3>

<p>Implementation of the weight update formula for Ds-Optimality used to optimize the weights of a design,
which is to be applied iteratively until no sizable changes happen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_weightsDS(design, sens, s, delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_weightsDS_+3A_design">design</code></td>
<td>
<p>Design to optimize the weights from. It's a dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="update_weightsDS_+3A_sens">sens</code></td>
<td>
<p>Sensibility function for the design and model.</p>
</td></tr>
<tr><td><code id="update_weightsDS_+3A_s">s</code></td>
<td>
<p>number of parameters of interest of the model</p>
</td></tr>
<tr><td><code id="update_weightsDS_+3A_delta">delta</code></td>
<td>
<p>A parameter of the algorithm that can be tuned. Must be <code class="reqn">0&lt; delta &lt; 1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the new weights of the design after one iteration.
</p>

<hr>
<h2 id='update_weightsI'>Update weight I-Optimality</h2><span id='topic+update_weightsI'></span>

<h3>Description</h3>

<p>Implementation of the weight update formula for I-Optimality used to optimize the weights of a design,
which is to be applied iteratively until no sizable changes happen. A-Optimality if instead of the
integral matrix the identity function is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_weightsI(design, sens, crit, delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_weightsI_+3A_design">design</code></td>
<td>
<p>Design to optimize the weights from. It's a dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="update_weightsI_+3A_sens">sens</code></td>
<td>
<p>Sensibility function for the design and model.</p>
</td></tr>
<tr><td><code id="update_weightsI_+3A_crit">crit</code></td>
<td>
<p>Value of the criterion function for I-Optimality.</p>
</td></tr>
<tr><td><code id="update_weightsI_+3A_delta">delta</code></td>
<td>
<p>A parameter of the algorithm that can be tuned. Must be <code class="reqn">0&lt; delta &lt; 1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the new weights of the design after one iteration.
</p>

<hr>
<h2 id='weight_function'>Weight function per distribution</h2><span id='topic+weight_function'></span>

<h3>Description</h3>

<p>Weight function per distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weight_function(model, char_vars, values, distribution = "Normal")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weight_function_+3A_model">model</code></td>
<td>
<p>formula describing the model to use. Must use x as the variable.</p>
</td></tr>
<tr><td><code id="weight_function_+3A_char_vars">char_vars</code></td>
<td>
<p>character vector with the parameters of the models, as written in the <code>formula</code></p>
</td></tr>
<tr><td><code id="weight_function_+3A_values">values</code></td>
<td>
<p>numeric vector with the parameters nominal values, in the same order as given in <code>parameters</code>.</p>
</td></tr>
<tr><td><code id="weight_function_+3A_distribution">distribution</code></td>
<td>
<p>character variable specifying the probability distribution of the response. Can be one of the following:
</p>

<ul>
<li><p> 'Normal', for normal homoscedastic (default)
</p>
</li>
<li><p> 'Gamma', which can be used for exponential or normal heteroscedastic with constant relative error
</p>
</li>
<li><p> 'Poisson'
</p>
</li>
<li><p> 'Logistic'
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>one variable function that represents the square of the structure of variance, in case of heteroscedastic variance of the response.
</p>

<hr>
<h2 id='WFMult'>Master function for the cocktail algorithm, that calls the appropriate one given the criterion.</h2><span id='topic+WFMult'></span>

<h3>Description</h3>

<p>Depending on the <code>criterion</code> the cocktail algorithm for the chosen criterion is called,
and the necessary parameters for the functions are given from the user input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WFMult(
  init_design,
  grad,
  criterion,
  par_int = NA,
  matB = NA,
  min,
  max,
  grid.length,
  join_thresh,
  delete_thresh,
  k,
  delta_weights,
  tol,
  tol2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WFMult_+3A_init_design">init_design</code></td>
<td>
<p>optional dataframe with the initial design for the algorithm. A dataframe with two columns:
</p>

<ul>
<li> <p><code>Point</code> contains the support points of the design.
</p>
</li>
<li> <p><code>Weight</code> contains the corresponding weights of the <code>Point</code>s.
</p>
</li></ul>
</td></tr>
<tr><td><code id="WFMult_+3A_grad">grad</code></td>
<td>
<p>function of partial derivatives of the model.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_criterion">criterion</code></td>
<td>
<p>character variable with the chosen optimality criterion. Can be one of the following:
</p>

<ul>
<li><p> 'D-Optimality'
</p>
</li>
<li><p> 'Ds-Optimality'
</p>
</li>
<li><p> 'A-Optimality'
</p>
</li>
<li><p> 'I-Optimality'
</p>
</li>
<li><p> 'L-Optimality'
</p>
</li></ul>
</td></tr>
<tr><td><code id="WFMult_+3A_par_int">par_int</code></td>
<td>
<p>numeric vector with the index of the <code>parameters</code> of interest. Only necessary when
the <code>criterion</code> chosen is 'Ds-Optimality'.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_matb">matB</code></td>
<td>
<p>optional matrix of dimensions k x k, for L-optimality.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_min">min</code></td>
<td>
<p>numeric value with the inferior bound of the space of the design.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_max">max</code></td>
<td>
<p>numeric value with the upper bound of the space of the design.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_grid.length">grid.length</code></td>
<td>
<p>numeric value that gives the grid to evaluate the sensitivity function when looking for a
maximum.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_join_thresh">join_thresh</code></td>
<td>
<p>numeric value that states how close, in real units, two points must be in order to
be joined together by the join heuristic.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_delete_thresh">delete_thresh</code></td>
<td>
<p>numeric value with the minimum weight, over 1 total, that a point needs to have
in order to not be deleted from the design.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_k">k</code></td>
<td>
<p>number of unknown parameters of the model.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_delta_weights">delta_weights</code></td>
<td>
<p>numeric value in (0, 1), parameter of the algorithm.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_tol">tol</code></td>
<td>
<p>numeric value for the convergence of the weight optimizing algorithm.</p>
</td></tr>
<tr><td><code id="WFMult_+3A_tol2">tol2</code></td>
<td>
<p>numeric value for the stop condition of the algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list correspondent to the output of the correspondent algorithm called, dependent on the criterion.
A list of two objects:
</p>

<ul>
<li><p> optdes: a dataframe with the optimal design in two columns, <code>Point</code> and <code>Weight</code>.
</p>
</li>
<li><p> sens: a plot with the sensitivity function to check for optimality of the design.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other cocktail algorithms: 
<code><a href="#topic+DWFMult">DWFMult</a>()</code>,
<code><a href="#topic+DsWFMult">DsWFMult</a>()</code>,
<code><a href="#topic+IWFMult">IWFMult</a>()</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
