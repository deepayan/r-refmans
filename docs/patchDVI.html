<!DOCTYPE html><html><head><title>Help for package patchDVI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {patchDVI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#patchDVI'><p>patch Sweave source references into .dvi file</p></a></li>
<li><a href='#defSconcordance'>
<p>Support for non-Sweave concordances.</p></a></li>
<li><a href='#DVIspecials'><p> Get and set DVI specials</p></a></li>
<li><a href='#knitInRStudio'>
<p>Trigger processing of chapter files from RStudio.</p></a></li>
<li><a href='#knitPDF'><p>Knit a File and Patch</p></a></li>
<li><a href='#needsPackages'>
<p>Check for and optionally install packages used by document.</p></a></li>
<li><a href='#patchLog'>
<p>Patch a LaTeX log file.</p></a></li>
<li><a href='#pdf_documentC'>
<p>R Markdown driver to add concordance</p></a></li>
<li><a href='#pdf_with_patches'>
<p>Convert an R Markdown pdf driver to one that handles concordances.</p></a></li>
<li><a href='#readDVI'><p> Demo function to read a .dvi file</p></a></li>
<li><a href='#renderPDF'><p>Render R Markdown and Patch</p></a></li>
<li><a href='#SweaveAll'>
<p>Apply Sweave to a collection of files.</p></a></li>
<li><a href='#SweaveMiktex'><p>Run Sweave and Patch</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Package to Patch '.dvi' or '.synctex' Files</td>
</tr>
<tr>
<td>Version:</td>
<td>1.11.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Duncan Murdoch</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Duncan Murdoch &lt;murdoch.duncan@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to patch specials in '.dvi' files,
        or entries in '.synctex' files.  Works with concordance=TRUE 
        in Sweave, knitr or R Markdown to link sources to previews.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, tools, RmdConcord</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.42.0), rmarkdown</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>The 'Japanese.Rnw' vignette requires uplatex and
dvipdfmx.</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown, patchDVI</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/dmurdoch/patchDVI">https://github.com/dmurdoch/patchDVI</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dmurdoch/patchDVI/issues">https://github.com/dmurdoch/patchDVI/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-14 16:17:50 UTC; murdoch</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-14 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='patchDVI'>patch Sweave source references into .dvi file</h2><span id='topic+patchDVI'></span><span id='topic+patchSynctex'></span><span id='topic+patchDVI-package'></span>

<h3>Description</h3>

<p>This package allows
source references in .dvi files to refer to the actual source file,
rather than the intermediate .tex file.  Dvi previewers such as yap
and xdvi can make use of these source references to jump directly
to the part of a document corresponding to a particular source line, and
the previewer can send messages to editors to jump to the source
corresponding to a location in the preview.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patchDVI(f, newname = f, patchLog = TRUE)
patchSynctex(f, newname=f, uncompress="pdftk %s output %s uncompress",
	     fromDVI = NULL, patchLog = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="patchDVI_+3A_f">f</code></td>
<td>
<p> A character value giving the name of the .dvi or .synctex file to patch </p>
</td></tr>
<tr><td><code id="patchDVI_+3A_newname">newname</code></td>
<td>
<p> Output will go to this file; by default to overwrite the original </p>
</td></tr>
<tr><td><code id="patchDVI_+3A_patchlog">patchLog</code></td>
<td>
<p> Whether to attempt to patch the &lsquo;<span class="file">.log</span>&rsquo; file </p>
</td></tr>
<tr><td><code id="patchDVI_+3A_uncompress">uncompress</code></td>
<td>
<p> External command to uncompress a compressed PDF file </p>
</td></tr>
<tr><td><code id="patchDVI_+3A_fromdvi">fromDVI</code></td>
<td>
<p> Name of DVI file in which to find concordance </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function works with <code>Sweave</code> with option <code>concordance=TRUE</code>
and some related functions.
</p>
<p>Using <code>patchDVI</code> requires a change to the usual Sweave workflow, as follows:
</p>
<p>1.  Write the source file in .Rnw.  Include the </p>
<pre>\SweaveOpts{concordance=TRUE}</pre><p> option to
enable the patching.
</p>
<p>2.  Use Sweave to convert the file to .tex format.
</p>
<p>3.  Use latex to process the .tex file into a .dvi file or .pdf file.
</p>
<p>4.  Run <code>patchDVI</code> on the .dvi file or the .synctex file to patch in the Rnw links.
</p>
<p>5.  Use the previewer on the patched .dvi file or the original .pdf file.
</p>
<p>All the information needed for the patching is stored in the .dvi file, so these 5 steps
can be run from the command line, there's no need to keep an R session running (though they'll
all work from within one session as well).  At some distant date in the future maybe
the previewers will learn how to read the concordance info, and step 4 will no longer be
necessary.
</p>
<p>The <code>patchLog</code> option makes use of the new <code><a href="#topic+patchLog">patchLog</a></code> function.
</p>


<h3>Value</h3>

<p>A string containing a message about what was done.
</p>


<h3>Note</h3>

<p>In a .dvi file, the concordance is stored in a TeX &quot;special&quot; in the following format (as of version 0.5):
<code>concordance:&lt;oldname&gt;:&lt;newname&gt;:&lt;firstline&gt; &lt;rle pairs&gt;*</code>.  Here <code>&lt;oldname&gt;</code>
is the name of the .tex file to replace, <code>&lt;newname&gt;</code> is the name of the .Rnw file
to substitute for it, and <code>&lt;firstline&gt;</code> is the line number from the .Rnw file of the
first line in the .tex file.
</p>
<p>The <code>&lt;rle pairs&gt;</code> are a sequence of pairs
(length, value), separated by spaces (no parentheses), with the length indicating
the number of repetitions of the value.  Using <code><a href="base.html#topic+inverse.rle">inverse.rle</a></code> these are converted
to a sequence of differences in the line numbers of the concordance.
</p>
<p>Since colons are used to delimit the elements, they must not be used
in <code>&lt;oldname&gt;</code> or <code>&lt;newname&gt;</code>:  names like
&lsquo;<span class="file">C:/source.Rnw</span>&rsquo; will not work.
</p>
<p>For example, a concordance might contain
</p>
<pre>\Sconcordance{\concordance:optimization.tex:optimization.Rnw:1 2 1 2 4 39 1 1 4 ...}</pre>
<p>saying that source references to optimization.tex should be replaced with
optimization.Rnw.  Line 1 of the .tex file corresponds to line 1 of the .Rnw file.
The diffs for successive lines are <code>1 1 4 4 1 &lt;repeated 39 times&gt; 4 ...</code>, so
the corresponding lines in the .Rnw file (including the first) are <code>1 2 3 7 11 12 13 ...</code>.
</p>
<p>The same format is used in a stream object in a .pdf file. (Version 2.12.2 and
earlier of R used a different format which was actually invalid according to
the PDF specification.)  This is not always
successfully read by the patching code, because some versions of <code>pdflatex</code>
compress parts of the file, and <code>patchDVI</code> currently can't read compressed parts
of files.  We suggest installing the <code>pdftk</code> open source PDF toolkit
(available from <a href="https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/">https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/</a>) to decompress
the file; <code>patchSynctex</code> will make use of it
if found.  The <code>uncompress</code> argument can be modified to call a different
uncompress utility.  The Latex commands
<code style="white-space: pre;">&#8288;\pdfcompresslevel=0\pdfobjcompresslevel=0&#8288;</code> at the start
of your document instruct <code>pdflatex</code> not to compress the file, but
some Latex packages (e.g. beamer) will override these settings.
</p>
<p>If your workflow involves using <code>latex</code> and <code>dvipdfm</code>, then you will
need a recent enough version of <code>latex</code> that supports the <code>-synctex=1</code>
option, and then you can specify the name of the &lsquo;<span class="file">.dvi</span>&rsquo; file
in the <code>fromDVI</code> argument.
</p>
<p>This format is subject to change in future R releases.
</p>


<h3>Author(s)</h3>

<p> Duncan Murdoch </p>


<h3>References</h3>

<p> The yap previewer is part of MikTeX, from www.miktex.org. </p>


<h3>See Also</h3>

<p><code><a href="#topic+DVIspecials">DVIspecials</a></code> for the function to read .dvi files,
<code><a href="#topic+SweaveMiktex">SweaveMiktex</a></code> for a simple script to run Sweave, MikTeX and patchDVI.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
patchDVI("mypaper.dvi")

## End(Not run)
</code></pre>

<hr>
<h2 id='defSconcordance'>
Support for non-Sweave concordances.
</h2><span id='topic+defSconcordance'></span><span id='topic+useknitr'></span>

<h3>Description</h3>

<p>Sweave automatically inserts concordances into the output file,
so they will be embedded in the &lsquo;<span class="file">.dvi</span>&rsquo; or &lsquo;<span class="file">.pdf</span>&rsquo; output using the LaTeX macro <code style="white-space: pre;">&#8288;\Sconcordance&#8288;</code> from
the &lsquo;<span class="file">Sweave.sty</span>&rsquo; style file.
Other vignette processing engines (e.g. knitr) do not 
use &lsquo;<span class="file">Sweave.sty</span>&rsquo;, so <code>defSconcordance</code>
defines the macro explicitly.
</p>
<p>The <code>useknitr</code> function is specific to knitr documents.
If <code>writeMacro</code> is <code>TRUE</code>, it calls <code>defSconcordance</code>
to write the macro definition to the output file.  If <code>writeMacro</code> is not specified, it guesses the value by looking for 
<code style="white-space: pre;">&#8288;\begin{document}&#8288;</code> somewhere in the first 100 lines of the 
file.  
It always writes the <code style="white-space: pre;">&#8288;\input&#8288;</code> line for the concordances into the file. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defSconcordance()
useknitr(writeMacro)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="defSconcordance_+3A_writemacro">writeMacro</code></td>
<td>

<p>logical; whether to call defSconcordance
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is not necessary when using Sweave, it is only for other vignette engines.
</p>
<p>With knitr, the concordances would be written to a file with a
name typically be of the form &lsquo;<span class="file">basename-concordance.tex</span>&rsquo;, where
the input file was &lsquo;<span class="file">basename.Rnw</span>&rsquo;.  You would insert it with code like
</p>
<pre>
&lt;&lt;results="asis"&gt;&gt;=
patchDVI::useknitr()
@
</pre>
<p>If the document does use the &lsquo;<span class="file">Sweave.sty</span>&rsquo; style, or if it
is being included in another larger document, do 
not use <code>defSconcorance</code>:  this can be forced by
calling <code>patchDVI::useknitr(writeMacro = FALSE)</code>.
</p>


<h3>Value</h3>

<p>These functions are called for the side effect of writing
out the LaTeX code.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>


<h3>Examples</h3>

<pre><code class='language-R'>defSconcordance()
</code></pre>

<hr>
<h2 id='DVIspecials'> Get and set DVI specials </h2><span id='topic+DVIspecials'></span><span id='topic+setDVIspecials'></span>

<h3>Description</h3>

<p>These functions get and set the \specials values in .dvi files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DVIspecials(f)
setDVIspecials(f, newspecials, newname=f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DVIspecials_+3A_f">f</code></td>
<td>
<p> character filename of .dvi file to patch </p>
</td></tr>
<tr><td><code id="DVIspecials_+3A_newspecials">newspecials</code></td>
<td>
<p> character vector of new specials to put into the file </p>
</td></tr>
<tr><td><code id="DVIspecials_+3A_newname">newname</code></td>
<td>
<p> the name of the file to write </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If an entry of the <code>newspecials</code> vector is <code>NA</code>, that special
is removed.  
</p>


<h3>Value</h3>

<p><code>DVIspecials</code> returns all the specials from the file in a character vector.
</p>
<p><code>setDVIspecials</code> is called for the side effect of patching the .dvi file;
it returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p> Duncan Murdoch </p>


<h3>See Also</h3>

 <p><code><a href="#topic+patchDVI">patchDVI</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
x &lt;- DVIspecials("test.dvi")
x[1] &lt;- "new value"
setDVIspecials("test.dvi", x)

## End(Not run)
</code></pre>

<hr>
<h2 id='knitInRStudio'>
Trigger processing of chapter files from RStudio.
</h2><span id='topic+knitInRStudio'></span>

<h3>Description</h3>

<p>If this function is executed within RStudio, it will 
knit all child 
from the main file 
of a large &lsquo;<span class="file">.Rnw</span>&rsquo;-style knitr document.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>knitInRStudio(SweaveFiles, force = FALSE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="knitInRStudio_+3A_sweavefiles">SweaveFiles</code></td>
<td>

<p>The files to process.  If missing, the value is set
from a <code>.SweaveFiles</code> variable in the global environment.
</p>
</td></tr>
<tr><td><code id="knitInRStudio_+3A_force">force</code></td>
<td>

<p>If <code>TRUE</code>, all files are knitted; otherwise, only those
that are newer than the corresponding &lsquo;<span class="file">.tex</span>&rsquo; file.
</p>
</td></tr>
<tr><td><code id="knitInRStudio_+3A_verbose">verbose</code></td>
<td>

<p>Add some debugging information to the output.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This does nothing if not run from within RStudio.  If run
there, it starts a second R process to do the knitting.  It's 
assumed that this call will exist in a code chunk in another
knitr document.
</p>
<p>Set <code>childOutput = TRUE</code> in the options to the code
chunk containing this if you wish to see the output of the
child knitr runs in the same log as the main one.
</p>


<h3>Value</h3>

<p>The concatenated output from the child knitting, and
possibly some verbose output.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>


<h3>See Also</h3>

<p><code><a href="#topic+knitAll">knitAll</a></code>, which does a similar thing outside
of RStudio.
</p>

<hr>
<h2 id='knitPDF'>Knit a File and Patch</h2><span id='topic+knitMiktex'></span><span id='topic+knitPDFMiktex'></span><span id='topic+knitDVI'></span><span id='topic+knitPDF'></span><span id='topic+knitDVIPDFM'></span>

<h3>Description</h3>

<p>This is a simple script to run knit, then LaTeX, then patchDVI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>knitMiktex(Rnw, main,
    weave = knitr::knit,
    ...)

knitPDFMiktex(Rnw, main,
    weave = knitr::knit,
    ...)

knitDVI(Rnw, main,
    weave = knitr::knit,
    ...)

knitPDF(Rnw, main,
    weave = knitr::knit,
    ...)

knitDVIPDFM(Rnw, main,
    weave = knitr::knit,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="knitPDF_+3A_rnw">Rnw</code></td>
<td>
<p> The .Rnw input file </p>
</td></tr>
<tr><td><code id="knitPDF_+3A_main">main</code></td>
<td>
<p> The .tex file on which to run latex, defaulting to the output file from Sweave </p>
</td></tr>
<tr><td><code id="knitPDF_+3A_weave">weave</code></td>
<td>
<p> The function to carry out the weaving. </p>
</td></tr>
<tr><td><code id="knitPDF_+3A_...">...</code></td>
<td>
<p> See Details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>...</code> arguments are passed to the corresponding <code><a href="#topic+SweavePDF">Sweave*</a></code> function.
</p>
<p>If the <code>Rnw</code> argument is a filename ending in &lsquo;<span class="file">.tex</span>&rsquo;, then
knitting is skipped, but the output file is still patched (because
one of the other files in the project might have come from knitr).
</p>


<h3>Value</h3>

<p>These functions are run for the side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
knitPDF("chapter.Rnw", "book.tex")

## End(Not run)
</code></pre>

<hr>
<h2 id='needsPackages'>
Check for and optionally install packages used by document.
</h2><span id='topic+needsPackages'></span>

<h3>Description</h3>

<p>This function checks for needed packages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>needsPackages(pkgs, install = TRUE, 
                    update = FALSE, 
                    load = FALSE, 
                    attach = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="needsPackages_+3A_pkgs">pkgs</code></td>
<td>

<p>A list of names of packages to check.
</p>
</td></tr>
<tr><td><code id="needsPackages_+3A_install">install</code></td>
<td>

<p>Whether to install missing packages.
</p>
</td></tr>
<tr><td><code id="needsPackages_+3A_update">update</code></td>
<td>

<p>Whether to update all packages that can be updated.
</p>
</td></tr>
<tr><td><code id="needsPackages_+3A_load">load</code></td>
<td>

<p>Whether to load namespaces for packages.
</p>
</td></tr>
<tr><td><code id="needsPackages_+3A_attach">attach</code></td>
<td>

<p>Whether to run library calls.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each of the boolean arguments can be a vector
of the same length as <code>pkgs</code>, applying separately
to each entry.
</p>


<h3>Value</h3>

<p>Called for the side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This shouldn't do anything, as patchDVI must already be
# installed!
needsPackages("patchDVI")
</code></pre>

<hr>
<h2 id='patchLog'>
Patch a LaTeX log file.
</h2><span id='topic+patchLog'></span>

<h3>Description</h3>

<p>This function parses a standard LaTeX log file and applies
patches to it based on an Sweave concordance, so that error
messages and warnings refer to the &lsquo;<span class="file">.Rnw</span>&rsquo; file rather than the
&lsquo;<span class="file">.tex</span>&rsquo; file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patchLog(f, newname = f, concords = NULL, max_print_line = 79, Cstyle = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="patchLog_+3A_f">f</code></td>
<td>

<p>The filename of the log file.
</p>
</td></tr>
<tr><td><code id="patchLog_+3A_newname">newname</code></td>
<td>

<p>The filename to write the patched file to.
</p>
</td></tr>
<tr><td><code id="patchLog_+3A_concords">concords</code></td>
<td>

<p>Concordances read from the &lsquo;<span class="file">.dvi</span>&rsquo; or &lsquo;<span class="file">.pdf</span>&rsquo;.  If <code>NULL</code>,
an attempt is made to read these from the source.
</p>
</td></tr>
<tr><td><code id="patchLog_+3A_max_print_line">max_print_line</code></td>
<td>

<p>The line length at which the latex compiler will wrap error messages.
</p>
</td></tr>
<tr><td><code id="patchLog_+3A_cstyle">Cstyle</code></td>
<td>

<p>If <code>TRUE</code>, only look for C-style error messages <code>"filename:num: msg"</code>.
If <code>FALSE</code>, look for classic messages <code>"! msg"</code>.  If
<code>NA</code>, look for both, pick the more popular style.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parsing is based on the log parser written by 
Jonathan Kew, Stefan Löffler, Antonio Macrì, and Henrik Skov Midtiby for 
TeXWorks.  That parser assumes error lines are reported in the standard format;
C style errors are not currently supported.  <code>patchLog</code>
can detect C style errors, but standard format is assumed by
default, and is preferred.
</p>


<h3>Value</h3>

<p>This function is called mainly for the side effect of writing the
new log file.  It returns the <code>concords</code> object invisibly.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>


<h3>See Also</h3>

<p><code><a href="#topic+patchDVI">patchDVI</a></code>, <code><a href="#topic+patchSynctex">patchSynctex</a></code>
</p>

<hr>
<h2 id='pdf_documentC'>
R Markdown driver to add concordance
</h2><span id='topic+pdf_documentC'></span>

<h3>Description</h3>

<p>This drivers replace the like-named <span class="pkg">rmarkdown</span>
driver with one that outputs Commonmark rather than Pandoc Markdown.
Commonmark is a dialect of Markdown for which the Pandoc driver
for Commonmark supports output of source position information.
By using this function as your output driver, you can get that
in your own documents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdf_documentC(latex_engine = "pdflatex",
           sourcepos = TRUE,
           defineSconcordance = TRUE,
           run_latex = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pdf_documentC_+3A_latex_engine">latex_engine</code></td>
<td>

<p>Command to convert &lsquo;<span class="file">.tex</span>&rsquo; file to &lsquo;<span class="file">.pdf</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="pdf_documentC_+3A_sourcepos">sourcepos</code></td>
<td>

<p>Whether to include source position information.
</p>
</td></tr>
<tr><td><code id="pdf_documentC_+3A_definesconcordance">defineSconcordance</code></td>
<td>

<p>If <code>TRUE</code>, insert a definition of the <code style="white-space: pre;">&#8288;\Sconcordance&#8288;</code>
macro just before <code style="white-space: pre;">&#8288;\begin{document}&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="pdf_documentC_+3A_run_latex">run_latex</code></td>
<td>

<p>Whether to run the <code>latex_engine</code> to produce a PDF.
</p>
</td></tr>
<tr><td><code id="pdf_documentC_+3A_...">...</code></td>
<td>

<p>Other arguments to pass to the base driver.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This driver modifies the standard <span class="pkg">rmarkdown</span> driver <code><a href="rmarkdown.html#topic+pdf_document">pdf_document</a></code>, but uses Commonmark
and adds concordances.
</p>


<h3>Value</h3>

<p>An R Markdown output format object which will add concordance
information.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>

<hr>
<h2 id='pdf_with_patches'>
Convert an R Markdown pdf driver to one that handles concordances.
</h2><span id='topic+pdf_with_patches'></span>

<h3>Description</h3>

<p>This function produces a new driver which matches the old
one in most respects, but adds an argument <code>sourcepos</code>
(and possibly others).
If that argument is <code>TRUE</code> (the default) then concordances
are handled by the new driver.
</p>
<p>This is used to produce <code><a href="#topic+pdf_documentC">pdf_documentC</a></code>
in this package, and should also work on other drivers that produce
PDF output using Pandoc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdf_with_patches(driver)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pdf_with_patches_+3A_driver">driver</code></td>
<td>

<p>An R Markdown driver that produces HTML, LaTeX or PDF using Pandoc.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function makes use of the <code>RmdConcord::<a href="RmdConcord.html#topic+pdf_with_concordance">pdf_with_concordance</a></code>
function.  That function adds concordances
to the output of the original driver; this function patches the PDF file so that
source references in it refer to the original
source file.
</p>


<h3>Value</h3>

<p>A new driver function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pdf_with_patches(rmarkdown::latex_fragment)
</code></pre>

<hr>
<h2 id='readDVI'> Demo function to read a .dvi file </h2><span id='topic+readDVI'></span>

<h3>Description</h3>

<p>This is an R function that reads a .dvi file (it was the prototype
for <code><a href="#topic+DVIspecials">DVIspecials</a></code>).  Modify it to see other parts
of a .dvi.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readDVI(f, show=c("bop", "special", "fntdef", "preamble"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readDVI_+3A_f">f</code></td>
<td>
<p> filename </p>
</td></tr>
<tr><td><code id="readDVI_+3A_show">show</code></td>
<td>
<p> which type of records to print </p>
</td></tr>
</table>


<h3>Value</h3>

<p>readDVI prints as it reads, it doesn't return anything useful.  
</p>

<hr>
<h2 id='renderPDF'>Render R Markdown and Patch</h2><span id='topic+renderMiktex'></span><span id='topic+renderPDFMiktex'></span><span id='topic+renderDVI'></span><span id='topic+renderPDF'></span><span id='topic+renderDVIPDFM'></span>

<h3>Description</h3>

<p>These are simple scripts to render, then run LaTeX, then patch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
renderMiktex(Rmd, main,
    weave = rmarkdown::render,
    ...)

renderPDFMiktex(Rmd, main,
    weave = rmarkdown::render,
    ...)

renderDVI(Rmd, main,
    weave = rmarkdown::render,
    ...)

renderPDF(Rmd, main,
    weave = rmarkdown::render,
    ...)

renderDVIPDFM(Rmd, main,
    weave = rmarkdown::render,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="renderPDF_+3A_rmd">Rmd</code></td>
<td>
<p> The .Rmd input file </p>
</td></tr>
<tr><td><code id="renderPDF_+3A_main">main</code></td>
<td>
<p> The .tex file on which to run latex, defaulting to the output file from Sweave </p>
</td></tr>
<tr><td><code id="renderPDF_+3A_weave">weave</code></td>
<td>
<p> The function to carry out the weaving. </p>
</td></tr>
<tr><td><code id="renderPDF_+3A_...">...</code></td>
<td>
<p> See Details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>...</code> arguments are passed to the corresponding <code><a href="#topic+SweavePDF">Sweave*</a></code> function.
</p>
<p>If the <code>Rmd</code> argument is a filename ending in &lsquo;<span class="file">.tex</span>&rsquo;, then
knitting is skipped, but the output file is still patched (because
one of the other files in the project might have come from R Markdown).
</p>


<h3>Value</h3>

<p>These functions are run for the side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
renderPDF("chapter.Rnw", "book.tex")

## End(Not run)
</code></pre>

<hr>
<h2 id='SweaveAll'>
Apply Sweave to a collection of files.
</h2><span id='topic+SweaveAll'></span><span id='topic+knitAll'></span><span id='topic+renderAll'></span><span id='topic+.SweaveFiles'></span><span id='topic+.TexRoot'></span><span id='topic+.PostSweaveHook'></span>

<h3>Description</h3>

<p>This function allows a master Sweave input file to specify other files in the
project.  All modified files will be run through <code><a href="utils.html#topic+Sweave">Sweave</a></code>.  Following
the run, several post-processing steps may be performed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SweaveAll(SweaveFiles, make = 1, PostSweaveHook = NULL,
          force = TRUE, verbose = FALSE,
          weave = utils::Sweave, ...)
knitAll(RnwFiles, make = 1, PostKnitHook = NULL,
          force = TRUE, verbose = FALSE,
          weave = knitr::knit, ...)
renderAll(RmdFiles = NULL, make = 1, PostKnitHook = NULL,
          force = TRUE, verbose = FALSE,
          weave = rmarkdown::render, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SweaveAll_+3A_sweavefiles">SweaveFiles</code>, <code id="SweaveAll_+3A_rnwfiles">RnwFiles</code>, <code id="SweaveAll_+3A_rmdfiles">RmdFiles</code></td>
<td>
<p>character vector naming the files to
run through <code>weave</code>.
</p>
</td></tr>
<tr><td><code id="SweaveAll_+3A_make">make</code></td>
<td>

<p>integer indicating which files to run <code>weave</code> on.  See below.
</p>
</td></tr>
<tr><td><code id="SweaveAll_+3A_postsweavehook">PostSweaveHook</code>, <code id="SweaveAll_+3A_postknithook">PostKnitHook</code></td>
<td>

<p>default hook to be called after each <code>weave</code> call.  See below.
</p>
</td></tr>
<tr><td><code id="SweaveAll_+3A_force">force</code></td>
<td>

<p>If <code>TRUE</code>, all files in <code>SweaveFiles</code> will be run,
otherwise only those which are newer than the corresponding &lsquo;<span class="file">.tex</span>&rsquo; file.
</p>
</td></tr>
<tr><td><code id="SweaveAll_+3A_verbose">verbose</code></td>
<td>

<p>Mainly for debugging:  print progress messages.
</p>
</td></tr>
<tr><td><code id="SweaveAll_+3A_weave">weave</code></td>
<td>

<p>The function to be used for converting from source to &lsquo;<span class="file">.tex</span>&rsquo;.
It will be called as <code>weave(filename, ...)</code> for each file
in <code>SweaveFiles</code> and other files identified as needing weaving.
</p>
</td></tr>
<tr><td><code id="SweaveAll_+3A_...">...</code></td>
<td>

<p>Extra parameters to pass to <code>weave</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs <code>weave</code> repeatedly. It starts by
checking for a global variable <code>.SweaveFiles</code>, and
augments the <code>SweaveFiles</code> argument with any unprocessed
files in that list.  It then runs <code>weave</code>
on each file listed in <code>SweaveFiles</code>.
</p>
<p>Before each run, it removes the global variables
<code>.PostSweaveHook</code>, <code>.SweaveFiles</code>, and <code>.TexRoot</code>.  The
individual Sweave files may set these variables to control post-
processing as described below.
</p>
<p>Following each run, <code>SweaveAll</code> checks whether the code
chunks created a variable <code>.PostSweaveHook</code> in the global
environment.  If present, it should be a function (or the name of a
function; <code><a href="base.html#topic+match.fun">match.fun</a></code> is used to do the lookup) taking a
single argument.  If not present, the <code>PostSweaveHook</code>
(or <code>PostKnitHook</code>) argument
will be used as a default.  <code>SweaveAll</code> will pass the name of the
&lsquo;<span class="file">.tex</span>&rsquo; output file to this function, which can do any required
postprocessing.  For example, we have used it to remove local
pathnames from output strings.
</p>
<p><code>SweaveAll</code> then checks again for <code>.SweaveFiles</code>, which if present
should be a character vector of filenames.  These are collected, and
after the <code>Sweave</code> runs specified by <code>SweaveFiles</code>, the
<code>make</code> parameter controls which other files are run.  The default
value of <code>1</code> works as follows:  any new files added via
<code>.SweaveFiles</code> that were not already processed are checked. If
they are newer than the corresponding &lsquo;<span class="file">.tex</span>&rsquo; file, or the
&lsquo;<span class="file">.tex</span>&rsquo; file does not exist, they are processed.  They may also
return new filenames in the global <code>.SweaveFiles</code> variable and
those will be processed as well.
</p>
<p>Setting <code>make = 2</code> forces all mentioned files to be processed.
With <code>make = 0</code>, only the original vector of files passed to
<code>SweaveAll</code> will be processed.
</p>
<p><code>SweaveAll</code> also checks for a global variable named <code>.TexRoot</code>.
If present, it will be placed in the first position in the result vector.
(If it was already in the vector, later copies will be removed.)
</p>


<h3>Value</h3>

<p>The names of all files produced.  The first element of
<code>Sweavefiles</code> will produce the first element of the result if
<code>.TexRoot</code> was not specified; other elements will depend on which
files were processed.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Run Sweave on a main file, and obtain other files from there.
SweaveAll("main.Rnw")

# Run knitr on the same file.
SweaveAll("main.Rnw", weave = knitr::knit)

## End(Not run)</code></pre>

<hr>
<h2 id='SweaveMiktex'>Run Sweave and Patch</h2><span id='topic+SweaveMiktex'></span><span id='topic+SweavePDFMiktex'></span><span id='topic+SweaveDVI'></span><span id='topic+SweavePDF'></span><span id='topic+SweaveDVIPDFM'></span>

<h3>Description</h3>

<p>This is a simple script to run Sweave, then convert the LaTeX file,
then patch it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
SweaveMiktex(Rnw, main,
    cmd = "texify",
    options = "--tex-option=-src-specials --tex-option=-interaction=nonstopmode",
    includedir = "--tex-option=--include-directory=",
    stylepath = FALSE,
    source.code = NULL,
    make = 1,
    preview = 'yap "%s"',
    patchLog=TRUE,
    sleep = 0, ...)

SweavePDFMiktex(Rnw, main,
    cmd = "texify --pdf",
    options = "--tex-option=-synctex=-1 --tex-option=-interaction=nonstopmode",
    includedir = "--tex-option=-include-directory=",
    stylepath = FALSE,
    source.code = NULL,
    make = 1,
    preview = NULL,
    patchLog = TRUE,
    sleep = 0, ...)

SweaveDVI(Rnw, main,
    texinputs = NULL,
    source.code = NULL,
    make = 1,
    links = NULL,
    preview = NULL,
    patchLog = TRUE, ...)

SweavePDF(Rnw, main,
    texinputs = NULL,
    source.code = NULL,
    make = 1,
    links = NULL,
    preview = NULL,
    patchLog = TRUE, ...)

SweaveDVIPDFM(Rnw, main,
    latex = "latex", latexOpts = "-synctex=1 -interaction=nonstopmode",
    dvipdfm = "dvipdfm", dvipdfmOpts = "",
    texinputs = NULL,
    source.code = NULL,
    make = 1,
    preview = NULL,
    patchLog = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SweaveMiktex_+3A_rnw">Rnw</code></td>
<td>
<p> The .Rnw input file </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_main">main</code></td>
<td>
<p> The .tex file on which to run latex, defaulting to the output file from Sweave </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_cmd">cmd</code></td>
<td>
<p> The LaTeX command to run </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_options">options</code></td>
<td>
<p> Options to pass to LaTeX </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_includedir">includedir</code></td>
<td>
<p> The prefix for an option to give the location of Sweave.sty </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_stylepath">stylepath</code></td>
<td>
 <p><code>stylepath</code> argument to pass to <code><a href="utils.html#topic+Sweave">Sweave</a></code> </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_source.code">source.code</code></td>
<td>
<p> If not <code>NULL</code>, a filename to source before running <code><a href="utils.html#topic+Sweave">Sweave</a></code> </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_make">make</code></td>
<td>
<p> Value to pass to <code><a href="#topic+SweaveAll">SweaveAll</a></code> to control which Sweave files are processed </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_preview">preview</code></td>
<td>
<p> Command to use to preview result, or <code>NULL</code> for no preview </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_patchlog">patchLog</code></td>
<td>
<p> Whether to attempt to patch the console log and &lsquo;<span class="file">.log</span>&rsquo; file </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_sleep">sleep</code></td>
<td>
<p> Number of seconds to sleep if an error is detected in the run </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_texinputs">texinputs</code></td>
<td>
<p> Extra paths to pass to <code><a href="tools.html#topic+texi2dvi">texi2dvi</a></code> </p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_links">links</code></td>
<td>
<p> If not <code>NULL</code>, an option to turn on production of source links
via Synctex or source specials</p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_latex">latex</code>, <code id="SweaveMiktex_+3A_latexopts">latexOpts</code></td>
<td>
<p> The function to call to convert the &lsquo;<span class="file">.tex</span>&rsquo; to &lsquo;<span class="file">.dvi</span>&rsquo;,
and options to put on the command line.</p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_dvipdfm">dvipdfm</code>, <code id="SweaveMiktex_+3A_dvipdfmopts">dvipdfmOpts</code></td>
<td>
<p> The function to call to convert the &lsquo;<span class="file">.dvi</span>&rsquo; to &lsquo;<span class="file">.pdf</span>&rsquo;,
and options to put on the command line.</p>
</td></tr>
<tr><td><code id="SweaveMiktex_+3A_...">...</code></td>
<td>
<p> Additional options to pass to <code><a href="#topic+SweaveAll">SweaveAll</a></code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code>Rnw</code> argument is a filename ending in &lsquo;<span class="file">.tex</span>&rsquo;, then
weaving is skipped, but the &lsquo;<span class="file">.dvi</span>&rsquo; file is still patched (because
one of the other files in the project might have come from Sweave).
</p>
<p>The <code>source.code</code> argument may be used to temporarily install code before
running the document through the weaver (e.g. <code><a href="utils.html#topic+Sweave">Sweave</a></code>).
It could install
an experimental version of <code><a href="utils.html#topic+Sweave">Sweave</a></code>, or set up some variables
to be used by other code chunks, etc.  (Note that things are sourced locally,
whereas <code><a href="utils.html#topic+Sweave">Sweave</a></code> runs things in the global environment,
so the file will need to make explicit assignments there, and it should
avoid using names that clash with the argument names to <code>SweaveMiktex</code>
or <code>SweavePDFMiktex</code>.)
</p>
<p>The functions invoke Latex differently.  <code>SweaveMiktex</code> is designed
to call Miktex's <code>texify</code> command to produce a &lsquo;<span class="file">.dvi</span>&rsquo; file.  <code>SweavePDFMiktex</code>
does the same, but produces a &lsquo;<span class="file">.pdf</span>&rsquo;.  <code>SweaveDVI</code> and <code>SweavePDF</code>
are similar, but use a modified version of <span class="rlang"><b>R</b></span>'s <code><a href="tools.html#topic+texi2dvi">texi2dvi</a></code>
function to invoke Latex. <code>SweaveDVIPDFM</code> does the conversion to
&lsquo;<span class="file">.pdf</span>&rsquo; in two stages.
</p>
<p>The <code>patchLog</code> option makes use of the new <code><a href="#topic+patchLog">patchLog</a></code> function.
</p>


<h3>Value</h3>

<p>These functions are run for the side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
SweaveMiktex("chapter.Rnw", "book.tex")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
