<!DOCTYPE html><html lang="en-US"><head><title>Help for package canaper</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {canaper}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#canaper-package'><p>canaper: Categorical Analysis of Neo- And Paleo-Endemism</p></a></li>
<li><a href='#acacia'><p><em>Acacia</em> example data</p></a></li>
<li><a href='#biod_example'><p>Biodiverse example data</p></a></li>
<li><a href='#biod_results'><p>Output from Biodiverse</p></a></li>
<li><a href='#cpr_classify_endem'><p>Classify phylogenetic endemism</p></a></li>
<li><a href='#cpr_classify_signif'><p>Classify statistical significance</p></a></li>
<li><a href='#cpr_endem_cols'><p>CVD-friendly color palette for plotting results of CANAPE</p></a></li>
<li><a href='#cpr_endem_cols_2'><p>CVD-friendly color palette for plotting results of CANAPE, version 2</p></a></li>
<li><a href='#cpr_endem_cols_3'><p>CVD-friendly color palette for plotting results of CANAPE, version 3</p></a></li>
<li><a href='#cpr_endem_cols_4'><p>CVD-friendly color palette for plotting results of CANAPE, version 4</p></a></li>
<li><a href='#cpr_iter_sim'><p>Simulate the number of iterations needed to generate a random community that</p>
is sufficiently different from the original community</a></li>
<li><a href='#cpr_make_pal'><p>Make a palette of colors for plotting CANAPE results</p></a></li>
<li><a href='#cpr_rand_comm'><p>Randomize a single community matrix</p></a></li>
<li><a href='#cpr_rand_test'><p>Run a randomization analysis for one or more biodiversity metrics</p></a></li>
<li><a href='#cpr_signif_cols'><p>CVD-friendly color palette for plotting results of randomization test</p></a></li>
<li><a href='#cpr_signif_cols_2'><p>CVD-friendly color palette for plotting results of randomization test,</p>
version 2</a></li>
<li><a href='#mishler_endem_cols'><p>Original color palette for plotting results of CANAPE</p></a></li>
<li><a href='#mishler_signif_cols'><p>Original color palette for plotting results of CANAPE</p></a></li>
<li><a href='#phylocom'><p>Phylocom example data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Categorical Analysis of Neo- And Paleo-Endemism</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to analyze the spatial distribution of
    biodiversity, in particular categorical analysis of neo- and paleo-endemism
    (CANAPE) as described in Mishler et al (2014) &lt;<a href="https://doi.org/10.1038%2Fncomms5473">doi:10.1038/ncomms5473</a>&gt;.
    'canaper' conducts statistical tests to determine the types of endemism that
    occur in a study area while accounting for the evolutionary relationships of
    species.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ropensci/canaper">https://github.com/ropensci/canaper</a>,
<a href="https://docs.ropensci.org/canaper/">https://docs.ropensci.org/canaper/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/canaper/issues">https://github.com/ropensci/canaper/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, assertr, assertthat, dplyr, future.apply, phyloregion,
progressr, purrr, stats, tibble, vegan</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, future, tictoc, patchwork, testthat (&ge;
3.0.0), stringr, magrittr, covr, picante, withr, fs, readr,
usethis, scales, colorBlindness</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-04 20:33:27 UTC; joelnitta</td>
</tr>
<tr>
<td>Author:</td>
<td>Joel H. Nitta <a href="https://orcid.org/0000-0003-4719-7472"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Shawn W. Laffan [ctb, dtc],
  Brent D. Mishler [ctb, dtc],
  Wataru Iwasaki <a href="https://orcid.org/0000-0002-9169-9245"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Klaus Schliep <a href="https://orcid.org/0000-0003-2941-0161"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joel H. Nitta &lt;joelnitta@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-04 23:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='canaper-package'>canaper: Categorical Analysis of Neo- And Paleo-Endemism</h2><span id='topic+canaper'></span><span id='topic+canaper-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Provides functions to analyze the spatial distribution of biodiversity, in particular categorical analysis of neo- and paleo-endemism (CANAPE) as described in Mishler et al (2014) <a href="https://doi.org/10.1038/ncomms5473">doi:10.1038/ncomms5473</a>. 'canaper' conducts statistical tests to determine the types of endemism that occur in a study area while accounting for the evolutionary relationships of species.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Joel H. Nitta <a href="mailto:joelnitta@gmail.com">joelnitta@gmail.com</a> (<a href="https://orcid.org/0000-0003-4719-7472">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Shawn W. Laffan [contributor, data contributor]
</p>
</li>
<li><p> Brent D. Mishler [contributor, data contributor]
</p>
</li>
<li><p> Wataru Iwasaki (<a href="https://orcid.org/0000-0002-9169-9245">ORCID</a>) [contributor]
</p>
</li>
<li><p> Klaus Schliep (<a href="https://orcid.org/0000-0003-2941-0161">ORCID</a>) [reviewer]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ropensci/canaper">https://github.com/ropensci/canaper</a>
</p>
</li>
<li> <p><a href="https://docs.ropensci.org/canaper/">https://docs.ropensci.org/canaper/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ropensci/canaper/issues">https://github.com/ropensci/canaper/issues</a>
</p>
</li></ul>


<hr>
<h2 id='acacia'><em>Acacia</em> example data</h2><span id='topic+acacia'></span>

<h3>Description</h3>

<p>Dataset of Australian <em>Acacia</em> from Mishler et al. 2014 (Nat. Comm.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acacia
</code></pre>


<h3>Format</h3>

<p>A list with two elements:
</p>

<dl>
<dt>phy</dt><dd><p>Phylogeny of Australian <em>Acacia</em> (list of class &quot;phylo&quot;).
Tip labels are specific epithet, except for the outgroup, which includes
genus and specific epithet. Includes 508 ingroup taxa (genus <em>Acacia</em>)
and two outgroup taxa.</p>
</dd>
<dt>comm</dt><dd><p>Community matrix of Australian <em>Acacia</em> (dataframe).
Column names are specific epithet of each species. Row names are centroids
of 50km grid cells in Australian Albers equal area EPSG:3577 projection.
3037 rows (sites) x 506 columns (species). Data are counts, i.e., the
number of times a species was observed in a grid cell.</p>
</dd>
</dl>



<h3>References</h3>

<p>Mishler, B., Knerr, N., González-Orozco, C. et al. Phylogenetic
measures of biodiversity and neo- and paleo-endemism in Australian Acacia.
Nat Commun 5, 4473 (2014). <a href="https://doi.org/10.1038/ncomms5473">doi:10.1038/ncomms5473</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example phylogeny
acacia$phy
# Example community
acacia$comm[1:5, 1:5]
</code></pre>

<hr>
<h2 id='biod_example'>Biodiverse example data</h2><span id='topic+biod_example'></span>

<h3>Description</h3>

<p>Fictional data for testing purposes from
<a href="https://github.com/shawnlaffan/biodiverse/tree/master/data">Biodiverse</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>biod_example
</code></pre>


<h3>Format</h3>

<p>A list with two elements:
</p>

<dl>
<dt>phy</dt><dd><p>Phylogeny with 31 tips</p>
</dd>
<dt>comm</dt><dd><p>Community matrix with 127 sites and 31 species.
Data are counts, i.e., the number of times
a species was observed in a grid cell.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Corresponds to the the community matrix (&quot;groups&quot; object) and phylogeny from
the Biodiverse <a href="https://github.com/shawnlaffan/biodiverse/raw/fbcad3c1df3667bac1235e822cb48ef6e5884e66/data/example_project.bps">example_project.bps</a>.  # nolint
</p>


<h3>References</h3>

<p>Laffan, S.W., Lubarsky, E. &amp; Rosauer, D.F. (2010) Biodiverse, a
tool for the spatial analysis of biological and related diversity.
Ecography. Vol 33, 643-647 (Version 3.1).
<a href="https://doi.org/10.1111/j.1600-0587.2010.06237.x">doi:10.1111/j.1600-0587.2010.06237.x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example phylogeny
biod_example$phy
# Example community
biod_example$comm[1:5, 1:5]
</code></pre>

<hr>
<h2 id='biod_results'>Output from Biodiverse</h2><span id='topic+biod_results'></span>

<h3>Description</h3>

<p>Output of analyzing test data with
<a href="https://github.com/shawnlaffan/biodiverse">Biodiverse</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>biod_results
</code></pre>


<h3>Format</h3>

<p>A tibble (dataframe) with 127 rows and 7 columns. Columns include:
</p>

<dl>
<dt>site</dt><dd><p>Site name; corresponds to row names of
<code><a href="#topic+biod_example">biod_example</a>$comm</code></p>
</dd>
<dt>pd_biodiv</dt><dd><p>Phylogenetic diversity (PD; <code>PD_P</code> in Biodiverse)</p>
</dd>
<dt>pd_alt_biodiv</dt><dd><p>Alternative PD (PD measured on tree with all
branchlengths equal; <code>PHYLO_RPD_NULL2</code> in Biodiverse)</p>
</dd>
<dt>rpd_biodiv</dt><dd><p>Relative PD (PD divided by alternative PD;
<code>PHYLO_RPD_NULL2</code> in Biodiverse)</p>
</dd>
<dt>pe_biodiv</dt><dd><p>Phylogenetic endemism (PE; <code>PE_WE_P</code> in Biodiverse)</p>
</dd>
<dt>pe_alt_biodiv</dt><dd><p>Alternative PE (PE measured on tree with all
branchlengths equal; <code>PHYLO_RPE_NULL2</code> in Biodiverse)</p>
</dd>
<dt>rpe_biodiv</dt><dd><p>Relative PE (PE divided by alternative PD;
<code>PHYLO_RPE2</code> in Biodiverse)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <a href="https://github.com/shawnlaffan/biodiverse/raw/fbcad3c1df3667bac1235e822cb48ef6e5884e66/data/example_project.bps">example_project.bps</a> # nolint
example data set was used as input,which corresponds to the
<code><a href="#topic+biod_example">biod_example</a></code> dataset in this package.
</p>
<p>For a description of all Biodiverse metrics,
<a href="https://github.com/shawnlaffan/biodiverse/wiki/Indices">see the Biodiverse wiki</a>. # nolint
</p>


<h3>References</h3>

<p>Laffan, S.W., Lubarsky, E. &amp; Rosauer, D.F. (2010) Biodiverse, a
tool for the spatial analysis of biological and related diversity.
Ecography. Vol 33, 643-647 (Version 3.1).
<a href="https://doi.org/10.1111/j.1600-0587.2010.06237.x">doi:10.1111/j.1600-0587.2010.06237.x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>biod_results
</code></pre>

<hr>
<h2 id='cpr_classify_endem'>Classify phylogenetic endemism</h2><span id='topic+cpr_classify_endem'></span>

<h3>Description</h3>

<p>Given the results of <code><a href="#topic+cpr_rand_test">cpr_rand_test()</a></code>, classifies phylogenetic endemism
according to CANAPE scheme of Mishler et al. 2014.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_classify_endem(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpr_classify_endem_+3A_df">df</code></td>
<td>
<p>Input data frame. Must have the following columns:
</p>

<ul>
<li> <p><code>pe_obs_p_upper</code>: Upper <em>p</em>-value comparing observed phylogenetic endemism
to random values
</p>
</li>
<li> <p><code>pe_alt_obs_p_upper</code>: Upper <em>p</em>-value comparing observed phylogenetic
endemism on alternate tree to random values
</p>
</li>
<li> <p><code>rpe_obs_p_upper</code>: Upper <em>p</em>-value comparing observed relative phylogenetic
endemism to random values
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>For a summary of the classification scheme, see:
<a href="http://biodiverse-analysis-software.blogspot.com/2014/11/canape-categorical-analysis-of-palaeo.html">http://biodiverse-analysis-software.blogspot.com/2014/11/canape-categorical-analysis-of-palaeo.html</a> # nolint
</p>


<h3>Value</h3>

<p>Object of class data.frame with column <code>endem_type</code> (character)
added. Values of <code>endem_type</code> type include <code>paleo</code> (paleoendemic), <code>neo</code>
(neoendemic), <code style="white-space: pre;">&#8288;not significant&#8288;</code> (what it says), <code>mixed</code> (mixed endemism),
and <code>super</code> (super-endemic; both <code>pe_obs</code> and <code>pe_obs_alt</code> are highly
significant).
</p>


<h3>References</h3>

<p>Mishler, B., Knerr, N., González-Orozco, C. et al.  (2014)
Phylogenetic measures of biodiversity and neo- and paleo-endemism in
Australian Acacia. Nat Commun, 5: 4473. <a href="https://doi.org/10.1038/ncomms5473">doi:10.1038/ncomms5473</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(12345)
data(phylocom)
rand_test &lt;- cpr_rand_test(
  phylocom$comm, phylocom$phy,
  null_model = "curveball", metrics = c("pe", "rpe"), n_reps = 10
)
cpr_classify_endem(rand_test)

</code></pre>

<hr>
<h2 id='cpr_classify_signif'>Classify statistical significance</h2><span id='topic+cpr_classify_signif'></span>

<h3>Description</h3>

<p>Given the results of <code><a href="#topic+cpr_rand_test">cpr_rand_test()</a></code>, classifies statistical significance
of a biodiversity metric. The null hypothesis is that observed value does not
lie in the extreme of the random values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_classify_signif(df, metric, one_sided = FALSE, upper = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpr_classify_signif_+3A_df">df</code></td>
<td>
<p>Input data frame.</p>
</td></tr>
<tr><td><code id="cpr_classify_signif_+3A_metric">metric</code></td>
<td>
<p>Character vector of length 1; selected metric to classify
significance. May choose from <code>pd</code> (phylogenetic diversity), <code>rpd</code>
(relative phylogenetic diversity), <code>pe</code> (phylogenetic endemism), <code>rpe</code>
(relative phylogenetic endemism) (case-sensitive).</p>
</td></tr>
<tr><td><code id="cpr_classify_signif_+3A_one_sided">one_sided</code></td>
<td>
<p>Logical vector of length 1; is the null hypothesis
one-sided? If <code>TRUE</code>, values will be classified as significant if they are
in <strong>either</strong> the top 5% <strong>or</strong> bottom 5%. If <code>FALSE</code>, values will be
classified as significant if they are in the top 2.5% or bottom 2.5%,
combined.</p>
</td></tr>
<tr><td><code id="cpr_classify_signif_+3A_upper">upper</code></td>
<td>
<p>Logical vector of length 1; only applies if <code>one_sided</code> is
<code>TRUE</code>. If <code>TRUE</code>, values in the top 5% will be classified as significant.
If <code>FALSE</code>, values in the bottom 5% will be classified as significant.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For metrics like <code>pe</code>, you probably want to consider a one-sided
hypothesis testing values in the upper extreme (i.e., we are interested in
areas that have higher than expected endemism). For this, you would set
<code style="white-space: pre;">&#8288;one_sided = TRUE, upper = TRUE&#8288;</code>. For metrics like <code>pd</code>, you probably want
to consider a two-sided hypothesis (i.e., we are interested in areas that
are either more diverse or less than diverse than expected at random). For
this, set <code>one_sided = FALSE</code>.
</p>


<h3>Value</h3>

<p>Object of class data.frame with column added for statistical
significance of the selected metric. The new column name is the name of the
metric with <code style="white-space: pre;">&#8288;_signif&#8288;</code> appended. The new column is a character that may
contain the following values, depending on the null hypothesis:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;&lt; 0.01&#8288;</code>, <code style="white-space: pre;">&#8288;&lt; 0.025&#8288;</code>, <code style="white-space: pre;">&#8288;&gt; 0.975&#8288;</code>, <code style="white-space: pre;">&#8288;&gt; 0.99&#8288;</code>, <code style="white-space: pre;">&#8288;not significant&#8288;</code> (two-sided)
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;&lt; 0.01&#8288;</code>, <code style="white-space: pre;">&#8288;&lt; 0.05&#8288;</code>, <code style="white-space: pre;">&#8288;&gt; 0.99&#8288;</code>, <code style="white-space: pre;">&#8288;&gt; 0.95&#8288;</code>, <code style="white-space: pre;">&#8288;not significant&#8288;</code> (one-sided)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(12345)
data(phylocom)
rand_test &lt;- cpr_rand_test(
  phylocom$comm, phylocom$phy,
  null_model = "curveball", metrics = "pd", n_reps = 50
)
cpr_classify_signif(rand_test, "pd")

</code></pre>

<hr>
<h2 id='cpr_endem_cols'>CVD-friendly color palette for plotting results of CANAPE</h2><span id='topic+cpr_endem_cols'></span>

<h3>Description</h3>

<p>Character vector with names corresponding to endemism types
and values corresponding to color codes. Should be distinguishable to
people with color vision deficiency (CVD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_endem_cols
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 5.
</p>


<h3>Details</h3>

<p>Color scheme:
</p>

<ul>
<li><p> paleo: dark blue
</p>
</li>
<li><p> neo: red
</p>
</li>
<li><p> not significant: beige
</p>
</li>
<li><p> mixed: green
</p>
</li>
<li><p> super: yellow
</p>
</li></ul>



<h3>See Also</h3>

<p>Other colors: 
<code><a href="#topic+cpr_endem_cols_2">cpr_endem_cols_2</a></code>,
<code><a href="#topic+cpr_endem_cols_3">cpr_endem_cols_3</a></code>,
<code><a href="#topic+cpr_endem_cols_4">cpr_endem_cols_4</a></code>,
<code><a href="#topic+cpr_make_pal">cpr_make_pal</a>()</code>,
<code><a href="#topic+cpr_signif_cols_2">cpr_signif_cols_2</a></code>,
<code><a href="#topic+cpr_signif_cols">cpr_signif_cols</a></code>,
<code><a href="#topic+mishler_endem_cols">mishler_endem_cols</a></code>,
<code><a href="#topic+mishler_signif_cols">mishler_signif_cols</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cpr_endem_cols
scales::show_col(cpr_endem_cols)
</code></pre>

<hr>
<h2 id='cpr_endem_cols_2'>CVD-friendly color palette for plotting results of CANAPE, version 2</h2><span id='topic+cpr_endem_cols_2'></span>

<h3>Description</h3>

<p>Character vector with names corresponding to endemism types
and values corresponding to color codes. Should be distinguishable to
people with color vision deficiency (CVD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_endem_cols_2
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 5.
</p>


<h3>Details</h3>

<p>Color scheme:
</p>

<ul>
<li><p> paleo: dark blue
</p>
</li>
<li><p> neo: red
</p>
</li>
<li><p> not significant: light grey
</p>
</li>
<li><p> mixed: green
</p>
</li>
<li><p> super: yellow
</p>
</li></ul>



<h3>See Also</h3>

<p>Other colors: 
<code><a href="#topic+cpr_endem_cols_3">cpr_endem_cols_3</a></code>,
<code><a href="#topic+cpr_endem_cols_4">cpr_endem_cols_4</a></code>,
<code><a href="#topic+cpr_endem_cols">cpr_endem_cols</a></code>,
<code><a href="#topic+cpr_make_pal">cpr_make_pal</a>()</code>,
<code><a href="#topic+cpr_signif_cols_2">cpr_signif_cols_2</a></code>,
<code><a href="#topic+cpr_signif_cols">cpr_signif_cols</a></code>,
<code><a href="#topic+mishler_endem_cols">mishler_endem_cols</a></code>,
<code><a href="#topic+mishler_signif_cols">mishler_signif_cols</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cpr_endem_cols_2
scales::show_col(cpr_endem_cols_2)
</code></pre>

<hr>
<h2 id='cpr_endem_cols_3'>CVD-friendly color palette for plotting results of CANAPE, version 3</h2><span id='topic+cpr_endem_cols_3'></span>

<h3>Description</h3>

<p>Character vector with names corresponding to endemism types
and values corresponding to color codes. Should be distinguishable to
people with color vision deficiency (CVD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_endem_cols_3
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 5.
</p>


<h3>Details</h3>

<p>Color scheme:
</p>

<ul>
<li><p> paleo: dark blue
</p>
</li>
<li><p> neo: red
</p>
</li>
<li><p> not significant: light grey
</p>
</li>
<li><p> mixed: green
</p>
</li>
<li><p> super: orange
</p>
</li></ul>



<h3>See Also</h3>

<p>Other colors: 
<code><a href="#topic+cpr_endem_cols_2">cpr_endem_cols_2</a></code>,
<code><a href="#topic+cpr_endem_cols_4">cpr_endem_cols_4</a></code>,
<code><a href="#topic+cpr_endem_cols">cpr_endem_cols</a></code>,
<code><a href="#topic+cpr_make_pal">cpr_make_pal</a>()</code>,
<code><a href="#topic+cpr_signif_cols_2">cpr_signif_cols_2</a></code>,
<code><a href="#topic+cpr_signif_cols">cpr_signif_cols</a></code>,
<code><a href="#topic+mishler_endem_cols">mishler_endem_cols</a></code>,
<code><a href="#topic+mishler_signif_cols">mishler_signif_cols</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cpr_endem_cols_3
scales::show_col(cpr_endem_cols_3)
</code></pre>

<hr>
<h2 id='cpr_endem_cols_4'>CVD-friendly color palette for plotting results of CANAPE, version 4</h2><span id='topic+cpr_endem_cols_4'></span>

<h3>Description</h3>

<p>Character vector with names corresponding to endemism types
and values corresponding to color codes. Should be distinguishable to
people with color vision deficiency (CVD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_endem_cols_4
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 5.
</p>


<h3>Details</h3>

<p>Color scheme:
</p>

<ul>
<li><p> paleo: light blue
</p>
</li>
<li><p> neo: red
</p>
</li>
<li><p> not significant: light grey
</p>
</li>
<li><p> mixed: green
</p>
</li>
<li><p> super: yellow
</p>
</li></ul>



<h3>See Also</h3>

<p>Other colors: 
<code><a href="#topic+cpr_endem_cols_2">cpr_endem_cols_2</a></code>,
<code><a href="#topic+cpr_endem_cols_3">cpr_endem_cols_3</a></code>,
<code><a href="#topic+cpr_endem_cols">cpr_endem_cols</a></code>,
<code><a href="#topic+cpr_make_pal">cpr_make_pal</a>()</code>,
<code><a href="#topic+cpr_signif_cols_2">cpr_signif_cols_2</a></code>,
<code><a href="#topic+cpr_signif_cols">cpr_signif_cols</a></code>,
<code><a href="#topic+mishler_endem_cols">mishler_endem_cols</a></code>,
<code><a href="#topic+mishler_signif_cols">mishler_signif_cols</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cpr_endem_cols_4
scales::show_col(cpr_endem_cols_4)
</code></pre>

<hr>
<h2 id='cpr_iter_sim'>Simulate the number of iterations needed to generate a random community that
is sufficiently different from the original community</h2><span id='topic+cpr_iter_sim'></span>

<h3>Description</h3>

<p>For randomization algorithms that involve swapping (iterations), there is no
way to know <em>a-priori</em> how many iterations are needed to sufficiently &quot;mix&quot;
the community data matrix. <code><a href="#topic+cpr_iter_sim">cpr_iter_sim()</a></code> records the percentage similarity
between the original matrix and a matrix that has been randomized with
successive swapping iterations, at each iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_iter_sim(
  comm,
  null_model = "curveball",
  n_iterations = 100,
  thin = 1,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpr_iter_sim_+3A_comm">comm</code></td>
<td>
<p>Dataframe or matrix; input community data with
sites (communities) as rows and species as columns. Values of each cell are
the presence/absence (0 or 1) or number of individuals (abundance) of each
species in each site.</p>
</td></tr>
<tr><td><code id="cpr_iter_sim_+3A_null_model">null_model</code></td>
<td>
<p>Character vector of length 1 or object of class <code>commsim</code>;
either the name of the model to use for generating random communities (null
model), or a custom null model. For full list of available predefined null
models, see the help file of <code><a href="vegan.html#topic+commsim">vegan::commsim()</a></code>, or run
<code><a href="vegan.html#topic+commsim">vegan::make.commsim()</a></code>. An object of class <code>commsim</code> can be generated with
<code><a href="vegan.html#topic+commsim">vegan::commsim()</a></code>.</p>
</td></tr>
<tr><td><code id="cpr_iter_sim_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Numeric vector of length 1; maximum number of iterations to
conduct.</p>
</td></tr>
<tr><td><code id="cpr_iter_sim_+3A_thin">thin</code></td>
<td>
<p>Numeric vector of length 1; frequency to record percentage
similarity between original matrix and randomized matrix. Results will
be recorded every <code>thin</code> iterations (see Details).</p>
</td></tr>
<tr><td><code id="cpr_iter_sim_+3A_seed">seed</code></td>
<td>
<p>Integer vector of length 1 or NULL; random seed that will be used
in a call to <code>set.seed()</code> before randomizing the matrix. Default (<code>NULL</code>)
will not change the random generator state.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user should inspect the results to determine at what number of iterations
the original matrix and randomized matrix reach maximum dissimilarity (see
Examples). This number will strongly depend on the size and structure of the
original matrix. Large matrices with many zeros will likely take more
iterations, and even then still retain relatively high similarity between the
original matrix and the randomized matrix.
</p>
<p>Available memory may be quickly exhausted if many (e.g., tens or hundreds of
thousands, or more) of iterations are used with no thinning on large
matrices; use <code>thin</code> to only record a portion of the results and save on
memory.
</p>
<p>Of course, <code><a href="#topic+cpr_iter_sim">cpr_iter_sim()</a></code> only makes sense for randomization algorithms
that use iterations.
</p>
<p>Only presence/absence information is used to calculate percentage similarity
between community matrices.
</p>


<h3>Value</h3>

<p>Tibble (dataframe) with the following columns:
</p>

<ul>
<li> <p><code>iteration</code>: Number of iterations used to generate random community
</p>
</li>
<li> <p><code>similarity</code>: Percentage similarity between original community and
random community
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Simulate generation of a random community with maximum of 10,000
# iterations, recording similarity every 100 iterations
(res &lt;- cpr_iter_sim(
  comm = biod_example$comm,
  null_model = "swap",
  n_iterations = 10000,
  thin = 100,
  seed = 123
))

# Plot reveals that ca. 1000 iterations are sufficient to
# completely mix random community
plot(res$iteration, res$similarity, type = "l")

</code></pre>

<hr>
<h2 id='cpr_make_pal'>Make a palette of colors for plotting CANAPE results</h2><span id='topic+cpr_make_pal'></span>

<h3>Description</h3>

<p>Palettes can also be loaded by name directly (see &quot;Other colors&quot; below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_make_pal(name, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpr_make_pal_+3A_name">name</code></td>
<td>
<p>Character vector of length 1; name of palette to select. Must be
one of 'mishler2014', 'canaper1', 'canaper2', 'canaper3', or 'canaper4'</p>
</td></tr>
<tr><td><code id="cpr_make_pal_+3A_type">type</code></td>
<td>
<p>Character vector of length 1; type of palette to select. Must be
one of 'endem' (endemism) or 'signif' (<em>p</em>-rank significance)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Palettes with the name 'mishler2014' correspond to colors used in Mishler et
al. 2014. This color scheme has been widely used to show CANAPE
results, but some colors may not be distinguishable to people with color
vision deficiency (CVD).
</p>
<p>Palettes with the name 'canaper1' or 'canaper2' are based on the Okabe-Ito
palette (endemism; Okabe &amp; Ito 2002) or RColorBrewer (significance) and
should be CVD-friendly.
</p>
<p>Names of colors correspond to either endemism type or
<em>p</em>-rank output by <code><a href="#topic+cpr_classify_endem">cpr_classify_endem()</a></code> or <code><a href="#topic+cpr_classify_signif">cpr_classify_signif()</a></code>,
respectively. Not all names are all available for both types.
</p>


<h3>Value</h3>

<p>Named character vector; color hex codes
</p>


<h3>References</h3>

<p>Mishler, B., Knerr, N., González-Orozco, C. et al.  (2014)
Phylogenetic measures of biodiversity and
neo- and paleo-endemism in Australian Acacia. Nat Commun, 5: 4473.
<a href="https://doi.org/10.1038/ncomms5473">doi:10.1038/ncomms5473</a>
</p>
<p>Okabe, M., &amp; Ito, K. (2002) Color
Universal Design (CUD) - How to make figures and presentations that are
friendly to Colorblind people. J*FLY Data
Depository for Drosophila Researchers. <a href="https://jfly.uni-koeln.de/color/">https://jfly.uni-koeln.de/color/</a>
</p>


<h3>See Also</h3>

<p>Other colors: 
<code><a href="#topic+cpr_endem_cols_2">cpr_endem_cols_2</a></code>,
<code><a href="#topic+cpr_endem_cols_3">cpr_endem_cols_3</a></code>,
<code><a href="#topic+cpr_endem_cols_4">cpr_endem_cols_4</a></code>,
<code><a href="#topic+cpr_endem_cols">cpr_endem_cols</a></code>,
<code><a href="#topic+cpr_signif_cols_2">cpr_signif_cols_2</a></code>,
<code><a href="#topic+cpr_signif_cols">cpr_signif_cols</a></code>,
<code><a href="#topic+mishler_endem_cols">mishler_endem_cols</a></code>,
<code><a href="#topic+mishler_signif_cols">mishler_signif_cols</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cpr_make_pal("mishler2014", "endem")
cpr_make_pal("canaper1", "endem")
scales::show_col(cpr_make_pal("mishler2014", "endem"))
</code></pre>

<hr>
<h2 id='cpr_rand_comm'>Randomize a single community matrix</h2><span id='topic+cpr_rand_comm'></span>

<h3>Description</h3>

<p>Note that binary null models return a binary matrix, even if an abundance
matrix was used as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_rand_comm(comm, null_model, n_iterations = 1, thin = 1, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpr_rand_comm_+3A_comm">comm</code></td>
<td>
<p>Dataframe or matrix; input community data with
sites (communities) as rows and species as columns. Values of each cell are
the presence/absence (0 or 1) or number of individuals (abundance) of each
species in each site.</p>
</td></tr>
<tr><td><code id="cpr_rand_comm_+3A_null_model">null_model</code></td>
<td>
<p>Character vector of length 1 or object of class <code>commsim</code>;
either the name of the model to use for generating random communities (null
model), or a custom null model. For full list of available predefined null
models, see the help file of <code><a href="vegan.html#topic+commsim">vegan::commsim()</a></code>, or run
<code><a href="vegan.html#topic+commsim">vegan::make.commsim()</a></code>. An object of class <code>commsim</code> can be generated with
<code><a href="vegan.html#topic+commsim">vegan::commsim()</a></code> (see Examples).</p>
</td></tr>
<tr><td><code id="cpr_rand_comm_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Numeric vector of length 1; number of iterations for
sequential null models. Ignored by non-sequential null models.</p>
</td></tr>
<tr><td><code id="cpr_rand_comm_+3A_thin">thin</code></td>
<td>
<p>Numeric vector of length 1; thinning parameter used by some
null models in <code>vegan</code> (e.g., <code>quasiswap</code>); ignored for other models.</p>
</td></tr>
<tr><td><code id="cpr_rand_comm_+3A_seed">seed</code></td>
<td>
<p>Integer vector of length 1 or NULL; random seed that will be used
in a call to <code>set.seed()</code> before randomizing the matrix. Default (<code>NULL</code>)
will not change the random generator state.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

# Check list of available pre-defined null models in vegan
vegan::make.commsim()

# Binary null model produces binary output
data(phylocom)
cpr_rand_comm(phylocom$comm, "swap", 100)

# Quantitative null model produces quantitative output
cpr_rand_comm(phylocom$comm, "swap_count", 100)

# How to use a custom null model
# 1. Define a randomizing function, e.g. re-sample the matrix while
# preserving total number of presences (same as the "r00" model)
randomizer &lt;- function(x, n, ...) {
  array(replicate(n, sample(x)), c(dim(x), n))
}

# 2. Generate a commsim object
cs_object &lt;- vegan::commsim(
  "r00_model",
  fun = randomizer, binary = TRUE,
  isSeq = FALSE, mode = "integer"
)

# 3. Generate the null community
cpr_rand_comm(phylocom$comm, cs_object, 100)
</code></pre>

<hr>
<h2 id='cpr_rand_test'>Run a randomization analysis for one or more biodiversity metrics</h2><span id='topic+cpr_rand_test'></span>

<h3>Description</h3>

<p>The observed value of the biodiversity metric(s) will be calculated for the
input community data, then compared against a set of random communities.
Various statistics are calculated from the comparison (see <strong>Value</strong> below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_rand_test(
  comm,
  phy,
  null_model,
  n_reps = 100,
  n_iterations = 10000,
  thin = 1,
  metrics = c("pd", "rpd", "pe", "rpe"),
  site_col = "site",
  tbl_out = tibble::is_tibble(comm),
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpr_rand_test_+3A_comm">comm</code></td>
<td>
<p>Dataframe, tibble, or matrix; input community data with
sites (communities) as rows and species as columns. Either presence-absence
data (values only 0s or 1s) or abundance data (values &gt;= 0) accepted, but
calculations do not use abundance-weighting, so results from abundance data
will be the same as if converted to presence-absence before analysis.</p>
</td></tr>
<tr><td><code id="cpr_rand_test_+3A_phy">phy</code></td>
<td>
<p>List of class <code>phylo</code>; input phylogeny.</p>
</td></tr>
<tr><td><code id="cpr_rand_test_+3A_null_model">null_model</code></td>
<td>
<p>Character vector of length 1 or object of class <code>commsim</code>;
either the name of the model to use for generating random communities (null
model), or a custom null model. For full list of available predefined null
models, see the help file of <code><a href="vegan.html#topic+commsim">vegan::commsim()</a></code>, or run
<code><a href="vegan.html#topic+commsim">vegan::make.commsim()</a></code>. An object of class <code>commsim</code> can be generated with
<code><a href="vegan.html#topic+commsim">vegan::commsim()</a></code> (see <strong>Examples</strong> in <code><a href="#topic+cpr_rand_comm">cpr_rand_comm</a>()</code>).</p>
</td></tr>
<tr><td><code id="cpr_rand_test_+3A_n_reps">n_reps</code></td>
<td>
<p>Numeric vector of length 1; number of random communities to
replicate.</p>
</td></tr>
<tr><td><code id="cpr_rand_test_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Numeric vector of length 1; number of iterations to use
for sequential null models; ignored for non-sequential models.</p>
</td></tr>
<tr><td><code id="cpr_rand_test_+3A_thin">thin</code></td>
<td>
<p>Numeric vector of length 1; thinning parameter used by some
null models in <code>vegan</code> (e.g., <code>quasiswap</code>); ignored for other models.</p>
</td></tr>
<tr><td><code id="cpr_rand_test_+3A_metrics">metrics</code></td>
<td>
<p>Character vector; names of biodiversity metrics to calculate.
May include one or more of: <code>pd</code>, <code>rpd</code>, <code>pe</code>, <code>rpe</code> (case-sensitive).</p>
</td></tr>
<tr><td><code id="cpr_rand_test_+3A_site_col">site_col</code></td>
<td>
<p>Character vector of length 1; name of column in <code>comm</code> that
contains the site names; only used if <code>comm</code> is a tibble (object of class
<code>tbl_df</code>).</p>
</td></tr>
<tr><td><code id="cpr_rand_test_+3A_tbl_out">tbl_out</code></td>
<td>
<p>Logical vector of length 1; should the output be returned as
a tibble? If <code>FALSE</code>, will return a dataframe. Defaults to <code>TRUE</code> if <code>comm</code>
is a tibble.</p>
</td></tr>
<tr><td><code id="cpr_rand_test_+3A_quiet">quiet</code></td>
<td>
<p>Logical vector of length 1; if <code>TRUE</code>, suppress all warnings and
messages that would be emitted by this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The biodiversity metrics (<code>metrics</code>) available for analysis include:
</p>

<ul>
<li> <p><code>pd</code>: Phylogenetic diversity (Faith 1992)
</p>
</li>
<li> <p><code>rpd</code>: Relative phylogenetic diversity (Mishler et al 2014)
</p>
</li>
<li> <p><code>pe</code>: Phylogenetic endemism (Rosauer et al 2009)
</p>
</li>
<li> <p><code>rpe</code>: Relative phylogenetic endemism (Mishler et al 2014)
</p>
</li></ul>

<p>(<code>pe</code> and <code>rpe</code> are needed for CANAPE with
<code><a href="#topic+cpr_classify_endem">cpr_classify_endem</a>()</code>)
</p>
<p>The choice of a randomization algorithm (<code>null_model</code>) is not trivial, and
may strongly affect results. <code>cpr_rand_test()</code> uses null models provided by
<code>vegan</code>; for a complete list, see the help file of <code><a href="vegan.html#topic+commsim">vegan::commsim()</a></code> or run
<code><a href="vegan.html#topic+commsim">vegan::make.commsim()</a></code>. One frequently used null model is <code>swap</code> (Gotelli &amp;
Entsminger 2003), which randomizes the community matrix while preserving
column and row sums (marginal sums). For a review of various null models, see
Strona et al. (2018); <code>swap</code> is an &quot;FF&quot; model in the sense of Strona et al.
(2018).
</p>
<p>Instead of using one of the predefined null models in <code><a href="vegan.html#topic+commsim">vegan::commsim()</a></code>, it
is also possible to define a custom null model; see <strong>Examples</strong> in
<code><a href="#topic+cpr_rand_comm">cpr_rand_comm</a>()</code>
</p>
<p>Note that the pre-defined models in <code>vegan</code> include binary models (designed
for presence-absence data) and quantitative models (designed for abundance
data). Although the binary models will accept abundance data, they treat it
as binary and always return a binary (presence-absence) matrix. The PD and PE
calculations in <code>canaper</code> are not abundance-weighted, so they return the same
result regardless of whether the input is presence-absence or abundance. In
that sense, binary null models are appropriate for <code>cpr_rand_test()</code>. The
quantitative models could also be used for abundance data, but the output
will be treated as binary anyways when calculating PD and PE. The effects of
using binary vs. quantitative null models for <code>cpr_rand_test()</code> have not been
investigated.
</p>
<p>A minimum of 5 species and sites are required as input; fewer than that is
likely cause the some randomization algorithms (e.g., <code>swap</code>) to enter an
infinite loop. Besides, inferences on very small numbers of species and/or
sites is not recommended generally.
</p>
<p>The following rules apply to <code>comm</code> input:
</p>

<ul>
<li><p> If dataframe or matrix, must include row names (site names) and column
names (species names).
</p>
</li>
<li><p> If tibble, a single column (default, <code>site</code>) must be included with site
names, and other columns must correspond to species names.
</p>
</li>
<li><p> Column names cannot start with a number and must be unique.
</p>
</li>
<li><p> Row names (site names) must be unique.
</p>
</li>
<li><p> Values (other than site names) should only include integers &gt;= 0;
non-integer input will be converted to integer.
</p>
</li></ul>

<p>The results are identical regardless of whether the input for <code>comm</code> is
abundance or presence-absence data (i.e., abundance weighting is not used).
</p>


<h3>Value</h3>

<p>Dataframe. For each of the biodiversity metrics, the following 9
columns will be produced:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;*_obs&#8288;</code>: Observed value
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;*_obs_c_lower&#8288;</code>: Count of times observed value was lower than random values
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;*_obs_c_upper&#8288;</code>: Count of times observed value was higher than random
values
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;*_obs_p_lower&#8288;</code>: Percentage of times observed value was lower than random
values
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;*_obs_p_upper&#8288;</code>: Percentage of times observed value was higher than random
values
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;*_obs_q&#8288;</code>: Count of the non-NA random values used for comparison
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;*_obs_z&#8288;</code>: Standard effect size (z-score)
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;*_rand_mean&#8288;</code>: Mean of the random values
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;*_rand_sd&#8288;</code>: Standard deviation of the random values
</p>
</li></ul>

<p>So if you included <code>pd</code> in <code>metrics</code>, the output columns would include
<code>pd_obs</code>, <code>pd_obs_c_lower</code>, etc...
</p>


<h3>References</h3>

<p>Faith DP (1992) Conservation evaluation and phylogenetic
diversity. Biological Conservation, 61:1–10.
<a href="https://doi.org/10.1016/0006-3207%2892%2991201-3">doi:10.1016/0006-3207(92)91201-3</a>
</p>
<p>Gotelli, N.J. and Entsminger, N.J. (2003). Swap algorithms in
null model analysis. Ecology 84, 532–535.
</p>
<p>Mishler, B., Knerr, N., González-Orozco, C. et al.  (2014)
Phylogenetic measures of biodiversity and neo- and paleo-endemism in
Australian Acacia. Nat Commun, 5: 4473. <a href="https://doi.org/10.1038/ncomms5473">doi:10.1038/ncomms5473</a>
</p>
<p>Rosauer, D., Laffan, S.W., Crisp, M.D., Donnellan, S.C. and Cook,
L.G. (2009) Phylogenetic endemism: a new approach for identifying
geographical concentrations of evolutionary history. Molecular Ecology, 18:
4061-4072. <a href="https://doi.org/10.1111/j.1365-294X.2009.04311.x">doi:10.1111/j.1365-294X.2009.04311.x</a>
</p>
<p>Strona, G., Ulrich, W. and Gotelli, N.J. (2018), Bi-dimensional
null model analysis of presence-absence binary matrices.
Ecology, 99: 103-115. <a href="https://doi.org/10.1002/ecy.2043">doi:10.1002/ecy.2043</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(12345)
data(phylocom)
# Returns a dataframe by defualt
cpr_rand_test(
  phylocom$comm, phylocom$phy,
  null_model = "curveball", metrics = "pd", n_reps = 10
)

# Tibbles may be preferable because of the large number of columns
cpr_rand_test(
  phylocom$comm, phylocom$phy,
  null_model = "curveball", tbl_out = TRUE, n_reps = 10
)

</code></pre>

<hr>
<h2 id='cpr_signif_cols'>CVD-friendly color palette for plotting results of randomization test</h2><span id='topic+cpr_signif_cols'></span>

<h3>Description</h3>

<p>Character vector with names corresponding to significance levels
and values corresponding to color codes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_signif_cols
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 5.
</p>


<h3>See Also</h3>

<p>Other colors: 
<code><a href="#topic+cpr_endem_cols_2">cpr_endem_cols_2</a></code>,
<code><a href="#topic+cpr_endem_cols_3">cpr_endem_cols_3</a></code>,
<code><a href="#topic+cpr_endem_cols_4">cpr_endem_cols_4</a></code>,
<code><a href="#topic+cpr_endem_cols">cpr_endem_cols</a></code>,
<code><a href="#topic+cpr_make_pal">cpr_make_pal</a>()</code>,
<code><a href="#topic+cpr_signif_cols_2">cpr_signif_cols_2</a></code>,
<code><a href="#topic+mishler_endem_cols">mishler_endem_cols</a></code>,
<code><a href="#topic+mishler_signif_cols">mishler_signif_cols</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cpr_signif_cols
scales::show_col(cpr_signif_cols)
</code></pre>

<hr>
<h2 id='cpr_signif_cols_2'>CVD-friendly color palette for plotting results of randomization test,
version 2</h2><span id='topic+cpr_signif_cols_2'></span>

<h3>Description</h3>

<p>Character vector with names corresponding to significance levels and values
corresponding to color codes, with &quot;not significant&quot; colored grey.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpr_signif_cols_2
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 5.
</p>


<h3>See Also</h3>

<p>Other colors: 
<code><a href="#topic+cpr_endem_cols_2">cpr_endem_cols_2</a></code>,
<code><a href="#topic+cpr_endem_cols_3">cpr_endem_cols_3</a></code>,
<code><a href="#topic+cpr_endem_cols_4">cpr_endem_cols_4</a></code>,
<code><a href="#topic+cpr_endem_cols">cpr_endem_cols</a></code>,
<code><a href="#topic+cpr_make_pal">cpr_make_pal</a>()</code>,
<code><a href="#topic+cpr_signif_cols">cpr_signif_cols</a></code>,
<code><a href="#topic+mishler_endem_cols">mishler_endem_cols</a></code>,
<code><a href="#topic+mishler_signif_cols">mishler_signif_cols</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cpr_signif_cols_2
scales::show_col(cpr_signif_cols_2)
</code></pre>

<hr>
<h2 id='mishler_endem_cols'>Original color palette for plotting results of CANAPE</h2><span id='topic+mishler_endem_cols'></span>

<h3>Description</h3>

<p>Character vector with names corresponding to endemism types
and values corresponding to color codes. Original palette used by
Mishler et al. (2014). May not be distinguishable to people with
color vision deficiency (CVD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mishler_endem_cols
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 5.
</p>


<h3>Details</h3>

<p>Color scheme:
</p>

<ul>
<li><p> paleo: blue
</p>
</li>
<li><p> neo: red
</p>
</li>
<li><p> not significant: beige
</p>
</li>
<li><p> mixed: light purple
</p>
</li>
<li><p> super: dark purple
</p>
</li></ul>



<h3>References</h3>

<p>Mishler, B., Knerr, N., González-Orozco, C. et al.  (2014)
Phylogenetic measures of biodiversity and neo- and paleo-endemism in
Australian Acacia. Nat Commun, 5: 4473. <a href="https://doi.org/10.1038/ncomms5473">doi:10.1038/ncomms5473</a>
</p>


<h3>See Also</h3>

<p>Other colors: 
<code><a href="#topic+cpr_endem_cols_2">cpr_endem_cols_2</a></code>,
<code><a href="#topic+cpr_endem_cols_3">cpr_endem_cols_3</a></code>,
<code><a href="#topic+cpr_endem_cols_4">cpr_endem_cols_4</a></code>,
<code><a href="#topic+cpr_endem_cols">cpr_endem_cols</a></code>,
<code><a href="#topic+cpr_make_pal">cpr_make_pal</a>()</code>,
<code><a href="#topic+cpr_signif_cols_2">cpr_signif_cols_2</a></code>,
<code><a href="#topic+cpr_signif_cols">cpr_signif_cols</a></code>,
<code><a href="#topic+mishler_signif_cols">mishler_signif_cols</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mishler_endem_cols
scales::show_col(mishler_endem_cols)
</code></pre>

<hr>
<h2 id='mishler_signif_cols'>Original color palette for plotting results of CANAPE</h2><span id='topic+mishler_signif_cols'></span>

<h3>Description</h3>

<p>Character vector with names corresponding to endemism types
and values corresponding to color codes. Original palette used by
Mishler et al. (2014). May not be distinguishable to people with
color vision deficiency (CVD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mishler_signif_cols
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 5.
</p>


<h3>References</h3>

<p>Mishler, B., Knerr, N., González-Orozco, C. et al.  (2014)
Phylogenetic measures of biodiversity and neo- and paleo-endemism in
Australian Acacia. Nat Commun, 5: 4473. <a href="https://doi.org/10.1038/ncomms5473">doi:10.1038/ncomms5473</a>
</p>


<h3>See Also</h3>

<p>Other colors: 
<code><a href="#topic+cpr_endem_cols_2">cpr_endem_cols_2</a></code>,
<code><a href="#topic+cpr_endem_cols_3">cpr_endem_cols_3</a></code>,
<code><a href="#topic+cpr_endem_cols_4">cpr_endem_cols_4</a></code>,
<code><a href="#topic+cpr_endem_cols">cpr_endem_cols</a></code>,
<code><a href="#topic+cpr_make_pal">cpr_make_pal</a>()</code>,
<code><a href="#topic+cpr_signif_cols_2">cpr_signif_cols_2</a></code>,
<code><a href="#topic+cpr_signif_cols">cpr_signif_cols</a></code>,
<code><a href="#topic+mishler_endem_cols">mishler_endem_cols</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mishler_signif_cols
scales::show_col(mishler_signif_cols)
</code></pre>

<hr>
<h2 id='phylocom'>Phylocom example data</h2><span id='topic+phylocom'></span>

<h3>Description</h3>

<p>Fictional data for testing purposes from
<a href="https://www.phylodiversity.net/phylocom/">Phylocom</a> (Webb et al. 2008)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylocom
</code></pre>


<h3>Format</h3>

<p>A list with three elements:
</p>

<dl>
<dt>phylo</dt><dd><p>Phylogeny with 32 tips</p>
</dd>
<dt>sample</dt><dd><p>Community matrix with 6 sites (rows) and 25 species
(columns).</p>
</dd>
<dt>traits</dt><dd><p>Trait data; a data.frame with 32 species (rows) and 4 traits
(columns)</p>
</dd>
</dl>



<h3>Details</h3>

<p>Obtained via the <code>picante</code> package (Kembel et al. 2010)
</p>


<h3>References</h3>

<p>Webb, C.O., Ackerly, D.D., and Kembel, S.W. 2008. Phylocom:
software for the analysis of phylogenetic community structure and trait
evolution. Version 4.0.1. http://www.phylodiversity.net/phylocom/.
</p>
<p>Kembel, et al. Picante: R tools for integrating phylogenies and
ecology, Bioinformatics 26: 1463–1464 <a href="https://doi.org/10.1093/bioinformatics/btq166">doi:10.1093/bioinformatics/btq166</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example phylogeny
phylocom$phy
# Example community
phylocom$comm
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
