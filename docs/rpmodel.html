<!DOCTYPE html><html><head><title>Help for package rpmodel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rpmodel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#co2_to_ca'><p>CO2 partial pressure</p></a></li>
<li><a href='#dampen_vec'><p>Dampen inputs of rpmodel</p></a></li>
<li><a href='#density_h2o'><p>Density of water</p></a></li>
<li><a href='#ftemp_arrh'><p>Calculates the Arrhenius-type temperature response</p></a></li>
<li><a href='#ftemp_inst_jmax'><p>Calculates the instantaneous temperature response of Jmax</p></a></li>
<li><a href='#ftemp_inst_rd'><p>Calculates the temperature response of dark respiration</p></a></li>
<li><a href='#ftemp_inst_vcmax'><p>Calculates the instantaneous temperature response of Vcmax</p></a></li>
<li><a href='#ftemp_kphio'><p>Calculates the temperature dependence of the quantum yield efficiency</p></a></li>
<li><a href='#gammastar'><p>Calculates the CO2 compensation point</p></a></li>
<li><a href='#kmm'><p>Calculates the Michaelis Menten coefficient for Rubisco-limited photosynthesis</p></a></li>
<li><a href='#patm'><p>Calculates atmospheric pressure</p></a></li>
<li><a href='#rpmodel'><p>Invokes a P-model function call</p></a></li>
<li><a href='#soilmstress'><p>Calculates an empirical soil moisture stress factor</p></a></li>
<li><a href='#viscosity_h2o'><p>Viscosity of water</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>P-Model</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the P-model 
  (Stocker et al., 2020 &lt;<a href="https://doi.org/10.5194%2Fgmd-13-1545-2020">doi:10.5194/gmd-13-1545-2020</a>&gt;),
  predicting acclimated parameters of the enzyme kinetics of C3 photosynthesis,
  assimilation, and dark respiration rates as a function of the environment
  (temperature, CO2, vapour pressure deficit, light, atmospheric pressure).</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, dplyr, purrr, tidyr, knitr, testthat, covr, markdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/stineb/rpmodel">https://github.com/stineb/rpmodel</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/stineb/rpmodel/issues">https://github.com/stineb/rpmodel/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-09 08:52:14 UTC; khufkens</td>
</tr>
<tr>
<td>Author:</td>
<td>Benjamin Stocker <a href="https://orcid.org/0000-0002-5070-8109"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Koen Hufkens <a href="https://orcid.org/0000-0002-5070-8109"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Benjamin Stocker &lt;benjamin.stocker@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-09 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='co2_to_ca'>CO2 partial pressure</h2><span id='topic+co2_to_ca'></span>

<h3>Description</h3>

<p>Calculates CO2 partial pressure from concentration in ppm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_to_ca(co2, patm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="co2_to_ca_+3A_co2">co2</code></td>
<td>
<p>Atmospheric CO2 concentration (ppm)</p>
</td></tr>
<tr><td><code id="co2_to_ca_+3A_patm">patm</code></td>
<td>
<p>Atmospheric pressure (Pa).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>CO2 partial pressure in Pa.
</p>

<hr>
<h2 id='dampen_vec'>Dampen inputs of rpmodel</h2><span id='topic+dampen_vec'></span>

<h3>Description</h3>

<p>Applies an exponential dampening input time series with specified time scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dampen_vec(vec, tau)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dampen_vec_+3A_vec">vec</code></td>
<td>
<p>A numeric vector for the time series of a daily meteorological
variable used as input for <code>rpmodel</code> (temperature, 
vapour pressure deficit, CO2, or atmospheric pressure). The length of
<code>x</code> must be at least 365, i.e., corresponding to one year.</p>
</td></tr>
<tr><td><code id="dampen_vec_+3A_tau">tau</code></td>
<td>
<p>The time scale of dampening (e-folding time scale of a 
perturbation). Must be smaller or equal to 365 d.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of equal length as <code>x</code> with damped variation.
The dampening is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">
  S(t+1) - S(t) = (X(t+1) - S(t)) / \tau
 </code>
</p>

<p>Where <code class="reqn">X</code> is the daily varying time series given by argument <code>x</code>,
<code class="reqn">S</code> is the dampened time returned by this function, and <code class="reqn">\tau</code> is 
the decay time scale of a perturbation, given by argument <code>tau</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dampen_vec(
 vec = 20 * (sin(doy*pi/(365)))^2 + rnorm(365, mean = 0, sd = 5),
 tau = 40 
 )

## End(Not run)
</code></pre>

<hr>
<h2 id='density_h2o'>Density of water</h2><span id='topic+density_h2o'></span>

<h3>Description</h3>

<p>Calculates the density of water as a function of temperature and atmospheric
pressure, using the Tumlirz Equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>density_h2o(tc, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="density_h2o_+3A_tc">tc</code></td>
<td>
<p>numeric, air temperature (tc), degrees C</p>
</td></tr>
<tr><td><code id="density_h2o_+3A_p">p</code></td>
<td>
<p>numeric, atmospheric pressure (p), Pa</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric, density of water, kg/m^3
</p>


<h3>References</h3>

<p>F.H. Fisher and O.E Dial, Jr. (1975) Equation of state of
pure water and sea water, Tech. Rept., Marine Physical
Laboratory, San Diego, CA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Density of water at 20 degrees C and standard atmospheric pressure
 print(density_h2o(20, 101325))

</code></pre>

<hr>
<h2 id='ftemp_arrh'>Calculates the Arrhenius-type temperature response</h2><span id='topic+ftemp_arrh'></span>

<h3>Description</h3>

<p>Given a kinetic rate at a reference temperature (argument <code>tkref</code>)
this function calculates its temperature-scaling factor
following Arrhenius kinetics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ftemp_arrh(tk, dha, tkref = 298.15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ftemp_arrh_+3A_tk">tk</code></td>
<td>
<p>Temperature (Kelvin)</p>
</td></tr>
<tr><td><code id="ftemp_arrh_+3A_dha">dha</code></td>
<td>
<p>Activation energy (J mol-1)</p>
</td></tr>
<tr><td><code id="ftemp_arrh_+3A_tkref">tkref</code></td>
<td>
<p>Reference temperature (Kelvin)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To correct for effects by temperature following Arrhenius kinetics,
and given a reference temperature <code class="reqn">T_0</code>, <code class="reqn">f</code> calculates the temperature
scaling. Arrhenius kinetics are described by an equation of form
<code class="reqn">x(T)= exp(c - \Delta H_a / (T R))</code>. The temperature-correction
function <code class="reqn">f(T, \Delta H_a)</code> is thus given by <code class="reqn">f=x(T)/x(T_0)</code> which is:
</p>
<p style="text-align: center;"><code class="reqn">
     f = exp( \Delta H_a (T - T_0) / (T_0 R T_K) )
</code>
</p>

<p><code class="reqn">\Delta H_a</code> is given by argument <code>dha</code>. <code class="reqn">T</code> is given by argument
<code>tk</code> and has to be provided in Kelvin. <code class="reqn">R</code> is the universal gas constant
and is 8.3145 J mol-1 K-1. Note that this is equivalent to 
</p>
<p style="text-align: center;"><code class="reqn">
     f = exp( (\Delta H_a/R) (1/T_0 - 1/T) )  
</code>
</p>



<h3>Value</h3>

<p>A numeric value for <code class="reqn">f</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Relative rate change from 25 to 10 degrees Celsius (percent change)
print( (1.0-ftemp_arrh( 283.15, 100000, tkref = 298.15))*100 )

</code></pre>

<hr>
<h2 id='ftemp_inst_jmax'>Calculates the instantaneous temperature response of Jmax</h2><span id='topic+ftemp_inst_jmax'></span>

<h3>Description</h3>

<p>Given Jmax at a reference temperature (argument <code>tcref</code>)
this function calculates its temperature-scaling factor following
modified Arrhenius kinetics based on Kattge &amp; Knorr (2007). 
Calculates <code class="reqn">f</code> for the conversion
</p>
<p style="text-align: center;"><code class="reqn">
   V = f Vref
</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>ftemp_inst_jmax(tcleaf, tcgrowth = tcleaf, tcref = 25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ftemp_inst_jmax_+3A_tcleaf">tcleaf</code></td>
<td>
<p>Leaf temperature, or in general the temperature relevant for 
photosynthesis (degrees Celsius)</p>
</td></tr>
<tr><td><code id="ftemp_inst_jmax_+3A_tcgrowth">tcgrowth</code></td>
<td>
<p>(Optional) Growth temperature, in the P-model, taken to be
equal to <code>tcleaf</code> (in degrees Celsius). Defaults to 
<code>tcgrowth = tcleaf</code>.</p>
</td></tr>
<tr><td><code id="ftemp_inst_jmax_+3A_tcref">tcref</code></td>
<td>
<p>Reference temperature (in degrees Celsius)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is given by Kattge &amp; Knorr (2007) as
</p>
<p style="text-align: center;"><code class="reqn">
		fv = f(T, \Delta Hv) A/B
</code>
</p>

<p>where <code class="reqn">f(T, \Delta Hv)</code> is a regular Arrhenius-type temperature response
function (see <a href="#topic+ftemp_arrh">ftemp_arrh</a>) with <code class="reqn">Hv=49884</code> J mol-1,
</p>
<p style="text-align: center;"><code class="reqn">
		A = 1 + exp( (T0 \Delta S - Hd) / (T0 R) )
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
	    B = 1 + exp( (T \Delta S - Hd) / (TK R) )
</code>
</p>

<p>Here, <code class="reqn">T</code> is in Kelvin, <code class="reqn">T0=293.15</code> K, <code class="reqn">Hd = 200000</code> J mol-1 is
the deactivation energy and <code class="reqn">R</code> is the universal gas constant and is 
8.3145 J mol-1 K-1, and
</p>
<p style="text-align: center;"><code class="reqn">
		\Delta S = aS - bS T
</code>
</p>

<p>with <code class="reqn">aS = 659.70</code> J mol-1 K-1, and <code class="reqn">bS = 0.75</code> J mol-1 K-2, and
<code class="reqn">T</code> given in degrees Celsius (!)
</p>


<h3>Value</h3>

<p>A numeric value for <code class="reqn">fv</code>
</p>


<h3>References</h3>

<p>Kattge, J. and Knorr, W.:  Temperature acclimation in a 
biochemical model of photosynthesis: a reanalysis of data from 36 species,
Plant, Cell and Environment, 30,1176–1190, 2007.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Relative change in Jmax going (instantaneously, i.e.
# not acclimatedly) from 10 to 25 degrees (percent change):
print((ftemp_inst_jmax(25)/ftemp_inst_jmax(10)-1)*100 )

</code></pre>

<hr>
<h2 id='ftemp_inst_rd'>Calculates the temperature response of dark respiration</h2><span id='topic+ftemp_inst_rd'></span>

<h3>Description</h3>

<p>Given the dark respiration at the reference temperature 25 degress Celsius,
this function calculates its temperature-scaling factor following Heskel et al. 2016.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ftemp_inst_rd(tc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ftemp_inst_rd_+3A_tc">tc</code></td>
<td>
<p>Temperature (degrees Celsius)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To correct for effects by temperature Heskel et al. 2016,
and given the reference temperature <code class="reqn">T0 =</code> 25 deg C, this calculates the temperature
scaling factor to calculate dark respiration at temperature <code class="reqn">T</code> (argument <code>tc</code>) as:
</p>
<p style="text-align: center;"><code class="reqn">
     fr = exp( 0.1012 (T0-T) - 0.0005(T0^2 - T^2) ) 
</code>
</p>

<p>where <code class="reqn">T</code> is given in degrees Celsius.
</p>


<h3>Value</h3>

<p>A numeric value for <code class="reqn">fr</code>
</p>


<h3>References</h3>

<p>Heskel,  M.,  O’Sullivan,  O.,  Reich,  P.,  Tjoelker,  M.,  Weerasinghe,  L.,  Penillard,  A.,Egerton, J., 
Creek, D., Bloomfield, K., Xiang, J., Sinca, F., Stangl, Z., Martinez-De La Torre, A., Griffin, K., 
Huntingford, C., Hurry, V., Meir, P., Turnbull, M.,and Atkin, O.:  Convergence in the temperature response 
of leaf respiration across biomes and plant functional types, Proceedings of the National Academy of Sciences,
113,  3832–3837,  doi:10.1073/pnas.1520282113,2016.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Relative change in Rd going (instantaneously, i.e. not 
## acclimatedly) from 10 to 25 degrees (percent change):
print( (ftemp_inst_rd(25)/ftemp_inst_rd(10)-1)*100 )

</code></pre>

<hr>
<h2 id='ftemp_inst_vcmax'>Calculates the instantaneous temperature response of Vcmax</h2><span id='topic+ftemp_inst_vcmax'></span>

<h3>Description</h3>

<p>Given Vcmax at a reference temperature (argument <code>tcref</code>)
this function calculates its temperature-scaling factor following modified Arrhenius
kinetics based on Kattge &amp; Knorr (2007). Calculates <code class="reqn">f</code> for the conversion
</p>
<p style="text-align: center;"><code class="reqn">
   V = f Vref
</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>ftemp_inst_vcmax(tcleaf, tcgrowth = tcleaf, tcref = 25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ftemp_inst_vcmax_+3A_tcleaf">tcleaf</code></td>
<td>
<p>Leaf temperature, or in general the temperature relevant for photosynthesis
(degrees Celsius)</p>
</td></tr>
<tr><td><code id="ftemp_inst_vcmax_+3A_tcgrowth">tcgrowth</code></td>
<td>
<p>(Optional) Growth temperature, in the P-model, taken to be equal to <code>tcleaf</code>
(in degrees Celsius). Defaults to <code>tcgrowth = tcleaf</code>.</p>
</td></tr>
<tr><td><code id="ftemp_inst_vcmax_+3A_tcref">tcref</code></td>
<td>
<p>Reference temperature (in degrees Celsius)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is given by Kattge &amp; Knorr (2007) as
</p>
<p style="text-align: center;"><code class="reqn">
		fv = f(T, \Delta Hv) A/B
</code>
</p>

<p>where <code class="reqn">f(T, \Delta Hv)</code> is a regular Arrhenius-type temperature response function (see
<a href="#topic+ftemp_arrh">ftemp_arrh</a>) with <code class="reqn">Hv=71513</code> J mol-1,
</p>
<p style="text-align: center;"><code class="reqn">
		A = 1 + exp( (T0 \Delta S - Hd) / (T0 R) )
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
	    B = 1 + exp( (T \Delta S - Hd) / (TK R) )
</code>
</p>

<p>Here, <code class="reqn">T</code> is in Kelvin, <code class="reqn">T0=293.15</code> K, <code class="reqn">Hd = 200000</code> J mol-1 is the deactivation
energy and <code class="reqn">R</code> is the universal gas constant and is 8.3145 J mol-1 K-1, and
</p>
<p style="text-align: center;"><code class="reqn">
		\Delta S = aS - bS T
</code>
</p>

<p>with <code class="reqn">aS = 668.39</code> J mol-1 K-1, and <code class="reqn">bS = 1.07</code> J mol-1 K-2, and <code class="reqn">T</code> given in
degrees Celsius (!)
</p>


<h3>Value</h3>

<p>A numeric value for <code class="reqn">fv</code>
</p>


<h3>References</h3>

<p>Kattge, J. and Knorr, W.:  Temperature acclimation in a biochemical model of
photosynthesis: a reanalysis of data from 36 species, Plant, Cell and Environment, 30,1176–1190, 2007.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Relative change in Vcmax going (instantaneously, i.e. 
## not acclimatedly) from 10 to 25 degrees (percent change):
print((ftemp_inst_vcmax(25)/ftemp_inst_vcmax(10)-1)*100 )

</code></pre>

<hr>
<h2 id='ftemp_kphio'>Calculates the temperature dependence of the quantum yield efficiency</h2><span id='topic+ftemp_kphio'></span>

<h3>Description</h3>

<p>Calculates the temperature dependence of the quantum yield efficiency
following the temperature dependence of the maximum quantum yield of photosystem II
in light-adapted tobacco leaves, determined by Bernacchi et al. (2003)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ftemp_kphio(tc, c4 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ftemp_kphio_+3A_tc">tc</code></td>
<td>
<p>Temperature, relevant for photosynthesis (degrees Celsius)</p>
</td></tr>
<tr><td><code id="ftemp_kphio_+3A_c4">c4</code></td>
<td>
<p>Boolean specifying whether fitted temperature response for C4 plants
is used. Defaults to <code>FALSE</code> (C3 photoynthesis temperature resposne following
Bernacchi et al., 2003 is used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The temperature factor for C3 photosynthesis (argument <code>c4 = FALSE</code>) is calculated
based on Bernacchi et al. (2003) as
</p>
<p style="text-align: center;"><code class="reqn">
				\phi(T) = 0.352 + 0.022 T - 0.00034 T^2
      </code>
</p>

<p>The temperature factor for C4 (argument <code>c4 = TRUE</code>) photosynthesis is calculated based on
unpublished work as
</p>
<p style="text-align: center;"><code class="reqn">
				\phi(T) = -0.008 + 0.00375 T - 0.58e-4 T^2
      </code>
</p>

<p>The factor <code class="reqn">\phi(T)</code> is to be multiplied with leaf absorptance and the fraction
of absorbed light that reaches photosystem II. In the P-model these additional factors
are lumped into a single apparent quantum yield efficiency parameter (argument <code>kphio</code>
to function <a href="#topic+rpmodel">rpmodel</a>).
</p>


<h3>Value</h3>

<p>A numeric value for <code class="reqn">\phi(T)</code>
</p>


<h3>References</h3>

<p>Bernacchi, C. J., Pimentel, C., and Long, S. P.:  In vivo temperature
response func-tions  of  parameters required  to  model  RuBP-limited
photosynthesis,  Plant  Cell Environ., 26, 1419–1430, 2003
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Relative change in the quantum yield efficiency
## between 5 and 25 degrees celsius (percent change):
print(paste((ftemp_kphio(25.0)/ftemp_kphio(5.0)-1)*100 ))

</code></pre>

<hr>
<h2 id='gammastar'>Calculates the CO2 compensation point</h2><span id='topic+gammastar'></span>

<h3>Description</h3>

<p>Calculates the photorespiratory CO2 compensation point in absence of dark
respiration, <code class="reqn">\Gamma*</code> (Farquhar, 1980).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gammastar(tc, patm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gammastar_+3A_tc">tc</code></td>
<td>
<p>Temperature, relevant for photosynthesis (degrees Celsius)</p>
</td></tr>
<tr><td><code id="gammastar_+3A_patm">patm</code></td>
<td>
<p>Atmospheric pressure (Pa)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The temperature and pressure-dependent photorespiratory
compensation point in absence of dark respiration <code class="reqn">\Gamma* (T,p)</code>
is calculated from its value at standard temperature (<code class="reqn">T0 = 25 </code>deg C)
and atmospheric pressure (<code class="reqn">p0 = 101325</code> Pa), referred to as <code class="reqn">\Gamma*0</code>,
quantified by Bernacchi et al. (2001) to 4.332 Pa (their value in molar
concentration units is multiplied here with 101325 Pa to yield 4.332 Pa).
<code class="reqn">\Gamma*0</code> is modified by temperature following an Arrhenius-type temperature
response function <code class="reqn">f(T, \Delta Ha)</code> (implemented by <a href="#topic+ftemp_arrh">ftemp_arrh</a>)
with activation energy <code class="reqn">\Delta Ha = 37830</code> J mol-1  and is corrected for
atmospheric pressure <code class="reqn">p(z)</code> (see <a href="#topic+patm">patm</a>) at elevation <code class="reqn">z</code>.
</p>
<p style="text-align: center;"><code class="reqn">
      \Gamma* = \Gamma*0 f(T, \Delta Ha) p(z) / p_0
</code>
</p>

<p><code class="reqn">p(z)</code> is given by argument <code>patm</code>.
</p>


<h3>Value</h3>

<p>A numeric value for <code class="reqn">\Gamma*</code> (in Pa)
</p>


<h3>References</h3>

<p>Farquhar,  G.  D.,  von  Caemmerer,  S.,  and  Berry,  J.  A.:
A  biochemical  model  of photosynthetic CO2 assimilation in leaves of
C 3 species, Planta, 149, 78–90, 1980.
</p>
<p>Bernacchi,  C.  J.,  Singsaas,  E.  L.,  Pimentel,  C.,  Portis,  A.
R.  J.,  and  Long,  S.  P.:Improved temperature response functions
for models of Rubisco-limited photosyn-thesis, Plant, Cell and
Environment, 24, 253–259, 2001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print("CO2 compensation point at 20 degrees Celsius and standard atmosphere (in Pa):")
print(gammastar(20, 101325))

</code></pre>

<hr>
<h2 id='kmm'>Calculates the Michaelis Menten coefficient for Rubisco-limited photosynthesis</h2><span id='topic+kmm'></span>

<h3>Description</h3>

<p>Calculates the Michaelis Menten coefficient of Rubisco-limited assimilation
as a function of temperature and atmospheric pressure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmm(tc, patm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmm_+3A_tc">tc</code></td>
<td>
<p>Temperature, relevant for photosynthesis (deg C)</p>
</td></tr>
<tr><td><code id="kmm_+3A_patm">patm</code></td>
<td>
<p>Atmospheric pressure (Pa)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Michaelis-Menten coefficient <code class="reqn">K</code> of Rubisco-limited
photosynthesis is determined by the Michalis-Menten constants for
O2 and CO2 (Farquhar, 1980) according to:
</p>
<p style="text-align: center;"><code class="reqn">
  K = Kc ( 1 + pO2 / Ko)
</code>
</p>

<p>where <code class="reqn">Kc</code> is the Michaelis-Menten constant for CO2 (Pa), <code class="reqn">Ko</code> is
the Michaelis-Menten constant for O2 (Pa), and <code class="reqn">pO2</code> is the partial
pressure of oxygen (Pa), calculated as <code class="reqn">0.209476 p</code>, where <code class="reqn">p</code> is
given by argument <code>patm</code>.  <code class="reqn">Kc</code> and <code class="reqn">Ko</code> follow a temperature
dependence, given by the Arrhenius Equation <code class="reqn">f</code> (implemented by
<a href="#topic+ftemp_arrh">ftemp_arrh</a>):
</p>
<p style="text-align: center;"><code class="reqn">
   Kc = Kc25 f(T, \Delta Hkc)
</code>
</p>

<p style="text-align: center;"><code class="reqn">
   Ko = Ko25 f(T, \Delta Hko)
</code>
</p>

<p>Values <code class="reqn">\Delta Hkc</code> (79430 J mol-1), <code class="reqn">\Delta Hko</code> (36380 J mol-1),
<code class="reqn">Kc25</code> (39.97 Pa), and <code class="reqn">Ko25</code> (27480 Pa) are taken from Bernacchi
et al. (2001) and have been converted from values given therein to units of Pa
by multiplication with the standard atmosphere (101325 Pa). <code class="reqn">T</code> is given
by the argument <code>tc</code>.
</p>


<h3>Value</h3>

<p>A numeric value for <code class="reqn">K</code> (in Pa)
</p>


<h3>References</h3>

<p>Farquhar,  G.  D.,  von  Caemmerer,  S.,  and  Berry,  J.  A.:
A  biochemical  model  of photosynthetic CO2 assimilation in leaves of
C 3 species, Planta, 149, 78–90, 1980.
</p>
<p>Bernacchi,  C.  J.,  Singsaas,  E.  L.,  Pimentel,  C.,  Portis,  A.
R.  J.,  and  Long,  S.  P.:Improved temperature response functions
for models of Rubisco-limited photosyn-thesis, Plant, Cell and
Environment, 24, 253–259, 2001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print("Michaelis-Menten coefficient at 20 degrees Celsius and standard atmosphere (in Pa):")
print(kmm(20, 101325))

</code></pre>

<hr>
<h2 id='patm'>Calculates atmospheric pressure</h2><span id='topic+patm'></span>

<h3>Description</h3>

<p>Calculates atmospheric pressure as a function of elevation, by default assuming 
standard atmosphere (101325 Pa at sea level)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patm(elv, patm0 = 101325)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="patm_+3A_elv">elv</code></td>
<td>
<p>Elevation above sea-level (m.a.s.l.)</p>
</td></tr>
<tr><td><code id="patm_+3A_patm0">patm0</code></td>
<td>
<p>(Optional) Atmospheric pressure at sea level (Pa), defaults to 101325 Pa.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The elevation-dependence of atmospheric pressure is computed by 
assuming a linear decrease in temperature with elevation and a mean 
adiabatic lapse rate (Berberan-Santos et al., 1997):
</p>
<p style="text-align: center;"><code class="reqn">
   p(z) = p0 ( 1 - Lz / TK0) ^ ( g M / (RL) )
</code>
</p>

<p>where <code class="reqn">z</code> is the elevation above mean sea level (m, argument <code>elv</code>), 
<code class="reqn">g</code> is the gravity constant (9.80665 m s-2), <code class="reqn">p0</code> is the atmospheric 
pressure at 0 m a.s.l. (argument <code>patm0</code>, defaults to 101325 Pa), 
<code class="reqn">L</code> is the mean adiabatic lapse rate (0.0065 K m-2), 
<code class="reqn">M</code> is the molecular weight for dry air (0.028963 kg mol-1), 
<code class="reqn">R</code> is the universal gas constant (8.3145 J mol-1 K-1), and <code class="reqn">TK0</code>
is the standard temperature (298.15 K, corresponds to 25 deg C).
</p>


<h3>Value</h3>

<p>A numeric value for <code class="reqn">p</code>
</p>


<h3>References</h3>

<p>Allen, R. G., Pereira, L. S., Raes, D., Smith, M.: 
FAO Irrigation and Drainage Paper No. 56, Food and 
Agriculture Organization of the United Nations, 1998
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print("Standard atmospheric pressure, in Pa, corrected for 1000 m.a.s.l.:")
print(patm(1000))

</code></pre>

<hr>
<h2 id='rpmodel'>Invokes a P-model function call</h2><span id='topic+rpmodel'></span>

<h3>Description</h3>

<p>R implementation of the P-model and its 
corollary predictions (Prentice et al., 2014; Han et al., 2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpmodel(
  tc,
  vpd,
  co2,
  fapar,
  ppfd,
  patm = NA,
  elv = NA,
  kphio = ifelse(do_ftemp_kphio, ifelse(do_soilmstress, 0.087182, 0.081785), 0.049977),
  beta = 146,
  soilm = stopifnot(!do_soilmstress),
  meanalpha = 1,
  apar_soilm = 0,
  bpar_soilm = 0.733,
  c4 = FALSE,
  method_optci = "prentice14",
  method_jmaxlim = "wang17",
  do_ftemp_kphio = TRUE,
  do_soilmstress = FALSE,
  returnvar = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpmodel_+3A_tc">tc</code></td>
<td>
<p>Temperature, relevant for photosynthesis (deg C)</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_vpd">vpd</code></td>
<td>
<p>Vapour pressure deficit (Pa)</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_co2">co2</code></td>
<td>
<p>Atmospheric CO2 concentration (ppm)</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_fapar">fapar</code></td>
<td>
<p>(Optional) Fraction of absorbed photosynthetically active
radiation (unitless, defaults to <code>NA</code>)</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_ppfd">ppfd</code></td>
<td>
<p>Incident photosynthetic photon flux density 
(mol m-2 d-1, defaults to <code>NA</code>). Note that the units of 
<code>ppfd</code> (per area and per time) determine the units of outputs 
<code>lue</code>, <code>gpp</code>, <code>vcmax</code>, and <code>rd</code>. For example, 
if <code>ppfd</code> is provided in units of mol m-2 month-1, then
respective output variables are returned as per unit months.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_patm">patm</code></td>
<td>
<p>Atmospheric pressure (Pa). When provided, overrides
<code>elv</code>, otherwise <code>patm</code> is calculated using standard
atmosphere (101325 Pa), corrected for elevation (argument <code>elv</code>),
using the function <a href="#topic+patm">patm</a>.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_elv">elv</code></td>
<td>
<p>Elevation above sea-level (m.a.s.l.). Is used only for 
calculating atmospheric pressure (using standard atmosphere (101325 Pa),
corrected for elevation (argument <code>elv</code>), using the function
<a href="#topic+patm">patm</a>), if argument <code>patm</code> is not provided. If argument
<code>patm</code> is provided, <code>elv</code> is overridden.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_kphio">kphio</code></td>
<td>
<p>Apparent quantum yield efficiency (unitless). Defaults to
0.081785 for <code>method_jmaxlim="wang17", do_ftemp_kphio=TRUE, 
do_soilmstress=FALSE</code>, 0.087182 for <code>method_jmaxlim="wang17",
do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>, and 0.049977 for 
<code>method_jmaxlim="wang17", do_ftemp_kphio=FALSE, do_soilmstress=FALSE</code>,
corresponding to the empirically fitted value as presented in Stocker et al.
(2019) Geosci. Model Dev. for model setup 'BRC', 'FULL', and 'ORG' 
respectively.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_beta">beta</code></td>
<td>
<p>Unit cost ratio. Defaults to 146.0 (see Stocker et al., 2019).</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_soilm">soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) Relative 
soil moisture as a fraction of field capacity (unitless). Defaults to 1.0 
(no soil moisture stress). This information is used to calculate
an empirical soil moisture stress factor (<a href="#topic+soilmstress">soilmstress</a>) whereby
the sensitivity is determined by average aridity, defined by the local 
annual mean ratio of actual over potential evapotranspiration, supplied by
argument <code>meanalpha</code>.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_meanalpha">meanalpha</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) Local 
annual mean ratio of actual over potential evapotranspiration, measure for 
average aridity. Defaults to 1.0.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_apar_soilm">apar_soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) 
Parameter determining the sensitivity of the empirical soil moisture stress 
function. Defaults to 0.0, the empirically fitted value as presented in 
Stocker et al. (2019) Geosci. Model Dev. for model setup 'FULL' 
(corresponding to a setup with <code>method_jmaxlim="wang17", 
do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_bpar_soilm">bpar_soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) 
Parameter determining the sensitivity of the empirical soil moisture stress
function. Defaults to 0.7330, the empirically fitted value as presented in 
Stocker et al. (2019) Geosci. Model Dev. for model setup 'FULL' 
(corresponding to a setup with <code>method_jmaxlim="wang17", 
do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_c4">c4</code></td>
<td>
<p>(Optional) A logical value specifying whether the C3 or C4 
photosynthetic pathway is followed.Defaults to <code>FALSE</code>. If <code>TRUE</code>,
the leaf-internal CO2 concentration is assumed to be very large and 
<code class="reqn">m</code> (returned variable <code>mj</code>) tends to 1, and <code class="reqn">m'</code> tends to 
0.669 (with <code>c = 0.41</code>).</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_method_optci">method_optci</code></td>
<td>
<p>(Optional) A character string specifying which method is
to be used for calculating optimal ci:ca. Defaults to <code>"prentice14"</code>.
Available also <code>"prentice14_num"</code> for a numerical solution to the same
optimization criterium as used for <code>"prentice14"</code>.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_method_jmaxlim">method_jmaxlim</code></td>
<td>
<p>(Optional) A character string specifying which method 
is to be used for factoring in Jmax limitation. Defaults to <code>"wang17"</code>,
based on Wang Han et al. 2017 Nature Plants and (Smith 1937). Available is 
also <code>"smith19"</code>, following the method by Smith et al., 2019 Ecology 
Letters, and <code>"none"</code> for ignoring effects of Jmax limitation.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_do_ftemp_kphio">do_ftemp_kphio</code></td>
<td>
<p>(Optional) A logical specifying whether 
temperature-dependence of quantum yield efficiency after Bernacchi et al., 
2003 is to be accounted for. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_do_soilmstress">do_soilmstress</code></td>
<td>
<p>(Optional) A logical specifying whether an empirical 
soil moisture stress factor is to be applied to down-scale light use 
efficiency (and only light use efficiency). Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_returnvar">returnvar</code></td>
<td>
<p>(Optional) A character string of vector of character strings
specifying which variables are to be returned (see return below).</p>
</td></tr>
<tr><td><code id="rpmodel_+3A_verbose">verbose</code></td>
<td>
<p>Logical, defines whether verbose messages are printed. 
Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of numeric values (including temperature and pressure 
dependent parameters of the photosynthesis model, P-model predictions, 
including all its corollary). This includes :
</p>

<ul>
<li> <p><code>ca</code>: Ambient CO2 expressed as partial pressure (Pa)
</p>
</li>
<li> <p><code>gammastar</code>: Photorespiratory compensation point <code class="reqn">\Gamma*</code>, 
(Pa), see <a href="#topic+gammastar">gammastar</a>.
</p>
</li>
<li> <p><code>kmm</code>: Michaelis-Menten coefficient <code class="reqn">K</code> for photosynthesis 
(Pa), see <a href="#topic+kmm">kmm</a>.
</p>
</li>
<li> <p><code>ns_star</code>: Change in the viscosity of water, relative to its 
value at 25 deg C (unitless).
</p>
<p style="text-align: center;"><code class="reqn">\eta* = \eta(T) / \eta(25 deg C)</code>
</p>

<p>This is used to scale the unit cost of transpiration. 
Calculated following Huber et al. (2009).
</p>
</li>
<li> <p><code>chi</code>: Optimal ratio of leaf internal to ambient CO2 (unitless). 
Derived following Prentice et al.(2014) as:
</p>
<p style="text-align: center;"><code class="reqn">
  \chi = \Gamma* / ca + (1- \Gamma* / ca) \xi / (\xi + \sqrt D )
  </code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
   \xi = \sqrt (\beta (K+ \Gamma*) / (1.6 \eta*))
  </code>
</p>

<p><code class="reqn">\beta</code> is given by argument <code>beta</code>, <code class="reqn">K</code> is 
<code>kmm</code> (see <a href="#topic+kmm">kmm</a>), <code class="reqn">\Gamma*</code> is 
<code>gammastar</code> (see <a href="#topic+gammastar">gammastar</a>). <code class="reqn">\eta*</code> is <code>ns_star</code>.
<code class="reqn">D</code> is the vapour pressure deficit (argument <code>vpd</code>), <code class="reqn">ca</code> is 
the ambient CO2 partial pressure in Pa (<code>ca</code>).
</p>
</li>
<li> <p><code>ci</code>: Leaf-internal CO2 partial pressure (Pa), calculated as <code class="reqn">(\chi ca)</code>.
</p>
</li>
<li> <p><code>lue</code>: Light use efficiency (g C / mol photons), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                             LUE = \phi(T) \phi0 m' Mc
                        </code>
</p>

<p>where <code class="reqn">\phi(T)</code> is the temperature-dependent quantum yield efficiency modifier
(<a href="#topic+ftemp_kphio">ftemp_kphio</a>) if <code>do_ftemp_kphio==TRUE</code>, and 1 otherwise. <code class="reqn">\phi 0</code>
is given by argument <code>kphio</code>.
<code class="reqn">m'=m</code> if <code>method_jmaxlim=="none"</code>, otherwise
</p>
<p style="text-align: center;"><code class="reqn">
                               m' = m \sqrt( 1 - (c/m)^(2/3) )
                        </code>
</p>

<p>with <code class="reqn">c=0.41</code> (Wang et al., 2017) if <code>method_jmaxlim=="wang17"</code>. <code class="reqn">Mc</code> is
the molecular mass of C (12.0107 g mol-1). <code class="reqn">m</code> is given returned variable <code>mj</code>.
If <code>do_soilmstress==TRUE</code>, <code class="reqn">LUE</code> is multiplied with a soil moisture stress factor,
calculated with <a href="#topic+soilmstress">soilmstress</a>.
</p>
</li>
<li> <p><code>mj</code>: Factor in the light-limited assimilation rate function, given by
</p>
<p style="text-align: center;"><code class="reqn">
                            m = (ci - \Gamma*) / (ci + 2 \Gamma*)
                       </code>
</p>

<p>where <code class="reqn">\Gamma*</code> is given by <code>gammastar</code>.
</p>
</li>
<li> <p><code>mc</code>: Factor in the Rubisco-limited assimilation rate function, given by
</p>
<p style="text-align: center;"><code class="reqn">
                            mc = (ci - \Gamma*) / (ci + K)
                       </code>
</p>

<p>where <code class="reqn">K</code> is given by <code>kmm</code>.
</p>
</li>
<li> <p><code>gpp</code>: Gross primary production (g C m-2), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                           GPP = Iabs LUE
                       </code>
</p>

<p>where <code class="reqn">Iabs</code> is given by <code>fapar*ppfd</code> (arguments), and is
<code>NA</code> if <code>fapar==NA</code> or <code>ppfd==NA</code>. Note that <code>gpp</code> scales with
absorbed light. Thus, its units depend on the units in which <code>ppfd</code> is given.
</p>
</li>
<li> <p><code>iwue</code>: Intrinsic water use efficiency (iWUE, Pa), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                             iWUE = ca (1-\chi)/(1.6)
                       </code>
</p>

</li>
<li> <p><code>gs</code>: Stomatal conductance (gs, in mol C m-2 Pa-1), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                            gs = A / (ca (1-\chi))
                       </code>
</p>

<p>where <code class="reqn">A</code> is <code>gpp</code><code class="reqn">/Mc</code>.
</p>
</li>
<li> <p><code>vcmax</code>: Maximum carboxylation capacity <code class="reqn">Vcmax</code> (mol C m-2) at growth temperature (argument
<code>tc</code>), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                           Vcmax = \phi(T) \phi0 Iabs n
                      </code>
</p>

<p>where <code class="reqn">n</code> is given by <code class="reqn">n=m'/mc</code>.
</p>
</li>
<li> <p><code>vcmax25</code>: Maximum carboxylation capacity <code class="reqn">Vcmax</code> (mol C m-2) normalised to 25 deg C
following a modified Arrhenius equation, calculated as <code class="reqn">Vcmax25 = Vcmax / fv</code>,
where <code class="reqn">fv</code> is the instantaneous temperature response by Vcmax and is implemented
by function <a href="#topic+ftemp_inst_vcmax">ftemp_inst_vcmax</a>.
</p>
</li>
<li> <p><code>jmax</code>: The maximum rate of RuBP regeneration () at growth temperature (argument
<code>tc</code>), calculated using
</p>
<p style="text-align: center;"><code class="reqn">
                           A_J = A_C
                      </code>
</p>

</li>
<li> <p><code>rd</code>: Dark respiration <code class="reqn">Rd</code> (mol C m-2), calculated as
</p>
<p style="text-align: center;"><code class="reqn">
                         Rd = b0 Vcmax (fr / fv)
                     </code>
</p>

<p>where <code class="reqn">b0</code> is a constant and set to 0.015 (Atkin et al., 2015), <code class="reqn">fv</code> is the
instantaneous temperature response by Vcmax and is implemented by function
<a href="#topic+ftemp_inst_vcmax">ftemp_inst_vcmax</a>, and <code class="reqn">fr</code> is the instantaneous temperature response
of dark respiration following Heskel et al. (2016) and is implemented by function
<a href="#topic+ftemp_inst_rd">ftemp_inst_rd</a>.
</p>
</li></ul>

<p>Additional variables are contained in the returned list if argument <code>method_jmaxlim=="smith19"</code>
</p>

<ul>
<li> <p><code>omega</code>: Term corresponding to <code class="reqn">\omega</code>, defined by Eq. 16 in
Smith et al. (2019), and Eq. E19 in Stocker et al. (2019).
</p>
</li>
<li> <p><code>omega_star</code>: Term corresponding to <code class="reqn">\omega^\ast</code>, defined by
Eq. 18 in Smith et al. (2019), and Eq. E21 in Stocker et al. (2019).
</p>
</li></ul>



<h3>References</h3>

<p>Bernacchi, C. J., Pimentel, C., and Long, S. P.:  In vivo temperature response func-tions  of  parameters
required  to  model  RuBP-limited  photosynthesis,  Plant  Cell Environ., 26, 1419–1430, 2003
</p>
<p>Heskel,  M.,  O’Sullivan,  O.,  Reich,  P.,  Tjoelker,  M.,  Weerasinghe,  L.,  Penillard,  A.,Egerton, J.,
Creek, D., Bloomfield, K., Xiang, J., Sinca, F., Stangl, Z., Martinez-De La Torre, A., Griffin, K.,
Huntingford, C., Hurry, V., Meir, P., Turnbull, M.,and Atkin, O.:  Convergence in the temperature response
of leaf respiration across biomes and plant functional types, Proceedings of the National Academy of Sciences,
113,  3832–3837,  doi:10.1073/pnas.1520282113,2016.
</p>
<p>Huber,  M.  L.,  Perkins,  R.  A.,  Laesecke,  A.,  Friend,  D.  G.,  Sengers,  J.  V.,  Assael,M. J.,
Metaxa, I. N., Vogel, E., Mares, R., and Miyagawa, K.:  New international formulation for the viscosity
of H2O, Journal of Physical and Chemical ReferenceData, 38, 101–125, 2009
</p>
<p>Prentice,  I. C.,  Dong,  N.,  Gleason,  S. M.,  Maire,  V.,  and Wright,  I. J.:  Balancing the costs
of carbon gain and water transport:  testing a new theoretical frameworkfor  plant  functional  ecology,
Ecology  Letters,  17,  82–91,  10.1111/ele.12211,http://dx.doi.org/10.1111/ele.12211, 2014.
</p>
<p>Wang, H., Prentice, I. C., Keenan, T. F., Davis, T. W., Wright, I. J., Cornwell, W. K.,Evans, B. J.,
and Peng, C.:  Towards a universal model for carbon dioxide uptake by plants, Nat Plants, 3, 734–741, 2017.
Atkin, O. K., et al.:  Global variability in leaf respiration in relation to climate, plant func-tional
types and leaf traits, New Phytologist, 206, 614–636, doi:10.1111/nph.13253,
https://nph.onlinelibrary.wiley.com/doi/abs/10.1111/nph.13253.
</p>
<p>Smith, N. G., Keenan, T. F., Colin Prentice, I. , Wang, H. , Wright, I. J., Niinemets, U. , Crous, K. Y.,
Domingues, T. F., Guerrieri, R. , Yoko Ishida, F. , Kattge, J. , Kruger, E. L., Maire, V. , Rogers, A. ,
Serbin, S. P., Tarvainen, L. , Togashi, H. F., Townsend, P. A., Wang, M. , Weerasinghe, L. K. and Zhou, S.
(2019), Global photosynthetic capacity is optimized to the environment. Ecol Lett, 22: 506-517.
doi:10.1111/ele.13210
</p>
<p>Stocker, B. et al. Geoscientific Model Development Discussions (in prep.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 rpmodel(
  tc = 20,
  vpd = 1000,
  co2 = 400,
  ppfd = 30,
  elv = 0)

## End(Not run)

</code></pre>

<hr>
<h2 id='soilmstress'>Calculates an empirical soil moisture stress factor</h2><span id='topic+soilmstress'></span>

<h3>Description</h3>

<p>Calculates an empirical soil moisture stress factor as a function of relative
soil moisture (fraction of field capacity).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soilmstress(soilm, meanalpha = 1, apar_soilm = 0, bpar_soilm = 0.685)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="soilmstress_+3A_soilm">soilm</code></td>
<td>
<p>Relative soil moisture as a fraction
of field capacity (unitless). Defaults to 1.0 (no soil moisture stress).</p>
</td></tr>
<tr><td><code id="soilmstress_+3A_meanalpha">meanalpha</code></td>
<td>
<p>Local annual mean ratio of actual over potential 
evapotranspiration, measure for average aridity. Defaults to 1.0.</p>
</td></tr>
<tr><td><code id="soilmstress_+3A_apar_soilm">apar_soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>)
Parameter determining the sensitivity of the empirical soil moisture stress
function. Defaults to 0.0, the empirically fitted value as presented in Stocker
et al. (2019) Geosci. Model Dev. for model setup 'FULL' (corresponding to a setup
with <code>method_jmaxlim="wang17", do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p>
</td></tr>
<tr><td><code id="soilmstress_+3A_bpar_soilm">bpar_soilm</code></td>
<td>
<p>(Optional, used only if <code>do_soilmstress==TRUE</code>) Parameter
determining the sensitivity of the empirical soil moisture stress function. Defaults
to ~0.6, the empirically fitted value as presented in Stocker et al. (2019) Geosci. Model Dev.
for model setup 'FULL' (corresponding to a setup with <code>method_jmaxlim="wang17",
do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The soil moisture stress factor is calculated using a quadratic function that
is 1 above <code>soilm</code> = 0.6 and has a sensitivity, given by the y-axis cutoff,
(zero soil moisture), determined  by average aridity (argument <code>meanalpha</code>) as:
</p>
<p style="text-align: center;"><code class="reqn">
    \beta = q(\theta - \theta*)^2 + 1
</code>
</p>

<p>for <code class="reqn">\theta &lt; \theta*</code> and <code class="reqn">\beta = 1.0</code> otherwise. <code class="reqn">\theta*</code> is fixed at 0.6.
<code class="reqn">q</code> is the sensitivity parameter and is calculated as a linear function of average aridity,
quantified by the local annual mean ratio of actual over potential evapotranspiration, termed
<code class="reqn">\alpha</code>:
</p>
<p style="text-align: center;"><code class="reqn">
     q=(\beta0-1)/(\theta*-\theta0)^2
</code>
</p>

<p><code class="reqn">\theta0</code> is 0.0, and
</p>
<p style="text-align: center;"><code class="reqn">
     \beta0 = a + b \alpha
</code>
</p>

<p><code class="reqn">a</code> is given by argument <code>apar</code>, <code class="reqn">b</code> is given by argument <code>bpar</code>.
</p>


<h3>Value</h3>

<p>A numeric value for <code class="reqn">\beta</code>
</p>


<h3>References</h3>

<p>Stocker, B. et al. Geoscientific Model Development Discussions (in prep.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Relative reduction (%) in GPP due to soil moisture stress at
## relative soil water content ('soilm') of 0.2:
print((soilmstress(0.2)-1)*100 )

</code></pre>

<hr>
<h2 id='viscosity_h2o'>Viscosity of water</h2><span id='topic+viscosity_h2o'></span>

<h3>Description</h3>

<p>Calculates the viscosity of water as a function of temperature and atmospheric
pressure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>viscosity_h2o(tc, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="viscosity_h2o_+3A_tc">tc</code></td>
<td>
<p>numeric, air temperature (tc), degrees C</p>
</td></tr>
<tr><td><code id="viscosity_h2o_+3A_p">p</code></td>
<td>
<p>numeric, atmospheric pressure (p), Pa</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric, viscosity of water (mu), Pa s
</p>


<h3>References</h3>

<p>Huber, M. L., R. A. Perkins, A. Laesecke, D. G. Friend, J. V.
Sengers, M. J. Assael, ..., K. Miyagawa (2009) New
international formulation for the viscosity of H2O, J. Phys.
Chem. Ref. Data, Vol. 38(2), pp. 101-125.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print("Density of water at 20 degrees C and standard atmospheric pressure:")
print(density_h2o(20, 101325))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
