<!DOCTYPE html><html><head><title>Help for package PerFit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PerFit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PerFit-package'>
<p>Person Fit</p></a></li>
<li><a href='#A+2C+20D+2C+20E+20statistics'><p>Agreement, disagreement, and dependability statistics</p></a></li>
<li><a href='#cutoff'><p>Compute a cutoff value given the scores of a person-fit statistic</p></a></li>
<li><a href='#flagged.resp'><p>Find (potentially) aberrant response patterns</p></a></li>
<li><a href='#G+2C+20Gnormed'><p>Number of Guttman errors</p></a></li>
<li><a href='#Gpoly+2C+20Gnormed.poly'><p>Number of Guttman errors for polytomous items</p></a></li>
<li><a href='#Ht+20statistic'><p>Ht person-fit statistic</p></a></li>
<li><a href='#Inadequacy+20scale+20data'><p>The NPV-J inadequacy scale data</p></a></li>
<li><a href='#Intelligence+20data'><p>Intelligence data (number completion)</p></a></li>
<li><a href='#lz+2C+20lzstar'><p>lz and lzstar person-fit statistics</p></a></li>
<li><a href='#lzpoly'><p>lzpoly person-fit statistic</p></a></li>
<li><a href='#NCI+20statistic'><p>NCI person-fit statistic</p></a></li>
<li><a href='#PerFit.PFS'><p>Compute several person-fit statistics</p></a></li>
<li><a href='#PerFit.SE'><p>Compute standard errors for person fit statistics</p></a></li>
<li><a href='#Personal+20biserial+20statistic'><p>Personal biserial statistic</p></a></li>
<li><a href='#Physical+20Functioning'><p>The SF-36 physical functioning data</p></a></li>
<li><a href='#plot+20PerFit'><p>Plot method for objects of class &quot;PerFit&quot;</p></a></li>
<li><a href='#PRFplot'><p>Person response function (PRF)</p></a></li>
<li><a href='#print+20PerFit'><p>Print method for objects of class &quot;PerFit&quot;</p></a></li>
<li><a href='#summary+20PerFit'><p>Summary method for objects of class &quot;PerFit&quot;</p></a></li>
<li><a href='#The+20caution+20statistic'><p>C.Sato, Cstar person-fit statistics</p></a></li>
<li><a href='#U3+2C+20ZU3'><p>U3, ZU3 person-fit statistics</p></a></li>
<li><a href='#U3poly'><p>U3poly person-fit statistic</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Person Fit</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-14</td>
</tr>
<tr>
<td>Author:</td>
<td>Jorge N. Tendeiro</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jorge N. Tendeiro &lt;tendeiro@hiroshima-u.ac.jp&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Several person-fit statistics 
  (PFSs; Meijer and Sijtsma, 2001, &lt;<a href="https://doi.org/10.1177%2F01466210122031957">doi:10.1177/01466210122031957</a>&gt;) 
  are offered. These statistics allow assessing whether
  individual response patterns to tests or questionnaires are (im)plausible given 
  the other respondents in the sample or given a specified item response theory model. Some PFSs apply to 
  dichotomous data, such as the likelihood-based PFSs (lz, lz*) and the group-based PFSs 
  (personal biserial correlation, caution index, (normed) number of Guttman errors, 
  agreement/disagreement/dependability statistics, U3, ZU3, NCI, Ht). PFSs suitable to polytomous data include
  extensions of lz, U3, and (normed) number of Guttman errors. </td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, fda, Hmisc, irtoys, MASS, Matrix</td>
</tr>
<tr>
<td>Depends:</td>
<td>ltm, mirt</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-15 07:20:08 UTC; jorgerei</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-15 07:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='PerFit-package'>
Person Fit
</h2><span id='topic+PerFit-package'></span><span id='topic+PerFit'></span>

<h3>Description</h3>

<p>Person fit consists of a set of techniques aimed at detecting unusual responses to tests or questionnaires. There are several person-fit statistics available in the literature, see Karabatsos (2003) and Meijer and Sijtsma (2001) for comprehensive reviews. Both dichotomous and polytomous types of items are considered. This R-package outputs the values of the chosen person-fit statistic, the IDs of the respondents that were flagged, and plots the sample distribution of the scores of the person-fit statistic. Nonparametric person response functions (Sijtsma and Meijer, 2001) may also be requested in order to help interpreting individual answering behaviors (dichotomous data only).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PerFit</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Person Fit</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.4.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-10-14</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Jorge N. Tendeiro</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Jorge N. Tendeiro &lt;tendeiro@hiroshima-u.ac.jp&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Several person-fit statistics 
  (PFSs; Meijer and Sijtsma, 2001, &lt;doi:10.1177/01466210122031957&gt;) 
  are offered. These statistics allow assessing whether
  individual response patterns to tests or questionnaires are (im)plausible given 
  the other respondents in the sample or given a specified item response theory model. Some PFSs apply to 
  dichotomous data, such as the likelihood-based PFSs (lz, lz*) and the group-based PFSs 
  (personal biserial correlation, caution index, (normed) number of Guttman errors, 
  agreement/disagreement/dependability statistics, U3, ZU3, NCI, Ht). PFSs suitable to polytomous data include
  extensions of lz, U3, and (normed) number of Guttman errors. </td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> stats, graphics, fda, Hmisc, irtoys, MASS, Matrix</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> ltm, mirt</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
RoxygenNote: </td><td style="text-align: left;"> 7.1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
A.KB                    Agreement, disagreement, and dependability
                        statistics
Cstar                   C.Sato, Cstar person-fit statistics
G                       Number of Guttman errors
Gpoly                   Number of Guttman errors for polytomous items
Ht                      Ht person-fit statistic
InadequacyData          The NPV-J inadequacy scale data
IntelligenceData        Intelligence data (number completion)
NCI                     NCI person-fit statistic
PRFplot                 Person response function (PRF)
PerFit-package          Person Fit
PerFit.PFS              Compute several person-fit statistics
PerFit.SE               Compute standard errors for person fit
                        statistics
PhysFuncData            The SF-36 physical functioning data
U3                      U3, ZU3 person-fit statistics
U3poly                  U3poly person-fit statistic
cutoff                  Compute a cutoff value given the scores of a
                        person-fit statistic
flagged.resp            Find (potentially) aberrant response patterns
lz                      lz and lzstar person-fit statistics
lzpoly                  lzpoly person-fit statistic
plot.PerFit             Plot method for objects of class "PerFit"
print.PerFit            Print method for objects of class "PerFit"
r.pbis                  Personal biserial statistic
summary.PerFit          Summary method for objects of class "PerFit"
</pre>
<p>The <span class="pkg">PerFit</span> package contains several person-fit functions. The goal is to detect response vectors that seem to be strange in terms of the sample of respondents or in terms to an item response theory (IRT) model.
</p>
<p>There are many person-fit statistics available in the literature. Statistics are typically categorized according to the type of items (Dicho = dichotomous, Poly = polytomous) and the type of IRT model (NParam=nonparametric, Param=parametric) that they apply to. The current version of <span class="pkg">PerFit</span> includes the following statistics:
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Person-fit statistic (R function)</b>  </td><td style="text-align: left;"> <b>Reference</b>      </td><td style="text-align: center;"> <b>Type item</b> </td><td style="text-align: center;"> <b>Type IRT model</b></td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+r.pbis">r.pbis</a></code>        </td><td style="text-align: left;"> Donlon and Fisher (1968)             </td><td style="text-align: center;"> Dicho            </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+C.Sato">C.Sato</a></code>        </td><td style="text-align: left;"> Sato (1975)                          </td><td style="text-align: center;"> Dicho            </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+G">G</a></code>, <code><a href="#topic+Gnormed">Gnormed</a></code> </td><td style="text-align: left;"> van der Flier (1977), Meijer (1994)  </td><td style="text-align: center;"> Dicho            </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+A.KB">A.KB</a></code>, <code><a href="#topic+D.KB">D.KB</a></code>, <code><a href="#topic+E.KB">E.KB</a></code> </td><td style="text-align: left;"> Kane and Brennan (1980) </td><td style="text-align: center;"> Dicho </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+U3">U3</a></code>, <code><a href="#topic+ZU3">ZU3</a></code> </td><td style="text-align: left;"> van der Flier (1980, 1982)           </td><td style="text-align: center;"> Dicho            </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+Cstar">Cstar</a></code>         </td><td style="text-align: left;"> Harnisch and Linn (1981)             </td><td style="text-align: center;"> Dicho            </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+NCI">NCI</a></code>           </td><td style="text-align: left;"> Tatsuoka and Tatsuoaka (1982, 1983)  </td><td style="text-align: center;"> Dicho            </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+lz">lz</a></code>            </td><td style="text-align: left;"> Drasgow, Levine, and Williams (1985) </td><td style="text-align: center;"> Dicho            </td><td style="text-align: center;"> Param</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+lzpoly">lzpoly</a></code>        </td><td style="text-align: left;"> Drasgow, Levine, and Williams (1985) </td><td style="text-align: center;"> Poly             </td><td style="text-align: center;"> Param</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+Ht">Ht</a></code>            </td><td style="text-align: left;"> Sijtsma (1986)                       </td><td style="text-align: center;"> Dicho            </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+Gpoly">Gpoly</a></code>        </td><td style="text-align: left;"> Molenaar (1991)                      </td><td style="text-align: center;"> Poly             </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+Gnormed.poly">Gnormed.poly</a></code> </td><td style="text-align: left;"> Molenaar (1991), Emons (2008)        </td><td style="text-align: center;"> Poly             </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+lzstar">lzstar</a></code>        </td><td style="text-align: left;"> Snijders (2001)                      </td><td style="text-align: center;"> Dicho            </td><td style="text-align: center;"> Param</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+U3poly">U3poly</a></code>        </td><td style="text-align: left;"> Emons (2008)                         </td><td style="text-align: center;"> Poly             </td><td style="text-align: center;"> NParam</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>All functions above have an output of class <code>PerFit</code>.
</p>
<p>The package provides other functions that help analyzing the data when conducting person-fit analyses:
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Function</b>                           </td><td style="text-align: left;"> <b>Description</b></td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+cutoff">cutoff</a></code>                      </td><td style="text-align: left;"> Estimate cutoff values for the person-fit statistics, to be used as decision rules.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+flagged.resp">flagged.resp</a></code>                </td><td style="text-align: left;"> Identify which respondents were flagged according to the chosen cutoff.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="base.html#topic+plot">plot</a></code> (class <code>PerFit</code>)  </td><td style="text-align: left;"> Plot the distribution of person-fit scores with the cutoff superimposed.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+PRFplot">PRFplot</a></code>                     </td><td style="text-align: left;"> Plot the nonparametric person response function (Sijtsma and Meijer, 2001).
</td>
</tr>

</table>

<p>More person-fit statistics will be added to the package in future updates.
</p>
<p><b>Versions</b>
</p>

<ul>
<li><p> Version 1.0 (April 2014)
</p>
</li>
<li><p> Version 1.1 (May 2014)
</p>
<p>Functions <code>plot.PerFit</code> and <code>PRFplot</code> now allow the user to edit the axes labels and the titles.
</p>
</li>
<li><p> Version 1.2 (August 2014)
</p>
<p>Some output values of some functions were renamed for the sake of consistency. The package documentation was adapted accordingly.
</p>
</li>
<li><p> Version 1.3 (March 2015)
</p>
<p>The package underwent a major revision:
</p>

<ul>
<li><p> Class <code>PerFit</code> now consists of a list with 12 objects.
</p>
</li>
<li><p> New methods for objects of class <code>PerFit</code> were added (<code>summary</code>, <code>print</code>).
</p>
</li>
<li><p> Routines accomodating for missing values were added.
</p>
</li>
<li><p> Function <code>cutoff</code> was updated. Now, model-fitting item response patterns are generated in order to find the cutoff value.
</p>
</li>
<li><p> Function <code>plot.PerFit</code> now allows displaying a bootstrap percentile confidence interval for the cutoff statistic, as well as ticks marking the flagged respondents.
</p>
</li>
<li><p> Person response functions are now approximated by functional data objects computed by means of the <code>fda</code> package. The functional data objects are returned to the user.
</p>
</li>
<li><p> Standard errors for the person-fit statistics are now available (see function <code>PerFit.SE</code>).
</p>
</li>
<li><p> Many control checks were added throughout the entire code.
</p>
</li></ul>

</li>
<li><p> Version 1.4 (July 2015)
</p>

<ul>
<li><p> The default missing values approach is now pairwise elimination. The imputation methods introduced with version 1.3.1 are still available.
</p>
</li>
<li><p> A bug was removed from function <code>lzpoly()</code> (many thanks to Marco Bressan for spotting it!).
</p>
</li>
<li><p> The PerFit-package.Rd file was updated (version 1.4.2).
</p>
</li>
<li><p> A bug in function <code>U3poly</code> was fixed (version 1.4.3, October 2018). All credit goes to Marek Muszynski for spotting the issue.
</p>
</li>
<li><p> Recent changes to base plot() broke function <code>PRFplot()</code>. This was now fixed (version 1.4.4, January 2021). I thank Julie Webbs for pointing this out.
</p>
</li>
<li><p> Version 1.4.5, February 2021: Updated affiliation.
</p>
</li>
<li><p> Version 1.4.6, October 2021: Updated internal function <code>estIP.poly()</code> to properly manage cases where users supply item and/or person parameters.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Jorge N. Tendeiro
</p>
<p>Maintainer: Jorge N. Tendeiro &lt;tendeiro@hiroshima-u.ac.jp&gt;
</p>


<h3>References</h3>

<p>Donlon, T. F., and Fischer, F. E. (1968) An index of an individual's agreement with group-defined item difficulties. <em>Educational and Psychological Measurement</em>, <b>28(1)</b>, 105&ndash;113.
</p>
<p>Drasgow, F., Levine, M. V., and Williams, E. A. (1985) Appropriateness measurement with polychotomous item response models and standardized indices. <em>British Journal of Mathematical and Statistical Psychology</em>, <b>38(1)</b>, 67&ndash;86.
</p>
<p>Emons, W. M. (2008) Nonparametric person-fit analysis of polytomous item scores. <em>Applied Psychological Measurement</em>, <b>32(3)</b>, 224&ndash;247. 
</p>
<p>Harnisch, D. L., and Linn, R. L. (1981) Analysis of item response patterns: Questionable test data and dissimilar curriculum practices. <em>Journal of Educational Measurement</em>, <b>18(3)</b>, 133&ndash;146.
</p>
<p>Kane, M. T., and Brennan, R. L. (1980) Agreement coefficients as indices of dependability for domain-referenced tests. <em>Applied Psychological Measurement</em>, <b>4(1)</b>, 105&ndash;126.
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Meijer, R. R. (1994) The number of Guttman errors as a simple and powerful person-fit statistic. <em>Applied Psychological Measurement</em>, <b>18(4)</b>, 311&ndash;314.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>Molenaar, I. W. (1991) A weighted Loevinger H-coefficient extending Mokken scaling to multicategory items. <em>Kwantitatieve Methoden</em>, <b>12(37)</b>, 97&ndash;117.
</p>
<p>Sato, T. (1975) <em>The construction and interpretation of S-P tables.</em> Tokyo: Meiji Tosho.
</p>
<p>Sijtsma, K. (1986) A coefficient of deviance of response patterns. <em>Kwantitatieve Methoden</em>, <b>7</b>, 131&ndash;145.
</p>
<p>Sijtsma, K., and Meijer, R. R. (2001) The person response function as a tool in person-fit research. <em>Psychometrika</em>, <b>66(2)</b>, 191&ndash;207. 
</p>
<p>Snijders, T. B. (2001) Asymptotic null distribution of person fit statistics with estimated person parameter. <em>Psychometrika</em>, <b>66(3)</b>, 331&ndash;342. 
</p>
<p>Tatsuoka, K. K., and Tatsuoka, M. M. (1982) Detection of aberrant response patterns and their effect on dimensionality. <em>Journal of Educational Statistics</em>, <b>7(3)</b>, 215&ndash;231.
</p>
<p>Tatsuoka, K. K., and Tatsuoka, M. M. (1983) Spotting erroneous rules of operation by the individual consistency index. <em>Journal of Educational Measurement</em>, <b>20(3)</b>, 221&ndash;230.
</p>
<p>Tendeiro, J. N., Meijer, R. R., and Niessen, A. S. M. (2016). PerFit: An R Package for Person-Fit Analysis in IRT. <em>Journal of Statistical Software</em>, <b>74(5)</b>, 1&ndash;27.
</p>
<p>van der Flier, H. (1977) Environmental factors and deviant response patterns. In Y. H. Poortinga (Ed.), <em>Basic problems in cross-cultural psychology.</em> Amsterdam: The Netherlands.
</p>
<p>van der Flier, H. (1980) <em>Vergelijkbaarheid van individuele testprestaties</em> [Comparability of individual test performance]. Lisse: The Netherlands.
</p>
<p>van der Flier, H. (1982) Deviant response patterns and comparability of test scores. <em>Journal of Cross-Cultural Psychology</em>, <b>13(3)</b>, 267&ndash;298.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# As an example, compute the Ht person-fit scores:
Ht.out &lt;- Ht(InadequacyData)
# Ht.out$PFscores

# Compute the cutoff value at 1% level:
set.seed(124) # To fix the random seed generator.
Ht.cut &lt;- cutoff(Ht.out, Blvl=.01)

# Plot the sample distribution of the Ht scores with the above cutoff superimposed:
plot(Ht.out, cutoff.obj=Ht.cut)

# Determine which respondents were flagged by Ht at 1% level:
flagged.resp(Ht.out, cutoff.obj=Ht.cut, scores=FALSE)
# Flagged respondents: 30, 37, 46, 49,...

# Plot the person response function of respondent 30 (flagged as aberrant):
Resp30 &lt;- PRFplot(InadequacyData, respID=30)
# Plot the person response function of respondent 35 (not flagged as aberrant):
Resp35 &lt;- PRFplot(InadequacyData, respID=35)
</code></pre>

<hr>
<h2 id='A+2C+20D+2C+20E+20statistics'>Agreement, disagreement, and dependability statistics</h2><span id='topic+A.KB'></span><span id='topic+D.KB'></span><span id='topic+E.KB'></span>

<h3>Description</h3>

<p>Kane and Brennan's person-fit statistics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>A.KB(matrix,
     NA.method = "Pairwise", Save.MatImp = FALSE, 
     IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML", 
     mu = 0, sigma = 1)

D.KB(matrix,
     NA.method = "Pairwise", Save.MatImp = FALSE, 
     IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML", 
     mu = 0, sigma = 1)

E.KB(matrix,
     NA.method = "Pairwise", Save.MatImp = FALSE, 
     IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML", 
     mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="A+2B2C+2B20D+2B2C+2B20E+2B20statistics_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="A+2B2C+2B20D+2B2C+2B20E+2B20statistics_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="A+2B2C+2B20D+2B2C+2B20E+2B20statistics_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="A+2B2C+2B20D+2B2C+2B20E+2B20statistics_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="A+2B2C+2B20D+2B2C+2B20E+2B20statistics_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"1PL"</code>, <code>"2PL"</code> (default), and <code>"3PL"</code>.</p>
</td></tr>
<tr><td><code id="A+2B2C+2B20D+2B2C+2B20E+2B20statistics_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="A+2B2C+2B20D+2B2C+2B20E+2B20statistics_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"ML"</code> (default), <code>"BM"</code>, and <code>"WL"</code>.</p>
</td></tr>
<tr><td><code id="A+2B2C+2B20D+2B2C+2B20E+2B20statistics_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="A+2B2C+2B20D+2B2C+2B20E+2B20statistics_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kane and Brennan (1980) discussed the agreement, disagreement, and dependability statistics. Assume that the items are ordered in increasing difficulty order (i.e., according to decreasing proportion-correct score). The agreement statistic for respondent <code class="reqn">n</code> is
</p>
<p style="text-align: center;"><code class="reqn">A.KB=\sum_i{X_i}p_i,</code>
</p>

<p>where <code class="reqn">X_i</code> is the 0-1 score of respondent <code class="reqn">n</code> on item <code class="reqn">i</code> and <code class="reqn">p_i</code> is the proportion-correct score of item <code class="reqn">i</code>.
</p>
<p>The disagreement statistic is
</p>
<p style="text-align: center;"><code class="reqn">D.KB = A.KB(max) - A.KB,</code>
</p>

<p>where <code class="reqn">A.KB(max)</code> is the maximum value of A.KB given respondent <code class="reqn">n</code>'s total score.
</p>
<p>The dependability statistic is
</p>
<p style="text-align: center;"><code class="reqn">E.KB = A.KB / A.KB(max).</code>
</p>

<p>Small values of A.Kb and E.KB (i.e., in the left tail of the sampling distribution) are (potentially) indicative of aberrant response behavior. Large values of D.Kb (i.e., in the right tail of the sampling distribution) are (potentially) indicative of aberrant response behavior. These statistics are not computed for rows of <code>matrix</code> that consist of only 0s or only 1s (NA values are returned instead).
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "1PL"</code>, <code>"2PL"</code>, or <code>"3PL"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>A message indicating whether perfect response vectors (all-0s or all-1s) were removed from the analysis.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Row indices of all-0s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Row indices of all-1s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories (2 in this case).</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>x3 matrix of estimated item parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Kane, M. T., and Brennan, R. L. (1980) Agreement coefficients as indices of dependability for domain-referenced tests. <em>Applied Psychological Measurement</em>, <b>4(1)</b>, 105&ndash;126.
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the A.KB, D.KB, and E.KB scores:
A.out &lt;- A.KB(InadequacyData); A.out
D.out &lt;- D.KB(InadequacyData); D.out
E.out &lt;- E.KB(InadequacyData); E.out
</code></pre>

<hr>
<h2 id='cutoff'>Compute a cutoff value given the scores of a person-fit statistic</h2><span id='topic+cutoff'></span>

<h3>Description</h3>

<p>Compute a cutoff value given the scores of a person-fit statistic.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutoff(x, 
       ModelFit = "NonParametric", Nreps=1000,
       IP=x$IP, IRT.PModel=x$IRT.PModel, Ability=x$Ability,
       Ability.PModel=x$Ability.PModel, mu=0, sigma=1, 
       Blvl = 0.05, Breps = 1000, CIlvl = 0.95, 
       UDlvl = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cutoff_+3A_x">x</code></td>
<td>
<p>Object of class &quot;PerFit&quot;.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_modelfit">ModelFit</code></td>
<td>
<p>Method required to compute model-fitting item score patterns. The options available are <code>"NonParametric"</code> (default) and <code>"Parametric"</code>.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_nreps">Nreps</code></td>
<td>
<p>Number of model-fitting item score patterns generated. Default is 1000.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters. Default is <code>x$IP</code>.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Parametric IRT model (required if <code>"ModelFit=Parametric"</code> or if the person fit statistic is parametric). Default is <code>x$IRT.PModel</code>.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_ability">Ability</code></td>
<td>
<p>Matrix with previously estimated item parameters. Default is <code>x$Ability</code>.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Method to use in order to estimate the latent ability parameters (required if <code>"ModelFit=Parametric"</code> or if the person fit statistic is parametric). Default is <code>x$Ability.PModel</code>.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_blvl">Blvl</code></td>
<td>
<p>Significance level for bootstrap distribution (value between 0 and 1). Default is 0.05.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_breps">Breps</code></td>
<td>
<p>Number of bootstrap resamples. Default is 1000.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_cilvl">CIlvl</code></td>
<td>
<p>Level of bootstrap percentile confidence interval for the cutoff statistic.</p>
</td></tr>
<tr><td><code id="cutoff_+3A_udlvl">UDlvl</code></td>
<td>
<p>User-defined cutoff level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes a reference value (referred to as a 'cutoff') associated to the values of a person-fit statistic computed from a sample. The idea is to create a decision rule: Individual person-fit values at or more extreme than the cutoff result in flagging the corresponding respondents as (potentially) displaying aberrant response behavior.
</p>
<p>Depending on the person-fit statistic, an &quot;extreme&quot; score might be a very small (e.g., for <code>Ht</code>) or a very large (e.g., for <code>G</code>) value. The <code>cutoff</code> function routinely reports of which type the person-fit statistic being used is (<code>Tail="lower"</code> or <code>Tail="upper"</code>, respectively).
</p>
<p>The procedure consists of generating <code>Nreps</code> model-fitting item response vectors based on parametric model parameters (when <code>ModelFit="Parametric"</code>) or on proportion of respondents per answer category (when <code>ModelFit="NonParametric"</code>). This allows computing a sample of <code>Nreps</code> values of the person fit statistic corresponding to model-fitting item response patterns. A bootstrap procedure is then used to approximate the sampling distribution of the quantile of level <code>Blvl</code> (resp., 1-<code>Blvl</code>) for &quot;lower&quot; (resp. &quot;upper&quot;) types of person fit statistics, based on <code>Breps</code> resamples. The cutoff (and its standard error) is given by the median (standard deviation) of this bootstrap distribution. Alternatively, the cutoff can be manually entered by the user (e.g., when it is available from prior data calibration) by means of <code>UDlvl</code>.
</p>


<h3>Value</h3>

<p>An object of class &quot;PerFit.cutoff&quot;, which is a list with 5 elements:
</p>
<table>
<tr><td><code>Cutoff</code></td>
<td>
<p>Numeric. Value of the computed cutoff.</p>
</td></tr>
<tr><td><code>Cutoff.SE</code></td>
<td>
<p>Numeric. Bootstrap estimated standard error of the cutoff value.</p>
</td></tr>
<tr><td><code>Prop.flagged</code></td>
<td>
<p>Numeric. Proportion of respondents flagged (that is, with person-fit scores at or more extreme than the cutoff).</p>
</td></tr>
<tr><td><code>Tail</code></td>
<td>
<p>String with values &quot;lower&quot; or &quot;upper&quot;. It indicates the type of person-fit statistic.</p>
</td></tr>
<tr><td><code>Cutoff.CI</code></td>
<td>
<p>Numeric. Percentile bootstrap (CIlvl)% confidence interval for the cutoff value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+flagged.resp">flagged.resp</a></code>, <code><a href="#topic+plot.PerFit">plot.PerFit</a></code>, <code><a href="#topic+PRFplot">PRFplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# As an example, compute the Ht person-fit scores:
Ht.out &lt;- Ht(InadequacyData)

# Compute the cutoff value at 1% level:
cutoff(Ht.out, Blvl=.01)
</code></pre>

<hr>
<h2 id='flagged.resp'>Find (potentially) aberrant response patterns</h2><span id='topic+flagged.resp'></span>

<h3>Description</h3>

<p>Find which respondents in the sample were flagged by the specified person-fit statistic.</p>


<h3>Usage</h3>

<pre><code class='language-R'>flagged.resp(x, cutoff.obj=NULL, 
             scores=TRUE, ord=TRUE,
             ModelFit="NonParametric", Nreps=1000,
             IP=x$IP, IRT.PModel=x$IRT.PModel, Ability=x$Ability,
             Ability.PModel=x$Ability.PModel, mu=0, sigma=1, 
             Blvl = 0.05, Breps = 1000, CIlvl = 0.95, 
             UDlvl=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flagged.resp_+3A_x">x</code></td>
<td>
<p>Object of class &quot;PerFit&quot;.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_cutoff.obj">cutoff.obj</code></td>
<td>
<p>Object of class &quot;PerFit.cutoff&quot;.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_scores">scores</code></td>
<td>
<p>Logical: Should item scores of flagged respondents be shown in the output? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_ord">ord</code></td>
<td>
<p>Logical: Should items be ordered in increasing order of difficulty (i.e., in decreasing proportion-correct order)? Default is <code>TRUE</code>. Only used if <code>scores=TRUE</code>.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_modelfit">ModelFit</code></td>
<td>
<p>Method required to compute model-fitting item score patterns. The options available are <code>"NonParametric"</code> (default) and <code>"Parametric"</code>.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_nreps">Nreps</code></td>
<td>
<p>Number of model-fitting item score patterns generated. Default is 1000.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters. Default is <code>x$IP</code>.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Parametric IRT model (required if <code>"ModelFit=Parametric"</code> or if the person fit statistic is parametric). Default is <code>x$IRT.PModel</code>.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_ability">Ability</code></td>
<td>
<p>Matrix with previously estimated item parameters. Default is <code>x$Ability</code>.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Method to use in order to estimate the latent ability parameters (required if <code>"ModelFit=Parametric"</code> or if the person fit statistic is parametric). Default is <code>x$Ability.PModel</code>.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_blvl">Blvl</code></td>
<td>
<p>Significance level for bootstrap distribution (value between 0 and 1). Default is 0.05.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_breps">Breps</code></td>
<td>
<p>Number of bootstrap resamples. Default is 1000.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_cilvl">CIlvl</code></td>
<td>
<p>Level of bootstrap percentile confidence interval for the cutoff statistic.</p>
</td></tr>
<tr><td><code id="flagged.resp_+3A_udlvl">UDlvl</code></td>
<td>
<p>User-defined cutoff level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the respondents in the dataset that were flagged by the person-fit statistic. This statistic is specified by means of the &quot;PerFit&quot; class object <code>x</code> (<code>x$PFStatistic</code>). 
</p>
<p>The cutoff score may be provided by means of the <code>cutoff.obj</code> object, otherwise it is internally computed (for which the function parameters <code>ModelFit</code> through <code>CIlvl</code> are required; see <code><a href="#topic+cutoff">cutoff</a></code> for more details).
</p>
<p>If <code>scores=TRUE</code> then the respondents' item scores will be shown in the output, either in the original item order (<code>ord=FALSE</code>) or in increasing difficulty order (<code>ord=TRUE</code>).
</p>


<h3>Value</h3>

<p>If <code>scores=FALSE</code> the output is a list with 3 elements:
</p>
<table>
<tr><td><code>PFSscores</code></td>
<td>
<p>A two-column matrix with the row index and the value of the person-fit statistic for the flagged respondents.</p>
</td></tr>
<tr><td><code>Cutoff.lst</code></td>
<td>
<p>The corresponding <code>PerFit.cutoff</code> object.</p>
</td></tr>
<tr><td><code>PFS</code></td>
<td>
<p>The person-fit statistic.</p>
</td></tr>
</table>
<p>If <code>scores=TRUE</code> the output is a list with four elements:
</p>
<table>
<tr><td><code>Scores</code></td>
<td>
<p>Matrix with columns: <code>FlaggedID</code>, item scores (<code>It**</code>), and <code>PFscores</code>.</p>
</td></tr>
<tr><td><code>MeanItemValue</code></td>
<td>
<p>The items mean value (which is nothing more than the proportion-correct for dichotomous items).</p>
</td></tr>
<tr><td><code>Cutoff.lst</code></td>
<td>
<p>The corresponding <code>PerFit.cutoff</code> object.</p>
</td></tr>
<tr><td><code>PFS</code></td>
<td>
<p>The person-fit statistic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+cutoff">cutoff</a></code>, <code><a href="#topic+plot.PerFit">plot.PerFit</a></code>, <code><a href="#topic+PRFplot">PRFplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# As an example, compute the Ht person-fit scores:
Ht.out &lt;- Ht(InadequacyData)
Ht.out$PFscores

# Estimate the cutoff value at 1% level:
Ht.cut &lt;- cutoff(Ht.out, Blvl=.01)

# Determine which respondents were flagged by Ht at 1% level:
flagged.resp(Ht.out, Ht.cut, scores=FALSE)$PFSscores
</code></pre>

<hr>
<h2 id='G+2C+20Gnormed'>Number of Guttman errors</h2><span id='topic+G'></span><span id='topic+Gnormed'></span>

<h3>Description</h3>

<p>van der Flier's statistics based on the number of Guttman errors.</p>


<h3>Usage</h3>

<pre><code class='language-R'>G(matrix,
  NA.method = "Pairwise", Save.MatImp = FALSE, 
  IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
  mu = 0, sigma = 1)

Gnormed(matrix,
        NA.method = "Pairwise", Save.MatImp = FALSE,
        IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
        mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="G+2B2C+2B20Gnormed_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="G+2B2C+2B20Gnormed_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="G+2B2C+2B20Gnormed_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="G+2B2C+2B20Gnormed_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="G+2B2C+2B20Gnormed_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"1PL"</code>, <code>"2PL"</code> (default), and <code>"3PL"</code>.</p>
</td></tr>
<tr><td><code id="G+2B2C+2B20Gnormed_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="G+2B2C+2B20Gnormed_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"ML"</code> (default), <code>"BM"</code>, and <code>"WL"</code>.</p>
</td></tr>
<tr><td><code id="G+2B2C+2B20Gnormed_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="G+2B2C+2B20Gnormed_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider the items' proportion-correct scores, <code class="reqn">p_1,p_2,\ldots,p_I</code> (<code class="reqn">I</code> = number of items). A Guttman error consists of an item score pair <code class="reqn">(X_i,X_j)=(0,1)</code> with <code class="reqn">p_i&gt;p_j</code>. Hence, there is a Guttman error when an easier item is answered incorrectly and a more difficult item is answered correctly.
</p>
<p><code>G</code> counts the number of (0,1) pairs given that the items are ordered in decreasing proportion-correct scores order. However, <code>G</code> depends on the total number of items for a given number-correct score. In particular, for a number-correct <code class="reqn">S</code>, <code>G</code> has maximum equal to <code class="reqn">S(I-S)</code>. <code>Gnormed</code> was created to bound <code>G</code> between 0 and 1 by dividing it by its maximum (conditional on the number-correct score). Hence, (potentially) aberrant response behavior is indicated by large values of G/Gnormed (i.e., in the right tail of the sampling distribution).
</p>
<p><code>Gnormed</code> is perfectly linearly related to Tatsuoka and Tatsuoka's (1982, 1983) NCI statistic (<code class="reqn">NCI = 1-2Gnormed</code>).
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "1PL"</code>, <code>"2PL"</code>, or <code>"3PL"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>A message indicating whether perfect response vectors (all-0s or all-1s) were removed from the analysis.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Row indices of all-0s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Row indices of all-1s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories (2 in this case).</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>x3 matrix of estimated item parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Meijer, R. R. (1994) The number of Guttman errors as a simple and powerful person-fit statistic. <em>Applied Psychological Measurement</em>, <b>18(4)</b>, 311&ndash;314.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>Tatsuoka, K. K., and Tatsuoka, M. M. (1982) Detection of aberrant response patterns and their effect on dimensionality. <em>Journal of Educational Statistics</em>, <b>7(3)</b>, 215&ndash;231.
</p>
<p>Tatsuoka, K. K., and Tatsuoka, M. M. (1983) Spotting erroneous rules of operation by the individual consistency index. <em>Journal of Educational Measurement</em>, <b>20(3)</b>, 221&ndash;230.
</p>
<p>van der Flier, H. (1977) Environmental factors and deviant response patterns. In Y. H. Poortinga (Ed.), <em>Basic problems in cross-cultural psychology.</em> Amsterdam: The Netherlands.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NCI">NCI</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the G scores:
G.out &lt;- G(InadequacyData)

# Compute the Gnormed scores:
Gnormed.out &lt;- Gnormed(InadequacyData)
</code></pre>

<hr>
<h2 id='Gpoly+2C+20Gnormed.poly'>Number of Guttman errors for polytomous items</h2><span id='topic+Gpoly'></span><span id='topic+Gnormed.poly'></span>

<h3>Description</h3>

<p>Molenaar (1991) and Emons (2008) statistics, based on the number of Guttman errors, for polytomous items.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gpoly(matrix, Ncat, 
     NA.method = "Pairwise", Save.MatImp = FALSE, 
     IP = NULL, IRT.PModel = "GRM", Ability = NULL, Ability.PModel = "EAP")

Gnormed.poly(matrix, Ncat, 
             NA.method = "Pairwise", Save.MatImp = FALSE,
             IP = NULL, IRT.PModel = "GRM", Ability = NULL, Ability.PModel = "EAP")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Gpoly+2B2C+2B20Gnormed.poly_+3A_matrix">matrix</code></td>
<td>
<p>A data matrix of polytomous item scores: Persons as rows, items as columns, item scores are integers between 0 and (Ncat-1), missing values allowed.</p>
</td></tr>
<tr><td><code id="Gpoly+2B2C+2B20Gnormed.poly_+3A_ncat">Ncat</code></td>
<td>
<p>Number of answer options for each item.</p>
</td></tr>
<tr><td><code id="Gpoly+2B2C+2B20Gnormed.poly_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="Gpoly+2B2C+2B20Gnormed.poly_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="Gpoly+2B2C+2B20Gnormed.poly_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item. The first (Ncat-1) columns contain the between-categories threshold parameters (for the GRM) or the item step difficulties (for the PCM and the GPCM). The last, Ncat-th, column has the slopes.
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="Gpoly+2B2C+2B20Gnormed.poly_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"PCM"</code>, <code>"GPCM"</code>, and <code>"GRM"</code> (default).</p>
</td></tr>
<tr><td><code id="Gpoly+2B2C+2B20Gnormed.poly_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="Gpoly+2B2C+2B20Gnormed.poly_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"EB"</code>, <code>"EAP"</code> (default), and <code>"MI"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Molenaar (1991) generalized the <code>G</code> person-fit statistic to polytomous items, <code>Gpoly</code>. The idea is based on the so-called item-step difficulty, which is the probability of moving from answer category <code class="reqn">(c)</code> to answer category <code class="reqn">(c+1)</code> (<code class="reqn">c=0,\ldots,Ncat-2</code>).
</p>
<p>Just like <code>G</code>, <code>Gpoly</code> depends on the test length. Emons (2008) developed <code>Gnormed.poly</code>, which is a normalized version of <code>Gpoly</code>.
</p>
<p>Aberrant response behavior is (potentially) indicated by large values of Gpoly/Gnormed.poly (i.e., in the right tail of the sampling distribution).
</p>
<p>The number of answer options, <code>Ncat</code>, is the same for all items.
</p>
<p><code>Gpoly</code> reduces to <code>G</code>, and <code>Gnormed.poly</code> reduces to <code>Gnormed</code>, when <code>Ncat=2</code>.
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from multinomial distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from multinomial distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "PCM"</code>, <code>"GPCM"</code>, or <code>"GRM"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>Not applicable.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Not applicable.</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Not applicable.</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories.</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>xNcat matrix of estimated item parameters.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities used.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Emons, W. M. (2008) Nonparametric person-fit analysis of polytomous item scores. <em>Applied Psychological Measurement</em>, <b>32(3)</b>, 224&ndash;247. 
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Meijer, R. R. (1994) The number of Guttman errors as a simple and powerful person-fit statistic. <em>Applied Psychological Measurement</em>, <b>18(4)</b>, 311&ndash;314.
</p>
<p>Molenaar, I. W. (1991) A weighted Loevinger H-coefficient extending Mokken scaling to multicategory items. <em>Kwantitatieve Methoden</em>, <b>12(37)</b>, 97&ndash;117.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+G">G</a></code>, <code><a href="#topic+Gnormed">Gnormed</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the physical functioning data (polytomous item scores):
data(PhysFuncData)

# Compute the Gpoly scores:
Gpoly.out &lt;- Gpoly(PhysFuncData, Ncat=3)

# Compute the Gnormed.poly scores:
Gnormedpoly.out &lt;- Gnormed.poly(PhysFuncData, Ncat=3)
</code></pre>

<hr>
<h2 id='Ht+20statistic'>Ht person-fit statistic</h2><span id='topic+Ht'></span>

<h3>Description</h3>

<p>Sijtsma's Ht person-fit statistic.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ht(matrix,
   NA.method = "Pairwise", Save.MatImp = FALSE,
   IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
   mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ht+2B20statistic_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="Ht+2B20statistic_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="Ht+2B20statistic_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="Ht+2B20statistic_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="Ht+2B20statistic_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"1PL"</code>, <code>"2PL"</code> (default), and <code>"3PL"</code>.</p>
</td></tr>
<tr><td><code id="Ht+2B20statistic_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="Ht+2B20statistic_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"ML"</code> (default), <code>"BM"</code>, and <code>"WL"</code>.</p>
</td></tr>
<tr><td><code id="Ht+2B20statistic_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="Ht+2B20statistic_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sijtsma (1986) adapted a statistic introduced by Mokken (1971) that originally allowed assessing the scalability of an item to the Guttman (1944, 1950) model. The same statistic was applied by Sijtsma to the <em>transposed</em> data in order to detect respondents that would not comply with the Guttman model. Assume, without loss of generality, that the rows of the data matrix are ordered by increasing order of total score <code class="reqn">S_n</code> (<code class="reqn">n=1,\ldots,N</code>). The statistic formula is given by the ratio
</p>
<p style="text-align: center;"><code class="reqn">Ht=\frac{cov(x_n,r_{(n)})}{cov_{max}(x_n,r_{(n)})},</code>
</p>

<p>where <code class="reqn">r_{(n)}</code> is the vector of total item scores computed <em>excluding</em> respondent <code class="reqn">n</code> and the denominator is the maximum covariance given the marginal. Hence, Ht is actually similar to Sato's <a href="#topic+C.Sato">C.Sato</a>. 
</p>
<p>Ht is maximum 1 for respondent <code class="reqn">n</code> when no respondent with a total score smaller/larger than <code class="reqn">S_n</code> can answer an item correctly/incorrectly that respondent <code class="reqn">n</code> has answered incorrectly/correctly, respectively. Ht equals zero when the average covariance of the response pattern of respondent <code class="reqn">n</code> with the other response patterns equals zero. Hence, (potentially) aberrant response behavior is indicated by small values of Ht (i.e., in the left tail of the sampling distribution). The Ht statistic was shown to perform relatively well in several simulation studies (Karabatsos, 2003; Sijtsma, 1986; Sijtsma and Meijer, 1992, Tendeiro and Meijer, 2014).
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "1PL"</code>, <code>"2PL"</code>, or <code>"3PL"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>A message indicating whether perfect response vectors (all-0s or all-1s) were removed from the analysis.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Row indices of all-0s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Row indices of all-1s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories (2 in this case).</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>x3 matrix of estimated item parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Guttman, L. (1944) A basis for scaling qualitative data. <em>American Sociological Review</em>, <b>9</b>, 139-150.
</p>
<p>Guttman, L. (1950) The basis for scalogram analysis. In S. A. Stouffer, L. Guttman, E. A. Suchman, P. F. Lazarsfeld, S. A. Star &amp; J. A. Claussen (Eds.), <em>Measurement and precision</em> (pp. 60-90). Princeton NJ: Princeton University Press.
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Mokken, R. J. (1971) <em>A theory and procedure of scale analysis.</em> Berlin, Germany: De Gruyter.
</p>
<p>Sijtsma, K. (1986) A coefficient of deviance of response patterns. <em>Kwantitatieve Methoden</em>, <b>7</b>, 131&ndash;145.
</p>
<p>Sijtsma, K., and Meijer, R. R. (1992) A method for investigating the intersection of item response functions in Mokken's nonparametric IRT model. <em>Applied Psychological Measurement</em>, <b>16(2)</b>, 149-157.
</p>
<p>Tendeiro, J. N., and Meijer, R. R. (2014) Detection of Invalid Test Scores: The Usefulness of Simple Nonparametric Statistics. <em>Journal of Educational Measurement</em>, <b>51(3)</b>, 239-259.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+C.Sato">C.Sato</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the Ht scores:
Ht.out &lt;- Ht(InadequacyData)
</code></pre>

<hr>
<h2 id='Inadequacy+20scale+20data'>The NPV-J inadequacy scale data</h2><span id='topic+InadequacyData'></span>

<h3>Description</h3>

<p>The NPV-J (Dutch: Junior Nederlandse Persoonlijkheidsvragenlijst, NPV-J; Luteijn, van Dijk, and Barelds, 2005) is a large Dutch personality inventory. The NPV-J consists of 105 mostly positively formulated items and is intended to determine how adolescents between 9 and 15 years of age judge their own behavior. The NPV-J has five subscales; the <code>InadequacyScale</code> data concern scores of 806 adolescents on 28 items measuring inadequacy (one of the subscales). The data are dichotomous (0 = Disagree, 1 = Agree). The original sample consisted of 866 respondents, however 60 all-0s or all-1s response vectors were removed from the data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(InadequacyData)</code></pre>


<h3>Format</h3>

<p>A 806x28 matrix of dichotomous item scores.</p>


<h3>References</h3>

<p>Luteijn, F., van  Dijk, H., and Barelds, D. P. H. (2005) <em>NPV-J: Junior Nederlandse Persoonlijkheidsvragenlijst.</em> Herziene handleiding 2005. Amsterdam: Harcourt Assessments B.V..
</p>
<p>Meijer, R. R., and Tendeiro, J. N. (2012) The use of the lz and lz* person-fit statistics and problems derived from model misspecification. <em>Journal of Educational and Behavioral Statistics</em>, <b>37(6)</b>, 758&ndash;766. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(InadequacyData)</code></pre>

<hr>
<h2 id='Intelligence+20data'>Intelligence data (number completion)</h2><span id='topic+IntelligenceData'></span>

<h3>Description</h3>

<p>The data are dichotomous scores of a Dutch intelligence test on number completion (Dutch: &quot;Cijferreeksen&quot;, Drenth and Hoolwerf, 1970).  The file consists of archival data that were collected in a high-stakes personnel selection context around 1990. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(IntelligenceData)</code></pre>


<h3>Format</h3>

<p>A 1000x26 matrix of dichotomous item scores.</p>


<h3>References</h3>

<p>Drenth, P. J. D., and Hoolwerf, G. (1970) <em>Numerieke aanleg test - Cijferreeksen (NAT-Cijferreeksen)</em> [Numerical ability test]. Amsterdam: The Netherlands.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IntelligenceData)</code></pre>

<hr>
<h2 id='lz+2C+20lzstar'>lz and lzstar person-fit statistics</h2><span id='topic+lz'></span><span id='topic+lzstar'></span>

<h3>Description</h3>

<p>Compute the lz (Drasgow, Levine, and Williams, 1985) and the lzstar (Snijders, 2001) person-fit statistics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lz(matrix,
   NA.method = "Pairwise", Save.MatImp = FALSE,
   IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
   mu = 0, sigma = 1)

lzstar(matrix,
       NA.method = "Pairwise", Save.MatImp = FALSE,
       IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
       mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lz+2B2C+2B20lzstar_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="lz+2B2C+2B20lzstar_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="lz+2B2C+2B20lzstar_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="lz+2B2C+2B20lzstar_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="lz+2B2C+2B20lzstar_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"1PL"</code>, <code>"2PL"</code> (default), and <code>"3PL"</code>.</p>
</td></tr>
<tr><td><code id="lz+2B2C+2B20lzstar_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="lz+2B2C+2B20lzstar_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"ML"</code> (default), <code>"BM"</code>, and <code>"WL"</code>.</p>
</td></tr>
<tr><td><code id="lz+2B2C+2B20lzstar_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="lz+2B2C+2B20lzstar_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Drasgow et al. (1985) introduced one of the most used person-fit statistics, <code>lz</code>. This statistic is the standardized log-likelihood of the respondent's response vector. <code>lz</code> is (supposed to be) asymptotically standard normally distributed. 
</p>
<p>The computation of <code>lz</code> requires that both item and ability parameters are available. Function <code>lz</code> allows to user to enter his/her own item and ability parameter estimates (variables <code>IP</code> and <code>Ability</code>, respectively). Alternatively, <code>lz</code> relies on functions available through the <code><a href="irtoys.html#topic+irtoys">irtoys</a></code> package for estimating the parameters. Specifically, the user can choose one from three possible IRT models to fit the data: <code>IRT.PModel="1PL"</code>, <code>IRT.PModel="2PL"</code>, or <code>IRT.PModel="3PL"</code>. As for estimating the ability parameters there are three possible methods: <code>Ability.PModel="ML"</code> (maximum likelihood), <code>Ability.PModel="BM"</code> (Bayes modal), or <code>Ability.PModel="WL"</code> (weighted likelihood).
</p>
<p>It was later observed by several researchers (e.g., Molenaar and Hoijtink, 1990) that the asymptotic approximation only holds when true ability values are used. This limitation was overcome by Snijders (2001), who further developed <code>lz</code> into the <code>lzstar</code> statistic. An accessible paper that thoroughly explains the basic principles behind <code>lzstar</code> is Magis, Raiche, and Beland (2012). It is important to realize that not all item and/or ability estimation procedures can be used when computing <code>lzstar</code>. In particular, the estimation of the ability parameters is constrained (see Snijders, 2001, Equation 5). The <code>lzstar</code> algorithm internally estimates the ability parameters accordingly for one of three possible methods: <code>Ability.PModel="ML"</code> (maximum likelihood), <code>Ability.PModel="BM"</code> (Bayes modal), or <code>Ability.PModel="WL"</code> (weighted likelihood), see Magis et al. (2012). The user may provide his or her own ability estimates in case they are available by means of other software. In this case it is necessary to specify the method that was used for the estimation (ML, BM, or WL) using the argument <code>Ability.PModel</code>.
</p>
<p>Aberrant response behavior is (potentially) indicated by small values of lz/lzstar (i.e., in the left tail of the sampling distribution).
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "1PL"</code>, <code>"2PL"</code>, or <code>"3PL"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>A message indicating whether perfect response vectors (all-0s or all-1s) were removed from the analysis.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Row indices of all-0s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Row indices of all-1s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories (2 in this case).</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>x3 matrix of estimated item parameters.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities used.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Drasgow, F., Levine, M. V., and Williams, E. A. (1985) Appropriateness measurement with polychotomous item response models and standardized indices. <em>British Journal of Mathematical and Statistical Psychology</em>, <b>38(1)</b>, 67&ndash;86.
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Magis, D., Raiche, G., and Beland, S. (2012) A didactic presentation of Snijders's l[sub]z[/sub] index of person fit with emphasis on response model selection and ability estimation. <em>Journal of Educational and Behavioral Statistics</em>, <b>37(1)</b>, 57&ndash;81.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>Molenaar, I. W., and Hoijtink, H. (1990) The many null distributions of person fit indices. <em>Psychometrika</em>, <b>55(1)</b>, 75&ndash;106. 
</p>
<p>Snijders, T. B. (2001) Asymptotic null distribution of person fit statistics with estimated person parameter. <em>Psychometrika</em>, <b>66(3)</b>, 331&ndash;342. 
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lzpoly">lzpoly</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the lz scores using a subsample of the first 200 response vectors:
lz.out &lt;- lz(InadequacyData[1:200,])
# Use parameters estimated externally (in this case item parameters estimated by mirt):
mod &lt;- mirt(InadequacyData[1:200,], 1)
ip.mirt &lt;- coef(mod, IRTpars = TRUE, simplify = TRUE, digits = Inf)$items[,c('a', 'b', 'g')]
lz.out2 &lt;- lz(InadequacyData[1:200,], IP = ip.mirt)

# Compute the lzstar scores using a subsample of the first 200 response vectors:
lzstar.out &lt;- lzstar(InadequacyData[1:200,])
</code></pre>

<hr>
<h2 id='lzpoly'>lzpoly person-fit statistic</h2><span id='topic+lzpoly'></span>

<h3>Description</h3>

<p>Compute the lzpoly (Drasgow, Levine, and Williams, 1985) person-fit statistic.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lzpoly(matrix, Ncat, 
       NA.method = "Pairwise", Save.MatImp = FALSE,
       IP = NULL, IRT.PModel = "GRM", Ability = NULL, Ability.PModel = "EAP")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lzpoly_+3A_matrix">matrix</code></td>
<td>
<p>A data matrix of polytomous item scores: Persons as rows, items as columns, item scores are integers between 0 and (Ncat-1), missing values allowed.</p>
</td></tr>
<tr><td><code id="lzpoly_+3A_ncat">Ncat</code></td>
<td>
<p>Number of answer options for each item.</p>
</td></tr>
<tr><td><code id="lzpoly_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="lzpoly_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="lzpoly_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item. The first (Ncat-1) columns contain the between-categories threshold parameters (for the GRM) or the item step difficulties (for the PCM and the GPCM). The last, Ncat-th, column has the slopes.
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="lzpoly_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"PCM"</code>, <code>"GPCM"</code>, and <code>"GRM"</code> (default).</p>
</td></tr>
<tr><td><code id="lzpoly_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="lzpoly_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"EB"</code>, <code>"EAP"</code> (default), and <code>"MI"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Statistic <code>lzpoly</code> is the natural extension of <code><a href="#topic+lz">lz</a></code> to polytomously scores items. In this case the user can choose one from three possible IRT models to fit the data: The partial credit model (<code>IRT.PModel="PCM"</code>), the generalized partial credit model (<code>IRT.PModel="GPCM"</code>), or the graded response model (<code>IRT.PModel="GRM"</code>). Ability parameters can be estimated by means of one of three methods: Empirical Bayes (<code>Ability.PModel="EB"</code>), expected a posteriori (<code>Ability.PModel="EAP"</code>), or multiple imputation (<code>Ability.PModel="MI"</code>).
</p>
<p>The estimation of the model parameters is based on the <code>ltm</code> package. This function will estimate the item and ability parameters when both sets of parameters are missing. It will also estimate one set of parameters in case only the other set is provided. It is possible that some estimation convergence problems occur that may break the function. In this case it is advisable to estimate the model parameters externally and then to run this function with those estimates provided via the commands <code>IP</code> and <code>Ability</code>.
</p>
<p>Aberrant response behavior is (potentially) indicated by small values of lzpoly (i.e., in the left tail of the sampling distribution).
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from multinomial distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from multinomial distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "PCM"</code>, <code>"GPCM"</code>, or <code>"GRM"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>Not applicable.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Not applicable.</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Not applicable.</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories.</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>xNcat matrix of estimated item parameters.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities used.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Drasgow, F., Levine, M. V., and Williams, E. A. (1985) Appropriateness measurement with polychotomous item response models and standardized indices. <em>British Journal of Mathematical and Statistical Psychology</em>, <b>38(1)</b>, 67&ndash;86.
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Magis, D., Raiche, G., and Beland, S. (2012) A didactic presentation of Snijders's l[sub]z[/sub] index of person fit with emphasis on response model selection and ability estimation. <em>Journal of Educational and Behavioral Statistics</em>, <b>37(1)</b>, 57&ndash;81.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>Molenaar, I. W., and Hoijtink, H. (1990) The many null distributions of person fit indices. <em>Psychometrika</em>, <b>55(1)</b>, 75&ndash;106. 
</p>
<p>Snijders, T. B. (2001) Asymptotic null distribution of person fit statistics with estimated person parameter. <em>Psychometrika</em>, <b>66(3)</b>, 331&ndash;342. 
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lz">lz</a></code>,<code><a href="#topic+lzstar">lzstar</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the physical functioning data (polytomous item scores):
data(PhysFuncData)

# Compute the lzpoly scores:
lzpoly.out &lt;- lzpoly(PhysFuncData,Ncat=3)
</code></pre>

<hr>
<h2 id='NCI+20statistic'>NCI person-fit statistic</h2><span id='topic+NCI'></span>

<h3>Description</h3>

<p>Tatsuoka and Tatsuoka's NCI statistic.</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCI(matrix,
    NA.method = "Pairwise", Save.MatImp = FALSE, 
    IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
    mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCI+2B20statistic_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="NCI+2B20statistic_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="NCI+2B20statistic_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="NCI+2B20statistic_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="NCI+2B20statistic_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"1PL"</code>, <code>"2PL"</code> (default), and <code>"3PL"</code>.</p>
</td></tr>
<tr><td><code id="NCI+2B20statistic_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="NCI+2B20statistic_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"ML"</code> (default), <code>"BM"</code>, and <code>"WL"</code>.</p>
</td></tr>
<tr><td><code id="NCI+2B20statistic_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="NCI+2B20statistic_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The NCI person-fit statistic was introduced by Tatsuoka and Tatsuoka (1982, 1983). It is perfectly linearly related to van der Flier's (1977) Gnormed statistic (<code class="reqn">NCI = 1-2Gnormed</code>), see <code><a href="#topic+G">G</a></code> for mathematical details. 
</p>
<p>NCI equals 1 for perfect Guttman vectors (i.e., when only the easiest items are answered correctly, given the total score) and equals -1 for reversed Guttman vectors (i.e., when only the hardest items are answered correctly, given the total score). Hence, (potentially) aberrant response behavior is indicated by small values of NCI (i.e., in the left tail of the sampling distribution).
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "1PL"</code>, <code>"2PL"</code>, or <code>"3PL"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>A message indicating whether perfect response vectors (all-0s or all-1s) were removed from the analysis.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Row indices of all-0s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Row indices of all-1s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories (2 in this case).</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>x3 matrix of estimated item parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>Tatsuoka, K. K., and Tatsuoka, M. M. (1982) Detection of aberrant response patterns and their effect on dimensionality. <em>Journal of Educational Statistics</em>, <b>7(3)</b>, 215&ndash;231.
</p>
<p>Tatsuoka, K. K., and Tatsuoka, M. M. (1983) Spotting erroneous rules of operation by the individual consistency index. <em>Journal of Educational Measurement</em>, <b>20(3)</b>, 221&ndash;230.
</p>
<p>van der Flier, H. (1977) Environmental factors and deviant response patterns. In Y. H. Poortinga (Ed.), <em>Basic problems in cross-cultural psychology.</em> Amsterdam: The Netherlands.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+G">G</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the NCI scores:
NCI.out &lt;- NCI(InadequacyData)
</code></pre>

<hr>
<h2 id='PerFit.PFS'>Compute several person-fit statistics</h2><span id='topic+PerFit.PFS'></span>

<h3>Description</h3>

<p>Compute several person-fit statistics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PerFit.PFS(matrix, method=NULL, simplified=TRUE, 
       NA.method = "Pairwise", Save.MatImp = FALSE,
       IP = NULL, IRT.PModel = NULL, Ability = NULL, Ability.PModel = NULL,
       mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PerFit.PFS_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_method">method</code></td>
<td>
<p>Vector of person-fit statistics to be computed.</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_simplified">simplified</code></td>
<td>
<p>Logical. If FALSE, a list of <code>PerFit</code> objects is returned. If TRUE (default), a matrix with person-fit scores per respondent (one column per statistic) is reported.</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>).</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>).</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="PerFit.PFS_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>PerFit.PFS</code> is a wrapper allowing to compute more than one person-fit statistic simultaneously.
</p>


<h3>Value</h3>

<p>If <code>simplified=TRUE</code>, a N-by-m data frame is returned, where N is the number of respondents and m is the number of methods.
</p>
<p>If <code>simplified=FALSE</code> a list of m <code>PerFit</code> objects is returned.
</p>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the lzstar, U3, and Ht scores:
PerFit.PFS(InadequacyData, method=c("lzstar", "U3", "Ht"))
</code></pre>

<hr>
<h2 id='PerFit.SE'>Compute standard errors for person fit statistics</h2><span id='topic+PerFit.SE'></span>

<h3>Description</h3>

<p>Compute standard errors for person fit statistics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PerFit.SE(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PerFit.SE_+3A_x">x</code></td>
<td>
<p>Object of class &quot;PerFit&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>PerFit.SE</code> computes jackknife standard errors for the scores of the person fit statistic in object <code>x</code>.
</p>


<h3>Value</h3>

<p>A matrix with two columns: <code>PFscores</code> shows the values of the person-fit statistic and <code>PFscores.SE</code> shows the estimated standard errors.
</p>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the Ht scores:
Ht.out &lt;- Ht(InadequacyData)

# Compute the SEs:
Ht.SE &lt;- PerFit.SE(Ht.out)
Ht.SE

</code></pre>

<hr>
<h2 id='Personal+20biserial+20statistic'>Personal biserial statistic</h2><span id='topic+r.pbis'></span>

<h3>Description</h3>

<p>Donlon and Fischer's personal biserial statistic.</p>


<h3>Usage</h3>

<pre><code class='language-R'>r.pbis(matrix,
       NA.method = "Pairwise", Save.MatImp = FALSE,
       IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
       mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Personal+2B20biserial+2B20statistic_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="Personal+2B20biserial+2B20statistic_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="Personal+2B20biserial+2B20statistic_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="Personal+2B20biserial+2B20statistic_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="Personal+2B20biserial+2B20statistic_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"1PL"</code>, <code>"2PL"</code> (default), and <code>"3PL"</code>.</p>
</td></tr>
<tr><td><code id="Personal+2B20biserial+2B20statistic_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="Personal+2B20biserial+2B20statistic_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"ML"</code> (default), <code>"BM"</code>, and <code>"WL"</code>.</p>
</td></tr>
<tr><td><code id="Personal+2B20biserial+2B20statistic_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="Personal+2B20biserial+2B20statistic_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Donlon and Fischer (1968) suggested to use the correlation between a respondent's score vector and the item proportion-correct scores in the sample as a measure of person fit. Low values should be indicative of misfit of the response vector with respect to the group of respondents.
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "1PL"</code>, <code>"2PL"</code>, or <code>"3PL"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>A message indicating whether perfect response vectors (all-0s or all-1s) were removed from the analysis.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Row indices of all-0s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Row indices of all-1s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories (2 in this case).</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>x3 matrix of estimated item parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Donlon, T. F., and Fischer, F. E. (1968) An index of an individual's agreement with group-defined item difficulties. <em>Educational and Psychological Measurement</em>, <b>28(1)</b>, 105&ndash;113.
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the r.pbis scores:
rpbis.out &lt;- r.pbis(InadequacyData)
</code></pre>

<hr>
<h2 id='Physical+20Functioning'>The SF-36 physical functioning data</h2><span id='topic+PhysFuncData'></span>

<h3>Description</h3>

<p>These data are from the Physical Functioning scale of the SF-36 (Ware and Sherbourne, 1992). Data consist of scores of 714 respondents on 10 polytomously scored items (0 = no, not limited at all; 1 = limited a little; 2 = limited a lot). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PhysFuncData)</code></pre>


<h3>Format</h3>

<p>A 714x10 matrix of polytomous item scores (scores 0, 1, and 2).</p>


<h3>References</h3>

<p>Ware, J. E., Jr., and Sherbourne, C. D. (1992) The MOS 36-item short-form health survey (SF-36): Conceptual framework and item selection. <em>Medical Care</em>, <b>30</b>, 473&ndash;483.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PhysFuncData)</code></pre>

<hr>
<h2 id='plot+20PerFit'>Plot method for objects of class &quot;PerFit&quot;</h2><span id='topic+plot.PerFit'></span>

<h3>Description</h3>

<p>Plot method for objects of class &quot;PerFit&quot;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PerFit'
plot(x, cutoff.obj=NULL, 
       ModelFit="NonParametric", Nreps=1000, 
       IP=x$IP, IRT.PModel=x$IRT.PModel, Ability=x$Ability, 
       Ability.PModel=x$Ability.PModel, mu=0, sigma=1, 
       Blvl = 0.05, Breps = 1000, CIlvl = 0.95, 
       UDlvl = NA, 
       Type="Density", Both.scale=TRUE, Cutoff=TRUE, Cutoff.int=TRUE,
       Flagged.ticks = TRUE, 
       Xlabel=NA, Xcex=1.5, title=NA, Tcex=1.5,
       col.area="lightpink", col.hist="lightblue", col.int="darkgreen",
       col.ticks="red", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20PerFit_+3A_x">x</code></td>
<td>
<p>Object of class &quot;PerFit&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_cutoff.obj">cutoff.obj</code></td>
<td>
<p>Object of class &quot;PerFit.cutoff&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_modelfit">ModelFit</code></td>
<td>
<p>Method required to compute model-fitting item score patterns. The options available are <code>"NonParametric"</code> (default) and <code>"Parametric"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_nreps">Nreps</code></td>
<td>
<p>Number of model-fitting item score patterns generated. Default is 1000.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters. Default is <code>x$IP</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Parametric IRT model (required if <code>"ModelFit=Parametric"</code> or if the person fit statistic is parametric). Default is <code>x$IRT.PModel</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_ability">Ability</code></td>
<td>
<p>Matrix with previously estimated item parameters. Default is <code>x$Ability</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Method to use in order to estimate the latent ability parameters (required if <code>"ModelFit=Parametric"</code> or if the person fit statistic is parametric). Default is <code>x$Ability.PModel</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_blvl">Blvl</code></td>
<td>
<p>Significance level for bootstrap distribution (value between 0 and 1). Default is 0.05.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_breps">Breps</code></td>
<td>
<p>Number of bootstrap resamples. Default is 1000.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_cilvl">CIlvl</code></td>
<td>
<p>Level of bootstrap percentile confidence interval for the cutoff statistic.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_udlvl">UDlvl</code></td>
<td>
<p>User-defined cutoff level.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_type">Type</code></td>
<td>
<p>Type of plot: <code>"Histogram"</code>, <code>"Density"</code> (default), <code>"Both"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_both.scale">Both.scale</code></td>
<td>
<p>Logical: Should the y-axis be adjusted so that both the histogram and the density graphics are completely visible? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_cutoff">Cutoff</code></td>
<td>
<p>Logical: Should the estimated cutoff be added to the plot? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_cutoff.int">Cutoff.int</code></td>
<td>
<p>Logical: Should an approximated (1-Blvl)% bootstrap confidence interval be added to the plot? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_flagged.ticks">Flagged.ticks</code></td>
<td>
<p>Logical: Should ticks representing the flagged respondents be added to the plot? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_xlabel">Xlabel</code></td>
<td>
<p>Label of x-axis, otherwise a default label is shown.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_xcex">Xcex</code></td>
<td>
<p>Font size of the label of x-axis.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_title">title</code></td>
<td>
<p>Title of the plot, otherwise a default title is shown.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_tcex">Tcex</code></td>
<td>
<p>Font size of the title of the plot.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_col.area">col.area</code></td>
<td>
<p>Color of &quot;flagging region&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_col.hist">col.hist</code></td>
<td>
<p>Color of histogram.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_col.int">col.int</code></td>
<td>
<p>Color of bootstrap confidence interval.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_col.ticks">col.ticks</code></td>
<td>
<p>Color of the ticks marking the flagged respondents.</p>
</td></tr>
<tr><td><code id="plot+2B20PerFit_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the empirical distribution of the scores of the person-fit statistic specified by the &quot;PerFit&quot; class object <code>x</code>. A histogram, density, or a combination of both displays is possible. 
</p>
<p>The cutoff score may be provided by means of the <code>cutoff.obj</code> object, otherwise it is internally computed (for which the function parameters <code>ModelFit</code> through <code>CIlvl</code> are required; see <code><a href="#topic+cutoff">cutoff</a></code> for more details). The value of the cutoff is superimposed to the plot when <code>Cutoff=TRUE</code>. In this case, the adequate &quot;flagging region&quot; is colored, thus indicating the range of values for which the person-fit statistic flags respondents as potentially displaying aberrant behavior. The option <code>Both.scale</code> was introduced to help to better tune the scale of the y-axis. Furthermore, the percentile confidence interval for the cutoff value (with confidence level defined by the <code>cutoff.obj</code>) is displayed in the x-axis, and ticks marking the flagged respondents are display on the top of the plot.
</p>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+cutoff">cutoff</a></code>, <code><a href="#topic+flagged.resp">flagged.resp</a></code>, <code><a href="#topic+PRFplot">PRFplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the ZU3 scores:
ZU3.out &lt;- ZU3(InadequacyData)

# Plot the sampling distribution of the ZU3 scores, with cutoff value based on a nominal 5% level,
# and 90% confidence interval:
plot(ZU3.out, Type="Both", Blvl=.05, CIlvl = 0.90)
</code></pre>

<hr>
<h2 id='PRFplot'>Person response function (PRF)</h2><span id='topic+PRFplot'></span>

<h3>Description</h3>

<p>Plot the nonparametric person response function with variability bands.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PRFplot(matrix, respID, h=.09, N.FPts=101, 
        VarBands=FALSE, VarBands.area=FALSE, alpha=.05,
        Xlabel=NA, Xcex=1.5, Ylabel=NA, Ycex=1.5, title=NA, Tcex=1.5,
        NA.method="Pairwise", Save.MatImp=FALSE, 
        IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
        mu = 0, sigma = 1, 
        message = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PRFplot_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_respid">respID</code></td>
<td>
<p>Vector specifying the respondents for whom PRFs are to be computed.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_h">h</code></td>
<td>
<p>Bandwidth value. Default is 0.09.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_n.fpts">N.FPts</code></td>
<td>
<p>Number of (equidistant) focal points in the [0,1] interval. Default is 101.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_varbands">VarBands</code></td>
<td>
<p>Logical: Draw the <code>(1-alpha)</code> variability bands? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_varbands.area">VarBands.area</code></td>
<td>
<p>Logical: Draw the area between the <code>(1-alpha)</code> variability bands? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for the variability bands. Default is 0.05.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_xlabel">Xlabel</code></td>
<td>
<p>Define label of x-axis, otherwise a default label is shown.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_xcex">Xcex</code></td>
<td>
<p>Font size of the label of x-axis.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_ylabel">Ylabel</code></td>
<td>
<p>Define label of y-axis, otherwise a default label is shown.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_ycex">Ycex</code></td>
<td>
<p>Font size of the label of y-axis.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_title">title</code></td>
<td>
<p>Define the title of the plot, otherwise a default title is shown.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_tcex">Tcex</code></td>
<td>
<p>Font size of the title of the plot.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"1PL"</code>, <code>"2PL"</code> (default), and <code>"3PL"</code>.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"ML"</code> (default), <code>"BM"</code>, and <code>"WL"</code>.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
<tr><td><code id="PRFplot_+3A_message">message</code></td>
<td>
<p>Display prompt message (one per person)? Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>PRFplot</code> displays the so-called nonparametric person response functions (PRFs; Emons, Sijtsma, and Meijer, 2004; Sijtsma and Meijer, 2001),  for the respondents identified in <code>respID</code>. The PRF relates item difficulty (0-1 range on the x-axis) with the associated probability of correct response (on the y-axis). The PRF is typically nonincreasing, implying that the probability of answering increasingly difficult items should (at least) not increase. The code is based on nonparametric kernel smoothing (Emons et al., 2004). The value of the PRF at each focal point (representing a difficulty parameter between 0 and 1) is estimated as a weighted sum score, where scores pertaining to items with difficulty close to the focal point are given the largest weights. The weights are functions of the Gaussian kernel function. It is necessary to specify a bandwidth value (<code>h</code>) in order to compute the weights. The <code>h</code> value controls the trade-off between bias and sampling variation (Emons et al., 2004). Small <code>h</code> values reduce bias but increase variance, leading to PRFs that capture too much measurement error. Large <code>h</code> values, on the other hand, increase bias which renders PRFs that are often too flat, thus missing potentially relevant misfitting response behavior. Therefore, it is important to carefuly specify the value <code>h</code>. Emons et al. (2004, pp. 10-13), after a simulation study, advised that &quot;<code>h</code> values between 0.07 and 0.11 are reasonable choices&quot;.
</p>
<p>Moreover, variability bands of level <code>alpha</code> (0.05 by default) can also be added to the plot. These bands are computed following the jackknife procedure explained in Emons et al. (2004). 
</p>
<p>The PRFs and variability bands for each respondent are approximated by means of functional data objects (e.g., Ramsay, Hooker, and Graves, 2009), with the help of the <code>fda</code> package. This procedure follows two steps:
</p>

<ul>
<li><p> Compute a B-splines basis system. This basis consists of a set of (thirteen) piecewise polinomials, all of degree three/order four (i.e., cubic polinomial segments), with one knot per break point. This allows any two consecutive splines, sp1 and sp2, with common break point BP, verifying sp1(BP) = sp2(BP), sp1'(BP) = sp2'(BP), and sp1&rdquo;(BP) = sp2&rdquo;(BP). At 0 and 1 (extremes of the x-range), four (= order) knots are used.
</p>
</li>
<li><p> Specify coefficients c for the B-splines basis system computed above and then create functional data objects. Based on smoothing using regression analysis (Ramsay et al., 2009, section 4.3).
</p>
</li></ul>

<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "1PL"</code>, <code>"2PL"</code>, or <code>"3PL"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>

<p><code>PRFplot</code> returns three functional data objects (for the PRFs, lower-bound of the variability bands, and upper-band of the variability bands) for all respondents in the sample. 
</p>


<h3>Value</h3>

<p>The output is a list with three functional data objects of class <code>fd</code> (see package <code>fda</code>):
</p>
<table>
<tr><td><code>PRF.FDO</code></td>
<td>
<p>Functional data object of the PRFs for the entire sample.</p>
</td></tr>
<tr><td><code>VarBandsLow.FDO</code></td>
<td>
<p>Functional data object of the lower-bound of the variability bands for the entire sample.</p>
</td></tr>
<tr><td><code>VarBandsHigh.FDO</code></td>
<td>
<p>Functional data object of the upper-bound of the variability bands for the entire sample.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Emons, W. M., Sijtsma, K., and Meijer, R. R. (2004) Testing hypotheses about the person-response function in person-fit analysis. <em>Multivariate Behavioral Research</em>, <b>39(1)</b>, 1&ndash;35.
</p>
<p>Ramsay, J. O., Hooker, G., and Graves, S. (2009) <em>Functional data analysis with R and MATLAB</em>. New York: US.
</p>
<p>Sijtsma, K., and Meijer, R. R. (2001) The person response function as a tool in person-fit research. <em>Psychometrika</em>, <b>66(2)</b>, 191&ndash;207.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cutoff">cutoff</a></code>, <code><a href="#topic+plot.PerFit">plot.PerFit</a></code>, <code><a href="#topic+flagged.resp">flagged.resp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# As an example, compute the Ht person-fit scores:
Ht.out &lt;- Ht(InadequacyData)
Ht.out$PFscores

# Determine which respondents were flagged by Ht at 1% level:
set.seed(124) # To fix the random seed generator.
Ht.flagged &lt;- flagged.resp(Ht.out, Blvl=.01, scores=FALSE)
Ht.flagged &lt;- Ht.flagged$PFSscores[,1]
# Flagged respondents: 30  37  46  49 137 216 531.

# Plot the PRFs of the first three flagged respondents:
Flagged    &lt;- PRFplot(InadequacyData, respID=Ht.flagged[1:3])
# Plot the person response function of respondent 35 (not flagged as aberrant):
PRFplot(InadequacyData, respID=35)
# Plot the PRFs of all respondents:
plot(Flagged$PRF.FDO)
</code></pre>

<hr>
<h2 id='print+20PerFit'>Print method for objects of class &quot;PerFit&quot;</h2><span id='topic+print.PerFit'></span>

<h3>Description</h3>

<p>Print method for objects of class &quot;PerFit&quot;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PerFit'
print(x, ...)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print+2B20PerFit_+3A_x">x</code></td>
<td>
<p>Object of class &quot;PerFit&quot;.</p>
</td></tr>
<tr><td><code id="print+2B20PerFit_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>print</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a given object of class <code>PerFit</code>, this function displays the scores of the person-fit statistic.
</p>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+cutoff">cutoff</a></code>, <code><a href="#topic+flagged.resp">flagged.resp</a></code>, <code><a href="#topic+plot.PerFit">plot.PerFit</a></code>, <code><a href="#topic+summary.PerFit">summary.PerFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the ZU3 scores:
ZU3.out &lt;- ZU3(InadequacyData)

print(ZU3.out)
</code></pre>

<hr>
<h2 id='summary+20PerFit'>Summary method for objects of class &quot;PerFit&quot;</h2><span id='topic+summary.PerFit'></span>

<h3>Description</h3>

<p>Summary method for objects of class &quot;PerFit&quot;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PerFit'
summary(object, cutoff.obj=NULL, 
        ModelFit="NonParametric", Nreps=1000, 
        IP=object$IP, IRT.PModel=object$IRT.PModel, Ability=object$Ability,
        Ability.PModel=object$Ability.PModel, mu=0, sigma=1, 
        Blvl = 0.05, Breps = 1000, CIlvl = 0.95, 
        UDlvl = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B20PerFit_+3A_object">object</code></td>
<td>
<p>Object of class &quot;PerFit&quot;.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_cutoff.obj">cutoff.obj</code></td>
<td>
<p>Object of class &quot;PerFit.cutoff&quot;.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_modelfit">ModelFit</code></td>
<td>
<p>Method required to compute model-fitting item score patterns. The options available are <code>"NonParametric"</code> (default) and <code>"Parametric"</code>.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_nreps">Nreps</code></td>
<td>
<p>Number of model-fitting item score patterns generated. Default is 1000.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters. Default is <code>object$IP</code>.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Parametric IRT model (required if <code>"ModelFit=Parametric"</code> or if the person fit statistic is parametric). Default is <code>object$IRT.PModel</code>.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_ability">Ability</code></td>
<td>
<p>Matrix with previously estimated item parameters. Default is <code>object$Ability</code>.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Method to use in order to estimate the latent ability parameters (required if <code>"ModelFit=Parametric"</code> or if the person fit statistic is parametric). Default is <code>object$Ability.PModel</code>.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_blvl">Blvl</code></td>
<td>
<p>Significance level for bootstrap distribution (value between 0 and 1). Default is 0.05.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_breps">Breps</code></td>
<td>
<p>Number of bootstrap resamples. Default is 1000.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_udlvl">UDlvl</code></td>
<td>
<p>User-defined cutoff level.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_cilvl">CIlvl</code></td>
<td>
<p>Level of bootstrap percentile confidence interval for the cutoff statistic.</p>
</td></tr>
<tr><td><code id="summary+2B20PerFit_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>summary</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a given object of class <code>PerFit</code>, this function prints: The PFS used, the cutoff value, the tail of the distribution of the person-fit statistic associated to misfit, the proportion of flagged respondents in the sample, and their row indices.
</p>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+cutoff">cutoff</a></code>, <code><a href="#topic+flagged.resp">flagged.resp</a></code>, <code><a href="#topic+plot.PerFit">plot.PerFit</a></code>, <code><a href="#topic+summary.PerFit">summary.PerFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the ZU3 scores:
ZU3.out &lt;- ZU3(InadequacyData)

summary(ZU3.out)
</code></pre>

<hr>
<h2 id='The+20caution+20statistic'>C.Sato, Cstar person-fit statistics</h2><span id='topic+Cstar'></span><span id='topic+C.Sato'></span>

<h3>Description</h3>

<p>Computes the caution statistic C.Sato and the modified caution statistic Cstar.</p>


<h3>Usage</h3>

<pre><code class='language-R'>C.Sato(matrix,
       NA.method = "Pairwise", Save.MatImp = FALSE, 
       IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
       mu = 0, sigma = 1)

Cstar(matrix,
     NA.method = "Pairwise", Save.MatImp = FALSE, 
     IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
     mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="The+2B20caution+2B20statistic_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="The+2B20caution+2B20statistic_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="The+2B20caution+2B20statistic_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="The+2B20caution+2B20statistic_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="The+2B20caution+2B20statistic_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"1PL"</code>, <code>"2PL"</code> (default), and <code>"3PL"</code>.</p>
</td></tr>
<tr><td><code id="The+2B20caution+2B20statistic_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="The+2B20caution+2B20statistic_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"ML"</code> (default), <code>"BM"</code>, and <code>"WL"</code>.</p>
</td></tr>
<tr><td><code id="The+2B20caution+2B20statistic_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="The+2B20caution+2B20statistic_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The C.Sato statistic (also refered to as C in the literature) was proposed by Sato (1975):
</p>
<p style="text-align: center;"><code class="reqn">C.Sato = 1-\frac{cov(x_n,p)}{cov(x_n^*,p)},</code>
</p>

<p>where <code class="reqn">x_n</code> is the 0-1 response vector of respondent <code class="reqn">n</code>, <code class="reqn">p</code> is the vector of item proportions-correct, and <code class="reqn">x_n^*</code> is the so-called Guttman vector containing correct answers for the easiest items (i.e., with the largest proportion-correct values) only. C.Sato is zero for Guttman vectors and its value tends to increase for response vectors that depart from the group's answering pattern, hence warning the researcher to be <em>cautious</em> about interpreting such item scores. Therefore, (potentially) aberrant response behavior is indicated by large values of C.Sato (i.e., in the right tail of the sampling distribution).
</p>
<p>Harnisch and Linn (1981) proposed a modified version of the caution statistic which bounds the caution statistic between 0 and 1 (also referred to as C* or MCI  in the literature):
</p>
<p style="text-align: center;"><code class="reqn">Cstar = \frac{cov(x_n^*,p)-cov(x_n,p)}{cov(x_n^*,p)-cov(x_n',p)},</code>
</p>

<p>where <code class="reqn">x_n'</code> is the reversed Guttman vector containing correct answers for the hardest items (i.e., with the smallest proportion-correct values) only. Cstar is sensitive to the so-called Guttman errors. A Guttman error is a pair of scores (0,1), where the 0-score pertains to the easiest item and the 1-score pertains to the hardest item. Cstar ranges between 0 (perfect Guttman vector) and 1 (reversed Guttman error), thus larger values indicate potential aberrant response behavior.
</p>
<p>These statistics are not computed for rows of <code>matrix</code> that consist of only 0s or only 1s (NA values are returned instead).
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "1PL"</code>, <code>"2PL"</code>, or <code>"3PL"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>A message indicating whether perfect response vectors (all-0s or all-1s) were removed from the analysis.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Row indices of all-0s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Row indices of all-1s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories (2 in this case).</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>x3 matrix of estimated item parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Harnisch, D. L., and Linn, R. L. (1981) Analysis of item response patterns: Questionable test data and dissimilar curriculum practices. <em>Journal of Educational Measurement</em>, <b>18(3)</b>, 133&ndash;146.
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>Sato, T. (1975) <em>The construction and interpretation of S-P tables.</em> Tokyo: Meiji Tosho.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ht">Ht</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the C.Sato scores:
C.out &lt;- C.Sato(InadequacyData)

# Compute the Cstar scores:
Cstar.out &lt;- Cstar(InadequacyData)
</code></pre>

<hr>
<h2 id='U3+2C+20ZU3'>U3, ZU3 person-fit statistics</h2><span id='topic+U3'></span><span id='topic+ZU3'></span>

<h3>Description</h3>

<p>van der Flier's U3 and ZU3 person-fit statistics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>U3(matrix,
   NA.method = "Pairwise", Save.MatImp = FALSE, 
   IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
   mu = 0, sigma = 1)

ZU3(matrix,
    NA.method = "Pairwise", Save.MatImp = FALSE, 
    IP = NULL, IRT.PModel = "2PL", Ability = NULL, Ability.PModel = "ML",
    mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="U3+2B2C+2B20ZU3_+3A_matrix">matrix</code></td>
<td>
<p>Data matrix of dichotomous item scores: Persons as rows, items as columns, item scores are either 0 or 1, missing values allowed.</p>
</td></tr>
<tr><td><code id="U3+2B2C+2B20ZU3_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="U3+2B2C+2B20ZU3_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="U3+2B2C+2B20ZU3_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item, and three columns ([,1] item discrimination; [,2] item difficulty; [,3] lower-asymptote, also referred to as pseudo-guessing parameter).
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="U3+2B2C+2B20ZU3_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"1PL"</code>, <code>"2PL"</code> (default), and <code>"3PL"</code>.</p>
</td></tr>
<tr><td><code id="U3+2B2C+2B20ZU3_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="U3+2B2C+2B20ZU3_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"ML"</code> (default), <code>"BM"</code>, and <code>"WL"</code>.</p>
</td></tr>
<tr><td><code id="U3+2B2C+2B20ZU3_+3A_mu">mu</code></td>
<td>
<p>Mean of the apriori distribution. Only used when <code>method="BM"</code>. Default is 0.</p>
</td></tr>
<tr><td><code id="U3+2B2C+2B20ZU3_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the apriori distribution. Only used when <code>method="BM"</code>. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose the items are ordered in decreasing proportion-correct score, <code class="reqn">p_1&gt;p_2&gt;\ldots&gt;p_I</code> (<code class="reqn">I</code> = number of items). Given response vector <code class="reqn">(X_1,X_2,\ldots,X_I)</code> with total score <code class="reqn">S=\sum_iX_i</code>, van der Flier (1980, 1982) defined the U3 statistic as
</p>
<p style="text-align: center;"><code class="reqn">\frac{\sum_{i=1}^S p_i-\sum_{i=1}^I p_i}{\sum_{i=1}^S p_i-\sum_{i=I-S+1}^I p_i}.</code>
</p>

<p>U3 varies from 0 for perfect Guttman response vectors (i.e., with only the easiest items correct) through 1 for reversed Guttman response vectors (i.e., with only the hardest items correct). Hence, increasingly large U3 values provide stronger indications of answering misfit. 
</p>
<p>U3 scores are dependent on the number-correct score, hence van der Flier proposed ZU3 as a standardization (formulas to compute E(U3) and Var(U3) can be found in van der Flier, 1982). ZU3 is supposed to be asymptotically approximated by the standard normal distribution, but this approximation is not without problems (see Emons, Meijer, and Sijtsma, 2002).
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from Bernoulli distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "1PL"</code>, <code>"2PL"</code>, or <code>"3PL"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>A message indicating whether perfect response vectors (all-0s or all-1s) were removed from the analysis.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Row indices of all-0s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Row indices of all-1s response vectors removed from the analysis (if applicable).</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories (2 in this case).</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>x3 matrix of estimated item parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters in case <code>NA.method="PModel"</code>, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Emons, W. M., Meijer, R. R., and Sijtsma, K. (2002). Comparing simulated and theoretical sampling distributions of the U3 person-fit statistic. <em>Applied Psychological Measurement</em>, <b>26(1)</b>, 88&ndash;108.
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>van der Flier, H. (1980) <em>Vergelijkbaarheid van individuele testprestaties</em> [Comparability of individual test performance]. Lisse: The Netherlands.
</p>
<p>van der Flier, H. (1982) Deviant response patterns and comparability of test scores. <em>Journal of Cross-Cultural Psychology</em>, <b>13(3)</b>, 267&ndash;298.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+U3poly">U3poly</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# Compute the U3 scores:
U3.out &lt;- U3(InadequacyData)

# Compute the ZU3 scores:
ZU3.out &lt;- ZU3(InadequacyData)
</code></pre>

<hr>
<h2 id='U3poly'>U3poly person-fit statistic</h2><span id='topic+U3poly'></span>

<h3>Description</h3>

<p>Generalization of van der Flier's U3 person-fit statistic to polytomously scored items.</p>


<h3>Usage</h3>

<pre><code class='language-R'>U3poly(matrix, Ncat, 
       NA.method = "Pairwise", Save.MatImp = FALSE, 
       IP = NULL, IRT.PModel = "GRM", Ability = NULL, Ability.PModel = "EAP")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="U3poly_+3A_matrix">matrix</code></td>
<td>
<p>A data matrix of polytomous item scores: Persons as rows, items as columns, item scores are integers between 0 and (Ncat-1), missing values allowed.</p>
</td></tr>
<tr><td><code id="U3poly_+3A_ncat">Ncat</code></td>
<td>
<p>Number of answer options for each item.</p>
</td></tr>
<tr><td><code id="U3poly_+3A_na.method">NA.method</code></td>
<td>
<p>Method to deal with missing values. The default is pairwise elimination (<code>"Pairwise"</code>). Alternatively, simple imputation methods are also available. The options available are <code>"Hotdeck"</code>, <code>"NPModel"</code> (default), and <code>"PModel"</code>.</p>
</td></tr>
<tr><td><code id="U3poly_+3A_save.matimp">Save.MatImp</code></td>
<td>
<p>Logical. Save (imputted) data matrix to file? Default is FALSE.</p>
</td></tr>
<tr><td><code id="U3poly_+3A_ip">IP</code></td>
<td>
<p>Matrix with previously estimated item parameters: One row per item. The first (Ncat-1) columns contain the between-categories threshold parameters (for the GRM) or the item step difficulties (for the PCM and the GPCM). The last, Ncat-th, column has the slopes.
</p>
<p>In case no item parameters are available then <code>IP=NULL</code>.</p>
</td></tr>
<tr><td><code id="U3poly_+3A_irt.pmodel">IRT.PModel</code></td>
<td>
<p>Specify the IRT model to use in order to estimate the item parameters (only if <code>IP=NULL</code>). The options available are <code>"PCM"</code>, <code>"GPCM"</code>, and <code>"GRM"</code> (default).</p>
</td></tr>
<tr><td><code id="U3poly_+3A_ability">Ability</code></td>
<td>
<p>Vector with previoulsy estimated latent ability parameters, one per respondent, following the order of the row index of <code>matrix</code>.
</p>
<p>In case no ability parameters are available then <code>Ability=NULL</code>.</p>
</td></tr>
<tr><td><code id="U3poly_+3A_ability.pmodel">Ability.PModel</code></td>
<td>
<p>Specify the method to use in order to estimate the latent ability parameters (only if <code>Ability=NULL</code>). The options available are <code>"EB"</code>, <code>"EAP"</code> (default), and <code>"MI"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Emons (2008) generalized the U3 statistic (van der Flier, 1980, 1982) to polytomous items. The idea is based on the so-called item-step difficulty, which is the probability of moving from answer category <code class="reqn">(c)</code> to answer category <code class="reqn">(c+1)</code> (<code class="reqn">c=0,\ldots,Ncat-2</code>).
</p>
<p>U3poly varies from 0 (no misfit) through 1 (extreme misfit). Hence, increasingly large U3poly values provide stronger indications of answering misfit. 
</p>
<p>The number of answer options, <code>Ncat</code>, is the same for all items. 
</p>
<p><code>U3poly</code> reduces to <code>U3</code> when <code>Ncat=2</code>.
</p>
<p>Missing values in <code>matrix</code> are dealt with by means of pairwise elimination by default. Alternatively, single imputation is also available. Three single imputation methods exist: Hotdeck imputation (<code>NA.method = "Hotdeck"</code>), nonparametric model imputation (<code>NA.method = "NPModel"</code>), and parametric model imputation (<code>NA.method = "PModel"</code>); see Zhang and Walker (2008). 
</p>

<ul>
<li><p> Hotdeck imputation replaces missing responses of an examinee ('recipient') by item scores from the examinee which is closest to the recipient ('donor'), based on the recipient's nonmissing item scores. The similarity between nonmissing item scores of recipients and donors is based on the sum of absolute differences between the corresponding item scores. The donor's response pattern is deemed to be the most similar to the recipient's response pattern in the group, so item scores of the former are used to replace the corresponding missing values of the latter. When multiple donors are equidistant to a recipient, one donor is randomly drawn from the set of all donors.
</p>
</li>
<li><p> The nonparametric model imputation method is similar to the hotdeck imputation, but item scores are generated from multinomial distributions with probabilities defined by donors with similar total score than the recipient (based on all items except the NAs).
</p>
</li>
<li><p> The parametric model imputation method is similar to the hotdeck imputation, but item scores are generated from multinomial distributions with probabilities estimated by means of parametric IRT models (<code>IRT.PModel = "PCM"</code>, <code>"GPCM"</code>, or <code>"GRM"</code>). Item parameters (<code>IP</code>) and ability parameters (<code>Ability</code>) may be provided for this purpose (otherwise the algorithm finds estimates for these parameters).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class &quot;PerFit&quot;, which is a list with 12 elements:
</p>
<table>
<tr><td><code>PFscores</code></td>
<td>
<p>A list of length <code class="reqn">N</code> (number of respondents) with the values of the person-fit statistic.</p>
</td></tr>
<tr><td><code>PFstatistic</code></td>
<td>
<p>The person-fit statistic used.</p>
</td></tr>
<tr><td><code>PerfVects</code></td>
<td>
<p>Not applicable.</p>
</td></tr>
<tr><td><code>ID.all0s</code></td>
<td>
<p>Not applicable.</p>
</td></tr>
<tr><td><code>ID.all1s</code></td>
<td>
<p>Not applicable.</p>
</td></tr>
<tr><td><code>matrix</code></td>
<td>
<p>The data matrix after imputation of missing values was performed (if applicable).</p>
</td></tr>
<tr><td><code>Ncat</code></td>
<td>
<p>The number of response categories.</p>
</td></tr>
<tr><td><code>IRT.PModel</code></td>
<td>
<p>The parametric IRT model used.</p>
</td></tr>
<tr><td><code>IP</code></td>
<td>
<p>The <code class="reqn">I</code>xNcat matrix of estimated item parameters.</p>
</td></tr>
<tr><td><code>Ability.PModel</code></td>
<td>
<p>The method used to estimate abilities used.</p>
</td></tr>
<tr><td><code>Ability</code></td>
<td>
<p>The vector of <code class="reqn">N</code> estimated ability parameters.</p>
</td></tr>
<tr><td><code>NAs.method</code></td>
<td>
<p>The imputation method used (if applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge N. Tendeiro <a href="mailto:tendeiro@hiroshima-u.ac.jp">tendeiro@hiroshima-u.ac.jp</a></p>


<h3>References</h3>

<p>Emons, W. M. (2008) Nonparametric person-fit analysis of polytomous item scores. <em>Applied Psychological Measurement</em>, <b>32(3)</b>, 224&ndash;247. 
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277&ndash;298.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107&ndash;135.
</p>
<p>van der Flier, H. (1980) <em>Vergelijkbaarheid van individuele testprestaties</em> [Comparability of individual test performance]. Lisse: The Netherlands.
</p>
<p>van der Flier, H. (1982) Deviant response patterns and comparability of test scores. <em>Journal of Cross-Cultural Psychology</em>, <b>13(3)</b>, 267&ndash;298.
</p>
<p>Zhang, B., and Walker, C. M. (2008) Impact of missing data on person-model fit and person trait estimation. <em>Applied Psychological Measurement</em>, <b>32(6)</b>, 466&ndash;479.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+U3">U3</a></code>, <code><a href="#topic+ZU3">ZU3</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the physical functioning data (polytomous item scores):
data(PhysFuncData)

# Compute the U3poly scores:
U3poly.out &lt;- U3poly(PhysFuncData,Ncat=3)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
