<!DOCTYPE html><html><head><title>Help for package triact</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {triact}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bout_summary'><p>Output of Triact$summarize_bouts()</p></a></li>
<li><a href='#cows_5hz'><p>cow acceleration data</p></a></li>
<li><a href='#interval_summary'><p>Output of Triact$summarize_intervals()</p></a></li>
<li><a href='#Triact'><p>R6 class for analyzing accelerometer data from cows</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analyzing the Lying Behavior of Cows from Accelerometer Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Assists in analyzing the lying behavior of cows from raw data 
    recorded with a triaxial accelerometer attached to the hind leg of a cow. Allows 
    the determination of common measures for lying behavior including total lying duration, the 
    number of lying bouts, and the mean duration of lying bouts. Further capabilities are the 
    description of lying laterality and the calculation of proxies for the level of physical 
    activity of the cow. Reference: Simmler M., Brouwers S. P. (2023) <a href="https://gitlab.com/AgroSimi/triact_manuscript">https://gitlab.com/AgroSimi/triact_manuscript</a>. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>R6 (&ge; 2.5.1), data.table (&ge; 1.14.8), checkmate (&ge; 2.2.0),
lubridate (&ge; 1.9.2), parallel, methods, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>signal (&ge; 0.7-7), tibble, rmarkdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-19 17:39:34 UTC; f80850181</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Simmler <a href="https://orcid.org/0000-0002-4095-4111"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Stijn Pieter Brouwers
    <a href="https://orcid.org/0000-0002-7028-7823"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Simmler &lt;michael.simmler@agroscope.admin.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-19 18:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bout_summary'>Output of Triact$summarize_bouts()</h2><span id='topic+bout_summary'></span>

<h3>Description</h3>

<p>Output of <a href="../../triact/html/Triact.html#method-summarize_bouts">Triact$summarize_bouts()</a>. The information contained in the output table depends on the analyses you added to the Triact object using the $add_activity(), $add_lying(), and $add_side() methods.
</p>
<p>The asterisk (*) in the column names below stands for one of 'L1', 'L2', 'AdjL1', and 'AdjL2', indicating type of norm (L1, L2) and 'adjustment' of activity values to zero during lying, i.e. lying considered inactive by definition. DBA is the abbreviation for the dynamic body acceleration. See Simmler &amp; Brouwers (2023).
</p>
<p><strong>id</strong> Cow id
</p>
<p><strong>bout_nr</strong> Sequential numbering of the bouts per cow id
</p>
<p><strong>startTime</strong> Start time of the bout
</p>
<p><strong>endTime</strong> End time of the bout
</p>
<p><strong>duration</strong> Duration of the bout. Units: As specified via the <code>duration_units</code> argument.
</p>
<p><strong>lying</strong> <code>TRUE</code> for lying bouts, <code>FALSE</code> for standing bouts
</p>
<p><strong>side</strong> <code>"L"</code> for left lying side, <code>"R"</code> for right lying side (NA for standing bouts)
</p>
<p><strong>mean*DBA</strong> Mean of the DBA-based proxy for physical activity. Units: <code class="reqn">g</code>
</p>
<p><strong>mean*Jerk</strong> Mean of the Jerk-based proxy for physical activity. Units: <code class="reqn">g  s^{-1}</code>
</p>


<h3>References</h3>

<p>Simmler. M., Brouwers S. P., 2023. Triact package for R: Analyzing the lying behavior of cows from accelerometer data. <a href="https://gitlab.com/AgroSimi/triact_manuscript">pdf</a>
</p>

<hr>
<h2 id='cows_5hz'>cow acceleration data</h2><span id='topic+cows_5hz'></span>

<h3>Description</h3>

<p>Acceleration data collected with triaxial accelerometers (MSR145, MSR Electronics, Switzerland) attached to the left hind leg of two dairy cows (cow01, cow02). The accelerometer sampling frequency was 5 Hz. The <em>forward</em>, <em>up</em>, and <em>right</em> acceleration correspond to body relative directions as used in <em>triact</em> (see <code>vignette("introduction", package = "triact")</code> and Simmler &amp; Brouwers, 2023).
</p>

<table>
<tr>
 <td style="text-align: left;">
    <em>colname</em> </td><td style="text-align: left;"> <em>type</em> </td><td style="text-align: left;"> <em>description</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
    id </td><td style="text-align: left;"> Factor </td><td style="text-align: left;"> unique id for the cow </td>
</tr>
<tr>
 <td style="text-align: left;">
    time </td><td style="text-align: left;"> POSIXct </td><td style="text-align: left;"> timestamp </td>
</tr>
<tr>
 <td style="text-align: left;">
    acc_fwd </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> acceleration from <em>forward</em> axis (units: <em>g</em>) </td>
</tr>
<tr>
 <td style="text-align: left;">
    acc_up </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> acceleration from <em>up</em> axis (units: <em>g</em>) </td>
</tr>
<tr>
 <td style="text-align: left;">
    acc_right </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> acceleration from <em>right</em> axis (units: <em>g</em>) </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>cows_5hz
</code></pre>


<h3>Note</h3>

<p>From the raw data files distributed with the triact package, <code>cows_5hz</code> can be reproduced as follows:
</p>
<pre>
# create a Triact object
my_triact &lt;- Triact$new()

input_dir &lt;- system.file("extdata", package = "triact")

# load data from files
# note the mapping of XYZ to forward, up, right (parameter timeFwdUpRight_cols)

my_triact$load_files(input = input_dir,
                     id_substring = c(1, 5),
                     timeFwdUpRight_cols = c(1, -2, 3, -4),
                     tz = "Europe/Zurich",
                     skip = "DATA")

cows_5hz_recreated &lt;- my_triact$data

# test whether they are identical
identical(cows_5hz_recreated, cows_5hz)

</pre>


<h3>Source</h3>

<p>Agroscope, 8356 Ettenhausen, Switzerland</p>


<h3>References</h3>

<p>Simmler. M., Brouwers S. P., 2023. Triact package for R: Analyzing the lying behavior of cows from accelerometer data. <a href="https://gitlab.com/AgroSimi/triact_manuscript">pdf</a>
</p>

<hr>
<h2 id='interval_summary'>Output of Triact$summarize_intervals()</h2><span id='topic+interval_summary'></span>

<h3>Description</h3>

<p>Output of <a href="../../triact/html/Triact.html#method-summarize_intervals">Triact$summarize_intervals()</a>. The information contained in the output table depends on the arguments <code>bouts</code> and <code>side</code> and on the analyses you added to the Triact object using the $add_activity(), $add_lying(), and $add_side() methods.
</p>
<p>The asterisk (*) in the column names below stands for one of 'L1', 'L2', 'AdjL1', and 'AdjL2', indicating type of norm (L1, L2) and 'adjustment' of activity values to zero during lying, i.e. lying considered inactive by definition. DBA is the abbreviation for the dynamic body acceleration. See Simmler &amp; Brouwers (2023).
</p>
<p><b>startTime</b>: Start time of the interval
</p>
<p><b>centerTime</b>: Center time of the interval (convenient for plotting)
</p>
<p><b>endTime</b>: End time of the interval
</p>
<p><b>duration</b>: Duration of data recordings in the interval. Helpful for the incompletely observed intervals at start and end of the recording. Units: As specified via the <code>duration_units</code> argument.
</p>
<p><b>durationStanding</b>: Duration in upright posture. Units: As specified via the <code>duration_units</code> argument.
</p>
<p><b>durationLying</b>: Duration in lying posture. Units: As specified via the <code>duration_units</code> argument.
</p>
<p><b>durationLyingLeft</b>: Duration in lying posture with lying side left. Units: As specified via the <code>duration_units</code> argument.
</p>
<p><b>durationLyingRight</b>: Duration in lying posture with lying side right. Units: As specified via the <code>duration_units</code> argument.
</p>
<p><b>mean*DBA</b>: Mean of the DBA-based proxy for physical activity. Units: <code class="reqn">g</code>
</p>
<p><b>mean*Jerk</b>:Mean of the Jerk-based proxy for physical activity. Units: <code class="reqn">g  s^{-1}</code>
</p>
<p><b>mean*DBAStanding</b>: Mean of the DBA-based proxy for physical activity when in upright posture. Units: <code class="reqn">g</code>
</p>
<p><b>mean*JerkStanding</b>: Mean of the Jerk-based proxy for physical activity when in upright posture. Units: <code class="reqn">g  s^{-1}</code>
</p>
<p><b>mean*DBALying</b>: Mean of the DBA-based proxy for physical activity when in lying posture. Units: <code class="reqn">g</code>
</p>
<p><b>mean*JerkLying</b>: Mean of the Jerk-based proxy for physical activity when in lying posture. Units: <code class="reqn">g  s^{-1}</code>
</p>
<p><b>mean*DBALyingLeft</b>: Mean of the DBA-based proxy for physical activity when in lying posture with lying side left. Units: <code class="reqn">g</code>
</p>
<p><b>mean*JerkLyingLeft</b>: Mean of the Jerk-based proxy for physical activity when in lying posture with lying side left. Units: <code class="reqn">g  s^{-1}</code>
</p>
<p><b>mean*DBALyingRight</b>: Mean of the DBA-based proxy for physical activity when in lying posture with lying side right. Units: <code class="reqn">g</code>
</p>
<p><b>mean*JerkLyingRight</b>: Mean of the Jerk-based proxy for physical activity when in lying posture with lying side right. Units: <code class="reqn">g  s^{-1}</code>
</p>
<p><b>nBoutsStanding</b>: Number of standing bouts (proportional if across intervals).
</p>
<p><b>nBoutsLying</b>: Number of lying bouts (proportional if across intervals).
</p>
<p><b>nBoutsLyingLeft</b>: Number of lying bouts with lying side left (proportional if across intervals).
</p>
<p><b>nBoutsLyingRight</b>: Number of lying bouts with lying side right (proportional if across intervals).
</p>
<p><b>wMeanDurationStandingBout</b>: Weighted-mean duration of standing bouts (weights are the proportions of the individual bouts overlapping with the respective intervals). Units: As specified via the <code>duration_units</code> argument.
</p>
<p><b>wMeanDurationLyingBout</b>: Weighted-mean duration of lying bouts (weights are the proportions of the individual bouts overlapping with the respective intervals). Units: As specified via the <code>duration_units</code> argument.
</p>
<p><b>wMeanDurationLyingBoutLeft</b>: Weighted-mean duration of lying bouts with lying side left (weights are the proportions of the individual bouts overlapping with the respective intervals). Units: As specified via the <code>duration_units</code> argument.
</p>
<p><b>wMeanDurationLyingBoutRight</b>: Weighted-mean duration of lying bouts with lying side right (weights are the proportions of the individual bouts overlapping with the respective intervals). Units: As specified via the <code>duration_units</code> argument.
</p>


<h3>References</h3>

<p>Simmler. M., Brouwers S. P., 2023. Triact package for R: Analyzing the lying behavior of cows from accelerometer data. <a href="https://gitlab.com/AgroSimi/triact_manuscript">pdf</a>
</p>

<hr>
<h2 id='Triact'>R6 class for analyzing accelerometer data from cows</h2><span id='topic+Triact'></span>

<h3>Description</h3>

<p>An object for containing and analyzing data from accelerometers attached to a hind leg of cows. Analyses focus on the lying behaviour and on the cows' level of physical activity as detailed in Simmler &amp; Brouwers (2023). For a usage example see <code>vignette("introduction", package = "triact")</code>.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>data</code></dt><dd><p>Raw accelerometer data and analysis results. Mainly modified by $load_... and the $add_... methods</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>Triact$new()</code></a>
</p>
</li>
<li> <p><a href="#method-load_files"><code>Triact$load_files()</code></a>
</p>
</li>
<li> <p><a href="#method-load_table"><code>Triact$load_table()</code></a>
</p>
</li>
<li> <p><a href="#method-check_orientation"><code>Triact$check_orientation()</code></a>
</p>
</li>
<li> <p><a href="#method-add_lying"><code>Triact$add_lying()</code></a>
</p>
</li>
<li> <p><a href="#method-add_side"><code>Triact$add_side()</code></a>
</p>
</li>
<li> <p><a href="#method-add_activity"><code>Triact$add_activity()</code></a>
</p>
</li>
<li> <p><a href="#method-summarize_intervals"><code>Triact$summarize_intervals()</code></a>
</p>
</li>
<li> <p><a href="#method-summarize_bouts"><code>Triact$summarize_bouts()</code></a>
</p>
</li>
<li> <p><a href="#method-extract_liedown"><code>Triact$extract_liedown()</code></a>
</p>
</li>
<li> <p><a href="#method-extract_standup"><code>Triact$extract_standup()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>Triact$clone()</code></a>
</p>
</li></ul>



<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code></h4>

<p>Create a new Triact object.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$new()</pre></div>



<h5>Returns</h5>

<p>A new Triact object.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()
      </pre>



<hr>
<a id="method-load_files"></a>



<h4>Method <code>load_files()</code></h4>

<p>Import acceleration data of one or multiple cows from delimiter-separated text files into the Triact object. Importing from multiple files from the same cows is possible but data should follow each other without any gaps in time (overlap is allowed as duplicates after concatenation will be removed). The filenames must allow unique identification of the cow (parameter: <code>id_substring</code>). Accelerometer sampling frequency must be consistent across the files. Acceleration should be in units of <em>g</em> and represent <em>proper acceleration</em>. Triaxial, biaxial, and uniaxial accelerometer data are allowed, but only triaxial data corresponding to relative body directions allows full functionality.
</p>
<p><em>Important</em>: Make sure to correctly specify how to map the axes as named by the accelerometer (e.g., x, y, z) to the body relative axes as used in triact (parameter: <code>timeFwdUpRight_cols</code>). For an example see <code>vignette("introduction", package = "triact")</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$load_files(
        input,
        id_substring,
        timeFwdUpRight_cols,
        time_format  = NULL,
        tz           = Sys.timezone(),
        skip         = "__auto__",
        sep          = "auto",
        header       = "auto",
        dec          = ".",
        start_time   = NULL,
        end_time     = NULL,
        parallel     = 1,
                       ...)</pre>
</div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>input</code></dt><dd>
<p>Specifies the input acceleration data files. Character vector with the name(s) of the file(s) or a directory containing the files (files can be in subdirectories). If it does not contain absolute paths, the directory or file name(s) are relative to the current working directory, <code>getwd()</code>.
</p>
</dd>
<dt><code>id_substring</code></dt><dd>
<p>Integer vector identifying the substring of the file names representing the unique identifier of the cows by character position: c(first, last), e.g, <code>c(1, 5)</code> for first to fifth character. Alternatively, a Perl-like <a href="base.html#topic+regex">regular expression</a> matching the substring.
</p>
</dd>
<dt><code>timeFwdUpRight_cols</code></dt><dd>
<p>Integer vector specifying the columns containing the time, and the forward, up, and right axis acceleration data: c(time, fwd, up, right). Missing acceleration axes are specified as <code>NA</code>. A negative mathematical sign is used to indicate that the recorded data reflects the opposite direction (e.g., if you recorded backward acceleration, specify the forward acceleration column with a negative mathematical sign).
</p>
</dd>
<dt><code>time_format</code></dt><dd>
<p>Character vector specifying the date-time format corresponding to the acceleration files (syntax as in <code><a href="base.html#topic+strptime">strptime</a></code>). If <code>NULL</code> a date-time format as tried by <a href="base.html#topic+as.POSIXct">as.POSIX*</a> is expected. <em>Default:</em> <code>NULL</code>
</p>
</dd>
<dt><code>tz</code></dt><dd>
<p>Character vector specifying the <a href="base.html#topic+timezones">time zone</a>. <em>Default:</em> <code>Sys.timezone()</code>
</p>
</dd>
<dt><code>skip</code></dt><dd>
<p>An integer indicating the number of lines to skip before starting the search for the first data line, which is the first row with a consistent number of columns. Alternatively, a (sub)string specifying the line at which to start the search, or <code>"__auto__"</code> to leave the decision to <code><a href="data.table.html#topic+fread">data.table::fread</a></code>. <em>Default:</em> <code>"__auto__"</code>
</p>
</dd>
<dt><code>sep</code></dt><dd>
<p>The separator between columns in the acceleration data files. If <code>"auto"</code>, it is automatically detected by <code><a href="data.table.html#topic+fread">data.table::fread</a></code> according to the character in the set [,\t |;:] that separates the sample of rows into the most number of lines with the same number of fields. <em>Default:</em> <code>"auto"</code>
</p>
</dd>
<dt><code>header</code></dt><dd>
<p>A logical value that indicates whether the first data line (afer considering <code>skip</code>) contains column names. Alternatively, <code>"auto"</code> to autmatically detect by <code><a href="data.table.html#topic+fread">data.table::fread</a></code> according to whether every non-empty field on the first data line is type character. <em>Default:</em> <code>"auto"</code>
</p>
</dd>
<dt><code>dec</code></dt><dd>
<p>The decimal separator as in <code><a href="data.table.html#topic+fread">data.table::fread</a></code>. <em>Default:</em> <code>"."</code>
</p>
</dd>
<dt><code>start_time</code></dt><dd>
<p>Time from which the data should be considered. Formatted as &quot;%Y-%m-%d %H:%M:%OS&quot; or in another format automatically tried by <a href="base.html#topic+as.POSIXct">as.POSIX*</a>. <em>Default:</em> <code>NULL</code>
</p>
</dd>
<dt><code>end_time</code></dt><dd>
<p>Time up to which the data should be considered. Formatted as &quot;%Y-%m-%d %H:%M:%OS&quot; or in another format automatically tried by <a href="base.html#topic+as.POSIXct">as.POSIX*</a>. <em>Default:</em> <code>NULL</code>
</p>
</dd>
<dt><code>parallel</code></dt><dd>
<p>An integer indicating the number of files that are read in parallel. For <code>parallel &gt; 1</code> the reading of the individual file is set to single-threaded to avoid nested parallelization. This behavior can be overwritten by additionally passing <code>nThread</code> via <code>...</code>  argument, which is passed on to <code><a href="data.table.html#topic+fread">data.table::fread</a></code>. <em>Default:</em> <code>1</code>
</p>
</dd>
<dt><code>...</code></dt><dd>
<p>Further arguments passed to <code><a href="data.table.html#topic+fread">data.table::fread</a></code>.
</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>Returns the Triact object itself, but modified by reference.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

input_dir &lt;- system.file("extdata", package = "triact")

my_triact$load_files(input = input_dir,
                     id_substring = c(1, 5),
                     timeFwdUpRight_cols = c(1, -2, 3, -4),
                     skip = "DATA")

# inspect imported data
head(my_triact$data)
      </pre>



<hr>
<a id="method-load_table"></a>



<h4>Method <code>load_table()</code></h4>

<p>Import acceleration data from a data.frame-like table (see <code><a href="#topic+cows_5hz">cows_5hz</a></code> as an example). The table should contain the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <em>colname</em> </td><td style="text-align: left;"> <em>type</em> </td><td style="text-align: left;"> <em>description</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
    id </td><td style="text-align: left;"> Factor </td><td style="text-align: left;"> unique id for the cow </td>
</tr>
<tr>
 <td style="text-align: left;">
    time </td><td style="text-align: left;"> POSIXct </td><td style="text-align: left;"> timestamp </td>
</tr>
<tr>
 <td style="text-align: left;">
    acc_fwd </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> acceleration from <em>forward</em> axis (units: <em>g</em>) </td>
</tr>
<tr>
 <td style="text-align: left;">
    acc_up </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> acceleration from <em>up</em> axis (units: <em>g</em>) </td>
</tr>
<tr>
 <td style="text-align: left;">
    acc_right </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> acceleration from <em>right</em> axis (units: <em>g</em>) </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>The accelerometer sampling frequency must be the same across all cows (id). No time gaps are allowed (within data of one id). One or two of the acceleration columns may be missing, but the possible analyses are then limited.
</p>
<p><em>Important</em>: Make sure the accelerometer axes correctly represent body relative axes as used in triact (forward, up, right). For an example see <code>vignette("introduction", package = "triact")</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$load_table(table)
      </pre></div>



<h5>Usage (alternative syntax)</h5>

<div class="r"><pre>Triact$data &lt;- table
      </pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>table</code></dt><dd><p>Data frame-like table containing the data to import. Must follow the requirements detailed in the description above.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>Returns the Triact object itself, but modified by reference.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

# inspect imported data
head(my_triact$data)
      </pre>



<hr>
<a id="method-check_orientation"></a>



<h4>Method <code>check_orientation()</code></h4>

<p>Checks for each id (unique identifier of the cow) whether the accelerometer may have been unintentionally mounted 180° rotated in the sagittal plane to the hind leg. If identified as such, the mathematical correction is applied, i.e. the forward and up axes are negated (multiplied by -1), i.e. the axes are mathematically rotated in order to comply with the orientation as specified when loading in the data.
The check is <code>sum(acc_up &gt; crit) &lt; sum(acc_up &lt; (-1 * crit))</code> with <code>crit = 0.5</code> by default.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$check_orientation(crit = 0.5, interactive = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>crit</code></dt><dd>
<p>Critical value used in the check according to the expression noted in the description above.  <em>Default:</em> <code>0.5</code>
</p>
</dd>
<dt><code>interactive</code></dt><dd>
<p>A logical value that indicates whether the function should interactively prompt the user before applying the correction. <em>Default:</em> <code>TRUE</code>
</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>Returns the Triact object itself, but modified by reference.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

my_triact$check_orientation()
      </pre>



<hr>
<a id="method-add_lying"></a>



<h4>Method <code>add_lying()</code></h4>

<p>Classify data into lying and standing and add results as column 'lying' to the Triact object. Additionally, lying and standing bouts are uniquely numbered per id (cow) in column 'bout_nr'.
The simple rule-based algorithm is composed of three steps: In the first step, the <em>up</em> acceleration is filtered to obtain the gravity component of the signal. In the second step, a threshold is used to classify the (filtered) gravitational acceleration into lying and standing. Finally, in the third step, lying bouts shorter than a given minimum duration are reclassified as standing. The last step can be performed analogous for standing bouts, but is not recommended by default. See Simmler &amp; Brouwers (2023) for a detailed discussion.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$add_lying(
      filter_method = "median",
      crit_lie = 0.5,
      minimum_duration_lying = 30,
      minimum_duration_standing = NULL,
      add_filtered = FALSE,
      window_size = 10,
      cutoff = 0.1,
      order = 1)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>filter_method</code></dt><dd>
<p>Filter method to be applied to obtain the gravity component of the acceleration on the <em>up</em> axis. Options are <code>"median"</code>, for median filter, and <code>"butter"</code> for a bidirectional (zero-lag) Butterworth low-pass filter. <em>Default:</em> <code>"median"</code>
</p>
</dd>
<dt><code>crit_lie</code></dt><dd>
<p>Threshold for classifying the gravitational acceleration on <em>up</em> axis into lying (below threshold) and standing (above threshold). <em>Default:</em> <code>0.5</code>
</p>
</dd>
<dt><code>minimum_duration_lying</code></dt><dd>
<p>Minimum duration for lying bouts in seconds. Lying bouts shorter than this threshold are considered false and reclassified as standing. <em>Default:</em> <code>30</code>
</p>
</dd>
<dt><code>minimum_duration_standing</code></dt><dd>
<p>Minimum duration for standing bouts in seconds. Standing bouts shorter than this threshold are considered false and reclassified as lying.
<em>Default:</em> <code>NULL</code>
</p>
</dd>
<dt><code>add_filtered</code></dt><dd>
<p>Logical value that indicates whether the filtered gravity component of the <em>up</em> acceleration should be added to the Triact object.
<em>Default:</em> <code>FALSE</code>
</p>
</dd>
<dt><code>window_size</code></dt><dd>
<p>Window size in seconds for filter method 'median'.  <em>Default:</em> <code>10</code>
</p>
</dd>
<dt><code>cutoff</code></dt><dd>
<p>Cutoff frequency for low-pass filtering in Hz for filter method 'butter'. <em>Default:</em> <code>0.1</code>
</p>
</dd>
<dt><code>order</code></dt><dd>
<p>Filter order for filter method 'butter'. <em>Default:</em> <code>1</code>
</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>Returns the Triact object itself, but modified by reference.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

my_triact$add_lying()

# inspect result
head(my_triact$data)
      </pre>



<hr>
<a id="method-add_side"></a>



<h4>Method <code>add_side()</code></h4>

<p>Classify lying bouts into left and right lying side and add the results as column 'side' to the Triact object. The simple one-step algorithm determines whether the majority of the <em>right</em> acceleration values measured during that bout are above (left lying side) or below (right lying side) a threshold. The default threshold depends on which hind leg (left/right hind leg) the accelerometer is attached to, taking into account the asymmetry of the cow's natural lying position. See Simmler &amp; Brouwers (2023) for a detailed explanation.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$add_side(left_leg, crit_left = if (left_leg) 0.5 else -0.5)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>left_leg</code></dt><dd><p>Logical indicating whether the accelerometers were attached to the left hind leg (<code>TRUE</code>) or to the right hind leg (<code>FALSE</code>). This information is used to choose the default value for <code>crit_left</code>. It is ignored if <code>crit_left</code> is specified by the user.</p>
</dd>
<dt><code>crit_left</code></dt><dd><p>Threshold for classifying lying on left versus right side based on <em>right</em> acceleration.  <em>Default:</em> <code>0.5</code> if <code>left_leg</code> is <code>TRUE</code>, else <code>-0.5</code></p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>Returns the Triact object itself, but modified by reference.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

my_triact$add_lying()

my_triact$add_side(left_leg = TRUE)

# inspect result
head(my_triact$data)
      </pre>



<hr>
<a id="method-add_activity"></a>



<h4>Method <code>add_activity()</code></h4>

<p>Calculate proxies for the physical activity level. By default, the L2 norm of the dynamic body acceleration (DBA) vector is calculated. The corresponding L1 norm is optionally available. Also, the L1 and L2 norms of the jerk vector can be calculated. By default, all activity values during lying bouts are 'adjusted' to zero, i.e., periods when cows are lying are considered as 'inactive' by definition. See Simmler &amp; Brouwers (2023) for details.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$add_activity(
        dynamic_measure = "dba",
        norm = "L2",
        adjust = TRUE,
        filter_method = "median",
        keep_dynamic_measure = FALSE,
        window_size = 10,
        cutoff = 0.1,
        order = 1)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dynamic_measure</code></dt><dd>
<p>Type of dynamic measure to base the activity proxy on. Options are <code>"dba"</code>, for dynamic body acceleration, and <code>"jerk"</code>, for the jerk vector. One or both can be provided, e.g., <code>"dba"</code> or <code>c("dba", "jerk")</code>. <em>Default:</em> <code>"dba"</code>
</p>
</dd>
<dt><code>norm</code></dt><dd>
<p>The type of norm to be calculated. Options are <code>"L1"</code> and <code>"L2"</code>. One or both can be provided, e.g., <code>"L1"</code> or <code>c("L1", "L2")</code>. <em>Default:</em> <code>"L2"</code>
</p>
</dd>
<dt><code>adjust</code></dt><dd>
<p>A logical value that indicates whether the proxies for physical activity should be 'adjusted' to 0 during lying bouts, i.e., whether cows should be considered as inactive by definition when lying. <em>Default:</em> <code>TRUE</code>
</p>
</dd>
<dt><code>filter_method</code></dt><dd>
<p>Filter method to be used to determine the gravity component subtracted from the raw acceleration to obtain the dynamic body acceleration. Options are <code>"median"</code>, for median filter, and <code>"butter"</code> for a bidirectional (zero-lag) Butterworth low-pass filter. <em>Default:</em> <code>"median"</code>
</p>
</dd>
<dt><code>keep_dynamic_measure</code></dt><dd>
<p>A logical value that indicates whether the intermediate data, being the dynamic body acceleration vector and/or the jerk vector, should be added to the Triact object. <em>Default:</em> <code>FALSE</code>
</p>
</dd>
<dt><code>window_size</code></dt><dd>
<p>Window size in seconds for filter method 'median' used in DBA-based proxies.  <em>Default:</em> <code>10</code>
</p>
</dd>
<dt><code>cutoff</code></dt><dd>
<p>Cutoff frequency for low-pass filtering in Hz for filter method 'butter' used in DBA-based proxies. <em>Default:</em> <code>0.1</code>
</p>
</dd>
<dt><code>order</code></dt><dd>
<p>Filter order for filter method 'butter' used in DBA-based proxies. <em>Default:</em> <code>1</code>
</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>Returns the Triact object itself, but modified by reference.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

my_triact$add_lying()

my_triact$add_activity()

# inspect result
head(my_triact$data)
      </pre>



<hr>
<a id="method-summarize_intervals"></a>



<h4>Method <code>summarize_intervals()</code></h4>

<p>Summarizes the data  in the Triact object, activity and lying behaviour, by regular intervals. The information contained in the output table depends on the analyses you added to the Triact object using the $add_activity(), $add_lying(), and $add_side() methods. With <code>bout = TRUE</code> information on bouts per interval (number and mean bout duration) will be returned additionally. With <code>side = TRUE</code> summarized information such lying duration is additionally provided separately for the lying side (left/right). For measures such as the number of lying bouts or mean lying bout duration, a weighted mean ('wMean...') is calculated with the weights being the proportion of the individual bout overlapping with the respective interval. See <a href="#topic+interval_summary">interval_summary</a> for a complete list of summarized measures and Simmler &amp; Brouwers (2023) for details.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$summarize_intervals(
      interval = "hour",
      lag_in_s = 0,
      duration_units = "mins",
      bouts = FALSE,
      side = FALSE,
      calc_for_incomplete = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>interval</code></dt><dd><p>Character string specifying the intervals to be analyzed. Any unique English abbreviation valid for the 'unit' argument of <code><a href="lubridate.html#topic+floor_date">lubridate::floor_date</a></code> is allowed, e.g., <code>"hour"</code>, <code>"min"</code>, <code>"10 mins"</code>, and <code>"0.5 hours"</code>. <em>Default:</em> <code>"hour"</code></p>
</dd>
<dt><code>lag_in_s</code></dt><dd><p>Lag in seconds with respect to the full hour or full day. Determines the start of the intervals. <em>Default:</em> <code>0</code></p>
</dd>
<dt><code>duration_units</code></dt><dd><p>Unit in which durations should be returned. Options are <code>"secs"</code>, <code>"mins"</code> and <code>"hours"</code>. <em>Default:</em> <code>"mins"</code></p>
</dd>
<dt><code>bouts</code></dt><dd><p>Logical indicating whether information on bouts should be additionally summarized. <em>Default:</em> <code>FALSE</code></p>
</dd>
<dt><code>side</code></dt><dd><p>Logical indicating whether lying side should be considered in the summary. <em>Default:</em> <code>FALSE</code></p>
</dd>
<dt><code>calc_for_incomplete</code></dt><dd><p>Logical indicating whether a complete summary should also be returned for the incompletely observed intervals (first and last interval for each cow) and for any parameter using information of incompletely observed bouts (first and last bout for each cow). Please note that these are ill-defined. <em>Default:</em> <code>FALSE</code></p>
</dd>
</dl>


</div>


<h5>Returns</h5>

<p>A table with summaries by interval (rows). See <a href="#topic+interval_summary">interval_summary</a> for a complete list.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

my_triact$add_lying()

int_summary &lt;- my_triact$summarize_intervals()

# inspect result
head(int_summary)
      </pre>



<hr>
<a id="method-summarize_bouts"></a>



<h4>Method <code>summarize_bouts()</code></h4>

<p>Summarizes the data in the Triact object, activity and lying behaviour, by lying/standing bouts. The information contained in the output table depends on the analyses you added to the Triact object using the $add_activity(), $add_lying(), and $add_side() methods. See <a href="#topic+bout_summary">bout_summary</a> for a complete list of summarized measures and Simmler &amp; Brouwers (2023) for details.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$summarize_bouts(
      bout_type = "both",
      duration_units = "mins",
      calc_for_incomplete = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>bout_type</code></dt><dd><p> Type of bout to be considered. Options are <code>"both"</code>, <code>"lying"</code>, and <code>"standing"</code>. <em>Default:</em> <code>"both"</code></p>
</dd>
<dt><code>duration_units</code></dt><dd><p>Units in which durations should be returned. Options are <code>"secs"</code>, <code>"mins"</code>, and <code>"hours"</code>. <em>Default:</em> <code>"mins"</code></p>
</dd>
<dt><code>calc_for_incomplete</code></dt><dd><p>Logical indicating whether a complete summary should also be returned for the incompletely observed bouts (first and last bout for each cow). Please note that these are ill-defined. <em>Default:</em> <code>FALSE</code></p>
</dd>
</dl>


</div>


<h5>Returns</h5>

<p>A table with summaries by bout (rows).  See <a href="#topic+bout_summary">bout_summary</a> for a complete list.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

my_triact$add_lying()

bouts_summary &lt;- my_triact$summarize_bouts()

# inspect result
head(bouts_summary)
      </pre>



<hr>
<a id="method-extract_liedown"></a>



<h4>Method <code>extract_liedown()</code></h4>

<p>Extracts data associated with liedown events (standing-to-lying transitions). Operates in two modes, see <em>Returns</em> section.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$extract_liedown(sec_before = 0, sec_after = 0)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sec_before</code></dt><dd>
<p>From how many seconds before the liedown events data should be considered. <em>Default:</em> <code>0</code>
</p>
</dd>
<dt><code>sec_after</code></dt><dd>
<p>Up to how many seconds after the liedown events data should be considered. <em>Default:</em> <code>0</code>
</p>
</dd>
</dl>


</div>


<h5>Returns</h5>

<p>With default settings, a table with one entry per liedown event, with timestamp and bout_nr of the lying bout, plus lying side information (if available). With parameters <code>sec_before</code> and/or <code>sec_after</code> &gt; 0, a list containing individual tables per liedown event. These tables are extracts of all data in the Triact object from within the defined time window around the liedown events.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

my_triact$add_lying()

l_downs &lt;- my_triact$extract_liedown()

# inspect result
print(l_downs)
      </pre>



<hr>
<a id="method-extract_standup"></a>



<h4>Method <code>extract_standup()</code></h4>

<p>Extracts data associated with standup events (lying-to-standing transitions). Operates in two modes, see <em>Returns</em> section.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$extract_standup(sec_before = 0, sec_after = 0)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sec_before</code></dt><dd>
<p>From how many seconds before the standup events data should be considered. <em>Default:</em> <code>0</code>
</p>
</dd>
<dt><code>sec_after</code></dt><dd>
<p>Up to how many seconds after the standup events data should be considered. <em>Default:</em> <code>0</code>
</p>
</dd>
</dl>


</div>


<h5>Returns</h5>

<p>With default settings, a table with one entry per standup event, with timestamp and bout_nr of the lying bout, plus lying side information (if available). With parameters <code>sec_before</code> and/or <code>sec_after</code> &gt; 0, a list containing individual tables per standup event. These tables are extracts of all data in the Triact object from within the defined time window around the standup events.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

my_triact$add_lying()

st_ups &lt;- my_triact$extract_standup()

# inspect result
print(st_ups)
      </pre>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>Copy a Triact object. By default a shallow copy is returned, which does not
completely copy the data contained in the Triact object. For a complete copy use <code>deep = TRUE</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>Triact$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd>
<p>Whether to make a deep copy. <em>Default:</em> <code>FALSE</code>
</p>
</dd>
</dl>


</div>


<h5>Returns</h5>

<p>A copy of the Triact object.
</p>



<h5>Examples</h5>

<pre>
# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

# create a complete copy
my_triact_cp = my_triact$clone(deep = TRUE)
      </pre>




<h3>References</h3>

<p>Simmler. M., Brouwers S. P., 2023. Triact package for R: Analyzing the lying behavior of cows from accelerometer data. <a href="https://gitlab.com/AgroSimi/triact_manuscript">pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Please read the "introduction" vignette for more detailed examples

## -------------------------
# method '$new'
## -------------------------

# create a Triact object
my_triact &lt;- Triact$new()

## -------------------------
# method '$load_files'
## -------------------------


# create a Triact object
my_triact &lt;- Triact$new()

input_dir &lt;- system.file("extdata", package = "triact")

my_triact$load_files(input = input_dir,
                     id_substring = c(1, 5),
                     timeFwdUpRight_cols = c(1, -2 ,3, -4),
                     skip = "DATA")

# inspect imported data
head(my_triact$data)


## -------------------------
# method 'load_table'
## -------------------------

# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

# inspect imported data
head(my_triact$data)

## -------------------------
# method 'check_orientation'
## -------------------------

my_triact$check_orientation()

## -------------------------
# method 'add_lying'
## -------------------------

my_triact$add_lying()

# inspect result
head(my_triact$data)

## -------------------------
# method 'add_side'
## -------------------------

my_triact$add_side(left_leg = TRUE)

# inspect result
head(my_triact$data)

## -------------------------
# method 'add_activity'
## -------------------------

my_triact$add_activity()

# inspect result
head(my_triact$data)

## -------------------------
# method 'summarize_intervals'
## -------------------------

int_summary &lt;- my_triact$summarize_intervals()

# inspect result
head(int_summary)

## -------------------------
# method 'summarize_bouts'
## -------------------------

bouts_summary &lt;- my_triact$summarize_bouts()

# inspect result
head(bouts_summary)

## -------------------------
# method 'extract_liedown'
## -------------------------

l_downs &lt;- my_triact$extract_liedown()

# inspect result
print(l_downs)

## -------------------------
# method 'extract_standup'
## -------------------------

st_ups &lt;- my_triact$extract_standup()

# inspect result
print(st_ups)

## -------------------------
# method 'clone'
## -------------------------

# create a Triact object
my_triact &lt;- Triact$new()

my_triact$load_table(cows_5hz)

# create a complete copy
my_triact_cp = my_triact$clone(deep = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
