<!DOCTYPE html><html><head><title>Help for package bfast</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bfast}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.bfast_cpp_closestfrom'><p>For all elements of a vector a, find the closest elements in a vector B and returns resulting indexes</p></a></li>
<li><a href='#bfast'><p>Break Detection in the Seasonal and Trend Component of a Univariate Time</p>
Series</a></li>
<li><a href='#bfast-deprecated'><p>Deprecated functions in package <span class="pkg">bfast</span>.</p></a></li>
<li><a href='#bfast-package'><p>Breaks For Additive Season and Trend (BFAST)</p></a></li>
<li><a href='#bfast01'><p>Checking for one major break in the time series</p></a></li>
<li><a href='#bfast01classify'><p>Change type analysis of the bfast01 function</p></a></li>
<li><a href='#bfastlite'><p>Detect multiple breaks in a time series</p></a></li>
<li><a href='#bfastmonitor'><p>Near Real-Time Disturbance Detection Based on BFAST-Type Models</p></a></li>
<li><a href='#bfastpp'><p>Time Series Preprocessing for BFAST-Type Models</p></a></li>
<li><a href='#bfastts'><p>Create a regular time series object by combining data and date information</p></a></li>
<li><a href='#create16dayts-deprecated'><p>A helper function to create time series</p></a></li>
<li><a href='#dates'><p>A vector with date information (a Datum type) to be linked with each NDVI</p>
layer within the modis raster brick (modisraster data set)</a></li>
<li><a href='#harvest'><p>16-day NDVI time series for a Pinus radiata plantation.</p></a></li>
<li><a href='#modisraster'><p>A raster brick of 16-day satellite image NDVI time series for a small subset</p>
in south eastern Somalia.</a></li>
<li><a href='#ndvi'><p>A random NDVI time series</p></a></li>
<li><a href='#plot.bfast'><p>Methods for objects of class &quot;bfast&quot;.</p></a></li>
<li><a href='#plot.bfastlite'><p>Plot the time series and results of BFAST Lite</p></a></li>
<li><a href='#setoptions'><p>Set package options with regard to computation times</p></a></li>
<li><a href='#simts'><p>Simulated seasonal 16-day NDVI time series</p></a></li>
<li><a href='#som'><p>Two 16-day NDVI time series from the south of Somalia</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.6.1</td>
</tr>
<tr>
<td>Title:</td>
<td>Breaks for Additive Season and Trend</td>
</tr>
<tr>
<td>Description:</td>
<td>Decomposition of time series into
    trend, seasonal, and remainder components with methods for detecting and
    characterizing abrupt changes within the trend and seasonal components. 'BFAST'
    can be used to analyze different types of satellite image time series and can
    be applied to other disciplines dealing with seasonal or non-seasonal time
    series, such as hydrology, climatology, and econometrics. The algorithm can be
    extended to label detected changes with information on the parameters of the
    fitted piecewise linear models. 'BFAST' monitoring functionality is described
    in Verbesselt et al. (2010) &lt;<a href="https://doi.org/10.1016%2Fj.rse.2009.08.014">doi:10.1016/j.rse.2009.08.014</a>&gt;. 'BFAST monitor'
    provides functionality to detect disturbance in near real-time based on 'BFAST'-
    type models, and is described in Verbesselt et al. (2012) &lt;<a href="https://doi.org/10.1016%2Fj.rse.2012.02.022">doi:10.1016/j.rse.2012.02.022</a>&gt;.
    'BFAST Lite' approach is a flexible approach that handles missing data
    without interpolation, and will be described in an upcoming paper.
    Furthermore, different models can now be used to fit the
    time series data and detect structural changes (breaks).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), strucchangeRcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, zoo, forecast, Rcpp (&ge; 0.12.7), Rdpack (&ge;
0.7)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, sfsmisc, stlplus, raster</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://bfast2.github.io/">https://bfast2.github.io/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bfast2/bfast/issues">https://github.com/bfast2/bfast/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-06 16:18:40 UTC; dainius</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Verbesselt [aut],
  Dainius Masiliunas
    <a href="https://orcid.org/0000-0001-5654-1277"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Achim Zeileis [aut],
  Rob Hyndman [ctb],
  Marius Appel [aut],
  Martin Jung [ctb],
  Andrei Mirt <a href="https://orcid.org/0000-0003-3654-2090"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Paulo Negri Bernardino [ctb],
  Dongdong Kong <a href="https://orcid.org/0000-0003-1836-8172"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dainius Masiliunas &lt;pastas4@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-10 14:12:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='.bfast_cpp_closestfrom'>For all elements of a vector a, find the closest elements in a vector B and returns resulting indexes</h2><span id='topic+.bfast_cpp_closestfrom'></span>

<h3>Description</h3>

<p>For all elements of a vector a, find the closest elements in a vector B and returns resulting indexes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.bfast_cpp_closestfrom(a, b, twosided)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".bfast_cpp_closestfrom_+3A_a">a</code></td>
<td>
<p>numeric vector, ordered</p>
</td></tr>
<tr><td><code id=".bfast_cpp_closestfrom_+3A_b">b</code></td>
<td>
<p>numeric vector, ordered</p>
</td></tr>
<tr><td><code id=".bfast_cpp_closestfrom_+3A_twosided">twosided</code></td>
<td>
<p>logical value, if false, indexes will always point to elements in b that are less than or equal to elements in a but not greater than.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integer vector of the same size as a with elements represnting indexes pointing to closest values in b
</p>

<hr>
<h2 id='bfast'>Break Detection in the Seasonal and Trend Component of a Univariate Time
Series</h2><span id='topic+bfast'></span>

<h3>Description</h3>

<p>Iterative break detection in seasonal and trend component of a time series.
Seasonal breaks is a function that combines the iterative decomposition of
time series into trend, seasonal and remainder components with significant
break detection in the decomposed components of the time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfast(
  Yt,
  h = 0.15,
  season = c("dummy", "harmonic", "none"),
  max.iter = 10,
  breaks = NULL,
  hpc = "none",
  level = 0.05,
  decomp = c("stl", "stlplus"),
  type = "OLS-MOSUM",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bfast_+3A_yt">Yt</code></td>
<td>
<p>univariate time series to be analyzed. This should be an object of
class &quot;ts&quot; with a frequency greater than one.</p>
</td></tr>
<tr><td><code id="bfast_+3A_h">h</code></td>
<td>
<p>minimal segment size between potentially detected breaks in the
trend model given as fraction relative to the sample size (i.e. the minimal
number of observations in each segment divided by the total length of the
timeseries).</p>
</td></tr>
<tr><td><code id="bfast_+3A_season">season</code></td>
<td>
<p>the seasonal model used to fit the seasonal component and
detect seasonal breaks (i.e. significant phenological change).  There are
three options: &quot;dummy&quot;, &quot;harmonic&quot;, or &quot;none&quot; where &quot;dummy&quot; is the model
proposed in the first Remote Sensing of Environment paper and &quot;harmonic&quot; is
the model used in the second Remote Sensing of Environment paper (See paper
for more details) and where &quot;none&quot; indicates that no seasonal model will be
fitted (i.e. St = 0 ). If there is no seasonal cycle (e.g. frequency of the
time series is 1) &quot;none&quot; can be selected to avoid fitting a seasonal model.</p>
</td></tr>
<tr><td><code id="bfast_+3A_max.iter">max.iter</code></td>
<td>
<p>maximum amount of iterations allowed for estimation of
breakpoints in seasonal and trend component.</p>
</td></tr>
<tr><td><code id="bfast_+3A_breaks">breaks</code></td>
<td>
<p>integer specifying the maximal number of breaks to be
calculated. By default the maximal number allowed by h is used.</p>
</td></tr>
<tr><td><code id="bfast_+3A_hpc">hpc</code></td>
<td>
<p>A character specifying the high performance computing support.
Default is &quot;none&quot;, can be set to &quot;foreach&quot;. Install the &quot;foreach&quot; package
for hpc support.</p>
</td></tr>
<tr><td><code id="bfast_+3A_level">level</code></td>
<td>
<p>numeric; threshold value for the <a href="strucchangeRcpp.html#topic+sctest.efp">sctest.efp</a>
test; if a length 2 vector is passed, the first value is used for the trend,
the second for the seasonality</p>
</td></tr>
<tr><td><code id="bfast_+3A_decomp">decomp</code></td>
<td>
<p>&quot;stlplus&quot; or &quot;stl&quot;: the function to use for decomposition.
<code>stl</code> can handle sparse time series (1 &lt; frequency &lt; 4), <code>stlplus</code>
can handle <code>NA</code> values in the time series.</p>
</td></tr>
<tr><td><code id="bfast_+3A_type">type</code></td>
<td>
<p>character, indicating the type argument to
<a href="strucchangeRcpp.html#topic+efp">efp</a></p>
</td></tr>
<tr><td><code id="bfast_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="stlplus.html#topic+stlplus">stlplus::stlplus()</a></code>, if
its usage has been enabled, otherwise ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm decomposes the input time series <code>Yt</code> into three components:
trend, seasonality and remainder, using the function defined by the <code>decomp</code>
parameter. Then each component is checked for at least one significant
break using <code><a href="strucchangeRcpp.html#topic+efp">strucchangeRcpp::efp()</a></code>, and if there is one, <code><a href="strucchangeRcpp.html#topic+breakpoints">strucchangeRcpp::breakpoints()</a></code>
is run on the component. The result allows differentiating between breaks in
trend and seasonality.
</p>


<h3>Value</h3>

<p>An object of the class &quot;bfast&quot; is a list with the following
elements: </p>
<table>
<tr><td><code>Yt</code></td>
<td>
<p> equals the Yt used as input.</p>
</td></tr> <tr><td><code>output</code></td>
<td>
<p> is a list
with the following elements (for each iteration): </p>

<table>
<tr>
 <td style="text-align: left;"> <code>Tt</code>
</td><td style="text-align: left;"> the fitted trend component</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>St</code> </td><td style="text-align: left;"> the fitted seasonal
component</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Nt</code> </td><td style="text-align: left;"> the noise or remainder component</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Vt</code>
</td><td style="text-align: left;"> equals the deseasonalized data <code>Yt - St</code> for each iteration</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>bp.Vt</code> </td><td style="text-align: left;"> output of the <code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code>
function for the trend model. Note that the output breakpoints are index
numbers of <code>na.omit(as.numeric(Vt))</code>.</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>ci.Vt</code> </td><td style="text-align: left;"> output of the
<code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code> confint function for the trend
model</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Wt</code> </td><td style="text-align: left;"> equals the detrended data <code>Yt - Tt</code> for each
iteration</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>bp.Wt</code> </td><td style="text-align: left;"> output of the
<code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code> function for the seasonal model.
Note that the output breakpoints are index numbers of <code>na.omit(as.numeric(Wt))</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ci.Wt</code> </td><td style="text-align: left;"> output of the <code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code>
confint function for the seasonal model </td>
</tr>

</table>
</td></tr> <tr><td><code>nobp</code></td>
<td>
<p> is a list with the
following elements: </p>

<table>
<tr>
 <td style="text-align: left;"> <code>nobp.Vt</code> </td><td style="text-align: left;"> logical, TRUE if there
are no breakpoints detected</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>nobp.Wt</code> </td><td style="text-align: left;"> logical, TRUE if there
are no breakpoints detected </td>
</tr>

</table>
</td></tr> <tr><td><code>Magnitude</code></td>
<td>
<p> magnitude of the biggest
change detected in the trend component</p>
</td></tr> <tr><td><code>Time</code></td>
<td>
<p> timing of the biggest
change detected in the trend component</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jan Verbesselt
</p>


<h3>References</h3>

<p>Verbesselt J, Hyndman R, Newnham G, Culvenor D (2010).
&ldquo;Detecting trend and seasonal changes in satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>114</b>(1), 106&ndash;115.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2009.08.014">10.1016/j.rse.2009.08.014</a>, <a href="https://doi.org/10.1016/j.rse.2009.08.014">https://doi.org/10.1016/j.rse.2009.08.014</a>.
</p>
<p>Verbesselt J, Hyndman R, Zeileis A, Culvenor D (2010).
&ldquo;Phenological change detection while accounting for abrupt and gradual trends in satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>114</b>(12), 2970&ndash;2980.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2010.08.003">10.1016/j.rse.2010.08.003</a>, <a href="https://doi.org/10.1016/j.rse.2010.08.003">https://doi.org/10.1016/j.rse.2010.08.003</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bfast">plot.bfast</a></code> for plotting of bfast() results.
<br /> <code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code> for more examples and background
information about estimation of breakpoints in time series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulated Data
plot(simts) # stl object containing simulated NDVI time series
datats &lt;- ts(rowSums(simts$time.series))
# sum of all the components (season,abrupt,remainder)
tsp(datats) &lt;- tsp(simts$time.series) # assign correct time series attributes
plot(datats)

fit &lt;- bfast(datats, h = 0.15, season = "dummy", max.iter = 1)
plot(fit, sim = simts)
fit
# prints out whether breakpoints are detected
# in the seasonal and trend component
 
## Real data
## The data should be a regular ts() object without NA's
## See Fig. 8 b in reference
plot(harvest, ylab = "NDVI")
# MODIS 16-day cleaned and interpolated NDVI time series

(rdist &lt;- 10/length(harvest))
# ratio of distance between breaks (time steps) and length of the time series

fit &lt;- bfast(harvest, h = rdist, season = "harmonic", max.iter = 1, breaks = 2)
plot(fit)
## plot anova and slope of the trend identified trend segments
plot(fit, ANOVA = TRUE)
## plot the trend component and identify the break with
## the largest magnitude of change
plot(fit, type = "trend", largest = TRUE)

## plot all the different available plots
plot(fit, type = "all")

## output
niter &lt;- length(fit$output) # nr of iterations
out &lt;- fit$output[[niter]]
# output of results of the final fitted seasonal and trend models and
## #nr of breakpoints in both.

## running bfast on yearly data
t &lt;- ts(as.numeric(harvest), frequency = 1, start = 2006)
fit &lt;- bfast(t, h = 0.23, season = "none", max.iter = 1)
plot(fit)
fit

## handling missing values with stlplus
(NDVIa &lt;- as.ts(zoo::zoo(som$NDVI.a, som$Time)))
fit &lt;- bfast(NDVIa, season = "harmonic", max.iter = 1, decomp = "stlplus")
plot(fit)
fit
</code></pre>

<hr>
<h2 id='bfast-deprecated'>Deprecated functions in package <span class="pkg">bfast</span>.</h2><span id='topic+bfast-deprecated'></span><span id='topic+create16dayts'></span>

<h3>Description</h3>

<p>The functions listed below are deprecated and will be removed in the future.
Please use the alternative functions as listed below.
Help pages for deprecated functions are available via <code>help("&lt;function&gt;-deprecated")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create16dayts(data, dates)
</code></pre>


<h3><code>create16dayts</code></h3>

<p>Use <code><a href="#topic+bfastts">bfastts</a></code> with the parameter <code>type="16-day"</code>.
</p>

<hr>
<h2 id='bfast-package'>Breaks For Additive Season and Trend (BFAST)</h2><span id='topic+bfast-package'></span>

<h3>Description</h3>

<p>BFAST integrates the decomposition of time series into trend, seasonal, and
remainder components with methods for detecting and characterizing abrupt
changes within the trend and seasonal components. BFAST can be used to
analyze different types of satellite image time series and can be applied to
other disciplines dealing with seasonal or non-seasonal time series,such as
hydrology, climatology, and econometrics. The algorithm can be extended to
label detected changes with information on the parameters of the fitted
piecewise linear models.
</p>
<p>Additionally monitoring disturbances in BFAST-type models at the end of time
series (i.e., in near real-time) is available: Based on a model for stable
historical behaviour abnormal changes within newly acquired data can be
detected. Different models are available for modeling the stable historical
behavior. A season-trend model (with harmonic seasonal pattern) is used as a
default in the regresssion modelling.
</p>


<h3>Details</h3>

<p>The package contains:
</p>

<ul>
<li> <p><code><a href="#topic+bfast">bfast()</a></code>: Main function for iterative decomposition and break detection as described in
Verbesselt et al (2010a,b).
</p>
</li>
<li> <p><code><a href="#topic+bfastlite">bfastlite()</a></code>: lightweight and fast detection of all breaks in a time series
using a single iteration with all components at once.
</p>
</li>
<li> <p><code><a href="#topic+bfastmonitor">bfastmonitor()</a></code>:
Monitoring approach for detecting disturbances in near real-time (see
Verbesselt et al. 2012).
</p>
</li>
<li> <p><code><a href="#topic+bfastpp">bfastpp()</a></code>: Data pre-processing for BFAST-type modeling.
</p>
</li>
<li><p> Functions for plotting and printing, see <code><a href="#topic+bfast">bfast()</a></code>.
</p>
</li>
<li> <p><a href="#topic+simts">simts</a>: Artificial example data set.
</p>
</li>
<li> <p><a href="#topic+harvest">harvest</a>: NDVI time series of a P. radiata plantation
that is harvested.
</p>
</li>
<li> <p><a href="#topic+som">som</a>: NDVI time series of
locations in the south of Somalia to illustrate the near real-time
disturbance approach
</p>
</li></ul>



<h3>Package options</h3>

<p>bfast uses the following options to modify the
default behaviour:
</p>

<ul>
<li> <p><code>bfast.prefer_matrix_methods</code>:
logical value defining whether methods should try to
use the design matrix instead of the formula and a dataframe whenever
possible. This can avoid expensive repeated calls of <code>model.matrix</code> and
<code>model.frame</code> and make model fitting faster using <code>lm.fit</code>.
</p>
</li>
<li> <p><code>bfast.use_bfastts_modifications</code>:
logical value defining whether a faster version of <code><a href="#topic+bfastts">bfastts()</a></code> should be used.
</p>
</li>
<li> <p><code>strucchange.use_armadillo</code>:
logical value defining whether to use C++ optimised code paths in strucchangeRcpp.
</p>
</li></ul>

<p>By default, all three are enabled.
See <code><a href="#topic+set_fallback_options">set_fallback_options()</a></code> for a convenient interface for setting them all off
for debugging purposes.
</p>


<h3>References</h3>

<p>Verbesselt J, Zeileis A, Herold M (2012).
&ldquo;Near real-time disturbance detection using satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>123</b>, 98&ndash;108.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2012.02.022">10.1016/j.rse.2012.02.022</a>, <a href="https://doi.org/10.1016/j.rse.2012.02.022">https://doi.org/10.1016/j.rse.2012.02.022</a>.
</p>
<p>Verbesselt J, Hyndman R, Newnham G, Culvenor D (2010).
&ldquo;Detecting trend and seasonal changes in satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>114</b>(1), 106&ndash;115.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2009.08.014">10.1016/j.rse.2009.08.014</a>, <a href="https://doi.org/10.1016/j.rse.2009.08.014">https://doi.org/10.1016/j.rse.2009.08.014</a>.
</p>
<p>Verbesselt J, Hyndman R, Zeileis A, Culvenor D (2010).
&ldquo;Phenological change detection while accounting for abrupt and gradual trends in satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>114</b>(12), 2970&ndash;2980.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2010.08.003">10.1016/j.rse.2010.08.003</a>, <a href="https://doi.org/10.1016/j.rse.2010.08.003">https://doi.org/10.1016/j.rse.2010.08.003</a>.
</p>

<hr>
<h2 id='bfast01'>Checking for one major break in the time series</h2><span id='topic+bfast01'></span>

<h3>Description</h3>

<p>A function to select a suitable model for the data by choosing either a
model with 0 or with 1 breakpoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfast01(
  data,
  formula = NULL,
  test = "OLS-MOSUM",
  level = 0.05,
  aggregate = all,
  trim = NULL,
  bandwidth = 0.15,
  functional = "max",
  order = 3,
  lag = NULL,
  slag = NULL,
  na.action = na.omit,
  reg = c("lm", "rlm"),
  stl = "none",
  sbins = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bfast01_+3A_data">data</code></td>
<td>
<p>A time series of class <code><a href="stats.html#topic+ts">ts</a></code>, or another
object that can be coerced to such. The time series is processed by
<code><a href="#topic+bfastpp">bfastpp</a></code>. A time series of class <code><a href="stats.html#topic+ts">ts</a></code>
can be prepared by a convenience function <code><a href="#topic+bfastts">bfastts</a></code> in
case of daily, 10 or 16-daily time series.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_formula">formula</code></td>
<td>
<p>formula for the regression model.  The default is
intelligently guessed based on the arguments order/lag/slag i.e.
<code>response ~ trend + harmon</code>, i.e., a linear trend and a harmonic season
component. Other specifications are possible using all terms set up by
<code><a href="#topic+bfastpp">bfastpp</a></code>, i.e., <code>season</code> (seasonal pattern with
dummy variables), <code>lag</code> (autoregressive terms), <code>slag</code> (seasonal
autoregressiv terms), or <code>xreg</code> (further covariates). See
<code><a href="#topic+bfastpp">bfastpp</a></code> for details.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_test">test</code></td>
<td>
<p>character specifying the type of test(s) performed. Can be one
or more of BIC, supLM, supF, OLS-MOSUM, ..., or any other test supported by
<code><a href="strucchangeRcpp.html#topic+sctest.formula">sctest.formula</a></code></p>
</td></tr>
<tr><td><code id="bfast01_+3A_level">level</code></td>
<td>
<p>numeric. Significance for the
<code><a href="strucchangeRcpp.html#topic+sctest.formula">sctest.formula</a></code> performed.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_aggregate">aggregate</code></td>
<td>
<p>function that aggregates a logical vector to a single
value. This is used for aggregating the individual test decisions from
<code>test</code> to a single one.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_trim">trim</code></td>
<td>
<p>numeric. The mimimal segment size passed to the <code>from</code>
argument of the <code><a href="strucchangeRcpp.html#topic+Fstats">Fstats</a></code> function.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_bandwidth">bandwidth</code></td>
<td>
<p>numeric scalar from interval (0,1), functional. The
<code>bandwidth</code> argument is passed to the <code>h</code> argument of the
<code><a href="strucchangeRcpp.html#topic+sctest.formula">sctest.formula</a></code>.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_functional">functional</code></td>
<td>
<p>arguments passed on to
<code><a href="strucchangeRcpp.html#topic+sctest.formula">sctest.formula</a></code></p>
</td></tr>
<tr><td><code id="bfast01_+3A_order">order</code></td>
<td>
<p>numeric. Order of the harmonic term, defaulting to <code>3</code>.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_lag">lag</code></td>
<td>
<p>numeric. Order of the autoregressive term, by default omitted.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_slag">slag</code></td>
<td>
<p>numeric. Order of the seasonal autoregressive term, by default
omitted.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_na.action">na.action</code></td>
<td>
<p>arguments passed on to <code><a href="#topic+bfastpp">bfastpp</a></code></p>
</td></tr>
<tr><td><code id="bfast01_+3A_reg">reg</code></td>
<td>
<p>whether to use OLS regression <code><a href="stats.html#topic+lm">lm()</a></code> or
robust regression <code><a href="MASS.html#topic+rlm">MASS::rlm()</a></code>.</p>
</td></tr>
<tr><td><code id="bfast01_+3A_stl">stl</code></td>
<td>
<p>argument passed on to <code><a href="#topic+bfastpp">bfastpp</a></code></p>
</td></tr>
<tr><td><code id="bfast01_+3A_sbins">sbins</code></td>
<td>
<p>argument passed on to <code><a href="#topic+bfastpp">bfastpp</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bfast01</code> tries to select a suitable model for the data by choosing
either a model with 0 or with 1 breakpoint. It proceeds in the following
steps:
</p>

<ol>
<li><p> The data is preprocessed with bfastpp using the arguments
<code>order</code>/<code>lag</code>/<code>slag</code>/<code>na.action</code>/<code>stl</code>/<code>sbins</code>.
</p>
</li>
<li><p> A linear model with the given formula is fitted. By default a suitable
formula is guessed based on the preprocessing parameters.
</p>
</li>
<li><p> The model with 1 breakpoint is estimated as well where the breakpoint is
chosen to minimize the segmented residual sum of squares.
</p>
</li>
<li><p> A sequence of tests for the null hypothesis of zero breaks is performed. Each
test results in a decision for FALSE (no breaks) or TRUE (structural
break(s)). The test decisions are then aggregated to a single decision (by
default using all() but any() or some other function could also be used).
</p>
</li></ol>

<p>Available methods for the object returned include standard methods for
linear models (coef, fitted, residuals, predict, AIC, BIC, logLik, deviance,
nobs, model.matrix, model.frame), standard methods for breakpoints
(breakpoints, breakdates), coercion to a zoo series with the decomposed
components (as.zoo), and a plot method which plots such a zoo series along
with the confidence interval (if the 1-break model is visualized). All
methods take a 'breaks' argument which can either be 0 or 1. By default the
value chosen based on the 'test' decisions is used.
</p>
<p>Note that the different tests supported have power for different types of
alternatives. Some tests (such as supLM/supF or BIC) assess changes in all
coefficients of the model while residual-based tests (e.g., OLS-CUSUM or
OLS-MOSUM) assess changes in the conditional mean. See Zeileis (2005) for a
unifying view.
</p>


<h3>Value</h3>

<p><code>bfast01</code> returns a list of class <code>"bfast01"</code> with the
following elements: </p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the original function call.</p>
</td></tr> <tr><td><code>data</code></td>
<td>
<p>the
data preprocessed by <code>"bfastpp"</code>.</p>
</td></tr> <tr><td><code>formula</code></td>
<td>
<p>the model formulae.</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>the number of breaks chosen based on the <code>test</code> decision
(either 0 or 1).</p>
</td></tr> <tr><td><code>test</code></td>
<td>
<p>the individual test decisions.</p>
</td></tr>
<tr><td><code>breakpoints</code></td>
<td>
<p>the optimal breakpoint for the model with 1 break.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>A list of two 'lm' objects with no and one breaks,
respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Achim Zeileis, Jan Verbesselt
</p>


<h3>References</h3>

<p>De Jong R, Verbesselt J, Zeileis A, Schaepman ME (2013).
&ldquo;Shifts in Global Vegetation Activity Trends.&rdquo;
<em>Remote Sensing</em>, <b>5</b>(3), 1117&ndash;1133.
ISSN 2072-4292, doi: <a href="https://doi.org/10.3390/rs5031117">10.3390/rs5031117</a>, <a href="https://doi.org/10.3390/rs5031117">https://doi.org/10.3390/rs5031117</a>.
</p>
<p>Zeileis A (2005).
&ldquo;A Unified Approach to Structural Change Tests Based on ML Scores, F Statistics, and OLS Residuals.&rdquo;
<em>Econometric Reviews</em>, <b>24</b>(4), 445&ndash;466.
ISSN 0747-4938, doi: <a href="https://doi.org/10.1080/07474930500406053">10.1080/07474930500406053</a>, <a href="https://doi.org/10.1080/07474930500406053">https://doi.org/10.1080/07474930500406053</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bfastmonitor">bfastmonitor</a></code>,
<code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(zoo)
## define a regular time series
ndvi &lt;- as.ts(zoo(som$NDVI.a, som$Time))

## fit variations
bf1 &lt;- bfast01(ndvi)
bf2 &lt;- bfast01(ndvi, test = c("BIC", "OLS-MOSUM", "supLM"), aggregate = any)
bf3 &lt;- bfast01(ndvi, test = c("OLS-MOSUM", "supLM"), aggregate = any, bandwidth = 0.11) 

## inspect test decisions
bf1$test
bf1$breaks
bf2$test
bf2$breaks
bf3$test
bf3$breaks

## look at coefficients
coef(bf1)
coef(bf1, breaks = 0)
coef(bf1, breaks = 1) 

## zoo series with all components
plot(as.zoo(ndvi))
plot(as.zoo(bf1, breaks = 1))
plot(as.zoo(bf2))
plot(as.zoo(bf3))

## leveraged by plot method
plot(bf1, regular = TRUE)
plot(bf2)
plot(bf2, plot.type = "multiple",
     which = c("response", "trend", "season"), screens = c(1, 1, 2))
plot(bf3)


</code></pre>

<hr>
<h2 id='bfast01classify'>Change type analysis of the bfast01 function</h2><span id='topic+bfast01classify'></span>

<h3>Description</h3>

<p>A function to determine the change type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfast01classify(
  object,
  alpha = 0.05,
  pct_stable = NULL,
  typology = c("standard", "drylands")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bfast01classify_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+bfast01">bfast01</a></code> object, i.e. the output of the
<code><a href="#topic+bfast01">bfast01</a></code> function.</p>
</td></tr>
<tr><td><code id="bfast01classify_+3A_alpha">alpha</code></td>
<td>
<p>threshold for significance tests, default 0.05</p>
</td></tr>
<tr><td><code id="bfast01classify_+3A_pct_stable">pct_stable</code></td>
<td>
<p>threshold for segment stability, unit: percent change per
unit time (0-100), default NULL</p>
</td></tr>
<tr><td><code id="bfast01classify_+3A_typology">typology</code></td>
<td>
<p>classification legend to use: <code>standard</code> refers to the
original legend as used in De Jong et al. (2013),
<code>drylands</code> refers to the legend used in Bernardino et al. (2020).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bfast01classify</code>
</p>


<h3>Value</h3>

<p><code>bfast01classify</code> returns a data.frame with the following
elements: </p>
<table>
<tr><td><code>flag_type</code></td>
<td>
<p>Type of shift: (1) monotonic increase, (2)
monotonic decrease, (3) monotonic increase (with positive break), (4)
monotonic decrease (with negative break), (5) interruption: increase with
negative break, (6) interruption: decrease with positive break, (7)
reversal: increase to decrease, (8) reversal: decrease to increase </p>
</td></tr>
<tr><td><code>flag_significance</code></td>
<td>
<p>SIGNIFICANCE FLAG: (0) both segments significant
(or no break and significant), (1) only first segment significant, (2) only
2nd segment significant, (3) both segments insignificant (or no break and
not significant) </p>
</td></tr> <tr><td><code>flag_pct_stable</code></td>
<td>
<p>STABILITY FLAG: (0) change in both
segments is substantial (or no break and substantial), (1) only first
segment substantial, (2) only 2nd segment substantial (3) both segments are
stable (or no break and stable) </p>
</td></tr></table>
<p> and also significance and percentage of
both segments before and after the potentially detected break: &quot;p_segment1&quot;,
&quot;p_segment2&quot;, &quot;pct_segment1&quot;, &quot;pct_segment2&quot;.
</p>


<h3>Author(s)</h3>

<p>Rogier de Jong, Jan Verbesselt
</p>


<h3>References</h3>

<p>Bernardino PN, De Keersmaecker W, Fensholt R, Verbesselt J, Somers B, Horion S (2020).
&ldquo;Global-scale characterization of turning points in arid and semi-arid ecosystem functioning.&rdquo;
<em>Global Ecology and Biogeography</em>, <b>29</b>(7), 1230&ndash;1245.
doi: <a href="https://doi.org/10.1111/geb.13099">10.1111/geb.13099</a>, <a href="https://doi.org/10.1111/geb.13099">https://doi.org/10.1111/geb.13099</a>.<br /><br /> De Jong R, Verbesselt J, Zeileis A, Schaepman ME (2013).
&ldquo;Shifts in Global Vegetation Activity Trends.&rdquo;
<em>Remote Sensing</em>, <b>5</b>(3), 1117&ndash;1133.
ISSN 2072-4292, doi: <a href="https://doi.org/10.3390/rs5031117">10.3390/rs5031117</a>, <a href="https://doi.org/10.3390/rs5031117">https://doi.org/10.3390/rs5031117</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bfast01">bfast01</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(zoo)
## define a regular time series
ndvi &lt;- as.ts(zoo(som$NDVI.a, som$Time))
## fit variations
bf1 &lt;- bfast01(ndvi)
bfast01classify(bf1, pct_stable = 0.25)

</code></pre>

<hr>
<h2 id='bfastlite'>Detect multiple breaks in a time series</h2><span id='topic+bfastlite'></span><span id='topic+bfast0n'></span>

<h3>Description</h3>

<p>A combination of <code><a href="#topic+bfastpp">bfastpp</a></code> and <code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code>
to do light-weight detection of multiple breaks in a time series
while also being able to deal with NA values by excluding them
via <code>bfastpp</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfastlite(
  data,
  formula = response ~ trend + harmon,
  order = 3,
  breaks = "LWZ",
  lag = NULL,
  slag = NULL,
  na.action = na.omit,
  stl = c("none", "trend", "seasonal", "both"),
  decomp = c("stl", "stlplus"),
  sbins = 1,
  ...
)

bfast0n(
  data,
  formula = response ~ trend + harmon,
  order = 3,
  breaks = "LWZ",
  lag = NULL,
  slag = NULL,
  na.action = na.omit,
  stl = c("none", "trend", "seasonal", "both"),
  decomp = c("stl", "stlplus"),
  sbins = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bfastlite_+3A_data">data</code></td>
<td>
<p>A time series of class <code><a href="stats.html#topic+ts">ts</a></code>, or another
object that can be coerced to such. For seasonal components, a frequency
greater than 1 is required.</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model in which breakpoints
will be estimated.</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_order">order</code></td>
<td>
<p>numeric. Order of the harmonic term, defaulting to <code>3</code>.</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_breaks">breaks</code></td>
<td>
<p>either a positive integer specifying the maximal number of breaks to be calculated,
or a string specifying the information criterion to use to automatically determine
the optimal number of breaks (see also <code><a href="stats.html#topic+logLik">logLik</a></code>.
<code>"all"</code> means the maximal number allowed by <code>h</code> is used.
<code>NULL</code> is treated as the default of the <code>breakpoints</code> function (i.e. BIC).</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_lag">lag</code></td>
<td>
<p>numeric. Orders of the autoregressive term, by default omitted.</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_slag">slag</code></td>
<td>
<p>numeric. Orders of the seasonal autoregressive term, by default
omitted.</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_na.action">na.action</code></td>
<td>
<p>function for handling <code>NA</code>s in the data (after all
other preprocessing).</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_stl">stl</code></td>
<td>
<p>character. Prior to all other preprocessing, STL (season-trend
decomposition via LOESS smoothing) can be employed for trend-adjustment
and/or season-adjustment.  The <code>"trend"</code> or <code>"seasonal"</code> component
or both from <code><a href="stats.html#topic+stl">stl</a></code> are removed from each column in
<code>data</code>. By default (<code>"none"</code>), no STL adjustment is used.</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_decomp">decomp</code></td>
<td>
<p>&quot;stlplus&quot; or &quot;stl&quot;: use the NA-tolerant decomposition package
or the reference package (which can make use of time series with 2-3
observations per year)</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_sbins">sbins</code></td>
<td>
<p>numeric. Controls the number of seasonal dummies. If integer &gt; 1,
sets the number of seasonal dummies to use per year.
If &lt;= 1, treated as a multiplier to the number of observations per year, i.e.
<code>ndummies = nobs/year * sbins</code>.</p>
</td></tr>
<tr><td><code id="bfastlite_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>bfastlite</code>, with two elements:
</p>
<table>
<tr><td><code>breakpoints</code></td>
<td>
<p>output from <code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code>,
containing information about the estimated breakpoints.</p>
</td></tr>
<tr><td><code>data_pp</code></td>
<td>
<p>preprocessed data as output by <code><a href="#topic+bfastpp">bfastpp</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dainius Masiliunas, Jan Verbesselt
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(simts) # stl object containing simulated NDVI time series
datats &lt;- ts(rowSums(simts$time.series))
# sum of all the components (season,abrupt,remainder)
tsp(datats) &lt;- tsp(simts$time.series) # assign correct time series attributes
plot(datats)

# Detect breaks
bp = bfastlite(datats)

# Default method of estimating breakpoints
bp[["breakpoints"]][["breakpoints"]]

# Plot
plot(bp)

# Custom method of estimating number of breaks (request 2 breaks)
strucchangeRcpp::breakpoints(bp[["breakpoints"]], breaks = 2)

# Plot including magnitude based on RMSD for the cos1 component of harmonics
plot(bp, magstat = "RMSD", magcomp = "harmoncos1", breaks = 2)
</code></pre>

<hr>
<h2 id='bfastmonitor'>Near Real-Time Disturbance Detection Based on BFAST-Type Models</h2><span id='topic+bfastmonitor'></span>

<h3>Description</h3>

<p>Monitoring disturbances in time series models (with trend/season/regressor
terms) at the end of time series (i.e., in near real-time). Based on a model
for stable historical behaviour abnormal changes within newly acquired data
can be detected. Different models are available for modeling the stable
historical behavior. A season-trend model (with harmonic seasonal pattern)
is used as a default in the regresssion modelling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfastmonitor(
  data,
  start,
  formula = response ~ trend + harmon,
  order = 3,
  lag = NULL,
  slag = NULL,
  history = c("ROC", "BP", "all"),
  type = "OLS-MOSUM",
  h = 0.25,
  end = 10,
  level = c(0.05, 0.05),
  hpc = "none",
  verbose = FALSE,
  plot = FALSE,
  sbins = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bfastmonitor_+3A_data">data</code></td>
<td>
<p>A time series of class <code><a href="stats.html#topic+ts">ts</a></code>, or another
object that can be coerced to such. For seasonal components, a frequency
greater than 1 is required.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_start">start</code></td>
<td>
<p>numeric. The starting date of the monitoring period. Can either
be given as a float (e.g., <code>2000.5</code>) or a vector giving period/cycle
(e.g., <code>c(2000, 7)</code>).</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_formula">formula</code></td>
<td>
<p>formula for the regression model. The default is
<code>response ~ trend + harmon</code>, i.e., a linear trend and a harmonic season
component. Other specifications are possible using all terms set up by
<code><a href="#topic+bfastpp">bfastpp</a></code>, i.e., <code>season</code> (seasonal pattern with
dummy variables), <code>lag</code> (autoregressive terms), <code>slag</code> (seasonal
autoregressive terms), or <code>xreg</code> (further covariates). See
<code><a href="#topic+bfastpp">bfastpp</a></code> for details.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_order">order</code></td>
<td>
<p>numeric. Order of the harmonic term, defaulting to <code>3</code>.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_lag">lag</code></td>
<td>
<p>numeric. Order of the autoregressive term, by default omitted.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_slag">slag</code></td>
<td>
<p>numeric. Order of the seasonal autoregressive term, by default
omitted.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_history">history</code></td>
<td>
<p>specification of the start of the stable history period. Can
either be a character, numeric, or a function. If character, then selection
is possible between reverse-ordered CUSUM (<code>"ROC"</code>, default), Bai and
Perron breakpoint estimation (<code>"BP"</code>), or all available observations
(<code>"all"</code>). If numeric, the start date can be specified in the same form
as <code>start</code>. If a function is supplied it is called as
<code>history(formula, data)</code> to compute a numeric start date.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_type">type</code></td>
<td>
<p>character specifying the type of monitoring process. By default,
a MOSUM process based on OLS residuals is employed. See
<code><a href="strucchangeRcpp.html#topic+mefp">mefp</a></code> for alternatives.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_h">h</code></td>
<td>
<p>numeric scalar from interval (0,1) specifying the bandwidth
relative to the sample size in MOSUM/ME monitoring processes.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_end">end</code></td>
<td>
<p>numeric. Maximum time (relative to the history period) that will
be monitored (in MOSUM/ME processes). Default is 10 times the history
period.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_level">level</code></td>
<td>
<p>numeric vector. Significance levels of the monitoring and ROC (if
selected) procedure, i.e., probability of type I error.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_hpc">hpc</code></td>
<td>
<p>character specifying the high performance computing support.
Default is <code>"none"</code>, can be set to <code>"foreach"</code>. See
<code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code> for more details.</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_verbose">verbose</code></td>
<td>
<p>logical. Should information about the monitoring be printed
during computation?</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_plot">plot</code></td>
<td>
<p>logical. Should the result be plotted?</p>
</td></tr>
<tr><td><code id="bfastmonitor_+3A_sbins">sbins</code></td>
<td>
<p>numeric. Number of seasonal dummies, passed to
<code><a href="#topic+bfastpp">bfastpp</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bfastmonitor</code> provides monitoring of disturbances (or structural
changes) in near real-time based on a wide class of time series regression
models with optional season/trend/autoregressive/covariate terms. See
Verbesselt at al. (2011) for details.
</p>
<p>Based on a given time series (typically, but not necessarily, with frequency
greater than 1), the data is first preprocessed for regression modeling.
Trend/season/autoregressive/covariate terms are (optionally) computed using
<code><a href="#topic+bfastpp">bfastpp</a></code>. Second, the data is split into a history and
monitoring period (starting with <code>start</code>). Third, a subset of the
history period is determined which is considered to be stable (see also
below).  Fourth, a regression model is fitted to the preprocessed data in
the stable history period.  Fifth, a monitoring procedure is used to
determine whether the observations in the monitoring period conform with
this stable regression model or whether a change is detected.
</p>
<p>The regression model can be specified by the user. The default is to use a
linear trend and a harmonic season: <code>response ~ trend + harmon</code>.
However, all other terms set up by <code>bfastpp</code> can also be omitted/added,
e.g., <code>response ~ 1</code> (just a constant), <code>response ~ season</code>
(seasonal dummies for each period), etc. Further terms precomputed by
<code>bfastpp</code> can be <code>lag</code> (autoregressive terms of specified order),
<code>slag</code> (seasonal autoregressive terms of specified order), <code>xreg</code>
(covariates, if <code>data</code> has more than one column).
</p>
<p>For determining the size of the stable history period, various approaches
are available.  First, the user can set a start date based on subject-matter
knowledge. Second, data-driven methods can be employed. By default, this is
a reverse-ordered CUSUM test (ROC). Alternatively, breakpoints can be
estimated (Bai and Perron method) and only the data after the last
breakpoint are employed for the stable history. Finally, the user can also
supply a function for his/her own data-driven method.
</p>


<h3>Value</h3>

<p><code>bfastmonitor</code> returns an object of class
<code>"bfastmonitor"</code>, i.e., a list with components as follows.
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>original <code>"ts"</code> time series,</p>
</td></tr> <tr><td><code>tspp</code></td>
<td>
<p>preprocessed
<code>"data.frame"</code> for regression modeling,</p>
</td></tr> <tr><td><code>model</code></td>
<td>
<p>fitted
<code>"lm"</code> model for the stable history period,</p>
</td></tr> <tr><td><code>mefp</code></td>
<td>
<p>fitted
<code>"mefp"</code> process for the monitoring period,</p>
</td></tr> <tr><td><code>history</code></td>
<td>
<p>start and
end time of history period,</p>
</td></tr> <tr><td><code>monitor</code></td>
<td>
<p>start and end time of monitoring
period,</p>
</td></tr> <tr><td><code>breakpoint</code></td>
<td>
<p>breakpoint detected (if any).</p>
</td></tr>
<tr><td><code>magnitude</code></td>
<td>
<p>median of the difference between the data and the model
prediction in the monitoring period.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Achim Zeileis, Jan Verbesselt
</p>


<h3>References</h3>

<p>Verbesselt J, Zeileis A, Herold M (2012).
&ldquo;Near real-time disturbance detection using satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>123</b>, 98&ndash;108.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2012.02.022">10.1016/j.rse.2012.02.022</a>, <a href="https://doi.org/10.1016/j.rse.2012.02.022">https://doi.org/10.1016/j.rse.2012.02.022</a>.
</p>


<h3>See Also</h3>

<p><code><a href="strucchangeRcpp.html#topic+monitor">monitor</a></code>,
<code><a href="strucchangeRcpp.html#topic+mefp">mefp</a></code>, <code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>NDVIa &lt;- as.ts(zoo::zoo(som$NDVI.a, som$Time))
plot(NDVIa)
## apply the bfast monitor function on the data
## start of the monitoring period is c(2010, 13)
## and the ROC method is used as a method to automatically identify a stable history
mona &lt;- bfastmonitor(NDVIa, start = c(2010, 13))
mona
plot(mona)
## fitted season-trend model in history period
summary(mona$model)
## OLS-based MOSUM monitoring process
plot(mona$mefp, functional = NULL)
## the pattern in the running mean of residuals
## this illustrates the empirical fluctuation process
## and the significance of the detected break.

NDVIb &lt;- as.ts(zoo(som$NDVI.b, som$Time))
plot(NDVIb)
monb &lt;- bfastmonitor(NDVIb, start = c(2010, 13))
monb
plot(monb)
summary(monb$model)
plot(monb$mefp, functional = NULL)

## set the stable history period manually and use a 4th order harmonic model
bfastmonitor(NDVIb, start = c(2010, 13),
  history = c(2008, 7), order = 4, plot = TRUE)

## just use a 6th order harmonic model without trend
mon &lt;- bfastmonitor(NDVIb, formula = response ~ harmon,
    start = c(2010, 13), order = 6, plot = TRUE)
summary(mon$model)
AIC(mon$model)

## use a custom number of seasonal dummies (11/yr) instead of harmonics
mon &lt;- bfastmonitor(NDVIb, formula = response ~ season,
    start = c(2010, 13), sbins = 11, plot = TRUE)
summary(mon$model)
AIC(mon$model)

## Example for processing raster bricks (satellite image time series of 16-day NDVI images)
f &lt;- system.file("extdata/modisraster.grd", package = "bfast")
library("raster")
modisbrick &lt;- raster::brick(f)
data &lt;- as.vector(modisbrick[1])
ndvi &lt;- bfastts(data, dates, type = c("16-day"))
plot(ndvi/10000)

## derive median NDVI of a NDVI raster brick
medianNDVI &lt;- raster::calc(modisbrick, fun = function(x) median(x, na.rm = TRUE))
raster::plot(medianNDVI)

## helper function to be used with the calc() function
xbfastmonitor &lt;- function(x, timestamps = dates) {
	ndvi &lt;- bfastts(x, timestamps, type = c("16-day"))
	ndvi &lt;- window(ndvi, end = c(2011, 14))/10000
	## delete end of the time to obtain a dataset similar to RSE paper (Verbesselt et al.,2012)
	bfm &lt;- bfastmonitor(data = ndvi, start = c(2010, 12), history = c("ROC"))
	return(c(breakpoint = bfm$breakpoint, magnitude = bfm$magnitude))
}

## apply on one pixel for testing
ndvi &lt;- bfastts(as.numeric(modisbrick[1])/10000, dates, type = c("16-day"))
plot(ndvi)

bfm &lt;- bfastmonitor(data = ndvi, start = c(2010, 12), history = c("ROC"))
bfm$magnitude
plot(bfm)
xbfastmonitor(modisbrick[1], dates) ## helper function applied on one pixel

## apply the bfastmonitor function onto a raster brick
timeofbreak &lt;- raster::calc(modisbrick, fun=xbfastmonitor)

raster::plot(timeofbreak) ## time of break and magnitude of change
raster::plot(timeofbreak,2) ## magnitude of change
</code></pre>

<hr>
<h2 id='bfastpp'>Time Series Preprocessing for BFAST-Type Models</h2><span id='topic+bfastpp'></span>

<h3>Description</h3>

<p>Time series preprocessing for subsequent regression modeling.  Based on a
(seasonal) time series, a data frame with the response, seasonal terms, a
trend term, (seasonal) autoregressive terms, and covariates is computed.
This can subsequently be employed in regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfastpp(
  data,
  order = 3,
  lag = NULL,
  slag = NULL,
  na.action = na.omit,
  stl = c("none", "trend", "seasonal", "both"),
  decomp = c("stl", "stlplus"),
  sbins = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bfastpp_+3A_data">data</code></td>
<td>
<p>A time series of class <code><a href="stats.html#topic+ts">ts</a></code>, or another
object that can be coerced to such. For seasonal components, a frequency
greater than 1 is required.</p>
</td></tr>
<tr><td><code id="bfastpp_+3A_order">order</code></td>
<td>
<p>numeric. Order of the harmonic term, defaulting to <code>3</code>.</p>
</td></tr>
<tr><td><code id="bfastpp_+3A_lag">lag</code></td>
<td>
<p>numeric. Orders of the autoregressive term, by default omitted.</p>
</td></tr>
<tr><td><code id="bfastpp_+3A_slag">slag</code></td>
<td>
<p>numeric. Orders of the seasonal autoregressive term, by default
omitted.</p>
</td></tr>
<tr><td><code id="bfastpp_+3A_na.action">na.action</code></td>
<td>
<p>function for handling <code>NA</code>s in the data (after all
other preprocessing).</p>
</td></tr>
<tr><td><code id="bfastpp_+3A_stl">stl</code></td>
<td>
<p>character. Prior to all other preprocessing, STL (season-trend
decomposition via LOESS smoothing) can be employed for trend-adjustment
and/or season-adjustment.  The <code>"trend"</code> or <code>"seasonal"</code> component
or both from <code><a href="stats.html#topic+stl">stl</a></code> are removed from each column in
<code>data</code>. By default (<code>"none"</code>), no STL adjustment is used.</p>
</td></tr>
<tr><td><code id="bfastpp_+3A_decomp">decomp</code></td>
<td>
<p>&quot;stlplus&quot; or &quot;stl&quot;: use the NA-tolerant decomposition package
or the reference package (which can make use of time series with 2-3
observations per year)</p>
</td></tr>
<tr><td><code id="bfastpp_+3A_sbins">sbins</code></td>
<td>
<p>numeric. Controls the number of seasonal dummies. If integer &gt; 1,
sets the number of seasonal dummies to use per year.
If &lt;= 1, treated as a multiplier to the number of observations per year, i.e.
<code>ndummies = nobs/year * sbins</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To facilitate (linear) regression models of time series data, <code>bfastpp</code>
facilitates preprocessing and setting up regressor terms. It returns a
<code>data.frame</code> containing the first column of the <code>data</code> as the
<code>response</code> while further columns (if any) are used as covariates
<code>xreg</code>. Additionally, a linear trend, seasonal dummies, harmonic
seasonal terms, and (seasonal) autoregressive terms are provided.
</p>
<p>Optionally, each column of <code>data</code> can be seasonally adjusted and/or
trend-adjusted via STL (season-trend decomposition via LOESS smoothing)
prior to preprocessing. The idea would be to capture season and/or trend
nonparametrically prior to regression modelling.
</p>


<h3>Value</h3>

<p>If no formula is provided, <code>bfastpp</code> returns a
<code>"data.frame"</code> with the following variables (some of which may be
matrices).  </p>
<table>
<tr><td><code>time</code></td>
<td>
<p>numeric vector of time stamps,</p>
</td></tr>
<tr><td><code>response</code></td>
<td>
<p>response vector (first column of <code>data</code>),</p>
</td></tr>
<tr><td><code>trend</code></td>
<td>
<p>linear time trend (running from 1 to number of observations),</p>
</td></tr>
<tr><td><code>season</code></td>
<td>
<p>factor indicating season period,</p>
</td></tr> <tr><td><code>harmon</code></td>
<td>
<p>harmonic
seasonal terms (of specified <code>order</code>),</p>
</td></tr> <tr><td><code>lag</code></td>
<td>
<p>autoregressive terms
(or orders <code>lag</code>, if any),</p>
</td></tr> <tr><td><code>slag</code></td>
<td>
<p>seasonal autoregressive terms
(or orders <code>slag</code>, if any),</p>
</td></tr> <tr><td><code>xreg</code></td>
<td>
<p>covariate regressor (all
columns of <code>data</code> except the first, if any).</p>
</td></tr>
</table>
<p>If a formula is given, <code>bfastpp</code> returns a <code>list</code> with components
<code>X</code>, <code>y</code>, and <code>t</code>, where <code>X</code> is the design matrix of the
model, <code>y</code> is the response vector, and <code>t</code> represents the time of
observations. <code>X</code> will only contain variables that occur in the
formula. Columns of <code>X</code> have names as decribed above.
</p>


<h3>Author(s)</h3>

<p>Achim Zeileis
</p>


<h3>References</h3>

<p>Verbesselt J, Zeileis A, Herold M (2012).
&ldquo;Near real-time disturbance detection using satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>123</b>, 98&ndash;108.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2012.02.022">10.1016/j.rse.2012.02.022</a>, <a href="https://doi.org/10.1016/j.rse.2012.02.022">https://doi.org/10.1016/j.rse.2012.02.022</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bfastmonitor">bfastmonitor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## set up time series
ndvi &lt;- as.ts(zoo::zoo(cbind(a = som$NDVI.a, b = som$NDVI.b), som$Time))
ndvi &lt;- window(ndvi, start = c(2006, 1), end = c(2009, 23))

## parametric season-trend model
d1 &lt;- bfastpp(ndvi, order = 2)
d1lm &lt;- lm(response ~ trend + harmon, data = d1)
summary(d1lm)
# plot visually (except season, as it's a factor)
plot(zoo::read.zoo(d1)[,-3],
  # Avoid clipping plots for pretty output
  ylim = list(c(min(d1[,2]), max(d1[,2])),
            c(min(d1[,3]), max(d1[,3])),
            c(-1, 1), c(-1, 1), c(-1, 1), c(-1, 1),
            c(min(d1[,6]), max(d1[,6]))
       ))

## autoregressive model (after nonparametric season-trend adjustment)
d2 &lt;- bfastpp(ndvi, stl = "both", lag = 1:2)
d2lm &lt;- lm(response ~ lag, data = d2)
summary(d2lm)

## use the lower level lm.fit function
d3 &lt;- bfastpp(ndvi, stl = "both", lag = 1:2)
d3mm &lt;- model.matrix(response ~ lag, d3)
d3lm &lt;- lm.fit(d3mm, d3$response)
d3lm$coefficients
</code></pre>

<hr>
<h2 id='bfastts'>Create a regular time series object by combining data and date information</h2><span id='topic+bfastts'></span>

<h3>Description</h3>

<p>Create a regular time series object by combining measurements (data) and
time (dates) information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfastts(data, dates, type = c("irregular", "16-day", "10-day"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bfastts_+3A_data">data</code></td>
<td>
<p>A data vector or matrix where columns represent variables</p>
</td></tr>
<tr><td><code id="bfastts_+3A_dates">dates</code></td>
<td>
<p>Optional input of dates for each measurement in the 'data'
variable. In case the data is a irregular time series, a vector with 'dates'
for each measurement can be supplied using this 'dates' variable. The
irregular data will be linked with the dates vector to create daily regular
time series with a frequency = 365. Extra days in leap years might cause
problems. Please be careful using this option as it is experimental.
Feedback is welcome.</p>
</td></tr>
<tr><td><code id="bfastts_+3A_type">type</code></td>
<td>
<p>(<code>"irregular"</code>) indicates that the data is collected at
irregular dates and as such will be converted to a daily time series.
(<code>"16-day"</code>) indicates that data is collected at a regular time interval
(every 16-days e.g. like the MODIS 16-day data products). (<code>"10-day"</code>)
indicates that data is collected at a 10-day time interval of the SPOT VEGETATION
(S10) product. Warning: Only use this function for the SPOT VEGETATION S10 time series,
as for other 10-day time series a different approach might be required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bfastts</code> create a regular time series
</p>


<h3>Value</h3>

<p><code>bfastts</code> returns an object of class <code>"ts"</code>, i.e., a list
with components as follows.  </p>
<table>
<tr><td><code>zz</code></td>
<td>
<p> a regular <code>"ts"</code> time series
with a frequency equal to 365 or 23 i.e. 16-day time series.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Achim Zeileis, Jan Verbesselt
</p>


<h3>See Also</h3>

<p><code><a href="strucchangeRcpp.html#topic+monitor">monitor</a></code>, <code><a href="strucchangeRcpp.html#topic+mefp">mefp</a></code>,
<code><a href="strucchangeRcpp.html#topic+breakpoints">breakpoints</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 16-day time series (i.e. MODIS)
timedf &lt;- data.frame(y = som$NDVI.b, dates = dates[1:nrow(som)])
bfastts(timedf$y, timedf$dates, type = "16-day")

# Irregular
head(bfastts(timedf$y, timedf$dates, type = "irregular"), 50)


## Not run: 
# Example of use with a raster

library("raster")
f &lt;- system.file("extdata/modisraster.grd", package="bfast")
modisbrick &lt;- brick(f)
ndvi &lt;- bfastts(as.vector(modisbrick[1]), dates, type = c("16-day")) ## data of pixel 1
plot(ndvi/10000) 

# Time series of 4 pixels
modis_ts = t(as.data.frame(modisbrick))[,1:4]
# Data with multiple columns, 2-4 are external regressors
ndvi &lt;- bfastts(modis_ts, dates, type = c("16-day"))
plot(ndvi/10000)

## End(Not run)

</code></pre>

<hr>
<h2 id='create16dayts-deprecated'>A helper function to create time series</h2><span id='topic+create16dayts-deprecated'></span>

<h3>Description</h3>

<p>A deprecated alias to bfastts.
Please use <code>bfastts(type="16-day")</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create16dayts(data, dates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create16dayts-deprecated_+3A_data">data</code></td>
<td>
<p>Passed to bfastts.</p>
</td></tr>
<tr><td><code id="create16dayts-deprecated_+3A_dates">dates</code></td>
<td>
<p>Passed to bfastts.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Achim Zeileis, Jan Verbesselt
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bfastmonitor">bfastmonitor</a></code>
</p>
<p><code><a href="#topic+bfast-deprecated">bfast-deprecated</a></code>
</p>

<hr>
<h2 id='dates'>A vector with date information (a Datum type) to be linked with each NDVI
layer within the modis raster brick (modisraster data set)</h2><span id='topic+dates'></span>

<h3>Description</h3>

<p><code>dates</code> is an object of class &quot;Date&quot; and contains the &quot;Date&quot;
information to create a 16-day time series object.
</p>


<h3>Source</h3>

<p>Verbesselt J, Zeileis A, Herold M (2012).
&ldquo;Near real-time disturbance detection using satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>123</b>, 98&ndash;108.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2012.02.022">10.1016/j.rse.2012.02.022</a>, <a href="https://doi.org/10.1016/j.rse.2012.02.022">https://doi.org/10.1016/j.rse.2012.02.022</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## see ?bfastmonitor for examples

</code></pre>

<hr>
<h2 id='harvest'>16-day NDVI time series for a Pinus radiata plantation.</h2><span id='topic+harvest'></span>

<h3>Description</h3>

<p>A univariate time series object of class &quot;ts&quot;. Frequency is set to 23 &ndash; the
approximate number of observations per year.
</p>


<h3>Source</h3>

<p>Verbesselt J, Hyndman R, Newnham G, Culvenor D (2010).
&ldquo;Detecting trend and seasonal changes in satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>114</b>(1), 106&ndash;115.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2009.08.014">10.1016/j.rse.2009.08.014</a>, <a href="https://doi.org/10.1016/j.rse.2009.08.014">https://doi.org/10.1016/j.rse.2009.08.014</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(harvest,ylab='NDVI')
# References
citation("bfast")

</code></pre>

<hr>
<h2 id='modisraster'>A raster brick of 16-day satellite image NDVI time series for a small subset
in south eastern Somalia.</h2><span id='topic+modisraster'></span>

<h3>Description</h3>

<p>A raster brick containing 16-day NDVI satellite images (MOD13C1 product).
</p>


<h3>Source</h3>

<p>Verbesselt J, Zeileis A, Herold M (2012).
&ldquo;Near real-time disturbance detection using satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>123</b>, 98&ndash;108.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2012.02.022">10.1016/j.rse.2012.02.022</a>, <a href="https://doi.org/10.1016/j.rse.2012.02.022">https://doi.org/10.1016/j.rse.2012.02.022</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## see ?bfastmonitor


</code></pre>

<hr>
<h2 id='ndvi'>A random NDVI time series</h2><span id='topic+ndvi'></span>

<h3>Description</h3>

<p>A univariate time series object of class &quot;ts&quot;. Frequency is set to 24.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(ndvi)

</code></pre>

<hr>
<h2 id='plot.bfast'>Methods for objects of class &quot;bfast&quot;.</h2><span id='topic+plot.bfast'></span>

<h3>Description</h3>

<p>Plot methods for objects of class &quot;bfast&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bfast'
plot(
  x,
  type = c("components", "all", "data", "seasonal", "trend", "noise"),
  sim = NULL,
  largest = FALSE,
  main,
  ANOVA = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.bfast_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+bfast">bfast</a></code> object</p>
</td></tr>
<tr><td><code id="plot.bfast_+3A_type">type</code></td>
<td>
<p>Indicates the type of plot. See details.</p>
</td></tr>
<tr><td><code id="plot.bfast_+3A_sim">sim</code></td>
<td>
<p>Optional <code><a href="stats.html#topic+stl">stl</a></code> object containing the original
components used when simulating <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.bfast_+3A_largest">largest</code></td>
<td>
<p>If TRUE, show the largest jump in the trend component.</p>
</td></tr>
<tr><td><code id="plot.bfast_+3A_main">main</code></td>
<td>
<p>an overall title for the plot.</p>
</td></tr>
<tr><td><code id="plot.bfast_+3A_anova">ANOVA</code></td>
<td>
<p>if TRUE Derive Slope and Significance values for each
identified trend segment</p>
</td></tr>
<tr><td><code id="plot.bfast_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <code><a href="graphics.html#topic+plot">plot</a></code>
function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates various plots to demonstrate the results of a bfast
decomposition.
The type of plot shown depends on the value of <code>type</code>.
</p>

<ul>
<li><p>components Shows the final estimated components with breakpoints.
</p>
</li>
<li><p>all Plots the estimated components and breakpoints from all iterations.
</p>
</li>
<li><p>data Just plots the original time series data.
</p>
</li>
<li><p>seasonal Shows the trend component including breakpoints.
</p>
</li>
<li><p>trend Shows the trend component including breakpoints.
</p>
</li>
<li><p>noise Plots the noise component along with its acf and pacf.
</p>
</li></ul>

<p>If <code>sim</code> is not <code>NULL</code>, the components used in simulation are also
shown on each graph.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Jan Verbesselt, Rob Hyndman and Rogier De Jong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## See \code{\link[bfast]{bfast}} for examples.

</code></pre>

<hr>
<h2 id='plot.bfastlite'>Plot the time series and results of BFAST Lite</h2><span id='topic+plot.bfastlite'></span>

<h3>Description</h3>

<p>The black line represents the original input data,
the green line is the fitted model,
the blue lines are the detected breaks, and
the whiskers denote the magnitude (if <code>magstat</code> is specified).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bfastlite'
plot(x, breaks = NULL, magstat = NULL, magcomp = "trend", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.bfastlite_+3A_x">x</code></td>
<td>
<p>bfastlite object from <code><a href="#topic+bfastlite">bfastlite()</a></code></p>
</td></tr>
<tr><td><code id="plot.bfastlite_+3A_breaks">breaks</code></td>
<td>
<p>number of breaks or optimal break selection method, see <code><a href="strucchangeRcpp.html#topic+breakpoints">strucchangeRcpp::breakpoints()</a></code></p>
</td></tr>
<tr><td><code id="plot.bfastlite_+3A_magstat">magstat</code></td>
<td>
<p>name of the magnitude column to plot (e.g. <code>RMSD</code>, <code>MAD</code>, <code>diff</code>), see the <code>Mag</code> component of <code><a href="strucchangeRcpp.html#topic+magnitude">strucchangeRcpp::magnitude.breakpointsfull()</a></code></p>
</td></tr>
<tr><td><code id="plot.bfastlite_+3A_magcomp">magcomp</code></td>
<td>
<p>name of the component (i.e. column in <code>x$data_pp</code>) to plot magnitudes of</p>
</td></tr>
<tr><td><code id="plot.bfastlite_+3A_...">...</code></td>
<td>
<p>other parameters to pass to <code><a href="graphics.html#topic+plot">plot()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for side effects.
</p>

<hr>
<h2 id='setoptions'>Set package options with regard to computation times</h2><span id='topic+setoptions'></span><span id='topic+set_default_options'></span><span id='topic+set_fallback_options'></span><span id='topic+set_fast_options'></span>

<h3>Description</h3>

<p>These functions set options of the bfast and strucchangeRcpp packages to enable
faster computations. By default (<code>set_default_options</code>), these optimizations are
enabled. Notice that only some functions of the <code>bfast</code>
package make use of these options. <code>set_fast_options</code> is an alias for <code>set_default_options</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_default_options()

set_fast_options()

set_fallback_options()
</code></pre>


<h3>Value</h3>

<p>A list of modified options and their new values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# run bfastmonitor with different options and compare computation times
library(zoo)
NDVIa &lt;- as.ts(zoo(som$NDVI.a, som$Time))

set_default_options()
## Not run: 
system.time(replicate(100,  bfastmonitor(NDVIa, start = c(2010, 13))))

## End(Not run)

set_fallback_options()
## Not run: 
system.time(replicate(100,  bfastmonitor(NDVIa, start = c(2010, 13))))

## End(Not run)

</code></pre>

<hr>
<h2 id='simts'>Simulated seasonal 16-day NDVI time series</h2><span id='topic+simts'></span>

<h3>Description</h3>

<p><code>simts</code> is an object of class &quot;stl&quot; and consists of seasonal, trend
(equal to 0) and noise components. The simulated noise is typical for
remotely sensed satellite data.
</p>


<h3>Source</h3>

<p>Verbesselt J, Hyndman R, Newnham G, Culvenor D (2010).
&ldquo;Detecting trend and seasonal changes in satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>114</b>(1), 106&ndash;115.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2009.08.014">10.1016/j.rse.2009.08.014</a>, <a href="https://doi.org/10.1016/j.rse.2009.08.014">https://doi.org/10.1016/j.rse.2009.08.014</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(simts)
# References
citation("bfast")

</code></pre>

<hr>
<h2 id='som'>Two 16-day NDVI time series from the south of Somalia</h2><span id='topic+som'></span>

<h3>Description</h3>

<p><code>som</code> is a dataframe containing time and two NDVI time series to
illlustrate how the monitoring approach works.
</p>


<h3>Source</h3>

<p>Verbesselt J, Zeileis A, Herold M (2012).
&ldquo;Near real-time disturbance detection using satellite image time series.&rdquo;
<em>Remote Sensing of Environment</em>, <b>123</b>, 98&ndash;108.
ISSN 0034-4257, doi: <a href="https://doi.org/10.1016/j.rse.2012.02.022">10.1016/j.rse.2012.02.022</a>, <a href="https://doi.org/10.1016/j.rse.2012.02.022">https://doi.org/10.1016/j.rse.2012.02.022</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## first define the data as a regular time series (i.e. ts object)
library(zoo)
NDVI &lt;- as.ts(zoo(som$NDVI.b,som$Time))
plot(NDVI)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
