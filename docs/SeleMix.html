<!DOCTYPE html><html><head><title>Help for package SeleMix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SeleMix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ex1.data'>
<p>Example data frame</p></a></li>
<li><a href='#ex2.data'>
<p>Example Data for package SeleMix</p></a></li>
<li><a href='#ml.est'>
<p>Fitting Contamination Model</p></a></li>
<li><a href='#pred.y'>
<p>Prediction of y variables</p></a></li>
<li><a href='#sel.edit'>
<p>Influential Error Detection</p></a></li>
<li><a href='#sel.pairs'>
<p>Scatterplot Matrix</p></a></li>
<li><a href='#sel.plot'>
<p>Scatterplot with information about outliers and influential errors</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Selective Editing via Mixture Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-10-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Ugo Guarnera [aut],
	Teresa Buglielli [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Teresa Buglielli &lt;bugliell@istat.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Detection of outliers and influential errors using a latent variable model. </td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, graphics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>Ecdat, xtable</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://joinup.ec.europa.eu/software/page/eupl">EUPL</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-28 22:16:43 UTC; Teresa</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-29 01:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='ex1.data'>
Example data frame
</h2><span id='topic+ex1.data'></span>

<h3>Description</h3>

<p>Simulated data from a Gaussian contamination model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ex1.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 500 observations and 2 variables (<code>X1</code>,<code>Y1</code>).
</p>

<dl>
<dt><code>X1</code></dt><dd><p>error-free variable (numeric)</p>
</dd>
<dt><code>Y1</code></dt><dd><p>contaminated variable (numeric)</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data have been generated by a Gaussian  model. The
variable Y1  has been contaminated with parameters B=(-0.26, 1.26), sigma=1.21, w=0.05, lambda=10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ex1.data)

</code></pre>

<hr>
<h2 id='ex2.data'>
Example Data for package SeleMix
</h2><span id='topic+ex2.data'></span>

<h3>Description</h3>

<p>Simulated data from a Gaussian contaminated model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ex2.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 500 observations on the following 2 variables.
</p>

<dl>
<dt><code>Y1</code></dt><dd><p>first numeric contaminated variable</p>
</dd>
<dt><code>Y2</code></dt><dd><p>second numeric contaminated variable</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data have been simulated by Gaussian contamination model with two
contaminated variables (Y1,Y2) with parameters 
B=(1.03, 0.96), sigma=matrix(c(1.22, 1.42,1.42, 2.89),2,2), w=0.05, lambda=10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ex2.data)

</code></pre>

<hr>
<h2 id='ml.est'>
Fitting Contamination Model
</h2><span id='topic+ml.est'></span>

<h3>Description</h3>

<p>Provides ML estimates of a Gaussian contamination model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ml.est (y, x=NULL, model = "LN", lambda=3,  w=0.05,
            lambda.fix=FALSE, w.fix=FALSE, eps=1e-7,  
            max.iter=500, t.outl=0.5, graph=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ml.est_+3A_y">y</code></td>
<td>

<p>matrix or data frame containing the response variables
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_x">x</code></td>
<td>

<p>optional matrix or data frame containing the error free covariates
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_model">model</code></td>
<td>

<p>data distribution: LN = lognormal(default), N=normal
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_lambda">lambda</code></td>
<td>

<p>starting value for the variance inflation factor (default=3)
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_w">w</code></td>
<td>

<p>starting value for the proportion of contaminated data (default=0.05)
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_lambda.fix">lambda.fix</code></td>
<td>
<p> logical. TRUE if lambda is known
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_w.fix">w.fix</code></td>
<td>
<p> logical. TRUE if w is known
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_eps">eps</code></td>
<td>

<p>epsilon : tolerance parameter for the log-likelihood convergence (default=1e-7)
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_max.iter">max.iter</code></td>
<td>

<p>maximum number of EM iterations (default=500)
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_t.outl">t.outl</code></td>
<td>

<p>threshold value for posterior probabilities of identifying outliers (default=0.5)
</p>
</td></tr>
<tr><td><code id="ml.est_+3A_graph">graph</code></td>
<td>

<p>logical. TRUE to display graphics (default=FALSE)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides the parameter estimates of a contamination model where a set of <code>y</code>
variables is assumed to depend on a (possibly empty) set of covariates (<code>x</code> variables) 
through a mixture of two linear regressions with Gaussian residuals. The covariance matrices
of the two mixture components are assumed to be proportional (the proportionality constant being 
<code>lambda</code>). In case of no <code>x</code> variables a mixture of two Gaussian distribution is estimated.  
BIC and AIC scores (<code>bic.aic</code>) are returned corresponding to both standard Gaussian model
and contamination model in order to help the user to avoid possible over-parametrisation.  
</p>
<p>According to the estimated model parameters, a matrix of predictions of &lsquo;true&rsquo; <code>y</code> values 
(<code>ypred</code>) is computed. To each unit in the dataset, a flag (<code>outlier</code>) is assigned taking 
value 0 or 1 depending on whether the posterior probability of being erroneous (<code>tau</code>) is 
greater than the user specified threshold  (<code>t.outl</code>). 
</p>
<p>The model is estimated using complete observations. Missing values in the <code>x</code> variables are
not allowed. However,  <code>y</code> variables can be partly observed. Robust predictions of <code>y</code> variables 
are provided even when they are not observed.
A vector of missing pattern (<code>pattern</code>) indicates which  item is observed and which is missing.  
</p>
<p>In case the option &lsquo;model = LN&rsquo;  is specified, each zero value is changed in 1e-7 and 
a warning is returned. 
</p>
<p>In order to graphically monitor EM algorithm, a scatter plot is showed where outliers 
are depicted as long as they are identified. The trajectory of the <code>lambda</code> parameter 
is also showed until convergence. 
</p>


<h3>Value</h3>

<p><code>ml.est</code> returns a list containing the following components:<br /><br />
</p>
<table>
<tr><td><code>ypred</code></td>
<td>
<p>matrix of predicted values for y variables</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>matrix of estimated regression coefficients</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>estimated covariance matrix</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>estimated variance inflation factor</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>estimated proportion of erroneous data</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>vector of posterior probabilities of being contaminated</p>
</td></tr>
<tr><td><code>outlier</code></td>
<td>
<p>1 if the observation is classified as an outlier, 0 otherwise</p>
</td></tr>
<tr><td><code>n.outlier</code></td>
<td>
<p>total of outlier observations</p>
</td></tr>
<tr><td><code>pattern</code></td>
<td>
<p>vector of non-response patterns for y variables: 0 = missing, 1 = present value</p>
</td></tr>
<tr><td><code>is.conv</code></td>
<td>
<p>logical value: TRUE if the EM algorithm has converged</p>
</td></tr>
<tr><td><code>n.iter</code></td>
<td>
<p>number of iterations of EM algorithm</p>
</td></tr>
<tr><td><code>sing</code></td>
<td>
<p>if TRUE iteration are stopped because there is an almost perfect fit </p>
</td></tr> 
<tr><td><code>bic.aic</code></td>
<td>
<p>Bayesian Information Criterion and Akaike Information Criterion for contaminated 
and non contaminated Gaussian models</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M. Teresa Buglielli &lt;bugliell@istat.it&gt;, Ugo Guarnera &lt;guarnera@istat.it&gt;
</p>


<h3>References</h3>

<p>Di Zio, M., Guarnera, U. (2013) <em>&quot;A Contamination Model for Selective Editing&quot;</em>, 
Journal of Official Statistics. Volume 29, Issue 4, Pages 539-555
(<a href="https://doi.org/10.2478/jos-2013-0039">https://doi.org/10.2478/jos-2013-0039</a>). <br />
</p>
<p>Buglielli, M.T., Di Zio, M., Guarnera, U. (2010) <em>&quot;Use of Contamination Models for Selective Editing&quot;</em>, 
European Conference on Quality in Survey Statistics Q2010, Helsinki, 4-6 May 2010
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Parameter estimation with one contaminated variable and one covariate
        data(ex1.data)
        ml.par &lt;- ml.est(y=ex1.data[,"Y1"], x=ex1.data[,"X1"], graph=TRUE) 
        str(ml.par)
        sum(ml.par$outlier)  # number of outliers
# Parameter estimation with two contaminated variables and no covariates   
## Not run:  
        data(ex2.data)
        par.joint &lt;- ml.est(y=ex2.data, x=NULL, graph=TRUE)  
        sum(par.joint$outlier)  # number of outliers  
  
## End(Not run)      
</code></pre>

<hr>
<h2 id='pred.y'>
Prediction of y variables  
</h2><span id='topic+pred.y'></span>

<h3>Description</h3>

<p>Provides predictions of y variables according to a Gaussian contamination model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    pred.y (y, x=NULL, B, sigma, lambda, w, model="LN", t.outl=0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred.y_+3A_y">y</code></td>
<td>

<p>matrix or data frame containing the response variables
</p>
</td></tr>
<tr><td><code id="pred.y_+3A_x">x</code></td>
<td>

<p>optional matrix or data frame containing the error free covariates
</p>
</td></tr>
<tr><td><code id="pred.y_+3A_b">B</code></td>
<td>

<p>matrix of regression coefficients
</p>
</td></tr>
<tr><td><code id="pred.y_+3A_sigma">sigma</code></td>
<td>

<p>covariance matrix
</p>
</td></tr>
<tr><td><code id="pred.y_+3A_lambda">lambda</code></td>
<td>

<p>variance inflation factor
</p>
</td></tr>
<tr><td><code id="pred.y_+3A_w">w</code></td>
<td>

<p>proportion of erroneous data
</p>
</td></tr> 
<tr><td><code id="pred.y_+3A_model">model</code></td>
<td>

<p>data distribution: LN = lognormal(default), N=normal
</p>
</td></tr>
<tr><td><code id="pred.y_+3A_t.outl">t.outl</code></td>
<td>

<p>threshold value for posterior probabilities of identifying outliers (default=0.5)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides expected values of a set of variables (<code>y1.p,y2.p,...</code> ) according 
to a mixture of two regression models with Gaussian residuals (see <code><a href="#topic+ml.est">ml.est</a></code>). If no covariates are available 
(<code>x</code> variables), a two component Gaussian mixture is used. Expected values (predictions) are computed
on the base of a set of parameters of appropriate dimensions (<code>B, sigma, lambda,w</code>) and (possibly) 
a matrix (or data frame) containing the error-free <code>x</code> variables. 
</p>
<p>Missing values in the <code>x</code> variables are not allowed. However, robust predictions of <code>y</code> variables are 
also provided when these variables are not observed. A vector of missing pattern (<code>pattern</code>) indicates 
which item is observed and which is missing.  
</p>
<p>For each unit in the data set the posterior probability of being erroneous (<code>tau</code>)  is computed and a
flag (<code>outlier</code>) is provided taking value 0 or 1 depending on whether <code>tau</code>  is greater than the user 
specified threshold  (<code>t.outl</code>).
</p>


<h3>Value</h3>

<p><code>pred.y</code> returns a data frame containing the following columns:<br /><br />
</p>
<table>
<tr><td><code>y1.p</code>, <code>y2.p</code>, <code>...</code></td>
<td>

<p>predicted values for y variables
</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p> posterior probabilities of being contaminated</p>
</td></tr>
<tr><td><code>outlier</code></td>
<td>
<p> 1 if the observation is classified as an outlier, 0 otherwise </p>
</td></tr>
<tr><td><code>pattern</code></td>
<td>
<p> non-response patterns for y variables: 0 = missing, 1 = present value</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M. Teresa Buglielli &lt;bugliell@istat.it&gt;, Ugo Guarnera &lt;guarnera@istat.it&gt;
</p>


<h3>References</h3>

<p>Buglielli, M.T., Di Zio, M., Guarnera, U. (2010) <em>&quot;Use of Contamination Models for Selective Editing&quot;</em>, 
European Conference on Quality in Survey Statistics Q2010, Helsinki, 4-6 May 2010
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Parameter estimation with one contaminated variable and one covariate
  data(ex1.data)
# Parameters estimated applying ml.est to \code{ex1.data} 
  B1 &lt;- as.matrix(c(-0.152, 1.215))
  sigma1 &lt;- as.matrix(1.25)
  lambda1 &lt;- 15.5
  w1 &lt;- 0.0479

# Variable prediction
  ypred &lt;- pred.y (y=ex1.data[,"Y1"],  x=ex1.data[,"X1"], B=B1,
          sigma=sigma1, lambda=lambda1, w=w1, model="LN", t.outl=0.5)
# Plot ypred vs Y1
  sel.pairs(cbind(ypred[,1,drop=FALSE],ex1.data[,"Y1",drop=FALSE]),
            outl=ypred[,"outlier"])
</code></pre>

<hr>
<h2 id='sel.edit'>
Influential Error Detection
</h2><span id='topic+sel.edit'></span>

<h3>Description</h3>

<p>Computes the score function and identifies influential errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>       sel.edit (y, ypred, wgt=rep(1,nrow(as.matrix(y ))), 
                 tot=colSums(ypred * wgt), t.sel=0.01) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sel.edit_+3A_y">y</code></td>
<td>

<p>matrix or data frame containing the response variables 
</p>
</td></tr>
<tr><td><code id="sel.edit_+3A_ypred">ypred</code></td>
<td>

<p>matrix of predicted values for y variables
</p>
</td></tr>
<tr><td><code id="sel.edit_+3A_wgt">wgt</code></td>
<td>

<p>optional vector of sampling weights (default=1)
</p>
</td></tr>
<tr><td><code id="sel.edit_+3A_tot">tot</code></td>
<td>

<p>optional vector containing reference estimates of totals for the y variables. 
If omitted, it is computed as the (possibly weighted) sum of predicted values 
</p>
</td></tr>
<tr><td><code id="sel.edit_+3A_t.sel">t.sel</code></td>
<td>

<p>optional vector of threshold values, one for each variable, for selective editing (default=0.01)   
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function ranks observations (<code>rank</code>) according to the importance of their potential errors. 
The order is made with respect to the global score function values (<code>global.score</code>).  
The function also selects the units to be edited (<code>sel</code>) so that the expected residual error of
all variables is below a prefixed level of accuracy (<code>t.sel</code>). 
The global score (<code>global.score</code>)  is the maximum of the local scores computed for each variable 
(<code>y1.score, y2.score,...</code>). 
The local scores are defined as a weighted (<code>weights</code>) absolute difference between the observed 
(<code>y1, y2,...</code>) and the predicted values (<code>y1.p, y2.p,...</code>) standardised with respect to 
the reference total estimates (<code>tot</code>).<br />
</p>
<p>The selection of the units to be edited because affected by an influential error (<code>sel=1</code>) is 
made according to a two-step algorithm:<br />
1) order the observations with respect to the <code>global.score</code> (decreasing order);<br />
2) select the first k units such that, from the (k+1)th to the last observation, all the 
residual errors (<code>y1.reserr, y2.reserr,...</code>) for each variable are below <code>t.sel</code>.<br />
<br />
The function provides also an indicator function (<code>y1.sel, y2.sel,...</code>) reporting 
which variables contain an influential errors in a unit selected for the revision. 
</p>


<h3>Value</h3>

<p><code>sel.edit</code> returns a data matrix containing the following columns:<br />
</p>
<table>
<tr><td><code>y1</code>, <code>y2</code>, <code>...</code></td>
<td>
<p>observed variables</p>
</td></tr>
<tr><td><code>y1.p</code>, <code>y2.p</code>, <code>...</code></td>
<td>
<p>predictions of y variables</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>sampling weights</p>
</td></tr>
<tr><td><code>y1.score</code>, <code>y2.score</code>, <code>...</code></td>
<td>
<p>local scores</p>
</td></tr>
<tr><td><code>global.score</code></td>
<td>
<p>global score</p>
</td></tr>
<tr><td><code>y1.reserr</code>, <code>y2.reserr</code>, <code>...</code></td>
<td>
<p>residual errors</p>
</td></tr>
<tr><td><code>y1.sel</code>, <code>y2.sel</code>, <code>...</code></td>
<td>
<p>influential error flags</p>
</td></tr>       
<tr><td><code>rank</code></td>
<td>
<p>rank according to global score</p>
</td></tr>
<tr><td><code>sel</code></td>
<td>
<p>1 if the observation contains an influential error, 0 otherwise</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>M. Teresa Buglielli &lt;bugliell@istat.it&gt;, Ugo Guarnera &lt;guarnera@istat.it&gt;
</p>


<h3>References</h3>

<p>Di Zio, M., Guarnera, U. (2013) <em>&quot;A Contamination Model for Selective Editing&quot;</em>, 
Journal of Official Statistics. Volume 29, Issue 4, Pages 539-555 (<a href="http://dx.doi.org/10.2478/jos-2013-0039">http://dx.doi.org/10.2478/jos-2013-0039</a>). <br />
</p>
<p>Buglielli, M.T., Di Zio, M., Guarnera, U. (2010) <em>&quot;Use of Contamination Models for Selective Editing&quot;</em>, 
European Conference on Quality in Survey Statistics Q2010, Helsinki, 4-6 May 2010.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
# Parameter estimation with one contaminated variable and one covariate
    data(ex1.data)
    ml.par &lt;- ml.est(y=ex1.data[,"Y1"], x=ex1.data[,"X1"])
# Detection of influential errors    
    sel &lt;- sel.edit(y=ex1.data[,"Y1"], ypred=ml.par$ypred)
    head(sel)
    sum(sel[,"sel"])
# orders results for decreasing importance of score     
    sel.ord &lt;- sel[order(sel[,"rank"]),  ] 
# adds columns to data
    ex1.data &lt;- cbind(ex1.data, tau=ml.par$tau, outlier=ml.par$outlier,
                      sel[,c("rank", "sel")])
# plot of data with outliers and influential errors 
    sel.pairs(ex1.data[,c("X1","Y1")],outl=ml.par$outlier, sel=sel[,"sel"])
# Example 2
    data(ex2.data)
    par.joint &lt;- ml.est(y=ex2.data)
    sel &lt;- sel.edit(y=ex2.data, ypred=par.joint$ypred)	
    sel.pairs(ex2.data,outl=par.joint$outlier, sel=sel[,"sel"])
</code></pre>

<hr>
<h2 id='sel.pairs'>
Scatterplot Matrix
</h2><span id='topic+sel.pairs'></span>

<h3>Description</h3>

 
<p>A scatterplot matrix with outlier and influential errors is produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sel.pairs(x, outl = rep(0, nrow(x)), sel = rep(0,nrow(x)), 
          labs = NULL, log = TRUE, legend=TRUE, title=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sel.pairs_+3A_x">x</code></td>
<td>

<p>matrix or data frame of the coordinates of points
</p>
</td></tr>
<tr><td><code id="sel.pairs_+3A_outl">outl</code></td>
<td>

<p>vector identifying outliers (1 or TRUE means outlier)
</p>
</td></tr>
<tr><td><code id="sel.pairs_+3A_sel">sel</code></td>
<td>

<p>vector identifying influential errors (1 or TRUE means influential error)
</p>
</td></tr>
<tr><td><code id="sel.pairs_+3A_labs">labs</code></td>
<td>

<p>names of the variables 
</p>
</td></tr>
<tr><td><code id="sel.pairs_+3A_log">log</code></td>
<td>

<p>if TRUE logarithm of <code>x</code> are plotted
</p>
</td></tr>
<tr><td><code id="sel.pairs_+3A_legend">legend</code></td>
<td>

<p>if TRUE a legend is added to first boxplot
</p>
</td></tr> 
<tr><td><code id="sel.pairs_+3A_title">title</code></td>
<td>

<p>an overall title for the plot
</p>
</td></tr> 	
</table>


<h3>Details</h3>

<p>The ijth scatterplot contains x[,i] plotted against x[,j]. Outliers are represented as blue circles,
influential errors as red circles and points that are both outlier and influential error as cyan circles.
</p>

<hr>
<h2 id='sel.plot'>
Scatterplot with information about outliers and influential errors
</h2><span id='topic+sel.plot'></span>

<h3>Description</h3>

 
<p>In addition to a standard scatterplot, outliers and influential errors are highlighted.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sel.plot (data, vars=1:2, outl = rep(0, nrow(data)), sel = rep(0, nrow(data)),
          log = TRUE, n.identify=0, file=NULL, title=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sel.plot_+3A_data">data</code></td>
<td>

<p>named matrix or data frame containing at least the coordinates of points
</p>
</td></tr>
<tr><td><code id="sel.plot_+3A_vars">vars</code></td>
<td>

<p>vector with the names or column numbers of the two variables to plot
</p>
</td></tr>
<tr><td><code id="sel.plot_+3A_outl">outl</code></td>
<td>

<p>vector identifying outliers (1 or TRUE means outlier)
</p>
</td></tr>
<tr><td><code id="sel.plot_+3A_sel">sel</code></td>
<td>

<p>vector identifying influential errors (1 or TRUE means influential error)
</p>
</td></tr>
<tr><td><code id="sel.plot_+3A_log">log</code></td>
<td>

<p>if TRUE logarithm of <code>data[,vars]</code> are plotted
</p>
</td></tr>
<tr><td><code id="sel.plot_+3A_n.identify">n.identify</code></td>
<td>

<p>number of points to be identified on the scattrerplot. Corresponding data are printed on console or file (if a file name is specified)
</p>
</td></tr> 
<tr><td><code id="sel.plot_+3A_file">file</code></td>
<td>

<p>name of the output file. If <code>n.identify</code> is equal 0 the graphic is saved in a jpeg file. If <code>n.identify</code> is greater than 0 data rows corresponding selected points are saved in a csv file
</p>
</td></tr> 
<tr><td><code id="sel.plot_+3A_title">title</code></td>
<td>

<p>an overall title for the plot
</p>
</td></tr> 	
</table>


<h3>Details</h3>

<p>The scatterplot contains the first varaible plotted against the second. Outliers are represented as blue circles,
influential errors as red circles and points that are both outlier and influential error as cyan circles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
    data(ex2.data)
    par.joint &lt;- ml.est(y=ex2.data)
    sel &lt;- sel.edit(y=ex2.data, ypred=par.joint$ypred)	
    sel.plot(ex2.data,outl=par.joint$outlier, sel=sel[,"sel"], title="EXAMPLE 2")
  ## Not run:    
    sel.plot(ex2.data,outl=par.joint$outlier, sel=sel[,"sel"], title="EXAMPLE 2", n.identify=3)
    
## End(Not run)
    
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
