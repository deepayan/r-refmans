<!DOCTYPE html><html><head><title>Help for package climwin</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {climwin}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#autowin'><p>Test for auto-correlation in climate.</p></a></li>
<li><a href='#Chaff'><p>Annual laying date of breeding common chaffinch (Fringilla coelebs).</p></a></li>
<li><a href='#ChaffClim'><p>Daily climate data from 1965 to 2012.</p></a></li>
<li><a href='#crosswin'><p>Test the correlation between two climate variables.</p></a></li>
<li><a href='#explore'><p>Visualise the weight distribution for given parameter values</p></a></li>
<li><a href='#Mass'><p>Chick body mass data since 1979.</p></a></li>
<li><a href='#MassClimate'><p>Daily climate data since 1979.</p></a></li>
<li><a href='#MassOutput'><p>Example output dataframe from function slidingwin.</p></a></li>
<li><a href='#MassRand'><p>Example output dataframe from function randwin.</p></a></li>
<li><a href='#medwin'><p>Determine the median start and end time for climate windows</p></a></li>
<li><a href='#merge_results'><p>Merge two slidingwin analyses.</p></a></li>
<li><a href='#Monthly_data'><p>Monthly temperature data</p></a></li>
<li><a href='#Offspring'><p>Reproductive success of birds since 2009.</p></a></li>
<li><a href='#OffspringClimate'><p>Daily climate data since 2009.</p></a></li>
<li><a href='#plotall'><p>Visualise climate window data</p></a></li>
<li><a href='#plotbest'><p>Visualise the best climate window</p></a></li>
<li><a href='#plotbetas'><p>Plot model beta estimates</p></a></li>
<li><a href='#plotcor'><p>Visualise climate cross correlation or autocorrelation.</p></a></li>
<li><a href='#plotdelta'><p>Plot deltaAICc of models</p></a></li>
<li><a href='#plothist'><p>Create a histogram of randomised deltaAICc values</p></a></li>
<li><a href='#plotweights'><p>Plot distribution of model weights</p></a></li>
<li><a href='#plotwin'><p>Plot the start and end time of best climate windows</p></a></li>
<li><a href='#pvalue'><p>Determine the probability that a given climate signal is 'true'.</p></a></li>
<li><a href='#randwin'><p>Climate window analysis for randomised data</p></a></li>
<li><a href='#singlewin'><p>Fit a single climate window</p></a></li>
<li><a href='#Size'><p>Average size of red winged fairy wren (Malurus elegans) chicks.</p></a></li>
<li><a href='#SizeClimate'><p>Daily climate data from 2006 to 2015.</p></a></li>
<li><a href='#slidingwin'><p>Test for a climate windows in data.</p></a></li>
<li><a href='#weightwin'><p>Find a weighted climate window</p></a></li>
<li><a href='#wgdev'><p>Calculate within group deviance.</p></a></li>
<li><a href='#wgmean'><p>Calculate within group means.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Climate Window Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Liam D. Bailey and Martijn van de Pol</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Liam D. Bailey &lt;liam.bailey@liamdbailey.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/LiamDBailey/climwin">https://github.com/LiamDBailey/climwin</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/LiamDBailey/climwin/issues">https://github.com/LiamDBailey/climwin/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions to detect and visualise periods of climate
    sensitivity (climate windows) for a given biological response. 
    Please see van de Pol et al. (2016) &lt;<a href="https://doi.org/10.1111%2F2041-210X.12590">doi:10.1111/2041-210X.12590</a>&gt; 
    and Bailey and van de Pol (2016) &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0167980">doi:10.1371/journal.pone.0167980</a>&gt; for details.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), ggplot2, gridExtra, Matrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>evd, lubridate, lme4, MuMIn, reshape, numDeriv, RcppRoll, nlme</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>LazyData:</td>
<td>True</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-26 07:54:24 UTC; Liam</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-26 09:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='autowin'>Test for auto-correlation in climate.</h2><span id='topic+autowin'></span>

<h3>Description</h3>

<p>Tests the correlation between the climate in a specified climate window and 
other fitted climate windows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autowin(
  reference,
  xvar,
  cdate,
  bdate,
  baseline,
  range,
  stat,
  func,
  type,
  refday,
  cmissing = FALSE,
  cinterval = "day",
  upper = NA,
  lower = NA,
  binary = FALSE,
  centre = list(NULL, "both"),
  cohort = NULL,
  spatial = NULL,
  cutoff.day = NULL,
  cutoff.month = NULL,
  furthest = NULL,
  closest = NULL,
  thresh = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autowin_+3A_reference">reference</code></td>
<td>
<p>Reference climate data to be compared. Generated by functions
<code><a href="#topic+singlewin">singlewin</a></code> or <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="autowin_+3A_xvar">xvar</code></td>
<td>
<p>The climate variable of interest. Please specify the parent 
environment and variable name (e.g. Climate$Temp).</p>
</td></tr>
<tr><td><code id="autowin_+3A_cdate">cdate</code></td>
<td>
<p>The climate date variable (dd/mm/yyyy). Please specify the parent
environment and variable name (e.g. Climate$Date).</p>
</td></tr>
<tr><td><code id="autowin_+3A_bdate">bdate</code></td>
<td>
<p>The biological date variable (dd/mm/yyyy). Please specify the 
parent environment and variable name (e.g. Biol$Date).</p>
</td></tr>
<tr><td><code id="autowin_+3A_baseline">baseline</code></td>
<td>
<p>The baseline model used to fit climate windows. These will be
correlated with the reference climate window.</p>
</td></tr>
<tr><td><code id="autowin_+3A_range">range</code></td>
<td>
<p>Two values signifying respectively the furthest and closest number 
of time intervals (set by cinterval) back from the cutoff date or biological record to include 
in the climate window search.</p>
</td></tr>
<tr><td><code id="autowin_+3A_stat">stat</code></td>
<td>
<p>The aggregate statistic used to analyse the climate data. Can 
currently use basic R statistics (e.g. mean, min), as well as slope. 
Additional aggregate statistics can be created using the format function(x) 
(...). See parameter FUN in <code><a href="base.html#topic+apply">apply</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="autowin_+3A_func">func</code></td>
<td>
<p>The function used to fit the climate variable. Can be linear 
(&quot;lin&quot;), quadratic (&quot;quad&quot;), cubic (&quot;cub&quot;), inverse (&quot;inv&quot;) or log (&quot;log&quot;).
Not required when a variable is provided for parameter 'centre'.</p>
</td></tr>
<tr><td><code id="autowin_+3A_type">type</code></td>
<td>
<p>&quot;absolute&quot; or &quot;relative&quot;, whether you wish the climate window to be relative
(e.g. the number of days before each biological record is measured) or absolute
(e.g. number of days before a set point in time).</p>
</td></tr>
<tr><td><code id="autowin_+3A_refday">refday</code></td>
<td>
<p>If type is &quot;absolute&quot;, the day and month respectively of the 
year from which the absolute window analysis will start.</p>
</td></tr>
<tr><td><code id="autowin_+3A_cmissing">cmissing</code></td>
<td>
<p>cmissing Determines what should be done if there are 
missing climate data. Three approaches are possible:
- FALSE; the function will not run if missing climate data is encountered.
An object 'missing' will be returned containing the dates of missing climate.
- &quot;method1&quot;; missing climate data will be replaced with the mean climate
of the preceding and following 2 days.
- &quot;method2&quot;; missing climate data will be replaced with the mean climate
of all records on the same date.</p>
</td></tr>
<tr><td><code id="autowin_+3A_cinterval">cinterval</code></td>
<td>
<p>The resolution at which climate window analysis will be 
conducted. May be days (&quot;day&quot;), weeks (&quot;week&quot;), or months (&quot;month&quot;). Note the units 
of parameter 'range' will differ with the choice of cinterval.</p>
</td></tr>
<tr><td><code id="autowin_+3A_upper">upper</code></td>
<td>
<p>Cut-off value used to determine growing degree days or positive 
climate thresholds (depending on parameter thresh). Note that when values
of lower and upper are both provided, autowin will instead calculate an 
optimal climate zone.</p>
</td></tr>
<tr><td><code id="autowin_+3A_lower">lower</code></td>
<td>
<p>Cut-off value used to determine chill days or negative 
climate thresholds (determined by parameter thresh). Note that when values
of lower and upper are both provided, autowin will instead calculate an 
optimal climate zone.</p>
</td></tr>
<tr><td><code id="autowin_+3A_binary">binary</code></td>
<td>
<p>TRUE or FALSE. Determines whether to use values of upper and
lower to calculate binary climate data (binary = TRUE), or to use for
growing degree days (binary = FALSE).</p>
</td></tr>
<tr><td><code id="autowin_+3A_centre">centre</code></td>
<td>
<p>A list item containing:
1. The variable used for mean centring (e.g. Year, Site, Individual). 
Please specify the parent environment and variable name (e.g. Biol$Year).
2. Whether the model should include both within-group means and variance (&quot;both&quot;),
only within-group means (&quot;mean&quot;), or only within-group variance (&quot;dev&quot;).</p>
</td></tr>
<tr><td><code id="autowin_+3A_cohort">cohort</code></td>
<td>
<p>A variable used to group biological records that occur in the same biological
season but cover multiple years (e.g. southern hemisphere breeding season). By default,
autowin will use year (extracted from parameter bdate) as the cohort variable. 
The cohort variable should be in the same dataset as the variable bdate.</p>
</td></tr>
<tr><td><code id="autowin_+3A_spatial">spatial</code></td>
<td>
<p>A list item containing:
1. A factor that defines which spatial group (i.e. population) each biological
record is taken from. The length of this factor should correspond to the length 
of the biological dataset.
2. A factor that defines which spatial group (i.e. population) climate data
corresponds to. The length of this factor should correspond to the length of
the climate dataset.</p>
</td></tr>
<tr><td><code id="autowin_+3A_cutoff.day">cutoff.day</code>, <code id="autowin_+3A_cutoff.month">cutoff.month</code></td>
<td>
<p>Redundant parameters. Now replaced by refday.</p>
</td></tr>
<tr><td><code id="autowin_+3A_furthest">furthest</code>, <code id="autowin_+3A_closest">closest</code></td>
<td>
<p>Redundant parameters. Now replaced by range.</p>
</td></tr>
<tr><td><code id="autowin_+3A_thresh">thresh</code></td>
<td>
<p>Redundant parameter. Now replaced by binary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Will return a data frame showing the correlation between the climate 
in each fitted window and the chosen reference window.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simple test example
#Create data from a subset of our test dataset
#Just use two years
biol_data &lt;- Mass[1:2, ]
clim_data &lt;- MassClimate[grep(pattern = "1979|1986", x = MassClimate$Date), ]

single &lt;- singlewin(xvar = list(Temp = clim_data$Temp),
                   cdate = clim_data$Date, 
                   bdate = biol_data$Date, 
                   baseline = lm(Mass ~ 1, data = biol_data),
                   range = c(1, 0), 
                   type = "relative", stat = "mean", 
                   func = c("lin"), cmissing = FALSE, cinterval = "day")
                   
auto &lt;- autowin(reference = single,
                xvar  = list(Temp = clim_data$Temp),
                cdate = clim_data$Date, bdate = biol_data$Date,
                baseline = lm(Mass ~ 1, data = biol_data), range = c(1, 0), 
                stat = "mean", func = "lin", 
                type = "relative",
                cmissing = FALSE, cinterval = "day")

## Not run: 

# Full example
# Test for auto-correlation using 'Mass' and 'MassClimate' data frames

data(Mass)
data(MassClimate)

# Fit a single climate window using the datasets Mass and MassClimate.

single &lt;- singlewin(xvar = list(Temp = MassClimate$Temp), 
                    cdate = MassClimate$Date, bdate = Mass$Date,
                    baseline = lm(Mass ~ 1, data = Mass), 
                    range = c(72, 15), 
                    stat = "mean", func = "lin", type = "absolute", 
                    refday = c(20, 5), 
                    cmissing = FALSE, cinterval = "day")            

# Test the autocorrelation between the climate in this single window and other climate windows.

auto &lt;- autowin(reference = single,
                xvar  = list(Temp = MassClimate$Temp), cdate = MassClimate$Date, bdate = Mass$Date,
                baseline = lm(Mass ~ 1, data = Mass), range = c(365, 0), 
                stat = "mean", func = "lin", 
                type = "absolute", refday = c(20, 5),
                cmissing = FALSE, cinterval = "day")
                
# View the output
head(auto)

# Plot the output
plotcor(auto, type = "A")                                   

## End(Not run)
       
</code></pre>

<hr>
<h2 id='Chaff'>Annual laying date of breeding common chaffinch (Fringilla coelebs).</h2><span id='topic+Chaff'></span>

<h3>Description</h3>

<p>Average annual laying date of common chaffinch (Fringilla coelebs)
measured over 47 years.
</p>


<h3>Format</h3>

<p>A data frame with 47 rows and 3 variables.
</p>

<dl>
<dt>Year</dt><dd><p>Year of laying date measurement.</p>
</dd>
<dt>Date</dt><dd><p>Average date of measurement.</p>
</dd>
<dt>Laydate</dt><dd><p>Average annual laying date in days after January 1st.</p>
</dd>
</dl>


<hr>
<h2 id='ChaffClim'>Daily climate data from 1965 to 2012.</h2><span id='topic+ChaffClim'></span>

<h3>Description</h3>

<p>Maximum daily temperature and average rainfall data 
from 1965 to 2012. Coincides with biological data 
from <code><a href="#topic+Chaff">Chaff</a></code>.
</p>


<h3>Format</h3>

<p>A data frame with 17,520 rows and 3 variables.
</p>

<dl>
<dt>Date</dt><dd><p>Date when climate was recorded (dd/mm/yyyy).</p>
</dd>
<dt>Rain</dt><dd><p>Average daily rainfall data in mm.</p>
</dd>
<dt>Temp</dt><dd><p>Maximum daily temperature in degrees centigrade.</p>
</dd>
</dl>


<hr>
<h2 id='crosswin'>Test the correlation between two climate variables.</h2><span id='topic+crosswin'></span>

<h3>Description</h3>

<p>Test the correlation between two climate variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosswin(
  xvar,
  xvar2,
  cdate,
  bdate,
  range,
  stat,
  stat2,
  type,
  refday,
  cinterval = "day",
  cmissing = FALSE,
  spatial = NULL,
  cohort = NULL,
  cutoff.day = NULL,
  cutoff.month = NULL,
  furthest = NULL,
  closest = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crosswin_+3A_xvar">xvar</code></td>
<td>
<p>The first climate variable of interest. Please specify the parent 
environment and variable name (e.g. Climate$Temp).</p>
</td></tr>
<tr><td><code id="crosswin_+3A_xvar2">xvar2</code></td>
<td>
<p>The second climate variable of interest. Please specify the parent 
environment and variable name (e.g. Climate$Temp).</p>
</td></tr>
<tr><td><code id="crosswin_+3A_cdate">cdate</code></td>
<td>
<p>The climate date variable (dd/mm/yyyy). Please specify the parent
environment and variable name (e.g. Climate$Date).</p>
</td></tr>
<tr><td><code id="crosswin_+3A_bdate">bdate</code></td>
<td>
<p>The biological date variable (dd/mm/yyyy). Please specify the 
parent environment and variable name (e.g. Biol$Date).</p>
</td></tr>
<tr><td><code id="crosswin_+3A_range">range</code></td>
<td>
<p>Two values signifying respectively the furthest and closest number 
of time intervals (set by cinterval) back from the cutoff date or biological record to include 
in the climate window search.</p>
</td></tr>
<tr><td><code id="crosswin_+3A_stat">stat</code></td>
<td>
<p>The aggregate statistic used to analyse the climate data. Can 
currently use basic R statistics (e.g. mean, min), as well as slope. 
Additional aggregate statistics can be created using the format function(x) 
(...). See FUN in <code><a href="base.html#topic+apply">apply</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="crosswin_+3A_stat2">stat2</code></td>
<td>
<p>Second aggregate statistic used to analyse climate data (xvar2). Can 
currently use basic R statistics (e.g. mean, min), as well as slope. 
Additional aggregate statistics can be created using the format function(x) 
(...). See FUN in <code><a href="base.html#topic+apply">apply</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="crosswin_+3A_type">type</code></td>
<td>
<p>&quot;absolute&quot; or &quot;relative&quot;, whether you wish the climate window to be relative
(e.g. the number of days before each biological record is measured) or absolute
(e.g. number of days before a set point in time).</p>
</td></tr>
<tr><td><code id="crosswin_+3A_refday">refday</code></td>
<td>
<p>If type is absolute, the day and month respectively of the 
year from which the absolute window analysis will start.</p>
</td></tr>
<tr><td><code id="crosswin_+3A_cinterval">cinterval</code></td>
<td>
<p>The resolution at which climate window analysis will be 
conducted. May be days (&quot;day&quot;), weeks (&quot;week&quot;), or months (&quot;month&quot;). Note the units 
of parameter 'range' will differ depending on the choice 
of cinterval</p>
</td></tr>
<tr><td><code id="crosswin_+3A_cmissing">cmissing</code></td>
<td>
<p>cmissing Determines what should be done if there are 
missing climate data. Three approaches are possible: 
- FALSE; the function will not run if missing climate data is encountered.
An object 'missing' will be returned containing the dates of missing climate.
- &quot;method1&quot;; missing climate data will be replaced with the mean climate
of the preceding and following 2 days.
- &quot;method2&quot;; missing climate data will be replaced with the mean climate
of all records on the same date.</p>
</td></tr>
<tr><td><code id="crosswin_+3A_spatial">spatial</code></td>
<td>
<p>A list item containing:
1. A factor that defines which spatial group (i.e. population) each biological
record is taken from. The length of this factor should correspond to the length 
of the biological dataset.
2. A factor that defines which spatial group (i.e. population) climate data
corresponds to. This length of this factor should correspond to the length of
the climate dataset.</p>
</td></tr>
<tr><td><code id="crosswin_+3A_cohort">cohort</code></td>
<td>
<p>A variable used to group biological records that occur in the same biological
season but cover multiple years (e.g. southern hemisphere breeding season). By default,
autowin will use year (extracted from parameter bdate) as the cohort variable. 
The cohort variable should be in the same dataset as the variable bdate.</p>
</td></tr>
<tr><td><code id="crosswin_+3A_cutoff.day">cutoff.day</code>, <code id="crosswin_+3A_cutoff.month">cutoff.month</code></td>
<td>
<p>Redundant parameters. Now replaced by refday.</p>
</td></tr>
<tr><td><code id="crosswin_+3A_furthest">furthest</code>, <code id="crosswin_+3A_closest">closest</code></td>
<td>
<p>Redundant parameters. Now replaced by range.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Will return a dataframe containing the correlation between the two
climate variables.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simple test example
#Create data from a subset of our test dataset
#Just use two years
biol_data &lt;- Mass[1:2, ]
clim_data &lt;- MassClimate[grep(pattern = "1979|1986", x = MassClimate$Date), ]
                   
cross &lt;- crosswin(xvar  = list(Temp = clim_data$Temp),
                 xvar2 = list(Rain = clim_data$Rain),
                 cdate = clim_data$Date, bdate = biol_data$Date,
                 range = c(1, 0), 
                 stat = "mean", stat2 = "mean",
                 type = "relative",
                 cmissing = FALSE, cinterval = "day")

## Not run: 
# Full working example
# Test correlation between temperature and rainfall in the MassClimate dataset.

data(Mass)
data(MassClimate)

cross &lt;- crosswin(xvar = list(Temp = MassClimate$Temp), 
                 xvar2 = list(Rain = MassClimate$Rain), 
                 cdate = MassClimate$Date, bdate = Mass$Date, 
                 range = c(365, 0),
                 stat = "mean", stat2 = "mean", type = "relative",
                 cmissing = FALSE, cinterval = "day")
                
# View the output
head(cross)

# Plot the output
plotcor(cross, type = "C")


## End(Not run)

</code></pre>

<hr>
<h2 id='explore'>Visualise the weight distribution for given parameter values</h2><span id='topic+explore'></span>

<h3>Description</h3>

<p>Create a plot of the Weibull or Generalised Extreme Values (GEV) distribution
for given values of shape, scale and location parameters. Used to determine 
initial parameter values for <code><a href="#topic+weightwin">weightwin</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>explore(shape = 1, scale = 1, loc = 0, weightfunc = "W")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="explore_+3A_shape">shape</code></td>
<td>
<p>A parameter that determines the shape of the distribution. 
Should be greater than 0.</p>
</td></tr>
<tr><td><code id="explore_+3A_scale">scale</code></td>
<td>
<p>A parameter that determines the scale of the distribution. 
Should be greater than 0.</p>
</td></tr>
<tr><td><code id="explore_+3A_loc">loc</code></td>
<td>
<p>A parameter that determines the location of the distribution. 
Should be less than or equal to 0.</p>
</td></tr>
<tr><td><code id="explore_+3A_weightfunc">weightfunc</code></td>
<td>
<p>Choose whether to use a weibull (&quot;W&quot;) or GEV (&quot;G&quot;)
distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>explore will return an example plot of the distribution using
given parameter values. This can be used to select the initial parameter 
values for <code><a href="#topic+weightwin">weightwin</a></code>
</p>


<h3>Author(s)</h3>

<p>Martijn van de Pol and Liam D. Bailey
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Test a weibull distribution

explore(shape = 3, scale = 0.2, loc = 0, weightfunc = "W")

# Test a GEV distribution

explore(shape = 3, scale = 5, loc = -5, weightfunc = "G")

</code></pre>

<hr>
<h2 id='Mass'>Chick body mass data since 1979.</h2><span id='topic+Mass'></span>

<h3>Description</h3>

<p>Artificially generated data representing
average body mass of bird chicks since 1979.
</p>


<h3>Format</h3>

<p>A data frame with 47 rows and 2 variables
</p>

<dl>
<dt>Date</dt><dd><p>Date of mass measurements (dd/mm/yyyy).</p>
</dd>
<dt>Mass</dt><dd><p>Annual average body mass in grams.</p>
</dd>
<dt>Age</dt><dd><p>Annual average age of mother in years.</p>
</dd>
</dl>


<hr>
<h2 id='MassClimate'>Daily climate data since 1979.</h2><span id='topic+MassClimate'></span>

<h3>Description</h3>

<p>Daily temperature and rainfall data since 1979.
</p>


<h3>Format</h3>

<p>A data frame with 17,532 rows and 3 variables.
</p>

<dl>
<dt>Date</dt><dd><p>Date when climate data was recorded (dd/mm/yyyy).</p>
</dd>
<dt>Rain</dt><dd><p>Daily rainfall data in mm.</p>
</dd>
<dt>Temp</dt><dd><p>Daily temperature data in degrees centigrade.</p>
</dd>
</dl>


<hr>
<h2 id='MassOutput'>Example output dataframe from function slidingwin.</h2><span id='topic+MassOutput'></span>

<h3>Description</h3>

<p>Output file from <code><a href="#topic+slidingwin">slidingwin</a></code> using temperature and body mass data. 
Generated with <code><a href="#topic+Mass">Mass</a></code> and <code><a href="#topic+MassClimate">MassClimate</a></code> dataframes.
</p>


<h3>Format</h3>

<p>A data frame with 5,151 rows and 19 variables.
</p>

<dl>
<dt>deltaAICc</dt><dd><p>Difference between model AICc of fitted climate window and a null model containing no climate.</p>
</dd>
<dt>WindowOpen</dt><dd><p>The start day of each tested climate window. Furthest from the biological record.</p>
</dd>
<dt>WindowClose</dt><dd><p>The end day of each tested climate window. Closest to the biological record.</p>
</dd>
<dt>ModelBeta</dt><dd><p>Beta estimate of the relationship between temperature and mass.</p>
</dd>
<dt>Std.Error</dt><dd><p>Standard error term for linear model betas.</p>
</dd>
<dt>ModelBetaQ</dt><dd><p>Quadratic beta estimate of the relationship between temperature and mass.</p>
</dd>
<dt>ModelBetaC</dt><dd><p>Cubic beta estimate of the relationship between temperature and mass.</p>
</dd>
<dt>ModelInt</dt><dd><p>Model intercept.</p>
</dd>     
<dt>Function</dt><dd><p>The function used to fit climate (e.g. linear (&quot;lin&quot;), quadratic (&quot;quad&quot;))</p>
</dd>
<dt>Furthest</dt><dd><p>Furthest day back considered in slidingwin.</p>
</dd>
<dt>Closest</dt><dd><p>Closest day back considered in slidingwin.</p>
</dd>
<dt>Statistics</dt><dd><p>The aggregate statistic used to analyse climate (e.g. mean, max, slope).</p>
</dd>
<dt>Type</dt><dd><p>Whether &quot;absolute&quot; or &quot;relative&quot; climate windows were tested.</p>
</dd>
<dt>K</dt><dd><p>Number of folds used for k-fold cross validation.</p>
</dd>
<dt>ModWeight</dt><dd><p>Model weight of each fitted climate window.</p>
</dd>
<dt>sample.size</dt><dd><p>Sample size (i.e. number of years or sites) used for climate window analysis.</p>
</dd>
<dt>Reference.day,Reference.month</dt><dd><p>If type is &quot;absolute&quot;, the date from which the climate window was tested.</p>
</dd>
<dt>Randomised</dt><dd><p>Whether the data was generated using <code><a href="#topic+slidingwin">slidingwin</a></code> or <code><a href="#topic+randwin">randwin</a></code>.</p>
</dd>
</dl>


<hr>
<h2 id='MassRand'>Example output dataframe from function randwin.</h2><span id='topic+MassRand'></span>

<h3>Description</h3>

<p>Output file from function <code><a href="#topic+randwin">randwin</a></code> using temperature and mass data. 
Generated with <code><a href="#topic+Mass">Mass</a></code> and <code><a href="#topic+MassClimate">MassClimate</a></code> dataframes.
</p>


<h3>Format</h3>

<p>A data frame with 5 rows and 21 variables.
</p>

<dl>
<dt>deltaAICc</dt><dd><p>Difference between model AICc of fitted climate window and a null model containing no climate.</p>
</dd>
<dt>WindowOpen</dt><dd><p>The start day of each tested climate window. Furthest from the biological record.</p>
</dd>
<dt>WindowClose</dt><dd><p>The end day of each tested climate window. Closest to the biological record.</p>
</dd>
<dt>ModelBeta</dt><dd><p>Beta estimate of the relationship between temperature and mass.</p>
</dd>
<dt>Std.Error</dt><dd><p>Standard error term for linear model betas.</p>
</dd>
<dt>ModelBetaQ</dt><dd><p>Quadratic beta estimate of the relationship between temperature and mass.</p>
</dd>
<dt>ModelBetaC</dt><dd><p>Cubic beta estimate of the relationship between temperature and mass.</p>
</dd>
<dt>ModelInt</dt><dd><p>Model intercept.</p>
</dd>     
<dt>Function</dt><dd><p>The function used to fit climate (e.g. linear (&quot;lin&quot;), quadratic (&quot;quad&quot;))</p>
</dd>
<dt>Furthest</dt><dd><p>Furthest day back considered in slidingwin.</p>
</dd>
<dt>Closest</dt><dd><p>Closest day back considered in slidingwin.</p>
</dd>
<dt>Statistics</dt><dd><p>The aggregate statistic used to analyse climate (e.g. mean, max, slope).</p>
</dd>
<dt>Type</dt><dd><p>Whether &quot;fixed&quot; or &quot;variable&quot; climate windows were tested.</p>
</dd>
<dt>K</dt><dd><p>Number of folds used for k-fold cross validation.</p>
</dd>
<dt>ModWeight</dt><dd><p>Model weight of each fitted climate window.</p>
</dd>
<dt>sample.size</dt><dd><p>Sample size (i.e. number of years or sites) used for climate window analysis.</p>
</dd>
<dt>Reference.day,Reference.month</dt><dd><p>If type is &quot;absolute&quot;, the date from which the climate window was tested.</p>
</dd>
<dt>Randomised</dt><dd><p>Whether the data was generated using <code><a href="#topic+slidingwin">slidingwin</a></code> or <code><a href="#topic+randwin">randwin</a></code>.</p>
</dd>
<dt>Repeat</dt><dd><p>The number of randomisations carried out.</p>
</dd>
<dt>WeightDist</dt><dd><p>Model spread of 95 percent confidence set of models.</p>
</dd>
</dl>


<hr>
<h2 id='medwin'>Determine the median start and end time for climate windows</h2><span id='topic+medwin'></span>

<h3>Description</h3>

<p>Determine the median start and end time for climate windows within
a chosen confidence set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>medwin(dataset, cw = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="medwin_+3A_dataset">dataset</code></td>
<td>
<p>Output dataframe of function <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="medwin_+3A_cw">cw</code></td>
<td>
<p>Cut-off for confidence set (0.95 by default)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns two values representing the median start and end
time of climate windows within the confidence set.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Determine median start and end time of MassOutput from the 95% confidence set

medwin(MassOutput, cw = 0.95)

</code></pre>

<hr>
<h2 id='merge_results'>Merge two slidingwin analyses.</h2><span id='topic+merge_results'></span>

<h3>Description</h3>

<p>Merges outputs of two separate slidingwin analyses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_results(dataset1, dataset2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_results_+3A_dataset1">dataset1</code>, <code id="merge_results_+3A_dataset2">dataset2</code></td>
<td>
<p>The slidingwin outputs to be merged. Note that all elements 
(i.e. Dataset, BestModel, BestModelData) will be merged and do not need to be specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object, identical to that produced by <code><a href="#topic+slidingwin">slidingwin</a></code>,
containing all records from both outputs.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simple test example
#Create data from a subset of our test dataset
#Just use two years
biol_data &lt;- Mass[1:2, ]
clim_data &lt;- MassClimate[grep(pattern = "1979|1986", x = MassClimate$Date), ]

output &lt;- slidingwin(xvar = list(Temp = clim_data$Temp),
                    cdate = clim_data$Date, 
                    bdate = biol_data$Date, 
                    baseline = lm(Mass ~ 1, data = biol_data),
                    range = c(1, 0), 
                    type = "relative", stat = "mean", 
                    func = c("lin"), cmissing = FALSE, cinterval = "day")

#Merge MassOutput
merge_results(output, output)

## Not run: 
 
data(Offspring) 
data(OffspringClimate)

# Test a linear functions

OffspringWin_lin &lt;- slidingwin(xvar = list(Temp = OffspringClimate$Temperature), 
                              cdate = OffspringClimate$Date, 
                              bdate = Offspring$Date, 
                              baseline = glm(Offspring ~ 1, data = Offspring, family = poisson),
                              range = c(150, 0), 
                              type = "relative", stat = "mean", 
                              func = c("lin"), cmissing = FALSE, cinterval = "day")

# Test a quadratic functions

OffspringWin_quad &lt;- slidingwin(xvar = list(Temp = OffspringClimate$Temperature), 
                               cdate = OffspringClimate$Date, 
                               bdate = Offspring$Date, 
                               baseline = glm(Offspring ~ 1, data = Offspring, family = poisson),
                               range = c(150, 0), 
                               type = "relative", stat = "mean", 
                               func = c("quad"), cmissing = FALSE, cinterval = "day")
                               
# Combine these outputs

OffspringWin_comb &lt;- merge_results(dataset1 = OffspringWin_lin, dataset2 = OffspringWin_quad)

#View analyses contained in the new output

OffspringWin_comb$combos

#View output from linear analysis

head(OffspringWin_comb[[1]]$Dataset)


## End(Not run)
       
</code></pre>

<hr>
<h2 id='Monthly_data'>Monthly temperature data</h2><span id='topic+Monthly_data'></span>

<h3>Description</h3>

<p>Artificially generated temperature data
at a monthly scale. Used for code testing.
</p>


<h3>Format</h3>

<p>A data frame with 576 rows and 2 variables
</p>

<dl>
<dt>Date</dt><dd><p>Date of temperature measurements (dd/mm/yyyy).</p>
</dd>
<dt>Temp</dt><dd><p>Mean monthly temperature</p>
</dd>
</dl>


<hr>
<h2 id='Offspring'>Reproductive success of birds since 2009.</h2><span id='topic+Offspring'></span>

<h3>Description</h3>

<p>Artificially generated data representing
reproductive success of birds since 2009.
</p>


<h3>Format</h3>

<p>A data frame with 1,619 rows and 5 variables.
</p>

<dl>
<dt>Offspring</dt><dd><p>Total number of offspring produced.</p>
</dd>
<dt>Date</dt><dd><p>Date of hatching (dd/mm/yyyy).</p>
</dd>
<dt>Order</dt><dd><p>Order of nest within each season.</p>
</dd>
<dt>BirdID</dt><dd><p>Individual ID of female.</p>
</dd>
<dt>Cohort</dt><dd><p>Grouping factor designating the breeding season
of each record.</p>
</dd>
</dl>


<hr>
<h2 id='OffspringClimate'>Daily climate data since 2009.</h2><span id='topic+OffspringClimate'></span>

<h3>Description</h3>

<p>Daily temperature and rainfall data since 2009.
Coincides with biological data from <code><a href="#topic+Offspring">Offspring</a></code>.
</p>


<h3>Format</h3>

<p>A data frame with 2,588 rows and 3 variables.
</p>

<dl>
<dt>Date</dt><dd><p>Date when climate was recorded (dd/mm/yyyy).</p>
</dd>
<dt>Rain</dt><dd><p>Daily rainfall data in mm.</p>
</dd>
<dt>Temperature</dt><dd><p>Daily temperature data in degrees centigrade.</p>
</dd>
</dl>


<hr>
<h2 id='plotall'>Visualise climate window data</h2><span id='topic+plotall'></span>

<h3>Description</h3>

<p>Creates a panel of plots to help visualise climate window data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotall(
  dataset,
  datasetrand = NULL,
  bestmodel = NULL,
  bestmodeldata = NULL,
  cw1 = 0.95,
  cw2 = 0.5,
  cw3 = 0.25,
  title = NULL,
  arrow = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotall_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe containing information on all fitted climate 
windows. Output from <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotall_+3A_datasetrand">datasetrand</code></td>
<td>
<p>A dataframe containing information on all fitted climate 
windows using randomised data. Output from <code><a href="#topic+randwin">randwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotall_+3A_bestmodel">bestmodel</code></td>
<td>
<p>A model object. The strongest climate window model. Returned 
from <code><a href="#topic+singlewin">singlewin</a></code> or <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotall_+3A_bestmodeldata">bestmodeldata</code></td>
<td>
<p>A dataframe containing the biological and climate data
used to fit the strongest climate window model. Output from
<code><a href="#topic+singlewin">singlewin</a></code> or <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotall_+3A_cw1">cw1</code>, <code id="plotall_+3A_cw2">cw2</code>, <code id="plotall_+3A_cw3">cw3</code></td>
<td>
<p>Cumulative weight levels used to visualise model weight 
distribution. See <code><a href="#topic+plotweights">plotweights</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="plotall_+3A_title">title</code></td>
<td>
<p>Title of the plot panel.</p>
</td></tr>
<tr><td><code id="plotall_+3A_arrow">arrow</code></td>
<td>
<p>TRUE or FALSE. Add arrows to plots to pinpoint best window.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Will return a panel of 6-8 plots:
</p>

<ul>
<li><p> DeltaAICc: A colour plot of model deltaAICc values (larger
negative values indicate stronger models). DeltaAICc is the difference
between AICc of each climate window model and the baseline model containing
no climate data.
</p>
</li>
<li><p> Model weight: A plot showing the distribution of cumulative
model weights. Gradient levels determined by parameters cw1, cw2 and cw3.
Darker areas have a higher chance of containing the best climate window.
Also returns the percentage of models within the 95
</p>
</li>
<li><p> Model betas: A colour plot of model beta estimates. Where applicable,
2nd order coefficients (quadratic) and 3rd order coefficients (cubic) will
be plotted separately.
</p>
</li>
<li><p> Histogram(s): If datasetrand is provided, plotall will return a 
histogram showing the deltaAICc of randomised data. 
This can help determine the likelihood of obtaining a deltaAICc value 
for a fitted climate window model at random. plotall will also use
<code><a href="#topic+pvalue">pvalue</a></code> to return values of Pc and PdeltaAICc.
</p>
</li>
<li><p> Boxplots: Two boxplots showing the start and end time for a 
subset of best climate windows. Best climate windows make up the
cumulative model weight equivalent to the largest value of cw1, cw2 and cw3.
Values above boxplots represent the median values.
</p>
</li>
<li><p> Best Model: If bestmodel and bestmodeldata are provided, plotall will 
create a scatterplot to show the fit of the best model through the data. </p>
</li></ul>



<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Visualise a fixed climate window generated for dataframes Mass and MassClimate

data(MassOutput)
data(Mass)
data(MassClimate)

single &lt;- singlewin(xvar = list(Temp = MassClimate$Temp), 
                   cdate = MassClimate$Date, bdate = Mass$Date, 
                   baseline = lm(Mass ~ 1, data = Mass), 
                   range = c(72, 15), 
                   stat = "mean", func = "lin", 
                   type = "absolute", refday = c(20, 5), 
                   cmissing = FALSE, cinterval = "day")
           
plotall(dataset = MassOutput, bestmodel = single$BestModel, 
       bestmodeldata = single$BestModelData,
       cw1 = 0.95, cw2 = 0.5, cw3 = 0.25, title = "Mass")
        
         
</code></pre>

<hr>
<h2 id='plotbest'>Visualise the best climate window</h2><span id='topic+plotbest'></span>

<h3>Description</h3>

<p>Create a scatterplot showing the fit of the best climate window model through
the biological data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotbest(dataset, bestmodel, bestmodeldata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotbest_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe containing information on all fitted climate 
windows. Output from <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotbest_+3A_bestmodel">bestmodel</code></td>
<td>
<p>A model object. The strongest climate window model. Output 
from <code><a href="#topic+singlewin">singlewin</a></code> or <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotbest_+3A_bestmodeldata">bestmodeldata</code></td>
<td>
<p>A dataframe with the data used to 
fit the strongest climate window model. Output from <code><a href="#topic+singlewin">singlewin</a></code> 
or <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a scatterplot with a fitted line to show the fit of the best 
model through the data.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Visualise the best climate window from the datasets Mass and MassClimate

data(MassOutput)
data(Mass)
data(MassClimate)

single &lt;- singlewin(xvar = list(Temp = MassClimate$Temp), 
                   cdate = MassClimate$Date, bdate = Mass$Date, 
                   baseline = lm(Mass ~ 1, data = Mass),
                   range = c(72, 15), 
                   stat = "mean", func = "lin", 
                   type = "absolute", refday = c(20, 5), 
                   cmissing = FALSE, cinterval = "day")
           
plotbest(dataset = MassOutput, bestmodel = single$BestModel,
        bestmodeldata = single$BestModelData)
             
</code></pre>

<hr>
<h2 id='plotbetas'>Plot model beta estimates</h2><span id='topic+plotbetas'></span>

<h3>Description</h3>

<p>Create colour plots of model beta estimates. Will include quadratic and cubic
beta estimates where appropriate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotbetas(dataset, arrow = FALSE, plotallenv, plotall = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotbetas_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe containing information on all fitted climate 
windows. Output from <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotbetas_+3A_arrow">arrow</code></td>
<td>
<p>TRUE or FALSE. Add arrows to plots to pinpoint best window.</p>
</td></tr>
<tr><td><code id="plotbetas_+3A_plotallenv">plotallenv</code></td>
<td>
<p>Used in conjunction with function <code><a href="#topic+plotall">plotall</a></code>.
Should not be changed manually.</p>
</td></tr>
<tr><td><code id="plotbetas_+3A_plotall">plotall</code></td>
<td>
<p>Used in conjunction with function <code><a href="#topic+plotall">plotall</a></code>. 
Should not be changed manually.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns colour plots of model beta estimates. Where applicable, 2nd 
order coefficients (quadratic) and 3rd order coefficients (cubic) will be 
plotted separately.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot model beta estimates for linear models in the Mass dataset

data(MassOutput)

plotbetas(dataset = MassOutput)

</code></pre>

<hr>
<h2 id='plotcor'>Visualise climate cross correlation or autocorrelation.</h2><span id='topic+plotcor'></span>

<h3>Description</h3>

<p>Create a colour plot to visualise the results of <code><a href="#topic+autowin">autowin</a></code> or
<code><a href="#topic+crosswin">crosswin</a></code>. Displays correlation across all desired climate
windows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotcor(cor.output, type, arrow = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotcor_+3A_cor.output">cor.output</code></td>
<td>
<p>Output of <code><a href="#topic+autowin">autowin</a></code> or
<code><a href="#topic+crosswin">crosswin</a></code></p>
</td></tr>
<tr><td><code id="plotcor_+3A_type">type</code></td>
<td>
<p>Should be either &quot;A&quot; for data generated by <code><a href="#topic+autowin">autowin</a></code>
or &quot;C&quot; for data generated by <code><a href="#topic+crosswin">crosswin</a></code>.</p>
</td></tr>
<tr><td><code id="plotcor_+3A_arrow">arrow</code></td>
<td>
<p>TRUE or FALSE. Add arrows to plots to pinpoint best window.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Will generate a colour plot to visualise the correlation data.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simple test example
#Create data from a subset of our test dataset
#Just use two years
biol_data &lt;- Mass[1:2, ]
clim_data &lt;- MassClimate[grep(pattern = "1979|1986", x = MassClimate$Date), ]

single &lt;- singlewin(xvar = list(Temp = clim_data$Temp),
                   cdate = clim_data$Date, 
                   bdate = biol_data$Date, 
                   baseline = lm(Mass ~ 1, data = biol_data),
                   range = c(1, 0), 
                   type = "relative", stat = "mean", 
                   func = c("lin"), cmissing = FALSE, cinterval = "day")
                   
auto &lt;- autowin(reference = single,
                xvar  = list(Temp = clim_data$Temp),
                cdate = clim_data$Date, bdate = biol_data$Date,
                baseline = lm(Mass ~ 1, data = biol_data), range = c(1, 0), 
                stat = "mean", func = "lin", 
                type = "relative",
                cmissing = FALSE, cinterval = "day")
                
plotcor(auto, type = "A")

## Not run: 
# Full working example
# Visualise climate autocorrelation

data(Mass)
data(MassClimate)

# Fit a single climate window using the datasets Mass and MassClimate.

single &lt;- singlewin(xvar = list(Temp = MassClimate$Temp), 
                   cdate = MassClimate$Date, bdate = Mass$Date,
                   baseline = lm(Mass ~ 1, data = Mass), 
                   range = c(72, 15),
                   stat = "mean", func = "lin",
                   type = "absolute", refday = c(20, 5),
                   cmissing = FALSE, cinterval = "day")            

# Test the autocorrelation between the climate in this single window and other climate windows.

auto &lt;- autowin(reference = single,
               xvar  = list(Temp = MassClimate$Temp), 
               cdate = MassClimate$Date, bdate = Mass$Date,
               baseline = lm(Mass ~ 1, data = Mass), 
               range = c(365, 0), 
               stat = "mean", func = "lin",
               type = "absolute", refday = c(20, 5),
               cmissing = FALSE, cinterval = "day")
                
# Plot the auto-correlation data

plotcor(auto, type = "A")

## End(Not run)
</code></pre>

<hr>
<h2 id='plotdelta'>Plot deltaAICc of models</h2><span id='topic+plotdelta'></span>

<h3>Description</h3>

<p>Create a colour plot of model deltaAICc values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotdelta(dataset, arrow = FALSE, plotall = FALSE, plotallenv, ThreeD = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotdelta_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe containing information on all fitted climate 
windows. Output from <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotdelta_+3A_arrow">arrow</code></td>
<td>
<p>TRUE or FALSE. Add arrows to plots to pinpoint best window.</p>
</td></tr>
<tr><td><code id="plotdelta_+3A_plotall">plotall</code></td>
<td>
<p>Used in conjunction with function <code><a href="#topic+plotall">plotall</a></code>. 
Should not be changed manually.</p>
</td></tr>
<tr><td><code id="plotdelta_+3A_plotallenv">plotallenv</code></td>
<td>
<p>Used in conjunction with function <code><a href="#topic+plotall">plotall</a></code>.
Should not be changed manually.</p>
</td></tr>
<tr><td><code id="plotdelta_+3A_threed">ThreeD</code></td>
<td>
<p>TRUE or FALSE. Generate a 3-dimensional plot of the deltaAICc landscape.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a colour plot of model deltaAICc values (larger negative
values indicate stronger models). DeltaAICc is the difference between AICc
of each climate window and a null model.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot deltaAICc estimates for climate windows in the Mass dataset

data(MassOutput)

plotdelta(dataset = MassOutput)
</code></pre>

<hr>
<h2 id='plothist'>Create a histogram of randomised deltaAICc values</h2><span id='topic+plothist'></span>

<h3>Description</h3>

<p>Create a histogram of deltaAICc values from randomised data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plothist(dataset, datasetrand)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plothist_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe containing information on all fitted climate
windows from observed data. Output from <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plothist_+3A_datasetrand">datasetrand</code></td>
<td>
<p>A dataframe containing information on all fitted climate 
windows using randomised data. Output from <code><a href="#topic+randwin">randwin</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plothist will return a histograms of deltaAICc values from 
randomised data. Values of PdeltaAICc and Pc will be provided to help 
determine the likelihood that an observed deltaAICc value would occur
by chance.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot randomised data for the Mass dataset

data(MassOutput)
data(MassRand)

plothist(datasetrand = MassRand, dataset = MassOutput)

</code></pre>

<hr>
<h2 id='plotweights'>Plot distribution of model weights</h2><span id='topic+plotweights'></span>

<h3>Description</h3>

<p>Create a plot showing the distribution of cumulative model weights for
all fitted climate windows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotweights(
  dataset,
  cw1 = 0.95,
  cw2 = 0.5,
  cw3 = 0.25,
  arrow = FALSE,
  plotall = FALSE,
  plotallenv,
  ThreeD = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotweights_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe containing information on all fitted climate 
windows. Output from <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotweights_+3A_cw1">cw1</code>, <code id="plotweights_+3A_cw2">cw2</code>, <code id="plotweights_+3A_cw3">cw3</code></td>
<td>
<p>Cumulative weight levels used to visualise model weight 
distribution. Cumulative weights represent the chance that the best model is
contained within a set. For example, there is a 95 percent chance that the best
climate window model is contained within the cumulative weight level of
0.95. Parameter values must &lt;= 1.</p>
</td></tr>
<tr><td><code id="plotweights_+3A_arrow">arrow</code></td>
<td>
<p>TRUE or FALSE. Add arrows to plots to pinpoint best window.</p>
</td></tr>
<tr><td><code id="plotweights_+3A_plotall">plotall</code></td>
<td>
<p>Used in conjunction with function <code><a href="#topic+plotall">plotall</a></code>. 
Should not be changed manually.</p>
</td></tr>
<tr><td><code id="plotweights_+3A_plotallenv">plotallenv</code></td>
<td>
<p>Used in conjunction with function <code><a href="#topic+plotall">plotall</a></code>.
Should not be changed manually.</p>
</td></tr>
<tr><td><code id="plotweights_+3A_threed">ThreeD</code></td>
<td>
<p>TRUE or FALSE. Generate a 3-dimensional plot of the model weight landscape.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a plot showing the distribution of cumulative model
weights. Levels determined by parameters cw1,cw2 and cw3.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot distribution of model weights for Mass dataset

data(MassOutput)

plotweights(dataset = MassOutput, cw1 = 0.95, cw2 = 0.75, cw3 = 0.25)
</code></pre>

<hr>
<h2 id='plotwin'>Plot the start and end time of best climate windows</h2><span id='topic+plotwin'></span>

<h3>Description</h3>

<p>Visualise the start and end time for a subset of best climate windows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotwin(dataset, cw = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotwin_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe containing information on all fitted climate
windows. Output from <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="plotwin_+3A_cw">cw</code></td>
<td>
<p>Cumulative model weight used to subset the group of best models.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates two boxplots showing the start and end time for a subset
of best climate windows. Best climate windows make up the
cumulative model weight equivalent to the value of cw.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'># View window limits for climate windows in the top 95% of model weights.

data(MassOutput)

plotwin(dataset = MassOutput, cw = 0.95)

</code></pre>

<hr>
<h2 id='pvalue'>Determine the probability that a given climate signal is 'true'.</h2><span id='topic+pvalue'></span>

<h3>Description</h3>

<p>Calculate probability that a given climate signal is 'true' using
either PDAICc or Pc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pvalue(dataset, datasetrand, metric, sample.size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pvalue_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe containing information on all fitted climate 
windows. Output from <code><a href="#topic+slidingwin">slidingwin</a></code>.</p>
</td></tr>
<tr><td><code id="pvalue_+3A_datasetrand">datasetrand</code></td>
<td>
<p>A dataframe containing information on all fitted climate 
windows using randomised data. Output from <code><a href="#topic+randwin">randwin</a></code>.</p>
</td></tr>
<tr><td><code id="pvalue_+3A_metric">metric</code></td>
<td>
<p>&quot;AIC&quot; or &quot;C&quot;. Determine whether a value of PDAICc or
Pc will be returned.</p>
</td></tr>
<tr><td><code id="pvalue_+3A_sample.size">sample.size</code></td>
<td>
<p>Sample size of analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a value representing the probability that a given climate 
window result is a false positive.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Calculate PDAICc for the Mass dataset

pvalue(datasetrand = MassRand, dataset = MassOutput, 
      metric = "AIC", sample.size = 47)
      
# Calculate Pc for the Mass dataset

pvalue(datasetrand = MassRand, dataset = MassOutput,
      metric = "C", sample.size = 47) 

</code></pre>

<hr>
<h2 id='randwin'>Climate window analysis for randomised data</h2><span id='topic+randwin'></span>

<h3>Description</h3>

<p>Randomises biological data and carries out a climate window analysis. Used
to help determine the chance of obtaining an observed result at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randwin(
  exclude = NA,
  repeats = 5,
  window = "sliding",
  xvar,
  cdate,
  bdate,
  baseline,
  stat,
  range,
  func,
  type,
  refday,
  cmissing = FALSE,
  cinterval = "day",
  spatial = NULL,
  cohort = NULL,
  upper = NA,
  lower = NA,
  binary = FALSE,
  centre = list(NULL, "both"),
  k = 0,
  weightfunc = "W",
  par = c(3, 0.2, 0),
  control = list(ndeps = c(0.01, 0.01, 0.01)),
  method = "L-BFGS-B",
  cutoff.day = NULL,
  cutoff.month = NULL,
  furthest = NULL,
  closest = NULL,
  thresh = NULL,
  cvk = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randwin_+3A_exclude">exclude</code></td>
<td>
<p>Two values (distance and duration) which allow users
to exclude short-duration long-lag climate windows from analysis (e.g., 
windows with a duration of 10 days which occur over a month ago).
These windows are often considered to be biologically implausible.</p>
</td></tr>
<tr><td><code id="randwin_+3A_repeats">repeats</code></td>
<td>
<p>The number of times that data will be randomised and analysed 
for climate windows.</p>
</td></tr>
<tr><td><code id="randwin_+3A_window">window</code></td>
<td>
<p>Whether randomisations are carried out for a sliding window (&quot;sliding&quot;)
or weighted window (&quot;weighted&quot;) approach.</p>
</td></tr>
<tr><td><code id="randwin_+3A_xvar">xvar</code></td>
<td>
<p>A list object containing all climate variables of interest. 
Please specify the parent environment and variable name (e.g. Climate$Temp).</p>
</td></tr>
<tr><td><code id="randwin_+3A_cdate">cdate</code></td>
<td>
<p>The climate date variable (dd/mm/yyyy). Please specify the parent
environment and variable name (e.g. Climate$Date).</p>
</td></tr>
<tr><td><code id="randwin_+3A_bdate">bdate</code></td>
<td>
<p>The biological date variable (dd/mm/yyyy). Please specify the 
parent environment and variable name (e.g. Biol$Date).</p>
</td></tr>
<tr><td><code id="randwin_+3A_baseline">baseline</code></td>
<td>
<p>The baseline model structure used for testing correlation. 
Currently known to support lm, glm, lmer and glmer objects.</p>
</td></tr>
<tr><td><code id="randwin_+3A_stat">stat</code></td>
<td>
<p>If window = &quot;sliding&quot;; The aggregate statistic used to analyse the climate data. Can 
currently use basic R statistics (e.g. mean, min), as well as slope. 
Additional aggregate statistics can be created using the format function(x)
(...). See FUN in <code><a href="base.html#topic+apply">apply</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="randwin_+3A_range">range</code></td>
<td>
<p>Two values signifying respectively the furthest and closest number 
of time intervals (set by cinterval) back from the cutoff date or biological record to include 
in the climate window search.</p>
</td></tr>
<tr><td><code id="randwin_+3A_func">func</code></td>
<td>
<p>The functions used to fit the climate variable. Can be linear 
(&quot;lin&quot;), quadratic (&quot;quad&quot;), cubic (&quot;cub&quot;), inverse (&quot;inv&quot;) or log (&quot;log&quot;).</p>
</td></tr>
<tr><td><code id="randwin_+3A_type">type</code></td>
<td>
<p>&quot;absolute&quot; or &quot;relative&quot;, whether you wish the climate window to be relative
(e.g. the number of days before each biological record is measured) or absolute
(e.g. number of days before a set point in time).</p>
</td></tr>
<tr><td><code id="randwin_+3A_refday">refday</code></td>
<td>
<p>If type is absolute, the day and month respectively of the 
year from which the absolute window analysis will start.</p>
</td></tr>
<tr><td><code id="randwin_+3A_cmissing">cmissing</code></td>
<td>
<p>cmissing Determines what should be done if there are 
missing climate data. Three approaches are possible: 
- FALSE; the function will not run if missing climate data is encountered.
An object 'missing' will be returned containing the dates of missing climate.
- &quot;method1&quot;; missing climate data will be replaced with the mean climate
of the preceding and following 2 days.
- &quot;method2&quot;; missing climate data will be replaced with the mean climate
of all records on the same date.</p>
</td></tr>
<tr><td><code id="randwin_+3A_cinterval">cinterval</code></td>
<td>
<p>The resolution at which climate window analysis will be 
conducted. May be days (&quot;day&quot;), weeks (&quot;week&quot;), or months (&quot;month&quot;). Note the units
of parameter 'range' will differ depending on the choice
of cinterval.</p>
</td></tr>
<tr><td><code id="randwin_+3A_spatial">spatial</code></td>
<td>
<p>A list item containing:
1. A factor that defines which spatial group (i.e. population) each biological
record is taken from. The length of this factor should correspond to the length 
of the biological dataset.
2. A factor that defines which spatial group (i.e. population) climate data
corresponds to. This length of this factor should correspond to the length of
the climate dataset.</p>
</td></tr>
<tr><td><code id="randwin_+3A_cohort">cohort</code></td>
<td>
<p>A variable used to group biological records that occur in the same biological
season but cover multiple years (e.g. southern hemisphere breeding season). Only required
when type is &quot;absolute&quot;. The cohort variable should be in the same dataset as the variable bdate.</p>
</td></tr>
<tr><td><code id="randwin_+3A_upper">upper</code></td>
<td>
<p>Cut-off values used to determine growing degree days or positive 
climate thresholds (depending on parameter thresh). Note that when values
of lower and upper are both provided, climatewin will instead calculate an 
optimal climate zone.</p>
</td></tr>
<tr><td><code id="randwin_+3A_lower">lower</code></td>
<td>
<p>Cut-off values used to determine chill days or negative 
climate thresholds (depending on parameter thresh). Note that when values
of lower and upper are both provided, climatewin will instead calculate an 
optimal climate zone.</p>
</td></tr>
<tr><td><code id="randwin_+3A_binary">binary</code></td>
<td>
<p>TRUE or FALSE. Determines whether to use values of upper and
lower to calculate binary climate data (thresh = TRUE), or to use for
growing degree days (thresh = FALSE).</p>
</td></tr>
<tr><td><code id="randwin_+3A_centre">centre</code></td>
<td>
<p>A list item containing:
1. The variable used for mean centring (e.g. Year, Site, Individual). 
Please specify the parent environment and variable name (e.g. Biol$Year).
2. Whether the model should include both within-group means and variance (&quot;both&quot;),
only within-group means (&quot;mean&quot;), or only within-group variance (&quot;dev&quot;).</p>
</td></tr>
<tr><td><code id="randwin_+3A_k">k</code></td>
<td>
<p>If window = &quot;sliding&quot;; the number of folds used for k-fold cross validation. By default
this value is set to 0, so no cross validation occurs. Value should be a
minimum of 2 for cross validation to occur.</p>
</td></tr>
<tr><td><code id="randwin_+3A_weightfunc">weightfunc</code></td>
<td>
<p>If window = &quot;weighted&quot;; 
the distribution to be used for optimisation. Can be 
either a Weibull (&quot;W&quot;) or Generalised Extreme Value distribution (&quot;G&quot;).</p>
</td></tr>
<tr><td><code id="randwin_+3A_par">par</code></td>
<td>
<p>If window = &quot;weighted&quot;; the shape, scale and location parameters 
of the Weibull or GEV weight function used as start weight function. 
For Weibull : Shape and scale parameters must be greater than 0, 
while location parameter must be less than or equal to 0. 
For GEV : Scale parameter must be greater than 0.</p>
</td></tr>
<tr><td><code id="randwin_+3A_control">control</code></td>
<td>
<p>If window = &quot;weighted&quot;;
parameters used to determine step size for the optimisation 
function. Please see <code><a href="stats.html#topic+optim">optim</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="randwin_+3A_method">method</code></td>
<td>
<p>If window = &quot;weighted&quot;; 
the method used for the optimisation function. Please see 
<code><a href="stats.html#topic+optim">optim</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="randwin_+3A_cutoff.day">cutoff.day</code>, <code id="randwin_+3A_cutoff.month">cutoff.month</code></td>
<td>
<p>Redundant parameters. Now replaced by refday.</p>
</td></tr>
<tr><td><code id="randwin_+3A_furthest">furthest</code>, <code id="randwin_+3A_closest">closest</code></td>
<td>
<p>Redundant parameters. Now replaced by range.</p>
</td></tr>
<tr><td><code id="randwin_+3A_thresh">thresh</code></td>
<td>
<p>Redundant parameter. Now replaced by binary.</p>
</td></tr>
<tr><td><code id="randwin_+3A_cvk">cvk</code></td>
<td>
<p>Redundant parameter. Now replaced by k.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe containing information on the best climate
window from each randomisation. See <code><a href="#topic+MassRand">MassRand</a></code> as an example.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simple test example
#Create data from a subset of our test dataset
#Just use two years
biol_data &lt;- Mass[1:2, ]
clim_data &lt;- MassClimate[grep(pattern = "1979|1986", x = MassClimate$Date), ]

rand &lt;- randwin(repeats = 1, xvar = list(Temp = clim_data$Temp),
               cdate = clim_data$Date, 
               bdate = biol_data$Date, 
               baseline = lm(Mass ~ 1, data = biol_data),
               range = c(1, 0), 
               type = "relative", stat = "mean", 
               func = c("lin"), cmissing = FALSE, cinterval = "day")

## Not run: 

# Full working examples

## EXAMPLE 1 ##

# Test climate windows in randomised data using a sliding window approach.

data(Mass)
data(MassClimate)

# Randomise data twice
# Note all other parameters are fitted in the same way as the climatewin function.

rand &lt;- randwin(repeats = 2, window = "sliding", 
               xvar = list(Temp = MassClimate$Temp), 
               cdate = MassClimate$Date, bdate = Mass$Date,
               baseline = lm(Mass ~ 1, data = Mass), 
               range = c(100, 0),
               stat = "mean", func = "lin", type = "absolute", 
               refday = c(20, 5),
               cmissing = FALSE, cinterval = "day")
                
# View output #

head(rand)

## EXAMPLE 2 ##

# Test climate windows in randomised data using a weighted window approach.
  
data(Offspring)
data(OffspringClimate)

# Randomise data twice
# Note all other parameters are fitted in the same way as the weightwin function.

weightrand &lt;- randwin(repeats = 2, window = "weighted", 
                     xvar = list(Temp = OffspringClimate$Temperature), 
                     cdate = OffspringClimate$Date,
                     bdate = Offspring$Date,
                     baseline = glm(Offspring ~ 1, family = poisson, data = Offspring),
                     range = c(365, 0), func = "quad",
                     type = "relative", weightfunc = "W", cinterval = "day",
                     par = c(3, 0.2, 0), control = list(ndeps = c(0.01, 0.01, 0.01)),
                     method = "L-BFGS-B")
                   
# View output

head(weightrand)
                          
       
## End(Not run)

</code></pre>

<hr>
<h2 id='singlewin'>Fit a single climate window</h2><span id='topic+singlewin'></span>

<h3>Description</h3>

<p>Fit a single climate window with a known start and end time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>singlewin(
  xvar,
  cdate,
  bdate,
  baseline,
  range,
  stat,
  func,
  type,
  refday,
  cmissing = FALSE,
  cinterval = "day",
  cohort = NULL,
  spatial = NULL,
  upper = NA,
  lower = NA,
  binary = FALSE,
  centre = list(NULL, "both"),
  cutoff.day = NULL,
  cutoff.month = NULL,
  furthest = NULL,
  closest = NULL,
  thresh = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="singlewin_+3A_xvar">xvar</code></td>
<td>
<p>A list object containing all climate variables of interest. 
Please specify the parent environment and variable name (e.g. Climate$Temp).</p>
</td></tr>
<tr><td><code id="singlewin_+3A_cdate">cdate</code></td>
<td>
<p>The climate date variable (dd/mm/yyyy). Please specify the parent
environment and variable name (e.g. Climate$Date).</p>
</td></tr>
<tr><td><code id="singlewin_+3A_bdate">bdate</code></td>
<td>
<p>The biological date variable (dd/mm/yyyy). Please specify the 
parent environment and variable name (e.g. Biol$Date).</p>
</td></tr>
<tr><td><code id="singlewin_+3A_baseline">baseline</code></td>
<td>
<p>The baseline model structure used for testing correlation. 
Currently known to support lm, glm, lmer and glmer objects.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_range">range</code></td>
<td>
<p>Two values signifying respectively the furthest and closest number 
of time intervals (set by cinterval) back from the cutoff date or biological record to include 
in the climate window search.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_stat">stat</code></td>
<td>
<p>The aggregate statistic used to analyse the climate data. Can 
currently use basic R statistics (e.g. mean, min), as well as slope. 
Additional aggregate statistics can be created using the format function(x)
(...). See FUN in <code><a href="base.html#topic+apply">apply</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_func">func</code></td>
<td>
<p>The functions used to fit the climate variable. Can be linear 
(&quot;lin&quot;), quadratic (&quot;quad&quot;), cubic (&quot;cub&quot;), inverse (&quot;inv&quot;) or log (&quot;log&quot;).</p>
</td></tr>
<tr><td><code id="singlewin_+3A_type">type</code></td>
<td>
<p>&quot;absolute&quot; or &quot;relative&quot;, whether you wish the climate window to be relative
(e.g. the number of days before each biological record is measured) or absolute
(e.g. number of days before a set point in time).</p>
</td></tr>
<tr><td><code id="singlewin_+3A_refday">refday</code></td>
<td>
<p>If type is absolute, the day and month respectively of the 
year from which the absolute window analysis will start.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_cmissing">cmissing</code></td>
<td>
<p>cmissing Determines what should be done if there are 
missing climate data. Three approaches are possible: 
- FALSE; the function will not run if missing climate data is encountered.
An object 'missing' will be returned containing the dates of missing climate.
- &quot;method1&quot;; missing climate data will be replaced with the mean climate
of the preceding and following 2 days.
- &quot;method2&quot;; missing climate data will be replaced with the mean climate
of all records on the same date.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_cinterval">cinterval</code></td>
<td>
<p>The resolution at which climate window analysis will be 
conducted. May be days (&quot;day&quot;), weeks (&quot;week&quot;), or months (&quot;month&quot;). Note the units
of parameter 'range' will differ depending on the choice
of cinterval.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_cohort">cohort</code></td>
<td>
<p>A variable used to group biological records that occur in the same biological
season but cover multiple years (e.g. southern hemisphere breeding season). Only required
when type is &quot;absolute&quot;. The cohort variable should be in the same dataset as the variable bdate.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_spatial">spatial</code></td>
<td>
<p>A list item containing:
1. A factor that defines which spatial group (i.e. population) each biological
record is taken from. The length of this factor should correspond to the length 
of the biological dataset.
2. A factor that defines which spatial group (i.e. population) climate data
corresponds to. This length of this factor should correspond to the length of
the climate dataset.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_upper">upper</code></td>
<td>
<p>Cut-off values used to determine growing degree days or positive 
climate thresholds (depending on parameter thresh). Note that when values
of lower and upper are both provided, climatewin will instead calculate an 
optimal climate zone.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_lower">lower</code></td>
<td>
<p>Cut-off values used to determine chill days or negative 
climate thresholds (depending on parameter thresh). Note that when values
of lower and upper are both provided, climatewin will instead calculate an 
optimal climate zone.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_binary">binary</code></td>
<td>
<p>TRUE or FALSE. Determines whether to use values of upper and
lower to calculate binary climate data (thresh = TRUE), or to use for
growing degree days (thresh = FALSE).</p>
</td></tr>
<tr><td><code id="singlewin_+3A_centre">centre</code></td>
<td>
<p>A list item containing:
1. The variable used for mean centring (e.g. Year, Site, Individual). 
Please specify the parent environment and variable name (e.g. Biol$Year).
2. Whether the model should include both within-group means and variance (&quot;both&quot;),
only within-group means (&quot;mean&quot;), or only within-group variance (&quot;dev&quot;).</p>
</td></tr>
<tr><td><code id="singlewin_+3A_cutoff.day">cutoff.day</code>, <code id="singlewin_+3A_cutoff.month">cutoff.month</code></td>
<td>
<p>Redundant parameters. Now replaced by refday.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_furthest">furthest</code>, <code id="singlewin_+3A_closest">closest</code></td>
<td>
<p>Redundant parameters. Now replaced by range.</p>
</td></tr>
<tr><td><code id="singlewin_+3A_thresh">thresh</code></td>
<td>
<p>Redundant parameter. Now replaced by binary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Will return a list containing two objects:
</p>

<ul>
<li><p> BestModel, a model object of the fitted climate window
model.
</p>
</li>
<li><p> BestModelData, a dataframe with the biological and climate data
used to fit the climate window model.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simple test example
#Create data from a subset of our test dataset
#Just use two years
biol_data &lt;- Mass[1:2, ]
clim_data &lt;- MassClimate[grep(pattern = "1979|1986", x = MassClimate$Date), ]

single &lt;- singlewin(xvar = list(Temp = clim_data$Temp),
                   cdate = clim_data$Date, 
                   bdate = biol_data$Date, 
                   baseline = lm(Mass ~ 1, data = biol_data),
                   range = c(1, 0), 
                   type = "relative", stat = "mean", 
                   func = c("lin"), cmissing = FALSE, cinterval = "day")

## Not run: 
# Full working example
# Fit a known climate window to the datasets Mass and MassClimate

data(Mass)
data(MassClimate)

# Test for a fixed climate window, starting from 20th May
# Fit a climate window starting 72 days ago and ending 15 days ago
# Fit a linear term for the mean climate
# Fit climate windows at the resolution of days

single &lt;- singlewin(xvar = list(Temp = MassClimate$Temp), 
                   cdate = MassClimate$Date, bdate = Mass$Date,
                   baseline = lm(Mass ~ 1, data = Mass), 
                   range = c(72, 15),
                   stat = "mean", func = "lin",
                   type = "absolute", refday = c(20, 5),
                   cmissing = FALSE, cinterval = "day")
               
##View data##
single$BestModel
head(single$BestModelData)

## End(Not run)

</code></pre>

<hr>
<h2 id='Size'>Average size of red winged fairy wren (Malurus elegans) chicks.</h2><span id='topic+Size'></span>

<h3>Description</h3>

<p>Average size (using standardised measures of tarsus length,
head-bill length and wing length) in red winged fairy wren
(Malurus elegans) chicks. Measured over 7 years.
</p>


<h3>Format</h3>

<p>A data frame with 1,003 rows and 5 variables.
</p>

<dl>
<dt>NestID</dt><dd><p>Unique nest identifier.</p>
</dd>
<dt>Cohort</dt><dd><p>Year of breeding season.</p>
</dd>
<dt>Helpers</dt><dd><p>Total number of non-breeding helpers at the nest.</p>
</dd>
<dt>Size</dt><dd><p>Average offspring size.</p>
</dd>
<dt>Date</dt><dd><p>Date when offspring size was recorded (dd/mm/yyyy).</p>
</dd>
</dl>


<hr>
<h2 id='SizeClimate'>Daily climate data from 2006 to 2015.</h2><span id='topic+SizeClimate'></span>

<h3>Description</h3>

<p>Average, maximum and minimum daily temperature data, average rainfall data 
from 2006 to 2015. 
Coincides with biological data from <code><a href="#topic+Size">Size</a></code>.
</p>


<h3>Format</h3>

<p>A data frame with 3,411 rows and 5 variables.
</p>

<dl>
<dt>Date</dt><dd><p>Date when climate was recorded (dd/mm/yyyy).</p>
</dd>
<dt>Rain</dt><dd><p>Average daily rainfall data in mm.</p>
</dd>
<dt>Temperature</dt><dd><p>Average daily temperature data in degrees centigrade.</p>
</dd>
<dt>MaxTemp</dt><dd><p>Maximum daily temperature in degrees centigrade.</p>
</dd>
<dt>MinTemp</dt><dd><p>Minimum daily temperature in degrees centigrade.</p>
</dd>
</dl>


<hr>
<h2 id='slidingwin'>Test for a climate windows in data.</h2><span id='topic+slidingwin'></span>

<h3>Description</h3>

<p>Finds the time period when a biological variable is most strongly affected 
by climate. Note that climate data and biological data should be loaded as 
two separate objects. Both objects should contain a date column to designate
when the data were recorded (dd/mm/yyyy).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slidingwin(
  exclude = NA,
  xvar,
  cdate,
  bdate,
  baseline,
  type,
  refday,
  stat = "mean",
  func = "lin",
  range,
  cmissing = FALSE,
  cinterval = "day",
  k = 0,
  upper = NA,
  lower = NA,
  binary = FALSE,
  centre = list(NULL, "both"),
  spatial = NULL,
  cohort = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slidingwin_+3A_exclude">exclude</code></td>
<td>
<p>Two values (duration and distance) which allow users
to exclude short-duration long-lag climate windows from analysis (e.g., 
windows with a duration of 10 days which occur over a month ago).
These windows are often considered to be biologically implausible.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_xvar">xvar</code></td>
<td>
<p>A list object containing all climate variables of interest. 
Please specify the parent environment and variable name (e.g. climate$Temp).</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_cdate">cdate</code></td>
<td>
<p>The climate date variable (dd/mm/yyyy). Please specify the 
parent environment and variable name (e.g. climate$Date).</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_bdate">bdate</code></td>
<td>
<p>The biological date variable (dd/mm/yyyy). Please specify the 
parent environment and variable name (e.g. Biol$Date).</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_baseline">baseline</code></td>
<td>
<p>The baseline model structure used for model testing. 
Currently known to support lm, glm, lmer, glmer and coxph objects.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_type">type</code></td>
<td>
<p>&quot;absolute&quot; or &quot;relative&quot;, whether you wish the climate window to be relative
(e.g. the number of days before each biological record is measured) or absolute
(e.g. number of days before a set point in time).</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_refday">refday</code></td>
<td>
<p>If type is &quot;absolute&quot;, the day and month respectively of the 
year from which the absolute window analysis will start.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_stat">stat</code></td>
<td>
<p>The aggregate statistics used to analyse the climate data. Can 
currently use basic R statistics (e.g. mean, min), as well as slope. 
Additional aggregate statistics can be created using the format 
function(x) (...). See FUN in <code><a href="base.html#topic+apply">apply</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_func">func</code></td>
<td>
<p>The functions used to fit the climate variable. Can be linear 
(&quot;lin&quot;), quadratic (&quot;quad&quot;), cubic (&quot;cub&quot;), inverse (&quot;inv&quot;) or log (&quot;log&quot;).</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_range">range</code></td>
<td>
<p>Two values signifying respectively the furthest and closest number 
of time intervals (set by cinterval) back from the refday or biological record to include 
in the climate window search.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_cmissing">cmissing</code></td>
<td>
<p>Determines what should be done if there are 
missing climate data. Three approaches are possible: 
- FALSE; the function will not run if missing climate data is encountered.
An object 'missing' will be returned containing the dates of missing climate.
- &quot;method1&quot;; missing climate data will be replaced with the mean climate
of the preceding and following 2 records.
- &quot;method2&quot;; missing climate data will be replaced with the mean climate
of all records on the same date.
</p>
<p>Note: Other methods are possible. Users should consider those methods most
appropriate for their data and apply them manually before using climwin if
required.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_cinterval">cinterval</code></td>
<td>
<p>The resolution at which climate window analysis will be 
conducted. May be days (&quot;day&quot;), weeks (&quot;week&quot;), or months (&quot;month&quot;). Note the units
of parameter 'range' will differ depending on the choice
of cinterval.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_k">k</code></td>
<td>
<p>The number of folds used for k-fold cross validation. By default
this value is set to 0, so no cross validation occurs. Value should be a
minimum of 2 for cross validation to occur.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_upper">upper</code></td>
<td>
<p>Cut-off values used to determine growing degree days or positive 
climate thresholds (depending on parameter thresh). Note that when values
of lower and upper are both provided, slidingwin will instead calculate an 
optimal climate zone.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_lower">lower</code></td>
<td>
<p>Cut-off values used to determine chill days or negative 
climate thresholds (depending on parameter thresh). Note that when values
of lower and upper are both provided, slidingwin will instead calculate an 
optimal climate zone.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_binary">binary</code></td>
<td>
<p>TRUE or FALSE. Determines whether to use values of upper and
lower to calculate binary climate data (binary = TRUE), or to use for
growing degree days (binary = FALSE).</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_centre">centre</code></td>
<td>
<p>A list item containing:
1. The variable used for mean centring (e.g. Year, Site, Individual). 
Please specify the parent environment and variable name (e.g. Biol$Year).
2. Whether the model should include both within-group means and variance (&quot;both&quot;),
only within-group means (&quot;mean&quot;), or only within-group variance (&quot;var&quot;).</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_spatial">spatial</code></td>
<td>
<p>A list item containing:
1. A factor that defines which spatial group (i.e. population) each biological
record is taken from. The length of this factor should correspond to the length 
of the biological dataset.
2. A factor that defines which spatial group (i.e. population) climate data
corresponds to. This length of this factor should correspond to the length of
the climate dataset.</p>
</td></tr>
<tr><td><code id="slidingwin_+3A_cohort">cohort</code></td>
<td>
<p>A variable used to group biological records that occur in the same biological
season but cover multiple years (e.g. southern hemisphere breeding season). Only required
when type is &quot;absolute&quot;. The cohort variable should be in the same dataset as the variable bdate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that slidingwin allows you to test multiple possible parameters with the
same code (e.g. func, stat, xvar). See examples for more detail.
</p>


<h3>Value</h3>

<p>Will return a list with an output for each tested set of climate
window parameters. Each list item contains three objects:
</p>

<ul>
<li><p> BestModel, a model object. The strongest climate window model based on AICc. 
</p>
</li>
<li><p> BestModelData, a dataframe used to fit the strongest climate window model.
</p>
</li>
<li><p> Dataset, a dataframe with information on all fitted climate windows. 
Ordered using deltaAICc, with most negative deltaAICc values first. 
See <code><a href="#topic+MassOutput">MassOutput</a></code> as an example.</p>
</li></ul>

<p>In addition, the returned list includes an object 'combos', a summary of all
tested sets of climate window parameters.
</p>


<h3>Author(s)</h3>

<p>Liam D. Bailey and Martijn van de Pol
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simple test example
#Create data from a subset of our test dataset
#Just use two years
biol_data &lt;- Mass[1:2, ]
clim_data &lt;- MassClimate[grep(pattern = "1979|1986", x = MassClimate$Date), ]

output &lt;- slidingwin(xvar = list(Temp = clim_data$Temp),
                    cdate = clim_data$Date, 
                    bdate = biol_data$Date, 
                    baseline = lm(Mass ~ 1, data = biol_data),
                    range = c(1, 0), 
                    type = "relative", stat = "mean", 
                    func = c("lin"), cmissing = FALSE, cinterval = "day")

## Not run: 

# Full working examples

##EXAMPLE 1## 
 
# Test both a linear and quadratic variable climate window using datasets "Offspring"
# and "OffspringClimate".

# Load data.

data(Offspring) 
data(OffspringClimate)

# Test both linear and quadratic functions with climate variable temperature

OffspringWin &lt;- slidingwin(xvar = list(Temp = OffspringClimate$Temperature), 
                          cdate = OffspringClimate$Date, 
                          bdate = Offspring$Date, 
                          baseline = glm(Offspring ~ 1, data = Offspring, family = poisson),
                          range = c(150, 0), 
                          type = "relative", stat = "mean", 
                          func = c("lin", "quad"), cmissing = FALSE, cinterval = "day")

# Examine tested combinations
 
OffspringWin$combos
     
# View output for func = "lin"
 
head(OffspringWin[[1]]$Dataset) 
summary(OffspringWin[[1]]$BestModel)
 
# View output for func = "quad"
 
head(OffspringWin[[2]]$Dataset)
summary(OffspringWin[[2]]$BestModel)
 
##EXAMPLE 2##
 
# Test for an absolute climate window with both 'mean' and 'max' aggregate statistics
# using datasets 'Mass' and 'MassClimate'.
 
# Load data.
 
data(Mass)
data(MassClimate)
 
# Test an absolute window, starting 20 May (refday = c(20, 5))
# Test for climate windows between 100 and 0 days ago (range = c(100, 0))
# Test both mean and max aggregate statistics (stat = c("mean", "max"))
# Fit a linear term (func = "lin")
# Test at the resolution of days (cinterval = "day")
 
MassWin &lt;- slidingwin(xvar = list(Temp = MassClimate$Temp), cdate = MassClimate$Date, 
                     bdate = Mass$Date, baseline = lm(Mass ~ 1, data = Mass),
                     range = c(100, 0),
                     stat = c("mean", "max"), func = "lin",
                     type = "absolute", refday = c(20, 5),
                     cmissing = FALSE, cinterval = "day")
                       
# Examine tested combinations
 
MassWin$combos                      
 
# View output for mean temperature
 
head(MassWin[[1]]$Dataset)
summary(MassWin[[1]]$BestModel)
 
# View output for max temperature
 
head(MassWin[[2]]$Dataset)
summary(MassWin[[2]]$BestModel)
 

## End(Not run)
 
</code></pre>

<hr>
<h2 id='weightwin'>Find a weighted climate window</h2><span id='topic+weightwin'></span>

<h3>Description</h3>

<p>Finds the best weighted average of a weather variable over a period that 
correlates most strongly with a biological variable. Uses weibull or 
Generalised Extreme Value (GEV) distribution. See references for a full 
description.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightwin(
  n = 1,
  xvar,
  cdate,
  bdate,
  baseline,
  range,
  k = 0,
  func = "lin",
  type,
  refday,
  nrandom = 0,
  centre = NULL,
  weightfunc = "W",
  cinterval = "day",
  cmissing = FALSE,
  cohort = NULL,
  spatial = NULL,
  par = c(3, 0.2, 0),
  control = list(ndeps = c(0.001, 0.001, 0.001)),
  method = "L-BFGS-B",
  cutoff.day = NULL,
  cutoff.month = NULL,
  furthest = NULL,
  closest = NULL,
  grad = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightwin_+3A_n">n</code></td>
<td>
<p>The number of iterations used to run weightwin. If n &gt; 1, iterations 
will use randomly generated starting parameters. These are stored in the 
output data frame 'iterations'.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_xvar">xvar</code></td>
<td>
<p>A list object containing all climate variables of interest. 
Please specify the parent environment and variable name (e.g. Climate$Temp).</p>
</td></tr>
<tr><td><code id="weightwin_+3A_cdate">cdate</code></td>
<td>
<p>The climate date variable. Please specify the parent environment 
and variable name (e.g. Climate$Date).</p>
</td></tr>
<tr><td><code id="weightwin_+3A_bdate">bdate</code></td>
<td>
<p>The biological date variable. Please specify the parent 
environment and variable name (e.g. Biol$Date).</p>
</td></tr>
<tr><td><code id="weightwin_+3A_baseline">baseline</code></td>
<td>
<p>The baseline model structure used for testing correlation. 
Currently known to support lm, lme, glm and glmer objects.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_range">range</code></td>
<td>
<p>Two values signifying respectively the furthest and closest number 
of time intervals (set by cinterval) back from the cutoff date or biological record to include 
in the climate window search.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_k">k</code></td>
<td>
<p>The number of folds used for k-fold cross validation. By default
this value is set to 0, so no cross validation occurs. Value should be a
minimum of 2 for cross validation to occur.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_func">func</code></td>
<td>
<p>The function used to fit the climate variable in the model. Can be
linear (&quot;lin&quot;), quadratic (&quot;quad&quot;), cubic (&quot;cub&quot;), inverse (&quot;inv&quot;) or log (&quot;log&quot;).</p>
</td></tr>
<tr><td><code id="weightwin_+3A_type">type</code></td>
<td>
<p>&quot;absolute&quot; or &quot;relative&quot;, whether you wish the climate window to be relative
(e.g. the number of days before each biological record is measured) or absolute
(e.g. number of days before a set point in time).</p>
</td></tr>
<tr><td><code id="weightwin_+3A_refday">refday</code></td>
<td>
<p>If type is absolute, the day and month respectively of the 
year from which the absolute window analysis will start.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_nrandom">nrandom</code></td>
<td>
<p>Used when conducting data randomisation, should not be
changed manually.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_centre">centre</code></td>
<td>
<p>A list item containing:
1. The variable used for mean centring (e.g. Year, Site, Individual). 
Please specify the parent environment and variable name (e.g. Biol$Year).
2. Whether the model should include both within-group means and variance (&quot;both&quot;),
only within-group means (&quot;mean&quot;), or only within-group variance (&quot;var&quot;).</p>
</td></tr>
<tr><td><code id="weightwin_+3A_weightfunc">weightfunc</code></td>
<td>
<p>The distribution to be used for optimisation. Can be 
either a Weibull (&quot;W&quot;) or Generalised Extreme Value distribution (&quot;G&quot;).</p>
</td></tr>
<tr><td><code id="weightwin_+3A_cinterval">cinterval</code></td>
<td>
<p>The resolution at which the climate window analysis will be 
conducted. May be days (&quot;day&quot;), weeks (&quot;week&quot;), or months (&quot;month&quot;). Note the units 
of parameter 'range' will differ depending on the choice 
of cinterval.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_cmissing">cmissing</code></td>
<td>
<p>Determines what should be done if there are 
missing climate data. Three approaches are possible: 
- FALSE; the function will not run if missing climate data is encountered.
An object 'missing' will be returned containing the dates of missing climate.
- &quot;method1&quot;; missing climate data will be replaced with the mean climate
of the preceding and following 2 records.
- &quot;method2&quot;; missing climate data will be replaced with the mean climate
of all records on the same date.
</p>
<p>Note: Other methods are possible. Users should consider those methods most
appropriate for their data and apply them manually before using climwin if
required.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_cohort">cohort</code></td>
<td>
<p>A variable used to group biological records that occur in the same biological
season but cover multiple years (e.g. southern hemisphere breeding season). Only required
when type is &quot;absolute&quot;. The cohort variable should be in the same dataset as the variable bdate.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_spatial">spatial</code></td>
<td>
<p>A list item containing:
1. A factor that defines which spatial group (i.e. population) each biological
record is taken from. The length of this factor should correspond to the length 
of the biological dataset.
2. A factor that defines which spatial group (i.e. population) climate data
corresponds to. This length of this factor should correspond to the length of
the climate dataset.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_par">par</code></td>
<td>
<p>Shape, scale and location parameters of the Weibull or GEV weight 
function used as start weight function. For Weibull : Shape and scale 
parameters must be greater than 0, while location parameter must be less 
than or equal to 0. For GEV : Scale parameter must be greater than 0.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_control">control</code></td>
<td>
<p>Parameters used to determine step size for the optimisation 
function. Please see <code><a href="stats.html#topic+optim">optim</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_method">method</code></td>
<td>
<p>The method used for the optimisation function. Please see 
<code><a href="stats.html#topic+optim">optim</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_cutoff.day">cutoff.day</code>, <code id="weightwin_+3A_cutoff.month">cutoff.month</code></td>
<td>
<p>Redundant parameters. Now replaced by refday.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_furthest">furthest</code>, <code id="weightwin_+3A_closest">closest</code></td>
<td>
<p>Redundant parameters. Now replaced by range.</p>
</td></tr>
<tr><td><code id="weightwin_+3A_grad">grad</code></td>
<td>
<p>Run the optimisation procedure with a numerically derived gradient function.
This can improve model convergence but will increase computational time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a constantly updating grid of plots as the optimisation 
function is running. 
</p>
 
<ul>
<li><p> Right panel from top to bottom: The
three parameters (shape, scale and location) determining the weight 
function.
</p>
</li>
<li><p> Left top panel: The resulting weight function.
</p>
</li>
<li><p> Left middle panel: The delta AICc compared to the baseline model.
</p>
</li>
<li><p> Left bottom panel: Plotted relationship between the weighted mean of climate 
and the biological response variable.</p>
</li></ul>

<p>Also returns a list containing three objects: </p>
 
<ul>
<li><p> BestModel, a model object. The best weighted window model determined
by deltaAICc.
</p>
</li>
<li><p> BestModelData, a dataframe. Biological and climate data used to fit
the best weighted window model.
</p>
</li>
<li><p> WeightedOutput. Parameter values for the best weighted window.
</p>
</li>
<li><p> iterations. If n &gt; 1, the starting parameters and deltaAICc values
from each iteration of weightwin.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Martijn van de Pol and Liam D. Bailey
</p>


<h3>References</h3>

<p>van de Pol &amp; Cockburn 2011 Am Nat 177(5):698-707 (doi: 
10.1086/659101) &quot;Identifying the critical climatic time window that affects 
trait expression&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simple test example
#Create data from a subset of our test dataset
biol_data &lt;- Mass[1:5, ]
data(MassClimate)


weight &lt;- weightwin(xvar = list(Temp = MassClimate$Temp), 
                   cdate = MassClimate$Date, 
                   bdate = biol_data$Date, 
                   baseline = glm(Mass ~ 1, data = biol_data), 
                   range = c(100, 0), func = "lin", 
                   type = "relative", weightfunc = "W", cinterval = "day", 
                   par = c(2.26, 8.45, 0), control = list(ndeps = c(0.01, 0.01, 0.01)), 
                   method = "L-BFGS-B")
                   

## Not run: 

# Full working example
 
# Test for a weighted average over a fixed climate window 
# using datasets 'Offspring' and 'OffspringClimate'
 
# N.B. THIS EXAMPLE MAY TAKE A MOMENT TO CONVERGE ON THE BEST MODEL.
 
# Load data
 
data(Offspring)
data(OffspringClimate)
 
# Test for climate windows between 365 and 0 days ago (range = c(365, 0))
# Fit a quadratic term for the mean weighted climate (func="quad")
# in a Poisson regression (offspring number ranges 0-3)
# Test a variable window (type = "absolute")
# Test at the resolution of days (cinterval="day")
# Uses a Weibull weight function (weightfunc="week")
 
weight &lt;- weightwin(xvar = list(Temp = OffspringClimate$Temperature), 
                   cdate = OffspringClimate$Date, 
                   bdate = Offspring$Date, 
                   baseline = glm(Offspring ~ 1, family = poisson, data = Offspring), 
                   range = c(365, 0), func = "quad", 
                   type = "relative", weightfunc = "W", cinterval = "day", 
                   par = c(3, 0.2, 0), control = list(ndeps = c(0.01, 0.01, 0.01)), 
                   method = "L-BFGS-B") 
 
# View output
 
head(weight[[3]])
summary(weight[[1]])
head(weight[[2]])
 
## End(Not run)

</code></pre>

<hr>
<h2 id='wgdev'>Calculate within group deviance.</h2><span id='topic+wgdev'></span>

<h3>Description</h3>

<p>Calculate within group deviance of a variable. Used to test for 'within individual effects'.
See methods outlined in van de Pol and Wright 2009 for more detail.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wgdev(covar, groupvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wgdev_+3A_covar">covar</code></td>
<td>
<p>Continuous variable for which within group deviance will be calculated.
Please specify the dataset in which the variable is found (i.e. data$var).</p>
</td></tr>
<tr><td><code id="wgdev_+3A_groupvar">groupvar</code></td>
<td>
<p>Grouping variable within which deviance will be calculated.
For example, individual ID or site/plot ID. Please specify the dataset in which
the variable is found (i.e. data$var).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector containing numeric values. This can be used to
differentiate within and between group effects in a model. 
See function <code><a href="#topic+wgmean">wgmean</a></code> to calculate within group means.
See van de Pol and Wright 2009 for more detail.
</p>


<h3>Author(s)</h3>

<p>Martijn van de Pol and Jonathan Wright
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate within year deviance in temperature from the MassClimate dataset.  

data(MassClimate)

#Calculate year column
library(lubridate)
MassClimate$Year &lt;- year(as.Date(MassClimate$Date, format = "%d/%m/%Y"))

#Calculate within year deviance of temperature
within_yr_dev &lt;- wgdev(MassClimate$Temp, MassClimate$Year)

#Add this variable to the original dataset
MassClimate$Within_yr_dev &lt;- within_yr_dev
             
</code></pre>

<hr>
<h2 id='wgmean'>Calculate within group means.</h2><span id='topic+wgmean'></span>

<h3>Description</h3>

<p>Calculate group means of a variable. Used to test for 'between individual effects'.
See methods outlined in van de Pol and Wright 2009 for more detail.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wgmean(covar, groupvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wgmean_+3A_covar">covar</code></td>
<td>
<p>Continuous variable for which group means will be calculated.
Please specify the dataset in which the variable is found (i.e. data$var).</p>
</td></tr>
<tr><td><code id="wgmean_+3A_groupvar">groupvar</code></td>
<td>
<p>Grouping variable within which means will be calculated.
For example, individual ID or site/plot ID. Please specify the dataset in which
the variable is found (i.e. data$var).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector containing numeric values. This can be used to
differentiate within and between group effects in a model.
See function <code><a href="#topic+wgdev">wgdev</a></code> to calculate within group deviance. 
See van de Pol and Wright 2009 for more details on the method.
</p>


<h3>Author(s)</h3>

<p>Martijn van de Pol and Jonathan Wright
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate mean temperature within years from the MassClimate dataset.  

data(MassClimate)

#Calculate year column
library(lubridate)
MassClimate$Year &lt;- year(as.Date(MassClimate$Date, format = "%d/%m/%Y"))

#Calculate mean temperature within each year
within_yr_mean &lt;- wgmean(MassClimate$Temp, MassClimate$Year)

#Add this variable to the original dataset
MassClimate$Within_yr_mean &lt;- within_yr_mean
             
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
