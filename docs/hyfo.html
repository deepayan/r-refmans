<!DOCTYPE html><html><head><title>Help for package hyfo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hyfo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#applyBiasFactor'><p>Apply bias factor to different forecasts for multi/operational/real time bias correction.</p></a></li>
<li><a href='#biasCorrect'><p>Biascorrect the input timeseries or hyfo dataset</p></a></li>
<li><a href='#biasFactor-class'><p>An S4 class, representing the biasFactor of single time series biasCorrection.</p></a></li>
<li><a href='#biasFactor.hyfo-class'><p>An S4 class, representing the biasFactor of hyfo file.</p></a></li>
<li><a href='#checkBind'><p>Check data for bind function.</p></a></li>
<li><a href='#collectData'><p>Collect data from different csv files.</p></a></li>
<li><a href='#collectData_csv_anarbe'><p>Collect data from csv for Anarbe case.</p></a></li>
<li><a href='#collectData_excel_anarbe'><p>Collect data from different excel files</p></a></li>
<li><a href='#collectData_txt_anarbe'><p>collect data from different txt.</p></a></li>
<li><a href='#coord2cell'><p>Change lon lat coordinates to cell coordinates</p></a></li>
<li><a href='#downscaleNcdf'><p>Downscale NetCDF file</p></a></li>
<li><a href='#extractPeriod'><p>Extract period from list or dataframe.</p></a></li>
<li><a href='#fillGap'><p>Fill gaps in the rainfall time series.</p></a></li>
<li><a href='#getAnnual'><p>Get annual rainfall of different rainfall time series</p></a></li>
<li><a href='#getAnnual_dataframe'><p>Get annual rainfall of the input time series.</p></a></li>
<li><a href='#getBiasFactor'><p>Get bias factor for multi/operational/real time bias correction.</p></a></li>
<li><a href='#getEnsem_comb'><p>Combine ensembles together</p></a></li>
<li><a href='#getFrcEnsem'><p>Extract time series from forecasting data.</p></a></li>
<li><a href='#getHisEnsem'><p>Get ensemble forecast from historical data.</p></a></li>
<li><a href='#getLMom'><p>get L moment analysis of the input distribution</p></a></li>
<li><a href='#getMeanPreci'><p>Get mean rainfall data.</p></a></li>
<li><a href='#getMoment'><p>get moment analysis of the input distribution</p></a></li>
<li><a href='#getNcdfVar'><p>Get variable name of the NetCDF file.</p></a></li>
<li><a href='#getPreciBar'><p>get mean rainfall bar plot of the input dataset or time series.</p></a></li>
<li><a href='#getPreciBar_comb'><p>Combine bars together</p></a></li>
<li><a href='#getSpatialMap'><p>Get spatial map of the input dataset.</p></a></li>
<li><a href='#getSpatialMap_comb'><p>Combine maps together</p></a></li>
<li><a href='#getSpatialMap_mat'><p>Replot raster matrix</p></a></li>
<li><a href='#list2Dataframe'><p>Convert a list to a dataframe.</p></a></li>
<li><a href='#loadNcdf'><p>Load NetCDF file</p></a></li>
<li><a href='#monthlyPreci'><p>Get monthly rainfall</p></a></li>
<li><a href='#plotTS'><p>plot time series, with marks on missing value.</p></a></li>
<li><a href='#plotTS_comb'><p>Combine time seires plot together</p></a></li>
<li><a href='#resample'><p>Resample your time series or ncdf files.</p></a></li>
<li><a href='#shp2cat'><p>Get a catchment object from selected shape file.</p></a></li>
<li><a href='#testCat'><p>testCat</p></a></li>
<li><a href='#testdl'><p>testdl</p></a></li>
<li><a href='#tgridData'><p>tgridData</p></a></li>
<li><a href='#writeNcdf'><p>Write to NetCDF file using hyfo list file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hydrology and Climate Forecasting</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-8-15</td>
</tr>
<tr>
<td>Description:</td>
<td>Focuses on data processing and visualization in hydrology and
    climate forecasting. Main function includes data extraction, data downscaling,
    data resampling, gap filler of precipitation, bias correction of forecasting
    data, flexible time series plot, and spatial map generation. It is a good pre-
    processing and post-processing tool for hydrological and hydraulic modellers.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), stats (&ge; 3.1.3), utils(&ge; 3.1.3),</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 1.0.1), reshape2 (&ge; 1.4.1), zoo (&ge; 1.7-12), sf
(&ge; 1.0-12), plyr (&ge; 1.8.3), moments (&ge; 0.14), lmom (&ge; 2.5),
maps(&ge; 2.3-9), sp (&ge; 2.0-0), ncdf4 (&ge; 1.14.1), MASS (&ge;
7.3-39), methods, data.table</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gridExtra, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://yuanchao-xu.github.io/hyfo/">https://yuanchao-xu.github.io/hyfo/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Yuanchao-Xu/hyfo/issues">https://github.com/Yuanchao-Xu/hyfo/issues</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-15 14:52:25 UTC; yuanchaoxu</td>
</tr>
<tr>
<td>Author:</td>
<td>Yuanchao Xu [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yuanchao Xu &lt;xuyuanchao37@gmail.com&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-16 09:12:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='applyBiasFactor'>Apply bias factor to different forecasts for multi/operational/real time bias correction.</h2><span id='topic+applyBiasFactor'></span><span id='topic+applyBiasFactor+2Cdata.frame+2CbiasFactor-method'></span><span id='topic+applyBiasFactor+2Clist+2CbiasFactor.hyfo-method'></span>

<h3>Description</h3>

<p>When you do multi/operational/real time bias correction. It's too expensive
to input hindcast and obs every time. Especially when you have a long period of hindcast
and obs, but only a short period of frc, it's too unecessary to read and compute hindcast
and obs everytime. Therefore, biasFactor is designed. Using <code>getBiasFactor</code>, you can
get the biasFactor with hindcast and observation, then you can use <code>applyBiasFactor</code> to 
apply the biasFactor to different forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>applyBiasFactor(frc, biasFactor, obs = NULL)

## S4 method for signature 'data.frame,biasFactor'
applyBiasFactor(frc, biasFactor, obs = NULL)

## S4 method for signature 'list,biasFactor.hyfo'
applyBiasFactor(frc, biasFactor, obs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="applyBiasFactor_+3A_frc">frc</code></td>
<td>
<p>a hyfo grid data output or a dataframe(time series) consists of Date column and one or more value columns, 
representing the frc data. Check details for more information.</p>
</td></tr>
<tr><td><code id="applyBiasFactor_+3A_biasfactor">biasFactor</code></td>
<td>
<p>a file containing all the information of the calibration, will be
applied to different forecasts.</p>
</td></tr>
<tr><td><code id="applyBiasFactor_+3A_obs">obs</code></td>
<td>
<p>for some methods, observation input is necessary. obs is a hyfo grid data output or a dataframe (time series) consists of Date column and one or more value columns, 
representing the observation data. Default value is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Information about the method and how biasCorrect works can be found in <code><a href="#topic+biasCorrect">biasCorrect</a></code>
</p>
<p><strong>why use biasFactor</strong>
</p>
<p>As for forecasting, for daily data, there is usually no need to have
different bias factor every different day. You can calculate one bisa factor using a long
period of hindcast and obs, and apply that factor to different frc.
</p>
<p>For example,
</p>
<p>You have 10 years of hindcast and observation. you want to do bias correction for some 
forecasting product, e.g. system 4. For system 4, each month, you will get a new forecast
about the future 6 months. So if you want to do the real time bias correction, you have to
take the 10 years of hindcast and observation data with you, and run <code>biasCorrect</code> every
time you get a new forecast. That's too expensive.
</p>
<p>For some practical use in forecasting, there isn't a so high demand for accuracy. E.g.,
Maybe for February and March, you can use the same biasFactor, no need to do the computation 
again. 
</p>
<p>It is a generic function, if in your case you need to debug, please see <code>?debug()</code> 
for how to debug S4 method.
</p>


<h3>Author(s)</h3>

<p>Yuanchao Xu <a href="mailto:xuyuanchao37@gmail.com">xuyuanchao37@gmail.com</a>
</p>


<h3>References</h3>

<p>Bias correction methods come from <code>biasCorrection</code> from <code>dowscaleR</code>
</p>

<ul>
<li><p> Santander Meteorology Group (2015). downscaleR: Climate data manipulation and statistical downscaling. R
package version 0.6-0. https://github.com/SantanderMetGroup/downscaleR/wiki
</p>
</li>
<li><p> R.A.I. Wilcke, T. Mendlik and A. Gobiet (2013) Multi-variable error correction of regional climate models. Climatic Change, 120, 871-887
</p>
</li>
<li><p> A. Amengual, V. Homar, R. Romero, S. Alonso, and C. Ramis (2012) A Statistical Adjustment of Regional Climate Model Outputs to Local Scales: Application to Platja de Palma, Spain. J. Clim., 25, 939-957
</p>
</li>
<li><p> C. Piani, J. O. Haerter and E. Coppola (2009) Statistical bias correction for daily precipitation in regional climate models over Europe, Theoretical and Applied Climatology, 99, 187-192
</p>
</li>
<li><p> O. Gutjahr and G. Heinemann (2013) Comparing precipitation bias correction methods for high-resolution regional climate simulations using COSMO-CLM, Theoretical and Applied Climatology, 114, 511-529
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+biasCorrect">biasCorrect</a></code> for method used in bias correction. 
<code><a href="#topic+getBiasFactor">getBiasFactor</a></code>, for the first part.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
######## hyfo grid file biascorrection
########

# If your input is obtained by \code{loadNcdf}, you can also directly biascorrect
# the file.

# First load ncdf file.
filePath &lt;- system.file("extdata", "tnc.nc", package = "hyfo")
varname &lt;- getNcdfVar(filePath)    
nc &lt;- loadNcdf(filePath, varname)

data(tgridData)
#' # Since the example data, has some NA values, the process will include some warning #message, 
# which can be ignored in this case.



# Then we will use nc data as forecasting data, and use itself as hindcast data,
# use tgridData as observation.

biasFactor &lt;- getBiasFactor(nc, tgridData)
newFrc &lt;- applyBiasFactor(nc, biasFactor)
   
biasFactor &lt;- getBiasFactor(nc, tgridData, method = 'eqm', extrapolate = 'constant',
preci = TRUE)
# This method needs obs input.
newFrc &lt;- applyBiasFactor(nc, biasFactor, obs = tgridData)

biasFactor &lt;- getBiasFactor(nc, tgridData, method = 'gqm', preci = TRUE)
newFrc &lt;- applyBiasFactor(nc, biasFactor) 


######## Time series biascorrection
########

# Use the time series from testdl as an example, we take frc, hindcast and obs from testdl.
data(testdl)

# common period has to be extracted in order to better train the forecast.

datalist &lt;- extractPeriod(testdl, startDate = '1994-1-1', endDate = '1995-10-1')

frc &lt;- datalist[[1]]
hindcast &lt;- datalist[[2]]
obs &lt;- datalist[[3]]


# The data used here is just for example, so there could be negative data.

# default method is scaling
biasFactor &lt;- getBiasFactor(hindcast, obs)
frc_new &lt;- applyBiasFactor(frc, biasFactor)

# for precipitation data, extra process needs to be executed, so you have to tell
# the program to it is a precipitation data.

biasFactor &lt;- getBiasFactor(hindcast, obs, preci = TRUE)
frc_new1 &lt;- applyBiasFactor(frc, biasFactor)

# You can use other methods to biascorrect, e.g. delta method. 
biasFactor &lt;- getBiasFactor(hindcast, obs, method = 'delta')
# delta method needs obs input.
frc_new2 &lt;- applyBiasFactor(frc, biasFactor, obs = obs)

# 
biasFactor &lt;- getBiasFactor(hindcast, obs, method = 'eqm', preci = TRUE)
# eqm needs obs input
frc_new3 &lt;- applyBiasFactor(frc, biasFactor, obs = obs)

biasFactor &lt;- getBiasFactor(hindcast, obs, method = 'gqm', preci = TRUE)
frc_new4 &lt;- applyBiasFactor(frc, biasFactor)

plotTS(obs, frc, frc_new, frc_new1, frc_new2, frc_new3, frc_new4, plot = 'cum')

# You can also give name to this input list.
TSlist &lt;- list(obs, frc, frc_new, frc_new1, frc_new2, frc_new3, frc_new4)
names(TSlist) &lt;- c('obs', 'frc', 'delta', 'delta_preci', 'scale', 'eqm', 'gqm')
plotTS(list = TSlist, plot = 'cum')


# If the forecasts you extracted only has incontinuous data for certain months and years, e.g.,
# for seasonal forecasting, forecasts only provide 3-6 months data, so the case can be 
# for example Dec, Jan and Feb of every year from year 1999-2005.
# In such case, you need to extract certain months and years from observed time series.
# extractPeriod() can be then used.
  
  



# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/


</code></pre>

<hr>
<h2 id='biasCorrect'>Biascorrect the input timeseries or hyfo dataset</h2><span id='topic+biasCorrect'></span><span id='topic+biasCorrect+2Cdata.frame+2Cdata.frame+2Cdata.frame-method'></span><span id='topic+biasCorrect+2Clist+2Clist+2Clist-method'></span>

<h3>Description</h3>

<p>Biascorrect the input time series or dataset, the input time series or dataset should consist of observation, hindcast, and forecast.
observation and hindcast should belong to the same period, in order to calibrate. Then the modified forecast
will be returned. If the input is a time series, first column should be date column and rest columns should be 
the value column. If the input is a hyfo dataset, the dataset should be the result of <code>loadNcdf</code>, or a list
file with the same format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>biasCorrect(
  frc,
  hindcast,
  obs,
  method = "scaling",
  scaleType = "multi",
  preci = FALSE,
  prThreshold = 0,
  extrapolate = "no"
)

## S4 method for signature 'data.frame,data.frame,data.frame'
biasCorrect(
  frc,
  hindcast,
  obs,
  method = "scaling",
  scaleType = "multi",
  preci = FALSE,
  prThreshold = 0,
  extrapolate = "no"
)

## S4 method for signature 'list,list,list'
biasCorrect(
  frc,
  hindcast,
  obs,
  method = "scaling",
  scaleType = "multi",
  preci = FALSE,
  prThreshold = 0,
  extrapolate = "no"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="biasCorrect_+3A_frc">frc</code></td>
<td>
<p>a hyfo grid data output or a dataframe (time series) consists of Date column and one or more value columns, 
representing the forecast to be calibrated.</p>
</td></tr>
<tr><td><code id="biasCorrect_+3A_hindcast">hindcast</code></td>
<td>
<p>a hyfo grid data output or a dataframe(time series) consists of Date column and one or more value columns, 
representing the hindcast data. This data will be used in the calibration of the forecast, so it's better to have the same date period as
observation data. Check details for more information.</p>
</td></tr>
<tr><td><code id="biasCorrect_+3A_obs">obs</code></td>
<td>
<p>a hyfo grid data output or a dataframe (time series) consists of Date column and one or more value columns, 
representing the observation data.</p>
</td></tr>
<tr><td><code id="biasCorrect_+3A_method">method</code></td>
<td>
<p>bias correct method, including 'delta', 'scaling'..., default is 'scaling'</p>
</td></tr>
<tr><td><code id="biasCorrect_+3A_scaletype">scaleType</code></td>
<td>
<p>only when the method &quot;scaling&quot; is chosen, scaleType will be available. Two different types
of scaling method, 'add' and 'multi', which means additive and multiplicative scaling method. More info check 
details. Default scaleType is 'multi'.</p>
</td></tr>
<tr><td><code id="biasCorrect_+3A_preci">preci</code></td>
<td>
<p>If the precipitation is biascorrected, then you have to assign <code>preci = TRUE</code>. Since for
precipitation, some biascorrect methods may not apply to, or some methods are specially for precipitation. 
Default is FALSE, refer to details.</p>
</td></tr>
<tr><td><code id="biasCorrect_+3A_prthreshold">prThreshold</code></td>
<td>
<p>The minimum value that is considered as a non-zero precipitation. Default to 0 (assuming mm). If you want 
to use precipitation biascorrect, you should consider carefully how to set this threshold, usually is 1. But you 
can try with different numbers to see the results.</p>
</td></tr>
<tr><td><code id="biasCorrect_+3A_extrapolate">extrapolate</code></td>
<td>
<p>When use 'eqm' method, and 'no' is set, modified frc is bounded by the range of obs.
If 'constant' is set, modified frc is not bounded by the range of obs. Default is 'no'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since climate forecast is based on global condition, when downscaling to different regions, it may include
some bias, biascorrection is used then to fix the bias.
</p>
<p><strong>Hindcast</strong>
</p>
<p>In order to bias correct, we need to pick up some data from the forecast to train with
the observation, which is called hindcast in this function. Using hindcast and observation, 
the program can analyze the bias and correct the bias in the forecast. 
</p>
<p>Hindcast should have <strong>EVERY</strong> attributes that forecast has.
</p>
<p>Hindcast is also called re-forecast, is the forecast of the past. E.g. you have a forecast from year 2000-2010, assuming now you are in 2005. So from 2000-2005, this period
is the hindcast period, and 2005-2010, this period is the forecast period.
</p>
<p>Hindcast can be the same as forecast, i.e., you can use forecast itself as hindcast to train the bias correction.
</p>
<p><strong>How it works</strong>
</p>
<p>Forecast product has to be calibrated, usually the system is doing forecast in real time. So, e.g., if the 
forecast starts from year 2000, assuming you are in year 2003, then you will have 3 years' hindcast 
data (year 2000-2003), which can be used to calibrate. And your forecast period is (2003-2004)
</p>
<p>E.g. you have observation from 2001-2002, this is your input obs. Then you can take the same 
period (2001-2002) from the forecast, which is the hindcast period. For forecast, you can take any period.
The program will evaluate the obs and hindcast, to get the modification of the forecast, and then add the 
modification to the forecast data.
</p>
<p>The more categorized input, the more accurate result you will get. E.g., if you want to 
bias correct a forecast for winter season. So you'd better to extract all the winter period
in the hindcast and observation to train. <code>extractPeriod</code> can be used for this purpose.
</p>
<p><strong>method</strong>
</p>
<p>Different methods used in the bias correction. Among which, delta, scaling can be applied
to different kinds of parameters, with no need to set <code>preci</code>; eqm has two conditions for rainfall data and other data,
it needs user to input <code>preci = TRUE/FALSE</code> to point to different conditions; gqm is
designed for rainfall data, so <code>preci = TRUE</code> needs to be set.
</p>
<p><strong>delta</strong>
</p>
<p>This method consists on adding to the observations the mean change signal (delta method). 
This method is applicable to any kind of variable but it is preferable to avoid it for bounded variables
(e.g. precipitation, wind speed, etc.) because values out of the variable range could be obtained 
(e.g. negative wind speeds...)
</p>
<p><strong>scaling</strong>
</p>
<p>This method consists on scaling the simulation  with the difference (additive) or quotient (multiplicative) 
between the observed and simulated means in the train period. The <code>additive</code> or <code>multiplicative</code>
correction is defined by parameter <code>scaling.type</code> (default is <code>additive</code>).
The additive version is preferably applicable to unbounded variables (e.g. temperature) 
and the multiplicative to variables with a lower bound (e.g. precipitation, because it also preserves the frequency). 
</p>
<p><strong>eqm</strong>
</p>
<p>Empirical Quantile Mapping. This is a very extended bias correction method which consists on calibrating the simulated Cumulative Distribution Function (CDF) 
by adding to the observed quantiles both the mean delta change and the individual delta changes in the corresponding quantiles. 
This method is applicable to any kind of variable.
</p>
<p>It can keep the extreme value, if you choose constant extrapolation method. But then you will face the risk
that the extreme value is an error.
</p>
<p><strong>gqm</strong>
</p>
<p>Gamma Quantile Mapping. This method is described in Piani et al. 2010 and is applicable only to precipitation. It is based on the initial assumption that both observed
and simulated intensity distributions are well approximated by the gamma distribution, therefore is a parametric q-q map 
that uses the theorical instead of the empirical distribution. 
</p>
<p>It can somehow filter some extreme values caused by errors, while keep the extreme value. Seems more reasonable.
Better have a long period of training, and the if the forecast system is relatively stable.
</p>
<p>It is a generic function, if in your case you need to debug, please see <code>?debug()</code> 
for how to debug S4 method.
</p>


<h3>Author(s)</h3>

<p>Yuanchao Xu <a href="mailto:xuyuanchao37@gmail.com">xuyuanchao37@gmail.com</a>
</p>


<h3>References</h3>

<p>Bias correction methods come from <code>biasCorrection</code> from <code>dowscaleR</code>
</p>

<ul>
<li><p> Santander Meteorology Group (2015). downscaleR: Climate data manipulation and statistical downscaling. R
package version 0.6-0. https://github.com/SantanderMetGroup/downscaleR/wiki
</p>
</li>
<li><p> R.A.I. Wilcke, T. Mendlik and A. Gobiet (2013) Multi-variable error correction of regional climate models. Climatic Change, 120, 871-887
</p>
</li>
<li><p> A. Amengual, V. Homar, R. Romero, S. Alonso, and C. Ramis (2012) A Statistical Adjustment of Regional Climate Model Outputs to Local Scales: Application to Platja de Palma, Spain. J. Clim., 25, 939-957
</p>
</li>
<li><p> C. Piani, J. O. Haerter and E. Coppola (2009) Statistical bias correction for daily precipitation in regional climate models over Europe, Theoretical and Applied Climatology, 99, 187-192
</p>
</li>
<li><p> O. Gutjahr and G. Heinemann (2013) Comparing precipitation bias correction methods for high-resolution regional climate simulations using COSMO-CLM, Theoretical and Applied Climatology, 114, 511-529
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
######## hyfo grid file biascorrection
########

# If your input is obtained by \code{loadNcdf}, you can also directly biascorrect
# the file.

# First load ncdf file.
filePath &lt;- system.file("extdata", "tnc.nc", package = "hyfo")
varname &lt;- getNcdfVar(filePath)    
nc &lt;- loadNcdf(filePath, varname)

data(tgridData)
# Since the example data, has some NA values, the process will include some warning #message, 
# which can be ignored in this case.




# Then we will use nc data as forecasting data, and use itself as hindcast data,
# use tgridData as observation.
newFrc &lt;- biasCorrect(nc, nc, tgridData)  
newFrc &lt;- biasCorrect(nc, nc, tgridData, scaleType = 'add')   
newFrc &lt;- biasCorrect(nc, nc, tgridData, method = 'eqm', extrapolate = 'constant', 
preci = TRUE) 
newFrc &lt;- biasCorrect(nc, nc, tgridData, method = 'gqm', preci = TRUE) 


######## Time series biascorrection
########

# Use the time series from testdl as an example, we take frc, hindcast and obs from testdl.
data(testdl)

# common period has to be extracted in order to better train the forecast.

datalist &lt;- extractPeriod(testdl, startDate = '1994-1-1', endDate = '1995-10-1')

frc &lt;- datalist[[1]]
hindcast &lt;- datalist[[2]]
obs &lt;- datalist[[3]]


# The data used here is just for example, so there could be negative data.

# default method is scaling, with 'multi' scaleType
frc_new &lt;- biasCorrect(frc, hindcast, obs)

# for precipitation data, extra process needs to be executed, so you have to tell
# the program that it is a precipitation data.

frc_new1 &lt;- biasCorrect(frc, hindcast, obs, preci = TRUE)

# You can use other scaling methods to biascorrect.
frc_new2 &lt;- biasCorrect(frc, hindcast, obs, scaleType = 'add')

# 
frc_new3 &lt;- biasCorrect(frc, hindcast, obs, method = 'eqm', preci = TRUE)
frc_new4 &lt;- biasCorrect(frc, hindcast, obs, method = 'gqm', preci = TRUE)

plotTS(obs, frc, frc_new, frc_new1, frc_new2, frc_new3, frc_new4, plot = 'cum')

# You can also give name to this input list.
TSlist &lt;- list(obs, frc, frc_new, frc_new1, frc_new2, frc_new3, frc_new4)
names(TSlist) &lt;- c('obs', 'frc', 'delta', 'delta_preci', 'scale', 'eqm', 'gqm')
plotTS(list = TSlist, plot = 'cum')


# If the forecasts you extracted only has incontinuous data for certain months and years, e.g.,
# for seasonal forecasting, forecasts only provide 3-6 months data, so the case can be 
# for example Dec, Jan and Feb of every year from year 1999-2005.
# In such case, you need to extract certain months and years from observed time series.
# extractPeriod() can be then used.
  
  



# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/


</code></pre>

<hr>
<h2 id='biasFactor-class'>An S4 class, representing the biasFactor of single time series biasCorrection.</h2><span id='topic+biasFactor-class'></span>

<h3>Description</h3>

<p>An S4 class, representing the biasFactor of single time series biasCorrection.
</p>


<h3>Slots</h3>


<dl>
<dt><code>biasFactor</code></dt><dd><p>list of biasFactor, containing all the information for computing.</p>
</dd>
<dt><code>method</code></dt><dd><p>the biascorrection method</p>
</dd>
<dt><code>preci</code></dt><dd><p>if the data is precipitation</p>
</dd>
<dt><code>scaleType</code></dt><dd><p>'Valid when 'scaling' method is selected, 'multi' or 'add'.</p>
</dd>
<dt><code>extrapolate</code></dt><dd><p>Valid when 'eqm' method is selected, 'constant' or 'no'</p>
</dd>
<dt><code>memberDim</code></dt><dd><p>members contained.</p>
</dd>
<dt><code>prThreshold</code></dt><dd><p>precipitation threshold, under which the precipitation is considered as 0.</p>
</dd>
</dl>

<hr>
<h2 id='biasFactor.hyfo-class'>An S4 class, representing the biasFactor of hyfo file.</h2><span id='topic+biasFactor.hyfo-class'></span>

<h3>Description</h3>

<p>An S4 class, representing the biasFactor of hyfo file.
</p>


<h3>Slots</h3>


<dl>
<dt><code>lonLatDim</code></dt><dd><p>lists of biasFactor</p>
</dd>
</dl>

<hr>
<h2 id='checkBind'>Check data for bind function.</h2><span id='topic+checkBind'></span>

<h3>Description</h3>

<p>check if the data is available for <code>rbind()</code> or <code>cbind()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkBind(data, bind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkBind_+3A_data">data</code></td>
<td>
<p>A list containing different sublists ready to be processed by <code>do.call('rbind')</code> 
or <code>do.call('cbind')</code></p>
</td></tr>
<tr><td><code id="checkBind_+3A_bind">bind</code></td>
<td>
<p>A string showing which bind you are going to use can be 'rbind' or 'cbind'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data can be processed by bind function; data cannot be processed by bind function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- list(c(1,1,1),c(2,2,2))
bind &lt;- 'rbind'
checkBind(data,bind)

data(testdl)
## Not run: 
checkBind(testdl, 'rbind')

## End(Not run)
# Since the colnames in testdl are not the same, so it cannot be bound.
#
</code></pre>

<hr>
<h2 id='collectData'>Collect data from different csv files.</h2><span id='topic+collectData'></span>

<h3>Description</h3>

<p>Collect data from different csv files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collectData(folderName, fileType = NULL, range = NULL, sheetIndex = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collectData_+3A_foldername">folderName</code></td>
<td>
<p>A string showing the path of the folder holding different csv files.</p>
</td></tr>
<tr><td><code id="collectData_+3A_filetype">fileType</code></td>
<td>
<p>A string showing the file type, e.g. &quot;txt&quot;, &quot;csv&quot;, &quot;excel&quot;.</p>
</td></tr>
<tr><td><code id="collectData_+3A_range">range</code></td>
<td>
<p>A vector containing startRow, endRow, startColumn, endColumn, e.g., 
c(2,15,2,3)</p>
</td></tr>
<tr><td><code id="collectData_+3A_sheetindex">sheetIndex</code></td>
<td>
<p>A number showing the sheetIndex in the excel file, if fileType is excel,
sheetIndex has to be provided, default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The collected data from different files in the folder.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#use internal data as an example.
folder &lt;- file.path(path.package("hyfo"), 'extdata')
# file may vary with different environment, it if doesn't work, use local way to get
# folder path.

a &lt;- collectData(folder, fileType = 'csv', range = c(10, 20, 1,2))

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='collectData_csv_anarbe'>Collect data from csv for Anarbe case.</h2><span id='topic+collectData_csv_anarbe'></span>

<h3>Description</h3>

<p>Collect data from the gauging stations in spain, catchement Anarbe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collectData_csv_anarbe(folderName, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collectData_csv_anarbe_+3A_foldername">folderName</code></td>
<td>
<p>A string showing the path of the folder holding different csv files.</p>
</td></tr>
<tr><td><code id="collectData_csv_anarbe_+3A_output">output</code></td>
<td>
<p>A boolean showing whether the output is given, default is T.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The collected data from different csv files.
</p>


<h3>Source</h3>

<p>http://meteo.navarra.es/estaciones/mapadeestaciones.cfm
</p>


<h3>References</h3>


<ul>
<li><p> http://meteo.navarra.es/estaciones/mapadeestaciones.cfm
</p>
</li>
<li><p> R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
#use internal data as an example.
file &lt;- system.file("extdata", "1999.csv", package = "hyfo")
folder &lt;- strsplit(file, '1999')[[1]][1]
a &lt;- collectData_csv_anarbe(folder)

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='collectData_excel_anarbe'>Collect data from different excel files</h2><span id='topic+collectData_excel_anarbe'></span>

<h3>Description</h3>

<p>Collect data from different excel files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collectData_excel_anarbe(folderName, keyword = NULL, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collectData_excel_anarbe_+3A_foldername">folderName</code></td>
<td>
<p>A string showing the folder path.</p>
</td></tr>
<tr><td><code id="collectData_excel_anarbe_+3A_keyword">keyword</code></td>
<td>
<p>A string showing the extracted column, e.g., waterLevel, waterBalance.</p>
</td></tr>
<tr><td><code id="collectData_excel_anarbe_+3A_output">output</code></td>
<td>
<p>A boolean showing whether the output is given.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The collected data from different excel files.
</p>


<h3>References</h3>


<ul>
<li><p> R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL http://www.R-project.org/.
</p>
</li></ul>


<hr>
<h2 id='collectData_txt_anarbe'>collect data from different txt.</h2><span id='topic+collectData_txt_anarbe'></span>

<h3>Description</h3>

<p>collect data from different txt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collectData_txt_anarbe(
  folderName,
  output = TRUE,
  rangeWord = c("Ene       ", -1, "Total     ", -6)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collectData_txt_anarbe_+3A_foldername">folderName</code></td>
<td>
<p>A string showing the folder path.</p>
</td></tr>
<tr><td><code id="collectData_txt_anarbe_+3A_output">output</code></td>
<td>
<p>A boolean showing whether the result is given.</p>
</td></tr>
<tr><td><code id="collectData_txt_anarbe_+3A_rangeword">rangeWord</code></td>
<td>
<p>A list containing the keyword and the shift. 
defaut is set to be used in spain gauging station.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The collected data from different txt files.
</p>


<h3>Source</h3>

<p>http://www4.gipuzkoa.net/oohh/web/esp/02.asp
</p>


<h3>References</h3>


<ul>
<li><p> http://www4.gipuzkoa.net/oohh/web/esp/02.asp
</p>
</li>
<li><p> R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>  
#use internal data as an example.

## Not run: 
file &lt;- system.file("extdata", "1999.csv", package = "hyfo")
folder &lt;- strsplit(file, '1999')[[1]][1]
a &lt;- collectData_txt_anarbe(folder)

## End(Not run)


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='coord2cell'>Change lon lat coordinates to cell coordinates</h2><span id='topic+coord2cell'></span>

<h3>Description</h3>

<p>Change lon lat coordinates to cell coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coord2cell(coord, lon, lat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coord2cell_+3A_coord">coord</code></td>
<td>
<p>input lon lat coordinate</p>
</td></tr>
<tr><td><code id="coord2cell_+3A_lon">lon</code></td>
<td>
<p>dataset lon array</p>
</td></tr>
<tr><td><code id="coord2cell_+3A_lat">lat</code></td>
<td>
<p>dataset lat array</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A cell coordinate
</p>

<hr>
<h2 id='downscaleNcdf'>Downscale NetCDF file</h2><span id='topic+downscaleNcdf'></span>

<h3>Description</h3>

<p>Downscale NetCDF file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>downscaleNcdf(gridData, year = NULL, month = NULL, lon = NULL, lat = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="downscaleNcdf_+3A_griddata">gridData</code></td>
<td>
<p>A hyfo list file from <code><a href="#topic+loadNcdf">loadNcdf</a></code></p>
</td></tr>
<tr><td><code id="downscaleNcdf_+3A_year">year</code></td>
<td>
<p>A vector of the target year. e.g. <code>year = 2000</code>, <code>year = 1980:2000</code></p>
</td></tr>
<tr><td><code id="downscaleNcdf_+3A_month">month</code></td>
<td>
<p>A vector of the target month. e.g. <code>month = 2</code>, <code>month = 3:12</code></p>
</td></tr>
<tr><td><code id="downscaleNcdf_+3A_lon">lon</code></td>
<td>
<p>A vector of the range of the downscaled longitude, should contain a max value
and a min value. e.g. <code>lon = c(-1.5, 2,5)</code></p>
</td></tr>
<tr><td><code id="downscaleNcdf_+3A_lat">lat</code></td>
<td>
<p>A vector of the range of the downscaled latitude, should contain a max value
and a min value. e.g. <code>lat = c(32,2, 36)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A downscaled hyfo list file.
</p>


<h3>References</h3>


<ul>
<li><p> Santander MetGroup (2015). ecomsUDG.Raccess: R interface to the ECOMS User Data Gateway. R package
version 2.2-6. http://meteo.unican.es/ecoms-udg
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># First open the test NETcDF file.
filePath &lt;- system.file("extdata", "tnc.nc", package = "hyfo")


# Then if you don't know the variable name, you can use \code{getNcdfVar} to get variable name
varname &lt;- getNcdfVar(filePath)

nc &lt;- loadNcdf(filePath, varname)

# Then write to your work directory

nc1 &lt;- downscaleNcdf(nc, year = 2006, lon = c(-2, -0.5), lat = c(43.2, 43.7))
nc2 &lt;- downscaleNcdf(nc, year = 2005, month = 3:8, lon = c(-2, -0.5), lat = c(43.2, 43.7))

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='extractPeriod'>Extract period from list or dataframe.</h2><span id='topic+extractPeriod'></span><span id='topic+extractPeriod+2Cdata.frame-method'></span><span id='topic+extractPeriod+2Clist-method'></span>

<h3>Description</h3>

<p>Extract common period or certain period from a list of different dataframes of time series, or from a 
dataframe. 
NOTE: all the dates in the datalist should follow the format in ?as.Datebase.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractPeriod(
  data,
  startDate = NULL,
  endDate = NULL,
  commonPeriod = FALSE,
  year = NULL,
  month = NULL
)

## S4 method for signature 'data.frame'
extractPeriod(
  data,
  startDate = NULL,
  endDate = NULL,
  commonPeriod = FALSE,
  year = NULL,
  month = NULL
)

## S4 method for signature 'list'
extractPeriod(
  data,
  startDate = NULL,
  endDate = NULL,
  commonPeriod = FALSE,
  year = NULL,
  month = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractPeriod_+3A_data">data</code></td>
<td>
<p>A list of different dataframes of time series, or a dataframe with first column Date, the rest columns value.</p>
</td></tr>
<tr><td><code id="extractPeriod_+3A_startdate">startDate</code></td>
<td>
<p>A Date showing the start of the extract period, default as NULL, check details.</p>
</td></tr>
<tr><td><code id="extractPeriod_+3A_enddate">endDate</code></td>
<td>
<p>A Date showing the end of the extract period, default as NULL, check details.</p>
</td></tr>
<tr><td><code id="extractPeriod_+3A_commonperiod">commonPeriod</code></td>
<td>
<p>A boolean showing whether the common period is extracted. If chosen, startDate and endDate
should be NULL.</p>
</td></tr>
<tr><td><code id="extractPeriod_+3A_year">year</code></td>
<td>
<p>extract certain year in the entire time series. if you want to extract year 2000, set <code>year = 2000</code></p>
</td></tr>
<tr><td><code id="extractPeriod_+3A_month">month</code></td>
<td>
<p>extract certain months in a year. e.g. if you want to extract Jan, Feb of each year, 
set <code>month = c(1, 2)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>startDate and endDate</strong>
</p>
<p>If startDate and endDate are assigned, then certain period between startDate and endDate will be returned, 
for both datalist input and dataframe input.
</p>
<p>If startDate and endDate are NOT assigned, then,
</p>
<p>if input is a datalist, the startDate and endDate of the common period of different datalists will be assigned
to the startDate and endDate.
</p>
<p>if input is a dataframe, the startDate and endDate of the input dataframe will be assigned to the startDate
and endDate . Since different value columns share a common Date column in a dataframe input. 
</p>
<p><strong>year and month</strong>
</p>
<p>For year crossing month input, hyfo will take from the year before. E.g. if <code>month = c(10, 11, 12, 1)</code>,
and <code>year = 1999</code>, hyfo will take month 10, 11 and 12 from year 1998, and month 1 from 1999.You DO NOT 
have to set <code>year = 1998 : 1999</code>.
</p>
<p>Well, if you set <code>year = 1998 : 1999</code>, hyfo will take month 10, 11 and 12 from year 1997, and month 1 from 1998,
then, take month 10, 11 and 12 from year 1998, month 1 from 1999. So you only have to care about the latter year.
</p>
<p>It is a generic function, if in your case you need to debug, please see <code>?debug()</code> 
for how to debug S4 method.
</p>


<h3>Value</h3>

<p>A list or a dataframe with all the time series inside containing the same period.
</p>


<h3>References</h3>


<ul>
<li><p> Achim Zeileis and Gabor Grothendieck (2005). zoo: S3 Infrastructure for Regular and Irregular Time
Series. Journal of Statistical Software, 14(6), 1-27. URL https://www.jstatsoft.org/v14/i06/
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Generate timeseries datalist. Each data frame consists of a Date and a value.

AAA &lt;- data.frame(
# date column
Date = seq(as.Date('1990-10-28'),as.Date('1997-4-1'),1),
 # value column
AAA = sample(1:100,length(seq(as.Date('1990-10-28'),as.Date('1997-4-1'),1)), repl = TRUE))

BBB &lt;- data.frame(
Date = seq(as.Date('1993-3-28'),as.Date('1999-1-1'),1), 
BBB = sample(1:100,length(seq(as.Date('1993-3-28'),as.Date('1999-1-1'),1)), repl = TRUE))
 
CCC &lt;- data.frame(
Date = seq(as.Date('1988-2-2'),as.Date('1996-1-1'),1), 
CCC = sample(1:100,length(seq(as.Date('1988-2-2'),as.Date('1996-1-1'),1)), repl = TRUE)) 

list &lt;- list(AAA, BBB, CCC)# dput() and dget() can be used to save and load list file.

list_com &lt;- extractPeriod(list, commonPeriod = TRUE)

# list_com is the extracted datalist.
str(list_com)

# If startDate and endDate is provided, the record between them will be extracted.
# make sure startDate is later than any startDate in each dataframe and endDate is 
# earlier than any endDate in each dataframe.

data(testdl)
datalist_com1 &lt;- extractPeriod(testdl, startDate = '1994-1-1', endDate = '1995-10-1')


dataframe &lt;- list2Dataframe(datalist_com1)
# now we have a dataframe to extract certain months and years.
dataframe_new &lt;- extractPeriod(dataframe, month = c(1,2,3))
dataframe_new &lt;- extractPeriod(dataframe, month = c(12,1,2), year = 1995)


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='fillGap'>Fill gaps in the rainfall time series.</h2><span id='topic+fillGap'></span>

<h3>Description</h3>

<p>Fill gaps in the rainfall time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fillGap(dataset, corPeriod = "daily")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fillGap_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe with first column the time, the rest columns are rainfall data of different gauges</p>
</td></tr>
<tr><td><code id="fillGap_+3A_corperiod">corPeriod</code></td>
<td>
<p>A string showing the period used in the correlation computing, 
e.g. daily, monthly, yearly.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the gap filler follows the rules below:
</p>
<p>1. The correlation coefficient of every two columns (except time column) is calculated.
the correlation coefficient calculation can be based on 'daily', 'monthly', 'annual',
in each case, the daily data, the monthly mean daily data and annual mean daily data of 
each column will be taken in the correlation calculation.
</p>
<p>Then the correlation matrix is got, then based on the matrix, for each column, 
the 1st, 2nd, 3rd,... correlated column will be got. So if there is missing value in the
column, it will get data from orderly 1st, 2nd, 3rd column.
</p>
<p>2. The  simple linear regress is calculated between every two columns. When generating the
linear coefficient, the incept should be force to 0. i.e. y = a*x + b should be forec to 
y = a*x.
</p>
<p>3. Gap filling. E.g., on a certain date, there is a missing value in column A, then the
correlation order is column B, column C, column D, which means A should take values from
B firstly, if B is also missing data, then C, then D.
</p>
<p>Assuming finally value from column C is taken. Then according to step 2, A = a*C, then the
final value filled in column A is missing_in_A = a*value_in_C, a is the linear coeffcient.
</p>


<h3>Value</h3>

<p>The filled dataframe
</p>


<h3>References</h3>

<p>Gap fiiling method based on correlation and linear regression.
</p>

<ul>
<li><p> Hirsch, Robert M., et al. &quot;Statistical analysis of hydrologic data.&quot; Handbook of hydrology. (1992): 17-1.
Salas, Jose D. &quot;Analysis and modeling of hydrologic time series.&quot; Handbook of hydrology 19 (1993): 1-72.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>b &lt;- read.table(text = '        Date  AAA  BBB  CCC  DDD  EEE
49 1999-12-15 24.8 21.4 25.6 35.0 17.4
50 1999-12-16   NA  0.6  1.5  6.3  2.5
51 1999-12-17   NA 16.3 20.3  NA 19.2
52 1999-12-18   13  1.6 NA  6.3  0.0
53 1999-12-19   10 36.4 12.5 26.8 24.9
54 1999-12-20   NA  0.0  0.0  0.2  0.0
55 1999-12-21  0.2  0.0  0.0  0.0  0.0
56 1999-12-22  0.0  0.0  0.0  0.0  0.0')

b1 &lt;- fillGap(b) # if corPeriod is missing, 'daily' is taken as default.

data(testdl)
a &lt;- extractPeriod(testdl, commonPeriod = TRUE)
a1 &lt;- list2Dataframe(a)
a2 &lt;- fillGap(a1)
a3 &lt;- fillGap(a1, corPeriod = 'monthly')


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getAnnual'>Get annual rainfall of different rainfall time series</h2><span id='topic+getAnnual'></span><span id='topic+getAnnual+2Cdata.frame-method'></span><span id='topic+getAnnual+2Clist-method'></span>

<h3>Description</h3>

<p>Get annual rainfall of different raninfall time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAnnual(data, output = "series", minRecords = 355, ...)

## S4 method for signature 'data.frame'
getAnnual(data, output = "series", minRecords = 355, ...)

## S4 method for signature 'list'
getAnnual(data, output = "series", minRecords = 355, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getAnnual_+3A_data">data</code></td>
<td>
<p>A list containing different time series of different rainfall gauges. Or a dataframe with first column Date and the rest columns the value of different
gauging stations. Usually an output of <code>list2Dataframe</code>.</p>
</td></tr>
<tr><td><code id="getAnnual_+3A_output">output</code></td>
<td>
<p>A string showing the output output.</p>
</td></tr>
<tr><td><code id="getAnnual_+3A_minrecords">minRecords</code></td>
<td>
<p>A number showing the minimum accept record number, e.g. for a normal 
year(365 days), if <code>minRecords = 360</code>, it means if a year has less than 360 records
of a year, it will be ignored in the mean annual value calculation. Only valid 
when <code>output = "mean"</code>, default is 355.</p>
</td></tr>
<tr><td><code id="getAnnual_+3A_...">...</code></td>
<td>
<p><code>title, x, y</code> showing the title and x and y axis of the plot. e.g. <code>title = 'aaa'</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is a generic function, if in your case you need to debug, please see <code>?debug()</code> 
for how to debug S4 method.
</p>


<h3>Value</h3>

<p>The annual rainfall and the number of missing data of each year and each rainfall gauge, which 
will also be plotted. If output &quot;mean&quot; is seleted, the mean annual rainfall will be returned.
</p>


<h3>References</h3>


<ul>
<li><p> H. Wickham. ggplot2: elegant graphics for data analysis. Springer New York, 2009.
</p>
</li>
<li><p> Hadley Wickham (2007). Reshaping Data with the reshape Package. Journal of Statistical Software,
21(12), 1-20. URL http://www.jstatsoft.org/v21/i12/.
</p>
</li>
<li><p> R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#datalist is provided by the package as a test.
data(testdl)
a &lt;- getAnnual(testdl)
#set minRecords to control the calculation of annual rainfall.
b &lt;- getAnnual(testdl, output = 'mean', minRecords = 350)
c &lt;- getAnnual(testdl, output = 'mean', minRecords = 365)

a1 &lt;- extractPeriod(testdl, comm = TRUE)
a2 &lt;- list2Dataframe(a1)
getAnnual(a2)

a3 &lt;- fillGap(a2)
getAnnual(a3)


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getAnnual_dataframe'>Get annual rainfall of the input time series.</h2><span id='topic+getAnnual_dataframe'></span>

<h3>Description</h3>

<p>Get annual rainfall of the input time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAnnual_dataframe(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getAnnual_dataframe_+3A_dataset">dataset</code></td>
<td>
<p>A dataframe containing one time series, e.g., rainfall from one gauging station.
the time should follow the format : &quot;1990-1-1&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The annual rainfall of each year of the input station.
</p>

<hr>
<h2 id='getBiasFactor'>Get bias factor for multi/operational/real time bias correction.</h2><span id='topic+getBiasFactor'></span><span id='topic+getBiasFactor+2Cdata.frame+2Cdata.frame-method'></span><span id='topic+getBiasFactor+2Clist+2Clist-method'></span>

<h3>Description</h3>

<p>When you do multi/operational/real time bias correction. It's too expensive
to input hindcast and obs every time. Especially when you have a long period of hindcast
and obs, but only a short period of frc, it's too unecessary to read and compute hindcast
and obs everytime. Therefore, biasFactor is designed. Using <code>getBiasFactor</code>, you can
get the biasFactor with hindcast and observation, then you can use <code>applyBiasFactor</code> to 
apply the biasFactor to different forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBiasFactor(
  hindcast,
  obs,
  method = "scaling",
  scaleType = "multi",
  preci = FALSE,
  prThreshold = 0,
  extrapolate = "no"
)

## S4 method for signature 'data.frame,data.frame'
getBiasFactor(
  hindcast,
  obs,
  method = "scaling",
  scaleType = "multi",
  preci = FALSE,
  prThreshold = 0,
  extrapolate = "no"
)

## S4 method for signature 'list,list'
getBiasFactor(
  hindcast,
  obs,
  method = "scaling",
  scaleType = "multi",
  preci = FALSE,
  prThreshold = 0,
  extrapolate = "no"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBiasFactor_+3A_hindcast">hindcast</code></td>
<td>
<p>a hyfo grid data output or a dataframe(time series) consists of Date column and one or more value columns, 
representing the hindcast data. This data will be used in the calibration of the forecast, so it's better to have the same date period as
observation data. Check details for more information.</p>
</td></tr>
<tr><td><code id="getBiasFactor_+3A_obs">obs</code></td>
<td>
<p>a hyfo grid data output or a dataframe (time series) consists of Date column and one or more value columns, 
representing the observation data.</p>
</td></tr>
<tr><td><code id="getBiasFactor_+3A_method">method</code></td>
<td>
<p>bias correct method, including 'delta', 'scaling'...,default method is 'scaling'.</p>
</td></tr>
<tr><td><code id="getBiasFactor_+3A_scaletype">scaleType</code></td>
<td>
<p>only when the method &quot;scaling&quot; is chosen, scaleType will be available. Two different types
of scaling method, 'add' and 'multi', which means additive and multiplicative scaling method, default is 'multi'. More info check 
details.</p>
</td></tr>
<tr><td><code id="getBiasFactor_+3A_preci">preci</code></td>
<td>
<p>If the precipitation is biascorrected, then you have to assign <code>preci = TRUE</code>. Since for
precipitation, some biascorrect methods may not apply to, or some methods are specially for precipitation. 
Default is FALSE, refer to details.</p>
</td></tr>
<tr><td><code id="getBiasFactor_+3A_prthreshold">prThreshold</code></td>
<td>
<p>The minimum value that is considered as a non-zero precipitation. Default to 1 (assuming mm).</p>
</td></tr>
<tr><td><code id="getBiasFactor_+3A_extrapolate">extrapolate</code></td>
<td>
<p>When use 'eqm' method, and 'no' is set, modified frc is bounded by the range of obs.
If 'constant' is set, modified frc is not bounded by the range of obs. Default is 'no'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Information about the method and how biasCorrect works can be found in <code><a href="#topic+biasCorrect">biasCorrect</a></code>
</p>
<p><strong>why use biasFactor</strong>
</p>
<p>As for forecasting, for daily data, there is usually no need to have
different bias factor every different day. You can calculate one bisa factor using a long
period of hindcast and obs, and apply that factor to different frc.
</p>
<p>For example,
</p>
<p>You have 10 years of hindcast and observation. you want to do bias correction for some 
forecasting product, e.g. system 4. For system 4, each month, you will get a new forecast
about the future 6 months. So if you want to do the real time bias correction, you have to
take the 10 years of hindcast and observation data with you, and run <code>biasCorrect</code> every
time you get a new forecast. That's too expensive.
</p>
<p>For some practical use in forecasting, there isn't a so high demand for accuracy. E.g.,
Maybe for February and March, you can use the same biasFactor, no need to do the computation 
again. 
</p>
<p>It is a generic function, if in your case you need to debug, please see <code>?debug()</code> 
for how to debug S4 method.
</p>


<h3>Author(s)</h3>

<p>Yuanchao Xu <a href="mailto:xuyuanchao37@gmail.com">xuyuanchao37@gmail.com</a>
</p>


<h3>References</h3>

<p>Bias correction methods come from <code>biasCorrection</code> from <code>dowscaleR</code>
</p>

<ul>
<li><p> Santander Meteorology Group (2015). downscaleR: Climate data manipulation and statistical downscaling. R
package version 0.6-0. https://github.com/SantanderMetGroup/downscaleR/wiki
</p>
</li>
<li><p> R.A.I. Wilcke, T. Mendlik and A. Gobiet (2013) Multi-variable error correction of regional climate models. Climatic Change, 120, 871-887
</p>
</li>
<li><p> A. Amengual, V. Homar, R. Romero, S. Alonso, and C. Ramis (2012) A Statistical Adjustment of Regional Climate Model Outputs to Local Scales: Application to Platja de Palma, Spain. J. Clim., 25, 939-957
</p>
</li>
<li><p> C. Piani, J. O. Haerter and E. Coppola (2009) Statistical bias correction for daily precipitation in regional climate models over Europe, Theoretical and Applied Climatology, 99, 187-192
</p>
</li>
<li><p> O. Gutjahr and G. Heinemann (2013) Comparing precipitation bias correction methods for high-resolution regional climate simulations using COSMO-CLM, Theoretical and Applied Climatology, 114, 511-529
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+biasCorrect">biasCorrect</a></code> for method used in bias correction.
<code><a href="#topic+applyBiasFactor">applyBiasFactor</a></code>, for the second part.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
######## hyfo grid file biascorrection
########

# If your input is obtained by \code{loadNcdf}, you can also directly biascorrect
# the file.

# First load ncdf file.
filePath &lt;- system.file("extdata", "tnc.nc", package = "hyfo")
varname &lt;- getNcdfVar(filePath)    
nc &lt;- loadNcdf(filePath, varname)

data(tgridData)
# Since the example data, has some NA values, the process will include some warning #message, 
# which can be ignored in this case.



# Then we will use nc data as forecasting data, and use itself as hindcast data,
# use tgridData as observation.

biasFactor &lt;- getBiasFactor(nc, tgridData)
newFrc &lt;- applyBiasFactor(nc, biasFactor)
   
biasFactor &lt;- getBiasFactor(nc, tgridData, method = 'eqm', extrapolate = 'constant',
preci = TRUE)
# This method needs obs input.
newFrc &lt;- applyBiasFactor(nc, biasFactor, obs = tgridData)

biasFactor &lt;- getBiasFactor(nc, tgridData, method = 'gqm', preci = TRUE)
newFrc &lt;- applyBiasFactor(nc, biasFactor) 


######## Time series biascorrection
########

# Use the time series from testdl as an example, we take frc, hindcast and obs from testdl.
data(testdl)

# common period has to be extracted in order to better train the forecast.

datalist &lt;- extractPeriod(testdl, startDate = '1994-1-1', endDate = '1995-10-1')

frc &lt;- datalist[[1]]
hindcast &lt;- datalist[[2]]
obs &lt;- datalist[[3]]


# The data used here is just for example, so there could be negative data.

# default method is scaling
biasFactor &lt;- getBiasFactor(hindcast, obs)
frc_new &lt;- applyBiasFactor(frc, biasFactor)

# for precipitation data, extra process needs to be executed, so you have to tell
# the program to it is a precipitation data.

biasFactor &lt;- getBiasFactor(hindcast, obs, preci = TRUE)
frc_new1 &lt;- applyBiasFactor(frc, biasFactor)

# You can use other methods to biascorrect, e.g. delta method. 
biasFactor &lt;- getBiasFactor(hindcast, obs, method = 'delta')
# delta method needs obs input.
frc_new2 &lt;- applyBiasFactor(frc, biasFactor, obs = obs)

# 
biasFactor &lt;- getBiasFactor(hindcast, obs, method = 'eqm', preci = TRUE)
# eqm needs obs input
frc_new3 &lt;- applyBiasFactor(frc, biasFactor, obs = obs)

biasFactor &lt;- getBiasFactor(hindcast, obs, method = 'gqm', preci = TRUE)
frc_new4 &lt;- applyBiasFactor(frc, biasFactor)

plotTS(obs, frc, frc_new, frc_new1, frc_new2, frc_new3, frc_new4, plot = 'cum')

# You can also give name to this input list.
TSlist &lt;- list(obs, frc, frc_new, frc_new1, frc_new2, frc_new3, frc_new4)
names(TSlist) &lt;- c('obs', 'frc', 'delta', 'delta_preci', 'scale', 'eqm', 'gqm')
plotTS(list = TSlist, plot = 'cum')


# If the forecasts you extracted only has incontinuous data for certain months and years, e.g.,
# for seasonal forecasting, forecasts only provide 3-6 months data, so the case can be 
# for example Dec, Jan and Feb of every year from year 1999-2005.
# In such case, you need to extract certain months and years from observed time series.
# extractPeriod() can be then used.
  
  



# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/


</code></pre>

<hr>
<h2 id='getEnsem_comb'>Combine ensembles together</h2><span id='topic+getEnsem_comb'></span>

<h3>Description</h3>

<p>Combine ensembles together
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEnsem_comb(
  ...,
  list = NULL,
  nrow = 1,
  legend = TRUE,
  x = "",
  y = "",
  title = "",
  output = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getEnsem_comb_+3A_...">...</code></td>
<td>
<p>different ensembles generated by <code>getHisEnsem(, output = 'ggplot')</code> 
or <code>getFrcEnsem(, output = 'ggplot')</code>, see details.</p>
</td></tr>
<tr><td><code id="getEnsem_comb_+3A_list">list</code></td>
<td>
<p>If input is a list containing different ggplot data, use <code>list = inputlist</code>.</p>
</td></tr>
<tr><td><code id="getEnsem_comb_+3A_nrow">nrow</code></td>
<td>
<p>A number showing the number of rows.</p>
</td></tr>
<tr><td><code id="getEnsem_comb_+3A_legend">legend</code></td>
<td>
<p>A boolean representing whether you want the legend. Sometimes when you combine
plots, there will be a lot of legends, if you don't like it, you can turn it off by setting
<code>legend = FALSE</code>, default is TRUE.</p>
</td></tr>
<tr><td><code id="getEnsem_comb_+3A_x">x</code></td>
<td>
<p>A string of x axis name.</p>
</td></tr>
<tr><td><code id="getEnsem_comb_+3A_y">y</code></td>
<td>
<p>A string of y axis name.</p>
</td></tr>
<tr><td><code id="getEnsem_comb_+3A_title">title</code></td>
<td>
<p>A string of the title.</p>
</td></tr>
<tr><td><code id="getEnsem_comb_+3A_output">output</code></td>
<td>
<p>A boolean, if chosen TRUE, the output will be given.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A combined ensemble plot.
</p>


<h3>References</h3>


<ul>
<li><p> H. Wickham. ggplot2: elegant graphics for data analysis. Springer New York, 2009.
</p>
</li>
<li><p> Santander Meteorology Group (2015). downscaleR: Climate data manipulation and
statistical downscaling. R package version 0.6-0.
https://github.com/SantanderMetGroup/downscaleR/wiki
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(testdl)

a &lt;- testdl[[1]]

# Choose example from "1994-2-4" to "1996-1-4"


b1&lt;- getHisEnsem(a, example = c('1995-2-4', '1996-1-4'), plot = 'cum', output = 'ggplot',
                 name = 1)
                  
b2 &lt;- getHisEnsem(a, example = c('1995-4-4', '1996-3-4'), plot = 'cum', output = 'ggplot',
                 name = 2)

getEnsem_comb(b1, b2)
getEnsem_comb(list = list(b1, b2), nrow = 2)

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/


</code></pre>

<hr>
<h2 id='getFrcEnsem'>Extract time series from forecasting data.</h2><span id='topic+getFrcEnsem'></span>

<h3>Description</h3>

<p>getFrcEnsem extract timeseries from forecasting data, if forecasting data has a member session
an ensemble time sereis will be returned, if forecasting data doesn't have a member session, a singe time
series will be returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFrcEnsem(
  dataset,
  cell = "mean",
  plot = "norm",
  output = "data",
  name = NULL,
  mv = 0,
  coord = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getFrcEnsem_+3A_dataset">dataset</code></td>
<td>
<p>A list containing different information, should be the result of <code><a href="#topic+loadNcdf">loadNcdf</a></code></p>
</td></tr>
<tr><td><code id="getFrcEnsem_+3A_cell">cell</code></td>
<td>
<p>A vector containing the locaton of the cell, e.g. c(2, 3), default is &quot;mean&quot;, representing
the spatially averaged value. Check details for more information.</p>
</td></tr>
<tr><td><code id="getFrcEnsem_+3A_plot">plot</code></td>
<td>
<p>A string showing whether the plot will be shown, e.g., 'norm' means normal plot (without any process), 
'cum' means cummulative plot, default is 'norm'. For other words there will be no plot.</p>
</td></tr>
<tr><td><code id="getFrcEnsem_+3A_output">output</code></td>
<td>
<p>A string showing which type of output you want. Default is &quot;data&quot;, if &quot;ggplot&quot;, the 
data that can be directly plotted by ggplot2 will be returned, which is easier for you to make series
plots afterwards. NOTE: If <code>output = 'ggplot'</code>, the missing value in the data will
be replaced by <code>mv</code>, if assigned, default mv is 0.</p>
</td></tr>
<tr><td><code id="getFrcEnsem_+3A_name">name</code></td>
<td>
<p>If <code>output = 'ggplot'</code>, name has to be assigned to your output, in order to differentiate
different outputs in the later multiplot using <code>getEnsem_comb</code>.</p>
</td></tr>
<tr><td><code id="getFrcEnsem_+3A_mv">mv</code></td>
<td>
<p>A number showing representing the missing value. When calculating the cumulative value, 
missing value will be replaced by mv, default is 0.</p>
</td></tr>
<tr><td><code id="getFrcEnsem_+3A_coord">coord</code></td>
<td>
<p>A coordinate of longitude and latitude. e.g. corrd = c(lon, lat). If coord is assigned,
cell argument will no longer be used.</p>
</td></tr>
<tr><td><code id="getFrcEnsem_+3A_...">...</code></td>
<td>
<p><code>title, x, y</code> showing the title and x and y axis of the plot. e.g. <code>title = 'aaa'</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cell</code> representing the location of the cell, NOTE: this location means the index of the cell,
IT IS NOT THE LONGITUDE AND LATITUDE. e.g., <code>cell = c(2, 3)</code>, the program will take the 2nd longitude
and 3rd latitude, by the increasing order. Longitude comes first.
</p>
<p><code>name</code>
Assuming you have two ggplot outputs, you want to plot them together. In this situation, you
need a name column to differentiate one ggplot output from the other. You can assigne this name
by the argument directly, If name is not assigned and <code>output = 'ggplot'</code> is selected, then
the system time will be selected as name column.
</p>


<h3>Value</h3>

<p>A ensemble time series extracted from forecating data.
</p>


<h3>References</h3>


<ul>
<li><p> H. Wickham. ggplot2: elegant graphics for data analysis. Springer New York, 2009.
</p>
</li>
<li><p> Hadley Wickham (2007). Reshaping Data with the reshape Package. Journal of Statistical Software,
21(12), 1-20. URL http://www.jstatsoft.org/v21/i12/.
</p>
</li>
<li><p> Santander Meteorology Group (2015). downscaleR: Climate data manipulation and
statistical downscaling. R package version 0.6-0.
https://github.com/SantanderMetGroup/downscaleR/wiki
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
filePath &lt;- system.file("extdata", "tnc.nc", package = "hyfo")
# Then if you don't know the variable name, you can use \code{getNcdfVar} to get variable name
varname &lt;- getNcdfVar(filePath)
nc &lt;- loadNcdf(filePath, varname)
a &lt;- getFrcEnsem(nc)

# If there is no member session in the dataset, a single time sereis will be extracted.
a1 &lt;- getFrcEnsem(tgridData)


# The default output is spatially averaged, if there are more than one cells in the dataset, 
# the mean value of the cells will be calculated. While if you are interested in special cell, 
# you can assign the cell value. You can also directly use longitude and latitude to extract 
# time series.

getSpatialMap(nc, 'mean')
a &lt;- getFrcEnsem(nc, cell = c(6,2))

# From the map, cell = c(6, 2) means lon = -1.4, lat = 43.2, so you can use corrd to locate
# your research area and extract time series.
b &lt;- getFrcEnsem(nc, coord = c(-1.4, 43.2))


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getHisEnsem'>Get ensemble forecast from historical data.</h2><span id='topic+getHisEnsem'></span>

<h3>Description</h3>

<p>getHisEnsem use historical data as the forecasting input time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHisEnsem(
  TS,
  example,
  interval = 365,
  buffer = 0,
  plot = "norm",
  output = "data",
  name = NULL,
  mv = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getHisEnsem_+3A_ts">TS</code></td>
<td>
<p>A time series dataframe, with first column Date, and second column value.</p>
</td></tr>
<tr><td><code id="getHisEnsem_+3A_example">example</code></td>
<td>
<p>A vector containing two strings showing the start and end date, which represent the 
forecasting period. Check details for more information.
</p>
<p>the program will extract every possible period in TS you provided to generate the ensemble. Check details for 
more information.</p>
</td></tr>
<tr><td><code id="getHisEnsem_+3A_interval">interval</code></td>
<td>
<p>A number representing the interval of each ensemble member. NOTE: &quot;interval&quot; takes
365 as a year, and 30 as a month, regardless of leap year and months with 31 days. So if you want the interval 
to be 2 years, set <code>interval = 730</code>, which equals 2 * 365 ; if two months, set <code>interval = 60</code>; 
2 days, <code>interval = 2</code>, for other numbers that cannot be divided by 365 or 30 without remainder, it will treat the 
number as days.By defualt interval is set to be 365, a year.</p>
</td></tr>
<tr><td><code id="getHisEnsem_+3A_buffer">buffer</code></td>
<td>
<p>A number showing how many days are used as buffer period for models. Check details for more
information.</p>
</td></tr>
<tr><td><code id="getHisEnsem_+3A_plot">plot</code></td>
<td>
<p>A string showing whether the plot will be shown, e.g., 'norm' means normal plot (without any process), 
'cum' means cummulative plot, default is 'norm'. For other words there will be no plot.</p>
</td></tr>
<tr><td><code id="getHisEnsem_+3A_output">output</code></td>
<td>
<p>A string showing which type of output you want. Default is &quot;data&quot;, if &quot;ggplot&quot;, the 
data that can be directly plotted by ggplot2 will be returned, which is easier for you to make series
plots afterwards. NOTE: If <code>output = 'ggplot'</code>, the missing value in the data will
be replaced by <code>mv</code>, if assigned, default mv is 0.</p>
</td></tr>
<tr><td><code id="getHisEnsem_+3A_name">name</code></td>
<td>
<p>If <code>output = 'ggplot'</code>, name has to be assigned to your output, in order to differentiate
different outputs in the later multiplot using <code>getEnsem_comb</code>.</p>
</td></tr>
<tr><td><code id="getHisEnsem_+3A_mv">mv</code></td>
<td>
<p>A number showing representing the missing value. When calculating the cumulative value, 
missing value will be replaced by mv, default is 0.</p>
</td></tr>
<tr><td><code id="getHisEnsem_+3A_...">...</code></td>
<td>
<p><code>title, x, y</code> showing the title and x and y axis of the plot. e.g. <code>title = 'aaa'</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>example</code> E.g., if you have a time series from 2000 to 2010. Assuming you are in 2003,
you want to forecast the period from 2003-2-1 to 2003-4-1. Then for each year in your input
time series, every year from 1st Feb to 1st Apr will be extracted to generate the ensemble
forecasts. In this case your input example should be <code>example = c('2003-2-1', '2003-4-1')</code>
</p>
<p><code>interval</code> doesn't care about leap year and the months with 31 days, it will take 365 as a year, and 30 as a month.
e.g., if the interval is from 1999-2-1 to 1999-3-1, you should just set interval to 30, although the real interval is 28
days.
</p>
<p><code>example</code> and <code>interval</code> controls how the ensemble will be generated. e.g. if the time series is from 
1990-1-1 to 2001-1-1.
</p>
<p>if <code>example = c('1992-3-1', '1994-1-1')</code> and <code>interval = 1095</code>, note, 1095 = 365 * 3, so the program treat
this as 3 years.
</p>
<p>Then you are supposed to get the ensemble consisting of following part:
</p>
<p>1. 1992-3-1 to 1994-1-1 first one is the example, and it's NOT start from 1990-3-1.
2. 1995-3-1 to 1997-1-1 second one starts from 1993, because &quot;interval&quot; is 3 years.
3. 1998-3-1 to 2000-1-1
</p>
<p>because the last one &quot;2000-3-1 to 2002-1-1&quot;, 2002 exceeds the original TS range, so it will not be included.
</p>
<p>Sometimes, there are leap years and months with 31 days included in some ensemble part, in which case the length of the data will
be different, e.g., 1999-1-1 to 1999-3-1 is 1 day less than 2000-1-1 to 2000-3-1. In this situation,
the data will use example as a standard. If the example is 1999-1-1 to 1999-3-1, then the latter one
will be changed to 2001-1-1 to 2000-2-29, which keeps the start Date and change the end Date.
</p>
<p>If the end date is so important that cannot be changed, try to solve this problem by resetting
the example period, to make the event included in the example.
</p>
<p>Good set of example and interval can generate good ensemble.
</p>
<p><code>buffer</code>
Sometimes the model needs to run for a few days to warm up, before the forecast. E.g., if a forecast starts at
'1990-1-20', for some model like MIKE NAM model, the run needs to be started about 14 days. So the input timeseries
should start from '1990-1-6'.
</p>
<p>Buffer is mainly used for the model hotstart. Sometimes the hot start file cannot contain all the parameters needed,
only some important parameters. In this case, the model needs to run for some time, to make other parameters ready
for the simulation.
</p>
<p><code>name</code>
Assuming you have two ggplot outputs, you want to plot them together. In this situation, you
need a name column to differentiate one ggplot output from the other. You can assigne this name
by the argument directly, name has to be assigned if <code>output = 'ggplot'</code> is selected,
</p>


<h3>Value</h3>

<p>A ensemble time series using historical data as forecast.
</p>


<h3>References</h3>


<ul>
<li><p> Hadley Wickham (2007). Reshaping Data with the reshape Package. Journal of Statistical Software,
21(12), 1-20. URL http://www.jstatsoft.org/v21/i12/.
</p>
</li>
<li><p> H. Wickham. ggplot2: elegant graphics for data analysis. Springer New York, 2009.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(testdl)

a &lt;- testdl[[1]]

# Choose example from "1994-2-4" to "1996-1-4"
b &lt;- getHisEnsem(a, example = c('1994-2-4', '1996-1-4'))

# Default interval is one year, can be set to other values, check help for information.

# Take 7 months as interval
b &lt;- getHisEnsem(a, example = c('1994-2-4', '1996-1-4'), interval = 210, plot = 'cum') 
# Take 30 days as buffer
b &lt;- getHisEnsem(a, example = c('1994-2-4', '1996-1-4'), interval = 210, buffer = 30)


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/


</code></pre>

<hr>
<h2 id='getLMom'>get L moment analysis of the input distribution</h2><span id='topic+getLMom'></span>

<h3>Description</h3>

<p>get L moment analysis of the input distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLMom(dis)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLMom_+3A_dis">dis</code></td>
<td>
<p>A distribution, for hydrology usually a time series with only data column without time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The mean, L-variation, L-skewness and L-kurtosis of the input distribution
</p>


<h3>References</h3>


<ul>
<li><p> J. R. M. Hosking (2015). L-moments. R package, version 2.5. URL:
https://CRAN.R-project.org/package=lmom.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>dis &lt;- seq(1, 100)
getLMom(dis)

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getMeanPreci'>Get mean rainfall data.</h2><span id='topic+getMeanPreci'></span>

<h3>Description</h3>

<p>Get mean rainfall data, e.g. mean annual rainfall, mean monthly rainfall and mean winter rainfall.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMeanPreci(
  inputTS,
  method = NULL,
  yearIndex = NULL,
  monthIndex = NULL,
  fullResults = FALSE,
  omitNA = TRUE,
  plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMeanPreci_+3A_inputts">inputTS</code></td>
<td>
<p>A time series with only data column (1 column).</p>
</td></tr>
<tr><td><code id="getMeanPreci_+3A_method">method</code></td>
<td>
<p>A string showing the method used to calculate mean value, e.g., &quot;annual&quot;.
more information please refer to details.</p>
</td></tr>
<tr><td><code id="getMeanPreci_+3A_yearindex">yearIndex</code></td>
<td>
<p>A NUMERIC ARRAY showing the year index of the time series.</p>
</td></tr>
<tr><td><code id="getMeanPreci_+3A_monthindex">monthIndex</code></td>
<td>
<p>A NUMERIC ARRAY showing the month index of the time series.</p>
</td></tr>
<tr><td><code id="getMeanPreci_+3A_fullresults">fullResults</code></td>
<td>
<p>A boolean showing whether the full results are shown, default is FALSE. If 
FALSE, only mean value will be returned, if TRUE, the sequence of values will be returned.</p>
</td></tr>
<tr><td><code id="getMeanPreci_+3A_omitna">omitNA</code></td>
<td>
<p>A boolean showing in the calculation, whether NA is omitted, default is FALSE.</p>
</td></tr>
<tr><td><code id="getMeanPreci_+3A_plot">plot</code></td>
<td>
<p>A boolean showing whether the results will be plotted.</p>
</td></tr>
<tr><td><code id="getMeanPreci_+3A_...">...</code></td>
<td>
<p><code>title, x, y</code> showing the title and x and y axis of the plot, shoud be a string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are following methods to be selected, 
&quot;annual&quot;: annual rainfall of each year is plotted.  
&quot;winter&quot;, &quot;spring&quot;, &quot;autumn&quot;, &quot;summer&quot;: seasonal rainfall of each year is plotted.
Month(number 1 to 12): month rainfall of each year is plotted, e.g. march rainfall of each year.
&quot;meanMonthly&quot;: the mean monthly rainfall of each month over the whole period.
</p>
<p>Since &quot;winter&quot; is a crossing year, 12, 1, 2, 12 is in former year, and 1, 2 are in latter year.
so winter belongs to the latter year.
</p>


<h3>Value</h3>

<p>The mean value of the input time series or the full results before calculating mean.
</p>

<hr>
<h2 id='getMoment'>get moment analysis of the input distribution</h2><span id='topic+getMoment'></span>

<h3>Description</h3>

<p>get moment analysis of the input distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMoment(dis)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMoment_+3A_dis">dis</code></td>
<td>
<p>A distribution, for hydrology usually a time series with only data column without time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The mean, variation, skewness and kurtosis of the input distribution
</p>


<h3>References</h3>


<ul>
<li><p> Lukasz Komsta and Frederick Novomestky (2015). moments: Moments, cumulants, skewness, kurtosis and
related tests. R package version 0.14. https://CRAN.R-project.org/package=moments
</p>
</li>
<li><p> R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>dis &lt;- seq(1, 100)
getMoment(dis)

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getNcdfVar'>Get variable name of the NetCDF file.</h2><span id='topic+getNcdfVar'></span>

<h3>Description</h3>

<p>Get variable name in the NetCDF file. After knowning the name, you can use <code>loadNcdf</code> to load
the target variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNcdfVar(filePath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNcdfVar_+3A_filepath">filePath</code></td>
<td>
<p>A path pointing to the netCDF file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The names of the varialbes in the file.
</p>


<h3>References</h3>


<ul>
<li><p> David Pierce (2015). ncdf4: Interface to Unidata netCDF (Version 4 or
Earlier) Format Data Files. R package version 1.14.1.
https://CRAN.R-project.org/package=ncdf4
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># First open the test NETcDF file.
filePath &lt;- system.file("extdata", "tnc.nc", package = "hyfo")

# Then if you don't know the variable name, you can use \code{getNcdfVar} to get variable name
varname &lt;- getNcdfVar(filePath)

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getPreciBar'>get mean rainfall bar plot of the input dataset or time series.</h2><span id='topic+getPreciBar'></span><span id='topic+getPreciBar+2Clist-method'></span><span id='topic+getPreciBar+2Cdata.frame-method'></span>

<h3>Description</h3>

<p>get mean rainfall bar plot of the input dataset or time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPreciBar(
  data,
  method,
  cell = "mean",
  output = "data",
  name = NULL,
  plotRange = TRUE,
  member = NULL,
  omitNA = TRUE,
  info = FALSE,
  ...
)

## S4 method for signature 'list'
getPreciBar(
  data,
  method,
  cell = "mean",
  output = "data",
  name = NULL,
  plotRange = TRUE,
  member = NULL,
  omitNA = TRUE,
  info = FALSE,
  ...
)

## S4 method for signature 'data.frame'
getPreciBar(
  data,
  method,
  cell = "mean",
  output = "data",
  name = NULL,
  plotRange = TRUE,
  member = NULL,
  omitNA = TRUE,
  info = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPreciBar_+3A_data">data</code></td>
<td>
<p>A list containing different information, should be the result of reading netcdf file using
<code><a href="#topic+loadNcdf">loadNcdf</a></code>, or a time series, with first column the Date, second the value.
Time series can be an ENSEMBLE containning different members. Than the mean value will be given and the range will be given.</p>
</td></tr>
<tr><td><code id="getPreciBar_+3A_method">method</code></td>
<td>
<p>A string showing the calculating method of the input time series. More information
please refer to the details.</p>
</td></tr>
<tr><td><code id="getPreciBar_+3A_cell">cell</code></td>
<td>
<p>A vector containing the locaton of the cell, e.g. c(2, 3), default is &quot;mean&quot;, representing
the spatially averaged value. Check details for more information.</p>
</td></tr>
<tr><td><code id="getPreciBar_+3A_output">output</code></td>
<td>
<p>A string showing the type of the output, if <code>output = 'ggplot'</code>, the returned 
data can be used in ggplot and <code>getPreciBar_comb()</code>; if <code>output = 'plot'</code>, the returned data is the plot containing all 
layers' information, and can be plot directly or used in grid.arrange; if not set, the data
will be returned.</p>
</td></tr>
<tr><td><code id="getPreciBar_+3A_name">name</code></td>
<td>
<p>If <code>output = 'ggplot'</code>, name has to be assigned to your output, in order to differentiate
different outputs in the later multiplot using <code>getSpatialMap_comb</code>.</p>
</td></tr>
<tr><td><code id="getPreciBar_+3A_plotrange">plotRange</code></td>
<td>
<p>A boolean showing whether the range will be plotted.</p>
</td></tr>
<tr><td><code id="getPreciBar_+3A_member">member</code></td>
<td>
<p>A number showing which member is selected to get, if the dataset has a &quot;member&quot; dimension. Default
is NULL, if no member assigned, and there is a &quot;member&quot; in dimensions, the mean value of the members will be
taken.</p>
</td></tr>
<tr><td><code id="getPreciBar_+3A_omitna">omitNA</code></td>
<td>
<p>A boolean showing whether the missing value is omitted.</p>
</td></tr>
<tr><td><code id="getPreciBar_+3A_info">info</code></td>
<td>
<p>A boolean showing whether the information of the map, e.g., max, mean ..., default is FALSE.</p>
</td></tr>
<tr><td><code id="getPreciBar_+3A_...">...</code></td>
<td>
<p><code>title, x, y</code> showing the title and x and y axis of the plot. e.g. <code>title = 'aaa'</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are following methods to be selected, 
&quot;annual&quot;: annual rainfall of each year is plotted.  
&quot;winter&quot;, &quot;spring&quot;, &quot;autumn&quot;, &quot;summer&quot;: seasonal rainfall of each year is plotted.
Month(number 1 to 12): month rainfall of each year is plotted, e.g. march rainfall of each year.
&quot;meanMonthly&quot;: the mean monthly rainfall of each month over the whole period.
</p>
<p>#Since &quot;winter&quot; is a crossing year, 12, 1, 2, 12 is in former year, and 1, 2 are in latter year.
#so winter belongs to the latter year.
</p>
<p><code>cell</code> representing the location of the cell, NOTE: this location means the index of the cell,
IT IS NOT THE LONGITUDE AND LATITUDE. e.g., <code>cell = c(2, 3)</code>, the program will take the 2nd longitude
and 3rd latitude, by the increasing order. Longitude comes first.
</p>
<p>It is a generic function, if in your case you need to debug, please see <code>?debug()</code> 
for how to debug S4 method.
</p>


<h3>Value</h3>

<p>The calculated mean value of the input time series and the plot of the result.
</p>


<h3>References</h3>


<ul>
<li><p> Hadley Wickham (2007). Reshaping Data with the reshape Package. Journal of Statistical Software,
21(12), 1-20. URL http://www.jstatsoft.org/v21/i12/.
</p>
</li>
<li><p> H. Wickham. ggplot2: elegant graphics for data analysis. Springer New York, 2009.
</p>
</li>
<li><p> R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#gridData provided by package is the result of \code{loadNcdf()}
data(tgridData)
b1 &lt;- getPreciBar(tgridData, method = 'annual')
b2 &lt;- getPreciBar(tgridData, method = 'meanMonthly')

data(testdl)
TS  &lt;- testdl[[1]]
a &lt;- getPreciBar(TS, method = 'spring')
# if info = T, the information will be given at the bottom.
a &lt;- getPreciBar(TS, method = 'spring', info = TRUE)


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getPreciBar_comb'>Combine bars together</h2><span id='topic+getPreciBar_comb'></span>

<h3>Description</h3>

<p>Combine bars together
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPreciBar_comb(
  ...,
  list = NULL,
  nrow = 1,
  x = "",
  y = "",
  title = "",
  output = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPreciBar_comb_+3A_...">...</code></td>
<td>
<p>different barplots generated by <code>getPreciBar(, output = 'ggplot')</code>, refer to details.</p>
</td></tr>
<tr><td><code id="getPreciBar_comb_+3A_list">list</code></td>
<td>
<p>If input is a list containing different ggplot data, use l<code>list = inputlist</code>.
NOTE: yOU HAVE TO PUT A <code>list = </code>, before your list.</p>
</td></tr>
<tr><td><code id="getPreciBar_comb_+3A_nrow">nrow</code></td>
<td>
<p>A number showing the number of rows.</p>
</td></tr>
<tr><td><code id="getPreciBar_comb_+3A_x">x</code></td>
<td>
<p>A string of x axis name.</p>
</td></tr>
<tr><td><code id="getPreciBar_comb_+3A_y">y</code></td>
<td>
<p>A string of y axis name.</p>
</td></tr>
<tr><td><code id="getPreciBar_comb_+3A_title">title</code></td>
<td>
<p>A string of the title.</p>
</td></tr>
<tr><td><code id="getPreciBar_comb_+3A_output">output</code></td>
<td>
<p>A boolean, if chosen TRUE, the output will be given.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>..., representing different ouput generated by <code>getPreciBar(, output = 'ggplot')</code>, they 
have to be of the same type, e.g., 
1. Jan precipitation of different years, Feb precipitation of different years, and... 
They are both monthly precipitation, and they share x axis.
</p>
<p>2. Mean monthly precipitation of different dataset. e.g., long term mean monthly precipitation
and short term mean monthly precipitation. They are both mean monthly precipitation.
</p>


<h3>Value</h3>

<p>A combined barplot.
</p>


<h3>References</h3>


<ul>
<li><p> H. Wickham. ggplot2: elegant graphics for data analysis. Springer New York, 2009.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(tgridData)# the result of \code{\link{loadNcdf}}
#output type of getPreciBar() has to be 'ggplot'.
b1 &lt;- getPreciBar(tgridData, method = 2, output = 'ggplot', name = 'b1')
b2 &lt;- getPreciBar(tgridData, method = 3, output = 'ggplot', name = 'b2')

getPreciBar_comb(b1, b2)

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getSpatialMap'>Get spatial map of the input dataset.</h2><span id='topic+getSpatialMap'></span>

<h3>Description</h3>

<p>Get spatial map of the input dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpatialMap(dataset, method = NULL, member = "mean", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSpatialMap_+3A_dataset">dataset</code></td>
<td>
<p>A list containing different information, should be the result of reading netcdf file using
<code>loadNcdf</code>.</p>
</td></tr>
<tr><td><code id="getSpatialMap_+3A_method">method</code></td>
<td>
<p>A string showing different calculating method for the map. More information please refer to
details.</p>
</td></tr>
<tr><td><code id="getSpatialMap_+3A_member">member</code></td>
<td>
<p>A number showing which member is selected to get, if the dataset has a &quot;member&quot; dimension. Default
is NULL, if no member assigned, and there is a &quot;member&quot; in dimensions, the mean value of the members will be
taken.</p>
</td></tr>
<tr><td><code id="getSpatialMap_+3A_...">...</code></td>
<td>
<p>several arguments including x, y, title, catchment, point, output, name, info, scale, color, 
type in <code>?getSpatialMap_mat</code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are following methods to be selected, 
&quot;meanAnnual&quot;: annual rainfall of each year is plotted.  
&quot;winter&quot;, &quot;spring&quot;, &quot;autumn&quot;, &quot;summer&quot;: MEAN seasonal rainfall of each year is plotted.
Month(number 1 to 12): MEAN month rainfall of each year is plotted, e.g. MEAN march rainfall of each year.
&quot;mean&quot;, &quot;max&quot;, &quot;min&quot;: mean daily, maximum daily, minimum daily precipitation.
</p>


<h3>Value</h3>

<p>A matrix representing the raster map is returned, and the map is plotted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
#gridData provided in the package is the result of \code {loadNcdf}
data(tgridData)
getSpatialMap(tgridData, method = 'meanAnnual')
getSpatialMap(tgridData, method = 'winter')


getSpatialMap(tgridData, method = 'winter', catchment = testCat)

file &lt;- system.file("extdata", "point.txt", package = "hyfo")
point &lt;- read.table(file, header = TRUE, sep = ',' )
getSpatialMap(tgridData, method = 'winter', catchment = testCat, point = point)

## End(Not run)


# More examples can be found in the user manual on http://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getSpatialMap_comb'>Combine maps together</h2><span id='topic+getSpatialMap_comb'></span>

<h3>Description</h3>

<p>Combine maps together
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpatialMap_comb(
  ...,
  list = NULL,
  nrow = 1,
  x = "",
  y = "",
  title = "",
  output = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSpatialMap_comb_+3A_...">...</code></td>
<td>
<p>different maps generated by <code>getSpatialMap(, output = 'ggplot')</code>, see details.</p>
</td></tr>
<tr><td><code id="getSpatialMap_comb_+3A_list">list</code></td>
<td>
<p>If input is a list containing different ggplot data, use <code>list = inputlist</code>.</p>
</td></tr>
<tr><td><code id="getSpatialMap_comb_+3A_nrow">nrow</code></td>
<td>
<p>A number showing the number of rows.</p>
</td></tr>
<tr><td><code id="getSpatialMap_comb_+3A_x">x</code></td>
<td>
<p>A string of x axis name.</p>
</td></tr>
<tr><td><code id="getSpatialMap_comb_+3A_y">y</code></td>
<td>
<p>A string of y axis name.</p>
</td></tr>
<tr><td><code id="getSpatialMap_comb_+3A_title">title</code></td>
<td>
<p>A string of the title.</p>
</td></tr>
<tr><td><code id="getSpatialMap_comb_+3A_output">output</code></td>
<td>
<p>A boolean, if chosen TRUE, the output will be given.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>getSpatialMap_comb</code>, the maps to be compared should be with same size and resolution, 
in other words, they should be fully overlapped by each other.
</p>
<p>If they have different resolutions, use <code>interpGridData{ecomsUDG.Raccess}</code> to interpolate.
</p>


<h3>Value</h3>

<p>A combined map.
</p>


<h3>References</h3>


<ul>
<li><p> H. Wickham. ggplot2: elegant graphics for data analysis. Springer New York, 2009.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
data(tgridData)# the result of \code{\link{loadNcdf}}
#The output should be 'ggplot'
a1 &lt;- getSpatialMap(tgridData, method = 'summer', output = 'ggplot', name = 'a1')
a2 &lt;- getSpatialMap(tgridData, method = 'winter', output = 'ggplot', name = 'a2')
a3 &lt;- getSpatialMap(tgridData, method = 'mean', output = 'ggplot', name = 'a3')
a4 &lt;- getSpatialMap(tgridData, method = 'max', output = 'ggplot', name = 'a4')
getSpatialMap_comb(a1, a2)

# or you can put them into a list.
getSpatialMap_comb(list = list(a1, a2), nrow = 2)

## End(Not run)



# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='getSpatialMap_mat'>Replot raster matrix</h2><span id='topic+getSpatialMap_mat'></span>

<h3>Description</h3>

<p>replot the matrix output from <code>getSpatialMap</code>, when <code>output = 'data'</code> or output is default
value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpatialMap_mat(
  matrix,
  title_d = NULL,
  catchment = NULL,
  point = NULL,
  output = "data",
  name = NULL,
  info = FALSE,
  scale = "identity",
  color = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSpatialMap_mat_+3A_matrix">matrix</code></td>
<td>
<p>A matrix raster, should be the result of <code>getSpatialMap()</code>, output should be default
or 'data'</p>
</td></tr>
<tr><td><code id="getSpatialMap_mat_+3A_title_d">title_d</code></td>
<td>
<p>A string showing the title of the plot, defaut is NULL.</p>
</td></tr>
<tr><td><code id="getSpatialMap_mat_+3A_catchment">catchment</code></td>
<td>
<p>A catchment file geting from <code>shp2cat()</code> in the package, if a catchment is available for background.</p>
</td></tr>
<tr><td><code id="getSpatialMap_mat_+3A_point">point</code></td>
<td>
<p>A dataframe, showing other information, e.g., location of the gauging stations. The 
the data.frame should be with columes &quot;name, lon, lat, z, value&quot;.</p>
</td></tr>
<tr><td><code id="getSpatialMap_mat_+3A_output">output</code></td>
<td>
<p>A string showing the type of the output, if <code>output = 'ggplot'</code>, the returned 
data can be used in ggplot and <code>getSpatialMap_comb()</code>; if <code>output = 'plot'</code>, the returned data is the plot containing all 
layers' information, and can be plot directly or used in grid.arrange; if not set, the raster matrix data
will be returned.</p>
</td></tr>
<tr><td><code id="getSpatialMap_mat_+3A_name">name</code></td>
<td>
<p>If <code>output = 'ggplot'</code>, name has to be assigned to your output, in order to differentiate
different outputs in the later multiplot using <code>getSpatialMap_comb</code>.</p>
</td></tr>
<tr><td><code id="getSpatialMap_mat_+3A_info">info</code></td>
<td>
<p>A boolean showing whether the information of the map, e.g., max, mean ..., default is FALSE.</p>
</td></tr>
<tr><td><code id="getSpatialMap_mat_+3A_scale">scale</code></td>
<td>
<p>A string showing the plot scale, 'identity' or 'sqrt'.</p>
</td></tr>
<tr><td><code id="getSpatialMap_mat_+3A_color">color</code></td>
<td>
<p>Most of time you don't have to set this, but if you are not satisfied with the 
default color, you can set your own palette here. e.g., <code>color = c('red', 'blue')</code>, then
the value from lowest to highest, will have the color from red to blue. More info about color,
please check ?palette().</p>
</td></tr>
<tr><td><code id="getSpatialMap_mat_+3A_...">...</code></td>
<td>
<p><code>title, x, y</code> showing the title and x and y axis of the plot. e.g. <code>title = 'aaa'</code>
default is about precipitation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix representing the raster map is returned, and the map is plotted.
</p>


<h3>References</h3>


<ul>
<li><p> R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
</p>
</li>
<li><p> Hadley Wickham (2007). Reshaping Data with the reshape Package. Journal of Statistical Software,
21(12), 1-20. URL http://www.jstatsoft.org/v21/i12/.
</p>
</li>
<li><p> Hadley Wickham (2011). The Split-Apply-Combine Strategy for Data Analysis. Journal of Statistical
Software, 40(1), 1-29. URL http://www.jstatsoft.org/v40/i01/.
</p>
</li>
<li><p> Original S code by Richard A. Becker and Allan R. Wilks. R version by Ray Brownrigg. Enhancements
by Thomas P Minka &lt;tpminka at media.mit.edu&gt; (2015). maps: Draw Geographical Maps. R package version
2.3-11. https://CRAN.R-project.org/package=maps
</p>
</li>
<li><p> Pebesma, Edzer, and Roger Bivand. 2023a. Sp: Classes and Methods for Spatial Data. https://CRAN.R-project.org/package=sp.
</p>
</li>
<li><p> Roger Bivand and Colin Rundel (2015). rgeos: Interface to Geometry Engine - Open Source (GEOS). R
package version 0.3-11. https://CRAN.R-project.org/package=sf
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(tgridData)# the result of \code{loadNcdf}
#the output type of has to be default or 'data'.
a1 &lt;- getSpatialMap(tgridData, method = 'mean')
a2 &lt;- getSpatialMap(tgridData, method = 'max')
a3 &lt;- getSpatialMap(tgridData, method = 'winter')
a4 &lt;- getSpatialMap(tgridData, method = 'summer')
#For example, if we want to investigate the difference between mean value and max.

a5 &lt;- a2 - a1
getSpatialMap_mat(a4)

#Or to investigate the difference between winter value and summer value.
a6 &lt;- a3 - a4
getSpatialMap_mat(a6)


## End(Not run)


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='list2Dataframe'>Convert a list to a dataframe.</h2><span id='topic+list2Dataframe'></span>

<h3>Description</h3>

<p>Convert a list of different time series to a dataframe. Usually the list is the output of
<code>extractPeriod</code>
NOTE: Since it's dataframe, so the dataframes in the input datalist should have the same 
date, if not, please use  <code>extractPeriod</code> to process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list2Dataframe(datalist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list2Dataframe_+3A_datalist">datalist</code></td>
<td>
<p>A list containing different time series, each sub list has to have the same length.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The converted dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'># open file attached in the package.
file &lt;- system.file("extdata", "testdl.txt", package = "hyfo")
datalist &lt;- dget(file) # read list file.
datalist_new &lt;- extractPeriod(datalist, commonPeriod = TRUE)

dataframe &lt;- list2Dataframe(datalist_new)

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='loadNcdf'>Load NetCDF file</h2><span id='topic+loadNcdf'></span>

<h3>Description</h3>

<p>Load NetCDF file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadNcdf(filePath, varname, tz = "GMT", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadNcdf_+3A_filepath">filePath</code></td>
<td>
<p>A path pointing to the NetCDF file, version3.</p>
</td></tr>
<tr><td><code id="loadNcdf_+3A_varname">varname</code></td>
<td>
<p>A character representing the variable name, you can use <code>getNcdfVar</code> to
get the basic information about the variables and select the target.</p>
</td></tr>
<tr><td><code id="loadNcdf_+3A_tz">tz</code></td>
<td>
<p>A string representing the time zone, default is GMT, if you know what time zone is 
you can assign it in the argument. If <code>tz = ''</code>, current time zone will be taken.</p>
</td></tr>
<tr><td><code id="loadNcdf_+3A_...">...</code></td>
<td>
<p>Several arguments including Year, month, lon, lat 
type in <code>?downscaleNcdf</code> for details.You can load while downscale, 
and also first load than use <code>downscaleNcdf</code> to downscale.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object from <code>hyfo</code> containing the information to be used in the analysis, 
or biascorrection.
</p>


<h3>References</h3>


<ul>
<li><p> David Pierce (2015). ncdf4: Interface to Unidata netCDF (Version 4 or
Earlier) Format Data Files. R package version 1.14.1.
https://CRAN.R-project.org/package=ncdf4
</p>
</li>
<li><p> Santander MetGroup (2015). ecomsUDG.Raccess: R interface to the ECOMS User Data Gateway. R package
version 2.2-6. http://meteo.unican.es/ecoms-udg
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># First open the test NETcDF file.
filePath &lt;- system.file("extdata", "tnc.nc", package = "hyfo")

# Then if you don't know the variable name, you can use \code{getNcdfVar} to get variable name
varname &lt;- getNcdfVar(filePath)

nc &lt;- loadNcdf(filePath, varname)

# you can directly add your downscale information to the argument.
nc1 &lt;- loadNcdf(filePath, varname, year = 2006, lon = c(-2, -0.5), lat = c(43.2, 43.7))
nc2 &lt;- loadNcdf(filePath, varname, year = 2005, month = 3:8, lon = c(-2, -0.5), 
lat = c(43.2, 43.7))

# More examples can be found in the user manual on http://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='monthlyPreci'>Get monthly rainfall</h2><span id='topic+monthlyPreci'></span>

<h3>Description</h3>

<p>Get monthly rainfall
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monthlyPreci(TS, year, mon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monthlyPreci_+3A_ts">TS</code></td>
<td>
<p>A rainfall time series.</p>
</td></tr>
<tr><td><code id="monthlyPreci_+3A_year">year</code></td>
<td>
<p>A list showing the year index of the time series.</p>
</td></tr>
<tr><td><code id="monthlyPreci_+3A_mon">mon</code></td>
<td>
<p>A list showing the mon index of the time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the monthly rainfall matrix of the rainfall time series.
</p>

<hr>
<h2 id='plotTS'>plot time series, with marks on missing value.</h2><span id='topic+plotTS'></span>

<h3>Description</h3>

<p>plot time series, with marks on missing value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTS(
  ...,
  type = "line",
  output = "data",
  plot = "norm",
  name = NULL,
  showNA = TRUE,
  x = NULL,
  y = NULL,
  title = NULL,
  list = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotTS_+3A_...">...</code></td>
<td>
<p>input time series.</p>
</td></tr>
<tr><td><code id="plotTS_+3A_type">type</code></td>
<td>
<p>A string representing the type of the time series, e.g. 'line' or 'bar'.</p>
</td></tr>
<tr><td><code id="plotTS_+3A_output">output</code></td>
<td>
<p>A string showing which type of output you want. Default is &quot;data&quot;, if &quot;ggplot&quot;, the 
data that can be directly plotted by ggplot2 will be returned, which is easier for you to make series
plots afterwards.</p>
</td></tr>
<tr><td><code id="plotTS_+3A_plot">plot</code></td>
<td>
<p>representing the plot type, there are two types, &quot;norm&quot; and &quot;cum&quot;, &quot;norm&quot; gives an normal
plot, and &quot;cum&quot; gives a cumulative plot. Default is &quot;norm&quot;.</p>
</td></tr>
<tr><td><code id="plotTS_+3A_name">name</code></td>
<td>
<p>If <code>output = 'ggplot'</code>, name has to be assigned to your output, in order to differentiate
different outputs in the later multiplot using <code>plotTS_comb</code>.</p>
</td></tr>
<tr><td><code id="plotTS_+3A_showna">showNA</code></td>
<td>
<p>A boolean representing whether the NA values should be marked, default is TRUE.</p>
</td></tr>
<tr><td><code id="plotTS_+3A_x">x</code></td>
<td>
<p>label for x axis.</p>
</td></tr>
<tr><td><code id="plotTS_+3A_y">y</code></td>
<td>
<p>label for y axis.</p>
</td></tr>
<tr><td><code id="plotTS_+3A_title">title</code></td>
<td>
<p>plot title.</p>
</td></tr>
<tr><td><code id="plotTS_+3A_list">list</code></td>
<td>
<p>If your input is a list of time series, then use <code>list = your time sereis list</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If your input has more than one time series, the program will only plot the common period of 
different time series.
</p>


<h3>Value</h3>

<p>A plot of the input time series.
</p>


<h3>References</h3>


<ul>
<li><p> H. Wickham. ggplot2: elegant graphics for data analysis. Springer New York, 2009.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>plotTS(testdl[[1]])
plotTS(testdl[[1]], x = 'xxx', y = 'yyy', title = 'aaa')

# If input is a datalist
plotTS(list = testdl)

# Or if you want to input time series one by one
# If plot = 'cum' then cumulative curve will  be plotted.
plotTS(testdl[[1]], testdl[[2]], plot = 'cum')

# You can also directly plot multicolumn dataframe
dataframe &lt;- list2Dataframe(extractPeriod(testdl, commonPeriod = TRUE))
plotTS(dataframe, plot = 'cum')

# Sometimes you may want to process the dataframe and compare with the original one
dataframe1 &lt;- dataframe
dataframe1[, 2:4] &lt;- dataframe1[, 2:4] + 3
plotTS(dataframe, dataframe1, plot = 'cum')
# But note, if your input is a multi column dataframe, it's better to plot one using plotTS,
# and compare them using plotTS_comb. If all data are in one plot, there might be too messy.


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='plotTS_comb'>Combine time seires plot together</h2><span id='topic+plotTS_comb'></span>

<h3>Description</h3>

<p>Combine time seires plot together
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTS_comb(
  ...,
  nrow = 1,
  type = "line",
  list = NULL,
  x = "Date",
  y = "",
  title = "",
  output = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotTS_comb_+3A_...">...</code></td>
<td>
<p>different time series plots generated by <code>plotTS(, output = 'ggplot')</code>, refer to details.</p>
</td></tr>
<tr><td><code id="plotTS_comb_+3A_nrow">nrow</code></td>
<td>
<p>A number showing the number of rows.</p>
</td></tr>
<tr><td><code id="plotTS_comb_+3A_type">type</code></td>
<td>
<p>A string showing 'line' or 'bar'.</p>
</td></tr>
<tr><td><code id="plotTS_comb_+3A_list">list</code></td>
<td>
<p>If input is a list containing different ggplot data, use l<code>list = inputlist</code>.</p>
</td></tr>
<tr><td><code id="plotTS_comb_+3A_x">x</code></td>
<td>
<p>A string of x axis name.</p>
</td></tr>
<tr><td><code id="plotTS_comb_+3A_y">y</code></td>
<td>
<p>A string of y axis name.</p>
</td></tr>
<tr><td><code id="plotTS_comb_+3A_title">title</code></td>
<td>
<p>A string of the title.</p>
</td></tr>
<tr><td><code id="plotTS_comb_+3A_output">output</code></td>
<td>
<p>A boolean, if chosen TRUE, the output will be given.
NOTE: yOU HAVE TO PUT A <code>list = </code>, before your list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>..., representing different ouput file generated by <code>plotTS(, output = 'ggplot'), name = yourname</code>, 
different names must be assigned when generating different output.
</p>
<p>e.g.
a1, a2, a3 are different files generated by <code>plotTS(, output = 'ggplot'), name = yourname</code>, you can
set <code>plotTS(a1,a2,a3)</code> or <code>plotTS(list = list(a1,a2,a3))</code>
</p>


<h3>Value</h3>

<p>A combined time series plot.
</p>


<h3>References</h3>


<ul>
<li><p> H. Wickham. ggplot2: elegant graphics for data analysis. Springer New York, 2009.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>a1 &lt;- plotTS(testdl[[1]], output = 'ggplot', name = 1)
a2 &lt;- plotTS(testdl[[2]], output = 'ggplot', name = 2)

plotTS_comb(a1, a2)
plotTS_comb(list = list(a1, a2), y = 'y axis', nrow = 2)

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='resample'>Resample your time series or ncdf files.</h2><span id='topic+resample'></span><span id='topic+resample+2Cdata.frame-method'></span><span id='topic+resample+2Clist-method'></span>

<h3>Description</h3>

<p>Resameple your time series or ncdf files, more info pleae see details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resample(data, method)

## S4 method for signature 'data.frame'
resample(data, method)

## S4 method for signature 'list'
resample(data, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resample_+3A_data">data</code></td>
<td>
<p>a hyfo grid data or a time series, with first column date, and second column value. The date column should
follow the format in <code>as.Date</code>, i.e. seperate with &quot;-&quot; or &quot;/&quot;. Check details for more information.</p>
</td></tr>
<tr><td><code id="resample_+3A_method">method</code></td>
<td>
<p>A string showing whether you want to change a daily data to monthly data or monthly
data to daily data.e.g. &quot;mon2day&quot; and &quot;day2mon&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note, when you want to change daily data to monthly data, a new date column will be generated,
usually the date column will be the middle date of each month, 15th, or 16th. However, if your 
time series doesn't start from the beginning of a month or ends to the end of a month, e.g. 
from 1999-3-14 to 2008-2-2, the first and last generated date could be wrong. Not only the date, but also the data, because you are 
not calculating based on a intact month. 
</p>
<p>It is a generic function, if in your case you need to debug, please see <code>?debug()</code> 
for how to debug S4 method.
</p>


<h3>Value</h3>

<p>converted time series.
</p>


<h3>References</h3>


<ul>
<li><p> R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Daily to monthly
data(testdl)
TS &lt;- testdl[[2]] # Get daily data
str(TS)
TS_new &lt;- resample(TS, method = 'day2mon')

# Monthly to daily
TS &lt;- data.frame(Date = seq(as.Date('1999-9-15'), length = 30, by = '1 month'), 
runif(30, 3, 10))
TS_new &lt;- resample(TS, method = 'mon2day')

#' # First load ncdf file.
filePath &lt;- system.file("extdata", "tnc.nc", package = "hyfo")
varname &lt;- getNcdfVar(filePath)    
nc &lt;- loadNcdf(filePath, varname)

nc_new &lt;- resample(nc, 'day2mon')


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='shp2cat'>Get a catchment object from selected shape file.</h2><span id='topic+shp2cat'></span>

<h3>Description</h3>

<p>Get a catchment object from selected shape file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shp2cat(filePath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shp2cat_+3A_filepath">filePath</code></td>
<td>
<p>A string representing the path of the shape file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is based on the package <code>sf</code> and <code>sp</code>, and the output comes from the package 
<code>sp</code>
</p>


<h3>Value</h3>

<p>A catchment object can be used in <code>getSpatialMap()</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Roger Bivand, Tim Keitt and Barry Rowlingson (2015). rgdal: Bindings for the Geospatial Data
Abstraction Library. R package version 1.0-4. https://CRAN.R-project.org/package=sf
</p>
</li>
<li><p> R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#open internal file
file &lt;- system.file("extdata", "testCat.shp", package = "hyfo")
catchment &lt;- shp2cat(file)

# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

<hr>
<h2 id='testCat'>testCat</h2><span id='topic+testCat'></span>

<h3>Description</h3>

<p>testCat
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testCat
</code></pre>


<h3>Format</h3>

<p>A catchment file generated by library sf.
</p>

<dl>
<dt>class</dt><dd><p>Formal class 'SpatialPolygonsDataFrame' [package &quot;sp&quot;] with 5 slots</p>
</dd>
</dl>
<p>...

</p>

<hr>
<h2 id='testdl'>testdl</h2><span id='topic+testdl'></span>

<h3>Description</h3>

<p>A list containing different precipitation time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testdl
</code></pre>


<h3>Format</h3>

<p>A list consists of 3 different lists.
</p>

<dl>
<dt>AAA</dt><dd><p>AAA, a dataframe containing a date column and a value column. </p>
</dd>
<dt>BBB</dt><dd><p>BBB, a dataframe containing a date column and a value column.</p>
</dd>
<dt>CCC</dt><dd><p>CCC, a dataframe containing a date column and a value column.</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p>http://meteo.navarra.es/estaciones/mapadeestaciones.cfm
http://www4.gipuzkoa.net/oohh/web/esp/02.asp
</p>


<h3>References</h3>


<ul>
<li><p> http://meteo.navarra.es/estaciones/mapadeestaciones.cfm
</p>
</li>
<li><p> #' http://www4.gipuzkoa.net/oohh/web/esp/02.asp
</p>
</li></ul>


<hr>
<h2 id='tgridData'>tgridData</h2><span id='topic+tgridData'></span>

<h3>Description</h3>

<p>A list containing different information getting from grid data file, e.g., netcdf file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tgridData
</code></pre>


<h3>Format</h3>

<p>A list containing different information.
</p>

<dl>
<dt>Variables</dt><dd><p>variable information. </p>
</dd>
<dt>Data</dt><dd><p>Data.</p>
</dd>
<dt>xyCoords</dt><dd><p>longitude and latitude of the data.</p>
</dd>
<dt>Dates</dt><dd><p>Date information.</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p>http://www.meteo.unican.es/datasets/spain02
</p>


<h3>References</h3>


<ul>
<li><p> Herrera, S., Ancell, R., Gutierrez, J. M., Pons, M. R., Frias, M. D., &amp; Fernandez, J. 
(2012). Development and analysis of a 50-year high-resolution daily gridded precipitation dataset 
over Spain (Spain02). International Journal of Climatology 
(http://www.meteo.unican.es/datasets/spain02), 10.1002/joc.2256.
</p>
</li></ul>


<hr>
<h2 id='writeNcdf'>Write to NetCDF file using hyfo list file</h2><span id='topic+writeNcdf'></span>

<h3>Description</h3>

<p>Write to NetCDF file using hyfo list file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeNcdf(
  gridData,
  filePath,
  missingValue = 1e+20,
  tz = "GMT",
  units = NULL,
  version = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeNcdf_+3A_griddata">gridData</code></td>
<td>
<p>A hyfo list file from <code><a href="#topic+loadNcdf">loadNcdf</a></code></p>
</td></tr>
<tr><td><code id="writeNcdf_+3A_filepath">filePath</code></td>
<td>
<p>A path of the new NetCDF file, should end with &quot;.nc&quot;</p>
</td></tr>
<tr><td><code id="writeNcdf_+3A_missingvalue">missingValue</code></td>
<td>
<p>A number representing the missing value in the NetCDF file, default
is 1e20
#' @param tz A string representing the time zone, default is GMT, if you know what time zone is 
you can assign it in the argument. If <code>tz = ''</code>, current time zone will be taken.</p>
</td></tr>
<tr><td><code id="writeNcdf_+3A_tz">tz</code></td>
<td>
<p>time zone, default is &quot;GMT&quot;</p>
</td></tr>
<tr><td><code id="writeNcdf_+3A_units">units</code></td>
<td>
<p>A string showing in which unit you are putting in the NetCDF file, it can be 
seconds or days and so on. If not specified, the function will pick up the possible largest 
time units from <code>c('weeks', 'days', 'hours', 'mins', 'secs')</code></p>
</td></tr>
<tr><td><code id="writeNcdf_+3A_version">version</code></td>
<td>
<p>ncdf file versions, default is 3, if 4 is chosen, output file will be foreced to version 4.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An NetCDF version 3 file.
</p>


<h3>References</h3>


<ul>
<li><p> David Pierce (2015). ncdf4: Interface to Unidata netCDF (Version 4 or
Earlier) Format Data Files. R package version 1.14.1.
https://CRAN.R-project.org/package=ncdf4
</p>
</li>
<li><p> Santander MetGroup (2015). ecomsUDG.Raccess: R interface to the ECOMS User Data Gateway. R package
version 2.2-6. http://meteo.unican.es/ecoms-udg
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># First open the test NETcDF file.
filePath &lt;- system.file("extdata", "tnc.nc", package = "hyfo")


# Then if you don't know the variable name, you can use \code{getNcdfVar} to get variable name
varname &lt;- getNcdfVar(filePath)

nc &lt;- loadNcdf(filePath, varname)

# Then write to your work directory

## Not run: 
writeNcdf(nc, 'test.nc')

## End(Not run)


# More examples can be found in the user manual on https://yuanchao-xu.github.io/hyfo/

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
