<!DOCTYPE html><html><head><title>Help for package SoilHyP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SoilHyP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC_HY'><p>Akaike Information Criterion (AIC)</p></a></li>
<li><a href='#BIC_HY'><p>Bayesian Information Criterion (BIC)</p></a></li>
<li><a href='#calcKS'><p>Saturated hydraulic conductivity</p></a></li>
<li><a href='#dataSEM'><p>Evaporation experiment data</p></a></li>
<li><a href='#dataSHP'><p>Soil hydraulic property data</p></a></li>
<li><a href='#dataTestthat'><p>Dataset of soil hydraulic properties for testthat</p></a></li>
<li><a href='#DK_to_SWC'><p>Calculate Soil Water Content from dielectric constant</p></a></li>
<li><a href='#fitSHP'><p>Fit soil hydraulic properties</p></a></li>
<li><a href='#Kcap'><p>Relative capillary conductivity</p></a></li>
<li><a href='#Kfilm'><p>Relative film conductivity</p></a></li>
<li><a href='#Ku'><p>Unsaturated hydraulic conductivity</p></a></li>
<li><a href='#NSE'><p>Nash-Sutcliffe efficiency (NSE)</p></a></li>
<li><a href='#plot.dataSEM'><p>Plot dataSEM</p></a></li>
<li><a href='#plot.fitSHP'><p>Plot fitSHP object</p></a></li>
<li><a href='#predict.fitSHP'><p>Predict values using fitSHP object</p></a></li>
<li><a href='#read.kupf'><p>Read Evaporation Experiment data from ku-pf Apparatur</p></a></li>
<li><a href='#RMSE'><p>Root mean square error (RMSE)</p></a></li>
<li><a href='#Sad'><p>Relative saturation function</p></a></li>
<li><a href='#Sat'><p>Capillary saturation function</p></a></li>
<li><a href='#Sat_old'><p>Capillary saturation function</p></a></li>
<li><a href='#Scap'><p>Rescaled capillary saturation function</p></a></li>
<li><a href='#SCEoptim'><p>Shuffled Complex Evolution (SCE) optimisation.</p></a></li>
<li><a href='#SEM'><p>Simplified evaporation method (SEM)</p></a></li>
<li><a href='#SWC'><p>Soil water content</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Soil Hydraulic Properties</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-01</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ullrich Dettmann &lt;ullrich.dettmann@thuenen.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for (1) soil water retention (SWC) and unsaturated hydraulic conductivity (Ku) (van Genuchten-Mualem (vGM or vG) [1, 2], Peters-Durner-Iden (PDI) [3, 4, 5], Brooks and Corey (bc) [8]), (2) fitting of parameter for SWC  and/or Ku using Shuffled Complex Evolution (SCE) optimisation and (3) calculation of soil hydraulic properties (Ku and soil water contents) based on the simplified evaporation method (SEM) [6, 7].
    Main references:
    [1] van Genuchten (1980) &lt;<a href="https://doi.org/10.2136%2Fsssaj1980.03615995004400050002x">doi:10.2136/sssaj1980.03615995004400050002x</a>&gt;, 
    [2] Mualem (1976) &lt;<a href="https://doi.org/10.1029%2FWR012i003p00513">doi:10.1029/WR012i003p00513</a>&gt;, 
    [3] Peters (2013) &lt;<a href="https://doi.org/10.1002%2Fwrcr.20548">doi:10.1002/wrcr.20548</a>&gt;, 
    [4] Iden and Durner (2013) &lt;<a href="https://doi.org/10.1002%2F2014WR015937">doi:10.1002/2014WR015937</a>&gt;, 
    [5] Peters (2014) &lt;<a href="https://doi.org/10.1002%2F2014WR015937">doi:10.1002/2014WR015937</a>&gt;,
    [6] Wind G. P. (1966),
    [7] Peters and Durner (2008) &lt;<a href="https://doi.org/10.1016%2Fj.jhydrol.2008.04.016">doi:10.1016/j.jhydrol.2008.04.016</a>&gt; and
    [8] Brooks and Corey (1964).</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table (&ge; 1.13), lubridate (&ge; 1.7.9)</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://bitbucket.org/UlliD/soilhyp/issues">https://bitbucket.org/UlliD/soilhyp/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-01 15:55:22 UTC; ullrich</td>
</tr>
<tr>
<td>Author:</td>
<td>Ullrich Dettmann [aut, cre],
  Felix Andrews [ctb] (For the code copied from the hydromad::SCEoptim
    function (Version: 0.9-15) which is not on r-cran
    (https://github.com/floybix/hydromad). The SCEoptim function is
    adapted, and substantially revised from Brecht Donckels MATLAB code
    which is in turn adopted from Qingyun Duans MATLAB code),
  Brecht Donckels [ctb] (For the Matlab code which was adapted and
    reviesed in the hydromad::SCEoptim function.),
  Qingyun Duan [ctb] (For the MATLAB code adapted from Brecht Donkels.)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-02 11:10:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC_HY'>Akaike Information Criterion (AIC)</h2><span id='topic+AIC_HY'></span>

<h3>Description</h3>

<p>Akaike Information Criterion with or without correction term. Expression from Ye et al. (2008). Correction term by Hurvich and Tsai (1989).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AIC_HY(Phi, n.data, n.par, corr = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC_HY_+3A_phi">Phi</code></td>
<td>
<p>objective function value</p>
</td></tr>
<tr><td><code id="AIC_HY_+3A_n.data">n.data</code></td>
<td>
<p>number of measured data</p>
</td></tr>
<tr><td><code id="AIC_HY_+3A_n.par">n.par</code></td>
<td>
<p>number of adjustable parameters</p>
</td></tr>
<tr><td><code id="AIC_HY_+3A_corr">corr</code></td>
<td>
<p>correction term TRUE or FALSE (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>corr: <br />
If number of measurements is small compared to the number of parameters, AIC can be extended by a correction term.
</p>


<h3>References</h3>

<p>Ye, M., P.D. Meyer, and S.P. Neuman (2008): On model selection criteria in multimodel analysis. Water Resources Research 44 (3) W03428, doi:10.1029/2008WR006803.
</p>
<p>Hurvich, C., and C. Tsai (1989): Regression and time series model selection in small samples. Biometrika 76 (2), 297–307, doi:10.1093/biomet/76.2.297.
</p>
<p>Peters and Durner (2015): SHYPFIT 2.0 User's Manual.
</p>
<p>Akaike, H. (1974): A new look at statistical model identification, IEEE Trans. Autom. Control, AC-19, 716–723.
</p>

<hr>
<h2 id='BIC_HY'>Bayesian Information Criterion (BIC)</h2><span id='topic+BIC_HY'></span>

<h3>Description</h3>

<p>Bayesian Information Criterion (Schwarz, 1978) for least square estimations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIC_HY(Phi, n.data, n.par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC_HY_+3A_phi">Phi</code></td>
<td>
<p>objective function value</p>
</td></tr>
<tr><td><code id="BIC_HY_+3A_n.data">n.data</code></td>
<td>
<p>number of measured data</p>
</td></tr>
<tr><td><code id="BIC_HY_+3A_n.par">n.par</code></td>
<td>
<p>number of adjustable parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ye, M., P.D. Meyer, and S.P. Neuman (2008): On model selection criteria in multimodel analysis. Water Resources Research 44 (3) W03428, doi:10.1029/2008WR006803.
</p>
<p>Schwarz, G. (1978): Estimating the dimension of a model. The Annals of Statistics 6 (2), 461–464. URL: http://dx. doi. org/10.1214/aos/1176344136.
</p>
<p>Peters and Durner (2015): SHYPFIT 2.0 User's Manual.
</p>

<hr>
<h2 id='calcKS'>Saturated hydraulic conductivity</h2><span id='topic+calcKS'></span>

<h3>Description</h3>

<p>Calculates saturated hydraulic conductivity (ks) following Darcy's law
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcKS(V, Tmeas, L, A, dP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcKS_+3A_v">V</code></td>
<td>
<p>water volume passed sample [L³]</p>
</td></tr>
<tr><td><code id="calcKS_+3A_tmeas">Tmeas</code></td>
<td>
<p>duration of measurement [time]</p>
</td></tr>
<tr><td><code id="calcKS_+3A_l">L</code></td>
<td>
<p>length of the sample [L]</p>
</td></tr>
<tr><td><code id="calcKS_+3A_a">A</code></td>
<td>
<p>cross-sectional area [L²]</p>
</td></tr>
<tr><td><code id="calcKS_+3A_dp">dP</code></td>
<td>
<p>pressure difference between top and bottom of the sample during the measurement [L]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Keep units consistent, e.g: V = cm³, dP = cm, A = cm², L = cm, Tmeas = hour
</p>


<h3>Value</h3>

<p>hydraulic conductivity (ks) [L/time].
</p>

<hr>
<h2 id='dataSEM'>Evaporation experiment data</h2><span id='topic+dataSEM'></span>

<h3>Description</h3>

<p>Example data of an Evaporation experiment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataSEM)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>dataSEM</code> (inherits from <code>data.frame</code>) with 332 rows and 4 columns.
</p>


<h3>Details</h3>

<dl>
<dt>Columns:</dt><dd>
<p>ts: timestamp [hour]<br />
weight: total weight of soil sample [g] <br />
tens.up: measurements of upper tensiometer [cm] <br />
tens.low: measurements of lower tensiometer [cm]</p>
</dd></dl>


<hr>
<h2 id='dataSHP'>Soil hydraulic property data</h2><span id='topic+dataSHP'></span>

<h3>Description</h3>

<p>Soil hydraulic property data including soil water contents (th), unsaturated hydraulic conductivities (Ku) and the corresponding suctions/pressure heads.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataSHP)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 331 rows and 3 columns.
</p>


<h3>Details</h3>

<dl>
<dt>Columns:</dt><dd>
<p>Ku: unsaturated hydraulic conductivity <br />
th: volumetric water content <br />
suc: suction</p>
</dd></dl>


<hr>
<h2 id='dataTestthat'>Dataset of soil hydraulic properties for testthat</h2><span id='topic+dataTestthat'></span>

<h3>Description</h3>

<p>List with soil water contents (th) and unsaturated hydraulic conductivity values (ku) for spezific parameter of the uni- and bimodal hydraulic functions
of van Genuchten and Peters-Durner-Iden (PDI).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataSHP)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 8.
</p>


<h3>Details</h3>

<dl>
<dt>List objects:</dt><dd>
<p>dataTestthat$th.vgm.uni: soil water contents for unimodal van Genuchten for parameter ths = 0.4, thr = 0, alfa = 0.02 and n = 1.5 <br /> <br />
dataTestthat$th.vgm.bi: soil water contents for bimodal van Genuchten for parameter ths = 0.4, thr = 0, alfa = 0.02, n = 2, w2 = 0.2, alfa2 = 1 and n2 = 10 <br /> <br />
dataTestthat$th.pdi.uni: soil water contents for unimodal PDI for parameter ths = 0.4, thr = 0, alfa = 0.02 and n = 1.5 <br /> <br />
dataTestthat$th.pdi.bi: soil water contents for bimodal PDI for parameter ths = 0.4, thr = 0, alfa = 0.02, n = 2, w2 = 0.2, alfa2 = 1 and n2 = 10 <br /> <br />
dataTestthat$ku.vgm.uni: soil water contents for unimodal van Genuchten for parameter Ks = 10, ths = 0.5, thr = 0, alfa = 0.02, n = 1.5 and tau = 0.5 <br /> <br />
dataTestthat$ku.vgm.bi: soil water contents for bimodal van Genuchten for parameter Ks = 10, ths = 0.5, thr = 0, alfa = 0.02, n = 1.5, tau = 0.5, w2 = 0.1, alfa2 = 0.1 and n2 = 3 <br /> <br />
dataTestthat$ku.pdi.uni: soil water contents for unimodal PDI for parameter Ks = 10, ths = 0.5, thr = 0, alfa = 0.02, n = 1.5, tau = 0.5 and omega = 0.001 <br /> <br />
dataTestthat$ku.pdi.bi: soil water contents for bimodal PDI for parameter Ks = 10, ths = 0.5, thr = 0, alfa = 0.02, n = 1.5, tau = 0.5, omega = 0.001, w2 = 0.2, alfa2 = 1 and n2 = 10</p>
</dd></dl>


<hr>
<h2 id='DK_to_SWC'>Calculate Soil Water Content from dielectric constant</h2><span id='topic+DK_to_SWC'></span>

<h3>Description</h3>

<p>Calculate volumetric soil water content (SWC [L³/L³] from dielectric constant (DK) using different equations (e.g. Topp et al. 1980).
Contains mainly functions for peat and other organic soils.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DK_to_SWC(
  DK,
  FUN = c("topp", "jacobsen", "jacobsen_soil_prop", "pepin_5cm", "pepin", "roth_org",
    "malicki_bd", "malicki_ths", "myllys", "myllys_sphagnum", "myllys_carex", "kellner",
    "kellner_h2", "kellner_h3", "kellner_h4", "beckwith", "yoshikawa_deadmoss",
    "yoshikawa_livemoss", "nagare", "oleszczuk", "gs3"),
  bd,
  ths,
  clay,
  SOM
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DK_to_SWC_+3A_dk">DK</code></td>
<td>
<p>dielectric constant</p>
</td></tr>
<tr><td><code id="DK_to_SWC_+3A_fun">FUN</code></td>
<td>
<p>character string specifying the polynominal function. See details.</p>
</td></tr>
<tr><td><code id="DK_to_SWC_+3A_bd">bd</code></td>
<td>
<p>bulk density [g/cm³] (needed for FUN == 'malicki_bd' and 'jacobsen_soil_prop')</p>
</td></tr>
<tr><td><code id="DK_to_SWC_+3A_ths">ths</code></td>
<td>
<p>porosity or saturated water content [L³/L³] (needed for 'malicki_ths')</p>
</td></tr>
<tr><td><code id="DK_to_SWC_+3A_clay">clay</code></td>
<td>
<p>content of clay [percent] (only needed for 'jacobsen')</p>
</td></tr>
<tr><td><code id="DK_to_SWC_+3A_som">SOM</code></td>
<td>
<p>soil organic matter [percent] (for 'jacobsen_soil_prop')</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible functions (FUN) are': <br />
</p>
<dl>
<dt>'topp'</dt><dd><p>Topp et al. (1980)</p>
</dd></dl>

<dl>
<dt>'jacobsen'</dt><dd><p>Jacobsen and Schjonning (1993), equation 2</p>
</dd></dl>

<dl>
<dt>'jacobsen_soil_prop'</dt><dd><p>Jacobsen and Schjonning (1993), equation 3 (bd, ths and SOM are required as input)</p>
</dd></dl>

<dl>
<dt>'pepin_5cm'</dt><dd><p>Pepin, S. et al. (1992), Table 2 Depth 5 cm</p>
</dd></dl>

<dl>
<dt>'pepin'</dt><dd><p>Pepin, S. et al. (1992), Table 2 Pooled data</p>
</dd></dl>

<dl>
<dt>'roth_org'</dt><dd><p>Roth et al. (1992), Tabel 3c</p>
</dd></dl>

<dl>
<dt>'malicki_bd'</dt><dd><p>Malicki, M.A. et al. (1996), equation 10 (bd is required as input)</p>
</dd></dl>

<dl>
<dt>'malicki_ths'</dt><dd><p>Malicki, M.A. et al. (1996), equation 12 (ths is required as input)</p>
</dd></dl>

<dl>
<dt>'myllys'</dt><dd><p>Myllys M. and Simojoki, A. (1996), Table 2 pooled</p>
</dd></dl>

<dl>
<dt>'myllys_sphagnum'</dt><dd><p>Myllys M. and Simojoki, A. (1996), Table 2 Sphagnum</p>
</dd></dl>

<dl>
<dt>'myllys_carex'</dt><dd><p>Myllys M. and Simojoki, A. (1996), Table 2 Carex</p>
</dd></dl>

<dl>
<dt>'kellner'</dt><dd><p>Kellner E., Lundin L.C. (2001), Table 2 Pooled data</p>
</dd></dl>

<dl>
<dt>'kellner_h2'</dt><dd><p>Kellner E., Lundin L.C. (2001), Table 2 H2</p>
</dd></dl>

<dl>
<dt>'kellner_h3'</dt><dd><p>Kellner E., Lundin L.C. (2001), Table 2 H3</p>
</dd></dl>

<dl>
<dt>'kellner_h4'</dt><dd><p>Kellner E., Lundin L.C. (2001), Table 2 H4</p>
</dd></dl>

<dl>
<dt>'beckwith'</dt><dd><p>Beckwith C.W. and Baird A.J. (2001), eq. 1</p>
</dd></dl>

<dl>
<dt>'yoshikawa_deadmoss'</dt><dd><p>from Tabel 1 in Nagare et al. (2001)</p>
</dd></dl>

<dl>
<dt>'yoshikawa_livemoss'</dt><dd><p>from Tabel 1 in Nagare et al. (2001)</p>
</dd></dl>

<dl>
<dt>'nagare'</dt><dd><p>Nagare et al. (2011), combined from Table 4</p>
</dd></dl>

<dl>
<dt>'oleszczuk'</dt><dd><p>from Table 1 in Oleszczuk et al. (2004)</p>
</dd></dl>

<dl>
<dt>'gs3'</dt><dd><p>Meter group, eq. 7</p>
</dd></dl>



<h3>Value</h3>

<p>data.table with columns DK, SWC and FUN.
</p>


<h3>References</h3>

<p>Beckwith C.W., Baird A.J. (2001): Effect of biogenic gas bubbles on water flow through poorly decomposed blanket peat. Water Resour. Res., 37(3), 551-558.
</p>
<p>Decagon Device (2016): GS3 Water Content, EC an Temperature Sensors, Operators maual , Decagon Device, Inc 2365 NE Hopkins Court Pullman WA 99163.<br />
</p>
<p>Jacobsen, O.H., Schjonning, P. (1993): A laboratory calibration of time domain reflectometry for soil water measurement including effects of bulk density and texture. Journal of Hydrology, 151(2-4), 147-157. <br />
</p>
<p>Kellner E., Lundin L.C. (2001): Calibration of Time Domain Reflectometry for Water Content in Peat Soil, Uppsala University, Dept. of Earth Sciences/Hydrology,SE-752 36 Uppsala, Sweden. Hydrology Research, 32(4-5), 315-332.<br />
</p>
<p>Malicki, M.A., Plagge, R., Roth, C.H. (1996): Improving the calibration of dielectric TDR soil moisture determination taking into account the solid soil. European Journal of Soil Science, 47:357-366.
</p>
<p>Meter group: Operator manual GS3 (http://library.metergroup.com/Manuals/20429_GS3_Web.pdf)
</p>
<p>Myllys M., Simojoki, A. (1996): Calibration of time domain reflectometry (TDR) for soil moisture measuremnts in cultivated peat soils, Agricultural Research centre of Finland, Institut of Cropand Soil Science, University of helsinki, Department of Applied Chemistry and Mircrobiology.<br />
</p>
<p>Nagare, R.M., Schincariol, R. A., Quinton, W.L., Hayashi, M. (2011): Laboratory calibration of time domain reflectometry to determine moisture content in undisturbed peat samples. European journal of soil science, 62(4), 505-515. <br />
</p>
<p>Oleszczuk R., Brandyk T., and Szatylowicz J., 1998: Possibilities of TDR method application to measure moisture content of peat-muck soil (in Polish). Zesz. Prob. Post. Nauk Roln., 458, 263-274. <br />
</p>
<p>Oleszczuk, R., Brandyk, T., Gnatowski, T., &amp; Szatylowicz, J. (2004). Calibration of TDR for moisture determination in peat deposits. International agrophysics, 18(2). <br />
</p>
<p>Pepin, S., Plamondon, A.P., and Stein, J. (1992): Peat water-content measurement using time domain reflectrometry, Can. J. of Forest Res., Vol. 22, pp. 534-540<br />
</p>
<p>Roth C.H., M.A. Malicki, R. Plagge (1992): Empirical evaluation of the relationship between soil dielectric constant and volumetric water content as the basis for calibration soil moisture measurements by TDR; Institute of Ecology, Technical University of Berlin, Berlin, Germany and *Polish Academy of sciences, Institute of Agrophysics, ul. Doswiadczalna 4, 20-236 Lublin, Poland; Journal of Soil Science, 1992, 43, 1-13.<br />
</p>
<p>Topp, G.C., Davis, J.L., Annan, A.P. (1980): Electromagnetic determination of soil water content: Measurements in coaxial transmission lines. Water resources research, 16(3), 574-582. <br />
</p>
<p>Yoshikawa, K., Overduin, P., Harden, J. (2004): Moisture content measurements of moss (Sphagnum spp.) using commercial sensors. Permafrost Periglac, 15, 309-318.<br />
</p>

<hr>
<h2 id='fitSHP'>Fit soil hydraulic properties</h2><span id='topic+fitSHP'></span>

<h3>Description</h3>

<p>Estimate parameter for soil water retention (SWC) and/or unsaturated hydraulic conductivity function (Ku) using Shuffled Complex Evolution (SCE) optimisation. Parameter can be estimated for van Genuchten-Mualem (vg or vgm) or Peters-Durner-Iden (PDI) parameterisation of the soil hydraulic properties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitSHP(
  obs = list(th = NULL, K = NULL),
  suc = list(th = NULL, K = NULL),
  par = NULL,
  lower = NULL,
  upper = NULL,
  FUN.shp = "vg",
  modality = "uni",
  par.shp = NULL,
  fit = "both",
  weighting = "var",
  log = c("alfa", "n", "ks"),
  control = list(ncomplex = 15, reltol = 1e-07, tolsteps = 7),
  suc.negativ = FALSE,
  integral = FALSE,
  L = NULL,
  log_Ku = TRUE,
  print.info = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitSHP_+3A_obs">obs</code></td>
<td>
<p>list with named observations (th for water content and K for unsaturated hydraulic conductivity data)</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_suc">suc</code></td>
<td>
<p>list of named suctions corresponding to th and/or K</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_par">par</code></td>
<td>
<p>a numeric vector of initial parameter values (see also <code><a href="#topic+SCEoptim">SCEoptim</a></code>). If missing default values are set.</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_lower">lower</code></td>
<td>
<p>lower bounds on the parameters. Should be the same length as <code>par</code> and as <code>upper</code>, or length 1 if a bound applies to all parameters. If missing default values are set.</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_upper">upper</code></td>
<td>
<p>upper bounds on the parameters. Should be the same length as <code>par</code> and as <code>lower</code>, or length 1 if a bound applies to all parameters. If missing default values are set.</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_fun.shp">FUN.shp</code></td>
<td>
<p>Funktion for soil hydraulic properties (vG, PDI or bc) (see <code><a href="#topic+SWC">SWC</a></code> or <code><a href="#topic+Ku">Ku</a></code>)</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_modality">modality</code></td>
<td>
<p>pore size distribution ('uni' or 'bi')</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_par.shp">par.shp</code></td>
<td>
<p>fixed parameter value named in list or vector</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_fit">fit</code></td>
<td>
<p>fit parameter for 'SWC', 'Ku' or 'both' simultaneous.</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_weighting">weighting</code></td>
<td>
<p>weighting between SWC and Ku. Used if fit == both ('var', 'norm' or '2step').</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_log">log</code></td>
<td>
<p>names of parameter in list or vector which should be logarithmized during optimization</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_control">control</code></td>
<td>
<p>a list of options as in <code>optim()</code>, see <code><a href="#topic+SCEoptim">SCEoptim</a></code></p>
</td></tr>
<tr><td><code id="fitSHP_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_integral">integral</code></td>
<td>
<p>th as point value vs. suc(h) (FALSE) or th as mean water content over the column divided by the height (L) vs. suc(h) (TRUE) (see details).</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_l">L</code></td>
<td>
<p>sample height [cm]. Only needed for integral == TRUE</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_log_ku">log_Ku</code></td>
<td>
<p>logarithmize Ku in the objective function and for weighting (TRUE).</p>
</td></tr>
<tr><td><code id="fitSHP_+3A_print.info">print.info</code></td>
<td>
<p>print information about default values for par, lower, and upper if missing or fitting accuracy (TRUE or FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>weigthing:<br /></dt><dd>
<p>var: th and K are weighted in the objective fuction by the measurement variance  <br />
norm: th and K are normed in objective fuction<br />
stepwise: the parameter for th are fitted first and the remaining parameter for K afterwards (2step works aswell)</p>
</dd></dl>

<dl>
<dt>log:<br /></dt><dd>
<p>The use of log is suggested for paramter 'alfa', 'n' and 'ks' for modality == 'uni'. For modality 'bi' additional 'alfa2' and 'n2' and for Fun.shp == 'pdi' additional 'omega'.
Parameter in output ($par) are not returned logarithmized. <br />
Delfault paramter values for par, lower and upper are logarithmized automatatically <br />
If not the default values for par, lower and upper are taken, parameter which are named in 'log' must be scaled by the user in par, lower and upper.
</p>
</dd>
</dl>

<dl>
<dt>integral:<br /></dt><dd>
<p>The &quot;integral&quot; method is suggested from Peters and Durner (2008, 2015) to fit parameter on data from
experiments were water contents are measured as mean water contents (e.g. simplified evaporation method or multi-step outflow experiments).
Under the assumption that the water content is distributed linear over the column, the measured
mean water content of the column is the integral over the whole column divided by the column length (L).
Under hydraulic equilibrium this is equal to the integral of the retention function over the matric
heads from the lower boundary to the upper boundary of the column divided by the height of the column (Peters 2008, 2015). <br />
<br />
integral == TRUE can be very slow.
</p>
</dd></dl>



<h3>Value</h3>

<p>&quot;fitSHP&quot; class
</p>


<h3>Author(s)</h3>

<p>Ullrich Dettmann
</p>


<h3>References</h3>

<p>Peters, A., &amp; Durner, W. (2008). Simplified evaporation method for determining soil hydraulic properties. Journal of Hydrology, 356(1), 147-162.
</p>
<p>Peters and Durner (2015). SHYPFIT 2.0 User’s Manual
</p>
<p>Peters, A., Iden, S. C., &amp; Durner, W. (2015). Revisiting the simplified evaporation method: Identification of hydraulic functions considering vapor, film and corner flow. Journal of Hydrology, 527, 531-542.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SCEoptim">SCEoptim</a></code>, <code><a href="#topic+SWC">SWC</a></code>, <code><a href="#topic+Ku">Ku</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data('dataSHP')
# -------------------------------------------------------------------
# fit Soil Hydraulic Properties (SHP)
# -------------------------------------------------------------------
ans &lt;- fitSHP(obs         = list(th = dataSHP$th, K = dataSHP$Ku),
             suc          = list(th = dataSHP$suc, K = dataSHP$suc),
             FUN.shp      = 'vg',
             modality     = 'uni',
             par.shp      =  NULL,
             fit          = 'both',
             weighting    = 'var',
             log          = c('alfa', 'n', 'ks'),
             control      = list(ncomplex = 15, reltol = 1e-07,tolsteps = 7),
             suc.negativ  = TRUE,
             integral     = FALSE,
             L            = 0,
             print.info   = TRUE
)
ans$par
plot(ans)
# --------------------------------------------------------------------
# bimodal van Genuchten-Mualem
ans &lt;- fitSHP(obs         = list(th = dataSHP$th, K = dataSHP$Ku),
             suc          = list(th = dataSHP$suc, K = dataSHP$suc),
             FUN.shp      = 'vg',
             modality     = 'bi',
             par.shp      =  c(),
             fit          = 'both',
             weighting    = 'var',
             log          = c('alfa', 'n', 'ks', 'alfa2', 'n2'),
             suc.negativ  = TRUE,
             integral     = FALSE,
             L            = 0,
             print.info   = TRUE,
             control      = list(ncomplex = 15, reltol = 1e-07,tolsteps = 7)
)
ans$par
plot(ans)

## End(Not run)
</code></pre>

<hr>
<h2 id='Kcap'>Relative capillary conductivity</h2><span id='topic+Kcap'></span>

<h3>Description</h3>

<p>Relative capillary conductivity based on Mualem's conductivity model for unimodal or bimodal van Genuchten-Mualem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kcap(suc, par.shp, suc.negativ = TRUE, modality = "uni")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kcap_+3A_suc">suc</code></td>
<td>
<p>Suction/pressure heads. Negative if suc.negativ = TRUE</p>
</td></tr>
<tr><td><code id="Kcap_+3A_par.shp">par.shp</code></td>
<td>
<p>named parameter in list or vector</p>
</td></tr>
<tr><td><code id="Kcap_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
<tr><td><code id="Kcap_+3A_modality">modality</code></td>
<td>
<p>pore size distributions ('uni' or 'bi')</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>par.shp:</dt><dd>
<p>alfa [1/L]: van Genuchten shape parameter <br />
n [-]: van Genuchten shape parameter <br />
m [-]: shape parameter (m = 1-(1/n) if missing) <br />
tau [-]:  tortuosity and connectivity parameter (minimum -1 or -2 for the PDI model; for details see Peters (2014)) <br />
h0 [L]: suction at water content of 0 (i.e. oven dryness) (h0 = 10^6.8 if missing, corresponding to oven dryness at 105°C (Schneider and Goss, 2012))</p>
</dd>
<dt>par.shp: additional parameter for bimodal (modality == 'bi')</dt><dd>
<p>w2 [-]: weigthing between pore space distribution <br />
alfa2 [1/L]: van Genuchten parameter alfa for second pore space distribution <br />
n2 [-]: van Genuchten parameter n for second pore space distribution</p>
</dd></dl>



<h3>References</h3>

<p>Peters, A. (2014). Reply to comment by S. Iden and W. Durner on Simple consistent models for water retention and hydraulic conductivity in the complete moisture range. Water Resour. Res. 50, 7535–7539.
</p>
<p>Van Genuchten, M. T. (1980). A closed-form equation for predicting the hydraulic conductivity of unsaturated soils. Soil science society of America journal, 44(5), 892-898.
</p>
<p>Mualem, Y. (1976). A new model for predicting the hydraulic conductivity of unsaturated porous media. Water resources research, 12(3), 513-522.
</p>
<p>Schneider, M., &amp; Goss, K. U. (2012). Prediction of the water sorption isotherm in air dry soils. Geoderma, 170, 64-69.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ku">Ku</a></code>
</p>

<hr>
<h2 id='Kfilm'>Relative film conductivity</h2><span id='topic+Kfilm'></span>

<h3>Description</h3>

<p>Relative film conductivity described by Peters (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kfilm(suc, par.shp, modality = "uni", suc.negativ = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kfilm_+3A_suc">suc</code></td>
<td>
<p>Suction/pressure heads. Negative if suc.negativ = TRUE</p>
</td></tr>
<tr><td><code id="Kfilm_+3A_par.shp">par.shp</code></td>
<td>
<p>named parameter in list or vector</p>
</td></tr>
<tr><td><code id="Kfilm_+3A_modality">modality</code></td>
<td>
<p>pore size distribution ('uni' or 'bi')</p>
</td></tr>
<tr><td><code id="Kfilm_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>par.shp:</dt><dd>
<p>ths [-]: saturated water content <br />
thr [-]: residual water content <br />
alfa [1/L]: van Genuchten shape parameter <br />
n [-]: van Genuchten shape parameter <br />
h0 [L]: suction at water content of 0 (i.e. oven dryness) (h0 = 10^6.8 if missing, corresponding to oven dryness at 105°C (Schneider and Goss, 2012))<br />
a: slope at the log scale (a = -1.5 if missing as suggested by Tokunaga (2009) and Peters (2013))</p>
</dd>
<dt>par.shp: additional parameter for bimodal (modality == 'bi')</dt><dd>
<p>alfa2 [1/L]: van Genuchten parameter alfa for second pore space distribution <br />
n2 [-]: van Genuchten parameter n for second pore space distribution</p>
</dd></dl>



<h3>References</h3>

<p>Peters, A. (2013). Simple consistent models for water retention and hydraulic conductivity in the complete moisture range. Water Resour. Res. 49, 6765–6780. physics-a review. Vadose Zone J. http://dx.doi.org/10.2136/vzj2012.0163.
</p>
<p>Tokunaga, T. K. (2009). Hydraulic properties of adsorbed water films in unsaturated porous media. Water resources research, 45(6).
</p>
<p>Schneider, M., &amp; Goss, K. U. (2012). Prediction of the water sorption isotherm in air dry soils. Geoderma, 170, 64-69.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ku">Ku</a></code>
</p>

<hr>
<h2 id='Ku'>Unsaturated hydraulic conductivity</h2><span id='topic+Ku'></span>

<h3>Description</h3>

<p>Calculates unsaturated hydraulic conductivity for a given suction for unimodal or bimodal van Genuchten-Mualem (vg/vgm), Peters-Durner-Iden (PDI) and Brooks and Corey (bc) (only unimodal) parameterisation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ku(suc, FUN.shp = "vG", par.shp, modality = "uni", suc.negativ = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ku_+3A_suc">suc</code></td>
<td>
<p>Suction/pressure heads. Negative if suc.negativ = TRUE</p>
</td></tr>
<tr><td><code id="Ku_+3A_fun.shp">FUN.shp</code></td>
<td>
<p>Funktion for soil hydraulic properties (vGM or PDI) (see details)</p>
</td></tr>
<tr><td><code id="Ku_+3A_par.shp">par.shp</code></td>
<td>
<p>named parameter in list or vector</p>
</td></tr>
<tr><td><code id="Ku_+3A_modality">modality</code></td>
<td>
<p>pore size distribution ('uni' or 'bi')</p>
</td></tr>
<tr><td><code id="Ku_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>FUN.shp:</dt><dd><p>vGM: van Genuchten-Mualem (uni or bimodal) ('vg' works aswell)<br />
PDI: Peters-Durner-Iden with van Genuchtens saturation function (uni or bimodal) <br />
bc: Brooks and Corey (unimodal)</p>
</dd></dl>

<dl>
<dt>par.shp (vG and PDI):</dt><dd>
<p>ths [-]: saturated water content<br />
thr [-]: residual water content<br />
alfa [1/L]: van Genuchten shape parameter<br />
n [-]: van Genuchten shape parameter<br />
m [-]: shape parameter (m = 1-(1/n) if missing)<br />
Ks [L/time]: saturated hydraulic conductivity<br />
tau [-]:  tortuosity and connectivity parameter (minimum -1 or -2 for the PDI model; see Peters (2014) for details)</p>
</dd>
<dt>par.shp (additional parameter for 'PDI'):</dt><dd>
<p>omega: weighting between relative capillary and film conductivity <br />
h0 [L]: suction at water content of 0 (i.e. oven dryness) (h0 = 10^6.8 if missing, corresponding to oven dryness at 105°C (Schneider and Goss, 2012))<br />
a: slope at the log scale (a = -1.5 if missing as suggested by Tokunaga (2009) and Peters (2013))</p>
</dd>
<dt>par.shp (additional parameter for bimodal (modality = 'bi')):</dt><dd>
<p>w2 [-]: weigthing between pore space distributions <br />
alfa2 [1/L]: van Genuchten parameter alfa for second pore space distribution <br />
n2 [-]: van Genuchten parameter n for second pore space distribution</p>
</dd></dl>

<dl>
<dt>par.shp (BC):</dt><dd>
<p>ths [-]: saturated water content <br />
thr [-]: residual water content<br />
alfa [1/L]: inverse of the air-entry value or bubbling pressure <br />
lambda [-]: pore size distribution index <br />
tau [-]:  tortuosity and connectivity parameter (minimum -1 or -2 for the PDI model; see Peters (2014) for details)</p>
</dd></dl>

<p>most input works for upper- and lowercase letters
</p>


<h3>Value</h3>

<p>unsaturated hydraulic conductivity (ku)
</p>


<h3>Author(s)</h3>

<p>Ullrich Dettmann
</p>


<h3>References</h3>

<p>Van Genuchten, M. T. (1980). A closed-form equation for predicting the hydraulic conductivity of unsaturated soils. Soil science society of America journal, 44(5), 892-898.
</p>
<p>Mualem, Y. (1976). A new model for predicting the hydraulic conductivity of unsaturated porous media. Water resources research, 12(3), 513-522.
</p>
<p>Peters, A. (2013). Simple consistent models for water retention and hydraulic conductivity in the complete moisture range. Water Resour. Res. 49, 6765–6780. physics-a review. Vadose Zone J. http://dx.doi.org/10.2136/vzj2012.0163.
</p>
<p>Iden, S., Durner, W. (2014). Comment to Simple consistent models for water retention and hydraulic conductivity in the complete moisture range by A. Peters. Water Resour. Res. 50, 7530–7534.
</p>
<p>Peters, A. (2014). Reply to comment by S. Iden and W. Durner on Simple consistent models for water retention and hydraulic conductivity in the complete moisture range. Water Resour. Res. 50, 7535–7539.
</p>
<p>Tokunaga, T. K. (2009), Hydraulic properties of adsorbed water films in unsaturated porous media, Water Resour. Res., 45, W06415, doi: 10.1029/2009WR007734.
</p>
<p>Priesack, E., Durner, W., 2006. Closed-form expression for the multi-modal unsaturated conductivity function. Vadose Zone J. 5, 121–124.
</p>
<p>Durner, W. (1994). Hydraulic conductivity estimation for soils with heterogeneous pore structure. Water Resources Research, 30(2), 211-223.
</p>
<p>Schneider, M., &amp; Goss, K. U. (2012). Prediction of the water sorption isotherm in air dry soils. Geoderma, 170, 64-69.
</p>
<p>Brooks, R.H., and A.T. Corey (1964): Hydraulic properties of porous media. Hydrol. Paper 3. Colorado State Univ., Fort Collins, CO, USA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SWC">SWC</a></code> and <code><a href="#topic+Sat">Sat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --------------------------------------------
#  Unimodal van Genuchten
# --------------------------------------------
Ku(suc = seq(1, 1000, by = 1), FUN.shp = 'vGM',
   par.shp = list(Ks = 10, ths = 0.5, thr = 0, alfa = 0.02, n = 1.5, tau = 0.5),
   modality = 'uni', suc.negativ = FALSE)
# --------------------------------------------
#  Bimodal van Genuchten
# --------------------------------------------
Ku(suc = seq(1, 1000, by = 1), FUN.shp = 'vGM',
   par.shp = list(Ks = 10, ths = 0.5, thr = 0, alfa = 0.02,
   n = 1.5, tau = 0.5, w2 = 0.1, alfa2 = 0.1, n2 = 3),
   modality = 'bi', suc.negativ = FALSE)
# --------------------------------------------
#  Unimodal Peters-Durner-Iden (PDI)
# --------------------------------------------
Ku(suc = seq(1, 1000, by = 1), FUN.shp = 'PDI', modality = 'uni',
   par.shp = list(Ks = 10, ths = 0.5, thr = 0, alfa = 0.02, n = 1.5, tau = 0.5, omega = 0.001),
   suc.negativ = FALSE)
# --------------------------------------------
#  Brooks and Corey (BC) (only unimodal)
# --------------------------------------------
Ku(suc = seq(1, 1000, by = 1), FUN.shp = 'bc', modality = 'uni',
   par.shp = list(ths = 0.4, thr = 0, lambda =  0.211, alfa = 0.1, tau = 0.5, ks = 10),
   suc.negativ = FALSE)
# --------------------------------------------
</code></pre>

<hr>
<h2 id='NSE'>Nash-Sutcliffe efficiency (NSE)</h2><span id='topic+NSE'></span>

<h3>Description</h3>

<p>Nash-Sutcliffe efficiency (NSE)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NSE(obs, sim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NSE_+3A_obs">obs</code></td>
<td>
<p>measured values</p>
</td></tr>
<tr><td><code id="NSE_+3A_sim">sim</code></td>
<td>
<p>predicted values</p>
</td></tr>
</table>


<h3>References</h3>

<p>Nash, J. E., and J.V. Sutcliffe (1970): River flow forecasting through conceptual models. 1. a discussion of principles. Journal of Hydrology 10, 282–290.
</p>

<hr>
<h2 id='plot.dataSEM'>Plot dataSEM</h2><span id='topic+plot.dataSEM'></span>

<h3>Description</h3>

<p>Creates plot of object with class 'dataSEM'. If input x is provided as list with more than one elements, the output plot is a grid with multiple plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dataSEM'
plot(
  x,
  ts = "ts",
  tens.up = "tens.up",
  tens.low = "tens.low",
  weight = "weight",
  plot.tens = TRUE,
  plot.weight = TRUE,
  plot.legend = TRUE,
  xlab = "timestamp",
  plot.title,
  color.tens = c("#00FFFF", "#008B8B"),
  color.weight = "#EC382B",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dataSEM_+3A_x">x</code></td>
<td>
<p>object of class dataSEM (see details)</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_ts">ts</code></td>
<td>
<p>character specifying the column containing the time stamp (format must be numeric or POSIXct)</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_tens.up">tens.up</code></td>
<td>
<p>character specifying the column containing the measurements of the upper tensiometer</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_tens.low">tens.low</code></td>
<td>
<p>character specifying the column containing the measurements of the lower tensiometer</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_weight">weight</code></td>
<td>
<p>character specifying the column containing the weight</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_plot.tens">plot.tens</code></td>
<td>
<p>plot tensiometer values (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_plot.weight">plot.weight</code></td>
<td>
<p>plot weight values (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_plot.legend">plot.legend</code></td>
<td>
<p>plot legend (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_xlab">xlab</code></td>
<td>
<p>lable for the x axis</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_plot.title">plot.title</code></td>
<td>
<p>character spezifying plot title. If empty no title will be added.</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_color.tens">color.tens</code></td>
<td>
<p>colors of the plotted tensiometer values</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_color.weight">color.weight</code></td>
<td>
<p>color of the plotted weight values</p>
</td></tr>
<tr><td><code id="plot.dataSEM_+3A_...">...</code></td>
<td>
<p>Graphical arguments (see <code><a href="graphics.html#topic+par">par</a></code>). If plot.tens = T and plot.weight = T, lty only works for tensiometer values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Object x can be:<br />
- class(x): &quot;dataSEM&quot; &quot;data.frame&quot; <br />
- class(x): &quot;dataSEM&quot; &quot;data.table&quot; <br />
- class(x): &quot;dataSEM&quot; (if x is a list)<br />
<br />
If x is a list with more than 1 elements, the output plot is a grid with mutliple plots.
Columns and row number can be adjusted with grafical argument mfrow (see <code><a href="graphics.html#topic+par">par</a></code>) <br />
<br />
If x has the wrong class, the class can be set with: <br />
class(x) &lt;- c('dataSEM', class(x)) (if x has the class data.frame or data.table) and <br />
class(x) &lt;- 'dataSEM' (if x has the class list). <br />
</p>


<h3>Author(s)</h3>

<p>Ullrich Dettmann
</p>

<hr>
<h2 id='plot.fitSHP'>Plot fitSHP object</h2><span id='topic+plot.fitSHP'></span>

<h3>Description</h3>

<p>Creates plot of fitSHP object with measured and fitted SWC, KU or both depending on fitSHP object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitSHP'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fitSHP_+3A_x">x</code></td>
<td>
<p>object of class fitSHP</p>
</td></tr>
<tr><td><code id="plot.fitSHP_+3A_...">...</code></td>
<td>
<p>arguments for plot</p>
</td></tr>
</table>

<hr>
<h2 id='predict.fitSHP'>Predict values using fitSHP object</h2><span id='topic+predict.fitSHP'></span>

<h3>Description</h3>

<p>Predicts values using fitSHP object with calibrated paramter of SWC, KU or both depending on the fitSHP object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitSHP'
predict(object, suc = NULL, length.out = 100, suc.negativ = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.fitSHP_+3A_object">object</code></td>
<td>
<p>object of class fitSHP</p>
</td></tr>
<tr><td><code id="predict.fitSHP_+3A_suc">suc</code></td>
<td>
<p>Suction/pressure heads for the prediction of the soil hydraulic properties</p>
</td></tr>
<tr><td><code id="predict.fitSHP_+3A_length.out">length.out</code></td>
<td>
<p>output length if suc == NULL</p>
</td></tr>
<tr><td><code id="predict.fitSHP_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
<tr><td><code id="predict.fitSHP_+3A_...">...</code></td>
<td>
<p>arguments for predict</p>
</td></tr>
</table>

<hr>
<h2 id='read.kupf'>Read Evaporation Experiment data from ku-pf Apparatur</h2><span id='topic+read.kupf'></span>

<h3>Description</h3>

<p>Reads multiple ku-pf Apparatur files from a directory and returns them as list of data.tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.kupf(
  path,
  colnames.out = c("ts", "tens.up", "tens.low", "weight"),
  firstrow.char = "Date/Time\tTension top\tTension bottom\tWeight",
  format.time_stamp = "%d.%m.%Y %H:%M:%S",
  tz.time_stamp = "GMT",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.kupf_+3A_path">path</code></td>
<td>
<p>path to ku-pf files (character)</p>
</td></tr>
<tr><td><code id="read.kupf_+3A_colnames.out">colnames.out</code></td>
<td>
<p>colnames of output (default: c('ts', 'tens.up', 'tens.low', 'weight'))</p>
</td></tr>
<tr><td><code id="read.kupf_+3A_firstrow.char">firstrow.char</code></td>
<td>
<p>character in first row of ku-pf files (default: 'Date/Time    Tension top    Tension bottom    Weight') (see details)</p>
</td></tr>
<tr><td><code id="read.kupf_+3A_format.time_stamp">format.time_stamp</code></td>
<td>
<p>POSIXct format of the time stamp column (column 1, here named 'ts') (see <code><a href="base.html#topic+strptime">strptime</a></code>)</p>
</td></tr>
<tr><td><code id="read.kupf_+3A_tz.time_stamp">tz.time_stamp</code></td>
<td>
<p>time zone of the time stamp column (column 1, here named 'ts') (default: 'GMT') (see <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>)</p>
</td></tr>
<tr><td><code id="read.kupf_+3A_...">...</code></td>
<td>
<p>arguments to <code><a href="base.html#topic+list.files">list.files</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>input file format:</dt><dd><p>The standard file format of ku-pf files looks like: <br />
<br />
Date/Time	Tension top	Tension bottom	Weight <br />
kPa	kPa	g <br />
01.11.2017 14:11:16	-0.48	-0.15	969.02 <br />
01.11.2017 14:21:16	-0.47	-0.14	969.00 <br />
01.11.2017 14:31:16	-0.46	-0.13	968.98 <br />
<br />
If the first row of the ku-pf files differs to the expression used here ('Date/Time	Tension top	Tension bottom	Weight&quot;),
it can be set with firstrow.char. <br /></p>
</dd></dl>

<dl>
<dt>sample_info:</dt><dd><p>File names are added as attribut to the output (attr(out, 'sample_info')). <br />
<br />
The ku-pf software gives the possibility to add
sample spezific information in the first row of the file. Depending on the input the ku-pf files than look: <br />
<br />
sample_name;project <br />
Date/Time	Tension top	Tension bottom	Weight <br />
kPa	kPa	g <br />
01.11.2017 14:11:16	-0.48	-0.15	969.02 <br />
01.11.2017 14:21:16	-0.47	-0.14	969.00 <br />
01.11.2017 14:31:16	-0.46	-0.13	968.98 <br />
<br />
- For this case the first line is added as attribute to the output (attr(out, 'sample_info')$info) <br />
</p>
</dd></dl>



<h3>Value</h3>

<p>list of the class dataSEM containing data.tables as list elements.
</p>


<h3>Author(s)</h3>

<p>Ullrich Dettmann
</p>

<hr>
<h2 id='RMSE'>Root mean square error (RMSE)</h2><span id='topic+RMSE'></span>

<h3>Description</h3>

<p>Calculate Root mean square error (RMSE)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RMSE(obs, sim, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RMSE_+3A_obs">obs</code></td>
<td>
<p>measured values</p>
</td></tr>
<tr><td><code id="RMSE_+3A_sim">sim</code></td>
<td>
<p>predicted values</p>
</td></tr>
<tr><td><code id="RMSE_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values be removed?</p>
</td></tr>
</table>

<hr>
<h2 id='Sad'>Relative saturation function</h2><span id='topic+Sad'></span>

<h3>Description</h3>

<p>Relative saturation function for adsorptive water storage described by a piecwise linear function (Iden and Durner, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sad(suc, par.shp, modality = c("uni"), suc.negativ = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sad_+3A_suc">suc</code></td>
<td>
<p>Suction/pressure heads. Negative if suc.negativ = TRUE</p>
</td></tr>
<tr><td><code id="Sad_+3A_par.shp">par.shp</code></td>
<td>
<p>named parameter of soil hydraulic properties in list or vector (see details)</p>
</td></tr>
<tr><td><code id="Sad_+3A_modality">modality</code></td>
<td>
<p>pore size distribution ('uni' or 'bi')</p>
</td></tr>
<tr><td><code id="Sad_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>par.shp:</dt><dd>
<p>ths [-]: saturated water content <br />
thr [-]: residual water content <br />
alfa [1/L]: van Genuchten shape parameter <br />
n [-]: van Genuchten shape parameter <br />
h0 [L]: suction at water content of 0 (i.e. oven dryness) (h0 = 10^6.8 if missing, corresponding to oven dryness at 105°C (Schneider and Goss, 2012))</p>
</dd>
<dt>par.shp (additional for bimodal (modality = 'bi')):</dt><dd>
<p>alfa2 [1/L]: van Genuchten parameter alfa for second pore space distribution <br />
n2 [-]: van Genuchten parameter n for second pore space distribution</p>
</dd></dl>



<h3>Author(s)</h3>

<p>Ullrich Dettmann
</p>


<h3>References</h3>

<p>Iden, S., Durner, W. (2014). Comment to Simple consistent models for water retention and hydraulic conductivity in the complete moisture range by A. Peters. Water Resour. Res. 50, 7530–7534.
</p>
<p>Schneider, M., &amp; Goss, K. U. (2012). Prediction of the water sorption isotherm in air dry soils. Geoderma, 170, 64-69.
</p>

<hr>
<h2 id='Sat'>Capillary saturation function</h2><span id='topic+Sat'></span>

<h3>Description</h3>

<p>Capillary saturation function of van Genuchten (unimodal or bimodal pore space distributions) and Brooks and Corey (unimodal pore space distribution).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sat(suc, par.shp, modality = c("uni"), FUN.shp = "vg", suc.negativ = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sat_+3A_suc">suc</code></td>
<td>
<p>Suction/pressure heads. Negative if suc.negativ = TRUE</p>
</td></tr>
<tr><td><code id="Sat_+3A_par.shp">par.shp</code></td>
<td>
<p>named parameter in list or vector</p>
</td></tr>
<tr><td><code id="Sat_+3A_modality">modality</code></td>
<td>
<p>pore size distribution ('uni' or 'bi')</p>
</td></tr>
<tr><td><code id="Sat_+3A_fun.shp">FUN.shp</code></td>
<td>
<p>Funktion for soil hydraulic properties (vG or bc) (see details)</p>
</td></tr>
<tr><td><code id="Sat_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>FUN.shp:</dt><dd>
<p>vG: van Genuchten (uni or bimodal) (vGM is working aswell) <br />
bc: Brooks and Corey (uni)</p>
</dd></dl>

<dl>
<dt>par.shp (van Genuchten):</dt><dd>
<p>alfa [1/L]: van Genuchten shape parameter <br />
n [-]: van Genuchten shape parameter <br />
m [-]: shape parameter (m = 1-(1/n) if missing)</p>
</dd>
<dt>par.shp (additional for bimodal (modality = 'bi')):</dt><dd>
<p>w2 [-]: weigthing between pore space distribution <br />
alfa2 [1/L]: van Genuchten parameter alfa for second pore space distribution <br />
n2 [-]: van Genuchten parameter n for second pore space distribution</p>
</dd></dl>

<dl>
<dt>par.shp (Brooks and Corey):</dt><dd>
<p>alfa [1/L]: inverse of the air-entry value or bubbling pressure <br />
lambda [-]: pore size distribution index </p>
</dd></dl>



<h3>References</h3>

<p>Van Genuchten, M. T. (1980). A closed-form equation for predicting the hydraulic conductivity of unsaturated soils. Soil science society of America journal, 44(5), 892-898.
</p>
<p>Durner, W. (1994). Hydraulic conductivity estimation for soils with heterogeneous pore structure. Water Resources Research, 30(2), 211-223.
</p>
<p>Brooks, R.H., and A.T. Corey (1964): Hydraulic properties of porous media. Hydrol. Paper 3. Colorado State Univ., Fort Collins, CO, USA.
</p>

<hr>
<h2 id='Sat_old'>Capillary saturation function</h2><span id='topic+Sat_old'></span>

<h3>Description</h3>

<p>Capillary saturation function of van Genuchten for unimodal or bimodal pore space distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sat_old(suc, par.shp, modality = c("uni"), suc.negativ = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sat_old_+3A_suc">suc</code></td>
<td>
<p>Suction/pressure heads. Negative if suc.negativ = TRUE</p>
</td></tr>
<tr><td><code id="Sat_old_+3A_par.shp">par.shp</code></td>
<td>
<p>named parameter in list or vector</p>
</td></tr>
<tr><td><code id="Sat_old_+3A_modality">modality</code></td>
<td>
<p>pore size distribution ('uni' or 'bi')</p>
</td></tr>
<tr><td><code id="Sat_old_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>par.shp:</dt><dd>
<p>alfa [1/L]: van Genuchten shape parameter <br />
n [-]: van Genuchten shape parameter <br />
m [-]: shape parameter (m = 1-(1/n) if missing)</p>
</dd>
<dt>par.shp (additional for bimodal (modality = 'bi')):</dt><dd>
<p>w2 [-]: weigthing between pore space distribution <br />
alfa2 [1/L]: van Genuchten parameter alfa for second pore space distribution <br />
n2 [-]: van Genuchten parameter n for second pore space distribution</p>
</dd></dl>



<h3>References</h3>

<p>Van Genuchten, M. T. (1980). A closed-form equation for predicting the hydraulic conductivity of unsaturated soils. Soil science society of America journal, 44(5), 892-898.
</p>
<p>Durner, W. (1994). Hydraulic conductivity estimation for soils with heterogeneous pore structure. Water Resources Research, 30(2), 211-223.
</p>

<hr>
<h2 id='Scap'>Rescaled capillary saturation function</h2><span id='topic+Scap'></span>

<h3>Description</h3>

<p>Rescaled capillary saturation function by Iden and Durner (2014) <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Scap(suc, par.shp, modality = c("uni"), suc.negativ = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Scap_+3A_suc">suc</code></td>
<td>
<p>Suction/pressure heads. Negative if suc.negativ = TRUE</p>
</td></tr>
<tr><td><code id="Scap_+3A_par.shp">par.shp</code></td>
<td>
<p>named parameter in list or vector</p>
</td></tr>
<tr><td><code id="Scap_+3A_modality">modality</code></td>
<td>
<p>pore size distribution ('uni' or 'bi')</p>
</td></tr>
<tr><td><code id="Scap_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>par.shp:</dt><dd>
<p>alfa [1/L]: van Genuchten shape parameter <br />
n [-]: van Genuchten shape parameter <br />
m [-]: shape parameter (m = 1-(1/n) if missing) <br />
h0 [L]: suction at water content of 0 (i.e. oven dryness) (h0 = 10^6.8 if missing, corresponding to oven dryness at 105°C (Schneider and Goss, 2012))</p>
</dd>
<dt>par.shp (additional for bimodal (modality = 'bi') pore size distribution:)</dt><dd>
<p>w2 [-]: weigthing between pore space distribution <br />
alfa2 [1/L]: van Genuchten parameter alfa for second pore space distribution <br />
n2 [-]: van Genuchten parameter n for second pore space distribution <br />
m2 [-]: shape parameter (m = 1-(1/n2) if missing) <br /></p>
</dd></dl>

<p>Scap(h) = (Gamma(h)- Gamma(h0))/(1 - Gamma(h0)) <br />
Gamma descripes the capillary saturation function. Here the saturation function of van Genuchten is used: <br />
gamma(h) = (1/(1 + -suc * alfa)^n)^m (see also <code><a href="#topic+Sat">Sat</a></code>)<br />
</p>


<h3>References</h3>

<p>Iden, S., Durner, W. (2014). Comment to Simple consistent models for water retention and hydraulic conductivity in the complete moisture range by A. Peters. Water Resour. Res. 50, 7530–7534.
</p>
<p>Schneider, M., &amp; Goss, K. U. (2012). Prediction of the water sorption isotherm in air dry soils. Geoderma, 170, 64-69.
</p>

<hr>
<h2 id='SCEoptim'>Shuffled Complex Evolution (SCE) optimisation.</h2><span id='topic+SCEoptim'></span>

<h3>Description</h3>

<p>Shuffled Complex Evolution (SCE) optimisation. Designed to have a similar interface to the standard <code><a href="stats.html#topic+optim">optim</a></code> function.<br /> The function is copied from the hydromad package (<a href="https://github.com/floybix/hydromad/">https://github.com/floybix/hydromad/</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCEoptim(FUN, par, lower = -Inf, upper = Inf, control = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SCEoptim_+3A_fun">FUN</code></td>
<td>
<p>function to optimise (to minimise by default), or the name of one. This should return a scalar numeric value.</p>
</td></tr>
<tr><td><code id="SCEoptim_+3A_par">par</code></td>
<td>
<p>a numeric vector of initial parameter values.</p>
</td></tr>
<tr><td><code id="SCEoptim_+3A_lower">lower</code></td>
<td>
<p>lower bounds on the parameters. Should be the same length as <code>par</code> and as <code>upper</code>, or length 1 if a bound applies to all parameters.</p>
</td></tr>
<tr><td><code id="SCEoptim_+3A_upper">upper</code></td>
<td>
<p>upper bounds on the parameters. Should be the same length as <code>par</code> and as <code>lower</code>, or length 1 if a bound applies to all parameters.</p>
</td></tr>
<tr><td><code id="SCEoptim_+3A_control">control</code></td>
<td>
<p>a list of options as in <code>optim()</code>, see Details.</p>
</td></tr>
<tr><td><code id="SCEoptim_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>FUN</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an evolutionary algorithm combined with a simplex algorithm. <br />
<br />
Options can be given in the list <code>control</code>, in the same way as with <code><a href="stats.html#topic+optim">optim</a></code>:
<br />
</p>
 <dl>
<dt>ncomplex</dt><dd><p> number of complexes. Defaults to
<code>5</code>.  </p>
</dd> <dt>cce.iter</dt><dd><p> number of iteration in inner loop (CCE
algorithm).  Defaults to <code>NA</code>, in which case it is taken as <code>2 *
NDIM + 1</code>, as recommended by Duan et al (1994).  </p>
</dd> <dt>fnscale</dt><dd>
<p>function scaling factor (set to -1 for a maximisation problem).  By default
it is a minimisation problem.  </p>
</dd> <dt>elitism</dt><dd><p> influences sampling
of parents from each complex. Duan et al (1992) describe a 'trapezoidal'
(i.e. linear weighting) scheme, which corresponds to <code>elitism = 1</code>.
Higher values give more weight towards the better parameter sets.  Defaults
to <code>1</code>.  </p>
</dd> <dt>initsample</dt><dd><p> sampling scheme for initial
values: &quot;latin&quot; (hypercube) or &quot;random&quot;.  Defaults to <code>"latin"</code>.  </p>
</dd>
<dt>reltol</dt><dd> <p><code>reltol</code> is the convergence threshold: relative
improvement factor required in an SCE iteration (in same sense as
<code>optim</code>), and defaults to <code>1e-5</code>.
</p>
</dd><dt>tolsteps</dt><dd>
<p><code>tolsteps</code> is the number of iterations where the improvement is within
<code>reltol</code> required to confirm convergence. This defaults to <code>20</code>.  </p>
</dd>
<dt>maxit</dt><dd><p> maximum number of iterations. Defaults to
<code>10000</code>.  </p>
</dd> <dt>maxeval</dt><dd><p> maximum number of function
evaluations. Defaults to <code>Inf</code>.  </p>
</dd> <dt>maxtime</dt><dd><p> maximum
duration of optimization in seconds. Defaults to <code>Inf</code>.  </p>
</dd>
<dt>returnpop</dt><dd><p> whether to return populations (parameter sets)
from all iterations. Defaults to <code>FALSE</code>.  </p>
</dd> <dt>trace</dt><dd><p> an
integer specifying the level of user feedback. Defaults to <code>0</code>.  </p>
</dd>
<dt>REPORT</dt><dd><p> number of iterations between reports when trace &gt;= 1.
Defaults to <code>1</code>.  </p>
</dd> </dl>



<h3>Value</h3>

<p>a list of class <code>"SCEoptim"</code>.</p>
<table>
<tr><td><code>par</code></td>
<td>
<p> optimal parameter
set.</p>
</td></tr> <tr><td><code>value</code></td>
<td>
<p> value of objective function at optimal point.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> code, where 0 indicates successful covergence. </p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p> (non-)convergence message. </p>
</td></tr> <tr><td><code>counts</code></td>
<td>
<p> number of
function evaluations. </p>
</td></tr> <tr><td><code>iterations</code></td>
<td>
<p> number of iterations of the CCE
algorithm. </p>
</td></tr> <tr><td><code>time</code></td>
<td>
<p> number of seconds taken. </p>
</td></tr> <tr><td><code>POP.FIT.ALL</code></td>
<td>

<p>objective function values from each iteration in a matrix.  </p>
</td></tr>
<tr><td><code>BESTMEM.ALL</code></td>
<td>
<p> best parameter set from each iteration in a matrix.  </p>
</td></tr>
<tr><td><code>POP.ALL</code></td>
<td>
<p> if <code>(control$returnpop = TRUE)</code>, the parameter sets
from each iteration are returned in a three dimensional array.  </p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p> the list of options settings in effect. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>This code is copied from the hydromad package <br />
<br />
<a href="https://github.com/floybix/hydromad/">https://github.com/floybix/hydromad/</a> <br />
<a href="http://hydromad.catchment.org/">http://hydromad.catchment.org/</a> <br />
<br />
and written from Felix Andrews <a href="mailto:felix@nfrac.org">felix@nfrac.org</a> <br />
<br />
who adapted, and substantially revised it, from Brecht Donckels' MATLAB code,
which was in turn adapted from Qingyun Duan's MATLAB code: <br />
<br />
</p>


<h3>References</h3>

<p>Qingyun Duan, Soroosh Sorooshian and Vijai Gupta (1992). Effective and Efficient Global Optimization for Conceptual Rainfall-Runoff Models <em>Water Resources Research</em> 28(4), pp. 1015-1031.
</p>
<p>Qingyun Duan, Soroosh Sorooshian and Vijai Gupta (1994).  Optimal use of the SCE-UA global optimization method for calibrating watershed models, <em>Journal of Hydrology</em> 158, pp. 265-284.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optim">optim</a></code>, <span class="pkg">DEoptim</span> package, <span class="pkg">rgenoud</span> package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## reproduced from help("optim")

## Rosenbrock Banana function
Rosenbrock &lt;- function(x){
  x1 &lt;- x[1]
  x2 &lt;- x[2]
  100 * (x2 - x1 * x1)^2 + (1 - x1)^2
}
#lower &lt;- c(-10,-10)
#upper &lt;- -lower
ans &lt;- SCEoptim(Rosenbrock, c(-1.2,1), control = list(trace = 1))
str(ans)

## 'Wild' function, global minimum at about -15.81515
Wild &lt;- function(x)
  10*sin(0.3*x)*sin(1.3*x^2) + 0.00001*x^4 + 0.2*x+80
ans &lt;- SCEoptim(Wild, 0, lower = -50, upper = 50,
                control = list(trace = 1))
ans$par

</code></pre>

<hr>
<h2 id='SEM'>Simplified evaporation method (SEM)</h2><span id='topic+SEM'></span>

<h3>Description</h3>

<p>Determines unsaturated hydraulic conductivity and water retention characteristics from laboratory evaporation experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEM(
  suc.up,
  suc.low,
  weight = NULL,
  t,
  ths = NULL,
  r = 3.6,
  L = 6,
  z1 = 1.5,
  z2 = 4.5,
  sd.tens = 0.2,
  suc.negativ = TRUE,
  suc.out = "weighted"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEM_+3A_suc.up">suc.up</code></td>
<td>
<p>a numeric vector containing the measured suctions [cm] of the upper tensiometer</p>
</td></tr>
<tr><td><code id="SEM_+3A_suc.low">suc.low</code></td>
<td>
<p>a numeric vector containing the measured suctions [cm] of the lower tensiometer</p>
</td></tr>
<tr><td><code id="SEM_+3A_weight">weight</code></td>
<td>
<p>a numeric vector containing the measured weights [g]</p>
</td></tr>
<tr><td><code id="SEM_+3A_t">t</code></td>
<td>
<p>time in seconds [s]</p>
</td></tr>
<tr><td><code id="SEM_+3A_ths">ths</code></td>
<td>
<p>saturated water content (optional) for the calulation of the soil water contents (th)</p>
</td></tr>
<tr><td><code id="SEM_+3A_r">r</code></td>
<td>
<p>sample radius [cm]</p>
</td></tr>
<tr><td><code id="SEM_+3A_l">L</code></td>
<td>
<p>sample height [cm]</p>
</td></tr>
<tr><td><code id="SEM_+3A_z1">z1</code></td>
<td>
<p>depth of upper tensiometer [cm]</p>
</td></tr>
<tr><td><code id="SEM_+3A_z2">z2</code></td>
<td>
<p>depth of lower tensiometer [cm]</p>
</td></tr>
<tr><td><code id="SEM_+3A_sd.tens">sd.tens</code></td>
<td>
<p>measurement accuracy of tensiometer [cm]</p>
</td></tr>
<tr><td><code id="SEM_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/tensiometer values are negative and FALSE if positive</p>
</td></tr>
<tr><td><code id="SEM_+3A_suc.out">suc.out</code></td>
<td>
<p>'weighted' (default), arithmetic ('ari') or geometric ('geo') mean of the tensiometer readings (see Peters (2015) for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>sd.tens:</dt><dd>
<p>At the beginning of the experiment when gradients of the hydraulic head are small, hydraulic conductivities cannot be calculated. Following Peters and Durner (2008) hydraulic conductivities calculated from gradients smaller than (6*sd.tens)/(z2-z1) are set to NA.</p>
</dd></dl>



<h3>Value</h3>

<dl>
<dt>data.frame</dt><dd><p>Ki: unsaturated hydraulic conductivity [cm/day] <br />
th: water content (th) is returned if ths is provided as input <br />
suc: suction, either (1) weighted between arithmetic and geometric mean (default), (2) the arithmetic mean or (3) the geometric mean (see Peters 2015)</p>
</dd></dl>



<h3>Author(s)</h3>

<p>Ullrich Dettmann
</p>


<h3>References</h3>

<p>Wind, G. P. (1966). Capillary conductivity data estimated by a simple method (No. 80). [sn].
</p>
<p>Peters, A., Iden, S. C., &amp; Durner, W. (2015). Revisiting the simplified evaporation method: Identification of hydraulic functions considering vapor, film and corner flow. Journal of Hydrology, 527, 531-542.
</p>
<p>Peters, A., &amp; Durner, W. (2008). Simplified evaporation method for determining soil hydraulic properties. Journal of Hydrology, 356(1), 147-162.
</p>
<p>Schindler, U., 1980. Ein Schnellverfahren zur Messung der Wasserleitfähigkeit im teilgesättigten Boden an Stechzylinderproben. Arch. Acker- Pflanzenbau Bodenkd. 24, 1–7.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ----------------------------------------------------------------------------
# Calculate hydraulic properties with the 'Simplified Evaporation Method' (SEM)
# ----------------------------------------------------------------------------
data('dataSEM')
ths &lt;- 0.7  # define saturated water content (ths) (optional)
shp &lt;- SEM(suc.up     = dataSEM$tens.up,
          suc.low     = dataSEM$tens.low,
          weight      = dataSEM$weight,
          t           = dataSEM$ts*60*60,
          r           = 3.6, # radius of sample
          L           = 6,   # height of sample
          z1          = 1.5, # depth of upper tensiometer [cm]
          z2          = 4.5, # depth of lower tensiometer [cm]
          sd.tens     = 0.1,  # tensiometer accuracy (see ?SEM)
          ths         = ths,
          suc.negativ = TRUE,
          suc.out     = 'weighted'
)
</code></pre>

<hr>
<h2 id='SWC'>Soil water content</h2><span id='topic+SWC'></span>

<h3>Description</h3>

<p>Calculates the volumetric soil water content for a corresponding suction/pressure head (th(suc)) for unimodal or bimodal van Genuchten (vG), Peters-Durner-Iden (PDI) and Brooks and Corey (bc) (only unimodal) parameterisation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SWC(
  suc,
  par.shp = c(ths = 0.9, thr = 0, alfa = 0.02, n = 2),
  FUN.shp = "vg",
  modality = "uni",
  suc.negativ = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SWC_+3A_suc">suc</code></td>
<td>
<p>Suction/pressure heads. Negative if suc.negativ = TRUE</p>
</td></tr>
<tr><td><code id="SWC_+3A_par.shp">par.shp</code></td>
<td>
<p>named parameter in list or vector</p>
</td></tr>
<tr><td><code id="SWC_+3A_fun.shp">FUN.shp</code></td>
<td>
<p>Funktion for soil hydraulic properties (vG, PDI or bc) (see details)</p>
</td></tr>
<tr><td><code id="SWC_+3A_modality">modality</code></td>
<td>
<p>pore size distribution ('uni' or 'bi')</p>
</td></tr>
<tr><td><code id="SWC_+3A_suc.negativ">suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>FUN.shp:</dt><dd>
<p>vG: van Genuchten (uni or bimodal) (vGM is working aswell) <br />
PDI: Peters-Durner-Iden with saturation function of van Genuchten (uni or bimodal) <br />
bc: Brooks and Corey (unimodal)</p>
</dd></dl>

<dl>
<dt>par.shp (vG and PDI):</dt><dd>
<p>ths [-]: saturated water content <br />
thr [-]: residual water content<br />
alfa [1/L]: van Genuchten shape parameter <br />
n [-]: van Genuchten shape parameter <br />
m [-]: shape parameter (m = 1-(1/n) if missing)</p>
</dd>
<dt>par.shp (additional for 'PDI'):</dt><dd>
<p>h0 [L]: suction at water content of 0 (i.e. oven dryness) (h0 = 10^6.8 if missing, corresponding to oven dryness at 105°C (Schneider and Goss, 2012))</p>
</dd>
<dt>par.shp (additional for bimodal (modality = 'bi')):</dt><dd>
<p>w2 [-]: weigthing between pore space distributions <br />
alfa2 [1/L]: van Genuchten parameter alfa for second pore space distribution <br />
n2 [-]: van Genuchten parameter n for second pore space distribution <br />
m2 [-]: shape parameter (m2 = 1-(1/n2) if missing)</p>
</dd></dl>

<dl>
<dt>par.shp (BC):</dt><dd>
<p>ths [-]: saturated water content <br />
thr [-]: residual water content<br />
alfa [1/L]: inverse of the air-entry value or bubbling pressure <br />
lambda [-]: pore size distribution index </p>
</dd></dl>

<p>PDI:<br />
theta(h) = (ths - thr) * Scap(h) + thr * Sad(h) <br />
<code><a href="#topic+Scap">Scap</a>: Rescaled capillary saturation function </code> <br />
<code><a href="#topic+Sad">Sad</a>: Relative saturation function for adsorbed water</code>
</p>
<p>input for FUN.shp and modality works for upper- and lowercase letters <br />
</p>


<h3>Value</h3>

<p>volumetric water content theta (th) [L³/L³]
</p>


<h3>Author(s)</h3>

<p>Ullrich Dettmann
</p>


<h3>References</h3>

<p>Van Genuchten, M. T. (1980). A closed-form equation for predicting the hydraulic conductivity of unsaturated soils. Soil science society of America journal, 44(5), 892-898.
</p>
<p>Durner, W. (1994). Hydraulic conductivity estimation for soils with heterogeneous pore structure. Water Resources Research, 30(2), 211-223.
</p>
<p>Peters, A. (2013). Simple consistent models for water retention and hydraulic conductivity in the complete moisture range. Water Resour. Res. 49, 6765–6780. physics-a review. Vadose Zone J. http://dx.doi.org/10.2136/vzj2012.0163.
</p>
<p>Iden, S., Durner, W. (2014). Comment to Simple consistent models for water retention and hydraulic conductivity in the complete moisture range by A. Peters. Water Resour. Res. 50, 7530–7534.
</p>
<p>Peters, A. (2014). Reply to comment by S. Iden and W. Durner on Simple consistent models for water retention and hydraulic conductivity in the complete moisture range. Water Resour. Res. 50, 7535–7539.
</p>
<p>Schneider, M., &amp; Goss, K. U. (2012). Prediction of the water sorption isotherm in air dry soils. Geoderma, 170, 64-69.
</p>
<p>Brooks, R.H., and A.T. Corey (1964): Hydraulic properties of porous media. Hydrol. Paper 3. Colorado State Univ., Fort Collins, CO, USA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ku">Ku</a></code> <code><a href="#topic+Sat">Sat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --------------------------------------------
#  Unimodal van Genuchten
# --------------------------------------------
SWC(suc = seq(1, 1000, by = 1), par.shp = c(ths = 0.4, thr = 0, alfa = 0.02, n = 1.5),
FUN.shp = c('vG'), modality = 'uni', suc.negativ = FALSE)
# --------------------------------------------
#  Bimodal van Genuchten
# --------------------------------------------
SWC(suc = seq(1, 1000, by = 1),
par.shp = c(ths = 0.4, thr = 0, alfa = 0.02, n = 2, w2 = 0.2, alfa2 = 1, n2 = 10),
FUN.shp  = c('vG'), modality = c('bi'), suc.negativ = FALSE)
# --------------------------------------------
#  Unimodal PDI
# --------------------------------------------
SWC(suc = seq(1, 1000, by = 1), par.shp = list(ths = 0.4, thr = 0, n = 1.6, alfa = 0.02),
FUN.shp = c('pdi'), modality = c('uni'), suc.negativ = FALSE)
# --------------------------------------------
#  Brooks and Corey (BC) (only unimodal)
SWC(suc = seq(1, 1000, by = 1), par.shp = list(ths = 0.4, thr = 0, lambda =  0.211, alfa = 0.1),
FUN.shp = c('bc'), modality = c('uni'), suc.negativ = FALSE)
# --------------------------------------------
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
