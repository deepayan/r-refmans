<!DOCTYPE html><html lang="en"><head><title>Help for package NBDdirichlet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NBDdirichlet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#NBDdirichlet-package'>
<p>NBD-Dirichlet of Model Consumer Buying Behavior</p></a></li>
<li><a href='#dirichlet'><p>Estimation of the Dirichlet model</p></a></li>
<li><a href='#plot.dirichlet'><p>Plot of theoretical penetration growth and buying rate growth</p></a></li>
<li><a href='#print.dirichlet'><p>Print Dirichlet model information</p></a></li>
<li><a href='#summary.dirichlet'><p>Theoretical summary statistics from the Dirichlet model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>NBD-Dirichlet Model of Consumer Buying Behavior for Marketing
Research</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Feiming Chen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Feiming Chen &lt;feimingchen@yahoo.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ani.stat.fsu.edu/~fchen/statistics/R-package-NBDdirichlet/how-to-use-Dirichlet-marketing-model.html">https://ani.stat.fsu.edu/~fchen/statistics/R-package-NBDdirichlet/how-to-use-Dirichlet-marketing-model.html</a></td>
</tr>
<tr>
<td>Description:</td>
<td>The Dirichlet (aka NBD-Dirichlet) model describes the purchase incidence and brand choice of consumer products.  We estimate the model and summarize various theoretical quantities of interest to marketing researchers. Also provides functions for making tables that compare observed and theoretical statistics. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-27 13:36:17 UTC; fchen</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-29 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='NBDdirichlet-package'>
NBD-Dirichlet of Model Consumer Buying Behavior
</h2><span id='topic+NBDdirichlet-package'></span>

<h3>Description</h3>

<p> The Dirichlet (aka NBD-Dirichlet) model describes the
probability distributions of the consumer purchase incidences and brand
choices.  We estimate the model and calculate various theoretical
quantities of interest to marketing researchers.  </p>


<h3>Author(s)</h3>

<p>Feiming Chen
</p>


<h3>References</h3>

<p><em>The Dirichlet: A Comprehensive Model of Buying
Behavior</em>.  G.J. Goodhardt, A.S.C. Ehrenberg, C. Chatfield.  <em>Journal
of the Royal Statistical Society. Series A
(General)</em>, Vol. 147, No. 5 (1984), pp. 621-655
</p>
<p><em>Repeat-Buying:Facts,Theory and Applications</em>, 2nd edn.
A.S.C. Ehrenberg, 1988, London, Charles Griffin, ISBN 0 85264 287 3
</p>
<p><em>Book Review: Repeat-Buying:Facts,Theory and Applications by
A.S.C. Ehrenberg</em>. Norman Pigden. <em>The Statistician</em>, Vol. 40,
No. 3, Special Issue (1991), pp. 349-350
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+dirichlet">dirichlet</a></code>,
<code><a href="#topic+print.dirichlet">print.dirichlet</a></code>, <code><a href="#topic+summary.dirichlet">summary.dirichlet</a></code>,
<code><a href="#topic+plot.dirichlet">plot.dirichlet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>cat.pen &lt;- 0.56 # Category Penetration
cat.buyrate &lt;- 2.6 # Category Buyer's Average Purchase Rate in a given period.
brand.share &lt;- c(0.25, 0.19, 0.1, 0.1, 0.09, 0.08, 0.03, 0.02) # Brands' Market Share
brand.pen.obs &lt;- c(0.2,0.17,0.09,0.08,0.08,0.07,0.03,0.02) # Brand Penetration
brand.name &lt;- c("Colgate DC", "Macleans","Close Up","Signal","ultrabrite",
"Gibbs SR","Boots Priv. Label","Sainsbury Priv. Lab.")

dobj &lt;- dirichlet(cat.pen, cat.buyrate, brand.share, brand.pen.obs, brand.name)
print(dobj)
summary(dobj)
# plot(dobj)
</code></pre>

<hr>
<h2 id='dirichlet'>Estimation of the Dirichlet model</h2><span id='topic+dirichlet'></span>

<h3>Description</h3>

<p>Given consumer purchase summary data, it estimates the parameters of the
Dirichlet model, which describes the consumer repeat-buying behavior
of branded products.  It also returns with several probability
functions for users to calculate various theoretical quantities. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dirichlet(cat.pen, cat.buyrate, brand.share, brand.pen.obs,
brand.name = NA, cat.pur.var = NA, nstar = 50,
max.S = 30, max.K = 30, check = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dirichlet_+3A_cat.pen">cat.pen</code></td>
<td>
<p> Product category penetration, which is the observed proportion
of category buyers over a specific time period.  </p>
</td></tr>
<tr><td><code id="dirichlet_+3A_cat.buyrate">cat.buyrate</code></td>
<td>
<p>Category buyers' average purchase rate in a given
period. This is derived as the total number of category purchase
occasions divided by the total number of category buyers during a
time period.   </p>
</td></tr>
<tr><td><code id="dirichlet_+3A_brand.share">brand.share</code></td>
<td>
<p> A vector of brand market share.  We typically
define it as the proportions of purchase occasions that belong to
different brands during the time period.  </p>
</td></tr>
<tr><td><code id="dirichlet_+3A_brand.pen.obs">brand.pen.obs</code></td>
<td>
<p> A vector of observed brand penetration, which is the proportion of
buyers for each brand during the time period.   </p>
</td></tr>
<tr><td><code id="dirichlet_+3A_brand.name">brand.name</code></td>
<td>
<p> A character vector of the brand names.  If not
given (default), use &quot;B1&quot;, &quot;B2&quot;, etc. </p>
</td></tr>
<tr><td><code id="dirichlet_+3A_cat.pur.var">cat.pur.var</code></td>
<td>
<p> The observed variance of category purchase rates
across individuals.  It is used for the method of moment estimation
of the parameter K in the Dirichlet model.  If it is
not given (default), then estimate K by &quot;mean and zeros&quot;(see reference).   </p>
</td></tr>
<tr><td><code id="dirichlet_+3A_nstar">nstar</code></td>
<td>
<p>Maximum number of category purchases in the time period considered in the calculation.  Any number larger than <code>nstar</code>  is assumed to have occurred with probability zero.  By default, it is 50.  For higher frequently
purchased category and longer study time period, it is necessary to
increase <code>nstar</code>  to the level (say, 100, 300, etc.)
where <code class="reqn">\sum_{n=1}^{nstar} P(n) &gt; 0.9999</code>.  We did not use the
truncation procedure (suggested by the reference authors) in order
to simplify coding.    
</p>
</td></tr>
<tr><td><code id="dirichlet_+3A_max.s">max.S</code></td>
<td>
<p>Upper bound for the model parameter S in the optimization procedure to solve
for S. Default to 30.    </p>
</td></tr>
<tr><td><code id="dirichlet_+3A_max.k">max.K</code></td>
<td>
<p>Upper bound for the model parameter K in the optimization procedure to solve
for K. Default to 30.   </p>
</td></tr>
<tr><td><code id="dirichlet_+3A_check">check</code></td>
<td>
<p>A logical value.  If T, print some diagnostic
information.  Defaul to F.   </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Dirichlet model and its estimation can be found in the reference
paper.  It is found to fit and reproduce the patterns of repeat buying of branded
products quite well.  Specifically, the dirichlet model is a mixture of distributions at four levels:
</p>

<ol>
<li><p> Each consumer's purchase incidences in a product category follow the Poisson process.
</p>
</li>
<li><p> The purchase rates of the category by different consumers follow a Gamma distribution. 
</p>
</li>
<li><p> Each consumer's choices among the available brands follow a multinomial distribution, and 
</p>
</li>
<li><p> These brand choice probabilities follow a multivariate Beta or
&quot;Dirichlet&quot; distribution across different consumers.  </p>
</li></ol>

<p>There are three structural parameters to be estimated:
</p>

<dl>
<dt>M</dt><dd><p>Mean purchase rate of the category.</p>
</dd>
<dt>K</dt><dd><p>Measures the diversity of the overal category purchase
frequency across consumers (smaller K implies more diversity).</p>
</dd>
<dt>S</dt><dd><p>Measures the diversity of the brand purchase propensity
across consumers (smaller S implies more diversity).</p>
</dd>
</dl>

<p>To estimate M and K, we use the observed category penetration
(<code>cat.pen</code>) and purchase rate (<code>cat.buyrate</code>).  To estimate S,
we use additionally the observed brand penetrations
(<code>brand.pen.obs</code>) and brand market shares (<code>brand.share</code>).
Note however once these three parameters are estimated, only the brand
market shares are needed by the Dirichlet model to compute various
repeat-buying theoretical statistics.
</p>
<p>The estimated parameters, along with several probability functions that can access
the object data, are passed back in a list, which is assigned a 
&quot;dirichlet&quot; class attribute.  The result can be used by the <code><a href="#topic+print.dirichlet">print.dirichlet</a></code>,
<code><a href="#topic+summary.dirichlet">summary.dirichlet</a></code>, and <code><a href="#topic+plot.dirichlet">plot.dirichlet</a></code>
method.
</p>
<p>The study period (where we report the model result) is assumed to be 4
times of the observation period (input data).  So if we use quarterly
data, the model output is annulized.  This multiple (4) can be changed
using the member function <code>period.set</code>.  </p>


<h3>Value</h3>

<p> A list with the following components:
</p>
<table role = "presentation">
<tr><td><code>M</code></td>
<td>
<p>Estimated Dirichlet model parameter:  mean purchase rate of the category.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Estimated Dirichlet model parameter: it measures the diversity
of the overal category purchase frequency (smaller K implies more
diversity).</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Estimated Dirichlet model parameter: it measures the diversity of the brand purchase propensity (smaller S implies more diversity).</p>
</td></tr>
<tr><td><code>nbrand</code></td>
<td>
<p>Number of brands being considered in the produt category.</p>
</td></tr>
<tr><td><code>nstar</code></td>
<td>
<p>Input parameter: Maximum number of category purchases considered.</p>
</td></tr>
<tr><td><code>cat.pen</code></td>
<td>
<p>Input parameter: Category penetration in a given time period. </p>
</td></tr>
<tr><td><code>cat.buyrate</code></td>
<td>
<p> Input parameter: Category buyers' average purchase rate in a given
time period.</p>
</td></tr>
<tr><td><code>brand.share</code></td>
<td>
<p>Input parameter: A vector of brand market share.</p>
</td></tr>  
<tr><td><code>brand.pen.obs</code></td>
<td>
<p>Input parameter: A vector of observed brand penetration.</p>
</td></tr>
<tr><td><code>brand.name</code></td>
<td>
<p>Input parameter: A character vector of the brand names.</p>
</td></tr> 
<tr><td><code>check</code></td>
<td>
<p>A logical flag that indicates whether to print the
intermediate information in the model estimation. Default to F.</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>A logical flag that indicates if <code>nstar</code> is too small
to sufficently cover the support of category purchase probabilities
(calculated by <code>Pn</code>, see below).  If it is returned <code>T</code>, then
<code>nstar</code> should be increased and the Dirichlet model be
re-estimated.</p>
</td></tr>
<tr><td><code>period.set</code></td>
<td>
<p>A member function of the &quot;dirichlet&quot; class object with
one required parameter <code>(t)</code>, which can be any positive real number.  It resets
the study time period to be <code>t</code> times of the assumed base time
period in the sample.</p>
</td></tr>
<tr><td><code>period.print</code></td>
<td>
<p>A member function of the &quot;dirichlet&quot; class object
with no parameter.  It indicates the current time period by printing the
multiple <code>t</code> of the base time period.</p>
</td></tr>
<tr><td><code>p.rj.n</code></td>
<td>
<p> A member function of the &quot;dirichlet&quot; class object with
three required parameters <code>(r_j, n, j)</code>.  It calculates the conditional
probability of buying brand <code>j</code> for exactly <code>r_j</code> times given
that the consumer has made <code>n</code> category purchases.</p>
</td></tr>
<tr><td><code>Pn</code></td>
<td>
<p>A member function of the &quot;dirichlet&quot; class object with one
required parameter <code>(n)</code>.  It calculates the probability that a consumer has
made <code>n</code> category purchases in the study time period.</p>
</td></tr>
<tr><td><code>brand.pen</code></td>
<td>
<p>A member function of the &quot;dirichlet&quot; class object with
one required and one optional parameter (<code>j, limit=c(0:nstar)</code>). It
calculates the probability that a consumer makes at least one purchase of
the brand <code>j</code> (theoretical penetration) in the study time period. 
The optional vector <code>limit</code> enumerates the exact frequencies that a
consumer will be buying in the category and is used to index the
summation of the probabilities of <em>not</em> buying brand <code>j</code> given
those category purchases in <code>limit</code>.</p>
</td></tr>
<tr><td><code>brand.buyrate</code></td>
<td>
<p>A member function of the &quot;dirichlet&quot; class object
with one required and one optional parameter <code>(j, limit=c(0:nstar))</code>. It
calculates the expected number of brand <code>j</code> purchases given that
the consumer is a buyer of the brand <code>j</code> in the time period (theoretical brand
buying rate).  The <code>limit</code> parameter has the same meaning as that
in the function <code>brand.pen</code>.</p>
</td></tr>
<tr><td><code>wp</code></td>
<td>
<p>A member function of the &quot;dirichlet&quot; class object with one
required and one optional parameter <code>(j, limit=c(0:nstar))</code>. It
calculates the expected number of the product category purchases given
that the consumer is a buyer of the brand <code>j</code> in the time period
(theoretical category buying rate for brand buyer).  The <code>limit</code>
parameter has the same meaning as that in the function <code>brand.pen</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Feiming Chen  </p>


<h3>References</h3>

<p><em>The Dirichlet: A Comprehensive Model of Buying
Behavior</em>.  G.J. Goodhardt, A.S.C. Ehrenberg, C. Chatfield.  <em>Journal
of the Royal Statistical Society. Series A  (General)</em>, Vol. 147, No. 5 (1984), pp. 621-655
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.dirichlet">print.dirichlet</a></code>, <code><a href="#topic+summary.dirichlet">summary.dirichlet</a></code>,
<code><a href="#topic+plot.dirichlet">plot.dirichlet</a></code>, <code><a href="#topic+NBDdirichlet-package">NBDdirichlet-package</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># The following data comes from the example in section 3 of
# the reference paper.  They are Toothpaste purchase data in UK
# in 1st quarter of 1973 from the AGB panel (5240 static panelists).

cat.pen &lt;- 0.56 # Category Penetration
cat.buyrate &lt;- 2.6 # Category Buyer's Average Purchase Rate in a given period.
brand.share &lt;- c(0.25, 0.19, 0.1, 0.1, 0.09, 0.08, 0.03, 0.02) # Brands' Market Share
brand.pen.obs &lt;- c(0.2,0.17,0.09,0.08,0.08,0.07,0.03,0.02) # Brand Penetration
brand.name &lt;- c("Colgate DC", "Macleans","Close Up","Signal","ultrabrite",
"Gibbs SR","Boots Priv. Label","Sainsbury Priv. Lab.")

dobj &lt;- dirichlet(cat.pen, cat.buyrate, brand.share, brand.pen.obs, brand.name)
print(dobj)
</code></pre>

<hr>
<h2 id='plot.dirichlet'>Plot of theoretical penetration growth and buying rate growth</h2><span id='topic+plot.dirichlet'></span>

<h3>Description</h3>

<p>This function plots a 'dirichlet' object.  It is a method for the
generic function <code>plot</code> for objects of the class
'dirichlet'. It plots the theoretical penetration growth and buying rate
growth across multiple brands according to the Dirichlet model over a specified time sequence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dirichlet'
plot(x, t = 4, brand = 1:x$nbrand, incr = 1, result = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.dirichlet_+3A_x">x</code></td>
<td>
<p>An object of &quot;dirichlet&quot; class.</p>
</td></tr>
<tr><td><code id="plot.dirichlet_+3A_t">t</code></td>
<td>
<p>Maximum of the projection time period,  which is specified as
a multiple of the base time period.  For example, if the base
time period is quarterly, then <code>t=4</code> would mean
annually.</p>
</td></tr>
<tr><td><code id="plot.dirichlet_+3A_brand">brand</code></td>
<td>
<p>A vector specifying the subset of brands to be ploted.  </p>
</td></tr>
<tr><td><code id="plot.dirichlet_+3A_incr">incr</code></td>
<td>
<p>Increment for the time sequence that starts at 0.  Its
unit is one base time period.  Can be a fractional number such as 0.1. </p>
</td></tr>
<tr><td><code id="plot.dirichlet_+3A_result">result</code></td>
<td>
<p>A list returned from the previous run of the
<code>plot.dirichlet</code>.  It is used to avoid repeating the computation when
<code>incr</code> is changed.  </p>
</td></tr>
<tr><td><code id="plot.dirichlet_+3A_...">...</code></td>
<td>
<p>Other parameters passing to the generic function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p> A time sequence will be made from 0 up to <code>t</code> with increment
<code>incr</code>, against each component of which  the theoretical penetration and
brand buying rate will be plotted.  Each plotted point represents the
<em>cumulated</em> penetration or buying rate from time 0 to its current
time point (expressed as the multiple of the base time period).   
</p>


<h3>Value</h3>

<p>A list with two components:
</p>
<table role = "presentation">
<tr><td><code>pen</code></td>
<td>
<p>A matrix with the penetration values.  Its number of rows
is the number of brands, and its number of columns is the length of the
time sequence used for plotting the X coordinates of the points.</p>
</td></tr>
<tr><td><code>buy</code></td>
<td>
<p>A matrix with the buying rate values.  Its dimension is
the same as that of <code>pen</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Feiming Chen  </p>


<h3>References</h3>

<p><em>The Dirichlet: A Comprehensive Model of Buying
Behavior</em>.  G.J. Goodhardt, A.S.C. Ehrenberg, C. Chatfield.  <em>Journal
of the Royal Statistical Society. Series A  (General)</em>, Vol. 147, No. 5 (1984), pp. 621-655
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dirichlet">dirichlet</a></code>, <code><a href="#topic+summary.dirichlet">summary.dirichlet</a></code>,
<code><a href="#topic+print.dirichlet">print.dirichlet</a></code>, <code><a href="#topic+NBDdirichlet-package">NBDdirichlet-package</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>cat.pen &lt;- 0.56 # Category Penetration
cat.buyrate &lt;- 2.6 # Category Buyer's Average Purchase Rate in a given period.
brand.share &lt;- c(0.25, 0.19, 0.1, 0.1, 0.09, 0.08, 0.03, 0.02) # Brands' Market Share
brand.pen.obs &lt;- c(0.2,0.17,0.09,0.08,0.08,0.07,0.03,0.02) # Brand Penetration
brand.name &lt;- c("Colgate DC", "Macleans","Close Up","Signal","ultrabrite",
"Gibbs SR","Boots Priv. Label","Sainsbury Priv. Lab.")

dobj &lt;- dirichlet(cat.pen, cat.buyrate, brand.share, brand.pen.obs, brand.name)
plot(dobj)
</code></pre>

<hr>
<h2 id='print.dirichlet'>Print Dirichlet model information</h2><span id='topic+print.dirichlet'></span>

<h3>Description</h3>

<p>This function prints a 'dirichlet' object.  It is a method for the
generic function <code>print</code> of class 'dirichlet'. It prints
descriptive information on the product category, brand, and the
estimated Dirichlet model parameters. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dirichlet'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.dirichlet_+3A_x">x</code></td>
<td>
<p>An object of &quot;dirichlet&quot; class.</p>
</td></tr>
<tr><td><code id="print.dirichlet_+3A_...">...</code></td>
<td>
<p>Other parameters passing to the generic function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following information is printed:
</p>

<ul>
<li><p> Number of brands in the category
</p>
</li>
<li><p> Brand list 
</p>
</li>
<li><p> Brands' market shares.
</p>
</li>
<li><p> Brands' penetrations.
</p>
</li>
<li><p> The multiple of the base time period that indicates the study time
period, and the corresponding M value.
</p>
</li>
<li><p> Category penetration and  category buying rate.
</p>
</li>
<li><p> Estimated dirichlet model parameters: M (for base period), K,
and S.
</p>
</li></ul>



<h3>Value</h3>

<p>NULL 
</p>


<h3>Author(s)</h3>

<p>Feiming Chen</p>


<h3>References</h3>

<p><em>The Dirichlet: A Comprehensive Model of Buying
Behavior</em>.  G.J. Goodhardt, A.S.C. Ehrenberg, C. Chatfield.  <em>Journal
of the Royal Statistical Society. Series A  (General)</em>, Vol. 147, No. 5 (1984), pp. 621-655
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dirichlet">dirichlet</a></code>, <code><a href="#topic+summary.dirichlet">summary.dirichlet</a></code>,
<code><a href="#topic+plot.dirichlet">plot.dirichlet</a></code>, <code><a href="#topic+NBDdirichlet-package">NBDdirichlet-package</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>cat.pen &lt;- 0.56 # Category Penetration
cat.buyrate &lt;- 2.6 # Category Buyer's Average Purchase Rate in a given period.
brand.share &lt;- c(0.25, 0.19, 0.1, 0.1, 0.09, 0.08, 0.03, 0.02) # Brands' Market Share
brand.pen.obs &lt;- c(0.2,0.17,0.09,0.08,0.08,0.07,0.03,0.02) # Brand Penetration
brand.name &lt;- c("Colgate DC", "Macleans","Close Up","Signal","ultrabrite",
"Gibbs SR","Boots Priv. Label","Sainsbury Priv. Lab.")

dobj &lt;- dirichlet(cat.pen, cat.buyrate, brand.share, brand.pen.obs, brand.name)
print(dobj)  # YOU WILL SEE THE FOLLOWING:

# Number of Brands in the Category = 8 
# Brand List : Colgate DC : Macleans : Close Up : Signal : ultrabrite :
#              Gibbs SR : Boots Priv. Label : Sainsbury Priv. Lab.
# Brands' Market Shares: 0.25 0.19 0.1 0.1 0.09 0.08 0.03 0.02 
# Brands' Penetration:   0.2 0.17 0.09 0.08 0.08 0.07 0.03 0.02 
# Multiple of Base Time Period: 1 , Current M = 1.456 

# Channel Penetration = 0.56 , with Shopping Rate = 2.6 
# Estimated Dirichlet Model Parameters:
# NBD: M = 1.46 ,  K = 0.78 ;  Dirichlet: S = 1.55 
</code></pre>

<hr>
<h2 id='summary.dirichlet'>Theoretical summary statistics from the Dirichlet model.</h2><span id='topic+summary.dirichlet'></span>

<h3>Description</h3>

<p>This function summarizes a 'dirichlet' object.  It is a method for the
generic function <code>summary</code> of class 'dirichlet'.  It
calculate four types of theoretical summary statistics, which can be
compared with the corresponding observed statistics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dirichlet'
summary(object, t = 1, type = c("buy", "freq", "heavy", "dup"),
digits = 2, freq.cutoff = 5, heavy.limit = 1:6, dup.brand = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.dirichlet_+3A_object">object</code></td>
<td>
<p>An object of &quot;dirichlet&quot; class.</p>
</td></tr>
<tr><td><code id="summary.dirichlet_+3A_t">t</code></td>
<td>
<p>Multiple of the base time period. For example, if the assumed
base time period is quarterly, then <code>t=4</code> would mean
annually. Default to one.</p>
</td></tr>
<tr><td><code id="summary.dirichlet_+3A_type">type</code></td>
<td>
<p>A character vector that specifies which types of
theoretical statistics (during the time period indicated by <code>t</code>) are to be
calculated.  Four character strings can be listed:
</p>

<dl>
<dt>buy</dt><dd><p>Theoretical brand penetration, buying rate, and the buying
rate of the category per brand buyer.</p>
</dd>
<dt>freq</dt><dd><p>Distribution of the number of brand purchases.</p>
</dd>
<dt>heavy</dt><dd><p>Theoretical brand penetration and buying rate among
category buyers with a specific frequency range.</p>
</dd>
<dt>dup</dt><dd><p>Brand duplication (proportion of buyers of a particular
brand also buying other brand).</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="summary.dirichlet_+3A_digits">digits</code></td>
<td>
<p>Number of decimal digits to control the rounding
precision of the reported statistics. Default to 2. </p>
</td></tr>
<tr><td><code id="summary.dirichlet_+3A_freq.cutoff">freq.cutoff</code></td>
<td>
<p>For the <code>type="freq"</code> table, where to cut off and
lump the tail of the frequency distribution.</p>
</td></tr>
<tr><td><code id="summary.dirichlet_+3A_heavy.limit">heavy.limit</code></td>
<td>
<p>For the <code>type="heavy"</code> table, a vector containing the
specific purchase frequency range of the category buyers. The
upper-bound of the frequency is <code>nstar</code>.</p>
</td></tr>
<tr><td><code id="summary.dirichlet_+3A_dup.brand">dup.brand</code></td>
<td>
<p>For the <code>type="dup"</code> table, the focal
brand. Defaul to the first brand in the brand list.</p>
</td></tr>
<tr><td><code id="summary.dirichlet_+3A_...">...</code></td>
<td>
<p>Other parameters passing to the generic function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output corresponds to the theoretical portion of the Table 3, 4,
5, 6 in the reference paper.  We also have another set of functions
(available upon request) that put observed and theoretical statistics
together for making tables that resemble those in the reference.
</p>
<p>Let <code class="reqn">P_n</code> be the probability of a consumer buying the product
category <code class="reqn">n</code> times.  Then <code class="reqn">P_n</code> has a Negative Binomial
Distribution (NBD).   Let <code class="reqn">p(r_j|n)</code> be the probability of making
<code class="reqn">r_j</code> purchases of brand <code class="reqn">j</code>, gien that <code class="reqn">n</code> purchases
of the category having been make (<code class="reqn">r_j\leq n</code>).  Then <code class="reqn">p(r_j|n)</code>
has a Beta-Binomial distribution.
</p>
<p>The theoretical brand penetration <code class="reqn">b</code> is then
</p>
<p style="text-align: center;"><code class="reqn">b = 1 - \sum_{n=0} P_n p(0|n)</code>
</p>

<p>The theoretical brand buying rate <code class="reqn">w</code> is
</p>
<p style="text-align: center;"><code class="reqn">w = \frac{\sum_{n=1} \{  P_n \sum_{r=1}^n r p(r|n) \}}{b} </code>
</p>

<p>and the category buying rate per brand buyer <code class="reqn">w_P</code> is
</p>
<p style="text-align: center;"><code class="reqn">w_P = \frac{\sum_{n=1} \{ n P_n [ 1 - p(0|n)] \}}{b} </code>
</p>

<p>The brand purchase frequency distribution is
</p>
<p style="text-align: center;"><code class="reqn"> f(r) = \sum_{n \geq r} P_n p(r|n) </code>
</p>

<p>The brand penetration given a specific category purchase frequency range
<code class="reqn">R=\{i_1, i_2, i_3, \ldots\}</code> is
</p>
<p style="text-align: center;"><code class="reqn">1 - \frac{\sum_{n \in R}  P(n) p(0|n)}{\sum_{n \in R} P(n)}</code>
</p>

<p>The brand buying rate given a specific category purchase frequency range
<code class="reqn">R=\{i_1, i_2, i_3, \ldots\}</code> is
</p>
<p style="text-align: center;"><code class="reqn">\frac{\sum_{n \in R} P(n) [\sum_{r=1}^n r p(r|n)]}{\sum_{n \in R}
    P(n) [1 - p(0|n)] }</code>
</p>

<p>To calculate the brand duplication measure, we first get the penetration <code class="reqn">b_{(j+k)}</code>
of the &quot;composite&quot; brand of two brands <code class="reqn">j</code> and <code class="reqn">k</code> as:
</p>
<p style="text-align: center;"><code class="reqn"> b_{(j+k)} = 1 - \sum_n  P_n p_k(0|n) p_j(0|n)</code>
</p>

<p>Then the theoretical proportion <code class="reqn">b_{jk}</code> of the population buying both brands at
least once  is:
</p>
<p style="text-align: center;"><code class="reqn">b_{jk} = b_j + b_k - b_{(j+k)}</code>
</p>

<p>and the brand duplication <code class="reqn">b_{j/k}</code> (where brand <code class="reqn">k</code> is the focal
brand) is:
</p>
<p style="text-align: center;"><code class="reqn">b_{j/k} = b_{jk} / b_k</code>
</p>



<h3>Value</h3>

<p>A list with those components that are specified by the input
<code>type</code> parameter. 
</p>
<table role = "presentation">
<tr><td><code>buy</code></td>
<td>
<p>A data frame with three components: <code>pen.brand</code> (Theoretical brand penetration),
<code>pur.brand</code> (buying rate of the brand), <code>pur.cat</code> (buying
rate of the category per brand buyer). </p>
</td></tr>
<tr><td><code>freq</code></td>
<td>
<p>A matrix that lists the distribution of brand
purchases.  The number of rows is the number of brands.</p>
</td></tr>
<tr><td><code>heavy</code></td>
<td>
<p>A matrix with two columns.  The first column
(<code>Penetration</code>) is the theoretical brand penetration among
category buyers with a specific frequency range. The second column
(<code>Avg Purchase Freq</code>) is the brand buying rate of those category
buyers. The number of rows is the number of brands.</p>
</td></tr>
<tr><td><code>dup</code></td>
<td>
<p>A vector with dimension as the number of brands. It reports
the brand duplication (proportion of buyers of a particular brand
also buying other brand) of the focal brand (<code>dup.brand</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Feiming Chen  </p>


<h3>References</h3>

<p><em>The Dirichlet: A Comprehensive Model of Buying
Behavior</em>.  G.J. Goodhardt, A.S.C. Ehrenberg, C. Chatfield.  <em>Journal
of the Royal Statistical Society. Series A  (General)</em>, Vol. 147, No. 5 (1984), pp. 621-655
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dirichlet">dirichlet</a></code>, <code><a href="#topic+print.dirichlet">print.dirichlet</a></code>,
<code><a href="#topic+plot.dirichlet">plot.dirichlet</a></code>, <code><a href="#topic+NBDdirichlet-package">NBDdirichlet-package</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>cat.pen &lt;- 0.56 # Category Penetration
cat.buyrate &lt;- 2.6 # Category Buyer's Average Purchase Rate in a given period.
brand.share &lt;- c(0.25, 0.19, 0.1, 0.1, 0.09, 0.08, 0.03, 0.02) # Brands' Market Share
brand.pen.obs &lt;- c(0.2,0.17,0.09,0.08,0.08,0.07,0.03,0.02) # Brand Penetration
brand.name &lt;- c("Colgate DC", "Macleans","Close Up","Signal","ultrabrite",
"Gibbs SR","Boots Priv. Label","Sainsbury Priv. Lab.")

dobj &lt;- dirichlet(cat.pen, cat.buyrate, brand.share, brand.pen.obs, brand.name)

## Not run: summary(dobj)
summary(dobj, t=4, type="freq")
summary(dobj, t=4, type="heavy", heavy.limit=c(7:50))
summary(dobj, t=1, type="dup", dup.brand=2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
