<!DOCTYPE html><html><head><title>Help for package Quartet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Quartet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Quartet-package'><p>Quartet</p></a></li>
<li><a href='#.AddSlice'><p>Add slice to 3D array</p></a></li>
<li><a href='#.CheckSize'><p>Check tree size</p></a></li>
<li><a href='#.NormalizeStatus'><p>Normalize element statuses to generate metric</p></a></li>
<li><a href='#.StatusToMatrix'><p>Status vector to matrix</p></a></li>
<li><a href='#AllQuartets'><p>List all quartets</p></a></li>
<li><a href='#CompareQuartets'><p>Compare quartet states by explicit enumeration</p></a></li>
<li><a href='#CompareQuartetsMulti'><p>Compare one tree's quartets against others'</p></a></li>
<li><a href='#CompareSplits'><p>Compare status of splits</p></a></li>
<li><a href='#Distances'><p>Direct entry points to &quot;tqDist&quot; functions</p></a></li>
<li><a href='#PairSharedQuartetStatus'><p>Status of quartets that exist in two trees</p></a></li>
<li><a href='#PairSharedSplitStatus'><p>Pair shared split status</p></a></li>
<li><a href='#PlotQuartet'><p>Plot quartet on tree topologies</p></a></li>
<li><a href='#QuartetPoints'><p>Plot tree differences on ternary plots</p></a></li>
<li><a href='#QuartetState'><p>Quartet State(s)</p></a></li>
<li><a href='#ResolvedQuartets'><p>Count resolved quartets</p></a></li>
<li><a href='#SharedQuartetStatus'><p>Status of quartets</p></a></li>
<li><a href='#SimilarityMetrics'><p>Tree similarity measures</p></a></li>
<li><a href='#SplitStatus'><p>Matching partitions</p></a></li>
<li><a href='#sq_trees'><p>Eighteen example trees</p></a></li>
<li><a href='#SymmetricDifferenceLineEnds'><p>Plot contours of equal symmetric difference on a ternary plot</p></a></li>
<li><a href='#TQDist'><p>Wrapper for tqDist</p></a></li>
<li><a href='#tqdist_QuartetDistance'><p>Direct entry points to 'tqDist' functions</p></a></li>
<li><a href='#TQFile'><p>tqDist file generator</p></a></li>
<li><a href='#ValidateQuartetFile'><p>Validate filenames</p></a></li>
<li><a href='#VisualizeQuartets'><p>Visualize quartet difference on trees, by split</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.2.6</td>
</tr>
<tr>
<td>Title:</td>
<td>Comparison of Phylogenetic Trees Using Quartet and Split
Measures</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates the number of four-taxon subtrees consistent with a pair
  of cladograms, calculating the symmetric quartet distance of Bandelt &amp; Dress
  (1986), Reconstructing the shape of a tree from observed dissimilarity data,
  Advances in Applied Mathematics, 7, 309-343 &lt;<a href="https://doi.org/10.1016%2F0196-8858%2886%2990038-2">doi:10.1016/0196-8858(86)90038-2</a>&gt;, 
  and using the tqDist algorithm of Sand et al. (2014), tqDist: a library for
  computing the quartet and triplet distances between binary or general trees,
  Bioinformatics, 30, 2079–2080 &lt;<a href="https://doi.org/10.1093%2Fbioinformatics%2Fbtu157">doi:10.1093/bioinformatics/btu157</a>&gt;
  for pairs of binary trees.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ms609.github.io/Quartet/">https://ms609.github.io/Quartet/</a>,
<a href="https://github.com/ms609/Quartet/">https://github.com/ms609/Quartet/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ms609/Quartet/issues/">https://github.com/ms609/Quartet/issues/</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>Incorporates code modified from tqDist
&lt;doi:10.1093/bioinformatics/btu157&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), TreeTools (&ge; 1.4.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, Rdpack (&ge; 0.7), Ternary (&ge; 1.0), viridisLite,</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bookdown, knitr, phangorn, Rcpp, rmarkdown, testthat,
usethis, vdiffr,</td>
</tr>
<tr>
<td>Config/Needs/check:</td>
<td>rcmdcheck, tinytex,</td>
</tr>
<tr>
<td>Config/Needs/coverage:</td>
<td>covr</td>
</tr>
<tr>
<td>Config/Needs/memcheck:</td>
<td>devtools</td>
</tr>
<tr>
<td>Config/Needs/metadata:</td>
<td>codemetar</td>
</tr>
<tr>
<td>Config/Needs/revdeps:</td>
<td>revdepcheck</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>pkgdown</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-09 08:13:27 UTC; pjjg18</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin R. Smith <a href="https://orcid.org/0000-0001-5660-1727"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Andreas Sand [ant],
  Gerth Stølting Brodal [ant],
  Rolf Fagerberg [ant],
  Thomas Mailund [ant],
  Christian N. S. Pedersen [ant],
  Jens Johansen [ant],
  Morten K. Holt [ant]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin R. Smith &lt;martin.smith@durham.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-09 08:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='Quartet-package'>Quartet</h2><span id='topic+Quartet'></span><span id='topic+Quartet-package'></span>

<h3>Description</h3>

<p>'<a href="https://ms609.github.io/Quartet/">Quartet</a>' is an R package that calculates
the quartet distance between two trees (Estabrook <em>et al.</em> 1985),
a measure of their similarity based on the number of shared four-taxon subtrees.
</p>


<h3>Details</h3>

<p>The quartet distance outperforms a number of widely used tree distances
(e.g. the Robinson–Foulds, path, and rearrangement distances) against a number
theoretical and practical measures (Steel &amp; Penny 1993; Smith 2020),
and is particularly valuable in the construction of tree spaces (Smith 2021).
</p>
<p>'Quartet' uses the 'tqDist' algorithm (Brodal <em>et al.</em> 2004; Sand <em>et al.</em> 2014).
Unlike many other implementations, it distinguishes between quartets that are
contradicted by one tree,
and quartets that are simply absent due to a lack of resolution (i.e.
the presence of polytomies; see Smith 2019).
'Quartet' makes this distinction in both the quartet metric (function
<code>QuartetStatus()</code>) and the partition metric (i.e. Robinson-Foulds distance;
function <code>SplitStatus()</code>).
</p>


<h4>Using Quartet</h4>

<p>View the <a href="https://ms609.github.io/Quartet/reference/">function reference</a>
and <a href="https://ms609.github.io/Quartet/articles/Using-Quartet.html">basic usage instructions</a>.
</p>



<h4>Known limitations</h4>

<p>Quartet supports trees with up to 477 leaves.  Larger trees contain more
quartets than can be represented by R's signed 32-bit integers.
</p>
<p>The underlying 'tqDist' library may handle trees with up to 568 leaves,
and 64-bit integer representations could increase this number further.
Making either of these improvements within the R package
would require substantial additional work, but could be implemented &ndash; do
<a href="https://github.com/ms609/Quartet/issues/new/">file an issue</a> if this would
be useful to you.
</p>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Martin R. Smith <a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a> (<a href="https://orcid.org/0000-0001-5660-1727">ORCID</a>) [copyright holder]
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Andreas Sand [bibliographic antecedent]
</p>
</li>
<li><p> Gerth Stølting Brodal [bibliographic antecedent]
</p>
</li>
<li><p> Rolf Fagerberg [bibliographic antecedent]
</p>
</li>
<li><p> Thomas Mailund [bibliographic antecedent]
</p>
</li>
<li><p> Christian N. S. Pedersen <a href="mailto:cstorm@birc.au.dk">cstorm@birc.au.dk</a> [bibliographic antecedent]
</p>
</li>
<li><p> Jens Johansen [bibliographic antecedent]
</p>
</li>
<li><p> Morten K. Holt [bibliographic antecedent]
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Brodal G.S., Fagerberg R., Pedersen C.N.S. 2004. Computing the quartet
distance between evolutionary trees in time O(<em>n</em> log <em>n</em>).
Algorithmica. 38:377–395.
</p>
</li>
<li><p> Estabrook G.F., McMorris F.R., Meacham C.A. 1985. Comparison of undirected
phylogenetic trees based on subtrees of four evolutionary units.
Syst. Zool. 34:193–200.
</p>
</li>
<li><p> Sand A., Holt M.K., Johansen J., Brodal G.S., Mailund T., Pedersen C.N.S. 2014.
tqDist: a library for computing the quartet and triplet distances between
binary or general trees.
Bioinformatics. 30:2079–2080. https://doi.org/10.1093/bioinformatics/btu157
</p>
</li>
<li><p> Smith, M.R. 2019. Bayesian and parsimony approaches reconstruct
informative trees from simulated morphological datasets. Biol. Lett.
15:20180632. https://doi.org/10.1098/rsbl.2018.0632
</p>
</li>
<li><p> Smith, M.R. 2020. Information theoretic generalized Robinson–Foulds metrics
for comparing phylogenetic trees. Bioinformatics 36:5007–5013.
https://dx.doi.org/10.1093/bioinformatics/btaa614/5866976
</p>
</li>
<li><p> Smith, M.R. 2022. Robust analysis of phylogenetic tree space.
Syst. Biol. 71: 1255-1270.
https://dx.doi.org/10.1093/sysbio/syab100
</p>
</li>
<li><p> Steel, M. and Penny, D. 1993. Distributions of tree comparison metrics:
some new results. Syst. Biol. 42: 126-141.
https://doi.org/10.1093/sysbio/42.2.126
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://ms609.github.io/Quartet/">https://ms609.github.io/Quartet/</a>
</p>
</li>
<li> <p><a href="https://github.com/ms609/Quartet/">https://github.com/ms609/Quartet/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ms609/Quartet/issues/">https://github.com/ms609/Quartet/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='.AddSlice'>Add slice to 3D array</h2><span id='topic+.AddSlice'></span>

<h3>Description</h3>

<p>Add slice to 3D array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.AddSlice(arr, slice, sliceName = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".AddSlice_+3A_arr">arr</code></td>
<td>
<p>Three-dimensional array.</p>
</td></tr>
<tr><td><code id=".AddSlice_+3A_slice">slice</code></td>
<td>
<p>Two-dimensional matrix to add to array.</p>
</td></tr>
<tr><td><code id=".AddSlice_+3A_slicename">sliceName</code></td>
<td>
<p>Character vector specifying name for new slice.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A three-dimensional array formed by adding <code>slice</code> to the end of
<code>arr</code>.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>

<hr>
<h2 id='.CheckSize'>Check tree size</h2><span id='topic+.CheckSize'></span><span id='topic+.CheckSize.phylo'></span><span id='topic+.CheckSize.list'></span><span id='topic+.CheckSize.multiPhylo'></span>

<h3>Description</h3>

<p>Trees with &gt; 477 leaves may have counts &gt; .Machine$integer.max so cannot
be reliably evaluated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.CheckSize(tree)

## S3 method for class 'phylo'
.CheckSize(tree)

## S3 method for class 'list'
.CheckSize(tree)

## S3 method for class 'multiPhylo'
.CheckSize(tree)
</code></pre>


<h3>Details</h3>

<p>It may be possible to increase this number to 568 by converting what R
represents as negative integers to the unsigned equivalent that is sent
from C.
</p>

<hr>
<h2 id='.NormalizeStatus'>Normalize element statuses to generate metric</h2><span id='topic+.NormalizeStatus'></span>

<h3>Description</h3>

<p>Handles vectors and matrices of two or three dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.NormalizeStatus(elementStatus, numerator, denominator, takeFromOne)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".NormalizeStatus_+3A_elementstatus">elementStatus</code></td>
<td>
<p>Two-dimensional integer array, with rows corresponding to
counts of matching quartets or partitions for each tree, and columns named
according to the output of <code><a href="#topic+QuartetStatus">QuartetStatus()</a></code> or
<code><a href="#topic+SplitStatus">SplitStatus()</a></code>.</p>
</td></tr>
<tr><td><code id=".NormalizeStatus_+3A_numerator">numerator</code>, <code id=".NormalizeStatus_+3A_denominator">denominator</code></td>
<td>
<p>Character vector listing elements to sum in
numerator / denominator.</p>
</td></tr>
<tr><td><code id=".NormalizeStatus_+3A_takefromone">takeFromOne</code></td>
<td>
<p>Logical specifying whether to deduct value from one.</p>
</td></tr>
</table>

<hr>
<h2 id='.StatusToMatrix'>Status vector to matrix</h2><span id='topic+.StatusToMatrix'></span><span id='topic+.StatusToArray'></span>

<h3>Description</h3>

<p>Converts a vector to a matrix that can be analysed by the <code><a href="#topic+DoNotConflict">DoNotConflict()</a></code>
function family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.StatusToMatrix(statusVector)

.StatusToArray(status)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".StatusToMatrix_+3A_statusvector">statusVector</code></td>
<td>
<p>Either (i) a named vector of integers, with
names <code>N</code>, <code>s</code>, <code>r1</code>, <code>r2</code>, either <code>d</code> or <code>d1</code> and <code>d2</code>, and optionally <code>u</code>;
or (ii) a matrix whose named rows correspond to the same quantities.</p>
</td></tr>
<tr><td><code id=".StatusToMatrix_+3A_status">status</code></td>
<td>
<p>A named three-dimensional array of integers, with slices
named <code>s</code>, <code>r1</code>, <code>r2</code>, either <code>d</code> or <code>d1</code> and <code>d2</code>, and either <code>N</code> or <code>u</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix, containing the input columns plus <code style="white-space: pre;">&#8288;2d&#8288;</code>, representing
either <code>2 * d</code> or <code>d1 + d2</code>, and row names.
</p>
<p>The row name means that column names are dropped in
the output of <code>DoNotConflict</code> etc.
</p>
<p>A three-dimensional array containing a slice labelled <code style="white-space: pre;">&#8288;2d&#8288;</code>,
equivalent to either <code>d + d</code> or <code>d1 + d2</code> as appropriate.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sq_trees")

.StatusToArray(ManyToManyQuartetAgreement(sq_trees[5:7]))
</code></pre>

<hr>
<h2 id='AllQuartets'>List all quartets</h2><span id='topic+AllQuartets'></span><span id='topic+AllQuartets.numeric'></span><span id='topic+AllQuartets.phylo'></span>

<h3>Description</h3>

<p>Lists all choices of four taxa from a tree.
</p>
<p>A more computationally efficient alternative to <code><a href="utils.html#topic+combn">combn</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AllQuartets(nTips)

## S3 method for class 'numeric'
AllQuartets(nTips)

## S3 method for class 'phylo'
AllQuartets(nTips)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AllQuartets_+3A_ntips">nTips</code></td>
<td>
<p>Integer, specifying the number of tips in a tree; or a tree,
whose tips will be counted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>AllQuartets()</code> returns a matrix with four rows and
<code>choose(n_tips, 4)</code> columns, with each column corresponding to a unique
selection of four different integers less than or equal to <code>nTips</code>.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>States of quartets in given trees: <code><a href="#topic+QuartetStates">QuartetStates()</a></code>
</p>
<p>Other quartet counting functions: 
<code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti</a>()</code>,
<code><a href="#topic+CompareQuartets">CompareQuartets</a>()</code>,
<code><a href="#topic+ResolvedQuartets">ResolvedQuartets</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AllQuartets(5)
 
combn(5, 4) # Provides the same information, but for large 
            # values of n_tips is significantly slower.

</code></pre>

<hr>
<h2 id='CompareQuartets'>Compare quartet states by explicit enumeration</h2><span id='topic+CompareQuartets'></span>

<h3>Description</h3>

<p><code>CompareQuartets()</code> uses explicit enumeration to compare two lists of
quartet states, detailing how many are identical and how many are unresolved.
For most purposes, the faster function <code><a href="#topic+QuartetStatus">QuartetStatus()</a></code> will be preferable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CompareQuartets(x, cf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CompareQuartets_+3A_x">x</code>, <code id="CompareQuartets_+3A_cf">cf</code></td>
<td>
<p>List of quartet states, perhaps generated by <code><a href="#topic+QuartetStates">QuartetStates()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an array of seven numeric elements, corresponding
</p>

<dl>
<dt>N</dt><dd><p>The total number of quartet <em>statements</em> for two trees of <em>n</em> leaves,
i.e. 2 <em>Q</em>.</p>
</dd>
<dt>Q</dt><dd><p>The total number of quartets for <em>n</em> leaves.</p>
</dd>
<dt>s</dt><dd><p>The number of quartets that are resolved identically in both trees.</p>
</dd>
<dt>d</dt><dd><p>The number of quartets that are resolved differently in each tree.</p>
</dd>
<dt>r1</dt><dd><p>The number of quartets that are resolved in tree 1, but not in tree 2.</p>
</dd>
<dt>r2</dt><dd><p>The number of quartets that are resolved in tree 2, but not in tree 1.</p>
</dd>
<dt>u</dt><dd><p>The number of quartets that are unresolved in both trees.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Estabrook GF, McMorris FR, Meacham CA (1985).
&ldquo;Comparison of undirected phylogenetic trees based on subtrees of four evolutionary units.&rdquo;
<em>Systematic Zoology</em>, <b>34</b>(2), 193&ndash;200.
<a href="https://doi.org/10.2307/2413326">doi:10.2307/2413326</a>.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+QuartetStatus">QuartetStatus()</a></code> generates the same output from a list of trees.
</p>
</li></ul>

<p>Other element-by-element comparisons: 
<code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti</a>()</code>,
<code><a href="#topic+CompareSplits">CompareSplits</a>()</code>,
<code><a href="#topic+PairSharedQuartetStatus">PairSharedQuartetStatus</a>()</code>,
<code><a href="#topic+QuartetState">QuartetState</a>()</code>,
<code><a href="#topic+SharedQuartetStatus">SharedQuartetStatus</a>()</code>,
<code><a href="#topic+SplitStatus">SplitStatus</a>()</code>
</p>
<p>Other quartet counting functions: 
<code><a href="#topic+AllQuartets">AllQuartets</a>()</code>,
<code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti</a>()</code>,
<code><a href="#topic+ResolvedQuartets">ResolvedQuartets</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  trees &lt;- list(TreeTools::BalancedTree(6),
                TreeTools::PectinateTree(6))
  quartets &lt;- QuartetStates(trees)
  CompareQuartets(quartets[[1]], quartets[[2]])

</code></pre>

<hr>
<h2 id='CompareQuartetsMulti'>Compare one tree's quartets against others'</h2><span id='topic+CompareQuartetsMulti'></span>

<h3>Description</h3>

<p><code>CompareQuartetsMulti()</code> counts how many quartets in one tree are resolved
in the same way or different ways in a forest of comparison trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CompareQuartetsMulti(x, cf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CompareQuartetsMulti_+3A_x">x</code></td>
<td>
<p>Object of class <code>phylo</code> representing the tree of interest.</p>
</td></tr>
<tr><td><code id="CompareQuartetsMulti_+3A_cf">cf</code></td>
<td>
<p>Comparison tree of class <code>phylo</code>, or list thereof, each with the
same leaves as <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CompareQuartetsMulti()</code> explicitly evaluates each quartet in each tree.
As such its runtime will increase hyper-exponentially with the number of
leaves in trees being compared.  30 leaves will take around 5 seconds;
40 closer to 20 s, and 50 around a minute.
</p>


<h3>Value</h3>

<p><code>CompareQuartetsMulti()</code> returns a named integer vector specifying
the number of quartets whose resolution in <code>x</code> matches all or any of the
resolutions in <code>cf</code>.
</p>
<p>Named elements are:
</p>

<dl>
<dt>N</dt><dd><p>The total number of quartet <em>statements</em> for the given number of
<em>n</em>-leaf trees, i.e. <em>n_trees</em> × <em>Q</em>.</p>
</dd>
<dt>Q</dt><dd><p>The total number of quartets for <em>n</em> leaves.</p>
</dd>
<dt>s_all</dt><dd><p>The number of quartets that are resolved identically in all
trees.</p>
</dd>
<dt>s_any</dt><dd><p>The number of quartets that are resolved in <code>x</code>, and
identically in at least one of <code>cf</code>.</p>
</dd>
<dt>d_all</dt><dd><p>The number of quartets that are resolved in every tree in
<code>cf</code>, but never in the same way as they are resolved in in <code>x</code>.</p>
</dd>
<dt>d_any</dt><dd><p>The number of quartets in <code>x</code> that are resolved differently
(i.e. contradicted) in at least one tree in <code>cf</code>.</p>
</dd>
<dt>r1_all</dt><dd><p>The number of quartets that are resolved in <code>x</code>, but not in
any of <code>cf</code>.</p>
</dd>
<dt>r1_any</dt><dd><p>The number of quartets that are resolved in <code>x</code>, but
unresolved in at least one of <code>cf</code>.</p>
</dd>
<dt>r2_all</dt><dd><p>The number of quartets that are resolved in all of <code>cf</code>,
but not in <code>x</code>.</p>
</dd>
<dt>r2_any</dt><dd><p>The number of quartets that are resolved in at least one of <code>cf</code>,
but not in <code>x</code>.</p>
</dd>
<dt>u_all</dt><dd><p>The number of quartets that are unresolved in all trees.</p>
</dd>
<dt>u_any</dt><dd><p>The number of quartets that are unresolved in <code>x</code> and
at least one tree in <code>cf</code>.</p>
</dd>
<dt>x_only</dt><dd><p>The number of quartets in <code>x</code> that are not resolved the
same way in any of <code>cf</code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other element-by-element comparisons: 
<code><a href="#topic+CompareQuartets">CompareQuartets</a>()</code>,
<code><a href="#topic+CompareSplits">CompareSplits</a>()</code>,
<code><a href="#topic+PairSharedQuartetStatus">PairSharedQuartetStatus</a>()</code>,
<code><a href="#topic+QuartetState">QuartetState</a>()</code>,
<code><a href="#topic+SharedQuartetStatus">SharedQuartetStatus</a>()</code>,
<code><a href="#topic+SplitStatus">SplitStatus</a>()</code>
</p>
<p>Other quartet counting functions: 
<code><a href="#topic+AllQuartets">AllQuartets</a>()</code>,
<code><a href="#topic+CompareQuartets">CompareQuartets</a>()</code>,
<code><a href="#topic+ResolvedQuartets">ResolvedQuartets</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("TreeTools")
CompareQuartetsMulti(x  = CollapseNode(as.phylo(42, 6), 8:9),
                     cf = list(BalancedTree(6), PectinateTree(6), 
                               CollapseNode(as.phylo(1337, 6), 9:10)))

</code></pre>

<hr>
<h2 id='CompareSplits'>Compare status of splits</h2><span id='topic+CompareSplits'></span><span id='topic+CompareBipartitions'></span>

<h3>Description</h3>

<p>Reports whether splits are present or contradicted in a set of reference
splits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CompareSplits(splits, splits2)

CompareBipartitions(splits, splits2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CompareSplits_+3A_splits">splits</code></td>
<td>
<p>An object that can be coerced into class <code>Splits</code> using
<code><a href="TreeTools.html#topic+as.Splits">as.Splits</a></code>.</p>
</td></tr>
<tr><td><code id="CompareSplits_+3A_splits2">splits2</code></td>
<td>
<p>Splits against which to compare <code>splits</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector of eight integers, listing the number of unique splits
that:
</p>

<ul>
<li> <p><strong>N</strong>    exist in total; i.e. the number of splits in <code>splits1</code> plus the
number in <code>splits2</code>,
equivalent to 2 <em>s</em> + <em>d1</em> + <em>d2</em> + <em>r1</em> + <em>r2</em>;
</p>
</li>
<li> <p><strong>P1</strong>   occur in <code>splits1</code>
</p>
</li>
<li> <p><strong>P2</strong>   occur in <code>splits2</code>
</p>
</li>
<li> <p><strong>s</strong>    occur in both <code>splits1</code> and <code>splits2</code>;
</p>
</li>
<li> <p><strong>d1</strong>   occur in <code>splits1</code> but are contradicted by <code>splits2</code>;
</p>
</li>
<li> <p><strong>d2</strong>   occur in <code>splits2</code> but are contradicted by <code>splits1</code>;
</p>
</li>
<li> <p><strong>r1</strong>   occur in <code>splits1</code> only, being neither present in nor contradicted by <code>splits2</code>;
</p>
</li>
<li> <p><strong>r2</strong>   occur in <code>splits2</code> only, being neither present in nor contradicted by <code>splits1</code>;
</p>
</li>
<li> <p><strong>RF</strong>   occur in one tree only; i.e. <em>d1</em> + <em>d2</em> + <em>r1</em> + <em>r2</em>,
the Robinson-Foulds distance.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>


<ul>
<li> <p>Estabrook GF, McMorris FR, Meacham CA (1985).
&ldquo;Comparison of undirected phylogenetic trees based on subtrees of four evolutionary units.&rdquo;
<em>Systematic Zoology</em>, <b>34</b>(2), 193&ndash;200.
<a href="https://doi.org/10.2307/2413326">doi:10.2307/2413326</a>.
</p>
</li>
<li> <p>Robinson DF, Foulds LR (1981).
&ldquo;Comparison of phylogenetic trees.&rdquo;
<em>Mathematical Biosciences</em>, <b>53</b>(1-2), 131&ndash;147.
<a href="https://doi.org/10.1016/0025-5564%2881%2990043-2">doi:10.1016/0025-5564(81)90043-2</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p>Equivalent function for quartets: <code><a href="#topic+CompareQuartets">CompareQuartets()</a></code>
</p>
<p>Other element-by-element comparisons: 
<code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti</a>()</code>,
<code><a href="#topic+CompareQuartets">CompareQuartets</a>()</code>,
<code><a href="#topic+PairSharedQuartetStatus">PairSharedQuartetStatus</a>()</code>,
<code><a href="#topic+QuartetState">QuartetState</a>()</code>,
<code><a href="#topic+SharedQuartetStatus">SharedQuartetStatus</a>()</code>,
<code><a href="#topic+SplitStatus">SplitStatus</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>splits1 &lt;- TreeTools::BalancedTree(8)
splits2 &lt;- TreeTools::PectinateTree(8)

CompareSplits(splits1, splits2)
        
</code></pre>

<hr>
<h2 id='Distances'>Direct entry points to &quot;tqDist&quot; functions</h2><span id='topic+Distances'></span><span id='topic+QuartetDistance'></span><span id='topic+QuartetAgreement'></span><span id='topic+PairsQuartetDistance'></span><span id='topic+OneToManyQuartetAgreement'></span><span id='topic+AllPairsQuartetDistance'></span><span id='topic+AllPairsQuartetAgreement'></span><span id='topic+TripletDistance'></span><span id='topic+PairsTripletDistance'></span><span id='topic+AllPairsTripletDistance'></span>

<h3>Description</h3>

<p>Wrappers for functions in &quot;tqDist&quot;, which calculate triplet and quartet
distances between pairs of trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QuartetDistance(file1, file2)

QuartetAgreement(file1, file2)

PairsQuartetDistance(file1, file2)

OneToManyQuartetAgreement(file1, file2)

AllPairsQuartetDistance(file)

AllPairsQuartetAgreement(file)

TripletDistance(file1, file2)

PairsTripletDistance(file1, file2)

AllPairsTripletDistance(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Distances_+3A_file">file</code>, <code id="Distances_+3A_file1">file1</code>, <code id="Distances_+3A_file2">file2</code></td>
<td>
<p>Paths to files containing a tree or trees in Newick
format, possibly created using <code><a href="#topic+TQFile">TQFile()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>...Distance()</code> functions return the distance between the requested trees.
</p>
<p><code>...Agreement()</code> functions return the number of triplets or quartets that are:
</p>

<ul>
<li> <p><code>A</code>, resolved in the same fashion in both trees;
</p>
</li>
<li> <p><code>E</code>, unresolved in both trees.
</p>
</li></ul>

<p>Comparing a tree against itself yields the totals (<code>A+B+C</code>) and (<code>D+E</code>)
referred to by Brodal <em>et al</em>. (2013) and Holt <em>et al</em>. (2014).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>QuartetDistance()</code>: Returns the quartet distance between the tree.
in <code>file1</code> and the tree in <code>file2</code>.
</p>
</li>
<li> <p><code>QuartetAgreement()</code>: Returns a vector of length two, listing [1]
the number of resolved quartets that agree (<code>A</code>);
[2] the number of quartets that are unresolved in both trees (<code>E</code>).
See Brodal et al. (2013).
</p>
</li>
<li> <p><code>PairsQuartetDistance()</code>: Quartet distance between the tree on each line of <code>file1</code>
and the tree on the corresponding line of <code>file2</code>.
</p>
</li>
<li> <p><code>OneToManyQuartetAgreement()</code>: Quartet distance between the tree in
<code>file1</code> and the tree on each line of <code>file2</code>.
</p>
</li>
<li> <p><code>AllPairsQuartetDistance()</code>: Quartet distance between each tree listed in <code>file</code> and
each other tree therein.
</p>
</li>
<li> <p><code>AllPairsQuartetAgreement()</code>: Quartet status for each pair of trees in <code>file</code>.
</p>
</li>
<li> <p><code>TripletDistance()</code>: Triplet distance between the single tree given
in each file.
</p>
</li>
<li> <p><code>PairsTripletDistance()</code>: Triplet distance between the tree on each line of <code>file1</code>
and the tree on the corresponding line of <code>file2</code>.
</p>
</li>
<li> <p><code>AllPairsTripletDistance()</code>: Triplet distance between each tree listed in <code>file</code> and
each other tree therein.
</p>
</li></ul>


<h3>Author(s)</h3>


<ul>
<li><p> Algorithms: Brodal <em>et al.</em> (2013); Holt <em>et al.</em> (2014).
</p>
</li>
<li><p> C implementation: Sand <em>et al.</em> (2014);
modified for portability by Martin R. Smith.
</p>
</li>
<li><p> R interface: Martin R. Smith.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li> <p>Brodal GS, Fagerberg R, Mailund T, Pedersen CNS, Sand A (2013).
&ldquo;Efficient algorithms for computing the triplet and quartet distance between trees of arbitrary degree.&rdquo;
<em>SODA '13 Proceedings of the Twenty-Fourth Annual ACM-SIAM Symposium on Discrete Algorithms</em>, 1814&ndash;1832.
<a href="https://doi.org/10.1137/1.9781611973105.130">doi:10.1137/1.9781611973105.130</a>.
</p>
</li>
<li> <p>Holt MK, Johansen J, Brodal GS (2014).
&ldquo;On the scalability of computing triplet and quartet distances.&rdquo;
In <em>Proceedings of 16th Workshop on Algorithm Engineering and Experiments (ALENEX) Portland, Oregon, USA</em>.
</p>
</li>
<li> <p>Sand A, Holt MK, Johansen J, Brodal GS, Mailund T, Pedersen CNS (2014).
&ldquo;tqDist: a library for computing the quartet and triplet distances between binary or general trees.&rdquo;
<em>Bioinformatics</em>, <b>30</b>(14), 2079&ndash;2080.
ISSN 1460-2059, <a href="https://doi.org/10.1093/bioinformatics/btu157">doi:10.1093/bioinformatics/btu157</a>.
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+QuartetStatus">QuartetStatus()</a></code> takes trees, rather than files, as input.
</p>
</li>
<li> <p><code><a href="#topic+TQFile">TQFile()</a></code> creates a temporary file containing specified trees.
</p>
</li></ul>


<hr>
<h2 id='PairSharedQuartetStatus'>Status of quartets that exist in two trees</h2><span id='topic+PairSharedQuartetStatus'></span>

<h3>Description</h3>

<p>Removes all tips that do not occur in both <code>tree1</code> and <code>tree2</code>, then calculates
the status of the remaining quartets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PairSharedQuartetStatus(tree1, tree2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PairSharedQuartetStatus_+3A_tree1">tree1</code>, <code id="PairSharedQuartetStatus_+3A_tree2">tree2</code></td>
<td>
<p>Trees of class <code><a href="ape.html#topic+read.tree">phylo</a></code>
to compare.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a named array of six integers corresponding to the quantities of Estabrook <em>et al</em>. (1985):
</p>

<dl>
<dt>N</dt><dd><p>The total number of quartet <em>statements</em> for two trees of <em>n</em> leaves,
i.e. 2 <em>Q</em>.</p>
</dd>
<dt>Q</dt><dd><p>The total number of quartets for <em>n</em> leaves.</p>
</dd>
<dt>s</dt><dd><p>The number of quartets that are resolved identically in both trees.</p>
</dd>
<dt>d</dt><dd><p>The number of quartets that are resolved differently in each tree.</p>
</dd>
<dt>r1</dt><dd><p>The number of quartets that are resolved in tree 1, but not in tree 2.</p>
</dd>
<dt>r2</dt><dd><p>The number of quartets that are resolved in tree 2, but not in tree 1.</p>
</dd>
<dt>u</dt><dd><p>The number of quartets that are unresolved in both trees.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other element-by-element comparisons: 
<code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti</a>()</code>,
<code><a href="#topic+CompareQuartets">CompareQuartets</a>()</code>,
<code><a href="#topic+CompareSplits">CompareSplits</a>()</code>,
<code><a href="#topic+QuartetState">QuartetState</a>()</code>,
<code><a href="#topic+SharedQuartetStatus">SharedQuartetStatus</a>()</code>,
<code><a href="#topic+SplitStatus">SplitStatus</a>()</code>
</p>

<hr>
<h2 id='PairSharedSplitStatus'>Pair shared split status</h2><span id='topic+PairSharedSplitStatus'></span>

<h3>Description</h3>

<p>Removes all tips that do not occur in both <code>ref</code> and <code>cf</code>, then calculates
the status of the remaining splits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PairSharedSplitStatus(ref, cf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PairSharedSplitStatus_+3A_ref">ref</code>, <code id="PairSharedSplitStatus_+3A_cf">cf</code></td>
<td>
<p>Trees of class <code><a href="ape.html#topic+read.tree">phylo</a></code> to compare.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named integer of length 6, as per <code><a href="#topic+CompareSplits">CompareSplits()</a></code>
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("TreeTools")
ref &lt;- BalancedTree(letters[1:9])
cf &lt;- BalancedTree(letters[3:13])

PairSharedSplitStatus(ref, cf)

</code></pre>

<hr>
<h2 id='PlotQuartet'>Plot quartet on tree topologies</h2><span id='topic+PlotQuartet'></span>

<h3>Description</h3>

<p>Draws a tree, highlighting the members of a specified quartet in colour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotQuartet(tree, quartet, overwritePar = TRUE, caption = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotQuartet_+3A_tree">tree</code></td>
<td>
<p>A tree of class <code><a href="ape.html#topic+read.tree">phylo</a></code>,
or a list of such trees.  The first member of <code>tree</code> will be considered
the &quot;reference&quot; tree.</p>
</td></tr>
<tr><td><code id="PlotQuartet_+3A_quartet">quartet</code></td>
<td>
<p>A vector of four integers, corresponding to numbered leaves on
the tree; or a character vector specifying the labels of four leaves.</p>
</td></tr>
<tr><td><code id="PlotQuartet_+3A_overwritepar">overwritePar</code></td>
<td>
<p>Logical specifying whether to use existing <code>mfrow</code> and
<code>mar</code> parameters from <code><a href="graphics.html#topic+par">par</a>()</code> (<code>FALSE</code>),
or to plot trees side-by-side in a new graphical device (<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="PlotQuartet_+3A_caption">caption</code></td>
<td>
<p>Logical specifying whether to annotate each plot to specify
whether the quartet selected is in the same or a different state to the
reference tree.</p>
</td></tr>
<tr><td><code id="PlotQuartet_+3A_...">...</code></td>
<td>
<p>Additional parameters to send to
<code><a href="ape.html#topic+plot.phylo">plot</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>PlotQuartet()</code> returns <code>invisible()</code>, having plotted a tree in
which the first two members of <code>quartet</code> are highlighted in orange, and the
second two highlighted in blue.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sq_trees")

oPar &lt;- par(mfrow = c(3, 6), mar = rep(0.5, 4))
PlotQuartet(sq_trees, c(2, 5, 3, 8), overwritePar = FALSE)
par(oPar)

</code></pre>

<hr>
<h2 id='QuartetPoints'>Plot tree differences on ternary plots</h2><span id='topic+QuartetPoints'></span><span id='topic+SplitPoints'></span><span id='topic+BipartitionPoints'></span>

<h3>Description</h3>

<p>Generate points to depict tree difference (in terms of resolution
and accuracy) on a ternary plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QuartetPoints(trees, cf = trees[[1]])

SplitPoints(trees, cf = trees[[1]])

BipartitionPoints(trees, cf = trees[[1]])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QuartetPoints_+3A_trees">trees</code></td>
<td>
<p>A list of trees of class <code><a href="ape.html#topic+read.tree">phylo</a></code>,
with identically labelled tips.</p>
</td></tr>
<tr><td><code id="QuartetPoints_+3A_cf">cf</code></td>
<td>
<p>Comparison tree of class <code><a href="ape.html#topic+read.tree">phylo</a></code>.  If unspecified,
each tree is compared to the first tree in <code>trees</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ternary plot will depict the number of quartets or splits that are:
</p>

<ul>
<li><p> resolved in the reference tree (<code>cf</code>), but neither present nor contradicted
in each comparison tree (<code>trees</code>);
</p>
</li>
<li><p> resolved differently in the reference and the comparison tree;
</p>
</li>
<li><p> resolved in the same manner in the reference and comparison trees.
</p>
</li></ul>

<p>If the reference tree (<code>cf</code>) is taken to represent the best possible knowledge
of the &quot;true&quot; topology, then polytomies in the reference tree represent
uncertainty.  If a tree in <code>trees</code> resolves relationships within this
polytomy, it is not possible to establish (based only on the reference tree)
whether this resolution is correct or erroneous.  As such, extra resolution
in <code>trees</code> that is neither corroborated nor contradicted by <code>cf</code> is ignored.
</p>


<h3>Value</h3>

<p>A data frame listing the ternary coordinates of trees, based on the
amount of information that they have in common with the comparison
tree (which defaults to the first member of the list, if unspecified).
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>


<ul>
<li> <p>Smith MR (2019).
&ldquo;Bayesian and parsimony approaches reconstruct informative trees from simulated morphological datasets.&rdquo;
<em>Biology Letters</em>, <b>15</b>(2), 20180632.
<a href="https://doi.org/10.1098/rsbl.2018.0632">doi:10.1098/rsbl.2018.0632</a>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library("Ternary")
data("sq_trees")

TernaryPlot(alab = "Unresolved", blab = "Contradicted", clab = "Consistent",
            point = "right")
TernaryLines(list(c(0, 2/3, 1/3), c(1, 0, 0)), col = "red", lty = "dotted")
TernaryText(QuartetPoints(sq_trees, cf = sq_trees$collapse_one), 1:15, 
            col = Ternary::cbPalette8[2], cex = 0.8)
TernaryText(SplitPoints(sq_trees, cf = sq_trees$collapse_one), 1:15, 
            col = Ternary::cbPalette8[3], cex = 0.8)
legend("bottomright", c("Quartets", "Splits"), bty = "n", pch = 1, cex = 0.8,
       col = Ternary::cbPalette8[2:3])

</code></pre>

<hr>
<h2 id='QuartetState'>Quartet State(s)</h2><span id='topic+QuartetState'></span><span id='topic+QuartetStates'></span><span id='topic+QuartetStates.Splits'></span><span id='topic+QuartetStates.list'></span><span id='topic+QuartetStates.multiPhylo'></span>

<h3>Description</h3>

<p>Report the status of the specified quartet(s) in given trees or lists of
splits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QuartetState(tips, bips, splits = bips, asRaw = FALSE)

QuartetStates(splits, asRaw = FALSE)

## S3 method for class 'Splits'
QuartetStates(splits, asRaw = FALSE)

## S3 method for class 'list'
QuartetStates(splits, asRaw = FALSE)

## S3 method for class 'multiPhylo'
QuartetStates(splits, asRaw = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QuartetState_+3A_tips">tips</code></td>
<td>
<p>A four-element array listing a quartet of leaves, either by their
number (if class <code>numeric</code>) or their name (if class <code>character</code>).</p>
</td></tr>
<tr><td><code id="QuartetState_+3A_bips">bips</code></td>
<td>
<p>Deprecated; included for compatibility with v1.0.2 and below.</p>
</td></tr>
<tr><td><code id="QuartetState_+3A_splits">splits</code></td>
<td>
<p>An object, such as a tree of class <code>phylo</code>, that can be
induced to a <code>Splits</code> object using <code><a href="TreeTools.html#topic+as.Splits">as.Splits</a></code>.</p>
</td></tr>
<tr><td><code id="QuartetState_+3A_asraw">asRaw</code></td>
<td>
<p>Logical specifying whether return format should be <code>raw</code>,
which uses less memory and can be processed faster than <code>integer</code> type.
Default is currently set to <code>FALSE</code> for backwards compatibility; suggest
overriding to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>One of the three possible four-leaf trees will be consistent with any set of
splits generated from a fully resolved tree.  If the leaves are numbered
1 to 4, this tree can be identified by naming the leaf most closely related
to leaf 4.
If a set of splits is generated from a tree that contains polytomies,
it is possible that all three four-leaf trees are consistent with the set
of splits.
</p>


<h3>Value</h3>

<p><code>QuartetState()</code> returns <code>0</code> if the relationships of the four leaves
are not constrained by the provided splits, or the index of the closest
relative to <code>tips[4]</code>, otherwise.
</p>
<p><code>QuartetStates()</code> returns a raw vector listing the status of each
quartet of leaves (in the order listed by <code><a href="#topic+AllQuartets">AllQuartets()</a></code>) in turn,
or if multiple trees are provided, a matrix in which each row corresponds
to such a vector.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>


<ul>
<li> <p>Estabrook GF, McMorris FR, Meacham CA (1985).
&ldquo;Comparison of undirected phylogenetic trees based on subtrees of four evolutionary units.&rdquo;
<em>Systematic Zoology</em>, <b>34</b>(2), 193&ndash;200.
<a href="https://doi.org/10.2307/2413326">doi:10.2307/2413326</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p>Compare quartet states between trees (slowly) using
<code><a href="#topic+CompareQuartets">CompareQuartets()</a></code> and <code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti()</a></code>.
</p>
<p>Other element-by-element comparisons: 
<code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti</a>()</code>,
<code><a href="#topic+CompareQuartets">CompareQuartets</a>()</code>,
<code><a href="#topic+CompareSplits">CompareSplits</a>()</code>,
<code><a href="#topic+PairSharedQuartetStatus">PairSharedQuartetStatus</a>()</code>,
<code><a href="#topic+SharedQuartetStatus">SharedQuartetStatus</a>()</code>,
<code><a href="#topic+SplitStatus">SplitStatus</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>trees &lt;- list(TreeTools::BalancedTree(6),
              TreeTools::PectinateTree(6))

trees[[3]] &lt;- TreeTools::CollapseNode(trees[[2]], 9:10)

QuartetState(c(1, 3, 4, 6), trees[[2]])  
QuartetState(1:4, trees[[1]]) == QuartetState(1:4, trees[[2]])
QuartetState(c(1, 3, 4, 6), trees[[3]])  

QuartetStates(trees[[2]])
QuartetStates(trees[[3]])

CompareQuartets(QuartetStates(trees[[2]]), QuartetStates(trees[[3]]))
CompareQuartetsMulti(trees[[1]], trees[2:3])

</code></pre>

<hr>
<h2 id='ResolvedQuartets'>Count resolved quartets</h2><span id='topic+ResolvedQuartets'></span><span id='topic+ResolvedTriplets'></span>

<h3>Description</h3>

<p>Counts how many quartets are resolved or unresolved in a given tree,
following Brodal <em>et al.</em> (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ResolvedQuartets(tree, countTriplets = FALSE)

ResolvedTriplets(tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ResolvedQuartets_+3A_tree">tree</code></td>
<td>
<p>A tree of class <code><a href="ape.html#topic+read.tree">phylo</a></code>.</p>
</td></tr>
<tr><td><code id="ResolvedQuartets_+3A_counttriplets">countTriplets</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the function will return the number
of triplets instead of the number of quartets.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Trees with more than 477 leaves risk encountering integer overflow errors,
as the number of quartets is larger than can be stored in R's signed
32-bit integer representation.  If warnings are thrown, check subsequent
calculations for errors.
</p>


<h3>Value</h3>

<p><code>ResolvedQuartets()</code> returns a vector of length two, listing the
number of quartets (or triplets)
that are [1] resolved; [2] unresolved in the specified tree.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>ResolvedTriplets()</code>: Convenience function to calculate the number of
resolved/unresolved triplets.
</p>
</li></ul>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>


<ul>
<li> <p>Brodal GS, Fagerberg R, Mailund T, Pedersen CNS, Sand A (2013).
&ldquo;Efficient algorithms for computing the triplet and quartet distance between trees of arbitrary degree.&rdquo;
<em>SODA '13 Proceedings of the Twenty-Fourth Annual ACM-SIAM Symposium on Discrete Algorithms</em>, 1814&ndash;1832.
<a href="https://doi.org/10.1137/1.9781611973105.130">doi:10.1137/1.9781611973105.130</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other quartet counting functions: 
<code><a href="#topic+AllQuartets">AllQuartets</a>()</code>,
<code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti</a>()</code>,
<code><a href="#topic+CompareQuartets">CompareQuartets</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sq_trees)

ResolvedTriplets(sq_trees$collapse_some)
# Equivalent to:
ResolvedQuartets(sq_trees$collapse_some, countTriplets = TRUE)

vapply(sq_trees, ResolvedQuartets, integer(2))


</code></pre>

<hr>
<h2 id='SharedQuartetStatus'>Status of quartets</h2><span id='topic+SharedQuartetStatus'></span><span id='topic+QuartetStatus'></span><span id='topic+ManyToManyQuartetAgreement'></span><span id='topic+TwoListQuartetAgreement'></span><span id='topic+SingleTreeQuartetAgreement'></span>

<h3>Description</h3>

<p>Determines the number of quartets that are consistent within pairs of trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SharedQuartetStatus(trees, cf = trees[[1]])

QuartetStatus(trees, cf = trees[[1]], nTip = NULL)

ManyToManyQuartetAgreement(trees, nTip = NULL)

TwoListQuartetAgreement(trees1, trees2)

SingleTreeQuartetAgreement(trees, comparison)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SharedQuartetStatus_+3A_trees">trees</code></td>
<td>
<p>A list of trees of class <code><a href="ape.html#topic+read.tree">phylo</a></code>,
with identically labelled tips.</p>
</td></tr>
<tr><td><code id="SharedQuartetStatus_+3A_cf">cf</code></td>
<td>
<p>Comparison tree of class <code><a href="ape.html#topic+read.tree">phylo</a></code>.  If unspecified,
each tree is compared to the first tree in <code>trees</code>.</p>
</td></tr>
<tr><td><code id="SharedQuartetStatus_+3A_ntip">nTip</code></td>
<td>
<p>Integer specifying number of tips that could have occurred
in <code>trees</code>.  Useful if comparing trees from different data sources that
contain non-overlapping tips.
If <code>NULL</code>, the default, then trees are assumed to contain the same tips.
If <code>TRUE</code>, then a vector is generated automatically by counting all unique
tip labels found in <code>trees</code> or <code>cf</code>.</p>
</td></tr>
<tr><td><code id="SharedQuartetStatus_+3A_trees1">trees1</code>, <code id="SharedQuartetStatus_+3A_trees2">trees2</code></td>
<td>
<p>List or <code>multiPhylo</code> objects containing
trees of class <code>phylo</code>.</p>
</td></tr>
<tr><td><code id="SharedQuartetStatus_+3A_comparison">comparison</code></td>
<td>
<p>A tree of class <code><a href="ape.html#topic+read.tree">phylo</a></code> against
which to compare <code>trees</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a list of trees, returns the number of quartet statements present in the
reference tree (the first entry in <code>trees</code>, if <code>cf</code> is not specified)
that are also present in each other tree.  A random pair of fully resolved
trees is expected to share <code>choose(n_tip, 4) / 3</code> quartets.
</p>
<p>If trees do not bear the same number of tips, <code>SharedQuartetStatus()</code> will
consider only the quartets that include taxa common to both trees.
</p>
<p>From this information it is possible to calculate how many of all possible
quartets occur in one tree or the other, though there is not yet a function
calculating this; <a href="https://github.com/ms609/Quartet/issues/new">let us know</a>
if you would appreciate this functionality.
</p>
<p>The status of each quartet is calculated using the algorithms of
Brodal <em>et al</em>. (2013) and Holt <em>et al</em>. (2014), implemented in the
tqdist C library (Sand <em>et al</em>. 2014).
</p>


<h3>Value</h3>

<p><code>QuartetStatus()</code> returns a two dimensional array. Rows correspond to the input trees; the first row will report a perfect match if the first tree is specified as the comparison tree (or if <code>cf</code> is not specified).  Columns list the status of each quartet:
</p>

<dl>
<dt>N</dt><dd><p>The total number of quartet <em>statements</em> for two trees of <em>n</em> leaves,
i.e. 2 <em>Q</em>.</p>
</dd>
<dt>Q</dt><dd><p>The total number of quartets for <em>n</em> leaves.</p>
</dd>
<dt>s</dt><dd><p>The number of quartets that are resolved identically in both trees.</p>
</dd>
<dt>d</dt><dd><p>The number of quartets that are resolved differently in each tree.</p>
</dd>
<dt>r1</dt><dd><p>The number of quartets that are resolved in tree 1, but not in tree 2.</p>
</dd>
<dt>r2</dt><dd><p>The number of quartets that are resolved in tree 2, but not in tree 1.</p>
</dd>
<dt>u</dt><dd><p>The number of quartets that are unresolved in both trees.</p>
</dd>
</dl>

<p><code>ManyToManyQuartetAgreement()</code> returns a three-dimensional array
listing, for each pair of trees in turn, the number of quartets in each
category.
</p>
<p><code>TwoListQuartetAgreement()</code> returns a three-dimensional array listing,
for each pair of trees in turn, the number of quartets in each category.
</p>
<p><code>SingleTreeQuartetAgreement()</code> returns a two-dimensional array listing,
for tree in <code>trees</code>, the total number of quartets and the
number of quartets in each category.
The <code>comparison</code> tree is treated as <code>tree2</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>SharedQuartetStatus()</code>: Reports split statistics obtained after removing all
tips that do not occur in both trees being compared.
</p>
</li>
<li> <p><code>ManyToManyQuartetAgreement()</code>: Agreement of each quartet, comparing each pair of
trees in a list.
</p>
</li>
<li> <p><code>TwoListQuartetAgreement()</code>: Agreement of each quartet in trees in one list with
each quartet in trees in a second list.
</p>
</li>
<li> <p><code>SingleTreeQuartetAgreement()</code>: Agreement of each quartet in trees in a list with
the quartets in a comparison tree.
</p>
</li></ul>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>


<ul>
<li> <p>Brodal GS, Fagerberg R, Mailund T, Pedersen CNS, Sand A (2013).
&ldquo;Efficient algorithms for computing the triplet and quartet distance between trees of arbitrary degree.&rdquo;
<em>SODA '13 Proceedings of the Twenty-Fourth Annual ACM-SIAM Symposium on Discrete Algorithms</em>, 1814&ndash;1832.
<a href="https://doi.org/10.1137/1.9781611973105.130">doi:10.1137/1.9781611973105.130</a>.
</p>
</li>
<li> <p>Estabrook GF, McMorris FR, Meacham CA (1985).
&ldquo;Comparison of undirected phylogenetic trees based on subtrees of four evolutionary units.&rdquo;
<em>Systematic Zoology</em>, <b>34</b>(2), 193&ndash;200.
<a href="https://doi.org/10.2307/2413326">doi:10.2307/2413326</a>.
</p>
</li>
<li> <p>Holt MK, Johansen J, Brodal GS (2014).
&ldquo;On the scalability of computing triplet and quartet distances.&rdquo;
In <em>Proceedings of 16th Workshop on Algorithm Engineering and Experiments (ALENEX) Portland, Oregon, USA</em>.
</p>
</li>
<li> <p>Sand A, Holt MK, Johansen J, Brodal GS, Mailund T, Pedersen CNS (2014).
&ldquo;tqDist: a library for computing the quartet and triplet distances between binary or general trees.&rdquo;
<em>Bioinformatics</em>, <b>30</b>(14), 2079&ndash;2080.
ISSN 1460-2059, <a href="https://doi.org/10.1093/bioinformatics/btu157">doi:10.1093/bioinformatics/btu157</a>.
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li><p> Use splits (groups/clades defined by nodes or edges of the tree) instead
of quartets as the unit of comparison: <code><a href="#topic+SplitStatus">SplitStatus()</a></code>.
</p>
</li>
<li><p> Generate distance metrics from quartet statuses: <code><a href="#topic+SimilarityMetrics">SimilarityMetrics()</a></code>.
</p>
</li></ul>

<p>Other element-by-element comparisons: 
<code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti</a>()</code>,
<code><a href="#topic+CompareQuartets">CompareQuartets</a>()</code>,
<code><a href="#topic+CompareSplits">CompareSplits</a>()</code>,
<code><a href="#topic+PairSharedQuartetStatus">PairSharedQuartetStatus</a>()</code>,
<code><a href="#topic+QuartetState">QuartetState</a>()</code>,
<code><a href="#topic+SplitStatus">SplitStatus</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sq_trees")
# Calculate the status of each quartet relative to the first entry in 
# sq_trees
sq_status &lt;- QuartetStatus(sq_trees)

# Calculate the status of each quartet relative to a given tree
two_moved &lt;- sq_trees[5:7]
sq_status &lt;- QuartetStatus(two_moved, sq_trees$ref_tree)

# Calculate Estabrook et al's similarity measures:
SimilarityMetrics(sq_status)

# Compare trees that include a subset of the taxa 1..10
library("TreeTools", quietly = TRUE, warn.conflict = FALSE)
QuartetStatus(BalancedTree(1:5), BalancedTree(3:8), nTip = 10)

# If all taxa studied occur in `trees` or `cf`, set `nTip = TRUE`
QuartetStatus(BalancedTree(1:5), BalancedTree(3:10), nTip = TRUE)
 
# Calculate Quartet Divergence between each tree and each other tree in a 
# list
QuartetDivergence(ManyToManyQuartetAgreement(two_moved))
# Calculate Quartet Divergence between each tree in one list and each 
# tree in another
QuartetDivergence(TwoListQuartetAgreement(sq_trees[1:3], sq_trees[10:13]))
</code></pre>

<hr>
<h2 id='SimilarityMetrics'>Tree similarity measures</h2><span id='topic+SimilarityMetrics'></span><span id='topic+DoNotConflict'></span><span id='topic+ExplicitlyAgree'></span><span id='topic+StrictJointAssertions'></span><span id='topic+SemiStrictJointAssertions'></span><span id='topic+SymmetricDifference'></span><span id='topic+RawSymmetricDifference'></span><span id='topic+RobinsonFoulds'></span><span id='topic+MarczewskiSteinhaus'></span><span id='topic+SteelPenny'></span><span id='topic+QuartetDivergence'></span><span id='topic+SimilarityToReference'></span>

<h3>Description</h3>

<p>Measure tree similarity or difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimilarityMetrics(elementStatus, similarity = TRUE)

DoNotConflict(elementStatus, similarity = TRUE)

ExplicitlyAgree(elementStatus, similarity = TRUE)

StrictJointAssertions(elementStatus, similarity = TRUE)

SemiStrictJointAssertions(elementStatus, similarity = TRUE)

SymmetricDifference(elementStatus, similarity = TRUE)

RawSymmetricDifference(elementStatus, similarity = FALSE)

RobinsonFoulds(elementStatus, similarity = FALSE)

MarczewskiSteinhaus(elementStatus, similarity = TRUE)

SteelPenny(elementStatus, similarity = TRUE)

QuartetDivergence(elementStatus, similarity = TRUE)

SimilarityToReference(elementStatus, similarity = TRUE, normalize = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimilarityMetrics_+3A_elementstatus">elementStatus</code></td>
<td>
<p>Two-dimensional integer array, with rows corresponding to
counts of matching quartets or partitions for each tree, and columns named
according to the output of <code><a href="#topic+QuartetStatus">QuartetStatus()</a></code> or
<code><a href="#topic+SplitStatus">SplitStatus()</a></code>.</p>
</td></tr>
<tr><td><code id="SimilarityMetrics_+3A_similarity">similarity</code></td>
<td>
<p>Logical specifying whether to calculate the similarity
or dissimilarity.</p>
</td></tr>
<tr><td><code id="SimilarityMetrics_+3A_normalize">normalize</code></td>
<td>
<p>Logical; if <code>TRUE</code>, a random or star tree has expected
similarity 0 (or difference 1), and the maximum possible score is one.
If <code>FALSE</code>, zero similarity corresponds to all quartets contradicted,
whereas one corresponds to all quartets correctly resolved &ndash; which will be
unattainable if the reference tree contains polytomies.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estabrook et al. (1985) (table 2) define four similarity
metrics in terms  of the total number of quartets (<em>N</em>, their <em>Q</em>),
the number of quartets resolved in the same manner in two trees (<em>s</em>),
the number resolved differently in both trees (<em>d</em>),
the number resolved in tree 1 or 2 but unresolved in the other tree
(<em>r1</em>, <em>r2</em>), and the number that are unresolved in both trees (<em>u</em>).
</p>
<p>The similarity metrics are then given as below.  The dissimilarity metrics
are their complement (i.e. 1 - <em>similarity</em>), and can be calculated
algebraically using the identity <em>N</em> = <em>s</em> + <em>d</em> + <em>r1</em> + <em>r2</em> + <em>u</em>.
</p>
<p>Although defined using quartets, analogous values can be calculated using
partitions &ndash; though for a number of reasons, quartets may offer a more
meaningful measure of the amount of information shared by two trees
(Smith 2020).
</p>

<ul>
<li><p> Do Not Conflict (DC): (<em>s</em> + <em>r1</em> + <em>r2</em> + <em>u</em>) / <em>N</em>
</p>
</li>
<li><p> Explicitly Agree (EA): <em>s</em> / <em>N</em>
</p>
</li>
<li><p> Strict Joint Assertions (SJA): <em>s</em> / (<em>s</em> + <em>d</em>)
</p>
</li>
<li><p> SemiStrict Joint Assertions (SSJA): <em>s</em> / (<em>s</em> + <em>d</em> + <em>u</em>)
</p>
</li></ul>

<p>(The numerator of the SemiStrict Joint Assertions similarity metric is
given in Estabrook et al. (1985) table 2 as <em>s</em> + <em>d</em>,
but this is understood, with reference to their text, to be a typographic
error.)
</p>
<p>Steel and Penny (1993) propose a further metric,
which they denote d_Q_,
which this package calculates using the function <code>SteelPenny()</code>:
</p>

<ul>
<li><p> Steel &amp; Penny's quartet metric (dQ): (<em>s</em> + <em>u</em>) / <em>N</em>
</p>
</li></ul>

<p>Another take on tree similarity is to consider the symmetric difference:
that is, the number of partitions or quartets present in one tree that do
not appear in the other, originally used to measure tree similarity by
Robinson and Foulds (1981).
(Note that, given the familiarity of the Robinson–Foulds distance metric,
this quantity is be default expressed as a difference rather than a
similarity.)
</p>

<ul>
<li><p> Raw symmetric difference (RF): <em>d1</em> + <em>d2</em> + <em>r1</em> + <em>r2</em>
</p>
</li></ul>

<p>A pair of trees will have a high symmetric difference if they are
well-resolved but disagree on many relationships; or if they agree on
most relationships but are poorly resolved.
As such, it is essential to contextualize the symmetric difference by
appropriate normalization (Smith 2019).
Multiple approaches to normalization have been proposed:
</p>
<p>The total number of resolved quartets or partitions present in both trees
(Day 1986):
</p>

<ul>
<li><p> Symmetric Difference (SD): (2 <em>d</em> + <em>r1</em> + <em>r2</em>) / (2 <em>d</em> + 2 <em>s</em> + <em>r1</em> + <em>r2</em>)
</p>
</li></ul>

<p>The total distinctly resolved quartets or partitions
(Marczewski and Steinhaus 1958; Day 1986):
</p>

<ul>
<li><p> Marczewski-Steinhaus (MS): (2 <em>d</em> + <em>r1</em> + <em>r2</em>) / (2 <em>d</em> + <em>s</em> + <em>r1</em> + <em>r2</em>)
</p>
</li></ul>

<p>The maximum number of quartets or partitions that could have been resolved,
given the number of tips (Smith 2019):
</p>

<ul>
<li><p> Symmetric Divergence: (<em>d</em> + <em>d</em> + <em>r1</em> + <em>r2</em>) / <em>N</em>
</p>
</li></ul>

<p>Finally, in cases where a reconstructed tree <code>r1</code> is being compared to a
reference tree <code>r2</code> taken to represent &quot;true&quot; relationships,
a symmetric difference is not desired.
In such settings, the desired score is the expectation that a given
quartet's resolution in the reconstructed tree is &quot;correct&quot;, given by
Asher and Smith (2022):
</p>

<ul>
<li><p> Similarity to Reference (S2R): (<em>s</em> + (<em>r1</em> + <em>r2</em> + <em>u</em>) / 3) / <em>Q</em>
</p>
</li></ul>

<p>This may optionally be normalized with reference to the maximum possible
similarity, (<em>s</em> + <em>d</em> + <em>r2</em> + (<em>r1</em> + <em>u</em>) / 3) / <em>Q</em>, subtracting
1/3 (the probability of matching at random) from both the S2R score and
maximum possible score before dividing; then, a tree scores zero if it
is as different from the true tree as a random or fully unresolved tree,
and one if it is as &quot;true&quot; as can be known.
</p>


<h3>Value</h3>

<p><code>SimilarityMetrics()</code> returns a named two-dimensional array in which each row
corresponds to an input tree, and each column corresponds to one of the
listed measures.
</p>
<p><code>DoNotConflict()</code> and others return a named vector describing the requested
similarity (or difference) between the trees.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Asher R, Smith MR (2022).
&ldquo;Phylogenetic signal and bias in paleontology.&rdquo;
<em>Systematic Biology</em>, <b>71</b>(4), 986&ndash;1008.
<a href="https://doi.org/10.1093/sysbio/syab072">doi:10.1093/sysbio/syab072</a>.<br /><br /> Day WH (1986).
&ldquo;Analysis of quartet dissimilarity measures between undirected phylogenetic trees.&rdquo;
<em>Systematic Biology</em>, <b>35</b>(3), 325&ndash;333.
<a href="https://doi.org/10.1093/sysbio/35.3.325">doi:10.1093/sysbio/35.3.325</a>.<br /><br /> Estabrook GF, McMorris FR, Meacham CA (1985).
&ldquo;Comparison of undirected phylogenetic trees based on subtrees of four evolutionary units.&rdquo;
<em>Systematic Zoology</em>, <b>34</b>(2), 193&ndash;200.
<a href="https://doi.org/10.2307/2413326">doi:10.2307/2413326</a>.<br /><br /> Marczewski E, Steinhaus H (1958).
&ldquo;On a certain distance of sets and the corresponding distance of functions.&rdquo;
<em>Colloquium Mathematicae</em>, <b>6</b>(1), 319&ndash;327.
<a href="https://eudml.org/doc/210378">https://eudml.org/doc/210378</a>.<br /><br /> Robinson DF, Foulds LR (1981).
&ldquo;Comparison of phylogenetic trees.&rdquo;
<em>Mathematical Biosciences</em>, <b>53</b>(1-2), 131&ndash;147.
<a href="https://doi.org/10.1016/0025-5564%2881%2990043-2">doi:10.1016/0025-5564(81)90043-2</a>.<br /><br /> Smith MR (2019).
&ldquo;Bayesian and parsimony approaches reconstruct informative trees from simulated morphological datasets.&rdquo;
<em>Biology Letters</em>, <b>15</b>(2), 20180632.
<a href="https://doi.org/10.1098/rsbl.2018.0632">doi:10.1098/rsbl.2018.0632</a>.<br /><br /> Smith MR (2020).
&ldquo;Information theoretic Generalized Robinson-Foulds metrics for comparing phylogenetic trees.&rdquo;
<em>Bioinformatics</em>, <b>36</b>(20), 5007–5013.
<a href="https://doi.org/10.1093/bioinformatics/btaa614">doi:10.1093/bioinformatics/btaa614</a>.<br /><br /> Steel MA, Penny D (1993).
&ldquo;Distributions of tree comparison metrics&mdash;some new results.&rdquo;
<em>Systematic Biology</em>, <b>42</b>(2), 126&ndash;141.
<a href="https://doi.org/10.1093/sysbio/42.2.126">doi:10.1093/sysbio/42.2.126</a>, <a href="http://www.math.canterbury.ac.nz/~m.steel/Non_UC/files/research/distributions.pdf">http://www.math.canterbury.ac.nz/~m.steel/Non_UC/files/research/distributions.pdf</a>.
</p>


<h3>See Also</h3>


<ul>
<li><p> Calculate status of each quartet &ndash; the raw material from which the
Estabrook <em>et al.</em> metrics are calculated &ndash; with <code><a href="#topic+QuartetStatus">QuartetStatus()</a></code>:
</p>
</li>
<li><p> Equivalent metrics for bipartition splits: <code><a href="#topic+SplitStatus">SplitStatus()</a></code>,
<code><a href="#topic+CompareSplits">CompareSplits()</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data("sq_trees")

sq_status &lt;- QuartetStatus(sq_trees)
SimilarityMetrics(sq_status)
QuartetDivergence(sq_status, similarity = FALSE)

library("TreeTools", quietly = TRUE, warn.conflict = FALSE)
set.seed(0)
reference &lt;- CollapseNode(as.phylo(101, 10), 16:18)
trees &lt;- c(
  reference = reference,
  binaryRef = MakeTreeBinary(reference),
  balanced = BalancedTree(reference),
  pectinate = PectinateTree(reference),
  star = StarTree(reference),
  random = RandomTree(reference),
  random2 = RandomTree(reference)
)
elementStatus &lt;- QuartetStatus(trees, reference)
SimilarityToReference(elementStatus)
SimilarityToReference(elementStatus, normalize = TRUE)
</code></pre>

<hr>
<h2 id='SplitStatus'>Matching partitions</h2><span id='topic+SplitStatus'></span><span id='topic+BipartitionStatus'></span><span id='topic+SharedSplitStatus'></span><span id='topic+SharedBipartitionStatus'></span>

<h3>Description</h3>

<p>Calculates how many of the partitions present in tree 1 are also present in
tree 2 (<code>s</code>),
how many of the partitions in tree 1 are absent in tree 2 (<code>d1</code>),
and how many of the partitions in tree 2 are absent in tree 1 (<code>d2</code>).
The Robinson-Foulds (symmetric partition) distance is the sum of the
latter two quantities, i.e. <code>d1</code> + <code>d2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SplitStatus(trees, cf = trees[[1]])

SharedSplitStatus(trees, cf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SplitStatus_+3A_trees">trees</code></td>
<td>
<p>A list of trees of class <code><a href="ape.html#topic+read.tree">phylo</a></code>,
with identically labelled tips.</p>
</td></tr>
<tr><td><code id="SplitStatus_+3A_cf">cf</code></td>
<td>
<p>Comparison tree of class <code><a href="ape.html#topic+read.tree">phylo</a></code>.  If unspecified,
each tree is compared to the first tree in <code>trees</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a two dimensional array.
Rows correspond to the input trees, and are named if names were present.
Columns report:
</p>
<p><strong>N</strong>: The total number of partitions present in the two trees,
i.e. <em>P1</em> + <em>P2</em>.
</p>
<p><strong>P1</strong>: The number of partitions present in tree 1.
</p>
<p><strong>P2</strong>: The number of partitions present in tree 2.
</p>
<p><strong>s</strong>: The number of partitions present in both trees.
</p>
<p><strong>d1</strong>: The number of partitions present in tree 1,
but contradicted by tree 2.
</p>
<p><strong>d2</strong>: The number of partitions present in tree 2,
but contradicted by tree 1.
</p>
<p><strong>r1</strong>: The number of partitions present in tree 1, and neither
present nor contradicted in tree 2.
</p>
<p><strong>r2</strong>: The number of partitions present in tree 2, and neither
present nor contradicted in tree 1.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>SharedSplitStatus()</code>: Reports split statistics obtained after removing all
tips that do not occur in both trees being compared.
</p>
</li></ul>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>


<ul>
<li> <p>Robinson DF, Foulds LR (1981).
&ldquo;Comparison of phylogenetic trees.&rdquo;
<em>Mathematical Biosciences</em>, <b>53</b>(1-2), 131&ndash;147.
<a href="https://doi.org/10.1016/0025-5564%2881%2990043-2">doi:10.1016/0025-5564(81)90043-2</a>.
</p>
</li>
<li> <p>Penny D, Hendy MD (1985).
&ldquo;The use of tree comparison metrics.&rdquo;
<em>Systematic Zoology</em>, <b>34</b>(1), 75&ndash;82.
<a href="https://doi.org/10.2307/2413347">doi:10.2307/2413347</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other element-by-element comparisons: 
<code><a href="#topic+CompareQuartetsMulti">CompareQuartetsMulti</a>()</code>,
<code><a href="#topic+CompareQuartets">CompareQuartets</a>()</code>,
<code><a href="#topic+CompareSplits">CompareSplits</a>()</code>,
<code><a href="#topic+PairSharedQuartetStatus">PairSharedQuartetStatus</a>()</code>,
<code><a href="#topic+QuartetState">QuartetState</a>()</code>,
<code><a href="#topic+SharedQuartetStatus">SharedQuartetStatus</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sq_trees")

# Calculate the status of each quartet
splitStatuses &lt;- SplitStatus(sq_trees)

# Calculate the raw symmetric difference (i.e. Robinson–Foulds distance)
RawSymmetricDifference(splitStatuses)

# Normalize the Robinson Foulds distance by dividing by the number of 
# splits present in the two trees:
RawSymmetricDifference(splitStatuses) / splitStatuses[, "N"]

# Normalize the Robinson Foulds distance by dividing by the total number of 
# splits that it is possible to resolve for `n` tips:
nTip &lt;- length(sq_trees[[1]]$tip.label)
nPartitions &lt;- 2 * (nTip - 3L) # Does not include the nTip partitions that 
                               # comprise but a single tip
RawSymmetricDifference(splitStatuses) / nPartitions


</code></pre>

<hr>
<h2 id='sq_trees'>Eighteen example trees</h2><span id='topic+sq_trees'></span>

<h3>Description</h3>

<p>A list of class <code><a href="ape.html#topic+multiphylo">multiPhylo</a></code> containing phylogenetic trees:
</p>

<dl>
<dt><code>ref_tree</code></dt><dd><p>A reference tree, bearing tips labelled 1 to 11.</p>
</dd>
<dt><code>move_one_near</code></dt><dd><p>Tip 1 has been moved a short distance.</p>
</dd>
<dt><code>move_one_mid</code></dt><dd><p>Tip 1 has been moved further.</p>
</dd>
<dt><code>move_one_far</code></dt><dd><p>Tip 1 has been moved further still.</p>
</dd>
<dt><code>move_two_near</code></dt><dd><p>Tips 10 &amp; 11 have been moved a short distance.</p>
</dd>
<dt><code>move_two_mid</code></dt><dd><p>Tips 10 &amp; 11 have been moved further.</p>
</dd>
<dt><code>move_two_far</code></dt><dd><p>Tips 10 &amp; 11 have been moved further still.</p>
</dd>
<dt><code>collapse_one</code></dt><dd><p>One node has been collapsed into a polytomy.</p>
</dd>
<dt><code>collapse_some</code></dt><dd><p>Several nodes have been collapsed.</p>
</dd>
<dt><code>m1mid_col1</code></dt><dd><p>Tree <code>move_one_mid</code> with one node collapsed.</p>
</dd>
<dt><code>m1mid_colsome</code></dt><dd><p>Tree <code>move_one_mid</code> with several nodes collapsed.</p>
</dd>
<dt><code>m2mid_col1</code></dt><dd><p>Tree <code>move_two_mid</code> with one node collapsed.</p>
</dd>
<dt><code>m2mid_colsome</code></dt><dd><p>Tree <code>move_two_mid</code> with several nodes collapsed.</p>
</dd>
<dt><code>opposite_tree</code></dt><dd><p>A tree that shares fewer quartets with <code>ref_tree</code> than expected by chance.</p>
</dd>
<dt><code>caterpillar</code></dt><dd><p>A pectinate &quot;caterpillar&quot; tree.</p>
</dd>
<dt><code>top_and_tail</code></dt><dd><p>Tree <code>caterpillar</code>, with its outermost taxa swapped
such that it shares no partitions with <code>caterpillar</code>.</p>
</dd>
<dt><code>anti_pectinate</code></dt><dd><p>A random tree that shares no partitions with
<code>caterpillar</code>.</p>
</dd>
<dt><code>random_tree</code></dt><dd><p>A random tree.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>sq_trees
</code></pre>


<h3>Format</h3>

<p>An object of class <code>multiPhylo</code> of length 18.
</p>

<hr>
<h2 id='SymmetricDifferenceLineEnds'>Plot contours of equal symmetric difference on a ternary plot</h2><span id='topic+SymmetricDifferenceLineEnds'></span><span id='topic+SymmetricDifferenceLines'></span>

<h3>Description</h3>

<p>Assumes that tree 1 is perfectly resolved, but that the resolution
of tree 2 can vary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SymmetricDifferenceLineEnds(nsd)

SymmetricDifferenceLines(nsd, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SymmetricDifferenceLineEnds_+3A_nsd">nsd</code></td>
<td>
<p>Vector specifying normalized symmetric differences to plot.</p>
</td></tr>
<tr><td><code id="SymmetricDifferenceLineEnds_+3A_...">...</code></td>
<td>
<p>Further parameters to pass to
<code><a href="Ternary.html#topic+AddToTernary">TernaryLines</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of dim <code style="white-space: pre;">&#8288;(length(nsd), 6)&#8288;</code>, with columns named
<code>r2a</code>, <code>da</code>, <code>sa</code>, <code>r2b</code>, <code>db</code> and <code>sb</code>.
Lines from <code>a</code> to <code>b</code> in each row connect points of equal symmetric difference.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>SymmetricDifferenceLines()</code>: Plot the lines onto the active ternary plot.
</p>
</li></ul>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>

<hr>
<h2 id='TQDist'>Wrapper for tqDist</h2><span id='topic+TQDist'></span><span id='topic+TQAE'></span>

<h3>Description</h3>

<p>Convenience function that takes a list of trees, writes them to the text
file expected by the C implementation of tqDist (Sand <em>et al.</em> 2014).
tqDist is then called, and the temporary file is deleted when analysis is
complete.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TQDist(trees)

TQAE(trees)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TQDist_+3A_trees">trees</code></td>
<td>
<p>List of phylogenetic trees, of class <code>list</code> or
<code><a href="ape.html#topic+read.tree">multiPhylo</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Quartets can be resolved in one of five ways, which Brodal <em>et al</em>. (2013)
and Holt <em>et al</em>. (2014) distinguish using the letters A&ndash;E, and
Estabrook <em>et al.</em> (1985) refers to as:
</p>

<ul>
<li><p> A: <em>s</em> = resolved the <strong>s</strong>ame in both trees;
</p>
</li>
<li><p> B: <em>d</em> = resolved <strong>d</strong>ifferently in both trees;
</p>
</li>
<li><p> C: <em>r1</em> = <strong>r</strong>esolved only in tree <strong>1</strong>;
</p>
</li>
<li><p> D: <em>r2</em> = <strong>r</strong>esolved only in tree <strong>2</strong> (the comparison tree);
</p>
</li>
<li><p> E: <em>u</em> = <strong>u</strong>nresolved in both trees.
</p>
</li></ul>



<h3>Value</h3>

<p><code>TQDist()</code> returns the quartet distance between each pair of trees.
</p>
<p><code>TQAE()</code> returns the number of resolved quartets in agreement between
each pair of trees (&quot;A&quot; in Brodal <em>et al</em>. 2013) and the number of quartets
that are unresolved in both trees (&quot;E&quot; in Brodal <em>et al</em>. 2013).
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>


<ul>
<li> <p>Brodal GS, Fagerberg R, Mailund T, Pedersen CNS, Sand A (2013).
&ldquo;Efficient algorithms for computing the triplet and quartet distance between trees of arbitrary degree.&rdquo;
<em>SODA '13 Proceedings of the Twenty-Fourth Annual ACM-SIAM Symposium on Discrete Algorithms</em>, 1814&ndash;1832.
<a href="https://doi.org/10.1137/1.9781611973105.130">doi:10.1137/1.9781611973105.130</a>.
</p>
</li>
<li> <p>Estabrook GF, McMorris FR, Meacham CA (1985).
&ldquo;Comparison of undirected phylogenetic trees based on subtrees of four evolutionary units.&rdquo;
<em>Systematic Zoology</em>, <b>34</b>(2), 193&ndash;200.
<a href="https://doi.org/10.2307/2413326">doi:10.2307/2413326</a>.
</p>
</li>
<li> <p>Holt MK, Johansen J, Brodal GS (2014).
&ldquo;On the scalability of computing triplet and quartet distances.&rdquo;
In <em>Proceedings of 16th Workshop on Algorithm Engineering and Experiments (ALENEX) Portland, Oregon, USA</em>.
</p>
</li>
<li> <p>Sand A, Holt MK, Johansen J, Brodal GS, Mailund T, Pedersen CNS (2014).
&ldquo;tqDist: a library for computing the quartet and triplet distances between binary or general trees.&rdquo;
<em>Bioinformatics</em>, <b>30</b>(14), 2079&ndash;2080.
ISSN 1460-2059, <a href="https://doi.org/10.1093/bioinformatics/btu157">doi:10.1093/bioinformatics/btu157</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+CompareQuartets">CompareQuartets()</a></code>, <code><a href="#topic+QuartetStatus">QuartetStatus()</a></code>
</p>

<hr>
<h2 id='tqdist_QuartetDistance'>Direct entry points to 'tqDist' functions</h2><span id='topic+tqdist_QuartetDistance'></span><span id='topic+tqdist_QuartetAgreement'></span><span id='topic+tqdist_QuartetAgreementEdge'></span><span id='topic+tqdist_QuartetAgreementChar'></span><span id='topic+tqdist_PairsQuartetDistance'></span><span id='topic+tqdist_OneToManyQuartetAgreement'></span><span id='topic+tqdist_OneToManyQuartetAgreementChar'></span><span id='topic+tqdist_OneToManyQuartetAgreementEdge'></span><span id='topic+tqdist_AllPairsQuartetDistance'></span><span id='topic+tqdist_AllPairsQuartetDistanceChar'></span><span id='topic+tqdist_AllPairsQuartetDistanceEdge'></span><span id='topic+tqdist_AllPairsQuartetAgreement'></span><span id='topic+tqdist_AllPairsQuartetAgreementChar'></span><span id='topic+tqdist_AllPairsQuartetAgreementEdge'></span><span id='topic+tqdist_TripletDistance'></span><span id='topic+tqdist_PairsTripletDistance'></span><span id='topic+tqdist_AllPairsTripletDistance'></span>

<h3>Description</h3>

<p>Functions to calculate triplet and quartet distances between pairs of trees.
Input is not checked for sanity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tqdist_QuartetDistance(file1, file2)

tqdist_QuartetAgreement(file1, file2)

tqdist_QuartetAgreementEdge(edge1, edge2)

tqdist_QuartetAgreementChar(string1, string2)

tqdist_PairsQuartetDistance(file1, file2)

tqdist_OneToManyQuartetAgreement(file1, fileMany)

tqdist_OneToManyQuartetAgreementChar(tree, trees)

tqdist_OneToManyQuartetAgreementEdge(edge, edges)

tqdist_AllPairsQuartetDistance(file)

tqdist_AllPairsQuartetDistanceChar(string)

tqdist_AllPairsQuartetDistanceEdge(edges)

tqdist_AllPairsQuartetAgreement(file)

tqdist_AllPairsQuartetAgreementChar(string)

tqdist_AllPairsQuartetAgreementEdge(edges)

tqdist_TripletDistance(file1, file2)

tqdist_PairsTripletDistance(file1, file2)

tqdist_AllPairsTripletDistance(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tqdist_QuartetDistance_+3A_file">file</code>, <code id="tqdist_QuartetDistance_+3A_file1">file1</code>, <code id="tqdist_QuartetDistance_+3A_file2">file2</code></td>
<td>
<p>Paths to files containing a tree or trees in Newick format.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions are called from R with user-friendly functions such as
<code><a href="#topic+AllPairsQuartetDistance">AllPairsQuartetDistance</a></code>.
</p>


<h3>Value</h3>

<p>The distance between the requested trees.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>tqdist_QuartetAgreement()</code>: Agreement of each quartet
</p>
</li>
<li> <p><code>tqdist_QuartetAgreementEdge()</code>: Agreement of each quartet
</p>
</li>
<li> <p><code>tqdist_QuartetAgreementChar()</code>: Agreement of each quartet
</p>
</li>
<li> <p><code>tqdist_PairsQuartetDistance()</code>: Distance between pairs
</p>
</li>
<li> <p><code>tqdist_OneToManyQuartetAgreement()</code>: Distance between pairs
</p>
</li>
<li> <p><code>tqdist_OneToManyQuartetAgreementChar()</code>: Distance between pairs
</p>
</li>
<li> <p><code>tqdist_OneToManyQuartetAgreementEdge()</code>: Distance between pairs
</p>
</li>
<li> <p><code>tqdist_AllPairsQuartetDistance()</code>: Distance between all pairs
</p>
</li>
<li> <p><code>tqdist_AllPairsQuartetDistanceChar()</code>: Distance between all pairs
</p>
</li>
<li> <p><code>tqdist_AllPairsQuartetDistanceEdge()</code>: Distance between all pairs
</p>
</li>
<li> <p><code>tqdist_AllPairsQuartetAgreement()</code>: Agreement between all pairs of trees
</p>
</li>
<li> <p><code>tqdist_AllPairsQuartetAgreementChar()</code>: Agreement between all pairs of trees
</p>
</li>
<li> <p><code>tqdist_AllPairsQuartetAgreementEdge()</code>: Agreement between all pairs of trees
</p>
</li>
<li> <p><code>tqdist_TripletDistance()</code>: Triplet distance between two trees
</p>
</li>
<li> <p><code>tqdist_PairsTripletDistance()</code>: Triplet distance between pairs
</p>
</li>
<li> <p><code>tqdist_AllPairsTripletDistance()</code>: Triplet distance between all pairs
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Martin R. Smith, after Andreas Sand
</p>


<h3>References</h3>

<p>Sand A, Holt MK, Johansen J, Brodal GS, Mailund T, Pedersen CNS (2014).
&ldquo;tqDist: a library for computing the quartet and triplet distances between binary or general trees.&rdquo;
<em>Bioinformatics</em>, <b>30</b>(14), 2079&ndash;2080.
ISSN 1460-2059, <a href="https://doi.org/10.1093/bioinformatics/btu157">doi:10.1093/bioinformatics/btu157</a>.
</p>

<hr>
<h2 id='TQFile'>tqDist file generator</h2><span id='topic+TQFile'></span>

<h3>Description</h3>

<p>Creates a temporary file corresponding to a list of trees,
to be processed with tqDist.  Files should be destroyed using
<code>on.exit(file.remove(fileName))</code> by the calling function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TQFile(treeList)
</code></pre>


<h3>Details</h3>

<p>Should now only be necessary for testing purposes.
</p>


<h3>Value</h3>

<p>Name of the created file
</p>

<hr>
<h2 id='ValidateQuartetFile'>Validate filenames</h2><span id='topic+ValidateQuartetFile'></span>

<h3>Description</h3>

<p>Verifies that file parameters are character strings describing files that exist
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ValidateQuartetFile(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ValidateQuartetFile_+3A_file">file</code></td>
<td>
<p>Variable to validate</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if <code>file</code> is a character vector of length one describing
a file that exists, a fatal error otherwise.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>

<hr>
<h2 id='VisualizeQuartets'>Visualize quartet difference on trees, by split</h2><span id='topic+VisualizeQuartets'></span>

<h3>Description</h3>

<p>Visualize quartet difference on trees, by split
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VisualizeQuartets(
  tree1,
  tree2,
  style = "pie",
  setPar = TRUE,
  precision = 3L,
  Plot = plot.phylo,
  scale = 1L,
  spectrum = viridisLite::viridis(101),
  legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VisualizeQuartets_+3A_tree1">tree1</code>, <code id="VisualizeQuartets_+3A_tree2">tree2</code></td>
<td>
<p>Trees of class <code>phylo</code>, with identical leaf labels.</p>
</td></tr>
<tr><td><code id="VisualizeQuartets_+3A_style">style</code></td>
<td>
<p>Character string specifying split labels with an unambiguous
abbreviation of:
</p>

<ul>
<li> <p><code>label</code>: Label stating proportion of resolved quartets in agreement,
coloured accordingly;
</p>
</li>
<li> <p><code>pie</code>: Pie chart showing proportion of quartets in agreement, sized
according to number of quartets influenced by each split;
</p>
</li>
<li> <p><code>bar</code>: Bar showing proportion of quartets in agreement, labelled;
</p>
</li>
<li> <p><code>size</code>: Circle coloured according to proportion of quartets in agreement,
with area corresponding to number of quartet statements associated with
split.
</p>
</li></ul>
</td></tr>
<tr><td><code id="VisualizeQuartets_+3A_setpar">setPar</code></td>
<td>
<p>Logical specifying whether graphical parameters should be set
to display trees side by side.</p>
</td></tr>
<tr><td><code id="VisualizeQuartets_+3A_precision">precision</code></td>
<td>
<p>Integer specifying number of significant figures to display
when reporting matching scores.</p>
</td></tr>
<tr><td><code id="VisualizeQuartets_+3A_plot">Plot</code></td>
<td>
<p>Function to use to plot trees.</p>
</td></tr>
<tr><td><code id="VisualizeQuartets_+3A_scale">scale</code></td>
<td>
<p>Numeric, enlargement factor for split labels.</p>
</td></tr>
<tr><td><code id="VisualizeQuartets_+3A_spectrum">spectrum</code></td>
<td>
<p>101-element vector specifying a range of colours by which
to colour matches.</p>
</td></tr>
<tr><td><code id="VisualizeQuartets_+3A_legend">legend</code></td>
<td>
<p>Logical specifying whether to display simple legend.</p>
</td></tr>
<tr><td><code id="VisualizeQuartets_+3A_...">...</code></td>
<td>
<p>Additional parameters to send to <code>Plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("TreeTools", quietly = TRUE, warn.conflicts = FALSE)
VisualizeQuartets(BalancedTree(10), CollapseNode(PectinateTree(10), 19),
                  style = "label")
# Keep original plotting parameters:
origPar &lt;- par(mfrow = c(2, 2))
VisualizeQuartets(BalancedTree(10), CollapseNode(PectinateTree(10), 19),
                  setPar = FALSE)
VisualizeQuartets(BalancedTree(10), CollapseNode(PectinateTree(10), 19),
                  style = "bar", legend = FALSE, setPar = FALSE)
par(origPar)
VisualizeQuartets(BalancedTree(20), CollapseNode(PectinateTree(20), 29:33),
                  style = "size", scale = 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
