<!DOCTYPE html><html><head><title>Help for package AcrossTic</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AcrossTic}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AcrossTic-package'>
<p>A Cost-Minimal Regular Spanning Subgraph with TreeClust</p></a></li>
<li><a href='#plot.AcrossTic'>
<p>Plot function for simple AcrossTic objects</p></a></li>
<li><a href='#print.AcrossTic'>
<p>Print method for AcrossTic objects</p></a></li>
<li><a href='#print.AcrossTicPtest'>
<p>Print output of AcrossTic permutation test</p></a></li>
<li><a href='#ptest'>
<p>Permutation test for AcrossTic objects</p></a></li>
<li><a href='#rRegMatch'>
<p>Regular matching with minimum-cost spanning subgraphs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-08-12</td>
</tr>
<tr>
<td>Title:</td>
<td>A Cost-Minimal Regular Spanning Subgraph with TreeClust</td>
</tr>
<tr>
<td>Author:</td>
<td>Dave Ruth, Sam Buttrey</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sam Buttrey &lt;buttrey@nps.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>treeClust (&ge; 1.1-6), lpSolve</td>
</tr>
<tr>
<td>Description:</td>
<td>Construct minimum-cost regular spanning subgraph as part of a
    non-parametric two-sample test for equality of distribution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-08-12 22:41:34 UTC; sebuttre</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-08-13 11:01:25</td>
</tr>
</table>
<hr>
<h2 id='AcrossTic-package'>
A Cost-Minimal Regular Spanning Subgraph with TreeClust
</h2><span id='topic+AcrossTic-package'></span><span id='topic+AcrossTic'></span>

<h3>Description</h3>

<p>Construct minimum-cost regular spanning subgraph as part of a
non-parametric two-sample test for equality of distribution.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> AcrossTic</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-08-12</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> A Cost-Minimal Regular Spanning Subgraph with TreeClust</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Dave Ruth, Sam Buttrey</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Sam Buttrey &lt;buttrey@nps.edu&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> 
treeClust (&gt;= 1.1-6),
lpSolve</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Construct minimum-cost regular spanning subgraph as part of a
    non-parametric two-sample test for equality of distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
rRegMatch		Compute r-regular matching spanning trees
print.AcrossTic		print an AcrossTic object, the output from rRegMatch
plot.AcrossTic		print an AcrossTic object, the output from rRegMatch
ptest			perform permutation test on AcrossTic object
print.AcrossTicPtest	print an AcrossTic permutation test object
</pre>
<p>This primarily provides rRegMatch, which for arguments X and r produces
a minimum-distance r-regular subgraph of the rows of X.
</p>


<h3>Author(s)</h3>

<p>Dave Ruth, Sam Buttrey
</p>
<p>Maintainer: Sam Buttrey &lt;buttrey@nps.edu&gt;
</p>


<h3>References</h3>

<p>David Ruth, &quot;A new multivariate two-sample test using regular minimum-weight spanning subgraphs,&quot;
J. Stat. Distributions and Applications (2014)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed (123)
X &lt;- matrix (rnorm (100), 50, 2) # Create data...
y &lt;- rep (c (1, 2), each=25) # ...and class membership
## Not run: rRegMatch (X, r = 3, y = y)
</code></pre>

<hr>
<h2 id='plot.AcrossTic'>
Plot function for simple AcrossTic objects
</h2><span id='topic+plot.AcrossTic'></span>

<h3>Description</h3>

<p>Plot an object of class AcrossTic (see details). Currently intended for two-class objects built
with two-dimensional Xs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AcrossTic'
 plot(x, X.values, y, grp.cols = c(2, 4), grp.pch = c(16, 17), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.AcrossTic_+3A_x">x</code></td>
<td>

<p>AcrossTic object, normally the output from <code><a href="#topic+rRegMatch">rRegMatch</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.AcrossTic_+3A_x.values">X.values</code></td>
<td>

<p>Matrix of data. If not spplied the function looks in <code>x</code>.
</p>
</td></tr>
<tr><td><code id="plot.AcrossTic_+3A_y">y</code></td>
<td>

<p>Vector with two distinct values giving the label for each observation.
</p>
</td></tr>
<tr><td><code id="plot.AcrossTic_+3A_grp.cols">grp.cols</code></td>
<td>

<p>Colors for the two groups. Default: 2 and 4.
</p>
</td></tr>
<tr><td><code id="plot.AcrossTic_+3A_grp.pch">grp.pch</code></td>
<td>

<p>Plotting points for the two groups. Default: 16 and 17.
</p>
</td></tr>
<tr><td><code id="plot.AcrossTic_+3A_...">...</code></td>
<td>

<p>Other arguments, passed on to <code><a href="graphics.html#topic+plot">plot</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This demonstrates a graph of the matching of the rRegMatch type. Points are plotted in 2d; then within-group matches
are shown with dotted lines and between-group pairings with solid ones. If X has more than two columns,
the first two are used, with a warning. If Y is supplied it will be used; if 
not, it will be extracted from x; if no y is found, an error is issued. Y must
have exactly two distinct values.
</p>


<h3>Value</h3>

<p>No output. Side effect: a plot is produced.
</p>


<h3>Author(s)</h3>

<p>David Ruth and Sam Buttrey
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed (123)
X &lt;- matrix (rnorm (100), 50, 2) # Create data...
y &lt;- rep (c (0, 1), each=25) # ...and class membership
plot (rRegMatch (X, r = 3, y = y))
</code></pre>

<hr>
<h2 id='print.AcrossTic'>
Print method for AcrossTic objects
</h2><span id='topic+print.AcrossTic'></span>

<h3>Description</h3>

<p>Print some attributes of an AcrossTic object to the screen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AcrossTic'
 print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.AcrossTic_+3A_x">x</code></td>
<td>

<p>AcrossTic item (output from <code><a href="#topic+rRegMatch">rRegMatch</a></code>) to be printed
</p>
</td></tr>
<tr><td><code id="print.AcrossTic_+3A_...">...</code></td>
<td>

<p>Other arguments, currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Sam Buttrey
</p>

<hr>
<h2 id='print.AcrossTicPtest'>
Print output of AcrossTic permutation test
</h2><span id='topic+print.AcrossTicPtest'></span>

<h3>Description</h3>

<p>Print the output of a permutation test on an AcrossTic object (see <code><a href="#topic+ptest">ptest</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AcrossTicPtest'
 print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.AcrossTicPtest_+3A_x">x</code></td>
<td>

<p>Object of class AcrossTicPtest
</p>
</td></tr>
<tr><td><code id="print.AcrossTicPtest_+3A_...">...</code></td>
<td>

<p>Other arguments, currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output from <code><a href="#topic+ptest">ptest</a></code> has class AcrossTicPtest. This function prints such an object.
</p>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Sam Buttrey
</p>

<hr>
<h2 id='ptest'>
Permutation test for AcrossTic objects
</h2><span id='topic+ptest'></span>

<h3>Description</h3>

<p>This function permutes the &quot;y&quot; entries in an AcrossTic object and computes the
cross-count statistic for each permutation. This generates a null distribution
suitable for use in a permutation test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptest(acobj, y, edge.weights, n = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptest_+3A_acobj">acobj</code></td>
<td>

<p>Object of class AcrossTic, output from <code><a href="#topic+rRegMatch">rRegMatch</a></code>.
</p>
</td></tr>
<tr><td><code id="ptest_+3A_y">y</code></td>
<td>

<p>Character, factor or logical indicating class membership for each observation.
Normally this will be found inside <code>acobj</code>.
</p>
</td></tr>
<tr><td><code id="ptest_+3A_edge.weights">edge.weights</code></td>
<td>
<p>Vector of weights associated with each match. If omitted,
the default is a vector of 1's of the proper length, unless the &quot;acobj&quot; object
was computed with partial matching, in which case omitting edge.weights
produces an error.
</p>
</td></tr>
<tr><td><code id="ptest_+3A_n">n</code></td>
<td>

<p>Integer, number of simulations. Default, 1000.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function permutes the y's <code>n</code> times and computes the cross-count-match statistic. 
If the observed value in the <code>acobj</code> is generally smaller than the permuted values,
we conclude the distributions of the classes are different.
</p>


<h3>Value</h3>

<p>A list with class AcrossTicPtest and three components: 
</p>
<table>
<tr><td><code>sims</code></td>
<td>
<p>Vector of <code>n</code> cross-count values computed under permutation</p>
</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>Observed cross-count statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>P-value for test</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sam Buttrey and Dave Ruth
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rRegMatch">rRegMatch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed (123)
X &lt;- matrix (rnorm (100), 50, 2) # Create data...
y &lt;- rep (c ("One", "Two"), each=25) # ...and class membership
## Not run: ptest (rRegMatch (X, r = 3, y = y)) # p = .479
X[1:25,] &lt;- X[1:25,] + 1
## Not run: ptest (rRegMatch (X, r = 3, y = y)) # p = .037
</code></pre>

<hr>
<h2 id='rRegMatch'>
Regular matching with minimum-cost spanning subgraphs
</h2><span id='topic+rRegMatch'></span>

<h3>Description</h3>

<p>This function matches each observation in X to r others so as to minimize the 
total distance across all matches. Optionally it computes the cross-count
statistic &ndash; the number of matches associated with two observations from 
different classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rRegMatch(X, r, y = NULL, dister = "daisy", dist.args = list(), keep.X = nrow(X) &lt; 100, 
    keep.D = (dister == "treeClust.dist"), relax = (N &gt;= 100), thresh = 1e-6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rRegMatch_+3A_x">X</code></td>
<td>

<p>Matrix or data frame of data, or inter-point distances represented in an object inheriting from &quot;dist&quot;
</p>
</td></tr>
<tr><td><code id="rRegMatch_+3A_r">r</code></td>
<td>

<p>Integer number of matches. The matching is &quot;regular&quot; in that every observation is matched to exactly
r others (or, if relax=TRUE, every observation is matched to others with weights in [0, 1] that add up to r).
</p>
</td></tr>
<tr><td><code id="rRegMatch_+3A_y">y</code></td>
<td>

<p>Vector of class membership indices. This is used to compute the cross-count statistic. Optional.
</p>
</td></tr>
<tr><td><code id="rRegMatch_+3A_dister">dister</code></td>
<td>

<p>Function to compute inter-point distances. This must take as its first argument
a matrix of data argument name <code>x</code>. Default: <code><a href="cluster.html#topic+daisy">daisy</a></code>. 
If all the columns are numeric,
this produces unweighted Euclidean distance by default.
</p>
</td></tr>
<tr><td><code id="rRegMatch_+3A_dist.args">dist.args</code></td>
<td>

<p>List of argument to the <code>dister</code> function.
</p>
</td></tr>
<tr><td><code id="rRegMatch_+3A_keep.x">keep.X</code></td>
<td>

<p>If TRUE, and X was supplied, keep the X matrix in the output object. Default: 
TRUE if X was supplied and also nrow (X) &lt; 100.
</p>
</td></tr>
<tr><td><code id="rRegMatch_+3A_keep.d">keep.D</code></td>
<td>

<p>If TRUE, keep the distance object in the output. Default: TRUE if the 
<code><a href="treeClust.html#topic+treeClust.dist">treeClust.dist</a></code> function is being
used to compute the distances (since in that case the distances are random).
</p>
</td></tr>
<tr><td><code id="rRegMatch_+3A_relax">relax</code></td>
<td>

<p>If FALSE, solve the exact problem where each observation gets exactly r 
non-zero pairings, each with weight 1. If TRUE, solve the relaxed problem, 
where each observation has at least r non-zero pairings, 
each with its own weight between 0 and 1, the weights adding up to r. The
exact problem gets very slow with large samples.
</p>
</td></tr>
<tr><td><code id="rRegMatch_+3A_thresh">thresh</code></td>
<td>

<p>Weights smaller than this are considered to be exactly zero. Default: 1e-6.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function solves an optimization problem to extract the set of pairings which make the total weight
(distance) associated with all pairings a minimum, subject to the constraint that every observation is paired
to r others (or to enough others to have a total pair-weight of r).
</p>


<h3>Value</h3>

<p>A list of class AcrossTic, with elements:
</p>
<table>
<tr><td><code>matches</code></td>
<td>
<p>A two-column matrix, each row gving the indices of one matched pair.</p>
</td></tr>
<tr><td><code>total.dist</code></td>
<td>
<p>total distance across all matches &ndash; the optimal value from the optimization problem.</p>
</td></tr>
<tr><td><code>status</code></td>
<td>
<p>Status of result &ndash; if the optimum was found, a vector of length 1 with 
name &quot;TM_OPTIMAL_SOLUTION_FOUND&quot; and value 0.</p>
</td></tr>
<tr><td><code>time.required</code></td>
<td>
<p>Time taken to run the optimization, as reported by <code>system.time()</code>.</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>The call made to the function, from <code>match.call</code>.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>The value of r, as supplied at the time of the call.</p>
</td></tr>
<tr><td><code>dister</code></td>
<td>
<p>The value of dister, as supplied at the time of the call.</p>
</td></tr>
<tr><td><code>dist.args</code></td>
<td>
<p>The value of dist.args, as supplied at the time of the call.</p>
</td></tr>
<tr><td><code>X.supplied</code></td>
<td>
<p>Logical indicating whether X was supplied.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>X matrix, if it was available and asked to be kept</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>y vector, as supplied</p>
</td></tr>
<tr><td><code>edge.weights</code></td>
<td>
<p>vector, of length <code>nrow(matches)</code>, giving the distances for each match. For the exact problem (<code>relax = FALSE</code>), each value is
equal to 0 or 1. For the relaxed problem (<code>relax = TRUE</code>), each value is
between 0 and 1, with values summing to <code>(r * nrow(X) / 2)</code>.</p>
</td></tr>
<tr><td><code>cross.sum</code></td>
<td>
<p>Sum of matcher.costs across all matches</p>
</td></tr>
<tr><td><code>cross.count</code></td>
<td>
<p>Number of matches between two observations of different classes, possibly weighted</p>
</td></tr>
<tr><td><code>nrow.X</code>, <code>ncol.X</code></td>
<td>
<p>dimension of X matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Ruth and Sam Buttrey
</p>


<h3>References</h3>

<p>David Ruth, &quot;A new multivariate two-sample test using regular minimum-weight spanning subgraphs,&quot;
J. Stat. Distributions and Applications (2014)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed (123)
X &lt;- matrix (rnorm (100), 50, 2) # Create data...
y &lt;- rep (c (1, 2), each=25) # ...and class membership
rRegMatch (X, r = 3, y = y)
## Not run: plot (rRegMatch (X, r = 3, y = y)) # to see picture</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
