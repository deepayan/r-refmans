<!DOCTYPE html><html lang="en"><head><title>Help for package ExtremeRisks</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ExtremeRisks}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dowjones'><p>Negative log-returns of DOW JONES.</p></a></li>
<li><a href='#EBTailIndex'><p>Expectile Based Tail Index Estimation</p></a></li>
<li><a href='#estExpectiles'><p>High Expectile Estimation</p></a></li>
<li><a href='#estExtLevel'><p>Extreme Level Estimation</p></a></li>
<li><a href='#estMultiExpectiles'><p>Multidimensional High Expectile Estimation</p></a></li>
<li><a href='#expectiles'><p>Expectile Computation</p></a></li>
<li><a href='#ExpectMES'><p>Marginal Expected Shortfall Expectile Based Estimation</p></a></li>
<li><a href='#extMultiQuantile'><p>Multidimensional Value-at-Risk (VaR) or Extreme Quantile (EQ) Estimation</p></a></li>
<li><a href='#extQuantile'><p>Value-at-Risk (VaR) or Extreme Quantile (EQ) Estimation</p></a></li>
<li><a href='#HTailIndex'><p>Hill Tail Index Estimation</p></a></li>
<li><a href='#HypoTesting'><p>Wald-Type Hypothesis Testing</p></a></li>
<li><a href='#MLTailIndex'><p>Maximum Likelihood Tail Index Estimation</p></a></li>
<li><a href='#MomTailIndex'><p>Moment based Tail Index Estimation</p></a></li>
<li><a href='#MultiHTailIndex'><p>Multidimensional Hill Tail Index Estimation</p></a></li>
<li><a href='#predExpectiles'><p>Extreme Expectile Estimation</p></a></li>
<li><a href='#predMultiExpectiles'><p>Multidimensional Extreme Expectile Estimation</p></a></li>
<li><a href='#QuantMES'><p>Marginal Expected Shortfall Quantile Based Estimation</p></a></li>
<li><a href='#rbtimeseries'><p>Simulation of Two-Dimensional Temporally Dependent Observations</p></a></li>
<li><a href='#rmdata'><p>Simulation of <code class="reqn">d</code>-Dimensional Temporally Independent Observations</p></a></li>
<li><a href='#rtimeseries'><p>Simulation of One-Dimensional Temporally Dependent Observations</p></a></li>
<li><a href='#sp500'><p>Negative log-returns of S\&amp;P 500.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-08-26</td>
</tr>
<tr>
<td>Title:</td>
<td>Extreme Risk Measures</td>
</tr>
<tr>
<td>Author:</td>
<td>Simone Padoan [cre, aut],
  Gilles Stupfler [aut],
  Bocconi Institute for Data Science and Analytics [fnd],
  French National Research [fnd] (grant ANR-19-CE40-0013-01/ExtremReg)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Simone Padoan &lt;simone.padoan@unibocconi.it&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>evd, copula, mvtnorm, plot3D, tmvtnorm, pracma</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of procedures for estimating risks related to extreme events via risk measures such as Expectile, Value-at-Risk, etc. is provided. Estimation methods for univariate independent observations and temporal dependent observations are available. The methodology is extended to the case of independent multidimensional observations.  The statistical inference is performed through parametric and non-parametric estimators. Inferential procedures such as confidence intervals, confidence regions and hypothesis testing are obtained by exploiting the asymptotic theory. Adapts the methodologies derived in Padoan and Stupfler (2020) &lt;<a href="https://doi.org/10.48550/arXiv.2004.04078">doi:10.48550/arXiv.2004.04078</a>&gt;, Padoan and Stupfler (2020) &lt;<a href="https://doi.org/10.48550/arXiv.2007.08944">doi:10.48550/arXiv.2007.08944</a>&gt;, Daouia et al. (2018) &lt;<a href="https://doi.org/10.1111%2Frssb.12254">doi:10.1111/rssb.12254</a>&gt;, Drees (2000) &lt;<a href="https://doi.org/10.1214%2Faoap%2F1019487617">doi:10.1214/aoap/1019487617</a>&gt;, Drees (2003) &lt;<a href="https://doi.org/10.3150%2Fbj%2F1066223272">doi:10.3150/bj/1066223272</a>&gt;, de Haan and Ferreira (2006) &lt;<a href="https://doi.org/10.1007%2F0-387-34471-3">doi:10.1007/0-387-34471-3</a>&gt;, de Haan et al. (2016) &lt;<a href="https://doi.org/10.1007%2Fs00780-015-0287-6">doi:10.1007/s00780-015-0287-6</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td>mypage.unibocconi.it/simonepadoan/</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Repository/R-Forge/Project:</td>
<td>extremerisks</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-08-27 07:48:08 UTC; rforge</td>
</tr>
<tr>
<td>Repository/R-Forge/Revision:</td>
<td>18</td>
</tr>
<tr>
<td>Repository/R-Forge/DateTimeStamp:</td>
<td>2020-08-27 07:33:03</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-08-27 13:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='dowjones'>Negative log-returns of DOW JONES.</h2><span id='topic+dowjones'></span>

<h3>Description</h3>

<p>Series of negative log-returns of the U.S. stock market index Dow Jones.</p>


<h3>Format</h3>

<p>A <code class="reqn">8784*2</code> data frame.</p>


<h3>Details</h3>

<p>From the series of n = 8785 closing prices <code class="reqn">S_{t}</code>, <code class="reqn">t=1,2,...</code>, for the Dow Jones stock market index, recorded from January 29, 1985 to December 12, 2019, the series of negative log-returns.
</p>
<p><code class="reqn">
X_{t+1} = - \log(S_{t+1}/S_t), \quad 1\leq t\leq n-1</code>
</p>
<p>is available. Hence the dataset (negative log-returns) contains <code class="reqn">8784</code> observations.
</p>

<hr>
<h2 id='EBTailIndex'>Expectile Based Tail Index Estimation</h2><span id='topic+EBTailIndex'></span>

<h3>Description</h3>

<p>Computes a point estimate of the tail index based on the Expectile Based (EB) estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>EBTailIndex(data, tau, est=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EBTailIndex_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations.</p>
</td></tr>
<tr><td><code id="EBTailIndex_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>\.</p>
</td></tr>
<tr><td><code id="EBTailIndex_+3A_est">est</code></td>
<td>
<p>A real specifying the estimate of the expectile at the intermediate level <code>tau</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of sample size <code class="reqn">n</code>, the tail index <code class="reqn">\gamma</code> of its (marginal) distribution is estimated using the EB estimator:
</p>
<p><code class="reqn">
    \hat{\gamma}_n^E =\left(1+\frac{\hat{\bar{F}}_n(\tilde{\xi}_{\tau_n})}{1-\tau_n}\right)^{-1}
	</code>,
</p>
<p>where <code class="reqn">\hat{\bar{F}}_n</code> is the empirical survival function of the observations, <code class="reqn">\tilde{\xi}_{\tau_n}</code> is an estimate of the <code class="reqn">\tau_n</code>-<em>th</em> expectile.
The observations can be either independent or temporal dependent. See Padoan and Stupfler (2020) and Daouia et al. (2018) for details.
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. Practically, <code class="reqn">\tau_n \in (0,1)</code> is the ratio between the empirical mean distance of the <code class="reqn">\tau_n</code>-<em>th</em> expectile from the smaller observations and the empirical mean distance of of the <code class="reqn">\tau_n</code>-<em>th</em> expectile from all the observations. An estimate of <code class="reqn">\tau_n</code>-<em>th</em> expectile is computed and used in turn to estimate <code class="reqn">\gamma</code>.
</p>
</li>
<li><p> The value <code>est</code>, if provided, is meant to be an esitmate of the <code class="reqn">\tau_n</code>-<em>th</em> expectile which is used to estimate <code class="reqn">\gamma</code>. On the contrary, if <code>est=NULL</code>, then the routine <code>EBTailIndex</code> estimate first the <code class="reqn">\tau_n</code>-<em>th</em> expectile expectile and then use it to estimate <code class="reqn">\gamma</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>An estimate of the tain index <code class="reqn">\gamma</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>
<p>Daouia, A., Girard, S. and Stupfler, G. (2018). Estimation of tail risk based on extreme expectiles. <em>Journal of the Royal Statistical Society: Series B</em>, <b>80</b>, 263-292.
</p>


<h3>See Also</h3>

<p><a href="#topic+HTailIndex">HTailIndex</a>, <a href="#topic+MomTailIndex">MomTailIndex</a>, <a href="#topic+MLTailIndex">MLTailIndex</a>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tail index estimation based on the Expectile based estimator obtained with data
# simulated from an AR(1) with 1-dimensional Student-t distributed innovations

tsDist &lt;- "studentT"
tsType &lt;- "AR"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallblock &lt;- 15

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.97

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rtimeseries(ndata, tsDist, tsType, par)

# tail index estimation
gammaHat &lt;- EBTailIndex(data, tau)
gammaHat
</code></pre>

<hr>
<h2 id='estExpectiles'>High Expectile Estimation</h2><span id='topic+estExpectiles'></span>

<h3>Description</h3>

<p>Computes a point and interval estimate of the expectile at the intermediate level.</p>


<h3>Usage</h3>

<pre><code class='language-R'>estExpectiles(data, tau, method="LAWS", tailest="Hill", var=FALSE, varType="asym-Dep-Adj",
              bigBlock=NULL, smallBlock=NULL, k=NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estExpectiles_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations.</p>
</td></tr>
<tr><td><code id="estExpectiles_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExpectiles_+3A_method">method</code></td>
<td>
<p>A string specifying the method used to estimate the expecile. By default <code>est="LAWS"</code> specifies the use of the direct LAWS estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExpectiles_+3A_tailest">tailest</code></td>
<td>
<p>A string specifying the type of tail index estimator. By default <code>tailest="Hill"</code> specifies the use of Hill estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExpectiles_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the variance of the expectile estimator is computed.</p>
</td></tr>
<tr><td><code id="estExpectiles_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the asymptotic variance to compute. By default <code>varType="asym-Dep-Adj"</code> specifies the variance estimator for serial dependent observations implemented with a suitable adjustment. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExpectiles_+3A_bigblock">bigBlock</code></td>
<td>
<p>An interger specifying the size of the big-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExpectiles_+3A_smallblock">smallBlock</code></td>
<td>
<p>An interger specifying the size of the small-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExpectiles_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExpectiles_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence interval for the expecile at the intermedite level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of sample size <code class="reqn">n</code>, an estimate of the <code class="reqn">\tau_n</code>-<em>th</em> expectile is computed. Two estimators are available: the so-called direct Least Asymmetrically Weighted Squares (LAWS) and indirect Quantile-Based (QB). The definition of the QB estimator depends on the estimation of the tail index <code class="reqn">\gamma</code>. Here, <code class="reqn">\gamma</code> is estimated using the Hill estimation (see <a href="#topic+HTailIndex">HTailIndex</a>) or in alternative using the the expectile based estimator (see <a href="#topic+EBTailIndex">EBTailIndex</a>). The observations can be either independent or temporal dependent. See Section 3.1 in Padoan and Stupfler (2020) for details.
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. Practically, <code class="reqn">\tau_n \in (0,1)</code> is the ratio between <em>N</em> (Numerator) and <em>D</em> (Denominator). Where <em>N</em> is the empirical mean distance of the <code class="reqn">\tau_n</code>-<em>th</em> expectile from the observations smaller than it, and <em>D</em> is the empirical mean distance of <code class="reqn">\tau_n</code>-<em>th</em> expectile from all the observations.
</p>
</li>
<li><p> If <code>method='LAWS'</code>, then the expectile at the intermediate level <code class="reqn">\tau_n</code> is estimated applying the direct LAWS estimator. Instead, If <code>method='QB'</code> the indirect QB esimtator is used to estimate the expectile. See Section 3.1 in Padoan and Stupfler (2020) for details.
</p>
</li>
<li><p> When the expectile is estimated by the indirect QB esimtator (<code>method='QB'</code>), an estimate of the tail index <code class="reqn">\gamma</code> is needed. If <code>tailest='Hill'</code> then <code class="reqn">\gamma</code> is estimated using the Hill estimator (see also <a href="#topic+HTailIndex">HTailIndex</a>). If <code>tailest='ExpBased'</code> then <code class="reqn">\gamma</code> is estimated using the expectile based estimator (see <a href="#topic+EBTailIndex">EBTailIndex</a>). See Section 3.1 in Padoan and Stupfler (2020) for details.
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, when <code>method='LAWS'</code> and <code>tau=NULL</code>, <code class="reqn">k_n</code> specifies by <code class="reqn">\tau_n=1-k_n/n</code> the intermediate level of the expectile. Instead, when <code>method='QB'</code>, if <code>tailest="Hill"</code> then the value <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics to be used to estimate <code class="reqn">\gamma</code> by the Hill estimator and if <code>tau=NULL</code> then it also specifies by <code class="reqn">\tau_n=1-k_n/n</code> the confidence level <code class="reqn">\tau_n</code> of the quantile to estimate. Finally, if <code>tailest="ExpBased"</code> and <code>tau=NULL</code> then it also specifies by <code class="reqn">\tau_n=1-k_n/n</code> the intermediate level expectile based esitmator of <code class="reqn">\gamma</code> (see <a href="#topic+EBTailIndex">EBTailIndex</a>).
</p>
</li>
<li><p> If <code>var=TRUE</code> then the asymptotic variance of the expecile estimator is computed. With independent observations the asymptotic variance is computed by the formula Theorem 3.1 of Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Ind"</code>. With serial dependent observations the asymptotic variance is estimated by the formula in Theorem 3.1 of Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Dep"</code>. In this latter case the computation of the asymptotic variance is based on the &quot;big blocks seperated by small blocks&quot; techinque which is a standard tools in time series, see Leadbetter et al. (1986). See also Section C.1 in Appendix of Padoan and Stupfler (2020). The size of the big and small blocks are specified by the parameters <code>bigblock</code> and <code>smallblock</code>, respectively. Still with serial dependent observations, If <code>varType="asym-Dep-Adj"</code>, then the asymptotic variance is estimated using formula (C.79) in Padoan and Stupfler (2020), see Section C.1 of the Appendix for details.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an asymptotic confidence interval for the <code class="reqn">\tau_n</code>-<em>th</em> expectile, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code> is computed. See Sections 3.1 and C.1 in the Appendix of Padoan and Stupfler (2020).
</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>ExpctHat</code>: a point estimate of the <code class="reqn">\tau_n</code>-<em>th</em> expecile;
</p>
</li>
<li> <p><code>VarExpHat</code>: an estimate of the asymptotic variance of the expectile estimator;
</p>
</li>
<li> <p><code>CIExpct</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\tau_n</code>-<em>th</em> expecile.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>
<p>Daouia, A., Girard, S. and Stupfler, G. (2018). Estimation of tail risk based on extreme expectiles. <em>Journal of the Royal Statistical Society: Series B</em>, <b>80</b>, 263-292.
</p>
<p>Leadbetter, M.R., Lindgren, G. and Rootzen, H. (1989). Extremes and related
properties of random sequences and processes. <em>Springer</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+HTailIndex">HTailIndex</a>,  <a href="#topic+EBTailIndex">EBTailIndex</a>, <a href="#topic+predExpectiles">predExpectiles</a>, <a href="#topic+extQuantile">extQuantile</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extreme expectile estimation at the intermediate level tau obtained with
# 1-dimensional data simulated from an AR(1) with Student-t innovations

tsDist &lt;- "studentT"
tsType &lt;- "AR"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallBlock &lt;- 15

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.99

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rtimeseries(ndata, tsDist, tsType, par)

# High expectile (intermediate level) estimation
expectHat &lt;- estExpectiles(data, tau, var=TRUE, bigBlock=bigBlock, smallBlock=smallBlock)
expectHat$ExpctHat
expectHat$CIExpct
</code></pre>

<hr>
<h2 id='estExtLevel'>Extreme Level Estimation</h2><span id='topic+estExtLevel'></span>

<h3>Description</h3>

<p>Estimates the expectile's extreme level corresponding to a quantile's extreme level.</p>


<h3>Usage</h3>

<pre><code class='language-R'>estExtLevel(alpha_n, data=NULL, gammaHat=NULL, VarGamHat=NULL, tailest="Hill", k=NULL,
            var=FALSE, varType="asym-Dep", bigBlock=NULL, smallBlock=NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estExtLevel_+3A_alpha_n">alpha_n</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the extreme level <code class="reqn">\alpha_n</code> for the quantile. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations to be used to estimate the tail index in the case it is not provided. By default <code>data=NULL</code> specifies that no data are given.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_gammahat">gammaHat</code></td>
<td>
<p>A real specifying an estimate of the tail index. By default <code>gammaHat=NULL</code> specifies that no estimate is given. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_vargamhat">VarGamHat</code></td>
<td>
<p>A real specifying an estimate of the variance of the tail index estimate. By default <code>VarGamHat=NULL</code> specifies that no estimate is given. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_tailest">tailest</code></td>
<td>
<p>A string specifying the type of tail index estimator to be used. By default <code>tailest="Hill"</code> specifies the use of Hill estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the variance of the extreme level estimator is computed.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the asymptotic variance to compute. By default <code>varType="asym-Dep"</code> specifies the variance estimator for serial dependent observations. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_bigblock">bigBlock</code></td>
<td>
<p>An interger specifying the size of the big-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_smallblock">smallBlock</code></td>
<td>
<p>An interger specifying the size of the small-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estExtLevel_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence interval for the expecile at the intermedite level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a given extreme level <code class="reqn">\alpha_n</code> for the <code class="reqn">\alpha_n</code>-<em>th</em> quantile, an estimate of the extreme level <code class="reqn">\tau_n'(\alpha_n)</code> is computed such that <code class="reqn">\xi_{\tau_n'(\alpha_n)}=q_{\alpha_n}</code>. The estimator is defined by
</p>
<p><code class="reqn">\hat{\tau}_n'(\alpha_n) = 1 - (1 - \alpha_n)\frac{\hat{\gamma}_n}{1-\hat{\gamma}_n}</code>
</p>
<p>where <code class="reqn">\hat{\gamma}_n</code> is a consistent estimator of the tail index <code class="reqn">\gamma</code>. If a value for the parameter <code>gammaHat</code> is given, then such a value is used to compute <code class="reqn">\hat{\tau}_n'</code>. If <code>gammaHat</code> is <code>NULL</code> and a dataset is provided through the parameter <code>data</code>, then the tail index <code class="reqn">\gamma</code> is estimated by a suitable estimator <code class="reqn">\hat{\gamma}_n</code>. See Section 6 in Padoan and Stupfler (2020) for more details.
</p>

<ul>
<li><p> If <code>VarGamHat</code> is specified, i.e. the variance of the tail index estimator, then the variance of the extreme level estimator <code class="reqn">\hat{\tau}_n'</code> is computed by using such value.
</p>
</li>
<li><p> When estimating the tail index, if <code>tailest='Hill'</code> then <code class="reqn">\gamma</code> is estimated using the Hill estimator (see also <a href="#topic+HTailIndex">HTailIndex</a>). If <code>tailest='ML'</code> then <code class="reqn">\gamma</code> is estimated using the Maximum Likelihood estimator (see <a href="#topic+MLTailIndex">MLTailIndex</a>).
If <code>tailest='ExpBased'</code> then <code class="reqn">\gamma</code> is estimated using the expectile based estimator (see <a href="#topic+EBTailIndex">EBTailIndex</a>).
If <code>tailest='Moment'</code> then <code class="reqn">\gamma</code> is estimated using the moment based estimator (see <a href="#topic+MomTailIndex">MomTailIndex</a>). See Padoan and Stupfler (2020) for details.
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, when <code>tailest="Hill"</code> then the value <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics to be used to estimate <code class="reqn">\gamma</code> by the Hill estimator. See <a href="#topic+MLTailIndex">MLTailIndex</a>, <a href="#topic+EBTailIndex">EBTailIndex</a> and <a href="#topic+MomTailIndex">MomTailIndex</a> for the other estimators.
</p>
</li>
<li><p> If <code>var=TRUE</code> then the asymptotic variance of the extreme level estimator is computed by applying the delta method, i.e.
</p>
<p><code class="reqn">Var(\tau_n') = Var(\hat{\gamma}_n) * (\alpha_n-1)^2 / (1-\hat{\gamma}_n)^4</code>
</p>
<p>where <code class="reqn">Var(\hat{\gamma}_n</code> is provided by <code>VarGamHat</code> or is estimated when esitmating the tail index through <code>tailest='Hill'</code> and <code>tailest='ML'</code>. See  <a href="#topic+HTailIndex">HTailIndex</a> and <a href="#topic+MLTailIndex">MLTailIndex</a> for details on how the variance is computed.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an asymptotic confidence interval for the extreme level, <code class="reqn">\tau_n'(\alpha_n)</code>, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code> is computed.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>tauHat</code>: an estimate of the extreme level <code class="reqn">\tau_n'</code>;
</p>
</li>
<li> <p><code>tauVar</code>: an estimate of the asymptotic variance of the extreme level estimator <code class="reqn">\hat{\tau}_n'(\alpha_n)</code>;
</p>
</li>
<li> <p><code>tauCI</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for the extreme level <code class="reqn">\tau_n'(\alpha_n)</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>
<p>Daouia, A., Girard, S. and Stupfler, G. (2018). Estimation of tail risk based on extreme expectiles. <em>Journal of the Royal Statistical Society: Series B</em>, <b>80</b>, 263-292.
</p>


<h3>See Also</h3>

<p><a href="#topic+estExpectiles">estExpectiles</a>, <a href="#topic+predExpectiles">predExpectiles</a>, <a href="#topic+extQuantile">extQuantile</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extreme level estimation for a given quantile's extreme level alpha_n
# obtained with 1-dimensional data simulated from an AR(1) with Student-t innovations

tsDist &lt;- "studentT"
tsType &lt;- "AR"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallBlock &lt;- 15

# quantile's extreme level
alpha_n &lt;- 0.999

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rtimeseries(ndata, tsDist, tsType, par)

# expectile's extreme level estimation
tau1Hat &lt;- estExtLevel(alpha_n, data, var=TRUE, k=150, bigBlock=bigBlock,
                       smallBlock=smallBlock)
tau1Hat
</code></pre>

<hr>
<h2 id='estMultiExpectiles'>Multidimensional High Expectile Estimation</h2><span id='topic+estMultiExpectiles'></span>

<h3>Description</h3>

<p>Computes point estimates and <code class="reqn">(1-\alpha)100\%</code> confidence regions for <code>d</code>-dimensional expectiles at the intermediate level.</p>


<h3>Usage</h3>

<pre><code class='language-R'>estMultiExpectiles(data, tau, method="LAWS", tailest="Hill", var=FALSE,
                   varType="asym-Ind-Adj", k=NULL, alpha=0.05, plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estMultiExpectiles_+3A_data">data</code></td>
<td>
<p>A matrix of <code class="reqn">(n \times d)</code> observations.</p>
</td></tr>
<tr><td><code id="estMultiExpectiles_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estMultiExpectiles_+3A_method">method</code></td>
<td>
<p>A string specifying the method used to estimate the expecile. By default <code>est="LAWS"</code> specifies the use of the direct LAWS estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estMultiExpectiles_+3A_tailest">tailest</code></td>
<td>
<p>A string specifying the type of tail index estimator. By default <code>tailest="Hill"</code> specifies the use of Hill estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estMultiExpectiles_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the variance of the expectile estimator is computed.</p>
</td></tr>
<tr><td><code id="estMultiExpectiles_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the asymptotic variance-covariance matrix to compute. By default <code>varType="asym-Ind-Adj"</code> specifies that the variance-covariance matrix is computed assuming dependent variables and exploiting a suitable adjustment. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estMultiExpectiles_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="estMultiExpectiles_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence region for the <code>d</code>-dimensional expecile at the intermedite level.</p>
</td></tr>
<tr><td><code id="estMultiExpectiles_+3A_plot">plot</code></td>
<td>
<p>A logical value. By default <code>plot=FALSE</code> specifies that no graphical representation of the estimates is not provided. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of <code>d</code>-dimensional observations and sample size <code class="reqn">n</code>, an estimate of the <code class="reqn">\tau_n</code>-<em>th</em> <code>d</code>-dimensional is computed. Two estimators are available: the so-called direct Least Asymmetrically Weighted Squares (LAWS) and indirect Quantile-Based (QB). The QB estimator depends on the estimation of the <code>d</code>-dimensional tail index <code class="reqn">\gamma</code>. Here, <code class="reqn">\gamma</code> is estimated using the Hill estimator (see <a href="#topic+MultiHTailIndex">MultiHTailIndex</a>). The data are regarded as <code>d</code>-dimensional temporal independent observations coming from dependent variables. See Padoan and Stupfler (2020) for details.
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. Practically, for each individual marginal distribution <code class="reqn">\tau_n \in (0,1)</code> is the ratio between <em>N</em> (Numerator) and <em>D</em> (Denominator). Where <em>N</em> is the empirical mean distance of the <code class="reqn">\tau_n</code>-<em>th</em> expectile from the observations smaller than it, and <em>D</em> is the empirical mean distance of <code class="reqn">\tau_n</code>-<em>th</em> expectile from all the observations.
</p>
</li>
<li><p> If <code>method='LAWS'</code>, then the expectile at the intermediate level <code class="reqn">\tau_n</code> is estimated applying the direct LAWS estimator. Instead, If <code>method='QB'</code> the indirect QB esimtator is used to estimate the expectile. See Section 2.1 in Padoan and Stupfler (2020) for details.
</p>
</li>
<li><p> When the expectile is estimated by the indirect QB esimtator (<code>method='QB'</code>), an estimate of the <code>d</code>-dimensional tail index <code class="reqn">\gamma</code> is needed. Here the <code>d</code>-dimensional tail index <code class="reqn">\gamma</code> is estimated using the <code>d</code>-dimensional Hill estimator (<code>tailest='Hill'</code>, see <a href="#topic+MultiHTailIndex">MultiHTailIndex</a>). This is the only available option so far (soon more results will be available).
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, for each marginal distribution, when <code>method='LAWS'</code> and <code>tau=NULL</code>, <code class="reqn">k_n</code> specifies by <code class="reqn">\tau_n=1-k_n/n</code> the intermediate level of the expectile. Instead, for each marginal distribution, when <code>method='QB'</code>, then the value <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics to be used to estimate <code class="reqn">\gamma</code> by the Hill estimator and if <code>tau=NULL</code> then it also specifies by <code class="reqn">\tau_n=1-k_n/n</code> the confidence level <code class="reqn">\tau_n</code> of the quantile to estimate.
</p>
</li>
<li><p> If <code>var=TRUE</code> then an estimate of the asymptotic variance-covariance matrix of the <code>d</code>-dimensional expecile estimator is computed. If the data are regarded as <code>d</code>-dimensional temporal independent observations coming from dependent variables. Then, the asymptotic variance-covariance matrix is estimated by the formulas in section 3.1 of Padoan and Stupfler (2020). In particular, the variance-covariance matrix is computed exploiting the asymptotic behaviour of the relative explectile estimator appropriately normalized and using a suitable adjustment. This is achieved through <code>varType="asym-Ind-Adj"</code>. The data can also be regarded as coded-dimensional temporal independent observations coming from independent variables. In this case the asymptotic variance-covariance matrix is diagonal and is also computed exploiting the formulas in section 3.1 of Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Ind"</code>.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an asymptotic confidence region for the <code class="reqn">\tau_n</code>-<em>th</em> expectile, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code> is computed. In particular, a &quot;symmetric&quot; confidence regions is computed exploiting the asymptotic behaviour of the relative explectile estimator appropriately normalized. See Sections 3.1 of Padoan and Stupfler (2020) for detailed.
</p>
</li>
<li><p> If <code>plot=TRUE</code> then a graphical representation of the estimates is not provided.</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>ExpctHat</code>: an point estimate of the <code class="reqn">\tau_n</code>-<em>th</em> <code>d</code>-dimensional expecile;
</p>
</li>
<li> <p><code>biasTerm</code>: an point estimate of the bias term of the estimated expecile;
</p>
</li>
<li> <p><code>VarCovEHat</code>: an estimate of the asymptotic variance of the expectile estimator;
</p>
</li>
<li> <p><code>EstConReg</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence region for <code class="reqn">\tau_n</code>-<em>th</em> <code>d</code>-dimensional expecile.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Joint inference on extreme expectiles for multivariate
heavy-tailed distributions. <em>arXiv e-prints</em> arXiv:2007.08944, <a href="https://arxiv.org/abs/2007.08944">https://arxiv.org/abs/2007.08944</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+MultiHTailIndex">MultiHTailIndex</a>,  <a href="#topic+predMultiExpectiles">predMultiExpectiles</a>, <a href="#topic+extMultiQuantile">extMultiQuantile</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extreme expectile estimation at the intermediate level tau obtained with
# d-dimensional observations simulated from a joint distribution with
# a Gumbel copula and equal Frechet marginal distributions.
library(plot3D)
library(copula)
library(evd)

# distributional setting
copula &lt;- "Gumbel"
dist &lt;- "Frechet"

# parameter setting
dep &lt;- 3
dim &lt;- 3
scale &lt;- rep(1, dim)
shape &lt;- rep(3, dim)
par &lt;- list(dep=dep, scale=scale, shape=shape, dim=dim)

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- .95

# sample size
ndata &lt;- 1000

# Simulates a sample from a multivariate distribution with equal Frechet
# marginals distributions and a Gumbel copula
data &lt;- rmdata(ndata, dist, copula, par)
scatter3D(data[,1], data[,2], data[,3])

# High d-dimensional expectile (intermediate level) estimation
expectHat &lt;- estMultiExpectiles(data, tau, var=TRUE)
expectHat$ExpctHat
expectHat$VarCovEHat
# run the following command to see the graphical representation

 expectHat &lt;- estMultiExpectiles(data, tau, var=TRUE, plot=TRUE)

</code></pre>

<hr>
<h2 id='expectiles'>Expectile Computation</h2><span id='topic+expectiles'></span>

<h3>Description</h3>

<p>Computes the true expectile for some families of parametric models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>expectiles(par, tau, tsDist="gPareto", tsType="IID", trueMethod="true",
           estMethod="LAWS", nrep=1e+05, ndata=1e+06, burnin=1e+03)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expectiles_+3A_par">par</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times p)</code> parameters of the time series parametric family. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="expectiles_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the level <code class="reqn">\tau</code> of the expectile to be computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="expectiles_+3A_tsdist">tsDist</code></td>
<td>
<p>A string specifying the parametric family of the innovations distribution. By default <code>tsDist="gPareto"</code> specifies a
Pareto family of distributions. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="expectiles_+3A_tstype">tsType</code></td>
<td>
<p>A string specifying the type of time series. By default <code>tsType="IID"</code> specifies a sequence of independent and indentically distributed random variables. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="expectiles_+3A_truemethod">trueMethod</code></td>
<td>
<p>A string specifying the method used to computed the expecile. By default <code>trueMethod="true"</code> specifies that the true analytical expression to computed the expectile is used. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="expectiles_+3A_estmethod">estMethod</code></td>
<td>
<p>A string specifying the method used to estimate the expecile. By default <code>est="LAWS"</code> specifies the use of the direct LAWS estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="expectiles_+3A_nrep">nrep</code></td>
<td>
<p>A positive interger specifying the number of simulations to use for computing an approximation of the expectile. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="expectiles_+3A_ndata">ndata</code></td>
<td>
<p>A positive interger specifying the number of observations to genreated for each simulation. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="expectiles_+3A_burnin">burnin</code></td>
<td>
<p>A positive interger specifying the number of initial observations to discard from the simulated sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a parametric family of time series models or a parametric family of distributions (for the case of independent observations) the <code class="reqn">\tau</code>-<em>th</em> expectile (or expectile of level <code>tau</code>) is computed.
</p>

<ul>
<li><p> There are two methods to compute the <code class="reqn">\tau</code>-<em>th</em> expectile. For the Generalised Pareto and Student-<em>t</em> parametric families of distributions, the analytical epxression of the expectile is available. This is used to compute the <code class="reqn">\tau</code>-<em>th</em> expectile if the parameter <code>trueMethod="true"</code> is specified. For most of parametric family of distributions or parametric families of time series models the analytical epxression of the expectile is not available. In this case an approximate value of the <code class="reqn">\tau</code>-<em>th</em> expectile is computed via a Monte Carlo method if the parameter <code>trueMethod=="approx"</code> is specified. In particular, <code>ndata</code> observations from a family of time series models (e.g. <code>tsType="AR"</code> and <code>tsDist="studentT"</code>) or a sequence of independent and indentically distributed random variables with common family of distributions (e.g. <code>tsType="IID"</code> and <code>tsDist="gPareto"</code>) are simulated <code>nrep</code> times. For each simulation the <code class="reqn">\tau</code>-<em>th</em> expectile is estimate by the estimation method specified by <code>estMethod</code>. The mean of such estimate provides an approximate value of the <code class="reqn">\tau</code>-<em>th</em> expectile. The available estimator to esitmate the expecile are the direct LAWS (<code>estMethod="LAWS"</code>) and the indirect QB (<code>estMethod="QB"</code>), see <a href="#topic+estExpectiles">estExpectiles</a> for details. The available families of distributions are: Generalised Pareto (<code>tsDist="gPareto"</code>), Student-<em>t</em> (<code>tsDist="studentT"</code>) and Frechet (<code>tsDist="Frechet"</code>). The available classes of time series with parametric innovations families of distributions are specified in <a href="#topic+rtimeseries">rtimeseries</a>.
</p>
</li></ul>



<h3>Value</h3>

<p>The <code class="reqn">\tau</code>-<em>th</em> expectile.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+rtimeseries">rtimeseries</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Derivation of the true tau-th expectile for the Pareto distribution
# via accurate simulation

# parameter value
par &lt;- c(1, 0.3)

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.99

trueExp &lt;- expectiles(par, tau)
trueExp


# tau-th expectile of the AR(1) with Student-t innovations
tsDist &lt;- "studentT"
tsType &lt;- "AR"

# Approximation via Monte Carlo methods
trueMethod &lt;- "approx"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.99

trueExp &lt;- expectiles(par, tau, tsDist, tsType, trueMethod)
trueExp

</code></pre>

<hr>
<h2 id='ExpectMES'>Marginal Expected Shortfall Expectile Based Estimation</h2><span id='topic+ExpectMES'></span>

<h3>Description</h3>

<p>Computes a point and interval estimate of the Marginal Expected Shortfall (MES) using an expectile based approach.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExpectMES(data, tau, tau1, method="LAWS", var=FALSE, varType="asym-Dep", bias=FALSE,
          bigBlock=NULL, smallBlock=NULL, k=NULL, alpha_n=NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExpectMES_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_tau1">tau1</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the extreme level <code class="reqn">\tau'_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_method">method</code></td>
<td>
<p>A string specifying the method used to estimate the expecile. By default <code>est="LAWS"</code> specifies the use of the LAWS based estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the asymptotic variance of the MES estimator is computed.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the type of asymptotic variance to compute. By default <code>varType="asym-Dep"</code> specifies the variance estimator for serial dependent observations. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_bias">bias</code></td>
<td>
<p>A logical value. By default <code>bias=FALSE</code> specifies that no bias correction is computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_bigblock">bigBlock</code></td>
<td>
<p>An interger specifying the size of the big-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_smallblock">smallBlock</code></td>
<td>
<p>An interger specifying the size of the small-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_alpha_n">alpha_n</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the quantile's extreme level to be use in order to estimate the expectile's extreme level.</p>
</td></tr>
<tr><td><code id="ExpectMES_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence interval for the expecile at the intermedite level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of sample size <code class="reqn">n</code>, an estimate of the <code class="reqn">\tau'_n</code>-<em>th</em> MES is computed. The estimation of the MES at the extreme level <code>tau1</code> (<code class="reqn">\tau'_n</code>) is indeed meant to be a prediction.  Two estimators are available: the so-called Least Asymmetrically Weighted Squares (LAWS) based estimator and the Quantile-Based (QB) estimator. The definition of both estimators depends on the estimation of the tail index <code class="reqn">\gamma</code>. Here, <code class="reqn">\gamma</code> is estimated using the Hill estimation (see <a href="#topic+HTailIndex">HTailIndex</a> for details).
The observations can be either independent or temporal dependent. See Section 4 in Padoan and Stupfler (2020) for details.
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. See <a href="#topic+predExpectiles">predExpectiles</a> for details.
</p>
</li>
<li><p> The so-called extreme level <code>tau1</code> or <code class="reqn">\tau'_n</code> is a sequence of positive reals such that <code class="reqn">\tau'_n \to 1</code> as <code class="reqn">n \to \infty</code>. See <a href="#topic+predExpectiles">predExpectiles</a> for details.
</p>
</li>
<li><p> When <code>method='LAWS'</code>, then the <code class="reqn">\tau'_n</code>-<em>th</em> MES is estimated using the LAWS based estimator. When <code>method='QB'</code>, the expectile is instead estimated using the QB esimtator. See Sectino 4 in Padoan and Stupfler (2020) and in particular Corollary 4.3 and 4.4 for details. The definition of both estimators depend on the estimation of the tail index <code class="reqn">\gamma</code>. In particular, the tail index <code class="reqn">\gamma</code> is estimated using the Hill estimator (see <a href="#topic+HTailIndex">HTailIndex</a>).
</p>
</li>
<li><p> If <code>var=TRUE</code> then an esitmate of the asymptotic variance of the <code class="reqn">tau'_n</code>-<em>th</em> MES is computed. Notice that the estimation of the asymptotic variance <b>is only available</b> when <code class="reqn">\gamma</code> is estimated using the Hill estimator (see <a href="#topic+HTailIndex">HTailIndex</a>). With independent observations the asymptotic variance is estimated by <code class="reqn">\hat{\gamma}^2</code>, see Corollary 4.3 in Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Ind"</code>.  With serial dependent observations the asymptotic variance is estimated by the formula in Corollary 4.3 of Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Dep"</code>. See Section 4 adn 5 in Padoan and Stupfler (2020) for details. In this latter case the computation of the serial dependence is based on the &quot;big blocks seperated by small blocks&quot; techinque which is a standard tools in time series, see e.g. Leadbetter et al. (1986).
The size of the big and small blocks are specified by the parameters <code>bigBlock</code> and <code>smallBlock</code>, respectively.
</p>
</li>
<li><p> If <code>bias=TRUE</code> then <code class="reqn">\gamma</code> is estimated using formula (4.2) of Haan et al. (2016). This is used by the LAWS and QB estimators. Furthermore, the <code class="reqn">\tau'_n</code>&ndash;<em>th</em> quantile is estimated using the formula in page 330 of de Haan et al. (2016). This provides a bias corrected version of the Weissman estimator. This is used by the QB estimator.
However, in this case the asymptotic variance is not estimated using the formula in Haan et al. (2016) Theorem 4.2. Instead, for simplicity the asymptotic variance is estimated by the formula in Corollary 3.8, with serial dependent observations, and <code class="reqn">\hat{\gamma}^2</code> with independent observation (see e.g. de Drees 2000, for the details).
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, when <code>tau=NULL</code> and <code>method='LAWS'</code>, then <code class="reqn">\tau_n=1-k_n/n</code> is the intermediate level of the expectile to be stimated. <code class="reqn">k_n</code> also specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics used in the definition of the Hill estimator (see <a href="#topic+HTailIndex">HTailIndex</a> for detail). Differently, When <code>tau=NULL</code> and <code>method='QB'</code>, then <code class="reqn">\tau_n=1-k_n/n</code> is the intermediate level of the quantile to be stimated.
</p>
</li>
<li><p> If the quantile's extreme level is provided by <code>alpha_n</code>, then expectile's extreme level <code class="reqn">tau'_n</code> is replaced by <code class="reqn">tau'_n(\alpha_n)</code> which is estimated by the method described in Section 6 of Padoan and Stupfler (2020). See <a href="#topic+estExtLevel">estExtLevel</a> for details.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an estimate of an asymptotic confidence interval for <code class="reqn">tau'_n</code>-<em>th</em> expectile, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code>, is computed. The confidence intervals are computed exploiting formula in Corollary 4.3, 4.4 and Theorem 6.2 of Padoan and Stupfler (2020) and (46) in Drees (2003). See Sections 4-6 in Padoan and Stupfler (2020) for details. When <code>biast=TRUE</code> confidence intervals are computed in the same way but after correcting the tail index estimate by an estimate of the bias term, see formula (4.2) in de Haan et al. (2016) for details.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>HatXMES</code>: an estimate of the <code class="reqn">\tau'_n</code>-<em>th</em> expectile based MES;
</p>
</li>
<li> <p><code>VarHatXMES</code>: an estimate of the asymptotic variance of the expectile based MES estimator;
</p>
</li>
<li> <p><code>CIHatXMES</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\tau'_n</code>-<em>th</em> MES.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>
<p>Daouia, A., Girard, S. and Stupfler, G. (2018). Estimation of tail risk based on extreme expectiles. <em>Journal of the Royal Statistical Society: Series B</em>, <b>80</b>, 263-292.
</p>
<p>de Haan, L., Mercadier, C. and Zhou, C. (2016). Adapting extreme value statistics
tonancial time series: dealing with bias and serial dependence. <em>Finance and Stochastics</em>,
<b>20</b>, 321-354.
</p>
<p>Drees, H. (2003). Extreme quantile estimation for dependent data, with applications to finance.
<em>Bernoulli</em>, <b>9</b>, 617-657.
</p>
<p>Drees, H. (2000). Weighted approximations of tail processes for <code class="reqn">\beta</code>-mixing random variables.
<em>Annals of Applied Probability</em>, <b>10</b>, 1274-1301.
</p>
<p>Leadbetter, M.R., Lindgren, G. and Rootzen, H. (1989). Extremes and related
properties of random sequences and processes. <em>Springer</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+QuantMES">QuantMES</a>, <a href="#topic+HTailIndex">HTailIndex</a>,  <a href="#topic+predExpectiles">predExpectiles</a>, <a href="#topic+extQuantile">extQuantile</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Marginl Expected Shortfall expectile based estimation at the extreme level
# obtained with 2-dimensional data simulated from an AR(1) with bivariate
# Student-t distributed innovations

tsDist &lt;- "AStudentT"
tsType &lt;- "AR"
tsCopula &lt;- "studentT"

# parameter setting
corr &lt;- 0.8
dep &lt;- 0.8
df &lt;- 3
par &lt;- list(corr=corr, dep=dep, df=df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallBlock &lt;- 15

# quantile's extreme level
alpha_n &lt;- 0.999

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rbtimeseries(ndata, tsDist, tsType, tsCopula, par)


# Extreme MES expectile based estimation
MESHat &lt;- ExpectMES(data, NULL, NULL, var=TRUE, k=150, bigBlock=bigBlock,
                    smallBlock=smallBlock, alpha_n=alpha_n)
MESHat

</code></pre>

<hr>
<h2 id='extMultiQuantile'>Multidimensional Value-at-Risk (VaR) or Extreme Quantile (EQ) Estimation</h2><span id='topic+extMultiQuantile'></span>

<h3>Description</h3>

<p>Computes point estimates and <code class="reqn">(1-\alpha)100\%</code> confidence regions for <code>d</code>-dimensional VaR based on the Weissman estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>extMultiQuantile(data, tau, tau1, var=FALSE, varType="asym-Ind-Log", bias=FALSE,
                 k=NULL, alpha=0.05, plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extMultiQuantile_+3A_data">data</code></td>
<td>
<p>A matrix of <code class="reqn">(n \times d)</code> observations.</p>
</td></tr>
<tr><td><code id="extMultiQuantile_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extMultiQuantile_+3A_tau1">tau1</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the extreme level <code class="reqn">\tau'_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extMultiQuantile_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the asymptotic variance-covariance matrix of the <code>d</code>-dimensional VaR estimator is computed.</p>
</td></tr>
<tr><td><code id="extMultiQuantile_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the type of asymptotic variance-covariance matrix to compute. By default <code>varType="asym-Ind-Log"</code> specifies that the variance-covariance matrix is obtained assuming dependent variables and exploiting the logarithmic scale. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extMultiQuantile_+3A_bias">bias</code></td>
<td>
<p>A logical value. By default <code>biast=FALSE</code> specifies that no bias correction is computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extMultiQuantile_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extMultiQuantile_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence region for the <code>d</code>-dimensional VaR.</p>
</td></tr>
<tr><td><code id="extMultiQuantile_+3A_plot">plot</code></td>
<td>
<p>A logical value. By default <code>plot=FALSE</code> specifies that no graphical representation of the estimates is not provided. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of <code>d</code>-dimensional observations and sample size <code class="reqn">n</code>, the VaR or EQ, correspoding to the extreme level <code>tau1</code>, is computed by applying the <code>d</code>-dimensional Weissman estimator. The definition of the Weissman estimator depends on the estimation of the <code>d</code>-dimensional tail index <code class="reqn">\gamma</code>. Here, <code class="reqn">\gamma</code> is estimated using the Hill estimation (see <a href="#topic+MultiHTailIndex">MultiHTailIndex</a>). The data are regarded as <code>d</code>-dimensional temporal independent observations coming from dependent variables. See Padoan and Stupfler (2020) for details.
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. Practically, for each variable, <code class="reqn">(1-\tau_n)\in (0,1)</code> is a small proportion of observations in the observed data sample that exceed the <code class="reqn">tau_n</code>-<em>th</em> empirical quantile. Such proportion of observations is used to estimate the individual <code class="reqn">tau_n</code>-<em>th</em> quantile and tail index <code class="reqn">\gamma</code>.
</p>
</li>
<li><p> The so-called extreme level <code>tau1</code> or <code class="reqn">\tau'_n</code> is a sequence of positive reals such that <code class="reqn">\tau'_n \to 1</code> as <code class="reqn">n \to \infty</code>.
For each variable, the value <code class="reqn">(1-tau'_n) \in (0,1)</code> is meant to be a small tail probability such that <code class="reqn">(1-\tau'_n)=1/n</code> or <code class="reqn">(1-\tau'_n) &lt; 1/n</code>. It is also assumed that <code class="reqn">n(1-\tau'_n) \to C</code> as <code class="reqn">n \to \infty</code>, where <code class="reqn">C</code> is a positive finite constant. The value <code class="reqn">C</code> is the expected number of exceedances of the individual <code class="reqn">\tau'_n</code>-<em>th</em> quantile. Typically, <code class="reqn">C \in (0,1)</code> which means that it is expected that there are no observations in a data sample exceeding the individual quantile of level <code class="reqn">(1-\tau_n')</code>.
</p>
</li>
<li><p> If <code>var=TRUE</code> then an estimate of the asymptotic variance-covariance matrix of the <code class="reqn">tau'_n</code>-<em>th</em> <code>d</code>-dimensional quantile is computed. The data are regarded as temporal independent observations coming from dependent variables. The asymptotic variance-covariance matrix is estimated exploiting the formula in Section 5 of Padoan and Stupfler (2020). In particular, the variance-covariance matrix is computed exploiting the asymptotic behaviour of the normalized quantile estimator which is expressed in logarithmic scale. This is achieved through <code>varType="asym-Ind-Log"</code>. If <code>varType="asym-Ind"</code> then the variance-covariance matrix is computed exploiting the asymptotic behaviour of the <code>d</code>-dimensional relative quantile estimator appropriately normalized (see formula in Section 5 of Padoan and Stupfler (2020)).
</p>
</li>
<li><p> If <code>bias=TRUE</code> then an estimate of each individual <code class="reqn">\tau'_n</code>&ndash;<em>th</em> quantile is estimated using the formula in page 330 of de Haan et al. (2016), which provides a bias corrected version of the Weissman estimator. However, in this case the asymptotic variance is not estimated using the formula in Haan et al. (2016) Theorem 4.2. For simplicity standard the variance-covariance matrix is still computed using formula in Section 5 of Padoan and Stupfler (2020).
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, for each marginal distribution, the value <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics to be used to estimate the individual <code class="reqn">\tau_n</code>-<em>th</em> empirical quantile and individual tail index <code class="reqn">\gamma_j</code> for <code class="reqn">j=1,\ldots,d</code>. The intermediate level <code class="reqn">\tau_n</code> can be seen defined as <code class="reqn">\tau_n=1-k_n/n</code>.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an estimate of an asymptotic confidence region for <code class="reqn">tau'_n</code>-<em>th</em> <code>d</code>-dimensional quantile, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code>, is computed. The confidence regions are computed exploiting the asymptotic behaviour of the normalized quantile estimator in logarithmic scale. This is an &quot;asymmetric&quot; region and it is achieved through <code>varType="asym-Ind-Log"</code>. A &quot;symmetric&quot; region is obtained exploiting the asymptotic behaviour of the relative quantile estimator appropriately normalized, see formula in Section 5 of Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Ind"</code>.
</p>
</li>
<li><p> If <code>plot=TRUE</code> then a graphical representation of the estimates is not provided.</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>ExtQHat</code>: an estimate of the <code>d</code>-dimensional VaR or <code class="reqn">\tau'_n</code>-<em>th</em> <code>d</code>-dimensional quantile;
</p>
</li>
<li> <p><code>VarCovExQHat</code>: an estimate of the asymptotic variance-covariance of the <code>d</code>-dimensional VaR estimator;
</p>
</li>
<li> <p><code>EstConReg</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence regions for the <code>d</code>-dimensional VaR.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Joint inference on extreme expectiles for multivariate
heavy-tailed distributions. <em>arXiv e-prints</em> arXiv:2007.08944, <a href="https://arxiv.org/abs/2007.08944">https://arxiv.org/abs/2007.08944</a>
</p>
<p>de Haan, L., Mercadier, C. and Zhou, C. (2016). Adapting extreme value statistics
to financial time series: dealing with bias and serial dependence. <em>Finance and Stochastics</em>,
<b>20</b>, 321-354.
</p>
<p>de Haan, L. and Ferreira, A. (2006). Extreme Value Theory: An Introduction. <em>Springer</em>-<em>Verlag</em>, New York.
</p>


<h3>See Also</h3>

<p><a href="#topic+MultiHTailIndex">MultiHTailIndex</a>,  <a href="#topic+estMultiExpectiles">estMultiExpectiles</a>, <a href="#topic+predMultiExpectiles">predMultiExpectiles</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extreme quantile estimation at the extreme level tau1 obtained with
# d-dimensional observations simulated from a joint distribution with
# a Gumbel copula and equal Frechet marginal distributions.
library(plot3D)
library(copula)
library(evd)

# distributional setting
copula &lt;- "Gumbel"
dist &lt;- "Frechet"

# parameter setting
dep &lt;- 3
dim &lt;- 3
scale &lt;- rep(1, dim)
shape &lt;- rep(3, dim)
par &lt;- list(dep=dep, scale=scale, shape=shape, dim=dim)

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.95
# Extreme level (or tail probability 1-tau1 of unobserved quantile)
tau1 &lt;- 0.9995

# sample size
ndata &lt;- 1000

# Simulates a sample from a multivariate distribution with equal Frechet
# marginals distributions and a Gumbel copula
data &lt;- rmdata(ndata, dist, copula, par)
scatter3D(data[,1], data[,2], data[,3])

# High d-dimensional expectile (intermediate level) estimation
extQHat &lt;- extMultiQuantile(data, tau, tau1, TRUE)

extQHat$ExtQHat
extQHat$VarCovExQHat
# run the following command to see the graphical representation

 extQHat &lt;- extMultiQuantile(data, tau, tau1, TRUE, plot=TRUE)

</code></pre>

<hr>
<h2 id='extQuantile'>Value-at-Risk (VaR) or Extreme Quantile (EQ) Estimation</h2><span id='topic+extQuantile'></span>

<h3>Description</h3>

<p>Computes a point and interval estimate of the VaR based on the Weissman estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>extQuantile(data, tau, tau1, var=FALSE, varType="asym-Dep", bias=FALSE, bigBlock=NULL,
            smallBlock=NULL, k=NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extQuantile_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations.</p>
</td></tr>
<tr><td><code id="extQuantile_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extQuantile_+3A_tau1">tau1</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the extreme level <code class="reqn">\tau'_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extQuantile_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the asymptotic variance of the VaR estimator is computed.</p>
</td></tr>
<tr><td><code id="extQuantile_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the type of asymptotic variance to compute. By default <code>varType="asym-Dep"</code> specifies the variance estimator for serial dependent observations. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extQuantile_+3A_bias">bias</code></td>
<td>
<p>A logical value. By default <code>biast=FALSE</code> specifies that no bias correction is computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extQuantile_+3A_bigblock">bigBlock</code></td>
<td>
<p>An interger specifying the size of the big-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extQuantile_+3A_smallblock">smallBlock</code></td>
<td>
<p>An interger specifying the size of the small-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extQuantile_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="extQuantile_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence interval for the VaR.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of sample size <code class="reqn">n</code>, the VaR or EQ, correspoding to the extreme level <code>tau1</code>, is computed by applying the Weissman estimator. The definition of the Weissman estimator depends on the estimation of the tail index <code class="reqn">\gamma</code>. Here, <code class="reqn">\gamma</code> is estimated using the Hill estimation (see <a href="#topic+HTailIndex">HTailIndex</a>). The observations can be either independent or temporal dependent (see e.g. de Haan and Ferreira 2006; Drees 2003; de Haan et al. 2016 for details).
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. Practically, <code class="reqn">(1-\tau_n)\in (0,1)</code> is a small proportion of observations in the observed data sample that exceed the <code class="reqn">tau_n</code>-<em>th</em> empirical quantile. Such proportion of observations is used to estimate the <code class="reqn">tau_n</code>-<em>th</em> quantile and <code class="reqn">\gamma</code>.
</p>
</li>
<li><p> The so-called extreme level <code>tau1</code> or <code class="reqn">\tau'_n</code> is a sequence of positive reals such that <code class="reqn">\tau'_n \to 1</code> as <code class="reqn">n \to \infty</code>.
The value <code class="reqn">(1-tau'_n) \in (0,1)</code> is meant to be a small tail probability such that <code class="reqn">(1-\tau'_n)=1/n</code> or <code class="reqn">(1-\tau'_n) &lt; 1/n</code>. It is also assumed that <code class="reqn">n(1-\tau'_n) \to C</code> as <code class="reqn">n \to \infty</code>, where <code class="reqn">C</code> is a positive finite constant. The value <code class="reqn">C</code> is the expected number of exceedances of the <code class="reqn">\tau'_n</code>-<em>th</em> quantile. Typically, <code class="reqn">C \in (0,1)</code> which means that it is expected that there are no observations in a data sample exceeding the quantile of level <code class="reqn">(1-\tau_n')</code>.
</p>
</li>
<li><p> If <code>var=TRUE</code> then an estimate of the asymptotic variance of the <code class="reqn">tau'_n</code>-<em>th</em> quantile is computed. With independent observations the asymptotic variance is estimated by the formula <code class="reqn">\hat{\gamma}^2</code> (see e.g. de Drees 2000, 2003, for details). This is achieved through <code>varType="asym-Ind"</code>. With serial dependent data the asymptotic variance is estimated by the formula in 1288 in Drees (2000). This is achieved through  <code>varType="asym-Dep"</code>. In this latter case the computation of the serial dependence is based on the &quot;big blocks seperated by small blocks&quot; techinque which is a standard tools in time series, see e.g. Leadbetter et al. (1986). The size of the big and small blocks are specified by the parameters <code>bigBlock</code> and <code>smallBlock</code>, respectively. With serial dependent data the asymptotic variance can also be estimated by formula (32) of Drees (2003). This is achieved through <code>varType="asym-Alt-Dep"</code>.
</p>
</li>
<li><p> If <code>bias=TRUE</code> then an estimate of the <code class="reqn">\tau'_n</code>&ndash;<em>th</em> quantile is computed using the formula in page 330 of de Haan et al. (2016), which provides a bias corrected version of the Weissman estimator. However, in this case the asymptotic variance is not estimated using the formula in Haan et al. (2016) Theorem 4.2. Instead, for simplicity standard formula in Drees (2000) page 1288 is used.
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, the value <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics to be used to estimate the <code class="reqn">\tau_n</code>-<em>th</em> empirical quantile and <code class="reqn">\gamma</code>. The intermediate level <code class="reqn">\tau_n</code> can be seen defined as <code class="reqn">\tau_n=1-k_n/n</code>.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an estimate of an asymptotic confidence interval for <code class="reqn">tau'_n</code>-<em>th</em> quantile, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code>, is computed. The confidence intervals are computed exploiting the formulas (33) and (46) of Drees (2003). When <code>biast=TRUE</code> confidence intervals are computed in the same way but after correcting the tail index estimate by an estimate of the bias term, see formula (4.2) in de Haan et al. (2016) for details. Furthermore, in this case with serial dependent data the asymptotic variance is estimated using the formula in Drees (2000) page 1288.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>ExtQHat</code>: an estimate of the VaR or <code class="reqn">\tau'_n</code>-<em>th</em> quantile;
</p>
</li>
<li> <p><code>VarExQHat</code>: an estimate of the asymptotic variance of the VaR estimator;
</p>
</li>
<li> <p><code>CIExtQ</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for the VaR.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>
<p>de Haan, L., Mercadier, C. and Zhou, C. (2016). Adapting extreme value statistics
tonancial time series: dealing with bias and serial dependence. <em>Finance and Stochastics</em>,
<b>20</b>, 321-354.
</p>
<p>de Haan, L. and Ferreira, A. (2006). Extreme Value Theory: An Introduction. <em>Springer</em>-<em>Verlag</em>, New York.
</p>
<p>Drees, H. (2000). Weighted approximations of tail processes for <code class="reqn">\beta</code>-mixing random variables.
<em>Annals of Applied Probability</em>, <b>10</b>, 1274-1301.
</p>
<p>Drees, H. (2003). Extreme quantile estimation for dependent data, with applications to finance.
<em>Bernoulli</em>, <b>9</b>, 617-657.
</p>
<p>Leadbetter, M.R., Lindgren, G. and Rootzen, H. (1989). Extremes and related
properties of random sequences and processes. <em>Springer</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+HTailIndex">HTailIndex</a>, <a href="#topic+EBTailIndex">EBTailIndex</a>, <a href="#topic+estExpectiles">estExpectiles</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extreme quantile estimation at the level tau1 obtained with 1-dimensional data
# simulated from an AR(1) with univariate Student-t distributed innovations

tsDist &lt;- "studentT"
tsType &lt;- "AR"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallBlock &lt;- 15

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.97
# Extreme level (or tail probability 1-tau1 of unobserved quantile)
tau1 &lt;- 0.9995

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rtimeseries(ndata, tsDist, tsType, par)

# VaR (extreme quantile) estimation
extQHat1 &lt;- extQuantile(data, tau, tau1, TRUE, bigBlock=bigBlock, smallBlock=smallBlock)
extQHat1$ExtQHat
extQHat1$CIExtQ

# VaR (extreme quantile) estimation with bias correction
extQHat2 &lt;- extQuantile(data, tau, tau1, TRUE, bias=TRUE, bigBlock=bigBlock, smallBlock=smallBlock)
extQHat2$ExtQHat
extQHat2$CIExtQ
</code></pre>

<hr>
<h2 id='HTailIndex'>Hill Tail Index Estimation</h2><span id='topic+HTailIndex'></span>

<h3>Description</h3>

<p>Computes a point and interval estimate of the tail index based on the Hill's estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>HTailIndex(data, k, var=FALSE, varType="asym-Dep", bias=FALSE, bigBlock=NULL,
           smallBlock=NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HTailIndex_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations.</p>
</td></tr>
<tr><td><code id="HTailIndex_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HTailIndex_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the variance of the tail index estimator is computed.</p>
</td></tr>
<tr><td><code id="HTailIndex_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the asymptotic variance to compute. By default <code>varType="asym-Dep"</code> specifies the variance estimator for serial dependent observations. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HTailIndex_+3A_bias">bias</code></td>
<td>
<p>A logical value. By default <code>biast=FALSE</code> specifies that no bias correction is computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HTailIndex_+3A_bigblock">bigBlock</code></td>
<td>
<p>An interger specifying the size of the big-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HTailIndex_+3A_smallblock">smallBlock</code></td>
<td>
<p>An interger specifying the size of the small-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HTailIndex_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence interval for the tail index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of sample size <code class="reqn">n</code>, the tail index <code class="reqn">\gamma</code> of its (marginal) distribution is computed by applying the Hill estimator. The observations can be either independent or temporal dependent.
</p>

<ul>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, the value <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics to be used to estimate <code class="reqn">\gamma</code>.
</p>
</li>
<li><p> If <code>var=TRUE</code> then an estimate of the asymptotic variance of the Hill estimator is computed. With independent observations the asymptotic variance is estimated by the formula <code class="reqn">\hat{\gamma}^2</code>, see Theorem 3.2.5 of de Haan and Ferreira (2006). This is achieved through <code>varType="asym-Ind"</code>. With serial dependent observations the asymptotic variance is estimated by the formula in 1288 in Drees (2000). This is achieved through <code>varType="asym-Dep"</code>. In this latter case the serial dependence is estimated by exploiting the &quot;big blocks seperated by small blocks&quot; techinque which is a standard tools in time series, see Leadbetter et al. (1986). See also formula (11) in Drees (2003). The size of the big and small blocks are specified by the parameters <code>bigBlock</code> and <code>smallBlock</code>, respectively.
</p>
</li>
<li><p> If <code>bias=TRUE</code> then an estimate of the bias term of the Hill estimator is computed implementing using formula (4.2) in de Haan et al. (2016). However, in this case the asymptotic variance is not estimated using the formula in Haan et al. (2016) Theorem 4.1. Instead for simplicity standard formulas have been used (see de Haan and Ferreira 2006 Theorem 3.2.5 and Drees 2000 page 1288).
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an estimate of an asymptotic confidence interval for <code class="reqn">\gamma</code>, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code>, is computed. The confidence intervals are computed exploiting the formulas in de Haan and Ferreira (2006) Theorem 3.2.5 and Drees (2000) page 1288. When <code>biast=TRUE</code> the confidence intervals are computed in the same way but after correcting the tail index estimate by an estimate of the bias term, see formula (4.2) in de Haan et al. (2016) for details.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>gammaHat</code>: an estimate of tail index <code class="reqn">\gamma</code>;
</p>
</li>
<li> <p><code>VarGamHat</code>: an estimate of the asymptotic variance of the Hill estimator;
</p>
</li>
<li> <p><code>BiasGamHat</code>: an estimate of bias term of the Hill estimator;
</p>
</li>
<li> <p><code>AdjExtQHat</code>: the adjustment to correct the Weissman estimator of an extreme quantile.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>
<p>de Haan, L., Mercadier, C. and Zhou, C. (2016). Adapting extreme value statistics
tonancial time series: dealing with bias and serial dependence. <em>Finance and Stochastics</em>,
<b>20</b>, 321-354.
</p>
<p>de Haan, L. and Ferreira, A. (2006). Extreme Value Theory: An Introduction. <em>Springer</em>-<em>Verlag</em>, New York.
</p>
<p>Drees, H. (2000). Weighted approximations of tail processes for <code class="reqn">\beta</code>-mixing random variables.
<em>Annals of Applied Probability</em>, <b>10</b>, 1274-1301.
</p>
<p>Leadbetter, M.R., Lindgren, G. and Rootzen, H. (1989). Extremes and related
properties of random sequences and processes. <em>Springer</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+MLTailIndex">MLTailIndex</a>, <a href="#topic+MomTailIndex">MomTailIndex</a>, <a href="#topic+EBTailIndex">EBTailIndex</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tail index estimation based on the Hill estimator obtained with
# 1-dimensional data simulated from an AR(1) with univariate Student-t
# distributed innovations

tsDist &lt;- "studentT"
tsType &lt;- "AR"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallBlock &lt;- 15

# Number of larger order statistics
k &lt;- 150

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rtimeseries(ndata, tsDist, tsType, par)

# tail index estimation
gammaHat1 &lt;- HTailIndex(data, k, TRUE, bigBlock=bigBlock, smallBlock=smallBlock)
gammaHat1$gammaHat
gammaHat1$CIgamHat

# tail index estimation with bias correction
gammaHat2 &lt;- HTailIndex(data, 2*k, TRUE, bias=TRUE, bigBlock=bigBlock, smallBlock=smallBlock)
gammaHat2$gammaHat-gammaHat2$BiasGamHat
gammaHat2$CIgamHat
</code></pre>

<hr>
<h2 id='HypoTesting'>Wald-Type Hypothesis Testing</h2><span id='topic+HypoTesting'></span>

<h3>Description</h3>

<p>Wald-type hypothesis tes for testing equality of high or extreme expectiles and quantiles</p>


<h3>Usage</h3>

<pre><code class='language-R'>HypoTesting(data, tau, tau1=NULL, type="ExpectRisks", level="extreme",
            method="LAWS", bias=FALSE, k=NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HypoTesting_+3A_data">data</code></td>
<td>
<p>A matrix of <code class="reqn">(n \times d)</code> observations.</p>
</td></tr>
<tr><td><code id="HypoTesting_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HypoTesting_+3A_tau1">tau1</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the extreme level <code class="reqn">\tau'_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HypoTesting_+3A_type">type</code></td>
<td>
<p>A string specifying the type of test. By default <code>type="ExpectRisks"</code> specifies the test for testing the equality of expectiles. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HypoTesting_+3A_level">level</code></td>
<td>
<p>A string specifying the level of the expectile. This make sense when <code>type="ExpectRisks"</code>. By default <code>level="extreme"</code> specifies that the test concerns expectiles at the extreme level. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HypoTesting_+3A_method">method</code></td>
<td>
<p>A string specifying the method used to estimate the expecile. By default <code>est="LAWS"</code> specifies the use of the LAWS based estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HypoTesting_+3A_bias">bias</code></td>
<td>
<p>A logical value. By default <code>bias=FALSE</code> specifies that no bias correction is computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HypoTesting_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="HypoTesting_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the significance level of the test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With a dataset <code>data</code> of <code>d</code>-dimensional observations and sample size <code class="reqn">n</code>, a Wald-type hypothesis testing is performed in order to check whether the is empirical evidence against the null hypothesis. The null hypothesis concerns the equality among the expectiles or quantiles or tail indices of the marginal distributions. The three tests depend on the depends on the estimation of the <code>d</code>-dimensional tail index <code class="reqn">\gamma</code>. Here, <code class="reqn">\gamma</code> is estimated using the Hill estimation (see <a href="#topic+MultiHTailIndex">MultiHTailIndex</a> for details).
The data are regarded as <code>d</code>-dimensional temporal independent observations coming from dependent variables. See Padoan and Stupfler (2020) for details.
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. Practically, for each marginal distribution, <code class="reqn">\tau_n \in (0,1)</code> is the ratio between <em>N</em> (Numerator) and <em>D</em> (Denominator). Where <em>N</em> is the empirical mean distance of the <code class="reqn">\tau_n</code>-<em>th</em> expectile from the observations smaller than it, and <em>D</em> is the empirical mean distance of <code class="reqn">\tau_n</code>-<em>th</em> expectile from all the observations.
</p>
</li>
<li><p> The so-called extreme level <code>tau1</code> or <code class="reqn">\tau'_n</code> is a sequence of positive reals such that <code class="reqn">\tau'_n \to 1</code> as <code class="reqn">n \to \infty</code>.
For each marginal distribution, the value <code class="reqn">(1-tau'_n) \in (0,1)</code> is meant to be a small tail probability such that <code class="reqn">(1-\tau'_n)=1/n</code> or <code class="reqn">(1-\tau'_n) &lt; 1/n</code>. It is also assumed that <code class="reqn">n(1-\tau'_n) \to C</code> as <code class="reqn">n \to \infty</code>, where <code class="reqn">C</code> is a positive finite constant. Typically, <code class="reqn">C \in (0,1)</code> so it is expected that there are no observations in a data sample that are greater than the expectile at the extreme level <code class="reqn">\tau_n'</code>.
</p>
</li>
<li><p> When <code>type="ExpectRisks"</code>, the null hypothesis of the hypothesis testing concerns the equality among the expectiles of the marginal distributions. See Section 3.3 of Padoan and Stupfler (2020) for details. When <code>type="QuantRisks"</code>, the null hypothesis of the hypothesis testing concerns the equality among the quantiles of the marginal distributions. See Section 5 of Padoan and Stupfler (2020) for details. Note that in this case the test is based on the asymptotic distribution of normalized quantile estimator in the logarithmic scale. When <code>type="tails"</code>, the null hypothesis of the hypothesis testing concerns the equality among the tail indices of the marginal distributions. See Sections 3.2 and 3.3 of Padoan and Stupfler (2020) for details.
</p>
</li>
<li><p> When <code>type="ExpectRisks"</code>, the null hypothesis concerns the equality among the expectiles of the marginal distributions at the intermediate level and this is achieved through <code>level=="inter"</code>. In this case the test is obtained exploiting the asymptotic distribution of relative expectile appropriately normalised. See Section 2.1, 3.1 and 3.3 of Padoan and Stupfler (2020) for details. Instead, if <code>level=="extreme"</code> the null hypothesis concerns the equality among the expectiles of the marginal distributions at the extreme level.
</p>
</li>
<li><p> When <code>method='LAWS'</code>, then the <code class="reqn">\tau'_n</code>-<em>th</em> <code>d</code>-dimensional expectile is estimated using the LAWS based estimator. When <code>method='QB'</code>, the expectile is instead estimated using the QB esimtator. The definition of both estimators depend on the estimation of the <code>d</code>-dimensional tail index <code class="reqn">\gamma</code>. The <code>d</code>-dimensional tail index <code class="reqn">\gamma</code> is estimated using the <code>d</code>-dimensional Hill estimator (<code>tailest='Hill'</code>), see <a href="#topic+MultiHTailIndex">MultiHTailIndex</a>). See Section 2.2 in Padoan and Stupfler (2020) for details.
</p>
</li>
<li><p> If <code>bias=TRUE</code> then <code>d</code>-dimensional <code class="reqn">\gamma</code> is estimated using formula (4.2) of Haan et al. (2016). This is used by the LAWS and QB estimators. Furthermore, the <code class="reqn">\tau'_n</code>&ndash;<em>th</em> quantile is estimated using the formula in page 330 of de Haan et al. (2016). This provides a bias corrected version of the Weissman estimator. This is used by the QB estimator.
However, in this case the asymptotic variance is not estimated using the formula in Haan et al. (2016) Theorem 4.2. Instead, for simplicity the asymptotic variance-covariance matrix is estimated by the formulas Section 3.2 of Padoan and Stupfler (2020).
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, for each marginal distribution when <code>tau=NULL</code> and <code>method='LAWS'</code> or <code>method='QB'</code>, then <code class="reqn">\tau_n=1-k_n/n</code> is the intermediate level of the expectile to be stimated. When <code>tailest='Hill'</code>, for each marginal distributions, then <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics used in the definition of the Hill estimator.
</p>
</li>
<li><p> A small value <code class="reqn">\alpha\in (0,1)</code> specifies the significance level of Wald-type hypothesis testing.</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>logLikR</code>: the observed value of log-likelihood ratio statistic test;
</p>
</li>
<li> <p><code>critVal</code>: the quantile (critical level) of a chi-square distribution with <code>d</code> degrees of freedom and confidence level <code class="reqn">\alpha</code>.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Joint inference on extreme expectiles for multivariate
heavy-tailed distributions. <em>arXiv e-prints</em> arXiv:2007.08944, <a href="https://arxiv.org/abs/2007.08944">https://arxiv.org/abs/2007.08944</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+MultiHTailIndex">MultiHTailIndex</a>,  <a href="#topic+predMultiExpectiles">predMultiExpectiles</a>, <a href="#topic+extMultiQuantile">extMultiQuantile</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Hypothesis testing on the equality extreme expectiles based on a sample of
# d-dimensional observations simulated from a joint distribution with
# a Gumbel copula and equal Frechet marginal distributions.
library(plot3D)
library(copula)
library(evd)

# distributional setting
copula &lt;- "Gumbel"
dist &lt;- "Frechet"

# parameter setting
dep &lt;- 3
dim &lt;- 3
scale &lt;- rep(1, dim)
shape &lt;- rep(3, dim)
par &lt;- list(dep=dep, scale=scale, shape=shape, dim=dim)

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.95
# Extreme level (or tail probability 1-tau1 of unobserved expectile)
tau1 &lt;- 0.9995

# sample size
ndata &lt;- 1000

# Simulates a sample from a multivariate distribution with equal Frechet
# marginals distributions and a Gumbel copula
data &lt;- rmdata(ndata, dist, copula, par)
scatter3D(data[,1], data[,2], data[,3])

# Performs Wald-type hypothesis testing
HypoTesting(data, tau, tau1)

# Hypothesis testing on the equality extreme expectiles based on a sample of
# d-dimensional observations simulated from a joint distribution with
# a Clayton copula and different Frechet marginal distributions.

# distributional setting
copula &lt;- "Clayton"
dist &lt;- "Frechet"

# parameter setting
dim &lt;- 3
dep &lt;- 2
scale &lt;- rep(1, dim)
shape &lt;- c(2.1, 3, 4.5)
par &lt;- list(dep=dep, scale=scale, shape=shape, dim=dim)

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.95
# Extreme level (or tail probability 1-tau1 of unobserved expectile)
tau1 &lt;- 0.9995

# sample size
ndata &lt;- 1000

# Simulates a sample from a multivariate distribution with equal Frechet
# marginals distributions and a Gumbel copula
data &lt;- rmdata(ndata, dist, copula, par)
scatter3D(data[,1], data[,2], data[,3])

# Performs Wald-type hypothesis testing
HypoTesting(data, tau, tau1)
</code></pre>

<hr>
<h2 id='MLTailIndex'>Maximum Likelihood Tail Index Estimation</h2><span id='topic+MLTailIndex'></span>

<h3>Description</h3>

<p>Computes a point and interval estimate of the tail index based on the Maximum Likelihood (ML) estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLTailIndex(data, k, var=FALSE, varType="asym-Dep", bigBlock=NULL,
            smallBlock=NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLTailIndex_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations.</p>
</td></tr>
<tr><td><code id="MLTailIndex_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MLTailIndex_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the asymptotic variance of the tail index estimator is computed.</p>
</td></tr>
<tr><td><code id="MLTailIndex_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the asymptotic variance to compute. By default <code>varType="asym-Dep"</code> specifies the variance estimator for serial dependent observations. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MLTailIndex_+3A_bigblock">bigBlock</code></td>
<td>
<p>An interger specifying the size of the big-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MLTailIndex_+3A_smallblock">smallBlock</code></td>
<td>
<p>An interger specifying the size of the small-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MLTailIndex_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence interval for the tail index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of sample size <code class="reqn">n</code>, the tail index <code class="reqn">\gamma</code> of its (marginal) distribution is computed by applying the ML estimator. The observations can be either independent or temporal dependent.
</p>

<ul>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, the value <code class="reqn">k_n</code> specifies the numer of <code>k</code><code class="reqn">+1</code> larger order statistics to be used to estimate <code class="reqn">\gamma</code>.
</p>
</li>
<li><p> If <code>var=TRUE</code> then the asymptotic variance of the Hill estimator is computed. With independent observations the asymptotic variance is estimated by the formula in Theorem 3.4.2 of de Haan and Ferreira (2006). This is achieved through <code>varType="asym-Ind"</code>. With serial dependent observations the asymptotic variance is estimated by the formula in 1288 in Drees (2000). This is achieved through <code>varType="asym-Dep"</code>. In this latter case the serial dependence is estimated by exploiting the &quot;big blocks seperated by small blocks&quot; techinque which is a standard tools in time series, see Leadbetter et al. (1986). See also formula (11) in Drees (2003). The size of the big and small blocks are specified by the parameters <code>bigBlock</code> and <code>smallBlock</code>, respectively.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an asymptotic confidence interval for the tail index, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code> is computed.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>gammaHat</code>: an estimate of tail index <code class="reqn">\gamma</code>;
</p>
</li>
<li> <p><code>VarGamHat</code>: an estimate of the variance of the ML estimator;
</p>
</li>
<li> <p><code>CIgamHat</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\gamma</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>
<p>Drees, H. (2000). Weighted approximations of tail processes for <code class="reqn">\beta</code>-mixing random variables.
<em>Annals of Applied Probability</em>, <b>10</b>, 1274-1301.
</p>
<p>de Haan, L. and Ferreira, A. (2006). Extreme Value Theory: An Introduction. <em>Springer</em>-<em>Verlag</em>, New York.
</p>
<p>Leadbetter, M.R., Lindgren, G. and Rootzen, H. (1989). Extremes and related
properties of random sequences and processes. <em>Springer</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+HTailIndex">HTailIndex</a>, <a href="#topic+MomTailIndex">MomTailIndex</a>, <a href="#topic+EBTailIndex">EBTailIndex</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tail index estimation based on the Maximum Likelihood estimator obtained with
# 1-dimensional data simulated from an AR(1) with univariate Student-t
# distributed innovations

tsDist &lt;- "studentT"
tsType &lt;- "AR"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallBlock &lt;- 15

# Number of larger order statistics
k &lt;- 150

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rtimeseries(ndata, tsDist, tsType, par)

# tail index estimation
gammaHat &lt;- MLTailIndex(data, k, TRUE, bigBlock=bigBlock, smallBlock=smallBlock)
gammaHat$gammaHat
gammaHat$CIgamHat
</code></pre>

<hr>
<h2 id='MomTailIndex'>Moment based Tail Index Estimation</h2><span id='topic+MomTailIndex'></span>

<h3>Description</h3>

<p>Computes a point estimate of the tail index based on the Moment Based (MB) estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MomTailIndex(data, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MomTailIndex_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations.</p>
</td></tr>
<tr><td><code id="MomTailIndex_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of sample size <code class="reqn">n</code>, the tail index <code class="reqn">\gamma</code> of its (marginal) distribution is computed by applying the MB estimator. The observations can be either independent or temporal dependent. For details see de Haan and Ferreira (2006).
</p>

<ul>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, the value <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics to be used to estimate <code class="reqn">\gamma</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>An estimate of the tail index <code class="reqn">\gamma</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>de Haan, L. and Ferreira, A. (2006). Extreme Value Theory: An Introduction. <em>Springer</em>-<em>Verlag</em>, New York.
</p>


<h3>See Also</h3>

<p><a href="#topic+HTailIndex">HTailIndex</a>, <a href="#topic+MLTailIndex">MLTailIndex</a>, <a href="#topic+EBTailIndex">EBTailIndex</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tail index estimation based on the Moment estimator obtained with
# 1-dimensional data simulated from an AR(1) with univariate Student-t
# distributed innovations

tsDist &lt;- "studentT"
tsType &lt;- "AR"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallblock &lt;- 15

# Number of larger order statistics
k &lt;- 150

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rtimeseries(ndata, tsDist, tsType, par)

# tail index estimation
gammaHat &lt;- MomTailIndex(data, k)
gammaHat
</code></pre>

<hr>
<h2 id='MultiHTailIndex'>Multidimensional Hill Tail Index Estimation</h2><span id='topic+MultiHTailIndex'></span>

<h3>Description</h3>

<p>Computes point estimates and <code class="reqn">(1-\alpha)100\%</code> confidence regions estimate of <code class="reqn">d</code>-dimensional tail indices based on the Hill's estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MultiHTailIndex(data, k, var=FALSE, varType="asym-Dep", bias=FALSE,
                alpha=0.05, plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MultiHTailIndex_+3A_data">data</code></td>
<td>
<p>A matrix of <code class="reqn">(n \times d)</code> observations.</p>
</td></tr>
<tr><td><code id="MultiHTailIndex_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MultiHTailIndex_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the variance-covariance matrix of the tail indices estimators is computed.</p>
</td></tr>
<tr><td><code id="MultiHTailIndex_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the asymptotic variance to compute. By default <code>varType="asym-Dep"</code> specifies the variance estimator for <code class="reqn">d</code> dependent marginal variables. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MultiHTailIndex_+3A_bias">bias</code></td>
<td>
<p>A logical value. By default <code>biast=FALSE</code> specifies that no bias correction is computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MultiHTailIndex_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence interval for the tail index.</p>
</td></tr>
<tr><td><code id="MultiHTailIndex_+3A_plot">plot</code></td>
<td>
<p>A logical value. By default <code>plot=FALSE</code> specifies that no graphical representation of the estimates is provided. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of <code class="reqn">(n \times d)</code> observations, where <code class="reqn">d</code> is the number of variables and <code class="reqn">n</code> is the sample size, the tail index <code class="reqn">\gamma</code> of the <code class="reqn">d</code> marginal distributions is estimated by applying the Hill estimator. Together with a point estimate a <code class="reqn">(1-\alpha)100\%</code> confidence region is computed. The data are regarded as <code>d</code>-dimensional temporal independent observations coming from dependent variables.
</p>

<ul>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, the value <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics to be used to estimate each marginal tail index <code class="reqn">\gamma_j</code> for <code class="reqn">j=1,\ldots,d</code>.
</p>
</li>
<li><p> If <code>var=TRUE</code> then an estimate of the asymptotic variance-covariance matrix of the multivariate Hill estimator is computed. With independent observations the asymptotic variance-covariance matrix is estimated by the matrix <code class="reqn">\hat{\Sigma}^{LAWS}_{j,\ell}(\gamma,R)(1,1)</code>, see bottom formula in page 14 of Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Dep"</code> which means <code class="reqn">d</code> dependent marginal variables. When <code>varType="asym-Ind"</code> <code class="reqn">d</code> marginal variables are regarded as independent and the returned variance-covariance matrix <code class="reqn">\hat{\Sigma}^{LAWS}_{j,\ell}(\gamma,R)(1,1)</code> is a diagonal matrix with only variance terms.
</p>
</li>
<li><p> If <code>bias=TRUE</code> then an estimate of the bias term of the Hill estimator is computed implementing using formula (4.2) in de Haan et al. (2016). In this case the asymptotic variance is not estimated using the formula in Haan et al. (2016) Theorem 4.1 but instead for simplicity the formula at the bottom of page 14 in Padoan and Stupfler (2020) is still used.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an estimate of an asymptotic confidence region for <code class="reqn">\gamma_j</code>, for <code class="reqn">j=1,\ldots,d</code>, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code>, is computed. The confidence intervals are computed exploiting the asymptotic normality of multivariate Hill estimator appropriately normalized (the logarithmic scale is not used), see Padoan and Stupfler (2020) for details.
</p>
</li>
<li><p> If <code>plot=TRUE</code> then a graphical representation of the estimates is not provided.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>gammaHat</code>: an estimate of the <code class="reqn">d</code> tail indices <code class="reqn">\gamma_j</code>, for <code class="reqn">j=1,\ldots,d</code>;
</p>
</li>
<li> <p><code>VarCovGHat</code>: an estimate of the asymptotic variance-covariance matrix of the multivariate Hill estimator;
</p>
</li>
<li> <p><code>biasTerm</code>: an estimate of bias term of the multivariate Hill estimator;
</p>
</li>
<li> <p><code>EstConReg</code>: an estimate of the <code class="reqn">(1-\alpha)100\%</code> confidence region.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Joint inference on extreme expectiles for multivariate
heavy-tailed distributions. <em>arXiv e-prints</em> arXiv:2007.08944, <a href="https://arxiv.org/abs/2007.08944">https://arxiv.org/abs/2007.08944</a>.
</p>
<p>de Haan, L., Mercadier, C. and Zhou, C. (2016). Adapting extreme value statistics
to financial time series: dealing with bias and serial dependence. <em>Finance and Stochastics</em>,
<b>20</b>, 321-354.
</p>
<p>de Haan, L. and Ferreira, A. (2006). Extreme Value Theory: An Introduction. <em>Springer</em>-<em>Verlag</em>, New York.
</p>


<h3>See Also</h3>

<p><a href="#topic+HTailIndex">HTailIndex</a>, <a href="#topic+rmdata">rmdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tail index estimation based on the multivariate Hill estimator obtained with
# n observations simulated from a d-dimensional random vector with a multivariate
# distribution with equal Frechet margins and a Clayton copula.
library(plot3D)
library(copula)
library(evd)

# distributional setting
copula &lt;- "Clayton"
dist &lt;- "Frechet"

# parameter setting
dep &lt;- 3
dim &lt;- 3
scale &lt;- rep(1, dim)
shape &lt;- rep(3, dim)
par &lt;- list(dep=dep, scale=scale, shape=shape, dim=dim)

# Number of larger order statistics
k &lt;- 150

# sample size
ndata &lt;- 1000

# Simulates a sample from a multivariate distribution with equal Frechet
# marginals distributions and a Clayton copula
data &lt;- rmdata(ndata, dist, copula, par)
scatter3D(data[,1], data[,2], data[,3])

# tail indices estimation
est &lt;- MultiHTailIndex(data, k, TRUE)
est$gammaHat
est$VarCovGHat
# run the following command to see the graphical representation

 est &lt;- MultiHTailIndex(data, k, TRUE, plot=TRUE)

</code></pre>

<hr>
<h2 id='predExpectiles'>Extreme Expectile Estimation</h2><span id='topic+predExpectiles'></span>

<h3>Description</h3>

<p>Computes a point and interval estimate of the expectile at the extreme level (Expectile Prediction).</p>


<h3>Usage</h3>

<pre><code class='language-R'>predExpectiles(data, tau, tau1, method="LAWS", tailest="Hill", var=FALSE,
               varType="asym-Dep", bias=FALSE, bigBlock=NULL, smallBlock=NULL,
               k=NULL, alpha_n=NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predExpectiles_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_tau1">tau1</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the extreme level <code class="reqn">\tau'_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_method">method</code></td>
<td>
<p>A string specifying the method used to estimate the expecile. By default <code>est="LAWS"</code> specifies the use of the LAWS based estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_tailest">tailest</code></td>
<td>
<p>A string specifying the tail index estimator. By default <code>tailest="Hill"</code> specifies the use of Hill estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the asymptotic variance of the expectile estimator is computed.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the type of asymptotic variance to compute. By default <code>varType="asym-Dep"</code> specifies the variance estimator for serial dependent observations. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_bias">bias</code></td>
<td>
<p>A logical value. By default <code>bias=FALSE</code> specifies that no bias correction is computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_bigblock">bigBlock</code></td>
<td>
<p>An interger specifying the size of the big-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_smallblock">smallBlock</code></td>
<td>
<p>An interger specifying the size of the small-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_alpha_n">alpha_n</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the quantile's extreme level to be use in order to estimate the expectile's extreme level.</p>
</td></tr>
<tr><td><code id="predExpectiles_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence interval for the expecile at the intermedite level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of sample size <code class="reqn">n</code>, an estimate of the <code class="reqn">\tau'_n</code>-<em>th</em> expectile is computed. The estimation of the expectile at the extreme level <code>tau1</code> (<code class="reqn">\tau'_n</code>) is meant to be a prediction beyond the observed sample.  Two estimators are available: the so-called Least Asymmetrically Weighted Squares (LAWS) based estimator and the Quantile-Based (QB) estimator. The definition of both estimators depends on the estimation of the tail index <code class="reqn">\gamma</code>. Here, <code class="reqn">\gamma</code> is estimated using the Hill estimation (see <a href="#topic+HTailIndex">HTailIndex</a> for details) or in alternative using the the expectile based estimator (see <a href="#topic+EBTailIndex">EBTailIndex</a>).
The observations can be either independent or temporal dependent. See Section 3.2 in Padoan and Stupfler (2020) for details.
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. Practically, <code class="reqn">\tau_n \in (0,1)</code> is the ratio between <em>N</em> (Numerator) and <em>D</em> (Denominator). Where <em>N</em> is the empirical mean distance of the <code class="reqn">\tau_n</code>-<em>th</em> expectile from the observations smaller than it, and <em>D</em> is the empirical mean distance of <code class="reqn">\tau_n</code>-<em>th</em> expectile from all the observations.
</p>
</li>
<li><p> The so-called extreme level <code>tau1</code> or <code class="reqn">\tau'_n</code> is a sequence of positive reals such that <code class="reqn">\tau'_n \to 1</code> as <code class="reqn">n \to \infty</code>.
The value <code class="reqn">(1-tau'_n) \in (0,1)</code> is meant to be a small tail probability such that <code class="reqn">(1-\tau'_n)=1/n</code> or <code class="reqn">(1-\tau'_n) &lt; 1/n</code>. It is also assumed that <code class="reqn">n(1-\tau'_n) \to C</code> as <code class="reqn">n \to \infty</code>, where <code class="reqn">C</code> is a positive finite constant. Typically, <code class="reqn">C \in (0,1)</code> so it is expected that there are no observations in a data sample that are greater than the expectile at the extreme level <code class="reqn">\tau_n'</code>.
</p>
</li>
<li><p> When <code>method='LAWS'</code>, then the <code class="reqn">\tau'_n</code>-<em>th</em> expectile is estimated using the LAWS based estimator. When <code>method='QB'</code>, the expectile is instead estimated using the QB esimtator. The definition of both estimators depend on the estimation of the tail index <code class="reqn">\gamma</code>. When <code>tailest='Hill'</code> then <code class="reqn">\gamma</code> is estimated using the Hill estimator (see <a href="#topic+HTailIndex">HTailIndex</a>). When <code>tailest='ExpBased'</code>, then <code class="reqn">\gamma</code> is estimated using the expectile based estimator (see <a href="#topic+EBTailIndex">EBTailIndex</a>). See Section 3.2 in Padoan and Stupfler (2020) for details.
</p>
</li>
<li><p> If <code>var=TRUE</code> then an esitmate of the asymptotic variance of the <code class="reqn">tau'_n</code>-<em>th</em> expectile is computed. Notice that the estimation of the asymptotic variance <b>is only available</b> when <code class="reqn">\gamma</code> is estimated using the Hill estimator (see <a href="#topic+HTailIndex">HTailIndex</a>). With independent observations the asymptotic variance is estimated by <code class="reqn">\hat{\gamma}^2</code>, see the remark below Theorem 3.5 in Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Ind"</code>.  With serial dependent observations the asymptotic variance is estimated by the formula in Throrem 3.5 of Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Dep"</code>. See Section 3.2 in Padoan and Stupfler (2020) for details. In this latter case the computation of the serial dependence is based on the &quot;big blocks seperated by small blocks&quot; techinque which is a standard tools in time series, see e.g. Leadbetter et al. (1986).
The size of the big and small blocks are specified by the parameters <code>bigBlock</code> and <code>smallBlock</code>, respectively.
</p>
</li>
<li><p> If <code>bias=TRUE</code> then <code class="reqn">\gamma</code> is estimated using formula (4.2) of Haan et al. (2016). This is used by the LAWS and QB estimators. Furthermore, the <code class="reqn">\tau'_n</code>&ndash;<em>th</em> quantile is estimated using the formula in page 330 of de Haan et al. (2016). This provides a bias corrected version of the Weissman estimator. This is used by the QB estimator.
However, in this case the asymptotic variance is not estimated using the formula in Haan et al. (2016) Theorem 4.2. Instead, for simplicity the asymptotic variance is estimated by the formula in Corollary 3.8, with serial dependent observations, and <code class="reqn">\hat{\gamma}^2</code> with independent observation (see e.g. de Drees 2000, for the details).
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, when <code>tau=NULL</code> and <code>method='LAWS'</code>, then <code class="reqn">\tau_n=1-k_n/n</code> is the intermediate level of the expectile to be stimated. The latter is also used to estimate the tail index when <code>tailest='ExpBased'</code>. Instead, if <code>tailest='Hill'</code>, then <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics used in the definition of the Hill estimator. Differently, When <code>tau=NULL</code> and <code>method='QB'</code>, then <code class="reqn">\tau_n=1-k_n/n</code> is the intermediate level of the quantile to be stimated and of the expectile to be stimated when <code>tailest='ExpBased'</code>. Instead, when <code>tailest='Hill'</code> it is the numer of <code>k</code><code class="reqn">+1</code> larger order statistics used in the definition of the Hill estimator.
</p>
</li>
<li><p> If quantile's extreme level is provided by <code>alpha_n</code>, then expectile's extreme level <code class="reqn">tau'_n(\alpha_n)</code> is replaced by <code class="reqn">tau'_n(\alpha_n)</code> which is esitmated using the method described in Section 6 of Padoan and Stupfler (2020). See <a href="#topic+estExtLevel">estExtLevel</a> for details.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an estimate of an asymptotic confidence interval for <code class="reqn">tau'_n</code>-<em>th</em> expectile, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code>, is computed. The confidence intervals are computed exploiting formula (10) and (11) in Padoan and Stupfler (2020) and (46) in Drees (2003). See Section 5 in Padoan and Stupfler (2020) for details. When <code>biast=TRUE</code> confidence intervals are computed in the same way but after correcting the tail index estimate by an estimate of the bias term, see formula (4.2) in de Haan et al. (2016) for details.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>EExpcHat</code>: an estimate of the <code class="reqn">\tau'_n</code>-<em>th</em> expecile;
</p>
</li>
<li> <p><code>VarExtHat</code>: an estimate of the asymptotic variance of the expectile estimator;
</p>
</li>
<li> <p><code>CIExpct</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\tau'_n</code>-<em>th</em> expecile.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>
<p>Daouia, A., Girard, S. and Stupfler, G. (2018). Estimation of tail risk based on extreme expectiles. <em>Journal of the Royal Statistical Society: Series B</em>, <b>80</b>, 263-292.
</p>
<p>de Haan, L., Mercadier, C. and Zhou, C. (2016). Adapting extreme value statistics
tonancial time series: dealing with bias and serial dependence. <em>Finance and Stochastics</em>,
<b>20</b>, 321-354.
</p>
<p>Drees, H. (2003). Extreme quantile estimation for dependent data, with applications to finance.
<em>Bernoulli</em>, <b>9</b>, 617-657.
</p>
<p>Drees, H. (2000). Weighted approximations of tail processes for <code class="reqn">\beta</code>-mixing random variables.
<em>Annals of Applied Probability</em>, <b>10</b>, 1274-1301.
</p>
<p>Leadbetter, M.R., Lindgren, G. and Rootzen, H. (1989). Extremes and related
properties of random sequences and processes. <em>Springer</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+HTailIndex">HTailIndex</a>,  <a href="#topic+EBTailIndex">EBTailIndex</a>, <a href="#topic+estExpectiles">estExpectiles</a>, <a href="#topic+extQuantile">extQuantile</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extreme expectile estimation at the extreme level tau1 obtained with
# 1-dimensional data simulated from an AR(1) with univariate
# Student-t distributed innovations

tsDist &lt;- "studentT"
tsType &lt;- "AR"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallBlock &lt;- 15

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.95
# Extreme level (or tail probability 1-tau1 of unobserved expectile)
tau1 &lt;- 0.9995

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rtimeseries(ndata, tsDist, tsType, par)

# Extreme expectile estimation
expectHat1 &lt;- predExpectiles(data, tau, tau1, var=TRUE, bigBlock=bigBlock,
	                         smallBlock=smallBlock)
expectHat1$EExpcHat
expectHat1$CIExpct
# Extreme expectile estimation with bias correction
tau &lt;- 0.80
expectHat2 &lt;- predExpectiles(data, tau, tau1, "QB", var=TRUE, bias=TRUE, bigBlock=bigBlock,
							 smallBlock=smallBlock)
expectHat2$EExpcHat
expectHat2$CIExpct
</code></pre>

<hr>
<h2 id='predMultiExpectiles'>Multidimensional Extreme Expectile Estimation</h2><span id='topic+predMultiExpectiles'></span>

<h3>Description</h3>

<p>Computes point estimates and <code class="reqn">(1-\alpha)100\%</code> confidence regions for <code>d</code>-dimensional expectile at the extreme level (Expectile Prediction).</p>


<h3>Usage</h3>

<pre><code class='language-R'>predMultiExpectiles(data, tau, tau1, method="LAWS", tailest="Hill", var=FALSE,
                    varType="asym-Ind-Adj-Log", bias=FALSE, k=NULL, alpha=0.05,
                    plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predMultiExpectiles_+3A_data">data</code></td>
<td>
<p>A matrix of <code class="reqn">(n \times d)</code> observations.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_tau1">tau1</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the extreme level <code class="reqn">\tau'_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_method">method</code></td>
<td>
<p>A string specifying the method used to estimate the expecile. By default <code>est="LAWS"</code> specifies the use of the LAWS based estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_tailest">tailest</code></td>
<td>
<p>A string specifying the tail index estimator. By default <code>tailest="Hill"</code> specifies the use of Hill estimator. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the asymptotic variance of the expectile estimator is computed.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the type of asymptotic variance-covariance matrix to compute. By default <code>varType="asym-Ind-Adj-Log"</code> specifies that the variance-covariance matrix is computed assuming dependent variables and exploiting the log scale and a suitable adjustment. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_bias">bias</code></td>
<td>
<p>A logical value. By default <code>bias=FALSE</code> specifies that no bias correction is computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence region for the <code>d</code>-dimensional expecile at the extreme level.</p>
</td></tr>
<tr><td><code id="predMultiExpectiles_+3A_plot">plot</code></td>
<td>
<p>A logical value. By default <code>plot=FALSE</code> specifies that no graphical representation of the estimates is provided. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of <code>d</code>-dimensional observations and sample size <code class="reqn">n</code>, an estimate of the <code class="reqn">\tau'_n</code>-<em>th</em> <code>d</code>-dimensional expectile is computed. The estimation of the <code>d</code>-dimensional expectile at the extreme level <code>tau1</code> (<code class="reqn">\tau'_n</code>) is meant to be a prediction beyond the observed sample.  Two estimators are available: the so-called Least Asymmetrically Weighted Squares (LAWS) based estimator and the Quantile-Based (QB) estimator. The definition of both estimators depends on the estimation of the <code>d</code>-dimensional tail index <code class="reqn">\gamma</code>. Here, <code class="reqn">\gamma</code> is estimated using the Hill estimation (see <a href="#topic+MultiHTailIndex">MultiHTailIndex</a> for details).
The data are regarded as <code>d</code>-dimensional temporal independent observations coming from dependent variables. See Padoan and Stupfler (2020) for details.
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. Practically, for each marginal distribution, <code class="reqn">\tau_n \in (0,1)</code> is the ratio between <em>N</em> (Numerator) and <em>D</em> (Denominator). Where <em>N</em> is the empirical mean distance of the <code class="reqn">\tau_n</code>-<em>th</em> expectile from the observations smaller than it, and <em>D</em> is the empirical mean distance of <code class="reqn">\tau_n</code>-<em>th</em> expectile from all the observations.
</p>
</li>
<li><p> The so-called extreme level <code>tau1</code> or <code class="reqn">\tau'_n</code> is a sequence of positive reals such that <code class="reqn">\tau'_n \to 1</code> as <code class="reqn">n \to \infty</code>.
For each marginal distribution, the value <code class="reqn">(1-tau'_n) \in (0,1)</code> is meant to be a small tail probability such that <code class="reqn">(1-\tau'_n)=1/n</code> or <code class="reqn">(1-\tau'_n) &lt; 1/n</code>. It is also assumed that <code class="reqn">n(1-\tau'_n) \to C</code> as <code class="reqn">n \to \infty</code>, where <code class="reqn">C</code> is a positive finite constant. Typically, <code class="reqn">C \in (0,1)</code> so it is expected that there are no observations in a data sample that are greater than the expectile at the extreme level <code class="reqn">\tau_n'</code>.
</p>
</li>
<li><p> When <code>method='LAWS'</code>, then the <code class="reqn">\tau'_n</code>-<em>th</em> <code>d</code>-dimensional expectile is estimated using the LAWS based estimator. When <code>method='QB'</code>, the expectile is instead estimated using the QB esimtator. The definition of both estimators depend on the estimation of the <code>d</code>-dimensional tail index <code class="reqn">\gamma</code>. The <code>d</code>-dimensional tail index <code class="reqn">\gamma</code> is estimated using the <code>d</code>-dimensional Hill estimator (<code>tailest='Hill'</code>), see <a href="#topic+MultiHTailIndex">MultiHTailIndex</a>). This is the only available option so far (soon more results will be available). See Section 2.2 in Padoan and Stupfler (2020) for details.
</p>
</li>
<li><p> If <code>var=TRUE</code> then an estimate of the asymptotic variance-covariance matrix of the <code class="reqn">tau'_n</code>-<em>th</em> <code>d</code>-dimensional expectile is computed. Notice that the estimation of the asymptotic variance-covariance matrix <b>is only available</b> when <code class="reqn">\gamma</code> is estimated using the Hill estimator (see <a href="#topic+MultiHTailIndex">MultiHTailIndex</a>). The data are regarded as temporal independent observations coming from dependent variables. The asymptotic variance-covariance matrix is estimated exploiting the formulas in Section 3.2 of Padoan and Stupfler (2020). The variance-covariance matrix is computed exploiting the asymptotic behaviour of the normalized expectile estimator which is  expressed in logarithmic scale. In addition, a suitable adjustment is considered. This is achieved through <code>varType="asym-Ind-Adj-Log"</code>.  The data can also be regarded as coded-dimensional temporal independent observations coming from independent variables. In this case the asymptotic variance-covariance matrix is diagonal and is also computed exploiting the formulas in Section 3.2 of Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Ind-Log"</code>. If <code>varType="asym-Ind-Adj"</code>, then the variance-covariance matrix is computed exploiting the asymptotic behaviour of the relative expectile estimator appropriately normalized and exploiting a suitable adjustment. This concerns the case of dependent variables. The case of independent variables is achieved through <code>varType="asym-Ind"</code>.
</p>
</li>
<li><p> If <code>bias=TRUE</code> then <code>d</code>-dimensional <code class="reqn">\gamma</code> is estimated using formula (4.2) of Haan et al. (2016). This is used by the LAWS and QB estimators. Furthermore, the <code class="reqn">\tau'_n</code>&ndash;<em>th</em> quantile is estimated using the formula in page 330 of de Haan et al. (2016). This provides a bias corrected version of the Weissman estimator. This is used by the QB estimator.
However, in this case the asymptotic variance is not estimated using the formula in Haan et al. (2016) Theorem 4.2. Instead, for simplicity the asymptotic variance-covariance matrix is estimated by the formulas Section 3.2 of Padoan and Stupfler (2020).
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. Practically, for each marginal distribution when <code>tau=NULL</code> and <code>method='LAWS'</code> or <code>method='QB'</code>, then <code class="reqn">\tau_n=1-k_n/n</code> is the intermediate level of the expectile to be stimated. When <code>tailest='Hill'</code>, for each marginal distributions, then <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics used in the definition of the Hill estimator.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an estimate of an asymptotic confidence region for <code class="reqn">tau'_n</code>-<em>th</em> <code>d</code>-dimensional expectile, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code>, is computed. The confidence regions are computed exploiting the formulas in Section 3.2 of Padoan and Stupfler (2020). If <code>varType="asym-Ind-Adj-Log"</code>, then an &quot;asymmetric&quot; confidence regions is computed exploiting the asymptotic behaviour of the normalized expectile estimator in logarithmic scale and using a suitable adjustment. This choice is recommended. If <code>varType="asym-Ind-Adj"</code>, then the a &quot;symmetric&quot; confidence regions is computed exploiting the asymptotic behaviour of the relative explectile estimator appropriately normalized.
</p>
</li>
<li><p> If <code>plot=TRUE</code> then a graphical representation of the estimates is not provided.</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>ExpctHat</code>: an estimate of the <code class="reqn">\tau'_n</code>-<em>th</em> <code>d</code>-dimensional expecile;
</p>
</li>
<li> <p><code>biasTerm</code>: an estimate of the bias term of yje <code class="reqn">\tau'_n</code>-<em>th</em> <code>d</code>-dimensional expecile;
</p>
</li>
<li> <p><code>VarCovEHat</code>: an estimate of the asymptotic variance-covariance of the <code>d</code>-dimensional expectile estimator;
</p>
</li>
<li> <p><code>EstConReg</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence regions for <code class="reqn">\tau'_n</code>-<em>th</em> <code>d</code>-dimensional expecile.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Joint inference on extreme expectiles for multivariate
heavy-tailed distributions. <em>arXiv e-prints</em> arXiv:2007.08944, <a href="https://arxiv.org/abs/2007.08944">https://arxiv.org/abs/2007.08944</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+MultiHTailIndex">MultiHTailIndex</a>,  <a href="#topic+estMultiExpectiles">estMultiExpectiles</a>, <a href="#topic+extMultiQuantile">extMultiQuantile</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extreme expectile estimation at the extreme level tau1 obtained with
# d-dimensional observations simulated from a joint distribution with
# a Gumbel copula and equal Frechet marginal distributions.
library(plot3D)
library(copula)
library(evd)

# distributional setting
copula &lt;- "Gumbel"
dist &lt;- "Frechet"

# parameter setting
dep &lt;- 3
dim &lt;- 3
scale &lt;- rep(1, dim)
shape &lt;- rep(3, dim)
par &lt;- list(dep=dep, scale=scale, shape=shape, dim=dim)

# Intermediate level (or sample tail probability 1-tau)
tau &lt;- 0.95
# Extreme level (or tail probability 1-tau1 of unobserved expectile)
tau1 &lt;- 0.9995

# sample size
ndata &lt;- 1000

# Simulates a sample from a multivariate distribution with equal Frechet
# marginals distributions and a Gumbel copula
data &lt;- rmdata(ndata, dist, copula, par)
scatter3D(data[,1], data[,2], data[,3])

# High d-dimensional expectile (intermediate level) estimation
expectHat &lt;- predMultiExpectiles(data, tau, tau1, var=TRUE)

expectHat$ExpctHat
expectHat$VarCovEHat
# run the following command to see the graphical representation

 expectHat &lt;- predMultiExpectiles(data, tau, tau1, var=TRUE, plot=TRUE)

</code></pre>

<hr>
<h2 id='QuantMES'>Marginal Expected Shortfall Quantile Based Estimation</h2><span id='topic+QuantMES'></span>

<h3>Description</h3>

<p>Computes a point and interval estimate of the Marginal Expected Shortfall (MES) using a quantile based approach.</p>


<h3>Usage</h3>

<pre><code class='language-R'>QuantMES(data, tau, tau1, var=FALSE, varType="asym-Dep", bias=FALSE, bigBlock=NULL,
         smallBlock=NULL, k=NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QuantMES_+3A_data">data</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times n)</code> observations.</p>
</td></tr>
<tr><td><code id="QuantMES_+3A_tau">tau</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the intermediate level <code class="reqn">\tau_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="QuantMES_+3A_tau1">tau1</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the extreme level <code class="reqn">\tau'_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="QuantMES_+3A_var">var</code></td>
<td>
<p>If <code>var=TRUE</code> then an estimate of the asymptotic variance of the MES estimator is computed.</p>
</td></tr>
<tr><td><code id="QuantMES_+3A_vartype">varType</code></td>
<td>
<p>A string specifying the type of asymptotic variance to compute. By default <code>varType="asym-Dep"</code> specifies the variance estimator for serial dependent observations. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="QuantMES_+3A_bias">bias</code></td>
<td>
<p>A logical value. By default <code>bias=FALSE</code> specifies that no bias correction is computed. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="QuantMES_+3A_bigblock">bigBlock</code></td>
<td>
<p>An interger specifying the size of the big-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="QuantMES_+3A_smallblock">smallBlock</code></td>
<td>
<p>An interger specifying the size of the small-block used to estimaste the asymptotic variance. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="QuantMES_+3A_k">k</code></td>
<td>
<p>An integer specifying the value of the intermediate sequence <code class="reqn">k_n</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="QuantMES_+3A_alpha">alpha</code></td>
<td>
<p>A real in <code class="reqn">(0,1)</code> specifying the confidence level <code class="reqn">(1-\alpha)100\%</code> of the approximate confidence interval for the expecile at the intermedite level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a dataset <code>data</code> of sample size <code class="reqn">n</code>, an estimate of the <code class="reqn">\tau'_n</code>-<em>th</em> MES is computed. The estimation of the MES at the extreme level <code>tau1</code> (<code class="reqn">\tau'_n</code>) is indeed meant to be a prediction. Estimates are obtained through the quantile based estimator defined in page 12 of Padoan and Stupfler (2020). Such an estimator depends on the estimation of the tail index <code class="reqn">\gamma</code>. Here, <code class="reqn">\gamma</code> is estimated using the Hill estimation (see <a href="#topic+HTailIndex">HTailIndex</a> for details).
The observations can be either independent or temporal dependent. See Section 4 in Padoan and Stupfler (2020) for details.
</p>

<ul>
<li><p> The so-called intermediate level <code>tau</code> or <code class="reqn">\tau_n</code> is a sequence of positive reals such that <code class="reqn">\tau_n \to 1</code> as <code class="reqn">n \to \infty</code>. See <a href="#topic+predExpectiles">predExpectiles</a> for details.
</p>
</li>
<li><p> The so-called extreme level <code>tau1</code> or <code class="reqn">\tau'_n</code> is a sequence of positive reals such that <code class="reqn">\tau'_n \to 1</code> as <code class="reqn">n \to \infty</code>. See <a href="#topic+predExpectiles">predExpectiles</a> for details.
</p>
</li>
<li><p> If <code>var=TRUE</code> then an esitmate of the asymptotic variance of the <code class="reqn">tau'_n</code>-<em>th</em> MES is computed. Notice that the estimation of the asymptotic variance <b>is only available</b> when <code class="reqn">\gamma</code> is estimated using the Hill estimator (see <a href="#topic+HTailIndex">HTailIndex</a>). With independent observations the asymptotic variance is estimated by <code class="reqn">\hat{\gamma}^2</code>, see Corollary 4.3 in Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Ind"</code>.  With serial dependent observations the asymptotic variance is estimated by the formula in Corollary 4.2 of Padoan and Stupfler (2020). This is achieved through <code>varType="asym-Dep"</code>. See Section 4 and 5 in Padoan and Stupfler (2020) for details. In this latter case the computation of the serial dependence is based on the &quot;big blocks seperated by small blocks&quot; techinque which is a standard tools in time series, see e.g. Leadbetter et al. (1986).
The size of the big and small blocks are specified by the parameters <code>bigBlock</code> and <code>smallBlock</code>, respectively.
</p>
</li>
<li><p> If <code>bias=TRUE</code> then <code class="reqn">\gamma</code> is estimated using formula (4.2) of Haan et al. (2016). This is used by the LAWS and QB estimators. Furthermore, the <code class="reqn">\tau'_n</code>&ndash;<em>th</em> quantile is estimated using the formula in page 330 of de Haan et al. (2016). This provides a bias corrected version of the Weissman estimator. This is used by the QB estimator.
However, in this case the asymptotic variance is not estimated using the formula in Haan et al. (2016) Theorem 4.2. Instead, for simplicity the asymptotic variance is estimated by the formula in Corollary 3.8, with serial dependent observations, and <code class="reqn">\hat{\gamma}^2</code> with independent observation (see e.g. de Drees 2000, for the details).
</p>
</li>
<li> <p><code>k</code> or <code class="reqn">k_n</code> is the value of the so-called intermediate sequence <code class="reqn">k_n</code>, <code class="reqn">n=1,2,\ldots</code>. Its represents a sequence of positive integers such that <code class="reqn">k_n \to \infty</code> and <code class="reqn">k_n/n \to 0</code> as <code class="reqn">n \to \infty</code>. <code class="reqn">k_n</code> specifies the number of <code>k</code><code class="reqn">+1</code> larger order statistics used in the definition of the Hill estimator (see <a href="#topic+HTailIndex">HTailIndex</a> for details).
</p>
</li>
<li><p> If the quantile's extreme level is provided by <code>alpha_n</code>, then expectile's extreme level <code class="reqn">tau'_n</code> is replaced by <code class="reqn">tau'_n(\alpha_n)</code> which is estimated by the method described in Section 6 of Padoan and Stupfler (2020). See <a href="#topic+estExtLevel">estExtLevel</a> for details.
</p>
</li>
<li><p> Given a small value <code class="reqn">\alpha\in (0,1)</code> then an estimate of an asymptotic confidence interval for <code class="reqn">tau'_n</code>-<em>th</em> expectile, with approximate nominal confidence level <code class="reqn">(1-\alpha)100\%</code>, is computed. The confidence intervals are computed exploiting formula in Corollary 4.2, Theorem 6.2 of Padoan and Stupfler (2020) and (46) in Drees (2003). See Sections 4-6 in Padoan and Stupfler (2020) for details. When <code>biast=TRUE</code> confidence intervals are computed in the same way but after correcting the tail index estimate by an estimate of the bias term, see formula (4.2) in de Haan et al. (2016) for details.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>HatQMES</code>: an estimate of the <code class="reqn">\tau'_n</code>-<em>th</em> quantile based MES;
</p>
</li>
<li> <p><code>VarHatQMES</code>: an estimate of the asymptotic variance of the quantile based MES estimator;
</p>
</li>
<li> <p><code>CIHatQMES</code>: an estimate of the approximate <code class="reqn">(1-\alpha)100\%</code> confidence interval for <code class="reqn">\tau'_n</code>-<em>th</em> MES.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>
<p>Daouia, A., Girard, S. and Stupfler, G. (2018). Estimation of tail risk based on extreme expectiles. <em>Journal of the Royal Statistical Society: Series B</em>, <b>80</b>, 263-292.
</p>
<p>de Haan, L., Mercadier, C. and Zhou, C. (2016). Adapting extreme value statistics
tonancial time series: dealing with bias and serial dependence. <em>Finance and Stochastics</em>,
<b>20</b>, 321-354.
</p>
<p>Drees, H. (2003). Extreme quantile estimation for dependent data, with applications to finance.
<em>Bernoulli</em>, <b>9</b>, 617-657.
</p>
<p>Drees, H. (2000). Weighted approximations of tail processes for <code class="reqn">\beta</code>-mixing random variables.
<em>Annals of Applied Probability</em>, <b>10</b>, 1274-1301.
</p>
<p>Leadbetter, M.R., Lindgren, G. and Rootzen, H. (1989). Extremes and related
properties of random sequences and processes. <em>Springer</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+ExpectMES">ExpectMES</a>, <a href="#topic+HTailIndex">HTailIndex</a>,  <a href="#topic+predExpectiles">predExpectiles</a>, <a href="#topic+extQuantile">extQuantile</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Marginl Expected Shortfall quantile based estimation at the extreme level
# obtained with 2-dimensional data simulated from an AR(1) with bivariate
# Student-t distributed innovations


tsDist &lt;- "AStudentT"
tsType &lt;- "AR"
tsCopula &lt;- "studentT"

# parameter setting
corr &lt;- 0.8
dep &lt;- 0.8
df &lt;- 3
par &lt;- list(corr=corr, dep=dep, df=df)

# Big- small-blocks setting
bigBlock &lt;- 65
smallBlock &lt;- 15

# quantile's extreme level
tau1 &lt;- 0.9995

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rbtimeseries(ndata, tsDist, tsType, tsCopula, par)


# Extreme MES expectile based estimation
MESHat &lt;- QuantMES(data, NULL, tau1, var=TRUE, k=150, bigBlock=bigBlock,
                   smallBlock=smallBlock)
MESHat

</code></pre>

<hr>
<h2 id='rbtimeseries'>Simulation of Two-Dimensional Temporally Dependent Observations</h2><span id='topic+rbtimeseries'></span>

<h3>Description</h3>

<p>Simulates samples from parametric families of bivariate time series models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbtimeseries(ndata, dist="studentT", type="AR", copula="Gumbel", par, burnin=1e+03)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbtimeseries_+3A_ndata">ndata</code></td>
<td>
<p>A positive interger specifying the number of observations to simulate.</p>
</td></tr>
<tr><td><code id="rbtimeseries_+3A_dist">dist</code></td>
<td>
<p>A string specifying the parametric family of the innovations distribution. By default <code>dist="studentT"</code> specifies a
Student-<em>t</em> family of distributions. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="rbtimeseries_+3A_type">type</code></td>
<td>
<p>A string specifying the type of time series. By default <code>type="AR"</code> specifies a linear Auto-Regressive time series. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="rbtimeseries_+3A_copula">copula</code></td>
<td>
<p>A string specifying the type copula to be used. By default <code>copula="Gumbel"</code> specifies the Gumbel copula. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="rbtimeseries_+3A_par">par</code></td>
<td>
<p>A list of <code class="reqn">p</code> parameters to be specified for the bivariate time series parametric family. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="rbtimeseries_+3A_burnin">burnin</code></td>
<td>
<p>A positive interger specifying the number of initial observations to discard from the simulated sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a time series class (<code>type</code>), with a parametric family (<code>dist</code>) for the innovations, a sample of size <code>ndata</code> is simulated. See for example Brockwell and Davis (2016).
</p>

<ul>
<li><p> The available categories of bivariate time series models are: Auto-Regressive (<code>type="AR"</code>), Auto-Regressive and Moving-Average (<code>type="ARMA"</code>), Generalized-Autoregressive-Conditional-Heteroskedasticity (<code>type="GARCH"</code>) and Auto-Regressive.
</p>
</li>
<li><p> With AR(1) times series the available families of distributions for the innovations and the dependence structure (copula) are:
</p>

<ul>
<li><p> Student-<em>t</em> (<code>dist="studentT"</code> and <code>copula="studentT"</code>) with marginal parameters (equal for both distributions): <code class="reqn">\phi\in(-1,1)</code> (autoregressive coefficient), <code class="reqn">\nu&gt;0</code> (degrees of freedom) and dependence parameter <code class="reqn">dep\in(-1,1)</code>. The parameters are specified as <code>par &lt;- list(corr, df, dep)</code>;
</p>
</li>
<li><p> Asymmetric Student-<em>t</em> (<code>dist="AStudentT"</code> and <code>copula="studentT"</code>) with marginal parameters (equal for both distributions): <code class="reqn">\phi\in(-1,1)</code> (autoregressive coefficient), <code class="reqn">\nu&gt;0</code> (degrees of freedom) and dependence parameter <code class="reqn">dep\in(-1,1)</code>. The paraters are specified as <code>par &lt;- list(corr, df, dep)</code>. Note that in this case the tail index of the lower and upper tail of the first marginal are different, see Padoan and Stupfler (2020) for details;
</p>
</li></ul>

</li>
<li><p> With ARMA(1,1) times series the available families of distributions for the innovations and the dependence structure (copula) are:
</p>

<ul>
<li><p> symmetric Pareto (<code>dist="double-Pareto"</code> and <code>copula="Gumbel"</code> or <code>copula="Gaussian"</code>) with marginal parameters (equal for both distributions): <code class="reqn">\phi\in(-1,1)</code> (autoregressive coefficient), <code class="reqn">\sigma&gt;0</code> (scale), <code class="reqn">\alpha&gt;0</code> (shape), <code class="reqn">\theta</code> (movingaverage coefficient), and dependence parameter <code class="reqn">dep</code> (<code class="reqn">dep&gt;0</code> if <code>copula="Gumbel"</code> or <code class="reqn">dep\in(-1,1)</code> if <code>copula="Gaussian"</code>). The parameters are specified as <code>par &lt;- list(corr, scale, shape, smooth, dep)</code>.
</p>
</li>
<li><p> symmetric Pareto (<code>dist="double-Pareto"</code> and <code>copula="Gumbel"</code> or <code>copula="Gaussian"</code>) with marginal parameters (equal for both distributions): <code class="reqn">\phi\in(-1,1)</code> (autoregressive coefficient), <code class="reqn">\sigma&gt;0</code> (scale), <code class="reqn">\alpha&gt;0</code> (shape), <code class="reqn">\theta</code> (movingaverage coefficient), and dependence parameter <code class="reqn">dep</code> (<code class="reqn">dep&gt;0</code> if <code>copula="Gumbel"</code> or <code class="reqn">dep\in(-1,1)</code> if <code>copula="Gaussian"</code>). The parameters are specified as <code>par &lt;- list(corr, scale, shape, smooth, dep)</code>. Note that in this case the tail index of the lower and upper tail of the first marginal are different, see Padoan and Stupfler (2020) for details;
</p>
</li></ul>

</li>
<li><p> With ARCH(1)/GARCH(1,1) time series the distribution of the innovations are symmetric Gaussian (<code>dist="Gaussian"</code>) or asymmetric Gaussian <code>dist="AGaussian"</code>. In both cases the marginal parameters (equal for both distributions) are: <code class="reqn">\alpha_0</code>, <code class="reqn">\alpha_1</code>, <code class="reqn">\beta</code>. In the asymmetric Gaussian case the tail index of the lower and upper tail of the first marginal are different, see Padoan and Stupfler (2020) for details. The available copulas are: Gaussian (<code>copula="Gaussian"</code>) with dependence parameter <code class="reqn">dep\in(-1,1)</code>, Student-<em>t</em> (<code>copula="studentT"</code>) with dependence parameters <code class="reqn">dep\in(-1,1)</code> and <code class="reqn">\nu&gt;0</code> (degrees of freedom), Gumbel (<code>copula="Gumbel"</code>) with dependence parameter <code class="reqn">dep&gt;0</code>. The parameters are specified as <code>par &lt;- list(alpha0, alpha1, beta, dep)</code> or <code>par &lt;- list(alpha0, alpha1, beta, dep, df)</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A vector of <code class="reqn">(2 \times n)</code> observations simulated from a specified bivariate time series model.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Brockwell, Peter J., and Richard A. Davis. (2016). Introduction to time series and forecasting. <em>Springer</em>.
</p>
<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+rtimeseries">rtimeseries</a>, <a href="#topic+expectiles">expectiles</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data simulation from a 2-dimensional AR(1) with bivariate Student-t distributed
# innovations, with one marginal distribution whose lower and upper tail indices
# that are different

tsDist &lt;- "AStudentT"
tsType &lt;- "AR"
tsCopula &lt;- "studentT"

# parameter setting
corr &lt;- 0.8
dep &lt;- 0.8
df &lt;- 3
par &lt;- list(corr=corr, dep=dep, df=df)

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rbtimeseries(ndata, tsDist, tsType, tsCopula, par)

# Extreme expectile estimation
plot(data, pch=21)
plot(data[,1], type="l")
plot(data[,2], type="l")
</code></pre>

<hr>
<h2 id='rmdata'>Simulation of <code class="reqn">d</code>-Dimensional Temporally Independent Observations</h2><span id='topic+rmdata'></span>

<h3>Description</h3>

<p>Simulates samples of independent <code class="reqn">d</code>-dimensional observations from parametric families of joint distributions with a given copula and equal marginal distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmdata (ndata, dist="studentT", copula="studentT", par)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmdata_+3A_ndata">ndata</code></td>
<td>
<p>A positive interger specifying the number of observations to simulate.</p>
</td></tr>
<tr><td><code id="rmdata_+3A_dist">dist</code></td>
<td>
<p>A string specifying the parametric family of equal marginal distributions. By default <code>dist="studentT"</code> specifies a
Student-<em>t</em> family of distributions. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="rmdata_+3A_copula">copula</code></td>
<td>
<p>A string specifying the type copula to be used. By default <code>copula="studentT"</code> specifies the Student-<em>t</em> copula. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="rmdata_+3A_par">par</code></td>
<td>
<p>A list of <code class="reqn">p</code> parameters to be specified for the multivariate parametric family of distributions. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a joint multivariate distribution with a given parametric copula class (<code>copula</code>) and a given parametric family of equal marginal distributions (<code>dist</code>), a sample of size <code>ndata</code> is simulated.
</p>

<ul>
<li><p> The available copula classes are: Student-<em>t</em> (<code>copula="studentT"</code>) with <code class="reqn">\nu&gt;0</code> degrees of freedom (<code>df</code>) and scale parameters <code class="reqn">\rho_{i,j}\in (-1,1)</code> for <code class="reqn">i \neq j=1,\ldots,d</code> (<code>sigma</code>), Gaussian (<code>copula="Gaussian"</code>) with correlation parameters <code class="reqn">\rho_{i,j}\in (-1,1)</code> for <code class="reqn">i \neq j=1,\ldots,d</code> (<code>sigma</code>), Clayton (<code>copula="Clayton"</code>) with dependence parameter <code class="reqn">\theta&gt;0</code> (<code>dep</code>), Gumbel (<code>copula="Gumbel"</code>) with dependence parameter <code class="reqn">\theta\geq 1</code> (<code>dep</code>) and Frank (<code>copula="Frank"</code>) with dependence parameter <code class="reqn">\theta&gt;0</code> (<code>dep</code>).
</p>
</li>
<li><p> The available families of marginal distributions are:
</p>

<ul>
<li><p> Student-<em>t</em> (<code>dist="studentT"</code>) with <code class="reqn">\nu&gt;0</code> degrees of freedom (<code>df</code>);
</p>
</li>
<li><p> Asymmetric Student-<em>t</em> (<code>dist="AStudentT"</code>) with <code class="reqn">\nu&gt;0</code> degrees of freedom (<code>df</code>). In this case all the observations are only positive;
</p>
</li>
<li><p> Frechet (<code>dist="Frechet"</code>) with scale <code class="reqn">\sigma&gt;0</code> (<code>scale</code>) and shape <code class="reqn">\alpha&gt;0</code> (<code>shape</code>) parameters.
</p>
</li>
<li><p> Frechet (<code>dist="double-Frechet"</code>) with scale <code class="reqn">\sigma&gt;0</code> (<code>scale</code>) and shape <code class="reqn">\alpha&gt;0</code> (<code>shape</code>) parameters. In this case positive and negative observations are allowed;
</p>
</li>
<li><p> symmetric Pareto (<code>dist="double-Pareto"</code>) with scale <code class="reqn">\sigma&gt;0</code> (<code>scale</code>) and shape <code class="reqn">\alpha&gt;0</code> (<code>shape</code>) parameters. In this case positive and negative observations are allowed.
</p>
</li></ul>

</li>
<li><p> The available classes of multivariate joint distributions are:
</p>

<ul>
<li><p> studentT-studentT (<code>dist="studentT"</code> and <code>copula="studentT"</code>) with parameters <code>par &lt;- list(df, sigma)</code>;
</p>
</li>
<li><p> studentT (<code>dist="studentT"</code> and <code>copula="None"</code> with parameters <code>par &lt;- list(df, dim)</code>. In this case the <code>d</code> variables are regarded as independent;
</p>
</li>
<li><p> studentT-AstudentT (<code>dist="AstudentT"</code> and <code>copula="studentT"</code>) with parameters <code>par &lt;- list(df, sigma, shape)</code>;
</p>
</li>
<li><p> Gaussian-studentT (<code>dist="studentT"</code> and <code>copula="Gaussian"</code>) with parameters <code>par &lt;- list(df, sigma)</code>;
</p>
</li>
<li><p> Gaussian-AstudentT (<code>dist="AstudentT"</code> and <code>copula="Gaussian"</code>) with parameters <code>par &lt;- list(df, sigma, shape)</code>;
</p>
</li>
<li><p> Frechet (<code>dist="Frechet"</code> and <code>copula="None"</code>) with parameters <code>par &lt;- list(shape, dim)</code>. In this case the <code>d</code> variables are regarded as independent;
</p>
</li>
<li><p> Clayton-Frechet (<code>dist="Frechet"</code> and <code>copula="Clayton"</code>) with parameters <code>par &lt;- list(dep, dim, scale, shape)</code>;
</p>
</li>
<li><p> Gumbel-Frechet (<code>dist="Frechet"</code> and <code>copula="Gumbel"</code>) with parameters <code>par &lt;- list(dep, dim, scale, shape)</code>;
</p>
</li>
<li><p> Frank-Frechet (<code>dist="Frechet"</code> and <code>copula="Frank"</code>) with parameters <code>par &lt;- list(dep, dim, scale, shape)</code>;
</p>
</li>
<li><p> Clayton-double-Frechet (<code>dist="double-Frechet"</code> and <code>copula="Clayton"</code>) with parameters <code>par &lt;- list(dep, dim, scale, shape)</code>;
</p>
</li>
<li><p> Gumbel-double-Frechet (<code>dist="double-Frechet"</code> and <code>copula="Gumbel"</code>) with parameters <code>par &lt;- list(dep, dim, scale, shape)</code>;
</p>
</li>
<li><p> Frank-double-Frechet (<code>dist="double-Frechet"</code> and <code>copula="Frank"</code>) with parameters <code>par &lt;- list(dep, dim, scale, shape)</code>;
</p>
</li>
<li><p> Clayton-double-Pareto (<code>dist="double-Pareto"</code> and <code>copula="Clayton"</code>) with parameters <code>par &lt;- list(dep, dim, scale, shape)</code>;
</p>
</li>
<li><p> Gumbel-double-Pareto (<code>dist="double-Pareto"</code> and <code>copula="Gumbel"</code>) with parameters <code>par &lt;- list(dep, dim, scale, shape)</code>;
</p>
</li>
<li><p> Frank-double-Pareto (<code>dist="double-Pareto"</code> and <code>copula="Frank"</code>) with parameters <code>par &lt;- list(dep, dim, scale, shape)</code>.
</p>
</li></ul>

<p>Note that above <code>dim</code> indicates the number of <code>d</code> marginal variables.
</p>
</li></ul>



<h3>Value</h3>

<p>A matrix of <code class="reqn">(n \times d)</code> observations simulated from a specified multivariate parametric joint distribution.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Joe, H. (2014). Dependence Modeling with Copulas. Chapman &amp; Hall/CRC Press, Boca
Raton, USA.
</p>
<p>Padoan A.S. and Stupfler, G. (2020). Joint inference on extreme expectiles for multivariate
heavy-tailed distributions. <em>arXiv e-prints</em> arXiv:2007.08944, <a href="https://arxiv.org/abs/2007.08944">https://arxiv.org/abs/2007.08944</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+rtimeseries">rtimeseries</a>, <a href="#topic+rbtimeseries">rbtimeseries</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(plot3D)
library(copula)
library(evd)

# Data simulation from a 3-dimensional random vector a with multivariate distribution
# given by a Gumbel copula and three equal Frechet marginal distributions

# distributional setting
copula &lt;- "Gumbel"
dist &lt;- "Frechet"

# parameter setting
dep &lt;- 3
dim &lt;- 3
scale &lt;- rep(1, dim)
shape &lt;- rep(3, dim)
par &lt;- list(dep=dep, scale=scale, shape=shape, dim=dim)

# sample size
ndata &lt;- 1000

# Simulates a sample from a multivariate distribution with equal Frechet
# marginal distributions and a Gumbel copula
data &lt;- rmdata(ndata, dist, copula, par)
scatter3D(data[,1], data[,2], data[,3])


# Data simulation from a 3-dimensional random vector a with multivariate distribution
# given by a Gaussian copula and three equal Student-t marginal distributions

# distributional setting
dist &lt;- "studentT"
copula &lt;- "Gaussian"

# parameter setting
rho &lt;- c(0.9, 0.8, 0.7)
sigma &lt;- c(1, 1, 1)
Sigma &lt;- sigma^2 * diag(dim)
Sigma[lower.tri(Sigma)] &lt;- rho
Sigma &lt;- t(Sigma)
Sigma[lower.tri(Sigma)] &lt;- rho
df &lt;- 3
par &lt;- list(sigma=Sigma, df=df)

# sample size
ndata &lt;- 1000

# Simulates a sample from a multivariate distribution with equal Student-t
# marginal distributions and a Gaussian copula
data &lt;- rmdata(ndata, dist, copula, par)
scatter3D(data[,1], data[,2], data[,3])
</code></pre>

<hr>
<h2 id='rtimeseries'>Simulation of One-Dimensional Temporally Dependent Observations</h2><span id='topic+rtimeseries'></span>

<h3>Description</h3>

<p>Simulates samples from parametric families of time series models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtimeseries(ndata, dist="studentT", type="AR", par, burnin=1e+03)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rtimeseries_+3A_ndata">ndata</code></td>
<td>
<p>A positive interger specifying the number of observations to simulate.</p>
</td></tr>
<tr><td><code id="rtimeseries_+3A_dist">dist</code></td>
<td>
<p>A string specifying the parametric family of the innovations distribution. By default <code>dist="studentT"</code> specifies a
Student-<em>t</em> family of distributions. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="rtimeseries_+3A_type">type</code></td>
<td>
<p>A string specifying the type of time series. By default <code>type="AR"</code> specifies a linear Auto-Regressive time series. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="rtimeseries_+3A_par">par</code></td>
<td>
<p>A vector of <code class="reqn">(1 \times p)</code> parameters to be specified for the univariate time series parametric family. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="rtimeseries_+3A_burnin">burnin</code></td>
<td>
<p>A positive interger specifying the number of initial observations to discard from the simulated sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a time series class (<code>type</code>) with a parametric family (<code>dist</code>) for the innovations, a sample of size <code>ndata</code> is simulated. See for example Brockwell and Davis (2016).
</p>

<ul>
<li><p> The available categories of time series models are: Auto-Regressive (<code>type="AR"</code>), Auto-Regressive and Moving-Average (<code>type="ARMA"</code>), Generalized-Autoregressive-Conditional-Heteroskedasticity (<code>type="GARCH"</code>) and Auto-Regressive and Moving-Maxima (<code>type="ARMAX"</code>).
</p>
</li>
<li><p> With AR(1) and ARMA(1,1) times series the available families of distributions for the innovations are:
</p>

<ul>
<li><p> Student-<em>t</em> (<code>dist="studentT"</code>) with parameters: <code class="reqn">\phi\in(-1,1)</code> (autoregressive coefficient), <code class="reqn">\nu&gt;0</code> (degrees of freedom) specified by <code>par=c(corr, df)</code>;
</p>
</li>
<li><p> symmetric Frechet (<code>dist="double-Frechet"</code>) with parameters <code class="reqn">\phi\in(-1,1)</code> (autoregressive coefficient), <code class="reqn">\sigma&gt;0</code> (scale), <code class="reqn">\alpha&gt;0</code> (shape), <code class="reqn">\theta</code> (movingaverage coefficient), specified by <code>par=c(corr, scale, shape, smooth)</code>;
</p>
</li>
<li><p> symmetric Pareto (<code>dist="double-Pareto"</code>) with parameters <code class="reqn">\phi\in(-1,1)</code> (autoregressive coefficient), <code class="reqn">\sigma&gt;0</code> (scale), <code class="reqn">\alpha&gt;0</code> (shape), <code class="reqn">\theta</code> (movingaverage coefficient), specified by <code>par=c(corr, scale, shape, smooth)</code>.
</p>
</li></ul>

<p>With ARCH(1)/GARCH(1,1) time series the Gaussian family of distributions is available for the innovations (<code>dist="Gaussian"</code>) with parameters, <code class="reqn">\alpha_0</code>, <code class="reqn">\alpha_1</code>, <code class="reqn">\beta</code> specified by <code>par=c(alpha0, alpha1, beta)</code>. Finally, with ARMAX(1) times series the Frechet families of distributions is available for the innovations (<code>dist="Frechet"</code>) with parameters, <code class="reqn">\phi\in(-1,1)</code> (autoregressive coefficient), <code class="reqn">\sigma&gt;0</code> (scale), <code class="reqn">\alpha&gt;0</code> (shape) specified by <code>par=c(corr, scale, shape)</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A vector of <code class="reqn">(1 \times n)</code> observations simulated from a specified time series model.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="http://mypage.unibocconi.it/simonepadoan/">http://mypage.unibocconi.it/simonepadoan/</a>;
Gilles Stupfler, <a href="mailto:gilles.stupfler@ensai.fr">gilles.stupfler@ensai.fr</a>,
<a href="http://ensai.fr/en/equipe/stupfler-gilles/">http://ensai.fr/en/equipe/stupfler-gilles/</a>
</p>


<h3>References</h3>

<p>Brockwell, Peter J., and Richard A. Davis. (2016). Introduction to time series and forecasting. <em>Springer</em>.
</p>
<p>Padoan A.S. and Stupfler, G. (2020). Extreme expectile estimation for heavy-tailed time series. <em>arXiv e-prints</em> arXiv:2004.04078, <a href="https://arxiv.org/abs/2004.04078">https://arxiv.org/abs/2004.04078</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+expectiles">expectiles</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data simulation from a 1-dimensional AR(1) with univariate Student-t
# distributed innovations

tsDist &lt;- "studentT"
tsType &lt;- "AR"

# parameter setting
corr &lt;- 0.8
df &lt;- 3
par &lt;- c(corr, df)

# sample size
ndata &lt;- 2500

# Simulates a sample from an AR(1) model with Student-t innovations
data &lt;- rtimeseries(ndata, tsDist, tsType, par)

# Graphic representation
plot(data, type="l")
acf(data)

</code></pre>

<hr>
<h2 id='sp500'>Negative log-returns of S\&amp;P 500.</h2><span id='topic+sp500'></span>

<h3>Description</h3>

<p>Series of negative log-returns of the U.S. stock market index Standard and Poor 500.</p>


<h3>Format</h3>

<p>A <code class="reqn">8784*2</code> data frame.</p>


<h3>Details</h3>

<p>From the series of n = 8785 closing prices <code class="reqn">S_{t}</code>, <code class="reqn">t=1,2,...</code>, for the Standard and Poor 500 stock market index, recorded from January 29, 1985 to December 12, 2019, the series of negative log-returns.
</p>
<p><code class="reqn">
X_{t+1} = - \log(S_{t+1}/S_t), \quad 1\leq t\leq n-1</code>
</p>
<p>is available. Hence the dataset (negative log-returns) contains <code class="reqn">8784</code> observations.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
