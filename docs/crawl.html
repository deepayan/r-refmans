<!DOCTYPE html><html><head><title>Help for package crawl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {crawl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#crawl-package'><p>Fit Continuous-Time Correlated Random Walk Models to Animal Movement Data</p></a></li>
<li><a href='#[.crwIS'><p>Generic subset/bracket method for crwIS classes</p></a></li>
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#aic.crw'><p>Calculates AIC for all objects of class crwFit listed as arguments</p></a></li>
<li><a href='#argosDiag2Cov'><p>Transform Argos diagnostic data to covariance matrix form</p></a></li>
<li><a href='#as.flat'><p>'Flattening' a list-form crwPredict object into a data.frame</p></a></li>
<li><a href='#beardedSeals'><p>Bearded Seal Location Data</p></a></li>
<li><a href='#crw_as_sf'><p>Coerce to sf/sfc object</p></a></li>
<li><a href='#crw_as_tibble'><p>Coerce crawl objects (crwIS and crwPredict) to tibbles</p></a></li>
<li><a href='#crwMLE'><p>Fit Continuous-Time Correlated Random Walk Models to Animal Telemetry Data</p></a></li>
<li><a href='#crwN2ll'><p>-2 * log-likelihood for CTCRW models</p></a></li>
<li><a href='#crwPostIS'><p>Simulate a value from the posterior distribution of a CTCRW model</p></a></li>
<li><a href='#crwPredict'><p>Predict animal locations and velocities using a fitted CTCRW model and</p>
calculate measurement error fit statistics</a></li>
<li><a href='#crwPredictPlot'><p>Plot CRW predicted object</p></a></li>
<li><a href='#crwSamplePar'><p>Create a weighted importance sample for posterior predictive track</p>
simulation.</a></li>
<li><a href='#crwSimulator'><p>Construct a posterior simulation object for the CTCRW state vectors</p></a></li>
<li><a href='#detect_timescale'><p>Detect appropriate time scale for movement analysis</p></a></li>
<li><a href='#displayPar'><p>Display the order of parameters along with fixed values and starting values</p></a></li>
<li><a href='#expandPred'><p>Expand a time indexed data set with additional prediction times</p></a></li>
<li><a href='#fillCols'><p>Fill missing values in data set (or matrix) columns for which there is a</p>
single unique value</a></li>
<li><a href='#fix_path'><p>fix_path function id depreciated.</p></a></li>
<li><a href='#flatten'><p>'Flattening' a list-form crwPredict object into a data.frame</p></a></li>
<li><a href='#harborSeal'><p>Harbor seal location data set used in Johnson et al. (2008)</p></a></li>
<li><a href='#harborSeal_sf'><p>Harbor seal location data updated since Johnson et al. (2008)</p></a></li>
<li><a href='#intToPOSIX'><p>Reverse as.numeric command that is performed on a vector of type POSIXct</p></a></li>
<li><a href='#mergeTrackStop'><p>Merge a location data set with a dry time (or other stopping) covariate</p></a></li>
<li><a href='#northernFurSeal'><p>Northern fur seal pup relocation data set used in Johnson et al. (2008)</p></a></li>
<li><a href='#tidy_crwFit'><p>tidy-like method for crwFit object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fit Continuous-Time Correlated Random Walk Models to Animal
Movement Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-06</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, Rcpp (&ge; 0.11.1), methods, dplyr, sf, sp, tibble,
magrittr, lubridate, purrr, rlang</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit continuous-time correlated random walk models with time indexed
    covariates to animal telemetry data. The model is fit using the Kalman-filter on
    a state space version of the continuous-time stochastic movement process.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-06 21:31:16 UTC; devin.johnson</td>
</tr>
<tr>
<td>Author:</td>
<td>Devin S. Johnson [aut, cre],
  Josh London [aut],
  Brett T. McClintock [ctb],
  Kenady Wilson [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Devin S. Johnson &lt;devin.johnson@noaa.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-09 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='crawl-package'>Fit Continuous-Time Correlated Random Walk Models to Animal Movement Data</h2><span id='topic+crawl-package'></span><span id='topic+crawl'></span>

<h3>Description</h3>

<p>The [C]orrelated [RA]ndom [W]alk [L]ibrary (I know it is not an R library,
but, &quot;crawp&quot; did not sound as good) of R functions was designed for fitting
continuous-time correlated random walk (CTCRW) models with time indexed
covariates. The model is fit using the Kalman-Filter on a state space
version of the continuous-time stochastic movement process.
</p>

<table>
<tr>
 <td style="text-align: left;"> 
Package: </td><td style="text-align: left;"> crawl</td>
</tr>
<tr>
 <td style="text-align: left;"> 
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> 
Version: </td><td style="text-align: left;"> 2.3.0</td>
</tr>
<tr>
 <td style="text-align: left;"> 
Date: </td><td style="text-align: left;"> October 6, 2022</td>
</tr>
<tr>
 <td style="text-align: left;"> 
License: </td><td style="text-align: left;"> CC0 </td>
</tr>
<tr>
 <td style="text-align: left;"> 
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;"> 
</td>
</tr>

</table>



<h3>Note</h3>

<p>This software package is developed and maintained by scientists at the NOAA Fisheries Alaska 
Fisheries Science Center and should be considered a fundamental research communication. 
The recommendations and conclusions presented here are those of 
the authors and this software should not be construed as official communication by NMFS, NOAA, 
or the U.S. Dept. of Commerce. In addition, reference to trade names does not imply endorsement by the 
National Marine Fisheries Service, NOAA. While the best efforts have been made to insure the 
highest quality, tools such as this are under constant development and are subject to change.
</p>


<h3>Author(s)</h3>

<p>Josh London and Devin S. Johnson 
</p>
<p>Maintainer: Devin S. Johnson &lt;devin.johnson@noaa.gov&gt;
</p>


<h3>References</h3>

<p>Johnson, D., J. London, M. -A. Lea, and J. Durban (2008)
Continuous-time correlated random walk model for animal telemetry data.
Ecology 89(5) 1208-1215.
</p>

<hr>
<h2 id='+5B.crwIS'>Generic subset/bracket method for crwIS classes</h2><span id='topic++5B.crwIS'></span>

<h3>Description</h3>

<p>Generic subset/bracket method for crwIS classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'crwIS'
x[i, ..., drop = TRUE]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B.crwIS_+3A_x">x</code></td>
<td>
<p>crwIS object</p>
</td></tr>
<tr><td><code id="+2B5B.crwIS_+3A_i">i</code></td>
<td>
<p>elements to extract or replace. These are numeric or character or, 
empty or logical. Numeric values are coerced to integer as if by <code>as.integer</code></p>
</td></tr>
<tr><td><code id="+2B5B.crwIS_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
<tr><td><code id="+2B5B.crwIS_+3A_drop">drop</code></td>
<td>
<p>logical. If TRUE the result is coerced to the lowest possible 
dimension.</p>
</td></tr>
</table>

<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic++25+3E+25">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='aic.crw'>Calculates AIC for all objects of class crwFit listed as arguments</h2><span id='topic+aic.crw'></span>

<h3>Description</h3>

<p>AIC, delta AIC, and Akaike weights for all models listed as arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aic.crw(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aic.crw_+3A_...">...</code></td>
<td>
<p>a series of crwFit objects</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can either be executed with a series of 'crwFit' objects (see
<code><a href="#topic+crwMLE">crwMLE</a></code>) without the '.crwFit' suffix or the function can be
called without any arguments and it will search out all 'crwFit' objects in
the current workspace and produce the model selection table for all 'crwFit'
objects in the workspace. Caution should be used when executing the function
in this way. ALL 'crwFit' objects will be included whether or not the same
locations are used!  For all of the models listed as arguments (or in the
workspace), AIC, delta AIC, and Akaike weights will be calculated.
</p>


<h3>Value</h3>

<p>A table, sorted from lowest AIC value to highest.
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>

<hr>
<h2 id='argosDiag2Cov'>Transform Argos diagnostic data to covariance matrix form</h2><span id='topic+argosDiag2Cov'></span>

<h3>Description</h3>

<p>Using this function the user can transform the Argos diagnostic data for location
error into a form usable as a covariance matrix to approximate the location error with a
bivariate Gaussian distribution. The resulting data.frame should be attached back to the data
with <code>cbind</code> to use with the <code>crwMLE</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>argosDiag2Cov(Major, Minor, Orientation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="argosDiag2Cov_+3A_major">Major</code></td>
<td>
<p>A vector containing the major axis information for each observation (na values are ok)</p>
</td></tr>
<tr><td><code id="argosDiag2Cov_+3A_minor">Minor</code></td>
<td>
<p>A vector containing the minor axis information for each observation (na values are ok)</p>
</td></tr>
<tr><td><code id="argosDiag2Cov_+3A_orientation">Orientation</code></td>
<td>
<p>A vector containing the angle orientation of the Major axis from North (na values are ok)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the following columns
</p>
<table>
<tr><td><code>ln.sd.x</code></td>
<td>
<p>The log standard deviation of the location error in the x coordinate</p>
</td></tr>
<tr><td><code>ln.sd.y</code></td>
<td>
<p>The log standard deviation of the location error in the x coordinate</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>The correlation of the bivariate location error ellipse</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>

<hr>
<h2 id='as.flat'>'Flattening' a list-form crwPredict object into a data.frame</h2><span id='topic+as.flat'></span>

<h3>Description</h3>

<p>&ldquo;Flattens&rdquo; a list form <code><a href="#topic+crwPredict">crwPredict</a></code> object into a flat
data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.flat(predObj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.flat_+3A_predobj">predObj</code></td>
<td>
<p>A crwPredict object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> version of a crwPredict list with columns
for the state standard errors
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+northernFurSeal">northernFurSeal</a></code> for use example
</p>

<hr>
<h2 id='beardedSeals'>Bearded Seal Location Data</h2><span id='topic+beardedSeals'></span>

<h3>Description</h3>

<p>Bearded Seal Location Data
</p>


<h3>Format</h3>

<p>A data frame with 27,548 observations on 3 bearded seals in Alaska:
</p>

<dl>
<dt>deployid</dt><dd><p>Unique animal ID</p>
</dd>
<dt>ptt</dt><dd><p>Hardware ID</p>
</dd>
<dt>instr</dt><dd><p>Hardware type</p>
</dd>
<dt>date_time</dt><dd><p>Time of location</p>
</dd>
<dt>type</dt><dd><p>Location type</p>
</dd>
<dt>quality</dt><dd><p>Argos location quality</p>
</dd>
<dt>latitude</dt><dd><p>Observed latitude</p>
</dd>
<dt>longitude</dt><dd><p>Observed longitude</p>
</dd>
<dt>error_radius</dt><dd><p>Argos error radius</p>
</dd>
<dt>error_semimajor_axis</dt><dd><p>Argos error ellipse major axis length</p>
</dd>
<dt>error_semiminor_axis</dt><dd><p>Argos error ellipse minor axis length</p>
</dd>
<dt>error_ellipse_orientation</dt><dd><p>Argos error ellipse degree orientation</p>
</dd>
</dl>



<h3>Source</h3>

<p>Marine Mammal Laboratory, Alaska
Fisheries Science Center, National Marine Fisheries Service, NOAA 7600 Sand
Point Way NE Seattle, WA 98115
</p>

<hr>
<h2 id='crw_as_sf'>Coerce to sf/sfc object</h2><span id='topic+crw_as_sf'></span><span id='topic+crw_as_sf.crwIS'></span><span id='topic+crw_as_sf.crwPredict'></span><span id='topic+crw_as_sf.list'></span>

<h3>Description</h3>

<p>Provides reliable conversion of <code>"crwIS"</code> and <code>"crwPredict"</code> objects
into simple features objects supported in the <code>"sf"</code> package. Both 
<code>"sf"</code> objects with &quot;POINT&quot; geometry and <code>"sfc_LINESTRING"</code> objects
are created. Coercion of <code>"crwPredict"</code> objects to <code>"sfc_LINESTRING"</code>
has an option <code>"group"</code> argument when the <code>"crwPredict"</code> object
includes predictions from multiple deployments. The grouping column will be 
used and a tibble of multiple <code>"sf_LINESTRING"</code> objects will be returned
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crw_as_sf(data, ftype, locType, group)

## S3 method for class 'crwIS'
crw_as_sf(data, ftype, locType = c("p", "o", "f"), group = NULL, ...)

## S3 method for class 'crwPredict'
crw_as_sf(data, ftype, locType = c("p", "o", "f"), group = NULL, ...)

## S3 method for class 'list'
crw_as_sf(data, ftype, locType = c("p", "o", "f"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crw_as_sf_+3A_data">data</code></td>
<td>
<p>an object of class <code>"crwIS"</code> or <code>"crwPredict"</code></p>
</td></tr>
<tr><td><code id="crw_as_sf_+3A_ftype">ftype</code></td>
<td>
<p>character of either &quot;POINT&quot; or &quot;LINESTRING&quot; specifying the feature type</p>
</td></tr>
<tr><td><code id="crw_as_sf_+3A_loctype">locType</code></td>
<td>
<p>character vector of location points to include (&quot;p&quot;,&quot;o&quot;)</p>
</td></tr>
<tr><td><code id="crw_as_sf_+3A_group">group</code></td>
<td>
<p>(optional) character specifying the column to group by for multiple LINESTRING features</p>
</td></tr>
<tr><td><code id="crw_as_sf_+3A_...">...</code></td>
<td>
<p>Additional arguments that are ignored</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>crw_as_sf(crwIS)</code>: coerce crwIS object to sf (POINT or 
LINESTRING geometry)
</p>
</li>
<li> <p><code>crw_as_sf(crwPredict)</code>: coerce crwPredict object to sf (POINT or 
LINESTRING geometry)
</p>
</li>
<li> <p><code>crw_as_sf(list)</code>: coerce list of crwIS objects to sf (LINESTRING or 
MULTILINESTRING geometry)
</p>
</li></ul>

<hr>
<h2 id='crw_as_tibble'>Coerce crawl objects (crwIS and crwPredict) to tibbles</h2><span id='topic+crw_as_tibble'></span><span id='topic+crw_as_tibble.crwIS'></span><span id='topic+crw_as_tibble.crwPredict'></span><span id='topic+crw_as_tibble.tbl'></span>

<h3>Description</h3>

<p>Coerce crawl objects (crwIS and crwPredict) to tibbles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crw_as_tibble(crw_object, ...)

## S3 method for class 'crwIS'
crw_as_tibble(crw_object, ...)

## S3 method for class 'crwPredict'
crw_as_tibble(crw_object, ...)

## S3 method for class 'tbl'
crw_as_tibble(crw_object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crw_as_tibble_+3A_crw_object">crw_object</code></td>
<td>
<p>an object of class <code>"crwIS"</code> or <code>"crwPredict"</code></p>
</td></tr>
<tr><td><code id="crw_as_tibble_+3A_...">...</code></td>
<td>
<p>Additional arguments that are ignored</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>crw_as_tibble(crwIS)</code>: coerce crwIS object to tibble
</p>
</li>
<li> <p><code>crw_as_tibble(crwPredict)</code>: coerce crwPredict object to tibble
</p>
</li>
<li> <p><code>crw_as_tibble(tbl)</code>: 
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Josh M. London
</p>

<hr>
<h2 id='crwMLE'>Fit Continuous-Time Correlated Random Walk Models to Animal Telemetry Data</h2><span id='topic+crwMLE'></span><span id='topic+crwMLE.default'></span><span id='topic+crwMLE.SpatialPoints'></span><span id='topic+crwMLE.sf'></span>

<h3>Description</h3>

<p>The function uses the Kalman filter to estimate movement parameters in a
state-space version of the continuous-time movement model. Separate models
are specified for movement portion and the location error portion. Each
model can depend on time indexed covariates. A &ldquo;haul out&rdquo; model where
movement is allowed to completely stop, as well as, a random drift model can
be fit with this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crwMLE(data, ...)

## Default S3 method:
crwMLE(
  data,
  mov.model = ~1,
  err.model = NULL,
  activity = NULL,
  drift = FALSE,
  coord = c("x", "y"),
  proj = NULL,
  Time.name = "time",
  time.scale = NULL,
  theta = NULL,
  fixPar = NULL,
  method = "Nelder-Mead",
  control = NULL,
  constr = list(lower = -Inf, upper = Inf),
  prior = NULL,
  need.hess = TRUE,
  initialSANN = list(maxit = 200),
  attempts = 1,
  retrySD = 1,
  skip_check = FALSE,
  ...
)

## S3 method for class 'SpatialPoints'
crwMLE(
  data,
  mov.model = ~1,
  err.model = NULL,
  activity = NULL,
  drift = FALSE,
  Time.name = "time",
  time.scale = NULL,
  theta = NULL,
  fixPar = NULL,
  method = "Nelder-Mead",
  control = NULL,
  constr = list(lower = -Inf, upper = Inf),
  prior = NULL,
  need.hess = TRUE,
  initialSANN = list(maxit = 200),
  attempts = 1,
  retrySD = 1,
  skip_check = FALSE,
  coord = NULL,
  ...
)

## S3 method for class 'sf'
crwMLE(
  data,
  mov.model = ~1,
  err.model = NULL,
  activity = NULL,
  drift = FALSE,
  Time.name = "time",
  time.scale = NULL,
  theta = NULL,
  fixPar = NULL,
  method = "Nelder-Mead",
  control = NULL,
  constr = list(lower = -Inf, upper = Inf),
  prior = NULL,
  need.hess = TRUE,
  initialSANN = list(maxit = 200),
  attempts = 1,
  retrySD = 1,
  skip_check = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crwMLE_+3A_data">data</code></td>
<td>
<p>a data set of location observations as a data.frame, tibble,
SpatialPointsDataFrame ('sp' package), or a data.frame of class 'sf' that
contains a geometry column of type <code>sfc_POINT</code></p>
</td></tr>
<tr><td><code id="crwMLE_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_mov.model">mov.model</code></td>
<td>
<p>formula object specifying the time indexed covariates for
movement parameters.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_err.model">err.model</code></td>
<td>
<p>A 2-element list of formula objects specifying the time
indexed covariates for location error parameters.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_activity">activity</code></td>
<td>
<p>formula object giving the covariate for the activity (i.e., stopped or fully moving)
portion of the model.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_drift">drift</code></td>
<td>
<p>logical indicating whether or not to include a random
drift component. For most data this is usually not necessary. See <code><a href="#topic+northernFurSeal">northernFurSeal</a></code> for an example
using a drift model.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_coord">coord</code></td>
<td>
<p>A 2-vector of character values giving the names of the &quot;X&quot; and
&quot;Y&quot; coordinates in <code>data</code>. Ignored if <code>data</code> inherits class
'sf' or 'sp'.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_proj">proj</code></td>
<td>
<p>A valid epsg integer code or proj4string for <code>data</code> that does not
inherit either 'sf' or 'sp'. A valid 'crs' list is also accepted. Otherwise, ignored.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_time.name">Time.name</code></td>
<td>
<p>character indicating name of the location time column. It is
strongly preferred that this column be of type POSIXct and in UTC.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_time.scale">time.scale</code></td>
<td>
<p>character. Scale for conversion of POSIX time to numeric 
for modeling. Defaults to &quot;hours&quot; and most users will not need to change this.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_theta">theta</code></td>
<td>
<p>starting values for parameter optimization.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_fixpar">fixPar</code></td>
<td>
<p>Values of parameters which are held fixed to the given value.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_method">method</code></td>
<td>
<p>Optimization method that is passed to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_control">control</code></td>
<td>
<p>Control list which is passed to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_constr">constr</code></td>
<td>
<p>Named list with elements <code>lower</code> and <code>upper</code> that
are vectors the same length as theta giving the box constraints for the
parameters</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_prior">prior</code></td>
<td>
<p>A function returning the log-density function of the parameter
prior distribution. THIS MUST BE A FUNCTION OF ONLY THE FREE PARAMETERS. Any 
fixed parameters should not be included.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_need.hess">need.hess</code></td>
<td>
<p>A logical value which decides whether or not to evaluate
the Hessian for parameter standard errors</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_initialsann">initialSANN</code></td>
<td>
<p>Control list for <code><a href="stats.html#topic+optim">optim</a></code> when simulated
annealing is used for obtaining start values. See details</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_attempts">attempts</code></td>
<td>
<p>The number of times likelihood optimization will be
attempted in cases where the fit does not converge or is otherwise non-valid</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_retrysd">retrySD</code></td>
<td>
<p>optional user-provided standard deviation for adjusting
starting values when attempts &gt; 1. Default value is 1.</p>
</td></tr>
<tr><td><code id="crwMLE_+3A_skip_check">skip_check</code></td>
<td>
<p>Skip the likelihood optimization check and return the fitted values.
Can be useful for debugging problem fits.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> A full model specification involves 4 components: a movement model, an
activity model, 2 location error models, and a drift indication. The
movement model (<code>mov.model</code>) specifies how the movement parameters
should vary over time. This is a function of specified, time-indexed,
covariates. The movement parameters (sigma for velocity variation and beta
for velocity autocorrelation) are both modeled with a log link as par =
exp(eta), where eta is the linear predictor based on the covariates. The
<code>err.model</code> specification is a list of 2 such models, one for
&ldquo;X (longitude)&rdquo; and one for &ldquo;Y (latitude)&rdquo; (in that order) location
error. If only one location error model is given, it is used for both
coordinates (parameter values as well). If <code>drift.model</code> is set to
<code>TRUE</code>, then, 2 additional parameters are estimated for the drift
process, a drift variance and a beta multiplier. 
</p>
</li>
<li> <p><code>theta</code> and <code>fixPar</code> are vectors with the appropriate number or
parameters. <code>theta</code> contains only those parameters which are to be
estimated, while <code>fixPar</code> contains all parameter values with <code>NA</code>
for parameters which are to be estimated.
</p>
</li>
<li><p> The data set specified by <code>data</code> must contain a numeric or POSIXct column which is
used as the time index for analysis. The column name is specified by the
<code>Time.name</code> argument and it is strongly suggested that this column be of
POSIXct type and in UTC. If a POSIXct column is used it is internally converted to a
numeric vector with units of <code>time.scale</code>. <code>time.scale</code> defaults to
NULL and an appropriate option will be chosen (&quot;seconds&quot;,&quot;minutes&quot;,&quot;days&quot;,&quot;weeks&quot;)
based on the median time interval. The user can override this by specifying one
of those time intervals directly. If a numeric time vector is used, then 
the <code>time.scale</code> is ignored and there
is no adjustment to the data. Also, for activity models, the
activity covariate must be between 0 and 1 inclusive, with 0 representing complete stop
of the animal (no true movement, however, location error can still occur) and 1 
represent unhindered movement. The coordinate location should have <code>NA</code> where no
location is recorded, but there is a change in the movement covariates.
</p>
</li>
<li><p> The CTCRW models can be difficult to provide good initial values for
optimization. If <code>initialSANN</code> is specified then simulated annealing is
used first to obtain starting values for the specified optimization method.
If simulated annealing is used first, then the returned <code>init</code> list of
the crwFit object will be a list with the results of the simulated annealing
optimization.
</p>
</li>
<li><p> The <code>attempts</code> argument instructs <code>crwMLE</code> to attempt a fit
multiple times. Each time, the fit is inspected for convergence, whether
the covariance matrix could be calculated, negative values in the diag 
of the covariance matrix, or NA values in the standard errors. If, after
n attempts, the fit is still not valid a <code>simpleError</code> object is
returned. Users should consider increasing the number of attempts OR
adjusting the standard deviation value for each attempt by setting
<code>retrySD</code>. The default value for <code>retrySD</code> is 1, but users may
need to increase or decrease to find a valid fit. Adjusting other
model parameters may also be required.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>par</code></td>
<td>
<p>Parameter maximum likelihood estimates (including fixed parameters)</p>
</td></tr>
<tr><td><code>estPar</code></td>
<td>
<p>MLE without fixed parameters</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Standard error of MLE</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>95% confidence intervals for parameters</p>
</td></tr>
<tr><td><code>Cmat</code></td>
<td>
<p>Parameter covariance matrix</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Maximized log-likelihood value</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Model AIC value</p>
</td></tr>
<tr><td><code>coord</code></td>
<td>
<p>Coordinate names provided for fitting</p>
</td></tr>
<tr><td><code>fixPar</code></td>
<td>
<p>Fixed parameter values provided</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>Indicator of convergence (0 = converged)</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>Messages given by <code>optim</code> during parameter optimization</p>
</td></tr>
<tr><td><code>activity</code></td>
<td>
<p>Model provided for stopping variable</p>
</td></tr>
<tr><td><code>drift</code></td>
<td>
<p>Logical value indicating random drift model</p>
</td></tr>
<tr><td><code>mov.model</code></td>
<td>
<p>Model description for movement component</p>
</td></tr>
<tr><td><code>err.model</code></td>
<td>
<p>Model description for location error component</p>
</td></tr>
<tr><td><code>n.par</code></td>
<td>
<p>number of parameters</p>
</td></tr>
<tr><td><code>nms</code></td>
<td>
<p>parameter names</p>
</td></tr>
<tr><td><code>n.mov</code></td>
<td>
<p>number of movement parameters</p>
</td></tr>
<tr><td><code>n.errX</code></td>
<td>
<p>number or location error parameters for &ldquo;longitude&rdquo; error model</p>
</td></tr>
<tr><td><code>n.errY</code></td>
<td>
<p>number or location error parameters for &ldquo;latitude&rdquo; error model</p>
</td></tr>
<tr><td><code>stop.mf</code></td>
<td>
<p>covariate for stop indication in stopping models</p>
</td></tr>
<tr><td><code>polar.coord</code></td>
<td>
<p>Logical indicating coordinates are polar latitude and longitude</p>
</td></tr>
<tr><td><code>init</code></td>
<td>
<p>Initial values for parameter optimization</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Original data.frame used to fit the model</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>The lower parameter bounds</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>The upper parameter bounds</p>
</td></tr>
<tr><td><code>need.hess</code></td>
<td>
<p>Logical value</p>
</td></tr>
<tr><td><code>runTime</code></td>
<td>
<p>Time used to fit model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Devin S. Johnson, Josh M. London
</p>

<hr>
<h2 id='crwN2ll'>-2 * log-likelihood for CTCRW models</h2><span id='topic+crwN2ll'></span>

<h3>Description</h3>

<p>This function is designed for primary use within the <code><a href="#topic+crwMLE">crwMLE</a></code>
model fitting function. But, it can be accessed for advanced <code>R</code> and
<code>crawl</code> users. Uses the state-space parameterization and Kalman filter
method presented in Johnson et al. (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crwN2ll(
  theta,
  fixPar,
  y,
  noObs,
  delta,
  mov.mf,
  err.mfX,
  err.mfY,
  rho = NULL,
  activity = NULL,
  n.errX,
  n.errY,
  n.mov,
  driftMod,
  prior,
  need.hess,
  constr = list(lower = -Inf, upper = Inf)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crwN2ll_+3A_theta">theta</code></td>
<td>
<p>parameter values.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_fixpar">fixPar</code></td>
<td>
<p>values of parameters held fixed (contains <code>NA</code> for
<code>theta</code> values).</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_y">y</code></td>
<td>
<p>N by 2 matrix of coordinates with the longitude coordinate in the first column.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_noobs">noObs</code></td>
<td>
<p>vector with 1 for unobserved locations, and 0 for observed locations.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_delta">delta</code></td>
<td>
<p>time difference to next location.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_mov.mf">mov.mf</code></td>
<td>
<p>Movement covariate data.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_err.mfx">err.mfX</code></td>
<td>
<p>longitude error covariate data.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_err.mfy">err.mfY</code></td>
<td>
<p>latitude error covariate data.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_rho">rho</code></td>
<td>
<p>A vector of known correlation coefficients for the error model, typically used for modern ARGOS data.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_activity">activity</code></td>
<td>
<p>Stopping covariate (= 0 if animal is not moving).</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_n.errx">n.errX</code></td>
<td>
<p>number or longitude error parameters.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_n.erry">n.errY</code></td>
<td>
<p>number of latitude error parameters.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_n.mov">n.mov</code></td>
<td>
<p>number or movement parameters.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_driftmod">driftMod</code></td>
<td>
<p>Logical. indicates whether a drift model is specified.</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_prior">prior</code></td>
<td>
<p>Function of theta that returns the log-density of the prior</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_need.hess">need.hess</code></td>
<td>
<p>Whether or not the Hessian will need to be calculated from
this call</p>
</td></tr>
<tr><td><code id="crwN2ll_+3A_constr">constr</code></td>
<td>
<p>Named list giving the parameter constraints</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls compiled C++ code which can be viewed in the
<code>src</code> directory of the crawl source package.
</p>


<h3>Value</h3>

<p>-2 * log-likelihood value for specified CTCRW model.
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>References</h3>

<p>Johnson, D., J. London, M. -A. Lea, and J. Durban. 2008.
Continuous-time model for animal telemetry data. Ecology 89:1208-1215.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crwMLE">crwMLE</a></code>
</p>

<hr>
<h2 id='crwPostIS'>Simulate a value from the posterior distribution of a CTCRW model</h2><span id='topic+crwPostIS'></span>

<h3>Description</h3>

<p>The crwPostIS draws a set of states from the posterior distribution of a
fitted CTCRW model. The draw is either conditioned on the fitted parameter
values or &quot;full&quot; posterior draw with approximated parameter posterior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crwPostIS(object.sim, fullPost = TRUE, df = Inf, scale = 1, thetaSamp = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crwPostIS_+3A_object.sim">object.sim</code></td>
<td>
<p>A crwSimulator object from <code><a href="#topic+crwSimulator">crwSimulator</a></code>.</p>
</td></tr>
<tr><td><code id="crwPostIS_+3A_fullpost">fullPost</code></td>
<td>
<p>logical. Draw parameter values as well to simulate full
posterior</p>
</td></tr>
<tr><td><code id="crwPostIS_+3A_df">df</code></td>
<td>
<p>degrees of freedom for multivariate t distribution approximation
to parameter posterior</p>
</td></tr>
<tr><td><code id="crwPostIS_+3A_scale">scale</code></td>
<td>
<p>Extra scaling factor for t distribution approximation</p>
</td></tr>
<tr><td><code id="crwPostIS_+3A_thetasamp">thetaSamp</code></td>
<td>
<p>If multiple parameter samples are available in object.sim,
setting <code>thetaSamp=n</code> will use the nth sample. Defaults to the last.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The crwPostIS draws a posterior sample of the track state matrices. If
fullPost was set to TRUE when the object.sim was build in
<a href="#topic+crwSimulator">crwSimulator</a> then a pseudo-posterior draw will be made by first
sampling a parameter value from a multivariate t distribution which
approximates the marginal posterior distribution of the parameters. The
covariance matrix from the fitted model object is used to scale the MVt
approximation. In addition, the factor &quot;scale&quot; can be used to further adjust
the approximation. Further, the parameter simulations are centered on the
fitted values.
</p>
<p>To correct for the MVt approximation, the importance sampling weight is also
supplied. When calculating averages of track functions for Bayes estimates
one should use the importance sampling weights to calculate a weighted
average (normalizing first, so the weights sum to 1).
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr><td><code>alpha.sim.y</code></td>
<td>
<p>A matrix a simulated latitude state values</p>
</td></tr>
<tr><td><code>alpha.sim.x</code></td>
<td>
<p>Matrix of simulated longitude state values</p>
</td></tr>
<tr><td><code>locType</code></td>
<td>
<p>Indicates prediction types with a &quot;p&quot; or observation times
with an &quot;o&quot;</p>
</td></tr> <tr><td><code>Time</code></td>
<td>
<p>Initial state covariance for latitude</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log likelihood of simulated parameter</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>Simulated parameter value</p>
</td></tr>
<tr><td><code>log.isw</code></td>
<td>
<p>non normalized log importance sampling weight</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>See Also</h3>

<p>See <code>demo(northernFurSealDemo)</code> for example.
</p>

<hr>
<h2 id='crwPredict'>Predict animal locations and velocities using a fitted CTCRW model and
calculate measurement error fit statistics</h2><span id='topic+crwPredict'></span>

<h3>Description</h3>

<p>The <code>crwMEfilter</code> function uses a fitted model object from
<code>crwMLE</code> to predict animal locations (with estimated uncertainty) at
times in the original data set and supplemented by times in <code>predTime</code>.
If <code>speedEst</code> is set to <code>TRUE</code>, then animal log-speed is also
estimated. In addition, the measurement error shock detection filter of de
Jong and Penzer (1998) is also calculated to provide a measure for outlier
detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crwPredict(object.crwFit, predTime = NULL, return.type = "minimal", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crwPredict_+3A_object.crwfit">object.crwFit</code></td>
<td>
<p>A model object from <code><a href="#topic+crwMLE">crwMLE</a></code>.</p>
</td></tr>
<tr><td><code id="crwPredict_+3A_predtime">predTime</code></td>
<td>
<p>vector of desired prediction times (numeric or POSIXct). Alternatively, a character vector specifying a time interval (see Details).</p>
</td></tr>
<tr><td><code id="crwPredict_+3A_return.type">return.type</code></td>
<td>
<p>character. Should be one of <code>"minimal","flat","list"</code> (see Details).</p>
</td></tr>
<tr><td><code id="crwPredict_+3A_...">...</code></td>
<td>
<p>Additional arguments for testing new features</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The requirements for <code>data</code> are the same as those for fitting the model
in <code><a href="#topic+crwMLE">crwMLE</a></code>.
</p>

<ul>
<li><p>(&quot;predTime&quot;)
<code>predTime</code> can be either passed as a separate vector of POSIXct or 
numeric values for all prediction times expected in the returned object. 
Note, previous versions of <code>crwPredict</code> would return both times 
specified via <code>predTime</code> as well as each original observed time. This is
no longer the default (see </p>
<p>return.type). If the original data were 
provided as a POSIXct type, then <code>crwPredict</code> can derive a sequence of 
regularly spaced prediction times from the original data. This is specified 
by providing a character string that corresponds to the <code>by</code> argument 
of the <code>seq.POSIXt</code> function (e.g. '1 hour', '30 mins'). 
<code>crwPredict</code> will round the first observed time up to the nearest unit 
(e.g. '1 hour' will round up to the nearest hour, '30 mins' will round up to 
the nearest minute) and start the sequence from there. The last observation 
time is truncated down to the nearest unit to specify the end time.

</p>
</li></ul>



<h3>Value</h3>

<p>There are three possible return types specified with <code>return.type</code>:
</p>
<table>
<tr><td><code>minimal</code></td>
<td>
<p>a data.frame with a minimal set of columns: 
<code>date_time,mu.x,mu.y,se.mu.x,se.mu.y</code></p>
</td></tr>
<tr><td><code>flat</code></td>
<td>
<p>a data set is returned with the
columns of the original data plus the state estimates, standard errors (se),
and speed estimates</p>
</td></tr>
<tr><td><code>list</code></td>
<td>
<p>List with the following elements:</p>
</td></tr>
<tr><td><code>originalData</code></td>
<td>
<p>A data.frame with <code>data</code> merged with
<code>predTime</code>.</p>
</td></tr>
<tr><td><code>alpha.hat</code></td>
<td>
<p>Predicted state</p>
</td></tr>
<tr><td><code>Var.hat</code></td>
<td>
<p>array where <code>Var.hat[,,i]</code> is the prediction
covariance matrix for <code>alpha.hat[,i]</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>References</h3>

<p>de Jong, P. and Penzer, J. (1998) Diagnosing shocks in time
series. Journal of the American Statistical Association 93:796-806.
</p>

<hr>
<h2 id='crwPredictPlot'>Plot CRW predicted object</h2><span id='topic+crwPredictPlot'></span>

<h3>Description</h3>

<p>Creates 2 types of plots of a crwPredict object: a plot of both coordinate
axes with prediction intervals and a plot of just observed locations and
predicted locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crwPredictPlot(object, plotType = "ll", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crwPredictPlot_+3A_object">object</code></td>
<td>
<p><code>crwPredict</code> object.</p>
</td></tr>
<tr><td><code id="crwPredictPlot_+3A_plottype">plotType</code></td>
<td>
<p>type of plot has to be one of the following: &ldquo;map&rdquo; or
&ldquo;ll&rdquo; (default).</p>
</td></tr>
<tr><td><code id="crwPredictPlot_+3A_...">...</code></td>
<td>
<p>Further arguments passed to plotting commands.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot.
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson and Sebastian Luque
</p>


<h3>See Also</h3>

<p>See <code>demo(northernFurSealDemo)</code> for additional examples.
</p>

<hr>
<h2 id='crwSamplePar'>Create a weighted importance sample for posterior predictive track
simulation.</h2><span id='topic+crwSamplePar'></span>

<h3>Description</h3>

<p>The <code>crwSamplePar</code> function uses a fitted model object from
<code>crwMLE</code> and a set of prediction times to construct a list from which
<code><a href="#topic+crwPostIS">crwPostIS</a></code> will draw a sample from either the posterior
distribution of the state vectors conditional on fitted parameters or a full
posterior draw from an importance sample of the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crwSamplePar(
  object.sim,
  method = "IS",
  size = 1000,
  df = Inf,
  grid.eps = 1,
  crit = 2.5,
  scale = 1,
  quad.ask = T,
  force.quad
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crwSamplePar_+3A_object.sim">object.sim</code></td>
<td>
<p>A simulation object from <code><a href="#topic+crwSimulator">crwSimulator</a></code>.</p>
</td></tr>
<tr><td><code id="crwSamplePar_+3A_method">method</code></td>
<td>
<p>Method for obtaining weights for movement parameter samples</p>
</td></tr>
<tr><td><code id="crwSamplePar_+3A_size">size</code></td>
<td>
<p>Size of the parameter importance sample</p>
</td></tr>
<tr><td><code id="crwSamplePar_+3A_df">df</code></td>
<td>
<p>Degrees of freedom for the t approximation to the parameter
posterior</p>
</td></tr>
<tr><td><code id="crwSamplePar_+3A_grid.eps">grid.eps</code></td>
<td>
<p>Grid size for <code>method="quadrature"</code></p>
</td></tr>
<tr><td><code id="crwSamplePar_+3A_crit">crit</code></td>
<td>
<p>Criterion for deciding &quot;significance&quot; of quadrature points
(difference in log-likelihood)</p>
</td></tr>
<tr><td><code id="crwSamplePar_+3A_scale">scale</code></td>
<td>
<p>Scale multiplier for the covariance matrix of the t
approximation</p>
</td></tr>
<tr><td><code id="crwSamplePar_+3A_quad.ask">quad.ask</code></td>
<td>
<p>Logical, for method='quadrature'. Whether or not the sampler 
should ask if quadrature sampling should take place. It is used to stop the 
sampling if the number of likelihood evaluations would be extreme.</p>
</td></tr>
<tr><td><code id="crwSamplePar_+3A_force.quad">force.quad</code></td>
<td>
<p>A logical indicating whether or not to force the execution 
of the quadrature method for large parameter vectors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The crwSamplePar function uses the information in a
<code><a href="#topic+crwSimulator">crwSimulator</a></code> object to create a set of weights for importance
sample-resampling of parameters in a full posterior sample of parameters and
locations using <code><a href="#topic+crwPostIS">crwPostIS</a></code>. This function is usually called
from <code><a href="#topic+crwPostIS">crwPostIS</a></code>. The average user should have no need to call
this function directly.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Longitude coordinate with NA at prediction times</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Similar to above for latitude</p>
</td></tr>
<tr><td><code>locType</code></td>
<td>
<p>Indicates prediction types with a &quot;p&quot; or observation times
with an &quot;o&quot;</p>
</td></tr> <tr><td><code>P1.y</code></td>
<td>
<p>Initial state covariance for latitude</p>
</td></tr>
<tr><td><code>P1.x</code></td>
<td>
<p>Initial state covariance for longitude</p>
</td></tr>
<tr><td><code>a1.y</code></td>
<td>
<p>Initial latitude state</p>
</td></tr>
<tr><td><code>a1.x</code></td>
<td>
<p>Initial longitude state</p>
</td></tr>
<tr><td><code>n.errX</code></td>
<td>
<p>number of longitude error model parameters</p>
</td></tr>
<tr><td><code>n.errY</code></td>
<td>
<p>number of latitude error model parameters</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>vector of time differences</p>
</td></tr>
<tr><td><code>driftMod</code></td>
<td>
<p>Logical. indicates random drift model</p>
</td></tr>
<tr><td><code>stopMod</code></td>
<td>
<p>Logical. Indicated stop model fitted</p>
</td></tr>
<tr><td><code>stop.mf</code></td>
<td>
<p>stop model design matrix</p>
</td></tr>
<tr><td><code>err.mfX</code></td>
<td>
<p>Longitude error model design matrix</p>
</td></tr>
<tr><td><code>err.mfY</code></td>
<td>
<p>Latitude error model design matrix</p>
</td></tr>
<tr><td><code>mov.mf</code></td>
<td>
<p>Movement model design matrix</p>
</td></tr>
<tr><td><code>fixPar</code></td>
<td>
<p>Fixed values for parameters in model fitting</p>
</td></tr>
<tr><td><code>Cmat</code></td>
<td>
<p>Covariance matrix for parameter sampling distribution</p>
</td></tr>
<tr><td><code>Lmat</code></td>
<td>
<p>Cholesky decomposition of Cmat</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>fitted parameter values</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Total number of locations</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log likelihood of the fitted model</p>
</td></tr>
<tr><td><code>Time</code></td>
<td>
<p>vector of observation times</p>
</td></tr>
<tr><td><code>coord</code></td>
<td>
<p>names of coordinate vectors in original data</p>
</td></tr>
<tr><td><code>Time.name</code></td>
<td>
<p>Name of the observation times vector in the original data</p>
</td></tr>
<tr><td><code>thetaSampList</code></td>
<td>
<p>A list containing a data frame of parameter vectors and
their associated probabilities for a resample</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>See Also</h3>

<p>See <code>demo(northernFurSealDemo)</code> for example.
</p>

<hr>
<h2 id='crwSimulator'>Construct a posterior simulation object for the CTCRW state vectors</h2><span id='topic+crwSimulator'></span>

<h3>Description</h3>

<p>The <code>crwSimulator</code> function uses a fitted model object from
<code>crwMLE</code> and a set of prediction times to construct a list from which
<code><a href="#topic+crwPostIS">crwPostIS</a></code> will draw a sample from either the posterior
distribution of the state vectors conditional on fitted parameters or a full
posterior draw from an importance sample of the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crwSimulator(
  object.crwFit,
  predTime = NULL,
  method = "IS",
  parIS = 1000,
  df = Inf,
  grid.eps = 1,
  crit = 2.5,
  scale = 1,
  quad.ask = TRUE,
  force.quad
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crwSimulator_+3A_object.crwfit">object.crwFit</code></td>
<td>
<p>A model object from <code><a href="#topic+crwMLE">crwMLE</a></code>.</p>
</td></tr>
<tr><td><code id="crwSimulator_+3A_predtime">predTime</code></td>
<td>
<p>vector of additional prediction times.</p>
</td></tr>
<tr><td><code id="crwSimulator_+3A_method">method</code></td>
<td>
<p>Method for obtaining weights for movement parameter samples</p>
</td></tr>
<tr><td><code id="crwSimulator_+3A_paris">parIS</code></td>
<td>
<p>Size of the parameter importance sample</p>
</td></tr>
<tr><td><code id="crwSimulator_+3A_df">df</code></td>
<td>
<p>Degrees of freedom for the t approximation to the parameter
posterior</p>
</td></tr>
<tr><td><code id="crwSimulator_+3A_grid.eps">grid.eps</code></td>
<td>
<p>Grid size for <code>method="quadrature"</code></p>
</td></tr>
<tr><td><code id="crwSimulator_+3A_crit">crit</code></td>
<td>
<p>Criterion for deciding &quot;significance&quot; of quadrature points
(difference in log-likelihood)</p>
</td></tr>
<tr><td><code id="crwSimulator_+3A_scale">scale</code></td>
<td>
<p>Scale multiplier for the covariance matrix of the t
approximation</p>
</td></tr>
<tr><td><code id="crwSimulator_+3A_quad.ask">quad.ask</code></td>
<td>
<p>Logical, for method='quadrature'. Whether or not the sampler 
should ask if quadrature sampling should take place. It is used to stop the 
sampling if the number of likelihood evaluations would be extreme.</p>
</td></tr>
<tr><td><code id="crwSimulator_+3A_force.quad">force.quad</code></td>
<td>
<p>A logical indicating whether or not to force the execution 
of the quadrature method for large parameter vectors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The crwSimulator function produces a list and preprocesses the necessary
components for repeated track simulation from a fitted CTCRW model from
<code><a href="#topic+crwMLE">crwMLE</a></code>. The <code>method</code> argument can be one of <code>"IS"</code>
or <code>"quadrature"</code>. If method=&quot;IS&quot; is chosen standard importance
sampling will be used to calculate the appropriate weights via t proposal
with df degrees of freedom.  If df=Inf (default) then a multivariate normal
distribution is used to approximate the parameter posterior. If
<code>method="quadrature"</code>, then a regular grid over the posterior is used
to calculate the weights. The argument <code>grid.eps</code> controls the
quadrature grid. The arguments are approximately the upper and lower limit
in terms of standard deviations of the posterior.  The default is
<code>grid.eps</code>, in units of 1sd. If <code>object.crwFit</code> was fitted with
<code>crwArgoFilter</code>, then the returned list will also include <code>p.out</code>,
which is the approximate probability that the observation is an outlier.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Longitude coordinate with NA at prediction times</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Similar to above for latitude</p>
</td></tr>
<tr><td><code>locType</code></td>
<td>
<p>Indicates prediction types with a &quot;p&quot; or observation times
with an &quot;o&quot;</p>
</td></tr> <tr><td><code>P1.y</code></td>
<td>
<p>Initial state covariance for latitude</p>
</td></tr>
<tr><td><code>P1.x</code></td>
<td>
<p>Initial state covariance for longitude</p>
</td></tr>
<tr><td><code>a1.y</code></td>
<td>
<p>Initial latitude state</p>
</td></tr>
<tr><td><code>a1.x</code></td>
<td>
<p>Initial longitude state</p>
</td></tr>
<tr><td><code>n.errX</code></td>
<td>
<p>number of longitude error model parameters</p>
</td></tr>
<tr><td><code>n.errY</code></td>
<td>
<p>number of latitude error model parameters</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>vector of time differences</p>
</td></tr>
<tr><td><code>driftMod</code></td>
<td>
<p>Logical. indicates random drift model</p>
</td></tr>
<tr><td><code>stopMod</code></td>
<td>
<p>Logical. Indicated stop model fitted</p>
</td></tr>
<tr><td><code>stop.mf</code></td>
<td>
<p>stop model design matrix</p>
</td></tr>
<tr><td><code>err.mfX</code></td>
<td>
<p>Longitude error model design matrix</p>
</td></tr>
<tr><td><code>err.mfY</code></td>
<td>
<p>Latitude error model design matrix</p>
</td></tr>
<tr><td><code>mov.mf</code></td>
<td>
<p>Movement model design matrix</p>
</td></tr>
<tr><td><code>fixPar</code></td>
<td>
<p>Fixed values for parameters in model fitting</p>
</td></tr>
<tr><td><code>Cmat</code></td>
<td>
<p>Covaraince matrix for parameter sampling distribution</p>
</td></tr>
<tr><td><code>Lmat</code></td>
<td>
<p>Cholesky decomposition of Cmat</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>fitted parameter values</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Total number of locations</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log likelihood of the fitted model</p>
</td></tr>
<tr><td><code>Time</code></td>
<td>
<p>vector of observation times</p>
</td></tr>
<tr><td><code>coord</code></td>
<td>
<p>names of coordinate vectors in original data</p>
</td></tr>
<tr><td><code>Time.name</code></td>
<td>
<p>Name of the observation times vector in the original data</p>
</td></tr>
<tr><td><code>thetaSampList</code></td>
<td>
<p>A list containing a data frame of parameter vectors and
their associated probabilities for a resample</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>See Also</h3>

<p>See <code>demo(northernFurSealDemo)</code> for example.
</p>

<hr>
<h2 id='detect_timescale'>Detect appropriate time scale for movement analysis</h2><span id='topic+detect_timescale'></span>

<h3>Description</h3>

<p>This function examines the time vector and evaluates the median time
interval. With this, we determine what the best time scale for the 
movement model is likely to be.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_timescale(time_vector)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_timescale_+3A_time_vector">time_vector</code></td>
<td>
<p>a vector of class POSIXct</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character of either &quot;seconds&quot;,&quot;minutes&quot;,&quot;hours&quot;,&quot;days&quot;,&quot;weeks&quot;
</p>

<hr>
<h2 id='displayPar'>Display the order of parameters along with fixed values and starting values</h2><span id='topic+displayPar'></span>

<h3>Description</h3>

<p>This function takes the model specification arguments to the <code><a href="#topic+crwMLE">crwMLE</a></code> function and displays a table
with the parameter names in the order that <code>crwMLE</code> will use during model fitting. This is useful for specifying 
values for the <code>fixPar</code> or <code>theta</code> (starting values for free parameters) arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>displayPar(
  mov.model = ~1,
  err.model = NULL,
  activity = NULL,
  drift = FALSE,
  data,
  Time.name,
  theta,
  fixPar,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="displayPar_+3A_mov.model">mov.model</code></td>
<td>
<p>formula object specifying the time indexed covariates for
movement parameters.</p>
</td></tr>
<tr><td><code id="displayPar_+3A_err.model">err.model</code></td>
<td>
<p>A 2-element list of formula objects specifying the time
indexed covariates for location error parameters.</p>
</td></tr>
<tr><td><code id="displayPar_+3A_activity">activity</code></td>
<td>
<p>formula object giving the covariate for the stopping
portion of the model.</p>
</td></tr>
<tr><td><code id="displayPar_+3A_drift">drift</code></td>
<td>
<p>logical indicating whether or not to include a random
drift component.</p>
</td></tr>
<tr><td><code id="displayPar_+3A_data">data</code></td>
<td>
<p>data.frame object containing telemetry and covariate data. A
<code>SpatialPointsDataFrame</code> object from the package 'sp' will also be accepted.</p>
</td></tr>
<tr><td><code id="displayPar_+3A_time.name">Time.name</code></td>
<td>
<p>character indicating name of the location time column</p>
</td></tr>
<tr><td><code id="displayPar_+3A_theta">theta</code></td>
<td>
<p>starting values for parameter optimization.</p>
</td></tr>
<tr><td><code id="displayPar_+3A_fixpar">fixPar</code></td>
<td>
<p>Values of parameters which are held fixed to the given value.</p>
</td></tr>
<tr><td><code id="displayPar_+3A_...">...</code></td>
<td>
<p>Additional arguments (probably for testing new features.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following columns
</p>
<table>
<tr><td><code>ParNames</code></td>
<td>
<p>The names of the parameters specified by the arguments.</p>
</td></tr>
<tr><td><code>fixPar</code></td>
<td>
<p>The values specified by the <code>fixPar</code> argument for fixed values of the parameters. In model fitting, 
these values will remain fixed and will not be estimated.</p>
</td></tr>
<tr><td><code>thetaIndex</code></td>
<td>
<p>This column provides the index of each element of the theta argument and to which parameter it corresponds.</p>
</td></tr>
<tr><td><code>thetaStart</code></td>
<td>
<p>If a value is given for the <code>theta</code> argument it will be placed in this column and its elements will 
correspond to the <code>thetaIdx</code> column.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>See Also</h3>

<p><code>demo(northernFurSealDemo)</code> for example.
</p>

<hr>
<h2 id='expandPred'>Expand a time indexed data set with additional prediction times</h2><span id='topic+expandPred'></span>

<h3>Description</h3>

<p>Expands a covariate data frame (or vector) that has a separate time index by
inserting prediction times and duplicating the covariate values for all
prediction time between subsequent data times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expandPred(x, Time = "Time", predTime, time.col = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expandPred_+3A_x">x</code></td>
<td>
<p>Data to be expanded.</p>
</td></tr>
<tr><td><code id="expandPred_+3A_time">Time</code></td>
<td>
<p>Either a character naming the column which contains original
time values, or a numeric vector of original times</p>
</td></tr>
<tr><td><code id="expandPred_+3A_predtime">predTime</code></td>
<td>
<p>prediction times to expand data</p>
</td></tr>
<tr><td><code id="expandPred_+3A_time.col">time.col</code></td>
<td>
<p>Logical value indicating whether to attach the new times to
the expanded data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame expanded by <code>predTime</code>
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#library(crawl)
origTime &lt;- c(1:10)
x &lt;- cbind(rnorm(10), c(21:30))
predTime &lt;- seq(1,10, by=0.25)
expandPred(x, Time=origTime, predTime, time.col=TRUE)

</code></pre>

<hr>
<h2 id='fillCols'>Fill missing values in data set (or matrix) columns for which there is a
single unique value</h2><span id='topic+fillCols'></span>

<h3>Description</h3>

<p>Looks for columns in a data set that have a single unique non-missing value
and fills in all <code>NA</code> with that value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fillCols(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fillCols_+3A_data">data</code></td>
<td>
<p>data.frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#library(crawl)
data1 &lt;- data.frame(constVals=rep(c(1,NA),5), vals=1:10)
data1[5,2] &lt;- NA
data1
data2 &lt;- fillCols(data1)
data2

mat1 &lt;- matrix(c(rep(c(1,NA),5), 1:10), ncol=2)
mat1[5,2] &lt;- NA
mat1
mat2 &lt;- fillCols(mat1)
mat2
</code></pre>

<hr>
<h2 id='fix_path'>fix_path function id depreciated.</h2><span id='topic+fix_path'></span>

<h3>Description</h3>

<p>fix_path function id depreciated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fix_path(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fix_path_+3A_...">...</code></td>
<td>
<p>Any arguments are ignored.</p>
</td></tr>
</table>

<hr>
<h2 id='flatten'>'Flattening' a list-form crwPredict object into a data.frame</h2><span id='topic+flatten'></span>

<h3>Description</h3>

<p>&ldquo;Flattens&rdquo; a list form <code><a href="#topic+crwPredict">crwPredict</a></code> object into a flat
data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flatten(predObj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flatten_+3A_predobj">predObj</code></td>
<td>
<p>A crwPredict object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> version of a crwPredict list with columns
for the state standard errors
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+northernFurSeal">northernFurSeal</a></code> for use example
</p>

<hr>
<h2 id='harborSeal'>Harbor seal location data set used in Johnson et al. (2008)</h2><span id='topic+harborSeal'></span>

<h3>Description</h3>

<p>Harbor seal location data set used in Johnson et al. (2008)
</p>


<h3>Format</h3>

<p>A data frame with 7059 observations on the following 5 variables.
</p>
 <dl>
<dt>Time</dt><dd><p>a numeric vector.</p>
</dd>
<dt>latitude</dt><dd><p>a numeric vector.</p>
</dd>
<dt>longitude</dt><dd><p>a numeric vector.</p>
</dd>
<dt>DryTime</dt><dd><p>a numeric vector.</p>
</dd>
<dt>Argos_loc_class</dt><dd><p>a factor with levels <code>0</code> <code>1</code>
<code>2</code> <code>3</code> <code>A</code> <code>B</code></p>
</dd></dl>
<p>.
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>Source</h3>

<p>Marine Mammal Laboratory, Alaska
Fisheries Science Center, National Marine Fisheries Service, NOAA 7600 Sand
Point Way NE Seattle, WA 98115
</p>


<h3>References</h3>

<p>Johnson, D., J. London, M. -A. Lea, and J. Durban (2008)
Continuous-time random walk model for animal telemetry data. Ecology
89:1208-1215.
</p>

<hr>
<h2 id='harborSeal_sf'>Harbor seal location data updated since Johnson et al. (2008)</h2><span id='topic+harborSeal_sf'></span>

<h3>Description</h3>

<p>The original location data used in Johnson et al. (2008) was geographic
(latitude/longitude) (but not explicitly documented) and provided as a 
simple data frame. This data updates the data to a Simple Feature
Collection (as part of the <a href="https://r-spatial.github.io/sf/articles/">sf</a> 
package) with the CRS explicitly set.
</p>


<h3>Format</h3>

<p>A Simple Feature Collection with 7059 features and 3 fields.
</p>
 
<dl>
<dt>Time</dt><dd><p>a numeric vector.</p>
</dd>
<dt>DryTime</dt><dd><p>a numeric vector.</p>
</dd>
<dt>Argos_loc_class</dt><dd><p>a factor with levels <code>0</code> <code>1</code>
<code>2</code> <code>3</code> <code>A</code> <code>B</code>.</p>
</dd>
<dt>geometry</dt><dd><p>a list column with geometry data; CRS = EPSG:4326</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Josh M. London
</p>


<h3>Source</h3>

<p>Marine Mammal Laboratory, Alaska
Fisheries Science Center, National Marine Fisheries Service, NOAA 7600 Sand
Point Way NE Seattle, WA 98115
</p>


<h3>References</h3>

<p>Johnson, D., J. London, M. -A. Lea, and J. Durban (2008)
Continuous-time random walk model for animal telemetry data. Ecology
89:1208-1215.
</p>

<hr>
<h2 id='intToPOSIX'>Reverse as.numeric command that is performed on a vector of type POSIXct</h2><span id='topic+intToPOSIX'></span>

<h3>Description</h3>

<p>Takes integer value produced by <code>as.numeric(x)</code>, where <code>x</code> is a
POSIXct vector and returns it to a POSIXct vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intToPOSIX(timeVector, tz = "GMT")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intToPOSIX_+3A_timevector">timeVector</code></td>
<td>
<p>A vector of integers produced by as.numeric applied to a
PSIXct vector</p>
</td></tr>
<tr><td><code id="intToPOSIX_+3A_tz">tz</code></td>
<td>
<p>Time zone of the vector (see <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>POSIXct vector
</p>


<h3>Note</h3>

<p>There is no check that as.numeric applied to a POSIX vector produced
<code>timeVector</code>.  So, caution is required in using this function. It was
included simply because I have found it useful
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#library(crawl)
timeVector &lt;- as.numeric(Sys.time())
timeVector
intToPOSIX(timeVector, tz="")
</code></pre>

<hr>
<h2 id='mergeTrackStop'>Merge a location data set with a dry time (or other stopping) covariate</h2><span id='topic+mergeTrackStop'></span>

<h3>Description</h3>

<p>The function merges a location data set with a stopping variable data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mergeTrackStop(
  data,
  stopData,
  Time.name = "Time",
  interp = c("zeros", "ma0"),
  win = 2,
  constCol
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mergeTrackStop_+3A_data">data</code></td>
<td>
<p>Location data.</p>
</td></tr>
<tr><td><code id="mergeTrackStop_+3A_stopdata">stopData</code></td>
<td>
<p>stopping variable data set.</p>
</td></tr>
<tr><td><code id="mergeTrackStop_+3A_time.name">Time.name</code></td>
<td>
<p>character naming time index variable in both data sets</p>
</td></tr>
<tr><td><code id="mergeTrackStop_+3A_interp">interp</code></td>
<td>
<p>method of interpolation.</p>
</td></tr>
<tr><td><code id="mergeTrackStop_+3A_win">win</code></td>
<td>
<p>window for &quot;ma0&quot; interpolation method.</p>
</td></tr>
<tr><td><code id="mergeTrackStop_+3A_constcol">constCol</code></td>
<td>
<p>columns in <code>data</code> for which the user would like to be
constant, such as id or sex.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simply merges the data frames and interpolates based on the chosen method.
Both data frames have to use the same name for the time variable. Also
contains <code>stopType</code> which = &quot;o&quot; if observed or &quot;p&quot; for interpolated.
</p>
<p>The merged data is truncated to the first and last time in the location data
set. Missing values in the stopping variable data set can be interpolated by
replacing them with zeros (full movement) or first replacing with zeros then
using a moving average to smooth the data. Only the missing values are then
replace with this smoothed data. This allows a smooth transition to full
movement.
</p>


<h3>Value</h3>

<p>Merged data.frame with new column from <code>stopData</code>. Missing values in
the stopping variable will be interpolated
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

track &lt;- data.frame(TimeVar=sort(runif(20,0,20)), x=1:20, y=20:1)
track
stopData &lt;- data.frame(TimeVar=0:29, stopVar=round(runif(30)))
stopData
mergeTrackStop(track, stopData, Time.name="TimeVar")

</code></pre>

<hr>
<h2 id='northernFurSeal'>Northern fur seal pup relocation data set used in Johnson et al. (2008)</h2><span id='topic+northernFurSeal'></span>

<h3>Description</h3>

<p>Northern fur seal pup relocation data set used in Johnson et al. (2008)
</p>


<h3>Format</h3>

<p>A data frame with 795 observations on the following 4 variables:
</p>
 <dl>
<dt>GMT</dt><dd><p>A POSIX time vector</p>
</dd>
<dt>loc_class</dt><dd><p>a factor with levels <code>3</code> <code>2</code>
<code>1</code> <code>0</code> <code>A</code>.</p>
</dd>
<dt>lat</dt><dd><p>a numeric vector. Latitude for the locations</p>
</dd>
<dt>long</dt><dd><p>a numeric vector. Longitude for the locations</p>
</dd>
</dl>



<h3>Source</h3>

<p>Marine Mammal Laboratory, Alaska
Fisheries Science Center, National Marine Fisheries Service, NOAA 7600 Sand
Point Way NE Seattle, WA 98115
</p>


<h3>References</h3>

<p>Johnson, D., J. London, M. -A. Lea, and J. Durban (2008) Continuous-time
random walk model for animal telemetry data. Ecology 89:1208-1215.
</p>

<hr>
<h2 id='tidy_crwFit'>tidy-like method for crwFit object</h2><span id='topic+tidy_crwFit'></span>

<h3>Description</h3>

<p>this function mimics the approach taken by <code>broom::tidy</code>
to present model output parameters in a tidy, data frame structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidy_crwFit(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tidy_crwFit_+3A_fit">fit</code></td>
<td>
<p><code>crwFit</code> object from <code>crawl::crwMLE</code></p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
