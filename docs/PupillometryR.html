<!DOCTYPE html><html lang="en"><head><title>Help for package PupillometryR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PupillometryR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#baseline_data'><p>Baseline pupil data to the average pupil size within a window</p></a></li>
<li><a href='#calculate_mean_pupil_size'><p>Calculate a mean size across two pupils over time</p></a></li>
<li><a href='#calculate_missing_data'><p>Calculate the missing data amount</p></a></li>
<li><a href='#clean_missing_data'><p>Clean missing data above an acceptable threshold</p></a></li>
<li><a href='#create_difference_data'><p>Create a difference data frame when dealing with a condition column with 2 levels</p></a></li>
<li><a href='#create_functional_data'><p>Makes a functional data with splines from a Pupil_difference_data dataframe.</p></a></li>
<li><a href='#create_time_windows'><p>Make PupillometryR dataframe into multiple time windows for easy analysis</p></a></li>
<li><a href='#create_window_data'><p>Make PupillometryR dataframe into a single collapsed window for easy analysis</p></a></li>
<li><a href='#detect_blinks_by_column'><p>detect blinks by a pre-existing labelled blink column that comes from the eyetracker</p></a></li>
<li><a href='#detect_blinks_by_size'><p>detect blinks by a change in pupil size</p></a></li>
<li><a href='#detect_blinks_by_velocity'><p>detect blinks by a change in velocity</p></a></li>
<li><a href='#downsample_time_data'><p>Downsample frequency to reduce number of samples and data size</p></a></li>
<li><a href='#filter_data'><p>Run a filter on the data to smooth it out.</p></a></li>
<li><a href='#geom_flat_violin'><p>ggplot Flat Violin</p></a></li>
<li><a href='#GeomFlatViolin'><p>geom_flat_violin_HELPER2</p></a></li>
<li><a href='#gfv_helper1'><p>geom_flat_violin_HELPER1</p></a></li>
<li><a href='#interpolate_data'><p>Interpolate across the gaps in data</p></a></li>
<li><a href='#make_pupillometryr_data'><p>Prepare data for pre-processing in PupillometryR</p></a></li>
<li><a href='#mean2'><p>Helper function mean2</p></a></li>
<li><a href='#plot.Pupil_difference_data'><p>Pre-prepared plots of PupillometryR data</p></a></li>
<li><a href='#plot.Pupil_test_data'><p>Pre-prepared plots of PupillometryR data</p></a></li>
<li><a href='#plot.Pupil_window_data'><p>Pre-prepared plots of PupillometryR data</p></a></li>
<li><a href='#plot.PupillometryR'><p>Pre-prepared plots of PupillometryR data</p></a></li>
<li><a href='#pupil_data'><p>Data collected in a pupillometry study by Sylvain Sirois</p></a></li>
<li><a href='#regress_data'><p>Regress one pupil against another for extra smoothing</p></a></li>
<li><a href='#replace_missing_data'><p>replaces missing observations if you have some degree of incomplete observations</p></a></li>
<li><a href='#run_functional_t_test'><p>Run a functional t-test on a dataframe previously fitted with b-splines.</p></a></li>
<li><a href='#subset_data'><p>Subset data to provide start and finish time windows</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Unified Pipeline for Pupillometry Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a unified pipeline to clean, prepare, plot,
    and run basic analyses on pupillometry experiments.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/samhforbes/PupillometryR/issues">https://github.com/samhforbes/PupillometryR/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), dplyr, ggplot2, rlang</td>
</tr>
<tr>
<td>Imports:</td>
<td>fda, itsadug, mgcv, signal, stats, stringr, tidyr, utils, zoo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-15 11:56:59 UTC; xbxr94</td>
</tr>
<tr>
<td>Author:</td>
<td>Samuel Forbes [aut, cre],
  David Robinson [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Samuel Forbes &lt;samuel.h.forbes@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-15 12:22:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='baseline_data'>Baseline pupil data to the average pupil size within a window</h2><span id='topic+baseline_data'></span>

<h3>Description</h3>

<p>This function is for use with the PupillometryR package to baseline each participant's pupil size to the
mean pupil size within a window.
This may not be necessary if you are doing purely within-subject analyses, but it is convenient for
comparison across subjects, and makes results more uniform.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>baseline_data(data, pupil, start, stop)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="baseline_data_+3A_data">data</code></td>
<td>
<p>a PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="baseline_data_+3A_pupil">pupil</code></td>
<td>
<p>a column name denoting pupil data</p>
</td></tr>
<tr><td><code id="baseline_data_+3A_start">start</code></td>
<td>
<p>start time of baseline window</p>
</td></tr>
<tr><td><code id="baseline_data_+3A_stop">stop</code></td>
<td>
<p>stop time of baseline window</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PupillometryR dataframe, with baselined pupil
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
regressed_data &lt;- regress_data(data = Sdata, pupil1 = RPupil, pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data,
pupil1 = RPupil, pupil2 = LPupil)
base_data &lt;- baseline_data(data = mean_data, pupil = mean_pupil, start = 0, stop = 100)
</code></pre>

<hr>
<h2 id='calculate_mean_pupil_size'>Calculate a mean size across two pupils over time</h2><span id='topic+calculate_mean_pupil_size'></span>

<h3>Description</h3>

<p>This function is useful when you have left and right eye eyetracking data, and a mean of the two would be useful.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_mean_pupil_size(data, pupil1, pupil2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_mean_pupil_size_+3A_data">data</code></td>
<td>
<p>a PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="calculate_mean_pupil_size_+3A_pupil1">pupil1</code></td>
<td>
<p>column name indicating pupil size</p>
</td></tr>
<tr><td><code id="calculate_mean_pupil_size_+3A_pupil2">pupil2</code></td>
<td>
<p>column name indicating pupil size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PupillometryR dataframe with a mean pupil column
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
regressed_data &lt;- regress_data(data = Sdata, pupil1 = RPupil, pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data, pupil1 = RPupil, pupil2 = LPupil)
</code></pre>

<hr>
<h2 id='calculate_missing_data'>Calculate the missing data amount</h2><span id='topic+calculate_missing_data'></span>

<h3>Description</h3>

<p>This function can be used to assess the amount of samples that have problematic
data from each trial, which helps assess cleaning parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_missing_data(data, pupil)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_missing_data_+3A_data">data</code></td>
<td>
<p>your data of class PupillometryR</p>
</td></tr>
<tr><td><code id="calculate_missing_data_+3A_pupil">pupil</code></td>
<td>
<p>a column name denoting pupil size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary table with number of missing samples in each trial
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pupil_data)
Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)
new_data &lt;- downsample_time_data(data = Sdata,
pupil = LPupil,
timebin_size = 50,
option = 'mean')
calculate_missing_data(data = new_data, pupil = LPupil)
</code></pre>

<hr>
<h2 id='clean_missing_data'>Clean missing data above an acceptable threshold</h2><span id='topic+clean_missing_data'></span>

<h3>Description</h3>

<p>This function can be used to remove trials and participants
who do not meet the threshold for a study. Note that there are two parameters for
cleaning, one to remove trials above a threshold,
the second to remove participants who drop more than a certain amount of trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_missing_data(
  data,
  pupil,
  trial_threshold = 1,
  subject_trial_threshold = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clean_missing_data_+3A_data">data</code></td>
<td>
<p>your data of class PupillometryR</p>
</td></tr>
<tr><td><code id="clean_missing_data_+3A_pupil">pupil</code></td>
<td>
<p>a column name denoting pupil size</p>
</td></tr>
<tr><td><code id="clean_missing_data_+3A_trial_threshold">trial_threshold</code></td>
<td>
<p>a proportion of missing data over which a trial can be considered lost</p>
</td></tr>
<tr><td><code id="clean_missing_data_+3A_subject_trial_threshold">subject_trial_threshold</code></td>
<td>
<p>a proportion of missing trials over which a participant can be considered lost.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A cleaned PupillometryR dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pupil_data)
Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)
new_data &lt;- downsample_time_data(data = Sdata,
pupil = LPupil,
timebin_size = 50,
option = 'mean')
calculate_missing_data(data = new_data, pupil = LPupil)
</code></pre>

<hr>
<h2 id='create_difference_data'>Create a difference data frame when dealing with a condition column with 2 levels</h2><span id='topic+create_difference_data'></span>

<h3>Description</h3>

<p>The difference data frame is used when creating a dataframe to do the functional t-test analysis.
This function would be the first step in that analysis, after doing the pre-processing.
It creates a frame where it treats the condition data as level2 - level1.
It will throw an error if there are more than two conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_difference_data(data, pupil)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_difference_data_+3A_data">data</code></td>
<td>
<p>a PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="create_difference_data_+3A_pupil">pupil</code></td>
<td>
<p>column name for pupil data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Pupil_difference_data data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
mean_data &lt;- calculate_mean_pupil_size(data = Sdata,
pupil1 = RPupil, pupil2 = LPupil)
base_data &lt;- baseline_data(data = mean_data, pupil = mean_pupil, start = 0, stop = 100)
differences &lt;- create_difference_data(data = base_data, pupil = mean_pupil)
plot(differences, pupil = mean_pupil, geom = 'line')
</code></pre>

<hr>
<h2 id='create_functional_data'>Makes a functional data with splines from a Pupil_difference_data dataframe.</h2><span id='topic+create_functional_data'></span>

<h3>Description</h3>

<p>This function turns difference data into fitted splines in order to carry out functional data analysis.
Under the hood this passes basis and order to fda::Data2fd, and fda::create.bspline.basis, and is
mandatory before running run_functional_t_test. It is recommended to read the documentation for
package fda for further information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_functional_data(data, pupil, basis, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_functional_data_+3A_data">data</code></td>
<td>
<p>a Pupil_difference_data dataframe</p>
</td></tr>
<tr><td><code id="create_functional_data_+3A_pupil">pupil</code></td>
<td>
<p>Column name indicating pupil data to fit</p>
</td></tr>
<tr><td><code id="create_functional_data_+3A_basis">basis</code></td>
<td>
<p>Integer specifying number of basis functions to create a b-spline basis</p>
</td></tr>
<tr><td><code id="create_functional_data_+3A_order">order</code></td>
<td>
<p>Integer specifying order of b-splines (one higher than the degree)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Pupil_difference_data dataframe fitted with b-splines.
</p>


<h3>See Also</h3>

<p>fda package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
regressed_data &lt;- regress_data(data = Sdata, pupil1 = RPupil, pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data, pupil1 = RPupil, pupil2 = LPupil)
base_data &lt;- baseline_data(data = mean_data, pupil = mean_pupil, start = 0, stop = 100)
differences &lt;- create_difference_data(data = base_data, pupil = mean_pupil)
spline_data &lt;- create_functional_data(data = differences, pupil = mean_pupil, basis = 10, order = 4)

</code></pre>

<hr>
<h2 id='create_time_windows'>Make PupillometryR dataframe into multiple time windows for easy analysis</h2><span id='topic+create_time_windows'></span>

<h3>Description</h3>

<p>This function creates a single collapsed data frame for easy analysis with an anova or model,
per condition.
By comparison create_window_data allows collapsing all into a single time window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_time_windows(data, pupil, breaks)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_time_windows_+3A_data">data</code></td>
<td>
<p>a PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="create_time_windows_+3A_pupil">pupil</code></td>
<td>
<p>column name denoting pupil data to be used</p>
</td></tr>
<tr><td><code id="create_time_windows_+3A_breaks">breaks</code></td>
<td>
<p>a vector or numbers indicating start times for each window</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a Pupil_window_data dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
regressed_data &lt;- regress_data(data = Sdata, pupil1 = RPupil, pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data,
pupil1 = RPupil, pupil2 = LPupil)
base_data &lt;- baseline_data(data = mean_data, pupil = mean_pupil, start = 0, stop = 100)
time_window &lt;- create_time_windows(data = base_data, pupil = mean_pupil,
breaks = c(1000, 2000))
</code></pre>

<hr>
<h2 id='create_window_data'>Make PupillometryR dataframe into a single collapsed window for easy analysis</h2><span id='topic+create_window_data'></span>

<h3>Description</h3>

<p>This function creates a single collapsed data frame for easy analysis with a t-test or anova,
per condition.
By comparison create_time_windows allows dividing it into multiple windows per time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_window_data(data, pupil)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_window_data_+3A_data">data</code></td>
<td>
<p>a PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="create_window_data_+3A_pupil">pupil</code></td>
<td>
<p>column name denoting pupil data to be used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a Pupil_window_data dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
regressed_data &lt;- regress_data(data = Sdata, pupil1 = RPupil, pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data,
pupil1 = RPupil, pupil2 = LPupil)
base_data &lt;- baseline_data(data = mean_data, pupil = mean_pupil, start = 0, stop = 100)
window &lt;- create_window_data(data = base_data, pupil = mean_pupil)
p &lt;- plot(window, pupil = mean_pupil, windows = FALSE, geom = 'boxplot')
p
</code></pre>

<hr>
<h2 id='detect_blinks_by_column'>detect blinks by a pre-existing labelled blink column that comes from the eyetracker</h2><span id='topic+detect_blinks_by_column'></span>

<h3>Description</h3>

<p>This allows the user to remove anything classed as a blink as a result of eyetracker output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_blinks_by_column(
  data,
  pupil,
  column,
  extend_forward = 0,
  extend_back = 0,
  .tag = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detect_blinks_by_column_+3A_data">data</code></td>
<td>
<p>dataset of class PupillometryR</p>
</td></tr>
<tr><td><code id="detect_blinks_by_column_+3A_pupil">pupil</code></td>
<td>
<p>column name for pupil data</p>
</td></tr>
<tr><td><code id="detect_blinks_by_column_+3A_column">column</code></td>
<td>
<p>column that refers to blinks</p>
</td></tr>
<tr><td><code id="detect_blinks_by_column_+3A_extend_forward">extend_forward</code></td>
<td>
<p>number of observations to remove forward of blink</p>
</td></tr>
<tr><td><code id="detect_blinks_by_column_+3A_extend_back">extend_back</code></td>
<td>
<p>number of obervations to remove behind blink</p>
</td></tr>
<tr><td><code id="detect_blinks_by_column_+3A_.tag">.tag</code></td>
<td>
<p>the variable in the blink column that represents a blink</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns dataframe with blinks removed including forward and back, and data in blink column.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)

Sdata2 &lt;- detect_blinks_by_column(data = Sdata,
pupil = LPupil,
column = data_in_blink,
extend_forward = 0,
extend_back = 0)

## End(Not run)

</code></pre>

<hr>
<h2 id='detect_blinks_by_size'>detect blinks by a change in pupil size</h2><span id='topic+detect_blinks_by_size'></span>

<h3>Description</h3>

<p>This allows the user to set a threshold for pupil size and remove anything classed as a blink as a result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_blinks_by_size(
  data,
  pupil,
  threshold = 2.5,
  extend_forward = 0,
  extend_back = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detect_blinks_by_size_+3A_data">data</code></td>
<td>
<p>dataset of class PupillometryR</p>
</td></tr>
<tr><td><code id="detect_blinks_by_size_+3A_pupil">pupil</code></td>
<td>
<p>column name for pupil data</p>
</td></tr>
<tr><td><code id="detect_blinks_by_size_+3A_threshold">threshold</code></td>
<td>
<p>velocity threshold for blink detection</p>
</td></tr>
<tr><td><code id="detect_blinks_by_size_+3A_extend_forward">extend_forward</code></td>
<td>
<p>number of observations to remove forward of blink</p>
</td></tr>
<tr><td><code id="detect_blinks_by_size_+3A_extend_back">extend_back</code></td>
<td>
<p>number of obervations to remove behind blink</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns dataframe with blinks removed including forward and back, and data in blink column.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)

Sdata2 &lt;- detect_blinks_by_size(data = Sdata,
pupil = LPupil,
threshold = 2.5,
extend_forward = 0,
extend_back = 0)

</code></pre>

<hr>
<h2 id='detect_blinks_by_velocity'>detect blinks by a change in velocity</h2><span id='topic+detect_blinks_by_velocity'></span>

<h3>Description</h3>

<p>This allows the user to set a threshold for velocity and remove anything classed as a blink as a result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_blinks_by_velocity(
  data,
  pupil,
  threshold = 0.1,
  extend_forward = 0,
  extend_back = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detect_blinks_by_velocity_+3A_data">data</code></td>
<td>
<p>dataset of class PupillometryR</p>
</td></tr>
<tr><td><code id="detect_blinks_by_velocity_+3A_pupil">pupil</code></td>
<td>
<p>column name for pupil data</p>
</td></tr>
<tr><td><code id="detect_blinks_by_velocity_+3A_threshold">threshold</code></td>
<td>
<p>velocity threshold for blink detection</p>
</td></tr>
<tr><td><code id="detect_blinks_by_velocity_+3A_extend_forward">extend_forward</code></td>
<td>
<p>number of observations to remove forward of blink</p>
</td></tr>
<tr><td><code id="detect_blinks_by_velocity_+3A_extend_back">extend_back</code></td>
<td>
<p>number of obervations to remove behind blink</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns dataframe with blinks removed including forward and back, and data in blink column.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)

Sdata2 &lt;- detect_blinks_by_velocity(data = Sdata,
pupil = LPupil,
threshold = 0.1,
extend_forward = 0,
extend_back = 0)

</code></pre>

<hr>
<h2 id='downsample_time_data'>Downsample frequency to reduce number of samples and data size</h2><span id='topic+downsample_time_data'></span>

<h3>Description</h3>

<p>This function is useful if you were sampling at a very high frequency (eg 500Hz)
causing the data size to be hard to manage, and high autocorrelation.
Careful decisions should be made about the time bin size and appropriateness
of this function, with respect to the data type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>downsample_time_data(data, pupil, timebin_size, option = c("mean", "median"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="downsample_time_data_+3A_data">data</code></td>
<td>
<p>your data of class PupillometryR</p>
</td></tr>
<tr><td><code id="downsample_time_data_+3A_pupil">pupil</code></td>
<td>
<p>a column name denoting pupil size</p>
</td></tr>
<tr><td><code id="downsample_time_data_+3A_timebin_size">timebin_size</code></td>
<td>
<p>the size of the new timebin you wish to use</p>
</td></tr>
<tr><td><code id="downsample_time_data_+3A_option">option</code></td>
<td>
<p>what should be calculated in each timebin - mean or median. Defaults to mean.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A downsampled dataframe of class PupillometryR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pupil_data)
Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)
new_data &lt;- downsample_time_data(data = Sdata,
pupil = LPupil,
timebin_size = 50,
option = 'mean')
</code></pre>

<hr>
<h2 id='filter_data'>Run a filter on the data to smooth it out.</h2><span id='topic+filter_data'></span>

<h3>Description</h3>

<p>filter_data allows three different options for filtering, a butterworth lowpass filter, a hanning filter, or
a median filter. You can also set the degree of this filter; we recommend a default of 11.
This filters on one pupil, it can be re-run on a second pupil if needed. Lowpass makes use of the
butterworth filter and filtfilt from package signal, median makes use of runmed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_data(
  data,
  pupil,
  filter = c("median", "hanning", "lowpass"),
  degree = 11
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_data_+3A_data">data</code></td>
<td>
<p>a PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="filter_data_+3A_pupil">pupil</code></td>
<td>
<p>column name for pupil data</p>
</td></tr>
<tr><td><code id="filter_data_+3A_filter">filter</code></td>
<td>
<p>option for filtering the data</p>
</td></tr>
<tr><td><code id="filter_data_+3A_degree">degree</code></td>
<td>
<p>filter degree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>filtered pupil data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)
mean_data &lt;- calculate_mean_pupil_size(data = Sdata,
pupil1 = RPupil, pupil2 = LPupil)
filtered_data &lt;- filter_data(data = mean_data,
pupil = mean_pupil,
filter = 'hanning',
degree = 11)
</code></pre>

<hr>
<h2 id='geom_flat_violin'>ggplot Flat Violin</h2><span id='topic+geom_flat_violin'></span>

<h3>Description</h3>

<p>ggplot Flat Violin
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_flat_violin(
  mapping = NULL,
  data = NULL,
  stat = "ydensity",
  position = "dodge",
  trim = TRUE,
  scale = "area",
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geom_flat_violin_+3A_mapping">mapping</code></td>
<td>
<p>A value</p>
</td></tr>
<tr><td><code id="geom_flat_violin_+3A_data">data</code></td>
<td>
<p>A value</p>
</td></tr>
<tr><td><code id="geom_flat_violin_+3A_stat">stat</code></td>
<td>
<p>A value</p>
</td></tr>
<tr><td><code id="geom_flat_violin_+3A_position">position</code></td>
<td>
<p>A value</p>
</td></tr>
<tr><td><code id="geom_flat_violin_+3A_trim">trim</code></td>
<td>
<p>A value</p>
</td></tr>
<tr><td><code id="geom_flat_violin_+3A_scale">scale</code></td>
<td>
<p>A value</p>
</td></tr>
<tr><td><code id="geom_flat_violin_+3A_show.legend">show.legend</code></td>
<td>
<p>A value</p>
</td></tr>
<tr><td><code id="geom_flat_violin_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>A value</p>
</td></tr>
<tr><td><code id="geom_flat_violin_+3A_...">...</code></td>
<td>
<p>A value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Copy-pasted from https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R
somewhat hackish solution to:
https://twitter.com/EamonCaddigan/status/646759751242620928
based mostly on copy/pasting from ggplot2 geom_violin source:
https://github.com/hadley/ggplot2/blob/master/R/geom-violin.r
The original seems to be: sourced from: https://gist.github.com/dgrtwo/eb7750e74997891d7c20,
Author is David Robinson.
A key internal function for the raincloud plots used as a plotting option in this package.
For information on raincloud plots see: Allen, M., Poggiali, D., Whitaker, K.,
Marshall, T. R., &amp; Kievit, R. A. (2019). Raincloud plots: a multi-platform
tool for robust data visualization. Wellcome open research,
4, 63. doi:10.12688/wellcomeopenres.15191.1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ggplot(diamonds, aes(cut, carat)) +
  geom_flat_violin() +
  coord_flip()
</code></pre>

<hr>
<h2 id='GeomFlatViolin'>geom_flat_violin_HELPER2</h2><span id='topic+GeomFlatViolin'></span>

<h3>Description</h3>

<p>Borrowed from
<a href="https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R">Ben Marwick</a>.
Original author David Robinson.
</p>

<hr>
<h2 id='gfv_helper1'>geom_flat_violin_HELPER1</h2><span id='topic+gfv_helper1'></span><span id='topic++25+7C+7C+25'></span>

<h3>Description</h3>

<p>Borrowed from
https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R.
Original author David Robinson, from https://gist.github.com/dgrtwo/eb7750e74997891d7c20
</p>

<hr>
<h2 id='interpolate_data'>Interpolate across the gaps in data</h2><span id='topic+interpolate_data'></span>

<h3>Description</h3>

<p>Once data is smoothed, it is important to deal with missing observations, such as blinks.
This allows simple interpolation over missing values, either linear, or cubic.
Depending on the analysis planed, this may not be a necessary option, but it is
strongly recommended for the functional analyses planned in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolate_data(data, pupil, type = c("linear", "cubic"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interpolate_data_+3A_data">data</code></td>
<td>
<p>a PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="interpolate_data_+3A_pupil">pupil</code></td>
<td>
<p>Column name for pupil data to be interpolated</p>
</td></tr>
<tr><td><code id="interpolate_data_+3A_type">type</code></td>
<td>
<p>string indicating linear or cubic interpolation to be performed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>interpolated pupillometry data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)
mean_data &lt;- calculate_mean_pupil_size(data = Sdata,
pupil1 = RPupil, pupil2 = LPupil)
filtered_data &lt;- filter_data(data = mean_data,
pupil = mean_pupil,
filter = 'hanning',
degree = 11)
int_data &lt;- interpolate_data(data = filtered_data,
pupil = mean_pupil,
type = 'linear')
</code></pre>

<hr>
<h2 id='make_pupillometryr_data'>Prepare data for pre-processing in PupillometryR</h2><span id='topic+make_pupillometryr_data'></span>

<h3>Description</h3>

<p>This should be the first function you run as part of using PupillometryR.
This will make sure your data is in the right format for processing.
This package is designed to deal with data at it comes out of the eyetracker
in a long-form csv style format. Thus data input here would be a long
dataframe, wherein each row is a single frame collected by the eyetracker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_pupillometryr_data(data, subject, trial, time, condition, other)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_pupillometryr_data_+3A_data">data</code></td>
<td>
<p>a raw, long form dataframe organised by subject, trial, and time.
if your data is not long form, look at tidyr for examples of conversion.</p>
</td></tr>
<tr><td><code id="make_pupillometryr_data_+3A_subject">subject</code></td>
<td>
<p>column name indicating subject ID</p>
</td></tr>
<tr><td><code id="make_pupillometryr_data_+3A_trial">trial</code></td>
<td>
<p>column name indicating trial ID. This should be unique for participants</p>
</td></tr>
<tr><td><code id="make_pupillometryr_data_+3A_time">time</code></td>
<td>
<p>column name indicating time column (should be numeric)</p>
</td></tr>
<tr><td><code id="make_pupillometryr_data_+3A_condition">condition</code></td>
<td>
<p>column name indicating experimental condition</p>
</td></tr>
<tr><td><code id="make_pupillometryr_data_+3A_other">other</code></td>
<td>
<p>any other column you may wish to keep in the data frame for processing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe ready to use in PupillometryR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)
</code></pre>

<hr>
<h2 id='mean2'>Helper function mean2</h2><span id='topic+mean2'></span>

<h3>Description</h3>

<p>Somewhat useful function for ignoring NAs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean2(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mean2_+3A_x">x</code></td>
<td>
<p>the object</p>
</td></tr>
</table>

<hr>
<h2 id='plot.Pupil_difference_data'>Pre-prepared plots of PupillometryR data</h2><span id='topic+plot.Pupil_difference_data'></span>

<h3>Description</h3>

<p>The plot functions are designed to run with just data and pupil selections,
with some additional options for fun with plotting. To see these plots,
you must first use create_difference_data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Pupil_difference_data'
plot(x, pupil, geom = c("point", "line"), colour = "black", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.Pupil_difference_data_+3A_x">x</code></td>
<td>
<p>A Pupil_difference_data dataframe</p>
</td></tr>
<tr><td><code id="plot.Pupil_difference_data_+3A_pupil">pupil</code></td>
<td>
<p>Column name of pupil data to be plotted</p>
</td></tr>
<tr><td><code id="plot.Pupil_difference_data_+3A_geom">geom</code></td>
<td>
<p>string indicating whether made of connected points or a line</p>
</td></tr>
<tr><td><code id="plot.Pupil_difference_data_+3A_colour">colour</code></td>
<td>
<p>string indicating colour of geom, passed to ggplot2</p>
</td></tr>
<tr><td><code id="plot.Pupil_difference_data_+3A_...">...</code></td>
<td>
<p>Ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
regressed_data &lt;- regress_data(data = Sdata, pupil1 = RPupil, pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data,
pupil1 = RPupil, pupil2 = LPupil)
base_data &lt;- baseline_data(data = mean_data, pupil = mean_pupil, start = 0, stop = 100)
differences &lt;- create_difference_data(data = base_data,
pupil = mean_pupil)
p &lt;- plot(differences, pupil = mean_pupil, geom = 'line')
p
</code></pre>

<hr>
<h2 id='plot.Pupil_test_data'>Pre-prepared plots of PupillometryR data</h2><span id='topic+plot.Pupil_test_data'></span>

<h3>Description</h3>

<p>The plot functions are designed to run with just data and pupil selections,
with some additional options for fun with plotting. To see these plots,
you must first use one of the run_functional tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Pupil_test_data'
plot(x, show_divergence = TRUE, colour = "black", fill = "grey", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.Pupil_test_data_+3A_x">x</code></td>
<td>
<p>A Pupil_test_data dataframe</p>
</td></tr>
<tr><td><code id="plot.Pupil_test_data_+3A_show_divergence">show_divergence</code></td>
<td>
<p>logical indicating whether divergences are to be highlighted</p>
</td></tr>
<tr><td><code id="plot.Pupil_test_data_+3A_colour">colour</code></td>
<td>
<p>string indicating colour of geom_line, passed to ggplot2</p>
</td></tr>
<tr><td><code id="plot.Pupil_test_data_+3A_fill">fill</code></td>
<td>
<p>string indicating fill hue of divergence highlights, passed to ggplot2</p>
</td></tr>
<tr><td><code id="plot.Pupil_test_data_+3A_...">...</code></td>
<td>
<p>Ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
regressed_data &lt;- regress_data(data = Sdata, pupil1 = RPupil, pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data,
pupil1 = RPupil, pupil2 = LPupil)
base_data &lt;- baseline_data(data = mean_data, pupil = mean_pupil, start = 0, stop = 100)
differences &lt;- create_difference_data(data = base_data,
pupil = mean_pupil)
spline_data &lt;- create_functional_data(data = differences, pupil = mean_pupil, basis = 10, order = 4)
ft_data &lt;- run_functional_t_test(data = spline_data,
pupil = mean_pupil)
p &lt;- plot(ft_data, show_divergence = TRUE, colour = 'red', fill = 'orange')
p
</code></pre>

<hr>
<h2 id='plot.Pupil_window_data'>Pre-prepared plots of PupillometryR data</h2><span id='topic+plot.Pupil_window_data'></span>

<h3>Description</h3>

<p>The plot functions are designed to run with just data and pupil selections,
with some additional options for fun with plotting. To see these plots,
you must first use create_window_data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Pupil_window_data'
plot(
  x,
  pupil,
  windows = c(FALSE, TRUE),
  geom = c("raincloud", "violin", "boxplot"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.Pupil_window_data_+3A_x">x</code></td>
<td>
<p>A Pupil_window_data dataframe</p>
</td></tr>
<tr><td><code id="plot.Pupil_window_data_+3A_pupil">pupil</code></td>
<td>
<p>Column name of pupil data to be plotted</p>
</td></tr>
<tr><td><code id="plot.Pupil_window_data_+3A_windows">windows</code></td>
<td>
<p>Whether you want to include time windows in the plot - logical</p>
</td></tr>
<tr><td><code id="plot.Pupil_window_data_+3A_geom">geom</code></td>
<td>
<p>violin plots or boxplots. The newest version adds raincloud plots using Ben Marwick's flat violin plot.</p>
</td></tr>
<tr><td><code id="plot.Pupil_window_data_+3A_...">...</code></td>
<td>
<p>Ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
regressed_data &lt;- regress_data(data = Sdata, pupil1 = RPupil, pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data,
pupil1 = RPupil, pupil2 = LPupil)
base_data &lt;- baseline_data(data = mean_data, pupil = mean_pupil, start = 0, stop = 100)
window &lt;- create_window_data(data = base_data,pupil = mean_pupil)
p &lt;-plot(window, pupil = mean_pupil, windows = FALSE, geom = 'boxplot')
p

</code></pre>

<hr>
<h2 id='plot.PupillometryR'>Pre-prepared plots of PupillometryR data</h2><span id='topic+plot.PupillometryR'></span>

<h3>Description</h3>

<p>The plot functions are designed to run with just data and pupil selections,
with some additional options for fun with plotting. This allows to see
raw data as points, grouped by either subject or condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PupillometryR'
plot(
  x,
  pupil,
  group = c("none", "condition", "subject"),
  geom = c("point", "line", "pointrange"),
  model = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.PupillometryR_+3A_x">x</code></td>
<td>
<p>A PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="plot.PupillometryR_+3A_pupil">pupil</code></td>
<td>
<p>Column name of pupil data to be plotted</p>
</td></tr>
<tr><td><code id="plot.PupillometryR_+3A_group">group</code></td>
<td>
<p>What to group the data by (none, condition, or subject)</p>
</td></tr>
<tr><td><code id="plot.PupillometryR_+3A_geom">geom</code></td>
<td>
<p>Geom to pass to ggplot. Either point, line, or pointrange.</p>
</td></tr>
<tr><td><code id="plot.PupillometryR_+3A_model">model</code></td>
<td>
<p>Optional argument to plot agains a fitted model</p>
</td></tr>
<tr><td><code id="plot.PupillometryR_+3A_...">...</code></td>
<td>
<p>Ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)
Sdata2 &lt;- downsample_time_data(data = Sdata,
pupil = LPupil,
timebin_size = 100,
option = 'median')
p &lt;- plot(Sdata2, pupil = LPupil, group = 'subject')
p

</code></pre>

<hr>
<h2 id='pupil_data'>Data collected in a pupillometry study by Sylvain Sirois</h2><span id='topic+pupil_data'></span>

<h3>Description</h3>

<p>Data from a simple study measuring pupil dilation as participants answer hard or easy maths problems.
Original data sourced and reformatted from Sylvain Sirois' Pupillometry tutorial available at https://oraprdnt.uqtr.uquebec.ca/pls/public/gscw031?owa_no_site=314&amp;owa_no_fiche=3&amp;owa_bottin=)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pupil_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 28800 rows and 7 variables: </p>

<dl>
<dt>ID</dt><dd><p>Uniaue participant ID</p>
</dd>
<dt>Trial</dt><dd><p>Unique trial code (also unique for each participant)</p>
</dd>
<dt>RPupil</dt><dd><p>Right pupil size</p>
</dd>
<dt>LPupil</dt><dd><p>Left Pupil Size</p>
</dd>
<dt>Timebin</dt><dd><p>Ordered timebin within each trial</p>
</dd>
<dt>Time</dt><dd><p>Elapsed time within trial</p>
</dd>
<dt>Type</dt><dd><p>Hard or easy trial?</p>
</dd></dl>
<p> ... 
</p>


<h3>Source</h3>

<p>(https://oraprdnt.uqtr.uquebec.ca/pls/public/gscw031?owa_no_site=314&amp;owa_no_fiche=3&amp;owa_bottin=)
</p>

<hr>
<h2 id='regress_data'>Regress one pupil against another for extra smoothing</h2><span id='topic+regress_data'></span>

<h3>Description</h3>

<p>regress_data runs a simple linear regression of pupil1 against pupil2 and the reverse.
This can help to account for small amount of bumpiness in the data.
The regression runs over each participant and each trial, per time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regress_data(data, pupil1, pupil2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regress_data_+3A_data">data</code></td>
<td>
<p>a PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="regress_data_+3A_pupil1">pupil1</code></td>
<td>
<p>Column name for first pupil data</p>
</td></tr>
<tr><td><code id="regress_data_+3A_pupil2">pupil2</code></td>
<td>
<p>Column name for second pupil data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a PupillometryR dataframe with smoothed pupil values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)
regressed_data &lt;- regress_data(data = Sdata,
pupil1 = RPupil,
pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data,
pupil1 = RPupil, pupil2 = LPupil)

</code></pre>

<hr>
<h2 id='replace_missing_data'>replaces missing observations if you have some degree of incomplete observations</h2><span id='topic+replace_missing_data'></span>

<h3>Description</h3>

<p>This is a useful function if you have a dataset where certain timepoints have been removed for whatever reason,
but you want continuous time data. This will make assumptions about trials being the same length though,
so may not be appropriate for all data types.
This should only be run after running make_pupillometry_data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_missing_data(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="replace_missing_data_+3A_data">data</code></td>
<td>
<p>your data of class pupillometryR</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A time-stepped data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pupil_data)
Sdata &lt;- make_pupillometryr_data(data = pupil_data,
subject = ID,
trial = Trial,
time = Time,
condition = Type)
new_data &lt;- replace_missing_data(data = Sdata)
</code></pre>

<hr>
<h2 id='run_functional_t_test'>Run a functional t-test on a dataframe previously fitted with b-splines.</h2><span id='topic+run_functional_t_test'></span>

<h3>Description</h3>

<p>This allows running of a functional t-test for a given alpha on pupil data that has been fitted with b-splines.
This is only appropriate for functional difference data, as it assumes we are dealing with condition A - condition B.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_functional_t_test(data, pupil, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_functional_t_test_+3A_data">data</code></td>
<td>
<p>a Pupil_difference_data fitted with b-splines</p>
</td></tr>
<tr><td><code id="run_functional_t_test_+3A_pupil">pupil</code></td>
<td>
<p>column name indicating pupil data to test</p>
</td></tr>
<tr><td><code id="run_functional_t_test_+3A_alpha">alpha</code></td>
<td>
<p>an alpha level to be set for the t-test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Pupil_test_data dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
regressed_data &lt;- regress_data(data = Sdata, pupil1 = RPupil, pupil2 = LPupil)
mean_data &lt;- calculate_mean_pupil_size(data = regressed_data, pupil1 = RPupil, pupil2 = LPupil)
base_data &lt;- baseline_data(data = mean_data, pupil = mean_pupil, start = 0, stop = 100)
differences &lt;- create_difference_data(data = base_data, pupil = mean_pupil)
spline_data &lt;- create_functional_data(data = differences, pupil = mean_pupil, basis = 10, order = 4)
ft_data &lt;- run_functional_t_test(data = spline_data, pupil = mean_pupil, alpha = 0.05)

</code></pre>

<hr>
<h2 id='subset_data'>Subset data to provide start and finish time windows</h2><span id='topic+subset_data'></span>

<h3>Description</h3>

<p>subset_data can be used on a PupillometryR dataframe to subset the time into relevant chunks.
This, ideally should be one of the first runctions run, before anything analytical.
Use this to indicate a start and stop time to create a new resized dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_data(data, start = NULL, stop = NULL, rezero = T, remove = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subset_data_+3A_data">data</code></td>
<td>
<p>a PupillometryR dataframe</p>
</td></tr>
<tr><td><code id="subset_data_+3A_start">start</code></td>
<td>
<p>a single number indicating start time of new dataframe</p>
</td></tr>
<tr><td><code id="subset_data_+3A_stop">stop</code></td>
<td>
<p>a single number indicating end time of new dataframe</p>
</td></tr>
<tr><td><code id="subset_data_+3A_rezero">rezero</code></td>
<td>
<p>logical, whether time should start from zero</p>
</td></tr>
<tr><td><code id="subset_data_+3A_remove">remove</code></td>
<td>
<p>logical, remove observations outside of start and stop</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a subsetted PupillometryR dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sdata &lt;- make_pupillometryr_data(data = pupil_data,
                               subject = ID,
                               trial = Trial,
                               time = Time,
                               condition = Type)
subset_data(Sdata, start = 100, stop = 10000, rezero = TRUE, remove = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
