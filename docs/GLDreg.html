<!DOCTYPE html><html lang="en"><head><title>Help for package GLDreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GLDreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GLDreg-package'>
<p>This package fits standard and quantile and accerlerated Failure Time regression</p>
models using RS and FMKL/FKML generalised lambda distributions via maximum
likelihood estimation and L moment
matching.</a></li>
<li><a href='#+20Fitting+20functions+20for+20GLD+20AFT+20regression+20'><p> This is a collection of functions designed to implement the fitting</p>
algorithms for GLD AFT regression in this package.</a></li>
<li><a href='#+20Fitting+20functions+20for+20GLD+20regression+20'><p> This is a collection of functions designed to implement the fitting</p>
algorithms for GLD regression in this package.</a></li>
<li><a href='#actg'><p>ACTG 320 Clinical Trial Dataset</p></a></li>
<li><a href='#fun.mean.convert'>
<p>Convert a RS or FKML GLD into RS or FKML GLD to the desired theoretical mean by</p>
changing only the first parameter</a></li>
<li><a href='#fun.plot.q'>
<p>2-D Plot for Quantile Regression lines</p></a></li>
<li><a href='#GLD.lm'>
<p>This function fits a GLD regression linear model</p></a></li>
<li><a href='#GLD.lm.full'>
<p>This function fits a GLD regression linear model and conducts simulations to</p>
display the statistical properties of estimated coefficients</a></li>
<li><a href='#GLD.lm.full.surv'>
<p>This function fits a GLD Accelerated Failure Time regression linear model and</p>
conducts simulations to display the statistical properties of estimated
coefficients</a></li>
<li><a href='#GLD.lm.surv'>
<p>This function fits a GLD Accelerated Failure Time Model for Survival Data</p></a></li>
<li><a href='#GLD.quantreg'>
<p>Fit a GLD quantile regression parametrically or non parametrically</p></a></li>
<li><a href='#qqgld.default'>
<p>QQ plot for GLD</p></a></li>
<li><a href='#summaryGraphics.gld.lm'>
<p>Graphical display of output from <code>GLD.lm.full</code></p></a></li>
<li><a href='#summaryGraphics.gld.surv.lm'>
<p>Graphical display of output from <code>GLD.lm.full.surv</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fit GLD Regression/Quantile/AFT Model to Data</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-23</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Steve Su &lt;allegro.su@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>GLDEX (&ge; 2.0.0.5), ddst, grDevices, graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, quantreg</td>
</tr>
<tr>
<td>Description:</td>
<td>Owing to the rich shapes of Generalised Lambda Distributions (GLDs), GLD standard/quantile/Accelerated Failure Time (AFT) regression is a competitive flexible model compared to standard/quantile/AFT regression. The proposed method has some major advantages: 1) it provides a reference line which is very robust to outliers with the attractive property of zero mean residuals and 2) it gives a unified, elegant quantile regression model from the reference line with smooth regression coefficients across different quantiles. For AFT model, it also eliminates the needs to try several different AFT models, owing to the flexible shapes of GLD. The goodness of fit of  the proposed model can be assessed via QQ plots and Kolmogorov-Smirnov tests and data driven smooth test, to ensure the appropriateness of the statistical inference under consideration. Statistical distributions of coefficients of the GLD regression line are obtained using simulation, and interval estimates are obtained directly from simulated data.  References include the following: Su (2015) "Flexible Parametric Quantile Regression Model" &lt;<a href="https://doi.org/10.1007%2Fs11222-014-9457-1">doi:10.1007/s11222-014-9457-1</a>&gt;, Su (2021) "Flexible parametric accelerated failure time model"&lt;<a href="https://doi.org/10.1080%2F10543406.2021.1934854">doi:10.1080/10543406.2021.1934854</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-22 23:52:01 UTC; allegro</td>
</tr>
<tr>
<td>Author:</td>
<td>Steve Su <a href="https://orcid.org/0000-0002-3368-4926"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph],
  R Core Team [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-23 00:33:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='GLDreg-package'>
This package fits standard and quantile and accerlerated Failure Time regression 
models using RS and FMKL/FKML generalised lambda distributions via maximum 
likelihood estimation and L moment 
matching.
</h2><span id='topic+GLDreg-package'></span><span id='topic+GLDreg'></span>

<h3>Description</h3>

<p>Owing to the rich shapes of GLDs, GLD standard/quantile regression is a 
competitive flexible model compared to standard/quantile regression. The 
proposed method has some major advantages: 1) it provides a reference line which 
is very robust to outliers with the attractive property of zero mean residuals 
and 2) it gives a unified, elegant quantile regression model from the reference 
line with smooth regression coefficients across different quantiles. The 
goodness of fit of the proposed model can be assessed via QQ plots and 
Kolmogorov-Smirnov tests and Data Driven Smooth Test, to ensure the 
appropriateness of the statistical inference under consideration. Statistical 
distributions of coefficients of the GLD regression line are obtained using 
simulation, and interval estimates are obtained directly from simulated data. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> GLDreg</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-01-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> CC BY-NC-SA 4.0 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The primary fitting function for GLD regression model is
<code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code>. The output of <code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code> can then be
passed to <code><a href="#topic+summaryGraphics.gld.lm">summaryGraphics.gld.lm</a></code> to display coefficients of GLD
regression model graphically. Once a GLD reference model is obtained,  
quantile regression is obtained using <code><a href="#topic+GLD.quantreg">GLD.quantreg</a></code>.
</p>
<p>The corresponding fitting algorithms for survival data are 
<code><a href="#topic+GLD.lm.full.surv">GLD.lm.full.surv</a></code> which can then be passed to 
<code><a href="#topic+summaryGraphics.gld.surv.lm">summaryGraphics.gld.surv.lm</a></code> to display coefficients of GLD
regression model graphically.
</p>


<h3>Author(s)</h3>

<p>Steve Su &lt;allegro.su@gmail.com&gt;
</p>


<h3>References</h3>

<p>Su, S. (2015) &quot;Flexible Parametric Quantile Regression Model&quot; Statistics &amp;
Computing 25 (3). 635-650. doi:10.1007/s11222-014-9457-1   
</p>
<p>Su S. (2021) &quot;Flexible parametric accelerated failure time model&quot; J Biopharm Stat. 
2021 Sep 31(5):650-667. doi:10.1080/10543406.2021.1934854
</p>


<h3>See Also</h3>

<p><span class="pkg">GLDEX</span>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dummy example

## Create dataset

set.seed(10)

x&lt;-rnorm(200,3,2)
y&lt;-3*x+rnorm(200)

dat&lt;-data.frame(y,x)

## Fit a FKML GLD regression

example&lt;-GLD.lm(y~x,data=dat,fun=fun.RMFMKL.ml.m,param="fkml")

## Fit FKML GLD regression with 3 simulations

fit&lt;-GLD.lm.full(y~x,data=dat,fun=fun.RMFMKL.ml.m,param="fkml",n.simu=3)

## Find median regression, use empirical method

med.fit&lt;-GLD.quantreg(0.5,fit,slope="fixed",emp=TRUE)

## Not run: 

## Extract the Engel dataset 

library(quantreg)
data(engel)

## Fit GLD Regression along with simulations

engel.fit.all&lt;-GLD.lm.full(foodexp~income,data=engel,
param="fmkl",fun=fun.RMFMKL.ml.m)

## Plot coefficient summary

summaryGraphics.gld.lm(engel.fit.all)

## Fit quantile regression from 0.1 to 0.9, with equal spacings between 
## quantiles

result&lt;-GLD.quantreg(seq(0.1,.9,length=9),engel.fit.all,intercept="fixed")

## Plot quantile regression lines

fun.plot.q(x=engel$income,y=engel$foodexp,fit=engel.fit.all[[1]],result,
xlab="income",ylab="Food Expense")

## Sometimes the maximum likelihood estimation may fail, for example when 
## minimum/maximum support of GLD is exactly at the minimum/maximum value of the 
## dataset, if this the case, try to use the L-moment matching method.

engel.fit.all&lt;-GLD.lm.full(foodexp~income,data=engel,
param="fmkl",fun=fun.RMFMKL.lm)

## Fit Accelerated Failure Time model to actg data:

actg.rs&lt;-GLD.lm.full.surv(log(time)~factor(txgrp)+hemophil+cd4+priorzdv+age,
censoring=actg[which(actg$txgrp!=3 &amp; actg$txgrp!=4),]$censor, 
data=actg[which(actg$txgrp!=3 &amp; actg$txgrp!=4),],
param="rs",fun=fun.RPRS.ml.m,summary.plot=F,n.simu=1000)

summaryGraphics.gld.surv.lm(actg.rs,label=c("(Intercept)",
"IDV versus no IDV","Hemophiliac","Baseline CD4",
"Months of prior \n ZDV use","Age"),exp="TRUE")


## End(Not run)
</code></pre>

<hr>
<h2 id='+20Fitting+20functions+20for+20GLD+20AFT+20regression+20'> This is a collection of functions designed to implement the fitting 
algorithms for GLD AFT regression in this package. </h2><span id='topic+survival.mle'></span><span id='topic+optim.survival.mle1'></span><span id='topic+optim.survival.mle2'></span><span id='topic+fun.simu.gld.lm.alt.surv'></span><span id='topic+GLD.lm.simu.surv'></span>

<h3>Description</h3>

<p>These functions are for maintainers only and it is not designed for the users 
of this package.
</p>


<h3>Value</h3>

<p> List of computation results for various fitting algorithms, not intended to be used by users of this package </p>


<h3>Note</h3>

<p> Please contact the author directly if you find a bug! </p>


<h3>Author(s)</h3>

<p> Steve Su </p>

<hr>
<h2 id='+20Fitting+20functions+20for+20GLD+20regression+20'> This is a collection of functions designed to implement the fitting 
algorithms for GLD regression in this package. </h2><span id='topic+fun.fix.mean'></span><span id='topic+fun.simu.gld.lm.alt'></span><span id='topic+fun.simu.bias.correct.alt'></span><span id='topic+fun.model.lm.optim'></span><span id='topic+fun.model.lm.optim.Lmoment'></span><span id='topic+GLD.lm.simu'></span><span id='topic+fun.gld.all.vary.emp'></span><span id='topic+fun.gld.all.vary'></span><span id='topic+fun.gld.slope.fixed.int.vary.emp'></span><span id='topic+fun.gld.slope.fixed.int.vary'></span><span id='topic+fun.gld.slope.vary.int.fixed.emp'></span><span id='topic+fun.gld.slope.vary.int.fixed'></span>

<h3>Description</h3>

<p>These functions are for maintainers only and it is not designed for the users 
of this package.
</p>


<h3>Value</h3>

<p> List of computation results for various fitting algorithms, not intended to be used by users of this package </p>


<h3>Note</h3>

<p> Please contact the author directly if you find a bug! </p>


<h3>Author(s)</h3>

<p> Steve Su </p>

<hr>
<h2 id='actg'>ACTG 320 Clinical Trial Dataset</h2><span id='topic+actg'></span>

<h3>Description</h3>

<p>actg dataset from Hosmer et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(actg)
</code></pre>


<h3>Format</h3>


<dl>
<dt>id</dt><dd><p>Identification Code</p>
</dd>
<dt>time</dt><dd><p>Time to AIDS diagnosis or death (days).</p>
</dd>
<dt>censor</dt><dd><p>Event indicator. 1 = AIDS defining diagnosis, 0 = Otherwise.</p>
</dd>
<dt>time_d</dt><dd><p>Time to death (days)</p>
</dd>
<dt>censor_d</dt><dd><p>Event indicator for death (only). 1 = Death, 0 = Otherwise.</p>
</dd>
<dt>tx</dt><dd><p>Treatment indicator. 1 = Treatment includes IDV, 0 = Control group.</p>
</dd>
<dt>txgrp</dt><dd><p>Treatment group indicator. 1 = ZDV + 3TC. 2 = ZDV + 3TC + IDV. 3 = d4T + 3TC.
4 = d4T + 3TC + IDV.</p>
</dd>
<dt>strat2</dt><dd><p>CD4 stratum at screening. 0 = CD4 &lt;= 50. 1 = CD4 &gt; 50.</p>
</dd>
<dt>sexF</dt><dd><p>0 = Male. 1 = Female.</p>
</dd>
<dt>raceth</dt><dd><p>Race/Ethnicity. 1 = White Non-Hispanic. 2 = Black Non-Hispanic. 3 = Hispanic.
4 = Asian, Pacific Islander. 5 = American Indian, Alaskan Native. 6 = Other/unknown.</p>
</dd>
<dt>ivdrug</dt><dd><p>IV drug use history. 1 = Never. 2 = Currently. 3 = Previously.</p>
</dd>
<dt>hemophil</dt><dd><p>Hemophiliac. 1 = Yes. 0 = No.</p>
</dd>
<dt>karnof</dt><dd><p>Karnofsky Performance Scale. 100 = Normal; no complaint no evidence of disease.
90 = Normal activity possible; minor signs/symptoms of disease. 80 = Normal activity with
effort; some signs/symptoms of disease. 70 = Cares for self; normal activity/active work not
possible.</p>
</dd>
<dt>cd4</dt><dd><p>Baseline CD4 count (Cells/Milliliter).</p>
</dd>
<dt>priorzdv</dt><dd><p>Months of prior ZDV use (months).</p>
</dd>
<dt>age</dt><dd><p>Age at Enrollment (years).</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://hivdb.stanford.edu/pages/clinicalStudyData/ACTG320.html">https://hivdb.stanford.edu/pages/clinicalStudyData/ACTG320.html</a>
</p>


<h3>References</h3>

<p>Hosmer, D.W. and Lemeshow, S. and May, S. (2008)
Applied Survival Analysis: Regression Modeling of Time to Event Data: Second
Edition, John Wiley and Sons Inc., New York, NY
</p>

<hr>
<h2 id='fun.mean.convert'>
Convert a RS or FKML GLD into RS or FKML GLD to the desired theoretical mean by
changing only the first parameter
</h2><span id='topic+fun.mean.convert'></span>

<h3>Description</h3>

<p>A simple transformation of altering the location of RS/FKML GLD so that
the theoretical mean is altered to the level specified. Only the first parameter
of RS/FKML GLD is altered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fun.mean.convert(x, param, val = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fun.mean.convert_+3A_x">x</code></td>
<td>

<p>A vector of four values representing Lambda 1, Lambda 2, Lambda 3 and Lambda 4
of RS/FKML GLD.
</p>
</td></tr>
<tr><td><code id="fun.mean.convert_+3A_param">param</code></td>
<td>

<p>Can be &quot;rs&quot; or &quot;fmkl&quot; or &quot;fkml&quot;
</p>
</td></tr>
<tr><td><code id="fun.mean.convert_+3A_val">val</code></td>
<td>

<p>The targeted theoretical mean
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of four values representing Lambda 1, Lambda 2, Lambda 3 and Lambda 4
of the transformed RS/FKML GLD 
</p>


<h3>Note</h3>

<p>If finite first moment does not exist, original input values will be returned
</p>


<h3>Author(s)</h3>

<p>Steve Su
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Transform RS GLD with parameters 3,2,1,1 to mean of 0
fun.mean.convert(c(3,2,1,1),param="rs")

# Check that the desired outcome is achieved
fun.theo.mv.gld(0,2,1,1,param="rs")

# Transform RS GLD with parameters 3,2,1,1 to mean of 5
fun.mean.convert(c(3,2,1,1),param="fkml",5)

# Check that the desired outcome is achieved
fun.theo.mv.gld(5,2,1,1,param="fkml")

</code></pre>

<hr>
<h2 id='fun.plot.q'>
2-D Plot for Quantile Regression lines
</h2><span id='topic+fun.plot.q'></span>

<h3>Description</h3>

<p>This function plots quantile regression lines from <code><a href="#topic+GLD.lm">GLD.lm</a></code> and
one of <code><a href="#topic+fun.gld.slope.vary.int.fixed">fun.gld.slope.vary.int.fixed</a></code>,
<code><a href="#topic+fun.gld.slope.fixed.int.vary">fun.gld.slope.fixed.int.vary</a></code>, 
<code><a href="#topic+fun.gld.slope.fixed.int.vary.emp">fun.gld.slope.fixed.int.vary.emp</a></code>, 
<code><a href="#topic+fun.gld.all.vary.emp">fun.gld.all.vary.emp</a></code>, <code><a href="#topic+fun.gld.all.vary">fun.gld.all.vary</a></code>, 
<code><a href="#topic+fun.gld.slope.vary.int.fixed.emp">fun.gld.slope.vary.int.fixed.emp</a></code>, <code><a href="#topic+GLD.quantreg">GLD.quantreg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fun.plot.q(x, y, fit, quant.info, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fun.plot.q_+3A_x">x</code></td>
<td>

<p>A numerical vector of explanatory variable
</p>
</td></tr>
<tr><td><code id="fun.plot.q_+3A_y">y</code></td>
<td>

<p>A numerical vector of response variable 
</p>
</td></tr>
<tr><td><code id="fun.plot.q_+3A_fit">fit</code></td>
<td>

<p>An object from <code><a href="#topic+GLD.lm">GLD.lm</a></code>
</p>
</td></tr>
<tr><td><code id="fun.plot.q_+3A_quant.info">quant.info</code></td>
<td>

<p>An object from one of <code><a href="#topic+fun.gld.slope.vary.int.fixed">fun.gld.slope.vary.int.fixed</a></code>,
<code><a href="#topic+fun.gld.slope.fixed.int.vary">fun.gld.slope.fixed.int.vary</a></code>, 
<code><a href="#topic+fun.gld.slope.fixed.int.vary.emp">fun.gld.slope.fixed.int.vary.emp</a></code>, 
<code><a href="#topic+fun.gld.all.vary.emp">fun.gld.all.vary.emp</a></code>, <code><a href="#topic+fun.gld.all.vary">fun.gld.all.vary</a></code>, 
<code><a href="#topic+fun.gld.slope.vary.int.fixed.emp">fun.gld.slope.vary.int.fixed.emp</a></code>, <code><a href="#topic+GLD.quantreg">GLD.quantreg</a></code>
</p>
</td></tr>
<tr><td><code id="fun.plot.q_+3A_...">...</code></td>
<td>

<p>Additional arguments to be passed to plot function, such as axis labels and 
title of the graph
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is intended to plot only two variables, for quantile regression involving
more than one explanatory variable, consider plotting the actual values versus 
fitted values by fitting a secondary GLD quantile model between actual and 
fitted values.
</p>


<h3>Value</h3>

<p>A graph showing quantile regression lines
</p>


<h3>Author(s)</h3>

<p>Steve Su
</p>


<h3>References</h3>

<p>Su (2015) &quot;Flexible Parametric Quantile Regression Model&quot; Statistics &amp;
Computing  May 2015, Volume 25, Issue 3, pp 635-650
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dummy example

## Create dataset

set.seed(10)

x&lt;-rnorm(200,3,2)
y&lt;-3*x+rnorm(200)

dat&lt;-data.frame(y,x)

## Fit FKML GLD regression with 3 simulations

fit&lt;-GLD.lm.full(y~x,data=dat,fun=fun.RMFMKL.ml.m,param="fkml",n.simu=3)

## Find median regression, use empirical method

med.fit&lt;-GLD.quantreg(0.5,fit,slope="fixed",emp=TRUE)

fun.plot.q(x=x,y=y,fit=fit[[1]],med.fit, xlab="x",ylab="y")

## Not run: 

## Plot result of quantile regression

## Extract the Engel dataset 

library(quantreg)
data(engel)

## Fit GLD Regression along with simulations

engel.fit.all&lt;-GLD.lm.full(foodexp~income,data=engel,
param="fmkl",fun=fun.RMFMKL.ml.m)

## Fit quantile regression from 0.1 to 0.9, with equal spacings between 
## quantiles

result&lt;-GLD.quantreg(seq(0.1,.9,length=9),engel.fit.all,intercept="fixed")

## Plot the quantile regression lines

fun.plot.q(x=engel$income,y=engel$foodexp,fit=engel.fit.all[[1]],result,
xlab="income",ylab="Food Expense")

## End(Not run)
</code></pre>

<hr>
<h2 id='GLD.lm'>
This function fits a GLD regression linear model
</h2><span id='topic+GLD.lm'></span>

<h3>Description</h3>

<p>Similar to <code><a href="stats.html#topic+lm">lm</a></code>, this function fits a linear model using RS/FKML
GLDs and assess the goodness of fit of GLD with respect to the data via qq plot
and Kolmogorov-Smirnoff (KS) test. Note that the use of KS test when parameters 
of a distribution are estimated from data is generally frowned upon. This is because 
one often gets inflated p-value with increased type II error due to the fact that the 
KS test requires independence between test sample and parameters of distribution.
Therefore, the the resample KS test over 1000 simulation runs from GLDEX package is 
probably a more reasonable measure. It is probably reasonable to consider the resample 
KS test may in fact decrease the p-values, as testing is done on resampled data from 
fitted distribution so there is a certain degree of inaccuracy there. The provision of 
these results is to give some indication of optimistic and pessimistic goodness
of fit measure, as currently, there is an absence of a specialised GLD goodness of fit test. 
A generic Data Driven Smooth Test from ddst library in R is also incorporated to assess goodness of fit.
</p>
<p>When in doubt, QQ plot should always be considered ahead of these results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GLD.lm(formula, data, param, maxit = 20000, fun, method = "Nelder-Mead", 
diagnostics = TRUE, range = c(0.01, 0.99), init = NULL, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GLD.lm_+3A_formula">formula</code></td>
<td>

<p>A symbolic expression of the model to be fitted, similar to the formula
argument in <code><a href="stats.html#topic+lm">lm</a></code>, see <code><a href="stats.html#topic+formula">formula</a></code> for more information
</p>
</td></tr>
<tr><td><code id="GLD.lm_+3A_data">data</code></td>
<td>

<p>Dataset containing variables of the model
</p>
</td></tr>
<tr><td><code id="GLD.lm_+3A_param">param</code></td>
<td>

<p>Can be &quot;rs&quot;, &quot;fmkl&quot; or &quot;fkml&quot;
</p>
</td></tr>
<tr><td><code id="GLD.lm_+3A_maxit">maxit</code></td>
<td>

<p>Maximum number of iterations for numerical optimisation 
</p>
</td></tr>
<tr><td><code id="GLD.lm_+3A_fun">fun</code></td>
<td>

<p>If param=&quot;fmkl&quot; or &quot;fkml&quot;, this can be one of <code><a href="GLDEX.html#topic+fun.RMFMKL.ml.m">fun.RMFMKL.ml.m</a></code>, 
<code><a href="GLDEX.html#topic+fun.RMFMKL.ml">fun.RMFMKL.ml</a></code>, for maximum
likelihood estimation (*.ml.m is a faster implementation of *.ml) and 
<code><a href="GLDEX.html#topic+fun.RMFMKL.lm">fun.RMFMKL.lm</a></code> for L moment matching.
</p>
<p>If param=&quot;rs&quot;, this can be one of <code><a href="GLDEX.html#topic+fun.RPRS.ml.m">fun.RPRS.ml.m</a></code>, 
<code><a href="GLDEX.html#topic+fun.RPRS.ml">fun.RPRS.ml</a></code>, for maximum
likelihood estimation (*.ml.m is a faster implementation of *.ml) and 
<code><a href="GLDEX.html#topic+fun.RPRS.lm">fun.RPRS.lm</a></code> for L moment matching.
</p>
</td></tr>
<tr><td><code id="GLD.lm_+3A_method">method</code></td>
<td>

<p>Defaults to &quot;Nelder-Mead&quot; algorithm, can also be &quot;SANN&quot; but this is a lot slower
and may not as good
</p>
</td></tr>
<tr><td><code id="GLD.lm_+3A_diagnostics">diagnostics</code></td>
<td>

<p>Defaults to TRUE, which computes Kolmogorov-Smirnoff test and do QQ plot 
</p>
</td></tr>
<tr><td><code id="GLD.lm_+3A_range">range</code></td>
<td>

<p>The is the quantile range to plot the QQ plot, defaults to 0.01 and 0.99 to
avoid potential problems with extreme values of GLD which might be -Inf or Inf.
</p>
</td></tr>
<tr><td><code id="GLD.lm_+3A_init">init</code></td>
<td>

<p>Choose a different set of initial values to start the optimisation process. This
can either be full set of parameters including GLD parameter estimates, or it
can just be the coefficient estimates of the regression model. 
</p>
</td></tr>
<tr><td><code id="GLD.lm_+3A_alpha">alpha</code></td>
<td>

<p>Significant level of KS test.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Message</code></td>
<td>
<p>Short description of estimation method used and whether the 
result converged</p>
</td></tr>
<tr><td><code>Bias Correction</code></td>
<td>
<p>Bias correction used to ensure the line has zero mean 
residuals</p>
</td></tr>
<tr><td><code>Estimated parameters</code></td>
<td>
<p>A set of estimate coefficients from GLD regression</p>
</td></tr>
<tr><td><code>Fitted</code></td>
<td>
<p>Predicted response value from model</p>
</td></tr>
<tr><td><code>Residual</code></td>
<td>
<p>Residual of model</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Formula used in the model</p>
</td></tr>
<tr><td><code>param</code></td>
<td>
<p>Specify whether RS/FKML/FMKL GLD was used</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The response variable</p>
</td></tr> 
<tr><td><code>x</code></td>
<td>
<p>The explanatory variable(s)</p>
</td></tr>
<tr><td><code>fun</code></td>
<td>
<p>GLD fitting function used in the computation process, outputted for 
internal programming use</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Steve Su
</p>


<h3>References</h3>

<p>Su (2015) &quot;Flexible Parametric Quantile Regression Model&quot; Statistics &amp;
Computing  May 2015, Volume 25, Issue 3, pp 635-650
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code>, <code><a href="#topic+GLD.quantreg">GLD.quantreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dummy example

library(GLDEX)

## Create dataset

set.seed(10)

x&lt;-rnorm(200,3,2)
y&lt;-3*x+rnorm(200)

dat&lt;-data.frame(y,x)

## Fit a FKML GLD regression

example&lt;-GLD.lm(y~x,data=dat,fun=fun.RMFMKL.ml.m,param="fkml")

## Not run: 

## Extract the Engel dataset 
library(quantreg)
data(engel)

## Fit GLD Regression
engel.fit&lt;-GLD.lm(foodexp~income,data=engel,param="fmkl",fun=fun.RMFMKL.ml.m)

## Extract the mammals dataset 
library(MASS)

mammals.fit&lt;-GLD.lm(log(brain)~log(body),data=mammals,param="rs",
fun=fun.RPRS.lm)

## Using quantile regression coefficients as starting values
library(quantreg)

mammals.fit1&lt;-GLD.lm(log(brain)~log(body),data=mammals,param="rs",
fun=fun.RPRS.lm,init=rq(log(brain)~log(body),data=mammals)$coeff)

# As an exercise, use the result from mammals.fit1 as initial values

GLD.lm(log(brain)~log(body),data=mammals,param="rs",
fun=fun.RPRS.lm,init=mammals.fit1[[3]])

## End(Not run)
</code></pre>

<hr>
<h2 id='GLD.lm.full'>
This function fits a GLD regression linear model and conducts simulations to 
display the statistical properties of estimated coefficients
</h2><span id='topic+GLD.lm.full'></span>

<h3>Description</h3>

<p>The function is an extension of <code><a href="#topic+GLD.lm">GLD.lm</a></code> and defaults to
1000 simulation runs, coefficients and statistical properties of coefficients
can be plotted as part of the output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GLD.lm.full(formula, data, param, maxit = 20000, fun, method = "Nelder-Mead", 
range = c(0.01, 0.99), n.simu = 1000, summary.plot = TRUE, init = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GLD.lm.full_+3A_formula">formula</code></td>
<td>

<p>A symbolic expression of the model to be fitted, similar to the formula
argument in <code><a href="stats.html#topic+lm">lm</a></code>, see <code><a href="stats.html#topic+formula">formula</a></code> for more information
</p>
</td></tr>
<tr><td><code id="GLD.lm.full_+3A_data">data</code></td>
<td>

<p>Dataset containing variables of the model
</p>
</td></tr>
<tr><td><code id="GLD.lm.full_+3A_param">param</code></td>
<td>

<p>Can be &quot;rs&quot;, &quot;fmkl&quot; or &quot;fkml&quot;
</p>
</td></tr>
<tr><td><code id="GLD.lm.full_+3A_maxit">maxit</code></td>
<td>

<p>Maximum number of iterations for numerical optimisation 
</p>
</td></tr>
<tr><td><code id="GLD.lm.full_+3A_fun">fun</code></td>
<td>

<p>If param=&quot;fmkl&quot; or &quot;fkml&quot;, this can be one of <code><a href="GLDEX.html#topic+fun.RMFMKL.ml.m">fun.RMFMKL.ml.m</a></code>, 
<code><a href="GLDEX.html#topic+fun.RMFMKL.ml">fun.RMFMKL.ml</a></code>, for maximum
likelihood estimation (*.ml.m is a faster implementation of *.ml) and 
<code><a href="GLDEX.html#topic+fun.RMFMKL.lm">fun.RMFMKL.lm</a></code> for L moment matching.
</p>
<p>If param=&quot;rs&quot;, this can be one of <code><a href="GLDEX.html#topic+fun.RPRS.ml.m">fun.RPRS.ml.m</a></code>, 
<code><a href="GLDEX.html#topic+fun.RPRS.ml">fun.RPRS.ml</a></code>, for maximum
likelihood estimation (*.ml.m is a faster implementation of *.ml) and 
<code><a href="GLDEX.html#topic+fun.RPRS.lm">fun.RPRS.lm</a></code> for L moment matching.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full_+3A_method">method</code></td>
<td>

<p>Defaults to &quot;Nelder-Mead&quot; algorithm, can also be &quot;SANN&quot; but this is a lot slower
and may not as good
</p>
</td></tr>
<tr><td><code id="GLD.lm.full_+3A_range">range</code></td>
<td>

<p>The is the quantile range to plot the QQ plot, defaults to 0.01 and 0.99 to
avoid potential problems with extreme values of GLD which might be -Inf or Inf.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full_+3A_n.simu">n.simu</code></td>
<td>

<p>Number of times to repeat the simulation runs, defaults to 1000.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full_+3A_summary.plot">summary.plot</code></td>
<td>

<p>Whether to plot the coefficients graphically, defaults to TRUE.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full_+3A_init">init</code></td>
<td>

<p>Choose a different set of initial values to start the optimisation process. This
can either be full set of parameters including GLD parameter estimates, or it
can just be the coefficient estimates of the regression model. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function usually takes some time to run, as it involves refitting the 
GLD regression model many times, the progress of the simulation is outputted
to the R screen, so users can guage the progress of the computation.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>[[1]]</code></td>
<td>
<p>Output of <code><a href="#topic+GLD.lm">GLD.lm</a></code></p>
</td></tr>
<tr><td><code>[[2]]</code></td>
<td>
<p>A matrix showing the bias adjustment, coefficents of the model,
parameters of GLD and whether the result converged at each run</p>
</td></tr>
<tr><td><code>[[3]]</code></td>
<td>
<p>Adjusted simulation result so that the empirical mean of 
coefficients is the same as the estimated parameters obtained in 
<code><a href="#topic+GLD.lm">GLD.lm</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steve Su
</p>


<h3>References</h3>

<p>Su (2015) &quot;Flexible Parametric Quantile Regression Model&quot; Statistics &amp;
Computing  May 2015, Volume 25, Issue 3, pp 635-650
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GLD.lm">GLD.lm</a></code>, <code><a href="#topic+GLD.quantreg">GLD.quantreg</a></code>,  
<code><a href="#topic+summaryGraphics.gld.lm">summaryGraphics.gld.lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dummy example

## Create dataset

set.seed(10)

x&lt;-rnorm(200,3,2)
y&lt;-3*x+rnorm(200)

dat&lt;-data.frame(y,x)

## Fit FKML GLD regression with 3 simulations

fit&lt;-GLD.lm.full(y~x,data=dat,fun=fun.RMFMKL.ml.m,param="fkml",n.simu=3)

## Not run: 
## Extract the Engel dataset 

library(quantreg)
data(engel)

## Fit a full GLD regression

engel.fit.full&lt;-GLD.lm.full(foodexp~income,data=engel,param="fmkl",
fun=fun.RMFMKL.ml.m)

## Extract the mammals dataset 
library(MASS)

## Fit a full GLD regression

mammals.fit.full&lt;-GLD.lm.full(log(brain)~log(body),data=mammals,param="fmkl",
fun=fun.RMFMKL.ml.m)

## Using quantile regression coefficients as starting values
library(quantreg)

mammals.fit1.full&lt;-GLD.lm.full(log(brain)~log(body),data=mammals,param="fmkl",
fun=fun.RMFMKL.ml.m, init=rq(log(brain)~log(body),data=mammals)$coeff)

## Using the result of mammals.fit.full as initial values

mammals.fit2.full&lt;-GLD.lm.full(log(brain)~log(body),data=mammals,param="fmkl",
fun=fun.RMFMKL.ml.m, init=mammals.fit1.full[[1]][[3]])

## End(Not run)
</code></pre>

<hr>
<h2 id='GLD.lm.full.surv'>
This function fits a GLD Accelerated Failure Time regression linear model and 
conducts simulations to display the statistical properties of estimated 
coefficients
</h2><span id='topic+GLD.lm.full.surv'></span>

<h3>Description</h3>

<p>The function is an extension of <code><a href="#topic+GLD.lm.surv">GLD.lm.surv</a></code> and defaults to
1000 simulation runs, coefficients and statistical properties of coefficients
can be plotted as part of the output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GLD.lm.full.surv(formula, censoring, data, param, maxit = 20000, fun, 
method = "Nelder-Mead", range = c(0.01, 0.99), n.simu = 1000, 
summary.plot = FALSE, init = NULL, alpha = 0.05, censor.type = "right", 
adj.int = FALSE, GLD.adj = FALSE, adj.censor = TRUE, keep.uncen = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GLD.lm.full.surv_+3A_formula">formula</code></td>
<td>

<p>A symbolic expression of the model to be fitted, similar to the formula
argument in <code><a href="stats.html#topic+lm">lm</a></code>, see <code><a href="stats.html#topic+formula">formula</a></code> for more information
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_censoring">censoring</code></td>
<td>

<p>1=Event, 0= Censored
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_data">data</code></td>
<td>

<p>Dataset containing variables of the model
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_param">param</code></td>
<td>

<p>Can be &quot;rs&quot;, &quot;fmkl&quot; or &quot;fkml&quot;
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_maxit">maxit</code></td>
<td>

<p>Maximum number of iterations for numerical optimisation 
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_fun">fun</code></td>
<td>

<p>If param=&quot;fmkl&quot; or &quot;fkml&quot;, this can be one of <code><a href="GLDEX.html#topic+fun.RMFMKL.ml.m">fun.RMFMKL.ml.m</a></code>, 
<code><a href="GLDEX.html#topic+fun.RMFMKL.ml">fun.RMFMKL.ml</a></code>, for maximum
likelihood estimation (*.ml.m is a faster implementation of *.ml).
</p>
<p>If param=&quot;rs&quot;, this can be one of <code><a href="GLDEX.html#topic+fun.RPRS.ml.m">fun.RPRS.ml.m</a></code>, 
<code><a href="GLDEX.html#topic+fun.RPRS.ml">fun.RPRS.ml</a></code>, for maximum
likelihood estimation (*.ml.m is a faster implementation of *.ml).
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_method">method</code></td>
<td>

<p>Defaults to &quot;Nelder-Mead&quot; algorithm, can also be &quot;SANN&quot; but this is a lot slower
and may not as good
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_range">range</code></td>
<td>

<p>The is the quantile range to plot the QQ plot, defaults to 0.01 and 0.99 to
avoid potential problems with extreme values of GLD which might be -Inf or Inf.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_n.simu">n.simu</code></td>
<td>

<p>Number of simulations, defaults to 1000.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_summary.plot">summary.plot</code></td>
<td>

<p>If TRUE present graphical display of model fitted.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_init">init</code></td>
<td>

<p>Initial values to start optimization process.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_alpha">alpha</code></td>
<td>

<p>Significant level of goodness of fit test.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_censor.type">censor.type</code></td>
<td>

<p>Can be &quot; right&quot; of &quot;left censored.
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_adj.int">adj.int</code></td>
<td>

<p>Adjust intercept in final output?
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_gld.adj">GLD.adj</code></td>
<td>

<p>Adjust GLD fitted to have theoretical zero mean?
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_adj.censor">adj.censor</code></td>
<td>

<p>Adjust censoring?
</p>
</td></tr>
<tr><td><code id="GLD.lm.full.surv_+3A_keep.uncen">keep.uncen</code></td>
<td>

<p>Keep uncensored values?
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Message</code></td>
<td>
<p>Short description of estimation method used and whether the 
result converged</p>
</td></tr>
<tr><td><code>Bias Correction</code></td>
<td>
<p>Bias correction used to ensure the line has zero mean 
residuals</p>
</td></tr>
<tr><td><code>Estimated parameters</code></td>
<td>
<p>A set of estimate coefficients from GLD regression</p>
</td></tr>
<tr><td><code>Fitted</code></td>
<td>
<p>Predicted response value from model</p>
</td></tr>
<tr><td><code>Residual</code></td>
<td>
<p>Residual of model</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Formula used in the model</p>
</td></tr>
<tr><td><code>param</code></td>
<td>
<p>Specify whether RS/FKML/FMKL GLD was used</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The response variable</p>
</td></tr> 
<tr><td><code>x</code></td>
<td>
<p>The explanatory variable(s)</p>
</td></tr>
<tr><td><code>fun</code></td>
<td>
<p>GLD fitting function used in the computation process, outputted for 
internal programming use</p>
</td></tr> 
<tr><td><code>censoring</code></td>
<td>
<p>Censoring data</p>
</td></tr> 
<tr><td><code>AIC.full</code></td>
<td>
<p>AIC results</p>
</td></tr> 
<tr><td><code>BIC.full</code></td>
<td>
<p>BIC results</p>
</td></tr> 
<tr><td><code>censor.gld.values</code></td>
<td>
<p>Result of GLD fit, including censoring</p>
</td></tr> 
<tr><td><code>simu.result</code></td>
<td>
<p>Result of simulation for all coefficeints in the model</p>
</td></tr> 
<tr><td><code>censor.gld.values</code></td>
<td>
<p>Result of GLD fit, including censoring</p>
</td></tr> 
<tr><td><code>simu.bias.correct.result</code></td>
<td>
<p>Bias corrected simulation results</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Steve Su
</p>


<h3>References</h3>

<p>Su (2021) &quot;Flexible Parametric Accelerated Failure Time Model&quot; Journal of 
Biopharmaceutical Statistics Volume 31, 2021 - Issue 5
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code>, <code><a href="#topic+GLD.quantreg">GLD.quantreg</a></code>, <code><a href="#topic+GLD.lm">GLD.lm</a></code>, 
<code><a href="#topic+GLD.lm.surv">GLD.lm.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

actg.rs&lt;-GLD.lm.full.surv(log(time)~factor(txgrp)+hemophil+cd4+priorzdv+age,
censoring=actg[which(actg$txgrp!=3 &amp; actg$txgrp!=4),]$censor, 
data=actg[which(actg$txgrp!=3 &amp; actg$txgrp!=4),],
param="rs",fun=fun.RPRS.ml.m,summary.plot=F,n.simu=1000)


## End(Not run)</code></pre>

<hr>
<h2 id='GLD.lm.surv'>
This function fits a GLD Accelerated Failure Time Model for Survival Data
</h2><span id='topic+GLD.lm.surv'></span>

<h3>Description</h3>

<p>Similar to <code><a href="#topic+GLD.lm">GLD.lm</a></code>, this function fits an Accelerated Failure Time 
Model using RS/FKML GLDs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GLD.lm.surv(formula, censoring, data, param, maxit = 20000, fun, 
            method = "Nelder-Mead", diagnostics = TRUE, range = c(0.01, 0.99), 
            init = NULL, alpha = 0.05, censor.type = "right", adj.int = TRUE, 
            GLD.adj = FALSE, adj.censor = TRUE, keep.uncen = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GLD.lm.surv_+3A_formula">formula</code></td>
<td>

<p>A symbolic expression of the model to be fitted, similar to the formula
argument in <code><a href="stats.html#topic+lm">lm</a></code>, see <code><a href="stats.html#topic+formula">formula</a></code> for more information
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_censoring">censoring</code></td>
<td>

<p>1=Event, 0= Censored
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_data">data</code></td>
<td>

<p>Dataset containing variables of the model
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_param">param</code></td>
<td>

<p>Can be &quot;rs&quot;, &quot;fmkl&quot; or &quot;fkml&quot;
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_maxit">maxit</code></td>
<td>

<p>Maximum number of iterations for numerical optimisation 
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_fun">fun</code></td>
<td>

<p>If param=&quot;fmkl&quot; or &quot;fkml&quot;, this can be one of <code><a href="GLDEX.html#topic+fun.RMFMKL.ml.m">fun.RMFMKL.ml.m</a></code>, 
<code><a href="GLDEX.html#topic+fun.RMFMKL.ml">fun.RMFMKL.ml</a></code>, for maximum
likelihood estimation (*.ml.m is a faster implementation of *.ml).
</p>
<p>If param=&quot;rs&quot;, this can be one of <code><a href="GLDEX.html#topic+fun.RPRS.ml.m">fun.RPRS.ml.m</a></code>, 
<code><a href="GLDEX.html#topic+fun.RPRS.ml">fun.RPRS.ml</a></code>, for maximum
likelihood estimation (*.ml.m is a faster implementation of *.ml).
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_method">method</code></td>
<td>

<p>Defaults to &quot;Nelder-Mead&quot; algorithm, can also be &quot;SANN&quot; but this is a lot slower
and may not as good
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_diagnostics">diagnostics</code></td>
<td>

<p>Defaults to TRUE, which computes Kolmogorov-Smirnoff test, Kolmogorov-Smirnoff 
Resample test, Data drive smooth test and do QQ plot on non censored data.
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_range">range</code></td>
<td>

<p>The is the quantile range to plot the QQ plot, defaults to 0.01 and 0.99 to
avoid potential problems with extreme values of GLD which might be -Inf or Inf.
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_init">init</code></td>
<td>

<p>Choose a different set of initial values to start the optimisation process. This
can either be full set of parameters including GLD parameter estimates, or it
can just be the coefficient estimates of the regression model. 
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_alpha">alpha</code></td>
<td>

<p>Significant level of goodness of fit test.
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_censor.type">censor.type</code></td>
<td>

<p>Can be&quot; right&quot; of &quot;left censored.
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_adj.int">adj.int</code></td>
<td>

<p>Adjust intercept in final output?
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_gld.adj">GLD.adj</code></td>
<td>

<p>Adjust GLD fitted to have theoretical zero mean?
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_adj.censor">adj.censor</code></td>
<td>

<p>Adjust censoring?
</p>
</td></tr>
<tr><td><code id="GLD.lm.surv_+3A_keep.uncen">keep.uncen</code></td>
<td>

<p>Keep uncensored values?
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Message</code></td>
<td>
<p>Short description of estimation method used and whether the 
result converged</p>
</td></tr>
<tr><td><code>Bias Correction</code></td>
<td>
<p>Bias correction used to ensure the line has zero mean 
residuals</p>
</td></tr>
<tr><td><code>Estimated parameters</code></td>
<td>
<p>A set of estimate coefficients from GLD regression</p>
</td></tr>
<tr><td><code>Fitted</code></td>
<td>
<p>Predicted response value from model</p>
</td></tr>
<tr><td><code>Residual</code></td>
<td>
<p>Residual of model</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Formula used in the model</p>
</td></tr>
<tr><td><code>param</code></td>
<td>
<p>Specify whether RS/FKML/FMKL GLD was used</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The response variable</p>
</td></tr> 
<tr><td><code>x</code></td>
<td>
<p>The explanatory variable(s)</p>
</td></tr>
<tr><td><code>fun</code></td>
<td>
<p>GLD fitting function used in the computation process, outputted for 
internal programming use</p>
</td></tr> 
<tr><td><code>censoring</code></td>
<td>
<p>Censoring data</p>
</td></tr> 
<tr><td><code>AIC.full</code></td>
<td>
<p>AIC results</p>
</td></tr> 
<tr><td><code>BIC.full</code></td>
<td>
<p>BIC results</p>
</td></tr> 
<tr><td><code>censor.gld.values</code></td>
<td>
<p>Result of GLD fit, including censoring</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Steve Su
</p>


<h3>References</h3>

<p>Su (2021) &quot;Flexible Parametric Accelerated Failure Time Model&quot; Journal of 
Biopharmaceutical Statistics Volume 31, 2021 - Issue 5
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code>, <code><a href="#topic+GLD.quantreg">GLD.quantreg</a></code>, <code><a href="#topic+GLD.lm">GLD.lm</a></code>, 
<code><a href="#topic+GLD.lm.full.surv">GLD.lm.full.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# Note the actg.rs1 differs from GLD.lm.full.surv because adj.int is set as 
# TRUE in GLD.lm.surv by default but adj.int is set as FALSE in 
# GLD.lm.full.surv by default

actg.rs1&lt;-GLD.lm.surv(log(time)~factor(txgrp)+hemophil+cd4+priorzdv+age,
censoring=actg[which(actg$txgrp!=3 &amp; actg$txgrp!=4),]$censor, 
data=actg[which(actg$txgrp!=3 &amp; actg$txgrp!=4),],
param="rs",fun=fun.RPRS.ml.m)

actg.rs2&lt;-GLD.lm.surv(log(time)~factor(txgrp)+hemophil+cd4+priorzdv+age,
censoring=actg[which(actg$txgrp!=3 &amp; actg$txgrp!=4),]$censor, 
data=actg[which(actg$txgrp!=3 &amp; actg$txgrp!=4),],
param="rs",fun=fun.RPRS.ml.m,adj.int=FALSE)


## End(Not run)
</code></pre>

<hr>
<h2 id='GLD.quantreg'>
Fit a GLD quantile regression parametrically or non parametrically
</h2><span id='topic+GLD.quantreg'></span>

<h3>Description</h3>

<p>The GLD quantile regression can be: 1) Fixed intercept, allowing all other
coefficients to vary, 2) Only intercept is allowed to vary and 3) All 
coefficients can vary. Minimisation is achieved numerically through least
squares between the proportion of estimated GLD error distribution below zero 
versus the specified quantile for parametric approach. For non parametric 
approach, minimisation is achieved using a least squares approach to find a
q-th quantile GLD line such that the percentage of observations below
the line corresponds to the q-th quantile. </p>


<h3>Usage</h3>

<pre><code class='language-R'>GLD.quantreg(q, fit.obj, intercept = "", slope = "", emp=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GLD.quantreg_+3A_q">q</code></td>
<td>

<p>Specify the quantile (range 0 to 1) line
</p>
</td></tr>
<tr><td><code id="GLD.quantreg_+3A_fit.obj">fit.obj</code></td>
<td>

<p>An object from <code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code>
</p>
</td></tr>
<tr><td><code id="GLD.quantreg_+3A_intercept">intercept</code></td>
<td>

<p>Can either be &quot;fixed&quot; or left blank, blank indicates this parameter is
allowed to vary in quantile line estimation
</p>
</td></tr>
<tr><td><code id="GLD.quantreg_+3A_slope">slope</code></td>
<td>

<p>Can either be <code>"fixed"</code> or left blank, blank indicates this parameter is
allowed to vary in quantile line estimation
</p>
</td></tr>
<tr><td><code id="GLD.quantreg_+3A_emp">emp</code></td>
<td>

<p>Can either be <code>TRUE</code> (non parametric GLD quantile regression) or 
<code>FALSE</code> (parametric GLD quantile regression), defaults to <code>FALSE</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper function for <code><a href="#topic+fun.gld.all.vary">fun.gld.all.vary</a></code>,
<code><a href="#topic+fun.gld.slope.fixed.int.vary">fun.gld.slope.fixed.int.vary</a></code>, 
<code><a href="#topic+fun.gld.slope.vary.int.fixed">fun.gld.slope.vary.int.fixed</a></code>.
</p>


<h3>Value</h3>

<p>A matrix showing the estimated coefficients for the specified quantile
regression model, the objective function value and whether convergence is 
reached in the optimisation process. A value of 0 indicates convergence is 
reached. The convergence value is the same as the one from the <code><a href="stats.html#topic+optim">optim</a></code> 
function.
</p>


<h3>Author(s)</h3>

<p>Steve Su
</p>


<h3>References</h3>

<p>Su (2015) &quot;Flexible Parametric Quantile Regression Model&quot; Statistics &amp;
Computing  May 2015, Volume 25, Issue 3, pp 635-650
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code>,<code><a href="#topic+fun.plot.q">fun.plot.q</a></code>,  
<code><a href="#topic+summaryGraphics.gld.lm">summaryGraphics.gld.lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dummy example

## Create dataset

set.seed(10)

x&lt;-rnorm(200,3,2)
y&lt;-3*x+rnorm(200)

dat&lt;-data.frame(y,x)

## Fit FKML GLD regression with 3 simulations

fit&lt;-GLD.lm.full(y~x,data=dat,fun=fun.RMFMKL.ml.m,param="fkml",n.simu=3)

## Find median regression, use empirical method

med.fit&lt;-GLD.quantreg(0.5,fit,slope="fixed",emp=TRUE)

## Not run: 

## Extract the Engel dataset 

library(quantreg)
data(engel)

## Fit GLD Regression along with simulations

engel.fit.all&lt;-GLD.lm.full(foodexp~income,data=engel,
param="fmkl",fun=fun.RMFMKL.ml.m)

## Fit parametric GLD quantile regression from 0.1 to 0.9, with equal spacings 
## between quantiles

result&lt;-GLD.quantreg(seq(0.1,.9,length=9),engel.fit.all,intercept="fixed")

## Non parametric quantile regression

GLD.quantreg(seq(0.1,.9,length=9),engel.fit.all,intercept="fixed",emp=T)


## End(Not run)
</code></pre>

<hr>
<h2 id='qqgld.default'>
QQ plot for GLD
</h2><span id='topic+qqgld.default'></span>

<h3>Description</h3>

<p>This is an updated QQ plot function for GLD comparing fitted distribution
with empirical data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqgld.default(y, vals, param, ylim, main = "GLD Q-Q Plot", 
xlab = "Theoretical Quantiles", ylab = "Sample Quantiles", 
plot.it = TRUE, datax = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qqgld.default_+3A_y">y</code></td>
<td>

<p>A vector of empirical data observations
</p>
</td></tr>
<tr><td><code id="qqgld.default_+3A_vals">vals</code></td>
<td>

<p>A vector representing four parameters of GLD
</p>
</td></tr>
<tr><td><code id="qqgld.default_+3A_param">param</code></td>
<td>

<p>Can be &quot;rs&quot;, &quot;fmkl&quot; or &quot;fkml&quot;
</p>
</td></tr>
<tr><td><code id="qqgld.default_+3A_ylim">ylim</code></td>
<td>

<p>A vector of two numerical values, specifying the upper and lower bound
of y axis
</p>
</td></tr>
<tr><td><code id="qqgld.default_+3A_main">main</code></td>
<td>

<p>Title of the qq plot
</p>
</td></tr>
<tr><td><code id="qqgld.default_+3A_xlab">xlab</code></td>
<td>

<p>Label for X axis
</p>
</td></tr>
<tr><td><code id="qqgld.default_+3A_ylab">ylab</code></td>
<td>

<p>Label for Y axis
</p>
</td></tr>
<tr><td><code id="qqgld.default_+3A_plot.it">plot.it</code></td>
<td>

<p>Whether to plot the QQ plot, default is TRUE
</p>
</td></tr>
<tr><td><code id="qqgld.default_+3A_datax">datax</code></td>
<td>

<p>Whether data values should be on x axis, default is FALSE
</p>
</td></tr>
<tr><td><code id="qqgld.default_+3A_...">...</code></td>
<td>

<p>Additional graphical parameters  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an adaptation of the default qq plot in R
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
	
<p>The x coordinates of the points that were/would be plotted  </p>
</td></tr>
<tr><td><code>y</code></td>
<td>
	
<p>The original y vector, i.e., the corresponding y coordinates including NAs.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>R, with modifications from Steve Su
</p>


<h3>See Also</h3>

<p><code><a href="GLDEX.html#topic+qqplot.gld">qqplot.gld</a></code>, <code><a href="GLDEX.html#topic+qqplot.gld.bi">qqplot.gld.bi</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-rnorm(100)
fit1&lt;-fun.RMFMKL.ml.m(x)
qqgld.default(x,fit1,param="fmkl")
</code></pre>

<hr>
<h2 id='summaryGraphics.gld.lm'>
Graphical display of output from <code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code>
</h2><span id='topic+summaryGraphics.gld.lm'></span>

<h3>Description</h3>

<p>This function display the coefficients and the distribution of coefficients 
obtained from GLD regression model. For a discussion on goodness of fit,
please see the description under <code><a href="#topic+GLD.lm">GLD.lm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryGraphics.gld.lm(overall.fit.obj, alpha = 0.05, label = NULL, 
ColourVersion = TRUE, diagnostics = TRUE, range = c(0.01, 0.99))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summaryGraphics.gld.lm_+3A_overall.fit.obj">overall.fit.obj</code></td>
<td>

<p>An object from <code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code>
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.lm_+3A_alpha">alpha</code></td>
<td>

<p>Specifying the range of interval for the coefficients, default is 0.05, which
specifies a 95% interval. This also specifies the significance level of KS resample test. 
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.lm_+3A_label">label</code></td>
<td>

<p>A character vector indicating the labelling for the coefficients
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.lm_+3A_colourversion">ColourVersion</code></td>
<td>

<p>Whether to display colour or not, default is TRUE, if set as FALSE, a black
and white plot is given. This is only applicable to the coefficient summary
graph and has no effect on QQ plots.
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.lm_+3A_diagnostics">diagnostics</code></td>
<td>

<p>If TRUE, then QQ plot will be given along with various goodness of fit test results
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.lm_+3A_range">range</code></td>
<td>

<p>The is the quantile range to plot the QQ plot, defaults to 0.01 and 0.99 to
avoid potential problems with extreme values of GLD which might be -Inf or Inf.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The reason QQ plots are not displayed in black and white even if 
ColourVersion is set to FALSE is because the colour is necessary in those plots
for clarity of display. 
</p>


<h3>Value</h3>

<p>Graphics displaying coefficient summary and diagnostic plot (if chosen)
</p>


<h3>Author(s)</h3>

<p>Steve Su
</p>


<h3>References</h3>

<p>Su (2015) &quot;Flexible Parametric Quantile Regression Model&quot; Statistics &amp;
Computing  May 2015, Volume 25, Issue 3, pp 635-650
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GLD.lm.full">GLD.lm.full</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dummy example

## Create dataset

set.seed(10)

x&lt;-rnorm(200,3,2)
y&lt;-3*x+rnorm(200)

dat&lt;-data.frame(y,x)

## Fit FKML GLD regression with 3 simulations

fit&lt;-GLD.lm.full(y~x,data=dat,fun=fun.RMFMKL.ml.m,param="fkml",n.simu=3)

## Note this is for illustration only, need to set number
## of simulations around 1000 usually for the graphics below 
## to be meaningful

summaryGraphics.gld.lm(fit,ColourVersion=FALSE,diagnostic=FALSE)

## Not run: 
## Extract the Engel dataset 

library(quantreg)
data(engel)

## Fit a full GLD regression

engel.fit.full&lt;-GLD.lm.full(foodexp~income,data=engel,param="fmkl",
fun=fun.RMFMKL.ml.m)

## Plot coefficient summary

summaryGraphics.gld.lm(engel.fit.full,ColourVersion=FALSE,diagnostic=FALSE)

summaryGraphics.gld.lm(engel.fit.full)

## Extract the mammals dataset 
library(MASS)

## Fit a full GLD regression

mammals.fit.full&lt;-GLD.lm.full(log(brain)~log(body),data=mammals,param="fmkl",
fun=fun.RMFMKL.ml.m)

## Plot coefficient summary

summaryGraphics.gld.lm(mammals.fit.full,label=c("intercept","log of body weight"))


## End(Not run)
</code></pre>

<hr>
<h2 id='summaryGraphics.gld.surv.lm'>
Graphical display of output from <code><a href="#topic+GLD.lm.full.surv">GLD.lm.full.surv</a></code>
</h2><span id='topic+summaryGraphics.gld.surv.lm'></span>

<h3>Description</h3>

<p>This function display the coefficients and the distribution of coefficients 
obtained from GLD Accelerated Failure Time regression model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryGraphics.gld.surv.lm(overall.fit.obj, alpha = 0.05, label = NULL, 
                            ColourVersion = TRUE, diagnostics = TRUE, 
                            range = c(0.01, 0.99), exp = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summaryGraphics.gld.surv.lm_+3A_overall.fit.obj">overall.fit.obj</code></td>
<td>

<p>An object from <code><a href="#topic+GLD.lm.full.surv">GLD.lm.full.surv</a></code>
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.surv.lm_+3A_alpha">alpha</code></td>
<td>

<p>Specifying the range of interval for the coefficients, default is 0.05, which
specifies a 95% interval. This also specifies the significance level of KS 
test.
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.surv.lm_+3A_label">label</code></td>
<td>

<p>A character vector indicating the labelling for the coefficients
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.surv.lm_+3A_colourversion">ColourVersion</code></td>
<td>

<p>Whether to display colour or not, default is TRUE, if set as FALSE, a black
and white plot is given. This is only applicable to the coefficient summary
graph and has no effect on QQ plots.
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.surv.lm_+3A_diagnostics">diagnostics</code></td>
<td>

<p>If TRUE, then QQ plot will be given along with various goodness of fit test 
results</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.surv.lm_+3A_range">range</code></td>
<td>

<p>The is the quantile range to plot the QQ plot, defaults to 0.01 and 0.99 to
avoid potential problems with extreme values of GLD which might be -Inf or Inf.
</p>
</td></tr>
<tr><td><code id="summaryGraphics.gld.surv.lm_+3A_exp">exp</code></td>
<td>

<p>If TRUE, Exponentiate the coefficients
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The reason QQ plots are not displayed in black and white even if 
ColourVersion is set to FALSE is because the colour is necessary in those plots
for clarity of display. 
</p>


<h3>Value</h3>

<p>Graphics displaying coefficient summary and diagnostic plot (if chosen)
</p>


<h3>Author(s)</h3>

<p>Steve Su
</p>


<h3>References</h3>

<p>Su (2021) &quot;Flexible Parametric Accelerated Failure Time Model&quot; Journal of 
Biopharmaceutical Statistics Volume 31, 2021 - Issue 5
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GLD.lm.full.surv">GLD.lm.full.surv</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

library(mlr3proba)

actg320.rs&lt;-GLD.lm.full.surv(log(time)~factor(txgrp)+hemophil+cd4+priorzdv+age,
censoring=actg320[which(actg320$txgrp!=3 &amp; actg320$txgrp!=4),]$censor, 
data=actg320[which(actg320$txgrp!=3 &amp; actg320$txgrp!=4),],
param="rs",fun=fun.RPRS.ml.m,summary.plot=F,n.simu=1000)

summaryGraphics.gld.surv.lm(actg320.rs,label=c("(Intercept)",
"IDV versus no IDV","Hemophiliac","Baseline CD4",
"Months of prior \n ZDV use","Age"),exp="TRUE")


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
