<!DOCTYPE html><html lang="en-US"><head><title>Help for package multpois</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multpois}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Anova.mp'><p>ANOVA-style results for a multinomial-Poisson model</p></a></li>
<li><a href='#bs2'><p>Between-subjects 2×2 design with dichotomous response data</p></a></li>
<li><a href='#bs3'><p>Between-subjects 2×2 design with polytomous response data</p></a></li>
<li><a href='#glm.mp'><p>Multinomial-Poisson GLM for nominal response data</p></a></li>
<li><a href='#glm.mp.con'><p>Contrast tests for multinomial-Poisson GLM</p></a></li>
<li><a href='#glmer.mp'><p>Multinomial-Poisson GLMM for nominal response data</p></a></li>
<li><a href='#glmer.mp.con'><p>Contrast tests for multinomial-Poisson GLMM</p></a></li>
<li><a href='#icecream'><p>Mixed factorial 2×2 design with polytomous response data</p></a></li>
<li><a href='#ws2'><p>Within-subjects 2×2 design with dichotomous response data</p></a></li>
<li><a href='#ws3'><p>Within-subjects 2×2 design with polytomous response data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Analyze Nominal Response Data with the Multinomial-Poisson Trick</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jacob O. Wobbrock &lt;wobbrock@uw.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Dichotomous responses having two categories can be analyzed
    with stats::glm() or lme4::glmer() using the family=binomial option.
    Unfortunately, polytomous responses with three or more unordered
    categories cannot be analyzed similarly because there is no analogous
    family=multinomial option. For between-subjects data,
    nnet::multinom() can address this need, but it cannot handle random
    factors and therefore cannot handle repeated measures. To address this
    gap, we transform nominal response data into counts for each categorical 
    alternative. These counts are then analyzed using (mixed) Poisson regression
    as per Baker (1994) &lt;<a href="https://doi.org/10.2307%2F2348134">doi:10.2307/2348134</a>&gt;. Omnibus analyses of variance can be 
    run along with post hoc pairwise comparisons. For users wishing to analyze nominal 
    responses from surveys or experiments, the functions in this package essentially 
    act as though stats::glm() or lme4::glmer() provide a family=multinomial option.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/wobbrock/multpois/">https://github.com/wobbrock/multpois/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/wobbrock/multpois/issues">https://github.com/wobbrock/multpois/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>car (&ge; 3.1.2), dfidx (&ge; 0.0.5), dplyr (&ge; 1.1.4), lme4 (&ge;
1.1.35.5), plyr (&ge; 1.8.9)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>emmeans (&ge; 1.10.3), knitr (&ge; 1.48), lmerTest (&ge; 3.1.3),
nnet (&ge; 7.3.19), rmarkdown, spelling, testthat (&ge; 3.2.1.1)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-09 20:39:50 UTC; wobbrock</td>
</tr>
<tr>
<td>Author:</td>
<td>Jacob O. Wobbrock <a href="https://orcid.org/0000-0003-3675-5491"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-09 21:00:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='Anova.mp'>ANOVA-style results for a multinomial-Poisson model</h2><span id='topic+Anova.mp'></span>

<h3>Description</h3>

<p>Get ANOVA-style results for a model returned by <code><a href="#topic+glm.mp">glm.mp</a></code> or <code><a href="#topic+glmer.mp">glmer.mp</a></code>.
The output table contains chi-square results for the main effects and interactions indicated by
the given model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Anova.mp(model, type = c(3, 2, 1, "III", "II", "I"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Anova.mp_+3A_model">model</code></td>
<td>
<p>A model built by <code><a href="#topic+glm.mp">glm.mp</a></code> or <code><a href="#topic+glmer.mp">glmer.mp</a></code>. (The underlying model
will have been built by <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="lme4.html#topic+glmer">glmer</a></code>, with
<code>family=poisson</code>.)</p>
</td></tr>
<tr><td><code id="Anova.mp_+3A_type">type</code></td>
<td>
<p>In the case of a Type II or Type III ANOVA, this value will be the <code>type</code> parameter
passed to <code><a href="car.html#topic+Anova">Anova</a></code>. In the case of a Type I ANOVA, for models built with
<code><a href="#topic+glm.mp">glm.mp</a></code>, the <code><a href="stats.html#topic+anova.glm">anova.glm</a></code> function will be called; for models built with
<code><a href="#topic+glmer.mp">glmer.mp</a></code>, the <code><a href="lme4.html#topic+anova.merMod">anova.merMod</a></code> function will be called.
The default is 3. See the details for <code><a href="car.html#topic+Anova">Anova</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For Type II or III ANOVAs, the <code>Anova.mp</code> function uses <code><a href="car.html#topic+Anova">Anova</a></code> behind the scenes to
produce an ANOVA-style table with chi-square results. For Type I ANOVAs, it uses
<code><a href="stats.html#topic+anova.glm">anova.glm</a></code> or <code><a href="lme4.html#topic+anova.merMod">anova.merMod</a></code>, depending on the model.
</p>
<p>Users wishing to verify the correctness of these results can compare <code><a href="car.html#topic+Anova">Anova</a></code> results
for dichotomous response models built with <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="lme4.html#topic+glmer">glmer</a></code> (using
<code>family=binomial</code>) to <code>Anova.mp</code> results for models built with <code><a href="#topic+glm.mp">glm.mp</a></code> or
<code><a href="#topic+glmer.mp">glmer.mp</a></code>, respectively. The results should be similar.
</p>
<p>Users can also compare <code><a href="car.html#topic+Anova">Anova</a></code> results for polytomous response models built with
<code><a href="nnet.html#topic+multinom">multinom</a></code> to <code>Anova.mp</code> results for models built with <code><a href="#topic+glm.mp">glm.mp</a></code>.
Again, the results should be similar.
</p>
<p>To date, there is no similarly easy comparison for polytomous response models with repeated measures.
This lack of options was a key motivation for developing <code><a href="#topic+glmer.mp">glmer.mp</a></code> in the first place.
</p>


<h3>Value</h3>

<p>An ANOVA-style table of chi-square results for models built by <code><a href="#topic+glm.mp">glm.mp</a></code> or
<code><a href="#topic+glmer.mp">glmer.mp</a></code>. See the return values for <code><a href="car.html#topic+Anova">Anova</a></code>, <code><a href="stats.html#topic+anova.glm">anova.glm</a></code>,
or <code><a href="lme4.html#topic+anova.merMod">anova.merMod</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jacob O. Wobbrock
</p>


<h3>References</h3>

<p>Baker, S.G. (1994). The multinomial-Poisson transformation.
<em>The Statistician 43</em> (4), pp. 495-504. <a href="https://doi.org/10.2307/2348134">doi:10.2307/2348134</a>
</p>
<p>Chen, Z. and Kuo, L. (2001). A note on the estimation of the
multinomial logit model with random effects. <em>The American Statistician
55</em> (2), pp. 89-95. <a href="https://www.jstor.org/stable/2685993">https://www.jstor.org/stable/2685993</a>
</p>
<p>Guimaraes, P. (2004). Understanding the multinomial-Poisson
transformation. <em>The Stata Journal 4</em> (3), pp. 265-273.
<a href="https://www.stata-journal.com/article.html?article=st0069">https://www.stata-journal.com/article.html?article=st0069</a>
</p>
<p>Lee, J.Y.L., Green, P.J.,and Ryan, L.M. (2017). On the “Poisson
trick” and its extensions for fitting multinomial regression models. <em>arXiv
preprint</em> available at <a href="https://doi.org/10.48550/arXiv.1707.08538">doi:10.48550/arXiv.1707.08538</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glm.mp">glm.mp()</a></code>, <code><a href="#topic+glm.mp.con">glm.mp.con()</a></code>, <code><a href="#topic+glmer.mp">glmer.mp()</a></code>, <code><a href="#topic+glmer.mp.con">glmer.mp.con()</a></code>, <code><a href="car.html#topic+Anova">car::Anova()</a></code>, <code><a href="stats.html#topic+anova.glm">stats::anova.glm()</a></code>, <code><a href="lme4.html#topic+merMod-class">lme4::anova.merMod()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(multpois)

## two between-subjects factors (X1,X2) with polytomous response (Y)
data(bs3, package="multpois")

bs3$PId = factor(bs3$PId)
bs3$Y = factor(bs3$Y)
bs3$X1 = factor(bs3$X1)
bs3$X2 = factor(bs3$X2)
contrasts(bs3$X1) &lt;- "contr.sum"
contrasts(bs3$X2) &lt;- "contr.sum"

m1 = glm.mp(Y ~ X1*X2, data=bs3)
Anova.mp(m1, type=3)

## two within-subjects factors (X1,X2) with polytomous response (Y)
data(ws3, package="multpois")

ws3$PId = factor(ws3$PId)
ws3$Y = factor(ws3$Y)
ws3$X1 = factor(ws3$X1)
ws3$X2 = factor(ws3$X2)
contrasts(ws3$X1) &lt;- "contr.sum"
contrasts(ws3$X2) &lt;- "contr.sum"

m2 = glmer.mp(Y ~ X1*X2 + (1|PId), data=ws3)
Anova.mp(m2, type=3)

</code></pre>

<hr>
<h2 id='bs2'>Between-subjects 2×2 design with dichotomous response data</h2><span id='topic+bs2'></span>

<h3>Description</h3>

<p>This generic synthetic long-format data set has a dichotomous response <code>Y</code>
and two factors <code>X1</code> and <code>X2</code>. The response has categories
<code>{yes, no}</code>. Factor <code>X1</code> has levels <code>{a, b}</code>, and factor
<code>X2</code> has levels <code>{c, d}</code>. It also has a <code>PId</code> column for a participant
identifier. Each participant appears on only one row.
</p>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 4 variables:
</p>

<dl>
<dt>PId</dt><dd><p>a participant identifier with levels <code>"1"</code> ... <code>"60"</code></p>
</dd>
<dt>X1</dt><dd><p>a between-subjects factor with levels <code>"a"</code>, <code>"b"</code></p>
</dd>
<dt>X2</dt><dd><p>a between-subjects factor with levels <code>"c"</code>, <code>"d"</code></p>
</dd>
<dt>Y</dt><dd><p>a dichotomous response with categories <code>"yes"</code>, <code>"no"</code></p>
</dd>
</dl>



<h3>See Also</h3>

<p>See <code><a href="#topic+glm.mp">glm.mp</a></code> and <code><a href="#topic+glm.mp.con">glm.mp.con</a></code> for complete examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(multpois)
data(bs2, package="multpois")

bs2$PId = factor(bs2$PId)
bs2$Y = factor(bs2$Y, levels=c("yes","no"))
bs2$X1 = factor(bs2$X1)
bs2$X2 = factor(bs2$X2)
contrasts(bs2$X1) &lt;- "contr.sum"
contrasts(bs2$X2) &lt;- "contr.sum"

m = glm.mp(Y ~ X1*X2, data=bs2)
Anova.mp(m, type=3)
glm.mp.con(m, pairwise ~ X1*X2, adjust="holm")

</code></pre>

<hr>
<h2 id='bs3'>Between-subjects 2×2 design with polytomous response data</h2><span id='topic+bs3'></span>

<h3>Description</h3>

<p>This generic synthetic long-format data set has a polytomous response <code>Y</code>
and two factors <code>X1</code> and <code>X2</code>. The response has categories
<code>{yes, no, maybe}</code>. Factor <code>X1</code> has levels <code>{a, b}</code>, and factor
<code>X2</code> has levels <code>{c, d}</code>. It also has a <code>PId</code> column for a participant
identifier. Each participant appears on only one row.
</p>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 4 variables:
</p>

<dl>
<dt>PId</dt><dd><p>a participant identifier with levels <code>"1"</code> ... <code>"60"</code></p>
</dd>
<dt>X1</dt><dd><p>a between-subjects factor with levels <code>"a"</code>, <code>"b"</code></p>
</dd>
<dt>X2</dt><dd><p>a between-subjects factor with levels <code>"c"</code>, <code>"d"</code></p>
</dd>
<dt>Y</dt><dd><p>a polytomous response with categories <code>"yes"</code>, <code>"no"</code>, <code>"maybe"</code></p>
</dd>
</dl>



<h3>See Also</h3>

<p>See <code><a href="#topic+glm.mp">glm.mp</a></code> and <code><a href="#topic+glm.mp.con">glm.mp.con</a></code> for complete examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(multpois)
data(bs3, package="multpois")

bs3$PId = factor(bs3$PId)
bs3$Y = factor(bs3$Y, levels=c("yes","no","maybe"))
bs3$X1 = factor(bs3$X1)
bs3$X2 = factor(bs3$X2)
contrasts(bs3$X1) &lt;- "contr.sum"
contrasts(bs3$X2) &lt;- "contr.sum"

m = glm.mp(Y ~ X1*X2, data=bs3)
Anova.mp(m, type=3)
glm.mp.con(m, pairwise ~ X1*X2, adjust="holm")

</code></pre>

<hr>
<h2 id='glm.mp'>Multinomial-Poisson GLM for nominal response data</h2><span id='topic+glm.mp'></span>

<h3>Description</h3>

<p>This function uses the multinomial-Poisson trick to analyze <strong>nominal response</strong> data using a Poisson
generalized linear model (GLM). The nominal response should be a factor with two or more unordered
categories. The independent variables should be between-subjects factors and/or numeric predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm.mp(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glm.mp_+3A_formula">formula</code></td>
<td>
<p>A formula object in the style of, e.g., <code>Y ~ X1*X2</code>, where <code>X1</code> and <code>X2</code>
are factors or predictors. The response <code>Y</code> must be of type <code>factor</code>. See the <code>formula</code>
entry for <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="glm.mp_+3A_data">data</code></td>
<td>
<p>A data frame in long-format. See the <code>data</code> entry for <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="glm.mp_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="stats.html#topic+glm">glm</a></code>. Generally, these are
unnecessary but are provided for advanced users. They must not pass <code>formula</code>, <code>data</code>,
or <code>family</code> arguments. See <code><a href="stats.html#topic+glm">glm</a></code> for valid arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should be used for nominal response data with only between-subjects factors or predictors.
In essence, it provides for the equivalent of <code><a href="stats.html#topic+glm">glm</a></code> with <code>family=multinomial</code>,
were that option to exist. (That option does not exist, but <code><a href="nnet.html#topic+multinom">multinom</a></code> serves the same
purpose.)
</p>
<p>For data with repeated measures, use <code><a href="#topic+glmer.mp">glmer.mp</a></code>, which can take random factors and thus handle
correlated responses.
</p>
<p>Users wishing to verify the correctness of <code>glm.mp</code> should compare <code><a href="#topic+Anova.mp">Anova.mp</a></code> results
to <code><a href="car.html#topic+Anova">Anova</a></code> results for models built with <code><a href="stats.html#topic+glm">glm</a></code> using
<code>family=binomial</code> (for dichotomous responses) or <code><a href="nnet.html#topic+multinom">multinom</a></code> (for polytomous
responses). The results should be similar if not identical.
</p>
<p><em>Post hoc</em> pairwise comparisons for factors can be conducted with <code><a href="#topic+glm.mp.con">glm.mp.con</a></code>.
</p>


<h3>Value</h3>

<p>A Poisson regression model of type <code><a href="stats.html#topic+glm">glm</a></code>. See the return value for
<code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jacob O. Wobbrock
</p>


<h3>References</h3>

<p>Baker, S.G. (1994). The multinomial-Poisson transformation.
<em>The Statistician 43</em> (4), pp. 495-504. <a href="https://doi.org/10.2307/2348134">doi:10.2307/2348134</a>
</p>
<p>Guimaraes, P. (2004). Understanding the multinomial-Poisson
transformation. <em>The Stata Journal 4</em> (3), pp. 265-273.
<a href="https://www.stata-journal.com/article.html?article=st0069">https://www.stata-journal.com/article.html?article=st0069</a>
</p>
<p>Lee, J.Y.L., Green, P.J.,and Ryan, L.M. (2017). On the “Poisson
trick” and its extensions for fitting multinomial regression models. <em>arXiv
preprint</em> available at <a href="https://doi.org/10.48550/arXiv.1707.08538">doi:10.48550/arXiv.1707.08538</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Anova.mp">Anova.mp()</a></code>, <code><a href="#topic+glm.mp.con">glm.mp.con()</a></code>, <code><a href="#topic+glmer.mp">glmer.mp()</a></code>, <code><a href="#topic+glmer.mp.con">glmer.mp.con()</a></code>, <code><a href="stats.html#topic+glm">stats::glm()</a></code>, <code><a href="stats.html#topic+glm.control">stats::glm.control()</a></code>, <code><a href="nnet.html#topic+multinom">nnet::multinom()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(multpois)
library(car)
library(nnet)

## two between-subjects factors (X1,X2) with dichotomous response (Y)
data(bs2, package="multpois")

bs2$PId = factor(bs2$PId)
bs2$Y = factor(bs2$Y)
bs2$X1 = factor(bs2$X1)
bs2$X2 = factor(bs2$X2)
contrasts(bs2$X1) &lt;- "contr.sum"
contrasts(bs2$X2) &lt;- "contr.sum"

m1 = glm(Y ~ X1*X2, data=bs2, family=binomial)
Anova(m1, type=3)

m2 = glm.mp(Y ~ X1*X2, data=bs2) # compare
Anova.mp(m2, type=3)

## two between-subjects factors (X1,X2) with polytomous response (Y)
data(bs3, package="multpois")

bs3$PId = factor(bs3$PId)
bs3$Y = factor(bs3$Y)
bs3$X1 = factor(bs3$X1)
bs3$X2 = factor(bs3$X2)
contrasts(bs3$X1) &lt;- "contr.sum"
contrasts(bs3$X2) &lt;- "contr.sum"

m3 = multinom(Y ~ X1*X2, data=bs3, trace=FALSE)
Anova(m3, type=3)

m4 = glm.mp(Y ~ X1*X2, data=bs3) # compare
Anova.mp(m4, type=3)

</code></pre>

<hr>
<h2 id='glm.mp.con'>Contrast tests for multinomial-Poisson GLM</h2><span id='topic+glm.mp.con'></span>

<h3>Description</h3>

<p>This function conducts <em>post hoc</em> pairwise comparisons on generalized linear models (GLMs) built
with <code><a href="#topic+glm.mp">glm.mp</a></code>. Such models have <strong>nominal response</strong> types, i.e., <code>factor</code>s with
unordered categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm.mp.con(
  model,
  formula,
  adjust = c("holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glm.mp.con_+3A_model">model</code></td>
<td>
<p>A multinomial-Poisson generalized linear model created by <code><a href="#topic+glm.mp">glm.mp</a></code>.</p>
</td></tr>
<tr><td><code id="glm.mp.con_+3A_formula">formula</code></td>
<td>
<p>A formula object in the style of, e.g., <code>pairwise ~ X1*X2</code>, where <code>X1</code> and
<code>X2</code> are factors in <code>model</code>. The <code>pairwise</code> keyword <em>must</em> be used on the left-hand
side of the formula. See the <code>specs</code> entry for <code><a href="emmeans.html#topic+emmeans">emmeans</a></code>.</p>
</td></tr>
<tr><td><code id="glm.mp.con_+3A_adjust">adjust</code></td>
<td>
<p>A string indicating the <em>p</em>-value adjustment to use. Defaults to <code>"holm"</code>. See the
details for <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="glm.mp.con_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="stats.html#topic+glm">glm</a></code>. Generally, these are
unnecessary but are provided for advanced users. They must not pass <code>formula</code>, <code>data</code>,
or <code>family</code> arguments. See <code><a href="stats.html#topic+glm">glm</a></code> for valid arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Post hoc</em> pairwise comparisons should be conducted <em>only</em> after a statistically significant
omnibus test using <code><a href="#topic+Anova.mp">Anova.mp</a></code>. Comparisons are conducted in the style of
<code><a href="emmeans.html#topic+emmeans">emmeans</a></code> but not using this function; rather, the multinomial-Poisson trick is used
on the subset of the data relevant to each pairwise comparison.
</p>
<p>Users wishing to verify the correctness of <code>glm.mp.con</code> should compare its results to
<code><a href="emmeans.html#topic+emmeans">emmeans</a></code> results for models built with <code><a href="stats.html#topic+glm">glm</a></code> using
<code>family=binomial</code> for dichotomous responses. Factor contrasts should be set to sum-to-zero
contrasts (i.e., <code>"contr.sum"</code>). The results should be similar.
</p>


<h3>Value</h3>

<p>Pairwise comparisons for all levels indicated by the factors in <code>formula</code>.
</p>


<h3>Author(s)</h3>

<p>Jacob O. Wobbrock
</p>


<h3>References</h3>

<p>Baker, S.G. (1994). The multinomial-Poisson transformation.
<em>The Statistician 43</em> (4), pp. 495-504. <a href="https://doi.org/10.2307/2348134">doi:10.2307/2348134</a>
</p>
<p>Guimaraes, P. (2004). Understanding the multinomial-Poisson
transformation. <em>The Stata Journal 4</em> (3), pp. 265-273.
<a href="https://www.stata-journal.com/article.html?article=st0069">https://www.stata-journal.com/article.html?article=st0069</a>
</p>
<p>Lee, J.Y.L., Green, P.J.,and Ryan, L.M. (2017). On the “Poisson
trick” and its extensions for fitting multinomial regression models. <em>arXiv
preprint</em> available at <a href="https://doi.org/10.48550/arXiv.1707.08538">doi:10.48550/arXiv.1707.08538</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Anova.mp">Anova.mp()</a></code>, <code><a href="#topic+glm.mp">glm.mp()</a></code>, <code><a href="#topic+glmer.mp">glmer.mp()</a></code>, <code><a href="#topic+glmer.mp.con">glmer.mp.con()</a></code>, <code><a href="stats.html#topic+glm">stats::glm()</a></code>, <code><a href="stats.html#topic+glm.control">stats::glm.control()</a></code>, <code><a href="emmeans.html#topic+emmeans">emmeans::emmeans()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(multpois)
library(car)
library(nnet)
library(emmeans)

## two between-subjects factors (X1,X2) with dichotomous response (Y)
data(bs2, package="multpois")

bs2$PId = factor(bs2$PId)
bs2$Y = factor(bs2$Y)
bs2$X1 = factor(bs2$X1)
bs2$X2 = factor(bs2$X2)
contrasts(bs2$X1) &lt;- "contr.sum"
contrasts(bs2$X2) &lt;- "contr.sum"

m1 = glm(Y ~ X1*X2, data=bs2, family=binomial)
Anova(m1, type=3)
emmeans(m1, pairwise ~ X1*X2, adjust="holm")

m2 = glm.mp(Y ~ X1*X2, data=bs2)
Anova.mp(m2, type=3)
glm.mp.con(m2, pairwise ~ X1*X2, adjust="holm") # compare

## two between-subjects factors (X1,X2) with polytomous response (Y)
data(bs3, package="multpois")

bs3$PId = factor(bs3$PId)
bs3$Y = factor(bs3$Y)
bs3$X1 = factor(bs3$X1)
bs3$X2 = factor(bs3$X2)
contrasts(bs3$X1) &lt;- "contr.sum"
contrasts(bs3$X2) &lt;- "contr.sum"

m3 = multinom(Y ~ X1*X2, data=bs3, trace=FALSE)
Anova(m3, type=3)
emmeans::test(
  contrast(emmeans(m3, ~ X1*X2 | Y, mode="latent"), method="pairwise", ref=1),
  joint=TRUE, by="contrast"
)

m4 = glm.mp(Y ~ X1*X2, data=bs3)
Anova.mp(m4, type=3)
glm.mp.con(m4, pairwise ~ X1*X2, adjust="holm") # compare

</code></pre>

<hr>
<h2 id='glmer.mp'>Multinomial-Poisson GLMM for nominal response data</h2><span id='topic+glmer.mp'></span>

<h3>Description</h3>

<p>This function uses the multinomial-Poisson trick to analyze <strong>nominal response</strong> data using a Poisson
generalized linear mixed model (GLMM). The nominal response should be a factor with two or more unordered
categories. The independent variables should have at least one within-subjects factor or numeric predictor.
There also must be a repeated subject identifier to be used as a random factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmer.mp(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glmer.mp_+3A_formula">formula</code></td>
<td>
<p>A formula object in the style of, e.g., <code>Y ~ X1*X2 + (1|PId)</code>, where <code>X1</code> and
<code>X2</code> are factors or predictors and <code>PId</code> is a factor serving as a subject identifier. The
response <code>Y</code> must be of type <code>factor</code>. See the <code>formula</code> entry for <code><a href="lme4.html#topic+glmer">glmer</a></code>.</p>
</td></tr>
<tr><td><code id="glmer.mp_+3A_data">data</code></td>
<td>
<p>A data frame in long-format. See the <code>data</code> entry for <code><a href="lme4.html#topic+glmer">glmer</a></code>.</p>
</td></tr>
<tr><td><code id="glmer.mp_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="lme4.html#topic+glmer">glmer</a></code>. Most often, these additional
arguments are used to specify alternate optimizers. (See <strong>Note</strong>, below.) These additional arguments
must not pass <code>formula</code>, <code>data</code>, or <code>family</code> arguments. See <code><a href="lme4.html#topic+glmer">glmer</a></code> for
valid arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should be used for nominal response data with repeated measures. In essence, it provides
for the equivalent of <code><a href="lme4.html#topic+glmer">glmer</a></code> with <code>family=multinomial</code>, were that option to
exist. (That option does not exist, which was a key motivation for developing this function.)
</p>
<p>For polytomous response data with only between-subjects factors, use <code><a href="#topic+glm.mp">glm.mp</a></code> or
<code><a href="nnet.html#topic+multinom">multinom</a></code>.
</p>
<p>Users wishing to verify the correctness of <code>glmer.mp</code> should compare its <code><a href="#topic+Anova.mp">Anova.mp</a></code>
results to <code><a href="car.html#topic+Anova">Anova</a></code> results for models built with <code><a href="lme4.html#topic+glmer">glmer</a></code> using
<code>family=binomial</code> for dichotomous responses. The results should be similar.
</p>
<p><em>Post hoc</em> pairwise comparisons for factors can be conducted with <code><a href="#topic+glmer.mp.con">glmer.mp.con</a></code>.
</p>


<h3>Value</h3>

<p>A mixed-effects Poisson regression model of type <code><a href="lme4.html#topic+merMod">merMod</a></code>, specifically
of <em>subclass</em> <code>glmerMod</code>. See the return value for <code><a href="lme4.html#topic+glmer">glmer</a></code>.
</p>


<h3>Note</h3>

<p>It is not uncommon to receive a <code>boundary (singular) fit</code> message. This message can often be
ignored provided the test output looks sensible.
</p>
<p>Sometimes, <code>glmer.mp</code> can fail to converge. Convergence issues
can often be remedied by changing the optimizer or its control parameters. For example, the following code
uses the <code>bobyqa</code> optimizer and increases the maximum number of function evaluations to 100,000:
</p>
<p><code>m = glmer.mp(Y ~ X + (1|PId), data=df, control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=1e+05)))</code>
</p>
<p>Other available <code>optimizer</code> strings besides <code>"bobyqa"</code> include <code>"nloptwrap"</code>, <code>"nlminbwrap"</code>,
and <code>"Nelder_Mead"</code>. Additional optimizers are available via the <code><a href="optimx.html#topic+optimx">optimx</a></code> library
by passing <code>"optimx"</code> to <code>optimizer</code> and <code>method="name"</code> in the <code>optCtrl</code> parameter list.
Eligible <em>name</em>s include <code>"nlm"</code>, <code>"BFGS"</code>, and <code>"L-BFGS-B"</code>, among others. See the
<code>optimizer</code> argument in <code><a href="lme4.html#topic+glmerControl">glmerControl</a></code> and the details for <code><a href="optimx.html#topic+optimx">optimx</a></code>
for more information.
</p>


<h3>Author(s)</h3>

<p>Jacob O. Wobbrock
</p>


<h3>References</h3>

<p>Baker, S.G. (1994). The multinomial-Poisson transformation.
<em>The Statistician 43</em> (4), pp. 495-504. <a href="https://doi.org/10.2307/2348134">doi:10.2307/2348134</a>
</p>
<p>Chen, Z. and Kuo, L. (2001). A note on the estimation of the
multinomial logit model with random effects. <em>The American Statistician
55</em> (2), pp. 89-95. <a href="https://www.jstor.org/stable/2685993">https://www.jstor.org/stable/2685993</a>
</p>
<p>Guimaraes, P. (2004). Understanding the multinomial-Poisson
transformation. <em>The Stata Journal 4</em> (3), pp. 265-273.
<a href="https://www.stata-journal.com/article.html?article=st0069">https://www.stata-journal.com/article.html?article=st0069</a>
</p>
<p>Lee, J.Y.L., Green, P.J.,and Ryan, L.M. (2017). On the “Poisson
trick” and its extensions for fitting multinomial regression models. <em>arXiv
preprint</em> available at <a href="https://doi.org/10.48550/arXiv.1707.08538">doi:10.48550/arXiv.1707.08538</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Anova.mp">Anova.mp()</a></code>, <code><a href="#topic+glmer.mp.con">glmer.mp.con()</a></code>, <code><a href="#topic+glm.mp">glm.mp()</a></code>, <code><a href="#topic+glm.mp.con">glm.mp.con()</a></code>, <code><a href="lme4.html#topic+glmer">lme4::glmer()</a></code>, <code><a href="lme4.html#topic+lmerControl">lme4::glmerControl()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(multpois)
library(car)
library(lme4)
library(lmerTest)

## two within-subjects factors (x1,X2) with dichotomous response (Y)
data(ws2, package="multpois")

ws2$PId = factor(ws2$PId)
ws2$Y = factor(ws2$Y)
ws2$X1 = factor(ws2$X1)
ws2$X2 = factor(ws2$X2)
contrasts(ws2$X1) &lt;- "contr.sum"
contrasts(ws2$X2) &lt;- "contr.sum"

m1 = glmer(Y ~ X1*X2 + (1|PId), data=ws2, family=binomial)
Anova(m1, type=3)

m2 = glmer.mp(Y ~ X1*X2 + (1|PId), data=ws2) # compare
Anova.mp(m2, type=3)

## two within-subjects factors (x1,X2) with polytomous response (Y)
data(ws3, package="multpois")

ws3$PId = factor(ws3$PId)
ws3$Y = factor(ws3$Y)
ws3$X1 = factor(ws3$X1)
ws3$X2 = factor(ws3$X2)
contrasts(ws3$X1) &lt;- "contr.sum"
contrasts(ws3$X2) &lt;- "contr.sum"

m3 = glmer.mp(Y ~ X1*X2 + (1|PId), data=ws3)
Anova.mp(m3, type=3)

</code></pre>

<hr>
<h2 id='glmer.mp.con'>Contrast tests for multinomial-Poisson GLMM</h2><span id='topic+glmer.mp.con'></span>

<h3>Description</h3>

<p>This function conducts <em>post hoc</em> pairwise comparisons on generalized linear mixed models (GLMMs)
built with <code><a href="#topic+glmer.mp">glmer.mp</a></code>. Such models have <strong>nominal response</strong> types, i.e., <code>factor</code>s
with unordered categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmer.mp.con(
  model,
  formula,
  adjust = c("holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glmer.mp.con_+3A_model">model</code></td>
<td>
<p>A multinomial-Poisson generalized linear mixed model created by <code><a href="#topic+glmer.mp">glmer.mp</a></code>.</p>
</td></tr>
<tr><td><code id="glmer.mp.con_+3A_formula">formula</code></td>
<td>
<p>A formula object in the style of, e.g., <code>pairwise ~ X1*X2</code>, where <code>X1</code> and
<code>X2</code> are factors in <code>model</code>. The <code>pairwise</code> keyword <em>must</em> be used on the left-hand
side of the formula. See the <code>specs</code> entry for <code><a href="emmeans.html#topic+emmeans">emmeans</a></code>.</p>
</td></tr>
<tr><td><code id="glmer.mp.con_+3A_adjust">adjust</code></td>
<td>
<p>A string indicating the <em>p</em>-value adjustment to use. Defaults to <code>"holm"</code>. See the
details for <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="glmer.mp.con_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="lme4.html#topic+glmer">glmer</a></code>. Most often, these additional
arguments are used to specify alternate optimizers. (See <strong>Note</strong>, below.) These additional arguments
must not pass <code>formula</code>, <code>data</code>, or <code>family</code> arguments. See <code><a href="lme4.html#topic+glmer">glmer</a></code> for
valid arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Post hoc</em> pairwise comparisons should be conducted <em>only</em> after a statistically significant
omnibus test using <code><a href="#topic+Anova.mp">Anova.mp</a></code>. Comparisons are conducted in the style of
<code><a href="emmeans.html#topic+emmeans">emmeans</a></code> but not using this function; rather, the multinomial-Poisson trick is used
on the subset of the data relevant to each pairwise comparison.
</p>
<p>Users wishing to verify the correctness of <code>glmer.mp.con</code> should compare its results to
<code><a href="emmeans.html#topic+emmeans">emmeans</a></code> results for models built with <code><a href="lme4.html#topic+glmer">glmer</a></code> using
<code>family=binomial</code> for dichotomous responses. Factor contrasts should be set to sum-to-zero
contrasts (i.e., <code>"contr.sum"</code>). The results should be similar.
</p>


<h3>Value</h3>

<p>Pairwise comparisons for all levels indicated by the factors in <code>formula</code>.
</p>


<h3>Note</h3>

<p>It is not uncommon to receive <code>boundary (singular) fit</code> messages. These messages can often be
ignored provided the test output looks sensible.
</p>
<p>Sometimes, <code>glmer.mp.con</code> can fail to converge. Convergence issues
can often be remedied by changing the optimizer or its control parameters. For example, the following code
uses the <code>bobyqa</code> optimizer and increases the maximum number of function evaluations to 100,000:
</p>
<p><code>glmer.mp.con(m, pairwise ~ X1*X2, adjust="holm", control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=1e+05)))</code>
</p>
<p>Other available <code>optimizer</code> strings besides <code>"bobyqa"</code> include <code>"nloptwrap"</code>, <code>"nlminbwrap"</code>,
and <code>"Nelder_Mead"</code>. Additional optimizers are available via the <code><a href="optimx.html#topic+optimx">optimx</a></code> library
by passing <code>"optimx"</code> to <code>optimizer</code> and <code>method="name"</code> in the <code>optCtrl</code> parameter list.
Eligible <em>name</em>s include <code>"nlm"</code>, <code>"BFGS"</code>, and <code>"L-BFGS-B"</code>, among others. See the
<code>optimizer</code> argument in <code><a href="lme4.html#topic+glmerControl">glmerControl</a></code> and the details for <code><a href="optimx.html#topic+optimx">optimx</a></code>
for more information.
</p>


<h3>Author(s)</h3>

<p>Jacob O. Wobbrock
</p>


<h3>References</h3>

<p>Baker, S.G. (1994). The multinomial-Poisson transformation.
<em>The Statistician 43</em> (4), pp. 495-504. <a href="https://doi.org/10.2307/2348134">doi:10.2307/2348134</a>
</p>
<p>Chen, Z. and Kuo, L. (2001). A note on the estimation of the
multinomial logit model with random effects. <em>The American Statistician
55</em> (2), pp. 89-95. <a href="https://www.jstor.org/stable/2685993">https://www.jstor.org/stable/2685993</a>
</p>
<p>Guimaraes, P. (2004). Understanding the multinomial-Poisson
transformation. <em>The Stata Journal 4</em> (3), pp. 265-273.
<a href="https://www.stata-journal.com/article.html?article=st0069">https://www.stata-journal.com/article.html?article=st0069</a>
</p>
<p>Lee, J.Y.L., Green, P.J.,and Ryan, L.M. (2017). On the “Poisson
trick” and its extensions for fitting multinomial regression models. <em>arXiv
preprint</em> available at <a href="https://doi.org/10.48550/arXiv.1707.08538">doi:10.48550/arXiv.1707.08538</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Anova.mp">Anova.mp()</a></code>, <code><a href="#topic+glmer.mp">glmer.mp()</a></code>, <code><a href="#topic+glm.mp">glm.mp()</a></code>, <code><a href="#topic+glm.mp.con">glm.mp.con()</a></code>, <code><a href="lme4.html#topic+glmer">lme4::glmer()</a></code>, <code><a href="lme4.html#topic+lmerControl">lme4::glmerControl()</a></code>, <code><a href="emmeans.html#topic+emmeans">emmeans::emmeans()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(multpois)
library(car)
library(lme4)
library(lmerTest)
library(emmeans)

## two within-subjects factors (x1,X2) with dichotomous response (Y)
data(ws2, package="multpois")

ws2$PId = factor(ws2$PId)
ws2$Y = factor(ws2$Y)
ws2$X1 = factor(ws2$X1)
ws2$X2 = factor(ws2$X2)
contrasts(ws2$X1) &lt;- "contr.sum"
contrasts(ws2$X2) &lt;- "contr.sum"

m1 = glmer(Y ~ X1*X2 + (1|PId), data=ws2, family=binomial)
Anova(m1, type=3)
emmeans(m1, pairwise ~ X1*X2, adjust="holm")

m2 = glmer.mp(Y ~ X1*X2 + (1|PId), data=ws2)
Anova.mp(m2, type=3)
glmer.mp.con(m2, pairwise ~ X1*X2, adjust="holm") # compare


## two within-subjects factors (x1,X2) with polytomous response (Y)
data(ws3, package="multpois")

ws3$PId = factor(ws3$PId)
ws3$Y = factor(ws3$Y)
ws3$X1 = factor(ws3$X1)
ws3$X2 = factor(ws3$X2)
contrasts(ws3$X1) &lt;- "contr.sum"
contrasts(ws3$X2) &lt;- "contr.sum"

m3 = glmer.mp(Y ~ X1*X2 + (1|PId), data=ws3)
Anova.mp(m3, type=3)
glmer.mp.con(m3, pairwise ~ X1*X2, adjust="holm")


</code></pre>

<hr>
<h2 id='icecream'>Mixed factorial 2×2 design with polytomous response data</h2><span id='topic+icecream'></span>

<h3>Description</h3>

<p>This synthetic long-format data set represents a survey of 40 respondents about their
favorite ice cream flavors. Twenty of the respondents were adults and 20 were children.
They were asked four times over the course of a year, once in the middle of each season
(fall, winter, spring, summer), for their favorite ice cream flavor in that season.
</p>
<p>This data set has a polytomous response <code>Pref</code> and two factors,
<code>Age</code> and <code>Season</code>. The response <code>Pref</code> has the unordered categories
<code>{vanilla, chocolate, strawberry}</code>. Factor <code>Age</code> has levels
<code>{adult, child}</code>. Factor <code>Season</code> has levels <code>{fall, winter, spring, summer}</code>.
It also has a <code>PId</code> column for a participant identifier. Each participant identifier is repeated
four times, once for each season.
</p>


<h3>Format</h3>

<p>A data frame with 160 observations on the following 4 variables:
</p>

<dl>
<dt>PId</dt><dd><p>a participant identifier with levels <code>"1"</code> ... <code>"40"</code></p>
</dd>
<dt>Age</dt><dd><p>a between-subjects factor with levels <code>"adult"</code>, <code>"child"</code></p>
</dd>
<dt>Season</dt><dd><p>a within-subjects factor with levels <code>"fall"</code>, <code>"winter"</code>, <code>"spring"</code>, <code>"summer"</code></p>
</dd>
<dt>Pref</dt><dd><p>a polytomous response with categories <code>"vanilla"</code>, <code>"chocolate"</code>, <code>"strawberry"</code></p>
</dd>
</dl>



<h3>See Also</h3>

<p>See <code>vignette("multpois", package="multpois")</code> for a complete analysis of this data set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(multpois)
data(icecream, package="multpois")

icecream$PId = factor(icecream$PId)
icecream$Pref = factor(icecream$Pref, levels=c("vanilla","chocolate","strawberry"))
icecream$Age = factor(icecream$Age, levels=c("adult","child"))
icecream$Season = factor(icecream$Season, levels=c("fall","winter","spring","summer"))
contrasts(icecream$Age) &lt;- "contr.sum"
contrasts(icecream$Season) &lt;- "contr.sum"

m = glmer.mp(Pref ~ Age*Season + (1|PId), data=icecream)
Anova.mp(m, type=3)
glmer.mp.con(m, pairwise ~ Age*Season, adjust="holm")


</code></pre>

<hr>
<h2 id='ws2'>Within-subjects 2×2 design with dichotomous response data</h2><span id='topic+ws2'></span>

<h3>Description</h3>

<p>This generic synthetic long-format data set has a dichotomous response <code>Y</code>
and two factors <code>X1</code> and <code>X2</code>. The response has categories <code>{yes, no}</code>.
Factor <code>X1</code> has levels <code>{a, b}</code>, and factor <code>X2</code> has levels
<code>{c, d}</code>. It also has a <code>PId</code> column for a participant identifier.
Participant identifiers are repeated across rows.
</p>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 4 variables:
</p>

<dl>
<dt>PId</dt><dd><p>a participant identifier with levels <code>"1"</code> ... <code>"15"</code></p>
</dd>
<dt>X1</dt><dd><p>a within-subjects factor with levels <code>"a"</code>, <code>"b"</code></p>
</dd>
<dt>X2</dt><dd><p>a within-subjects factor with levels <code>"c"</code>, <code>"d"</code></p>
</dd>
<dt>Y</dt><dd><p>a dichotomous response with categories <code>"yes"</code>, <code>"no"</code></p>
</dd>
</dl>



<h3>See Also</h3>

<p>See <code><a href="#topic+glmer.mp">glmer.mp</a></code> and <code><a href="#topic+glmer.mp.con">glmer.mp.con</a></code> for complete examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(multpois)
data(ws2, package="multpois")

ws2$PId = factor(ws2$PId)
ws2$Y = factor(ws2$Y, levels=c("yes","no"))
ws2$X1 = factor(ws2$X1)
ws2$X2 = factor(ws2$X2)
contrasts(ws2$X1) &lt;- "contr.sum"
contrasts(ws2$X2) &lt;- "contr.sum"

m = glmer.mp(Y ~ X1*X2 + (1|PId), data=ws2)
Anova.mp(m, type=3)
glmer.mp.con(m, pairwise ~ X1*X2, adjust="holm")

</code></pre>

<hr>
<h2 id='ws3'>Within-subjects 2×2 design with polytomous response data</h2><span id='topic+ws3'></span>

<h3>Description</h3>

<p>This generic synthetic long-format data set has a polytomous response <code>Y</code>
and two factors <code>X1</code> and <code>X2</code>. The response has categories
<code>{yes, no, maybe}</code>. Factor <code>X1</code> has levels <code>{a, b}</code>, and factor
<code>X2</code> has levels <code>{c, d}</code>. It also has a <code>PId</code> column for a
participant identifier. Participant identifiers are repeated across rows.
</p>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 4 variables:
</p>

<dl>
<dt>PId</dt><dd><p>a participant identifier with levels <code>"1"</code> ... <code>"15"</code></p>
</dd>
<dt>X1</dt><dd><p>a within-subjects factor with levels <code>"a"</code>, <code>"b"</code></p>
</dd>
<dt>X2</dt><dd><p>a within-subjects factor with levels <code>"c"</code>, <code>"d"</code></p>
</dd>
<dt>Y</dt><dd><p>a polytomous response with categories <code>"yes"</code>, <code>"no"</code>, <code>"maybe"</code></p>
</dd>
</dl>



<h3>See Also</h3>

<p>See <code><a href="#topic+glmer.mp">glmer.mp</a></code> and <code><a href="#topic+glmer.mp.con">glmer.mp.con</a></code> for complete examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(multpois)
data(ws3, package="multpois")

ws3$PId = factor(ws3$PId)
ws3$Y = factor(ws3$Y, levels=c("yes","no","maybe"))
ws3$X1 = factor(ws3$X1)
ws3$X2 = factor(ws3$X2)
contrasts(ws3$X1) &lt;- "contr.sum"
contrasts(ws3$X2) &lt;- "contr.sum"

m = glmer.mp(Y ~ X1*X2 + (1|PId), data=ws3)
Anova.mp(m, type=3)
glmer.mp.con(m, pairwise ~ X1*X2, adjust="holm")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
