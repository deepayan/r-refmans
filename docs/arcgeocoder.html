<!DOCTYPE html><html lang="en"><head><title>Help for package arcgeocoder</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {arcgeocoder}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#arcgeocoder-package'><p>arcgeocoder: Geocoding with the 'ArcGIS' REST API Service</p></a></li>
<li><a href='#arc_api_call'><p>Helper function for centralize API queries</p></a></li>
<li><a href='#arc_categories'><p>ArcGIS REST API category data base</p></a></li>
<li><a href='#arc_geo'><p>Geocoding using the ArcGIS REST API</p></a></li>
<li><a href='#arc_geo_categories'><p>Geocode places on a given area by category</p></a></li>
<li><a href='#arc_geo_multi'><p>Geocoding using the ArcGIS REST API with multi-field query</p></a></li>
<li><a href='#arc_reverse_geo'><p>Reverse Geocoding using the ArcGIS REST API</p></a></li>
<li><a href='#arc_spatial_references'><p>ESRI (ArcGIS) Spatial Reference data base</p></a></li>
<li><a href='#arcgeocoder_check_access'><p>Check access to ArcGIS REST</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Geocoding with the 'ArcGIS' REST API Service</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Lite interface for finding locations of addresses or
    businesses around the world using the 'ArcGIS' REST API service
    <a href="https://developers.arcgis.com/rest/geocode/api-reference/overview-world-geocoding-service.htm">https://developers.arcgis.com/rest/geocode/api-reference/overview-world-geocoding-service.htm</a>.
    Address text can be converted to location candidates and a location
    can be converted into an address. No API key required.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://dieghernan.github.io/arcgeocoder/">https://dieghernan.github.io/arcgeocoder/</a>,
<a href="https://github.com/dieghernan/arcgeocoder">https://github.com/dieghernan/arcgeocoder</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dieghernan/arcgeocoder/issues">https://github.com/dieghernan/arcgeocoder/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 1.0.0), jsonlite (&ge; 1.7.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, knitr, rmarkdown, sf, testthat (&ge; 3.0.0), tibble,
tidygeocoder</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>dieghernan/gitdevr, lwgeom, leaflet, terra,
tidyterra, maptiles, styler, mapSpain, remotes, reactable,
crosstalk</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>X-schema.org-applicationCategory:</td>
<td>cartography</td>
</tr>
<tr>
<td>X-schema.org-keywords:</td>
<td>r, geocoding, arcgis, address,
reverse-geocoding, rstats, r-package, api-wrapper, api-rest,
arcgis-api, cran-r, gis, cran</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-17 10:38:16 UTC; diego</td>
</tr>
<tr>
<td>Author:</td>
<td>Diego Hernangómez <a href="https://orcid.org/0000-0001-8457-4658"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Diego Hernangómez &lt;diego.hernangomezherrero@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-17 10:50:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='arcgeocoder-package'>arcgeocoder: Geocoding with the 'ArcGIS' REST API Service</h2><span id='topic+arcgeocoder'></span><span id='topic+arcgeocoder-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Lite interface for finding locations of addresses or businesses around the world using the 'ArcGIS' REST API service <a href="https://developers.arcgis.com/rest/geocode/api-reference/overview-world-geocoding-service.htm">https://developers.arcgis.com/rest/geocode/api-reference/overview-world-geocoding-service.htm</a>. Address text can be converted to location candidates and a location can be converted into an address. No API key required.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Diego Hernangómez <a href="mailto:diego.hernangomezherrero@gmail.com">diego.hernangomezherrero@gmail.com</a> (<a href="https://orcid.org/0000-0001-8457-4658">ORCID</a>) [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://dieghernan.github.io/arcgeocoder/">https://dieghernan.github.io/arcgeocoder/</a>
</p>
</li>
<li> <p><a href="https://github.com/dieghernan/arcgeocoder">https://github.com/dieghernan/arcgeocoder</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/dieghernan/arcgeocoder/issues">https://github.com/dieghernan/arcgeocoder/issues</a>
</p>
</li></ul>


<hr>
<h2 id='arc_api_call'>Helper function for centralize API queries</h2><span id='topic+arc_api_call'></span>

<h3>Description</h3>

<p>A wrapper of <code><a href="utils.html#topic+download.file">utils::download.file()</a></code>. On warning on error it will
retry the call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arc_api_call(url, destfile, quiet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arc_api_call_+3A_url">url</code></td>
<td>
<p>a <code><a href="base.html#topic+character">character</a></code> string (or longer vector
for the <code>"libcurl"</code> method) naming the URL of a resource to be
downloaded.</p>
</td></tr>
<tr><td><code id="arc_api_call_+3A_destfile">destfile</code></td>
<td>
<p>a character string (or vector, see the <code>url</code>
argument) with the file path where the downloaded file is to be
saved.  Tilde-expansion is performed.</p>
</td></tr>
<tr><td><code id="arc_api_call_+3A_quiet">quiet</code></td>
<td>
<p>If <code>TRUE</code>, suppress status messages (if any), and
the progress bar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical <code>TRUE/FALSE</code>
</p>


<h3>See Also</h3>

<p>Other api_management: 
<code><a href="#topic+arcgeocoder_check_access">arcgeocoder_check_access</a>()</code>
</p>

<hr>
<h2 id='arc_categories'>ArcGIS REST API category data base</h2><span id='topic+arc_categories'></span>

<h3>Description</h3>

<p>Database of available categories that can be used for filtering results
provided by <code><a href="#topic+arc_geo">arc_geo()</a></code>, <code><a href="#topic+arc_geo_multi">arc_geo_multi()</a></code> and <code><a href="#topic+arc_geo_categories">arc_geo_categories()</a></code> in
<code><a href="tibble.html#topic+tibble">tibble</a></code> format.
</p>


<h3>Format</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble</a></code> with
376 rows and
fields:
</p>

<dl>
<dt>level_1</dt><dd><p>Top-level category</p>
</dd>
<dt>level_2</dt><dd><p>Second-level category</p>
</dd>
<dt>level_3</dt><dd><p>Child-level category</p>
</dd>
</dl>



<h3>Details</h3>

<p>See <a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-category-filtering.htm">ArcGIS REST Category filtering</a> for details and
examples.
</p>
<p>The geocoding service allows users to search for and geocode many types of
addresses and places around the world. This simplifies the application
building process, as developers don't need to know what types of places
their users are searching for, because the service can decipher that.
However, due to this flexibility, it is possible for ambiguous searches to
match to many different places, and users may sometimes receive unexpected
results. For example, a search for a city may match to a street name, or a
search for an airport code may match to a country abbreviation.
</p>
<p>For such cases, the service provides the ability to filter out unwanted
geocode results with the <code>category</code> parameter. The <code>category</code> parameter
limits the types of places for which the service searches, thus eliminating
false positive matches and potentially speeding up the search process.
</p>
<p>The results shows a list of categories with three different hierarchy levels
(<code>level_1</code>, <code>level_2</code>, <code>level_3</code>). If a <code>level_1</code> category is requested
(i.e. <code>POI</code>) the child categories may be included also in the results.
</p>


<h3>Note</h3>

<p>Data extracted on <strong>10 January 2023</strong>.
</p>


<h3>Source</h3>

<p><a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-category-filtering.htm">ArcGIS REST Category filtering</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+arc_geo_categories">arc_geo_categories()</a></code>, <code><a href="#topic+arc_geo">arc_geo()</a></code>, <code><a href="#topic+arc_geo_multi">arc_geo_multi()</a></code>
</p>
<p>Other datasets: 
<code><a href="#topic+arc_spatial_references">arc_spatial_references</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Get all possible values
data("arc_categories")
arc_categories

# Using categories

sea_1 &lt;- arc_geo("sea",
  custom_query = list(outFields = c("LongLabel", "Type")),
  limit = 2
)


dplyr::glimpse(sea_1)

# An airport, but if we use categories...

sea_2 &lt;- arc_geo("sea",
  custom_query = list(outFields = c("LongLabel", "Type")),
  limit = 2, category = "Food"
)

dplyr::glimpse(sea_2)

# We can use a list of categories
sea_3 &lt;- arc_geo("sea",
  custom_query = list(outFields = c("LongLabel", "Type")),
  sourcecountry = "UK", limit = 5,
  category = c("Amusement Park", "Aquarium")
)

dplyr::glimpse(sea_3)


</code></pre>

<hr>
<h2 id='arc_geo'>Geocoding using the ArcGIS REST API</h2><span id='topic+arc_geo'></span>

<h3>Description</h3>

<p>Geocodes addresses given as character values. This function returns the
<code><a href="tibble.html#topic+tibble">tibble</a></code> object associated with the query.
</p>
<p>This function uses the <code>SingleLine</code> approach detailed in the
<a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-find-address-candidates.htm">ArcGIS REST docs</a>. For multi-field queries (i.e.
using specific address parameters) use <code><a href="#topic+arc_geo_multi">arc_geo_multi()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arc_geo(
  address,
  lat = "lat",
  long = "lon",
  limit = 1,
  full_results = FALSE,
  return_addresses = TRUE,
  verbose = FALSE,
  progressbar = TRUE,
  outsr = NULL,
  langcode = NULL,
  sourcecountry = NULL,
  category = NULL,
  custom_query = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arc_geo_+3A_address">address</code></td>
<td>
<p>character with single line address
(<code>"1600 Pennsylvania Ave NW, Washington"</code>) or a vector of addresses
(<code>c("Madrid", "Barcelona")</code>).</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_lat">lat</code></td>
<td>
<p>latitude column name in the output data (default  <code>"lat"</code>).</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_long">long</code></td>
<td>
<p>longitude column name in the output data (default  <code>"lon"</code>).</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_limit">limit</code></td>
<td>
<p>maximum number of results to return per input address. Note
that each query returns a maximum of 50 results.</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_full_results">full_results</code></td>
<td>
<p>returns all available data from the API service. This
is a shorthand of <code style="white-space: pre;">&#8288;outFields=*&#8288;</code>. See <strong>References</strong>. If <code>FALSE</code> (default)
only the default values of the API would be returned. See also
<code>return_addresses</code> argument.</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_return_addresses">return_addresses</code></td>
<td>
<p>return input addresses with results if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> then detailed logs are output to the console.</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_progressbar">progressbar</code></td>
<td>
<p>Logical. If <code>TRUE</code> displays a progress bar to indicate
the progress of the function.</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_outsr">outsr</code></td>
<td>
<p>The spatial reference of the <code style="white-space: pre;">&#8288;x,y&#8288;</code> coordinates returned by a
geocode request. By default is <code>NULL</code> (i.e. the parameter won't be used in
the query). See <strong>Details</strong> and <a href="#topic+arc_spatial_references">arc_spatial_references</a>.</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_langcode">langcode</code></td>
<td>
<p>Sets the language in which reverse-geocoded addresses are
returned.</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_sourcecountry">sourcecountry</code></td>
<td>
<p>Limits the candidates returned to the specified country
or countries. Acceptable values include the three-character country code.
You can specify multiple country codes to limit results to more than one
country.</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_category">category</code></td>
<td>
<p>A place or address type that can be used to filter results.
Several values can be used as well as a vector (i.e.
<code>c("Cinema", "Museum")</code>). See <a href="#topic+arc_categories">arc_categories</a> for details.</p>
</td></tr>
<tr><td><code id="arc_geo_+3A_custom_query">custom_query</code></td>
<td>
<p>API-specific parameters to be used, passed as a named
list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More info and valid values in the <a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-find-address-candidates.htm">ArcGIS REST docs</a>.
</p>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble</a></code> object with the results. See the details of the output in  <a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-service-output.htm">ArcGIS REST API Service output</a>.
</p>


<h3><code>outsr</code></h3>

<p>The spatial reference can be specified as either a well-known ID (WKID). If
not specified, the spatial reference of the output locations is the same as
that of the service ( WGS84, i.e. WKID = 4326)).
</p>
<p>See <a href="#topic+arc_spatial_references">arc_spatial_references</a> for values and examples.
</p>


<h3>References</h3>

<p><a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-find-address-candidates.htm">ArcGIS REST <code>findAddressCandidates</code></a>.
</p>


<h3>See Also</h3>

<p><code><a href="tidygeocoder.html#topic+geo">tidygeocoder::geo()</a></code>
</p>
<p>Other functions for geocoding: 
<code><a href="#topic+arc_geo_categories">arc_geo_categories</a>()</code>,
<code><a href="#topic+arc_geo_multi">arc_geo_multi</a>()</code>,
<code><a href="#topic+arc_reverse_geo">arc_reverse_geo</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

arc_geo("Madrid, Spain")

library(dplyr)

# Several addresses with additional output fields
with_params &lt;- arc_geo(c("Madrid", "Barcelona"),
  custom_query = list(outFields = c("LongLabel", "CntryName"))
)

with_params %&gt;%
  select(lat, lon, CntryName, LongLabel)

# With options: restrict search to USA
with_params_usa &lt;- arc_geo(c("Madrid", "Barcelona"),
  sourcecountry = "USA",
  custom_query = list(outFields = c("LongLabel", "CntryName"))
)

with_params_usa %&gt;%
  select(lat, lon, CntryName, LongLabel)


</code></pre>

<hr>
<h2 id='arc_geo_categories'>Geocode places on a given area by category</h2><span id='topic+arc_geo_categories'></span>

<h3>Description</h3>

<p>This function is useful for extracting places with a given category (or list
of categories) near or within a given location or area. This is a wrapper
of <code><a href="#topic+arc_geo">arc_geo()</a></code>, but it is vectorized over <code>category</code>.
</p>
<p>See <a href="#topic+arc_categories">arc_categories</a> for a detailed explanation and available values.
</p>
<p><strong>Note that</strong> for obtaining results it is needed:
</p>

<ul>
<li><p> Either to provide a pair of coordinates (<code style="white-space: pre;">&#8288;x,y&#8288;</code> parameters) that would be
used as a reference for geocoding.
</p>
</li>
<li><p> Or a viewbox (aka bounding box) on the <code>bbox</code> parameter defining an
desired extent of the results.
</p>
</li></ul>

<p>It is possible to combine the two approaches (i.e. providing <code style="white-space: pre;">&#8288;x,y,bbox&#8288;</code>
values) in order to boost the geocoding process. See <strong>Examples</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arc_geo_categories(
  category,
  x = NULL,
  y = NULL,
  bbox = NULL,
  name = NULL,
  lat = "lat",
  long = "lon",
  limit = 1,
  full_results = FALSE,
  verbose = FALSE,
  custom_query = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arc_geo_categories_+3A_category">category</code></td>
<td>
<p>A place or address type that can be used to filter results.
Several values can be used as well as a vector (i.e.
<code>c("Cinema", "Museum")</code>), performing one call for each value. See
<strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_x">x</code></td>
<td>
<p>longitude values in numeric format. Must be in the range
<code class="reqn">\left[-180, 180 \right]</code>.</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_y">y</code></td>
<td>
<p>latitude values in numeric format. Must be in the range
<code class="reqn">\left[-90, 90 \right]</code>.</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_bbox">bbox</code></td>
<td>
<p>A numeric vector of latitude and longitude
<code>c(minX, minY, maxX, maxY)</code> that restrict the search area.
See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_name">name</code></td>
<td>
<p>Optionally, a string indicating the name or address of the
desired results.</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_lat">lat</code></td>
<td>
<p>latitude column name in the output data (default  <code>"lat"</code>).</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_long">long</code></td>
<td>
<p>longitude column name in the output data (default  <code>"lon"</code>).</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_limit">limit</code></td>
<td>
<p>maximum number of results to return per input address. Note
that each query returns a maximum of 50 results.</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_full_results">full_results</code></td>
<td>
<p>returns all available data from the API service. This
is a shorthand of <code style="white-space: pre;">&#8288;outFields=*&#8288;</code>. See <strong>References</strong>. If <code>FALSE</code> (default)
only the default values of the API would be returned. See also
<code>return_addresses</code> argument.</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> then detailed logs are output to the console.</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_custom_query">custom_query</code></td>
<td>
<p>API-specific parameters to be used, passed as a named
list.</p>
</td></tr>
<tr><td><code id="arc_geo_categories_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+arc_geo">arc_geo</a></code>
</p>

<dl>
<dt><code>sourcecountry</code></dt><dd><p>Limits the candidates returned to the specified country
or countries. Acceptable values include the three-character country code.
You can specify multiple country codes to limit results to more than one
country.</p>
</dd>
<dt><code>outsr</code></dt><dd><p>The spatial reference of the <code style="white-space: pre;">&#8288;x,y&#8288;</code> coordinates returned by a
geocode request. By default is <code>NULL</code> (i.e. the parameter won't be used in
the query). See <strong>Details</strong> and <a href="#topic+arc_spatial_references">arc_spatial_references</a>.</p>
</dd>
<dt><code>langcode</code></dt><dd><p>Sets the language in which reverse-geocoded addresses are
returned.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>Bounding boxes can be located using different online tools, as
<a href="https://boundingbox.klokantech.com/">Bounding Box Tool</a>.
</p>
<p>For a full list of valid categories see <a href="#topic+arc_categories">arc_categories</a>.
</p>
<p>This function is vectorized over <code>category</code>, that means that it would perform
one independent call to <code><a href="#topic+arc_geo">arc_geo()</a></code> for each <code>category</code> value.
</p>
<p><code>arc_geo_categories()</code> also understands a single string of categories
separated by commas (<code>"Cinema,Museum"</code>), that would be internally treated as
<code>c("Cinema", "Museum")</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble</a></code> object with the results. See the details of the output in  <a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-service-output.htm">ArcGIS REST API Service output</a>.
</p>


<h3><code>outsr</code></h3>

<p>The spatial reference can be specified as either a well-known ID (WKID). If
not specified, the spatial reference of the output locations is the same as
that of the service ( WGS84, i.e. WKID = 4326)).
</p>
<p>See <a href="#topic+arc_spatial_references">arc_spatial_references</a> for values and examples.
</p>


<h3>See Also</h3>

<p><a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-category-filtering.htm">ArcGIS REST Category filtering</a>.
</p>
<p><a href="#topic+arc_categories">arc_categories</a>
</p>
<p>Other functions for geocoding: 
<code><a href="#topic+arc_geo">arc_geo</a>()</code>,
<code><a href="#topic+arc_geo_multi">arc_geo_multi</a>()</code>,
<code><a href="#topic+arc_reverse_geo">arc_reverse_geo</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Full workflow: Gas Stations near Carabanchel, Madrid

# Get Carabanchel
carab &lt;- arc_geo("Carabanchel, Madrid, Spain")

# CRS
carab_crs &lt;- unique(carab$latestWkid)


library(ggplot2)

base_map &lt;- ggplot(carab) +
  geom_point(aes(lon, lat), size = 5, color = "red") +
  geom_rect(aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
    fill = NA,
    color = "blue"
  ) +
  coord_sf(crs = carab_crs)


# Ex1: Search near Carabanchel (not restricted)
ex1 &lt;- arc_geo_categories("Gas Station",
  # Location
  x = carab$lon, y = carab$lat,
  limit = 50, full_results = TRUE
)


# Reduce number of labels to most common ones
library(dplyr)

labs &lt;- ex1 %&gt;%
  count(ShortLabel) %&gt;%
  slice_max(n = 7, order_by = n) %&gt;%
  pull(ShortLabel)

base_map +
  geom_point(data = ex1, aes(lon, lat, color = ShortLabel)) +
  scale_color_discrete(breaks = labs) +
  labs(
    title = "Example 1",
    subtitle = "Search near (points may be far away)"
  )

# Example 2: Include part of the name, different results
ex2 &lt;- arc_geo_categories("Gas Station",
  # Name
  name = "Repsol",
  # Location
  x = carab$lon, y = carab$lat,
  limit = 50, full_results = TRUE
)

base_map +
  geom_point(data = ex2, aes(lon, lat, color = ShortLabel)) +
  labs(
    title = "Example 2",
    subtitle = "Search near with name"
  )

# Example 3: Near within a extent
ex3 &lt;- arc_geo_categories("Gas Station",
  name = "Repsol",
  bbox = c(carab$xmin, carab$ymin, carab$xmax, carab$ymax),
  limit = 50, full_results = TRUE
)

base_map +
  geom_point(data = ex3, aes(lon, lat, color = ShortLabel)) +
  labs(
    title = "Example 3",
    subtitle = "Search near with name and bbox"
  )


</code></pre>

<hr>
<h2 id='arc_geo_multi'>Geocoding using the ArcGIS REST API with multi-field query</h2><span id='topic+arc_geo_multi'></span>

<h3>Description</h3>

<p>Geocodes addresses given specific address components.This function returns
the <code><a href="tibble.html#topic+tibble">tibble</a></code> associated with the query.
</p>
<p>For geocoding using a single text string use <code><a href="#topic+arc_geo">arc_geo()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arc_geo_multi(
  address = NULL,
  address2 = NULL,
  address3 = NULL,
  neighborhood = NULL,
  city = NULL,
  subregion = NULL,
  region = NULL,
  postal = NULL,
  postalext = NULL,
  countrycode = NULL,
  lat = "lat",
  long = "lon",
  limit = 1,
  full_results = FALSE,
  return_addresses = TRUE,
  verbose = FALSE,
  progressbar = TRUE,
  outsr = NULL,
  langcode = NULL,
  category = NULL,
  custom_query = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arc_geo_multi_+3A_address">address</code>, <code id="arc_geo_multi_+3A_address2">address2</code>, <code id="arc_geo_multi_+3A_address3">address3</code>, <code id="arc_geo_multi_+3A_neighborhood">neighborhood</code>, <code id="arc_geo_multi_+3A_city">city</code>, <code id="arc_geo_multi_+3A_subregion">subregion</code></td>
<td>
<p>Address
components  (See <strong>Details</strong>).</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_region">region</code>, <code id="arc_geo_multi_+3A_postal">postal</code>, <code id="arc_geo_multi_+3A_postalext">postalext</code>, <code id="arc_geo_multi_+3A_countrycode">countrycode</code></td>
<td>
<p>More address components, see
(See <strong>Details</strong>).</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_lat">lat</code></td>
<td>
<p>latitude column name in the output data (default  <code>"lat"</code>).</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_long">long</code></td>
<td>
<p>longitude column name in the output data (default  <code>"lon"</code>).</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_limit">limit</code></td>
<td>
<p>maximum number of results to return per input address. Note
that each query returns a maximum of 50 results.</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_full_results">full_results</code></td>
<td>
<p>returns all available data from the API service. This
is a shorthand of <code style="white-space: pre;">&#8288;outFields=*&#8288;</code>. See <strong>References</strong>. If <code>FALSE</code> (default)
only the default values of the API would be returned. See also
<code>return_addresses</code> argument.</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_return_addresses">return_addresses</code></td>
<td>
<p>return input addresses with results if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> then detailed logs are output to the console.</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_progressbar">progressbar</code></td>
<td>
<p>Logical. If <code>TRUE</code> displays a progress bar to indicate
the progress of the function.</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_outsr">outsr</code></td>
<td>
<p>The spatial reference of the <code style="white-space: pre;">&#8288;x,y&#8288;</code> coordinates returned by a
geocode request. By default is <code>NULL</code> (i.e. the parameter won't be used in
the query). See <strong>Details</strong> and <a href="#topic+arc_spatial_references">arc_spatial_references</a>.</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_langcode">langcode</code></td>
<td>
<p>Sets the language in which reverse-geocoded addresses are
returned.</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_category">category</code></td>
<td>
<p>A place or address type that can be used to filter results.
Several values can be used as well as a vector (i.e.
<code>c("Cinema", "Museum")</code>). See <a href="#topic+arc_categories">arc_categories</a> for details.</p>
</td></tr>
<tr><td><code id="arc_geo_multi_+3A_custom_query">custom_query</code></td>
<td>
<p>API-specific parameters to be used, passed as a named
list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More info and valid values in the <a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-find-address-candidates.htm">ArcGIS REST docs</a>.
</p>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble</a></code> object with the results. See the details of the output in  <a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-service-output.htm">ArcGIS REST API Service output</a>.
</p>
<p>The resulting output would include also the input parameters (columns with
prefix <code>q_</code>) for better tracking the results.
</p>


<h3>Address components</h3>

<p>This function allows to perform structured queries by different components of
an address. At least one field should be different than <code>NA</code> or <code>NULL</code>.
</p>
<p>A vector of values can be provided for each parameter for multiple geocoding.
When using vectors on different parameters, their lengths should be the
same.
</p>
<p>The following list provides a brief description of each parameter:
</p>

<ul>
<li> <p><code>address</code>: A string that represents the first line of a street address. In
most cases it will be the <strong>street name and house number</strong> input, but it
can also be used to input building name or place-name.
</p>
</li>
<li> <p><code>address2</code>: A string that represents the second line of a street address.
This can include <strong>street name/house number, building name, place-name, or
sub unit</strong>.
</p>
</li>
<li> <p><code>address3</code>: A string that represents the third line of a street address.
This can include <strong>street name/house number, building name, place-name, or
sub unit</strong>.
</p>
</li>
<li> <p><code>neighborhood</code>: The smallest administrative division associated with an
address, typically, a <strong>neighborhood</strong> or a section of a larger populated
place.
</p>
</li>
<li> <p><code>city</code>: The next largest administrative division associated with an
address, typically, a <strong>city or municipality</strong>.
</p>
</li>
<li> <p><code>subregion</code>: The next largest administrative division associated with an
address. Depending on the country, a sub region can represent a
<strong>county, state, or province</strong>.
</p>
</li>
<li> <p><code>region</code>: The largest administrative division associated with an address,
typically, a <strong>state or province</strong>.
</p>
</li>
<li> <p><code>postal</code>: The <strong>standard postal code</strong> for an address, typically, a
three– to six-digit alphanumeric code.
</p>
</li>
<li> <p><code>postalext</code>: A <strong>postal code extension</strong>, such as the United States Postal
Service ZIP+4 code.
</p>
</li>
<li> <p><code>countrycode</code>: A value representing the <strong>country</strong>. Providing this value
<strong>increases geocoding speed</strong>. Acceptable values include the full country
name in English or the official language of the country, the two-character
country code, or the three-character country code.
</p>
</li></ul>



<h3><code>outsr</code></h3>

<p>The spatial reference can be specified as either a well-known ID (WKID). If
not specified, the spatial reference of the output locations is the same as
that of the service ( WGS84, i.e. WKID = 4326)).
</p>
<p>See <a href="#topic+arc_spatial_references">arc_spatial_references</a> for values and examples.
</p>


<h3>References</h3>

<p><a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-find-address-candidates.htm">ArcGIS REST <code>findAddressCandidates</code></a>
</p>


<h3>See Also</h3>

<p><code><a href="tidygeocoder.html#topic+geo">tidygeocoder::geo()</a></code>
</p>
<p>Other functions for geocoding: 
<code><a href="#topic+arc_geo">arc_geo</a>()</code>,
<code><a href="#topic+arc_geo_categories">arc_geo_categories</a>()</code>,
<code><a href="#topic+arc_reverse_geo">arc_reverse_geo</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

simple &lt;- arc_geo_multi(
  address = "Plaza Mayor", limit = 10,
  custom_query = list(outFields = c("LongLabel", "CntryName", "Region"))
)

library(dplyr)

simple %&gt;%
  select(lat, lon, CntryName, Region, LongLabel) %&gt;%
  slice_head(n = 10)

# Restrict search to Spain
simple2 &lt;- arc_geo_multi(
  address = "Plaza Mayor", countrycode = "ESP",
  limit = 10,
  custom_query = list(outFields = c("LongLabel", "CntryName", "Region"))
)

simple2 %&gt;%
  select(lat, lon, CntryName, Region, LongLabel) %&gt;%
  slice_head(n = 10)

# Restrict to a region
simple3 &lt;- arc_geo_multi(
  address = "Plaza Mayor", region = "Segovia",
  countrycode = "ESP",
  limit = 10,
  custom_query = list(outFields = c("LongLabel", "CntryName", "Region"))
)

simple3 %&gt;%
  select(lat, lon, CntryName, Region, LongLabel) %&gt;%
  slice_head(n = 10)


</code></pre>

<hr>
<h2 id='arc_reverse_geo'>Reverse Geocoding using the ArcGIS REST API</h2><span id='topic+arc_reverse_geo'></span>

<h3>Description</h3>

<p>Generates an address from a latitude and longitude. Latitudes must be
in the range <code class="reqn">\left[-90, 90 \right]</code> and longitudes in the range
<code class="reqn">\left[-180, 180 \right]</code>. This function returns the
<code><a href="tibble.html#topic+tibble">tibble</a></code> associated with the query.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arc_reverse_geo(
  x,
  y,
  address = "address",
  full_results = FALSE,
  return_coords = TRUE,
  verbose = FALSE,
  progressbar = TRUE,
  outsr = NULL,
  langcode = NULL,
  featuretypes = NULL,
  locationtype = NULL,
  custom_query = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arc_reverse_geo_+3A_x">x</code></td>
<td>
<p>longitude values in numeric format. Must be in the range
<code class="reqn">\left[-180, 180 \right]</code>.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_y">y</code></td>
<td>
<p>latitude values in numeric format. Must be in the range
<code class="reqn">\left[-90, 90 \right]</code>.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_address">address</code></td>
<td>
<p>address column name in the output data (default  <code>"address"</code>).</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_full_results">full_results</code></td>
<td>
<p>returns all available data from the API service. If
<code>FALSE</code> (default) only latitude, longitude and address columns are
returned.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_return_coords">return_coords</code></td>
<td>
<p>return input coordinates with results if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> then detailed logs are output to the console.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_progressbar">progressbar</code></td>
<td>
<p>Logical. If <code>TRUE</code> displays a progress bar to indicate
the progress of the function.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_outsr">outsr</code></td>
<td>
<p>The spatial reference of the <code style="white-space: pre;">&#8288;x,y&#8288;</code> coordinates returned by a
geocode request. By default is <code>NULL</code> (i.e. the parameter won't be used in
the query). See <strong>Details</strong> and <a href="#topic+arc_spatial_references">arc_spatial_references</a>.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_langcode">langcode</code></td>
<td>
<p>Sets the language in which reverse-geocoded addresses are
returned.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_featuretypes">featuretypes</code></td>
<td>
<p>This parameter limits the possible match types returned.
By default is <code>NULL</code> (i.e. the parameter won't be used in the query).
See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_locationtype">locationtype</code></td>
<td>
<p>Specifies whether the output geometry of
<code>featuretypes = "PointAddress"</code> or <code>featuretypes = "Subaddress"</code> matches
should be the rooftop point or street entrance location. Valid values are
<code>NULL</code> (i.e. not using the parameter in the query), <code>rooftop</code> and <code>street</code>.</p>
</td></tr>
<tr><td><code id="arc_reverse_geo_+3A_custom_query">custom_query</code></td>
<td>
<p>API-specific parameters to be used, passed as a named
list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More info and valid values in the <a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-reverse-geocode.htm">ArcGIS REST docs</a>.
</p>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble</a></code> with the corresponding results. The <code style="white-space: pre;">&#8288;x,y&#8288;</code> values
returned by the API would be named <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. Note that these coordinates
correspond to the geocoded feature, and may be different of the <code style="white-space: pre;">&#8288;x,y&#8288;</code> values
provided as inputs.
</p>
<p>See the details of the output in
<a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-service-output.htm">ArcGIS REST API Service output</a>.
</p>


<h3><code>outsr</code></h3>

<p>The spatial reference can be specified as either a well-known ID (WKID). If
not specified, the spatial reference of the output locations is the same as
that of the service ( WGS84, i.e. WKID = 4326)).
</p>
<p>See <a href="#topic+arc_spatial_references">arc_spatial_references</a> for values and examples.
</p>


<h3><code>featuretypes</code></h3>

<p>See <code>vignette("featuretypes", package = "arcgeocoder")</code> for a detailed
explanation of this parameter.
</p>
<p>This parameter may be used for filtering the type of feature to be returned
when geocoding. Possible values are:
</p>

<ul>
<li> <p><code>"StreetInt"</code>
</p>
</li>
<li> <p><code>"DistanceMarker"</code>
</p>
</li>
<li> <p><code>"StreetAddress"</code>
</p>
</li>
<li> <p><code>"StreetName"</code>
</p>
</li>
<li> <p><code>"POI"</code>
</p>
</li>
<li> <p><code>"Subaddress"</code>
</p>
</li>
<li> <p><code>"PointAddress"</code>
</p>
</li>
<li> <p><code>"Postal"</code>
</p>
</li>
<li> <p><code>"Locality"</code>
</p>
</li></ul>

<p>It is also possible to use several values as a vector
(<code>featuretypes = c("PointAddress", "StreetAddress")</code>).
</p>


<h3>References</h3>

<p><a href="https://developers.arcgis.com/rest/geocode/api-reference/geocoding-reverse-geocode.htm">ArcGIS REST <code>reverseGeocode</code></a>.
</p>


<h3>See Also</h3>

<p><code><a href="tidygeocoder.html#topic+reverse_geo">tidygeocoder::reverse_geo()</a></code>
</p>
<p>Other functions for geocoding: 
<code><a href="#topic+arc_geo">arc_geo</a>()</code>,
<code><a href="#topic+arc_geo_categories">arc_geo_categories</a>()</code>,
<code><a href="#topic+arc_geo_multi">arc_geo_multi</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


arc_reverse_geo(x = -73.98586, y = 40.75728)

# Several coordinates
arc_reverse_geo(x = c(-73.98586, -3.188375), y = c(40.75728, 55.95335))

# With options: using some additional parameters
sev &lt;- arc_reverse_geo(
  x = c(-73.98586, -3.188375),
  y = c(40.75728, 55.95335),
  # Restrict to these feautures
  featuretypes = "POI,StreetInt",
  # Result on this WKID
  outsr = 102100,
  verbose = TRUE, full_results = TRUE
)

dplyr::glimpse(sev)


</code></pre>

<hr>
<h2 id='arc_spatial_references'>ESRI (ArcGIS) Spatial Reference data base</h2><span id='topic+arc_spatial_references'></span>

<h3>Description</h3>

<p>Database of available spatial references (CRS) in <code><a href="tibble.html#topic+tibble">tibble</a></code>
format.
</p>


<h3>Format</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble</a></code> with
9,364 rows
and fields:
</p>

<dl>
<dt>projtype</dt><dd><p>Projection type (<code style="white-space: pre;">&#8288;"ProjectedCoordinateSystems", "GeographicCoordinateSystems","VerticalCoordinateSystems"&#8288;</code>)</p>
</dd>
<dt>wkid</dt><dd><p>Well-Known ID</p>
</dd>
<dt>latestWkid</dt><dd><p>Most recent <code>wkid</code>, in case that <code>wkid</code> is deprecated</p>
</dd>
<dt>authority</dt><dd><p><code>wkid</code> authority (Esri or EPSG)</p>
</dd>
<dt>deprecated</dt><dd><p>Logical indicating if <code>wkid</code> is deprecated</p>
</dd>
<dt>description</dt><dd><p>Human-readable description of the <code>wkid</code></p>
</dd>
<dt>areaname</dt><dd><p>Use area of the <code>wkid</code></p>
</dd>
<dt>wkt</dt><dd><p>Representation of <code>wkid</code> in Well-Known Text (WKT). Useful when
working with <a href="https://CRAN.R-project.org/package=sf"><span class="pkg">sf</span></a> or <a href="https://CRAN.R-project.org/package=terra"><span class="pkg">terra</span></a></p>
</dd>
</dl>



<h3>Details</h3>

<p>This data base is useful when using the <code>outsr</code> parameter of the functions.
</p>
<p>Some projections ids have changed over time, for example Web Mercator is
<code>wkid  = 102100</code> is deprecated and currently is <code>wkid = 3857</code>. However, both
values would work, and they would return similar results.
</p>


<h3>Note</h3>

<p>Data extracted on <strong>14 January 2023</strong>.
</p>


<h3>Source</h3>

<p><a href="https://github.com/Esri/projection-engine-db-doc">ESRI Projection Engine factory</a>
</p>


<h3>See Also</h3>

<p><code><a href="sf.html#topic+st_crs">sf::st_crs()</a></code>
</p>
<p>Other datasets: 
<code><a href="#topic+arc_categories">arc_categories</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Get all possible valuesdata("arc_spatial_references")
arc_spatial_references

# Request with deprecated Web Mercator
library(dplyr)
wkid &lt;- arc_spatial_references %&gt;%
  filter(latestWkid == 3857 &amp; deprecated == TRUE) %&gt;%
  slice(1)

glimpse(wkid)

add &lt;- arc_geo("London, United Kingdom", outsr = wkid$wkid)

# Note values lat, lon and wkid. latestwkid give the current valid wkid
add %&gt;%
  select(lat, lon, wkid, latestWkid) %&gt;%
  glimpse()

# See with sf

try(sf::st_crs(wkid$wkid))

# But
try(sf::st_crs(wkid$latestWkid))

# or
try(sf::st_crs(wkid$wkt))


</code></pre>

<hr>
<h2 id='arcgeocoder_check_access'>Check access to ArcGIS REST</h2><span id='topic+arcgeocoder_check_access'></span>

<h3>Description</h3>

<p>Check if <strong>R</strong> has access to resources at ArcGIS REST API
<a href="https://developers.arcgis.com/rest/geocode/api-reference/overview-world-geocoding-service.htm">https://developers.arcgis.com/rest/geocode/api-reference/overview-world-geocoding-service.htm</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arcgeocoder_check_access()
</code></pre>


<h3>Value</h3>

<p>a logical.
</p>


<h3>See Also</h3>

<p>Other api_management: 
<code><a href="#topic+arc_api_call">arc_api_call</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
arcgeocoder_check_access()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
