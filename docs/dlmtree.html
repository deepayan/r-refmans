<!DOCTYPE html><html lang="en"><head><title>Help for package dlmtree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dlmtree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dlmtree-package'><p>dlmtree: Bayesian Treed Distributed Lag Models</p></a></li>
<li><a href='#adj_coexposure'><p>Adjusting for expected changes in co-exposure (TDLMM)</p></a></li>
<li><a href='#coExp'><p>Randomly sampled exposure from Colorado counties</p></a></li>
<li><a href='#combine.models'><p>Combines information from DLMs of single exposure</p></a></li>
<li><a href='#combine.models.tdlmm'><p>Combines information from DLMs of mixture exposures.</p></a></li>
<li><a href='#cppIntersection'><p>fast set intersection tool assumes sorted vectors A and B</p></a></li>
<li><a href='#dlmEst'><p>Calculates the distributed lag effect with DLM matrix for linear models.</p></a></li>
<li><a href='#dlmtree'><p>Fit tree structured distributed lag models</p></a></li>
<li><a href='#dlmtreeGPFixedGaussian'><p>dlmtree model with fixed Gaussian process approach</p></a></li>
<li><a href='#dlmtreeGPGaussian'><p>dlmtree model with Gaussian process approach</p></a></li>
<li><a href='#dlmtreeHDLMGaussian'><p>dlmtree model with shared HDLM approach</p></a></li>
<li><a href='#dlmtreeHDLMMGaussian'><p>dlmtree model with HDLMM approach</p></a></li>
<li><a href='#dlmtreeTDLM_cpp'><p>dlmtree model with nested HDLM approach</p></a></li>
<li><a href='#dlmtreeTDLMFixedGaussian'><p>dlmtree model with fixed Gaussian approach</p></a></li>
<li><a href='#dlmtreeTDLMNestedGaussian'><p>dlmtree model with nested Gaussian approach</p></a></li>
<li><a href='#dlnmEst'><p>Calculates the distributed lag effect with DLM matrix for non-linear models.</p></a></li>
<li><a href='#dlnmPLEst'><p>Calculates the distributed lag effect with DLM matrix for non-linear models.</p></a></li>
<li><a href='#drawTree'><p>Draws a new tree structure</p></a></li>
<li><a href='#estDLM'><p>Calculates subgroup-specific lag effects for heterogeneous models</p></a></li>
<li><a href='#exposureCov'><p>Exposure covariance structure</p></a></li>
<li><a href='#get_sbd_dlmtree'><p>Download simulated data for dlmtree articles</p></a></li>
<li><a href='#mixEst'><p>Calculates the lagged interaction effects with MIX matrix for linear models.</p></a></li>
<li><a href='#monotdlnm_Cpp'><p>dlmtree model with monotone tdlnm approach</p></a></li>
<li><a href='#pip'><p>Calculates posterior inclusion probabilities (PIPs) for modifiers in HDLM &amp; HDLMM</p></a></li>
<li><a href='#plot.summary.monotone'><p>Returns variety of plots for model summary of class 'monotone'</p></a></li>
<li><a href='#plot.summary.tdlm'><p>Plots a distributed lag function for model summary of 'tdlm'</p></a></li>
<li><a href='#plot.summary.tdlmm'><p>Plots DLMMs for model summary of class 'tdlmm'</p></a></li>
<li><a href='#plot.summary.tdlnm'><p>Returns variety of plots for model summary of class 'tdlnm'</p></a></li>
<li><a href='#pm25Exposures'><p>PM2.5 Exposure data</p></a></li>
<li><a href='#ppRange'><p>Makes a 'pretty' output of a group of numbers</p></a></li>
<li><a href='#predict.hdlm'><p>Calculates predicted response for HDLM</p></a></li>
<li><a href='#predict.hdlmm'><p>Calculates predicted response for HDLMM</p></a></li>
<li><a href='#print.hdlm'><p>Print a hdlm Object</p></a></li>
<li><a href='#print.hdlmm'><p>Print a hdlmm Object</p></a></li>
<li><a href='#print.monotone'><p>Print a monotone Object</p></a></li>
<li><a href='#print.summary.hdlm'><p>Prints an overview with summary of model class 'hdlm'</p></a></li>
<li><a href='#print.summary.hdlmm'><p>Prints an overview with summary of model class 'hdlmm'</p></a></li>
<li><a href='#print.summary.monotone'><p>Prints an overview with summary of model class 'monotone'</p></a></li>
<li><a href='#print.summary.tdlm'><p>Prints an overview with summary of model class 'tdlm'</p></a></li>
<li><a href='#print.summary.tdlmm'><p>Prints an overview with summary of model class 'tdlmm'</p></a></li>
<li><a href='#print.summary.tdlnm'><p>Prints an overview with summary of model class 'tdlnm'</p></a></li>
<li><a href='#print.tdlm'><p>Print a tdlm Object</p></a></li>
<li><a href='#print.tdlmm'><p>Print a tdlmm Object</p></a></li>
<li><a href='#print.tdlnm'><p>Print a tdlnm Object</p></a></li>
<li><a href='#rcpp_pgdraw'><p>Multiple draw polya gamma latent variable for var c[i] with size b[i]</p></a></li>
<li><a href='#rtmvnorm'><p>Truncated multivariate normal sampler, mean mu, cov sigma, truncated (0, Inf)</p></a></li>
<li><a href='#ruleIdx'><p>Calculates the weights for each modifier rule</p></a></li>
<li><a href='#scaleModelMatrix'><p>Centers and scales a matrix</p></a></li>
<li><a href='#shiny'><p>shiny</p></a></li>
<li><a href='#shiny.hdlm'><p>Executes a 'shiny' app for HDLM.</p></a></li>
<li><a href='#shiny.hdlmm'><p>Executes a 'shiny' app for HDLMM.</p></a></li>
<li><a href='#sim.hdlmm'><p>Creates simulated data for HDLM &amp; HDLMM</p></a></li>
<li><a href='#sim.tdlmm'><p>Creates simulated data for TDLM &amp; TDLMM</p></a></li>
<li><a href='#sim.tdlnm'><p>Creates simulated data for TDLNM</p></a></li>
<li><a href='#splitPIP'><p>Calculates the posterior inclusion probability (PIP).</p></a></li>
<li><a href='#splitpoints'><p>Determines split points for continuous modifiers</p></a></li>
<li><a href='#summary.hdlm'><p>Creates a summary object of class 'hdlm'</p></a></li>
<li><a href='#summary.hdlmm'><p>Creates a summary object of class 'hdlmm'</p></a></li>
<li><a href='#summary.monotone'><p>Creates a summary object of class 'monotone'</p></a></li>
<li><a href='#summary.tdlm'><p>Creates a summary object of class 'tdlm'</p></a></li>
<li><a href='#summary.tdlmm'><p>Creates a summary object of class 'tdlmm'</p></a></li>
<li><a href='#summary.tdlnm'><p>Creates a summary object of class 'tdlnm'</p></a></li>
<li><a href='#tdlmm'><p>Treed Distributed Lag Mixture Models (Deprecated)</p></a></li>
<li><a href='#tdlmm_Cpp'><p>dlmtree model with tdlmm approach</p></a></li>
<li><a href='#tdlnm'><p>Treed Distributed Lag Non-Linear Models (Deprecated)</p></a></li>
<li><a href='#tdlnm_Cpp'><p>dlmtree model with tdlnm approach</p></a></li>
<li><a href='#zeroToInfNormCDF'><p>Integrates (0,inf) over multivariate normal</p></a></li>
<li><a href='#zinbCo'><p>Time-series exposure data for ZINB simulated data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Treed Distributed Lag Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of distributed lag models (DLMs) based on a Bayesian additive regression trees framework. Includes several extensions of DLMs: treed DLMs and distributed lag mixture models (Mork and Wilson, 2023) &lt;<a href="https://doi.org/10.1111%2Fbiom.13568">doi:10.1111/biom.13568</a>&gt;; treed distributed lag nonlinear models (Mork and Wilson, 2022) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxaa051">doi:10.1093/biostatistics/kxaa051</a>&gt;; heterogeneous DLMs (Mork, et. al., 2024) &lt;<a href="https://doi.org/10.1080%2F01621459.2023.2258595">doi:10.1080/01621459.2023.2258595</a>&gt;; monotone DLMs (Mork and Wilson, 2024) &lt;<a href="https://doi.org/10.1214%2F23-BA1412">doi:10.1214/23-BA1412</a>&gt;. The package also includes visualization tools and a 'shiny' interface to help interpret results.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>false</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.4), dplyr, ggplot2, shiny, shinythemes, tidyr,
mgcv</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppEigen</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/danielmork/dlmtree">https://github.com/danielmork/dlmtree</a>,
<a href="https://danielmork.github.io/dlmtree/">https://danielmork.github.io/dlmtree/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/danielmork/dlmtree/issues">https://github.com/danielmork/dlmtree/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-28 12:51:47 UTC; dmork</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Mork <a href="https://orcid.org/0000-0002-7924-0706"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph],
  Seongwon Im <a href="https://orcid.org/0009-0000-8447-5852"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Ander Wilson <a href="https://orcid.org/0000-0003-4774-3883"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Mork &lt;dmork@hsph.harvard.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-31 13:50:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='dlmtree-package'>dlmtree: Bayesian Treed Distributed Lag Models</h2><span id='topic+dlmtree-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Estimation of distributed lag models (DLMs) based on a Bayesian additive regression trees framework. Includes several extensions of DLMs: treed DLMs and distributed lag mixture models (Mork and Wilson, 2023) <a href="https://doi.org/10.1111/biom.13568">doi:10.1111/biom.13568</a>; treed distributed lag nonlinear models (Mork and Wilson, 2022) <a href="https://doi.org/10.1093/biostatistics/kxaa051">doi:10.1093/biostatistics/kxaa051</a>; heterogeneous DLMs (Mork, et. al., 2024) <a href="https://doi.org/10.1080/01621459.2023.2258595">doi:10.1080/01621459.2023.2258595</a>; monotone DLMs (Mork and Wilson, 2024) <a href="https://doi.org/10.1214/23-BA1412">doi:10.1214/23-BA1412</a>. The package also includes visualization tools and a 'shiny' interface to help interpret results.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Daniel Mork <a href="mailto:dmork@hsph.harvard.edu">dmork@hsph.harvard.edu</a> (<a href="https://orcid.org/0000-0002-7924-0706">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Seongwon Im <a href="mailto:Seongwon.Im@colostate.edu">Seongwon.Im@colostate.edu</a> (<a href="https://orcid.org/0009-0000-8447-5852">ORCID</a>)
</p>
</li>
<li><p> Ander Wilson <a href="mailto:Ander.Wilson@colostate.edu">Ander.Wilson@colostate.edu</a> (<a href="https://orcid.org/0000-0003-4774-3883">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/danielmork/dlmtree">https://github.com/danielmork/dlmtree</a>
</p>
</li>
<li> <p><a href="https://danielmork.github.io/dlmtree/">https://danielmork.github.io/dlmtree/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/danielmork/dlmtree/issues">https://github.com/danielmork/dlmtree/issues</a>
</p>
</li></ul>


<hr>
<h2 id='adj_coexposure'>Adjusting for expected changes in co-exposure (TDLMM)</h2><span id='topic+adj_coexposure'></span>

<h3>Description</h3>

<p>Estimates the marginal effects of an exposure while accounting
for expected changes in co-occurring exposures at the same time point.
Values of co-occurring exposures are modeled nonlinearly using a spline
model with predictions made at the lower an upper values for the exposure
of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adj_coexposure(
  exposure.data,
  object,
  contrast_perc = c(0.25, 0.75),
  contrast_exp = list(),
  conf.level = 0.95,
  keep.mcmc = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adj_coexposure_+3A_exposure.data">exposure.data</code></td>
<td>
<p>Named list of exposure matrices used as input to TDLMM.</p>
</td></tr>
<tr><td><code id="adj_coexposure_+3A_object">object</code></td>
<td>
<p>Model output for TDLMM from dlmtree() function.</p>
</td></tr>
<tr><td><code id="adj_coexposure_+3A_contrast_perc">contrast_perc</code></td>
<td>
<p>2-length vector of percentiles or named list 
corresponding to lower and upper exposure percentiles of interest.
Names must equal list names in 'exposure.data'.</p>
</td></tr>
<tr><td><code id="adj_coexposure_+3A_contrast_exp">contrast_exp</code></td>
<td>
<p>Named list consisting lower and upper exposure values.
This takes precedence over contrast_perc if both inputs are used.</p>
</td></tr>
<tr><td><code id="adj_coexposure_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level used for estimating credible intervals.
Default is 0.95.</p>
</td></tr>
<tr><td><code id="adj_coexposure_+3A_keep.mcmc">keep.mcmc</code></td>
<td>
<p>If TRUE, return posterior samples.</p>
</td></tr>
<tr><td><code id="adj_coexposure_+3A_verbose">verbose</code></td>
<td>
<p>TRUE (default) or FALSE: print output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>adj_coexposure
</p>


<h3>Value</h3>

<p>data.frame of plot data with exposure name, posterior mean, and
credible intervals, or posterior samples if keep.mcmc = TRUE
</p>

<hr>
<h2 id='coExp'>Randomly sampled exposure from Colorado counties</h2><span id='topic+coExp'></span>

<h3>Description</h3>

<p>Matrix of five different exposures, each measured over 40 weeks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coExp)
</code></pre>


<h3>Format</h3>

<p>matrix
</p>


<h3>Source</h3>

<p><a href="https://aqs.epa.gov/aqsweb/airdata/download_files.html">https://aqs.epa.gov/aqsweb/airdata/download_files.html</a>
</p>


<h3>References</h3>

<p><a href="https://www.epa.gov/outdoor-air-quality-data">https://www.epa.gov/outdoor-air-quality-data</a>
</p>

<hr>
<h2 id='combine.models'>Combines information from DLMs of single exposure</h2><span id='topic+combine.models'></span>

<h3>Description</h3>

<p>Method for combining information from DLMs of single exposure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine.models(mlist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine.models_+3A_mlist">mlist</code></td>
<td>
<p>a list of models</p>
</td></tr>
</table>


<h3>Details</h3>

<p>combine.models
</p>


<h3>Value</h3>

<p>A data frame with model fit information of the models included in the list
</p>

<hr>
<h2 id='combine.models.tdlmm'>Combines information from DLMs of mixture exposures.</h2><span id='topic+combine.models.tdlmm'></span>

<h3>Description</h3>

<p>Method for combining information from DLMs of mixture exposures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine.models.tdlmm(mlist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine.models.tdlmm_+3A_mlist">mlist</code></td>
<td>
<p>a list of models</p>
</td></tr>
</table>


<h3>Details</h3>

<p>combine.models.tdlmm
</p>


<h3>Value</h3>

<p>A data frame with model fit information of the models included in the list
</p>

<hr>
<h2 id='cppIntersection'>fast set intersection tool assumes sorted vectors A and B</h2><span id='topic+cppIntersection'></span>

<h3>Description</h3>

<p>fast set intersection tool assumes sorted vectors A and B
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cppIntersection(A, B)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cppIntersection_+3A_a">A</code></td>
<td>
<p>sorted integer vector A</p>
</td></tr>
<tr><td><code id="cppIntersection_+3A_b">B</code></td>
<td>
<p>sorted integer vector B</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of resulting intersection
</p>

<hr>
<h2 id='dlmEst'>Calculates the distributed lag effect with DLM matrix for linear models.</h2><span id='topic+dlmEst'></span>

<h3>Description</h3>

<p>Calculates the distributed lag effect with DLM matrix for linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmEst(dlm, nlags, nsamp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlmEst_+3A_dlm">dlm</code></td>
<td>
<p>A numeric matrix containing the model fit information</p>
</td></tr>
<tr><td><code id="dlmEst_+3A_nlags">nlags</code></td>
<td>
<p>total number of lags</p>
</td></tr>
<tr><td><code id="dlmEst_+3A_nsamp">nsamp</code></td>
<td>
<p>number of mcmc iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A cube object of lag effect x lag x mcmc
</p>

<hr>
<h2 id='dlmtree'>Fit tree structured distributed lag models</h2><span id='topic+dlmtree'></span>

<h3>Description</h3>

<p>The 'dlmtree' function accommodates various response variable types, including continuous, binary, and zero-inflated count values.
The function is designed to handle both single exposure and exposure mixtures. For a single exposure, users are offered options to model non-linear effects (tdlnm),
linear effects (tdlm), or heterogeneous subgroup/individualized effects (hdlm). In the case of exposure mixtures, the function supports
lagged interactions (tdlmm), and heterogeneous subgroup/individualized effects (hdlmm) allowing for a comprehensive exploration of mixture exposure heterogeneity.
Additionally, users can fine-tune parameters to impose effect shrinkage and perform exposure selection, enhancing the adaptability and precision of the modeling process.
For more detailed documentation, visit: <a href="https://danielmork.github.io/dlmtree/">dlmtree website</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmtree(
  formula,
  data,
  exposure.data,
  dlm.type = "linear",
  family = "gaussian",
  mixture = FALSE,
  het = FALSE,
  n.trees = 20,
  n.burn = 1000,
  n.iter = 2000,
  n.thin = 2,
  shrinkage = "all",
  dlmtree.params = c(0.95, 2),
  dlmtree.step.prob = c(0.25, 0.25),
  binomial.size = 1,
  formula.zi = NULL,
  tdlnm.exposure.splits = 20,
  tdlnm.time.split.prob = NULL,
  tdlnm.exposure.se = NULL,
  hdlm.modifiers = "all",
  hdlm.modifier.splits = 20,
  hdlm.modtree.params = c(0.95, 2),
  hdlm.modtree.step.prob = c(0.25, 0.25, 0.25),
  hdlm.dlmtree.type = "shared",
  hdlm.selection.prior = 0.5,
  mixture.interactions = "noself",
  mixture.prior = 1,
  monotone.gamma0 = NULL,
  monotone.sigma = NULL,
  monotone.tree.time.params = c(0.95, 2),
  monotone.tree.exp.params = c(0.95, 2),
  monotone.time.kappa = NULL,
  subset = NULL,
  lowmem = FALSE,
  verbose = TRUE,
  save.data = TRUE,
  diagnostics = FALSE,
  initial.params = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlmtree_+3A_formula">formula</code></td>
<td>
<p>object of class formula, a symbolic description of the fixed
effect model to be fitted, e.g. y ~ a + b.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_data">data</code></td>
<td>
<p>data frame containing variables used in the formula.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_exposure.data">exposure.data</code></td>
<td>
<p>numerical matrix of exposure data with same length as data, for a mixture setting (tdlmm, hdlmm):
named list containing equally sized numerical matrices of exposure data having same length as data.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_dlm.type">dlm.type</code></td>
<td>
<p>dlm model specification: &quot;linear&quot; (default), &quot;nonlinear&quot;, &quot;monotone&quot;.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_family">family</code></td>
<td>
<p>'gaussian' for continuous response, 'logit' for binomial, 'zinb' for zero-inflated negative binomial.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_mixture">mixture</code></td>
<td>
<p>flag for mixture, set to TRUE for tdlmm and hdlmm. (default: FALSE)</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_het">het</code></td>
<td>
<p>flag for heterogeneity, set to TRUE for hdlm and hdlmm. (default: FALSE)</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_n.trees">n.trees</code></td>
<td>
<p>integer for number of trees in ensemble.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_n.burn">n.burn</code></td>
<td>
<p>integer for length of MCMC burn-in.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_n.iter">n.iter</code></td>
<td>
<p>integer for number of MCMC iterations to run model after burn-in.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_n.thin">n.thin</code></td>
<td>
<p>integer MCMC thinning factor, i.e. keep every tenth iteration.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_shrinkage">shrinkage</code></td>
<td>
<p>character &quot;all&quot; (default), &quot;trees&quot;, &quot;exposures&quot;, &quot;none&quot;,
turns on horseshoe-like shrinkage priors for different parts of model.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_dlmtree.params">dlmtree.params</code></td>
<td>
<p>numerical vector of alpha and beta hyperparameters
controlling dlm tree depth. (default: alpha = 0.95, beta = 2)</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_dlmtree.step.prob">dlmtree.step.prob</code></td>
<td>
<p>numerical vector for probability of each step for dlm tree updates: 1) grow/prune,
2) change, 3) switch exposure. (default: c(0.25, 0.25, 0.25))</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_binomial.size">binomial.size</code></td>
<td>
<p>integer type scalar (if all equal, default: 1) or
vector defining binomial size for 'logit' family.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_formula.zi">formula.zi</code></td>
<td>
<p>(only applies to family = 'zinb') object of class formula, a symbolic description of the fixed effect of
zero-inflated (ZI) model to be fitted, e.g. y ~ a + b. This only applies to ZINB where covariates for
ZI model are different from NB model. This is set to the argument 'formula' by default.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_tdlnm.exposure.splits">tdlnm.exposure.splits</code></td>
<td>
<p>scalar indicating the number of splits (divided
evenly across quantiles of the exposure data) or list with two components:
'type' = 'values' or 'quantiles', and 'split.vals' = a numerical
vector indicating the corresponding exposure values or quantiles for splits.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_tdlnm.time.split.prob">tdlnm.time.split.prob</code></td>
<td>
<p>probability vector of a spliting probabilities for time lags. (default: uniform probabilities)</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_tdlnm.exposure.se">tdlnm.exposure.se</code></td>
<td>
<p>numerical matrix of exposure standard errors with same
size as exposure.data or a scalar smoothing factor representing a uniform
smoothing factor applied to each exposure measurement. (default: sd(exposure.data)/2)</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_hdlm.modifiers">hdlm.modifiers</code></td>
<td>
<p>string vector containing desired modifiers to be included in a modifier tree.
The strings in the vector must match the names of the columns of the data.
By default, a modifier tree considers all covariates in the formula as modifiers unless stated otherwise.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_hdlm.modifier.splits">hdlm.modifier.splits</code></td>
<td>
<p>integer value to determine the possible number of splitting points that will be used for a modifier tree.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_hdlm.modtree.params">hdlm.modtree.params</code></td>
<td>
<p>numerical vector of alpha and beta hyperparameters
controlling modifier tree depth. (default: alpha = 0.95, beta = 2)</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_hdlm.modtree.step.prob">hdlm.modtree.step.prob</code></td>
<td>
<p>numerical vector for probability of each step for modifier tree updates: 1) grow, 2) prune,
3) change. (default: c(0.25, 0.25, 0.25))</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_hdlm.dlmtree.type">hdlm.dlmtree.type</code></td>
<td>
<p>specification of dlmtree type for HDLM: shared (default) or nested.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_hdlm.selection.prior">hdlm.selection.prior</code></td>
<td>
<p>scalar hyperparameter for sparsity of modifiers. Must be between 0.5 and 1.
Smaller value corresponds to increased sparsity of modifiers.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_mixture.interactions">mixture.interactions</code></td>
<td>
<p>'noself' (default) which estimates interactions only between two
different exposures, 'all' which also allows interactions within the same exposure, or 'none'
which eliminates all interactions and estimates only main effects of each exposure.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_mixture.prior">mixture.prior</code></td>
<td>
<p>positive scalar hyperparameter for sparsity of exposures. (default: 1)</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_monotone.gamma0">monotone.gamma0</code></td>
<td>
<p>vector (with length equal to number of lags) of means for logit-transformed prior probability of split at each lag;
e.g., gamma_0l = 0 implies mean prior probability of split at lag l = 0.5.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_monotone.sigma">monotone.sigma</code></td>
<td>
<p>symmetric matrix (usually with only diagonal elements) corresponding to gamma_0 to define variances on prior probability of split;
e.g., gamma_0l = 0 with lth diagonal element of sigma=2.701 implies that 95% of the time the prior probability of split is between 0.005 and 0.995,
as a second example setting gamma_0l=4.119 and the corresponding diagonal element of sigma=0.599 implies that 95% of the time the prior probability of a split is between 0.8 and 0.99.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_monotone.tree.time.params">monotone.tree.time.params</code></td>
<td>
<p>numerical vector of hyperparameters for monotone time tree.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_monotone.tree.exp.params">monotone.tree.exp.params</code></td>
<td>
<p>numerical vector of hyperparameters for monotone exposure tree.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_monotone.time.kappa">monotone.time.kappa</code></td>
<td>
<p>scaling factor in dirichlet prior that goes alongside <code>tdlnm.time.split.prob</code> to
control the amount of prior information given to the model for deciding probabilities of splits between adjacent lags.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_subset">subset</code></td>
<td>
<p>integer vector to analyze only a subset of data and exposures.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_lowmem">lowmem</code></td>
<td>
<p>TRUE or FALSE (default): turn on memory saver for DLNM, slower computation time.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_verbose">verbose</code></td>
<td>
<p>TRUE (default) or FALSE: print output</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_save.data">save.data</code></td>
<td>
<p>TRUE (default) or FALSE: save data used for model fitting. This must be set to TRUE to use shiny() function on hdlm or hdlmm</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_diagnostics">diagnostics</code></td>
<td>
<p>TRUE or FALSE (default) keep model diagnostic such as the number of
terminal nodes and acceptance ratio.</p>
</td></tr>
<tr><td><code id="dlmtree_+3A_initial.params">initial.params</code></td>
<td>
<p>initial parameters for fixed effects model, FALSE = none (default),
&quot;glm&quot; = generate using GLM, or user defined, length must equal number of parameters in fixed effects model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>dlmtree
</p>
<p>Model is recommended to be run for at minimum 5000 burn-in
iterations followed by 15000 sampling iterations with a thinning factor of 5.
Convergence can be checked by re-running the model and validating consistency
of results. Examples are provided below for the syntax for running different types of models.
For more examples, visit: <a href="https://danielmork.github.io/dlmtree/">dlmtree website</a>.
</p>


<h3>Value</h3>

<p>Object of one of the classes: tdlm, tdlmm, tdlnm, hdlm, hdlmm
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  # The first three examples are for one lagged exposure


  # treed distributed lag model (TDLM)
  # binary outcome with logit link

  D &lt;- sim.tdlmm(sim = "A", mean.p = 0.5, n = 1000)
  tdlm.fit &lt;- dlmtree(y ~ .,
                      data = D$dat,
                      exposure.data = D$exposures[[1]],
                      dlm.type = "linear",
                      family = "logit",
                      binomial.size = 1)

  # summarize results
  tdlm.sum &lt;- summary(tdlm.fit)
  tdlm.sum

  # plot results
  plot(tdlm.sum)



  # Treed distributed lag nonlinear model (TDLNM)
  # Gaussian regression model
  D &lt;- sim.tdlnm(sim = "A", error.to.signal = 1)
  tdlnm.fit &lt;- dlmtree(formula = y ~ .,
                       data = D$dat,
                       exposure.data = D$exposures,
                       dlm.type = "nonlinear",
                       family = "gaussian")

  # summarize results
  tdlnm.sum &lt;- summary(tdlnm.fit)
  tdlnm.sum

  # plot results
  plot(tdlnm.sum)



  # Heterogenious TDLM (HDLM), similar to first example but with heterogenious exposure response
  D &lt;- sim.hdlmm(sim = "B", n = 1000)
  hdlm.fit &lt;- dlmtree(y ~ .,
                      data = D$dat,
                      exposure.data = D$exposures,
                      dlm.type = "linear",
                      family = "gaussian",
                      het = TRUE)

  # summarize results
  hdlm.sum &lt;- summary(hdlm.fit)
  hdlm.sum

  # shiny app for HDLM
  if (interactive()) {
    shiny(hdlm.fit)
  }



  # The next two examples are for a mixture (or multivariate) exposure


  # Treed distributed lag mixture model (TDLMM)
  # Model for mixutre (or multivariate) lagged exposures
  # with a homogenious exposure-time-response function
  D &lt;- sim.tdlmm(sim = "B", error = 25, n = 1000)
  tdlmm.fit &lt;- dlmtree(y ~ .,
                       data = D$dat, exposure.data = D$exposures,
                       mixture.interactions = "noself",
                       dlm.type = "linear", family = "gaussian",
                       mixture = TRUE)

  # summarize results
  tdlmm.sum &lt;- summary(tdlmm.fit)

  # plot the marginal exposure-response for one exposure
  plot(tdlmm.sum, exposure1 = "e1")

  # plot exposure-response surface
  plot(tdlmm.sum, exposure1 = "e1", exposure2 = "e2")



  # heterogenious version of TDLMM
  D &lt;- sim.hdlmm(sim = "D", n = 1000)
  hdlmm.fit &lt;- dlmtree(y ~ .,
                       data = D$dat,
                       exposure.data = D$exposures,
                       dlm.type = "linear",
                       family = "gaussian",
                       mixture = TRUE,
                       het = TRUE)

  # summarize results
  hdlmm.sum &lt;- summary(hdlmm.fit)
  hdlmm.sum

  # summarize results
  if (interactive()) {
    shiny(hdlmm.fit)
  }



</code></pre>

<hr>
<h2 id='dlmtreeGPFixedGaussian'>dlmtree model with fixed Gaussian process approach</h2><span id='topic+dlmtreeGPFixedGaussian'></span>

<h3>Description</h3>

<p>dlmtree model with fixed Gaussian process approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmtreeGPFixedGaussian(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlmtreeGPFixedGaussian_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='dlmtreeGPGaussian'>dlmtree model with Gaussian process approach</h2><span id='topic+dlmtreeGPGaussian'></span>

<h3>Description</h3>

<p>dlmtree model with Gaussian process approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmtreeGPGaussian(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlmtreeGPGaussian_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='dlmtreeHDLMGaussian'>dlmtree model with shared HDLM approach</h2><span id='topic+dlmtreeHDLMGaussian'></span>

<h3>Description</h3>

<p>dlmtree model with shared HDLM approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmtreeHDLMGaussian(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlmtreeHDLMGaussian_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='dlmtreeHDLMMGaussian'>dlmtree model with HDLMM approach</h2><span id='topic+dlmtreeHDLMMGaussian'></span>

<h3>Description</h3>

<p>dlmtree model with HDLMM approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmtreeHDLMMGaussian(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlmtreeHDLMMGaussian_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='dlmtreeTDLM_cpp'>dlmtree model with nested HDLM approach</h2><span id='topic+dlmtreeTDLM_cpp'></span>

<h3>Description</h3>

<p>dlmtree model with nested HDLM approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmtreeTDLM_cpp(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlmtreeTDLM_cpp_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='dlmtreeTDLMFixedGaussian'>dlmtree model with fixed Gaussian approach</h2><span id='topic+dlmtreeTDLMFixedGaussian'></span>

<h3>Description</h3>

<p>dlmtree model with fixed Gaussian approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmtreeTDLMFixedGaussian(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlmtreeTDLMFixedGaussian_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='dlmtreeTDLMNestedGaussian'>dlmtree model with nested Gaussian approach</h2><span id='topic+dlmtreeTDLMNestedGaussian'></span>

<h3>Description</h3>

<p>dlmtree model with nested Gaussian approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmtreeTDLMNestedGaussian(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlmtreeTDLMNestedGaussian_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='dlnmEst'>Calculates the distributed lag effect with DLM matrix for non-linear models.</h2><span id='topic+dlnmEst'></span>

<h3>Description</h3>

<p>Calculates the distributed lag effect with DLM matrix for non-linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlnmEst(dlnm, predAt, nlags, nsamp, center, se)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlnmEst_+3A_dlnm">dlnm</code></td>
<td>
<p>A numeric matrix containing the model fit information</p>
</td></tr>
<tr><td><code id="dlnmEst_+3A_predat">predAt</code></td>
<td>
<p>Number of splits in the model</p>
</td></tr>
<tr><td><code id="dlnmEst_+3A_nlags">nlags</code></td>
<td>
<p>total number of lags</p>
</td></tr>
<tr><td><code id="dlnmEst_+3A_nsamp">nsamp</code></td>
<td>
<p>number of mcmc iterations</p>
</td></tr>
<tr><td><code id="dlnmEst_+3A_center">center</code></td>
<td>
<p>center parameter</p>
</td></tr>
<tr><td><code id="dlnmEst_+3A_se">se</code></td>
<td>
<p>Standard error parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A cube object of lag effect x lag x mcmc
</p>

<hr>
<h2 id='dlnmPLEst'>Calculates the distributed lag effect with DLM matrix for non-linear models.</h2><span id='topic+dlnmPLEst'></span>

<h3>Description</h3>

<p>Calculates the distributed lag effect with DLM matrix for non-linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlnmPLEst(dlnm, predAt, nlags, nsamp, center)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlnmPLEst_+3A_dlnm">dlnm</code></td>
<td>
<p>A numeric matrix containing the model fit information</p>
</td></tr>
<tr><td><code id="dlnmPLEst_+3A_predat">predAt</code></td>
<td>
<p>Number of splits in the model</p>
</td></tr>
<tr><td><code id="dlnmPLEst_+3A_nlags">nlags</code></td>
<td>
<p>total number of lags</p>
</td></tr>
<tr><td><code id="dlnmPLEst_+3A_nsamp">nsamp</code></td>
<td>
<p>number of mcmc iterations</p>
</td></tr>
<tr><td><code id="dlnmPLEst_+3A_center">center</code></td>
<td>
<p>center parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A cube object of lag effect x lag x mcmc
</p>

<hr>
<h2 id='drawTree'>Draws a new tree structure</h2><span id='topic+drawTree'></span>

<h3>Description</h3>

<p>A recursive method for drawing a new tree structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawTree(depth, alpha, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="drawTree_+3A_depth">depth</code></td>
<td>
<p>depth of a tree</p>
</td></tr>
<tr><td><code id="drawTree_+3A_alpha">alpha</code></td>
<td>
<p>tree shape parameter, 0 &lt; alpha &lt; 1</p>
</td></tr>
<tr><td><code id="drawTree_+3A_beta">beta</code></td>
<td>
<p>tree size parameter, beta &gt; 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>drawTree
</p>


<h3>Value</h3>

<p>A integer value of number of terminal nodes
</p>

<hr>
<h2 id='estDLM'>Calculates subgroup-specific lag effects for heterogeneous models</h2><span id='topic+estDLM'></span>

<h3>Description</h3>

<p>Method for calculating subgroup-specific lag effects for heterogeneous models: HDLM, HDLMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estDLM(
  object,
  new.data,
  group.index,
  conf.level = 0.95,
  exposure = NULL,
  return.mcmc = FALSE,
  mem.safe = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estDLM_+3A_object">object</code></td>
<td>
<p>an object of a model fit. Must be 'hdlm' or 'hdlmm'</p>
</td></tr>
<tr><td><code id="estDLM_+3A_new.data">new.data</code></td>
<td>
<p>a data frame with new observations with the same number of modifiers</p>
</td></tr>
<tr><td><code id="estDLM_+3A_group.index">group.index</code></td>
<td>
<p>a list of index (row numbers) for subgroup specification</p>
</td></tr>
<tr><td><code id="estDLM_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for credible interval of effects</p>
</td></tr>
<tr><td><code id="estDLM_+3A_exposure">exposure</code></td>
<td>
<p>exposure of interest for 'hdlmm' method</p>
</td></tr>
<tr><td><code id="estDLM_+3A_return.mcmc">return.mcmc</code></td>
<td>
<p>store mcmc in the output</p>
</td></tr>
<tr><td><code id="estDLM_+3A_mem.safe">mem.safe</code></td>
<td>
<p>boolean memory parameter for rule index</p>
</td></tr>
<tr><td><code id="estDLM_+3A_verbose">verbose</code></td>
<td>
<p>TRUE (default) or FALSE: print output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>estDLM
</p>


<h3>Value</h3>

<p>A list of distributed lag effects per subgroups
</p>

<hr>
<h2 id='exposureCov'>Exposure covariance structure</h2><span id='topic+exposureCov'></span>

<h3>Description</h3>

<p>Matrix containing pairwise covariances for real exposure data
consisting of five different exposures, each measured over 37 weeks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exposureCov)
</code></pre>


<h3>Format</h3>

<p>matrix
</p>


<h3>Source</h3>

<p><a href="https://aqs.epa.gov/aqsweb/airdata/download_files.html">https://aqs.epa.gov/aqsweb/airdata/download_files.html</a>
</p>


<h3>References</h3>

<p><a href="https://www.epa.gov/outdoor-air-quality-data">https://www.epa.gov/outdoor-air-quality-data</a>
</p>

<hr>
<h2 id='get_sbd_dlmtree'>Download simulated data for dlmtree articles</h2><span id='topic+get_sbd_dlmtree'></span>

<h3>Description</h3>

<p>Download simulated data for dlmtree articles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sbd_dlmtree()
</code></pre>


<h3>Value</h3>

<p>A data frame with 10000 rows (observations) and 202 variables. All data is simulated. The variables are:
</p>
<table role = "presentation">
<tr><td><code>bwgaz</code></td>
<td>
<p>Outcome to be used. Simulated birth weight for gestational age z-score.</p>
</td></tr>
<tr><td><code>ChildSex</code></td>
<td>
<p>Binary sex of child.</p>
</td></tr>
<tr><td><code>MomAge</code></td>
<td>
<p>Continuous age in years.</p>
</td></tr>
<tr><td><code>GestAge</code></td>
<td>
<p>Continuous estimated gestational age at birth in weeks.</p>
</td></tr>
<tr><td><code>MomHeightIn</code></td>
<td>
<p>Continuous maternal height in inches.</p>
</td></tr>
<tr><td><code>MomPriorWeightLbs</code></td>
<td>
<p>Continuous mothers pre-pregnancy weight in pounds.</p>
</td></tr>
<tr><td><code>MomPriorBMI</code></td>
<td>
<p>Continuous mothers pre-pregnancy BMI.</p>
</td></tr>
<tr><td><code>race</code></td>
<td>
<p>Categorical race.</p>
</td></tr>
<tr><td><code>Hispanic</code></td>
<td>
<p>Binary indicator of Hispanic.</p>
</td></tr>
<tr><td><code>MomEdu</code></td>
<td>
<p>Categorical maternal highest educational attainment.</p>
</td></tr>
<tr><td><code>SmkAny</code></td>
<td>
<p>Binary indicator of any smoking during pregnancy.</p>
</td></tr>
<tr><td><code>Marital</code></td>
<td>
<p>Categorical maternal marital status.</p>
</td></tr>
<tr><td><code>Income</code></td>
<td>
<p>Categorical income.</p>
</td></tr>
<tr><td><code>EstDateConcept</code></td>
<td>
<p>Estimated date of conception.</p>
</td></tr>
<tr><td><code>EstMonthConcept</code></td>
<td>
<p>Estimated month of conception.</p>
</td></tr>
<tr><td><code>EstYearConcept</code></td>
<td>
<p>Estimated year of conception.</p>
</td></tr>
<tr><td><code>pm25_1 - pm25_37</code></td>
<td>
<p>Weekly average exposure to PM2.5 for weeks 1 to 37.</p>
</td></tr>
<tr><td><code>no2_1 - no2_37</code></td>
<td>
<p>Weekly average exposure to NO2 for weeks 1 to 37.</p>
</td></tr>
<tr><td><code>so2_1 - so2_37</code></td>
<td>
<p>Weekly average exposure to SO2 for weeks 1 to 37.</p>
</td></tr>
<tr><td><code>co2_1 - co2_37</code></td>
<td>
<p>Weekly average exposure to CO for weeks 1 to 37.</p>
</td></tr>
<tr><td><code>temp_1 - temp_37</code></td>
<td>
<p>Weekly average exposure to temperature for weeks 1 to 37.</p>
</td></tr>
<tr><td><code>source</code></td>
<td>
<p>Variable indicating that the data came from the bdlim package.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>sbd_dlmtree &lt;- get_sbd_dlmtree()


</code></pre>

<hr>
<h2 id='mixEst'>Calculates the lagged interaction effects with MIX matrix for linear models.</h2><span id='topic+mixEst'></span>

<h3>Description</h3>

<p>Calculates the lagged interaction effects with MIX matrix for linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixEst(dlm, nlags, nsamp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mixEst_+3A_dlm">dlm</code></td>
<td>
<p>A numeric matrix containing the model fit information</p>
</td></tr>
<tr><td><code id="mixEst_+3A_nlags">nlags</code></td>
<td>
<p>total number of lags</p>
</td></tr>
<tr><td><code id="mixEst_+3A_nsamp">nsamp</code></td>
<td>
<p>number of mcmc iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A cube object of interaction effect x lag x mcmc
</p>

<hr>
<h2 id='monotdlnm_Cpp'>dlmtree model with monotone tdlnm approach</h2><span id='topic+monotdlnm_Cpp'></span>

<h3>Description</h3>

<p>dlmtree model with monotone tdlnm approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monotdlnm_Cpp(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monotdlnm_Cpp_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='pip'>Calculates posterior inclusion probabilities (PIPs) for modifiers in HDLM &amp; HDLMM</h2><span id='topic+pip'></span>

<h3>Description</h3>

<p>Method for calculating posterior inclusion probabilities (PIPs) for modifiers in HDLM &amp; HDLMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pip(object, type = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pip_+3A_object">object</code></td>
<td>
<p>An object of class dlmtree.</p>
</td></tr>
<tr><td><code id="pip_+3A_type">type</code></td>
<td>
<p>Type=1 indicates single modifier PIPs. Type=2 indicates joint modifier PIPs for two modifiers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>pip
</p>


<h3>Value</h3>

<p>A vector (type=1) or data.frame (type=2) of PIPs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Posterior inclusion probability with HDLM 
D &lt;- sim.hdlmm(sim = "B", n = 1000)
fit &lt;- dlmtree(y ~ ., 
               data = D$dat,
               exposure.data = D$exposures,
               dlm.type = "linear",
               family = "gaussian",
               het = TRUE)
pip(fit)
pip(fit, type = 2)


</code></pre>

<hr>
<h2 id='plot.summary.monotone'>Returns variety of plots for model summary of class 'monotone'</h2><span id='topic+plot.summary.monotone'></span>

<h3>Description</h3>

<p>Method for returning variety of plots for model summary of class 'monotone'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.monotone'
plot(x, plot.type = "mean", val = c(), time = c(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.summary.monotone_+3A_x">x</code></td>
<td>
<p>object of class 'summary.monotone', output of summary of 'monotone'</p>
</td></tr>
<tr><td><code id="plot.summary.monotone_+3A_plot.type">plot.type</code></td>
<td>
<p>string indicating plot type, options are 'mean' (default)
which shows mean exposure-time response surface, 'se', 'ci-min', 'ci-max',
'slice' which takes a slice of the plot at a given 'val' or 'time',
'animate' which creates a animation of slices of the surface plot across
exposure values (requires package gganimate)</p>
</td></tr>
<tr><td><code id="plot.summary.monotone_+3A_val">val</code></td>
<td>
<p>exposure value for slice plot</p>
</td></tr>
<tr><td><code id="plot.summary.monotone_+3A_time">time</code></td>
<td>
<p>time value for slice plot</p>
</td></tr>
<tr><td><code id="plot.summary.monotone_+3A_...">...</code></td>
<td>
<p>additional parameters to alter plots: 'main', 'xlab', 'ylab',
'flab' which sets the effect label for surface plots,
'start.time' which sets the first time value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.summary.monotone
</p>


<h3>Value</h3>

<p>A plot of distributed lag effect estimated with monotone-TDLNM
</p>

<hr>
<h2 id='plot.summary.tdlm'>Plots a distributed lag function for model summary of 'tdlm'</h2><span id='topic+plot.summary.tdlm'></span>

<h3>Description</h3>

<p>Method for plotting a distributed lag function for model summary of 'tdlm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.tdlm'
plot(x, trueDLM = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.summary.tdlm_+3A_x">x</code></td>
<td>
<p>object of class 'summary.tdlm', output of summary of 'tdlm'</p>
</td></tr>
<tr><td><code id="plot.summary.tdlm_+3A_truedlm">trueDLM</code></td>
<td>
<p>A vector of true effects that can be obtained from the simulated data. Only applicable for simulation studies</p>
</td></tr>
<tr><td><code id="plot.summary.tdlm_+3A_...">...</code></td>
<td>
<p>additional plotting parameters for title and labels
'start.time' which sets the first time value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.summary.tdlm
</p>


<h3>Value</h3>

<p>A plot of distributed lag effect estimated with tdlm
</p>

<hr>
<h2 id='plot.summary.tdlmm'>Plots DLMMs for model summary of class 'tdlmm'</h2><span id='topic+plot.summary.tdlmm'></span>

<h3>Description</h3>

<p>Method for plotting DLMMs for model summary of class 'tdlmm'. Includes plots
for marginal exposure effects as well as interactions between two exposures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.tdlmm'
plot(
  x,
  type = "marginal",
  exposure1 = NULL,
  exposure2 = NULL,
  time1 = c(),
  time2 = c(),
  show.cw = TRUE,
  cw.plots.only = TRUE,
  trueDLM = NULL,
  scale = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.summary.tdlmm_+3A_x">x</code></td>
<td>
<p>an object of type 'summary.tdlmm' from summary.tdlmm() output</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_type">type</code></td>
<td>
<p>plot type, 'marginal' (default)</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_exposure1">exposure1</code></td>
<td>
<p>exposure for plotting DLM</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_exposure2">exposure2</code></td>
<td>
<p>exposure paired with 'exposure1' for plotting interaction</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_time1">time1</code></td>
<td>
<p>plot a cross section from an interaction plot at specific time for 'exposure1'</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_time2">time2</code></td>
<td>
<p>plot a cross section from an interaction plot at specific time for 'exposure2'</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_show.cw">show.cw</code></td>
<td>
<p>indicate location of critical windows in interaction plot with red points</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_cw.plots.only">cw.plots.only</code></td>
<td>
<p>show only plots with critical windows</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_truedlm">trueDLM</code></td>
<td>
<p>A vector of true effects that can be obtained from the simulated data. Only applicable for simulation studies</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_scale">scale</code></td>
<td>
<p>default = NULL, if scale is not NULL, the effects are exponentiated</p>
</td></tr>
<tr><td><code id="plot.summary.tdlmm_+3A_...">...</code></td>
<td>
<p>additional plotting parameters for title and labels</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.summary.tdlmm
</p>


<h3>Value</h3>

<p>A plot of distributed lag effect or interaction surface estimated with tdlmm
</p>

<hr>
<h2 id='plot.summary.tdlnm'>Returns variety of plots for model summary of class 'tdlnm'</h2><span id='topic+plot.summary.tdlnm'></span>

<h3>Description</h3>

<p>Method for returning variety of plots for model summary of class 'tdlnm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.tdlnm'
plot(x, plot.type = "mean", val = c(), time = c(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.summary.tdlnm_+3A_x">x</code></td>
<td>
<p>object of class 'summary.tdlnm', output of summary of 'tdlnm'</p>
</td></tr>
<tr><td><code id="plot.summary.tdlnm_+3A_plot.type">plot.type</code></td>
<td>
<p>string indicating plot type, options are 'mean' (default)
which shows mean exposure-time response surface, 'se', 'ci-min', 'ci-max',
'slice' which takes a slice of the plot at a given 'val' or 'time',
'animate' which creates a animation of slices of the surface plot across
exposure values (requires package gganimate)</p>
</td></tr>
<tr><td><code id="plot.summary.tdlnm_+3A_val">val</code></td>
<td>
<p>exposure value for slice plot</p>
</td></tr>
<tr><td><code id="plot.summary.tdlnm_+3A_time">time</code></td>
<td>
<p>time value for slice plot</p>
</td></tr>
<tr><td><code id="plot.summary.tdlnm_+3A_...">...</code></td>
<td>
<p>additional plotting parameters for title and labels
'flab' which sets the effect label for surface plots,
'start.time' which sets the first time value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.summary.tdlnm
</p>


<h3>Value</h3>

<p>A plot of distributed lag effect estimated with tdlnm
</p>

<hr>
<h2 id='pm25Exposures'>PM2.5 Exposure data</h2><span id='topic+pm25Exposures'></span>

<h3>Description</h3>

<p>Data.frame containing a sample of weekly average PM2.5 exposures
across a range of states/counties. The PM2.5 data was downloaded from US EPA
(https://aqs.epa.gov/aqsweb/airdata/download_files.html) daily data summaries
and averaged by week. Forty-week ranges were assess for non-missingness
and grouped for this dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pm25Exposures)
</code></pre>


<h3>Format</h3>

<p>data.frame; columns: S = state, C = city, 1-40 = weekly exposure data
</p>


<h3>Source</h3>

<p><a href="https://aqs.epa.gov/aqsweb/airdata/download_files.html">https://aqs.epa.gov/aqsweb/airdata/download_files.html</a>
</p>


<h3>References</h3>

<p><a href="https://www.epa.gov/outdoor-air-quality-data">https://www.epa.gov/outdoor-air-quality-data</a>
</p>

<hr>
<h2 id='ppRange'>Makes a 'pretty' output of a group of numbers</h2><span id='topic+ppRange'></span>

<h3>Description</h3>

<p>Method for making a 'pretty' output of a group of numbers. For
example: 2,3,4,5,8,9,12,15,16 becomes 2-5,8-9,12,15-16
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppRange(r)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppRange_+3A_r">r</code></td>
<td>
<p>set of integers to make 'pretty'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ppRange
</p>


<h3>Value</h3>

<p>character string of values representing 'r'
</p>

<hr>
<h2 id='predict.hdlm'>Calculates predicted response for HDLM</h2><span id='topic+predict.hdlm'></span>

<h3>Description</h3>

<p>Method for calculating predicted response for HDLM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdlm'
predict(
  object,
  new.data,
  new.exposure.data,
  ci.level = 0.95,
  type = "response",
  outcome = NULL,
  fixed.idx = list(),
  est.dlm = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.hdlm_+3A_object">object</code></td>
<td>
<p>fitted dlmtree model with class hdlm</p>
</td></tr>
<tr><td><code id="predict.hdlm_+3A_new.data">new.data</code></td>
<td>
<p>new data frame which contains the same covariates and modifiers used to fit HDLM model</p>
</td></tr>
<tr><td><code id="predict.hdlm_+3A_new.exposure.data">new.exposure.data</code></td>
<td>
<p>new data frame/list which contains the same length of exposure lags used to fit HDLM model</p>
</td></tr>
<tr><td><code id="predict.hdlm_+3A_ci.level">ci.level</code></td>
<td>
<p>credible interval level for posterior predictive distribution</p>
</td></tr>
<tr><td><code id="predict.hdlm_+3A_type">type</code></td>
<td>
<p>type of prediction: &quot;response&quot; (default) or &quot;waic&quot;. &quot;waic&quot; must be specified with 'outcome' parameter</p>
</td></tr>
<tr><td><code id="predict.hdlm_+3A_outcome">outcome</code></td>
<td>
<p>outcome required for WAIC calculation</p>
</td></tr>
<tr><td><code id="predict.hdlm_+3A_fixed.idx">fixed.idx</code></td>
<td>
<p>fixed index</p>
</td></tr>
<tr><td><code id="predict.hdlm_+3A_est.dlm">est.dlm</code></td>
<td>
<p>flag for estimating dlm effect</p>
</td></tr>
<tr><td><code id="predict.hdlm_+3A_verbose">verbose</code></td>
<td>
<p>TRUE (default) or FALSE: print output</p>
</td></tr>
<tr><td><code id="predict.hdlm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>predict.hdlm
</p>


<h3>Value</h3>

<p>Posterior predictive distribution draws
</p>

<hr>
<h2 id='predict.hdlmm'>Calculates predicted response for HDLMM</h2><span id='topic+predict.hdlmm'></span>

<h3>Description</h3>

<p>Method for calculating predicted response for HDLMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdlmm'
predict(
  object,
  new.data,
  new.exposure.data,
  ci.level = 0.95,
  type = "response",
  outcome = NULL,
  fixed.idx = list(),
  est.dlm = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.hdlmm_+3A_object">object</code></td>
<td>
<p>fitted dlmtree model with class hdlmm</p>
</td></tr>
<tr><td><code id="predict.hdlmm_+3A_new.data">new.data</code></td>
<td>
<p>new data frame which contains the same covariates and modifiers used to fit HDLMM model</p>
</td></tr>
<tr><td><code id="predict.hdlmm_+3A_new.exposure.data">new.exposure.data</code></td>
<td>
<p>new data frame/list which contains the same length of exposure lags used to fit HDLMM model</p>
</td></tr>
<tr><td><code id="predict.hdlmm_+3A_ci.level">ci.level</code></td>
<td>
<p>credible interval level for posterior predictive distribution</p>
</td></tr>
<tr><td><code id="predict.hdlmm_+3A_type">type</code></td>
<td>
<p>type of prediction: &quot;response&quot; (default) or &quot;waic&quot;. &quot;waic&quot; must be specified with 'outcome' parameter</p>
</td></tr>
<tr><td><code id="predict.hdlmm_+3A_outcome">outcome</code></td>
<td>
<p>outcome required for WAIC calculation</p>
</td></tr>
<tr><td><code id="predict.hdlmm_+3A_fixed.idx">fixed.idx</code></td>
<td>
<p>fixed index</p>
</td></tr>
<tr><td><code id="predict.hdlmm_+3A_est.dlm">est.dlm</code></td>
<td>
<p>flag for estimating dlm effect</p>
</td></tr>
<tr><td><code id="predict.hdlmm_+3A_verbose">verbose</code></td>
<td>
<p>TRUE (default) or FALSE: print output</p>
</td></tr>
<tr><td><code id="predict.hdlmm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>predict.hdlmm
</p>


<h3>Value</h3>

<p>Posterior predictive distribution draws
</p>

<hr>
<h2 id='print.hdlm'>Print a hdlm Object</h2><span id='topic+print.hdlm'></span>

<h3>Description</h3>

<p>Print a hdlm Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdlm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.hdlm_+3A_x">x</code></td>
<td>
<p>An object of class hdlm.</p>
</td></tr>
<tr><td><code id="print.hdlm_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Assorted model output.
</p>

<hr>
<h2 id='print.hdlmm'>Print a hdlmm Object</h2><span id='topic+print.hdlmm'></span>

<h3>Description</h3>

<p>Print a hdlmm Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdlmm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.hdlmm_+3A_x">x</code></td>
<td>
<p>An object of class hdlmm.</p>
</td></tr>
<tr><td><code id="print.hdlmm_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Assorted model output.
</p>

<hr>
<h2 id='print.monotone'>Print a monotone Object</h2><span id='topic+print.monotone'></span>

<h3>Description</h3>

<p>Print a monotone Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'monotone'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.monotone_+3A_x">x</code></td>
<td>
<p>An object of class monotone</p>
</td></tr>
<tr><td><code id="print.monotone_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Assorted model output.
</p>

<hr>
<h2 id='print.summary.hdlm'>Prints an overview with summary of model class 'hdlm'</h2><span id='topic+print.summary.hdlm'></span>

<h3>Description</h3>

<p>Method for printing an overview with summary of model class 'hdlm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.hdlm'
print(x, digits = 3, cw.only = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.hdlm_+3A_x">x</code></td>
<td>
<p>an object of type 'summary.hdlm', result of call to summary.hdlm()</p>
</td></tr>
<tr><td><code id="print.summary.hdlm_+3A_digits">digits</code></td>
<td>
<p>integer number of digits to round</p>
</td></tr>
<tr><td><code id="print.summary.hdlm_+3A_cw.only">cw.only</code></td>
<td>
<p>print only results for exposures with critical windows</p>
</td></tr>
<tr><td><code id="print.summary.hdlm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print.summary.hdlm
</p>


<h3>Value</h3>

<p>output of hdlm fit in R console
</p>

<hr>
<h2 id='print.summary.hdlmm'>Prints an overview with summary of model class 'hdlmm'</h2><span id='topic+print.summary.hdlmm'></span>

<h3>Description</h3>

<p>Method for printing an overview with summary of model class 'hdlmm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.hdlmm'
print(x, digits = 3, cw.only = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.hdlmm_+3A_x">x</code></td>
<td>
<p>an object of type 'summary.hdlmm', result of call to summary.hdlmm()</p>
</td></tr>
<tr><td><code id="print.summary.hdlmm_+3A_digits">digits</code></td>
<td>
<p>integer number of digits to round</p>
</td></tr>
<tr><td><code id="print.summary.hdlmm_+3A_cw.only">cw.only</code></td>
<td>
<p>print only results for exposures with critical windows</p>
</td></tr>
<tr><td><code id="print.summary.hdlmm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print.summary.hdlmm
</p>


<h3>Value</h3>

<p>output of hdlmm fit in R console
</p>

<hr>
<h2 id='print.summary.monotone'>Prints an overview with summary of model class 'monotone'</h2><span id='topic+print.summary.monotone'></span>

<h3>Description</h3>

<p>Method for printing an overview with summary of model class 'monotone'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.monotone'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.monotone_+3A_x">x</code></td>
<td>
<p>an object of type 'summary.monotone', result of call to summary.monotone()</p>
</td></tr>
<tr><td><code id="print.summary.monotone_+3A_digits">digits</code></td>
<td>
<p>integer number of digits to round</p>
</td></tr>
<tr><td><code id="print.summary.monotone_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print.summary.monotone
</p>


<h3>Value</h3>

<p>output in R console
</p>

<hr>
<h2 id='print.summary.tdlm'>Prints an overview with summary of model class 'tdlm'</h2><span id='topic+print.summary.tdlm'></span>

<h3>Description</h3>

<p>Method for printing an overview with summary of model class 'tdlm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.tdlm'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.tdlm_+3A_x">x</code></td>
<td>
<p>an object of type 'summary.tdlnm', result of call to summary.tdlnm()</p>
</td></tr>
<tr><td><code id="print.summary.tdlm_+3A_digits">digits</code></td>
<td>
<p>integer number of digits to round</p>
</td></tr>
<tr><td><code id="print.summary.tdlm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print.summary.tdlm
</p>


<h3>Value</h3>

<p>output of tdlm fit in R console
</p>

<hr>
<h2 id='print.summary.tdlmm'>Prints an overview with summary of model class 'tdlmm'</h2><span id='topic+print.summary.tdlmm'></span>

<h3>Description</h3>

<p>Method for printing an overview with summary of model class 'tdlmm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.tdlmm'
print(x, digits = 3, cw.only = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.tdlmm_+3A_x">x</code></td>
<td>
<p>an object of type 'summary.tdlmm', result of call to summary.tdlmm()</p>
</td></tr>
<tr><td><code id="print.summary.tdlmm_+3A_digits">digits</code></td>
<td>
<p>integer number of digits to round</p>
</td></tr>
<tr><td><code id="print.summary.tdlmm_+3A_cw.only">cw.only</code></td>
<td>
<p>print only results for exposures with critical windows</p>
</td></tr>
<tr><td><code id="print.summary.tdlmm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print.summary.tdlmm
</p>


<h3>Value</h3>

<p>output of tdlmm fit in R console
</p>

<hr>
<h2 id='print.summary.tdlnm'>Prints an overview with summary of model class 'tdlnm'</h2><span id='topic+print.summary.tdlnm'></span>

<h3>Description</h3>

<p>Method for printing an overview with summary of model class 'tdlnm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.tdlnm'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.tdlnm_+3A_x">x</code></td>
<td>
<p>an object of type 'summary.tdlnm', result of call to summary.tdlnm()</p>
</td></tr>
<tr><td><code id="print.summary.tdlnm_+3A_digits">digits</code></td>
<td>
<p>integer number of digits to round</p>
</td></tr>
<tr><td><code id="print.summary.tdlnm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print.summary.tdlnm
</p>


<h3>Value</h3>

<p>output of tdlnm fit in R console
</p>

<hr>
<h2 id='print.tdlm'>Print a tdlm Object</h2><span id='topic+print.tdlm'></span>

<h3>Description</h3>

<p>Print a tdlm Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tdlm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.tdlm_+3A_x">x</code></td>
<td>
<p>An object of class tdlm.</p>
</td></tr>
<tr><td><code id="print.tdlm_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Assorted model output.
</p>

<hr>
<h2 id='print.tdlmm'>Print a tdlmm Object</h2><span id='topic+print.tdlmm'></span>

<h3>Description</h3>

<p>Print a tdlmm Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tdlmm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.tdlmm_+3A_x">x</code></td>
<td>
<p>An object of class tdlmm.</p>
</td></tr>
<tr><td><code id="print.tdlmm_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Assorted model output.
</p>

<hr>
<h2 id='print.tdlnm'>Print a tdlnm Object</h2><span id='topic+print.tdlnm'></span>

<h3>Description</h3>

<p>Print a tdlnm Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tdlnm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.tdlnm_+3A_x">x</code></td>
<td>
<p>An object of class tdlnm.</p>
</td></tr>
<tr><td><code id="print.tdlnm_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Assorted model output.
</p>

<hr>
<h2 id='rcpp_pgdraw'>Multiple draw polya gamma latent variable for var c[i] with size b[i]</h2><span id='topic+rcpp_pgdraw'></span>

<h3>Description</h3>

<p>Multiple draw polya gamma latent variable for var c[i] with size b[i]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcpp_pgdraw(b, z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rcpp_pgdraw_+3A_b">b</code></td>
<td>
<p>vector of binomial sizes</p>
</td></tr>
<tr><td><code id="rcpp_pgdraw_+3A_z">z</code></td>
<td>
<p>vector of parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Eigen::VectorXd
</p>

<hr>
<h2 id='rtmvnorm'>Truncated multivariate normal sampler, mean mu, cov sigma, truncated (0, Inf)</h2><span id='topic+rtmvnorm'></span>

<h3>Description</h3>

<p>Truncated multivariate normal sampler, mean mu, cov sigma, truncated (0, Inf)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtmvnorm(mu, sigma, iter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rtmvnorm_+3A_mu">mu</code></td>
<td>
<p>vector of mean parameters</p>
</td></tr>
<tr><td><code id="rtmvnorm_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
<tr><td><code id="rtmvnorm_+3A_iter">iter</code></td>
<td>
<p>number of iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>VectorXd
</p>

<hr>
<h2 id='ruleIdx'>Calculates the weights for each modifier rule</h2><span id='topic+ruleIdx'></span>

<h3>Description</h3>

<p>Method for calculating the weights for each modifier rule
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ruleIdx(mod, mem.safe = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ruleIdx_+3A_mod">mod</code></td>
<td>
<p>a list of modifier splitting rules</p>
</td></tr>
<tr><td><code id="ruleIdx_+3A_mem.safe">mem.safe</code></td>
<td>
<p>boolean memory parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of weights per rule with modifiers
</p>

<hr>
<h2 id='scaleModelMatrix'>Centers and scales a matrix</h2><span id='topic+scaleModelMatrix'></span>

<h3>Description</h3>

<p>Method for centering and scaling a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaleModelMatrix(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scaleModelMatrix_+3A_m">M</code></td>
<td>
<p>a matrix to center and scale</p>
</td></tr>
</table>


<h3>Details</h3>

<p>scaleModelMatrix
</p>


<h3>Value</h3>

<p>a scaled matrix
</p>

<hr>
<h2 id='shiny'>shiny</h2><span id='topic+shiny'></span>

<h3>Description</h3>

<p>shiny generic function for S3method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiny(fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shiny_+3A_fit">fit</code></td>
<td>
<p>an object of class hdlm or hdlmm to which S3method is applied</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'shiny' interface for further analysis on heterogeneous analyses. The interface includes tabs for modifier selection, personalized exposure effects and subgroup-specific effects.
</p>

<hr>
<h2 id='shiny.hdlm'>Executes a 'shiny' app for HDLM.</h2><span id='topic+shiny.hdlm'></span>

<h3>Description</h3>

<p>Method for executing a 'shiny' app to provide comprehensive analysis with HDLM. The app includes PIP, split points, individualized &amp; subgroup-specific effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdlm'
shiny(fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shiny.hdlm_+3A_fit">fit</code></td>
<td>
<p>an object of class 'hdlm'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>shiny.hdlm
</p>


<h3>Value</h3>

<p>A 'shiny' app interface
</p>

<hr>
<h2 id='shiny.hdlmm'>Executes a 'shiny' app for HDLMM.</h2><span id='topic+shiny.hdlmm'></span>

<h3>Description</h3>

<p>Method for executing a 'shiny' app to provide comprehensive analysis with HDLMM. The app includes PIP, split points, individualized &amp; subgroup-specific effects for exposure of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdlmm'
shiny(fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shiny.hdlmm_+3A_fit">fit</code></td>
<td>
<p>an object of class 'hdlmm'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>shiny.hdlmm
</p>


<h3>Value</h3>

<p>A 'shiny' app interface
</p>

<hr>
<h2 id='sim.hdlmm'>Creates simulated data for HDLM &amp; HDLMM</h2><span id='topic+sim.hdlmm'></span>

<h3>Description</h3>

<p>Method for creating simulated data for HDLM &amp; HDLMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.hdlmm(
  sim = "A",
  n = 1000,
  error = 1,
  effect.size = 1,
  exposure.data = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.hdlmm_+3A_sim">sim</code></td>
<td>
<p>character (A - E) specifying simulation scenario</p>
</td></tr>
<tr><td><code id="sim.hdlmm_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="sim.hdlmm_+3A_error">error</code></td>
<td>
<p>positive scalar specifying error variance for Gaussian response</p>
</td></tr>
<tr><td><code id="sim.hdlmm_+3A_effect.size">effect.size</code></td>
<td>
<p>the effect size of the window of susceptibility</p>
</td></tr>
<tr><td><code id="sim.hdlmm_+3A_exposure.data">exposure.data</code></td>
<td>
<p>exposure data. A matrix of exposure data for simulation A, B, C and a named list of exposure data for simulation D, E</p>
</td></tr>
</table>


<h3>Details</h3>

<p>sim.hdlmm
</p>
<p>Simulation scenarios:
</p>

<ul>
<li><p> Scenario A: Two subgroups with early/late windows determined by continuous and binary modifiers
</p>
</li>
<li><p> Scenario B: Two subgroups with scaled effect determined by a continuous modifier
</p>
</li>
<li><p> Scenario C: No heterogeneity i.e., same effect on all individuals
</p>
</li>
<li><p> Scenario D: Three subgroups with three corresponding exposures. Subgroups are determined by continuous and binary modifiers
</p>
</li>
<li><p> Scenario E: Two subgroups with two exposures. First group is associated with the scaled main effect and lagged interaction
while the second group is only associated with the scaled main effect, no interaction.
</p>
</li></ul>



<h3>Value</h3>

<p>Simulated data and true parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim.hdlmm(sim = "A", n = 1000)

</code></pre>

<hr>
<h2 id='sim.tdlmm'>Creates simulated data for TDLM &amp; TDLMM</h2><span id='topic+sim.tdlmm'></span>

<h3>Description</h3>

<p>Method for creating simulated data for TDLM &amp; TDLMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.tdlmm(
  sim = "A",
  n = 5000,
  error = 10,
  mean.p = 0.5,
  prop.active = 0.05,
  expList = NULL,
  r = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.tdlmm_+3A_sim">sim</code></td>
<td>
<p>character (A - F) specifying simulation scenario</p>
</td></tr>
<tr><td><code id="sim.tdlmm_+3A_n">n</code></td>
<td>
<p>sample size for simulation</p>
</td></tr>
<tr><td><code id="sim.tdlmm_+3A_error">error</code></td>
<td>
<p>positive scalar specifying error variance for Gaussian response</p>
</td></tr>
<tr><td><code id="sim.tdlmm_+3A_mean.p">mean.p</code></td>
<td>
<p>scalar between zero and one specifying mean probability for simulation scenario A</p>
</td></tr>
<tr><td><code id="sim.tdlmm_+3A_prop.active">prop.active</code></td>
<td>
<p>proportion of active exposures for simulation scenario C</p>
</td></tr>
<tr><td><code id="sim.tdlmm_+3A_explist">expList</code></td>
<td>
<p>named list of exposure data</p>
</td></tr>
<tr><td><code id="sim.tdlmm_+3A_r">r</code></td>
<td>
<p>dispersion parameter of negative binomial distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>sim.tdlmm
</p>
<p>Simulation scenarios:
</p>

<ul>
<li><p> Scenario A: Binary response with single exposure effect
</p>
</li>
<li><p> Scenario B: Continuous response with main effect of PM2.5 and interaction
</p>
</li>
<li><p> Scenario C: Continuous response to test exposure selection using exposure
</p>
</li>
<li><p> Scenario D: Continuous response to test exposure selection using one exposure of main effect and two interaction effects among four exposures
</p>
</li>
<li><p> Scenario E: Zero-inflated count response with single exposure effect
</p>
</li>
<li><p> Scenario F: Zero-inflated count response with single exposure effect with main effect of PM2.5 and interaction
</p>
</li></ul>



<h3>Value</h3>

<p>Simulated data and true parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim.tdlmm(sim = "A", mean.p = 0.5, n = 1000)

</code></pre>

<hr>
<h2 id='sim.tdlnm'>Creates simulated data for TDLNM</h2><span id='topic+sim.tdlnm'></span>

<h3>Description</h3>

<p>Method for creating simulated data for TDLNM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.tdlnm(sim = "A", error.to.signal = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.tdlnm_+3A_sim">sim</code></td>
<td>
<p>character (A - D) specifying simulation scenario</p>
</td></tr>
<tr><td><code id="sim.tdlnm_+3A_error.to.signal">error.to.signal</code></td>
<td>
<p>scalar value setting error: sigma^2/var(f)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>sim.tdlnm
</p>
<p>Simulation scenarios:
</p>

<ul>
<li><p> Scenario A: Piecewise constant effect
</p>
</li>
<li><p> Scenario B: Linear effect
</p>
</li>
<li><p> Scenario C: Logistic effect, piecewise in time
</p>
</li>
<li><p> Scenario D: Logistic effect, smooth in time
</p>
</li></ul>



<h3>Value</h3>

<p>Simulated data and true parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim.tdlnm(sim = "A", error.to.signal = 1)

</code></pre>

<hr>
<h2 id='splitPIP'>Calculates the posterior inclusion probability (PIP).</h2><span id='topic+splitPIP'></span>

<h3>Description</h3>

<p>Calculates the posterior inclusion probability (PIP).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitPIP(dlnm, nlags, niter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="splitPIP_+3A_dlnm">dlnm</code></td>
<td>
<p>A numeric matrix containing the model fit information</p>
</td></tr>
<tr><td><code id="splitPIP_+3A_nlags">nlags</code></td>
<td>
<p>total number of lags</p>
</td></tr>
<tr><td><code id="splitPIP_+3A_niter">niter</code></td>
<td>
<p>number of mcmc iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of split counts per mcmc
</p>

<hr>
<h2 id='splitpoints'>Determines split points for continuous modifiers</h2><span id='topic+splitpoints'></span>

<h3>Description</h3>

<p>Method for determining split points for continuous modifiers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitpoints(object, var, round = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="splitpoints_+3A_object">object</code></td>
<td>
<p>An object of class dlmtree with DLM type hdlm &amp; hdlmm</p>
</td></tr>
<tr><td><code id="splitpoints_+3A_var">var</code></td>
<td>
<p>The name of a continuous variable for which the split points will be reported</p>
</td></tr>
<tr><td><code id="splitpoints_+3A_round">round</code></td>
<td>
<p>The number of decimal places to round the variable (var) to. No rounding occurs if round=NULL (default)
For positive integer values of round, the variable will be rounded and split points will be reported at the resulting level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>splitpoints
</p>


<h3>Value</h3>

<p>A data frame with split points and the probability that a split point was &gt;= that split point value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Split points with HDLM 
D &lt;- sim.hdlmm(sim = "B", n = 1000)
fit &lt;- dlmtree(y ~ ., 
               data = D$dat,
               exposure.data = D$exposures,
               dlm.type = "linear",
               family = "gaussian",
               het = TRUE)
splitpoints(fit, var = "mod_num", round = 2)
splitpoints(fit, var = "mod_scale", round = 2)


</code></pre>

<hr>
<h2 id='summary.hdlm'>Creates a summary object of class 'hdlm'</h2><span id='topic+summary.hdlm'></span>

<h3>Description</h3>

<p>Method for creating a summary object of class 'hdlm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdlm'
summary(object, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.hdlm_+3A_object">object</code></td>
<td>
<p>an object of class 'hdlm'</p>
</td></tr>
<tr><td><code id="summary.hdlm_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for computation of credible intervals</p>
</td></tr>
<tr><td><code id="summary.hdlm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.hdlm
</p>


<h3>Value</h3>

<p>list of type 'summary.hdlm'
</p>

<hr>
<h2 id='summary.hdlmm'>Creates a summary object of class 'hdlmm'</h2><span id='topic+summary.hdlmm'></span>

<h3>Description</h3>

<p>Method for creating a summary object of class 'hdlm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hdlmm'
summary(object, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.hdlmm_+3A_object">object</code></td>
<td>
<p>an object of class 'hdlmm'</p>
</td></tr>
<tr><td><code id="summary.hdlmm_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for computation of credible intervals</p>
</td></tr>
<tr><td><code id="summary.hdlmm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.hdlmm
</p>


<h3>Value</h3>

<p>list of type 'summary.hdlmm'
</p>

<hr>
<h2 id='summary.monotone'>Creates a summary object of class 'monotone'</h2><span id='topic+summary.monotone'></span>

<h3>Description</h3>

<p>Method for creating a summary object of class 'monotone'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'monotone'
summary(
  object,
  pred.at = NULL,
  cenval = 0,
  conf.level = 0.95,
  exposure.se = NULL,
  mcmc = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.monotone_+3A_object">object</code></td>
<td>
<p>an object of class 'monotone'</p>
</td></tr>
<tr><td><code id="summary.monotone_+3A_pred.at">pred.at</code></td>
<td>
<p>numerical vector of exposure values to make predictions for
at each time period</p>
</td></tr>
<tr><td><code id="summary.monotone_+3A_cenval">cenval</code></td>
<td>
<p>scalar exposure value that acts as a reference point for
predictions at all other exposure values</p>
</td></tr>
<tr><td><code id="summary.monotone_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for computation of credible intervals</p>
</td></tr>
<tr><td><code id="summary.monotone_+3A_exposure.se">exposure.se</code></td>
<td>
<p>scalar smoothing factor, if different from model</p>
</td></tr>
<tr><td><code id="summary.monotone_+3A_mcmc">mcmc</code></td>
<td>
<p>TRUE or FALSE (default): return MCMC samplers</p>
</td></tr>
<tr><td><code id="summary.monotone_+3A_verbose">verbose</code></td>
<td>
<p>TRUE (default) or FALSE: print output</p>
</td></tr>
<tr><td><code id="summary.monotone_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.monotone
</p>


<h3>Value</h3>

<p>Summary of monotone fit
</p>

<hr>
<h2 id='summary.tdlm'>Creates a summary object of class 'tdlm'</h2><span id='topic+summary.tdlm'></span>

<h3>Description</h3>

<p>Method for creating a summary object of class 'tdlm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tdlm'
summary(object, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.tdlm_+3A_object">object</code></td>
<td>
<p>an object of dlm class 'tdlm' (i.e. a linear effect DLM)</p>
</td></tr>
<tr><td><code id="summary.tdlm_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for computation of credible intervals</p>
</td></tr>
<tr><td><code id="summary.tdlm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.tdlm
</p>


<h3>Value</h3>

<p>list of type 'summary.tdlm'
</p>

<hr>
<h2 id='summary.tdlmm'>Creates a summary object of class 'tdlmm'</h2><span id='topic+summary.tdlmm'></span>

<h3>Description</h3>

<p>Method for creating a summary object of class 'tdlmm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tdlmm'
summary(
  object,
  conf.level = 0.95,
  marginalize = "mean",
  log10BF.crit = 0.5,
  verbose = TRUE,
  keep.mcmc = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.tdlmm_+3A_object">object</code></td>
<td>
<p>an object of type 'tdlmm', the output from tdlmm()</p>
</td></tr>
<tr><td><code id="summary.tdlmm_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level (default = 0.95)</p>
</td></tr>
<tr><td><code id="summary.tdlmm_+3A_marginalize">marginalize</code></td>
<td>
<p>value(s) for calculating marginal DLMs, defaults to
&quot;mean&quot;, can also specify a percentile from 1-99 for all other exposures, or
a named vector with specific values for each exposure</p>
</td></tr>
<tr><td><code id="summary.tdlmm_+3A_log10bf.crit">log10BF.crit</code></td>
<td>
<p>Bayes Factor criteria for selecting exposures and
interactions, such that log10(BayesFactor) &gt; x. Default = 0.5</p>
</td></tr>
<tr><td><code id="summary.tdlmm_+3A_verbose">verbose</code></td>
<td>
<p>show progress in console</p>
</td></tr>
<tr><td><code id="summary.tdlmm_+3A_keep.mcmc">keep.mcmc</code></td>
<td>
<p>keep all mcmc iterations (large memory requirement)</p>
</td></tr>
<tr><td><code id="summary.tdlmm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.tdlmm
</p>


<h3>Value</h3>

<p>list of type 'summary.tdlmm'
</p>

<hr>
<h2 id='summary.tdlnm'>Creates a summary object of class 'tdlnm'</h2><span id='topic+summary.tdlnm'></span>

<h3>Description</h3>

<p>Method for creating a summary object of class 'tdlnm'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tdlnm'
summary(
  object,
  pred.at = NULL,
  cenval = 0,
  conf.level = 0.95,
  exposure.se = NULL,
  mcmc = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.tdlnm_+3A_object">object</code></td>
<td>
<p>an object of class 'tdlnm', result of a call to tdlnm</p>
</td></tr>
<tr><td><code id="summary.tdlnm_+3A_pred.at">pred.at</code></td>
<td>
<p>numerical vector of exposure values to make predictions for
at each time period</p>
</td></tr>
<tr><td><code id="summary.tdlnm_+3A_cenval">cenval</code></td>
<td>
<p>scalar exposure value that acts as a reference point for
predictions at all other exposure values</p>
</td></tr>
<tr><td><code id="summary.tdlnm_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for computation of credible intervals</p>
</td></tr>
<tr><td><code id="summary.tdlnm_+3A_exposure.se">exposure.se</code></td>
<td>
<p>scalar smoothing factor, if different from model</p>
</td></tr>
<tr><td><code id="summary.tdlnm_+3A_mcmc">mcmc</code></td>
<td>
<p>TRUE or FALSE (default): return MCMC samplers</p>
</td></tr>
<tr><td><code id="summary.tdlnm_+3A_verbose">verbose</code></td>
<td>
<p>TRUE (default) or FALSE: print output</p>
</td></tr>
<tr><td><code id="summary.tdlnm_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.tdlnm
</p>


<h3>Value</h3>

<p>list of type 'summary.tdlnm'
</p>

<hr>
<h2 id='tdlmm'>Treed Distributed Lag Mixture Models (Deprecated)</h2><span id='topic+tdlmm'></span>

<h3>Description</h3>

<p>TDLMM is a method for estimating a Treed Distributed Lag
Mixture Model. It operates by building an ensemble of pairs of regression
trees. Each tree in a tree-pair partitions the time span of the exposure data
and estimates a piecewise constant distributed lag effect. The two trees
are then intersected to create an interaction surface for estimating the
interaction between two exposures. Exposures are selected for each tree
stochastically and each exposure or interaction has a unique shrinkage
variance component. This allows for exposure variable selection in addition
to the estimation of the distributed lag mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdlmm(
  formula,
  data,
  exposure.data,
  n.trees = 20,
  n.burn = 2000,
  n.iter = 5000,
  n.thin = 5,
  family = "gaussian",
  binomial.size = 1,
  formula.zi = NULL,
  keep_XZ = FALSE,
  mixture.interactions = "noself",
  tree.params = c(0.95, 2),
  step.prob = c(0.25, 0.25, 0.25),
  mix.prior = 1,
  shrinkage = "exposures",
  subset = NULL,
  verbose = TRUE,
  diagnostics = FALSE,
  initial.params = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tdlmm_+3A_formula">formula</code></td>
<td>
<p>object of class formula, a symbolic description of the fixed
effect model to be fitted, e.g. y ~ a + b</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_data">data</code></td>
<td>
<p>data frame containing variables used in the formula</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_exposure.data">exposure.data</code></td>
<td>
<p>named list containing equally sized numerical matrices
of exposure data with same, having same length as data</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_n.trees">n.trees</code></td>
<td>
<p>integer for number of trees in ensemble</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_n.burn">n.burn</code></td>
<td>
<p>integer for length of burn-in</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_n.iter">n.iter</code></td>
<td>
<p>integer for number of iterations to run model after burn-in</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_n.thin">n.thin</code></td>
<td>
<p>integer thinning factor, i.e. keep every tenth iteration</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_family">family</code></td>
<td>
<p>'gaussian' for continuous response, 'logit' for binomial
response with logit link, or 'zinb' for zero-inflated negative binomial with logit link</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_binomial.size">binomial.size</code></td>
<td>
<p>integer type scalar (if all equal, default = 1) or
vector defining binomial size for 'logit' family</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_formula.zi">formula.zi</code></td>
<td>
<p>object of class formula, a symbolic description of the ZI
model to be fitted, e.g. y ~ a + b. This only applies to ZINB where covariates for
ZI model is different from NB model. This is same as the main formula by default</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_keep_xz">keep_XZ</code></td>
<td>
<p>FALSE (default) or TRUE: keep the model scale exposure and covariate data</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_mixture.interactions">mixture.interactions</code></td>
<td>
<p>'noself' (default) which estimates interactions
only between two different exposures, 'all' which also allows
interactions within the same exposure, or 'none' which eliminates all
interactions and estimates only main effects of each exposure</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_tree.params">tree.params</code></td>
<td>
<p>numerical vector of alpha and beta hyperparameters
controlling tree depth (see Bayesian CART, 1998), default: alpha = 0.95,
beta = 2</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_step.prob">step.prob</code></td>
<td>
<p>numerical vector for probability of 1) grow/prune,
2) change, 3) switch exposure, defaults to (0.25, 0.25, 0.25) or equal
probability of each step for tree updates</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_mix.prior">mix.prior</code></td>
<td>
<p>positive scalar hyperparameter for sparsity of exposures</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_shrinkage">shrinkage</code></td>
<td>
<p>character &quot;all&quot; (default), &quot;trees&quot;, &quot;exposures&quot;, &quot;none&quot;,
turns on horseshoe-like shrinkage priors for different parts of model</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_subset">subset</code></td>
<td>
<p>integer vector to analyze only a subset of data and exposures</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_verbose">verbose</code></td>
<td>
<p>TRUE (default) or FALSE: print output</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_diagnostics">diagnostics</code></td>
<td>
<p>TRUE or FALSE (default) keep model diagnostic such as
terminal nodes, acceptance details, etc.</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_initial.params">initial.params</code></td>
<td>
<p>initial parameters for fixed effects model, FALSE = none (default), &quot;glm&quot; = generate using GLM, or user defined, length must equal number of parameters in fixed effects model</p>
</td></tr>
<tr><td><code id="tdlmm_+3A_...">...</code></td>
<td>
<p>NA</p>
</td></tr>
</table>


<h3>Details</h3>

<p>tdlmm
</p>
<p>Model is recommended to be run for at minimum 5000 burn-in
iterations followed by 15000 sampling iterations with a thinning factor of 5.
Convergence can be checked by re-running the model and validating consistency
of results.
</p>


<h3>Value</h3>

<p>object of class 'tdlmm'
</p>

<hr>
<h2 id='tdlmm_Cpp'>dlmtree model with tdlmm approach</h2><span id='topic+tdlmm_Cpp'></span>

<h3>Description</h3>

<p>dlmtree model with tdlmm approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdlmm_Cpp(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tdlmm_Cpp_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='tdlnm'>Treed Distributed Lag Non-Linear Models (Deprecated)</h2><span id='topic+tdlnm'></span>

<h3>Description</h3>

<p>TDLNM is a method for estimating Distributed Lag
Linear and Non-Linear Models (DLMs/DLNMs). It operates by building an
ensemble of regression trees, which each partition the exposure-time-
response surface and make estimates at each sector. Trees from the ensemble
each contribute a partial estimate of the exposure-time surface, while
controlling for a model given by 'formula'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdlnm(
  formula,
  data,
  exposure.data,
  exposure.splits = 20,
  exposure.se = sd(exposure.data)/2,
  n.trees = 20,
  n.burn = 1000,
  n.iter = 2000,
  n.thin = 5,
  family = "gaussian",
  binomial.size = 1,
  formula.zi = NULL,
  tree.params = c(0.95, 2),
  step.prob = c(0.25, 0.25),
  monotone = FALSE,
  monotone.gamma0 = rep(0, ncol(exposure.data)),
  monotone.sigma = diag(ncol(exposure.data)) * 1.502^2,
  monotone.tree.time.params = c(0.95, 2),
  monotone.tree.exp.params = c(0.95, 2),
  monotone.time.kappa = NULL,
  shrinkage = ifelse(monotone, FALSE, TRUE),
  subset = NULL,
  lowmem = FALSE,
  verbose = TRUE,
  diagnostics = FALSE,
  initial.params = NULL,
  debug = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tdlnm_+3A_formula">formula</code></td>
<td>
<p>object of class formula, a symbolic description of the fixed
effect model to be fitted, e.g. y ~ a + b</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_data">data</code></td>
<td>
<p>data frame containing variables used in the formula</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_exposure.data">exposure.data</code></td>
<td>
<p>numerical matrix of complete exposure data with same
length as data</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_exposure.splits">exposure.splits</code></td>
<td>
<p>scalar indicating the number of splits (divided
evenly across quantiles of the exposure data) or list with two components:
'type' = 'values' or 'quantiles', and 'split.vals' = a numerical
vector indicating the corresponding exposure values or quantiles for splits.
Setting exposure.splits equal to 0 will change the model to a distributed lag
model, which assumes a linear effect of exposure.</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_exposure.se">exposure.se</code></td>
<td>
<p>numerical matrix of exposure standard errors with same
size as exposure.data or a scalar smoothing factor representing a uniform
smoothing factor applied to each exposure measurement, defaults to sd(exposure.data)/2</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_n.trees">n.trees</code></td>
<td>
<p>integer for number of trees in ensemble, default = 20</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_n.burn">n.burn</code></td>
<td>
<p>integer for length of burn-in, &gt;=2000 recommended</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_n.iter">n.iter</code></td>
<td>
<p>integer for number of iterations to run model after burn-in &gt;=5000 recommended</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_n.thin">n.thin</code></td>
<td>
<p>integer thinning factor, i.e. keep every fifth iteration</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_family">family</code></td>
<td>
<p>'gaussian' for continuous response, or 'logit' for binomial
response with logit link</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_binomial.size">binomial.size</code></td>
<td>
<p>integer type scalar (if all equal, default = 1) or
vector defining binomial size for 'logit' family</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_formula.zi">formula.zi</code></td>
<td>
<p>object of class formula, a symbolic description of the ZI
model to be fitted, e.g. y ~ a + b. This only applies to ZINB where covariates for
ZI model is different from NB model. This is same as the main formula by default</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_tree.params">tree.params</code></td>
<td>
<p>numerical vector of alpha and beta hyperparameters
controlling tree depth (see Bayesian CART, 1998), default: alpha = 0.95,
beta = 2</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_step.prob">step.prob</code></td>
<td>
<p>numerical vector for probability of 1) grow/prune, and
2) change, defaults to (0.25, 0.25) or equal
probability of each step for tree updates</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_monotone">monotone</code></td>
<td>
<p>FALSE (default) or TRUE: estimate monotone effects</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_monotone.gamma0">monotone.gamma0</code></td>
<td>
<p>&mdash;&mdash;&mdash;UPDATE&mdash;&mdash;&mdash;</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_monotone.sigma">monotone.sigma</code></td>
<td>
<p>&mdash;&mdash;&mdash;UPDATE&mdash;&mdash;&mdash;</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_monotone.tree.time.params">monotone.tree.time.params</code></td>
<td>
<p>&mdash;&mdash;&mdash;UPDATE&mdash;&mdash;&mdash;</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_monotone.tree.exp.params">monotone.tree.exp.params</code></td>
<td>
<p>&mdash;&mdash;&mdash;UPDATE&mdash;&mdash;&mdash;</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_monotone.time.kappa">monotone.time.kappa</code></td>
<td>
<p>&mdash;&mdash;&mdash;UPDATE&mdash;&mdash;&mdash;</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_shrinkage">shrinkage</code></td>
<td>
<p>int, 1 (default) turn on tree-specific shrinkage priors,
0 turn off</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_subset">subset</code></td>
<td>
<p>integer vector to analyze only a subset of data and exposures</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_lowmem">lowmem</code></td>
<td>
<p>FALSE (default) or TRUE: turn on memory saver for DLNM, slower computation time</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_verbose">verbose</code></td>
<td>
<p>TRUE (default) or FALSE: print progress bar output</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_diagnostics">diagnostics</code></td>
<td>
<p>TRUE or FALSE (default) keep model diagnostic such as
terminal nodes, acceptance details, etc.</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_initial.params">initial.params</code></td>
<td>
<p>initial parameters for fixed effects model, FALSE = none (default), 
&quot;glm&quot; = generate using GLM, or user defined, length must equal number of parameters in fixed effects model</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_debug">debug</code></td>
<td>
<p>if TRUE, outputs debugging messages</p>
</td></tr>
<tr><td><code id="tdlnm_+3A_...">...</code></td>
<td>
<p>NA</p>
</td></tr>
</table>


<h3>Details</h3>

<p>tdlnm
</p>
<p>Model is recommended to be run for at minimum 5000 burn-in iterations
followed by 15000 sampling iterations with a thinning factor of 10.
Convergence can be checked by re-running the model and validating consistency
of results.
</p>


<h3>Value</h3>

<p>object of class 'tdlnm' or 'tdlm'
</p>

<hr>
<h2 id='tdlnm_Cpp'>dlmtree model with tdlnm approach</h2><span id='topic+tdlnm_Cpp'></span>

<h3>Description</h3>

<p>dlmtree model with tdlnm approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdlnm_Cpp(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tdlnm_Cpp_+3A_model">model</code></td>
<td>
<p>A list of parameter and data contained for the model fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dlmtree model fit, mainly posterior mcmc samples
</p>

<hr>
<h2 id='zeroToInfNormCDF'>Integrates (0,inf) over multivariate normal</h2><span id='topic+zeroToInfNormCDF'></span>

<h3>Description</h3>

<p>Integrates (0,inf) over multivariate normal
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zeroToInfNormCDF(mu, sigma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="zeroToInfNormCDF_+3A_mu">mu</code></td>
<td>
<p>vector of mean parameters</p>
</td></tr>
<tr><td><code id="zeroToInfNormCDF_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>double
</p>

<hr>
<h2 id='zinbCo'>Time-series exposure data for ZINB simulated data</h2><span id='topic+zinbCo'></span>

<h3>Description</h3>

<p>Data.frame containing a sample of weekly average wildfire PM, PM2.5, O3
across a range of counties of Colorado. The exposure data was downloaded from US EPA
(https://aqs.epa.gov/aqsweb/airdata/download_files.html) daily data summaries
and averaged by week.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(zinbCo)
</code></pre>


<h3>Format</h3>

<p>data.frame;
</p>


<h3>Source</h3>

<p><a href="https://aqs.epa.gov/aqsweb/airdata/download_files.html">https://aqs.epa.gov/aqsweb/airdata/download_files.html</a>
</p>


<h3>References</h3>

<p><a href="https://www.epa.gov/outdoor-air-quality-data">https://www.epa.gov/outdoor-air-quality-data</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
