<!DOCTYPE html><html lang="en"><head><title>Help for package ADVICE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ADVICE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confint.QRS'><p>Confidence Interval Function</p></a></li>
<li><a href='#hello'><p>Hello, World!</p></a></li>
<li><a href='#ices'><p>Interrupted Coefficient Estimation Selection</p></a></li>
<li><a href='#MSDecision'><p>Multiple Sclerosis Decision Delay</p></a></li>
<li><a href='#plot.QRS'><p>plot.QRS</p></a></li>
<li><a href='#QRS'><p>QR Regression Selection and Estimation</p></a></li>
<li><a href='#rmultreg'>
<p>Multiple Regression Data Generator</p></a></li>
<li><a href='#summary.QRS'><p>summary.QRS</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Automatic Direct Variable Selection via Interrupted Coefficient
Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>L. Tazik [aut, cre],
  W.J. Braun [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>L. Tazik &lt;ladan.tazik@ubc.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Accurate point and interval estimation methods for multiple linear regression coefficients, under classical normal and independent error assumptions, taking into account variable selection.   </td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.1)</td>
</tr>
<tr>
<td>ZipData:</td>
<td>no</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-15 23:18:55 UTC; braun</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-16 08:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='confint.QRS'>Confidence Interval Function</h2><span id='topic+confint.QRS'></span>

<h3>Description</h3>

<p>Computes confidence intervals for one or more parameters in a fitted model. There is a default and a method for objects inheriting from class &quot;qrs&quot;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'QRS'
confint(object, parm, level, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.QRS_+3A_object">object</code></td>
<td>
<p>a fitted model object from the QRS class.</p>
</td></tr>
<tr><td><code id="confint.QRS_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given
confidence intervals, either a vector of numbers or a vector
of names.  If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.QRS_+3A_level">level</code></td>
<td>
<p>a numeric value specifying the required confidence level.</p>
</td></tr>
<tr><td><code id="confint.QRS_+3A_...">...</code></td>
<td>
<p>additional argument(s) for the methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes t-based confidence intervals using n-p degrees of freedom, where n is the number of observations and p is the number of regression coefficients in the full model.</p>


<h3>Value</h3>

<p>A 2-column matrix giving lower and upper confidence limits (corresponding to the given level) 
for each parameter. These will be labelled as (1-level)/2 and 1 - (1-level)/2 in 
</p>


<h3>Author(s)</h3>

<p>Ladan Tazik, W.J. Braun</p>


<h3>See Also</h3>

<p><code>ices.R</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    myRegressionData &lt;- rmultreg(100, k=20, p=.1, sdnoise = 1)
    pairs(myRegressionData$data)
    out &lt;- ices(y ~ ., data = myRegressionData$data) # fit model to simulated data
    confint(out) # calculate 95% confidence intervals for all coefficients
    myRegressionData$coefficients # compare with true coefficients
</code></pre>

<hr>
<h2 id='hello'>Hello, World!</h2><span id='topic+hello'></span>

<h3>Description</h3>

<p>Prints 'Hello, world!'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hello()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>hello()
</code></pre>

<hr>
<h2 id='ices'>Interrupted Coefficient Estimation Selection</h2><span id='topic+ices'></span>

<h3>Description</h3>

<p>This function provides an alternative multiple regression fitting procedure
which simultaneously estimates and selects variables.  The resulting coefficient estimates
will tend to be slightly biased, but in a sparse setting, they can be quite accurate. A
full regression model is specified by the user, and the function usually returns coefficient estimates
for a reduced model, i.e., a model for which some of the coefficient estimates are exactly 0.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ices(formula, data, model = TRUE, x = FALSE, y = FALSE, qr = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ices_+3A_formula">formula</code></td>
<td>
<p>a formula object specifying the full regression model.</p>
</td></tr>
<tr><td><code id="ices_+3A_data">data</code></td>
<td>
<p>a data frame containing observations on the response variable and the predictor variables.</p>
</td></tr>
<tr><td><code id="ices_+3A_model">model</code>, <code id="ices_+3A_x">x</code>, <code id="ices_+3A_y">y</code>, <code id="ices_+3A_qr">qr</code></td>
<td>
<p>logicals.  If <code>TRUE</code> the corresponding components of
the fit (the model frame, the model matrix, the response, the
QR decomposition) are returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a QRS class object
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>a named numeric vector of coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>a numeric vector containing the response minus the fitted values. </p>
</td></tr>
<tr><td><code>effects</code></td>
<td>
<p>a numeric vector of containing the projections of the response variable under the orthogonal
Q matrix coming from the QR decomposition of the model matrix.</p>
</td></tr> 
<tr><td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model. </p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the estimated response values according to the fitted interrupted coefficient estimation
selection regression model.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>the estimated noise variance based on the n-p residual effects, where p is the size of the full model.</p>
</td></tr>
<tr><td><code>std_error</code></td>
<td>
<p>a numeric vector of standard errors.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>a numeric matrix containing the model matrix.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>a numeric vector containing the response variable values.</p>
</td></tr>
<tr><td><code>qr</code></td>
<td>
<p>the QR decomposition object coming from the model matrix (after re-ordering columns).</p>
</td></tr>
<tr><td><code>coefOrder</code></td>
<td>
<p>permutation of the sequence 1:p which gives the 
ascending order of the coefficients of the linear model object, as a result of the pre-screening.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the terms object used.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>a character vector containing the column names of the model matrix.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>if requested (the default), the model frame used in the case of the full regression model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ladan Tazik, W.J. Braun</p>


<h3>See Also</h3>

<p><code>lm.R</code>, <code>QRS.R</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    myRegressionData &lt;- rmultreg(50, k=10, p=.25, sdnoise = .5)
    pairs(myRegressionData$data)
    out &lt;- ices(y ~ ., data = myRegressionData$data) # fit model to simulated data
    confint(out) # calculate 95 % confidence intervals for all coefficients
    myRegressionData$coefficients # compare with true coefficients
</code></pre>

<hr>
<h2 id='MSDecision'>Multiple Sclerosis Decision Delay</h2><span id='topic+MSDecision'></span>

<h3>Description</h3>

<p>This data frame contains the time (in weeks) between the initial
symptoms (onset symptoms) and the decision time to visit a doctor
in the case of 54 patients who eventually were diagnosed with multiple
sclerosis. Interest centers on whether there are any factors which 
tend to be related to the delay time.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MSDecision)</code></pre>


<h3>Format</h3>

<p>A data frame with 54 observations on the following 16 variables.
</p>

<dl>
<dt><code>Delay</code></dt><dd><p>numeric, time in weeks</p>
</dd>
<dt><code>ClinicalDiseaseCourse</code></dt><dd><p>factor, 2 levels</p>
</dd>   
<dt><code>CodedGender</code></dt><dd><p>factor, 2 levels, 1 = Male, 2 = Female</p>
</dd>        
<dt><code>AgeAtOnset</code></dt><dd><p>numeric, age in years</p>
</dd>
<dt><code>OnsetSymptom1</code></dt><dd><p>factor, 4 levels</p>
</dd>
<dt><code>OnsetSymptom2</code></dt><dd><p>factor, 5 levels</p>
</dd>
<dt><code>OnsetSymptomSeverity</code></dt><dd><p>factor, 2 levels, 0 = Low, 1 = High</p>
</dd>
<dt><code>TriggerSymptom1</code></dt><dd><p>factor, 4 levels</p>
</dd>         
<dt><code>TriggerSymptom2</code></dt><dd><p>factor, 4 levels</p>
</dd>
<dt><code>TriggerSymptomSeverity</code></dt><dd><p>factor, 2 levels, 0 = Low, 1 = High</p>
</dd>
<dt><code>FamilyHistory</code></dt><dd><p>factor, 2 levels, yes = there is MS in the family history</p>
</dd>
<dt><code>FearOfWorseningSymptoms</code></dt><dd><p>factor, 2 levels</p>
</dd>
<dt><code>MoreThanOneSymptom</code></dt><dd><p>factor, 2 levels</p>
</dd>
<dt><code>EffectonResponsibilities</code></dt><dd><p>factor, 2 levels, yes = the symptoms are having an effect on the individual</p>
</dd>
<dt><code>UncertainResponse</code></dt><dd><p>logical, TRUE = recorded delay time is not accurate</p>
</dd>
</dl>



<h3>Details</h3>

<p>The levels of the Clinical Disease Course variable are:
Clinically Isolated Syndrome and Relapse-Remitting.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   xy &lt;- MSDecision
   xy$sensoryOnset1 &lt;- factor(xy$OnsetSymptom1=="SENSORY")
   xy$brainstemOnset2 &lt;- factor(xy$OnsetSymptom2=="BRAINSTEM")
   xy$sensoryTrigger1 &lt;- factor(xy$TriggerSymptom1=="SENSORY")
   xy$brainstemTrigger2 &lt;- factor(xy$TriggerSymptom2=="BRAINSTEM")
   xy &lt;- xy[, -c(5, 6, 8, 9, 15)]
   xy[,1]&lt;-log(xy[,1])
   names(xy)[1] &lt;- "y"
   out &lt;- ices(y ~ ., data = xy)
   summary(out)
   plot(out) 
   plot(out, normqq=TRUE)
   plot(out, scaleloc=TRUE)
</code></pre>

<hr>
<h2 id='plot.QRS'>plot.QRS</h2><span id='topic+plot.QRS'></span>

<h3>Description</h3>

<p>By default, this function plots residuals from
the interrupted coefficient estimation selection model versus the corresponding fitted values. Alternatively, options to obtain a normal QQ plot or a scale-location plot of the residuals are also available.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'QRS'
plot(x, normqq = FALSE, scaleloc = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.QRS_+3A_x">x</code></td>
<td>
<p>an object of QRS class</p>
</td></tr>
<tr><td><code id="plot.QRS_+3A_normqq">normqq</code></td>
<td>
<p>a logical value, if TRUE,  a normal QQ plot of the residuals will be plotted.</p>
</td></tr> 
<tr><td><code id="plot.QRS_+3A_scaleloc">scaleloc</code></td>
<td>
<p>a logical value, if TRUE,  a scale-location plot of the residuals will be plotted.</p>
</td></tr> 
<tr><td><code id="plot.QRS_+3A_...">...</code></td>
<td>
<p>arguments to be passed to plot methods, such as graphical parameters (see par). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value</p>


<h3>Author(s)</h3>

<p>Ladan Tazik, W.J. Braun</p>


<h3>See Also</h3>

<p><code>plot.lm</code>
</p>

<hr>
<h2 id='QRS'>QR Regression Selection and Estimation</h2><span id='topic+QRS'></span>

<h3>Description</h3>

<p>Given a design matrix and a response variable, create a list which has the fitted model, estimated regression coefficents and standard error based on interrupted coefficient estimation selection.</p>


<h3>Usage</h3>

<pre><code class='language-R'>QRS(x, y, Nsims)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QRS_+3A_x">x</code></td>
<td>
<p>a numeric matrix; usually the model matrix for a multiple regression model.</p>
</td></tr>
<tr><td><code id="QRS_+3A_y">y</code></td>
<td>
<p>a numeric vector; usually the values of the response variable in the regression model.</p>
</td></tr>
<tr><td><code id="QRS_+3A_nsims">Nsims</code></td>
<td>
<p>number of simulation runs required for estimating the regression coefficient standard errors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interrupted coefficient estimation selection
procedure begins with consideration of a full model whereby a regression model with p terms is fit to
n observations on a response and p-1 predictor variables.  The variables are pre-screened by application
of lm in order to cast the columns of the model matrix in increasing order of the p-values observed
for the corresponding regression coefficients.    The estimation then proceeds by the usual QR decomposition
of the model matrix but is interrupted at the effects stage.  The effects are classified as &quot;different from 0&quot;
or &quot;not different from 0&quot;, according to what is essentially a control chart procedure. The effects that are &quot;not
different from 0&quot; are replaced with true 0's and the nonzero effects are left alone. The estimation is completed
by backward-substitution solution of the zero and nonzero effects using the upper triangular matrix from
the QR decomposition.  The result is a set of coefficient estimates that will tend to be more accurate
in a mean-squared-error sense than the original lm coefficient estimates, especially when some or all
of the regression coefficients are 0. Coefficient standard error estimates are obtained by a parametric
bootstrap procedure.  This method is not recommended for strongly non-normal data, or where there is 
substantial multicollinearity.</p>


<h3>Value</h3>

<p>a QRS class object
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>a named numeric vector of coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>a numeric vector containing the response minus the fitted values. </p>
</td></tr>
<tr><td><code>effects</code></td>
<td>
<p>a numeric vector of containing the projections of the response variable under the orthogonal
Q matrix coming from the QR decomposition of the model matrix.</p>
</td></tr> 
<tr><td><code>rank</code></td>
<td>
<p> the numeric rank of the fitted linear model. </p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the estimated response values according to the fitted interrupted coefficient estimation
selection regression model.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>the estimated noise variance based on the n-p residual effects, where p is the size of the full model.</p>
</td></tr>
<tr><td><code>std_error</code></td>
<td>
<p>a numeric vector of standard errors.</p>
</td></tr>
<tr><td><code>qr</code></td>
<td>
<p>the QR decomposition object coming from the model matrix (after re-ordering columns).</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p> he residual degrees of freedom.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>if requested (the default), the model frame used.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>a numeric matrix containing the model matrix.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>a numeric vector containing the response variable values.</p>
</td></tr>
<tr><td><code>coefOrder</code></td>
<td>
<p>A permutation of the sequence 1:p which gives the 
ascending order of the coefficients of the linear model object, as a result of the pre-screening.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>a character vector containing the column names of the model matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ladan Tazik, W.J. Braun</p>


<h3>See Also</h3>

<p><code>ices.R</code>, <code>lm.R</code>
</p>

<hr>
<h2 id='rmultreg'>
Multiple Regression Data Generator
</h2><span id='topic+rmultreg'></span>

<h3>Description</h3>

<p>Values of any number of predictor variables and a single response variable 
are simulated according to a model with randomly generated coefficients. 
Values of each predictor are simulated independently from standard normal 
distributions.  The regression coefficients are generated independently
from a uniform distribution on the interval (minimum, maximum), and each
coefficient is multiplied by a Bernoulli (p) variate, independent of 
the other coefficients.  This results in some of the coefficients being
zeroed out.  Noise is added to the regression response according to
independent t variates with degrees of freedom equal to dfnoise. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmultreg(n, k = 1, minimum = 0, maximum = 1, p = 0.5, dfnoise = 100, sdnoise = 1) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmultreg_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="rmultreg_+3A_k">k</code></td>
<td>
<p>number of predictor variables in addition to the intercept.</p>
</td></tr>
<tr><td><code id="rmultreg_+3A_minimum">minimum</code></td>
<td>
<p>minimum possible value for the regression coefficients, apart, possibly, from some zeroes.</p>
</td></tr>
<tr><td><code id="rmultreg_+3A_maximum">maximum</code></td>
<td>
<p>maximum possible value for the regression coefficients, apart, possibly, from some zeroes.</p>
</td></tr>
<tr><td><code id="rmultreg_+3A_p">p</code></td>
<td>
<p>probability that a given regression coefficient remains nonzero.</p>
</td></tr>
<tr><td><code id="rmultreg_+3A_dfnoise">dfnoise</code></td>
<td>
<p>degrees of freedom for t-distributed additive noise.</p>
</td></tr>
<tr><td><code id="rmultreg_+3A_sdnoise">sdnoise</code></td>
<td>
<p>standard deviation of the noise term.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>a dataframe containing n observations on k predictor variables and a response y.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>a numeric vector containing the true regression coefficients.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>W.J. Braun
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    myRegressionData &lt;- rmultreg(50, k=3, p=.5, sdnoise = .25)
    pairs(myRegressionData$data)
    out &lt;- ices(y ~ ., data = myRegressionData$data) # fit model to simulated data
    confint(out) # calculate 95% confidence intervals for all coefficients
    myRegressionData$coefficients # compare with true coefficients
</code></pre>

<hr>
<h2 id='summary.QRS'>summary.QRS</h2><span id='topic+summary.QRS'></span>

<h3>Description</h3>

<p>summary method for class &quot;qrs&quot;</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'QRS'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.QRS_+3A_object">object</code></td>
<td>
<p> an abject of class &quot;qrs&quot;</p>
</td></tr>
<tr><td><code id="summary.QRS_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function computes and returns a list of summary statistics of the fitted linear model given in the  QRS object.
</p>
<table role = "presentation">
<tr><td><code>Residuals</code></td>
<td>
<p>the weighted residuals, the usual residuals rescaled by the square root of the weights specified in the call to qrs</p>
</td></tr>
<tr><td><code>Coefficients</code></td>
<td>
<p>a p x 4 matrix with columns for the estimated coefficient, its standard error, z-score and corresponding (two-sided) probabilities</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code>residualStandardError</code></td>
<td>
<p>Residual standard error</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ladan Tazik, W.J.Braun</p>


<h3>See Also</h3>

<p><code>QRS.R</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    myRegressionData &lt;- rmultreg(25, k=5, p=.15, sdnoise = .25)
    pairs(myRegressionData$data)
    out &lt;- ices(y ~ ., data = myRegressionData$data) # fit model to simulated data
    summary(out) # estimates and standard errors for all coefficients
    myRegressionData$coefficients # compare with true coefficients
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
