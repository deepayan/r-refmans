<!DOCTYPE html><html><head><title>Help for package perspectev</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {perspectev}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hr.mcp'>
<p>Home range estimation</p></a></li>
<li><a href='#perspectev-Datasets'><p>Supplied data sets</p></a></li>
<li><a href='#perspectev-internal'><p>Internal Functions</p></a></li>
<li><a href='#perspectev-package'>
<p>Permutation of Species During Turnover Events</p></a></li>
<li><a href='#perspectev.calc'>
<p>Calculate upper and lower level trait values and survivorship</p></a></li>
<li><a href='#perspectev.plot'>
<p>Plotting function for permutation analysis</p></a></li>
<li><a href='#perspectev.read'>
<p>Convert occurrence data to perspectev input format</p></a></li>
<li><a href='#perspectev.simulate'>
<p>Simulate upper/lower level selection at different intensities and observe resulting p values.</p></a></li>
<li><a href='#perspectev.test'>
<p>Test for irreducibility of relationship between upper level traits and survivorship</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Permutation of Species During Turnover Events</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-08-07</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kenneth B. Hoehn &lt;perspectev@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), ggplot2, foreach, ape, doParallel, parallel,
grDevices, stats, methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>mapproj, boot, sp</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a robust framework for analyzing the extent to which differential survival with respect to higher level trait variation is reducible to lower level variation. In addition to its primary test, it also provides functions for simulation-based power analysis, reading in common data set formats, and visualizing results. Temporarily contains an edited version of function hr.mcp() from package 'wild1', written by Glen Sargeant. For tutorial see: http://evolve.zoo.ox.ac.uk/Evolve/Perspectev.html.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-08-09 17:28:24 UTC; ken</td>
</tr>
<tr>
<td>Author:</td>
<td>Kenneth B. Hoehn [aut, cre],
  Glen A. Sargeant [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-08-09 20:41:37</td>
</tr>
</table>
<hr>
<h2 id='hr.mcp'>
Home range estimation
</h2><span id='topic+hr.mcp'></span>

<h3>Description</h3>

<p>Compute and plot a minimum convex polygon estimate of &quot;home range.&quot; Source code borrowed from wild1 package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hr.mcp(x,y=NULL,n.min=50,plot=TRUE,add=FALSE,ID=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hr.mcp_+3A_x">x</code></td>
<td>

<p>A vector, matrix, or data frame of coordinates.
</p>
</td></tr>
<tr><td><code id="hr.mcp_+3A_y">y</code></td>
<td>

<p>A numeric vector (if <code>x</code> is a vector) or <code>NULL</code> 
</p>
</td></tr>
<tr><td><code id="hr.mcp_+3A_n.min">n.min</code></td>
<td>

<p>If <code>x</code> includes fewer than <code>n.min</code> points, the function will return <code>NA</code> and a warning.
</p>
</td></tr>
<tr><td><code id="hr.mcp_+3A_plot">plot</code></td>
<td>

<p>Parameter nonfunctional for perspectev implementation of this function.
</p>
</td></tr>
<tr><td><code id="hr.mcp_+3A_add">add</code></td>
<td>

<p>Logical. Add to existing plot on current output device?  Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="hr.mcp_+3A_id">ID</code></td>
<td>

<p>Required argument from Polygons
</p>
</td></tr>
<tr><td><code id="hr.mcp_+3A_...">...</code></td>
<td>

<p>Optional arguments for <code><a href="graphics.html#topic+plot">plot</a></code> or <code><a href="graphics.html#topic+points">points</a></code> (see also <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See plot.Polygons for another way of plotting polygon objects.
</p>


<h3>Value</h3>

<p>Returns an object of class Polygons (sp).
</p>


<h3>Author(s)</h3>

<p>Glen A. Sargeant<br />
U.S. Geological Survey<br />
Northern Prairie Wildlife Research Center<br />
<a href="mailto:glen_sargeant@usgs.gov">glen_sargeant@usgs.gov</a>
</p>
<p>Edited by Kenneth B. Hoehn<br />
<a href="mailto:perspectev@gmail.com">perspectev@gmail.com</a>
</p>

<hr>
<h2 id='perspectev-Datasets'>Supplied data sets</h2><span id='topic+occurrence_data'></span><span id='topic+testData'></span>

<h3>Description</h3>

<p>Occurrence data used in perspectev tutorial, and test data set used for checking.
</p>


<h3>Details</h3>

<p><b>occurrence_data</b>:  See online tutorial for futher information.<br />
</p>

<hr>
<h2 id='perspectev-internal'>Internal Functions</h2><span id='topic+perspectev.permute'></span><span id='topic+perspectev.simulation.permute'></span><span id='topic+mcpRange'></span><span id='topic+t1Range'></span><span id='topic+t2Range'></span><span id='topic+t1Var'></span><span id='topic+t2Var'></span><span id='topic+t1t2Covar'></span><span id='topic+t1Unique'></span><span id='topic+t2Unique'></span><span id='topic+t1t2Unique'></span><span id='topic+dnaTheta'></span>

<h3>Description</h3>

<p>Internal perspectev functions
</p>


<h3>Details</h3>

<p>These are not meant to be called by the user except potentially as trait functions. See tutorial for details (http://evolve.zoo.ox.ac.uk/Evolve/Perspectev.html).
</p>

<hr>
<h2 id='perspectev-package'>
Permutation of Species During Turnover Events
</h2><span id='topic+perspectev-package'></span><span id='topic+perspectev'></span>

<h3>Description</h3>

<p>Provides a robust framework for analyzing the reducibility of differential survival with respect to higher level trait variation. In addition to its primary test, it also provides functions for simulation-based power analysis, reading in common data set formats, and visualizing results. For tutorial see: http://evolve.zoo.ox.ac.uk/Evolve/Perspectev.html.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> perspectev</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-08-07</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Kenneth B. Hoehn &lt;perspectev@gmail.com&gt;
</p>

<hr>
<h2 id='perspectev.calc'>
Calculate upper and lower level trait values and survivorship
</h2><span id='topic+perspectev.calc'></span>

<h3>Description</h3>

<p>Calculates upper and lower level trait values and survivorship given a data set and trait functions</p>


<h3>Usage</h3>

<pre><code class='language-R'>perspectev.calc(data,traitfun,vlist=list(),na.rm=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perspectev.calc_+3A_data">data</code></td>
<td>

<p>Dataframe in perspectev format (see below).</p>
</td></tr>
<tr><td><code id="perspectev.calc_+3A_traitfun">traitfun</code></td>
<td>

<p>Function for calculating trait value at each level.
</p>
</td></tr>
<tr><td><code id="perspectev.calc_+3A_vlist">vlist</code></td>
<td>

<p>Optional variable list for trait function.
</p>
</td></tr>
<tr><td><code id="perspectev.calc_+3A_na.rm">na.rm</code></td>
<td>

<p>Remove NA values from trait functions? Shouldn't need to be used if trim=TRUE from perspectev.read.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>upper</code></td>
<td>
<p>Table of survivorship and trait value at upper level (scaled to mean 0 and variance 1)</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>Table of survivorship and trait value at lower level (scaled to mean 0 and variance 1)</p>
</td></tr>
<tr><td><code>stats</code></td>
<td>
<p>[1]: correlation between upper level trait and survivorship, [2-4]: quantiles of upper level trait values (unscaled)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kenneth B. Hoehn &lt;perspectev@gmail.com&gt;
</p>

<hr>
<h2 id='perspectev.plot'>
Plotting function for permutation analysis
</h2><span id='topic+perspectev.plot'></span>

<h3>Description</h3>

<p>Make plots to summarize permutation results and power analysis results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perspectev.plot(observed, simulated, names, title)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perspectev.plot_+3A_observed">observed</code></td>
<td>

<p>Object returned from perspectev.test().
</p>
</td></tr>
<tr><td><code id="perspectev.plot_+3A_simulated">simulated</code></td>
<td>

<p>List of up to eight objects obtained from perspectev.simulate().
</p>
</td></tr>
<tr><td><code id="perspectev.plot_+3A_names">names</code></td>
<td>

<p>Names of each object in the list provided to &quot;simulated&quot; in order.
</p>
</td></tr>
<tr><td><code id="perspectev.plot_+3A_title">title</code></td>
<td>

<p>Title of the plot. Optional.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kenneth B. Hoehn &lt;perspectev@gmail.com&gt;
</p>

<hr>
<h2 id='perspectev.read'>
Convert occurrence data to perspectev input format
</h2><span id='topic+perspectev.read'></span>

<h3>Description</h3>

<p>Convert occurrence data (each row a separate occurrence) into standardized perspectev format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>perspectev.read(data,upper,lower,traits,survProb,traitfun,extinctionAge=NULL,
  occurrenceAge=NULL,vlist=NULL,trim=TRUE,
  projection=FALSE,quiet=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perspectev.read_+3A_data">data</code></td>
<td>

<p>Occurrence data. This must list each occurrence on a separate row, with upper/lower level classification specified in separate columns, as well as one or more columns specifying the trait-data for that occurrence (e.g. latitude and longitude). For example see data(occurrence_data).
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_upper">upper</code></td>
<td>

<p>Column name designation for upper level names.
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_lower">lower</code></td>
<td>

<p>Column name designation for lower level names.
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_traits">traits</code></td>
<td>

<p>A column name (string) or vector of column names which correspond to the trait data under investigation. The order in which trait names are specified is important and corresponds to the t1/t2 designation of trait functions.
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_survprob">survProb</code></td>
<td>

<p>Designates lower level survivorship probability, may be either:
1) A dataframe with three columns: Upper name, lower name, survivorship probability.
Preferred option - compatible with continuous survivorship probability.
</p>
<p>2) A dataframe with two columns: Upper name, lower name. 
Specifies lower units named as survivorship probability = 1, and all others as 0.
</p>
<p>3) A vector of names of surviving lower level units. 
Upper and lower names must be separated by a space.
</p>
<p>If unspecified will assign survivorship based on occurrenceAge and extinctionAge.
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_occurrenceage">occurrenceAge</code></td>
<td>

<p>Column name desigation for the age of the occurrence. Only necessary if survProb unspecified, and will be ignored if survProb is specified.
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_extinctionage">extinctionAge</code></td>
<td>

<p>Age of the extinction in backward time. E.g. 65.5 for K-Pg mass extinction if occurrenceAge is in mya. Occurrences with ages greater than or equal to extinctionAge will be used to calculate trait values, and lower level units with occurrences before and after extinctionAge are marked as survivors. Lower level units with occurrences only after extinctionAge are excluded. Only necessary if survProb unspecified, and will be ignored if survProb is specified.
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_traitfun">traitfun</code></td>
<td>

<p>Function for calculating trait values at each level. Not necessary if trim=FALSE.
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_vlist">vlist</code></td>
<td>

<p>Optional variable list for trait function.
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_trim">trim</code></td>
<td>

<p>Remove lower levels that give NA's from trait function? (recommended)
</p>
</td></tr>
<tr><td><code id="perspectev.read_+3A_projection">projection</code></td>
<td>

<p>Convert coordinates to a Mollweide projection?
</p>
</td></tr> 
<tr><td><code id="perspectev.read_+3A_quiet">quiet</code></td>
<td>

<p>Suppress information messages?
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Function specifies traits under analysis and survivorship probabilities of lower level units. See tutorial (http://evolve.zoo.ox.ac.uk/Evolve/Perspectev.html) for examples.
</p>
<p>Traits are specified by supplying the column names of trait data values (e.g. Latitude and Longitude) as a vector. The order in which the traits are specified is important, as this will be the basis of the index in trait functions (first in vector is first in trait list, second in vector is second in trait list, etc..). You can check this after the fact using the Key value. If trim=TRUE, supply a trait function using the traitfun parameter, and this function will remove all lower units which give an NA value in the trait function (e.g. having &lt; 3 distinct coordinates for MCP range).
</p>
<p>Survivorship probability may be specified in four ways:
</p>
<p>1) The best way is to supply a dataframe to survProb. This data frame should be of column format: &lt;Upper Name&gt; &lt;Lower Name&gt; &lt;Survivorship Probability&gt;, and should specify a survivorship probability for all lower level units in the occurrence data.
</p>
<p>2) Similar to 1), but a dataframe of column format: &lt;Upper Name&gt; &lt;Lower Name&gt;. This will assign all lower units specified as having a survivorship probability of 1, and all others as 0.
</p>
<p>3) Similar to 2), but a vector of names formed by pasting Upper and Lower names together, separated by a space (e.g. c(&quot;Genus1 Species1&quot;, &quot;Genus2 Species2&quot;)) 
</p>
<p>4) Specifying occurrenceAge and extinctionAge. occurrenceAge is the column name for the age of the occurrences, and extinctionAge is the age of the extinction (both in backward time). All units with occurrences that only occur after the extinction are discarded. All units that have some occurrences with ages &lt; extinctionAge, and some occurrences &gt;= extinctionAge (found before and after extinction) are assigned survivorship = 1. All those which only have occurrences &gt;= extinctionAge are assigned survivorship = 0. Note that this will assign any lower level entity found both before/during and after the extinctionAge parameter as a survivor, while any lower level entity only found in the beginning will be listed as a victim. Specifying these parameters is only necessary if survProb is unspecified, and they will be ignored if it is.
</p>
<p>In all cases it is important to ensure your data set does not span too far back, because all occurrences provided, unless otherwise stated (see 4, above), will be used to calculate trait values. This is may or may not be good.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Survivorship</code></td>
<td>
<p>Dataframe containing upper/lower level classification and survivorship probability for each lower level unit.</p>
</td></tr>
<tr><td><code>Traits</code></td>
<td>
<p>List containing trait data vectors for each lower level unit.</p>
</td></tr>
<tr><td><code>Key</code></td>
<td>
<p>Shows indexes of trait values in Traits list, corresponds to order used in &quot;traits&quot; parameter.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kenneth B. Hoehn &lt;perspectev@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(testData)
  survivorship = data.frame(cbind(testData$Genus,testData$Species,runif(nrow(testData),0,1)))
  data = perspectev.read(testData,survProb=survivorship,
  upper="Genus",lower="Species",traits=c("Lat","Long"),traitfun=mcpRange,
  projection=FALSE)
</code></pre>

<hr>
<h2 id='perspectev.simulate'>
Simulate upper/lower level selection at different intensities and observe resulting p values.
</h2><span id='topic+perspectev.simulate'></span>

<h3>Description</h3>

<p>Perform simulations of natural selection on a data set, and observe what p values result. Performs linear transformation of trait vs. survivorship (using provided or fitted slope and intercept) and then transforms into survviorship probabilites using inv.logit function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perspectev.simulate(data,simulations,cores,traitfun=mcpRange,vlist=NULL,
	binary=NA,intercept=NA,slope=NA,level=NA,noise=0,fit=FALSE,quiet=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perspectev.simulate_+3A_data">data</code></td>
<td>

<p>Dataframe in perspectev format. See ?perspectev.read for more information.</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_simulations">simulations</code></td>
<td>

<p>Number of simulations to perform. At least 1000 is recommended but can be slow.</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_cores">cores</code></td>
<td>

<p>Number of cores over which to parallelize the simulations.</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_traitfun">traitfun</code></td>
<td>

<p>Function for calculating trait value at each level.
</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_vlist">vlist</code></td>
<td>

<p>Optional variable list for trait function.
</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_intercept">intercept</code></td>
<td>

<p>Intercept of the regression between range and survivorship. Can be manually provided or, if not provided, is fit to the data set. Will attempt to set automatically if unspecified.
</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_slope">slope</code></td>
<td>

<p>Slope of the regression between range and survivorship. Can be manually provided or, if not provided, is fit to the data set. Will attempt to set automatically if unspecified.
</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_level">level</code></td>
<td>

<p>Simulate either upper or lower level selection. Accepts either &quot;lower&quot; or &quot;upper&quot; respectively. Will set to 'upper' if unspecified.
</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_noise">noise</code></td>
<td>

<p>Extra stochasticity to the simulation. 
</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_fit">fit</code></td>
<td>

<p>Fit simulation to observed parameters? Will do automatically if intercept or slope are not specified.
</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_binary">binary</code></td>
<td>

<p>Is survivorship binary or continuous? Will attempt to set automatically if unspecified.
</p>
</td></tr>
<tr><td><code id="perspectev.simulate_+3A_quiet">quiet</code></td>
<td>

<p>Suppress information messages?
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>correlation_simulated</code></td>
<td>
<p>Correlation between trait and surivovorship from permuted groups at each simulation.</p>
</td></tr>
<tr><td><code>correlation_observed</code></td>
<td>
<p>Observed correlation between trait and surivovorship from simulated groups.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>p value observed under simulation of selection.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Level of simulated selection.</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>Intercept of simulation.</p>
</td></tr>
<tr><td><code>slope</code></td>
<td>
<p>Slope of the simulation.</p>
</td></tr>
<tr><td><code>noise</code></td>
<td>
<p>Noise level selected for simulation.</p>
</td></tr>
<tr><td><code>fitted_model</code></td>
<td>
<p>Was the model fitted to the data set?</p>
</td></tr>
</table>


<h3>Note</h3>

<p>See original publication and tutorial for more information on simulation.
</p>


<h3>Author(s)</h3>

<p>Kenneth B. Hoehn &lt;perspectev@gmail.com&gt;
</p>

<hr>
<h2 id='perspectev.test'>
Test for irreducibility of relationship between upper level traits and survivorship
</h2><span id='topic+perspectev.test'></span>

<h3>Description</h3>

<p>Performs permutation tests by permuting upper level labels between lower levels, recalculating upper trait value, and taking the correlation between upper level trait and survivorship. This process is repeated until a null distribution is generated. This is then compared against observed covariance to give a p value for the null hypothesis that a relationship between trait and survivorship is explainable by random aggregations of lower level traits.</p>


<h3>Usage</h3>

<pre><code class='language-R'>perspectev.test(data,iterations=1000,cores=1,traitfun=mcpRange,vlist=NULL,na.rm=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perspectev.test_+3A_data">data</code></td>
<td>

<p>Dataframe in perspectev format (see ?perspectev.read).</p>
</td></tr>
<tr><td><code id="perspectev.test_+3A_iterations">iterations</code></td>
<td>

<p>Number of iterations to perform. At least 1000 is recommended, though can be slow.
</p>
</td></tr>
<tr><td><code id="perspectev.test_+3A_cores">cores</code></td>
<td>

<p>Number of cores over which to parallelize the test.
</p>
</td></tr>
<tr><td><code id="perspectev.test_+3A_traitfun">traitfun</code></td>
<td>

<p>Function for calculating trait values at each level.
</p>
</td></tr>
<tr><td><code id="perspectev.test_+3A_vlist">vlist</code></td>
<td>

<p>Optional variable list for trait function.
</p>
</td></tr>
<tr><td><code id="perspectev.test_+3A_na.rm">na.rm</code></td>
<td>

<p>Remove NA values from trait functions? Shouldn't need to be used if trim=TRUE from perspectev.read.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>correlation_permuted</code></td>
<td>
<p>Correlations between trait and survivorship obtained from permuted upper levels (Si)</p>
</td></tr>
<tr><td><code>correlation_observed</code></td>
<td>
<p>Observed correlation between upper level trait and survivorship (Ri)</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>Portion of permuted genus correlations (S) larger than observed value (R)</p>
</td></tr>
<tr><td><code>permuted_quantiles</code></td>
<td>
<p>Matrix of interquartile trait values obtained from each upper level permutation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kenneth B. Hoehn &lt;perspectev@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(testData)

  	data = perspectev.read(testData,extinctionAge=5,occurrenceAge="Age",
  	upper="Genus",lower="Species",traits=c("Lat","Long"),traitfun=mcpRange,projection=FALSE)

  	#4 iterations chosen out of convenience - use more!
	mcpTest  = perspectev.test(data,4,1,traitfun=mcpRange)
	mcpSim  = perspectev.simulate(data,4,1,traitfun=mcpRange)
	perspectev.plot(mcpTest,list(mcpSim),c("S1"),"Test")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
