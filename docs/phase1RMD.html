<!DOCTYPE html><html><head><title>Help for package phase1RMD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phase1RMD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eff_dat'><p>Patient efficacy data</p></a></li>
<li><a href='#GenToxProb'>
<p>Toxicity Probability Matrices Generation for Trial Simulation</p></a></li>
<li><a href='#parm'><p> Create prior for the phase 1 dose-finding model</p></a></li>
<li><a href='#patdata'><p>Patient toxicity data</p></a></li>
<li><a href='#plot.RunRMDVal'><p>plot nTTP Toxicity-based in cycle 1 for all doses.</p></a></li>
<li><a href='#probaT'><p>The probability matrix of toxicity events</p></a></li>
<li><a href='#RunRMD'><p>Toxicity-based Dose estimation for the next patient cohort.</p></a></li>
<li><a href='#RunRMDEFF'>
<p>Interactive Implementation for an Adaptive, Multi-Stage Phase I Dose-Finding Design</p></a></li>
<li><a href='#SimRMD'><p>Simulate trial characters of the phase I dose-finding design.</p></a></li>
<li><a href='#SimRMDEFF'>
<p>Simulation for an Adaptive, Multi-Stage Phase I Dose-Finding Design</p></a></li>
<li><a href='#tox_dat'><p>Patient toxicity data</p></a></li>
<li><a href='#tox_dat_bytype'><p>Patient toxicity data</p></a></li>
<li><a href='#tox.matrix'><p>Probability matrix for toxicity</p></a></li>
<li><a href='#Tox2nTTP'><p>Compute the nTTP score baed on the observed toxicity.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-08</td>
</tr>
<tr>
<td>Title:</td>
<td>Repeated Measurement Design for Phase I Clinical Trial</td>
</tr>
<tr>
<td>Author:</td>
<td>Jun Yin, Yu Du, Sumithra Mandrekar</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jun Yin &lt;vivien.jyin@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), coda, boot, rjags, mvtnorm, ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>BiocParallel</td>
</tr>
<tr>
<td>Imports:</td>
<td>arrayhelpers</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements our Bayesian phase I repeated measurement design that accounts for multidimensional toxicity endpoints from multiple treatment cycles. The package also provides a novel design to account for both multidimensional toxicity endpoints and early-stage efficacy endpoints in the phase I design. For both designs, functions are provided to recommend the next dosage selection based on the data collected in the available patient cohorts and to simulate trial characteristics given design parameters. Yin, Jun, et al. (2017) &lt;<a href="https://doi.org/10.1002%2Fsim.7134">doi:10.1002/sim.7134</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-11 15:07:36 UTC; ec2-user</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-11 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='eff_dat'>Patient efficacy data</h2><span id='topic+eff_dat'></span>

<h3>Description</h3>

<p>This data set provides the efficacy data from 22 patients. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eff_dat</code></pre>


<h3>Format</h3>

<p>A matrix containing 22 observations.</p>


<h3>Source</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.</p>


<h3>References</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.
</p>

<hr>
<h2 id='GenToxProb'>
Toxicity Probability Matrices Generation for Trial Simulation
</h2><span id='topic+GenToxProb'></span>

<h3>Description</h3>

<p>A function to generate toxicity probability matrices employing proportional odds model, used as input for trial simulation. The generated matrices are a four-dimension array containing the probabilities of the occurrences of certain grades for certain types of toxicities, at each dose level and cycle under consideration. Dimension 1 refers to doses; dimension 2 corresponds to cycles of the treatment; dimension 3 regards the types of toxicities while dimenion 4 relates to grades.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenToxProb(toxtype = c("Neurological", "Renal", "Hematological"), 
           intercept.alpha = c(2, 3, 4.2, 5.7), 
           coef.beta = c(-0.2, -0.4, -0.7), 
           cycle.gamma = 0, MaxCycle = 6, Numdose = 6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenToxProb_+3A_toxtype">toxtype</code></td>
<td>
<p>A character vector, specifying toxicity types considered in the trial.</p>
</td></tr>
<tr><td><code id="GenToxProb_+3A_intercept.alpha">intercept.alpha</code></td>
<td>
<p>A four element numeric vector specifying the intercepts for the cumulative probabilities of the occurrences of grades 0-4 of toxicities in proportional odds model. See Details below.</p>
</td></tr>
<tr><td><code id="GenToxProb_+3A_coef.beta">coef.beta</code></td>
<td>
<p>A <code class="reqn">n</code> numeric vector specifying the slope for dose in proportional odds model for <code class="reqn">n</code> types of toxicities. See Details below.</p>
</td></tr>
<tr><td><code id="GenToxProb_+3A_cycle.gamma">cycle.gamma</code></td>
<td>
<p>A scalar controlling the cycle effect in simulation in proportional odds model. See Details below.</p>
</td></tr>
<tr><td><code id="GenToxProb_+3A_maxcycle">MaxCycle</code></td>
<td>
<p>Maximum of number of cycles of the treatment.</p>
</td></tr>
<tr><td><code id="GenToxProb_+3A_numdose">Numdose</code></td>
<td>
<p>The number of doses under investigation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability matrices of the occurrences of certain grades for certain types of toxicities, at each dose level and cycle are simulated from a proportional odds model that takes <code>toxtype</code>, <code>intercept.alpha</code>, <code>coef.beta</code> and <code>cycle.gamma</code> as the inputs. The model is as follows:
</p>
<p style="text-align: center;"><code class="reqn">logit(c_j) = \alpha_j + \beta * dose + \gamma * cycle, j=0,1,2,3</code>
</p>

<p>where given a dose and cycle, <code class="reqn">c_j</code> is the cumulative probabilities of occurrences of toxicities grades up to <code class="reqn">j</code>; <code class="reqn">\alpha_0, \alpha_1, \alpha_2, \alpha_3</code> are the intercepts, making up <code>intercept.alpha</code>; <code>coef.beta</code> stores <code class="reqn">\beta</code> for different types of toxicities while <code>cycle.gamma</code> acts as <code class="reqn">\gamma</code>, controlling the cycle effect. The probability for the occurrence of a certain grade of a certain toxicity type at a given dose and cycle is obtained from taking the corresponding differences between cumulative probabilities.
</p>


<h3>Value</h3>

<p>A four-dimension array where dimension 1 refers to doses; dimension 2 corresponds to cycles of the treatment; dimension 3 regards the types of toxicities while dimenion 4 relates to grades.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#tox.matrix &lt;- GenToxProb()
</code></pre>

<hr>
<h2 id='parm'> Create prior for the phase 1 dose-finding model</h2><span id='topic+parm'></span>

<h3>Description</h3>

<p><code>parm</code> creates an S3 object of class <code>parm</code> that contains all necessary prior information to estimate the phase I repeated measures model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parm(prior = c("gamma", "invgamma", "normal"), 
   mean=0, var=100, shape=0.001, scale=0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parm_+3A_prior">prior</code></td>
<td>
<p> a symbolic description of the prior distribution (gamma, invgamma, normal). </p>
</td></tr>
<tr><td><code id="parm_+3A_mean">mean</code></td>
<td>
<p> the prior parameters that are dependent on the distribution that is used. Specifications are gamma(shape, rate), invgamma(shape, scale) and normal(mean,var). </p>
</td></tr>
<tr><td><code id="parm_+3A_var">var</code></td>
<td>
<p> the prior parameters that are dependent on the distribution that is used. Specifications are gamma(shape, rate), invgamma(shape, scale) and normal(mean,var). </p>
</td></tr>
<tr><td><code id="parm_+3A_shape">shape</code></td>
<td>
<p> the prior parameters that are dependent on the distribution that is used. Specifications are gamma(shape, rate), invgamma(shape, scale) and normal(mean,var). </p>
</td></tr>
<tr><td><code id="parm_+3A_scale">scale</code></td>
<td>
<p> the prior parameters that are dependent on the distribution that is used. Specifications are gamma(shape, rate), invgamma(shape, scale) and normal(mean,var). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>parm</code> builds three types of priors: gamma, invgamma and normal. 
</p>
<p>Gamma parameters:
</p>

<ul>
<li> <p><b>shape</b> : shape parameter for Gamma prior for sigma
</p>
</li>
<li> <p><b>rate</b> : rate parameter for Gamma prior for sigma
</p>
</li></ul>

<p>Inverse gamma parameters:
</p>

<ul>
<li> <p><b>shape</b> : shape parameter for the inverse gamma prior on sigma.
</p>
</li>
<li> <p><b>scale</b> : scale parameter for the inverse gamma prior on sigma.
</p>
</li></ul>

<p>Normal parameters:
</p>

<ul>
<li> <p><b>mean</b> : mean parameter for the normal prior.)
</p>
</li>
<li> <p><b>var</b> : variance parameter for the normal prior.)
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>parm</code>, containing information for the prior.
</p>


<h3>Author(s)</h3>

<p>Jun Yin
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup the prior distributions for the phase I dose-finding model:
control &lt;- list(
 beta.dose = parm("normal", mean = 0, var = 1000),
 beta.other = parm("normal", mean = 0, var = 1000 ),
 gamma = parm("normal", mean = 0, var = 100 ),
 s2.gamma = parm("invgamma", shape = 0.001, scale = 0.001),
 s2.epsilon = parm("invgamma", shape = 0.001, scale = 0.001)
 )
</code></pre>

<hr>
<h2 id='patdata'>Patient toxicity data</h2><span id='topic+patdata'></span>

<h3>Description</h3>

<p>This data set provides the toxicity data from multiple treatment cycles. The toxicity data is defined by nTTP toxicity score. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patdata</code></pre>


<h3>Format</h3>

<p>A data frame containing 9 observations.</p>


<h3>Source</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.</p>


<h3>References</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.
</p>

<hr>
<h2 id='plot.RunRMDVal'>plot nTTP Toxicity-based in cycle 1 for all doses.</h2><span id='topic+plot.RunRMDVal'></span>

<h3>Description</h3>

<p><code>plot.RunRMDVal</code> plot the dose-nTTP estimation in cycle based on the RunRMD estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RunRMDVal'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.RunRMDVal_+3A_x">x</code></td>
<td>
<p>The output of RunRMD. An S3 object of 'RunRMDVal' class.</p>
</td></tr>
<tr><td><code id="plot.RunRMDVal_+3A_...">...</code></td>
<td>
<p>Other plot parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot.RunRMDVal</code> function uses the patient data structure <code>patdata</code> to fit the linear mixed model as specified by <code>formula</code> based on the prior distributions as specified by <code>control</code>. The parameters of the MCMC simulation are specified by <code>iter</code>: the number of iterations, <code>burnin</code>: burn-ins, <code>thin</code>: thinning parameter and <code>chains</code>: number of chains in the MCMC simulation. The target nTTP score is defined by <code>tox.target</code>, default = 0.28.
</p>


<h3>Value</h3>

<p>This function plots the dose-nTTP estimation in cycle based on the RunRMD estimation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup the prior distributions for the phase I dose-finding model:
control &lt;- list(
 beta.dose = parm("normal", mean = 0, var = 1000),
 beta.other = parm("normal", mean = 0, var = 1000 ),
 gamma = parm("normal", mean = 0, var = 100 ),
 s2.gamma = parm("invgamma", shape = 0.001, scale = 0.001),
 s2.epsilon = parm("invgamma", shape = 0.001, scale = 0.001)
 )
 
# Load the example patient toxicity data:
#data(patdata)

# Estimate the dose-recommendation of the next patient cohort based on the toxicity data:
#res &lt;- RunRMD(data=patdata, control=control, tox.target=0.28, 
#  iter=2000, burnin=500, thin=1, chains=1)

#plot(res);

</code></pre>

<hr>
<h2 id='probaT'>The probability matrix of toxicity events</h2><span id='topic+probaT'></span>

<h3>Description</h3>

<p>This data set provides the toxicity matrix of 3 types of toxicity events over 6 doses and 5 treatment cycles. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probaT</code></pre>


<h3>Format</h3>

<p>A list containing 3 matrices for the probability for 3 type of toxicity events, each matrix with 6 rows for 6 doses and 5 columns for 5 treatment cycles.</p>


<h3>Source</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.</p>


<h3>References</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.
</p>

<hr>
<h2 id='RunRMD'>Toxicity-based Dose estimation for the next patient cohort.</h2><span id='topic+RunRMD'></span>

<h3>Description</h3>

<p>RunRMD estimate the dosage for the next patient cohort using TTP measured multidimensional toxicity data collected from multiple treatemnt cycles of the existing patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  RunRMD(data, control, trlSize = 36, tox.target = 0.28, 
  sdose = 1:6, strDose = 1, iter=10000, burnin=4000, thin=1, chains=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RunRMD_+3A_data">data</code></td>
<td>
<p>Toxicty data collected from the multiple treatment cycles of existing patient cohorts. </p>
</td></tr>
<tr><td><code id="RunRMD_+3A_control">control</code></td>
<td>
<p>Prior distributions as specified by <code>parm</code> function.</p>
</td></tr>
<tr><td><code id="RunRMD_+3A_trlsize">trlSize</code></td>
<td>
<p>Total number of patients in the trial.</p>
</td></tr>
<tr><td><code id="RunRMD_+3A_tox.target">tox.target</code></td>
<td>
<p>Target toxicity score (default = 0.28).</p>
</td></tr>  
<tr><td><code id="RunRMD_+3A_sdose">sdose</code></td>
<td>
<p>Total number of patients in the trial.</p>
</td></tr>
<tr><td><code id="RunRMD_+3A_strdose">strDose</code></td>
<td>
<p>Start dose.</p>
</td></tr>
<tr><td><code id="RunRMD_+3A_iter">iter</code></td>
<td>
<p>Total number of MCMC simulations (default = 4000).</p>
</td></tr>
<tr><td><code id="RunRMD_+3A_burnin">burnin</code></td>
<td>
<p>Number of burn-ins in the MCMC simulation (default = 1000).</p>
</td></tr>
<tr><td><code id="RunRMD_+3A_thin">thin</code></td>
<td>
<p>Thinning parameter (default = 1).</p>
</td></tr>
<tr><td><code id="RunRMD_+3A_chains">chains</code></td>
<td>
<p>Number of chains in the MCMC simulation (default = 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>RunRMD</code> function uses the patient data structure <code>patdata</code> to fit the linear mixed model as specified by <code>formula</code> based on the prior distributions as specified by <code>control</code>. The parameters of the MCMC simulation are specified by <code>iter</code>: the number of iterations, <code>burnin</code>: burn-ins, <code>thin</code>: thinning parameter and <code>chains</code>: number of chains in the MCMC simulation. The target nTTP score is defined by <code>tox.target</code>, default = 0.28.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr><td><code>nxtdose</code></td>
<td>
<p>Recommended dose for the next patient cohort. </p>
</td></tr>
<tr><td><code>tox.est</code></td>
<td>
<p>Mean, SD, median estimates and 2.5%, 25%, 50%, 75%, 97.5% quantile estimates of the toxicity score at each dose level.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Setup the prior distributions for the phase I dose-finding model:
control &lt;- list(
 beta.dose = parm("normal", mean = 0, var = 1000),
 beta.other = parm("normal", mean = 0, var = 1000 ),
 gamma = parm("normal", mean = 0, var = 100 ),
 s2.gamma = parm("invgamma", shape = 0.001, scale = 0.001),
 s2.epsilon = parm("invgamma", shape = 0.001, scale = 0.001)
 )
 
# Load the example patient toxicity data:
# data(patdata)

# Estimate the dose-recommendation of the next patient cohort based on the toxicity data:
# fit &lt;- RunRMD(data = patdata, control = control, trlSize = 36, tox.target = 0.28, 
#  sdose = 1:6, strDose = 1, iter = 2000, burnin = 500, thin = 1, chains = 1)
  
</code></pre>

<hr>
<h2 id='RunRMDEFF'>
Interactive Implementation for an Adaptive, Multi-Stage Phase I Dose-Finding Design 
</h2><span id='topic+RunRMDEFF'></span>

<h3>Description</h3>

<p>A function to interactively implement an adaptive, multi-stage phase 1 dose-finding design incorporating continuous efficacy and toxicity data from multiple treatment cycles, proposed by Du et al(2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RunRMDEFF(efficacy.dat = NULL, toxicity.dat, trialSize = 36,
          seed = 624, chSize = 3, MaxCycle = 6, doses = 1:6, 
          tox.target = 0.28, p1 = 0.2, p2 = 0.2, ps1 = 0.2, 
          thrd1 = 0.28, thrd2 = 0.28, proxy.thrd = 0.1, 
          dose_flag = 0, param.ctrl = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RunRMDEFF_+3A_efficacy.dat">efficacy.dat</code></td>
<td>
<p>A data frame specifying the efficacy data, which must be of the following form. The first column is the subject ID (character), named &quot;subID&quot;, where &quot;subID&quot; consists of a cohort number and a subject number. For example, &quot;cohort2subject3&quot; denotes the third subject in the second cohort; the second column is dose allocated (integer), named &quot;dose&quot; and the third column is the continuous efficacy (numeric), named &quot;Efficacy&quot;. This data frame is sorted by &quot;subID&quot;. This argument is set to NULL if none of the subjects efficacy measurement is available.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_toxicity.dat">toxicity.dat</code></td>
<td>
<p>A data frame specifying the toxicity data from multiple treatment cycles, which must be of the following form. The first column is the subject ID (character), named &quot;subID&quot;, where &quot;subID&quot; consists of a cohort number and a subject number. For example, &quot;cohort2subject3&quot; denotes the third subject in the second cohort; the second column is dose allocated (integer), named &quot;dose&quot;; the third column, &quot;cycle&quot;, denotes the cycle information (integer); &quot;nTTP&quot;, the fourth column shows the corresponding nTTP score and the fifth column is binary DLT event indicator (integer), named &quot;DLT&quot;. This data frame is sorted first by cohort number, second by &quot;cycle&quot; and then by subject number.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_trialsize">trialSize</code></td>
<td>
<p>The maximum sample size for the trial under investigation. Default is 36. Must be the multiple of cohort size, represented by <code>chSize</code>.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_seed">seed</code></td>
<td>
<p>A number to make simulation results reproducible.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_chsize">chSize</code></td>
<td>
<p>The cohort size of patients recruited. Default is 3.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_maxcycle">MaxCycle</code></td>
<td>
<p>The maximum number of cycles for the treatment, Default is 6.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_doses">doses</code></td>
<td>
<p>A vector of doses that users are going to explore. Default is <code>1:6</code>, where dose 1 through dose 6 are being tested.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_tox.target">tox.target</code></td>
<td>
<p>The target toxicity at cycle 1 of the treatment. Default is 0.28.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_p1">p1</code></td>
<td>
<p>The probability cutoff for cycle 1 toxicity. Default is 0.2. See Details below.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_p2">p2</code></td>
<td>
<p>The probability cutoff for late cycles toxicity beyond cycle 1. Default is 0.2. See Details below.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_ps1">ps1</code></td>
<td>
<p>The probability cutoff for defining allowable (safe) doses in stage 1. Default is 0.2. See Details below.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_thrd1">thrd1</code></td>
<td>
<p>An upper bound of toxicity for cycle 1 of the treatment. Default is 0.28. See Details below.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_thrd2">thrd2</code></td>
<td>
<p>An upper bound of toxicity for late cycles of the treatment, beyond cycle 1. Default is 0.28. See Details below.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_proxy.thrd">proxy.thrd</code></td>
<td>
<p>A distance parameter used to define efficacious doses. Any dose whose predicted efficacy is within <code>proxy.thrd</code> away from the largest one among the safe doses will be declared an efficacious dose.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_dose_flag">dose_flag</code></td>
<td>
<p>A binary indicator. Value 1 indicates that dose has not escalated to dose 2 since the first enrolled cohort while value 0 shows otherwise. Note that for the first enrolled cohort, it is set at 0. The first cohort of patients is treated at the starting dose, dose 1.</p>
</td></tr>
<tr><td><code id="RunRMDEFF_+3A_param.ctrl">param.ctrl</code></td>
<td>
<p>A list specifying the prior distribution for the parameters. <code>p1_beta_intercept</code>, the prior mean of intercept of toxicity model assuming a normal prior;
<code>p2_beta_intercept</code>, the precision (inverse of variance) of intercept of toxicity model assuming a normal prior;
<code>p1_beta_cycle</code>, the prior mean of cycle effect of toxicity model assuming a normal prior; 
<code>p2_beta_cycle</code>, the precision (inverse of variance) of cycle effect of toxicity model assuming a normal prior;
<code>p1_beta_dose</code>, the prior minimum of dose effect of toxicity model assuming a uniform prior;  
<code>p2_beta_dose</code>, the prior maximum of dose effect of toxicity model assuming a uniform prior;  
<code>p1_alpha</code>, the prior mean vector of the parameters from efficacy model assuming a multivariate normal prior;
<code>p2_alpha</code>, the prior precision matrix (inverse of covariance matrix) of the parameters from efficacy model assuming a multivariate normal prior;
<code>p1_gamma0</code>, the prior mean of association parameter <code class="reqn">\gamma</code> (See Du et al(2017)) of two submodels of the joint model assuming a normal prior;
<code>p2_gamma0</code>, the prior precision (inverse of variance) of association parameter <code class="reqn">\gamma</code> of two submodels of the joint model assuming a normal prior. Default is non-informative priors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>p1</code>,<code>p2</code>,<code>thrd1</code> and <code>thrd2</code> are used to define allowable (safe) doses through the two probability conditions: </p>
<p style="text-align: center;"><code class="reqn">P(tox1 &lt; thrd1) &gt; p1</code>
</p>
<p style="text-align: center;"><code class="reqn">P(tox2 &lt; thrd2) &gt; p2</code>
</p>
<p>, where tox1 and tox2 denote the estimated toxicity at cycle 1 of the treament and late cycles, respectively. In stage 1, <code>ps1</code> acts as <code>p1</code> and <code>p2</code>.
</p>
<p>Note that our design allows patients dropout due to DLT events, so the data frames <code>efficacy.dat</code> and <code>toxicity.dat</code> only include the information for the available patients and available cycles.
</p>


<h3>Value</h3>

<p>The function prints information regarding the posterior toxicity/efficacy profile for each dose under exploration, the recommended dose for the next cohort of patients, and return a list with the following components:
</p>
<table>
<tr><td><code>nxtdose</code></td>
<td>
<p>The next recommended dose. For dose recommendation at the end of the trial, see <code>opt.dose</code>.</p>
</td></tr>
<tr><td><code>tox.pf</code></td>
<td>
<p>A data frame demonstrating the toxicity profile for each dose under exploration, for cycle 1 of the treatment (row 1) and the other late cycles beyond cycle 1 as an averaged measure (row 2).</p>
</td></tr>
<tr><td><code>eff.pf</code></td>
<td>
<p>A data frame demonstrating the efficacy profile for each dose under exploration, reported after stage 2 of the design begins.</p>
</td></tr>
<tr><td><code>allow.doses</code></td>
<td>
<p>A vector of allowable (safe) doses, defined through the two probability conditions, specified in Details.</p>
</td></tr>
<tr><td><code>dose_flag</code></td>
<td>
<p>A binary indicator. Value 1 indicates that dose has not escalated to dose 2 since the first enrolled cohort while value 0 shows otherwise. Used as input for the next cohort of patients.</p>
</td></tr>
<tr><td><code>opt.dose</code></td>
<td>
<p>The dose that is recommended at the end of the trial. We recommend the lowest (safest) dose that is efficacious. The physicians, however,  may make their own desicions by reviewing the efficacy and toxicitiy profile, returned by <code>eff.pf</code> and <code>tox.pf</code>, respectively.</p>
</td></tr>
<tr><td><code>p_nTTP1</code></td>
<td>
<p>Boxplots showing posterior nTTP for cycle 1 of the treatment across dose levels under investigation.</p>
</td></tr>
<tr><td><code>p_nTTP2</code></td>
<td>
<p>Boxplots showing posterior nTTP for late cycles of the treatment across dose levels under investigation.</p>
</td></tr>
<tr><td><code>p_EFF</code></td>
<td>
<p>Boxplots showing posterior efficacy of the treatment across dose levels under investigation, reported after stage 2 of the design begins.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
#load the patient efficacy data
#data(eff_dat)
#head(eff_dat)
#----------------------#
#load the patient toxicity data
#data(tox_dat)
#head(tox_dat)

#RunRMDEFF(efficacy.dat = eff_dat, toxicity.dat = tox_dat)

</code></pre>

<hr>
<h2 id='SimRMD'>Simulate trial characters of the phase I dose-finding design.</h2><span id='topic+SimRMD'></span>

<h3>Description</h3>

<p>SimRMD uses the design parameters to simulate the trial characters of phase I dose-finding design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimRMD(seed=2014, strDose=1, chSize=3, trlSize=36,
   numTrials=1000, sdose=1:6, MaxCycle=6, tox.target=0.28,
   control, iter=10000, burnin=4000, thin=1, chains=1,    
   pathout='./', tox.matrix, wm = matrix(c(0, 0.5, 0.75, 1  , 1.5, 
                                        0, 0.5, 0.75, 1  , 1.5, 
                                        0, 0  , 0   , 0.5, 1  ), 
                                        byrow = T, ncol = 5), toxmax = 2.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimRMD_+3A_seed">seed</code></td>
<td>
<p>Random seed of the simulation (default = 2014).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_strdose">strDose</code></td>
<td>
<p>Start dose (default = 1).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_chsize">chSize</code></td>
<td>
<p>Size of each patient cohort (default = 3).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_trlsize">trlSize</code></td>
<td>
<p>Total number of patients in the trial (default = 36).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_numtrials">numTrials</code></td>
<td>
<p>Number of simulated trials (default = 1000).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_sdose">sdose</code></td>
<td>
<p>Dose range (default = 1:6).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_maxcycle">MaxCycle</code></td>
<td>
<p>Maximum treatment cycle (default = 6).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_tox.target">tox.target</code></td>
<td>
<p>Target toxicity score (default = 0.28).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_control">control</code></td>
<td>
<p>Prior distributions as specified by <code>parm</code> function.</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_iter">iter</code></td>
<td>
<p>Total number of MCMC simulations (default = 4000).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_burnin">burnin</code></td>
<td>
<p>Number of burn-ins in the MCMC simulation (default = 1000).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_thin">thin</code></td>
<td>
<p>Thinning parameter (default = 1).</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_chains">chains</code></td>
<td>
<p>Number of chains in the MCMC simulation (default = 1).</p>
</td></tr> 
<tr><td><code id="SimRMD_+3A_pathout">pathout</code></td>
<td>
<p>The output directory of simulation results (default = './').</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_tox.matrix">tox.matrix</code></td>
<td>
<p>Four-dimension array contains Dose, Cycle, Toxicity Type, Toxicity Grade.</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_wm">wm</code></td>
<td>
<p>Clinical weight matrix, where toxicity types define the rows while the toxicity grades define the columns. Usually solicited from physicians.</p>
</td></tr>
<tr><td><code id="SimRMD_+3A_toxmax">toxmax</code></td>
<td>
<p>The normalization constant used in computing nTTP score. For details, see Ezzalfani et al(2013).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>SimRMD</code> function uses the patient data structure <code>patdata</code> to fit the linear mixed model as specified by <code>formula</code> based on the prior distributions as specified by <code>control</code>. The parameters of the MCMC simulation are specified by <code>iter</code>: the number of iterations, <code>burnin</code>: burn-ins, <code>thin</code>: thinning parameter and <code>chains</code>: number of chains in the MCMC simulation. The target nTTP score is defined by <code>tox.target</code>, default = 0.28.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr><td><code>DOSE-RECOMMENDED</code></td>
<td>
<p>Recommended dose for the next patient cohort. </p>
</td></tr>
<tr><td><code>Estimate</code></td>
<td>
<p>Mean, SD, and median estimates of the toxicity score at each dose level.</p>
</td></tr>
<tr><td><code>Quantiles</code></td>
<td>
<p>2.5%, 25%, 50%, 75%, 97.5% quantile estimates of the toxicity score at each dose level.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Setup the prior distributions for the phase I dose-finding model:
control &lt;- list(
 beta.dose = parm("normal", mean = 0, var = 1000),
 beta.other = parm("normal", mean = 0, var = 1000 ),
 gamma = parm("normal", mean = 0, var = 100 ),
 s2.gamma = parm("invgamma", shape = 0.001, scale = 0.001),
 s2.epsilon = parm("invgamma", shape = 0.001, scale = 0.001)
 )


# Generate the toxicity matrix
# tox.matrix &lt;- GenToxProb(
#    toxtype = c("Renal", "Neuro", "Heme"), 
#	intercept.alpha = c(2, 3, 4.2, 5.7), 
#	coef.beta = c(-0.2, -0.4, -0.7), 
#	cycle.gamma = 0)

# Simulate the dose-recommendation based on the toxicity matrix
# simu &lt;- SimRMD(seed=2014, strDose=1, chSize=3, trlSize=12,
#    numTrials=1, sdose=1:6, MaxCycle=5, tox.target=0.28,
#    control=control, iter=10, burnin=2, thin=1, chains=1,    
#    pathout='./', tox.matrix=tox.matrix)
	
</code></pre>

<hr>
<h2 id='SimRMDEFF'>
Simulation for an Adaptive, Multi-Stage Phase I Dose-Finding Design 
</h2><span id='topic+SimRMDEFF'></span>

<h3>Description</h3>

<p>A function to implement simulation for an adaptive, multi-stage phase 1 dose-finding design incorporating a continuous efficacy outcome and toxicity data from multiple treatment cycles, proposed by Du et al(2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimRMDEFF(numTrials = 100, trialSize = 36, doses = 1:6, cycles = 1:6,  
          eff.structure = c(0.1, 0.2, 0.3, 0.4, 0.7, 0.9), 
          eff.sd = 0.2, tox.target = 0.28, p1 = 0.2, p2 = 0.2, 
          ps1 = 0.2, StrDose = 1, chSize = 3, 
          tox.matrix = NULL, 
          proxy.thrd = 0.1, thrd1 = 0.28, thrd2 = 0.28, 
          wm = matrix(c(0, 0.5, 0.75, 1  , 1.5, 
                        0, 0.5, 0.75, 1 , 1.5, 
                        0, 0  , 0   , 0.5, 1  ), 
                        byrow = T, ncol = 5), 
          toxmax = 2.5, toxtype = NULL, intercept.alpha = NULL, 
          coef.beta = NULL, cycle.gamma = NULL, 
          param.ctrl = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimRMDEFF_+3A_numtrials">numTrials</code></td>
<td>
<p>An integer specifying the number of simulations.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_trialsize">trialSize</code></td>
<td>
<p>The maximum sample size for trial simulation. Default is 36. Must be the multiple of cohort size, represented by <code>chSize</code>.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_doses">doses</code></td>
<td>
<p>A vector of doses that users are going to explore. Default is <code>1:6</code>, where dose 1 through dose 6 are being tested.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_cycles">cycles</code></td>
<td>
<p>A vector of cycles that the treatment plans to go through. Default is <code>1:6</code>, where patients will experience up to 6 cycles of the treatment.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_eff.structure">eff.structure</code></td>
<td>
<p>A vector of the mean values of efficacy outcome for each dose level explored. Default is <code>c(0.1, 0.2, 0.3, 0.4, 0.7, 0.9)</code>, corresponding to dose 1 through dose 6, where the efficacy increases with dose.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_eff.sd">eff.sd</code></td>
<td>
<p>The standard deviation for generating the efficacy outcome for each patient. Default is 0.2, which already gives large skewness/variation.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_tox.target">tox.target</code></td>
<td>
<p>The target toxicity at cycle 1 of the treatment. Default is 0.28.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_p1">p1</code></td>
<td>
<p>The probability cutoff for cycle 1 toxicity. Default is 0.2. See Details below.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_p2">p2</code></td>
<td>
<p>The probability cutoff for later cycles toxicity beyond cycle 1. Default is 0.2. See Details below.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_ps1">ps1</code></td>
<td>
<p>The probability cutoff for defining allowable (safe) doses in stage 1. Default is 0.2. See Details below.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_strdose">StrDose</code></td>
<td>
<p>A number to specify the starting dose. Default is 1.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_chsize">chSize</code></td>
<td>
<p>The cohort size of patients recruited. Default is 3.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_tox.matrix">tox.matrix</code></td>
<td>
<p>Optional. A four-dimension array specifying the probabilities of the occurrences of certain grades for certain types of toxicities, at each dose level and cycle under consideration. Dimension 1 refers to doses; dimension 2 corresponds to cycles of the treatment; dimension 3 regards the types of toxicities while dimenion 4 relates to grades. If null, which is default choice, the arguments <code>toxtype</code>, <code>intercept.alpha</code>, <code>coef.beta</code>, <code>cycle.gamma</code> must be provided to simulate this array.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_proxy.thrd">proxy.thrd</code></td>
<td>
<p>A distance parameter to define efficacious doses. Any dose whose predicted efficacy is within <code>proxy.thrd</code> away from the largest one among the safe doses will be declared an efficacious dose.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_thrd1">thrd1</code></td>
<td>
<p>An upper bound of toxicity for cycle 1 of the treatment. Default is 0.28. See Details below.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_thrd2">thrd2</code></td>
<td>
<p>An upper bound of toxicity for late cycles of the treatment, beyond cycle 1. Default is 0.28. See Details below.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_wm">wm</code></td>
<td>
<p>Clinical weight matrix, where toxicity types define the rows while the toxicity grades define the columns. Usually solicited from physicians.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_toxmax">toxmax</code></td>
<td>
<p>The normalization constant used in computing nTTP score. For details, see Ezzalfani et al(2013).</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_toxtype">toxtype</code></td>
<td>
<p>Only specified when <code>tox.matrix</code> is null. This argument, a character vector, specifies toxicity types considered in the trial.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_intercept.alpha">intercept.alpha</code></td>
<td>
<p>Only specified when <code>tox.matrix</code> is null. A four element numeric vector specifying the intercepts for the cumulative probabilities of the occurrences of grades 0-4 of toxicities in proportional odds model. See Details below.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_coef.beta">coef.beta</code></td>
<td>
<p>Only specified when <code>tox.matrix</code> is null. A <code class="reqn">n</code> numeric vector specifying the slope for dose in proportional odds model for <code class="reqn">n</code> types of toxicities. See Details below.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_cycle.gamma">cycle.gamma</code></td>
<td>
<p>Only specified when <code>tox.matrix</code> is null. A scalar controlling the cycle effect in simulation in proportional odds model. See Details below.</p>
</td></tr>
<tr><td><code id="SimRMDEFF_+3A_param.ctrl">param.ctrl</code></td>
<td>
<p>A list specifying the prior distribution for the parameters. <code>p1_beta_intercept</code>, the prior mean of intercept of toxicity model assuming a normal prior;
<code>p2_beta_intercept</code>, the precision (inverse of variance) of intercept of toxicity model assuming a normal prior;
<code>p1_beta_cycle</code>, the prior mean of cycle effect of toxicity model assuming a normal prior; 
<code>p2_beta_cycle</code>, the precision (inverse of variance) of cycle effect of toxicity model assuming a normal prior;
<code>p1_beta_dose</code>, the prior minimum of dose effect of toxicity model assuming a uniform prior;  
<code>p2_beta_dose</code>, the prior maximum of dose effect of toxicity model assuming a uniform prior;  
<code>p1_alpha</code>, the prior mean vector of the parameters from efficacy model assuming a multivariate normal prior;
<code>p2_alpha</code>, the prior precision matrix (inverse of covariance matrix) of the parameters from efficacy model assuming a multivariate normal prior;
<code>p1_gamma0</code>, the prior mean of association parameter <code class="reqn">\gamma</code> (See Du et al(2017)) of two submodels of the joint model assuming a normal prior;
<code>p2_gamma0</code>, the prior precision (inverse of variance) of association parameter <code class="reqn">\gamma</code> of two submodels of the joint model assuming a normal prior. Default is non-informative priors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>p1</code>,<code>p2</code>,<code>thrd1</code> and <code>thrd2</code> are used to define allowable (safe) doses through the two probability conditions: </p>
<p style="text-align: center;"><code class="reqn">P(tox1 &lt; thrd1) &gt; p1</code>
</p>
<p style="text-align: center;"><code class="reqn">P(tox2 &lt; thrd2) &gt; p2</code>
</p>
<p>, where tox1 and tox2 denote the toxicity at cycle 1 of the treament and later cycles, respectively. In stage 1, <code>ps1</code> acts as <code>p1</code> and <code>p2</code>.
</p>
<p>The user can explore different dose-efficacy patterns using the argument <code>eff.structure</code>. For example, <code>eff.structure = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5)</code> corresponds to a flat relationship where the efficacy does not change with dose.
</p>
<p>When <code>tox.matrix</code> is null, the probability matrices of the occurrences of certain grades for certain types of toxicities, at each dose level and cycle will be simulated from a proportional odds model that takes <code>toxtype</code>, <code>intercept.alpha</code>, <code>coef.beta</code> and <code>cycle.gamma</code> as the inputs. The model is as follows:
</p>
<p style="text-align: center;"><code class="reqn">logit(c_j) = \alpha_j + \beta * dose + \gamma * cycle, j=0,1,2,3</code>
</p>

<p>where given a dose and cycle, <code class="reqn">c_j</code> is the cumulative probabilities of occurrences of toxicities grades up to <code class="reqn">j</code>; <code class="reqn">\alpha_0, \alpha_1, \alpha_2, \alpha_3</code> are the intercepts, making up <code>intercept.alpha</code>; <code>coef.beta</code> stores <code class="reqn">\beta</code> for different types of toxicities while <code>cycle.gamma</code> acts as <code class="reqn">\gamma</code>, controlling the cycle effect. The probability for the occurrence of a certain grade of a certain toxicity type at a given dose and cycle is obtained from taking the corresponding differences between cumulative probabilities.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>op.table</code></td>
<td>
<p>A table reporting the operating characteristics of the trial simulation.</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>The assumed true mean longitudinal toxicity and efficacy structure for each dose level under investigation, along with the probability of DLT event, for cycle 1 of the treatment.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
#######Dose 5 target toxicity dose, flat cycle effect#####################

###############a flat dose-efficacy pattern###############################

# simul &lt;- SimRMDEFF(toxtype = c("H", "L", "M"), 
                   # intercept.alpha = c(1.9, 2.3, 2.6, 3.1), 
                   # coef.beta = c(-0.3, -0.2, -0.25), 
                   # cycle.gamma = 0, tox.target = 0.23, 
                   # thrd1 = 0.23, thrd2 = 0.23,
                   # eff.structure = rep(0.5, 6),
                   # p1 = 0.1, p2 = 0.1, ps1 = 0.1, 
                   # numTrials = 1)


</code></pre>

<hr>
<h2 id='tox_dat'>Patient toxicity data</h2><span id='topic+tox_dat'></span>

<h3>Description</h3>

<p>This data set provides the toxicity data from 9 patients with multiple treatment cycles, matching with the efficacy data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tox_dat</code></pre>


<h3>Format</h3>

<p>A data frame containing 183 observations.</p>


<h3>Source</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.</p>


<h3>References</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.
</p>

<hr>
<h2 id='tox_dat_bytype'>Patient toxicity data</h2><span id='topic+tox_dat_bytype'></span>

<h3>Description</h3>

<p>This data set provides the toxicity data in three toxicity types from 33 patients with multiple treatment cycles, matching with the efficacy data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tox_dat_bytype</code></pre>


<h3>Format</h3>

<p>A data frame containing 125 observations.</p>


<h3>Source</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.</p>


<h3>References</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.
</p>

<hr>
<h2 id='tox.matrix'>Probability matrix for toxicity</h2><span id='topic+tox.matrix'></span>

<h3>Description</h3>

<p>This data set is a four-dimension array (Dose, Cycle, Toxicity Type, Toxicity Grade) specifying the probabilities of the occurrences of certain grades for certain types of toxicities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tox.matrix</code></pre>


<h3>Format</h3>

<p>A 4-dimension array.</p>


<h3>Source</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.</p>


<h3>References</h3>

<p>Yin, Jun, et al. &quot;A Bayesian dose finding design incorporating toxicity data from multiple treatment cycles.&quot; Statistics in Medicine 36.1 (2017): 67-80.
</p>

<hr>
<h2 id='Tox2nTTP'>Compute the nTTP score baed on the observed toxicity.</h2><span id='topic+Tox2nTTP'></span>

<h3>Description</h3>

<p><code>Tox2nTTP</code> use the design parameters to compute the nTTP score baed on the observed toxicity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
Tox2nTTP(tox = c(1,2,0),
 wm = matrix(c(0, 0.5, 0.75, 1 , 1.5,
 0, 0.5, 0.75, 1 , 1.5,
 0, 0 , 0 , 0.5, 1 ),
 byrow = T, ncol = 5),
 toxmax = 2.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Tox2nTTP_+3A_tox">tox</code></td>
<td>
<p>Toxicity grades for the toxicity types.</p>
</td></tr>
<tr><td><code id="Tox2nTTP_+3A_wm">wm</code></td>
<td>
<p>Clinical weight matrix, where toxicity types define the rows while the toxicity grades define the columns. Usually solicited from physicians.</p>
</td></tr>
<tr><td><code id="Tox2nTTP_+3A_toxmax">toxmax</code></td>
<td>
<p>The normalization constant used in computing nTTP score. For details, see Ezzalfani et al(2013).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>Tox2nTTP</code> function calculates the nTTP values based on the weight matrix.
</p>


<h3>Value</h3>

<p>nTTP value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data(tox_matrix)

# Simulate the operating characteristics of clinical trials:
#Tox2nTTP(tox = c(1,2,0))
 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
