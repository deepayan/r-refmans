<!DOCTYPE html><html><head><title>Help for package MLID</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MLID}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MLID'><p>MLID: a package for calculating a multilevel index of dissimilarity</p></a></li>
<li><a href='#aggdata'><p>Aggregated population counts by ethnic group</p></a></li>
<li><a href='#catplot'><p>Caterpillar plot</p></a></li>
<li><a href='#checkerboard'><p>Checkerboard</p></a></li>
<li><a href='#confint.index'><p>Confidence intervals for the multilevel index</p></a></li>
<li><a href='#effect'><p>Consider the effect of particular places upon the ID</p></a></li>
<li><a href='#ethnicities'><p>Population counts by ethnic group</p></a></li>
<li><a href='#head.impacts'><p>Return the highest impact scores for each higher level area</p></a></li>
<li><a href='#holdback'><p>Holdback scores</p></a></li>
<li><a href='#id'><p>(Multilevel) index of dissimilarity</p></a></li>
<li><a href='#impacts'><p>Impact calculations</p></a></li>
<li><a href='#plot.confintindex'><p>Plot the confidence intervals for the multilevel residuals</p></a></li>
<li><a href='#print.fxindex'><p>Print values</p></a></li>
<li><a href='#print.impacts'><p>Print values</p></a></li>
<li><a href='#print.index'><p>Print values</p></a></li>
<li><a href='#residuals.index'><p>Extract Model Residuals</p></a></li>
<li><a href='#rstandard.index'><p>The Standardised resdiduals for the single-level Index of Dissimilarity</p></a></li>
<li><a href='#rstudent.index'><p>The Studentised resdiduals for the single-level Index of Dissimilarity</p></a></li>
<li><a href='#sumup'><p>Sum the data up into higher level groups</p></a></li>
<li><a href='#tail.impacts'><p>Return the lowest impact scores for each higher level area</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multilevel Index of Dissimilarity</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Richard Harris [aut],
  Dewi Owen [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Richard Harris &lt;rich.harris@bris.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools and functions to fit a multilevel index of dissimilarity.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/profrichharris/MLID">https://github.com/profrichharris/MLID</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/profrichharris/MLID/issues">https://github.com/profrichharris/MLID/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme (&ge; 3.1.128), lme4 (&ge; 1.1.12), methods</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>raster (&ge; 2.5.8), sp (&ge; 1.2.3), knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-03-05 20:45:04 UTC; profr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-03-06 00:18:37</td>
</tr>
</table>
<hr>
<h2 id='MLID'>MLID: a package for calculating a multilevel index of dissimilarity</h2><span id='topic+MLID'></span><span id='topic+MLID-package'></span>

<h3>Description</h3>

<p>Tools for fitting a multilevel index of dissimilarity to geographically
hierarchical data. The results measure the two principal dimensions of
segregation, unevenness and clustering. The amount of segregation,
scale effects and the impact of particular places on the overall index can
be assessed. The package development was funded partly under the ESRC's
Urban Big Data Centre <a href="http://ubdc.ac.uk/">http://ubdc.ac.uk/</a>, grant ES/L011921/1.
</p>


<h3>See Also</h3>

<p>Harris R (2017) Measuring the scales of segregation: Looking at the
residential separation of White British and other school children in England
using a multilevel index of dissimilarity <a href="http://bit.ly/2lQ4r0n">http://bit.ly/2lQ4r0n</a>
</p>

<hr>
<h2 id='aggdata'>Aggregated population counts by ethnic group</h2><span id='topic+aggdata'></span>

<h3>Description</h3>

<p>Ethnicity data for England and Wales from the 2011 Census. Each row in the
data set gives population counts for Lower Level Super Output Area (LSOA).
The census geography is hierarchical: LSOAs group into Middle Level Super
Output Areas (MSOAs), which group into Local Authority Districts (LADs)
and then into Government Regions (RGNs). These groupings are included in
the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggdata
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 19 columns:
</p>

<ul>
<li><p> LSOA, the Census ID for the Output Area
</p>
</li>
<li><p> Persons, the residential population count for the OA
</p>
</li>
<li><p> columns 3-16, the number of people White British, Irish, of an other
White ethnicity, of a mixed ethnicity, Indian, Pakistani, Bangladeshi,
Chinese, of an other Asian ethnicity, Black African, Black Caribbean, of
an other Black ethnicity, Arab or of an other ethnicity.
</p>
</li>
<li><p> columns 17-19, the ID codes for the higher-level geographies:
MSOAs, LADs and RGNs
</p>
</li></ul>


<h3>Source</h3>

<p>Office for National Statistics; National Records of Scotland;
Northern Ireland Statistics and Research Agency (2016): 2011 Census
aggregate data. UK Data Service (Edition: June 2016). DOI:
<a href="http://dx.doi.org/10.5257/census/aggregate-2011-1">http://dx.doi.org/10.5257/census/aggregate-2011-1</a>.
This information is licensed under the terms of the Open Government Licence
<a href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3">http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3</a>.
The LSOA, MSOA, LAD and RGN codes are from <a href="http://bit.ly/2lGMdkE">http://bit.ly/2lGMdkE</a> and
are supplied under the Open Government Licence: Contains National Statistics
data. Crown copyright and database right 2017.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ethnicities">ethnicities</a></code>
</p>

<hr>
<h2 id='catplot'>Caterpillar plot</h2><span id='topic+catplot'></span>

<h3>Description</h3>

<p>Draws a series of caterpillar plots, showing the residuals from the
multilevel model at each level and the estimates of their confidence interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catplot(confint, ann = TRUE, grid = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="catplot_+3A_confint">confint</code></td>
<td>
<p>an object containing the output from function
<code><a href="#topic+confint.index">confint.index</a></code></p>
</td></tr>
<tr><td><code id="catplot_+3A_ann">ann</code></td>
<td>
<p>default is TRUE. If set to false, suppresses the automatic
annotation of residuals on the plots with a confidence interval that does not
overlap with any other</p>
</td></tr>
<tr><td><code id="catplot_+3A_grid">grid</code></td>
<td>
<p>arrange the plots in a grid? (Default is TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A caterpillar plot is a visual way of looking at the variance of the
residuals at each level of a multilevel model. It can be used to see which
places are contributing most to the Index of Dissimilarity net of the
effects of other scales.
</p>
<p>To aid the interpretability of the plots, the residuals are scaled by the
standard error of the residuals from the OLS estimate of the index.
Additionally, to avoid over-plotting only a maximum of 50 residuals are
shown on each plot. These are the 10 highest and lowest ranked residuals
and then a sample of 30 from the remaining residuals, chosen as the ones
with values that differ most from the residuals that precede them by ranking.
In this way, the plots aim to preserve the tails of the ranked distribution
as well as the most important break points inbetween.
</p>
<p>When <code>ann = TRUE</code> (the default) some outliers are labelled and the
percentage of the total variance due to each level is included. These
will not add up to 100
<code>catplot</code> is a wrapper to <code><a href="#topic+plot.confintindex">plot.confintindex</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+confint.index">confint.index</a></code> <code><a href="#topic+id">id</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(aggdata)
index &lt;- id(aggdata, vars = c("Bangladeshi", "WhiteBrit"),
levels = c("MSOA","LAD","RGN"))
ci &lt;- confint(index)
catplot(ci, grid = TRUE)
# Plots for all levels above the base level

## End(Not run)
</code></pre>

<hr>
<h2 id='checkerboard'>Checkerboard</h2><span id='topic+checkerboard'></span>

<h3>Description</h3>

<p>A demonstration of how the Multilevel Index of Dissimilarity measures spatial
clustering as well as unevenness
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkerboard()
</code></pre>


<h3>Details</h3>

<p>A criticism of the standard Index of Dissimilarity (ID) is that it only
measures one of the two principal dimensions of segregation - unevenness but
not spatial clustering. Because of this, very different spatial patterns of
segregation can generate the same ID score but the ID is unable to
distinguish between them.
</p>
<p>In contrast, the multilevel index can detect the differences because
different patterns (scales) of segregation change the percentage of the
variance due to each level. The demonstation illustrates this using the
classic example of a checkerboard. The examples show how the percentage
of the total variance (labelled Pvariance) moves up the hierarchy with
the increase in spatial clustering at greater geographical cases. However,
the ID is always the same.
</p>
<p>The 'stray' cell in examples 2-4 is to allow the model to be fitted. With it
the model correctly identifies that some of the variation remains at the
base level)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+id">id</a></code>
</p>

<hr>
<h2 id='confint.index'>Confidence intervals for the multilevel index</h2><span id='topic+confint.index'></span>

<h3>Description</h3>

<p>Calculates the confidence intervals for the residuals of the multilevel
index at each level. These can then be visualised in a caterpillar plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'index'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.index_+3A_object">object</code></td>
<td>
<p>an object of class <code>index</code>: a multilevel index created
using function
<code><a href="#topic+id">id</a></code></p>
</td></tr>
<tr><td><code id="confint.index_+3A_parm">parm</code></td>
<td>
<p>NA</p>
</td></tr>
<tr><td><code id="confint.index_+3A_level">level</code></td>
<td>
<p>the confidence level required</p>
</td></tr>
<tr><td><code id="confint.index_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>confint.index</code> is a wrapper to <code>lme4::ranef(mlm, condVar = TRUE)</code>
and is used to calculate the confidence intervals for the locations and
regions at each of the higher levels of the model. In this way, places with
an usually high (or low) share of population group Y with respect to
population group X can be identified, net of the effects of other levels
of the model. The width of the confidence interval is adjusted for a test of
difference between two means (see Statistical Rules of Thumb by Gerald van
Belle, 2011, eq 2.18). A 95 per cent confidence interval, for example,
extends to 1.39 times the standard error around the mean and not 1.96.
</p>


<h3>Value</h3>

<p>an object of class <code>confint</code>, a list of length equal to the
number of levels in the index where each part of the list is a data frame
giving the confidence interval for the location
</p>


<h3>See Also</h3>

<p><code><a href="#topic+catplot">catplot</a></code> <code><a href="#topic+id">id</a></code> <code><a href="lme4.html#topic+ranef">ranef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(aggdata)
index &lt;- id(aggdata, vars = c("Bangladeshi", "WhiteBrit"),
levels = c("MSOA","LAD","RGN"))
ci &lt;- confint(index)
catplot(ci)

## End(Not run)
</code></pre>

<hr>
<h2 id='effect'>Consider the effect of particular places upon the ID</h2><span id='topic+effect'></span>

<h3>Description</h3>

<p>Evaluates the effect on the index of the named <code>places</code> under three
different scenarios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effect(object, places)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effect_+3A_object">object</code></td>
<td>
<p>an object of class <code>index</code>: a multilevel index created
using function <code><a href="#topic+id">id</a></code></p>
</td></tr>
<tr><td><code id="effect_+3A_places">places</code></td>
<td>
<p>a character vector containing the names of the places in any of
the higher-level geographies for which the evaluation will be made</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The three different scenarios considered are:
</p>

<ol>
<li><p> if the effects (the estimated residuals from the multilevel
model) are set to zero for the named higher-level <code>places</code>;
</p>
</li>
<li><p> if the shares of the two population groups are equal everywhere
except within the named <code>places</code>; and
</p>
</li>
<li><p> if all but the neighbourhoods within the named <code>places</code>
are omitted from the data and the index then recalculated
using only those that remain.
</p>
</li></ol>

<p>The evaluation also includes:
</p>

<ul>
<li><p> the impact of the chosen places upon the overall ID, where a value
over 100 indicates a group of neighbourhoods with a disproportionately
high (in the same way that <code><a href="#topic+impacts">impacts</a></code> calculates it)
</p>
</li>
<li><p> an R-squared value. This is the proportion of the total variation in
(Y - X) that is due to the chosen places, where (Y - X) are the
differences between the share of population group Y and the share of
population group X that are observed in each neighbourhood.
</p>
</li></ul>

<p>See <code>vignette("MLID")</code> for further details
</p>


<h3>Value</h3>

<p>an object, primarily a list containing the evaluated values
</p>


<h3>See Also</h3>

<p><code><a href="#topic+id">id</a></code>
</p>
<p>Harris R (2017) Fitting a multilevel index of segregation in R:
using the MLID package <a href="http://rpubs.com/profrichharris/MLID">http://rpubs.com/profrichharris/MLID</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(aggdata)
index &lt;- id(aggdata, vars = c("Bangladeshi", "WhiteBrit"),
levels = c("MSOA","LAD","RGN"))
ci &lt;- confint(index)
catplot(ci)
# Note Tower Hamlets and Newham. Obtain the predictions for them:
effect(index, "Tower Hamlets")
effect(index, "Newham")
effect(index, c("Tower Hamlets","Newham"))

## End(Not run)
</code></pre>

<hr>
<h2 id='ethnicities'>Population counts by ethnic group</h2><span id='topic+ethnicities'></span>

<h3>Description</h3>

<p>Ethnicity data for England and Wales from the 2011 Census. Each row in the
data set gives population counts for a small area census Output Area (OA).
The census geography is hierarchical: OAs group into Lower Level Super
Output Areas (LSOAs), which group into Middle Level Super Output Areas
(MSOAs), which group into Local Authority Districts (LADs) and then into
Government Regions (RGNs). These groupings are included in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ethnicities
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 20 columns:
</p>

<ul>
<li><p> OA, the Census ID for the Output Area
</p>
</li>
<li><p> Persons, the residential population count for the OA
</p>
</li>
<li><p> columns 3-16, the number of people White British, Irish, of an other
White ethnicity, of a mixed ethnicity, Indian, Pakistani, Bangladeshi,
Chinese, of an other Asian ethnicity, Black African, Black Caribbean, of
an other Black ethnicity, Arab or of an other ethnicity.
</p>
</li>
<li><p> columns 17-20, the ID codes for the higher-level geographies:
LSOAs, MSOAs, LADs and RGNs
</p>
</li></ul>


<h3>Source</h3>

<p>Office for National Statistics; National Records of Scotland;
Northern Ireland Statistics and Research Agency (2016): 2011 Census
aggregate data. UK Data Service (Edition: June 2016). DOI:
<a href="http://dx.doi.org/10.5257/census/aggregate-2011-1">http://dx.doi.org/10.5257/census/aggregate-2011-1</a>.
This information is licensed under the terms of the Open Government Licence
<a href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3">http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3</a>.
The LSOA, MSOA, LAD and RGN codes are from <a href="http://bit.ly/2lGMdkE">http://bit.ly/2lGMdkE</a> and
are supplied under the Open Government Licence: Contains National Statistics
data. Crown copyright and database right 2017.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aggdata">aggdata</a></code>
</p>

<hr>
<h2 id='head.impacts'>Return the highest impact scores for each higher level area</h2><span id='topic+head.impacts'></span>

<h3>Description</h3>

<p>Returns the first parts of the set of impact calculations, ordered
by the impact score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'impacts'
head(x, n = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="head.impacts_+3A_x">x</code></td>
<td>
<p>an object of class <code>impacts</code> generated by the function
<code>impacts</code></p>
</td></tr>
<tr><td><code id="head.impacts_+3A_n">n</code></td>
<td>
<p>a single integer giving the number of rows to show. Defaults
to 5.</p>
</td></tr>
<tr><td><code id="head.impacts_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+impacts">impacts</a></code>
</p>

<hr>
<h2 id='holdback'>Holdback scores</h2><span id='topic+holdback'></span>

<h3>Description</h3>

<p>Calculates the holdback scores for a multilevel index of dissimilarity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>holdback(mlm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="holdback_+3A_mlm">mlm</code></td>
<td>
<p>an object of class <code>lmerMod</code> generated by the
<code>lme4</code> package</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the index of dissimilarity (ID), the residuals are the differences
between the share of the Y population and the share of the X population per
neighbourhood. For the multilevel index, the residuals are estimated at and
partitioned between each level of the model. The holdback scores take each
level in the model in turn and set the residuals (the effects) at that
level to zero, then recalculating the ID on that basis and recording
the percentage change in the original value that occurs. The holdback
scores are calculated automatically as part of the function <code><a href="#topic+id">id</a></code>
and can be viewed through <code>print(index)</code>, where <code>index</code> is the
object returned by the function, or as <code>attr(index, "holdback")</code>.
</p>


<h3>Value</h3>

<p>a numeric vector containing the holdback scores
</p>


<h3>See Also</h3>

<p><code><a href="#topic+id">id</a></code> <code><a href="#topic+print.index">print.index</a></code>
</p>

<hr>
<h2 id='id'>(Multilevel) index of dissimilarity</h2><span id='topic+id'></span>

<h3>Description</h3>

<p>Returns either the standard index of dissimilarity (ID) or its
multilevel equivalent
</p>


<h3>Usage</h3>

<pre><code class='language-R'>id(data, vars, levels = NA, expected = FALSE, nsims = 100, omit = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="id_+3A_data">data</code></td>
<td>
<p>a data frame with <code>ncol(data) &gt;= 2</code>. Each row of the data
represents a neighbourhood or some other areal unit for which counts of
population have been made.</p>
</td></tr>
<tr><td><code id="id_+3A_vars">vars</code></td>
<td>
<p>a character or numeric vector of length 2 or 3 giving either the
names or columns positions of the variables in <code>data</code> in the following
order:
</p>

<ol>
<li><p> the number of population group Y in each neighbourhood
</p>
</li>
<li><p> the number of population group X in each neighbourhood
</p>
</li>
<li><p> (optional) The total population in each neighbourhood
</p>
</li></ol>
</td></tr>
<tr><td><code id="id_+3A_levels">levels</code></td>
<td>
<p>a character or numeric vector of minimum length 1 identifying
either the names or columns positions of the variables in <code>data</code> that
record to which higher-level grouping each lower-lower level unit belongs.
If <code>levels = NA</code>, the default, then only the standard index of
dissimilarity is calculated.</p>
</td></tr>
<tr><td><code id="id_+3A_expected">expected</code></td>
<td>
<p>a logical scaler. Should the expected value of the ID under
randomisation be calculated? Requires a measure of the total population in
each neighbourhood. If omitted from <code>vars</code> that total will be calculated
as <code>sum(X + Y)</code>.</p>
</td></tr>
<tr><td><code id="id_+3A_nsims">nsims</code></td>
<td>
<p>a vector, the number of random draws to be used for calculating
the expected value. Default is 100.</p>
</td></tr>
<tr><td><code id="id_+3A_omit">omit</code></td>
<td>
<p>(optional) a character vector containing the names of places to
search for in the data and to omit from the calculations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>Y</code> is the number of population group Y living in each neighbourhood
and <code>X</code> is the number of population group X then <code>id</code> measures how
unevenly distributed are the two groups relative to one another and is a
measure of segregation. In addition, for geographically hierarchichal data,
scale effects may be explored to examine the scale of geographical
clustering.
</p>
<p>The method works by treating the calculation of the ID as a
regression problem: if <code>Y</code> is recalculated as the share per
neighbourhood of the total count of population group Y
(i.e. <code>Y &lt;- Y / sum(Y)</code>) and <code>X</code> is recalculated in the same way
for X, then fitting <code>ols &lt;- lm(Y ~ 0, offset = X)</code> generates a set of
residuals, <code>e &lt;- residuals(ols)</code> where each residual is the difference
in the share of Y and the share of X per neighbourhood, and the sum of the
absolute of those residuals can be used to obtain the id:
<code>id &lt;- 0.5 * sum(abs(e))</code>.
</p>
<p>The advantage of calculating the ID in this
way is that it can be extended to consider geographic hierarchies, where
neighbourhoods at the base level can be grouped into larger regions at
the next level, and so forth. Then, for the multilevel index,
the residuals are estimated at and partitioned between each level of the
model <em>net</em> of the other levels, allowing scale effects to be
explored.
</p>
<p><code>print(index)</code> displays the ID value, the expected value of
the ID under randomisation (NA if not calculated), and, for a multilevel
model, the percentage share of the total variance due to each level
(a measure of the geographical scale of segregation: see the examples given
by <code><a href="#topic+checkerboard">checkerboard</a></code>) and the holdback scores -
see <code><a href="#topic+holdback">holdback</a></code>
</p>


<h3>Value</h3>

<p>an object of class <code>index</code>. This is a value between zero and one
where 0 implies no segreation, and 1 means 'complete segregation' - wherever
group Y is located, X is not (and vice versa). If <code>expected = TRUE</code> the
expected value under randomisation also is given. In addition, the object
contains the following attributes:
</p>

<ul>
<li> <p><code>attr(x, "ols")</code> an object of class <code>lm</code>. The OLS
regression used to calculate the ID. Useful for identifying significant
residuals (see Example below)
</p>
</li>
<li> <p><code>attr(x, "vars")</code> the names of Y and X in <code>data</code>
</p>
</li>
<li> <p><code>attr(x, "data")</code> a data frame with the population counts
for Y and X
</p>
</li></ul>

<p>and also, for a multilevel model,
</p>

<ul>
<li> <p><code>attr(index, "mlm")</code> an object of class <code>lmerMod</code>.
Fitted using <code><a href="lme4.html#topic+lmer">lmer</a></code>
</p>
</li>
<li> <p><code>attr(index, "variance")</code> the percentage of the total variance
due to each level of the model. This indicates the scale at which the
segregation is most prominent
</p>
</li>
<li> <p><code>attr(index, "holdback")</code> records the percentage change in the
ID that occurs if, at each level, its contribution to the ID <em>net</em> of
other levels is heldback (set to zero)
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+checkerboard">checkerboard</a></code> <code><a href="#topic+print.index">print.index</a></code>
<code><a href="#topic+holdback">holdback</a></code> <code><a href="#topic+residuals.index">residuals.index</a></code> <code><a href="lme4.html#topic+lmer">lmer</a></code>
<code><a href="#topic+sumup">sumup</a></code>
</p>
<p>Harris R (2017) Fitting a multilevel index of segregation in R:
using the MLID package <a href="http://rpubs.com/profrichharris/MLID">http://rpubs.com/profrichharris/MLID</a>
</p>
<p>Harris R (2017) Measuring the scales of segregation: Looking at the
residential separation of White British and other school children in England
using a multilevel index of dissimilarity <a href="http://bit.ly/2lQ4r0n">http://bit.ly/2lQ4r0n</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ethnicities)
head(ethnicities)
# Calculate the standard index value
id(ethnicities, vars = c("Bangladeshi", "WhiteBrit"))

## Not run: 
# Calculate also the expected value under randomisation
id(ethnicities, vars = c("Bangladeshi", "WhiteBrit"), expected = TRUE)
# will generate a warning because the total population per neighbourhood
# has not been specified
id(ethnicities, vars = c("Bangladeshi", "WhiteBrit", "Persons"),
expected = TRUE)
# The expected value is a high percentage of the actual value so
# aggregate it into a higher level geography...
aggdata &lt;- sumup(ethnicities, sumby = "LSOA", drop = "OA")
head(aggdata)

# Multilevel models
id(aggdata, vars = c("Bangladeshi", "WhiteBrit"),
levels = c("MSOA","LAD","RGN"))
id(aggdata, vars = c("Bangladeshi", "WhiteBrit"),
levels = c("MSOA","LAD","RGN"), omit = c("Tower Hamlets", "Newham"))

## End(Not run)
</code></pre>

<hr>
<h2 id='impacts'>Impact calculations</h2><span id='topic+impacts'></span>

<h3>Description</h3>

<p>Calculates the total contribution to the index of dissimilarity of
neighbourhoods grouped by regions or other higher-level geographies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impacts(data, vars, levels, omit = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impacts_+3A_data">data</code></td>
<td>
<p>a data frame with <code>ncol(data) &gt;= 2</code>. Each row of the data
represents a neighbourhood or some other areal unit for which counts of
population have been made.</p>
</td></tr>
<tr><td><code id="impacts_+3A_vars">vars</code></td>
<td>
<p>a character or numeric vector of length 2 or 3 giving either
the names or columns positions of the variables in <code>data</code> in the
following order
</p>

<ol>
<li><p> the number of population group Y in each neighbourhood
</p>
</li>
<li><p> the number of population group X in each neighbourhood
</p>
</li></ol>
</td></tr>
<tr><td><code id="impacts_+3A_levels">levels</code></td>
<td>
<p>a character or numeric vector of minimum length 1 identifying
either the names or columns positions of the variables in <code>data</code> that
record to which higher-level grouping each lower-lower level unit belongs</p>
</td></tr>
<tr><td><code id="impacts_+3A_omit">omit</code></td>
<td>
<p>(optional) a character vector containing the names of places to
search for in the data and to omit from the calculations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the index of dissimilarity (ID) is estimated as a regression model
the residuals from that model are the differences between the share of
population group Y and the share of population group X that are observed in
each neighbourhood. The <code>impacts</code> function summaries those differences
by higher-level geographies to consider which places or regions have the
neighbourhoods that contribute most to the ID. The measures are useful
for understanding where the seperations of the two population groups are
greatest. However, to look at scale effects, where the effect of each level
<em>net</em> of the other levels is wanted, fit a multilevel index using
function <code><a href="#topic+id">id</a></code>.
</p>


<h3>Value</h3>

<p>A list of data.frames, each containing the impact calculations for
the higher-level geographies. The variables are
</p>

<ul>
<li> <p><code>pcntID</code> The total contribution of the neighbourhoods within
the region to the overall ID score, expressed as a percentage
</p>
</li>
<li> <p><code>pcntN</code> The number of neighbourhoods within the region,
expressed as a percentage of the total number in <code>data</code>
</p>
</li>
<li> <p><code>impact</code> The ratio of <code>pcntID</code> to <code>pcntN</code> multiplied
by 100. Values over 100 indicate a group of neighbourhoods that have a
disproportionately high impact on the ID
</p>
</li>
<li> <p><code>scldMean</code> The average difference between the share of the Y
population and the share of the X population, scaled by the standard error
of the differences for the whole data set (to give a z-value). Positive
values mean that, on average, the region has a greater share of the Y
population than the X. Negative values mean it has less.
</p>
</li>
<li> <p><code>scldSD</code> A measure of how much the differences between the
shares of the two populations vary within the region. It is the standard
deviation of those differences scaled by the standard error for the whole
data set. Higher values indicate greater variability within the region.
</p>
</li>
<li> <p><code>scldMin</code> The minimum difference between the share of the Y
population and the share of the X for neighbourhoods within the region,
scaled by the standard error
</p>
</li>
<li> <p><code>scldMax</code> The maximum difference between the share of the Y
population and the share of the X for neighbourhoods within the region,
scaled by the standard error
</p>
</li>
<li> <p><code>pNYgtrNX</code> The percentage of neighbourhoods within the region
where the count of population group Y (as opposed to the share) is
greater than the count of population group X
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(aggdata)
impx &lt;- impacts(aggdata, c("Bangladeshi", "WhiteBrit"), c("LAD","RGN"))
head(impx)
# sorted by impact score
# For $RGN London has the greatest impact on the ID
# The 'excess' share of the Bangladeshi population is not especially
# significant (see scldMean) but there is a lot of variation between
# neighbourhoods (see scldSD)
# For $LAD note the impacts of Tower Hamlets and Newham
</code></pre>

<hr>
<h2 id='plot.confintindex'>Plot the confidence intervals for the multilevel residuals</h2><span id='topic+plot.confintindex'></span>

<h3>Description</h3>

<p>Plots the confidence intervals to produce a caterpillar plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'confintindex'
plot(x, ann = TRUE, grid = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.confintindex_+3A_x">x</code></td>
<td>
<p>an object containing the output from function
<code><a href="#topic+confint.index">confint.index</a></code></p>
</td></tr>
<tr><td><code id="plot.confintindex_+3A_ann">ann</code></td>
<td>
<p>add annotation to the plot?</p>
</td></tr>
<tr><td><code id="plot.confintindex_+3A_grid">grid</code></td>
<td>
<p>arrange the plots in a grid? (Default is TRUE)</p>
</td></tr>
<tr><td><code id="plot.confintindex_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+catplot">catplot</a></code>
</p>

<hr>
<h2 id='print.fxindex'>Print values</h2><span id='topic+print.fxindex'></span>

<h3>Description</h3>

<p>Prints predicted changes to the index of dissimilarity under various
scenarios
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fxindex'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fxindex_+3A_x">x</code></td>
<td>
<p>output from <code><a href="#topic+effect">effect</a></code></p>
</td></tr>
<tr><td><code id="print.fxindex_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.impacts'>Print values</h2><span id='topic+print.impacts'></span>

<h3>Description</h3>

<p>Prints the impact values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'impacts'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.impacts_+3A_x">x</code></td>
<td>
<p>output from <code><a href="#topic+impacts">impacts</a></code></p>
</td></tr>
<tr><td><code id="print.impacts_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.index'>Print values</h2><span id='topic+print.index'></span>

<h3>Description</h3>

<p>Prints output from the single or multi-level index of dissimilarity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'index'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.index_+3A_x">x</code></td>
<td>
<p>output from <code><a href="#topic+id">id</a></code></p>
</td></tr>
<tr><td><code id="print.index_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+id">id</a></code> <code><a href="#topic+holdback">holdback</a></code>
</p>

<hr>
<h2 id='residuals.index'>Extract Model Residuals</h2><span id='topic+residuals.index'></span>

<h3>Description</h3>

<p>For the index of dissimilarity (ID), the residuals are the differences
between the share of the Y population and the share of the X population per
neighbourhood. For the multilevel index, the residuals are estimated at and
partitioned between each level of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'index'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.index_+3A_object">object</code></td>
<td>
<p>an object of class <code>index</code></p>
</td></tr>
<tr><td><code id="residuals.index_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector of matrix containing the residuals
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rstandard.index">rstandard.index</a></code> <code><a href="#topic+rstudent.index">rstudent.index</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aggdata)
index &lt;- id(aggdata, vars = c("Bangladeshi", "WhiteBrit"))
# The ID can be derived from the residuals
0.5 * sum(abs(residuals(index)))
# which is the same as
index[1]

# Extract the standardized and look for regions where the share of the
# Bangladeshi population is unusualy high with respect to the White British
# resids &lt;- rstandard(index)
# table(aggdata$RGN[resids &gt; 2.58])

# Residuals for a multilevel index
index &lt;- id(aggdata, vars = c("Bangladeshi", "WhiteBrit"),
levels = c("MSOA","LAD","RGN"))
resids &lt;- residuals(index)
head(resids)
# Again, the ID can be derived from the residuals
0.5 * sum(abs(rowSums(resids)))

# Looking at the residuals, the London effect is different from other regions
sort(tapply(resids[,4], aggdata$RGN, mean))

# At the local authority scale it is Tower Hamlets and Newham
# (both in London) that have the highest share of the Bangladeshi population
# with respect to the White British:
tail(sort(tapply(resids[,3], aggdata$LAD, mean)),5)
</code></pre>

<hr>
<h2 id='rstandard.index'>The Standardised resdiduals for the single-level Index of Dissimilarity</h2><span id='topic+rstandard.index'></span>

<h3>Description</h3>

<p>Calculates the standardised residuals for the single-level index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'index'
rstandard(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rstandard.index_+3A_model">model</code></td>
<td>
<p>an object of class <code>index</code> generated by the function
<code><a href="#topic+id">id</a></code></p>
</td></tr>
<tr><td><code id="rstandard.index_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The residuals are the differences between the share of the Y population
and the share of the X population per neighbourhood. A positive residual
occurs where the share of the Y population exceeds the share of the X
population, and a negative residual where the opposite. The standardised
residuals can help to identify 'extreme' differences.
</p>

<hr>
<h2 id='rstudent.index'>The Studentised resdiduals for the single-level Index of Dissimilarity</h2><span id='topic+rstudent.index'></span>

<h3>Description</h3>

<p>Calculates the studentised residuals for the single-level index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'index'
rstudent(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rstudent.index_+3A_model">model</code></td>
<td>
<p>an object of class <code>index</code> generated by the function
<code><a href="#topic+id">id</a></code></p>
</td></tr>
<tr><td><code id="rstudent.index_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The residuals are the differences between the share of the Y population
and the share of the X population per neighbourhood. A positive residual
occurs where the share of the Y population exceeds the share of the X
population, and a negative residual where the opposite. The studentised
residuals can help to identify 'extreme' differences.
</p>

<hr>
<h2 id='sumup'>Sum the data up into higher level groups</h2><span id='topic+sumup'></span>

<h3>Description</h3>

<p>Aggregates the data into higher level groups by calculating the sum
of all the numeric data columns by group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumup(data, sumby, drop = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumup_+3A_data">data</code></td>
<td>
<p>a data frame with <code>ncol(data) &gt;= 2</code>. Each row of the data
represents a neighbourhood or some other areal unit for which counts of
population have been made.</p>
</td></tr>
<tr><td><code id="sumup_+3A_sumby">sumby</code></td>
<td>
<p>a character or numeric vector of length 1 identifying either
the name or columns position of the variables in <code>data</code> that records the
higher-level group into which the data will be aggregated (summed)</p>
</td></tr>
<tr><td><code id="sumup_+3A_drop">drop</code></td>
<td>
<p>a character or numeric vector identifying any variables to be
dropped from the aggregated data, such as lower-level names and identifiers</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes a population group is too few in number sensibly to be analysed at
the smallest area scale. An indication of this is when the expected value
under randomisation of the index of dissimilarity is a large fraction of the
observed value. In this case, the data can be aggregated into higher level
units, summing the population counts. Aggregating the data also can be used
to explore how the index changes with the scale of analysis.
</p>


<h3>Value</h3>

<p>a data frame containing the aggregated data
</p>


<h3>See Also</h3>

<p><code><a href="#topic+id">id</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(ethnicities)
head(ethnicities)
id(ethnicities, vars = c("Arab","Other","Persons"), expected = TRUE)
# the expected value is very high relative to the ID
aggdata &lt;- sumup(ethnicities, sumby = "LSOA", drop = "OA")
head(aggdata)
id(aggdata, vars=c("Arab","Other","Persons"), expected = TRUE)
# Note the sensitivity of the ID to the scale of analysis

## End(Not run)
data(aggdata)
head(aggdata)
moreagg &lt;- sumup(ethnicities, sumby = "MSOA", drop = "LSOA")
head(moreagg)
</code></pre>

<hr>
<h2 id='tail.impacts'>Return the lowest impact scores for each higher level area</h2><span id='topic+tail.impacts'></span>

<h3>Description</h3>

<p>Returns the last parts of the set of impact calculations, ordered
by the impact score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'impacts'
tail(x, n = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tail.impacts_+3A_x">x</code></td>
<td>
<p>an object of class <code>impacts</code> generated by the function
<code>impacts</code></p>
</td></tr>
<tr><td><code id="tail.impacts_+3A_n">n</code></td>
<td>
<p>a single integer giving the number of rows to show. Defaults
to 5.</p>
</td></tr>
<tr><td><code id="tail.impacts_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+impacts">impacts</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
