<!DOCTYPE html><html><head><title>Help for package clam</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {clam}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add.dates'><p>Add dates to age-depth plots</p></a></li>
<li><a href='#calib.t'><p>Comparison dates calibrated using both the t distribution (Christen and Perez 2009) and the normal distribution.</p></a></li>
<li><a href='#clam'><p>clam</p></a></li>
<li><a href='#deptime.age'><p>Calculates the slope of a straight curve at the desired age.</p></a></li>
<li><a href='#deptime.depth'><p>Calculates *for each iteration* the slope of a straight curve between depths</p>
just above and below the desired point.</a></li>
<li><a href='#plot_proxies'><p>Produce a plot of proxy values against calendar age.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Classical Age-Depth Modelling of Cores from Deposits</td>
</tr>
<tr>
<td>Version:</td>
<td>2.5.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs 'classical' age-depth modelling of dated sediment deposits - prior to applying more sophisticated techniques such as Bayesian age-depth modelling. Any radiocarbon dated depths are calibrated. Age-depth models are constructed by sampling repeatedly from the dated levels, each time drawing age-depth curves. Model types include linear interpolation, linear or polynomial regression, and a range of splines. See Blaauw (2010). &lt;<a href="https://doi.org/10.1016%2Fj.quageo.2010.01.002">doi:10.1016/j.quageo.2010.01.002</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, stats, utils</td>
</tr>
<tr>
<td>Depends:</td>
<td>rintcal (&ge; 0.4.1)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, utf8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-17 09:54:22 UTC; maarten</td>
</tr>
<tr>
<td>Author:</td>
<td>Maarten Blaauw <a href="https://orcid.org/0000-0002-5680-1515"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  J. Andres Christen
    <a href="https://orcid.org/0000-0002-5795-4345"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Judith Esquivel Vazquez [ctb],
  Simon Goring [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-17 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add.dates'>Add dates to age-depth plots</h2><span id='topic+add.dates'></span>

<h3>Description</h3>

<p>Add dated depths to plots, e.g. to show dates that weren't used in the age-depth model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add.dates(
  mn,
  sdev,
  depth,
  cc = 1,
  above = 0.001,
  exx = 50,
  normal = TRUE,
  normalise = TRUE,
  t.a = 3,
  t.b = 4,
  age.res = 100,
  times = 20,
  col = rgb(1, 0, 0, 0.5),
  border = rgb(1, 0, 0, 0.5),
  rotate.axes = FALSE,
  mirror = TRUE,
  up = TRUE,
  BCAD = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add.dates_+3A_mn">mn</code></td>
<td>
<p>Reported mean of the date. Can be multiple dates.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_sdev">sdev</code></td>
<td>
<p>Reported error of the date. Can be multiple dates.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_depth">depth</code></td>
<td>
<p>Depth of the date.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_cc">cc</code></td>
<td>
<p>The calibration curve to use: <code>cc=1</code> for IntCal20 (northern hemisphere terrestrial), <code>cc=2</code> for Marine20 (marine), <code>cc=3</code> for SHcal20 (southern hemisphere terrestrial), <code>cc=0</code> for none (dates that are already on the cal BP scale).</p>
</td></tr>
<tr><td><code id="add.dates_+3A_above">above</code></td>
<td>
<p>Threshold for plotting of probability values. Defaults to <code>above=1e-3</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_exx">exx</code></td>
<td>
<p>Exaggeration of probability distribution plots. Defaults to <code>exx=50</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_normal">normal</code></td>
<td>
<p>By default, Bacon uses the student's t-distribution to treat the dates. Use <code>normal=TRUE</code> to use the normal/Gaussian distribution. This will generally give higher weight to the dates.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_normalise">normalise</code></td>
<td>
<p>By default, the date is normalised to an area of 1 (<code>normalise=TRUE</code>).</p>
</td></tr>
<tr><td><code id="add.dates_+3A_t.a">t.a</code></td>
<td>
<p>The dates are treated using the student's t distribution by default (<code>normal=FALSE</code>).
The student's t-distribution has two parameters, t.a and t.b, set at 3 and 4 by default (see Christen and Perez, 2010).
If you want to assign narrower error distributions (more closely resembling the normal distribution), set t.a and t.b at for example 33 and 34 respectively (e.g., for specific dates in your .csv file).
For symmetry reasons, t.a must always be equal to t.b-1.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_t.b">t.b</code></td>
<td>
<p>The dates are treated using the student's t distribution by default (<code>normal=FALSE</code>).
The student's t-distribution has two parameters, t.a and t.b, set at 3 and 4 by default (see Christen and Perez, 2010).
If you want to assign narrower error distributions (more closely resembling the normal distribution), set t.a and t.b at for example 33 and 34 respectively (e.g., for specific dates in your .csv file).
For symmetry reasons, t.a must always be equal to t.b-1.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_age.res">age.res</code></td>
<td>
<p>Resolution of the date's distribution. Defaults to <code>date.res=100</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_times">times</code></td>
<td>
<p>The extent of the range to be calculated for each date. Defaults to <code>times=20</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_col">col</code></td>
<td>
<p>The colour of the ranges of the date. Default is semi-transparent red: <code>col=rgb(1,0,0,.5)</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_border">border</code></td>
<td>
<p>The colours of the borders of the date. Default is semi-transparent red: <code>border=rgb(1,0,0,0.5)</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default of plotting age on the horizontal axis and event probability on the vertical one can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_mirror">mirror</code></td>
<td>
<p>Plot the dates as 'blobs'. Set to <code>mirror=FALSE</code> to plot simple distributions.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_up">up</code></td>
<td>
<p>Directions of distributions if they are plotted non-mirrored. Default <code>up=TRUE</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes it is useful to add additional dating information to age-depth plots, e.g., to show outliers or how dates calibrate with different estimated offsets.
</p>


<h3>Value</h3>

<p>A date's distribution, added to an age-depth plot.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  clam(coredir=tempfile())
  add.dates(5000, 100, 60)
</code></pre>

<hr>
<h2 id='calib.t'>Comparison dates calibrated using both the t distribution (Christen and Perez 2009) and the normal distribution.</h2><span id='topic+calib.t'></span>

<h3>Description</h3>

<p>Visualise how a date calibrates using the t distribution and the normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calib.t(
  y = 2450,
  error = 50,
  t.a = 3,
  t.b = 4,
  cc = 1,
  postbomb = NULL,
  cc1 = "IntCal20",
  cc2 = "Marine20",
  cc3 = "SHCal20",
  cc4 = "mixed",
  ccdir = "",
  Cutoff = 1e-05,
  times = 8,
  rule = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calib.t_+3A_y">y</code></td>
<td>
<p>The reported mean of the date.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_error">error</code></td>
<td>
<p>The reported error of the date.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_t.a">t.a</code></td>
<td>
<p>Value for the t parameter <code>a</code>.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_t.b">t.b</code></td>
<td>
<p>Value for the t parameter <code>b</code>.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 dates (1, 2 or 3).</p>
</td></tr>
<tr><td><code id="calib.t_+3A_postbomb">postbomb</code></td>
<td>
<p>Which postbomb curve to use for negative 14C dates</p>
</td></tr>
<tr><td><code id="calib.t_+3A_cc1">cc1</code></td>
<td>
<p>For northern hemisphere terrestrial C14 dates.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_cc2">cc2</code></td>
<td>
<p>For marine C14 dates.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_cc3">cc3</code></td>
<td>
<p>For southern hemisphere C14 dates.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_cc4">cc4</code></td>
<td>
<p>A custom calibration curve</p>
</td></tr>
<tr><td><code id="calib.t_+3A_ccdir">ccdir</code></td>
<td>
<p>Directory where the calibration curves for C14 dates <code>cc</code> are allocated. By default <code>ccdir=""</code>. 
Use <code>ccdir="."</code> to choose current working directory. Use <code>ccdir="Curves/"</code> to choose sub-folder <code>Curves/</code>.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_cutoff">Cutoff</code></td>
<td>
<p>Threshold above which calibrated probabilities are plotted</p>
</td></tr>
<tr><td><code id="calib.t_+3A_times">times</code></td>
<td>
<p>8 by default.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Radiocarbon and other dates are usually modelled using the normal distribution (red curve). The t approach (grey distribution) however allows for wider tails and thus tends to better accommodate outlying dates. This distribution requires two parameters, called 'a' and 'b'.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calib.t() 

</code></pre>

<hr>
<h2 id='clam'>clam</h2><span id='topic+clam'></span>

<h3>Description</h3>

<p>Classical (non-Bayesian) age-depth modelling.
</p>
<p>Produce age-depth models for cores with dated depths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clam(
  core = "Example",
  type = 1,
  smooth = NULL,
  prob = 0.95,
  its = 1000,
  coredir = NULL,
  ask = TRUE,
  wghts = 1,
  cc = 1,
  cc1 = "3Col_intcal20.14C",
  cc2 = "3Col_marine20.14C",
  cc3 = "3Col_shcal20.14C",
  cc4 = "mixed.14C",
  postbomb = FALSE,
  pb1 = "postbomb_NH1.14C",
  pb2 = "postbomb_NH2.14C",
  pb3 = "postbomb_NH3.14C",
  pb4 = "postbomb_SH1-2.14C",
  pb5 = "postbomb_SH3.14C",
  ccdir = "",
  outliers = NULL,
  ignore = NULL,
  youngest = NULL,
  extradates = NULL,
  slump = NULL,
  est = 1,
  calibt = FALSE,
  mixed.effect = FALSE,
  dmin = NULL,
  dmax = NULL,
  every = 1,
  yrmin = NULL,
  yrmax = NULL,
  yrsteps = 1,
  pbsteps = 0.01,
  hpdsteps = 1,
  BCAD = FALSE,
  decimals = 0,
  cmyr = FALSE,
  ageofdepth = NULL,
  depth = "cm",
  depthseq = NULL,
  depths.file = FALSE,
  thickness = 1,
  hiatus = NULL,
  remove.reverse = 0.5,
  times = 5,
  sep = ",",
  ext = ".csv",
  runname = NULL,
  storedat = TRUE,
  threshold = 1e-06,
  proxies = FALSE,
  revaxes = FALSE,
  revd = TRUE,
  revyr = TRUE,
  calhght = 0.3,
  maxhght = 0.01,
  mirror = TRUE,
  plotrange = TRUE,
  bty = "l",
  mar = c(3.5, 3, 2, 1),
  mgp = c(2, 1, 0),
  plotpdf = TRUE,
  plotpng = TRUE,
  greyscale = NULL,
  yrlab = NULL,
  dlab = NULL,
  calcol = rgb(0, 0.5, 0.5, 0.5),
  C14col = rgb(0, 0, 1, 0.5),
  outcol = "red",
  outlsize = 1,
  bestcol = "black",
  rangecol = rgb(0, 0, 0, 0.3),
  slumpcol = grey(0.75),
  plotname = TRUE,
  ash = FALSE,
  rule = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clam_+3A_core">core</code></td>
<td>
<p>Name of the core, given using quotes. Defaults to the core provided with clam, <code>core="Example"</code>.</p>
</td></tr>
<tr><td><code id="clam_+3A_type">type</code></td>
<td>
<p>The type of age-depth model. Five different types are provided:
</p>

<ol>
<li><p> linear interpolation between neighbouring levels (1, &quot;int&quot;, &quot;inter&quot; or &quot;interp&quot;) 
</p>
</li>
<li><p> linear or higher polynomial regression (2, &quot;reg&quot;, &quot;regr&quot;, &quot;poly&quot; or &quot;polyn&quot;, default linear) 
</p>
</li>
<li><p> cubic spline (3, &quot;spl&quot; or &quot;spline&quot;) 
</p>
</li>
<li><p> smooth spline (4, &quot;sm&quot; or &quot;smooth&quot;, default smoothing 0.3) 
</p>
</li>
<li><p> locally weighted spline (5, &quot;loess&quot; or &quot;lowess&quot;, default smoothing 0.75, cannot extrapolate)
</p>
</li></ol>
</td></tr>
<tr><td><code id="clam_+3A_smooth">smooth</code></td>
<td>
<p>Degree of smoothing. Gives polynomial degree for model type 2. Not relevant for <code>type=1 or type=3</code>.
</p>

<ul>
<li><p> for type=2: <code>smooth=1</code> (linear), <code>smooth=2</code> second-order polynomial, <code>smooth=3</code> for third-order polynomial, etc. 
</p>
</li>
<li><p> for type=4: <code>smooth=0.3</code> 
</p>
</li>
<li><p> for type=5: <code>smooth=0.75</code> 
</p>
</li></ul>
</td></tr>
<tr><td><code id="clam_+3A_prob">prob</code></td>
<td>
<p>Confidence intervals (between 0 and 1), default <code>prob=0.95</code> or 95%.</p>
</td></tr>
<tr><td><code id="clam_+3A_its">its</code></td>
<td>
<p>Amount of age-model iterations; defaults to <code>its=1000</code>.</p>
</td></tr>
<tr><td><code id="clam_+3A_coredir">coredir</code></td>
<td>
<p>The directory where core runs are stored (each core in its own directory named after the core's name).</p>
</td></tr>
<tr><td><code id="clam_+3A_ask">ask</code></td>
<td>
<p>By default, and as per R rules, clam will ask if it is OK to make or write to a directory.
Defaults to <code>coredir="clam_runs"</code>, or to <code>coredir="Cores"</code> if this folder exists where R is working.</p>
</td></tr>
<tr><td><code id="clam_+3A_wghts">wghts</code></td>
<td>
<p>Weights can be applied to dated depths as follows:
</p>

<ul>
<li><p> 0 no weighting 
</p>
</li>
<li><p> 1 weighted to calibrated probabilities of sampled calendar years (default, <code>wghts=1</code>). 
</p>
</li>
<li><p> 2 weighted to (inverse squared) errors of the dates.
</p>
</li></ul>
</td></tr>
<tr><td><code id="clam_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 dates (1, 2 or 3).</p>
</td></tr>
<tr><td><code id="clam_+3A_cc1">cc1</code></td>
<td>
<p>For terrestrial, northern hemisphere C14 dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_cc2">cc2</code></td>
<td>
<p>For marine C14 dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_cc3">cc3</code></td>
<td>
<p>For southern hemisphere C14 dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_cc4">cc4</code></td>
<td>
<p>For mixed terrestrial/marine C14 dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_postbomb">postbomb</code></td>
<td>
<p>Use a postbomb curve for negative (i.e. postbomb) 14C ages. <code>0 = none, 1 = NH1, 2 = NH2, 3 = NH3, 4 = SH1-2, 5 = SH3</code>. See <a href="http://calib.org/CALIBomb/">http://calib.org/CALIBomb/</a>.</p>
</td></tr>
<tr><td><code id="clam_+3A_pb1">pb1</code></td>
<td>
<p>For Northern hemisphere region 1 postbomb C14 dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_pb2">pb2</code></td>
<td>
<p>For Northern hemisphere region 2 postbomb C14 dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_pb3">pb3</code></td>
<td>
<p>For Northern hemisphere region 3 postbomb C14 dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_pb4">pb4</code></td>
<td>
<p>For Southern hemisphere regions 1-2 postbomb C14 dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_pb5">pb5</code></td>
<td>
<p>For Southern hemisphere region 3 postbomb C14 dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_ccdir">ccdir</code></td>
<td>
<p>Directory where the calibration curves for C14 dates <code>cc</code> are located. By default <code>ccdir=""</code>. 
For example, use <code>ccdir="."</code> to choose current working directory, or <code>ccdir="Curves/"</code> to choose sub-folder <code>Curves/</code>.</p>
</td></tr>
<tr><td><code id="clam_+3A_outliers">outliers</code></td>
<td>
<p>The number of any dates to be considered outlying, e.g. <code>c(5,6)</code> for the fifth and sixth dated depth counting from the top of a core.</p>
</td></tr>
<tr><td><code id="clam_+3A_ignore">ignore</code></td>
<td>
<p>The number of any dates that should be ignored, e.g., <code>c(5,6)</code> for the fifth and sixth date counting from the top of a core.</p>
</td></tr>
<tr><td><code id="clam_+3A_youngest">youngest</code></td>
<td>
<p>The age beyond which dates should be truncated (e.g., <code>youngest=-60</code> if the core was sampled in -60 cal BP or AD 2010).</p>
</td></tr>
<tr><td><code id="clam_+3A_extradates">extradates</code></td>
<td>
<p>Depths of any additional dates with their files of ages and probabilities.</p>
</td></tr>
<tr><td><code id="clam_+3A_slump">slump</code></td>
<td>
<p>Upper and lower depths of sections of abrupt accumulation that should be excised, e.g., <code>c(600, 550, 120, 100)</code> for two sections of 600-550 and 120-100 cm depth.</p>
</td></tr>
<tr><td><code id="clam_+3A_est">est</code></td>
<td>
<p>Which point estimate to use as 'best' age. It is highly recommended to not only use these 'best' point estimates, as chronological uncertainties are often considerable and should not be ignored.
</p>

<ol>
<li><p> averages of age-depth model derived ages (default, <code>est=1</code>)
</p>
</li>
<li><p> midpoints of age-depth model derived age estimates
</p>
</li>
<li><p> midpoints of calibrated ranges
</p>
</li>
<li><p> weighted means of calibrated ranges 
</p>
</li>
<li><p> medians of calibrated distributions 
</p>
</li>
<li><p> maximum densities of calibrated distributions 
</p>
</li>
<li><p> midpoints of entire calibrated distributions (including years outside the calibrated ranges)
</p>
</li></ol>
</td></tr>
<tr><td><code id="clam_+3A_calibt">calibt</code></td>
<td>
<p>Calibration based on the student-t distribution. By default, the Gaussian distribution is used (<code>calibt=FALSE</code>). To use the student-t distribution, provide two parameters such as <code>calibt=c(3,4)</code>.</p>
</td></tr>
<tr><td><code id="clam_+3A_mixed.effect">mixed.effect</code></td>
<td>
<p>Set to <code>TRUE</code> to activate mixed-effect modelling.</p>
</td></tr>
<tr><td><code id="clam_+3A_dmin">dmin</code></td>
<td>
<p>Minimum depth of age-depth model (e.g., extrapolate).</p>
</td></tr>
<tr><td><code id="clam_+3A_dmax">dmax</code></td>
<td>
<p>Maximum depth of age-depth model (e.g., extrapolate).</p>
</td></tr>
<tr><td><code id="clam_+3A_every">every</code></td>
<td>
<p>Resolution at which (ages for) depths are calculated.</p>
</td></tr>
<tr><td><code id="clam_+3A_yrmin">yrmin</code></td>
<td>
<p>Minimum of calendar axis of age-depth plot (calculate automatically by default).</p>
</td></tr>
<tr><td><code id="clam_+3A_yrmax">yrmax</code></td>
<td>
<p>Maximum of calendar axis of age-depth plot (calculated automatically by default).</p>
</td></tr>
<tr><td><code id="clam_+3A_yrsteps">yrsteps</code></td>
<td>
<p>Temporal resolution at which calibrated ages are calculated (in calendar years).</p>
</td></tr>
<tr><td><code id="clam_+3A_pbsteps">pbsteps</code></td>
<td>
<p>Temporal resolution at which postbomb C14 ages are calibrated (in calendar years).</p>
</td></tr>
<tr><td><code id="clam_+3A_hpdsteps">hpdsteps</code></td>
<td>
<p>Temporal resolution at which highest posterior density ranges are calibrated (in calendar years).</p>
</td></tr>
<tr><td><code id="clam_+3A_bcad">BCAD</code></td>
<td>
<p>Use BC/AD or cal BP scale.</p>
</td></tr>
<tr><td><code id="clam_+3A_decimals">decimals</code></td>
<td>
<p>Amount of decimals for rounding.</p>
</td></tr>
<tr><td><code id="clam_+3A_cmyr">cmyr</code></td>
<td>
<p>Accumulation rates can be provided as yr/cm (default, <code>cmyr=TRUE</code>, more accurately named deposition times) or cm/yr (<code>cmyr=FALSE</code>).</p>
</td></tr>
<tr><td><code id="clam_+3A_ageofdepth">ageofdepth</code></td>
<td>
<p>Calculate age estimates of a specific depth.</p>
</td></tr>
<tr><td><code id="clam_+3A_depth">depth</code></td>
<td>
<p>Depth units.</p>
</td></tr>
<tr><td><code id="clam_+3A_depthseq">depthseq</code></td>
<td>
<p>Sequence of depths for which age estimates are to be calculated (default: from <code>dmin</code> to <code>dmax</code> with steps of size every)</p>
</td></tr>
<tr><td><code id="clam_+3A_depths.file">depths.file</code></td>
<td>
<p>Use a file with depths for depthseq.</p>
</td></tr>
<tr><td><code id="clam_+3A_thickness">thickness</code></td>
<td>
<p>Thickness of the dated samples.</p>
</td></tr>
<tr><td><code id="clam_+3A_hiatus">hiatus</code></td>
<td>
<p>Depths of any hiatuses, e.g., <code>c(500, 300)</code>. Each sub-section must have at least 2 dates (<code>4</code> for smoothing spline; does not work with loess as it cannot extrapolate).</p>
</td></tr>
<tr><td><code id="clam_+3A_remove.reverse">remove.reverse</code></td>
<td>
<p>Proportion of age-models with reversals that can be removed before prompting a warning.
Set at <code>FALSE</code> to avoid removing models with reversals.</p>
</td></tr>
<tr><td><code id="clam_+3A_times">times</code></td>
<td>
<p>Half-range of calibration curve used to calibrate dates (multiplication factor for the dates' errors).</p>
</td></tr>
<tr><td><code id="clam_+3A_sep">sep</code></td>
<td>
<p>Separator between the fields of the plain text file containing the dating information.</p>
</td></tr>
<tr><td><code id="clam_+3A_ext">ext</code></td>
<td>
<p>Extension of the file containing the dating information.</p>
</td></tr>
<tr><td><code id="clam_+3A_runname">runname</code></td>
<td>
<p>Text to add to the core name for specific runs, e.g., &quot;MyCore_Test1&quot;</p>
</td></tr>
<tr><td><code id="clam_+3A_storedat">storedat</code></td>
<td>
<p>Store the dates and age-model within R after a <code>clam</code> run. Defaults to <code>storedat=TRUE</code>.</p>
</td></tr>
<tr><td><code id="clam_+3A_threshold">threshold</code></td>
<td>
<p>Below which value should probabilities be excluded from calculations.</p>
</td></tr>
<tr><td><code id="clam_+3A_proxies">proxies</code></td>
<td>
<p>Set to <code>TRUE</code> to plot proxies against age after the run.</p>
</td></tr>
<tr><td><code id="clam_+3A_revaxes">revaxes</code></td>
<td>
<p>Set to <code>TRUE</code> to plot ages on the vertical axis and depth on the horizontal axis.</p>
</td></tr>
<tr><td><code id="clam_+3A_revd">revd</code></td>
<td>
<p>Plot depth axis in reverse.</p>
</td></tr>
<tr><td><code id="clam_+3A_revyr">revyr</code></td>
<td>
<p>Plot age axis in reverse.</p>
</td></tr>
<tr><td><code id="clam_+3A_calhght">calhght</code></td>
<td>
<p>Heights of the calibrated distributions in the age-depth plot.</p>
</td></tr>
<tr><td><code id="clam_+3A_maxhght">maxhght</code></td>
<td>
<p>Maximum height of age probability distributions.</p>
</td></tr>
<tr><td><code id="clam_+3A_mirror">mirror</code></td>
<td>
<p>Plot the age distributions in &quot;mirror&quot; style (above and below depth).</p>
</td></tr>
<tr><td><code id="clam_+3A_plotrange">plotrange</code></td>
<td>
<p>Plot the confidence ranges of the age-model.</p>
</td></tr>
<tr><td><code id="clam_+3A_bty">bty</code></td>
<td>
<p>Type of box to be drawn around plots. Draw a box around the graph (<code>"n"</code> for none, 
and <code>"l"</code>, <code>"7"</code>, <code>"c"</code>, <code>"u"</code>, &quot;]&quot; or <code>"o"</code> for correspondingly shaped boxes).</p>
</td></tr>
<tr><td><code id="clam_+3A_mar">mar</code></td>
<td>
<p>Plot margins (amount of white space along edges of axes 1-4).</p>
</td></tr>
<tr><td><code id="clam_+3A_mgp">mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted).</p>
</td></tr>
<tr><td><code id="clam_+3A_plotpdf">plotpdf</code></td>
<td>
<p>Produce a pdf file of the age-depth plot.</p>
</td></tr>
<tr><td><code id="clam_+3A_plotpng">plotpng</code></td>
<td>
<p>Produce a png file of the age-depth plot.</p>
</td></tr>
<tr><td><code id="clam_+3A_greyscale">greyscale</code></td>
<td>
<p>Produce a grey-scale representation of all age-models (number gives resolution, e.g., 500 bins; will cancel plotting of the confidence intervals).</p>
</td></tr>
<tr><td><code id="clam_+3A_yrlab">yrlab</code></td>
<td>
<p>Label of the calendar axis. Defaults to either cal BP or BC/AD. Alternative names can be provided.</p>
</td></tr>
<tr><td><code id="clam_+3A_dlab">dlab</code></td>
<td>
<p>Label of the depth axis. Defaults to <code>dlab="Depth (cm)"</code> (assuming <code>depth="cm"</code>), but alternative names can be provided.</p>
</td></tr>
<tr><td><code id="clam_+3A_calcol">calcol</code></td>
<td>
<p>Colour of the calibrated distributions in the age-depth plot.</p>
</td></tr>
<tr><td><code id="clam_+3A_c14col">C14col</code></td>
<td>
<p>Colour of the calibrated ranges of the dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_outcol">outcol</code></td>
<td>
<p>Colour of outlying dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_outlsize">outlsize</code></td>
<td>
<p>Size of symbols outlying dates.</p>
</td></tr>
<tr><td><code id="clam_+3A_bestcol">bestcol</code></td>
<td>
<p>Colour of the &quot;best&quot; age-depth model (based on chosen value for est).</p>
</td></tr>
<tr><td><code id="clam_+3A_rangecol">rangecol</code></td>
<td>
<p>Colour of plotted confidence ranges.</p>
</td></tr>
<tr><td><code id="clam_+3A_slumpcol">slumpcol</code></td>
<td>
<p>Colour of slump.</p>
</td></tr>
<tr><td><code id="clam_+3A_plotname">plotname</code></td>
<td>
<p>Print the core name on the graph.</p>
</td></tr>
<tr><td><code id="clam_+3A_ash">ash</code></td>
<td>
<p>Plot all distributions at the same height.</p>
</td></tr>
<tr><td><code id="clam_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cores containing several 14C and/or other dates can be processed semi-automatically in order to obtain age-depth models. 
In the process, any 14C dates are calibrated, and age-depth curves are repeatedly drawn through point estimates sampled from the dates.
Age-depth models can be based on linear interpolation, linear/polynomial regression, or cubic, smooth or locally weighted splines. 
For each date, the probability of a calendar year being sampled is proportionate to its calibrated probability (see Blaauw, 2010). 
Uncertainty ranges as well as a 'best' age-model are calculated.
</p>
<p>Additional cores should be put in a comma-separated file in a sub-folder of the directory where the cores are stored. 
By default this parent folder is called <code>coredir="clam_runs"</code> (if no folder called <code>"Cores"</code> already exists). If your core is called MyCore1, save MyCore1.csv as <code>clam_runs/MyCore1/MyCore1.csv</code>.
Ensure that the names of the core's folder and filename's root (the part before .csv) match, e.g., using exactly similar upper- and lower case letters.
</p>
<p>Avoid the use of spaces or non-standard (non-ASCII) characters within the file or in folder or file names. 
The plain text file should consist of 6 or 7 columns (also called fields), containing in the following exact order (see the example below):
</p>

<ol>
<li><p> Identification labels (e.g. 14C lab codes)
</p>
</li>
<li><p> 14C ages for 14C-dated depths; leave empty for non-14C dated depths
</p>
</li>
<li><p> cal BP ages (for any non-14C dates such as the core surface; leave empty for levels with 14C dates)
</p>
</li>
<li><p> errors (reported 1 standard deviation errors. This column should never be left empty. Errors should always be larger than 0)
</p>
</li>
<li><p> age offsets if known (otherwise leave empty)
</p>
</li>
<li><p> depths (depths in the sequence were the dated samples were taken, default unit depth=&quot;cm&quot;; this column should never be left empty)
</p>
</li>
<li><p> thicknesses of the sampled slices (optional column; leave empty for default of 1)
</p>
</li></ol>

<p>Add a final empty line to your core's .csv file by pressing 'Enter' after the file's last value. 
</p>
<p>These files can be made in spreadsheet software such as MS-Excel, but it is always a good idea to check the file's formatting in a plain-text editor such as WordPad. Remove any lines which contain only commas, and it is also recommended to remove quotes ()<code>\" or \'</code>) in the headers or elsewhere. 
</p>
<p>Age-models for the core can then be produced by typing, e.g., <code>clam("MyCore1")</code>.
</p>
<p>By default the northern hemisphere terrestrial calibration curve is used (<code>cc=1</code>, <code>cc1="3Col_intcal20.14C"</code>). 
To use alternative curves, change <code>cc</code> to <code>cc=2 (cc2="3Col_marine20.14C")</code>, <code>cc=3 (cc3="3Col_shcal20.14C")</code>, <code>cc=4 (cc4="mixed.14C")</code>. 
You can also provide custom-built calibration curves, indicating its location using <code>ccdir</code>.
</p>
<p>The provided example (default <code>core="Example"</code>) is core Quilichao-1 which was sampled from a Colombian lake (Berrio et al., 2002). 
This core was chosen because it was dated at a rather high resolution, and appears to contain a hiatus (e.g., try <code>hiatus=450</code>
for a hiatus at 450 cm depth).
</p>
<p>Each clam run will produce a range of files within the core's folder. One, ending with <code>"_calibrated.txt"</code> contains the calibrated 
age ranges of the 14C and other dates. The others will be named according to the core's name followed by the model type, 
and contain the age estimates for all depths (files ending with <code>"_ages.txt"</code>), settings (files ending with <code>"_settings.txt"</code>) 
and graphs (files ending with <code>".pdf"</code> and <code>".png"</code>). 
The file containing the age estimates has 5 columns; first the depths, then the minima and maxima of the confidence intervals, 
then a &quot;best&quot; estimate, and finally the reconstructed accumulation rates. The reported values are rounded to 0 decimals by default
(<code>decimals=0</code>). Accumulation rates are in yr/cm (&quot;deposition time&quot;) by default (<code>cmyr=FALSE</code>), but can be reported in cm/yr (<code>cmyr=TRUE</code>).
</p>
<p>see Blaauw 2010 (Quaternary Geochronology 5: 512-518).
</p>


<h3>Value</h3>

<p>Age model construction together with a text output and files saved to a folder in the <code>coredir/core</code> directory.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt;
</p>
<p>Maarten Blaauw
</p>


<h3>References</h3>

<p>Berrio, J.C., Hooghiemstra, H., Marchant, R., Rangel, O., 2002. Late-glacial and Holocene history of the dry forest area 
in the south Colombian Cauca Valley. Journal of Quaternary Science 17, 667-682
</p>
<p>Blaauw, M., 2010. Methods and code for 'classical' age-modelling of radiocarbon sequences. Quaternary Geochronology 5, 512-518
<a href="https://doi.org/10.1016/j.quageo.2010.01.002">doi:10.1016/j.quageo.2010.01.002</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> clam(, coredir=tempdir()) # Create the example in Cores/Example folder
 clam(, coredir=tempdir(), extradates=470) 

</code></pre>

<hr>
<h2 id='deptime.age'>Calculates the slope of a straight curve at the desired age.</h2><span id='topic+deptime.age'></span>

<h3>Description</h3>

<p>Calculates *for each iteration* the slope of a straight curve between 
depths above and below the desired age. Requires sufficiently dense density of depths, e.g. <code>steps=1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deptime.age(age, yrcm = TRUE, prob = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deptime.age_+3A_age">age</code></td>
<td>
<p>Age to calculate deposition time (years per cm).</p>
</td></tr>
<tr><td><code id="deptime.age_+3A_yrcm">yrcm</code></td>
<td>
<p>Calculate in years per cm, or alternatively in cm per yr.</p>
</td></tr>
<tr><td><code id="deptime.age_+3A_prob">prob</code></td>
<td>
<p>Probability level at which to calculate the ranges.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To calculate deposition times at an age. Before doing this, run your core in clam and store the data, 
so, make sure the option <code>storedat=TRUE</code>.
Renamed from previous accrate.age function to avoid confusion with accrate.age function of rbacon.
</p>


<h3>Value</h3>

<p>Returns (invisibly) the modelled deposition times at a specific age, a histogram and confidence ranges.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  clam(coredir=tempdir(), storedat=TRUE)
  dp &lt;- deptime.age(5000)
  summary(dp)
  deptime.age(5000, yrcm=FALSE) # to calculate sedimentation times in cm/yr, so accumulation rates
</code></pre>

<hr>
<h2 id='deptime.depth'>Calculates *for each iteration* the slope of a straight curve between depths
just above and below the desired point.</h2><span id='topic+deptime.depth'></span>

<h3>Description</h3>

<p>Calculates *for each iteration* the slope of a straight curve between depths
above and below the desired point. Requires sufficiently dense density of depths, e.g. <code>yrsteps=1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deptime.depth(depth, yrcm = TRUE, prob = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deptime.depth_+3A_depth">depth</code></td>
<td>
<p>The depth for which accumulation rate estimates should be calculated.</p>
</td></tr>
<tr><td><code id="deptime.depth_+3A_yrcm">yrcm</code></td>
<td>
<p>Calculate in years per cm, or alternatively in cm per yr.</p>
</td></tr>
<tr><td><code id="deptime.depth_+3A_prob">prob</code></td>
<td>
<p>Probability level at which to calculate the ranges.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To calculate sedimentation times at a depth. Before running this, run your core in clam and store the data, 
so, make sure to set <code>storedat=TRUE</code>. 
Renamed from previous accrate.depth function to avoid confusion with accrate.depth function of rbacon.
</p>


<h3>Value</h3>

<p>Returns (invisibly) the modelled deposition times for a specific depths, a histogram and confidence ranges.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  clam(coredir=tempdir(), storedat=TRUE) 
  dp &lt;- deptime.depth(20)
  summary(dp)
  deptime.depth(20, FALSE) # to calculate accumulation rates in cm/yr

</code></pre>

<hr>
<h2 id='plot_proxies'>Produce a plot of proxy values against calendar age.</h2><span id='topic+plot_proxies'></span>

<h3>Description</h3>

<p>Produce a plot of proxy values against calendar age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_proxies(prox, errors = TRUE, proxcol = grey(0.5), revyr = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_proxies_+3A_prox">prox</code></td>
<td>
<p>Position of the proxy that should be plotted, e.g. <code>1</code> for the first proxy in the file.</p>
</td></tr>
<tr><td><code id="plot_proxies_+3A_errors">errors</code></td>
<td>
<p>Plot an error envelope.</p>
</td></tr>
<tr><td><code id="plot_proxies_+3A_proxcol">proxcol</code></td>
<td>
<p>Colour of the error envelope.</p>
</td></tr>
<tr><td><code id="plot_proxies_+3A_revyr">revyr</code></td>
<td>
<p>Direction of the calendar scale (<code>revyr=TRUE</code> will reverse the calendar scale from the default <code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only works after running clam on the core using <code>proxies=TRUE</code>. Requires a file containing the core depths as the first column, 
and any proxy values on subsequent columns. Values should be separated by comma's. The file should be stored as a .csv file in the core's directory.
</p>


<h3>Value</h3>

<p>A plot of the age model function with proxies.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>clam(coredir=tempdir(), proxies=TRUE)
plot_proxies(3)
plot_proxies(3, revyr=FALSE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
