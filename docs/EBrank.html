<!DOCTYPE html><html lang="en"><head><title>Help for package EBrank</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EBrank}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EBrank'><p>EBrank: Empirical Bayes Ranking</p></a></li>
<li><a href='#rankEM'><p>Empirical Bayes parameter ranking for parallel estimation scenarios</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Empirical Bayes Ranking</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Empirical Bayes ranking applicable to parallel-estimation settings where the estimated parameters are asymptotically unbiased and normal, with known standard errors.  A mixture normal prior for each parameter is estimated using Empirical Bayes methods, subsequentially ranks for each parameter are simulated from the resulting joint posterior over all parameters (The marginal posterior densities for each parameter are assumed independent). Finally, experiments are ordered by expected posterior rank, although computations minimizing other plausible rank-loss functions are also given.  </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.4)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-01-11 17:39:16 UTC; 0118158S</td>
</tr>
<tr>
<td>Author:</td>
<td>John Ferguson [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John Ferguson &lt;john.ferguson@nuigalway.ie&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-01-12 15:13:29</td>
</tr>
</table>
<hr>
<h2 id='EBrank'>EBrank: Empirical Bayes Ranking</h2><span id='topic+EBrank'></span><span id='topic+EBrank-package'></span>

<h3>Description</h3>

<p>Empirical Bayes ranking applicable to parallel-estimation settings where the estimated parameters are asymptotically unbiased and normal, with known standard errors.  A mixture normal prior for the parameter is estimated, subsequentially ranks for each parameter are simulated from the resulting posterior. Finally, experiments are ordered by expected posterior  rank, although computations minimizing other plausible rank-loss functions are also given.
</p>


<h3>EBrank functions</h3>

<p>rankEM
</p>

<hr>
<h2 id='rankEM'>Empirical Bayes parameter ranking for parallel estimation scenarios</h2><span id='topic+rankEM'></span>

<h3>Description</h3>

<p>Empirical Bayes ranking applicable to parallel-estimation settings where the estimated parameters are asymptotically unbiased and normal, with known standard errors.  A mixture normal prior for each parameter is estimated using Empirical Bayes methods, subsequentially ranks for each parameter are simulated from the resulting joint posterior over all parameters (The marginal posterior densities for each parameter are assumed independent). Finally, experiments are ordered by expected posterior  rank, although computations minimizing other plausible rank-loss functions are also given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rankEM(betahat, sebeta, Jmin = 1, Jmax = 4, maxiter = 200, tol = 1e-05,
  nsim = 10000, cutoff = 0.5, maxpar = 40000, multiplestart = FALSE,
  sigmabig = 10, fixedcluster2 = TRUE, penfactor = 5000, fudge = 0.001,
  alpha = 0.05, FDR_BH = 0.05, topvec = c(10, 100, 1000, 10000))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rankEM_+3A_betahat">betahat</code></td>
<td>
<p>estimated effect sizes for each experiment</p>
</td></tr>
<tr><td><code id="rankEM_+3A_sebeta">sebeta</code></td>
<td>
<p>standard error of estimated effect sizes</p>
</td></tr>
<tr><td><code id="rankEM_+3A_jmin">Jmin</code></td>
<td>
<p>minimum number of non-null clusters fit</p>
</td></tr>
<tr><td><code id="rankEM_+3A_jmax">Jmax</code></td>
<td>
<p>maximum number of non-null clusters fit</p>
</td></tr>
<tr><td><code id="rankEM_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations for EM algorithm</p>
</td></tr>
<tr><td><code id="rankEM_+3A_tol">tol</code></td>
<td>
<p>EM algorithm is considered to have converged if the sum of the squared Euclidean distances between the parameter estimates on 2 iterations is less than tol</p>
</td></tr>
<tr><td><code id="rankEM_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations from posterior distribution</p>
</td></tr>
<tr><td><code id="rankEM_+3A_cutoff">cutoff</code></td>
<td>
<p>controls which experiments are included for posterior rank simulation. If a numeric between 0 and 1, it specifies the minimum posterior probability for inclusion in posterior rank simulations. If equal to 'f' then experiements in posterior rank simulation had p-values that were significant according to a Benjamini Hochberg correction at BH_FDR, if equal to 'b' posterior simulations correspond to experiments with Bonferoni significant p-values at level alpha.</p>
</td></tr>
<tr><td><code id="rankEM_+3A_maxpar">maxpar</code></td>
<td>
<p>maximum number of experiments to simulate</p>
</td></tr>
<tr><td><code id="rankEM_+3A_multiplestart">multiplestart</code></td>
<td>
<p>if TRUE, multiple start points are used for the EM-algorithm based fitting of the mixture normals (for a given number of clusters)</p>
</td></tr>
<tr><td><code id="rankEM_+3A_sigmabig">sigmabig</code></td>
<td>
<p>the standard deviation for the 1st non-null cluster component</p>
</td></tr>
<tr><td><code id="rankEM_+3A_fixedcluster2">fixedcluster2</code></td>
<td>
<p>TRUE if the standard deviation for the 1st non-null cluster of the marginal distribution is fixed at sigmabig and its mean is fixed at 0.  If set to FALSE, the estimated mean and standard deviation of cluster 2 are free to vary.</p>
</td></tr>
<tr><td><code id="rankEM_+3A_penfactor">penfactor</code></td>
<td>
<p>factor for dirichlet penalization for cluster probabilities at each step of the EM algorithm. The larger this is, the smaller the Dirichlet penalization</p>
</td></tr>
<tr><td><code id="rankEM_+3A_fudge">fudge</code></td>
<td>
<p>small constant added to cluster probabilies at each EM step to ensure stability</p>
</td></tr>
<tr><td><code id="rankEM_+3A_alpha">alpha</code></td>
<td>
<p>represents Bonferroni-corrected significance threshold when cutoff=&quot;b&quot;</p>
</td></tr>
<tr><td><code id="rankEM_+3A_fdr_bh">FDR_BH</code></td>
<td>
<p>represents FDR-corrected significance threshold when cutoff=&quot;f&quot;</p>
</td></tr>
<tr><td><code id="rankEM_+3A_topvec">topvec</code></td>
<td>
<p>a vector representing values for K such that posterior probabilities that the parameter for each experiment is within the set of K parameters having the largest absolute values are given.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the top ranked experiments
</p>


<h3>Examples</h3>

<pre><code class='language-R'>truetheta &lt;- c(rep(0,900),rnorm(100))
setheta &lt;- pmax(rexp(1000,1),.1)
esttheta &lt;- rnorm(length(truetheta),mean=truetheta,sd=setheta)
# just rank experiments that are significant at 5% FDR
stuff &lt;- rankEM(esttheta,setheta,cutoff='f',FDR_BH=.05)
# rank all experiments (slower)
# stuff &lt;- rankEM(esttheta,setheta,cutoff='f',FDR_BH=1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
