<!DOCTYPE html><html><head><title>Help for package selectspm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {selectspm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#LF.gof'><p>Loosmore and Ford Goodness of Fit Test</p></a></li>
<li><a href='#select.model.gof'>
<p>Fit and Select Point Pattern Models Based on Minimum Contrast and Goodness of Fit</p></a></li>
<li><a href='#select.model2'>
<p>Fit and Select Point Pattern Models Based on Minimum Contrast and AIC</p></a></li>
<li><a href='#teucrium'>
<p>Teucrium capitatum point pattern</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Select Point Pattern Models Based on Minimum Contrast, AIC and
Goodness of Fit</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-12-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcelino de la Cruz</td>
</tr>
<tr>
<td>Depends:</td>
<td>spatstat (&ge; 2.0-0), ecespa</td>
</tr>
<tr>
<td>Imports:</td>
<td>spatstat.geom, spatstat.explore, spatstat.model,
spatstat.random</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcelino de la Cruz &lt;marcelino.delacruz@urjc.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit and selects point pattern models based on minimum contrast, AIC and and goodness of fit.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-26 11:08:53 UTC; marcelino</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-05 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='LF.gof'>Loosmore and Ford Goodness of Fit Test</h2><span id='topic+LF.gof'></span>

<h3>Description</h3>

 
<p>Performs the Loosmore and Ford (2006) test or the Maximum Absolute Deviation test for a spatial point pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  LF.gof(X, rmin=NULL, rmax=NULL, na.rm=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LF.gof_+3A_x">X</code></td>
<td>
<p>An object resulting from the function <code><a href="spatstat.explore.html#topic+envelope">envelope</a></code>,  i.e., with an attribute &quot;<em>simfuns</em>&quot; (obtained using the argument  <code>savefuns=TRUE</code> in <code><a href="spatstat.explore.html#topic+envelope">envelope</a></code>) ,which is an object of class &quot;<code><a href="spatstat.explore.html#topic+fv">fv</a></code>&quot; containing the summary functions computed for each of the simulated patterns.</p>
</td></tr>
<tr><td><code id="LF.gof_+3A_rmin">rmin</code></td>
<td>
<p>Minimum value of the function argument r over which the maximum absolute deviation, or the integral, will be computed for the test.</p>
</td></tr>
<tr><td><code id="LF.gof_+3A_rmax">rmax</code></td>
<td>
<p>Maximum value of the function argument r over which the maximum absolute deviation, or the integral, will be computed for the test.</p>
</td></tr>
<tr><td><code id="LF.gof_+3A_na.rm">na.rm</code></td>
<td>
<p>Should NA's be removed to compute the integral?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These function perform a tests for goodness-of-fit of a point pattern dataset to a point process model, based on Monte Carlo simulation from the model. The simulations should have been previously computed with the function <code><a href="spatstat.explore.html#topic+envelope">envelope</a></code>, applied with the argument <code>savefuns=TRUE</code> in order to save all the simulated functions, required for the computation of the test.
</p>
<p>The test, popularized in the ecological field by Loosmore and Ford (2006) is also described in Diggle (2003, page 14), and according to Baddeley and Turner (2005) also in Diggle (1986) and  Cressie (1991, page 667, equation (8.5.42)).
If the arguments <code>rmin</code> and <code>rmax</code> are set to <code>NULL</code>, the integral of the GoF statistics will be computed over the complete range of r values.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt>u</dt><dd><p>The GoF statistic, i.e., the value of the integral over the range of <em>r</em>'s</p>
</dd>
<dt>p</dt><dd><p>The p-value of the test</p>
</dd>
<dt>na.count.by.r</dt><dd><p>Number of <code>NA</code> values for each r. It helps to evaluate the reliability of the computed u's, specially for small <em>r</em>'s</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Marcelino de la Cruz <a href="mailto:marcelino.delacruz@urjc.es">marcelino.delacruz@urjc.es</a></p>


<h3>References</h3>

<p>Cressie, N.A.C. (1991) <em>Statistics for spatial data</em>. John Wiley and Sons, 1991. 
</p>
<p>Diggle, P. J. (1986). Displaced amacrine cells in the retina of a rabbit : analysis of a bivariate spatial point pattern. <em>J. Neuroscience Methods</em> 18, 115-125. 
</p>
<p>Diggle, P.J. (2003) <em>Statistical analysis of spatial point patterns</em>, Second edition. Arnold. 
</p>
<p>Loosmore, N.B. and Ford, E.D. (2006) Statistical inference using the G or K point pattern spatial statistics. <em>Ecology</em> 87, 1925-1931. 
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.explore.html#topic+dclf.test">dclf.test</a></code> for an alternative implementation of the test in <span class="pkg">spatstat</span>.
</p>

<hr>
<h2 id='select.model.gof'>
Fit and Select Point Pattern Models Based on Minimum Contrast and Goodness of Fit
</h2><span id='topic+select.model.gof'></span><span id='topic+envelope.selectedmodgof'></span><span id='topic+simulate.selectedmodgof'></span><span id='topic+plot.selectedmodgof'></span><span id='topic+print.selectedmodgof'></span>

<h3>Description</h3>

<p>Fits Poisson, Poisson cluster, several inhomogeneous Poisson and several inhomogeneous Poisson cluster  processes to a spatial point pattern and select the best fitting based on goodness of fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.model.gof(pp, sigmas, r, nlarge = 10000, q = 1/4, p = 2, correction = "trans",
                          sigma2=NULL, rho=NULL, lower=NULL, upper=NULL, parscale=c(1,1),
	                   dimyx=c(128,128), nsim=99, seed=1, correct.lambda=10) 
  ## S3 method for class 'selectedmodgof'
plot(x,...)
  ## S3 method for class 'selectedmodgof'
print(x,...)
  ## S3 method for class 'selectedmodgof'
envelope(Y,fun=NULL,nrank=1,nsim=99,dimyx=c(128,128),...)
  ## S3 method for class 'selectedmodgof'
simulate(object, nsim=99, seed=1, dimyx=c(128,128),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select.model.gof_+3A_pp">pp</code></td>
<td>

<p>Unmarked point pattern with the ppp format of spatstat
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_sigmas">sigmas</code></td>
<td>

<p>Vector with the sigma values (standard deviations of the Gaussian kernel) for estimating different intensity surfaces with  density.ppp. 
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_r">r</code></td>
<td>

<p>Vector of values for the argument r at which the (in)homogeneous K function should be evaluated. First element should be 0.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_nlarge">nlarge</code></td>
<td>

<p>A number of points. In spatstat, if the number of points exceeds nlarge, then only the border correction will be computed (by default) for K(r). If you have a large number of points (n) and you want your border correction to be applied, set nlarge &gt; n.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_q">q</code></td>
<td>

<p>q parameter of the dtheta (i.e., minimum contrast) function.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_p">p</code></td>
<td>

<p>p parameter of the dtheta (i.e., minimum contrast) function.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_correction">correction</code></td>
<td>

<p>Any selection of the options &quot;border&quot;, &quot;bord.modif&quot;, &quot;isotropic&quot;, &quot;Ripley&quot;, &quot;translate&quot;, &quot;translation&quot;, &quot;none&quot; or &quot;best&quot;. It specifies the edge correction(s) to be applied.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_sigma2">sigma2</code></td>
<td>

<p>Starting  value in the optimization for the squared standard deviation of the Gaussian dispersion around parent points in the in(homogeneous) Poisson cluster process.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_rho">rho</code></td>
<td>

<p>Starting  value in the optimization for the intensity of parent points in the in(homogeneous) Poisson cluster process.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_lower">lower</code></td>
<td>

<p>Vector of length two with the lowest allowed values for sigma2 and rho.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_upper">upper</code></td>
<td>

<p>Vector of length two with the largest allowed values for sigma2 and rho.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_parscale">parscale</code></td>
<td>

<p>Initial values for sigma2 and rho for one of  the optimization approaches .
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_dimyx">dimyx</code></td>
<td>

<p>Pixel array dimensions to estimate the intensity of the point pattern when simulating from inhomogeneous models.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_nsim">nsim</code></td>
<td>

<p>Number of simulated point patterns to be generated for the estimation of the GoF of each fitted model, or when using  simulate.selectedmodgof or  envelope.selectedmodgof.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_seed">seed</code></td>
<td>

<p>A single value to set the random generator.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_correct.lambda">correct.lambda</code></td>
<td>

<p>Fraction of the lowest positive  intensity value that will be employed to replace intensity estimates == 0. 
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to  the plot, print, envelope and simulate methods.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_x">x</code></td>
<td>

<p>An object of class &quot;selectedmodgof&quot;, i.e., the result of using function select.model.gof().
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_y">Y</code></td>
<td>

<p>An object of class &quot;selectedmodgof&quot;, i.e., the result of using function select.model.gof().
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_object">object</code></td>
<td>

<p>An object of class &quot;selectedmodgof&quot;, i.e., the result of using function select.model.gof().
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_fun">fun</code></td>
<td>

<p>Function to compute the desired summary statistic for the point pattern.
</p>
</td></tr>
<tr><td><code id="select.model.gof_+3A_nrank">nrank</code></td>
<td>

<p>Integer. Rank of the envelope value amongst the nsim simulated values. A rank of 1 means that the minimum and maximum simulated values will be used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>select.model.gof is a wrap to fit and select different point processes using standard tools in <span class="pkg">spatstat</span> and in <span class="pkg">ecespa</span>. The basic framework consists in choosing among the provided <em>sigma</em> values the bandwith which produces the best fitting of an inhomogeneous Poisson and the one which produces the best fitting of an inhomogeneous Poisson cluster process. The goodness of fit (GoF) of these models are  compared to the GoF a homogeneous Poisson process and tho the GoF of a homogeneous Poisson cluster process, and the model with the best fit is returned as the final result. To avoid optimization problems (i.e., obtaining non-realistic parameters for the Poisson cluster models), arguments <em>lower</em> and <em>upper</em> alllow restricting the range of values that these parameters can attain. If these ranges are not set  by the user, <em>select.model.gof</em> will select by default the most extreme and sensible values (e.g., from just one cluster to as many clusters as points in the pattern). As the experience shows that different optimization algorithms provide different results, the basic framework is repeated using both the &quot;L-BFGS-B&quot; and the &quot;Nelder-Mead&quot; algorithms of <a href="stats.html#topic+optim">optim</a>. In adition to the initial parameters provided with the argument <em>parscale</em>, an aditional otimization using as <em>parscale</em> the maximum and minimum values of the <em>lower</em> and <em>upper</em> parameters range is also tried with the &quot;L-BFGS-B&quot; algorithm.
</p>
<p>The goodness of fit is based on the K function (estimated by <a href="spatstat.explore.html#topic+Kest">Kest</a> or <a href="spatstat.explore.html#topic+Kinhom">Kinhom</a>) and is  evaluated following the approach of  Loosmore and Ford (2006) implemented in <a href="#topic+LF.gof">LF.gof</a>. This implies computing the sum of squared differences between the observed K function and  the mean of the K functions of <em>nsim</em> simulations from the fitted models (the <em>u</em> statistic), which means lots of computations and makes the process time comsuming.
</p>
<p>Whereas the  model selection approach based on AIC implemented in <a href="#topic+select.model2">select.model2</a> is more appropriated for inference purposes, the approach followed by <em>select.model.gof</em> in general is able to select models whose simulations resemble more closely the original pattern.
</p>


<h3>Value</h3>

<p>select.model.gof returns an object of class &quot;<em>selectedmodgof</em>&quot;,i.e., a list with components:
</p>
<table>
<tr><td><code>gof.u</code></td>
<td>
<p>vector with the <em>u</em> statistic of each model.</p>
</td></tr>
<tr><td><code>best.gof</code></td>
<td>
<p>the minimum <em>u</em> value.</p>
</td></tr>
<tr><td><code>best.model</code></td>
<td>
<p> The best of the fitted models. </p>
</td></tr>
<tr><td><code>models</code></td>
<td>
<p>vector with the names of the fitted models.</p>
</td></tr>
<tr><td><code>gof</code></td>
<td>
<p>A list the results of the <a href="ecespa.html#topic+LF.gof">LF.gof</a> test applied to the selected model, i.e., the   <em>u</em> value and the associated <em>p</em>-value of the GoF test.</p>
</td></tr>
<tr><td><code>envelopes</code></td>
<td>
<p>An <a href="spatstat.explore.html#topic+envelope">envelope</a> object with envelopes computed form the best model. </p>
</td></tr>
<tr><td><code>pp</code></td>
<td>
<p> The analyzed point pattern, with the ppp format of spatstat.</p>
</td></tr>
<tr><td><code>best.sigma</code></td>
<td>
<p>The value of the selected bandwith.</p>
</td></tr>
</table>
<p><em>envelope.selectedmod</em> returns a an object of class &quot;fv&quot;, see <a href="spatstat.explore.html#topic+fv.object">fv.object</a>, which can be printed and plotted directly. Essentially a data frame containing columns 
</p>
<table>
<tr><td><code>r</code></td>
<td>
<p>the vector of values of the argument r at which the summary function fun has been estimated.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>values of the summary function for the data point pattern.</p>
</td></tr>
<tr><td><code>lo</code></td>
<td>
<p>lower envelope of simulations.</p>
</td></tr>
<tr><td><code>hi</code></td>
<td>
<p>upper envelope of simulations.</p>
</td></tr>
<tr><td><code>mmean</code></td>
<td>
<p>estimated theoretical value of the summary function, computed by averaging simulated values.</p>
</td></tr>
</table>
<p><em>simulate.selectedmod</em> returns a list of <em>nsim</em> point patterns (with the <a href="spatstat.geom.html#topic+ppp">ppp</a> format of spatstat, simulated according to the best fitted model.
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Chacon-Labella, J., De la Cruz, M. and Escudero, A. Beyond the classical nurse species effect: diversity assembly in a Mediterranean semiarid dwarf  shrubland. <em>Journal of Vegetaation Science</em>. Accepted for publication, July 2015.
</p>
<p>Loosmore, N.B. and Ford, E.D. (2006) Statistical inference using the G or K point pattern spatial statistics. <em>Ecology</em> 87, 1925-1931
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Get the data
data(teucrium)

# Define the sequence of r's at which estimate K(r)
  r&lt;-seq(0,1.5, by=0.01)

# Define different standard deviations for the Gaussian kernel 
# to estimate different intensity surfaces
 sigmas &lt;- seq(0.5, 3.5, by=0.25)



# Fit 28 models (1 Poisson, 1 Poisson cluster, 13 inhomogeneous Poisson
#  and 13 inhomogeneous Poisson cluster)  to  teucrium and select the better ones

teucrium.model &lt;- select.model.gof(teucrium, sigmas=sigmas, r=r)

teucrium.model 

# Show the empirical K function, 
#  and the envelopes based on this model

 plot( teucrium.model, sqrt(./pi)-r~r, legend=F, ylab="L(r)", las=1)


# Compute and plot envelopes for the pcf function according to the best fitted model.

teucrium.env &lt;- envelope(teucrium.model, fun=pcf,  nsim=19)
plot(teucrium.env, legend=F)

# simulate 10 point patterns according to the best fitted model

teucrium.simu &lt;- simulate(teucrium.model, nsim=10)

teucrium.simu



## End(Not run)
</code></pre>

<hr>
<h2 id='select.model2'>
Fit and Select Point Pattern Models Based on Minimum Contrast and AIC
</h2><span id='topic+select.model2'></span><span id='topic+aic.function'></span><span id='topic+ipc.estK2'></span><span id='topic+envelope.selectedmod'></span><span id='topic+simulate.selectedmod'></span><span id='topic+plot.selectedmod'></span><span id='topic+print.selectedmod'></span>

<h3>Description</h3>

<p>Fits Poisson, Poisson cluster, several inhomogeneous Poisson and several inhomogeneous Poisson cluster  processes to a spatial point pattern and select the best fitting based on AIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.model2(pp, sigmas, r, nlarge = 10000, q = 1/4, p = 2, correction = "trans")
ipc.estK2(mippp, lambda = NULL, correction = "iso", r = NULL, sigma2 = NULL, 
             rho = NULL, q = 1/4, p = 2, nlarge = NULL, ...)
aic.function(r, dtheta, npar)
  ## S3 method for class 'selectedmod'
envelope(Y,fun=NULL,nrank=1,nsim=99,dimyx=c(128,128),...)
  ## S3 method for class 'selectedmod'
simulate(object,nsim=99, seed=1,dimyx=c(128,128),...)
  ## S3 method for class 'selectedmod'
plot(x,...)
  ## S3 method for class 'selectedmod'
print(x,...)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select.model2_+3A_pp">pp</code></td>
<td>

<p>Unmarked point pattern with the ppp format of spatstat
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_sigmas">sigmas</code></td>
<td>

<p>Vector with the sigma values (standard deviations of the Gaussian kernel) for estimating different intensity surfaces with  density.ppp. 
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_r">r</code></td>
<td>

<p>Vector of values for the argument r at which the (in)homogeneous K function should be evaluated. First element should be 0.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_nlarge">nlarge</code></td>
<td>

<p>A number of points. In spatstat, if the number of points exceeds nlarge, then only the border correction will be computed (by default) for K(r). If you have a large number of points (n) and you want your border correction to be applied, set nlarge &gt; n.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_q">q</code></td>
<td>

<p>q parameter of the dtheta (i.e., minimum contrast) function.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_p">p</code></td>
<td>

<p>p parameter of the dtheta (i.e., minimum contrast) function.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_correction">correction</code></td>
<td>

<p>Any selection of the options &quot;border&quot;, &quot;bord.modif&quot;, &quot;isotropic&quot;, &quot;Ripley&quot;, &quot;translate&quot;, &quot;translation&quot;, &quot;none&quot; or &quot;best&quot;. It specifies the edge correction(s) to be applied.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_mippp">mippp</code></td>
<td>

<p>Unmarked point pattern with the ppp format of spatstat
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_lambda">lambda</code></td>
<td>

<p>Optional. Values of the estimated intensity function. Either a vector giving the intensity values at the points of the pattern mippp, a pixel image (object of class &quot;im&quot;) giving the intensity values at all locations, a fitted point process model (object of class &quot;ppm&quot; or &quot;kppm&quot;) or a function(x,y) which can be evaluated to give the intensity value at any location.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_sigma2">sigma2</code></td>
<td>

<p>Starting  value in the optimization for the squared standard deviation of the Gaussian dispersion around parent points in the in(homogeneous) Poisson cluster process.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_rho">rho</code></td>
<td>

<p>Starting  value in the optimization for the intensity of parent points in the in(homogeneous) Poisson cluster process.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to the optim function (or to the plot, print, envelope and simulate methods).
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_dtheta">dtheta</code></td>
<td>

<p>Minimum contrast discrepancy, i.e., sum of squared diferences between the normalized empirical and theoretical K functions.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_npar">npar</code></td>
<td>

<p>Number of parameters fitted in the model.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_x">x</code></td>
<td>

<p>An object of class &quot;selectedmod&quot;, i.e., the result of using function select.model2().
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_y">Y</code></td>
<td>

<p>An object of class &quot;selectedmod&quot;, i.e., the result of using function select.model2().
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_object">object</code></td>
<td>

<p>An object of class &quot;selectedmod&quot;, i.e., the result of using function select.model2().
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_fun">fun</code></td>
<td>

<p>Function to compute the desired summary statistic for the point pattern.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_nsim">nsim</code></td>
<td>

<p>Number of simulated point patterns to be generated with simulate.selectedmod or when computing the envelopes with envelope.selectedmod.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_seed">seed</code></td>
<td>

<p>A single value to set the random generator.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_nrank">nrank</code></td>
<td>

<p>Integer. Rank of the envelope value amongst the nsim simulated values. A rank of 1 means that the minimum and maximum simulated values will be used.
</p>
</td></tr>
<tr><td><code id="select.model2_+3A_dimyx">dimyx</code></td>
<td>

<p>Pixel array dimensions to estimate the intensity of the point pattern when simulating from inhomogeneous models.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>select.model2 is a wrap to fit and select different point processes using standard tools in of <span class="pkg">spatstat</span> and of <span class="pkg">ecespa</span>.
ipc.estK2 fits (in)homogeneous models as the function  <a href="ecespa.html#topic+ipc.estK">ipc.estK</a> of <span class="pkg">ecespa</span> but, in addition, it allows seting the argument nlarge and passing options to <a href="stats.html#topic+optim">optim</a>.  AIC calculation (actually AICc) is made by aic.function. See more details in Jara et al. (2015).
</p>


<h3>Value</h3>

<p>select.model2 returns an object of class &quot;<code>selectedmod</code>&quot;,i.e., a list with components:
</p>

<dl>
<dt>dtheta </dt><dd><p>vector with the minimized discrepancy values for each fitted model.</p>
</dd>
<dt>best.dtheta </dt><dd><p>the minimum of the minimized discrepancy values.</p>
</dd>
<dt>best.model </dt><dd><p> The best of the fitted models. </p>
</dd>
<dt>models </dt><dd><p>vector with the names of the fitted models</p>
</dd>
<dt>HPPs </dt><dd><p>A list with the intensity objects employed to fit each inhomogeneous model</p>
</dd>
<dt>sigmas </dt><dd><p>vector with the sigma values (standard deviations of the Gaussian kernel) employed to estimate the  different intensity surfaces. </p>
</dd>
<dt>aics </dt><dd><p>vector with the AIC values of each model.</p>
</dd>
<dt>Kas </dt><dd><p>data.frame with the empirical K functios employed to fit each model.</p>
</dd>
<dt>pp </dt><dd><p> analyzed point pattern, with the ppp format of spatstat.</p>
</dd>
</dl>
	  
<p><code>ipc.estK</code> gives an object of class '<code>ecespa.minconfit</code>', basically a list with the following components:
</p>
 
<dl>
<dt>sigma2</dt><dd><p>Parameter <code class="reqn">sigma^2</code>.</p>
</dd>
<dt>rho </dt><dd><p>Parameter <code class="reqn">rho</code>. </p>
</dd>
<dt>d.theta </dt><dd><p>Minimized value of the contrast criterion <code class="reqn">D(theta)</code>. </p>
</dd>
<dt>Kobs </dt><dd><p>Values of the observed K-function. </p>
</dd>
<dt>Kfit </dt><dd><p>Values of the fitted K-function. </p>
</dd>
<dt>r </dt><dd><p> Sequence of distances at which <code>Kobs</code> and <code>Kfit</code> have been estimated. </p>
</dd>
<dt>data </dt><dd><p>Original point pattern. </p>
</dd>
<dt>lambda </dt><dd><p>Original intensity object. </p>
</dd>
<dt>dataname </dt><dd><p>Name of the original point pattern. </p>
</dd>
<dt>lambdaname </dt><dd><p>Name of the original intensity object. </p>
</dd>
<dt>q</dt><dd> <p><code class="reqn">q</code> exponent of the contrast criterion. </p>
</dd>
<dt>p</dt><dd> <p><code class="reqn">p</code> exponent of the contrast criterion.  </p>
</dd>
</dl>

<p><code>aic.function</code> returns a one-row data.frame, with the following items:
</p>

<dl>
<dt>n</dt><dd><p>number of observations employed to compute AIC; i.e., number of r values where K(r) was estimated.</p>
</dd>
<dt>K</dt><dd><p>number of parameters of the model.</p>
</dd>
<dt>RSS</dt><dd><p>&quot;Resiidual Sum of Squares&quot;. It is the value of the discrepacy function Dtheta.</p>
</dd>
<dt>LL</dt><dd><p>Loglikelihood.</p>
</dd>
<dt>AIC</dt><dd><p>AIC value.</p>
</dd>
<dt>AICc</dt><dd><p>Small sample AIC value.</p>
</dd>
</dl>

<p><code>envelope.selectedmod</code> returns a an object of class &quot;fv&quot;, see <a href="spatstat.explore.html#topic+fv.object">fv.object</a>, which can be printed and plotted directly. Essentially a data frame containing columns 
</p>

<dl>
<dt>r</dt><dd><p>the vector of values of the argument r at which the summary function fun has been estimated.</p>
</dd>
<dt>obs</dt><dd><p>values of the summary function for the data point pattern.</p>
</dd>
<dt>lo</dt><dd><p>lower envelope of simulations.</p>
</dd>
<dt>hi</dt><dd><p>upper envelope of simulations.</p>
</dd>
<dt>mmean</dt><dd><p>estimated theoretical value of the summary function, computed by averaging simulated values.</p>
</dd>
</dl>

<p><code>simulate.selectedmod</code> returns a list of <em>nsim</em> point patterns (with the <a href="spatstat.geom.html#topic+ppp">ppp</a> format of spatstat, simulated according to the best fitted model.
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Jara, A., De la Cruz, M., Espinosa, C.I., Mendez, M. &amp; Escudero, A. (2015). Does spatial heterogeneity blur the signature of dispersal syndromes on spatial patterns of woody species? A test in a tropical dry forest. <em>Oikos</em>. http://dx.doi.org/10.1111/oik.02098.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Get the data
data(lansing)

# Split the multivariate pp in their individual components
lansing.sp&lt;-split(lansing)

# Define the sequence of r's at which estimate K(r)
r&lt;-  seq(0,0.25,le=101)

# Define different standard deviations for the Gaussian kernel 
# to estimate different intensity surfaces
sigmas&lt;- seq(0.1,1,by=0.05)

# Note that lansing is defined in a (0,1) x (0,1) window and this affects
# the election of r and sigma values

# Fit 40 models (1 Poisson, 1 Poisson cluster, 19 inhomogeneous Poisson
#  and 19 inhomogeneous Poisson cluster)  to maple and select the better ones
maple.model &lt;- select.model2(lansing.sp$maple, sigmas=sigmas, r=r)
# show the AICc value and the fitted parameters for the best model in each class
maple.model

# Draw the empirical and theoretical models to visually asses the fitting.
# P = Poisson; HPP= heterogeneous (i.e. inhomogeneous) Poisson;
# PC = Poisson cluster; HPC=heterogeneous (i.e. inhomogeneous) Poisson cluster
plot(maple.model)

# Compute and plot envelopes for the K function according to the best fitted model.
maple.env &lt;- envelope(maple.model, nsim=19)
plot(maple.env, sqrt(./pi)-r~r, legend=F)

# simulate 10 point patterns according to the best fitted model

maple.simu &lt;- simulate(maple.model, nsim=10)

maple.simu

# FIt and select models to all species
lansing.models&lt;-lapply(lansing.sp, function(x) select.model2(x, sigmas=sigmas, r=r))
lapply(lansing.models, function(x) x)

## End(Not run)
</code></pre>

<hr>
<h2 id='teucrium'>
Teucrium capitatum point pattern
</h2><span id='topic+teucrium'></span>

<h3>Description</h3>

<p>Locations of  <em>Teucrium capitatum</em> plants in a dwarf-shrub community in Central Spain.  They are part of a more extensive dataset collected and analysed by Chacon-Labella et al. (2015). The coordinates of the plants are given in meters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(teucrium)</code></pre>


<h3>Format</h3>

<p>An object of class &quot;ppp&quot; representing the point pattern of tree locations. See <a href="spatstat.geom.html#topic+ppp.object">ppp.object</a> for details of the format of a ppp object.
</p>


<h3>References</h3>

<p>Chacon-Labella, J., De la Cruz, M. and Escudero, A. Beyond the classical nurse species effect: diversity assembly in a Mediterranean semiarid dwarf  shrubland. <em>Journal of Vegetaation Science</em>. Accepted for publication, July 2015.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(teucrium)
plot(teucrium) 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
