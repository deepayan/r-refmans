<!DOCTYPE html><html><head><title>Help for package pkr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pkr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pkr-package'><p>Pharmacokinetics in R</p></a></li>
<li><a href='#AUC'><p>Calculate Area Under the Curve (AUC) and Area Under the first Moment Curve (AUMC) in a table format</p></a></li>
<li><a href='#BasicUtil'><p>Internal Functions</p></a></li>
<li><a href='#BestSlope'><p>Choose best fit slope for the log(y) and x regression by the criteria of adjusted R-square</p></a></li>
<li><a href='#combXPT'><p>Combine XPT files</p></a></li>
<li><a href='#conv.pp'><p>Convert intermeidate NCA result to adequate unit.</p></a></li>
<li><a href='#foreNCA'><p>Forest plot to compare NCA results</p></a></li>
<li><a href='#IndiNCA'><p>Noncompartmental Analysis for an Individual</p></a></li>
<li><a href='#IntAUC'><p>Calculate interval AUC</p></a></li>
<li><a href='#Interpol'><p>Interpolate y value</p></a></li>
<li><a href='#LinAUC'><p>Area Under the Curve(AUC) and Area Under the first Moment Curve(AUMC) by linear trapezoidal method</p></a></li>
<li><a href='#loadEXPC'><p>Load EX and PC domain files in folders</p></a></li>
<li><a href='#LogAUC'><p>Area Under the Curve(AUC) and Area Under the first Moment Curve(AUMC) by linear-up log-down method</p></a></li>
<li><a href='#NCA'><p>Noncompartmental analysis for a dataset with multiple subjects</p></a></li>
<li><a href='#NCA0'><p>NCA of SDTM data for single subject</p></a></li>
<li><a href='#pdfNCA'><p>NCA output to pdf file</p></a></li>
<li><a href='#plotFit'>
<p>Plot best fit slope</p></a></li>
<li><a href='#plotPK'>
<p>Plot concentration vs. time curve for individuals and collectively.</p></a></li>
<li><a href='#readEX'><p>Read EX domain files</p></a></li>
<li><a href='#readPC'><p>Read PC domain files</p></a></li>
<li><a href='#rNCA'><p>Do NCA for review</p></a></li>
<li><a href='#Round'><p>Round Half Away from Zero</p></a></li>
<li><a href='#RptCfg'>
<p>NCA Report Configuation Table</p></a></li>
<li><a href='#rtfNCA'><p>NCA output to rtf file</p></a></li>
<li><a href='#Slope'><p>Get the Slope of regression log(y) ~ x</p></a></li>
<li><a href='#sNCA'><p>Simplest NCA</p></a></li>
<li><a href='#Subset'><p>Internal Functions</p></a></li>
<li><a href='#tblNCA'><p>Table output NCA</p></a></li>
<li><a href='#txtNCA'><p>Text output of NCA for one subject</p></a></li>
<li><a href='#Unit'>
<p>Disply CDISC standard units and multiplied factor of NCA results</p></a></li>
<li><a href='#UT'><p>Internal Functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-10</td>
</tr>
<tr>
<td>Title:</td>
<td>Pharmacokinetics in R</td>
</tr>
<tr>
<td>Description:</td>
<td>Conduct a noncompartmental analysis as closely as possible to the most widely used commercial software.
             Some features are
             1) CDISC SDTM terms
             2) Automatic slope selection with the same criterion of WinNonlin(R)
             3) Supporting both 'linear-up linear-down' and 'linear-up log-down' method
             4) Interval(partial) AUCs with 'linear' or 'log' interpolation method
             * Reference: Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016. (ISBN:9198299107).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.0), foreign, binr, forestplot, rtf</td>
</tr>
<tr>
<td>Author:</td>
<td>Kyun-Seop Bae [aut], Jee Eun Lee [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kyun-Seop Bae &lt;k@acr.kr&gt;</td>
</tr>
<tr>
<td>Copyright:</td>
<td>2017, Kyun-Seop Bae, Jee Eun Lee</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cran.r-project.org/package=pkr">https://cran.r-project.org/package=pkr</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-11 08:05:56 UTC; Kyun-SeopBae</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-11 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pkr-package'>Pharmacokinetics in R</h2><span id='topic+pkr-package'></span><span id='topic+pkr'></span>

<h3>Description</h3>

<p>It conducts a noncompartmental analysis(NCA) as closely as possible to the most widely used commercial pharmacokinetic analysis software.
</p>


<h3>Details</h3>

<p>The main functions are
</p>
<pre>
NCA	     to perform NCA for many subjects.

IndiNCA  to perform NCA for one subject.
</pre>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;, Jee Eun Lee &lt;JeeEun.Lee@fda.hhs.gov&gt;
</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015.
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'># Theoph and Indometh data: dose in mg, conc in mg/L, time in h
NCA(Theoph, "Subject", "Time", "conc", dose=320, uConc="mg/L")
NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", uConc="mg/L")

iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24)) ; iAUC
NCA(Theoph, "Subject", "Time", "conc", dose=320, iAUC=iAUC, uConc="mg/L")
NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", iAUC=iAUC, uConc="mg/L")

# writeLines(NCA(Theoph, "Subject", "Time", "conc", dose=320, report="Text", uConc="mg/L"),
#            "Theoph_Linear_CoreOutput.txt")
# writeLines(NCA(Theoph, "Subject", "Time", "conc", dose=320, fit="Log", report="Text",
#            uConc="mg/L"), "Theoph_Log_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", report="Text",
#            uConc="mg/L"), "Indometh_Bolus_Linear_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", fit="Log",
#            report="Text", uConc="mg/L"), "Indometh_Bolus_Log_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Infusion", dur=0.25,
#            report="Text", uConc="mg/L"), "Indometh_Infusion_Linear_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Infusion", dur=0.25,
#            fit="Log", report="Text", uConc="mg/L"), "Indometh_Infusion_Log_CoreOutput.txt")

sNCA(Theoph[Theoph$Subject==1,"Time"], Theoph[Theoph$Subject==1, "conc"], dose=320, concUnit="mg/L")
sNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Bolus", concUnit="mg/L")
sNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Infusion", dur=0.25, concUnit="mg/L")

iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24)) ; iAUC
sNCA(Theoph[Theoph$Subject==1,"Time"], Theoph[Theoph$Subject==1, "conc"], dose=320,
        iAUC=iAUC, concUnit="mg/L")
sNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Bolus", iAUC=iAUC, concUnit="mg/L")
sNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Infusion", dur=0.25, iAUC=iAUC, concUnit="mg/L")
</code></pre>

<hr>
<h2 id='AUC'>Calculate Area Under the Curve (AUC) and Area Under the first Moment Curve (AUMC) in a table format</h2><span id='topic+AUC'></span>

<h3>Description</h3>

<p>Calculate Area Under the Curve(AUC) and the first Moment Curve(AUMC) in two ways; 'linear trapezoidal method' or 'linear-up and log-down' method.
Return a table of cumulative values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AUC(x, y, down = "Linear")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AUC_+3A_x">x</code></td>
<td>
<p>vector values of independent variable, usually time</p>
</td></tr>
<tr><td><code id="AUC_+3A_y">y</code></td>
<td>
<p>vector values of dependent variable, usually concentration</p>
</td></tr>
<tr><td><code id="AUC_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>down="Linear"</code> means linear trapezoidal rule with linear interpolation.
<code>down="Log"</code> means linear-up and log-down method.
</p>


<h3>Value</h3>

<p>Table with two columns, <code>AUC</code> and <code>AUMC</code>; the first column values are cumulative AUCs and the second column values cumulative AUMCs.
</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>

<p>Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. pp687-689. 2011.</p>


<h3>See Also</h3>

<p><code><a href="#topic+LinAUC">LinAUC</a></code>, <code><a href="#topic+LogAUC">LogAUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>AUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"])
AUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"], down="Log")
</code></pre>

<hr>
<h2 id='BasicUtil'>Internal Functions</h2><span id='topic+Trim'></span><span id='topic+toproper'></span><span id='topic+Note'></span><span id='topic+PrepPDF'></span><span id='topic+ClosePDF'></span><span id='topic+AddPage'></span><span id='topic+Text1'></span><span id='topic+TextM'></span><span id='topic+Plot4rtf'></span>

<h3>Description</h3>

<p>Internal functions</p>


<h3>Details</h3>

<p>These are not to be called by the user.</p>

<hr>
<h2 id='BestSlope'>Choose best fit slope for the log(y) and x regression by the criteria of adjusted R-square</h2><span id='topic+BestSlope'></span>

<h3>Description</h3>

<p>It sequentially fits (log(y) ~ x) from the last point of x to the previous points with at least 3 points.
It chooses a slope the highest adjusted R-square.
If the difference is less then 1e-4, it chooses longer slope.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BestSlope(x, y, adm = "Extravascular", TOL=1e-4)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BestSlope_+3A_x">x</code></td>
<td>
<p>vector values of x-axis, usually time</p>
</td></tr>
<tr><td><code id="BestSlope_+3A_y">y</code></td>
<td>
<p>vector values of y-axis, usually concentration</p>
</td></tr>
<tr><td><code id="BestSlope_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="BestSlope_+3A_tol">TOL</code></td>
<td>
<p>tolerance. See Phoneix WinNonlin 6.4 User's Guide p33 for the detail.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Choosing the best terminal slope (y in log scale) in pharmacokinetic analysis is somewhat challenging, and it could vary by analysis performer.
Pheonix WinNonlin chooses a slope with highest adjusted R-squared and the longest one. Difference of adjusted R-Squared less than TOL considered to be 0.  
This function uses ordinary least square method (OLS).
</p>


<h3>Value</h3>

<table>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>adjusted R-squared</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points used for slope</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>negative of slope, lambda_z</p>
</td></tr>
<tr><td><code>b0</code></td>
<td>
<p>intercept of regression line</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(y) and x</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest x for lambda_z</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last x for lambda_z</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>predicted y value at last point, predicted concentration for the last time point</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+Slope">Slope</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>BestSlope(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"])
BestSlope(Indometh[Indometh$Subject==1, "time"], Indometh[Indometh$Subject==1, "conc"],
          adm="Bolus")
</code></pre>

<hr>
<h2 id='combXPT'>Combine XPT files</h2><span id='topic+combXPT'></span>

<h3>Description</h3>

<p>This function combines specified CDISC domain XPT files across the folders.</p>


<h3>Usage</h3>

<pre><code class='language-R'>combXPT(folders, domain)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combXPT_+3A_folders">folders</code></td>
<td>
<p>where to find specified CDISC domain XPT files</p>
</td></tr>
<tr><td><code id="combXPT_+3A_domain">domain</code></td>
<td>
<p>domain XPT files to be comined across the folders</p>
</td></tr>
</table>


<h3>Details</h3>

<p>You need to designate only one CDISC domain name.
You may specify one or more folders to find the domain XPT files.
</p>


<h3>Value</h3>

<table>
<tr><td><code>XPT</code></td>
<td>
<p>combined table</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+readEX">readEX</a></code>, <code><a href="#topic+readPC">readPC</a></code></p>

<hr>
<h2 id='conv.pp'>Convert intermeidate NCA result to adequate unit.</h2><span id='topic+conv.pp'></span>

<h3>Description</h3>

<p>This is an internal function</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>

<hr>
<h2 id='foreNCA'>Forest plot to compare NCA results</h2><span id='topic+foreNCA'></span>

<h3>Description</h3>

<p>This function compares NCA results usually from rNCA function</p>


<h3>Usage</h3>

<pre><code class='language-R'>foreNCA(NCAres = "", PPTESTCD = "", PCTESTCD = "", title = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="foreNCA_+3A_ncares">NCAres</code></td>
<td>
<p>NCA results from rNCA function</p>
</td></tr>
<tr><td><code id="foreNCA_+3A_pptestcd">PPTESTCD</code></td>
<td>
<p>CDISC SDTM PP domain Test Code to coompare</p>
</td></tr>
<tr><td><code id="foreNCA_+3A_pctestcd">PCTESTCD</code></td>
<td>
<p>Molecular species to compare specified in PCTESTCD of CDISC SDTM PC domain</p>
</td></tr>
<tr><td><code id="foreNCA_+3A_title">title</code></td>
<td>
<p>Title of the plot</p>
</td></tr>
<tr><td><code id="foreNCA_+3A_...">...</code></td>
<td>
<p>further aguments to pass to the forestplot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functio calls <code>forestplot</code> in forest package.</p>


<h3>Value</h3>

<p>Currently, this just plots.</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+rNCA">rNCA</a></code>
</p>

<hr>
<h2 id='IndiNCA'>Noncompartmental Analysis for an Individual</h2><span id='topic+IndiNCA'></span>

<h3>Description</h3>

<p>It performs a noncompartmental analysis with one subject data. This will be deprecated. Use <code>sNCA()</code> instead.</p>


<h3>Usage</h3>

<pre><code class='language-R'>IndiNCA(x, y, dose = 0, fit = "Linear", adm = "Extravascular", dur = 0,
               report = "Table", iAUC = "", uTime = "h", uConc = "ug/L", uDose = "mg")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IndiNCA_+3A_x">x</code></td>
<td>
<p>vector values of independent variable, usually time</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_y">y</code></td>
<td>
<p>vector values of dependent variable, usually concentration</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_dose">dose</code></td>
<td>
<p>administered dose for the subject</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_fit">fit</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_dur">dur</code></td>
<td>
<p>infusion duration for constant infusion, otherwise 0</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_report">report</code></td>
<td>
<p>either of <code>"Table"</code> or <code>"Text"</code> to specify the type of return value</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_iauc">iAUC</code></td>
<td>
<p>data.frame with three columns, &quot;Name&quot;, &quot;Start&quot;, &quot;End&quot; to specify the invervals for partial (interval) AUC</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_utime">uTime</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_uconc">uConc</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="IndiNCA_+3A_udose">uDose</code></td>
<td>
<p>unit of dose</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This performs a noncompartmental analysis for a subject. It returns practically the same result with the most popular commercial software.
</p>


<h3>Value</h3>

<table>
<tr><td><code>CMAX</code></td>
<td>
<p>maximum concentration, Cmax</p>
</td></tr>
<tr><td><code>CMAXD</code></td>
<td>
<p>dose normalized Cmax, CMAX / Dose, Cmax / Dose</p>
</td></tr>
<tr><td><code>TMAX</code></td>
<td>
<p>time of maximum concentration, Tmax</p>
</td></tr>
<tr><td><code>TLAG</code></td>
<td>
<p>time to observe the first non-zero concentration, for extravascular administration only</p>
</td></tr>
<tr><td><code>CLST</code></td>
<td>
<p>last positive concentration observed, Clast</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>last positive concentration predicted, Clast_pred</p>
</td></tr>
<tr><td><code>TLST</code></td>
<td>
<p>time of last positive concentration, Tlast</p>
</td></tr>
<tr><td><code>LAMZHL</code></td>
<td>
<p>half-life by lambda z, ln(2)/LAMZ</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>lambda_z negative of best fit terminal slope</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points for LAMZ</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(concentration) and time</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>R-squared adjusted</p>
</td></tr>
<tr><td><code>C0</code></td>
<td>
<p>back extrapolated concentration at time 0, for bolus intravascular administration only</p>
</td></tr>
<tr><td><code>AUCLST</code></td>
<td>
<p>AUC from 0 to TLST</p>
</td></tr>
<tr><td><code>AUCALL</code></td>
<td>
<p>AUC using all the given points, including trailing zero concentrations</p>
</td></tr>
<tr><td><code>AUCIFO</code></td>
<td>
<p>AUC infinity observed</p>
</td></tr>
<tr><td><code>AUCIFOD</code></td>
<td>
<p>AUCIFO / Dose</p>
</td></tr>
<tr><td><code>AUCIFP</code></td>
<td>
<p>AUC infinity predicted using CLSTP instead of CLST</p>
</td></tr>
<tr><td><code>AUCIFPD</code></td>
<td>
<p>AUCIFP / Dose</p>
</td></tr>
<tr><td><code>AUCPEO</code></td>
<td>
<p>AUC % extrapolation observed</p>
</td></tr>
<tr><td><code>AUCPEP</code></td>
<td>
<p>AUC % extrapolated for AUCIFP</p>
</td></tr>
<tr><td><code>AUCPBEO</code></td>
<td>
<p>AUC % back extrapolation observed, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUCPBEP</code></td>
<td>
<p>AUC % back extrapolation predicted with AUCIFP, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUMCLST</code></td>
<td>
<p>AUMC to the TLST</p>
</td></tr>
<tr><td><code>AUMCIFO</code></td>
<td>
<p>AUMC infinity observed using CLST</p>
</td></tr>
<tr><td><code>AUMCIFP</code></td>
<td>
<p>AUMC infinity determined by CLSTP</p>
</td></tr>
<tr><td><code>AUMCPEO</code></td>
<td>
<p>AUMC % extrapolated observed</p>
</td></tr>
<tr><td><code>AUMCPEP</code></td>
<td>
<p>AUMC % extrapolated predicted</p>
</td></tr>
<tr><td><code>MRTIVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTEVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for extravascular administration</p>
</td></tr>
<tr><td><code>VZO</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>VZP</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>VZFO</code></td>
<td>
<p>VZO for extravascular administration, VZO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VZFP</code></td>
<td>
<p>VZP for extravascular administration, VZP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLO</code></td>
<td>
<p>clearance using AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>CLP</code></td>
<td>
<p>clearance using AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>CLFO</code></td>
<td>
<p>CLO for extravascular administration, CLO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLFP</code></td>
<td>
<p>CLP for extravascular administration, CLP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VSSO</code></td>
<td>
<p>volume of distribution at steady state using CLST, for intravascular administration only</p>
</td></tr>
<tr><td><code>VSSP</code></td>
<td>
<p>volume of distribution at stead state using CLSTP, for intravascular administration only</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+AUC">AUC</a></code>, <code><a href="#topic+BestSlope">BestSlope</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>IndiNCA(Theoph[Theoph$Subject==1,"Time"], Theoph[Theoph$Subject==1, "conc"], dose=320, uConc="mg/L")
IndiNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Bolus", uConc="mg/L")
IndiNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Infusion", dur=0.25, uConc="mg/L")

IndiNCA(Theoph[Theoph$Subject==1,"Time"], Theoph[Theoph$Subject==1, "conc"], dose=320,
        report="Text", uConc="mg/L")
IndiNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Bolus", report="Text", uConc="mg/L")
IndiNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Infusion", dur=0.25, report="Text", uConc="mg/L")

iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24)) ; iAUC
IndiNCA(Theoph[Theoph$Subject==1,"Time"], Theoph[Theoph$Subject==1, "conc"], dose=320,
        iAUC=iAUC, uConc="mg/L")
IndiNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Bolus", iAUC=iAUC, uConc="mg/L")
IndiNCA(Indometh[Indometh$Subject==1,"time"], Indometh[Indometh$Subject==1, "conc"], dose=25,
        adm="Infusion", dur=0.25, iAUC=iAUC, uConc="mg/L")
</code></pre>

<hr>
<h2 id='IntAUC'>Calculate interval AUC</h2><span id='topic+IntAUC'></span>

<h3>Description</h3>

<p>It calculates interval AUC</p>


<h3>Usage</h3>

<pre><code class='language-R'>IntAUC(x, y, t1, t2, Res, down = "Linear")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IntAUC_+3A_x">x</code></td>
<td>
<p>vector values of independent variable, usually time</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_y">y</code></td>
<td>
<p>vector values of dependent variable, usually concentration</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_t1">t1</code></td>
<td>
<p>start time for AUC</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_t2">t2</code></td>
<td>
<p>end time for AUC</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_res">Res</code></td>
<td>
<p>result from <code>IndiNCA</code> function</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates an interval (partial) AUC (from t1 to t2) with the given series of x and y.
If t1 and/or t2 cannot be found within x vector, it interpolates according to the <code>down</code> option.
</p>


<h3>Value</h3>

<p>return interval AUC value (scalar)</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+AUC">AUC</a></code>, <code><a href="#topic+Interpol">Interpol</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Res = sNCA(Theoph[Theoph$Subject==1,"Time"], Theoph[Theoph$Subject==1, "conc"], 
           dose=320, concUnit="mg/L")
IntAUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"], t1=0.5, t2=11, Res)
</code></pre>

<hr>
<h2 id='Interpol'>Interpolate y value</h2><span id='topic+Interpol'></span>

<h3>Description</h3>

<p>It interpolates y value when a corresponding x value (xnew) does not exist within x vector</p>


<h3>Usage</h3>

<pre><code class='language-R'>Interpol(x, y, xnew, Slope, b0, down = "Linear")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Interpol_+3A_x">x</code></td>
<td>
<p>vector values of x-axis, usually time</p>
</td></tr>
<tr><td><code id="Interpol_+3A_y">y</code></td>
<td>
<p>vector values of y-axis, usually concentration</p>
</td></tr>
<tr><td><code id="Interpol_+3A_xnew">xnew</code></td>
<td>
<p>new x point to be interpolated, usually new time point</p>
</td></tr>
<tr><td><code id="Interpol_+3A_slope">Slope</code></td>
<td>
<p>slope of regression log(y) ~ x</p>
</td></tr>
<tr><td><code id="Interpol_+3A_b0">b0</code></td>
<td>
<p>y value of just left point of xnew</p>
</td></tr>
<tr><td><code id="Interpol_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to interpolate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function interpolate y value, if xnew is not in x vector.
If xnew is in x vector, it just returns the given x and y vector.
This function usually is called by <code>IntAUC</code> function
Returned vector is sorted in the order of increasing x values.
</p>


<h3>Value</h3>

<p>new x and y vector containing xnew and ynew point</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+IntAUC">IntAUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x = 10:1 + 0.1
y = -2*x + 40.2
Interpol(x, y, 1.5)
Interpol(x, y, 1.5, down="Log")
</code></pre>

<hr>
<h2 id='LinAUC'>Area Under the Curve(AUC) and Area Under the first Moment Curve(AUMC) by linear trapezoidal method</h2><span id='topic+LinAUC'></span>

<h3>Description</h3>

<p>It calculates AUC and AUMC using linear trapezoidal method</p>


<h3>Usage</h3>

<pre><code class='language-R'>LinAUC(x, y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LinAUC_+3A_x">x</code></td>
<td>
<p>vector values of independent variable, usually time</p>
</td></tr>
<tr><td><code id="LinAUC_+3A_y">y</code></td>
<td>
<p>vector values of dependent variable, usually concentration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns AUC and AUMC by linear trapezoidal method.
</p>


<h3>Value</h3>

<table>
<tr><td><code>AUC</code></td>
<td>
<p>area under the curve</p>
</td></tr>
<tr><td><code>AUMC</code></td>
<td>
<p>area under the first moment curve</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+LogAUC">LogAUC</a></code>, <code><a href="#topic+AUC">AUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>LinAUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"])
AUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"]) # compare the last line
</code></pre>

<hr>
<h2 id='loadEXPC'>Load EX and PC domain files in folders</h2><span id='topic+loadEXPC'></span>

<h3>Description</h3>

<p>This loads and returns EX and PC domain files in the specified folders</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadEXPC(folders)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadEXPC_+3A_folders">folders</code></td>
<td>
<p>folders where to find EX and PC domain files</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This reads EX and PC domain files in the specified folder.
This calls <code>readEX</code> and <code>readPC</code> functions.
</p>


<h3>Value</h3>

<table>
<tr><td><code>EX</code></td>
<td>
<p>combined EX domain data</p>
</td></tr>
<tr><td><code>PC</code></td>
<td>
<p>combined PC doamin data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+readEX">readEX</a></code>, <code><a href="#topic+readPC">readPC</a></code>
</p>

<hr>
<h2 id='LogAUC'>Area Under the Curve(AUC) and Area Under the first Moment Curve(AUMC) by linear-up log-down method</h2><span id='topic+LogAUC'></span>

<h3>Description</h3>

<p>It calculates AUC and AUMC using linear-up log-down method</p>


<h3>Usage</h3>

<pre><code class='language-R'>LogAUC(x, y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LogAUC_+3A_x">x</code></td>
<td>
<p>vector values of independent variable, usually time</p>
</td></tr>
<tr><td><code id="LogAUC_+3A_y">y</code></td>
<td>
<p>vector values of dependent variable, usually concentration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns AUC and AUMC by linear-up log-down method.
</p>


<h3>Value</h3>

<table>
<tr><td><code>AUC</code></td>
<td>
<p>area under the curve</p>
</td></tr>
<tr><td><code>AUMC</code></td>
<td>
<p>area under the first moment curve</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+LinAUC">LinAUC</a></code>,<code><a href="#topic+AUC">AUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>LogAUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"])
# Compare the last line with the above
AUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"], down="Log") 
</code></pre>

<hr>
<h2 id='NCA'>Noncompartmental analysis for a dataset with multiple subjects</h2><span id='topic+NCA'></span>

<h3>Description</h3>

<p>conduct noncompartmental analysis for many subjects in a data table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCA(concData, id, Time, conc, trt="", fit = "Linear", dose = 0, 
           adm = "Extravascular", dur = 0, report = "Table", iAUC = "", 
           uTime = "h", uConc = "ug/L", uDose = "mg")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCA_+3A_concdata">concData</code></td>
<td>
<p>name of data table containing time-concentration data of multiple subjects</p>
</td></tr>
<tr><td><code id="NCA_+3A_id">id</code></td>
<td>
<p>column name for subject ID</p>
</td></tr>
<tr><td><code id="NCA_+3A_time">Time</code></td>
<td>
<p>column name for the time</p>
</td></tr>
<tr><td><code id="NCA_+3A_conc">conc</code></td>
<td>
<p>column name for the concentration</p>
</td></tr>
<tr><td><code id="NCA_+3A_trt">trt</code></td>
<td>
<p>column name for the treatment code. This is useful for crossover study like bioequivalence trial.</p>
</td></tr>
<tr><td><code id="NCA_+3A_fit">fit</code></td>
<td>
<p>one of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC</p>
</td></tr>
<tr><td><code id="NCA_+3A_dose">dose</code></td>
<td>
<p>administered dose. One should be careful for the unit. This can be a vector containing dose for each subject in order.</p>
</td></tr>
<tr><td><code id="NCA_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="NCA_+3A_dur">dur</code></td>
<td>
<p>infusion duration for constant infusion, otherwise 0.  This can be a vector containing values for each subject in order.</p>
</td></tr>
<tr><td><code id="NCA_+3A_report">report</code></td>
<td>
<p>either of <code>"Table"</code> or <code>"Text"</code> to specify the type of return value</p>
</td></tr>
<tr><td><code id="NCA_+3A_iauc">iAUC</code></td>
<td>
<p>data.frame with three columns, &quot;Name&quot;, &quot;Start&quot;, &quot;End&quot; to specify partial interval AUC</p>
</td></tr>
<tr><td><code id="NCA_+3A_utime">uTime</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="NCA_+3A_uconc">uConc</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="NCA_+3A_udose">uDose</code></td>
<td>
<p>unit of dose</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls <code>IndiNCA</code> repeatedly to do NCA for each subject.
If you specify <code>Report="Text"</code>, this function returns in free text format to be used in a report file.
</p>


<h3>Value</h3>

<table>
<tr><td><code>CMAX</code></td>
<td>
<p>maximum concentration, Cmax</p>
</td></tr>
<tr><td><code>CMAXD</code></td>
<td>
<p>dose normalized Cmax, CMAX / Dose, Cmax / Dose</p>
</td></tr>
<tr><td><code>TMAX</code></td>
<td>
<p>time of maximum concentration, Tmax</p>
</td></tr>
<tr><td><code>TLAG</code></td>
<td>
<p>time to observe the first non-zero concentration, for extravascular administration only</p>
</td></tr>
<tr><td><code>CLST</code></td>
<td>
<p>last positive concentration observed, Clast</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>last positive concentration predicted, Clast_pred</p>
</td></tr>
<tr><td><code>TLST</code></td>
<td>
<p>time of last positive concentration, Tlast</p>
</td></tr>
<tr><td><code>LAMZHL</code></td>
<td>
<p>half-life by lambda z, ln(2)/LAMZ</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>lambda_z negative of best fit terminal slope</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points for LAMZ</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(concentration) and time</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>R-squared adjusted</p>
</td></tr>
<tr><td><code>C0</code></td>
<td>
<p>back extrapolated concentration at time 0, for bolus intravascular administration only</p>
</td></tr>
<tr><td><code>AUCLST</code></td>
<td>
<p>AUC from 0 to TLST</p>
</td></tr>
<tr><td><code>AUCALL</code></td>
<td>
<p>AUC using all the given points, including trailing zero concentrations</p>
</td></tr>
<tr><td><code>AUCIFO</code></td>
<td>
<p>AUC infinity observed</p>
</td></tr>
<tr><td><code>AUCIFOD</code></td>
<td>
<p>AUCIFO / Dose</p>
</td></tr>
<tr><td><code>AUCIFP</code></td>
<td>
<p>AUC infinity predicted using CLSTP instead of CLST</p>
</td></tr>
<tr><td><code>AUCIFPD</code></td>
<td>
<p>AUCIFP / Dose</p>
</td></tr>
<tr><td><code>AUCPEO</code></td>
<td>
<p>AUC % extrapolation observed</p>
</td></tr>
<tr><td><code>AUCPEP</code></td>
<td>
<p>AUC % extrapolated for AUCIFP</p>
</td></tr>
<tr><td><code>AUCPBEO</code></td>
<td>
<p>AUC % back extrapolation observed, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUCPBEP</code></td>
<td>
<p>AUC % back extrapolation predicted with AUCIFP, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUMCLST</code></td>
<td>
<p>AUMC to the TLST</p>
</td></tr>
<tr><td><code>AUMCIFO</code></td>
<td>
<p>AUMC infinity observed using CLST</p>
</td></tr>
<tr><td><code>AUMCIFP</code></td>
<td>
<p>AUMC infinity determined by CLSTP</p>
</td></tr>
<tr><td><code>AUMCPEO</code></td>
<td>
<p>AUMC % extrapolated observed</p>
</td></tr>
<tr><td><code>AUMCPEP</code></td>
<td>
<p>AUMC % extrapolated predicted</p>
</td></tr>
<tr><td><code>MRTIVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTEVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for extravascular administration</p>
</td></tr>
<tr><td><code>VZO</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>VZP</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>VZFO</code></td>
<td>
<p>VZO for extravascular administration, VZO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VZFP</code></td>
<td>
<p>VZP for extravascular administration, VZP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLO</code></td>
<td>
<p>clearance using AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>CLP</code></td>
<td>
<p>clearance using AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>CLFO</code></td>
<td>
<p>CLO for extravascular administration, CLO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLFP</code></td>
<td>
<p>CLP for extravascular administration, CLP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VSSO</code></td>
<td>
<p>volume of distribution at steady state using CLST, for intravascular administration only</p>
</td></tr>
<tr><td><code>VSSP</code></td>
<td>
<p>volume of distribution at stead state using CLSTP, for intravascular administration only</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+sNCA">sNCA</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Theoph and Indometh data: dose in mg, conc in mg/L, time in h
NCA(Theoph, "Subject", "Time", "conc", dose=320, uConc="mg/L")
NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", uConc="mg/L")

iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24)) ; iAUC
NCA(Theoph, "Subject", "Time", "conc", dose=320, iAUC=iAUC, uConc="mg/L")
NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", iAUC=iAUC, uConc="mg/L")

# writeLines(NCA(Theoph, "Subject", "Time", "conc", dose=320, report="Text", uConc="mg/L"),
#            "Theoph_Linear_CoreOutput.txt")
# writeLines(NCA(Theoph, "Subject", "Time", "conc", dose=320, fit="Log", report="Text", 
#            uConc="mg/L"), "Theoph_Log_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", report="Text", 
#            uConc="mg/L"), "Indometh_Bolus_Linear_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", fit="Log",
#            report="Text", uConc="mg/L"), "Indometh_Bolus_Log_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Infusion", dur=0.25,
#            report="Text", uConc="mg/L"), "Indometh_Infusion_Linear_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Infusion", dur=0.25,
#            fit="Log", report="Text", uConc="mg/L"), "Indometh_Infusion_Log_CoreOutput.txt")
</code></pre>

<hr>
<h2 id='NCA0'>NCA of SDTM data for single subject</h2><span id='topic+NCA0'></span>

<h3>Description</h3>

<p>This performs Noncompartmental Analysis(NCA) for only one subject from the CDISC EX and PC domain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCA0(EX0, PC0, fit="Linear")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCA0_+3A_ex0">EX0</code></td>
<td>
<p>Data of one subject from EX domain</p>
</td></tr>
<tr><td><code id="NCA0_+3A_pc0">PC0</code></td>
<td>
<p>Data of one subject from PC domain</p>
</td></tr>
<tr><td><code id="NCA0_+3A_fit">fit</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calls IndiNCA function.
This is called by rNCA function.
</p>


<h3>Value</h3>

<p>This returns NCA results vector.
</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+rNCA">rNCA</a></code>, <code><a href="#topic+sNCA">sNCA</a></code>
</p>

<hr>
<h2 id='pdfNCA'>NCA output to pdf file</h2><span id='topic+pdfNCA'></span>

<h3>Description</h3>

<p>This output NCA result in a pdf file.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdfNCA(fileName = "Temp-NCA.pdf", concData, colSubj = "Subject", colTime = "Time", 
       colConc = "conc", dose = 0, adm = "Extravascular", dur = 0, doseUnit = "mg", 
       timeUnit = "h", concUnit = "ug/L", down="Linear", MW = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pdfNCA_+3A_filename">fileName</code></td>
<td>
<p>file name to save</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_concdata">concData</code></td>
<td>
<p>concentration data table</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_colsubj">colSubj</code></td>
<td>
<p>column name for subject ID</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_coltime">colTime</code></td>
<td>
<p>column name for time</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_colconc">colConc</code></td>
<td>
<p>column name for concentration</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_dose">dose</code></td>
<td>
<p>administered dose</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_dur">dur</code></td>
<td>
<p>duration of infusion</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_doseunit">doseUnit</code></td>
<td>
<p>unit of dose</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_concunit">concUnit</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
<tr><td><code id="pdfNCA_+3A_mw">MW</code></td>
<td>
<p>molecular weight of drug</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>CMAX</code></td>
<td>
<p>maximum concentration, Cmax</p>
</td></tr>
<tr><td><code>CMAXD</code></td>
<td>
<p>dose normalized Cmax, CMAX / Dose, Cmax / Dose</p>
</td></tr>
<tr><td><code>TMAX</code></td>
<td>
<p>time of maximum concentration, Tmax</p>
</td></tr>
<tr><td><code>TLAG</code></td>
<td>
<p>time to observe the first non-zero concentration, for extravascular administration only</p>
</td></tr>
<tr><td><code>CLST</code></td>
<td>
<p>last positive concentration observed, Clast</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>last positive concentration predicted, Clast_pred</p>
</td></tr>
<tr><td><code>TLST</code></td>
<td>
<p>time of last positive concentration, Tlast</p>
</td></tr>
<tr><td><code>LAMZHL</code></td>
<td>
<p>half-life by lambda z, ln(2)/LAMZ</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>lambda_z negative of best fit terminal slope</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points for LAMZ</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(concentration) and time</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>R-squared adjusted</p>
</td></tr>
<tr><td><code>C0</code></td>
<td>
<p>back extrapolated concentration at time 0, for bolus intravascular administration only</p>
</td></tr>
<tr><td><code>AUCLST</code></td>
<td>
<p>AUC from 0 to TLST</p>
</td></tr>
<tr><td><code>AUCALL</code></td>
<td>
<p>AUC using all the given points, including trailing zero concentrations</p>
</td></tr>
<tr><td><code>AUCIFO</code></td>
<td>
<p>AUC infinity observed</p>
</td></tr>
<tr><td><code>AUCIFOD</code></td>
<td>
<p>AUCIFO / Dose</p>
</td></tr>
<tr><td><code>AUCIFP</code></td>
<td>
<p>AUC infinity predicted using CLSTP instead of CLST</p>
</td></tr>
<tr><td><code>AUCIFPD</code></td>
<td>
<p>AUCIFP / Dose</p>
</td></tr>
<tr><td><code>AUCPEO</code></td>
<td>
<p>AUC % extrapolation observed</p>
</td></tr>
<tr><td><code>AUCPEP</code></td>
<td>
<p>AUC % extrapolated for AUCIFP</p>
</td></tr>
<tr><td><code>AUCPBEO</code></td>
<td>
<p>AUC % back extrapolation observed, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUCPBEP</code></td>
<td>
<p>AUC % back extrapolation predicted with AUCIFP, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUMCLST</code></td>
<td>
<p>AUMC to the TLST</p>
</td></tr>
<tr><td><code>AUMCIFO</code></td>
<td>
<p>AUMC infinity observed using CLST</p>
</td></tr>
<tr><td><code>AUMCIFP</code></td>
<td>
<p>AUMC infinity determined by CLSTP</p>
</td></tr>
<tr><td><code>AUMCPEO</code></td>
<td>
<p>AUMC % extrapolated observed</p>
</td></tr>
<tr><td><code>AUMCPEP</code></td>
<td>
<p>AUMC % extrapolated predicted</p>
</td></tr>
<tr><td><code>MRTIVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTEVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for extravascular administration</p>
</td></tr>
<tr><td><code>VZO</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>VZP</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>VZFO</code></td>
<td>
<p>VZO for extravascular administration, VZO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VZFP</code></td>
<td>
<p>VZP for extravascular administration, VZP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLO</code></td>
<td>
<p>clearance using AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>CLP</code></td>
<td>
<p>clearance using AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>CLFO</code></td>
<td>
<p>CLO for extravascular administration, CLO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLFP</code></td>
<td>
<p>CLP for extravascular administration, CLP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VSSO</code></td>
<td>
<p>volume of distribution at steady state using CLST, for intravascular administration only</p>
</td></tr>
<tr><td><code>VSSP</code></td>
<td>
<p>volume of distribution at stead state using CLSTP, for intravascular administration only</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+txtNCA">txtNCA</a></code>, <code><a href="#topic+rtfNCA">rtfNCA</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#pdfNCA(fileName="NCA-Theoph.pdf", Theoph, colSubj="Subject", colTime="Time", 
#       colConc="conc", dose=320, doseUnit="mg", timeUnit="h", concUnit="mg/L")
#pdfNCA(fileName="NCA-Indometh.pdf", Indometh, colSubj="Subject", colTime="time", 
#       colConc="conc", adm="Infusion", dur=0.5, dose=25, doseUnit="mg", 
#       timeUnit="h", concUnit="mg/L")
</code></pre>

<hr>
<h2 id='plotFit'>
Plot best fit slope
</h2><span id='topic+plotFit'></span>

<h3>Description</h3>

<p>Automatically select best fit slope for the given x(usually time) and log(y)(usually concentration) values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFit(concData, id, Time, conc, mol = "", adm = "Extravascular", ID = "", Mol = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotFit_+3A_concdata">concData</code></td>
<td>
<p>name of data table containing time-concentration data of multiple subjects</p>
</td></tr>
<tr><td><code id="plotFit_+3A_id">id</code></td>
<td>
<p>column name for subject ID</p>
</td></tr>
<tr><td><code id="plotFit_+3A_time">Time</code></td>
<td>
<p>column name for the time</p>
</td></tr>
<tr><td><code id="plotFit_+3A_conc">conc</code></td>
<td>
<p>column name for the concentration</p>
</td></tr>
<tr><td><code id="plotFit_+3A_mol">mol</code></td>
<td>
<p>column name for molecular species</p>
</td></tr>
<tr><td><code id="plotFit_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="plotFit_+3A_id">ID</code></td>
<td>
<p>Subject ID for this plot</p>
</td></tr>
<tr><td><code id="plotFit_+3A_mol">Mol</code></td>
<td>
<p>the name of molecular species to see</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Find the best fit slope then plot it.
Currently this function uses ordinary least square method(OLS) only.
This function calles <code>BestSlope</code> function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>adjusted R-squared</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points used for slope</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>negative of slope, lambda_z</p>
</td></tr>
<tr><td><code>b0</code></td>
<td>
<p>intercept of regression line</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(y) and x</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest x for lambda_z</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last x for lambda_z</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>predicted y value at last point, predicted concentration for the last time point</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jee Eun Lee &lt;JeeEun.Lee@fda.hhs.gov&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+BestSlope">BestSlope</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>plotFit(Theoph, "Subject", "Time", "conc", ID="1")
plotFit(Indometh, "Subject", "time", "conc", adm="Bolus", ID="1")
</code></pre>

<hr>
<h2 id='plotPK'>
Plot concentration vs. time curve for individuals and collectively.
</h2><span id='topic+plotPK'></span>

<h3>Description</h3>

<p>Generates individual and superposed concentration vs. time curve and save it in pdf files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPK(concData, id, Time, conc, unitTime = "hr", unitConc = "ng/mL", trt = "", 
       fit = "Linear", dose = 0, adm = "Extravascular", dur = 0, outdir = "Output")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPK_+3A_concdata">concData</code></td>
<td>
<p>name of data table containing time-concentration data of multiple subjects</p>
</td></tr>
<tr><td><code id="plotPK_+3A_id">id</code></td>
<td>
<p>column name for subject ID</p>
</td></tr>
<tr><td><code id="plotPK_+3A_time">Time</code></td>
<td>
<p>column name for the time</p>
</td></tr>
<tr><td><code id="plotPK_+3A_conc">conc</code></td>
<td>
<p>column name for the concentration</p>
</td></tr>
<tr><td><code id="plotPK_+3A_unittime">unitTime</code></td>
<td>
<p>unit for the time</p>
</td></tr>
<tr><td><code id="plotPK_+3A_unitconc">unitConc</code></td>
<td>
<p>unit for the concentration</p>
</td></tr>
<tr><td><code id="plotPK_+3A_trt">trt</code></td>
<td>
<p>column name for the treatment code. This is useful for crossover study like bioequivalence trial.</p>
</td></tr>
<tr><td><code id="plotPK_+3A_fit">fit</code></td>
<td>
<p>one of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC</p>
</td></tr>
<tr><td><code id="plotPK_+3A_dose">dose</code></td>
<td>
<p>administered dose. One should be careful for the unit. This can be a vector containing dose for each subject in order.</p>
</td></tr>
<tr><td><code id="plotPK_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="plotPK_+3A_dur">dur</code></td>
<td>
<p>infusion duration for constant infusion, otherwise 0.  This can be a vector containing values for each subject in order.</p>
</td></tr>
<tr><td><code id="plotPK_+3A_outdir">outdir</code></td>
<td>
<p>name of the folder to be used for the output files</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates plots for individual and summary concentration vs. time curve. This function calles <code>NCA()</code>.
</p>


<h3>Value</h3>

<p>This function saves pdf files and tiff files in the <code>outdir</code> folder.
</p>


<h3>Author(s)</h3>

<p>Jee Eun Lee &lt;JeeEun.Lee@fda.hhs.gov&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+NCA">NCA</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># plotPK(Theoph, "Subject", "Time", "conc", unitTime="hr", unitConc="mg/L", dose=320)
# plotPK(Indometh, "Subject", "time", "conc", unitTime="hr", unitConc="mg/L", adm="Bolus", dose=25)
</code></pre>

<hr>
<h2 id='readEX'>Read EX domain files</h2><span id='topic+readEX'></span>

<h3>Description</h3>

<p>This reads EX domain files from the specified folders.</p>


<h3>Usage</h3>

<pre><code class='language-R'>readEX(folders)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readEX_+3A_folders">folders</code></td>
<td>
<p>folders where to find EX doamin files</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calls <code>combXPT</code> function.
This is called by <code>loadEXPC</code> function.
</p>


<h3>Value</h3>

<p>This returns combined table of EX doamin.</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+combXPT">combXPT</a></code>, <code><a href="#topic+loadEXPC">loadEXPC</a></code>
</p>

<hr>
<h2 id='readPC'>Read PC domain files</h2><span id='topic+readPC'></span>

<h3>Description</h3>

<p>This reads PC domain files from the specified folders.</p>


<h3>Usage</h3>

<pre><code class='language-R'>readPC(folders)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readPC_+3A_folders">folders</code></td>
<td>
<p>folders where to find PC doamin files</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calls <code>combXPT</code> function.
This is called by <code>loadEXPC</code> function.
</p>


<h3>Value</h3>

<p>This returns combined table of PC doamin.</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+combXPT">combXPT</a></code>, <code><a href="#topic+loadEXPC">loadEXPC</a></code>
</p>

<hr>
<h2 id='rNCA'>Do NCA for review</h2><span id='topic+rNCA'></span>

<h3>Description</h3>

<p>This performs NCA from the CDISC EX and PC datasets.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rNCA(ex, pc, study = "", trt = "", id = "", analyte = "", 
     codeBQL = c("&lt; 0", "&lt;0", "NQ", "BLQ", "BQL", "BQoL", "&lt;LOQ"), 
     fit="Linear", MinPoints = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rNCA_+3A_ex">ex</code></td>
<td>
<p>EX domain data, usually from the <code>loadEXPC</code></p>
</td></tr>
<tr><td><code id="rNCA_+3A_pc">pc</code></td>
<td>
<p>PC domain data, usually form the <code>loadEXPC</code></p>
</td></tr>
<tr><td><code id="rNCA_+3A_study">study</code></td>
<td>
<p>vector of study names in EX and PC domain to do NCA</p>
</td></tr>
<tr><td><code id="rNCA_+3A_trt">trt</code></td>
<td>
<p>vector of treatment names in EXTRT to do NCA</p>
</td></tr>
<tr><td><code id="rNCA_+3A_id">id</code></td>
<td>
<p>vector of subject IDs in USUBJID to do NCA</p>
</td></tr>
<tr><td><code id="rNCA_+3A_analyte">analyte</code></td>
<td>
<p>vector of molecular species in PCTESTCD to do NCA</p>
</td></tr>
<tr><td><code id="rNCA_+3A_codebql">codeBQL</code></td>
<td>
<p>symbols of below the quantitation limit</p>
</td></tr>
<tr><td><code id="rNCA_+3A_fit">fit</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
<tr><td><code id="rNCA_+3A_minpoints">MinPoints</code></td>
<td>
<p>minimum number of sampling points for NCA</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calls NCA0.
Results of this can be further processed by foreNCA to plot and compare between studies and dose groups.
</p>


<h3>Value</h3>

<p>This returns a table of NCA results
</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+NCA0">NCA0</a></code>, <code><a href="#topic+loadEXPC">loadEXPC</a></code>, <code><a href="#topic+foreNCA">foreNCA</a></code> 
</p>

<hr>
<h2 id='Round'>Round Half Away from Zero</h2><span id='topic+Round'></span>

<h3>Description</h3>

<p>This is an ordinary rounding function, so called round half away from zero
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Round(x, n = 0)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Round_+3A_x">x</code></td>
<td>
<p>numeric to be rounded</p>
</td></tr>
<tr><td><code id="Round_+3A_n">n</code></td>
<td>
<p>indicating decimal digits</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>round</code> in R base rounds to the even number, i.e. <code>round(0.5)</code> is 0 not 1.
If you want rounding 0.5 be 1, you can use this <code>Round</code> function.
This function is for the consistency with other software like MS-Excel, SAS.
</p>


<h3>Value</h3>

<p>ordinarily rounded value
</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>

<p>See wikipedia subject &quot;Rounding&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>(x = 1:10 - 0.5)
Round(x)
round(x) # compare with the above
</code></pre>

<hr>
<h2 id='RptCfg'>
NCA Report Configuation Table
</h2><span id='topic+RptCfg'></span>

<h3>Description</h3>

<p>Contains the names and order of colum of return table/text by <code>IndiNCA</code> and <code>NCA</code> functions 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RptCfg</code></pre>


<h3>Format</h3>

<p>A data frame with 48 observations on the following 10 variables.
</p>

<dl>
<dt><code>PPTESTCD</code></dt><dd><p>a character vector of CDISC SDTM PPTESTCD</p>
</dd>
<dt><code>SYNONYM</code></dt><dd><p>a character vector of CDISC SDTM PPTESTCD Synonym</p>
</dd>
<dt><code>NCI</code></dt><dd><p>a character vector of NCI peferred terms</p>
</dd>
<dt><code>WNL</code></dt><dd><p>a character vector of WinNonlin(R) software variables</p>
</dd>
<dt><code>ExtravascularDefault</code></dt><dd><p>a numeric vector of ordering in report for extravascular administration, Zero means exclusion in the report.</p>
</dd>
<dt><code>ExtravascularWNL</code></dt><dd><p>a numeric vector of WinNonlin(R) style ordering in report for extravascular administration, Zero means exclusion in the report.</p>
</dd>
<dt><code>BolusDefault</code></dt><dd><p>a numeric vector of ordering in report for extravascular administration, Zero means exclusion in the report.</p>
</dd>
<dt><code>BolusWNL</code></dt><dd><p>a numeric vector of WinNonlin(R) style ordering in report for extravascular administration, Zero means exclusion in the report.</p>
</dd>
<dt><code>InfusionDefault</code></dt><dd><p>a numeric vector of ordering in report for extravascular administration, Zero means exclusion in the report.</p>
</dd>
<dt><code>InfusionWNL</code></dt><dd><p>a numeric vector of WinNonlin(R) style ordering in report for extravascular administration, Zero means exclusion in the report.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This table should exist in pkr package.
User can edit this table for shaping the report in one's own style. 
</p>

<hr>
<h2 id='rtfNCA'>NCA output to rtf file</h2><span id='topic+rtfNCA'></span>

<h3>Description</h3>

<p>This output NCA result in a rtf file.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtfNCA(fileName = "Temp-NCA.rtf", concData, colSubj = "Subject", colTime = "Time", 
       colConc = "conc", dose = 0, adm = "Extravascular", dur = 0, doseUnit = "mg", 
       timeUnit = "h", concUnit = "ug/L", down="Linear", MW = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtfNCA_+3A_filename">fileName</code></td>
<td>
<p>file name to save</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_concdata">concData</code></td>
<td>
<p>concentration data table</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_colsubj">colSubj</code></td>
<td>
<p>column name for subject ID</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_coltime">colTime</code></td>
<td>
<p>column name for time</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_colconc">colConc</code></td>
<td>
<p>column name for concentration</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_dose">dose</code></td>
<td>
<p>administered dose</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_dur">dur</code></td>
<td>
<p>duration of infusion</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_doseunit">doseUnit</code></td>
<td>
<p>unit of dose</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_concunit">concUnit</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
<tr><td><code id="rtfNCA_+3A_mw">MW</code></td>
<td>
<p>molecular weight of drug</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>CMAX</code></td>
<td>
<p>maximum concentration, Cmax</p>
</td></tr>
<tr><td><code>CMAXD</code></td>
<td>
<p>dose normalized Cmax, CMAX / Dose, Cmax / Dose</p>
</td></tr>
<tr><td><code>TMAX</code></td>
<td>
<p>time of maximum concentration, Tmax</p>
</td></tr>
<tr><td><code>TLAG</code></td>
<td>
<p>time to observe the first non-zero concentration, for extravascular administration only</p>
</td></tr>
<tr><td><code>CLST</code></td>
<td>
<p>last positive concentration observed, Clast</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>last positive concentration predicted, Clast_pred</p>
</td></tr>
<tr><td><code>TLST</code></td>
<td>
<p>time of last positive concentration, Tlast</p>
</td></tr>
<tr><td><code>LAMZHL</code></td>
<td>
<p>half-life by lambda z, ln(2)/LAMZ</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>lambda_z negative of best fit terminal slope</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points for LAMZ</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(concentration) and time</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>R-squared adjusted</p>
</td></tr>
<tr><td><code>C0</code></td>
<td>
<p>back extrapolated concentration at time 0, for bolus intravascular administration only</p>
</td></tr>
<tr><td><code>AUCLST</code></td>
<td>
<p>AUC from 0 to TLST</p>
</td></tr>
<tr><td><code>AUCALL</code></td>
<td>
<p>AUC using all the given points, including trailing zero concentrations</p>
</td></tr>
<tr><td><code>AUCIFO</code></td>
<td>
<p>AUC infinity observed</p>
</td></tr>
<tr><td><code>AUCIFOD</code></td>
<td>
<p>AUCIFO / Dose</p>
</td></tr>
<tr><td><code>AUCIFP</code></td>
<td>
<p>AUC infinity predicted using CLSTP instead of CLST</p>
</td></tr>
<tr><td><code>AUCIFPD</code></td>
<td>
<p>AUCIFP / Dose</p>
</td></tr>
<tr><td><code>AUCPEO</code></td>
<td>
<p>AUC % extrapolation observed</p>
</td></tr>
<tr><td><code>AUCPEP</code></td>
<td>
<p>AUC % extrapolated for AUCIFP</p>
</td></tr>
<tr><td><code>AUCPBEO</code></td>
<td>
<p>AUC % back extrapolation observed, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUCPBEP</code></td>
<td>
<p>AUC % back extrapolation predicted with AUCIFP, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUMCLST</code></td>
<td>
<p>AUMC to the TLST</p>
</td></tr>
<tr><td><code>AUMCIFO</code></td>
<td>
<p>AUMC infinity observed using CLST</p>
</td></tr>
<tr><td><code>AUMCIFP</code></td>
<td>
<p>AUMC infinity determined by CLSTP</p>
</td></tr>
<tr><td><code>AUMCPEO</code></td>
<td>
<p>AUMC % extrapolated observed</p>
</td></tr>
<tr><td><code>AUMCPEP</code></td>
<td>
<p>AUMC % extrapolated predicted</p>
</td></tr>
<tr><td><code>MRTIVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTEVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for extravascular administration</p>
</td></tr>
<tr><td><code>VZO</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>VZP</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>VZFO</code></td>
<td>
<p>VZO for extravascular administration, VZO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VZFP</code></td>
<td>
<p>VZP for extravascular administration, VZP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLO</code></td>
<td>
<p>clearance using AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>CLP</code></td>
<td>
<p>clearance using AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>CLFO</code></td>
<td>
<p>CLO for extravascular administration, CLO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLFP</code></td>
<td>
<p>CLP for extravascular administration, CLP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VSSO</code></td>
<td>
<p>volume of distribution at steady state using CLST, for intravascular administration only</p>
</td></tr>
<tr><td><code>VSSP</code></td>
<td>
<p>volume of distribution at stead state using CLSTP, for intravascular administration only</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+txtNCA">txtNCA</a></code>, <code><a href="#topic+pdfNCA">pdfNCA</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#rtfNCA(fileName="NCA-Theoph.rtf", Theoph, colSubj="Subject", colTime="Time", 
#       colConc="conc", dose=320, doseUnit="mg", timeUnit="h", concUnit="mg/L")
#rtfNCA(fileName="NCA-Indometh.rtf", Indometh, colSubj="Subject", colTime="time", 
#       colConc="conc", adm="Infusion", dur=0.5, dose=25, doseUnit="mg", 
#       timeUnit="h", concUnit="mg/L")
</code></pre>

<hr>
<h2 id='Slope'>Get the Slope of regression log(y) ~ x</h2><span id='topic+Slope'></span>

<h3>Description</h3>

<p>It calculates the slope with linear regression of log(y) ~ x
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Slope(x, y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Slope_+3A_x">x</code></td>
<td>
<p>vector values of independent variable, usually time</p>
</td></tr>
<tr><td><code id="Slope_+3A_y">y</code></td>
<td>
<p>vector values of dependent variable, usually concentration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With time-concentration curve, you frequently need to estimate slope in log(concentration) ~ time.
This function is usually called by <code>BestSlope</code> function and you seldom need to call this function directly.
</p>


<h3>Value</h3>

<table>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>adjusted R-squared</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points used for slope</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>negative of slope, lambda_z</p>
</td></tr>
<tr><td><code>b0</code></td>
<td>
<p>intercept of regression line</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(y) and x</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest x for lambda_z</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last x for lambda_z</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>predicted y value at last point, predicted concentration for the last time point</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+BestSlope">BestSlope</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Slope(Indometh[Indometh$Subject==1, "time"], Indometh[Indometh$Subject==1, "conc"])
</code></pre>

<hr>
<h2 id='sNCA'>Simplest NCA</h2><span id='topic+sNCA'></span>

<h3>Description</h3>

<p>This is the work-horse function for NCA.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sNCA(x, y, dose = 0, adm = "Extravascular", dur = 0, doseUnit = "mg", timeUnit = "h", 
     concUnit = "ug/L", iAUC = "", down = "Linear", MW = 0, returnNA = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sNCA_+3A_x">x</code></td>
<td>
<p>usually time</p>
</td></tr>
<tr><td><code id="sNCA_+3A_y">y</code></td>
<td>
<p>usually concentration</p>
</td></tr>
<tr><td><code id="sNCA_+3A_dose">dose</code></td>
<td>
<p>given amount</p>
</td></tr>
<tr><td><code id="sNCA_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="sNCA_+3A_dur">dur</code></td>
<td>
<p>duration of infusion</p>
</td></tr>
<tr><td><code id="sNCA_+3A_doseunit">doseUnit</code></td>
<td>
<p>unit of dose</p>
</td></tr>
<tr><td><code id="sNCA_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="sNCA_+3A_concunit">concUnit</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="sNCA_+3A_iauc">iAUC</code></td>
<td>
<p>interval AUCs to calculate</p>
</td></tr>
<tr><td><code id="sNCA_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
<tr><td><code id="sNCA_+3A_mw">MW</code></td>
<td>
<p>molecular weight of the drug</p>
</td></tr>
<tr><td><code id="sNCA_+3A_returnna">returnNA</code></td>
<td>
<p>if <code>returnNA</code> is <code>TRUE</code>, it returns NA values also.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This will replace <code>IndiNCA</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>CMAX</code></td>
<td>
<p>maximum concentration, Cmax</p>
</td></tr>
<tr><td><code>CMAXD</code></td>
<td>
<p>dose normalized Cmax, CMAX / Dose, Cmax / Dose</p>
</td></tr>
<tr><td><code>TMAX</code></td>
<td>
<p>time of maximum concentration, Tmax</p>
</td></tr>
<tr><td><code>TLAG</code></td>
<td>
<p>time to observe the first non-zero concentration, for extravascular administration only</p>
</td></tr>
<tr><td><code>CLST</code></td>
<td>
<p>last positive concentration observed, Clast</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>last positive concentration predicted, Clast_pred</p>
</td></tr>
<tr><td><code>TLST</code></td>
<td>
<p>time of last positive concentration, Tlast</p>
</td></tr>
<tr><td><code>LAMZHL</code></td>
<td>
<p>half-life by lambda z, ln(2)/LAMZ</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>lambda_z negative of best fit terminal slope</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points for LAMZ</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(concentration) and time</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>R-squared adjusted</p>
</td></tr>
<tr><td><code>C0</code></td>
<td>
<p>back extrapolated concentration at time 0, for bolus intravascular administration only</p>
</td></tr>
<tr><td><code>AUCLST</code></td>
<td>
<p>AUC from 0 to TLST</p>
</td></tr>
<tr><td><code>AUCALL</code></td>
<td>
<p>AUC using all the given points, including trailing zero concentrations</p>
</td></tr>
<tr><td><code>AUCIFO</code></td>
<td>
<p>AUC infinity observed</p>
</td></tr>
<tr><td><code>AUCIFOD</code></td>
<td>
<p>AUCIFO / Dose</p>
</td></tr>
<tr><td><code>AUCIFP</code></td>
<td>
<p>AUC infinity predicted using CLSTP instead of CLST</p>
</td></tr>
<tr><td><code>AUCIFPD</code></td>
<td>
<p>AUCIFP / Dose</p>
</td></tr>
<tr><td><code>AUCPEO</code></td>
<td>
<p>AUC % extrapolation observed</p>
</td></tr>
<tr><td><code>AUCPEP</code></td>
<td>
<p>AUC % extrapolated for AUCIFP</p>
</td></tr>
<tr><td><code>AUCPBEO</code></td>
<td>
<p>AUC % back extrapolation observed, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUCPBEP</code></td>
<td>
<p>AUC % back extrapolation predicted with AUCIFP, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUMCLST</code></td>
<td>
<p>AUMC to the TLST</p>
</td></tr>
<tr><td><code>AUMCIFO</code></td>
<td>
<p>AUMC infinity observed using CLST</p>
</td></tr>
<tr><td><code>AUMCIFP</code></td>
<td>
<p>AUMC infinity determined by CLSTP</p>
</td></tr>
<tr><td><code>AUMCPEO</code></td>
<td>
<p>AUMC % extrapolated observed</p>
</td></tr>
<tr><td><code>AUMCPEP</code></td>
<td>
<p>AUMC % extrapolated predicted</p>
</td></tr>
<tr><td><code>MRTIVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTEVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for extravascular administration</p>
</td></tr>
<tr><td><code>VZO</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>VZP</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>VZFO</code></td>
<td>
<p>VZO for extravascular administration, VZO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VZFP</code></td>
<td>
<p>VZP for extravascular administration, VZP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLO</code></td>
<td>
<p>clearance using AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>CLP</code></td>
<td>
<p>clearance using AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>CLFO</code></td>
<td>
<p>CLO for extravascular administration, CLO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLFP</code></td>
<td>
<p>CLP for extravascular administration, CLP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VSSO</code></td>
<td>
<p>volume of distribution at steady state using CLST, for intravascular administration only</p>
</td></tr>
<tr><td><code>VSSP</code></td>
<td>
<p>volume of distribution at steady state using CLSTP, for intravascular administration only</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>

<p>Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+tblNCA">tblNCA</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For one subject
x = Theoph[Theoph$Subject=="1","Time"]
y = Theoph[Theoph$Subject=="1","conc"]

sNCA(x, y, dose=320, doseUnit="mg", concUnit="mg/L", timeUnit="h")
sNCA(x, y, dose=320, concUnit="mg/L", returnNA=FALSE)

iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24))
sNCA(x, y, dose=320, doseUnit="mg", concUnit="mg/L", timeUnit="h", iAUC=iAUC)

MW = 180.164 # Molecular weight of theophylline

sNCA(x, y/MW, dose=320, doseUnit="mg", concUnit="mmol/L", timeUnit="h")
sNCA(x, y/MW, dose=320, doseUnit="mg", concUnit="mmol/L", timeUnit="h", MW=MW)
sNCA(x, y, dose=320/MW, doseUnit="mmol", concUnit="mg/L", timeUnit="h", MW=MW)
sNCA(x, y/MW, dose=320/MW, doseUnit="mmol", concUnit="mmol/L", timeUnit="h", MW=MW)

sNCA(x, y/MW, dose=320/MW, doseUnit="mmol", concUnit="mmol/L", timeUnit="h", MW=MW, 
     returnNA=FALSE)
sNCA(x, y/MW, doseUnit="mmol", concUnit="mmol/L", timeUnit="h", MW=MW, returnNA=FALSE)
sNCA(x, y/MW, dose=as.numeric(NA), doseUnit="mmol", concUnit="mmol/L", timeUnit="h", 
     MW=MW, returnNA=FALSE)

sNCA(x, y, dose=320, concUnit="mg/L", timeUnit="hr")
sNCA(x*60, y, dose=320, concUnit="mg/L", timeUnit="min")
</code></pre>

<hr>
<h2 id='Subset'>Internal Functions</h2><span id='topic+Subset'></span>

<h3>Description</h3>

<p>Internal functions</p>


<h3>Details</h3>

<p>These are not to be called by the user.</p>

<hr>
<h2 id='tblNCA'>Table output NCA</h2><span id='topic+tblNCA'></span>

<h3>Description</h3>

<p>do multiple NCA and returns a result table.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tblNCA(concData, key = "Subject", colTime = "Time", colConc = "conc", dose = 0, 
       adm = "Extravascular", dur = 0, doseUnit = "mg", timeUnit = "h", 
       concUnit = "ug/L", down = "Linear", MW = 0, returnNA = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tblNCA_+3A_concdata">concData</code></td>
<td>
<p>concentration data table</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_key">key</code></td>
<td>
<p>column names of concData to be shown at the output table</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_coltime">colTime</code></td>
<td>
<p>column name for time</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_colconc">colConc</code></td>
<td>
<p>column name for concentration</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_dose">dose</code></td>
<td>
<p>administered dose</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_dur">dur</code></td>
<td>
<p>duration of infusion</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_doseunit">doseUnit</code></td>
<td>
<p>unit of dose</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_concunit">concUnit</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_down">down</code></td>
<td>
<p>method to calculate AUC, <code>"Linear"</code> or <code>"Log"</code></p>
</td></tr>
<tr><td><code id="tblNCA_+3A_mw">MW</code></td>
<td>
<p>molecular weight of drug</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_returnna">returnNA</code></td>
<td>
<p>if <code>returnNA</code> is <code>TRUE</code>, it returns NA values also.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Basically same with <code><a href="#topic+sNCA">sNCA</a></code></p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+sNCA">sNCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tblNCA(Theoph, key="Subject", dose=320, concUnit="mg/L")
tblNCA(Indometh, key="Subject", colTime="time", colConc="conc", dose=25, 
       adm="Infusion", dur=0.5, concUnit="mg/L")
</code></pre>

<hr>
<h2 id='txtNCA'>Text output of NCA for one subject</h2><span id='topic+txtNCA'></span>

<h3>Description</h3>

<p>This is the text form output.</p>


<h3>Usage</h3>

<pre><code class='language-R'>txtNCA(x, y, dose = 0, adm = "Extravascular", dur = 0, doseUnit = "mg", timeUnit = "h", 
       concUnit = "ug/L", iAUC = "", down="Linear", MW = 0, returnNA = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="txtNCA_+3A_x">x</code></td>
<td>
<p>usually time</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_y">y</code></td>
<td>
<p>usually concentration</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_dose">dose</code></td>
<td>
<p>given amount</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_dur">dur</code></td>
<td>
<p>duration of infusion</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_doseunit">doseUnit</code></td>
<td>
<p>unit of dose</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_concunit">concUnit</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_iauc">iAUC</code></td>
<td>
<p>interval AUCs to calculate</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_mw">MW</code></td>
<td>
<p>molecular weight of the drug</p>
</td></tr>
<tr><td><code id="txtNCA_+3A_returnna">returnNA</code></td>
<td>
<p>if <code>returnNA</code> is <code>TRUE</code>, it returns NA values also.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>CMAX</code></td>
<td>
<p>maximum concentration, Cmax</p>
</td></tr>
<tr><td><code>CMAXD</code></td>
<td>
<p>dose normalized Cmax, CMAX / Dose, Cmax / Dose</p>
</td></tr>
<tr><td><code>TMAX</code></td>
<td>
<p>time of maximum concentration, Tmax</p>
</td></tr>
<tr><td><code>TLAG</code></td>
<td>
<p>time to observe the first non-zero concentration, for extravascular administration only</p>
</td></tr>
<tr><td><code>CLST</code></td>
<td>
<p>last positive concentration observed, Clast</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>last positive concentration predicted, Clast_pred</p>
</td></tr>
<tr><td><code>TLST</code></td>
<td>
<p>time of last positive concentration, Tlast</p>
</td></tr>
<tr><td><code>LAMZHL</code></td>
<td>
<p>half-life by lambda z, ln(2)/LAMZ</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>lambda_z negative of best fit terminal slope</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points for LAMZ</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(concentration) and time</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>R-squared adjusted</p>
</td></tr>
<tr><td><code>C0</code></td>
<td>
<p>back extrapolated concentration at time 0, for bolus intravascular administration only</p>
</td></tr>
<tr><td><code>AUCLST</code></td>
<td>
<p>AUC from 0 to TLST</p>
</td></tr>
<tr><td><code>AUCALL</code></td>
<td>
<p>AUC using all the given points, including trailing zero concentrations</p>
</td></tr>
<tr><td><code>AUCIFO</code></td>
<td>
<p>AUC infinity observed</p>
</td></tr>
<tr><td><code>AUCIFOD</code></td>
<td>
<p>AUCIFO / Dose</p>
</td></tr>
<tr><td><code>AUCIFP</code></td>
<td>
<p>AUC infinity predicted using CLSTP instead of CLST</p>
</td></tr>
<tr><td><code>AUCIFPD</code></td>
<td>
<p>AUCIFP / Dose</p>
</td></tr>
<tr><td><code>AUCPEO</code></td>
<td>
<p>AUC % extrapolation observed</p>
</td></tr>
<tr><td><code>AUCPEP</code></td>
<td>
<p>AUC % extrapolated for AUCIFP</p>
</td></tr>
<tr><td><code>AUCPBEO</code></td>
<td>
<p>AUC % back extrapolation observed, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUCPBEP</code></td>
<td>
<p>AUC % back extrapolation predicted with AUCIFP, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUMCLST</code></td>
<td>
<p>AUMC to the TLST</p>
</td></tr>
<tr><td><code>AUMCIFO</code></td>
<td>
<p>AUMC infinity observed using CLST</p>
</td></tr>
<tr><td><code>AUMCIFP</code></td>
<td>
<p>AUMC infinity determined by CLSTP</p>
</td></tr>
<tr><td><code>AUMCPEO</code></td>
<td>
<p>AUMC % extrapolated observed</p>
</td></tr>
<tr><td><code>AUMCPEP</code></td>
<td>
<p>AUMC % extrapolated predicted</p>
</td></tr>
<tr><td><code>MRTIVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTEVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for extravascular administration</p>
</td></tr>
<tr><td><code>VZO</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>VZP</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>VZFO</code></td>
<td>
<p>VZO for extravascular administration, VZO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VZFP</code></td>
<td>
<p>VZP for extravascular administration, VZP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLO</code></td>
<td>
<p>clearance using AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>CLP</code></td>
<td>
<p>clearance using AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>CLFO</code></td>
<td>
<p>CLO for extravascular administration, CLO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLFP</code></td>
<td>
<p>CLP for extravascular administration, CLP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VSSO</code></td>
<td>
<p>volume of distribution at steady state using CLST, for intravascular administration only</p>
</td></tr>
<tr><td><code>VSSP</code></td>
<td>
<p>volume of distribution at stead state using CLSTP, for intravascular administration only</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+pdfNCA">pdfNCA</a></code>, <code><a href="#topic+rtfNCA">rtfNCA</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For one subject
txtNCA(Theoph[Theoph$Subject=="1","Time"], Theoph[Theoph$Subject=="1","conc"], 
       dose=320, doseUnit="mg", concUnit="mg/L", timeUnit="h")

# or equivalently
x = Theoph[Theoph$Subject=="1","Time"]
y = Theoph[Theoph$Subject=="1","conc"]
txtNCA(x, y, dose=320, doseUnit="mg", concUnit="mg/L", timeUnit="h")

# For all subjects
IDs = sort(as.numeric(unique(Theoph[,"Subject"])))
nID = length(IDs)
Res = vector()
for (i in 1:nID) {
  tRes = txtNCA(Theoph[Theoph[,"Subject"]==IDs[i],"Time"], 
                Theoph[Theoph[,"Subject"]==IDs[i],"conc"], 
                dose=320, concUnit="mg/L", returnNA=FALSE)
  tRes = c(paste("ID =", IDs[i]), tRes, "")
  Res = c(Res, tRes)
}
Res
</code></pre>

<hr>
<h2 id='Unit'>
Disply CDISC standard units and multiplied factor of NCA results  
</h2><span id='topic+Unit'></span>

<h3>Description</h3>

<p>It displays CDISC PP output units and multiplication factor for them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Unit(code = "", timeUnit = "h", concUnit = "ng/mL", doseUnit = "mg", MW = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Unit_+3A_code">code</code></td>
<td>
<p>vector of PPTESTCD</p>
</td></tr>
<tr><td><code id="Unit_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="Unit_+3A_concunit">concUnit</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="Unit_+3A_doseunit">doseUnit</code></td>
<td>
<p>unit of dose</p>
</td></tr>
<tr><td><code id="Unit_+3A_mw">MW</code></td>
<td>
<p>molecular weight of drug</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>row names</code></td>
<td>
<p>PPTESTCD</p>
</td></tr>
<tr><td><code>Unit</code></td>
<td>
<p>unit</p>
</td></tr>
<tr><td><code>Factor</code></td>
<td>
<p>internal mulitpilcation factor</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>Unit(concUnit="ug/L", doseUnit="mg")
Unit(concUnit="ng/L", doseUnit="mg")

Unit(concUnit="umol/L", doseUnit="mmol")
Unit(concUnit="nmol/L", doseUnit="mmol")

Unit(concUnit="mmol/L", doseUnit="mg", MW=500)
Unit(concUnit="umol/L", doseUnit="mg", MW=500)
Unit(concUnit="nmol/L", doseUnit="mg", MW=500)
Unit(concUnit="nmol/mL", doseUnit="mg", MW=500)

Unit(concUnit="ug/L", doseUnit="mmol", MW=500)
Unit(concUnit="ug/L", doseUnit="mol", MW=500)
Unit(concUnit="ng/L", doseUnit="mmol", MW=500)
Unit(concUnit="ng/mL", doseUnit="mmol", MW=500)

Unit(concUnit="nmol/L", doseUnit="mg")
Unit(concUnit="ug/L", doseUnit="mmol")
</code></pre>

<hr>
<h2 id='UT'>Internal Functions</h2><span id='topic+UT'></span>

<h3>Description</h3>

<p>Internal functions</p>


<h3>Details</h3>

<p>These are not to be called by the user.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
