<!DOCTYPE html><html><head><title>Help for package rNOMADS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rNOMADS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rNOMADS-package'>
<p>An interface to the NOAA Operational Model Archive and Distribution System</p></a></li>
<li><a href='#ArchiveGribGrab'>
<p>Download archived model data from the NOMADS server.</p></a></li>
<li><a href='#BuildProfile'>
<p>Get model data at a specific point.</p></a></li>
<li><a href='#CheckNOMADSArchive'>
<p>Check to see if archived data exists.</p></a></li>
<li><a href='#CrawlModels'>
<p>Get Available Model Runs</p></a></li>
<li><a href='#DODSGrab'>
<p>Download model data from the NOMADS server using the GrADS-DODS system.</p></a></li>
<li><a href='#GetClosestForecasts'>
<p>Get the forecast time closest to a given date for a given model</p></a></li>
<li><a href='#GetDODSDates'>
<p>Find available model run dates for data on the GrADS - DODS system.</p></a></li>
<li><a href='#GetDODSModelRunInfo'>
<p>Get model coverage and data information for models on GrADS-DODS system.</p></a></li>
<li><a href='#GetDODSModelRuns'>
<p>Find available model runs on the GrADS - DODS system.</p></a></li>
<li><a href='#GribGrab'>
<p>Download grib file from the NOMADS server.</p></a></li>
<li><a href='#GribInfo'>
<p>Get grib file inventory.</p></a></li>
<li><a href='#LinkExtractor'>
<p>Extracts links from web pages</p></a></li>
<li><a href='#MagnitudeAzimuth'>
<p>Convert zonal-meridional wind speeds to magnitude/azimuth.</p></a></li>
<li><a href='#ModelGrid'>
<p>Transform model data into an array</p></a></li>
<li><a href='#NOMADSArchiveList'>
<p>Archived models available for download through rNOMADS</p></a></li>
<li><a href='#NOMADSRealTimeList'>
<p>Models available for download through rNOMADS</p></a></li>
<li><a href='#ParseModelPage'>
<p>Extract predictions, levels, and variables</p></a></li>
<li><a href='#PlotWindProfile'>
<p>Plot wind speed and direction</p></a></li>
<li><a href='#ReadGrib'>
<p>Extract data from grib files</p></a></li>
<li><a href='#SanitizeURL'>
<p>Remove illegal URL characters</p></a></li>
<li><a href='#SubsetNOMADS'>
<p>Subset model data output</p></a></li>
<li><a href='#WebCrawler'>
<p>Get web pages</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>An R Interface to the NOAA Operational Model Archive and
Distribution System</td>
</tr>
<tr>
<td>Version:</td>
<td>2.5.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-15</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), rvest (&ge; 0.3.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stringr (&ge; 1.2.0), fields (&ge; 9.0), GEOmap (&ge; 2.3-5), MBA,
httr (&ge; 1.4-4), XML (&ge; 3.99-0.3), uuid (&ge; 0.1-2)</td>
</tr>
<tr>
<td>Description:</td>
<td>An interface to the National Oceanic and Atmospheric Administration's Operational Model Archive and Distribution System (NOMADS, see <a href="https://nomads.ncep.noaa.gov/">https://nomads.ncep.noaa.gov/</a> for more information) that allows R users to quickly and efficiently download global and regional weather model data for processing.  rNOMADS currently supports a variety of models ranging from global weather data to an altitude of over 40 km, to high resolution regional weather models, to wave and sea ice models.  rNOMADS can retrieve binary data in grib format as well as import ascii data directly into R by interfacing with the GrADS-DODS system.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel C. Bowman &lt;danny.c.bowman@gmail.com&gt;</td>
</tr>
<tr>
<td>MailingList:</td>
<td>&lt;rnomads-user@lists.r-forge.r-project.org&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="https://r-forge.r-project.org/projects/rnomads/">https://r-forge.r-project.org/projects/rnomads/</a> &gt;,
&lt;<a href="https://www.r-project.org">https://www.r-project.org</a> &gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-16 04:58:02 UTC; dantayaga</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel C. Bowman [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 05:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rNOMADS-package'>
An interface to the NOAA Operational Model Archive and Distribution System
</h2><span id='topic+rNOMADS-package'></span><span id='topic+rNOMADS'></span>

<h3>Description</h3>

<p>Automatically download forecast data from the National Oceanic and Atmospheric Administration's Operational Model Archive and Distribution System (NOMADS) and read it into R.
This can be done in two ways: reading ascii data directly from the server using the DODS-GrADS system or downloading binary files in GRIB1 or GRIB2 format.
The grib capability of <code>rNOMADS</code> uses an external series of routines called <code>wgrib2</code> to read operational model data; get <code>wgrib2</code> at <a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/</a>.
The package will also attempt to call another external routine called <code>wgrib</code> if the user wishes to read GRIB1 files; get <code>wgrib</code> at <a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html</a>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> rNOMADS</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-03-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL v3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>References</h3>

<p>Bowman, D. C. and Lees, J. M. (2015).
Near real time weather and ocean model data access with rNOMADS.
<em>Computers &amp; Geosciences</em> 78, pp. 88-95.<br /> 
NOMADS website: <br />
<a href="https://nomads.ncep.noaa.gov/">https://nomads.ncep.noaa.gov/</a> <br />
wgrib2 download page:<br />
<a href="https://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/">https://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/</a> <br />
wgrib2 reference: <br />
Ebisuzaki, W, Bokhorst, R., Hyvatti, J., Jovic, D., Nilssen, K,
Pfeiffer, K.,  Romero, P.,  Schwarb, M., da Silva, A., Sondell, N., and Varlamov, S. (2011).
wgrib2: read and write GRIB2 files.  <em>National Weather Service Climate Prediction Center</em>, <br />
<a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/</a><br />
wgrib download page:<br />
<a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html</a><br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Getting temperature for North Carolina, USA, 
#6-12 hours ago depending on when the latest model run was.
#Get values at the ground surface and at the 800 mb level
#Then make a contour plot of the surface temperature.
#We use GrADS-DODS here for compatibility.

#Using the Global Forecast System 0.5x0.5 model
## Not run: 

urls.out &lt;- GetDODSDates(abbrev = "gfs_0p50")
model.url &lt;- tail(urls.out$url, 1) #Get most recent model date

#Get most recent model run

model.runs &lt;- GetDODSModelRuns(model.url)
model.run &lt;- tail(model.runs$model.run, 1)
 

#Get ground temperature for the 6 hour prediction
variable &lt;- "tmp2m" #temp at 2 m
time &lt;- c(2,2) #6 hour prediction
lon.dom &lt;- seq(0, 360, by = 0.5) #domain of longitudes in model
lat.dom &lt;- seq(-90, 90, by = 0.5) #domain of latitudes in model
lon &lt;- which((lon.dom &gt;= 360 - 84) &amp; (lon.dom &lt;= 360 - 74)) - 1 #NOMADS indexes start at 0
lat &lt;- which((lat.dom &lt;= 37) &amp; (lat.dom &gt;= 32)) - 1 #NOMADS indexes start at 0 
model.data.surface &lt;- DODSGrab(model.url, model.run, variable, time, c(min(lon), max(lon)), 
   c(min(lat), max(lat)))

lev &lt;- c(8, 8) #800 mb level
variable &lt;- "tmpprs"
model.data.800mb &lt;- DODSGrab(model.url, model.run, variable, time, c(min(lon), max(lon)),
   c(min(lat), max(lat)), level = lev)

#Make results into arrays
model.array.surface &lt;- ModelGrid(model.data.surface, c(0.5, 0.5))
model.array.800mb &lt;- ModelGrid(model.data.800mb, c(0.5, 0.5))

#Make a contour plot of the temperature around North Carolina, USA:
contour(x = model.array.surface$x - 360, y = model.array.surface$y, 
    model.array.surface$z[1,1,,] - 273.15, xlab = "Longitude", ylab = "Latitude",
   main = paste("North Carolina Surface Temperatures for", 
   model.array.surface$fcst.date, "UTC in Celsius"))

dev.new()
contour(x = model.array.800mb$x - 360, y = model.array.800mb$y,
    model.array.800mb$z[1,1,,] - 273.15, xlab = "Longitude", ylab = "Latitude",
   main = paste("North Carolina Temperatures at 800 mb for",
   model.array.surface$fcst.date, "UTC in Celsius"))

## End(Not run)
</code></pre>

<hr>
<h2 id='ArchiveGribGrab'>
Download archived model data from the NOMADS server.
</h2><span id='topic+ArchiveGribGrab'></span>

<h3>Description</h3>

<p>This function gives access to archived NOMADS model data.
The available models can be viewed by calling <code><a href="#topic+NOMADSArchiveList">NOMADSArchiveList</a></code> without arguments.
The data arrives in grib (gridded binary) format that can be read with <code><a href="#topic+ReadGrib">ReadGrib</a></code>.
Some of these files are in GRIB format, others are in GRIB2 format; select the appropriate file type when calling <code><a href="#topic+ReadGrib">ReadGrib</a></code>.
Note that this is a legacy function that emulates the archive data retrieval capability when NOMADS NCEP used to host past data sets.  
At present the data are hosted on NCEI.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ArchiveGribGrab(abbrev, model.date, model.run, preds,
    local.dir = NULL, file.names = NULL, tidy = FALSE,
    verbose = TRUE, download.method = NULL, file.type = "grib2")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ArchiveGribGrab_+3A_abbrev">abbrev</code></td>
<td>

<p>Model abbreviation per <code><a href="#topic+NOMADSArchiveList">NOMADSArchiveList</a></code>.
</p>
</td></tr>
<tr><td><code id="ArchiveGribGrab_+3A_model.date">model.date</code></td>
<td>

<p>The year, month, and day of the model run, in YYYYMMDD format
</p>
</td></tr>
<tr><td><code id="ArchiveGribGrab_+3A_model.run">model.run</code></td>
<td>

<p>Which hour the model was run (i.e. 00, 06, 12, 18 for GFS)
</p>
</td></tr>
<tr><td><code id="ArchiveGribGrab_+3A_preds">preds</code></td>
<td>

<p>A scalar or vector of prediction to get (analysis is 00)
</p>
</td></tr>
<tr><td><code id="ArchiveGribGrab_+3A_local.dir">local.dir</code></td>
<td>

<p>Where to save the grib file, defaults to the current directory.
</p>
</td></tr>
<tr><td><code id="ArchiveGribGrab_+3A_file.names">file.names</code></td>
<td>

<p>A list of length <code>length(preds)</code> of file names to which the 
downloaded GRIB files are directed to.  
Default <code>NULL</code>, meaning files will be named per their model date and time.
</p>
</td></tr>
<tr><td><code id="ArchiveGribGrab_+3A_tidy">tidy</code></td>
<td>

<p>If <code>TRUE</code>, remove all files with the suffix &quot;.grb&quot; from <code>local.dir</code> prior to downloading a new grib file.
</p>
</td></tr>
<tr><td><code id="ArchiveGribGrab_+3A_verbose">verbose</code></td>
<td>

<p>If <code>TRUE</code>, give information on connection status.  Default <code>TRUE</code>
</p>
</td></tr>
<tr><td><code id="ArchiveGribGrab_+3A_download.method">download.method</code></td>
<td>

<p>Allows the user to set the download method used by <code>download.file</code>: <code>"internal"</code>, <code>"wget"</code> <code>"curl"</code>, <code>"lynx"</code>.
If <code>NULL</code> (the default), let R decide.
</p>
</td></tr>
<tr><td><code id="ArchiveGribGrab_+3A_file.type">file.type</code></td>
<td>

<p>Determine whether to get GRIB1 (<code>"grib1"</code>) or GRIB2 (<code>"grib2"</code>) file formats.
Sometimes both are available, sometimes only one.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>grib.info$file.name</code></td>
<td>
<p>The path and file name of the grib file that was downloaded.</p>
</td></tr>
<tr><td><code>grib.info$url</code></td>
<td>
<p>The URL that the grib file was downloaded from</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>References</h3>

<p><a href="https://www.ncei.noaa.gov/data/">https://www.ncei.noaa.gov/data/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CheckNOMADSArchive">CheckNOMADSArchive</a></code>, <code><a href="#topic+NOMADSArchiveList">NOMADSArchiveList</a></code>, <code><a href="#topic+ReadGrib">ReadGrib</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#An example for the Global Forecast System
#Get data for January 1 2014
#Temperature at 2 m above ground
#3 hour prediction
# using GRIB

abbrev &lt;- "gfsanl"
model.date &lt;- 20140101
model.run &lt;- 06
preds &lt;- 3

## Not run: 
model.info &lt;- ArchiveGribGrab(abbrev, model.date, 
    model.run, preds, file.type = "grib2")
model.data &lt;- ReadGrib(model.info[[1]]$file.name, c("2 m above ground"), c("TMP"))

#Get surface temperature in Chapel Hill, NC
lat &lt;- 35.907605
lon &lt;- -79.052147

profile &lt;- BuildProfile(model.data, lon, lat, TRUE)
print(paste0("The temperature prediction in Chapel Hill was ", 
    sprintf("%.0f", profile[[1]]$profile.data[1,1,1] - 272.15), " degrees Celsius."))

## End(Not run)
</code></pre>

<hr>
<h2 id='BuildProfile'>
Get model data at a specific point.
</h2><span id='topic+BuildProfile'></span>

<h3>Description</h3>

<p>Takes the output of <code><a href="#topic+ReadGrib">ReadGrib</a></code> or <code><a href="#topic+DODSGrab">DODSGrab</a></code> and extracts data at a specific point, performing interpolation if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BuildProfile(model.data, lon, lat, spatial.average, points = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BuildProfile_+3A_model.data">model.data</code></td>
<td>

<p>Data structure returned by <code><a href="#topic+ReadGrib">ReadGrib</a></code> or <code><a href="#topic+DODSGrab">DODSGrab</a></code>.
</p>
</td></tr>
<tr><td><code id="BuildProfile_+3A_lon">lon</code></td>
<td>

<p>Longitudes of points of interest.
</p>
</td></tr>
<tr><td><code id="BuildProfile_+3A_lat">lat</code></td>
<td>

<p>Latitudes of points of interest.
</p>
</td></tr>
<tr><td><code id="BuildProfile_+3A_spatial.average">spatial.average</code></td>
<td>

<p>Whether to interpolate data using b-splines to obtain value at the requested point (<code>spatial.average = TRUE</code>) or use the nearest model node (<code>spatial.average = FALSE</code>).
</p>
</td></tr>
<tr><td><code id="BuildProfile_+3A_points">points</code></td>
<td>

<p>How many points to include in the interpolation, will be ignored if <code>spatial.average = FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is much more efficient to download a large chunk of data and extract profile points from that as opposed to downloading individual small model chunks in the vicinity of each point of interest.
</p>


<h3>Value</h3>

<table>
<tr><td><code>profile</code></td>
<td>
<p>A list with as many elements as profile points, with fields:</p>
</td></tr>
<tr><td><code>profile$profile.data</code></td>
<td>
<p>A levels x variables x time matrix with data at a specific point</p>
</td></tr>
<tr><td><code>profile$location</code></td>
<td>
<p>The location for which the profile is generated</p>
</td></tr>
<tr><td><code>profile$forecast.date</code></td>
<td>
<p>What dates and times the profile contains</p>
</td></tr>
<tr><td><code>profile$variables</code></td>
<td>
<p>The variables the profile contains</p>
</td></tr>
<tr><td><code>profile$levels</code></td>
<td>
<p>The levels the profile contains</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The &ldquo;outside of model domain&rdquo; warning may occur if the profile point is very close to the prime meridian (in the case of a 0-360 longitude definition) or the antipode of the prime meridian (+/- 180 degrees longitude in the case of -180 to 180 degrees definition).
For a full download of a global model (e. g. the GFS), this does not mean the point is actually outside of the model domain.
For example, the 0.5 degree GFS has nodes from 0 to 359.5 degrees longitude; a profile point requested at 359.9 degrees longitude will cause this warning even though it is within the global GFS model domain.
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ReadGrib">ReadGrib</a></code>, <code><a href="#topic+DODSGrab">DODSGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Get temperature profile in Chapel Hill, NC.

#First, define each location
lon &lt;- -79.052094
lat &lt;- 35.907562

#Get second to latest GFS 0.5 model, use analysis forecast
#(this ensures the data's fully up on NOMADS)

## Not run: 
model.url &lt;- CrawlModels(abbrev = "gfs_0p50", depth = 2)[2]
pred &lt;- ParseModelPage(model.url)$pred[1]

## End(Not run)

#Get levels
pressure &lt;- c(1, 2, 3, 5, 7,
10, 20, 30, 50, 70,
seq(100, 1000, by = 25))
levels &lt;- paste(pressure, " mb", sep = "")

#Variables - temperature and height only
variables &lt;- c("TMP", "HGT")

## Not run: 
grib.info &lt;- GribGrab(model.url, pred, levels, variables,
   model.domain = c(-85, -75, 37, 32))
grib.data &lt;- ReadGrib(grib.info[[1]]$file.name, levels, variables)

profile &lt;- BuildProfile(grib.data, lon, lat, TRUE, points = 8)
plot(profile[[1]]$profile.data[,2, 1] - 272.15, 
   profile[[1]]$profile.data[,1, 1], xlab = "Temperature (C)",
   ylab = "Height (m)", main = "Temperature Profile above Chapel Hill, NC")

## End(Not run)
</code></pre>

<hr>
<h2 id='CheckNOMADSArchive'>
Check to see if archived data exists.
</h2><span id='topic+CheckNOMADSArchive'></span>

<h3>Description</h3>

<p>This function checks to see if data exists for a given date and model.
It checks for both GRIB1 or GRIB2 files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CheckNOMADSArchive(abbrev, model.date = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CheckNOMADSArchive_+3A_abbrev">abbrev</code></td>
<td>

<p>Model abbreviation per <code><a href="#topic+NOMADSArchiveList">NOMADSArchiveList</a></code>.
</p>
</td></tr>
<tr><td><code id="CheckNOMADSArchive_+3A_model.date">model.date</code></td>
<td>

<p>The year, month, and day to check for data, in YYYYMMDD format.
If <code>NULL</code>, check all available dates in NOMADS archive.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>available.models$date</code></td>
<td>
<p>What date the file is for, in YYYYMMDD format.</p>
</td></tr>
<tr><td><code>available.models$model.run</code></td>
<td>
<p>At what hour (GMT) the model was run.</p>
</td></tr>
<tr><td><code>available.models$pred</code></td>
<td>
<p>What predictions are available</p>
</td></tr>
<tr><td><code>available.models$file.name</code></td>
<td>
<p>List of file names for available model dates, runs, and predictions</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>References</h3>

<p><a href="https://www.ncei.noaa.gov/data/">https://www.ncei.noaa.gov/data/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NOMADSArchiveList">NOMADSArchiveList</a></code>, <code><a href="#topic+ArchiveGribGrab">ArchiveGribGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See what is available 365 days before today

abbrev &lt;- "gfsanl"
model.date &lt;- paste0(format(Sys.time() - 24 * 60 * 60 * 365, "%Y%m%d"))
## Not run: 
gfs.available.models &lt;- CheckNOMADSArchive(abbrev, model.date)

## End(Not run)
</code></pre>

<hr>
<h2 id='CrawlModels'>
Get Available Model Runs
</h2><span id='topic+CrawlModels'></span>

<h3>Description</h3>

<p>This function determine which instances of a given model are available for download.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CrawlModels(abbrev = NULL, model.url = NULL, depth = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CrawlModels_+3A_abbrev">abbrev</code></td>
<td>

<p>The model abbreviation, see <code><a href="#topic+NOMADSRealTimeList">NOMADSRealTimeList</a></code>.
Defaults to <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="CrawlModels_+3A_model.url">model.url</code></td>
<td>

<p>A URL to use instead of using the abbreviations in <code><a href="#topic+NOMADSRealTimeList">NOMADSRealTimeList</a></code>.
Defaults to <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="CrawlModels_+3A_depth">depth</code></td>
<td>

<p>How many model instances to return.
This avoids having to download the entire model list (sometimes several hundred) if only the first few instances are required.
Defaults to <code>NULL</code>, which returns everything.
</p>
</td></tr>
<tr><td><code id="CrawlModels_+3A_verbose">verbose</code></td>
<td>

<p>Print out each link as it is discovered.
Defaults to <code>TRUE</code>.
</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>This function calls <code><a href="#topic+WebCrawler">WebCrawler</a></code>, a recursive algorithm that discovers each link available in the URL provided.
It then searches each link in turn, and follows those links until it reaches a dead end.
At that point, it returns the URL.
For the model pages on the NOMADS web site, each dead end is a model instance that can be examined using <code><a href="#topic+ParseModelPage">ParseModelPage</a></code> or have data retrieved from it using <code><a href="#topic+GribGrab">GribGrab</a></code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>urls.out</code></td>
<td>
<p>A list of web page addresses, each of which corresponds to a model instance.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>It is a good idea to set <code>depth</code> to a small number rather than leave it at the default value.
Some models (such as the Global Forecast System) have a large number of instances, and crawling each one can take a lot of time.
I recommend <code>depth = 2</code>, since the first URL may not have an active model on it yet if the model is still being uploaded to the server.
In that case,the first URL will contain no data, and the second URL can be used instead.
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WebCrawler">WebCrawler</a></code>, <code><a href="#topic+ParseModelPage">ParseModelPage</a></code>, <code><a href="#topic+NOMADSRealTimeList">NOMADSRealTimeList</a></code>, <code><a href="#topic+GribGrab">GribGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Get the latest 5 instances
#for the Global Forecast System 0.5 degree model

## Not run: urls.out &lt;- CrawlModels(abbrev = "gfs_0p50", depth = 5)

</code></pre>

<hr>
<h2 id='DODSGrab'>
Download model data from the NOMADS server using the GrADS-DODS system.
</h2><span id='topic+DODSGrab'></span>

<h3>Description</h3>

<p>This function interfaces with the NOMADS server to download weather, ocean, and sea ice data.
The available models can be viewed by calling <code><a href="#topic+NOMADSRealTimeList">NOMADSRealTimeList</a></code> and <code><a href="#topic+NOMADSArchiveList">NOMADSArchiveList</a></code>.
The data arrives in ascii format, so this function can be used to retrieve data on any operating system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DODSGrab(model.url, model.run, variables, time, lon, lat,
    levels = NULL, ensembles = NULL, display.url = TRUE, 
    verbose = FALSE, request.sleep = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DODSGrab_+3A_model.url">model.url</code></td>
<td>

<p>A model URL for a specific date, probably from <code><a href="#topic+GetDODSDates">GetDODSDates</a></code>.
</p>
</td></tr>
<tr><td><code id="DODSGrab_+3A_model.run">model.run</code></td>
<td>

<p>A specific model run to get, probably from <code><a href="#topic+GetDODSModelRuns">GetDODSModelRuns</a></code>.
</p>
</td></tr>
<tr><td><code id="DODSGrab_+3A_variables">variables</code></td>
<td>

<p>A list of the data types to get.
</p>
</td></tr>
<tr><td><code id="DODSGrab_+3A_time">time</code></td>
<td>

<p>A two component vector denoting which time indices to get.
</p>
</td></tr>
<tr><td><code id="DODSGrab_+3A_lon">lon</code></td>
<td>

<p>A two component vector denoting which longitude indices to get.
</p>
</td></tr>
<tr><td><code id="DODSGrab_+3A_lat">lat</code></td>
<td>

<p>A two component vector denoting which latitude indices to get.
</p>
</td></tr>
<tr><td><code id="DODSGrab_+3A_levels">levels</code></td>
<td>

<p>A two component vector denoting which levels to get, if applicable.
</p>
</td></tr>
<tr><td><code id="DODSGrab_+3A_ensembles">ensembles</code></td>
<td>

<p>A two component vector denoting which ensemble runs to get, if applicable.
</p>
</td></tr>
<tr><td><code id="DODSGrab_+3A_display.url">display.url</code></td>
<td>

<p>If <code>TRUE</code>, print out the URL for the data request.
</p>
</td></tr> 
<tr><td><code id="DODSGrab_+3A_verbose">verbose</code></td>
<td>

<p>If <code>TRUE</code>, give a very detailed description of the download.  Default <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="DODSGrab_+3A_request.sleep">request.sleep</code></td>
<td>

<p>If multiple requests are to be sent to the server, pause by this many seconds between them.
This is courteous and also helps prevent timeouts.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>model.data</code></td>
<td>
<p>A structure with a series of elements containing data extracted from GrADS-DODS system.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>References</h3>

<p><a href="https://nomads.ncep.noaa.gov/">https://nomads.ncep.noaa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GetDODSDates">GetDODSDates</a></code>, <code><a href="#topic+GetDODSModelRuns">GetDODSModelRuns</a></code>, <code><a href="#topic+GetDODSModelRunInfo">GetDODSModelRunInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#An example for the Global Forecast System 0.5 degree model
#Make a world temperature map for the latest model run

## Not run: 
#Figure out which model is most recent
model.urls &lt;- GetDODSDates("gfs_0p50")
latest.model &lt;- tail(model.urls$url, 1)
model.runs &lt;- GetDODSModelRuns(latest.model)
latest.model.run &lt;- tail(model.runs$model.run, 1)

#Download worldwide temperature data at 2 m
variable &lt;- "tmp2m"
time &lt;- c(0, 0) #Analysis run, index starts at 0
lon &lt;- c(0, 719) #All 720 longitude points
lat &lt;- c(0, 360) #All 361 latitude points
model.data &lt;- DODSGrab(latest.model, latest.model.run,
   variable, time, lon, lat)

#Make it into a nice array and plot it
model.grid &lt;- ModelGrid(model.data, c(0.5, 0.5))
image(model.grid$z[1,1,,])

## End(Not run)
</code></pre>

<hr>
<h2 id='GetClosestForecasts'>
Get the forecast time closest to a given date for a given model
</h2><span id='topic+GetClosestForecasts'></span>

<h3>Description</h3>

<p>This function returns which forecast precedes the date and which forecast follows the date for a given model product.
Thus a user can average the two forecasts together to provide a precise forecast for a given date.
It is optimized for grib file retrieval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetClosestForecasts(abbrev, forecast.date, model.date = "latest",
   depth = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetClosestForecasts_+3A_abbrev">abbrev</code></td>
<td>

<p>The requested model product
</p>
</td></tr>
<tr><td><code id="GetClosestForecasts_+3A_forecast.date">forecast.date</code></td>
<td>

<p>What date you want a forecast for, as a date/time object.
It must be in the UTC time zone.
</p>
</td></tr>
<tr><td><code id="GetClosestForecasts_+3A_model.date">model.date</code></td>
<td>

<p>Which model run to use, in YYYYMMDDHH, where HH is 00, 06, 12, 18. 
Defaults to <code>"latest"</code>, which gets the most recent model uploaded to the server.
</p>
</td></tr>
<tr><td><code id="GetClosestForecasts_+3A_depth">depth</code></td>
<td>

<p>How many model instances to return.
This avoids having to download the entire model list (sometimes several hundred) if only the first few instances are required.
Defaults to <code>NULL</code>, which returns everything.
This input only makes sense when <code>model.date != "latest"</code>.
</p>
</td></tr>
<tr><td><code id="GetClosestForecasts_+3A_verbose">verbose</code></td>
<td>

<p>Gives a detailed account of progress.
Defaults to <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>forecasts$model.url</code></td>
<td>
<p>URL to send to <code>GribGrab</code> for downloading data.</p>
</td></tr>
<tr><td><code>forecasts$model.run.date</code></td>
<td>
<p>When the model was run.</p>
</td></tr>
<tr><td><code>forecasts$back.forecast</code></td>
<td>
<p>Nearest forecast behind requested date.</p>
</td></tr>
<tr><td><code>forecasts$fore.forecast</code></td>
<td>
<p>Nearest forecast after requested date.</p>
</td></tr>
<tr><td><code>forecasts$back.hr</code></td>
<td>
<p>How many hours the back forecast is behind the requested date.</p>
</td></tr>
<tr><td><code>forecasts$fore.hr</code></td>
<td>
<p>How many hours the fore forecast is in front of the requested date.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BuildProfile">BuildProfile</a></code>, <code><a href="#topic+GribGrab">GribGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Get the exact temperature profile of Chapel Hill, NC
#by performing a weighted average of GFS model forecasts.

#Figure out which forecasts to use
forecast.date &lt;- as.POSIXlt(Sys.time(), tz = "UTC")
abbrev &lt;- "gfs_0p50"

## Not run: 
forecasts &lt;- GetClosestForecasts(abbrev = abbrev, forecast.date)

## End(Not run)

#Get levels
pressure &lt;- c(1, 2, 3, 5, 7,
10, 20, 30, 50, 70,
seq(100, 1000, by = 25))
levels &lt;- paste(pressure, " mb", sep = "")

#Variables - temperature and height only
variables &lt;- c("TMP", "HGT")

#Location
lon &lt;- c(-79.052083)
lat &lt;- c(35.907492)
model.domain &lt;- c(lon - 1, lon + 1, lat + 1, lat - 1)

## Not run: 
#Get the data for each
grb.info &lt;- GribGrab(forecasts$model.url, 
   c(forecasts$fore.forecast, forecasts$back.forecast), levels, variables, 
   model.domain = model.domain)

fore.data &lt;- ReadGrib(grb.info[[1]]$file.name, levels, variables) 
back.data &lt;- ReadGrib(grb.info[[2]]$file.name, levels, variables)

back.profile &lt;- BuildProfile(back.data, lon, lat,
   spatial.average = TRUE, points = 8)

fore.profile &lt;- BuildProfile(fore.data, lon, lat,
   spatial.average = TRUE, points = 8)

temps &lt;- cbind(back.profile[[1]]$profile.data[, which(back.profile[[1]]$variables == "TMP"),],
    fore.profile[[1]]$profile.data[, which(fore.profile[[1]]$variables == "TMP"),])
 
heights &lt;-  cbind(back.profile[[1]]$profile.data[, which(back.profile[[1]]$variables == "HGT"),],
    fore.profile[[1]]$profile.data[, which(fore.profile[[1]]$variables == "HGT"),])


time.gap &lt;- forecasts$fore.hr - forecasts$back.hr
exact.temp &lt;- (temps[,1] * abs(forecasts$fore.hr) + temps[,2] * abs(forecasts$back.hr))/time.gap
exact.hgt &lt;- (heights[,1] * abs(forecasts$fore.hr) + heights[,2] * abs(forecasts$back.hr))/time.gap

#Plot results
plot(c(min(temps), max(temps)), c(min(heights), max(heights)), type = "n",
    xlab = "Temperature (C)", ylab = "Height (m)")
points(temps[,1], heights[,1], pch = 1, col = 1)
points(temps[,2], heights[,2], pch = 2, col = 2)
points(exact.temp, exact.hgt, col = 3, lty = 2, pch = 3)
legend("topleft", pch = c(1, 2, 3), col = c(1, 2, 3),
   legend = c(forecasts$back.forecast, forecasts$fore.forecast, as.character(Sys.time())))

## End(Not run)
</code></pre>

<hr>
<h2 id='GetDODSDates'>
Find available model run dates for data on the GrADS - DODS system.
</h2><span id='topic+GetDODSDates'></span>

<h3>Description</h3>

<p>This function checks the GrADS data server to see what dates and model subsets are available for model specified by ABBREV
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetDODSDates(abbrev, request.sleep=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetDODSDates_+3A_abbrev">abbrev</code></td>
<td>

<p>A model abbreviation as specified in <code><a href="#topic+NOMADSRealTimeList">NOMADSRealTimeList</a></code> or <code><a href="#topic+NOMADSArchiveList">NOMADSArchiveList</a></code>.
</p>
</td></tr>
<tr><td><code id="GetDODSDates_+3A_request.sleep">request.sleep</code></td>
<td>

<p>Seconds to pause between HTTP requests when scanning model pages - this prevents timeouts. Default <code>1</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function determines which dates are available for download for a particular model through the GrADS - DODS system.
Once the user determines which dates are available, the output of this function can be passed to <code><a href="#topic+GetDODSModelRuns">GetDODSModelRuns</a></code> to determine which model runs can be downloaded.
</p>


<h3>Value</h3>

<table>
<tr><td><code>model</code></td>
<td>
<p>The model that was requested.</p>
</td></tr>
<tr><td><code>date</code></td>
<td>
<p>A list of model run dates available for download.</p>
</td></tr>
<tr><td><code>url</code></td>
<td>
<p>A list of URLs corresponding to the model run dates.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Sometimes, sending lots of HTTP requests in rapid succession can cause errors.
If messages resembling <code>"Error: failed to load HTTP resource"</code> appear, try increasing <code>request.sleep</code>.
The code will take longer to execute but it will be more likely to finish successfully.
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GetDODSModelRuns">GetDODSModelRuns</a></code>, <code><a href="#topic+DODSGrab">DODSGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#An example for the Global Forecast System 0.5 degree model

#Get the latest model url and date
abbrev &lt;- "gfs_0p50"
## Not run: 
urls.out &lt;- GetDODSDates(abbrev)
print(paste("Most recent model run:",tail(urls.out$date, 1)))

## End(Not run)

</code></pre>

<hr>
<h2 id='GetDODSModelRunInfo'>
Get model coverage and data information for models on GrADS-DODS system.
</h2><span id='topic+GetDODSModelRunInfo'></span>

<h3>Description</h3>

<p>Given a URL from <code><a href="#topic+GetDODSDates">GetDODSDates</a></code> and a model run from <code><a href="#topic+GetDODSModelRuns">GetDODSModelRuns</a></code>, get information on the model domain, levels, and variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetDODSModelRunInfo(model.url, model.run, download.file=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetDODSModelRunInfo_+3A_model.url">model.url</code></td>
<td>

<p>A URL for a model on the GrADS - DODS system, probably returned by <code><a href="#topic+GetDODSDates">GetDODSDates</a></code>.
</p>
</td></tr>
<tr><td><code id="GetDODSModelRunInfo_+3A_model.run">model.run</code></td>
<td>

<p>A specific model run, probably returned by <code><a href="#topic+GetDODSModelRuns">GetDODSModelRuns</a></code>
</p>
</td></tr>
<tr><td><code id="GetDODSModelRunInfo_+3A_download.file">download.file</code></td>
<td>

<p>If <code>TRUE</code>, download the DODS <code>.info</code> file and read it in.
If <code>FALSE</code>, try and read the <code>.info</code> file directly from the Internet.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This routine grabs information about the latitude, longitude, and time coverage of a specific model instance.
It also finds data about levels (if present) and lists all the available variables (though they may not have data in them).
The user can refer to this information to construct calls to the DODS system via <code><a href="#topic+DODSGrab">DODSGrab</a></code>.
Note that the <code>XML</code> package has trouble interpreting https from time to time; this can be circumvented by keeping <code>download.file=TRUE</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>model.info</code></td>
<td>
<p>Information provided by the GrADS - DODS system about the given model instance.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is very helpful in figuring out what's inside poorly documented models.
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GetDODSDates">GetDODSDates</a></code>, <code><a href="#topic+GetDODSModelRuns">GetDODSModelRuns</a></code>, <code><a href="#topic+DODSGrab">DODSGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#An example for the Global Forecast System 0.5 degree model

#Get some information about the latest model url and date, real time server
abbrev &lt;- "gfs_0p50"
## Not run: 
urls.out &lt;- GetDODSDates(abbrev)
model.url &lt;- tail(urls.out$url, 1)
model.runs &lt;- GetDODSModelRuns(model.url)
model.info &lt;- GetDODSModelRunInfo(model.url, tail(model.runs$model.run, 1))
print(model.info)

## End(Not run)
</code></pre>

<hr>
<h2 id='GetDODSModelRuns'>
Find available model runs on the GrADS - DODS system.
</h2><span id='topic+GetDODSModelRuns'></span>

<h3>Description</h3>

<p>Given a URL from <code><a href="#topic+GetDODSDates">GetDODSDates</a></code>, find which model runs are available for download on the GrADS - DODS system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetDODSModelRuns(model.url)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetDODSModelRuns_+3A_model.url">model.url</code></td>
<td>

<p>A URL for a model on the GrADS - DODS system, probably returned by <code><a href="#topic+GetDODSDates">GetDODSDates</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function determines which dates are available for download for a particular model through the GrADS - DODS system.
Once the user determines which dates are available, the output of this function can be passed to <code><a href="#topic+GetDODSModelRuns">GetDODSModelRuns</a></code> to determine which model runs can be downloaded.
</p>


<h3>Value</h3>

<table>
<tr><td><code>model.run</code></td>
<td>
<p>A list of model runs available for the requested date.</p>
</td></tr>
<tr><td><code>model.run.info</code></td>
<td>
<p>Information provided by the GrADS - DODS system about each model run.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>To get model run information for archived analysis models, pass URLs directly from <code><a href="#topic+NOMADSArchiveList">NOMADSArchiveList</a></code> directly to <code>GetDODSModelRuns</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GetDODSDates">GetDODSDates</a></code>, <code><a href="#topic+DODSGrab">DODSGrab</a></code>, <code><a href="#topic+GetDODSModelRunInfo">GetDODSModelRunInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#An example for the Global Forecast System 0.5 degree model

#Get the latest model url and date, real time server
abbrev &lt;- "gfs_0p50"
## Not run: 
urls.out &lt;- GetDODSDates(abbrev)
model.url &lt;- tail(urls.out$url, 1)
model.runs &lt;- GetDODSModelRuns(model.url)
print(paste("Latest model run", tail(model.runs$model.run.info, 1)))

## End(Not run)
</code></pre>

<hr>
<h2 id='GribGrab'>
Download grib file from the NOMADS server.
</h2><span id='topic+GribGrab'></span>

<h3>Description</h3>

<p>This function interfaces with the programming API at <a href="https://nomads.ncep.noaa.gov/">https://nomads.ncep.noaa.gov/</a> to download NOMADS model data.
The available models can be viewed by calling <code><a href="#topic+NOMADSRealTimeList">NOMADSRealTimeList</a></code>.
The data arrives in grib (gridded binary) format that can be read with <code><a href="#topic+ReadGrib">ReadGrib</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GribGrab(model.url, preds, levels, variables, 
    local.dir = NULL, file.names = NULL,
    model.domain = NULL, tidy = FALSE, verbose = TRUE,
    check.url = TRUE, download.method = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GribGrab_+3A_model.url">model.url</code></td>
<td>

<p>The address of a model download page, probably from <code><a href="#topic+CrawlModels">CrawlModels</a></code>.
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_preds">preds</code></td>
<td>

<p>A vector of predictions (or model times) determined by the specific model from <code>model.url</code>
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_levels">levels</code></td>
<td>

<p>A list of model levels to download.
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_variables">variables</code></td>
<td>

<p>A list of model variables to download.
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_local.dir">local.dir</code></td>
<td>

<p>Where to save the grib file, defaults to the current directory.
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_file.names">file.names</code></td>
<td>

<p>What to name the grib file, defaults to <code>"fcst.grb"</code>.
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_model.domain">model.domain</code></td>
<td>

<p>A vector of latitudes and longitudes that specify the area to return a forecast for.
This is a rectangle with elements: west longitude, east longitude, north latitude, south latitude.
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_tidy">tidy</code></td>
<td>

<p>If <code>TRUE</code>, remove all files with the suffix &quot;.grb&quot; from <code>local.dir</code> prior to downloading a new grib file.
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_verbose">verbose</code></td>
<td>

<p>If <code>TRUE</code>, give information on connection status.  Default <code>TRUE</code>
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_check.url">check.url</code></td>
<td>

<p>If <code>TRUE</code>, verify that the model URL is real and contains data.  Default <code>TRUE</code>
</p>
</td></tr>
<tr><td><code id="GribGrab_+3A_download.method">download.method</code></td>
<td>

<p>Allows the user to set the download method used by <code>download.file</code>: <code>"internal"</code>, <code>"wget"</code> <code>"curl"</code>, <code>"lynx"</code>.
If <code>NULL</code> (the default), let R decide.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>grib.info$file.name</code></td>
<td>
<p>The path and file name of the grib file that was downloaded.</p>
</td></tr>
<tr><td><code>grib.info$url</code></td>
<td>
<p>The URL that the grib file was downloaded from</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This requires the external programs <code>wgrib2</code> and\or <code>wgrib</code> to be installed (depending on whether the files are in GRIB2 or GRIB format).</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>References</h3>

<p><a href="https://nomads.ncep.noaa.gov/">https://nomads.ncep.noaa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CrawlModels">CrawlModels</a></code>, <code><a href="#topic+ParseModelPage">ParseModelPage</a></code>, <code><a href="#topic+ReadGrib">ReadGrib</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#An example for the Global Forecast System 0.5 degree model

#Get the latest model url
## Not run: 
urls.out &lt;- CrawlModels(abbrev = "gfs_0p50", depth = 1)

#Get a list of forecasts, variables and levels
model.parameters &lt;- ParseModelPage(urls.out[1])

#Figure out which one is the 6 hour forecast
#provided by the latest model run
#(will be the forecast from 6-12 hours from the current date) 

my.pred &lt;- model.parameters$pred[grep("06$", model.parameters$pred)]

#What region of the atmosphere to get data for
levels &lt;- c("2 m above ground", "800 mb") 

#What data to return
variables &lt;- c("TMP", "RH") #Temperature and relative humidity

#Get the data
grib.info &lt;- GribGrab(urls.out[1], my.pred, levels, variables)

#Extract the data
model.data &lt;- ReadGrib(grib.info[[1]]$file.name, levels, variables)

#Reformat it
model.grid &lt;- ModelGrid(model.data, c(0.5, 0.5))

#Show an image of world temperature at ground level
image(model.grid$z[2, 1,,])

## End(Not run)
</code></pre>

<hr>
<h2 id='GribInfo'>
Get grib file inventory.
</h2><span id='topic+GribInfo'></span>

<h3>Description</h3>

<p>Find out what model, date, levels, and variables are contained in a grib file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GribInfo(grib.file, file.type = "grib2")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GribInfo_+3A_grib.file">grib.file</code></td>
<td>

<p>Full path to a grib file.
</p>
</td></tr>
<tr><td><code id="GribInfo_+3A_file.type">file.type</code></td>
<td>

<p>Whether the file is in grib2 format (<code>"grib2"</code>) or grib format (<code>"grib"</code>).  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows you to find out what is inside an unknown grib file.
It does this by performing a system call to <code>wgrib2</code> or <code>wgrib</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>grib.info</code></td>
<td>
<p>Inventory of the grib file.
If the input is in grib2 format, you also get the grid definition.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>In order to use this function, you need to have installed <code>wgrib2</code> (for grib2 files) or <code>wgrib</code> (for grib files).
You can find these here: <a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/</a> and <a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html</a>.
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ReadGrib">ReadGrib</a></code>, <code><a href="#topic+GetDODSModelRunInfo">GetDODSModelRunInfo</a></code>, <code><a href="#topic+GribGrab">GribGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
#An example for the Global Forecast System 0.5 degree model

#Get the second latest model url, for stability
urls.out &lt;- CrawlModels(abbrev = "gfs_0p50", depth = 2)

#Get a list of forecasts, variables and levels
model.parameters &lt;- ParseModelPage(urls.out[2])

#Figure out which one is the 6 hour forecast
#provided by the latest model run
#(will be the forecast from 6-12 hours from the current date) 

my.pred &lt;- model.parameters$pred[grep("06$", model.parameters$pred)]

#What region of the atmosphere to get data for
levels &lt;- c("2 m above ground", "800 mb")

#What data to return
variables &lt;- c("TMP", "RH") #Temperature and relative humidity

#Get the data
grib.info &lt;- GribGrab(urls.out[2], my.pred, levels, variables)

#Print out the inventory - it should match the requested data
grib.inv &lt;- GribInfo(grib.info[[1]]$file.name, "grib2")

## End(Not run)
</code></pre>

<hr>
<h2 id='LinkExtractor'>
Extracts links from web pages
</h2><span id='topic+LinkExtractor'></span>

<h3>Description</h3>

<p>Parse a web page, capturing and returning any links found.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LinkExtractor(url)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LinkExtractor_+3A_url">url</code></td>
<td>

<p>A URL to scan for links.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal routine used by several functions in the package.
</p>


<h3>Value</h3>

<table>
<tr><td><code>links</code></td>
<td>
<p>A vector of link URLs</p>
</td></tr>
</table>


<h3>Note</h3>

<p>While it might be fun to try <code>LinkExtractor</code> on a large website such as Google, the results will be unpredictable and perhaps disastrous if <code>depth</code> is not set.
This is because there is no protection against infinite recursion. 
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WebCrawler">WebCrawler</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Find model runs for the 
#GFS 0.5x0.5 model

## Not run: 
urls.out &lt;- LinkExtractor(
"http://nomads.ncep.noaa.gov/cgi-bin/filter_gfs_0p50.pl")

## End(Not run)

</code></pre>

<hr>
<h2 id='MagnitudeAzimuth'>
Convert zonal-meridional wind speeds to magnitude/azimuth.
</h2><span id='topic+MagnitudeAzimuth'></span>

<h3>Description</h3>

<p>Given zonal (East-West) and meridional (North-South) wind speeds, calculate magnitude of wind vector and azimuth from north, in degrees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MagnitudeAzimuth(zonal.wind, meridional.wind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MagnitudeAzimuth_+3A_zonal.wind">zonal.wind</code></td>
<td>

<p>A vector of zonal (East-West) winds, west negative.
</p>
</td></tr>
<tr><td><code id="MagnitudeAzimuth_+3A_meridional.wind">meridional.wind</code></td>
<td>

<p>A vector of meridional (North-South) winds, south negative.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>winds$magnitude</code></td>
<td>
<p>Magnitude of wind vector.</p>
</td></tr>
<tr><td><code>winds$azimuth</code></td>
<td>
<p>Azimuth of wind vector in degrees from North</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
zonal.wind &lt;- c(35.5, -2)
meridional.wind &lt;- c(-5, 15)
winds &lt;- MagnitudeAzimuth(zonal.wind, meridional.wind)
print(winds$magnitude)
print(winds$azimuth)
</code></pre>

<hr>
<h2 id='ModelGrid'>
Transform model data into an array
</h2><span id='topic+ModelGrid'></span>

<h3>Description</h3>

<p>This function takes output from <code><a href="#topic+ReadGrib">ReadGrib</a></code> or <code><a href="#topic+DODSGrab">DODSGrab</a></code> and produces an array with dimensions: levels x variables x longitudes x latitudes.
This greatly reduces the size of the data set as well as makes it easier to manipulate.
The data must be in a regular latitude/longitude grid (like the GFS model, for example).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModelGrid(model.data, resolution, 
    levels = NULL, variables = NULL, 
    model.domain = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModelGrid_+3A_model.data">model.data</code></td>
<td>

<p>Output from <code><a href="#topic+ReadGrib">ReadGrib</a></code>.
</p>
</td></tr>
<tr><td><code id="ModelGrid_+3A_resolution">resolution</code></td>
<td>

<p>Resolution of grid, in degrees if <code>grid.type = "latlon"</code>, in kilometers if <code>grid.type = "cartesian"</code>, as a 2 element vector <code>c(East-West, North-South)</code>.
</p>
</td></tr>
<tr><td><code id="ModelGrid_+3A_levels">levels</code></td>
<td>

<p>The model levels to include in the grid, if NULL, include all of them.
</p>
</td></tr>
<tr><td><code id="ModelGrid_+3A_variables">variables</code></td>
<td>

<p>The model variables to include in grid, if NULL, include all of them.
</p>
</td></tr>
<tr><td><code id="ModelGrid_+3A_model.domain">model.domain</code></td>
<td>

<p>A vector c(LEFT LON, RIGHT LON, TOP LAT, BOTTOM LAT) of the region to include in output. 
If NULL, include everything.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you set the spacing of lon.grid and/or lat.grid coarser than the downloaded model grid, you can reduce the resolution of your model, possibly making it easier to handle.
</p>


<h3>Value</h3>

<table>
<tr><td><code>z</code></td>
<td>
<p>An array of dimensions levels x variables x lon x lat; each level x variable contains the model grid of data from that variable and level</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Vector of longitudes</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Vector of latitudes</p>
</td></tr>
<tr><td><code>variables</code></td>
<td>
<p>The variables contained in the grid</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>The levels contained in the grid</p>
</td></tr>
<tr><td><code>model.run.date</code></td>
<td>
<p>When the forecast model was run</p>
</td></tr>
<tr><td><code>fcst.date</code></td>
<td>
<p>The date of the forecast</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Only use this function when the model grid is regular.
For example, the GFS high resolution model is 0.5 x 0.5 degree across its domain.
I have provided this function as a convenience since I only use it for manipulating GFS model data.
I am not sure how well it works for other models. 
Consider yourself warned!
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ReadGrib">ReadGrib</a></code>, <code><a href="#topic+DODSGrab">DODSGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Get some example data 
urls.out &lt;- CrawlModels(abbrev = "gfs_0p50", depth = 1)
model.parameters &lt;- ParseModelPage(urls.out[1])
levels &lt;- c("2 m above ground", "100 mb")
variables &lt;- c("TMP", "RH") #Temperature and relative humidity
grib.info &lt;- GribGrab(urls.out[1], model.parameters$pred[1], levels, variables)
#Extract the data
model.data &lt;- ReadGrib(grib.info[[1]]$file.name, levels, variables)

#Make it into an array
gfs.array &lt;- ModelGrid(model.data, c(0.5, 0.5))

#What variables and levels we have
print(gfs.array$levels)
print(gfs.array$variables)

#Find minimum temperature at the ground surface, and where it is
min.temp &lt;- min(gfs.array$z[2, 1,,] - 273.15)
sprintf("%.1f", min.temp) #in Celsius 

ti &lt;- which(gfs.array$z[2, 1,,] == min.temp + 273.15, arr.ind = TRUE)

lat &lt;- gfs.array$y[ti[1,2]] #Lat of minimum temp
lon &lt;- gfs.array$x[ti[1,1]] #Lon of minimum temp

#Find maximum temperature at 100 mb atmospheric pressure
max.temp &lt;- max(gfs.array$z[1, 1,,]) - 273.15
sprintf("%.1f", max.temp) #Brrr!

## End(Not run)
</code></pre>

<hr>
<h2 id='NOMADSArchiveList'>
Archived models available for download through rNOMADS
</h2><span id='topic+NOMADSArchiveList'></span>

<h3>Description</h3>

<p>A list of abbreviations, names and URLs for the NOMADS models archived on the NCDC web site..
Users can refer to this list to find out more information about the available models, and rNOMADS uses the abbreviations to determine how to access the archives.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NOMADSArchiveList(abbrev = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NOMADSArchiveList_+3A_abbrev">abbrev</code></td>
<td>

<p>Return information about the model that this abbreviation refers to.
Defaults to <code>NULL</code>, in which case information about all the models available through <code>rNOMADS</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>abbrevs</code></td>
<td>
<p>An abbreviation for each model</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>A full name for each model</p>
</td></tr>
<tr><td><code>urls</code></td>
<td>
<p>The web address of the download page for each model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NOMADSRealTimeList">NOMADSRealTimeList</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#The archived model list in rNOMADS

archived.model.list &lt;- NOMADSArchiveList()

</code></pre>

<hr>
<h2 id='NOMADSRealTimeList'>
Models available for download through rNOMADS
</h2><span id='topic+NOMADSRealTimeList'></span>

<h3>Description</h3>

<p>Scans the NOMADS Real Time web site to generate a list of available model products.
Users can refer to this list to find out more information about the available models, and rNOMADS uses the abbreviations to determine which URLs to scan and download.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NOMADSRealTimeList(url.type, abbrev = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NOMADSRealTimeList_+3A_url.type">url.type</code></td>
<td>

<p>Determine whether to return a URL for extracting GRIB files (<code>"grib"</code>) or for getting ascii format data directly from the server (<code>"dods"</code>).</p>
</td></tr>
<tr><td><code id="NOMADSRealTimeList_+3A_abbrev">abbrev</code></td>
<td>

<p>Return information about the model that this abbreviation refers to.
Defaults to <code>NULL</code>, in which case information about all the models available through <code>rNOMADS</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>abbrevs</code></td>
<td>
<p>An abbreviation for each model</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>A full name for each model</p>
</td></tr>
<tr><td><code>urls</code></td>
<td>
<p>The web address of the download page for each model</p>
</td></tr>
</table>


<h3>Note</h3>

<p>A big thanks to user hrbrmstr at Stack Overflow for helping with the NCEP web site parsing code.
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WebCrawler">WebCrawler</a></code>, <code><a href="#topic+ParseModelPage">ParseModelPage</a></code>, <code><a href="#topic+NOMADSArchiveList">NOMADSArchiveList</a></code>, <code><a href="#topic+GribGrab">GribGrab</a></code>, <code><a href="#topic+DODSGrab">DODSGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
#Grib filter
model.list &lt;- NOMADSRealTimeList("grib")

#DODS interface
model.list &lt;- NOMADSRealTimeList("dods")

## End(Not run)
</code></pre>

<hr>
<h2 id='ParseModelPage'>
Extract predictions, levels, and variables
</h2><span id='topic+ParseModelPage'></span>

<h3>Description</h3>

<p>This function parses the model download pages on NOMADS, and extracts information on predictions, levels, and variables available for each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ParseModelPage(abbrev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ParseModelPage_+3A_abbrev">abbrev</code></td>
<td>

<p>The abbreviation of the model you are trying to examine, found using NOMADSRealTimeList
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function scrapes the web page for a given model and determines which predictions, levels, and variables are present for each.
Predictions are instances returned by each model (for example, the GFS model produces 3 hour predictions up to 192 hours from the model run).
Levels are regions of the atmosphere, surface of the Earth, or subsurface that the model produces output for (for example the GFS model has a &ldquo;2 m above ground&rdquo; level that has data for temperature, etc, at that height across the Earth).
Variables are types of data (temperature, for example).
</p>


<h3>Value</h3>

<table>
<tr><td><code>pred</code></td>
<td>
<p>Model predictions</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>Locations of data points</p>
</td></tr>
<tr><td><code>variables</code></td>
<td>
<p>Data types</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Many of the names for predictions, levels, and variables are somewhat cryptic.
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WebCrawler">WebCrawler</a></code>, <code><a href="#topic+ParseModelPage">ParseModelPage</a></code>, <code><a href="#topic+GribGrab">GribGrab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#An example for the Global Forecast System 0.5 degree model

#Get the latest model url
## Not run: 
urls.out &lt;- CrawlModels(abbrev = "gfs_0p50", depth = 1)

#Get a list of forecasts, variables and levels
model.parameters &lt;- ParseModelPage(urls.out[1])


## End(Not run)


</code></pre>

<hr>
<h2 id='PlotWindProfile'>
Plot wind speed and direction
</h2><span id='topic+PlotWindProfile'></span>

<h3>Description</h3>

<p>Creates a polar plot showing the azimuth, elevation, and magnitude of winds.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotWindProfile(zonal.wind, meridional.wind, height, magnitude = NULL,
    magnitude.range = c(0, 50), height.range = c(0, 50000), points = TRUE, lines = FALSE,
    radial.axis = TRUE, elev.circles = NULL, elev.labels = NULL, radial.lines = NULL,
    colorbar = TRUE, colorbar.label = NULL, north.label = TRUE, invert = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotWindProfile_+3A_zonal.wind">zonal.wind</code></td>
<td>

<p>A vector or list of vectors of zonal (East-West) winds, west negative.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_meridional.wind">meridional.wind</code></td>
<td>

<p>A vector or list of vectors of meridional (North-South) winds, south negative.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_height">height</code></td>
<td>

<p>A vector or list of vectors of height at which each wind measurement was taken.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_magnitude">magnitude</code></td>
<td>

<p>A vector or list of vectors of magnitudes to plot at each wind azimuth, instead of using the wind magnitudes.
This allows plotting of other data (such as the speed of sound) along the wind vectors. 
Defaults to <code>NULL</code>.
</p>
</td></tr> 
<tr><td><code id="PlotWindProfile_+3A_magnitude.range">magnitude.range</code></td>
<td>

<p>Ranges of wind speed to plot. Values greater or lesser than these will be saturated. Defaults to <code>c(0, 50)</code>.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_height.range">height.range</code></td>
<td>

<p>Ranges of heights to plot, values outside of this will not appear. Defaults to <code>c(0, 50000)</code>.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_points">points</code></td>
<td>

<p>Whether to plot measurements as points.  Defaults to <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_lines">lines</code></td>
<td>

<p>Whether to connect measurements together with lines.  Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_radial.axis">radial.axis</code></td>
<td>

<p>Whether to plot an axis at the outer edge of the diagram.  Defaults to <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_elev.circles">elev.circles</code></td>
<td>

<p>Plot a dashed circles as elevation scales.  Defaults to <code>NULL</code>, which plots nothing.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_elev.labels">elev.labels</code></td>
<td>

<p>What labels to put on the elevation scales.  Defaults to <code>NULL</code>, which means no labels.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_radial.lines">radial.lines</code></td>
<td>

<p>Plot lines radiating from the center of the plot showing azimuth directions.  Defaults to <code>NULL</code>, which plots nothing.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_colorbar">colorbar</code></td>
<td>

<p>If <code>TRUE</code>, plot a color bar.  Defaults to <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_colorbar.label">colorbar.label</code></td>
<td>

<p>What label to put on the colorbar.  Defaults to <code>NULL</code>, which means no label.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_north.label">north.label</code></td>
<td>

<p>If <code>TRUE</code>, put a label denoting the north direction.  Defaults to <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_invert">invert</code></td>
<td>

<p>Reverses the edge and the center of the plot, making elevations decrease towards the center.  Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="PlotWindProfile_+3A_...">...</code></td>
<td>

<p>Additional optional arguments described below.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function supports some optional arguments as well:
r.axis - radius of plot axis \
tick.len - length of azimuth ticks \
r.axis.ticks - Whether or not to put tick marks on the outer axis \
max.az - If plotting lines and the difference between two segments is greater than this value, interpolate between them to make things smooth \
color.map - A list of colors to use, defaults to ## rainbow(n.cols, start=0, end=5/6) ## \
n.cols - Number of color bins in color map \
sub.col - Color of internal (elevation and azimuth) axes as a vector of length 2 \
sub.lty - Type of internal axes, as a vector of length 2 \
sub.lwd - Width of internal axes, as a vector of length 2 \
elev.labels.az - Which azimuth to plot elevation labels on \
point.cex - size of points, if plotted \
pch - Plot character of points, if plotted \
lty - Line style, if lines are selected \
lwd - Line thickness, if lines are selected \
colorbar.tick - Where to put labels on colorbar
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
download.file("http://www.gmail.com/~haksaeng/rNOMADS/myTA.RDATA", 
   destfile = "myTA.RDATA")
load("myTA.RDATA")
#Find the latest Global Forecast System model run
model.urls &lt;- GetDODSDates("gfs_0p50")
latest.model &lt;- tail(model.urls$url, 1)
model.runs &lt;- GetDODSModelRuns(latest.model)
latest.model.run &lt;- tail(model.runs$model.run, 1)

#Get model nodes

lons &lt;- seq(0, 359.5, by = 0.5)
lats &lt;- seq(-90, 90, by = 0.5)
lon.ind &lt;- which(lons &lt;= (max(myTA$lon + 360) + 1) &amp; lons &gt;= (min(myTA$lon + 360) - 1))
lat.ind &lt;- which(lats &lt;= (max(myTA$lat) + 1) &amp; lats &gt;= (min(myTA$lat) - 1))
levels &lt;- c(0, 46)
time &lt;- c(0, 0)

#Get data 
variables &lt;- c("hgtprs", "ugrdprs", "vgrdprs")
model.data &lt;- DODSGrab(latest.model, latest.model.run,
   variables, time, c(min(lon.ind), max(lon.ind)), 
   c(min(lat.ind), max(lat.ind)), levels)

#Build profiles
profile &lt;- BuildProfile(model.data, myTA$lon + 360, myTA$lat, 
    spatial.average = FALSE)

#Build profiles
zonal.wind      &lt;- NULL
meridional.wind &lt;- NULL 
height          &lt;- NULL

for(k in 1:length(profile)) {
   hgt  &lt;- profile[[k]]$profile.data[, which(profile[[k]]$variables == "hgtprs"),]
   ugrd &lt;- profile[[k]]$profile.data[, which(profile[[k]]$variables == "ugrdprs"),]
   vgrd &lt;- profile[[k]]$profile.data[, which(profile[[k]]$variables == "vgrdprs"),]

   synth.hgt &lt;- seq(min(hgt),
       max(hgt), length.out = 1000)
   ugrd.spline &lt;- splinefun(hgt, ugrd, method = "natural")
   vgrd.spline &lt;- splinefun(hgt, vgrd, method = "natural")
   zonal.wind[[k]] &lt;- ugrd.spline(synth.hgt)
   meridional.wind[[k]] &lt;- vgrd.spline(synth.hgt)
   height[[k]] &lt;- synth.hgt
}

#Plot them all
PlotWindProfile(zonal.wind, meridional.wind, height, lines = TRUE, 
    points = FALSE, elev.circles = c(0, 25000, 50000), elev.labels = c(0, 25, 50), 
    radial.lines = seq(45, 360, by = 45), colorbar = TRUE, invert = FALSE, 
    point.cex = 2, pch = 19, lty = 1, lwd = 1, 
    height.range = c(0, 50000), colorbar.label = "Wind Speed (m/s)")

## End(Not run)
</code></pre>

<hr>
<h2 id='ReadGrib'>
Extract data from grib files
</h2><span id='topic+ReadGrib'></span>

<h3>Description</h3>

<p>This function wraps <code>wgrib2</code> and <code>wgrib</code>, external grib file readers provided by the National Weather Service Climate Prediction Center (see <a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/</a> and <a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html</a>).
<code>ReadGrib</code> extracts forecast data into R.
It does this by building an argument string, executing a system call to the appropriate external grib file reader, and extracting the result.
Note that <code>wgrib2</code> must be installed for <code>ReadGrib</code> to work for current grib files, and <code>wgrib</code> may need to be installed when looking at archived data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ReadGrib(file.names, levels, variables, 
    forecasts = NULL, domain = NULL, domain.type = "latlon", 
file.type = "grib2", missing.data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ReadGrib_+3A_file.names">file.names</code></td>
<td>

<p>The path and file name of the grib files to read.
</p>
</td></tr>
<tr><td><code id="ReadGrib_+3A_levels">levels</code></td>
<td>

<p>The levels to extract.
</p>
</td></tr>
<tr><td><code id="ReadGrib_+3A_variables">variables</code></td>
<td>

<p>The variables to extract.
</p>
</td></tr>
<tr><td><code id="ReadGrib_+3A_forecasts">forecasts</code></td>
<td>

<p>Names of forecasts to extract.  
If <code>NULL</code>, include everything.
</p>
</td></tr>
<tr><td><code id="ReadGrib_+3A_domain">domain</code></td>
<td>

<p>Include model nodes in the specified region: <code>c(LEFT LON, RIGHT LON, NORTH LAT, SOUTH LAT)</code>.
If <code>NULL</code>, include everything.
This argument works for GRIB2 only.
</p>
</td></tr>
<tr><td><code id="ReadGrib_+3A_domain.type">domain.type</code></td>
<td>

<p>Either <code>\"latlon\"</code> 
(the <code>domain</code> argument is a latitude/longitude quadruplet) 
or <code>\"index\"</code> (the <code>domain</code> argument is a model node index quadruplet; 
much faster but requires you to know the model setup)
</p>
</td></tr>
<tr><td><code id="ReadGrib_+3A_file.type">file.type</code></td>
<td>

<p>Whether the file is in GRIB (<code>"grib1"</code>) or GRIB2 (<code>"grib2"</code>) format.
Default is <code>"grib2"</code>.
</p>
</td></tr>
<tr><td><code id="ReadGrib_+3A_missing.data">missing.data</code></td>
<td>

<p>Replace missing data in grib archive with this value.
If <code>NULL</code>, leave the data out.  Only works with wgrib2. Default <code>NULL</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function constructs system calls to <code>wgrib</code> and <code>wgrib2</code>.
Therefore, you must have installed these programs and made it available on the system path.
Unless you are interested in accessing archive data that's more than a few years old, you can <code>install</code> wgrib2 only.
A description of <code>wgrib2</code> and installation links are available at <a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/</a> and <a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib.html</a>.
Also, rNOMADS is focused towards GRIB2 files; I have included GRIB1 format support as a convenience.
</p>


<h3>Value</h3>

<table>
<tr><td><code>model.data</code></td>
<td>
<p>A structure with a series of elements containing data extracted from the grib files.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>References</h3>

<p>Ebisuzaki, W, Bokhorst, R., Hyvatti, J., Jovic, D., Nilssen, K,  
Pfeiffer, K.,  Romero, P.,  Schwarb, M., da Silva, A., Sondell, N., and Varlamov, S. (2011).
wgrib2: read and write GRIB2 files.  <em>National Weather Service Climate Prediction Center</em>,
<a href="http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/">http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GribGrab">GribGrab</a></code>, <code><a href="#topic+ArchiveGribGrab">ArchiveGribGrab</a></code>, <code><a href="#topic+ModelGrid">ModelGrid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Operational Forecast Data Extraction
#NCEP output is always in GRIB2 format - this makes things easy for us
#An example for the Global Forecast System 0.5 degree model

#Get the latest model url
## Not run: 
urls.out &lt;- CrawlModels(abbrev = "gfs_0p50", depth = 1)

#Get a list of forecasts, variables and levels
model.parameters &lt;- ParseModelPage(urls.out[1])

#Figure out which one is the 6 hour forecast
#provided by the latest model run
#(will be the forecast from 6-12 hours from the current date) 

my.pred &lt;- model.parameters$pred[grep("06$", model.parameters$pred)]

#What region of the atmosphere to get data for
levels &lt;- c("2 m above ground", "800 mb")

#What data to return
variables &lt;- c("TMP", "RH") #Temperature and relative humidity

#Get the data
model.info &lt;- GribGrab(urls.out[1], my.pred, levels, variables)

#Extract the data
model.data &lt;- ReadGrib(model.info[[1]]$file.name, levels, variables)

#Reformat it
model.grid &lt;- ModelGrid(model.data, c(0.5, 0.5))

#Show an image of world temperature at ground level
image(model.grid$z[2, 1,,])


## End(Not run)
</code></pre>

<hr>
<h2 id='SanitizeURL'>
Remove illegal URL characters
</h2><span id='topic+SanitizeURL'></span>

<h3>Description</h3>

<p>An internal routine for replacing illegal URL character in level and variable names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SanitizeURL(bad.strs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SanitizeURL_+3A_bad.strs">bad.strs</code></td>
<td>

<p>A vector of strings destined for concatenation into a URL.
They may have characters that are not allowed in URLs.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function that helps make sure variable and level names create valid URLS for downloading model data.
</p>


<h3>Value</h3>

<table>
<tr><td><code>good.str</code></td>
<td>
<p>A vector of strings with illegal URL characters replaced by their percent encoding</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
bad.strs &lt;- c("I am full of ^ill=/\\egal characters")
good.str &lt;- SanitizeURL(bad.strs)
print(good.str[1])
</code></pre>

<hr>
<h2 id='SubsetNOMADS'>
Subset model data output
</h2><span id='topic+SubsetNOMADS'></span>

<h3>Description</h3>

<p>Subset data structure returned by <code><a href="#topic+ReadGrib">ReadGrib</a></code> or <code><a href="#topic+DODSGrab">DODSGrab</a></code> by variables, levels, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SubsetNOMADS(model.data, levels = NULL, variables = NULL, lon = NULL, 
lat = NULL, ensembles = NULL, forecast.date = NULL, model.run.date = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SubsetNOMADS_+3A_model.data">model.data</code></td>
<td>

<p>Data structure from <code><a href="#topic+ReadGrib">ReadGrib</a></code> or <code><a href="#topic+DODSGrab">DODSGrab</a></code></p>
</td></tr>
<tr><td><code id="SubsetNOMADS_+3A_levels">levels</code></td>
<td>

<p>Vector of levels to keep</p>
</td></tr>
<tr><td><code id="SubsetNOMADS_+3A_variables">variables</code></td>
<td>

<p>Vector of variables to keep</p>
</td></tr>
<tr><td><code id="SubsetNOMADS_+3A_lon">lon</code></td>
<td>

<p>Vector of longitudes of model nodes to keep</p>
</td></tr>
<tr><td><code id="SubsetNOMADS_+3A_lat">lat</code></td>
<td>

<p>Vector of latitudes of model nodes to keep</p>
</td></tr>
<tr><td><code id="SubsetNOMADS_+3A_ensembles">ensembles</code></td>
<td>

<p>Vector of ensemble runs to keep</p>
</td></tr>
<tr><td><code id="SubsetNOMADS_+3A_forecast.date">forecast.date</code></td>
<td>

<p>Vector of forecast dates to keep</p>
</td></tr>
<tr><td><code id="SubsetNOMADS_+3A_model.run.date">model.run.date</code></td>
<td>

<p>Vector of model run dates to keep</p>
</td></tr> 
</table>


<h3>Value</h3>

<table>
<tr><td><code>model.data.sub</code></td>
<td>
<p>A subset of <code>model.data</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Multiple elements in each argument vector are obviously OR (i.e. variables are &ldquo;tmpprs&rdquo; OR &ldquo;hgtprs&rdquo;) but multiple subset vectors are AND.
Thus it is simple to construct a <code>model.data.sub</code> with variables: tmpprs and hgptprs only from ensemble runs 3 and 4, for example.
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ReadGrib">ReadGrib</a></code>, <code><a href="#topic+DODSGrab">DODSGrab</a></code>, <code><a href="#topic+ModelGrid">ModelGrid</a></code>, <code><a href="#topic+BuildProfile">BuildProfile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
#Plot winds from 20 GENS model runs

#Get the latest ensemble model run
model.urls &lt;- GetDODSDates("gens")
latest.model &lt;- tail(model.urls$url, 1)
model.runs &lt;- GetDODSModelRuns(latest.model)
model.run &lt;- tail(model.runs$model.run[grepl("all", 
    model.runs$model.run)], 1)

#Define region of interest: Chapel Hill, NC
lon &lt;- -79.052104
lat &lt;- 35.907553

lons &lt;- seq(0, 359, by = 1)
lats &lt;- seq(-90, 90, by = 1)

lon.diff &lt;- abs(lon + 360 - lons)
lat.diff &lt;- abs(lat - lats)

model.lon.ind &lt;- which(lon.diff == min(lon.diff)) - 1
model.lat.ind &lt;- which(lat.diff == min(lat.diff)) - 1

#Set up call to NOMADS
time &lt;- c(0, 0)      #Analysis(?) model only
node.lon  &lt;- c(model.lon.ind - 2, model.lon.ind + 2)  #Longitude grid
node.lat  &lt;- c(model.lat.ind - 2, model.lat.ind + 2)   #Latitude grid
variables &lt;- c("ugrdprs", "vgrdprs", "hgtprs") #Wind speeds, and geopotential height
levels    &lt;- c(0, 25) #All available levels
ensembles &lt;- c(0, 20)  #All available ensembles

model.data &lt;- DODSGrab(latest.model, model.run, variables, time, 
    node.lon, node.lat, levels = levels, ensembles = ensembles)

#Plot winds
zonal.wind &lt;- NULL
merid.wind &lt;- NULL
height     &lt;- NULL

for(k in ((ensembles[1]:ensembles[2] + 1))) {
    model.data.sub &lt;- SubsetNOMADS(model.data, ensembles = c(k), 
    variables = c("hgtprs", "ugrdprs", "vgrdprs"))
    profile &lt;- BuildProfile(model.data.sub, lon + 360, lat)
    hgt     &lt;- profile[[1]]$profile.data[, which(profile[[1]]$variables == "hgtprs"),]
    ugrd    &lt;- profile[[1]]$profile.data[, which(profile[[1]]$variables == "ugrdprs"),]
    vgrd    &lt;- profile[[1]]$profile.data[, which(profile[[1]]$variables == "vgrdprs"),]

   synth.hgt &lt;- seq(min(hgt),
       max(hgt), length.out = 1000)
   ugrd.spline &lt;- splinefun(hgt, ugrd, method = "natural")
   vgrd.spline &lt;- splinefun(hgt, vgrd, method = "natural")
   zonal.wind[[k]] &lt;- ugrd.spline(synth.hgt)
   merid.wind[[k]] &lt;- vgrd.spline(synth.hgt)
   height[[k]] &lt;- synth.hgt
}

PlotWindProfile(zonal.wind, merid.wind, height, lines = TRUE,
    points = FALSE, elev.circles = c(0, 15000, 30000), elev.labels = c(0, 15, 30),
    radial.lines = seq(45, 360, by = 45), colorbar = TRUE, invert = FALSE,
    point.cex = 2, pch = 19, lty = 1, lwd = 1,
    height.range = c(0, 30000), colorbar.label = "Wind Speed (m/s)")

## End(Not run)
</code></pre>

<hr>
<h2 id='WebCrawler'>
Get web pages 
</h2><span id='topic+WebCrawler'></span>

<h3>Description</h3>

<p>Discover all links on a given web page, follow each one, and recursively scan every link found.
Return a list of web addresses whose pages contain no links.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WebCrawler(url, depth = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WebCrawler_+3A_url">url</code></td>
<td>

<p>A URL to scan for links.
</p>
</td></tr>
<tr><td><code id="WebCrawler_+3A_depth">depth</code></td>
<td>

<p>How many links to return.
This avoids having to recursively scan hundreds of links.
Defaults to <code>NULL</code>, which returns everything.
</p>
</td></tr>
<tr><td><code id="WebCrawler_+3A_verbose">verbose</code></td>
<td>

<p>Print out each link as it is discovered.
Defaults to <code>TRUE</code>.
</p>
</td></tr>  
</table>


<h3>Details</h3>

<p><code><a href="#topic+CrawlModels">CrawlModels</a></code> uses this function to get all links present on a model page.
</p>


<h3>Value</h3>

<table>
<tr><td><code>urls.out</code></td>
<td>
<p>A list of web page addresses, each of which corresponds to a model instance.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>While it might be fun to try <code>WebCrawler</code> on a large website such as Google, the results will be unpredictable and perhaps disastrous if <code>depth</code> is not set.
This is because there is no protection against infinite recursion. 
</p>


<h3>Author(s)</h3>

<p>Daniel C. Bowman <a href="mailto:danny.c.bowman@gmail.com">danny.c.bowman@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CrawlModels">CrawlModels</a></code>, <code><a href="#topic+ParseModelPage">ParseModelPage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Find the first 10 model runs for the 
#GFS 0.5x0.5 model

## Not run: urls.out &lt;- WebCrawler(
"http://nomads.ncep.noaa.gov/cgi-bin/filter_gfs_0p50.pl", depth = 10)
## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
