<!DOCTYPE html><html lang="en"><head><title>Help for package spef</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spef}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#spef-package'><p>spef: Semiparametric Estimating Functions</p></a></li>
<li><a href='#bladTumor'><p>Bladder Tumors Cancer Recurrences</p></a></li>
<li><a href='#blaTum'><p>Bladder Tumors Cancer Recurrences</p></a></li>
<li><a href='#panelReg'><p>Fits Semiparametric Regression Models for Panel Count Survival Data</p></a></li>
<li><a href='#panelReg.object'><p>Semiparametric Panel Count Regression Object</p></a></li>
<li><a href='#PanelSurv'><p>Create a PanelSurv Object</p></a></li>
<li><a href='#plot.panelReg'><p>Plot a <code>panelReg</code> Object.</p></a></li>
<li><a href='#plot.PanelSurv'><p>Produce Tile Plot</p></a></li>
<li><a href='#skinTumor'><p>Skin cancer chemoprevention trial</p></a></li>
<li><a href='#skiTum'><p>A Simulated Data Mimicking a Skin Cancer Chemoprevention Trial</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Semiparametric Estimating Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.9</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for fitting semiparametric regression models for
        panel count survival data. An overview of the package can be found 
        in Wang and Yan (2011) &lt;<a href="https://doi.org/10.1016%2Fj.cmpb.2010.10.005">doi:10.1016/j.cmpb.2010.10.005</a>&gt; and
	Chiou et al. (2018) &lt;<a href="https://doi.org/10.1111%2Finsr.12271">doi:10.1111/insr.12271</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://github.com/stc04003/spef">http://github.com/stc04003/spef</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="http://github.com/stc04003/spef/issues">http://github.com/stc04003/spef/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>BB, SQUAREM, ggplot2, methods, sm, survival, plyr, nleqslv</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-24 03:05:34 UTC; schiou</td>
</tr>
<tr>
<td>Author:</td>
<td>Sy Han (Steven) Chiou [aut, cre],
  Xiaojing Wang [aut],
  Jun Yan [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sy Han (Steven) Chiou &lt;schiou@utdallas.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-24 05:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='spef-package'>spef: Semiparametric Estimating Functions</h2><span id='topic+spef-package'></span><span id='topic+_PACKAGE'></span><span id='topic+spef-packages'></span>

<h3>Description</h3>

<p><code>spef</code> is an R package that consists of a collection of functions for fitting
semiparametric regression models for panel count survival data.
Estimating procedures include: Wang-Yan’s augmented estimating equations (AEE, AEEX),
Huang-Wang-Zhang’s method (HWZ), Zhang’s maximum pseudolikelihood (MPL),
Maximum pseudolikelihood with I-Splines (MPLs), Maximum likelihood with I-Splines (MLs),
Sun-Wei’s method (&lsquo;EE.SWa', 'EE.SWb', 'EE.SWc'), Hu-Sun-Wei&rsquo;s method ('EE.HSWc', 'EE.HSWm'),
and accelerated mean model ('AMM').
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Sy Han (Steven) Chiou <a href="mailto:schiou@utdallas.edu">schiou@utdallas.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Xiaojing Wang
</p>
</li>
<li><p> Jun Yan
</p>
</li></ul>



<h3>References</h3>

<p>Chiou, S., Xu, G., Yan, J., and Huang, C.-Y. (2017).
Semiparametric estimation of the accelerated mean model with panel count data under
informative examination times. <em>Biometrics</em>, to appear.
&lt;doi: 10.1111/biom.12840&gt;.
</p>
<p>Huang, C.-Y., Wang, M., and Zhang, Y. (2006).
Analysing panel count data with informative observation times.
<em>Biometrika</em>, <b>93</b>(4), 763&ndash;776.
</p>
<p>Hu, X. J., Sun, J. and Wei, L. J. (2003).
Regression parameter estimation from panel counts.
<em>Scandinavian Journal of Statistics</em>, <b>30</b>, 25&ndash;43.
</p>
<p>Lu, M., Zhang, Y., and Huang, J. (2007).
Estimation of the mean function with panel count data using monotone polynomial splines.
<em>Biometrika</em>, <b>94</b>(3), 705&ndash;718.
</p>
<p>Sun, J. and Wei, L. J. (2000). Regression analysis of panel count
data with covariates-dependent observation and censoring times.
<em>Journal of the Royal Statistical Society, Series B: Statistical Methodology</em>,
<b>62</b>(2), 293&ndash;302.
</p>
<p>Wang, X. and Yan, J. (2011). Fitting semiparametric regressions for panel
count survival data with an R package spef.
<em>Computer methods and programs in biomedicine</em> <b>104</b>(2), 278&ndash;285.
</p>
<p>Wang, X. and Yan, J. (2013). Augmented estimating equations for
semiparametric panel count regression with informative observation
times and censoring time. <em>Statistica Sinica</em>, <b>23</b>(1), 359&ndash;381.
</p>
<p>Zhang, Y. (2002). A Semiparametric pseudolikelihood estimation method
for panel count data. <em>Biometrika</em>, <b>89</b>(1), 39&ndash;48.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="http://github.com/stc04003/spef">http://github.com/stc04003/spef</a>
</p>
</li>
<li><p> Report bugs at <a href="http://github.com/stc04003/spef/issues">http://github.com/stc04003/spef/issues</a>
</p>
</li></ul>


<hr>
<h2 id='bladTumor'>Bladder Tumors Cancer Recurrences</h2><span id='topic+bladTumor'></span>

<h3>Description</h3>

<p>A data frame contains data on recurrences of bladder cancer,
used by many people to demonstrate methodology for recurrent event modeling.
The data was obtained by courtesy of Ying Zhang, containing records of 118 patients
from three treatment arms: 48 are from the placebo arm, 37 are from the thiotepa arm,
and the rest 33 are from the pyridoxine arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bladTumor)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> contains the following columns:
</p>

<dl>
<dt><code>subject</code></dt><dd><p>patient id</p>
</dd>
<dt><code>time</code></dt><dd><p>observation time</p>
</dd>
<dt><code>count</code></dt><dd><p>cumulative number of tumors</p>
</dd>
<dt><code>count2</code></dt><dd><p>number of new tumors since last observation time</p>
</dd>
<dt><code>number</code></dt><dd><p>initial number of tumors (8=8 or more)</p>
</dd>
<dt><code>size</code></dt><dd><p>size (cm) of largest initial tumor</p>
</dd>
<dt><code>pyridoxine</code></dt><dd><p>dummy variable for pyridoxine arm</p>
</dd>
<dt><code>thiotepa</code></dt><dd><p>dummy variable for thiotepa arm</p>
</dd>
</dl>


<h3>Note</h3>

<p>To our surprise, the two-treatment (placebo and thiotepa) subset of
the full version <code>bladTumor</code> do not match the two-treatment
version <code>blaTum</code>.
</p>


<h3>References</h3>

<p>Byar, D. P. (1980). The Veterans administration study of chemoprophylaxis
for recurrent stage I bladder tumors: Comparisons of placebo, pyridoxine, and topical thiotepa.
<em>Bladder Tumors and Other Topics in Urological Oncology</em>, pp. 363&ndash;370. New York: Plenum.
</p>
<p>Wellner, J. A. and Zhang, Y. (2007) Two likelihood-based semiparametric estimation
methods for panel count data with covariates. <em>Annals of Statistics</em>, <b>35</b>(5), 2106&ndash;2142.
</p>
<p>Lu, M., Zhang, Y. and Huang, J. (2009) Semiparametric estimation methods for panel
count data using monotone B-Splines. <em>Journal of the American Statistical Association</em>
<b>104</b>(487), 1060&ndash;1070.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+blaTum">blaTum</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bladTumor)
## Plot bladder tumor data
p &lt;- plot(with(bladTumor, PanelSurv(subject, time, count2)))
print(p)
</code></pre>

<hr>
<h2 id='blaTum'>Bladder Tumors Cancer Recurrences</h2><span id='topic+blaTum'></span>

<h3>Description</h3>

<p>A data frame contains data on recurrences of bladder cancer,
used by many people to demonstrate methodology for recurrent event modelling.
This data set organized differently from <code>bladTumor</code>.
The data contains records of 85 patients from two treatment arms:
48 are from the placebo arm, and the rest 37 are from the thiotepa arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(blaTum)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> contains the following columns:
</p>

<dl>
<dt><code>id</code></dt><dd><p>patient id</p>
</dd>
<dt><code>treatment</code></dt><dd><p>placebo = 0, thiotepa = 1</p>
</dd>
<dt><code>size</code></dt><dd><p>size (cm) of largest initial tumor</p>
</dd>
<dt><code>num</code></dt><dd><p>initial number of tumors (8 = 8 or more)</p>
</dd>
<dt><code>time</code></dt><dd><p>observation time</p>
</dd>
<dt><code>count</code></dt><dd><p>number of new tumors since last observation time</p>
</dd>
</dl>


<h3>Note</h3>

<p>To our surprise, the two-treatment (placebo and thiotepa) subset of
the full version <code>bladTumor</code> do not match the two-treatment version <code>blaTum</code>.
</p>


<h3>References</h3>

<p>Byar, D. P. (1980). The Veterans administration study of chemoprophylaxis for
recurrent stage I bladder tumors: comparisons of placebo, pyridoxine, and topical thiotepa.
<em>Bladder Tumors and Other Topics in Urological Oncology</em>, pp. 363&ndash;370. New York: Plenum.
</p>
<p>Sun, J. and Wei, L. J. (2000) Regression analysis of panel count data
with covariate dependent observation and censoring times.
<em>Journal of the Royal Statistical Society, Series B: Statistical Methodology</em>,
<b>62</b>(2), 293&ndash;302.
</p>
<p>Huang, C. Y., Wang, M. C. and Zhang, Y. (2006).
Analyzing panel count data with informative observation times.
<em>Biometrika</em>, <b>93</b>(4): 763&ndash;776.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bladTumor">bladTumor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(blaTum)
library(ggplot2)
ggplot(blaTum, aes(time, id)) + geom_tile(aes(fill=count)) +
    facet_grid(treatment ~ ., scales="free_y", )
</code></pre>

<hr>
<h2 id='panelReg'>Fits Semiparametric Regression Models for Panel Count Survival Data</h2><span id='topic+panelReg'></span>

<h3>Description</h3>

<p>Fits an proportional means model:
</p>
<p style="text-align: center;"><code class="reqn">\Lambda (t; X_i) = E[N_i(t)|X_i] = \Lambda(t)e^{X_i ' \beta},</code>
</p>

<p>where <code class="reqn">\beta</code> is a <code class="reqn">p \times 1</code> vector of covariate
coefficient and <code class="reqn">\Lambda(\cdot)</code> is a completely unspecified
baseline mean function.
</p>
<p>Estimating procedures include: Wang-Yan's augmented estimating
equations (<code>"AEE"</code>, <code>"AEEX"</code>),
Huang-Wang-Zhang's method (<code>"HWZ"</code>),
Zhang's maximum pseudo-likelihood (<code>"MPL"</code>),
Maximum pseudolikelihood with I-Splines (<code>"MPLs"</code>),
Maximum likelihood with I-Splines (<code>"MLs"</code>),
Sun-Wei's method (<code>"EE.SWa"</code>, <code>"EE.SWb"</code>, <code>"EE.SWc"</code>),
and Hu-Sun-Wei's method (<code>"EE.HSWc"</code>, <code>"EE.HSWm"</code>).
</p>
<p>The function can also fits an accelerated mean model (<code>"AMM"</code>):
</p>
<p style="text-align: center;"><code class="reqn">\Lambda (t; X_i) = E[N_i(t)|X_i] = \Lambda(te^{X_i ' \beta})e^{X_i ' \beta}.</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>panelReg(formula, data, method = c("AEE", "AEEX", "HWZ", "MPL", "MPLs",
  "MLs", "AMM", "EE.SWa", "EE.SWb", "EE.SWc", "EE.HSWc", "EE.HSWm"),
  se = c("NULL", "smBootstrap", "Bootstrap", "Impute", "Sandwich"),
  control = list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="panelReg_+3A_formula">formula</code></td>
<td>
<p>A formula object, with the response on the left of a
&quot;~&quot; operator, and the terms on the right. The response must be a
panel count survival object as returned by function <code>PanelSurv</code>.</p>
</td></tr>
<tr><td><code id="panelReg_+3A_data">data</code></td>
<td>
<p>A data.frame in which to interpret the variables named in
the <code>formula</code>. Three variables including subjects' id,
observation times, and number of new events since last
observation time are required to feed into function
<code>PanelSurv</code> as response. At least one covariate variable is required.</p>
</td></tr>
<tr><td><code id="panelReg_+3A_method">method</code></td>
<td>
<p>Fitting method. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="panelReg_+3A_se">se</code></td>
<td>
<p>Standard error estimation method. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="panelReg_+3A_control">control</code></td>
<td>
<p>A list of control parameters. See &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some assumptions details about the observation times and censoring
time need clarification. Three possible scenarios of observation
times are considered: 1) independent observation times &ndash; the
observation times are independent of the underlying recurrent event
process; 2) conditional independent observation times &ndash; the
observation times are independent of the event process given
observed covariates; 3) informative observation times &ndash; after
conditioning on observed covariates, the observation times and the
event process are still dependent through an unobserved
multiplicative frailty. Similarly, the three scenarios apply to the
censoring time.
</p>
<p><code>"AEE"</code> and <code>"AEEX"</code> are the augmented estimating
equation methods under conditional independent censoring and
informative censoring respectively. Both allow informative observation times.
</p>
<p><code>"HWZ"</code> is Huang-Wang-Zhang's method. It allows both
information observation times and informative censoring time. It does
not need to specify the dependence structure or model the frailty.
</p>
<p><code>"MPL"</code> and <code>"MPLs"</code> are maximum pseudolikelihood
methods, with nonparametric and monotone spline estimates of the baseline
mean function respectively. They assume conditional independent
observation times and censoring time. The underlying event process
is assumed to be Poisson, and the within subjects dependence is ignored.
</p>
<p><code>"MLs"</code> is maximum likelihood method with monotone splines
estimates of the baseline mean function. It assumes conditional
independent observation times and censoring time, and a Poisson
underlying event process.
</p>
<p><code>"EE.SWa"</code>, <code>"EE.SWb"</code> and <code>"EE.SWc"</code> are estimating
equation approaches based on Sun-Wei's methods.
The first assumes independent observation times and censoring
time. The second assumes conditional independent observation times but
independent censoring time. The third assumes conditional independent
observation times and censoring time. All three variations work on
centered covariates and avoid estimating the baseline mean.
</p>
<p><code>"EE.HSWc"</code> and <code>"EE.HSWm"</code> are estimating
equation approaches based on Hu-Sun-Wei's methods.
The first assumes independent observation times and censoring
time. The second assumes conditional independent observation times but
independent censoring time. Both variations work on centered covariates
and avoid estimating the baseline mean.
</p>
<p><code>"AMM"</code> is the accelerated mean model.
The observation time process is allowed to be correlated with
the underlying recurrent event process through a frailty variable,
which does not need to be specified. The model also allows marginal
interpretations for the regression parameters and connects naturally
with AFT model. See Chiou et al. (2017) for more details.
</p>
<p>For standard errors estimation method:
</p>
<p><code>"NULL"</code> means do not calculate standard errors;
<code>"smBootstrap"</code> is the smoothed bootstrap estimation method
that works with <code>"AMM"</code>.
<code>"Bootstrap"</code> works with all fitting methods; <code>"Impute"</code> is
the multiple imputation method that works with <code>"AEE"</code> and
<code>"AEEX"</code>; <code>"Sandwich"</code> is the robust sandwich estimation
method that works with <code>"AEE"</code> and <code>"AEEX"</code>.
</p>
<p>The <code>control</code> argument is a list that can supply any of the
following components:
</p>

<dl>
<dt><code>betaInit</code>:</dt><dd><p>Object of class <code>"numeric"</code>,
initial value for covariate coefficient, default <code>0</code>.</p>
</dd>
<dt><code>interval</code>:</dt><dd><p>Object of class <code>"numeric"</code>,
initial search interval for solving <code>beta</code>, default
<code>(-5, 5)</code>.</p>
</dd>
<dt><code>maxIter</code>:</dt><dd><p>Object of class <code>"numeric"</code>, maximum
iteration allowed, default <code>500</code> for <code>"AEEX"</code> and
<code>"HWZ"</code>, <code>150</code> for others.</p>
</dd>
<dt><code>absTol</code>:</dt><dd><p>Object of class <code>"numeric"</code>, absolute
tolerance, default <code>1e-6</code>.</p>
</dd>
<dt><code>relTol</code>:</dt><dd><p>Object of class <code>"numeric"</code>, relative
tolerance, default <code>1e-6</code>.</p>
</dd>
<dt><code>a</code>:</dt><dd><p>Object of class <code>"numeric"</code>, a tune parameter,
default <code>0.1</code>. In the case of gamma frailty, <code>"a"</code>
corresponds to the value of both shape and rate parameters.</p>
</dd>
<dt><code>R</code>:</dt><dd><p>Object of class <code>"numeric"</code>, number of
bootstrap or imputation, default 30.</p>
</dd>
</dl>



<h3>Value</h3>

<p>An object of S3 class <code>"panelReg"</code> representing the fit.
See <code>panelReg.object</code> for details.
</p>


<h3>References</h3>

<p>Chiou, S., Xu, G., Yan, J., and Huang, C.-Y. (2017).
Semiparametric estimation of the accelerated mean model with panel count data under
informative examination times. <em>Biometrics</em>, to appear.
&lt;doi: 10.1111/biom.12840&gt;.
</p>
<p>Huang, C.-Y., Wang, M., and Zhang, Y. (2006).
Analysing panel count data with informative observation times.
<em>Biometrika</em>, <b>93</b>(4), 763&ndash;776.
</p>
<p>Hu, X. J., Sun, J. and Wei, L. J. (2003).
Regression parameter estimation from panel counts.
<em>Scandinavian Journal of Statistics</em>, <b>30</b>, 25&ndash;43.
</p>
<p>Lu, M., Zhang, Y., and Huang, J. (2007).
Estimation of the mean function with panel count data using monotone polynomial splines.
<em>Biometrika</em>, <b>94</b>(3), 705&ndash;718.
</p>
<p>Sun, J. and Wei, L. J. (2000). Regression analysis of panel count
data with covariates-dependent observation and censoring times.
<em>Journal of the Royal Statistical Society, Series B: Statistical Methodology</em>,
<b>62</b>(2), 293&ndash;302.
</p>
<p>Wang, X. and Yan, J. (2011). Fitting semiparametric regressions for panel
count survival data with an R package spef.
<em>Computer Methods and Programs in Biomedicine</em>, <b>104</b>(2), 278&ndash;285.
</p>
<p>Wang, X. and Yan, J. (2013). Augmented estimating equations for
semiparametric panel count regression with informative observation
times and censoring time. <em>Statistica Sinica</em>, 359&ndash;381.
</p>
<p>Zhang, Y. (2002). A Semiparametric pseudolikelihood estimation method
for panel count data. <em>Biometrika</em>, <b>89</b>(1), 39&ndash;48.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+panelReg.object">panelReg.object</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(blaTum)
## Fit the bladder tumor data set
formula &lt;- PanelSurv(id, time, count) ~ num + size + treatment

panelReg(formula, data = blaTum, method = "AEE", se = "Sandwich")
panelReg(formula, data = blaTum, method = "AEEX", se = "Impute",
         control = list(a = 0.1, R = 30))
panelReg(formula, data = blaTum, method = "HWZ", se = "Bootstrap",
         control = list(R = 30))
panelReg(formula, data = blaTum, method = "MLs", se = "NULL")
panelReg(formula, data = blaTum, method = "EE.SWa", se = "Bootstrap",
         control = list(R = 30))
panelReg(formula, data = blaTum, method = "EE.HSWc", se = "Bootstrap",
         control = list(R = 30))

## End(Not run)

</code></pre>

<hr>
<h2 id='panelReg.object'>Semiparametric Panel Count Regression Object</h2><span id='topic+panelReg.object'></span>

<h3>Description</h3>

<p>This S3 class of objects is returned by the <code>panelReg</code> class of
functions to represent a fitted semiparametric panel count regression
model. Objects of this class have methods for the functions
<code>print</code> and <code>plot</code>.
</p>


<h3>Value</h3>


<dl>
<dt>beta</dt><dd><p>a vector, estimated coefficients of the linear predictor.</p>
</dd>
<dt>baseline</dt><dd><p>a step function or spline function, estimated
cumulative baseline mean.</p>
</dd>
<dt>timeGrid</dt><dd><p>a vector, ordered unique set of observation times.</p>
</dd>
<dt>lambda</dt><dd><p>a vector, estimated baseline mean for each interval.</p>
</dd>
<dt>convergence</dt><dd><p>an integer code, <code>0</code> indicates successful
convergence, error code <code>1</code> indicates that the iteration limit
<code>maxIter</code> had been reached.</p>
</dd>
<dt>iter</dt><dd><p>an integer value, number of interactions when stopped.</p>
</dd>
<dt>betaSE</dt><dd><p>a vector, estimated standard errors of beta.</p>
</dd>
<dt>betaVar</dt><dd><p>a matrix, estimated covariance matrix of beta.</p>
</dd>
<dt>baselineSE</dt><dd><p>a vector, estimated standard error of
cumulative baseline mean.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+panelReg">panelReg</a></code>
</p>

<hr>
<h2 id='PanelSurv'>Create a PanelSurv Object</h2><span id='topic+PanelSurv'></span><span id='topic+is.PanelSurv'></span>

<h3>Description</h3>

<p>Create a panel count survival object,
usually used as a response variable in a model formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PanelSurv(ID, time, count)

is.PanelSurv(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PanelSurv_+3A_id">ID</code></td>
<td>
<p>Observation subject's ID.</p>
</td></tr>
<tr><td><code id="PanelSurv_+3A_time">time</code></td>
<td>
<p>Observation time.</p>
</td></tr>
<tr><td><code id="PanelSurv_+3A_count">count</code></td>
<td>
<p>Observation subject's ID.</p>
</td></tr>
<tr><td><code id="PanelSurv_+3A_x">x</code></td>
<td>
<p>An <code>PanelSurv</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of S3 class <code>"PanelSurv"</code>.
</p>

<dl>
<dt>psDF</dt><dd><p>a data frame, part of original input data frame with variable
&quot;ID&quot;, &quot;time&quot; and &quot;count&quot;.</p>
</dd>
<dt>timeGrid</dt><dd><p>ordered distinct observation times in the set of all
observation times.</p>
</dd>
<dt>panelMatrix</dt><dd><p>a matrix representation of panel count data, one
row per subject, one column per time point in <code>"timeGrid"</code>.</p>
</dd>
</dl>

<p>In the case of <code>is.PanelSurv</code>, a logical value <code>TRUE</code> if
<code>x</code> inherits from class <code>"PanelSurv"</code>, otherwise an <code>FALSE</code>.
</p>
<p>In the case of <code>plot.PanelSurv</code>, a tile plot of
<code>panelMatrix</code> produced by package <code>ggplot2</code> with color
indicating number of counts since last observation time.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+panelReg">panelReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(blaTum)
response &lt;- with(blaTum, PanelSurv(id, time, count))
is.PanelSurv(response)
plot(response)
</code></pre>

<hr>
<h2 id='plot.panelReg'>Plot a <code>panelReg</code> Object.</h2><span id='topic+plot.panelReg'></span>

<h3>Description</h3>

<p>Plot the estimated baseline mean function. If <code>"se"</code> option of
<code>panelReg</code> is not <code>"NULL"</code>, 95
interval is also plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'panelReg'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.panelReg_+3A_x">x</code></td>
<td>
<p>The result of a call to the <code>panelReg</code> function.</p>
</td></tr>
<tr><td><code id="plot.panelReg_+3A_...">...</code></td>
<td>
<p>Other graphical parameters such as line type, color, or axis labels.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+panelReg">panelReg</a></code> <code><a href="#topic+panelReg.object">panelReg.object</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(blaTum)
## Plot the fit of bladder tumor data set
fm &lt;- PanelSurv(id, time, count) ~ num + size + treatment
fit1 &lt;- panelReg(fm, data=blaTum, method = "AEE", se = "Sandwich")
plot(fit1)

fit2 &lt;- panelReg(fm, data=blaTum, method = "MLs", se = "NULL")
plot(fit2)
</code></pre>

<hr>
<h2 id='plot.PanelSurv'>Produce Tile Plot</h2><span id='topic+plot.PanelSurv'></span>

<h3>Description</h3>

<p>Plot the tile plot from a <code>PanelSurv</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PanelSurv'
plot(x, heat = FALSE, order = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.PanelSurv_+3A_x">x</code></td>
<td>
<p>an object of class <code>PanelSurv</code>.</p>
</td></tr>
<tr><td><code id="plot.PanelSurv_+3A_heat">heat</code></td>
<td>
<p>an optional logical value indicating whether
a swimmer-plot-like tile plot will be produced.</p>
</td></tr>
<tr><td><code id="plot.PanelSurv_+3A_order">order</code></td>
<td>
<p>an optional logical value indicating whether the tile plot
will be sorted by the largest observationt time.</p>
</td></tr>
<tr><td><code id="plot.PanelSurv_+3A_...">...</code></td>
<td>
<p>future extension</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object
</p>

<hr>
<h2 id='skinTumor'>Skin cancer chemoprevention trial</h2><span id='topic+skinTumor'></span>

<h3>Description</h3>

<p>A data frame contains data on the recurrence of skin tumor.
The original data is available in Table A.3. of Sun and Zhao (2013).
This dataset contains records of 290 patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(skinTumor)
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>id</code></dt><dd><p>: patient id (repeated for each recurrence).</p>
</dd>
<dt><code>time</code></dt><dd><p>: observation time.</p>
</dd>
<dt><code>age</code></dt><dd><p>: patient's age at enrollment.</p>
</dd>
<dt><code>male</code></dt><dd><p>: gender; male = 1, female = 0.</p>
</dd>
<dt><code>dfmo</code></dt><dd><p>: treatment (DFMO) group = 1; placebo = 0.</p>
</dd>
<dt><code>priorTumor</code></dt><dd><p>: number of prior tumor from diagnosis to randomization.</p>
</dd>
<dt><code>countBC</code></dt><dd><p>: number of newly developed basal cell carcinomas tumors since
last observation time.</p>
</dd>
<dt><code>countSC</code></dt><dd><p>: number of newly developed squamous cell carcinomas
tumors since last observation time.</p>
</dd>
<dt><code>count</code></dt><dd><p>: number of newly developed non-melanoma tumors
since last observation time; this is equal to <code>countBC + countSC</code>.</p>
</dd>
</dl>


<h3>References</h3>

<p>Chiou, S., Xu, G., Yan, J., and Huang, C.-Y. (2017).
Semiparametric estimation of the accelerated mean model with panel count data under
informative examination times. <em>Biometrics</em>, to appear. &lt;doi: 10.1111/biom.12840&gt;.
</p>
<p>Sun, J. and Zhao, X. (2013). Statistical Analysis of Panel Count
Data. New York: Springer.
</p>


<h3>See Also</h3>

<p><code>skiTum</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(skinTumor)
library(ggplot2)
ggplot(skinTumor, aes(time, id, width = 25, height = 2)) +
    geom_tile(aes(fill = count)) + theme_bw() +
    facet_grid(dfmo ~ ., scales = "free_y", as.table = FALSE,
               labeller = labeller(dfmo = function(x) paste("DFMO =", x))) +
    scale_fill_gradient(low = "grey", high = "black") +
    scale_x_continuous(breaks = seq(0, 2000, 200)) +
    labs(fill = "Count") + xlab("Time in days")
</code></pre>

<hr>
<h2 id='skiTum'>A Simulated Data Mimicking a Skin Cancer Chemoprevention Trial</h2><span id='topic+skiTum'></span>

<h3>Description</h3>

<p>A data frame contains data on the recurrence of skin tumor.
This simulated data is created for illustrative purpose and it mimic
the Skin Cancer Chemoprevention Trial used in Chiou et al. (2017).
This data set contains records of 100 simulated patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(skiTum)
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>id</code></dt><dd><p>: patient id (repeated for each recurrence).</p>
</dd>
<dt><code>time</code></dt><dd><p>: observation time.</p>
</dd>
<dt><code>age</code></dt><dd><p>: patient's age at enrollment; age = 1 if greater
than 65, age = 0 otherwise.</p>
</dd>
<dt><code>male</code></dt><dd><p>: gender; male = 1, female = 0.</p>
</dd>
<dt><code>dfmo</code></dt><dd><p>: treatment (DFMO) group = 1; placebo = 0.</p>
</dd>
<dt><code>priorTumor</code></dt><dd><p>: number of prior tumor from diagnosis to randomization.</p>
</dd>
<dt><code>count</code></dt><dd><p>: number of new tumors since last observation time.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code>skinTumor</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(skiTum)
library(ggplot2)
skiTum$dfmo &lt;- factor(skiTum$dfmo, levels = c(1, 0), labels = c("placebo", "DFMO"))
ggplot(skiTum, aes(time, id, height = 2, width = 25)) +
    geom_tile(aes(fill = count)) + theme_bw() +
    facet_grid(dfmo ~ ., scales = "free_y") +
    scale_fill_gradient(low = "grey", high = "black") + labs(fill="Count") +
    scale_x_continuous(breaks = seq(0, 1800, 100)) + xlab("Time in days")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
