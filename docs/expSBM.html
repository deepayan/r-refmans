<!DOCTYPE html><html lang="en"><head><title>Help for package expSBM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {expSBM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#expSBM-package'>
<p>An Exponential Stochastic Block Model for Interaction Lengths</p></a></li>
<li><a href='#expSBM_ELBO'><p>expSBM_ELBO</p></a></li>
<li><a href='#expSBM_EM'><p>expSBM_EM</p></a></li>
<li><a href='#expSBM_init'><p>expSBM_init</p></a></li>
<li><a href='#expSBM_select'><p>expSBM_select</p></a></li>
<li><a href='#high_school'><p>Interactions between high school students</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>An Exponential Stochastic Block Model for Interaction Lengths</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-10-15</td>
</tr>
<tr>
<td>Description:</td>
<td>Given a continuous-time dynamic network, this package allows one to fit a stochastic blockmodel where nodes belonging to the same group create interactions and non-interactions of similar lengths. This package implements the methodology described by R. Rastelli and M. Fop (2019) &lt;<a href="https://doi.org/10.48550/arXiv.1901.09828">doi:10.48550/arXiv.1901.09828</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.10), mclust, gtools, blockmodels</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-15 15:29:54 UTC; riccardo</td>
</tr>
<tr>
<td>Author:</td>
<td>Riccardo Rastelli <a href="https://orcid.org/0000-0003-0982-2935"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Michael Fop <a href="https://orcid.org/0000-0003-3936-2757"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Riccardo Rastelli &lt;riccardoras@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-15 18:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='expSBM-package'>
An Exponential Stochastic Block Model for Interaction Lengths
</h2><span id='topic+expSBM-package'></span><span id='topic+expSBM'></span>

<h3>Description</h3>

<p>Given a continuous-time dynamic network, this package allows one to fit a stochastic blockmodel where nodes belonging to the same group create interactions and non-interactions of similar lengths. This package implements the methodology described by R. Rastelli and M. Fop (2019) &lt;arXiv:1901.09828&gt;.
</p>


<h3>Author(s)</h3>

<p>Riccardo Rastelli &lt;riccardoras@gmail.com&gt;
</p>
<p>Michael Fop &lt;michael.fop@ucd.ie&gt;
</p>


<h3>References</h3>

<p>R. Rastelli and M. Fop (2019) &quot;A dynamic stochastic blockmodel for interaction lengths&quot;, <a href="https://arxiv.org/abs/1901.09828">https://arxiv.org/abs/1901.09828</a>
</p>

<hr>
<h2 id='expSBM_ELBO'>expSBM_ELBO</h2><span id='topic+expSBM_ELBO'></span>

<h3>Description</h3>

<p>Evaluates the evidence lower bound for a given dynamic network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expSBM_ELBO(N, edgelist, Z, lambda, mu, nu, directed = F, trunc = T, verbose = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expSBM_ELBO_+3A_n">N</code></td>
<td>
<p>Number of nodes.</p>
</td></tr>
<tr><td><code id="expSBM_ELBO_+3A_edgelist">edgelist</code></td>
<td>
<p>A matrix with 4 columns: on the first column the sender node, on the second the receiver, on the third either a one or zero to indicate whether it is an interaction or a non-interaction respectively, on the fourth the corresponding exponential length.</p>
</td></tr>
<tr><td><code id="expSBM_ELBO_+3A_z">Z</code></td>
<td>
<p>A <code>NxK</code> matrix indicating a soft clustering of the nodes into the <code>K</code> latent groups. The generic entry in position <code>[i,k]</code> represents the posterior probability that node <code>i</code> belongs to group <code>k</code>.</p>
</td></tr>
<tr><td><code id="expSBM_ELBO_+3A_lambda">lambda</code></td>
<td>
<p>Mixing proportions of the latent groups.</p>
</td></tr>
<tr><td><code id="expSBM_ELBO_+3A_mu">mu</code></td>
<td>
<p>A matrix of size <code>KxK</code> indicating the exponential rates for the interaction lengths, for each pair of groups. Must be a symmetric matrix if <code>directed</code> is false.</p>
</td></tr>
<tr><td><code id="expSBM_ELBO_+3A_nu">nu</code></td>
<td>
<p>A matrix of size <code>KxK</code> indicating the exponential rates for the non-interaction lengths, for each pair of groups. Must be a symmetric matrix if <code>directed</code> is false.</p>
</td></tr>
<tr><td><code id="expSBM_ELBO_+3A_directed">directed</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether interactions have an orientation or not.</p>
</td></tr>
<tr><td><code id="expSBM_ELBO_+3A_trunc">trunc</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether the first and last interactions or non-interactions for every edge are assumed to be truncated or not.</p>
</td></tr>
<tr><td><code id="expSBM_ELBO_+3A_verbose">verbose</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether a lengthy output should be printed out.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>computing_time</code></td>
<td>
<p>Number of seconds required for the evaluation.</p>
</td></tr>
<tr><td><code>elbo_value</code></td>
<td>
<p>Value of the evidence lower bound for the given variational parameters.</p>
</td></tr>
</table>

<hr>
<h2 id='expSBM_EM'>expSBM_EM</h2><span id='topic+expSBM_EM'></span>

<h3>Description</h3>

<p>Runs the variational expectation maximization algorithm for a given number of latent groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expSBM_EM(N, edgelist, Z, lambda, mu, nu, directed = F, trunc = T, 
          tol = 0.001, n_iter_max = 100, verbose = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expSBM_EM_+3A_n">N</code></td>
<td>
<p>Number of nodes.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_edgelist">edgelist</code></td>
<td>
<p>A matrix with 4 columns: on the first column the sender node, on the second the receiver, on the third either a one or zero to indicate whether it is an interaction or a non-interaction respectively, on the fourth the corresponding exponential length.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_z">Z</code></td>
<td>
<p>A <code>NxK</code> matrix indicating a soft clustering of the nodes into the <code>K</code> latent groups. The generic entry in position <code>[i,k]</code> represents the posterior probability that node <code>i</code> belongs to group <code>k</code>.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_lambda">lambda</code></td>
<td>
<p>Mixing proportions of the latent groups.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_mu">mu</code></td>
<td>
<p>A matrix of size <code>KxK</code> indicating the exponential rates for the interaction lengths, for each pair of groups. Must be a symmetric matrix if <code>directed</code> is false.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_nu">nu</code></td>
<td>
<p>A matrix of size <code>KxK</code> indicating the exponential rates for the non-interaction lengths, for each pair of groups. Must be a symmetric matrix if <code>directed</code> is false.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_directed">directed</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether interactions have an orientation or not.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_trunc">trunc</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether the first and last interactions or non-interactions for every edge are assumed to be truncated or not.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_tol">tol</code></td>
<td>
<p>Stop the maximization if the relative increase in the objective function is not larger than this value.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_n_iter_max">n_iter_max</code></td>
<td>
<p>Stop the maximization if the number of iterations is larger than this value. This parameter can be set to zero or one for debug purposes.</p>
</td></tr>
<tr><td><code id="expSBM_EM_+3A_verbose">verbose</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether a lengthy output should be printed out.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>computing_time</code></td>
<td>
<p>Number of seconds required for the evaluation.</p>
</td></tr>
<tr><td><code>elbo_values</code></td>
<td>
<p>Stored values of the objective function at each iteration.</p>
</td></tr>
<tr><td><code>Z_star</code></td>
<td>
<p>Optimal soft clustering of the nodes into the groups.</p>
</td></tr>
<tr><td><code>lambda_star</code></td>
<td>
<p>Optimal mixing proportions.</p>
</td></tr>
<tr><td><code>mu_star</code></td>
<td>
<p>Optimal group-specific parameters for the exponential rates of the interaction lengths.</p>
</td></tr>
<tr><td><code>nu_star</code></td>
<td>
<p>Optimal group-specific parameters for the exponential rates of the non-interaction lengths.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
data(high_school)
K &lt;- 4
lambda_init &lt;- rep(1/K,K)
Z_init &lt;- expSBM_init(high_school$edgelist, K, "random")
mu_init &lt;- nu_init &lt;- matrix(1,K,K)
expSBM_EM(N = 327, high_school$edgelist, Z_init, lambda_init, mu_init, nu_init)
</code></pre>

<hr>
<h2 id='expSBM_init'>expSBM_init</h2><span id='topic+expSBM_init'></span>

<h3>Description</h3>

<p>Initialization step for the variational expectation maximization algorithm. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expSBM_init(edgelist, K, 
   method = c("random", "SBM_binary", "SBM_gaussian", "spectral"), 
   sbm_density = 0.5, blur_value = 1) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expSBM_init_+3A_edgelist">edgelist</code></td>
<td>
<p>A matrix with 4 columns: on the first column the sender node, on the second the receiver, on the third either a one or zero to indicate whether it is an interaction or a non-interaction respectively, on the fourth the corresponding exponential length.</p>
</td></tr>
<tr><td><code id="expSBM_init_+3A_k">K</code></td>
<td>
<p>Number of latent groups.</p>
</td></tr>
<tr><td><code id="expSBM_init_+3A_method">method</code></td>
<td>
<p>Method used to initialise the allocations. Can be one of <code>random</code>, <code>SBM_binary</code>, <code>SBM_gaussian</code> or <code>spectral</code>. See details.</p>
</td></tr>
<tr><td><code id="expSBM_init_+3A_sbm_density">sbm_density</code></td>
<td>
<p>If <code>method == "SBM_binary"</code>, this is the target density for the thresholded binary stochastic blockmodel.</p>
</td></tr>
<tr><td><code id="expSBM_init_+3A_blur_value">blur_value</code></td>
<td>
<p>A value between 0 and 1. If 1, the initialization method returns a hard partition where each node belongs to one group and one only. Reducing this value introduces noise, i.e. it gradually transforms the hard clustering into a soft clustering where each node is equally likely to belong to any of the K given clusters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All initialisation methods return a <code>NxK</code> matrix indicating the partitioning of the nodes.
</p>
<p>The method <code>random</code> intialises the allocation variables uniformly at random.
</p>
<p>The method <code>SBM_binary</code> first calculates the aggregated interaction and non-interaction times for each pair of nodes. Then, it calculates the portion of time when the nodes where interacting over the whole time period. Then it obtains an adjacency matrix by thresholding these values, i.e. values above a given threshold are replaced by ones and values below the threshold are replaced by zeros. The threshold is chosen by setting the parameter <code>sbm_density</code> which defines the desired density of the graph. Once the adjacency matrix is obtained, a binary stochastic blockmodel is fit on the data hence obtaining the partition.
</p>
<p>The method <code>SBM_gaussian</code> aggregates the interaction values and non-interaction values for each pair of nodes. Then it log-transforms both of these quantities. Then it fits a stochastic blockmodel with multivariate Gaussian edges to obtain the partition.
</p>
<p>The method <code>spectral</code> first calculates the aggregated interaction and non-interaction times for each pair of nodes. Then, it calculates the portion of time when the nodes where interacting over the whole time period. Then it performs model-based clustering on the Laplacian associated to this weighted matrix.
</p>


<h3>Value</h3>

<p>A <code>NxK</code> matrix indicating the partitioning of the nodes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
data(high_school)
K &lt;- 4
lambda_init &lt;- rep(1/K,K)
expSBM_init(high_school$edgelist, K, "random")
</code></pre>

<hr>
<h2 id='expSBM_select'>expSBM_select</h2><span id='topic+expSBM_select'></span>

<h3>Description</h3>

<p>Runs the variational expectation maximization algorithm for different numbers of latent groups, and selects the best overall model using the integrated completed likelihood criterion. See reference for a detailed explanation of the procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expSBM_select(K_max, N, edgelist, method = "SBM_gaussian", directed = F, 
              trunc = T, tol = 0.001, n_iter_max = 100, 
              init_blur_value = 1, verbose = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expSBM_select_+3A_k_max">K_max</code></td>
<td>
<p>Estimate and compare the models with number of latent groups equal to 1,2,...,<code>K_max</code>.</p>
</td></tr>
<tr><td><code id="expSBM_select_+3A_n">N</code></td>
<td>
<p>Number of nodes.</p>
</td></tr>
<tr><td><code id="expSBM_select_+3A_edgelist">edgelist</code></td>
<td>
<p>A matrix with 4 columns: on the first column the sender node, on the second the receiver, on the third either a one or zero to indicate whether it is an interaction or a non-interaction respectively, on the fourth the corresponding exponential length.</p>
</td></tr>
<tr><td><code id="expSBM_select_+3A_method">method</code></td>
<td>
<p>Indicates the method used for the initialisation. Can be one of <code>random</code>, <code>SBM_binary</code>, <code>SBM_gaussian</code> or <code>spectral</code>. See <code><a href="#topic+expSBM_init">expSBM_init</a></code> for more details.</p>
</td></tr>
<tr><td><code id="expSBM_select_+3A_directed">directed</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether interactions have an orientation or not.</p>
</td></tr>
<tr><td><code id="expSBM_select_+3A_trunc">trunc</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether the first and last interactions or non-interactions for every edge are assumed to be truncated or not.</p>
</td></tr>
<tr><td><code id="expSBM_select_+3A_tol">tol</code></td>
<td>
<p>Stop the maximization if the relative increase in the objective function is not larger than this value.</p>
</td></tr>
<tr><td><code id="expSBM_select_+3A_n_iter_max">n_iter_max</code></td>
<td>
<p>Stop the maximization if the number of iterations is larger than this value. This parameter can be set to zero or one for debug purposes.</p>
</td></tr>
<tr><td><code id="expSBM_select_+3A_init_blur_value">init_blur_value</code></td>
<td>
<p>A value from zero to one, indicating if the initialized partition should be perturbed with noise. The value one means no noise, whereas the value zero has maximum noise, i.e. each node is equally likely belonging to any of the K groups.</p>
</td></tr>
<tr><td><code id="expSBM_select_+3A_verbose">verbose</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating whether a lengthy output should be printed out.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>fitted_models</code></td>
<td>
<p>A list with the fitted values for every model considered.</p>
</td></tr>
<tr><td><code>icl_values</code></td>
<td>
<p>Integrated completed likelihood values for each model considered.</p>
</td></tr>
<tr><td><code>K_star</code></td>
<td>
<p>Optimal number of latent groups, according to the integrated completed likelihood criterion.</p>
</td></tr>
<tr><td><code>best_model</code></td>
<td>
<p>Output of the variational expectation maximization algorithm for the best overall model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>R. Rastelli and M. Fop (2019) &quot;A dynamic stochastic blockmodel for interaction lengths&quot;, <a href="https://arxiv.org/abs/1901.09828">https://arxiv.org/abs/1901.09828</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
data(high_school)

res &lt;- expSBM_select(K_max = 8, N = 327, edgelist = high_school$edgelist, 
     method = "random", tol = 0.01)

</code></pre>

<hr>
<h2 id='high_school'>Interactions between high school students</h2><span id='topic+high_school'></span>

<h3>Description</h3>

<p>The data concern face to face interactions among 327 high school students in Marseilles,
France, and were collected by means of wearable sensors over a period of 5 days in December 2013.
Students wore a sensor badge on their chest and the instrument recorded when they were facing each
other with a time resolution of 20 seconds. Thus, any pair of students was considered interacting
face-to-face when the sensors of the two were exchanging data packets at any given time during the
20 seconds interval.
Additional information on the students is available from the same dataset. Students may have 4
different main specializations: biology (BIO), mathematics and physics (MP), physics and chemistry
(PC), and engineering studies (PSI).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(high_school)</code></pre>


<h3>Format</h3>

<p>The list contains:
</p>

<dl>
<dt>adj</dt><dd><p>An adjacency list indicating whether any pair of students had at least one interaction during the 5 days of the study.</p>
</dd>
<dt>edgelist</dt><dd><p>An edgelist in a format that can be handled by this package.</p>
</dd>
<dt>program</dt><dd><p>Clustering variable indicating the program each student is registered to.</p>
</dd>
<dt>program_levels</dt><dd><p>Names of the different programs.</p>
</dd>
<dt>program_aggr</dt><dd><p>Aggregated version of the previous clustering variable, where programs are aggregated into 4 areas.</p>
</dd>
<dt>program_levels_aggr</dt><dd><p>Names of the different areas, these correspond to biology (BIO), mathematics and physics (MP), physics and chemistry (PC), and engineering studies (PSI)</p>
</dd>
<dt>sex</dt><dd><p>Clustering given by the sex of the students.</p>
</dd>
<dt>sex_levels</dt><dd><p>Labels for each of the sex classes.</p>
</dd>
</dl>



<h3>References</h3>

<p>R. Mastrandrea, J. Fournet, and A. Barrat (2015). &quot;Contact patterns in a high school: A comparison between data collected using wearable sensors, contact diaries and friendship surveys&quot;.
<em>PLOS ONE 10.9, pp. 1-26</em>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
