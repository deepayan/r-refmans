<!DOCTYPE html><html lang="en"><head><title>Help for package samadb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {samadb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#samadb-package'><p>South Africa Macroeconomic Database API</p></a></li>
<li><a href='#.SAMADB_ID'><p>Global Identifier Macros</p></a></li>
<li><a href='#sm_as_date'><p>Coerce Vectors to Dates</p></a></li>
<li><a href='#sm_data'><p>Retrieve Data from the Database</p></a></li>
<li><a href='#sm_datasets'><p>Retrieve Datasets Table</p></a></li>
<li><a href='#sm_datasources'><p>Retrieve Data Sources Table</p></a></li>
<li><a href='#sm_expand_date'><p>Generate Temporal Identifiers from a Date Column</p></a></li>
<li><a href='#sm_pivot_longer'><p>Reshape Column-Based Data to Long Format</p></a></li>
<li><a href='#sm_pivot_wider'><p>Reshape Long API Data to Column-Based Format</p></a></li>
<li><a href='#sm_series'><p>Retrieve Series Table</p></a></li>
<li><a href='#sm_transpose'><p>Transpose a Wide Dataset to a Row-Based Format</p></a></li>
<li><a href='#sm_write_excel'><p>Export Wide Data to Excel</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>South Africa Macroeconomic Database API</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>An R API providing access to a relational database with macroeconomic time series data for South Africa,
 obtained from the South African Reserve Bank (SARB) and Statistics South Africa (STATSSA), and updated on a weekly basis
 via the EconData <a href="https://www.econdata.co.za/">https://www.econdata.co.za/</a> platform and automated scraping of the SARB and STATSSA websites.
 The database is maintained at the Department of Economics at Stellenbosch University.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Stellenbosch-Econometrics/SAMADB-Issues/issues">https://github.com/Stellenbosch-Econometrics/SAMADB-Issues/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>DBI, RMySQL, writexl, data.table, collapse (&ge; 2.0.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-24 15:59:22 UTC; sebastiankrantz</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastian Krantz [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastian Krantz &lt;sebastian.krantz@graduateinstitute.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-24 18:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='samadb-package'>South Africa Macroeconomic Database API</h2><span id='topic+samadb-package'></span><span id='topic+samadb'></span>

<h3>Description</h3>

<p>An R API providing access to a relational database with public macroeconomic data for South Africa, obtained from
from the South African Reserve Bank (SARB) and Statistics South Africa (STATSSA), and updated on a regular basis via the
EconData (https://www.econdata.co.za/) platform and automated scraping of the SARB and STATSSA websites.
The database is maintained at the Department of Economics at Stellenbosch University.
</p>


<h3>Functions</h3>

<p>Functions and data providing information about the available data
</p>
<p><code><a href="#topic+sm_datasources">sm_datasources()</a></code><br />
<code><a href="#topic+sm_datasets">sm_datasets()</a></code><br />
<code><a href="#topic+sm_series">sm_series()</a></code>
</p>
<p>Function to retrieve the data from the database
</p>
<p><code><a href="#topic+sm_data">sm_data()</a></code>
</p>
<p>Functions to reshape data and add temporal identifiers
</p>
<p><code><a href="#topic+sm_pivot_wider">sm_pivot_wider()</a></code><br />
<code><a href="#topic+sm_pivot_longer">sm_pivot_longer()</a></code><br />
<code><a href="#topic+sm_expand_date">sm_expand_date()</a></code>
</p>
<p>Function to export wide format data to Excel
</p>
<p><code><a href="#topic+sm_write_excel">sm_write_excel()</a></code><br />
</p>
<p>Helper functions to convert inputs to R dates and transpose the data
</p>
<p><code><a href="#topic+sm_as_date">sm_as_date()</a></code><br />
<code><a href="#topic+sm_transpose">sm_transpose()</a></code><br />
</p>
<p>Global Macros with core ID variables in the database
</p>
<p><code><a href="#topic+.SAMADB_ID">.SAMADB_ID</a></code><br />
<code><a href="#topic+.SAMADB_T">.SAMADB_T</a></code>
</p>

<hr>
<h2 id='.SAMADB_ID'>Global Identifier Macros</h2><span id='topic+.SAMADB_ID'></span><span id='topic+.SAMADB_T'></span>

<h3>Description</h3>

<p>The macro <code>.SAMADB_ID</code> contains the string <code>c("dsid", "series")</code> denoting
the names of ID variables that identify the cross-sectional dimension in the database. All series codes are unique across datasets.
</p>
<p>The macro <code>.SAMADB_T</code> contains the string
<code>c("date", "year", "quarter", "month", "day")</code> denoting temporal identifiers generated by <code><a href="#topic+sm_expand_date">sm_expand_date</a></code>.
The <code>"date"</code> variable is sufficient to uniquely identify a point in time in the database.
</p>
<p>Each value in the database is uniquely identified by dsid, series and date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.SAMADB_ID
.SAMADB_T
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>.SAMADB_ID
.SAMADB_T


</code></pre>

<hr>
<h2 id='sm_as_date'>Coerce Vectors to Dates</h2><span id='topic+sm_as_date'></span>

<h3>Description</h3>

<p>This function coerces date strings i.e. <code>"YYYY-MM-DD"</code> or <code>"YYYY-MM"</code>, years e.g. <code>2015</code> (numeric or character),
year-quarters e.g. <code>"2015Q1"</code> or <code>"2015-Q1"</code>, year-months e.g. <code>"2015M01"</code> or <code>"2015-M01"</code> or numeric values representing dates (e.g. previously imported Excel date) to a regular R date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_as_date(x, end = FALSE, origin = "1899-12-30")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_as_date_+3A_x">x</code></td>
<td>
<p>a character date string <code>"YYYY-MM-DD"</code> or <code>"YYYY-MM"</code>, year-quarter <code>"YYYYQN"</code> or <code>"YYYY-QN"</code>, year-month <code>"YYYYMNN"</code> or <code>"YYYY-MNN"</code> or calendar year <code>YYYY</code> (numeric or character), or a numeric value corresponding to a date that can be passed to <code><a href="base.html#topic+as.Date.numeric">as.Date.numeric</a></code>.</p>
</td></tr>
<tr><td><code id="sm_as_date_+3A_end">end</code></td>
<td>
<p>logical. <code>TRUE</code> replaces missing time information with a period end-date which is the last day of the period. <code>FALSE</code> replaces missing month and day information with <code>"-01"</code>,
so the year date is the 1st of January, and for months / quarters the 1st day of the month / quarter.</p>
</td></tr>
<tr><td><code id="sm_as_date_+3A_origin">origin</code></td>
<td>
<p>a date or date-string that can be used as reference for converting numeric values to dates. The default corresponds to dates generated in Excel for Windows. See <code><a href="base.html#topic+as.Date.numeric">as.Date.numeric</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+Date">Date</a></code> vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sm_expand_date">sm_expand_date</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sm_as_date("2011-05")
sm_as_date(2011)
sm_as_date("2011Q1")
sm_as_date("2011Q1", end = TRUE)
sm_as_date("2011M2")
sm_as_date("2011M2", end = TRUE)

</code></pre>

<hr>
<h2 id='sm_data'>Retrieve Data from the Database</h2><span id='topic+sm_data'></span>

<h3>Description</h3>

<p>This is the main function of the package to retrieve data from the database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_data(
  dsid = NULL,
  series = NULL,
  from = NULL,
  to = NULL,
  freq = NULL,
  labels = TRUE,
  wide = TRUE,
  expand.date = FALSE,
  ordered = TRUE,
  return.query = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_data_+3A_dsid">dsid</code></td>
<td>
<p>character. (Optional) id's of datasets matching the 'dsid' column of the 'DATASET' table (retrieved using <code><a href="#topic+sm_datasets">sm_datasets()</a></code>). If used, all series from the dataset are returned, in addition to any other series selected with <code>series</code>.</p>
</td></tr>
<tr><td><code id="sm_data_+3A_series">series</code></td>
<td>
<p>character. (Optional) codes of series matching the 'series' column of the 'SERIES' table (retrieved using <code><a href="#topic+sm_series">sm_series()</a></code>). If 'dsid' is also specificed, the two are combined using SQL 'OR' i.e. these series are retrieved in addition to all series matched through 'dsid'.</p>
</td></tr>
<tr><td><code id="sm_data_+3A_from">from</code></td>
<td>
<p>set the start time of the data retrieved by either supplying a start date, a date-string of the form <code>"YYYY-MM-DD"</code> or <code>"YYYY-MM"</code>,
year-quarters of the form <code>"YYYYQN"</code> or <code>"YYYY-QN"</code>, or a numeric year <code>YYYY</code> (numeric or character). These expressions are converted to a regular date by <code><a href="#topic+sm_as_date">sm_as_date</a></code>.</p>
</td></tr>
<tr><td><code id="sm_data_+3A_to">to</code></td>
<td>
<p>same as <code>from</code>: to set the time period until which data is retrieved. For expressions that are not full &quot;YYYY-MM-DD&quot; dates, the last day of the period is chosen.</p>
</td></tr>
<tr><td><code id="sm_data_+3A_freq">freq</code></td>
<td>
<p>character. Return only series at a certain frequency. Allowed are values <code>"D"</code> (Daily), <code>"W"</code> (Weekly), <code>"M"</code> (Monthly), <code>"Q"</code> (Quarterly), <code>"A"</code> (Annual), <code>"AF"</code> (Fiscal Years), matching the 'freq' column in the 'SERIES' table (retrieved using <code><a href="#topic+sm_series">sm_series()</a></code>).</p>
</td></tr>
<tr><td><code id="sm_data_+3A_labels">labels</code></td>
<td>
<p>logical. <code>TRUE</code> will also return labels (series descriptions) along with the series codes.</p>
</td></tr>
<tr><td><code id="sm_data_+3A_wide">wide</code></td>
<td>
<p>logical. <code>TRUE</code> calls <code><a href="#topic+sm_pivot_wider">sm_pivot_wider</a></code> on the result. <code>FALSE</code> returns the data in a long format without missing values (suitable for <code>ggplot2</code>).</p>
</td></tr>
<tr><td><code id="sm_data_+3A_expand.date">expand.date</code></td>
<td>
<p>logical. <code>TRUE</code> will call <code><a href="#topic+sm_expand_date">sm_expand_date</a></code> on the result.</p>
</td></tr>
<tr><td><code id="sm_data_+3A_ordered">ordered</code></td>
<td>
<p>logical. <code>TRUE</code> orders the result by 'date' and, if <code>!is.null(dsid)</code>, <code>labels = TRUE</code> or <code>!is.null(freq)</code>, by series, maintaining a fixed order of series.
<code>FALSE</code> does not explicitly order the result, to the benefit of faster query execution.</p>
</td></tr>
<tr><td><code id="sm_data_+3A_return.query">return.query</code></td>
<td>
<p>logical. <code>TRUE</code> will not query the database but instead return the constructed SQL query as a character string (for debugging purposes).</p>
</td></tr>
<tr><td><code id="sm_data_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="#topic+sm_pivot_wider">sm_pivot_wider</a></code> (if <code>wide = TRUE</code>) or <code><a href="#topic+sm_expand_date">sm_expand_date</a></code> (if <code>expand.date = TRUE</code>), no conflicts between these two.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Series from datasets at different frequencies can be queried, but, if <code>wide = TRUE</code>, this will result in missing values in the lower frequency series.
</p>


<h3>Value</h3>

<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code> with the result of the query.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sm_pivot_wider">sm_pivot_wider</a></code>, <code><a href="#topic+sm_expand_date">sm_expand_date</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Return all electricity indicators from 2000
sm_data("ELECTRICITY", from = 2000)


</code></pre>

<hr>
<h2 id='sm_datasets'>Retrieve Datasets Table</h2><span id='topic+sm_datasets'></span>

<h3>Description</h3>

<p>This function pulls and return a table called 'DATASET' from the database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_datasets(ordered = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_datasets_+3A_ordered">ordered</code></td>
<td>
<p>logical. <code>TRUE</code> orders the result in the order data was entered into the database, while <code>FALSE</code> returns the result in a random order, to the benefit of faster query execution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'DATASET' table gives information about the different datasets fetched from different providers at regular intervals.
It provides a unique id for each dataset, the frequency of data, the number of records (datapoints) in each dataset,
the minimum and maximum time coverage, when the dataset was last updated, and information about the data source, provider,
and method of data access.
</p>


<h3>Value</h3>

<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code> with information about the available datasets in the database.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sm_datasources">sm_datasources</a></code>, <code><a href="#topic+sm_series">sm_series</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sm_datasets()

</code></pre>

<hr>
<h2 id='sm_datasources'>Retrieve Data Sources Table</h2><span id='topic+sm_datasources'></span>

<h3>Description</h3>

<p>This function pulls and returns a table called 'DATASOURCE' from the database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_datasources(ordered = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_datasources_+3A_ordered">ordered</code></td>
<td>
<p>logical. <code>TRUE</code> orders the result in the order data was entered into the database, while <code>FALSE</code> returns the result in a random order, to the benefit of faster query execution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'DATASOURCE' table gives information about the sources of data in this database, including the source website, and the number of datasets available from the source.
</p>


<h3>Value</h3>

<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code> with information about the sources of data in the database.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sm_datasets">sm_datasets</a></code>, <code><a href="#topic+sm_series">sm_series</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sm_datasources()

</code></pre>

<hr>
<h2 id='sm_expand_date'>Generate Temporal Identifiers from a Date Column</h2><span id='topic+sm_expand_date'></span>

<h3>Description</h3>

<p>This function expands a date column and generates additional temporal identifiers from it (year, month, quarter, day).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_expand_date(
  x,
  gen = c("year", "quarter", "month"),
  origin = "1899-12-30",
  keep.date = TRUE,
  remove.missing.date = TRUE,
  sort = TRUE,
  as.factor = TRUE,
  name = "date",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_expand_date_+3A_x">x</code></td>
<td>
<p>either a vector of class 'Date', or coercible to date using <code><a href="base.html#topic+as.Date">as.Date</a></code>, or a data frame / list containing with a date-column called <code>name</code>.</p>
</td></tr>
<tr><td><code id="sm_expand_date_+3A_gen">gen</code></td>
<td>
<p>character. A vector of identifiers to generate from <code>x</code>. The possible identifiers are found in <code><a href="#topic+.SAMADB_T">.SAMADB_T</a></code>.</p>
</td></tr>
<tr><td><code id="sm_expand_date_+3A_origin">origin</code></td>
<td>
<p>character / Date. Passed to <code><a href="base.html#topic+as.Date">as.Date</a></code>: for converting numeric <code>x</code> to date. The default reflects converting date-numbers from Excel for Windows.</p>
</td></tr>
<tr><td><code id="sm_expand_date_+3A_keep.date">keep.date</code></td>
<td>
<p>logical. <code>TRUE</code> will keep the date variable in the resulting dataset, <code>FALSE</code> will remove the date variable in favor of the generated identifiers.</p>
</td></tr>
<tr><td><code id="sm_expand_date_+3A_remove.missing.date">remove.missing.date</code></td>
<td>
<p>logical. <code>TRUE</code> will remove missing values in <code>x</code>. If <code>x</code> is a dataset, rows missing the date variable will be removed.</p>
</td></tr>
<tr><td><code id="sm_expand_date_+3A_sort">sort</code></td>
<td>
<p>logical. <code>TRUE</code> will sort the data by the date column.</p>
</td></tr>
<tr><td><code id="sm_expand_date_+3A_as.factor">as.factor</code></td>
<td>
<p><code>TRUE</code> will generate quarters and months as factor variables. It is also possible to use <code>as.factor = "ordered"</code> to generate ordered factors. <code>FALSE</code> will generate quarters and months as integer variables.</p>
</td></tr>
<tr><td><code id="sm_expand_date_+3A_name">name</code></td>
<td>
<p>character. The name of the date variable to expand.</p>
</td></tr>
<tr><td><code id="sm_expand_date_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code> containing the computed identifiers as columns. See Examples.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sm_as_date">sm_as_date</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># First a basic example
x &lt;- seq.Date(as.Date("1999-01-01"), as.Date("2000-01-01"), by = "month")
sm_expand_date(x)
sm_expand_date(x, gen = .SAMADB_T[-1L], keep.date = FALSE)

# Now using the API
sm_expand_date(sm_data("BUSINESS_CYCLES"))

# Same thing
sm_data("BUSINESS_CYCLES", expand.date = TRUE)


</code></pre>

<hr>
<h2 id='sm_pivot_longer'>Reshape Column-Based Data to Long Format</h2><span id='topic+sm_pivot_longer'></span>

<h3>Description</h3>

<p>This function automatically reshapes wide (column-based) data into a long format akin to the format of the raw data coming from the database (<code><a href="#topic+sm_data">sm_data(..., wide = FALSE)</a></code>).
Internally it uses <code><a href="data.table.html#topic+melt">melt</a></code> from <em>data.table</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_pivot_longer(
  data,
  id_cols = intersect(.SAMADB_T, names(data)),
  to_value = setdiff(names(data), id_cols),
  variable_name = "series",
  value_name = "value",
  label_name = "label",
  na.rm = TRUE,
  variable.factor = TRUE,
  label.factor = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_pivot_longer_+3A_data">data</code></td>
<td>
<p>a wide format data frame where all series have their own column.</p>
</td></tr>
<tr><td><code id="sm_pivot_longer_+3A_id_cols">id_cols</code></td>
<td>
<p>character. Temporal identifiers of the data. By default all variables in <code><a href="#topic+.SAMADB_T">.SAMADB_T</a></code> are selected.</p>
</td></tr>
<tr><td><code id="sm_pivot_longer_+3A_to_value">to_value</code></td>
<td>
<p>character. The names of all series to be stacked into the long format data frame.</p>
</td></tr>
<tr><td><code id="sm_pivot_longer_+3A_variable_name">variable_name</code></td>
<td>
<p>character. The name of the variable to store the names of the series.</p>
</td></tr>
<tr><td><code id="sm_pivot_longer_+3A_value_name">value_name</code></td>
<td>
<p>character. The name of the variable to store the data values.</p>
</td></tr>
<tr><td><code id="sm_pivot_longer_+3A_label_name">label_name</code></td>
<td>
<p>character. The name of the variable to store the series labels.</p>
</td></tr>
<tr><td><code id="sm_pivot_longer_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. <code>TRUE</code> will remove all missing values from the long data frame.</p>
</td></tr>
<tr><td><code id="sm_pivot_longer_+3A_variable.factor">variable.factor</code>, <code id="sm_pivot_longer_+3A_label.factor">label.factor</code></td>
<td>
<p>logical. <code>TRUE</code> will code the &quot;series&quot; and &quot;label&quot; columns as factors, which is more memory efficient.</p>
</td></tr>
<tr><td><code id="sm_pivot_longer_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="data.table.html#topic+melt">melt</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code> with the reshaped data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sm_pivot_wider">sm_pivot_wider</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Return all electricity indicators from the year 2000 onwards
data &lt;- sm_data("ELECTRICITY", from = 2000)
sm_pivot_longer(data)

</code></pre>

<hr>
<h2 id='sm_pivot_wider'>Reshape Long API Data to Column-Based Format</h2><span id='topic+sm_pivot_wider'></span>

<h3>Description</h3>

<p>This function automatically reshapes long (stacked) raw data from the API (<code><a href="#topic+sm_data">sm_data(..., wide = FALSE)</a></code>) to a wide format where each variable has its own column.
Internally it uses <code><a href="collapse.html#topic+pivot">pivot</a></code> from <em>collapse</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_pivot_wider(
  data,
  id_cols = intersect(.SAMADB_T, names(data)),
  names_from = "series",
  values_from = "value",
  labels_from = if (any(names(data) == "label")) "label" else NULL,
  expand.date = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_pivot_wider_+3A_data">data</code></td>
<td>
<p>raw data from the API: A long format data frame where all values are stacked in a value column.</p>
</td></tr>
<tr><td><code id="sm_pivot_wider_+3A_id_cols">id_cols</code></td>
<td>
<p>character. Temporal identifiers of the data. By default all variables in <code><a href="#topic+.SAMADB_T">.SAMADB_T</a></code> are selected.</p>
</td></tr>
<tr><td><code id="sm_pivot_wider_+3A_names_from">names_from</code></td>
<td>
<p>character. The column containing the series codes. These will become the names of the new columns in the wider data format.</p>
</td></tr>
<tr><td><code id="sm_pivot_wider_+3A_values_from">values_from</code></td>
<td>
<p>character. The column containing the data values.</p>
</td></tr>
<tr><td><code id="sm_pivot_wider_+3A_labels_from">labels_from</code></td>
<td>
<p>character. The column containing the labels describing the series.</p>
</td></tr>
<tr><td><code id="sm_pivot_wider_+3A_expand.date">expand.date</code></td>
<td>
<p>logical. <code>TRUE</code> will call <code><a href="#topic+sm_expand_date">sm_expand_date</a></code> on the data after reshaping.</p>
</td></tr>
<tr><td><code id="sm_pivot_wider_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="collapse.html#topic+pivot">pivot</a></code> or <code><a href="#topic+sm_expand_date">sm_expand_date</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code> with the reshaped data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sm_pivot_longer">sm_pivot_longer</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Return all electricity indicators from the year 2000 onwards
sm_pivot_wider(sm_data("ELECTRICITY", from = 2000, wide = FALSE))

</code></pre>

<hr>
<h2 id='sm_series'>Retrieve Series Table</h2><span id='topic+sm_series'></span>

<h3>Description</h3>

<p>This function pulls the 'SERIES' table from the database, providing information about the time series in the database. Each series is given a code which unique across datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_series(
  dsid = NULL,
  series = NULL,
  dataset.info = FALSE,
  ordered = TRUE,
  return.query = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_series_+3A_dsid">dsid</code></td>
<td>
<p>character. (Optional) id's of datasources matching the 'dsid' column of the 'DATASET' table (retrieved using <code><a href="#topic+sm_datasets">sm_datasets()</a></code>) for which series information is to be returned.</p>
</td></tr>
<tr><td><code id="sm_series_+3A_series">series</code></td>
<td>
<p>character. (Optional) codes of series for which information in to be returned. If 'dsid' is also specificed, the two are combined using SQL 'OR' i.e. these series are retrieved in addition to all series matched through 'dsid'.</p>
</td></tr>
<tr><td><code id="sm_series_+3A_dataset.info">dataset.info</code></td>
<td>
<p>logical. <code>TRUE</code> returns additional information from the 'DATASET' table (the dataset name, when data was last updated, the source id and the data provider and access mode).</p>
</td></tr>
<tr><td><code id="sm_series_+3A_ordered">ordered</code></td>
<td>
<p>logical. <code>TRUE</code> returns the series in a fixed order, while <code>FALSE</code> returns the result in a random order, to the benefit of faster query execution.</p>
</td></tr>
<tr><td><code id="sm_series_+3A_return.query">return.query</code></td>
<td>
<p>logical. <code>TRUE</code> will not query the database but instead return the constructed SQL query as a character string (for debugging purposes).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each series is given a code which is unique across datasets.
Each series also has a label describing the series. Further information recorded are the series frequency, unit, whether it was seasonally adjusted, number of observations,
minimum and maximum date, and (optionally) topic, alternative code provided by the data source (data retrieved from EconData uses EconData codes as series codes, so the 'src_code'
field gives the codes used by the SARB or STATSSA), or further comments on the series.
</p>


<h3>Value</h3>

<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code> with information about the available series in the database.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sm_datasources">sm_datasources</a></code>, <code><a href="#topic+sm_datasets">sm_datasets</a></code>, <code><a href="#topic+sm_data">sm_data</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# By default returns all series
sm_series()

# Adding information about the dataset and provider
sm_series(dataset.info = TRUE)

# Only series in the QB
sm_series("QB")

</code></pre>

<hr>
<h2 id='sm_transpose'>Transpose a Wide Dataset to a Row-Based Format</h2><span id='topic+sm_transpose'></span>

<h3>Description</h3>

<p>This function is called by <code><a href="#topic+sm_write_excel">sm_write_excel</a></code> with option <code>transpose = TRUE</code> to generate a row-based tabular data format from a wide data frame in R that is suitable for exporting to Excel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_transpose(data, date.format = "%d/%m/%Y")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_transpose_+3A_data">data</code></td>
<td>
<p>a wide format data frame where each column is a variable and the first variable uniquely identifies the data.</p>
</td></tr>
<tr><td><code id="sm_transpose_+3A_date.format">date.format</code></td>
<td>
<p>a format for date columns which is passed to <code><a href="base.html#topic+format.Date">format.Date</a></code>. When transposing wide, dates are converted to character. The default R YYYY-MM-DD format for dates is often not recognized by Excel. By default dates are transformed to DD/MM/YYYY format which Excel (UK English) recognizes. Putting <code>FALSE</code> here does not transform dates into another format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A transposed data frame or <code><a href="data.table.html#topic+data.table">data.table</a></code> (the class of the input is preserved).
</p>


<h3>See Also</h3>

<p><code><a href="data.table.html#topic+transpose">transpose</a></code>, <code><a href="#topic+sm_pivot_wider">sm_pivot_wider</a></code>, <code><a href="#topic+sm_write_excel">sm_write_excel</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sm_transpose(sm_data("ELECTRICITY"))

</code></pre>

<hr>
<h2 id='sm_write_excel'>Export Wide Data to Excel</h2><span id='topic+sm_write_excel'></span>

<h3>Description</h3>

<p>This function exports a wide format dataset to a column- (default) or row-oriented Excel format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm_write_excel(
  data,
  ...,
  transpose = FALSE,
  transpose.date.format = "%d/%m/%Y"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm_write_excel_+3A_data">data</code></td>
<td>
<p>a wide dataset from <code><a href="#topic+sm_data">sm_data</a></code> or reshaped to a wide format with <code><a href="#topic+sm_pivot_wider">sm_pivot_wider</a></code>.</p>
</td></tr>
<tr><td><code id="sm_write_excel_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="writexl.html#topic+write_xlsx">write_xlsx</a></code>. As a minimum a path needs to be supplied that ends with the name of the Excel file. See Examples.</p>
</td></tr>
<tr><td><code id="sm_write_excel_+3A_transpose">transpose</code></td>
<td>
<p>logical. If <code>TRUE</code>, the result is returned in a row-oriented Excel format. The default is column oriented (same as the dataset in R).</p>
</td></tr>
<tr><td><code id="sm_write_excel_+3A_transpose.date.format">transpose.date.format</code></td>
<td>
<p>argument passed to <code><a href="#topic+sm_transpose">sm_transpose</a></code>, setting the format of date columns when data is transposed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Writes an Excel file to the specified path (no return value).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sm_transpose">sm_transpose</a></code>, <code><a href="writexl.html#topic+write_xlsx">write_xlsx</a></code>, <code><a href="#topic+samadb">samadb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Getting electricity indicators from 2000
data &lt;- sm_data("ELECTRICITY", from = 2000)

# Saving to different Excel formats
sm_write_excel(data, "ELECTRICITY.xlsx")
sm_write_excel(data, "ELECTRICITY.xlsx", transpose = TRUE)

# Saving to alternative path
sm_write_excel(data, "C:/Users/.../ELECTRICITY.xlsx")

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
