<!DOCTYPE html><html lang="en"><head><title>Help for package skewsamp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {skewsamp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#create_lower_extension'><p>Computes the lower boundary value for the empirical CDF</p></a></li>
<li><a href='#create_upper_extension'><p>Computes the upper boundary value for the empirical CDF</p></a></li>
<li><a href='#demp'><p>Empirical probability density function (EPDF)</p></a></li>
<li><a href='#estimate_p'><p>Computes an empirical estimate of <code>p</code> (<code class="reqn">P(X &lt; X + \delta)</code>)</p></a></li>
<li><a href='#extend_sample'><p>Extends a vector by adding a lower and upper boundary.</p></a></li>
<li><a href='#find_smaller_index'><p>Finds the index of the smaller neighbour of the given value in the vector x.</p></a></li>
<li><a href='#n_binom'><p>Calculate sample size for binomial distribution</p></a></li>
<li><a href='#n_gamma'><p>Calculate sample size for gamma distribution</p></a></li>
<li><a href='#n_glm'><p>Calculate sample size for a group comparison via generalized linear models</p></a></li>
<li><a href='#n_locshift'><p>Estimate N on the basis of two pilot samples.</p></a></li>
<li><a href='#n_locshift_bound'><p>Compute an upper bound the sample size based on two pilot samples.</p></a></li>
<li><a href='#n_locshift_one'><p>Estimate N on the basis of one pilot sample.</p></a></li>
<li><a href='#n_negbinom'><p>Calculate sample size for negative binomial distribution</p></a></li>
<li><a href='#n_noether'><p>Noether's (1987) formula for obtaining a sample size estimation for</p>
the two-sample Wilcoxon Mann-Whitney test.</a></li>
<li><a href='#n_poisson'><p>Calculate sample size for poisson distribution</p></a></li>
<li><a href='#pemp'><p>Empirical cumulative density function (ECDF)</p></a></li>
<li><a href='#qemp'><p>Empirical quantile function</p></a></li>
<li><a href='#remp'><p>Draws random values from the ECDF obtained from <code>sample</code></p></a></li>
<li><a href='#resample_n_locshift'><p>Compute a distribution of estimates of N based on two pilot samples.</p></a></li>
<li><a href='#resample_n_locshift_one'><p>Compute <code>n_resamples</code> estimates of N</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimate Sample Sizes for Group Comparisons with Skewed
Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate necessary sample sizes for comparing the location
    of data from two groups or categories when the distribution of the 
    data is skewed. The package 
    offers a non-parametric method for a Wilcoxon Mann-Whitney test of 
    location shift as well as methods for several generalized linear 
    models, for instance, Gamma regression.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-16 15:57:31 UTC; jobrachem</td>
</tr>
<tr>
<td>Author:</td>
<td>Johannes Brachem [cre, aut],
  Dominik Strache [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Johannes Brachem &lt;jbrachem@posteo.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-16 21:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='create_lower_extension'>Computes the lower boundary value for the empirical CDF</h2><span id='topic+create_lower_extension'></span>

<h3>Description</h3>

<p>Computes the lower boundary value for the empirical CDF
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_lower_extension(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_lower_extension_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric
</p>

<hr>
<h2 id='create_upper_extension'>Computes the upper boundary value for the empirical CDF</h2><span id='topic+create_upper_extension'></span>

<h3>Description</h3>

<p>Computes the upper boundary value for the empirical CDF
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_upper_extension(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_upper_extension_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric
</p>

<hr>
<h2 id='demp'>Empirical probability density function (EPDF)</h2><span id='topic+demp'></span>

<h3>Description</h3>

<p>Empirical probability density function based on a sample of observations,
as described by Chakraborti (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demp(x, sample)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="demp_+3A_x">x</code></td>
<td>
<p>numeric vector of values to evaluate</p>
</td></tr>
<tr><td><code id="demp_+3A_sample">sample</code></td>
<td>
<p>numeric vector of sample values to base the EPDF on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of density values based on the EPDF
</p>


<h3>References</h3>

<p>Chakraborti, S., Hong, B., &amp; Van De Wiel, M. A. (2006).
A note on sample size determination for a nonparametric test of location.
Technometrics, 48(1), 88–94. https://doi.org/10.1198/004017005000000193
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:5
demp(1, x)
</code></pre>

<hr>
<h2 id='estimate_p'>Computes an empirical estimate of <code>p</code> (<code class="reqn">P(X &lt; X + \delta)</code>)</h2><span id='topic+estimate_p'></span>

<h3>Description</h3>

<p>Computes an empirical estimate of <code>p</code> (<code class="reqn">P(X &lt; X + \delta)</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_p(sample, delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_p_+3A_sample">sample</code></td>
<td>
<p>numeric vector of data to base the estimation on (X)</p>
</td></tr>
<tr><td><code id="estimate_p_+3A_delta">delta</code></td>
<td>
<p>numeric value, location shift parameter <code class="reqn">\delta</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An empirical estimate of <code class="reqn">P(X &lt; X + \delta)</code>
</p>

<hr>
<h2 id='extend_sample'>Extends a vector by adding a lower and upper boundary.</h2><span id='topic+extend_sample'></span>

<h3>Description</h3>

<p>Extends a vector by adding a lower and upper boundary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extend_sample(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extend_sample_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>extended and sorted numeric vector
</p>

<hr>
<h2 id='find_smaller_index'>Finds the index of the smaller neighbour of the given value in the vector x.</h2><span id='topic+find_smaller_index'></span>

<h3>Description</h3>

<p>Finds the index of the smaller neighbour of the given value in the vector x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_smaller_index(value, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_smaller_index_+3A_value">value</code></td>
<td>
<p>value whose neighbour is searched</p>
</td></tr>
<tr><td><code id="find_smaller_index_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integer
</p>

<hr>
<h2 id='n_binom'>Calculate sample size for binomial distribution</h2><span id='topic+n_binom'></span>

<h3>Description</h3>

<p>Estimation of required sample size as given by Cundill &amp; Alexander (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_binom(
  p0,
  effect,
  size = 1,
  alpha = 0.05,
  power = 0.9,
  q = 0.5,
  link = c("logit", "identity"),
  two_sided = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n_binom_+3A_p0">p0</code></td>
<td>
<p>probability of success in group0</p>
</td></tr>
<tr><td><code id="n_binom_+3A_effect">effect</code></td>
<td>
<p>Effect size, <code class="reqn">1 - (\mu_1 / \mu_0)</code>, where
<code class="reqn">\mu_0</code> is the mean in the control group (<code>mean0</code>) and
<code class="reqn">\mu_1</code> is the mean in the treatment group.</p>
</td></tr>
<tr><td><code id="n_binom_+3A_size">size</code></td>
<td>
<p>number of trials (greater than zero)</p>
</td></tr>
<tr><td><code id="n_binom_+3A_alpha">alpha</code></td>
<td>
<p>Type I error rate</p>
</td></tr>
<tr><td><code id="n_binom_+3A_power">power</code></td>
<td>
<p>1 - Type II error rate</p>
</td></tr>
<tr><td><code id="n_binom_+3A_q">q</code></td>
<td>
<p>Proportion of observations allocated to the control group</p>
</td></tr>
<tr><td><code id="n_binom_+3A_link">link</code></td>
<td>
<p>Link function to use. Currently implement: 'log' and 'identity'</p>
</td></tr>
<tr><td><code id="n_binom_+3A_two_sided">two_sided</code></td>
<td>
<p>logical, if <code>TRUE</code> the sample size
will be calculated for a two-sided test. Otherwise, the sample
size will be calculated for a one-sided test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>"sample_size"</code>. It contains
the following components:
</p>
<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the total sample size</p>
</td></tr>
<tr><td><code>n0</code></td>
<td>
<p>sample size in Group 0 (control group)</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>sample size in Group 1 (treatment group)</p>
</td></tr>
<tr><td><code>two_sided</code></td>
<td>
<p>logical, <code>TRUE</code>, if the estimated sample size
refers to a two-sided test</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>type I error rate used in sample size estimation</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>target power used in sample size estimation</p>
</td></tr>
<tr><td><code>effect</code></td>
<td>
<p>effect size used in sample size estimation</p>
</td></tr>
<tr><td><code>effect_type</code></td>
<td>
<p>short description of the type of effect size</p>
</td></tr>
<tr><td><code>comment</code></td>
<td>
<p>additional comment, if there is any</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cundill, B., &amp; Alexander, N. D. E. (2015). Sample size calculations
for skewed distributions. <em>BMC Medical Research Methodology</em>,
15(1), 1–9. https://doi.org/10.1186/s12874-015-0023-0
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n_binom(p0 = 0.5, effect = 0.3)
</code></pre>

<hr>
<h2 id='n_gamma'>Calculate sample size for gamma distribution</h2><span id='topic+n_gamma'></span>

<h3>Description</h3>

<p>Estimation of required sample size as given by Cundill &amp; Alexander (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_gamma(
  mean0,
  effect,
  shape0,
  shape1 = shape0,
  alpha = 0.05,
  power = 0.9,
  q = 0.5,
  link = c("log", "identity"),
  two_sided = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n_gamma_+3A_mean0">mean0</code></td>
<td>
<p>Mean in control group</p>
</td></tr>
<tr><td><code id="n_gamma_+3A_effect">effect</code></td>
<td>
<p>Effect size, <code class="reqn">1 - (\mu_1 / \mu_0)</code>, where
<code class="reqn">\mu_0</code> is the mean in the control group (<code>mean0</code>) and
<code class="reqn">\mu_1</code> is the mean in the treatment group.</p>
</td></tr>
<tr><td><code id="n_gamma_+3A_shape0">shape0</code></td>
<td>
<p>Shape parameter in control group</p>
</td></tr>
<tr><td><code id="n_gamma_+3A_shape1">shape1</code></td>
<td>
<p>Shape parameter in treatment group. Defaults to
<code>shape0</code>, because GLM assumes equal shape across groups.</p>
</td></tr>
<tr><td><code id="n_gamma_+3A_alpha">alpha</code></td>
<td>
<p>Type I error rate</p>
</td></tr>
<tr><td><code id="n_gamma_+3A_power">power</code></td>
<td>
<p>1 - Type II error rate</p>
</td></tr>
<tr><td><code id="n_gamma_+3A_q">q</code></td>
<td>
<p>Proportion of observations allocated to the control group</p>
</td></tr>
<tr><td><code id="n_gamma_+3A_link">link</code></td>
<td>
<p>Link function to use. Currently implement: 'log' and 'identity'</p>
</td></tr>
<tr><td><code id="n_gamma_+3A_two_sided">two_sided</code></td>
<td>
<p>logical, if <code>TRUE</code> the sample size
will be calculated for a two-sided test. Otherwise, the sample
size will be calculated for a one-sided test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>"sample_size"</code>. It contains
the following components:
</p>
<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the total sample size</p>
</td></tr>
<tr><td><code>n0</code></td>
<td>
<p>sample size in Group 0 (control group)</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>sample size in Group 1 (treatment group)</p>
</td></tr>
<tr><td><code>two_sided</code></td>
<td>
<p>logical, <code>TRUE</code>, if the estimated sample size
refers to a two-sided test</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>type I error rate used in sample size estimation</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>target power used in sample size estimation</p>
</td></tr>
<tr><td><code>effect</code></td>
<td>
<p>effect size used in sample size estimation</p>
</td></tr>
<tr><td><code>effect_type</code></td>
<td>
<p>short description of the type of effect size</p>
</td></tr>
<tr><td><code>comment</code></td>
<td>
<p>additional comment, if there is any</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cundill, B., &amp; Alexander, N. D. E. (2015). Sample size calculations
for skewed distributions. <em>BMC Medical Research Methodology</em>,
15(1), 1–9. https://doi.org/10.1186/s12874-015-0023-0
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n_gamma(mean0 = 8.46, effect = 0.7, shape0 = 0.639,
           alpha = 0.05, power = 0.9)
</code></pre>

<hr>
<h2 id='n_glm'>Calculate sample size for a group comparison via generalized linear models</h2><span id='topic+n_glm'></span>

<h3>Description</h3>

<p>Estimation of required sample size as given by Cundill &amp; Alexander (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_glm(
  mean0,
  mean1,
  dispersion0,
  dispersion1,
  alpha,
  power,
  link_fun = function(mu) NULL,
  variance_fun = function(mu, dispersion) NULL,
  dmu_deta_fun = function(mu) NULL,
  q
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n_glm_+3A_mean0">mean0</code></td>
<td>
<p>Mean in control group</p>
</td></tr>
<tr><td><code id="n_glm_+3A_mean1">mean1</code></td>
<td>
<p>Mean in treatment group</p>
</td></tr>
<tr><td><code id="n_glm_+3A_dispersion0">dispersion0</code></td>
<td>
<p>Dispersion parameter in control group</p>
</td></tr>
<tr><td><code id="n_glm_+3A_dispersion1">dispersion1</code></td>
<td>
<p>Dispersion parameter in treatment group.</p>
</td></tr>
<tr><td><code id="n_glm_+3A_alpha">alpha</code></td>
<td>
<p>Type I error rate</p>
</td></tr>
<tr><td><code id="n_glm_+3A_power">power</code></td>
<td>
<p>1 - Type II error rate</p>
</td></tr>
<tr><td><code id="n_glm_+3A_link_fun">link_fun</code></td>
<td>
<p>function object, the link function to create the
response <code class="reqn">\eta</code>.</p>
</td></tr>
<tr><td><code id="n_glm_+3A_variance_fun">variance_fun</code></td>
<td>
<p>function object, function for computing the
variance based on a mean and a dispersion parameter</p>
</td></tr>
<tr><td><code id="n_glm_+3A_dmu_deta_fun">dmu_deta_fun</code></td>
<td>
<p>function object, derivative of the original
mean with respect to the link: <code class="reqn">d\mu / d\eta</code>.</p>
</td></tr>
<tr><td><code id="n_glm_+3A_q">q</code></td>
<td>
<p>Number between 0 and 1, the proportion of observations
allocated to the control group</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Total sample size (numeric)
</p>


<h3>References</h3>

<p>Cundill, B., &amp; Alexander, N. D. E. (2015). Sample size calculations
for skewed distributions. <em>BMC Medical Research Methodology</em>,
15(1), 1–9. https://doi.org/10.1186/s12874-015-0023-0
</p>

<hr>
<h2 id='n_locshift'>Estimate N on the basis of two pilot samples.</h2><span id='topic+n_locshift'></span>

<h3>Description</h3>

<p>Estimation as described by Chakraborti, Hong, &amp; van de Wiel (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_locshift(s1, s2, delta, alpha = 0.05, power = 0.9, q = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n_locshift_+3A_s1">s1</code>, <code id="n_locshift_+3A_s2">s2</code></td>
<td>
<p>pilot samples</p>
</td></tr>
<tr><td><code id="n_locshift_+3A_delta">delta</code></td>
<td>
<p>numeric value, location shift parameter <code class="reqn">\delta</code></p>
</td></tr>
<tr><td><code id="n_locshift_+3A_alpha">alpha</code></td>
<td>
<p>type-I error probability</p>
</td></tr>
<tr><td><code id="n_locshift_+3A_power">power</code></td>
<td>
<p>1 - type-II error probability, the desired statistical
power</p>
</td></tr>
<tr><td><code id="n_locshift_+3A_q">q</code></td>
<td>
<p>size of group0 relative to total sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>WARNING: Note that the estimation has high variability due to its dependence
on pilot samples. The smaller the pilot sample, the more uncertain is
the estimation of the required sample size. In a simulation study, we
found that the method may also be inaccurate on average, depending on
the investigated data.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>"sample_size"</code>. It contains
the following components:
</p>
<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the total sample size</p>
</td></tr>
<tr><td><code>n0</code></td>
<td>
<p>sample size in Group 0 (control group)</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>sample size in Group 1 (treatment group)</p>
</td></tr>
<tr><td><code>two_sided</code></td>
<td>
<p>logical, <code>TRUE</code>, if the estimated sample size
refers to a two-sided test</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>type I error rate used in sample size estimation</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>target power used in sample size estimation</p>
</td></tr>
<tr><td><code>effect</code></td>
<td>
<p>effect size used in sample size estimation</p>
</td></tr>
<tr><td><code>effect_type</code></td>
<td>
<p>short description of the type of effect size</p>
</td></tr>
<tr><td><code>comment</code></td>
<td>
<p>additional comment, if there is any</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chakraborti, S., Hong, B., &amp; van de Wiel, M. A. (2006). A note on
sample size determination for a nonparametric test of location.
Technometrics, 48(1), 88–94. https://doi.org/10.1198/004017005000000193
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n_locshift(s1 = rexp(10), s2 = rexp(10),
           alpha = 0.05, power = 0.9, delta = 0.35)
</code></pre>

<hr>
<h2 id='n_locshift_bound'>Compute an upper bound the sample size based on two pilot samples.</h2><span id='topic+n_locshift_bound'></span>

<h3>Description</h3>

<p>Based on the procedure described by Chakraborti, Hong, &amp; van de Wiel (2006)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_locshift_bound(
  s1,
  s2,
  delta,
  alpha = 0.05,
  power = 0.9,
  quantile = 0.9,
  n_resamples = 500,
  q = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n_locshift_bound_+3A_s1">s1</code>, <code id="n_locshift_bound_+3A_s2">s2</code></td>
<td>
<p>Pilot samples</p>
</td></tr>
<tr><td><code id="n_locshift_bound_+3A_delta">delta</code></td>
<td>
<p>numeric value, location shift parameter <code class="reqn">\delta</code></p>
</td></tr>
<tr><td><code id="n_locshift_bound_+3A_alpha">alpha</code></td>
<td>
<p>Type I error probability</p>
</td></tr>
<tr><td><code id="n_locshift_bound_+3A_power">power</code></td>
<td>
<p>1 - Type II error probability, the desired statistical
power</p>
</td></tr>
<tr><td><code id="n_locshift_bound_+3A_quantile">quantile</code></td>
<td>
<p>Quantile to use as the upper bound.</p>
</td></tr>
<tr><td><code id="n_locshift_bound_+3A_n_resamples">n_resamples</code></td>
<td>
<p>number of resamples to use in bootstrapping</p>
</td></tr>
<tr><td><code id="n_locshift_bound_+3A_q">q</code></td>
<td>
<p>size of group0 relative to total sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>WARNING: Note that the underlying estimation has high variability due
to its dependence on pilot samples. The smaller the pilot sample,
the more uncertain is
the estimation of the required sample size. In a simulation study, we
found that the underlying method may also be inaccurate on average, depending on
the investigated data.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>"sample_size"</code>. It contains
the following components:
</p>
<table role = "presentation">
<tr><td><code>n</code></td>
<td>
<p>the total sample size</p>
</td></tr>
<tr><td><code>n0</code></td>
<td>
<p>sample size in Group 0 (control group)</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>sample size in Group 1 (treatment group)</p>
</td></tr>
<tr><td><code>two_sided</code></td>
<td>
<p>logical, <code>TRUE</code>, if the estimated sample size
refers to a two-sided test</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>type I error rate used in sample size estimation</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>target power used in sample size estimation</p>
</td></tr>
<tr><td><code>effect</code></td>
<td>
<p>effect size used in sample size estimation</p>
</td></tr>
<tr><td><code>effect_type</code></td>
<td>
<p>short description of the type of effect size</p>
</td></tr>
<tr><td><code>comment</code></td>
<td>
<p>additional comment, if there is any</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chakraborti, S., Hong, B., &amp; van de Wiel, M. A. (2006). A note on
sample size determination for a nonparametric test of location.
Technometrics, 48(1), 88–94. https://doi.org/10.1198/004017005000000193
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
n_locshift_bound(s1 = rexp(10), s2 = rexp(10),
           delta = 0.35, alpha = 0.05, power = 0.9, n_resamples = 5)
## End(Not run)
</code></pre>

<hr>
<h2 id='n_locshift_one'>Estimate N on the basis of one pilot sample.</h2><span id='topic+n_locshift_one'></span>

<h3>Description</h3>

<p>Estimate N on the basis of one pilot sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_locshift_one(sample, alpha, power, delta, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n_locshift_one_+3A_sample">sample</code></td>
<td>
<p>pilot data</p>
</td></tr>
<tr><td><code id="n_locshift_one_+3A_alpha">alpha</code></td>
<td>
<p>Type I error probability</p>
</td></tr>
<tr><td><code id="n_locshift_one_+3A_power">power</code></td>
<td>
<p>1 - Type II error probability, the desired statistical
power</p>
</td></tr>
<tr><td><code id="n_locshift_one_+3A_delta">delta</code></td>
<td>
<p>numeric value, location shift parameter <code class="reqn">\delta</code></p>
</td></tr>
<tr><td><code id="n_locshift_one_+3A_q">q</code></td>
<td>
<p>size of group0 relative to total sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric value, an estimate of the sample size required to
detect a location shift of <code>delta</code> with a Wilcoxon Mann-Whitney
test with <code>power</code> and <code>alpha</code>.
</p>

<hr>
<h2 id='n_negbinom'>Calculate sample size for negative binomial distribution</h2><span id='topic+n_negbinom'></span>

<h3>Description</h3>

<p>Estimation of required sample size as given by Cundill &amp; Alexander (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_negbinom(
  mean0,
  effect,
  dispersion0,
  dispersion1 = dispersion0,
  alpha = 0.05,
  power = 0.9,
  q = 0.5,
  link = c("log", "identity"),
  two_sided = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n_negbinom_+3A_mean0">mean0</code></td>
<td>
<p>Mean in control group</p>
</td></tr>
<tr><td><code id="n_negbinom_+3A_effect">effect</code></td>
<td>
<p>Effect size, <code class="reqn">1 - (\mu_1 / \mu_0)</code>, where
<code class="reqn">\mu_0</code> is the mean in the control group (<code>mean0</code>) and
<code class="reqn">\mu_1</code> is the mean in the treatment group.</p>
</td></tr>
<tr><td><code id="n_negbinom_+3A_dispersion0">dispersion0</code></td>
<td>
<p>Dispersion parameter in control group</p>
</td></tr>
<tr><td><code id="n_negbinom_+3A_dispersion1">dispersion1</code></td>
<td>
<p>Dispersion parameter in treatment group. Defaults to
<code>shape0</code>, because GLM assumes equal shape across groups.</p>
</td></tr>
<tr><td><code id="n_negbinom_+3A_alpha">alpha</code></td>
<td>
<p>Type I error rate</p>
</td></tr>
<tr><td><code id="n_negbinom_+3A_power">power</code></td>
<td>
<p>1 - Type II error rate</p>
</td></tr>
<tr><td><code id="n_negbinom_+3A_q">q</code></td>
<td>
<p>Proportion of observations allocated to the control group</p>
</td></tr>
<tr><td><code id="n_negbinom_+3A_link">link</code></td>
<td>
<p>Link function to use. Currently implement: 'log' and 'identity'</p>
</td></tr>
<tr><td><code id="n_negbinom_+3A_two_sided">two_sided</code></td>
<td>
<p>logical, if <code>TRUE</code> the sample size
will be calculated for a two-sided test. Otherwise, the sample
size will be calculated for a one-sided test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>"sample_size"</code>. It contains
the following components:
</p>
<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the total sample size</p>
</td></tr>
<tr><td><code>n0</code></td>
<td>
<p>sample size in Group 0 (control group)</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>sample size in Group 1 (treatment group)</p>
</td></tr>
<tr><td><code>two_sided</code></td>
<td>
<p>logical, <code>TRUE</code>, if the estimated sample size
refers to a two-sided test</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>type I error rate used in sample size estimation</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>target power used in sample size estimation</p>
</td></tr>
<tr><td><code>effect</code></td>
<td>
<p>effect size used in sample size estimation</p>
</td></tr>
<tr><td><code>effect_type</code></td>
<td>
<p>short description of the type of effect size</p>
</td></tr>
<tr><td><code>comment</code></td>
<td>
<p>additional comment, if there is any</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cundill, B., &amp; Alexander, N. D. E. (2015). Sample size calculations
for skewed distributions. <em>BMC Medical Research Methodology</em>,
15(1), 1–9. https://doi.org/10.1186/s12874-015-0023-0
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n_negbinom(mean0 = 71.4, effect = 0.7, dispersion0 = 0.33,
           alpha = 0.05, power = 0.9)
</code></pre>

<hr>
<h2 id='n_noether'>Noether's (1987) formula for obtaining a sample size estimation for
the two-sample Wilcoxon Mann-Whitney test.</h2><span id='topic+n_noether'></span>

<h3>Description</h3>

<p>Noether's (1987) formula for obtaining a sample size estimation for
the two-sample Wilcoxon Mann-Whitney test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_noether(alpha, power, p, q = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n_noether_+3A_alpha">alpha</code></td>
<td>
<p>Type I error probability</p>
</td></tr>
<tr><td><code id="n_noether_+3A_power">power</code></td>
<td>
<p>1 - Type II error probability, the desired statistical
power</p>
</td></tr>
<tr><td><code id="n_noether_+3A_p">p</code></td>
<td>
<p>probability <code class="reqn">P(X &lt; Y)</code> that a random observation from
group X is smaller than a random observation from group Y</p>
</td></tr>
<tr><td><code id="n_noether_+3A_q">q</code></td>
<td>
<p>relative sample size of the X-sample. Number between 0 and 1.
q = 0.5 means that the size of the X-sample will be 50% of the
total sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>estimated required total sample size
</p>

<hr>
<h2 id='n_poisson'>Calculate sample size for poisson distribution</h2><span id='topic+n_poisson'></span>

<h3>Description</h3>

<p>Estimation of required sample size as given by Cundill &amp; Alexander (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_poisson(
  mean0,
  effect,
  alpha = 0.05,
  power = 0.9,
  q = 0.5,
  link = c("log", "identity"),
  two_sided = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n_poisson_+3A_mean0">mean0</code></td>
<td>
<p>Mean in control group</p>
</td></tr>
<tr><td><code id="n_poisson_+3A_effect">effect</code></td>
<td>
<p>Effect size, <code class="reqn">1 - (\mu_1 / \mu_0)</code>, where
<code class="reqn">\mu_0</code> is the mean in the control group (<code>mean0</code>) and
<code class="reqn">\mu_1</code> is the mean in the treatment group.</p>
</td></tr>
<tr><td><code id="n_poisson_+3A_alpha">alpha</code></td>
<td>
<p>Type I error rate</p>
</td></tr>
<tr><td><code id="n_poisson_+3A_power">power</code></td>
<td>
<p>1 - Type II error rate</p>
</td></tr>
<tr><td><code id="n_poisson_+3A_q">q</code></td>
<td>
<p>Proportion of observations allocated to the control group</p>
</td></tr>
<tr><td><code id="n_poisson_+3A_link">link</code></td>
<td>
<p>Link function to use. Currently implement: 'log' and 'identity'</p>
</td></tr>
<tr><td><code id="n_poisson_+3A_two_sided">two_sided</code></td>
<td>
<p>logical, if <code>TRUE</code> the sample size
will be calculated for a two-sided test. Otherwise, the sample
size will be calculated for a one-sided test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>"sample_size"</code>. It contains
the following components:
</p>
<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the total sample size</p>
</td></tr>
<tr><td><code>n0</code></td>
<td>
<p>sample size in Group 0 (control group)</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>sample size in Group 1 (treatment group)</p>
</td></tr>
<tr><td><code>two_sided</code></td>
<td>
<p>logical, <code>TRUE</code>, if the estimated sample size
refers to a two-sided test</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>type I error rate used in sample size estimation</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>target power used in sample size estimation</p>
</td></tr>
<tr><td><code>effect</code></td>
<td>
<p>effect size used in sample size estimation</p>
</td></tr>
<tr><td><code>effect_type</code></td>
<td>
<p>short description of the type of effect size</p>
</td></tr>
<tr><td><code>comment</code></td>
<td>
<p>additional comment, if there is any</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cundill, B., &amp; Alexander, N. D. E. (2015). Sample size calculations
for skewed distributions. <em>BMC Medical Research Methodology</em>,
15(1), 1–9. https://doi.org/10.1186/s12874-015-0023-0
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n_poisson(mean0 = 5, effect = 0.3)
</code></pre>

<hr>
<h2 id='pemp'>Empirical cumulative density function (ECDF)</h2><span id='topic+pemp'></span>

<h3>Description</h3>

<p>Empirical cumulative density function based on a sample of observations,
as used by described by Chakraborti (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pemp(q, sample)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pemp_+3A_q">q</code></td>
<td>
<p>numeric vector of values to evaluate</p>
</td></tr>
<tr><td><code id="pemp_+3A_sample">sample</code></td>
<td>
<p>numeric vector of sample values to base the ECDF on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the probabilities that a value drawn at random from the
empirical cumulative density based on <em>sample</em> is smaller than or
equal to the elements of x.
</p>


<h3>References</h3>

<p>Chakraborti, S., Hong, B., &amp; Van De Wiel, M. A. (2006).
A note on sample size determination for a nonparametric test of location.
Technometrics, 48(1), 88–94. https://doi.org/10.1198/004017005000000193
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:5
pemp(1, x)
</code></pre>

<hr>
<h2 id='qemp'>Empirical quantile function</h2><span id='topic+qemp'></span>

<h3>Description</h3>

<p>Empirical quantile function, i.e. inverse of the empirical cumulative
density function <code><a href="#topic+pemp">pemp()</a></code>. Based on the latter function as presented
by Chakraborti (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qemp(p, sample)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qemp_+3A_p">p</code></td>
<td>
<p>probability, can be a vector</p>
</td></tr>
<tr><td><code id="qemp_+3A_sample">sample</code></td>
<td>
<p>numeric vector of sample values to base the ECDF on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value for which <code>pemp(x, sample) = p</code>,
i.e. the probability that a value drawn at random from the ECDF
is smaller or equal to <code>x</code> is <code>p</code>.
</p>


<h3>References</h3>

<p>Chakraborti, S., Hong, B., &amp; Van De Wiel, M. A. (2006).
A note on sample size determination for a nonparametric test of location.
Technometrics, 48(1), 88–94. https://doi.org/10.1198/004017005000000193
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:5
qemp(0.1, x)
</code></pre>

<hr>
<h2 id='remp'>Draws random values from the ECDF obtained from <code>sample</code></h2><span id='topic+remp'></span>

<h3>Description</h3>

<p>Based on the empirical cumulative density function as presented by
Chakraborti (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remp(n, sample)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remp_+3A_n">n</code></td>
<td>
<p>integer, number of samples to be drawn</p>
</td></tr>
<tr><td><code id="remp_+3A_sample">sample</code></td>
<td>
<p>numeric vector of sample values to base the ECDF on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of random values drawn from the ECDF
</p>


<h3>References</h3>

<p>Chakraborti, S., Hong, B., &amp; Van De Wiel, M. A. (2006).
A note on sample size determination for a nonparametric test of location.
Technometrics, 48(1), 88–94. https://doi.org/10.1198/004017005000000193
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:5
remp(10, x)
</code></pre>

<hr>
<h2 id='resample_n_locshift'>Compute a distribution of estimates of N based on two pilot samples.</h2><span id='topic+resample_n_locshift'></span>

<h3>Description</h3>

<p>Estimation of sample sizes based on resampled pilot samples from the empirical
cumulative density. Based on the work of Chakraborti, Hong, &amp; van de Wiel (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resample_n_locshift(
  s1,
  s2,
  delta,
  alpha = 0.05,
  power = 0.9,
  n_resamples = 500,
  q = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="resample_n_locshift_+3A_s1">s1</code>, <code id="resample_n_locshift_+3A_s2">s2</code></td>
<td>
<p>Pilot samples</p>
</td></tr>
<tr><td><code id="resample_n_locshift_+3A_delta">delta</code></td>
<td>
<p>numeric value, location shift parameter <code class="reqn">\delta</code></p>
</td></tr>
<tr><td><code id="resample_n_locshift_+3A_alpha">alpha</code></td>
<td>
<p>Type I error probability</p>
</td></tr>
<tr><td><code id="resample_n_locshift_+3A_power">power</code></td>
<td>
<p>1 - Type II error probability, the desired statistical
power</p>
</td></tr>
<tr><td><code id="resample_n_locshift_+3A_n_resamples">n_resamples</code></td>
<td>
<p>number of resamples to use in bootstrapping</p>
</td></tr>
<tr><td><code id="resample_n_locshift_+3A_q">q</code></td>
<td>
<p>size of group0 relative to total sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>WARNING: Note that the estimation has high variability due to its dependence
on pilot samples. The smaller the pilot sample, the more uncertain is
the estimation of the required sample size. In a simulation study, we
found that the method may also be inaccurate on average, depending on
the investigated data.
</p>


<h3>Value</h3>

<p>numeric vector of sample size estimates (total sample size)
</p>


<h3>References</h3>

<p>Chakraborti, S., Hong, B., &amp; van de Wiel, M. A. (2006). A note on
sample size determination for a nonparametric test of location.
Technometrics, 48(1), 88–94. https://doi.org/10.1198/004017005000000193
</p>

<hr>
<h2 id='resample_n_locshift_one'>Compute <code>n_resamples</code> estimates of N</h2><span id='topic+resample_n_locshift_one'></span>

<h3>Description</h3>

<p>Compute <code>n_resamples</code> estimates of N
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resample_n_locshift_one(sample, alpha, power, delta, n_resamples, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="resample_n_locshift_one_+3A_sample">sample</code></td>
<td>
<p>pilot data</p>
</td></tr>
<tr><td><code id="resample_n_locshift_one_+3A_alpha">alpha</code></td>
<td>
<p>Type I error probability</p>
</td></tr>
<tr><td><code id="resample_n_locshift_one_+3A_power">power</code></td>
<td>
<p>1 - Type II error probability, the desired statistical
power</p>
</td></tr>
<tr><td><code id="resample_n_locshift_one_+3A_delta">delta</code></td>
<td>
<p>numeric value, location shift parameter <code class="reqn">\delta</code></p>
</td></tr>
<tr><td><code id="resample_n_locshift_one_+3A_n_resamples">n_resamples</code></td>
<td>
<p>number of resamples to use in bootstrapping</p>
</td></tr>
<tr><td><code id="resample_n_locshift_one_+3A_q">q</code></td>
<td>
<p>size of group0 relative to total sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of sample size estimates
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
