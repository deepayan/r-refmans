<!DOCTYPE html><html lang="en"><head><title>Help for package wally</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {wally}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#divat'><p>divat data</p></a></li>
<li><a href='#threecity'><p>threecity data</p></a></li>
<li><a href='#wallyPlot'><p>Wally plots to assess calibration of a risk or survival prediction</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Wally Calibration Plot for Risk Prediction Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.10</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul F Blanche &lt;paulfblanche@gmail.com&gt;, Thomas A. Gerds
    &lt;tag@biostat.ku.dk&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul F. Blanche &lt;paulfblanche@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A prediction model is calibrated if, roughly, for any percentage x we can expect that x subjects out of 100 experience the event among all subjects that have a predicted risk of x%. A calibration plot provides a simple, yet useful, way of assessing the calibration assumption. The Wally plot consists of a sequence of usual calibration plots. Among the plots contained within the sequence, one is the actual calibration plot which has been obtained from the data and the others are obtained from similar simulated data under the calibration assumption. It provides the investigator with a direct visual understanding of the shape and sampling variability that are common under the calibration assumption. The original calibration plot from the data is included randomly among the simulated calibration plots, similarly to a police lineup. If the original calibration plot is not easily identified then the calibration assumption is not contradicted by the data. The method handles the common situations in which the data contain censored observations and occurrences of competing events.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.9.0), prodlim (&ge; 1.4.9)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, riskRegression (&ge; 1.0.8), data.table (&ge; 1.10.4)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, survival</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-29 18:26:05 UTC; tag</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-30 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='divat'>divat data</h2><span id='topic+divat'></span>

<h3>Description</h3>

<p>Extracted data from a french population based cohort (DIVAT cohort). The dataset includes 
followup information on kidney graft failure  outcome and predicted 5-year risks based on 
based on the subject specific information which includes age, gender,
cardiovascular and diabetes histories, monitoring of the evolution of the kidney function
measured via serum creatinine and relevant characteristics of his or her kidney donor.
Graft failure is defined as either death with functioning kidney graft or return to dialysis.
The prediction model from which the predictions have been computed has been previously fitted
using an independent training sample from the DIVAT data. Details about data and modeling can
be found in Fournier et al. (2016).
</p>


<h3>Format</h3>

<p>A subsample consisting of 1300 observations on the following 3 variables.
</p>
 <dl>
<dt>pi</dt><dd><p>5-year risk prediction of kidney graft failure.</p>
</dd>
<dt>status</dt><dd><p>0=censored, 1=kidney graft failure</p>
</dd>
<dt>time</dt><dd><p>time to event (i.e., time to kidney graft failure or loss of follow-up)</p>
</dd></dl>


<h3>References</h3>

<p>Fournier, M. C., Foucher, Y., Blanche, P., Buron, F., Giral, M., &amp; Dantan, E. (2016).
A joint model for longitudinal and time-to-event data to better assess the specific
role of donor and recipient factors on long-term kidney transplantation outcomes.
European journal of epidemiology, 31(5), 469-479.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(divat)
</code></pre>

<hr>
<h2 id='threecity'>threecity data</h2><span id='topic+threecity'></span>

<h3>Description</h3>

<p>Extracted data from a french population based cohort (Three-City cohort). The dataset includes 
followup information on dementia outcome and predicted 5-year risks based on 
based on the subject specific information which includes age, gender,
education level and cognitive decline measured by a psychometric test
(Mini Mental State Examination). The prediction model from which the
predictions have been computed has been fitted on independent training
data from the Paquid cohort, another french population based cohort with similar design (see Reference Blanche et al. 2015 for details) .
</p>


<h3>Format</h3>

<p>A subsample consisting of 2000 observations on the following 3 variables.
</p>
 <dl>
<dt>pi</dt><dd><p>5-year absolute risk predictions of dementia.</p>
</dd>
<dt>status</dt><dd><p>0=censored, 1=dementia, 2=death dementia free</p>
</dd>
<dt>time</dt><dd><p>time to event (i.e., time to
either dementia, death dementia free or loss of follow-up)</p>
</dd></dl>


<h3>Source</h3>

<p>Web-appendix of Blanche et al. (2015).
</p>


<h3>References</h3>

<p>Blanche, P., Proust-Lima, C., Loubere, L., Berr, C., Dartigues, J. F., Jacqmin-Gadda, H. (2015).
Quantifying and comparing dynamic
predictive accuracy of joint models for longitudinal marker and
time-to-event in presence of censoring and competing risks. 
Biometrics, 71(1), 102-113.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(threecity)


</code></pre>

<hr>
<h2 id='wallyPlot'>Wally plots to assess calibration of a risk or survival prediction</h2><span id='topic+wallyPlot'></span>

<h3>Description</h3>

<p>##' Wally plots to assess calibration of a risk or survival prediction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wallyPlot(object, time, formula, data, cause = 1, q = 10, ylim,
  hanging = FALSE, seed = NULL, mar = c(4.1, 4.1, 2, 2),
  colbox = "red", verbose = TRUE, col = c("grey90", "grey30"),
  xlab = "Risk groups", labels = "quantiles.labels", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wallyPlot_+3A_object">object</code></td>
<td>
<p>Probabilistic survival predictions or probabilistic event risk predictions
evaluated at <code>time</code> for the subjects in <code>data</code>. Either
given in form of a numeric vector of probabilistic predictions or
as an object which  has a <code>predictRisk</code> method</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_time">time</code></td>
<td>
<p>Time interest for evaluating calibration of the
predictions.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_formula">formula</code></td>
<td>
<p>A survival or event history formula. The left hand
side is used to compute the expected event status. If
<code>formula</code> is <code>missing</code>, try to extract a formula from
the first element in object.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_data">data</code></td>
<td>
<p>A data frame in which to validate the prediction
models and to fit the censoring model. If <code>data</code> is missing,
try to extract a data set from the first element in object.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_cause">cause</code></td>
<td>
<p>For competing risks settings the cause of interest.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_q">q</code></td>
<td>
<p>The number of quantiles. Defaults to 10.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_ylim">ylim</code></td>
<td>
<p>Limits of y-axis. If missing the function tries to
find appropriate limits based on the simulated and real data.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_hanging">hanging</code></td>
<td>
<p>If <code>TRUE</code>, hang bars corresponding to observed
frequencies at the value of the corresponding prediction.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_seed">seed</code></td>
<td>
<p>A seed value to make results reproducible.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_mar">mar</code></td>
<td>
<p>Plot margins passed to par.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_colbox">colbox</code></td>
<td>
<p>Color of the box which identifies the real data
calibration plot.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code> warn about missing formula and data.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_col">col</code></td>
<td>
<p>Colour of the bars.</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis</p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_labels">labels</code></td>
<td>
<p>Label below the bars. Either <code>"quantiles"</code> or <code>"quantiles.label"</code></p>
</td></tr>
<tr><td><code id="wallyPlot_+3A_...">...</code></td>
<td>
<p>Further arguments passed to the subroutine <code>wallyCalPlot</code> and if <code>hanging</code>
is <code>TRUE</code> also to subroutine <code>lines</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of simulated and real data.
</p>


<h3>Author(s)</h3>

<p>Paul F. Blanche &lt;paulfblanche@gmail.com&gt; and Thomas A. Gerds &lt;tag@biostat.ku.dk&gt;
</p>


<h3>References</h3>

<p>Blanche P, Gerds T A, Ekstrom C T (2017). The Wally plot approach to assess the
calibration of clinical prediction models, submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Survival setting
library(prodlim)
library(data.table)
library(survival)
set.seed(180)
d = SimSurv(180)
f = coxph(Surv(time,status)~X1+X2,data=d,x=TRUE)
## Not run: 
wallyPlot(f,
          time=4,
          q=10,
          data=d,
          formula=Surv(time,status)~1)
 wallyPlot(f,
          time=4,
          q=10,
          hanging=TRUE,
          data=d,
          formula=Surv(time,status)~1)

## End(Not run)

# Competing risks setting
library(prodlim)
library(survival)
library(riskRegression)
set.seed(180)
d2 = SimCompRisk(180)
f2 = CSC(Hist(time,event)~X1+X2,data=d2)
## Not run: 
wallyPlot(f2,
          time=5,
          q=3,
          hanging=TRUE,
          data=d2,
          formula=Hist(time,event)~1)
          

## End(Not run)

# Reproduce Wally plots presented in Blanche et al. (2017)
## Not run: 
data(threecity)
wallyPlot(threecity$pi,
time=5,
hanging=TRUE,
formula=Hist(time,status)~1,
data=threecity,
ylim=c(-.1,.25),
seed= 511,
hline.lwd=3,
mar=c(1.01, 4.1, 1.15, 2))

## End(Not run)

## Not run: 
data(divat)
wallyPlot(divat$pi,
time=5,
hanging=TRUE,
formula=Hist(time,status)~1,
data=divat,
ylim=c(-.1,.60),
seed= 123459,
hline.lwd=3,
mar=c(1.01, 4.1, 1.15, 2))

## End(Not run)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
