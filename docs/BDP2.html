<!DOCTYPE html><html lang="en"><head><title>Help for package BDP2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BDP2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BDP2-package'>
<p>Bayesian Adaptive Designs for Phase II Trials with Binary Endpoint</p></a></li>
<li><a href='#BDP2'>
<p>Operating characteristics of a single-arm trial with a binary</p>
endpoint</a></li>
<li><a href='#BDP2_simulate'>
<p>Simulated operating characteristics of a single-arm trial with a binary</p>
endpoint for different types of futility criteria</a></li>
<li><a href='#BDP2workflow'>
<p>Shiny app for workflow</p></a></li>
<li><a href='#crit_general'>
<p>Calculates CritBoundaries for different types of futility criteria</p></a></li>
<li><a href='#pFstop'>
<p>Operating characteristics of a single-arm trial with a binary endpoint with futility stopping</p></a></li>
<li><a href='#pFstopEcall'>
<p>operating characteristics of a single-arm trial with a binary endpoint with futility stopping and calling efficacy at interim</p></a></li>
<li><a href='#pFstopEstop'>
<p>Operating characteristics of a single-arm trial with a binary endpoint with stopping for futility and stopping for efficacy</p></a></li>
<li><a href='#plot.cE_vs_pEcall'>
<p>Plot objects returned by plotBDP2()</p></a></li>
<li><a href='#plotBDP2'>
<p>Plots</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Adaptive Designs for Phase II Trials with Binary
Endpoint</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-07-31</td>
</tr>
<tr>
<td>Author:</td>
<td>Annette Kopp-Schneider, Manuel Wiesenfarth, Ulrich Abel</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Manuel Wiesenfarth &lt;m.wiesenfarth@dkfz.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools and workflow to choose design parameters in Bayesian adaptive single-arm phase II trial designs with binary endpoint (response, success) with possible stopping for efficacy and futility at interim analyses. Also contains routines to determine and visualize operating characteristics. See Kopp-Schneider et al. (2018) &lt;<a href="https://doi.org/10.1002%2Fbimj.201700209">doi:10.1002/bimj.201700209</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>rmarkdown, shiny, shinyBS</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-07-31 09:11:34 UTC; wiesenfa</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-07-31 12:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='BDP2-package'>
Bayesian Adaptive Designs for Phase II Trials with Binary Endpoint
</h2><span id='topic+BDP2-package'></span>

<h3>Description</h3>

<p>Tools and workflow to choose design parameters in Bayesian adaptive single-arm phase II trial designs with binary endpoint (response, success) with possible stopping for efficacy and futility at interim analyses. Also contains routines to determine and visualize operating characteristics. See Kopp-Schneider et al. (2018) &lt;doi:10.1002/bimj.201700209&gt;. 
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> BDP2</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Bayesian Adaptive Designs for Phase II Trials with Binary Endpoint</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.1.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-07-31</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Annette Kopp-Schneider, Manuel Wiesenfarth, Ulrich Abel</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Manuel Wiesenfarth &lt;m.wiesenfarth@dkfz.de&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Tools and workflow to choose design parameters in Bayesian adaptive single-arm phase II trial designs with binary endpoint (response, success) with possible stopping for efficacy and futility at interim analyses. Also contains routines to determine and visualize operating characteristics. See Kopp-Schneider et al. (2018) &lt;doi:10.1002/bimj.201700209&gt;. </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> rmarkdown, shiny, shinyBS</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> TRUE</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
BDP2                    Operating characteristics of a single-arm trial
                        with a binary endpoint
BDP2-package            Bayesian Adaptive Designs for Phase II Trials
                        with Binary Endpoint
BDP2_simulate           Simulated operating characteristics of a
                        single-arm trial with a binary endpoint for
                        different types of futility criteria
BDP2workflow            Shiny app for workflow
crit_general            Calculates CritBoundaries for different types
                        of futility criteria
pFstop                  Operating characteristics of a single-arm trial
                        with a binary endpoint with futility stopping
pFstopEcall             operating characteristics of a single-arm trial
                        with a binary endpoint with futility stopping
                        and calling efficacy at interim
pFstopEstop             Operating characteristics of a single-arm trial
                        with a binary endpoint with stopping for
                        futility and stopping for efficacy
plot.cE_vs_pEcall       Plot objects returned by plotBDP2()
plotBDP2                Plots
</pre>
<p>Tools and workflow to choose design parameters in Bayesian adaptive single-arm phase II trial designs with binary
endpoint (response, success) with possible stopping for efficacy and futility at interim analyses.
Also contains routines to determine and visualize operating characteristics.
</p>
<p>Main functions: <code><a href="#topic+BDP2workflow">BDP2workflow</a></code>, <code><a href="#topic+BDP2">BDP2</a></code> and <code><a href="#topic+plotBDP2">plotBDP2</a></code>. <code><a href="#topic+BDP2workflow">BDP2workflow</a></code> provides an interactive shiny app which also generates Word/pdf/html reports.
</p>


<h3>Author(s)</h3>

<p>Annette Kopp-Schneider, Manuel Wiesenfarth, Ulrich Abel
</p>
<p>Maintainer: Manuel Wiesenfarth &lt;m.wiesenfarth@dkfz.de&gt;
</p>


<h3>References</h3>

<p>Kopp-Schneider, A., Wiesenfarth, M., Witt, R., Edelmann, D., Witt, O. and Abel, U. (2018).<br /> Monitoring futility and efficacy in phase II trials with Bayesian
posterior distributions - a calibration approach. 
<em>Biometrical Journal</em>, to appear.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Starts Shiny app
  BDP2workflow()

## End(Not run)
</code></pre>

<hr>
<h2 id='BDP2'>
Operating characteristics of a single-arm trial with a binary
endpoint 
</h2><span id='topic+BDP2'></span>

<h3>Description</h3>

<p>Determines the operating characteristics of a single-arm trial with a binary
endpoint (response, success) and interim efficacy and futility analyses.
Declaration of efficacy and futility (including possibly early stopping)
is based on the posterior probability that the true response rate
is at least pE , pF respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BDP2(n, interim.at, ptrue, 
      eff.stop = FALSE, 
      pF, cF, pE = NULL, cE = NULL, 
      type="PostProb", alpha=0.05,
      shape1F, shape2F, shape1E = NULL, shape2E = NULL, 
      simulate = FALSE, nsim = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BDP2_+3A_n">n</code></td>
<td>
<p>sample size at the final analysis</p>
</td></tr>
<tr><td><code id="BDP2_+3A_interim.at">interim.at</code></td>
<td>
<p>vector of sample sizes at the interim analyses</p>
</td></tr>
<tr><td><code id="BDP2_+3A_ptrue">ptrue</code></td>
<td>
<p>true (assumed) response rate used for analytical evaluations or simulating the trial</p>
</td></tr>
<tr><td><code id="BDP2_+3A_eff.stop">eff.stop</code></td>
<td>

<p><code>FALSE</code>: No evaluation of efficacy. 
<code>"call"</code>:  no stop for
efficacy; in this case the program merely calculates the probability
that the efficicacy criterion is satisfied (possibly triggering a
notification of the DMC and the start of the planning of a subsequent
trial).
<code>"stop"</code>: the study ends if the efficacy criterion is reached at an interim analysis.
</p>
</td></tr>
<tr><td><code id="BDP2_+3A_pf">pF</code></td>
<td>
<p>response rate used for the futility criterion (may be identical to pE)</p>
</td></tr>
<tr><td><code id="BDP2_+3A_cf">cF</code></td>
<td>
<p>critical level of posterior probabilities used for declaring futility </p>
</td></tr>
<tr><td><code id="BDP2_+3A_pe">pE</code></td>
<td>
<p>response rate used for the efficacy criterion</p>
</td></tr>
<tr><td><code id="BDP2_+3A_ce">cE</code></td>
<td>
<p>critical level of posterior probabilities used for declaring efficacy</p>
</td></tr>
<tr><td><code id="BDP2_+3A_type">type</code></td>
<td>
<p>&quot;PostProb&quot; for decisions based on posterior probabilities (default) or &quot;PredictivePower&quot; for decisions based on predictive power (currently only implemented for <code>simulate==TRUE</code>)</p>
</td></tr>
<tr><td><code id="BDP2_+3A_alpha">alpha</code></td>
<td>
<p>significance level for final test (only for <code>simulate==TRUE &amp; type=="PredictivePower"</code>) </p>
</td></tr>
<tr><td><code id="BDP2_+3A_shape1f">shape1F</code></td>
<td>
<p>first parameter of the Beta prior for futility analysis</p>
</td></tr>
<tr><td><code id="BDP2_+3A_shape2f">shape2F</code></td>
<td>
<p>second parameter of the Beta prior for futility analysis</p>
</td></tr>
<tr><td><code id="BDP2_+3A_shape1e">shape1E</code></td>
<td>
<p>first parameter of the Beta prior for efficacy analysis</p>
</td></tr>
<tr><td><code id="BDP2_+3A_shape2e">shape2E</code></td>
<td>
<p>second parameter of the Beta prior for efficacy analysis </p>
</td></tr>
<tr><td><code id="BDP2_+3A_simulate">simulate</code></td>
<td>
<p><code>FALSE</code> for analytical evaluation and <code>TRUE</code> for simulation</p>
</td></tr>
<tr><td><code id="BDP2_+3A_nsim">nsim</code></td>
<td>
<p>number of simulation runs (only used if <code>simulate==TRUE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assumptions:
Endpoint (response/no response) data available for all study patients.
Beta-binomial model. Prior distribution = Beta(shape1, shape2).
</p>


<h4>Decisions based on posterior probabilities</h4>

<p>The posterior distribution at interim analysis with n.int  patients and k.int
successes is Beta(k.int + shape1F, n.int + shape2F - k.int) and Beta(k.int + shape1E, n.int + shape2E - k.int), respectively.
Efficacy is declared if the posterior probability P(true response rate &gt; pE)
is &gt;= cE.
Futility is declared if the posterior probability P(true success rate &gt; pF)
is &lt; cF.
cF, cE translate into futility/efficacy boundaries (maximum number of
responses leading to early termination for futility/ minimum number of responses
leading to declaring of, or early termination for, efficacy).
</p>



<h4>Decisions based on predictive power</h4>

<p>Given the results of the interim analysis, the predictive power at the final analysis
(n patients, critical number of successes k.crit) is P(X &gt;= k.crit - k.int), where
X  follows a beta-binomial distribution with parameters n'= n - n.int, a = k.int + shape1,
and b = n.int - k.int + shape2.
</p>
<p>Efficacy is declared if the predictive power is &gt;= cE (cE must be high, e.g. 0.70).
Futility is declared if the predictive power is &lt; cF (cF must be small, e.g. 0.10).
cE, cF translate into futility/efficacy boundaries (maximum number of
responses leading to early termination for futility/ minimum number of responses
leading to declaring of, or early termination for, efficacy).
</p>



<h3>References</h3>

<p>Kopp-Schneider, A., Wiesenfarth, M., Witt, R., Edelmann, D., Witt, O. and Abel, U. (2018).<br /> Monitoring futility and efficacy in phase II trials with Bayesian
posterior distributions - a calibration approach. 
<em>Biometrical Journal</em>, to appear.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Operating characteristics with calling for efficacy
BDP2(n=20, interim.at = c(3,9,13,18), ptrue = 0.3, 
      eff.stop = "call",
      pF=0.3, cF=0.01, pE=0.12, cE = 0.9, 
      type="PostProb", 
      shape1F=0.3, shape2F=0.7, shape1E=0.12, shape2E=0.88)

# Operating characteristics with stopping for efficacy
BDP2(n=20, interim.at = c(3,9,13,18), ptrue = 0.3, 
      eff.stop = "stop",
      pF=0.3, cF=0.01, pE=0.12, cE = 0.9, 
      type="PostProb", 
      shape1F=0.3, shape2F=0.7, shape1E=0.12, shape2E=0.88)



</code></pre>

<hr>
<h2 id='BDP2_simulate'>
Simulated operating characteristics of a single-arm trial with a binary
endpoint for different types of futility criteria</h2><span id='topic+BDP2_simulate'></span>

<h3>Description</h3>

<p>NOTE: Usually function <code><a href="#topic+BDP2">BDP2</a></code> will be preferred.
</p>
<p>Determines the operating characteristics of a single-arm trial with a binary
endpoint (success - failure) and interim futility analyses.
The user can choose among 10 futility criteria, which are based on predictive
or conditional power (the latter either assuming H1 or the MLE), posterior
or predictive probabilities, tail probabilites (under H0 or H1), constant success
rates, or arbitrary user-defined futility bounds.
</p>
<p>Assumptions:
Endpoint (success/no success) data available for all study patients.
In case of Bayesian analysis: Beta-binomial model. Prior distribution = Beta(shape1,shape2) (uniform if prior.mean=0.5,prior.sampleSize=2)
In case of predictive or conditional power, tail probabilities, or rates: One-sided
testing in the final analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BDP2_simulate(n, vn.int, p, p0, p1, 
              alpha = 0.05, crit, type = 5, nsim, 
              shape1 = 1, shape2 = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BDP2_simulate_+3A_n">n</code></td>
<td>
<p>sample size at the final analysis
</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_vn.int">vn.int</code></td>
<td>

<p>vector of sample sizes at the interim analyses (the vector may be equal
to 1:(n-1) = continuous monitoring of futility)
</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_p">p</code></td>
<td>
<p>true (assumed) success rate used for simulating the trial
</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_p0">p0</code></td>
<td>
<p>success rate corresponding to H0
</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_p1">p1</code></td>
<td>
<p>success rate corresponding to H1 (p1 &gt; p0)
</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_alpha">alpha</code></td>
<td>
<p>nominal probability of type 1 error used for the final test
</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_crit">crit</code></td>
<td>

<p>critical level(s) of predictive/conditional power, (posterior)
probabilities, rates, or patient numbers used for early termination.
crit translates into futility boundaries (maximum number of successes
leading to early termination).
If simple rates are used for monitoring futility (type=7), crit is the
critical success rate.
Rates or probabilites must be input as percentages (???). In case of type 10
analyses, crit must be  a vector of numbers of successes indicating futility
bounds at each (interim or final)analysis.
</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_type">type</code></td>
<td>

<p>type of futility analysis: 1=predictive power; 2=conditional power under H1;
3=conditional power under the MLE; 4=posterior probability of a success
rate &gt; p0;  5=posterior probability of a success rate &gt;= p1;
6=predictive probability of reaching a &quot;positive&quot; final study result,
where &quot;positive&quot; is defined in terms of the posterior probability of a
success rate &gt; p0. (Here, the ciritcal level must be &gt;= 1- alpha).
7=estimated success rate; 8=p-values; 9=&quot;p-values under H1&quot;; 10=user-
defined bounds (a vector of critical numbers of successes for each analysis)</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_nsim">nsim</code></td>
<td>
<p>number of simulation runs
</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_shape1">shape1</code></td>
<td>
<p>shape parameter for prior distribution
</p>
</td></tr>
<tr><td><code id="BDP2_simulate_+3A_shape2">shape2</code></td>
<td>
<p>shape parameter for prior distribution
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some methodological details on the 10 types of futility criteria:
</p>
<p>Type 1: Predictive power.
Given the results of the interim analysis the predictive power at the final analysis
(n patients, critical number of successes k.crit) is P(X &gt;= k.crit - k.int), where
X  follows a beta-binomial distribution with parameters n'= n - n.int, a = k.int + shape1,
and b= n.int - k.int + shape2.
</p>
<p>Type 2,3: Conditional power.
The conditional power at the interim analysis is P(X &gt;= k.crit - k.int), where X
follows a binomial distribution with parameters n'= n - n.int, and success probability
either equal to p1 (futility analysis type 2) or to the estimated success rate (MLE)
at the interim analysis (type 3.)
</p>
<p>Type 4,5:Posterior probabilities.
The posterior distribution at interim analysis with n.int  patients and k.int
successes is Beta(k.int + shape1, n + shape2 - k.int)
Type  4: Futility is declared if the posterior probability P(true success rate &gt; p0)
is &lt; crit. (Here, crit must be large,e.g. 70%).
Type  5: Futility is declared if the posterior probability P(true success rate &gt;= p1)
is &lt; crit. (Here, crit must be small, e.g. 10%).
</p>
<p>Type 6: Predictive probability combined with posterior probability.
Futility is declared if the posterior predictive probability that the study
will be a success is &lt; crit (e.g. 10%). Here, the success is defined by the total number
of successes in the trial yielding a posterior probability of at least 1 - alpha
(when evaluated in the final analysis) that the true success rate is &gt; p0.
</p>
<p>Type 7: Estimated success rates.
Futility is declared if the success rate is smaller than a fixed benchmark crit. The
final analysis is test-based.
</p>
<p>Type 8,9: Tail probabilites under H0,H1.
Type 8: The futility criterion uses an alpha level crit that is constant across all
interim analysis. The final analysis is test-based. Futility is declared if the p-value
(upper tail) is &gt;= crit.
Type 8 futility analyses should only be used if the number of patients at the first
interim analysis is not too low (say, at least 5 to 10). The value of crit is not
identicalt o the alpha level used in the final test. Generally, a fairly high value of
crit will be appropriate (e.g. 70%).
Type 9: Similar to type 8, but with lower-tail probabilites calculated under H1
(&quot;p-values under H1&quot;).
I.e., futility is declared if, under H1, the probability of obtaining at most as many
successes as the observed number is &lt; crit (&quot;observed number of successes &quot;too low&quot; to
be compatible with H1 at one-sided significance level = crit).
Generally, a small value of crit (e.g. 5% or 10%) should be chosen.
</p>
<p>Type 10: User-defined boundaries.
Here, the futility boundaries (maximum numbers of successes leading to early termination)
are directly input by the user. crit ist the vector of these boundaries at each
(interim or final) analysis. The study is terminated if the number of successes is
at analysis no. m is &lt;= the crit[m].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>BDP2_simulate(n=30, vn.int=c(10,20), 
              p=0.2, p0=0.1, p1=0.3, crit=0.1, type=5, nsim=1000,shape1=1,shape2=1)
</code></pre>

<hr>
<h2 id='BDP2workflow'>
Shiny app for workflow
</h2><span id='topic+BDP2workflow'></span>

<h3>Description</h3>

<p>Starts a shiny app in the web browser. It provides a workflow to choose design parameters single-arm trial with a binary
endpoint (response, success) and interim efficacy and futility analyses as well as routines to determine and visualize operating characteristics. Also  Word/pdf/html reports can be generated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BDP2workflow(display.mode = "normal")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BDP2workflow_+3A_display.mode">display.mode</code></td>
<td>
<p>display.mode passed to <code>shiny::runApp()</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Kopp-Schneider, A., Wiesenfarth, M., Witt, R., Edelmann, D., Witt, O. and Abel, U. (2018).<br /> Monitoring futility and efficacy in phase II trials with Bayesian
posterior distributions - a calibration approach. 
<em>Biometrical Journal</em>, to appear.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Starts Shiny app
  BDP2workflow()

## End(Not run)
</code></pre>

<hr>
<h2 id='crit_general'>
Calculates CritBoundaries for different types of futility criteria
</h2><span id='topic+crit_general'></span>

<h3>Description</h3>

<p>Calculates CritBoundaries for different types of futility criteria
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crit_general(n, p0, p1, vn.int, alpha, crit, type=5, shape1 = 1, shape2 = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crit_general_+3A_n">n</code></td>
<td>
<p>sample size at the final analysis
</p>
</td></tr>
<tr><td><code id="crit_general_+3A_p0">p0</code></td>
<td>
<p>success rate corresponding to H0
</p>
</td></tr>
<tr><td><code id="crit_general_+3A_p1">p1</code></td>
<td>
<p>success rate corresponding to H1 (p1 &gt; p0)
</p>
</td></tr>
<tr><td><code id="crit_general_+3A_vn.int">vn.int</code></td>
<td>
<p>vector of sample sizes at the interim analyses (the vector may be equal to 1:(n-1) = continuous monitoring of futility)
</p>
</td></tr>
<tr><td><code id="crit_general_+3A_alpha">alpha</code></td>
<td>
<p>nominal probability of type 1 error used for the final test
</p>
</td></tr>
<tr><td><code id="crit_general_+3A_crit">crit</code></td>
<td>
<p>critical level(s) of predictive/conditional power, (posterior)
probabilities, rates, or patient numbers used for early termination.
crit translates into futility boundaries (maximum number of successes
leading to early termination).
If simple rates are used for monitoring futility (type=7), crit is the
critical success rate.
Rates or probabilites must be input as percentages. In case of type 10
analyses, crit must be  a vector of numbers of successes indicating futility
bounds at each (interim or final)analysis.
</p>
</td></tr>
<tr><td><code id="crit_general_+3A_type">type</code></td>
<td>
<p>see <code><a href="#topic+BDP2_simulate">BDP2_simulate</a></code> for details. Type of futility analysis: 1=predictive power; 2=conditional power under H1;
3=conditional power under the MLE; 4=posterior probability of a success
rate &gt; p0;  5=posterior probability of a success rate &gt;= p1;
6=predictive probability of reaching a &quot;positive&quot; final study result,
where &quot;positive&quot; is defined in terms of the posterior probability of a
success rate &gt; p0. (Here, the ciritcal level must be &gt;= 1- alpha).
7=estimated success rate; 8=p-values; 9=&quot;p-values under H1&quot;; 10=user-
defined bounds (a vector of critical numbers of successes for each analysis)
</p>
</td></tr>
<tr><td><code id="crit_general_+3A_shape1">shape1</code></td>
<td>
<p>for prior distribution
</p>
</td></tr>
<tr><td><code id="crit_general_+3A_shape2">shape2</code></td>
<td>
<p>for prior distribution
</p>
</td></tr>
</table>

<hr>
<h2 id='pFstop'>
Operating characteristics of a single-arm trial with a binary endpoint with futility stopping
</h2><span id='topic+pFstop'></span>

<h3>Description</h3>

<p>Determines the operating characteristics of a single-arm trial with a binary endpoint (success - failure) on the basis of analytical derivations. The design allows for futility stopping.
Outputs are
</p>

<ul>
<li><p> probability of futility stopping (P.futil) at each interim analysis 
</p>
</li>
<li><p> cumulative stopping probability up to the interim (P.futil.cum).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>pFstop(p, vn.int, v.crit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pFstop_+3A_p">p</code></td>
<td>
<p>true response rate
</p>
</td></tr>
<tr><td><code id="pFstop_+3A_vn.int">vn.int</code></td>
<td>
<p>vector of sample sizes at the interim analyses 
</p>
</td></tr>
<tr><td><code id="pFstop_+3A_v.crit">v.crit</code></td>
<td>
<p>vector of critical boundaries for futility stopping at the interim analyses (stop for futility if number of successes &lt;= boundary). Choose boundary=-1 if no stopping is allowed.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>pFstop(p=0.3,vn.int=c(3,9,13,18,20),v.crit=c(0,1,2,3,3))
</code></pre>

<hr>
<h2 id='pFstopEcall'>
operating characteristics of a single-arm trial with a binary endpoint with futility stopping and calling efficacy at interim
</h2><span id='topic+pFstopEcall'></span>

<h3>Description</h3>

<p>Determines the operating characteristics of a single-arm trial with a binary endpoint (success - failure) on the basis of analytical derivations.  The design allows for futility stopping and evaluates efficacy at interim.
Outputs are 
</p>

<ul>
<li><p>         probability of calling efficacy (P.effic)  at each interim analysis 
</p>
</li>
<li><p>         cumulative probability of calling efficacy up to the interim (P.effic.cum).
</p>
</li>
<li><p>          probability of futility stopping (P.futil)  at each interim analysis 
</p>
</li>
<li><p>          cumulative stopping probability up to the interim (P.futil.cum).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>pFstopEcall(p, vn.int, v.critE, v.critF)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pFstopEcall_+3A_p">p</code></td>
<td>
<p>true response rate
</p>
</td></tr>
<tr><td><code id="pFstopEcall_+3A_vn.int">vn.int</code></td>
<td>
<p>vector of sample sizes at the interim analyses 
</p>
</td></tr>
<tr><td><code id="pFstopEcall_+3A_v.crite">v.critE</code></td>
<td>
<p> vector of critical boundaries for calling efficacy at the interim analyses (call efficacy if number of successes &gt;= boundary)
</p>
</td></tr>
<tr><td><code id="pFstopEcall_+3A_v.critf">v.critF</code></td>
<td>
<p>vector of critical boundaries for futility stopping at the interim analyses (stop for futility if number of successes &lt;= boundary). Choose boundary=-1 if no stopping for futility is allowed.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>pFstopEcall(p=0.3,vn.int=c(3,9,13,18,20),v.critE=4:8, v.critF=c(0,1,2,3,3))
</code></pre>

<hr>
<h2 id='pFstopEstop'>
Operating characteristics of a single-arm trial with a binary endpoint with stopping for futility and stopping for efficacy</h2><span id='topic+pFstopEstop'></span>

<h3>Description</h3>

<p>Determines the operating characteristics of a single-arm trial with a binary endpoint (success - failure) on the basis of analytical derivations.  The design allows for stopping for futility and stopping for efficacy.
Outputs are 
</p>

<ul>
<li><p>          probability of stopping for efficacy (P.effic)  at each interim analysis 
</p>
</li>
<li><p>          cumulative probability of stopping for efficacy up to the interim (P.effic.cum).
</p>
</li>
<li><p>          probability of futility stopping (P.futil)  at each interim analysis 
</p>
</li>
<li><p>         cumulative stopping probability up to the interim (P.futil.cum).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>pFstopEstop(p, vn.int, v.critE, v.critF)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pFstopEstop_+3A_p">p</code></td>
<td>
<p>true response rate
</p>
</td></tr>
<tr><td><code id="pFstopEstop_+3A_vn.int">vn.int</code></td>
<td>
<p>vector of sample sizes at the interim analyses 
</p>
</td></tr>
<tr><td><code id="pFstopEstop_+3A_v.crite">v.critE</code></td>
<td>
<p>vector of critical boundaries for calling efficacy at the interim analyses (stop for efficacy if number of successes &gt;= boundary)
</p>
</td></tr>
<tr><td><code id="pFstopEstop_+3A_v.critf">v.critF</code></td>
<td>
<p> vector of critical boundaries for futility stopping at the interim analyses (stop for futility if number of successes &lt;= boundary). Choose boundary=-1 if no stopping for futility is allowed.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>pFstopEstop(p=0.3,vn.int=c(3,9,13,18,20),v.critE=4:8, v.critF=c(0,1,2,3,3))
</code></pre>

<hr>
<h2 id='plot.cE_vs_pEcall'>
Plot objects returned by plotBDP2()
</h2><span id='topic+plot.cE_vs_pEcall'></span><span id='topic+plot.cE_vs_pEstop'></span>

<h3>Description</h3>

<p>Plot objects returned by <code><a href="#topic+plotBDP2">plotBDP2</a></code> with arguments <code>x="cE"</code> and either <code>y="PEcall"</code> or <code>y="PEstop"</code> which can computationally be relatively expensive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cE_vs_pEcall'
plot(x, ...)
## S3 method for class 'cE_vs_pEstop'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cE_vs_pEcall_+3A_x">x</code></td>
<td>

<p>Object returned by <code><a href="#topic+plotBDP2">plotBDP2</a></code> with arguments <code>x="cE"</code> and either <code>y="PEcall"</code> or <code>y="PEstop"</code>
</p>
</td></tr>
<tr><td><code id="plot.cE_vs_pEcall_+3A_...">...</code></td>
<td>

<p>arguments passed to <code><a href="graphics.html#topic+plot.default">plot.default</a></code>
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>shape1F=0.3
shape2F=0.7
shape1E=0.12
shape2E=0.88
res=plotBDP2(x="cE",y="PEcall",n=30,interim.at=15,
             pF=0.3,cF=0.01,pE=0.12,cE=seq(.5,1,by=.01),p0=0.3,p1=0.12,
             shape1F=shape1F,shape2F=shape2F,shape1E=shape1E,shape2E=shape2E,
             col=c("green","red"),cex.sub=.8)
plot(res)
</code></pre>

<hr>
<h2 id='plotBDP2'>
Plots
</h2><span id='topic+plotBDP2'></span>

<h3>Description</h3>

<p>Output of desired plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBDP2(x = c("n", "k", "ptrue", "cE", "cF"), 
          y = c("Prob0Successes", "PostProb0or1Successes", "bFbE", 
                "PEcall_p0_p1", "PEstop_p0_p1", 
                "PFstopEcall", "PFstopEstop",
                "PEcall", "PEstop", "PFstop", "PFstopEstop", 
                "ExpectedNumber", 
                "PredictivePower"), 
          n, interim.at, ptrue, 
          pF, cF, pE, cE, p0, p1, Estop=FALSE,
          shape1F, shape2F, shape1E = NULL, shape2E = NULL, 
          col = c("green", "red"), cex.legend=1, add = FALSE, 
          show=TRUE, progress = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotBDP2_+3A_x">x</code></td>
<td>

<p>character string specifying what is given by the x axis
</p>

<ul>
<li><p> &quot;n&quot; for number of patients at final or at first interim, depending on plot
</p>
</li>
<li><p> &quot;ptrue&quot; for the true response rate
</p>
</li>
<li><p> &quot;k&quot; number of successes at interim (only for <code>y=="PredictivePower"</code>)
</p>
</li>
<li><p> &quot;cE&quot; for the critical level of posterior probabilities used for declaring efficacy
</p>
</li>
<li><p> &quot;cF&quot; for the critical level of posterior probabilities used for declaring futility
</p>
</li></ul>

</td></tr>
<tr><td><code id="plotBDP2_+3A_y">y</code></td>
<td>

<p>character string specifying what is given by the y axis
</p>

<ul>
<li><p> &quot;Prob0Successes&quot; for plot of probability of 0 successes out of n at first interim, i.e. (1-p)^n. Two curves are generated: one for p0 and one for p1. Choose x=&quot;n&quot; and set n to a vector of number patients at first interim.
</p>
</li>
<li><p> &quot;PostProb0or1Successes&quot; generates two curves of posterior probability that reponse rate exceeds cF. One given 0 successes and one given 1 success observed in n, i.e. P(p&gt;pF| 0 successes out of n) and P(p&gt;pF| 1 success out of n). Choose x=&quot;n&quot; and set n to a vector of number patients at first interim.
</p>
</li>
<li><p> &quot;bFbE&quot; for plot of boundaries for futility bF and for efficacy bE in terms of number of successes per n number of patients. Futility stop if number of successes &lt;= bF, call efficacy if number of successes &gt;= bE. Choose x=&quot;n&quot; and set n to the maximal number of patients (not a vector).
</p>
</li>
<li><p> &quot;PEcall_p0_p1&quot; for plot of probability to call efficacy at final (i.e. P(p&gt;pE|Data)&gt;=cE ), evaluated for data generated with control response rate p0 (corresponds to type I error) and for data generated with target response rate p1 (corresponds to power) for varying number of patients at final. Choose x=&quot;n&quot; and set n to a vector of number patients at final.
</p>
</li>
<li><p> &quot;PEstop_p0_p1&quot; as above but with stopping for efficacy instead of calling efficacy 
</p>
</li>
<li><p> &quot;PFstopEcall&quot; for plotting operating characteristics for a given response rate as a function of number of patients at final, n. Shows one curve (default: in red) for the probability of stopping for futility up to final analysis and one curve (default: in green) for the probability of calling efficacy at final analysis. For the setting ptrue=p0, the curves show the probability of true stopping (default: in red) and type I error (default: in green). For the setting ptrue=p1, the curves show the probability of false stopping (default: in red) and power (default: in green). Choose x=&quot;n&quot; and set n to a vector of number patients at final.
</p>
</li>
<li><p> &quot;PFstopEstop&quot; as above but with stopping for efficacy instead of calling efficacy 
</p>
</li>
<li><p> &quot;PEcall&quot; for plot of probability to call efficacy at final (i.e. P(p&gt;pE|Data)&gt;=cE ). 
</p>

<ul>
<li><p> For x=&quot;ptrue&quot; then this is the power function. 
</p>
</li>
<li><p> For x=&quot;cE&quot; this gives plots of probability to call efficacy at final, evaluated for data generated with control response rate p0 (corresponds to type I error) and for data generated with target response rate p1 (corresponds to power).
</p>
</li></ul>

</li>
<li><p> &quot;PEstop&quot; 
</p>

<ul>
<li><p> For x=&quot;ptrue&quot; then this is the power function. 
</p>
</li>
<li><p> For x=&quot;cE&quot; this gives plots of probability to call efficacy at final, evaluated for data generated with control response rate p0 (corresponds to type I error) and for data generated with target response rate p1 (corresponds to power).
</p>
</li></ul>

</li>
<li><p> &quot;PFstop&quot; for plot of cumulative probability to stop for futility up to final.
</p>

<ul>
<li><p> For x=&quot;ptrue&quot; this gives the futility stopping probability as function of ptrue. 
</p>
</li>
<li><p> For x=&quot;cF&quot; this gives 2 curves, evaluated for data generated with control response rate p0 (corresponds to true stopping probability, default: in green) and for data generated with target response rate p1 (corresponds to false stopping probability, default: in red).
</p>
</li></ul>

</li>
<li><p> &quot;ExpectedNumber&quot; for expected number of patients in the trial. Choose x= &quot;ptrue&quot;. 
Takes stopping for efficacy into account if <code>Estop==TRUE</code>
</p>
</li>
<li><p> &quot;PredictivePower&quot; for predictive power (only for <code>x=="k"</code>)
</p>
</li></ul>

</td></tr>
<tr><td><code id="plotBDP2_+3A_n">n</code></td>
<td>
<p>sample size at the final analysis, vector if <code>x=="n"</code></p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_interim.at">interim.at</code></td>
<td>
<p>vector of sample sizes at the interim analyses</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_ptrue">ptrue</code></td>
<td>
<p>true (assumed) response rate used for simulating the trial, vector if <code>x=="ptrue"</code></p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_pf">pF</code></td>
<td>
<p>response rate used for the futility criterion P(p&gt;pF|Data) &lt; cF (may be identical to pE)</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_cf">cF</code></td>
<td>
<p>critical level of posterior probabilities used for declaring futility, vector if <code>x=="cF"</code> </p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_pe">pE</code></td>
<td>
<p>response rate used for the efficacy criterion P(p&gt;pE|Data) &gt;= cE</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_ce">cE</code></td>
<td>
<p>critical level of posterior probabilities used for declaring efficacy, vector if <code>x=="cE"</code></p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_p0">p0</code></td>
<td>
<p>response rate corresponding to H0</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_p1">p1</code></td>
<td>
<p>response rate corresponding to H1 (p1 &gt; p0)</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_shape1f">shape1F</code></td>
<td>
<p>first parameter of the Beta prior for futility analysis</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_shape2f">shape2F</code></td>
<td>
<p>second parameter of the Beta prior for futility analysis</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_shape1e">shape1E</code></td>
<td>
<p>first parameter of the Beta prior for efficacy analysis</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_shape2e">shape2E</code></td>
<td>
<p>second parameter of the Beta prior for efficacy analysis </p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_estop">Estop</code></td>
<td>
<p>Stop for efficacy? Defaults to <code>FALSE</code>. Only relevant if <code>y=="ExpectedNumber"</code>. </p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_col">col</code></td>
<td>
<p>line color, for some plots vector of length 2.</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_add">add</code></td>
<td>
<p>add line to existing plot. Only supported if <code>x=="ptrue"</code></p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_show">show</code></td>
<td>
<p>show plot (otherwise computed objects are invisibly returned)</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_progress">progress</code></td>
<td>
<p>only used by shiny app</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_cex.legend">cex.legend</code></td>
<td>
<p>size of legend text relative to cex</p>
</td></tr>
<tr><td><code id="plotBDP2_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot.default()</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Kopp-Schneider, A., Wiesenfarth, M., Witt, R., Edelmann, D., Witt, O. and Abel, U. (2018).<br /> Monitoring futility and efficacy in phase II trials with Bayesian
posterior distributions - a calibration approach. 
<em>Biometrical Journal</em>, to appear.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See vignette for more details and examples
pF=0.3
pE=0.12
shape1F=0.3
shape2F=0.7
shape1E=0.12
shape2E=0.88
cF=0.01
cE=0.9
nvec=c(18:40)
interim.at=c(10,20,30)

# Type I error and probability of true stopping for the uninteresting response rate. 
ptrue=0.12
plotBDP2(x="n", y="PFstopEcall",
         n =nvec, interim.at = interim.at,
         pF=pF,cF=cF,pE=pE,cE=cE,ptrue=ptrue,
         shape1F=shape1F,shape2F=shape2F,shape1E=shape1E,shape2E=shape2E)


# Power and probability of false stopping for the target response rate. 
ptrue=0.3
plotBDP2(x="n", y="PFstopEcall",
         n =nvec, interim.at = interim.at,
         pF=pF,cF=cF,pE=pE,cE=cE,ptrue=ptrue,
         shape1F=shape1F,shape2F=shape2F,shape1E=shape1E,shape2E=shape2E)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
