<!DOCTYPE html><html lang="en"><head><title>Help for package seas</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {seas}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#A1128551.DLY'><p>MSC daily climate data file (DLY archive format) and instructions</p>
for Canadian Daily Climate Data CD-ROMs for analysis</a></li>
<li><a href='#change'><p>Find seasonal and annual changes between two data sets</p></a></li>
<li><a href='#conv365toGregorian'><p>Converts a data.frame using a 365-day calendar to a Gregorian calendar</p></a></li>
<li><a href='#dathomog'><p>Homogenize daily data sets</p></a></li>
<li><a href='#getstnname'><p>Get station name</p></a></li>
<li><a href='#hidden'><p>Return title and properties for seasonal graphs</p></a></li>
<li><a href='#image.seas.sum'><p>Show a seasonal sum data object</p></a></li>
<li><a href='#interarrival'><p>Calculate the interarrivals between and within precipitation events</p></a></li>
<li><a href='#lars'><p>Read and write data from LARS-WG file formats</p></a></li>
<li><a href='#mkann'><p>Make annum from a date</p></a></li>
<li><a href='#mkseas'><p>Make a date into a seasonal factor</p></a></li>
<li><a href='#mksub'><p>Make a subset of seasonal data</p></a></li>
<li><a href='#mscdata'><p>Meteorological Service of Canada sample climate data</p></a></li>
<li><a href='#mscstn'><p>Meteorological Service of Canada station information</p></a></li>
<li><a href='#plot.interarrival'><p>Plot interarrivals for precipitation</p></a></li>
<li><a href='#plot.seas.norm'><p>Plot seasonal normal of a variable, including precipitation normals</p></a></li>
<li><a href='#plot.seas.sum'><p>Plot boxplots of normalized seasonal sums</p></a></li>
<li><a href='#precip.dep'><p>Cumulative precipitation departure</p></a></li>
<li><a href='#read.msc'><p>Read a MSC archive file into a data.frame</p></a></li>
<li><a href='#sdsm'><p>Read and write from SDSM</p></a></li>
<li><a href='#seas-package'><p>Seasonal statistics: the &lsquo;seas&rsquo; package for R</p></a></li>
<li><a href='#seas.check'><p>Check the suitability of a data.frame, or seas.sum for seas</p></a></li>
<li><a href='#seas.norm'><p>Calculate annual and seasonal &lsquo;normal&rsquo; statistics, including</p>
precipitation normals</a></li>
<li><a href='#seas.sum'><p>Seasonal sum data object</p></a></li>
<li><a href='#seas.temp.plot'><p>Plot seasonal temperature normals</p></a></li>
<li><a href='#seas.var.plot'><p>Plot seasonal normals of a given variable</p></a></li>
<li><a href='#SeasOpts'><p>Options for seas</p></a></li>
<li><a href='#summerland'><p>Example LARS-WG data file of synthetic data from Summerland, BC</p></a></li>
<li><a href='#write.help'><p>Write climate data in the format used by the HELP model</p></a></li>
<li><a href='#year.length'><p>Calculate the number of days in a year</p></a></li>
<li><a href='#year.ploy'><p>Plot annual temperature and precipitation statistics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-01</td>
</tr>
<tr>
<td>Title:</td>
<td>Seasonal Analysis and Graphics, Especially for Climatology</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 2.15.0), MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Capable of deriving seasonal statistics, such as "normals", and
  analysis of seasonal data, such as departures. This package also has
  graphics capabilities for representing seasonal data, including boxplots for
  seasonal parameters, and bars for summed normals. There are many specific
  functions related to climatology, including precipitation normals,
  temperature normals, cumulative precipitation departures and precipitation
  interarrivals. However, this package is designed to represent any
  time-varying parameter with a discernible seasonal signal, such as found
  in hydrology and ecology.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mwtoews/seas">https://github.com/mwtoews/seas</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mwtoews/seas/issues">https://github.com/mwtoews/seas/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-01 09:49:42 UTC; mtoews</td>
</tr>
<tr>
<td>Author:</td>
<td>Mike Toews <a href="https://orcid.org/0000-0003-3657-7963"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mike Toews &lt;mwtoews@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-02 09:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='A1128551.DLY'>MSC daily climate data file (DLY archive format) and instructions
for Canadian Daily Climate Data CD-ROMs for analysis</h2><span id='topic+A1128551.DLY'></span>

<h3>Description</h3>

<p>Meteorological Service of Canada daily climate data (DLY archive
format) from Vernon. This document also describes how to obtain data
from the Canadian Daily Climate Data CD-ROMs for analysis in
<span class="pkg">seas</span>.
</p>


<h3>Format</h3>

<p>MSC DLY archive format (4-digit year).
</p>


<h3>Details</h3>

<p>The sample file name is &lsquo;<span class="file">A1128551.DLY</span>&rsquo;, which contains daily
climate data from Vernon, British Columbia. Load this file using
<code><a href="#topic+read.msc">read.msc</a></code>.
</p>
<p>This file was created using the instructions below, with the addition
of renaming the file extension from &lsquo;<span class="file">*.ALL</span>&rsquo; to &lsquo;<span class="file">*.DLY</span>&rsquo;.
</p>


<h3>How to obtain Canadian Daily Climate Data</h3>

<p>Two CDCD CD-ROMs are currently available for free download, which have
data from 11,216 locations throughout Canada.
</p>
<p>This procedure shows how to extract the data using &lsquo;<span class="file">CDEX.EXE</span>&rsquo;,
which requires a DOS environment. There is, however, an alternative
Python module, which can batch extract data from the CD-ROMs.  If you
are using a non-Microsoft platform, you could try &lsquo;DOSBox&rsquo; to
emulate the DOS environment (tested on Debian and Mac OS X; hint:
mount the CD-ROM drive by using <code>-t cdrom</code> option).
</p>
<p>To extract data from the CD-ROM:
</p>

<ol>
<li><p> Insert CD-ROM, and run &lsquo;<span class="file">CDEX.EXE</span>&rsquo; (or double-click it)
</p>
</li>
<li><p> Select a &lsquo;district&rsquo;; press &lsquo;enter&rsquo;
</p>
</li>
<li><p> Select a &lsquo;station&rsquo;; press &lsquo;enter&rsquo;
</p>
</li>
<li><p> Select &lsquo;Elements to Convert&rsquo;, and select the desired
fields using the &lsquo;space bar&rsquo;; press &lsquo;enter&rsquo;
</p>
</li>
<li><p> Change &lsquo;Drive/directory of output files&rsquo; to a
convenient location, for example &lsquo;<span class="file">C:\TEMP</span>&rsquo;
</p>
</li>
<li><p> Press &lsquo;F10&rsquo; to extract the data (the name of the file
is the 7-digit alphanumeric station number, followed by a
&lsquo;.ALL&rsquo; extension)
</p>
</li>
<li><p> Repeat these steps for each meteorological station desired (if
there are more).
</p>
</li></ol>

<p>Multiple stations can be imported and combined before or after
importing into <span class="rlang"><b>R</b></span>. Multiple files can be concatenated into one from
the system shell (e.g. DOS: <code>COPY *.ALL new.dly</code>, or UNIX:
<code>cat *.ALL &gt; new.dly</code>). This cleans up the <span class="rlang"><b>R</b></span> workspace by only
using one object to refer to several stations. Stations can be
referred to functions in <span class="pkg">seas</span> using their IDs.
</p>
<p>To import the archive file into <span class="rlang"><b>R</b></span>:
</p>

<ol>
<li><p> Start <span class="rlang"><b>R</b></span>; type <code>library(seas)</code>
</p>
</li>
<li><p> Import using <code>dat &lt;- read.msc("/temp/C1161661.ALL")</code>
(note that <span class="rlang"><b>R</b></span> uses forward slashes for directories, but you could
alternatively type &quot;C:\\TEMP\\C1161661.ALL&quot; on a Microsoft-based
platform to &lsquo;escape&rsquo; the back slash characters)
</p>
</li></ol>

<p>To export the data from <span class="rlang"><b>R</b></span> in a more convenient format for other programs,
use <code>write.csv(dat,"out.csv")</code>; MS Excel users may want to turn
<code>NA</code> values into the format recognized by Excel, so modify the
expression to <code>write.csv(dat,"out.csv",na="#N/A")</code>.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>Source</h3>

<p>Data provided by the Meteorological Service of Canada, with permission.
</p>
<p>This data may only be reproduced for personal use; any other
reproduction is permitted only with the written consent of Environment
Canada (<a href="https://weather.gc.ca/mainmenu/contact_us_e.html">https://weather.gc.ca/mainmenu/contact_us_e.html</a>).
</p>


<h3>References</h3>

<p><a href="https://web.archive.org/web/20130625230337/http://climate.weatheroffice.gc.ca/prods_servs/documentation_index_e.html">https://web.archive.org/web/20130625230337/http://climate.weatheroffice.gc.ca/prods_servs/documentation_index_e.html</a> (archived) Technical Documentation - Documentation for the Digital Archive of Canadian Climatological Data (Surface) Identified By Element
</p>
<p><code style="white-space: pre;">&#8288;http://climate.weatheroffice.gc.ca/prods_servs/index_e.html#cdcd&#8288;</code> (dead link) CDCD CD-ROM download location
</p>
<p><a href="https://www.dosbox.com">https://www.dosbox.com</a> for emulating DOS on non-Microsoft
platforms
</p>
<p><a href="https://www.intevation.de/~bernhard/archiv/uwm/canadian_climate_cdformat/">https://www.intevation.de/~bernhard/archiv/uwm/canadian_climate_cdformat/</a> an alternative method of extracting data from the CDCD CD-ROMs using a Python module by Bernhard Reiter
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.msc">read.msc</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>fname &lt;- system.file("extdata", "A1128551.DLY", package="seas")
print(fname)
dat &lt;- read.msc(fname)
head(dat)
str(dat)

seas.temp.plot(dat)
year.plot(dat)
</code></pre>

<hr>
<h2 id='change'>Find seasonal and annual changes between two data sets</h2><span id='topic+change'></span>

<h3>Description</h3>

<p>Find seasonal and annual changes between two data sets; relative and
absolute changes are found between the central tendency and spread of
each seasonal state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change(x1, x2, var1, var2 = var1, width = "mon",
       cent = "mean", sprd = "sd", disc = FALSE, inter = FALSE,
       p.cut = 0.3, start.day = 1, calendar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_+3A_x1">x1</code></td>
<td>
<p>a <code>data.frame</code> of seasonal data</p>
</td></tr>
<tr><td><code id="change_+3A_x2">x2</code></td>
<td>
<p>a second <code>data.frame</code> of seasonal data</p>
</td></tr>
<tr><td><code id="change_+3A_var1">var1</code></td>
<td>
<p>a variable in <code>x1</code></p>
</td></tr>
<tr><td><code id="change_+3A_var2">var2</code></td>
<td>
<p>a variable in <code>x2</code></p>
</td></tr>
<tr><td><code id="change_+3A_width">width</code></td>
<td>
<p>the width of the bins, see <code><a href="#topic+mkseas">mkseas</a></code> for more
details; this will change the sample-sizes between <code>x1</code> and
<code>x2</code>, which can affect the changes detected</p>
</td></tr>
<tr><td><code id="change_+3A_cent">cent</code></td>
<td>
<p>a <code><a href="base.html#topic+function">function</a></code> to find a central tendency;
usually this is <code><a href="base.html#topic+mean">mean</a></code>, however <code><a href="stats.html#topic+median">median</a></code> or
other functions can be used too</p>
</td></tr>
<tr><td><code id="change_+3A_sprd">sprd</code></td>
<td>
<p>a <code>function</code> to find a spread around a central
tendency; usually this will be <code><a href="stats.html#topic+sd">sd</a></code>
(standard-deviation), however <code><a href="stats.html#topic+mad">mad</a></code> or other functions
can be used too</p>
</td></tr>
<tr><td><code id="change_+3A_disc">disc</code></td>
<td>
<p>if the data are discontinuous, the <code>seas.sum</code> objects
are created for <code>var1</code>/<code>var2</code> to determine the changes;
this is ideal for precipitation, and other sparsely distributed
variables</p>
</td></tr>
<tr><td><code id="change_+3A_inter">inter</code></td>
<td>
<p><code><a href="#topic+interarrival">interarrival</a></code>s are calculated, and changes
are found between <em>wet</em> and <em>dry</em> series</p>
</td></tr>
<tr><td><code id="change_+3A_p.cut">p.cut</code></td>
<td>
<p>cut-off for wet/dry; see <code><a href="#topic+interarrival">interarrival</a></code></p>
</td></tr>
<tr><td><code id="change_+3A_start.day">start.day</code></td>
<td>
<p>starting day</p>
</td></tr>
<tr><td><code id="change_+3A_calendar">calendar</code></td>
<td>
<p>calendar; if not specified it will try to read this
from the attributes, otherwise it is assumed to be a proleptic
Gregorian calendar; see <code><a href="#topic+year.length">year.length</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is useful for finding changes between different states of
seasonal data. Here, a <em>state</em> represents how seasonal data
behave statistically at either a <em>time</em> or
<em>place</em>. The stability of a state depends on both the variance
throughout each portion of the season, as well as the number of years
of observations.
</p>
<p>For instance, seasonal and annual changes in climate can be detected
in climate data series, by comparing the normals from two time periods.
</p>


<h3>Value</h3>

<p>Returns a complex <code><a href="base.html#topic+list">list</a></code> of relative and absolute (if
applicable) changes of <code>var1</code>/<code>var2</code> between <code>x1</code> and
<code>x2</code>.
</p>
<p>Seasonal and annual changes are identified independently of each
other; where annual changes have a <code>ann</code> prefix.
</p>
<p>Relative changes are not found if <code>x$var</code> has values less than 0,
such as Temperature measured in degrees C or F.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+dathomog">dathomog</a></code>, <code><a href="#topic+lars">lars</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)
dat1 &lt;- mksub(mscdata, id=1108447, start=1975, end=1984)
dat2 &lt;- mksub(mscdata, id=1108447, start=1985, end=1995)

# A few plot functions to make thing easy
plot.ch &lt;- function(x, main, h, col) {
  main &lt;- paste(main, "between 1975-1984 and 1985-1994", sep="\n")
  barplot(x, main=main)
  abline(h=c(0, h), col=c(1, col), lty=c(1, 2))
}
plot.abs &lt;- function(x, col="red", abs="abs", ann.abs="ann.abs") {
  main &lt;- sprintf("Absolute change in %s", x$long.name[[1]])
  plot.ch(x[[abs]], main, x[[ann.abs]], col)
}
plot.rel &lt;- function(x, col="orange", rel="rel", ann.rel="ann.rel") {
  main &lt;- sprintf("Relative change in %s", x$long.name[[1]])
  plot.ch(x[[rel]], main, x[[ann.rel]], col)
}
plot.std &lt;- function(x, col="purple") {
  main &lt;- sprintf("Relative change in the\nstandard deviation of %s",
                  x$long.name[[1]])
  plot.ch(x$sprd.rel, main, x$ann.sprd.rel, col)
}

# Minimum temperature
ch &lt;- change(dat1, dat2, "t_min")
str(ch)
plot.abs(ch)
plot.std(ch)
# Cannot do ch$rel ; since div/0!

# Precipitation
ch2 &lt;- change(dat1, dat2, "precip", width="DJF", disc=TRUE)
plot.abs(ch2, "blue")
plot.rel(ch2, "purple")
plot.std(ch2)

</code></pre>

<hr>
<h2 id='conv365toGregorian'>Converts a data.frame using a 365-day calendar to a Gregorian calendar</h2><span id='topic+conv365toGregorian'></span>

<h3>Description</h3>

<p>Converts a <code>data.frame</code> with a 365-day calendar to a proleptic
Gregorian calendar, repeating data from December 30th on a leap year
to the remaining and missing December 31st.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conv365toGregorian(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conv365toGregorian_+3A_x">x</code></td>
<td>
<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> with a <code>date</code> column</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function may be expanded in the future to be more flexible.
</p>


<h3>Value</h3>

<p>Returns a <code><a href="base.html#topic+data.frame">data.frame</a></code> with Gregorian calendar dates.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>

<hr>
<h2 id='dathomog'>Homogenize daily data sets</h2><span id='topic+dathomog'></span>

<h3>Description</h3>

<p>Homogenizes daily data from two data sets into one data set; optionally show
cross-plots to examine how well correlated that data sets are.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dathomog(x1, x2, by = "date", plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dathomog_+3A_x1">x1</code></td>
<td>
<p>a <code>data.frame</code> of seasonal data; 1st selection</p>
</td></tr>
<tr><td><code id="dathomog_+3A_x2">x2</code></td>
<td>
<p>a <code>data.frame</code> or seasonal data; 2nd selection</p>
</td></tr>
<tr><td><code id="dathomog_+3A_by">by</code></td>
<td>
<p>name of common column, usually &lsquo;date&rsquo;, which is of
class <code><a href="base.html#topic+Date">Date</a></code></p>
</td></tr>
<tr><td><code id="dathomog_+3A_plot">plot</code></td>
<td>
<p><code>logical</code>; produce cross-plots and correlation
statistics of the variables between the two data sets</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data from <code>x1</code> has priority over <code>x2</code>.  Where data from
<code>x1</code> is either <code>NA</code> or missing (outside of time range), data
from <code>x2</code> will be used (if available). Otherwise data form
<code>x1</code> will be used directly. Variables will be
homogenized where their names are identical, found using
<code><a href="base.html#topic+names">names</a></code>.
</p>
<p>The cross-plots of the data are shown only for interest. They show
useful correlation statistics, and a best-fit line using perpendicular
offsets (which are preferred in this case over traditional linear
regression). At some point, the equations for this line may be used to
adjust the values from <code>x2</code>, however this can always be done
externally to this function by pre-processing <code>x2</code>.
</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> of seasonal data required by most functions
in <span class="pkg">seas</span>. Variable names of the structure are found by a
<code><a href="base.html#topic+union">union</a></code> of the names of <code>x1</code> and <code>x2</code>.
</p>


<h3>Warning</h3>

<p>Weather stations should be sufficiently close enough to approximate
the same weather. This distance depends on the spatial distance and
local climatology.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p>http://mathworld.wolfram.com/LeastSquaresFittingPerpendicularOffsets.html</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)
dat1 &lt;- mksub(mscdata, id=2100630)
dat2 &lt;- mksub(mscdata, id=1108447)
year.plot(dat1)
year.plot(dat2)
newdata &lt;- dathomog(dat1, dat2)
year.plot(newdata)
message(paste(c("This is a rather poor example, since the",
                "two stations are nowhere near each other"),
                collapse="\n"))
</code></pre>

<hr>
<h2 id='getstnname'>Get station name</h2><span id='topic+getstnname'></span>

<h3>Description</h3>

<p>Retrieves the full name from <code><a href="#topic+mscstn">mscstn</a></code> using an ID
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getstnname(id)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getstnname_+3A_id">id</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> or <code><a href="base.html#topic+character">character</a></code> ID array</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simply converts the ID used in climate data frames into
a meaningful name using <code>mscstn</code>. Presently it is useful only for
Meteorological Service of Canada weather stations in BC, AB and YT,
however <code>getstnname</code> can be overridden by another (similar)
function and data object for other regions.
</p>


<h3>Value</h3>

<p>Returns the station name(s). If the ID does not exist, returns <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+mscstn">mscstn</a></code>, <code><a href="#topic+mscdata">mscdata</a></code>, <code><a href="#topic+.seastitle">.seastitle</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)

mscdata$id[1]
getstnname(mscdata$id[1])

ids &lt;- levels(mscdata$id)
data.frame(id=I(ids), name=getstnname(ids))
</code></pre>

<hr>
<h2 id='hidden'>Return title and properties for seasonal graphs</h2><span id='topic+hidden'></span><span id='topic+.seasxlab'></span><span id='topic+.seasylab'></span><span id='topic+.seastitle'></span><span id='topic+.seasmonthgrid'></span>

<h3>Description</h3>

<p>Return title, x- and y-axis labels for seasonal
graphs. Also, draw the month grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.seasxlab(width, start.day)
.seasylab(var, long.name = NULL, units = NULL)
.seastitle(main = NULL, id = NULL, name = NULL,
           orig = NULL, fun = NULL, range = NA)
.seasmonthgrid(width, days, start = 1, rep = 0, start.day = 1, month.label)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hidden_+3A_orig">orig</code></td>
<td>
<p>original object name, which is used if no other name can
be found from <code>id</code> or <code>name</code></p>
</td></tr>
<tr><td><code id="hidden_+3A_var">var</code></td>
<td>
<p>original variable name in <code>names(orig)</code></p>
</td></tr>
<tr><td><code id="hidden_+3A_width">width</code></td>
<td>
<p>size of bin; see <code><a href="#topic+mkseas">mkseas</a></code></p>
</td></tr>
<tr><td><code id="hidden_+3A_start.day">start.day</code></td>
<td>
<p>the starting day of annum for the first bin; as
either a <code><a href="base.html#topic+Date">Date</a></code> or <code><a href="base.html#topic+integer">integer</a></code> of day of the year</p>
</td></tr>
<tr><td><code id="hidden_+3A_main">main</code></td>
<td>
<p>main title of plot; overrides any other title, but appends
year range if <code>show.range=TRUE</code></p>
</td></tr>
<tr><td><code id="hidden_+3A_long.name">long.name</code></td>
<td>
<p>a long name for <code>var</code>, used for labelling y-axis</p>
</td></tr>
<tr><td><code id="hidden_+3A_units">units</code></td>
<td>
<p>units of <code>var</code>, used for labelling y-axis</p>
</td></tr>
<tr><td><code id="hidden_+3A_id">id</code></td>
<td>
<p>station ID, which is used to fetch a station name using
<code><a href="#topic+getstnname">getstnname</a></code></p>
</td></tr>
<tr><td><code id="hidden_+3A_name">name</code></td>
<td>
<p>a name, which is used for labels</p>
</td></tr>
<tr><td><code id="hidden_+3A_fun">fun</code></td>
<td>
<p>function, if applicable</p>
</td></tr>
<tr><td><code id="hidden_+3A_range">range</code></td>
<td>
<p>year range; <code>c(start.year, end.year)</code></p>
</td></tr>
<tr><td><code id="hidden_+3A_days">days</code></td>
<td>
<p>also known as <code>bin.lengths</code>, which represents the
maximum number of days expected in each bin for a complete annum</p>
</td></tr>
<tr><td><code id="hidden_+3A_start">start</code></td>
<td>
<p>the starting bin number</p>
</td></tr>
<tr><td><code id="hidden_+3A_rep">rep</code></td>
<td>
<p>the number of repeated bins</p>
</td></tr>
<tr><td><code id="hidden_+3A_month.label">month.label</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code>; put month name labels on grid</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are intended for producing the graphics, and do not
need to be used directly.
</p>
<p>The month grid is drawn by <code>.seasmonthgrid</code>, and can be
fine-tuned by setting some <a href="base.html#topic+options">options</a> in the <span class="rlang"><b>R</b></span> environment, found in
<code>seas.month.grid</code>. This <code><a href="base.html#topic+list">list</a></code>, for instance, has
<code>len</code> to adjust the length of each month label, and <code>col</code>
for the colour of the lines. See <code><a href="#topic+SeasOpts">SeasOpts</a></code> for all
available options, and instructions on how to change them.
</p>
<p>The main and variable/unit label formating can also be customized by
setting other options, documented in <code><a href="#topic+SeasOpts">SeasOpts</a></code>.
</p>


<h3>Value</h3>

<p><code>.seasxlab</code>, <code>.seasylab</code> and <code>.seastitle</code> return a
<code>character</code> label intended for plots.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+getstnname">getstnname</a></code>, <code><a href="#topic+SeasOpts">SeasOpts</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>setSeasOpts()

.seasxlab(11, 1)
.seasxlab("mon", 1)

# Not starting on January 1st
.seasxlab(11, 120)

# Labelled according to month (and possibly day)
getOption("seas.label")$month
.seasxlab("mon", as.Date("2000-08-01"))
getOption("seas.label")$monthday
.seasxlab(365/20, as.Date("2000-08-15"))
</code></pre>

<hr>
<h2 id='image.seas.sum'>Show a seasonal sum data object</h2><span id='topic+image.seas.sum'></span>

<h3>Description</h3>

<p>Graphically display a seasonal sum object, as well as the method of
solution of the median/quantile &ldquo;normal&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'seas.sum'
image(x, var, norm = "days", start = 1, rep = 0, zlim, alim,
    palette = colorRampPalette(c("white", "blue"))(64),
    year.filter, power, contour = TRUE, show.median, main, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="image.seas.sum_+3A_x">x</code></td>
<td>
<p>a <code><a href="#topic+seas.sum">seas.sum</a></code> object</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_var">var</code></td>
<td>
<p>the desired variable to show, otherwise will use the prime
variable, defined in <code>x</code></p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_norm">norm</code></td>
<td>
<p>variable to normalize by, usually <code>"days"</code>, to
produce <em>unit/day</em></p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_start">start</code></td>
<td>
<p>starting bin number; e.g., for monthly sums, if
<code>start=5</code>, the plot will start on &quot;May&quot; at the left-hand side;
<code>show.median</code> cannot be produced if <code>start</code> is greater
than one, since the annual sums (row-wise) would be a mix of
different annums</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_rep">rep</code></td>
<td>
<p>repetition of the bins (columns)</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_zlim">zlim</code></td>
<td>
<p>range of normalized values displayed; this can be either a
single number for the maximum (minimum set to zero), or a
<code>c(min, max)</code> range with a defined minimum</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_alim">alim</code></td>
<td>
<p>if <code>show.median</code>, this is the range for the annual
sums; this can either be a singe number for the maximum (minimum set
to zero, or a <code>c(min, max)</code> range with a defined minimum</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_palette">palette</code></td>
<td>
<p>colours for <code><a href="graphics.html#topic+image">image</a></code>; the use of
<code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code> is recommended</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_year.filter">year.filter</code></td>
<td>
<p>specifies the annual seasons to display</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_power">power</code></td>
<td>
<p>this transforms the normalized values for the colours to
a power (<code><a href="base.html#topic++5E">^</a></code>), such as <code>0.5</code> for square-root
(<code><a href="base.html#topic+sqrt">sqrt</a></code>), or others; this can help improve the contrast
in the display of data, but the quantities displayed in the
colour-bar and contours remain untransformed</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_contour">contour</code></td>
<td>
<p><code>logical</code>; show contours in lower left-hand plot</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_show.median">show.median</code></td>
<td>
<p><code>logical</code>; show how the median calculation is
achieved graphically (computationally it is done using a secant
method); see <code><a href="#topic+seas.norm">seas.norm</a></code> for more information on this
method; this can only be shown if the annums (rows) are complete, so
<code>start</code> must be 1, and <code>rep</code> must be 0 (otherwise the
row-wise sums would not be the annual sums)</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_main">main</code></td>
<td>
<p>main title for plot, otherwise it will automatically be
generated; <code>NA</code> suppresses a title, and automatically adjusts
the device margins</p>
</td></tr>
<tr><td><code id="image.seas.sum_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a graphical representation of a <code><a href="#topic+seas.sum">seas.sum</a></code> object,
and is far more informative than a traditional precipitation
&ldquo;normal&rdquo; (i.e., <code><a href="#topic+precip.norm">precip.norm</a></code> or
<code><a href="#topic+precip.norm">precip.norm</a></code>)
</p>
<p>If <code>norm = "days"</code> and <code>show.median = TRUE</code> (default), the
seasonal sums appear in right-hand frames. Horizontal and vertical
lines indicate a &lsquo;normal&rsquo; from the image, whereby the sum of
the quantile is equal to the median of the annual amount. This
numerical solution is found using <code><a href="#topic+seas.norm">seas.norm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+seas.sum">seas.sum</a></code>, <code><a href="#topic+seas.norm">seas.norm</a></code>
</p>
<p>See <code><a href="#topic+SeasOpts">SeasOpts</a></code> to modify other aspects of the plot</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)
dat &lt;- mksub(mscdata, id=1108447)

dat.ss &lt;- seas.sum(dat, width="mon")
image(dat.ss)

image(dat.ss, contour=FALSE)

image(dat.ss, norm="active", start=6, rep=5)

# different start day (not Jan 1st)
dat2.ss &lt;- seas.sum(dat, start.day=as.Date("2001-08-01"))
image(dat2.ss)
image(dat2.ss, power=2)
image(dat2.ss, palette=rainbow(64), main=NA)  # no title
image(dat2.ss, palette=colorRampPalette(c("white", "darkgreen"))(16))
image(dat2.ss, "snow")
image(dat2.ss, "snow", power=0.5)

# growing degree days for 10 degC
dat$gdd10 &lt;- dat$t_mean - 10
dat$gdd10[dat$gdd10 &lt; 0] &lt;- 0
attr(dat$gdd10,"long.name") &lt;- "growing degree days"
dat3.ss &lt;- seas.sum(dat, var="gdd10")
image(dat3.ss, "gdd10", palette=colorRampPalette(c("white", "red"))(64))
</code></pre>

<hr>
<h2 id='interarrival'>Calculate the interarrivals between and within precipitation events</h2><span id='topic+interarrival'></span>

<h3>Description</h3>

<p>Calculate the interarrivals (or spell periods), which are the number
of days between precipitation events (dry days), and the number of
days of continuous precipitation (wet days).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interarrival(x, var = "precip", p.cut = 0.3, inv = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interarrival_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> with <code><a href="base.html#topic+Date">Date</a></code> and <code>var</code>
columns of data; <code>x</code> can also have <code>id</code> or <code>name</code>
<a href="base.html#topic+attributes">attributes</a></p>
</td></tr>
<tr><td><code id="interarrival_+3A_var">var</code></td>
<td>
<p>a variable on to which the interarrivals are calculated;
default is <code>"precip"</code></p>
</td></tr>
<tr><td><code id="interarrival_+3A_p.cut">p.cut</code></td>
<td>
<p>days with precipitation values greater than <code>p.cut</code>
are considered to be <em>wet</em> days, and the complement are
<em>dry</em> days; a trace amount of 0.3 mm is suggested</p>
</td></tr>
<tr><td><code id="interarrival_+3A_inv">inv</code></td>
<td>
<p><code>logical</code>; invert convention of the starting date such
that the date is the first <em>wet</em> day if <code>inv=FALSE</code>
(default), or the date is the first <em>dry</em> day if
<code>inv=TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interarrival is the same as the <em>spell</em> period (i.e., dry
spell), however this function simultaneously counts the number of
<em>dry</em> and <em>wet</em> days relative to a single date. The date
represents the first day of precipitation (if <code>inv=TRUE</code>, this
convention is inverted to the first day of non-precipitation).
</p>
<p>Missing or <code>NA</code> precipitation values voids the number of counted
days between and within segments, which implies that days without
precipitation need to explicitly have zeros.
</p>


<h3>Value</h3>

<p><code>interarrival</code> object (which inherits the <code>data.frame</code>
class) with <code>date</code>, <code>wet</code>, <code>dry</code> columns.
</p>
<p>The table has <code>id</code> and <code>name</code> <a href="base.html#topic+attributes">attributes</a> (if
available from <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p>von Storch, H. and Zwiers, F.W., 1999. <em>Statistical analysis in
climate research</em>, Cambridge: Cambridge University Press, 484 p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.interarrival">plot.interarrival</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)

van.int &lt;- interarrival(mksub(mscdata, id=1108447))
summary(van.int)
van.int[which.max(van.int$dry),]
van.int[which.max(van.int$wet),]

plot(van.int, ylog=FALSE, maxy=30)
</code></pre>

<hr>
<h2 id='lars'>Read and write data from LARS-WG file formats</h2><span id='topic+lars'></span><span id='topic+write.lars'></span><span id='topic+read.lars'></span><span id='topic+lars2help'></span><span id='topic+Summerland.st'></span><span id='topic+Summerland.dat'></span><span id='topic+write.lars.scenario'></span>

<h3>Description</h3>

<p>Read and write data from the LARS-WG stochastic weather generator
file formats; also convert to a format for HELP
</p>


<h3>Usage</h3>

<pre><code class='language-R'># read synthetic or observed *.st file
read.lars(stfile, year.offset = 0)

# write observed climate data (*.st and/or *.sr)
write.lars(x, stfile, datfile, site, lat, lon, alt)

# experimental functions (may not work great; or at all!)
lars2help(infile, outfile, year.offset, site)
write.lars.scenario(file, x1, x2, name = "anomaly")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lars_+3A_stfile">stfile</code></td>
<td>
<p>file name with &lsquo;<span class="file">*.st</span>&rsquo; extension; this is a
&lsquo;site file&rsquo; for LARS-WG which contains meta-data for the
climate data, and has the location of the the climate data file; for
<code>write.lars</code>, if this variable is <code><a href="base.html#topic+NA">NA</a></code> or
<code><a href="base.html#topic+FALSE">FALSE</a></code>, this file will not be written (however,
<code>datfile</code> must be defined)</p>
</td></tr>
<tr><td><code id="lars_+3A_datfile">datfile</code></td>
<td>
<p>file name with either &lsquo;<span class="file">*.sr</span>&rsquo; or &lsquo;<span class="file">*.dat</span>&rsquo;
extension; contains climate data, as described by <code>stfile</code>;
this does not need to be set if <code>stfile</code> is defined, as this
datum is found in the &lsquo;<span class="file">st</span>&rsquo; file</p>
</td></tr>
<tr><td><code id="lars_+3A_file">file</code></td>
<td>
<p>file name with a &lsquo;<span class="file">*.sce</span>&rsquo; extension; this is a
&lsquo;scenario&rsquo; file with absolute and relative changes of climate
data</p>
</td></tr>
<tr><td><code id="lars_+3A_infile">infile</code></td>
<td>
<p>input file</p>
</td></tr>
<tr><td><code id="lars_+3A_outfile">outfile</code></td>
<td>
<p>output file</p>
</td></tr>
<tr><td><code id="lars_+3A_x">x</code></td>
<td>
<p><code>data.frame</code> of climate data</p>
</td></tr>
<tr><td><code id="lars_+3A_x1">x1</code></td>
<td>
<p>same as <code>x</code></p>
</td></tr>
<tr><td><code id="lars_+3A_x2">x2</code></td>
<td>
<p>same as <code>x</code></p>
</td></tr>
<tr><td><code id="lars_+3A_year.offset">year.offset</code></td>
<td>
<p>offset of years between what is contained in the
data files and what is needed in <span class="rlang"><b>R</b></span> to produce a reasonable
&lsquo;<code><a href="base.html#topic+Date">Date</a></code>&rsquo;; this is required, for example, if
synthetic data are produced that start from an arbitrary year
&lsquo;1&rsquo; but represent climate from the year &lsquo;2000&rsquo;</p>
</td></tr>
<tr><td><code id="lars_+3A_site">site</code></td>
<td>
<p>same as &lsquo;[SITE]&rsquo; in &lsquo;<span class="file">st</span>&rsquo; file; if missing,
this will try to read from <code>attr(x$name)</code>; this is the same as
a &lsquo;region&rsquo; for HELP</p>
</td></tr>
<tr><td><code id="lars_+3A_name">name</code></td>
<td>
<p>scenario name</p>
</td></tr>
<tr><td><code id="lars_+3A_lat">lat</code></td>
<td>
<p>same as &lsquo;LAT&rsquo; in &lsquo;<span class="file">st</span>&rsquo; file; if missing, this
will try to be read from <code>attr(x$latitude)</code></p>
</td></tr>
<tr><td><code id="lars_+3A_lon">lon</code></td>
<td>
<p>same as &lsquo;LON&rsquo; in &lsquo;<span class="file">st</span>&rsquo; file; if missing, this
will try to be read from <code>attr(x$longitude)</code></p>
</td></tr>
<tr><td><code id="lars_+3A_alt">alt</code></td>
<td>
<p>same as &lsquo;ALT&rsquo; in &lsquo;<span class="file">st</span>&rsquo; file; if missing, this
will try to be read from <code>attr(x$elevation)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions interface with the LARS-WG files (Version 4.0), which
is a stochastic weather generator by Mikhail Semenov.
</p>
<p>The climate data files used with LARS-WG have two parts: (1)~a
&lsquo;site file&rsquo; with a &lsquo;<span class="file">st</span>&rsquo; extension, containing the
meta-data; and (2)~a data file with a &lsquo;<span class="file">*.sr</span>&rsquo; or &lsquo;<span class="file">*.dat</span>&rsquo;
extension, containing all the data. The variable names are translated
according to the following table:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <em>seas</em>  </td><td style="text-align: left;"> <em>LARS-WG</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>year</code>  </td><td style="text-align: left;"> &lsquo;YEAR&rsquo; </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>yday</code>  </td><td style="text-align: left;"> &lsquo;JDAY&rsquo; </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>t_min</code> </td><td style="text-align: left;"> &lsquo;MIN&rsquo; </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>t_max</code> </td><td style="text-align: left;"> &lsquo;MAX&rsquo; </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>preicp</code></td><td style="text-align: left;"> &lsquo;RAIN&rsquo; </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>solar</code> </td><td style="text-align: left;"> &lsquo;RAD&rsquo; </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>sun</code>   </td><td style="text-align: left;"> &lsquo;SUN&rsquo; </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>pet</code>   </td><td style="text-align: left;"> &lsquo;PET&rsquo; </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>To write climate data from <span class="rlang"><b>R</b></span> to a LARS-WG file, the <code>data.frame</code>
names need to match those in the <span class="pkg">seas</span>-side of the table.
</p>
<p>Data exported from <code>write.lars</code> always has legal (according to
the Gregorian calendar) and increasing sequence of days (even if there
are gaps in <code>x$date</code>). Missing data values are written as
<code>-99</code>.
</p>
<p>Synthetically generated data from LARS-WG use a 365-day calendar, and
may need to be converted to a Gregorian calendar, which can be done
using <code><a href="#topic+conv365toGregorian">conv365toGregorian</a></code>.
</p>
<p><code>lars2help</code> and <code>write.lars.scenario</code> are experimental
functions to translate data between LARS and HELP (see
<code><a href="#topic+write.help">write.help</a></code> for more info).
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p>LARS-WG was can be downloaded for academic and research uses from <br />
<a href="http://resources.rothamsted.ac.uk/mas-models/larswg">http://resources.rothamsted.ac.uk/mas-models/larswg</a>
</p>
<p>Semenov, M.A. and Barrow, E.M. 1997. Use of a stochastic
weather generator in the development of climate change
scenarios. <em>Climate Change</em>, <b>35</b> (4), 397&ndash;414,
<a href="https://doi.org/10.1023/A%3A1005342632279">doi:10.1023/A:1005342632279</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+write.help">write.help</a></code>, <code><a href="#topic+read.sdsm">read.sdsm</a></code>,
<code><a href="#topic+summerland">summerland</a></code> example synthetic data,
<code><a href="#topic+conv365toGregorian">conv365toGregorian</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>stfile &lt;- system.file("extdata", "summerland.st", package="seas")
print(stfile)
summ &lt;- read.lars(stfile, year.offset=1960)
head(summ)
str(summ)

# plot temperature
summ$t_mean &lt;- rowMeans(summ[, c("t_min", "t_max")])
seas.temp.plot(summ)

# plot solar radiation
seas.var.plot(summ, "solar")

# plot precipitation
summ.ss &lt;- seas.sum(summ)
image(summ.ss)
plot(seas.norm(summ.ss))
</code></pre>

<hr>
<h2 id='mkann'>Make annum from a date</h2><span id='topic+mkann'></span>

<h3>Description</h3>

<p>Discretizes a date into an annum, using a starting day to specify the
start of a season, and ends in the next year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkann(x, start.day, calendar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkann_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code> with a <code>date</code> column
(of <code><a href="base.html#topic+Date">Date</a></code> or <code><a href="base.html#topic+POSIXct">POSIXct</a></code> class)
</p>
<p>It may also be a vector of <code>Date</code> or
<code>POSIXct</code> class</p>
</td></tr>
<tr><td><code id="mkann_+3A_start.day">start.day</code></td>
<td>
<p>This is the starting day of the annum, and can be
specified as either a <code>Date</code>, where year is ignored (e.g.,
<code>as.Date("2000-08-01")</code> for August 1st of any year); or it can
be a day of the year, from 1&ndash;365</p>
</td></tr>
<tr><td><code id="mkann_+3A_calendar">calendar</code></td>
<td>
<p>if unspecified, it will be attempted to be read from
<code>attr(x$date)</code>; otherwise it is assumed to be a normal
proleptic Gregorian calendar; see <code><a href="#topic+year.length">year.length</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This date function finds the annual-breaks between seasons, using a
<code>start.day</code>. Often, the <code>start.day</code> is 1, or January 1st,
in which case simply the year is returned, since the season starts on
January 1 and ends on December 31st. Otherwise, each annual break is
set using <code>start.day</code>, and the annum is identified by the range
of years, for example <code>1991_1992</code>, identifying a season starting on
<code>start.day</code> in 1991, and ending in the day before
<code>start.day</code> in 1992.
</p>
<p>The length of each year depends on the calendar; see
<code><a href="#topic+year.length">year.length</a></code> for details.
</p>
<p>A choice of <code>start.day</code> can influence annual totals using
<code><a href="#topic+seas.sum">seas.sum</a></code>, such as annual precipitation. For instance, if
a particular winter in the Northern hemisphere has snow before and
after the new year, these would be divided counting annual sums based
on the year, whereas if <code>start.day</code> were before the winter
season, the annual sum would be calculated throughout the winter
season.
</p>


<h3>Value</h3>

<p>Returns <code><a href="base.html#topic+factor">factor</a></code>s for each date given in <code>x</code>, grouped
by each annum.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Gregorian_calendar">https://en.wikipedia.org/wiki/Gregorian_calendar</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+mkseas">mkseas</a></code>, <code><a href="#topic+seas.sum">seas.sum</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)
dat &lt;- mksub(mscdata, id=1108447)
dat$ann1 &lt;- mkann(dat, start.day=1)
dat$ann2 &lt;- mkann(dat, start.day=as.Date("2000-02-01"))
dat$ann3 &lt;- mkann(dat, start.day=as.Date("2000-08-01"))
table(dat$ann1)
table(dat$ann2)
table(dat$ann3)
dat[26:36, c("date", paste("ann", 1:3, sep=""))]
</code></pre>

<hr>
<h2 id='mkseas'>Make a date into a seasonal factor</h2><span id='topic+mkseas'></span>

<h3>Description</h3>

<p>Discretizes a date within a year into a bin (or <code><a href="base.html#topic+factor">factor</a></code>)
for analysis, such as 11-day groups or by month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkseas(x, width = 11, start.day = 1, calendar, year)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkseas_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code> with a <code>date</code> column
(of <code><a href="base.html#topic+Date">Date</a></code> or <code><a href="base.html#topic+POSIXct">POSIXct</a></code> class)
</p>
<p>It can also be an integer specifying the Julian day (specify
<code>year</code> to determine the leap year)
</p>
<p>If it is omitted, the full number of days will be calculated for the
year, determined by either <code>year</code> or <code>calendar</code></p>
</td></tr>
<tr><td><code id="mkseas_+3A_width">width</code></td>
<td>
<p>either <code>numeric</code> or other <code>character</code> value; if
it is numeric, it specifies the number of days in each bin (default
is 11 days); if character it specifies a common calendar usage, such as
<code>"mon"</code> for months; see details below</p>
</td></tr>
<tr><td><code id="mkseas_+3A_start.day">start.day</code></td>
<td>
<p>this is the start of the season, specified as either a
as a <code>Date</code> to specify a month and day (year is ignored; day of
month is ignored if <code>width</code> relates to a month), or as a
<code><a href="base.html#topic+numeric">numeric</a></code> day of year, between 1 and the number of days
for the calendarter a leap day</p>
</td></tr>
<tr><td><code id="mkseas_+3A_calendar">calendar</code></td>
<td>
<p>used to determine the number of days per year and per
bin; if not specified, a proleptic Gregorian calendar is assumed;
see <code><a href="#topic+year.length">year.length</a></code></p>
</td></tr>
<tr><td><code id="mkseas_+3A_year">year</code></td>
<td>
<p>required if <code>x</code> is omitted, or if <code>x</code> is a
Julian day integer and <code>width</code> is non-numeric; used to
calculate leap year</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This useful date function groups <em>days</em> of a year into discrete
bins (or into a <code><a href="base.html#topic+factor">factor</a></code>).  Statistical and plotting
functions can be applied to a variable contained within each bin. An
example of this would be to find the monthly temperature averages,
where <em>month</em> is the bin.
</p>
<p>If <code>width</code> is <code><a href="base.html#topic+integer">integer</a></code>, the width of each bin
(except for the last) will be exactly <code>width</code> days. Since the
number of days in a year are not consistent, nor are always perfectly
divisible by <code>width</code>, the numbers of days in the last bin will
vary. <code>mkseas</code> determines that last bin must have at least 20% of
the number of observations for a leap year, otherwise it is merged
into the second to last bin (which will have extra numbers of
days). If <code>width</code> is <code><a href="base.html#topic+numeric">numeric</a></code> (i.e. <code>366/12</code>),
the width of each bin varies slightly. Using <code>width = 366/12</code> is
slightly different than <code>width = "mon"</code>. Leap years only affect
the <em>last</em> bin.
</p>
<p>Other common classifications based on the Gregorian calendar can be
used if <code>width</code> is given a <code><a href="base.html#topic+character">character</a></code> array. All of
these systems are arbitrary: having different numbers of days in each
bin, and leap years affecting the number of days in February. The most
common, of course, is by <em>month</em> (<code>"mon"</code>). Meteorological
quarterly seasons (<code>"DJF"</code>) are based on grouping three months,
starting with December.  This style of grouping is commonly used in
climate literature, and is preferred over the season names
&lsquo;winter&rsquo;, &lsquo;spring&rsquo;, &lsquo;summer&rsquo;, and
&lsquo;autumn&rsquo;, which apply to only one hemisphere.  The less common
annual quarterly divisions (<code>"JFM"</code>) are similar, except that
grouping begins with January. Zodiac divisions (<code>"zod"</code>) are
included for demonstrative purposes, and are based on the Tropical
birth dates (common in Western-culture horoscopes) starting with Aries
(March 21).
</p>
<p>Here are the complete list of options for the <code>width</code> argument:
</p>

<ul>
<li> <p><code>numeric</code>: the width of each bin (or group) in days
</p>
</li>
<li> <p><code>366/n</code>: divide the year into <code>n</code> sections
</p>
</li>
<li> <p><code>"mon"</code>: month intervals (abbreviated month names)
</p>
</li>
<li> <p><code>"month"</code>: month intervals (full month names)
</p>
</li>
<li> <p><code>"DJF"</code>: meteorological quarterly divisions: DJF, MAM, JJA, SON
</p>
</li>
<li> <p><code>"JFM"</code>: annual quarterly divisions: JFM, AMJ, JAS, OND
</p>
</li>
<li> <p><code>"JF"</code>: annual six divisions: JF, MA, AJ, JA, SO, ND
</p>
</li>
<li> <p><code>"zod"</code>: zodiac intervals (abbreviated symbol names)
</p>
</li>
<li> <p><code>"zodiac"</code>: zodiac intervals (full zodiac names)

</p>
</li></ul>

<p>If a non-Gregorian calendar is used (see <code><a href="#topic+year.length">year.length</a></code>),
the number of days in a year can be set using <code>calendar</code>
attribute in the <code>date</code> column (using <code><a href="base.html#topic+attr">attr</a></code>).
For example, <code>attr(x$date,"calendar") &lt;- "365_day"</code> will set the
dates using a 365-day per year calendar, where February is always
28-days in length. If this attribute is not set, it is assumed a
normal Gregorian calendar is used. Calendars with 360-days per year
(or 30-days per month) are incorrectly handled, since February cannot
have 30 days, however this can be forced by including a duplicate
February date in <code>x</code> for each year.
</p>


<h3>Value</h3>

<p>Returns an array of <code><a href="base.html#topic+factor">factor</a></code>s for each date given in <code>x</code>.
The factor also has four attributes: <code>width</code>, <code>start.day</code>,
<code>calendar</code> (assumed to be 366, unless from attribute set in
<code><a href="base.html#topic+Date">Date</a></code>), and an array <code>days</code> showing the maximum
number of days in each bin.
</p>
<p>See examples for its application.
</p>


<h3>Locale warning</h3>

<p>Month names generated using <code>"mon"</code> or <code>"months"</code> are locale
specific, and depend on your operating system and system language
settings. Normally, abbreviated month names should have exactly three
characters or less, with no trailing decimals. However,
Microsoft-based operating systems have an inconsistent set of
abbreviated month names between locales. For example, abbreviated
month names in English locales have three letters with no period at
the end, while French locales have 3&ndash;4 letters with a decimal at the
end. If your OS is POSIX, you should have consistent month names in
any locale. This can be fixed by setting
<code>options("seas.month.len") &lt;- 3</code>, which forces the length of the
months to be three-characters in length.
</p>
<p>To avoid any issues supporting locales, or to use English month names,
simply revert to a C locale: <code><a href="base.html#topic+Sys.setlocale">Sys.setlocale</a>(loc="C")</code>.
</p>


<h3>Note</h3>

<p>The phase of the Gregorian solar year (begins Julian day 1, or January
1st) is not in sync with the phase of <code>"DJF"</code> (begins Julian day
335/336) or <code>"zod"</code> (begins Julian day 80/81). If either of these
systems are to be used, ensure that there are <em>several</em> years of
data, or that the phase of the data is the same as the beginning
Julian day.
</p>
<p>For instance, if one years worth of data beginning on Julian day 1 is
factored into <code>"DJF"</code> bins, the first bin will mix data from the
first three months, and from the last month. The last three bins will
have a continuous set of data. If the values are not perfectly
periodic, the first bin will have higher variance, due to the mixing
of data separated by nearly a year.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Solar_calendar">https://en.wikipedia.org/wiki/Solar_calendar</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+mkann">mkann</a></code>, <code><a href="#topic+seas.sum">seas.sum</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Demonstrate the number of days in each category
ylab &lt;- "Number of days"

barplot(table(mkseas(width="mon", year=2005)),
        main="Number of days in each month",
        ylab=ylab)

barplot(table(mkseas(width="zod", year=2005)),
        main="Number of days in each zodiac sign",
        ylab=ylab)

barplot(table(mkseas(width="DJF", year=2005)),
        main="Number of days in each meteorological season",
        ylab=ylab)

barplot(table(mkseas(width=5, year=2004)),
        main="5-day categories", ylab=ylab)

barplot(table(mkseas(width=11, year=2005)),
        main="11-day categories", ylab=ylab)

barplot(table(mkseas(width=366 / 12, year=2005)),
        main="Number of days in 12-section year",
        sub="Note: not exactly the same as months")

# Application using synthetic data
dat &lt;- data.frame(date=as.Date(paste(2005, 1:365), "%Y %j"),
  value=(-cos(1:365 * 2 * pi / 365) * 10 + rnorm(365) * 3 + 10))
attr(dat$date, "calendar") &lt;- "365_day"

dat$d5 &lt;- mkseas(dat, 5)
dat$d11 &lt;- mkseas(dat, 11)
dat$month &lt;- mkseas(dat, "mon")
dat$DJF &lt;- mkseas(dat, "DJF")

plot(value ~ date, dat)
plot(value ~ d5, dat)
plot(value ~ d11, dat)
plot(value ~ month, dat)
plot(value ~ DJF, dat)

head(dat)

tapply(dat$value, dat$month, mean, na.rm=TRUE)
tapply(dat$value, dat$DJF, mean, na.rm=TRUE)

dat[which.max(dat$value),]
dat[which.min(dat$value),]

# start on a different day
st.day &lt;- as.Date("2000-06-01")

dat$month &lt;- mkseas(dat, "mon", start.day=st.day)
dat$d11 &lt;- mkseas(dat, 11, start.day=st.day)
dat$DJF &lt;- mkseas(dat, "DJF", start.day=st.day)

plot(value ~ d11, dat,
     main=.seasxlab(11, start.day=st.day))
plot(value ~ month, dat,
     main=.seasxlab("mon", start.day=st.day))
plot(value ~ DJF, dat,
     main=.seasxlab("DJF", start.day=st.day))
</code></pre>

<hr>
<h2 id='mksub'>Make a subset of seasonal data</h2><span id='topic+mksub'></span>

<h3>Description</h3>

<p>Creates a subset of a <code>data.frame</code> with temporal observations,
using IDs and start and ending dates or years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mksub(x, start, end, id)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mksub_+3A_x">x</code></td>
<td>
<p>a data frame with temporal observations</p>
</td></tr>
<tr><td><code id="mksub_+3A_start">start</code></td>
<td>
<p>either a starting <code><a href="base.html#topic+Date">Date</a></code> or
<code><a href="base.html#topic+integer">integer</a></code> year; if omitted minimum will be used</p>
</td></tr>
<tr><td><code id="mksub_+3A_end">end</code></td>
<td>
<p>either an ending <code>Date</code> or year; if omitted will use
same year as <code>start</code>, and if <code>start</code> is omitted, will use
maximum year</p>
</td></tr>
<tr><td><code id="mksub_+3A_id">id</code></td>
<td>
<p>unique station identifier (if present), which is assumed to
be a column of <code>x</code> as <code>x$id</code>; it is used to extract a
subset of data from a single ID</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This utility function is useful for creating temporal subsets of
seasonal data and for extracting a single station out of a
<code>data.frame</code> with multiple stations or sets. The <code>x</code>
object can have many columns, representing measured variables for each
day, which will be returned with their original <a href="base.html#topic+attributes">attributes</a>.
</p>
<p>If <code>id</code> is used, that station will be extracted from
<code>x</code>. If <code>id</code> is not provided, but there are more than one
unique IDs in <code>x$id</code>, the first unique ID will be extracted, with
a <a href="base.html#topic+warning">warning</a>.
</p>


<h3>Value</h3>

<p>Returns a subset of a <code><a href="base.html#topic+data.frame">data.frame</a></code> with the same columns
and attributes as <code>x</code>, except <code>id</code>, which will be retained
as an attribute (e.g., <code>attr(x,"id")</code>).
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.msc">read.msc</a></code>, <code><a href="#topic+mscdata">mscdata</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)

# All available data from one station
summary(mksub(mscdata, id=1108447))

# One year
str(mksub(mscdata, id=1108447, start=1980))

# A range of years
str(mksub(mscdata, id=1108447, start=1980, end=1989))

# A range of dates
summary(mksub(mscdata, id=1108447,
              start=as.Date("1975-08-01"),
              end=as.Date("2000-07-31")))
</code></pre>

<hr>
<h2 id='mscdata'>Meteorological Service of Canada sample climate data</h2><span id='topic+mscdata'></span>

<h3>Description</h3>

<p>Sample climate data from the Meteorological Service of Canada
(<abbr><span class="acronym">MSC</span></abbr>) climate stations in western Canada.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mscdata)</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 26358 daily observations on the
following 10 variables (metric units of &lsquo;C&rsquo;
and &lsquo;mm&rsquo; <em>per day</em>):
</p>

<dl>
<dt><code>id</code>:</dt><dd><p><code><a href="base.html#topic+factor">factor</a></code> used to distinguish multiple
stations within a single data frame</p>
</dd>
<dt><code>year</code>:</dt><dd><p><code><a href="base.html#topic+integer">integer</a></code> year</p>
</dd>
<dt><code>yday</code>:</dt><dd><p><code><a href="base.html#topic+integer">integer</a></code> day of year; 1&ndash;365 or
1&ndash;366</p>
</dd>
<dt><code>date</code>:</dt><dd><p><code><a href="base.html#topic+Date">Date</a></code> class</p>
</dd>
<dt><code>t_max</code>:</dt><dd><p>daily maximum temperature</p>
</dd>
<dt><code>t_min</code>:</dt><dd><p>daily minimum temperature</p>
</dd>
<dt><code>t_mean</code>:</dt><dd><p>daily mean temperature</p>
</dd>
<dt><code>precip</code>:</dt><dd><p>total daily precipitation</p>
</dd>
<dt><code>rain</code>:</dt><dd><p>total daily liquid-phase precipitation</p>
</dd>
<dt><code>snow</code>:</dt><dd><p>total daily solid-phase precipitation</p>
</dd>
</dl>

<p>The climate variables have attributes (<code><a href="base.html#topic+attr">attr</a></code> of
<code>units</code> and <code>long.name</code> to identify their units and long
names for plotting labels.
</p>
<p>There are three climate stations in this data frame from:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <b>ID</b> </td><td style="text-align: left;"> <b>Station Location</b> </td><td style="text-align: left;"> <b>Province</b></td>
</tr>
<tr>
 <td style="text-align: left;">
    1096450   </td><td style="text-align: left;"> Prince George           </td><td style="text-align: left;"> <abbr><span class="acronym">BC</span></abbr></td>
</tr>
<tr>
 <td style="text-align: left;">
    1108447   </td><td style="text-align: left;"> Vancouver               </td><td style="text-align: left;"> <abbr><span class="acronym">BC</span></abbr></td>
</tr>
<tr>
 <td style="text-align: left;">
    2100630   </td><td style="text-align: left;"> Haines Junction         </td><td style="text-align: left;"> <abbr><span class="acronym">YT</span></abbr>
  </td>
</tr>

</table>

<p>All data spans from 1975 to 2004 for each station. Missing values are
present.
</p>


<h3>Details</h3>

<p>The field <code>id</code> is optional, but very handy when handling multiple
stations. Also, the day of year (<code>yday</code>) and <code>year</code> are
optional, since these are stored in the <code>date</code>, using <br />
<code>dat$date &lt;- as.Date(paste(dat$year,dat$yday),"%Y %j")</code>.
</p>
<p>The <code>units</code> and <code>long.name</code> attributes stored in the climate
variables are optional, but help annotate the graphics.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>Source</h3>

<p>Data provided by the Meteorological Service of Canada, with
permission. This data may only be reproduced for personal use; any
other reproduction is permitted only with the written consent of
Environment Canada.<br />
</p>
<p><a href="https://weather.gc.ca/">https://weather.gc.ca/</a>
<br /><a href="https://weather.gc.ca/mainmenu/contact_us_e.html">https://weather.gc.ca/mainmenu/contact_us_e.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mscstn">mscstn</a></code> has MSC station ID codes, locations and names;
<code><a href="#topic+mksub">mksub</a></code> produces subsets of data;  <code><a href="#topic+read.msc">read.msc</a></code>
reads MSC archive files, such as <code><a href="#topic+A1128551.DLY">A1128551.DLY</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscstn)
data(mscdata)
par.orig &lt;- par(no.readonly=TRUE)

# structure in R
str(mscdata)

# first few rows
head(mscdata)

# here are all the station IDs
stnids &lt;- levels(mscdata$id)

# show all data
rng.p &lt;- range(mscdata$precip, na.rm=TRUE)
rng.t &lt;- range(mscdata$t_mean, na.rm=TRUE)
par(mfcol=c(2, 3), mgp=c(2, 1, 0), mar=c(3, 3, 3, 1), bty="l")
for (n in levels(mscdata$id)) {
  dat &lt;- mscdata[mscdata$id == n,]
  plot(t_mean ~ date, dat, "l", col="red", ylim=rng.t)
  abline(h=0)
  plot(precip ~ date, dat, "l", col="blue", ylim=rng.p, main=n)
}
par(par.orig)

# show stations and station names available in this data frame
data.frame(stnids, name=getstnname(stnids))
dat &lt;- mksub(mscdata, id=1108447)
dat$month &lt;- mkseas(dat, "mon")
plot(t_mean ~ date, dat, "l")
plot(t_mean ~ date, dat, subset=(month == "Dec"))
seas.temp.plot(dat)
year.plot(dat)

# plot high-resolution statistics
dly.tmp &lt;- tapply(dat$t_mean, dat$yday,
  quantile, c(5, 25, 50, 75, 95) / 100, na.rm=TRUE)
dly &lt;- data.frame(yday=1:366,
  t(matrix(unlist(dly.tmp), nrow=5)))
names(dly) &lt;- c("yday", "d5", "d25", "median", "d75", "d95")
plot(median ~ yday, dly, "n", ylim=c(-5, 25),
  ylab="mean temperature", xlab="day of year")
polygon(c(1:366, 366:1), c(dly$d5, rev(dly$d95)),
        border=FALSE, col="grey80")
polygon(c(1:366, 366:1), c(dly$d25, rev(dly$d75)),
        border=FALSE, col="grey50")
lines(median ~ yday, dly)
abline(h=0)
</code></pre>

<hr>
<h2 id='mscstn'>Meteorological Service of Canada station information</h2><span id='topic+mscstn'></span>

<h3>Description</h3>

<p>Meteorological Service of Canada weather station data,
including national ID, station ID, Province, latitude and longitude.
</p>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 4493 climate stations with the
following 6 columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
    <code>name</code> </td><td style="text-align: left;"> Full station name </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>nid</code>  </td><td style="text-align: left;"> National ID, alphanumeric key </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>sid</code>  </td><td style="text-align: left;"> Station ID, also used for airport codes </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>prov</code> </td><td style="text-align: left;"> Canadian Province </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>lat</code>  </td><td style="text-align: left;"> Decimal degrees latitude; NAD83 </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>long</code> </td><td style="text-align: left;"> Decimal degrees longitude; NAD83
  </td>
</tr>

</table>



<h3>Details</h3>

<p>This data object is used as a look-up table to convert a unique
station identifier (<code>nid</code>) or ID into a station name, using
<code><a href="#topic+getstnname">getstnname</a></code>.
</p>
<p>Currently, this data only includes weather stations from Alberta,
British Columbia and the Yukon.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>Source</h3>

<p>Provided by the Meteorological Service of Canada, with permission.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getstnname">getstnname</a></code>, <code><a href="#topic+mscdata">mscdata</a></code>,
<code><a href="#topic+read.msc">read.msc</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>str(seas::mscstn)

table(mscstn$prov)
plot(lat ~ long, seas::mscstn, pch=".")
</code></pre>

<hr>
<h2 id='plot.interarrival'>Plot interarrivals for precipitation</h2><span id='topic+plot.interarrival'></span>

<h3>Description</h3>

<p>Plots interarrivals for precipitation using boxplots, giving the
typical number of continuous wet days and dry days (or spells)
throughout the season. The mean value is also drawn as a single line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'interarrival'
plot(x, width = 11, start = 1, rep = 0, start.day = 1,
           ylog = FALSE, maxy, main, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.interarrival_+3A_x">x</code></td>
<td>
<p>an <code><a href="#topic+interarrival">interarrival</a></code> object with numbers of
dry/wet days</p>
</td></tr>
<tr><td><code id="plot.interarrival_+3A_width">width</code></td>
<td>
<p>size of bin; see <code><a href="#topic+mkseas">mkseas</a></code></p>
</td></tr>
<tr><td><code id="plot.interarrival_+3A_start">start</code></td>
<td>
<p>starting bin number; e.g., if <code>width="mon"</code> and
<code>start=5</code>, the plot will start on &quot;May&quot; at the left-hand side</p>
</td></tr>
<tr><td><code id="plot.interarrival_+3A_rep">rep</code></td>
<td>
<p>repetition of the bins in the boxplot</p>
</td></tr>
<tr><td><code id="plot.interarrival_+3A_start.day">start.day</code></td>
<td>
<p>when <code>width</code> is numeric, this is the starting
day of the year for the fist bin, or it can be a <code>Date</code> to
specify a month and day (year is ignored)</p>
</td></tr>
<tr><td><code id="plot.interarrival_+3A_ylog">ylog</code></td>
<td>
<p><code>logical</code>; y-axis is logarithmic</p>
</td></tr>
<tr><td><code id="plot.interarrival_+3A_maxy">maxy</code></td>
<td>
<p>maximum number of days for the y-axis; it can either be
passed as <code>c(wet, dry)</code>, or as a single value for both</p>
</td></tr>
<tr><td><code id="plot.interarrival_+3A_main">main</code></td>
<td>
<p>main title for plot, otherwise other title will be
automatically generated</p>
</td></tr>
<tr><td><code id="plot.interarrival_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+interarrival">interarrival</a></code>, <code><a href="#topic+seas.var.plot">seas.var.plot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)

dat.int &lt;- interarrival(mksub(mscdata, id=1108447))
plot(dat.int, width="mon")

plot(dat.int, ylog=FALSE, maxy=35, rep=10)
</code></pre>

<hr>
<h2 id='plot.seas.norm'>Plot seasonal normal of a variable, including precipitation normals</h2><span id='topic+plot.seas.norm'></span><span id='topic+plot.precip.norm'></span>

<h3>Description</h3>

<p>Plots a &ldquo;normal&rdquo; of a seasonal variable, including a
precipitation normal (which shows rain and snow fractions, where
available). Significant missing data values are also indicated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'seas.norm'
plot(x, start = 1, rep = 0, ylim,
     varwidth = FALSE, normwidth = FALSE,
     leg, add.alt = FALSE, main, ylab, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.seas.norm_+3A_x">x</code></td>
<td>
<p>a <code>seas.norm</code> object created by either
<code><a href="#topic+seas.norm">seas.norm</a></code> or <code><a href="#topic+precip.norm">precip.norm</a></code></p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_start">start</code></td>
<td>
<p>starting bin</p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_rep">rep</code></td>
<td>
<p>repeat bins</p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_ylim">ylim</code></td>
<td>
<p>range of  y-axis; either as a single value,
<code>c(0, max)</code>, or as two values <code>c(min, max)</code></p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_varwidth">varwidth</code></td>
<td>
<p><code>logical</code>; varies the width of each bar directly
proportional to the frequency of active days (defined by a
threshold); the value is normalized according to the next argument</p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_normwidth">normwidth</code></td>
<td>
<p>normalizes the width of the bars to a fixed
<code>numeric</code> value (in days), or the maximum value if given
<code>TRUE</code>; the default <code>FALSE</code> value normalizes each bar to
the number of potentially active days</p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_leg">leg</code></td>
<td>
<p>if <code>TRUE</code> shows a legend summary of the statistics in
the upper left hand corner; it can also be a <code>c(x, y)</code> pair or
&ldquo;<code><a href="graphics.html#topic+locator">locator</a></code>&rdquo; to manually place the legend on the
active graphics device</p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_add.alt">add.alt</code></td>
<td>
<p><code>logical</code>; adds imperial units on the right-hand
y-axis</p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_main">main</code></td>
<td>
<p>title for plot; if it is missing, then it will
automatically be generated</p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label; if it is missing, then it will automatically
be generated</p>
</td></tr>
<tr><td><code id="plot.seas.norm_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>varwidth</code> variable is useful for separating different
precipitation patterns throughout the season.  It changes the width of
the bar proportional to the frequency of precipitation events within
the bin. Ideally, the bars will be tall and narrow with intense storms
that occur infrequently, such as convective storms. Conversely the
bars will be broader with less-intense rainfall events occurring more
frequently.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+seas.norm">seas.norm</a></code>, <code><a href="#topic+precip.norm">precip.norm</a></code>,
<code><a href="#topic+seas.sum">seas.sum</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)
dat &lt;- mksub(mscdata, id=1108447)
d.ss &lt;- seas.sum(dat)
plot(seas.norm(d.ss))
plot(precip.norm(d.ss, fun=median))
plot(precip.norm(d.ss, fun=mean))
plot(precip.norm(d.ss, fun=mean, norm="active"))
plot(precip.norm(d.ss, fun=median, norm="active"))
plot(precip.norm(d.ss), start=15, rep=12)
mar &lt;- par("mar")
plot(precip.norm(d.ss), add.alt=TRUE)

par(mar=mar)
d2.ss &lt;- seas.sum(dat, start.day=as.Date("2000-08-01"))
plot(precip.norm(d2.ss, fun="mean"))
</code></pre>

<hr>
<h2 id='plot.seas.sum'>Plot boxplots of normalized seasonal sums</h2><span id='topic+plot.seas.sum'></span><span id='topic+plot.precip.sum'></span>

<h3>Description</h3>

<p>Plots normalized seasonal sums using boxplots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'seas.sum'
plot(x, var, norm = "days", year.filter, ylim,
    start = 1, rep = 0, col = "lightgrey", main, ylab, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.seas.sum_+3A_x">x</code></td>
<td>
<p>a <code>seas.sum</code> object created by <code><a href="#topic+seas.sum">seas.sum</a></code></p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_var">var</code></td>
<td>
<p>name of seasonal variable in <code>x</code></p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_norm">norm</code></td>
<td>
<p>a variable to normalize by, either <code>"days"</code> (to
produce <em>unit/day</em>) or <code>"active"</code> (<em>unit/day</em>, when
active); it may also be a <code>matrix</code> with the same dimensions as
<code>x$days</code></p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_year.filter">year.filter</code></td>
<td>
<p>use only these years for analysis</p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_ylim">ylim</code></td>
<td>
<p>either a single value for <code>c(0, ylim)</code>, or a range of
<code>c(min, max)</code> for the y-axis limits</p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_start">start</code></td>
<td>
<p>starting bin at left-hand side of plot</p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_rep">rep</code></td>
<td>
<p>repeat bins on right-hand side of plot</p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_col">col</code></td>
<td>
<p>colour for boxplot, default is <code>"lightgrey"</code></p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_main">main</code></td>
<td>
<p>title for plot; if it is missing, then it will
automatically be generated</p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label; if it is missing, then it will automatically
be generated</p>
</td></tr>
<tr><td><code id="plot.seas.sum_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a boxplot interpretation of a <code>seas.sum</code>
object. This is not the same as treating <code>var</code> as a continuous
variable and using <code>seas.var.plot</code>, since a <code>seas.sum</code>
object has been smoothed. Daily extreme values are not well
represented here as a result.
</p>


<h3>Warning</h3>

<p>The appearance of the boxplots are sensitive to the <code>width</code>
parameter specified in the <code>seas.sum</code> function on strongly
discontinuous variables. Small bin widths capture the discontinuities
better than wider bins, and changes the skew of the distribution.
</p>
<p>For instance, the median will appear to decrease as <code>width</code> decreases.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+seas.sum">seas.sum</a></code>, <code><a href="#topic+image.seas.sum">image.seas.sum</a></code>, <code><a href="#topic+seas.norm">seas.norm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)
par.orig &lt;- par(no.readonly=TRUE)
on.exit(par.orig)

dat &lt;- mksub(mscdata, id=1108447)
dat.ss &lt;- seas.sum(dat)

# Normalized by the number of days in each bin
plot(dat.ss)

# Normalized by the number of active days in each bin
plot(dat.ss, norm="active")

# Snow, using a different start day, and a better y-axis:
dat2.ss &lt;- seas.sum(dat, var="snow", width="mon",
                    start.day=as.Date("2000-08-01"))
par(yaxs="i")
plot(dat2.ss, var="snow")
plot(dat2.ss, var="snow", norm="active")
</code></pre>

<hr>
<h2 id='precip.dep'>Cumulative precipitation departure</h2><span id='topic+precip.dep'></span>

<h3>Description</h3>

<p>Calculate the cumulative precipitation departure (<abbr><span class="acronym">CPD</span></abbr>) for a
station with a given precipitation normal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>precip.dep(x, norm, var = "precip")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="precip.dep_+3A_x">x</code></td>
<td>
<p>a seasonal <code>data.frame</code> of climate data</p>
</td></tr>
<tr><td><code id="precip.dep_+3A_norm">norm</code></td>
<td>
<p>a <code>precip.norm</code> object containing the precipitation
normal for the same station as <code>x</code></p>
</td></tr>
<tr><td><code id="precip.dep_+3A_var">var</code></td>
<td>
<p>a common seasonal variable found in <code>x</code> and <code>norm</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is useful for looking at the behaviour of a precipitation
time-series in relation to its precipitation normal over an extended
period of time. This is especially useful for identifying changes in
precipitation, and is useful for relating to groundwater recharge
patterns.
</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> similar to <code>x</code>, but contains the
departures in the <code>dep</code> column.
</p>


<h3>Note</h3>

<p>The selection of <code>fun</code> in <code><a href="#topic+precip.norm">precip.norm</a></code>, such as
using <code><a href="base.html#topic+mean">mean</a></code> or <code><a href="stats.html#topic+median">median</a></code>, will affect
the result of this function; <code>width</code> has only a minor effect.
</p>
<p>Periods with missing (<code>NA</code>) values in <code>var</code> of <code>x</code> will
have a flat departure, neither increasing nor decreasing.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+precip.norm">precip.norm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscstn)
data(mscdata)

dat &lt;- mksub(mscdata, id=1108447)
dat.ss &lt;- seas.sum(dat)
dat.dep &lt;- precip.dep(dat,precip.norm(dat.ss, fun="mean"))
plot(dep ~ date, dat.dep, type="l", main="CPD from mean normals")

dat.dep &lt;- precip.dep(dat, precip.norm(dat.ss, fun="median"))
plot(dep ~ date, dat.dep, type="l", main="CPD from median normals")
</code></pre>

<hr>
<h2 id='read.msc'>Read a MSC archive file into a data.frame</h2><span id='topic+read.msc'></span>

<h3>Description</h3>

<p>Reads a Meteorological Service of Canada (<abbr><span class="acronym">MSC</span></abbr>) digital
archive files (HLY and DLY formats) into a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.msc(file, flags = FALSE, add.elem, format, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.msc_+3A_file">file</code></td>
<td>
<p>file name (with path, if not in <code><a href="base.html#topic+getwd">getwd</a></code>); it
can also be a <code><a href="base.html#topic+connection">connection</a></code>, such as
<code><a href="base.html#topic+bzfile">bzfile</a></code></p>
</td></tr>
<tr><td><code id="read.msc_+3A_flags">flags</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code> return the flags with the
<code><a href="base.html#topic+data.frame">data.frame</a></code></p>
</td></tr>
<tr><td><code id="read.msc_+3A_add.elem">add.elem</code></td>
<td>
<p>either a <code><a href="base.html#topic+data.frame">data.frame</a></code> or a
<code><a href="base.html#topic+list">list</a></code> with additional elements not found in this
function</p>
</td></tr>
<tr><td><code id="read.msc_+3A_format">format</code></td>
<td>
<p>parameter ignored and will be removed in a future release</p>
</td></tr>
<tr><td><code id="read.msc_+3A_verbose">verbose</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code> verbose output, such as number of
stations, elements, records and years in the archive file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function currently reads in HLY (hourly) and DLY (daily) archive
formats. This is automatically detected. The other formats, FIF
(fifteen-minute) and MLY (monthly), are not currently supported.
</p>
<p>The input file can include multiple stations and multiple elements
(measured variables). The multiple stations are deciphered through
the <code>id</code> column, and the multiple variables appear as columns to
the output data frame.
</p>
<p>This function currently only reads a limited number of elements,
however additional elements can be used by editing two lines in the R
source for this function.
</p>


<h3>Value</h3>

<p>Returns a <code><a href="base.html#topic+data.frame">data.frame</a></code> object with the following minimum
fields:
</p>

<dl>
<dt><code>id</code>:</dt><dd><p><code><a href="base.html#topic+factor">factor</a></code> used to distinguish multiple
stations within a single data frame</p>
</dd>
<dt><code>year</code>:</dt><dd><p><code><a href="base.html#topic+integer">integer</a></code> year</p>
</dd>
<dt><code>yday</code>:</dt><dd><p><code>integer</code> day of year; 1&ndash;365 or 1&ndash;366</p>
</dd>
<dt><code>date</code>:</dt><dd><p><code><a href="base.html#topic+Date">Date</a></code>, useful for plotting a continuous
time-series</p>
</dd>
<dt><code>datetime</code>:</dt><dd><p><code><a href="base.html#topic+POSIXct">POSIXct</a></code>, includes date and time
info, only included if <code>file</code> is in HLY archive format</p>
</dd>
<dt><code>element</code>:</dt><dd><p><code><a href="base.html#topic+numeric">numeric</a></code>, with
<code><a href="base.html#topic+attributes">attributes</a></code> set for <code>units</code> and
<code>long.name</code>; these can be changed using <code><a href="base.html#topic+attr">attr</a></code> on
<code>dat$varname</code></p>
</dd>
<dt><code>flag</code>:</dt><dd><p><code>factor</code>; included if <code>flags=TRUE</code></p>
</dd>
</dl>

<p>The are as many <code>element</code> columns for each element found in the
archive file, such as:
</p>

<table>
<tr>
 <td style="text-align: right;">
    <b>alias</b> </td><td style="text-align: left;"> <b>name</b> </td><td style="text-align: left;"> <b>long.name</b> </td><td style="text-align: left;"> <b>units</b></td>
</tr>
<tr>
 <td style="text-align: right;">
    1   </td><td style="text-align: left;"> <code>t_max</code>  </td><td style="text-align: left;"> daily maximum temperature </td><td style="text-align: left;">
          C </td>
</tr>
<tr>
 <td style="text-align: right;">
    2   </td><td style="text-align: left;"> <code>t_min</code>  </td><td style="text-align: left;"> daily minimum temperature </td><td style="text-align: left;">
          C </td>
</tr>
<tr>
 <td style="text-align: right;">
    3   </td><td style="text-align: left;"> <code>t_mean</code> </td><td style="text-align: left;"> daily mean temperature </td><td style="text-align: left;">
          C </td>
</tr>
<tr>
 <td style="text-align: right;">
    10  </td><td style="text-align: left;"> <code>rain</code>   </td><td style="text-align: left;"> total rainfall </td><td style="text-align: left;"> mm </td>
</tr>
<tr>
 <td style="text-align: right;">
    11  </td><td style="text-align: left;"> <code>snow</code>   </td><td style="text-align: left;"> total snowfall </td><td style="text-align: left;"> mm </td>
</tr>
<tr>
 <td style="text-align: right;">
    12  </td><td style="text-align: left;"> <code>precip</code> </td><td style="text-align: left;"> total precipitation </td><td style="text-align: left;"> mm </td>
</tr>
<tr>
 <td style="text-align: right;">
    13  </td><td style="text-align: left;"> <code>snow_d</code> </td><td style="text-align: left;"> snow on the ground </td><td style="text-align: left;"> cm </td>
</tr>
<tr>
 <td style="text-align: right;">
    ... </td><td style="text-align: left;"> ... </td><td style="text-align: left;"> <em>other elements</em> </td><td style="text-align: left;"> <em>optional</em>
  </td>
</tr>

</table>

<p>Additional elements (or variables) can be added by specifying the
<code>element</code> variable, and their units can be set using, for
example, <code>attr(dat$var, "units") &lt;- "cm"</code>.
</p>
<p>Units are in common metric units: &lsquo;mm&rsquo; for precipitation-related
measurements, &lsquo;cm&rsquo; for snow depth, and
&lsquo;?C&rsquo; for temperature. The <code>flag</code> columns are
a single character <code><a href="base.html#topic+factor">factor</a></code>, described in the <abbr><span class="acronym">MSC</span></abbr>
Archive documentation. Units are added to each column using, for example
<code>attr(dat$precip, "units") &lt;- "mm"</code>.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>Source</h3>

<p>Climate data can be requested from <abbr><span class="acronym">MSC</span></abbr>, or can be obtained
directly from the Canadian Daily Climate Data (<abbr><span class="acronym">CDCD</span></abbr>)
CD-ROMs, which are available for a free download (procedure described
in <code><a href="#topic+A1128551.DLY">A1128551.DLY</a></code>).
</p>


<h3>References</h3>

<p><a href="https://web.archive.org/web/20130625230337/http://climate.weatheroffice.gc.ca/prods_servs/documentation_index_e.html">https://web.archive.org/web/20130625230337/http://climate.weatheroffice.gc.ca/prods_servs/documentation_index_e.html</a> (archived) Technical Documentation - Documentation for the Digital Archive of Canadian Climatological Data (Surface) Identified By Element
</p>
<p><code style="white-space: pre;">&#8288;http://climate.weatheroffice.gc.ca/prods_servs/index_e.html#cdcd&#8288;</code> (dead link) CDCD CD-ROM download location
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mscstn">mscstn</a></code>, <code><a href="#topic+mksub">mksub</a></code>, <code><a href="#topic+mkseas">mkseas</a></code>,
<code><a href="#topic+A1128551.DLY">A1128551.DLY</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>fname &lt;- system.file("extdata", "A1128551.DLY", package="seas")
print(fname)
dat &lt;- read.msc(fname)
print(head(dat))

seas.temp.plot(dat)
year.plot(dat)

# Show how to convert from daily to monthly data
dat$yearmonth &lt;- factor(paste(format(dat$date, "%Y-%m"), 15, sep="-"))
mlydat &lt;- data.frame(date=as.Date(levels(dat$yearmonth)))
mlydat$year &lt;- factor(format(mlydat$date, "%Y"))
mlydat$month &lt;- mkseas(mlydat, "mon")

# means for temperature data
mlydat$t_max &lt;- as.numeric(
    tapply(dat$t_max, dat$yearmonth, mean, na.rm=TRUE))
mlydat$t_min &lt;- as.numeric(
    tapply(dat$t_min, dat$yearmonth, mean, na.rm=TRUE))
mlydat$t_mean &lt;- as.numeric(
    tapply(dat$t_mean, dat$yearmonth, mean, na.rm=TRUE))

# sums for precipitation-related data
mlydat$rain &lt;- as.numeric(
    tapply(dat$rain, dat$yearmonth, sum, na.rm=TRUE))
mlydat$snow &lt;- as.numeric(
    tapply(dat$snow, dat$yearmonth, sum, na.rm=TRUE))
mlydat$precip &lt;- as.numeric(
    tapply(dat$precip, dat$yearmonth, sum, na.rm=TRUE))
print(head(mlydat), 12)

# Show how to convert from a HLY file into daily summaries
## Not run: 
hlydat &lt;- read.msc(bzfile("HLY11_L1127800.bz2"), flags=TRUE)
hlydat$date &lt;- factor(hlydat$date)

# sum the solar radiation for each day to find the 'total daily'
sumdat &lt;- tapply(hlydat$solar, hlydat$date, sum, na.rm=TRUE)
dlydat &lt;- data.frame(date=as.Date(names(sumdat)),
                     solar=as.numeric(sumdat))

# sum the number of hours without measurements
sumdat &lt;- tapply(hlydat$solar, hlydat$date,
                 function(v)(24 - sum(!is.na(v))))
dlydat$na &lt;- as.integer(sumdat)

# quality control to remove days with less than 4 hours missing
Summerland &lt;- dlydat[dlydat$na &lt; 4,]

attr(Summerland$solar, "units") &lt;- "W/(m^2*day)"
attr(Summerland$solar, "long.name") &lt;- "Daily total global solar radiation"
seas.var.plot(Summerland, var="solar", col="yellow", width=5)

## End(Not run)
</code></pre>

<hr>
<h2 id='sdsm'>Read and write from SDSM</h2><span id='topic+sdsm'></span><span id='topic+read.sdsm'></span><span id='topic+write.sdsm'></span>

<h3>Description</h3>

<p>Reads and writes the data format used in
SDSM's &lsquo;<span class="file">DAT</span>&rsquo; and &lsquo;<span class="file">OUT</span>&rsquo; extensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'># reading
read.sdsm(file, start = 1961, end = 2000, calendar)

# writing
write.sdsm(dat, var, start, end, file = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sdsm_+3A_file">file</code></td>
<td>
<p>name of &lsquo;<span class="file">DAT</span>&rsquo; or &lsquo;<span class="file">OUT</span>&rsquo; file</p>
</td></tr>
<tr><td><code id="sdsm_+3A_dat">dat</code></td>
<td>
<p><code>data.frame</code> of variables to be written</p>
</td></tr>
<tr><td><code id="sdsm_+3A_start">start</code></td>
<td>
<p>starting year</p>
</td></tr>
<tr><td><code id="sdsm_+3A_end">end</code></td>
<td>
<p>ending year</p>
</td></tr>
<tr><td><code id="sdsm_+3A_var">var</code></td>
<td>
<p>name of variable to be written from <code>dat</code></p>
</td></tr>
<tr><td><code id="sdsm_+3A_calendar">calendar</code></td>
<td>
<p>calender used for data; if unspecified, this is
assumed to be proleptic Gregorian (normal); however, for CCCma
models this should be &quot;365_day&quot;, and for Hadley models this should
be &quot;360_day&quot;; see <code><a href="#topic+year.length">year.length</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function readings and writes climate data with the
Statistical Downscaling Model, or SDSM. The model uses &lsquo;<span class="file">DAT</span>&rsquo;
extensions for input data, such as daily observations of mean
temperature, and &lsquo;<span class="file">OUT</span>&rsquo; extensions for modeled output.
</p>


<h3>Value</h3>

<p><code>read.sdsm</code> returns a <code>data.frame</code> of the measured
variables. The variables are named <code>V1</code>...<code>Vn</code>,
for <em>n</em> ensembles.
</p>
<p>If a <code>calendar</code> is specified, this is stored as an attribute in
the <code>date</code> data frame column.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p>Wilby, R.L., Dawson, C.W. and Barrow, E.M. 2002.
SDSM &mdash; a decision support tool for the assessment of regional
climate change impacts, <em>Environmental Modelling Software</em>,
<b>17</b> (2), 145&ndash;157, <a href="https://doi.org/10.1016/S1364-8152%2801%2900060-3">doi:10.1016/S1364-8152(01)00060-3</a>
</p>
<p>SDSM can be downloaded free-of-charge for Windows platforms from <br />
<a href="https://www.sdsm.org.uk/">https://www.sdsm.org.uk/</a>
</p>
<p>CGCM1 and HADCM3 model data for SDSM can be downloaded from the
Canadian Climate Impacts and Scenarios website: <br />
<a href="https://web.archive.org/web/20120218192015/http://www.cics.uvic.ca/scenarios/sdsm/select.cgi">https://web.archive.org/web/20120218192015/http://www.cics.uvic.ca/scenarios/sdsm/select.cgi</a> (archived)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.msc">read.msc</a></code>, <code><a href="#topic+change">change</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# reading
fname &lt;- system.file("extdata", "GF_2050s_precip.OUT", package="seas")
gf50 &lt;- read.sdsm(fname)
gf50.ss &lt;- seas.sum(gf50, var=paste("V", 1:20, sep=""), name="Grand Forks")

# analysis
image(gf50.ss, var="V1")
image(gf50.ss, var="V2")
image(gf50.ss, var="V3")

# writing
data(mscdata)
hj &lt;- mksub(mscdata, id=2100630)
fname &lt;- paste(tempdir(), "HJ_Obs_prcp.DAT", sep="/")
write.sdsm(hj, "precip", 1961, 2000, fname)

## End(Not run)
</code></pre>

<hr>
<h2 id='seas-package'>Seasonal statistics: the &lsquo;seas&rsquo; package for R</h2><span id='topic+seas'></span>

<h3>Description</h3>

<p>The <code>seas</code> package for the <span class="rlang"><b>R</b></span> programming environment is capable of
conveying descriptive statistics and graphics for seasonal variables, as found
in climatology, hydrology and ecology. Seasonal variables can be continuous
(i.e., temperature) or discontinuous (i.e., precipitation). An annum can be
partitioned into many arbitrary divisions, or seasonal components, such as
<em>by month</em> or into other fixed intervals. Boxplots are used to describe
the seasonal distributions of continuous variables.  Discontinuous variables
need to be summed over time to smooth the irregularities before the variable
can evaluated and visualized. Statistics, such as precipitation normals, may
be derived from the summed variables, using the mean or median methods. Other
tools and utilities provided in the package can calculate precipitation
interarrivals, cumulative precipitation departures, find changes between two
normals, and import data from archive formats.
</p>
<p>To get started, try some examples, such as <code><a href="#topic+seas.sum">seas.sum</a></code>,
<code><a href="#topic+seas.norm">seas.norm</a></code>. There will be more help added here someday!
</p>
<p>Source code and issues are at <a href="https://github.com/mwtoews/seas">https://github.com/mwtoews/seas</a>
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p>Toews, M.W., Whitfield, P.H., and Allen, D.M. 2007. Seasonal
statistics: The &lsquo;seas&rsquo; package for R. <em>Computers &amp; Geosciences</em>,
<b>33</b> (7), 944&ndash;951, <a href="https://doi.org/10.1016/j.cageo.2006.11.011">doi:10.1016/j.cageo.2006.11.011</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Show a list of changes to the package:
file.show(system.file("ChangeLog", package="seas"))
</code></pre>

<hr>
<h2 id='seas.check'>Check the suitability of a data.frame, or seas.sum for seas</h2><span id='topic+seas.df.check'></span><span id='topic+seas.sum.check'></span>

<h3>Description</h3>

<p>Check the suitability of a <code><a href="base.html#topic+data.frame">data.frame</a></code> or
<code><a href="#topic+seas.sum">seas.sum</a></code> object for <span class="pkg">seas</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seas.df.check(x, orig, var)
seas.sum.check(x, orig, var, norm, year.filter, ann.only)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seas.check_+3A_x">x</code></td>
<td>
<p>a data frame with temporal observations</p>
</td></tr>
<tr><td><code id="seas.check_+3A_orig">orig</code></td>
<td>
<p>the original name of the data frame, for error messages</p>
</td></tr>
<tr><td><code id="seas.check_+3A_var">var</code></td>
<td>
<p>one or more variables in <code>x</code>, which are tested;
ignored if <code>NULL</code> or <a href="base.html#topic+missing">missing</a></p>
</td></tr>
<tr><td><code id="seas.check_+3A_norm">norm</code></td>
<td>
<p>something to normalize <code>var</code>; it can either be the
name of an array in <code>x</code>, a <code><a href="base.html#topic+matrix">matrix</a></code> (<code>bin</code> vs
<code>years</code>), or a 3-dim <code><a href="base.html#topic+array">array</a></code> (used to normalize
multiple <code>var</code>); this is tested to see if <code>norm</code> exists,
and that the dimension are consistent with <code>x</code></p>
</td></tr>
<tr><td><code id="seas.check_+3A_year.filter">year.filter</code></td>
<td>
<p>a subset of <code>x$years</code>, which filters all the
related arrays in the returned value</p>
</td></tr>
<tr><td><code id="seas.check_+3A_ann.only">ann.only</code></td>
<td>
<p><code>x$seas</code> arrays are ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This utility function simply checks the suitability of a
<code><a href="base.html#topic+data.frame">data.frame</a></code> or <code><a href="#topic+seas.sum">seas.sum</a></code> objects for use with
<span class="pkg">seas</span>.
</p>
<p>If <code>x</code> is <code>data.frame</code> (using <code>seas.df.check</code> that is
really required, is a &lsquo;date&rsquo; column, named <code>x$date</code> with a
<a href="base.html#topic+class">class</a> of either <code>link{POSIXct}</code> or <code>link{Date}</code>, and
one or more variables in the <code>var</code> columns of <code>x</code>.
</p>
<p>There must be at least one finite observation in each of <code>var</code>,
if supplied.
</p>
<p>These function is used within other functions, and is not intended to
be called directly.
</p>


<h3>Value</h3>

<p><code>seas.df.check</code> returns a few helpful items from <code>x</code> in a
<code><a href="base.html#topic+list">list</a></code> using <code><a href="base.html#topic+invisible">invisible</a></code>:
</p>

<ul>
<li><p><code>id</code>:station ID from one of <code>attr(x,"id")</code> or
<code>x$id[1]</code>
</p>
</li>
<li><p><code>name</code>:name of seasonal data, such as a place
</p>
</li>
<li><p><code>year.range</code>:integers of start, and ending years
</p>
</li>
<li><p><code>calendar</code>:an attribute from <code>x$date</code>;
otherwise this will be <code>NULL</code> for a normal proleptic
Gregorian calendar
</p>
</li>
<li><p><code>main</code>:main title, from <code><a href="#topic+.seastitle">.seastitle</a></code>
</p>
</li>
<li><p><code>units</code>:units for <code>var[1]</code>
</p>
</li>
<li><p><code>long.name</code>:long name for <code>var[1]</code>
</p>
</li>
<li><p><code>ylab</code>:y-axis label for <code>var[1]</code>
</p>
</li></ul>

<p><code>seas.sum.check</code> returns <code>x</code> with modifications, depending
on <code>norm</code> and <code>year.filter</code>.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+hidden">hidden</a></code> functions for <span class="pkg">seas</span></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)
dat &lt;- mksub(mscdata, id=1108447)
str(seas.df.check(dat))

dat.ss &lt;- seas.sum(dat)
str(seas.sum.check(dat.ss, norm="days"))
</code></pre>

<hr>
<h2 id='seas.norm'>Calculate annual and seasonal &lsquo;normal&rsquo; statistics, including
precipitation normals</h2><span id='topic+seas.norm'></span><span id='topic+precip.norm'></span>

<h3>Description</h3>

<p>Calculates annual and seasonal &lsquo;normal&rsquo; statistics on a
<code><a href="#topic+seas.sum">seas.sum</a></code> object, including precipitation normals for
rain, snow and total precipitation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seas.norm(x, var, fun = "median", norm = "days", year.filter,
          ann.only = FALSE, precip.norm = FALSE)

precip.norm(x, fun = "median", norm = "days", year.filter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seas.norm_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+seas.sum">seas.sum</a></code> object</p>
</td></tr>
<tr><td><code id="seas.norm_+3A_var">var</code></td>
<td>
<p>variable name for the &lsquo;normal&rsquo;; if omitted will
use <code>x$prime</code> (the prime variable of the
<code><a href="#topic+seas.sum">seas.sum</a></code> object), or if <code>precip.norm=TRUE</code> will
be <code>"precip"</code></p>
</td></tr>
<tr><td><code id="seas.norm_+3A_norm">norm</code></td>
<td>
<p>variable for normalization of the sum, usually the number
of &quot;days&quot; in each bin, but it can also be &quot;active&quot; to estimate the
precipitation normal for days of active precipitation</p>
</td></tr>
<tr><td><code id="seas.norm_+3A_year.filter">year.filter</code></td>
<td>
<p>filter specific years for analysis</p>
</td></tr>
<tr><td><code id="seas.norm_+3A_fun">fun</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> of an existing <code>function</code>
object, or a <code><a href="base.html#topic+function">function</a></code> to operate across the number of
years of observations, usually <code>"mean"</code> or <code>"median"</code>
(default); details described below</p>
</td></tr>
<tr><td><code id="seas.norm_+3A_ann.only">ann.only</code></td>
<td>
<p>only annual statistics returned (saves time from other
calculations)</p>
</td></tr>
<tr><td><code id="seas.norm_+3A_precip.norm">precip.norm</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code>; computes precipitation
normal statistics, which is done slightly differently since it
involves rain, snow and total precipitation; if TRUE,
<code>x$var</code> must include &quot;rain&quot;, &quot;snow&quot; and &quot;precip&quot; summed
variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the statistics of precipitation data on an
<em>annual</em> and <em>seasonal</em> scope from a <code><a href="#topic+seas.sum">seas.sum</a></code>
object.
</p>
<p>The seasonal input data are normalized by the number of days in each
bin, to produce a precipitation rate in &lsquo;mm/day&rsquo;. This is
because the number of days in each bin is not equal. The function
<code>fun</code> is then applied to the normalized precipitation, and
operates along each bin, across multiple years of data. The supplied
function is usually <code>"<a href="stats.html#topic+median">median</a>"</code> or <code>"<a href="base.html#topic+mean">mean</a>"</code>,
but it can also be a built in <span class="rlang"><b>R</b></span> function, such as <code>"<a href="stats.html#topic+var">var</a>"</code>
for variance, or a composite such as:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>function(i, na.rm)(quantile(i, 0.2, na.rm=na.rm, names=F))</code> </td><td style="text-align: left;">
    the 20% quantile </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>function(i, na.rm)(mean(i, na.rm=na.rm)/(sd(i, na.rm=na.rm)^3))</code> </td><td style="text-align: left;"> skewness
  </td>
</tr>

</table>

<p>If <code>fun = "<a href="base.html#topic+mean">mean</a>"</code>, then the statistics are
straightforward (using <code><a href="base.html#topic+apply">apply</a></code>), however if <code>fun =
    "median"</code> and there are more than 2 years of data, a different
approach is taken. The <dfn>median</dfn> is a special case of the
<dfn>quantile</dfn> function, where the probability is 50% of the
population. The <code><a href="stats.html#topic+median">median</a></code> and <code><a href="stats.html#topic+quantile">quantile</a></code>
functions are more resistant to outliers than <code><a href="base.html#topic+mean">mean</a></code>, and
can have advantages on precipitation data.  Precipitation occurring
at a given time of year does not have a normal distribution since it
is a value that is not always occurring. It often has a left-skewed
distribution, consisting of many zero measurements, and few extreme
precipitation events.
</p>
<p>In this function, if <code>fun = "median"</code> (default) the
<code><a href="stats.html#topic+median">median</a></code> function is only used to calculate the median
annual precipitation. The <code><a href="stats.html#topic+quantile">quantile</a></code> function is used to
calculate the seasonal statistics, since the sum of medians applied in
each bin are less than the median annual precipitation. This is
because there are usually many measurements of no rain, which skew the
distribution to the left.  The percentile for the quantile function is
found using a secant method (Cheny and Kincaid, 1999) such that the
sum of the quantiles from each bin are equal to the median of the
annual precipitation.
</p>
<p>Snow and rain (which are the two components of precipitation) are
calculated similarly (if <code>fun = "median"</code>).  The annual total
rain and snow amounts are determined by finding the percentile of a
quantile function where the sum is equal to the median of the annual
precipitation. The seasonal snow and rain amounts are independently
found using the same method to find the seasonal precipitation. The
fraction of the snow in each bin,
<code class="reqn">snow.frac.b=snow.b/(snow.b+rain.b)</code> is multiplied by the seasonal
precipitation to determine the seasonal rain and snow amounts.  This
is because the sum of rain and snow in each bin does not equal the
seasonal precipitation. This way, a figure with
<code>precip.only = TRUE</code> and <code>= FALSE</code> will have identical daily
precipitation rates in each bin.
</p>
<p>The pitfalls of calculating precipitation &lsquo;normals&rsquo; is that it
assumes that precipitation occurs <em>every</em> day at a constant rate
within each bin. This is not realistic, as the precipitation rates are
much higher when it is actually occurring.
</p>


<h3>Value</h3>

<p>Returns a <code>precip.norm</code> object, which is a <code><a href="base.html#topic+list">list</a></code>
with the following elements:
</p>
<table role = "presentation">
<tr><td><code>seas</code></td>
<td>

<p>An <code><a href="base.html#topic+array">array</a></code> of seasonal precipitation
statistics: <code>precip</code>, <code>rain</code> and <code>snow</code> (if
<code>precip.only = FALSE</code>) are in &lsquo;mm/day&rsquo;; <code>freq</code> and
<code>na</code> are the fraction of a day in which precipitation is
occurring and that data is missing.
</p>
</td></tr>
<tr><td><code>ann</code></td>
<td>

<p>Annual precipitation statistics. <code>precip</code>, <code>rain</code> and
<code>snow</code> (if <code>precip.only = FALSE</code>) are in &lsquo;mm/year&rsquo;;
<code>active</code> and <code>na</code> are the number of days per year which
are active (for example, days with precipitation) and that data are
missing.
</p>
</td></tr>
<tr><td><code>width</code></td>
<td>
<p>from <code>x</code></p>
</td></tr>
<tr><td><code>bins</code></td>
<td>
<p>from <code>x</code></p>
</td></tr>
<tr><td><code>bin.lengths</code></td>
<td>
<p>maximum number of days in each bin</p>
</td></tr>
<tr><td><code>year.range</code></td>
<td>
<p>from <code>x</code></p>
</td></tr>
<tr><td><code>start.day</code></td>
<td>
<p>from <code>x</code></p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>same as input parameter</p>
</td></tr>
<tr><td><code>units</code></td>
<td>
<p>units for <code>var</code>, usnig <code><a href="base.html#topic+attr">attr</a></code></p>
</td></tr>
<tr><td><code>long.name</code></td>
<td>
<p>long name for <code>var</code>, using <code>attr</code></p>
</td></tr>
<tr><td><code>ann.only</code></td>
<td>
<p>ann.only same as input parameter</p>
</td></tr>
<tr><td><code>precip.only</code></td>
<td>
<p>from same as input parameter</p>
</td></tr>
<tr><td><code>a.cut</code></td>
<td>
<p>from <code>x</code></p>
</td></tr>
<tr><td><code>fun</code></td>
<td>
<p><code><a href="base.html#topic+function">function</a></code> used in analysis</p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>from <code>x</code></p>
</td></tr>
<tr><td><code>name</code></td>
<td>
<p>from <code>x</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>Seasonal data are explicitly normalized to a rate <em>per day</em>
(i.e., mm/day), and not <em>per month</em> (i.e., mm/month). This is
because a time-derivative <em>per month</em> has unequal intervals of
time, ranging between 28 to 31 days. This directly creates up to 10%
error in the analysis between months.
</p>
<p>Units for annual normals, however, remain <em>per year</em>, since a
year is a suitable time derivative.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p>Cheny, E. W. and Kincaid, D. 1999, <em>Numerical Mathematics and
Computing</em>, Pacific Grove: Brooks/Cole Pub., 671 p.
</p>
<p>Guttman, N.B. 1989, &lsquo;Statistical descriptors of climate&rsquo;,
<em>American Meteorological Society</em>, <b>70</b>, 602&ndash;607.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.seas.norm">plot.seas.norm</a></code>, <code><a href="#topic+seas.var.plot">seas.var.plot</a></code>,
<code><a href="#topic+precip.dep">precip.dep</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)

# calculate precipitation normal
dat &lt;- mksub(mscdata, id=1108447)
dat.ss &lt;- seas.sum(dat)
dat.nm &lt;- precip.norm(dat.ss, fun="mean")

# plot precipitation normal
plot(dat.nm) # this is the same as plot.precip.norm(dat.nm)

# use precipitation normal
dat.dep &lt;- precip.dep(dat, dat.nm)
plot(dep ~ date, dat.dep, type="l",
     main="CPD from mean normals")
</code></pre>

<hr>
<h2 id='seas.sum'>Seasonal sum data object</h2><span id='topic+seas.sum'></span>

<h3>Description</h3>

<p>Create a seasonal sum object used for analysis of precipitation data
(among other things, such as recharge rates); this object has sums in
each &lsquo;bin&rsquo; of a season, as well as for each annum (or year).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seas.sum(x, var, width = 11, start.day = 1, prime,
         a.cut = 0.3, na.cut = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seas.sum_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> with daily variables to be summed,
such as precipitation</p>
</td></tr>
<tr><td><code id="seas.sum_+3A_var">var</code></td>
<td>
<p>the names of one or more variables in <code>x</code>, such as
<code>c("rain","snow","precip")</code></p>
</td></tr>
<tr><td><code id="seas.sum_+3A_width">width</code></td>
<td>
<p>a number specifying the width of the bin (factor) in
days, or <code>"mon"</code> for months (see <code><a href="#topic+mkseas">mkseas</a></code> for
others)</p>
</td></tr>
<tr><td><code id="seas.sum_+3A_start.day">start.day</code></td>
<td>
<p>the first day of the season, specified as either a
<code><a href="base.html#topic+Date">Date</a></code> or as an integer day of the year; annual sums
start on this day, and end a day before <code>start.day</code> in the
following year</p>
</td></tr>
<tr><td><code id="seas.sum_+3A_prime">prime</code></td>
<td>
<p>a single variable from <code>var</code> which is the prime
variable of interest, such as <code>"precip"</code>; this is the variable
used for comparison with <code>a.cut</code> and <code>na.cut</code> in the
resulting <code>active</code> and <code>na</code> dimensions</p>
</td></tr>
<tr><td><code id="seas.sum_+3A_a.cut">a.cut</code></td>
<td>
<p>cut-off value for the day to be considered an
<em>active</em> or &lsquo;wet day&rsquo; (based on the <code>prime</code>
variable); a trace amount of 0.3 mm is suggested; if <code>a.cut</code>
is <code>NA</code> or zero, the active variable and analysis will be ignored</p>
</td></tr>
<tr><td><code id="seas.sum_+3A_na.cut">na.cut</code></td>
<td>
<p>cut-off fraction of missing values; can be single value
or a vector for <code>c(annual,seasonal)</code>; details given below</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to discretize and sum time-varying data in a
<code><a href="base.html#topic+data.frame">data.frame</a></code> for analysis in <em>seasonal</em> and
<em>annual</em> parts. This is particularly useful for calculating
normals of rates, such as precipitation and recharge. This function
simply sums up each variable in each bin for each annum (or year), and
provides the results in several arrays.
</p>
<p>Sums are <em>not</em> normalized, and represent a sum for the number of
days in the bin (seasonal data) or annum (for annual data). Seasonal
data can be normalized by the number of days (for a rate per day) or
by the number of active days where <code>prime &gt; a.cut</code>.
</p>
<p>For annual sums, annums with <em>many</em> missing values are ignored
(receiving a value of <code>NA</code>) since it has insufficient data for a
complete sum. The amount of allowable <code>NA</code> values per annum is
controlled by <code>na.cut[1]</code>, which is a fraction of <code>NA</code>
values for the whole annum (default is 0.2).
</p>
<p>The seasonal sums are calculated independently from the annual
sums. Individual bins from each year with <em>many</em> missing values
are ignored, where the amount of allowable <code>NA</code> values is
controlled by <code>na.cut[2]</code> (or <code>na.cut[1]</code>, if the
<code><a href="base.html#topic+length">length</a></code> of <code>na.cut</code> is 1). The default fraction of
<code>NA</code>s in each bin of each annum is 0.2.
</p>


<h3>Value</h3>

 
<p>Returns a <code>seas.sum</code> object, which is a <code><a href="base.html#topic+list">list</a></code> with
the following elements:
</p>

<dl>
<dt><code>ann</code>:</dt><dd>
<p>A <code>data.frame</code> of annual data; the columns are:
</p>

<dl>
<dt><code>year</code>:</dt><dd><p>year, or annum</p>
</dd>
<dt><code>active</code>:</dt><dd><p>the number of &lsquo;active&rsquo; days in the year
where the prime variable is above <code>a.cut</code> (if used)</p>
</dd>
<dt><code>days</code>:</dt><dd><p>number of days in each year</p>
</dd>
<dt><code>na</code>:</dt><dd><p>number of missing days in the year</p>
</dd>
<dt><em>var(s)</em>:</dt><dd><p>annual sum of one or more variable; if the
original units were mm/day, they are now mm/year</p>
</dd>
</dl>

</dd>
<dt><code>seas</code>:</dt><dd>
<p>An <code>array:</code> of seasonal data; the dimensions are:
</p>

<dl>
<dt><code>[[1]]</code>:</dt><dd><p>year, or annum</p>
</dd>
<dt><code>[[2]]</code>:</dt><dd><p>bins, or seasonal factors generated by
<code>mkseas</code></p>
</dd>
<dt><code>[[3]]</code>:</dt><dd><p>sums of variables for each bin of each year; if
the original unit was mm/day, it is now mm per number of
days, which is held in the <code>days</code> item</p>
</dd>
</dl>

</dd>
<dt><code>active</code>:</dt><dd><p>the number of &lsquo;active&rsquo; days in the bin
where the prime variable is above <code>a.cut</code> (if used)</p>
</dd>
<dt><code>days</code>:</dt><dd><p>an array of the number of days in each bin; this
array is useful for normalizing the numbers in <code>seas</code> to
comparable units of mm/day</p>
</dd>
<dt><code>na</code>:</dt><dd><p>number of missing days in each bin</p>
</dd>
<dt><code>start.day</code>:</dt><dd><p>same as input</p>
</dd>
<dt><code>years</code>:</dt><dd><p>years (same as <code>ann[[1]]</code> and
<code>seas[[1]]</code>); if <code>start.day</code> is not 1, this represents the
starting and ending years (i.e., <code>1991_1992</code>) of each annum;
see <code><a href="#topic+mkann">mkann</a></code></p>
</dd>
<dt><code>var</code>:</dt><dd><p>variable(s) which the sums represent (part of
<code>ann[[2]]</code> and <code>seas[[3]]</code>)</p>
</dd>
<dt><code>units</code>:</dt><dd><p>a <code><a href="base.html#topic+list">list</a></code> of  units for each
<code>var</code>, such as &ldquo;mm/day&rdquo;; these are obtained from the
<code>units</code> attribute (using <code><a href="base.html#topic+attr">attr</a></code>) found in
<code>x$var</code></p>
</dd>
<dt><code>long.name</code>:</dt><dd><p>a <code>list</code> of long names for each <code>var</code>;
these are obtained from <code>long.name</code> in <code>x$var</code>; set to
be <code>var</code> if <code>NULL</code></p>
</dd>
<dt><code>prime</code>:</dt><dd><p>a <code>prime</code> variable, such as <code>"precip"</code></p>
</dd>
<dt><code>width</code>:</dt><dd><p><code>width</code> argument passed to <code>mkseas</code></p>
</dd>
<dt><code>bins</code>:</dt><dd><p>names of bins returned by <code>mkseas</code> (same as
<code>seas[[2]]</code>)</p>
</dd>
<dt><code>bin.lengths</code>:</dt><dd><p>the maximum length in days for each <code>bin</code></p>
</dd>
<dt><code>year.range</code>:</dt><dd><p>range of years from <code>x</code></p>
</dd>
<dt><code>precip.only</code>:</dt><dd><p>value used in argument (modified if
insufficient data found in <code>x</code>)</p>
</dd>
<dt><code>na.cut</code>:</dt><dd><p>value used in argument</p>
</dd>
<dt><code>a.cut</code>:</dt><dd><p>value used in argument; if it is zero or
<code>NA</code>, this will be <code>FALSE</code></p>
</dd>
<dt><code>id</code>:</dt><dd><p>from <code>attr(x,"id")</code> (<code>NULL</code> if not set)</p>
</dd>
<dt><code>name</code>:</dt><dd><p>from <code>attr(x,"name")</code> (<code>NULL</code> if not set)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p>To view the result try <code><a href="#topic+image.seas.sum">image.seas.sum</a></code>, or
alternatively, <code><a href="#topic+plot.seas.sum">plot.seas.sum</a></code>
</p>
<p>To calculate and view a &ldquo;normal&rdquo;, use  <code><a href="#topic+seas.norm">seas.norm</a></code>
and  <code><a href="#topic+plot.seas.norm">plot.seas.norm</a></code>, or for precipitation use
<code><a href="#topic+precip.norm">precip.norm</a></code> and <code><a href="#topic+plot.precip.norm">plot.precip.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)
dat &lt;- mksub(mscdata, id=1108447)
dat.ss &lt;- seas.sum(dat, width="mon")

# Structure in R
str(dat.ss)

# Annual data
dat.ss$ann

# Demonstrate how to slice through a cubic array
dat.ss$seas["1990",,]
dat.ss$seas[,2,] # or "Feb", if using English locale
dat.ss$seas[,,"precip"]

# Simple calculation on an array
(monthly.mean &lt;- apply(dat.ss$seas[,,"precip"], 2, mean,na.rm=TRUE))
barplot(monthly.mean, ylab="Mean monthly total (mm/month)",
	main="Un-normalized mean precipitation in Vancouver, BC")
text(6.5, 150, paste("Un-normalized rates given 'per month' should be",
	"avoided since ~3-9% error is introduced",
	"to the analysis between months", sep="\n"))

# Normalized precip
norm.monthly &lt;- dat.ss$seas[,,"precip"] / dat.ss$days
norm.monthly.mean &lt;- apply(norm.monthly, 2, mean,na.rm=TRUE)
print(round(norm.monthly, 2))
print(round(norm.monthly.mean, 2))
barplot(norm.monthly.mean,
    ylab="Normalized mean monthly total (mm/day)",
	main="Normalized mean precipitation in Vancouver, BC")

# Better graphics of data
dat.ss &lt;- seas.sum(dat, width=11)
image(dat.ss)
</code></pre>

<hr>
<h2 id='seas.temp.plot'>Plot seasonal temperature normals</h2><span id='topic+seas.temp.plot'></span><span id='topic+plot.seas.temp'></span>

<h3>Description</h3>

<p>Plot seasonal temperature normals using boxplots, and also plot
seasonal diurnal variability between minimum and maximum temperature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seas.temp.plot(x, width = 11, start = 1, rep = 0, start.day = 1,
           var = c("t_min", "t_max", "t_mean"),
           add.alt = FALSE, ylim, main, ylab, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seas.temp.plot_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> with <code><a href="base.html#topic+Date">Date</a></code>, <code>t_min</code>,
<code>t_max</code>, and (optionally) <code>t_mean</code> columns; <code>x</code> can
also have <code>id</code> or <code>name</code> <a href="base.html#topic+attributes">attributes</a> to help give a
title for the plot</p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_width">width</code></td>
<td>
<p>size of bin; see <code><a href="#topic+mkseas">mkseas</a></code></p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_start">start</code></td>
<td>
<p>starting bin number; e.g., if <code>width="mon"</code> and
<code>start=5</code>, the plot will start on &quot;May&quot; at the left-hand side</p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_rep">rep</code></td>
<td>
<p>repetition of the bins in the boxplots</p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_start.day">start.day</code></td>
<td>
<p>if <code>width</code> is numeric, this is the day of year
which is considered to be the start of the first bin</p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_var">var</code></td>
<td>
<p>array specifying the names of the columns in <code>x</code>
which relate to the <em>minimum</em>, <em>maximum</em> and <em>mean</em>
temperatures; the <code>units</code> attribute for the y-axis label are
taken from the <code>minimum</code>, if available, otherwise it is
assumed it is in C</p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_add.alt">add.alt</code></td>
<td>
<p><code>logical</code>; add an alternative scale: if the units
are in C, the alternative is F; if units are
F, the alternative is C; and if units are K,
the alternative is C</p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_ylim">ylim</code></td>
<td>
<p><code>c(min, max)</code> range for temperature, or y-axis</p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_main">main</code></td>
<td>
<p>title for plot; if it is missing, then it will
automatically be generated</p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label; if it is missing, then it will automatically
be generated</p>
</td></tr>
<tr><td><code id="seas.temp.plot_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots boxplots for seasonal temperature normals from mean daily
temperature, and diurnal variability with the mean difference of daily
minimum and maximum temperatures (red vertical lines). If the mean is
not supplied, it is calculated from the mean of daily maximum and
minimum temperatures.
</p>


<h3>Value</h3>

<p>Returns values from <code><a href="graphics.html#topic+boxplot">boxplot</a></code> statistics on mean temperature.
</p>


<h3>Note</h3>

<p>This function was formerly named <code>plot.seas.temp</code>, but required
renaming as it is not an S3 method.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+seas.var.plot">seas.var.plot</a></code>, <code><a href="#topic+plot.seas.norm">plot.seas.norm</a></code>,
<code><a href="#topic+year.plot">year.plot</a></code>
</p>
<p>Use <code>mksub</code> to make a subset of <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)

dat &lt;- mksub(mscdata, id=1108447)
seas.temp.plot(dat)
seas.temp.plot(dat, width="mon", add.alt=TRUE)

# starting and ending elsewhere
seas.temp.plot(dat, start=18, rep=3)
</code></pre>

<hr>
<h2 id='seas.var.plot'>Plot seasonal normals of a given variable</h2><span id='topic+seas.var.plot'></span><span id='topic+plot.seas.var'></span>

<h3>Description</h3>

<p>Plot seasonal normals of a variable using boxplots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seas.var.plot(x, var, width = 11, start = 1, rep = 0, start.day = 1,
              col, ylim, add.alt, alt.ylab, main, ylab, ylog, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seas.var.plot_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> with <code><a href="base.html#topic+Date">Date</a></code> and <code>var</code>
columns of data; <code>x</code> can also have <code>id</code> or <code>name</code>
<a href="base.html#topic+attributes">attributes</a> to help give a title for the plot</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_var">var</code></td>
<td>
<p>a variable; a column name in <code>x</code>; this can also have
attributes of <code>units</code> and <code>long.name</code> to help give a title
for the y-axis</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_width">width</code></td>
<td>
<p>size of bin; see <code><a href="#topic+mkseas">mkseas</a></code></p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_start">start</code></td>
<td>
<p>starting bin number; e.g., if <code>width="mon"</code> and
<code>start=5</code>, the plot will start on &quot;May&quot; at the left-hand side</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_rep">rep</code></td>
<td>
<p>repetition of the bins in the boxplot</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_start.day">start.day</code></td>
<td>
<p>when <code>width</code> is numeric, this is the starting
day of the year for the fist bin, or it can be a <code>Date</code> to
specify a month and day (year is ignored)</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_col">col</code></td>
<td>
<p>colour for the boxplots; the default is <code>"lightgrey"</code></p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_ylim">ylim</code></td>
<td>
<p><code>c(min, max)</code> range for y-axis</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_add.alt">add.alt</code></td>
<td>
<p>this adds an alternative axis, and is specified by
<code>c(slope,inter)</code>; for example, if the primary measure is in
C, a secondary scale in K would be
<code>c(1,273.15)</code>, or in F would be
<code>c(5/9,32)</code>; if <code>ylog=TRUE</code>, then this can also be
<code>TRUE</code> to display the <code class="reqn">\log_{10}</code> transformed values of
<code>var</code> on the alternative axis</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_alt.ylab">alt.ylab</code></td>
<td>
<p>label for the alternate y-axis (the primary y-axis
label is set through <a href="base.html#topic+attributes">attributes</a> for <code>var</code> in <code>x</code>)</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_main">main</code></td>
<td>
<p>title for plot; if it is missing, then it will
automatically be generated</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label; if it is missing, then it will automatically
be generated</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_ylog">ylog</code></td>
<td>
<p>used to <code class="reqn">\log_{10}</code> transform values of
<code>var</code> for the boxplots; this has a similar but different affect
than specifying <code>par(ylog=TRUE)</code> before this function</p>
</td></tr>
<tr><td><code id="seas.var.plot_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shows normals of a seasonal variable using boxplots.
</p>


<h3>Value</h3>

<p>Returns values from <code><a href="graphics.html#topic+boxplot">boxplot</a></code> statistics on the variable.
</p>


<h3>Note</h3>

<p>This function was formerly named <code>plot.seas.var</code>, but required
renaming as it is not an S3 method.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+seas.var.plot">seas.var.plot</a></code>, <code><a href="#topic+plot.seas.norm">plot.seas.norm</a></code>,
<code><a href="#topic+year.plot">year.plot</a></code>.
</p>
<p>Use <code><a href="#topic+mksub">mksub</a></code> to make a subset of <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>opar &lt;- par(no.readonly=FALSE)
on.exit(par(opar))
data(mscdata)
dat &lt;- mksub(mscdata, id=1108447)

seas.var.plot(dat, var="t_max", col="tomato",
  add.alt=c(5/9, 32), alt.ylab="F")
abline(h=0)

par(opar) # reset graphics parameters

seas.var.plot(dat, var="t_min",
  start=18, rep=16)

pdat &lt;- dat[dat$precip &gt; 0,]
attr(pdat$precip, "long.name") &lt;- "precipitation intensity"
attr(pdat$precip, "units") &lt;- "mm/day"

par(ylog=TRUE)
seas.var.plot(pdat, var="precip", col="azure")
title(sub="These boxplots are simply plotted on a log-y scale")

par(opar)

seas.var.plot(pdat, var="precip", col="azure", ylog=TRUE)
title(sub="These boxplots are based on log-transformed values")

seas.var.plot(pdat, var="precip", col="azure", ylog=TRUE, add.alt=TRUE)
title(sub="The actual axis for graph is on the right-side")
</code></pre>

<hr>
<h2 id='SeasOpts'>Options for seas</h2><span id='topic+SeasOpts'></span><span id='topic+setSeasOpts'></span>

<h3>Description</h3>

<p>Set default options for <span class="pkg">seas</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setSeasOpts()
</code></pre>


<h3>Details</h3>

<p><code>setSeasOpts</code> sets all the default values for options in
<span class="pkg">seas</span>, and at some point it may support arguments for styles,
such as &lsquo;black and white&rsquo;. However, after the initial setting of
options, users may change the options to modify the look of graphics
produced in <span class="pkg">seas</span>.
</p>
<p>Other details of the graphics can be modified using
<code><a href="graphics.html#topic+par">par</a></code>. This includes the font sizes, back-ground colour,
font family, and many others. For example, setting <code>par(cex=0.75)</code>
will reduce the font size in the active device by  75% of the
original size; while <code>par(font.main=2)</code> will change only the font
for the main titles.
</p>


<h3>Value</h3>

<p><code>setSeasOpts()</code> only sets the <code>options</code> in the current
environment, and returns nothing.
</p>
<p>This is automatically done when <span class="pkg">seas</span> is loaded (using
<code><a href="base.html#topic+.onLoad">.onLoad</a></code>).
</p>


<h3>Options used in seas</h3>

<p>Here are all the supported options for <span class="pkg">seas</span>, with the default
values shown for each option. Options are stored in
<code><a href="base.html#topic+list">list</a></code>s, which make them easy to &lsquo;get&rsquo;, but
difficult to &lsquo;set&rsquo;, and is shown in the
<em>Examples</em> section at the bottom.
</p>

<dl>
<dt><code>seas.main</code>:</dt><dd><p>formating style for main title:
</p>

<dl>
<dt><code>fmt</code>:</dt><dd><p>format for <code>name</code> and <code>id</code> (if
available) as the first <code>"%s"</code>, followed by a range of
years as the second <code>"%s"</code>; these are formated by
<code><a href="base.html#topic+sprintf">sprintf</a></code>; <code>"%s\n%s"</code></p>
</dd>
<dt><code>rngsep</code>:</dt><dd><p>separation between ranges of years; <code>"-"</code>,
other alternatives could be <code>" to "</code></p>
</dd>
<dt><code>show.id</code>:</dt><dd><p>show id (if available) in main title;
<code>TRUE</code></p>
</dd>
<dt><code>show.fun</code>:</dt><dd><p>show function (where applicable) in
main title; <code>TRUE</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.label</code>:</dt><dd><p>label formating for variables:
</p>

<dl>
<dt><code>fmt</code>:</dt><dd><p>label for name and units (if available);
<code>"%s (%s)"</code>, other alternatives could be
<code>"%s, %s"</code></p>
</dd>
<dt><code>monthday</code>:</dt><dd><p>format for month and day (see
<code><a href="base.html#topic+strftime">strftime</a></code> for format codes); this can be either
<code>"%b %-d"</code> (for most Unix-like systems),
<code>"%b %#d"</code> (for Windows systems), or <code>"%b %d"</code>
(for other systems); this should produce a string, such as
&lsquo;Aug 1&rsquo; for <em>August 1st</em></p>
</dd>
<dt><code>month</code></dt><dd><p>similar as previous, but when starting
exactly on month-breaks; <code>"%B"</code></p>
</dd>
<dt><code>ann</code></dt><dd><p>a label for <code><a href="#topic+image.seas.sum">image.seas.sum</a></code>;
default is &lsquo;annual&rsquo;</p>
</dd>
</dl>

</dd>
<dt><code>seas.month.grid</code>:</dt><dd><p>setting for the display of the
month grid (see <code><a href="#topic+.seasmonthgrid">.seasmonthgrid</a></code>), which is common to
many plots that use a <code><a href="base.html#topic+numeric">numeric</a></code> <code>width</code> in
<code><a href="#topic+mkseas">mkseas</a></code>:
</p>

<dl>
<dt><code>abb</code>:</dt><dd><p>abbreviate month names for grid; <code>TRUE</code></p>
</dd>
<dt><code>len</code>:</dt><dd><p>trim month name lengths to a number, for
instance to get J|F|M|A|M|J|J|A|S|O|N|D, use <code>1</code>; <code>NULL</code></p>
</dd>
<dt><code>force</code>:</dt><dd><p>force the display of each month label using
<code><a href="graphics.html#topic+mtext">mtext</a></code>, otherwise labels can be automatically placed
and adjusted for device using <code><a href="graphics.html#topic+axis">axis</a></code>; <code>TRUE</code></p>
</dd>
<dt><code>label</code>:</dt><dd><p>show a month label on the grid; <code>TRUE</code></p>
</dd>
<dt><code>col</code>:</dt><dd><p>colour for month grid; <code>"lightgrey"</code></p>
</dd>
<dt><code>lwd</code>:</dt><dd><p>width for month grid lines, multiplied by
<code>par("lwd")</code>; <code>1</code></p>
</dd>
<dt><code>lty</code>:</dt><dd><p>style for month grid lines; <code>1</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.bxp</code>:</dt><dd><p>attributes which affect the display of
boxplots, used by various functions:
</p>

<dl>
<dt><code>boxcol</code>:</dt><dd><p>default box-fill colour; <code>"lightgrey"</code></p>
</dd>
<dt><code>outcex</code>:</dt><dd><p>outlier symbol size, multiplied by
<code>par("cex")</code>; <code>1</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.temp</code>:</dt><dd><p>attributes which affect the display of
<code><a href="#topic+seas.temp.plot">seas.temp.plot</a></code> (among other functions):
</p>

<dl>
<dt><code>col</code>:</dt><dd><p>colours for boxplot fill and diurnal variability
lines; <code>c("lightgrey","red")</code></p>
</dd>
<dt><code>lwd</code>:</dt><dd><p>width of diurnal variability lines in
<code>seas.temp.plot</code>, multiplied by <code>par("lwd")</code>;
<code>3</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.precip</code>:</dt><dd><p>attributes which affect the display of
precipitation:
</p>

<dl>
<dt><code>col</code>:</dt><dd><p>colour; <code>"grey"</code></p>
</dd>
<dt><code>density</code>:</dt><dd><p>pattern density; <code>NULL</code></p>
</dd>
<dt><code>angle</code>:</dt><dd><p>pattern angel; <code>45</code></p>
</dd>
<dt><code>lwd</code>:</dt><dd><p>thickness of box line, multiplied by
<code>par("lwd")</code>; <code>1</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.rain</code>:</dt><dd><p>attributes which affect the display of
rain:
</p>

<dl>
<dt><code>col</code>:</dt><dd><p>colour; <code>"lightblue"</code></p>
</dd>
<dt><code>density</code>:</dt><dd><p>pattern density; <code>NULL</code></p>
</dd>
<dt><code>angle</code>:</dt><dd><p>pattern angel; <code>45</code></p>
</dd>
<dt><code>lwd</code>:</dt><dd><p>thickness of box line, multiplied by
<code>par("lwd")</code>; <code>1</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.snow</code>:</dt><dd><p>attributes which affect the display of
snow:
</p>

<dl>
<dt><code>col</code>:</dt><dd><p>colour; <code>"lightgrey"</code></p>
</dd>
<dt><code>density</code>:</dt><dd><p>pattern density; <code>NULL</code></p>
</dd>
<dt><code>angle</code>:</dt><dd><p>pattern angel; <code>-45</code></p>
</dd>
<dt><code>lwd</code>:</dt><dd><p>thickness of box line, multiplied by
<code>par("lwd")</code>; <code>1</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.interarrival</code>:</dt><dd><p>attributes which affect the display
of wet- and dry-spells in <code><a href="#topic+plot.interarrival">plot.interarrival</a></code>;
organized as <code>c(wet,dry)</code>:
</p>

<dl>
<dt><code>col</code>:</dt><dd><p>colour; <code>c("lightblue","orange")</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.median</code>:</dt><dd><p>attributes which affect the display of
the <code><a href="stats.html#topic+median">median</a></code> lines in <code><a href="#topic+image.seas.sum">image.seas.sum</a></code>:
</p>

<dl>
<dt><code>col</code>:</dt><dd><p>colour; <code>"red"</code></p>
</dd>
<dt><code>lwd</code>:</dt><dd><p>width of line, multiplied by
<code>par("lwd")</code>; <code>1</code></p>
</dd>
<dt><code>lty</code>:</dt><dd><p>style of line; <code>1</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.mean</code>:</dt><dd><p>attributes which affect the display of the
<code><a href="base.html#topic+mean">mean</a></code> lines in <code><a href="#topic+image.seas.sum">image.seas.sum</a></code>:
</p>

<dl>
<dt><code>col</code>:</dt><dd><p>colour; <code>"red"</code></p>
</dd>
<dt><code>lwd</code>:</dt><dd><p>width of line, multiplied by
<code>par("lwd")</code>; <code>1</code></p>
</dd>
<dt><code>lty</code>:</dt><dd><p>style of line; <code>1</code></p>
</dd>
</dl>

</dd>
<dt><code>seas.na</code>:</dt><dd><p>attributes which affect the display of
<code>NA</code> or missing values in various plots:
</p>

<dl>
<dt><code>col</code>:</dt><dd><p>colour; <code>"red"</code></p>
</dd>
<dt><code>pch</code>:</dt><dd><p>character symbol; <code>"x"</code></p>
</dd>
</dl>

</dd>
</dl>



<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+hidden">hidden</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>if(is.null(getOption("seas.main")))
  setSeasOpts()

# Modify an option
getOption("seas.main")$show.id
cp &lt;- orig &lt;- getOption("seas.main")
cp$show.id &lt;- FALSE
options(seas.main=cp)
getOption("seas.main")$show.id

options(seas.main=orig)
</code></pre>

<hr>
<h2 id='summerland'>Example LARS-WG data file of synthetic data from Summerland, BC</h2><span id='topic+summerland'></span><span id='topic+summerland.sr'></span><span id='topic+summerland.dat'></span>

<h3>Description</h3>

<p>Example LARS-WG data file of synthetic data from Summerland, BC.
</p>


<h3>Format</h3>

<p>Both files are ASCII-based, and can be viewed in any text editor
</p>

<ul>
<li> <p>&lsquo;<span class="file">summerland.sr</span>&rsquo; is the &lsquo;site file&rsquo;, which contains
the meta-data
</p>
</li>
<li> <p>&lsquo;<span class="file">summerland.dat</span>&rsquo; is the data file
</p>
</li></ul>

<p>Details of these file formats can be found in the LARS-WG manual and
help documentation.
</p>


<h3>Details</h3>

<p>The sample file name was generated in LARS-WG from calibration of data
from Summerland (MSC ID: 1127800). Thirty-years were generated, each
synthetic year has 365-days.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.lars">read.lars</a></code>, which contains an example using
these files</p>

<hr>
<h2 id='write.help'>Write climate data in the format used by the HELP model</h2><span id='topic+write.help'></span>

<h3>Description</h3>

<p>Write climate data in the format used by the Hydrological Evaluation
of Landfill Performance (HELP) model. This exports the data using two
slightly different variants of HELP: the DOS versions (3.07 to 3.80D)
and for Visual HELP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.help(file, dat, var = "", name = "", region, lat,
           visual.help = FALSE, metric = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.help_+3A_file">file</code></td>
<td>
<p>name of output file; [DOS] HELP uses extensions
&lsquo;<span class="file">*.D4</span>&rsquo;, &lsquo;<span class="file">*.D7</span>&rsquo;, and &lsquo;<span class="file">*.D13</span>&rsquo; for daily precipitation,
temperature and solar radiation, respectively; Visual HELP uses the
file names &lsquo;<span class="file">_weather1.dat</span>&rsquo;, &lsquo;<span class="file">_weather2.dat</span>&rsquo; and
&lsquo;<span class="file">_weather3.dat</span>&rsquo; for the same series of variables</p>
</td></tr>
<tr><td><code id="write.help_+3A_dat">dat</code></td>
<td>
<p><code>data.frame</code> of climate data</p>
</td></tr>
<tr><td><code id="write.help_+3A_var">var</code></td>
<td>
<p>variable to be exported; must be one of <code>"precip"</code>,
<code>"t_mean"</code> or <code>"solar"</code></p>
</td></tr>
<tr><td><code id="write.help_+3A_name">name</code></td>
<td>
<p><code>character</code>; location name</p>
</td></tr>
<tr><td><code id="write.help_+3A_region">region</code></td>
<td>
<p><code>character</code>; region</p>
</td></tr>
<tr><td><code id="write.help_+3A_lat">lat</code></td>
<td>
<p><code>numeric</code>; location latitude in decimal degrees</p>
</td></tr>
<tr><td><code id="write.help_+3A_visual.help">visual.help</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> formats output for Visual HELP; else
formated for the DOS HELP versions (default)</p>
</td></tr>
<tr><td><code id="write.help_+3A_metric">metric</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> if using metric units (this only sets a
flag, please ensure the data are in either C,
mm/day and <code class="reqn">\mbox{MJ}/(\mbox{m}^2 \cdot \mbox{day})</code>
or F, in./day and langleys/day)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This utility function is experimental and has not been extensively
tested; please report any errors to me.
</p>
<p>HELP requires continuous data; no missing values are allowed.
</p>
<p>Data imported from SDSM use a 365-day calendar, and can be
approximated using <code><a href="#topic+conv365toGregorian">conv365toGregorian</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p>HELP 3.07 - Original version for the US EPA; free download <br />
<a href="https://www.epa.gov/land-research/hydrologic-evaluation-landfill-performance-help-model">https://www.epa.gov/land-research/hydrologic-evaluation-landfill-performance-help-model</a>
</p>
<p>HELP-D - Developed by Dr. Klaus Berger, University
of Hamburg <br />
<a href="https://www.geo.uni-hamburg.de/en/bodenkunde/service/help-model.html">https://www.geo.uni-hamburg.de/en/bodenkunde/service/help-model.html</a>
</p>
<p>Visual HELP - Uses a similar underlying code as HELP 3.07, but
features a Windows GUI <br />
<code style="white-space: pre;">&#8288;https://www.waterloohydrogeologic.com/visual-help/&#8288;</code> (dead link)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.msc">read.msc</a></code>, <code><a href="#topic+read.sdsm">read.sdsm</a></code>,
<code><a href="#topic+read.lars">read.lars</a></code>, <code><a href="#topic+conv365toGregorian">conv365toGregorian</a></code></p>

<hr>
<h2 id='year.length'>Calculate the number of days in a year</h2><span id='topic+year.length'></span>

<h3>Description</h3>

<p>Determines the number of days per year using a given calendar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>year.length(x, calendar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="year.length_+3A_x">x</code></td>
<td>
<p>year or a <code><a href="base.html#topic+Date">Date</a></code></p>
</td></tr>
<tr><td><code id="year.length_+3A_calendar">calendar</code></td>
<td>
<p>calendar, see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of days per year depends on the choice of
calendar. Calendar names used in the function are the same defined
for the CF conventions, used for netCDF files. If a calendar is not
specified (or <code>NULL</code>), then it is assumed to
be a proleptic Gregorian calendar (which extends before
1582-10-15). Other accepted calendars are:
</p>

<ul>
<li> <p><code>"360"</code>: always 360-days per year
</p>
</li>
<li> <p><code>"365_day"</code> or <code>"noleap"</code>: always 365-days per year
</p>
</li>
<li> <p><code>"366"</code> or <code>"all_leap"</code>: always 366-days per year
</p>
</li>
<li> <p><code>"julian"</code>: 366 days on years divisible by 4, otherwise
365 days
</p>
</li></ul>



<h3>Value</h3>

<p>Returns a vector the same length as <code>x</code> with the numbers of days
corresponding to each year.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p><a href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#calendar">http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#calendar</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+mkseas">mkseas</a></code>, <code><a href="#topic+mkann">mkann</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>cal &lt;- data.frame(year=c(1899, 1900, 1904, 2000, 2080, 2100))
cal[["Gregorian"]] &lt;- year.length(cal$year)
cal[["Julian"]] &lt;- year.length(cal$year, "julian")
cal[["360_day"]] &lt;- year.length(cal$year, "360_day")
cal[["365_day"]] &lt;- year.length(cal$year, "365_day")
cal[["366_day"]] &lt;- year.length(cal$year, "366_day")

cal
</code></pre>

<hr>
<h2 id='year.ploy'>Plot annual temperature and precipitation statistics</h2><span id='topic+year.plot'></span><span id='topic+plot.year'></span>

<h3>Description</h3>

<p>Plots a continuous set of annual temperature and precipitation
statistics for a single climate station.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>year.plot(x, start.day = 1, precip.only = FALSE, precip.ylim,
          temp.ylim, na.cut = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="year.ploy_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> of climate data</p>
</td></tr>
<tr><td><code id="year.ploy_+3A_start.day">start.day</code></td>
<td>
<p>starting day of annum; either a <code>Date</code> or an
integer day of year; this influences the statistics for each year or
annum; such as annual precipitation sums</p>
</td></tr>
<tr><td><code id="year.ploy_+3A_precip.only">precip.only</code></td>
<td>
<p>only precipitation data is used; rain and snow ignored</p>
</td></tr>
<tr><td><code id="year.ploy_+3A_precip.ylim">precip.ylim</code></td>
<td>
<p>range for precipitation graph</p>
</td></tr>
<tr><td><code id="year.ploy_+3A_temp.ylim">temp.ylim</code></td>
<td>
<p>range for temperature graph</p>
</td></tr>
<tr><td><code id="year.ploy_+3A_na.cut">na.cut</code></td>
<td>
<p>minimum number of missing data points in a year to make
it void; temperature and precipitation are treated independently</p>
</td></tr>
<tr><td><code id="year.ploy_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This simply shows temperature using (<code><a href="graphics.html#topic+boxplot">boxplot</a></code>s) and
annual precipitation totals. The red bars are directly proportional to
the fraction of missing (or <code>NA</code>) values for the year; statistics
not shown if there are more than <code>na.cut</code> <code>NA</code> values in a
given year.
</p>


<h3>Note</h3>

<p>This function was formerly named <code>plot.year</code>, but required
renaming as it is not an S3 method.
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p><code><a href="#topic+mscdata">mscdata</a></code>, <code><a href="#topic+seas.temp.plot">seas.temp.plot</a></code>,
<code><a href="#topic+plot.seas.norm">plot.seas.norm</a></code> (can be used for precipitation normals),
calculate statistics with <code><a href="base.html#topic+tapply">tapply</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mscdata)

year.plot(mksub(mscdata, id=1108447))

year.plot(mksub(mscdata, id=1108447,
                start=as.Date("1975-08-01"),
                end=as.Date("2004-07-31")),
          start.day=as.Date("2000-08-01"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
