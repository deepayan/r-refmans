<!DOCTYPE html><html lang="en"><head><title>Help for package vitality</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vitality}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#vitality'><p>Fitting routines for the Vitality family of mortality models.</p></a></li>
<li><a href='#daphnia'><p>Sample Daphnia Data</p></a></li>
<li><a href='#dataPrep'><p>Function for data preparation</p></a></li>
<li><a href='#ft.4p'><p>Density function for 3-parameter (r, s, u)</p></a></li>
<li><a href='#ft.6p'><p>Density function for 2-parameters (r, s)</p></a></li>
<li><a href='#indexFinder'><p>Finds the first value of a vector that is less than a value.</p></a></li>
<li><a href='#logLikelihood.4p'><p>Log likelihood of 2-process 4-parameter model</p></a></li>
<li><a href='#logLikelihood.6p'><p>Log likelihood of 2-process 6-parameter vitality model</p></a></li>
<li><a href='#logLikelihood.k'><p>Log likelihood of 3-parameter (r,s,k) model</p></a></li>
<li><a href='#logLikelihood.ku'><p>Log likelihood of 4-parameter (r,s,k,u) model</p></a></li>
<li><a href='#mu.vd.4p'><p>Total mortality rate for the 2-process 4-parameter vitality model</p></a></li>
<li><a href='#mu.vd.6p'><p>Total mortality rate for the 2-process 6-parameter vitality model</p></a></li>
<li><a href='#mu.vd1.4p'><p>Intrinsic mortality rate for the 2-process 4-parameter vitality model</p></a></li>
<li><a href='#mu.vd1.6p'><p>Intrinsic mortality rate for the 2-process 6-parameter vitality model</p></a></li>
<li><a href='#mu.vd2.4p'><p>Extrinsic mortality rate for the 2-process 4-parameter vitality model</p></a></li>
<li><a href='#mu.vd2.6p'><p>Extrinsic mortality rate for the 2-process 6-parameter vitality model</p></a></li>
<li><a href='#mu.vd3.6p'><p>Adult extrinsic mortality rate for the 2-process 6-parameter vitality model</p></a></li>
<li><a href='#mu.vd4.6p'><p>Childhood extrinsic mortality rate for the 2-process 6-parameter vitality model</p></a></li>
<li><a href='#plotting.4p'><p>Plotting function for 2-process 4-parameter vitality model</p></a></li>
<li><a href='#plotting.6p'><p>Plotting function for 2-process 6-parameter vitality model</p></a></li>
<li><a href='#plotting.k'><p>Plotting function for 3-parameter vitality model</p></a></li>
<li><a href='#plotting.ku'><p>Plotting function for 4-parameter vitality model</p></a></li>
<li><a href='#rainbow_trout_for_k'><p>Sample Rainbow Trout Data</p></a></li>
<li><a href='#stdErr.4p'><p>Standard errors for 4-parameters: r, s, lambda, beta</p></a></li>
<li><a href='#stdErr.6p'><p>Standard errors for 6-parameters: r, s, lambda, beta, gamma, alpha</p></a></li>
<li><a href='#stdErr.k'><p>Standard errors for 3-parameters: r, s, k</p></a></li>
<li><a href='#stdErr.ku'><p>Standard errors for 4-parameters: r, s, k, u</p></a></li>
<li><a href='#SurvFn.4p'><p>The cumulative survival distribution function for 2-process 4-parameter vitality model</p></a></li>
<li><a href='#SurvFn.6p'><p>The cumulative survival distribution function for 2-process 6-parameter vitality model</p></a></li>
<li><a href='#SurvFn.ex.4p'><p>The extrinsic cumulative survival distribution function for 2-process 4-parameter vitality model</p></a></li>
<li><a href='#SurvFn.ex.6p'><p>The extrinsic cumulative survival distribution function for 2-process 6-parameter vitality model</p></a></li>
<li><a href='#SurvFn.h.4p'><p>Intrinsic cumulative survival distribution for 4 parameter model</p></a></li>
<li><a href='#SurvFn.h.6p'><p>Intrinsic cumulative survival distribution for 6 parameter model</p></a></li>
<li><a href='#SurvFn.in.4p'><p>The intrinsic cumulative survival distribution function for 2-process 4-parameter vitality model</p></a></li>
<li><a href='#SurvFn.in.6p'><p>The intrinsic cumulative survival distribution function for 2-process 6-parameter vitality model</p></a></li>
<li><a href='#SurvFn.k'><p>The cumulative survival distribution function for 3-parameter vitality model</p></a></li>
<li><a href='#SurvFn.ku'><p>The cumulative survival distribution function for 4-parameter vitality model</p></a></li>
<li><a href='#survProbInc.4p'><p>Incremental survival probability for 2-process 4-parameter model</p></a></li>
<li><a href='#survProbInc.6p'><p>Incremental survival probability for 2-process 6-parameter model</p></a></li>
<li><a href='#survProbInc.k'><p>Incremental survival probability for 3-parameter model</p></a></li>
<li><a href='#survProbInc.ku'><p>Incremental survival probability for 4-parameter model</p></a></li>
<li><a href='#swedish_females'><p>Swedish Female Mortality Data</p></a></li>
<li><a href='#vft.4p'><p>Vectorized density function</p></a></li>
<li><a href='#vft.6p'><p>Vectorized density function</p></a></li>
<li><a href='#vitality.4p'><p>Fitting routine for the 2-process, 4-parameter vitality model (no childhood hook).</p></a></li>
<li><a href='#vitality.6p'><p>Fitting routine for the 2-process, 6-parameter vitality model (with childhood hook).</p></a></li>
<li><a href='#vitality.k'><p>Fitting routine for the 3-parameter vitality model.</p></a></li>
<li><a href='#vitality.ku'><p>Fitting routine for the 4-parameter vitality model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Fitting Routines for the Vitality Family of Mortality Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-05-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Gregor Passolt, James J. Anderson, Ting Li, David H. Salinger, David J. Sharrow</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David J. Sharrow &lt;dsharrow@uw.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides fitting routines for four versions of the
        Vitality family of mortality models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Collate:</td>
<td>'dataPrep.R' 'vitality.4p.R' 'vitality.6p.R' 'vitality.k.R'
'vitality.ku.R' 'vitality.utils.R' 'data_documentation.R'
'density.R' 'mortality_rate.R' 'package_documentation.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-13 20:59:53 UTC; davesharrow</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-13 21:26:30 UTC</td>
</tr>
</table>
<hr>
<h2 id='vitality'>Fitting routines for the Vitality family of mortality models.</h2><span id='topic+vitality'></span><span id='topic+vitality-package'></span>

<h3>Description</h3>

<p>This package provides support for fitting the vitality family of mortality models that characterize mortality in terms of the loss vitality, an abstract measure of survival capacity. Mortality occurs by two processes. Intrinsic mortality occurs when vitality is depleted by stochastic losses. Extrinsic mortality occurs when a random external challenge exceeds the available vitality. The package contains four model versions:
</p>

<ul>
<li><p><code><a href="#topic+vitality.k">vitality.k</a></code> is a 3-parameter model. Intrinsic mortality is characterized by the mean (r) and variability (s) in vitality loss rate. Extrinsic mortality is characterized by the frequency (k) of lethal random challenges. Model is appropriate to animal mortality data (e.g. Anderson 2000).
</p>
</li>
<li><p><code><a href="#topic+vitality.ku">vitality.ku</a></code> is a 4-parameter model. Intrinsic mortality is characterized by the mean (r) and variability (s) in the vitality loss rate and the standard deviation of initial vitality (u). Extrinsic mortality is characterized by the frequency (k) of lethal random challenges. Model is appropriate to animal mortality data (e.g. Li and Anderson 2009).
</p>
</li>
<li><p><code><a href="#topic+vitality.4p">vitality.4p</a></code> is a 4-parameter model. Intrinsic mortality is characterized by the mean (r) and variability (s) in the vitality loss rate. Extrinsic mortality is characterized by random challenges of frequency (lambda) and random magnitude (beta) exceeding the remaining average vitality. Model is appropriate to adult human mortality data (e.g. Li and Anderson 2013).
</p>
</li>
<li><p><code><a href="#topic+vitality.6p">vitality.6p</a></code> is a 6-parameter model. Intrinsic mortality is characterized by the mean (r) and variability (s) in the vitality loss rate. Adult extrinsic mortality is characterized by random challenges of frequency (lambda) and random magnitude (beta) exceeding the remaining average vitality. Child extrinsic mortality is characterized by childhood challenges of frequency (gamma) exceeding childhood vitality development rate (alpha). Model is appropriate to full lifespan of human mortality data (e.g. Anderson and Li 2015).
</p>
</li></ul>

<p>Model parameters are estimated on survival or mortality rate data using maximum log likelihood methods based on Salinger et al. (2003). 
</p>
<p>Version 1.1 adds the versions <code><a href="#topic+vitality.k">vitality.k</a></code>, <code><a href="#topic+vitality.ku">vitality.ku</a></code> and <code><a href="#topic+vitality.6p">vitality.6p</a></code> to the original code for the <code><a href="#topic+vitality.4p">vitality.4p</a></code> model previously designated vitality.2ps.
</p>
<p>Version 1.2 makes previously invisible functions to produce the survival and mortality rate functions from a given set of parameters (e.g. <code><a href="#topic+SurvFn.4p">SurvFn.4p</a></code>, <code><a href="#topic+SurvFn.6p">SurvFn.6p</a></code>, <code><a href="#topic+mu.vd.4p">mu.vd.4p</a></code>, <code><a href="#topic+mu.vd.6p">mu.vd.6p</a></code>) usable. The child mortality rate formula in <code><a href="#topic+mu.vd.6p">mu.vd.6p</a></code>, <code><a href="#topic+mu.vd2.6p">mu.vd2.6p</a></code>, and <code><a href="#topic+mu.vd4.6p">mu.vd4.6p</a></code> has been updated to improve fit.
</p>


<h3>Details</h3>

<p>Support for package development was provided by the National Institute of Ageing Grant 1R21AG046760-01, the Bonneville Power Administration, and the University of Washington Center for Statistics and the Social Sciences and Center for Studies in Demography and Ecology.
</p>


<h3>References</h3>


<ul>
<li><p> Anderson, J.J. (2000). &quot;A vitality-based model relating stressors and environmental properties to organism survival.&quot; Ecological Monographs 70(3):445-470.
</p>
</li>
<li><p> Anderson, J.J. and Li, T. (2015). &quot;A two-process mortality model with extensions to juvenile mortality, populations and evolution.&quot; Population Association of America Annual Meeting 2015 <a href="http://paa2015.princeton.edu/abstracts/153144">http://paa2015.princeton.edu/abstracts/153144</a>
</p>
</li>
<li><p> Li, T. and J.J. Anderson. (2009).  &quot;The
vitality model: A way to understand population survival
and demographic heterogeneity.&quot;  Theoretical Population
Biology 76: 118-131.
</p>
</li>
<li><p> Li, T. and J.J. Anderson (2013). &quot;Shaping human mortality patterns through intrinsic and extrinsiv vitality processes.&quot;  Demographic Research 28(12): 341-372.
</p>
</li>
<li><p> Salinger, D.H., J.J. Anderson, and O.S. Hamel.
(2003).  &quot;A parameter estimation routine for the
vitality-based survival model.&quot;  Ecological Modelling 166
(3): 287-29
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># vitality.k
data(daphnia)
time &lt;- daphnia$days
survival_fraction &lt;- daphnia$lx

results.modk &lt;- vitality.k(time = time,
                           sdata = survival_fraction,
                           rc.data=TRUE, 
                           se=FALSE,
                           gfit=FALSE, 
                           datatype="CUM", 
                           ttol=.000001, 
                           init.params=FALSE, 
                           lower=c(0,-1,0), upper=c(100,50,50), 
                           pplot=TRUE, 
                           tlab="days", 
                           lplot=TRUE, 
                           cplot=TRUE, 
                           Iplot=TRUE, 
                           silent=TRUE)

# vitality.ku
data(rainbow_trout_for_k)
time &lt;- rainbow_trout_for_k$days
survival_fraction &lt;- rainbow_trout_for_k$survival

results.modku &lt;- vitality.ku(time = time,
                             sdata = survival_fraction,
                             rc.data=TRUE,
                             se=FALSE,
                             gfit=FALSE,
                             datatype="CUM",
                             ttol=.000001,
                             init.params=FALSE,
                             lower=c(0,-1,0,0),upper=c(100,100,50,50),
                             pplot=TRUE,
                             tlab="days",
                             lplot=TRUE,
                             cplot=TRUE,
                             Iplot=TRUE,
                             silent=TRUE,
                             L=0)
# vitality.4p
data(swedish_females)
swe &lt;- swedish_females
initial_age &lt;- 20 # Could be adjusted
time &lt;- initial_age:max(swedish_females$age)
survival_fraction &lt;- swe$lx / swe$lx[1]
survival_fraction &lt;- survival_fraction[time] # when first element &lt;1 data is adjusted
sample_size &lt;- swe$Lx[initial_age] #sample size

results.4par &lt;- vitality.4p(time = time,
                            sdata = survival_fraction,
                            #init.params=FALSE,
                            init.params=c(0.012, 0.01, 0.1, 0.1),
                            lower = c(0, 0, 0, 0), upper = c(100,50,1,50),
                            rc.data = TRUE, 
                            se = sample_size, 
                            datatype = "CUM", 
                            ttol = 1e-06,
                            pplot = TRUE,
                            Iplot = TRUE,
                            Mplot = TRUE,
                            tlab = "years",
                            silent = FALSE)

# vitality.6p
data(swedish_females)
swe &lt;- swedish_females
initial_age &lt;- 0 
time &lt;- swedish_females$age
survival_fraction &lt;- swe$lx / swe$lx[1]
sample_size &lt;- swe$Lx[1] #sample size

results.6par &lt;- vitality.6p(time = time,
                            sdata = survival_fraction,
                            #init.params=FALSE,
                            init.params=c(0.012, 0.01, 0.1, 0.1, 0.1, 1),
                            lower = c(0, 0, 0, 0, 0, 0), upper = c(100,50,1,50,50,50),
                            rc.data = TRUE, 
                            se=FALSE,
                            #se = sample_size, 
                            datatype = "CUM", 
                            ttol = 1e-06,
                            pplot = TRUE,
                            Iplot = TRUE,
                            Mplot = TRUE,
                            tlab = "years",
                            silent = FALSE)
</code></pre>

<hr>
<h2 id='daphnia'>Sample Daphnia Data</h2><span id='topic+daphnia'></span>

<h3>Description</h3>

<p>Sample survival data for daphnia. Columns include &quot;days&quot; and &quot;lx&quot; (cumulative survival proportion by day).
</p>


<h3>Format</h3>

<p>data frame</p>


<h3>Source</h3>

<p>http://cbr.washington.edu/analysis/vitality
</p>
<p>Anderson, J.J. (2000). &quot;A vitality-based model relating stressors and environmental properties to organism survival.&quot; Ecological Monographs 70(3):445-470 (Figure 5)
</p>

<hr>
<h2 id='dataPrep'>Function for data preparation</h2><span id='topic+dataPrep'></span>

<h3>Description</h3>

<p>Function to deal with NAs, right truncated data, and
datatype (i.e. cumulative survival or incremental mortality).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dataPrep(time, sdata, datatype, rc.data,
    returnMatrix = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dataPrep_+3A_time">time</code></td>
<td>
<p>A vector of observation dates</p>
</td></tr>
<tr><td><code id="dataPrep_+3A_sdata">sdata</code></td>
<td>
<p>A vector of survival data of the same length
as <code>time</code></p>
</td></tr>
<tr><td><code id="dataPrep_+3A_datatype">datatype</code></td>
<td>
<p>either <code>"CUM"</code> for cumulative or
<code>"INC"</code> for incremental</p>
</td></tr>
<tr><td><code id="dataPrep_+3A_rc.data">rc.data</code></td>
<td>
<p>Boolean. Is data right-censored?</p>
</td></tr>
<tr><td><code id="dataPrep_+3A_returnmatrix">returnMatrix</code></td>
<td>
<p>Boolean. False returns a data frame,
true returns a matrix. (as in the original), if &quot;matrix&quot;
returns a matrix instead, with the &quot;rc.data&quot; column being
0 for FALSE, 1 for TRUE, or 2 for TF</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed for use in the primary vitality model fitting functions in this package. See package documentation.</p>


<h3>Value</h3>

<p>Returns a data.frame or matrix with columns time, sfract,
x1, x2, Ni (incremental survival fraction), rc.data.
</p>

<hr>
<h2 id='ft.4p'>Density function for 3-parameter (r, s, u)</h2><span id='topic+ft.4p'></span>

<h3>Description</h3>

<p>This function is used in the calculation of the fitted intrinsic (<code><a href="#topic+mu.vd1.4p">mu.vd1.4p</a></code>) and total (<code><a href="#topic+mu.vd.4p">mu.vd.4p</a></code>) mortality rate in the 4-parameter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ft.4p(xx, r, s, u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ft.4p_+3A_xx">xx</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="ft.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="ft.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="ft.4p_+3A_u">u</code></td>
<td>
<p>u value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>density
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vft.4p">vft.4p</a></code>, <code><a href="#topic+ft.6p">ft.6p</a></code></p>

<hr>
<h2 id='ft.6p'>Density function for 2-parameters (r, s)</h2><span id='topic+ft.6p'></span>

<h3>Description</h3>

<p>This function is used in the calculation of the fitted intrinsic (<code><a href="#topic+mu.vd1.6p">mu.vd1.6p</a></code>) and total (<code><a href="#topic+mu.vd.6p">mu.vd.6p</a></code>) mortality rate in the 6-parameter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ft.6p(xx, r, s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ft.6p_+3A_xx">xx</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="ft.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="ft.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>density
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vft.6p">vft.6p</a></code></p>

<hr>
<h2 id='indexFinder'>Finds the first value of a vector that is less than a value.</h2><span id='topic+indexFinder'></span>

<h3>Description</h3>

<p>For use in the primary vitality model fitting functions in this package. See package documentation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  indexFinder(x, val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="indexFinder_+3A_x">x</code></td>
<td>
<p>Vector to search</p>
</td></tr>
<tr><td><code id="indexFinder_+3A_val">val</code></td>
<td>
<p>Threshold</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Gives the index of the first value of x that is &lt;= val.
returns -1 if no value satisfies the condition
</p>

<hr>
<h2 id='logLikelihood.4p'>Log likelihood of 2-process 4-parameter model</h2><span id='topic+logLikelihood.4p'></span>

<h3>Description</h3>

<p>Gives the log likelihood of 2-process 6 parameter vitality model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  logLikelihood.4p(par, xx1, xx2, NNi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikelihood.4p_+3A_par">par</code></td>
<td>
<p>vector of parameter(r, s, lambda, beta)</p>
</td></tr>
<tr><td><code id="logLikelihood.4p_+3A_xx1">xx1</code></td>
<td>
<p>xx1 vector</p>
</td></tr>
<tr><td><code id="logLikelihood.4p_+3A_xx2">xx2</code></td>
<td>
<p>xx2 vector</p>
</td></tr>
<tr><td><code id="logLikelihood.4p_+3A_nni">NNi</code></td>
<td>
<p>survival fractions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.4p">vitality.4p</a></code>.</p>


<h3>Value</h3>

<p>log likelihood
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logLikelihood.6p">logLikelihood.6p</a></code></p>

<hr>
<h2 id='logLikelihood.6p'>Log likelihood of 2-process 6-parameter vitality model</h2><span id='topic+logLikelihood.6p'></span>

<h3>Description</h3>

<p>Gives the log likelihood of 6-parameter vitality model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  logLikelihood.6p(par, xx1, xx2, NNi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikelihood.6p_+3A_par">par</code></td>
<td>
<p>vector of parameters (r, s, lambda, beta, alpha, gamma)</p>
</td></tr>
<tr><td><code id="logLikelihood.6p_+3A_xx1">xx1</code></td>
<td>
<p>xx1 vector</p>
</td></tr>
<tr><td><code id="logLikelihood.6p_+3A_xx2">xx2</code></td>
<td>
<p>xx2 vector</p>
</td></tr>
<tr><td><code id="logLikelihood.6p_+3A_nni">NNi</code></td>
<td>
<p>survival fractions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.6p">vitality.6p</a></code>.</p>


<h3>Value</h3>

<p>log likelihood
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.6p">vitality.6p</a></code></p>

<hr>
<h2 id='logLikelihood.k'>Log likelihood of 3-parameter (r,s,k) model</h2><span id='topic+logLikelihood.k'></span>

<h3>Description</h3>

<p>Gives the log likelihood of 3-parameter vitality model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  logLikelihood.k(par, xx1, xx2, NNi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikelihood.k_+3A_par">par</code></td>
<td>
<p>vector of parameters (r, s, k)</p>
</td></tr>
<tr><td><code id="logLikelihood.k_+3A_xx1">xx1</code></td>
<td>
<p>xx1 vector</p>
</td></tr>
<tr><td><code id="logLikelihood.k_+3A_xx2">xx2</code></td>
<td>
<p>xx2 vector</p>
</td></tr>
<tr><td><code id="logLikelihood.k_+3A_nni">NNi</code></td>
<td>
<p>survival fractions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.k">vitality.k</a></code>.</p>


<h3>Value</h3>

<p>log likelihood
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.k">vitality.k</a></code></p>

<hr>
<h2 id='logLikelihood.ku'>Log likelihood of 4-parameter (r,s,k,u) model</h2><span id='topic+logLikelihood.ku'></span>

<h3>Description</h3>

<p>Gives the log likelihood of 4-parameter vitality model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  logLikelihood.ku(par, xx1, xx2, NNi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikelihood.ku_+3A_par">par</code></td>
<td>
<p>vector of parameters (r, s, k, u)</p>
</td></tr>
<tr><td><code id="logLikelihood.ku_+3A_xx1">xx1</code></td>
<td>
<p>xx1 vector</p>
</td></tr>
<tr><td><code id="logLikelihood.ku_+3A_xx2">xx2</code></td>
<td>
<p>xx2 vector</p>
</td></tr>
<tr><td><code id="logLikelihood.ku_+3A_nni">NNi</code></td>
<td>
<p>survival fractions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.ku">vitality.ku</a></code>.</p>


<h3>Value</h3>

<p>log likelihood
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.ku">vitality.ku</a></code></p>

<hr>
<h2 id='mu.vd.4p'>Total mortality rate for the 2-process 4-parameter vitality model</h2><span id='topic+mu.vd.4p'></span>

<h3>Description</h3>

<p>Gives the total age-specific mortality rates for a given set of the four parameters. See <code><a href="#topic+mu.vd1.4p">mu.vd1.4p</a></code> for calculation of intrinsic age-specific mortality rates. See <code><a href="#topic+mu.vd2.4p">mu.vd2.4p</a></code> for calculation of extrinsic age-specific mortality rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mu.vd.4p(t, r, s, lambda, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu.vd.4p_+3A_t">t</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="mu.vd.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="mu.vd.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="mu.vd.4p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="mu.vd.4p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Total age-specific mortality rates
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mu.vd1.4p">mu.vd1.4p</a></code>, <code><a href="#topic+mu.vd2.4p">mu.vd2.4p</a></code></p>

<hr>
<h2 id='mu.vd.6p'>Total mortality rate for the 2-process 6-parameter vitality model</h2><span id='topic+mu.vd.6p'></span>

<h3>Description</h3>

<p>Gives the total age-specific mortality rates for a given set of the six parameters. See <code><a href="#topic+mu.vd1.6p">mu.vd1.6p</a></code> for calculation of intrinsic age-specific mortality rates. See <code><a href="#topic+mu.vd2.6p">mu.vd2.6p</a></code> for calculation of extrinsic age-specific mortality rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mu.vd.6p(t, r, s, lambda, beta, gamma, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu.vd.6p_+3A_t">t</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="mu.vd.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="mu.vd.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="mu.vd.6p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="mu.vd.6p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
<tr><td><code id="mu.vd.6p_+3A_gamma">gamma</code></td>
<td>
<p>gamma value</p>
</td></tr>
<tr><td><code id="mu.vd.6p_+3A_alpha">alpha</code></td>
<td>
<p>alpha value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Total age-specific mortality rates
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mu.vd1.6p">mu.vd1.6p</a></code>, <code><a href="#topic+mu.vd2.6p">mu.vd2.6p</a></code></p>

<hr>
<h2 id='mu.vd1.4p'>Intrinsic mortality rate for the 2-process 4-parameter vitality model</h2><span id='topic+mu.vd1.4p'></span>

<h3>Description</h3>

<p>Gives the intrinsic age-specific mortality rates for a given set of <code>r</code> and <code>s</code>, the intrinsic parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mu.vd1.4p(x, r, s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu.vd1.4p_+3A_x">x</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="mu.vd1.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="mu.vd1.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Intrinsic age-specific mortality rates
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mu.vd.4p">mu.vd.4p</a></code>, <code><a href="#topic+mu.vd2.4p">mu.vd2.4p</a></code></p>

<hr>
<h2 id='mu.vd1.6p'>Intrinsic mortality rate for the 2-process 6-parameter vitality model</h2><span id='topic+mu.vd1.6p'></span>

<h3>Description</h3>

<p>Gives the intrinsic age-specific mortality rates for a given set of <code>r</code> and <code>s</code>, the intrinsic parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mu.vd1.6p(x, r, s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu.vd1.6p_+3A_x">x</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="mu.vd1.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="mu.vd1.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of intrinsic age-specific mortality rates at age <code>x</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mu.vd.6p">mu.vd.6p</a></code>, <code><a href="#topic+mu.vd2.6p">mu.vd2.6p</a></code></p>

<hr>
<h2 id='mu.vd2.4p'>Extrinsic mortality rate for the 2-process 4-parameter vitality model</h2><span id='topic+mu.vd2.4p'></span>

<h3>Description</h3>

<p>Gives the extrinsic age-specific mortality rates for a given set of <code>r</code> and the extrinsic parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mu.vd2.4p(x, r, lambda, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu.vd2.4p_+3A_x">x</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="mu.vd2.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="mu.vd2.4p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="mu.vd2.4p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Extrinsic age-specific mortality rates
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mu.vd.4p">mu.vd.4p</a></code>, <code><a href="#topic+mu.vd1.4p">mu.vd1.4p</a></code></p>

<hr>
<h2 id='mu.vd2.6p'>Extrinsic mortality rate for the 2-process 6-parameter vitality model</h2><span id='topic+mu.vd2.6p'></span>

<h3>Description</h3>

<p>Gives the extrinsic age-specific mortality rates for a given set of <code>r</code> and the extrinsic parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mu.vd2.6p(x, r, lambda, beta, gamma, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu.vd2.6p_+3A_x">x</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="mu.vd2.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="mu.vd2.6p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="mu.vd2.6p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
<tr><td><code id="mu.vd2.6p_+3A_gamma">gamma</code></td>
<td>
<p>gamma value</p>
</td></tr>
<tr><td><code id="mu.vd2.6p_+3A_alpha">alpha</code></td>
<td>
<p>alpha value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of extrinsic age-specific mortality rates at ages <code>x</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mu.vd.6p">mu.vd.6p</a></code>, <code><a href="#topic+mu.vd1.6p">mu.vd1.6p</a></code>,  <code><a href="#topic+mu.vd3.6p">mu.vd3.6p</a></code>,  <code><a href="#topic+mu.vd4.6p">mu.vd4.6p</a></code></p>

<hr>
<h2 id='mu.vd3.6p'>Adult extrinsic mortality rate for the 2-process 6-parameter vitality model</h2><span id='topic+mu.vd3.6p'></span>

<h3>Description</h3>

<p>Gives the extrinsic age-specific mortality rates for a given set of <code>r</code> and the adult extrinsic parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mu.vd3.6p(x, r, lambda, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu.vd3.6p_+3A_x">x</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="mu.vd3.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="mu.vd3.6p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="mu.vd3.6p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of adult extrinsic age-specific mortality rates at ages <code>x</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mu.vd.6p">mu.vd.6p</a></code>, <code><a href="#topic+mu.vd1.6p">mu.vd1.6p</a></code>, <code><a href="#topic+mu.vd2.6p">mu.vd2.6p</a></code>, <code><a href="#topic+mu.vd4.6p">mu.vd4.6p</a></code></p>

<hr>
<h2 id='mu.vd4.6p'>Childhood extrinsic mortality rate for the 2-process 6-parameter vitality model</h2><span id='topic+mu.vd4.6p'></span>

<h3>Description</h3>

<p>Gives the childhood extrinsic age-specific mortality rates for a given set of the childhood extrinsic parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mu.vd4.6p(x, gamma, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu.vd4.6p_+3A_x">x</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="mu.vd4.6p_+3A_gamma">gamma</code></td>
<td>
<p>gamma value</p>
</td></tr>
<tr><td><code id="mu.vd4.6p_+3A_alpha">alpha</code></td>
<td>
<p>alpha value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of childhood extrinsic age-specific mortality rates at ages <code>x</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mu.vd.6p">mu.vd.6p</a></code>, <code><a href="#topic+mu.vd1.6p">mu.vd1.6p</a></code>,  <code><a href="#topic+mu.vd2.6p">mu.vd2.6p</a></code>,  <code><a href="#topic+mu.vd3.6p">mu.vd3.6p</a></code></p>

<hr>
<h2 id='plotting.4p'>Plotting function for 2-process 4-parameter vitality model</h2><span id='topic+plotting.4p'></span>

<h3>Description</h3>

<p>This function plots the estimated results from the 4 parameter vitality model. It is used within the function <code><a href="#topic+vitality.4p">vitality.4p</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  plotting.4p(r.final, s.final, lambda.final, beta.final,
    mlv, time, sfract, x1, x2, Ni, pplot, Iplot, Mplot,
    tlab, rc.data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotting.4p_+3A_r.final">r.final</code></td>
<td>
<p>r estimate</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_s.final">s.final</code></td>
<td>
<p>s estimate</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_lambda.final">lambda.final</code></td>
<td>
<p>lambda estimate</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_beta.final">beta.final</code></td>
<td>
<p>beta estimate</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_mlv">mlv</code></td>
<td>
<p>TODO mlv</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_time">time</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_sfract">sfract</code></td>
<td>
<p>survival fraction</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_x1">x1</code></td>
<td>
<p>Time 1</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_x2">x2</code></td>
<td>
<p>Time 2</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_ni">Ni</code></td>
<td>
<p>Initial population</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_pplot">pplot</code></td>
<td>
<p>Boolean. Plot cumulative survival fraction?</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_iplot">Iplot</code></td>
<td>
<p>Boolean. Plot incremental survival?</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_mplot">Mplot</code></td>
<td>
<p>Boolean. Plot mortality rate? Note: plotted mortality data is derived from survival data and is approximate</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_tlab">tlab</code></td>
<td>
<p>Character, label for time axis</p>
</td></tr>
<tr><td><code id="plotting.4p_+3A_rc.data">rc.data</code></td>
<td>
<p>Boolean, right-censored data?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+vitality.4p">vitality.4p</a></code> for further description of function arguments.
</p>
<p>Only one of <code>Iplot</code> or <code>Mplot</code> should be set to <code>TRUE</code> at once.</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.4p">vitality.4p</a></code>, <code><a href="#topic+mu.vd.4p">mu.vd.4p</a></code>, <code><a href="#topic+mu.vd1.4p">mu.vd1.4p</a></code>, <code><a href="#topic+mu.vd2.4p">mu.vd2.4p</a></code></p>

<hr>
<h2 id='plotting.6p'>Plotting function for 2-process 6-parameter vitality model</h2><span id='topic+plotting.6p'></span>

<h3>Description</h3>

<p>This function plots the estimated results from the 6 parameter vitality model. It is used within the function <code><a href="#topic+vitality.6p">vitality.6p</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  plotting.6p(r.final, s.final, lambda.final, beta.final, 
    gamma.final, alpha.final, mlv, time, sfract, x1, x2, Ni, pplot, Iplot, Mplot,
    tlab, rc.data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotting.6p_+3A_r.final">r.final</code></td>
<td>
<p>r estimate</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_s.final">s.final</code></td>
<td>
<p>s estimate</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_lambda.final">lambda.final</code></td>
<td>
<p>lambda estimate</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_beta.final">beta.final</code></td>
<td>
<p>beta estimate</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_gamma.final">gamma.final</code></td>
<td>
<p>gamma estimate</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_alpha.final">alpha.final</code></td>
<td>
<p>alpha estimate</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_mlv">mlv</code></td>
<td>
<p>TODO mlv</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_time">time</code></td>
<td>
<p>time vector giving the ages at which calculate the estimated value</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_sfract">sfract</code></td>
<td>
<p>observed survival fraction</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_x1">x1</code></td>
<td>
<p>Time 1</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_x2">x2</code></td>
<td>
<p>Time 2</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_ni">Ni</code></td>
<td>
<p>Initial population</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_pplot">pplot</code></td>
<td>
<p>Boolean. Plot cumulative survival fraction?</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_iplot">Iplot</code></td>
<td>
<p>Boolean. Plot incremental survival?</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_mplot">Mplot</code></td>
<td>
<p>Boolean. Plot mortality rate? Note: plotted mortality data is derived from survival data and is approximate</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_tlab">tlab</code></td>
<td>
<p>Character, label for time axis</p>
</td></tr>
<tr><td><code id="plotting.6p_+3A_rc.data">rc.data</code></td>
<td>
<p>Boolean, right-censored data?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+vitality.6p">vitality.6p</a></code> for further description of function arguments.
</p>
<p>Only one of <code>Iplot</code> or <code>Mplot</code> should be set to <code>TRUE</code> at once.</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.6p">vitality.6p</a></code>, <code><a href="#topic+mu.vd.6p">mu.vd.6p</a></code>, <code><a href="#topic+mu.vd1.6p">mu.vd1.6p</a></code>, <code><a href="#topic+mu.vd2.6p">mu.vd2.6p</a></code>, <code><a href="#topic+mu.vd3.6p">mu.vd3.6p</a></code>, <code><a href="#topic+mu.vd4.6p">mu.vd4.6p</a></code></p>

<hr>
<h2 id='plotting.k'>Plotting function for 3-parameter vitality model</h2><span id='topic+plotting.k'></span>

<h3>Description</h3>

<p>This function plots the estimated results from the 3 parameter vitality model. It is used within the function <code><a href="#topic+vitality.k">vitality.k</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  plotting.k(r.final,s.final,k.final,mlv,time,sfract,x1,x2,Ni,
  pplot,tlab,lplot,cplot,Iplot,gfit,rc.data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotting.k_+3A_r.final">r.final</code></td>
<td>
<p>r estimate</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_s.final">s.final</code></td>
<td>
<p>s estimate</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_k.final">k.final</code></td>
<td>
<p>k estimate</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_mlv">mlv</code></td>
<td>
<p>TODO mlv</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_time">time</code></td>
<td>
<p>time vector giving the ages at which calculate the estimated value</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_sfract">sfract</code></td>
<td>
<p>observed survival fraction</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_x1">x1</code></td>
<td>
<p>Time 1</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_x2">x2</code></td>
<td>
<p>Time 2</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_ni">Ni</code></td>
<td>
<p>Initial population</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_pplot">pplot</code></td>
<td>
<p>Boolean. Plot cumulative survival fraction?</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_iplot">Iplot</code></td>
<td>
<p>Boolean. Plot incremental survival?</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_lplot">lplot</code></td>
<td>
<p>Boolean. Plot likelihood functions? Provides likelihood function plotting. Defaults to <code>FALSE</code>. Note:  these plots are not &quot;likelihood profiles&quot; in that while one parameter is varied, the others are held fixed, rather than re-optimized. (must also have pplot=T.)</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_cplot">cplot</code></td>
<td>
<p>Boolean. Plot likelihood contour plot? Provides a likelihood contour plot for a range of r and s values (can be slow so default is <code>FALSE</code>). Must also have <code>lplot=T</code> and <code>pplot=T</code> to get contour plots.</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_tlab">tlab</code></td>
<td>
<p>Character, label for time axis. Defaults to &quot;days&quot;.</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_gfit">gfit</code></td>
<td>
<p>Provides a Pearson C type test for goodness of fit. Default is <code>FALSE</code>. Must provide the initial study population to compute goodness of fit.</p>
</td></tr>
<tr><td><code id="plotting.k_+3A_rc.data">rc.data</code></td>
<td>
<p>Boolean, right-censored data?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+vitality.k">vitality.k</a></code> for further description of function arguments.</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.k">vitality.k</a></code></p>

<hr>
<h2 id='plotting.ku'>Plotting function for 4-parameter vitality model</h2><span id='topic+plotting.ku'></span>

<h3>Description</h3>

<p>This function plots the estimated results from the 4 parameter vitality model. It is used within the function <code><a href="#topic+vitality.ku">vitality.ku</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  plotting.ku(r.final,s.final,k.final,u.final,mlv,time,sfract,x1,x2,Ni,
    pplot,tlab,lplot,cplot,Iplot,gfit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotting.ku_+3A_r.final">r.final</code></td>
<td>
<p>r estimate</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_s.final">s.final</code></td>
<td>
<p>s estimate</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_k.final">k.final</code></td>
<td>
<p>k estimate</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_u.final">u.final</code></td>
<td>
<p>u estimate</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_mlv">mlv</code></td>
<td>
<p>TODO mlv</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_time">time</code></td>
<td>
<p>time vector giving the ages at which calculate the estimated value</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_sfract">sfract</code></td>
<td>
<p>observed survival fraction</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_x1">x1</code></td>
<td>
<p>Time 1</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_x2">x2</code></td>
<td>
<p>Time 2</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_ni">Ni</code></td>
<td>
<p>Initial population</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_pplot">pplot</code></td>
<td>
<p>Boolean. Plot cumulative survival fraction?</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_iplot">Iplot</code></td>
<td>
<p>Boolean. Plot incremental survival?</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_lplot">lplot</code></td>
<td>
<p>Boolean. Plot likelihood functions? Provides likelihood function plotting. Defaults to <code>FALSE</code>. Note:  these plots are not &quot;likelihood profiles&quot; in that while one parameter is varied, the others are held fixed, rather than re-optimized. (must also have pplot=T.)</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_cplot">cplot</code></td>
<td>
<p>Boolean. Plot likelihood contour plot? Provides a likelihood contour plot for a range of r and s values (can be slow so default is <code>FALSE</code>). Must also have <code>lplot=T</code> and <code>pplot=T</code> to get contour plots.</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_tlab">tlab</code></td>
<td>
<p>Character, label for time axis. Defaults to &quot;days&quot;.</p>
</td></tr>
<tr><td><code id="plotting.ku_+3A_gfit">gfit</code></td>
<td>
<p>Provides a Pearson C type test for goodness of fit. Default is <code>FALSE</code>. Must provide the initial study population to compute goodness of fit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+vitality.ku">vitality.ku</a></code> for further description of function arguments.</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.ku">vitality.ku</a></code></p>

<hr>
<h2 id='rainbow_trout_for_k'>Sample Rainbow Trout Data</h2><span id='topic+rainbow_trout_for_k'></span>

<h3>Description</h3>

<p>Sample survival data for rainbow trout. Columns include &quot;days&quot; and &quot;survival&quot; (cumulative survival proportion by day).
</p>


<h3>Format</h3>

<p>matrix</p>


<h3>Source</h3>

<p>http://cbr.washington.edu/analysis/vitality
</p>

<hr>
<h2 id='stdErr.4p'>Standard errors for 4-parameters: r, s, lambda, beta</h2><span id='topic+stdErr.4p'></span>

<h3>Description</h3>

<p>Gives the standard errors for the 4 parameter model. Primarily used within <code><a href="#topic+vitality.4p">vitality.4p</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stdErr.4p(r, s, k, u, x1, x2, Ni, pop)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stdErr.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="stdErr.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="stdErr.4p_+3A_k">k</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="stdErr.4p_+3A_u">u</code></td>
<td>
<p>beta value</p>
</td></tr>
<tr><td><code id="stdErr.4p_+3A_x1">x1</code></td>
<td>
<p>age 1 (corresponding 1:(t-1) and 2:t)</p>
</td></tr>
<tr><td><code id="stdErr.4p_+3A_x2">x2</code></td>
<td>
<p>age 2</p>
</td></tr>
<tr><td><code id="stdErr.4p_+3A_ni">Ni</code></td>
<td>
<p>survival fraction</p>
</td></tr>
<tr><td><code id="stdErr.4p_+3A_pop">pop</code></td>
<td>
<p>initial population (total population of the
study)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>standard error for r, s, lambda, beta
</p>


<h3>Note</h3>

<p>if k &lt;= 0, cannot find standard error for k</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.4p">vitality.4p</a></code></p>

<hr>
<h2 id='stdErr.6p'>Standard errors for 6-parameters: r, s, lambda, beta, gamma, alpha</h2><span id='topic+stdErr.6p'></span>

<h3>Description</h3>

<p>Gives the standard errors for the 6 parameter model. Primarily used within <code><a href="#topic+vitality.6p">vitality.6p</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stdErr.6p(r, s, k, u, g, a, x1, x2, Ni, pop)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stdErr.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="stdErr.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="stdErr.6p_+3A_k">k</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="stdErr.6p_+3A_u">u</code></td>
<td>
<p>beta value</p>
</td></tr>
<tr><td><code id="stdErr.6p_+3A_g">g</code></td>
<td>
<p>gamma value</p>
</td></tr>
<tr><td><code id="stdErr.6p_+3A_a">a</code></td>
<td>
<p>alpha value</p>
</td></tr>
<tr><td><code id="stdErr.6p_+3A_x1">x1</code></td>
<td>
<p>age 1 (corresponding 1:(t-1))</p>
</td></tr>
<tr><td><code id="stdErr.6p_+3A_x2">x2</code></td>
<td>
<p>age 2 (corresponding 2:t</p>
</td></tr>
<tr><td><code id="stdErr.6p_+3A_ni">Ni</code></td>
<td>
<p>age-specific survival fractions</p>
</td></tr>
<tr><td><code id="stdErr.6p_+3A_pop">pop</code></td>
<td>
<p>initial population (total population of the
study)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>standard error for r, s, lambda, beta, gamma, and alpha.
</p>


<h3>Note</h3>

<p>if k &lt;= 0, cannot find standard error for k</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.6p">vitality.6p</a></code></p>

<hr>
<h2 id='stdErr.k'>Standard errors for 3-parameters: r, s, k</h2><span id='topic+stdErr.k'></span>

<h3>Description</h3>

<p>Gives the standard errors for the 3 parameter model. Primarily used within <code><a href="#topic+vitality.k">vitality.k</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stdErr.k(r, s, k, x1, x2, Ni, pop)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stdErr.k_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="stdErr.k_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="stdErr.k_+3A_k">k</code></td>
<td>
<p>k value</p>
</td></tr>
<tr><td><code id="stdErr.k_+3A_x1">x1</code></td>
<td>
<p>age 1 (corresponding 1:(t-1))</p>
</td></tr>
<tr><td><code id="stdErr.k_+3A_x2">x2</code></td>
<td>
<p>age 2 (corresponding 2:t</p>
</td></tr>
<tr><td><code id="stdErr.k_+3A_ni">Ni</code></td>
<td>
<p>age-specific survival fractions</p>
</td></tr>
<tr><td><code id="stdErr.k_+3A_pop">pop</code></td>
<td>
<p>initial population (total population of the
study)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>standard error for r, s, k.
</p>


<h3>Note</h3>

<p>k is restricted to be &gt;0.</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.k">vitality.k</a></code></p>

<hr>
<h2 id='stdErr.ku'>Standard errors for 4-parameters: r, s, k, u</h2><span id='topic+stdErr.ku'></span>

<h3>Description</h3>

<p>Gives the standard errors for the 4 parameter model. Primarily used within <code><a href="#topic+vitality.ku">vitality.ku</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stdErr.ku(r, s, k, u, x1, x2, Ni, pop)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stdErr.ku_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="stdErr.ku_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="stdErr.ku_+3A_k">k</code></td>
<td>
<p>k value</p>
</td></tr>
<tr><td><code id="stdErr.ku_+3A_u">u</code></td>
<td>
<p>u value</p>
</td></tr>
<tr><td><code id="stdErr.ku_+3A_x1">x1</code></td>
<td>
<p>age 1 (corresponding 1:(t-1))</p>
</td></tr>
<tr><td><code id="stdErr.ku_+3A_x2">x2</code></td>
<td>
<p>age 2 (corresponding 2:t</p>
</td></tr>
<tr><td><code id="stdErr.ku_+3A_ni">Ni</code></td>
<td>
<p>age-specific survival fractions</p>
</td></tr>
<tr><td><code id="stdErr.ku_+3A_pop">pop</code></td>
<td>
<p>initial population (total population of the
study)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>standard error for r, s, k, u.
</p>


<h3>Note</h3>

<p>k is restricted to be &gt;0.</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.ku">vitality.ku</a></code></p>

<hr>
<h2 id='SurvFn.4p'>The cumulative survival distribution function for 2-process 4-parameter vitality model</h2><span id='topic+SurvFn.4p'></span>

<h3>Description</h3>

<p>Gives the cumulative survival proportions at <code>xx</code> from all processes for a given set of parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.4p(xx, r, s, lambda, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.4p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="SurvFn.4p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="SurvFn.4p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used within <code><a href="#topic+vitality.4p">vitality.4p</a></code> for estimating model parameters based on the observed cumulative survival function.</p>


<h3>Value</h3>

<p>vector of cumulative survival proportions at <code>xx</code> from all processes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.4p">vitality.4p</a></code>, <code><a href="#topic+survProbInc.4p">survProbInc.4p</a></code>, <code><a href="#topic+SurvFn.in.4p">SurvFn.in.4p</a></code>, <code><a href="#topic+SurvFn.ex.4p">SurvFn.ex.4p</a></code></p>

<hr>
<h2 id='SurvFn.6p'>The cumulative survival distribution function for 2-process 6-parameter vitality model</h2><span id='topic+SurvFn.6p'></span>

<h3>Description</h3>

<p>Gives the cumulative survival proportions at <code>xx</code> from all processes for a given set of parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.6p(xx, r, s, lambda, beta, gamma, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.6p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="SurvFn.6p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="SurvFn.6p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
<tr><td><code id="SurvFn.6p_+3A_gamma">gamma</code></td>
<td>
<p>gamma value</p>
</td></tr>
<tr><td><code id="SurvFn.6p_+3A_alpha">alpha</code></td>
<td>
<p>alpha value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used within <code><a href="#topic+vitality.6p">vitality.6p</a></code> for estimating model parameters based on the observed cumulative survival function.</p>


<h3>Value</h3>

<p>vector of cumulative survival proportions at <code>xx</code> from all processes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.6p">vitality.6p</a></code>, <code><a href="#topic+survProbInc.6p">survProbInc.6p</a></code>, <code><a href="#topic+SurvFn.in.6p">SurvFn.in.6p</a></code>, <code><a href="#topic+SurvFn.ex.6p">SurvFn.ex.6p</a></code></p>

<hr>
<h2 id='SurvFn.ex.4p'>The extrinsic cumulative survival distribution function for 2-process 4-parameter vitality model</h2><span id='topic+SurvFn.ex.4p'></span>

<h3>Description</h3>

<p>Gives the cumulative survival proportions at <code>xx</code> from extrinsic process for a given set of parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.ex.4p(xx, r, s, lambda, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.ex.4p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.ex.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.ex.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="SurvFn.ex.4p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="SurvFn.ex.4p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used within <code><a href="#topic+vitality.4p">vitality.4p</a></code> for estimating model parameters based on the observed cumulative survival function.</p>


<h3>Value</h3>

<p>vector of cumulative survival proportions at <code>xx</code> from extrinsic process
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.4p">vitality.4p</a></code>, <code><a href="#topic+survProbInc.4p">survProbInc.4p</a></code>, <code><a href="#topic+SurvFn.4p">SurvFn.4p</a></code>, <code><a href="#topic+SurvFn.in.4p">SurvFn.in.4p</a></code></p>

<hr>
<h2 id='SurvFn.ex.6p'>The extrinsic cumulative survival distribution function for 2-process 6-parameter vitality model</h2><span id='topic+SurvFn.ex.6p'></span>

<h3>Description</h3>

<p>Gives the cumulative survival proportions at <code>xx</code> from the extrinsic processes for a given set of parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.ex.6p(xx, r, s, lambda, beta, gamma, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.ex.6p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.ex.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.ex.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="SurvFn.ex.6p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="SurvFn.ex.6p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
<tr><td><code id="SurvFn.ex.6p_+3A_gamma">gamma</code></td>
<td>
<p>gamma value</p>
</td></tr>
<tr><td><code id="SurvFn.ex.6p_+3A_alpha">alpha</code></td>
<td>
<p>alpha value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used within <code><a href="#topic+vitality.6p">vitality.6p</a></code> for estimating model parameters based on the observed cumulative survival function.</p>


<h3>Value</h3>

<p>vector cumulative survival proportions at <code>xx</code> from extrinsic processes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.6p">vitality.6p</a></code>, <code><a href="#topic+survProbInc.6p">survProbInc.6p</a></code>, <code><a href="#topic+SurvFn.6p">SurvFn.6p</a></code></p>

<hr>
<h2 id='SurvFn.h.4p'>Intrinsic cumulative survival distribution for 4 parameter model</h2><span id='topic+SurvFn.h.4p'></span>

<h3>Description</h3>

<p>Gives the intrinsic cumulative survival distribution at <code>xx</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.h.4p(xx, r, s, u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.h.4p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.h.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.h.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="SurvFn.h.4p_+3A_u">u</code></td>
<td>
<p>u value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.4p">vitality.4p</a></code>.</p>


<h3>Value</h3>

<p>intrinsic cumulative survival distribution
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.4p">vitality.4p</a></code></p>

<hr>
<h2 id='SurvFn.h.6p'>Intrinsic cumulative survival distribution for 6 parameter model</h2><span id='topic+SurvFn.h.6p'></span>

<h3>Description</h3>

<p>Gives the intrinsic cumulative survival distribution at <code>xx</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.h.6p(xx, r, s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.h.6p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.h.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.h.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.6p">vitality.6p</a></code>.</p>


<h3>Value</h3>

<p>intrinsic cumulative survival distribution
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.6p">vitality.6p</a></code></p>

<hr>
<h2 id='SurvFn.in.4p'>The intrinsic cumulative survival distribution function for 2-process 4-parameter vitality model</h2><span id='topic+SurvFn.in.4p'></span>

<h3>Description</h3>

<p>Gives the cumulative survival proportions at <code>xx</code> from intrinsic process for a given set of parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.in.4p(xx, r, s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.in.4p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.in.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.in.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used within <code><a href="#topic+vitality.4p">vitality.4p</a></code> for estimating model parameters based on the observed cumulative survival function.</p>


<h3>Value</h3>

<p>vector of cumulative survival proportions at <code>xx</code> from intrinsic process
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.4p">vitality.4p</a></code>, <code><a href="#topic+survProbInc.4p">survProbInc.4p</a></code>, <code><a href="#topic+SurvFn.4p">SurvFn.4p</a></code>, , <code><a href="#topic+SurvFn.ex.4p">SurvFn.ex.4p</a></code></p>

<hr>
<h2 id='SurvFn.in.6p'>The intrinsic cumulative survival distribution function for 2-process 6-parameter vitality model</h2><span id='topic+SurvFn.in.6p'></span>

<h3>Description</h3>

<p>Gives the cumulative survival proportions at <code>xx</code> from the intrinsic process for a given set of parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.in.6p(xx, r, s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.in.6p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.in.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.in.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used within <code><a href="#topic+vitality.6p">vitality.6p</a></code> for estimating model parameters based on the observed cumulative survival function.</p>


<h3>Value</h3>

<p>vector of cumulative survival proportions at <code>xx</code> from intrinsic process
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.6p">vitality.6p</a></code>, <code><a href="#topic+survProbInc.6p">survProbInc.6p</a></code>, <code><a href="#topic+SurvFn.6p">SurvFn.6p</a></code></p>

<hr>
<h2 id='SurvFn.k'>The cumulative survival distribution function for 3-parameter vitality model</h2><span id='topic+SurvFn.k'></span>

<h3>Description</h3>

<p>Gives the cumulative survival proportions at <code>xx</code> for a given set of parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.k(xx, r, s, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.k_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.k_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.k_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="SurvFn.k_+3A_k">k</code></td>
<td>
<p>k value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used within <code><a href="#topic+vitality.k">vitality.k</a></code> for estimating model parameters based on the observed cumulative survival function.</p>


<h3>Value</h3>

<p>cumulative survival proportions at <code>xx</code>  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.k">vitality.k</a></code>, <code><a href="#topic+survProbInc.k">survProbInc.k</a></code></p>

<hr>
<h2 id='SurvFn.ku'>The cumulative survival distribution function for 4-parameter vitality model</h2><span id='topic+SurvFn.ku'></span>

<h3>Description</h3>

<p>Gives the cumulative survival proportions at <code>xx</code> for a given set of parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SurvFn.ku(xx, r, s, k, u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvFn.ku_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="SurvFn.ku_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="SurvFn.ku_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="SurvFn.ku_+3A_k">k</code></td>
<td>
<p>k value</p>
</td></tr>
<tr><td><code id="SurvFn.ku_+3A_u">u</code></td>
<td>
<p>u value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used within <code><a href="#topic+vitality.ku">vitality.ku</a></code> for estimating model parameters based on the observed cumulative survival function.</p>


<h3>Value</h3>

<p>cumulative survival proportions at <code>xx</code>  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.ku">vitality.ku</a></code>, <code><a href="#topic+survProbInc.ku">survProbInc.ku</a></code></p>

<hr>
<h2 id='survProbInc.4p'>Incremental survival probability for 2-process 4-parameter model</h2><span id='topic+survProbInc.4p'></span>

<h3>Description</h3>

<p>Calculates the incremental survival probabilities (between xx1 and xx2) for 2-process 4-parameter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  survProbInc.4p(r, s, lambda, beta, xx1, xx2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survProbInc.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="survProbInc.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="survProbInc.4p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="survProbInc.4p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
<tr><td><code id="survProbInc.4p_+3A_xx1">xx1</code></td>
<td>
<p>xx1 vector</p>
</td></tr>
<tr><td><code id="survProbInc.4p_+3A_xx2">xx2</code></td>
<td>
<p>xx2 vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.4p">vitality.4p</a></code>.</p>


<h3>Value</h3>

<p>incremental survival probabilities
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.4p">vitality.4p</a></code>, <code><a href="#topic+logLikelihood.4p">logLikelihood.4p</a></code></p>

<hr>
<h2 id='survProbInc.6p'>Incremental survival probability for 2-process 6-parameter model</h2><span id='topic+survProbInc.6p'></span>

<h3>Description</h3>

<p>Calculates the incremental survival probabilities (between xx1 and xx2) for 2-process 6-parameter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  survProbInc.6p(r, s, lambda, beta, gamma, alpha, xx1, xx2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survProbInc.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="survProbInc.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="survProbInc.6p_+3A_lambda">lambda</code></td>
<td>
<p>lambda value</p>
</td></tr>
<tr><td><code id="survProbInc.6p_+3A_beta">beta</code></td>
<td>
<p>beta value</p>
</td></tr>
<tr><td><code id="survProbInc.6p_+3A_gamma">gamma</code></td>
<td>
<p>gamma value</p>
</td></tr>
<tr><td><code id="survProbInc.6p_+3A_alpha">alpha</code></td>
<td>
<p>alpha value</p>
</td></tr>
<tr><td><code id="survProbInc.6p_+3A_xx1">xx1</code></td>
<td>
<p>xx1 vector</p>
</td></tr>
<tr><td><code id="survProbInc.6p_+3A_xx2">xx2</code></td>
<td>
<p>xx2 vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.6p">vitality.6p</a></code>.</p>


<h3>Value</h3>

<p>incremental survival probabilities
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.6p">vitality.6p</a></code>, <code><a href="#topic+logLikelihood.6p">logLikelihood.6p</a></code></p>

<hr>
<h2 id='survProbInc.k'>Incremental survival probability for 3-parameter model</h2><span id='topic+survProbInc.k'></span>

<h3>Description</h3>

<p>Calculates the incremental survival probabilities (between xx1 and xx2) for 3-parameter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  survProbInc.k(r, s, k, xx1, xx2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survProbInc.k_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="survProbInc.k_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="survProbInc.k_+3A_k">k</code></td>
<td>
<p>k value</p>
</td></tr>
<tr><td><code id="survProbInc.k_+3A_xx1">xx1</code></td>
<td>
<p>xx1 vector</p>
</td></tr>
<tr><td><code id="survProbInc.k_+3A_xx2">xx2</code></td>
<td>
<p>xx2 vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.k">vitality.k</a></code>.</p>


<h3>Value</h3>

<p>incremental survival probabilities
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.k">vitality.k</a></code>, <code><a href="#topic+logLikelihood.k">logLikelihood.k</a></code></p>

<hr>
<h2 id='survProbInc.ku'>Incremental survival probability for 4-parameter model</h2><span id='topic+survProbInc.ku'></span>

<h3>Description</h3>

<p>Calculates the incremental survival probabilities (between xx1 and xx2) for 4-parameter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  survProbInc.ku(r, s, k, u, xx1, xx2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survProbInc.ku_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="survProbInc.ku_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="survProbInc.ku_+3A_k">k</code></td>
<td>
<p>k value</p>
</td></tr>
<tr><td><code id="survProbInc.ku_+3A_u">u</code></td>
<td>
<p>u value</p>
</td></tr>
<tr><td><code id="survProbInc.ku_+3A_xx1">xx1</code></td>
<td>
<p>xx1 vector</p>
</td></tr>
<tr><td><code id="survProbInc.ku_+3A_xx2">xx2</code></td>
<td>
<p>xx2 vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code><a href="#topic+vitality.ku">vitality.ku</a></code>.</p>


<h3>Value</h3>

<p>incremental survival probabilities
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vitality.ku">vitality.ku</a></code>, <code><a href="#topic+logLikelihood.ku">logLikelihood.ku</a></code></p>

<hr>
<h2 id='swedish_females'>Swedish Female Mortality Data</h2><span id='topic+swedish_females'></span>

<h3>Description</h3>

<p>Period life table for Swedish females in the year 2000. 
Columns follow standard life-table naming conventions.
</p>


<h3>Format</h3>

<p>A <code>data.frame</code> object</p>


<h3>Source</h3>

<p>Human Mortality Database
</p>

<hr>
<h2 id='vft.4p'>Vectorized density function</h2><span id='topic+vft.4p'></span>

<h3>Description</h3>

<p>This function is used in the calculation of the fitted intrinsic (<code><a href="#topic+mu.vd1.4p">mu.vd1.4p</a></code>) and total (<code><a href="#topic+mu.vd.4p">mu.vd.4p</a></code>) mortality rate in the 4-parameter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  vft.4p(xx, r, s, u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vft.4p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="vft.4p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="vft.4p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
<tr><td><code id="vft.4p_+3A_u">u</code></td>
<td>
<p>u value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of densities
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ft.4p">ft.4p</a></code></p>

<hr>
<h2 id='vft.6p'>Vectorized density function</h2><span id='topic+vft.6p'></span>

<h3>Description</h3>

<p>This function is used in the calculation of the fitted intrinsic (<code><a href="#topic+mu.vd1.6p">mu.vd1.6p</a></code>) and total (<code><a href="#topic+mu.vd.6p">mu.vd.6p</a></code>) mortality rate in the 6-parameter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  vft.6p(xx, r, s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vft.6p_+3A_xx">xx</code></td>
<td>
<p>vector of ages</p>
</td></tr>
<tr><td><code id="vft.6p_+3A_r">r</code></td>
<td>
<p>r value</p>
</td></tr>
<tr><td><code id="vft.6p_+3A_s">s</code></td>
<td>
<p>s value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of densities
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ft.6p">ft.6p</a></code></p>

<hr>
<h2 id='vitality.4p'>Fitting routine for the 2-process, 4-parameter vitality model (no childhood hook).</h2><span id='topic+vitality.4p'></span>

<h3>Description</h3>

<p>This function provides the fitting routine for the 4-parameter 2-process vitality model. Intrinsic mortality is characterized by the mean (r) and variability (s) in the vitality loss rate. Extrinsic mortality is characterized by random challenges of frequency (lambda) and random magnitude (beta) exceeding the remaining average vitality. Model is appropriate to adult human mortality data (e.g. Li and Anderson 2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  vitality.4p(time = 0:(length(sdata)-1), sdata, init.params = FALSE, 
    lower = c(0, 0, 0, 0), upper = c(100,50,100,50),rc.data = FALSE, 
    se = FALSE, datatype = c("CUM", "INC"), ttol = 1e-06, pplot = TRUE,
    Iplot = FALSE, Mplot = FALSE, tlab = "years", silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vitality.4p_+3A_time">time</code></td>
<td>
<p>Vector. Time component of data: Defaults to
<code>0:(length(sdata)-1)</code>.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_sdata">sdata</code></td>
<td>
<p>Required. Survival or mortality data.  The
default expects cumulative survival fraction.  If
providing incremental mortality fraction instead, use
option: datatype = &quot;INC&quot;.  The default also expects the
data to represent full mortality.  Otherwise, use option:
rc.data = T to indicate right censored data. If first element of <code>sdata</code>
&lt;1 data will be rescaled.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_rc.data">rc.data</code></td>
<td>
<p>Optional, Boolean. Specifies Right
Censored data.  If the data does not represent full
mortality, it is probably right censored.  The default is
rc.data = F.  A third option is rc.data = &quot;TF&quot;.  Use this
case to add a near-term zero survival point to data which
displays nearly full mortality ( &lt;.01 survival at end).
If rc.data = F but the data does not show full mortality,
rc.data = &quot;TF&quot; will be invoked automatically.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_se">se</code></td>
<td>
<p>Optional, Boolean. Calculates the standard
errors for the MLE parameters.  Default is FALSE. Set
equal to the initial study population to compute standard
errors.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_datatype">datatype</code></td>
<td>
<p>Optional. Defaults to <code>"CUM"</code> for
cumulative survival fraction data.  Use <code>"INC"</code> -
for incremental mortality fraction data.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_ttol">ttol</code></td>
<td>
<p>Optional. Stopping criteria tolerance.
Default is 1e-6.  Specify as ttol = .0001. If one of the
likelihood plots (esp. for &quot;k&quot;) does not look optimal, try
decreasing ttol.  If the program crashes, try increasing
ttol.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_init.params">init.params</code></td>
<td>
<p>Optional. Please specify the initial
param values.  
specify <code>init.params =</code> <code>c(r, s, lambda, beta)</code> in that order (e.g.. init.params = c(.1,
.02, .3, 0.12)).</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_lower">lower</code></td>
<td>
<p>vector of lower parameter bounds in order of <code>c(r, s,
  lambda, beta)</code>. see <code><a href="stats.html#topic+nlminb">nlminb</a></code></p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_upper">upper</code></td>
<td>
<p>vector of upper parameter bounds in order of <code>c(r, s,
  lambda, beta)</code>. see <code><a href="stats.html#topic+nlminb">nlminb</a></code></p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_pplot">pplot</code></td>
<td>
<p>Optional, Boolean. Plots of cumulative
survival for both data and fitted curves?  Default
<code>TRUE</code>. <code>FALSE</code> Produce no plots. A A third
option: <code>pplot = n</code> (n &gt;= 1) extends the time axis
of the fitting plots (beyond the max time in data).  For
example: <code>pplot = 1.2</code> extends the time axis by 20
Note: the incremental mortality plot is a continuous
representation of the appropriately- binned histogram of
incremental mortalities.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_iplot">Iplot</code></td>
<td>
<p>Optional, Boolean. Incremental mortality for
both data and fitted curves?  Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_mplot">Mplot</code></td>
<td>
<p>Optional, Boolean. Plot fitted mortality
curve? Default is <code>FALSE</code>. If <code>TRUE</code> 'observed' mortality rates for plotting are approximate and estimated from the input survival data. Depending on time (ages) and the change in mortality over age, these may be unrealistic but the fitted lines are derived from the parameter estimates themselves. For human data, the approximated mortality rates diverge at ages &gt;80. <code>pplot</code> must be set to TRUE and <code>Iplot=FALSE</code>.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_tlab">tlab</code></td>
<td>
<p>Optional, character. specifies units for
x-axis of plots.  Default is &quot;days&quot;.</p>
</td></tr>
<tr><td><code id="vitality.4p_+3A_silent">silent</code></td>
<td>
<p>Optional, Boolean. Stops all print and plot
options (still get most warning and all error messages)
Default is <code>FALSE</code>.  A third option,
<code>"verbose"</code> also enables the trace setting in the ms
(minimum sum) S-Plus routine.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of final MLE r, s, lambda, beta parameter estimates.
standard errors of MLE parameter estimates (if se = &lt;population&gt; is specified).
</p>


<h3>References</h3>

<p>D.H. Salinger, J.J. Anderson and O. Hamel (2003). &quot;A parameter fitting routine for the
vitality based survival model.&quot; Ecological Modeling
166(3): 287&ndash;294.
</p>
<p>Li, T. and J.J. Anderson (2013).
&quot;Shaping human mortality patterns through intrinsic and
extrinsic vitality processes.&quot;  Demographic Research 28(12): 341-372.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swedish_females)
swe &lt;- swedish_females
initial_age &lt;- 20 # Could be adjusted
time &lt;- initial_age:max(swedish_females$age)
survival_fraction &lt;- swe$lx / swe$lx[1]
survival_fraction &lt;- survival_fraction[time] # when first element &lt;1 data is adjusted
sample_size &lt;- swe$Lx[initial_age] #sample size

results.4par &lt;- vitality.4p(time = time,
                            sdata = survival_fraction,
                            #init.params=FALSE,
                            init.params=c(0.012, 0.01, 0.1, 0.1),
                            lower = c(0, 0, 0, 0), upper = c(100,50,1,50),
                            rc.data = TRUE, 
                            se = sample_size, 
                            datatype = "CUM", 
                            ttol = 1e-06,
                            pplot = TRUE,
                            Iplot = TRUE,
                            Mplot = TRUE,
                            tlab = "years",
                            silent = FALSE)
</code></pre>

<hr>
<h2 id='vitality.6p'>Fitting routine for the 2-process, 6-parameter vitality model (with childhood hook).</h2><span id='topic+vitality.6p'></span>

<h3>Description</h3>

<p>This function provides the fitting routine for the 6-parameter 2-process vitality model. Intrinsic mortality is characterized by the mean (r) and variability (s) in the vitality loss rate. Adult extrinsic mortality is characterized by random challenges of frequency (lambda) and random magnitude (beta) exceeding the remaining average vitality. Child extrinsic mortality is characterized by childhood challenges of frequency (gamma) exceeding childhood vitality development rate (alpha). Model is appropriate to full lifespan of human mortality data (e.g. Anderson and Li 2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  vitality.6p(time = 0:(length(sdata)-1), sdata, init.params = FALSE, 
    lower = c(0, 0, 0, 0, 0, 0),upper = c(100,50,100,50,50,10), rc.data = FALSE, 
    se = FALSE, datatype = c("CUM", "INC"), ttol = 1e-06, pplot = TRUE,
    Iplot = FALSE, Mplot = FALSE, tlab = "years", silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vitality.6p_+3A_time">time</code></td>
<td>
<p>Vector. Time component of data: Defaults to
<code>0:(length(sdata)-1)</code>. Typically this refers to ages.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_sdata">sdata</code></td>
<td>
<p>Required. Survival or mortality data.  The
default expects cumulative survival fraction.  If
providing incremental mortality fraction instead, use
option: datatype = &quot;INC&quot;. The default also expects the data to represent full mortality. 
Otherwise, use option: rc.data = T to indicate right censored data.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_rc.data">rc.data</code></td>
<td>
<p>Optional, Boolean. Specifies Right
Censored data.  If the data does not represent full
mortality, it is probably right censored.  The default is
rc.data = F.  A third option is rc.data = &quot;TF&quot;.  Use this
case to add a near-term zero survival point to data which
displays nearly full mortality ( &lt;.01 survival at end).
If rc.data = F but the data does not show full mortality,
rc.data = &quot;TF&quot; will be invoked automatically.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_se">se</code></td>
<td>
<p>Optional, Boolean. Calculates the standard
errors for the MLE parameters.  Default is FALSE. Set
equal to the initial study population to compute standard
errors.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_datatype">datatype</code></td>
<td>
<p>Optional. Defaults to <code>"CUM"</code> for
cumulative survival fraction data.  Use <code>"INC"</code> -
for incremental mortality fraction data.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_ttol">ttol</code></td>
<td>
<p>Optional. Stopping criteria tolerance.
Default is 1e-6.  Specify as ttol = .0001. If one of the
likelihood plots (esp. for &quot;k&quot;) does not look optimal, try
decreasing ttol.  If the program crashes, try increasing
ttol.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_init.params">init.params</code></td>
<td>
<p>Optional. Please specify the initial
param values.  specify <code>init.params =</code> <code>c(r, s,
  lambda, beta, gamma, alpha)</code> in that order (e.g.. init.params = c(.1,
.02, .3, 0.12, 0.1, 1)).</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_lower">lower</code></td>
<td>
<p>vector of lower parameter bounds in order of <code>c(r, s,
  lambda, beta, gamma, alpha)</code>. see <code><a href="stats.html#topic+nlminb">nlminb</a></code></p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_upper">upper</code></td>
<td>
<p>vector of upper parameter bounds in order of <code>c(r, s,
  lambda, beta, gamma, alpha)</code>. see <code><a href="stats.html#topic+nlminb">nlminb</a></code></p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_pplot">pplot</code></td>
<td>
<p>Optional, Boolean. Plots of cumulative
survival for both data and fitted curves?  Default:
<code>TRUE</code>. <code>FALSE</code> produces no plots. A third
option: <code>pplot = n</code> (n &gt;= 1) extends the time axis
of the fitting plots (beyond the max time in data).  For
example: <code>pplot = 1.2</code> extends the time axis by 20
Note: the incremental mortality plot is a continuous
representation of the appropriately binned histogram of
incremental mortalities.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_iplot">Iplot</code></td>
<td>
<p>Optional, Boolean. Incremental mortality for
both data and fitted curves?  Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_mplot">Mplot</code></td>
<td>
<p>Optional, Boolean. Plot fitted total, intrinsic, extrinsic (child), and extrinsic (adult) mortality
curves? Default: <code>FALSE</code>. If <code>TRUE</code> 'observed' mortality rates for plotting are approximate and estimated from the input survival data. Depending on time (ages) and the change in mortality over age, the approximated, plotted mortality rates may be inaccurate (e.g. For human mortality data, mortality rates at the oldest ages are underestimated because nax is assumed to be half the length of the age interval but the true nax is likely larger). This caveat applies only to the plotted mortality rates (black circles in plot). The plotted, fitted lines are calculated with the parameter estimates themselves and are unaffected by the estimation of the mortality rates for this plot. <code>pplot</code> must be set to TRUE and <code>Iplot=FALSE</code>.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_tlab">tlab</code></td>
<td>
<p>Optional, character. specifies units for
x-axis of plots.  Default is &quot;years&quot;.</p>
</td></tr>
<tr><td><code id="vitality.6p_+3A_silent">silent</code></td>
<td>
<p>Optional, Boolean. Stops all print and plot
options (still get most warning and all error messages)
Default is <code>FALSE</code>.  A third option,
<code>"verbose"</code> also enables the trace setting in the ms
(minimum sum) S-Plus routine.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of final MLE r, s, lambda, beta, gamma and
alpha parameter estimates.  standard errors of MLE
parameter estimates (if se = &lt;population&gt; is specified).
</p>


<h3>References</h3>

<p>D.H. Salinger, J.J. Anderson and O. Hamel (2003). &quot;A parameter fitting routine for the
vitality based survival model.&quot; Ecological Modeling
166(3): 287&ndash;294.
</p>
<p>Anderson, J.J. and T. Li. (2015). &quot;A two-process mortality model with extensions 
to juvenile mortality, populations and evolution.&quot; Population Association of America Annual Meeting 2015 <a href="http://paa2015.princeton.edu/abstracts/153144">http://paa2015.princeton.edu/abstracts/153144</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swedish_females)
swe &lt;- swedish_females
initial_age &lt;- 0 
time &lt;- swedish_females$age
survival_fraction &lt;- swe$lx / swe$lx[1]
sample_size &lt;- swe$Lx[1] #sample size

results.6par &lt;- vitality.6p(time = time,
                            sdata = survival_fraction,
                            #init.params=FALSE,
                            init.params=c(0.012, 0.01, 0.1, 0.1, 0.1, 1),
                            lower = c(0, 0, 0, 0, 0, 0), upper = c(100,50,1,50,50,50),
                            rc.data = TRUE, 
                            se=FALSE,
                            #se = sample_size, 
                            datatype = "CUM", 
                            ttol = 1e-06,
                            pplot = TRUE,
                            Iplot = TRUE,
                            Mplot = TRUE,
                            tlab = "years",
                            silent = FALSE)
</code></pre>

<hr>
<h2 id='vitality.k'>Fitting routine for the 3-parameter vitality model.</h2><span id='topic+vitality.k'></span>

<h3>Description</h3>

<p>This function provides the fitting routine for the 3-parameter vitality model. Intrinsic mortality is characterized by the mean (r) and variability (s) in vitality loss rate. Extrinsic mortality is characterized by the frequency (k) of lethal random challenges. Model is appropriate to animal mortality data (e.g. Anderson 2000).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vitality.k(time, sdata, rc.data=F, se=F, gfit=F, datatype="CUM", ttol=.000001, 
    init.params=F, lower=c(0,-1,0), upper=c(100,50,50), pplot=T, tlab="days", 
    lplot=F, cplot=F, Iplot=F, silent=F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vitality.k_+3A_time">time</code></td>
<td>
<p>Vector. Time component of data: Defaults to
<code>0:(length(sdata)-1)</code>. Typically this refers to ages.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_sdata">sdata</code></td>
<td>
<p>Required. Survival or mortality data.  The
default expects cumulative survival fraction.  If
providing incremental mortality fraction instead, use
option: datatype = &quot;INC&quot;. The default also expects the data to represent full mortality. 
Otherwise, use option: rc.data = T to indicate right censored data.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_rc.data">rc.data</code></td>
<td>
<p>Optional, Boolean. Specifies Right
Censored data.  If the data does not represent full
mortality, it is probably right censored.  The default is
rc.data = F.  A third option is rc.data = &quot;TF&quot;.  Use this
case to add a near-term zero survival point to data which
displays nearly full mortality ( &lt;.01 survival at end).
If rc.data = F but the data does not show full mortality,
rc.data = &quot;TF&quot; will be invoked automatically.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_se">se</code></td>
<td>
<p>Optional, Boolean. Calculates the standard
errors for the MLE parameters.  Default is FALSE. Set
equal to the initial study population to compute standard
errors.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_datatype">datatype</code></td>
<td>
<p>Optional. Defaults to <code>"CUM"</code> for
cumulative survival fraction data.  Use <code>"INC"</code> -
for incremental mortality fraction data.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_ttol">ttol</code></td>
<td>
<p>Optional. Stopping criteria tolerance.
Default is 1e-6.  Specify as ttol = .0001. If one of the
likelihood plots (esp. for &quot;k&quot;) does not look optimal, try
decreasing ttol.  If the program crashes, try increasing
ttol.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_init.params">init.params</code></td>
<td>
<p>Optional. Please specify the initial
param values.  specify <code>init.params =</code> <code>c(r, s,
  k)</code> in that order (e.g.. init.params = c(.1,
.02, .3)).</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_lower">lower</code></td>
<td>
<p>vector of lower parameter bounds in order of <code>c(r, s,
  k)</code>. see <code><a href="stats.html#topic+nlminb">nlminb</a></code></p>
</td></tr>
<tr><td><code id="vitality.k_+3A_upper">upper</code></td>
<td>
<p>vector of upper parameter bounds in order of <code>c(r, s,
  k)</code>. see <code><a href="stats.html#topic+nlminb">nlminb</a></code></p>
</td></tr>
<tr><td><code id="vitality.k_+3A_pplot">pplot</code></td>
<td>
<p>Optional, Boolean. Plots of cumulative
survival for both data and fitted curves?  Default:
<code>TRUE</code>. <code>FALSE</code> produces no plots.Note: the incremental mortality plot is a continuous
representation of the appropriately binned histogram of
incremental mortalities.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_iplot">Iplot</code></td>
<td>
<p>Boolean. Plot incremental survival? Must have <code>pplot=TRUE</code></p>
</td></tr>
<tr><td><code id="vitality.k_+3A_lplot">lplot</code></td>
<td>
<p>Boolean. Plot likelihood functions? Provides likelihood function plotting. Defaults to <code>FALSE</code>. Note:  these plots are not &quot;likelihood profiles&quot; in that while one parameter is varied, the others are held fixed, rather than re-optimized. (must also have <code>pplot=T</code> and <code>Iplot=F</code>.)</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_cplot">cplot</code></td>
<td>
<p>Boolean. Plot likelihood contour plot? Provides a likelihood contour plot for a range of r and s values (can be slow so default is <code>FALSE</code>). Must also have <code>lplot=T</code> and <code>pplot=T</code> to get contour plots.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_tlab">tlab</code></td>
<td>
<p>Character, label for time axis. Defaults to &quot;days&quot;.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_gfit">gfit</code></td>
<td>
<p>Provides a Pearson C type test for goodness of fit. Default is <code>FALSE</code>. Must provide the initial study population to compute goodness of fit.</p>
</td></tr>
<tr><td><code id="vitality.k_+3A_silent">silent</code></td>
<td>
<p>Optional, Boolean. Stops all print and plot
options (still get most warning and all error messages)
Default is <code>FALSE</code>.  A third option, <code>"verbose"</code> 
also enables the trace setting in the ms
(minimum sum) S-Plus routine.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of final MLE r, s, k parameter estimates.  standard errors of MLE
parameter estimates (if se = &lt;population&gt; is specified).
</p>


<h3>References</h3>


<ul>
<li><p> Anderson, J.J. (2000). &quot;A vitality-based model relating stressors and environmental properties to organism survival.&quot; Ecological Monographs 70(3):445-470.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(daphnia)
time &lt;- daphnia$days
survival_fraction &lt;- daphnia$lx

results.modk &lt;- vitality.k(time = time,
                           sdata = survival_fraction,
                           rc.data=TRUE, 
                           se=FALSE,
                           gfit=FALSE, 
                           datatype="CUM", 
                           ttol=.000001, 
                           init.params=FALSE,
                           #init.params=c(0.075, 0.15, 0.001),
                           lower=c(0,-1,0), upper=c(100,50,50), 
                           pplot=TRUE, 
                           tlab="days", 
                           lplot=TRUE, 
                           cplot=TRUE, 
                           Iplot=TRUE, 
                           silent=FALSE)
</code></pre>

<hr>
<h2 id='vitality.ku'>Fitting routine for the 4-parameter vitality model.</h2><span id='topic+vitality.ku'></span>

<h3>Description</h3>

<p>This function provides the fitting routine for the 4-parameter vitality model. Intrinsic mortality is characterized by the mean (r) and variability (s) in the vitality loss rate and the standard deviation of initial vitality (u). Extrinsic mortality is characterized by the frequency (k) of lethal random challenges. Model is appropriate to animal mortality data (e.g. Li and Anderson 2009)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vitality.ku(time, sdata, rc.data=F, se=F, gfit=F, datatype="CUM", ttol=.000001, 
  init.params=F, lower=c(0,-1,0,0), upper=c(100,100,50,50), pplot=T, tlab="days", 
  lplot=F, cplot=F, Iplot=F, silent=F, L=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vitality.ku_+3A_time">time</code></td>
<td>
<p>Vector. Time component of data. Typically this refers to ages.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_sdata">sdata</code></td>
<td>
<p>Required. Survival or mortality data.  The
default expects cumulative survival fraction.  If
providing incremental mortality fraction instead, use
option: datatype = &quot;INC&quot;. The default also expects the data to represent full mortality. 
Otherwise, use option: rc.data = T to indicate right censored data.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_rc.data">rc.data</code></td>
<td>
<p>Optional, Boolean. Specifies Right
Censored data.  If the data does not represent full
mortality, it is probably right censored.  The default is
rc.data = F.  A third option is rc.data = &quot;TF&quot;.  Use this
case to add a near-term zero survival point to data which
displays nearly full mortality ( &lt;.01 survival at end).
If rc.data = F but the data does not show full mortality,
rc.data = &quot;TF&quot; will be invoked automatically.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_se">se</code></td>
<td>
<p>Optional, Boolean. Calculates the standard
errors for the MLE parameters.  Default is FALSE. Set
equal to the initial study population to compute standard
errors.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_datatype">datatype</code></td>
<td>
<p>Optional. Defaults to <code>"CUM"</code> for
cumulative survival fraction data.  Use <code>"INC"</code> -
for incremental mortality fraction data.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_ttol">ttol</code></td>
<td>
<p>Optional. Stopping criteria tolerance.
Default is 1e-6.  Specify as ttol = .0001. If one of the
likelihood plots (esp. for &quot;k&quot;) does not look optimal, try
decreasing ttol.  If the program crashes, try increasing
ttol.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_init.params">init.params</code></td>
<td>
<p>Optional. Please specify the initial
param values.  specify <code>init.params =</code> <code>c(r, s,
  k, u)</code> in that order (e.g.. init.params = c(.1,
.02, .3, .25)).</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_lower">lower</code></td>
<td>
<p>vector of lower parameter bounds in order of <code>c(r, s,
  k, u)</code>. see <code><a href="stats.html#topic+nlminb">nlminb</a></code></p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_upper">upper</code></td>
<td>
<p>vector of upper parameter bounds in order of <code>c(r, s,
  k, u)</code>. see <code><a href="stats.html#topic+nlminb">nlminb</a></code></p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_pplot">pplot</code></td>
<td>
<p>Optional, Boolean. Plots of cumulative
survival for both data and fitted curves?  Default:
<code>TRUE</code>. <code>FALSE</code> produces no plots. Note: the incremental mortality plot is a continuous
representation of the appropriately binned histogram of
incremental mortalities.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_iplot">Iplot</code></td>
<td>
<p>Boolean. Plot incremental survival?</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_lplot">lplot</code></td>
<td>
<p>Boolean. Plot likelihood functions? Provides likelihood function plotting. Defaults to <code>FALSE</code>. Note:  these plots are not &quot;likelihood profiles&quot; in that while one parameter is varied, the others are held fixed, rather than re-optimized. (must also have pplot=T.)</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_cplot">cplot</code></td>
<td>
<p>Boolean. Plot likelihood contour plot? Provides a likelihood contour plot for a range of parameter values (can be slow so default is <code>FALSE</code>). Must also have <code>lplot=T</code> and <code>pplot=T</code> to get contour plots.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_tlab">tlab</code></td>
<td>
<p>Character, label for time axis. Defaults to &quot;days&quot;.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_gfit">gfit</code></td>
<td>
<p>Provides a Pearson C type test for goodness of fit. Default is <code>FALSE</code>. Must provide the initial study population to compute goodness of fit.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_silent">silent</code></td>
<td>
<p>Optional, Boolean. Stops all print and plot
options (still get most warning and all error messages)
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="vitality.ku_+3A_l">L</code></td>
<td>
<p>Number of times of running simulated annealing. Default is 0, use Newton-Ralphson method only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of final MLE r, s, k, u parameter estimates.  standard errors of MLE
parameter estimates (if se = &lt;population&gt; is specified).
</p>


<h3>References</h3>


<ul>
<li><p> Li, T. and J.J. Anderson. (2009). &quot;The vitality model: A way to understand population survival and demographic heterogeneity.&quot; Theoretical Population Biology 76: 118-131.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(rainbow_trout_for_k)
time &lt;- rainbow_trout_for_k$days
survival_fraction &lt;- rainbow_trout_for_k$survival

results.modku &lt;- vitality.ku(time = time,
                             sdata = survival_fraction,
                             rc.data=TRUE,
                             se=FALSE,
                             gfit=FALSE,
                             datatype="CUM",
                             ttol=.000001,
                             init.params=FALSE,
                             lower=c(0,-1,0,0),upper=c(100,100,50,50),
                             pplot=TRUE,
                             tlab="days",
                             lplot=TRUE,
                             cplot=TRUE,
                             Iplot=TRUE,
                             silent=FALSE,
                             L=0)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
