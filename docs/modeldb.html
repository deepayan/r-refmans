<!DOCTYPE html><html lang="en"><head><title>Help for package modeldb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {modeldb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#modeldb-package'><p>modeldb: Fits Models Inside the Database</p></a></li>
<li><a href='#add_dummy_variables'><p>Creates dummy variables</p></a></li>
<li><a href='#as_parsed_model.modeldb_lm'><p>Prepares parsed model object</p></a></li>
<li><a href='#linear_regression_db'><p>Fits a Linear Regression model</p></a></li>
<li><a href='#plot_kmeans'><p>Visualize a KMeans Cluster with lots of data</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#simple_kmeans_db'><p>Simple kmeans routine that works in-database</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Fits Models Inside the Database</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Uses 'dplyr' and 'tidyeval' to fit statistical models inside
    the database. It currently supports KMeans and linear regression
    models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://modeldb.tidymodels.org">https://modeldb.tidymodels.org</a>,
<a href="https://github.com/tidymodels/modeldb">https://github.com/tidymodels/modeldb</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tidymodels/modeldb/issues">https://github.com/tidymodels/modeldb/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, dplyr (&ge; 0.7), ggplot2, progress, purrr, rlang (&ge;
1.1.1), tibble, tidypredict</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, DBI, dbplyr, knitr, methods, nycflights13, rmarkdown,
RSQLite, testthat (&ge; 3.2.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-31 23:10:27 UTC; max</td>
</tr>
<tr>
<td>Author:</td>
<td>Edgar Ruiz [aut],
  Max Kuhn [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Max Kuhn &lt;max@posit.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-01 14:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='modeldb-package'>modeldb: Fits Models Inside the Database</h2><span id='topic+modeldb'></span><span id='topic+modeldb-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Uses 'dplyr' and 'tidyeval' to fit statistical models inside the database. It currently supports KMeans and linear regression models.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Max Kuhn <a href="mailto:max@posit.co">max@posit.co</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://modeldb.tidymodels.org">https://modeldb.tidymodels.org</a>
</p>
</li>
<li> <p><a href="https://github.com/tidymodels/modeldb">https://github.com/tidymodels/modeldb</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/tidymodels/modeldb/issues">https://github.com/tidymodels/modeldb/issues</a>
</p>
</li></ul>


<hr>
<h2 id='add_dummy_variables'>Creates dummy variables</h2><span id='topic+add_dummy_variables'></span>

<h3>Description</h3>

<p>It uses 'tidyeval' and 'dplyr' to create dummy variables based for
categorical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_dummy_variables(
  df,
  x,
  values = c(),
  auto_values = FALSE,
  remove_original = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_dummy_variables_+3A_df">df</code></td>
<td>
<p>A Local or remote data frame</p>
</td></tr>
<tr><td><code id="add_dummy_variables_+3A_x">x</code></td>
<td>
<p>Categorical variable</p>
</td></tr>
<tr><td><code id="add_dummy_variables_+3A_values">values</code></td>
<td>
<p>Possible known values of the categorical variable. If not passed
then the function will take an additional step to figure the unique values of
the variable.</p>
</td></tr>
<tr><td><code id="add_dummy_variables_+3A_auto_values">auto_values</code></td>
<td>
<p>Safeguard argument to prevent the function from figuring the
unique values if the values argument is empty.  If it is ok for this function
to obtain the unique values, set to TRUE.  Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="add_dummy_variables_+3A_remove_original">remove_original</code></td>
<td>
<p>It removes the original variable from the returned table.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

mtcars %&gt;%
  add_dummy_variables(cyl, values = c(4, 6, 8))

mtcars %&gt;%
  add_dummy_variables(cyl, auto_values = TRUE)
</code></pre>

<hr>
<h2 id='as_parsed_model.modeldb_lm'>Prepares parsed model object</h2><span id='topic+as_parsed_model.modeldb_lm'></span>

<h3>Description</h3>

<p>Prepares parsed model object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'modeldb_lm'
as_parsed_model(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_parsed_model.modeldb_lm_+3A_x">x</code></td>
<td>
<p>A parsed model object</p>
</td></tr>
</table>

<hr>
<h2 id='linear_regression_db'>Fits a Linear Regression model</h2><span id='topic+linear_regression_db'></span>

<h3>Description</h3>

<p>It uses 'tidyeval' and 'dplyr' to create a linear
regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linear_regression_db(df, y_var = NULL, sample_size = NULL, auto_count = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linear_regression_db_+3A_df">df</code></td>
<td>
<p>A Local or remote data frame</p>
</td></tr>
<tr><td><code id="linear_regression_db_+3A_y_var">y_var</code></td>
<td>
<p>Dependent variable</p>
</td></tr>
<tr><td><code id="linear_regression_db_+3A_sample_size">sample_size</code></td>
<td>
<p>Prevents a table count. It is only used for models
with three or more independent variables</p>
</td></tr>
<tr><td><code id="linear_regression_db_+3A_auto_count">auto_count</code></td>
<td>
<p>Serves as a safeguard in case sample_size is not
passed inadvertently.  Defaults to FALSE.  If it is ok for the
function to count how many records are in the sample, then set to
TRUE.  It is only used for models with three or more independent variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linear_regression_db() function only calls one of three unexported functions.
The function used is determined by the number of independent variables.  This is
so any model of one or two variables can use a simpler formula, which in turn
will have less SQL overhead.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

mtcars %&gt;%
  select(mpg, wt, qsec) %&gt;%
  linear_regression_db(mpg)

</code></pre>

<hr>
<h2 id='plot_kmeans'>Visualize a KMeans Cluster with lots of data</h2><span id='topic+plot_kmeans'></span><span id='topic+db_calculate_squares'></span>

<h3>Description</h3>

<p>It uses 'ggplot2' to display the results of a KMeans routine. Instead
of a scatterplot, it uses a square grid that displays the concentration
of intersections per square.  The number of squares in the grid can
be customized for more or less fine grain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_kmeans(df, x, y, resolution = 50, group = center)

db_calculate_squares(df, x, y, group, resolution = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_kmeans_+3A_df">df</code></td>
<td>
<p>A Local or remote data frame with results of KMeans clustering</p>
</td></tr>
<tr><td><code id="plot_kmeans_+3A_x">x</code></td>
<td>
<p>A numeric variable for the x axis</p>
</td></tr>
<tr><td><code id="plot_kmeans_+3A_y">y</code></td>
<td>
<p>A numeric variable for the y axis</p>
</td></tr>
<tr><td><code id="plot_kmeans_+3A_resolution">resolution</code></td>
<td>
<p>The number of squares in the grid. Defaults to 50.
Meaning a 50 x 50 grid.</p>
</td></tr>
<tr><td><code id="plot_kmeans_+3A_group">group</code></td>
<td>
<p>A discrete variable containing the grouping for the KMeans. It defaults to 'center'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For large result-sets in remote sources, downloading every intersection will
be a long running, costly operation.  The approach of this function is to
devide the x and y plane in a grid and have the remote source figure the
total number of intersections, returned as a single number.  This reduces the
granularity of the visualization, but it speeds up the results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_kmeans(mtcars, mpg, wt, group = am)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+as_parsed_model'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>tidypredict</dt><dd><p><code><a href="tidypredict.html#topic+as_parsed_model">as_parsed_model</a></code></p>
</dd>
</dl>

<hr>
<h2 id='simple_kmeans_db'>Simple kmeans routine that works in-database</h2><span id='topic+simple_kmeans_db'></span>

<h3>Description</h3>

<p>It uses 'tidyeval' and 'dplyr' to run multiple cycles of kmean
calculations, expressed in dplyr formulas until an the optimal
centers are found.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simple_kmeans_db(
  df,
  ...,
  centers = 3,
  max_repeats = 100,
  initial_kmeans = NULL,
  safeguard_file = "kmeans.csv",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simple_kmeans_db_+3A_df">df</code></td>
<td>
<p>A Local or remote data frame</p>
</td></tr>
<tr><td><code id="simple_kmeans_db_+3A_...">...</code></td>
<td>
<p>A list of variables to be used in the kmeans algorithm</p>
</td></tr>
<tr><td><code id="simple_kmeans_db_+3A_centers">centers</code></td>
<td>
<p>The number of centers. Defaults to 3.</p>
</td></tr>
<tr><td><code id="simple_kmeans_db_+3A_max_repeats">max_repeats</code></td>
<td>
<p>The maximum number of cycles to run. Defaults to 100.</p>
</td></tr>
<tr><td><code id="simple_kmeans_db_+3A_initial_kmeans">initial_kmeans</code></td>
<td>
<p>A local dataframe with initial centroid values. Defaults to NULL.</p>
</td></tr>
<tr><td><code id="simple_kmeans_db_+3A_safeguard_file">safeguard_file</code></td>
<td>
<p>Each cycle will update a file specified in this argument
with the current centers.  Defaults to 'kmeans.csv'. Pass NULL if no file is
desired.</p>
</td></tr>
<tr><td><code id="simple_kmeans_db_+3A_verbose">verbose</code></td>
<td>
<p>Indicates if the progress bar will be displayed during the model's fitting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because each cycle is an independent 'dplyr' operation, or SQL operation if using a remote source,
the latest centroid data frame is saved to the parent environment in case the process needs to be
canceled and then restarted at a later point.  Passing the <code>current_kmeans</code> as the <code>initial_kmeans</code>
will allow the operation to pick up where it left off.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

mtcars %&gt;%
  simple_kmeans_db(mpg, qsec, wt) %&gt;%
  glimpse()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
