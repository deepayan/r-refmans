<!DOCTYPE html><html lang="en"><head><title>Help for package drugDemand</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {drugDemand}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#drugDemand-package'><p>Drug Demand Forecasting</p></a></li>
<li><a href='#df1'><p>The subject-level enrollment and event data before enrollment completion.</p></a></li>
<li><a href='#df2'><p>The subject-level enrollment and event data after enrollment completion.</p></a></li>
<li><a href='#dosing_schedule_df'><p>The dosing schedule data frame.</p></a></li>
<li><a href='#f_cum_dose'><p>Cumulative Dose</p></a></li>
<li><a href='#f_dispensing_models'><p>Drug Dispensing Model Fitting</p></a></li>
<li><a href='#f_dose_draw'><p>Drug Dispensing Data Simulation</p></a></li>
<li><a href='#f_dose_draw_1'><p>Drug Dispensing Data Simulation for One Iteration</p></a></li>
<li><a href='#f_dose_draw_t_1'><p>Drug Dispensing Visit Dates Simulation for One Iteration</p></a></li>
<li><a href='#f_dose_new_cpp'><p>Dosing Date Imputation for New Patients</p></a></li>
<li><a href='#f_dose_observed'><p>Observed Drug Dispensing Data Summary</p></a></li>
<li><a href='#f_dose_ongoing_cpp'><p>Dosing Date Imputation for Ongoing Patients</p></a></li>
<li><a href='#f_dose_pp'><p>Drug Demand Per Protocol</p></a></li>
<li><a href='#f_drug_demand'><p>Drug Demand Forecasting</p></a></li>
<li><a href='#f_fit_di'><p>Model Fitting for Dispensed Doses</p></a></li>
<li><a href='#f_fit_ki'><p>Model Fitting for Number of Skipped Visits</p></a></li>
<li><a href='#f_fit_t0'><p>Model Fitting for Dispensing Delay After Randomization</p></a></li>
<li><a href='#f_fit_ti'><p>Model Fitting for Gap Times</p></a></li>
<li><a href='#f_ongoing_new'><p>Observed Dosing for Ongoing and New Subjects</p></a></li>
<li><a href='#kit_description_df'><p>The kit description data frame.</p></a></li>
<li><a href='#rdirichlet'><p>Random Number Generator for the Dirichlet Distribution</p></a></li>
<li><a href='#treatment_by_drug_df'><p>The data frame indicating the treatments associated with each drug.</p></a></li>
<li><a href='#visitview1'><p>The observed subject drug dispensing data before enrollment completion.</p></a></li>
<li><a href='#visitview2'><p>The observed subject drug dispensing data after enrollment completion.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Drug Demand Forecasting</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-27</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs drug demand forecasting by modeling drug dispensing data while taking into account predicted enrollment and treatment discontinuation dates. The gap time between randomization and the first drug dispensing visit is modeled using interval-censored exponential, Weibull, log-logistic, or log-normal distributions (Anderson-Bergman (2017) &lt;<a href="https://doi.org/10.18637%2Fjss.v081.i12">doi:10.18637/jss.v081.i12</a>&gt;). The number of skipped visits is modeled using Poisson, zero-inflated Poisson, or negative binomial distributions (Zeileis, Kleiber &amp; Jackman (2008) &lt;<a href="https://doi.org/10.18637%2Fjss.v027.i08">doi:10.18637/jss.v027.i08</a>&gt;). The gap time between two consecutive drug dispensing visits given the number of skipped visits is modeled using linear regression based on least squares or least absolute deviations (Birkes &amp; Dodge (1993, ISBN:0-471-56881-3)). The number of dispensed doses is modeled using linear or linear mixed-effects models (McCulloch &amp; Searle (2001, ISBN:0-471-19364-X)).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.10), dplyr (&ge; 1.1.0), rlang (&ge; 1.1.0), purrr
(&ge; 1.0.2), stringr (&ge; 1.4.0), plotly (&ge; 4.10.1), survival
(&ge; 2.41-3), mvtnorm (&ge; 1.1-3), erify (&ge; 0.4.0), stats (&ge;
3.5.0), MASS (&ge; 7.3-54), nlme (&ge; 3.1-153), L1pack (&ge;
0.41-24), eventPred (&ge; 0.2.3), parallel (&ge; 4.1.2), foreach
(&ge; 1.5.2), doParallel (&ge; 1.0.17), doRNG (&ge; 1.8.6)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-27 22:56:55 UTC; kaife</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaifeng Lu <a href="https://orcid.org/0000-0002-6160-7119"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaifeng Lu &lt;kaifenglu@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-28 01:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='drugDemand-package'>Drug Demand Forecasting</h2><span id='topic+drugDemand-package'></span>

<h3>Description</h3>

<p>Performs drug demand forecasting by modeling drug
dispensing data while taking into account predicted enrollment
and treatment discontinuation dates. The gap time between
randomization and the first drug dispensing visit is modeled
using interval-censored exponential, Weibull, log-logistic, or
log-normal distributions
(Anderson-Bergman (2017) <a href="https://doi.org/10.18637/jss.v081.i12">doi:10.18637/jss.v081.i12</a>).
The number of skipped visits is modeled using Poisson,
zero-inflated Poisson, or negative binomial distributions
(Zeileis, Kleiber &amp; Jackman (2008) <a href="https://doi.org/10.18637/jss.v027.i08">doi:10.18637/jss.v027.i08</a>).
The gap time between two consecutive drug dispensing visits
given the number of skipped visits is modeled using linear
regression based on least squares or least absolute
deviations (Birkes &amp; Dodge (1993, ISBN:0-471-56881-3)).
The number of dispensed doses is modeled using linear
or linear mixed-effects models
(McCulloch &amp; Searle (2001, ISBN:0-471-19364-X)).
</p>


<h3>Details</h3>

<p>In clinical trials, patients do not always follow
protocol-specified visit and drug dispensing schedules.
Patients may encounter delays in their drug dispensing
appointments, skip visits altogether, or receive doses
different from the protocol-specified target.
Relying solely on protocol-based predictions tends to result
in an overestimation of drug demand. Consequently, we propose
a method that models observed drug dispensing data,
thereby accounting for these deviations.
</p>

<ul>
<li> <p><code>k0</code>: The number of skipped visits between randomization
and the first drug dispensing visit.
</p>
</li>
<li> <p><code>t0</code>: The gap time between randomization and the first
drug dispensing visit when there is no visit skipping.
</p>
</li>
<li> <p><code>t1</code>: The gap time between randomization and the first
drug dispensing visit when there is visit skipping.
</p>
</li>
<li> <p><code>ki</code>: The number of skipped visits between two consecutive
drug dispensing visits.
</p>
</li>
<li> <p><code>ti</code>: The gap time between two consecutive drug
dispensing visits.
</p>
</li>
<li> <p><code>di</code>: The dispensed doses at drug dispensing visits.
</p>
</li></ul>

<p>For <code>k0</code> and <code>ki</code>, we explore several modeling options,
including constant, Poisson, zero-inflated Poisson (ZIP), and
negative binomial distributions.
</p>
<p>For <code>t0</code>, we consider various models such as constant,
exponential, Weibull, log-logistic, and log-normal.
</p>
<p>For <code>t1</code> (given <code>k0</code>) and <code>ti</code> (given <code>ki</code>),
we apply linear regression models using least squares or
least absolute deviations.
</p>
<p>For <code>di</code>, we evaluate constant, linear, and linear
mixed-effects models with subject random effects.
</p>
<p>Once the dosing models are fitted to the observed drug
dispensing data, we draw model parameters from their
approximate posterior distributions. Subsequently, we simulate
drug dispensing data after cutoff for both ongoing and new patients.
</p>
<p>Finally, we estimate the dose to dispense based on the
simulated data.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Clifford Anderson-Bergman.
icenReg: Regression Models for Interval Censored Data in R.
J Stat Softw. 2017, Volume 81, Issue 12.
</p>
<p>Achim Zeileis, Christian Kleiber, and Simon Jackman.
Regression models for count data in R.
J Stat Softw. 2008, Volume 27, Issue 8.
</p>
<p>David Birkes and Yadolah Dodge.
Alternative Methods of Regression.
John Wiley &amp; Sons: New York, 1993.
</p>
<p>Charles E. McCulloch and Shayler R. Searle.
Generalized, Linear, and Mixed Models.
John Wiley &amp; Sons: New York, 2001.
</p>

<hr>
<h2 id='df1'>The subject-level enrollment and event data before enrollment completion.</h2><span id='topic+df1'></span>

<h3>Description</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt><code>trialsdt</code></dt><dd><p>The trial start date.</p>
</dd>
<dt><code>usubjid</code></dt><dd><p>The unique subject ID.</p>
</dd>
<dt><code>randdt</code></dt><dd><p>The randomization date for each subject.</p>
</dd>
<dt><code>treatment</code></dt><dd><p>The treatment group.</p>
</dd>
<dt><code>treatment_description</code></dt><dd><p>Description of the treatment group.</p>
</dd>
<dt><code>time</code></dt><dd><p>The number of days elapsed since randomization.</p>
</dd>
<dt><code>event</code></dt><dd><p>The event indicator, with a value of 1 indicating
the occurrence of an event, and 0 indicating no event.</p>
</dd>
<dt><code>dropout</code></dt><dd><p>The dropout indicator, where 1 corresponds to
a dropout and 0 implies no dropout.</p>
</dd>
<dt><code>cutoffdt</code></dt><dd><p>The cutoff date.</p>
</dd>
</dl>
<p>For drug demand forecasting, the event of interest is treatment
discontinuation. The dropout variable is set to 0 for all patients in
this context.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>df1
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 175 rows and 9 columns.
</p>

<hr>
<h2 id='df2'>The subject-level enrollment and event data after enrollment completion.</h2><span id='topic+df2'></span>

<h3>Description</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt><code>trialsdt</code></dt><dd><p>The trial start date.</p>
</dd>
<dt><code>usubjid</code></dt><dd><p>The unique subject ID.</p>
</dd>
<dt><code>randdt</code></dt><dd><p>The randomization date for each subject.</p>
</dd>
<dt><code>treatment</code></dt><dd><p>The treatment group.</p>
</dd>
<dt><code>treatment_description</code></dt><dd><p>Description of the treatment group.</p>
</dd>
<dt><code>time</code></dt><dd><p>The number of days elapsed since randomization.</p>
</dd>
<dt><code>event</code></dt><dd><p>The event indicator, with a value of 1 indicating
the occurrence of an event, and 0 indicating no event.</p>
</dd>
<dt><code>dropout</code></dt><dd><p>The dropout indicator, where 1 corresponds to
a dropout and 0 implies no dropout.</p>
</dd>
<dt><code>cutoffdt</code></dt><dd><p>The cutoff date.</p>
</dd>
</dl>
<p>For drug demand forecasting, the event of interest is treatment
discontinuation. The dropout variable is set to 0 for all patients in
this context.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>df2
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 250 rows and 9 columns.
</p>

<hr>
<h2 id='dosing_schedule_df'>The dosing schedule data frame.</h2><span id='topic+dosing_schedule_df'></span>

<h3>Description</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt><code>kit</code></dt><dd><p>The numeric code of the kit type.</p>
</dd>
<dt><code>target_days</code></dt><dd><p>Number of days per treatment cycle.</p>
</dd>
<dt><code>target_dose</code></dt><dd><p>Dose per treatment cycle.</p>
</dd>
<dt><code>max_cycles</code></dt><dd><p>Maximum number of treatment cycles.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>dosing_schedule_df
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 4 rows and 4 columns.
</p>

<hr>
<h2 id='f_cum_dose'>Cumulative Dose</h2><span id='topic+f_cum_dose'></span>

<h3>Description</h3>

<p>Obtains the cumulative dose given treatment duration and
dosing schedule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_cum_dose(x, w, d, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_cum_dose_+3A_x">x</code></td>
<td>
<p>Treatment duration.</p>
</td></tr>
<tr><td><code id="f_cum_dose_+3A_w">w</code></td>
<td>
<p>Number of days per treatment cycle.</p>
</td></tr>
<tr><td><code id="f_cum_dose_+3A_d">d</code></td>
<td>
<p>Dose per treatment cycle.</p>
</td></tr>
<tr><td><code id="f_cum_dose_+3A_n">N</code></td>
<td>
<p>Maximum number of treatment cycles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The cumulative dose to dispense for the drug over a specified
treatment duration.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
f_cum_dose(c(28, 70), 21, 2, 10000)

</code></pre>

<hr>
<h2 id='f_dispensing_models'>Drug Dispensing Model Fitting</h2><span id='topic+f_dispensing_models'></span>

<h3>Description</h3>

<p>Fits drug dispensing models to the observed drug
dispensing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_dispensing_models(
  vf,
  dosing_schedule_df,
  model_k0,
  model_t0,
  model_t1,
  model_ki,
  model_ti,
  model_di,
  nreps,
  showplot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_dispensing_models_+3A_vf">vf</code></td>
<td>
<p>A data frame for subject-level drug dispensing data,
including the following variables:
<code>drug</code>, <code>drug_name</code>, <code>kit</code>, <code>kit_name</code>,
<code>usubjid</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>arrivalTime</code>, <code>time</code>, <code>event</code>, <code>dropout</code>,
<code>day</code>, <code>dose</code>, <code>cum_dose</code>, and <code>row_id</code>.</p>
</td></tr>
<tr><td><code id="f_dispensing_models_+3A_dosing_schedule_df">dosing_schedule_df</code></td>
<td>
<p>A data frame providing dosing schedule
information. It contains the following variables:
<code>kit</code>, <code>target_days</code>, <code>target_dose</code>, and
<code>max_cycles</code>.</p>
</td></tr>
<tr><td><code id="f_dispensing_models_+3A_model_k0">model_k0</code></td>
<td>
<p>The model for the number of skipped
visits between randomization and the first drug dispensing visit.
Options include &quot;constant&quot;, &quot;poisson&quot;, &quot;zero-inflated poisson&quot;,
and &quot;negative binomial&quot;.</p>
</td></tr>
<tr><td><code id="f_dispensing_models_+3A_model_t0">model_t0</code></td>
<td>
<p>The model for the gap time between randomization
and the first drug dispensing visit when there is no visit skipping.
Options include &quot;constant&quot;, &quot;exponential&quot;, &quot;weibull&quot;,
&quot;log-logistic&quot;, and &quot;log-normal&quot;.</p>
</td></tr>
<tr><td><code id="f_dispensing_models_+3A_model_t1">model_t1</code></td>
<td>
<p>The model for the gap time between randomization
and the first drug dispensing visit when there is visit skipping.
Options include &quot;least squares&quot;, and &quot;least absolute deviations&quot;.</p>
</td></tr>
<tr><td><code id="f_dispensing_models_+3A_model_ki">model_ki</code></td>
<td>
<p>The model for the number of skipped
visits between two consecutive drug dispensing visits.
Options include &quot;constant&quot;, &quot;poisson&quot;, &quot;zero-inflated poisson&quot;,
and &quot;negative binomial&quot;.</p>
</td></tr>
<tr><td><code id="f_dispensing_models_+3A_model_ti">model_ti</code></td>
<td>
<p>The model for the gap time between two consecutive
drug dispensing visits. Options include &quot;least squares&quot;
and &quot;least absolute deviations&quot;.</p>
</td></tr>
<tr><td><code id="f_dispensing_models_+3A_model_di">model_di</code></td>
<td>
<p>The model for the dispensed doses at drug
dispensing visits. Options include &quot;constant&quot;,
&quot;linear model&quot;, and &quot;linear mixed-effects model&quot;.</p>
</td></tr>
<tr><td><code id="f_dispensing_models_+3A_nreps">nreps</code></td>
<td>
<p>The number of simulations for drawing posterior model
parameters.</p>
</td></tr>
<tr><td><code id="f_dispensing_models_+3A_showplot">showplot</code></td>
<td>
<p>A Boolean variable that controls whether or not to
show the model fit plot. It defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>common_time_model</code>: A Boolean variable that indicates
whether a common time model is used for drug dispensing visits.
</p>
</li>
<li> <p><code>k0_fit</code>: The model fit for the number of skipped
visits between randomization and the first drug dispensing visit.
</p>
</li>
<li> <p><code>t0_fit</code>: The model fit for the gap time between
randomization and the first drug dispensing visit when there is
no visit skipping.
</p>
</li>
<li> <p><code>t1_fit</code>: The model fit for the gap time between
randomization and the first drug dispensing visit when there is
visit skipping.
</p>
</li>
<li> <p><code>ki_fit</code>: The model fit for the number of skipped
visits between two consecutive drug dispensing visits.
</p>
</li>
<li> <p><code>ti_fit</code>: The model fit for the gap time between two
consecutive drug dispensing visits.
</p>
</li>
<li> <p><code>di_fit</code>: The model fit for the dispensed doses at drug
dispensing visits.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f_fit_t0">f_fit_t0</a></code>, <code><a href="#topic+f_fit_ki">f_fit_ki</a></code>,
<code><a href="#topic+f_fit_ti">f_fit_ti</a></code>, <code><a href="#topic+f_fit_di">f_fit_di</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

observed &lt;- f_dose_observed(df2, visitview2, showplot = FALSE)

dispensing_models &lt;- f_dispensing_models(
  observed$vf, dosing_schedule_df,
  model_k0 = "zero-inflated poisson",
  model_t0 = "log-logistic",
  model_t1 = "least squares",
  model_ki = "zero-inflated poisson",
  model_ti = "least squares",
  model_di = "linear mixed-effects model",
  nreps = 200, showplot = FALSE)

dispensing_models$ki_fit$fit_plot
</code></pre>

<hr>
<h2 id='f_dose_draw'>Drug Dispensing Data Simulation</h2><span id='topic+f_dose_draw'></span>

<h3>Description</h3>

<p>Simulates drug dispensing data after cutoff for
both ongoing and new patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_dose_draw(
  vf_ongoing,
  vf_new,
  common_time_model,
  k0_fit,
  t0_fit,
  t1_fit,
  ki_fit,
  ti_fit,
  di_fit,
  t0,
  t,
  ncores_max
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_dose_draw_+3A_vf_ongoing">vf_ongoing</code></td>
<td>
<p>A data frame for the observed drug dispensing
data for ongoing patients with drug dispensing records.
It includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>day</code>, <code>dose</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, and <code>totalTime</code>.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_vf_new">vf_new</code></td>
<td>
<p>A data frame for the randomization date for new
patients and ongoing patients with no drug dispensing records.
It includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>arrivalTime</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, and <code>totalTime</code>.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_common_time_model">common_time_model</code></td>
<td>
<p>A Boolean variable that indicates whether
a common time model is used for drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_k0_fit">k0_fit</code></td>
<td>
<p>The model fit for the number of skipped
visits between randomization and the first drug dispensing visit.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_t0_fit">t0_fit</code></td>
<td>
<p>The model fit for the gap time between randomization
and the first drug dispensing visit when there is no visit skipping.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_t1_fit">t1_fit</code></td>
<td>
<p>The model fit for the gap time between randomization
and the first drug dispensing visit when there is visit skipping.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_ki_fit">ki_fit</code></td>
<td>
<p>The model fit for the number of skipped
visits between two consecutive drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_ti_fit">ti_fit</code></td>
<td>
<p>The model fit for the gap time between two
consecutive drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_di_fit">di_fit</code></td>
<td>
<p>The model fit for the dispensed doses at drug
dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_t0">t0</code></td>
<td>
<p>The cutoff date relative to the trial start date.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_t">t</code></td>
<td>
<p>A vector of new time points for drug dispensing prediction.</p>
</td></tr>
<tr><td><code id="f_dose_draw_+3A_ncores_max">ncores_max</code></td>
<td>
<p>The maximum number of cores to use for parallel
computing. The actual number of cores used is the minimum of
<code>ncores_max</code> and half of the detected number of cores.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li> <p><code>dosing_subject_new</code>: A data frame containing observed and
imputed subject-level dosing records for ongoing and new patients
for the first iteration. It contains the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>day</code>, <code>dose</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, and <code>totalTime</code>.
</p>
</li>
<li> <p><code>dosing_summary_new</code>: A data frame providing dosing summaries
by drug, future time point, and simulation draw for ongoing
and new patients. It contains the following variables:
<code>kit</code>, <code>kit_name</code>, <code>t</code>, <code>draw</code>, and
<code>total_dose_b</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f_fit_t0">f_fit_t0</a></code>, <code><a href="#topic+f_fit_ki">f_fit_ki</a></code>,
<code><a href="#topic+f_fit_ti">f_fit_ti</a></code>, <code><a href="#topic+f_fit_di">f_fit_di</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(431)
library(dplyr)

pred &lt;- eventPred::getPrediction(
  df = df2,
  to_predict = "event only",
  target_d = 250,
  event_model = "log-logistic",
  dropout_model = "none",
  pilevel = 0.95,
  nyears = 3,
  nreps = 200,
  showsummary = FALSE,
  showplot = FALSE,
  by_treatment = TRUE)

observed &lt;- f_dose_observed(df2, visitview2, showplot = FALSE)

fit &lt;- f_dispensing_models(
  observed$vf, dosing_schedule_df,
  model_k0 = "zero-inflated poisson",
  model_t0 = "log-logistic",
  model_t1 = "least squares",
  model_ki = "zero-inflated poisson",
  model_ti = "least squares",
  model_di = "linear mixed-effects model",
  nreps = 200, showplot = FALSE)

trialsdt = df2$trialsdt[1]
cutoffdt = df2$cutoffdt[1]
t0 = as.numeric(cutoffdt - trialsdt + 1)
nyears = 3
t1 = t0 + nyears*365
t = c(seq(t0, t1, 30), t1)

vf_ongoing_new &lt;- f_ongoing_new(
  pred$event_pred$newEvents,
  observed$kit_description_df,
  observed$treatment_by_drug_df,
  observed$vf)

dose_draw &lt;- f_dose_draw(
  vf_ongoing_new$vf_ongoing,
  vf_ongoing_new$vf_new,
  fit$common_time_model,
  fit$k0_fit, fit$t0_fit, fit$t1_fit,
  fit$ki_fit, fit$ti_fit, fit$di_fit,
  t0, t, ncores_max = 2)

head(dose_draw$dosing_subject_new)
head(dose_draw$dosing_summary_new)


</code></pre>

<hr>
<h2 id='f_dose_draw_1'>Drug Dispensing Data Simulation for One Iteration</h2><span id='topic+f_dose_draw_1'></span>

<h3>Description</h3>

<p>Simulates drug dispensing data for one iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_dose_draw_1(
  i,
  common_time_model,
  k0_fit,
  t0_fit,
  t1_fit,
  ki_fit,
  ti_fit,
  di_fit,
  vf_ongoing,
  vf_ongoing1,
  vf_new,
  vf_new1,
  vf_kit,
  l,
  t
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_dose_draw_1_+3A_i">i</code></td>
<td>
<p>The iteration number.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_common_time_model">common_time_model</code></td>
<td>
<p>A Boolean variable that indicates whether
a common time model is used for drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_k0_fit">k0_fit</code></td>
<td>
<p>The model fit for the number of skipped
visits between randomization and the first drug dispensing visit.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_t0_fit">t0_fit</code></td>
<td>
<p>The model fit for the gap time between randomization
and the first drug dispensing visit when there is no visit skipping.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_t1_fit">t1_fit</code></td>
<td>
<p>The model fit for the gap time between randomization
and the first drug dispensing visit when there is visit skipping.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_ki_fit">ki_fit</code></td>
<td>
<p>The model fit for the number of skipped
visits between two consecutive drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_ti_fit">ti_fit</code></td>
<td>
<p>The model fit for the gap time between two
consecutive drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_di_fit">di_fit</code></td>
<td>
<p>The model fit for the dispensed doses at drug
dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_vf_ongoing">vf_ongoing</code></td>
<td>
<p>A data frame for the observed drug dispensing
data for ongoing patients with drug dispensing records.
It includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>day</code>, <code>dose</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, and <code>totalTime</code>.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_vf_ongoing1">vf_ongoing1</code></td>
<td>
<p>A data frame for the last observed drug dispensing
date for ongoing patients with drug dispensing records.
For the common time model, it includes the following variables:
<code>draw</code>, <code>usubjid</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, <code>totalTime</code>,
<code>V</code>, <code>C</code>, and <code>D</code>.
For separate time models, it includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>arrivalTime</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, <code>totalTime</code>, <code>V</code>, <code>C</code>, and <code>D</code>.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_vf_new">vf_new</code></td>
<td>
<p>A data frame for the randomization date for new
patients and ongoing patients with no drug dispensing records.
It includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>arrivalTime</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, and <code>totalTime</code>.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_vf_new1">vf_new1</code></td>
<td>
<p>A data frame for the randomization date for new patients
and ongoing patients with no drug dispensing records.
For the common time model, it includes the following variables:
<code>draw</code>, <code>usubjid</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, <code>totalTime</code>,
<code>V</code>, <code>C</code>, and <code>D</code>.
For separate time models, it includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>arrivalTime</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, <code>totalTime</code>, <code>V</code>, <code>C</code>, and <code>D</code>.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_vf_kit">vf_kit</code></td>
<td>
<p>A data frame indicating the kit names for each subject
by draw. It includes the following variables:
<code>draw</code>, <code>usubjid</code>, <code>kit</code>, and <code>kit_name</code>.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_l">l</code></td>
<td>
<p>Number of kit types.</p>
</td></tr>
<tr><td><code id="f_dose_draw_1_+3A_t">t</code></td>
<td>
<p>A vector of new time points for drug dispensing prediction.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two components:
</p>

<ul>
<li> <p><code>dosing_subject_newi</code>: A data frame for the drug dispensing
data at the subject level by date for ongoing and new subjects
for the given iteration. It contains the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>day</code>, <code>dose</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, and <code>totalTime</code>.
</p>
</li>
<li> <p><code>dosing_summary_newi</code>: A data frame for the drug dispensing
summary data by drug, time, and simulation draw for ongoing and
new subjects for the given iteration. It includes the following
variables:
<code>kit</code>, <code>kit_name</code>, <code>t</code>, <code>draw</code>, and
<code>total_dose_b</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f_fit_t0">f_fit_t0</a></code>, <code><a href="#topic+f_fit_ki">f_fit_ki</a></code>,
<code><a href="#topic+f_fit_ti">f_fit_ti</a></code>, <code><a href="#topic+f_fit_di">f_fit_di</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(431)
library(dplyr)

pred &lt;- eventPred::getPrediction(
  df = df2,
  to_predict = "event only",
  target_d = 250,
  event_model = "log-logistic",
  dropout_model = "none",
  pilevel = 0.95,
  nyears = 3,
  nreps = 200,
  showsummary = FALSE,
  showplot = FALSE,
  by_treatment = TRUE)

observed &lt;- f_dose_observed(df2, visitview2, showplot = FALSE)

fit &lt;- f_dispensing_models(
  observed$vf, dosing_schedule_df,
  model_k0 = "zero-inflated poisson",
  model_t0 = "log-logistic",
  model_t1 = "least squares",
  model_ki = "zero-inflated poisson",
  model_ti = "least squares",
  model_di = "linear mixed-effects model",
  nreps = 200, showplot = FALSE)

trialsdt = df2$trialsdt[1]
cutoffdt = df2$cutoffdt[1]
t0 = as.numeric(cutoffdt - trialsdt + 1)
nyears = 3
t1 = t0 + nyears*365
t = c(seq(t0, t1, 30), t1)

l = nrow(observed$kit_description_df)

vf_ongoing_new &lt;- f_ongoing_new(
  pred$event_pred$newEvents,
  observed$kit_description_df,
  observed$treatment_by_drug_df,
  observed$vf)

vf_ongoing &lt;- vf_ongoing_new$vf_ongoing
vf_new &lt;- vf_ongoing_new$vf_new

vf_kit &lt;- vf_ongoing %&gt;%
  select(-c("day", "dose")) %&gt;%
  bind_rows(vf_new) %&gt;%
  group_by(draw, usubjid, kit, kit_name) %&gt;%
  slice(1) %&gt;%
  select(c("draw", "usubjid", "kit", "kit_name"))

vf_ongoing1 &lt;- vf_ongoing %&gt;%
  group_by(draw, usubjid) %&gt;%
  slice(n()) %&gt;%
  mutate(V = day - 1,
         C = as.numeric(t0 - arrivalTime),
         D = pmin(time - 1, t1 - arrivalTime)) %&gt;%
  select(-c("kit", "kit_name", "day", "dose"))

### new patients and ongoing patients with no dosing records ###
vf_new1 &lt;- vf_new %&gt;%
  group_by(draw, usubjid) %&gt;%
  slice(n()) %&gt;%
  mutate(V = 0,
         C = as.numeric(t0 - arrivalTime),
         D = pmin(time - 1, t1 - arrivalTime)) %&gt;%
  select(-c("kit", "kit_name"))

# first iteration to extract subject and summary data
list1 &lt;- f_dose_draw_1(
  1, fit$common_time_model,
  fit$k0_fit, fit$t0_fit, fit$t1_fit,
  fit$ki_fit, fit$ti_fit, fit$di_fit,
  vf_ongoing, vf_ongoing1, vf_new, vf_new1,
  vf_kit, l, t)

head(list1$dosing_subject_newi)
head(list1$dosing_summary_newi)


</code></pre>

<hr>
<h2 id='f_dose_draw_t_1'>Drug Dispensing Visit Dates Simulation for One Iteration</h2><span id='topic+f_dose_draw_t_1'></span>

<h3>Description</h3>

<p>Simulates drug dispensing visit dates for one iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_dose_draw_t_1(
  i,
  k0_fit,
  t0_fit,
  t1_fit,
  ki_fit,
  ti_fit,
  vf_ongoing1,
  vf_new1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_dose_draw_t_1_+3A_i">i</code></td>
<td>
<p>The iteration number.</p>
</td></tr>
<tr><td><code id="f_dose_draw_t_1_+3A_k0_fit">k0_fit</code></td>
<td>
<p>The model fit for the number of skipped
visits between randomization and the first drug dispensing visit.</p>
</td></tr>
<tr><td><code id="f_dose_draw_t_1_+3A_t0_fit">t0_fit</code></td>
<td>
<p>The model fit for the gap time between randomization
and the first drug dispensing visit when there is no visit skipping.</p>
</td></tr>
<tr><td><code id="f_dose_draw_t_1_+3A_t1_fit">t1_fit</code></td>
<td>
<p>The model fit for the gap time between randomization
and the first drug dispensing visit when there is visit skipping.</p>
</td></tr>
<tr><td><code id="f_dose_draw_t_1_+3A_ki_fit">ki_fit</code></td>
<td>
<p>The model fit for the number of skipped
visits between two consecutive drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_t_1_+3A_ti_fit">ti_fit</code></td>
<td>
<p>The model fit for the gap time between two
consecutive drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_draw_t_1_+3A_vf_ongoing1">vf_ongoing1</code></td>
<td>
<p>A data frame for the last observed drug dispensing
date for ongoing patients with drug dispensing records.
For the common time model, it includes the following variables:
<code>draw</code>, <code>usubjid</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, <code>totalTime</code>,
<code>V</code>, <code>C</code>, and <code>D</code>.
For separate time models, it includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>arrivalTime</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, <code>totalTime</code>, <code>V</code>, <code>C</code>, and <code>D</code>.</p>
</td></tr>
<tr><td><code id="f_dose_draw_t_1_+3A_vf_new1">vf_new1</code></td>
<td>
<p>A data frame for the randomization date for new patients
and ongoing patients with no drug dispensing records.
For the common time model, it includes the following variables:
<code>draw</code>, <code>usubjid</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, <code>totalTime</code>,
<code>V</code>, <code>C</code>, and <code>D</code>.
For separate time models, it includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>arrivalTime</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, <code>totalTime</code>, <code>V</code>, <code>C</code>, and <code>D</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the simulated drug dispensing visit
dates at the subject level for ongoing and new subjects. It includes
the following variables:
<code>usubjid</code>, <code>day</code>, <code>draw</code>, <code>arrivalTime</code>,
<code>treatment</code>, <code>treatment_description</code>, <code>time</code>,
<code>totalTime</code>, and <code>status</code>.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f_fit_t0">f_fit_t0</a></code>, <code><a href="#topic+f_fit_ki">f_fit_ki</a></code>,
<code><a href="#topic+f_fit_ti">f_fit_ti</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(431)
library(dplyr)

pred &lt;- eventPred::getPrediction(
  df = df2,
  to_predict = "event only",
  target_d = 250,
  event_model = "log-logistic",
  dropout_model = "none",
  pilevel = 0.95,
  nyears = 3,
  nreps = 200,
  showsummary = FALSE,
  showplot = FALSE,
  by_treatment = TRUE)

observed &lt;- f_dose_observed(df2, visitview2, showplot = FALSE)

fit &lt;- f_dispensing_models(
  observed$vf, dosing_schedule_df,
  model_k0 = "zero-inflated poisson",
  model_t0 = "log-logistic",
  model_t1 = "least squares",
  model_ki = "zero-inflated poisson",
  model_ti = "least squares",
  model_di = "linear mixed-effects model",
  nreps = 200, showplot = FALSE)

trialsdt = df2$trialsdt[1]
cutoffdt = df2$cutoffdt[1]
t0 = as.numeric(cutoffdt - trialsdt + 1)
nyears = 3
t1 = t0 + nyears*365

vf_ongoing_new &lt;- f_ongoing_new(
  pred$event_pred$newEvents,
  observed$kit_description_df,
  observed$treatment_by_drug_df,
  observed$vf)

vf_ongoing &lt;- vf_ongoing_new$vf_ongoing
vf_new &lt;- vf_ongoing_new$vf_new

vf_ongoing1 &lt;- vf_ongoing %&gt;%
  group_by(draw, usubjid) %&gt;%
  slice(n()) %&gt;%
  mutate(V = day - 1,
         C = as.numeric(t0 - arrivalTime),
         D = pmin(time - 1, t1 - arrivalTime)) %&gt;%
  select(-c("kit", "kit_name", "day", "dose"))

### new patients and ongoing patients with no dosing records ###
vf_new1 &lt;- vf_new %&gt;%
  group_by(draw, usubjid) %&gt;%
  slice(n()) %&gt;%
  mutate(V = 0,
         C = as.numeric(t0 - arrivalTime),
         D = pmin(time - 1, t1 - arrivalTime)) %&gt;%
  select(-c("kit", "kit_name"))

dosing_subject_new1 &lt;- f_dose_draw_t_1(
  1, fit$k0_fit, fit$t0_fit, fit$t1_fit,
  fit$ki_fit, fit$ti_fit, vf_ongoing1, vf_new1)

head(dosing_subject_new1)


</code></pre>

<hr>
<h2 id='f_dose_new_cpp'>Dosing Date Imputation for New Patients</h2><span id='topic+f_dose_new_cpp'></span>

<h3>Description</h3>

<p>Imputes the dosing dates for new patients and ongoing
patients with no dosing records.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_dose_new_cpp(
  usubjid,
  V,
  C,
  D,
  model_k0,
  theta_k0,
  model_t0,
  theta_t0,
  model_t1,
  theta_t1,
  model_ki,
  theta_ki,
  model_ti,
  theta_ti
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_dose_new_cpp_+3A_usubjid">usubjid</code></td>
<td>
<p>The unique subject ID.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_v">V</code></td>
<td>
<p>Initialized to 0 and corresponds to the randomization visit.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_c">C</code></td>
<td>
<p>The cutoff date relative to randomization.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_d">D</code></td>
<td>
<p>The discontinuation date relative to randomization.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_model_k0">model_k0</code></td>
<td>
<p>The model for the number of skipped
visits between randomization and the first drug dispensing visit.
Options include &quot;constant&quot;, &quot;poisson&quot;, &quot;zero-inflated poisson&quot;,
and &quot;negative binomial&quot;.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_theta_k0">theta_k0</code></td>
<td>
<p>The model parameters for the number of skipped
visits between randomization and the first drug dispensing visit.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_model_t0">model_t0</code></td>
<td>
<p>The model for the gap time between randomization
and the first drug dispensing visit when there is no visit skipping.
Options include &quot;constant&quot;, &quot;exponential&quot;, &quot;weibull&quot;,
&quot;log-logistic&quot;, and &quot;log-normal&quot;.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_theta_t0">theta_t0</code></td>
<td>
<p>The model parameters for the gap time between
randomization and the first drug dispensing visit when there is
no visit skipping.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_model_t1">model_t1</code></td>
<td>
<p>The model for the gap time between randomization
and the first drug dispensing visit when there is visit skipping.
Options include &quot;least squares&quot;, and &quot;least absolute deviations&quot;.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_theta_t1">theta_t1</code></td>
<td>
<p>The model parameters for the gap time between
randomization and the first drug dispensing visit when there is
visit skipping.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_model_ki">model_ki</code></td>
<td>
<p>The model for the number of skipped
visits between two consecutive drug dispensing visits.
Options include &quot;constant&quot;, &quot;poisson&quot;, &quot;zero-inflated poisson&quot;,
and &quot;negative binomial&quot;.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_theta_ki">theta_ki</code></td>
<td>
<p>The model parameters for the number of skipped
visits between two consecutive drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_model_ti">model_ti</code></td>
<td>
<p>The model for the gap time between two consecutive
drug dispensing visits. Options include &quot;least squares&quot;
and &quot;least absolute deviations&quot;.</p>
</td></tr>
<tr><td><code id="f_dose_new_cpp_+3A_theta_ti">theta_ti</code></td>
<td>
<p>The model parameters for the gap time between
two consecutive drug dispensing visits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with two variables:
</p>

<ul>
<li> <p><code>usubjid</code>: The unique subject ID.
</p>
</li>
<li> <p><code>day</code>: The dosing visit date relative to randomization.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(529)

f_dose_new_cpp(
  usubjid = "Z001", V = 0, C = 87, D = 985,
  model_k0 = "zero-inflated poisson", theta_k0 = c(0.6, 1.1),
  model_t0 = "log-logistic", theta_t0 = c(-1.0, 0.7),
  model_t1 = "least squares", theta_t1 = c(21.5, 1.9),
  model_ki = "zero-inflated poisson", theta_ki = c(0.1, 0.4),
  model_ti = "least squares", theta_ti = c(21, 2.3))

</code></pre>

<hr>
<h2 id='f_dose_observed'>Observed Drug Dispensing Data Summary</h2><span id='topic+f_dose_observed'></span>

<h3>Description</h3>

<p>Provides an overview of the observed drug dispensing data,
including the summary of cumulative dispensed doses, bar chart
of the gap time between randomization and the first drug dispensing
visit, the gap time between two consecutive drug dispensing visits,
and the dispensed doses at drug dispensing visits by drug.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_dose_observed(df = NULL, visitview = NULL, showplot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_dose_observed_+3A_df">df</code></td>
<td>
<p>A data frame for subject-level enrollment and event data,
including the following variables:
<code>trialsdt</code>, <code>usubjid</code>, <code>randdt</code>,
<code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, <code>event</code>, <code>dropout</code>, and <code>cutoffdt</code>.</p>
</td></tr>
<tr><td><code id="f_dose_observed_+3A_visitview">visitview</code></td>
<td>
<p>A data frame containing the observed drug dispensing
data, including the following variables:
<code>usubjid</code>, <code>visit</code>, <code>date</code>, <code>drug</code>,
<code>drug_name</code>, <code>kit</code>, <code>kit_name</code>,
<code>kit_number</code>, and <code>dispensed_quantity</code>.</p>
</td></tr>
<tr><td><code id="f_dose_observed_+3A_showplot">showplot</code></td>
<td>
<p>A Boolean variable that controls whether or not to
show the drug dispensing model fit and drug demand prediction
plots. It defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>trialsdt</code>: The trial start date.
</p>
</li>
<li> <p><code>cutoffdt</code>: The cutoff date.
</p>
</li>
<li> <p><code>vf</code>: A data frame for subject-level drug dispensing data,
including the following variables:
<code>drug</code>, <code>drug_name</code>, <code>kit</code>, <code>kit_name</code>,
<code>usubjid</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>arrivalTime</code>, <code>time</code>, <code>event</code>, <code>dropout</code>,
<code>day</code>, <code>dose</code>, <code>cum_dose</code>, and <code>row_id</code>.
</p>
</li>
<li> <p><code>treatment_by_drug_df</code>: A data frame indicating the treatments
associated with each drug, including the following variables:
<code>treatment</code> and <code>drug</code>.
</p>
</li>
<li> <p><code>kit_description_df</code>: A data frame indicating the
drug and kit descriptions, including the following variables:
<code>drug</code>, <code>drug_name</code>, <code>kit</code>, and <code>kit_name</code>.
</p>
</li>
<li> <p><code>dosing_summary_t</code>: A data frame for the cumulative doses
dispensed by each observed time point. It contains the following
variables:
<code>kit</code>, <code>kit_name</code>, <code>t</code>, <code>n</code>,
<code>lower</code>, <code>upper</code>, <code>mean</code>, and <code>var</code>, where
<code>lower</code> and <code>upper</code> have missing values,
<code>mean = n</code>, and <code>var = 0</code>.
</p>
</li>
<li> <p><code>dosing_summary_t0</code>: A data frame for the cumulative doses
dispensed before the cutoff date. It contains the following
variables:
<code>kit</code>, <code>kit_name</code>, and <code>cum_dose_t0</code>.
</p>
</li>
<li> <p><code>cum_dispense_plot</code>: The step plot for the cumulative doses
dispensed for each kit type.
</p>
</li>
<li> <p><code>bar_t0_plot</code>: The bar chart for the gap time between
randomization and the first drug dispensing visit.
</p>
</li>
<li> <p><code>bar_ti_plot</code>: The bar chart for the gap time between two
consecutive drug dispensing visits.
</p>
</li>
<li> <p><code>bar_di_plot</code>: The bar chart for the dispensed doses at drug
dispensing visits.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
observed &lt;- f_dose_observed(df = df2, visitview = visitview2)

</code></pre>

<hr>
<h2 id='f_dose_ongoing_cpp'>Dosing Date Imputation for Ongoing Patients</h2><span id='topic+f_dose_ongoing_cpp'></span>

<h3>Description</h3>

<p>Imputes the dosing dates after cutoff for ongoing
patients with dosing records.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_dose_ongoing_cpp(usubjid, V, C, D, model_ki, theta_ki, model_ti, theta_ti)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_dose_ongoing_cpp_+3A_usubjid">usubjid</code></td>
<td>
<p>The unique subject ID.</p>
</td></tr>
<tr><td><code id="f_dose_ongoing_cpp_+3A_v">V</code></td>
<td>
<p>The last dosing visit date relative to randomization.</p>
</td></tr>
<tr><td><code id="f_dose_ongoing_cpp_+3A_c">C</code></td>
<td>
<p>The cutoff date relative to randomization.</p>
</td></tr>
<tr><td><code id="f_dose_ongoing_cpp_+3A_d">D</code></td>
<td>
<p>The discontinuation date relative to randomization.</p>
</td></tr>
<tr><td><code id="f_dose_ongoing_cpp_+3A_model_ki">model_ki</code></td>
<td>
<p>The model for the number of skipped
visits between two consecutive drug dispensing visits.
Options include &quot;constant&quot;, &quot;poisson&quot;, &quot;zero-inflated poisson&quot;,
and &quot;negative binomial&quot;.</p>
</td></tr>
<tr><td><code id="f_dose_ongoing_cpp_+3A_theta_ki">theta_ki</code></td>
<td>
<p>The model parameters for the number of skipped visits
between two consecutive drug dispensing visits.</p>
</td></tr>
<tr><td><code id="f_dose_ongoing_cpp_+3A_model_ti">model_ti</code></td>
<td>
<p>The model for the gap time between two consecutive
drug dispensing visits. Options include &quot;least squares&quot;
and &quot;least absolute deviations&quot;.</p>
</td></tr>
<tr><td><code id="f_dose_ongoing_cpp_+3A_theta_ti">theta_ti</code></td>
<td>
<p>The model parameters for the gap time between
two consecutive drug dispensing visits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with two variables:
</p>

<ul>
<li> <p><code>usubjid</code>: The unique subject ID.
</p>
</li>
<li> <p><code>day</code>: The dosing visit date relative to randomization.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(314)

f_dose_ongoing_cpp(
  usubjid = "A001", V = 297, C = 329, D = 569,
  model_ki = "zero-inflated poisson", theta_ki = c(0.4, 2.5),
  model_ti = "least squares", theta_ti = c(21, 2.3))

</code></pre>

<hr>
<h2 id='f_dose_pp'>Drug Demand Per Protocol</h2><span id='topic+f_dose_pp'></span>

<h3>Description</h3>

<p>Obtains drug demand prediction based on protocol-assumed
visit and dosing schedules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_dose_pp(
  dosing_summary_t0,
  vf_ongoing,
  vf_new,
  dosing_schedule_df,
  t0,
  t,
  pilevel
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_dose_pp_+3A_dosing_summary_t0">dosing_summary_t0</code></td>
<td>
<p>A data frame for the cumulative doses
dispensed before the cutoff date. It contains the following
variables:
<code>kit</code>, <code>kit_name</code>, and <code>cum_dose_t0</code>.</p>
</td></tr>
<tr><td><code id="f_dose_pp_+3A_vf_ongoing">vf_ongoing</code></td>
<td>
<p>A data frame for the observed drug dispensing
data for ongoing patients with drug dispensing records.
It includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>day</code>, <code>dose</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, and <code>totalTime</code>.</p>
</td></tr>
<tr><td><code id="f_dose_pp_+3A_vf_new">vf_new</code></td>
<td>
<p>A data frame for the randomization date for new
patients and ongoing patients with no drug dispensing records.
It includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>arrivalTime</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, and <code>totalTime</code>.</p>
</td></tr>
<tr><td><code id="f_dose_pp_+3A_dosing_schedule_df">dosing_schedule_df</code></td>
<td>
<p>A data frame providing dosing schedule
information. It contains the following variables:
<code>kit</code>, <code>target_days</code>, <code>target_dose</code>, and
<code>max_cycles</code>.</p>
</td></tr>
<tr><td><code id="f_dose_pp_+3A_t0">t0</code></td>
<td>
<p>The cutoff date relative to the trial start date.</p>
</td></tr>
<tr><td><code id="f_dose_pp_+3A_t">t</code></td>
<td>
<p>A vector of new time points for drug dispensing prediction.</p>
</td></tr>
<tr><td><code id="f_dose_pp_+3A_pilevel">pilevel</code></td>
<td>
<p>The prediction interval level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame for dosing summary by drug and time point per
protocol. It contains the following variables:
<code>kit</code>, <code>kit_name</code>, <code>t</code>, <code>n</code>, <code>pilevel</code>,
<code>lower</code>, <code>upper</code>, <code>mean</code>, and <code>var</code>.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Design stage drug demand forecasting per protocol.

set.seed(312)
library(dplyr)

pred &lt;- eventPred::getPrediction(
  df = NULL,
  to_predict = "enrollment and event",
  target_n = 250,
  target_d = 250,
  enroll_prior = list(
    model = "piecewise poisson",
    theta = c(-0.74, -1.18),
    vtheta = matrix(c(0.0087, 0, 0, 0.0082), 2, 2),
    accrualTime = c(0, 240)),
  event_prior = list(
    list(model = "log-logistic",
         theta = c(5.9, -0.2),
         vtheta = matrix(c(0.022, 0.004, 0.004, 0.012), 2, 2)),
    list(model = "log-logistic",
         theta = c(5.6, 0.02),
         vtheta = matrix(c(0.032, 0.003, 0.003, 0.012), 2, 2)),
    list(model = "log-logistic",
         theta = c(5.7, -0.3),
         vtheta = matrix(c(0.071, 0.013, 0.013, 0.054), 2, 2))),
  dropout_prior = NULL,
  pilevel = 0.95,
  nyears = 3,
  nreps = 200,
  showsummary = FALSE,
  showplot = FALSE,
  by_treatment = TRUE,
  ngroups = 3,
  alloc = c(2, 2, 1),
  treatment_label = c("Drug A + Drug B",
                      "Drug C + Placebo",
                      "Drug A + Placebo"))

dosing_summary_t0 = kit_description_df %&gt;%
  mutate(cum_dose_t0 = 0) %&gt;%
  select(-c("drug", "drug_name"))

vf_ongoing_new &lt;- f_ongoing_new(
  pred$event_pred$newEvents, kit_description_df,
  treatment_by_drug_df, NULL)

t0 = 1
nyears = 3
t1 = t0 + nyears*365
t = c(seq(t0, t1, 30), t1)
pilevel = 0.95

dosing_pred_pp &lt;- f_dose_pp(
  dosing_summary_t0, vf_ongoing_new$vf_ongoing,
  vf_ongoing_new$vf_new, dosing_schedule_df, t0, t, pilevel)

head(dosing_pred_pp)


</code></pre>

<hr>
<h2 id='f_drug_demand'>Drug Demand Forecasting</h2><span id='topic+f_drug_demand'></span>

<h3>Description</h3>

<p>Obtains drug demand forecasting via modeling and
simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_drug_demand(
  df = NULL,
  newEvents = NULL,
  visitview = NULL,
  kit_description_df = NULL,
  treatment_by_drug_df = NULL,
  dosing_schedule_df = NULL,
  model_k0 = "negative binomial",
  model_t0 = "log-logistic",
  model_t1 = "least squares",
  model_ki = "negative binomial",
  model_ti = "least absolute deviations",
  model_di = "linear mixed-effects model",
  pilevel = 0.95,
  nyears = 1,
  ncores_max = 10,
  pred_pp_only = FALSE,
  showplot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_drug_demand_+3A_df">df</code></td>
<td>
<p>A data frame for subject-level enrollment and event data,
including the following variables:
<code>trialsdt</code>, <code>usubjid</code>, <code>randdt</code>,
<code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, <code>event</code>, <code>dropout</code>, and <code>cutoffdt</code>.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_newevents">newEvents</code></td>
<td>
<p>A data frame containing the imputed event data
for both ongoing and new patients, typically obtained from
the output of the <code>getPrediction</code> function of the
<code>eventPred</code> package. It contains the following variables:
<code>draw</code>, <code>usubjid</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, <code>event</code>,
<code>dropout</code>, and <code>totalTime</code>. It must be provided.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_visitview">visitview</code></td>
<td>
<p>A data frame containing the observed drug dispensing
data, including the following variables:
<code>usubjid</code>, <code>visit</code>, <code>date</code>, <code>drug</code>,
<code>drug_name</code>, <code>kit</code>, <code>kit_name</code>, <code>kit_number</code>,
and <code>dispensed_quantity</code>.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_kit_description_df">kit_description_df</code></td>
<td>
<p>A data frame indicating the
drug and kit descriptions, including the following variables:
<code>drug</code>, <code>drug_name</code>, <code>kit</code>, and <code>kit_name</code>.
It must be specified at the design stage. It will be replaced with
the observed information at the analysis stage.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_treatment_by_drug_df">treatment_by_drug_df</code></td>
<td>
<p>A data frame indicating the treatments
associated with each drug, including the following variables:
<code>treatment</code> and <code>drug</code>.
It must be specified at the design stage. It will
be replaced with the observed information at the analysis stage.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_dosing_schedule_df">dosing_schedule_df</code></td>
<td>
<p>A data frame providing dosing schedule
information. It contains the following variables:
<code>kit</code>, <code>target_days</code>, <code>target_dose</code>, and
<code>max_cycles</code>. It must be provided.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_model_k0">model_k0</code></td>
<td>
<p>The model for the number of skipped
visits between randomization and the first drug dispensing visit.
Options include &quot;constant&quot;, &quot;poisson&quot;, &quot;zero-inflated poisson&quot;,
and &quot;negative binomial&quot;.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_model_t0">model_t0</code></td>
<td>
<p>The model for the gap time between randomization
and the first drug dispensing visit when there is no visit skipping.
Options include &quot;constant&quot;, &quot;exponential&quot;, &quot;weibull&quot;,
&quot;log-logistic&quot;, and &quot;log-normal&quot;.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_model_t1">model_t1</code></td>
<td>
<p>The model for the gap time between randomization
and the first drug dispensing visit when there is visit skipping.
Options include &quot;least squares&quot; and &quot;least absolute deviations&quot;.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_model_ki">model_ki</code></td>
<td>
<p>The model for the number of skipped
visits between two consecutive drug dispensing visits.
Options include &quot;constant&quot;, &quot;poisson&quot;, &quot;zero-inflated poisson&quot;,
and &quot;negative binomial&quot;.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_model_ti">model_ti</code></td>
<td>
<p>The model for the gap time between two consecutive
drug dispensing visits. Options include &quot;least squares&quot;
and &quot;least absolute deviations&quot;.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_model_di">model_di</code></td>
<td>
<p>The model for the dispensed doses at drug
dispensing visits. Options include &quot;constant&quot;,
&quot;linear model&quot;, and &quot;linear mixed-effects model&quot;.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_pilevel">pilevel</code></td>
<td>
<p>The prediction interval level.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_nyears">nyears</code></td>
<td>
<p>The number of years after the data cut for prediction.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_ncores_max">ncores_max</code></td>
<td>
<p>The maximum number of cores to use for parallel
computing. The actual number of cores used is the minimum of
<code>ncores_max</code> and half of the detected number of cores.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_pred_pp_only">pred_pp_only</code></td>
<td>
<p>A Boolean variable that controls whether or not
to make protocol-based predictions only.</p>
</td></tr>
<tr><td><code id="f_drug_demand_+3A_showplot">showplot</code></td>
<td>
<p>A Boolean variable that controls whether or not to
show the drug dispensing model fit and drug demand prediction
plots. It defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For design-stage drug demand forecasting, a list with the
following components:
</p>

<ul>
<li> <p><code>kit_description_df</code>: A data frame indicating the
drug and kit descriptions, including the following variables:
<code>drug</code>, <code>drug_name</code>, <code>kit</code>, and <code>kit_name</code>.
</p>
</li>
<li> <p><code>treatment_by_drug_df</code>: A data frame indicating the treatments
associated with each drug, including the following variables:
<code>treatment</code> and <code>drug</code>.
</p>
</li>
<li> <p><code>dosing_schedule_df</code>: A data frame providing dosing schedule
information. It contains the following variables:
<code>kit</code>, <code>target_days</code>, <code>target_dose</code>, and
<code>max_cycles</code>.
</p>
</li>
<li> <p><code>dosing_pred_df</code>: A data frame for dosing summary by kit type
and time point per protocol. It includes the following variables:
<code>kit</code>, <code>kit_name</code>, <code>t</code>, <code>n</code>, <code>pilevel</code>,
<code>lower</code>, <code>upper</code>, <code>mean</code>, <code>var</code>, and
<code>parameter</code>.
</p>
</li>
<li> <p><code>dosing_pred_plot</code>: A plot object for dosing prediction.
</p>
</li></ul>

<p>For analysis-stage drug demand forecasting, a list with the
following components:
</p>

<ul>
<li> <p><code>trialsdt</code>: The trial start date.
</p>
</li>
<li> <p><code>cutoffdt</code>: The cutoff date.
</p>
</li>
<li> <p><code>dosing_summary_t0</code>: A data frame for the cumulative doses
dispensed before the cutoff date. It contains the following
variables:
<code>kit</code>, <code>kit_name</code>, and <code>cum_dose_t0</code>.
</p>
</li>
<li> <p><code>cum_dispense_plot</code>: The step plot for the cumulative doses
dispensed for each kit type.
</p>
</li>
<li> <p><code>bar_t0_plot</code>: The bar chart for the time between
randomization and the first drug dispensing visit.
</p>
</li>
<li> <p><code>bar_ti_plot</code>: The bar chart for the gap time between two
consecutive drug dispensing visits.
</p>
</li>
<li> <p><code>bar_di_plot</code>: The bar chart for the doses dispensed at drug
dispensing visits.
</p>
</li>
<li> <p><code>common_time_model</code>: A Boolean variable that indicates
whether a common time model is used for drug dispensing visits.
</p>
</li>
<li> <p><code>k0_fit</code>: The model fit for the number of skipped
visits between randomization and the first drug dispensing visit.
</p>
</li>
<li> <p><code>t0_fit</code>: The model fit for the gap time between
randomization and the first drug dispensing visit when there is
no visit skipping.
</p>
</li>
<li> <p><code>t1_fit</code>: The model fit for the gap time between
randomization and the first drug dispensing visit when there is
visit skipping.
</p>
</li>
<li> <p><code>ki_fit</code>: The model fit for the number of skipped
visits between two consecutive drug dispensing visits.
</p>
</li>
<li> <p><code>ti_fit</code>: The model fit for the gap time between two
consecutive drug dispensing visits.
</p>
</li>
<li> <p><code>di_fit</code>: The model fit for the dispensed doses at drug
dispensing visits.
</p>
</li>
<li> <p><code>kit_description_df</code>: A data frame indicating the
drug and kit descriptions, including the following variables:
<code>drug</code>, <code>drug_name</code>, <code>kit</code>, and <code>kit_name</code>.
</p>
</li>
<li> <p><code>treatment_by_drug_df</code>: A data frame indicating the treatments
associated with each drug, including the following variables:
<code>treatment</code> and <code>drug</code>.
</p>
</li>
<li> <p><code>dosing_schedule_df</code>: A data frame providing dosing schedule
information. It contains the following variables:
<code>kit</code>, <code>target_days</code>, <code>target_dose</code>, and
<code>max_cycles</code>.
</p>
</li>
<li> <p><code>dosing_subject_df</code>: A data frame for the observed and imputed
subject-level dosing records for the first iteration. It includes
the following variables:
<code>drug</code>, <code>drug_name</code>, <code>kit</code>, <code>kit_name</code>,
<code>usubjid</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>arrivalTime</code>, <code>time</code>, <code>day</code>, <code>dose</code>,
<code>cum_dose</code>, <code>row_id</code>, <code>subject_type</code>, <code>imputed</code>,
<code>trialsdt</code>, <code>cutoffdt</code>, <code>randdt</code>, <code>adt</code>,
and <code>date</code>.
</p>
</li>
<li> <p><code>dosing_pred_df</code>: A data frame for dosing summary by kit type
and time point. It includes the following variables:
<code>kit</code>, <code>kit_name</code>, <code>t</code>, <code>n</code>, <code>pilevel</code>,
<code>lower</code>, <code>upper</code>, <code>mean</code>, <code>var</code>, <code>date</code>,
and <code>parameter</code>.
</p>
</li>
<li> <p><code>dosing_pred_plot</code>: A plot object for dosing prediction.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f_fit_t0">f_fit_t0</a></code>, <code><a href="#topic+f_fit_ki">f_fit_ki</a></code>,
<code><a href="#topic+f_fit_ti">f_fit_ti</a></code>, <code><a href="#topic+f_fit_di">f_fit_di</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(529)

pred &lt;- eventPred::getPrediction(
  df = df2,
  to_predict = "event only",
  target_d = 250,
  event_model = "log-logistic",
  dropout_model = "none",
  pilevel = 0.95,
  nyears = 1,
  nreps = 200,
  showplot = FALSE,
  by_treatment = TRUE)

drug_demand &lt;- f_drug_demand(
  df = df2,
  newEvents = pred$event_pred$newEvents,
  visitview = visitview2,
  dosing_schedule_df = dosing_schedule_df,
  model_k0 = "zero-inflated poisson",
  model_t0 = "log-logistic",
  model_t1 = "least squares",
  model_ki = "zero-inflated poisson",
  model_ti = "least squares",
  model_di = "linear mixed-effects model",
  pilevel = 0.95,
  nyears = 1,
  ncores_max = 2,
  showplot = FALSE)

drug_demand$dosing_pred_plot


</code></pre>

<hr>
<h2 id='f_fit_di'>Model Fitting for Dispensed Doses</h2><span id='topic+f_fit_di'></span>

<h3>Description</h3>

<p>Fits a linear mixed-effects model to the dispensed doses
at drug dispensing visits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_fit_di(df, model, nreps, showplot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_fit_di_+3A_df">df</code></td>
<td>
<p>The subject-level dosing data, including <code>usubjid</code>,
<code>day</code>, <code>kit</code>, and <code>dose</code>.</p>
</td></tr>
<tr><td><code id="f_fit_di_+3A_model">model</code></td>
<td>
<p>The model used to analyze the dispensed doses, with
options including &quot;constant&quot;, &quot;linear model&quot;, and
&quot;linear mixed-effects model&quot;.</p>
</td></tr>
<tr><td><code id="f_fit_di_+3A_nreps">nreps</code></td>
<td>
<p>The number of simulations for drawing posterior model
parameters.</p>
</td></tr>
<tr><td><code id="f_fit_di_+3A_showplot">showplot</code></td>
<td>
<p>A Boolean variable that controls whether or not to
show the fitted dose bar chart. It defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three components:
</p>

<ul>
<li> <p><code>fit</code>: A list of results from the model fit that includes
</p>

<ul>
<li> <p><code>model</code>: The specific model used in the analysis.
</p>
</li>
<li> <p><code>mud</code>: The estimated mean dose.
</p>
</li>
<li> <p><code>vmud</code>: The estimated variance of <code>mud</code>.
</p>
</li>
<li> <p><code>sigmab</code>: The estimated between-subject standard deviation.
</p>
</li>
<li> <p><code>sigmae</code>: The estimated within-subject residual standard
deviation.
</p>
</li>
<li> <p><code>aic</code>: The Akaike Information Criterion value.
</p>
</li>
<li> <p><code>bic</code>: The Bayesian Information Criterion value.
</p>
</li></ul>

</li>
<li> <p><code>fit_plot</code>: A fitted dose bar chart.
</p>
</li>
<li> <p><code>theta</code>: Posterior draws of model parameters.
</p>

<ul>
<li> <p><code>fixed</code>: Posterior draws of fixed model parameters:
<code>mud</code>, <code>sigmab</code>, and <code>sigmae</code>.
</p>
</li>
<li> <p><code>random</code>: Posterior draws of subject random effects.
</p>
</li>
<li> <p><code>usubjid</code>: The unique subject ID associated with
the subject random effects.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

observed &lt;- f_dose_observed(df2, visitview2, showplot = FALSE)
vf &lt;- observed$vf

vf1 &lt;- vf %&gt;% filter(kit == 3)
di_fit &lt;- f_fit_di(vf1, model = "linear mixed-effects model", nreps = 200)

</code></pre>

<hr>
<h2 id='f_fit_ki'>Model Fitting for Number of Skipped Visits</h2><span id='topic+f_fit_ki'></span>

<h3>Description</h3>

<p>Fits a count model to the number of skipped visits
between two consecutive drug dispensing visits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_fit_ki(df, model, nreps, showplot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_fit_ki_+3A_df">df</code></td>
<td>
<p>The subject-level dosing data, including <code>skipped</code> to
indicate the number of skipped visits.</p>
</td></tr>
<tr><td><code id="f_fit_ki_+3A_model">model</code></td>
<td>
<p>The count model used to analyze the number of
skipped visits, with options including
&quot;constant&quot;, &quot;poisson&quot;, &quot;zero-inflated poisson&quot;, and
&quot;negative binomial&quot;.</p>
</td></tr>
<tr><td><code id="f_fit_ki_+3A_nreps">nreps</code></td>
<td>
<p>The number of simulations for drawing posterior model
parameter values.</p>
</td></tr>
<tr><td><code id="f_fit_ki_+3A_showplot">showplot</code></td>
<td>
<p>A Boolean variable that controls whether or not to
show the fitted count bar chart. It defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three components:
</p>

<ul>
<li> <p><code>fit</code>: A list of results from the model fit that includes
</p>

<ul>
<li> <p><code>model</code>: The specific model used in the analysis.
</p>
</li>
<li> <p><code>theta</code>: The estimated model parameters.
</p>
</li>
<li> <p><code>vtheta</code>: The estimated covariance matrix of <code>theta</code>.
</p>
</li>
<li> <p><code>aic</code>: The Akaike Information Criterion value.
</p>
</li>
<li> <p><code>bic</code>: The Bayesian Information Criterion value.
</p>
</li></ul>

</li>
<li> <p><code>fit_plot</code>: A fitted count bar chart.
</p>
</li>
<li> <p><code>theta</code>: Posterior draws of model parameters.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

observed &lt;- f_dose_observed(df2, visitview2, showplot = FALSE)
vf &lt;- observed$vf

vf &lt;- vf %&gt;% left_join(dosing_schedule_df, by = "kit")

df_ti &lt;- vf %&gt;%
  mutate(time = lead(day) - day,
         skipped = pmax(floor((time - target_days/2)/target_days), 0),
         k1 = skipped + 1) %&gt;%
  filter(row_id &lt; n())

ki_fit &lt;- f_fit_ki(df_ti, model = "zero-inflated poisson", nreps = 200)

</code></pre>

<hr>
<h2 id='f_fit_t0'>Model Fitting for Dispensing Delay After Randomization</h2><span id='topic+f_fit_t0'></span>

<h3>Description</h3>

<p>Fits a specified time-to-event model to the gap time
between randomization and the first drug dispensing visit when
there is no visit skipping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_fit_t0(df, model, nreps, showplot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_fit_t0_+3A_df">df</code></td>
<td>
<p>The subject-level dosing data, including the following
variables:
</p>

<ul>
<li> <p><code>time</code>: The number of days between randomization and the
first drug dispensing visit (first drug dispensing visit date -
randomization date + 1).
</p>
</li>
<li> <p><code>left</code>: Equals <code>time - 1</code>, used to indicate the
left endpoint of an interval for interval censoring.
</p>
</li>
<li> <p><code>right</code>: Equals <code>time</code>, used to indicate the
right endpoint of an interval for interval censoring.
</p>
</li></ul>
</td></tr>
<tr><td><code id="f_fit_t0_+3A_model">model</code></td>
<td>
<p>The event model used to analyze the gap time
between randomization and the first drug dispensing visit when
there is no visit skipping, with options including &quot;constant&quot;,
&quot;exponential&quot;, &quot;weibull&quot;, &quot;log-logistic&quot;, and &quot;log-normal&quot;.</p>
</td></tr>
<tr><td><code id="f_fit_t0_+3A_nreps">nreps</code></td>
<td>
<p>The number of simulations for drawing posterior model
parameter values.</p>
</td></tr>
<tr><td><code id="f_fit_t0_+3A_showplot">showplot</code></td>
<td>
<p>A Boolean variable that controls whether or not to
show the fitted time-to-event bar chart. It defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three components:
</p>

<ul>
<li> <p><code>fit</code>: A list of results from the model fit that includes
</p>

<ul>
<li> <p><code>model</code>: The specific model used in the analysis.
</p>
</li>
<li> <p><code>theta</code>: The estimated model parameters.
</p>
</li>
<li> <p><code>vtheta</code>: The estimated covariance matrix of <code>theta</code>.
</p>
</li>
<li> <p><code>aic</code>: The Akaike Information Criterion value.
</p>
</li>
<li> <p><code>bic</code>: The Bayesian Information Criterion value.
</p>
</li></ul>

</li>
<li> <p><code>fit_plot</code>: A fitted time-to-event bar chart.
</p>
</li>
<li> <p><code>theta</code>: Posterior draws of model parameters.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

observed &lt;- f_dose_observed(df2, visitview2, showplot = FALSE)
vf &lt;- observed$vf

vf &lt;- vf %&gt;% left_join(dosing_schedule_df, by = "kit")

# time from randomization to the first drug dispensing visit
df_k0 &lt;- vf %&gt;%
  filter(row_id == 1) %&gt;%
  mutate(time = day,
         skipped = floor((time - target_days/2)/target_days) + 1)

# no skipping
df_t0 &lt;- df_k0 %&gt;%
  filter(skipped == 0) %&gt;%
  mutate(left = time - 1, right = time)

t0_fit &lt;- f_fit_t0(df_t0, model = "log-logistic", nreps = 200)

</code></pre>

<hr>
<h2 id='f_fit_ti'>Model Fitting for Gap Times</h2><span id='topic+f_fit_ti'></span>

<h3>Description</h3>

<p>Fits a linear regression model to the gap time
between two consecutive drug dispensing visits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_fit_ti(df, model, nreps, showplot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_fit_ti_+3A_df">df</code></td>
<td>
<p>The subject-level dosing data, including the following
variables:
</p>

<ul>
<li> <p><code>time</code>: The gap time to the next drug dispensing visit.
</p>
</li>
<li> <p><code>skipped</code>: The number of skipped visits.
</p>
</li>
<li> <p><code>k1</code>: The covariate for the linear regression. It equals
<code>skipped</code> for the gap time between randomization and
the first drug dispensing visit and <code>skipped + 1</code>
for the gap time between two consecutive drug dispensing visits.
</p>
</li></ul>
</td></tr>
<tr><td><code id="f_fit_ti_+3A_model">model</code></td>
<td>
<p>The model used to analyze the gap time. Options include
&quot;least squares&quot; and &quot;least absolute deviations&quot;.</p>
</td></tr>
<tr><td><code id="f_fit_ti_+3A_nreps">nreps</code></td>
<td>
<p>The number of simulations for drawing posterior model
parameter values.</p>
</td></tr>
<tr><td><code id="f_fit_ti_+3A_showplot">showplot</code></td>
<td>
<p>A Boolean variable that controls whether or not to
show the fitted gap time bar chart. It defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three components:
</p>

<ul>
<li> <p><code>fit</code>: A list of results from the model fit that includes
</p>

<ul>
<li> <p><code>model</code>: The specific model used in the analysis.
</p>
</li>
<li> <p><code>beta</code>: The estimated regression coefficient for the covariate.
</p>
</li>
<li> <p><code>vbeta</code>: The estimated variance of <code>beta</code>.
</p>
</li>
<li> <p><code>sigma</code>: The estimated residual standard deviation.
</p>
</li>
<li> <p><code>df</code>: The residual degrees-of-freedom.
</p>
</li>
<li> <p><code>aic</code>: The Akaike Information Criterion value.
</p>
</li>
<li> <p><code>bic</code>: The Bayesian Information Criterion value.
</p>
</li></ul>

</li>
<li> <p><code>fit_plot</code>: A fitted gap time bar chart.
</p>
</li>
<li> <p><code>theta</code>: Posterior draws of model parameters.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

observed &lt;- f_dose_observed(df2, visitview2, showplot = FALSE)
vf &lt;- observed$vf

vf &lt;- vf %&gt;% left_join(dosing_schedule_df, by = "kit")

df_ti &lt;- vf %&gt;%
  mutate(time = lead(day) - day,
         skipped = pmax(floor((time - target_days/2)/target_days), 0),
         k1 = skipped + 1) %&gt;%
  filter(row_id &lt; n())

ti_fit &lt;- f_fit_ti(df_ti, model = "least squares", nreps = 200)

</code></pre>

<hr>
<h2 id='f_ongoing_new'>Observed Dosing for Ongoing and New Subjects</h2><span id='topic+f_ongoing_new'></span>

<h3>Description</h3>

<p>Prepares the dosing data sets to impute for ongoing and
new subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_ongoing_new(newEvents, kit_description_df, treatment_by_drug_df, vf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_ongoing_new_+3A_newevents">newEvents</code></td>
<td>
<p>A data frame containing the imputed event data
for both ongoing and new patients, typically obtained from
the output of the <code>getPrediction</code> function of the
<code>eventPred</code> package. It contains the following variables:
<code>draw</code>, <code>usubjid</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, <code>event</code>,
<code>dropout</code>, and <code>totalTime</code>.</p>
</td></tr>
<tr><td><code id="f_ongoing_new_+3A_kit_description_df">kit_description_df</code></td>
<td>
<p>A data frame indicating the
drug and kit descriptions, including the following variables:
<code>drug</code>, <code>drug_name</code>, <code>kit</code>, and <code>kit_name</code>.
It must be specified at the design stage. It will be replaced with
the observed information at the analysis stage.</p>
</td></tr>
<tr><td><code id="f_ongoing_new_+3A_treatment_by_drug_df">treatment_by_drug_df</code></td>
<td>
<p>A data frame indicating the treatments
associated with each drug, including the following variables:
<code>treatment</code> and <code>drug</code>.</p>
</td></tr>
<tr><td><code id="f_ongoing_new_+3A_vf">vf</code></td>
<td>
<p>A data frame for subject-level drug dispensing data,
including the following variables:
<code>drug</code>, <code>drug_name</code>, <code>kit</code>, <code>kit_name</code>,
<code>usubjid</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>arrivalTime</code>, <code>time</code>, <code>event</code>, <code>dropout</code>,
<code>day</code>, <code>dose</code>, <code>cum_dose</code>, and <code>row_id</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>vf_ongoing</code>: A data frame for the observed drug dispensing
data for ongoing patients with drug dispensing records.
It includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>day</code>, <code>dose</code>, <code>arrivalTime</code>, <code>treatment</code>,
<code>treatment_description</code>, <code>time</code>, and <code>totalTime</code>.
</p>
</li>
<li> <p><code>vf_new</code>: A data frame for the randomization date for new
patients and ongoing patients with no drug dispensing records.
It includes the following variables:
<code>draw</code>, <code>kit</code>, <code>kit_name</code>, <code>usubjid</code>,
<code>arrivalTime</code>, <code>treatment</code>, <code>treatment_description</code>,
<code>time</code>, and <code>totalTime</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(2000)

pred &lt;- eventPred::getPrediction(
  df = df2,
  to_predict = "event only",
  target_d = 250,
  event_model = "log-logistic",
  dropout_model = "none",
  pilevel = 0.95,
  nyears = 1,
  nreps = 200,
  showplot = FALSE,
  by_treatment = TRUE)

observed &lt;- f_dose_observed(df = df2, visitview = visitview2)

vf_ongoing_new &lt;- f_ongoing_new(
  pred$event_pred$newEvents,
  observed$kit_description_df,
  observed$treatment_by_drug_df,
  observed$vf)

head(vf_ongoing_new$vf_ongoing)
head(vf_ongoing_new$vf_new)


</code></pre>

<hr>
<h2 id='kit_description_df'>The kit description data frame.</h2><span id='topic+kit_description_df'></span>

<h3>Description</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt><code>drug</code></dt><dd><p>The numeric code of the drug.</p>
</dd>
<dt><code>drug_name</code></dt><dd><p>The name of the drug.</p>
</dd>
<dt><code>kit</code></dt><dd><p>The numeric code of the kit type.</p>
</dd>
<dt><code>kit_name</code></dt><dd><p>The name of the kit type.</p>
</dd>
<dt><code>p_kit</code></dt><dd><p>The prior probability of different kit types
within a drug.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>kit_description_df
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 4 rows and 5 columns.
</p>

<hr>
<h2 id='rdirichlet'>Random Number Generator for the Dirichlet Distribution</h2><span id='topic+rdirichlet'></span>

<h3>Description</h3>

<p>Generates cell probabilities from the Dirichlet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdirichlet(n = 1, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdirichlet_+3A_n">n</code></td>
<td>
<p>The number of observations.</p>
</td></tr>
<tr><td><code id="rdirichlet_+3A_alpha">alpha</code></td>
<td>
<p>The shape parameters of the Dirichlet distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of n rows and k columns, where n is the number of
observations and k is the number of cells.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rdirichlet(2, c(50, 20, 30))

</code></pre>

<hr>
<h2 id='treatment_by_drug_df'>The data frame indicating the treatments associated with each drug.</h2><span id='topic+treatment_by_drug_df'></span>

<h3>Description</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt><code>treatment</code></dt><dd><p>The numeric code of the treatment group.</p>
</dd>
<dt><code>drug</code></dt><dd><p>The numeric code of the drug.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>treatment_by_drug_df
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 6 rows and 2 columns.
</p>

<hr>
<h2 id='visitview1'>The observed subject drug dispensing data before enrollment completion.</h2><span id='topic+visitview1'></span>

<h3>Description</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt><code>usubjid</code></dt><dd><p>The unique subject ID.</p>
</dd>
<dt><code>visit</code></dt><dd><p>The drug dispensing visit, e.g., &quot;Cycle 1 Day 1&quot;.</p>
</dd>
<dt><code>date</code></dt><dd><p>The date of the drug dispensing visit.</p>
</dd>
<dt><code>drug</code></dt><dd><p>The numeric code of the drug.</p>
</dd>
<dt><code>drug_name</code></dt><dd><p>The name of the drug.</p>
</dd>
<dt><code>kit</code></dt><dd><p>The numeric code of the kit type.</p>
</dd>
<dt><code>kit_name</code></dt><dd><p>The name of the kit type.</p>
</dd>
<dt><code>kit_number</code></dt><dd><p>The kit number for drug dispensing.</p>
</dd>
<dt><code>dispensed_quantity</code></dt><dd><p>The number of kits dispensed
at the visit.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>visitview1
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 2290 rows and 9 columns.
</p>

<hr>
<h2 id='visitview2'>The observed subject drug dispensing data after enrollment completion.</h2><span id='topic+visitview2'></span>

<h3>Description</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt><code>usubjid</code></dt><dd><p>The unique subject ID.</p>
</dd>
<dt><code>visit</code></dt><dd><p>The drug dispensing visit, e.g., &quot;Cycle 1 Day 1&quot;.</p>
</dd>
<dt><code>date</code></dt><dd><p>The date of the drug dispensing visit.</p>
</dd>
<dt><code>drug</code></dt><dd><p>The numeric code of the drug.</p>
</dd>
<dt><code>drug_name</code></dt><dd><p>The name of the drug.</p>
</dd>
<dt><code>kit</code></dt><dd><p>The numeric code of the kit type.</p>
</dd>
<dt><code>kit_name</code></dt><dd><p>The name of the kit type.</p>
</dd>
<dt><code>kit_number</code></dt><dd><p>The kit number for drug dispensing.</p>
</dd>
<dt><code>dispensed_quantity</code></dt><dd><p>The number of kits dispensed
at the visit.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>visitview2
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 5006 rows and 9 columns.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
