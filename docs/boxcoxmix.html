<!DOCTYPE html><html><head><title>Help for package boxcoxmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {boxcoxmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boxcoxmix-package'><p>Box-Cox-Type Transformations for Linear and Logistic Models with Random Effects</p></a></li>
<li><a href='#boxcoxtype'><p>Box-Cox-type link function for logistic mixed-effects Models</p></a></li>
<li><a href='#Kfind.boxcox'><p>Grid search over K for NPML estimation of random effect and variance component models</p></a></li>
<li><a href='#np.boxcox'><p>Internal boxcoxmix functions</p></a></li>
<li><a href='#np.boxcoxmix'><p>Response Transformations for Random Effect and Variance Component Models</p></a></li>
<li><a href='#optim.boxcox'><p>Response Transformations for Random Effect and Variance Component Models</p></a></li>
<li><a href='#plot.boxcoxmix'><p>Plot diagnostics for boxcoxmix functions</p></a></li>
<li><a href='#print.boxcoxmix'><p>Summary of boxcoxmix functions</p></a></li>
<li><a href='#tolfind.boxcox'><p>Grid search over tol for NPPML estimation of random effect and variance component models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.42</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Box-Cox-type transformations for linear and logistic models with random effects using non-parametric profile maximum likelihood estimation, as introduced in Almohaimeed (2018) <a href="http://etheses.dur.ac.uk/12831/">http://etheses.dur.ac.uk/12831/</a> and Almohaimeed and Einbeck (2022) &lt;<a href="https://doi.org/10.1177%2F1471082X20966919">doi:10.1177/1471082X20966919</a>&gt;. The main functions are 'optim.boxcox()' for linear models with random effects and 'boxcoxtype()' for logistic models with random effects.</td>
</tr>
<tr>
<td>Title:</td>
<td>Box-Cox-Type Transformations for Linear and Logistic Models with
Random Effects</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-20</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>statmod(&ge; 1.4.27), qicharts(&ge; 0.5.4), npmlreg(&ge; 0.46-1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>nlme, mdscore, flexmix, utils</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/iagogv/boxcoxmix">https://gitlab.com/iagogv/boxcoxmix</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.com/iagogv/boxcoxmix/-/issues">https://gitlab.com/iagogv/boxcoxmix/-/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>utils</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-20 01:31:28 UTC; iago</td>
</tr>
<tr>
<td>Author:</td>
<td>Iago Giné-Vázquez <a href="https://orcid.org/0000-0002-6725-2638"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre],
  Amani Almohaimeed [aut],
  Jochen Einbeck [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Iago Giné-Vázquez &lt;iago.gin-vaz@protonmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-21 11:40:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='boxcoxmix-package'>Box-Cox-Type Transformations for Linear and Logistic Models with Random Effects</h2><span id='topic+boxcoxmix-package'></span><span id='topic+boxcoxmix'></span>

<h3>Description</h3>

<p>Box-Cox-type transformations for linear and logistic models with
random effects using non-parametric profile maximum likelihood
estimation. The main functions are <code>optim.boxcox()</code> for linear models with
random effects and <code>boxcoxtype()</code> for logistic models with
random effects.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> boxcoxmix</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
0.28</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2020-09-17</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL (&gt;=3)</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>References</h3>

<p>Box G. and Cox D. (1964). An analysis of transformations. Journal of
the Royal Statistical Society. Series B (Methodological), pages 211-252.
</p>
<p>Aitkin, M. A., Francis, B., Hinde, J., and Darnell, R. (2009). Statistical
modelling in R. Oxford University Press Oxford.
</p>
<p>Jochen Einbeck, Ross Darnell and John Hinde (2014). npmlreg:
Nonparametric maximum likelihood estimation for random effect
models. R package version 0.46-1.
</p>
<p>R Core Team (2016). R: A language and environment for
statistical computing. R Foundation for Statistical Computing,
Vienna, Austria. URL https://www.R-project.org/.
</p>
<p>Maintainer: Amani Almohaimeed &lt;amani.almohaimeed@gmail.com&gt;
</p>

<hr>
<h2 id='boxcoxtype'>Box-Cox-type link function for logistic mixed-effects Models</h2><span id='topic+boxcoxtype'></span><span id='topic+boxcoxpower'></span><span id='topic+binomial'></span>

<h3>Description</h3>

<p>The <code>boxcoxtype()</code> performs a grid search over the parameter <code>Lambda</code>
for logistic mixed-effects models and then optimizes over this grid,
to calculate the maximum likelihood estimator of the transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxcoxtype(
  formula,
  random = ~1,
  k = 3,
  trials = 1,
  data,
  find.in.range = c(-2, 2),
  s = 20,
  plot.opt = 1,
  random.distribution = "np",
  ...
)

boxcoxpower(Lambda = 0)

binomial(link = boxcoxpower(0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxcoxtype_+3A_formula">formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_random">random</code></td>
<td>
<p>a formula defining the random model. Set <code>random= ~1</code> to model
logistic-type overdispersion model. For a two-level logistic-type model,
set <code>random= ~1|groups</code>, where groups are at the upper level.</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_k">k</code></td>
<td>
<p>the number of mass points.</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_trials">trials</code></td>
<td>
<p>optional prior weights for the data. For Bernoulli distribution, set trials=1.</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_data">data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_find.in.range">find.in.range</code></td>
<td>
<p>search in a range of <code>Lambda</code>, with default (-2,2)
in step of 0.1.</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_s">s</code></td>
<td>
<p>number of points in the grid search of <code>Lambda</code>.</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_plot.opt">plot.opt</code></td>
<td>
<p>Set <code>plot.opt=1</code>, to plot the profile log-likelihood against <code>Lambda</code>.
if <code>plot.opt=0</code>, no plot is printed.</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_random.distribution">random.distribution</code></td>
<td>
<p>the mixing distribution, Gaussian Quadrature (gq) or NPML (np) can be set.</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_...">...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_lambda">Lambda</code></td>
<td>
<p>the power of the transformation</p>
</td></tr>
<tr><td><code id="boxcoxtype_+3A_link">link</code></td>
<td>
<p>the link function to be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Box-Cox transformation (Box &amp; Cox, 1964) is applied to the
logistic mixed-effects models with an unspecified
mixing distribution. The NPML estimate of the mixing distribution is known
to be a discrete distribution involving a finite number of mass-points and corresponding
masses (Aitkin et al., 2009). An Expectation-Maximization (EM) algorithm is
used for fitting the finite mixture distribution, one needs to specify the
number of components <code>k</code> of the finite mixture in advance.
This algorithm can be implemented using the npmlreg function <code>alldist</code>
for the logistic-type overdispersion model and the npmlreg function <code>allvc</code> for the 
two-level logistic-type model, setting <code>family = binomial(link = boxcoxpower(Lambda))</code> where 
<code>Lambda</code> is the value of the power transformation. When <code>k</code>=1, the npmlreg function <code>alldist()</code> 
fits the logistic regression model without random effects. 
</p>
<p><code>boxcoxtype()</code> performs a grid search over the parameter <code>Lambda</code> and then
optimizes over this grid, to calculate the maximum likelihood estimator of the transformation.
It produces a plot of the profile likelihood function that summarises information
concerning <code>Lambda</code>, including a vertical line indicating the best value of <code>Lambda</code>
that maximizes the profile log-likelihood.
</p>


<h3>Value</h3>

<p>List with class <code>boxcoxmix</code> containing:
</p>
<table>
<tr><td><code>Maximum</code></td>
<td>
<p>the best estimate of <code>Lambda</code> found.</p>
</td></tr> <tr><td><code>objective</code></td>
<td>
<p>the value of the profile
log-likelihood corresponding to Maximum.</p>
</td></tr> 
<tr><td><code>coef</code></td>
<td>
<p>the vector of coefficients.</p>
</td></tr> 
<tr><td><code>profile.loglik</code></td>
<td>
<p>the profile log-likelihood of the fitted regression model.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>the fitted alldist object from the last EM iteration.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>the Akaike information criterion of the fitted regression model.</p>
</td></tr> 
<tr><td><code>bic</code></td>
<td>
<p>the Bayesian information criterion of the fitted regression model.</p>
</td></tr>
</table>
<p>The other outcomes are not relevant to users and they are intended for internal use only.
</p>


<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>References</h3>

<p>Box G. and Cox D. (1964). An analysis of transformations. Journal of
the Royal Statistical Society. Series B (Methodological), pages 211-252.
</p>
<p>Aitkin, M. A., Francis, B., Hinde, J., and Darnell, R. (2009). Statistical
modelling in R. Oxford University Press Oxford.
</p>
<p>Jochen Einbeck, Ross Darnell and John Hinde (2014). npmlreg:
Nonparametric maximum likelihood estimation for random effect
models. R package version 0.46-1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+np.boxcoxmix">np.boxcoxmix</a></code>, <code><a href="#topic+optim.boxcox">optim.boxcox</a></code>,
<code><a href="#topic+tolfind.boxcox">tolfind.boxcox</a></code>, <code><a href="#topic+Kfind.boxcox">Kfind.boxcox</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Beta blockers data
data("betablocker", package = "flexmix")
library(npmlreg)
betavc &lt;-allvc(cbind(Deaths, Total - Deaths) ~ Treatment, data = betablocker,random=~1|Center,
 k=3,random.distribution='np',family = binomial(link = boxcoxpower(0)))
betavc$disparity
#[1] 318.7211
betavc3 &lt;-boxcoxtype(cbind(Deaths, Total - Deaths) ~ Treatment,random=~1|Center, 
data = betablocker, find.in.range = c(-2,0.4),s=40,k=3,random.distribution='np')
#Maximum Profile Log-likelihood: -158.6025 at lambda= -0.56
betavc3$fit$disparity
#[1] 317.2049
betavc3$aic
#[1] 331.2049
betavc3$bic
#[1] 343.6942

</code></pre>

<hr>
<h2 id='Kfind.boxcox'>Grid search over K for NPML estimation of random effect and variance component models</h2><span id='topic+Kfind.boxcox'></span>

<h3>Description</h3>

<p>A grid search over the parameter <code>K</code>, to set the best number of
mass-points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kfind.boxcox(
  formula,
  groups = 1,
  data,
  lambda = 1,
  EMdev.change = 1e-04,
  steps = 500,
  find.k = c(2, 10),
  model.selection = "aic",
  start = "gq",
  find.tol = c(0, 1.5),
  steps.tol = 15,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kfind.boxcox_+3A_formula">formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_groups">groups</code></td>
<td>
<p>the random effects. To fit overdispersion models , set <code>groups</code> = 1.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_data">data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_lambda">lambda</code></td>
<td>
<p>a transformation parameter, setting <code>lambda</code>=1 means 'no
transformation'.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_emdev.change">EMdev.change</code></td>
<td>
<p>a small scalar, with default 0.0001, used to determine
when to stop EM algorithm.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_steps">steps</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_find.k">find.k</code></td>
<td>
<p>search in a range of <code>K</code>, with default (2,10)
in step of 1.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_model.selection">model.selection</code></td>
<td>
<p>Set <code>model.selection="aic"</code>, to use Akaike information criterion 
as model selection criterion or <code>model.selection="bic"</code>, to use Bayesian information criterion 
as model selection criterion.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_start">start</code></td>
<td>
<p>a description of the initial values to be used in the fitted
model, Quantile-based version &quot;quantile&quot; or Gaussian Quadrature &quot;gq&quot; can be
set.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_find.tol">find.tol</code></td>
<td>
<p>search in a range of <code>tol</code>, with default (0,1.5)
in step of 1.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_steps.tol">steps.tol</code></td>
<td>
<p>number of points in the grid search of <code>tol</code>.</p>
</td></tr>
<tr><td><code id="Kfind.boxcox_+3A_...">...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Not only the shape of the distribution causes the skewness it may due to the use of an 
insufficient number of classes, <code>K</code>. For this, the <code>Kfind.boxcox()</code> function 
was created to search over a selected range of <code>K</code> and find the best. For each number
of classes, a grid search over <code>tol</code> is performed and the <code>tol</code> with the lowest 
<code>aic</code> or <code>bic</code> value is considered as the optimal. Having the minimal <code>aic</code> or <code>bic</code> values for a whole range of
<code>K</code> that have been specified beforehand, the <code>Kfind.boxcox()</code> function can find 
the best number of the component as the one with the smallest value. It also plots the <code>aic</code> or <code>bic</code> values against
the selected range of <code>K</code>, including a vertical line indicating the best value of <code>K</code>
that minimizes the model selection criteria. The full range of 
classes and their corresponding optimal <code>tol</code> can be printed off from the <code>Kfind.boxcox()</code>'s
output and used with other <span class="pkg">boxcoxmix</span> functions as starting points.
</p>


<h3>Value</h3>

<p>List with class <code>boxcoxmix</code> containing:
</p>
<table>
<tr><td><code>MinDisparity</code></td>
<td>
<p>the minimum disparity found.</p>
</td></tr> <tr><td><code>Best.K</code></td>
<td>
<p>the
value of <code>K</code> corresponding to <code>MinDisparity</code>.</p>
</td></tr>
<tr><td><code>AllMinDisparities</code></td>
<td>
<p>a vector containing all minimum disparities calculated on the
grid.</p>
</td></tr> <tr><td><code>AllMintol</code></td>
<td>
<p>list of <code>tol</code> values used in the grid.</p>
</td></tr>
<tr><td><code>All.K</code></td>
<td>
<p>list of <code>K</code> values used in the grid.</p>
</td></tr>
<tr><td><code>All.aic</code></td>
<td>
<p>the Akaike information criterion of all fitted regression models.</p>
</td></tr>
<tr><td><code>All.bic</code></td>
<td>
<p>the Bayesian information criterion of all fitted regression models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tolfind.boxcox">tolfind.boxcox</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fabric data
data(fabric, package = "npmlreg")
teststr&lt;-Kfind.boxcox(y ~ x, data = fabric,  start = "gq", groups=1, 
find.k = c(2, 3), model.selection = "aic", steps.tol=5)
# Minimal AIC: 202.2114 at K= 2 









</code></pre>

<hr>
<h2 id='np.boxcox'>Internal boxcoxmix functions</h2><span id='topic+np.boxcox'></span><span id='topic+vc.boxcox'></span><span id='topic+np.estep'></span><span id='topic+np.zk'></span><span id='topic+fik'></span><span id='topic+yhat'></span><span id='topic+ytrans'></span><span id='topic+np.bhat'></span><span id='topic+nb.se'></span><span id='topic+np.mstep'></span><span id='topic+np.em'></span><span id='topic+vc.estep'></span><span id='topic+bhat'></span><span id='topic+vc.se'></span><span id='topic+mik'></span><span id='topic+vc.mstep'></span><span id='topic+vc.em'></span><span id='topic+gqz'></span><span id='topic+np.theta'></span><span id='topic+vc.theta'></span><span id='topic+zk'></span><span id='topic+masspoint.class'></span>

<h3>Description</h3>

<p>auxiliary functions are not intended to be directly called from the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np.boxcox(
  formula,
  groups = 1,
  data,
  K = 3,
  tol = 0.5,
  lambda = 1,
  steps = 500,
  EMdev.change = 1e-04,
  plot.opt = 1,
  verbose = TRUE,
  start = "gq",
  ...
)

vc.boxcox(
  formula,
  groups = 1,
  data,
  K = 3,
  tol = 0.5,
  lambda = 1,
  steps = 500,
  EMdev.change = 1e-04,
  plot.opt = 1,
  verbose = TRUE,
  start = "gq",
  ...
)

np.em(
  y,
  x,
  K,
  lambda = 1,
  steps = 500,
  tol = 0.5,
  start = "gq",
  EMdev.change = 1e-04,
  plot.opt = 1,
  verbose = TRUE,
  ...
)

vc.em(
  y,
  x,
  sizes = 1,
  K,
  lambda,
  steps = 500,
  tol = 0.5,
  start = "gq",
  EMdev.change = 1e-04,
  plot.opt = 1,
  verbose = TRUE,
  ...
)

np.estep(y, x, lambda, p, beta, z, sigma)

vc.estep(Y, X, sizes = 1, lambda, p, beta, z, sigma)

np.mstep(y, x, beta, lambda, w)

vc.mstep(Y, X, sizes = 1, beta, lambda, w)

np.theta(y, x, lambda, beta, z)

vc.theta(Y, X, sizes, lambda, beta, z)

np.bhat(y, x, w, z, lambda)

bhat(Y, X, sizes, w, z, lambda)

np.zk(y, x, w, beta, lambda)

zk(Y, X, sizes, w, beta, lambda)

fik(y, x, lambda, beta, z, sigma)

mik(Y, X, sizes, lambda, beta, z, sigma)

yhat(v, lambda = 1)

ytrans(y, lambda = 1)

gqz(numnodes = 20, minweight = 1e-06)

masspoint.class(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="np.boxcox_+3A_formula">formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_groups">groups</code></td>
<td>
<p>the random effects. To fit overdispersion models , set <code>groups</code> = 1.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_data">data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_k">K</code></td>
<td>
<p>the number of mass points.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_tol">tol</code></td>
<td>
<p>a positive scalar (usually, 0&lt; <code>tol</code> &lt;= 2)</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_lambda">lambda</code></td>
<td>
<p>a transformation parameter, setting <code>lambda</code>=1 means 'no
transformation'.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_steps">steps</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_emdev.change">EMdev.change</code></td>
<td>
<p>a small scalar, with default 0.0001, used to determine
when to stop EM algorithm.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_plot.opt">plot.opt</code></td>
<td>
<p>Set plot.opt=1, to plot the disparity against
iteration number. Use <code>plot.opt=2</code> for <code>tolfind.boxcox</code> and <code>plot.opt=3</code>
for <code>optim.boxcox</code>.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_verbose">verbose</code></td>
<td>
<p>If set to FALSE, no printed output on progress.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_start">start</code></td>
<td>
<p>a description of the initial values to be used in the fitted
model, Quantile-based version &quot;quantile&quot; or Gaussian Quadrature &quot;gq&quot; can be
set.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_...">...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_y">y</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_x">x</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_sizes">sizes</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_p">p</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_beta">beta</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_z">z</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_sigma">sigma</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_y">Y</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_x">X</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_w">w</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_v">v</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_numnodes">numnodes</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_minweight">minweight</code></td>
<td>
<p>..</p>
</td></tr>
<tr><td><code id="np.boxcox_+3A_object">object</code></td>
<td>
<p>..</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>

<hr>
<h2 id='np.boxcoxmix'>Response Transformations for Random Effect and Variance Component Models</h2><span id='topic+np.boxcoxmix'></span>

<h3>Description</h3>

<p>The function <code>np.boxcoxmix()</code> fits an overdispersed generalized linear model
and variance component models using nonparametric profile maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np.boxcoxmix(
  formula,
  groups = 1,
  data,
  K = 3,
  tol = 0.5,
  lambda = 1,
  steps = 500,
  EMdev.change = 1e-04,
  plot.opt = 1,
  verbose = TRUE,
  start = "gq",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="np.boxcoxmix_+3A_formula">formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_groups">groups</code></td>
<td>
<p>the random effects. To fit overdispersion models , set <code>groups</code> = 1.</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_data">data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_k">K</code></td>
<td>
<p>the number of mass points.</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_tol">tol</code></td>
<td>
<p>a positive scalar (usually, 0&lt; <code>tol</code> &lt;= 2)</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_lambda">lambda</code></td>
<td>
<p>a transformation parameter, setting <code>lambda</code>=1 means 'no
transformation'.</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_steps">steps</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_emdev.change">EMdev.change</code></td>
<td>
<p>a small scalar, with default 0.0001, used to determine
when to stop EM algorithm.</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_plot.opt">plot.opt</code></td>
<td>
<p>Set <code>plot.opt=1</code>, to plot the disparity against
iteration number. Use <code>plot.opt=2</code> for <code>tolfind.boxcox()</code> and <code>plot.opt=3</code>
for <code>optim.boxcox()</code>.</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_verbose">verbose</code></td>
<td>
<p>If set to FALSE, no printed output on progress.</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_start">start</code></td>
<td>
<p>a description of the initial values to be used in the fitted
model, Quantile-based version &quot;quantile&quot; or Gaussian Quadrature &quot;gq&quot; can be
set.</p>
</td></tr>
<tr><td><code id="np.boxcoxmix_+3A_...">...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Box-Cox transformation (Box &amp; Cox, 1964) is applied to the overdispersed
generalized linear models and variance component models with an unspecified
mixing distribution. The NPML estimate of the mixing distribution is known
to be a discrete distribution involving a finite number of mass-points and corresponding
masses (Aitkin et al., 2009). An Expectation-Maximization (EM) algorithm is
used for fitting the finite mixture distribution, one needs to specify the
number of components <code>K</code> of the finite mixture in advance. To stop the EM-algorithm
when it reached its convergence point, we need to defined the convergence criteria that is 
the absolute change in the successive log-likelihood function values being less than an arbitrary 
parameter such as <code>EMdev.change</code> = 0.0001 (Einbeck et at., 2014). This algorithm can be 
implemented using the function <code>np.boxcoxmix()</code>, which is designed to account for 
overdispersed generalized linear models and variance component models using the non-parametric
profile maximum likelihood (NPPML) estimation.
</p>
<p>The ability of the EM algorithm to locate the global maximum in fewer iterations
can be affected by the choice of initial values, the function <code>np.boxcoxmix()</code>
allows us to choose from two different methods to set the initial value of the mass
points. When option &quot;gq&quot; is set, then Gauss-Hermite masses and mass points are used
as starting points in the EM algorithm, while setting start= &quot;quantile&quot; uses the 
Quantile-based version to select the starting points.
</p>


<h3>Value</h3>

<p>List with class being either <code>boxcoxmix</code> or <code>boxcoxmixpure</code> containing:
</p>
<table>
<tr><td><code>mass.point</code></td>
<td>
<p>the fitted mass points.</p>
</td></tr> <tr><td><code>p</code></td>
<td>
<p>the masses corresponding to the mixing proportions.</p>
</td></tr> <tr><td><code>beta</code></td>
<td>
<p>the
vector of coefficients.</p>
</td></tr> <tr><td><code>sigma</code></td>
<td>
<p>the standard deviation of the mixing distribution (the square root of the variance).</p>
</td></tr> <tr><td><code>se</code></td>
<td>
<p>the standard error of the estimate.</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>a matrix of posterior probabilities that element i comes from cluster k.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the log-likelihood of the fitted regression model.</p>
</td></tr>
<tr><td><code>complete.loglik</code></td>
<td>
<p>the complete log-likelihood of the fitted regression model.</p>
</td></tr>
<tr><td><code>disparity</code></td>
<td>
<p>the disparity of the fitted regression model.</p>
</td></tr> <tr><td><code>EMiteration</code></td>
<td>
<p>provides the number of iterations of the EM algorithm.</p>
</td></tr> 
<tr><td><code>EMconverged</code></td>
<td>
<p>TRUE means the EM algorithm converged.</p>
</td></tr> <tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr> <tr><td><code>formula</code></td>
<td>
<p>the formula provided.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data argument.</p>
</td></tr> <tr><td><code>aic</code></td>
<td>
<p>the Akaike information criterion of the fitted regression model.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>the Bayesian information criterion of the fitted regression model.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the fitted values for the individual observations.</p>
</td></tr> <tr><td><code>fitted.transformed</code></td>
<td>
<p>the fitted values for
the individual transformed observations.</p>
</td></tr> <tr><td><code>residuals</code></td>
<td>
<p>the difference between the observed values and the fitted values.</p>
</td></tr>
<tr><td><code>residuals.transformed</code></td>
<td>
<p>the difference between the transformed observed values and the transformed fitted values.</p>
</td></tr>
<tr><td><code>predicted.re</code></td>
<td>
<p>a vector of predicted residuals.</p>
</td></tr>
</table>
<p>The other outcomes are not relevant to users and they are intended for internal use only.
</p>


<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>References</h3>

<p>Box G. and Cox D. (1964). An analysis of transformations. Journal of
the Royal Statistical Society. Series B (Methodological), pages 211-252.
</p>
<p>Aitkin, M. A., Francis, B., Hinde, J., and Darnell, R. (2009). Statistical
modelling in R. Oxford University Press Oxford.
</p>
<p>Jochen Einbeck, Ross Darnell and John Hinde (2014). npmlreg:
Nonparametric maximum likelihood estimation for random effect
models. R package version 0.46-1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optim.boxcox">optim.boxcox</a></code>, <code><a href="#topic+tolfind.boxcox">tolfind.boxcox</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Pennsylvanian Hospital Stay Data
data(hosp, package = "npmlreg")
test1 &lt;- np.boxcoxmix(duration ~ age + wbc1, data = hosp, K = 2, tol = 1, 
    start = "quantile", lambda = 1)
round(summary(test1)$w, digits = 3)
# [1,] 1.000 0.000

# Refinery yield of gasoline Data
data(Gasoline, package = "nlme")
test2.vc &lt;- np.boxcoxmix(yield ~ endpoint + vapor, groups = Gasoline$Sample, 
      data = Gasoline, K = 3, tol = 1.7, start = "quantile", lambda = 0)
test2.vc$disparity
# [1] 176.9827








</code></pre>

<hr>
<h2 id='optim.boxcox'>Response Transformations for Random Effect and Variance Component Models</h2><span id='topic+optim.boxcox'></span>

<h3>Description</h3>

<p>The <code>optim.boxcox()</code> performs a grid search over the parameter <code>lambda</code>
for overdispersed generalized linear models and variance component models and 
then optimizes over this grid, to calculate the maximum likelihood estimator of
the transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optim.boxcox(
  formula,
  groups = 1,
  data,
  K = 3,
  steps = 500,
  tol = 0.5,
  start = "gq",
  EMdev.change = 1e-04,
  find.in.range = c(-3, 3),
  s = 60,
  plot.opt = 3,
  verbose = FALSE,
  noformat = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optim.boxcox_+3A_formula">formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_groups">groups</code></td>
<td>
<p>the random effects. To fit overdispersion models, set <code>groups</code> = 1.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_data">data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_k">K</code></td>
<td>
<p>the number of mass points.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_steps">steps</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_tol">tol</code></td>
<td>
<p>a positive scalar (usually, 0&lt;<code>tol</code> &lt;= 2)</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_start">start</code></td>
<td>
<p>a description of the initial values to be used in the fitted
model, Quantile-based version &quot;quantile&quot; or Gaussian Quadrature &quot;gq&quot; can be
set.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_emdev.change">EMdev.change</code></td>
<td>
<p>a small scalar, with default 0.0001, used to determine
when to stop EM algorithm.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_find.in.range">find.in.range</code></td>
<td>
<p>search in a range of <code>lambda</code>, with default (-3,3)
in step of 0.1.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_s">s</code></td>
<td>
<p>number of points in the grid search of <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_plot.opt">plot.opt</code></td>
<td>
<p>Set <code>plot.opt=3</code>, to plot the disparity against
iteration number and the profile log-likelihood against <code>lambda</code>. 
Use <code>plot.opt=0</code>, to only plot the profile log-likelihood against <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_verbose">verbose</code></td>
<td>
<p>If set to FALSE, no printed output on progress.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_noformat">noformat</code></td>
<td>
<p>Set <code>noformat = TRUE</code>, to change the formatting of the plots.</p>
</td></tr>
<tr><td><code id="optim.boxcox_+3A_...">...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Box-Cox transformation (Box &amp; Cox, 1964) is applied to the overdispersed
generalized linear models and variance component models with an unspecified
mixing distribution. The NPML estimate of the mixing distribution is known
to be a discrete distribution involving a finite number of mass-points and corresponding
masses (Aitkin et al., 2009). An Expectation-Maximization (EM) algorithm is
used for fitting the finite mixture distribution, one needs to specify the
number of components <code>K</code> of the finite mixture in advance. To stop the EM-algorithm when it reached its convergence point,
we need to defined the convergence criteria that is the absolute change in 
the successive log-likelihood function values being less than an arbitrary 
parameter such as <code>EMdev.change</code> = 0.0001 (Einbeck et
at., 2014). This algorithm can be implemented using
the function <code>np.boxcoxmix()</code>, which is designed to account for overdispersed generalized
linear models and variance component models using the non-parametric
profile maximum likelihood (NPPML) estimation.
</p>
<p>The ability of the EM algorithm to locate the global maximum in fewer iterations
can be affected by the choice of initial values, the function <code>optim.boxcox()</code> 
allows us to choose from two different methods to set the initial value of the mass
points. When option &quot;gq&quot; is set, then Gauss-Hermite masses and mass points are used
as starting points in the EM algorithm, while setting start= &quot;quantile&quot; uses the 
Quantile-based version to select the starting points. 
</p>
<p><code>optim.boxcox()</code> performs a grid search over the parameter <code>lambda</code> and then
optimizes over this grid, to calculate the maximum likelihood estimator of the transformation.
It produces a plot of the non-parametric profile likelihood function that summarises information
concerning <code>lambda</code>, including a vertical line indicating the best value of <code>lambda</code>
that maximizes the non-parametric profile log-likelihood.
</p>


<h3>Value</h3>

<p>List with class <code>boxcoxmix</code> containing:
</p>
<table>
<tr><td><code>All.lambda</code></td>
<td>
<p>list of <code>lambda</code> values used in the grid.</p>
</td></tr>
<tr><td><code>Maximum</code></td>
<td>
<p>the best estimate of <code>lambda</code> found.</p>
</td></tr> <tr><td><code>objective</code></td>
<td>
<p>the value of the profile
log-likelihood corresponding to Maximum.</p>
</td></tr> 
<tr><td><code>EMconverged</code></td>
<td>
<p>1 is TRUE, means the EM algorithm converged.</p>
</td></tr> <tr><td><code>EMiteration</code></td>
<td>
<p>provides the number of iterations of the EM algorithm.</p>
</td></tr> 
<tr><td><code>mass.point</code></td>
<td>
<p>the fitted mass points.</p>
</td></tr> <tr><td><code>p</code></td>
<td>
<p>the masses corresponding to the mixing proportions.</p>
</td></tr> <tr><td><code>beta</code></td>
<td>
<p>the
vector of coefficients.</p>
</td></tr> <tr><td><code>sigma</code></td>
<td>
<p>the standard deviation of the mixing distribution (the square root of the variance).</p>
</td></tr> <tr><td><code>se</code></td>
<td>
<p>the standard error of the estimate.</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>a matrix of posterior probabilities that element i comes from cluster k.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the profile log-likelihood of the fitted regression model.</p>
</td></tr>
<tr><td><code>profile.loglik</code></td>
<td>
<p>the profile complete log-likelihood of the fitted regression model.</p>
</td></tr>
<tr><td><code>disparity</code></td>
<td>
<p>the disparity of the fitted regression model.</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr> <tr><td><code>formula</code></td>
<td>
<p>the formula provided.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data argument.</p>
</td></tr> <tr><td><code>aic</code></td>
<td>
<p>the Akaike information criterion of the fitted regression model.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the fitted values for the individual observations.</p>
</td></tr> <tr><td><code>fitted.transformed</code></td>
<td>
<p>the fitted values for
the individual transformed observations.</p>
</td></tr> <tr><td><code>residuals</code></td>
<td>
<p>the difference between the observed values and the fitted values.</p>
</td></tr>
<tr><td><code>residuals.transformed</code></td>
<td>
<p>the difference between the transformed observed values and the transformed fitted values.</p>
</td></tr>
<tr><td><code>predicted.re</code></td>
<td>
<p>a vector of predicted residuals.</p>
</td></tr>
</table>
<p>The other outcomes are not relevant to users and they are intended for internal use only.
</p>


<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>References</h3>

<p>Box G. and Cox D. (1964). An analysis of transformations. Journal of
the Royal Statistical Society. Series B (Methodological), pages 211-252.
</p>
<p>Aitkin, M. A., Francis, B., Hinde, J., and Darnell, R. (2009). Statistical
modelling in R. Oxford University Press Oxford.
</p>
<p>Jochen Einbeck, Ross Darnell and John Hinde (2014). npmlreg:
Nonparametric maximum likelihood estimation for random effect
models. R package version 0.46-1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+np.boxcoxmix">np.boxcoxmix</a></code>,
<code><a href="#topic+tolfind.boxcox">tolfind.boxcox</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The strength Data
data(strength, package = "mdscore")
maxlam &lt;- optim.boxcox(y ~ cut*lot, data = strength, K = 3,  
           start = "gq" ,  find.in.range = c(-2, 2), s = 5)
# Maximum profile log-likelihood: 33.6795 at lambda= -0.4  

data(Oxboys, package = "nlme")
Oxboys$boy &lt;- gl(26,9)
maxlamvc &lt;- optim.boxcox(height ~  age, groups = Oxboys$boy,
                         data = Oxboys,   K = 2,  start = "gq",
                         find.in.range=c(-1.2,1), s=6, plot.opt = 0) 
maxlamvc$Maximum
#[1] -0.8333333
plot(maxlamvc,8)





</code></pre>

<hr>
<h2 id='plot.boxcoxmix'>Plot diagnostics for boxcoxmix functions</h2><span id='topic+plot.boxcoxmix'></span>

<h3>Description</h3>

<p><code>plot()</code> is a generic function used to produce some useful diagnostic plotting of the functions:
<code>np.boxcoxmix()</code>, <code>optim.boxcox()</code> and <code>tolfind.boxcox()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'boxcoxmix'
plot(x, plot.opt = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.boxcoxmix_+3A_x">x</code></td>
<td>
<p>an object for which a plot is desired.</p>
</td></tr>
<tr><td><code id="plot.boxcoxmix_+3A_plot.opt">plot.opt</code></td>
<td>
<p>an integer value between 1 and 8.</p>
</td></tr>
<tr><td><code id="plot.boxcoxmix_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The plots to be printed depend on the number given in <code>plot.opt</code>,
for the <code>np.boxcoxmix()</code>, <code>optim.boxcox()</code> and <code>tolfind.boxcox()</code> functions:
</p>
<table>
<tr><td><code>1</code></td>
<td>
<p>the disparities with the iteration number against the mass points</p>
</td></tr> 
<tr><td><code>2</code></td>
<td>
<p>the fitted value against the response of the original and the transformed Data.</p>
</td></tr>
<tr><td><code>3</code></td>
<td>
<p>probability plot of residuals of the original against the transformed data.</p>
</td></tr>
<tr><td><code>4</code></td>
<td>
<p>individual posterior probabilities.</p>
</td></tr>
<tr><td><code>5</code></td>
<td>
<p>control charts of residuals of the original against the transformed data.</p>
</td></tr>
<tr><td><code>6</code></td>
<td>
<p>The histograms of residuals of the original against the transformed data.</p>
</td></tr>
<tr><td><code>7</code></td>
<td>
<p>works only for the <code>tolfind.boxcox()</code> function and plots the specified range of <code>tol</code> against the disparities</p>
</td></tr>
<tr><td><code>8</code></td>
<td>
<p>works only for the <code>optim.boxcox()</code> function and gives the profile likelihood function that summarises information concerning <code>lambda</code>.</p>
</td></tr>
<tr><td><code>9</code></td>
<td>
<p>works only for the <code>Kfind.boxcox()</code> function and plots the specified range of <code>K</code> against the AIC or BIC information criteria</p>
</td></tr>
<tr><td><code>10</code></td>
<td>
<p>works only for the <code>boxcoxtype()</code> function and gives the profile likelihood function that summarises information concerning <code>lambda</code> for generalized linear Mixed-effects Models.</p>
</td></tr>
</table>

<hr>
<h2 id='print.boxcoxmix'>Summary of boxcoxmix functions</h2><span id='topic+print.boxcoxmix'></span><span id='topic+summary.boxcoxmix'></span><span id='topic+print.boxcoxmixpure'></span><span id='topic+summary.boxcoxmixpure'></span>

<h3>Description</h3>

<p><code>summary()</code> and <code>print()</code> are generic functions used to produce the results of the functions:
<code>np.boxcoxmix()</code>, <code>optim.boxcox()</code> and <code>tolfind.boxcox()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'boxcoxmix'
print(x, digits = max(3, getOption("digits") - 3), na.print = "", ...)

## S3 method for class 'boxcoxmixpure'
print(x, digits = max(3, getOption("digits") - 3), na.print = "", ...)

## S3 method for class 'boxcoxmix'
summary(object, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'boxcoxmixpure'
summary(object, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.boxcoxmix_+3A_x">x</code></td>
<td>
<p>an object for which a summary is desired.</p>
</td></tr>
<tr><td><code id="print.boxcoxmix_+3A_digits">digits</code></td>
<td>
<p>an integer number format.</p>
</td></tr>
<tr><td><code id="print.boxcoxmix_+3A_na.print">na.print</code></td>
<td>
<p>a character string which is used to indicate NA values output format.</p>
</td></tr>
<tr><td><code id="print.boxcoxmix_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
<tr><td><code id="print.boxcoxmix_+3A_object">object</code></td>
<td>
<p>an object for which a summary is desired.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return invisibly the main object provided, while print a summary of its content.
</p>

<hr>
<h2 id='tolfind.boxcox'>Grid search over tol for NPPML estimation of random effect and variance component models</h2><span id='topic+tolfind.boxcox'></span>

<h3>Description</h3>

<p>A grid search over the parameter <code>tol</code>, to set the initial values of
the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tolfind.boxcox(
  formula,
  groups = 1,
  data,
  K = 3,
  lambda = 1,
  EMdev.change = 1e-04,
  plot.opt = 2,
  s = 15,
  steps = 500,
  find.in.range = c(0, 1.5),
  start = "gq",
  verbose = FALSE,
  noformat = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tolfind.boxcox_+3A_formula">formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_groups">groups</code></td>
<td>
<p>the random effects. To fit overdispersion models , set <code>groups</code> = 1.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_data">data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_k">K</code></td>
<td>
<p>the number of mass points.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_lambda">lambda</code></td>
<td>
<p>a transformation parameter, setting <code>lambda</code>=1 means 'no
transformation'.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_emdev.change">EMdev.change</code></td>
<td>
<p>a small scalar, with default 0.0001, used to determine
when to stop EM algorithm.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_plot.opt">plot.opt</code></td>
<td>
<p>Set <code>plot.opt=2</code>, to plot the EM trajectories and the development of the disparity over
iteration number.  And <code>plot.opt=0</code>, for none of them.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_s">s</code></td>
<td>
<p>number of points in the grid search of <code>tol</code>.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_steps">steps</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_find.in.range">find.in.range</code></td>
<td>
<p>search in a range of <code>tol</code>, with default (0,1.5) in
step of 0.1 .</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_start">start</code></td>
<td>
<p>a description of the initial values to be used in the fitted
model, Quantile-based version &quot;quantile&quot; or Gaussian Quadrature &quot;gq&quot; can be
set.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_verbose">verbose</code></td>
<td>
<p>If set to FALSE, no printed output on progress.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_noformat">noformat</code></td>
<td>
<p>Set <code>noformat = TRUE</code>, to change the formatting of the plots.</p>
</td></tr>
<tr><td><code id="tolfind.boxcox_+3A_...">...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A grid search over <code>tol</code> can be performed using <code>tolfind.boxcox()</code>
function, which works for <code>np.boxcoxmix()</code> to find the
optimal solution.
</p>


<h3>Value</h3>

<p>List with class <code>boxcoxmix</code> containing:
</p>
<table>
<tr><td><code>MinDisparity</code></td>
<td>
<p>the minimum disparity found.</p>
</td></tr> <tr><td><code>Mintol</code></td>
<td>
<p>the
value of <code>tol</code> corresponding to <code>MinDisparity</code>.</p>
</td></tr>
<tr><td><code>AllDisparities</code></td>
<td>
<p>a vector containing all disparities calculated on the
grid.</p>
</td></tr> <tr><td><code>Alltol</code></td>
<td>
<p>list of <code>tol</code> values used in the grid.</p>
</td></tr>
<tr><td><code>AllEMconverged</code></td>
<td>
<p>1 is TRUE, means the EM algorithm converged.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>the Akaike information criterion of the fitted regression model.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>the Bayesian information criterion of the fitted regression model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>See Also</h3>

<p><code><a href="#topic+np.boxcoxmix">np.boxcoxmix</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The Pennsylvanian Hospital Stay Data
data(hosp, package = "npmlreg")
test1 &lt;- tolfind.boxcox(duration ~ age , data = hosp, K = 2, lambda = 0, 
           find.in.range = c(0, 2), s = 10,  start = "gq")
# Minimal Disparity: 137.8368 at tol= 2 
# Minimal Disparity with EM converged: 137.8368 at tol= 2

# Effect of Phenylbiguanide on Blood Pressure
data(PBG, package = "nlme")
test2 &lt;- tolfind.boxcox(deltaBP ~ dose , groups = PBG$Rabbit, find.in.range = c(0, 2),
    data = PBG, K = 2, lambda = -1, s = 15,  start = "quantile", plot.opt = 0)
test2$Mintol
# [1] 1.6
test2$MinDisparity
# [1] 449.5876








</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
