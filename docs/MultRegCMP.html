<!DOCTYPE html><html lang="en"><head><title>Help for package MultRegCMP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultRegCMP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MultRegCMP-package'><p>MultRegCMP: Bayesian Multivariate Conway-Maxwell-Poisson Regression Model for Correlated Count Data</p></a></li>
<li><a href='#com_sampler'><p>Rejection Sampler - COM-Poisson</p></a></li>
<li><a href='#DIC_cmp'><p>DIC of the regression model</p></a></li>
<li><a href='#epl_20_21'><p>Scores English Premier League Season 2020-2021</p></a></li>
<li><a href='#fitting_plots'><p>Rootograms plots - Multivariate CMP</p></a></li>
<li><a href='#llk_cmp'><p>Log likelihood of the Conway-Maxwell-Poisson Distribution</p></a></li>
<li><a href='#log_cmp'><p>Log density of the normalized component of the Conway-Maxwell-Poisson</p></a></li>
<li><a href='#mcmc_cmp'><p>MCMC Algorithm for Conway-Maxwell-Poisson Regression Model for Multivariate Correlated Count Data</p></a></li>
<li><a href='#prod_list'><p>Product of lists between matrices</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Multivariate Conway-Maxwell-Poisson Regression Model
for Correlated Count Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits a Bayesian Regression Model for multivariate count data. This model assumes that the data is distributed according to the Conway-Maxwell-Poisson distribution, and for each response variable it is associate different covariates. This model allows to account for correlations between the counts by using latent effects based on the Chib and Winkelmann (2001) <a href="http://www.jstor.org/stable/1392277">http://www.jstor.org/stable/1392277</a> proposal.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>purrr, mvnfast, stats, progress, bayesplot, ggplot2, cowplot</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-19 19:25:11 UTC; User</td>
</tr>
<tr>
<td>Author:</td>
<td>Mauro Florez [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mauro Florez &lt;mf53@rice.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-20 16:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='MultRegCMP-package'>MultRegCMP: Bayesian Multivariate Conway-Maxwell-Poisson Regression Model for Correlated Count Data</h2><span id='topic+MultRegCMP'></span><span id='topic+MultRegCMP-package'></span>

<h3>Description</h3>

<p>Fits a Bayesian Regression Model for multivariate count data. This model assumes that the data is distributed according to the Conway-Maxwell-Poisson distribution, and for each response variable it is associate different covariates. This model allows to account for correlations between the counts by using latent effects based on the Chib and Winkelmann (2001) <a href="http://www.jstor.org/stable/1392277">http://www.jstor.org/stable/1392277</a> proposal.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Mauro Florez <a href="mailto:mf53@rice.edu">mf53@rice.edu</a>
</p>

<hr>
<h2 id='com_sampler'>Rejection Sampler - COM-Poisson</h2><span id='topic+com_sampler'></span>

<h3>Description</h3>

<p>Sampler for the Conway-Maxwell-Poisson as described in Algorithm 2 - Benson &amp; Friel (2021)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>com_sampler(mu, nu, n = 1, ndraws = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="com_sampler_+3A_mu">mu</code></td>
<td>
<p>Location parameter</p>
</td></tr>
<tr><td><code id="com_sampler_+3A_nu">nu</code></td>
<td>
<p>Shape parameter</p>
</td></tr>
<tr><td><code id="com_sampler_+3A_n">n</code></td>
<td>
<p>Number of draws (default = 1)</p>
</td></tr>
<tr><td><code id="com_sampler_+3A_ndraws">ndraws</code></td>
<td>
<p>Optional: Return the number of draws required to generate the n samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list or numeric in case ndraws = FALSE:
</p>
<table role = "presentation">
<tr><td><code>sample</code></td>
<td>
<p>Values sampled from the distribution</p>
</td></tr>
<tr><td><code>drawsa</code></td>
<td>
<p>Number of draws required in the rejection sampler</p>
</td></tr>
<tr><td><code>log_Bf</code></td>
<td>
<p>Log of the boundary of the rejection sampler</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>com_sampler(2, 0.2, n = 10, ndraws = TRUE)
com_sampler(1, 2)
</code></pre>

<hr>
<h2 id='DIC_cmp'>DIC of the regression model</h2><span id='topic+DIC_cmp'></span>

<h3>Description</h3>

<p>This function used an approach similar to the presented by Benson &amp; Friel (2021) to calculate the BIC. We select S a sample size of the posterior samples to speed up computation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DIC_cmp(fit, S = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DIC_cmp_+3A_fit">fit</code></td>
<td>
<p>An object from the mcmc_cmp_mh</p>
</td></tr>
<tr><td><code id="DIC_cmp_+3A_s">S</code></td>
<td>
<p>Number of iterations used to calculate the DIC</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of approximated DIC
</p>

<hr>
<h2 id='epl_20_21'>Scores English Premier League Season 2020-2021</h2><span id='topic+epl_20_21'></span>

<h3>Description</h3>

<p>A data set with the scores of the games played during season 2020-2021 in the English Premier League (EPL)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epl_20_21
</code></pre>


<h3>Format</h3>

<p>A data frame with 380 rows and 4 variables:
</p>

<dl>
<dt>HG</dt><dd><p>Goals scored by home team.</p>
</dd>
<dt>AG</dt><dd><p>Goals scored by away team.</p>
</dd>
<dt>HomeTeam</dt><dd><p>Home team.</p>
</dd>
<dt>AwayTeam</dt><dd><p>Away team.</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://www.football-data.co.uk&gt;
</p>

<hr>
<h2 id='fitting_plots'>Rootograms plots - Multivariate CMP</h2><span id='topic+fitting_plots'></span>

<h3>Description</h3>

<p>Rootograms plots - Multivariate CMP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitting_plots(fit, type = "rootogram", S = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitting_plots_+3A_fit">fit</code></td>
<td>
<p>An element from 'mcmc_cmp'</p>
</td></tr>
<tr><td><code id="fitting_plots_+3A_type">type</code></td>
<td>
<p>Wheter to do a bar plot or a rootogram</p>
</td></tr>
<tr><td><code id="fitting_plots_+3A_s">S</code></td>
<td>
<p>Optional. Indicates the number of posterior samples used (Default 100)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for plotting only
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  n = 50; J = 2
  X = list(matrix(rnorm(3*n), ncol = 3), matrix(rnorm(3*n), ncol = 3))
  beta &lt;- list(c(1,0.1, 1), c(0, 0.5, -0.5))
  mu &lt;- exp(prod_list(X, beta))
  y = matrix(rpois(n = length(mu), lambda = mu), nrow = n)
  fit &lt;- mcmc_cmp(y, X, S = 1000, nburn = 1000, scale_cov_b = 0.8,
  scale_cov_beta = 0.04, scale_cov_gamma = 0.06)
  fitting_plots(fit)

</code></pre>

<hr>
<h2 id='llk_cmp'>Log likelihood of the Conway-Maxwell-Poisson Distribution</h2><span id='topic+llk_cmp'></span>

<h3>Description</h3>

<p>This function calculates the log likelihood of the distribution as described by Benson and Friel (2021)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>llk_cmp(y, mu, nu, r = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="llk_cmp_+3A_y">y</code></td>
<td>
<p>Count value</p>
</td></tr>
<tr><td><code id="llk_cmp_+3A_mu">mu</code></td>
<td>
<p>Location parameter</p>
</td></tr>
<tr><td><code id="llk_cmp_+3A_nu">nu</code></td>
<td>
<p>Shape parameter</p>
</td></tr>
<tr><td><code id="llk_cmp_+3A_r">r</code></td>
<td>
<p>Number of acceptances</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimation of the log likelihood of the distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>llk_cmp(10, 5, 2)
</code></pre>

<hr>
<h2 id='log_cmp'>Log density of the normalized component of the Conway-Maxwell-Poisson</h2><span id='topic+log_cmp'></span>

<h3>Description</h3>

<p>Log density of the normalized component of the Conway-Maxwell-Poisson
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_cmp(y, mu, nu)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="log_cmp_+3A_y">y</code></td>
<td>
<p>Value</p>
</td></tr>
<tr><td><code id="log_cmp_+3A_mu">mu</code></td>
<td>
<p>Location parameter</p>
</td></tr>
<tr><td><code id="log_cmp_+3A_nu">nu</code></td>
<td>
<p>Shape parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric corresponding to the log of the unnormalized component of the distribution
</p>

<hr>
<h2 id='mcmc_cmp'>MCMC Algorithm for Conway-Maxwell-Poisson Regression Model for Multivariate Correlated Count Data</h2><span id='topic+mcmc_cmp'></span>

<h3>Description</h3>

<p>MCMC Algorithm to estimate the parameters in the regression model for multivariate correlated count data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc_cmp(
  y,
  X,
  S = 10000,
  nburn = 5000,
  initial_beta,
  initial_gamma,
  initial_b,
  prior_mean_beta,
  prior_var_beta,
  prior_mean_gamma,
  prior_var_gamma,
  v_0,
  R_0,
  intercept = FALSE,
  scale_b,
  scale_beta,
  scale_gamma,
  scale_cov_b,
  scale_cov_beta,
  scale_cov_gamma,
  inc_burn = FALSE,
  re_chain = TRUE,
  way = 2,
  random_seed,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcmc_cmp_+3A_y">y</code></td>
<td>
<p>Matrix of observations</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_x">X</code></td>
<td>
<p>Covariates list, each element is the design matrix for each column of y</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_s">S</code></td>
<td>
<p>Number of MCMC samples to be drawn</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_nburn">nburn</code></td>
<td>
<p>Number of MCMC samples to burn-in</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_initial_beta">initial_beta</code></td>
<td>
<p>List with initial value of <code class="reqn">beta</code> for each response</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_initial_gamma">initial_gamma</code></td>
<td>
<p>List with initial value of <code class="reqn">gamma</code> for each response</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_initial_b">initial_b</code></td>
<td>
<p>Initital value of <code class="reqn">b</code>.</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_prior_mean_beta">prior_mean_beta</code></td>
<td>
<p>Prior mean for <code class="reqn">beta</code>. (Default zero vector)</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_prior_var_beta">prior_var_beta</code></td>
<td>
<p>Prior covariance matrix for <code class="reqn">beta</code> (Default <code class="reqn">I</code>)</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_prior_mean_gamma">prior_mean_gamma</code></td>
<td>
<p>Prior mean for <code class="reqn">beta</code>. (Default zero vector)</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_prior_var_gamma">prior_var_gamma</code></td>
<td>
<p>Prior covariance matrix for <code class="reqn">gamma</code> (Default <code class="reqn">I</code>)</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_v_0">v_0</code></td>
<td>
<p>Prior degrees of freedom of random effects</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_r_0">R_0</code></td>
<td>
<p>Prior covariance matrix of random effects</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_intercept">intercept</code></td>
<td>
<p>Logical value indicating whether include the intercept</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_scale_b">scale_b</code></td>
<td>
<p>Covariance matrix for RW proposals of the random effects (Default <code class="reqn">I</code>)</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_scale_beta">scale_beta</code></td>
<td>
<p>List with initial values for the scale matrices of <code class="reqn">beta</code> (Default <code class="reqn">I</code>)</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_scale_gamma">scale_gamma</code></td>
<td>
<p>List with initial values for the scale matrices of <code class="reqn">gamma</code> (Default <code class="reqn">I</code>)</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_scale_cov_b">scale_cov_b</code></td>
<td>
<p>Scale parameter for the RW of random effects. (Default <code class="reqn">2.4/sqrt(2)</code>)</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_scale_cov_beta">scale_cov_beta</code></td>
<td>
<p>Scale parameter for the covariance of the proposals.</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_scale_cov_gamma">scale_cov_gamma</code></td>
<td>
<p>Scale parameter for the covariance of the proposals.</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_inc_burn">inc_burn</code></td>
<td>
<p>logical: include burned samples in the return</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_re_chain">re_chain</code></td>
<td>
<p>logical: If the posterior samples for the r.e are include. False return just the mean</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_way">way</code></td>
<td>
<p>How to calculate the MCMC updates, based on Chib (2001)</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_random_seed">random_seed</code></td>
<td>
<p>Random seed</p>
</td></tr>
<tr><td><code id="mcmc_cmp_+3A_...">...</code></td>
<td>
<p>Additional parameters of the MCMC algorithm</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list:
</p>
<table role = "presentation">
<tr><td><code>posterior_b</code></td>
<td>
<p>List with posterior values of the random effects</p>
</td></tr>
<tr><td><code>estimation_beta</code></td>
<td>
<p>Estimation of beta parameters</p>
</td></tr>
<tr><td><code>posterior_beta</code></td>
<td>
<p>List with posterior values of beta</p>
</td></tr>
<tr><td><code>estimation_gamma</code></td>
<td>
<p>Estimation of gamma parameters</p>
</td></tr>
<tr><td><code>posterior_gamma</code></td>
<td>
<p>List with posterior values of gamma</p>
</td></tr>
<tr><td><code>posterior_D</code></td>
<td>
<p>Values of covariance matrix D</p>
</td></tr>
<tr><td><code>fitted_mu</code></td>
<td>
<p>Posterior of location parameters for each response</p>
</td></tr>
<tr><td><code>fitted_nu</code></td>
<td>
<p>Posterior of shape parameters for ecah response</p>
</td></tr>
<tr><td><code>accept_rate_b</code></td>
<td>
<p>Acceptance rate of Random Effects</p>
</td></tr>
<tr><td><code>accept_rate_beta</code></td>
<td>
<p>Acceptance rate of beta</p>
</td></tr>
<tr><td><code>accept_rate_gamma</code></td>
<td>
<p>Acceptance rate of gamma</p>
</td></tr>
<tr><td><code>scale_beta</code></td>
<td>
<p>Estimated Scale matrix for beta parameters</p>
</td></tr>
<tr><td><code>scale_gamma</code></td>
<td>
<p>Estimated Scale matrix for gamma parameters</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>List of covariates used</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Matrix of observed counts</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
  n = 50; J = 2
  X = list(matrix(rnorm(3*n), ncol = 3), matrix(rnorm(3*n), ncol = 3))
  beta &lt;- list(c(1,0.1, 1), c(0, 0.5, -0.5))
  mu &lt;- exp(prod_list(X, beta))
  y = matrix(rpois(n = length(mu), lambda = mu), nrow = n)
  fit &lt;- mcmc_cmp(y, X, S = 10000, nburn = 1000, scale_cov_b = 0.8,
  scale_cov_beta = 0.04, scale_cov_gamma = 0.06)

</code></pre>

<hr>
<h2 id='prod_list'>Product of lists between matrices</h2><span id='topic+prod_list'></span>

<h3>Description</h3>

<p>Product of lists between matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prod_list(X, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prod_list_+3A_x">X</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="prod_list_+3A_beta">beta</code></td>
<td>
<p>Parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the products element-wise
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
