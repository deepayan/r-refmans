<!DOCTYPE html><html><head><title>Help for package hydroTSM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hydroTSM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hydroTSM-package'>
<p>Management, analysis, and plot of hydrological time series, with focus on hydrological modelling</p></a></li>
<li><a href='#(sub)daily2annual'>
<p>(sub)Daily/Monthly -&gt; Annual</p></a></li>
<li><a href='#(sub)daily2monthly'>
<p>(sub)Daily -&gt; Monthly</p></a></li>
<li><a href='#annualfunction'>
<p>Annual Function</p></a></li>
<li><a href='#baseflow'>
<p>Baseflow</p></a></li>
<li><a href='#calendarHeatmap'>
<p>Calendar heatmap</p></a></li>
<li><a href='#Cauquenes7336001'>
<p>Hydrometeorological time series for &quot;Cauquenes en El Arrayan&quot; catchment</p></a></li>
<li><a href='#climograph'>
<p>Climograph</p></a></li>
<li><a href='#cmv'>
<p>Counting Missing Values</p></a></li>
<li><a href='#daily2weekly'>
<p>Daily -&gt; Weekly</p></a></li>
<li><a href='#dip'>
<p>Days in Period</p></a></li>
<li><a href='#diy'>
<p>Days in Year</p></a></li>
<li><a href='#dm2seasonal'>
<p>(sub)Daily/Monthly -&gt; Seasonal Values</p></a></li>
<li><a href='#drawTimeAxis'>
<p>Customized Time Axis</p></a></li>
<li><a href='#dwdays'>
<p>Amount of dry/wet days in a time series</p></a></li>
<li><a href='#dwi'>
<p>Days with Information</p></a></li>
<li><a href='#EbroPPtsMonthly'>
<p>Ebro Monthly Precipitation Time Series</p></a></li>
<li><a href='#extract'>
<p>Extract from Zoo</p></a></li>
<li><a href='#fdc'>
<p>Flow Duration Curve</p></a></li>
<li><a href='#fdcu'>
<p>Flow Duration Curve with uncertainty bounds.</p></a></li>
<li><a href='#hip'>
<p>Hours in Period</p></a></li>
<li><a href='#hydropairs'>
<p>Visual Correlation Matrix</p></a></li>
<li><a href='#hydroplot'>
<p>Hydrological time series plotting and extraction.</p></a></li>
<li><a href='#hydroTSM-internal'><p>Internal hydroTSM objects</p></a></li>
<li><a href='#infillxy'>
<p>Infills NA values</p></a></li>
<li><a href='#istdx'>
<p>Inverse Standarization</p></a></li>
<li><a href='#izoo2rzoo'>
<p>Irregular Zoo -&gt; Regular Zoo</p></a></li>
<li><a href='#KarameaAtGorgeQts'>
<p>Karamea at Gorge, time series of hourly streamflows</p></a></li>
<li><a href='#ma'>
<p>Moving Average</p></a></li>
<li><a href='#MaquehueTemuco'>
<p>San Martino, ts of daily precipitation.</p></a></li>
<li><a href='#matrixplot'>
<p>Matrixplot</p></a></li>
<li><a href='#mip'>
<p>Months in Period</p></a></li>
<li><a href='#monthlyfunction'>
<p>Monthly Function</p></a></li>
<li><a href='#OcaEnOnaQts'>
<p>Oca in &quot;Ona&quot; (Q0931), time series of daily streamflows.</p></a></li>
<li><a href='#plot_pq'>
<p>Plot precipitation and streamflow time series in the same figure.</p></a></li>
<li><a href='#rm1stchar'>
<p>Remove First Character(s)</p></a></li>
<li><a href='#SanMartinoPPts'>
<p>San Martino, ts of daily precipitation.</p></a></li>
<li><a href='#seasonalfunction'>
<p>Seasonal Function</p></a></li>
<li><a href='#sfreq'>
<p>Sampling Frequency</p></a></li>
<li><a href='#si'>
<p>Seasonality Index</p></a></li>
<li><a href='#smry'>
<p>Summary</p></a></li>
<li><a href='#sname2ts'>
<p>Station Name -&gt; Time Series</p></a></li>
<li><a href='#stdx'>
<p>Standarization</p></a></li>
<li><a href='#subdaily2daily'>
<p>Sub-daily -&gt; Daily</p></a></li>
<li><a href='#subdaily2weekly'>
<p>Subdaily -&gt; Weekly</p></a></li>
<li><a href='#subhourly2hourly'>
<p>Sub-hourly -&gt; Hourly</p></a></li>
<li><a href='#subhourly2nminutes'>
<p>Sub-hourly -&gt; n-minutes</p></a></li>
<li><a href='#time2season'>
<p>Date/DateTime character -&gt; Seasonal character</p></a></li>
<li><a href='#vector2zoo'>
<p>Vector -&gt; Zoo</p></a></li>
<li><a href='#weeklyfunction'>
<p>Weekly Function</p></a></li>
<li><a href='#yip'>
<p>Years in Period</p></a></li>
<li><a href='#zoo2RHtest'>
<p>Zoo -&gt; RHTest</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Time Series Management and Analysis for Hydrological Modelling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7-0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mauricio Zambrano-Bigiarini &lt;mzb.devel@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>S3 functions for management, analysis, interpolation and plotting of time series used in hydrology and related environmental sciences. In particular, this package is highly oriented to hydrological modelling tasks. The focus of this package has been put in providing a collection of tools useful for the daily work of hydrologists (although an effort was made to optimise each function as much as possible, functionality has had priority over speed). Bugs / comments / questions / collaboration of any kind are very welcomed, and in particular, datasets that can be included in this package for academic purposes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), zoo (&ge; 1.7-2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>xts (&ge; 0.9-7), e1071, stats, utils, methods, graphics,
grDevices, lattice, classInt</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, gridExtra</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hzambran/hydroTSM">https://github.com/hzambran/hydroTSM</a>,
<a href="https://cran.r-project.org/package=hydroTSM">https://cran.r-project.org/package=hydroTSM</a></td>
</tr>
<tr>
<td>MailingList:</td>
<td>https://stat.ethz.ch/mailman/listinfo/r-sig-ecology</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hzambran/hydroTSM/issues">https://github.com/hzambran/hydroTSM/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-17 23:45:37 UTC; hzambran</td>
</tr>
<tr>
<td>Author:</td>
<td>Mauricio Zambrano-Bigiarini
    <a href="https://orcid.org/0000-0002-9536-643X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-18 10:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='hydroTSM-package'>
Management, analysis, and plot of hydrological time series, with focus on hydrological modelling
</h2><span id='topic+hydroTSM-package'></span><span id='topic+hydroTSM'></span>

<h3>Description</h3>

<p>S3 functions for management, analysis, interpolation and plotting of time series used in hydrology and related environmental sciences. In particular, this package is highly oriented to hydrological modelling tasks. 
The focus of this package has been put in providing a collection of tools useful for the daily work of hydrologists (although an effort was made to optimise each function as much as possible, functionality has had priority over speed). Bugs / comments / questions / collaboration of any kind are very welcomed, and in particular, datasets that can be included in this package for academic purposes.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> hydroTSM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.7-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-01-14</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL &gt;= 2 </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Packaged: </td><td style="text-align: left;"> Wed 17 Jan 2024 20:43:17 -03 ; MZB </td>
</tr>
<tr>
 <td style="text-align: left;">
BuiltUnder: </td><td style="text-align: left;"> R version 4.3.2 (2023-10-31) ;x86_64-pc-linux-gnu (64-bit) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; <br />
Datasets:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+Cauquenes7336001">Cauquenes7336001</a></code>  Hydrometeorological time series for "Cauquenes en El Arrayan" catchment.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+EbroPPtsMonthly">EbroPPtsMonthly</a></code>   Ebro Monthly Precipitation Time Series. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+KarameaAtGorgeQts">KarameaAtGorgeQts</a></code> Karamea at Gorge, time series of hourly streamflows. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+MaquehueTemuco">MaquehueTemuco</a></code>    San Martino, ts of daily precipitation. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+OcaEnOnaQts">OcaEnOnaQts</a></code>       Oca in "Ona" (Q0931), time series of daily streamflows </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+SanMartinoPPts">SanMartinoPPts</a></code>    San Martino, ts of daily precipitation. </td>
</tr>
<tr>
 <td style="text-align: left;">
--------------------------------------------------------------------------------------------------------------------------- </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Temporal aggregation: 
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+annualfunction">annualfunction</a></code>    single representative annual value of a zoo object.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+weeklyfunction">weeklyfunction</a></code>    single representative weekly value of a zoo object. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+monthlyfunction">monthlyfunction</a></code>   single representative monthly value of a zoo object. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+seasonalfunction">seasonalfunction</a></code>  representative values of each weather season of a zoo object. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+daily2annual">daily2annual</a></code>      Aggregation from daily to annual </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+subdaily2annual">subdaily2annual</a></code>   Aggregation from subdaily to annual. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+monthly2annual">monthly2annual</a></code>    Aggregation from monthly to annual. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+daily2monthly">daily2monthly</a></code>     Aggregation from daily to monthly. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+subdaily2monthly">subdaily2monthly</a></code>  Aggregation from subdaily to monthly. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+daily2weekly">daily2weekly</a></code>      Aggregation from daily to weekly. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+dm2seasonal">dm2seasonal</a></code>       Aggregation from daily or monthly to seasonal. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+subdaily2seasonal">subdaily2seasonal</a></code> Aggregation from subdaily to seasonal. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+subdaily2daily">subdaily2daily</a></code>    Aggregation from subdaily to daily. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+subdaily2weekly">subdaily2weekly</a></code>   Aggregation from subdaily to weekly. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+subhourly2hourly">subhourly2hourly</a></code>  Aggregation from subhourly to hourly. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+subhourly2nminutes">subhourly2nminutes</a></code>Aggregation from subhourly to n-minutes. </td>
</tr>
<tr>
 <td style="text-align: left;">
--------------------------------------------------------------------------------------------------------------------------- </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Temporal manipulation: 
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+dip">dip</a></code>         Days in period.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+diy">diy</a></code>         Days in year. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+hip">hip</a></code>         Hours in period. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+mip">mip</a></code>         Months in period. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+yip">yip</a></code>         Years in period. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+izoo2rzoo">izoo2rzoo</a></code>   Irregular zoo object to regular zoo objectl. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+time2season">time2season</a></code> Time to weather season. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+vector2zoo">vector2zoo</a></code>  Numeric and date/times to zoo object. </td>
</tr>
<tr>
 <td style="text-align: left;">
--------------------------------------------------------------------------------------------------------------------------- </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Hydrological functions: 
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+baseflow">baseflow</a></code>   Baseflow computation.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+climograph">climograph</a></code> Climograph </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+dwdays">dwdays</a></code>     Dry and wet days. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+fdc">fdc</a></code>        Flow duration curve. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+fdcu">fdcu</a></code>       Flow duration curve with uncertainty bounds. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+hydroplot">hydroplot</a></code>  Exploratory figure for hydrological time series. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+sname2plot">sname2plot</a></code> Hydrological time series plotting and extraction. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plot_pq">plot_pq</a></code>    Plot precipitation and streamflow time series in the same figure. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+si">si</a></code>         Seasonality Index for precipitation. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+sname2ts">sname2ts</a></code>   Station Name -&gt; Time Series. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+zoo2RHtest">zoo2RHtest</a></code> Zoo object -&gt; RHTest. </td>
</tr>
<tr>
 <td style="text-align: left;">
--------------------------------------------------------------------------------------------------------------------------- </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Miscelaneous functions:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+calendarHeatmap">calendarHeatmap</a></code> Calendar heat map.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+cmv">cmv</a></code>             Counting missing values. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+drawxaxis">drawxaxis</a></code>       Draw a temporal horizontal axis. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+dwi">dwi</a></code>             Days with information. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+extract">extract</a></code>         Extract a subset of a zoo object. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+hydropairs">hydropairs</a></code>      Visual correlation matrix. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+infillxy">infillxy</a></code>        Infills NA values. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+istdx">istdx</a></code>           Inverse standarization. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+ma">ma</a></code>              Moving average. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+matrixplot">matrixplot</a></code>      2D color matrix. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+rm1stchar">rm1stchar</a></code>       Remove first character. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+sfreq">sfreq</a></code>           Sampling frequency. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+smry">smry</a></code>            Improved summary function. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+stdx">stdx</a></code>            Standarization. </td>
</tr>
<tr>
 <td style="text-align: left;">
--------------------------------------------------------------------------------------------------------------------------- </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini
</p>
<p>Maintainer: Mauricio Zambrano-Bigiarini &lt;mzb.devel@gmail&gt;
</p>


<h3>See Also</h3>

<p><a href="https://github.com/hzambran/hydroGOF">https://github.com/hzambran/hydroGOF</a>. <br />
<a href="https://github.com/hzambran/hydroPSO">https://github.com/hzambran/hydroPSO</a>. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the monthly time series (10 years) of precipitation for the Ebro River basin.
data(EbroPPtsMonthly)

#######
## Ex1) Graphical correlation among the ts of monthly precipitation of the first 
##      3 stations in 'EbroPPtsMonthly' (its first column stores the dates).
hydropairs(EbroPPtsMonthly[,2:4])

#######
## Ex2) Annual values of precipitation at the station "P9001"
sname2ts(EbroPPtsMonthly, sname="P9001", dates=1, var.type="Precipitation", 
         tstep.out="annual")

#######
## Ex3) Monthly and annual plots
sname2plot(EbroPPtsMonthly, sname="P9001", var.type="Precipitation", pfreq="ma")


#######
## Ex5)  Mean monthly values of streamflows
## Loading daily streamflows (3 years) at the station 
## Oca en Ona (Ebro River basin, Spain)
data(OcaEnOnaQts)
monthlyfunction(OcaEnOnaQts, FUN=mean, na.rm=TRUE)

</code></pre>

<hr>
<h2 id='+28sub+29daily2annual'>
(sub)Daily/Monthly -&gt; Annual 
</h2><span id='topic+daily2annual'></span><span id='topic+daily2annual.default'></span><span id='topic+daily2annual.zoo'></span><span id='topic+daily2annual.data.frame'></span><span id='topic+daily2annual.matrix'></span><span id='topic+monthly2annual'></span><span id='topic+monthly2annual.default'></span><span id='topic+monthly2annual.zoo'></span><span id='topic+monthly2annual.data.frame'></span><span id='topic+monthly2annual.matrix'></span><span id='topic+subdaily2annual'></span><span id='topic+subdaily2annual.default'></span><span id='topic+subdaily2annual.zoo'></span><span id='topic+subdaily2annual.data.frame'></span><span id='topic+subdaily2annual.matrix'></span>

<h3>Description</h3>

<p>Generic function for transforming a (sub)DAILY/MONTHLY (weekly and quarterly) regular time series into an ANNUAL one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily2annual(x, ...)
subdaily2annual(x, ...)
monthly2annual(x, ...)

## Default S3 method:
daily2annual(x, FUN, na.rm=TRUE, na.rm.max=0, out.fmt="%Y", ...)

## S3 method for class 'zoo'
daily2annual(x, FUN, na.rm=TRUE, na.rm.max=0, out.fmt="%Y-%m-%d", ...)

## S3 method for class 'data.frame'
daily2annual(x, FUN, na.rm=TRUE, na.rm.max=0, out.fmt="%Y", dates=1, 
        date.fmt = "%Y-%m-%d", out.type = "data.frame", verbose = TRUE, ...)

## S3 method for class 'matrix'
daily2annual(x, FUN, na.rm = TRUE, na.rm.max=0, out.fmt="%Y", 
        dates=1, date.fmt = "%Y-%m-%d", out.type = "data.frame", verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with (sub)daily/monthly time series. <br />
Measurements at several gauging stations can be stored in a data.frame or matrix object, and in that case, each column of <code>x</code> represents the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_fun">FUN</code></td>
<td>

<p>Function that have to be applied for aggregating from (sub)daily/monthly into annual time step (e.g., for precipitation <code>FUN=sum</code> and for temperature and streamflows ts <code>FUN=mean</code>). <br />
</p>
<p><code>FUN</code> MUST accept the <code>na.rm</code> argument, because <code>na.rm</code> is passed to <code>FUN</code>. <br />
</p>
<p>When <code>FUN=max</code> or <code>FUN=min</code> the date(time) where the maximum/minimum value actually occurs is returned in the output object, otherwise, a generic 1st of january for each year is returned.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the annual values are computed only for years with a percentage of missing values less than <code>na.rm.max</code> <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a year, the corresponing annual values in the output object will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_na.rm.max">na.rm.max</code></td>
<td>

<p>Numeric in [0, 1]. It is used to define the maximum percentage of missing values allowed in each year to keep the yearly aggregated value in the output object of this function. In other words, if the percentage of missing values in a given year is larger or equal than <code>na.rm.max</code> the corresponding annual value will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_out.fmt">out.fmt</code></td>
<td>

<p>Character indicating the date format for the output zoo object. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. Possible values are: <br />
-) <kbd>%Y</kbd>        : only the year will be used for the time. Default option. (e.g., &quot;1961&quot; &quot;1962&quot;...) <br />
-) <kbd>%Y-%m-%d</kbd>: a complete date format will be used for the time. (e.g., &quot;1961-01-01&quot; &quot;1962-01-01&quot;...). See Details.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_dates">dates</code></td>
<td>

<p>numeric, factor or Date object indicating how to obtain the dates for corresponding to each gauging station <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into Date class, using the date format specified by <code>date.fmt</code> <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days on it be equal to the number of element in <code>x</code>
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_out.type">out.type</code></td>
<td>

<p>Character that defines the desired type of output. Valid values are: <br />
-) <kbd>data.frame</kbd>: a data.frame, with as many columns as stations are included in <code>x</code>, and row names indicating the Year <br />
-) <kbd>db</kbd>        : a data.frame, with 3 columns will be produced. <br />
The first column (StationID) will store the ID of the station <br />
The second column (Year) will store the year, <br />
The third column (Value) will contain the annual value corresponding to the two previous columns.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2annual_+3A_...">...</code></td>
<td>

<p>arguments additional to <code>na.rm</code> passed to <code>FUN</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>FUN!=max</code> and <code>FUN!=min</code> the output is a zoo object with annual time frequency, where the time attribute has the format defined in <code>out.fmt</code>. <br />
When <code>FUN!=max</code> and <code>FUN!=min</code> and <code>out.fmt="%Y-%m-%d"</code> the time attribute of the output zoo object will use the 1st of January of each year to create a full Date object from the corresponding year of each element of the output object (e.g., fi the year is <kbd>2022</kbd>, the time attribute will be <kbd>2022-01-01</kbd>). The only exception occurrs when <code>FUN=max</code> or <code>FUN=min</code>, where the time attribute of each element will correspond to the actual date where the annual maximum/minimum occurs (which is very useful for identifying the date of the annual maximum or the annual minimum of a time series). <br />
</p>
<p>When <code>FUN=max</code> or <code>FUN=min</code> and <code>x</code> is a single time series, the output is a zoo object with annual time frequency, where the time attribute has the same class than <code>time(x)</code>, and the date(time) value corresponds to the date(time) where the maximum/minimum value actually occurs. <br />
When <code>FUN=max</code> or <code>FUN=min</code> and <code>x</code> has two or more time series, the output is a list object where each element has an annual time frequency. The time attribute of each list element has the same class than <code>time(x)</code>, and the date(time) value of each list element corresponds to the date(time) where the maximum/minimum value actually occurs. <br />
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subhourly2hourly">subhourly2hourly</a></code>, <code><a href="#topic+daily2monthly">daily2monthly</a></code>, <code><a href="#topic+monthly2annual">monthly2annual</a></code>, <code><a href="#topic+hydroplot">hydroplot</a></code>, <code><a href="#topic+annualfunction">annualfunction</a></code>, <code><a href="#topic+vector2zoo">vector2zoo</a></code>, <code><a href="base.html#topic+as.Date">as.Date</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################
## Ex1: Computation of annual values, removing any missing value in 'x'

# Loading the DAILY precipitation data at SanMartino
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Subsetting 'x' to its first three months (Jan/1921 - Mar/1921)
x &lt;- window(x, end="1921-03-31")

## Transforming into NA the 10% of values in 'x'
set.seed(10) # for reproducible results
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

## Agreggating from Daily to Annual, removing any missing value in 'x'
( a &lt;- daily2annual(x, FUN=sum, na.rm=TRUE) )

######################
## Ex2: Compuation of annual values only when the percentage of NAs in each
#       year is lower than a user-defined percentage (10% in this example).

# Loading the DAILY precipitation data at SanMartino
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Subsetting 'x' to its first three months (Jan/1921 - Mar/1921)
x &lt;- window(x, end="1921-03-31")

## Transforming into NA the 10% of values in 'x'
set.seed(10) # for reproducible results
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

## Daily to annual, only for months with less than 10% of missing values
( a2 &lt;- daily2annual(x, FUN=sum, na.rm=TRUE, na.rm.max=0.1) )

# Verifying that the second and third month of 'x' had 10% or more of missing values
cmv(x, tscale="annual")


######################
## Ex3: Getting the annual maximum value, including the date where this annual 
##      maximum actually occurs
daily2annual(x, FUN=max)


######################
## Ex4: Monthly to Annual (same result as )
m &lt;- daily2monthly(x, FUN=sum, na.rm=TRUE)
monthly2annual(m, FUN=sum, na.rm=TRUE)


######################
## Ex5: Loading the time series of HOURLY streamflows for the station Karamea at Gorge
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

# Sub-daily to monthly ts
subdaily2annual(x, FUN=mean, na.rm=TRUE)

############
## Ex6: Loading the monthly time series of precipitation within the Ebro River basin
data(EbroPPtsMonthly)

# computing the annual values for the first 10 gauging stations in 'EbroPPtsMonthly'
a &lt;- monthly2annual(EbroPPtsMonthly[,1:11], FUN=sum, dates=1)

# same as before, but with a nicer format of years
a &lt;- monthly2annual(EbroPPtsMonthly[,1:11], FUN=sum, dates=1, out.fmt="%Y")
</code></pre>

<hr>
<h2 id='+28sub+29daily2monthly'>
(sub)Daily -&gt; Monthly
</h2><span id='topic+daily2monthly'></span><span id='topic+daily2monthly.default'></span><span id='topic+daily2monthly.zoo'></span><span id='topic+daily2monthly.data.frame'></span><span id='topic+daily2monthly.matrix'></span><span id='topic+subdaily2monthly'></span><span id='topic+subdaily2monthly.default'></span><span id='topic+subdaily2monthly.zoo'></span><span id='topic+subdaily2monthly.data.frame'></span><span id='topic+subdaily2monthly.matrix'></span>

<h3>Description</h3>

<p>Generic function for transforming a DAILY (sub-daily or weekly) regular time series into a MONTHLY one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily2monthly(x, ...)
subdaily2monthly(x, ...)

## Default S3 method:
daily2monthly(x, FUN, na.rm=TRUE, na.rm.max=0, ...)

## S3 method for class 'zoo'
daily2monthly(x, FUN, na.rm=TRUE, na.rm.max=0, ...)

## S3 method for class 'data.frame'
daily2monthly(x, FUN, na.rm=TRUE, na.rm.max=0, dates=1, 
        date.fmt = "%Y-%m-%d", out.type = "data.frame", out.fmt="numeric", 
        verbose=TRUE, ...)

## S3 method for class 'matrix'
daily2monthly(x, FUN, na.rm=TRUE, na.rm.max=0, dates=1, 
        date.fmt = "%Y-%m-%d", out.type = "data.frame", out.fmt="numeric", 
        verbose=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with (sub)daily time series. <br />
Measurements at several gauging stations can be stored in a data.frame or matrix object, and in that case, each column of <code>x</code> represents the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_fun">FUN</code></td>
<td>

<p>Function that have to be applied for transforming from daily to monthly time step (e.g., for precipitation <code>FUN=sum</code> and for temperature and streamflow ts <code>FUN=mean</code>). <br />
</p>
<p><code>FUN</code> MUST accept the <code>na.rm</code> argument, because <code>na.rm</code> is passed to <code>FUN</code>.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the monthly values are computed only for months with a percentage of missing values less than <code>na.rm.max</code> <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the corresponing monthly values in the output object will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_na.rm.max">na.rm.max</code></td>
<td>

<p>Numeric in [0, 1]. It is used to define the maximum percentage of missing values allowed in each month to keep the monthly aggregated value in the output object of this function. In other words, if the percentage of missing values in a given month is larger or equal than <code>na.rm.max</code> the corresponding monthly value will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_dates">dates</code></td>
<td>

<p>numeric, factor or Date object indicating how to obtain the dates for each gauging station <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <var>x</var> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into Date class, using the date format specified by <code>date.fmt</code>  <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days on it be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_out.type">out.type</code></td>
<td>

<p>Character that defines the desired type of output. Valid values are:  <br />
-) <kbd>data.frame</kbd>: a data.frame, with as many columns as stations are included in <code>x</code>, and row names indicating the month and year for each value. <br />
-) <kbd>db</kbd>        : a data.frame, with 4 columns will be produced. <br />
The first column (StationID) stores the ID of the station, <br />
The second column (Year) stores the year <br />
The third column (Month) stores the Month  <br />
The fourth column (Value) stores the numerical values corresponding to the values specified in the three previous columns. <br />
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_out.fmt">out.fmt</code></td>
<td>

<p>OPTIONAL. Only used when <code>x</code> is a matrix or data.frame object /cr
character, for selecting if the result will be a matrix/data.frame or a zoo object. Valid values are: <kbd>numeric</kbd>, <kbd>zoo</kbd>.
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="+2B28sub+2B29daily2monthly_+3A_...">...</code></td>
<td>

<p>arguments additional to <code>na.rm</code> passed to <code>FUN</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a zoo object with monthly time frequency
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cmv">cmv</a></code>, <code><a href="#topic+subhourly2hourly">subhourly2hourly</a></code>, <code><a href="#topic+daily2annual">daily2annual</a></code>, <code><a href="#topic+subdaily2daily">subdaily2daily</a></code>, <code><a href="#topic+monthlyfunction">monthlyfunction</a></code>, <code><a href="#topic+hydroplot">hydroplot</a></code>, <code><a href="#topic+vector2zoo">vector2zoo</a></code>, <code><a href="#topic+izoo2rzoo">izoo2rzoo</a></code>, <code><a href="base.html#topic+as.Date">as.Date</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################
## Ex1: Computation of monthly values, removing any missing value in 'x'

# Loading the DAILY precipitation data at SanMartino
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Subsetting 'x' to its first three months (Jan/1921 - Mar/1921)
x &lt;- window(x, end="1921-03-31")

## Transforming into NA the 10% of values in 'x'
set.seed(10) # for reproducible results
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

## Agreggating from Daily to Monthly, removing any missing value in 'x'
m &lt;- daily2monthly(x, FUN=sum, na.rm=TRUE)

######################
## Ex2: Computation of monthly values only when the percentage of NAs in each
#       month is lower than a user-defined percentage (10% in this example).

# Loading the DAILY precipitation data at SanMartino
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Subsetting 'x' to its first three months (Jan/1921 - Mar/1921)
x &lt;- window(x, end="1921-03-31")

## Transforming into NA the 10% of values in 'x'
set.seed(10) # for reproducible results
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

## Daily to monthly, only for months with less than 10% of missing values
m2 &lt;- daily2monthly(x, FUN=sum, na.rm=TRUE, na.rm.max=0.1)

# Verifying that the second and third month of 'x' had 10% or more of missing values
cmv(x, tscale="month")

######################
## Ex3: Loading the HOURLY streamflows for the station Karamea at Gorge
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

# Sub-daily to monthly ts
subdaily2monthly(x, FUN=mean, na.rm=TRUE)
</code></pre>

<hr>
<h2 id='annualfunction'>
Annual Function
</h2><span id='topic+annualfunction'></span><span id='topic+annualfunction.default'></span><span id='topic+annualfunction.zoo'></span><span id='topic+annualfunction.data.frame'></span><span id='topic+annualfunction.matrix'></span>

<h3>Description</h3>

<p>Generic function for obtaining a SINGLE annual value of a zoo object, by applying any R function to ALL the values in <code>x</code> belonging to the same year, and then applying the same function to ALL the previously computed annual values (e.g., for computing the average annual precipitation or the mean annual streamflow of a long-term time series).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annualfunction(x, FUN, na.rm = TRUE, ...)

## Default S3 method:
annualfunction(x, FUN, na.rm = TRUE, ...)

## S3 method for class 'zoo'
annualfunction(x, FUN, na.rm = TRUE, ...)

## S3 method for class 'data.frame'
annualfunction(x, FUN, na.rm = TRUE, dates=1, date.fmt = "%Y-%m-%d", 
        verbose = TRUE, ...)
        
## S3 method for class 'matrix'
annualfunction(x, FUN, na.rm = TRUE, dates=1, date.fmt = "%Y-%m-%d", 
        verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annualfunction_+3A_x">x</code></td>
<td>

<p>zoo, xts, data.frame or matrix object, with daily/monthly/annual time series. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="annualfunction_+3A_fun">FUN</code></td>
<td>

<p>Function that will be used to compute the final annual value (e.g., <code>FUN</code> may be some of <code>mean</code>, <code>sum</code>, <code>max</code>, <code>min</code>, <code>sd</code>)  .
</p>
</td></tr>
<tr><td><code id="annualfunction_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed?. <br />
-) <kbd>TRUE</kbd> : the annual values are computed considering only those values different from NA <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a year, the resulting annual value will be NA 
</p>
</td></tr>
<tr><td><code id="annualfunction_+3A_dates">dates</code></td>
<td>

<p>numeric, factor or Date object indicating how to obtain the dates corresponding to each gauging station. <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br />
If <code>dates</code> is a factor, it have to be converted into Date class, using the date format specified by <code>date.fmt</code> <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="annualfunction_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="annualfunction_+3A_verbose">verbose</code></td>
<td>

<p>Logical; if TRUE, progress messages are printed. 
</p>
</td></tr>
<tr><td><code id="annualfunction_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>x</code> is a time series, a single annual value is returned. <br />
For a data frame, a named vector with the appropriate method being applied column by column.
</p>


<h3>Note</h3>

<p><code>FUN</code> is first applied to all the values of <code>x</code> belonging to the same year and then it is applied to all the previously computed annual values to get the final result.
Its result will depend on the sampling frequency of <code>x</code> and the type of function provided by <code>FUN</code> (<b>special attention have to be put when <code>FUN=sum</code></b>)
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monthlyfunction">monthlyfunction</a></code>, <code><a href="#topic+daily2annual">daily2annual</a></code>, <code><a href="#topic+monthly2annual">monthly2annual</a></code>, <code><a href="#topic+yip">yip</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the SanMartino daily precipitation data (1921-1990)
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Amount of years in 'x' (needed for computing the average)
nyears &lt;- length( seq(from=time(x[1]), to=time(x[length(x)]), by="years") )

## Average annual precipitation for the 70 years period. 
# It is necessary to divide by the amount of years to obtain the average annual value, 
# otherwise it will give the total precipitation for all the 70 years.
annualfunction(x, FUN=sum, na.rm=TRUE) / nyears


#####################
### verification ####
# Daily to annual
a &lt;- daily2annual(x, FUN=sum, na.rm=TRUE)

# Mean annual value
mean(a)

##############################
##############################
## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)
x &lt;- EbroPPtsMonthly

## Dates of 'x'
dates &lt;- as.Date(x[,1])


## Computation of the average annual precipitation
## Not run: 

## Transforming 'x' into a zoo object
z &lt;- zoo( x[, 2:ncol(x)], dates)

# Amount of years in 'x' (needed for computing the average)
nyears &lt;- yip(from=start(z), to=end(z), out.type="nmbr" )

## Average annual precipitation, for the first 5 stations in 'x'
annualfunction(z[ ,1:5], FUN=sum)/nyears
 

## End(Not run)

</code></pre>

<hr>
<h2 id='baseflow'>
Baseflow
</h2><span id='topic+baseflow'></span><span id='topic+baseflow.zoo'></span>

<h3>Description</h3>

<p>Given a complete (without missing values) series of streamflow, this function computes the baseflow using the filter proposed by Arnold and Allen (1999). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>baseflow(x, ...)

## S3 method for class 'zoo'
baseflow(x, beta=0.925, from=start(x), to=end(x), date.fmt, tz, 
         na.fill=c("none", "linear", "spline"), out.type=c("last", "all"), 
         plot=TRUE, xcol="black", bfcol=c("blue", "darkcyan", "darkorange3"),
         pch=15, cex=0.3, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="baseflow_+3A_x">x</code></td>
<td>

<p>zoo or numeric object with streamflow records. The suggested time frequency should be hourly or daily, but the algorithm will work with any time frequency.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_beta">beta</code></td>
<td>

<p>numeric representing the filter parameter. Default value is 0.925 as recommended by Arnold and Allen (1999)
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_from">from</code></td>
<td>

<p>Character indicating the starting date for subsetting <code>x</code>. It has to be in the format indicated by <code>date.fmt</code>. <br />
The default value corresponds to the date of the first element of <code>x</code>.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_to">to</code></td>
<td>

<p>Character indicating the ending date for subsetting <code>x</code>. It has to be in the format indicated by <code>date.fmt</code>. <br />
The default value corresponds to the date of the last element of <code>x</code>.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>from</code> and <code>to</code>, e.g. <kbd>%Y-%m-%d</kbd>. See &lsquo;Details&rsquo; section in <code><a href="base.html#topic+strptime">strptime</a></code>.
By default, <code>date.fmt</code> is missing, and it is automatically set to <kbd>%Y-%m-%d</kbd> when <code>time(x)</code> is <code>Date</code> object, and set to <kbd>%Y-%m-%d %H:%M:%S</kbd> when <code>x</code> is a sub-daily zoo object.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_tz">tz</code></td>
<td>

<p>character, with the specification of the time zone used for <code>from</code>, <code>to</code>. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> is UTC (Universal Time, Coordinated). See <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. <br />
</p>
<p>If <code>tz</code> is missing (the default), it is automatically set to the time zone used in <code>time(x)</code>. <br />
</p>
<p>This argument can be used when working with sub-daily zoo objects to force using  time zones other than the local time zone for <code>from</code> and <code>to</code>. It should be used with caution, being well aware of the time zone of the data. See examples.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_na.fill">na.fill</code></td>
<td>
<p>Character indicating how to fill any NA present in <code>x</code>. Valid values are: <br />
-) <kbd>remove</kbd>      =&gt; NAs are not plotted                                                         <br />
-) <kbd>linear</kbd>      =&gt; NAs are removed by linear interpolation, using <code><a href="zoo.html#topic+na.approx">na.approx</a></code> <br /> 
-) <kbd>spline</kbd>      =&gt; NAs are removed by spline interpolation, using <code><a href="zoo.html#topic+na.spline">na.spline</a></code>
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_out.type">out.type</code></td>
<td>

<p>Character indicating the type of result that is given by this function. Valid values are: <br />
-) <kbd>last</kbd> =&gt; only the baseflow computed after the third pass of the filter is returned. <br />
-) <kbd>all</kbd>  =&gt; the 3 baseflows computed after each pass of the filter are returned in a matrix or zoo object.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_plot">plot</code></td>
<td>

<p>logical. Indicates if the baseflow should be plotted or not. If plotted, the original <code>x</code> values are plotted as well.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_xcol">xcol</code></td>
<td>

<p>character, representing the color to be used for ploting the streamflow time series. Only used when <code>plot=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_bfcol">bfcol</code></td>
<td>

<p>character of lenght 3, representing the color(s) to be used for ploting the baseflow time series. The first, second and third element are used to represent the baseflow after the third, second and first pass of the filter, respectively. Only used when <code>plot=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_pch">pch</code></td>
<td>

<p>numeric, representing the symbols used for ploting the streamflow time series (both, the original series and the baseflow). Only used when <code>plot=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_cex">cex</code></td>
<td>

<p>a numerical vector giving the amount by which plotting characters and symbols should be scaled relative to the default. This works as a multiple of <code>par("cex")</code>. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. Only used when <code>plot=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="baseflow_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods. Not used yet.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Although most procedures to separate baseflow from total streamflow are based on physical reasoning, some elements of all separation techniques are subjective.
</p>
<p>The digital filter technique (Nathan and McMahon, 1990) implemented in this function was originally proposed by Lyne and Hollick (1979) for signal analysis and processing. Although this technique has no true physical meaning, it is objective and reproducible. 
</p>
<p>The equation of the filter is: 
</p>
<p>q(t) = Beta*q(t-1) + [ (1+Beta)/2 ]*[ Q(t) - Q(t-1) ]
</p>
<p>where q(t) is the filtered surface runoff (quick response) at the time step t (one day), Q is the original streamflow, and Beta is the filter parameter (Beta=0.925). The value Beta=0.925 was obtained by Nathan and McMahon (1990) and Arnold et al. (1995) to give realistic results when compared to manual separation techniques.
</p>
<p>Baseflow b(t) is then computed as:
</p>
<p>b(t) = Q(t) - q(t)
</p>
<p>The filter can be passed over the streamflow data three times (forward, backward, and forward), depending on the user' selected estimates of baseflow from pilot studies. In general, each pass will result in less baseflow as a percentage of total streamflow. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>If out.type="last"</code></td>
<td>
<p>(default value), only the baseflow computed after the third pass of the filter is returned.</p>
</td></tr>
<tr><td><code>If out.type="all"</code></td>
<td>
<p>the 3 baseflows computed after each pass of the filter are returned in a matrix or zoo object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>References</h3>

<p><cite>Arnold, J. G., Allen, P. M., Muttiah, R., Bernhardt, G. (1995). Automated base flow separation and recession analysis techniques. Groundwater, 33(6), 1010&ndash;1018. doi:10.1111/j.1745-6584.1995.tb00046.x</cite>.
</p>
<p><cite>Arnold, J. G., Allen, P. M. (1999). Automated methods for estimating baseflow and ground water recharge from streamflow records. JAWRA Journal of the American Water Resources Association, 35(2), 411&ndash;424. doi:10.1111/j.1752-1688.1999.tb03599.x</cite>.
</p>
<p><cite>Lyne, V., Hollick, M. (1979). Stochastic time-variable rainfall-runoff modelling. Proceedings of the Hydrology and Water Resources Symposium, Perth, 10&ndash;12 September. Institution of Engineers National Conference Publication, No. 79/10, 89&ndash;92</cite>.
</p>
<p><cite>Nathan, R. J., &amp; McMahon, T. A. (1990). Evaluation of automated techniques for base flow and recession analyses. Water resources research, 26(7), 1465&ndash;1473. doi:10.1029/WR026i007p01465</cite>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_pq">plot_pq</a></code>, <code><a href="#topic+hydroplot">hydroplot</a></code>, <code><a href="#topic+fdc">fdc</a></code>, <code><a href="#topic+fdcu">fdcu</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################
## Ex1: Computing and plotting the baseflows for the full time period
##      of a given time series of streamflows.

## First, we load the daily Q time series for the Cauquenes en 
## El Arrayan catchment, where Q, [m3/s] are stored in the sixth column.
data(Cauquenes7336001)
q &lt;- Cauquenes7336001[, 6]

## Computing the daily baseflow for the full time period
#baseflow(q) # it can not run due to NA values in 'x'

# filling the NA values using spline interpolation
baseflow(q, na.fill="spline") 

## Computing and plotting the daily baseflow for the full time period
baseflow(q, na.fill="spline", plot=TRUE)


######################
## Ex2: Computing and plotting the daily baseflow only for a 
##      specific time period, from April to December 2000.
baseflow(q, na.fill="spline", from="2000-04-01", to="2000-12-31")


######################
## Ex3: Computing and plotting the three daily baseflows (one for each pass 
##      of the filter) only for a specific time period, from April to December
##      2000.
baseflow(q, na.fill="spline", from="2000-04-01", to="2000-12-31", 
         out.type="all", plot=TRUE)
</code></pre>

<hr>
<h2 id='calendarHeatmap'>
Calendar heatmap
</h2><span id='topic+calendarHeatmap'></span><span id='topic+calendarHeatmap.zoo'></span>

<h3>Description</h3>

<p>Function to plot a heatmap of a daily zoo object with a calendar shape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calendarHeatmap(x, ...)

## S3 method for class 'zoo'
calendarHeatmap(x, from, to, date.fmt="%Y-%m-%d",
                main="Calendar Heat Map",
                col=colorRampPalette(c("red", "orange", "yellow", "white", 
                    "lightblue2", "deepskyblue", "blue3"),  space = "Lab")(8),  
                cuts, cuts.dec=0, cuts.labels, 
                cuts.style=c("fisher", "equal", "pretty", "fixed", "sd", 
                             "quantile", "kmeans", "bclust", "mzb"), 
                legend.title="", legend.fontsize=15,              
                do.png=FALSE, png.fname="mypng.png", png.width=1500, 
                png.height=900, png.pointsize=12, png.res=90,
                do.pdf=FALSE, pdf.fname="mypdf.pdf", pdf.width=11,
                pdf.height=8.5, pdf.pointsize=12, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calendarHeatmap_+3A_x">x</code></td>
<td>

<p>daily zoo object to be plotted. Its maximum amount of daily data should be less than 6 years or otherwise it will not be plotted.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_from">from</code></td>
<td>

<p>Character indicating the starting date for subsetting <code>x</code>. It has to be in the format indicated by <code>date.fmt</code>. 
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_to">to</code></td>
<td>

<p>Character indicating the ending date for subsetting <code>x</code>. It has to be in the format indicated by <code>date.fmt</code>. 
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>from</code> and <code>to</code>, e.g. <kbd>%Y-%m-%d</kbd>. See &lsquo;Details&rsquo; section in <code><a href="base.html#topic+strptime">strptime</a></code>.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_main">main</code></td>
<td>

<p>character, Main chart title.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_col">col</code></td>
<td>

<p>A color palette, i.e. a vector of n contiguous colors generated by functions like rainbow, heat.colors, topo.colors, bpy.colors or one of your own making, perhaps using <code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code>. If none is provided, a color ramp with 8 colours is created using <code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code>. 
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_cuts">cuts</code></td>
<td>

<p>Numeric, indicating the values used to divide the range of <code>x</code> in the legend of colours. If not provided, it is automatically selected as a function of <code>lenght(col)</code>.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_cuts.dec">cuts.dec</code></td>
<td>

<p>Number of decimal places used to present the numbers in the legend of colours.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_cuts.labels">cuts.labels</code></td>
<td>

<p>Character indicating the label to be used in the colour legend for each one of the values defined by <code>cuts</code>. If not provided, <code>as.character(cuts)</code> is used.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_cuts.style">cuts.style</code></td>
<td>

<p>discarded because takes too much time or not alway provide the required number of classes: &quot;dpih&quot;, &quot;headtails&quot;, &quot;hclust&quot;,  &quot;jenks&quot;.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_legend.title">legend.title</code></td>
<td>

<p>text to be displayed above the legend of colours.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_legend.fontsize">legend.fontsize</code></td>
<td>

<p>size of text (in points) used in the legend of colours.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_do.png">do.png</code></td>
<td>

<p>Do you want to write the figure as a .png file? logical, set TRUE to save the image.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_png.fname">png.fname</code></td>
<td>

<p>character, indicating the name of the file (possibly with a meaninful file extension) that will be used to write the output file.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_png.width">png.width</code></td>
<td>

<p>numeric, the width of the device.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_png.height">png.height</code></td>
<td>

<p>numeric, the height of the device.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_png.pointsize">png.pointsize</code></td>
<td>

<p>integer, the default pointsize of plotted text, interpreted as big points (1/72 inch) at <code>res</code> ppi.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_png.res">png.res</code></td>
<td>

<p>integer, the nominal resolution in ppi which will be recorded in the bitmap file, if a positive integer. Also used for units other than the default, and to convert points to pixels.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_do.pdf">do.pdf</code></td>
<td>

<p>Do you want to write the figure as a .pdf file? logical, set TRUE to save the image.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_pdf.fname">pdf.fname</code></td>
<td>

<p>character, indicating the name of the file (possibly with a significant extension) that will be used to write the output file.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_pdf.width">pdf.width</code></td>
<td>

<p>numeric, the width of the device.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_pdf.height">pdf.height</code></td>
<td>

<p>numeric, the height of the device.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_pdf.pointsize">pdf.pointsize</code></td>
<td>

<p>integer, the default point size to be used. Strictly speaking, in bp, that is 1/72 of an inch, but approximately in points. Defaults to 12.
</p>
</td></tr>
<tr><td><code id="calendarHeatmap_+3A_...">...</code></td>
<td>

<p>further arguments passed to functions or from other methods. Not used yet.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The original function <code>calendarHeat</code> was developed by Paul Bleicher, as an R version of a graphic from http://stat-computing.org/dataexpo/2009/posters/wicklin-allison.pdf (not available any longer).
The original function was made available online in 2009, but then it was removed. Now it is available at <a href="https://github.com/tavisrudd/r_users_group_1/blob/master/calendarHeat.R">https://github.com/tavisrudd/r_users_group_1/blob/master/calendarHeat.R</a>.
The original function has &quot;Copyright 2009 Humedica&quot;, but it was distributed under the GPL-2 licence, as well as this new version of the function.
</p>
<p>This slighly modified verison of the function is also distributed under the GPL-2 licence, and teh main changes with respect to the original function are: <br />
</p>
<p>1) uses a zoo object instead of a numeric and character vector, for values and dates, respectively. <br />
2) it allows a customisation of the mian title of the output figure. <br />
3) it allows a customisation of the color palette. <br />
4) it uses a categorical legend instead of a continuos one. <br />
5) it is named <code>calendarHeatmap</code> instead of <code>calendarHeat</code>.
</p>


<h3>Value</h3>

<p>The output of this function is a lattice figure with the calendar heatmap
</p>


<h3>Note</h3>

<p>The maximum amount of years to be plotted is six (6).
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail.com">mzb.devel@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code>, <code><a href="lattice.html#topic+levelplot">levelplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###########
# EXAMPLE 1: basic plotting of a calendar heatmap
###########

# Loading daily streamflow data for Karamet at Gorges.
data(KarameaAtGorgeQts)

x &lt;- KarameaAtGorgeQts
x &lt;- subdaily2daily(x, FUN=mean)

# Temporal subsetting for a amaximum of 6 years
x &lt;- window(x, start="1980-01-01", end="1985-12-31")

# Calendar Heatmap, 8 colours and cuts defined using Fisher method 
calendarHeatmap(x)

</code></pre>

<hr>
<h2 id='Cauquenes7336001'>
Hydrometeorological time series for &quot;Cauquenes en El Arrayan&quot; catchment
</h2><span id='topic+Cauquenes7336001'></span>

<h3>Description</h3>

<p>Daily time series of precipitation, maximum air temperature, minimum air temperature, potential evapotranspiration, and observed streamflows for the catchment draining into the 'Cauquenes en El Arrayan' streamflow station (Cod.BNA: 7336001, Lat:-36.02, Lon:-72.38). This catchment is located in El Maule Region in Chile, with a pluvial regime, a total drainage area of 622.1 km2, and elevations ranging from 134 to 736 m a.s.l. Data were downloaded from the CAMELS-CL dataset (<a href="https://camels.cr2.cl">https://camels.cr2.cl</a>) from 01/Jan/1979 to 31/Dec/2019 (including some missing values).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Cauquenes7336001)
</code></pre>


<h3>Format</h3>

<p>zoo matrix with 5 time series: <br />
-) <var>P_mm</var>: Spatially-averaged mean daily values of precipitation computed based on the CR2met dataset, [mm/day]. <br />
-) <var>Tmx_degC</var>: Spatially-averaged maximum daily values of air temperature computed based on the CR2met dataset, [degree Celsius]. <br />
-) <var>Tmin_degC</var>: Spatially-averaged minimum daily values of air temperature computed based on the CR2met dataset, [degree Celsius]. <br />
-) <var>PET_mm</var>: Spatially-averaged mean daily values of precipitation computed based on the Hargreaves-Samani equation and daily maximum and minimum air temperatures obtained from the CR2met dataset, [mm/day]. <br /> 
-) <var>Qobs_mm</var>: Daily sreamflows, [mm], measured at the &quot;Cauquenes en El Arrayan&quot; (7336001) station. <br /> 
-) <var>Qobs_m3s</var>: Daily sreamflows, [m3/s], measured at the &quot;Cauquenes en El Arrayan&quot; (7336001) station. <br /> 
</p>


<h3>Source</h3>

<p>Provided by Center for Climate and Resilience Research, Universidad de Chile, Santiago, Chile (<a href="https://camels.cr2.cl/">https://camels.cr2.cl/</a>, last accessed [Nov 2023]). <br />
These data are intended to be used for research purposes only, being distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY.
</p>


<h3>References</h3>

<p><cite>Alvarez-Garreton, C., Mendoza, P. A., Boisier, J. P., Addor, N., Galleguillos, M., Zambrano-Bigiarini, M., Lara, A., Puelma, C., Cortes, G., Garreaud, R., McPhee, J., and Ayala, A (2018). The CAMELS-CL dataset: catchment attributes and meteorology for large sample studies-Chile dataset. Hydrology and Earth System Sciences, 22(11), 5817-5846. doi:10.5194/hess-22-5817-2018.</cite>
</p>

<hr>
<h2 id='climograph'>
Climograph
</h2><span id='topic+climograph'></span>

<h3>Description</h3>

<p>Function to draw a climograph based on precipitation and air temperature data, with several options for customisation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climograph(pcp, tmean, tmx, tmn, na.rm=TRUE,  
           from, to, date.fmt="%Y-%m-%d", 
           main="Climograph", pcp.label="Precipitation, [mm]", 
           tmean.label="Air temperature, [\U00B0 C]", start.month=1, pcp.solid.thr,
           pcp.ylim, temp.ylim,pcp.col="lightblue", pcp.solid.col="skyblue2", 
           tmean.col="darkred", tmn.col="blue", tmx.col="red",
           pcp.labels=TRUE, 
           tmean.labels=TRUE, tmx.labels=TRUE, tmn.labels=TRUE,
           pcp.labels.cex=0.8, temp.labels.cex=0.8,
           pcp.labels.dx=c(rep(ifelse(plot.pcp.probs, -0.25,  0.0),6), 
                           rep(ifelse(plot.pcp.probs, -0.25,  0.0),6)),
           pcp.labels.dy=rep(2, 12),
           temp.labels.dx=c(rep(-0.2,6), rep(0.2,6)), temp.labels.dy=rep(-0.4, 12),
           plot.pcp.probs=TRUE, pcp.probs=c(0.25, 0.75),
           plot.temp.probs=TRUE, temp.probs=c(0.25, 0.75), 
           temp.probs.col=c("#3399FF", "#FF9966", "#FFCC66"),
           temp.probs.alpha=0.3,
           lat, lon
           )

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="climograph_+3A_pcp">pcp</code></td>
<td>

<p>variable of type zoo with monthly, daily or subdaily precipitation data.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmean">tmean</code></td>
<td>

<p>variable of type 'zoo' with monthly, daily or subdaily mean temperature data.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmx">tmx</code></td>
<td>

<p>variable of type 'zoo' with monthly, daily or subdaily maximum temperature data. <br />
ONLY used (together with <code>tmn</code>) when <code>tmean</code>' is missing.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmn">tmn</code></td>
<td>

<p>variable of type 'zoo' with monthly, daily or subdaily minimum temperature data. 
ONLY used (together with <code>tmx</code>) when <code>tmean</code> is missing.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the monthly values  are computed considering only those values different from NA <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the resulting average monthly value is NA .
</p>
</td></tr>
<tr><td><code id="climograph_+3A_from">from</code></td>
<td>

<p>OPTIONAL, used for extracting a subset of values. <br />
Character indicating the starting date for the values to be extracted. It must be provided in the format specified by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_to">to</code></td>
<td>

<p>OPTIONAL, used for extracting a subset of values. <br />
Character indicating the ending date for the values to be extracted. It must be provided in the format specified by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_date.fmt">date.fmt</code></td>
<td>

<p>Character indicating the format in which the dates are stored in <var>dates</var>, <var>from</var> and <var>to</var>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_main">main</code></td>
<td>

<p>Character representing the main title of the plot. 
</p>
</td></tr>
<tr><td><code id="climograph_+3A_pcp.label">pcp.label</code></td>
<td>

<p>Character used in the legend to represent the monthly average precipitation (mostly thought for languages different from English). 
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmean.label">tmean.label</code></td>
<td>

<p>Character used in the legend to represent the monthly average temperature (mostly thought for languages different from English). 
</p>
</td></tr>
<tr><td><code id="climograph_+3A_start.month">start.month</code></td>
<td>

<p>[OPTIONAL]. Only used when the (hydrological) year of interest is different from the calendar year.
</p>
<p>numeric in [1:12] indicating the starting month of the (hydrological) year. Numeric values in [1, 12] represents months in [January, December]. By default <code>start.month=1</code>.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_pcp.solid.thr">pcp.solid.thr</code></td>
<td>

<p>[OPTIONAL]. Only used when using (sub)daily precipitation and temperature are gives as input data. <br />
numeric, indicating the temperature, in degrees Celsius, used to discriminate between solid and liquid precipitation. <br />
</p>
<p>When daily <code>tmean &lt;= pcp.solid.thr</code> the precipitation for that day is considered as solid precipitation.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_pcp.ylim">pcp.ylim</code></td>
<td>

<p>[OPTIONAL] numeric of length 2 with the the range used for the precipitation axis. The second value should be larger than the first one.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_temp.ylim">temp.ylim</code></td>
<td>

<p>[OPTIONAL] numeric of length 2 with the the range used for the secondary temperature axis. The second value should be larger than the first one.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_pcp.col">pcp.col</code></td>
<td>

<p>Color used in the legend to represent the monthly average precipitation. 
</p>
</td></tr>
<tr><td><code id="climograph_+3A_pcp.solid.col">pcp.solid.col</code></td>
<td>

<p>Color used in the legend to represent the monthly average solid precipitation. 
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmean.col">tmean.col</code></td>
<td>

<p>Color used in the legend to represent the monthly average temperature. 
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmn.col">tmn.col</code></td>
<td>

<p>Color used in the legend to represent the monthly minimum temperature. 
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmx.col">tmx.col</code></td>
<td>

<p>Color used in the legend to represent the monthly maximum temperature. 
</p>
</td></tr>
<tr><td><code id="climograph_+3A_pcp.labels">pcp.labels</code></td>
<td>

<p>logical. Should monthly precipitation values to be shown above the bars?. By default <code>pcp.labels=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmean.labels">tmean.labels</code></td>
<td>

<p>logical. Should monthly mean temperature values to be shown above the lines?. By default <code>tmean.labels=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmx.labels">tmx.labels</code></td>
<td>

<p>logical. Should monthly maximum temperature values to be shown above the lines?. By default <code>tmx.labels=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_tmn.labels">tmn.labels</code></td>
<td>

<p>logical. Should monthly minimum temperature values to be shown above the lines?. By default <code>tmn.labels=TRUE</code>.
</p>
</td></tr> 
<tr><td><code id="climograph_+3A_pcp.labels.cex">pcp.labels.cex</code></td>
<td>

<p>numeric giving the amount by which plotting characters used to show the numeric values of monthly precipitation values are scaled relative to the default. <br />
It is only used when <code>pcp.labels=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_temp.labels.cex">temp.labels.cex</code></td>
<td>

<p>numeric giving the amount by which plotting characters used to show the numeric values of monthly air temperature values (mean, maximum, minimum) are scaled relative to the default.   <br />
It is only used when <code>tmean.labels=TRUE</code> or <code>tmx.labels=TRUE</code> or <code>tmn.labels=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_pcp.labels.dx">pcp.labels.dx</code></td>
<td>

<p>numeric of length 12 giving the amount of horizontal coordinate positions that have to be used to shift the labels of monthly precipitation values. <br />
It is only used when <code>pcp.labels=TRUE</code>. <br />
Lengths smaller than 12 are recycled and larger lengths are not used.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_pcp.labels.dy">pcp.labels.dy</code></td>
<td>

<p>numeric of length 12 giving the amount of vertical coordinate positions that have to be used to shift the labels of monthly precipitation values. <br />
It is only used when <code>pcp.labels=TRUE</code>. <br />
Lengths smaller than 12 are recycled and larger lengths are not used.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_temp.labels.dx">temp.labels.dx</code></td>
<td>

<p>numeric of length 12 giving the amount of horizontal coordinate positions that have to be used to shift the labels of monthly air temperature values (mean, maximum, minimum). <br />
It is only used when <code>tmean.labels=TRUE</code> or <code>tmx.labels=TRUE</code> or <code>tmn.labels=TRUE</code>. <br />
Lengths smaller than 12 are recycled and larger lengths are not used.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_temp.labels.dy">temp.labels.dy</code></td>
<td>

<p>numeric of length 12 giving the amount of vertical coordinate positions that have to be used to shift the labels of monthly air temperature values (mean, maximum, minimum). <br />
It is only used when <code>tmean.labels=TRUE</code> or <code>tmx.labels=TRUE</code> or <code>tmn.labels=TRUE</code>. <br />
Lengths smaller than 12 are recycled and larger lengths are not used.
</p>
</td></tr>
<tr><td><code id="climograph_+3A_plot.pcp.probs">plot.pcp.probs</code></td>
<td>

<p>logical used to decide whether to show uncertainty values around the monthly mean precipitation values. By default <code>plot.pcp.probs=TRUE</code>. <br /> 
When <code>plot.pcp.probs=TRUE</code> the <code>pcp.probs</code> argument is used to define the values of the lower an upper uncertainty bounds.
</p>
</td></tr> 
<tr><td><code id="climograph_+3A_pcp.probs">pcp.probs</code></td>
<td>

<p>numeric of length 2. It defines the quantile values used to compute the lower an upper uncertainty bounds for each one of the 12 monthly precipitation values.<br /> 
By default <code>pcp.probs=c(0.25, 0.75)</code>, which indicates that the quantiles 0.25 and 0.75 are used to compute the lower an upper uncertainty bounds for each one of the 12 monthly precipitation values. 
If <code>pcp</code> is a (sub)daily zoo object, it is first aggregated into monthly values using <code>mean</code>, and then the <code>pcp.probs</code> quantiles are computed over all the monthly values belonging to a calendar month.
</p>
</td></tr> 
<tr><td><code id="climograph_+3A_plot.temp.probs">plot.temp.probs</code></td>
<td>

<p>logical used to decide whether to show uncertainty values around the monthly mean temperature values. By default <code>plot.temp.probs=TRUE</code>. <br /> 
When <code>plot.temp.probs=TRUE</code> the <code>temp.probs</code> argument is used to define the values of the lower an upper uncertainty bounds.
</p>
</td></tr> 
<tr><td><code id="climograph_+3A_temp.probs">temp.probs</code></td>
<td>

<p>numeric of length 2. It is used to define quantile values used to compute the lower an upper uncertainty bounds for each one of the 12 monthly mean temperature values.<br /> 
If <code>tmx</code> and <code>tmn</code> are provided, then <code>temp.probs</code> are used to compute the lower an upper uncertainty bounds for each one of the 12 monthly maximum/minimum temperature values. <br />
By default <code>temp.probs=c(0.25, 0.75)</code>, which indicates that the quantiles 0.25 and 0.75 are used to compute the lower an upper uncertainty bounds for each one of the 12 monthly mean(maximum/minimum) values. 
If <code>tmx/tmn</code> is provided and is a (sub)daily zoo object, it is first aggregated into monthly values using <code>mean</code>, and then the <code>temp.probs</code> quantiles are computed over all the monthly values belonging to a calendar month.
</p>
</td></tr> 
<tr><td><code id="climograph_+3A_temp.probs.col">temp.probs.col</code></td>
<td>

<p>character of length 3, with the colors used to for plotting the uncertainty bands around the average monthly values of the minimum, mean and maximum air temperature, respectively. <br />
If <code>tmx</code> and <code>tmn</code> are not provided by the user, the second element of <code>temp.probs.col</code> will still be used to define the color of the  uncertainty band around the mean monthly values of air temperature.
</p>
</td></tr> 
<tr><td><code id="climograph_+3A_temp.probs.alpha">temp.probs.alpha</code></td>
<td>

<p>numeric of length 1, with the factor used to modify the opacity of <code>temp.probs.col</code>. Typically in [0,1], with 0 indicating a completely transparent colour and 1 indicating no transparency.
</p>
</td></tr> 
<tr><td><code id="climograph_+3A_lat">lat</code></td>
<td>

<p>[OPTIONAL] numeric or character used to show the latitude for which the climograph was plotted for.
</p>
</td></tr> 
<tr><td><code id="climograph_+3A_lon">lon</code></td>
<td>

<p>[OPTIONAL] numeric or character used to show the longitude for which the climograph was plotted for.
</p>
</td></tr> 
</table>


<h3>Note</h3>

<p>If the output climograph present some mixed or not legible characters, you might try resizing the graphical window and run climograph again with the new size, until you get the climograph in the way you want to.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monthlyfunction">monthlyfunction</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################
## Ex1: Loading the DAILY precipitation, maximum and minimum air temperature at 
##      station Maquehue Temuco Ad (Chile)
data(MaquehueTemuco)
pcp &lt;- MaquehueTemuco[, 1]
tmx &lt;- MaquehueTemuco[, 2]
tmn &lt;- MaquehueTemuco[, 3]

## Plotting a full climograph
m &lt;- climograph(pcp=pcp, tmx=tmx, tmn=tmn, na.rm=TRUE, 
                main="Maquehue Temuco Ad (Chile)", lat=-38.770, lon=-72.637)

## Not run: 
## Plotting a climograph with uncertainty bands around mean values, 
## but with no labels for tmx and tmn
m &lt;- climograph(pcp=pcp, tmx=tmx, tmn=tmn, na.rm=TRUE, tmx.labels=FALSE, tmn.labels=FALSE, 
                main="Maquehue Temuco Ad (Chile)", lat=-38.770, lon=-72.637)

## Plotting a climograph with uncertainty bands around mean values, but with no labels for 
##  tmx, tmn and pcp
m &lt;- climograph(pcp=pcp, tmx=tmx, tmn=tmn, na.rm=TRUE, 
                pcp.labels=FALSE, tmean.labels=FALSE, tmx.labels=FALSE, tmn.labels=FALSE, 
                main="Maquehue Temuco Ad (Chile)", lat=-38.770, lon=-72.637)

## Plotting a climograph with no uncertainty bands around mean values
m &lt;- climograph(pcp=pcp, tmx=tmx, tmn=tmn, na.rm=TRUE, plot.pcp.probs=FALSE, plot.temp.probs=FALSE, 
                main="Maquehue Temuco Ad (Chile)", lat=-38.770, lon=-72.637)

## Plotting the most basic climograph: only mean values of precipiation and air temperature
m &lt;- climograph(pcp=pcp, tmean=0.5*(tmn+tmx), na.rm=TRUE, plot.pcp.probs=FALSE, 
                plot.temp.probs=FALSE, main="Maquehue Temuco Ad (Chile)", 
                lat=-38.770, lon=-72.637)


## Plotting a full climograph, starting in April (start.month=4) instead of January (start.month=1),
## to better represent the hydrological year in Chile (South America)
m &lt;- climograph(pcp=pcp, tmx=tmx, tmn=tmn, na.rm=TRUE, 
                start.month=4, temp.labels.dx=c(rep(-0.2,4), rep(0.2,6),rep(-0.2,2)),
                main="Maquehue Temuco Ad (Chile)", lat=-38.770, lon=-72.637)


## Plotting a full climograph with monthly data
pcp.m &lt;- daily2monthly(pcp, FUN=sum)
tmx.m &lt;- daily2monthly(tmx, FUN=mean)
tmn.m &lt;- daily2monthly(tmn, FUN=mean)
m &lt;- climograph(pcp=pcp.m, tmx=tmx.m, tmn=tmn.m, na.rm=TRUE, 
                main="Maquehue Temuco Ad (Chile)", lat=-38.770, lon=-72.637)

## End(Not run)

</code></pre>

<hr>
<h2 id='cmv'>
Counting Missing Values
</h2><span id='topic+cmv'></span><span id='topic+cmv.default'></span><span id='topic+cmv.zoo'></span><span id='topic+cmv.data.frame'></span><span id='topic+cmv.matrix'></span>

<h3>Description</h3>

<p>Generic function for counting the percentage/amount of missing values in a zoo object, using a user-defined temporal scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmv(x, ...)

## Default S3 method:
cmv(x, tscale=c("hourly", "daily", "weekly", "monthly", 
            "quarterly", "seasonal", "annual"),
            out.type=c("percentage", "amount"), dec=3, 
            start="00:00:00", start.fmt= "%H:%M:%S", tz, ...)

## S3 method for class 'zoo'
cmv(x, tscale=c("hourly", "daily", "weekly", "monthly", 
            "quarterly", "seasonal", "annual"),
            out.type=c("percentage", "amount"), dec=3, 
            start="00:00:00", start.fmt= "%H:%M:%S", tz, ...)

## S3 method for class 'data.frame'
cmv(x, tscale=c("hourly", "daily", "weekly", "monthly", 
            "quarterly", "seasonal", "annual"),
            out.type=c("percentage", "amount"), dec=3, 
            start="00:00:00", start.fmt= "%H:%M:%S", tz, 
            dates=1, date.fmt="%Y-%m-%d", ...)

## S3 method for class 'matrix'
cmv(x, tscale=c("hourly", "daily", "weekly", "monthly", 
            "quarterly", "seasonal", "annual"),
            out.type=c("percentage", "amount"), dec=3, 
            start="00:00:00", start.fmt= "%H:%M:%S", tz,
            dates=1, date.fmt="%Y-%m-%d", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cmv_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with the time series to be analised. <br />
Measurements at several gauging stations can be stored in a data.frame or matrix object, and in that case, each column of <code>x</code> represents the time series measured in a gauging statio, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="cmv_+3A_tscale">tscale</code></td>
<td>

<p>character with the temporal scale to be used for analysing the mssing data. Valid values are: <br />
-) <kbd>hourly</kbd>: the percentage/amount of missing values will be given for each hour and ,therefore, the expected time frequency of <code>x</code> must be sub-hourly. <br />
-) <kbd>daily</kbd>: the percentage/amount of missing values will be given for each day and, therefore, the expected time frequency of <code>x</code>  must be sub-daily (i.e., hourly or sub-hourly). <br />
-) <kbd>weekly</kbd>: the percentage/amount of missing values will be given for each week (starting on Monday) and, therefore, the expected time frequency of <code>x</code> must be sub-weekly (i.e., daily, (sub)hourly). <br />
-) <kbd>monthly</kbd>: the percentage/amount of missing values will be given for each month and, therefore, the expected time frequency of <code>x</code> must be sub-monthly (i.e., daily, hourly or sub-hourly). <br />
-) <kbd>quarterly</kbd>: the percentage/amount of missing values will be given for each quarter and, therefore, the expected time frequency of <code>x</code> must be sub-quarterly (i.e., monthly, daily, hourly or sub-hourly). <br />
-) <kbd>seasonal</kbd>: the percentage/amount of missing values will be given for each weather season (see ?time2season) and, therefore, the expected time frequency of <code>x</code> must be sub-seasonal (i.e., monthly, daily, hourly or sub-hourly). <br />
-) <kbd>annual</kbd>: the percentage/amount of missing values will be given for each year and, therefore, the expected time frequency of <code>x</code> must be sub-annual (i.e., seasonal, monthly, daily, hourly or sub-hourly). <br />
</p>
</td></tr>
<tr><td><code id="cmv_+3A_dec">dec</code></td>
<td>

<p>integer indicating the amount of decimal places included in the output. <br />
It is only used when <code>out.type=='percentage'</code>.
</p>
</td></tr>
<tr><td><code id="cmv_+3A_start">start</code></td>
<td>

<p>character, indicating the starting time used for aggregating sub-daily time series into daily ones. It MUST be provided in the format specified by <code>start.fmt</code>. <br />
This value is used to define the time when a new day begins (e.g., for some rain gauge stations). <br />
-) All the values of <code>x</code> with a time attribute before <code>start</code> are considered as belonging to the day before the one indicated in the time attribute of those values. <br />
-) All the values of <code>x</code> with a time attribute equal to <code>start</code> are considered to be equal to <code>"00:00:00"</code> in the output zoo object. <br />
-) All the values of <code>x</code> with a time attribute after <code>start</code> are considered as belonging to the same day as the one indicated in the time attribute of those values. <br />
</p>
<p>It is useful when the daily values start at a time different from <code>"00:00:00"</code>. Use with caution. See examples.
</p>
</td></tr>
<tr><td><code id="cmv_+3A_start.fmt">start.fmt</code></td>
<td>

<p>character indicating the format in which the time is provided in <code>start</code>, By default <code>date.fmt=%H:%M:%S</code>. See <code>format</code> in <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>.
</p>
</td></tr>
<tr><td><code id="cmv_+3A_tz">tz</code></td>
<td>

<p>character, with the specification of the time zone used in both <code>x</code> and <code>start</code>. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> is UTC (Universal Time, Coordinated). See <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. <br />
If <code>tz</code> is missing (the default), it is automatically set to the time zone used in <code>time(x)</code>. <br />
This argument can be used to force using the local time zone or any other time zone instead of UTC as time zone.
</p>
</td></tr>
<tr><td><code id="cmv_+3A_dates">dates</code></td>
<td>

<p>numeric, factor, POSIXct or POSIXt object indicating how to obtain the dates and times for each column of <code>x</code> (e.g., gauging station). <br />
If <code>dates</code> is a number, it indicates the index of the column in <code>x</code> that stores the date and times. <br />
If <code>dates</code> is a factor, it is converted into POSIXct class, using the date format specified by <code>date.fmt</code>  <br />
If <code>dates</code> is already of POSIXct or POSIXt class, this function verifies that the number of elements on it be equal to the number of elements in <code>x</code>.
</p>
</td></tr>
<tr><td><code id="cmv_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>dates</code>, By default <code>date.fmt=%Y-%m-%d %H:%M:%S</code>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="cmv_+3A_out.type">out.type</code></td>
<td>

<p>character indicating how should be returned the missing values for each temporal scale. Valid values are: <br />
-) <kbd>percentage</kbd>: the missing values are returned as an real value, representing the percentage of missing values in each temporal scale. <br />
-) <kbd>amount</kbd>: the missing values are returned as an integer value, representing the absolute amount of missing values in each temporal scale.
</p>
</td></tr>
<tr><td><code id="cmv_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The amount of missing values in each temporal scale is computed just by counting the amount of NAs in each hour / day / week / month / quarter / season / year, while the percentage of missing values in each temporal scale is computed by dividing the previous number by the total number of data elements in each hour / day / week / month / quarter / season / year. <br />
</p>
<p>This function was developed to allow the selective removal of values when agregting from a high temporal resolution into a lower temporal resolution (e.g., from hourly to daily or from daily to monthly), using any of the temporal aggregation functions available int his package (e.g., <code>hourly2daily</code>, <code>daily2monthly</code>)
</p>


<h3>Value</h3>

<p>a zoo object with the percentage/amount of missing values for each temporal scale selected by the user.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dwi">dwi</a></code>, <code><a href="#topic+subhourly2hourly">subhourly2hourly</a></code>, <code><a href="#topic+subdaily2daily">subdaily2daily</a></code>, <code><a href="#topic+daily2monthly">daily2monthly</a></code>, <code><a href="#topic+daily2annual">daily2annual</a></code>, <code><a href="#topic+monthlyfunction">monthlyfunction</a></code>, <code><a href="#topic+izoo2rzoo">izoo2rzoo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################
## Ex1: Loading the DAILY precipitation data at SanMartino (25567 daily values)
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

## Transforming into NA the 10% of values in 'x'
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

# Getting the amount of NAs in 'x' for each week (starting on Monday)
cmv(x, tscale="weekly")

# Getting the amount of NAs in 'x' for each month
cmv(x, tscale="monthly")

# Getting the amount of NAs in 'x' for each quarter
cmv(x, tscale="quarterly")

# Getting the amount of NAs in 'x' for each weather season
cmv(x, tscale="seasonal")

# Getting the amount of NAs in 'x' for each year
cmv(x, tscale="annual")
######################
## Ex2: Loading the time series of HOURLY streamflows for the station 
## Karamea at Gorge (52579 hourly values)
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

## Transforming into NA the 30% of values in 'x'
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

# Getting the amount of NAs in 'x' for each day
cmv(x, tscale="daily")

# Getting the amount of NAs in 'x' for each weather season
cmv(x, tscale="seasonal")
</code></pre>

<hr>
<h2 id='daily2weekly'>
Daily -&gt; Weekly
</h2><span id='topic+daily2weekly'></span><span id='topic+daily2weekly.default'></span><span id='topic+daily2weekly.zoo'></span><span id='topic+daily2weekly.data.frame'></span><span id='topic+daily2weekly.matrix'></span>

<h3>Description</h3>

<p>Generic function for transforming a DAILY (or sub-daily) regular time series into a WEEKLY one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily2weekly(x, ...)

## Default S3 method:
daily2weekly(x, FUN, na.rm=TRUE, na.rm.max=0, ...)

## S3 method for class 'zoo'
daily2weekly(x, FUN, na.rm=TRUE, na.rm.max=0, ...)

## S3 method for class 'data.frame'
daily2weekly(x, FUN, na.rm=TRUE, na.rm.max=0, dates=1, 
        date.fmt = "%Y-%m-%d", out.type = "data.frame", out.fmt="numeric", 
        verbose=TRUE, ...)

## S3 method for class 'matrix'
daily2weekly(x, FUN, na.rm=TRUE, na.rm.max=0, dates=1, 
        date.fmt = "%Y-%m-%d", out.type = "data.frame", out.fmt="numeric", 
        verbose=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="daily2weekly_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with (sub)daily time series. <br />
Measurements at several gauging stations can be stored in a data.frame or matrix object, and in that case, each column of <code>x</code> represents the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="daily2weekly_+3A_fun">FUN</code></td>
<td>

<p>Function that have to be applied for transforming from daily to weekly time step (e.g., for precipitation <code>FUN=sum</code> and for temperature and streamflow ts <code>FUN=mean</code>). <br />
</p>
<p><code>FUN</code> MUST accept the <code>na.rm</code> argument, because <code>na.rm</code> is passed to <code>FUN</code>.
</p>
</td></tr>
<tr><td><code id="daily2weekly_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the weekly values are computed only for weeks with a percentage of missing values less than <code>na.rm.max</code> <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the corresponing weekly values in the output object will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="daily2weekly_+3A_na.rm.max">na.rm.max</code></td>
<td>

<p>Numeric in [0, 1]. It is used to define the maximum percentage of missing values allowed in each month to keep the weekly aggregated value in the output object of this function. In other words, if the percentage of missing values in a given month is larger or equal than <code>na.rm.max</code> the corresponding weekly value will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="daily2weekly_+3A_dates">dates</code></td>
<td>

<p>numeric, factor or Date object indicating how to obtain the dates for each gauging station <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <var>x</var> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into Date class, using the date format specified by <code>date.fmt</code>  <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days on it be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="daily2weekly_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="daily2weekly_+3A_out.type">out.type</code></td>
<td>

<p>Character that defines the desired type of output. Valid values are:  <br />
-) <kbd>data.frame</kbd>: a data.frame, with as many columns as stations are included in <code>x</code>, and row names indicating the month and year for each value. <br />
-) <kbd>db</kbd>        : a data.frame, with 4 columns will be produced. <br />
The first column (StationID) stores the ID of the station, <br />
The second column (Year) stores the year <br />
The third column (Month) stores the Month  <br />
The fourth column (Value) stores the numerical values corresponding to the values specified in the three previous columns. <br />
</p>
</td></tr>
<tr><td><code id="daily2weekly_+3A_out.fmt">out.fmt</code></td>
<td>

<p>OPTIONAL. Only used when <code>x</code> is a matrix or data.frame object /cr
character, for selecting if the result will be a matrix/data.frame or a zoo object. Valid values are: <kbd>numeric</kbd>, <kbd>zoo</kbd>.
</p>
</td></tr>
<tr><td><code id="daily2weekly_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="daily2weekly_+3A_...">...</code></td>
<td>

<p>arguments additional to <code>na.rm</code> passed to <code>FUN</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a zoo object with weekly time frequency
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cmv">cmv</a></code>, <code><a href="#topic+subhourly2hourly">subhourly2hourly</a></code>, <code><a href="#topic+daily2monthly">daily2monthly</a></code>, <code><a href="#topic+daily2annual">daily2annual</a></code>, <code><a href="#topic+subdaily2daily">subdaily2daily</a></code>, <code><a href="#topic+weeklyfunction">weeklyfunction</a></code>, <code><a href="#topic+hydroplot">hydroplot</a></code>, <code><a href="#topic+vector2zoo">vector2zoo</a></code>, <code><a href="#topic+izoo2rzoo">izoo2rzoo</a></code>, <code><a href="base.html#topic+as.Date">as.Date</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################
## Ex1: Computation of weekly values, removing any missing value in 'x'

# Loading the DAILY precipitation data at SanMartino
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Subsetting 'x' to its first three weeks (Jan/1921 - Mar/1921)
x &lt;- window(x, end="1921-03-31")

## Transforming into NA the 10% of values in 'x'
set.seed(10) # for reproducible results
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

## Agreggating from Daily to Weekly, removing any missing value in 'x'
w &lt;- daily2weekly(x, FUN=sum, na.rm=TRUE)

######################
## Ex2: Computation of Weekly values only when the percentage of NAs in each
#       week is lower than a user-defined percentage (10% in this example).

# Loading the DAILY precipitation data at SanMartino
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Subsetting 'x' to its first three weeks (Jan/1921 - Mar/1921)
x &lt;- window(x, end="1921-03-31")

## Transforming into NA the 10% of values in 'x'
set.seed(10) # for reproducible results
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

## Daily to Weekly, only for weeks with less than 10% of missing values
w2 &lt;- daily2weekly(x, FUN=sum, na.rm=TRUE, na.rm.max=0.1)

# Verifying that the weeks 01, 02, 06, 08, 10, 11, 12 of 'x' had 10% or more of missing values
cmv(x, tscale="weekly")

######################
## Ex3: Computation of Weekly values in a two-column zoo object, 
##      only when the percentage of NAs in each week is lower than a user-defined 
##      percentage (10% in this example).

# Loading the DAILY precipitation data at SanMartino
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Subsetting 'x' to its first three weeks (Jan/1921 - Mar/1921)
x &lt;- window(x, end="1921-03-31")

## Transforming into NA the 10% of values in 'x'
set.seed(10) # for reproducible results
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

## Creating a two-column zoo object
X &lt;- cbind(x, y=x)

## Daily to Weekly, only for weeks with less than 10% of missing values
w2 &lt;- daily2weekly(X, FUN=sum, na.rm=TRUE, na.rm.max=0.1)

# Verifying that the weeks 01, 02, 06, 08, 10, 11, 12 of 'x' had 10% or more of missing values
cmv(X, tscale="weekly")
</code></pre>

<hr>
<h2 id='dip'>
Days in Period
</h2><span id='topic+dip'></span>

<h3>Description</h3>

<p>Given any starting and ending dates, it generates:  <br />
1) a vector of class Date with all the days between <code>from</code> and <code>to</code> (both of them included), OR <br />
2) the amount of days between the two dates 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dip(from, to, date.fmt = "%Y-%m-%d", out.type = "seq")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dip_+3A_from">from</code></td>
<td>

<p>Character indicating the starting date for creating the sequence. It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="dip_+3A_to">to</code></td>
<td>

<p>Character indicating the ending date for creating the sequence. It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="dip_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>from</code> and <code>to</code>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="dip_+3A_out.type">out.type</code></td>
<td>

<p>Character indicating the type of result that is given by this function. Valid values are: <br />
1) <kbd>seq</kbd> : a vector of class Date with all the days between the two dates, OR <br />
2) <kbd>nmbr</kbd>: a single numeric value with the amount of days between the two dates.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the value of <code>out.type</code>, it returns: <br />
1) a vector of class Date with all the days between <code>from</code> and <code>to</code> (both of them included), OR <br />
2) the amount of days between the two dates 
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mip">mip</a></code>, <code><a href="#topic+yip">yip</a></code>, <code><a href="#topic+hip">hip</a></code>, <code><a href="#topic+diy">diy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sequence of daily dates between "1961-01-01" and "1961-12-31" ##
dip("1961-01-01", "1961-12-31")

## Number of days between "1961-01-01" and "1965-06-30", 
## but using "%d-%m-%Y" as date format.
dip("01-01-1961", "30-06-1965", date.fmt= "%d-%m-%Y", out.type = "nmbr")

</code></pre>

<hr>
<h2 id='diy'>
Days in Year
</h2><span id='topic+diy'></span>

<h3>Description</h3>

<p>Given a single numeric value representing a year, it generates: <br />           
1) a vector of dates with all the days within the year, OR <br />
2) the amount of days in the specified year  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diy(year, out.type = "seq")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diy_+3A_year">year</code></td>
<td>

<p>numeric, the year for which the sequence of days will be generated
</p>
</td></tr>
<tr><td><code id="diy_+3A_out.type">out.type</code></td>
<td>

<p>Character indicating the type of result that is given by this function. Valid values are: <br />
-) <kbd>seq</kbd> : a vectorial sequence with all the days within the given year <br />
-) <kbd>nmbr</kbd>: the number of days in the vectorial sequence with all the days within the given year
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hip">hip</a></code>, <code><a href="#topic+dip">dip</a></code>, <code><a href="#topic+mip">mip</a></code>, <code><a href="#topic+yip">yip</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sequence of daily dates for the year 1961
diy(1961)

## Computing the number of days between in 1961
diy(1961, out.type = "nmbr")

</code></pre>

<hr>
<h2 id='dm2seasonal'>
(sub)Daily/Monthly -&gt; Seasonal Values
</h2><span id='topic+dm2seasonal'></span><span id='topic+dm2seasonal.default'></span><span id='topic+dm2seasonal.zoo'></span><span id='topic+dm2seasonal.data.frame'></span><span id='topic+dm2seasonal.matrix'></span><span id='topic+subdaily2seasonal'></span><span id='topic+subdaily2seasonal.default'></span><span id='topic+subdaily2seasonal.zoo'></span><span id='topic+subdaily2seasonal.data.frame'></span><span id='topic+subdaily2seasonal.matrix'></span>

<h3>Description</h3>

<p>Generic function for computing a seasonal value for every year of a sub-daily/daily/weekly/monthly time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dm2seasonal(x, ...)
subdaily2seasonal(x, ...)

## Default S3 method:
dm2seasonal(x, season, FUN, na.rm = TRUE, out.fmt="%Y", ...)

## S3 method for class 'zoo'
dm2seasonal(x, season, FUN, na.rm = TRUE, out.fmt="%Y", ...)

## S3 method for class 'data.frame'
dm2seasonal(x, season, FUN, na.rm = TRUE, dates=1, date.fmt = "%Y-%m-%d", 
            out.type = "data.frame", out.fmt="%Y", ...)
        
## S3 method for class 'matrix'
dm2seasonal(x, season, FUN, na.rm = TRUE, dates=1, date.fmt = "%Y-%m-%d", 
            out.type = "data.frame", out.fmt="%Y", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dm2seasonal_+3A_x">x</code></td>
<td>

<p>zoo, xts, data.frame or matrix object, with sub-daily, daily, weekly or monthly time series. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="dm2seasonal_+3A_season">season</code></td>
<td>

<p>character, indicating the weather season to be used for selecting the data. Valid values are: <br />
-) <kbd>DJF</kbd> : December, January, February   <br />
-) <kbd>MAM</kbd> : March, April, May             <br />
-) <kbd>JJA</kbd> : June, July, August            <br />
-) <kbd>SON</kbd> : September, October, November  <br />
-) <kbd>DJFM</kbd>: December, January, February, March  <br />                   
-) <kbd>AM</kbd>  : April, May                    <br />   
-) <kbd>JJAS</kbd>: June, July, August, September <br />            
-) <kbd>ON</kbd>  : October, November
</p>
</td></tr>
<tr><td><code id="dm2seasonal_+3A_fun">FUN</code></td>
<td>

<p>Function that will be applied to ALL the values of <code>x</code> belonging to the given weather season (e.g., <code>FUN</code> can be some of <code>mean</code>, <code>max</code>, <code>min</code>, <code>sd</code>). <br />
<b>The FUN value for the winter season (DJF or DJFM) is computed considering the consecutive months of December, January and February/March</b>. See 'Note' section.
</p>
</td></tr>
<tr><td><code id="dm2seasonal_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the seasonal values  are computed considering only those values different from NA (<b>very important when <code>FUN=sum</code></b>) <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a weather season, the corresponding seasonal values are NA
</p>
</td></tr>
<tr><td><code id="dm2seasonal_+3A_out.fmt">out.fmt</code></td>
<td>

<p>Character indicating the date format for the output time series. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. Possible values are: <br />
-) <kbd>%Y</kbd>        : only the year will be used for the time. Default option. (e.g., &quot;1961&quot; &quot;1962&quot;...) <br />
-) <kbd>%Y-%m-%d</kbd>: a complete date format will be used for the time. (e.g., &quot;1961-01-01&quot; &quot;1962-01-01&quot;...)
</p>
</td></tr>
<tr><td><code id="dm2seasonal_+3A_dates">dates</code></td>
<td>

<p>numeric, factor or Date object indicating how to obtain the dates. <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into Date class, by using the date format specified by <code>date.fmt</code> <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days on it be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="dm2seasonal_+3A_date.fmt">date.fmt</code></td>
<td>

<p>Character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="dm2seasonal_+3A_out.type">out.type</code></td>
<td>

<p>Character that defines the desired type of output. Valid values are: <br />
-) <kbd>data.frame</kbd>: a data.frame, with as many columns as stations are included in <code>x</code>, the year corresponding to each seasonal value are used as row names. <br />
-) <kbd>db</kbd>        : a data.frame, with 4 columns will be produced. <br />
The first column (StationID) stores the ID of the station 
The second column (Year) stores the year,  <br />
The third column (Season) stores the season,<br />
The fourth column (Value) contains the seasonal value corresponding to the values specified in the previous three columns
</p>
</td></tr>
<tr><td><code id="dm2seasonal_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with the seasonal values for all the years in which <code>x</code> is defined.
</p>


<h3>Warning</h3>

<p>For any year, the <code>FUN</code> value for the winter season (DJF), is computed considering only January and February, and the value of December is used for computing the winter value of the next year.
</p>


<h3>Note</h3>

<p><code>FUN</code> is applied to all the values of <code>x</code> belonging to the selected season, so the results of this function depends on the frequency sampling of <code>x</code> and the type of function given by <code>FUN</code> <br />
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p>, <code><a href="#topic+hydroplot">hydroplot</a></code>, <code><a href="#topic+seasonalfunction">seasonalfunction</a></code>, <code><a href="#topic+time2season">time2season</a></code>, <code><a href="#topic+extract">extract</a></code>, <code><a href="#topic+daily2monthly">daily2monthly</a></code>, <code><a href="#topic+daily2annual">daily2annual</a></code>, <code><a href="#topic+monthly2annual">monthly2annual</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Loading the DAILY precipitation data at SanMartino
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

## Winter (DJF) values of precipitation for each year of 'x'
dm2seasonal(x, FUN=sum, season="DJF")

############
## Loading the HOURLY discharge data for the Karamea at Gorge streamgauge station
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

## Mean winter (DJF) values of streamflow for each year of 'x'
dm2seasonal(x, FUN=mean, season="DJF")
subdaily2seasonal(x, FUN=mean, season="DJF") # same as above




</code></pre>

<hr>
<h2 id='drawTimeAxis'>
Customized Time Axis
</h2><span id='topic+drawTimeAxis'></span><span id='topic+drawxaxis'></span>

<h3>Description</h3>

<p>For a nice time series plot, this function draws a customized time axis, with annual, monthly, daily and sub-daily time marks and labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawxaxis(x, tick.tstep = "auto", lab.tstep = "auto", 
          lab.fmt=NULL, cex.axis=1, mgp=c(3, 2, 0), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawTimeAxis_+3A_x">x</code></td>
<td>

<p>time series that will be plotted using the X axis that will be draw class(x) must be ts or zoo
</p>
</td></tr>
<tr><td><code id="drawTimeAxis_+3A_tick.tstep">tick.tstep</code></td>
<td>

<p>Character indicating the time step that have to be used for putting the ticks on the time axis. Valid values are: <kbd>auto</kbd>, <kbd>years</kbd>, <kbd>quarters</kbd>, <kbd>months</kbd>,<kbd>weeks</kbd>, <kbd>days</kbd>, <kbd>hours</kbd>, <kbd>minutes</kbd>, <kbd>seconds</kbd>.
</p>
</td></tr>
<tr><td><code id="drawTimeAxis_+3A_lab.tstep">lab.tstep</code></td>
<td>

<p>Character indicating the time step that have to be used for putting the labels on the time axis. Valid values are: <kbd>auto</kbd>, <kbd>years</kbd>, <kbd>quarters</kbd>, <kbd>months</kbd>,<kbd>weeks</kbd>, <kbd>days</kbd>, <kbd>hours</kbd>, <kbd>minutes</kbd>, <kbd>seconds</kbd>.
</p>
</td></tr>
<tr><td><code id="drawTimeAxis_+3A_lab.fmt">lab.fmt</code></td>
<td>

<p>Character indicating the format to be used for the label of the axis. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. If not specified (<code>lab.fmt=NULL</code>), it will try to use: <br />
-) <kbd>"%Y-%m-%d"</kbd> when <code>lab.tstep=="days"</code>, <br />
-) <kbd>"%b-%Y"</kbd> when <code>lab.tstep=="year"</code> or <code>lab.tstep=="month"</code>. 
</p>
</td></tr>
<tr><td><code id="drawTimeAxis_+3A_cex.axis">cex.axis</code></td>
<td>

<p>magnification of axis annotation relative to <code>cex</code> (See <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
<tr><td><code id="drawTimeAxis_+3A_mgp">mgp</code></td>
<td>

<p>The margin line (in <code>mex</code> units) for the axis title, axis labels and axis line (See <code><a href="graphics.html#topic+par">par</a></code>). Default value is <code>mgp = c(3, 2, 0)</code>.
</p>
</td></tr>
<tr><td><code id="drawTimeAxis_+3A_...">...</code></td>
<td>

<p>further arguments passed to the <code>axis</code> function or from other methods.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>From version 0.3-0 it changed its name from <code>drawxaxis</code> to <code>drawTimeAxis</code>, in order to have a more intuitive name. The old <code>drawxaxis</code> function is deprecated, but still be kept for compatibility reasons. 
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the SanMartino precipitation data
data(SanMartinoPPts)
x &lt;- window(SanMartinoPPts, end=as.Date("1930-12-31"))

## Plotting the daily ts only, and then automatic 'x' axis
plot(x, xaxt = "n", xlab="Time")
drawTimeAxis(x) 

## Plotting the daily ts only, and then monthly ticks in the 'x' axis, 
## with annual labels.
plot(x, xaxt = "n", xlab="Time")
drawTimeAxis(x, tick.tstep="months", lab.tstep="years") 
</code></pre>

<hr>
<h2 id='dwdays'>
Amount of dry/wet days in a time series
</h2><span id='topic+dwdays.data.frame'></span><span id='topic+dwdays.matrix'></span><span id='topic+dwdays.default'></span><span id='topic+dwdays'></span>

<h3>Description</h3>

<p>Given a daily time series (usually precipitation), this function computes the average amount of wet/dry days in each month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwdays(x, ...)

## Default S3 method:
dwdays(x, thr=0, type="wet", na.rm=TRUE, ... )

## S3 method for class 'data.frame'
dwdays(x, thr=0, type="wet", na.rm=TRUE, 
        dates=1, date.fmt="%Y-%m-%d", verbose=TRUE,...)

## S3 method for class 'matrix'
dwdays(x, thr=0, type="wet", na.rm=TRUE, 
        dates=1, date.fmt="%Y-%m-%d", verbose=TRUE,...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dwdays_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, usually with daily time series of precipitation. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="dwdays_+3A_thr">thr</code></td>
<td>

<p>numeric. Value of daily precipitation used as threshold for classifying a day as dry/wet or not. Days with a precipitation value larger to <code>thr</code> are classified as <var>wet days</var>, whereas precipitation values lower to <code>thr</code> are classified as <var>dry days</var>. 
</p>
</td></tr>
<tr><td><code id="dwdays_+3A_type">type</code></td>
<td>

<p>character, indicating if the daily values have to be classified as dry or wet days. It works linked to the values specified in <code>thr</code>. Valid values are: <kbd>wet</kbd>, <kbd>dry</kbd>.
</p>
</td></tr>
<tr><td><code id="dwdays_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed before counting?
</p>
</td></tr>
<tr><td><code id="dwdays_+3A_dates">dates</code></td>
<td>

<p>numeric, factor or Date object indicating how to obtain the dates <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into Date class, using the date format  specified by <code>date.fmt</code>  <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of element in <code>x</code>
</p>
</td></tr>
<tr><td><code id="dwdays_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="dwdays_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="dwdays_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the SanMartino precipitation data
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

## Average amount of wet days in each month (for this example, this means days 
## with precipitation larger than 0.1mm) 
dwdays(x, thr=0.1)
</code></pre>

<hr>
<h2 id='dwi'>
Days with Information
</h2><span id='topic+dwi'></span><span id='topic+dwi.default'></span><span id='topic+dwi.zoo'></span><span id='topic+dwi.data.frame'></span><span id='topic+dwi.matrix'></span>

<h3>Description</h3>

<p>This function generates a table indicating the number of days with information (&lt;&gt;NA) within a zoo object, aggregated by year, month or month per year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwi(x, ...)

## Default S3 method:
dwi(x, out.unit = "years", from = start(x), to = end(x), 
     date.fmt = "%Y-%m-%d", tstep="days", ...)
     
## S3 method for class 'zoo'
dwi(x, out.unit = "years", from = start(x), to = end(x), 
     date.fmt = "%Y-%m-%d", tstep="days", ...)

## S3 method for class 'data.frame'
dwi(x, out.unit = "years", from, to, date.fmt = "%Y-%m-%d", tstep="days", 
     dates = 1, verbose = TRUE, ...)
     
## S3 method for class 'matrix'
dwi(x, out.unit = "years", from, to, date.fmt = "%Y-%m-%d", tstep="days", 
     dates = 1, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dwi_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with daily/monthly/annual time series. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="dwi_+3A_out.unit">out.unit</code></td>
<td>

<p>aggregation time for the computation of the amount of days with information. Valid values are: <br />
-) <kbd>months</kbd>: monthly;  <br />
-) <kbd>years</kbd> : annual;   <br />
-) <kbd>mpy</kbd>   : month per year (not available for data.frames)
</p>
</td></tr>
<tr><td><code id="dwi_+3A_from">from</code></td>
<td>

<p>Character indicating the starting date for the computations. It has to be in the format indicated by <code>date.fmt</code>.<br />
When <code>x</code> is a data.frame and this value is not provided, the date corresponding to the first row of <code>x</code> is used
</p>
</td></tr>
<tr><td><code id="dwi_+3A_to">to</code></td>
<td>

<p>Character indicating the ending date for the computations. It has to be in the format indicated by <code>date.fmt</code>. <br />
When <code>x</code> is a data.frame and this value is not provided, the date corresponding to the last row of <code>x</code> is used
</p>
</td></tr>
<tr><td><code id="dwi_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>. 
</p>
</td></tr>
<tr><td><code id="dwi_+3A_tstep">tstep</code></td>
<td>

<p>Time step used for storing the values in <code>x</code>. Valid values are: <kbd>days</kbd>, <kbd>months</kbd>, <kbd>years</kbd>.
Since the version 0.3-0 of hydroTSM, this argument is not required any more, because it is not used any longer.
</p>
</td></tr>
<tr><td><code id="dwi_+3A_dates">dates</code></td>
<td>

<p>numeric, factor or Date object indicating how to obtain the dates for each column of <code>x</code><br />
If <code>dates</code> is a number, it indicates the index of the column in <code>x</code> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into Date class, using the date format  specified by <code>date.fmt</code> <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of element in <code>x</code>
</p>
</td></tr>
<tr><td><code id="dwi_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="dwi_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+matrixplot">matrixplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the SanMartino precipitation data
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

## Not run: 
## Days with information per year
dwi(x)

## Days with information per month per year.
dwi(x, out.unit="mpy")

## End(Not run)

###########
## Not run: 
## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)

## Months with information per year in the 9 first stations of 'EbroPPtsMonthly'
a &lt;- dwi(EbroPPtsMonthly[,1:10], out.unit="years", dates=1)

## Before plotting the results in 'a', and just for obtaining a more interesting
## plot, 70 random numbers (between 1 and 11) are introduced in 'a'
a[sample(length(a), size = 70)] &lt;- rep(1:11, length=70)

## Plotting the amount of months with information per year in each station
matrixplot(a, var.type="Days", main="Number of months with info per year")

## End(Not run)
</code></pre>

<hr>
<h2 id='EbroPPtsMonthly'>
Ebro Monthly Precipitation Time Series
</h2><span id='topic+EbroPPtsMonthly'></span>

<h3>Description</h3>

<p>Time series of monthly precipitation on 331 stations of the Ebro River basin (NW Spain), for the period January/1961 to December/1963.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(EbroPPtsMonthly)
</code></pre>


<h3>Format</h3>

<p>A data.frame with 331 monthly time series, plus the first field storing the dates corresponding to each row.
</p>


<h3>Details</h3>

<p>Monthly time series of precipitation on 331 stations of the Ebro River basin (Spain), where some data were in-filled by using the MOSS method and from daily time series used in the technical report &quot;Estudio de Recursos de la Cuenca del Ebro&quot;.
</p>


<h3>Source</h3>

<p>Downloaded from the web site of the Confederacion Hidrografica del Ebro (CHE) <a href="http://www.chebro.es/">http://www.chebro.es/</a> (original link http://oph.chebro.es/DOCUMENTACION/PrecipitacionMensualRelleno/PrecipitacionMensualRelleno.html, last accessed [March 2010]). <br />
These data are intended to be used for research purposes only, being distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY.
</p>

<hr>
<h2 id='extract'>
Extract from Zoo
</h2><span id='topic+extract'></span><span id='topic+extract.default'></span><span id='topic+extract.zoo'></span><span id='topic+extractzoo'></span>

<h3>Description</h3>

<p>Extracts from a zoo object all the values belonging to a given month, year or weather season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract(x, ...)

## Default S3 method:
extract(x, trgt, ...)
     
## S3 method for class 'zoo'
extract(x, trgt, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_+3A_x">x</code></td>
<td>

<p>zoo object
</p>
</td></tr>
<tr><td><code id="extract_+3A_trgt">trgt</code></td>
<td>

<p>numeric or character indicating the elements to extract from <code>x</code>. Valid values are: <br />
1) integer(s) from 1 to 12: <code>trgt</code> is considered as month(s) (1=JAN, 2=FEB,...., 12=DEC), and all the values in <code>x</code> belonging to the month(s) specified by <code>trgt</code> will be extracted. <br />
2) integer(s) &gt; 12: <code>trgt</code> is considered as year(s), and all the values in <code>x</code> belonging to the year(s) specified by <code>trgt</code> will be extracted <br />
3) character: <code>trgt</code> is considered as a weather season, and all the values in <code>x</code> belonging to the season specified by <code>trgt</code> will be extracted. Valid values are: <br />
-) <kbd>DJF</kbd> : December, January, February   <br />                   
-) <kbd>MAM</kbd> : March, April, May             <br />                     
-) <kbd>JJA</kbd> : June, July, August            <br />                      
-) <kbd>SON</kbd> : September, October, November  <br />
-) <kbd>DJFM</kbd>: December, January, February, March  <br />                   
-) <kbd>AM</kbd>  : April, May                    <br />  
-) <kbd>JJAS</kbd>: June, July, August, September <br />            
-) <kbd>ON</kbd>  : October, November
</p>
</td></tr>
<tr><td><code id="extract_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a zoo object with the extracted values.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+time2season">time2season</a></code>, <code><a href="#topic+seasonalfunction">seasonalfunction</a></code>, <code><a href="#topic+daily2annual">daily2annual</a></code>, <code><a href="#topic+daily2monthly">daily2monthly</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Loading temperature data ##
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

## Extracting all the values belonging to February (FEB=2)
extract(x, trgt=2)

## Extracting all the values belonging to February (FEB=2) and April (APR=4)
extract(x, trgt=c(2,4))

## Extracting all the values belonging to the year 1970
extract(x, trgt=1970)

## Extracting all the values belonging to the years 1970 and 1972
extract(x, trgt=c(1970,1972))

## Extracting all the values belonging to the autumn
extract(x, trgt="SON")
</code></pre>

<hr>
<h2 id='fdc'>
Flow Duration Curve
</h2><span id='topic+fdc.default'></span><span id='topic+fdc.matrix'></span><span id='topic+fdc.data.frame'></span><span id='topic+fdc.zoo'></span><span id='topic+fdc'></span>

<h3>Description</h3>

<p>Computes and plots the Flow Duration Curve (<abbr><span class="acronym">FDC</span></abbr>) corresponding to a given time series of streamflow discharges. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdc(x, ...)

## Default S3 method:
fdc(x,lQ.thr=0.7,hQ.thr=0.2, plot=TRUE, log="y", 
    main="Flow Duration Curve", xlab="% Time flow equalled or exceeded", 
    ylab="Q, [m3/s]", ylim, yat=c(0.01, 0.1, 1), xat=c(0.01, 0.025, 0.05), col="black", 
    pch=1, lwd=1, lty=1, cex=0.4, cex.axis=1.2, cex.lab=1.2, leg.txt=NULL, leg.cex=1, 
    leg.pos="topright", verbose= TRUE, thr.shw=TRUE, new=TRUE, ...)

## S3 method for class 'matrix'
fdc(x, lQ.thr=0.7, hQ.thr=0.2, plot=TRUE, log="y", 
    main= "Flow Duration Curve",  xlab="% Time flow equalled or exceeded", 
    ylab="Q, [m3/s]", ylim, yat=c(0.01, 0.1, 1), xat=c(0.01, 0.025, 0.05), 
    col=palette("default")[1:ncol(x)], pch=1:ncol(x), lwd=rep(1, ncol(x)), 
    lty=1:ncol(x), cex=0.4, cex.axis=1.2, cex.lab=1.2, leg.txt=NULL, 
    leg.cex=1, leg.pos="topright",verbose=TRUE, thr.shw=TRUE, new=TRUE, ...)

## S3 method for class 'data.frame'
fdc(x, lQ.thr=0.7, hQ.thr=0.2, plot=TRUE, log="y", 
     main= "Flow Duration Curve", xlab="% Time flow equalled or exceeded", 
     ylab="Q, [m3/s]", ylim, yat=c(0.01, 0.1, 1), xat=c(0.01, 0.025, 0.05), 
     col=palette("default")[1:ncol(x)], pch=1:ncol(x), lwd=rep(1, ncol(x)), 
     lty=1:ncol(x), cex=0.4, cex.axis=1.2, cex.lab=1.2, leg.txt=NULL, 
     leg.cex=1, leg.pos="topright", verbose=TRUE, thr.shw=TRUE, new=TRUE, ...)
     
## S3 method for class 'zoo'
fdc(x, lQ.thr=0.7, hQ.thr=0.2, plot=TRUE, log="y", 
     main= "Flow Duration Curve", xlab="% Time flow equalled or exceeded", 
     ylab="Q, [m3/s]", ylim, yat=c(0.01, 0.1, 1), xat=c(0.01, 0.025, 0.05), 
     col=palette("default")[1:NCOL(x)], pch=1:NCOL(x), lwd=rep(1, NCOL(x)), 
     lty=1:NCOL(x), cex=0.4, cex.axis=1.2, cex.lab=1.2, leg.txt=NULL, 
     leg.cex=1, leg.pos="topright", verbose=TRUE, thr.shw=TRUE, new=TRUE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdc_+3A_x">x</code></td>
<td>

<p>numeric, zoo, data.frame or matrix object with the observed streamflows for which the flow duration curve have to be computed. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter). When <code>x</code> is a matrix or data.frame, the flow duration curve is computed for each column.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_lq.thr">lQ.thr</code></td>
<td>

<p>numeric, low-flow separation threshold. If this value is different from NA, a vertical line is drawn in this value, and all the values to the right of it should be deemed as low flows. Default value is 0.7.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_hq.thr">hQ.thr</code></td>
<td>

<p>numeric, high-flow separation threshold. If this value is different from NA, a vertical line is drawn in this value, and all the values to the left of it should br deemed as high flows. Default value is 0.2.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_plot">plot</code></td>
<td>

<p>logical. Indicates if the flow duration curve should be plotted or not. Default value is TRUE.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_log">log</code></td>
<td>

<p>character, indicates which axis has to be plotted with a logarithmic scale. Default value is <kbd>y</kbd> 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_main">main</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot">plot</a></code>. An overall title for the plot: see <code><a href="graphics.html#topic+title">title</a></code>.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_xlab">xlab</code></td>
<td>

<p>A title for the x axis. See <code><a href="graphics.html#topic+plot">plot</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_ylab">ylab</code></td>
<td>

<p>A title for the y axis. See <code><a href="graphics.html#topic+plot">plot</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_ylim">ylim</code></td>
<td>

<p>The y limits of the plot. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_yat">yat</code></td>
<td>

<p>Only used when <code>log="y"</code>. <br />
numeric, with points at which tick-marks will try to be drawn in the Y axis, in addition to the defaults computed by R. See the <code>at</code> argument in <code><a href="graphics.html#topic+Axis">Axis</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_xat">xat</code></td>
<td>

<p>Only used when <code>log="x"</code>. <br />
numeric, with points at which tick-marks will try to be drawn in the x axis, in addition to the defaults computed by R. See the <code>at</code> argument in <code><a href="graphics.html#topic+Axis">Axis</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_col">col</code></td>
<td>

<p>The colors to be used for lines and points. Multiple colors can be specified so that each point can be given its own color. If there are fewer colors than points they are recycled in the standard fashion. Lines will all be plotted in the first colour specified. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_pch">pch</code></td>
<td>

<p>A vector of plotting characters or symbols: see <code><a href="graphics.html#topic+points">points</a></code>. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_lwd">lwd</code></td>
<td>

<p>The line width, see <code><a href="graphics.html#topic+par">par</a></code>. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_lty">lty</code></td>
<td>

<p>The line type, see <code><a href="graphics.html#topic+par">par</a></code>. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_cex">cex</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. A numerical vector giving the amount by which plotting characters and symbols should be scaled relative to the default.  <br />
This works as a multiple of <span class="env">par("cex")</span>. 'NULL' and 'NA' are equivalent to '1.0'.  Note that this does not affect annotation
</p>
</td></tr>
<tr><td><code id="fdc_+3A_cex.axis">cex.axis</code></td>
<td>

<p>magnification of axis annotation relative to 'cex'.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_cex.lab">cex.lab</code></td>
<td>

<p>Magnification to be used for x and y labels relative to the current setting of 'cex'. See '?par'.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_leg.txt">leg.txt</code></td>
<td>

<p>vector with the names that have to be used for each column of <code>x</code>.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_leg.cex">leg.cex</code></td>
<td>

<p>numeric, indicating the character expansion factor for the legend, *relative* to current <code>par("cex")</code>. Default value = 1
</p>
</td></tr>
<tr><td><code id="fdc_+3A_leg.pos">leg.pos</code></td>
<td>

<p>keyword to be used to position the legend. One of the list &lsquo;&quot;bottomright&quot;, &quot;bottom&quot;, &quot;bottomleft&quot;, &quot;left&quot;, &quot;topleft&quot;, &quot;top&quot;, &quot;topright&quot;, &quot;right&quot;, &quot;center&quot;&rsquo;. This places the legend on the inside of the plot frame at the given location. See <code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed (when <code>x</code> is a matrix or data.frame). 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_thr.shw">thr.shw</code></td>
<td>

<p>logical, indicating if the streamflow values corresponding to the user-defined thresholds <code>lQ.thr</code> and <code>hQ.thr</code> have to be shown in the plot.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_new">new</code></td>
<td>

<p>logical, if TRUE (default), a new plotting window is created. 
</p>
</td></tr>
<tr><td><code id="fdc_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods (to the plotting functions)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric, matrix or data.frame whose columns contains the % of time each one of the streamflow magnitudes given as input was equalled or exceeded. The resulting values have to be multiplied by 100 to get a percentage. <br />
</p>
<p>When <code>plot</code> is TRUE (default), the resulting flow duration curve is plotted in a new window.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>References</h3>

<p><cite>Vogel, R., and N. M. Fennessey (1994), Flow duration curves I: A new interpretation and confidence intervals, ASCE, Journal of Water Resources Planning and Management, 120(4)</cite>. <br />
</p>
<p><cite>Vogel, R., and N. Fennessey (1995), Flow duration curves II: A review of applications in water resources planning, Water Resources Bulletin, 31(6), 1029-1039, doi:10.1111/j.1752-1688.1995.tb03419.x</cite>. <br />
</p>
<p><cite>Yilmaz, K. K., H. V. Gupta, and T. Wagener  (2008), A process-based diagnostic approach to model evaluation: Application to the NWS distributed hydrologic model, Water Resour. Res., 44, W09417, doi:10.1029/2007WR006716</cite>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdcu">fdcu</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading daily streamflows at the station Oca en Ona (Ebro River basin, Spain) ##
data(OcaEnOnaQts)

## Daily Flow Duration Curve
fdc(OcaEnOnaQts)

###################
# Getting the streamflow values corresponding to 5 and 95% of time equalled or 
# exceeded (and also the first streamflow value in 'x' just for verification)
x  &lt;- OcaEnOnaQts

# First streamflow value (x1=42.1 m3/s)
x1 &lt;- x[1]

# Daily FDC for 'x'
y &lt;- fdc(x)

# value of the FDC for x1 (y1=0.002739726)
y1 &lt;- y[1]

# Performing cubic (or Hermite) spline interpolation of 'x' and 'y'
f &lt;- splinefun(y,x)

# Getting the (known) streamflow value for 'y1'
f(y1) # 42.1 m3/s, equal to the known 'x1'

# Streamflow values corresponding to 5 and 95% of time equalled or exceeded
f(c(.05, .95))

###################
## Getting 
data(OcaEnOnaQts)

## Daily Flow Duration Curve
fdc(OcaEnOnaQts)
</code></pre>

<hr>
<h2 id='fdcu'>
Flow Duration Curve with uncertainty bounds.
</h2><span id='topic+fdcu.data.frame'></span><span id='topic+fdcu.default'></span><span id='topic+fdcu.matrix'></span><span id='topic+fdcu.zoo'></span><span id='topic+fdcu'></span>

<h3>Description</h3>

<p>Computes and plots the Flow Duration Curve (<abbr><span class="acronym">FDC</span></abbr>) for the streamflows given by <code>x</code> and for two uncertainty bounds, with the possibility of plotting an additional FDC representing simulated streamflows for <code>x</code>, in order to compare them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdcu(x, lband, uband, ...)

## Default S3 method:
fdcu(x, lband, uband, sim=NULL, lQ.thr=0.7, hQ.thr=0.2, plot=TRUE, log="y", 
     main="Flow Duration Curve", xlab="% Time flow equalled or exceeded", 
     ylab="Q, [m3/s]", ylim, yat=c(0.01, 0.1, 1), xat=c(0.01, 0.025, 0.05), 
     col=c("black", "red"), pch=c(1, 15), lwd=c(1, 0.8), lty=c(1, 3), cex=0.2, 
     cex.axis=1.2, cex.lab=1.2, leg.txt= c("Qobs", "Qsim", "95PPU"), 
     leg.cex=1, leg.pos="auto", verbose= TRUE, thr.shw=TRUE, border=NA, 
     bands.col="lightcyan", bands.density=NULL, bands.angle=45, new=TRUE, ...)

## S3 method for class 'matrix'
fdcu(x, lband, uband, sim=NULL, lQ.thr=0.7, hQ.thr=0.2, plot=TRUE, log="y", 
     main="Flow Duration Curve", xlab="% Time flow equalled or exceeded", 
     ylab="Q, [m3/s]", ylim, yat=c(0.01, 0.1, 1), xat=c(0.01, 0.025, 0.05), 
     col=matrix(c(rep("black", ncol(x)), 
     palette("default")[2:(ncol(x)+1)]), byrow=FALSE, ncol=2), 
     pch=matrix(rep(c(1, 15), ncol(x)), byrow=TRUE, ncol=2),
     lwd=matrix(rep(c(1, 0.8), ncol(x)), byrow=TRUE, ncol=2),
     lty=matrix(rep(c(1, 3), ncol(x)), byrow=TRUE, ncol=2),                        
     cex=rep(0.1, ncol(x)), cex.axis=1.2, cex.lab=1.2, 
     leg.txt=c("OBS", colnames(x), "95PPU"),  leg.cex=1, leg.pos="auto", 
     verbose= TRUE,  thr.shw=TRUE, border=rep(NA, ncol(x)), 
     bands.col=rep("lightcyan", ncol(x)), bands.density=rep(NULL, ncol(x)), 
     bands.angle=rep(45, ncol(x)), new=TRUE, ...)

## S3 method for class 'data.frame'
fdcu(x, lband, uband, sim=NULL, lQ.thr=0.7, hQ.thr=0.2, plot=TRUE, log="y", 
     main="Flow Duration Curve", xlab="% Time flow equalled or exceeded", 
     ylab="Q, [m3/s]", ylim, yat=c(0.01, 0.1, 1), xat=c(0.01, 0.025, 0.05), 
     col=matrix(c(rep("black", ncol(x)), 
     palette("default")[2:(ncol(x)+1)]), byrow=FALSE, ncol=2),
     pch=matrix(rep(c(1, 15), ncol(x)), byrow=TRUE, ncol=2),
     lwd=matrix(rep(c(1, 0.8), ncol(x)), byrow=TRUE, ncol=2),
     lty=matrix(rep(c(1, 3), ncol(x)), byrow=TRUE, ncol=2),                        
     cex=rep(0.1, ncol(x)), cex.axis=1.2, cex.lab=1.2,
     leg.txt=c("OBS", colnames(x), "95PPU"), leg.cex=1, leg.pos="auto", 
     verbose= TRUE, thr.shw=TRUE, border=rep(NA, ncol(x)), 
     bands.col=rep("lightcyan", ncol(x)), bands.density=rep(NULL, ncol(x)), 
     bands.angle=rep(45, ncol(x)), new=TRUE, ...)


</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdcu_+3A_x">x</code></td>
<td>

<p>numeric, zoo, data.frame or matrix object with the observed streamflows for which the flow duration curve have to be computed. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter). When <code>x</code> is a matrix or data.frame, the flow duration curve is computed for each column.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_lband">lband</code></td>
<td>

<p>numeric, zoo, data.frame or matrix object with the streamflows representing the the lower uncertainty bound of <code>x</code>, for which the flow duration curve have to be computed. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object. When <code>lband</code> is a matrix or data.frame, the flow duration curve is computed for each column.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_uband">uband</code></td>
<td>

<p>numeric, zoo, data.frame or matrix object with the streamflows representing the the upper uncertainty bound of <code>x</code>, for which the flow duration curve have to be computed. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object. When <code>uband</code> is a matrix or data.frame, the flow duration curve is computed for each column.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_sim">sim</code></td>
<td>

<p>OPTIONAL. <br />
numeric, zoo, data.frame or matrix object with the streamflows simulated for <code>x</code>, for which the flow duration curve have to be computed. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object. When <code>sim</code> is a matrix or data.frame, the flow duration curve is computed for each column.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_lq.thr">lQ.thr</code></td>
<td>

<p>numeric, low flows separation threshold. If this value is different from 'NA', a vertical line is drawn in this value, and all the values to the left of it are deemed low flows.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_hq.thr">hQ.thr</code></td>
<td>

<p>numeric, high flows separation threshold. If this value is different from 'NA', a vertical line is drawn in this value, and all the values to the right of it are deemed high flows
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_plot">plot</code></td>
<td>

<p>logical. Indicates if the flow duration curve should be plotted or not.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_log">log</code></td>
<td>

<p>character, indicates which axis has to be plotted with a logarithmic scale. Default value is <kbd>y</kbd>. 
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_main">main</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot">plot</a></code>. An overall title for the plot: see <code><a href="graphics.html#topic+title">title</a></code>.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_xlab">xlab</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot">plot</a></code>. A title for the x axis: see <code><a href="graphics.html#topic+title">title</a></code>.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_ylab">ylab</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot">plot</a></code>. A title for the y axis: see <code><a href="graphics.html#topic+title">title</a></code>.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_ylim">ylim</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. The y limits of the plot.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_yat">yat</code></td>
<td>

<p>Only used when <code>log="y"</code>. <br />
numeric, with points at which tick-marks will try to be drawn in the Y axis, in addition to the defaults computed by R. See the <code>at</code> argument in <code><a href="graphics.html#topic+Axis">Axis</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_xat">xat</code></td>
<td>

<p>Only used when <code>log="x"</code>. <br />
numeric, with points at which tick-marks will try to be drawn in the x axis, in addition to the defaults computed by R. See the <code>at</code> argument in <code><a href="graphics.html#topic+Axis">Axis</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_col">col</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. The colors for lines and points.  Multiple colors can be specified so that each point can be given its own color.  If there are fewer colors than points they are recycled in the standard fashion. Lines will all be plotted in the first colour specified.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_pch">pch</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. A vector of plotting characters or symbols: see <code><a href="graphics.html#topic+points">points</a></code>.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_lwd">lwd</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. The line width, see <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_lty">lty</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. The line type, see <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_cex">cex</code></td>
<td>

<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. A numerical vector giving the amount by which plotting characters and symbols should be scaled relative to the default.  
This works as a multiple of <span class="env">par("cex")</span>. 'NULL' and 'NA' are equivalent to '1.0'. Note that this does not affect annotation.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_cex.axis">cex.axis</code></td>
<td>

<p>magnification of axis annotation relative to 'cex'.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_cex.lab">cex.lab</code></td>
<td>

<p>Magnification to be used for x and y labels relative to the current setting of 'cex'. See '?par'.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_leg.txt">leg.txt</code></td>
<td>

<p>vector with the names that have to be used for each column of <code>x</code>.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_leg.cex">leg.cex</code></td>
<td>

<p>numeric, indicating the character expansion factor for the legend, *relative* to current <code>par("cex")</code>. Default value = 1
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_leg.pos">leg.pos</code></td>
<td>

<p>keyword to be used to position the legend. One of the list &lsquo;&quot;bottomright&quot;, &quot;bottom&quot;, &quot;bottomleft&quot;, &quot;left&quot;, &quot;topleft&quot;, &quot;top&quot;, &quot;topright&quot;, &quot;right&quot;, &quot;center&quot;&rsquo;. This places the legend on the inside of the plot frame at the given location. See <code><a href="graphics.html#topic+legend">legend</a></code>. <br />
When <code>leg.pos="auto"</code>, the legend provided by <code>leg.txt</code> is located on the &lsquo;bottomleft&rsquo; when <code>log="y"</code> and on the &lsquo;topright&rsquo; otherwise
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_thr.shw">thr.shw</code></td>
<td>

<p>logical, indicating if the streamflow values corresponding to the user-defined thresholds <code>lQ.thr</code> and <code>hQ.thr</code> have to be shown in the plot. <br />
When <code>leg.pos="auto"</code>, the legend with the threshold values is located on the &lsquo;topright&rsquo; when <code>log="y"</code> and on the &lsquo;bottomleft&rsquo; otherwise
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_border">border</code></td>
<td>

<p>See <code><a href="graphics.html#topic+polygon">polygon</a></code>. The color to draw the border of the polygon with the uncertainty bounds. The default, 'NA', means to omit borders. 
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_bands.col">bands.col</code></td>
<td>

<p>See <code><a href="graphics.html#topic+polygon">polygon</a></code>. The color for filling the polygon. The default, 'NA', is to leave polygons unfilled, unless <code>bands.density</code> is specified. If <code>bands.density</code> is specified with a positive value this gives the color of the shading lines.
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_bands.density">bands.density</code></td>
<td>

<p>See <code><a href="graphics.html#topic+polygon">polygon</a></code>. The density of shading lines for the polygon with the uncertainty bounds, in lines per inch. The default value of 'NULL' means that no shading lines are drawn. A zero value of <code>bands.density</code> means no shading nor filling whereas negative values (and 'NA') suppress shading (and so allow color filling).
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_bands.angle">bands.angle</code></td>
<td>

<p>See <code><a href="graphics.html#topic+polygon">polygon</a></code>. The slope of shading lines for the polygon with the uncertainty bounds, given as an angle in degrees (counter-clockwise). 
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_new">new</code></td>
<td>

<p>logical, if TRUE, a new plotting window is created. 
</p>
</td></tr>
<tr><td><code id="fdcu_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods (to the plotting functions)
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If you do not want to use logarithmic scale for the streamflow axis, you can do it by passing the <code>log=" "</code> to the <code>...</code> argument.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>References</h3>

<p><cite>Vogel, R., and N. M. Fennessey (1994), Flow duration curves I: A new interpretation and confidence intervals, ASCE, Journal of Water Resources Planning and Management, 120(4)</cite>. <br />
</p>
<p><cite>Vogel, R., and N. Fennessey (1995), Flow duration curves II: A review of applications in water resources planning, Water Resources Bulletin, 31(6), 1029-1039, doi:10.1111/j.1752-1688.1995.tb03419.x</cite>. <br />
</p>
<p><cite>Yilmaz, K. K., H. V. Gupta, and T. Wagener  (2008), A process-based diagnostic approach to model evaluation: Application to the NWS distributed hydrologic model, Water Resour. Res., 44, W09417, doi:10.1029/2007WR006716</cite>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdc">fdc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading daily streamflows at the station Oca en Ona (Ebro River basin, Spain) ##
data(OcaEnOnaQts)
q &lt;- OcaEnOnaQts

# Creating a fictitious lower uncertainty band
lband &lt;- q - min(q, na.rm=TRUE)

# Giving a fictitious upper uncertainty band
uband &lt;- q + mean(q, na.rm=TRUE)

# Plotting the flow duration curve corresponding to 'q', with two uncertainty bounds
fdcu(q, lband, uband)
</code></pre>

<hr>
<h2 id='hip'>
Hours in Period
</h2><span id='topic+hip'></span>

<h3>Description</h3>

<p>Given any starting and ending date/time objects, it generates:  <br />
1) a vector of class c(&quot;POSIXct&quot; &quot;POSIXt&quot;) with all the hours between the two date/time objects (both of them included), OR <br />
2) the amount of hours between the two date/time objects 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hip(from, to, date.fmt="%Y-%m-%d %H", out.type = "seq", tz="UTC")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hip_+3A_from">from</code></td>
<td>

<p>Character or POSIXct object indicating the starting date/time for creating the sequence. It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="hip_+3A_to">to</code></td>
<td>

<p>Character indicating the ending date/time for creating the sequence. It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="hip_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the date/time objects are stored in <code>from</code> and <code>to</code>, e.g. <kbd>%Y-%m-%d %H:%M</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="hip_+3A_out.type">out.type</code></td>
<td>

<p>Character indicating the type of result that is given by this function. Valid values are: <br />
1) <kbd>seq</kbd> : a vector of class Date with all the days between the two dates, OR <br />
2) <kbd>nmbr</kbd>: a single numeric value with the amount of days between the two dates.
</p>
</td></tr>
<tr><td><code id="hip_+3A_tz">tz</code></td>
<td>

<p>specification of the desired time zone yo be used. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> (the default value) is UTC (Universal Time, Coordinated). See <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. <br />
This argument can be used when working with subdaily zoo objects to force using the local time zone instead of GMT as time zone.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the value of <code>out.type</code>, it returns: <br />
1) a vector of class <code>c("POSIXct" "POSIXt")</code> with all the hours between <code>from</code> and <code>to</code> (both of them included), OR <br />
2) the amount of hours between the two date/time objects
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dip">dip</a></code>, <code><a href="#topic+mip">mip</a></code>, <code><a href="#topic+yip">yip</a></code>, <code><a href="#topic+diy">diy</a></code>, <code><a href="xts.html#topic+timeBasedSeq">timeBasedSeq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sequence of hours between "1961-01-01 00:00" and "1961-01-10 00:00", giving the
## starting and ending date/time objects with hours and skipping the minutes (default)
hip("1961-01-01 00", "1961-12-31 00")

## Sequence of hours between "1961-01-01 00:00" and "1961-01-10 00:00", giving the
## starting and ending date/time objects only with hours and minutes(skipping the minutes)
hip("1961-01-01 00:00", "1961-12-31 00:00", date.fmt="%Y-%m-%d %H:%M")

## Number of hours between the 10:00 AM of "1961-Jan-02" and the 11:00 AM of "1961-Jan-01", 
## using "%d/%m/%Y" as date/time format.
hip("01/01/1961 10", "02/01/1961 11", date.fmt= "%d/%m/%Y %H", out.type = "nmbr")

</code></pre>

<hr>
<h2 id='hydropairs'>
Visual Correlation Matrix
</h2><span id='topic+hydropairs'></span>

<h3>Description</h3>

<p>Visualization of a correlation matrix. On top the (absolute) value of the correlation plus the result of the <code><a href="stats.html#topic+cor.test">cor.test</a></code> as stars. On bottom, the bivariate scatterplots, with a fitted line. On the diagonal, an histogram of each variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hydropairs(x, dec = 3, use = "pairwise.complete.obs", method = "pearson",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hydropairs_+3A_x">x</code></td>
<td>

<p>data.frame or matrix object with measurements at several locations. Each column of <code>x</code> represent values measured at different locations.
</p>
</td></tr>
<tr><td><code id="hydropairs_+3A_dec">dec</code></td>
<td>

<p>decimal places to be used for showing the correlation values
</p>
</td></tr>
<tr><td><code id="hydropairs_+3A_use">use</code></td>
<td>

<p>See <code><a href="stats.html#topic+cor">cor</a></code>. An optional character string giving a method for computing covariances in the presence of missing values. This must be (an abbreviation of) one of the strings &quot;everything&quot;, &quot;all.obs&quot;, &quot;complete.obs&quot;, &quot;na.or.complete&quot;, or &quot;pairwise.complete.obs&quot;.
</p>
</td></tr>
<tr><td><code id="hydropairs_+3A_method">method</code></td>
<td>

<p>See <code><a href="stats.html#topic+cor">cor</a></code>. A character string indicating which correlation coefficient (or covariance) is to be computed. One of &quot;pearson&quot; (default), &quot;kendall&quot;, or &quot;spearman&quot;, can be abbreviated
</p>
</td></tr>
<tr><td><code id="hydropairs_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods, in particular it is used in the <code><a href="graphics.html#topic+pairs">pairs</a></code> function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>On top</code></td>
<td>
<p> the (absolute) value of the correlation plus the result of the cor.test as points</p>
</td></tr>
<tr><td><code>On bottom</code></td>
<td>
<p>the bivariate scatterplots, with a fitted line</p>
</td></tr>
<tr><td><code>On diagonal</code></td>
<td>
<p>histograms (from <code><a href="graphics.html#topic+pairs">pairs</a></code>)</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Original idea taken from the R Graph Gallery (nowadays not available on its original link: http://addictedtor.free.fr/graphiques/graphcode.php?graph=137). <br />
</p>
<p>Histogram panel was taken from the R help of the original <code><a href="graphics.html#topic+pairs">pairs</a></code> function
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor">cor</a></code>, <code><a href="graphics.html#topic+pairs">pairs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)

## Visualizing the correlation among the monthly precipitation values 
## of the first 3 gauging stations in 'EbroPPtsMonthly'. 
## The first column of 'EbroPPtsMonthly' has the dates.
hydropairs(EbroPPtsMonthly[,2:4])
</code></pre>

<hr>
<h2 id='hydroplot'>
Hydrological time series plotting and extraction.
</h2><span id='topic+sname2plot'></span><span id='topic+sname2plot.default'></span><span id='topic+sname2plot.zoo'></span><span id='topic+sname2plot.data.frame'></span><span id='topic+hydroplot'></span><span id='topic+hydroplot.default'></span><span id='topic+hydroplot.zoo'></span><span id='topic+hydroplot.data.frame'></span>

<h3>Description</h3>

<p><code>hydroplot</code>: When <code>x</code> is a zoo object it plots (a maximum of) 9 graphs (lines plot, boxplots and/or histograms) of the daily, monthly, annual and/or seasonal time series. <br />
</p>
<p><code>sname2plot</code>: When <code>x</code> is a data frame whose columns contain the time series of several gauging stations, it takes the name of one gauging station and plots the graphs described above.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hydroplot(x, ...)
sname2plot(x, ...)

## Default S3 method:
hydroplot(x, FUN, na.rm=TRUE, ptype="ts+boxplot+hist", pfreq="dma",                      
          var.type, var.unit="units", main=NULL, xlab="Time", ylab,
          win.len1=0, win.len2=0, tick.tstep="auto", lab.tstep="auto", 
          lab.fmt=NULL, cex=0.3, cex.main=1.3, cex.lab=1.3, cex.axis=1.3, 
          col=c("blue", "lightblue", "lightblue"), 
          from=NULL, to=NULL, dates=1, date.fmt= "%Y-%m-%d", 
          stype="default", season.names=c("Winter", "Spring", "Summer", "Autumn"), 
          h=NULL, ...)

## S3 method for class 'zoo'
hydroplot(x, FUN, na.rm=TRUE, ptype="ts+boxplot+hist", pfreq="dma",                      
          var.type, var.unit="units", main=NULL, xlab="Time", ylab,
          win.len1=0, win.len2=0, tick.tstep="auto", lab.tstep="auto", 
          lab.fmt=NULL, cex=0.3, cex.main=1.3, cex.lab=1.3, cex.axis=1.3, 
          col=c("blue", "lightblue", "lightblue"), 
          from=NULL, to=NULL, dates=1, date.fmt= "%Y-%m-%d", 
          stype="default", season.names=c("Winter", "Spring", "Summer", "Autumn"), 
          h=NULL, ...)

## S3 method for class 'data.frame'
hydroplot(x, FUN, na.rm=TRUE, ptype="ts+boxplot+hist", pfreq="dma",                      
          var.type, var.unit="units", main=NULL, xlab="Time", ylab,
          win.len1=0, win.len2=0, tick.tstep="auto", lab.tstep="auto", 
          lab.fmt=NULL, cex=0.3, cex.main=1.3, cex.lab=1.3, cex.axis=1.3, 
          col=c("blue", "lightblue", "lightblue"), 
          from=NULL, to=NULL, dates=1, date.fmt= "%Y-%m-%d", 
          stype="default", season.names=c("Winter", "Spring", "Summer", "Autumn"), 
          h=NULL, ...)

## Default S3 method:
sname2plot(x, sname, FUN, na.rm=TRUE, ptype="ts+boxplot+hist", 
           pfreq="dma", var.type, var.unit="units", main=NULL, 
           xlab="Time", ylab=NULL, win.len1=0, win.len2=0, 
           tick.tstep="auto", lab.tstep="auto", lab.fmt=NULL, 
           cex=0.3, cex.main=1.3, cex.lab=1.3, cex.axis=1.3,
           col=c("blue", "lightblue", "lightblue"), 
           dates=1, date.fmt = "%Y-%m-%d", from=NULL, to=NULL, stype="default", 
           season.names=c("Winter", "Spring", "Summer", "Autumn"), 
           h=NULL, ...)

## S3 method for class 'zoo'
sname2plot(x, sname, FUN, na.rm=TRUE, ptype="ts+boxplot+hist", 
           pfreq="dma", var.type, var.unit="units", main=NULL, 
           xlab="Time", ylab=NULL, win.len1=0, win.len2=0, 
           tick.tstep="auto", lab.tstep="auto", lab.fmt=NULL, 
           cex=0.3, cex.main=1.3, cex.lab=1.3, cex.axis=1.3,
           col=c("blue", "lightblue", "lightblue"), 
           dates=1, date.fmt = "%Y-%m-%d", from=NULL, to=NULL, stype="default", 
           season.names=c("Winter", "Spring", "Summer", "Autumn"), 
           h=NULL, ...)

## S3 method for class 'data.frame'
sname2plot(x, sname, FUN, na.rm=TRUE, ptype="ts+boxplot+hist", 
           pfreq="dma", var.type, var.unit="units", main=NULL, 
           xlab="Time", ylab=NULL, win.len1=0, win.len2=0, 
           tick.tstep="auto", lab.tstep="auto", lab.fmt=NULL, 
           cex=0.3, cex.main=1.3, cex.lab=1.3, cex.axis=1.3,
           col=c("blue", "lightblue", "lightblue"), 
           dates=1, date.fmt = "%Y-%m-%d", from=NULL, to=NULL, stype="default", 
           season.names=c("Winter", "Spring", "Summer", "Autumn"), 
           h=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hydroplot_+3A_x">x</code></td>
<td>

<p>zoo, xts or data.frame object, with columns storing the time series of one or more gauging stations.
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_sname">sname</code></td>
<td>

<p>ONLY required when <code>x</code> is a data frame. <br />
Character representing the name of a station, which have to correspond to one column name in <code>x</code>
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_fun">FUN</code></td>
<td>

<p>ONLY required when <code>var.type</code> is missing AND <code>pfreq != "o"</code>. <br />
Function that have to be applied for transforming from daily to monthly or annual time step (e.g., For precipitation <code>FUN=sum</code> and for temperature and flow ts, <code>FUN=mean</code>) 
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed before the computations?
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_ptype">ptype</code></td>
<td>

<p>Character indicating the type of plot that will be plotted. Valid values are: <br />
-) <kbd>ts</kbd>              =&gt; only time series                  <br />
-) <kbd>ts+boxplot</kbd>      =&gt; only time series + boxplot        <br />       
-) <kbd>ts+hist</kbd>         =&gt; only time series + histogram      <br />
-) <kbd>ts+boxplot+hist</kbd> =&gt; time series + boxplot + histogram 
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_pfreq">pfreq</code></td>
<td>

<p>Character indicating how many plots are desired by the user. Valid values are: <br />                    
-) <kbd>dma</kbd>     : Daily, Monthly and Annual values are plotted <br />
-) <kbd>dm</kbd>      : Daily and Monthly values are plotted  <br />
-) <kbd>ma</kbd>      : Monthly and Annual values are plotted <br />
-) <kbd>o</kbd>       : Only the original zoo object is plotted, and <code>ptype</code> is changed to <kbd>ts</kbd> <br />
-) <kbd>seasonal</kbd>: Line and bloxplots of seasonal time series (see <code>stype</code> and <code>season.names</code>). When <code>pfreq</code> is <kbd>seasonal</kbd>, <code>ptype</code> is set to  <kbd>ts+boxplot</kbd>
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_var.type">var.type</code></td>
<td>

<p>ONLY required when <code>FUN</code> is missing. <br />
character representing the type of variable being plotted. Used for determining the function used for computing the monthly and annual values when <code>FUN</code> is missing. Valid values are: <br />
-) <kbd>Precipitation</kbd> =&gt; <code>FUN=sum</code>  <br />
-) <kbd>Temperature</kbd>   =&gt; <code>FUN=mean</code> <br />
-) <kbd>Flow</kbd>          =&gt; <code>FUN=mean</code> <br />
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_var.unit">var.unit</code></td>
<td>

<p>Character representing the measurement unit of the variable being plotted. ONLY used for labelling the axes (e.g., &quot;mm&quot; for precipitation, &quot;C&quot; for temperature, and &quot;m3/s&quot; for flow.)
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_main">main</code></td>
<td>

<p>Character representing the main title of the plot. If the user do not provide a title, this is created automatically as: <code>main= paste(var.type, "at", sname, sep=" ")</code>, 
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_xlab">xlab</code></td>
<td>

<p>A title for the x axis. See <code><a href="graphics.html#topic+plot">plot</a></code>. 
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_ylab">ylab</code></td>
<td>

<p>A title for the y axis. See <code><a href="graphics.html#topic+plot">plot</a></code>. 
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_win.len1">win.len1</code></td>
<td>

<p>number of days for being used in the computation of the first moving average. A value equal to zero indicates that this moving average is not going to be computed.
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_win.len2">win.len2</code></td>
<td>

<p>number of days for being used in the computation of the second moving average. A value equal to zero indicates that this moving average is not going to be computed.
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_tick.tstep">tick.tstep</code></td>
<td>

<p>Character indicating the time step that have to be used for putting the ticks on the time axis. Valid values are: <br />
-) <kbd>days</kbd>,    <br />
-) <kbd>months</kbd>,  <br />
-) <kbd>years</kbd> 
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_lab.tstep">lab.tstep</code></td>
<td>

<p>Character indicating the time step that have to be used for putting the labels on the time axis. Valid values are: <br />
-) <kbd>days</kbd>,   <br />
-) <kbd>months</kbd>, <br />
-) <kbd>years</kbd> 
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_lab.fmt">lab.fmt</code></td>
<td>

<p>Character indicating with the format to be used for the label of the axis. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. If not specified, it will try <kbd>"%Y-%m-%d"</kbd> when <code>lab.tstep=="days"</code>, <kbd>"%b"</kbd> when <code>lab.tstep=="month"</code>, and <kbd>"%Y"</kbd> when <code>lab.tstep=="year"</code>. 
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_cex">cex</code></td>
<td>

<p>A numerical value giving the amount by which plotting text and symbols should be magnified relative to the default. (See <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_cex.main">cex.main</code></td>
<td>

<p>The magnification to be used for main titles relative to the current setting of <code>cex</code> (See <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_cex.lab">cex.lab</code></td>
<td>

<p>The magnification to be used for x and y labels relative to the current setting of <code>cex</code> (See <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_cex.axis">cex.axis</code></td>
<td>

<p>The magnification to be used for axis annotation relative to the current setting of <code>cex</code> (See <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_col">col</code></td>
<td>

<p>A character vector with 3 elements, representing the colors to be used for plotting the lines of the ts, the boxplots, and the histograms, respectively. <br />
When <code>pfreq="o"</code>, only one character element is needed.
See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>).
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_dates">dates</code></td>
<td>

<p>ONLY required when <code>x</code> is a data frame. It is a numeric, factor or Date object indicating how to obtain the dates corresponding to the <code>sname</code> station. <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into Date class, using the date format  specified by <code>date.fmt</code> <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of element in <code>x</code>
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_date.fmt">date.fmt</code></td>
<td>

<p>Character indicating the format in which the dates are stored in <var>dates</var>, <var>from</var> and <var>to</var>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_from">from</code></td>
<td>

<p>OPTIONAL, used for extracting a subset of values. <br />
Character indicating the starting date for the values to be extracted. It must be provided in the format specified by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_to">to</code></td>
<td>

<p>OPTIONAL, used for extracting a subset of values. <br />
Character indicating the ending date for the values to be extracted. It must be provided in the format specified by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_stype">stype</code></td>
<td>

<p>OPTIONAL, only used when <code>pfreq=seasonal</code>. <br />
character, indicating which weather seasons will be used for computing the output. Possible values are: <br />
-) <kbd>default</kbd>          =&gt;  &quot;winter&quot;= DJF  = Dec, Jan, Feb;      &quot;spring&quot;= MAM = Mar, Apr, May;  &quot;summer&quot;= JJA  = Jun, Jul, Aug;       &quot;autumn&quot;= SON = Sep, Oct, Nov  <br />
-) <kbd>FrenchPolynesia</kbd>  =&gt;  &quot;winter&quot;= DJFM = Dec, Jan, Feb, Mar; &quot;spring&quot;= AM  = Apr, May;       &quot;summer&quot;= JJAS = Jun, Jul, Aug, Sep;  &quot;autumn&quot;= ON  = Oct, Nov 
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_season.names">season.names</code></td>
<td>

<p>OPTIONAL, only used when <code>pfreq=seasonal</code>. <br />
character of length 4 indicating the names of each one of the weather seasons defined by <code>stype</code>.These names are only used for plotting purposes
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_h">h</code></td>
<td>

<p>OPTIONAL, only used when <code>pfreq=seasonal</code>, for plotting horizontal lines in each seasonal plot. <br />
numeric, with 1 or 4 elements, with the value used for plotting an horizontal line in each seasonal plot, in the following order: winter (DJF), spring (MAM), summer (JJA), autumn (SON).
</p>
</td></tr>
<tr><td><code id="hydroplot_+3A_...">...</code></td>
<td>

<p>further arguments passed to the <code>plot.zoo</code> and <code>axis</code> functions or from other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots of the daily/monthly/annual/seasonal values of the time series given as input. <br />
Depending on the value of <code>pfreq</code>, daily, monthly, annual and/or seasonal time series plots, boxplots and histograms are produced. <br />
Depending on the value of <code>ptype</code>, time series plots, boxplots and/or histograms are produced.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sname2ts">sname2ts</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############
## Loading daily streamflows at the station Oca en Ona (Ebro River basin, Spain) ##
data(OcaEnOnaQts)

## 3 ts, 3 boxplots and 3 histograms
hydroplot(OcaEnOnaQts, FUN=mean, ylab= "Q", var.unit = "m3/s")

## only the original time series
hydroplot(OcaEnOnaQts, pfreq="o")

## only the year 1962 of the original time series
hydroplot(OcaEnOnaQts, pfreq="o", from="1962-01-01", to="1962-12-31")

## Not run: 
## seasonal plots
hydroplot(OcaEnOnaQts, pfreq="seasonal", FUN=mean, stype="default")

## custom season names (let's assume to be in the Southern Hemisphere)
hydroplot(OcaEnOnaQts, pfreq="seasonal", FUN=mean, 
          stype="default", season.names=c("Summer","Autumn", "Winter","Spring"))

## End(Not run)

#############
## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)

## Plotting the monthly and annual values of precipitation at station "P9001", 
## stored in 'EbroPPtsMonthly'.
sname2plot(EbroPPtsMonthly, sname="P9001", var.type="Precipitation", dates=1, 
           pfreq="ma")

## Plotting seasonal precipitation at station "P9001"
par(mar=c(5.1, 4.1, 4.1, 2.1))

sname2plot(EbroPPtsMonthly, sname="P9001", FUN=sum, dates=1, pfreq="seasonal", 
           stype="default")

</code></pre>

<hr>
<h2 id='hydroTSM-internal'>Internal hydroTSM objects</h2><span id='topic+.che2zoo'></span><span id='topic+.CHE_daily_analysis'></span><span id='topic+.DailyTS2DB'></span><span id='topic+.dwi.che'></span><span id='topic+.hydroplotboxplot'></span><span id='topic+.hydroplothist'></span><span id='topic+.hydroplotts'></span><span id='topic+.northarrow'></span><span id='topic+.plot.daily.analysis'></span><span id='topic+.Qcsv2zoo'></span><span id='topic+.scalebar'></span><span id='topic+.dmc'></span><span id='topic+.drty.dcs2zoo'></span><span id='topic+.interpol1'></span>

<h3>Description</h3>

<p>Internal hydroTSM objects.</p>


<h3>Details</h3>

<p>These are not to be called by the user.</p>

<hr>
<h2 id='infillxy'>
Infills NA values
</h2><span id='topic+infillxy'></span><span id='topic+infillxy.matrix'></span><span id='topic+infillxy.default'></span><span id='topic+infillxy.data.frame'></span>

<h3>Description</h3>

<p>Infill all the missing values (NA) in <code>x</code> with the corresponding values in <code>sim</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>infillxy(x, ...)
## Default S3 method:
infillxy(x, sim, ...)
## S3 method for class 'matrix'
infillxy(x, sim, ...)
## S3 method for class 'data.frame'
infillxy(x, sim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="infillxy_+3A_x">x</code></td>
<td>

<p>numeric, data.frame or matrix in which some values are missing (NA).
</p>
</td></tr>
<tr><td><code id="infillxy_+3A_sim">sim</code></td>
<td>

<p>numeric, data.frame or matrix, with the same dimension of <code>x</code>, which contains the values that will be used for infilling the missing (NA) values in <code>x</code>
</p>
</td></tr>
<tr><td><code id="infillxy_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It gives as a result an object of the same dimension of <code>x</code>, in which all the NA values were infilled with the corresponding values of <code>sim</code>.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obs &lt;- c(1, NA, 3, 4, NA, 5)
sim &lt;- rep(2, 6)

## Filling in the missing values in 'x' with the corresponding values in 'sim'
infillxy(x=obs, sim)

</code></pre>

<hr>
<h2 id='istdx'>
Inverse Standarization
</h2><span id='topic+istdx'></span><span id='topic+istdx.default'></span><span id='topic+istdx.matrix'></span><span id='topic+istdx.data.frame'></span>

<h3>Description</h3>

<p>This function back transforms a standarized vector/matrix <code>z</code> into their original values, i.e., re-scales all the values in the [0,1] interval to the original range of values  <code>z = re-scale(x) = x*[ xmax - xmin ] + xmin</code>.       
</p>


<h3>Usage</h3>

<pre><code class='language-R'>istdx(x, ...)
## Default S3 method:
istdx(x, xmin, xrange, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="istdx_+3A_x">x</code></td>
<td>

<p>standarized vector or matrix to be re-scaled, all the values have to be in the range [0,1]
</p>
</td></tr>
<tr><td><code id="istdx_+3A_xmin">xmin</code></td>
<td>

<p>numeric with the minimum value(s) in the original <code>x</code> <br />
-) if <code>x</code> is a vector, <code>xmin</code> has to be a real <br />
-) if <code>x</code> is a matrix/data.frame, <code>xmin</code> has to be a vector, with the minimum values for each column of the original <code>x</code>. In this case, the vector of minimums can be obtained as: <code>xmin &lt;-  apply(x, 2, min, na.rm=TRUE)</code>
</p>
</td></tr>
<tr><td><code id="istdx_+3A_xrange">xrange</code></td>
<td>

<p>numeric with the range of value(s) in the original <code>x</code> <br />
-) if <code>x</code> is a vector, <code>xrange</code> has to be a real <br />
-) if <code>x</code> is a matrix/data.frame, <code>xrange</code> has to be a vector, with the range of values for each column of the original <code>x</code>.
In this case, the vector of ranges can be obtained as: <br />
<code>xrange &lt;-  apply(x, 2,range, na.rm=TRUE)</code> <br />
<code>xrange &lt;-  apply(xrange, 2, diff, na.rm=TRUE)</code> 
</p>
</td></tr>
<tr><td><code id="istdx_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stdx">stdx</a></code>, <code><a href="base.html#topic+scale">scale</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading daily streamflows at the station Oca en Ona (Ebro River basin, Spain) ##
data(OcaEnOnaQts)
x &lt;- OcaEnOnaQts

## Computing xmin and the range of 'x'
xmin &lt;- min(x, na.rm=TRUE)
r &lt;- diff(range(x, na.rm=TRUE))

## Standarized variable
s &lt;- stdx(x)

## Inverse of the standarized variable
si &lt;- istdx(s, xmin, xrange=r)

## 'si' and 'x' should be the same
summary(x-si)

###########
### Standarizing a subset of the stations 9 to 12 in 'EbroPPtsMonthly'

## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)

pp &lt;- EbroPPtsMonthly[1:70,10:13]
xmin   &lt;- apply(pp, 2, min, na.rm=TRUE)
xrange &lt;- apply(pp, 2, range, na.rm=TRUE)
xrange &lt;- apply(xrange, 2, diff, na.rm=TRUE)

## Standarized variable
s &lt;- stdx(as.matrix(pp))

## Inverse of the standarized variable
si &lt;- istdx(s, xmin, xrange)

## 'si' and 'pp' should be the same
summary(pp - si)

</code></pre>

<hr>
<h2 id='izoo2rzoo'>
Irregular Zoo -&gt; Regular Zoo
</h2><span id='topic+izoo2rzoo'></span><span id='topic+izoo2rzoo.default'></span><span id='topic+izoo2rzoo.zoo'></span>

<h3>Description</h3>

<p>It takes an irregular zoo object (with non-existing values for some dates) and converts it into a regularly spaced zoo object within the time period defined by <code>from</code> and <code>to</code>, by filling the missing dates with &lsquo;NA&rsquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>izoo2rzoo(x, ...)

## Default S3 method:
izoo2rzoo(x, from= start(x), to= end(x), 
                   date.fmt, tstep, tz, ...)
     
## S3 method for class 'zoo'
izoo2rzoo(x, from= start(x), to= end(x), 
                   date.fmt, tstep, tz, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="izoo2rzoo_+3A_x">x</code></td>
<td>

<p>irregular zoo object (vector or matrix) representing a time series (very likely read with some user-defined procedure, and with some missing values for particular days/months/years)
</p>
</td></tr>
<tr><td><code id="izoo2rzoo_+3A_from">from</code></td>
<td>

<p>Character indicating the starting date for creating the regularly spaced zoo object. The default value corresponds to the date of the first element of <code>x</code> <br />
It has to be in the format indicated by <code>date.fmt</code>. 
</p>
</td></tr>
<tr><td><code id="izoo2rzoo_+3A_to">to</code></td>
<td>

<p>Character indicating the ending date for creating the regularly spaced zoo object. The default value corresponds to the date of the last element of <code>x</code> <br />
It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="izoo2rzoo_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>from</code> and <code>to</code>, e.g. <kbd>%Y-%m-%d</kbd>. See &lsquo;Details&rsquo; section in <code><a href="base.html#topic+strptime">strptime</a></code>.
By default, <code>date.fmt</code> is missing, and it is automatically set to <kbd>%Y-%m-%d</kbd> when <code>time(x)</code> is <code>Date</code> object, and set to <kbd>%Y-%m-%d %H:%M:%S</kbd> when <code>x</code> is a sub-daily zoo object.
</p>
</td></tr>
<tr><td><code id="izoo2rzoo_+3A_tstep">tstep</code></td>
<td>

<p>character, indicating the time step used for creating the time sequence going from <code>from</code> to <code>to</code> that will be used as <code>time(x)</code> <br />
Valid values are (but not limited to) <kbd>hours</kbd>, <kbd>days</kbd>, <kbd>months</kbd>, <kbd>years</kbd>.
By default, <code>tstep</code> is missing, and it is automatically set to <kbd>"minutes"</kbd> when <code>sfreq(x)</code> is <kbd>min</kbd>, to <kbd>"hours"</kbd> when <code>sfreq(x)</code> is <kbd>hourly</kbd>, to <kbd>"days"</kbd> when <code>sfreq(x)</code> is <kbd>daily</kbd>, to <kbd>"weeks"</kbd> when <code>sfreq(x)</code> is <kbd>weekly</kbd>, to <kbd>"months"</kbd> when <code>sfreq(x)</code> is <kbd>monthly</kbd>, to <kbd>"quarters"</kbd> when <code>sfreq(x)</code> is <kbd>quarterly</kbd>, and to <kbd>"years"</kbd> when <code>sfreq(x)</code> is <kbd>annual</kbd>.
</p>
</td></tr>
<tr><td><code id="izoo2rzoo_+3A_tz">tz</code></td>
<td>

<p>character, with the specification of the time zone used for <code>from</code>, <code>to</code>. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> is UTC (Universal Time, Coordinated). See <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. <br />
</p>
<p>If <code>tz</code> is missing (the default), it is automatically set to the time zone used in <code>time(x)</code>. <br />
</p>
<p>This argument can be used when working with sub-daily zoo objects to force using  time zones other than the local time zone for <code>from</code> and <code>to</code>. It should be used with caution, being well aware of the time zone of the data. See examples.
</p>
</td></tr>
<tr><td><code id="izoo2rzoo_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the full time period of <code>x</code> is a subset of the time period defined by <code>from</code> and <code>to</code>, the time period of the resulting zoo is the one defined by <code>from</code> and <code>to</code>, assigning 'NA' to all the dates in which <code>x</code> do not have a value.
</p>


<h3>Value</h3>

<p>a regularly spaced zoo object, with values given by <code>x</code> and time stamps going from <code>from</code> to <code>to</code> at intervals defined by <code>tsteps</code>
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="zoo.html#topic+zoo">zoo</a></code>, <code><a href="#topic+vector2zoo">vector2zoo</a></code>, <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>, <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1: Adding NA for February 29th to an existing zoo object

# dummy values and dates (February 29th is not present !)
x &lt;- 1:9
dates &lt;- c("1964-02-25", "1964-02-26", "1964-02-27", "1964-02-28", "1964-03-01", 
           "1964-03-02", "1964-03-03", "1964-03-04", "1964-03-05")

# From 'character' to 'Date' class
dates &lt;- as.Date(dates)

## From 'numeric' to 'zoo' class
( x &lt;- zoo(x, dates) ) # Feb 29th is still not present in 'x'
## checking the length of 'x'
length(x) # 9 elements (there is no data for Feb 29th)

## Adding a missing value (NA in this case) for Feb 29th
( y &lt;- izoo2rzoo(x) )

## checking the new length
length(y) # 1 element more than the original 'x' (thre is an NA value in Feb 29th)


##
## Example 2: Extending the original 'x' object from February 1st to the end of March, 
#             assigning 'NA' to the days in which 'x' do not have a value.
( y &lt;- izoo2rzoo(x, from="1964-02-01", to="1964-03-31") )


##
## Example 3: Working with a zoo matrix with two identical 'x' time series, 
##            from 1964-02-25 to 1964-03-05
( Y &lt;- cbind(x,x) )

# Adding a missing value (NA in this case) for Feb 29th in all the columns of Y
( rY &lt;- izoo2rzoo(Y) )


##
## Example 4: Working with hourly data, from 01:00 to 10:00 UTC on 12th December 2000
dates  &lt;- ISOdatetime(year=2000, month=12, day=12, hour=1:10, min=0, sec=0, tz="UTC")
values &lt;- 1:10
x      &lt;- zoo(values, dates)

# removing four values in 'x', from 02:00 to 05:00, i.e., they will not be present 
# anymore in 'x' at all, not even NA !)
x &lt;- x[-c(2:5)]
time(x)
length(x)

# Adding missing values (NA in this case) from 02:00 to 05:00
y &lt;-  izoo2rzoo(x)
time(y)
length(y)


##
## Example 5: Extending hourly data to a DateTime before 'start(x)', 
##            specifying only the date.
##            Time of 'x' is in local time zone (tz="") instead of UTC
dt &lt;- hip("2021-01-01 00:00:00", "2021-01-01 20:00:00", tz="")
x  &lt;- zoo(0:20, dt)
(y  &lt;- izoo2rzoo(x, from="2020-12-31") )# 00:00:00 is ommited


##
## Example 6: Extending hourly data to a DateTime before 'start(x)', 
##            specifying date and time.
##            Time of 'x' is in local time zone (tz="") instead of UTC
dt &lt;- hip("2021-01-01 00:00:00", "2021-01-01 20:00:00", tz="")
x  &lt;- zoo(0:20, dt)
( y  &lt;- izoo2rzoo(x, from="2020-12-31 20:00:00") )


##
## Example 7: Extending hourly data to a DateTime after 'end(x)', 
##            specifying date and time.
##            Time of 'x' is in local time zone (tz="") instead of UTC
dt &lt;- hip("2021-01-01 00:00:00", "2021-01-01 20:00:00", tz="")
x  &lt;- zoo(0:20, dt)
( y  &lt;- izoo2rzoo(x, to="2021-01-02 12:00:00") )


##
## Example 8: Extending hourly data to a DateTime before 'start(x)'.
##            Note that the 'tz' argument can be ommited in the 'hip' function, 
##            because by default it assumes UTC as time zone
dt &lt;- hip("2021-01-01 00:00:00", "2021-01-01 20:00:00", tz="UTC")
x  &lt;- zoo(0:20, dt)
( y  &lt;- izoo2rzoo(x, from="2020-12-31 20:00:00", tz="UTC") )


##
## Example 9: Extending hourly data to a date before 'start(x)'. However, hourly 'x'
##            values are given at HH:15:00 hours instead of HH:00:00 hours.

## Loading the time series of hourly streamflows for the station Karamea at Gorge
## Time Zone for 'KarameaAtGorgeQts' data is GMT+12 (see ?KarameaAtGorgeQts)
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

# Subsetting 'x' to its first day only
# (01/Jan/1980 08:15:00 - 01/Jan/1980 23:15:00)
x &lt;- window(x, end="1980-01-01 23:59:00")

# Adding NA hourly data since 1979-12-31 21:15:00
izoo2rzoo(x, from="1979-12-31 21:15:00", tz="GMT+12")
</code></pre>

<hr>
<h2 id='KarameaAtGorgeQts'>
Karamea at Gorge, time series of hourly streamflows
</h2><span id='topic+KarameaAtGorgeQts'></span>

<h3>Description</h3>

<p>Time series with hourly streamflows for the Karamea River(New Zealand) measured at the gauging station &quot;Gorge&quot;, for the period 01/Jan/1980 to 31/Dec/1985.
Station Number: 95102, Easting Coordinate (NZMG): 2444629.0, Northing Coordinate (NZMG): 5994427.0, Catchment Area (km2): 1160.0.
</p>
<p>In November 25th, 2023, the time zone of this data sete was changed from &quot;none&quot; (i.e., your local time zone was used every time you loaded this dataset)
to GMT+12, in order to avoid missing datetimes at times where daylight saving time ocurred. After this change, the initial DateTime of this dataset changed 
from &quot;1980-01-01 08:15:00 -03&quot; (in my local computer) to &quot;1980-01-01 00:15:00&quot; (everywhere). 
Only two NA elements were removed from the origanl dataset: the first one and the last one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(KarameaAtGorgeQts)
</code></pre>


<h3>Format</h3>

<p>zoo object.
</p>


<h3>Source</h3>

<p>Provided by the National Institute of Water and Atmospheric Research <a href="https://niwa.co.nz/">https://niwa.co.nz/</a>, thanks to the gentle collaboration of Shailesh Singh <br />
</p>
<p>These data are intended to be used for research purposes only, being distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY.
</p>

<hr>
<h2 id='ma'>
Moving Average
</h2><span id='topic+ma.zoo'></span><span id='topic+ma.default'></span><span id='topic+ma'></span>

<h3>Description</h3>

<p>Generic function for computing a moving (sliding) average of ts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ma(x, ...)

## Default S3 method:
ma(x, win.len, FUN = mean, ...)

## S3 method for class 'zoo'
ma(x, win.len, FUN = mean, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ma_+3A_x">x</code></td>
<td>

<p>ts or zoo object.
</p>
</td></tr>
<tr><td><code id="ma_+3A_win.len">win.len</code></td>
<td>

<p>number of terms that will be considered in the mean. It have to be odd
</p>
</td></tr>
<tr><td><code id="ma_+3A_fun">FUN</code></td>
<td>

<p>Function that have to be applied for computing the moving average. Usually, <code>FUN</code> MUST be <code>mean</code>
</p>
</td></tr>
<tr><td><code id="ma_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with the moving average termns. The length of the resulting vector is the same of <code>x</code>, but the first and last <code>(win.len-1)/2</code> elements will be NA.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading daily streamflows at the station Oca en Ona (Ebro River basin, Spain) ##
data(OcaEnOnaQts)
x &lt;- OcaEnOnaQts

## Daily to Monthly ts
m &lt;- daily2monthly(x, FUN=mean, na.rm=FALSE)

# Plotting the monthly values
plot(m, xlab="Time")

## Plotting the annual moving average in station 'x'
lines(ma(m, win.len=12), col="blue")

</code></pre>

<hr>
<h2 id='MaquehueTemuco'>
San Martino, ts of daily precipitation.
</h2><span id='topic+MaquehueTemuco'></span>

<h3>Description</h3>

<p>Daily time series of precipitation, maximum and minimun air temperature at station Maquehue Temuco Ad. (DMC_ID:380013), Araucania Region, Chile (Lat:-38.770, Lon:-72.637), with data from 01/Jan/1950 to 31/Dec/2015 (including some gaps).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MaquehueTemuco)
</code></pre>


<h3>Format</h3>

<p>zoo matrix with 3 columns: <br />
-) <var>pcp</var>: daily precipitation, [mm/day]. <br />
-) <var>tmx</var>: daily maximum air temperature, [degree Celsius]. <br />
-) <var>tmn</var>: daily minimum air temperature, [degree Celsius]. <br /> 
</p>


<h3>Source</h3>

<p>Provided by Center for Climate and Resilience Research, Universidad de Chile, Santiago, Chile (<a href="https://www.cr2.cl/bases-de-datos/">https://www.cr2.cl/bases-de-datos/</a>, last accessed [Jan 2024]). <br />
These data are intended to be used for research purposes only, being distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY.
</p>

<hr>
<h2 id='matrixplot'>
Matrixplot
</h2><span id='topic+matrixplot'></span>

<h3>Description</h3>

<p>Plots a color matrix, representing the values stored in <code>x</code>. <br />
Originally, it was thought to represent the amount of days with information per year in a set of gauging stations, but it can be used for plotting the information stored in any two dimensional matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrixplot(x, ColorRamp="Days", ncolors = 70, main = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrixplot_+3A_x">x</code></td>
<td>

<p>matrix to be plotted. Originally: <br />
-) Each column of <code>x</code> represent a different gauging station, and it stores the values measured on it <br />
-) Each row of <code>x</code> represent the years, and they stores the amount of days with information in each station
</p>
</td></tr>
<tr><td><code id="matrixplot_+3A_colorramp">ColorRamp</code></td>
<td>

<p>Character or function defining a personalized color ramp for plotting the maps. <br />
Valid character values are in <kbd>c("Days", "Precipitation", "Temperature", "PCPAnomaly", "PCPAnomaly2" "TEMPAnomaly", "TEMPAnomaly2", "TEMPAnomaly3")</kbd>.
</p>
</td></tr>
<tr><td><code id="matrixplot_+3A_ncolors">ncolors</code></td>
<td>

<p>numeric, indicating the number of color intervals that will be used for representing the information content of <code>x</code>.
</p>
</td></tr>
<tr><td><code id="matrixplot_+3A_main">main</code></td>
<td>

<p>Main title for the plot
</p>
</td></tr>
<tr><td><code id="matrixplot_+3A_...">...</code></td>
<td>

<p>further arguments passed to <code><a href="lattice.html#topic+levelplot">levelplot</a></code> function (<span class="pkg">lattice</span> package) or from other methods
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Adapted from a not available web page (http://www2.warwick.ac.uk/fac/sci/moac/currentstudents/peter_cock/r/matrix_contour/)
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dwi">dwi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the SanMartino precipitation data
data(SanMartinoPPts)

# Selecting only the values up to Dec/1960
x &lt;- window(SanMartinoPPts, end=as.Date("1960-12-31"))

## Daily zoo to monthly zoo
m &lt;- daily2monthly(x, FUN=sum, na.rm=TRUE)

# Creating a data.frame with monthly values per year in each column
M &lt;- matrix(m, ncol=12, byrow=TRUE)
colnames(M) &lt;- month.abb
rownames(M) &lt;- unique(format(time(m), "%Y"))

# Plotting the monthly precipitation values from 1921 to 1960.
# Useful for identifying dry/wet months
matrixplot(M, ColorRamp="Precipitation", 
           main="Monthly precipitation at San Martino st., [mm/month]")
</code></pre>

<hr>
<h2 id='mip'>
Months in Period
</h2><span id='topic+mip'></span>

<h3>Description</h3>

<p>Given any starting and ending dates, it generates: <br />      
1) a vector of class 'Date' with all the months between the two dates (both of them included), OR <br />
2) the amount of months between the two dates 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mip(from, to, date.fmt = "%Y-%m-%d", out.type = "seq")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mip_+3A_from">from</code></td>
<td>

<p>Character indicating the starting date for creating the sequence. It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="mip_+3A_to">to</code></td>
<td>

<p>Character indicating the ending date for creating the sequence. It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="mip_+3A_date.fmt">date.fmt</code></td>
<td>

<p>Character indicating the format in which the dates are stored in <code>from</code> and <code>to</code>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>.
</p>
</td></tr>
<tr><td><code id="mip_+3A_out.type">out.type</code></td>
<td>

<p>character indicating the type of result that is given by this function. Valid values are: <br />
-) <kbd>seq</kbd> : a vectorial sequence with all the months within the given year <br />
-) <kbd>nmbr</kbd>: the number of days in the vectorial sequence with all the months within the given year
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the value of <code>out.type</code>, it returns: <br />
1) a vector of class Date with all the months between <code>from</code> and <code>to</code> (both of them included), OR <br />
2) a single numeric value with the amount of months between the two dates. 
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dip">dip</a></code>, <code><a href="#topic+diy">diy</a></code>, <code><a href="#topic+hip">hip</a></code>, <code><a href="#topic+yip">yip</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sequence of monthly dates between "1961-01-01" and "1961-12-31" ##
mip("1961-01-01", "1961-12-31")

## Computing the number of months between "1961-01-01" and "1965-06-30", 
## with the date format  "%d-%m-%Y" ##
mip("01-01-1961", "30-06-1965", date.fmt= "%d-%m-%Y", out.type = "nmbr")

</code></pre>

<hr>
<h2 id='monthlyfunction'>
Monthly Function
</h2><span id='topic+monthlyfunction'></span><span id='topic+monthlyfunction.zoo'></span><span id='topic+monthlyfunction.default'></span><span id='topic+monthlyfunction.matrix'></span><span id='topic+monthlyfunction.data.frame'></span>

<h3>Description</h3>

<p>Generic function for obtaining 12 monthly values of a zoo object, by applying any R function to ALL the values in the object belonging to each one of the 12 calendar months (Jan...Dec).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monthlyfunction(x, ...)

## Default S3 method:
monthlyfunction(x, FUN, na.rm = TRUE, ...)

## S3 method for class 'zoo'
monthlyfunction(x, FUN, na.rm=TRUE,...)

## S3 method for class 'data.frame'
monthlyfunction(x, FUN, na.rm = TRUE, dates=1, 
        date.fmt = "%Y-%m-%d", out.type = "data.frame", verbose = TRUE, ...)
             
## S3 method for class 'matrix'
monthlyfunction(x, FUN, na.rm = TRUE, dates=1, 
        date.fmt = "%Y-%m-%d", out.type = "data.frame", verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monthlyfunction_+3A_x">x</code></td>
<td>

<p>zoo, xts, data.frame or matrix object, with daily or monthly time series. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="monthlyfunction_+3A_fun">FUN</code></td>
<td>

<p>Function that will be applied to ALL the values in <code>x</code> belonging to each one of the 12 months of the year (e.g., FUN can be some of <code>mean</code>, <code>sum</code>, <code>max</code>, <code>min</code>, <code>sd</code>).
</p>
</td></tr>
<tr><td><code id="monthlyfunction_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the monthly values and FUN are computed considering only those values in <code>x</code> different from NA <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the corresponding monthly value will be NA 
</p>
</td></tr>
<tr><td><code id="monthlyfunction_+3A_dates">dates</code></td>
<td>

<p>It is only used when <code>x</code> is not a zoo object. <br />
numeric, factor, Date indicating how to obtain the dates. <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into 'Date' class, using the date format specified by <code>date.fmt</code> <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="monthlyfunction_+3A_date.fmt">date.fmt</code></td>
<td>

<p>It is only used when <code>x</code> is not a zoo object. <br />
character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="monthlyfunction_+3A_out.type">out.type</code></td>
<td>

<p>It is only used when <code>x</code> is a matrix or data.frame. <br />
Character defining the desired type of output. Valid values are: <br />
-) <kbd>data.frame</kbd>: a data.frame, with 12 columns representing the months, and as many rows as gauging stations are included in <code>x</code> <br />
-) <kbd>db</kbd>        : a data.frame, with 4 columns will be produced. Useful for a posterior boxplot <br />
The first column ('StationID') will store the ID of the station,  <br />
The second column ('Year') will store the year, <br />
The third column ('Month') will store month,  <br />
The fourth column ('Value') will contain the monthly value corresponding to the three previous columns.
</p>
</td></tr>
<tr><td><code id="monthlyfunction_+3A_verbose">verbose</code></td>
<td>

<p>Logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="monthlyfunction_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>x</code> is a zoo object, a numeric vector with 12 elements representing the computed monthly value for each month. <br />
When <code>x</code> is a data.frame which columns represent measurements at different gauging stations, the resulting object is a data.frame with 12 columns and as many rows as gauging stations are in <code>x</code>, each row storing the computed 12 monthly value for each gauging station.
</p>


<h3>Note</h3>

<p>Due to the fact that <code>FUN</code> is applied over all the elements in <code>x</code> belonging to a given calendar month, its result will depend on the sampling frequency of <code>x</code> and the type of function provided by <code>FUN</code> (<b>special attention have to be put when <code>FUN=sum</code></b>)
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+annualfunction">annualfunction</a></code>, <code><a href="#topic+seasonalfunction">seasonalfunction</a></code>, <code><a href="#topic+dm2seasonal">dm2seasonal</a></code>, <code><a href="#topic+daily2monthly">daily2monthly</a></code>, <code><a href="#topic+daily2annual">daily2annual</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading daily streamflows (3 years) at the station 
## Oca en Ona (Ebro River basin, Spain)
data(OcaEnOnaQts)
x &lt;- OcaEnOnaQts

## Mean monthly streamflows at station 'x'
monthlyfunction(x, FUN=mean, na.rm=TRUE)


############################
## Boxplot of monthly values

## Daily to Monthly
m &lt;- daily2monthly(x, FUN=mean, na.rm=TRUE)

## Median of the monthly values at the station
monthlyfunction(m, FUN=median, na.rm=TRUE)

## Vector with the three-letter abbreviations of the month names
cmonth &lt;- format(time(m), "%b")

## Creating ordered monthly factors
months &lt;- factor(cmonth, levels=unique(cmonth), ordered=TRUE)

## Boxplot of the monthly values
boxplot( coredata(m) ~ months, col="lightblue", main="Monthly streamflows, [m3/s]")


##############################
##############################
## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)
x &lt;- EbroPPtsMonthly

## Dates of 'x'
dates &lt;- as.Date(x[,1])

## Monthly precipitation of all the stations in 'x'
## Not run: 

## Sum of the monthly values in each station of 'x'
z &lt;- zoo( x[, 2:ncol(x)], dates)

# Amount of years in 'x' (needed for computing the average)
nyears &lt;- yip(from=start(z), to=end(z), out.type="nmbr" )

m &lt;- monthlyfunction(z, FUN=sum)


## Another way of computing the sum of the monthly values in each station of 'x'
## This way is usefult for posteriori boxplots
m2 &lt;- monthlyfunction(x, FUN=sum, dates=1, out.type="db")

## Average monthly precipitation in each station of 'x'
m2$Value &lt;- m2$Value / nyears 

## Creating monthly factors
m2$Month &lt;- factor(m2$Month, levels=month.abb)

## boxplot of the monthly values in all stations
boxplot(Value ~ Month, m2, col="lightyellow", main="Monthly Precipitation, [mm/month]")

## End(Not run)

</code></pre>

<hr>
<h2 id='OcaEnOnaQts'>
Oca in &quot;Ona&quot; (Q0931), time series of daily streamflows.
</h2><span id='topic+OcaEnOnaQts'></span>

<h3>Description</h3>

<p>Time series with daily streamflows of the Oca River (subcatchment of the Ebro River basin, Spain) measured at the gauging station &quot;Ona&quot; (Q093), for the period 01/Jan/1961 to 31/Dic/1963
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(OcaEnOnaQts)
</code></pre>


<h3>Format</h3>

<p>zoo object.
</p>


<h3>Source</h3>

<p>Downloaded from the web site of the Confederacion Hidrografica del Ebro (CHE) <a href="http://www.chebro.es/">http://www.chebro.es/</a> (original link http://oph.chebro.es/documentacion/CaudalEA/CaudalEA.htm, last accessed [March 2010]). <br />
</p>
<p>These data are intended to be used for research purposes only, being distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY.
</p>

<hr>
<h2 id='plot_pq'>
Plot precipitation and streamflow time series in the same figure.
</h2><span id='topic+plot_pq'></span><span id='topic+plot_pq.zoo'></span>

<h3>Description</h3>

<p>Given a time series of precipitation and streamflow, this function plots the two time series in the same figure, streamflows as a normal time series and preciitation as bars comming from the upper part of the plotting window. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pq(p, ...)

## S3 method for class 'zoo'
plot_pq(p, q, ptype=c("original", "monthly"),
                na.fill=c("remove", "linear", "spline"), 
                from=start(p), to=end(p), date.fmt=NULL, tz=NULL,
                main=ifelse(ptype=="original", "Precipitation and Streamflows", 
                            "Monthly Precipitation and Streamflows"),
                xlab=ifelse(ptype=="original", "Time", "Month"), 
                ylab=c("P, [mm]", "Q, [m3/s]"), 
                p.col=ifelse(ptype=="original", "blue", "lightblue"),
                q.col=ifelse(ptype=="original", "black", "blue"), 
                leg.title="", leg.text=c("P", "Q"),
                q.pch=16, q.cex=0.3,
                            
                start.month=1, 
                plot.p.probs=TRUE, p.probs=c(0.25, 0.75), 
                p.alpha=0.8,
                plot.q.probs=TRUE, q.probs=c(0.25, 0.75), 
                q.probs.col="lightskyblue1", q.probs.alpha=0.8, 
                labels=TRUE, labels.cex=0.8,
                labels.p.dy=-median(daily2monthly(p, FUN=sum, na.rm=TRUE), 
                             na.rm=TRUE)*1.1,
                labels.q.dx=c(rep(-0.2,6), rep(0.2,6)),
                labels.q.dy=rep(median(q, na.rm=TRUE)*1.3, 12),
                
                ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_pq_+3A_p">p</code></td>
<td>

<p>zoo object with precipitation time series, with any time frequency.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_q">q</code></td>
<td>

<p>zoo object with streamflow time series, with any time frequency.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_ptype">ptype</code></td>
<td>

<p>Character indicating the type of plot to be produced. Valid values are: <br />
-) <kbd>original</kbd> =&gt; a time series plot with precipitation in the upper panel (as bars from the time axis) and streamflows in the lower pannel (as dotted lines). <br />
-) <kbd>monthly</kbd>  =&gt; a plot with mean monthly values of pecipitation in the upper panel (as bars from top to bottom) and streamflows in the lower panel (as bars from bottom to up). Quantiles of precipitation and streamflows are also plotted depending on the values defined in <code>p.probs</code> and <code>q.probs</code>, respectively.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_na.fill">na.fill</code></td>
<td>

<p>Character indicating how to fill any NA present in <code>x</code>. Valid values are: <br />
-) <kbd>remove</kbd> =&gt; NAs are not plotted
-) <kbd>linear</kbd> =&gt; NAs are removed by linear interpolation, using <code><a href="zoo.html#topic+na.approx">na.approx</a></code> <br /> 
-) <kbd>spline</kbd> =&gt; NAs are removed by spline interpolation, using <code><a href="zoo.html#topic+na.spline">na.spline</a></code>
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_from">from</code></td>
<td>

<p>Character indicating the starting date for subsetting <code>p</code> and <code>q</code>. The default value corresponds to the date of the first element of <code>p</code> <br />
It has to be in the format indicated by <code>date.fmt</code>. 
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_to">to</code></td>
<td>

<p>Character indicating the ending date for subsetting <code>p</code> and <code>q</code>. The default value corresponds to the date of the last element of <code>p</code> <br />
It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>from</code> and <code>to</code>, e.g. <kbd>%Y-%m-%d</kbd>. See &lsquo;Details&rsquo; section in <code><a href="base.html#topic+strptime">strptime</a></code>.
By default, <code>date.fmt</code> is missing, and it is automatically set to <kbd>%Y-%m-%d</kbd> when <code>time(x)</code> is <code>Date</code> object, and set to <kbd>%Y-%m-%d %H:%M:%S</kbd> when <code>x</code> is a sub-daily zoo object.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_tz">tz</code></td>
<td>

<p>character, with the specification of the time zone used for <code>from</code>, <code>to</code>. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> is UTC (Universal Time, Coordinated). See <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. <br />
</p>
<p>If <code>tz</code> is missing (the default), it is automatically set to the time zone used in <code>time(x)</code>. <br />
</p>
<p>This argument can be used when working with sub-daily zoo objects to force using  time zones other than the local time zone for <code>from</code> and <code>to</code>. It should be used with caution, being well aware of the time zone of the data. See examples.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_main">main</code></td>
<td>

<p>The main title (on top) of the figure.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_xlab">xlab</code></td>
<td>

<p>a title for the <code>x</code> axis. See <code><a href="graphics.html#topic+title">title</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_ylab">ylab</code></td>
<td>

<p>a two-element title for the <code>y</code> axis: see <code><a href="graphics.html#topic+title">title</a></code>. <br />
The first element is used for the right <code>y</code> axis (i.e., for precipitation). The second element is used for the left <code>y</code> axis (i.e., for streamflows).
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_p.col">p.col</code></td>
<td>

<p>character, representing the colors to be used for ploting the precipitation time series.  
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_q.col">q.col</code></td>
<td>

<p>character, representing the colors to be used for ploting the streamflow time series. 
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_leg.title">leg.title</code></td>
<td>

<p>a character string or length-one expression giving a title to be placed at the top of the legend. <code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_leg.text">leg.text</code></td>
<td>

<p>a two-element character to appear in the legend placed at the bottom of the figure. <br />
The first element is used for precipitation and the second element is used for streamflows.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_q.pch">q.pch</code></td>
<td>

<p>numeric, representing the symbols used for ploting the streamflow time series.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_q.cex">q.cex</code></td>
<td>

<p>a numerical vector giving the amount by which plotting characters and symbols should be scaled relative to the default. This works as a multiple of <code>par("cex")</code>. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_start.month">start.month</code></td>
<td>

<p>numeric in [1:12] indicating the starting month for the monthlycurve. Numeric values in [1, 12] represents months in [January, December]. By default <code>start.month=1</code>.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_plot.p.probs">plot.p.probs</code></td>
<td>

<p>logical used to decide whether to show lower an upper uncertainty values for each one of the 12 monthly precipitation values. By default <code>plot.p.probs=TRUE</code>. <br /> 
When <code>plot.p.probs=TRUE</code> the <code>p.probs</code> argument is used to define the values of the lower an upper uncertainty values.
</p>
</td></tr> 
<tr><td><code id="plot_pq_+3A_p.probs">p.probs</code></td>
<td>

<p>numeric of length 2. It defines the quantile values used to compute the lower an upper uncertainty values for each one of the 12 monthly precipitation values. This uncertainty values are drawn as vertical lines over the bars used to plot the 12 monthly precipitation values. <br /> 
By default <code>p.probs=c(0.25, 0.75)</code>, which indicates that the quantiles 0.25 and 0.75 are used to compute the lower an upper uncertainty bounds for each one of the 12 monthly precipitation values. 
If <code>p</code> is a (sub)daily zoo object, it is first aggregated into monthly values using <code>mean</code>, and then the <code>p.probs</code> quantiles are computed over all the monthly values belonging to a calendar month.
</p>
</td></tr> 
<tr><td><code id="plot_pq_+3A_p.alpha">p.alpha</code></td>
<td>

<p>numeric of length 1, with the factor used to modify the opacity of <code>p.col</code>. Typically in [0,1], with 0 indicating a completely transparent colour and 1 indicating no transparency.
</p>
</td></tr> 
<tr><td><code id="plot_pq_+3A_plot.q.probs">plot.q.probs</code></td>
<td>

<p>logical used to decide whether to show uncertainty bands around each one of the 12 monthly average or median streamflow values. By default <code>plot.q.probs=TRUE</code>. <br /> 
When <code>plot.q.probs=TRUE</code> the <code>q.probs</code> argument is used to define the values of the lower an upper uncertainty bands.
</p>
</td></tr> 
<tr><td><code id="plot_pq_+3A_q.probs">q.probs</code></td>
<td>

<p>numeric of length 2. It is used to define quantile values used to compute the lower an upper uncertainty bands around each one of the 12 monthly average or median streamflow. <br /> 
If <code>pcp</code> is provided, then <code>ubands.probs</code> are used to compute the lower an upper uncertainty bounds for each one of the 12 monthly average or median precipitation values. <br />
By default <code>ubands.probs=c(0.25, 0.75)</code>, which indicates that the quantiles 0.25 and 0.75 are used to compute the lower an upper uncertainty bounds for each one of the 12 monthly average or median values. 
If <code>x</code> is provided and is a (sub)daily zoo object, it is first aggregated into monthly values using <code>FUN</code>, and then the <code>ubands.probs</code> quantiles are computed over all the monthly values belonging to a calendar month.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_q.probs.col">q.probs.col</code></td>
<td>

<p>character with the color used to plot the uncertainty bands around the average or median streamflow values. <br />
</p>
</td></tr> 
<tr><td><code id="plot_pq_+3A_q.probs.alpha">q.probs.alpha</code></td>
<td>

<p>numeric of length 1, with the factor used to modify the opacity of <code>q.probs.col</code>. Typically in [0,1], with 0 indicating a completely transparent colour and 1 indicating no transparency.
</p>
</td></tr> 
<tr><td><code id="plot_pq_+3A_labels">labels</code></td>
<td>

<p>logical. Should monthly streamflow values to be shown above the lines?. By default <code>labels=TRUE</code>.
</p>
</td></tr> 
<tr><td><code id="plot_pq_+3A_labels.cex">labels.cex</code></td>
<td>

<p>numeric giving the amount by which plotting characters used to show the numeric values of monthly streamflow values are scaled relative to the default. 
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_labels.p.dy">labels.p.dy</code></td>
<td>

<p>numeric of length 12 giving the amount of vertical coordinate positions that have to be used to vertically shift the labels of monthly precipitation values. <br />
It is only used when <code>labels=TRUE</code>. <br />
Lengths smaller than 12 are recycled and larger lengths are not used.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_labels.q.dx">labels.q.dx</code></td>
<td>

<p>numeric of length 12 giving the amount of horizontal coordinate positions that have to be used to horizontally shift the labels of monthly streamflow values. <br />
It is only used when <code>labels=TRUE</code>. <br />
Lengths smaller than 12 are recycled and larger lengths are not used.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_labels.q.dy">labels.q.dy</code></td>
<td>

<p>numeric of length 12 giving the amount of vertical coordinate positions that have to be used to vertically shift the labels of monthly streamflow values. <br />
It is only used when <code>labels=TRUE</code>. <br />
Lengths smaller than 12 are recycled and larger lengths are not used.
</p>
</td></tr>
<tr><td><code id="plot_pq_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods. Not used yet.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a time series of precipitation and streamflow, this function plots the two time series in the same figure, streamflows as a normal time series and precipitation as bars comming from the upper part of the plotting window. 
</p>


<h3>Value</h3>

<p>A figure with the two time series in the same graphical area, streamflows as a normal time series and precipitation as bars comming from the upper part of the plotting window. 
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hydroplot">hydroplot</a></code>, <code><a href="#topic+climograph">climograph</a></code>, <code><a href="#topic+fdc">fdc</a></code>, <code><a href="#topic+fdcu">fdcu</a></code>, <code><a href="#topic+monthlyfunction">monthlyfunction</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################
## Ex1: Plotting precipitation and streamflows for the full time period of both
##      time series.
##      First, we load the daily P and Q time series for the Cauquenes en 
##      El Arrayan catchment. P, [mm] is the first column and Q, [mm] is the 
##      fifth column.

data(Cauquenes7336001)
p &lt;- Cauquenes7336001[, 1]
q &lt;- Cauquenes7336001[, 5]

## Plotting P and Q for the full time period of both time series
plot_pq(p=p, q=q)

######################
## Ex2: Plotting precipitation and streamflows only for a specific time period,
##      from April to December 2000.
plot_pq(p, q, from="2000-04-01", to="2000-12-31")

######################
## Ex3: Plotting monthly values of precipitation and streamflows for the 
##      full time period of both time series.
plot_pq(p, q, ptype="monthly")

######################
## Ex4: Plotting monthly values of precipitation and streamflows for the 
##      full time period of both time series, but using a hydrologic year
##      starting on April
plot_pq(p, q, ptype="monthly", start.month=4)
</code></pre>

<hr>
<h2 id='rm1stchar'>
Remove First Character(s) 
</h2><span id='topic+rm1stchar'></span>

<h3>Description</h3>

<p>Deletes the first <code>n</code> character(s) of a character object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rm1stchar(x, n = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rm1stchar_+3A_x">x</code></td>
<td>

<p>Character, e.g, each element may represent the name of a single gauging station.
</p>
</td></tr>
<tr><td><code id="rm1stchar_+3A_n">n</code></td>
<td>

<p>numeric, indicating the number of characters that have to be removed from the beginning of <code>x</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character object of the same length as <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+substr">substr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)

# Getting the name of each gauging station.
names &lt;- colnames(EbroPPtsMonthly)

# Removing the initial letter 'P' of the name of each gauging station.
rm1stchar(names)

</code></pre>

<hr>
<h2 id='SanMartinoPPts'>
San Martino, ts of daily precipitation.
</h2><span id='topic+SanMartinoPPts'></span>

<h3>Description</h3>

<p>Daily time series of precipitation, at station San Martino di Castrozza, Trento Province, Italy, with data from 01/Jan/1921 to 31/Dec/1990.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SanMartinoPPts)
</code></pre>


<h3>Format</h3>

<p>zoo object.
</p>


<h3>Source</h3>

<p>Provided by MeteoTrentino, Trento, Italy (via prof. Riccardo Rigon). <br />
These data are intended to be used for research purposes only, being distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY.
</p>

<hr>
<h2 id='seasonalfunction'>
Seasonal Function
</h2><span id='topic+seasonalfunction'></span><span id='topic+seasonalfunction.default'></span><span id='topic+seasonalfunction.zoo'></span><span id='topic+seasonalfunction.data.frame'></span><span id='topic+seasonalfunction.matrix'></span>

<h3>Description</h3>

<p>Generic function for applying any R function to a zoo object, in order to obtain 4 representative seasonal values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seasonalfunction(x, ...)

## Default S3 method:
seasonalfunction(x, FUN, na.rm = TRUE, type="default", ...)

## S3 method for class 'zoo'
seasonalfunction(x, FUN, na.rm = TRUE, type="default", ...)

## S3 method for class 'data.frame'
seasonalfunction(x, FUN, na.rm = TRUE, type="default",
                          dates=1, date.fmt = "%Y-%m-%d", 
                          out.type = "data.frame", verbose = TRUE, ...)
                          
## S3 method for class 'matrix'
seasonalfunction(x, FUN, na.rm = TRUE, type="default",
                          dates=1, date.fmt = "%Y-%m-%d", 
                          out.type = "data.frame", verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seasonalfunction_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with daily or monthly time series. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="seasonalfunction_+3A_fun">FUN</code></td>
<td>

<p>Function that will be applied to ALL the values in <code>x</code> belonging to each one of the 4 weather seasons (e.g., <code>FUN</code> can be some of <code>mean</code>, <code>max</code>, <code>min</code>, <code>sd</code>). <br />
</p>
</td></tr>
<tr><td><code id="seasonalfunction_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed before the computations? <br />
-) <kbd>TRUE</kbd> : the monthly values  are computed considering only those values in <code>x</code> different from NA  (<b>very important when <code>FUN=sum</code></b>) <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the FUN and monthly values are NA    
</p>
</td></tr>
<tr><td><code id="seasonalfunction_+3A_type">type</code></td>
<td>

<p>character, indicating which weather seasons will be used for computing the output. Possible values are: <br />
-) <kbd>default</kbd>          =&gt;  &quot;winter&quot;= Dec, Jan, Feb;      &quot;spring&quot;= Mar, Apr, May;  &quot;summer&quot;=Jun, Jul, Aug;       &quot;autumn&quot;= Sep, Oct, Nov  <br />
-) <kbd>FrenchPolynesia</kbd>  =&gt;  &quot;winter&quot;= Dec, Jan, Feb, Mar; &quot;spring&quot;= Apr, May;       &quot;summer&quot;=Jun, Jul, Aug, Sep;  &quot;autumn&quot;= Oct, Nov 
</p>
</td></tr>
<tr><td><code id="seasonalfunction_+3A_dates">dates</code></td>
<td>

<p>numeric, factor, Date indicating how to obtain the dates. <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into Date class, by using the date format specified by <code>date.fmt</code>  <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of element in <code>x</code>
</p>
</td></tr>
<tr><td><code id="seasonalfunction_+3A_date.fmt">date.fmt</code></td>
<td>

<p>Character indicating the format in which the dates are stored in <code>dates</code>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="seasonalfunction_+3A_out.type">out.type</code></td>
<td>

<p>Character defining the desired type of output. Valid values are: <br />
-) <kbd>data.frame</kbd>: a data.frame, with 4 columns representing the weather seasons, and as many rows as stations are included in <code>x</code> <br />
-) <kbd>db</kbd>        : a data.frame, with 4 colums will be produced. Useful for a posterior boxplot <br />
The first column (StationID) will store the ID of the station,  <br />
The second column (Year) will store the year,              <br />
The third column (Season) will store the season,  <br />
The fourth column (Value) will contain the seasonal value corresponding to that year and that station.
</p>
</td></tr>
<tr><td><code id="seasonalfunction_+3A_verbose">verbose</code></td>
<td>

<p>Logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="seasonalfunction_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods
</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>The <var>FUN</var> value for the winter season (DJF) is computed considering the consecutive months of December, January and February. Therefore, if <code>x</code> starts in January and ends in December of any year, the winter value of the first year is computed considering only the January and February value of that year, whereas the December value of the first year is used to compute the winter value of the next year.
</p>


<h3>Note</h3>

<p><code>FUN</code> is applied to all the values of <code>x</code> belonging to each one of the four weather seasons, so the results of this function depends on the frequency sampling of <code>x</code> and the type of function given by <code>FUN</code> <br />
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dm2seasonal">dm2seasonal</a></code>, <code><a href="#topic+time2season">time2season</a></code>, <code><a href="#topic+monthlyfunction">monthlyfunction</a></code>, <code><a href="#topic+annualfunction">annualfunction</a></code>, <code><a href="#topic+extract">extract</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the SanMartino precipitation data
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

# Amount of years
nyears &lt;- yip(from=start(x), to=end(x), out.type="nmbr")

## Mean annual precipitation.
# It is necessary to divide by the amount of years to obtain the mean annual value, 
# otherwise it will give the total precipitation for all the 70 years
seasonalfunction(x, FUN=sum, na.rm=TRUE) / nyears

#####################
### verification ####
# Mean winter (DJF) value
sum( extractzoo(x, trgt="DJF") ) / nyears

# Mean spring (MAM) value
sum( extractzoo(x, trgt="MAM") ) / nyears

# Mean summer (JJA) value
sum( extractzoo(x, trgt="JJA") ) / nyears

# Mean autumn (SON) value
sum( extractzoo(x, trgt="SON") ) / nyears



</code></pre>

<hr>
<h2 id='sfreq'>
Sampling Frequency 
</h2><span id='topic+sfreq'></span>

<h3>Description</h3>

<p>This function identifies the sampling frequency of a zoo object. It is wrapper to the <code><a href="xts.html#topic+periodicity">periodicity</a></code> function of the <span class="pkg">xts</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sfreq(x, min.year = 1800)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sfreq_+3A_x">x</code></td>
<td>

<p>variable of type zoo, xts or ts, with AT LEAST 2 elements, AND with a (sub)hourly, hourly, daily, weekly, monthly, quarterly, or annual (yearly) sampling frequency.
</p>
</td></tr>
<tr><td><code id="sfreq_+3A_min.year">min.year</code></td>
<td>

<p>integer used for a correct identification of the sampling frequency when <code>x</code> is an annual (yearly) time series.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See further details in the <code><a href="xts.html#topic+periodicity">periodicity</a></code> function of the <span class="pkg">xts</span> package.
</p>


<h3>Value</h3>

<p>Character. Possible values are: <br />
-) <kbd>minute</kbd>    : indicating that the sampling frequency in <code>x</code> is sub-hourly <br />
-) <kbd>hourly</kbd>    : indicating that the sampling frequency in <code>x</code> is hourly     <br />
-) <kbd>daily</kbd>     : indicating that the sampling frequency in <code>x</code> is daily      <br />
-) <kbd>weekly</kbd>    : indicating that the sampling frequency in <code>x</code> is weekly     <br />
-) <kbd>monthly</kbd>   : indicating that the sampling frequency in <code>x</code> is monthly    <br />
-) <kbd>quarterly</kbd> : indicating that the sampling frequency in <code>x</code> is quarterly  <br />
-) <kbd>annual</kbd>    : indicating that the sampling frequency in <code>x</code> is annual 
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+frequency">frequency</a></code>, <a href="xts.html#topic+periodicity">periodicity</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Ex1: sub-hourly data
## Creating a dummy 15-min zoo object, with 1 as the only value in each time period
dt  &lt;- seq( from=as.POSIXct("2021-06-30 00:15"), to=as.POSIXct("2021-06-30 23:45"), by="15 min" )
ndt &lt;- length(dt)
shr &lt;- zoo( rep(1, ndt), dt)
sfreq(shr)


## Ex2: hourly data 
## Loading the time series of HOURLY streamflows for the station Karamea at Gorge
data(KarameaAtGorgeQts)
hr &lt;- KarameaAtGorgeQts
sfreq(hr)


## Ex3: Daily data
## Loading daily streamflows at the station Oca en Ona (Ebro River basin, Spain)
data(OcaEnOnaQts)
d &lt;- OcaEnOnaQts
sfreq(d)


## Ex4: Monthly data
m &lt;- daily2monthly(d, FUN=mean, na.rm=TRUE)
sfreq(m)


## Ex5: Annual data
a &lt;- daily2annual(d, FUN=mean, na.rm=TRUE)
sfreq(a)


</code></pre>

<hr>
<h2 id='si'>
Seasonality Index
</h2><span id='topic+si'></span>

<h3>Description</h3>

<p>Function to compute the seasonality index defined by Walsh and Lawler (1981) to classify the precipitation regime.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  si(x, na.rm=TRUE, from=start(x), to=end(x), date.fmt="%Y-%m-%d", start.month=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="si_+3A_x">x</code></td>
<td>

<p>zoo object with daily or subdaily precipitation data.
</p>
</td></tr>
<tr><td><code id="si_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the monthly values  are computed considering only those values different from NA <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the resulting average monthly value is NA .
</p>
</td></tr>
<tr><td><code id="si_+3A_from">from</code></td>
<td>

<p>OPTIONAL, used for extracting a subset of values. <br />
Character indicating the starting date for the values to be extracted. It must be provided in the format specified by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="si_+3A_to">to</code></td>
<td>

<p>OPTIONAL, used for extracting a subset of values. <br />
Character indicating the ending date for the values to be extracted. It must be provided in the format specified by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="si_+3A_date.fmt">date.fmt</code></td>
<td>

<p>Character indicating the format in which the dates are stored in <var>dates</var>, <var>from</var> and <var>to</var>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="si_+3A_start.month">start.month</code></td>
<td>

<p>[OPTIONAL]. Only used when the (hydrological) year of interest is different from the calendar year.
</p>
<p>numeric in [1:12] indicating the starting month of the (hydrological) year. Numeric values in [1, 12] represents months in [January, December]. By default <code>start.month=1</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The seasonality index is computed as following:<br />
</p>
<p>si = (1/R) *sum(i=1, i=12, abs(xi - R/12) ) <br />            
where: <br />                                                   
-) xi: mean monthly precipitation for month i <br />
-) R: mean annual precipitation               <br />             
</p>
<p>This index can theoretically vary from 0 (when all months have the same rainfall) to 1.83 (when all the rainfall ocurrs in a single month).
A qualitative classification of degrees of seasonality is the following: <br />
&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; <br />
si values   |                    Rainfall regime        <br />                    
&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; <br />
&lt;= 0.19 | Very equable                              <br />                    
0.20 - 0.39  | Equable but with a definite wetter season <br />                    
0.40 - 0.59  | Rather seasonal with a short drier season <br />                    
0.60 - 0.79  | Seasonal                                  <br />                    
0.80 - 0.99  | Markedly seasonal with a long drier season<br />                    
1.00 - 1.19  | Most rain in 3 months or less             <br />                                  
&gt;= 1.20  | Extreme, almost all rain in 1-2 months                        
</p>


<h3>Value</h3>

<p>numeric with the seasonality index
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>References</h3>

<p><cite>Walsh, R. and Lawler, D. (1981). Rainfall seasonality: Description, spatial patterns and change through time (British Isles, Africa). Weather, 36(7), 201-208. doi:10.1002/j.1477-8696.1981.tb05400.x</cite>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subdaily2daily">subdaily2daily</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
############################
## Ex 1: Seasonality index for a rain gauge with equable precipitation , 
##       but with a definite wetter season 

## Loading daily precipitation data at the station San Martino di Castrozza, 
## Trento Province, Italy, from 01/Jan/1921 to 31/Dec/1990.
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

## Amount of years in 'x' (needed for computations)
( nyears &lt;- yip(from=start(x), to=end(x), out.type="nmbr" ) )


## Boxplot of monthly values, to look at the seasonal cycle

## Daily to Monthly
m &lt;- daily2monthly(x, FUN=sum, na.rm=TRUE)

## Mean monthly values at the station
monthlyfunction(m, FUN=sum, na.rm=TRUE) / nyears

## Vector with the three-letter abbreviations of the month names
cmonth &lt;- format(time(m), "%b")

## Creating ordered monthly factors
months &lt;- factor(cmonth, levels=unique(cmonth), ordered=TRUE)

## Boxplot of the monthly values of precipitation
boxplot( coredata(m) ~ months, col="lightblue", 
         main="Monthly precipitation, [mm]", ylab="P, [mm]")

# computing seasonality index
( si(x) )

############################
## Ex 2: Seasonality index for a rain gauge with markedly seasonal regime 
##       with a long dry season

## Loading daily precipitation data at the station Cauquenes en El Arrayan, 
## Maule Region, Chile, from 01/Jan/1979 to 31/Dec/2020.
data(Cauquenes7336001)
x &lt;- Cauquenes7336001[, 1] # P is the first column

## Boxplot of monthly values, to look at the seasonal cycle

## Daily to Monthly
m &lt;- daily2monthly(x, FUN=sum, na.rm=TRUE)

## Mean monthly values at the station
monthlyfunction(m, FUN=sum, na.rm=TRUE) / nyears

## Vector with the three-letter abbreviations of the month names
cmonth &lt;- format(time(m), "%b")

## Creating ordered monthly factors
months &lt;- factor(cmonth, levels=unique(cmonth), ordered=TRUE)

## Boxplot of the monthly values of precipitation
boxplot( coredata(m) ~ months, col="lightblue", 
         main="Monthly precipitation, [mm]", ylab="P, [mm]")

# computing seasonality index
( si(x) )
</code></pre>

<hr>
<h2 id='smry'>
Summary
</h2><span id='topic+smry'></span><span id='topic+smry.default'></span><span id='topic+smry.zoo'></span><span id='topic+smry.Date'></span><span id='topic+smry.matrix'></span><span id='topic+smry.data.frame'></span>

<h3>Description</h3>

<p>Extended summary function for numeric objects, with 13 summary statistics. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smry(x, ...)

## Default S3 method:
smry(x, na.rm=TRUE, digits = max(3, getOption("digits")-3), ...)

## S3 method for class 'zoo'
smry(x, na.rm=TRUE, digits = max(3, getOption("digits")-3), ...)

## S3 method for class 'Date'
smry(x, na.rm=TRUE, digits = max(3, getOption("digits")-3), ...)

## S3 method for class 'matrix'
smry(x, na.rm=TRUE, digits = max(3, getOption("digits")-3), ...)

## S3 method for class 'data.frame'
smry(x, na.rm=TRUE, digits = max(3, getOption("digits")-3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smry_+3A_x">x</code></td>
<td>

<p>a numeric object, vector, matrix or data.frame, for which a summary is desired.
</p>
</td></tr>
<tr><td><code id="smry_+3A_na.rm">na.rm</code></td>
<td>

<p>a logical value indicating whether 'NA' values should be stripped before the computation proceeds.
</p>
</td></tr>
<tr><td><code id="smry_+3A_digits">digits</code></td>
<td>

<p>numeric, with the amount of decimal places to be included in the result
</p>
</td></tr>
<tr><td><code id="smry_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Computed summary statistics are: <br />
</p>
<table>
<tr><td><code>Min</code></td>
<td>
<p>Minimum</p>
</td></tr>
<tr><td><code>1stQ</code></td>
<td>
<p>First quartile (lower-hinge)</p>
</td></tr>
<tr><td><code>Mean</code></td>
<td>
<p>Mean value</p>
</td></tr>
<tr><td><code>Median</code></td>
<td>
<p>Median</p>
</td></tr>
<tr><td><code>3rdQ</code></td>
<td>
<p>Third quartile ( upper-hinge</p>
</td></tr>
<tr><td><code>Max</code></td>
<td>
<p>Maximum of the input values.</p>
</td></tr>
<tr><td><code>IQR</code></td>
<td>
<p>Interquartile Range. <code>IQR(x) = quantile(x,3/4) - quantile(x,1/4)</code></p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>Standard deviation. It uses 'n-1' as denominator.</p>
</td></tr>
<tr><td><code>cv</code></td>
<td>
<p>Coefficient of variation ( <code>cv= sd / |mean|</code> )</p>
</td></tr>
<tr><td><code>skewness</code></td>
<td>
<p>Skewness (using <span class="pkg">e1071</span> package)   </p>
</td></tr>
<tr><td><code>kurtosis</code></td>
<td>
<p>Kurtosis (using <span class="pkg">e1071</span> package)   </p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Total number of elements</p>
</td></tr>
<tr><td><code>NA's</code></td>
<td>
<p>Amount of missing values</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Skewness and Kurtosis are computed with the e1071 package
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code>, <code><a href="stats.html#topic+fivenum">fivenum</a></code>, <code><a href="stats.html#topic+IQR">IQR</a></code>, <code><a href="stats.html#topic+sd">sd</a></code>, <a href="e1071.html#topic+skewness">skewness</a>, <a href="e1071.html#topic+kurtosis">kurtosis</a> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)

## Summary of monthly precipitation values for the first 7 stations in 'EbroPPtsMonthly'
smry(EbroPPtsMonthly[,2:8])
</code></pre>

<hr>
<h2 id='sname2ts'>
Station Name -&gt; Time Series
</h2><span id='topic+sname2ts'></span>

<h3>Description</h3>

<p>This function takes a data.frame whose columns contains the time series of several gauging stations, along with a character representing the name of one gauging station, and extracts the time series corresponding to that station.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sname2ts(x, sname, dates=1, date.fmt = "%Y-%m-%d", var.type, 
         tstep.out = "daily", FUN, na.rm = TRUE, from, to)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sname2ts_+3A_x">x</code></td>
<td>

<p>data.frame containing the complete times series of all the stations. <br />
It may also contain 1 column with the dates of the measurements, or they can be provided in a different way (see <code>dates</code> below).
</p>
</td></tr>
<tr><td><code id="sname2ts_+3A_sname">sname</code></td>
<td>

<p>Character representing the name of a station, which have to correspond to one column name in <code>x</code>
</p>
</td></tr>
<tr><td><code id="sname2ts_+3A_dates">dates</code></td>
<td>

<p>numeric, factor, Date object indicating how to obtain the dates corresponding to the <code>sname</code> station. <br />
-) If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br />
-) If <code>dates</code> is a factor, it is converted into Date class, using the date format specified by <code>date.fmt</code> <br />
-) If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of element in <code>x</code>
</p>
</td></tr>
<tr><td><code id="sname2ts_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="sname2ts_+3A_var.type">var.type</code></td>
<td>

<p>character representing the type of variable being plotted. Used for determining the function used for computing the monthly or/and annual values when <code>FUN</code> is missing. Valid values are: <br />
-) <kbd>Precipitation</kbd> =&gt; <code>FUN=sum</code>  <br />
-) <kbd>Temperature</kbd>   =&gt; <code>FUN= mean</code> <br />
-) <kbd>Flow</kbd>          =&gt; <code>FUN= mean</code>
</p>
</td></tr>
<tr><td><code id="sname2ts_+3A_tstep.out">tstep.out</code></td>
<td>

<p>character that defines the time step of the desired output time series. Valid values are: <br />
-) <kbd>daily</kbd>  : daily time series   <br />
-) <kbd>monthly</kbd>: monthly time series <br />
-) <kbd>annual</kbd> : annual time series 
</p>
</td></tr>
<tr><td><code id="sname2ts_+3A_fun">FUN</code></td>
<td>

<p>ONLY required when <code>var.type</code> is missing and <code>tstep</code> is one of <code>monthly</code> or <code>annual</code>. <br />
Function that have to be applied for transforming from daily to monthly or annual time step (e.g., for precipitation <code>FUN=sum</code> and for temperature and flow ts, <code>FUN=mean</code>) 
</p>
</td></tr>
<tr><td><code id="sname2ts_+3A_na.rm">na.rm</code></td>
<td>

<p>a logical value indicating whether 'NA' values should be stripped before the computation proceeds.
</p>
</td></tr>
<tr><td><code id="sname2ts_+3A_from">from</code></td>
<td>

<p>OPTIONAL, used for extracting a subset of values. <br />
Character indicating the starting date for the values to be extracted. It must be provided in the format specified by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="sname2ts_+3A_to">to</code></td>
<td>

<p>OPTIONAL, used for extracting a subset of values. <br />
Character indicating the ending date for the values to be extracted. It must be provided in the format specified by <code>date.fmt</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>zoo object
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sname2plot">sname2plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)

## Annual values of temperature at the station "T9105", stored in 'EbroPPtsMonthly'.
sname2ts(EbroPPtsMonthly, sname="P9001", dates=1, FUN=sum, tstep.out="annual")
</code></pre>

<hr>
<h2 id='stdx'>
Standarization
</h2><span id='topic+stdx'></span><span id='topic+stdx.default'></span><span id='topic+stdx.matrix'></span><span id='topic+stdx.data.frame'></span>

<h3>Description</h3>

<p>Standarizes a vector or matrix, i.e., scales all the values in a way that the transformed values will be within the range [0, 1]. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdx(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stdx_+3A_x">x</code></td>
<td>

<p>vector, matrix or data.frame to be scaled
</p>
</td></tr>
<tr><td><code id="stdx_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods
</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">z = \frac{x - x_{min}}{x_{max}-x_{min}}</code>
</p>



<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+scale">scale</a></code>, <code><a href="#topic+istdx">istdx</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Loading the monthly time series of precipitation within the Ebro River basin.
data(EbroPPtsMonthly)

# Standarizing only some values of 'EbroPPtsMonthly'
stdx(as.matrix(EbroPPtsMonthly[1:70,10:13]))
</code></pre>

<hr>
<h2 id='subdaily2daily'>
Sub-daily -&gt; Daily
</h2><span id='topic+subdaily2daily'></span><span id='topic+subdaily2daily.default'></span><span id='topic+subdaily2daily.zoo'></span><span id='topic+subdaily2daily.data.frame'></span><span id='topic+subdaily2daily.matrix'></span>

<h3>Description</h3>

<p>Generic function for transforming a Sub-DAILY time series into a DAILY one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subdaily2daily(x, ...)

## Default S3 method:
subdaily2daily(x, FUN, na.rm = TRUE, na.rm.max=0,
                       start="00:00:00", start.fmt= "%H:%M:%S", tz, ...)

## S3 method for class 'zoo'
subdaily2daily(x, FUN, na.rm = TRUE, na.rm.max=0,
                       start="00:00:00", start.fmt= "%H:%M:%S", tz, ...)

## S3 method for class 'data.frame'
subdaily2daily(x, FUN, na.rm = TRUE, na.rm.max=0,
           start="00:00:00", start.fmt= "%H:%M:%S", tz,
           dates=1, date.fmt="%Y-%m-%d %H:%M:%S", out.fmt="zoo", 
           verbose= TRUE, ...)

## S3 method for class 'matrix'
subdaily2daily(x, FUN, na.rm = TRUE, na.rm.max=0,
           start="00:00:00", start.fmt= "%H:%M:%S", tz,
           dates=1, date.fmt="%Y-%m-%d %H:%M:%S", out.fmt="zoo", 
           verbose= TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subdaily2daily_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with sub-daily time series. <br />
Measurements at several gauging stations can be stored in a data.frame or matrix object, and in that case, each column of <code>x</code> represents the time series measured in each gauging station, and the column names of <code>x</code> should correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_fun">FUN</code></td>
<td>

<p>Function that have to be applied for aggregating from sub-daily into daily time step (e.g., for precipitation <code>FUN=sum</code> and for temperature and streamflows ts <code>FUN=mean</code>). <br />
</p>
<p><code>FUN</code> MUST accept the <code>na.rm</code> argument, because <code>na.rm</code> is passed to <code>FUN</code>.
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the daily values are computed only for days with a percentage of missing values less than <code>na.rm.max</code> <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a day, the corresponing daily value in the output object will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_na.rm.max">na.rm.max</code></td>
<td>

<p>Numeric in [0, 1]. It is used to define the maximum percentage of missing values allowed in each day to keep the daily aggregated value in the output object of this function. In other words, if the percentage of missing values in a given day is larger or equal than <code>na.rm.max</code> the corresponding daily value will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_start">start</code></td>
<td>

<p>character, indicating the starting time used for aggregating sub-daily time series into daily ones. It MUST be provided in the format specified by <code>start.fmt</code>. <br />
This value is used to define the time when a new day begins (e.g., for some rain gauge stations). <br />
-) All the values of <code>x</code> with a time attribute before <code>start</code> are considered as belonging to the day before the one indicated in the time attribute of those values. <br />
-) All the values of <code>x</code> with a time attribute equal to <code>start</code> are considered to be equal to <code>"00:00:00"</code> in the output zoo object. <br />
-) All the values of <code>x</code> with a time attribute after <code>start</code> are considered as belonging to the same day as the one indicated in the time attribute of those values. <br />
</p>
<p>It is useful when the daily values start at a time different from <code>"00:00:00"</code>. Use with caution. See examples.
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_start.fmt">start.fmt</code></td>
<td>

<p>character indicating the format in which the time is provided in <code>start</code>, By default <code>date.fmt=%H:%M:%S</code>. See <code>format</code> in <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>.
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_tz">tz</code></td>
<td>

<p>character, with the specification of the time zone used in both <code>x</code> and <code>start</code>. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> is UTC (Universal Time, Coordinated). See <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. <br />
If <code>tz</code> is missing (the default), it is automatically set to the time zone used in <code>time(x)</code>. <br />
This argument can be used to force using the local time zone or any other time zone instead of UTC as time zone.
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_dates">dates</code></td>
<td>

<p>numeric, factor, POSIXct or POSIXt object indicating how to obtain the dates and times for each column of <code>x</code> (e.g., gauging station) <br />
If <code>dates</code> is a number, it indicates the index of the column in <code>x</code> that stores the date and times <br />
If <code>dates</code> is a factor, it is converted into POSIXct class, using the date format specified by <code>date.fmt</code>  <br />
If <code>dates</code> is already of POSIXct or POSIXt class, the code verifies that the number of elements on it be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>dates</code>, By default <code>date.fmt=%Y-%m-%d %H:%M:%S</code>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_out.fmt">out.fmt</code></td>
<td>

<p>OPTIONAL. Only used when <code>x</code> is a matrix or data.frame object /cr
character, for selecting if the result will be a matrix/data.frame or a zoo object. Valid values are: <kbd>numeric</kbd>, <kbd>zoo</kbd> (default)
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="subdaily2daily_+3A_...">...</code></td>
<td>

<p>arguments additional to <code>na.rm</code> passed to <code>FUN</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a zoo object with daily time series
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subhourly2hourly">subhourly2hourly</a></code>, <code><a href="#topic+subdaily2monthly">subdaily2monthly</a></code>, 
<code><a href="#topic+subdaily2annual">subdaily2annual</a></code>, <code><a href="#topic+subdaily2seasonal">subdaily2seasonal</a></code>, 
<code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>, <code><a href="#topic+dm2seasonal">dm2seasonal</a></code>, <code><a href="#topic+monthlyfunction">monthlyfunction</a></code>, 
<code><a href="#topic+seasonalfunction">seasonalfunction</a></code>, <code><a href="#topic+hydroplot">hydroplot</a></code>, 
<code><a href="#topic+vector2zoo">vector2zoo</a></code>, <code><a href="#topic+izoo2rzoo">izoo2rzoo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Ex1: Computation of daily values, removing any missing value in 'x'

## Loading the time series of hourly streamflows for the station Karamea at Gorge
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

# Plotting the hourly streamflow values
plot(x)

# Subsetting 'x' to its first three days (01/Jan/1980 - 03/Jan/1980)
x &lt;- window(x, end="1980-01-03 23:59:00")

## Transforming into NA the 10% of values in 'x'
set.seed(10) # for reproducible results
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

## Agreggating from Sub-Daily to Daily, removing any missing value in 'x'
( d1 &lt;- subdaily2daily(x, FUN=mean, na.rm=TRUE) )


## Ex2: Computation of daily values, removing any missing value in 'x' and
##      considering that the new day starts at 08:00:00 local time
( d2 &lt;- subdaily2daily(x, FUN=mean, na.rm=TRUE, start="08:00:00") )

## Ex3: Computation of daily values, removing any missing value in 'x' and
##      considering that the new day starts at 08:00:00, and forcing 
#       UTC both for 'x' and 'start'
( d3 &lt;- subdaily2daily(x, FUN=mean, na.rm=TRUE, start="08:00:00", tz="UTC") )

######################
## Ex4: Compuation of daily values only when the percentage of NAs in each
#       day is lower than a user-defined percentage (10% in this example).
( d4 &lt;- subdaily2daily(x, FUN=mean, na.rm=TRUE, na.rm.max=0.1) )
</code></pre>

<hr>
<h2 id='subdaily2weekly'>
Subdaily -&gt; Weekly
</h2><span id='topic+subdaily2weekly'></span><span id='topic+subdaily2weekly.default'></span><span id='topic+subdaily2weekly.zoo'></span><span id='topic+subdaily2weekly.data.frame'></span><span id='topic+subdaily2weekly.matrix'></span>

<h3>Description</h3>

<p>Generic function for transforming a DAILY (or sub-daily) regular time series into a WEEKLY one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subdaily2weekly(x, ...)

## Default S3 method:
subdaily2weekly(x, FUN, na.rm=TRUE, na.rm.max=0,
           start="00:00:00", start.fmt= "%H:%M:%S", tz, ...)

## S3 method for class 'zoo'
subdaily2weekly(x, FUN, na.rm=TRUE, na.rm.max=0,
           start="00:00:00", start.fmt= "%H:%M:%S", tz, ...)

## S3 method for class 'data.frame'
subdaily2weekly(x, FUN, na.rm=TRUE, na.rm.max=0,
           start="00:00:00", start.fmt= "%H:%M:%S", tz,
           dates=1, date.fmt = "%Y-%m-%d %H:%M:%S",  
           out.fmt="zoo", verbose=TRUE, ...)

## S3 method for class 'matrix'
subdaily2weekly(x, FUN, na.rm=TRUE, na.rm.max=0,
           start="00:00:00", start.fmt= "%H:%M:%S", tz,
           dates=1, date.fmt = "%Y-%m-%d %H:%M:%S",  
           out.fmt="zoo", verbose=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subdaily2weekly_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with (sub)daily time series. <br />
Measurements at several gauging stations can be stored in a data.frame or matrix object, and in that case, each column of <code>x</code> represents the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_fun">FUN</code></td>
<td>

<p>Function that have to be applied for transforming from daily to weekly time step (e.g., for precipitation <code>FUN=sum</code> and for temperature and streamflow ts <code>FUN=mean</code>). <br />
</p>
<p><code>FUN</code> MUST accept the <code>na.rm</code> argument, because <code>na.rm</code> is passed to <code>FUN</code>.
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the weekly values are computed only for weeks with a percentage of missing values less than <code>na.rm.max</code> <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the corresponing weekly values in the output object will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_na.rm.max">na.rm.max</code></td>
<td>

<p>Numeric in [0, 1]. It is used to define the maximum percentage of missing values allowed in each month to keep the weekly aggregated value in the output object of this function. In other words, if the percentage of missing values in a given month is larger or equal than <code>na.rm.max</code> the corresponding weekly value will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_start">start</code></td>
<td>

<p>character, indicating the starting time used for aggregating sub-daily time series into daily ones. It MUST be provided in the format specified by <code>start.fmt</code>. <br />
This value is used to define the time when a new day begins (e.g., for some rain gauge stations). <br />
-) All the values of <code>x</code> with a time attribute before <code>start</code> are considered as belonging to the day before the one indicated in the time attribute of those values. <br />
-) All the values of <code>x</code> with a time attribute equal to <code>start</code> are considered to be equal to <code>"00:00:00"</code> in the output zoo object. <br />
-) All the values of <code>x</code> with a time attribute after <code>start</code> are considered as belonging to the same day as the one indicated in the time attribute of those values. <br />
</p>
<p>It is useful when the daily values start at a time different from <code>"00:00:00"</code>. Use with caution. See examples.
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_start.fmt">start.fmt</code></td>
<td>

<p>character indicating the format in which the time is provided in <code>start</code>, By default <code>date.fmt=%H:%M:%S</code>. See <code>format</code> in <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>.
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_tz">tz</code></td>
<td>

<p>character, with the specification of the time zone used in both <code>x</code> and <code>start</code>. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> is UTC (Universal Time, Coordinated). See <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. <br />
If <code>tz</code> is missing (the default), it is automatically set to the time zone used in <code>time(x)</code>. <br />
This argument can be used to force using the local time zone or any other time zone instead of UTC as time zone.
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_dates">dates</code></td>
<td>

<p>numeric, factor or Date object indicating how to obtain the dates for each gauging station <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <var>x</var> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into Date class, using the date format specified by <code>date.fmt</code>  <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days on it be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the DateTime objects are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d %H:%M:%S</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_out.fmt">out.fmt</code></td>
<td>

<p>OPTIONAL. Only used when <code>x</code> is a matrix or data.frame object /cr
character, for selecting if the result will be a matrix/data.frame or a zoo object. Valid values are: <kbd>numeric</kbd>, <kbd>zoo</kbd>.
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="subdaily2weekly_+3A_...">...</code></td>
<td>

<p>arguments additional to <code>na.rm</code> passed to <code>FUN</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a zoo object with weekly time frequency
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cmv">cmv</a></code>, <code><a href="#topic+subhourly2hourly">subhourly2hourly</a></code>, <code><a href="#topic+daily2monthly">daily2monthly</a></code>, <code><a href="#topic+daily2annual">daily2annual</a></code>, <code><a href="#topic+subdaily2daily">subdaily2daily</a></code>, <code><a href="#topic+weeklyfunction">weeklyfunction</a></code>, <code><a href="#topic+hydroplot">hydroplot</a></code>, <code><a href="#topic+vector2zoo">vector2zoo</a></code>, <code><a href="#topic+izoo2rzoo">izoo2rzoo</a></code>, <code><a href="base.html#topic+as.Date">as.Date</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################
## Ex1: Computation of WEEKLY values from HOURLY ts, removing any missing value in 'x'

## Loading the HOURLY streamflows for the station Karamea at Gorge
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

# Sub-daily to weekly ts
subdaily2weekly(x, FUN=mean, na.rm=TRUE)

## Not run: 
######################
## Ex2: Computation of WEEKLY values from HOURLY ts, only when the percentage of NAs in 
#       each week is lower than a user-defined percentage (10

## Loading the HOURLY streamflows for the station Karamea at Gorge
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

# Subsetting 'x' to its first three weeks 
# (Monday 2nd December 1985 - Sunday 29th uanuary 20th 1980)
x &lt;- window(x, end="1985-12-31 23:59:00")

## Transforming into NA the 10
set.seed(10) # for reproducible results
n           &lt;- length(x)
n.nas       &lt;- round(0.1*n, 0)
na.index    &lt;- sample(1:n, n.nas)
x[na.index] &lt;- NA

## Daily to Weekly, only for weeks with less than 10
( w2 &lt;- subdaily2weekly(x, FUN=sum, na.rm=TRUE, na.rm.max=0.1) )

# Verifying that the second and third month of 'x' had 10
cmv(x, tscale="weekly")

######################
## Ex3: Computation of WEEKLY values from HOURLY ts, removing any missing value in 'x'
#       Loading the HOURLY streamflows for the station Karamea at Gorge
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

# Sub-daily to weekly ts
subdaily2weekly(x, FUN=mean, na.rm=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='subhourly2hourly'>
Sub-hourly -&gt; Hourly
</h2><span id='topic+subhourly2hourly'></span><span id='topic+subhourly2hourly.default'></span><span id='topic+subhourly2hourly.zoo'></span><span id='topic+subhourly2hourly.data.frame'></span><span id='topic+subhourly2hourly.matrix'></span>

<h3>Description</h3>

<p>Generic function for transforming a sub-HOURLY time series into an HOURLY one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subhourly2hourly(x, ...)

## Default S3 method:
subhourly2hourly(x, FUN, na.rm=TRUE, na.rm.max=0, ...)

## S3 method for class 'zoo'
subhourly2hourly(x, FUN, na.rm=TRUE, na.rm.max=0, ...)

## S3 method for class 'data.frame'
subhourly2hourly(x, FUN, na.rm=TRUE, na.rm.max=0,
           dates=1, date.fmt="%Y-%m-%d %H:%M:%S", out.fmt="zoo", 
           verbose= TRUE, ...)

## S3 method for class 'matrix'
subhourly2hourly(x, FUN, na.rm=TRUE, na.rm.max=0,
           dates=1, date.fmt="%Y-%m-%d %H:%M:%S", out.fmt="zoo", 
           verbose= TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subhourly2hourly_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with sub-hourly time series. <br />
Measurements at several gauging stations can be stored in a data.frame or matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> represent the ID of each station.
</p>
</td></tr>
<tr><td><code id="subhourly2hourly_+3A_fun">FUN</code></td>
<td>

<p>Function that have to be applied for transforming from sub-hourly to hourly time step. (e.g., for precipitation <code>FUN=sum</code> and for temperature and streamflow ts, <code>FUN=mean</code>). <br />
</p>
</td></tr>
<tr><td><code id="subhourly2hourly_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the hourly values  are computed considering only those values different from NA <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA sub-hourly value within a day, the corresponding hourly value(s) will be NA as well
</p>
</td></tr>
<tr><td><code id="subhourly2hourly_+3A_na.rm.max">na.rm.max</code></td>
<td>

<p>Numeric in [0, 1]. It is used to define the maximum percentage of missing values allowed in each hour to keep the hourly aggregated value in the output object of this function. In other words, if the percentage of missing values in a given hour is larger or equal than <code>na.rm.max</code> the corresponding hourly value will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="subhourly2hourly_+3A_dates">dates</code></td>
<td>

<p>numeric, factor, POSIXct or POSIXt object indicating how to obtain the dates and times for each column of <code>x</code> (e.g., gauging station) <br />
If <code>dates</code> is a number, it indicates the index of the column in <code>x</code> that stores the date and times <br />
If <code>dates</code> is a factor, it is converted into POSIXct class, using the date format specified by <code>date.fmt</code>  <br />
If <code>dates</code> is already of POSIXct or POSIXt class, the code verifies that the number of elements on it be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="subhourly2hourly_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>dates</code>, By default <code>date.fmt=%Y-%m-%d %H:%M:%S</code>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="subhourly2hourly_+3A_out.fmt">out.fmt</code></td>
<td>

<p>OPTIONAL. Only used when <code>x</code> is a matrix or data.frame object /cr
character, for selecting if the result will be a matrix/data.frame or a zoo object. Valid values are: <kbd>numeric</kbd>, <kbd>zoo</kbd> (default)
</p>
</td></tr>
<tr><td><code id="subhourly2hourly_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="subhourly2hourly_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a zoo object with hourly time series
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subhourly2nminutes">subhourly2nminutes</a></code>,, <code><a href="#topic+subdaily2daily">subdaily2daily</a></code>, <code><a href="#topic+subdaily2monthly">subdaily2monthly</a></code>, <code><a href="#topic+subdaily2annual">subdaily2annual</a></code>, <code><a href="#topic+subdaily2seasonal">subdaily2seasonal</a></code>, <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>, <code><a href="#topic+dm2seasonal">dm2seasonal</a></code>, <code><a href="#topic+monthlyfunction">monthlyfunction</a></code>, <code><a href="#topic+seasonalfunction">seasonalfunction</a></code>, <code><a href="#topic+hydroplot">hydroplot</a></code>, <code><a href="#topic+vector2zoo">vector2zoo</a></code>, <code><a href="#topic+izoo2rzoo">izoo2rzoo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Creating a 15-min time sequence and counting its length
dt  &lt;- seq( from=as.POSIXct("2021-06-30 00:15"), to=as.POSIXct("2021-06-30 23:45"), by="15 min" )
ndt &lt;- length(dt)

## Creating a dummy 15-min zoo object, with 1 as the only value in each time period
x &lt;- zoo( rep(1, ndt), dt)


## sub-hourly to hourly
h1 &lt;- subhourly2hourly(x, FUN=sum, na.rm=TRUE)

## Aggregation of 3 sub-hourly ts (i.e., a zoo matrix) into an hourly one
X  &lt;- cbind(x, x, x)
h2 &lt;- subhourly2hourly(X, FUN=sum, na.rm=TRUE)
</code></pre>

<hr>
<h2 id='subhourly2nminutes'>
Sub-hourly -&gt; n-minutes
</h2><span id='topic+subhourly2nminutes'></span><span id='topic+subhourly2nminutes.default'></span><span id='topic+subhourly2nminutes.zoo'></span><span id='topic+subhourly2nminutes.data.frame'></span><span id='topic+subhourly2nminutes.matrix'></span>

<h3>Description</h3>

<p>Generic function for aggregating a sub-hourly time series into a &quot;n-minutes' one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subhourly2nminutes(x, ...)

## Default S3 method:
subhourly2nminutes(x, nminutes, FUN, na.rm=TRUE, 
                                     from=start(x), to=end(x), ...)

## S3 method for class 'zoo'
subhourly2nminutes(x, nminutes, FUN, na.rm=TRUE, 
                                 from=start(x), to=end(x), ...)

## S3 method for class 'data.frame'
subhourly2nminutes(x, nminutes, FUN, na.rm=TRUE, 
        from=start(x), to=end(x), dates=1, date.fmt="%Y-%m-%d %H:%M:%S", 
        out.fmt="zoo", verbose= TRUE, ...)

## S3 method for class 'matrix'
subhourly2nminutes(x, nminutes, FUN, na.rm=TRUE, 
        from=start(x), to=end(x), dates=1, date.fmt="%Y-%m-%d %H:%M:%S", 
        out.fmt="zoo", verbose= TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subhourly2nminutes_+3A_x">x</code></td>
<td>

<p>zoo, data.frame or matrix object, with sub-hourly time series. <br />
Measurements at several gauging stations can be stored in a data.frame or matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> represent the ID of each station.
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_nminutes">nminutes</code></td>
<td>

<p>numeric, defining the amount of minutes to be used for aggregating <code>x</code>.
<code>nminutes</code> must be larger than the amount of minutes between each <code>x</code> value (computed as <code>time(x)[2]-time(x)[1]</code>).
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_fun">FUN</code></td>
<td>

<p>Function that have to be applied for aggregating from sub-hourly into n-minutes time step. (e.g., for precipitation <code>FUN=sum</code> and for temperature and streamflow ts, <code>FUN=mean</code>). <br />
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the hourly values  are computed considering only those values different from NA <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA sub-hourly value within a day, the corresponding hourly value(s) will be NA as well
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_from">from</code></td>
<td>

<p>POSIX object indicating the starting time used to carry out the temporal aggregation.  <br />
When <code>from &gt; start(x)</code> then <code>x</code> is cut in time to the starting DateTime defined by <code>from</code>. <br />
When <code>from &lt; start(x)</code> then <code>x</code> is extended backward with NAs to the starting DateTime defined by <code>from</code>.
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_to">to</code></td>
<td>

<p>POSIX object indicating the ending time used to carry out the temporal aggregation.  <br />
When <code>to &lt; end(x)</code> then <code>x</code> is cut in time to the ending DateTime defined by <code>to</code>. <br />
When <code>to &gt; end(x)</code> then <code>x</code> is extended forward with NAs to the ending DateTime defined by <code>from</code>.
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_dates">dates</code></td>
<td>

<p>numeric, factor, POSIXct or POSIXt object indicating how to obtain the dates and times for each column of <code>x</code> (e.g., gauging station) <br />
If <code>dates</code> is a number, it indicates the index of the column in <code>x</code> that stores the date and times <br />
If <code>dates</code> is a factor, it is converted into POSIXct class, using the date format specified by <code>date.fmt</code>  <br />
If <code>dates</code> is already of POSIXct or POSIXt class, the code verifies that the number of elements on it be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>dates</code>, By default <code>date.fmt=%Y-%m-%d %H:%M:%S</code>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_out.fmt">out.fmt</code></td>
<td>

<p>OPTIONAL. Only used when <code>x</code> is a matrix or data.frame object /cr
character, for selecting if the result will be a matrix/data.frame or a zoo object. Valid values are: <kbd>numeric</kbd>, <kbd>zoo</kbd> (default)
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_verbose">verbose</code></td>
<td>

<p>logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="subhourly2nminutes_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a zoo object with hourly time series
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subhourly2hourly">subhourly2hourly</a></code>, <code><a href="#topic+subdaily2daily">subdaily2daily</a></code>, <code><a href="#topic+subdaily2monthly">subdaily2monthly</a></code>, <code><a href="#topic+subdaily2annual">subdaily2annual</a></code>, <code><a href="#topic+subdaily2seasonal">subdaily2seasonal</a></code>, <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>, <code><a href="#topic+dm2seasonal">dm2seasonal</a></code>, <code><a href="#topic+monthlyfunction">monthlyfunction</a></code>, <code><a href="#topic+seasonalfunction">seasonalfunction</a></code>, <code><a href="#topic+hydroplot">hydroplot</a></code>, <code><a href="#topic+vector2zoo">vector2zoo</a></code>, <code><a href="#topic+izoo2rzoo">izoo2rzoo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Creating a 5-min time sequence and counting its length
dt  &lt;- seq( from=as.POSIXct("2021-06-30 00:00"), to=as.POSIXct("2021-06-30 23:55"), by="5 min" )
ndt &lt;- length(dt)

## Creating a dummy 5-min zoo object, with 1 as the only value in each time period
x &lt;- zoo( rep(1, ndt), dt)


## Aggregation from 5-minute single ts into 10-minute ts
h1 &lt;- subhourly2nminutes(x, nminutes= 10, FUN=sum, na.rm=TRUE)

## Aggregation of 3 ts with 5-minute time frequency (i.e., a zoo matrix) 
## into a 30-minute zoo object.
X  &lt;- cbind(x, x, x)
h2 &lt;- subhourly2nminutes(X, nminutes= 30, FUN=sum, na.rm=TRUE)
</code></pre>

<hr>
<h2 id='time2season'>
Date/DateTime character -&gt; Seasonal character
</h2><span id='topic+time2season'></span>

<h3>Description</h3>

<p>This function transforms a character vector of Dates or DateTimes into a character vector of seasons (summer, winter, autumn, spring), depending on the value of <code>type</code>:  <br />
</p>
<p>When <code>type=default</code>
-) winter = DJF: December, January, February   <br />              
-) spring = MAM: March, April, May             <br />             
-) summer = JJA: June, July, August            <br />            
-) autumn = SON: September, October, November  <br />
</p>
<p>When <code>type=FrenchPolynesia</code>
-) winter = DJFM: December, January, February, March  <br />              
-) spring = AM  : April, May                          <br />             
-) summer = JJAS: June, July, August, September       <br />            
-) autumn = ON  : October, November
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time2season(x, out.fmt = "months", type="default")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time2season_+3A_x">x</code></td>
<td>

<p>vector with the dates that have to be transformed. class(x) must be Date
</p>
</td></tr>
<tr><td><code id="time2season_+3A_out.fmt">out.fmt</code></td>
<td>

<p>character, indicating the format of the output seasons. Possible values are: <br />
-) <kbd>seasons</kbd> =&gt;  c(&quot;winter&quot;, &quot;spring&quot;,  &quot;summer&quot;, autumn&quot;)  <br />
-) <kbd>months</kbd>  =&gt;  c(&quot;DJF&quot;, &quot;MAM&quot;,  &quot;JJA&quot;, SON&quot;) or c(&quot;DJFM&quot;, &quot;AM&quot;,  &quot;JJAS&quot;, ON&quot;)
</p>
</td></tr>
<tr><td><code id="time2season_+3A_type">type</code></td>
<td>

<p>character, indicating which weather seasons will be used for computing the output. Possible values are: <br />
-) <kbd>default</kbd>          =&gt;  &quot;winter&quot;= Dec, Jan, Feb;      &quot;spring&quot;= Mar, Apr, May;  &quot;summer&quot;=Jun, Jul, Aug;       &quot;autumn&quot;= Sep, Oct, Nov  <br />
-) <kbd>FrenchPolynesia</kbd>  =&gt;  &quot;winter&quot;= Dec, Jan, Feb, Mar; &quot;spring&quot;= Apr, May;       &quot;summer&quot;=Jun, Jul, Aug, Sep;  &quot;autumn&quot;= Oct, Nov 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector with the weather season to which each date in <code>x</code> belongs
</p>


<h3>Note</h3>

<p>Weather seasons corresponding to French Polynesia were defined following a comment from Lydie Sichoix
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dm2seasonal">dm2seasonal</a></code>, <code><a href="#topic+seasonalfunction">seasonalfunction</a></code>, <code><a href="#topic+extract">extract</a></code>, <code><a href="#topic+dip">dip</a></code>, <code><a href="#topic+mip">mip</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sequence of daily dates between "1961-01-01" and "1961-12-31"
t &lt;- dip("1961-01-01", "1961-12-31")
time2season(t)

## Sequence of monthly dates between "1961-01-01" and "1961-12-31"
t &lt;- mip("1961-01-01", "1961-12-31")
time2season(t)
time2season(t, out.fmt="seasons")

</code></pre>

<hr>
<h2 id='vector2zoo'>
Vector -&gt; Zoo
</h2><span id='topic+vector2zoo'></span>

<h3>Description</h3>

<p>Transform a numeric vector and its corresponding dates into a zoo object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vector2zoo(x, dates, date.fmt = "%Y-%m-%d")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vector2zoo_+3A_x">x</code></td>
<td>

<p>numeric vector
</p>
</td></tr>
<tr><td><code id="vector2zoo_+3A_dates">dates</code></td>
<td>

<p>character, factor, Date or POSIXct object with the dates corresponding to each element of <code>x</code>. Valid object class for <code>dates</code> are: <code>character, factor, Date, POSIXct</code>
</p>
</td></tr>
<tr><td><code id="vector2zoo_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See &lsquo;Details&rsquo; section in <code><a href="base.html#topic+strptime">strptime</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="character"</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a zoo object, with values given by <code>x</code> and time stamps given by <code>dates</code>
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="zoo.html#topic+zoo">zoo</a></code>, <code><a href="#topic+izoo2rzoo">izoo2rzoo</a></code>, <code><a href="#topic+dip">dip</a></code>, <code><a href="#topic+mip">mip</a></code>, <code><a href="#topic+yip">yip</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example1: creating daily data

# Generating a numeric variable (e.g., read from the outputs of an hydrological model)
x &lt;- 1:31

# Generating the dates corresponding to the previous values
dates &lt;- dip("1961-01-01", "1961-01-31")

## Transforming from 'numeric' to 'zoo' class
z &lt;- vector2zoo(x, dates)

##
## Example2: creating hourly data

# Generating a numeric variable
x &lt;- rnorm(7)

# Generating hourly times since 17:00:00 up to 23:00:00 for 2012-Oct-15
dates &lt;- ISOdatetime(2012, 10, 15, 17:23, 00, 0)

## Transforming from 'numeric' to 'zoo' class
z &lt;- vector2zoo(x, dates)
</code></pre>

<hr>
<h2 id='weeklyfunction'>
Weekly Function
</h2><span id='topic+weeklyfunction'></span><span id='topic+weeklyfunction.zoo'></span><span id='topic+weeklyfunction.default'></span><span id='topic+weeklyfunction.matrix'></span><span id='topic+weeklyfunction.data.frame'></span>

<h3>Description</h3>

<p>Generic function for obtaining 52 weekly values of a zoo object, by applying any R function to ALL the values in the object belonging to each one of the 52 calendar weeks (starting on Monday).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weeklyfunction(x, ...)

## Default S3 method:
weeklyfunction(x, FUN, na.rm=TRUE, na.rm.max=0, start="00:00:00", 
                                 start.fmt= "%H:%M:%S", tz, ...)

## S3 method for class 'zoo'
weeklyfunction(x, FUN, na.rm=TRUE, na.rm.max=0, start="00:00:00", 
                             start.fmt= "%H:%M:%S", tz, ...)

## S3 method for class 'data.frame'
weeklyfunction(x, FUN, na.rm=TRUE, na.rm.max=0, start="00:00:00", 
                        start.fmt= "%H:%M:%S", tz, dates=1, date.fmt="%Y-%m-%d",
                        out.type="data.frame", verbose=TRUE,...)
             
## S3 method for class 'matrix'
weeklyfunction(x, FUN, na.rm=TRUE, na.rm.max=0, start="00:00:00", 
                        start.fmt= "%H:%M:%S", tz, dates=1, date.fmt="%Y-%m-%d",
                        out.type="data.frame", verbose=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weeklyfunction_+3A_x">x</code></td>
<td>

<p>zoo, xts, data.frame or matrix object, with daily or monthly time series. <br />
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_fun">FUN</code></td>
<td>

<p>Function that will be applied to ALL the values in <code>x</code> belonging to each one of the 12 months of the year (e.g., FUN can be some of <code>mean</code>, <code>sum</code>, <code>max</code>, <code>min</code>, <code>sd</code>).
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical. Should missing values be removed? <br />
-) <kbd>TRUE</kbd> : the monthly values and FUN are computed considering only those values in <code>x</code> different from NA <br />
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the corresponding monthly value will be NA 
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_na.rm.max">na.rm.max</code></td>
<td>

<p>Numeric in [0, 1]. It is used to define the maximum percentage of missing values allowed in each month to keep the weekly aggregated value in the output object of this function. In other words, if the percentage of missing values in a given month is larger or equal than <code>na.rm.max</code> the corresponding weekly value will be <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_start">start</code></td>
<td>

<p>character, indicating the starting time used for aggregating sub-daily time series into daily ones. It MUST be provided in the format specified by <code>start.fmt</code>. <br />
This value is used to define the time when a new day begins (e.g., for some rain gauge stations). <br />
-) All the values of <code>x</code> with a time attribute before <code>start</code> are considered as belonging to the day before the one indicated in the time attribute of those values. <br />
-) All the values of <code>x</code> with a time attribute equal to <code>start</code> are considered to be equal to <code>"00:00:00"</code> in the output zoo object. <br />
-) All the values of <code>x</code> with a time attribute after <code>start</code> are considered as belonging to the same day as the one indicated in the time attribute of those values. <br />
</p>
<p>It is useful when the daily values start at a time different from <code>"00:00:00"</code>. Use with caution. See examples.
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_start.fmt">start.fmt</code></td>
<td>

<p>character indicating the format in which the time is provided in <code>start</code>, By default <code>date.fmt=%H:%M:%S</code>. See <code>format</code> in <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>.
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_tz">tz</code></td>
<td>

<p>character, with the specification of the time zone used in both <code>x</code> and <code>start</code>. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> is UTC (Universal Time, Coordinated). See <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. <br />
If <code>tz</code> is missing (the default), it is automatically set to the time zone used in <code>time(x)</code>. <br />
This argument can be used to force using the local time zone or any other time zone instead of UTC as time zone.
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_dates">dates</code></td>
<td>

<p>It is only used when <code>x</code> is not a zoo object. <br />
numeric, factor, Date indicating how to obtain the dates. <br />
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br />
If <code>dates</code> is a factor, it is converted into 'Date' class, using the date format specified by <code>date.fmt</code> <br />
If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of elements in <code>x</code>
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_date.fmt">date.fmt</code></td>
<td>

<p>It is only used when <code>x</code> is not a zoo object. <br />
character indicating the format in which the dates are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>. <br />
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_out.type">out.type</code></td>
<td>

<p>It is only used when <code>x</code> is a matrix or data.frame. <br />
Character defining the desired type of output. Valid values are: <br />
-) <kbd>data.frame</kbd>: a data.frame, with 12 columns representing the months, and as many rows as gauging stations are included in <code>x</code> <br />
-) <kbd>db</kbd>        : a data.frame, with 4 columns will be produced. Useful for a posterior boxplot <br />
The first column ('StationID') will store the ID of the station,  <br />
The second column ('Year') will store the year, <br />
The third column ('Month') will store month,  <br />
The fourth column ('Value') will contain the monthly value corresponding to the three previous columns.
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_verbose">verbose</code></td>
<td>

<p>Logical; if TRUE, progress messages are printed 
</p>
</td></tr>
<tr><td><code id="weeklyfunction_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>x</code> is a zoo object, a numeric vector with 12 elements representing the computed monthly value for each month. <br />
When <code>x</code> is a data.frame which columns represent measurements at different gauging stations, the resulting object is a data.frame with 12 columns and as many rows as gauging stations are in <code>x</code>, each row storing the computed 12 monthly value for each gauging station.
</p>


<h3>Note</h3>

<p>Due to the fact that <code>FUN</code> is applied over all the elements in <code>x</code> belonging to a given calendar month, its result will depend on the sampling frequency of <code>x</code> and the type of function provided by <code>FUN</code> (<b>special attention have to be put when <code>FUN=sum</code></b>)
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+annualfunction">annualfunction</a></code>, <code><a href="#topic+seasonalfunction">seasonalfunction</a></code>, <code><a href="#topic+dm2seasonal">dm2seasonal</a></code>, <code><a href="#topic+daily2monthly">daily2monthly</a></code>, <code><a href="#topic+daily2annual">daily2annual</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Ex1: Computation of mean WEEKLY values from DAILY ts, removing any missing value in 'x'

# Loading DAILY streamflows (3 years) at the station 
# Oca en Ona (Ebro River basin, Spain)
data(OcaEnOnaQts)
x &lt;- OcaEnOnaQts

## Mean WEEKLY streamflows at station 'x'
weeklyfunction(x, FUN=mean, na.rm=TRUE)

######################
## Ex2: Computation of mean WEEKLY values from HOURLY ts, removing any missing value in 'x'

# Loading HOURLY streamflows for the station Karamea at Gorge
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

## Mean WEEKLY streamflows at station 'x'. Each day starts at 00:00:00
weeklyfunction(x, FUN=mean, na.rm=TRUE)

######################
## Ex3: Computation of mean WEEKLY values from HOURLY ts, removing any missing value in 'x'
##      and starting each day at 08:00:00

# Loading HOURLY streamflows for the station Karamea at Gorge
data(KarameaAtGorgeQts)
x &lt;- KarameaAtGorgeQts

## Mean WEEKLY streamflows at station 'x'. Each day starts at 00:00:00
weeklyfunction(x, FUN=mean, na.rm=TRUE, start="00:00:00")
</code></pre>

<hr>
<h2 id='yip'>
Years in Period
</h2><span id='topic+yip'></span>

<h3>Description</h3>

<p>Given any starting and ending dates, it generates: <br />       
1) a vector of class Date with all the years between the two dates (both of them included), OR <br />
2) the amount of years between the two dates 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yip(from, to, date.fmt = "%Y-%m-%d", out.type = "seq")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yip_+3A_from">from</code></td>
<td>

<p>Character indicating the starting date for creating the sequence. It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="yip_+3A_to">to</code></td>
<td>

<p>Character indicating the ending date for creating the sequence. It has to be in the format indicated by <code>date.fmt</code>.
</p>
</td></tr>
<tr><td><code id="yip_+3A_date.fmt">date.fmt</code></td>
<td>

<p>character indicating the format in which the dates are stored in <code>from</code> and <code>to</code>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="base.html#topic+as.Date">as.Date</a></code>.
</p>
</td></tr>
<tr><td><code id="yip_+3A_out.type">out.type</code></td>
<td>

<p>Character indicating the type of result that is given by this function. Valid values are: <br />
-) <kbd>seq</kbd>  =&gt; a vectorial sequence with all the years within the given dates. <br />
-) <kbd>nmbr</kbd> =&gt; the number of years within the given dates.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the value of <code>out.type</code>, it returns: <br />
1) <kbd>seq</kbd> : a vector of class Date with all the years between <code>from</code> and <code>to</code> (both of them included), OR <br />
2) <kbd>nmbr</kbd>: a single numeric value with the amount of years between the two dates. 
</p>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dip">dip</a></code>, <code><a href="#topic+diy">diy</a></code>, <code><a href="#topic+mip">mip</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sequence of monthly dates between "1961-01-01" and "1961-12-31"
yip("1961-01-01", "1961-12-31")

## Computing the number of years between 1961 and 1975, 
## by using "%d-%m-%Y" as date format   ##
yip("01-01-1961", "01-01-1975", date.fmt= "%d-%m-%Y", out.type = "nmbr")

</code></pre>

<hr>
<h2 id='zoo2RHtest'>
Zoo -&gt; RHTest 
</h2><span id='topic+zoo2RHtest'></span>

<h3>Description</h3>

<p>It creates the input file to the <var>'RHtest_dlyPrcp.r'</var> script,  used for testing the homogeneity of climatological time series (available at: <a href="http://etccdi.pacificclimate.org/software.shtml">http://etccdi.pacificclimate.org/software.shtml</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zoo2RHtest(x, fname="pcp.txt", tstep.out="daily", dec=".", na="-999.0")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zoo2RHtest_+3A_x">x</code></td>
<td>

<p>time series that will be written. class(x) must be a zoo object
</p>
</td></tr>
<tr><td><code id="zoo2RHtest_+3A_fname">fname</code></td>
<td>

<p>Character, with the filename of the precipitation time series 
</p>
</td></tr>
<tr><td><code id="zoo2RHtest_+3A_tstep.out">tstep.out</code></td>
<td>

<p>Character indicating the time step that have to be used for writing <code>x</code> into the output file
</p>
</td></tr>
<tr><td><code id="zoo2RHtest_+3A_dec">dec</code></td>
<td>

<p>the string to use for decimal points in numeric or complex columns: must be a single character.
</p>
</td></tr>
<tr><td><code id="zoo2RHtest_+3A_na">na</code></td>
<td>

<p>character to be used for representing the missing values in the data
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a>
</p>


<h3>References</h3>

<p><a href="http://etccdi.pacificclimate.org/software.shtml">http://etccdi.pacificclimate.org/software.shtml</a>
<a href="http://etccdi.pacificclimate.org/RHtest/RHtestsV4_UserManual_10Dec2014.pdf">http://etccdi.pacificclimate.org/RHtest/RHtestsV4_UserManual_10Dec2014.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Loading the SanMartino precipitation data
data(SanMartinoPPts)
x &lt;- SanMartinoPPts

#Getting the monthly ts
pcp.m &lt;- daily2monthly(x, FUN=sum, na.rm=FALSE)

## Not run: 
# From zoo to the input format required by 'FindU.dlyPrcp' function
zoo2RHtest(x=pcp.m, fname="pcp-monthly.txt", tstep.out="monthly", na="-999.0")

# Homogeneity analysis
FindU.dlyPrcp(InSeries="pcp-monthly.txt", output="pcp-monthly", MissingValueCode="-999.0", 
GUI=FALSE, pthr=0, Mq=10, p.lev=0.95, Iadj=10000)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
