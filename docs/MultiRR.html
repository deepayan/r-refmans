<!DOCTYPE html><html><head><title>Help for package MultiRR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultiRR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MultiRR-package'>
<p>Simulation Package for Multi-level random regressions</p></a></li>
<li><a href='#Anal.MultiRR'>
<p>Fits a multilevel random regression to n simulated data frames.</p></a></li>
<li><a href='#Bias'>
<p>Estimates bias for n number of multi-level random regression models performed to n simulated data sets.</p></a></li>
<li><a href='#Imprecision'>
<p>Calculates imprecision for n multi-level random regressions perfromed to n simulated dats sets.</p></a></li>
<li><a href='#lmerAll'>
<p>lmerAll is not a user level function</p></a></li>
<li><a href='#lower2'>
<p>lower2 is not a user level function</p></a></li>
<li><a href='#mean2'>
<p>mean2 is not a user level function</p></a></li>
<li><a href='#median2'>
<p>median2 is not a user level function</p></a></li>
<li><a href='#Plot.Sim'>
<p>Density plots for each variance component.</p></a></li>
<li><a href='#Power'>
<p>Estimates power to detect significant among-individual variation in intercepts and slopes.</p></a></li>
<li><a href='#sd2'>
<p>sd2 is not a user level function</p></a></li>
<li><a href='#Sim.MultiRR'>
<p>Simulate data setes to be analyzed by a multi-level random regression.</p></a></li>
<li><a href='#Summary'>
<p>Summary of the results of the multi-level random regressions performed to n simulated data sets.</p></a></li>
<li><a href='#upper2'>
<p>Upper2 is not a user level function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bias, Precision, and Power for Multi-Level Random Regressions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-10-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Yimen G. Araya-Ajoy</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yimen G. Araya-Ajoy &lt;yimencr@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates bias, precision, and power for multi-level random regressions. Random regressions are types of hierarchical models in which data are structured in groups and (regression) coefficients can vary by groups. Tools to estimate model performance are designed mostly for scenarios where (regression) coefficients vary at just one level. 'MultiRR' provides simulation and analytical tools (based on 'lme4') to study model performance for random regressions that vary at more than one level (multi-level random regressions), allowing researchers to determine optimal sampling designs.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, lme4</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-10-21 08:19:09 UTC; yi</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-10-21 11:36:43</td>
</tr>
</table>
<hr>
<h2 id='MultiRR-package'>
Simulation Package for Multi-level random regressions
</h2><span id='topic+MultiRR-package'></span><span id='topic+MultiRR'></span>

<h3>Description</h3>

<p>Calculates bias, precision, and power for multi-level random regressions. Random regressions are types of hierarchical models in which data are structured in groups and (regression) coefficients can vary by groups. Tools to estimate model performance are designed mostly for scenarios where (regression) coefficients vary at just one level. 'MultiRR' provides simulation and analytical tools (based on 'lme4') to study model performance for random regressions that vary at more than one level (multi-level random regressions), allowing researchers to determine optimal sampling designs.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MultiRR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-05-11</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL -2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Use the function <code><a href="#topic+Sim.MultiRR">Sim.MultiRR</a></code> to simulate n data sets, then use the function <code><a href="#topic+Anal.MultiRR">Anal.MultiRR</a></code> to perform a multi-level random regression to n simulated data sets. You can view the results using the function <code><a href="#topic+Summary">Summary</a></code> or <code><a href="#topic+Plot.Sim">Plot.Sim</a></code>, estimate bias using the function <code><a href="#topic+Bias">Bias</a></code>, imprecision using the function <code><a href="#topic+Imprecision">Imprecision</a></code>, and power using the function <code><a href="#topic+Power">Power</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Yimen Araya: &lt;yimencr@gmail.com&gt;
</p>


<h3>References</h3>

<p>Araya-Ajoy Y.G., Mathot, K. J., Dingemanse N. J. (2015) An approach to estimate short-term, long-term, and reaction norm repeatability. Methods in Ecology and Evolution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1: Balanced sampling design.
#Define sample sizes.
n.ind &lt;-c(40, 50) ##Numbers of individuals to simulate.
SeriesPerInd &lt;- c(4, 5) ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.
 
#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.
 
#Define individual level parameters
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define series level parameters
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data sets.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, 
ObsPerLevel=ObsPerLevel, EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, 
VCVInd=VCVInd, VCVSeries=VCVSeries, ResVar=ResVar, n.sim=3)
 
#Analyze the simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)

#Summarize the results of the multi-level random regressions. 
Summary(ressim) 
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)

#Example 2: Unbalanced sampling design.
#Define sample sizes.
n.ind &lt;-40 ##Numbers of individuals to simulate.
SeriesPerInd &lt;- 4 ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.

#Define the proportion of individuals that were sampled in all the series.
#All individuals were assayed at least once, 0.9 of individuals twice...

prop.ind&lt;-c(1, 0.9, 0.8, 0.7)

#Define the total number of observations
n.obs=300

#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.

#Define the individual level parameters.
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the series level parameters.
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, ObsPerLevel=ObsPerLevel,
EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, VCVInd= VCVInd, VCVSeries=VCVSeries,
ResVar=ResVar, n.sim=n.sim, unbalanced=TRUE, prop.ind=c(1, 0.9, 0.8, 0.7), 
complete.observations=FALSE, n.obs=n.obs)
 
#Analyze simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)
 
#Summarize the results of the multi-level random regressions.
Summary(ressim)
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)  
</code></pre>

<hr>
<h2 id='Anal.MultiRR'>
Fits a multilevel random regression to n simulated data frames. 
</h2><span id='topic+Anal.MultiRR'></span>

<h3>Description</h3>

<p>Performs multilevel random regressions to objects created with the function Sim.MultiRR.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Anal.MultiRR(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Anal.MultiRR_+3A_x">x</code></td>
<td>

<p>Object created with the function sim.MultiRR.  
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results from the multi-level random regression for n simulated
data sets.
</p>


<h3>Author(s)</h3>

<p>Yimen Araya
</p>


<h3>References</h3>

<p>Araya-Ajoy Y.G., Mathot, K. J., Dingemanse N. J. (2015) An approach to estimate short-term, long-term, and reaction norm repeatability. Methods in Ecology and Evolution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sim.MultiRR">Sim.MultiRR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1: Balanced sampling design.
#Define sample sizes.
n.ind &lt;-c(40, 50) ##Numbers of individuals to simulate.
SeriesPerInd &lt;- c(4, 5) ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.
 
#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.
 
#Define individual level parameters
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define series level parameters
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data sets.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, 
ObsPerLevel=ObsPerLevel, EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, 
VCVInd=VCVInd, VCVSeries=VCVSeries, ResVar=ResVar, n.sim=3)
 
#Analyze the simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)

#Summarize the results of the multi-level random regressions. 
Summary(ressim) 
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)

#Example 2: Unbalanced sampling design.
#Define sample sizes.
n.ind &lt;-40 ##Numbers of individuals to simulate.
SeriesPerInd &lt;- 4 ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.

#Define the proportion of individuals that were sampled in all the series.
#All individuals were assayed at least once, 0.9 of individuals twice...

prop.ind&lt;-c(1, 0.9, 0.8, 0.7)

#Define the total number of observations
n.obs=300

#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.

#Define the individual level parameters.
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the series level parameters.
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, ObsPerLevel=ObsPerLevel,
EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, VCVInd= VCVInd, VCVSeries=VCVSeries,
ResVar=ResVar, n.sim=n.sim, unbalanced=TRUE, prop.ind=c(1, 0.9, 0.8, 0.7), 
complete.observations=FALSE, n.obs=n.obs)
 
#Analyze simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)
 
#Summarize the results of the multi-level random regressions.
Summary(ressim)
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)  
</code></pre>

<hr>
<h2 id='Bias'>
Estimates bias for n number of multi-level random regression models performed to n simulated data sets.
</h2><span id='topic+Bias'></span>

<h3>Description</h3>

<p>Calculates bias for an object created with anal.MultiRR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bias(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bias_+3A_x">x</code></td>
<td>

<p>Object created with Anal.MultiRR.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames with the bias and relative bias for all the estimated variance components and repeatabilities.
</p>


<h3>Author(s)</h3>

<p>Yimen Araya
</p>


<h3>References</h3>

<p>Araya-Ajoy Y.G., Mathot, K. J., Dingemanse N. J. (2015) An approach to estimate short-term, long-term, and reaction norm repeatability. Methods in Ecology and Evolution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sim.MultiRR">Sim.MultiRR</a></code>,
<code><a href="#topic+Anal.MultiRR">Anal.MultiRR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1: Balanced sampling design.
#Define sample sizes.
n.ind &lt;-c(40, 50) ##Numbers of individuals to simulate.
SeriesPerInd &lt;- c(4, 5) ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.
 
#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.
 
#Define individual level parameters
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define series level parameters
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data sets.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, 
ObsPerLevel=ObsPerLevel, EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, 
VCVInd=VCVInd, VCVSeries=VCVSeries, ResVar=ResVar, n.sim=3)
 
#Analyze the simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)

#Summarize the results of the multi-level random regressions. 
Summary(ressim) 
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)
</code></pre>

<hr>
<h2 id='Imprecision'>
Calculates imprecision for n multi-level random regressions perfromed to n simulated dats sets. 
</h2><span id='topic+Imprecision'></span>

<h3>Description</h3>

<p>Calculates imprecision for an object created with anal.MultiRR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Imprecision(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Imprecision_+3A_x">x</code></td>
<td>

<p>Object created with Anal.MultiRR.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames with the imprecision for all the estimated variance components and repeatabilities.
</p>


<h3>Author(s)</h3>

<p>Yimen Araya 
</p>


<h3>References</h3>

<p>Araya-Ajoy Y.G., Mathot, K. J., Dingemanse N. J. (2015) An approach to estimate short-term, long-term, and reaction norm repeatability. Methods in Ecology and Evolution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sim.MultiRR">Sim.MultiRR</a></code>,
<code><a href="#topic+Anal.MultiRR">Anal.MultiRR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1: Balanced sampling design.
#Define sample sizes.
n.ind &lt;-c(40, 50) ##Numbers of individuals to simulate.
SeriesPerInd &lt;- c(4, 5) ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.
 
#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.
 
#Define individual level parameters
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define series level parameters
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data sets.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, 
ObsPerLevel=ObsPerLevel, EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, 
VCVInd=VCVInd, VCVSeries=VCVSeries, ResVar=ResVar, n.sim=3)
 
#Analyze the simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)

#Summarize the results of the multi-level random regressions. 
Summary(ressim) 
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)  
</code></pre>

<hr>
<h2 id='lmerAll'>
lmerAll is not a user level function
</h2><span id='topic+lmerAll'></span>

<h3>Description</h3>

<p>lmerAll is not a user level function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmerAll(z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmerAll_+3A_z">z</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yimen Araya
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The function is currently defined as
function (z) 
{
data &lt;- z
modF &lt;- lmer(y~x + (x|Series) + (x|Ind), data=data, REML=TRUE)
modIDS &lt;- lmer(y~x + (x|Series) + (1|Ind), data=data, REML=TRUE)
modIDInt &lt;- lmer(y~x + (x|Series), data=data, REML=TRUE)

d1&lt;- (-2*logLik(modIDInt)) + (2*logLik(modIDS))
d2&lt;- (-2*logLik(modIDS)) + (2*logLik(modF))

pwI &lt;-0.5*pchisq(d1[1], 0, lower.tail=FALSE) + 0.5*pchisq(d1[1], 1, lower.tail=FALSE)
pwS &lt;-0.5*pchisq(d2[1], 1, lower.tail=FALSE) + 0.5*pchisq(d2[1], 2, lower.tail=FALSE)

vcs&lt;- VarCorr(modF)
VCVID &lt;- as.vector(vcs$Ind[,])
VCVSeries &lt;- as.vector(vcs$Series[,])
Residuals &lt;- summary(modF)$sigma^2
Intercept &lt;-  summary(modF)$coef[1,1]
Slope &lt;- summary(modF)$coef[2,1]
RInt &lt;- vcs$Ind[1,1]/(vcs$Series[1,1]+vcs$Ind[1,1])
RSlope &lt;- vcs$Ind[2,2]/(vcs$Series[2,2]+vcs$Ind[2,2])
Rrn &lt;- (vcs$Ind[1,1] + vcs$Ind[2,2] + (2*vcs$Ind[2,1]))/((vcs$Series[1,1] + 
vcs$Series[2,2] + (2*vcs$Series[2,1])) + (vcs$Ind[1,1] + vcs$Ind[2,2] + (2*vcs$Ind[2,1])))
list(VCVSeries, VCVID, pwI, pwS, RInt, RSlope, Rrn, Residuals, Intercept, Slope)
  }
</code></pre>

<hr>
<h2 id='lower2'>
lower2 is not a user level function
</h2><span id='topic+lower2'></span>

<h3>Description</h3>

<p>This function is not a user level function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lower2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lower2_+3A_x">x</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## The function is currently defined as
function (x) 
{
    apply(x, 2, quantile, 0.025)
  }
</code></pre>

<hr>
<h2 id='mean2'>
mean2 is not a user level function
</h2><span id='topic+mean2'></span>

<h3>Description</h3>

<p>This is not a user level function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean2_+3A_x">x</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## The function is currently defined as
function (x) 
{
    apply(x, 2, mean)
  }
</code></pre>

<hr>
<h2 id='median2'>
median2 is not a user level function
</h2><span id='topic+median2'></span>

<h3>Description</h3>

<p>This is not a user level function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>median2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="median2_+3A_x">x</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## The function is currently defined as
function (x) 
{
    apply(x, 2, median)
  }
</code></pre>

<hr>
<h2 id='Plot.Sim'>
Density plots for each variance component.
</h2><span id='topic+Plot.Sim'></span>

<h3>Description</h3>

<p>Plots distributions of the estimated parameters from the simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.Sim(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Plot.Sim_+3A_x">x</code></td>
<td>

<p>Object created with Anal.MultiRR.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Better use with only one combination of parameters (i.e., number of individuals and series per individual.
</p>


<h3>Author(s)</h3>

<p>Yimen Araya
</p>


<h3>References</h3>

<p>Araya-Ajoy Y.G., Mathot, K. J., Dingemanse N. J. (2015) An approach to estimate short-term, long-term, and reaction norm repeatability. Methods in Ecology and Evolution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sim.MultiRR">Sim.MultiRR</a></code>,
<code><a href="#topic+Anal.MultiRR">Anal.MultiRR</a></code>,
<code><a href="#topic+Summary">Summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example: Unbalanced sampling design.
#Define sample sizes.
n.ind &lt;-40 ##Numbers of individuals to simulate.
SeriesPerInd &lt;- 4 ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.

#Define the proportion of individuals that were sampled in all the series.
#All individuals were assayed at least once, 0.9 of individuals twice...

prop.ind&lt;-c(1, 0.9, 0.8, 0.7)

#Define the total number of observations
n.obs=300

#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.

#Define the individual level parameters.
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the series level parameters.
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, ObsPerLevel=ObsPerLevel,
EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, VCVInd= VCVInd, VCVSeries=VCVSeries,
ResVar=ResVar, n.sim=n.sim, unbalanced=TRUE, prop.ind=c(1, 0.9, 0.8, 0.7), 
complete.observations=FALSE, n.obs=n.obs)
 
#Analyze simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)
 
#Summarize the results of the multi-level random regressions.
Summary(ressim)
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)  

#Plot the simulations
Plot.Sim(ressim)
</code></pre>

<hr>
<h2 id='Power'>
Estimates power to detect significant among-individual variation in intercepts and slopes.
</h2><span id='topic+Power'></span>

<h3>Description</h3>

<p>Power analysis for object created with anal.MultiRR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Power(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Power_+3A_x">x</code></td>
<td>

<p>Object created with Anal.MultiRR.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames with the power to detect among-individual variation in intercepts and slopes in a multi-level random regression model.
</p>


<h3>Author(s)</h3>

<p>Yimen Araya
</p>


<h3>References</h3>

<p>Araya-Ajoy Y.G., Mathot, K. J., Dingemanse N. J. (2015) An approach to estimate short-term, long-term, and reaction norm repeatability. Methods in Ecology and Evolution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sim.MultiRR">Sim.MultiRR</a></code>,
<code><a href="#topic+Anal.MultiRR">Anal.MultiRR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1: Balanced sampling design.
#Define sample sizes.
n.ind &lt;-c(40, 50) ##Numbers of individuals to simulate.
SeriesPerInd &lt;- c(4, 5) ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.
 
#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.
 
#Define individual level parameters
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define series level parameters
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data sets.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, 
ObsPerLevel=ObsPerLevel, EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, 
VCVInd=VCVInd, VCVSeries=VCVSeries, ResVar=ResVar, n.sim=3)
 
#Analyze the simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)

#Summarize the results of the multi-level random regressions. 
Summary(ressim) 
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)
</code></pre>

<hr>
<h2 id='sd2'>
sd2 is not a user level function
</h2><span id='topic+sd2'></span>

<h3>Description</h3>

<p>This is not a user level function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sd2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sd2_+3A_x">x</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (x) 
{
    apply(x, 2, sd)
  }
</code></pre>

<hr>
<h2 id='Sim.MultiRR'>
Simulate data setes to be analyzed by a multi-level random regression.
</h2><span id='topic+Sim.MultiRR'></span>

<h3>Description</h3>

<p>Simulate n data sets to be analyzed with a multi-level random regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sim.MultiRR(n.ind, SeriesPerInd, ObsPerLevel, EnvGradient, PopInt, 
PopSlope, VCVInd, VCVSeries, ResVar, n.sim, unbalanced = FALSE, 
prop.ind, complete.observations = TRUE, n.obs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sim.MultiRR_+3A_n.ind">n.ind</code></td>
<td>

<p>A vector consisting of the total individuals sampled.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_seriesperind">SeriesPerInd</code></td>
<td>

<p>A vector consisting of the number of series sampled for each individual.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_obsperlevel">ObsPerLevel</code></td>
<td>

<p>The number of observations per series in each level of the environment.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_envgradient">EnvGradient</code></td>
<td>

<p>A vector consisting of the levels in the environmental gradient.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_popint">PopInt</code></td>
<td>

<p>Population level intercept.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_popslope">PopSlope</code></td>
<td>

<p>Population level slope.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_vcvind">VCVInd</code></td>
<td>

<p>A positive definite variance covariance matrix of dimensions 2 X 2, defining the among-individual variance in intercepts and slopes in the diagonals and their covariance in the off diagonals.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_vcvseries">VCVSeries</code></td>
<td>

<p>A positive definite variance covariance matrix of dimensions 2 X 2, defining the among-series variance in intercepts and slopes in the diagonals and their covariance in the off diagonals.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_resvar">ResVar</code></td>
<td>

<p>Residual variance
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_n.sim">n.sim</code></td>
<td>

<p>Number of data sets to simulate.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_unbalanced">unbalanced</code></td>
<td>

<p>Optional argument determining whether not all the individuals were assayed the same number of series. The default is &quot;FALSE&quot;.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_prop.ind">prop.ind</code></td>
<td>

<p>When unbalanced = &quot;TRUE&quot;, A vector that has the same length as the number of series per individual, with the proportion of individuals measured n times. All individuals should have been measured once (1,.,.,.).
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_complete.observations">complete.observations</code></td>
<td>

<p>Optional argument determining whether all the levels were assayed the same number of times. The default is &quot;TRUE&quot;.
</p>
</td></tr>
<tr><td><code id="Sim.MultiRR_+3A_n.obs">n.obs</code></td>
<td>

<p>The total number of observations, if complete.observartions = &quot;FALSE&quot;.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data sets to be analyzed by Anal.MultiRR.
</p>


<h3>Author(s)</h3>

<p>Yimen Araya
</p>


<h3>References</h3>

<p>Araya-Ajoy Y.G., Mathot, K. J., Dingemanse N. J. (2015) An approach to estimate short-term, long-term, and reaction norm repeatability. Methods in Ecology and Evolution.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+Anal.MultiRR">Anal.MultiRR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1: Balanced sampling design.
#Define sample sizes.
n.ind &lt;-c(40, 50) ##Numbers of individuals to simulate.
SeriesPerInd &lt;- c(4, 5) ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.
 
#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.
 
#Define individual level parameters
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define series level parameters
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data sets.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, 
ObsPerLevel=ObsPerLevel, EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, 
VCVInd=VCVInd, VCVSeries=VCVSeries, ResVar=ResVar, n.sim=3)
 
#Analyze the simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)

#Summarize the results of the multi-level random regressions. 
Summary(ressim) 
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)

#Example 2: Unbalanced sampling desing.
#Define sample sizes.
n.ind &lt;-40 ##Numbers of individuals to simulate.
SeriesPerInd &lt;- 4 ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.

#Define the proportion of individuals that were sampled in all the series.
#All individuals were assayed at least once, 0.9 of individuals twice...

prop.ind&lt;-c(1, 0.9, 0.8, 0.7)

#Define the total number of observations
n.obs=300

#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.

#Define the individual level parameters.
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the series level parameters.
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, ObsPerLevel=ObsPerLevel,
EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, VCVInd= VCVInd, VCVSeries=VCVSeries,
ResVar=ResVar, n.sim=n.sim, unbalanced=TRUE, prop.ind=c(1, 0.9, 0.8, 0.7), 
complete.observations=FALSE, n.obs=n.obs)
 
#Analyze simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)
 
#Summarize the results of the multi-level random regressions.
Summary(ressim)
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)  
</code></pre>

<hr>
<h2 id='Summary'>
Summary of the results of the multi-level random regressions performed to n simulated data sets. 
</h2><span id='topic+Summary'></span>

<h3>Description</h3>

<p>Summary of object created with anal.MultiRR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Summary(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Summary_+3A_x">x</code></td>
<td>

<p>Object created with anal.MultiRR.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames with a summary of the model estimates for all the simulations.
</p>


<h3>Author(s)</h3>

<p>Yimen Araya
</p>


<h3>References</h3>

<p>Araya-Ajoy Y.G., Mathot, K. J., Dingemanse N. J. (2015) An approach to estimate short-term, long-term, and reaction norm repeatability. Methods in Ecology and Evolution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sim.MultiRR">Sim.MultiRR</a></code>,
<code><a href="#topic+Anal.MultiRR">Anal.MultiRR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1: Balanced sampling design.
#Define sample sizes.
n.ind &lt;-c(40, 50) ##Numbers of individuals to simulate.
SeriesPerInd &lt;- c(4, 5) ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.
 
#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.
 
#Define individual level parameters
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define series level parameters
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data sets.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, 
ObsPerLevel=ObsPerLevel, EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, 
VCVInd=VCVInd, VCVSeries=VCVSeries, ResVar=ResVar, n.sim=3)
 
#Analyze the simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)

#Summarize the results of the multi-level random regressions. 
Summary(ressim) 
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)
</code></pre>

<hr>
<h2 id='upper2'>
Upper2 is not a user level function
</h2><span id='topic+upper2'></span>

<h3>Description</h3>

<p>This is not a user level function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upper2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="upper2_+3A_x">x</code></td>
<td>

</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## The function is currently defined as
function (x) 
{
    apply(x, 2, quantile, 0.975)
  }
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
