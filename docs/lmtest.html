<!DOCTYPE html><html><head><title>Help for package lmtest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmtest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bgtest'><p>Breusch-Godfrey Test</p></a></li>
<li><a href='#bondyield'><p> Bond Yield</p></a></li>
<li><a href='#bptest'><p>Breusch-Pagan Test</p></a></li>
<li><a href='#ChickEgg'><p>Chickens, Eggs, and Causality</p></a></li>
<li><a href='#coeftest'><p>Inference for Estimated Coefficients</p></a></li>
<li><a href='#coxtest'><p>Cox Test for Comparing Non-Nested Models</p></a></li>
<li><a href='#currencysubstitution'><p> Currency Substitution</p></a></li>
<li><a href='#dwtest'><p>Durbin-Watson Test</p></a></li>
<li><a href='#encomptest'><p>Encompassing Test for Comparing Non-Nested Models</p></a></li>
<li><a href='#ftemp'><p>Femal Temperature Data</p></a></li>
<li><a href='#gqtest'><p>Goldfeld-Quandt Test</p></a></li>
<li><a href='#grangertest'><p>Test for Granger Causality</p></a></li>
<li><a href='#growthofmoney'><p>Growth of Money Supply</p></a></li>
<li><a href='#harvtest'><p>Harvey-Collier Test</p></a></li>
<li><a href='#hmctest'><p>Harrison-McCabe test</p></a></li>
<li><a href='#jocci'><p>U.S. Macroeconomic Time Series</p></a></li>
<li><a href='#jtest'><p>J Test for Comparing Non-Nested Models</p></a></li>
<li><a href='#lrtest'><p>Likelihood Ratio Test of Nested Models</p></a></li>
<li><a href='#Mandible'><p>Mandible Data</p></a></li>
<li><a href='#moneydemand'><p>Money Demand</p></a></li>
<li><a href='#petest'><p>PE Test for Linear vs. Log-Linear Specifications</p></a></li>
<li><a href='#raintest'><p>Rainbow Test</p></a></li>
<li><a href='#resettest'><p>RESET Test</p></a></li>
<li><a href='#unemployment'><p>Unemployment Data</p></a></li>
<li><a href='#USDistLag'><p>US Macroeconomic Data</p></a></li>
<li><a href='#valueofstocks'><p> Value of Stocks</p></a></li>
<li><a href='#wages'><p>Wages</p></a></li>
<li><a href='#waldtest'><p>Wald Test of Nested Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Testing Linear Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9-40</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-21</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of tests, data sets, and examples
 for diagnostic checking in linear regression models. Furthermore,
 some generic tools for inference in parametric models are provided.</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), stats, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>car, strucchange, sandwich, dynlm, stats4, survival, AER</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-21 20:25:17 UTC; zeileis</td>
</tr>
<tr>
<td>Author:</td>
<td>Torsten Hothorn <a href="https://orcid.org/0000-0001-8301-0471"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Achim Zeileis <a href="https://orcid.org/0000-0003-0918-3766"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Richard W. Farebrother [aut] (pan.f),
  Clint Cummins [aut] (pan.f),
  Giovanni Millo [ctb],
  David Mitchell [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Achim Zeileis &lt;Achim.Zeileis@R-project.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-21 23:00:02 UTC</td>
</tr>
<tr>
<td>Built:</td>
<td>R 4.3.0; x86_64-pc-linux-gnu; 2022-04-21 04:51:59 UTC; unix</td>
</tr>
</table>
<hr>
<h2 id='bgtest'>Breusch-Godfrey Test</h2><span id='topic+bgtest'></span><span id='topic+vcov.bgtest'></span><span id='topic+df.residual.bgtest'></span>

<h3>Description</h3>

<p><code>bgtest</code> performs the Breusch-Godfrey test for higher-order
serial correlation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgtest(formula, order = 1, order.by = NULL, type = c("Chisq", "F"),
  data = list(), fill = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bgtest_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model to be tested
(or a fitted <code>"lm"</code> object).</p>
</td></tr>
<tr><td><code id="bgtest_+3A_order">order</code></td>
<td>
<p>integer. maximal order of serial correlation to be tested.</p>
</td></tr>
<tr><td><code id="bgtest_+3A_order.by">order.by</code></td>
<td>
<p>Either a vector <code>z</code> or a formula with a single explanatory
variable like <code>~ z</code>. The observations in the model
are ordered by the size of <code>z</code>. If set to <code>NULL</code> (the
default) the observations are assumed to be ordered (e.g., a
time series).</p>
</td></tr>
<tr><td><code id="bgtest_+3A_type">type</code></td>
<td>
<p>the type of test statistic to be returned. Either
<code>"Chisq"</code> for the Chi-squared test statistic or
<code>"F"</code> for the F test statistic.</p>
</td></tr>
<tr><td><code id="bgtest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the
model. By default the variables are taken from the environment
which <code>bgtest</code> is called from.</p>
</td></tr>
<tr><td><code id="bgtest_+3A_fill">fill</code></td>
<td>
<p>starting values for the lagged residuals in the auxiliary
regression. By default <code>0</code> but can also be set to <code>NA</code>.</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>Under <code class="reqn">H_0</code> the test statistic is asymptotically Chi-squared with
degrees of freedom as given in <code>parameter</code>.
If <code>type</code> is set to <code>"F"</code> the function returns
a finite sample version of the test statistic, employing an <code class="reqn">F</code>
distribution with degrees of freedom as given in <code>parameter</code>.
</p>
<p>By default, the starting values for the lagged residuals in the auxiliary
regression are chosen to be 0 (as in Godfrey 1978) but could also be
set to <code>NA</code> to omit them.
</p>
<p><code>bgtest</code> also returns the coefficients and estimated covariance
matrix from the auxiliary regression that includes the lagged residuals.
Hence, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code> can be used to inspect the results. (Note,
however, that standard theory does not always apply to the standard errors
and t-statistics in this regression.)
</p>


<h3>Value</h3>

<p>A list with class <code>"bgtest"</code> inheriting from <code>"htest"</code> containing the
following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was
performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>coefficient estimates from the auxiliary regression.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>corresponding covariance matrix estimate.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Mitchell &lt;david.mitchell@dotars.gov.au&gt;, Achim Zeileis</p>


<h3>References</h3>

<p>Breusch, T.S. (1978): Testing for Autocorrelation in Dynamic Linear
Models, <em>Australian Economic Papers</em>, 17, 334-355.
</p>
<p>Godfrey, L.G. (1978): Testing Against General Autoregressive and
Moving Average Error Models when the Regressors Include Lagged
Dependent Variables', <em>Econometrica</em>, 46, 1293-1301.
</p>
<p>Wooldridge, J.M. (2013): <em>Introductory Econometrics: A Modern Approach</em>,
5th edition, South-Western College.
</p>


<h3>See Also</h3>

<p><code><a href="lmtest.html#topic+dwtest">dwtest</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
     ## Generate a stationary and an AR(1) series
     x &lt;- rep(c(1, -1), 50)

     y1 &lt;- 1 + x + rnorm(100)

     ## Perform Breusch-Godfrey test for first-order serial correlation:
     bgtest(y1 ~ x)
     ## or for fourth-order serial correlation
     bgtest(y1 ~ x, order = 4)
     ## Compare with Durbin-Watson test results:
     dwtest(y1 ~ x)

     y2 &lt;- filter(y1, 0.5, method = "recursive")
     bgtest(y2 ~ x)
     bg4 &lt;- bgtest(y2 ~ x, order = 4)
     bg4
     coeftest(bg4)
</code></pre>

<hr>
<h2 id='bondyield'> Bond Yield  </h2><span id='topic+bondyield'></span>

<h3>Description</h3>

<p>Bond Yield Data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bondyield)</code></pre>


<h3>Format</h3>

<p>A multivariate quarterly time series from 1961(1) to 1975(4) with variables
</p>

<dl>
<dt>RAARUS</dt><dd><p>difference of interest rate on government and corporate
bonds,</p>
</dd>
<dt>MOOD</dt><dd><p>measure of consumer sentiment,</p>
</dd>
<dt>EPI</dt><dd><p>index of employment pressure,</p>
</dd>
<dt>EXP</dt><dd><p>interest rate expectations,</p>
</dd>
<dt>Y</dt><dd><p>artificial time series based on RAARUS,</p>
</dd>
<dt>K</dt><dd><p>artificial time series based on RAARUS.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data was originally studied by Cook and Hendershott (1978) and Yawitz and
Marshall (1981), the data set is given in Krämer and Sonnberger (1986). Below
we replicate a few examples given in their book. 
Some of these results differ more or
less seriously and are sometimes parameterized differently.
</p>


<h3>References</h3>

<p>T.Q. Cook &amp; P.H. Hendershott (1978),
The Impact of Taxes, Risk and Relative Security Supplies of Interest Rate
Differentials. <em>The Journal of Finance</em> <b>33</b>, 1173&ndash;1186
</p>
<p>J.B. Yawitz &amp; W. J. Marshall (1981),
Measuring the Effect of Callability on Bond Yields.
<em>Journal of Money, Credit and Banking</em> <b>13</b>, 60&ndash;71
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bondyield)

## page 134, fit Cook-Hendershott OLS model and Yawitz-Marshall OLS model
## third and last line in Table 6.5

modelCH &lt;- RAARUS ~ MOOD + EPI + EXP + RUS
lm(modelCH, data=bondyield)
dwtest(modelCH, data=bondyield)
## wrong sign of RUS coefficient

modelYM &lt;- RAARUS ~ MOOD + Y + K
lm(modelYM, data=bondyield)
dwtest(modelYM, data=bondyield)
## coefficient of Y and K differ by factor 100


## page 135, fit test statistics in Table 6.6 b)
################################################

## Chow 1971(1)
if(require(strucchange, quietly = TRUE)) {
sctest(modelCH, point=c(1971,1), data=bondyield, type="Chow") }

## Breusch-Pagan
bptest(modelCH, data=bondyield, studentize=FALSE)
bptest(modelCH, data=bondyield)

## Fluctuation test
if(require(strucchange, quietly = TRUE)) {
sctest(modelCH, type="fluctuation", data=bondyield, rescale=FALSE)}

## RESET
reset(modelCH, data=bondyield)
reset(modelCH, power=2, type="regressor", data=bondyield)
reset(modelCH, type="princomp", data=bondyield)

## Harvey-Collier
harvtest(modelCH, order.by= ~ MOOD, data=bondyield)
harvtest(modelCH, order.by= ~ EPI, data=bondyield)
harvtest(modelCH, order.by= ~ EXP, data=bondyield)
harvtest(modelCH, order.by= ~ RUS, data=bondyield)

## Rainbow
raintest(modelCH, order.by = "mahalanobis", data=bondyield)


## page 136, fit test statistics in Table 6.6 d)
################################################

## Chow 1966(1)
if(require(strucchange, quietly = TRUE)) {
sctest(modelYM, point=c(1965,4), data=bondyield, type="Chow") }

## Fluctuation test
if(require(strucchange, quietly = TRUE)) {
sctest(modelYM, type="fluctuation", data=bondyield, rescale=FALSE) }

## RESET
reset(modelYM, data=bondyield)
reset(modelYM, power=2, type="regressor", data=bondyield)
reset(modelYM, type="princomp", data=bondyield)

## Harvey-Collier
harvtest(modelYM, order.by= ~ MOOD, data=bondyield)
harvtest(modelYM, order.by= ~ Y, data=bondyield)
harvtest(modelYM, order.by= ~ K, data=bondyield)

## Rainbow
raintest(modelYM, order.by = "mahalanobis", data=bondyield)
</code></pre>

<hr>
<h2 id='bptest'>Breusch-Pagan Test</h2><span id='topic+bptest'></span>

<h3>Description</h3>

<p>Performs the Breusch-Pagan test against heteroskedasticity.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bptest(formula, varformula = NULL, studentize = TRUE, data = list(), weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bptest_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model to be tested
(or a fitted <code>"lm"</code> object).</p>
</td></tr>
<tr><td><code id="bptest_+3A_varformula">varformula</code></td>
<td>
<p>a formula describing only the potential explanatory variables
for the variance (no dependent variable needed). By default the same
explanatory variables are taken as in the main regression model.</p>
</td></tr>
<tr><td><code id="bptest_+3A_studentize">studentize</code></td>
<td>
<p>logical. If set to <code>TRUE</code> Koenker's studentized
version of the test statistic will be used.</p>
</td></tr>
<tr><td><code id="bptest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which <code>bptest</code> is
called from.</p>
</td></tr>
<tr><td><code id="bptest_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Breusch-Pagan test fits a linear regression model to the residuals
of a linear regression model
(by default the same explanatory variables are taken as in the main regression
model) and rejects if too much of the variance
is explained by the additional explanatory variables.
</p>
<p>Under <code class="reqn">H_0</code> the test statistic of the Breusch-Pagan test follows a
chi-squared distribution with <code>parameter</code> (the number of regressors without
the constant in the model) degrees of freedom.
</p>
<p>Examples can not only be found on this page, but also on the help pages of the
data sets <code><a href="lmtest.html#topic+bondyield">bondyield</a></code>, <code><a href="lmtest.html#topic+currencysubstitution">currencysubstitution</a></code>,
<code><a href="lmtest.html#topic+growthofmoney">growthofmoney</a></code>, <code><a href="lmtest.html#topic+moneydemand">moneydemand</a></code>,
<code><a href="lmtest.html#topic+unemployment">unemployment</a></code>, <code><a href="lmtest.html#topic+wages">wages</a></code>.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was
performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>T.S. Breusch &amp; A.R. Pagan (1979),
A Simple Test for Heteroscedasticity and Random Coefficient Variation.
<em>Econometrica</em> <b>47</b>, 1287&ndash;1294
</p>
<p>R. Koenker (1981), A Note on Studentizing a Test for Heteroscedasticity.
<em>Journal of Econometrics</em> <b>17</b>, 107&ndash;112.
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="car.html#topic+ncvTest">ncvTest</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate a regressor
x &lt;- rep(c(-1,1), 50)
## generate heteroskedastic and homoskedastic disturbances
err1 &lt;- rnorm(100, sd=rep(c(1,2), 50))
err2 &lt;- rnorm(100)
## generate a linear relationship
y1 &lt;- 1 + x + err1
y2 &lt;- 1 + x + err2
## perform Breusch-Pagan test
bptest(y1 ~ x)
bptest(y2 ~ x)
</code></pre>

<hr>
<h2 id='ChickEgg'>Chickens, Eggs, and Causality</h2><span id='topic+ChickEgg'></span>

<h3>Description</h3>

<p>US chicken population and egg production.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ChickEgg)</code></pre>


<h3>Format</h3>

<p>An annual time series from 1930 to 1983 with 2 variables.
</p>

<dl>
<dt>chicken</dt><dd><p>number of chickens (December 1 population
of all US chickens excluding commercial broilers),</p>
</dd>
<dt>egg</dt><dd><p>number of eggs (US egg production in millions
of dozens).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data set was provided by Walter Thurman and made available
for R by Roger Koenker. Unfortunately, the data is slightly different
than the data analyzed in Thurman &amp; Fisher (1988).</p>


<h3>References</h3>

<p>Thurman W.N. &amp; Fisher M.E. (1988), Chickens, Eggs, and Causality, or
Which Came First?, <em>American Journal of Agricultural Economics</em>,
237-238.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Which came first: the chicken or the egg?
data(ChickEgg)
## chickens granger-cause eggs?
grangertest(egg ~ chicken, order = 3, data = ChickEgg)
## eggs granger-cause chickens?
grangertest(chicken ~ egg, order = 3, data = ChickEgg)

## To perform the same tests `by hand', you can use dynlm() and waldtest():
if(require(dynlm)) {
  ## chickens granger-cause eggs?
  em &lt;- dynlm(egg ~ L(egg, 1) + L(egg, 2) + L(egg, 3), data = ChickEgg)
  em2 &lt;- update(em, . ~ . + L(chicken, 1) + L(chicken, 2) + L(chicken, 3))
  waldtest(em, em2)

  ## eggs granger-cause chickens?
  cm &lt;- dynlm(chicken ~ L(chicken, 1) + L(chicken, 2) + L(chicken, 3), data = ChickEgg)
  cm2 &lt;- update(cm, . ~ . + L(egg, 1) + L(egg, 2) + L(egg, 3))
  waldtest(cm, cm2)
}
</code></pre>

<hr>
<h2 id='coeftest'>Inference for Estimated Coefficients</h2><span id='topic+coeftest'></span><span id='topic+coefci'></span><span id='topic+coeftest.default'></span><span id='topic+coeftest.survreg'></span><span id='topic+coeftest.glm'></span><span id='topic+coeftest.mlm'></span><span id='topic+coeftest.breakpointsfull'></span><span id='topic+print.coeftest'></span><span id='topic+confint.coeftest'></span><span id='topic+coef.coeftest'></span><span id='topic+df.residual.coeftest'></span><span id='topic+nobs.coeftest'></span><span id='topic+logLik.coeftest'></span><span id='topic+coefci.default'></span><span id='topic+coefci.survreg'></span><span id='topic+coefci.glm'></span><span id='topic+coefci.mlm'></span>

<h3>Description</h3>

<p><code>coeftest</code> is a generic function for performing 
z and (quasi-)t Wald tests of estimated coefficients.
<code>coefci</code> computes the corresponding Wald confidence
intervals. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coeftest(x, vcov. = NULL, df = NULL, ...)

## Default S3 method:
coeftest(x, vcov. = NULL, df = NULL, ..., save = FALSE)

coefci(x, parm = NULL, level = 0.95, vcov. = NULL, df = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coeftest_+3A_x">x</code></td>
<td>
<p>an object (for details see below).</p>
</td></tr>
<tr><td><code id="coeftest_+3A_vcov.">vcov.</code></td>
<td>
<p>a specification of the covariance
matrix of the estimated coefficients. This can be
specified as a matrix or as a function yielding
a matrix when applied to <code>x</code>.</p>
</td></tr>
<tr><td><code id="coeftest_+3A_df">df</code></td>
<td>
<p>the degrees of freedom to be used. If this
is a finite positive number a t test with <code>df</code>
degrees of freedom is performed. In all other cases,
a z test (using a normal approximation) is performed.
By default it tries to use <code>x$df.residual</code>
and performs a z test if this is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="coeftest_+3A_...">...</code></td>
<td>
<p>further arguments passed to the methods
and to <code>vcov.</code> in the default method.</p>
</td></tr>
<tr><td><code id="coeftest_+3A_save">save</code></td>
<td>
<p>logical. Should the object <code>x</code> itself be
saved as an attribute? (This may be useful for further
processing of <code>coeftest</code> objects, e.g., as part of
model summaries.)</p>
</td></tr>
<tr><td><code id="coeftest_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given
confidence intervals, either a vector of numbers or a vector
of names.  If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="coeftest_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic function <code>coeftest</code> currently has a default
method (which works in particular for <code>"lm"</code> objects) and
dedicated methods for objects of class
<code>"glm"</code> (as computed by <code><a href="stats.html#topic+glm">glm</a></code>),
<code>"mlm"</code> (as computed by <code><a href="stats.html#topic+lm">lm</a></code> with multivariate responses),
<code>"survreg"</code> (as computed by <code><a href="survival.html#topic+survreg">survreg</a></code>), and
<code>"breakpointsfull"</code> (as computed by <code><a href="strucchange.html#topic+breakpoints.formula">breakpoints.formula</a></code>).
</p>
<p>The default method assumes that a <code>coef</code> methods exists,
such that <code>coef(x)</code> yields the estimated coefficients.
</p>
<p>To specify the corresponding covariance matrix <code>vcov.</code> to be used, there
are three possibilities:
1. It is pre-computed and supplied in argument <code>vcov.</code>.
2. A function for extracting the covariance matrix from 
<code>x</code> is supplied, e.g., <code><a href="sandwich.html#topic+sandwich">sandwich</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>, <code><a href="sandwich.html#topic+vcovCL">vcovCL</a></code>,
or <code><a href="sandwich.html#topic+vcovHAC">vcovHAC</a></code> from package <span class="pkg">sandwich</span>.
3. <code>vcov.</code> is set to <code>NULL</code>, then it is assumed that
a <code>vcov</code> method exists, such that <code>vcov(x)</code> yields
a covariance matrix. Illustrations are provided in the examples below.
</p>
<p>The degrees of freedom <code>df</code> determine whether a normal
approximation is used or a t distribution with <code>df</code> degrees
of freedom. The default method computes <code>df.residual(x)</code>
and if this is <code>NULL</code>, <code>0</code>, or <code>Inf</code> a z test is performed.
The method for <code>"glm"</code> objects always uses <code>df = Inf</code> (i.e., a z test).
</p>
<p>The corresponding Wald confidence intervals can be computed either
by applying <code>coefci</code> to the original model or <code><a href="stats.html#topic+confint">confint</a></code>
to the output of <code>coeftest</code>. See below for examples.
</p>
<p>Finally, <code><a href="stats.html#topic+nobs">nobs</a></code> and <code><a href="stats.html#topic+logLik">logLik</a></code>
methods are provided which work, provided that there are such methods
for the original object <code>x</code>. In that case, <code>"nobs"</code> and
<code>"logLik"</code> attributes are stored in the <code>coeftest</code> output
so that they can be still queried subsequently. If both methods are
available, <code><a href="stats.html#topic+AIC">AIC</a></code> and <code><a href="stats.html#topic+BIC">BIC</a></code>
can also be applied.
</p>


<h3>Value</h3>

<p><code>coeftest</code> returns an object of class <code>"coeftest"</code> which
is essentially a coefficient matrix with columns containing the
estimates, associated standard errors, test statistics and p values.
Attributes for a <code>"method"</code> label, and the <code>"df"</code> are
added along with <code>"nobs"</code> and <code>"logLik"</code> (provided that
suitable extractor methods <code><a href="stats.html#topic+nobs">nobs</a></code> and
<code><a href="stats.html#topic+logLik">logLik</a></code> are available). Optionally, the full
object <code>x</code> can be <code>save</code>d in an attribute <code>"object"</code>
to facilitate further model summaries based on the <code>coeftest</code>
result.
</p>
<p><code>coefci</code> returns a matrix (or vector) with columns giving
lower and upper confidence limits for each parameter. These will
be labeled as (1-level)/2 and 1 - (1-level)/2 in percent.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+waldtest">waldtest</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data and fit model
data("Mandible", package = "lmtest")
fm &lt;- lm(length ~ age, data = Mandible, subset=(age &lt;= 28))

## the following commands lead to the same tests:
summary(fm)
(ct &lt;- coeftest(fm))

## a z test (instead of a t test) can be performed by
coeftest(fm, df = Inf)

## corresponding confidence intervals
confint(ct)
coefci(fm)
## which in this simple case is equivalent to
confint(fm)

## extract further model information either from
## the original model or from the coeftest output
nobs(fm)
nobs(ct)
logLik(fm)
logLik(ct)
AIC(fm, ct)
BIC(fm, ct)

if(require("sandwich")) {
## a different covariance matrix can be also used:
(ct &lt;- coeftest(fm, df = Inf, vcov = vcovHC))

## the corresponding confidence interval can be computed either as
confint(ct)
## or based on the original model
coefci(fm, df = Inf, vcov = vcovHC)

## note that the degrees of freedom _actually used_ can be extracted
df.residual(ct)
## which differ here from
df.residual(fm)

## vcov can also be supplied as a function with additional arguments
coeftest(fm, df = Inf, vcov = vcovHC, type = "HC0")
## or as a matrix
coeftest(fm, df = Inf, vcov = vcovHC(fm, type = "HC0"))
}
</code></pre>

<hr>
<h2 id='coxtest'>Cox Test for Comparing Non-Nested Models</h2><span id='topic+coxtest'></span>

<h3>Description</h3>

<p><code>coxtest</code> performs the Cox test for comparing two non-nested models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxtest(formula1, formula2, data = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxtest_+3A_formula1">formula1</code></td>
<td>
<p>either a symbolic description for the first model to be tested,
or a fitted object of class <code>"lm"</code>.</p>
</td></tr>
<tr><td><code id="coxtest_+3A_formula2">formula2</code></td>
<td>
<p>either a symbolic description for the second model to be tested,
or a fitted object of class <code>"lm"</code>.</p>
</td></tr>
<tr><td><code id="coxtest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the
model. By default the variables are taken from the environment
which <code>coxtest</code> is called from.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The idea of the Cox test is the following: if the first model contains
the correct set of regressors, then a fit of the regressors from the 
second model to the fitted values from first model should have no further
explanatory value. But if it has, it can be concluded that model 1 does not
contain the correct set of regressors.
</p>
<p>Hence, to compare both models the fitted values of model
1 are regressed on model 2 and vice versa. A Cox test statistic is computed
for each auxiliary model which is asymptotically standard normally distributed.
</p>
<p>For further details, see the references.  
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> which contains the estimate plus corresponding
standard error, z test statistic and p value for each auxiliary test.
</p>


<h3>References</h3>

<p>R. Davidson &amp; J. MacKinnon (1981). Several Tests for Model Specification in the
Presence of Alternative Hypotheses. <em>Econometrica</em>, <b>49</b>, 781-793.
</p>
<p>W. H. Greene (1993), <em>Econometric Analysis</em>, 2nd ed. Macmillan Publishing Company, New York.
</p>
<p>W. H. Greene (2003). <em>Econometric Analysis</em>, 5th ed. New Jersey, Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="lmtest.html#topic+jtest">jtest</a></code>, <code><a href="lmtest.html#topic+encomptest">encomptest</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit two competing, non-nested models for aggregate 
## consumption, as in Greene (1993), Examples 7.11 and 7.12

## load data and compute lags
data(USDistLag)
usdl &lt;- na.contiguous(cbind(USDistLag, lag(USDistLag, k = -1)))
colnames(usdl) &lt;- c("con", "gnp", "con1", "gnp1")

## C(t) = a0 + a1*Y(t) + a2*C(t-1) + u
fm1 &lt;- lm(con ~ gnp + con1, data = usdl)

## C(t) = b0 + b1*Y(t) + b2*Y(t-1) + v
fm2 &lt;- lm(con ~ gnp + gnp1, data = usdl)

## Cox test in both directions:
coxtest(fm1, fm2)

## ...and do the same for jtest() and encomptest().
## Notice that in this particular case they are coincident.
jtest(fm1, fm2)
encomptest(fm1, fm2)
</code></pre>

<hr>
<h2 id='currencysubstitution'> Currency Substitution </h2><span id='topic+currencysubstitution'></span>

<h3>Description</h3>

<p>Currency Substitution Data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(currencysubstitution)</code></pre>


<h3>Format</h3>

<p>A multivariate quarterly time series from 1960(4) to 1975(4) with variables
</p>

<dl>
<dt>logCUS</dt><dd><p>logarithm of the ratio of Canadian holdings of Canadian
dollar balances and Canadian holdings of U.S. dollar balances,</p>
</dd>
<dt>Iu</dt><dd><p>yield on U.S. Treasury bills,</p>
</dd>
<dt>Ic</dt><dd><p>yield on Canadian Treasury bills,</p>
</dd>
<dt>logY</dt><dd><p>logarithm of Canadian real gross national product.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data was originally studied by Miles (1978), the data set is given in
Krämer and Sonnberger (1986). Below we replicate a few examples 
from their book.
Some of these results differ more or less seriously and are sometimes
parameterized differently.
</p>


<h3>References</h3>

<p>M. Miles (1978),
Currency Substitution, Flexible Exchange Rates, and Monetary Independence.
<em>American Economic Review</em> <b>68</b>, 428&ndash;436
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(currencysubstitution)

## page 130, fit Miles OLS model and Bordo-Choudri OLS model
## third and last line in Table 6.3

modelMiles &lt;- logCUS ~ log((1+Iu)/(1+Ic))
lm(modelMiles, data=currencysubstitution)
dwtest(modelMiles, data=currencysubstitution)

modelBordoChoudri &lt;- logCUS ~ I(Iu-Ic) + Ic + logY
lm(modelBordoChoudri, data=currencysubstitution)
dwtest(modelBordoChoudri, data=currencysubstitution)


## page 131, fit test statistics in Table 6.4 b)
################################################

if(require(strucchange, quietly = TRUE)) {
## Fluctuation test
sctest(modelMiles, type="fluctuation", data=currencysubstitution,
 rescale=FALSE) }

## RESET
reset(modelMiles, data=currencysubstitution)
reset(modelMiles, power=2, type="regressor", data=currencysubstitution)
reset(modelMiles, type="princomp", data=currencysubstitution)

## Harvey-Collier
harvtest(modelMiles, order.by = ~log((1+Iu)/(1+Ic)), data=currencysubstitution)

## Rainbow
raintest(modelMiles, order.by = "mahalanobis", data=currencysubstitution)


## page 132, fit test statistics in Table 6.4 d)
################################################

if(require(strucchange, quietly = TRUE)) {
## Chow 1970(2)
sctest(modelBordoChoudri, point=c(1970,2), data=currencysubstitution,
 type="Chow") }

## Breusch-Pagan
bptest(modelBordoChoudri, data=currencysubstitution, studentize=FALSE)
bptest(modelBordoChoudri, data=currencysubstitution)

## RESET
reset(modelBordoChoudri, data=currencysubstitution)
reset(modelBordoChoudri, power=2, type="regressor", data=currencysubstitution)
reset(modelBordoChoudri, type="princomp", data=currencysubstitution)

## Harvey-Collier
harvtest(modelBordoChoudri, order.by = ~ I(Iu-Ic), data=currencysubstitution)
harvtest(modelBordoChoudri, order.by = ~ Ic, data=currencysubstitution)
harvtest(modelBordoChoudri, order.by = ~ logY, data=currencysubstitution)

## Rainbow
raintest(modelBordoChoudri, order.by = "mahalanobis", data=currencysubstitution)
</code></pre>

<hr>
<h2 id='dwtest'>Durbin-Watson Test</h2><span id='topic+dwtest'></span>

<h3>Description</h3>

<p>Performs the Durbin-Watson test for autocorrelation of disturbances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwtest(formula, order.by = NULL, alternative = c("greater", "two.sided", "less"),
       iterations = 15, exact = NULL, tol = 1e-10, data = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dwtest_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model to be tested
(or a fitted <code>"lm"</code> object).</p>
</td></tr>
<tr><td><code id="dwtest_+3A_order.by">order.by</code></td>
<td>
<p>Either a vector <code>z</code> or a formula with a single explanatory
variable like <code>~ z</code>. The observations in the model
are ordered by the size of <code>z</code>. If set to <code>NULL</code> (the
default) the observations are assumed to be ordered (e.g., a
time series).</p>
</td></tr>
<tr><td><code id="dwtest_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="dwtest_+3A_iterations">iterations</code></td>
<td>
<p>an integer specifying the number of iterations
when calculating the p-value with the &quot;pan&quot; algorithm.</p>
</td></tr>
<tr><td><code id="dwtest_+3A_exact">exact</code></td>
<td>
<p>logical. If set to <code>FALSE</code> a normal approximation
will be used to compute the p value, if <code>TRUE</code> the &quot;pan&quot;
algorithm is used. The default is to use &quot;pan&quot; if the sample size
is &lt; 100.</p>
</td></tr>
<tr><td><code id="dwtest_+3A_tol">tol</code></td>
<td>
<p>tolerance. Eigenvalues computed have to be greater than
<code>tol</code> to be treated as non-zero.</p>
</td></tr>
<tr><td><code id="dwtest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which <code>dwtest</code>
is called from.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Durbin-Watson test has the null hypothesis that the autocorrelation
of the disturbances is 0. It is possible to test against the alternative that it is
greater than, not equal to, or less than 0, respectively. This can be specified
by the <code>alternative</code> argument.
</p>
<p>Under the assumption of normally distributed disturbances, the null distribution 
of the Durbin-Watson statistic is the distribution of a linear
combination of chi-squared variables. The p-value is computed using the
Fortran version of Applied Statistics Algorithm AS 153 by Farebrother
(1980, 1984). This algorithm is called &quot;pan&quot; or &quot;gradsol&quot;. For large sample
sizes the algorithm might fail to compute the p value; in that case a warning
is printed and an approximate p value will be given; this p value is computed
using a normal approximation with mean and variance of the Durbin-Watson test
statistic.
</p>
<p>Examples can not only be found on this page, but also on the help pages of the
data sets <code><a href="lmtest.html#topic+bondyield">bondyield</a></code>, <code><a href="lmtest.html#topic+currencysubstitution">currencysubstitution</a></code>,
<code><a href="lmtest.html#topic+growthofmoney">growthofmoney</a></code>, <code><a href="lmtest.html#topic+moneydemand">moneydemand</a></code>,
<code><a href="lmtest.html#topic+unemployment">unemployment</a></code>, <code><a href="lmtest.html#topic+wages">wages</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code> containing:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string with the method used.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the corresponding p-value.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string with the data name.</p>
</td></tr>
</table>


<h3>References</h3>

<p>J. Durbin &amp; G.S. Watson (1950),
Testing for Serial Correlation in Least Squares Regression I.
<em>Biometrika</em> <b>37</b>, 409&ndash;428.
</p>
<p>J. Durbin &amp; G.S. Watson (1951),
Testing for Serial Correlation in Least Squares Regression II.
<em>Biometrika</em> <b>38</b>, 159&ndash;177.
</p>
<p>J. Durbin &amp; G.S. Watson (1971),
Testing for Serial Correlation in Least Squares Regression III.
<em>Biometrika</em> <b>58</b>, 1&ndash;19.
</p>
<p>R.W. Farebrother (1980),
Pan's Procedure for the Tail Probabilities of the
Durbin-Watson Statistic (Corr: 81V30 p189; AS R52: 84V33 p363- 366; AS
R53: 84V33 p366- 369).
<em>Applied Statistics</em> <b>29</b>,  224&ndash;227.
</p>
<p>R. W. Farebrother (1984),
[AS R53] A Remark on Algorithms AS 106 (77V26 p92-98), AS 153 (80V29 p224-227)
and AS 155: The Distribution of a Linear Combination of <code class="reqn">\chi^2</code> Random
Variables (80V29 p323-333)
<em>Applied Statistics</em> <b>33</b>, 366&ndash;369.
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## generate two AR(1) error terms with parameter
## rho = 0 (white noise) and rho = 0.9 respectively
err1 &lt;- rnorm(100)

## generate regressor and dependent variable
x &lt;- rep(c(-1,1), 50)
y1 &lt;- 1 + x + err1

## perform Durbin-Watson test
dwtest(y1 ~ x)

err2 &lt;- filter(err1, 0.9, method="recursive")
y2 &lt;- 1 + x + err2
dwtest(y2 ~ x)

</code></pre>

<hr>
<h2 id='encomptest'>Encompassing Test for Comparing Non-Nested Models</h2><span id='topic+encomptest'></span>

<h3>Description</h3>

<p><code>encomptest</code> performs the encompassing test of Davidson &amp; MacKinnon
for comparing non-nested models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> encomptest(formula1, formula2, data = list(), vcov. = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="encomptest_+3A_formula1">formula1</code></td>
<td>
<p>either a symbolic description for the first model to be tested,
or a fitted object of class <code>"lm"</code>.</p>
</td></tr>
<tr><td><code id="encomptest_+3A_formula2">formula2</code></td>
<td>
<p>either a symbolic description for the second model to be tested,
or a fitted object of class <code>"lm"</code>.</p>
</td></tr>
<tr><td><code id="encomptest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the
model. By default the variables are taken from the environment
which <code>encomptest</code> is called from.</p>
</td></tr>
<tr><td><code id="encomptest_+3A_vcov.">vcov.</code></td>
<td>
<p>a function for estimating the covariance matrix of the regression
coefficients, e.g., <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>.</p>
</td></tr>
<tr><td><code id="encomptest_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="lmtest.html#topic+waldtest">waldtest</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To compare two non-nested models, the encompassing test fits an encompassing
model which contains all regressors from both models such that the two
models are nested within the encompassing model. A Wald test for comparing
each of the models with the encompassing model is carried out by <code><a href="lmtest.html#topic+waldtest">waldtest</a></code>.
</p>
<p>For further details, see the references.  
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> which contains the residual degrees of freedom
in the encompassing model, the difference in degrees of freedom, Wald statistic
(either <code>"F"</code> or <code>"Chisq"</code>) and corresponding p value.
</p>


<h3>References</h3>

<p>R. Davidson &amp; J. MacKinnon (1993). <em>Estimation and Inference in Econometrics</em>.
New York, Oxford University Press.
</p>
<p>W. H. Greene (1993), <em>Econometric Analysis</em>, 2nd ed. Macmillan Publishing Company, New York.
</p>
<p>W. H. Greene (2003). <em>Econometric Analysis</em>, 5th ed. New Jersey, Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="lmtest.html#topic+coxtest">coxtest</a></code>, <code><a href="lmtest.html#topic+jtest">jtest</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit two competing, non-nested models for aggregate 
## consumption, as in Greene (1993), Examples 7.11 and 7.12

## load data and compute lags
data(USDistLag)
usdl &lt;- na.contiguous(cbind(USDistLag, lag(USDistLag, k = -1)))
colnames(usdl) &lt;- c("con", "gnp", "con1", "gnp1")

## C(t) = a0 + a1*Y(t) + a2*C(t-1) + u
fm1 &lt;- lm(con ~ gnp + con1, data = usdl)

## C(t) = b0 + b1*Y(t) + b2*Y(t-1) + v
fm2 &lt;- lm(con ~ gnp + gnp1, data = usdl)

## Encompassing model
fm3 &lt;- lm(con ~ gnp + con1 + gnp1, data = usdl)

## Cox test in both directions:
coxtest(fm1, fm2)

## ...and do the same for jtest() and encomptest().
## Notice that in this particular case they are coincident.
jtest(fm1, fm2)
encomptest(fm1, fm2)

## the encompassing test is essentially
waldtest(fm1, fm3, fm2)
</code></pre>

<hr>
<h2 id='ftemp'>Femal Temperature Data</h2><span id='topic+ftemp'></span>

<h3>Description</h3>

<p>Daily morning temperature of adult female (in degrees Celsius).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ftemp)</code></pre>


<h3>Format</h3>

<p>Univariate daily time series of 60 observations starting from 1990-07-11.
</p>


<h3>Details</h3>

<p>The data gives the daily morning temperature of an adult woman
measured in degrees Celsius at about 6.30am each morning.
</p>
<p>At the start of the period the woman was sick, hence the high temperature.
Then the usual monthly cycle can be seen. On the second cycle, the temperature
doesn't complete the downward part of the pattern due to a conception.
</p>


<h3>Source</h3>

<p>The data set was taken from the Time Series Data Library, maintained by Rob Hyndman.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ftemp)
plot(ftemp)
y &lt;- window(ftemp, start = 8, end = 60)
if(require(strucchange)) {
  bp &lt;- breakpoints(y ~ 1)
  plot(bp)
  fm.seg &lt;- lm(y ~ 0 + breakfactor(bp))
  plot(y)
  lines(8:60, fitted(fm.seg), col = 4)
  lines(confint(bp))
}

</code></pre>

<hr>
<h2 id='gqtest'>Goldfeld-Quandt Test</h2><span id='topic+gqtest'></span>

<h3>Description</h3>

<p>Goldfeld-Quandt test against heteroskedasticity.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gqtest(formula, point = 0.5, fraction = 0,
  alternative = c("greater", "two.sided", "less"),
  order.by = NULL, data = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gqtest_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model to be tested
(or a fitted <code>"lm"</code> object).</p>
</td></tr>
<tr><td><code id="gqtest_+3A_point">point</code></td>
<td>
<p>numerical. If <code>point</code> is smaller than 1 it is
interpreted as percentages of data, i.e. <code>n*point</code> is
taken to be the (potential) breakpoint in the variances, if
<code>n</code> is the number of observations in the model. If <code>point</code>
is greater than 1 it is interpreted to be the index of the breakpoint.</p>
</td></tr>
<tr><td><code id="gqtest_+3A_fraction">fraction</code></td>
<td>
<p>numerical. The number of central observations to be omitted.
If <code>fraction</code> is smaller than 1, it is chosen to be <code>fraction*n</code>
if <code>n</code> is the number of observations in the model.</p>
</td></tr>
<tr><td><code id="gqtest_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis.
The default is to test for increasing variances.</p>
</td></tr>
<tr><td><code id="gqtest_+3A_order.by">order.by</code></td>
<td>
<p>Either a vector <code>z</code> or a formula with a single explanatory
variable like <code>~ z</code>. The observations in the model
are ordered by the size of <code>z</code>. If set to <code>NULL</code> (the
default) the observations are assumed to be ordered (e.g., a
time series).</p>
</td></tr>
<tr><td><code id="gqtest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which <code>gqtest</code>
is called from.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Goldfeld-Quandt test compares the variances of two submodels
divided by a specified breakpoint and rejects if the variances differ.
</p>
<p>Under <code class="reqn">H_0</code> the test statistic of the Goldfeld-Quandt test follows an F
distribution with the degrees of freedom as given in <code>parameter</code>.
</p>
<p>Examples can not only be found on this page, but also on the help pages of the
data sets <code><a href="lmtest.html#topic+bondyield">bondyield</a></code>, <code><a href="lmtest.html#topic+currencysubstitution">currencysubstitution</a></code>,
<code><a href="lmtest.html#topic+growthofmoney">growthofmoney</a></code>, <code><a href="lmtest.html#topic+moneydemand">moneydemand</a></code>,
<code><a href="lmtest.html#topic+unemployment">unemployment</a></code>, <code><a href="lmtest.html#topic+wages">wages</a></code>.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was performed.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>S.M. Goldfeld &amp; R.E. Quandt (1965),
Some Tests for Homoskedasticity.
<em>Journal of the American Statistical Association</em> <b>60</b>, 539&ndash;547
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate a regressor
x &lt;- rep(c(-1,1), 50)
## generate heteroskedastic and homoskedastic disturbances
err1 &lt;- c(rnorm(50, sd=1), rnorm(50, sd=2))
err2 &lt;- rnorm(100)
## generate a linear relationship
y1 &lt;- 1 + x + err1
y2 &lt;- 1 + x + err2
## perform Goldfeld-Quandt test
gqtest(y1 ~ x)
gqtest(y2 ~ x)
</code></pre>

<hr>
<h2 id='grangertest'>Test for Granger Causality</h2><span id='topic+grangertest'></span><span id='topic+grangertest.default'></span><span id='topic+grangertest.formula'></span>

<h3>Description</h3>

<p><code>grangertest</code> is a generic function for performing 
a test for Granger causality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
grangertest(x, y, order = 1, na.action = na.omit, ...)
## S3 method for class 'formula'
grangertest(formula, data = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grangertest_+3A_x">x</code></td>
<td>
<p>either a bivariate series (in which case <code>y</code> has
to be missing) or a univariate series of observations.</p>
</td></tr>
<tr><td><code id="grangertest_+3A_y">y</code></td>
<td>
<p>a univariate series of observations (if <code>x</code> is
univariate, too).</p>
</td></tr>
<tr><td><code id="grangertest_+3A_order">order</code></td>
<td>
<p>integer specifying th order of lags to include
in the auxiliary regression.</p>
</td></tr>
<tr><td><code id="grangertest_+3A_na.action">na.action</code></td>
<td>
<p>a function for eliminating <code>NA</code>s
after aligning the series <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="grangertest_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="lmtest.html#topic+waldtest">waldtest</a></code>.</p>
</td></tr>
<tr><td><code id="grangertest_+3A_formula">formula</code></td>
<td>
<p>a formula specification of a bivariate series like <code>y ~ x</code>.</p>
</td></tr>
<tr><td><code id="grangertest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the
model. By default the variables are taken from the environment
which <code>grangertest</code> is called from.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>Currently, the methods for the generic function <code>grangertest</code> only
perform tests for Granger causality in bivariate series. The test is simply
a Wald test comparing the unrestricted model&mdash;in which <code>y</code> is explained
by the lags (up to order <code>order</code>) of <code>y</code> and <code>x</code>&mdash;and the
restricted model&mdash;in which <code>y</code> is only explained by the lags of <code>y</code>.
</p>
<p>Both methods are simply convenience interfaces to <code><a href="lmtest.html#topic+waldtest">waldtest</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> which contains the residual degrees of freedom,
the difference in degrees of freedom, Wald statistic and corresponding p value.
</p>


<h3>See Also</h3>

<p><code><a href="lmtest.html#topic+waldtest">waldtest</a></code>, <code><a href="lmtest.html#topic+ChickEgg">ChickEgg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Which came first: the chicken or the egg?
data(ChickEgg)
grangertest(egg ~ chicken, order = 3, data = ChickEgg)
grangertest(chicken ~ egg, order = 3, data = ChickEgg)

## alternative ways of specifying the same test
grangertest(ChickEgg, order = 3)
grangertest(ChickEgg[, 1], ChickEgg[, 2], order = 3)
</code></pre>

<hr>
<h2 id='growthofmoney'>Growth of Money Supply</h2><span id='topic+growthofmoney'></span>

<h3>Description</h3>

<p>Growth of Money Supply Data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(growthofmoney)</code></pre>


<h3>Format</h3>

<p>A multivariate quarterly time series from 1970(2) to 1974(4) with variables
</p>

<dl>
<dt>TG1.TG0</dt><dd><p>difference of current and preceding target for the growth
rate of the
money supply,</p>
</dd>
<dt>AG0.TG0</dt><dd><p>difference of actual growth rate and target growth
rate for the preceding period.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data was originally studied by Hetzel (1981), the data set is given in
Krämer and Sonnberger (1986). Below we replicate a few examples from their
book.
Some of these results differ more or less seriously and are sometimes
parameterized differently.
</p>


<h3>References</h3>

<p>R.L. Hetzel (1981),
The Federal Reserve System and Control of the Money Supply in the 1970's.
<em>Journal of Money, Credit and Banking</em> <b>13</b>, 31&ndash;43
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(growthofmoney)

## page 137, fit Hetzel OLS model
## first/second line in Table 6.7

modelHetzel &lt;- TG1.TG0 ~ AG0.TG0
lm(modelHetzel, data=growthofmoney)
dwtest(modelHetzel, data=growthofmoney)


## page 135, fit test statistics in Table 6.8
#############################################

if(require(strucchange, quietly = TRUE)) {
## Chow 1974(1)
sctest(modelHetzel, point=c(1973,4), data=growthofmoney, type="Chow") }

## RESET
reset(modelHetzel, data=growthofmoney)
reset(modelHetzel, power=2, type="regressor", data=growthofmoney)
reset(modelHetzel, type="princomp", data=growthofmoney)

## Harvey-Collier
harvtest(modelHetzel, order.by= ~ AG0.TG0, data=growthofmoney)

## Rainbow
raintest(modelHetzel, order.by = "mahalanobis", data=growthofmoney)


## Identification of outliers
#############################

## Figure 6.1
plot(modelHetzel, data=growthofmoney)
abline(v=0)
abline(h=0)
abline(coef(lm(modelHetzel, data=growthofmoney)), col=2)

## Table 6.7, last line
growthofmoney2 &lt;- as.data.frame(growthofmoney[-c(5:6),])
lm(modelHetzel, data=growthofmoney2)
dwtest(modelHetzel, data=growthofmoney2)
</code></pre>

<hr>
<h2 id='harvtest'>Harvey-Collier Test</h2><span id='topic+harvtest'></span>

<h3>Description</h3>

<p>Harvey-Collier test for linearity.</p>


<h3>Usage</h3>

<pre><code class='language-R'>harvtest(formula, order.by = NULL, data = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="harvtest_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model to be tested
(or a fitted <code>"lm"</code> object).</p>
</td></tr>
<tr><td><code id="harvtest_+3A_order.by">order.by</code></td>
<td>
<p>Either a vector <code>z</code> or a formula with a single explanatory
variable like <code>~ z</code>. The observations in the model
are ordered by the size of <code>z</code>. If set to <code>NULL</code> (the
default) the observations are assumed to be ordered (e.g., a
time series).</p>
</td></tr>
<tr><td><code id="harvtest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which
<code>harvtest</code> is called from.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Harvey-Collier test performs a t-test (with <code>parameter</code> degrees of
freedom) on the recursive residuals. If the true relationship is not linear but
convex or concave the mean of the recursive residuals should differ
from 0 significantly.
</p>
<p>Examples can not only be found on this page, but also on the help pages of the
data sets <code><a href="lmtest.html#topic+bondyield">bondyield</a></code>, <code><a href="lmtest.html#topic+currencysubstitution">currencysubstitution</a></code>,
<code><a href="lmtest.html#topic+growthofmoney">growthofmoney</a></code>, <code><a href="lmtest.html#topic+moneydemand">moneydemand</a></code>,
<code><a href="lmtest.html#topic+unemployment">unemployment</a></code>,
<code><a href="lmtest.html#topic+wages">wages</a></code>.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was
performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. Harvey &amp; P. Collier (1977),
Testing for Functional Misspecification in Regression Analysis.
<em>Journal of Econometrics</em> <b>6</b>, 103&ndash;119
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># generate a regressor and dependent variable
x &lt;- 1:50
y1 &lt;- 1 + x + rnorm(50)
y2 &lt;- y1 + 0.3*x^2

## perform Harvey-Collier test
harv &lt;- harvtest(y1 ~ x)
harv
## calculate critical value vor 0.05 level
qt(0.95, harv$parameter)
harvtest(y2 ~ x)
</code></pre>

<hr>
<h2 id='hmctest'>Harrison-McCabe test</h2><span id='topic+hmctest'></span>

<h3>Description</h3>

<p>Harrison-McCabe test for heteroskedasticity.</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmctest(formula, point = 0.5, order.by = NULL, simulate.p = TRUE, nsim = 1000,
  plot = FALSE, data = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmctest_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model to be tested
(or a fitted <code>"lm"</code> object).</p>
</td></tr>
<tr><td><code id="hmctest_+3A_point">point</code></td>
<td>
<p>numeric. If <code>point</code> is smaller than 1 it is
interpreted as percentages of data, i.e. <code>n*point</code> is
taken to be the (potential) breakpoint in the variances, if
<code>n</code> is the number of observations in the model. If <code>point</code>
is greater than 1 it is interpreted to be the index of the breakpoint.</p>
</td></tr>
<tr><td><code id="hmctest_+3A_order.by">order.by</code></td>
<td>
<p>Either a vector <code>z</code> or a formula with a single explanatory
variable like <code>~ z</code>. The observations in the model
are ordered by the size of <code>z</code>. If set to <code>NULL</code> (the
default) the observations are assumed to be ordered (e.g., a
time series).</p>
</td></tr>
<tr><td><code id="hmctest_+3A_simulate.p">simulate.p</code></td>
<td>
<p>logical. If <code>TRUE</code> a p value will be assessed
by simulation, otherwise the p value is <code>NA</code>.</p>
</td></tr>
<tr><td><code id="hmctest_+3A_nsim">nsim</code></td>
<td>
<p>integer. Determines how many runs are used to simulate the
p value.</p>
</td></tr>
<tr><td><code id="hmctest_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> the test statistic for all possible
breakpoints is plotted.</p>
</td></tr>
<tr><td><code id="hmctest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which <code>hmctest</code>
is called from.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Harrison-McCabe test statistic is the fraction of the residual sum
of
squares that relates to the fraction of the data before the breakpoint. Under
<code class="reqn">H_0</code>
the test statistic should be close to the size of this fraction, e.g. in the
default
case close to 0.5. The null hypothesis is reject if the statistic is too small.
</p>
<p>Examples can not only be found on this page, but also on the help pages of the
data sets <code><a href="lmtest.html#topic+bondyield">bondyield</a></code>, <code><a href="lmtest.html#topic+currencysubstitution">currencysubstitution</a></code>,
<code><a href="lmtest.html#topic+growthofmoney">growthofmoney</a></code>, <code><a href="lmtest.html#topic+moneydemand">moneydemand</a></code>,
<code><a href="lmtest.html#topic+unemployment">unemployment</a></code>,
<code><a href="lmtest.html#topic+wages">wages</a></code>.</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the simulated p-value of the test.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was
performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>M.J. Harrison &amp; B.P.M McCabe (1979),
A Test for Heteroscedasticity based on Ordinary Least Squares Residuals.
<em>Journal of the American Statistical Association</em> <b>74</b>, 494&ndash;499
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate a regressor
x &lt;- rep(c(-1,1), 50)
## generate heteroskedastic and homoskedastic disturbances
err1 &lt;- c(rnorm(50, sd=1), rnorm(50, sd=2))
err2 &lt;- rnorm(100)
## generate a linear relationship
y1 &lt;- 1 + x + err1
y2 &lt;- 1 + x + err2
## perform Harrison-McCabe test
hmctest(y1 ~ x)
hmctest(y2 ~ x)
</code></pre>

<hr>
<h2 id='jocci'>U.S. Macroeconomic Time Series</h2><span id='topic+fyff'></span><span id='topic+gmdc'></span><span id='topic+ip'></span><span id='topic+jocci'></span><span id='topic+lhur'></span><span id='topic+pw561'></span>

<h3>Description</h3>

<p>Several macroeconomic time series from the U.S.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fyff)
data(gmdc)
data(ip)
data(jocci)
data(lhur)
data(pw561)
</code></pre>


<h3>Format</h3>

<p>All data sets are multivariate monthly time series from
1959(8) to 1993(12) (except 1993(10) for <code>jocci</code>) with variables
</p>

<dl>
<dt>y</dt><dd><p>original time series,</p>
</dd>
<dt>dy</dt><dd><p>transformed times series (first differences
or log first differences),</p>
</dd>
<dt>dy1</dt><dd><p>transformed series at lag 1,</p>
</dd>
<dt>dy2</dt><dd><p>transformed series at lag 2,</p>
</dd>
<dt>dy3</dt><dd><p>transformed series at lag 3,</p>
</dd>
<dt>dy4</dt><dd><p>transformed series at lag 4,</p>
</dd>
<dt>dy5</dt><dd><p>transformed series at lag 5,</p>
</dd>
<dt>dy6</dt><dd><p>transformed series at lag 6.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The description from Stock &amp; Watson (1996) for the time series
(with the transformation used):
</p>

<dl>
<dt>fyff</dt><dd><p>interest rate (first differences),</p>
</dd>
<dt>gmdc</dt><dd><p>pce, implicit price deflator: pce (1987 = 100) (log first differences),</p>
</dd>
<dt>ip</dt><dd><p>index of industrial production (log first differences),</p>
</dd>
<dt>jocci</dt><dd><p>department of commerce commodity price index (log first differences),</p>
</dd>
<dt>lhur</dt><dd><p>unemployment rate: all workers, 16 years &amp; over (%, sa) (first differences),</p>
</dd>
<dt>pw561</dt><dd><p>producer price index: crude petroleum (82 = 100, nsa) (log first differences).</p>
</dd>
</dl>

<p>Stock &amp; Watson (1996) fitted an AR(6) model to all transformed time series.
</p>


<h3>Source</h3>

<p>Stock &amp; Watson (1996) study the stability of 76 macroeconomic time series, which can be obtained
from Mark W. Watson's homepage at <a href="http://www.princeton.edu/~mwatson/ddisk/bivtvp.zip">http://www.princeton.edu/~mwatson/ddisk/bivtvp.zip</a>.
</p>


<h3>References</h3>

<p>J.H. Stock &amp; M.W. Watson (1996),
Evidence on Structural Instability in Macroeconomic Time Series Relations.
<em>Journal of Business &amp; Economic Statistics</em> <b>14</b>, 11&ndash;30.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(jocci)

dwtest(dy ~ 1, data = jocci)
bgtest(dy ~ 1, data = jocci)
ar6.model &lt;- dy ~ dy1 + dy2 + dy3 + dy4 + dy5 +dy6
bgtest(ar6.model, data = jocci)

var.model &lt;- ~ I(dy1^2) + I(dy2^2) + I(dy3^2) + I(dy4^2) + I(dy5^2) + I(dy6^2)
bptest(ar6.model, var.model, data = jocci)
</code></pre>

<hr>
<h2 id='jtest'>J Test for Comparing Non-Nested Models</h2><span id='topic+jtest'></span>

<h3>Description</h3>

<p><code>jtest</code> performs the Davidson-MacKinnon J test for comparing non-nested
models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> jtest(formula1, formula2, data = list(), vcov. = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jtest_+3A_formula1">formula1</code></td>
<td>
<p>either a symbolic description for the first model to be tested,
or a fitted object of class <code>"lm"</code>.</p>
</td></tr>
<tr><td><code id="jtest_+3A_formula2">formula2</code></td>
<td>
<p>either a symbolic description for the second model to be tested,
or a fitted object of class <code>"lm"</code>.</p>
</td></tr>
<tr><td><code id="jtest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the
model. By default the variables are taken from the environment
which <code>jtest</code> is called from.</p>
</td></tr>
<tr><td><code id="jtest_+3A_vcov.">vcov.</code></td>
<td>
<p>a function for estimating the covariance matrix of the regression
coefficients, e.g., <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>.</p>
</td></tr>
<tr><td><code id="jtest_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The idea of the J test is the following: if the first model contains
the correct set of regressors, then including the fitted values of the
second model into the set of regressors should provide no significant 
improvement. But if it does, it can be concluded that model 1 does not
contain the correct set of regressors.
</p>
<p>Hence, to compare both models the fitted values of model
1 are included into model 2 and vice versa. The J test statistic is simply
the marginal test of the fitted values in the augmented model. This is
performed by <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>.
</p>
<p>For further details, see the references.  
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> which contains the coefficient estimate
of the fitted values in the augmented regression plus corresponding
standard error, test statistic and p value.
</p>


<h3>References</h3>

<p>R. Davidson &amp; J. MacKinnon (1981). Several Tests for Model Specification in the
Presence of Alternative Hypotheses. <em>Econometrica</em>, <b>49</b>, 781-793.
</p>
<p>W. H. Greene (1993), <em>Econometric Analysis</em>, 2nd ed. Macmillan Publishing Company, New York.
</p>
<p>W. H. Greene (2003). <em>Econometric Analysis</em>, 5th ed. New Jersey, Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="lmtest.html#topic+coxtest">coxtest</a></code>, <code><a href="lmtest.html#topic+encomptest">encomptest</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit two competing, non-nested models for aggregate 
## consumption, as in Greene (1993), Examples 7.11 and 7.12

## load data and compute lags
data(USDistLag)
usdl &lt;- na.contiguous(cbind(USDistLag, lag(USDistLag, k = -1)))
colnames(usdl) &lt;- c("con", "gnp", "con1", "gnp1")

## C(t) = a0 + a1*Y(t) + a2*C(t-1) + u
fm1 &lt;- lm(con ~ gnp + con1, data = usdl)

## C(t) = b0 + b1*Y(t) + b2*Y(t-1) + v
fm2 &lt;- lm(con ~ gnp + gnp1, data = usdl)

## Cox test in both directions:
coxtest(fm1, fm2)

## ...and do the same for jtest() and encomptest().
## Notice that in this particular case they are coincident.
jtest(fm1, fm2)
encomptest(fm1, fm2)
</code></pre>

<hr>
<h2 id='lrtest'>Likelihood Ratio Test of Nested Models</h2><span id='topic+lrtest'></span><span id='topic+lrtest.formula'></span><span id='topic+lrtest.default'></span>

<h3>Description</h3>

<p><code>lrtest</code> is a generic function for carrying out likelihood ratio tests.
The default method can be employed for comparing nested (generalized)
linear models (see details below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'> lrtest(object, ...)

 ## Default S3 method:
lrtest(object, ..., name = NULL) 

 ## S3 method for class 'formula'
lrtest(object, ..., data = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrtest_+3A_object">object</code></td>
<td>
<p>an object. See below for details.</p>
</td></tr>
<tr><td><code id="lrtest_+3A_...">...</code></td>
<td>
<p>further object specifications passed to methods. See below for details.</p>
</td></tr>
<tr><td><code id="lrtest_+3A_name">name</code></td>
<td>
<p>a function for extracting a suitable name/description from
a fitted model object. By default the name is queried by calling
<code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="lrtest_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lrtest</code> is intended to be a generic function for comparisons
of models via asymptotic likelihood ratio tests. The default method consecutively compares
the fitted model object <code>object</code> with the models passed in <code>...</code>.
Instead of passing the fitted model objects in <code>...</code>, several other
specifications are possible. The updating mechanism is the same as for <code><a href="lmtest.html#topic+waldtest">waldtest</a></code>:
the models in <code>...</code> can be specified as integers, characters
(both for terms that should be eliminated from the previous model), update formulas or
fitted model objects. Except for the last case, the existence of an <code><a href="stats.html#topic+update">update</a></code>
method is assumed. See <code><a href="lmtest.html#topic+waldtest">waldtest</a></code> for details.
</p>
<p>Subsequently, an asymptotic likelihood ratio test for each two consecutive models is carried out:
Twice the difference in log-likelihoods (as derived by the <code><a href="stats.html#topic+logLik">logLik</a></code> methods)
is compared with a Chi-squared distribution.
</p>
<p>The <code>"formula"</code> method fits a <code><a href="stats.html#topic+lm">lm</a></code> first and then calls the default 
method.
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> which contains the log-likelihood, degrees of freedom,
the difference in degrees of freedom, likelihood ratio Chi-squared statistic and corresponding p value.
</p>


<h3>See Also</h3>

<p><code><a href="lmtest.html#topic+waldtest">waldtest</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## with data from Greene (1993):
## load data and compute lags
data("USDistLag")
usdl &lt;- na.contiguous(cbind(USDistLag, lag(USDistLag, k = -1)))
colnames(usdl) &lt;- c("con", "gnp", "con1", "gnp1")

fm1 &lt;- lm(con ~ gnp + gnp1, data = usdl)
fm2 &lt;- lm(con ~ gnp + con1 + gnp1, data = usdl)

## various equivalent specifications of the LR test
lrtest(fm2, fm1)
lrtest(fm2, 2)
lrtest(fm2, "con1")
lrtest(fm2, . ~ . - con1)
</code></pre>

<hr>
<h2 id='Mandible'>Mandible Data</h2><span id='topic+Mandible'></span>

<h3>Description</h3>

<p>Mandible Data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Mandible)</code></pre>


<h3>Format</h3>

<p>Data from 167 fetuses, especially:
</p>

<dl>
<dt>age</dt><dd><p>gestational age in weeks.</p>
</dd>
<dt>length</dt><dd><p>mandible length in mm.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data was originally published by Chitty et al., 1993, and analyzed in
Royston and Altman, 1994 (the data is given there). Only measurements with
<code>age &lt;= 28</code> were used in this analysis.
</p>


<h3>References</h3>

<p>L. S. Chitty and S. Campbell and D. G. Altman (1993), 
Measurement of the fetal mandible &ndash; feasibility and
construction of a centile chart., <em>Prenatal Diagnosis</em>, 
<b>13</b>, 749&ndash;756.
</p>
<p>P. Royston and D. G. Altman (1994), Regression Using 
Fractional Polynomials of Continuous Covariates: Parsimonious 
Parametric Modelling. <em>Applied Statistics</em>, <b>43</b>, 429&ndash;453.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Mandible)
lm(length ~ age, data=Mandible, subset=(age &lt;= 28))

</code></pre>

<hr>
<h2 id='moneydemand'>Money Demand</h2><span id='topic+moneydemand'></span>

<h3>Description</h3>

<p>Money Demand Data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(moneydemand)</code></pre>


<h3>Format</h3>

<p>A multivariate yearly time series from 1879 to 1974 with variables
</p>

<dl>
<dt>logM</dt><dd><p>logarithm of quantity of money,</p>
</dd>
<dt>logYp</dt><dd><p>logarithm of real permanent income,</p>
</dd>
<dt>Rs</dt><dd><p>short term interest rate,</p>
</dd>
<dt>Rm</dt><dd><p>rate of return on money,</p>
</dd>
<dt>Rl</dt><dd><p>not documented in the sources,</p>
</dd>
<dt>logSpp</dt><dd><p>logarithm of an operational measure of the variability of
the rate of price changes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data was originally studied by Allen (1982), the data set is given in
Krämer and Sonnberger (1986). Below we replicate a few examples 
from the book.
Some of these results differ more or less seriously and are sometimes
parameterized differently.
</p>


<h3>References</h3>

<p>S.D. Allen (1982),
Klein's Price Variability Terms in the U.S. Demand for Money.
<em>Journal of Money, Credit and Banking</em> <b>14</b>, 525&ndash;530
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(moneydemand)
moneydemand &lt;- window(moneydemand, start=1880, end=1972)

## page 125, fit Allen OLS model (and Durbin-Watson test),
## last line in Table 6.1

modelAllen &lt;- logM ~ logYp + Rs + Rl + logSpp
lm(modelAllen, data = moneydemand)
dwtest(modelAllen, data = moneydemand)

## page 127, fit test statistics in Table 6.1 c)
################################################

## Breusch-Pagan
bptest(modelAllen, studentize = FALSE, data = moneydemand)
bptest(modelAllen, studentize = TRUE, data = moneydemand)

## RESET
reset(modelAllen, data = moneydemand)
reset(modelAllen, power = 2, type = "regressor", data = moneydemand)
reset(modelAllen, type = "princomp", data = moneydemand)

## Harvey-Collier tests (up to sign of the test statistic)
harvtest(modelAllen, order.by = ~logYp, data = moneydemand)
harvtest(modelAllen, order.by = ~Rs, data = moneydemand)
harvtest(modelAllen, order.by = ~Rl, data = moneydemand)
harvtest(modelAllen, order.by = ~logSpp, data = moneydemand)

## Rainbow test
raintest(modelAllen, order.by = "mahalanobis", data = moneydemand)


if(require(strucchange, quietly = TRUE)) {
## Chow (1913)
sctest(modelAllen, point=c(1913,1), data = moneydemand, type = "Chow") }

if(require(strucchange, quietly = TRUE)) {
## Fluctuation
sctest(modelAllen, type = "fluctuation", rescale = FALSE, data = moneydemand)}
</code></pre>

<hr>
<h2 id='petest'>PE Test for Linear vs. Log-Linear Specifications</h2><span id='topic+petest'></span>

<h3>Description</h3>

<p><code>petest</code> performs the MacKinnon-White-Davidson PE test for comparing
linear vs. log-linear specifications in linear regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> petest(formula1, formula2, data = list(), vcov. = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="petest_+3A_formula1">formula1</code></td>
<td>
<p>either a symbolic description for the first model to be tested,
or a fitted object of class <code>"lm"</code>.</p>
</td></tr>
<tr><td><code id="petest_+3A_formula2">formula2</code></td>
<td>
<p>either a symbolic description for the second model to be tested,
or a fitted object of class <code>"lm"</code>.</p>
</td></tr>
<tr><td><code id="petest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the
model. By default the variables are taken from the environment
which <code>petest</code> is called from.</p>
</td></tr>
<tr><td><code id="petest_+3A_vcov.">vcov.</code></td>
<td>
<p>a function for estimating the covariance matrix of the regression
coefficients, e.g., <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>.</p>
</td></tr>
<tr><td><code id="petest_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The PE test compares two non-nest models where one has a linear
specification of type <code>y ~ x1 + x2</code> and the other has a log-linear
specification of type <code>log(y) ~ z1 + z2</code>. Typically, the
regressors in the latter model are logs of the regressors in the
former, i.e., <code>z1</code> is <code>log(x1)</code> etc.
</p>
<p>The idea of the PE test is the following: If the linear specification is
correct then adding an auxiliary regressor with the difference of
the log-fitted values from both models should be non-significant.
Conversely, if the log-linear specification is correct then adding
an auxiliary regressor with the difference of fitted values in levels
should be non-significant. The PE test statistic is simply the marginal
test of the auxiliary variable(s) in the augmented model(s). In <code>petest</code>
this is performed by <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>.
</p>
<p>For further details, see the references.  
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> which contains the coefficient estimate
of the auxiliary variables in the augmented regression plus corresponding
standard error, test statistic and p value.
</p>


<h3>References</h3>

<p>W.H. Greene (2003). <em>Econometric Analysis</em>, 5th edition.
Upper Saddle River, NJ: Prentice Hall.
</p>
<p>J. MacKinnon, H. White, R. Davidson (1983). Tests for Model Specification in the
Presence of Alternative Hypotheses: Some Further Results.
<em>Journal of Econometrics</em>, <b>21</b>, 53-70.
</p>
<p>M. Verbeek (2004). <em>A Guide to Modern Econometrics</em>, 2nd ed. Chichester, UK: John Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="lmtest.html#topic+jtest">jtest</a></code>, <code><a href="lmtest.html#topic+coxtest">coxtest</a></code>, <code><a href="lmtest.html#topic+encomptest">encomptest</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require("AER")) {
## Verbeek (2004), Section 3
data("HousePrices", package = "AER")

### Verbeek (2004), Table 3.3
hp_lin &lt;- lm(price ~ . , data = HousePrices)
summary(hp_lin)

### Verbeek (2004), Table 3.2
hp_log &lt;- update(hp_lin, log(price) ~ . - lotsize + log(lotsize))
summary(hp_log)

## PE test
petest(hp_lin, hp_log)


## Greene (2003), Example 9.8
data("USMacroG", package = "AER")

## Greene (2003), Table 9.2
usm_lin &lt;- lm(m1 ~ tbill + gdp, data = USMacroG)
usm_log &lt;- lm(log(m1) ~ log(tbill) + log(gdp), data = USMacroG)
petest(usm_lin, usm_log)
## matches results from Greene's errata
}
</code></pre>

<hr>
<h2 id='raintest'>Rainbow Test</h2><span id='topic+raintest'></span>

<h3>Description</h3>

<p>Rainbow test for linearity.</p>


<h3>Usage</h3>

<pre><code class='language-R'>raintest(formula, fraction = 0.5, order.by = NULL, center = NULL,
   data=list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raintest_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model to be tested
(or a fitted <code>"lm"</code> object).</p>
</td></tr>
<tr><td><code id="raintest_+3A_fraction">fraction</code></td>
<td>
<p>numeric. The percentage of observations in the subset is
determined by
<code>fraction*n</code> if <code>n</code> is the number of observations
in the model.</p>
</td></tr>
<tr><td><code id="raintest_+3A_order.by">order.by</code></td>
<td>
<p>Either a vector <code>z</code> or a formula with a single explanatory
variable like <code>~ z</code>. The observations in the model
are ordered by the size of <code>z</code>. If set to <code>NULL</code> (the
default) the observations are assumed to be ordered (e.g., a
time series). If set to <code>"mahalanobis"</code> then the observations
are ordered by their Mahalanobis distances from the mean regressor.</p>
</td></tr>
<tr><td><code id="raintest_+3A_center">center</code></td>
<td>
<p>numeric. If <code>center</code> is smaller than 1 it is
interpreted as percentages of data, i.e. the subset is chosen that
<code>n*fraction</code> observations are around observation number
<code>n*center</code>. If <code>center</code> is greater than 1 it is interpreted to be
the index of the center of the subset. By default <code>center</code> is 0.5.
</p>
<p>If the Mahalanobis distance is chosen <code>center</code> is taken to be
the mean regressor, but can be specified to be a <code>k</code>-dimensional
vector if <code>k</code> is the number of regressors and should be in the
range of the respective regressors.</p>
</td></tr>
<tr><td><code id="raintest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which
<code>raintest</code> is called from.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic idea of the Rainbow test is that even if the true
relationship is
non-linear, a good linear fit can be achieved on a subsample in the &quot;middle&quot; of
the data. The null hypothesis is rejected whenever the overall fit is
significantly worse than the fit for the subsample. The test statistic under
<code class="reqn">H_0</code> follows an F distribution with <code>parameter</code> degrees of freedom.
</p>
<p>Examples can not only be found on this page, but also on the help pages of the
data sets <code><a href="lmtest.html#topic+bondyield">bondyield</a></code>, <code><a href="lmtest.html#topic+currencysubstitution">currencysubstitution</a></code>,
<code><a href="lmtest.html#topic+growthofmoney">growthofmoney</a></code>, <code><a href="lmtest.html#topic+moneydemand">moneydemand</a></code>,
<code><a href="lmtest.html#topic+unemployment">unemployment</a></code>, <code><a href="lmtest.html#topic+wages">wages</a></code>.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was
performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>J.M. Utts (1982),
The Rainbow Test for Lack of Fit in Regression.
<em>Communications in Statistics &ndash; Theory and Methods</em> <b>11</b>,
2801&ndash;2815.
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1:30)
y &lt;- x^2 + rnorm(30,0,2)
rain &lt;- raintest(y ~ x)
rain
## critical value
qf(0.95, rain$parameter[1], rain$parameter[2])
</code></pre>

<hr>
<h2 id='resettest'>RESET Test</h2><span id='topic+resettest'></span><span id='topic+reset'></span>

<h3>Description</h3>

<p>Ramsey's RESET test for functional form.</p>


<h3>Usage</h3>

<pre><code class='language-R'>resettest(formula, power = 2:3, type = c("fitted", "regressor",
  "princomp"), data = list(), vcov = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resettest_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model to be tested
(or a fitted <code>"lm"</code> object).</p>
</td></tr>
<tr><td><code id="resettest_+3A_power">power</code></td>
<td>
<p>integers. A vector of positive integers indicating
the powers of the variables that should be included. By default,
the test is for quadratic or cubic influence of the fitted response.</p>
</td></tr>
<tr><td><code id="resettest_+3A_type">type</code></td>
<td>
<p>a string indicating whether powers of the fitted response, the
regressor variables (factors are left out), or the first principal
component of the regressor matrix should be included in the
extended model.</p>
</td></tr>
<tr><td><code id="resettest_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which <code>resettest</code>
is called from.</p>
</td></tr>
<tr><td><code id="resettest_+3A_vcov">vcov</code>, <code id="resettest_+3A_...">...</code></td>
<td>
<p>optional arguments to be passed to <code><a href="lmtest.html#topic+waldtest">waldtest</a></code>
for carrying out the F test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The RESET test is a popular diagnostic for correctness of functional
form. The basic assumption is that under the alternative the model can be
written in the form
<code class="reqn"> y = X\beta + Z\gamma + u</code>.
<code>Z</code> is generated by taking powers either of the fitted response, the
regressor variables, or the first principal component of <code>X</code>. A standard
F-Test is then applied to determine whether these additional variables have
significant influence. The test statistic under <code class="reqn">H_0</code> follows an F
distribution with <code>parameter</code> degrees of freedom.
</p>
<p>This function was called <code>reset</code> in previous versions of the package. Please
use <code>resettest</code> instead.
</p>
<p>Examples can not only be found on this page, but also on the help pages of the
data sets <code><a href="lmtest.html#topic+bondyield">bondyield</a></code>, <code><a href="lmtest.html#topic+currencysubstitution">currencysubstitution</a></code>,
<code><a href="lmtest.html#topic+growthofmoney">growthofmoney</a></code>, <code><a href="lmtest.html#topic+moneydemand">moneydemand</a></code>,
<code><a href="lmtest.html#topic+unemployment">unemployment</a></code>, <code><a href="lmtest.html#topic+wages">wages</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code> containing:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the corresponding p-value.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string with the method used.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string with the data name.</p>
</td></tr>
</table>


<h3>References</h3>

<p>J.B. Ramsey (1969),
Tests for Specification Errors in Classical Linear Least-Squares Regression Analysis.
<em>Journal of the Royal Statistical Society, Series B</em> <b>31</b>,
350&ndash;371
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1:30)
y1 &lt;- 1 + x + x^2 + rnorm(30)
y2 &lt;- 1 + x + rnorm(30)
resettest(y1 ~ x, power=2, type="regressor")
resettest(y2 ~ x, power=2, type="regressor")
</code></pre>

<hr>
<h2 id='unemployment'>Unemployment Data</h2><span id='topic+unemployment'></span>

<h3>Description</h3>

<p>Unemployment Data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(unemployment)</code></pre>


<h3>Format</h3>

<p>A multivariate yearly time series from 1890 to 1979 with variables
</p>

<dl>
<dt>UN</dt><dd><p>unemployment rate,</p>
</dd>
<dt>m</dt><dd><p>broad money supply,</p>
</dd>
<dt>p</dt><dd><p>implicit deflator of Gross National Product,</p>
</dd>
<dt>G</dt><dd><p>real purchases of goods and services,</p>
</dd>
<dt>x</dt><dd><p>real exports.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data was originally studied by Rea (1983), the data set is given in
Krämer and Sonnberger (1986). Below we replicate a few examples 
from their book. Some of these results differ more or less seriously and are
sometimes
parameterized differently.
</p>


<h3>References</h3>

<p>J.D. Rea (1983),
The Explanatory Power of Alternative Theories of Inflation and Unemployment,
1895-1979.
<em>Review of Economics and Statistics</em> <b>65</b>, 183&ndash;195
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(unemployment)

## data transformation
myunemployment &lt;- window(unemployment, start=1895, end=1956)
time &lt;- 6:67

## page 144, fit Rea OLS model
## last line in Table 6.12

modelRea &lt;- UN ~ log(m/p) + log(G) + log(x) + time
lm(modelRea, data = myunemployment)
## coefficients of logged variables differ by factor 100

## page 143, fit test statistics in table 6.11
##############################################

if(require(strucchange, quietly = TRUE)) {
## Chow 1941
sctest(modelRea, point=c(1940,1), data=myunemployment, type="Chow") }

## Breusch-Pagan
bptest(modelRea, data=myunemployment, studentize=FALSE)
bptest(modelRea, data=myunemployment)

## RESET (a)-(b)
reset(modelRea, data=myunemployment)
reset(modelRea, power=2, type="regressor", data=myunemployment)

## Harvey-Collier
harvtest(modelRea, order.by = ~ log(m/p), data=myunemployment)
harvtest(modelRea, order.by = ~ log(G), data=myunemployment)
harvtest(modelRea, order.by = ~ log(x), data=myunemployment)
harvtest(modelRea, data=myunemployment)

## Rainbow
raintest(modelRea, order.by = "mahalanobis", data=myunemployment)
</code></pre>

<hr>
<h2 id='USDistLag'>US Macroeconomic Data</h2><span id='topic+USDistLag'></span>

<h3>Description</h3>

<p>US macroeconomic data for fitting a distributed lag model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(USDistLag)</code></pre>


<h3>Format</h3>

<p>An annual time series from 1963 to 1982 with 2 variables.
</p>

<dl>
<dt>consumption</dt><dd><p>real consumption,</p>
</dd>
<dt>gnp</dt><dd><p>gross national product (deflated by CPI).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Table 7.7 in Greene (1993)</p>


<h3>References</h3>

<p>Greene W.H. (1993), <em>Econometric Analysis</em>, 2nd edition.
Macmillan Publishing Company, New York.
</p>
<p>Executive Office of the President (1983), <em>Economic Report of the
President</em>. US Government Printing Office, Washington, DC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Willam H. Greene, Econometric Analysis, 2nd Ed.
## Chapter 7
## load data set, p. 221, Table 7.7
data(USDistLag)

## fit distributed lag model, p.221, Example 7.8
usdl &lt;- na.contiguous(cbind(USDistLag, lag(USDistLag, k = -1)))
colnames(usdl) &lt;- c("con", "gnp", "con1", "gnp1")

## C(t) = b0 + b1*Y(t) + b2*C(t-1) + u
fm &lt;- lm(con ~ gnp + con1, data = usdl)
summary(fm)
vcov(fm)
</code></pre>

<hr>
<h2 id='valueofstocks'> Value of Stocks  </h2><span id='topic+valueofstocks'></span>

<h3>Description</h3>

<p>Value of Stocks Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(valueofstocks)</code></pre>


<h3>Format</h3>

<p>A multivariate quarterly time series from 1960(1) to 1977(3) with variables
</p>

<dl>
<dt>VST</dt><dd><p>value of stocks,</p>
</dd>
<dt>MB</dt><dd><p>monetary base,</p>
</dd>
<dt>RTPD</dt><dd><p>dollar rent on producer durables,</p>
</dd>
<dt>RTPS</dt><dd><p>dollar rent on producer structures,</p>
</dd>
<dt>XBC</dt><dd><p>production capacity for business output.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data was originally studied by Woglom (1981), the data set is given
in
Krämer and Sonnberger (1986).
</p>


<h3>References</h3>

<p>G. Woglom (1981),
A Reexamination of the Role of Stocks in the Consumption Function and the
Transmission Mechanism.
<em>Journal of Money, Credit and Banking</em> <b>13</b>, 215&ndash;220
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model Under Test</em>. Heidelberg: Physica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(valueofstocks)
lm(log(VST) ~., data=valueofstocks)
</code></pre>

<hr>
<h2 id='wages'>Wages</h2><span id='topic+wages'></span>

<h3>Description</h3>

<p>Wages Data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wages)</code></pre>


<h3>Format</h3>

<p>A multivariate yearly time series from 1960 to 1979 with variables
</p>

<dl>
<dt>w</dt><dd><p>wages,</p>
</dd>
<dt>CPI</dt><dd><p>consumer price index,</p>
</dd>
<dt>u</dt><dd><p>unemployment,</p>
</dd>
<dt>mw</dt><dd><p>minimum wage.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data was originally studied by Nicols (1983), the data set is given
in Krämer and Sonnberger (1986). Below we replicate a few examples from their
book.
Some of these results differ more or less seriously and are sometimes
parameterized differently.
</p>


<h3>References</h3>

<p>D.A. Nicols (1983),
Macroeconomic Determinants of Wage Adjustments in White Collar Occupations.
<em>Review of Economics and Statistics</em> <b>65</b>, 203&ndash;213
</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wages)

## data transformation to include lagged series
mywages &lt;- cbind(wages, lag(wages[,2], k = -1), lag(wages[,2], k = -2))
colnames(mywages) &lt;- c(colnames(wages), "CPI2", "CPI3")
mywages &lt;- window(mywages, start=1962, end=1979)

## page 142, fit Nichols OLS model
## equation (6.10)

modelNichols &lt;- w ~ CPI + CPI2 + CPI3 + u + mw
lm(modelNichols, data = mywages)

## page 143, fit test statistics in table 6.11
##############################################

if(require(strucchange, quietly = TRUE)) {
## Chow 1972
sctest(modelNichols, point=c(1971,1), data=mywages, type="Chow") }

## Breusch-Pagan
bptest(modelNichols, data=mywages, studentize=FALSE)
bptest(modelNichols, data=mywages)

## RESET (a)-(b)
reset(modelNichols, data=mywages)
reset(modelNichols, power=2, type="regressor", data=mywages)

## Harvey-Collier
harvtest(modelNichols, order.by = ~ CPI, data=mywages)
harvtest(modelNichols, order.by = ~ CPI2, data=mywages)
harvtest(modelNichols, order.by = ~ CPI3, data=mywages)
harvtest(modelNichols, order.by = ~ u, data=mywages)

## Rainbow
raintest(modelNichols, order.by = "mahalanobis", data=mywages)
</code></pre>

<hr>
<h2 id='waldtest'>Wald Test of Nested Models</h2><span id='topic+waldtest'></span><span id='topic+waldtest.formula'></span><span id='topic+waldtest.default'></span><span id='topic+waldtest.lm'></span>

<h3>Description</h3>

<p><code>waldtest</code> is a generic function for carrying out Wald tests.
The default method can be employed for comparing nested (generalized)
linear models (see details below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'> waldtest(object, ...)

 ## Default S3 method:
waldtest(object, ..., vcov = NULL,
   test = c("Chisq", "F"), name = NULL) 

 ## S3 method for class 'formula'
waldtest(object, ..., data = list())

 ## S3 method for class 'lm'
waldtest(object, ..., test = c("F", "Chisq"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="waldtest_+3A_object">object</code></td>
<td>
<p>an object. See below for details.</p>
</td></tr>
<tr><td><code id="waldtest_+3A_...">...</code></td>
<td>
<p>further object specifications passed to methods. See below for details.</p>
</td></tr>
<tr><td><code id="waldtest_+3A_vcov">vcov</code></td>
<td>
<p>a function for estimating the covariance matrix of the regression
coefficients, e.g., <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>. If only two models
are compared it can also be the covariance matrix of the more general
model.</p>
</td></tr>
<tr><td><code id="waldtest_+3A_test">test</code></td>
<td>
<p>character specifying whether to compute the large sample
Chi-squared statistic (with asymptotic Chi-squared distribution) or the finite sample
F statistic (with approximate F distribution).</p>
</td></tr>
<tr><td><code id="waldtest_+3A_name">name</code></td>
<td>
<p>a function for extracting a suitable name/description from
a fitted model object. By default the name is queried by calling
<code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="waldtest_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>waldtest</code> is intended to be a generic function for comparisons
of models via Wald tests. The default method consecutively compares
the fitted model object <code>object</code> with the models passed in <code>...</code>.
Instead of passing the fitted model objects in <code>...</code>, several other
specifications are possible. For all objects in <code>list(object, ...)</code>
the function tries to consecutively compute fitted models using the following
updating algorithm: 
</p>

<ol>
<li><p> For each two consecutive objects, <code>object1</code> and <code>object2</code>
say, try to turn <code>object2</code> into a fitted model that can be
compared to (the already fitted model object) <code>object1</code>.
</p>
</li>
<li><p> If <code>object2</code> is numeric, the corresponding element of
<code>attr(terms(object1), "term.labels")</code> is selected to be omitted.
</p>
</li>
<li><p> If <code>object2</code> is a character, the corresponding terms are
included into an update formula like <code>. ~ . - term2a - term2b</code>.
</p>
</li>
<li><p> If <code>object2</code> is a formula, then compute the fitted model via
<code>update(object1, object2)</code>.
</p>
</li></ol>

<p>Consequently, the models in <code>...</code> can be specified as integers, characters
(both for terms that should be eliminated from the previous model), update formulas or
fitted model objects. Except for the last case, the existence of an <code><a href="stats.html#topic+update">update</a></code>
method is assumed. See also the examples for an illustration.
</p>
<p>Subsequently, a Wald test for each two consecutive models is carried out. This
is similar to <code><a href="stats.html#topic+anova">anova</a></code> (which typically performs likelihood-ratio tests),
but with a few differences. If only one fitted model object is specified, it is compared
to the trivial model (with only an intercept). The test can be either the finite sample
F statistic or the asymptotic Chi-squared statistic (<code class="reqn">F = Chisq/k</code> if <code class="reqn">k</code> is the
difference in degrees of freedom). The covariance matrix is always estimated on the more general
of two subsequent models (and not only in the most general model overall). If <code>vcov</code>
is specified, HC and HAC estimators can also be plugged into <code>waldtest</code>.	     
</p>
<p>The default method is already very general and applicable to a broad range of fitted
model objects, including <code><a href="stats.html#topic+lm">lm</a></code> and <code><a href="stats.html#topic+glm">glm</a></code> objects. It can be
easily made applicable to other model classes as well by providing suitable methods
to the standard generics <code><a href="stats.html#topic+terms">terms</a></code> (for determining the variables in the model
along with their names), <code><a href="stats.html#topic+update">update</a></code> (unless only fitted model objects are passed
to <code>waldtest</code>, as mentioned above), <code><a href="stats.html#topic+nobs">nobs</a></code> (or <code><a href="stats.html#topic+residuals">residuals</a></code>, used for determining
the number of observations), <code><a href="stats.html#topic+df.residual">df.residual</a></code> (needed only for the F statistic),
<code><a href="stats.html#topic+coef">coef</a></code> (for extracting the coefficients; needs to be named matching the names
in <code>terms</code>), <code><a href="stats.html#topic+vcov">vcov</a></code> (can be user-supplied; needs to be named matching the
names in <code>terms</code>). Furthermore, some means of determining a suitable <code>name</code> for
a fitted model object can be specified (by default this is taken to be the result of
a call to <code><a href="stats.html#topic+formula">formula</a></code>, if available).
</p>
<p>The <code>"formula"</code> method fits a <code><a href="stats.html#topic+lm">lm</a></code> first and then calls the <code>"lm"</code>
method. The <code>"lm"</code> method just calls the default method, but sets the default
test to be the F test.
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> which contains the residual degrees of freedom,
the difference in degrees of freedom, Wald statistic
(either <code>"Chisq"</code> or <code>"F"</code>) and corresponding p value.
</p>


<h3>See Also</h3>

<p><code><a href="lmtest.html#topic+coeftest">coeftest</a></code>, <code><a href="stats.html#topic+anova">anova</a></code>, <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## fit two competing, non-nested models and their encompassing
## model for aggregate consumption, as in Greene (1993),
## Examples 7.11 and 7.12

## load data and compute lags
data(USDistLag)
usdl &lt;- na.contiguous(cbind(USDistLag, lag(USDistLag, k = -1)))
colnames(usdl) &lt;- c("con", "gnp", "con1", "gnp1")

## C(t) = a0 + a1*Y(t) + a2*C(t-1) + u
fm1 &lt;- lm(con ~ gnp + con1, data = usdl)

## C(t) = b0 + b1*Y(t) + b2*Y(t-1) + v
fm2 &lt;- lm(con ~ gnp + gnp1, data = usdl)

## Encompassing model
fm3 &lt;- lm(con ~ gnp + con1 + gnp1, data = usdl)

## a simple ANOVA for fm3 vs. fm2
waldtest(fm3, fm2)
anova(fm3, fm2)
## as df = 1, the test is equivalent to the corresponding t test in
coeftest(fm3)

## various equivalent specifications of the two models
waldtest(fm3, fm2)
waldtest(fm3, 2)
waldtest(fm3, "con1")
waldtest(fm3, . ~ . - con1)

## comparing more than one model
## (equivalent to the encompassing test)
waldtest(fm1, fm3, fm2)
encomptest(fm1, fm2)

## using the asymptotic Chisq statistic
waldtest(fm3, fm2, test = "Chisq")
## plugging in a HC estimator
if(require(sandwich)) waldtest(fm3, fm2, vcov = vcovHC)  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
