<!DOCTYPE html><html lang="en"><head><title>Help for package photobiologyInOut</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {photobiologyInOut}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#photobiologyInOut-package'><p>photobiologyInOut: Read Spectral and Logged Data from Foreign Files</p></a></li>
<li><a href='#colorSpec2mspct'><p>Convert 'colorSpec::colorSpec' objects</p></a></li>
<li><a href='#hyperSpec2mspct'><p>Convert 'hyperSpec::hyperSpec' objects</p></a></li>
<li><a href='#mspct2colorSpec'><p>Convert into 'colorSpec::colorSpec' objects</p></a></li>
<li><a href='#mspct2fdata'><p>Convert spectra into 'fda.usc::fdata' objects</p></a></li>
<li><a href='#qtuv_clouds'><p>Clouds descriptor</p></a></li>
<li><a href='#qtuv_s.e.irrad'><p>Spectral irradiance from the Quick TUV calculator</p></a></li>
<li><a href='#read_ASTER_txt'><p>Read File downloaded from ASTER data base.</p></a></li>
<li><a href='#read_avaspec_csv'><p>Read '.csv' File Saved by Avantes' Software for AvaSpec.</p></a></li>
<li><a href='#read_cid_spectravue_csv'><p>Read File Saved by CID's SpectraVue.</p></a></li>
<li><a href='#read_CIE_csv'><p>Read '.CSV' files from CIE</p></a></li>
<li><a href='#read_csi_dat'><p>Read '.DAT' file(s) saved by modern Campbell Scientific loggers.</p></a></li>
<li><a href='#read_fmi_cum'><p>Read daily cummulated solar spectrum data file(s).</p></a></li>
<li><a href='#read_fmi2mspct'><p>Read multiple solar spectra from a data file.</p></a></li>
<li><a href='#read_foreign2mspct'><p>Read multiple foreign files with spectral data</p></a></li>
<li><a href='#read_FReD_csv'><p>Read '.CSV' FReD database.</p></a></li>
<li><a href='#read_li180_txt'><p>Read '.TXT' File(s) Saved by LI-COR's LI-180 spectroradiometer.</p></a></li>
<li><a href='#read_licor_prn'><p>Read '.PRN' File(s) Saved by LI-COR's PC1800 Program.</p></a></li>
<li><a href='#read_macam_dta'><p>Read '.DTA' File Saved by Macam's Software.</p></a></li>
<li><a href='#read_oo_jazirrad'><p>Read Files Saved by Ocean Optics' Jaz spectrometer.</p></a></li>
<li><a href='#read_oo_pidata'><p>Read File Saved by Ocean Optics' Raspberry Pi software.</p></a></li>
<li><a href='#read_oo_ssirrad'><p>Read File Saved by Ocean Optics' SpectraSuite.</p></a></li>
<li><a href='#read_qtuv_txt'><p>Read Quick TUV output file.</p></a></li>
<li><a href='#read_spectrapen_csv'><p>Read '.CSV' File Saved by PSI's Software.</p></a></li>
<li><a href='#read_tuv_usrout'><p>Read TUV output file.</p></a></li>
<li><a href='#read_uvspec_disort'><p>Read libRadtran's uvspec output file.</p></a></li>
<li><a href='#read_uvspec_disort_vesa'><p>Read libRadtran's uvspec output file from batch job.</p></a></li>
<li><a href='#read_wasatch_csv'><p>Read File Saved by Wasatch's Enlighten.</p></a></li>
<li><a href='#read_yoctopuce_csv'><p>Read '.CSV' file(s) downloaded from YoctoPuce modules.</p></a></li>
<li><a href='#rspec2mspct'><p>Convert &quot;pavo::rspec&quot; objects</p></a></li>
<li><a href='#spct_CCT'><p>Correlated color temperature</p></a></li>
<li><a href='#spct_CRI'><p>Color reproduction index</p></a></li>
<li><a href='#spct_SSI'><p>Spectral (color) similarity index</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Read Spectral and Logged Data from Foreign Files</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.30</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-02</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for reading, and in some cases writing, foreign files 
    containing spectral data from spectrometers and their associated software, 
    output from daylight simulation models in common use, and some spectral 
    data repositories. As well as functions for exchange of spectral data with 
    other R packages. Part of the 'r4photobiology' suite, 
    Aphalo P. J. (2015) &lt;<a href="https://doi.org/10.19232%2Fuv4pb.2015.1.14">doi:10.19232/uv4pb.2015.1.14</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0), photobiology (&ge; 0.11.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, tools, utils, stats, SunCalcMeeus (&ge; 0.1.1), stringr
(&ge; 1.5.0), lubridate (&ge; 1.9.2), anytime (&ge; 0.3.9), tibble
(&ge; 3.2.1), dplyr (&ge; 1.1.2), tidyr (&ge; 1.3.0), tidyselect(&ge;
1.2.0), readr (&ge; 2.1.4), readxl (&ge; 1.4.3), colorSpec (&ge;
1.5-0), jsonlite (&ge; 1.8.8)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spacesXYZ (&ge; 1.2-1), hyperSpec (&ge; 0.100.0), pavo (&ge;
2.8.0), fda.usc(&ge; 2.1.0), knitr (&ge; 1.43), rmarkdown (&ge;
2.23), ggplot2 (&ge; 3.4.2), ggspectra (&ge; 0.3.11),
photobiologyWavebands (&ge; 0.5.1), testthat (&ge; 3.1.10)</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://docs.r4photobiology.info/photobiologyInOut/">https://docs.r4photobiology.info/photobiologyInOut/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/aphalo/photobiologyinout/issues/">https://github.com/aphalo/photobiologyinout/issues/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-02 15:01:38 UTC; aphalo</td>
</tr>
<tr>
<td>Author:</td>
<td>Pedro J. Aphalo <a href="https://orcid.org/0000-0003-3385-972X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Titta K. Kotilainen
    <a href="https://orcid.org/0000-0002-2822-9734"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Glenn Davis [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pedro J. Aphalo &lt;pedro.aphalo@helsinki.fi&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-02 18:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='photobiologyInOut-package'>photobiologyInOut: Read Spectral and Logged Data from Foreign Files</h2><span id='topic+photobiologyInOut'></span><span id='topic+photobiologyInOut-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Functions for reading, and in some cases writing, foreign files containing spectral data from spectrometers and their associated software, output from daylight simulation models in common use, and some spectral data repositories. As well as functions for exchange of spectral data with other R packages. Part of the 'r4photobiology' suite, Aphalo P. J. (2015) <a href="https://doi.org/10.19232/uv4pb.2015.1.14">doi:10.19232/uv4pb.2015.1.14</a>.
</p>


<h3>Data acquisition</h3>

<p>The support for Ocean Insight, formerly Ocean
Optics, spectrometers in package 'photobiologyInOut' is limited to the
import of data acquired with Ocean Optics' software as is. In contrast,
package 'ooacquire', part of these same suite, makes it possible to
control, modify settings and acquire spectral data from Ocean Optics
spectrometers directly from within R. 'ooacquire' also supports the
conversion of raw-counts data into physical quantities.
</p>


<h3>Warning!</h3>

<p>Most of the file formats supported are not standardized,
and are a moving target because of changes in instrument firmware and
support software. In addition the output format, especially with models,
can depend on settings that users can alter. So do check that import is
working as expected, and if not, please please raise an issue and upload
one example of an incorrectly decoded file.
</p>


<h3>Note</h3>

<p>From version 0.4.4 the time zone (tz) used for decoding dates
and times in files imported defaults to &quot;UTC&quot;. In most cases you will need
to pass the tz (or the locale) where the file was created as an argument to
the functions!
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pedro J. Aphalo <a href="mailto:pedro.aphalo@helsinki.fi">pedro.aphalo@helsinki.fi</a> (<a href="https://orcid.org/0000-0003-3385-972X">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Titta K. Kotilainen (<a href="https://orcid.org/0000-0002-2822-9734">ORCID</a>) [contributor]
</p>
</li>
<li><p> Glenn Davis <a href="mailto:gdavis@gluonics.com">gdavis@gluonics.com</a> [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>Aphalo, Pedro J. (2015) The r4photobiology suite. UV4Plants Bulletin, 2015:1,
21-29. <a href="https://doi.org/10.19232/uv4pb.2015.1.14">doi:10.19232/uv4pb.2015.1.14</a>.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://docs.r4photobiology.info/photobiologyInOut/">https://docs.r4photobiology.info/photobiologyInOut/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/aphalo/photobiologyinout/issues/">https://github.com/aphalo/photobiologyinout/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='colorSpec2mspct'>Convert 'colorSpec::colorSpec' objects</h2><span id='topic+colorSpec2mspct'></span><span id='topic+as.source_spct.colorSpec'></span><span id='topic+as.source_mspct.colorSpec'></span><span id='topic+as.response_spct.colorSpec'></span><span id='topic+as.response_mspct.colorSpec'></span><span id='topic+as.filter_spct.colorSpec'></span><span id='topic+as.filter_mspct.colorSpec'></span><span id='topic+as.reflector_spct.colorSpec'></span><span id='topic+as.reflector_mspct.colorSpec'></span><span id='topic+as.chroma_mspct.colorSpec'></span><span id='topic+colorSpec2spct'></span><span id='topic+colorSpec2chroma_spct'></span><span id='topic+as.chroma_spct.colorSpec'></span><span id='topic+as.generic_spct.colorSpec'></span><span id='topic+as.generic_mspct.colorSpec'></span>

<h3>Description</h3>

<p>Convert 'colorSpec::colorSpec' objects into spectral objects (xxxx_spct,
xxxx_mspct) as defined in package 'photobiology' and vice versa preserving
as much information as possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colorSpec2mspct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.source_spct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.source_mspct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.response_spct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.response_mspct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.filter_spct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.filter_mspct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.reflector_spct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.reflector_mspct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.chroma_mspct(x, multiplier = 1, ...)

colorSpec2spct(x, multiplier = 1, ...)

colorSpec2chroma_spct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.chroma_spct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.chroma_mspct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.generic_spct(x, multiplier = 1, ...)

## S3 method for class 'colorSpec'
as.generic_mspct(x, multiplier = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="colorSpec2mspct_+3A_x">x</code></td>
<td>
<p>colorSpec object</p>
</td></tr>
<tr><td><code id="colorSpec2mspct_+3A_multiplier">multiplier</code></td>
<td>
<p>numeric A multiplier to be applied to the 'spc' data to do
unit or scale conversion.</p>
</td></tr>
<tr><td><code id="colorSpec2mspct_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Objects of class <code>colorSpec::colorSpec</code> do not contain metadata
or class data from which the units of expression could be obtained. When
using function <code>colorSpec2mspct</code> the user needs to use parameter
<code>multiplier</code> to convert the data to what is expected by the object
constructors defined in package 'photobiology' but should only rarely need to
use parameter <code>spct.data.var</code> to select the quantity.
</p>
<p><code>colorSpec::colorSpec</code> objects may use memory more efficiently than
spectral objects of the classes for collections of spectra defined in package
'photobiology' as wavelengths are assumed to be the same for all member
spectra, and stored only once while this assumption is not made for
collections of spectra, allowing different wavelengths and lengths for the
component spectra. When using <code>as.colorSpec</code> methods to convert
collections of spectra into <code>colorSpec</code> objects, if the wavelengths of
the individual spectra differe, only the shared range of wavelengths is
retained and within the this range, wavelngth values are made consistent by
interpolation.
</p>


<h3>Warning!</h3>

<p>Always check the sanity of the imported or exported data
values, as guessing is needed when matching the different classes, and the
functions defined here are NOT guaranteed to return valid data without help
from the user through optional function arguments.
</p>


<h3>Note</h3>

<p>In <code>generic_mspct</code> objects, wavelengths are stored for each
spectrum, individual <code>generic_spct</code> objects. However, as spectral
classes are derived from 'tbl_df' in many cases no redundant copies of
wavelength data will be made in memory in spite of the more flexible
semantics of the objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example run only if 'colorSpec' is available
if (requireNamespace("colorSpec", quietly = TRUE)) {
  library(colorSpec)
  colorSpec2mspct(Fs.5nm)
  colorSpec2spct(Fs.5nm)
  colorSpec2mspct(C.5nm)
  colorSpec2spct(C.5nm)
} 

</code></pre>

<hr>
<h2 id='hyperSpec2mspct'>Convert 'hyperSpec::hyperSpec' objects</h2><span id='topic+hyperSpec2mspct'></span><span id='topic+hyperSpec2spct'></span><span id='topic+mspct2hyperSpec'></span><span id='topic+spct2hyperSpec'></span>

<h3>Description</h3>

<p>Convert <code>hyperSpec::hyperSpec</code> objects containing VIS and UV radiation
data into spectral objects (xxxx_spct, xxxx_mspct) as defined in package 
'photobiology' and vice versa, preserving as much information as possible. As
<code>hyperSpec</code> can contain other kinds of spectral data, it does make sense
to use these functions only with objects containing data that can be handled
by both packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyperSpec2mspct(x, member.class, spct.data.var, multiplier = 1, ...)

hyperSpec2spct(x, multiplier = 1, ...)

mspct2hyperSpec(x, spct.data.var, multiplier = 1, ...)

spct2hyperSpec(x, spct.data.var = NULL, multiplier = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hyperSpec2mspct_+3A_x">x</code></td>
<td>
<p>hyperSpec object</p>
</td></tr>
<tr><td><code id="hyperSpec2mspct_+3A_member.class">member.class</code></td>
<td>
<p>character One of the spectrum classes defined in package
'photobiology'.</p>
</td></tr>
<tr><td><code id="hyperSpec2mspct_+3A_spct.data.var">spct.data.var</code></td>
<td>
<p>character The name to be used for the 'spc' data when
constructing the spectral objects.</p>
</td></tr>
<tr><td><code id="hyperSpec2mspct_+3A_multiplier">multiplier</code></td>
<td>
<p>numeric A multiplier to be applied to the 'spc' data to do
unit or scale conversion. For example &quot;a.u.&quot; units in some examples in
package 'hyperSpec' seem to have scale factors applied.</p>
</td></tr>
<tr><td><code id="hyperSpec2mspct_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Warning!</h3>

<p>Always check the sanity of the imported or exported data
values, as guessing is needed when matching the different classes, and the
functions defined here are NOT guaranteed to return valid data wihtout help
from the user through optional function arguments.
</p>


<h3>Note</h3>

<p>Objects of class <code>hyperSpec::hyperSpec</code> contain metadata or class 
data from which the quantity measured and the units of expression can be 
obtained. However, units as included in the objects are not well 
documented making automatic conversion difficult. When using this function
the user may need to use parameter <code>multiplier</code> to scale the data to
what is expected by the object constructors defined in package
'photobiology' and use parameter <code>spct.data.var</code> to select the
quantity.
</p>
<p><code>hyperSpec::hyperSpec</code> objects may use memory more efficiently
than spectral objects of the classes for collections of spectra defined in
package 'photobiology' as wavelengths are assumed to be the same for all
member spectra, and stored only once while this assumption is not made for
collections of spectra, allowing different wavelengths and lengths for the
component spectra. Wavelengths are stored for each spectrum, but as
spectral classes are derived from 'tbl_df' in many cases no redundant
copies of wavelength data will be made in memory in spite of the more
flexible semantics of the objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example run only if 'hyperSpec' is available
if (requireNamespace("hyperSpec", quietly = TRUE)) {
  library(hyperSpec)
  data(laser)
  wl(laser) &lt;- 
    list(wl = 1e7 / (1/405e-7 - wl (laser)),
         label = expression (lambda / nm))
  laser.mspct &lt;- hyperSpec2mspct(laser, "source_spct", "s.e.irrad")
  class(laser.mspct)
}

</code></pre>

<hr>
<h2 id='mspct2colorSpec'>Convert into 'colorSpec::colorSpec' objects</h2><span id='topic+mspct2colorSpec'></span><span id='topic+spct2colorSpec'></span><span id='topic+chroma_spct2colorSpec'></span><span id='topic+as.colorSpec'></span><span id='topic+as.colorSpec.generic_mspct'></span><span id='topic+as.colorSpec.generic_spct'></span><span id='topic+as.colorSpec.chroma_spct'></span>

<h3>Description</h3>

<p>Convert spectral objects (xxxx_spct, xxxx_mspct) as defined in package 
'photobiology' into colorSpec objects preserving as much information as
possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mspct2colorSpec(x, spct.data.var = NULL, multiplier = 1, ...)

spct2colorSpec(x, spct.data.var = NULL, multiplier = 1, ...)

chroma_spct2colorSpec(x, spct.data.var = NULL, multiplier = 1, ...)

## S3 method for class 'generic_mspct'
as.colorSpec(x, spct.data.var = NULL, multiplier = 1, ...)

## S3 method for class 'generic_spct'
as.colorSpec(x, spct.data.var = NULL, multiplier = 1, ...)

## S3 method for class 'chroma_spct'
as.colorSpec(x, spct.data.var = NULL, multiplier = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mspct2colorSpec_+3A_x">x</code></td>
<td>
<p>R object</p>
</td></tr>
<tr><td><code id="mspct2colorSpec_+3A_spct.data.var">spct.data.var</code></td>
<td>
<p>character The name of the variable to read spectral data
from.</p>
</td></tr>
<tr><td><code id="mspct2colorSpec_+3A_multiplier">multiplier</code></td>
<td>
<p>numeric A multiplier to be applied to the 'spc' data to do
unit or scale conversion.</p>
</td></tr>
<tr><td><code id="mspct2colorSpec_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>as.colorSpec(generic_spct)</code>: 
</p>
</li>
<li> <p><code>as.colorSpec(chroma_spct)</code>: 
</p>
</li></ul>


<h3>Warning!</h3>

<p>Always check the sanity of the returned data values, as
guessing is needed when matching the different classes, and the functions
defined here are NOT guaranteed to return valid data without help from the
user through optional function arguments.
</p>


<h3>Note</h3>

<p>Objects of class <code>colorSpec::colorSpec</code> do not contain metadata or
class data from which the units of expression could be obtained. When using
this function the user needs to use parameter <code>multiplier</code> to convert 
the data to what is expected by the object constructors defined in package 
'photobiology' but should only rarely need to use parameter
<code>spct.data.var</code> to select the quantity.
</p>
<p><code>colorSpec::colorSpec</code> objects may use memory more efficiently than
spectral objects of the classes for collections of spectra defined in
package 'photobiology' as wavelengths are assumed to be the same for all
member spectra, and stored only once while this assumption is not made for
collections of spectra, allowing different wavelengths and lengths for the
component spectra. Wavelengths are stored for each spectrum, but as
spectral classes are derived from 'tbl_df' in many cases no redundant
copies of wavelength data will be made in memory in spite of the more
flexible semantics of the objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (requireNamespace("colorSpec", quietly = TRUE)) {
  library(colorSpec)
  as.colorSpec(polyester.spct)
  as.colorSpec(sun.spct)
  as.colorSpec(filter_mspct(list(polyester.spct, yellow_gel.spct)))
}

</code></pre>

<hr>
<h2 id='mspct2fdata'>Convert spectra into 'fda.usc::fdata' objects</h2><span id='topic+mspct2fdata'></span><span id='topic+spct2fdata'></span><span id='topic+fdata2spct'></span><span id='topic+fdata2mspct'></span>

<h3>Description</h3>

<p>Convert spectral objects (xxxx_spct, xxxx_mspct) as defined in package
'photobiology' into <code>fda.usc::fdata</code> objects, preserving as much
information as possible. As <code>fdata</code> objects can contain other kinds
of data, the reverse conversion is supported (experimentally) and mainly
for 'fdata' objects returned by the functional data analysis methods from
package <code>fda.usc</code> to spectral data previosuly exported in the
opposite direction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mspct2fdata(x, spct.data.var = NULL, multiplier = 1, ...)

spct2fdata(x, spct.data.var = NULL, multiplier = 1, ...)

fdata2spct(x, multiplier = 1, member.class = NULL, drop.idx = FALSE, ...)

fdata2mspct(x, multiplier = 1, member.class = NULL, drop.idx = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mspct2fdata_+3A_x">x</code></td>
<td>
<p>generic_mspct or generic_spct object or an object belonging to a
derived class, or an object of class 'fdata' depending on the function.</p>
</td></tr>
<tr><td><code id="mspct2fdata_+3A_spct.data.var">spct.data.var</code></td>
<td>
<p>character The name of the column containing data to
export. If <code>NULL</code> the first spectral data column found is used.</p>
</td></tr>
<tr><td><code id="mspct2fdata_+3A_multiplier">multiplier</code></td>
<td>
<p>numeric A multiplier to be applied to the 'spc' data to do
unit or scale conversion.</p>
</td></tr>
<tr><td><code id="mspct2fdata_+3A_...">...</code></td>
<td>
<p>possibly additional named arguments passed to object constructors.</p>
</td></tr>
<tr><td><code id="mspct2fdata_+3A_member.class">member.class</code></td>
<td>
<p>character Name of the class of the spectrum or of the
members of the collection of spectra.</p>
</td></tr>
<tr><td><code id="mspct2fdata_+3A_drop.idx">drop.idx</code></td>
<td>
<p>logical Flag indicating whether to drop or keep
<code>idx.var</code> in the collection members.</p>
</td></tr>
</table>


<h3>Warning!</h3>

<p>When converting multiple spectra, all the spectra to be
included in the <code>fdata</code> object must share the same wavelength values.
Spectra that do not fulfil this condition will be skipped. The data variable
needs also to be present in all individual spectra as no conversions are 
applied automatically by this function. If a different name, indicating a
different quantity or a different base of expression is encountered, the
affected spectrum is skipped with a warning.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("fda.usc", quietly = TRUE)) {
# from spectra to fdata
  sun.fdata &lt;- spct2fdata(sun.spct)
  str(sun.fdata)
  polyester.fdata &lt;- spct2fdata(polyester.spct)
  str(polyester.fdata)
# from fdata to spectra
  fdata2spct(sun.fdata)
  fdata2spct(sun.fdata, drop.idx = TRUE)
  fdata2spct(polyester.fdata, drop.idx = TRUE)
}

</code></pre>

<hr>
<h2 id='qtuv_clouds'>Clouds descriptor</h2><span id='topic+qtuv_clouds'></span>

<h3>Description</h3>

<p>Constructor of a named list of parameter values to be used as argument to
parameter <code>clouds</code> of function <code><a href="#topic+qtuv_s.e.irrad">qtuv_s.e.irrad</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qtuv_clouds(cloud.type = "clear.sky")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qtuv_clouds_+3A_cloud.type">cloud.type</code></td>
<td>
<p>character One of &quot;clear.sky&quot;, &quot;cirrus&quot;, &quot;stratocumulus&quot; or
&quot;overcast&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provide a rough approximation for parameter values.
In reality there is large variation in the cloud optical depths (COD) and
in the elevation at which clouds are located, within each type of cloud.
The TUV model assumes a continuous uniform cloud layer, thus the normally
discontinuous cover of cumulus clouds cannot be described.
</p>


<h3>Value</h3>

<p>A one-row data frame with members &quot;optical.depth&quot;, &quot;base&quot;, &quot;top&quot; and
&quot;label&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
qtuv_clouds("clear.sky")
qtuv_clouds("cirrus")
qtuv_clouds(c("clear.sky", "cirrus"))

</code></pre>

<hr>
<h2 id='qtuv_s.e.irrad'>Spectral irradiance from the Quick TUV calculator</h2><span id='topic+qtuv_s.e.irrad'></span><span id='topic+qtuv_m_s.e.irrad'></span>

<h3>Description</h3>

<p>Call the Quick TUV calculator web server and return a <code>source_spct</code>
object with the simulated spectral energy irradiance data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qtuv_s.e.irrad(
  w.length = list(wStart = 280, wStop = 420, wIntervals = 140),
  sun.elevation = NULL,
  geocode = data.frame(lon = 0, lat = 51.5, address = "Greenwich"),
  time = lubridate::now(),
  tz = NULL,
  locale = readr::default_locale(),
  ozone.du = 300,
  albedo = 0.1,
  ground.altitude = 0,
  measurement.altitude = NULL,
  clouds = data.frame(optical.depth = 0, base = 4, top = 5),
  aerosols = data.frame(optical.depth = 0.235, ssaaer = 0.99, alpha = 1),
  num.streams = 2,
  spectra = list(direct = 1, diffuse.down = 1, diffuse.up = 0),
  added.vars = NULL,
  label = "",
  server.url = "https://www.acom.ucar.edu/cgi-bin/acom/TUV/V5.3/tuv",
  file = NULL
)

qtuv_m_s.e.irrad(
  w.length = list(wStart = 280, wStop = 420, wIntervals = 140),
  sun.elevation = NULL,
  geocode = data.frame(lon = 0, lat = 51.5, address = "Greenwich"),
  time = lubridate::now(),
  tz = NULL,
  locale = readr::default_locale(),
  ozone.du = 300,
  albedo = 0.1,
  ground.altitude = 0,
  measurement.altitude = NULL,
  clouds = data.frame(optical.depth = 0, base = 4, top = 5),
  aerosols = data.frame(optical.depth = 0.235, ssaaer = 0.99, alpha = 1),
  num.streams = 2,
  spectra = list(direct = 1, diffuse.down = 1, diffuse.up = 0),
  added.vars = NULL,
  label = "",
  server.url = "https://www.acom.ucar.edu/cgi-bin/acom/TUV/V5.3/tuv",
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qtuv_s.e.irrad_+3A_w.length">w.length</code></td>
<td>
<p>list of parameters describing the wavelengths, or a numeric
vector from which the parameters will be constructed.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_sun.elevation">sun.elevation</code></td>
<td>
<p>numeric Angle in degrees above the horizon. If NULL its
value is computed from <code>geocode</code> and <code>time</code>, otherwise 
arguments passed to these two parameters are ignored.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_geocode">geocode</code></td>
<td>
<p>data.frame with variables <code>lon</code> and <code>lat</code> as numeric values
(degrees), and character variable <code>address</code>; nrow &gt; 1, allowed for collections.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_time">time</code></td>
<td>
<p>A &quot;vector&quot; of POSIXct time, with any valid time zone (TZ) is
allowed, default is current time.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_tz">tz</code></td>
<td>
<p>character Time zone is by default read from the file.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_ozone.du">ozone.du</code></td>
<td>
<p>numeric Ozone column in Dobson units.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_albedo">albedo</code></td>
<td>
<p>numeric Surface albedo (= reflectance) as a fraction of one.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_measurement.altitude">measurement.altitude</code>, <code id="qtuv_s.e.irrad_+3A_ground.altitude">ground.altitude</code></td>
<td>
<p>numeric Altitudes above sea level
expressed in km.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_clouds">clouds</code></td>
<td>
<p>data.frame Parameters <code>optical.depth</code> (vertical), <code>top</code> and 
<code>base</code> expressed in km; nrow &gt; 1, allowed for collections.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_aerosols">aerosols</code></td>
<td>
<p>data.frame Parameters <code>optical.depth</code> (total extinction), <code>ssaaer</code> 
(cloud single scattering albedo) and <code>alpha</code> (wavelength dependence of 
optical depth); nrow &gt; 1, allowed for collections.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_num.streams">num.streams</code></td>
<td>
<p>integer Number of streams used in computations, 2 or 4.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_spectra">spectra</code></td>
<td>
<p>named list with weights for the different components of the 
spectrum.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_added.vars">added.vars</code></td>
<td>
<p>character vector Accepted member values are <code>"sun.elevation"</code>,
<code>zenith.angle</code>, <code>"date"</code> and <code>"ozone.du"</code>.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_server.url">server.url</code></td>
<td>
<p>character The URL used to access the Quick TUV calculator
server.</p>
</td></tr>
<tr><td><code id="qtuv_s.e.irrad_+3A_file">file</code></td>
<td>
<p>character The name under which the file returned by the server is
locally saved. If <code>NULL</code> a temporary file is used and discarded
immediately. File paths are supported when valid.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Quick TUV calculator, is an on-line freely accessible server
running the TUV atmospheric chemistry and radiation transfer model with a
simplified user interface. In this case, version 5.3 is called passing the
parameter values passed as arguments in the call to
<code>qtuv_s.e.irrad()</code>. The response is saved in a text file that is
subsequently read with function <code>read_qtuv_txt()</code> into a
<code>source_spct</code> object.
</p>
<p>Function <code>qtuv_m_s.e.irrad()</code> calls <code>qtuv_s.e.irrad()</code> repeatedly 
accepting a numeric vector longer than one as argument, for parameters: 
<code>sun.elevation</code>, <code>time</code> or <code>ozone.du</code>, and data frames with
nrow &gt;= 1. In a given call, only one parameter at a time can obey multiple 
values, with others currently truncated to the first value.
</p>
<p>The formal parameter names are informative and consistent with other 
functions in the R for Photobiology Suite and differ from the short names
used for the parameters in the FORTRAN code of the TUV model. In the case
of <code>w.length</code> two ways of specifying wavelengths are supported. Some
defaults also differ from those of the Quick TUV calculator.
</p>
<p>In the current implementation, <code>qtuv_m_s.e.irrad()</code>, accepts multiple
values as arguments for only one parameter at a time. In the case of
elevation, both 'ground.elevation' and 'measurement.elevation' can have
each one or more values. When too many values are passed in the call, only
the first one is used.
</p>


<h3>Value</h3>

<p>In the case of <code>qtuv_s.e.irrad()</code>, a source_spct object obtained
by finding the center of each wavelength interval in the Quick TUV output
file, and adding the variables listed in <code>added.vars</code>. In the case of
<code>qtuv_m_s.e.irrad()</code>, a source_mspct object containing a collection of
such spectra.
</p>


<h3>Side effect</h3>

<p>If a file name is passed as argument, the data as
downloaded are saved into persistent files, one file per spectrum. The
names of the saved files always end in '.txt'.
</p>


<h3>Warning!</h3>

<p>This function connects to a server managed by UCAR, the
University Corporation for Atmospheric Research located in the U.S.A. to
obtain simulated spectral data. UCAR manages the U.S. National Science
Foundation National Center for Atmospheric Research (NSF NCAR) on behalf of
NSF. As any download with the HTTPS protocol, using this function entails
some risk. To minimize the risk, the returned page is saved as plain text,
checked for conformity with the expected content, and if valid decoded into
an R data object. When using the default argument <code>file = NULL</code>, the
file used is a temporary one and is deleted before the function returns the
call, irrespective of it being conformant or not.
</p>
<p>The administrators of the Quick TUV Calculator at UCAR suggest a maximum
load of approximately 100 spectral simulations per day and user. For larger
workloads they encourage the local installation of the TUV model which is
open-source and freely available. A local installation, also allows access
to the full set of input parameters and outputs. Currently a local instance
of the TUV model can be called from R with package 'foqat'.
</p>


<h3>Note</h3>

<p>The Quick TUV calculator has multiple output modes that return
different types of computed values. The use of output mode 5 is hard-coded
in this function as other modes return summary values rather than spectral
data. Package 'foqat' provides a more flexible alternative supporting other
output modes in addition to mode 5.
</p>
<p>If the argument passed to <code>w.length</code> is a numeric vector, the range
and length are used to reconstruct the accepted parameters. The returned
spectrum has always a uniformly spaced wavelengths.
</p>
<p>When using this function, more detailed metadata are available than when
reading an output file, as not all the simulation input parameters are
listed in the output text.
</p>
<p>In interactive use of the Quick TUV Calculator, the same parameters as
accepted by <code>qtuv_s.e.irradiance()</code> as arguments are
entered through the web interface at 
<a href="https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/">https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/</a>. This page 
together with its documentation, can be consulted for additional
information on the parameters and the model.
</p>


<h3>References</h3>

<p><a href="https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/">https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/</a>. This
URL could change in the future as well as the server URL. The formal
parameter <code>server.url</code> was included only for use in such a case.
</p>
<p>Sasha Madronich (2017-2021) Tropospheric Ultraviolet and Visible radiation (TUV) 
model. <a href="https://www2.acom.ucar.edu/modeling/tropospheric-ultraviolet-and-visible-tuv-radiation-model">https://www2.acom.ucar.edu/modeling/tropospheric-ultraviolet-and-visible-tuv-radiation-model</a>.
Visited on 2024-08-29.
</p>

<hr>
<h2 id='read_ASTER_txt'>Read File downloaded from ASTER data base.</h2><span id='topic+read_ASTER_txt'></span>

<h3>Description</h3>

<p>Reads and parses the header of a test file as available through the
ASTER reflectance database. The Name field is retrieved and copied to
attribute &quot;what.measured&quot;. The header of the file is preserved as a comment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ASTER_txt(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  npixels = Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_ASTER_txt_+3A_file">file</code></td>
<td>
<p>character string</p>
</td></tr>
<tr><td><code id="read_ASTER_txt_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_ASTER_txt_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_ASTER_txt_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_ASTER_txt_+3A_tz">tz</code></td>
<td>
<p>character Ignored.</p>
</td></tr>
<tr><td><code id="read_ASTER_txt_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_ASTER_txt_+3A_npixels">npixels</code></td>
<td>
<p>integer Number of pixels in spectral data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A raw_spct object.
</p>


<h3>Note</h3>

<p>The header in these files has metadata information, but mostly on the
origin of the data. For a date and/or geocode are to be added to the return
object it must be supplied by the user.  as well as the date-time. Some
metadata is extracted and added as attributes, while the whole header is
copied to the <code>comment</code> attribute.
</p>


<h3>References</h3>

<p><a href="https://speclib.jpl.nasa.gov">https://speclib.jpl.nasa.gov</a>
</p>
<p>Baldridge, A.; Hook, S.; Grove, C. &amp; Rivera, G. (2009) The ASTER spectral 
library version 2.0. Remote Sensing of Environment. 113, 711-715
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 file.name &lt;- 
   system.file("extdata", "drygrass-spectrum.txt", 
               package = "photobiologyInOut", mustWork = TRUE)
                
 fred.spct &lt;- read_ASTER_txt(file = file.name, npixels = Inf)
 
 fred.spct
 getWhatMeasured(fred.spct)
 cat(comment(fred.spct))
 
</code></pre>

<hr>
<h2 id='read_avaspec_csv'>Read '.csv' File Saved by Avantes' Software for AvaSpec.</h2><span id='topic+read_avaspec_csv'></span><span id='topic+read_avaspec_xls'></span>

<h3>Description</h3>

<p>Reads and parses the header of a processed data file as output by the
program Avaspec and then imports wavelength and spectral irradiance
values. The file header has little useful metadata information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_avaspec_csv(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)

read_avaspec_xls(
  path,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_avaspec_csv_+3A_file">file</code></td>
<td>
<p>character string</p>
</td></tr>
<tr><td><code id="read_avaspec_csv_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_avaspec_csv_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_avaspec_csv_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_avaspec_csv_+3A_tz">tz</code></td>
<td>
<p>character Time zone used for interpreting times saved in the
file header.</p>
</td></tr>
<tr><td><code id="read_avaspec_csv_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_avaspec_csv_+3A_path">path</code></td>
<td>
<p>Path to the xls/xlsx file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A source_spct object.
</p>


<h3>References</h3>

<p><a href="https://www.avantes.com/">https://www.avantes.com/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 file.name &lt;- 
    system.file("extdata", "spectrum-avaspec.csv", 
                package = "photobiologyInOut", mustWork = TRUE)
                
 avaspec.spct &lt;- read_avaspec_csv(file = file.name)
 
 avaspec.spct
 getWhatMeasured(avaspec.spct)
 cat(comment(avaspec.spct))
 
</code></pre>

<hr>
<h2 id='read_cid_spectravue_csv'>Read File Saved by CID's SpectraVue.</h2><span id='topic+read_cid_spectravue_csv'></span>

<h3>Description</h3>

<p>Read wavelength and spectral data from Measurements.CSV files exported from
CID Bio-Sciences' <strong>SpectraVue CI-710s</strong> (not the older CI-710!) leaf
spectrometer, importing them into R. Available metadata is also extracted
from the file. <code>read_cid_spectravue_csv()</code> only accepts &quot;row oriented&quot;
CSV files. These may contain multiple spectra, one per row.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_cid_spectravue_csv(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  range = c(380, 1100),
  simplify = TRUE,
  absorbance.to = "object",
  strict.range = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_cid_spectravue_csv_+3A_file">file</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date and time are extracted
from the file.</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>. If <code>NULL</code>, the default, the
geocode is extracted from the file, if present, and if <code>NA</code> the
&quot;where.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_label">label</code></td>
<td>
<p>character string. If <code>NULL</code>, the default, the value of the
&quot;tag&quot; present in the file is used, and if <code>NA</code> the &quot;what.measured&quot;
attribute is not set.</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_tz">tz</code></td>
<td>
<p>character Time zone is by default that of the machine's locale.</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_range">range</code></td>
<td>
<p>numeric A vector of length two, or any other object for which
function <code>range()</code> will return range of wavelengths expressed in
nanometres.</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_simplify">simplify</code></td>
<td>
<p>logical If TRUE, single spectra are returned as individual
spectra instead of collections of length one.</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_absorbance.to">absorbance.to</code></td>
<td>
<p>character Affects only absorbance measurements:
<code>"object"</code>, <code>"all"</code> or <code>"A"</code>.</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_strict.range">strict.range</code></td>
<td>
<p>logical Flag indicating whether off-range values result
in an error (<code>TRUE</code>) instead of a warning (<code>FALSE</code>), or the test
is disabled (<code>NA</code>).</p>
</td></tr>
<tr><td><code id="read_cid_spectravue_csv_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the constructor of the
'filter_spct' object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>SpectraVue's row-wise spectral <code>Measurements.CSV</code> files contain
columns with metadata on the right edge, followed by columns with data for
each of the 2048 pixels or wavelengths. The value in column &quot;Mode&quot;
indicates the quantity measured, decoded into variables <code>Tpc</code>,
<code>Rpc</code> or <code>A</code>. The data the rows in the CSV file are read and
stored in <code>filter_spct</code>,  <code>reflector_spct</code> or <code>object_spct</code>
objects. These objects are collected into a single <code>filter_mspct</code>,
<code>reflector_mspct</code>, <code>object_mspct</code> or <code>generic_spct</code> object
and returned.
</p>
<p>Spectral data outside the range 400 nm to 1000 nm are very noisy and thus
outside the valid range for the measurements. Out-of-range spectral data
can also be cause by calibration drift. Consequently, reading of data is
done always with the range check disabled, while whether a check is used
before returning the collection of spectra depends on the argument passed
to <code>strict.range</code> which by default is set to disable checks. This is
done, because in most cases measurements from this instrument tend to
require further processing before they comply with theoretical expectations
of <code class="reqn">Tfr + Rfr + Afr = 1</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>filter_spct</code>, <code>relector_spct</code>,
<code>object_spct</code> or <code>generic_mspct</code>.
</p>


<h3>Internal <em>vs.</em> total transmittance and absorbance</h3>

<p>Spectravue
returns transmittance values labelled with <code>Transmittance</code> as
<code>Mode</code>. Transmittance values are not <em>total</em> as most of the
scattered light transmitted is not detected. Absorbance (<code>Abs</code>) values
returned labelled with <code>Absorbance</code> as <code>Mode</code> are for absorbance
computed from the Transmittance. This estimate of absorbance overestimates
real absorbance in the case of scattering materials like plant leaves. It
is best to save spectral data acquired as absorbance into objects of class
'object_spct' containing reflectance and transmittance, the default, as
this preserves all the acquired data.
</p>


<h3>Specular <em>vs.</em> total reflectance</h3>

<p>This function assumes that
SpectraVue returns close to <em>total</em> reflectance readings. Given the optics
of the instrument this is likely only an approximation.
</p>


<h3>Warning!!</h3>

<p>CID's support has answered on 2022-05-19 that the extremely biased (plainly
wrong!) values of transmittance measured by this instrument are due to a
design flaw and that they are working on a solution for the problem. In
practice, reflectance seems biased but usable as an instrument-specific
quantity with arbitrary units. Transmittance and absorbance seem useless as
values are wrong by about an order of magnitude.
</p>


<h3>Note</h3>

<p>SpectraVue creates three or four <code>.CSV</code> files for each series of
measurements saved. Of these files, this function reads the one with name
ending in <code>Measurements.CSV</code>. The first part of the file name gives
the time of the session, but as the files can contain multiple spectra
measured at different times, the time metadata is extracted separately for
each spectrum. We provide a default argument for <code>range</code> that discards
data for short and long wavelengths because values outside this range are
according to the instrument's manual outside the usable range and in
practice extremely noisy.
</p>


<h3>References</h3>

<p><em>https://cid-inc.com/</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# read file containing a single reflectaance spectrum

 file.name &lt;-
   system.file("extdata", "cid-spectravue-Rpc-Measurements.csv",
               package = "photobiologyInOut", mustWork = TRUE)

 cid_filter.spct &lt;-
   read_cid_spectravue_csv(file = file.name)
 summary(cid_filter.spct)

 cid_filter.spct &lt;-
   read_cid_spectravue_csv(file = file.name, simplify = FALSE)
 summary(cid_filter.spct)

 # read data measured as absorbance (A, Rpc and Tpc)

 file.name &lt;-
   system.file("extdata", "cid-spectravue-Abs-Measurements.csv",
               package = "photobiologyInOut", mustWork = TRUE)
 cid.object_spct &lt;-
   read_cid_spectravue_csv(file = file.name)
 summary(cid.object_spct)

 cid_A.filter_spct &lt;-
   read_cid_spectravue_csv(file = file.name, absorbance.to = "A")
 summary(cid_A.filter_spct)

</code></pre>

<hr>
<h2 id='read_CIE_csv'>Read '.CSV' files from CIE</h2><span id='topic+read_CIE_csv'></span>

<h3>Description</h3>

<p>Reads a CSV spectral data file and its companion JSON file with metadata as
published by <em>International Commission on Illumination</em> (CIE) and then 
imports wavelengths and spectral values into one the classes for spectral
data defined in package 'photobiology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_CIE_csv(file.name, label = NULL, simplify = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_CIE_csv_+3A_file.name">file.name</code></td>
<td>
<p>character string Name of CSV file.</p>
</td></tr>
<tr><td><code id="read_CIE_csv_+3A_label">label</code></td>
<td>
<p>character string. If <code>NULL</code> metadata read from the
JSON file is used, and if <code>NA</code> the <code>"what.measured"</code> attribute 
is not set, and if a character string is passed, it is used to set 
the <code>"what.measured"</code> attribute.</p>
</td></tr>
<tr><td><code id="read_CIE_csv_+3A_simplify">simplify</code></td>
<td>
<p>logical If <code>TRUE</code> and the read file contained a single
spectrum, extract the spectral object from the collection.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CSV file contains only numbers encoded as character strings, and the
JSON file contains extensive metadata. The type of spectral data is encoded
as part of the file name. If the original file name of the CSV file is passed
as argument to parameter <code>file</code>, the function can retrieve all data and
metadata, enough to return an R object of the correct class. The JSON file
must be located in the same folder as the CSV file.
</p>


<h3>Value</h3>

<p>Depending on the contents of the file, a <code>source_mspct</code> or
<code>source_spct</code> object, a <code>response_spct</code> or <code>response_spct</code>
object, or a <code>chroma_spct</code> object, containing both data and metadata.
The whole metadata JSON converted into an R 'list' is stored in attribute
&quot;header&quot;.
</p>


<h3>References</h3>

<p><a href="https://cie.co.at/data-tables">https://cie.co.at/data-tables</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file.name &lt;- 
  system.file("extdata", "CIE_illum_C.csv", 
              package = "photobiologyInOut", mustWork = TRUE)

CIE_illum_C.spct &lt;- read_CIE_csv(file.name)
CIE_illum_C.spct
   
file.name &lt;- 
  system.file("extdata", "CIE_sle_photopic.csv", 
              package = "photobiologyInOut", mustWork = TRUE)

CIE_sle_photopic.spct &lt;- read_CIE_csv(file.name)
CIE_sle_photopic.spct
   
</code></pre>

<hr>
<h2 id='read_csi_dat'>Read '.DAT' file(s) saved by modern Campbell Scientific loggers.</h2><span id='topic+read_csi_dat'></span>

<h3>Description</h3>

<p>Reads and parses the header of a processed data file as output by the PC400
or PC200W programmes extracting variable names, units and quantities from the
header. Uses the comment attribute to store the metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_csi_dat(
  file,
  geocode = NULL,
  label = NULL,
  data_skip = 0,
  n_max = Inf,
  locale = readr::default_locale(),
  na = c("", "NA", "NAN"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_csi_dat_+3A_file">file</code></td>
<td>
<p>Path to file as a character string.</p>
</td></tr>
<tr><td><code id="read_csi_dat_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_csi_dat_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_csi_dat_+3A_data_skip">data_skip</code></td>
<td>
<p>integer Number of records (rows) to skip from the actual
data block.</p>
</td></tr>
<tr><td><code id="read_csi_dat_+3A_n_max">n_max</code></td>
<td>
<p>integer Maximum number of records to read.</p>
</td></tr>
<tr><td><code id="read_csi_dat_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use 
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things 
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_csi_dat_+3A_na">na</code></td>
<td>
<p>character Vector of strings to interpret as missing values. Set 
this option to character() to indicate no missing values.</p>
</td></tr>
<tr><td><code id="read_csi_dat_+3A_...">...</code></td>
<td>
<p>Further named arguments currently passed to <code>read_csv()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>read_csi_dat()</code> returns a <code>tibble::tibble</code> object.
</p>


<h3>Note</h3>

<p>This function is not useful for .DAT and .PRN files from old CSI
loggers and software. Those were simple files, lacking metadata, which was
stored in separate .FLD files.
</p>


<h3>References</h3>

<p><a href="https://www.campbellsci.eu/">https://www.campbellsci.eu/</a>
</p>

<hr>
<h2 id='read_fmi_cum'>Read daily cummulated solar spectrum data file(s).</h2><span id='topic+read_fmi_cum'></span><span id='topic+read_m_fmi_cum'></span>

<h3>Description</h3>

<p>Read one or more cumulated daily spectral irradiance file as output by Anders
Lindors' model based on libRadTrans. Dates are read from the file header and
parsed with the function suplied as <code>date.f</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_fmi_cum(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = "UTC",
  locale = readr::default_locale(),
  .skip = 3,
  .n_max = -1,
  .date.f = lubridate::ymd
)

read_m_fmi_cum(
  files,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = "UTC",
  .skip = 3,
  .n_max = -1,
  .date.f = lubridate::ymd
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_fmi_cum_+3A_file">file</code></td>
<td>
<p>Either a path to a file, a connection, or literal data (either a
single string or a raw vector).</p>
</td></tr>
<tr><td><code id="read_fmi_cum_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_fmi_cum_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_fmi_cum_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_fmi_cum_+3A_tz">tz</code></td>
<td>
<p>character Time zone used for interpreting times saved in the file
header.</p>
</td></tr>
<tr><td><code id="read_fmi_cum_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_fmi_cum_+3A_.skip">.skip</code></td>
<td>
<p>Number of lines to skip before reading data&mdash;i.e. the number of
rows in the header.</p>
</td></tr>
<tr><td><code id="read_fmi_cum_+3A_.n_max">.n_max</code></td>
<td>
<p>Maximum number of records to read.</p>
</td></tr>
<tr><td><code id="read_fmi_cum_+3A_.date.f">.date.f</code></td>
<td>
<p>A function for extracting a date-time from the file header
passed as charecter sring to its first argument and which returns a
<code>POSIXct</code> object.</p>
</td></tr>
<tr><td><code id="read_fmi_cum_+3A_files">files</code></td>
<td>
<p>list or vector of paths each one with the same requirements as
described for argument <code>file</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>read_fmi_cum()</code> returns a <code>source_spct</code> object with
<code>time.unit</code> attribute set to <code>"day"</code> and <code>when.measured</code>
attribute set to the date-time extracted from the header at the top of
the read file.
</p>
<p><code>read_m_fmi_cum</code> returns a <code>source_mspct</code> containing one
<code>source_spct</code> object for each one of the multiple files read.
</p>


<h3>Note</h3>

<p>See <code><a href="readr.html#topic+read_table">read_table</a></code> for details of acceptable values
for <code>file</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file.name &lt;- system.file("extdata", "2014-08-21_cum.hel", 
                         package = "photobiologyInOut", mustWork = TRUE)
fmi.spct &lt;- read_fmi_cum(file = file.name)
  
</code></pre>

<hr>
<h2 id='read_fmi2mspct'>Read multiple solar spectra from a data file.</h2><span id='topic+read_fmi2mspct'></span>

<h3>Description</h3>

<p>Read spectral irradiance file as output by Anders Lindors' model based on
libRadTrans for hourly simulation, or measured data from FMI's Brewer
spectrometer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_fmi2mspct(
  file,
  scale.factor = 0.001,
  geocode = NULL,
  what.measured = NULL,
  how.measured = NULL,
  date.field = 2L,
  time.field = 3L,
  date.format = "ymd",
  time.format = "hms",
  tz = NULL,
  time.shift.min = 0,
  locale = readr::default_locale(),
  .skip = 0,
  .n_max = -1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_fmi2mspct_+3A_file">file</code></td>
<td>
<p>Either a path to a file, a connection, or literal data (either a
single string or a raw vector).</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_scale.factor">scale.factor</code></td>
<td>
<p>numeric A multiplier to be applied to the spectral
irradiance values.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_what.measured">what.measured</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of
<code>file</code> is used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not
set.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_how.measured">how.measured</code></td>
<td>
<p>character string, but if <code>NULL</code> or <code>NA</code> the
&quot;how.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_date.field">date.field</code>, <code id="read_fmi2mspct_+3A_time.field">time.field</code></td>
<td>
<p>integer. Word positions in the header line.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_date.format">date.format</code></td>
<td>
<p>character string. One of &quot;ymd&quot;, &quot;ydm&quot;, &quot;dmy&quot;, or &quot;mdy&quot;.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_time.format">time.format</code></td>
<td>
<p>character string. One of &quot;hms&quot;, &quot;hm&quot;.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_tz">tz</code></td>
<td>
<p>character Time zone used for interpreting times saved in the file
header.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_time.shift.min">time.shift.min</code></td>
<td>
<p>numeric. Time shift with respect to TZ in minutes.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_.skip">.skip</code></td>
<td>
<p>Number of lines to skip before reading data.</p>
</td></tr>
<tr><td><code id="read_fmi2mspct_+3A_.n_max">.n_max</code></td>
<td>
<p>Maximum number of records to read.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>read_fmi2mspct()</code> returns a <code>source_mspct</code> object
containing <code>source_spct</code> objects as members, <code>time.unit</code>
attribute set to <code>"second"</code> and <code>when.measured</code> attribute set to
the date-time values extracted from the file body.
</p>


<h3>Note</h3>

<p>See <code><a href="readr.html#topic+read_table">read_table</a></code> for details of acceptable values
for <code>file</code>. Individual spectra are names based on time and date in ISO
format, at the time zone given by <code>tz</code> but the time shift subtracted.
Say for times expressed in headers at UTC + 120 min, we use <code>tz = UTC</code>
and <code>time.shift.min = 120</code> to convert times to UTC. This is different
from using <code>tz = Europe/Helsinki</code>, which is not invariant through the course of
the year because of daylight saving time. Local time zones is not
necessarily consistent across years because of changes in legislation. In
contrast UTC is more consistent, making it preferable for time series.
</p>

<hr>
<h2 id='read_foreign2mspct'>Read multiple foreign files with spectral data</h2><span id='topic+read_foreign2mspct'></span>

<h3>Description</h3>

<p>Read spectra from a homogeneous list of files based on a path and a list of
filenames or a path and a search pattern for files. The imported spectra are
returned as a single object of one of the collection of spectra classes from
package 'photobiology'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_foreign2mspct(path = ".", list = NULL, pattern = NULL, .fun, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_foreign2mspct_+3A_path">path</code></td>
<td>
<p>character A path point to the location of the files.</p>
</td></tr>
<tr><td><code id="read_foreign2mspct_+3A_list">list</code></td>
<td>
<p>character A vector or list of character strings pointing to
files relative to <code>path</code>,</p>
</td></tr>
<tr><td><code id="read_foreign2mspct_+3A_pattern">pattern</code></td>
<td>
<p>character A search pattern to select files within <code>path</code>.
See <code><a href="base.html#topic+list.files">list.files</a></code> which is used internally. Argument ignored
is list is non-null.</p>
</td></tr>
<tr><td><code id="read_foreign2mspct_+3A_.fun">.fun</code></td>
<td>
<p>function One of the functions exported by this package for
reading spectral data.</p>
</td></tr>
<tr><td><code id="read_foreign2mspct_+3A_...">...</code></td>
<td>
<p>Named arguments passed ot the call to <code>.fun</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function iterates over a list of file names reading them with
the function passed as argument to '.fun' and combines the spectra as a
collection of spectra of a class suitable for the spectral objects returned
by the argument to '.fun'. This function can either return for each file
read either a single spectrum as an object of class 'generic_spct' or a
class derived from it, or a collection of spectra of class 'generic_mspct'
or a class derived from it. The class of the returned object depends on
the class of the member spectra.
</p>


<h3>Value</h3>

<p>An object of class 'generic_mspct' or a class derived from it, 
containing a collection of member spectra of class 'generic_spct' or of 
one of the classes derived from it.
</p>

<hr>
<h2 id='read_FReD_csv'>Read '.CSV' FReD database.</h2><span id='topic+read_FReD_csv'></span>

<h3>Description</h3>

<p>Reads a CSV data file downloaded from the FReD (Floral Reflectance Database)
and then imports wavelengths and spectral reflectance values and flower ID.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_FReD_csv(
  file,
  date = NA,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_FReD_csv_+3A_file">file</code></td>
<td>
<p>character string</p>
</td></tr>
<tr><td><code id="read_FReD_csv_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_FReD_csv_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_FReD_csv_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_FReD_csv_+3A_tz">tz</code></td>
<td>
<p>character Time zone used for interpreting times saved in the
file header.</p>
</td></tr>
<tr><td><code id="read_FReD_csv_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names. Those relevant should match the format of the CSV file being read.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A reflectance_spct object.
</p>


<h3>References</h3>

<p><a href="http://www.reflectance.co.uk">http://www.reflectance.co.uk</a>
Arnold SEJ, Faruq S, Savolainen V, McOwan PW, Chittka L, 2010 FReD: The 
Floral Reflectance Database - A Web Portal for Analyses of Flower Colour. 
PLoS ONE 5(12): e14287. doi:10.1371/journal.pone.0014287
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  file.name &lt;- 
    system.file("extdata", "FReDflowerID_157.csv", 
                package = "photobiologyInOut", mustWork = TRUE)
                
  fred.spct &lt;- read_FReD_csv(file = file.name)
  
  fred.spct
  getWhatMeasured(fred.spct)
  cat(comment(fred.spct))
  
</code></pre>

<hr>
<h2 id='read_li180_txt'>Read '.TXT' File(s) Saved by LI-COR's LI-180 spectroradiometer.</h2><span id='topic+read_li180_txt'></span><span id='topic+read_m_li180_txt'></span>

<h3>Description</h3>

<p>Reads and parses the header of a data file as output by the LI-180
spectrometer (not to be confused with the LI-1800 spectrometer released in
the 1980's by LI-COR) to extract the whole header remark field and also
decode whether data is in photon or energy based units. This is a new
instrument released in year 2020.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_li180_txt(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  s.qty = "s.e.irrad"
)

read_m_li180_txt(
  files,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = Sys.timezone(),
  locale = readr::default_locale(),
  s.qty = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_li180_txt_+3A_file">file</code></td>
<td>
<p>Path to file as a character string.</p>
</td></tr>
<tr><td><code id="read_li180_txt_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_li180_txt_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_li180_txt_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_li180_txt_+3A_tz">tz</code></td>
<td>
<p>character Time zone used for interpreting times saved in the
file header.</p>
</td></tr>
<tr><td><code id="read_li180_txt_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_li180_txt_+3A_s.qty">s.qty</code></td>
<td>
<p>character The name of the spectral quantity to be read. One of
&quot;s.e.irrad&quot; or &quot;s.q.irrad&quot;.</p>
</td></tr>
<tr><td><code id="read_li180_txt_+3A_files">files</code></td>
<td>
<p>A list or vector of character strings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>read_m_licor_espd()</code> calls <code>red_licor_espd()</code> 
for each file in <code>files</code>. See <code><a href="utils.html#topic+read.table">read.table</a></code> for
a description of valid arguments for <code>files</code>.
</p>


<h3>Value</h3>

<p><code>read_licor_espd()</code> returns a <code>source_spct</code> object with
<code>time.unit</code> attribute set to <code>"second"</code> and <code>when.measured</code>
attribute set to the date-time extracted from the file header, or supplied
by the user. Spectrometer model, serial number and integration time are
stored in attributes. The whole file header is saved as a <code>comment</code>
while the footer is discarded.
</p>
<p>Function <code>read_m_licor_espd()</code> returns a source_mspct object
containing one spectrum per file read.
</p>


<h3>Note</h3>

<p>The LI-180 spectroradiometer stores little information of the
instrument and settings, possibly because they cannot be altered by the
user or configured. The length of the file header does not seem to be
fixed, so the start of the spectral data is detected by searching for
&quot;380nm&quot;.
</p>


<h3>References</h3>

<p>LI-COR Biosciences, Environmental.
<a href="https://www.licor.com/env/">https://www.licor.com/env/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  file.name &lt;- 
    system.file("extdata", "LI-180-irradiance.txt", 
                package = "photobiologyInOut", mustWork = TRUE)
                
  licor180.spct &lt;- read_li180_txt(file = file.name)
  
  licor180.spct
  getWhenMeasured(licor180.spct)
  getWhatMeasured(licor180.spct)
  cat(comment(licor180.spct))
  
</code></pre>

<hr>
<h2 id='read_licor_prn'>Read '.PRN' File(s) Saved by LI-COR's PC1800 Program.</h2><span id='topic+read_licor_prn'></span><span id='topic+read_m_licor_prn'></span>

<h3>Description</h3>

<p>Read and parse the header of a processed data file as output by the PC1800
program to extract the whole header remark field and also decode whether data
is irradiance in photon or energy based units, transmittance, reflectance or
absorbance and then extract the wavelength and spectral data. PC1800 is an
MS-DOS program provided for use with the LI-1800 spectrometer. This
instrument was released in the 1980's and was sold until the early 2000's. It
was very popular and several of them remain in use. (It should not be
confused with the LI-180, a new spectrometer released released in 2020.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_licor_prn(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  s.qty = NULL
)

read_m_licor_prn(
  files,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  s.qty = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_licor_prn_+3A_file">file</code></td>
<td>
<p>Path to file as a character string.</p>
</td></tr>
<tr><td><code id="read_licor_prn_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_licor_prn_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_licor_prn_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_licor_prn_+3A_tz">tz</code></td>
<td>
<p>character Time zone used for interpreting times saved in the
file header.</p>
</td></tr>
<tr><td><code id="read_licor_prn_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_licor_prn_+3A_s.qty">s.qty</code></td>
<td>
<p>character The name of the spectral quantity to be read. One of
&quot;s.irrad&quot;, &quot;Tfr&quot;, or &quot;Rfr&quot;.</p>
</td></tr>
<tr><td><code id="read_licor_prn_+3A_files">files</code></td>
<td>
<p>A list or vector of character strings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>read_m_licor_prn()</code> calls <code>red_licor_prn()</code> 
for each file in <code>files</code>. See <code><a href="readr.html#topic+read_table">read_table</a></code> for
a description of valid arguments for <code>files</code>.
</p>


<h3>Value</h3>

<p><code>read_licor_prn()</code> returns a <code>source_spct</code> object with
<code>time.unit</code> attribute set to <code>"second"</code> and <code>when.measured</code>
attribute set to the date-time extracted from the file name, or supplied.
</p>
<p>Function <code>read_m_licor_prn()</code> returns a source_mspct object
containing one spectrum per file read.
</p>


<h3>Note</h3>

<p>The LI-1800 spectroradiometer does not store the year as part of the
data, only month, day, and time of day. Because of this, in the current
version, if <code>NULL</code> is the argument to date, year is set to 0000.
In addition, the argument passed to <code>tz</code> does not recognize &quot;summer-time&quot; 
shifts if the year is unknown (date read from the file header).
</p>


<h3>References</h3>

<p>LI-COR Biosciences, Environmental.
<a href="https://www.licor.com/env/">https://www.licor.com/env/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 file.name &lt;- 
   system.file("extdata", "spectrum.PRN", 
               package = "photobiologyInOut", mustWork = TRUE)
                
 licor.spct &lt;- read_licor_prn(file = file.name)
 
 licor.spct
 getWhenMeasured(licor.spct)
 getWhatMeasured(licor.spct)
 cat(comment(licor.spct))

</code></pre>

<hr>
<h2 id='read_macam_dta'>Read '.DTA' File Saved by Macam's Software.</h2><span id='topic+read_macam_dta'></span>

<h3>Description</h3>

<p>Reads and parses the header of a processed data file as output by the PC
program to extract the time and date fields and a user label if present,
and then imports wavelengths and spectral energy irradiance values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_macam_dta(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_macam_dta_+3A_file">file</code></td>
<td>
<p>character string</p>
</td></tr>
<tr><td><code id="read_macam_dta_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_macam_dta_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_macam_dta_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_macam_dta_+3A_tz">tz</code></td>
<td>
<p>character Time zone used for interpreting times saved in the
file header.</p>
</td></tr>
<tr><td><code id="read_macam_dta_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>source_spct</code> object.
</p>


<h3>References</h3>

<p><a href="https://www.irradian.co.uk/">https://www.irradian.co.uk/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 file.name &lt;- 
   system.file("extdata", "spectrum.DTA", 
               package = "photobiologyInOut", mustWork = TRUE)
                
 macam.spct &lt;- read_macam_dta(file = file.name)
 
 macam.spct
 getWhenMeasured(macam.spct)
 getWhatMeasured(macam.spct)
 cat(comment(macam.spct))

</code></pre>

<hr>
<h2 id='read_oo_jazirrad'>Read Files Saved by Ocean Optics' Jaz spectrometer.</h2><span id='topic+read_oo_jazirrad'></span><span id='topic+read_oo_jazpc'></span><span id='topic+read_oo_jazdata'></span>

<h3>Description</h3>

<p>Reads and parses the header of processed data text files output by
Jaz instruments extracting the spectral data from the body of the file 
and the metadata, including time and date of measurement from the header.
Jaz modular spectrometers were manufactured by Ocean Optics.
The company formerly named Ocean Optics is now called Ocean Insight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_oo_jazirrad(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)

read_oo_jazpc(
  file,
  qty.in = "Tpc",
  Tfr.type = c("total", "internal"),
  Rfr.type = c("total", "specular"),
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)

read_oo_jazdata(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_oo_jazirrad_+3A_file">file</code></td>
<td>
<p>character string.</p>
</td></tr>
<tr><td><code id="read_oo_jazirrad_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_oo_jazirrad_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_oo_jazirrad_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_oo_jazirrad_+3A_tz">tz</code></td>
<td>
<p>character Time zone used for interpreting times saved in the file
header.</p>
</td></tr>
<tr><td><code id="read_oo_jazirrad_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_oo_jazirrad_+3A_qty.in">qty.in</code></td>
<td>
<p>character string, one of &quot;Tpc&quot; (spectral transmittance, %), &quot;A&quot;
(spectral absorbance), or &quot;Rpc&quot; (spectral reflectance, %).</p>
</td></tr>
<tr><td><code id="read_oo_jazirrad_+3A_tfr.type">Tfr.type</code></td>
<td>
<p>character string, either &quot;total&quot; or &quot;internal&quot;.</p>
</td></tr>
<tr><td><code id="read_oo_jazirrad_+3A_rfr.type">Rfr.type</code></td>
<td>
<p>character string, either &quot;total&quot; or &quot;specular&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>read_oo_jazirrad</code> can read processed irradiance
output files. Function <code>read_oo_jazpc</code> can read processed transmittance
and reflectance output files (expressed as %s). Function 
<code>read_oo_jazdata</code> can read raw-counts data.
</p>


<h3>Value</h3>

<p>A source_spct object, a filter_spct object, a reflector_spct object
or a raw_spct object.
</p>


<h3>Note</h3>

<p>Although the parameter is called <code>date</code> a date time is accepted 
and expected. Time resolution is &lt; 1 s if seconds are entered with a
decimal fraction, such as &quot;2021-10-05 10:10:10.1234&quot;.
</p>


<h3>References</h3>

<p><a href="https://www.oceanoptics.com/">https://www.oceanoptics.com/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 file.name &lt;- 
   system.file("extdata", "spectrum.jaz", 
               package = "photobiologyInOut", mustWork = TRUE)
                
 jaz.spct &lt;- read_oo_jazpc(file = file.name)
 
 jaz.spct
 getWhenMeasured(jaz.spct)
 getWhatMeasured(jaz.spct)
 cat(comment(jaz.spct))

</code></pre>

<hr>
<h2 id='read_oo_pidata'>Read File Saved by Ocean Optics' Raspberry Pi software.</h2><span id='topic+read_oo_pidata'></span>

<h3>Description</h3>

<p>Reads and parses the header of a raw data file as output by the server
running on a Raspberry Pi board to extract the whole header remark field. The
time field is retrieved and decoded. 
The company formerly named Ocean Optics is now called Ocean Insight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_oo_pidata(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  npixels = Inf,
  spectrometer.sn = "FLMS00673"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_oo_pidata_+3A_file">file</code></td>
<td>
<p>character string</p>
</td></tr>
<tr><td><code id="read_oo_pidata_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is set to the file
modification date.</p>
</td></tr>
<tr><td><code id="read_oo_pidata_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_oo_pidata_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_oo_pidata_+3A_tz">tz</code></td>
<td>
<p>character Time zone is not saved to the file.</p>
</td></tr>
<tr><td><code id="read_oo_pidata_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_oo_pidata_+3A_npixels">npixels</code></td>
<td>
<p>integer Number of pixels in spectral data.</p>
</td></tr>
<tr><td><code id="read_oo_pidata_+3A_spectrometer.sn">spectrometer.sn</code></td>
<td>
<p>character The serial number of the spectrometer needs
to be supplied by the user as it is not included in the file header.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A raw_spct object.
</p>


<h3>Note</h3>

<p>The header in these files has very little information.
The file contains a time in milliseconds but as the Raspberry Pi board
contains no real-time clock, it seems to default to number of milliseconds
since the Pi was switched on. The user may wish to supply the date-time as
an argument, but if no argument is passed to <code>date</code> this
attribute is set to the file modification date obtained with <code>file.mtime()</code>.
This date-time gives an upper limit to the real time of measurement as in
some operating systems it is reset when the file is copied or even without
any good apparent reason. The user may need to supply the number of pixels 
in the array although the default of <code>npixels = Inf</code> usually works
and triggers no warnings.
</p>


<h3>References</h3>

<p><a href="https://www.oceanoptics.com/">https://www.oceanoptics.com/</a> <a href="https://www.raspberrypi.org/">https://www.raspberrypi.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 file.name &lt;- 
   system.file("extdata", "spectrum.pi", 
               package = "photobiologyInOut", mustWork = TRUE)
                
 oopi.spct &lt;- read_oo_pidata(file = file.name)
 
 oopi.spct
 getWhenMeasured(oopi.spct)
 getWhatMeasured(oopi.spct)
 cat(comment(oopi.spct))

</code></pre>

<hr>
<h2 id='read_oo_ssirrad'>Read File Saved by Ocean Optics' SpectraSuite.</h2><span id='topic+read_oo_ssirrad'></span><span id='topic+read_oo_ssdata'></span>

<h3>Description</h3>

<p>Reads and parses the header of a processed data file as output by
SpectraSuite to extract the whole header remark field. The time field is
retrieved and decoded. SpectraSuite was a program, now replaced by OceanView.
The company formerly named Ocean Optics is now called Ocean Insight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_oo_ssirrad(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)

read_oo_ssdata(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_oo_ssirrad_+3A_file">file</code></td>
<td>
<p>character string</p>
</td></tr>
<tr><td><code id="read_oo_ssirrad_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_oo_ssirrad_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_oo_ssirrad_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_oo_ssirrad_+3A_tz">tz</code></td>
<td>
<p>character Time zone is by default read from the file.</p>
</td></tr>
<tr><td><code id="read_oo_ssirrad_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A source_spct object.
</p>
<p>A raw_spct object.
</p>


<h3>References</h3>

<p><a href="https://www.oceanoptics.com/">https://www.oceanoptics.com/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 file.name &lt;- 
   system.file("extdata", "spectrum.SSIrrad", 
               package = "photobiologyInOut", mustWork = TRUE)
                
 ooss.spct &lt;- read_oo_ssirrad(file = file.name)
 
 ooss.spct
 getWhenMeasured(ooss.spct)
 getWhatMeasured(ooss.spct)
 cat(comment(ooss.spct))

</code></pre>

<hr>
<h2 id='read_qtuv_txt'>Read Quick TUV output file.</h2><span id='topic+read_qtuv_txt'></span>

<h3>Description</h3>

<p>Reads and parses the header of a text file output by the Quick TUV on-line
web front-end at UCAR to extract the header and spectral data. The time field
is converted to a date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_qtuv_txt(
  file,
  ozone.du = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  added.vars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_qtuv_txt_+3A_file">file</code></td>
<td>
<p>character string with the name of a text file.</p>
</td></tr>
<tr><td><code id="read_qtuv_txt_+3A_ozone.du">ozone.du</code></td>
<td>
<p>numeric Ozone column in Dobson units.</p>
</td></tr>
<tr><td><code id="read_qtuv_txt_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_qtuv_txt_+3A_tz">tz</code></td>
<td>
<p>character Time zone is by default read from the file.</p>
</td></tr>
<tr><td><code id="read_qtuv_txt_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_qtuv_txt_+3A_added.vars">added.vars</code></td>
<td>
<p>character vector Accepted member values are <code>"sun.elevation"</code>,
<code>zenith.angle</code>, <code>"time"</code> and <code>"ozone.du"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a source_spct object obtained by finding the center of wavelength
intervals in the Quick TUV output file, and adding the variables listed
in <code>added.vars</code>. To obtain the same value as in version (&lt;= 0.4.28)
pass <code>added.vars = c("angle", "date")</code> in the call.
</p>


<h3>Note</h3>

<p>The ozone column value used in the simulation cannot be retrieved from
the file. Tested files from Quick TUV version 5.2 on 2018-07-30 and also
with more recent files in early 2024. This 
function can be expected to be robust to variations in the position of lines
in the imported file and resistant to the presence of extraneous text or
even summaries. By default web browsers save the output returned by the
Quick TUV calculator as an HTML output, some of them with minimal headers
and other with more extensive ones. In some cases, character escapes replace
actual new lines. In most cases these HTML files are decoded correctly, but
if not, use &quot;save as&quot; in the browser and select &quot;text&quot; when saving. As a
last recourse, messed up files can be manually edited before import.
</p>


<h3>References</h3>

<p><a href="https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/">https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/</a>
</p>

<hr>
<h2 id='read_spectrapen_csv'>Read '.CSV' File Saved by PSI's Software.</h2><span id='topic+read_spectrapen_csv'></span>

<h3>Description</h3>

<p>Reads and parses the header of a processed .CSV file as output by the by the
PSI (Photon Systems Instruments, Czech Republic) SpectraPen miniature
spectrometer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_spectrapen_csv(
  file,
  start.row = 1,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_spectrapen_csv_+3A_file">file</code></td>
<td>
<p>character string.</p>
</td></tr>
<tr><td><code id="read_spectrapen_csv_+3A_start.row">start.row</code></td>
<td>
<p>integer The first line to read, counting from the top of the
file.</p>
</td></tr>
<tr><td><code id="read_spectrapen_csv_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the file
header.</p>
</td></tr>
<tr><td><code id="read_spectrapen_csv_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>. If <code>NULL</code>, the default, the
location is extracted from the file header.</p>
</td></tr>
<tr><td><code id="read_spectrapen_csv_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the label from <code>file</code>
header is used, if the label is missing, the index is used, and if
<code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_spectrapen_csv_+3A_tz">tz</code></td>
<td>
<p>character Time zone used for interpreting times saved in the file
header.</p>
</td></tr>
<tr><td><code id="read_spectrapen_csv_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>source_mspct</code> object.
</p>


<h3>References</h3>

<p><a href="https://psi.cz/">https://psi.cz/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # fetch path to example file to read
 file.name &lt;-
   system.file("extdata", "spectrum-psi-spectrapen-SP.csv",
               package = "photobiologyInOut", mustWork = TRUE)

 spectrapen.mspct &lt;- read_spectrapen_csv(file = file.name)

 spectrapen.mspct
 getWhenMeasured(spectrapen.mspct)
 getWhatMeasured(spectrapen.mspct)
 cat(comment(spectrapen.mspct))

</code></pre>

<hr>
<h2 id='read_tuv_usrout'>Read TUV output file.</h2><span id='topic+read_tuv_usrout'></span><span id='topic+read_tuv_usrout2mspct'></span>

<h3>Description</h3>

<p>Reads and parses the header of a text file output by the TUV program to
extract the header and spectral data. The time field is converted to a date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_tuv_usrout(
  file,
  ozone.du = NULL,
  date = lubridate::today(),
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)

read_tuv_usrout2mspct(
  file,
  ozone.du = NULL,
  date = lubridate::today(),
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_tuv_usrout_+3A_file">file</code></td>
<td>
<p>character string</p>
</td></tr>
<tr><td><code id="read_tuv_usrout_+3A_ozone.du">ozone.du</code></td>
<td>
<p>numeric Ozone column in Dobson units.</p>
</td></tr>
<tr><td><code id="read_tuv_usrout_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_tuv_usrout_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_tuv_usrout_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_tuv_usrout_+3A_tz">tz</code></td>
<td>
<p>character Time zone is by default read from the file.</p>
</td></tr>
<tr><td><code id="read_tuv_usrout_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a source_spct object obtained by 'melting' the TUV file, and adding a
factor <code>spct.idx</code>, and variables <code>zenith.angle</code> and <code>date</code>.
</p>


<h3>Note</h3>

<p>The ozone column value used in the simulation cannot be retrieved from
the file. Tested only with TUV version 5.0.
</p>


<h3>References</h3>

<p><a href="https://www2.acom.ucar.edu/modeling/tropospheric-ultraviolet-and-visible-tuv-radiation-model">https://www2.acom.ucar.edu/modeling/tropospheric-ultraviolet-and-visible-tuv-radiation-model</a>
</p>

<hr>
<h2 id='read_uvspec_disort'>Read libRadtran's uvspec output file.</h2><span id='topic+read_uvspec_disort'></span>

<h3>Description</h3>

<p>Read and parse a text file output by libRadtran's uvspec routine for a solar 
spectrum simulation. The output of uvspec depends among other things on the
solver used. We define a family of functions, each function for a different
solver.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_uvspec_disort(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  multiplier = 0.001,
  qty = "irradiance"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_uvspec_disort_+3A_file">file</code></td>
<td>
<p>character string</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_+3A_tz">tz</code></td>
<td>
<p>character Time zone is by default read from the file.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_+3A_multiplier">multiplier</code></td>
<td>
<p>numeric A multiplier for conversion into W m-2 nm-1, as
the units of expression of the output from &quot;uvspec&quot; depend on the units
in which the extraterrestrial solar spectrum data is expressed.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_+3A_qty">qty</code></td>
<td>
<p>character &quot;uvspec&quot; returns both irradiance and intensity with
solver &quot;disort&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A source_spct object.
</p>


<h3>Note</h3>

<p>Currently only &quot;irradiance&quot; is suported as qty argument as intensity is
not supported by classes and methods in package 'photobiology'.
</p>
<p>Tested only with libRadtran version 2.0
</p>


<h3>References</h3>

<p><a href="https://www.r4photobiology.info">https://www.r4photobiology.info</a> <a href="http://www.libradtran.org">http://www.libradtran.org</a>
</p>

<hr>
<h2 id='read_uvspec_disort_vesa'>Read libRadtran's uvspec output file from batch job.</h2><span id='topic+read_uvspec_disort_vesa'></span>

<h3>Description</h3>

<p>Reads and parses the header and body of a text file output by a script used 
to run libRadtran's uvspec in a batch joib for a set of solar spectrum 
simulations. The header and time and date fields are converted into a 
datetime object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_uvspec_disort_vesa(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  multiplier = 1e-06,
  simplify = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_uvspec_disort_vesa_+3A_file">file</code></td>
<td>
<p>character string</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_vesa_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date is extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_vesa_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_vesa_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_vesa_+3A_tz">tz</code></td>
<td>
<p>character Time zone is by default read from the file.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_vesa_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_vesa_+3A_multiplier">multiplier</code></td>
<td>
<p>numeric A multiplier for conversion into W m-2 nm-1, as
the units of expression of the output from &quot;uvspec&quot; depend on the units
in which the extraterrestrial solar spectrum data is expressed.</p>
</td></tr>
<tr><td><code id="read_uvspec_disort_vesa_+3A_simplify">simplify</code></td>
<td>
<p>logical Remove redundant columns from returned object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a source_spct object, possibly containing several spectra in long
form and a datetime column.
</p>


<h3>References</h3>

<p><a href="http://www.libradtran.org">http://www.libradtran.org</a>
</p>

<hr>
<h2 id='read_wasatch_csv'>Read File Saved by Wasatch's Enlighten.</h2><span id='topic+read_wasatch_csv'></span>

<h3>Description</h3>

<p>Read wavelength and spectral data from the data section of a file as
output by Enlighten importing them into R. Parse the header of a file to
extract the acquisition time, instrument name and serial number, as well
additional metadata related to the instrument and its settings. Function
<code>read_wasatch_csv()</code> only accepts &quot;column oriented&quot; CSV files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_wasatch_csv(
  file,
  date = NULL,
  geocode = NULL,
  label = NULL,
  tz = NULL,
  locale = readr::default_locale(),
  s.qty = NULL,
  extra.cols = "keep",
  scale.factor = 1,
  simplify = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_wasatch_csv_+3A_file">file</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_date">date</code></td>
<td>
<p>a <code>POSIXct</code> object to use to set the <code>"when.measured"</code>
attribute. If <code>NULL</code>, the default, the date and time are extracted from the
file header.</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_tz">tz</code></td>
<td>
<p>character Time zone is by default that of the machine's locale.</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_s.qty">s.qty</code></td>
<td>
<p>character, possibly named. The name of the quantity using the
conventions accepted used in package 'photobiology' that is to be imported
from column &quot;Processed&quot; from the file.</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_extra.cols">extra.cols</code></td>
<td>
<p>character What to do non-processed data columns if present 
in file. One of <code>"keep"</code>, <code>"drop.pixel"</code>, <code>"drop"</code> or 
<code>"split"</code>.</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_scale.factor">scale.factor</code></td>
<td>
<p>numeric vector of length 1, or length equal to the number
of rows (= detector pixels). Numeric multiplier applied to returned
spectral values.</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_simplify">simplify</code></td>
<td>
<p>logical If TRUE, single spectra are returned as individual 
spectra instead of collections of length one.</p>
</td></tr>
<tr><td><code id="read_wasatch_csv_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the constructor of the spectrum
object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Enlighten's column-wise CSV files contain at least two columns,
Wavelength and Processed. In the header the Technique used is recorded.
Additional data columns can be present. Column Pixel contains the pixel
index in the array as integers. Columns Raw, Dark and Reference contain
detector counts data. Technique is used to guess the type of spectrum
stored in the column named Processed, which can be detector counts or
derived values. By default the data are read into a single spectrum object
and all columns retained, but only the data in Processed are interpreted as
spectral data corresponding to the class of the object. If passed
<code>extra.cols = "drop"</code>, only Wavelength and Processed are copied to the
returned object, while if passed <code>extra.cols = "drop.pixel"</code> only the
contents of column Pixel are discarded. If passed <code>extra.cols =
  "split"</code> all columns containing spectral data are each read into a separate
spectrum, these are collected and a &quot;generic_mspct&quot; object containing them
returned. <code>extra.cols</code> can be a named vector of mappings, of length at
least one but possibly longer. If longer a &quot;generic_mspct&quot; is returned,
otherwise a spectrum object as inferred from the name each column is mapped
to.
</p>


<h3>Value</h3>

<p>An object of a class derived from <code>generic_spct</code> such as
<code>raw_spct</code> or <code>filter_spct</code>. <code>generic_spct</code> is derived from
tibble and data frame.
</p>


<h3>Acknowledgements</h3>

<p>We thank Ruud Niesen from Photon Mission 
(<a href="https://photonmission.com/">https://photonmission.com/</a>) for organizing the loan of the
spectrometer used to produce the various files needed for the development of 
this function.
</p>


<h3>Note</h3>

<p>Enlighten, the free software from Wasatch Photonics can save spectra in
a variety of additional formats: different types of CSV files, plain text
and JSON. Plain text files contain no metadata or even column headers and
if the need arises can be read with R function <code>read.table()</code>. JSON
files contain the most detailed metadata.
</p>


<h3>References</h3>

<p><a href="https://wasatchphotonics.com/">https://wasatchphotonics.com/</a>
<a href="https://wasatchphotonics.com/product-category/software/">https://wasatchphotonics.com/product-category/software/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 file.name &lt;- 
   system.file("extdata", "enlighten-wasatch-scope.csv",
               package = "photobiologyInOut", mustWork = TRUE)
              
 wasatch.raw.spct &lt;- 
   read_wasatch_csv(file = file.name)
 summary(wasatch.raw.spct)

 wasatch.raw.spct &lt;- 
   read_wasatch_csv(file = file.name, s.qty = "counts")
 summary(wasatch.raw.spct)

 wasatch.raw.spct &lt;- 
   read_wasatch_csv(file = file.name, s.qty = c(Processed = "counts"))
 summary(wasatch.raw.spct)

 wasatch.raw.spct &lt;- 
   read_wasatch_csv(file = file.name, extra.cols = "drop")
 summary(wasatch.raw.spct)

</code></pre>

<hr>
<h2 id='read_yoctopuce_csv'>Read '.CSV' file(s) downloaded from YoctoPuce modules.</h2><span id='topic+read_yoctopuce_csv'></span>

<h3>Description</h3>

<p>Reads and parses the header of processed data CSV files as output by the
virtual- or hardware-hubs and modules from Yoctopuce. Uses the comment
attribute to store the metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_yoctopuce_csv(
  file,
  geocode = NULL,
  label = NULL,
  data_skip = 0,
  n_max = Inf,
  locale = readr::default_locale()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_yoctopuce_csv_+3A_file">file</code></td>
<td>
<p>Path to file as a character string.</p>
</td></tr>
<tr><td><code id="read_yoctopuce_csv_+3A_geocode">geocode</code></td>
<td>
<p>A data frame with columns <code>lon</code> and <code>lat</code> used to
set attribute <code>"where.measured"</code>.</p>
</td></tr>
<tr><td><code id="read_yoctopuce_csv_+3A_label">label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the &quot;what.measured&quot; attribute is not set.</p>
</td></tr>
<tr><td><code id="read_yoctopuce_csv_+3A_data_skip">data_skip</code></td>
<td>
<p>integer Number of records (rows) to skip from the actual
data block.</p>
</td></tr>
<tr><td><code id="read_yoctopuce_csv_+3A_n_max">n_max</code></td>
<td>
<p>integer Maximum number of records to read.</p>
</td></tr>
<tr><td><code id="read_yoctopuce_csv_+3A_locale">locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code><a href="readr.html#topic+locale">locale</a></code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Yoctopuce modules are small USB connected and USB powered, but
isolated, very high quality miniature data acquisition and interface
modules. All modules capable of data acquisition can log measured data
autonomously and these data can be locally or remotely downloaded as a CSV
file. (It is also possible and very easy to access these modules from R
using package 'reticulate' and the Python library provided by Yoctopuce, or
to send commands and retrieve data through the built-in HTML server of the
modules or dedicated hubs.)
</p>


<h3>Value</h3>

<p><code>read_yoctopuce_csv()</code> returns a <code>tibble::tibble</code> object,
with the number of columns dependent on the CSV file read.
</p>


<h3>Note</h3>

<p>This function should be able to read data log files from any YoctoPuce
USB interface module with data logging capabilities as the format is
consistent among them.
</p>


<h3>References</h3>

<p><a href="https://www.yoctopuce.com/">https://www.yoctopuce.com/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  # We read a CSV file previously downloaded from a YoctoMeteo module.

 file.name &lt;- 
   system.file("extdata", "yoctopuce-data.csv", 
               package = "photobiologyInOut", mustWork = TRUE)
                
 yoctopc.tb &lt;- read_yoctopuce_csv(file = file.name)
 
 yoctopc.tb
 cat(comment(yoctopc.tb))

</code></pre>

<hr>
<h2 id='rspec2mspct'>Convert &quot;pavo::rspec&quot; objects</h2><span id='topic+rspec2mspct'></span><span id='topic+rspec2spct'></span>

<h3>Description</h3>

<p>Convert between 'pavo::rspec' objects containing spectral reflectance data 
into spectral objects (xxxx_spct, xxxx_mspct) as defined in package
'photobiology'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rspec2mspct(
  x,
  member.class = "reflector_spct",
  spct.data.var = "Rpc",
  multiplier = 1,
  ...
)

rspec2spct(x, multiplier = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rspec2mspct_+3A_x">x</code></td>
<td>
<p>rspec object</p>
</td></tr>
<tr><td><code id="rspec2mspct_+3A_member.class">member.class</code></td>
<td>
<p>character One of the spectrum classes defined in package 
'photobiology'.</p>
</td></tr>
<tr><td><code id="rspec2mspct_+3A_spct.data.var">spct.data.var</code></td>
<td>
<p>character The name to be used for the 'spc' data when 
constructing the spectral objects.</p>
</td></tr>
<tr><td><code id="rspec2mspct_+3A_multiplier">multiplier</code></td>
<td>
<p>numeric A multiplier to be applied to the 'rspc' data to do
unit or scale conversion.</p>
</td></tr>
<tr><td><code id="rspec2mspct_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Warning!</h3>

<p>Always check the sanity of the imported or exported data 
values, as guessing is needed when matching the different classes, and the 
functions defined here are NOT guaranteed to return valid data wihtout help
from the user through optional function arguments.
</p>


<h3>Note</h3>

<p>Objects of class <code>pavo::rspec</code> do not contain metadata or class 
data from which the quantity measured and the units of expression could be 
obtained. When using this function the user needs to use parameter 
<code>multiplier</code> to convert the data to what is expected by the object 
constructors defined in package 'photobiology' and use parameter 
<code>spct.data.var</code> to select the quantity.
</p>
<p><code>pavo::rspec</code> objects may use memory more efficiently than spectral 
objects of the classes for collections of spectra defined in package 
'photobiology' as wavelengths are assumed to be the same for all member 
spectra, and stored only once while this assumption is not made for 
collections of spectra, allowing different wavelengths and lengths for the 
component spectra. Wavelengths are stored for each spectrum, but as 
spectral classes are derived from 'tbl_df' in many cases no redundant 
copies of wavelength data will be made in memory in spite of the more 
flexible semantics of the objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example run only if 'pavo' is available
if (requireNamespace("pavo", quietly = TRUE)) {
  library(pavo)
  data(sicalis, package = "pavo")
  sicalis.mspct &lt;- rspec2mspct(sicalis)
  class(sicalis.mspct)

  data(teal, package = "pavo")
  teal.spct &lt;- rspec2spct(teal)
  class(teal.spct)
  levels(teal.spct[["spct.idx"]])
  angles &lt;- seq(from = 15, to = 75, by = 5) # from teal's documentation
  teal.spct[["angle"]] &lt;- angles[as.numeric(teal.spct[["spct.idx"]])]
  teal.spct
}

</code></pre>

<hr>
<h2 id='spct_CCT'>Correlated color temperature</h2><span id='topic+spct_CCT'></span>

<h3>Description</h3>

<p>Wrapper on function <code><a href="colorSpec.html#topic+computeCCT">computeCCT</a></code> from package
'colorSpec' that accepts <code><a href="photobiology.html#topic+source_spct">source_spct</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spct_CCT(
  spct,
  isotherms = "robertson",
  locus = "robertson",
  strict = FALSE,
  named = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spct_CCT_+3A_spct">spct</code></td>
<td>
<p>source_spct A single light source spectrum.</p>
</td></tr>
<tr><td><code id="spct_CCT_+3A_isotherms">isotherms</code></td>
<td>
<p>character A vector whose elements match one of the available
isotherm families: 'robertson', 'mccamy', and 'native'. Matching is partial
and case-insensitive. When more than one family is given, a matrix is
returned, see Value. When isotherms = 'native' the isotherms are defined
implicitly as lines perpendicular to the locus, see Details in
<code><a href="spacesXYZ.html#topic+CCTfromXYZ">CCTfromXYZ</a></code>. The character NA
(<code>NA_character_</code>) is taken as a synonym for 'native'.</p>
</td></tr>
<tr><td><code id="spct_CCT_+3A_locus">locus</code></td>
<td>
<p>character Valid values are 'robertson' and 'precision', see
above. Matching is partial and case-insensitive.</p>
</td></tr>
<tr><td><code id="spct_CCT_+3A_strict">strict</code></td>
<td>
<p>logical The CIE considers the CCT of a chromaticity uv to be
meaningful only if the distance from uv to the Planckian locus is less than
or equal to 0.05 (in CIE UCS 1960). If strict=FALSE, then this condition is
ignored. Otherwise, the distance is computed along the corresponding
isotherm, and if it exceeds 0.05 the returned CCT is set to NA.</p>
</td></tr>
<tr><td><code id="spct_CCT_+3A_named">named</code></td>
<td>
<p>logical Whether to set the name attribute of the returned
value to the name of the spectrum passed as argument if possible.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please see <code><a href="colorSpec.html#topic+computeCCT">computeCCT</a></code> for the details of
the computations and references.
</p>


<h3>Value</h3>

<p>A numeric value for &quot;color temperature &quot; in degrees Kelvin.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
spct_CCT(white_led.source_spct)
spct_CCT(sun.spct)

</code></pre>

<hr>
<h2 id='spct_CRI'>Color reproduction index</h2><span id='topic+spct_CRI'></span>

<h3>Description</h3>

<p>Wrapper on function <code><a href="colorSpec.html#topic+computeCRI">computeCRI</a></code> from package
'colorSpec' that accepts <code><a href="photobiology.html#topic+source_spct">source_spct</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spct_CRI(spct, adapt = TRUE, attach = FALSE, tol = 0.0054, named = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spct_CRI_+3A_spct">spct</code></td>
<td>
<p>source_spct A single light source spectrum.</p>
</td></tr>
<tr><td><code id="spct_CRI_+3A_adapt">adapt</code></td>
<td>
<p>logical If TRUE, then a special chromatic adaption is performed,
see Details in <code><a href="colorSpec.html#topic+computeCRI">computeCRI</a></code>.</p>
</td></tr>
<tr><td><code id="spct_CRI_+3A_attach">attach</code></td>
<td>
<p>logical If TRUE, then a large list of intermediate calculations
is attached to the returned number, as attribute data. This attached list
includes data for all special 14 color samples, although the last 6 do not
affect the returned CRI</p>
</td></tr>
<tr><td><code id="spct_CRI_+3A_tol">tol</code></td>
<td>
<p>numeric For the CRI to be meaningful the chromaticities of the
test and reference illuminants must be sufficiently close in the CIE 1960
uniform chromaticity space. If the tolerance is exceeded, the function
returns NA. The default tol=5.4e-3 is the one recommended by the CIE, but
the argument allows the user to override it.</p>
</td></tr>
<tr><td><code id="spct_CRI_+3A_named">named</code></td>
<td>
<p>logical Whether to set the name attribute of the returned
value to the name of the spectrum passed as argument if possible.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please see <code><a href="colorSpec.html#topic+computeCRI">computeCRI</a></code> for the details of
the computations and references.
</p>


<h3>Value</h3>

<p>A numeric value between zero and 100, or NA if the light is not
white enough.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
spct_CRI(white_led.source_spct)
spct_CRI(sun.spct)

</code></pre>

<hr>
<h2 id='spct_SSI'>Spectral (color) similarity index</h2><span id='topic+spct_SSI'></span>

<h3>Description</h3>

<p>Wrapper on function <code><a href="colorSpec.html#topic+computeSSI">computeSSI</a></code> from package
'colorSpec' that accepts <code><a href="photobiology.html#topic+source_spct">source_spct</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spct_SSI(
  spct,
  reference.spct = NULL,
  digits = 0,
  isotherms = "mccamy",
  locus = "robertson",
  named = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spct_SSI_+3A_spct">spct</code>, <code id="spct_SSI_+3A_reference.spct">reference.spct</code></td>
<td>
<p>source_spct Single light source spectra.</p>
</td></tr>
<tr><td><code id="spct_SSI_+3A_digits">digits</code></td>
<td>
<p>integer The number of digits after the decimal point in the
returned vector. According to Holm the output should be rounded to the
nearest integer, which corresponds to <code>digits = 0</code>. To return full
precision, set <code>digits = Inf</code>.</p>
</td></tr>
<tr><td><code id="spct_SSI_+3A_isotherms">isotherms</code></td>
<td>
<p>character This is only used when reference=NULL. It is
passed to <code><a href="colorSpec.html#topic+computeCCT">computeCCT</a></code> in order to compute the CCT
of each test spectrum.</p>
</td></tr>
<tr><td><code id="spct_SSI_+3A_locus">locus</code></td>
<td>
<p>character This is only used when reference=NULL. It is
passed to <code><a href="colorSpec.html#topic+computeCCT">computeCCT</a></code> in order to compute the CCT
of each test spectrum.</p>
</td></tr>
<tr><td><code id="spct_SSI_+3A_named">named</code></td>
<td>
<p>logical Whether to set the name attribute of the returned
value to the name of the spectrum passed as argument if possible.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please see <code><a href="colorSpec.html#topic+computeSSI">computeSSI</a></code> for the details of
the computations and references.
</p>


<h3>Value</h3>

<p>A numeric value between zero and 100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
spct_SSI(white_led.source_spct, sun.spct)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
