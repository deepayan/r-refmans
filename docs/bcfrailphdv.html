<!DOCTYPE html><html lang="en"><head><title>Help for package bcfrailphdv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bcfrailphdv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bcfraildv'><p>Semi-parametric bivariate correlated frailty models fit.</p></a></li>
<li><a href='#bcfraildv.control'><p>Arguments for controlling bcfraildv fits.</p></a></li>
<li><a href='#bcfrailpar'><p>Parametric bivariate correlated frailty models fit.</p></a></li>
<li><a href='#print.bcfraildv'><p>Print bcfraildv</p></a></li>
<li><a href='#print.bcfrailpar'><p>Print bcfrailpar</p></a></li>
<li><a href='#simbcfraildv'><p>Simulate data from bivariate correlated frailty models.</p></a></li>
<li><a href='#summary.bcfraildv'><p>Print bcfraildv</p></a></li>
<li><a href='#summary.bcfrailpar'><p>Print bcfrailpar</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bivariate Correlated Frailty Models with Varied Variances</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit and simulate bivariate correlated frailty models with
    proportional hazard structure. Frailty distributions, such as gamma and
    lognormal models are supported for semiparametric procedures. Frailty variances of the two subjects 
    can be varied or equal. Details on the models are available in book of 
    Wienke (2011,ISBN:978-1-4200-7388-1). Bivariate gamma fit is obtained using the approach given 
    in Iachine (1995) with modifications. Lognormal fit is based on the approach
    by Ripatti and Palmgren (2000) &lt;<a href="https://doi.org/10.1111%2Fj.0006-341X.2000.01016.x">doi:10.1111/j.0006-341X.2000.01016.x</a>&gt;. Frailty distributions, 
    such as gamma, inverse gaussian and power variance frailty models are supported for parametric approach.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0),survival,bcfrailph (&ge; 0.1.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-14 12:35:22 UTC; user</td>
</tr>
<tr>
<td>Author:</td>
<td>Mesfin Tsegaye [aut, cre],
  Yehenew Kifle [aut, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mesfin Tsegaye &lt;mesfin.tsegaye@ddu.edu.et&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-14 13:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='bcfraildv'>Semi-parametric bivariate correlated frailty models fit.</h2><span id='topic+bcfraildv'></span>

<h3>Description</h3>

<p>Fit a semiparametric Bivariate correlated frailty model with Proportional Hazard structure. Here, frailty variances of pairs can be different.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcfraildv(
  formula,
  data,
  initfrailp = NULL,
  frailty = c("gamma", "lognormal"),
  control = bcfraildv.control(),
  comonvar = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcfraildv_+3A_formula">formula</code></td>
<td>
<p>A formula object, with the response on the left of a ~ operator, and the terms on the right. The response must be a survival object as returned by the Surv function.</p>
</td></tr>
<tr><td><code id="bcfraildv_+3A_data">data</code></td>
<td>
<p>A dataframe contain survival time, censor, covariate etc with data in columns.</p>
</td></tr>
<tr><td><code id="bcfraildv_+3A_initfrailp">initfrailp</code></td>
<td>
<p>Initial estimates for the frailty parameters. If not specified, initial frailty parameters will be obtained from bcfrailph fit for gamma model and from coxph with univariate frailty model and for correlation c(0) for lognormal model.</p>
</td></tr>
<tr><td><code id="bcfraildv_+3A_frailty">frailty</code></td>
<td>
<p>A type of frailty distribution to be used in fit. Either gamma or lognormal. The default is gamma.</p>
</td></tr>
<tr><td><code id="bcfraildv_+3A_control">control</code></td>
<td>
<p>Arguments to control bcfraildv fit. The default is <code><a href="#topic+bcfraildv.control">bcfraildv.control</a></code>.</p>
</td></tr>
<tr><td><code id="bcfraildv_+3A_comonvar">comonvar</code></td>
<td>
<p>An argument whether to assume common frailty variance. The default is <code>comonvar=FALSE</code>. If <code>comonvar=TRUE</code>, then the result of bcfrailph fit is displayed.</p>
</td></tr>
<tr><td><code id="bcfraildv_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of  that contains  the following components.
</p>

<ul>
<li> <p><code>coefficients</code> - A vector of estimated Covariate coefficients.
</p>
</li>
<li> <p><code>frailparest</code> - A vector of estimated Frailty parameters i.e. frailty variance and correlation.
</p>
</li>
<li> <p><code>stderr</code>-A vector containing the Standard error of the Estimated parameters both covariate coefficients and  frailty parameters.
</p>
</li>
<li> <p><code>loglilk0</code>- Log likelihood of without frailty model or loglik of coxph fit.
</p>
</li>
<li> <p><code>loglilk</code>-Log likelihood of Cox PH model with frailty.
</p>
</li>
<li> <p><code>Iloglilk</code>- Log likelihood of with frailty. For gamma fit it is I-likelihood or the likelihood after integrating out the frailty term.For lognormal fit it is the approximate likelihood.
</p>
</li>
<li> <p><code>bhaz</code>- an array containing unique event times and estimated baseline hazard.
</p>
</li>
<li> <p><code>X</code>-Matrix of observed covariates.
</p>
</li>
<li> <p><code>time</code>-the observed survival time.
</p>
</li>
<li> <p><code>censor</code>-censoring indicator.
</p>
</li>
<li> <p><code>resid</code>-the martingale residuals.
</p>
</li>
<li> <p><code>lin.prid</code>-the vector of linear predictors.
</p>
</li>
<li> <p><code>frail</code>-estimated Frailty values.
</p>
</li>
<li> <p><code>iteration</code>-Number of outer iterations.
</p>
</li>
<li> <p><code>e.time</code>-the vector of unique event times.
</p>
</li>
<li> <p><code>n.event</code>- the number of events at each of the unique event times.
</p>
</li>
<li> <p><code>convergence</code>-an indicator, 0 if converge and 1 otherwise.
</p>
</li></ul>



<h3>Note</h3>

<p>Parameters of Bivariate correlated gamma frailty model was estimated using a modified EM approach given in Kifle et al (2022) with modification for different frailty variances in a pair.
Parameters of Bivariate correlated lognormal frailty model is based on the penalized partial likelihood approach by Rippatti and Palmgren (2000).
</p>


<h3>References</h3>

<p>Kifle YG, Chen DG, Haileyesus MT (2022). Multivariate Frailty Models using Survey Weights with Applications to Twins Infant Mortality in Ethiopia. Statistics and Its Interface,106(4), 1\-10.
</p>
<p>Rippatti, S. and Palmgren, J (2000). Estimation of multivariate frailty models using penalized partial likelihood. Biometrics, 56: 1016-1022.
</p>


<h3>See Also</h3>

<p><code><a href="bcfrailph.html#topic+bcfrailph">bcfrailph</a></code>, <code><a href="#topic+simbcfraildv">simbcfraildv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4)
simdata&lt;-simbcfraildv(psize=300, cenr= c(0.3),beta=c(2),frailty=c("gamma"),
frailpar=c(0.5,0.5,0.5),bhaz=c("weibull"),
bhazpar=list(shape =c(5), scale = c(0.1)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data

fitbcfrail=bcfraildv(Surv(time,censor)~ X1+frailty(PID) ,data=dataa,frailty="gamma")
fitbcfrail


# for lognormal

set.seed(18)
simdata&lt;-simbcfraildv(psize=100, cenr= c(0.2),beta=c(1,-0.7,0.5),
frailty=c("lognormal"),frailpar=c(0.5,0.5,-0.25),bhaz=c("exponential"),
bhazpar=list(scale = c(0.1)),covartype= c("N","N","B"),
covarpar=list(fargs=c(0,0,1),sargs=c(1,1,0.5)),comncovar=2)
dataa&lt;-simdata$data

#fit
fitbcfrlogn=bcfraildv(Surv(time,censor)~ X1+X2+X3+frailty(PID) ,data=dataa,frailty="lognormal")
fitbcfrlogn

set.seed(4)
simdata&lt;-simbcfraildv(psize=300, cenr= c(0.3),beta=c(2),frailty=c("gamma"),
frailpar=c(0.5,0.5,0.5),bhaz=c("weibull"),
bhazpar=list(shape =c(5), scale = c(0.1)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data

## one can set the initial parameter for the frailty parameters
fitbcfrail=bcfraildv(Surv(time,censor)~ X1+frailty(PID) ,data=dataa,
frailty="gamma",initfrailp = c(0.2,0.2,0.4))
fitbcfrail

# Not run

#if covariates are not included
fitmoe=try(bcfraildv(Surv(time,censor)~0+frailty(PID),data=dataa,
frailty="lognormal"),silent = TRUE)

fitmoe=try(bcfraildv(Surv(time,censor)~1+frailty(PID),data=dataa),silent = TRUE)

# if control is not specified correctly.
# if one needs to change only max.iter to be 100,

fitmoe=try(bcfraildv(Surv(time,censor)~ X1+frailty(PID),data=dataa,
control=c(max.iter=100)),silent = TRUE)

#the correct way is
fitmoe=bcfraildv(Surv(time,censor)~ X1+frailty(PID),data=dataa,
control=bcfraildv.control(max.iter=100))
fitmoe

#if initial frailty parameters are in the boundary of parameter space
fitmoe=try(bcfraildv(Surv(time,censor)~ X1+frailty(PID),data=dataa,
initfrailp=c(0.2,0.3,1)),silent = TRUE)

fitmoe=try(bcfraildv(Surv(time,censor)~ X1+frailty(PID),data=dataa,
initfrailp=c(0,0.5,0.1)),silent = TRUE)

#if a frailty distribution other than gamma and lognormal are specified

fitmoe=try(bcfraildv(Surv(time,censor)~ X1,data=dataa,frailty="exp"),silent = TRUE)

# End Not run


</code></pre>

<hr>
<h2 id='bcfraildv.control'>Arguments for controlling bcfraildv fits.</h2><span id='topic+bcfraildv.control'></span>

<h3>Description</h3>

<p>This is used to set various numeric parameters controlling a bcfraildv model fit as a single list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcfraildv.control(
  max.iter = 500,
  tol = 1e-04,
  eval.max = 500,
  iter.max = 500,
  trace = 0,
  abs.tol = 1e-20,
  rel.tol = 1e-10,
  x.tol = 1.5e-08,
  xf.tol = 2.2e-14,
  step.min = 1,
  step.max = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcfraildv.control_+3A_max.iter">max.iter</code></td>
<td>
<p>Maximum number of iterations allowed. The default is 500.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_tol">tol</code></td>
<td>
<p>A tolerance for convergence i.e the maximum differences of loglikelihood between succssive iterations.The default is 1e-04.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_eval.max">eval.max</code></td>
<td>
<p>argument used to control <a href="stats.html#topic+nlminb">nlminb</a> fits used.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_iter.max">iter.max</code></td>
<td>
<p>argument used to control <a href="stats.html#topic+nlminb">nlminb</a> fits used.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_trace">trace</code></td>
<td>
<p>argument used to control <a href="stats.html#topic+nlminb">nlminb</a> fits used.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_abs.tol">abs.tol</code></td>
<td>
<p>argument used to control <a href="stats.html#topic+nlminb">nlminb</a> fits used.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_rel.tol">rel.tol</code></td>
<td>
<p>argument used to control <a href="stats.html#topic+nlminb">nlminb</a> fits used.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_x.tol">x.tol</code></td>
<td>
<p>argument used to control <a href="stats.html#topic+nlminb">nlminb</a> fits used.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_xf.tol">xf.tol</code></td>
<td>
<p>argument used to control <a href="stats.html#topic+nlminb">nlminb</a> fits used.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_step.min">step.min</code></td>
<td>
<p>argument used to control <a href="stats.html#topic+nlminb">nlminb</a> fits used.</p>
</td></tr>
<tr><td><code id="bcfraildv.control_+3A_step.max">step.max</code></td>
<td>
<p>argument used to control <a href="stats.html#topic+nlminb">nlminb</a> fits used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of control parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcfraildv">bcfraildv</a></code>
</p>

<hr>
<h2 id='bcfrailpar'>Parametric bivariate correlated frailty models fit.</h2><span id='topic+bcfrailpar'></span>

<h3>Description</h3>

<p>Fit a parametric Bivariate correlated gamma, inverse gaussian and power variance frailty models with Proportional Hazard structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcfrailpar(
  formula,
  data,
  initfrailp = NULL,
  inithazp = NULL,
  initbeta = NULL,
  haz = c("weibull", "gompertz", "exponential"),
  frailty = c("gamma", "invgauss", "pv"),
  comonvar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcfrailpar_+3A_formula">formula</code></td>
<td>
<p>A formula object, with the response on the left of a ~ operator, and the terms on the right. The response must be a survival object as returned by the Surv function.</p>
</td></tr>
<tr><td><code id="bcfrailpar_+3A_data">data</code></td>
<td>
<p>A dataframe contain survival time, censor, covariate etc with data in columns.</p>
</td></tr>
<tr><td><code id="bcfrailpar_+3A_initfrailp">initfrailp</code></td>
<td>
<p>Initial estimates for the frailty parameters. The default is c(0.5,0.5).</p>
</td></tr>
<tr><td><code id="bcfrailpar_+3A_inithazp">inithazp</code></td>
<td>
<p>Initial estimates for the baseline hazard distribution parameters. The default is c(0.05) for both scale and shape parameters.</p>
</td></tr>
<tr><td><code id="bcfrailpar_+3A_initbeta">initbeta</code></td>
<td>
<p>Initial estimates for the covariate coefficients if there are any included. The default is taken from coxph fit.</p>
</td></tr>
<tr><td><code id="bcfrailpar_+3A_haz">haz</code></td>
<td>
<p>A baseline hazard distribution. Either weibull, gompertz or exponential distributions are possible.</p>
</td></tr>
<tr><td><code id="bcfrailpar_+3A_frailty">frailty</code></td>
<td>
<p>A type of frailty distribution. Either gamma, inverse gaussian <code>frailty="invgauss"</code>  or power variance <code>frailty="pv"</code> frailty distributions are possible.</p>
</td></tr>
<tr><td><code id="bcfrailpar_+3A_comonvar">comonvar</code></td>
<td>
<p>An argument whether to assume common frailty variance. The default is <code>comonvar=TRUE</code>. If <code>comonvar=FALSE</code>, then only gamma frailty model is possible.</p>
</td></tr>
<tr><td><code id="bcfrailpar_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of  that contains  the following components.
</p>

<ul>
<li> <p><code>coefficients</code> - A vector of estimated Covariate coefficients.
</p>
</li>
<li> <p><code>frailparest</code> - A vector of estimated Frailty parameters i.e. frailty variance and correlation.
</p>
</li>
<li> <p><code>basehazpar</code> - A vector of estimated baseline hazard parameters i.e. scale and shape.
</p>
</li>
<li> <p><code>stderr</code>-A vector containing the Standard errors of the Estimated parameters with the order of frailty parameters,baseline hazard parameters and covariate coefficients.
</p>
</li>
<li> <p><code>vcov</code>- Variance Covariance matrix of the Estimated parameters.
</p>
</li>
<li> <p><code>loglik</code>-Log likelihood of the model.
</p>
</li>
<li> <p><code>AIC</code>-AIC of the model.
</p>
</li>
<li> <p><code>BIC</code>-BIC of the model.
</p>
</li>
<li> <p><code>iterations</code>-Number of outer iterations.See<a href="stats.html#topic+constrOptim">constrOptim</a> for further.
</p>
</li>
<li> <p><code>convergence</code>-An indicator of convergence. See<a href="stats.html#topic+constrOptim">constrOptim</a> for further.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4)
simdata&lt;-simbcfraildv(psize=500, cenr= c(0.3),beta=c(2),frailty=c("gamma"),
frailpar=c(0.5,0.5,0.5),bhaz=c("weibull"),
bhazpar=list(shape =c(5), scale = c(0.1)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data

fitbcfrail=bcfrailpar(Surv(time,censor)~ X1+frailty(PID) ,data=dataa,frailty="gamma")
fitbcfrail



set.seed(18)
simdata&lt;-simbcfraildv(psize=300, cenr= c(0.3),beta=c(2),frailty=c("gamma"),
frailpar=c(0.5,0.5,0.4),bhaz=c("weibull"),
bhazpar=list(shape =c(5), scale = c(0.1)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data

#fit with power variance frailty distribution
fitbcfrail=bcfrailpar(Surv(time,censor)~ X1+frailty(PID) ,data=dataa,
frailty="pv")
fitbcfrail

## one can set the initial parameter for the frailty parameters
fitbcfrail=bcfrailpar(Surv(time,censor)~ X1+frailty(PID) ,data=dataa,initfrailp = c(0.4,0.3),
frailty="gamma")
fitbcfrail

# Not run

#if initial frailty parameters are in the boundary of parameter space
fitmoe=try(bcfrailpar(Surv(time,censor)~ X1+frailty(PID),data=dataa,
initfrailp=c(0.2,1)),silent = TRUE)

#if a frailty distribution other than gamma, invgauss or pv is specified

fitmoe=try(bcfrailpar(Surv(time,censor)~ X1,data=dataa,frailty="exp"),silent = TRUE)

# End Not run


</code></pre>

<hr>
<h2 id='print.bcfraildv'>Print bcfraildv</h2><span id='topic+print.bcfraildv'></span>

<h3>Description</h3>

<p>Generics to print the S3 class bcfraildv.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcfraildv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bcfraildv_+3A_x">x</code></td>
<td>
<p>A class <code>bcfraildv</code> object.</p>
</td></tr>
<tr><td><code id="print.bcfraildv_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code>print.bcfraildv()</code>.
</p>


<h3>Value</h3>

<p>An object of <code>print.bcfraildv</code>, with some more human-readable results from <code>bcfraildv</code> object.
</p>


<h3>Note</h3>

<p>The summary function is currently identical to the print function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcfraildv">bcfraildv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4)
simdata&lt;-simbcfraildv(psize=300, cenr= c(0.3),beta=c(2),frailty=c("gamma"),
frailpar=c(0.5,0.5,0.5),bhaz=c("weibull"),
bhazpar=list(shape =c(5), scale = c(0.1)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data

fitbcfrail=bcfraildv(Surv(time,censor)~ X1+frailty(PID) ,data=dataa)
fitbcfrail
summary(fitbcfrail)

</code></pre>

<hr>
<h2 id='print.bcfrailpar'>Print bcfrailpar</h2><span id='topic+print.bcfrailpar'></span>

<h3>Description</h3>

<p>Generics to print the S3 class bcfrailpar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcfrailpar'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bcfrailpar_+3A_x">x</code></td>
<td>
<p>A class <code>bcfrailpar</code> object.</p>
</td></tr>
<tr><td><code id="print.bcfrailpar_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code>print.bcfrailpar()</code>.
</p>


<h3>Value</h3>

<p>An object of <code>print.bcfrailpar</code>, with some more human-readable results from <code>bcfrailpar</code> object.
</p>


<h3>Note</h3>

<p>The summary function is currently identical to the print function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcfrailpar">bcfrailpar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4)
simdata&lt;-simbcfraildv(psize=500, cenr= c(0),beta=c(-1),frailty=c("gamma"),
frailpar=c(0.4,0.4,0.5),bhaz=c("weibull"),
bhazpar=list(shape =c(0.9), scale = c(2)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data ## the simulated data set

#fit
parbcfit=bcfrailpar(Surv(time, censor) ~ X1+frailty(PID),data=dataa)
parbcfit

</code></pre>

<hr>
<h2 id='simbcfraildv'>Simulate data from bivariate correlated frailty models.</h2><span id='topic+simbcfraildv'></span>

<h3>Description</h3>

<p>Simulate data from bivariate correlated gamma or lognormal frailty models with one covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simbcfraildv(
  psize,
  cenr = c(0),
  beta = c(0.5),
  frailty,
  frailpar = c(0.5, 0.5, 0.25),
  bhaz = c("weibull"),
  bhazpar = list(shape = c(0.5), scale = c(0.01)),
  covartype = c("B"),
  covarpar = list(fargs = c(1), sargs = c(0.5)),
  inpcovar = NULL,
  inpcen = NULL,
  comncovar = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simbcfraildv_+3A_psize">psize</code></td>
<td>
<p>pair size.</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_cenr">cenr</code></td>
<td>
<p>censored rate. The default is zero..</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_beta">beta</code></td>
<td>
<p>Covariate coefficient.</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_frailty">frailty</code></td>
<td>
<p>A type of frailty distribution to be used. Either gamma or lognormal.</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_frailpar">frailpar</code></td>
<td>
<p>vector of frailty parameters, variance and correlation respectively. The default is c(0.5,0.5,0.25) meaning both variances are 0.5 and correlation 0.25.</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_bhaz">bhaz</code></td>
<td>
<p>A type of baseline hazard distribution to be used. it can be weibull, gompertz or exponential.</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_bhazpar">bhazpar</code></td>
<td>
<p>is a <code><a href="base.html#topic+list">list</a></code> containing <code>scale</code> and<code>shape</code> of the specified baseline hazard distribution.</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_covartype">covartype</code></td>
<td>
<p>specified the distribution from which covariate(s) are goining to be sampled. covartype can be c(&quot;B&quot;,&quot;N&quot;,&quot;U&quot;)denoting binomial, normal or uniform, respectively. For example, <code>covartype=c("B","B")</code> to generate two covariates both from a binomial distribution.</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_covarpar">covarpar</code></td>
<td>
<p>is a <code><a href="base.html#topic+list">list</a></code> containing parmeters of the specified covariate distribution with first and second arguments denoted by <code>fargs</code> and <code>sargs</code>, respectively. For example, if <code>covartype=c("B","U")</code> and <code>covarpar=list(fargs=c(1,0.3),sargs=c(0.5,1.3))</code>, generates two independent covariates from a binomial distribution (with parameters size=1 and probs=0.5) and from uniform distributions (with parameters min=0.3 and max=1.3).</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_inpcovar">inpcovar</code></td>
<td>
<p>is a <code><a href="base.html#topic+list">list</a></code> i.e,list(covar1=x1,covar2=x2) to input covariates with both x1 and x2 is in matrix form.</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_inpcen">inpcen</code></td>
<td>
<p>is a <code><a href="base.html#topic+list">list</a></code> containing <code>cent1</code> and <code>cent2</code> denoting censoring time for the first and the second subjects in pairs respectively.</p>
</td></tr>
<tr><td><code id="simbcfraildv_+3A_comncovar">comncovar</code></td>
<td>
<p>if common covariates are needed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>simbcfraildv</code> that contain the following:
</p>

<ul>
<li><p><code>data</code>  A data frame i.e, the simulated data set. IID is individual Id, PID is pair ID, time is the simulated survival time, censor is censoring indicator and X1 denote the simulated covariate.
</p>
</li>
<li><p><code>numberofpair</code>  The specified number of pairs.
</p>
</li>
<li><p><code>censoredrate</code>  The specified censored rate.
</p>
</li>
<li><p><code>fraildist</code>  The specified frailty distribution.
</p>
</li>
<li><p><code>frailpar</code> The specified frailty parameters.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+bcfraildv">bcfraildv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4)
simdata&lt;-simbcfraildv(psize=300, cenr= c(0.3),beta=c(2),frailty=c("gamma"),
frailpar=c(0.5,0.5,0.5),bhaz=c("weibull"),
bhazpar=list(shape =c(5), scale = c(0.1)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data
head(dataa)


# If data generation is from bivariate correlated lognormal frailty model,
set.seed(18)
simdata&lt;-simbcfraildv(psize=100, cenr= c(0.2),beta=c(1,-0.7,0.5),frailty=c("lognormal"),
frailpar=c(0.5,0.8,-0.25),bhaz=c("exponential"),
bhazpar=list(scale = c(0.1)),covartype= c("N","N","B"),
covarpar=list(fargs=c(0,0,1),sargs=c(1,1,0.5)))
dataa&lt;-simdata$data
head(dataa)

# If common covariate is desired, i.e., here out of the three covariates 
#covariate 2 is common for the pair.
set.seed(18)
simdata&lt;-simbcfraildv(psize=100, cenr= c(0.2),beta=c(1,-0.7,0.5),frailty=c("lognormal"),
frailpar=c(0.5,0.8,-0.25),bhaz=c("exponential"),
bhazpar=list(scale = c(0.1)),covartype= c("N","N","B"),
covarpar=list(fargs=c(0,0,1),sargs=c(1,1,0.5)),comncovar=2)
dataa&lt;-simdata$data
head(dataa)

# If the data generation is from bivariate correlated gamma frailty model,
#weibull baseline and without covariate,
set.seed(4)
simdata&lt;-simbcfraildv(psize=300, cenr= c(0.3),beta=NULL,frailty=c("gamma"),
frailpar=c(0.5,0.6,0.5),bhaz=c("weibull"),bhazpar=list(shape =c(5), scale = c(0.1)))
dataa&lt;-simdata$data
head(dataa)


</code></pre>

<hr>
<h2 id='summary.bcfraildv'>Print bcfraildv</h2><span id='topic+summary.bcfraildv'></span>

<h3>Description</h3>

<p>Generics to print the S3 class bcfraildv.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcfraildv'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bcfraildv_+3A_object">object</code></td>
<td>
<p>A class <code>bcfraildv</code> object.</p>
</td></tr>
<tr><td><code id="summary.bcfraildv_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code>print.bcfraildv()</code>.
</p>


<h3>Value</h3>

<p>An object of <code>print.bcfraildv</code>, with some more human-readable results from <code>bcfraildv</code> object.
</p>


<h3>Note</h3>

<p>The summary function is currently identical to the print function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcfraildv">bcfraildv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4)
simdata&lt;-simbcfraildv(psize=300, cenr= c(0.3),beta=c(2),frailty=c("gamma"),
frailpar=c(0.5,0.5,0.5),bhaz=c("weibull"),
bhazpar=list(shape =c(5), scale = c(0.1)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data

fitbcfrail=bcfraildv(Surv(time,censor)~ X1+frailty(PID) ,data=dataa)
fitbcfrail
summary(fitbcfrail)

</code></pre>

<hr>
<h2 id='summary.bcfrailpar'>Print bcfrailpar</h2><span id='topic+summary.bcfrailpar'></span>

<h3>Description</h3>

<p>Generics to print the S3 class bcfrailpar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcfrailpar'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bcfrailpar_+3A_object">object</code></td>
<td>
<p>A class <code>bcfrailpar</code> object.</p>
</td></tr>
<tr><td><code id="summary.bcfrailpar_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code>print.bcfrailpar()</code>.
</p>


<h3>Value</h3>

<p>An object of <code>summary.bcfrailpar</code>, with some more human-readable results from <code>bcfrailpar</code> object.
</p>


<h3>Note</h3>

<p>The summary function is currently identical to the print function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcfrailpar">bcfrailpar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(40)
simdata&lt;-simbcfraildv(psize=500, cenr= c(0.3),beta=c(-1),frailty=c("gamma"),
frailpar=c(0.4,0.4,0.5),bhaz=c("gompertz"),
bhazpar=list(shape =c(0.09), scale = c(0.2)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data

fitbcfrail=bcfrailpar(Surv(time,censor)~ X1+frailty(PID) ,
data=dataa,haz="gompertz")
fitbcfrail
summary(fitbcfrail)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
