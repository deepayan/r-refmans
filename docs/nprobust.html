<!DOCTYPE html><html><head><title>Help for package nprobust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nprobust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#kdbwselect'><p>Bandwidth Selection Procedures for Kernel Density Estimation and Inference</p></a></li>
<li><a href='#kdrobust'><p>Kernel Density Methods with Robust Bias-Corrected Inference</p></a></li>
<li><a href='#lpbwselect'><p>Bandwidth Selection Procedures for Local Polynomial Regression Estimation and Inference</p></a></li>
<li><a href='#lprobust'><p>Local Polynomial Methods with Robust Bias-Corrected Inference</p></a></li>
<li><a href='#nprobust-package'><p>Nonparametric Robust Estimation and Inference Methods using Local Polynomial Regression and Kernel Density Estimation</p></a></li>
<li><a href='#nprobust.plot'><p>Graphical Presentation of Results from <code>nprobust</code> Package.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Robust Estimation and Inference Methods using
Local Polynomial Regression and Kernel Density Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-08-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastian Calonico &lt;sebastian.calonico@columbia.edu&gt;, Matias D. Cattaneo &lt;cattaneo@princeton.edu&gt;, Max H. Farrell &lt;max.farrell@chicagobooth.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastian Calonico &lt;sebastian.calonico@columbia.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for data-driven statistical analysis using local polynomial regression and kernel density estimation methods as described in Calonico, Cattaneo and Farrell (2018, &lt;<a href="https://doi.org/10.1080%2F01621459.2017.1285776">doi:10.1080/01621459.2017.1285776</a>&gt;): lprobust() for local polynomial point estimation and robust bias-corrected inference, lpbwselect() for local polynomial bandwidth selection, kdrobust() for kernel density point estimation and robust bias-corrected inference, kdbwselect() for kernel density bandwidth selection, and nprobust.plot() for plotting results. The main methodological and numerical features of this package are described in Calonico, Cattaneo and Farrell (2019, &lt;<a href="https://doi.org/10.18637%2Fjss.v091.i08">doi:10.18637/jss.v091.i08</a>&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, ggplot2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-08-25 03:09:46 UTC; sebas</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-08-26 10:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='kdbwselect'>Bandwidth Selection Procedures for Kernel Density Estimation and Inference</h2><span id='topic+kdbwselect'></span>

<h3>Description</h3>

<p><code><a href="#topic+kdbwselect">kdbwselect</a></code> implements bandwidth selectors for kernel density point estimators and inference procedures developed in Calonico, Cattaneo and Farrell (2018). See also Calonico, Cattaneo and Farrell (2020) for related optimality results.
It also implements other bandwidth selectors available in the literature. See Wand and Jones (1995) for background references.
</p>
<p>Companion commands are: <code><a href="#topic+kdrobust">kdrobust</a></code> for kernel density point estimation and inference procedures.
</p>
<p>A detailed introduction to this command is given in Calonico, Cattaneo and Farrell (2019). For more details, and related Stata and R packages useful for empirical analysis, visit <a href="https://nppackages.github.io/">https://nppackages.github.io/</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kdbwselect(x, eval = NULL, neval = NULL, kernel = "epa", 
bwselect = "mse-dpi", bwcheck=21, imsegrid=30, subset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kdbwselect_+3A_x">x</code></td>
<td>
<p>independent variable.</p>
</td></tr>
<tr><td><code id="kdbwselect_+3A_eval">eval</code></td>
<td>
<p>vector of evaluation point(s). By default it uses 30 equally spaced points over to support of <code>x</code>.</p>
</td></tr>
<tr><td><code id="kdbwselect_+3A_neval">neval</code></td>
<td>
<p>number of quantile-spaced evaluation points on support of <code>x</code>. Default is <code>neval=30</code>.</p>
</td></tr>
<tr><td><code id="kdbwselect_+3A_kernel">kernel</code></td>
<td>
<p>kernel function used to construct the kernel estimators. Options are <code>epa</code> for the epanechnikov kernel, and <code>uni</code> for the uniform kernel. Default is <code>kernel = epa</code>.</p>
</td></tr>
<tr><td><code id="kdbwselect_+3A_bwselect">bwselect</code></td>
<td>
<p>bandwidth selection procedure to be used. Options are:
</p>
<p><code>mse-dpi</code> second-generation DPI implementation of MSE-optimal bandwidth. Default option.
</p>
<p><code>imse-dpi</code> second-generation DPI implementation of IMSE-optimal bandwidth (computed using grid of evaluation points selected).
</p>
<p><code>imse-rot</code> ROT implementation of IMSE-optimal bandwidth (computed using grid of evaluation points selected).
</p>
<p><code>ce-dpi</code> second generation DPI implementation of CE-optimal bandwidth.
</p>
<p><code>ce-rot</code> ROT implementation of CE-optimal bandwidth.
</p>
<p><code>all</code> reports all available bandwidth selection procedures.
</p>
<p>Note: MSE = Mean Square Error; IMSE = Integrated Mean Squared Error; CE = Coverage Error; DPI = Direct Plug-in; ROT = Rule-of-Thumb. For details on implementation see Calonico, Cattaneo and Farrell (2019).</p>
</td></tr>
<tr><td><code id="kdbwselect_+3A_bwcheck">bwcheck</code></td>
<td>
<p>if a positive integer is provided, then the selected bandwidth is enlarged so that at least <code>bwcheck</code> effective observations are available at each evaluation point. Default is <code>bwcheck = 15</code>.</p>
</td></tr>
<tr><td><code id="kdbwselect_+3A_imsegrid">imsegrid</code></td>
<td>
<p>number of evaluations points used to compute the IMSE bandwidth selector. Default is <code>imsegrid = 30</code>.</p>
</td></tr>
<tr><td><code id="kdbwselect_+3A_subset">subset</code></td>
<td>
<p>optional rule specifying a subset of observations to be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Estimate</code></td>
<td>
<p>A matrix containing <code>eval</code> (grid points), <code>h</code> and <code>b</code> (bandwidths).</p>
</td></tr>
<tr><td><code>opt</code></td>
<td>
<p>A list containing options passed to the function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of Chicago, Chicago, IL. <a href="mailto:max.farrell@chicagobooth.edu">max.farrell@chicagobooth.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2018. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2018_JASA.pdf">On the Effect of Bias Estimation on Coverage Accuracy in Nonparametric Inference</a>. Journal of the American Statistical Association, 113(522): 767-779. doi: <a href="https://doi.org/10.1080/01621459.2017.1285776">10.1080/01621459.2017.1285776</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2019. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2019_JSS.pdf">nprobust: Nonparametric Kernel-Based Estimation and Robust Bias-Corrected Inference</a>. Journal of Statistical Software, 91(8). doi: <a href="https://doi.org/10.18637/jss.v091.i08">10.18637/jss.v091.i08</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2020. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2020_CEopt.pdf">Coverage Error Optimal Confidence Intervals for Local Polynomial Regression</a>. Working Paper. 
</p>
<p>Fan, J., and Gijbels, I. 1996. Local polynomial modelling and its applications, London: Chapman and Hall.
</p>
<p>Wand, M., and Jones, M. 1995. Kernel Smoothing, Florida: Chapman &amp; Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kdrobust">kdrobust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x   &lt;- rnorm(500)
est &lt;- kdbwselect(x)
summary(est)
</code></pre>

<hr>
<h2 id='kdrobust'>Kernel Density Methods with Robust Bias-Corrected Inference</h2><span id='topic+kdrobust'></span>

<h3>Description</h3>

<p><code><a href="#topic+kdrobust">kdrobust</a></code> implements kernel density point estimators, with robust bias-corrected confidence intervals and inference procedures developed in Calonico, Cattaneo and Farrell (2018). See also Calonico, Cattaneo and Farrell (2020) for related optimality results.
It also implements other estimation and inference procedures available in the literature. See Wand and Jones (1995) for background references.
</p>
<p>Companion commands: <code><a href="#topic+kdbwselect">kdbwselect</a></code> for kernel density data-driven bandwidth selection, and <code><a href="#topic+nprobust.plot">nprobust.plot</a></code> for plotting results.
</p>
<p>A detailed introduction to this command is given in Calonico, Cattaneo and Farrell (2019). For more details, and related Stata and R packages useful for empirical analysis, visit <a href="https://nppackages.github.io/">https://nppackages.github.io/</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kdrobust(x, eval = NULL, neval = NULL, h = NULL, b = NULL, rho = 1, 
kernel = "epa", bwselect = NULL, bwcheck = 21, imsegrid=30, level = 95, subset = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kdrobust_+3A_x">x</code></td>
<td>
<p>independent variable.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_eval">eval</code></td>
<td>
<p>vector of evaluation point(s). By default it uses 30 equally spaced points over to support of <code>x</code>.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_neval">neval</code></td>
<td>
<p>number of quantile-spaced evaluation points on support of <code>x</code>. Default is <code>neval=30</code>.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_h">h</code></td>
<td>
<p>main bandwidth used to construct the kernel density  point estimator. Can be either scalar (same bandwidth for all evaluation points), or vector of same dimension as <code>eval</code>. If not specified, bandwidth <code>h</code> is computed by the companion command <code><a href="#topic+kdbwselect">kdbwselect</a></code>.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_b">b</code></td>
<td>
<p>bias bandwidth used to construct the bias-correction estimator. Can be either scalar (same bandwidth for all evaluation points), or vector of same dimension as <code>eval</code>. By default it is set equal to <code>h</code>. If <code>rho</code> is set to zero, <code>b</code> is computed by the companion command <code><a href="#topic+kdbwselect">kdbwselect</a></code>.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_rho">rho</code></td>
<td>
<p>Sets <code>b=h/rho</code>. Default is <code>rho = 1</code>.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_kernel">kernel</code></td>
<td>
<p>kernel function used to construct local polynomial estimators. Options are <code>epa</code> for the epanechnikov kernel, <code>tri</code> for the triangular kernel and <code>uni</code> for the uniform kernel. Default is <code>kernel = epa</code>.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_bwselect">bwselect</code></td>
<td>
<p>bandwidth selection procedure to be used via <code><a href="#topic+lpbwselect">lpbwselect</a></code>. By default it computes <code>h</code> and sets <code>b=h/rho</code> (with <code>rho=1</code> by default). It computes both <code>h</code> and <code>b</code> if <code>rho</code> is set equal to zero. Options are:
</p>
<p><code>mse-dpi</code> second-generation DPI implementation of MSE-optimal bandwidth. Default option if only one evaluation point is chosen.
</p>
<p><code>imse-dpi</code> second-generation DPI implementation of IMSE-optimal bandwidth (computed using a grid of evaluation points). Default option if more than one evaluation point is chosen.
</p>
<p><code>imse-rot</code> ROT implementation of IMSE-optimal bandwidth (computed using a grid of evaluation points).
</p>
<p><code>ce-dpi</code> second generation DPI implementation of CE-optimal bandwidth.
</p>
<p><code>ce-rot</code> ROT implementation of CE-optimal bandwidth.
</p>
<p><code>all</code> reports all available bandwidth selection procedures.
</p>
<p>Note: MSE = Mean Square Error; IMSE = Integrated Mean Squared Error; CE = Coverage Error; DPI = Direct Plug-in; ROT = Rule-of-Thumb. For details on implementation see Calonico, Cattaneo and Farrell (2019).</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_bwcheck">bwcheck</code></td>
<td>
<p>if a positive integer is provided, then the selected bandwidth is enlarged so that at least <code>bwcheck</code> effective observations are available at each evaluation point. Default is <code>bwcheck = 21</code>.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_imsegrid">imsegrid</code></td>
<td>
<p>number of evaluations points used to compute the IMSE bandwidth selector. Default is <code>imsegrid = 30</code>.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_level">level</code></td>
<td>
<p>confidence level used for confidence intervals; default is <code>level = 95</code>.</p>
</td></tr>
<tr><td><code id="kdrobust_+3A_subset">subset</code></td>
<td>
<p>optional rule specifying a subset of observations to be used.</p>
</td></tr> 
</table>


<h3>Value</h3>

<table>
<tr><td><code>Estimate</code></td>
<td>
<p>A matrix containing <code>eval</code> (grid points), <code>h</code>, <code>b</code> (bandwidths), <code>N</code>
(effective sample sizes), <code>tau.us</code> (point estimates with p-th order kernel function),
<code>tau.bc</code> (bias corrected point estimates, <code>se.us</code> (standard error corresponding to <code>tau.us</code>), and <code>se.rb</code> (robust standard error).</p>
</td></tr>
<tr><td><code>opt</code></td>
<td>
<p>A list containing options passed to the function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of Chicago, Chicago, IL. <a href="mailto:max.farrell@chicagobooth.edu">max.farrell@chicagobooth.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2018. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2018_JASA.pdf">On the Effect of Bias Estimation on Coverage Accuracy in Nonparametric Inference</a>. Journal of the American Statistical Association, 113(522): 767-779. doi: <a href="https://doi.org/10.1080/01621459.2017.1285776">10.1080/01621459.2017.1285776</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2019. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2019_JSS.pdf">nprobust: Nonparametric Kernel-Based Estimation and Robust Bias-Corrected Inference</a>. Journal of Statistical Software, 91(8): 1-33. doi: <a href="https://doi.org/10.18637/jss.v091.i08">10.18637/jss.v091.i08</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2020. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2020_CEopt.pdf">Coverage Error Optimal Confidence Intervals for Local Polynomial Regression</a>. Working Paper.
</p>
<p>Fan, J., and Gijbels, I. 1996. Local polynomial modelling and its applications, London: Chapman and Hall.
</p>
<p>Wand, M., and Jones, M. 1995. Kernel Smoothing, Florida: Chapman &amp; Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kdbwselect">kdbwselect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x   &lt;- rnorm(500)
est &lt;- kdrobust(x)
summary(est)
</code></pre>

<hr>
<h2 id='lpbwselect'>Bandwidth Selection Procedures for Local Polynomial Regression Estimation and Inference</h2><span id='topic+lpbwselect'></span>

<h3>Description</h3>

<p><code><a href="#topic+lpbwselect">lpbwselect</a></code> implements bandwidth selectors for local polynomial regression point estimators and inference procedures developed in Calonico, Cattaneo and Farrell (2018). See also Calonico, Cattaneo and Farrell (2020) for related optimality results. 
It also implements other bandwidth selectors available in the literature. See Wand and Jones (1995) and Fan and Gijbels (1996) for background references.
</p>
<p>Companion commands: <code><a href="#topic+lprobust">lprobust</a></code> for local polynomial point estimation and inference procedures.
</p>
<p>A detailed introduction to this command is given in Calonico, Cattaneo and Farrell (2019). For more details, and related Stata and R packages useful for empirical analysis, visit <a href="https://nppackages.github.io/">https://nppackages.github.io/</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lpbwselect(y, x, eval = NULL, neval = NULL, p = NULL, deriv = NULL,
kernel = "epa", bwselect = "mse-dpi", bwcheck = 21, bwregul = 1, 
imsegrid = 30, vce = "nn", cluster = NULL,
nnmatch = 3, interior = FALSE, subset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lpbwselect_+3A_y">y</code></td>
<td>
<p>dependent variable.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_x">x</code></td>
<td>
<p>independent variable.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_eval">eval</code></td>
<td>
<p>vector of evaluation point(s). By default it uses 30 equally spaced points over to support of <code>x</code>.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_neval">neval</code></td>
<td>
<p>number of quantile-spaced evaluation points on support of <code>x</code>. Default is <code>neval=30</code>.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_p">p</code></td>
<td>
<p>polynomial order used to construct point estimator; default is <code>p = 1</code> (local linear regression).</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_deriv">deriv</code></td>
<td>
<p>derivative order of the regression function to be estimated. Default is <code>deriv=0</code> (regression function).</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_kernel">kernel</code></td>
<td>
<p>kernel function used to construct local polynomial estimators. Options are <code>epa</code> for the epanechnikov kernel, <code>tri</code> for the triangular kernel, <code>uni</code> for the uniform kernel and <code>gau</code> for the gaussian kernel. Default is <code>kernel = epa</code>.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_bwselect">bwselect</code></td>
<td>
<p>bandwidth selection procedure to be used. Options are:
</p>
<p><code>mse-dpi</code> second-generation DPI implementation of MSE-optimal bandwidth. Default option.
</p>
<p><code>mse-rot</code> ROT implementation of MSE-optimal bandwidth.
</p>
<p><code>imse-dpi</code> second-generation DPI implementation of IMSE-optimal bandwidth (computed using grid of evaluation points selected).
</p>
<p><code>imse-rot</code> ROT implementation of IMSE-optimal bandwidth (computed using grid of evaluation points selected).
</p>
<p><code>ce-dpi</code> second generation DPI implementation of CE-optimal bandwidth.
</p>
<p><code>ce-rot</code> ROT implementation of CE-optimal bandwidth.
</p>
<p><code>all</code> reports all available bandwidth selection procedures.
</p>
<p>Note: MSE = Mean Square Error; IMSE = Integrated Mean Squared Error; CE = Coverage Error; DPI = Direct Plug-in; ROT = Rule-of-Thumb. For details on implementation see Calonico, Cattaneo and Farrell (2019).</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_bwcheck">bwcheck</code></td>
<td>
<p>if a positive integer is provided, then the selected bandwidth is enlarged so that at least <code>bwcheck</code> effective observations are available at each evaluation point. Default is <code>bwcheck = 21</code>.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_bwregul">bwregul</code></td>
<td>
<p>specifies scaling factor for the regularization term added to the denominator of bandwidth selectors. Setting <code>bwregul = 0</code> removes the regularization term from the bandwidth selectors. Default is <code>bwregul = 1</code>.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_imsegrid">imsegrid</code></td>
<td>
<p>number of evaluations points used to compute the IMSE bandwidth selector. Default is <code>imsegrid = 30</code>.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_vce">vce</code></td>
<td>
<p>procedure used to compute the variance-covariance matrix estimator. Options are:
</p>
<p><code>nn</code> heteroskedasticity-robust nearest neighbor variance estimator with <code>nnmatch</code> the (minimum) number of neighbors to be used. Default choice.
</p>
<p><code>hc0</code> heteroskedasticity-robust plug-in residuals variance estimator without weights.
</p>
<p><code>hc1</code> heteroskedasticity-robust plug-in residuals variance estimator with <code>hc1</code> weights.
</p>
<p><code>hc2</code> heteroskedasticity-robust plug-in residuals variance estimator with <code>hc2</code> weights.
</p>
<p><code>hc3</code> heteroskedasticity-robust plug-in residuals variance estimator with <code>hc3</code> weights.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_cluster">cluster</code></td>
<td>
<p>indicates the cluster ID variable used for cluster-robust variance estimation with degrees-of-freedom weights. By default it is combined with <code>vce=nn</code> for cluster-robust nearest neighbor variance estimation. Another option is plug-in residuals combined with <code>vce=hc1</code>.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_nnmatch">nnmatch</code></td>
<td>
<p>to be combined with for <code>vce=nn</code> for heteroskedasticity-robust nearest neighbor variance estimator with <code>nnmatch</code> indicating the minimum number of neighbors to be used. Default is <code>nnmatch=3</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="lpbwselect_+3A_interior">interior</code></td>
<td>
<p>if TRUE, all evaluation points are assumed to be interior points. This option affects only data-driven bandwidth selection via <code><a href="#topic+lpbwselect">lpbwselect</a></code>. Default is <code>interior = FALSE</code>.</p>
</td></tr>
<tr><td><code id="lpbwselect_+3A_subset">subset</code></td>
<td>
<p>optional rule specifying a subset of observations to be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Estimate</code></td>
<td>
<p>A matrix containing <code>grid</code> (grid points), <code>h</code> and <code>b</code> (bandwidths), <code>N</code>
(sample size)</p>
</td></tr>
<tr><td><code>opt</code></td>
<td>
<p>A list containing options passed to the function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of Chicago, Chicago, IL. <a href="mailto:max.farrell@chicagobooth.edu">max.farrell@chicagobooth.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2018. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2018_JASA.pdf">On the Effect of Bias Estimation on Coverage Accuracy in Nonparametric Inference</a>. Journal of the American Statistical Association, 113(522): 767-779. doi: <a href="https://doi.org/10.1080/01621459.2017.1285776">10.1080/01621459.2017.1285776</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2019. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2019_JSS.pdf">nprobust: Nonparametric Kernel-Based Estimation and Robust Bias-Corrected Inference</a>. Journal of Statistical Software, 91(8): 1-33. doi: <a href="https://doi.org/10.18637/jss.v091.i08">10.18637/jss.v091.i08</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2020. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2020_CEopt.pdf">Coverage Error Optimal Confidence Intervals for Local Polynomial Regression</a>. Working Paper.
</p>
<p>Fan, J., and Gijbels, I. 1996. Local polynomial modelling and its applications, London: Chapman and Hall.
</p>
<p>Wand, M., and Jones, M. 1995. Kernel Smoothing, Florida: Chapman &amp; Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lprobust">lprobust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x   &lt;- runif(500)
y   &lt;- sin(4*x) + rnorm(500)
est &lt;- lpbwselect(y,x)
summary(est)
</code></pre>

<hr>
<h2 id='lprobust'>Local Polynomial Methods with Robust Bias-Corrected Inference</h2><span id='topic+lprobust'></span>

<h3>Description</h3>

<p><code><a href="#topic+lprobust">lprobust</a></code> implements local polynomial regression point estimators, with robust bias-corrected confidence intervals and inference procedures developed in Calonico, Cattaneo and Farrell (2018). See also Calonico, Cattaneo and Farrell (2020) for related optimality results.
It also implements other estimation and inference procedures available in the literature. See Wand and Jones (1995) and Fan and Gijbels (1996) for background references.
</p>
<p>Companion commands: <code><a href="#topic+lpbwselect">lpbwselect</a></code> for local polynomial data-driven bandwidth selection, and <code><a href="#topic+nprobust.plot">nprobust.plot</a></code> for plotting results.
</p>
<p>A detailed introduction to this command is given in Calonico, Cattaneo and Farrell (2019). For more details, and related Stata and R packages useful for empirical analysis, visit <a href="https://nppackages.github.io/">https://nppackages.github.io/</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lprobust(y, x, eval = NULL, neval = NULL, p = NULL, deriv = NULL, 
h = NULL, b = NULL, rho = 1, kernel = "epa", bwselect = NULL, 
bwcheck = 21, bwregul = 1, imsegrid = 30, vce = "nn", covgrid = FALSE, 
cluster = NULL, nnmatch = 3, level = 95, interior = FALSE, subset = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lprobust_+3A_y">y</code></td>
<td>
<p>dependent variable.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_x">x</code></td>
<td>
<p>independent variable.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_eval">eval</code></td>
<td>
<p>vector of evaluation point(s). By default it uses 30 equally spaced points over to support of <code>x</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_neval">neval</code></td>
<td>
<p>number of quantile-spaced evaluation points on support of <code>x</code>. Default is <code>neval=30</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_p">p</code></td>
<td>
<p>polynomial order used to construct point estimator; default is <code>p = 1</code> (local linear regression).</p>
</td></tr>
<tr><td><code id="lprobust_+3A_deriv">deriv</code></td>
<td>
<p>derivative order of the regression function to be estimated. Default is <code>deriv=0</code> (regression function).</p>
</td></tr>
<tr><td><code id="lprobust_+3A_h">h</code></td>
<td>
<p>main bandwidth used to construct local polynomial point estimator. Can be either scalar (same bandwidth for all evaluation points), or vector of same dimension as <code>eval</code>. If not specified, bandwidth <code>h</code> is computed by the companion command <code><a href="#topic+lpbwselect">lpbwselect</a></code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_b">b</code></td>
<td>
<p>bias bandwidth used to construct the bias-correction estimator. Can be either scalar (same bandwidth for all evaluation points), or vector of same dimension as <code>eval</code>. By default it is set equal to <code>h</code>. If <code>rho</code> is set to zero, <code>b</code> is computed by the companion command <code><a href="#topic+lpbwselect">lpbwselect</a></code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_rho">rho</code></td>
<td>
<p>Sets <code>b=h/rho</code>. Default is <code>rho = 1</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_kernel">kernel</code></td>
<td>
<p>kernel function used to construct local polynomial estimators. Options are <code>epa</code> for the epanechnikov kernel, <code>tri</code> for the triangular kernel, <code>uni</code> for the uniform kernel and <code>gau</code> for the gaussian kernel. Default is <code>kernel = epa</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_bwselect">bwselect</code></td>
<td>
<p>bandwidth selection procedure to be used via <code><a href="#topic+lpbwselect">lpbwselect</a></code>. By default it computes <code>h</code> and sets <code>b=h/rho</code> (with <code>rho=1</code> by default). It computes both <code>h</code> and <code>b</code> if <code>rho</code> is set equal to zero. Options are:
</p>
<p><code>mse-dpi</code> second-generation DPI implementation of MSE-optimal bandwidth. Default option if only one evaluation point is chosen.
</p>
<p><code>mse-rot</code> ROT implementation of MSE-optimal bandwidth.
</p>
<p><code>imse-dpi</code> second-generation DPI implementation of IMSE-optimal bandwidth (computed using a grid of evaluation points). Default option if more than one evaluation point is chosen.
</p>
<p><code>imse-rot</code> ROT implementation of IMSE-optimal bandwidth (computed using a grid of evaluation points).
</p>
<p><code>ce-dpi</code> second generation DPI implementation of CE-optimal bandwidth.
</p>
<p><code>ce-rot</code> ROT implementation of CE-optimal bandwidth.
</p>
<p><code>all</code> reports all available bandwidth selection procedures.
</p>
<p>Note: MSE = Mean Square Error; IMSE = Integrated Mean Squared Error; CE = Coverage Error; DPI = Direct Plug-in; ROT = Rule-of-Thumb. For details on implementation see Calonico, Cattaneo and Farrell (2019).</p>
</td></tr>
<tr><td><code id="lprobust_+3A_bwcheck">bwcheck</code></td>
<td>
<p>if a positive integer is provided, then the selected bandwidth is enlarged so that at least <code>bwcheck</code> effective observations are available at each evaluation point. Default is <code>bwcheck = 21</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_bwregul">bwregul</code></td>
<td>
<p>specifies scaling factor for the regularization term added to the denominator of bandwidth selectors. Setting <code>bwregul = 0</code> removes the regularization term from the bandwidth selectors. Default is <code>bwregul = 1</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_imsegrid">imsegrid</code></td>
<td>
<p>number of evaluations points used to compute the IMSE bandwidth selector. Default is <code>imsegrid = 30</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_vce">vce</code></td>
<td>
<p>procedure used to compute the variance-covariance matrix estimator. Options are:
</p>
<p><code>nn</code> heteroskedasticity-robust nearest neighbor variance estimator with <code>nnmatch</code> the (minimum) number of neighbors to be used. Default choice.
</p>
<p><code>hc0</code> heteroskedasticity-robust plug-in residuals variance estimator without weights.
</p>
<p><code>hc1</code> heteroskedasticity-robust plug-in residuals variance estimator with <code>hc1</code> weights.
</p>
<p><code>hc2</code> heteroskedasticity-robust plug-in residuals variance estimator with <code>hc2</code> weights.
</p>
<p><code>hc3</code> heteroskedasticity-robust plug-in residuals variance estimator with <code>hc3</code> weights.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_covgrid">covgrid</code></td>
<td>
<p>if TRUE, it computes two covariance matrices (cov.us and cov.rb) for classical and robust covariances across point estimators over the grid of evaluation points.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_cluster">cluster</code></td>
<td>
<p>indicates the cluster ID variable used for cluster-robust variance estimation with degrees-of-freedom weights. By default it is combined with <code>vce=nn</code> for cluster-robust nearest neighbor variance estimation. Another option is plug-in residuals combined with <code>vce=hc1</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_nnmatch">nnmatch</code></td>
<td>
<p>to be combined with for <code>vce=nn</code> for heteroskedasticity-robust nearest neighbor variance estimator with <code>nnmatch</code> indicating the minimum number of neighbors to be used. Default is <code>nnmatch=3</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="lprobust_+3A_level">level</code></td>
<td>
<p>confidence level used for confidence intervals; default is <code>level = 95</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_interior">interior</code></td>
<td>
<p>if TRUE, all evaluation points are assumed to be interior points. This option affects only data-driven bandwidth selection via <code><a href="#topic+lpbwselect">lpbwselect</a></code>. Default is <code>interior = FALSE</code>.</p>
</td></tr>
<tr><td><code id="lprobust_+3A_subset">subset</code></td>
<td>
<p>optional rule specifying a subset of observations to be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Estimate</code></td>
<td>
<p>A matrix containing <code>eval</code> (grid points), <code>h</code>, <code>b</code> (bandwidths), <code>N</code>
(effective sample sizes), <code>m.us</code> (point estimates with p-th order local polynomial),
<code>tau.bc</code> (bias corrected point estimates with (p+1)-th order local polynomial,
<code>se.us</code> (standard error corresponding to <code>tau.us</code>), and <code>se.rb</code> (robust standard error).</p>
</td></tr>
<tr><td><code>opt</code></td>
<td>
<p>A list containing options passed to the function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of Chicago, Chicago, IL. <a href="mailto:max.farrell@chicagobooth.edu">max.farrell@chicagobooth.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2018. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2018_JASA.pdf">On the Effect of Bias Estimation on Coverage Accuracy in Nonparametric Inference</a>. Journal of the American Statistical Association, 113(522): 767-779. doi: <a href="https://doi.org/10.1080/01621459.2017.1285776">10.1080/01621459.2017.1285776</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2019. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2019_JSS.pdf">nprobust: Nonparametric Kernel-Based Estimation and Robust Bias-Corrected Inference</a>. Journal of Statistical Software, 91(8): 1-33. doi: <a href="https://doi.org/10.18637/jss.v091.i08">10.18637/jss.v091.i08</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2020. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2020_CEopt.pdf">Coverage Error Optimal Confidence Intervals for Local Polynomial Regression</a>. Working Paper.
</p>
<p>Fan, J., and Gijbels, I. 1996. Local polynomial modelling and its applications, London: Chapman and Hall.
</p>
<p>Wand, M., and Jones, M. 1995. Kernel Smoothing, Florida: Chapman &amp; Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lpbwselect">lpbwselect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x   &lt;- runif(500)
y   &lt;- sin(4*x) + rnorm(500)
est &lt;- lprobust(y,x)
summary(est)
</code></pre>

<hr>
<h2 id='nprobust-package'>Nonparametric Robust Estimation and Inference Methods using Local Polynomial Regression and Kernel Density Estimation</h2><span id='topic+nprobust-package'></span><span id='topic+nprobust'></span>

<h3>Description</h3>

<p>This package provides tools for data-driven statistical analysis using local polynomial regression (LPR) and kernel density estimation (KDE) methods as described in Calonico, Cattaneo and Farrell (2018): <code><a href="#topic+lprobust">lprobust</a></code> for local polynomial point estimation and robust bias-corrected inference, <code><a href="#topic+lpbwselect">lpbwselect</a></code> for local polynomial bandwidth selection, <code><a href="#topic+kdrobust">kdrobust</a></code> for kernel density point estimation and robust bias-corrected inference, <code><a href="#topic+kdbwselect">kdbwselect</a></code> for kernel density bandwidth selection, and <code><a href="#topic+nprobust.plot">nprobust.plot</a></code> for plotting results. The main methodological and numerical features of this  package are described in Calonico, Cattaneo and Farrell (2019).</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> nprobust</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.4.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-08-24</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;"> 
</td>
</tr>

</table>

<p>Function for LPR estimation and inference: <code><a href="#topic+lprobust">lprobust</a></code><br />
Function for LPR bandwidth selection: <code><a href="#topic+lpbwselect">lpbwselect</a></code><br />
Function for KDE estimation and inference: <code><a href="#topic+kdrobust">kdrobust</a></code><br />
Function for KDE bandwidth selection: <code><a href="#topic+kdbwselect">kdbwselect</a></code><br />
Function for graphical analysis: <code><a href="#topic+nprobust.plot">nprobust.plot</a></code><br />
</p>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of Chicago, Chicago, IL. <a href="mailto:max.farrell@chicagobooth.edu">max.farrell@chicagobooth.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2018. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2018_JASA.pdf">On the Effect of Bias Estimation on Coverage Accuracy in Nonparametric Inference</a>. Journal of the American Statistical Association, 113(522): 767-779. doi: <a href="https://doi.org/10.1080/01621459.2017.1285776">10.1080/01621459.2017.1285776</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2019. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2019_JSS.pdf">nprobust: Nonparametric Kernel-Based Estimation and Robust Bias-Corrected Inference</a>. Journal of Statistical Software, 91(8): 1-33. doi: <a href="https://doi.org/10.18637/jss.v091.i08">10.18637/jss.v091.i08</a>.
</p>

<hr>
<h2 id='nprobust.plot'>Graphical Presentation of Results from <code>nprobust</code> Package.</h2><span id='topic+nprobust.plot'></span>

<h3>Description</h3>

<p><code>nprobust.plot</code> plots estimated density and regression function using the <code>nprobust</code> package. A detailed introduction to this command is given in Calonico, Cattaneo and Farrell (2019).
</p>
<p>Companion commands: <code><a href="#topic+lprobust">lprobust</a></code> for local polynomial point estimation and inference procedures, and <code><a href="#topic+kdrobust">kdrobust</a></code> for kernel density point estimation and inference procedures.
</p>
<p>For more details, and related Stata and R packages useful for empirical analysis, visit <a href="https://nppackages.github.io/">https://nppackages.github.io/</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nprobust.plot(..., alpha = NULL, type = NULL, CItype = NULL,
  title = "", xlabel = "", ylabel = "", lty = NULL, lwd = NULL,
  lcol = NULL, pty = NULL, pwd = NULL, pcol = NULL, CIshade = NULL,
  CIcol = NULL, legendTitle = NULL, legendGroups = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nprobust.plot_+3A_...">...</code></td>
<td>
<p>Objects returned by <code><a href="#topic+kdrobust">kdrobust</a></code> or <code><a href="#topic+lprobust">lprobust</a></code>.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_alpha">alpha</code></td>
<td>
<p>Numeric scalar between 0 and 1, the significance level for plotting
confidence regions. If more than one is provided, they will be applied to data series
accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_type">type</code></td>
<td>
<p>String, one of <code>"line"</code> (default), <code>"points"</code> or <code>"both"</code>, how
the point estimates are plotted. If more than one is provided, they will be applied to data series
accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_citype">CItype</code></td>
<td>
<p>String, one of <code>"region"</code> (shaded region, default), <code>"line"</code> (dashed lines),
<code>"ebar"</code> (error bars), <code>"all"</code> (all of the previous) or <code>"none"</code> (no confidence region),
how the confidence region should be plotted. If more than one is provided, they will be applied to data series
accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_title">title</code>, <code id="nprobust.plot_+3A_xlabel">xlabel</code>, <code id="nprobust.plot_+3A_ylabel">ylabel</code></td>
<td>
<p>Strings, title of the plot and labels for x- and y-axis.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_lty">lty</code></td>
<td>
<p>Line type for point estimates, only effective if <code>type</code> is <code>"line"</code> or
<code>"both"</code>. <code>1</code> for solid line, <code>2</code> for dashed line, <code>3</code> for dotted line.
For other options, see the instructions for <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> or <code><a href="graphics.html#topic+par">par</a></code>. If
more than one is provided, they will be applied to data series accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_lwd">lwd</code></td>
<td>
<p>Line width for point estimates, only effective if <code>type</code> is <code>"line"</code> or
<code>"both"</code>. Should be strictly positive. For other options, see the instructions for
<code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> or <code><a href="graphics.html#topic+par">par</a></code>. If more than one is provided, they will be applied
to data series accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_lcol">lcol</code></td>
<td>
<p>Line color for point estimates, only effective if <code>type</code> is <code>"line"</code> or
<code>"both"</code>. <code>1</code> for black, <code>2</code> for red, <code>3</code> for green, <code>4</code> for blue.
For other options, see the instructions for <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> or <code><a href="graphics.html#topic+par">par</a></code>. If
more than one is provided, they will be applied to data series
accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_pty">pty</code></td>
<td>
<p>Scatter plot type for point estimates, only effective if <code>type</code> is <code>"points"</code> or
<code>"both"</code>. For options, see the instructions for <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> or <code><a href="graphics.html#topic+par">par</a></code>. If
more than one is provided, they will be applied to data series
accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_pwd">pwd</code></td>
<td>
<p>Scatter plot size for point estimates, only effective if <code>type</code> is <code>"points"</code> or
<code>"both"</code>. Should be strictly positive. If more than one is provided, they will be applied to data series
accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_pcol">pcol</code></td>
<td>
<p>Scatter plot color for point estimates, only effective if <code>type</code> is <code>"points"</code> or
<code>"both"</code>. <code>1</code> for black, <code>2</code> for red, <code>3</code>
for green, <code>4</code> for blue.
For other options, see the instructions for <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> or <code><a href="graphics.html#topic+par">par</a></code>. If
more than one is provided, they will be applied to data series
accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_cishade">CIshade</code></td>
<td>
<p>Numeric, opaqueness of the confidence region, should be between 0 (transparent) and
1. Default is 0.2. If more than one is provided, they will be applied to data series
accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_cicol">CIcol</code></td>
<td>
<p>color for confidence region. <code>1</code> for black, <code>2</code> for red, <code>3</code>
for green, <code>4</code> for blue.
For other options, see the instructions for <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> or <code><a href="graphics.html#topic+par">par</a></code>. If
more than one is provided, they will be applied to data series
accordingly.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_legendtitle">legendTitle</code></td>
<td>
<p>String, title of legend.</p>
</td></tr>
<tr><td><code id="nprobust.plot_+3A_legendgroups">legendGroups</code></td>
<td>
<p>String Vector, group names used in legend.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Companion command: <code><a href="#topic+lprobust">lprobust</a></code> for local polynomial-based regression functions and derivatives estimation.
</p>


<h3>Value</h3>

<p>A standard <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> object is returned, hence can be used for further customization.
</p>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of Chicago, Chicago, IL. <a href="mailto:max.farrell@chicagobooth.edu">max.farrell@chicagobooth.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2019. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2019_JSS.pdf">nprobust: Nonparametric Kernel-Based Estimation and Robust Bias-Corrected Inference</a>. Journal of Statistical Software, 91(8): 1-33. doi: <a href="https://doi.org/10.18637/jss.v091.i08">10.18637/jss.v091.i08</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lprobust">lprobust</a></code>, <code><a href="#topic+kdrobust">kdrobust</a></code>, <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x   &lt;- runif(500) 
y   &lt;- sin(4*x) + rnorm(500)
est &lt;- lprobust(y,x)
nprobust.plot(est)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
