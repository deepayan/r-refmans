<!DOCTYPE html><html><head><title>Help for package survivalMPLdc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {survivalMPLdc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.coxph_mpl_dc'><p>Extract regression coefficients of a coxph_mpl_dc Object</p></a></li>
<li><a href='#coxph_mpl_dc'><p>Fit Cox Proportional Hazard Regression Model under dependent right censoring via MPL and Archimedean Copulas</p></a></li>
<li><a href='#coxph_mpl_dc.control'><p>Ancillary arguments for controlling the outputs of coxph_mpl_dc</p></a></li>
<li><a href='#plot.coxph_mpl_dc'><p>Plot a baseline hazard estimates from coxph_mpl_dc Object</p></a></li>
<li><a href='#PRIME'><p>PRIME data set</p></a></li>
<li><a href='#surv_data_dc'><p>Generate a sample of time to event dataset with dependent right censoring under an Archimedean copula</p></a></li>
<li><a href='#survivalMPLdc-package'><p>Penalised Likelihood for Survival Analysis with Dependent Censoring</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Penalised Likelihood for Survival Analysis with Dependent
Censoring</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fitting Cox proportional hazard model under dependent right censoring using copula and maximum penalised likelihood methods.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>copula, stats, splines2, survival, graphics, matrixcalc</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-24 14:29:58 UTC; kennyxu1983hotmail.com</td>
</tr>
<tr>
<td>Author:</td>
<td>Jing Xu [aut, cre],
  Jun Ma [aut],
  Thomas Fung <a href="https://orcid.org/0000-0003-2601-0728"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jing Xu &lt;kenny.xu@duke-nus.edu.sg&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-24 14:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.coxph_mpl_dc'>Extract regression coefficients of a coxph_mpl_dc Object</h2><span id='topic+coef.coxph_mpl_dc'></span>

<h3>Description</h3>

<p>Extract the matrix of regression coefficients with their corresponding standard errors,
<code class="reqn">z</code>-statistics and <code class="reqn">p</code>-values of the model part of interest of a <code>coxph_mpl_dc</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coxph_mpl_dc'
coef(object, parameter, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.coxph_mpl_dc_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+coxph_mpl_dc">coxph_mpl_dc</a></code></p>
</td></tr>
<tr><td><code id="coef.coxph_mpl_dc_+3A_parameter">parameter</code></td>
<td>
<p>the set of parameters of interest.  Indicate <code>parameters="beta"</code> for the regression parameter of beta
and <code>parameters="phi"</code> for the regression parameter of phi</p>
</td></tr>
<tr><td><code id="coef.coxph_mpl_dc_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the input is of class <code>coxph_mpl_dc</code> and <code>parameters=="beta"</code>,
the matrix of beta estimates with corresponding standar errors, <code class="reqn">z</code>-statistics and <code class="reqn">p</code>-values are reported. When the input is of class <code>coxph_mpl_dc</code> and <code>parameters=="phi"</code>,
the matrix of phi estimates with corresponding standar errors, <code class="reqn">z</code>-statistics and <code class="reqn">p</code>-values are reported.
</p>


<h3>Value</h3>

<table>
<tr><td><code>est</code></td>
<td>
<p>a matrix of coefficients with standard errors, z-statistics and corresponding p-values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jing Xu, Jun Ma, Thomas Fung
</p>


<h3>References</h3>

<p>Brodaty H, Connors M, Xu J, Woodward M, Ames D. (2014). <em>&quot;Predictors of institutionalization
in dementia: a three year longitudinal study&quot;</em>. Journal of Alzheimers Disease 40, 221-226.
</p>
<p>Xu J, Ma J, Connors MH, Brodaty H. (2018). <em>&quot;Proportional hazard model estimation under dependent censoring using copulas and penalized likelihood&quot;</em>.
Statistics in Medicine 37, 2238–2251.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.coxph_mpl_dc">plot.coxph_mpl_dc</a></code>, <code><a href="#topic+coxph_mpl_dc.control">coxph_mpl_dc.control</a></code>, <code><a href="#topic+coxph_mpl_dc">coxph_mpl_dc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

 ##-- Copula types
 copula3 &lt;- 'frank'

##-- A real example
##-- One dataset from Prospective Research in Memory Clinics (PRIME) study
##-- Refer to article Brodaty et al (2014),
##   the predictors of institutionalization of dementia patients over 3-year study period

data(PRIME)

surv&lt;-as.matrix(PRIME[,1:3]) #time, event and dependent censoring indicators
cova&lt;-as.matrix(PRIME[, -c(1:3)]) #covariates
colMeans(surv[,2:3])  #the proportions of event and dependent censoring

n&lt;-dim(PRIME)[1];print(n)
p&lt;-dim(PRIME)[2]-3;print(p)
names(PRIME)

##--MPL estimate Cox proportional hazard model for institutionalization under independent censoring
control &lt;- coxph_mpl_dc.control(ordSp = 4,
                                binCount = 200, tie = 'Yes',
                                tau = 0.5, copula = copula3,
                                pent = 'penalty_mspl', smpart = 'REML',
                                penc = 'penalty_mspl', smparc = 'REML',
                                cat.smpar = 'No' )

coxMPLests_tau &lt;- coxph_mpl_dc(surv=surv, cova=cova, control=control, )
MPL_beta&lt;-coef(object = coxMPLests_tau, parameter = "beta",)
MPL_phi&lt;-coef(object = coxMPLests_tau, parameter = "phi",)



</code></pre>

<hr>
<h2 id='coxph_mpl_dc'>Fit Cox Proportional Hazard Regression Model under dependent right censoring via MPL and Archimedean Copulas</h2><span id='topic+coxph_mpl_dc'></span>

<h3>Description</h3>

<p>Simultaneously estimate the regression coefficients and the baseline hazard function of proportional
hazard Cox models under dependent right censoring using maximum penalised likelihood (MPL) and Archimedean Copulas
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxph_mpl_dc(surv, cova, control,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxph_mpl_dc_+3A_surv">surv</code></td>
<td>
<p>the outcome of survival data, with the first column X (observed time), second column
del (event indicator) and third column eta (dependent right censoring indicator).</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc_+3A_cova">cova</code></td>
<td>
<p>the covariate matrix, with dimension of n rows and p columns, where 'n' is the sample size and 'p' is the number of covariates
Default is <code>cova=matrix(0,n,1)</code>, which the covariates are not considered.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc_+3A_control">control</code></td>
<td>
<p>object of class <code>coxph_mpl_dc.control</code> specifying control options like basis choice,
refer to <code>coxph_mpl_dc.control</code> to see the defaults.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc_+3A_...">...</code></td>
<td>
<p>other arguments. In <code>coxph_mpl_dc</code>, these elements, will be passed to <code><a href="#topic+coxph_mpl_dc.control">coxph_mpl_dc.control</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>coxph_mpl_dc allows to simultaneously estimate the regression coefficients and baseline hazard function of Cox proportional hazard models,
with dependent and independent right censored data, by maximizing a penalized likelihood,
in which a penalty function is used to smooth the baseline hazard estimates.
Note that the dependence between event and censoring times is modelled by an Archimedean copula.
</p>
<p>Optimization is achieved using an iterative algorithm, which combines Newton’s method and the multiplicative iterative algorithm proposed by Ma (2010),
and respects the non-negativity constraints on the baseline hazard estimate (refer to Ma et al (2014) and Xu et al (2018)).
</p>
<p>The centered covariate matrix <code class="reqn">Z</code> is used in the optimization process to get a better shaped (penalized) log-likelihood.
Baseline hazard parameter estimates and covariance matrix are then respectively corrected using a correction factor and the delta method.
</p>
<p>The estimates of zero are possible for baseline hazard parameters (e.g., when number of knots is relatively large to sample size) and
will correspond to active constraints as defined by Moore and Sadler (2008). Inference, as described by Ma et al (2014) or Xu et al (2018),
is then corrected accordingly (refer to Moore and Sadler (2008)) by adequately cutting the corresponding covariance matrix.
</p>
<p>There are currently three ways to perform inference on model parameters: Let <code class="reqn">H</code> denote the negative of Hessian matrix of the non-penalized likelihood,
<code class="reqn">Q</code> denote the product of the first order derivative of the penalized likelihood by its transpose,
and <code class="reqn">M_2</code> denote the negative of the second order derivative of the penalized likelihood.
Then the three estimated covariance matrices for the MPL estimates are <code class="reqn">M_{2}^{-1}</code>, <code class="reqn">M_{2}^{-1}HM_{2}^{-1}</code> and <code class="reqn">M_{2}^{-1}QM_{2}^{-1}</code>.
</p>
<p>Simulation studies the coverage levels of confidence intervals for the regression parameters seem to indicate
<code class="reqn">M_{2}^{-1}HM_{2}^{-1}</code> performs better when using the piecewise constant basis,
and that <code class="reqn">M_{2}^{-1}QM_{2}^{-1}</code>  performs better when using other bases.
</p>


<h3>Value</h3>

<table>
<tr><td><code>mpl_theta</code></td>
<td>
<p>MPL estimates of the regression coefficient for the basis functions of the baseline hazard of T, i.e. theta</p>
</td></tr>
<tr><td><code>mpl_gamma</code></td>
<td>
<p>MPL estimates of the regression coefficient for the basis functions of the baseline hazard of C, i.e. gamma</p>
</td></tr>
<tr><td><code>mpl_h0t</code></td>
<td>
<p>MPL estimates of the baseline hazard for T, i.e. h_0T(x_i)</p>
</td></tr>
<tr><td><code>mpl_h0c</code></td>
<td>
<p>MPL estimates of the baseline hazard for C, i.e. h_0C(x_i)</p>
</td></tr>
<tr><td><code>mpl_H0t</code></td>
<td>
<p>MPL estimates of the baseline cumulative hazard for T, i.e. H_0T(x_i)</p>
</td></tr>
<tr><td><code>mpl_H0c</code></td>
<td>
<p>MPL estimates of the baseline cumulative hazard for C, i.e. H_0c(x_i)</p>
</td></tr>
<tr><td><code>mpl_S0t</code></td>
<td>
<p>MPL estimates of the baseline survival for T, i.e. S_0T(x_i)</p>
</td></tr>
<tr><td><code>mpl_S0c</code></td>
<td>
<p>MPL estimates of the baseline survival for C, i.e. S_0C(x_i)</p>
</td></tr>
<tr><td><code>mpl_beta</code></td>
<td>
<p>MPL estimates of beta</p>
</td></tr>
<tr><td><code>mpl_phi</code></td>
<td>
<p>MPL estimates of phi</p>
</td></tr>
<tr><td><code>penloglik</code></td>
<td>
<p>the penalized log-likelihood function given the MPL estimates</p>
</td></tr>
<tr><td><code>mpl_Ubeta</code></td>
<td>
<p>the first derivative of penalized log-likelihood function with respect to beta given the MPL estimates</p>
</td></tr>
<tr><td><code>mpl_Uphi</code></td>
<td>
<p>the first derivative of penalized log-likelihood unction with respect to phi given the MPL estimates</p>
</td></tr>
<tr><td><code>mpl_Utheta</code></td>
<td>
<p>the first derivative of penalized log-likelihood function with respect to theta given the MPL estimates</p>
</td></tr>
<tr><td><code>mpl_Ugamma</code></td>
<td>
<p>the first derivative of penalized log-likelihood function with respect to gamma given the MPL estimates</p>
</td></tr>
<tr><td><code>iteration</code></td>
<td>
<p>a vector of length 3 indicating the number of iterations used to estimate the smoothing parameter
(first value, equal to 1 when the user specified a chosen value), the beta, phi, theta and gamma parameters during the entire process (second value),
and beta, phi, theta and gamma parameters during the last smoothing parameter iteration (third value)</p>
</td></tr>
<tr><td><code>mpl_cvl</code></td>
<td>
<p>the cross validation value given the MPL estimates</p>
</td></tr>
<tr><td><code>mpl_aic</code></td>
<td>
<p>the AIC value given the MPL estimates</p>
</td></tr>
<tr><td><code>mpl_beta_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimated beta</p>
</td></tr>
<tr><td><code>mpl_phi_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimated phi</p>
</td></tr>
<tr><td><code>mpl_h0t_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline hazard coefficient of T, i.e. theta</p>
</td></tr>
<tr><td><code>mpl_h0c_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline hazard coefficient of C, i.e. gamma</p>
</td></tr>
<tr><td><code>mpl_ht0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline hazard of T</p>
</td></tr>
<tr><td><code>mpl_hc0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline hazard of C</p>
</td></tr>
<tr><td><code>mpl_Ht0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the cumulative baseline hazard of T</p>
</td></tr>
<tr><td><code>mpl_Hc0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the cumulative baseline hazard of C</p>
</td></tr>
<tr><td><code>mpl_St0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline survival of T</p>
</td></tr>
<tr><td><code>mpl_Sc0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline survival of C</p>
</td></tr>
<tr><td><code>mpl_est_cov</code></td>
<td>
<p>the asymptotic covariance matrix of the MPL estimates</p>
</td></tr>
<tr><td><code>mpl_beta_phi_zp</code></td>
<td>
<p>the MPL estimates for regression coefficient with their corresponding standard deviations, z scores and p-values</p>
</td></tr>
<tr><td><code>binwv</code></td>
<td>
<p>the width of each discretized bin of the observed times when piecewise constant approximation applied to the baseline hazards</p>
</td></tr>
<tr><td><code>ID</code></td>
<td>
<p>the bin ID for each individual of the sample when piecewise constant approximation applied to the baseline hazards</p>
</td></tr>
<tr><td><code>binedg</code></td>
<td>
<p>the edge for each discretized bin among the observed time vector X, which are the internal knots and boundaries</p>
</td></tr>
<tr><td><code>psix</code></td>
<td>
<p>basis function matrix psi(x_i) with dimension of n by m for baseline hazard, where m=number of internal knots+ordSp</p>
</td></tr>
<tr><td><code>Psix</code></td>
<td>
<p>basis function matrix Psi(x_i) with dimension of n by m for baseline cumulative hazard</p>
</td></tr>
</table>
<p>Inputs defined in coxph_mpl_dc.control
</p>


<h3>Author(s)</h3>

<p>Jing Xu, Jun Ma, Thomas Fung
</p>


<h3>References</h3>

<p>Ma, J. (2010). <em>&quot;Positively constrained multiplicative iterative algorithm for maximum penalised likelihood tomographic reconstruction&quot;</em>.
IEEE Transactions On Signal Processing 57, 181-192.
</p>
<p>Ma, J. and Heritier, S. and Lo, S. (2014). <em>&quot;On the Maximum Penalised Likelihood Approach forProportional Hazard Models with Right Censored Survival Data&quot;</em>.
Computational Statistics and Data Analysis 74, 142-156.
</p>
<p>Xu J, Ma J, Connors MH, Brodaty H. (2018). <em>&quot;Proportional hazard model estimation under dependent censoring using copulas and penalized likelihood&quot;</em>.
Statistics in Medicine 37, 2238–2251.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.coxph_mpl_dc">plot.coxph_mpl_dc</a></code>, <code><a href="#topic+coxph_mpl_dc.control">coxph_mpl_dc.control</a></code>, <code><a href="#topic+coef.coxph_mpl_dc">coef.coxph_mpl_dc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 ##-- Copula types
 copula3 &lt;- 'frank'

 ##-- Marginal distribution for T, C, and A
 a &lt;- 2
 lambda &lt;- 2
 cons7 &lt;- 0.2
 cons9 &lt;- 10
 tau &lt;- 0.8
 betas &lt;- c(-0.5, 0.1)
 phis &lt;- c(0.3, 0.2)
 distr.ev &lt;- 'weibull'
 distr.ce &lt;- 'exponential'

 ##-- Sample size
 n &lt;- 200

 ##-- One sample Monte Carlo dataset
 cova &lt;- cbind(rbinom(n, 1, 0.5), runif(n, min=-10, max=10))
 surv &lt;- surv_data_dc(n, a, cova, lambda, betas, phis, cons7, cons9, tau, copula3,
                     distr.ev, distr.ce)
 n &lt;- nrow(cova)
 p &lt;- ncol(cova)
 ##-- event and dependent censoring proportions
 colSums(surv)[c(2,3)]/n
 X &lt;- surv[,1] # Observed time
 del&lt;-surv[,2] # failure status
 eta&lt;-surv[,3] # dependent censoring status

 ##-- control inputs for the coxph_mpl_dc function
 control &lt;- coxph_mpl_dc.control(ordSp = 4,
                             binCount = 100,
                             tau = 0.8, copula = copula3,
                             pent = 'penalty_mspl', smpart = 'REML',
                             penc = 'penalty_mspl', smparc = 'REML',
                             cat.smpar = 'No' )

 ##-- Fitting cox ph hazard model for T using MPL and an correct copula
 #with REML smoothing parameters
 coxMPLests5 &lt;- coxph_mpl_dc(surv, cova, control, )
 mpl_beta_phi_zp5 &lt;- coxMPLests5$mpl_beta_phi_zp
 mpl_h0t5 &lt;- coxMPLests5$mpl_h0t
 mpl_h0Ti5 &lt;- approx( X, mpl_h0t5, xout = seq(0, 5.4, 0.01),
                    method="constant", rule = 2, ties = mean)$y

 ##-- Real marginal baseline hazard for T
 ht0b &lt;- a * (seq(0, 5.4, 0.01) ^ (a - 1)) / (lambda ^ a)


 ##-- Fitting cox ph hazard model for T using MPL and an correct copula
 #with zero smoothing parameters
 coxMPLests3 &lt;- coxph_mpl_dc(surv, cova,
                          ordSp=4, binCount=100,
                          tau=0.8, copula=copula3,
                          pent='penalty_mspl', smpart=0, penc='penalty_mspl', smparc=0,
                          cat.smpar = 'No')
 mpl_beta_phi_zp3 &lt;- coxMPLests3$mpl_beta_phi_zp
 mpl_h0t3 &lt;- coxMPLests3$mpl_h0t
 mpl_h0Ti3 &lt;- approx( X, mpl_h0t3, xout = seq(0, 5.4, 0.01),
 method="constant", rule = 2, ties = mean)$y

 ##-- Plot the true and estimated baseline hazards for T
 t_up &lt;- 3.5
 y_uplim &lt;- 2
 Ti&lt;-seq(0, 5.4, 0.01)[seq(0, 5.4, 0.01)&lt;=t_up]
 h0Ti&lt;-ht0b[seq(0, 5.4, 0.01)&lt;=t_up]
 h0Ti5&lt;-mpl_h0Ti5[seq(0, 5.4, 0.01)&lt;=t_up]
 h0Ti3&lt;-mpl_h0Ti3[seq(0, 5.4, 0.01)&lt;=t_up]

 plot( x = Ti, y = h0Ti5,
      type="l", col="grey", lty=4, lwd=3, cex.axis=1.6, cex.lab=1.6, ylim=c(0, y_uplim),
      xlab='Time', ylab='Hazard')
 lines(x = Ti, y = h0Ti,
      col="green",
      lty=1, lwd=3, cex.axis=1.6, cex.lab=1.6, ylim=c(0, y_uplim)
      )
 lines(x = Ti, y = h0Ti3,
      col="blue",
      lty=4, lwd=3, cex.axis=1.6, cex.lab=1.6, ylim=c(0, y_uplim)
      )





</code></pre>

<hr>
<h2 id='coxph_mpl_dc.control'>Ancillary arguments for controlling the outputs of coxph_mpl_dc</h2><span id='topic+coxph_mpl_dc.control'></span>

<h3>Description</h3>

<p>This is used to set various numeric parameters controlling a Cox model fit using coxph_mpl_dc.
Typically it would only be used in a call to coxph_mpl_dc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxph_mpl_dc.control(ordSp,
                       binCount, tie,
                       tau, copula,
                       pent, smpart, penc, smparc,
                       maxit2, maxit,
                       mid, asy, ac, cv,
                       ac.theta, ac.gamma, ac.Utheta, ac.Ugamma,
                       min.theta, min.gamma,
                       min.ht, min.hc, min.St, min.Sc, min.C, min.dC,
                       eps, tol.thga, tol.bph, cat.smpar, tol.smpar
                       )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxph_mpl_dc.control_+3A_ordsp">ordSp</code></td>
<td>
<p>the order of spline for the basis function for baseline hazard for both T and C,
can be 'piecewise constant' if <code>ordSp=1</code>, cubic 'm-spline' if <code>ordSp=4</code>, etc. Default is <code>ordSp=1</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_bincount">binCount</code></td>
<td>
<p>the number of subjects in each discretized bin, can be selected either by trial and error or AIC method
Default is <code>binCount=1</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_tie">tie</code></td>
<td>
<p>tie='No' if tied observations are not existed, otherwise tied observations existed. Default is <code>tie='No'</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_tau">tau</code></td>
<td>
<p>the kendall’s correlation coefficient between T and C. Default is <code>tau=0</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_copula">copula</code></td>
<td>
<p>Archimedean copula type, i.e. 'independent', 'clayton', 'gumbel' and 'frank'. Default is <code>copula='independent'</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_pent">pent</code></td>
<td>
<p>penalty function type for T, i.e. mat1 (first order difference) or mat2 (second order difference) for piecewise constant basis, penalty_mspl for m-spline basis
Default is <code>pent='mat1'</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_smpart">smpart</code></td>
<td>
<p>value of smoothing parameter for T, can be selected by either trial and error or cross validation method.
Note that smpart can be also estimated by restricted maximum likelihood (i.e. <code>smpart='REML'</code>). Default is <code>smpart=0</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_penc">penc</code></td>
<td>
<p>penalty function type for C, i.e. mat1 (first order difference) or mat2 (second order difference) for piecewise constant basis, penalty_mspl for m-spline basis
Default is <code>pent='mat1'</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_smparc">smparc</code></td>
<td>
<p>value of smoothing parameter for C, can be selected by either trial and error or cross validation method.
Note that smparc can be also estimated by restricted maximum likelihood (i.e. <code>smparc='REML'</code>). Default is <code>smparc=0</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_maxit2">maxit2</code></td>
<td>
<p>maximum number of iterations for smpart and smparc. Defualt is <code>maxit2=50</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iteration for updating beta, phi, theta and gamma given fixed smpart and smparc.
Default is <code>maxit=5000</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_mid">mid</code></td>
<td>
<p>the middle matrix selection for the sandwich formula that used to computed the asymptotic covariance matrix,
i.e. <code>mid=1</code> (negative of the hessian matrix with zeros smoothing parameters, i.e. <code>smpart=smparc=0</code>,
or negative of the matrix with second derivatives of the MPL estimates with respect to the log-likelihood),
2 (the matrix created by the vector of first derivative of the penalized log-likelihood with respect to the MPL estimates times its transpose) and
otherwise (negative of the hessian matrix or negative of  the matrix with second derivatives of the MPL estimates with respect to the penalized log-likelihood). Default is <code>mid=1</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_asy">asy</code></td>
<td>
<p><code>asy=1</code> if asymptotic standard deviation of the MPL estimates are computed and 0 if not computed. Default is <code>asy=1</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_ac">ac</code></td>
<td>
<p><code>ac=1</code> if aic value is calculated 0 if not. Default is <code>ac=0</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_cv">cv</code></td>
<td>
<p><code>cv=0</code> if cv value is calculated 0 if not. Default is <code>cv=0</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_ac.theta">ac.theta</code></td>
<td>
<p>the minimum value of theta for active contraints. Default is <code>ac.theta=1e-5</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_ac.gamma">ac.gamma</code></td>
<td>
<p>the minimum value of gamma for active contraints. Default is <code>ac.gamma=1e-5</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_ac.utheta">ac.Utheta</code></td>
<td>
<p>the minimum value of Utheta (the first derivative of the penalized log-likelihood with respect to theta) for active contraints. Default is <code>ac.Utheta=1e-2</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_ac.ugamma">ac.Ugamma</code></td>
<td>
<p>the minimum value of Ugamma (the first derivative of the penalized log-likelihood with respect to gamma) for active contraints. Default is <code>ac.Ugamma=1e-2</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_min.theta">min.theta</code></td>
<td>
<p>a value indicating the minimal baseline hazard parameter value theta updated at each iteration.
Baseline hazard parameter theta estimates at each iteration lower than min.theta will be considered as min.theta. Default is <code>min.theta=1e-7</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_min.gamma">min.gamma</code></td>
<td>
<p>a value indicating the minimal baseline hazard parameter value gamma updated at each iteration.
Baseline hazard parameter gamma estimates at each iteration lower than min.gamma will be considered as min.gamma. Default is <code>min.gamma=1e-7</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_min.ht">min.ht</code></td>
<td>
<p>a value indicating the minimal baseline hazard of T updated at each iteration. Baseline hazard estimates of T at each iteration lower than min.ht will be considered as min.ht.
Default is <code>min.ht=1e-7</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_min.hc">min.hc</code></td>
<td>
<p>a value indicating the minimal baseline hazard of C updated at each iteration. Baseline hazard estimates of C at each iteration lower than min.hc will be considered as min.hc.
Default is <code>min.hc=1e-7</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_min.st">min.St</code></td>
<td>
<p>a value indicating the minimal baseline survival of T updated at each iteration. Baseline survival estimates of T at each iteration lower than min.St will be considered as min.St.
Default is <code>min.St=1e-7</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_min.sc">min.Sc</code></td>
<td>
<p>a value indicating the minimal baseline survival of C updated at each iteration. Baseline survival estimates of C at each iteration lower than min.Sc will be considered as min.Sc.
Default is <code>min.Sc=1e-7</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_min.c">min.C</code></td>
<td>
<p>a value indicating the minimal copula <code class="reqn">K(u,v)</code> at each iteration, lower than min.C will be considered as min.C.
Default is <code>min.C=1e-7</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_min.dc">min.dC</code></td>
<td>
<p>a value indicating the minimal first i.e. <code class="reqn">dK(u,v)/du</code> and <code class="reqn">dK(u,v)/dv</code> and second i.e. <code class="reqn">d^2K(u,v)/dudv</code> derivatives of copula <code class="reqn">K(u,v)</code> at each iteration,
lower than min.dC will be considered as min.dC. Default is <code>min.dC=1e-7</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_eps">eps</code></td>
<td>
<p>a small positive value added to the diagonal of a square matrix. Default value is <code>eps=1e-5</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_tol.thga">tol.thga</code></td>
<td>
<p>the convergence tolerence value for both theta and gamma.
Convergence is achieved when the maximum absolute difference between the parameter estimates at iteration k and iteration k-1 is smaller than tol.thga.
Default is <code>tol.thga=1e-5</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_tol.bph">tol.bph</code></td>
<td>
<p>the convergence tolerence value for both beta and phi.
Convergence is achieved when the maximum absolute difference between the parameter estimates at iteration k and iteration k-1 is smaller than tol.bph.
Default is <code>tol.bph=1e-5</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_cat.smpar">cat.smpar</code></td>
<td>
<p>cat.smpar='Yes' to display the smoothing parameters estimation process, otherwise not to display.
Default is <code>cat.smpar='Yes'</code>.</p>
</td></tr>
<tr><td><code id="coxph_mpl_dc.control_+3A_tol.smpar">tol.smpar</code></td>
<td>
<p>the convergence tolerence value for both smpart and smparc.
Convergence is achieved when the maximum absolute difference between the parameter estimates at iteration k and iteration k-1 is smaller than tol.smpar.
Default is <code>tol.smpar=1e-2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the values of each of the above arguments for most of the inputs of Coxph_mpl_dc.
</p>


<h3>Author(s)</h3>

<p>Jing Xu, Jun Ma, Thomas Fung
</p>


<h3>References</h3>

<p>Ma, J. and Heritier, S. and Lo, S. (2014). <em>&quot;On the Maximum Penalised Likelihood Approach forProportional Hazard Models with Right Censored Survival Data&quot;</em>.
Computational Statistics and Data Analysis 74, 142-156.
</p>
<p>Xu J, Ma J, Connors MH, Brodaty H. (2018). <em>&quot;Proportional hazard model estimation under dependent censoring using copulas and penalized likelihood&quot;</em>.
Statistics in Medicine 37, 2238–2251.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.coxph_mpl_dc">plot.coxph_mpl_dc</a></code>, <code><a href="#topic+coxph_mpl_dc">coxph_mpl_dc</a></code>, <code><a href="#topic+coef.coxph_mpl_dc">coef.coxph_mpl_dc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- coxph_mpl_dc.control(ordSp=4,
                             binCount=40,
                             tau=0.8, copula='frank',
                             pent='penalty_mspl', smpart='REML', penc='penalty_mspl', smparc='REML',
                             cat.smpar='No'
                             )

</code></pre>

<hr>
<h2 id='plot.coxph_mpl_dc'>Plot a baseline hazard estimates from coxph_mpl_dc Object</h2><span id='topic+plot.coxph_mpl_dc'></span>

<h3>Description</h3>

<p>Plot the baseline hazard with the confidence interval estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coxph_mpl_dc'
plot(
  x,
  parameter = "theta",
  funtype = "hazard",
  xout,
  se = TRUE,
  ltys,
  cols,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.coxph_mpl_dc_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+coxph_mpl_dc">coxph_mpl_dc</a></code></p>
</td></tr>
<tr><td><code id="plot.coxph_mpl_dc_+3A_parameter">parameter</code></td>
<td>
<p>the set of parameters of interest.  Indicate <code>parameters="theta"</code> for the baseline hazard
estimated by <code class="reqn">theta</code> and <code>parameters="gamma"</code> for the baseline hazard estimated by <code class="reqn">gamma</code></p>
</td></tr>
<tr><td><code id="plot.coxph_mpl_dc_+3A_funtype">funtype</code></td>
<td>
<p>the type of function for ploting, i.e. <code>funtype="hazard"</code> for baseline hazard,
<code>funtype="cumhazard"</code> for baseline cumulative hazard and <code>funtype="survival"</code> for
baseline survival function</p>
</td></tr>
<tr><td><code id="plot.coxph_mpl_dc_+3A_xout">xout</code></td>
<td>
<p>the time values for the baseline hazard plot</p>
</td></tr>
<tr><td><code id="plot.coxph_mpl_dc_+3A_se">se</code></td>
<td>
<p>se=TRUE gives both the MPL baseline estimates and 95% confidence interval plots while se=FALSE
gives only the MPL baseline estimate plot.</p>
</td></tr>
<tr><td><code id="plot.coxph_mpl_dc_+3A_ltys">ltys</code></td>
<td>
<p>a line type vector with two components, the first component is the line type of the baseline hazard
while the second component is the line type of the 95% confidence interval</p>
</td></tr>
<tr><td><code id="plot.coxph_mpl_dc_+3A_cols">cols</code></td>
<td>
<p>a colour vector with two components, the first component is the colour of the baseline hazard
while the second component is the colour the 95% confidence interval</p>
</td></tr>
<tr><td><code id="plot.coxph_mpl_dc_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the input is of class <code>coxph_mpl_dc</code> and <code>parameters=="theta"</code>, the baseline estimates
base on <code class="reqn">\theta</code> and xout (with the corresponding 95% confidence interval if se=TRUE ) are ploted.
When the input is of class <code>coxph_mpl_dc</code> and <code>parameters=="gamma"</code>, the baseline hazard estimates
based on <code class="reqn">\gamma</code> and xout (with the corresponding 95% confidence interval if se=TRUE ) are ploted.
</p>


<h3>Value</h3>

<p>the baseline hazard plot
</p>


<h3>Author(s)</h3>

<p>Jing Xu, Jun Ma, Thomas Fung
</p>


<h3>References</h3>

<p>Brodaty H, Connors M, Xu J, Woodward M, Ames D. (2014). <em>&quot;Predictors of institutionalization
in dementia: a three year longitudinal study&quot;</em>. Journal of Alzheimers Disease 40, 221-226.
</p>
<p>Xu J, Ma J, Connors MH, Brodaty H. (2018). <em>&quot;Proportional hazard model estimation under dependent censoring using copulas and penalized likelihood&quot;</em>.
Statistics in Medicine 37, 2238–2251.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coef.coxph_mpl_dc">coef.coxph_mpl_dc</a></code>, <code><a href="#topic+coxph_mpl_dc.control">coxph_mpl_dc.control</a></code>, <code><a href="#topic+coxph_mpl_dc">coxph_mpl_dc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 ##-- Copula types
 copula3 &lt;- 'frank'

##-- A real example
##-- One dataset from Prospective Research in Memory Clinics (PRIME) study
##-- Refer to article Brodaty et al (2014),
##   the predictors of institutionalization of dementia patients over 3-year study period

data(PRIME)

surv&lt;-as.matrix(PRIME[,1:3]) #time, event and dependent censoring indicators
cova&lt;-as.matrix(PRIME[, -c(1:3)]) #covariates
colMeans(surv[,2:3])  #the proportions of event and dependent censoring

n&lt;-dim(PRIME)[1];print(n)
p&lt;-dim(PRIME)[2]-3;print(p)
names(PRIME)

##--MPL estimate Cox proportional hazard model for institutionalization under medium positive
##--dependent censoring
control &lt;- coxph_mpl_dc.control(ordSp = 4,
                                binCount = 200, tie = 'Yes',
                                tau = 0.5, copula = copula3,
                                pent = 'penalty_mspl', smpart = 'REML',
                                penc = 'penalty_mspl', smparc = 'REML',
                                cat.smpar = 'No' )

coxMPLests_tau &lt;- coxph_mpl_dc(surv=surv, cova=cova, control=control, )

plot(x = coxMPLests_tau, parameter = "theta", funtype="hazard",
     xout = seq(0, 36, 0.01), se = TRUE,
     cols=c("blue", "red"), ltys=c(1, 2), type="l", lwd=1, cex=1, cex.axis=1, cex.lab=1,
     xlab="Time (Month)", ylab="Hazard",
     xlim=c(0, 36), ylim=c(0, 0.05)
     )
     title("MPL Hazard", cex.main=1)
     legend( 'topleft',legend = c( expression(tau==0.5), "95% Confidence Interval"),
     col = c("blue", "red"),
     lty = c(1, 2),
     cex = 1)

plot(x = coxMPLests_tau, parameter = "theta", funtype="cumhazard",
    xout = seq(0, 36, 0.01), se = TRUE,
    cols=c("blue", "red"), ltys=c(1, 2),
    type="l", lwd=1, cex=1, cex.axis=1, cex.lab=1,
    xlab="Time (Month)", ylab="Hazard",
    xlim=c(0, 36), ylim=c(0, 1.2)
)
title("MPL Cumulative Hazard", cex.main=1)
legend( 'topleft',
       legend = c( expression(tau==0.5), "95% Confidence Interval"),
       col = c("blue", "red"),
       lty = c(1, 2),
       cex = 1
)

plot(x = coxMPLests_tau, parameter = "theta", funtype="survival",
    xout = seq(0, 36, 0.01), se = TRUE,
    cols=c("blue", "red"), ltys=c(1, 2),
    type="l", lwd=1, cex=1, cex.axis=1, cex.lab=1,
    xlab="Time (Month)", ylab="Hazard",
    xlim=c(0, 36), ylim=c(0, 1)
)
title("MPL Survival", cex.main=1)
legend( 'bottomleft',
       legend = c( expression(tau==0.5), "95% Confidence Interval"),
       col = c("blue", "red"),
       lty = c(1, 2),
       cex = 1
)



</code></pre>

<hr>
<h2 id='PRIME'>PRIME data set</h2><span id='topic+PRIME'></span>

<h3>Description</h3>

<p>This data set is from a longitudinal study called &quot;Prospective Research in Memory Clinics&quot; (PRIME),
see Brodaty et al (2011), with a period of 3-year. The data set includes 583 dementia patients. The
outcome is time to institutionalised. The predicators are age, sex, educational level, living status,
dementia type, baseline cognitive ability (MMSE), baseline functional ability (SMAF),
baseline neuropsychiatric symptoms (total NPI), baseline dementia severity (CDR),
baseline caregiver burden (ZBI), medication types, change in cognitive ability at 3 months,
change in functional ability at 3 months, and change in neuropsychiatric symptoms at 3 months.
Note that this data set is complete and was analyzed by Brodaty et al (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PRIME)
</code></pre>


<h3>Format</h3>

<p>A data frame with 583 observations on 18 variables.
</p>

<dl>
<dt>Time</dt><dd><p>observed time in term of months</p>
</dd>
<dt>Event</dt><dd><p>event or institutionalisation, 1=Yes and 0=No</p>
</dd>
<dt>Depcen</dt><dd><p>dependent right censoring or withdrawal, 1=Yes and 0=No</p>
</dd>
<dt>Age</dt><dd><p>age at baseline, 1=80 years or above and 0=80 year below</p>
</dd>
<dt>Gender</dt><dd><p>gender, 1=Female and 0=Male</p>
</dd>
<dt>HighEdu</dt><dd><p>education level at baseline, 1=high school above and 0=high school
or below</p>
</dd>
<dt>Alzheimer</dt><dd><p>Alzheimer disease, 1=Yes and 0=No</p>
</dd>
<dt>CDR_base</dt><dd><p>dementia severity at baseline</p>
</dd>
<dt>MMSE_base</dt><dd><p>cognitive ability at baseline</p>
</dd>
<dt>SMAF_base</dt><dd><p>functional ability at baseline</p>
</dd>
<dt>ZBI_base</dt><dd><p>caregiver burden at baseline</p>
</dd>
<dt>NPI_base</dt><dd><p>neuropsychiatric symptoms at baseline</p>
</dd>
<dt>Benzon</dt><dd><p>benzodiazepines taking, 1=Yes and 0=No</p>
</dd>
<dt>Antiphsy</dt><dd><p>anti-psychotics taking, 1=Yes and 0=No</p>
</dd>
<dt>LivingAlone</dt><dd><p>living alone, 1=Yes and 0=No</p>
</dd>
<dt>MMSE_change_3m</dt><dd><p>cognitive ability change at 3-month from baseline</p>
</dd>
<dt>SMAF_change_3m</dt><dd><p>functional ability change at 3-month from baseline</p>
</dd>
<dt>NPI_change_3m</dt><dd><p>neuropsychiatric symptoms change at 3-month from baseline</p>
</dd>
</dl>



<h3>References</h3>

<p>Brodaty H, Woodward M, Boundy K, Ames D, Balshaw R. (2011). <em>&quot;Patients in Australian memory clinics:
baseline characteristics and predictors of decline at six months&quot;</em>. Int Psychogeriatr 23, 1086-1096.
</p>
<p>Brodaty H, Connors M, Xu J, Woodward M, Ames D. (2014). <em>&quot;Predictors of institutionalization
in dementia: a three year longitudinal study&quot;</em>. Journal of Alzheimers Disease 40, 221-226.
</p>

<hr>
<h2 id='surv_data_dc'>Generate a sample of time to event dataset with dependent right censoring under an Archimedean copula</h2><span id='topic+surv_data_dc'></span>

<h3>Description</h3>

<p>Generate a sample of time to event dataset with, dependent right censoring based on one of the Archimedean copulas the given Kendall's tau, sample size n and covariates matrix Z.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surv_data_dc(n, a, Z, lambda, betas, phis, cons7, cons9, tau, copula, distr.ev, distr.ce)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="surv_data_dc_+3A_n">n</code></td>
<td>
<p>the sample size, or the number of the subjects in a sample.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_a">a</code></td>
<td>
<p>the shape parameter of baseline hazard for the event time <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_z">Z</code></td>
<td>
<p>the covariate matrix with dimension of <code class="reqn">n</code> by <code class="reqn">p</code>, where <code class="reqn">p</code> is the number of covariates.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_lambda">lambda</code></td>
<td>
<p>the scale parameter of baseline hazard for event time <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_betas">betas</code></td>
<td>
<p>the regression coefficient vector of proportional hazard model for the event time <code class="reqn">T</code> with dimenion of <code class="reqn">p</code> by <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_phis">phis</code></td>
<td>
<p>the regression coefficient vector of proportional hazard model for dependent censoring time <code class="reqn">C</code> with dimenion of <code class="reqn">p</code> by <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_cons7">cons7</code></td>
<td>
<p>the parameter of baseline hazard for the dependent censoring time <code class="reqn">C</code> if assuming an exponential distribution.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_cons9">cons9</code></td>
<td>
<p>the upper limit parameter of uniform distribution for the independent censoring time <code class="reqn">A</code>,
i.e. <code class="reqn">A</code>~U(0, cons9).</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_tau">tau</code></td>
<td>
<p>the Kendall's correlation coefficient between <code class="reqn">T</code> and <code class="reqn">C</code>.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_copula">copula</code></td>
<td>
<p>the Archemedean copula that captures the dependence between <code class="reqn">T</code> and <code class="reqn">C</code>, a characteristc value,
i.e. 'independent', 'clayton', 'gumbel' or 'frank'.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_distr.ev">distr.ev</code></td>
<td>
<p>the distribution of the event time, a characteristc value, i.e. 'weibull' or 'log logit'.</p>
</td></tr>
<tr><td><code id="surv_data_dc_+3A_distr.ce">distr.ce</code></td>
<td>
<p>the distribution of the dependent censoring time, a characteristc value, i.e. 'exponential' or 'weibull'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>surv_data_dc allows to generate a survival dataset under dependent right censoring, at sample size <code>n</code>, based on one of the Archimedean <code>copula</code>,
Kendall's <code>tau</code>, and covariates matrix <code>Z</code> with dimension of <code class="reqn">n</code> by <code class="reqn">p</code>. For example, at <code>p=2</code>, we have <code>Z=cbind(Z1, Z2)</code>,
where <code>Z1</code> is treatment generated by distribution of bernoulli(0.5), i.e. 1 represents treatment group and 0 represents control group; <code>Z2</code> is the age
generated by distribution of U(-10, 10).
</p>
<p>The generated dataset includes three varaibles, which are <code class="reqn">X_i</code>, <code class="reqn">\delta_i</code> and <code class="reqn">\eta_i</code>, i.e.
<code class="reqn">X_i=min(T_i, C_i, A_i)</code>, <code class="reqn">\delta_i=I(X_i=T_i)</code> and <code class="reqn">\eta_i=I(X_i=C_i)</code>, for <code class="reqn">i=1,\ldots,n</code>.
'T' represents the event time, whose hazard function is </p>
<p style="text-align: center;"><code class="reqn">h_T(x)=h_{0T}(x)exp(Z^{\top}\beta)</code>
</p>
<p>,
where the baseline hazard can take weibull form, i.e. <code class="reqn">h_{0T}(x) = ax^{a-1} / \lambda^a</code>, or log logistic form, i.e.
</p>
<p style="text-align: center;"><code class="reqn"> h_{0T}(x) = \frac{ \frac{ 1 }{ a exp( \lambda ) } ( \frac{ x }{ exp( \lambda ) } )^{1/a -1 } }{ 1 + ( \frac{ x }{ exp( \lambda ) } )^{1/a}  } </code>
</p>
<p>.
'C' represents the dependent censoring time, whose hazard function is <code class="reqn"> h_{C}(x) = h_{0C}(x)exp( Z^{\top}\phi) </code>, where the baseline hazard can take exponential form, i.e.
<code class="reqn">h_{0C}(x)=cons7</code>, or weibull form, i.e. <code class="reqn">h_{0C}(x) = ax^{a-1} / \lambda^a</code>.'A' represents the administrative or independent censoring time, where A~U(0, cons9).
</p>


<h3>Value</h3>

<p>A sample of time to event dataset under dependent right censoring, which includes observed time <code class="reqn">X</code>, event indicator <code class="reqn">\delta</code> and dependent censoring indicator <code class="reqn">\eta</code>.
</p>


<h3>Author(s)</h3>

<p>Jing Xu, Jun Ma, Thomas Fung
</p>


<h3>References</h3>

<p>Xu J, Ma J, Connors MH, Brodaty H. (2018). <em>&quot;Proportional hazard model estimation under dependent censoring using copulas and penalized likelihood&quot;</em>.
Statistics in Medicine 37, 2238–2251.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coxph_mpl_dc">coxph_mpl_dc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ##-- Copula types
 copula3 &lt;- 'frank'

 ##-- Marginal distribution for T, C, and A
 a &lt;- 2
 lambda &lt;- 2
 cons7 &lt;- 0.2
 cons9 &lt;- 10
 tau &lt;- 0.8
 betas &lt;- c(-0.5, 0.1)
 phis &lt;- c(0.3, 0.2)
 distr.ev &lt;- 'weibull'
 distr.ce &lt;- 'exponential'

 ##-- Sample size
 n &lt;- 200

 ##-- One sample Monte Carlo dataset
 cova &lt;- cbind(rbinom(n, 1, 0.5), runif(n, min=-10, max=10))
 surv &lt;- surv_data_dc(n, a, cova, lambda, betas, phis, cons7, cons9,
                     tau, copula3, distr.ev, distr.ce)
 n &lt;- nrow(cova)
 p &lt;- ncol(cova)
 ##-- event and dependent censoring proportions
 colSums(surv)[c(2,3)]/n
 X &lt;- surv[,1] # Observed time
 del&lt;-surv[,2] # failure status
 eta&lt;-surv[,3] # dependent censoring status


</code></pre>

<hr>
<h2 id='survivalMPLdc-package'>Penalised Likelihood for Survival Analysis with Dependent Censoring</h2><span id='topic+survivalMPLdc-package'></span><span id='topic+survivalMPLdc'></span>

<h3>Description</h3>

<p>Penalised Likelihood for Survival Analysis with Dependent Censoring
</p>


<h3>References</h3>

<p>Ma, J. (2010). <em>&quot;Positively constrained multiplicative iterative algorithm
for maximum penalised likelihood tomographic reconstruction&quot;</em>. IEEE Transactions On Signal Processing
57, 181-192.
</p>
<p>Brodaty H, Woodward M, Boundy K, Ames D, Balshaw R. (2011). <em>&quot;Patients in Australian memory clinics:
baseline characteristics and predictors of decline at six months&quot;</em>. Int Psychogeriatr 23, 1086-1096.
</p>
<p>Ma, J. and Heritier, S. and Lo, S. (2014). <em>&quot;On the Maximum Penalised Likelihood Approach
for Proportional Hazard Models with Right Censored Survival Data&quot;</em>. Computational Statistics and
Data Analysis 74, 142-156.
</p>
<p>Brodaty H, Connors M, Xu J, Woodward M, Ames D. (2014). <em>&quot;Predictors of institutionalization
in dementia: a three year longitudinal study&quot;</em>. Journal of Alzheimers Disease 40, 221-226.
</p>
<p>Xu J, Ma J, Connors MH, Brodaty H. (2018). <em>&quot;Proportional hazard model estimation under
dependent censoring using copulas and penalized likelihood&quot;</em>. Statistics in Medicine 37, 2238–2251.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
