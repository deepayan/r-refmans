<!DOCTYPE html><html><head><title>Help for package ratesci</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ratesci}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ratesci-package'><p>ratesci: A package for computing confidence intervals for various</p>
comparisons of independent binomial and Poisson rates.</a></li>
<li><a href='#jeffreysci'><p>Jeffreys and other approximate Bayesian confidence intervals for a single</p>
binomial or Poisson rate.</a></li>
<li><a href='#moverbci'><p>Approximate Bayesian (&quot;MOVER-B&quot;) confidence intervals for</p>
comparisons of independent binomial or Poisson rates.</a></li>
<li><a href='#moverci'><p>MOVER confidence intervals for comparisons of independent binomial or Poisson</p>
rates.</a></li>
<li><a href='#pairbinci'><p>Confidence intervals for comparisons of paired binomial rates.</p></a></li>
<li><a href='#rateci'><p>Selected confidence intervals for the single binomial or Poisson rate.</p></a></li>
<li><a href='#scasci'><p>Skewness-corrected asymptotic score (&quot;SCAS&quot;) confidence intervals for</p>
comparisons of independent binomial or Poisson rates.</a></li>
<li><a href='#scaspci'><p>Skewness-corrected asymptotic score (&quot;SCAS&quot;) confidence intervals for</p>
single binomial or Poisson rate using closed-form calculations.
This function is vectorised in x, n.</a></li>
<li><a href='#scoreci'><p>Score confidence intervals for comparisons of independent binomial or Poisson</p>
rates.</a></li>
<li><a href='#tdasci'><p>t-distribution asymptotic score (&quot;TDAS&quot;) confidence intervals for</p>
comparisons of independent binomial or Poisson rates.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Confidence Intervals for Comparisons of Binomial or Poisson
Rates</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-12-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Pete Laud [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pete Laud &lt;p.j.laud@sheffield.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes confidence intervals for the rate (or risk)
    difference ('RD') or rate ratio (or relative risk, 'RR') for 
    binomial proportions or Poisson rates, or for odds ratio 
    ('OR', binomial only). Also confidence intervals for a single 
    binomial or Poisson rate, and intervals for matched pairs. 
    Includes skewness-corrected asymptotic score ('SCAS') methods, 
    which have been developed in Laud (2017) &lt;<a href="https://doi.org/10.1002%2Fpst.1813">doi:10.1002/pst.1813</a>&gt;
    from Miettinen &amp; Nurminen (1985) &lt;<a href="https://doi.org/10.1002%2Fsim.4780040211">doi:10.1002/sim.4780040211</a>&gt; and 
    Gart &amp; Nam (1988) &lt;<a href="https://doi.org/10.2307%2F2531848">doi:10.2307/2531848</a>&gt;. The same score produces 
    hypothesis tests analogous to the test for binomial RD and RR by 
    Farrington &amp; Manning (1990) &lt;<a href="https://doi.org/10.1002%2Fsim.4780091208">doi:10.1002/sim.4780091208</a>&gt;. 
    The package also includes MOVER methods
    (Method Of Variance Estimates Recovery) for all contrasts, derived 
    from the Newcombe method but using equal-tailed Jeffreys intervals,
    and generalised for Bayesian applications incorporating prior 
    information. So-called 'exact' methods for strictly conservative 
    coverage are approximated using continuity corrections.
    Also includes methods for stratified calculations (e.g. meta-analysis),
    either assuming fixed effects (matching the CMH test) or incorporating 
    stratum heterogeneity.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-04 23:31:55 UTC; ssu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-05 08:00:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='ratesci-package'>ratesci: A package for computing confidence intervals for various
comparisons of independent binomial and Poisson rates.</h2><span id='topic+ratesci-package'></span>

<h3>Description</h3>

<p>Computes confidence intervals for the rate difference (RD), rate ratio (RR),
or odds ratio (OR), or for the single rate (p), for independent binomial or
Poisson rates. Includes score-based methods with (or without) skewness
correction, developed from the Miettinen-Nurminen and Gart-Nam methods,
and the &quot;Method of Variance Estimates Recovery&quot;, originating from Newcombe.
For the single-stratum case, the skewness-corrected asymptotic score (SCAS)
method is recommended (Laud 2017), on the basis of superior equal-tailed
coverage. Hypothesis tests (a corrected version of the Farrington-Manning
test) follow naturally from the score-based methods, and are equivalent to
the Cochran-Mantel-Haenszel (CMH) test if the skewness correction is
omitted.
</p>


<h3>ratesci functions</h3>


<ul>
<li><p> scoreci: for score-based confidence intervals
</p>
</li>
<li><p> scasci: wrapper function to compute SCAS interval
</p>
</li>
<li><p> tdasci: wrapper function to compute TDAS stratified
interval
</p>
</li>
<li><p> moverci: for the MOVER method
</p>
</li>
<li><p> moverbci: wrapper function to compute MOVER-B interval
</p>
</li>
<li><p> jeffreysci: wrapper function to compute Jeffreys interval for a
single rate
</p>
</li>
<li><p> pairbinci: for paired binomial data
</p>
</li>
<li><p> scaspci: non-iterative SCAS method for a single rate
</p>
</li>
<li><p> rateci: wrapper function for SCAS, Jeffreys or 'exact' methods
for a single rate
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pete Laud, <a href="mailto:p.j.laud@sheffield.ac.uk">p.j.laud@sheffield.ac.uk</a>
</p>


<h3>References</h3>

<p>Laud PJ. Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2017; 16:334-348.
</p>
<p>Laud PJ. Corrigendum: Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2018; 17:290-293.
</p>
<p>Tang Y. Score confidence intervals and sample sizes for stratified
comparisons of binomial proportions. Statistics in Medicine 2020;
39:3427–3457.
</p>
<p>Tang Y. Comments on “Equal-tailed confidence intervals for
comparison of rates”. Pharmaceutical Statistics 2021;
online ahead of print.
</p>
<p>Laud PJ. Author's reply to the letter to the editor by Yongqiang Tang:
Comments on “Equal-tailed confidence intervals for
comparison of rates”. Pharmaceutical Statistics 2021;
online ahead of print.
</p>
<p>Miettinen OS, Nurminen M. Comparative analysis of two rates. Statistics in
Medicine 1985; 4:213-226.
</p>
<p>Gart JJ. Analysis of the common odds ratio: corrections for bias and
skewness. Bulletin of the International Statistical Institute 1985,
45th session, book 1, 175-176.
</p>
<p>Gart JJ, Nam JM. Approximate interval estimation of the ratio of binomial
parameters: A review and corrections for skewness. Biometrics 1988;
44(2):323-338.
</p>
<p>Gart JJ, Nam JM. Approximate interval estimation of the difference in
binomial parameters: correction for skewness and extension to multiple
tables. Biometrics 1990; 46(3):637-643.
</p>
<p>Farrington CP, Manning G. Test statistics and sample size formulae
for comparative binomial trials with null hypothesis of non-zero risk
difference or non-unity relative risk. Statistics in Medicine 1990;
9(12):1447–1454.
</p>
<p>Newcombe RG. Interval estimation for the difference between independent
proportions: comparison of eleven methods. Statistics in Medicine 1998;
17(8):873-890.
</p>
<p>Donner A, Zou G. Closed-form confidence intervals for functions of the
normal mean and standard deviation. Statistical Methods in Medical Research
2012; 21(4):347-359.
</p>

<hr>
<h2 id='jeffreysci'>Jeffreys and other approximate Bayesian confidence intervals for a single
binomial or Poisson rate.</h2><span id='topic+jeffreysci'></span>

<h3>Description</h3>

<p>Generalised approximate Bayesian confidence intervals based on a Beta (for
binomial rates) or Gamma (for Poisson rates) conjugate priors. Encompassing
the Jeffreys method (with Beta(0.5, 0.5) or Gamma(0.5) respectively), as well
as any user-specified prior distribution. Clopper-Pearson method (as
quantiles of a Beta distribution as described in Brown et al. 2001) also
included by way of a &quot;continuity correction&quot; parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jeffreysci(
  x,
  n,
  ai = 0.5,
  bi = 0.5,
  cc = 0,
  level = 0.95,
  distrib = "bin",
  adj = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jeffreysci_+3A_x">x</code></td>
<td>
<p>Numeric vector of number of events.</p>
</td></tr>
<tr><td><code id="jeffreysci_+3A_n">n</code></td>
<td>
<p>Numeric vector of sample sizes (for binomial rates) or exposure
times (for Poisson rates).</p>
</td></tr>
<tr><td><code id="jeffreysci_+3A_ai">ai</code>, <code id="jeffreysci_+3A_bi">bi</code></td>
<td>
<p>Numbers defining the Beta prior distribution (default ai = bi =
0.5 for Jeffreys interval). Gamma prior for Poisson rates requires only ai.</p>
</td></tr>
<tr><td><code id="jeffreysci_+3A_cc">cc</code></td>
<td>
<p>Number or logical specifying (amount of) &quot;continuity correction&quot;.
cc = 0 (default) gives Jeffreys interval, cc = 0.5 gives the
Clopper-Pearson interval (or Garwood for Poisson). A value between 0 and
0.5 allows a compromise between proximate and conservative coverage.</p>
</td></tr>
<tr><td><code id="jeffreysci_+3A_level">level</code></td>
<td>
<p>Number specifying confidence level (between 0 and 1, default
0.95).</p>
</td></tr>
<tr><td><code id="jeffreysci_+3A_distrib">distrib</code></td>
<td>
<p>Character string indicating distribution assumed for the input
data: &quot;bin&quot; = binomial (default), &quot;poi&quot; = Poisson.</p>
</td></tr>
<tr><td><code id="jeffreysci_+3A_adj">adj</code></td>
<td>
<p>Logical (default TRUE) indicating whether to apply the boundary
adjustment recommended on p108 of Brown et al. (set to FALSE if informative
priors are used)</p>
</td></tr>
<tr><td><code id="jeffreysci_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pete Laud, <a href="mailto:p.j.laud@sheffield.ac.uk">p.j.laud@sheffield.ac.uk</a>
</p>


<h3>References</h3>

<p>Laud PJ. Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2017; 16:334-348.
</p>
<p>Brown LD, Cai TT, DasGupta A. Interval estimation for a binomial
proportion. Statistical Science 2001; 16(2):101-133
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Jeffreys method:
jeffreysci(x = 5, n = 56)
</code></pre>

<hr>
<h2 id='moverbci'>Approximate Bayesian (&quot;MOVER-B&quot;) confidence intervals for
comparisons of independent binomial or Poisson rates.</h2><span id='topic+moverbci'></span>

<h3>Description</h3>

<p>Wrapper function for the MOVER-B methods.  Approximate Bayesian confidence
intervals for the rate (or risk) difference (&quot;RD&quot;) or ratio (&quot;RR&quot;) for
independent binomial or Poisson rates, or for odds ratio (&quot;OR&quot;, binomial
only). (developed from Newcombe, Donner &amp; Zou, Li et al, and Fagerland &amp;
Newcombe, and generalised as &quot;MOVER-B&quot; in forthcoming publication) including
special case &quot;MOVER-J&quot; using non-informative priors with optional continuity
correction.  This function is vectorised in x1, x2, n1, and n2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moverbci(
  x1,
  n1,
  x2,
  n2,
  a1 = 0.5,
  b1 = 0.5,
  a2 = 0.5,
  b2 = 0.5,
  distrib = "bin",
  contrast = "RD",
  level = 0.95,
  cc = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moverbci_+3A_x1">x1</code>, <code id="moverbci_+3A_x2">x2</code></td>
<td>
<p>Numeric vectors of numbers of events in group 1 &amp; group 2
respectively.</p>
</td></tr>
<tr><td><code id="moverbci_+3A_n1">n1</code>, <code id="moverbci_+3A_n2">n2</code></td>
<td>
<p>Numeric vectors of sample sizes (for binomial rates) or exposure
times (for Poisson rates) in each group.</p>
</td></tr>
<tr><td><code id="moverbci_+3A_a1">a1</code>, <code id="moverbci_+3A_b1">b1</code>, <code id="moverbci_+3A_a2">a2</code>, <code id="moverbci_+3A_b2">b2</code></td>
<td>
<p>Numbers defining the Beta(ai,bi) prior distributions for
each group (default ai = bi = 0.5 for Jeffreys uninformative priors). Gamma
priors for Poisson rates require only a1, a2.</p>
</td></tr>
<tr><td><code id="moverbci_+3A_distrib">distrib</code></td>
<td>
<p>Character string indicating distribution assumed for the input
data: &quot;bin&quot; = binomial (default), &quot;poi&quot; = Poisson.</p>
</td></tr>
<tr><td><code id="moverbci_+3A_contrast">contrast</code></td>
<td>
<p>Character string indicating the contrast of interest: &quot;RD&quot; =
rate difference (default), &quot;RR&quot; = rate ratio, &quot;OR&quot; = odds ratio.
contrast=&quot;p&quot; gives an interval for the single proportion x1/n1.</p>
</td></tr>
<tr><td><code id="moverbci_+3A_level">level</code></td>
<td>
<p>Number specifying confidence level (between 0 and 1, default
0.95).</p>
</td></tr>
<tr><td><code id="moverbci_+3A_cc">cc</code></td>
<td>
<p>Number or logical specifying (amount of) continuity correction
(default FALSE). Numeric value is taken as the gamma parameter in Laud 2017,
Appendix S2 (default 0.5 if cc=TRUE). Forced equal to 0.5 if type=&quot;exact&quot;.
NB: cc currently not implemented for type=&quot;wilson&quot;.</p>
</td></tr>
<tr><td><code id="moverbci_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='moverci'>MOVER confidence intervals for comparisons of independent binomial or Poisson
rates.</h2><span id='topic+moverci'></span>

<h3>Description</h3>

<p>Confidence intervals applying the MOVER method (&quot;Method of Variance Estimates
Recovery&quot;, developed from the Newcombe method for binomial RD) across
different contrasts (RD, RR, OR) and distributions (binomial, Poisson) using
equal-tailed Jeffreys intervals instead of the Wilson score method for the
event rates.  Also allows more general Beta and Gamma priors for an
approximate Bayesian confidence interval incorporating prior beliefs about
the group event rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moverci(
  x1,
  n1,
  x2 = NULL,
  n2 = NULL,
  a1 = 0.5,
  b1 = 0.5,
  a2 = 0.5,
  b2 = 0.5,
  cc = FALSE,
  level = 0.95,
  distrib = "bin",
  contrast = "RD",
  type = "jeff",
  adj = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moverci_+3A_x1">x1</code>, <code id="moverci_+3A_x2">x2</code></td>
<td>
<p>Numeric vectors of numbers of events in group 1 &amp; group 2
respectively.</p>
</td></tr>
<tr><td><code id="moverci_+3A_n1">n1</code>, <code id="moverci_+3A_n2">n2</code></td>
<td>
<p>Numeric vectors of sample sizes (for binomial rates) or exposure
times (for Poisson rates) in each group.</p>
</td></tr>
<tr><td><code id="moverci_+3A_a1">a1</code>, <code id="moverci_+3A_b1">b1</code>, <code id="moverci_+3A_a2">a2</code>, <code id="moverci_+3A_b2">b2</code></td>
<td>
<p>Numbers defining the Beta(ai,bi) prior distributions for
each group (default ai = bi = 0.5 for Jeffreys method). Gamma priors for
Poisson rates require only a1, a2.</p>
</td></tr>
<tr><td><code id="moverci_+3A_cc">cc</code></td>
<td>
<p>Number or logical specifying (amount of) continuity correction
(default FALSE). Numeric value is taken as the gamma parameter in Laud 2017,
Appendix S2 (default 0.5 if cc=TRUE). Forced equal to 0.5 if type=&quot;exact&quot;.
NB: cc currently not implemented for type=&quot;wilson&quot;.</p>
</td></tr>
<tr><td><code id="moverci_+3A_level">level</code></td>
<td>
<p>Number specifying confidence level (between 0 and 1, default
0.95).</p>
</td></tr>
<tr><td><code id="moverci_+3A_distrib">distrib</code></td>
<td>
<p>Character string indicating distribution assumed for the input
data: &quot;bin&quot; = binomial (default), &quot;poi&quot; = Poisson.</p>
</td></tr>
<tr><td><code id="moverci_+3A_contrast">contrast</code></td>
<td>
<p>Character string indicating the contrast of interest: &quot;RD&quot; =
rate difference (default), &quot;RR&quot; = rate ratio, &quot;OR&quot; = odds ratio.
contrast=&quot;p&quot; gives an interval for the single proportion x1/n1.</p>
</td></tr>
<tr><td><code id="moverci_+3A_type">type</code></td>
<td>
<p>Character string indicating the method used for the intervals for
the individual group rates.
&quot;jeff&quot; = Jeffreys equal-tailed intervals (default);
&quot;exact&quot; = Clopper-Pearson/Garwood exact intervals (note this does NOT
result in a strictly conservative interval for the contrast, except for
contrast='p'. The scoreci function with cc=TRUE is recommended as a
superior approximation of 'exact' methods);
&quot;midp&quot; = mid-p intervals (to be added);
&quot;SCAS&quot; = SCAS non-iterative intervals (to be added);
&quot;wilson&quot; = Wilson score intervals (as per Newcombe 1998).
NB: &quot;wilson&quot; option is included only for legacy validation against previous
published method by Newcombe. It is not recommended, as type=&quot;jeff&quot;
achieves much better coverage properties.</p>
</td></tr>
<tr><td><code id="moverci_+3A_adj">adj</code></td>
<td>
<p>Logical (default FALSE) indicating whether to apply the boundary
adjustment for Jeffreys intervals recommended on p108 of Brown et al.
(type = &quot;jeff&quot; only: set to FALSE if using informative priors)</p>
</td></tr>
<tr><td><code id="moverci_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the confidence interval for the requested contrast
</p>


<h3>Author(s)</h3>

<p>Pete Laud, <a href="mailto:p.j.laud@sheffield.ac.uk">p.j.laud@sheffield.ac.uk</a>
</p>


<h3>References</h3>

<p>Laud PJ. Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2017; 16:334-348.
</p>
<p>Newcombe RG. Interval estimation for the difference between independent
proportions: comparison of eleven methods. Statistics in Medicine 1998;
</p>
<p>Donner A, Zou G. Closed-form confidence intervals for functions of the
normal mean and standard deviation. Statistical Methods in Medical Research
</p>
<p>Fagerland MW, Newcombe RG. Confidence intervals for odds ratio and relative
risk based on the inverse hyperbolic sine transformation. Statistics in
Medicine 2013; 32(16):2823-2836.
</p>
<p>Li HQ, Tang ML, Wong WK. Confidence intervals for ratio of two Poisson
rates using the method of variance estimates recovery. Computational
Statistics 2014; 29(3-4):869-889.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Binomial RD, MOVER-J method:
moverci(x1 = 5, n1 = 56, x2 = 0, n2 = 29)

# Binomial RD, Newcombe method:
moverci(x1 = 5, n1 = 56, x2 = 0, n2 = 29, type = "wilson")
</code></pre>

<hr>
<h2 id='pairbinci'>Confidence intervals for comparisons of paired binomial rates.</h2><span id='topic+pairbinci'></span>

<h3>Description</h3>

<p>Score-based confidence intervals for the rate (or risk) difference ('RD'),
rate ratio ('RR') or odds ratio ('OR'), for paired binomial data.
[For paired Poisson rates, use the tdasci function with distrib='poi',
and weighting='MH', with pairs as strata.].
This function applies the Tango and Tang methods for RD and RR respectively,
as well as an experimental method using the stratified TDAS method with
pairs as strata.
For OR, intervals are produced based on transforming various intervals for
the single proportion, including SCAS, mid-p and Jeffreys.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairbinci(
  x,
  contrast = "RD",
  level = 0.95,
  method_RD = "Score",
  method_RR = "Score",
  method_OR = "SCAS",
  theta0 = NULL,
  precis = 6
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairbinci_+3A_x">x</code></td>
<td>
<p>A numeric vector object specified as c(a,b,c,d)
where:
a is the number of pairs with the event (e.g. success) under both
conditions (e.g. treated/untreated, or case/control)
b is the count of the number with the event on condition 1 only (=n12)
c is the count of the number with the event on condition 2 only (=n21)
d is the number of pairs with no event under both conditions
(Note the order of a and d is only important for contrast=&quot;RR&quot;.)</p>
</td></tr>
<tr><td><code id="pairbinci_+3A_contrast">contrast</code></td>
<td>
<p>Character string indicating the contrast of interest:
&quot;RD&quot; = rate difference (default), &quot;RR&quot; = rate ratio, &quot;OR&quot; = odds ratio.</p>
</td></tr>
<tr><td><code id="pairbinci_+3A_level">level</code></td>
<td>
<p>Number specifying confidence level (between 0 and 1, default
0.95).</p>
</td></tr>
<tr><td><code id="pairbinci_+3A_method_rd">method_RD</code></td>
<td>
<p>Character string indicating the confidence interval method
to be used for contrast=&quot;RD&quot;. &quot;Score&quot; = Tango asymptotic score (default),
&quot;TDAS&quot; = t-distribution asymptotic score (experimental method, seems to
struggle with low numbers).</p>
</td></tr>
<tr><td><code id="pairbinci_+3A_method_rr">method_RR</code></td>
<td>
<p>Character string indicating the confidence interval method
to be used for contrast=&quot;RR&quot;. &quot;Score&quot; = Tang asymptotic score (default),
&quot;TDAS&quot; t-distribution asymptotic score (experimental method, seems to
struggle with low numbers).</p>
</td></tr>
<tr><td><code id="pairbinci_+3A_method_or">method_OR</code></td>
<td>
<p>Character string indicating the confidence interval method
to be used for contrast=&quot;OR&quot;, all of which are based on transformation of
an interval for a single proportion b/(b+c):
&quot;SCAS&quot; = transformed skewness-corrected score (default),
&quot;Jeffreys&quot; = transformed Jeffreys (to be added),
&quot;midp&quot; = transformed mid-p,
(&quot;Wilson&quot; = transformed Wilson score - not yet included, would be for
reference only, not recommended).</p>
</td></tr>
<tr><td><code id="pairbinci_+3A_theta0">theta0</code></td>
<td>
<p>Number to be used in a one-sided significance test (e.g.
non-inferiority margin). 1-sided p-value will be &lt;0.025 iff 2-sided 95% CI
excludes theta0. NB: can also be used for a superiority test by setting
theta0=0.</p>
</td></tr>
<tr><td><code id="pairbinci_+3A_precis">precis</code></td>
<td>
<p>Number (default 6) specifying precision (i.e. number of decimal
places) to be used in optimisation subroutine for the confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pete Laud, <a href="mailto:p.j.laud@sheffield.ac.uk">p.j.laud@sheffield.ac.uk</a>
</p>


<h3>References</h3>

<p>Laud PJ. Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2017; 16:334-348.
</p>
<p>Tango T. Equivalence test and confidence interval for the difference
in proportions for the paired-sample design. Statistics in Medicine
1998; 17:891-908
</p>
<p>Tango T. Improved confidence intervals for the difference between binomial
proportions based on paired data by Robert G. Newcombe, Statistics in
Medicine, 17, 2635–2650 (1998). Statistics in Medicine 1999;
18(24):3511-3513
</p>
<p>Tang N-S, Tang M-L, Chan ISF. On tests of equivalence via non-unity
relative risk for matched-pair design. Statistics in Medicine 2003;
22:1217-1233
</p>
<p>Fagerland MW, Lydersen S, Laake P. Recommended tests and
confidence intervals for paired binomial proportions. Statistics in
Medicine 2014; 33(16):2850–2875
</p>
<p>Agresti A, Min Y. Simple improved confidence intervals for
comparing matched proportions. Statistics in Medicine 2005;
24:729-740
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data example from Agresti-Min 2005
pairbinci(x = c(53, 16, 8, 9), contrast = "RD", method_RD = "Score")
pairbinci(x = c(53, 16, 8, 9), contrast = "RD", method_RD = "TDAS")
pairbinci(x = c(53, 16, 8, 9), contrast = "RR", method_RR = "Score")
pairbinci(x = c(53, 16, 8, 9), contrast = "RR", method_RR = "TDAS")
pairbinci(x = c(53, 16, 8, 9), contrast = "OR", method_OR = "SCAS")
</code></pre>

<hr>
<h2 id='rateci'>Selected confidence intervals for the single binomial or Poisson rate.</h2><span id='topic+rateci'></span>

<h3>Description</h3>

<p>Confidence intervals for the single binomial or Poisson rate. Including
SCAS or Jeffreys intervals, with or without continuity correction, and
'exact' Clopper-Pearson/Garwood or mid-p intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rateci(x, n, distrib = "bin", level = 0.95, cc = FALSE, precis = 6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rateci_+3A_x">x</code></td>
<td>
<p>Numeric vector of number of events.</p>
</td></tr>
<tr><td><code id="rateci_+3A_n">n</code></td>
<td>
<p>Numeric vector of sample size (for binomial rate) or exposure
times (for Poisson rate).</p>
</td></tr>
<tr><td><code id="rateci_+3A_distrib">distrib</code></td>
<td>
<p>Character string indicating distribution assumed for the input
data: &quot;bin&quot; = binomial (default), &quot;poi&quot; = Poisson.</p>
</td></tr>
<tr><td><code id="rateci_+3A_level">level</code></td>
<td>
<p>Number specifying confidence level (between 0 and 1, default
0.95).</p>
</td></tr>
<tr><td><code id="rateci_+3A_cc">cc</code></td>
<td>
<p>Number or logical (default FALSE) specifying continuity
correction.</p>
</td></tr>
<tr><td><code id="rateci_+3A_precis">precis</code></td>
<td>
<p>Number (default 6) specifying precision (i.e. number of decimal
places) to be used in optimisation subroutine for the SCAS and exact methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing, for each method, a matrix containing lower and upper
confidence limits for each value of x and n. Methods shown depend on the cc
parameter, which specifies whether the continuity correction is applied to
the SCAS and Jeffreys methods. The corresponding 'exact' method is
Clopper-Pearson/Garwood if cc == TRUE and mid-p if cc == FALSE.
</p>


<h3>Author(s)</h3>

<p>Pete Laud, <a href="mailto:p.j.laud@sheffield.ac.uk">p.j.laud@sheffield.ac.uk</a>
</p>

<hr>
<h2 id='scasci'>Skewness-corrected asymptotic score (&quot;SCAS&quot;) confidence intervals for
comparisons of independent binomial or Poisson rates.</h2><span id='topic+scasci'></span>

<h3>Description</h3>

<p>Wrapper function for the SCAS method. Score-based confidence intervals for
the rate (or risk) difference (&quot;RD&quot;) or ratio (&quot;RR&quot;) for independent binomial
or Poisson rates, or for odds ratio (&quot;OR&quot;, binomial only), or the single rate
(&quot;p&quot;). (This is the &quot;GNbc&quot; method from Laud &amp; Dane, developed from Gart &amp;
Nam, and generalised as &quot;SCAS&quot; in Laud 2017) including optional
continuity correction.  This function is vectorised in x1, x2, n1, and n2.
Vector inputs may also be combined into a single stratified analysis (e.g.
meta-analysis). This method assumes the contrast is constant across strata
(fixed effects).  For a 'random-effects' method use tdasci (or scoreci with
random = TRUE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scasci(
  x1,
  n1,
  x2 = NULL,
  n2 = NULL,
  distrib = "bin",
  contrast = "RD",
  level = 0.95,
  cc = FALSE,
  theta0 = NULL,
  precis = 6,
  plot = FALSE,
  hetplot = FALSE,
  xlim = NULL,
  ylim = NULL,
  plotmax = 100,
  stratified = FALSE,
  weighting = NULL,
  MNtol = 1e-08,
  wt = NULL,
  warn = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scasci_+3A_x1">x1</code>, <code id="scasci_+3A_x2">x2</code></td>
<td>
<p>Numeric vectors of numbers of events in group 1 &amp; group 2
respectively.</p>
</td></tr>
<tr><td><code id="scasci_+3A_n1">n1</code>, <code id="scasci_+3A_n2">n2</code></td>
<td>
<p>Numeric vectors of sample sizes (for binomial rates) or exposure
times (for Poisson rates) in each group.</p>
</td></tr>
<tr><td><code id="scasci_+3A_distrib">distrib</code></td>
<td>
<p>Character string indicating distribution assumed for the input
data: &quot;bin&quot; = binomial (default), &quot;poi&quot; = Poisson.</p>
</td></tr>
<tr><td><code id="scasci_+3A_contrast">contrast</code></td>
<td>
<p>Character string indicating the contrast of interest: &quot;RD&quot; =
rate difference (default), &quot;RR&quot; = rate ratio, &quot;OR&quot; = odds ratio.
contrast=&quot;p&quot; gives an interval for the single proportion or rate x1/n1.</p>
</td></tr>
<tr><td><code id="scasci_+3A_level">level</code></td>
<td>
<p>Number specifying confidence level (between 0 and 1, default
0.95).</p>
</td></tr>
<tr><td><code id="scasci_+3A_cc">cc</code></td>
<td>
<p>Number or logical (default FALSE) specifying (amount of) continuity
correction. Numeric value is taken as the gamma parameter in Laud 2017,
Appendix S2 (default 0.5 if cc = TRUE).
IMPORTANT NOTES:
1) This is a 'continuity correction' aimed at approximating strictly
conservative coverage, NOT for dealing with zero cell counts. Such
'sparse data adjustments' are not needed in the score method,
except to deal with double-zero cells for RD (&amp; double-100
binomial RD &amp; RR) with IVS/INV weights.
2) The continuity corrections provided here have not been fully tested for
stratified methods.</p>
</td></tr>
<tr><td><code id="scasci_+3A_theta0">theta0</code></td>
<td>
<p>Number to be used in a one-sided significance test (e.g.
non-inferiority margin). 1-sided p-value will be &lt;0.025 iff 2-sided 95% CI
excludes theta0. By default, a two-sided test against theta0 = 0 (for RD)
or 1 (for RR/OR) is also output.</p>
</td></tr>
<tr><td><code id="scasci_+3A_precis">precis</code></td>
<td>
<p>Number (default 6) specifying precision (i.e. number of decimal
places) to be used in optimisation subroutine for the confidence interval.</p>
</td></tr>
<tr><td><code id="scasci_+3A_plot">plot</code></td>
<td>
<p>Logical (default FALSE) indicating whether to output plot of the
score function</p>
</td></tr>
<tr><td><code id="scasci_+3A_hetplot">hetplot</code></td>
<td>
<p>Logical (default FALSE) indicating whether to output plots for
evaluating heterogeneity of stratified datasets.</p>
</td></tr>
<tr><td><code id="scasci_+3A_xlim">xlim</code></td>
<td>
<p>pair of values indicating range of values to be plotted.</p>
</td></tr>
<tr><td><code id="scasci_+3A_ylim">ylim</code></td>
<td>
<p>pair of values indicating range of values to be plotted.</p>
</td></tr>
<tr><td><code id="scasci_+3A_plotmax">plotmax</code></td>
<td>
<p>Numeric value indicating maximum value to be displayed on
x-axis of plots (useful for ratio contrasts which can be infinite).</p>
</td></tr>
<tr><td><code id="scasci_+3A_stratified">stratified</code></td>
<td>
<p>Logical (default FALSE) indicating whether to combine
vector inputs into a single stratified analysis.
IMPORTANT NOTE: The mechanism for stratified calculations is enabled for
contrast = &quot;p&quot;, but the performance of the resulting intervals has not
been fully evaluated.</p>
</td></tr>
<tr><td><code id="scasci_+3A_weighting">weighting</code></td>
<td>
<p>String indicating which weighting method to use if
stratified = &quot;TRUE&quot;:
&quot;IVS&quot; = Inverse Variance of Score (see Laud 2017 for details),
&quot;INV&quot; = Inverse Variance (bcf omitted, default for contrast = &quot;OR&quot;),
&quot;MH&quot; = Mantel-Haenszel (default for contrast = &quot;RD&quot; or &quot;RR&quot;),
&quot;MN&quot; = Miettinen-Nurminen iterative weights.
For CI consistent with a CMH test, select skew = FALSE and use
MH weighting for RD/RR and IVS for OR.</p>
</td></tr>
<tr><td><code id="scasci_+3A_mntol">MNtol</code></td>
<td>
<p>Numeric value indicating convergence tolerance to be used in
iteration with weighting = &quot;MN&quot;.</p>
</td></tr>
<tr><td><code id="scasci_+3A_wt">wt</code></td>
<td>
<p>Numeric vector containing (optional) user-specified weights.</p>
</td></tr>
<tr><td><code id="scasci_+3A_warn">warn</code></td>
<td>
<p>Logical (default TRUE) giving the option to suppress warnings.</p>
</td></tr>
<tr><td><code id="scasci_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components: </p>

<dl>
<dt>estimates</dt><dd><p>a matrix containing estimates of the rates in each group
and of the requested contrast, with its confidence interval</p>
</dd> <dt>pval</dt><dd><p>a
matrix containing details of the corresponding 2-sided significance test
against the null hypothesis that p_1 = p_2, and one-sided significance
tests against the null hypothesis that theta &gt;= or &lt;= theta0</p>
</dd>
<dt>call</dt><dd><p>details of the function call</p>
</dd> </dl>
<p> If stratified = TRUE, the
following outputs are added: </p>
 <dl>
<dt>Qtest</dt><dd><p>a vector of values
describing and testing heterogeneity</p>
</dd> <dt>weighting</dt><dd><p>a string indicating
the selected weighting method</p>
</dd> <dt>stratdata</dt><dd><p>a matrix containing stratum
estimates and weights</p>
</dd></dl>


<hr>
<h2 id='scaspci'>Skewness-corrected asymptotic score (&quot;SCAS&quot;) confidence intervals for
single binomial or Poisson rate using closed-form calculations.
This function is vectorised in x, n.</h2><span id='topic+scaspci'></span>

<h3>Description</h3>

<p>Skewness-corrected asymptotic score (&quot;SCAS&quot;) confidence intervals for
single binomial or Poisson rate using closed-form calculations.
This function is vectorised in x, n.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaspci(x, n, distrib = "bin", level = 0.95, cc = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaspci_+3A_x">x</code></td>
<td>
<p>Numeric vector of number of events.</p>
</td></tr>
<tr><td><code id="scaspci_+3A_n">n</code></td>
<td>
<p>Numeric vector of sample sizes (for binomial rates) or exposure
times (for Poisson rates).</p>
</td></tr>
<tr><td><code id="scaspci_+3A_distrib">distrib</code></td>
<td>
<p>Character string indicating distribution assumed for the input
data: &quot;bin&quot; = binomial (default), &quot;poi&quot; = Poisson.</p>
</td></tr>
<tr><td><code id="scaspci_+3A_level">level</code></td>
<td>
<p>Number specifying confidence level (between 0 and 1, default
0.95).</p>
</td></tr>
<tr><td><code id="scaspci_+3A_cc">cc</code></td>
<td>
<p>Number or logical (default FALSE) specifying (amount of) continuity
correction. Numeric value is taken as the gamma parameter in Laud 2017,
Appendix S2 (default 0.5 if cc = TRUE).
IMPORTANT NOTES:
1) This is a 'continuity correction' aimed at approximating strictly
conservative coverage, NOT for dealing with zero cell counts. Such
'sparse data adjustments' are not needed in the score method,
except to deal with double-zero cells for RD (&amp; double-100
binomial RD &amp; RR) with IVS/INV weights.
2) The continuity corrections provided here have not been fully tested for
stratified methods.</p>
</td></tr>
<tr><td><code id="scaspci_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='scoreci'>Score confidence intervals for comparisons of independent binomial or Poisson
rates.</h2><span id='topic+scoreci'></span>

<h3>Description</h3>

<p>Score-based confidence intervals for the rate (or risk) difference (&quot;RD&quot;) or
ratio (&quot;RR&quot;) for independent binomial or Poisson rates, or for odds ratio
(&quot;OR&quot;, binomial only). Including options for bias correction (from Miettinen
&amp; Nurminen), skewness correction (&quot;GNbc&quot; method from Laud &amp; Dane, developed
from Gart &amp; Nam, and generalised as &quot;SCAS&quot; in Laud 2017) and continuity
correction (for strictly conservative coverage).
Also includes score intervals for a single binomial proportion or Poisson
rate. Based on the Wilson score interval, when corrected for skewness,
coverage is almost identical to the mid-p method, or Clopper-Pearson
when also continuity-corrected.
Hypothesis tests for superiority or non-inferiority are provided using the
same score, to ensure consistency between test and CI.
This function is vectorised in x1, x2, n1, and n2.  Vector inputs may also be
combined into a single stratified analysis (e.g. meta-analysis), either using
fixed effects, or the more general random effects &quot;TDAS&quot; method, which
incorporates stratum variability using a t-distribution score (inspired by
Hartung-Knapp-Sidik-Jonkman).
For fixed-effects analysis of stratified datasets, with weighting = &quot;MH&quot; for
RD or RR, or weighting = &quot;IVS&quot; for OR, omitting the skewness correction
produces the CMH test, together with a coherent confidence interval for the
required contrast.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoreci(
  x1,
  n1,
  x2 = NULL,
  n2 = NULL,
  distrib = "bin",
  contrast = "RD",
  level = 0.95,
  skew = TRUE,
  simpleskew = FALSE,
  ORbias = TRUE,
  RRtang = NULL,
  bcf = TRUE,
  cc = FALSE,
  theta0 = NULL,
  precis = 6,
  plot = FALSE,
  plotmax = 100,
  hetplot = FALSE,
  xlim = NULL,
  ylim = NULL,
  stratified = FALSE,
  weighting = NULL,
  MNtol = 1e-08,
  wt = NULL,
  sda = NULL,
  fda = NULL,
  dropzeros = FALSE,
  tdas = NULL,
  random = FALSE,
  prediction = FALSE,
  warn = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoreci_+3A_x1">x1</code>, <code id="scoreci_+3A_x2">x2</code></td>
<td>
<p>Numeric vectors of numbers of events in group 1 &amp; group 2
respectively.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_n1">n1</code>, <code id="scoreci_+3A_n2">n2</code></td>
<td>
<p>Numeric vectors of sample sizes (for binomial rates) or exposure
times (for Poisson rates) in each group.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_distrib">distrib</code></td>
<td>
<p>Character string indicating distribution assumed for the input
data: &quot;bin&quot; = binomial (default), &quot;poi&quot; = Poisson.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_contrast">contrast</code></td>
<td>
<p>Character string indicating the contrast of interest: &quot;RD&quot; =
rate difference (default), &quot;RR&quot; = rate ratio, &quot;OR&quot; = odds ratio.
contrast=&quot;p&quot; gives an interval for the single proportion or rate x1/n1.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_level">level</code></td>
<td>
<p>Number specifying confidence level (between 0 and 1, default
0.95).</p>
</td></tr>
<tr><td><code id="scoreci_+3A_skew">skew</code></td>
<td>
<p>Logical (default TRUE) indicating whether to apply skewness
correction (for the SCAS method recommended in Laud 2017) or not (for
the Miettinen-Nurminen method).</p>
</td></tr>
<tr><td><code id="scoreci_+3A_simpleskew">simpleskew</code></td>
<td>
<p>Logical (default FALSE) indicating whether to use the
&quot;simplified&quot; skewness correction instead of the quadratic solution.
See Laud 2021 for details. NOTE: this version of the score is only
suitable for obtaining confidence limits, not p-values.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_orbias">ORbias</code></td>
<td>
<p>Logical (default is TRUE for contrast=&quot;OR&quot;, otherwise
NULL) indicating whether to apply additional bias correction for OR derived
from Gart 1985. (Corrigendum to Laud 2017, published May 2018).
Only applies if contrast is &quot;OR&quot;.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_rrtang">RRtang</code></td>
<td>
<p>Logical indicating whether to use Tang's score for RR:
Stheta = (p1hat - p2hat * theta) / p2d (see Tang 2020).
Default TRUE for stratified = TRUE, with weighting = &quot;IVS&quot; or &quot;INV&quot;.
Forced to FALSE for stratified = TRUE, with fixed weighting.
Experimental for distrib = &quot;poi&quot;.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_bcf">bcf</code></td>
<td>
<p>Logical (default TRUE) indicating whether to apply bias correction
in the score denominator. Applicable to distrib = &quot;bin&quot; only. (NB: bcf =
FALSE option is really only included for legacy validation against previous
published methods (i.e. Gart &amp; Nam, Mee, or standard Chi-squared test).
Ignored for contrast = &quot;p&quot;.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_cc">cc</code></td>
<td>
<p>Number or logical (default FALSE) specifying (amount of) continuity
correction. Numeric value is taken as the gamma parameter in Laud 2017,
Appendix S2 (default 0.5 if cc = TRUE).
IMPORTANT NOTES:
1) This is a 'continuity correction' aimed at approximating strictly
conservative coverage, NOT for dealing with zero cell counts. Such
'sparse data adjustments' are not needed in the score method,
except to deal with double-zero cells for RD (&amp; double-100
binomial RD &amp; RR) with IVS/INV weights.
2) The continuity corrections provided here have not been fully tested for
stratified methods.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_theta0">theta0</code></td>
<td>
<p>Number to be used in a one-sided significance test (e.g.
non-inferiority margin). 1-sided p-value will be &lt;0.025 iff 2-sided 95% CI
excludes theta0. If bcf = FALSE and skew = FALSE this gives a
Farrington-Manning test.
By default, a two-sided test against theta0 = 0 (for RD) or 1 (for RR/OR)
is also output: if bcf = FALSE and skew = FALSE this is the same as
Pearson's Chi-squared test.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_precis">precis</code></td>
<td>
<p>Number (default 6) specifying precision (i.e. number of decimal
places) to be used in optimisation subroutine for the confidence interval.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_plot">plot</code></td>
<td>
<p>Logical (default FALSE) indicating whether to output plot of the
score function</p>
</td></tr>
<tr><td><code id="scoreci_+3A_plotmax">plotmax</code></td>
<td>
<p>Numeric value indicating maximum value to be displayed on
x-axis of plots (useful for ratio contrasts which can be infinite).</p>
</td></tr>
<tr><td><code id="scoreci_+3A_hetplot">hetplot</code></td>
<td>
<p>Logical (default FALSE) indicating whether to output plots for
evaluating heterogeneity of stratified datasets.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_xlim">xlim</code></td>
<td>
<p>pair of values indicating range of values to be plotted.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_ylim">ylim</code></td>
<td>
<p>pair of values indicating range of values to be plotted.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_stratified">stratified</code></td>
<td>
<p>Logical (default FALSE) indicating whether to combine
vector inputs into a single stratified analysis.
IMPORTANT NOTE: The mechanism for stratified calculations is enabled for
contrast = &quot;p&quot;, but the performance of the resulting intervals has not
been fully evaluated.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_weighting">weighting</code></td>
<td>
<p>String indicating which weighting method to use if
stratified = &quot;TRUE&quot;:
&quot;IVS&quot; = Inverse Variance of Score (see Laud 2017 for details),
&quot;INV&quot; = Inverse Variance (bcf omitted, default for contrast = &quot;OR&quot;),
&quot;MH&quot; = Mantel-Haenszel (default for contrast = &quot;RD&quot; or &quot;RR&quot;),
&quot;MN&quot; = Miettinen-Nurminen iterative weights.
For CI consistent with a CMH test, select skew = FALSE and use
MH weighting for RD/RR and IVS for OR.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_mntol">MNtol</code></td>
<td>
<p>Numeric value indicating convergence tolerance to be used in
iteration with weighting = &quot;MN&quot;.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_wt">wt</code></td>
<td>
<p>Numeric vector containing (optional) user-specified weights.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_sda">sda</code></td>
<td>
<p>Sparse data adjustment to avoid zero variance when x1 + x2 = 0:
Only applied when stratified = TRUE.
Default 0.5 for RD with IVS/INV weights.
Not required for RR/OR, default is to remove double-zero strata
instead.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_fda">fda</code></td>
<td>
<p>Full data adjustment to avoid zero variance when x1 + x2 = n1 + n2:
Only applied when stratified = TRUE.
Default 0.5 for RD &amp; RR with IVS/INV weights.
Not required for OR, default is to remove affected strata.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_dropzeros">dropzeros</code></td>
<td>
<p>Logical (default FALSE) indicating whether to drop
uninformative strata for RR/OR, even when the choice of weights would allow
them to be retained for a fixed effects analysis.
Has no effect on estimates, just the heterogeneity test.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_tdas">tdas</code></td>
<td>
<p>(deprecated: parameter renamed to random)</p>
</td></tr>
<tr><td><code id="scoreci_+3A_random">random</code></td>
<td>
<p>Logical (default FALSE) indicating whether to perform random
effects meta-analysis for stratified data, using the t-distribution (TDAS)
method for stratified data (defined in Laud 2017).
NOTE: If random = TRUE, then skew = TRUE only affects the per-stratum
estimates.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_prediction">prediction</code></td>
<td>
<p>Logical (default FALSE) indicating whether to produce
a prediction interval (work in progress).</p>
</td></tr>
<tr><td><code id="scoreci_+3A_warn">warn</code></td>
<td>
<p>Logical (default TRUE) giving the option to suppress warnings.</p>
</td></tr>
<tr><td><code id="scoreci_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components: </p>

<dl>
<dt>estimates</dt><dd><p>a matrix containing estimates of the rates in each group
and of the requested contrast, with its confidence interval</p>
</dd> <dt>pval</dt><dd><p>a
matrix containing details of the corresponding 2-sided significance test
against the null hypothesis that p_1 = p_2, and one-sided significance
tests against the null hypothesis that theta &gt;= or &lt;= theta0</p>
</dd>
<dt>call</dt><dd><p>details of the function call</p>
</dd> </dl>
<p> If stratified = TRUE, the
following outputs are added: </p>
 <dl>
<dt>Qtest</dt><dd><p>a vector of values
describing and testing heterogeneity</p>
</dd> <dt>weighting</dt><dd><p>a string indicating
the selected weighting method</p>
</dd> <dt>stratdata</dt><dd><p>a matrix containing stratum
estimates and weights</p>
</dd></dl>



<h3>Author(s)</h3>

<p>Pete Laud, <a href="mailto:p.j.laud@sheffield.ac.uk">p.j.laud@sheffield.ac.uk</a>
</p>


<h3>References</h3>

<p>Laud PJ. Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2017; 16:334-348.
</p>
<p>Laud PJ. Corrigendum: Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2018; 17:290-293.
</p>
<p>Laud PJ, Dane A. Confidence intervals for the difference between
independent binomial proportions: comparison using a graphical approach and
moving averages. Pharmaceutical Statistics 2014; 13(5):294–308.
</p>
<p>Miettinen OS, Nurminen M. Comparative analysis of two rates. Statistics in
Medicine 1985; 4:213-226.
</p>
<p>Farrington CP, Manning G. Test statistics and sample size formulae for
comparative binomial trials with null hypothesis of non-zero risk
difference or non-unity relative risk. Statistics in Medicine 1990;
9(12):1447-1454.
</p>
<p>Gart JJ. Analysis of the common odds ratio: corrections for bias and
skewness. Bulletin of the International Statistical Institute 1985,
45th session, book 1, 175-176.
</p>
<p>Gart JJ, Nam Jm. Approximate interval estimation of the ratio of binomial
parameters: a review and corrections for skewness. Biometrics 1988;
44(2):323-338.
</p>
<p>Gart JJ, Nam Jm. Approximate interval estimation of the difference in
binomial parameters: correction for skewness and extension to multiple
tables. Biometrics 1990; 46(3):637-643.
</p>
<p>Tang Y. Score confidence intervals and sample sizes for stratified
comparisons of binomial proportions. Statistics in Medicine 2020;
39:3427–3457.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Binomial RD, SCAS method:
scoreci(
  x1 = c(12, 19, 5), n1 = c(16, 29, 56),
  x2 = c(1, 22, 0), n2 = c(16, 30, 29)
)

# Binomial RD, MN method:
scoreci(
  x1 = c(12, 19, 5), n1 = c(16, 29, 56),
  x2 = c(1, 22, 0), n2 = c(16, 30, 29), skew = FALSE
)

# Poisson RR, SCAS method:
scoreci(x1 = 5, n1 = 56, x2 = 0, n2 = 29, distrib = "poi", contrast = "RR")

# Poisson RR, MN method:
scoreci(
  x1 = 5, n1 = 56, x2 = 0, n2 = 29, distrib = "poi",
  contrast = "RR", skew = FALSE
)

# Binomial rate, SCAS method:
scoreci(x1 = c(5, 0), n1 = c(56, 29), contrast = "p")

# Binomial rate, Wilson score method:
scoreci(x1 = c(5, 0), n1 = c(56, 29), contrast = "p", skew = FALSE)

# Poisson rate, SCAS method:
scoreci(x1 = c(5, 0), n1 = c(56, 29), distrib = "poi", contrast = "p")

# Stratified example, using data from Hartung &amp; Knapp:
scoreci(
  x1 = c(15, 12, 29, 42, 14, 44, 14, 29, 10, 17, 38, 19, 21),
  x2 = c(9, 1, 18, 31, 6, 17, 7, 23, 3, 6, 12, 22, 19),
  n1 = c(16, 16, 34, 56, 22, 54, 17, 58, 14, 26, 44, 29, 38),
  n2 = c(16, 16, 34, 56, 22, 55, 15, 58, 15, 27, 45, 30, 38),
  stratified = TRUE
)

# TDAS example, using data from Hartung &amp; Knapp:
scoreci(
  x1 = c(15, 12, 29, 42, 14, 44, 14, 29, 10, 17, 38, 19, 21),
  x2 = c(9, 1, 18, 31, 6, 17, 7, 23, 3, 6, 12, 22, 19),
  n1 = c(16, 16, 34, 56, 22, 54, 17, 58, 14, 26, 44, 29, 38),
  n2 = c(16, 16, 34, 56, 22, 55, 15, 58, 15, 27, 45, 30, 38),
  stratified = TRUE, random = TRUE
)

# Stratified example, with extremely rare instance of non-calculable skewness
# correction seen on plot of score function:
scoreci(
  x1 = c(1, 16), n1 = c(20, 40), x2 = c(0, 139), n2 = c(80, 160),
  contrast = "RD", skew = TRUE, simpleskew = FALSE,
  distrib = "bin", stratified = TRUE, plot = TRUE, weighting = "IVS"
)

</code></pre>

<hr>
<h2 id='tdasci'>t-distribution asymptotic score (&quot;TDAS&quot;) confidence intervals for
comparisons of independent binomial or Poisson rates.</h2><span id='topic+tdasci'></span>

<h3>Description</h3>

<p>Wrapper function for the TDAS method. Score-based stratified confidence
intervals for the rate (or risk) difference (&quot;RD&quot;) or ratio (&quot;RR&quot;) for
independent binomial or Poisson rates, or for odds ratio (&quot;OR&quot;, binomial
only), or for prevalence or incidence rate (&quot;p&quot;). This function combines
vector inputs into a single stratified random effects analysis
(e.g. meta-analysis), incorporating any stratum variability into the
confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdasci(
  x1,
  n1,
  x2 = NULL,
  n2 = NULL,
  distrib = "bin",
  contrast = "RD",
  level = 0.95,
  cc = FALSE,
  theta0 = NULL,
  precis = 6,
  plot = FALSE,
  hetplot = FALSE,
  plotmax = 100,
  xlim = NULL,
  ylim = NULL,
  weighting = NULL,
  MNtol = 1e-08,
  wt = NULL,
  skew = TRUE,
  prediction = FALSE,
  warn = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tdasci_+3A_x1">x1</code>, <code id="tdasci_+3A_x2">x2</code></td>
<td>
<p>Numeric vectors of numbers of events in group 1 &amp; group 2
respectively.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_n1">n1</code>, <code id="tdasci_+3A_n2">n2</code></td>
<td>
<p>Numeric vectors of sample sizes (for binomial rates) or exposure
times (for Poisson rates) in each group.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_distrib">distrib</code></td>
<td>
<p>Character string indicating distribution assumed for the input
data: &quot;bin&quot; = binomial (default), &quot;poi&quot; = Poisson.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_contrast">contrast</code></td>
<td>
<p>Character string indicating the contrast of interest: &quot;RD&quot; =
rate difference (default), &quot;RR&quot; = rate ratio, &quot;OR&quot; = odds ratio.
contrast=&quot;p&quot; gives an interval for the single proportion or rate x1/n1.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_level">level</code></td>
<td>
<p>Number specifying confidence level (between 0 and 1, default
0.95).</p>
</td></tr>
<tr><td><code id="tdasci_+3A_cc">cc</code></td>
<td>
<p>Number or logical (default FALSE) specifying (amount of) continuity
correction. Numeric value is taken as the gamma parameter in Laud 2017,
Appendix S2 (default 0.5 if cc = TRUE).
IMPORTANT NOTES:
1) This is a 'continuity correction' aimed at approximating strictly
conservative coverage, NOT for dealing with zero cell counts. Such
'sparse data adjustments' are not needed in the score method,
except to deal with double-zero cells for RD (&amp; double-100
binomial RD &amp; RR) with IVS/INV weights.
2) The continuity corrections provided here have not been fully tested for
stratified methods.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_theta0">theta0</code></td>
<td>
<p>Number to be used in a one-sided significance test (e.g.
non-inferiority margin). 1-sided p-value will be &lt;0.025 iff 2-sided 95% CI
excludes theta0. By default, a two-sided test against theta0 = 0 (for RD)
or 1 (for RR/OR) is also output.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_precis">precis</code></td>
<td>
<p>Number (default 6) specifying precision (i.e. number of decimal
places) to be used in optimisation subroutine for the confidence interval.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_plot">plot</code></td>
<td>
<p>Logical (default FALSE) indicating whether to output plot of the
score function</p>
</td></tr>
<tr><td><code id="tdasci_+3A_hetplot">hetplot</code></td>
<td>
<p>Logical (default FALSE) indicating whether to output plots for
evaluating heterogeneity of stratified datasets.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_plotmax">plotmax</code></td>
<td>
<p>Numeric value indicating maximum value to be displayed on
x-axis of plots (useful for ratio contrasts which can be infinite).</p>
</td></tr>
<tr><td><code id="tdasci_+3A_xlim">xlim</code></td>
<td>
<p>pair of values indicating range of values to be plotted.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_ylim">ylim</code></td>
<td>
<p>pair of values indicating range of values to be plotted.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_weighting">weighting</code></td>
<td>
<p>String indicating which weighting method to use if
stratified = &quot;TRUE&quot;:
&quot;IVS&quot; = Inverse Variance of Score (see Laud 2017 for details),
&quot;INV&quot; = Inverse Variance (bcf omitted, default for contrast = &quot;OR&quot;),
&quot;MH&quot; = Mantel-Haenszel (default for contrast = &quot;RD&quot; or &quot;RR&quot;),
&quot;MN&quot; = Miettinen-Nurminen iterative weights.
For CI consistent with a CMH test, select skew = FALSE and use
MH weighting for RD/RR and IVS for OR.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_mntol">MNtol</code></td>
<td>
<p>Numeric value indicating convergence tolerance to be used in
iteration with weighting = &quot;MN&quot;.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_wt">wt</code></td>
<td>
<p>Numeric vector containing (optional) user-specified weights.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_skew">skew</code></td>
<td>
<p>Logical (default TRUE) indicating whether to apply skewness
correction (for the SCAS method recommended in Laud 2017) or not (for
the Miettinen-Nurminen method) to the per-stratum estimates provided
in the output. Has no effect on the TDAS interval itself.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_prediction">prediction</code></td>
<td>
<p>Logical (default FALSE) indicating whether to produce
a prediction interval (work in progress).</p>
</td></tr>
<tr><td><code id="tdasci_+3A_warn">warn</code></td>
<td>
<p>Logical (default TRUE) giving the option to suppress warnings.</p>
</td></tr>
<tr><td><code id="tdasci_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components: </p>

<dl>
<dt>estimates</dt><dd><p>a matrix containing estimates of the rates in each group
and of the requested contrast, with its confidence interval</p>
</dd> <dt>pval</dt><dd><p>a
matrix containing details of the corresponding 2-sided significance test
against the null hypothesis that p_1 = p_2, and one-sided significance
tests against the null hypothesis that theta &gt;= or &lt;= theta0</p>
</dd>
<dt>Qtest</dt><dd><p>a vector of values
describing and testing heterogeneity</p>
</dd> <dt>weighting</dt><dd><p>a string indicating
the selected weighting method</p>
</dd> <dt>stratdata</dt><dd><p>a matrix containing stratum
estimates and weights</p>
</dd>
<dt>call</dt><dd><p>details of the function call</p>
</dd></dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
