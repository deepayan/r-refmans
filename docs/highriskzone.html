<!DOCTYPE html><html lang="en"><head><title>Help for package highriskzone</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {highriskzone}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#highriskzone-package'><p>Determining high-risk zones by using spatial point process methodology</p></a></li>
<li><a href='#bootcor'><p>Bootstrap correction to obtain desired failure probability</p></a></li>
<li><a href='#bootcor_restr'><p>Bootstrap correction to obtain desired failure probability</p></a></li>
<li><a href='#bootcorr'><p>Bootstrap correction to obtain desired failure probability</p></a></li>
<li><a href='#check_det_hrz_input'><p>Checks the arguments of det_hrz</p></a></li>
<li><a href='#check_det_hrz_restr_input'><p>Checks the arguments of det_hrz_restr</p></a></li>
<li><a href='#craterA'><p>Bomb crater Point Pattern</p></a></li>
<li><a href='#craterB'><p>Bomb crater Point Pattern</p></a></li>
<li><a href='#det_alpha'><p>calculation of alpha (failure probability), when having the threshold c</p></a></li>
<li><a href='#det_alpha_eval_ar'><p>Determination of failure probability within evaluation area</p></a></li>
<li><a href='#det_area'><p>Calculation of the area of the high-risk zone.</p></a></li>
<li><a href='#det_area_hole'><p>Calculation of the area of the high-risk zone.</p></a></li>
<li><a href='#det_guard_width'><p>Estimation of width of a guard region given an estimated highriskzone</p></a></li>
<li><a href='#det_hrz'><p>Determination of the high-risk zone.</p></a></li>
<li><a href='#det_hrz_eval_ar'><p>Determination of high-risk zone on smaller area of interest (evaluation area) than observation area.</p></a></li>
<li><a href='#det_hrz_restr'><p>Determination of the high-risk zone.</p></a></li>
<li><a href='#det_nnarea'><p>Determination of the area of a high-risk zone using the nearest-neighbour distance.</p></a></li>
<li><a href='#det_nsintens'><p>Determination of the intensity for the Neyman Scott simulation.</p></a></li>
<li><a href='#det_nsintens_restr'><p>Determination of the intensity for the Neyman-Scott simulation.</p></a></li>
<li><a href='#det_radius'><p>Determination of the nearest-neighbour distance which results in a high-risk zone with desired area</p></a></li>
<li><a href='#det_threshold'><p>Calculation of the threshold c, when having failure probability alpha.</p></a></li>
<li><a href='#det_threshold_eval_ar'><p>Determination of necessary threshold to keep alpha in evaluation area</p></a></li>
<li><a href='#det_thresholdfromarea'><p>Determination of alpha and the threshold c which results</p>
in a high-risk zone with desired area.</a></li>
<li><a href='#det_thresholdfromarea_rest'><p>Determination of alpha and the threshold c which results</p>
in a high-risk zone with desired area if a hole is present.</a></li>
<li><a href='#est_intens'><p>Estimates the intensity of the point pattern.</p></a></li>
<li><a href='#est_intens_spde'><p>Estimates the intensity of the point pattern by using the SPDE method from r-INLA.</p></a></li>
<li><a href='#est_intens_weight'><p>Estimates the intensity of the point pattern.</p></a></li>
<li><a href='#eval_hrz'><p>Evaluation of the high-risk zone.</p></a></li>
<li><a href='#eval_method'><p>Evaluation of the procedures determining the high-risk zone.</p></a></li>
<li><a href='#plot.bootcorr'><p>Visualize the bootstrap correction for a high-risk zone.</p></a></li>
<li><a href='#plot.highriskzone'><p>Plot a high-risk zone</p></a></li>
<li><a href='#plot.hrzeval'><p>Visualize the evaluation of a high-risk zone.</p></a></li>
<li><a href='#print.bootcorr'><p>Print Brief Details of a bootstrap correction for a high-risk zone</p></a></li>
<li><a href='#print.highriskzone'><p>Print Brief Details of a high-risk zone</p></a></li>
<li><a href='#print.hrzeval'><p>Print Brief Details of an evaluation of a high-risk zone</p></a></li>
<li><a href='#read_pppdata'><p>Read data, so it can be used for high-risk zone methodology.</p></a></li>
<li><a href='#sim_intens'><p>Simulation on given intensity</p></a></li>
<li><a href='#sim_nsppp'><p>Generation of a realisation of a Neyman-Scott process</p></a></li>
<li><a href='#sim_nsprocess'><p>Simulation of the Neyman-Scott process.</p></a></li>
<li><a href='#summary.bootcorr'><p>Summary of a the bootstrap correction for a high-risk zone</p></a></li>
<li><a href='#summary.highriskzone'><p>Summary of a high-risk zone</p></a></li>
<li><a href='#summary.hrzeval'><p>Summary of a the evaluation of a high-risk zone</p></a></li>
<li><a href='#thin'><p>Thinning of the observations (for evaluating the method)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Determining and Evaluating High-Risk Zones</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-29</td>
</tr>
<tr>
<td>Author:</td>
<td>Heidi Seibold &lt;Heidi.Seibold@uzh.ch&gt;, Monia Mahling
    &lt;monia.mahling@stat.uni-muenchen.de&gt;, Sebastian Linne
    &lt;Sebastian.Linne@campus.lmu.de&gt;, Felix Guenther
    &lt;felix.guenther@stat.uni-muenchen.de&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rickmer Schulte &lt;R.Schulte@campus.lmu.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>fields</td>
</tr>
<tr>
<td>Imports:</td>
<td>spatstat (&ge; 1.54-0), methods, stats, utils, mvtnorm, ks,
deldir, Matrix, maps, spatstat.random, spatstat.geom,
spatstat.explore, splancs, polyclip</td>
</tr>
<tr>
<td>Suggests:</td>
<td>INLA</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://inla.r-inla-download.org/R/stable/">https://inla.r-inla-download.org/R/stable/</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for determining and evaluating high-risk zones and
    simulating and thinning point process data, as described in 'Determining
    high risk zones using point process methodology - Realization by building
    an R package' Seibold (2012) <a href="http://highriskzone.r-forge.r-project.org/Bachelorarbeit.pdf">http://highriskzone.r-forge.r-project.org/Bachelorarbeit.pdf</a> 
    and 'Determining high-risk zones for unexploded World War II bombs by using point 
    process methodology', Mahling et al. (2013) &lt;<a href="https://doi.org/10.1111%2Fj.1467-9876.2012.01055.x">doi:10.1111/j.1467-9876.2012.01055.x</a>&gt;.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Repository/R-Forge/Project:</td>
<td>highriskzone</td>
</tr>
<tr>
<td>Repository/R-Forge/Revision:</td>
<td>92</td>
</tr>
<tr>
<td>Repository/R-Forge/DateTimeStamp:</td>
<td>2018-07-11 12:15:12</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-29 14:30:05 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-29 13:12:22 UTC; Rickmer</td>
</tr>
</table>
<hr>
<h2 id='highriskzone-package'>Determining high-risk zones by using spatial point process methodology</h2><span id='topic+highriskzone-package'></span><span id='topic+package-highriskzone'></span>

<h3>Description</h3>

<p>The package highriskzone provides tools to determine and evaluate high-risk zones of
unobserved events by using point process methodology.
</p>


<h3>Author(s)</h3>

<p>Heidi Seibold <a href="mailto:Heidi.Seibold@campus.lmu.de">Heidi.Seibold@campus.lmu.de</a>,
Monia Mahling <a href="mailto:monia.mahling@stat.uni-muenchen.de">monia.mahling@stat.uni-muenchen.de</a>
Sebastian Linne <a href="mailto:Sebastian.Linne@campus.lmu.de">Sebastian.Linne@campus.lmu.de</a>
Felix Guenther <a href="mailto:felix.guenther@stat.uni-muenchen.de">felix.guenther@stat.uni-muenchen.de</a>
Maintainer: Felix Guenther <a href="mailto:felix.guenther@stat.uni-muenchen.de">felix.guenther@stat.uni-muenchen.de</a>
</p>


<h3>References</h3>

<p>Monia Mahling, Michael Hoehle &amp; Helmut Kuechenhoff (2013),
<em>Determining high-risk zones for unexploded World War II bombs by using point process methodology.</em>
Journal of the Royal Statistical Society, Series C 62(2), 181-199. <br />
</p>
<p>Monia Mahling (2013),
<em>Determining high-risk zones by using spatial point process methodology.</em>
Ph.D. thesis, Cuvillier Verlag Goettingen,
available online: http://edoc.ub.uni-muenchen.de/15886/<br />
</p>
<p>Heidi Seibold (2012), <em>Determining high risk zones using point process methodology 
- Realization by building an R package.</em> Bachelor Thesis, Ludwig Maximilian University of Munich.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.html#topic+spatstat-package">spatstat-package</a></code>
</p>

<hr>
<h2 id='bootcor'>Bootstrap correction to obtain desired failure probability</h2><span id='topic+bootcor'></span>

<h3>Description</h3>

<p>Simulation-based iterative procedure to correct for possible bias with respect to the
failure probability alpha
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootcor(
  ppdata,
  cutoff,
  numit = 1000,
  tol = 0.02,
  nxprob = 0.1,
  intens = NULL,
  covmatrix = NULL,
  simulate = "intens",
  radiusClust = NULL,
  clustering = 5,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootcor_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td></tr>
<tr><td><code id="bootcor_+3A_cutoff">cutoff</code></td>
<td>
<p>Desired failure probability alpha, which is the probability of having
unobserved events outside the high-risk zone.</p>
</td></tr>
<tr><td><code id="bootcor_+3A_numit">numit</code></td>
<td>
<p>Number of iterations to perform (per tested value for cutoff). Default value is 1000.</p>
</td></tr>
<tr><td><code id="bootcor_+3A_tol">tol</code></td>
<td>
<p>Tolerance: acceptable difference between the desired failure probability and the fraction of
high-risk zones not covering all events. Default value is 0.02.</p>
</td></tr>
<tr><td><code id="bootcor_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td></tr>
<tr><td><code id="bootcor_+3A_intens">intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class &quot;im&quot;,
see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>). If not given,
it will be estimated.</p>
</td></tr>
<tr><td><code id="bootcor_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only meaningful
if no intensity is given. If not given, it will be estimated.</p>
</td></tr>
<tr><td><code id="bootcor_+3A_simulate">simulate</code></td>
<td>
<p>The type of simulation, can be one of <code>"thinning", "intens"</code> or <code>"clintens"</code></p>
</td></tr>
<tr><td><code id="bootcor_+3A_radiusclust">radiusClust</code></td>
<td>
<p>(optional) radius of the circles around the parent points in which the cluster
points are located. Only used for <code>simulate = "clintens"</code>.</p>
</td></tr>
<tr><td><code id="bootcor_+3A_clustering">clustering</code></td>
<td>
<p>a value &gt;= 1 which describes the amount of clustering; the
adjusted estimated intensity of the observed pattern is divided by
this value; it also is the parameter of the Poisson distribution
for the number of points per cluster. Only used for <code>simulate = "clintens"</code>.</p>
</td></tr>
<tr><td><code id="bootcor_+3A_verbose">verbose</code></td>
<td>
<p>logical. Should information on tested values/progress be printed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a desired failure probability alpha, the corresponding parameter which is to use
when determining a high-risk zone is found in an iterative procedure. The simulation procedure
is the same as in <code><a href="#topic+eval_method">eval_method</a></code>. In every iteration,
the number of high-risk zones with at least one unobserved event located outside is
compared with the desired failure probability. If necessary, the value of <code>cutoff</code> is
increased or decreased. The final value <code>alphastar</code> can than be used in
<code><a href="#topic+det_hrz">det_hrz</a></code>.
</p>
<p>If there are restriction areas in the observation window, use <code><a href="#topic+bootcor_restr">bootcor_restr</a></code>
instead.
</p>


<h3>Value</h3>

<p>An object of class bootcorr, which consists of a list of the final value for alpha (<code>alphastar</code>)
and a data.frame <code>course</code> containing information on the simulation course, e.g. the tested values.
</p>


<h3>References</h3>

<p>Monia Mahling, Michael H?hle &amp; Helmut K?chenhoff (2013),
<em>Determining high-risk zones for unexploded World War II bombs by using point process methodology.</em>
Journal of the Royal Statistical Society, Series C 62(2), 181-199.
</p>
<p>Monia Mahling (2013),
<em>Determining high-risk zones by using spatial point process methodology.</em>
Ph.D. thesis, Cuvillier Verlag G?ttingen,
available online: http://edoc.ub.uni-muenchen.de/15886/
Chapter 6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+det_hrz">det_hrz</a></code>, <code><a href="#topic+eval_method">eval_method</a></code>, <code><a href="#topic+bootcor_restr">bootcor_restr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(craterB)
set.seed(4321)

bc &lt;- bootcor(ppdata=craterB, cutoff=0.2, numit=100, tol=0.02, nxprob=0.1)
bc
summary(bc)
plot(bc)


hrzbc &lt;- det_hrz(craterB, type = "intens", criterion = "indirect", 
cutoff = bc$alphastar, nxprob = 0.1)

## End(Not run)
</code></pre>

<hr>
<h2 id='bootcor_restr'>Bootstrap correction to obtain desired failure probability</h2><span id='topic+bootcor_restr'></span>

<h3>Description</h3>

<p>Simulation-based iterative procedure to correct for possible bias with respect to the
failure probability alpha
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootcor_restr(
  ppdata,
  cutoff,
  numit = 100,
  tol = 0.001,
  nxprob = 0.1,
  hole = NULL,
  obsprobimage = NULL,
  intens = NULL,
  covmatrix = NULL,
  simulate = "intens",
  radiusClust = NULL,
  clustering = 5,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootcor_restr_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_cutoff">cutoff</code></td>
<td>
<p>Desired failure probability alpha, which is the probability of having
unobserved events outside the high-risk zone.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_numit">numit</code></td>
<td>
<p>Number of iterations to perform (per tested value for cutoff). Default value is 1000.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_tol">tol</code></td>
<td>
<p>Tolerance: acceptable difference between the desired failure probability and the fraction of
high-risk zones not covering all events. Default value is 0.02.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_hole">hole</code></td>
<td>
<p>(optional) an object of class <code>owin</code> representing a region inside the observation window of
the <code>ppdata</code> where no observations were possible.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_obsprobimage">obsprobimage</code></td>
<td>
<p>(optional) an object of class <code>im</code> giving the observation probabilities inside the
observation window. Ranges of the coordinates must equal those of <code>ppdata</code>.
Only used if <code>obsprobs</code> is not given.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_intens">intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class &quot;im&quot;,
see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>). If not given,
it will be estimated.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only meaningful
if no intensity is given. If not given, it will be estimated.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_simulate">simulate</code></td>
<td>
<p>The type of simulation, can be one of <code>"thinning", "intens"</code> or <code>"clintens"</code></p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_radiusclust">radiusClust</code></td>
<td>
<p>(optional) radius of the circles around the parent points in which the cluster
points are located. Only used for <code>simulate = "clintens"</code>.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_clustering">clustering</code></td>
<td>
<p>a value &gt;= 1 which describes the amount of clustering; the
adjusted estimated intensity of the observed pattern is divided by
this value; it also is the parameter of the Poisson distribution
for the number of points per cluster. Only used for <code>simulate = "clintens"</code>.</p>
</td></tr>
<tr><td><code id="bootcor_restr_+3A_verbose">verbose</code></td>
<td>
<p>logical. Should information on tested values/progress be printed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a desired failure probability alpha, the corresponding parameter which is to use
when determining a high-risk zone is found in an iterative procedure. The simulation procedure
is the same as in <code><a href="#topic+eval_method">eval_method</a></code>. In every iteration,
the number of high-risk zones with at least one unobserved event located outside is
compared with the desired failure probability. If necessary, the value of <code>cutoff</code> is
increased or decreased. The final value <code>alphastar</code> can than be used in
<code><a href="#topic+det_hrz">det_hrz</a></code>.
</p>
<p>The function offers the possibility to take into account so-called restriction areas. This is relevant in
situations where the observed point pattern <code>ppdata</code> is incomplete. If it is known that no observations
can be made in a certain area (for example because of water expanses),
this can be accounted for by integrating a hole in the observation window.
The shape and location of the hole is given by <code>hole</code>. Holes are
part of the resulting high-risk zone.
Another approach consists in weighting the observed events with their reciprocal observation probability when
estimating the intensity. To do so, the observation probability can be specified by using
<code>obsprobsimage</code> (an image of the observation probability). Note that the
observation probability may vary in space.
</p>
<p>For further information, see Mahling (2013), Appendix A (References).
</p>
<p>If there are no restriction areas in the observation window, <code><a href="#topic+bootcor">bootcor</a></code>
can be used instead.
</p>


<h3>Value</h3>

<p>An object of class bootcorr, which consists of a list of the final value for alpha (<code>alphastar</code>)
and a data.frame <code>course</code> containing information on the simulation course, e.g. the tested values.
</p>


<h3>References</h3>

<p>Monia Mahling, Michael H?hle &amp; Helmut K?chenhoff (2013),
<em>Determining high-risk zones for unexploded World War II bombs by using point process methodology.</em>
Journal of the Royal Statistical Society, Series C 62(2), 181-199.
</p>
<p>Monia Mahling (2013),
<em>Determining high-risk zones by using spatial point process methodology.</em>
Ph.D. thesis, Cuvillier Verlag G?ttingen,
available online: http://edoc.ub.uni-muenchen.de/15886/
Chapter 6 and Appendix A
</p>


<h3>See Also</h3>

<p><code><a href="#topic+det_hrz">det_hrz</a></code>, <code><a href="#topic+eval_method">eval_method</a></code>, <code><a href="#topic+bootcor">bootcor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(craterA)
set.seed(4321)
# define restriction area
restrwin &lt;- spatstat.geom::owin(xrange = craterA$window$xrange, 
                          yrange = craterA$window$yrange,
                          poly = list(x = c(1500, 1500, 2000, 2000), 
                                      y = c(2000, 1500, 1500, 2000)))

# create image of observation probability (30% inside restriction area)
wim &lt;- spatstat.geom::as.im(craterA$window, value = 1)
rim &lt;- spatstat.geom::as.im(restrwin, xy = list(x = wim$xcol, y = wim$yrow))
rim$v[is.na(rim$v)] &lt;- 0
oim1 &lt;- spatstat.geom::eval.im(wim - 0.7 * rim)

## Not run: 
# perform bootstrap correction
bc1 &lt;- bootcor_restr(ppdata=craterA, cutoff=0.4, numit=100, tol=0.02, obsprobimage=oim1, nxprob=0.1)
bc1
summary(bc1)
plot(bc1)

# determine high-risk zone by weighting the observations
hrzi1 &lt;- det_hrz_restr(ppdata=craterA, type = "intens", criterion = "indirect",
 cutoff = bc1$alphastar, hole=NULL, obsprobs=NULL, obsprobimage=oim1, nxprob = 0.1)

# perform bootstrap correction
set.seed(4321)
bc2 &lt;- bootcor_restr(ppdata=craterA, cutoff=0.4, numit=100, tol=0.02, hole=restrwin, nxprob=0.1)
bc2
summary(bc2)
plot(bc2)

# determine high-risk zone by accounting for a hole
hrzi2 &lt;- det_hrz_restr(ppdata=craterA, type = "intens", criterion = "indirect",
 cutoff = bc2$alphastar, hole=restrwin, obsprobs=NULL, obsprobimage=NULL, nxprob = 0.1)

## End(Not run)
</code></pre>

<hr>
<h2 id='bootcorr'>Bootstrap correction to obtain desired failure probability</h2><span id='topic+bootcorr'></span>

<h3>Description</h3>

<p>Simulation-based iterative procedure to correct for possible bias with respect to the
failure probability alpha
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootcorr(
  ppdata,
  cutoff,
  numit = 1000,
  tol = 0.02,
  nxprob = 0.1,
  intens = NULL,
  covmatrix = NULL,
  simulate = "intens",
  radiusClust = NULL,
  clustering = 5,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootcorr_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td></tr>
<tr><td><code id="bootcorr_+3A_cutoff">cutoff</code></td>
<td>
<p>Desired failure probability alpha, which is the probability of having
unobserved events outside the high-risk zone.</p>
</td></tr>
<tr><td><code id="bootcorr_+3A_numit">numit</code></td>
<td>
<p>Number of iterations to perform (per tested value for cutoff). Default value is 1000.</p>
</td></tr>
<tr><td><code id="bootcorr_+3A_tol">tol</code></td>
<td>
<p>Tolerance: acceptable difference between the desired failure probability and the fraction of
high-risk zones not covering all events. Default value is 0.02.</p>
</td></tr>
<tr><td><code id="bootcorr_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td></tr>
<tr><td><code id="bootcorr_+3A_intens">intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class &quot;im&quot;,
see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>). If not given,
it will be estimated.</p>
</td></tr>
<tr><td><code id="bootcorr_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only meaningful
if no intensity is given. If not given, it will be estimated.</p>
</td></tr>
<tr><td><code id="bootcorr_+3A_simulate">simulate</code></td>
<td>
<p>The type of simulation, can be one of <code>"thinning", "intens"</code> or <code>"clintens"</code></p>
</td></tr>
<tr><td><code id="bootcorr_+3A_radiusclust">radiusClust</code></td>
<td>
<p>(optional) radius of the circles around the parent points in which the cluster
points are located. Only used for <code>simulate = "clintens"</code>.</p>
</td></tr>
<tr><td><code id="bootcorr_+3A_clustering">clustering</code></td>
<td>
<p>a value &gt;= 1 which describes the amount of clustering; the
adjusted estimated intensity of the observed pattern is divided by
this value; it also is the parameter of the Poisson distribution
for the number of points per cluster. Only used for <code>simulate = "clintens"</code>.</p>
</td></tr>
<tr><td><code id="bootcorr_+3A_verbose">verbose</code></td>
<td>
<p>logical. Should information on tested values/progress be printed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a desired failure probability alpha, the corresponding parameter which is to use
when determining a high-risk zone is found in an iterative procedure. The simulation procedure
is the same as in <code><a href="#topic+eval_method">eval_method</a></code>. In every iteration,
the number of high-risk zones with at least one unobserved event located outside is
compared with the desired failure probability. If necessary, the value of <code>cutoff</code> is
increased or decreased. The final value <code>alphastar</code> can than be used in
<code><a href="#topic+det_hrz">det_hrz</a></code>.
</p>
<p>If there are restriction areas in the observation window, use <code><a href="#topic+bootcor_restr">bootcor_restr</a></code>
instead.
</p>


<h3>Value</h3>

<p>An object of class bootcorr, which consists of a list of the final value for alpha (<code>alphastar</code>)
and a data.frame <code>course</code> containing information on the simulation course, e.g. the tested values.
</p>


<h3>References</h3>

<p>Monia Mahling, Michael H?hle &amp; Helmut K?chenhoff (2013),
<em>Determining high-risk zones for unexploded World War II bombs by using point process methodology.</em>
Journal of the Royal Statistical Society, Series C 62(2), 181-199.
</p>
<p>Monia Mahling (2013),
<em>Determining high-risk zones by using spatial point process methodology.</em>
Ph.D. thesis, Cuvillier Verlag G?ttingen,
available online: http://edoc.ub.uni-muenchen.de/15886/
Chapter 6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+det_hrz">det_hrz</a></code>, <code><a href="#topic+eval_method">eval_method</a></code>, <code><a href="#topic+bootcor_restr">bootcor_restr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(craterB)
set.seed(4321)

bc &lt;- bootcor(ppdata=craterB, cutoff=0.2, numit=100, tol=0.02, nxprob=0.1)
bc
summary(bc)
plot(bc)


hrzbc &lt;- det_hrz(craterB, type = "intens", criterion = "indirect", 
cutoff = bc$alphastar, nxprob = 0.1)

## End(Not run)
</code></pre>

<hr>
<h2 id='check_det_hrz_input'>Checks the arguments of det_hrz</h2><span id='topic+check_det_hrz_input'></span>

<h3>Description</h3>

<p>For each argument it is checked if it is of a correct value or class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_det_hrz_input(
  ppdata,
  type,
  criterion,
  cutoff,
  distancemap,
  intens,
  nxprob,
  covmatrix
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_det_hrz_input_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td></tr>
<tr><td><code id="check_det_hrz_input_+3A_type">type</code></td>
<td>
<p>Method to use, can be one of <code>"dist"</code> (method of fixed radius or quantile-based method), or
<code>"intens"</code> (intensity-based method)</p>
</td></tr>
<tr><td><code id="check_det_hrz_input_+3A_criterion">criterion</code></td>
<td>
<p>criterion to limit the high-risk zone, can be one of 
<code>"area"</code> (giving size of hrz), <code>"indirect"</code> (giving quantile/alpha depending on type),
or <code>"direct"</code> (giving radius/threshold c depending on type)</p>
</td></tr>
<tr><td><code id="check_det_hrz_input_+3A_cutoff">cutoff</code></td>
<td>
<p>Value of criterion (area, radius, quantile, alpha or threshold). 
Depending on criterion and type: 
If criterion = &quot;direct&quot; and type = &quot;intens&quot;, cutoff is the maximum intensity of unexploded bombs
outside the risk zone. If type = &quot;dist&quot; instead, cutoff is the radius of the circle around each exploded bomb.
&quot;If criterion = &quot;indirect&quot;, cutoff is the quantile for the quantile-based method and the failure 
probability alpha for the intensity-base method. If criterion = &quot;area&quot;, cutoff is the area the high-risk zone should
have.</p>
</td></tr>
<tr><td><code id="check_det_hrz_input_+3A_distancemap">distancemap</code></td>
<td>
<p>(optional) distance map: distance of every pixel to the nearest observation 
of the point pattern; only needed for <code>type="dist"</code>. If not given, 
it will be computed by <code><a href="spatstat.geom.html#topic+distmap">distmap</a></code>.</p>
</td></tr>
<tr><td><code id="check_det_hrz_input_+3A_intens">intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class &quot;im&quot;), 
only needed for type=&quot;intens&quot;. If not given,
it will be estimated using <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>.</p>
</td></tr>
<tr><td><code id="check_det_hrz_input_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td></tr>
<tr><td><code id="check_det_hrz_input_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only needed for 
<code>type="intens"</code> if no intensity is given. If not given, it will be estimated
using <code><a href="ks.html#topic+Hscv">Hscv</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+det_hrz">det_hrz</a></code>
</p>

<hr>
<h2 id='check_det_hrz_restr_input'>Checks the arguments of det_hrz_restr</h2><span id='topic+check_det_hrz_restr_input'></span>

<h3>Description</h3>

<p>For each argument it is checked if it is of a correct value or class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_det_hrz_restr_input(
  ppdata,
  type,
  criterion,
  cutoff,
  hole,
  integratehole,
  obsprobs,
  obsprobimage,
  distancemap,
  intens,
  nxprob,
  covmatrix,
  returnintens
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_det_hrz_restr_input_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_type">type</code></td>
<td>
<p>Method to use, can be one of <code>"dist"</code>(method of fixed radius or quantile-based method), or
<code>"intens"</code>(intensity based method)</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_criterion">criterion</code></td>
<td>
<p>criterion to limit the high-risk zone, can be one of
<code>"area"</code> (giving size of hrz), <code>"indirect"</code> (giving quantile/alpha depending on type),
or <code>"direct"</code> (giving radius/threshold c depending on type)</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_cutoff">cutoff</code></td>
<td>
<p>Value of criterion (area, radius, quantile, alpha or threshold).
Depending on criterion and type.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_hole">hole</code></td>
<td>
<p>(optional) an object of class <code>owin</code> representing a region inside the observation window of
the <code>ppdata</code> where no observations were possible.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_integratehole">integratehole</code></td>
<td>
<p>Should the <code>hole</code> be part of the resulting high-risk zone? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_obsprobs">obsprobs</code></td>
<td>
<p>(optional)  Vector of observation probabilities associated with the observations contained in <code>ppdata</code>.
Must be given in the same order as the coordinates of the observations. Only meaningful
for the intensity-based method if some observations are located in areas where not all
events can actually be observed. For example, if only one third of the events in a specific region
could be observed, the observation probability of the corresponding observations
is 1/3.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_obsprobimage">obsprobimage</code></td>
<td>
<p>(optional) an object of class <code>im</code> giving the observation probabilities inside the
observation window. Ranges of the coordinates must equal those of <code>ppdata</code>.
Only used if <code>obsprobs</code> is not given.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_distancemap">distancemap</code></td>
<td>
<p>(optional) distance map: distance of every pixel to the nearest observation
of the point pattern; only needed for <code>type="dist"</code>. If not given,
it will be computed by <code><a href="spatstat.geom.html#topic+distmap">distmap</a></code>.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_intens">intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class &quot;im&quot;,
see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>), only needed for type=&quot;intens&quot;. If not given,
it will be estimated.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only needed for
<code>type="intens"</code> if no intensity is given. If not given, it will be estimated.</p>
</td></tr>
<tr><td><code id="check_det_hrz_restr_input_+3A_returnintens">returnintens</code></td>
<td>
<p>Should the image of the estimated intensity be returned? Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='craterA'>Bomb crater Point Pattern</h2><span id='topic+craterA'></span>

<h3>Description</h3>

<p>Bomb crater Point Pattern
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(craterA)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"ppp"</code> representing a point pattern of bomb craters. The Cartesian coordinates are in meters.
See <code><a href="spatstat.geom.html#topic+ppp.object">ppp.object</a></code> for details of the format of a point pattern object.
</p>

<hr>
<h2 id='craterB'>Bomb crater Point Pattern</h2><span id='topic+craterB'></span>

<h3>Description</h3>

<p>Bomb crater Point Pattern
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(craterB)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"ppp"</code> representing a point pattern of bomb craters. The Cartesian coordinates are in meters.
See <code><a href="spatstat.geom.html#topic+ppp.object">ppp.object</a></code> for details of the format of a point pattern object.
</p>

<hr>
<h2 id='det_alpha'>calculation of alpha (failure probability), when having the threshold c</h2><span id='topic+det_alpha'></span>

<h3>Description</h3>

<p>This function is used for the intensity-based method. It determines the
probability to have at least one unobserved event outside the high-risk zone. 
A Poisson distribution is used for the number of unobserved events in a certain area or field.
Used in functions det_threshold, det_thresholdfromarea.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_alpha(intens, threshold, nxprob = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_alpha_+3A_intens">intens</code></td>
<td>
<p>estimated intensity of the observed process (object of class &quot;im&quot;, see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>)</p>
</td></tr>
<tr><td><code id="det_alpha_+3A_threshold">threshold</code></td>
<td>
<p>threshold c: The high-risk zone is the field in which the estimated intensity 
exceeds this value.</p>
</td></tr>
<tr><td><code id="det_alpha_+3A_nxprob">nxprob</code></td>
<td>
<p>probability of having unobserved events</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of alpha
</p>

<hr>
<h2 id='det_alpha_eval_ar'>Determination of failure probability within evaluation area</h2><span id='topic+det_alpha_eval_ar'></span>

<h3>Description</h3>

<p>Determination of failure probability within evaluation area
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_alpha_eval_ar(intens, eval_ar, threshold, nxprob = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_alpha_eval_ar_+3A_intens">intens</code></td>
<td>
<p>estimated intensity</p>
</td></tr>
<tr><td><code id="det_alpha_eval_ar_+3A_eval_ar">eval_ar</code></td>
<td>
<p>evaluation area</p>
</td></tr>
<tr><td><code id="det_alpha_eval_ar_+3A_threshold">threshold</code></td>
<td>
<p>given threshold</p>
</td></tr>
<tr><td><code id="det_alpha_eval_ar_+3A_nxprob">nxprob</code></td>
<td>
<p>constant probability of non-explosion</p>
</td></tr>
</table>

<hr>
<h2 id='det_area'>Calculation of the area of the high-risk zone.</h2><span id='topic+det_area'></span>

<h3>Description</h3>

<p>This function is used for the intensity-based method. Calculation of the
area of the high-risk zone given the observation window,
the intensity matrix and the threshold c. Used in function 
det_thresholdfromarea.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_area(win, intensmatrix, threshold)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_area_+3A_win">win</code></td>
<td>
<p>observation window</p>
</td></tr>
<tr><td><code id="det_area_+3A_intensmatrix">intensmatrix</code></td>
<td>
<p>matrix of the estimated intensity of the observed process (<code>as.matrix(intens)</code>)</p>
</td></tr>
<tr><td><code id="det_area_+3A_threshold">threshold</code></td>
<td>
<p>threshold c: The high-risk zone is the field in which the estimated intensity 
exceeds this value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical value giving the area of the high-risk zone.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.geom.html#topic+owin">owin</a></code>, <code><a href="spatstat.geom.html#topic+area.owin">area.owin</a></code>
</p>

<hr>
<h2 id='det_area_hole'>Calculation of the area of the high-risk zone.</h2><span id='topic+det_area_hole'></span>

<h3>Description</h3>

<p>This function is used for the intensity-based method with a hole restriction area. Calculation of the
area of the high-risk zone given the observation window,
the intensity matrix, the threshold c and a hole. Used in function 
det_thresholdfromarea_hole.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_area_hole(win, intensmatrix, threshold, hole, integratehole = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_area_hole_+3A_win">win</code></td>
<td>
<p>observation window</p>
</td></tr>
<tr><td><code id="det_area_hole_+3A_intensmatrix">intensmatrix</code></td>
<td>
<p>matrix of the estimated intensity of the observed process (<code>as.matrix(intens)</code>)</p>
</td></tr>
<tr><td><code id="det_area_hole_+3A_threshold">threshold</code></td>
<td>
<p>threshold c: The high-risk zone is the field in which the estimated intensity 
exceeds this value</p>
</td></tr>
<tr><td><code id="det_area_hole_+3A_hole">hole</code></td>
<td>
<p>specified hole</p>
</td></tr>
<tr><td><code id="det_area_hole_+3A_integratehole">integratehole</code></td>
<td>
<p>Should the <code>hole</code> be part of the resulting high-risk zone? Defaults to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical value giving the area of the high-risk zone.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.geom.html#topic+owin">owin</a></code>, <code><a href="spatstat.geom.html#topic+area.owin">area.owin</a></code>
</p>

<hr>
<h2 id='det_guard_width'>Estimation of width of a guard region given an estimated highriskzone</h2><span id='topic+det_guard_width'></span>

<h3>Description</h3>

<p><code>det_guard_width</code> determines the necessary width of a guard region in which
the existence of additional observed bomb craters could change a intensity based estimated 
highriskzone within the evaluation area of interest.
Within the evaluation area, the high risk zone consists of all points at which the estimated 
intensity of unexploded bombs exceeds a certain, specified or estimated threshold c. At a given 
point s, the intensity of unexploded bombs is given by the sum of all evaluated bivariate normal kernels
centered at the observed bomb craters multiplied by a constant nxprob/1-nxprob.
If the estimated intensity of unexploaded bombs is zero at a point at the boarder of the evaluation area
an additional observation outside the area could lift the intensity only above the determined threshold if the 
distance to the boarder is small enough so that the density of the normal kernel (which is centered at the additional 
observation) is bigger than the threshold at the boarder (assuming that the estimated kernel doesn't change due to the 
additional observation). The function returns the biggest distance in which it is possible that the density of
the bivariate normal kernel of the intensity of the supplied highriskzone exceeds thresh_const times the threshold
of the highriskzone. If thresh_const is set to 1, the guard region is the smallest region with constant width around 
the evaluation area in which a single additional observation could (but not necessarily does) increase the 
highriskzone within the evaluation area at a point at the boarder if the intensity of unexploaded bombs was zero at this point before. 
If the intensity was &gt;0 at a point at the boarder of the evaluation area, or more than 1 additional observations
are found nearby outside of the evaluation area, the highriskzone within the evaluation area could already expand  
by addditional observations with a bigger distance from the boarder. This can be considered by setting thresh_const &lt; 1, 
which intuitively means that 1/thresh_const crater observation at the same point could expand the highriskzone within 
the evaluation area in the direction of the additional observations, or that a point the boarder becomes part of the highriskzone
by the observation of a single additional crater if the intensity at this point was thresh_cont times the highriskzone threshold
based on all crater observations within the evaluation area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_guard_width(highriskzone, thresh_const = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_guard_width_+3A_highriskzone">highriskzone</code></td>
<td>
<p>the estimated highriskzone for the evaluation area</p>
</td></tr>
<tr><td><code id="det_guard_width_+3A_thresh_const">thresh_const</code></td>
<td>
<p>the constant multiplied with the determined threshold, 0 &lt; thresh_const &lt; 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more infos on the construction of guard zones see Mahling (2013, Appendix B, Approach 2)
</p>


<h3>Value</h3>

<p>The constant width of the guard region.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## change npixel to 1000 to obtain nicer plots
spatstat.geom::spatstat.options(npixel=100)
data(craterA)
# reduce number of observations for faster computation
thin.craterA &lt;- craterA[1:50]
hrzi1 &lt;- det_hrz(thin.craterA, type = "intens", criterion = "area", cutoff = 100000, nxprob = 0.1)
det_guard_width(hrzi1, thresh_const = .25)
</code></pre>

<hr>
<h2 id='det_hrz'>Determination of the high-risk zone.</h2><span id='topic+det_hrz'></span><span id='topic+highriskzone.object'></span><span id='topic+highriskzone'></span>

<h3>Description</h3>

<p><code>det_hrz</code> determines the high-risk zone through the method of fixed radius 
(type = &quot;dist&quot; and criterion = &quot;direct&quot;), the quantile-based method (type = &quot;dist&quot; and 
criterion = &quot;area&quot;/&quot;indirect&quot;) and the intensity-based method (type =  &quot;intens&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_hrz(
  ppdata,
  type,
  criterion,
  cutoff,
  distancemap = NULL,
  intens = NULL,
  nxprob = 0.1,
  covmatrix = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_hrz_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td></tr>
<tr><td><code id="det_hrz_+3A_type">type</code></td>
<td>
<p>Method to use, can be one of <code>"dist"</code> (method of fixed radius or quantile-based method), or
<code>"intens"</code> (intensity-based method)</p>
</td></tr>
<tr><td><code id="det_hrz_+3A_criterion">criterion</code></td>
<td>
<p>criterion to limit the high-risk zone, can be one of 
<code>"area"</code> (giving size of hrz), <code>"indirect"</code> (giving quantile/alpha depending on type),
or <code>"direct"</code> (giving radius/threshold c depending on type)</p>
</td></tr>
<tr><td><code id="det_hrz_+3A_cutoff">cutoff</code></td>
<td>
<p>Value of criterion (area, radius, quantile, alpha or threshold). 
Depending on criterion and type: 
If criterion = &quot;direct&quot; and type = &quot;intens&quot;, cutoff is the maximum intensity of unexploded bombs
outside the risk zone. If type = &quot;dist&quot; instead, cutoff is the radius of the circle around each exploded bomb.
&quot;If criterion = &quot;indirect&quot;, cutoff is the quantile for the quantile-based method and the failure 
probability alpha for the intensity-base method. If criterion = &quot;area&quot;, cutoff is the area the high-risk zone should
have.</p>
</td></tr>
<tr><td><code id="det_hrz_+3A_distancemap">distancemap</code></td>
<td>
<p>(optional) distance map: distance of every pixel to the nearest observation 
of the point pattern; only needed for <code>type="dist"</code>. If not given, 
it will be computed by <code><a href="spatstat.geom.html#topic+distmap">distmap</a></code>.</p>
</td></tr>
<tr><td><code id="det_hrz_+3A_intens">intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class &quot;im&quot;), 
only needed for type=&quot;intens&quot;. If not given,
it will be estimated using <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>.</p>
</td></tr>
<tr><td><code id="det_hrz_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td></tr>
<tr><td><code id="det_hrz_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only needed for 
<code>type="intens"</code> if no intensity is given. If not given, it will be estimated
using <code><a href="ks.html#topic+Hscv">Hscv</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are different methods implemented to determine a high-risk zone.
</p>

<dl>
<dt> Method of fixed radius </dt><dd>
<p>In this method, the high-risk zone is determined by drawing a circle around each
observed event with a fixed radius. This method will be used when <code>type = "dist"</code>
and <code>criterion = "direct"</code>. <code>cutoff</code> then is the radius.
</p>
</dd>
<dt> Quantile-based method </dt><dd>
<p>This method is a development of the above. Here the radius is not fixed. It uses
the distance of every observed event to the nearest other event, which is calculated by the
nearest-neighbour distance. The radius is assessed by the p-quantile of the empirical
distribution function of the nearest-neighbour distance. This method will be used when
<code>type = "dist"</code> and <code>criterion = "indirect"</code> or <code>"area"</code>. If 
<code>criterion = "indirect"</code>, then <code>cutoff</code> is the quantile that should be used.
If <code>criterion = "area"</code> then <code>cutoff</code> is the area that the  high-risk zone 
has to have at the end and from that the quantile/the radii are determined. When the
calculation is done via the area, it can not really be classified to the quantile-based
method. It is rather a third &quot;distance-based&quot; method.
</p>
</dd>
<dt> Intensity-based method </dt><dd>
<p>The first step of this method is to estimate the intensity of the observed events.
Based on the estimated intensity and the specified probability of unobserved bombs <code>nxprob</code> 
it is possible to estimate the intensity of unobserved/unexploded bombs.
The high-risk zone is then the area in which the estimated intensity of unexploded bombs exceeds a 
certain  value. This value is called threshold c.
The method will be used when <code>type = "intens"</code>. There are three different ways to
construct a high-risk zone: 
</p>

<ol>
<li><p> Fixing the threshold c: <code>criterion = "direct"</code> 
</p>
</li>
<li><p> Fixing the area of the high-risk zone: <code>criterion = "area"</code>
</p>
</li>
<li><p> Fixing the failure probability alpha, which is the probability of having 
unobserved events outside the high-risk zone: <code>criterion = "indirect"</code>
Here, the point process is assumed to be an inhomogeneous Poisson process.
</p>
</li></ol>

<p>For further information see Mahling et al. (2013) (References).
</p>
</dd>
</dl>

<p>If there are restriction areas in the observation window, use <code><a href="#topic+det_hrz_restr">det_hrz_restr</a></code>
instead. For estimation of intensity based highrikszones with a bigger observation area than area of interest
(evaluation area) use <code><a href="#topic+det_hrz_eval_ar">det_hrz_eval_ar</a></code>.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>highriskzone</code>&quot;, which is a list of
</p>
<table role = "presentation">
<tr><td><code>typehrz</code>, <code>criterion</code>, <code>cutoff</code>, <code>nxprob</code></td>
<td>
<p> see arguments</p>
</td></tr>
<tr><td><code>zone</code></td>
<td>
<p> Determined high-risk zone: Object of class &quot;owin&quot; based on a binary mask. 
See <code><a href="spatstat.geom.html#topic+owin">owin</a></code>. </p>
</td></tr>
<tr><td><code>threshold</code></td>
<td>
<p> determined threshold. If type = &quot;dist&quot; and criterion = &quot;direct&quot; it is the specified radius.
If criterion = &quot;indirect&quot; or &quot;area&quot; the determined radius used to construct a risk zone fulfilling the specified criterion 
and cutoff. If type = &quot;dist&quot; it is the specified or calculated threshold c, the maximum intensitiy of unexploded bombs 
outside the risk zone.</p>
</td></tr>
<tr><td><code>calccutoff</code></td>
<td>
<p> determined cutoff-value. For type=&quot;dist&quot; and criterion=&quot;area&quot;, this is the
quantile of the nearest-neighbour distance. For type=&quot;intens&quot; and criterion=&quot;area&quot; or &quot;direct&quot;, it is the failure
probability alpha. For all other criterions it is NA.</p>
</td></tr>
<tr><td><code>covmatrix</code></td>
<td>
<p> If not given (and <code>type="intens"</code>), it is estimated. See <code><a href="ks.html#topic+Hscv">Hscv</a></code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Monia Mahling, Michael Hoehle &amp; Helmut Kuechenhoff (2013),
<em>Determining high-risk zones for unexploded World War II bombs by using point process methodology.</em>
Journal of the Royal Statistical Society, Series C 62(2), 181-199.
</p>
<p>Monia Mahling (2013),
<em>Determining high-risk zones by using spatial point process methodology.</em>
Ph.D. thesis, Cuvillier Verlag Goettingen,
available online: http://edoc.ub.uni-muenchen.de/15886/
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.geom.html#topic+distmap">distmap</a></code>, <code><a href="spatstat.geom.html#topic+eval.im">eval.im</a></code>, <code><a href="spatstat.geom.html#topic+owin">owin</a></code>,
<code><a href="#topic+eval_method">eval_method</a></code>, <code><a href="#topic+det_hrz_restr">det_hrz_restr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(craterA)
## change npixel to 1000 to obtain nicer plots
spatstat.geom::spatstat.options(npixel=100)
## type: dist
hrzd1 &lt;- det_hrz(craterA, type = "dist", criterion = "area", cutoff = 1000000, nxprob = 0.1)
hrzd2 &lt;- det_hrz(craterA, type = "dist", criterion = "indirect", cutoff = 0.9, nxprob = 0.1)
hrzd3 &lt;- det_hrz(craterA, type = "dist", criterion = "direct", cutoff = 100, nxprob = 0.1)

op &lt;- par(mfrow = c(2, 2))
plot(craterA)
plot(hrzd1, zonecol = 2, win = craterA$window, plotwindow = TRUE)
plot(hrzd2, zonecol = 3,  win = craterA$window, plotwindow = TRUE)
plot(hrzd3, zonecol = 4,  win = craterA$window, plotwindow = TRUE)
par(op)

## Not run: 
# or first calculate the distancemap and use it:
distm &lt;- distmap(craterA)
hrzd &lt;- det_hrz(craterA, type = "dist", criterion = "direct", cutoff = 100,
                distancemap = distm, nxprob = 0.1)

## End(Not run)                
## type: intens 
# reduce number of observations for faster computation
thin.craterA &lt;- craterA[1:10]
hrzi1 &lt;- det_hrz(thin.craterA, type = "intens", criterion = "area", cutoff = 100000, nxprob = 0.1)
plot(hrzi1)
plot(thin.craterA, add = TRUE)
plot(thin.craterA$window, add = TRUE)
## Not run: 
hrzi2 &lt;- det_hrz(craterA, type = "intens", criterion = "indirect", cutoff = 0.1, nxprob = 0.1)
hrzi3 &lt;- det_hrz(craterA, type = "intens", criterion = "direct", cutoff = 0.0001, nxprob = 0.1)
plot(hrzi2)
plot(hrzi3)

## End(Not run)
                 
## More detailed examples on http://highriskzone.r-forge.r-project.org/
</code></pre>

<hr>
<h2 id='det_hrz_eval_ar'>Determination of high-risk zone on smaller area of interest (evaluation area) than observation area.</h2><span id='topic+det_hrz_eval_ar'></span>

<h3>Description</h3>

<p><code>det_hrz_eval_ar</code> determines intensity based highriskzones if bomb crater observations are available
for a bigger area than the area of main interest (evaluation area).
All observations are used for intensity estimation, the highriskzone is however constructed only in the
evaluation area. Either based on specifying a failure probability alpha that indicates the probability of 
unobserved bombs outside the highriskzone but inside the evaluation area of interest (and not in the 
overall observation area) (criterion = &quot;indirect&quot;), or by specifying the threshold (maximum intensity of non-
exploded bombs outside the) highriskzone directly and intersecting the resulting hrz with the 
evaluation area (criterion = &quot;direct&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_hrz_eval_ar(
  ppdata,
  eval_ar,
  criterion = c("indirect", "direct"),
  cutoff,
  intens = NULL,
  nxprob = 0.1,
  covmatrix = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_hrz_eval_ar_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp in the observation area.</p>
</td></tr>
<tr><td><code id="det_hrz_eval_ar_+3A_eval_ar">eval_ar</code></td>
<td>
<p>area of interest specified via an object of class owin</p>
</td></tr>
<tr><td><code id="det_hrz_eval_ar_+3A_criterion">criterion</code></td>
<td>
<p>criterion to limit the high-risk zone, can be <code>"indirect"</code> (failure probability 
alpha) or <code>"direct"</code> (threshold, i.e. maximum intensity of unexploded bombs outside hrz)</p>
</td></tr>
<tr><td><code id="det_hrz_eval_ar_+3A_cutoff">cutoff</code></td>
<td>
<p>Value of criterion (alpha or threshold)</p>
</td></tr>
<tr><td><code id="det_hrz_eval_ar_+3A_intens">intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class &quot;im&quot;) in (bigger) 
observation area, if not given, it will be estimated using <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>.</p>
</td></tr>
<tr><td><code id="det_hrz_eval_ar_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td></tr>
<tr><td><code id="det_hrz_eval_ar_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only needed for 
<code>type="intens"</code> if no intensity is given. If not given, it will be estimated
using <code><a href="ks.html#topic+Hscv">Hscv</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>highriskzone</code>&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12412)
spatstat.geom::spatstat.options(npixel=300)
data(craterB)
# reduce number of observations for faster computation
thin.craterB &lt;- craterB[sample(1:craterB$n, 40)]
# define evaluation area of interest
eval.ar &lt;- spatstat.geom::owin(xrange = c(0, 1900), yrange = c(0, 3400), 
               poly = matrix(c(250,250, 1200,1000,250,1000), byrow = TRUE, ncol = 2))

hrzi1 &lt;- det_hrz_eval_ar(thin.craterB, eval_ar = eval.ar, criterion = "direct",
                        cutoff = 3e-6, nxprob = .2)

plot(hrzi1)
plot(thin.craterB, add = TRUE)
plot(eval.ar, add = TRUE)
plot(craterB$window, add = TRUE)
</code></pre>

<hr>
<h2 id='det_hrz_restr'>Determination of the high-risk zone.</h2><span id='topic+det_hrz_restr'></span>

<h3>Description</h3>

<p><code>det_hrz_restr</code> determines the high-risk zone through the method of fixed radius
(type = &quot;dist&quot; and criterion = &quot;direct&quot;), the quantile-based method (type = &quot;dist&quot; and
criterion = &quot;area&quot;/&quot;indirect&quot;) and the intensity-based method (type =  &quot;intens&quot;).
Restriction areas can be taken into account.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_hrz_restr(
  ppdata,
  type,
  criterion,
  cutoff,
  hole = NULL,
  integratehole = TRUE,
  obsprobs = NULL,
  obsprobimage = NULL,
  distancemap = NULL,
  intens = NULL,
  nxprob = 0.1,
  covmatrix = NULL,
  returnintens = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_hrz_restr_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_type">type</code></td>
<td>
<p>Method to use, can be one of <code>"dist"</code>(method of fixed radius or quantile-based method), or
<code>"intens"</code>(intensity based method)</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_criterion">criterion</code></td>
<td>
<p>criterion to limit the high-risk zone, can be one of
<code>"area"</code> (giving size of hrz), <code>"indirect"</code> (giving quantile/alpha depending on type),
or <code>"direct"</code> (giving radius/threshold c depending on type)</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_cutoff">cutoff</code></td>
<td>
<p>Value of criterion (area, radius, quantile, alpha or threshold).
Depending on criterion and type.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_hole">hole</code></td>
<td>
<p>(optional) an object of class <code>owin</code> representing a region inside the observation window of
the <code>ppdata</code> where no observations were possible.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_integratehole">integratehole</code></td>
<td>
<p>Should the <code>hole</code> be part of the resulting high-risk zone? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_obsprobs">obsprobs</code></td>
<td>
<p>(optional)  Vector of observation probabilities associated with the observations contained in <code>ppdata</code>.
Must be given in the same order as the coordinates of the observations. Only meaningful
for the intensity-based method if some observations are located in areas where not all
events can actually be observed. For example, if only one third of the events in a specific region
could be observed, the observation probability of the corresponding observations
is 1/3.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_obsprobimage">obsprobimage</code></td>
<td>
<p>(optional) an object of class <code>im</code> giving the observation probabilities inside the
observation window. Ranges of the coordinates must equal those of <code>ppdata</code>.
Only used if <code>obsprobs</code> is not given.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_distancemap">distancemap</code></td>
<td>
<p>(optional) distance map: distance of every pixel to the nearest observation
of the point pattern; only needed for <code>type="dist"</code>. If not given,
it will be computed by <code><a href="spatstat.geom.html#topic+distmap">distmap</a></code>.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_intens">intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class &quot;im&quot;,
see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>), only needed for type=&quot;intens&quot;. If not given,
it will be estimated.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only needed for
<code>type="intens"</code> if no intensity is given. If not given, it will be estimated.</p>
</td></tr>
<tr><td><code id="det_hrz_restr_+3A_returnintens">returnintens</code></td>
<td>
<p>Should the image of the estimated intensity be returned? Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used in functions eval_method, sim_clintens, sim_intens.
<br />
This function contains the same functionalities as <code><a href="#topic+det_hrz">det_hrz</a></code>.
In addition, it offers the possibility to take into account so-called restriction areas. This is relevant in
situations where the observed point pattern <code>ppdata</code> is incomplete. If it is known that no observations
can be made in a certain area (for example because of water expanses),
this can be accounted for by integrating a hole in the observation window.
The shape and location of the hole is given by <code>hole</code>, whereas <code>integratehole</code> is used to state
whether the hole is to become part of the resulting high-risk zone.
This may also be a reasonable approach if only few observations could be made in a certain area.
Another approach consists in weighting the observed events with their reciprocal observation probability when
estimating the intensity. To do so, the observation probability can be specified by using <code>obsprobs</code> (value of the
observation probability for each event) or <code>obsprobsimage</code> (image of the observation probability). Note that the
observation probability may vary in space.
<br />
If there are no restriction areas in the observation window, <code><a href="#topic+det_hrz">det_hrz</a></code>
can be used instead.
<br />
Note that for <code>criterion = "area"</code>, <code>cutoff</code> specifies the area of the high-risk zone outside the hole. If
<code>integratehole = TRUE</code>, the area of the resulting high-risk zone will exceed <code>cutoff</code>.
</p>
<p>For further information, Mahling et al. (2013) and Mahling (2013), Chapters 4 and 8 and Appendix A (References).
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>highriskzone</code>&quot;, which is a list of
</p>
<table role = "presentation">
<tr><td><code>typehrz</code>, <code>criterion</code>, <code>cutoff</code>, <code>nxprob</code></td>
<td>
<p> see arguments</p>
</td></tr>
<tr><td><code>zone</code></td>
<td>
<p> Determined high-risk zone: Object of class &quot;owin&quot; based on a binary mask.
See <code><a href="spatstat.geom.html#topic+owin">owin</a></code>. </p>
</td></tr>
<tr><td><code>threshold</code></td>
<td>
<p> determined threshold. If type = &quot;dist&quot; and criterion = &quot;direct&quot; it is the specified radius.
If criterion = &quot;indirect&quot; or &quot;area&quot; the determined radius used to construct a risk zone fulfilling the specified criterion 
and cutoff. If type = &quot;dist&quot; it is the specified or calculated threshold c, the maximum intensitiy of unexploded bombs 
outside the risk zone.</p>
</td></tr>
<tr><td><code>calccutoff</code></td>
<td>
<p> determined cutoff-value. For type=&quot;dist&quot; and criterion=&quot;area&quot;, this is the
quantile of the nearest-neighbour distance. For type=&quot;intens&quot; and criterion=&quot;area&quot; or &quot;direct&quot;, it is the failure
probability alpha. For all other criterions it is NA.</p>
</td></tr>
<tr><td><code>covmatrix</code></td>
<td>
<p> If not given (and <code>type="intens"</code>), it is estimated. See <code><a href="ks.html#topic+Hscv">Hscv</a></code>.</p>
</td></tr>
<tr><td><code>estint</code></td>
<td>
<p> Estimated intensity. See <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="spatstat.geom.html#topic+distmap">distmap</a></code>, <code><a href="spatstat.geom.html#topic+eval.im">eval.im</a></code>, <code><a href="spatstat.geom.html#topic+owin">owin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1211515)
data(craterA)
#change npixel = 100 to 1000 to get a nicer picture
spatstat.geom::spatstat.options(npixel=100)
# reduce number of observations for faster computation
craterA &lt;- craterA[sample(1:craterA$n, 150)]
# define restriction area
restrwin &lt;- spatstat.geom::owin(xrange=craterA$window$xrange, yrange=craterA$window$yrange,
                           poly=list(x=c(1500, 1500, 2000, 2000), y=c(2000, 1500, 1500, 2000)))

# create image of observation probability (30% inside restriction area)
wim &lt;- spatstat.geom::as.im(craterA$window, value=1)
rim &lt;- spatstat.geom::as.im(restrwin, xy=list(x=wim$xcol, y=wim$yrow))
rim$v[is.na(rim$v)] &lt;- 0
oim1 &lt;- spatstat.geom::eval.im(wim - 0.7 * rim)
# determine high-risk zone by weighting the observations
hrzi1 &lt;- det_hrz_restr(ppdata=craterA, type = "intens", criterion = "indirect",
                       cutoff = 0.4, hole=NULL, obsprobs=NULL, obsprobimage=oim1, nxprob = 0.1)

# determine high-risk zone by accounting for a hole
hrzi2 &lt;- det_hrz_restr(ppdata=craterA, type = "intens", criterion = "indirect",
                       cutoff = 0.4, hole=restrwin, obsprobs=NULL, obsprobimage=NULL, nxprob = 0.1)
</code></pre>

<hr>
<h2 id='det_nnarea'>Determination of the area of a high-risk zone using the nearest-neighbour distance.</h2><span id='topic+det_nnarea'></span>

<h3>Description</h3>

<p>Used in function det_radius.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_nnarea(cutoffval, distancemap, win)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_nnarea_+3A_cutoffval">cutoffval</code></td>
<td>
<p>distance used as radius of the discs</p>
</td></tr>
<tr><td><code id="det_nnarea_+3A_distancemap">distancemap</code></td>
<td>
<p>distance map (object of class &quot;im&quot;, see <code><a href="spatstat.geom.html#topic+distmap">distmap</a></code>): 
distance of every location in the observation window to the nearest event</p>
</td></tr>
<tr><td><code id="det_nnarea_+3A_win">win</code></td>
<td>
<p>observation window of class owin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical value giving the area of the window.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.geom.html#topic+eval.im">eval.im</a></code>, <code><a href="spatstat.geom.html#topic+owin">owin</a></code>, <code><a href="spatstat.geom.html#topic+area.owin">area.owin</a></code>
</p>

<hr>
<h2 id='det_nsintens'>Determination of the intensity for the Neyman Scott simulation.</h2><span id='topic+det_nsintens'></span>

<h3>Description</h3>

<p>Used in function sim_nsppp.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_nsintens(ppdata, radius)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_nsintens_+3A_ppdata">ppdata</code></td>
<td>
<p>observed point pattern whose estimated intensity (adjusted for
thinning and divided by &quot;clustering&quot;) is used for simulating the
parent process</p>
</td></tr>
<tr><td><code id="det_nsintens_+3A_radius">radius</code></td>
<td>
<p>radius of the circles around the parent points in which the cluster
points are located</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pixel image (object of class &quot;im&quot;). See <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>, <code><a href="spatstat.geom.html#topic+boundingbox">boundingbox</a></code>, 
<code><a href="spatstat.geom.html#topic+owin">owin</a></code>, <code><a href="ks.html#topic+Hscv">Hscv</a></code>
</p>

<hr>
<h2 id='det_nsintens_restr'>Determination of the intensity for the Neyman-Scott simulation.</h2><span id='topic+det_nsintens_restr'></span>

<h3>Description</h3>

<p>Used in function bootcor_restr.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_nsintens_restr(ppdata, radius, weights)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_nsintens_restr_+3A_ppdata">ppdata</code></td>
<td>
<p>observed point pattern whose estimated intensity (adjusted for
thinning and divided by &quot;clustering&quot;) is used for simulating the
parent process</p>
</td></tr>
<tr><td><code id="det_nsintens_restr_+3A_radius">radius</code></td>
<td>
<p>radius of the circles around the parent points in which the cluster
points are located</p>
</td></tr>
<tr><td><code id="det_nsintens_restr_+3A_weights">weights</code></td>
<td>
<p>Vector of observation probabilities associated with the observations contained in <code>ppdata</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pixel image (object of class &quot;im&quot;). See <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>, <code><a href="spatstat.geom.html#topic+boundingbox">boundingbox</a></code>,
<code><a href="spatstat.geom.html#topic+owin">owin</a></code>, <code><a href="ks.html#topic+Hscv">Hscv</a></code>
</p>

<hr>
<h2 id='det_radius'>Determination of the nearest-neighbour distance which results in a high-risk zone with desired area</h2><span id='topic+det_radius'></span>

<h3>Description</h3>

<p>Used in function det_hrz.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_radius(ppdata, distancemap, areahrz, win)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_radius_+3A_ppdata">ppdata</code></td>
<td>
<p>observed spatial point pattern of class ppp.</p>
</td></tr>
<tr><td><code id="det_radius_+3A_distancemap">distancemap</code></td>
<td>
<p>distance map (object of class &quot;im&quot;, see <code><a href="spatstat.geom.html#topic+distmap">distmap</a></code>): 
distance of every location in the observation window to the nearest event</p>
</td></tr>
<tr><td><code id="det_radius_+3A_areahrz">areahrz</code></td>
<td>
<p>given area of the high-risk zone</p>
</td></tr>
<tr><td><code id="det_radius_+3A_win">win</code></td>
<td>
<p>observation window of class owin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 
</p>
<table role = "presentation">
<tr><td><code>cutoffdist</code></td>
<td>
<p> quantile of the nearest-neighbour distance </p>
</td></tr>
<tr><td><code>thresh</code></td>
<td>
<p> distance </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+det_nnarea">det_nnarea</a></code>, <code><a href="stats.html#topic+quantile">quantile</a></code>, <code><a href="stats.html#topic+uniroot">uniroot</a></code>
</p>

<hr>
<h2 id='det_threshold'>Calculation of the threshold c, when having failure probability alpha.</h2><span id='topic+det_threshold'></span>

<h3>Description</h3>

<p>The high-risk zone is the field in which the estimated intensity 
exceeds the threshold c, which is determined here, having the failure probability
alpha.
This function is for the intensity-based method. Used in function det_hrz.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_threshold(intens, alpha = 1e-05, nxprob = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_threshold_+3A_intens">intens</code></td>
<td>
<p>estimated intensity of the observed process (object of class &quot;im&quot;, see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>)</p>
</td></tr>
<tr><td><code id="det_threshold_+3A_alpha">alpha</code></td>
<td>
<p>failure probability: probability to have at least one unobserved event
outside the high-risk zone</p>
</td></tr>
<tr><td><code id="det_threshold_+3A_nxprob">nxprob</code></td>
<td>
<p>probability of having unobserved events</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the threshold c
</p>


<h3>See Also</h3>

<p><code><a href="#topic+det_alpha">det_alpha</a></code>, <code><a href="stats.html#topic+uniroot">uniroot</a></code>
</p>

<hr>
<h2 id='det_threshold_eval_ar'>Determination of necessary threshold to keep alpha in evaluation area</h2><span id='topic+det_threshold_eval_ar'></span>

<h3>Description</h3>

<p>Determination of necessary threshold to keep alpha in evaluation area
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_threshold_eval_ar(intens, eval_ar, alpha = 1e-05, nxprob = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_threshold_eval_ar_+3A_intens">intens</code></td>
<td>
<p>estimated intensity</p>
</td></tr>
<tr><td><code id="det_threshold_eval_ar_+3A_eval_ar">eval_ar</code></td>
<td>
<p>evaluation area</p>
</td></tr>
<tr><td><code id="det_threshold_eval_ar_+3A_alpha">alpha</code></td>
<td>
<p>desired failure probability in eval area</p>
</td></tr>
<tr><td><code id="det_threshold_eval_ar_+3A_nxprob">nxprob</code></td>
<td>
<p>constant probability of non-explosion</p>
</td></tr>
</table>

<hr>
<h2 id='det_thresholdfromarea'>Determination of alpha and the threshold c which results
in a high-risk zone with desired area.</h2><span id='topic+det_thresholdfromarea'></span>

<h3>Description</h3>

<p>This function is used for the intensity-based method. Used in function det_hrz.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_thresholdfromarea(intens, areahrz, win, nxprob = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_thresholdfromarea_+3A_intens">intens</code></td>
<td>
<p>estimated intensity of the observed process (object of class &quot;im&quot;, see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>)</p>
</td></tr>
<tr><td><code id="det_thresholdfromarea_+3A_areahrz">areahrz</code></td>
<td>
<p>area of the high-risk zone</p>
</td></tr>
<tr><td><code id="det_thresholdfromarea_+3A_win">win</code></td>
<td>
<p>observation window</p>
</td></tr>
<tr><td><code id="det_thresholdfromarea_+3A_nxprob">nxprob</code></td>
<td>
<p>probability of having unbserved events</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>threshold</code></td>
<td>
<p> Value of the threshold c. The high-risk zone is the field in which the estimated intensity 
exceeds this value </p>
</td></tr>
<tr><td><code>calccutoff</code></td>
<td>
<p> failure probability alpha for given area; probability to have at least unobserved event outside the high-risk zone </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+det_area">det_area</a></code>, <code><a href="#topic+det_alpha">det_alpha</a></code>
</p>

<hr>
<h2 id='det_thresholdfromarea_rest'>Determination of alpha and the threshold c which results
in a high-risk zone with desired area if a hole is present.</h2><span id='topic+det_thresholdfromarea_rest'></span>

<h3>Description</h3>

<p>This function is used for the intensity-based method. Used in function det_hrz_restr.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det_thresholdfromarea_rest(
  intens,
  areahrz,
  win,
  nxprob = 0.1,
  hole = hole,
  integratehole = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="det_thresholdfromarea_rest_+3A_intens">intens</code></td>
<td>
<p>estimated intensity of the observed process (object of class &quot;im&quot;, see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>)</p>
</td></tr>
<tr><td><code id="det_thresholdfromarea_rest_+3A_areahrz">areahrz</code></td>
<td>
<p>area of the high-risk zone</p>
</td></tr>
<tr><td><code id="det_thresholdfromarea_rest_+3A_win">win</code></td>
<td>
<p>observation window</p>
</td></tr>
<tr><td><code id="det_thresholdfromarea_rest_+3A_nxprob">nxprob</code></td>
<td>
<p>probability of having unbserved events</p>
</td></tr>
<tr><td><code id="det_thresholdfromarea_rest_+3A_hole">hole</code></td>
<td>
<p>an object of class <code>owin</code> representing a region inside the observation window of
the <code>ppdata</code> where no observations were possible.</p>
</td></tr>
<tr><td><code id="det_thresholdfromarea_rest_+3A_integratehole">integratehole</code></td>
<td>
<p>Should the <code>hole</code> be part of the resulting high-risk zone? Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>threshold</code></td>
<td>
<p> Value of the threshold c. The high-risk zone is the field in which the estimated intensity 
exceeds this value </p>
</td></tr>
<tr><td><code>calccutoff</code></td>
<td>
<p> failure probability alpha for given area; probability to have at least unobserved event outside the high-risk zone </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+det_area">det_area</a></code>, <code><a href="#topic+det_alpha">det_alpha</a></code>
</p>

<hr>
<h2 id='est_intens'>Estimates the intensity of the point pattern.</h2><span id='topic+est_intens'></span>

<h3>Description</h3>

<p>Estimates the intensity of the point pattern by a kernel method
(See <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_intens(ppdata, covmatrix = NULL, weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est_intens_+3A_ppdata">ppdata</code></td>
<td>
<p>data of class ppp</p>
</td></tr>
<tr><td><code id="est_intens_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(Optional) Covariance matrix of the kernel of a normal distribution</p>
</td></tr>
<tr><td><code id="est_intens_+3A_weights">weights</code></td>
<td>
<p>(Optional) vector of weights attached to each observation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>intensest</code></td>
<td>
<p> Estimated intensity (object of class &quot;im&quot;, see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>). </p>
</td></tr>
<tr><td><code>covmatrix</code></td>
<td>
<p> Covariance matrix. If <code>covmatrix = NULL</code>, the matrix is estimated by <code><a href="ks.html#topic+Hscv">Hscv</a></code>. </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>, <code><a href="ks.html#topic+Hscv">Hscv</a></code>, <code><a href="spatstat.geom.html#topic+eval.im">eval.im</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(craterA)
#change npixel = 50 to 1000 to get a nicer picture
spatstat.geom::spatstat.options(npixel=50)
# use only ten observations for fast computation
thin.craterA &lt;- craterA[1:10]
int &lt;- est_intens(thin.craterA)
# Plot estimated intensity
plot(int$intensest, main = "pixel image of intensity")
plot(craterA$window, main = "contour plot of intensity")
contour(int$intensest, add =TRUE)
</code></pre>

<hr>
<h2 id='est_intens_spde'>Estimates the intensity of the point pattern by using the SPDE method from r-INLA.</h2><span id='topic+est_intens_spde'></span>

<h3>Description</h3>

<p>Estimates the intensity of the point pattern by using the SPDE method from r-INLA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_intens_spde(
  coords,
  win = NULL,
  npixel = 50,
  fine_mesh = FALSE,
  mesh = NULL,
  weights = NULL,
  alpha = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est_intens_spde_+3A_coords">coords</code></td>
<td>
<p>ppp object or matrix with x and y coordinates of the observed bombs</p>
</td></tr>
<tr><td><code id="est_intens_spde_+3A_win">win</code></td>
<td>
<p>observation window, either of class owin or a matrix with the x and y coordinates of the boundary,
not neccessary if coords is a ppp object</p>
</td></tr>
<tr><td><code id="est_intens_spde_+3A_npixel">npixel</code></td>
<td>
<p>number of pixel per dimension (see <code><a href="spatstat.geom.html#topic+spatstat.options">spatstat.options</a></code>)</p>
</td></tr>
<tr><td><code id="est_intens_spde_+3A_fine_mesh">fine_mesh</code></td>
<td>
<p>logical, if FALSE a coarse mesh will be created, if TRUE a fine mesh will be created, 
only used if argument mesh is NULL</p>
</td></tr>
<tr><td><code id="est_intens_spde_+3A_mesh">mesh</code></td>
<td>
<p>(optional) a predefined mesh for the spde model</p>
</td></tr>
<tr><td><code id="est_intens_spde_+3A_weights">weights</code></td>
<td>
<p>(optional) integration weights for the spde model, only used if argument mesh is NULL</p>
</td></tr>
<tr><td><code id="est_intens_spde_+3A_alpha">alpha</code></td>
<td>
<p>(optional) alpha value for the spde model, only used if argument spde is NULL</p>
</td></tr>
<tr><td><code id="est_intens_spde_+3A_...">...</code></td>
<td>
<p>additional arguments for the construction of the spde model (see INLA/inla.spde2.matern documentation)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>intensest</code></td>
<td>
<p> Pixel image with the estimated intensities of the random field. </p>
</td></tr>
<tr><td><code>mesh</code></td>
<td>
<p> The mesh. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(craterA)
est_spde &lt;- est_intens_spde(coords=craterA)
image.plot(list(x=est_spde$intensest$xcol, y=est_spde$intensest$yrow, 
                z=log(t(est_spde$intensest$v))), main="estimated logarithmic intensity")
points(craterA)

## End(Not run)
</code></pre>

<hr>
<h2 id='est_intens_weight'>Estimates the intensity of the point pattern.</h2><span id='topic+est_intens_weight'></span>

<h3>Description</h3>

<p>Estimates the intensity of the point pattern by a kernel method 
(See <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_intens_weight(ppdata, covmatrix = NULL, weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est_intens_weight_+3A_ppdata">ppdata</code></td>
<td>
<p>data of class ppp</p>
</td></tr>
<tr><td><code id="est_intens_weight_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(Optional) Covariance matrix of the kernel of a normal distribution</p>
</td></tr>
<tr><td><code id="est_intens_weight_+3A_weights">weights</code></td>
<td>
<p>(Optional) vector of weights attached to each observation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 
</p>
<table role = "presentation">
<tr><td><code>intensest</code></td>
<td>
<p> Estimated intensity (object of class &quot;im&quot;, see <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>). </p>
</td></tr>
<tr><td><code>covmatrix</code></td>
<td>
<p> Covariance matrix. If <code>covmatrix = NULL</code> the matrix is estimated by <code><a href="ks.html#topic+Hscv">Hscv</a></code>. </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>, <code><a href="ks.html#topic+Hscv">Hscv</a></code>, <code><a href="spatstat.geom.html#topic+eval.im">eval.im</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(craterA)
#change npixel = 50 to 1000 to get a nicer picture
spatstat.geom::spatstat.options(npixel=50)
# use only ten observations for fast computation
thin.craterA &lt;- craterA[1:10]
# weight first 5 observations twice
weights &lt;- c(rep(2, 5), rep(1, 5))
int &lt;- est_intens_weight(thin.craterA, weights = weights)
plot(int$intensest, main = "pixel image of intensity")
plot(craterA$window, main = "contour plot of intensity")
contour(int$intensest, add =TRUE)
</code></pre>

<hr>
<h2 id='eval_hrz'>Evaluation of the high-risk zone.</h2><span id='topic+eval_hrz'></span>

<h3>Description</h3>

<p>Evaluation of the high-risk zone, which is only possible with simulated or thinned data or if the locations
of the unobserved events have been revealed..
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_hrz(hrz, unobspp, obspp = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eval_hrz_+3A_hrz">hrz</code></td>
<td>
<p>High-risk zone of class owin based on a binary mask (see <code><a href="spatstat.geom.html#topic+area.owin">area.owin</a></code>)</p>
</td></tr>
<tr><td><code id="eval_hrz_+3A_unobspp">unobspp</code></td>
<td>
<p>Unobserved spatial point process</p>
</td></tr>
<tr><td><code id="eval_hrz_+3A_obspp">obspp</code></td>
<td>
<p>Observed spatial point process</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>hrzeval</code>&quot;, which is a list of
</p>
<table role = "presentation">
<tr><td><code>numbermiss</code></td>
<td>
<p> number of unobserved events outside the high-risk zone </p>
</td></tr>
<tr><td><code>numberunobserved</code></td>
<td>
<p> number of events in the unobserved point pattern </p>
</td></tr>
<tr><td><code>missingfrac</code></td>
<td>
<p> fraction of unobserved events outside the high-risk zone (numbermiss/numberunobserved) </p>
</td></tr>
<tr><td><code>arearegion</code></td>
<td>
<p> area of the high-risk zone </p>
</td></tr>
<tr><td><code>numberobs</code></td>
<td>
<p> number of events in the observed point pattern </p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p> subset of the unobserved events, which are outside the high-risk zone </p>
</td></tr>
<tr><td><code>insd</code></td>
<td>
<p> subset of the unobserved events, which are inside the high-risk zone </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="spatstat.geom.html#topic+inside.owin">inside.owin</a></code>, <code><a href="spatstat.geom.html#topic+area.owin">area.owin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(craterB)
 # thin data
 set.seed(100)
 thdata &lt;- thin(craterB, nxprob=0.1)
 
 # determine hrz for the "observed events"
 hrz &lt;- det_hrz(thdata$observed, type = "dist", criterion = "area", cutoff = 1500000, nxprob = 0.1)
 
 # evaluate the hrz
 evaluation &lt;- eval_hrz(hrz = hrz$zone, unobspp = thdata$unobserved, obspp = thdata$observed)
 evaluation$missingfrac
 
 op &lt;- par(mar=c(1, 4, 1, 6) , xpd=TRUE)
 plot(evaluation, hrz = hrz, obspp = thdata$observed, plothrz = TRUE, plotobs = TRUE, 
 insidecol = "magenta", outsidecol = "magenta", obscol = "blue", insidepch = 1, 
 outsidepch = 19, main = "Evaluation visualized")
 legend(2400, 2456.4061, c("observed", "unobs inside", "unobs outside"), 
 col = c("blue", "magenta", "magenta"), yjust=1, pch=c(1, 1, 19), cex=0.8)
 par(op)
</code></pre>

<hr>
<h2 id='eval_method'>Evaluation of the procedures determining the high-risk zone.</h2><span id='topic+eval_method'></span>

<h3>Description</h3>

<p>Evaluates the performance of the three methods:
</p>

<ul>
<li><p> Method of fixed radius
</p>
</li>
<li><p> Quantile-based method
</p>
</li>
<li><p> Intensity-based method
</p>
</li></ul>

<p>For further details on the methods, see <code><a href="#topic+det_hrz">det_hrz</a></code> or the paper of Mahling et al. (2013)(References). <br />
There are three ways to simulate data for the evaluation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_method(
  ppdata,
  type,
  criterion,
  cutoff,
  numit = 100,
  nxprob = 0.1,
  distancemap = NULL,
  intens = NULL,
  covmatrix = NULL,
  simulate,
  radiusClust = NULL,
  clustering = 5,
  pbar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eval_method_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp.</p>
</td></tr>
<tr><td><code id="eval_method_+3A_type">type</code></td>
<td>
<p>Method to use, can be one of <code>"dist"</code> (method of fixed radius or quantile-based method), or
<code>"intens"</code> (intensity-based method)</p>
</td></tr>
<tr><td><code id="eval_method_+3A_criterion">criterion</code></td>
<td>
<p>criterion to limit the high-risk zone, can be one of 
<code>"area"</code> (giving size of hrz), <code>"indirect"</code> (giving quantile/alpha depending on type),
or <code>"direct"</code> (giving radius/threshold c depending on type)</p>
</td></tr>
<tr><td><code id="eval_method_+3A_cutoff">cutoff</code></td>
<td>
<p>Value of criterion (area, radius, quantile, alpha or threshold). 
Depending on criterion and type: 
If criterion = &quot;direct&quot; and type = &quot;intens&quot;, cutoff is the maximum intensity of unexploded bombs
outside the risk zone. If type = &quot;dist&quot; instead, cutoff is the radius of the circle around each exploded bomb.
&quot;If criterion = &quot;indirect&quot;, cutoff is the quantile for the quantile-based method and the failure 
probability alpha for the intensity-base method. If criterion = &quot;area&quot;, cutoff is the area the high-risk zone should
have.</p>
</td></tr>
<tr><td><code id="eval_method_+3A_numit">numit</code></td>
<td>
<p>Number of iterations</p>
</td></tr>
<tr><td><code id="eval_method_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events.
Default value is 0.1.</p>
</td></tr>
<tr><td><code id="eval_method_+3A_distancemap">distancemap</code></td>
<td>
<p>(optional) distance map: distance of every pixel to the nearest observation 
of the point pattern; only needed for <code>type="dist"</code>. If not given, 
it will be computed by <code><a href="spatstat.geom.html#topic+distmap">distmap</a></code>.</p>
</td></tr>
<tr><td><code id="eval_method_+3A_intens">intens</code></td>
<td>
<p>(optional) estimated intensity of the observed process (object of class &quot;im&quot;), 
only needed for type=&quot;intens&quot;. If not given,
it will be estimated using <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>.</p>
</td></tr>
<tr><td><code id="eval_method_+3A_covmatrix">covmatrix</code></td>
<td>
<p>(optional) Covariance matrix of the kernel of a normal distribution, only needed for 
<code>type="intens"</code> if no intensity is given. If not given, it will be estimated
using <code><a href="ks.html#topic+Hscv">Hscv</a></code>.</p>
</td></tr>
<tr><td><code id="eval_method_+3A_simulate">simulate</code></td>
<td>
<p>The type of simulation, can be one of <code>"thinning", "intens"</code> or <code>"clintens"</code></p>
</td></tr>
<tr><td><code id="eval_method_+3A_radiusclust">radiusClust</code></td>
<td>
<p>(Optional) radius of the circles around the parent points in which the cluster
points are located. Only used for <code>simulate = "clintens"</code>.</p>
</td></tr>
<tr><td><code id="eval_method_+3A_clustering">clustering</code></td>
<td>
<p>a value &gt;= 1 which describes the amount of clustering; the
adjusted estimated intensity of the observed pattern is divided by
this value; it is also the parameter of the Poisson distribution
for the number of points per cluster. Only used for <code>simulate = "clintens"</code>.</p>
</td></tr>
<tr><td><code id="eval_method_+3A_pbar">pbar</code></td>
<td>
<p>logical. Should progress bar be printed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The three simulation types are:
</p>

<dl>
<dt> Data-based simulation </dt><dd>
<p>Here a given data set is used. The data set is thinned as explained below.
Note that this method is very different from the others, since it is using the real data.
</p>
</dd>
<dt> Simulation of an inhomogeneous Poisson process </dt><dd>
<p>Here, an inhomogeneous Poisson process is simulated and then that data is thinned.
</p>
</dd>
<dt> Simulation of a Neyman-Scott process </dt><dd>
<p>Here a Neyman-Scott process is simulated (see <code><a href="#topic+sim_nsppp">sim_nsppp</a></code>, <code><a href="spatstat.random.html#topic+rNeymanScott">rNeymanScott</a></code>)
and this data is then also thinned.
</p>
</dd>
</dl>

<p>Thinning:<br />
Let <code class="reqn">X</code> be the spatial point process, which is the location of all events and let <code class="reqn">Y</code>
be a subset of <code class="reqn">X</code> describing the observed process. The process of unobserved events
then is Z = X \ Y , meaning that <code class="reqn">Z</code> and <code class="reqn">Y</code> are disjoint and together 
forming <code class="reqn">X</code>.<br />
Since <code class="reqn">Z</code> is not known, in this function an observed or simulated spatial point pattern 
<code>ppdata</code> is taken as the full pattern (which we denote by X') comprising the 
observed events Y' as well as the unobserved Z'.
Each event in X' is assigned to one of the two processes Y' or 
Z' by drawing independent Bernoulli random numbers. <br />
The resulting process of observed events Y' is used to determine the high-risk zone. 
Knowing now the unobserved process, it can be seen how many events are outside and inside the
high-risk zone.<br />
</p>
<p><code>type</code> and <code>criterion</code> may be vectors in this function.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with variables 
</p>
<table role = "presentation">
<tr><td><code>Iteration</code></td>
<td>
<p> Iterationstep of the result </p>
</td></tr>
<tr><td><code>Type</code>, <code>Criterion</code>, <code>Cutoff</code>, <code>nxprob</code></td>
<td>
<p> see arguments </p>
</td></tr>
<tr><td><code>threshold</code></td>
<td>
<p> determined threshold. If criterion=&quot;area&quot;, it is either the distance (if type=&quot;dist&quot;)
or the threshold c (for type=&quot;intens&quot;). If criterion=&quot;indirect&quot;, it is either the quantile of the
nearest-neighbour distance which is used as radius (if type=&quot;dist&quot;) or the threshold c (for type=&quot;intens&quot;). If criterion=&quot;direct&quot;,
it equals the cutoff for both types.</p>
</td></tr>
<tr><td><code>calccutoff</code></td>
<td>
<p> determined cutoff-value. For type=&quot;dist&quot; and criterion=&quot;area&quot;, this is the
quantile of the nearest-neighbour distance. For type=&quot;intens&quot; and criterion=&quot;area&quot;, it is the failure
probability alpha. For all other criterions it is NA.</p>
</td></tr>
<tr><td><code>covmatrix11</code>, <code>covmatrix12</code>, <code>covmatrix21</code>, <code>covmatrix22</code></td>
<td>
<p> values in the covariance matrix. 
covmatrix11 and covmatrix22 are the diagonal elements (variances). </p>
</td></tr>
<tr><td><code>numbermiss</code></td>
<td>
<p> number of unobserved points outside the high-risk zone </p>
</td></tr>
<tr><td><code>numberunobserved</code></td>
<td>
<p> number of observations in the unobserved point pattern Z' </p>
</td></tr>
<tr><td><code>missingfrac</code></td>
<td>
<p> fraction of unobserved events outside the high-risk zone (numbermiss/numberunobserved) </p>
</td></tr>
<tr><td><code>arearegion</code></td>
<td>
<p> area of the high-risk zone </p>
</td></tr>
<tr><td><code>numberobs</code></td>
<td>
<p> number of observations in the observed point pattern Y' </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+det_hrz">det_hrz</a></code>, <code><a href="spatstat.random.html#topic+rNeymanScott">rNeymanScott</a></code>, <code><a href="#topic+thin">thin</a></code>, <code><a href="#topic+sim_nsppp">sim_nsppp</a></code>, <code><a href="#topic+sim_intens">sim_intens</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:     
 data(craterB)
 
 # the input values are mainly the same as in det_hrz, so for more example ideas, 
 # see the documentation of det_hrz.
 evalm &lt;- eval_method(craterB, type = c("dist", "intens"), criterion = c("area", "area"), 
                      cutoff = c(1500000, 1500000), nxprob = 0.1, numit = 10, 
                      simulate = "clintens", radiusClust = 300, 
                      clustering = 15, pbar = FALSE)
 evalm_d &lt;- subset(evalm, evalm$Type == "dist")
 evalm_i &lt;- subset(evalm, evalm$Type == "intens")
 
 # pout:  fraction of high-risk zones that leave at least one unobserved event uncovered
 # pmiss:  Mean fraction of unobserved events outside the high-risk zone
 data.frame(pmiss_d = mean(evalm_d$missingfrac),
            pmiss_i = mean(evalm_i$missingfrac),
            pout_d = ( sum(evalm_d$numbermiss &gt; 0) / nrow(evalm_d) ), 
            pout_i = ( sum(evalm_i$numbermiss &gt; 0) / nrow(evalm_i) ))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.bootcorr'>Visualize the bootstrap correction for a high-risk zone.</h2><span id='topic+plot.bootcorr'></span>

<h3>Description</h3>

<p>Plot a visualization of the bootstrap correction for a high-risk zone.
The different values tested for alpha are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bootcorr'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bootcorr_+3A_x">x</code></td>
<td>
<p>bootstrap correction for a high-risk zone (object of class &quot;<code>bootcorr</code>&quot;)</p>
</td></tr>
<tr><td><code id="plot.bootcorr_+3A_...">...</code></td>
<td>
<p>extra arguments passed to the generic <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the plot method for the class <code>bootcorr</code>.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>, <code><a href="#topic+print.bootcorr">print.bootcorr</a></code>, <code><a href="#topic+summary.bootcorr">summary.bootcorr</a></code>
</p>

<hr>
<h2 id='plot.highriskzone'>Plot a high-risk zone</h2><span id='topic+plot.highriskzone'></span>

<h3>Description</h3>

<p>Plot a high-risk zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'highriskzone'
plot(
  x,
  ...,
  pattern = NULL,
  win = NULL,
  plotpattern = FALSE,
  plotwindow = FALSE,
  windowcol = "white",
  usegpclib = FALSE,
  zonecol = "grey"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.highriskzone_+3A_x">x</code></td>
<td>
<p>high-risk zone (object of class &quot;<code>highriskzone</code>&quot;)</p>
</td></tr>
<tr><td><code id="plot.highriskzone_+3A_...">...</code></td>
<td>
<p>extra arguments passed to the generic <code><a href="graphics.html#topic+plot">plot</a></code> function</p>
</td></tr>
<tr><td><code id="plot.highriskzone_+3A_pattern">pattern</code></td>
<td>
<p>spatial point pattern for which the highriskzone was determined.</p>
</td></tr>
<tr><td><code id="plot.highriskzone_+3A_win">win</code></td>
<td>
<p>observation winodw</p>
</td></tr>
<tr><td><code id="plot.highriskzone_+3A_plotpattern">plotpattern</code></td>
<td>
<p>logical flag; if <code>TRUE</code>, the point pattern is plotted.</p>
</td></tr>
<tr><td><code id="plot.highriskzone_+3A_plotwindow">plotwindow</code></td>
<td>
<p>logical flag; if <code>TRUE</code>, the observation window is plotted.</p>
</td></tr>
<tr><td><code id="plot.highriskzone_+3A_windowcol">windowcol</code></td>
<td>
<p>the color used to plot the observation window</p>
</td></tr>
<tr><td><code id="plot.highriskzone_+3A_usegpclib">usegpclib</code></td>
<td>
<p>logical flag; if <code>TRUE</code>, the observation window is transformed in a 
polygonal window (object of class &quot;<code>owin</code>&quot; and of type &quot;<code>polygonal</code>&quot;).
See <code><a href="spatstat.geom.html#topic+as.polygonal">as.polygonal</a></code></p>
</td></tr>
<tr><td><code id="plot.highriskzone_+3A_zonecol">zonecol</code></td>
<td>
<p>the colour used to plot the high-risk zone.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the plot method for the class <code>highriskzone</code>.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>, for examples see <code><a href="#topic+det_hrz">det_hrz</a></code>
</p>

<hr>
<h2 id='plot.hrzeval'>Visualize the evaluation of a high-risk zone.</h2><span id='topic+plot.hrzeval'></span>

<h3>Description</h3>

<p>Plot a visualization of the evaluation of a high-risk zone. At least the observation window and the unobserved events 
inside and outside the high-risk zone are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hrzeval'
plot(
  x,
  ...,
  hrz = NULL,
  obspp = NULL,
  plothrz = FALSE,
  plotobs = FALSE,
  windowcol = "white",
  insidecol = "blue",
  outsidecol = "red",
  insidepch = 20,
  outsidepch = 19,
  zonecol = "grey",
  obscol = "black",
  obspch = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.hrzeval_+3A_x">x</code></td>
<td>
<p>evaluation of a high-risk zone (object of class &quot;<code>hrzeval</code>&quot;)</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_...">...</code></td>
<td>
<p>extra arguments passed to the generic <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_hrz">hrz</code></td>
<td>
<p>(optional) high-risk zone (object of class &quot;<code>highriskzone</code>&quot;)</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_obspp">obspp</code></td>
<td>
<p>(optional) observed point pattern</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_plothrz">plothrz</code></td>
<td>
<p>logical flag; should the high-risk zone be plotted?</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_plotobs">plotobs</code></td>
<td>
<p>logical flag; should the observed point pattern be plotted?</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_windowcol">windowcol</code></td>
<td>
<p>the color used to plot the observation window</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_insidecol">insidecol</code></td>
<td>
<p>the color used to plot the unobserved events inside the high-risk zone</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_outsidecol">outsidecol</code></td>
<td>
<p>the color used to plot the unobserved events outside the high-risk zone</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_insidepch">insidepch</code></td>
<td>
<p>plotting 'character' of the unobserved events inside the high-risk zone,
i.e., symbol to use. This can either be a single character or an integer code for one of 
a set of graphics symbols. The full set of S symbols is available with pch=0:18, see 
<code><a href="graphics.html#topic+points">points</a></code>.</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_outsidepch">outsidepch</code></td>
<td>
<p>plotting 'character' of the unobserved events outside the high-risk zone</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_zonecol">zonecol</code></td>
<td>
<p>the color used to plot the high-risk zone</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_obscol">obscol</code></td>
<td>
<p>the color used to plot the observed events</p>
</td></tr>
<tr><td><code id="plot.hrzeval_+3A_obspch">obspch</code></td>
<td>
<p>plotting 'character' of the observed events</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the plot method for the class <code>hrzeval</code>.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>, <code><a href="#topic+eval_hrz">eval_hrz</a></code>, <code><a href="#topic+plot.highriskzone">plot.highriskzone</a></code>
</p>

<hr>
<h2 id='print.bootcorr'>Print Brief Details of a bootstrap correction for a high-risk zone</h2><span id='topic+print.bootcorr'></span>

<h3>Description</h3>

<p>Prints a very brief description of the bootstrap correction for a high-risk zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bootcorr'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bootcorr_+3A_x">x</code></td>
<td>
<p>bootstrap correction for of a high-risk zone (object of class &quot;<code>bootcorr</code>&quot;)</p>
</td></tr>
<tr><td><code id="print.bootcorr_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A very brief description of the bootstrap correction x for a high-risk zone is printed.
This is a method for the generic function <code><a href="base.html#topic+print">print</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+print">print</a></code>, <code><a href="#topic+summary.bootcorr">summary.bootcorr</a></code>
</p>

<hr>
<h2 id='print.highriskzone'>Print Brief Details of a high-risk zone</h2><span id='topic+print.highriskzone'></span>

<h3>Description</h3>

<p>Prints a very brief description of a high-risk zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'highriskzone'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.highriskzone_+3A_x">x</code></td>
<td>
<p>high-risk zone (object of class &quot;<code>highriskzone</code>&quot;)</p>
</td></tr>
<tr><td><code id="print.highriskzone_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A very brief description of the highriskzone x is printed.
This is a method for the generic function <code><a href="base.html#topic+print">print</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+print">print</a></code>, <code><a href="#topic+summary.highriskzone">summary.highriskzone</a></code>
</p>

<hr>
<h2 id='print.hrzeval'>Print Brief Details of an evaluation of a high-risk zone</h2><span id='topic+print.hrzeval'></span>

<h3>Description</h3>

<p>Prints a very brief description of the evaluation of a high-risk zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hrzeval'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.hrzeval_+3A_x">x</code></td>
<td>
<p>evaluation of a high-risk zone (object of class &quot;<code>hrzeval</code>&quot;)</p>
</td></tr>
<tr><td><code id="print.hrzeval_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A very brief description of the evaluation x of a high-risk zone is printed.
This is a method for the generic function <code><a href="base.html#topic+print">print</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+print">print</a></code>, <code><a href="#topic+summary.hrzeval">summary.hrzeval</a></code>
</p>

<hr>
<h2 id='read_pppdata'>Read data, so it can be used for high-risk zone methodology.</h2><span id='topic+read_pppdata'></span>

<h3>Description</h3>

<p>If xwin or ywin is NULL, the observation window will be a rectangular bounding box.
Vertices must be listed anticlockwise; no vertex should be repeated.
Only needed for data that is not already of class ppp.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_pppdata(xppp, yppp, xwin = NULL, ywin = NULL, unitname = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_pppdata_+3A_xppp">xppp</code></td>
<td>
<p>Vector of x coordinates of data points</p>
</td></tr>
<tr><td><code id="read_pppdata_+3A_yppp">yppp</code></td>
<td>
<p>Vector of y coordinates of data points</p>
</td></tr>
<tr><td><code id="read_pppdata_+3A_xwin">xwin</code></td>
<td>
<p>Vector of x coordinates of the vertices of a polygon circumscribing the observation window</p>
</td></tr>
<tr><td><code id="read_pppdata_+3A_ywin">ywin</code></td>
<td>
<p>Vector of y coordinates of the vertices of a polygon circumscribing the observation window</p>
</td></tr>
<tr><td><code id="read_pppdata_+3A_unitname">unitname</code></td>
<td>
<p>Optional. Name of unit of length. Either a single character string, or a vector of two 
character strings giving the singular and plural forms, respectively.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;ppp&quot; describing a point pattern in the two-dimensional plane.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.geom.html#topic+ppp">ppp</a></code>, <code><a href="spatstat.geom.html#topic+bounding.box.xy">bounding.box.xy</a></code>, <code><a href="spatstat.geom.html#topic+owin">owin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(craterA)
windowA &lt;- data.frame(x = craterA$window$bdry[[1]]$x, y = craterA$window$bdry[[1]]$y)
patternA &lt;- data.frame(x = craterA$x, y = craterA$y)
str(patternA)
str(windowA)
crater &lt;- read_pppdata(xppp = patternA$x, yppp = patternA$y, 
                       xwin = windowA$x, ywin = windowA$y)
crater
</code></pre>

<hr>
<h2 id='sim_intens'>Simulation on given intensity</h2><span id='topic+sim_intens'></span>

<h3>Description</h3>

<p>Generation of a random point pattern using the inhomogeneous Poisson process (if lambda is not constant)
and thinning of this data, to obtain &quot;observed&quot; and &quot;unobserved&quot; events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_intens(ppdata, intensSim, nxprob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_intens_+3A_ppdata">ppdata</code></td>
<td>
<p>Observed spatial point process of class ppp</p>
</td></tr>
<tr><td><code id="sim_intens_+3A_intenssim">intensSim</code></td>
<td>
<p>Intensity to use for the simulation</p>
</td></tr>
<tr><td><code id="sim_intens_+3A_nxprob">nxprob</code></td>
<td>
<p>Probability of having unobserved events</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of of observed and unobserved point patterns (see <code><a href="#topic+thin">thin</a></code>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thin">thin</a></code>, <code><a href="spatstat.random.html#topic+rpoispp">rpoispp</a></code>
</p>

<hr>
<h2 id='sim_nsppp'>Generation of a realisation of a Neyman-Scott process</h2><span id='topic+sim_nsppp'></span>

<h3>Description</h3>

<p>This algorithm generates a realisation of a Neyman-Scott process whose
expected number of points equals the number of observations in a given
pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_nsppp(ppdata, radius, clustering = 5, thinning = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_nsppp_+3A_ppdata">ppdata</code></td>
<td>
<p>observed point pattern, whose estimated intensity (adjusted for
thinning and divided by &quot;clustering&quot;) is used for simulating the
parent process</p>
</td></tr>
<tr><td><code id="sim_nsppp_+3A_radius">radius</code></td>
<td>
<p>radius of the circles around the parent points in which the cluster
points are located (Maximum radius of a random cluster)</p>
</td></tr>
<tr><td><code id="sim_nsppp_+3A_clustering">clustering</code></td>
<td>
<p>a value larger or equal 1 which describes the amount of clustering; the
adjusted estimated intensity of the observed pattern is divided by
this value; it is also the parameter of the Poisson distribution
for the number of points per cluster</p>
</td></tr>
<tr><td><code id="sim_nsppp_+3A_thinning">thinning</code></td>
<td>
<p>constant thinning probability (in case the observed pattern is a
thinned version of a full pattern); usually equal to the probability of having
unobserved events</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, the algorithm generates a Poisson point process (see <code><a href="spatstat.random.html#topic+rpoispp">rpoispp</a></code> for
details) of parent points with intensity kappa, which is a pixel image
object of class &quot;im&quot; (see <code><a href="spatstat.geom.html#topic+im.object">im.object</a></code>).<br />
This pixel image is derived from the observed pattern using <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>.
The bandwidth is not chosen in advance.<br />
If only a thinned version of the original pattern has been observed,
this can be taken into account using the parameter <code>thinning</code>.
Usually, not the estimated intensity itself is used for simulating the
parent process, but its values are divided by a constant named &quot;clustering&quot;.<br />
Second, each parent point is replaced by a random cluster of points, created
by calling the function <code><a href="spatstat.random.html#topic+runifdisc">runifdisc</a></code>. Each cluster consists of a Poisson
distributed number of points (with <code>clustering</code> being the expected number of
points in each cluster) which are located in a disc of a given <code>radius</code>.
These clusters are combined to yield a single point pattern which is
then returned as the result.<br />
The estimation of the intensity (on an adequate window) and the
simulation of the Neyman-Scott process are performed seperately,
so the intensity does not need to be reestimated in every iteration.<br />
The resulting process is a Mat?rn process whose parent process is an
inhomogeneous Poisson point process.
</p>


<h3>Value</h3>

<p>The simulated point pattern (an object of class &quot;ppp&quot;).
Additionally, some intermediate results of the simulation are returned as 
attributes of this point pattern: see <code><a href="spatstat.random.html#topic+rNeymanScott">rNeymanScott</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.random.html#topic+rNeymanScott">rNeymanScott</a></code>, <code><a href="spatstat.random.html#topic+rThomas">rThomas</a></code>, 
<code><a href="spatstat.random.html#topic+rMatClust">rMatClust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:       
 data(craterA)
 data(craterB)
 set.seed(100)
 sim_pp1 &lt;- sim_nsppp(craterA, radius=300, clustering=15, thinning=0.1)
 sim_pp2 &lt;- sim_nsppp(craterB, radius=300, clustering=15, thinning=0.1)
 op &lt;- par(mfrow = c(1, 2))
 plot(sim_pp1, main = "simulated cluster process 1")
 plot(sim_pp2, main = "simulated cluster process 2")
 par(op)
 
## End(Not run)
</code></pre>

<hr>
<h2 id='sim_nsprocess'>Simulation of the Neyman-Scott process.</h2><span id='topic+sim_nsprocess'></span>

<h3>Description</h3>

<p>Simulation of the Neyman-Scott process. Only applicable if the intensity was estimated
for an appropriately enlarged window.
More details in <code>sim_nsppp</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_nsprocess(ppdata, intens, radius, clustering = 5, thinning = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_nsprocess_+3A_ppdata">ppdata</code></td>
<td>
<p>observed point pattern whose estimated intensity (adjusted for
thinning and divided by &quot;clustering&quot;) is used for simulating the
parent process</p>
</td></tr>
<tr><td><code id="sim_nsprocess_+3A_intens">intens</code></td>
<td>
<p>estimated intensity</p>
</td></tr>
<tr><td><code id="sim_nsprocess_+3A_radius">radius</code></td>
<td>
<p>radius of the circles around the parent points in which the cluster
points are located (Maximum radius of a random cluster)</p>
</td></tr>
<tr><td><code id="sim_nsprocess_+3A_clustering">clustering</code></td>
<td>
<p>a value larger or equal 1 which describes the amount of clustering; the
adjusted estimated intensity of the observed pattern is divided by
this value; it is also the parameter of the Poisson distribution
for the number of points per cluster</p>
</td></tr>
<tr><td><code id="sim_nsprocess_+3A_thinning">thinning</code></td>
<td>
<p>constant thinning probability (in case the observed pattern is a
thinned version of a full pattern); usually equal to the probability of having
unobserved events</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The simulated point pattern (an object of class &quot;ppp&quot;).
Additionally, some intermediate results of the simulation are returned as 
attributes of this point pattern: see <code><a href="spatstat.random.html#topic+rNeymanScott">rNeymanScott</a></code>.
</p>

<hr>
<h2 id='summary.bootcorr'>Summary of a the bootstrap correction for a high-risk zone</h2><span id='topic+summary.bootcorr'></span>

<h3>Description</h3>

<p>Prints a useful summary of the bootstrap correction for a high-risk zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bootcorr'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bootcorr_+3A_object">object</code></td>
<td>
<p>bootstrap correction for a high-risk zone (object of class &quot;<code>bootcorr</code>&quot;)</p>
</td></tr>
<tr><td><code id="summary.bootcorr_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A useful summary of the bootstrap correction x for a high-risk zone is printed.
This is a method for the generic function <code><a href="base.html#topic+summary">summary</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code>, <code><a href="#topic+print.bootcorr">print.bootcorr</a></code>, <code><a href="#topic+plot.bootcorr">plot.bootcorr</a></code>
</p>

<hr>
<h2 id='summary.highriskzone'>Summary of a high-risk zone</h2><span id='topic+summary.highriskzone'></span>

<h3>Description</h3>

<p>Prints a useful summary of a high-risk zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'highriskzone'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.highriskzone_+3A_object">object</code></td>
<td>
<p>high-risk zone (object of class &quot;<code>highriskzone</code>&quot;)</p>
</td></tr>
<tr><td><code id="summary.highriskzone_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A useful description of the highriskzone object is printed.
This is a method for the generic function <code><a href="base.html#topic+summary">summary</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code>, <code><a href="#topic+print.highriskzone">print.highriskzone</a></code>
</p>

<hr>
<h2 id='summary.hrzeval'>Summary of a the evaluation of a high-risk zone</h2><span id='topic+summary.hrzeval'></span>

<h3>Description</h3>

<p>Prints a useful summary of the evaluation of a high-risk zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hrzeval'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.hrzeval_+3A_object">object</code></td>
<td>
<p>evaluation of a high-risk zone (object of class &quot;<code>hrzeval</code>&quot;)</p>
</td></tr>
<tr><td><code id="summary.hrzeval_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A useful description of the hrzeval object is printed.
This is a method for the generic function <code><a href="base.html#topic+summary">summary</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code>, <code><a href="#topic+print.hrzeval">print.hrzeval</a></code>
</p>

<hr>
<h2 id='thin'>Thinning of the observations (for evaluating the method)</h2><span id='topic+thin'></span>

<h3>Description</h3>

<p>The thinning is done by drawing independently from a Bernoulli distribution. This function is needed for functions eval_method, sim_clintens, sim_intens
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thin(full, nxprob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thin_+3A_full">full</code></td>
<td>
<p>all observations of the point pattern</p>
</td></tr>
<tr><td><code id="thin_+3A_nxprob">nxprob</code></td>
<td>
<p>probability of having unobserved events</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of observed and unobserved point patterns. Both of class ppp.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rbinom">rbinom</a></code>, <code><a href="spatstat.geom.html#topic+ppp">ppp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(craterB)
 thdata &lt;- thin(craterB, nxprob=0.1)
 thdata
 plot(thdata$observed); points(thdata$unobserved, col=4)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
