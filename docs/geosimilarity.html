<!DOCTYPE html><html lang="en"><head><title>Help for package geosimilarity</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {geosimilarity}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#gos'><p>geographically optimal similarity</p></a></li>
<li><a href='#gos_bestkappa'><p>function for the best kappa parameter</p></a></li>
<li><a href='#grid'><p>Spatial grid data of explanatory variables.</p></a></li>
<li><a href='#removeoutlier'><p>Removing outliers.</p></a></li>
<li><a href='#zn'><p>Spatial datasets of trace element Zn.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Geographically Optimal Similarity</td>
</tr>
<tr>
<td>Version:</td>
<td>3.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Understanding spatial association is essential for spatial 
             statistical inference, including factor exploration and spatial prediction. 
             Geographically optimal similarity (GOS) model is an effective method 
             for spatial prediction, as described in Yongze Song (2022) 
             &lt;<a href="https://doi.org/10.1007%2Fs11004-022-10036-8">doi:10.1007/s11004-022-10036-8</a>&gt;. GOS was developed based on 
             the geographical similarity principle, as described in Axing Zhu (2018) 
             &lt;<a href="https://doi.org/10.1080%2F19475683.2018.1534890">doi:10.1080/19475683.2018.1534890</a>&gt;. GOS has advantages in 
             more accurate spatial prediction using fewer samples and 
             critically reduced prediction uncertainty. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ausgis/geosimilarity">https://github.com/ausgis/geosimilarity</a>,
<a href="https://ausgis.github.io/geosimilarity/">https://ausgis.github.io/geosimilarity/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ausgis/geosimilarity/issues">https://github.com/ausgis/geosimilarity/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, parallel, tibble, dplyr (&ge; 1.1.0), purrr, ggplot2,
magrittr, ggrepel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, cowplot, viridis, car, DescTools,
PerformanceAnalytics, testthat (&ge; 3.0.0), rmarkdown</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-17 16:40:23 UTC; dell</td>
</tr>
<tr>
<td>Author:</td>
<td>Yongze Song <a href="https://orcid.org/0000-0003-3420-9622"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph],
  Wenbo Lv <a href="https://orcid.org/0009-0002-6003-3800"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wenbo Lv &lt;lyu.geosocial@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-17 16:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Value</h3>

<p><code>NULL</code> (this is the magrittr pipe operator)
</p>

<hr>
<h2 id='gos'>geographically optimal similarity</h2><span id='topic+gos'></span>

<h3>Description</h3>

<p>Computationally optimized function for geographically optimal similarity (GOS) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gos(formula, data = NULL, newdata = NULL, kappa = 0.25, cores = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gos_+3A_formula">formula</code></td>
<td>
<p>A formula of GOS model.</p>
</td></tr>
<tr><td><code id="gos_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> or <code>tibble</code> of observation data.</p>
</td></tr>
<tr><td><code id="gos_+3A_newdata">newdata</code></td>
<td>
<p>A <code>data.frame</code> or <code>tibble</code> of prediction variables data.</p>
</td></tr>
<tr><td><code id="gos_+3A_kappa">kappa</code></td>
<td>
<p>(optional) A numeric value of the percentage of observation locations
with high similarity to a prediction location. <code class="reqn">kappa = 1 - tau</code>, where <code>tau</code> is
the probability parameter in quantile operator. The default kappa is 0.25, meaning
that 25% of observations with high similarity to a prediction location are used for
modelling.</p>
</td></tr>
<tr><td><code id="gos_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer. If cores &gt; 1, a <code>parallel</code> package
cluster with that many cores is created and used. You can also supply a cluster
object. Default is <code>1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tibble</code> made up of predictions and uncertainties.
</p>

<dl>
<dt><code>pred</code></dt><dd><p>GOS model prediction results</p>
</dd>
<dt><code>uncertainty90</code></dt><dd><p>uncertainty under 0.9 quantile</p>
</dd>
<dt><code>uncertainty95</code></dt><dd><p>uncertainty under 0.95 quantile</p>
</dd>
<dt><code>uncertainty99</code></dt><dd><p>uncertainty under 0.99 quantile</p>
</dd>
<dt><code>uncertainty99.5</code></dt><dd><p>uncertainty under 0.995 quantile</p>
</dd>
<dt><code>uncertainty99.9</code></dt><dd><p>uncertainty under 0.999 quantile</p>
</dd>
<dt><code>uncertainty100</code></dt><dd><p>uncertainty under 1 quantile</p>
</dd>
</dl>



<h3>References</h3>

<p>Song, Y. (2022). Geographically Optimal Similarity. Mathematical Geosciences. doi: 10.1007/s11004-022-10036-8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("zn")
# log-transformation
hist(zn$Zn)
zn$Zn &lt;- log(zn$Zn)
hist(zn$Zn)
# remove outliers
k &lt;- removeoutlier(zn$Zn, coef = 2.5)
dt &lt;- zn[-k,]
# split data for validation: 70% training; 30% testing
split &lt;- sample(1:nrow(dt), round(nrow(dt)*0.7))
train &lt;- dt[split,]
test &lt;- dt[-split,]
system.time({
g1 &lt;- gos(Zn ~ Slope + Water + NDVI  + SOC + pH + Road + Mine,
          data = train, newdata = test, kappa = 0.25, cores = 1)
})
test$pred &lt;- g1$pred
plot(test$Zn, test$pred)
cor(test$Zn, test$pred)

</code></pre>

<hr>
<h2 id='gos_bestkappa'>function for the best kappa parameter</h2><span id='topic+gos_bestkappa'></span>

<h3>Description</h3>

<p>Computationally optimized function for determining the best kappa parameter for the optimal similarity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gos_bestkappa(
  formula,
  data = NULL,
  kappa = seq(0.05, 1, 0.05),
  nrepeat = 10,
  nsplit = 0.5,
  cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gos_bestkappa_+3A_formula">formula</code></td>
<td>
<p>A formula of GOS model.</p>
</td></tr>
<tr><td><code id="gos_bestkappa_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> or <code>tibble</code> of observation data.</p>
</td></tr>
<tr><td><code id="gos_bestkappa_+3A_kappa">kappa</code></td>
<td>
<p>(optional) A numeric value of the percentage of observation locations
with high similarity to a prediction location. <code class="reqn">kappa = 1 - tau</code>, where <code>tau</code> is
the probability parameter in quantile operator. kappa is 0.25 means that 25% of
observations with high similarity to a prediction location are used for modelling.</p>
</td></tr>
<tr><td><code id="gos_bestkappa_+3A_nrepeat">nrepeat</code></td>
<td>
<p>(optional) A numeric value of the number of cross-validation training times.
The default value is <code>10</code>.</p>
</td></tr>
<tr><td><code id="gos_bestkappa_+3A_nsplit">nsplit</code></td>
<td>
<p>(optional) The sample training set segmentation ratio,which in <code style="white-space: pre;">&#8288;(0,1)&#8288;</code>.
Default is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="gos_bestkappa_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer. If cores &gt; 1, a <code>parallel</code> package
cluster with that many cores is created and used. You can also supply a cluster
object. Default is <code>1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>bestkappa</code></dt><dd><p>the result of best kappa</p>
</dd>
<dt><code>cvrmse</code></dt><dd><p>all RMSE calculations during cross-validation</p>
</dd>
<dt><code>cvmean</code></dt><dd><p>the average RMSE corresponding to different kappa in the cross-validation process</p>
</dd>
<dt><code>plot</code></dt><dd><p>the plot of rmse changes corresponding to different kappa</p>
</dd>
</dl>



<h3>References</h3>

<p>Song, Y. (2022). Geographically Optimal Similarity. Mathematical Geosciences. doi: 10.1007/s11004-022-10036-8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("zn")
# log-transformation
hist(zn$Zn)
zn$Zn &lt;- log(zn$Zn)
hist(zn$Zn)
# remove outliers
k &lt;- removeoutlier(zn$Zn, coef = 2.5)
dt &lt;- zn[-k,]
# determine the best kappa
system.time({
b1 &lt;- gos_bestkappa(Zn ~ Slope + Water + NDVI  + SOC + pH + Road + Mine,
                    data = dt,
                    kappa = c(0.01, 0.1, 1),
                    nrepeat = 1,
                    cores = 1)
})
b1$bestkappa
b1$plot

</code></pre>

<hr>
<h2 id='grid'>Spatial grid data of explanatory variables.</h2><span id='topic+grid'></span>

<h3>Description</h3>

<p>Spatial grid data of explanatory variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid
</code></pre>


<h3>Format</h3>

<p><code>grid</code>: A tibble of grided trace element explanatory variables
with 13132 rows and 12 variables, where the first column is ID.
</p>


<h3>Author(s)</h3>

<p>Yongze Song <a href="mailto:yongze.song@outlook.com">yongze.song@outlook.com</a>
</p>

<hr>
<h2 id='removeoutlier'>Removing outliers.</h2><span id='topic+removeoutlier'></span>

<h3>Description</h3>

<p>Function for removing outliers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeoutlier(x, coef = 2.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeoutlier_+3A_x">x</code></td>
<td>
<p>A vector of a variable</p>
</td></tr>
<tr><td><code id="removeoutlier_+3A_coef">coef</code></td>
<td>
<p>A number of the times of standard deviation. Default is <code>2.5</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Location of outliers in the vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("zn")
# log-transformation
hist(zn$Zn)
zn$Zn &lt;- log(zn$Zn)
hist(zn$Zn)
# remove outliers
k &lt;- removeoutlier(zn$Zn, coef = 2.5)
k

</code></pre>

<hr>
<h2 id='zn'>Spatial datasets of trace element Zn.</h2><span id='topic+zn'></span>

<h3>Description</h3>

<p>Spatial datasets of trace element Zn.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zn
</code></pre>


<h3>Format</h3>

<p><code>zn</code>: A tibble of trace element Zn with 894 rows and 12 variables
</p>


<h3>Author(s)</h3>

<p>Yongze Song <a href="mailto:yongze.song@outlook.com">yongze.song@outlook.com</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
