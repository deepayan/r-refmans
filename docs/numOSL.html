<!DOCTYPE html><html><head><title>Help for package numOSL</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {numOSL}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#analyseBINdata'><p>BIN data analysis</p></a></li>
<li><a href='#as_analyseBIN'>
<p>Transfom SAR data sets into S3 class object &quot;analyseBIN&quot;</p></a></li>
<li><a href='#BIN'>
<p>BIN data</p></a></li>
<li><a href='#calDA'>
<p>Dose rate and age calculation</p></a></li>
<li><a href='#calED'>
<p>Equivalent dose calculation and error assessment</p></a></li>
<li><a href='#calRcyRcp'>
<p>Recycling ratio and recuperation calculation</p></a></li>
<li><a href='#calSARED'>
<p>SAR equivalent doses calculation and selection</p></a></li>
<li><a href='#calSGCED'>
<p>SGC Equivalent dose calculation and selection</p></a></li>
<li><a href='#dbED'>
<p>De distribution summarization</p></a></li>
<li><a href='#decomp'>
<p>OSL decay curve decomposition</p></a></li>
<li><a href='#EDdata'>
<p>Equivalent dose values</p></a></li>
<li><a href='#fastED'>
<p>Fast-component equivalent dose calculation</p></a></li>
<li><a href='#fitGrowth'>
<p>Growth curve fitting</p></a></li>
<li><a href='#loadBINdata'>
<p>BIN file loading (importing)</p></a></li>
<li><a href='#lsNORM'>
<p>Regenerative-dose signal optimization using the LS-normalisation procedure</p></a></li>
<li><a href='#mcFMM'>
<p>Finite mixture age model optimization (using a Markov chain Monte Carlo method)</p></a></li>
<li><a href='#mcMAM'>
<p>Optimization of the minimum (maximum) age model  (using a Markov chain Monte Carlo method)</p></a></li>
<li><a href='#numOSL-package'><p>Package for tackling basic numeric problems in optically stimulated luminescence dating</p></a></li>
<li><a href='#optimSAM'>
<p>Optimization of statistical age models</p></a></li>
<li><a href='#pickBINdata'>
<p>BIN data set selection</p></a></li>
<li><a href='#pickSARdata'>
<p>SAR data set selection</p></a></li>
<li><a href='#psRadialPlot'>
<p>Pseudo radial plot drawing</p></a></li>
<li><a href='#RadialPlotter'>
<p>Statistical age model optimization (with a Maximum Likelihood Estimation method)</p></a></li>
<li><a href='#reportMC'>
<p>Reporting MCMC outputs for statistical age models</p></a></li>
<li><a href='#SARdata'>
<p>Data sets used for SAR equivalent dose calculation</p></a></li>
<li><a href='#scaleSGCN'>
<p>Natural-dose signal re-scaling</p></a></li>
<li><a href='#sensSAM'>
<p>Investigate of the sensitivity of a statistical age model to the additional uncertainty (sigmab)</p></a></li>
<li><a href='#Signaldata'>
<p>Decay curves datasets</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Numeric Routines for Optically Stimulated Luminescence Dating</td>
</tr>
<tr>
<td>Version:</td>
<td>2.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Jun Peng [aut, cre],
  Bo Li [aut],
  Chunxin Wang [aut],
  Jorge More [ctb],
  Burton Garbow [ctb],
  Kenneth Hillstrom [ctb],
  John Burkardt [ctb],
  Paul Gilbert [ctb],
  Ravi Varadhan [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jun Peng &lt;pengjun10@mails.ucas.ac.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Optimizing regular numeric problems in optically stimulated luminescence dating, 
        such as: equivalent dose calculation, dose rate determination, growth curve fitting, decay 
        curve decomposition, statistical age model optimization, and statistical plot visualization.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, utils, grDevices</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=numOSL">https://CRAN.R-project.org/package=numOSL</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-06 11:27:53 UTC; pengjun</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-06 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='analyseBINdata'>BIN data analysis</h2><span id='topic+analyseBINdata'></span><span id='topic+analyseBINdata.default'></span><span id='topic+analyseBINdata0'></span><span id='topic+analyseBINdata0.default'></span>

<h3>Description</h3>

<p>Analysing signal data records extracted from a BIN file.</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyseBINdata(obj_pickBIN, nfchn, nlchn, bg = "late", 
               me = 2.0, distp = "p", kph = NULL, 
               kdc = NULL, dcr = NULL, FR.fchn = NULL, 
               FR.mchn = NULL, FR.lchn = NULL, 
               signal.type = "LxTx", outfile = NULL)

analyseBINdata0(obj_pickBIN, fchn, lchn, bg="late", me=2.0, 
                distp="p", kph=NULL, kdc=NULL, dcr=NULL, 
                FR.fchn=NULL, FR.mchn=NULL, FR.lchn=NULL, 
                signal.type="LxTx", outfile=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyseBINdata_+3A_obj_pickbin">obj_pickBIN</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(<b>required</b>): an object of S3 class <code>"pickBIN"</code> produced by<br /> 
function <a href="#topic+pickBINdata">pickBINdata</a></p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_nfchn">nfchn</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(<b>required</b>): number of the first few channels from the initial<br />
part of a decay curve. Number of counts summed over channels<br />
<code>(Delay+1L):(Delay+nfchn)</code> is calculated as the fast-component<br />
plus backgroud signal</p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_nlchn">nlchn</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(<b>required</b>): number of the last few channels from the latter part<br />
of a decay curve. If <code>bg="late"</code>, number of counts averaged over channels<br />
<code>(Delay+On-nlchn+1L):(Delay+On)</code> will be calculated as the backgroud<br />
signal, if <code>bg="early"</code>, number of counts averaged over channels<br />
<code>(Delay+nfchn+1L):(Delay+nfchn+nlchn)</code> will be calculated as the<br />
backgroud signal. <code>Delay</code> and <code>On</code> are obtained internally from the BIN file. 
</p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_fchn">fchn</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(<b>required</b>): channels used for calculating the fast-component signals</p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_lchn">lchn</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(<b>required</b>): channels used for calculating the background counts</p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_bg">bg</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): background subtraction method, i.e.,<br />
<code>bg="early"</code> or <code>bg="late"</code></p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_me">me</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): measurement error of Lx (or Tx) in percent</p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_distp">distp</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): distribution of photon counts, <code>distp="p"</code> denotes<br />
Poisson distribution, <code>distp="op"</code> denotes Over Poisson distribution</p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_kph">kph</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): correction factor for photon counts</p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_kdc">kdc</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): correction factor for dark counts</p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_dcr">dcr</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): dark count rate</p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_fr.fchn">FR.fchn</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): fast-component signal channels, note that those channels are extracted
internally from the &quot;ON&quot; channels,<br />
i.e., <code>FR.fchn=((Delay+1):(Delay+On))[FR.fchn]</code>.<br />
Example: <code>FR.fchn=1:5</code></p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_fr.mchn">FR.mchn</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): medium-component signal channels, note that those channels are extracted 
internally from the &quot;ON&quot; channels,<br />
i.e., <code>FR.mchn=((Delay+1):(Delay+On))[FR.mchn]</code>.<br />
Example: <code>FR.mchn=31:60</code></p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_fr.lchn">FR.lchn</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): background signal channels, note that those channels are extracted 
internally from the &quot;ON&quot; channels,<br />
i.e., <code>FR.lchn=((Delay+1):(Delay+On))[FR.lchn]</code>.<br />
Example: <code>FR.lchn=201:250</code></p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_signal.type">signal.type</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): type of signal, <code>"LxTx"</code>, <code>"Lx"</code>, or <code>"Tx"</code></p>
</td></tr>
<tr><td><code id="analyseBINdata_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, analysis results (i.e., <code>NO</code>, <code>Position</code>, <code>Grain</code>, 
<code>SAR.Cycle</code>, <code>Dose</code>, <code>Init</code>, <code>BG</code>, <code>Lx</code>, <code>seLx</code>, <code>TInit</code>, <code>TBG</code>, <code>Tx</code>, <code>seTx</code>, 
<code>LxTx</code>, <code>seLxTx</code>) will be written to a CSV file named <code>"outfile"</code> and saved to the current work directory</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+analyseBINdata">analyseBINdata</a> is used for signal (i.e., Lx, Tx, and Lx/Tx) calculation. 
It provides two protocols for background subtraction (i.e., the early and late background subtraction methods).<br /><br />
Standard error of signals are assessed using two methods: if photon counts are assummed to follow Poisson distributions, 
<b>Eqn.(3)</b> of Galbraith (2002) will be applied; if photon counts are over-dispersed, <b>Eqn.(10)</b> of Bluszcz et al. (2015) will be applied.<br /><br />
If arguments <code>FR.fchn</code>, <code>FR.mchn</code>, and <code>FR.lchn</code> are provided, fast ratio will be calculated according to Madsen et al. (2009).
</p>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> of S3 class object &quot;analyseBIN&quot; containing the following elements:
</p>
<table>
<tr><td><code>SARdata</code></td>
<td>
<p>a <a href="base.html#topic+data.frame">data.frame</a> containing calculated SAR data sets</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>values used as rejection criteria (0-1 values indicating if Tn is more than 3 sigma above BG or not, 
ratio of initial Tn signal to BG and associated standard error, relative standard error of Tn in percent, fast ratio of Tn and associated standard error), 
<code>NA</code> is produced if the value can not be calculated. Note that in this function rejection criteria are calculated but not applied</p>
</td></tr>
<tr><td><code>Tn</code></td>
<td>
<p>values of Tn and associated standard errors</p>
</td></tr>
<tr><td><code>LnTn.curve</code></td>
<td>
<p>decay curves for Ln and Tn for different aliquots (grains)</p>
</td></tr>
<tr><td><code>TxTn</code></td>
<td>
<p>ratios of Tx to Tn for various SAR cycles</p>
</td></tr>
<tr><td><code>agID</code></td>
<td>
<p>aliquot or grain ID (i.e., <code>NO</code>, <code>Position</code>, and <code>Grain</code>)</p>
</td></tr>
</table>
<p><code>SARdata</code> is a <a href="base.html#topic+data.frame">data.frame</a> containing the following elements if <code>signal.type="LxTx"</code>:
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Element</b>    </td><td style="text-align: left;">  <b>Description</b>                             </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>NO</code>         </td><td style="text-align: left;">  aliquot (grain) number                         </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>SAR.Cycle</code>  </td><td style="text-align: left;">  SAR cycle (N, R1, R2, R3, ...)                 </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>Dose</code>       </td><td style="text-align: left;">  regenerative dose                              </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>LxTx</code>       </td><td style="text-align: left;">  sensitivity-corrected regenerative-dose signal </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>seLxTx</code>     </td><td style="text-align: left;">  standard error of LxTx                                  
</td>
</tr>

</table>

<p><code>SARdata</code> contains the following elements if <code>signal.type="Lx"</code>:
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Element</b>    </td><td style="text-align: left;">  <b>Description</b>                </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>NO</code>         </td><td style="text-align: left;">  aliquot (grain) number            </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>SAR.Cycle</code>  </td><td style="text-align: left;">  SAR cycle (N, R1, R2, R3, ...)    </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>Dose</code>       </td><td style="text-align: left;">  regenerative dose                 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Lx</code>         </td><td style="text-align: left;">  regenerative-dose signal          </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>seLx</code>       </td><td style="text-align: left;">  standard error of Lx                                 
</td>
</tr>

</table>

<p><code>SARdata</code> contains the following elements if <code>signal.type="Tx"</code>:
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Element</b>    </td><td style="text-align: left;">  <b>Description</b>                   </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>NO</code>         </td><td style="text-align: left;">  aliquot (grain) number               </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>SAR.Cycle</code>  </td><td style="text-align: left;">  SAR cycle (N, R1, R2, R3, ...)       </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>Dose</code>       </td><td style="text-align: left;">  regenerative dose                    </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Tx</code>         </td><td style="text-align: left;">  test-dose signal                     </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>seTx</code>       </td><td style="text-align: left;">  standard error of Tx                                 
</td>
</tr>

</table>



<h3>Note</h3>

<p>Though function <a href="#topic+analyseBINdata">analyseBINdata</a> is originally designed to analyze CW-OSL data sets, IRSL data sets obtained from the SAR protocol can also be analyzed.
</p>


<h3>References</h3>

<p>Ballarini M, Wallinga J, Wintle AG, Bos AJJ, 2007. A modified SAR protocol for optical dating of individual grains from young quartz samples. 
Radiation Measurements, 42(3): 360-369.
</p>
<p>Bluszcz A, Adamiec G, Heer AJ, 2015. Estimation of equivalent dose and its uncertainty in the OSL SAR protocol when count numbers do not follow a Poisson distribution. Radiation Measurements, 81: 46-54. 
</p>
<p>Cunningham AC, Wallinga J, 2010. Selection of integration time intervals for quartz OSL decay curves. Quaternary Geochronology, 5(6): 657-666
</p>
<p>Duller GAT, 2016. Analyst (v4.31.9), User Mannual.
</p>
<p>Durcan JA, Duller GAT, 2011. The fast ratio: A rapid measure for testing the dominance of the fast component in the initial OSL signal from quartz. Radiation Measurements, 46(10): 1065-1072.
</p>
<p>Galbraith R, 2002. A note on the variance of a backround-corrected OSL count. Ancient TL, 20(2): 49-51.
</p>
<p>Madsen AT, Duller GAT, Donnelly JP, Roberts HM, Wintle AG, 2009. A chronology of hurricane landfalls at Little Sippewissett Marsh, Massachusetts, USA, using optical dating. Geomorphology, 109(1-2): 36-45.
</p>


<h3>See Also</h3>

<p><a href="#topic+loadBINdata">loadBINdata</a>; <a href="#topic+pickBINdata">pickBINdata</a>; <a href="#topic+pickSARdata">pickSARdata</a>; <a href="#topic+calED">calED</a>;<br />
<a href="#topic+calSARED">calSARED</a>; <a href="#topic+calSGCED">calSGCED</a>; <a href="#topic+fitGrowth">fitGrowth</a>; <a href="#topic+lsNORM">lsNORM</a>; <a href="#topic+BIN">BIN</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   ### Example 1 (not run):
   # obj_loadBIN &lt;- loadBINdata("foo.bin", view=TRUE)
   # obj_pickBIN &lt;- pickBINdata(obj_loadBIN, Position=2, LType="OSL")
   # analyseBINdata(obj_pickBIN, nfchn=3, nlchn=20)

   ### Example 2:
   data(BIN)
   obj_pickBIN &lt;- pickBINdata(BIN, Position=c(2,4,6,8,10), 
                              LType="OSL", view=FALSE)
   obj_analyseBIN &lt;- analyseBINdata(obj_pickBIN, nfchn=4, nlchn=20) 
   #obj_analyseBIN &lt;- analyseBINdata0(obj_pickBIN, fchn=1:4, nlchn=231:250)
   obj_analyseBIN$SARdata
</code></pre>

<hr>
<h2 id='as_analyseBIN'>
Transfom SAR data sets into S3 class object &quot;analyseBIN&quot;
</h2><span id='topic+as_analyseBIN'></span><span id='topic+as_analyseBIN.default'></span>

<h3>Description</h3>

<p>Transfom SAR data sets into S3 class object &quot;analyseBIN&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_analyseBIN(SARdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_analyseBIN_+3A_sardata">SARdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): SAR data set, it should contain five columns<br />
(i.e., <code>NO</code>, <code>SAR.Cycle</code>, <code>Dose</code>, <code>Signal</code>, and <code>Signal.Err</code>), see <a href="#topic+SARdata">SARdata</a> for details</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> of S3 class object &quot;analyseBIN&quot; containing the following elements:
</p>
<table>
<tr><td><code>SARdata</code></td>
<td>
<p>a <a href="base.html#topic+data.frame">data.frame</a> containing SAR data sets</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>values used as rejection criteria, here it is set equal to <code>NULL</code></p>
</td></tr>
<tr><td><code>Tn</code></td>
<td>
<p>values of Tn and associated standard errors, here it is set equal to <code>NULL</code></p>
</td></tr>
<tr><td><code>LnTn.curve</code></td>
<td>
<p>decay curves of Ln and Tn for different aliquots (grains), here it is set equal to <code>NULL</code></p>
</td></tr>
<tr><td><code>TxTn</code></td>
<td>
<p>ratios of Tx to Tn for various SAR cycles, here it is set equal to <code>NULL</code></p>
</td></tr>
<tr><td><code>agID</code></td>
<td>
<p>aliquot or grain ID (i.e., <code>NO</code>, <code>Position</code>, and <code>Grain</code>), here both <code>Position</code> and <code>Grain</code> are set equal to 0</p>
</td></tr>
</table>
<p><code>SARdata</code> is a <a href="base.html#topic+data.frame">data.frame</a> containing the following elements:
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Element</b>      </td><td style="text-align: left;">  <b>Description</b>                             </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>NO</code>           </td><td style="text-align: left;">  aliquot (grain) number                         </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>SAR.Cycle</code>    </td><td style="text-align: left;">  SAR cycle (N, R1, R2, R3, ...)                 </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>Dose</code>         </td><td style="text-align: left;">  regenerative dose                              </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Signal</code>       </td><td style="text-align: left;">  OSL signal                                     </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Signal.Err</code>   </td><td style="text-align: left;">  standard error of OSL signal                                  
</td>
</tr>

</table>



<h3>Note</h3>

<p>Function <a href="#topic+as_analyseBIN">as_analyseBIN</a> transforms SAR data sets (see <a href="#topic+SARdata">SARdata</a>) into S3 class object &quot;analyseBIN&quot;. 
The returned elements such as <code>criteria</code>, <code>Tn</code>, <code>LnTn.curve</code>, and <code>TxTn</code> are set equal to <code>NULL</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+analyseBINdata">analyseBINdata</a>; <a href="#topic+SARdata">SARdata</a>; <a href="#topic+calSARED">calSARED</a>; <a href="#topic+pickSARdata">pickSARdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ### Example 1:
  data(SARdata)
  obj_analyseBIN &lt;- as_analyseBIN(SARdata[1:8,,drop=FALSE])
  res_calSARED &lt;- calSARED(obj_analyseBIN)
  res_calSARED$sarED

  ### Example 2 (not run):
  # obj_analyseBIN &lt;- as_analyseBIN(SARdata)
  # res_calSARED &lt;- calSARED(obj_analyseBIN, rcy1.range=c(1,1), outpdf="SARED")

  ### Example 3 (not run):
  # obj_analyseBIN &lt;- as_analyseBIN(SARdata)
  # res_pickSARdata &lt;- pickSARdata(obj_analyseBIN, fom.up=6, outpdf="SARdata")
  # res_pickSARdata$SARdata
</code></pre>

<hr>
<h2 id='BIN'>
BIN data
</h2><span id='topic+BIN'></span>

<h3>Description</h3>

<p>BIN data for aeolian sample GL2-1 from the south margin of the Tengger Desert (Peng et al., 2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BIN)</code></pre>


<h3>Format</h3>

<p>A S3 class object &quot;loadBIN&quot; produced by function <a href="#topic+loadBINdata">loadBINdata</a> that contains the following two elements:
</p>

<dl>
<dt>records</dt><dd><p>a <a href="base.html#topic+list">list</a> consists of loaded data records for each aliquot (grain)</p>
</dd>
<dt>tab</dt><dd><p>a <a href="base.html#topic+data.frame">data.frame</a> used for summarizing loaded data records</p>
</dd>
</dl>



<h3>References</h3>

<p>Peng J, Han FQ, 2013. Selections of fast-component OSL signal using sediments from the south edge of Tengger Desert. 
Acta Geoscientica Sinica, 34(6): 757-762.
</p>


<h3>See Also</h3>

<p><a href="#topic+loadBINdata">loadBINdata</a>; <a href="#topic+pickBINdata">pickBINdata</a>; <a href="#topic+analyseBINdata">analyseBINdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Not run.
 # data(BIN)
 # class(BIN)
</code></pre>

<hr>
<h2 id='calDA'>
Dose rate and age calculation
</h2><span id='topic+calDA'></span><span id='topic+calDA.default'></span><span id='topic+calDAbatch'></span><span id='topic+calDAbatch.default'></span>

<h3>Description</h3>

<p>Calculating the total dose rate and burial age and assessing associated standard errors using a Monte Carlo method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calDA(dose, minGrainSize, maxGrainSize,
      Ucontent, Thcontent, Kcontent, Rbcontent, Wct, depth, longitude, 
      latitude, altitude, alphaValue = 0, inKcontent = 0, inRbcontent = 0, 
      calRbfromK = FALSE, bulkDensity = 2.5, cfType = "Liritzis2013", rdcf = 0, 
      rba = 0, ShallowGamma = TRUE, nsim = 5000, reject = TRUE, plot = TRUE, 
      sampleName = "") 

calDAbatch(inputfile = "inputDRtable", cfType = "Liritzis2013", 
           rdcf = 0, rba = 0, calRbfromK = FALSE,  
           ShallowGamma = TRUE,  nsim = 5000, reject = TRUE, 
           outfile = paste(inputfile,"_Results",sep=""), 
           outpdf = paste(inputfile,"_Results",sep=""), digits = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calDA_+3A_dose">dose</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): a two-element vector containing the equivalent dose and associated measurement error (unit, Gy)</p>
</td></tr>
<tr><td><code id="calDA_+3A_mingrainsize">minGrainSize</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): lower limit on grain size (unit, um)</p>
</td></tr>
<tr><td><code id="calDA_+3A_maxgrainsize">maxGrainSize</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): upper limit on grain size (unit, um)</p>
</td></tr>
<tr><td><code id="calDA_+3A_ucontent">Ucontent</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): a two-element vector containing the uranium content and its measurement error (unit, ppm)</p>
</td></tr>
<tr><td><code id="calDA_+3A_thcontent">Thcontent</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): a two-element vector containing the thorium content and its measurement error (unit, ppm)</p>
</td></tr>
<tr><td><code id="calDA_+3A_kcontent">Kcontent</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): a two-element vector containing the potassium content and its measurement error (unit, percent)</p>
</td></tr>
<tr><td><code id="calDA_+3A_rbcontent">Rbcontent</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): the rubidium content (unit, ppm). The measurement error is optional</p>
</td></tr>  
<tr><td><code id="calDA_+3A_wct">Wct</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): a two-element vector containing the water content and its measurement error (unit, percent)</p>
</td></tr>
<tr><td><code id="calDA_+3A_depth">depth</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): sampling depth (unit, m). The associated error is optional</p>
</td></tr>
<tr><td><code id="calDA_+3A_longitude">longitude</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): longitude of the sampling site (unit, decimal degree). The associated error is optional</p>
</td></tr>
<tr><td><code id="calDA_+3A_latitude">latitude</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): latitude of the sampling site (unit, decimal degree). The associated error is optional</p>
</td></tr>
<tr><td><code id="calDA_+3A_altitude">altitude</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): altitude of the sampling site (unit, m above sea level). The associated error is optional</p>
</td></tr>
<tr><td><code id="calDA_+3A_alphavalue">alphaValue</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): average alpha efficiency. The associated error is optional, for example, <code>alphaValue=0.038</code> or <code>alphaValue=c(0.038,0.002)</code></p>
</td></tr>
<tr><td><code id="calDA_+3A_inkcontent">inKcontent</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): internal potassium content (unit, percent). The associated error is optional, for example, <code>inKcontent=12.5</code>, or <code>inKcontent=c(12.5,0.5)</code></p>
</td></tr>
<tr><td><code id="calDA_+3A_inrbcontent">inRbcontent</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): internal rubidium content (unit, ppm). The associated error is optional, for example, <code>inRbcontent=400</code>, or <code>inRbcontent=c(400,100)</code></p>
</td></tr>
<tr><td><code id="calDA_+3A_calrbfromk">calRbfromK</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): whether calculate the rubidium and internal rubidium contents using the provided potassium and internal potassium contents respectively.  
If <code>calRbfromK=TRUE</code>, the provided rubidium and/or internal rubidium contents will not be used for dose-rate calculation</p>
</td></tr>
<tr><td><code id="calDA_+3A_bulkdensity">bulkDensity</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): average density of bulk sample (unit, g/cm^3).<br /> The associated error is optional, for example, <code>bulkDensity=2.5</code>,<br /> 
or <code>bulkDensity=c(2.5,0.2)</code></p>
</td></tr>
<tr><td><code id="calDA_+3A_cftype">cfType</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): type of the conversion factor, one from<br /> <code>"AdamiecAitken1998"</code>, <code>"Guerin2011"</code>, and <code>"Liritzis2013"</code></p>
</td></tr>
<tr><td><code id="calDA_+3A_rdcf">rdcf</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): constant relative standard error (RSD) for dose-rate conversion factors (unit, percent). If <code>rdcf=0</code>, the dose-rate conversion factors will be assummed to be perfectly determined, otherwise their errors calculated using the constant RSD will be accounted for during the Monte Carlo simulation. Since the conversion factors of <code>"Liritzis2013"</code> contain measured standard errors, when <code>cfType="Liritzis2013"</code>, a positive <code>rdcf</code> value indicates that the measured errors will be accounted for during simulation</p>
</td></tr>
<tr><td><code id="calDA_+3A_rba">rba</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): constant RSD for alpha and beta dose absorption fractions (unit, percent). If <code>rba=0</code>, the determined alpha and beta dose attenuation factors will be assummed to be free from errors</p>
</td></tr>
<tr><td><code id="calDA_+3A_shallowgamma">ShallowGamma</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): consider the scaling of gamma dose rate for samples collected at shallow burial depths or not</p>
</td></tr>
<tr><td><code id="calDA_+3A_nsim">nsim</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): number of Monte Carlo simulations</p>
</td></tr>
<tr><td><code id="calDA_+3A_reject">reject</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): whether randomly generated negative values of variables (including equivalent dose, uranium, thorium, potassium, and water contents, alpha efficiency, and bulk-sample density, etc) and meaningless values (longitude beyonds <code>[-180,180]</code>, or latitude beyonds <code>[-90,90]</code>) will be reject during the Monte Carlo simulation</p>
</td></tr>
<tr><td><code id="calDA_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): draw a plot showing the simulated distributions of dose rates and ages or not</p>
</td></tr>
<tr><td><code id="calDA_+3A_samplename">sampleName</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): name of the sample</p>
</td></tr>
<tr><td><code id="calDA_+3A_inputfile">inputfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): name of the input file containing measured dataset of individual samples used for dose rate and age calculations</p>
</td></tr>
<tr><td><code id="calDA_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): name of the files containing the results of calculated dose rates and ages for a number of samples. The files will be written using CSV/HTML format and saved to the current work directory</p>
</td></tr>
<tr><td><code id="calDA_+3A_outpdf">outpdf</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): name of a PDF file showing the distributions of dose rates and ages simulated using a Monte Carlo method for a number of samples. The file will be saved to the current work directory</p>
</td></tr>
<tr><td><code id="calDA_+3A_digits">digits</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default):  the number of decimal places or significant digits to be used for values of the output CSV/HTML files</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+calDA">calDA</a> is used for calculating the annual dose rate and burial age using the concentrations of radioactive nuclides (uranium, thorium, potassium) obtained from Neutron Activation Analysis (NAA) or inductively coupled plasma mass spectrometry (ICP-MS), grain size, water content, average sample density, geographical parameters (depth, longitude, latitude, altitude), and the equivalent dose. The elemental concentrations of uranium, thorium, and potassium are converted into alpha, bata, and gamma dose rates according to dose-rate conversion factors (Adamiec and Aitken, 1998; Guerin et al., 2011; Liritzis et al., 2013). Alpha and beta dose absorded fractions are determined using published data (Mejdahl, 1979; Brennan et al., 1991). The contribution of the internal beta dose rate can be assessed if the internal potassium content is provided. The gamma dose rate for samples collected at shallow depths are corrected using the scaling factors of Aitken (1985). The cosmic ray dose rate is estimated as a function of depth, altitude and geomagnetic latitude (Prescott and Hutton, 1994) and the contribution to cosmic dose rate from a soft component is considered at shallow depths (Barbouti and Rastin, 1983).<br /><br />
The hydrofluoric acid-etched quartz and K-feldspar samples have an alpha efficiency of zero, while the reported alpha values of un-etched coarse-grained quartz and K-feldspar are <code class="reqn">0.1\pm0.02</code> (Olley et al., 1998) and <code class="reqn">0.15\pm0.05</code> (Balescu and Lamothe, 1994), respectively. Three reported alpha values for fine-grained quartz are <code class="reqn">0.038\pm0.002</code> (Rees-Jones, 1995), <code class="reqn">0.04\pm0.01</code> (Rees-Jones and Tite, 1997), and <code class="reqn">0.035\pm0.003</code> (Lai et al., 2008). Two reported alpha values for fine-grained polymineral are <code class="reqn">0.086\pm0.004</code> (Rees-Jones, 1995) and <code class="reqn">0.09\pm0.02</code> (Kreutzer et al., 2014). Huntley and Hancock (2001) assumed an internal rubidium content of <code class="reqn">400\pm100</code> ppm. Three reported internal potassium contents are <code class="reqn">12.5\pm0.5\%</code> (Huntley and Baril, 1997), <code class="reqn">13\pm1\%</code> (Zhao and Li, 2005), and <code class="reqn">10\pm2\%</code> (Smedley et al., 2012).<br /><br /> 
The standard error of the age and dose rate is estimated by a &quot;parametric bootstrap&quot; method (Peng et al., 2016). Constant relative standard errors for dose-rate conversion factors, alpha and beta dose absorption factors can be assummed during the simulation. Arguments such as <code>dose</code>, <code>Ucontent</code>, <code>Thcontent</code>, <code>Kcontent</code>, <code>Wct</code> should be two-element vectors representing paired values of <code class="reqn">\mu\pm\sigma</code>, where <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> denote the measured value and associated standard error, respectively. Arguments such as <code>depth</code>, <code>longitude</code>, <code>latitude</code>, <code>altitude</code>, <code>alphaValue</code>, <code>Rbcontent</code>, <code>inKcontent</code>, <code>inRbcontent</code>, and <code>bulkDensity</code>, can be either a scalar or a two-element vector. This means that uncertainties from these quantities can be either ignored or taken into account during the simulation.<br /><br />
Function <a href="#topic+calDAbatch">calDAbatch</a> is a wrapper of the function <a href="#topic+calDA">calDA</a> and is used to calculate the dose rates and burial ages for a number of samples in a batch mode. The function requires as input a CSV file containing dose-rate datasets of different samples that are saved row by row. A template of the input CSV file with the name <code>"myDRdata"</code> can be generated using the command <code>calDAbatch("myDRdata")</code><br />(see examples).
</p>


<h3>Value</h3>

<p>Function <a href="#topic+calDA">calDA</a> returns a <a href="base.html#topic+matrix">matrix</a> that contains calculated alpha, beta, gamma, cosmic, and total dose rate and age and associated standard errors, lower and upper bounds of 95 percent confidence intervals for the sample under considered.<br />
Function <a href="#topic+calDAbatch">calDAbatch</a> returns an invisible <a href="base.html#topic+list">list</a> that contains calculated dose-rate results for each of the provided samples. 
</p>


<h3>Author(s)</h3>

<p>Orignal R code written by Jun Peng, improved version of code written by Chunxin Wang
</p>


<h3>References</h3>

<p>Adamiec G, Aitken M, 1998. Dose-rate conversion factors: update. Ancient TL, 16(2): 37-49.
</p>
<p>Aitken MJ, 1985. Thermoluminescence Dating. Academic Press, London.
</p>
<p>Balescu S, Lamothe M, 1994. Comparison of TL and IRSL age estimates of feldspar coarse grains from waterlain sediments. Quaternary Science Reviews, 13: 437-444.
</p>
<p>Barbouti AI, Rastin BC, 1983. A study of the absolute intensity of muons at sea level and under various thicknesses of absorber. Journal of Physics G Nuclear Physics, 9: 1577e1595.
</p>
<p>Brennan BJ, Lyons RG, Phillips SW, 1991. Attenuation of alpha particle track dose for spherical grains. International Journal of Radiation Application and Instrumentation. Part D. Nuclear Tracks and Radiation Measurements, 18: 249-253.
</p>
<p>Guerin G, Mercier N, Adamiec G, 2011. Dose-rate conversion factors: update. Ancient TL, 29: 5-8.
</p>
<p>Huntley DJ, Baril M, 1997. The K content of the K-feldspars being measured in optical dating or in thermoluminescence dating. Ancient TL, 15: 11-13.
</p>
<p>Huntley DJ, Hancock R, 2001. The Rb contents of the K-feldspar grains being measured in optical dating. Ancient TL, 19: 43-46.
</p>
<p>Kreutzer S, Schmidt C, DeWitt R, Fuchs M, 2014. The a-value of polymineral fine grain samples measured with the post-IR IRSL protocol. Radiation Measurements, 69: 18-29.
</p>
<p>Lai ZP, Zoller L, Fuchs M, Bruckner H, 2008. Alpha efficiency determination for OSL of quartz extracted from Chinese loess. Radiation Measurements, 43: 767-770. 
</p>
<p>Liritzis I, Stamoulis K, Papachristodoulou C, Ioannides K, 2013. A re-evaluation of radiation dose-rate conversion factors. Mediterranean Archaeology and Archaeometry, 13: 1-15.
</p>
<p>Mejdahl V, 1979. Thermoluminescence dating: beta-dose attenuation in quartz grains. Archaeometry, 21: 61-72.
</p>
<p>Olley J, Caitcheon G, Murray A, 1998. The distribution of apparent dose as determined by Optically Stimulated Luminescence in small aliquots of fluvial quartzImplications for dating young sediments. Quaternary Science Reviews, 17: 1033-1040. 
</p>
<p>Prescott, JR, Hutton JT, 1994. Cosmic ray contributions to dose rates for Luminescence and Esr dating: large depths and long-term time variations. Radiation Measurements, 23(2-3): 497-500.
</p>
<p>Peng J, Dong ZB, Zhang ZC, 2016. Determining the error of dose rate estimates on luminescence dating using Monte Carlo approach. Nuclear Techniques, 38(7): 070201. (In Chinese).
</p>
<p>Rees-Jones J, 1995. Optical dating of young sediments using fine-grained quartz. Ancient TL, 13: 9-14.
</p>
<p>Rees-Jones J, Tite MS, 1997. Optical dating results for British archaeological sediments. Archaeometry, 39: 177-187.
</p>
<p>Smedley RK, Duller GAT, Pearce NJG, Roberts HM, 2012. Determining the K-content of single-grains of feldspar for luminescence dating. Radiation Measurements, 47: 790-796.
</p>
<p>Zhao H, Li SH, 2005. Internal dose rate to K-feldspar grains from radioactive elements other than potassium. Radiation Measurements, 40: 84-93.
</p>
<p><b>Further reading</b>
</p>
<p>Durcan JA, King GE, Duller GAT, 2015. DRAC: Dose Rate and Age Calculator for trapped charge dating. Quaternary Geochronology, 28: 54-61.
</p>
<p>Grun R, 2009. The &quot;AGE&quot; program for the calculation of luminescence age estimates. Ancient TL, 27: 45-46.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calDA(dose=c(25.04,0.68), minGrainSize=90,
      maxGrainSize=180, Ucontent=c(2.86,0.19),
      Thcontent=c(8.63,0.34), Kcontent=c(2.00,0.11), Rbcontent=0,
      Wct=c(0.05,0.05), depth=c(1.1,0.05), longitude=c(103.16,0.1),
      latitude=c(37.64,0.1), altitude=c(1170,58.5), bulkDensity=c(2.5,0.1), 
      rdcf=0.03, rba=0.03) 

# Not run.
# Generate a template of input CSV file "myDRdata" using the following command.
# calDAbatch(inputfile="myDRdata")

# Put your dose rate dataset into the above generated template file "myDRdata.csv", then run 
# the following command to calculate dose rates and ages for your samples in a batch mode.
# d &lt;- calDAbatch(inputfile="myDRdata", nsim=3000)
# idx &lt;- sapply(d, is.matrix)
# h &lt;- t(sapply(d[idx],function(x) c(t(x[6:7,1:2]))))
# colnames(h) &lt;- c("DR","Se.DR","Age","Se.Age")
# print(h)
</code></pre>

<hr>
<h2 id='calED'>
Equivalent dose calculation and error assessment
</h2><span id='topic+calED'></span><span id='topic+calED.default'></span>

<h3>Description</h3>

<p>Calculating an equivalent dose and assessing its standard error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calED(Curvedata, Ltx, model = "gok", origin = FALSE, 
      errMethod = "sp", nsim = 500, weight = TRUE,  
      trial = FALSE, plot = TRUE, nofit.rgd = NULL, 
      agID = NULL, Tn = NULL, Tn3BG = NULL, 
      TnBG.ratio = NULL, rseTn = NULL, FR = NULL, 
      LnTn.curve = NULL, TxTn = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calED_+3A_curvedata">Curvedata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a three-column matrix (i.e., regenerative doses,<br />
sensitivity-corrected regenerative-dose signals, and associated standard errors)</p>
</td></tr>
<tr><td><code id="calED_+3A_ltx">Ltx</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): a two-element vector consists of sensitivity-corrected<br />
natural-dose signal and its error</p>
</td></tr>
<tr><td><code id="calED_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): model used for growth curve fitting, see <a href="#topic+fitGrowth">fitGrowth</a> for available models</p>
</td></tr>
<tr><td><code id="calED_+3A_origin">origin</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be forced to pass the origin</p>
</td></tr>
<tr><td><code id="calED_+3A_errmethod">errMethod</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): method used for equivalent dose error assessment.<br />
<code>"sp"</code> and <code>"mc"</code> denote error estimation using the Simple Transformation and Monte Carlo methods, respectively</p>
</td></tr>
<tr><td><code id="calED_+3A_nsim">nsim</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): desired number of randomly simulated equivalent dose obtained by Monte Carlo simulation</p>
</td></tr>
<tr><td><code id="calED_+3A_weight">weight</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using a weighted procedure, see function <a href="#topic+fitGrowth">fitGrowth</a> for details</p>
</td></tr>
<tr><td><code id="calED_+3A_trial">trial</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using other models if the given model fails, see function <a href="#topic+fitGrowth">fitGrowth</a> for details</p>
</td></tr>
<tr><td><code id="calED_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the results should be plotted</p>
</td></tr>
<tr><td><code id="calED_+3A_nofit.rgd">nofit.rgd</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(optional): regenerative doses that will not be used during the fitting. 
For example, if <code>nofit.rgd=1</code> then the first regenerative dose will not be used during growth curve fitting</p>
</td></tr>
<tr><td><code id="calED_+3A_agid">agID</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a three-elemenet vector indicating aliquot (grain) ID, i.e.,<br />
<code>agID[1]=NO</code>, <code>agID[2]=Position</code>, <code>agID[3]=Grain</code></p>
</td></tr>
<tr><td><code id="calED_+3A_tn">Tn</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of Tn</p>
</td></tr>  
<tr><td><code id="calED_+3A_tn3bg">Tn3BG</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): 0-1 value indicating if Tn is more than 3 sigma above BG,<br />
1 indicates Tn&gt;3_sigma_BG, 0 indicates Tn&lt;=3_sigma_BG</p>
</td></tr>
<tr><td><code id="calED_+3A_tnbg.ratio">TnBG.ratio</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of ratio of initial Tn signal to BG</p>
</td></tr> 
<tr><td><code id="calED_+3A_rsetn">rseTn</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): relative standard error of Tn in percent</p>
</td></tr>
<tr><td><code id="calED_+3A_fr">FR</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of fast ratio of Tn</p>
</td></tr>  
<tr><td><code id="calED_+3A_lntn.curve">LnTn.curve</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(optional): decay curve data for Ln and Tn, it should contain four elements,<br /> 
i.e., <code>names(LnTn.curve)=c("Ln.x","Ln.y","Tn.x","Tn.y")</code></p>
</td></tr>
<tr><td><code id="calED_+3A_txtn">TxTn</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): ratios of Tx to Tn for various SAR cycles</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+calED">calED</a> is used for calculating an equivalent dose and assessing its standard error.
The standard errors of an equivalent dose can be assessd using the Simple Transformation or Monte Carlo method (Duller, 2007).<br /><br />
Interpolation is performed using a combination of golden section search and successive parabolic interpolation (<b><em>R</em></b> function <a href="stats.html#topic+optimize">optimize</a> in package <b><em>stats</em></b>) (freely available Fortran 77 source code at <a href="https://www.netlib.org/fmm/fmin.f">https://www.netlib.org/fmm/fmin.f</a>). See function <a href="#topic+fitGrowth">fitGrowth</a> for more details on growth curve fitting.
</p>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>message</code></td>
<td>
<p>return 0 if calculation succeeds, 1 if growth curve fitting fails, 2 if natural-dose signal saturates, 
3 if equivalent dose calculation fails, 4 if equivalent dose error assessment fails</p>
</td></tr>
<tr><td><code>fitIDX</code></td>
<td>
<p>Indices of dose points used in growth curve fitting</p>
</td></tr>
<tr><td><code>LMpars</code></td>
<td>
<p>optimized parameters for the growth curve</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>minimized objective for the growth curve</p>
</td></tr>
<tr><td><code>avg.error</code></td>
<td>
<p>average fit error for the growth curve</p>
</td></tr>
<tr><td><code>RCS</code></td>
<td>
<p>reduced chi-square value for the growth curve</p>
</td></tr>
<tr><td><code>FOM</code></td>
<td>
<p>figure of merit value for the growth curve in percent</p>
</td></tr>
<tr><td><code>calED.method</code></td>
<td>
<p>method used for equivalent dose calculation, i.e.,<br />
<code>"Interpolation"</code> or <code>"Extrapolation"</code></p>
</td></tr>
<tr><td><code>mcED</code></td>
<td>
<p>randomly simulated equivalent doses</p>
</td></tr>
<tr><td><code>ED</code></td>
<td>
<p>calculated equivalent dose and its standard error</p>
</td></tr>
<tr><td><code>ConfInt</code></td>
<td>
<p>68 percent and 95 percent confidence intervals for the equivalent dose</p>
</td></tr>
<tr><td><code>RecyclingRatio1</code></td>
<td>
<p>the first recycling ratio and its standard error</p>
</td></tr>
<tr><td><code>RecyclingRatio2</code></td>
<td>
<p>the second recycling ratio and its standard error</p>
</td></tr>
<tr><td><code>RecyclingRatio3</code></td>
<td>
<p>the third recycling ratio and its standard error</p>
</td></tr>
<tr><td><code>Recuperation1</code></td>
<td>
<p>the first recuperation (i.e., ratio of the sensitivity-corrected zero-dose signal to natural-dose signal) 
and its standard error in percent</p>
</td></tr>
<tr><td><code>Recuperation2</code></td>
<td>
<p>the second recuperation (i.e., ratio of the sensitivity-corrected zero-dose signal to maximum regenerative-dose signal) 
and its standard error in percent</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Arguments <code>agID</code>, <code>Tn</code>, <code>Tn3BG</code>, <code>TnBG.ratio</code>, <code>rseTn</code>, <code>FR</code>, <code>LnTn.curve</code>, 
and <code>TxTn</code> have nothing to do with equivalent dose calculation. They are used only for plotting purpose.<br /><br />
Argument <code>Tn3BG</code> indicates if Tn (after background subtraction) is more than 3 sigma above BG, while argument <code>TnBG.ratio</code> denotes the ratio of Tn (no background subtraction) to BG.<br /><br />
Function <a href="#topic+calED">calED</a> will return <code>message=3</code> (i.e.,<code>"Failed in equivalent dose calculation"</code>) if the equivalent dose to be calculated below -50 (&lt;Gy&gt;|&lt;s&gt;).<br /><br />
68 percent (one sigma) and 95 percent (two sigma) confidence intervals of equivalent doses will be determined respectively using normal approximation and Monte Carlo simulation,<br />
for <code>errMethod="sp"</code> and <code>errMethod="mc"</code>.<br /><br />
Function <code>sgcED</code> in previous versions was bundled to function <a href="#topic+calSGCED">calSGCED</a>.
</p>


<h3>References</h3>

<p>Duller GAT, 2007. Assessing the error on equivalent dose estimates derived from single aliquot regenerative dose measurements. Ancient TL, 25(1): 15-24.
</p>
<p>Duller GAT, 2016. Analyst (v4.31.9), User Mannual.
</p>
<p>Galbraith RF, Roberts RG, 2012. Statistical aspects of equivalent dose and error calculation and display in OSL dating: an overview and some recommendations. Quaternary Geochronology, 11: 1-27.
</p>


<h3>See Also</h3>

<p><a href="#topic+analyseBINdata">analyseBINdata</a>; <a href="#topic+fitGrowth">fitGrowth</a>; <a href="#topic+calRcyRcp">calRcyRcp</a>; <a href="#topic+calSARED">calSARED</a>; <a href="#topic+fastED">fastED</a>; <a href="#topic+calSGCED">calSGCED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ### Example 1:
  Curvedata &lt;- cbind(c(0, 18, 36, 54, 72, 0, 18),               
                    c(0.026, 1.55, 2.39, 3.46, 4.13, 0.023, 1.61),  
                    c(0.005, 0.11, 0.27, 0.22, 0.20, 0.008, 0.24))                         
  Ltx &lt;- c(3.1,0.31)
  calED(Curvedata, Ltx, model="exp", origin=FALSE)
  
  ### Example 2 (not run):
  # data(BIN)
  # obj_pickBIN &lt;- pickBINdata(BIN, Position=48, 
  #                            LType="OSL", view=FALSE)
  # obj_analyseBIN &lt;- analyseBINdata(obj_pickBIN, nfchn=3, nlchn=20)
  # Curvedata &lt;- obj_analyseBIN$SARdata[-1,3:5]
  # Ltx &lt;- as.numeric(obj_analyseBIN$SARdata[1,4:5])
  # calED(Curvedata, Ltx, model="gok", origin=FALSE)
 
</code></pre>

<hr>
<h2 id='calRcyRcp'>
Recycling ratio and recuperation calculation
</h2><span id='topic+calRcyRcp'></span><span id='topic+calRcyRcp.default'></span>

<h3>Description</h3>

<p>Calculating recycling ratio, recuperation, and associated standard errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calRcyRcp(Curvedata, Ltx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calRcyRcp_+3A_curvedata">Curvedata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a three-column matrix (i.e., regenerative doses,<br />
sensitivity-corrected regenerative-dose signals, and associated standard errors)</p>
</td></tr>
<tr><td><code id="calRcyRcp_+3A_ltx">Ltx</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): a two-element vector consists of sensitivity-corrected<br />
natural-dose signal and its error</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>RecyclingRatio1</code></td>
<td>
<p>the first recycling ratio and its standard error</p>
</td></tr>
<tr><td><code>RecyclingRatio2</code></td>
<td>
<p>the second recycling ratio and its standard error</p>
</td></tr>
<tr><td><code>RecyclingRatio3</code></td>
<td>
<p>the third recycling ratio and its standard error</p>
</td></tr>
<tr><td><code>Recuperation1</code></td>
<td>
<p>the first recuperation (i.e., ratio of the sensitivity-corrected zero-dose signal to natural-dose signal) 
and its standard error in percent</p>
</td></tr>
<tr><td><code>Recuperation2</code></td>
<td>
<p>the second recuperation (i.e., ratio of the sensitivity-corrected zero-dose signal to maximum regenerative-dose signal) 
and its standard error in percent</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the sensitivity-corrected signals for the frist, second, and third repeated regenerative doses are R1, R2, and R3, respectively, 
then <code>RecyclingRatio1=R2/R1</code>, <code>RecyclingRatio2=R3/R1</code>, and <br />
<code>RecyclingRatio3=R3/R2</code>.
</p>


<h3>References</h3>

<p>Wintle AG, Murray AS, 2006. A review of quartz optically stimulated luminescence characteristics and
their relevance in single-aliquot regeneration dating protocols. Radiation Measurements, 41(4): 369-391.
</p>


<h3>See Also</h3>

<p><a href="#topic+calED">calED</a>; <a href="#topic+fastED">fastED</a>;
<a href="#topic+calSARED">calSARED</a>; <a href="#topic+pickSARdata">pickSARdata</a>
</p>

<hr>
<h2 id='calSARED'>
SAR equivalent doses calculation and selection
</h2><span id='topic+calSARED'></span><span id='topic+calSARED.default'></span>

<h3>Description</h3>

<p>Calculating and selecting a series of equivalent doses in a batch mode according to the single aliquot regenerative-dose (SAR) method (Murray and Wintle, 2000).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calSARED(obj_analyseBIN, model = "gok", origin = FALSE, 
         errMethod = "sp", nsim = 500, weight = TRUE, 
         trial = TRUE, nofit.rgd = NULL, Tn.above.3BG = TRUE, 
         TnBG.ratio.low = NULL, rseTn.up = NULL, FR.low = NULL, 
         rcy1.range = NULL, rcy2.range = NULL, rcy3.range = NULL, 
         rcp1.up = NULL, rcp2.up = NULL, fom.up = NULL, 
         rcs.up = NULL, calED.method = NULL, rseED.up = NULL, 
         use.se = TRUE, outpdf = NULL, outfile = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calSARED_+3A_obj_analysebin">obj_analyseBIN</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(<b>required</b>): an object of S3 class &quot;analyseBIN&quot; produced by<br /> 
function <a href="#topic+analyseBINdata">analyseBINdata</a> or <a href="#topic+as_analyseBIN">as_analyseBIN</a></p>
</td></tr>
<tr><td><code id="calSARED_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): model used for growth curve fitting, see <a href="#topic+fitGrowth">fitGrowth</a> for available models</p>
</td></tr>
<tr><td><code id="calSARED_+3A_origin">origin</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be forced to pass the origin</p>
</td></tr>
<tr><td><code id="calSARED_+3A_errmethod">errMethod</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): method used for equivalent dose error assessment. See function <a href="#topic+calED">calED</a> for details</p>
</td></tr>
<tr><td><code id="calSARED_+3A_nsim">nsim</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): desired number of randomly simulated equivalent dose obtained by Monte Carlo simulation</p>
</td></tr>
<tr><td><code id="calSARED_+3A_weight">weight</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using a weighted procedure, see function <a href="#topic+fitGrowth">fitGrowth</a> for details</p>
</td></tr>
<tr><td><code id="calSARED_+3A_trial">trial</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using other models if the given model fails, see function <a href="#topic+fitGrowth">fitGrowth</a> for details</p>
</td></tr>
<tr><td><code id="calSARED_+3A_nofit.rgd">nofit.rgd</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(optional): regenerative doses that will not be used during the fitting. 
For example, if <code>nofit.rgd=6</code> then the sixth regenerative dose will not be used during growth curve fitting</p>
</td></tr>
<tr><td><code id="calSARED_+3A_tn.above.3bg">Tn.above.3BG</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if aliquot (grain) with Tn below 3 sigma BG should be rejected</p>
</td></tr>
<tr><td><code id="calSARED_+3A_tnbg.ratio.low">TnBG.ratio.low</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): lower limit on ratio of initial Tn signal to BG</p>
</td></tr>
<tr><td><code id="calSARED_+3A_rsetn.up">rseTn.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on relative standard error of Tn in percent</p>
</td></tr>
<tr><td><code id="calSARED_+3A_fr.low">FR.low</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): lower limit on fast ratio of Tn</p>
</td></tr>
<tr><td><code id="calSARED_+3A_rcy1.range">rcy1.range</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector indicating the lower and upper limits on recycling ratio 1, 
Example: <code>rcy1.range=c(0.9,1.1)</code></p>
</td></tr>
<tr><td><code id="calSARED_+3A_rcy2.range">rcy2.range</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector indicating the lower and upper limits on recycling ratio 2</p>
</td></tr>
<tr><td><code id="calSARED_+3A_rcy3.range">rcy3.range</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector indicating the lower and upper limits on recycling ratio 3</p>
</td></tr>
<tr><td><code id="calSARED_+3A_rcp1.up">rcp1.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on recuperation 1 (i.e., ratio of the<br />
sensitivity-corrected zero-dose signal to natural-dose signal) in percent</p>
</td></tr>
<tr><td><code id="calSARED_+3A_rcp2.up">rcp2.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on recuperation 2 (i.e., ratio of the<br />
sensitivity-corrected zero-dose signal to maximum regenerative-dose signal)<br />
in percent</p>
</td></tr>
<tr><td><code id="calSARED_+3A_fom.up">fom.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on figure of merit (FOM) values of growth curves in percent</p>
</td></tr>
<tr><td><code id="calSARED_+3A_rcs.up">rcs.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on reduced chi-square (RCS) values of growth curves</p>
</td></tr>
<tr><td><code id="calSARED_+3A_caled.method">calED.method</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): method used for equivalent dose calculation, i.e.,<br />
<code>"Interpolation"</code> or <code>"Extrapolation"</code></p>
</td></tr>
<tr><td><code id="calSARED_+3A_rseed.up">rseED.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on the relative standard error of equivalent dose in percent</p>
</td></tr>
<tr><td><code id="calSARED_+3A_use.se">use.se</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if standard errors of values should be used during application of rejection criteria</p>
</td></tr>
<tr><td><code id="calSARED_+3A_outpdf">outpdf</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, results of SAR equivalent dose calculation will be written to a PDF file named <code>"outpdf"</code> and saved to the current work directory</p>
</td></tr>
<tr><td><code id="calSARED_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, SAR equivalent doses related quantities will be written
to a CSV file named <code>"outfile"</code> and saved to the current work directory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>LMpars</code></td>
<td>
<p>a <a href="base.html#topic+list">list</a> containing optimized parameters of growth curves of calculated (selected) SAR equivalent doses</p>
</td></tr>
<tr><td><code>Tn</code></td>
<td>
<p>values and standard errors of Tn of calculated (selected) SAR equivalent doses</p>
</td></tr>
<tr><td><code>Ltx</code></td>
<td>
<p>sensitivity-corrected natural-dose signals and associated standard errors used for SAR equivalent dose calculation</p>
</td></tr> 
<tr><td><code>sarED</code></td>
<td>
<p>calculated (selected) SAR equivalent doses and associated standard errors</p>
</td></tr>
<tr><td><code>ConfInt</code></td>
<td>
<p>68 percent (one sigma) and 95 percent (two sigma) confidence intervals of SAR equivalent doses</p>
</td></tr>
<tr><td><code>agID</code></td>
<td>
<p>aliquot (grain) ID of calculated (selected) SAR equivalent doses</p>
</td></tr>
<tr><td><code>summary.info</code></td>
<td>
<p>a summary of the SAR equivalent dose calculation</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Rejection criteria used to select reliable SAR equivalent dose estimates can be catergorized into three groups:<br />
<b>(1)</b> signal-related criteria, such as <code>Tn.above.3BG</code>, <code>TnBG.ratio.low</code>, <code>rseTn.up</code>, and <code>FR.low</code>;<br />
<b>(2)</b> growth-curve-related criteria, such as <code>rcy1.range</code>, <code>rcy2.range</code>, <code>rcy3.range</code>, <code>rcp1.up</code>,<br /> 
<code>rcp2.up</code>, <code>fom.up</code>, and <code>rcs.up</code>;<br />
<b>(3)</b> equivalent-dose-related criteria, such as <code>calED.method</code> and <code>rseED.up</code>.
</p>


<h3>References</h3>

<p>Duller GAT, 2016. Analyst (v4.31.9), User Mannual.
</p>
<p>Murray AS, Wintle AG, 2000. Luminescence dating of quartz using improved single-aliquot regenerative-dose protocol. Radiation Measurements, 32(1): 57-73.
</p>
<p>Wintle AG, Murray AS, 2006. A review of quartz optically stimulated luminescence characteristics and their relevance in single-aliquot regeneration dating protocols. Radiation Measurements, 41(4): 369-391.
</p>


<h3>See Also</h3>

<p><a href="#topic+analyseBINdata">analyseBINdata</a>; <a href="#topic+fitGrowth">fitGrowth</a>; <a href="#topic+calED">calED</a>; <a href="#topic+calSGCED">calSGCED</a>; <a href="#topic+pickSARdata">pickSARdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(BIN)
  obj_pickBIN &lt;- pickBINdata(BIN, Position=c(2,4,6,8,10), Grain=0, 
                             LType="OSL", view=FALSE)
  obj_analyseBIN &lt;- analyseBINdata(obj_pickBIN, nfchn=3, nlchn=20) 
  res_SARED &lt;- calSARED(obj_analyseBIN, model="exp", origin=FALSE)
  # plot(res_SARED$Tn[,1], res_SARED$sarED[,1], xlab="Tn", ylab="ED (&lt;Gy&gt;|&lt;s&gt;)")
</code></pre>

<hr>
<h2 id='calSGCED'>
SGC Equivalent dose calculation and selection
</h2><span id='topic+calSGCED'></span><span id='topic+calSGCED.default'></span>

<h3>Description</h3>

<p>Calculating and selecting equivalent doses in a batch model according to the &quot;standardised growth curve&quot; (SGC) method suggested 
by Roberts and Duller (2004) or the &quot;global standardised growth curve&quot; (gSGC) method suggested by Li et al. (2015, 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calSGCED(obj_analyseBIN, SGCpars, model, origin, avgDev, 
         method = "SGC", SAR.Cycle = "N", errMethod = "sp", 
         Tn.above.3BG = TRUE, TnBG.ratio.low = NULL, 
         rseTn.up = NULL, FR.low = NULL, rseED.up = NULL, 
         use.se = TRUE, outpdf = NULL, outfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calSGCED_+3A_obj_analysebin">obj_analyseBIN</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(<b>required</b>): an object of S3 class &quot;analyseBIN&quot; produced by<br /> 
function <a href="#topic+analyseBINdata">analyseBINdata</a> or <a href="#topic+as_analyseBIN">as_analyseBIN</a></p>
</td></tr>
<tr><td><code id="calSGCED_+3A_sgcpars">SGCpars</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): optimized parameters of the SGC obtained using function <a href="#topic+lsNORM">lsNORM</a> (or <a href="#topic+fitGrowth">fitGrowth</a>)</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(<b>required</b>): fitting model used for obtaining <code>SGCpars</code></p>
</td></tr>
<tr><td><code id="calSGCED_+3A_origin">origin</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(<b>required</b>): logical value indicating if established SGC passes the origin</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_avgdev">avgDev</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): average deviation (i.e., average fit error) of the SGC obtained using function <a href="#topic+fitGrowth">fitGrowth</a> or <a href="#topic+lsNORM">lsNORM</a>. This quantity stands for the uncertainty of established SGC when assessing the equivalent dose error using the simple transformaion method</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_method">method</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): method used for equivalent dose calculation, i.e.,<br /> 
<code>method="SGC"</code> (for the original SGC method) or <code>method="gSGC"</code> (for the improved SGC method)</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_sar.cycle">SAR.Cycle</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): SAR cycles used for SGC equivalent dose calculation.<br /> 
Example: <code>SAR.Cycle=c("N","R3")</code></p>
</td></tr>
<tr><td><code id="calSGCED_+3A_errmethod">errMethod</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): method used for equivalent dose error assessment</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_tn.above.3bg">Tn.above.3BG</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if aliquot (grain) with Tn below 3 sigma BG should be rejected</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_tnbg.ratio.low">TnBG.ratio.low</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): lower limit on ratio of initial Tn signal to BG</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_rsetn.up">rseTn.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on relative standard error of Tn in percent</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_fr.low">FR.low</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): lower limit on fast ratio of Tn</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_rseed.up">rseED.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on the relative standard error of equivalent dose in percent</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_use.se">use.se</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if standard errors of values should be used during application of rejection criteria</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_outpdf">outpdf</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, results of SGC equivalent dose calculation will be written to a PDF file named <code>"outpdf"</code> and saved to the current work directory</p>
</td></tr>
<tr><td><code id="calSGCED_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, SGC equivalent doses related quantities will be written to a CSV file named <code>"outfile"</code> and saved to the current work directory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>scale.Ltx</code></td>
<td>
<p>scaled standardised natural-dose signals and associated standard errors used for SGC equivalent dose calculation. Note that standardised natural-dose signals will remain un-scaled if <code>method="SGC"</code></p>
</td></tr> 
<tr><td><code>sgcED</code></td>
<td>
<p>calculated SGC equivalent doses</p>
</td></tr>
<tr><td><code>ConfInt</code></td>
<td>
<p>68 percent (one sigma) and 95 percent (two sigma) confidence intervals of SGC equivalent doses</p>
</td></tr>
<tr><td><code>agID</code></td>
<td>
<p>aliquot (grain) ID of calculated (selected) SGC equivalent doses</p>
</td></tr>
<tr><td><code>summary.info</code></td>
<td>
<p>a summary of the SGC equivalent dose calculation</p>
</td></tr>
</table>


<h3>References</h3>

<p>Li B, Roberts RG, Jacobs Z, Li SH, 2015. Potential of establishing a &quot;global standardised growth curve&quot; (gSGC) for optical dating of quartz from sediments. Quaternary Geochronology, 27: 94-104.
</p>
<p>Li B, Jacobs Z, Roberts RG, 2016. Investigation of the applicability of standardised growth curves for OSL dating of quartz from Haua Fteah cave, Libya. Quaternary Geochronology, 35: 1-15.
</p>
<p>Roberts HM, Duller GAT, 2004. Standardised growth curves for optical dating of sediment using multiple-grain aliquots. Radiation Measurements, 38(2): 241-252.
</p>


<h3>See Also</h3>

<p><a href="#topic+fitGrowth">fitGrowth</a>; <a href="#topic+lsNORM">lsNORM</a>; <a href="#topic+SARdata">SARdata</a>; <a href="#topic+scaleSGCN">scaleSGCN</a>; <a href="#topic+calED">calED</a>; <a href="#topic+calSARED">calSARED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(SARdata)
 ### (1) gSGC ED calculation:
 ### gSGCpars were obtained using function "lsNORM".
 gSGCpars &lt;- c(137.440874251, 0.007997863, 2.462035263, -0.321536177)
 avg.error2 &lt;- 0.1111623
 res &lt;- calSGCED(as_analyseBIN(SARdata), gSGCpars, method="gSGC", 
                 model="gok", origin=FALSE, avgDev=avg.error2,
                 SAR.Cycle=c("N","R3"))
 print(res$sgcED)

 ### (2) SGC ED calculation (not run): 
 ### SGCpars were obtained using function "fitGrowth".
 # SGCpars &lt;- c(183.474322547,  0.007038048,  4.254287622, -0.337734151)
 # avg.error &lt;- 0.3156259
 # calSGCED(as_analyseBIN(SARdata), SGCpars, method="SGC", model="gok", 
 #          origin=FALSE, avgDev=avg.error, SAR.Cycle="N", outpdf="SGCED")

 ### (3) gSGC ED calculation and signal-related 
 ###     rejection criteria application (not run):
 # data(BIN)
 # res_pickBIN &lt;-pickBINdata(BIN, LType="OSL")
 # res_analyseBIN &lt;- analyseBINdata(res_pickBIN, nfchn=4, nlchn=30)
 # res_lsNORM &lt;- lsNORM(res_analyseBIN$SARdata, model="gok", origin=FALSE)

 # calSGCED(res_analyseBIN, SGCpars=res_lsNORM$LMpars2[,1], 
 #         model="gok", origin=FALSE, avgDev=res_lsNORM$avg.error2,
 #         method="gSGC", SAR.Cycle=c("N","R3"), Tn.above.3BG=TRUE, 
 #         TnBG.ratio.low=4, rseTn.up=10, outpdf="foo", outfile="foo")


</code></pre>

<hr>
<h2 id='dbED'>
De distribution summarization 
</h2><span id='topic+dbED'></span><span id='topic+dbED.default'></span>

<h3>Description</h3>

<p>Calculating statistical parameters (skewness, kurtosis, quantiles) for a number of equivalent dose values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbED(EDdata, plot = TRUE, typ = "pdf", from = NULL, 
     to = NULL, step = NULL, nbin = 15, pcolor = "purple", 
     psize = 1.5, outfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbED_+3A_eddata">EDdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a two-column matrix (i.e., equivalent dose values and<br />
associated standard errors)</p>
</td></tr>
<tr><td><code id="dbED_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): draw a plot or not</p>
</td></tr>
<tr><td><code id="dbED_+3A_typ">typ</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): type of plot, <code>typ="pdf"</code> means a probability density plot and <code>typ="hist"</code> means a histogram plot</p>
</td></tr>
<tr><td><code id="dbED_+3A_from">from</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): desired lower limit on x-axis</p>
</td></tr>
<tr><td><code id="dbED_+3A_to">to</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): desired upper limit on x-axis</p>
</td></tr>
<tr><td><code id="dbED_+3A_step">step</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): a step-size used for constructing the probability density plot (if <code>typ="pdf"</code>). Smaller step value gives smoother density curve</p>
</td></tr>
<tr><td><code id="dbED_+3A_nbin">nbin</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): desired number of intervals for the histogram (if <code>typ="hist"</code>)</p>
</td></tr>
<tr><td><code id="dbED_+3A_pcolor">pcolor</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): color of data points, input <a href="grDevices.html#topic+colors">colors</a>() to see available colors</p>
</td></tr>
<tr><td><code id="dbED_+3A_psize">psize</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): size of data points</p>
</td></tr>
<tr><td><code id="dbED_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, calculated probability densities (if <code>typ="pdf"</code>) will be written to a CSV file named <code>"outfile"</code> and saved to the current work directory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>weight.ED</code></td>
<td>
<p>weigthed mean of equivalent dose values and associated standard error</p>
</td></tr>
<tr><td><code>skewness</code></td>
<td>
<p>weighted skewness of equivalent dose values and associated standard error</p>
</td></tr>
<tr><td><code>kurtosis</code></td>
<td>
<p>kurtosis of equivalent dose values and associated standard error</p>
</td></tr>
<tr><td><code>quantile.ED</code></td>
<td>
<p>quantiles of equivalent dose values</p>
</td></tr>
</table>


<h3>References</h3>

<p>Galbraith RF, 2010. On plotting OSL equivalent doses. Ancient TL, 28(1): 1-10.
</p>
<p>Galbraith RF, Roberts RG, 2012. Statistical aspects of equivalent dose and error calculation and display in OSL dating: an overview and some recommendations. Quaternary Geochronology, 11: 1-27.
</p>


<h3>See Also</h3>

<p><a href="#topic+psRadialPlot">psRadialPlot</a>; <a href="#topic+RadialPlotter">RadialPlotter</a>; <a href="#topic+EDdata">EDdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(EDdata)
 dbED(EDdata$gl11,typ="pdf")
</code></pre>

<hr>
<h2 id='decomp'>
OSL decay curve decomposition
</h2><span id='topic+decomp'></span><span id='topic+decomp.default'></span>

<h3>Description</h3>

<p>Decomposing a CW-OSL or LM-OSL decay curve to a given number of first-order exponential components using
a combination of differential evolution and Levenberg-Marquardt algorithm suggested by Bluszcz and Adamiec (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decomp(Sigdata, delay.off = c(0,0), ncomp = 2, 
       constant = TRUE, typ = "cw", control.args = list(), 
       weight = FALSE, plot = TRUE, log = "x", lwd = 2, 
       curve.no = NULL, SAR.Cycle = NULL, irr.dose = NULL, 
       outfile = NULL, transf = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decomp_+3A_sigdata">Sigdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a two-column matrix (i.e., stimulation time and photon count values)</p>
</td></tr>
<tr><td><code id="decomp_+3A_delay.off">delay.off</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(with default): a two-elment vector indicating the &quot;Delay&quot; and &quot;Off&quot;<br />
values of the decay curves, i.e., <code>delay.off[1]=Delay</code>,<code>delay.off[2]=Off</code></p>
</td></tr>
<tr><td><code id="decomp_+3A_ncomp">ncomp</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): number of decomposed components</p>
</td></tr>
<tr><td><code id="decomp_+3A_constant">constant</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if a constant component should be subtracted from the decay curve</p>
</td></tr>
<tr><td><code id="decomp_+3A_typ">typ</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): type of a decay curve (i.e., <code>typ="cw"</code> or <code>typ="lm"</code>)</p>
</td></tr>
<tr><td><code id="decomp_+3A_control.args">control.args</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(with default): arguments used in the differential evolution algorithm, see details</p>
</td></tr>
<tr><td><code id="decomp_+3A_weight">weight</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the fit should be performed using a weighted procedure</p>
</td></tr>
<tr><td><code id="decomp_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the results should be plotted</p>
</td></tr>
<tr><td><code id="decomp_+3A_log">log</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): a character string which contains &quot;x&quot; if the x axis is to be logarithmic, &quot;y&quot; if the y axis is to be logarithmic and &quot;xy&quot; or &quot;yx&quot; if both axes are to be logarithmic</p>
</td></tr>
<tr><td><code id="decomp_+3A_lwd">lwd</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): width of curves (lines)</p>
</td></tr>
<tr><td><code id="decomp_+3A_curve.no">curve.no</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): decay curve number</p>
</td></tr>
<tr><td><code id="decomp_+3A_sar.cycle">SAR.Cycle</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): SAR cycle of the decay curve, Example: <code>SAR.Cycle="R1"</code></p>
</td></tr>
<tr><td><code id="decomp_+3A_irr.dose">irr.dose</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): irradiation dose of the decay curve</p>
</td></tr>
<tr><td><code id="decomp_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, decomposed signal values will be written to a CSV file named <code>"outfile"</code> and saved to the current work directory</p>
</td></tr>
<tr><td><code id="decomp_+3A_transf">transf</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): do not use (for backward compatibility purpose)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+decomp">decomp</a> decomposes an OSL decay curve to a specified number of components using a combination of differential evolution and Levenberg-Marquardt algorithm. Both CW-OSL and LM-OSL decay curves can be decomposed.<br /><br />
For a CW-OSL decay curve, the fitting model (Bluszcz and Adamiec, 2006) is:<br />
<code>I(t)=a1*b1*exp(-b1*t)+...+ak*bk*exp(-bk*t)</code>,<br />
where <code>k=1, 2, ..., 7</code>, <code>I(t)</code> is the luminescence intensity as a function of time, <code>a</code> is the number of trapped electrons, and <code>b</code> is the detrapping rate. The constant component is <code>c</code> if <code>constant=TRUE</code>.<br /><br />
For a LM-OSL decay curve, the fitting model (Bulur, 2000) is:<br />
<code>I(t)=a1*b1*(t/P)*exp[-b1*t^2/(2*P)]+...+ak*bk*(t/P)*exp[-bk*t^2/(2*P)]</code>,<br />
where <code>k=1, 2, ..., 7</code>, and <code>I(t)</code> is the luminescence intensity as a function of time, <code>P</code> is the total stimulation time, <code>a</code> is the number of trapped electrons, and <code>b</code> is the detrapping rate. The constant component is <code>c*(t/P)</code> if <code>constant=TRUE</code>.<br /><br />
Parameters are initialized using a differential evolution method suggested by Bluszcz and Adamiec (2006), then the Levenberg-Marquardt algorithm (minpack: Fortran 90 version by John Burkardt, freely available at <a href="https://people.sc.fsu.edu/~jburkardt/f_src/minpack/minpack.html">https://people.sc.fsu.edu/~jburkardt/f_src/minpack/minpack.html</a>) will be performed to optimize the parameters. If <code>weight=TRUE</code>, the photon counts will be assumed to follow a Possion distribution with a standard error equal to the square root of the number of photon counts, and the decay curve will be fitted using a weighted procedure. Setting <code>weight=TRUE</code> gives more weight to photon counts from slower decaying components.<br /><br />
Arguments in <code>control.args</code> that control the differential evolution algorithm include:<br />
<b>(1)</b> <em>factor</em>: the number of population members, <code>np=factor*ncomp</code>, default <code>factor=20</code>; <br />
<b>(2)</b> <em>f</em>: a weighting factor that lies between <code>0</code> and <code>1.2</code>, default <code>f=0.5</code>; <br />
<b>(3)</b> <em>cr</em>: a crossover constant that lies between <code>0</code> and <code>1</code>, default <code>cr=0.99</code>; <br />
<b>(4)</b> <em>maxiter</em>: maximum number of iterations, default <code>maxiter=500</code>; <br />
<b>(5)</b> <em>tol</em>: tolerance for stopping the iteration, the procedure will be terminated if <br />
all relative standard deviations of parameters are smaller than <code>tol</code>, defalut <code>tol=0.1</code>.
</p>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> containing the following elements:
</p>
<table>
<tr><td><code>message</code></td>
<td>
<p>return 0 if fit succeeds, else 1</p>
</td></tr>
<tr><td><code>comp.sig</code></td>
<td>
<p>a matrix containing time, signal, and fitted signal values for each component</p>
</td></tr>
<tr><td><code>LMpars</code></td>
<td>
<p>optimized parameters for the decay curve</p>
</td></tr>
<tr><td><code>constant</code></td>
<td>
<p>estimated constant component, it returns <code>0</code> if <code>constant=FALSE</code></p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>minimized objective for the decay curve</p>
</td></tr>
<tr><td><code>FOM</code></td>
<td>
<p>figure of merit value for the decay curve in percent</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Arguments <code>curve.no</code>, <code>SAR.Cycle</code>, and <code>irr.dose</code> have nothing to do with decay curve fitting. They are used only for plotting purpose.<br /><br />
The model to be optimized should not be underdetermined. This means that the number of data points should exceed (or at least be equal to) the number of parameters. For a given model, this routine will return an error if any standard errors of parameters cannot be estimated by numerical difference-approximation. Function <code>decompc</code> in previous versions was bundled to function <a href="#topic+decomp">decomp</a>.<br /><br />
We would like to thank Professor Andrzej Bluszcz who helps us a lot during the programming of this function. Dr Jeong-Heon Choi is thanked for providing published data sets to test this routine.
</p>


<h3>References</h3>

<p>Bluszcz A, 1996. Exponential function fitting to TL growth data and similar applications. Geochronometria, 13: 135-141.
</p>
<p>Bluszcz A, Adamiec G, 2006. Application of differential evolution to fitting OSL decay curves. Radiation Measurements, 41(7-8): 886-891.
</p>
<p>Bulur E, 2000. A simple transformation for converting CW-OSL curves to LM-OSL curves. Radiation Measurements, 32(2): 141-145.
</p>
<p>Differential evolution algorithm, <a href="https://en.wikipedia.org/wiki/Differential_evolution">https://en.wikipedia.org/wiki/Differential_evolution</a>
</p>
<p>Jain M, Murray AS, Boetter-Jensen L, 2003. Characterisation of blue-light stimulated luminescence components in different quartz samples: 
implications for dose measurement. Radiation Measurements, 37(4-5): 441-449.
</p>
<p>More JJ, 1978. &quot;The Levenberg-Marquardt algorithm: implementation and theory,&quot; in Lecture Notes in Mathematics: Numerical Analysis, 
Springer-Verlag: Berlin. 105-116.
</p>
<p><b>Further reading</b> 
</p>
<p>Adamiec G, 2005. OSL decay curves-relationship between single- and multiple-grain aliquots. Radiation Measurements, 39(1): 63-75.
</p>
<p>Balian HG, Eddy NW, 1977. Figure-of-merit (FOM), an improved criterion over the normalized chi-squared test for assessing 
goodness-of-fit of gamma-ray spectral peaks. Nuclear Instruments and Methods, 145(2): 389-95.
</p>
<p>Choi JH, Duller GAT, Wintle AG, 2006. Analysis of quartz LM-OSL curves. Ancient TL, 24(1): 9-20.
</p>
<p>Li SH, Li B, 2006. Dose measurement using the fast component of LM-OSL signals from quartz. Radiation Measurements, 41(5): 534-541.
</p>
<p>Peng J, Dong ZB, Han FQ, Han YH, Dai XL, 2014. Estimating the number of components in an OSL decay curve using the Bayesian Information Criterion. 
Geochronometria, 41(4): 334-341.
</p>


<h3>See Also</h3>

<p><a href="#topic+Signaldata">Signaldata</a>; <a href="#topic+pickBINdata">pickBINdata</a>; <a href="#topic+fastED">fastED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ### Example 1:
 data(Signaldata)
 decomp(Signaldata$lm,ncomp=3,typ="lm",
        control.args=list(maxiter=10))

 ### Example 2 (not run):
 # data(BIN)
 # obj_pickBIN &lt;- pickBINdata(BIN, Position=2, Run=2, view=TRUE,
 #                            LType="OSL", force.matrix=TRUE)
 # decomp(obj_pickBIN$BINdata[[1]], ncomp=2, log="xy")
</code></pre>

<hr>
<h2 id='EDdata'>
Equivalent dose values
</h2><span id='topic+EDdata'></span>

<h3>Description</h3>

<p>Two sets of equivalent dose values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(EDdata)</code></pre>


<h3>Format</h3>

<p>A list that contains two sets of equivalent dose values:
</p>

<dl>
<dt>gl11</dt><dd><p>35 equivalent dose values of a sand sample from the Tengger Desert (Peng and Han, 2013)</p>
</dd>
<dt>al3</dt><dd><p>84 equivalent dose values of an alluvial deposit from the andean precordillera (Schmidt et al., 2012)</p>
</dd>
</dl>



<h3>References</h3>

<p>Peng J, Han FQ, 2013. Selections of fast-component OSL signal using sediments from the south edge of Tengger Desert. Acta Geoscientica Sinica, 34(6): 757-762.
</p>
<p>Schmidt S, Tsukamoto S, Salomon E, Frechen M, Hetzel R, 2012. Optical dating of alluvial deposits at the orogenic front of the andean precordillera (Mendoza, Argentina). Geochronometria, 39(1): 62-75.
</p>


<h3>See Also</h3>

<p><a href="#topic+dbED">dbED</a>; <a href="#topic+psRadialPlot">psRadialPlot</a>; <a href="#topic+RadialPlotter">RadialPlotter</a>; <a href="#topic+mcFMM">mcFMM</a>; <a href="#topic+mcMAM">mcMAM</a>; <a href="#topic+optimSAM">optimSAM</a>; <a href="#topic+sensSAM">sensSAM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Not run.
  # data(EDdata)
  # names(EDdata)
</code></pre>

<hr>
<h2 id='fastED'>
Fast-component equivalent dose calculation
</h2><span id='topic+fastED'></span><span id='topic+fastED.default'></span>

<h3>Description</h3>

<p>Estimating a fast-, medium-, or slow-component equivalent dose using decay curves obtained from the single aliquot regenerative-dose (SAR) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastED(Sigdata, Redose, delay.off = c(0,0), ncomp = 2, 
       constant = TRUE, compIDX = 1, control.args = list(), 
       typ = "cw", model = "gok", origin = FALSE, errMethod = "sp", 
       nsim = 500, weight.decomp = FALSE, weight.fitGrowth = TRUE, 
       trial = TRUE, nofit.rgd = NULL, outpdf = NULL, log = "x", 
       lwd = 2, test.dose = NULL, agID = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastED_+3A_sigdata">Sigdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a series of decay curves stored in a matrix column by column, the first column denotes stimulation time values, see details. 
Data structure of this kind can be obtained using function <a href="#topic+pickBINdata">pickBINdata</a> by setting argument <code>force.matrix=TRUE</code>, see examples</p>
</td></tr>
<tr><td><code id="fastED_+3A_redose">Redose</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): regenerative dose values. Example: <code>Redose=c(1,2,3,4,0,1)</code></p>
</td></tr>
<tr><td><code id="fastED_+3A_delay.off">delay.off</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(with default): a two-elment vector indicating the &quot;Delay&quot; and &quot;Off&quot;<br />
values of the decay curves, i.e., <code>delay.off[1]=Delay</code>,<code>delay.off[2]=Off</code></p>
</td></tr>
<tr><td><code id="fastED_+3A_ncomp">ncomp</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): number of components to be decomposed</p>
</td></tr>
<tr><td><code id="fastED_+3A_constant">constant</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if a constant background should be subtracted from the decay curve, see function <a href="#topic+decomp">decomp</a> for details</p>
</td></tr>
<tr><td><code id="fastED_+3A_compidx">compIDX</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): index of the component to be extracted. For example, <code>compIDX=1</code> and <code>compIDX=2</code> indicate respectively that 
the fast- and medium-component signals will be used to calculate the equivalent dose. The index should not exceed the number of components to be decomposed</p>
</td></tr>
<tr><td><code id="fastED_+3A_control.args">control.args</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(with default): arguments used in the differential evolution algorithm, see function <a href="#topic+decomp">decomp</a> for details</p>
</td></tr>
<tr><td><code id="fastED_+3A_typ">typ</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): type of an OSL decay curve, only CW-OSL decay curve can be analyzed currently</p>
</td></tr>
<tr><td><code id="fastED_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): model used for growth curve fitting, see function<br /> 
<a href="#topic+fitGrowth">fitGrowth</a> for available models</p>
</td></tr>
<tr><td><code id="fastED_+3A_origin">origin</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be forced to pass the origin</p>
</td></tr>
<tr><td><code id="fastED_+3A_errmethod">errMethod</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): method used for equivalent dose error assessment. See function <a href="#topic+calED">calED</a> for details</p>
</td></tr>
<tr><td><code id="fastED_+3A_nsim">nsim</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): desired number of randomly simulated equivalent dose obtained by Monte Carlo simulation</p>
</td></tr>
<tr><td><code id="fastED_+3A_weight.decomp">weight.decomp</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): logical value indicating if the decay curve should be fitted using a weighted procedure, see function <a href="#topic+decomp">decomp</a> for details</p>
</td></tr>
<tr><td><code id="fastED_+3A_weight.fitgrowth">weight.fitGrowth</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): logical value indicating if the growth curve should be fitted using a weighted procedure, see function <a href="#topic+fitGrowth">fitGrowth</a> for details</p>
</td></tr>
<tr><td><code id="fastED_+3A_trial">trial</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using other models if the given model fails, see function <a href="#topic+fitGrowth">fitGrowth</a> for details</p>
</td></tr>
<tr><td><code id="fastED_+3A_nofit.rgd">nofit.rgd</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(optional): regenerative doses that will not be used during the fitting. 
For example, if <code>nofit.rgd=1</code> then the first regenerative dose will not be used during fast-, medium-, or slow-component growth curve fitting</p>
</td></tr>
<tr><td><code id="fastED_+3A_outpdf">outpdf</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, results of fast-, medium-, or slow-component equivalent dose calculation will be written to a PDF file 
named <code>"outpdf"</code> and saved to the current work directory</p>
</td></tr>
<tr><td><code id="fastED_+3A_log">log</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): a character string which contains &quot;x&quot; if the x axis is to be logarithmic, &quot;y&quot; if the y axis is to be logarithmic and &quot;xy&quot; or &quot;yx&quot; if both axes are to be logarithmic</p>
</td></tr>
<tr><td><code id="fastED_+3A_lwd">lwd</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): width of curves (lines)</p>
</td></tr>
<tr><td><code id="fastED_+3A_test.dose">test.dose</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): test dose of decay curves</p>
</td></tr>
<tr><td><code id="fastED_+3A_agid">agID</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a three-elemenet vector indicating aliquot (grain) ID, i.e.,<br /> 
<code>agID[1]=NO</code>, <code>agID[2]=Position</code>, <code>agID[3]=Grain</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+fastED">fastED</a> is used to estimate a fast-, medium-, or slow-component equivalent dose using data sets obtained from the SAR protocol (Murray and Wintle, 2000). The routine trys to decompose a series of decay curves to a specified number of components, then the numbers of trapped electrons from the fast-, medium-, or slow-component will be used to construct the growth curve to estimate a fast-, medium-, or slow-component equivalent dose. See function <a href="#topic+decomp">decomp</a>, <a href="#topic+fitGrowth">fitGrowth</a>, and <a href="#topic+calED">calED</a> for more details concerning decay curve decomposition, growth curve fitting, and equivalent dose calculation, respectively.<br /><br />
Argument <code>Sigdata</code> is a column-matrix made up with stimulation time values and a number of decay curves:
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Column.no</b> </td><td style="text-align: left;">  <b>Description</b>                                     </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>I</code>         </td><td style="text-align: left;">   Stimulation time values                               </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>II</code>        </td><td style="text-align: left;">   Natural-dose signal values                            </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>III</code>       </td><td style="text-align: left;">   Test-dose signal values for the natural-dose          </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>IV</code>        </td><td style="text-align: left;">   The 1th Regenerative-dose signal values               </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>V</code>         </td><td style="text-align: left;">   Test-dose signal values for the 1th regenerative-dose </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>VI</code>        </td><td style="text-align: left;">   The 2th regenerative-dose signal values               </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>VII</code>       </td><td style="text-align: left;">   Test-dose signal values for the 2th regenerative-dose </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>...</code>       </td><td style="text-align: left;">   ...
</td>
</tr>

</table>



<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> containing the following elements:
</p>
<table>
<tr><td><code>decomp.pars</code></td>
<td>
<p>a <a href="base.html#topic+list">list</a> containing optimized parameters of successfully fitted decay curves</p>
</td></tr>
<tr><td><code>Curvedata</code></td>
<td>
<p>data sets used for building the fast-, medium-, or slow-component growth curve</p>
</td></tr>
<tr><td><code>Ltx</code></td>
<td>
<p>sensitivity-corrected natural-dose fast-, medium-, or slow-component signal and its standard error</p>
</td></tr>
<tr><td><code>LMpars</code></td>
<td>
<p>optimizaed parameters for the fast-, medium-, or slow-component growth curve</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>minimized objective for the fast-, medium-, or slow-component growth curve</p>
</td></tr>
<tr><td><code>avg.error</code></td>
<td>
<p>average fit error for the fast-, medium-, or slow-component growth curve</p>
</td></tr>
<tr><td><code>RCS</code></td>
<td>
<p>reduced chi-square value for the fast-, medium-, or slow-component growth curve</p>
</td></tr>
<tr><td><code>FOM</code></td>
<td>
<p>figure of merit value for the fast-, medium-, or slow-component growth curve in percent</p>
</td></tr>
<tr><td><code>calED.method</code></td>
<td>
<p>method used for calculating the fast-, medium-, or slow-component equivalent dose, i.e., <code>"Interpolation"</code> or <code>"Extrapolation"</code></p>
</td></tr>
<tr><td><code>mcED</code></td>
<td>
<p>randomly simulated fast-, medium-, or slow-component equivalent doses</p>
</td></tr>
<tr><td><code>ED</code></td>
<td>
<p>fast-, medium-, or slow-component equivalent dose and its standard error</p>
</td></tr>
<tr><td><code>ConfInt</code></td>
<td>
<p>68 percent and 95 percent confidence interval of the fast-, medium-, or slow-component equivalent dose</p>
</td></tr>
<tr><td><code>RecyclingRatio1</code></td>
<td>
<p>the first fast-, medium-, or slow-component recycling ratio and its standard error</p>
</td></tr>
<tr><td><code>RecyclingRatio2</code></td>
<td>
<p>the second fast-, medium-, or slow-component recycling ratio and its standard error</p>
</td></tr>
<tr><td><code>RecyclingRatio3</code></td>
<td>
<p>the third fast-, medium-, or slow-component recycling ratio and its standard error</p>
</td></tr>
<tr><td><code>Recuperation1</code></td>
<td>
<p>the first fast-, medium-, or slow-component recuperation (i.e., ratio of the sensitivity-corrected zero-dose 
signal to natural-dose signal) and its standard error in percent</p>
</td></tr>
<tr><td><code>Recuperation2</code></td>
<td>
<p>the second fast-, medium-, or slow-component recuperation (i.e., ratio of the sensitivity-corrected zero-dose 
signal to the maximum regenerative-dose signal) and its standard error in percent</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Argument <code>test.dose</code> and <code>agID</code> have nothing to do with fast-, medium-, or slow-component equivalent dose calculation. They are used only for plotting purpose.<br /><br />
The number of trapped electrons that corresponds to the largest, the second largest, and the third largest decay rates will be regarded as the fast-, medium-, and slow-component signals, respectively, 
which cannot always ensure that pure fast-, medium-, or slow-component signals be extracted if an ultra-fast decaying component appears.<br /><br />
The authors thank Professor Sheng-Hua Li and Professor Geoff Duller for their helpful discussions concerning fast-component equivalent dose calculation.
</p>


<h3>References</h3>

<p>Li SH, Li B, 2006. Dose measurement using the fast component of LM-OSL signals from quartz. 
Radiation Measurements, 41(5): 534-541.
</p>
<p>Murray AS, Wintle AG, 2000. Luminescence dating of quartz using improved single-aliquot regenerative-dose protocol. 
Radiation Measurements, 32(1): 57-73.
</p>


<h3>See Also</h3>

<p><a href="#topic+pickBINdata">pickBINdata</a>; <a href="#topic+Signaldata">Signaldata</a>; <a href="#topic+fitGrowth">fitGrowth</a>; <a href="#topic+decomp">decomp</a>; <a href="#topic+calED">calED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ### Example 1 (not run):
 # data(Signaldata)
 # fastED(Signaldata$cw,Redose=c(80,160,240,320,0, 80)*0.13,
 #        ncomp=3, constant=FALSE, compIDX=1, outpdf="fastED1")

 # fastED(Signaldata$cw,Redose=c(80,160,240,320,0, 80)*0.13,
 #        ncomp=3, constant=FALSE, compIDX=2, outpdf="mediumED1")

 # fastED(Signaldata$cw,Redose=c(80,160,240,320,0, 80)*0.13,
 #        ncomp=3, constant=FALSE, compIDX=3, outpdf="slowED1")

 ### Example 2 (not run):
 # data(BIN)
 # obj_pickBIN &lt;- pickBINdata(BIN, Position=6, Grain=0, 
 #                            LType="OSL", force.matrix=TRUE)
 # fastED(obj_pickBIN$BINdata[[1]], ncomp=2, constant=TRUE,
 #        Redose=c(100,200,300,400,0,100)*0.13, outpdf="fastED2")

</code></pre>

<hr>
<h2 id='fitGrowth'>
Growth curve fitting
</h2><span id='topic+fitGrowth'></span><span id='topic+fitGrowth.default'></span>

<h3>Description</h3>

<p>Fitting growth curves using the Levenberg-Marquardt algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitGrowth(Curvedata, model = "gok", origin = FALSE, 
          weight = TRUE, trial = FALSE, plot = TRUE, 
          nofit.rgd = NULL, agID = NULL, Tn = NULL, 
          Tn3BG = NULL, TnBG.ratio = NULL, rseTn = NULL, 
          FR = NULL, RecyclingRatio1 = NULL, 
          RecyclingRatio2 = NULL, RecyclingRatio3 = NULL, 
          Recuperation1 = NULL, Recuperation2 = NULL, 
          LnTn.curve = NULL, TxTn = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitGrowth_+3A_curvedata">Curvedata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a three-column matrix (i.e., regenerative doses,<br />
sensitivity-corrected regenerative-dose signals, and associated standard errors)</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): model used for growth curve fitting, see details</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_origin">origin</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(optional): logical value indicating if the growth curve should be forced to pass the origin</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_weight">weight</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using a weighted procedure, see details</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_trial">trial</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using other models if the given model fails, see details</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the results should be plotted</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_nofit.rgd">nofit.rgd</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(optional): regenerative doses that will not be used during the fitting. 
For example, if <code>nofit.rgd=c(5,6)</code> then both the fifth and sixth regenerative doses will not be used during growth curve fitting</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_agid">agID</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a three-elemenet vector indicating aliquot (grain) ID, i.e.,<br />
<code>agID[1]=NO</code>, <code>agID[2]=Position</code>, <code>agID[3]=Grain</code></p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_tn">Tn</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of Tn</p>
</td></tr> 
<tr><td><code id="fitGrowth_+3A_tn3bg">Tn3BG</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): 0-1 value indicating if Tn is more than 3 sigma above BG,<br />
1 indicates Tn&gt;3_sigma_BG, 0 indicates Tn&lt;=3_sigma_BG</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_tnbg.ratio">TnBG.ratio</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of ratio of initial Tn signal to BG</p>
</td></tr> 
<tr><td><code id="fitGrowth_+3A_rsetn">rseTn</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): relative standard error of Tn in percent</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_fr">FR</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of fast ratio of Tn</p>
</td></tr>  
<tr><td><code id="fitGrowth_+3A_recyclingratio1">RecyclingRatio1</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of the first recycling ratio</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_recyclingratio2">RecyclingRatio2</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of the second recycling ratio</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_recyclingratio3">RecyclingRatio3</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of the third recycling ratio</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_recuperation1">Recuperation1</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of the first recuperation</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_recuperation2">Recuperation2</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector containing value and<br />
standard error of the second recuperation</p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_lntn.curve">LnTn.curve</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(optional): decay curve data for Ln and Tn, it should contain four elements, 
i.e., <code>names(LnTn.curve)=c("Ln.x","Ln.y","Tn.x","Tn.y")</code></p>
</td></tr>
<tr><td><code id="fitGrowth_+3A_txtn">TxTn</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): ratios of Tx to Tn for various SAR cycles</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In growth curve fitting using function <a href="#topic+fitGrowth">fitGrowth</a>, five models are available: <br />
<b>(1)</b> <em>&quot;line&quot;</em>: a linear model, <code>y=a*x+b</code>;<br />
<b>(2)</b> <em>&quot;exp&quot;</em>: a single saturation exponential model, <code>y=a*[1-exp(-b*x)]+c</code>;<br />
<b>(3)</b> <em>&quot;lexp&quot;</em>: a single saturation exponential plus linear model, <code>y=a*[1-exp(-b*x)]+c*x+d</code>;<br />
<b>(4)</b> <em>&quot;dexp&quot;</em>: a double saturation exponential model, <code>y=a*[1-exp(-b*x)]+c*[1-exp(-d*x)]+e</code>;<br />
<b>(5)</b> <em>&quot;gok&quot;</em>: a general order kinetic model (Guralnik et al., 2015), <code>y=a*[1-(1+b*c*x)^(-1/c)]+d</code>.<br /><br />
The fitting process is performed using the Levenberg-Marquardt algorithm (minpack: Fortran 90 source code by John Burkardt, freely available at <a href="https://people.sc.fsu.edu/~jburkardt/f_src/minpack/minpack.html">https://people.sc.fsu.edu/~jburkardt/f_src/minpack/minpack.html</a>). If <code>weight=TRUE</code>, a weighted procedure will be performed through weighting each data point by its inverse variance. User is advised to set argument <code>plot=TRUE</code> if possible to visualize the quality of fit.<br /><br />
Argument <code>trial=TRUE</code> means that if the growth curve can not be fitted successfully using the user-supplied model, then the procedure will try to fit other models instead:
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Model</b>              </td><td style="text-align: left;">  <b>Tried model</b>                       </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"dexp"</code>             </td><td style="text-align: left;">  <code>c("dexp", "gok", "exp", "line")</code>   </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"lexp"</code>             </td><td style="text-align: left;">  <code>c("lexp", "gok", "exp", "line")</code>   </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"gok"</code>              </td><td style="text-align: left;">  <code>c("gok", "exp", "line")</code>           </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"exp"</code>              </td><td style="text-align: left;">  <code>c("exp", "line")</code>                  </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>"line"</code>             </td><td style="text-align: left;">  <code>c("line")</code>                                         
</td>
</tr>

</table>

<p>For example, if <code>model="dexp"</code> and <code>trial=TRUE</code>, then a number of models from sequence<br />
<code>c("dexp", "gok", "exp", "line")</code> will be applied one after another until the fit succeeds.<br />
</p>
<p>The required number of data points for each model is (value inside the parentheses denotes the required number of observations if the model passes the origin):
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Model</b>   </td><td style="text-align: left;"> <b>Required NPoints</b>   </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"dexp"</code>  </td><td style="text-align: left;">   &gt;=5 (&gt;=4)               </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"lexp"</code>  </td><td style="text-align: left;">   &gt;=4 (&gt;=3)               </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"gok"</code>   </td><td style="text-align: left;">   &gt;=4 (&gt;=3)               </td>
</tr>
<tr>
 <td style="text-align: left;">  
<code>"exp"</code>   </td><td style="text-align: left;">   &gt;=3 (&gt;=2)               </td>
</tr>
<tr>
 <td style="text-align: left;">   
<code>"line"</code>  </td><td style="text-align: left;">   &gt;=2 (&gt;=1)                                                   
</td>
</tr>

</table>

<p>If user-provided data is not enough for model fitting (i.e., the number of data points is less than the number of parameters of a given model), 
then a model with less parameters will be fitted. For example, if 4 data points are fitted using a <code>"dexp"</code> (<code>origin=FALSE</code>) model that actually needs at least 5 data points, 
then a 4-parameter <code>"gok"</code> model will be fitted instead. 
</p>


<h3>Value</h3>

<p>Return a <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>message</code></td>
<td>
<p>return 0 if the fit succeeds, else 1</p>
</td></tr>
<tr><td><code>fitIDX</code></td>
<td>
<p>Indices of dose points used in growth curve fitting</p>
</td></tr>
<tr><td><code>LMpars</code></td>
<td>
<p>optimized parameters for the growth curve</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>minimized objective for the growth curve</p>
</td></tr>
<tr><td><code>avg.error</code></td>
<td>
<p>average fit error for the growth curve</p>
</td></tr>
<tr><td><code>RCS</code></td>
<td>
<p>reduced chi-square value for the growth curve</p>
</td></tr>
<tr><td><code>FOM</code></td>
<td>
<p>figure of merit value for the growth curve in percent</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Arguments <code>agID</code>, <code>Tn</code>,  <code>Tn3BG</code>, <code>TnBG.ratio</code>, <code>rseTn</code>, <code>FR</code>,<br /> 
<code>RecyclingRatio1</code>, <code>RecyclingRatio2</code>, <code>RecyclingRatio3</code>,<br /> 
<code>Recuperation1</code>, <code>Recuperation2</code>, <code>LnTn.curve</code>, <code>TxTn</code> have nothing to do with growth curve fitting. They are used only for plotting purpose.<br /><br />
The model to be optimized should not be underdetermined. This means that the number of data points should exceed (or at least be equal to) the number of parameters. For a given model, the procedure will return an error if any standard errors of parameters cannot be estimated by numerical difference-approximation.<br /><br />
</p>


<h3>References</h3>

<p>Balian HG, Eddy NW, 1977. Figure-of-merit (FOM), an improved criterion over the normalized chi-squared test for assessing 
goodness-of-fit of gamma-ray spectral peaks. Nuclear Instruments and Methods, 145(2): 389-95.
</p>
<p>Guralnik B, Li B, Jain M, Chen R, Paris RB, Murray AS, Li SH, Pagonis V, Valla PG, Herman F, 2015. Radiation-induced growth and isothermal decay of 
infrared-stimulated luminescence from feldspar. Radiation Measurements, 81: 224-231. 
</p>
<p>More JJ, 1978. &quot;The Levenberg-Marquardt algorithm: implementation and theory&quot; in Lecture Notes in Mathematics: Numerical Analysis, 
Springer-Verlag: Berlin. 105-116.
</p>


<h3>See Also</h3>

<p><a href="#topic+analyseBINdata">analyseBINdata</a>; <a href="#topic+SARdata">SARdata</a>; <a href="#topic+calED">calED</a>; <a href="#topic+calSARED">calSARED</a>; <a href="#topic+fastED">fastED</a>;<br />
<a href="#topic+pickSARdata">pickSARdata</a>; <a href="#topic+lsNORM">lsNORM</a>; <a href="#topic+calSGCED">calSGCED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ### Example 1:
 Curvedata &lt;- cbind(c(0, 18, 36, 54, 72, 0, 18),               
                    c(0.026, 1.55, 2.39, 3.46, 4.13, 0.023, 1.61),  
                    c(0.005, 0.11, 0.27, 0.22, 0.20, 0.008, 0.24)) 
 fitGrowth(Curvedata, model="gok", origin=FALSE, plot=TRUE)

 ### Example 2 (not run):
 # data(SARdata)
 # Curvedata &lt;- SARdata[!is.element(SARdata[,2], "N"),3:5]
 # fitGrowth(Curvedata, model="gok", origin=FALSE)
 
</code></pre>

<hr>
<h2 id='loadBINdata'>
BIN file loading (importing)
</h2><span id='topic+loadBINdata'></span><span id='topic+loadBINdata.default'></span>

<h3>Description</h3>

<p>Loading (importing) a BIN file into the R platform.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadBINdata(filename, view = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadBINdata_+3A_filename">filename</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(<b>required</b>): name(s) of file(s) (with file extension &quot;.BIN&quot;, &quot;.bin&quot;, &quot;BINX&quot;, or &quot;binx&quot;), the file(s) must be available from the current working directory. Example: <code>filename=c("foo1.bin","foo2.binx")</code></p>
</td></tr>
<tr><td><code id="loadBINdata_+3A_view">view</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(optional): logical value indicating if the loaded data should be visualized in a Summary Table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+loadBINdata">loadBINdata</a> is used for loading BIN (BINX) files into the R platform. Five versions of binary files (V3, V4, V6, V7, and V8) are loadable. It can load a single BIN (BINX) file or a number of files into R simultaneously.<br />
Items reserved during the loading process include:<br />
<b>(1)</b> <em>Position</em>: Carousel position;
</p>
<p><b>(2)</b> <em>Grain</em>: Grain number;
</p>
<p><b>(3)</b> <em>Run</em>: Run number;
</p>
<p><b>(4)</b> <em>Set</em>: Set number;
</p>
<p><b>(5)</b> <em>DType</em>: Data type, includes: <code>Natural</code>, <code>N+dose</code>, <code>bleach</code>, <code>Bleach+dose</code>,<br />
<code>Natural(Bleach)</code>, <code>N+dose(Bleach)</code>, <code>Dose</code>, <code>Background</code>;
</p>
<p><b>(6)</b> <em>IRRTime</em>: Irradiation time;
</p>
<p><b>(7)</b> <em>NPoints</em>: number of data points;
</p>
<p><b>(8)</b> <em>LType</em>: Luminescence type, includes: <code>TL</code>, <code>OSL</code>, <code>IRSL</code>, <code>M-IR</code>, <code>M-VIS</code>,<br /> 
<code>TOL</code>, <code>TRPOSL</code>, <code>RIR</code>, <code>RBR</code>, <code>USER</code>, <code>POSL</code>, <code>SGOSL</code>, <code>RL</code>, <code>XRF</code>;
</p>
<p><b>(9)</b> <em>Low</em>: Low (temperature, time, wavelength);
</p>
<p><b>(10)</b> <em>High</em>: High (temperature, time, wavelength);
</p>
<p><b>(11)</b> <em>Rate</em>: Rate (temperature, time, wavelength);
</p>
<p><b>(12)</b> <em>Temperature</em>: Sample temperature;
</p>
<p><b>(13)</b> <em>Delay</em>: TOL &quot;delay&quot; channels;
</p>
<p><b>(14)</b> <em>On</em>: TOL &quot;on&quot; channels;
</p>
<p><b>(15)</b> <em>Off</em>: TOL &quot;off&quot; channels;
</p>
<p><b>(16)</b> <em>LightSource</em>: Light source, includes: <code>None</code>, <code>Lamp</code>, <code>IRDiodes</code>,<br /> 
<code>CalibraitionLED</code>, <code>BlueDiodes</code>, <code>WhiteLight</code>, <code>GreenLaser</code>, <code>IRLaser</code>;
</p>
<p><b>(17)</b> <em>AnTemp</em>: Annealing temperature;
</p>
<p><b>(18)</b> <em>TimeSinceIrr</em>: Time since irradiation;
</p>
<p><b>(19)</b> <em>Time</em>: Data collection time;
</p>
<p><b>(20)</b> <em>Date</em>: Data collection date.
</p>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> of S3 class object <code>"loadBIN"</code> containing the following elements:
</p>
<table>
<tr><td><code>records</code></td>
<td>
<p>a <a href="base.html#topic+list">list</a> containing loaded data records</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>a table (<a href="base.html#topic+data.frame">data.frame</a>) summarizing items of loaded data records</p>
</td></tr>
</table>


<h3>Note</h3>

<p>We would like to appreciate Dr Lei Gao who prompts us to write this function and provides measured data sets to test this procedure.
</p>


<h3>References</h3>

<p>Duller GAT, 2016. Analyst (v4.31.9), User Mannual.
</p>


<h3>See Also</h3>

<p><a href="#topic+pickBINdata">pickBINdata</a>; <a href="#topic+analyseBINdata">analyseBINdata</a>; <a href="#topic+BIN">BIN</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   ### Not run.
   ### Ensure that file "foo.bin" is available 
   ### from the current working directory.
   # obj_loadBIN &lt;- loadBINdata("foo.bin", view=TRUE)
   # class(obj_loadBIN)
   # obj_loadBIN$records
</code></pre>

<hr>
<h2 id='lsNORM'>
Regenerative-dose signal optimization using the LS-normalisation procedure
</h2><span id='topic+lsNORM'></span><span id='topic+lsNORM.default'></span>

<h3>Description</h3>

<p>Optimizing standardised regenerative-dose signals according to the least-squares normalisation (LS-normalisation) procedure using an iterative scaling and fitting procedure proposed by Li et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lsNORM(SARdata, model = "gok", origin = FALSE, 
       weight = FALSE, natural.rm = TRUE, 
       norm.dose = NULL, maxiter = 10, 
       plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lsNORM_+3A_sardata">SARdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): SAR data used for performing the LS-normalisation<br />
procedure, it should contain five columns (i.e., <code>NO</code>, <code>SAR.Cycle</code>, <code>Dose</code>,<br />
<code>Signal</code>, and <code>Signal.Err</code>), see <a href="#topic+SARdata">SARdata</a> for details</p>
</td></tr>
<tr><td><code id="lsNORM_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): model used for growth curve fitting, see <a href="#topic+fitGrowth">fitGrowth</a> for available models</p>
</td></tr>
<tr><td><code id="lsNORM_+3A_origin">origin</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be forced to pass the origin</p>
</td></tr>
<tr><td><code id="lsNORM_+3A_weight">weight</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using a weighted procedure, see function <a href="#topic+fitGrowth">fitGrowth</a> for details</p>
</td></tr>
<tr><td><code id="lsNORM_+3A_natural.rm">natural.rm</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the standardised natural-dose signal 
should be removed from <code>SARdata</code></p>
</td></tr>
<tr><td><code id="lsNORM_+3A_norm.dose">norm.dose</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): regenerative-dose used for re-scaling established gSGC. 
For example, if <code>norm.dose=100</code>, then the signal value for a dose value of 100 (Gy|s) will be re-scaled to unity</p>
</td></tr>
<tr><td><code id="lsNORM_+3A_maxiter">maxiter</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): allowed maximum number of iterations during the<br />
LS-normalisation optimization process</p>
</td></tr>
<tr><td><code id="lsNORM_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the results should be plotted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+lsNORM">lsNORM</a> is used for optimizing regenerative-dose signal data from a number of grains (aliquots) according to the least-squares normalisation (LS-normalisation) procedure outlined by Li et al. (2016) using an iterative scaling and fitting procedure.<br /><br />
The LS-normalisation procedure for growth curve optimization involves the following steps:<br />
(1) Fit standardised regenerative-dose signals from all of the aliquots;<br />
(2) Re-scale the individual growth curve from each aliquot using a scaling factor. The scaling factor for each aliquot is determined in a way such that the sum of squared residuals is minimized. Each aliquots is treated individually, and different scaling factors are calculated for different aliquots.<br />
(3) Iterate the fitting (step 1) and re-scaling (step 2). The iterative procedure is performed repeatedly until there is negligible change in the relative standard deviation of the normalised growth curve data.
</p>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>norm.SARdata</code></td>
<td>
<p>SAR data sets optimized using the LS-normalisation procedure</p>
</td></tr>
<tr><td><code>sf</code></td>
<td>
<p>scaling factor of standardised regenerative-dose signals</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations required</p>
</td></tr>
<tr><td><code>LMpars1</code></td>
<td>
<p>optimized parameters for the growth curve before LS-normalisation</p>
</td></tr>
<tr><td><code>value1</code></td>
<td>
<p>minimized objective for the growth curve before LS-normalisation</p>
</td></tr>
<tr><td><code>avg.error1</code></td>
<td>
<p>average fit error for the growth curve before LS-normalisation</p>
</td></tr>
<tr><td><code>RCS1</code></td>
<td>
<p>reduced chi-square value for the growth curve before LS-normalisation</p>
</td></tr>
<tr><td><code>FOM1</code></td>
<td>
<p>figure of merit value for the growth curve before LS-normalisation in percent</p>
</td></tr>
<tr><td><code>LMpars2</code></td>
<td>
<p>optimized parameters for the growth curve after LS-normalisation</p>
</td></tr>
<tr><td><code>value2</code></td>
<td>
<p>minimized objective for the growth curve after LS-normalisation</p>
</td></tr>
<tr><td><code>avg.error2</code></td>
<td>
<p>average fit error for the growth curve after LS-normalisation</p>
</td></tr>
<tr><td><code>RCS2</code></td>
<td>
<p>reduced chi-square value for the growth curve after LS-normalisation</p>
</td></tr>
<tr><td><code>FOM2</code></td>
<td>
<p>figure of merit value for the growth curve after LS-normalisation in percent</p>
</td></tr> 
</table>


<h3>References</h3>

<p>Li B, Jacobs Z, Roberts RG, 2016. Investigation of the applicability of standardised growth curves for OSL dating of quartz from Haua Fteah cave, Libya. Quaternary Geochronology, 35: 1-15.
</p>


<h3>See Also</h3>

<p><a href="#topic+analyseBINdata">analyseBINdata</a>; <a href="#topic+fitGrowth">fitGrowth</a>; <a href="#topic+SARdata">SARdata</a>; <a href="#topic+scaleSGCN">scaleSGCN</a>; <a href="#topic+calSGCED">calSGCED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ### Example 1:
  data(SARdata)
  # Use only the first five aliquots of SARdata.
  Data &lt;- SARdata[1:40,]
  res_lsNORM &lt;- lsNORM(Data, model="gok")
  res_lsNORM$norm.SARdata

  ### Example 2 (not run):
  # data(BIN)
  # obj_pickBIN &lt;- pickBINdata(BIN, Position=1:48, Grain=0,
  #                            LType="OSL", view=FALSE)
  # obj_analyseBIN &lt;- analyseBINdata(obj_pickBIN, nfchn=3, nlchn=20)
  # lsNORM(obj_analyseBIN$SARdata, norm.dose=300)
  
  
</code></pre>

<hr>
<h2 id='mcFMM'>
Finite mixture age model optimization (using a Markov chain Monte Carlo method)
</h2><span id='topic+mcCAM'></span><span id='topic+mcFMM'></span><span id='topic+mcFMM.default'></span>

<h3>Description</h3>

<p>Sampling from the joint-likelihood functions of finite mixture age models (include the central age model) using a Markov chain Monte Carlo (MCMC) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcCAM(EDdata, addsigma = 0, iflog = TRUE, 
      nsim = 50000, inis = list(), control.args = list())

mcFMM(EDdata, ncomp = 2, addsigma = 0, iflog = TRUE, 
      nsim = 50000, inis = list(), control.args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcFMM_+3A_eddata">EDdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>):  a two-column matrix (i.e., equivalent dose values and<br />
associated standard errors)</p>
</td></tr>
<tr><td><code id="mcFMM_+3A_ncomp">ncomp</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): number of components</p>
</td></tr>
<tr><td><code id="mcFMM_+3A_addsigma">addsigma</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): additional uncertainty, i.e., the sigmab value</p>
</td></tr>
<tr><td><code id="mcFMM_+3A_iflog">iflog</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): transform equivalent dose values to log-scale or not</p>
</td></tr>
<tr><td><code id="mcFMM_+3A_nsim">nsim</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): deseried number of iterations</p>
</td></tr>
<tr><td><code id="mcFMM_+3A_inis">inis</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(with default): initial state of parameters.<br /> 
Example: <code>inis=list(p1=1,p2=1,mu1=5,mu2=10)</code> in FMM2 (the sum of <code>p1</code> and <code>p2</code> will be normalized to 1 during the simulation)</p>
</td></tr>
<tr><td><code id="mcFMM_+3A_control.args">control.args</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(with default): arguments used in the Slice Sampling algorithm, see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+mcFMM">mcFMM</a> is used for sampling from the joint-likelihood functions of finite mixture age models (include the central age model) using a Markov chain Monte Carlo sampling algorithm called Slice Sampling (Neal, 2003). Three arguments (<code>control.args</code>) are used for controling the sampling process:<br />
<b>(1)</b> <em>w</em>: size of the steps for creating an interval from which to sample, default <code>w=1</code>; <br />
<b>(2)</b> <em>m</em>: limit on steps for expanding an interval, <code>m&lt;=1</code> means no limit on the expandation, <code>m&gt;1</code> means the interval is expanded with a finite number of iterations, default <code>m=-100</code>;<br />
<b>(3)</b> <em>nstart</em>: maximum number of trials for updating a variable in an iteration. It can be used for monitoring the stability of the simulation. For example, a MAM4 is likely to crash down for data sets with small numbers of data points or less dispersed distributions (see section 8.3 of Galbraith and Roberts, 2012 for a discussion), and sometimes more than one trial (i.e., using <code>nstart&gt;1</code>) is required to complete the sampling process, default <code>nstart=1</code>.
</p>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> of S3 class object <code>"mcAgeModels"</code> including the following elements:
</p>
<table>
<tr><td><code>EDdata</code></td>
<td>
<p>equivalent dose values</p>
</td></tr>
<tr><td><code>addsigma</code></td>
<td>
<p>additional uncertainty</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>fitting model</p>
</td></tr>
<tr><td><code>iflog</code></td>
<td>
<p>transform equivalent dose values to log-scale or not</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>
<p>number of iterations</p>
</td></tr>
<tr><td><code>chains</code></td>
<td>
<p>simulated samples of parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Galbraith RF, Green P, 1990. Estimating the component ages in a finite mixture. International Journal of Radiation Applications and Instrumentation. Part D. Nuclear Tracks and Radiation Measurements, 17: 197-206.
</p>
<p>Neal RM, 2003. &quot;Slice sampling&quot; (with discussion). Annals of Statistics, 31(3): 705-767. Software is freely available at <a href="https://glizen.com/radfordneal/slice.software.html">https://glizen.com/radfordneal/slice.software.html</a>.
</p>
<p>Peng J, Dong ZB, Han FQ, 2016. Application of slice sampling method for optimizing OSL age models used for equivalent dose determination. Progress in Geography, 35(1): 78-88. (In Chinese).
</p>


<h3>See Also</h3>

<p><a href="#topic+mcMAM">mcMAM</a>; <a href="#topic+reportMC">reportMC</a>; <a href="#topic+RadialPlotter">RadialPlotter</a>; <a href="#topic+optimSAM">optimSAM</a>; <a href="#topic+sensSAM">sensSAM</a>; <a href="#topic+EDdata">EDdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Not run.
  # data(EDdata)
  # Construct a MCMC chain for CAM.
  # obj&lt;-mcCAM(EDdata$gl11,nsim=5000)
  # reportMC(obj,thin=2,burn=1e3)
  
  # Construct a MCMC chain for FMM3.
  # obj&lt;-mcFMM(EDdata$gl11,ncomp=3,nsim=5000)
  # reportMC(obj,thin=2,burn=1e3)
</code></pre>

<hr>
<h2 id='mcMAM'>
Optimization of the minimum (maximum) age model  (using a Markov chain Monte Carlo method)
</h2><span id='topic+mcMAM'></span><span id='topic+mcMAM.default'></span>

<h3>Description</h3>

<p>Sampling from the joint-likelihood function of the minimum (maximum) age model using a Markov chain Monte Carlo (MCMC) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcMAM(EDdata, ncomp = -1, addsigma = 0, iflog = TRUE, 
      nsim = 50000, inis = list(), control.args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcMAM_+3A_eddata">EDdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a two-column matrix (i.e., equivalent dose values and<br />
associated standard errors)</p>
</td></tr>
<tr><td><code id="mcMAM_+3A_ncomp">ncomp</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): number of components, <code>ncomp=-1</code>, <code>ncomp=-2</code>, <code>ncomp=-3</code>, or <code>ncomp=-4</code> indicate fitting the <code>"MAM3"</code>, <code>"MAM4"</code>, <code>"MXAM3"</code>, and <code>"MXAM4"</code>, respectively</p>
</td></tr>
<tr><td><code id="mcMAM_+3A_addsigma">addsigma</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): additional uncertainty, i.e., the sigmab value</p>
</td></tr>
<tr><td><code id="mcMAM_+3A_iflog">iflog</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): transform equivalent dose values to log-scale or not</p>
</td></tr>
<tr><td><code id="mcMAM_+3A_nsim">nsim</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): deseried number of iterations</p>
</td></tr>
<tr><td><code id="mcMAM_+3A_inis">inis</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(with default): initial state of parameters.<br />
Example: <code>inis=list(p=0.1,gamma=20,sigma=0.3)</code> when <code>ncomp=-1</code></p>
</td></tr>
<tr><td><code id="mcMAM_+3A_control.args">control.args</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(with default): arguments used by the Slice Sampling algorithm, see function <a href="#topic+mcFMM">mcFMM</a> for details</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> of S3 class object <code>"mcAgeModels"</code>. See <a href="#topic+mcFMM">mcFMM</a> for details.
</p>


<h3>References</h3>

<p>Galbraith RF, Roberts RG, Laslett GM, Yoshida H, Olley JM, 1999. Optical dating of single grains of quartz from Jinmium rock shelter, northern Australia. Part I: experimental design and statistical models. Archaeometry, 41(2): 339-364.
</p>
<p>Neal RM, 2003. &quot;Slice sampling&quot; (with discussion). Annals of Statistics, 31(3): 705-767. Software is freely available at <a href="https://glizen.com/radfordneal/slice.software.html">https://glizen.com/radfordneal/slice.software.html</a>.
</p>
<p>Peng J, Dong ZB, Han FQ, 2016. Application of slice sampling method for optimizing OSL age models used for equivalent dose determination. Progress in Geography, 35(1): 78-88. (In Chinese).
</p>


<h3>See Also</h3>

<p><a href="#topic+mcFMM">mcFMM</a>; <a href="#topic+reportMC">reportMC</a>; <a href="#topic+RadialPlotter">RadialPlotter</a>; <a href="#topic+EDdata">EDdata</a>; <a href="#topic+optimSAM">optimSAM</a>; <a href="#topic+sensSAM">sensSAM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Not run.
  # data(EDdata)
  # Construct a MCMC chain for MAM3.
  # obj&lt;-mcMAM(EDdata$al3,ncomp=-1,addsigma=0.1,nsim=5000)
  # reportMC(obj,burn=1e3,thin=2)
  #
  # The convergence of the simulations may be diagnosed with 
  # the Gelman and Rubin's convergence diagnostic.
  # library(coda)   # Only if package "coda" has been installed.
  # args&lt;-list(nstart=50)
  # inis1&lt;-list(p=0.01,gamma=26,mu=104,sigma=0.01)
  # inis2&lt;-list(p=0.99,gamma=100,mu=104,sigma=4.99)
  # obj1&lt;-mcMAM(EDdata$al3,ncomp=-2,nsim=3000,inis=inis1,control.args=args)
  # obj2&lt;-mcMAM(EDdata$al3,ncomp=-2,nsim=3000,inis=inis2,control.args=args)
  # chain1&lt;-mcmc(obj1$chains)
  # chain2&lt;-mcmc(obj2$chains)
  # chains&lt;-mcmc.list(chain1,chain2)
  # gelman.plot(chains)
</code></pre>

<hr>
<h2 id='numOSL-package'>Package for tackling basic numeric problems in optically stimulated luminescence dating</h2><span id='topic+numOSL-package'></span>

<h3>Description</h3>

<p>Package for routine numeric optimization and data visualization in optically stimulated luminescence dating.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> numOSL</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.8</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-12-06</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>


<table>
<tr>
 <td style="text-align: left;">
Jun Peng </td><td style="text-align: left;"> Hunan University of Science and Technology (HNUST), Xiangtan, China </td>
</tr>
<tr>
 <td style="text-align: left;">
Bo Li </td><td style="text-align: left;"> University of Wollongong (UOW), Wollongong, Australia</td>
</tr>
<tr>
 <td style="text-align: left;">
Chunxin Wang </td><td style="text-align: left;"> University of Science and Technology of China, Hefei, China
</td>
</tr>

</table>

<p><b>Package maintainer</b><br />
Jun Peng
<a href="mailto:pengjun10@mails.ucas.ac.cn">pengjun10@mails.ucas.ac.cn</a>
</p>
<p><b>Related package projects</b><br />
R program KMS
<a href="https://github.com/pengjunUCAS/KMS">https://github.com/pengjunUCAS/KMS</a><br />
R package tgcd
<a href="https://CRAN.R-project.org/package=tgcd">https://CRAN.R-project.org/package=tgcd</a>
</p>


<h3>References</h3>

<p>Peng J, Dong ZB, Han FQ, Long H, Liu XJ, 2013. R package numOSL: numeric routines for optically stimulated luminescence dating. Ancient TL, 31(2): 41-48.
</p>
<p>Peng J, Li Bo, 2017. Single-aliquot Regenerative-Dose (SAR) and Standardised Growth Curve (SGC) Equivalent Dose Determination in a Batch Model Using the R Package 'numOSL'. Ancient TL, 35(2): 32-53.
</p>

<hr>
<h2 id='optimSAM'>
Optimization of statistical age models
</h2><span id='topic+optimSAM'></span><span id='topic+optimSAM.default'></span>

<h3>Description</h3>

<p>Estimating the parameters of statistical age models, including the common age model (COM), the central age model (CAM), the minimum age model (MAM), the maximum age model (MXAM), and the finite mixture age model (FMM), using the Maximum Likelihood Estimation method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimSAM(EDdata, model = "cam", addsigma = 0, iflog = TRUE, maxcomp = 6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimSAM_+3A_eddata">EDdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a two-column matrix (i.e., equivalent dose values and<br />
associated standard errors)</p>
</td></tr>
<tr><td><code id="optimSAM_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): the fitting model, one of <code>"com"</code>, <code>"cam"</code>, <code>"mam3"</code>, <code>"mam4"</code>,
<code>"mxam3"</code>, <code>"mxam4"</code>, <code>"fmm0"</code>, <code>"fmm1"</code>, <code>"fmm2"</code>, ..., <code>"fmm9"</code></p>
</td></tr>
<tr><td><code id="optimSAM_+3A_addsigma">addsigma</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): additional uncertainty, i.e., the sigmab value</p>
</td></tr>
<tr><td><code id="optimSAM_+3A_iflog">iflog</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): transform equivalent dose values to log-scale or not</p>
</td></tr>
<tr><td><code id="optimSAM_+3A_maxcomp">maxcomp</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): the maximum number of components in FMM</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>pars</code></td>
<td>
<p>optimized parameters, the name of the parameter of COM is <code>"COM.De"</code>, that of CAM are <code>c("CAM.OD","CAM.De")</code>, that of MAM3 are <code>c("Prop","MAM3.De","Sigma")</code>, that of MXAM3 are <code>c("Prop","MXAM3.De","Sigma")</code>, that of MAM4 are<br /> <code>c("Prop","MAM4.De","Mu","Sigma")</code>, that of MXAM4 are<br /> <code>c("Prop","MXAM4.De","Mu","Sigma")</code>, and that of FMM are 
<code>c("Prop","FMM.De")</code></p>
</td></tr>
<tr><td><code>maxlik</code></td>
<td>
<p>optimized maximum logged likelihood value</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>calculated Bayesian Information Criterion (BIC) value</p>
</td></tr>
</table>


<h3>References</h3>

<p>Galbraith RF, 1988. Graphical display of estimates having differing standard errors. Technometrics, 30(3): 271-281.
</p>
<p>Galbraith RF, 1990. The radial plot: Graphical assessment of spread in ages. International Journal of Radiation Applications and Instrumentation. Part D. Nuclear Tracks and Radiation Measurements, 17(3): 207-214.
</p>
<p>Galbraith RF, Green P, 1990. Estimating the component ages in a finite mixture. International Journal of Radiation Applications and Instrumentation. Part D. Nuclear Tracks and Radiation Measurements, 17: 197-206.
</p>
<p>Galbraith RF, Laslett GM, 1993. Statistical models for mixed fission track ages. Nuclear Tracks And Radiation Measurements, 21(4): 459-470.
</p>
<p>Galbraith RF, 1994. Some applications of radial plots. Journal of the American Statistical Association, 89(428): 1232-1242.
</p>
<p>Galbraith RF, Roberts RG, Laslett GM, Yoshida H, Olley JM, 1999. Optical dating of single grains of quartz from Jinmium rock shelter, northern Australia. Part I: experimental design and statistical models. Archaeometry, 41(2): 339-364.
</p>
<p>Galbraith RF, 2005. Statistics for fission track analysis. Chapman &amp; Hall/CRC Press.
</p>
<p>Galbraith RF, 2010. On plotting OSL equivalent doses. Ancient TL, 28(1): 1-10.
</p>
<p>Galbraith RF, Roberts RG, 2012. Statistical aspects of equivalent dose and error calculation and display in OSL dating: an overview and some recommendations. Quaternary Geochronology, 11: 1-27.
</p>


<h3>See Also</h3>

<p><a href="#topic+mcMAM">mcMAM</a>; <a href="#topic+mcFMM">mcFMM</a>; <a href="#topic+dbED">dbED</a>; <a href="#topic+psRadialPlot">psRadialPlot</a>; <a href="#topic+RadialPlotter">RadialPlotter</a>; <a href="#topic+EDdata">EDdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(EDdata)
  
  ### Fitting a 3-component FMM.
  optimSAM(EDdata$al3, model="fmm3", addsigma=0)

  ### Fitting a 4-parameter MXAM.
  optimSAM(EDdata$al3, model="mxam4", addsigma=0.1)
</code></pre>

<hr>
<h2 id='pickBINdata'>
BIN data set selection
</h2><span id='topic+pickBINdata'></span><span id='topic+pickBINdata.default'></span>

<h3>Description</h3>

<p>Extracting data sets from a loaded BIN (BINX) file. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pickBINdata(obj_loadBIN, Position = NULL, Grain = NULL, 
            Run = NULL, Set = NULL, DType = NULL, 
            IRRTime = NULL, NPoints = NULL, LType = NULL, 
            Low = NULL, High = NULL, Rate = NULL, 
            Temperature = NULL, Delay = NULL, On = NULL, 
            Off = NULL, LightSource = NULL, AnTemp = NULL, 
            TimeSinceIrr = NULL, view = TRUE, 
            manual.select = FALSE, force.matrix = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pickBINdata_+3A_obj_loadbin">obj_loadBIN</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(<b>required</b>): an object of S3 class <code>"loadBIN"</code> produced by<br /> 
function <a href="#topic+loadBINdata">loadBINdata</a></p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_position">Position</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): carousel position, Example: <code>Position=1:48</code></p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_grain">Grain</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): grain number</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_run">Run</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): run number</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_set">Set</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): set number</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_dtype">DType</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): a character vector indicating data type,<br />
Example: <code>DType=c("Natural", "N+dose")</code></p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_irrtime">IRRTime</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): irradiation time</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_npoints">NPoints</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): number of data points</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_ltype">LType</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): a character vector indicating luminescence types,<br /> 
Example: <code>LType="OSL"</code></p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_low">Low</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): lower limit on temperature, time, or wavelength</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_high">High</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): upper limit on temperature, time, or wavelength</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_rate">Rate</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): increasing rate of temperature, time, or wavelength</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_temperature">Temperature</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a vector indicating the sample temperatures</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_delay">Delay</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): TOL &quot;delay&quot; channels</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_on">On</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): TOL &quot;on&quot; channels</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_off">Off</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): TOL &quot;off&quot; channels</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_lightsource">LightSource</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): a character vector indicating light source,<br />
Example: <code>LightSource="BlueDiodes"</code></p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_antemp">AnTemp</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): annealing temperature</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_timesinceirr">TimeSinceIrr</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): time since irradiation</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_view">view</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the loaded data should be<br />
visualized in a Summary Table</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_manual.select">manual.select</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the loaded data should be<br />
selected manually using a Summary Table</p>
</td></tr>
<tr><td><code id="pickBINdata_+3A_force.matrix">force.matrix</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the picked data sets of an aliquot (grain) should be transformed into a matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+pickBINdata">pickBINdata</a> is used for pick up data sets from an object of S3 class <code>"loadBIN"</code> generated using function <a href="#topic+loadBINdata">loadBINdata</a>.
Set <code>force.matrix=TRUE</code> will transform data sets of an aliquot (grain) into a matrix, the transformation fails if data sets have different x (temperature, time, or wavelength) coordinates.
Transformed data sets stored in a matrix can be visualize via <a href="graphics.html#topic+matplot">matplot</a> (see examples).  
</p>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> of S3 class object <code>"pickBIN"</code> containing two elements:
</p>
<table>
<tr><td><code>BINdata</code></td>
<td>
<p>selected BIN data</p>
</td></tr>
<tr><td><code>agID</code></td>
<td>
<p>Aliquot or grain ID (i.e., <code>c("NO","Position","Grain")</code>) of selected data sets, it returns <code>NULL</code> if <code>force.matrix=TRUE</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Duller GAT, 2016. Analyst (v4.31.9), User Mannual.
</p>


<h3>See Also</h3>

<p><a href="#topic+loadBINdata">loadBINdata</a>; <a href="#topic+analyseBINdata">analyseBINdata</a>; <a href="#topic+BIN">BIN</a>; <a href="#topic+decomp">decomp</a>; <a href="#topic+fastED">fastED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   ### Example 1 (visualize decay curves for Position=2):
   data(BIN)
   obj_pickBIN &lt;- pickBINdata(BIN, Position=2, view=FALSE,
                              LType="OSL", force.matrix=TRUE)
   matplot(obj_pickBIN$BINdata[[1]][,1], 
           obj_pickBIN$BINdata[[1]][,-1], 
           main="Decay curves",
           xlab="Stimulation time (s)",
           ylab="Photon counts",
           type="l", log="xy")

  ### Example 2 (visualize test-dose decay curves for Position=2):
  obj_pickBIN &lt;- pickBINdata(BIN, Position=2, Run=c(5,11,17,23,29,34,40), 
                             view=FALSE, LType="OSL", force.matrix=TRUE)
  matplot(obj_pickBIN$BINdata[[1]][,1], 
          obj_pickBIN$BINdata[[1]][,-1], 
          main="Test-dose decay curves",
          xlab="Stimulation time (s)",
          ylab="Photon counts",
          type="l", log="xy")

  ### Example 3 (visualize regenerative-dose decay curves for Position=2):
  obj_pickBIN &lt;- pickBINdata(BIN, Position=2, Run=c(8,14,20,26,31,37), 
                             view=FALSE, LType="OSL", force.matrix=TRUE)
  matplot(obj_pickBIN$BINdata[[1]][,1], 
          obj_pickBIN$BINdata[[1]][,-1], 
          main="Regenerative-dose decay curves",
          xlab="Stimulation time (s)",
          ylab="Photon counts",
          type="l", log="xy")

</code></pre>

<hr>
<h2 id='pickSARdata'>
SAR data set selection
</h2><span id='topic+pickSARdata'></span><span id='topic+pickSARdata.default'></span>

<h3>Description</h3>

<p>Selecting SAR data sets (growth curves) in a batch model according to specified rejection criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pickSARdata(obj_analyseBIN, model = "gok", origin = FALSE, 
            weight = TRUE, trial = TRUE, nofit.rgd = NULL, 
            Tn.above.3BG = TRUE, TnBG.ratio.low = NULL, 
            rseTn.up = NULL, FR.low = NULL, rcy1.range = NULL, 
            rcy2.range = NULL, rcy3.range = NULL, 
            rcp1.up = NULL, rcp2.up = NULL, fom.up = NULL, 
            rcs.up = NULL, use.se = TRUE, norm.dose = NULL, 
            outpdf = NULL, outfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pickSARdata_+3A_obj_analysebin">obj_analyseBIN</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(<b>required</b>): an object of S3 class &quot;analyseBIN&quot; produced by<br /> 
function <a href="#topic+analyseBINdata">analyseBINdata</a> or <a href="#topic+as_analyseBIN">as_analyseBIN</a></p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): model used for growth curve fitting, see <a href="#topic+fitGrowth">fitGrowth</a> for available models</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_origin">origin</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be forced to pass the origin</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_weight">weight</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using a weighted procedure, 
see function <a href="#topic+fitGrowth">fitGrowth</a> for details</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_trial">trial</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the growth curve should be fitted using other models if the given model fails, see function <a href="#topic+fitGrowth">fitGrowth</a> for details</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_nofit.rgd">nofit.rgd</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(optional): regenerative doses that will not be used during the fitting. 
For example, if <code>nofit.rgd=2</code> then the second regenerative dose will not be used during growth curve fitting</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_tn.above.3bg">Tn.above.3BG</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if aliquot (grain) with Tn below 3 sigma BG should be rejected</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_tnbg.ratio.low">TnBG.ratio.low</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): lower limit on ratio of initial Tn signal to BG</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_rsetn.up">rseTn.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on relative standard error of Tn in percent</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_fr.low">FR.low</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): lower limit on fast ratio of Tn</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_rcy1.range">rcy1.range</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector indicating the lower and upper limits on recycling ratio 1, 
Example: <code>rcy1.range=c(0.9,1.1)</code></p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_rcy2.range">rcy2.range</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector indicating the lower and upper limits on recycling ratio 2</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_rcy3.range">rcy3.range</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a two-element vector indicating the lower and upper limits on recycling ratio 3</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_rcp1.up">rcp1.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on recuperation 1 (i.e., ratio of the<br />
sensitivity-corrected zero-dose signal to natural-dose signal) in percent</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_rcp2.up">rcp2.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on recuperation 2 (i.e., ratio of the<br />
sensitivity-corrected zero-dose signal to maximum regenerative-dose signal)<br />
in percent</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_fom.up">fom.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on figure of merit (FOM) values of growth curves in percent</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_rcs.up">rcs.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on reduced chi-square (RCS) values of growth curves</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_use.se">use.se</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if standard errors of values should be used during application of rejection criteria</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_norm.dose">norm.dose</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): dose value used for SAR data set re-normalisation, 
for example, if <code>norm.dose=100</code>, then sensitivity-corrected signal for <code>Redose=100</code> obtained 
through growth curve fitting will be used to re-normalise a SAR data set</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_outpdf">outpdf</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, results of growth curve fitting will be written to 
a PDF file named <code>"outpdf"</code> and saved to the current work directory</p>
</td></tr>
<tr><td><code id="pickSARdata_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, SAR data related quantities will be written
to a CSV file named <code>"outfile"</code> and saved to the current work directory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>LMpars</code></td>
<td>
<p>a <a href="base.html#topic+list">list</a> containing optimized parameters of growth curves of selected SAR data sets</p>
</td></tr>
<tr><td><code>SARdata</code></td>
<td>
<p>a <a href="base.html#topic+data.frame">data.frame</a> containing selected SAR data sets</p>
</td></tr>
<tr><td><code>norm.SARdata</code></td>
<td>
<p>a <a href="base.html#topic+data.frame">data.frame</a> containing re-normalised SAR data sets,<br />
it returns <code>NULL</code> if <code>norm.dose=NULL</code></p>
</td></tr>
<tr><td><code>agID</code></td>
<td>
<p>aliquot or grain ID (i.e., <code>c("NO","Position","Grain")</code>) of selected SAR data</p>
</td></tr>
<tr><td><code>summary.info</code></td>
<td>
<p>a summary of the SAR data selection</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+analyseBINdata">analyseBINdata</a>; <a href="#topic+fitGrowth">fitGrowth</a>; <a href="#topic+lsNORM">lsNORM</a>; <a href="#topic+calSARED">calSARED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Not run.
 # data(BIN)
 # obj_pickBIN &lt;- pickBINdata(BIN, Position=1:48, Grain=0, 
 #                            LType="OSL", view=FALSE)
 # obj_analyseBIN &lt;- analyseBINdata(obj_pickBIN, nfchn=3, nlchn=20) 
 # pickSARdata(obj_analyseBIN, model="gok", fom.up=3, outpdf="SARdata")
</code></pre>

<hr>
<h2 id='psRadialPlot'>
Pseudo radial plot drawing
</h2><span id='topic+psRadialPlot'></span><span id='topic+psRadialPlot.default'></span>

<h3>Description</h3>

<p>Drawing a pseudo (simplified) radial plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psRadialPlot(EDdata, addsigma = 0, dose = NULL, 
             zmin = NULL, zmax = NULL, ntick = 6, 
             digits = 2, pcolor = "blue", psize = 1, 
             rg = 2, zlabel = "De (Gy)")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psRadialPlot_+3A_eddata">EDdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a two-column matrix (i.e., equivalent dose values and<br />
associated standard errors)</p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_addsigma">addsigma</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): additional uncertainty</p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_dose">dose</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): dose population(s) to be drawn</p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_zmin">zmin</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): lower limit on z-axis</p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_zmax">zmax</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): upper limit on z-axis</p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_ntick">ntick</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): desired number of ticks in z-axis</p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_digits">digits</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): number of decimal places or significant digits for values shown in z-axis</p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_pcolor">pcolor</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): color of a data point, input <a href="grDevices.html#topic+colors">colors</a>() to see more available colors</p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_psize">psize</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): size of a data point</p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_rg">rg</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): range of a dose population, <code>0=dose</code>,<br /> 
<code>1=dose+/-sigma</code>, <code>2=dose+/-2sigma</code></p>
</td></tr>
<tr><td><code id="psRadialPlot_+3A_zlabel">zlabel</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): title for the z-axis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+psRadialPlot">psRadialPlot</a> is used for drawing a simplified radial plot in which the z-axis is a straight line. The pseudo radial plot is easier to construct compared to the regular radial plot. This function can be adopted to display estimates that have different error estimates in any field of the analytical sciences. Note that the function handles datasets in log-scale, so any minus observation is not allowed.
</p>


<h3>Value</h3>

<p>Return a pseudo radial plot
</p>


<h3>References</h3>

<p>Galbraith RF, 1988. Graphical display of estimates having differing standard errors. Technometrics, 30(3): 271-281.
</p>
<p>Galbraith RF, 1994. Some applications of radial plots. Journal of the American Statistical Association, 89(428): 1232-1242.
</p>
<p>Galbraith RF, 2010. On plotting OSL equivalent doses. Ancient TL, 28(1): 1-10.
</p>
<p>Galbraith RF, Roberts RG, Laslett GM, Yoshida H, Olley JM, 1999. Optical dating of single grains of quartz from Jinmium rock shelter, northern Australia. Part I: experimental design and statistical models. Archaeometry, 41(2): 339-364.
</p>


<h3>See Also</h3>

<p><a href="#topic+dbED">dbED</a>; <a href="#topic+RadialPlotter">RadialPlotter</a>; <a href="#topic+EDdata">EDdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   data(EDdata)
   psRadialPlot(EDdata$al3, addsigma=0.10, 
                dose=c(39.14, 51.27, 79.14), digits=1,
                zmin=30, zmax=100, ntick=10, rg=1)
</code></pre>

<hr>
<h2 id='RadialPlotter'>
Statistical age model optimization (with a Maximum Likelihood Estimation method) 
</h2><span id='topic+RadialPlotter'></span><span id='topic+RadialPlotter.default'></span>

<h3>Description</h3>

<p>Depending on the specified number of components, this function performs statistical age models analysis reviewed in Galbraith and Roberts (2012) dynamically using a Maximum Likelihood Estimation method. Age models that can be applied include: central age model (CAM), minimum age model (MAM), and finite mixture age model (FMM). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RadialPlotter(EDdata, ncomp = 0, addsigma = 0, 
              maxcomp = 6, algorithm = c("port","lbfgsb"),
              plot = TRUE, pcolor = "blue", psize = 1.5, 
              kratio = 0.3, zscale = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RadialPlotter_+3A_eddata">EDdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a two-column matrix (i.e., equivalent dose values and<br />
associated standard errors)</p>
</td></tr>
<tr><td><code id="RadialPlotter_+3A_ncomp">ncomp</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): number of components, <code>ncomp=-1</code>, <code>ncomp=-2</code>, and <code>ncomp=1</code> mean respectively fitting <code>"MAM3"</code>, <code>"MAM4"</code>, and <code>"CAM"</code>, <code>ncomp=0</code> means fitting <code>"FMM"</code> with an automatically optimized number of components, and <code>ncomp=k</code> (k&gt;=2) means fitting <code>"FMM"</code> with k components</p>
</td></tr>
<tr><td><code id="RadialPlotter_+3A_addsigma">addsigma</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): additional uncertainty, i.e., the sigmab value</p>
</td></tr>
<tr><td><code id="RadialPlotter_+3A_maxcomp">maxcomp</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): maximum number of components in FMM</p>
</td></tr>
<tr><td><code id="RadialPlotter_+3A_algorithm">algorithm</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): algorithm used for optimizing MAM,<br />
default <code>algorithm="port"</code></p>
</td></tr>
<tr><td><code id="RadialPlotter_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): draw a radial plot or not</p>
</td></tr>
<tr><td><code id="RadialPlotter_+3A_pcolor">pcolor</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): color of a data point, input <a href="grDevices.html#topic+colors">colors</a>() to see more available colors</p>
</td></tr>
<tr><td><code id="RadialPlotter_+3A_psize">psize</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): size of a data point</p>
</td></tr>
<tr><td><code id="RadialPlotter_+3A_kratio">kratio</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): argument controlling the shape of zscale</p>
</td></tr>
<tr><td><code id="RadialPlotter_+3A_zscale">zscale</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): argument controlling the scale of z-axis.<br />
Example: <code>zscale=seq(min(EDdata),max(EDdata),by=3L)</code></p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>Both CAM and FMM are fitted using a iterative Maximum Likelihood Estimation procedure outlined by Galbraith (1988), while MAM can be estimated using either the &quot;L-BFGS-B&quot; algorithm (<b><em>R</em></b> function <a href="stats.html#topic+optim">optim</a> in package <b><em>stats</em></b>) or the &quot;port&quot; algorithm (<b><em>R</em></b> function <a href="stats.html#topic+nlminb">nlminb</a> in package <b><em>stats</em></b>).
</p>


<h3>Value</h3>

<p>Return an object of S3 class <code>"RadialPlotter"</code> that contains the following elements:
</p>
<table>
<tr><td><code>pars</code></td>
<td>
<p>optimized parameters, the names of CAM parameters are <code>c("CAM.OD","CAM.De")</code>, those of MAM3 paramters are <code>c("Prop","MAM3.De","Sigma")</code>, those of MAM4 parameters are <code>c("Prop","MAM4.De","Mu","Sigma")</code>, and those of FMM parameters are <code>c("Prop", "FMM.De")</code></p>
</td></tr>
<tr><td><code>maxlik</code></td>
<td>
<p>optimized maximum logged likelihood value</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>calculated Bayesian Information Criterion (BIC) value</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Function <a href="#topic+RadialPlotter">RadialPlotter</a> was given the same name as the <b><em>Java</em></b> package <b><em>RadialPlotter</em></b> written by Pieter Vermeesch (Vermeesch, 2009). Note that this function fits a model in log-scale, hence any minus equivalent dose value is not allowed, and that the procedure will return an error if any standard error of a parameter cannot be estimated by numerical difference-approximation.<br /><br />
The original <b><em>S</em></b> code for drawing a radial plot was written by Rex Galbraith and was transformed to <b><em>R</em></b> by Sebastian Kreutzer. The code for drawing radial plot in this function was modified from package <b><em>Luminescence</em></b> written by Kreutzer et al. (2012). We thank Dr Rex Galbraith for his permission to modify and bundle the code to this function. We also thank Dr Silke Schmidt, Dr Helena Rodnight, Dr Xian-Jiao Ou, and Dr Amanda Keen-Zebert for providing published OSL data sets to test this routine.<br /><br />
This function only considered the optimization of statistical age models (including CAM, MAM, and FMM) in a log-scale and will not be updated in future. The newly developed function <a href="#topic+optimSAM">optimSAM</a> allows the optimzation of age models (including COM, MAM, MXAM, and FMM) in either log- or unlog-scale, and the accompanied function <a href="#topic+sensSAM">sensSAM</a> allows the optimization of these age models with a number of different sizes of additional uncertainty (sigmab).
</p>


<h3>References</h3>

<p>Galbraith RF, 1988. Graphical display of estimates having differing standard errors. Technometrics, 30(3): 271-281.
</p>
<p>Galbraith RF, 1990. The radial plot: Graphical assessment of spread in ages. International Journal of Radiation Applications and Instrumentation. Part D. Nuclear Tracks and Radiation Measurements, 17(3): 207-214.
</p>
<p>Galbraith RF, Green P, 1990. Estimating the component ages in a finite mixture. International Journal of Radiation Applications and Instrumentation. Part D. Nuclear Tracks and Radiation Measurements, 17: 197-206.
</p>
<p>Galbraith RF, Laslett GM, 1993. Statistical models for mixed fission track ages. Nuclear Tracks And Radiation Measurements, 21(4): 459-470.
</p>
<p>Galbraith RF, 1994. Some applications of radial plots. Journal of the American Statistical Association, 89(428): 1232-1242.
</p>
<p>Galbraith RF, Roberts RG, Laslett GM, Yoshida H, Olley JM, 1999. Optical dating of single grains of quartz from Jinmium rock shelter, northern Australia. Part I: experimental design and statistical models. Archaeometry, 41(2): 339-364.
</p>
<p>Galbraith RF, 2005. Statistics for fission track analysis. Chapman &amp; Hall/CRC Press.
</p>
<p>Galbraith RF, 2010. On plotting OSL equivalent doses. Ancient TL, 28(1): 1-10.
</p>
<p>Galbraith RF, Roberts RG, 2012. Statistical aspects of equivalent dose and error calculation and display in OSL dating: an overview and some recommendations. Quaternary Geochronology, 11: 1-27.
</p>
<p><b>Further reading</b>
</p>
<p>Duller GAT, 2008. Single-grain optical dating of Quaternary sediments: why aliquot size matters in luminescence dating. Boreas, 37(4): 589-612.
</p>
<p>Kreutzer S, Schmidt C, Fuchs MC, Dietze M, Fischer M, Fuchs M, 2012. Introducing an R package for luminescence dating analysis. Ancient TL, 30(1): 1-8. 
Software is freely available at <a href="https://CRAN.R-project.org/package=Luminescence">https://CRAN.R-project.org/package=Luminescence</a>.
</p>
<p>Rodnight H, 2008. How many equivalent dose values are needed to obtain a reproducible distribution? Ancient TL, 26(1): 3-10.
</p>
<p>Rodnight H, Duller GAT, Wintle AG, Tooth S, 2006. Assessing the reproducibility and accuracy of optical dating of fluvial deposits. Quaternary Geochronology, 1(2): 109-120.
</p>
<p>Schmidt S, Tsukamoto S, Salomon E, Frechen M, Hetzel R, 2012. Optical dating of alluvial deposits at the orogenic front of the andean precordillera (Mendoza, Argentina). Geochronometria, 39(1): 62-75.
</p>
<p>Vermeesch P, 2009. RadialPlotter: a Java application for fission track, luminescence and other radial plots. Radiation Measurements, 44: 409-410. 
Software is freely available at <a href="https://www.ucl.ac.uk/~ucfbpve/radialplotter/">https://www.ucl.ac.uk/~ucfbpve/radialplotter/</a>.
</p>
<p>Peng J, Li B, Jacobs Z, 2020. Modelling heterogeneously bleached single-grain equivalent dose distributions: Implications for the reliability of burial dose determination. Quaternary Geochronology, 60: 101108.
</p>
<p>Peng J, Li B, Jacobs Z, Gliganic LA, 2023. Optical dating of sediments affected by post-depositional mixing: Modelling, synthesizing and implications. Catena, 232: 107383.
</p>


<h3>See Also</h3>

<p><a href="#topic+mcMAM">mcMAM</a>; <a href="#topic+mcFMM">mcFMM</a>; <a href="#topic+dbED">dbED</a>; <a href="#topic+psRadialPlot">psRadialPlot</a>; <a href="#topic+EDdata">EDdata</a>; <a href="#topic+optimSAM">optimSAM</a>; <a href="#topic+sensSAM">sensSAM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(EDdata)
  # Find out the appropriate number of components 
  # in FMM and fit automatically.
  RadialPlotter(EDdata$al3,zscale=seq(24,93,7))

  # Fit MAM3 (not run). 
  # RadialPlotter(EDdata$gl11,ncomp=-1,zscale=seq(20,37,3))
</code></pre>

<hr>
<h2 id='reportMC'>
Reporting MCMC outputs for statistical age models
</h2><span id='topic+reportMC'></span><span id='topic+reportMC.default'></span>

<h3>Description</h3>

<p>Summarizing distributions of parameters simulated from statistical age models using a Markov Chain Monte Carlo method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reportMC(obj, burn = 10000, thin = 5, 
         plot = TRUE, outfile = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reportMC_+3A_obj">obj</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(<b>required</b>): an object of S3 class <code>"mcAgeModels"</code>, which is produced by function <a href="#topic+mcFMM">mcFMM</a> or <a href="#topic+mcMAM">mcMAM</a> </p>
</td></tr>
<tr><td><code id="reportMC_+3A_burn">burn</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): number of iterations (i.e., the initial, non-stationary<br />
portion of the chain) to be discarded</p>
</td></tr>
<tr><td><code id="reportMC_+3A_thin">thin</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): take every <code>thin-th</code> iteration</p>
</td></tr>
<tr><td><code id="reportMC_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): plot the MCMC output or not</p>
</td></tr>
<tr><td><code id="reportMC_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, simulated parameters will be written to a CSV file named <code>"outfile"</code> and saved to the current work directory</p>
</td></tr>
<tr><td><code id="reportMC_+3A_...">...</code></td>
<td>
<p>do not use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+reportMC">reportMC</a> summarizes the output of a Markov Chain (the mean values, the standard deviations, the mode values, and the 2.5, 25, 50, 75, 97.5 quantiles of the simulated parameters). The initial <em>i</em> (<code>burn=i</code>) samples may have been affected by the inital state and has to be discarded (&quot;burn-in&quot;). Autocorrelation of simulated samples can be reduced by taking every <em>j-th</em> (<code>thin=j</code>) iteration (&quot;thining&quot;).
</p>


<h3>Value</h3>

<p>Return a <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>pars</code></td>
<td>
<p>means, standard deviations, and modes of simulated parameters</p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p>quantiles of simulated parameters</p>
</td></tr>
<tr><td><code>maxlik</code></td>
<td>
<p>maximum logged likelihood values calculated using the means and modes of simulated parameters</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian Information Criterion (BIC) values calculated using the means and modes of simulated parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Lunn D, Jackson C, Best N, Thomas A, Spiegelhalter D, 2013. The BUGS book: a practical introduction to bayesian analysis. Chapman &amp; Hall/CRC Press.
</p>
<p>Gelman A, Carlin JB, Stern HS, Dunson DB, Vehtari A, Rubin DB, 2013. Bayesian data analysis. Chapman &amp; Hall/CRC Press.
</p>
<p>Peng J, Dong ZB, Han FQ, 2016. Application of slice sampling method for optimizing OSL age models used for equivalent dose determination. Progress in Geography, 35(1): 78-88. (In Chinese).
</p>


<h3>See Also</h3>

<p><a href="#topic+mcFMM">mcFMM</a>; <a href="#topic+mcMAM">mcMAM</a>
</p>

<hr>
<h2 id='SARdata'>
Data sets used for SAR equivalent dose calculation
</h2><span id='topic+SARdata'></span>

<h3>Description</h3>

<p>SAR data sets for individual aliquots from the &quot;later&quot; group of sample HF11 from Haua Fteah cave, Libya (Li et al., 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SARdata)</code></pre>


<h3>Format</h3>

<p>A <a href="base.html#topic+data.frame">data.frame</a> with 840 observations containing the following 5 variables:
</p>

<dl>
<dt>NO</dt><dd><p>aliquot (grain) number</p>
</dd>
<dt>SAR.Cycle</dt><dd><p>SAR cycles</p>
</dd>
<dt>Dose</dt><dd><p>regenerative doses</p>
</dd>
<dt>Signal</dt><dd><p>OSL signals</p>
</dd>
<dt>Signal.Err</dt><dd><p>standard error of OSL signals</p>
</dd>
</dl>



<h3>References</h3>

<p>Li B, Jacobs Z, Roberts RG, 2016. Investigation of the applicability of standardised growth curves for OSL dating of quartz from Haua Fteah cave, Libya. Quaternary Geochronology, 35: 1-15.
</p>


<h3>See Also</h3>

<p><a href="#topic+fitGrowth">fitGrowth</a>; <a href="#topic+lsNORM">lsNORM</a>; <a href="#topic+calSGCED">calSGCED</a>; <a href="#topic+as_analyseBIN">as_analyseBIN</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Not run.
 # data(SARdata)
 # head(SARdata)
</code></pre>

<hr>
<h2 id='scaleSGCN'>
Natural-dose signal re-scaling
</h2><span id='topic+scaleSGCN'></span><span id='topic+scaleSGCN.default'></span>

<h3>Description</h3>

<p>Re-scaling sensitivity-corrected natural-dose signals according to the &quot;global standardised growth curve&quot; (gSGC) method 
suggested by Li et al. (2015, 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaleSGCN(obj_analyseBIN, SGCpars, model, origin, 
          SAR.Cycle, Tn.above.3BG = TRUE, 
          TnBG.ratio.low = NULL, rseTn.up = NULL, 
          FR.low = NULL, use.se = TRUE, outfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaleSGCN_+3A_obj_analysebin">obj_analyseBIN</code></td>
<td>
<p><a href="base.html#topic+list">list</a>(<b>required</b>): an object of S3 class &quot;analyseBIN&quot; produced by<br /> 
function <a href="#topic+analyseBINdata">analyseBINdata</a> or <a href="#topic+as_analyseBIN">as_analyseBIN</a></p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_sgcpars">SGCpars</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): optimized parameters of the SGC obtained using function <a href="#topic+fitGrowth">fitGrowth</a> or <a href="#topic+lsNORM">lsNORM</a></p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(<b>required</b>): fitting model used for obtaining <code>SGCpars</code></p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_origin">origin</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(<b>required</b>): logical value indicating if established SGC passes the origin</p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_sar.cycle">SAR.Cycle</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(<b>required</b>): a two-element character vector containing SAR cycles used for 
natural-dose signal re-scaling. Example: <code>SAR.Cycle=c("N","R3")</code></p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_tn.above.3bg">Tn.above.3BG</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if aliquot (grain) with Tn below 3 sigma BG should be rejected</p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_tnbg.ratio.low">TnBG.ratio.low</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): lower limit on ratio of initial Tn signal to BG</p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_rsetn.up">rseTn.up</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): upper limit on relative standard error of Tn in percent</p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_fr.low">FR.low</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): lower limit on fast ratio of Tn</p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_use.se">use.se</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if standard errors of values should be used during application of rejection criteria</p>
</td></tr>
<tr><td><code id="scaleSGCN_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, scaled SGC data related quantities will be written to a CSV file named <code>"outfile"</code> and saved to the current work directory</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sensitivity-corrected natural-dose signals are re-scaled according to <b>Eqn.(10)</b> of Li et al. (2015).
</p>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>scale.Ltx</code></td>
<td>
<p>scaled natural-dose signals and associated standard errors</p>
</td></tr>
<tr><td><code>agID</code></td>
<td>
<p>aliquot (grain) ID of scaled natural-dose signals</p>
</td></tr>
</table>


<h3>References</h3>

<p>Li B, Roberts RG, Jacobs Z, Li SH, 2015. Potential of establishing a &quot;global standardised growth curve&quot; (gSGC) for optical dating of quartz from sediments. Quaternary Geochronology, 27: 94-104.
</p>
<p>Li B, Jacobs Z, Roberts RG, 2016. Investigation of the applicability of standardised growth curves for OSL dating of quartz from Haua Fteah cave, Libya. Quaternary Geochronology, 35: 1-15.
</p>


<h3>See Also</h3>

<p><a href="#topic+lsNORM">lsNORM</a>; <a href="#topic+calSGCED">calSGCED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Not run.
 data(SARdata)
 gSGCpars &lt;- c(137.440874251, 0.007997863, 2.462035263, -0.321536177)
 scaleSGCN(as_analyseBIN(SARdata), SGCpars=gSGCpars, model="gok", 
           origin=FALSE, SAR.Cycle=c("N","R3"))
</code></pre>

<hr>
<h2 id='sensSAM'>
Investigate of the sensitivity of a statistical age model to the additional uncertainty (sigmab)
</h2><span id='topic+sensSAM'></span><span id='topic+sensSAM.default'></span>

<h3>Description</h3>

<p>Estimate of the parameters of a statistical age model using a number of sigmab values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensSAM(EDdata, model, sigmaVEC = NULL, iflog = TRUE, 
        maxcomp = 8, plot = TRUE, outfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensSAM_+3A_eddata">EDdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a two-column matrix (i.e., equivalent dose values and<br />
associated standard errors)</p>
</td></tr>
<tr><td><code id="sensSAM_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): the fitting model, one of <code>"com"</code>, <code>"cam"</code>, <code>"mam3"</code>, <code>"mam4"</code>,
<code>"mxam3"</code>, <code>"mxam4"</code>, <code>"fmm0"</code>, <code>"fmm1"</code>, <code>"fmm2"</code>, ..., <code>"fmm9"</code></p>
</td></tr>
<tr><td><code id="sensSAM_+3A_sigmavec">sigmaVEC</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(with default): a series of sigmab values that will be used as inputs for the model. For example, <code>sigmaVEC=seq(from=0,to=0.3,by=0.01)</code></p>
</td></tr>
<tr><td><code id="sensSAM_+3A_iflog">iflog</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): transform equivalent dose values to log-scale or not</p>
</td></tr>
<tr><td><code id="sensSAM_+3A_maxcomp">maxcomp</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): the maximum number of components in the FMM</p>
</td></tr>
<tr><td><code id="sensSAM_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): logical value indicating if the results should be plotted</p>
</td></tr>
<tr><td><code id="sensSAM_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, the results will be written to a CSV file named <code>"outfile"</code> and saved to the current work directory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an invisible <a href="base.html#topic+list">list</a> that contains the following elements:
</p>
<table>
<tr><td><code>pars</code></td>
<td>
<p>a list that contains the optimized parameters for each sigmab value</p>
</td></tr>
<tr><td><code>mat</code></td>
<td>
<p>a matrix that contains the optimized parameters, the maximum logged likelihood value, and the corresponding Bayesian Information Criterion (BIC) value</p>
</td></tr>
</table>


<h3>References</h3>

<p>Peng J, Li B, Jacobs Z, 2020. Modelling heterogeneously bleached single-grain equivalent dose distributions: Implications for the reliability of burial dose determination. Quaternary Geochronology, 60: 101108.
</p>
<p>Peng J, Li B, Jacobs Z, Gliganic LA, 2023. Optical dating of sediments affected by post-depositional mixing: Modelling, synthesizing and implications. Catena, 232: 107383.
</p>


<h3>See Also</h3>

<p><a href="#topic+RadialPlotter">RadialPlotter</a>; <a href="#topic+EDdata">EDdata</a>; <a href="#topic+optimSAM">optimSAM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # Not run.
  # data(EDdata)
  # sensSAM(EDdata$al3, model="mam4", iflog=TRUE)

</code></pre>

<hr>
<h2 id='Signaldata'>
Decay curves datasets
</h2><span id='topic+Signaldata'></span>

<h3>Description</h3>

<p>CW-OSL and LM-OSL decay curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Signaldata)</code></pre>


<h3>Format</h3>

<p>A list that contains CW-OSL and LM-OSL decay curves:
</p>

<dl>
<dt>cw</dt><dd><p>a number of CW-OSL decay curves of a sand sample from the Tengger Desert in northern china (Peng and Han, 2013)</p>
</dd>
<dt>lm</dt><dd><p>a LM-OSL decay curve from Li and Li (2006)</p>
</dd>
</dl>



<h3>References</h3>

<p>Li SH, Li B, 2006. Dose measurement using the fast component of LM-OSL signals from quartz. Radiation Measurements, 41(5): 534-541.
</p>
<p>Peng J, Han FQ, 2013. Selections of fast-component OSL signal using sediments from the south edge of Tengger Desert. Acta Geoscientica Sinica, 34(6): 757-762.
</p>


<h3>See Also</h3>

<p><a href="#topic+decomp">decomp</a>; <a href="#topic+fastED">fastED</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Not run.
# data(Signaldata)
# names(Signaldata)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
