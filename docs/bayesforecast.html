<!DOCTYPE html><html lang="en"><head><title>Help for package bayesforecast</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bayesforecast}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bayesforecast-package'><p>Bayesian Time Series Modeling with <span class="pkg">Stan</span>.</p></a></li>
<li><a href='#aic'><p>Computes posterior sample of the pointwise AIC method from a varstan object</p></a></li>
<li><a href='#AICc'><p>Computes posterior sample of the pointwise corrected AIC method from a varstan object</p></a></li>
<li><a href='#air'><p>Air Transport Passengers Australia</p></a></li>
<li><a href='#as.stan'><p>Convert to a stanfit object.</p></a></li>
<li><a href='#aust'><p>International Tourists to Australia: Total visitor nights.</p></a></li>
<li><a href='#auto.sarima'><p>Automatic estimate of a Seasonal ARIMA model</p></a></li>
<li><a href='#autoplot.ts'><p>Automatically create a ggplot for time series objects.</p></a></li>
<li><a href='#autoplot.varstan'><p>autoplot methods for varstan models.</p></a></li>
<li><a href='#bayes_factor.varstan'><p>Bayes Factors from Marginal Likelihoods.</p></a></li>
<li><a href='#beta'><p>Define a beta prior distribution</p></a></li>
<li><a href='#bic'><p>Computes posterior sample of the pointwise BIC method from a varstan object</p></a></li>
<li><a href='#birth'><p>U.S. Monthly Live Births.</p></a></li>
<li><a href='#bridge_sampler.varstan'><p>Log Marginal Likelihood via Bridge Sampling.</p></a></li>
<li><a href='#cauchy'><p>Define a Cauchy prior distribution</p></a></li>
<li><a href='#check_residuals'><p>Visual check of residuals in a <code>varstan</code> object.</p></a></li>
<li><a href='#chisq'><p>Define a chi square prior distribution</p></a></li>
<li><a href='#demgbp'><p>DEM/GBP exchange rate log-returns</p></a></li>
<li><a href='#exponential'><p>Define an exponential prior distribution</p></a></li>
<li><a href='#extract_stan'><p>Extract chains of an stanfit object implemented in rstan package</p></a></li>
<li><a href='#fitted.varstan'><p>Expected Values of the Posterior Predictive Distribution</p></a></li>
<li><a href='#forecast.varstan'><p>Forecasting varstan objects</p></a></li>
<li><a href='#fourier'><p>Fourier terms for modeling seasonality.</p></a></li>
<li><a href='#gamma'><p>Define a gamma prior distribution</p></a></li>
<li><a href='#garch'><p>A  constructor for a GARCH(s,k,h) model.</p></a></li>
<li><a href='#get_parameters'><p>Get parameters of a varstan object</p></a></li>
<li><a href='#get_prior'><p>Get the prior distribution of a model parameter</p></a></li>
<li><a href='#ggacf'><p><code>acf</code> plot</p></a></li>
<li><a href='#gghist'><p>Histogram with optional normal density functions</p></a></li>
<li><a href='#ggnorm'><p><code>qqplot</code> with normal <code>qqline</code></p></a></li>
<li><a href='#ggpacf'><p><code>pacf</code> plot.</p></a></li>
<li><a href='#Holt'><p>A constructor for a Holt trend state-space model.</p></a></li>
<li><a href='#Hw'><p>A  constructor for a Holt-Winters state-space model.</p></a></li>
<li><a href='#inverse.chisq'><p>Define an inverse gamma prior distribution</p></a></li>
<li><a href='#inverse.gamma'><p>Define an inverse gamma prior distribution</p></a></li>
<li><a href='#ipc'><p>Monthly inflation coefficients from 1980-2018.</p></a></li>
<li><a href='#jeffrey'><p>Define a non informative Jeffrey's prior for the degree freedom hyper parameter</p></a></li>
<li><a href='#laplace'><p>Define a Laplace prior distribution</p></a></li>
<li><a href='#LKJ'><p>Define a LKJ matrix prior distribution</p></a></li>
<li><a href='#LocalLevel'><p>A  constructor for local level state-space model.</p></a></li>
<li><a href='#log_lik.varstan'><p>Extract posterior sample of the pointwise log-likelihood from a varstan object.</p></a></li>
<li><a href='#loglik'><p>Extract posterior sample of the accumulated log-likelihood from a varstan object</p></a></li>
<li><a href='#loo.varstan'><p>Leave-one-out cross-validation</p></a></li>
<li><a href='#mcmc_plot.varstan'><p>MCMC Plots Implemented in <span class="pkg">bayesplot</span></p></a></li>
<li><a href='#model'><p>Print the defined model of a varstan object.</p></a></li>
<li><a href='#naive'><p>Naive and Random Walk models.</p></a></li>
<li><a href='#normal'><p>Define a normal prior distribution</p></a></li>
<li><a href='#oildata'><p>Annual oil production in Saudi Arabia</p></a></li>
<li><a href='#plot.varstan'><p>plot methods for varstan models.</p></a></li>
<li><a href='#posterior_epred.varstan'><p>Expected Values of the Posterior Predictive Distribution</p></a></li>
<li><a href='#posterior_interval'><p>Posterior uncertainty intervals</p></a></li>
<li><a href='#posterior_predict.varstan'><p>Draw from posterior predictive h steps ahead distribution</p></a></li>
<li><a href='#predictive_error.varstan'><p>Out-of-sample predictive errors</p></a></li>
<li><a href='#print.garch'><p>Print a garch model</p></a></li>
<li><a href='#print.Holt'><p>Print a Holt model</p></a></li>
<li><a href='#print.Hw'><p>Print a Holt-Winter model</p></a></li>
<li><a href='#print.LocalLevel'><p>Print a Local Level model</p></a></li>
<li><a href='#print.naive'><p>Print a naive model</p></a></li>
<li><a href='#print.Sarima'><p>Print a Sarima model</p></a></li>
<li><a href='#print.ssm'><p>Print a state-space model</p></a></li>
<li><a href='#print.SVM'><p>Print a Stochastic Volatility model</p></a></li>
<li><a href='#print.varstan'><p>Print a varstan object</p></a></li>
<li><a href='#prior_summary.varstan'><p>Generic function for extracting information about prior distributions</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#report'><p>Print a full report of the time series model in a  varstan object.</p></a></li>
<li><a href='#residuals.varstan'><p>Generic function and method for extract the residual of a varstan object</p></a></li>
<li><a href='#Sarima'><p>Constructor a Multiplicative Seasonal ARIMA model.</p></a></li>
<li><a href='#set_prior'><p>Set a prior distribution to a model parameter.</p></a></li>
<li><a href='#ssm'><p>A  constructor for a Additive linear State space model.</p></a></li>
<li><a href='#stan_garch'><p>Fitting for a GARCH(s,k,h) model.</p></a></li>
<li><a href='#stan_Holt'><p>Fitting an Holt state-space model.</p></a></li>
<li><a href='#stan_Hw'><p>Fitting a Holt-Winters state-space model.</p></a></li>
<li><a href='#stan_LocalLevel'><p>Fitting a Local level state-space model.</p></a></li>
<li><a href='#stan_naive'><p>Naive and Random Walk models.</p></a></li>
<li><a href='#stan_sarima'><p>Fitting a Multiplicative Seasonal ARIMA model.</p></a></li>
<li><a href='#stan_ssm'><p>Fitting an Additive linear State space model.</p></a></li>
<li><a href='#stan_SVM'><p>Fitting a Stochastic volatility model</p></a></li>
<li><a href='#student'><p>Define a t student prior distribution</p></a></li>
<li><a href='#summary.varstan'><p>Summary method for a varstan object</p></a></li>
<li><a href='#SVM'><p>Constructor of an Stochastic volatility model object</p></a></li>
<li><a href='#uniform'><p>Define a uniform prior distribution</p></a></li>
<li><a href='#varstan'><p>Constructor of a varstan object.</p></a></li>
<li><a href='#waic.varstan'><p>Widely Applicable Information Criterion (WAIC)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Bayesian Time Series Modeling with Stan</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit Bayesian time series models using 'Stan' for full Bayesian inference. A wide range 
  of distributions and models are supported, allowing users to fit Seasonal ARIMA, ARIMAX, Dynamic 
  Harmonic Regression, GARCH, t-student innovation GARCH models, asymmetric GARCH, Random Walks, stochastic 
  volatility models for univariate time series.  Prior specifications are flexible and explicitly encourage 
  users to apply prior distributions that actually reflect their beliefs. Model fit can easily be assessed 
  and compared with typical visualization methods, information criteria such as loglik, AIC, BIC WAIC, Bayes 
  factor and leave-one-out cross-validation methods. References: Hyndman (2017)
    &lt;<a href="https://doi.org/10.18637%2Fjss.v027.i03">doi:10.18637/jss.v027.i03</a>&gt;; Carpenter et al. (2017) &lt;<a href="https://doi.org/10.18637%2Fjss.v076.i01">doi:10.18637/jss.v076.i01</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>bayesplot (&ge; 1.5.0), methods, gridExtra, ggplot2, forecast,
loo (&ge; 2.2.0), Rcpp (&ge; 0.12.0), rstan (&ge; 2.18.1), rstantools
(&ge; 2.0.0), RcppParallel (&ge; 5.0.1), bridgesampling (&ge; 0.3-0),
MASS, StanHeaders, astsa,lubridate, prophet,zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown,ggfortify</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppParallel (&ge; 5.0.1),
RcppEigen (&ge; 0.3.3.3.0), rstan (&ge; 2.18.1), StanHeaders (&ge;
2.18.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Collate:</td>
<td>'autoplot.R' 'auto_sarima.R' 'bayes_factor.R'
'bayesforecast-package.R' 'Birth.R' 'Fit.R' 'forecast.R'
'garch.R' 'get_params.R' 'log_lik.R' 'Misc.R' 'model.R'
'naive.R' 'posterior_intervals.R' 'posterior_predict.R' 'ets.R'
'predictive_error.R' 'print.R' 'prior.R' 'report.R' 'Sarima.R'
'summary.R' 'ssm.R' 'stanmodels.R' 'SVM.R' 'varstan.R'
'stan_models.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-17 08:40:14 UTC; asael</td>
</tr>
<tr>
<td>Author:</td>
<td>Asael Alonzo Matamoros [aut, cre],
  Cristian Cruz Torres [aut],
  Andres Dala [ctb],
  Rob Hyndman [ctb],
  Mitchell O'Hara-Wild [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Asael Alonzo Matamoros &lt;asael.alonzo@gmail.com&gt;</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-17 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bayesforecast-package'>Bayesian Time Series Modeling with <span class="pkg">Stan</span>.</h2><span id='topic+bayesforecast-package'></span><span id='topic+bayesforecast'></span>

<h3>Description</h3>

<p>Fit univariate time series models using 'Stan' for full Bayesian inference.
A wide range of distributions and models are supported,  allowing users to
fit Seasonal ARIMA, ARIMAX, Dynamic Harmonic Regression,  GARCH, t-student
innovation GARCH models, asymmetric GARCH, Random Walks, and stochastic
volatility models. Prior specifications are flexible and explicitly encourage
users to apply prior distributions that actually reflect their beliefs. Model
fit can  easily  be assessed and compared with typical visualization methods,
information criteria such as loglik, AIC, BIC WAIC, Bayes factor and
leave-one-out cross-validation methods.
</p>


<h3>References</h3>

<p>Carpenter, B. and Gelman, A. and Hoffman, D. and  Lee, D. and Goodrich, B. and
Betancourt, M. and Brubaker, and Guo, L. and Riddell. 2017. Stan: A probabilistic
programming language. <em>Journal of Statistical Software</em> 76(1).
<code>doi: 10.18637/jss.v076.i01</code>.
</p>
<p>Stan Development Team. (2018). Stan Modeling Language Users Guide and Reference Manual,
Version 2.18.0. <code>url: https://mc-stan.org</code>.
</p>
<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>.
</p>
<p>Tsay, R (2010). Analysis of Financial Time Series.
<em>Wiley-Interscience</em>. 978-0470414354, second edition.
</p>
<p>Shumway, R.H. and Stoffer, D.S. (2010).Time Series Analysis and Its
Applications: With R Examples. <em>Springer Texts in Statistics</em>.
isbn: 9781441978646. First edition.
</p>

<hr>
<h2 id='aic'>Computes posterior sample of the pointwise AIC method from a varstan object</h2><span id='topic+aic'></span>

<h3>Description</h3>

<p>Convenience function for computing the pointwise Akaike Information Criteria
method from a varstan object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aic(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aic_+3A_x">x</code></td>
<td>
<p>A varstan object of the time series fitted model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric array  of size R, containing the posterior samples of the AICc
for a varstan object, where R is the number of iterations. If multiple chains are
fitted, then the array is of length M*R, where M is the number of chains
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 model = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
 fit1 = varstan(model,iter = 500,chains = 1)

 aic1 = aic(fit1)
 mean(aic1)


</code></pre>

<hr>
<h2 id='AICc'>Computes posterior sample of the pointwise corrected AIC method from a varstan object</h2><span id='topic+AICc'></span>

<h3>Description</h3>

<p>Convenience function for computing the pointwise corrected  Akaike Information Criteria
method from a varstan object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AICc(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AICc_+3A_x">x</code></td>
<td>
<p>A varstan object of the time series fitted model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric array  of size R, containing the posterior samples of the AICc
for a varstan object, where R is the number of iterations. If multiple chains are
fitted, then the array is of length M*R, where m is the number of chains
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

 library(astsa)
 model = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
 fit1 = varstan(model,iter = 500,chains = 1)

 aic1 = AICc(fit1)
 mean(aic1)


</code></pre>

<hr>
<h2 id='air'>Air Transport Passengers Australia</h2><span id='topic+air'></span>

<h3>Description</h3>

<p>Total annual air passengers (in millions) including domestic and international
aircraft passengers of air carriers registered in Australia. 1970-2016.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>air
</code></pre>


<h3>Format</h3>

<p>the format is: Annual Time-Series (1:27) from 1990 to 2016:
</p>


<h3>Source</h3>

<p><span class="pkg">fpp2</span>
</p>


<h3>References</h3>

<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>
</p>

<hr>
<h2 id='as.stan'>Convert to a stanfit object.</h2><span id='topic+as.stan'></span>

<h3>Description</h3>

<p>Convert a <code>varstan</code> object to a <code>stanfit</code> object of the
<span class="pkg">rstan</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.stan(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.stan_+3A_object">object</code></td>
<td>
<p>a varstan object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a stanfit object.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Fitting a GARCH(1,1) model
 dat = garch(ipc,order = c(1,1,0))
 fit1 = varstan(dat,iter = 500,chains = 1)

 # Converting to a Stanfit object
 stanfit1 = as.stan(fit1)

</code></pre>

<hr>
<h2 id='aust'>International Tourists to Australia: Total visitor nights.</h2><span id='topic+aust'></span>

<h3>Description</h3>

<p>Quarterly visitor nights (in millions) spent by international tourists
to Australia. 1999-2015
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aust
</code></pre>


<h3>Format</h3>

<p>the format is: Quarterly Time-Series (1:44) from 1999 to 2015:
</p>


<h3>Source</h3>

<p><span class="pkg">fpp2</span>
</p>


<h3>References</h3>

<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>
</p>

<hr>
<h2 id='auto.sarima'>Automatic estimate of a Seasonal ARIMA model</h2><span id='topic+auto.sarima'></span>

<h3>Description</h3>

<p>Returns the best seasonal ARIMA model using a <code>bic</code> value, this
function the<code>auto.arima</code> function of the <span class="pkg">forecast</span> package
to select the seasonal ARIMA model and estimates the model using a
HMC sampler.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto.sarima(ts,seasonal = TRUE,xreg = NULL,chains=4,iter=4000,warmup=floor(iter/2),
                adapt.delta = 0.9,tree.depth =10,stepwise = TRUE, series.name = NULL,
                prior_mu0 = NULL,prior_sigma0 = NULL,prior_ar = NULL, prior_ma = NULL,
                prior_sar = NULL,prior_sma = NULL, prior_breg = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auto.sarima_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_seasonal">seasonal</code></td>
<td>
<p>optionally, a logical value for seasonal ARIMA models.
By default <code>seasonal = TRUE</code>.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for step-size
adaptation, so warm-up samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_stepwise">stepwise</code></td>
<td>
<p>If TRUE, will do stepwise selection (faster). Otherwise, it searches
over all models. Non-stepwise selection can be very slow, especially for seasonal models.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_prior_mu0">prior_mu0</code></td>
<td>
<p>The prior distribution for the location parameter in an ARIMA model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_prior_sigma0">prior_sigma0</code></td>
<td>
<p>The prior distribution for the scale parameter in an ARIMA model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_prior_ar">prior_ar</code></td>
<td>
<p>The prior distribution for the auto-regressive parameters in an ARIMA model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_prior_ma">prior_ma</code></td>
<td>
<p>The prior distribution for the moving average parameters in an ARIMA model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_prior_sar">prior_sar</code></td>
<td>
<p>The prior distribution for the seasonal auto-regressive parameters in a
SARIMA model. By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_prior_sma">prior_sma</code></td>
<td>
<p>The prior distribution for the seasonal moving average parameters in a
SARIMA model. By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_prior_breg">prior_breg</code></td>
<td>
<p>The prior distribution for the regression coefficient parameters in a
ARIMAX model. By default the value is set <code>NULL</code>, then the default student(7,0,1) priors
are used.</p>
</td></tr>
<tr><td><code id="auto.sarima_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>auto.arima</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Automatic ARIMA model fitting implemented by Rob Hyndman, this function finds the best
Seasonal ARIMA model using <code>bic</code>, and then proceeds to fit the model using
<code>varstan</code> function and the default priors of a <code>Sarima</code> model constructor.
</p>
<p>This function provides an initial model fit for beginning the Bayesian analysis
of the univariate time series. For better fit and model selection try different
models and other model selection criteria such as <code>loo</code> or <code>bayes_factor</code>.
</p>
<p>The default arguments are designed for rapid estimation of models for many time series.
If you are analyzing just one time series, and can afford to take some more time, it is
recommended that you set <code>stepwise</code>=<code>FALSE</code> and reduce the number of iterations
per chain (<code>iter</code>).
</p>
<p>For more information look at <code>auto.arima()</code> function of forecast package.
</p>


<h3>Value</h3>

<p>A varstan object with the &quot;best&quot; fitted ARIMA model to the data
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>References</h3>

<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>.
</p>
<p>Box, G. E. P. and Jenkins, G.M. (1978). Time series analysis: Forecasting and
control. San Francisco: Holden-Day. <em>Biometrika</em>, 60(2), 297-303.
<code>doi:10.1093/biomet/65.2.297</code>.
</p>
<p>Kennedy, P. (1992). Forecasting with dynamic regression models: Alan Pankratz, 1991.
<em>International Journal of Forecasting</em>. 8(4), 647-648.
<code>url: https://EconPapers.repec.org/RePEc:eee:intfor:v:8:y:1992:i:4:p:647-648</code>.
</p>


<h3>See Also</h3>

<p><code>Sarima</code> <code>varstan</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Automatic Sarima model for the birth data
 auto.sarima(birth,iter = 500,chains = 1)

 # Dynamic Harmonic regression
 auto.sarima(birth,xreg = fourier(birth,K= 6),iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='autoplot.ts'>Automatically create a ggplot for time series objects.</h2><span id='topic+autoplot.ts'></span><span id='topic+fortify.ts'></span>

<h3>Description</h3>

<p><code>autoplot</code> takes an object of type <code>ts</code> or <code>mts</code> and creates
a ggplot object suitable for usage with <code>stat_forecast</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ts'
autoplot(
  object,
  series = NULL,
  xlab = "Time",
  ylab = deparse(substitute(object)),
  main = NULL,
  facets = FALSE,
  colour = TRUE,
  ...
)

## S3 method for class 'ts'
fortify(model, data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot.ts_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>ts</code>&rdquo; or &ldquo;<code>mts</code>&rdquo;.</p>
</td></tr>
<tr><td><code id="autoplot.ts_+3A_series">series</code></td>
<td>
<p>Identifies the time series with a colour, which integrates well
with the functionality of geom_forecast.</p>
</td></tr>
<tr><td><code id="autoplot.ts_+3A_xlab">xlab</code></td>
<td>
<p>a string with the plot's x axis label. By default a NUll value.</p>
</td></tr>
<tr><td><code id="autoplot.ts_+3A_ylab">ylab</code></td>
<td>
<p>a string with the plot's y axis label. By default a counts&quot; value.</p>
</td></tr>
<tr><td><code id="autoplot.ts_+3A_main">main</code></td>
<td>
<p>a string with the plot's title.</p>
</td></tr>
<tr><td><code id="autoplot.ts_+3A_facets">facets</code></td>
<td>
<p>If TRUE, multiple time series will be faceted (and unless
specified, colour is set to FALSE). If FALSE, each series will be assigned a
colour.</p>
</td></tr>
<tr><td><code id="autoplot.ts_+3A_colour">colour</code></td>
<td>
<p>If TRUE, the time series will be assigned a colour aesthetic</p>
</td></tr>
<tr><td><code id="autoplot.ts_+3A_...">...</code></td>
<td>
<p>Other plotting parameters to affect the plot.</p>
</td></tr>
<tr><td><code id="autoplot.ts_+3A_model">model</code></td>
<td>
<p>Object of class &ldquo;<code>ts</code>&rdquo; to be converted to
&ldquo;<code>data.frame</code>&rdquo;.</p>
</td></tr>
<tr><td><code id="autoplot.ts_+3A_data">data</code></td>
<td>
<p>Not used (required for fortify method)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>fortify.ts</code> takes a <code>ts</code> object and converts it into a data frame
(for usage with ggplot2).
</p>


<h3>Value</h3>

<p>None. Function produces a ggplot2 graph.
</p>


<h3>Author(s)</h3>

<p>Mitchell O'Hara-Wild.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+plot.ts">plot.ts</a></code>, <code><a href="ggplot2.html#topic+fortify">fortify</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)
autoplot(USAccDeaths)

lungDeaths &lt;- cbind(mdeaths, fdeaths)
autoplot(lungDeaths)
autoplot(lungDeaths, facets=TRUE)

</code></pre>

<hr>
<h2 id='autoplot.varstan'>autoplot methods for varstan models.</h2><span id='topic+autoplot.varstan'></span>

<h3>Description</h3>

<p>Preliminary autoplot methods for varstan models only valid for univariate time series models.
The function prints the fitted values time series, the trace and density plots for the
sampled model parameters, or the residuals' posterior mean time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
autoplot(object, prob = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot.varstan_+3A_object">object</code></td>
<td>
<p>An object of class <code>varstan</code>.</p>
</td></tr>
<tr><td><code id="autoplot.varstan_+3A_prob">prob</code></td>
<td>
<p>A number <code class="reqn">p \in (0,1)</code> indicating the desired
probability mass to include in the intervals. The default is to report
<code>90%</code> intervals (<code>prob=0.9</code>) rather than the traditionally used
<code>95%</code>.</p>
</td></tr>
<tr><td><code id="autoplot.varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>mcmc_combo</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Function produces a ggplot2 graph.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 sf1 = auto.sarima(ts = birth,iter = 500,chains = 1)
 # fitted model
 autoplot(sf1)


</code></pre>

<hr>
<h2 id='bayes_factor.varstan'>Bayes Factors from Marginal Likelihoods.</h2><span id='topic+bayes_factor.varstan'></span><span id='topic+bayes_factor'></span>

<h3>Description</h3>

<p>Compute Bayes factors from marginal likelihoods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
bayes_factor(x1, x2, log = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayes_factor.varstan_+3A_x1">x1</code></td>
<td>
<p>A <code>varstan</code> object</p>
</td></tr>
<tr><td><code id="bayes_factor.varstan_+3A_x2">x2</code></td>
<td>
<p>Another <code>varstan</code> object based on the same data.</p>
</td></tr>
<tr><td><code id="bayes_factor.varstan_+3A_log">log</code></td>
<td>
<p>A boolean parameter for report the Bayes_factor in log scale.
The default value is FALSE.</p>
</td></tr>
<tr><td><code id="bayes_factor.varstan_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>bayes_factor</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The computation of marginal likelihoods based on bridge sampling requires
a lot more posterior samples than usual. A good conservative rule of thump
is perhaps 10-fold more samples (read: the default of 4000 samples may not
be enough in many cases). If not enough posterior samples are provided, the
bridge sampling algorithm tends to be unstable leading to considerably different
results each time it is run. We thus recommend running <code>bridge_sampler</code>
multiple times to check the stability of the results.
</p>
<p>For  more details check the <span class="pkg">bridgesampling</span> package.
</p>


<h3>Value</h3>

<p>The bayes factors of two models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 # Fitting a seasonal arima model
 mod1 = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
 fit1 = varstan(mod1,iter = 500,chains = 1)

 # Fitting a Dynamic harmonic regression
 mod2  = Sarima(birth,order = c(0,1,2),xreg = fourier(birth,K=6))
 fit2 = varstan(mod2,iter = 500,chains = 1)

 # compute the Bayes factor
 bayes_factor(fit1, fit2)


</code></pre>

<hr>
<h2 id='beta'>Define a beta prior distribution</h2><span id='topic+beta'></span>

<h3>Description</h3>

<p>beta(shape1,shape2)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta(shape1 = 2, shape2 = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="beta_+3A_shape1">shape1</code></td>
<td>
<p>the first form parameter</p>
</td></tr>
<tr><td><code id="beta_+3A_shape2">shape2</code></td>
<td>
<p>the second form parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a beta prior distribution using the hyper parameters
shape1 and shape2, by default a beta(2,2) distribution is
return.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='bic'>Computes posterior sample of the pointwise BIC method from a varstan object</h2><span id='topic+bic'></span>

<h3>Description</h3>

<p>Convenience function for computing the pointwise Bayesian Information Criteria
method from a varstan object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bic(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bic_+3A_x">x</code></td>
<td>
<p>A varstan object of the time series fitted model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric array  of size R, containing the posterior samples of the aic
for a varstan object, where R is the number of iterations. If multiple chains are
fitted, then the array is of length M*R, where M is the number of chains
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

 library(astsa)
 model = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
 fit1 = varstan(model,iter = 500,chains = 1)

 bic1 = bic(fit1)
 mean(bic1)


</code></pre>

<hr>
<h2 id='birth'>U.S. Monthly Live Births.</h2><span id='topic+birth'></span>

<h3>Description</h3>

<p>Monthly live births (adjusted) in thousands for the United States, 1948-1979.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>birth
</code></pre>


<h3>Format</h3>

<p>the format is: Time-Series (1:373) from 1948 to 1979:
</p>


<h3>Source</h3>

<p><span class="pkg">astsa</span>
</p>


<h3>References</h3>

<p>http://www.stat.pitt.edu/stoffer/tsa4/
http://www.stat.pitt.edu/stoffer/tsda/
</p>

<hr>
<h2 id='bridge_sampler.varstan'>Log Marginal Likelihood via Bridge Sampling.</h2><span id='topic+bridge_sampler.varstan'></span><span id='topic+bridge_sampler'></span>

<h3>Description</h3>

<p>Computes log marginal likelihood via bridge sampling,
which can be used in the computation of Bayes factors
and posterior model probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
bridge_sampler(samples, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bridge_sampler.varstan_+3A_samples">samples</code></td>
<td>
<p>A <code>varstan</code> object.</p>
</td></tr>
<tr><td><code id="bridge_sampler.varstan_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to
<code><a href="bridgesampling.html#topic+bridge_sampler">bridge_sampler.stanfit</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>varstan</code> class is just a thin wrapper that
contains the <code>stanfit</code> objects.
</p>
<p>Computing the marginal likelihood  via the bridgesampler package
for stanfit objects.
</p>
<p>The computation of marginal likelihoods based on bridge sampling requires
a lot more posterior samples than usual. A good conservative rule of thump
is perhaps 10-fold more samples (read: the default of 4000 samples may not
be enough in many cases). If not enough posterior samples are provided, the
bridge sampling algorithm tends to be unstable leading to considerably different
results each time it is run. We thus recommend running <code>bridge_sampler</code>
multiple times to check the stability of the results.
</p>
<p>For  more details check the <span class="pkg">bridgesampling</span> package.
</p>


<h3>Value</h3>

<p>the model's marginals likelihood from the <code>bridge_sampler</code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(astsa)
# Fitting a seasonal ARIMA model
mod1 = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
fit1 = varstan(mod1,iter = 500,chains = 1)

fit1
bridge_sampler(fit1)

# Fitting a Dynamic harmonic regression
mod2  = Sarima(birth,order = c(0,1,2),xreg = fourier(birth,K=6))
fit2 = varstan(mod2,iter = 500,chains = 1)

fit2
bridge_sampler(fit2)


</code></pre>

<hr>
<h2 id='cauchy'>Define a Cauchy prior distribution</h2><span id='topic+cauchy'></span>

<h3>Description</h3>

<p>cauchy(mu,sd)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cauchy(mu = 0, sd = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cauchy_+3A_mu">mu</code></td>
<td>
<p>the location parameter mu</p>
</td></tr>
<tr><td><code id="cauchy_+3A_sd">sd</code></td>
<td>
<p>the standard deviation parameter sigma</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a Cauchy prior distribution using the hyper parameters
mu and sigma, by default a standard Cauchy(0,1) distribution is
return.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='check_residuals'>Visual check of residuals in a <code>varstan</code> object.</h2><span id='topic+check_residuals'></span>

<h3>Description</h3>

<p>Performs a visual check of residuals in time series models, this method is inspired in
the <code>check.residuals</code> function provided by the <code>forecast</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_residuals_+3A_object">object</code></td>
<td>
<p>a varstan object.</p>
</td></tr>
<tr><td><code id="check_residuals_+3A_...">...</code></td>
<td>
<p>Other plotting parameters to affect the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Function produces a ggplot2 graph.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 sf1 = auto.sarima(ts = birth,iter = 500,chains = 1)
 # fitted model
 check_residuals(sf1)


</code></pre>

<hr>
<h2 id='chisq'>Define a chi square prior distribution</h2><span id='topic+chisq'></span>

<h3>Description</h3>

<p>chisq(df)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq(df = 7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chisq_+3A_df">df</code></td>
<td>
<p>the degree freedom parameter df</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a gamma prior distribution using the degree freedom df hyper parameter,
by default an chisq(7) distribution is return.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='demgbp'>DEM/GBP exchange rate log-returns</h2><span id='topic+demgbp'></span>

<h3>Description</h3>

<p>The vector dem2gbp contains daily observations of the Deutschmark vs British
Pound foreign exchange rate log-returns. This data set has been promoted as
an informal benchmark for GARCH time-series software validation. See
McCullough and Renfro (1999), and Brooks, Burke, and Persand (2001) for details.
The nominal returns are expressed in percent as in Bollerslev and Ghysels (1996).
The sample period is from January 3, 1984, to December 31, 1991, for a total
of 1974 observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demgbp
</code></pre>


<h3>Format</h3>

<p>the format is: Time-Series (1:350) from 1984 to 1985:
</p>


<h3>Source</h3>

<p><span class="pkg">bayesGARCH</span>
</p>


<h3>References</h3>

<p>Engle, R. (1982). Autoregressive Conditional Heteroscedasticity with Estimates of
the Variance of United Kingdom Inflation. <em>Econometrica</em>, 50(4), 987-1007.
<code>url: http://www.jstor.org/stable/1912773</code>.
</p>
<p>Bollerslev, T. (1986). Generalized autoregressive conditional heteroskedasticity.
<em>Journal of Econometrics</em>. 31(3), 307-327.
<code>doi: https://doi.org/10.1016/0304-4076(86)90063-1</code>.
</p>
<p>Ardia, D. and Hoogerheide, L. (2010). Bayesian Estimation of the GARCH(1,1) Model
with Student-t Innovations. <em>The R Journal</em>. 2(7), 41-47.
<code>doi: 10.32614/RJ-2010-014</code>.
</p>

<hr>
<h2 id='exponential'>Define an exponential prior distribution</h2><span id='topic+exponential'></span>

<h3>Description</h3>

<p>exponential(rate)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exponential(rate = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exponential_+3A_rate">rate</code></td>
<td>
<p>the rate parameter lambda in exponential distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a gamma prior distribution using the rate hyper parameter,
by default an exponential(1) distribution is return.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='extract_stan'>Extract chains of an stanfit object implemented in rstan package</h2><span id='topic+extract_stan'></span>

<h3>Description</h3>

<p>Extract chains of an stanfit object implemented in rstan package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_stan(object,pars,permuted = TRUE,inc_warmup = FALSE,include = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_stan_+3A_object">object</code></td>
<td>
<p>a varstan object</p>
</td></tr>
<tr><td><code id="extract_stan_+3A_pars">pars</code></td>
<td>
<p>n optional character vector providing the parameter names
(or other quantity names) of interest. If not specified, all parameters
and other quantities are used. The log-posterior with name lp__ is also
included by default.</p>
</td></tr>
<tr><td><code id="extract_stan_+3A_permuted">permuted</code></td>
<td>
<p>A logical scalar indicating whether the draws
after the warmup period in each chain should be permuted and merged.
If FALSE, the original order is kept. For each stanfit object,
the permutation is fixed (i.e., extracting samples a second time will
give the same sequence of iterations).</p>
</td></tr>
<tr><td><code id="extract_stan_+3A_inc_warmup">inc_warmup</code></td>
<td>
<p>A logical scalar indicating whether to include the
warmup draws. This argument is only relevant if permuted is FALSE.</p>
</td></tr>
<tr><td><code id="extract_stan_+3A_include">include</code></td>
<td>
<p>A logical scalar indicating whether the parameters named
in pars should be included (TRUE) or excluded (FALSE).</p>
</td></tr>
<tr><td><code id="extract_stan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>extract</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the posterior samples of the provided parameters.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 # Fitting a GARCH(1,1) model
 dat = garch(ipc,order = c(1,1,0))
 fit2 = varstan(dat,iter = 500,chains = 1)

 # Extracting the mean parameter
 mu0 = extract_stan(fit2,pars = "mu0")


</code></pre>

<hr>
<h2 id='fitted.varstan'>Expected Values of the Posterior Predictive Distribution</h2><span id='topic+fitted.varstan'></span>

<h3>Description</h3>

<p>The function returns the posterior estimate of the fitted values
of a <code>varstan</code> model, similar to the fit_values functions of other
packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
fitted(object, robust = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.varstan_+3A_object">object</code></td>
<td>
<p>A varstan object, <code><a href="#topic+varstan">varstan</a></code></p>
</td></tr>
<tr><td><code id="fitted.varstan_+3A_robust">robust</code></td>
<td>
<p>A boolean value, if its <code>TRUE</code> it returns the median of the posterior distribution,
and if its <code>FALSE</code> it returns the mean, by default is the <code>FALSE</code> value</p>
</td></tr>
<tr><td><code id="fitted.varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>posterior_predict</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a time series of the predicted <em>mean</em> response values.
</p>


<h3>Value</h3>

<p>A time series <code>(ts)</code> of predicted <em>mean</em> response values.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>See Also</h3>

<p><code><a href="#topic+posterior_predict.varstan">posterior_predict.varstan</a></code>
</p>

<hr>
<h2 id='forecast.varstan'>Forecasting varstan objects</h2><span id='topic+forecast.varstan'></span><span id='topic+forecast'></span>

<h3>Description</h3>

<p><code>forecast</code> is a generic function for forecasting from time series or
varstan models. The function invokes particular <em>methods</em> which
depend on the class of the first argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
forecast(
  object,
  h = 10,
  probs = c(0.8, 0.9),
  xreg = NULL,
  robust = FALSE,
  draws = 1000,
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forecast.varstan_+3A_object">object</code></td>
<td>
<p>a time series or varstan model for which forecasts are
required.</p>
</td></tr>
<tr><td><code id="forecast.varstan_+3A_h">h</code></td>
<td>
<p>Number of periods for forecasting.</p>
</td></tr>
<tr><td><code id="forecast.varstan_+3A_probs">probs</code></td>
<td>
<p>A numerical vector <code class="reqn">p \in (0,1)</code> indicating the desired
probability mass to include in the intervals. The default is to report
<code>90%</code> and <code>80%</code> intervals (<code>level=c(0.8,0.9)</code>).</p>
</td></tr>
<tr><td><code id="forecast.varstan_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="forecast.varstan_+3A_robust">robust</code></td>
<td>
<p>A boolean for obtain the robust estimation. The default</p>
</td></tr>
<tr><td><code id="forecast.varstan_+3A_draws">draws</code></td>
<td>
<p>An integer indicating the number of draws to return. The default
number of draws is 1000.</p>
</td></tr>
<tr><td><code id="forecast.varstan_+3A_seed">seed</code></td>
<td>
<p>An optional <code><a href="base.html#topic+set.seed">seed</a></code> to use.</p>
</td></tr>
<tr><td><code id="forecast.varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>posterior_predict</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>model=NULL</code>,the function <code>forecast.ts</code> makes forecasts
using <code>ets</code> models (if the data are non-seasonal or the seasonal
period is 12 or less) or <code>stlf</code> (if the seasonal period is 13 or
more).
</p>
<p>If <code>model</code> is not <code>NULL</code>, <code>forecast.ts</code> will apply the
<code>model</code> to the <code>object</code> time series, and then generate forecasts
accordingly.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>forecast</code>&quot;.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the
results, while the function <code>plot</code> produces a plot of the forecasts and
prediction intervals.
</p>
<p>The generic accessors functions <code>fitted.values</code> and <code>residuals</code>
extract various useful features of the value returned by
<code>forecast$model</code>.
</p>
<p>An object of class <code>"forecast"</code> is a list usually containing at least
the following elements: </p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>A list containing information about the
fitted model</p>
</td></tr> <tr><td><code>method</code></td>
<td>
<p>The name of the forecasting method as a
character string</p>
</td></tr> <tr><td><code>mean</code></td>
<td>
<p>Point forecasts as a time series</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>Lower limits for prediction intervals</p>
</td></tr> <tr><td><code>upper</code></td>
<td>
<p>Upper
limits for prediction intervals</p>
</td></tr> <tr><td><code>level</code></td>
<td>
<p>The confidence values
associated with the prediction intervals</p>
</td></tr> <tr><td><code>x</code></td>
<td>
<p>The original time series
(either <code>object</code> itself or the time series used to create the model
stored as <code>object</code>).</p>
</td></tr> <tr><td><code>residuals</code></td>
<td>
<p>Residuals from the fitted model.
For models with additive errors, the residuals will be x minus the fitted
values.</p>
</td></tr> <tr><td><code>fitted</code></td>
<td>
<p>Fitted values (one-step forecasts)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>See Also</h3>

<p>The <code>"forecast"</code> methods of the forecast package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 fit = auto.sarima(ts = birth,iter = 500,chains = 1)
 fc = forecast(fit,h = 12)


</code></pre>

<hr>
<h2 id='fourier'>Fourier terms for modeling seasonality.</h2><span id='topic+fourier'></span>

<h3>Description</h3>

<p><code>fourier</code> returns a matrix containing terms from a Fourier series, up
to order <code>K</code>, suitable for use in <code><a href="#topic+Sarima">Sarima</a></code> or
<code><a href="#topic+auto.sarima">auto.sarima</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fourier(x, K, h = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fourier_+3A_x">x</code></td>
<td>
<p>Seasonal time series: a <code>ts</code> or a <code>msts</code> object</p>
</td></tr>
<tr><td><code id="fourier_+3A_k">K</code></td>
<td>
<p>Maximum order(s) of Fourier terms</p>
</td></tr>
<tr><td><code id="fourier_+3A_h">h</code></td>
<td>
<p>Number of periods ahead to forecast (optional)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The period of the Fourier terms is determined from the time series
characteristics of <code>x</code>. When <code>h</code> is missing, the length of
<code>x</code> also determines the number of rows for the matrix returned by
<code>fourier</code>. Otherwise, the value of <code>h</code> determines the number of
rows for the matrix returned by <code>fourier</code>, typically used for
forecasting. The values within <code>x</code> are not used.
</p>
<p>Typical use would omit <code>h</code> when generating Fourier terms fitting a model
and include <code>h</code> when generating Fourier terms for forecasting.
</p>
<p>When <code>x</code> is a <code>ts</code> object, the value of <code>K</code> should be an
integer and specifies the number of sine and cosine terms to return. Thus,
the matrix returned has <code>2*K</code> columns.
</p>
<p>When <code>x</code> is a <code>msts</code> object, then <code>K</code> should be a vector of
integers specifying the number of sine and cosine terms for each of the
seasonal periods. Then the matrix returned will have <code>2*sum(K)</code>
columns.
</p>


<h3>Value</h3>

<p>Numerical matrix.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code>seasonaldummy</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 # Dynaimc Harmonic regression
 sf1 = auto.sarima(birth,xreg = fourier(birth,K= 6),iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='gamma'>Define a gamma prior distribution</h2><span id='topic+gamma'></span>

<h3>Description</h3>

<p>gamma(shape,rate)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamma(shape = 2, rate = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gamma_+3A_shape">shape</code></td>
<td>
<p>the form parameter alpha in gamma distribution</p>
</td></tr>
<tr><td><code id="gamma_+3A_rate">rate</code></td>
<td>
<p>the rate parameter beta in gamma distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a gamma prior distribution using the hyper parameters
shape and rate, by default an gamma(2,1) distribution is
return.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='garch'>A  constructor for a GARCH(s,k,h) model.</h2><span id='topic+garch'></span>

<h3>Description</h3>

<p>Constructor of the <code>GARCH(s,k,h)</code> object for Bayesian estimation in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>garch(ts,order = c(1,1,0),arma = c(0,0),xreg = NULL,
             genT = FALSE,asym = "none",series.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="garch_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="garch_+3A_order">order</code></td>
<td>
<p>A specification of the garch  model: the three components (s, k, h)
are the arch order, the garch order, and the mgarch order.</p>
</td></tr>
<tr><td><code id="garch_+3A_arma">arma</code></td>
<td>
<p>A specification of the  ARMA model,same as order parameter:  the two
components (p, q) are the AR order,and the  MA order.</p>
</td></tr>
<tr><td><code id="garch_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="garch_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student garch model.</p>
</td></tr>
<tr><td><code id="garch_+3A_asym">asym</code></td>
<td>
<p>a string value for the asymmetric function for an asymmetric GARCH process. By default
the value <code>"none"</code> for standard GARCH process. If <code>"logit"</code> a logistic function
is used for asymmetry, and if <code>"exp"</code> an exponential function is used.</p>
</td></tr>
<tr><td><code id="garch_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the time series names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>
<p>By default the <code>garch()</code> function generates a GARCH(1,1) model, when
<code>genT</code> option is <code>TRUE</code> a t-student innovations GARCH model
(see Ardia (2010)) is generated, and for Asymmetric GARCH models use the
option <code>asym</code> for specify the asymmetric function, see Fonseca,
et. al (2019) for more details.
</p>
<p>The default priors used in a GARCH(s,k,h) model are:
</p>

<ul>
<li><p>ar ~ normal(0,0.5)
</p>
</li>
<li><p>ma ~ normal(0,0.5)
</p>
</li>
<li><p>mu0 ~ t-student(0,2.5,6)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>arch ~ normal(0,0.5)
</p>
</li>
<li><p>garch ~ normal(0,0.5)
</p>
</li>
<li><p>mgarch ~ normal(0,0.5)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Engle, R. (1982). Autoregressive Conditional Heteroscedasticity with Estimates of
the Variance of United Kingdom Inflation. <em>Econometrica</em>, 50(4), 987-1007.
<code>url: http://www.jstor.org/stable/1912773</code>.
</p>
<p>Bollerslev, T. (1986). Generalized autoregressive conditional heteroskedasticity.
<em>Journal of Econometrics</em>. 31(3), 307-327.
<code>doi: https://doi.org/10.1016/0304-4076(86)90063-1</code>.
</p>
<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>
<p>Ardia, D. and Hoogerheide, L. (2010). Bayesian Estimation of the GARCH(1,1) Model
with Student-t Innovations. <em>The R Journal</em>. 2(7), 41-47.
<code>doi: 10.32614/RJ-2010-014</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Declaring a garch(1,1) model for the ipc data.
dat = garch(ipc,order = c(1,1,0))
dat

# Declaring a t-student M-GARCH(2,3,1)-ARMA(1,1) process for the ipc data.
dat = garch(ipc,order = c(2,3,1),arma = c(1,1),genT = TRUE)
dat

# Declaring a logistic Asymmetric GARCH(1,1) process.
dat = garch(ipc,order = c(1,1,0),asym = "logit")
dat

</code></pre>

<hr>
<h2 id='get_parameters'>Get parameters of a varstan object</h2><span id='topic+get_parameters'></span>

<h3>Description</h3>

<p>Get the sampled parameters of a varstan object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_parameters(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_parameters_+3A_object">object</code></td>
<td>
<p>a varstan object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with the sampled parameters
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 sf1 = auto.sarima(birth,iter = 500,chains = 1)
 get_parameters(sf1)


</code></pre>

<hr>
<h2 id='get_prior'>Get the prior distribution of a model parameter</h2><span id='topic+get_prior'></span>

<h3>Description</h3>

<p>The functions gets the defined distribution of a defined model parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_prior(model,par,lag = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_prior_+3A_model">model</code></td>
<td>
<p>a time series model class specified in varstan.</p>
</td></tr>
<tr><td><code id="get_prior_+3A_par">par</code></td>
<td>
<p>a string value with the  desired parameter which a prior is defined could be:
&quot;mu0&quot;, &quot;sigma0&quot;, &quot;ar&quot;, &quot;ma&quot;, &quot;arch&quot;, &quot;garch&quot;, &quot;mgarch&quot;, &quot;dfv&quot;, &quot;df&quot;, &quot;LKJ&quot; or &quot;breg&quot;.</p>
</td></tr>
<tr><td><code id="get_prior_+3A_lag">lag</code></td>
<td>
<p>an optional integer value, indicates the desired lag of the parameter which the prior
is defined if lag = 0, then the prior distribution will be applied for all lags</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Prints the prior distribution of a desired parameter.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(astsa)
# get all the ar parameters
dat = Sarima(birth,order = c(2,1,2))
get_prior(model = dat,par = "ar")

# change the mean constant parameter
dat = set_prior(model = dat,par = "mu0",dist = student(0,2.5,7))
get_prior(dat,par = "mu0")

# change and print only the second ma parameter
dat = set_prior(model = dat,par = "ma",dist = beta(2,2),lag = 2)
get_prior(dat,par = "ma")

</code></pre>

<hr>
<h2 id='ggacf'><code>acf</code> plot</h2><span id='topic+ggacf'></span>

<h3>Description</h3>

<p>Plot of the auto-correlation function for a univariate time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggacf(y, title = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggacf_+3A_y">y</code></td>
<td>
<p>a numeric vector or an object of the <code>ts</code> class containing a stationary time series.</p>
</td></tr>
<tr><td><code id="ggacf_+3A_title">title</code></td>
<td>
<p>a string with the plot's title.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Function produces a ggplot2 graph.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = rnorm(100)
ggacf(x)

</code></pre>

<hr>
<h2 id='gghist'>Histogram with optional normal density functions</h2><span id='topic+gghist'></span>

<h3>Description</h3>

<p>Plots a histogram and density estimates using ggplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gghist(y, title = NULL, xlab = NULL, ylab = "counts", bins, add.normal = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gghist_+3A_y">y</code></td>
<td>
<p>a numeric vector or an object of the <code>ts</code> class containing a stationary time series.</p>
</td></tr>
<tr><td><code id="gghist_+3A_title">title</code></td>
<td>
<p>a string with the plot's title.</p>
</td></tr>
<tr><td><code id="gghist_+3A_xlab">xlab</code></td>
<td>
<p>a string with the plot's x axis label. By default a NUll value</p>
</td></tr>
<tr><td><code id="gghist_+3A_ylab">ylab</code></td>
<td>
<p>a string with the plot's y axis label. By default a &quot;counts&quot; value</p>
</td></tr>
<tr><td><code id="gghist_+3A_bins">bins</code></td>
<td>
<p>The number of bins to use for the histogram. Selected by default
using the Friedman-Diaconis rule.</p>
</td></tr>
<tr><td><code id="gghist_+3A_add.normal">add.normal</code></td>
<td>
<p>A boolean value. Add a normal density function for comparison,
by default <code>add.normal = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Function produces a ggplot2 graph.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = rnorm(100)
gghist(x,add.normal = TRUE)

</code></pre>

<hr>
<h2 id='ggnorm'><code>qqplot</code> with normal <code>qqline</code></h2><span id='topic+ggnorm'></span>

<h3>Description</h3>

<p>Plot the quantile-quantile plot and quantile-quantile line using ggplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggnorm(y, title = NULL, add.normal = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggnorm_+3A_y">y</code></td>
<td>
<p>a numeric vector or an object of the <code>ts</code> class containing a stationary time series.</p>
</td></tr>
<tr><td><code id="ggnorm_+3A_title">title</code></td>
<td>
<p>a string with the plot's title.</p>
</td></tr>
<tr><td><code id="ggnorm_+3A_add.normal">add.normal</code></td>
<td>
<p>Add a normal density function for comparison.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Function produces a ggplot2 graph.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = rnorm(100)
ggnorm(x)

</code></pre>

<hr>
<h2 id='ggpacf'><code>pacf</code> plot.</h2><span id='topic+ggpacf'></span>

<h3>Description</h3>

<p>Plot of the partial autocorrelation function for a univariate time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggpacf(y, title = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggpacf_+3A_y">y</code></td>
<td>
<p>a numeric vector or an object of the <code>ts</code> class containing a stationary time series.</p>
</td></tr>
<tr><td><code id="ggpacf_+3A_title">title</code></td>
<td>
<p>a string with the plot's title.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Mitchell O'Hara-Wild and Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = rnorm(100)
ggpacf(x)

</code></pre>

<hr>
<h2 id='Holt'>A constructor for a Holt trend state-space model.</h2><span id='topic+Holt'></span>

<h3>Description</h3>

<p>Constructor of the <code>ets("A","A","Z")</code> object for Bayesian estimation in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Holt(ts,damped = FALSE,xreg = NULL,genT = FALSE,series.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Holt_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="Holt_+3A_damped">damped</code></td>
<td>
<p>a boolean value to specify a damped trend local level model. By default
is <code>FALSE</code>. If <code>trend</code> option is <code>FALSE</code> then <code>damped</code> is set to
<code>FALSE</code> automatically.</p>
</td></tr>
<tr><td><code id="Holt_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="Holt_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student SSM model.</p>
</td></tr>
<tr><td><code id="Holt_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the time series names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>
<p>When <code>genT</code> option is <code>TRUE</code> a t-student innovations ssm model (see Ardia (2010)) is generated
see Fonseca, et. al (2019) for more details.
</p>
<p>The default priors used in a ssm( ) model are:
</p>

<ul>
<li><p>level ~ normal(0,0.5)
</p>
</li>
<li><p>trend ~ normal(0,0.5)
</p>
</li>
<li><p>damped~ normal(0,0.5)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>level1 ~ normal(0,1)
</p>
</li>
<li><p>trend1 ~ normal(0,1)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code> <code><a href="#topic+garch">garch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mod1 = Holt(ipc)

# Declaring a Holt damped trend model for the ipc data.
mod2 = Holt(ipc,damped = TRUE)

</code></pre>

<hr>
<h2 id='Hw'>A  constructor for a Holt-Winters state-space model.</h2><span id='topic+Hw'></span>

<h3>Description</h3>

<p>Constructor of the <code>ets("A","A","A")</code> object for Bayesian estimation in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hw(ts,damped = FALSE,xreg = NULL,period = 0,genT = FALSE,series.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Hw_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="Hw_+3A_damped">damped</code></td>
<td>
<p>a boolean value to specify a damped trend local level model. By default
is <code>FALSE</code>. If <code>trend</code> option is <code>FALSE</code> then <code>damped</code> is set to
<code>FALSE</code> automatically.</p>
</td></tr>
<tr><td><code id="Hw_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="Hw_+3A_period">period</code></td>
<td>
<p>an integer specifying the periodicity of the time series by
default the value frequency(ts) is used.</p>
</td></tr>
<tr><td><code id="Hw_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student SSM model.</p>
</td></tr>
<tr><td><code id="Hw_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the time series names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>
<p>When <code>genT</code> option is <code>TRUE</code> a t-student innovations ssm model (see Ardia (2010)) is generated
see Fonseca, et. al (2019) for more details.
</p>
<p>The default priors used in a ssm( ) model are:
</p>

<ul>
<li><p>level ~ normal(0,0.5)
</p>
</li>
<li><p>Trend ~ normal(0,0.5)
</p>
</li>
<li><p>damped~ normal(0,0.5)
</p>
</li>
<li><p>Seasonal ~ normal(0,0.5)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>level1 ~ normal(0,1)
</p>
</li>
<li><p>trend1 ~ normal(0,1)
</p>
</li>
<li><p>seasonal1 ~ normal(0,1)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code>
<code><a href="#topic+garch">garch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mod1 = Hw(ipc)

# Declaring a Holt Winters damped trend model for the ipc data.
mod2 = Hw(ipc,damped = TRUE)

# Declaring an additive Holt-Winters model for the birth data
mod3 = Hw(birth,damped = FALSE)

</code></pre>

<hr>
<h2 id='inverse.chisq'>Define an inverse gamma prior distribution</h2><span id='topic+inverse.chisq'></span>

<h3>Description</h3>

<p>inverse.chisq(df)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inverse.chisq(df = 7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inverse.chisq_+3A_df">df</code></td>
<td>
<p>the degree freedom parameter df</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a inverse chi square prior distribution using the hyper parameter
df, by default an inverse.chisq(df = 2) distribution is return.
</p>
<p>If sigma has a chi square distribution then 1/sigma has n  inverse chi square
distribution.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='inverse.gamma'>Define an inverse gamma prior distribution</h2><span id='topic+inverse.gamma'></span>

<h3>Description</h3>

<p>inverse.gamma(shape,rate)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inverse.gamma(shape = 2, rate = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inverse.gamma_+3A_shape">shape</code></td>
<td>
<p>the form parameter alpha in gamma distribution</p>
</td></tr>
<tr><td><code id="inverse.gamma_+3A_rate">rate</code></td>
<td>
<p>the rate parameter beta in gamma distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a inverse.gamma prior distribution using the hyper parameters
shape and rate, by default an inverse.gamma(2,1) distribution is
return.
</p>
<p>If sigma has a gamma distribution then 1/sigma has n  inverse gamma
distribution. The rate parameter is the inverse of an scale parameter.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='ipc'>Monthly inflation coefficients from 1980-2018.</h2><span id='topic+ipc'></span>

<h3>Description</h3>

<p>Monthly return coefficients for the inflation. An economic indicator of
a country's economy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipc
</code></pre>


<h3>Format</h3>

<p>A time series of monthly data from 1980 to 2018.
</p>


<h3>Source</h3>

<p>https://www.bch.hn/series_estadisticas.php
</p>

<hr>
<h2 id='jeffrey'>Define a non informative Jeffrey's prior for the degree freedom hyper parameter</h2><span id='topic+jeffrey'></span>

<h3>Description</h3>

<p>jeffey.df()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jeffrey()
</code></pre>


<h3>Details</h3>

<p>Define a non informative Jeffrey's prior distribution, by default an jeffrey.df( )
distribution is return.
</p>
<p>This prior can only be used in garch models with t-student innovations, or Bekk
models with generalized t-student distribution.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='laplace'>Define a Laplace prior distribution</h2><span id='topic+laplace'></span>

<h3>Description</h3>

<p>laplace(mu,sd)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>laplace(mu = 0, sd = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="laplace_+3A_mu">mu</code></td>
<td>
<p>the location parameter mu</p>
</td></tr>
<tr><td><code id="laplace_+3A_sd">sd</code></td>
<td>
<p>the standard deviation parameter sigma</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a Laplace prior distribution using the hyper parameters
mu and sigma, by default a standard Laplace distribution is
return.
</p>
<p>The laplace distribution is exactly the same as the double exponential distribution
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='LKJ'>Define a LKJ matrix prior distribution</h2><span id='topic+LKJ'></span>

<h3>Description</h3>

<p>LKJ(df)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LKJ(df = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LKJ_+3A_df">df</code></td>
<td>
<p>the degree freedom parameter df</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a Lewandowski Kurowicka and Joe (LKJ) matrix correlation prior
distribution using the degree freedom df hyper parameter,by default
a LKJ(2) distribution is return.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>


<h3>References</h3>

<p>Lewandowski D, Kurowicka D, Joe H (2009). &quot;Generating random correlation matrices based
on vines and extended onion method.&quot; Journal of Multivariate Analysis, 100(9), 1989 2001.
ISSN 0047-259X. doi:https://doi.org/10.1016/j.jmva.2009.04.008.
URL: http://www.sciencedirect.com/science/article/pii/S0047259X09000876.
</p>

<hr>
<h2 id='LocalLevel'>A  constructor for local level state-space model.</h2><span id='topic+LocalLevel'></span>

<h3>Description</h3>

<p>Constructor of the <code>ets("A","N","N")</code> object for Bayesian estimation in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LocalLevel(ts,xreg = NULL,genT = FALSE,series.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LocalLevel_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="LocalLevel_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="LocalLevel_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student SSM model.</p>
</td></tr>
<tr><td><code id="LocalLevel_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the time series names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>
<p>By  default  the  <code>ssm()</code>  function generates a local level model (or a ets(&quot;A&quot;,&quot;N&quot;,&quot;N&quot;) or
exponential smoothing model from the <span class="pkg">forecast</span> package). If <code>trend</code> is set <code>TRUE</code>,
then  a  local  trend ssm model is defined (a equivalent ets(&quot;A&quot;,&quot;A&quot;,&quot;N&quot;) or Holt model from the
<span class="pkg">forecast</span> package). For damped trend models set <code>damped</code> to <code>TRUE</code>. If <code>seasonal</code>
is  set  to  <code>TRUE</code> a seasonal local level model is defined (a equivalent ets(&quot;A&quot;,&quot;N&quot;,&quot;A&quot;) model
from  the  <span class="pkg">forecast</span> package). For a Holt-Winters method (ets(&quot;A&quot;,&quot;A&quot;,&quot;A&quot;)) set <code>Trend</code> and
<code>seasonal</code> to <code>TRUE</code>.
</p>
<p>When <code>genT</code> option is <code>TRUE</code> a t-student innovations ssm model (see Ardia (2010)) is generated
see Fonseca, et. al (2019) for more details.
</p>
<p>The default priors used in a ssm( ) model are:
</p>

<ul>
<li><p>level ~ normal(0,0.5)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>level1 ~ normal(0,1)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code> <code><a href="#topic+garch">garch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mod1 = LocalLevel(ipc)

</code></pre>

<hr>
<h2 id='log_lik.varstan'>Extract posterior sample of the pointwise log-likelihood from a varstan object.</h2><span id='topic+log_lik.varstan'></span><span id='topic+log_lik'></span>

<h3>Description</h3>

<p>Convenience function for extracting the pointwise log-likelihood
matrix or array from a fitted Stan model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
log_lik(object, permuted = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="log_lik.varstan_+3A_object">object</code></td>
<td>
<p>A varstan object of the time series fitted model.</p>
</td></tr>
<tr><td><code id="log_lik.varstan_+3A_permuted">permuted</code></td>
<td>
<p>A logical scalar indicating whether the draws after
the <code>warmup</code> period in each chain should be permuted and merged.
If FALSE, the original order is kept. For each <code>stanfit</code> object,
the permutation is fixed (i.e., extracting samples a second time
will give the same sequence of iterations).</p>
</td></tr>
<tr><td><code id="log_lik.varstan_+3A_...">...</code></td>
<td>
<p>additional values need in log_lik methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Usually, an S x N matrix containing the pointwise log-likelihood
samples, where S is the number of samples and N is the number
of observations in the data. If <code>permuted</code> is <code>FALSE</code>,
an S x N x R array is returned, where R is the number of fitted
chains.
</p>


<h3>References</h3>

<p>Vehtari, A., Gelman, A., &amp; Gabry J. (2016). Practical Bayesian model
evaluation using leave-one-out cross-validation and WAIC. <em>In Statistics
and Computing</em>, <code>doi:10.1007/s11222-016-9696-4</code>.
</p>
<p>Gelman, A., Hwang, J., &amp; Vehtari, A. (2014). Understanding predictive
information criteria for Bayesian models. <em>Statistics and Computing</em>.
24, 997-1016.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation
and widely applicable information criterion in singular learning theory.
<em>The Journal of Machine Learning Research</em>. 11, 3571-3594.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

 library(astsa)
 model = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
 fit1 = varstan(model,iter = 500,chains = 1)

 log1 = log_lik(fit1)
 log1


</code></pre>

<hr>
<h2 id='loglik'>Extract posterior sample of the accumulated log-likelihood from a varstan object</h2><span id='topic+loglik'></span>

<h3>Description</h3>

<p>Convenience function for extracting the posterior sample of the accumulated
log-likelihood array from a fitted varstan object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik(object, permuted = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loglik_+3A_object">object</code></td>
<td>
<p>A varstan object of the time series fitted model.</p>
</td></tr>
<tr><td><code id="loglik_+3A_permuted">permuted</code></td>
<td>
<p>A logical scalar indicating whether the draws after
the warmup period in each chain should be permuted and merged.
If FALSE, the original order is kept. For each stanfit object,
the permutation is fixed (i.e., extracting samples a second time
will give the same sequence of iterations).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A real value with the accumulated log likelihood.
</p>


<h3>References</h3>

<p>Vehtari, A., Gelman, A., &amp; Gabry J. (2016). Practical Bayesian model
evaluation using leave-one-out cross-validation and WAIC. <em>In Statistics
and Computing</em>, <code>doi:10.1007/s11222-016-9696-4</code>.
</p>
<p>Gelman, A., Hwang, J., &amp; Vehtari, A. (2014). Understanding predictive
information criteria for Bayesian models. <em>Statistics and Computing</em>.
24, 997-1016.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation
and widely applicable information criterion in singular learning theory.
<em>The Journal of Machine Learning Research</em>. 11, 3571-3594.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 model = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
 fit1 = varstan(model,iter = 500,chains = 1)

 log1 = loglik(fit1)
 log1


</code></pre>

<hr>
<h2 id='loo.varstan'>Leave-one-out cross-validation</h2><span id='topic+loo.varstan'></span><span id='topic+loo'></span>

<h3>Description</h3>

<p>The <code>loo</code> method for varstan objects. Computes approximate
leave-one-out cross-validation using Pareto smoothed importance
sampling (PSIS-LOO CV).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
loo(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loo.varstan_+3A_x">x</code></td>
<td>
<p>A varstan object</p>
</td></tr>
<tr><td><code id="loo.varstan_+3A_...">...</code></td>
<td>
<p>additional values need in loo methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object from the loo class with the results of the Pareto-Smooth
Importance Sampling, leave one out cross validation for model selection.
</p>


<h3>References</h3>

<p>Vehtari, A., Gelman, A., &amp; Gabry J. (2016). Practical Bayesian model
evaluation using leave-one-out cross-validation and WAIC. <em>In Statistics
and Computing</em>, <code>doi:10.1007/s11222-016-9696-4</code>.
</p>
<p>Gelman, A., Hwang, J., &amp; Vehtari, A. (2014). Understanding predictive
information criteria for Bayesian models. <em>Statistics and Computing</em>.
24, 997-1016.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation
and widely applicable information criterion in singular learning theory.
<em>The Journal of Machine Learning Research</em>. 11, 3571-3594.
</p>


<h3>See Also</h3>


<ul>
<li><p> The <strong>loo</strong> package <a href="https://mc-stan.org/loo/articles/index.html">vignettes</a>
for demonstrations.
</p>
</li>
<li> <p><code>psis()</code> for the underlying Pareto Smoothed Importance Sampling (PSIS)
procedure used in the LOO-CV approximation.
</p>
</li>
<li> <p>pareto-k-diagnostic for convenience functions for looking at diagnostics.
</p>
</li>
<li> <p><code>loo_compare()</code> for model comparison.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
library(astsa)
model = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
fit1 = varstan(model,iter = 500,chains = 1)

loo1 = loo(fit1)
loo1


</code></pre>

<hr>
<h2 id='mcmc_plot.varstan'>MCMC Plots Implemented in <span class="pkg">bayesplot</span></h2><span id='topic+mcmc_plot.varstan'></span><span id='topic+mcmc_plot'></span>

<h3>Description</h3>

<p>Convenient way to call MCMC plotting functions
implemented in the <span class="pkg">bayesplot</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
mcmc_plot(
  object,
  pars = NULL,
  combo = c("dens", "trace"),
  fixed = FALSE,
  exact_match = FALSE,
  ...
)

mcmc_plot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcmc_plot.varstan_+3A_object">object</code></td>
<td>
<p>An <code>varstan</code> object.</p>
</td></tr>
<tr><td><code id="mcmc_plot.varstan_+3A_pars">pars</code></td>
<td>
<p>Names of parameters to be plotted,
as given by a character vector or regular expressions.
By default, all parameters except for group-level and
smooth effects are plotted. May be ignored for some plots.</p>
</td></tr>
<tr><td><code id="mcmc_plot.varstan_+3A_combo">combo</code></td>
<td>
<p>An array that contains the types of plot. By default
combo = c(&quot;dens&quot;,&quot;trace&quot;). Supported types are (as names) <code>hist</code>,
<code>dens</code>, <code>hist_by_chain</code>, <code>dens_overlay</code>,
<code>violin</code>, <code>intervals</code>, <code>areas</code>, <code>acf</code>,
<code>acf_bar</code>,<code>trace</code>, <code>trace_highlight</code>, <code>scatter</code>,
<code>rhat</code>, <code>rhat_hist</code>, <code>neff</code>, <code>neff_hist</code>
<code>nuts_acceptance</code>, <code>nuts_divergence</code>,
<code>nuts_stepsize</code>, <code>nuts_treedepth</code>, and <code>nuts_energy</code>.
For an overview on the various plot types see
<code><a href="bayesplot.html#topic+MCMC-overview">MCMC-overview</a></code>.</p>
</td></tr>
<tr><td><code id="mcmc_plot.varstan_+3A_fixed">fixed</code></td>
<td>
<p>Indicates whether parameter names
should be matched exactly (<code>TRUE</code>) or treated as
regular expressions (<code>FALSE</code>). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mcmc_plot.varstan_+3A_exact_match">exact_match</code></td>
<td>
<p>Deprecated alias of argument <code>fixed</code>.</p>
</td></tr>
<tr><td><code id="mcmc_plot.varstan_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the plotting functions.
See <code><a href="bayesplot.html#topic+MCMC-overview">MCMC-overview</a></code> for
more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
that can be further customized using the <span class="pkg">ggplot2</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
sf1 = stan_ssm(ipc,iter = 500,chains = 1)

# plot posterior intervals
mcmc_plot(sf1)

# only show population-level effects in the plots
mcmc_plot(sf1, pars = "level")

## End(Not run)

</code></pre>

<hr>
<h2 id='model'>Print the defined model of a varstan object.</h2><span id='topic+model'></span><span id='topic+model.varstan'></span><span id='topic+model.Sarima'></span><span id='topic+model.garch'></span><span id='topic+model.varma'></span><span id='topic+model.Bekk'></span><span id='topic+model.SVM'></span>

<h3>Description</h3>

<p>The function returns a string with the users defined model for the given time series data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model_+3A_object">object</code></td>
<td>
<p>a varstan object or one of the defined current defined models in varstan package.</p>
</td></tr>
<tr><td><code id="model_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if <code>object</code> is a varstan object the function will print the information of the
defined model inside of the object. If <code>object</code> is one of the model classes (like
<code>Sarima</code>, <code>garch</code>, <code>SVM</code> or <code>varma</code>), then it will print the model
information as well.
</p>
<p>For full information of the model with the used priors use the function report or just
print the object.
</p>


<h3>Value</h3>

<p>a  string with the defined time series model.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>See Also</h3>

<p><code>report</code> <code>print</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(astsa)
model1 = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
model(model1)

</code></pre>

<hr>
<h2 id='naive'>Naive and Random Walk models.</h2><span id='topic+naive'></span>

<h3>Description</h3>

<p>naive is the model constructor for a random walk  model applied to <code>y</code>.
This is equivalent to an ARIMA(0,1,0) model. <code>naive()</code> is simply a wrapper
to  maintain forecast package similitude. <code>seasonal</code> returns the model constructor
for a seasonal random walk equivalent to an ARIMA(0,0,0)(0,1,0)m model where m is the
seasonal period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive(ts,seasonal = FALSE,m = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="naive_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="naive_+3A_seasonal">seasonal</code></td>
<td>
<p>a Boolean value for select a seasonal random walk instead.</p>
</td></tr>
<tr><td><code id="naive_+3A_m">m</code></td>
<td>
<p>an optional integer value for the seasonal period.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The random walk with drift model is
</p>
<p style="text-align: center;"><code class="reqn">Y_t = mu_0 + Y_{t-1} + epsilon_t</code>
</p>

<p>where  <code class="reqn">epsilon_t</code> is a normal iid error.
</p>
<p>The seasonal naive model is
</p>
<p style="text-align: center;"><code class="reqn">Y_t = mu_0 + Y_{t-m} + epsilon_t</code>
</p>

<p>where  <code class="reqn">epsilon_t</code> is a normal iid error.
</p>


<h3>Value</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>References</h3>

<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>.
</p>
<p>Box, G. E. P. and Jenkins, G.M. (1978). Time series analysis: Forecasting and
control. San Francisco: Holden-Day. <em>Biometrika</em>, 60(2), 297-303.
<code>doi:10.1093/biomet/65.2.297</code>.
</p>
<p>Kennedy, P. (1992). Forecasting with dynamic regression models: Alan Pankratz, 1991.
<em>International Journal of Forecasting</em>. 8(4), 647-648.
<code>url: https://EconPapers.repec.org/RePEc:eee:intfor:v:8:y:1992:i:4:p:647-648</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(astsa)
# A seasonal Random-walk model.
model = naive(birth,seasonal = TRUE)
model

</code></pre>

<hr>
<h2 id='normal'>Define a normal prior distribution</h2><span id='topic+normal'></span>

<h3>Description</h3>

<p>normal(mu,sd)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normal(mu = 0, sd = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normal_+3A_mu">mu</code></td>
<td>
<p>the location parameter mu</p>
</td></tr>
<tr><td><code id="normal_+3A_sd">sd</code></td>
<td>
<p>the standard deviation parameter sigma</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a normal prior distribution using the hyper parameters
mu and sigma, by default a standard normal distribution is
return.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='oildata'>Annual oil production in Saudi Arabia</h2><span id='topic+oildata'></span>

<h3>Description</h3>

<p>Annual oil production (millions of tonnes), Saudi Arabia, 1965-2013.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oildata
</code></pre>


<h3>Format</h3>

<p>the format is: Annual Time-Series (1:18) from 1996 to 2013:
</p>


<h3>Source</h3>

<p><span class="pkg">fpp2</span>
</p>


<h3>References</h3>

<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>
</p>

<hr>
<h2 id='plot.varstan'>plot methods for varstan models.</h2><span id='topic+plot.varstan'></span>

<h3>Description</h3>

<p>Preliminary plot methods for varstan models only valid for univariate time series models.
The function prints the fitted values time series, the trace and density plots for the
sampled model parameters, or the residuals' posterior mean time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
plot(x, prob = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.varstan_+3A_x">x</code></td>
<td>
<p>An object of class <code>varstan</code>.</p>
</td></tr>
<tr><td><code id="plot.varstan_+3A_prob">prob</code></td>
<td>
<p>A number <code class="reqn">p \in (0,1)</code> indicating the desired
probability mass to include in the intervals. The default is to report
<code class="reqn">90\%</code> intervals (<code>prob=0.9</code>) rather than the traditionally used
<code class="reqn">95\%</code>.</p>
</td></tr>
<tr><td><code id="plot.varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>mcmc_combo</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Function produces a ggplot2 graph.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 sf1 = auto.sarima(ts = birth,iter = 500,chains = 1)
 # fitted model
 plot(sf1)


</code></pre>

<hr>
<h2 id='posterior_epred.varstan'>Expected Values of the Posterior Predictive Distribution</h2><span id='topic+posterior_epred.varstan'></span><span id='topic+posterior_epred'></span>

<h3>Description</h3>

<p>Compute posterior samples of the expected value/mean of the posterior
predictive distribution. Can be performed for the data used to fit the model
(posterior predictive checks) or for new data. By definition, these
predictions have smaller variance than the posterior predictions performed by
the <code><a href="#topic+posterior_predict.varstan">posterior_predict.varstan</a></code> method. This is because only the
uncertainty in the mean is incorporated in the samples computed by
<code>posterior_epred</code> while any residual error is ignored. However, the
estimated means of both methods averaged across samples should be very
similar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
posterior_epred(
  object,
  h = 0,
  xreg = NULL,
  robust = FALSE,
  draws = 1000,
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posterior_epred.varstan_+3A_object">object</code></td>
<td>
<p>a varstan object</p>
</td></tr>
<tr><td><code id="posterior_epred.varstan_+3A_h">h</code></td>
<td>
<p>An integer indicating the number of predictions. The default number
of predictions is 12.</p>
</td></tr>
<tr><td><code id="posterior_epred.varstan_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="posterior_epred.varstan_+3A_robust">robust</code></td>
<td>
<p>A boolean for obtain the robust estimation. The default</p>
</td></tr>
<tr><td><code id="posterior_epred.varstan_+3A_draws">draws</code></td>
<td>
<p>An integer indicating the number of draws to return. The default
number of draws is 1000</p>
</td></tr>
<tr><td><code id="posterior_epred.varstan_+3A_seed">seed</code></td>
<td>
<p>An optional <code><a href="base.html#topic+set.seed">seed</a></code> to use.</p>
</td></tr>
<tr><td><code id="posterior_epred.varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>posterior_predict</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>array</code> of predicted <em>mean</em> response values. For categorical and
ordinal models, the output is an S x N x C array. Otherwise, the output is an
<code>S x N</code> matrix, where S is the number of posterior samples, N is the number
of observations, and C is the number of categories. In multivariate models, an
additional  dimension is added to the output which indexes along the different
response variables.
</p>

<hr>
<h2 id='posterior_interval'>Posterior uncertainty intervals</h2><span id='topic+posterior_interval'></span>

<h3>Description</h3>

<p>The <code>posterior_interval</code> function computes Bayesian posterior uncertainty
intervals. These intervals are often referred to as <em>credible</em>
intervals, for more details see <span class="pkg">rstanarm</span>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_interval(mat, prob = 0.9, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posterior_interval_+3A_mat">mat</code></td>
<td>
<p>a matrix containing the posterior samples of a fitted parameter</p>
</td></tr>
<tr><td><code id="posterior_interval_+3A_prob">prob</code></td>
<td>
<p>A number <code class="reqn">p \in (0,1)</code> indicating the desired
probability mass to include in the intervals. The default is to report
<code>90%</code> intervals (<code>prob=0.9</code>) rather than the traditionally used
<code>95%</code>.</p>
</td></tr>
<tr><td><code id="posterior_interval_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>posterior_intervals</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with two columns and as many rows as model parameters (or
the subset of parameters specified by <code>pars</code> and/or
<code>regex_pars</code>). For a given value of <code>prob</code>, <code class="reqn">p</code>, the columns
correspond to the lower and upper <code>100*p%</code> interval limits and have the
names <code class="reqn">100\alpha/2</code> and <code class="reqn">100(1 - \alpha/2)</code><code>%</code>, where <code class="reqn">\alpha
  = 1-p</code>. For example, if <code>prob=0.9</code> is specified (a <code>90%</code>
interval), then the column names will be <code>"5%"</code> and <code>"95%"</code>,
respectively.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>

<hr>
<h2 id='posterior_predict.varstan'>Draw from posterior predictive h steps ahead distribution</h2><span id='topic+posterior_predict.varstan'></span><span id='topic+posterior_predict'></span>

<h3>Description</h3>

<p>The posterior predictive distribution is the distribution of the outcome
implied by the model after using the observed data to update our beliefs
about the unknown parameters in the model. Simulating data from the posterior
predictive distribution using the observed predictors is useful for checking
the fit of the model. Drawing from the posterior predictive distribution at
interesting values of the predictors also lets us visualize how a
manipulation of a predictor affects (a function of) the outcome(s). With new
observations of predictor variables we can use the posterior predictive
distribution to generate predicted outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
posterior_predict(
  object,
  h = 0,
  xreg = NULL,
  robust = FALSE,
  draws = 1000,
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posterior_predict.varstan_+3A_object">object</code></td>
<td>
<p>a varstan object</p>
</td></tr>
<tr><td><code id="posterior_predict.varstan_+3A_h">h</code></td>
<td>
<p>An integer indicating the number of predictions. The default number
of predictions is 12.</p>
</td></tr>
<tr><td><code id="posterior_predict.varstan_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="posterior_predict.varstan_+3A_robust">robust</code></td>
<td>
<p>A boolean for obtain the robust estimation. The default</p>
</td></tr>
<tr><td><code id="posterior_predict.varstan_+3A_draws">draws</code></td>
<td>
<p>An integer indicating the number of draws to return. The default
number of draws is 1000</p>
</td></tr>
<tr><td><code id="posterior_predict.varstan_+3A_seed">seed</code></td>
<td>
<p>An optional <code><a href="base.html#topic+set.seed">seed</a></code> to use.</p>
</td></tr>
<tr><td><code id="posterior_predict.varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>posterior_predict</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>draws</code> by <code>h</code> data.frame of simulations from the
posterior predictive distribution. Each row of the data.frame
is a vector of predictions generated using a single draw of
the model parameters from the posterior distribution.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>

<hr>
<h2 id='predictive_error.varstan'>Out-of-sample predictive errors</h2><span id='topic+predictive_error.varstan'></span><span id='topic+predictive_error'></span>

<h3>Description</h3>

<p>This is a convenience function for computing <code class="reqn">y - y_{h}</code>
The method for stanreg objects  calls <code><a href="#topic+posterior_predict">posterior_predict</a></code>
internally, where as the method accepts the data.frame returned by
<code>posterior_predict</code> as input and can be used to avoid multiple calls to
<code>posterior_predict</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
predictive_error(
  object,
  newdata = NULL,
  xreg = NULL,
  draws = 1000,
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predictive_error.varstan_+3A_object">object</code></td>
<td>
<p>Either a fitted model object returned by one of the <span class="pkg">rstanarm</span>
modeling functions (a stanreg object) or, for the <code>"ppd"</code> method, a matrix
of draws from the posterior predictive distribution returned by <code><a href="#topic+posterior_predict">posterior_predict</a></code>.</p>
</td></tr>
<tr><td><code id="predictive_error.varstan_+3A_newdata">newdata</code></td>
<td>
<p>An array with the newdata vector.</p>
</td></tr>
<tr><td><code id="predictive_error.varstan_+3A_xreg">xreg</code></td>
<td>
<p>Optional, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="predictive_error.varstan_+3A_draws">draws</code>, <code id="predictive_error.varstan_+3A_seed">seed</code></td>
<td>
<p>Optional arguments passed to <code><a href="#topic+posterior_predict">posterior_predict</a></code>.
Please see the <strong>Note</strong> section below if <code>newdata</code> will be specified.</p>
</td></tr>
<tr><td><code id="predictive_error.varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>predictive_error</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>draws</code> by <code>nrow(newdata)</code> data.frame.
</p>


<h3>Note</h3>

<p>If <code>object</code> is a <strong>varstan</strong> object of a varma model then newdata has to be a matrix
with number of <strong>cols</strong> as the dimension of the time series and number of <strong>rows</strong>
as the number new elements.
</p>
<p>If <code>object</code> is a <code>posterior_predict</code> data.frame, then the
length of <code>newdata</code> has to be equal to the <code>ncol</code> of <code>object</code>.
</p>
<p>If <code>object</code> is a <code>posterior_predict</code> data.frame, for a <strong>varma</strong> model,
then the dimension product of <code>newdata</code> matrix has to be equal to
the <code>ncol</code> of <code>object</code>.
</p>


<h3>See Also</h3>

<p><code>posterior_predict</code> function from rstanarm package, to draw
from the posterior predictive distribution without computing predictive
errors.
</p>

<hr>
<h2 id='print.garch'>Print a garch model</h2><span id='topic+print.garch'></span>

<h3>Description</h3>

<p>Print a garch model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'garch'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.garch_+3A_x">x</code></td>
<td>
<p>a garch model from the varstan package</p>
</td></tr>
<tr><td><code id="print.garch_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. prints the object
</p>

<hr>
<h2 id='print.Holt'>Print a Holt model</h2><span id='topic+print.Holt'></span>

<h3>Description</h3>

<p>Print a Holt model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Holt'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.Holt_+3A_x">x</code></td>
<td>
<p>a Holt model from the varstan package</p>
</td></tr>
<tr><td><code id="print.Holt_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. prints the object.
</p>

<hr>
<h2 id='print.Hw'>Print a Holt-Winter model</h2><span id='topic+print.Hw'></span>

<h3>Description</h3>

<p>Print a Holt-Winter model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Hw'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.Hw_+3A_x">x</code></td>
<td>
<p>a Hw from the varstan package</p>
</td></tr>
<tr><td><code id="print.Hw_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. prints the object.
</p>

<hr>
<h2 id='print.LocalLevel'>Print a Local Level model</h2><span id='topic+print.LocalLevel'></span>

<h3>Description</h3>

<p>Print a Local Level model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LocalLevel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.LocalLevel_+3A_x">x</code></td>
<td>
<p>a LocalLevel model from the varstan package</p>
</td></tr>
<tr><td><code id="print.LocalLevel_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. prints the object.
</p>

<hr>
<h2 id='print.naive'>Print a naive model</h2><span id='topic+print.naive'></span>

<h3>Description</h3>

<p>Print a naive model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'naive'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.naive_+3A_x">x</code></td>
<td>
<p>a naive model from the varstan package</p>
</td></tr>
<tr><td><code id="print.naive_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. prints the object
</p>

<hr>
<h2 id='print.Sarima'>Print a Sarima model</h2><span id='topic+print.Sarima'></span>

<h3>Description</h3>

<p>Print a Sarima model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Sarima'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.Sarima_+3A_x">x</code></td>
<td>
<p>a Sarima model from the varstan package</p>
</td></tr>
<tr><td><code id="print.Sarima_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. prints the object
</p>

<hr>
<h2 id='print.ssm'>Print a state-space model</h2><span id='topic+print.ssm'></span>

<h3>Description</h3>

<p>Print a state-space model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ssm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ssm_+3A_x">x</code></td>
<td>
<p>a ssm model from the varstan package</p>
</td></tr>
<tr><td><code id="print.ssm_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. prints the object.
</p>

<hr>
<h2 id='print.SVM'>Print a Stochastic Volatility model</h2><span id='topic+print.SVM'></span>

<h3>Description</h3>

<p>Print a Stochastic Volatility model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SVM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.SVM_+3A_x">x</code></td>
<td>
<p>a SVM model from the varstan package</p>
</td></tr>
<tr><td><code id="print.SVM_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. prints the object
</p>

<hr>
<h2 id='print.varstan'>Print a varstan object</h2><span id='topic+print.varstan'></span>

<h3>Description</h3>

<p>Print a varstan object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.varstan_+3A_x">x</code></td>
<td>
<p>a varstan object</p>
</td></tr>
<tr><td><code id="print.varstan_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. prints the object.
</p>

<hr>
<h2 id='prior_summary.varstan'>Generic function for extracting information about prior distributions</h2><span id='topic+prior_summary.varstan'></span><span id='topic+prior_summary'></span>

<h3>Description</h3>

<p>The function returns a report with the users defined model for the given time series data
and all the current defined priors of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
prior_summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prior_summary.varstan_+3A_object">object</code></td>
<td>
<p>a varstan object or one of the defined current defined reports in varstan package</p>
</td></tr>
<tr><td><code id="prior_summary.varstan_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if <code>object</code> is a varstan object the function will print the information of the
defined model inside of the object. If <code>object</code> is one of the model classes (like Sarima or garch)
then it will print the report information as well.
</p>


<h3>Value</h3>

<p>none. prints a string with the defined time series model report
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(astsa)
dat2 = garch(birth,order = c(1,1,0))
prior_summary(dat2)

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+autoplot'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ggplot2</dt><dd><p><code><a href="ggplot2.html#topic+autoplot">autoplot</a></code></p>
</dd>
</dl>

<hr>
<h2 id='report'>Print a full report of the time series model in a  varstan object.</h2><span id='topic+report'></span><span id='topic+report.varstan'></span><span id='topic+report.Sarima'></span><span id='topic+report.garch'></span><span id='topic+report.varma'></span><span id='topic+report.Bekk'></span><span id='topic+report.naive'></span>

<h3>Description</h3>

<p>The function returns a report with the users defined model for the given time series data
and all the current defined priors of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="report_+3A_object">object</code></td>
<td>
<p>an object varstan object or one of the defined current defined reports in varstan package</p>
</td></tr>
<tr><td><code id="report_+3A_...">...</code></td>
<td>
<p>additional values need in print methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if <code>object</code> is a varstan object the function will print the information of the
defined model inside of the object. If <code>object</code> is one of the model classes (like Sarima or garch)
then it will print the report information as well.
</p>


<h3>Value</h3>

<p>none. prints a string with the defined time series model report
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(astsa)
dat2 = garch(birth,order = c(1,1,0))
report(dat2)

</code></pre>

<hr>
<h2 id='residuals.varstan'>Generic function and method for extract the residual of a varstan object</h2><span id='topic+residuals.varstan'></span>

<h3>Description</h3>

<p>The function returns the posterior estimate of the residuals
of a varstan model, similar to the residual functions of other
packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
residuals(object, robust = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.varstan_+3A_object">object</code></td>
<td>
<p>A varstan object, <code><a href="#topic+varstan">varstan</a></code></p>
</td></tr>
<tr><td><code id="residuals.varstan_+3A_robust">robust</code></td>
<td>
<p>A boolean value, if its <code>TRUE</code> it returns the median of the posterior distribution,
and if its <code>FALSE</code> it returns the mean, by default is the <code>FALSE</code> value</p>
</td></tr>
<tr><td><code id="residuals.varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>posterior_residual</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function only extracts the point-wise estimate of the time series residuals
for extracting all the data use <code>extract_stan()</code> or posterior_intervals function
</p>


<h3>Value</h3>

<p>An array with the posterior estimate of the residuals of the time series model,
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>

<hr>
<h2 id='Sarima'>Constructor a Multiplicative Seasonal ARIMA model.</h2><span id='topic+Sarima'></span>

<h3>Description</h3>

<p>Constructor of the SARIMA model  for Bayesian estimation in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sarima(ts,order = c(1,0,0),seasonal = c(0,0,0),xreg = NULL,period = 0,series.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Sarima_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="Sarima_+3A_order">order</code></td>
<td>
<p>A specification of the non-seasonal part of the ARIMA model: the
three components (p, d, q) are the AR order, the number of differences, and the
MA order.</p>
</td></tr>
<tr><td><code id="Sarima_+3A_seasonal">seasonal</code></td>
<td>
<p>A specification of the seasonal part of the ARIMA model,same as
order parameter:  the three components (p, d, q) are the seasonal AR order,
the degree of seasonal differences, and the seasonal MA order.</p>
</td></tr>
<tr><td><code id="Sarima_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="Sarima_+3A_period">period</code></td>
<td>
<p>an integer specifying the periodicity of the time series by
default the value frequency(ts) is used.</p>
</td></tr>
<tr><td><code id="Sarima_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package
</p>
<p>If <code>xreg</code> option is used, the model by default will cancel the
seasonal differences adjusted (D = 0). If a value <code>d</code> &gt; 0 is used, all
the regressor variables in <code>xreg</code> will be difference as well.
</p>
<p>The default priors used in Sarima are:
</p>

<ul>
<li><p>ar ~ normal(0,0.5)
</p>
</li>
<li><p>ma ~ normal(0,0.5)
</p>
</li>
<li><p>mu0 ~ t-student(0,2.5,6)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>sar ~ normal(0,0.5)
</p>
</li>
<li><p>sma ~ normal(0,0.5)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior</code>
</p>


<h3>Value</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>References</h3>

<p>Box, G. E. P. and Jenkins, G.M. (1978). Time series analysis: Forecasting and
control. San Francisco: Holden-Day. <em>Biometrika</em>, 60(2), 297-303.
<code>doi:10.1093/biomet/65.2.297</code>.
</p>
<p>Kennedy, P. (1992). Forecasting with dynamic regression models: Alan Pankratz, 1991.
<em>International Journal of Forecasting</em>. 8(4), 647-648.
<code>url: https://EconPapers.repec.org/RePEc:eee:intfor:v:8:y:1992:i:4:p:647-648</code>.
</p>
<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+garch">garch</a></code> <code><a href="#topic+set_prior">set_prior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Declare a multiplicative seasonal ARIMA model for the birth data.

library(astsa)
model = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
model

#Declare an Dynamic Harmonic Regression model for the birth data.
model = Sarima(birth,order = c(1,0,1),xreg = fourier(birth,K = 2))
model

</code></pre>

<hr>
<h2 id='set_prior'>Set a prior distribution to a model parameter.</h2><span id='topic+set_prior'></span>

<h3>Description</h3>

<p>setting a prior distribution to an specify model parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_prior(model, par = "ar", dist = normal(), lag = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_prior_+3A_model">model</code></td>
<td>
<p>a time series model class specified in <span class="pkg">varstan</span>.</p>
</td></tr>
<tr><td><code id="set_prior_+3A_par">par</code></td>
<td>
<p>a string value with the  desired parameter which a prior is defined could be:
&quot;mu0&quot;, &quot;sigma0&quot;, &quot;ar&quot;, &quot;ma&quot;, &quot;arch&quot;, &quot;garch&quot;, &quot;mgarch&quot;, &quot;dfv&quot;, &quot;df&quot;, &quot;LKJ&quot; or &quot;breg&quot;.</p>
</td></tr>
<tr><td><code id="set_prior_+3A_dist">dist</code></td>
<td>
<p>the distribution of the prior parameter. The only accepted is a prior_dist object.</p>
</td></tr>
<tr><td><code id="set_prior_+3A_lag">lag</code></td>
<td>
<p>an optional integer value, indicates the desired lag of the parameter which the prior
is defined if lag = 0, then the prior distribution will be applied for all lags.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>varstan provides its own functions to manipulate the parameter prior, this functions return
a <code>prior_dist</code> class, the <code>dist</code> argument only accepts this objects.
</p>
<p><code>lag</code> parameter is an optional value to change the prior distribution of one parameter in particular,
this argument is only valid for: &quot;ar&quot;,&quot;ma&quot;, &quot;arch&quot;, &quot;garch&quot;, &quot;mgarch&quot;, or &quot;breg&quot; par arguments. lag has to
be a integer lower than the total amount of lagged parameters of the model. For example, to  ONLY
change the prior of the second &quot;arch&quot; parameter in a garch(3,1) model, a lag = 2 values must be specified.
</p>
<p>For varma and Bekk models the covariance matrix Sigma is factorized as follows:</p>
<pre>              Sigma = D' Omega D
</pre>
<p>Where Omega is the correlation matrix that accepts an LKJ prior distribution D is a diagonal matrix with
the inverse std deviations
</p>
<p>For changing the degree freedom in a LKJ distribution for omega use par = &quot;LKJ&quot; and dist = LKJ(df),
where df are the desired degree freedom.
</p>
<p>For changing the the priors in the diagonal D use par = &quot;sigma0&quot; and select one of the available prior
distributions.
</p>
<p>For ar, ma garch, arch parameters in varma and Bekk models only normal distributions priors with different
mu and sd are accepted. Even if <code>get_prior</code> accepts its change, Stan will change it to a normal(0,1) prior.
</p>


<h3>Value</h3>

<p>a time series model class specified in <span class="pkg">varstan</span> with the changed prior.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(astsa)
dat = Sarima(birth,order = c(1,1,2))
dat = set_prior(model = dat,par = "ar",dist = normal(0,2))
dat

dat = set_prior(model = dat,par = "mu0",dist = student(mu=0,sd = 2.5,df = 7))
dat

dat = set_prior(model = dat,par = "ma",dist= beta(shape1 = 2,shape2 = 2),lag = 2)
dat

</code></pre>

<hr>
<h2 id='ssm'>A  constructor for a Additive linear State space model.</h2><span id='topic+ssm'></span>

<h3>Description</h3>

<p>Constructor of the <code>ets("Z","Z","Z")</code> object for Bayesian estimation in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssm(ts,trend = FALSE,damped = FALSE,seasonal = FALSE,xreg = NULL,
           period = 0,genT = FALSE,series.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ssm_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="ssm_+3A_trend">trend</code></td>
<td>
<p>a boolean value to specify a trend local level model. By default
is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ssm_+3A_damped">damped</code></td>
<td>
<p>a boolean value to specify a damped trend local level model. By default
is <code>FALSE</code>. If <code>trend</code> option is <code>FALSE</code> then <code>damped</code> is set to
<code>FALSE</code> automatically.</p>
</td></tr>
<tr><td><code id="ssm_+3A_seasonal">seasonal</code></td>
<td>
<p>a boolean value to specify a seasonal local level model. By default
is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ssm_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="ssm_+3A_period">period</code></td>
<td>
<p>an integer specifying the periodicity of the time series by
default the value frequency(ts) is used.</p>
</td></tr>
<tr><td><code id="ssm_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student SSM model.</p>
</td></tr>
<tr><td><code id="ssm_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the time series names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>
<p>By  default  the  <code>ssm()</code>  function generates a local level model (or a ets(&quot;A&quot;,&quot;N&quot;,&quot;N&quot;) or
exponential smoothing model from the <span class="pkg">forecast</span> package). If <code>trend</code> is set <code>TRUE</code>,
then  a  local  trend ssm model is defined (a equivalent ets(&quot;A&quot;,&quot;A&quot;,&quot;N&quot;) or Holt model from the
<span class="pkg">forecast</span> package). For damped trend models set <code>damped</code> to <code>TRUE</code>. If <code>seasonal</code>
is  set  to  <code>TRUE</code> a seasonal local level model is defined (a equivalent ets(&quot;A&quot;,&quot;N&quot;,&quot;A&quot;) model
from  the  <span class="pkg">forecast</span> package). For a Holt-Winters method (ets(&quot;A&quot;,&quot;A&quot;,&quot;A&quot;)) set <code>Trend</code> and
<code>seasonal</code> to <code>TRUE</code>.
</p>
<p>When <code>genT</code> option is <code>TRUE</code> a t-student innovations ssm model (see Ardia (2010)) is generated
see Fonseca, et. al (2019) for more details.
</p>
<p>The default priors used in a ssm( ) model are:
</p>

<ul>
<li><p>level ~ normal(0,0.5)
</p>
</li>
<li><p>Trend ~ normal(0,0.5)
</p>
</li>
<li><p>damped~ normal(0,0.5)
</p>
</li>
<li><p>Seasonal ~ normal(0,0.5)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>level1 ~ normal(0,1)
</p>
</li>
<li><p>trend1 ~ normal(0,1)
</p>
</li>
<li><p>seasonal1 ~ normal(0,1)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code> <code><a href="#topic+garch">garch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mod1 = ssm(ipc)

# Declaring a Holt model for the ipc data.
mod2 = ssm(ipc,trend = TRUE,damped = TRUE)

# Declaring an additive Holt-Winters model for the birth data
mod3 = ssm(birth,trend = TRUE,damped = TRUE,seasonal = TRUE)

</code></pre>

<hr>
<h2 id='stan_garch'>Fitting for a GARCH(s,k,h) model.</h2><span id='topic+stan_garch'></span>

<h3>Description</h3>

<p>Fitting a <code>GARCH(s,k,h)</code> model in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_garch(
  ts,
  order = c(1, 1, 0),
  arma = c(0, 0),
  xreg = NULL,
  genT = FALSE,
  asym = "none",
  chains = 4,
  iter = 2000,
  warmup = floor(iter/2),
  adapt.delta = 0.9,
  tree.depth = 10,
  stepwise = TRUE,
  prior_mu0 = NULL,
  prior_sigma0 = NULL,
  prior_ar = NULL,
  prior_ma = NULL,
  prior_mgarch = NULL,
  prior_arch = NULL,
  prior_garch = NULL,
  prior_breg = NULL,
  prior_gamma = NULL,
  prior_df = NULL,
  series.name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_garch_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_order">order</code></td>
<td>
<p>A specification of the garch  model: the three components (s, k, h)
are the arch order, the garch order, and the mgarch order.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_arma">arma</code></td>
<td>
<p>A specification of the  ARMA model,same as order parameter:  the two
components (p, q) are the AR order,and the  MA order.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student garch model.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_asym">asym</code></td>
<td>
<p>a string value for the asymmetric function for an asymmetric GARCH process. By default
the value <code>"none"</code> for standard GARCH process. If <code>"logit"</code> a logistic function
is used for asymmetry, and if <code>"exp"</code> an exponential function is used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for step-size
adaptation, so warm-up samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_stepwise">stepwise</code></td>
<td>
<p>If TRUE, will do stepwise selection (faster). Otherwise, it searches
over all models. Non-stepwise selection can be very slow, especially for seasonal models.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_mu0">prior_mu0</code></td>
<td>
<p>The prior distribution for the location parameter in an ARMA model. By default
the value is set <code>NULL</code>, then the default normal(0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_sigma0">prior_sigma0</code></td>
<td>
<p>The prior distribution for the scale parameter in an ARMA model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_ar">prior_ar</code></td>
<td>
<p>The prior distribution for the auto-regressive parameters in an ARMA model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_ma">prior_ma</code></td>
<td>
<p>The prior distribution for the moving average parameters in an ARMA model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_mgarch">prior_mgarch</code></td>
<td>
<p>The prior distribution for the mean GARCH parameters in a
GARCH model. By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_arch">prior_arch</code></td>
<td>
<p>The prior distribution for the arch parameters in a GARCH model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_garch">prior_garch</code></td>
<td>
<p>The prior distribution for the GARCH parameters in a GARCH model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_breg">prior_breg</code></td>
<td>
<p>The prior distribution for the regression coefficient parameters in a
ARIMAX model. By default the value is set <code>NULL</code>, then the default student(7,0,1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_gamma">prior_gamma</code></td>
<td>
<p>The prior distribution for the asymmetric parameters in am Asymmetric
GARCH model. By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_prior_df">prior_df</code></td>
<td>
<p>The prior distribution for the degree freedom parameters in a t-student innovations
GARCH model. By default the value is set <code>NULL</code>, then the default gamma(2,0.1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
<tr><td><code id="stan_garch_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>varstan</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a <code>varstan</code> object with the fitted model.
</p>
<p>By default the <code>garch()</code> function generates a GARCH(1,1) model, when
<code>genT</code> option is <code>TRUE</code> a t-student innovations GARCH model
(see Ardia (2010)) is generated, and for Asymmetric GARCH models use the
option <code>asym</code> for specify the asymmetric function, see Fonseca,
et. al (2019) for more details.
</p>
<p>The default priors used in a GARCH(s,k,h) model are:
</p>

<ul>
<li><p>ar ~ normal(0,0.5)
</p>
</li>
<li><p>ma ~ normal(0,0.5)
</p>
</li>
<li><p>mu0 ~ t-student(0,2.5,6)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>arch ~ normal(0,0.5)
</p>
</li>
<li><p>garch ~ normal(0,0.5)
</p>
</li>
<li><p>mgarch ~ normal(0,0.5)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>A <code>varstan</code> object with the fitted GARCH model.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Engle, R. (1982). Autoregressive Conditional Heteroscedasticity with Estimates of
the Variance of United Kingdom Inflation. <em>Econometrica</em>, 50(4), 987-1007.
<code>url: http://www.jstor.org/stable/1912773</code>.
</p>
<p>Bollerslev, T. (1986). Generalized autoregressive conditional heteroskedasticity.
<em>Journal of Econometrics</em>. 31(3), 307-327.
<code>doi: https://doi.org/10.1016/0304-4076(86)90063-1</code>.
</p>
<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>
<p>Ardia, D. and Hoogerheide, L. (2010). Bayesian Estimation of the GARCH(1,1) Model
with Student-t Innovations. <em>The R Journal</em>. 2(7), 41-47.
<code>doi: 10.32614/RJ-2010-014</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Declaring a garch(1,1) model for the ipc data.
 sf1 = stan_garch(ipc,order = c(1,1,0),iter = 500,chains = 1)

 # Declaring a t-student M-GARCH(2,3,1)-ARMA(1,1) process for the ipc data.
 sf2 = stan_garch(ipc,order = c(2,3,1),arma = c(1,1),genT = TRUE,iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='stan_Holt'>Fitting an Holt state-space model.</h2><span id='topic+stan_Holt'></span>

<h3>Description</h3>

<p>Fitting an Holt state-space model in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_Holt(
  ts,
  damped = FALSE,
  xreg = NULL,
  genT = FALSE,
  chains = 4,
  iter = 2000,
  warmup = floor(iter/2),
  adapt.delta = 0.9,
  tree.depth = 10,
  stepwise = TRUE,
  prior_sigma0 = NULL,
  prior_level = NULL,
  prior_level1 = NULL,
  prior_trend = NULL,
  prior_trend1 = NULL,
  prior_damped = NULL,
  prior_breg = NULL,
  prior_df = NULL,
  series.name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_Holt_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_damped">damped</code></td>
<td>
<p>a boolean value to specify a damped trend local level model. By default
is <code>FALSE</code>. If <code>trend</code> option is <code>FALSE</code> then <code>damped</code> is set to
<code>FALSE</code> automatically.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student SSM model.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for step-size
adaptation, so warm-up samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_stepwise">stepwise</code></td>
<td>
<p>If TRUE, will do stepwise selection (faster). Otherwise, it searches
over all models. Non-stepwise selection can be very slow, especially for seasonal models.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_prior_sigma0">prior_sigma0</code></td>
<td>
<p>The prior distribution for the scale parameter in an SSM model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_prior_level">prior_level</code></td>
<td>
<p>The prior distribution for the level parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_prior_level1">prior_level1</code></td>
<td>
<p>The prior distribution for the initial level parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default student(6,0,2.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_prior_trend">prior_trend</code></td>
<td>
<p>The prior distribution for the trend parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_prior_trend1">prior_trend1</code></td>
<td>
<p>The prior distribution for the initial trend parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default student(6,0,2.5)  priors are used.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_prior_damped">prior_damped</code></td>
<td>
<p>The prior distribution for the damped trend parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_prior_breg">prior_breg</code></td>
<td>
<p>The prior distribution for the regression coefficient parameters in a
ARMAX model. By default the value is set <code>NULL</code>, then the default student(7,0,1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_prior_df">prior_df</code></td>
<td>
<p>The prior distribution for the degree freedom parameters in a t-student innovations
SSM model. By default the value is set <code>NULL</code>, then the default gamma(2,0.1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
<tr><td><code id="stan_Holt_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>varstan</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a <code>varstan</code> object with the fitted model.
</p>
<p>When <code>genT</code> option is <code>TRUE</code> a t-student innovations ssm model (see Ardia (2010)) is generated
see Fonseca, et. al (2019) for more details.
</p>
<p>The default priors used in a ssm( ) model are:
</p>

<ul>
<li><p>level ~ normal(0,0.5)
</p>
</li>
<li><p>Trend ~ normal(0,0.5)
</p>
</li>
<li><p>damped~ normal(0,0.5)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>level1 ~ normal(0,1)
</p>
</li>
<li><p>trend1 ~ normal(0,1)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>A <code>varstan</code> object with the fitted SSM model.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code> <code><a href="#topic+garch">garch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Declaring a Holt model for the ipc data.
 sf1 = stan_Holt(ipc,iter = 500,chains = 1)

 # Declaring a Holt damped trend model for the ipc data.
 sf2 = stan_Holt(ipc,damped = TRUE,iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='stan_Hw'>Fitting a Holt-Winters state-space model.</h2><span id='topic+stan_Hw'></span>

<h3>Description</h3>

<p>Fitting a Holt-Winters state-space model in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_Hw(
  ts,
  damped = FALSE,
  xreg = NULL,
  period = 0,
  genT = FALSE,
  chains = 4,
  iter = 2000,
  warmup = floor(iter/2),
  adapt.delta = 0.9,
  tree.depth = 10,
  stepwise = TRUE,
  prior_sigma0 = NULL,
  prior_level = NULL,
  prior_level1 = NULL,
  prior_trend = NULL,
  prior_trend1 = NULL,
  prior_damped = NULL,
  prior_seasonal = NULL,
  prior_seasonal1 = NULL,
  prior_breg = NULL,
  prior_df = NULL,
  series.name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_Hw_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_damped">damped</code></td>
<td>
<p>a boolean value to specify a damped trend local level model. By default
is <code>FALSE</code>. If <code>trend</code> option is <code>FALSE</code> then <code>damped</code> is set to
<code>FALSE</code> automatically.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_period">period</code></td>
<td>
<p>an integer specifying the periodicity of the time series by
default the value frequency(ts) is used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student SSM model.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for step-size
adaptation, so warm-up samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_stepwise">stepwise</code></td>
<td>
<p>If TRUE, will do stepwise selection (faster). Otherwise, it searches
over all models. Non-stepwise selection can be very slow, especially for seasonal models.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_sigma0">prior_sigma0</code></td>
<td>
<p>The prior distribution for the scale parameter in an SSM model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_level">prior_level</code></td>
<td>
<p>The prior distribution for the level parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_level1">prior_level1</code></td>
<td>
<p>The prior distribution for the initial level parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default student(6,0,2.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_trend">prior_trend</code></td>
<td>
<p>The prior distribution for the trend parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_trend1">prior_trend1</code></td>
<td>
<p>The prior distribution for the initial trend parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default student(6,0,2.5)  priors are used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_damped">prior_damped</code></td>
<td>
<p>The prior distribution for the damped trend parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_seasonal">prior_seasonal</code></td>
<td>
<p>The prior distribution for the seasonal parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_seasonal1">prior_seasonal1</code></td>
<td>
<p>The prior distribution for the initial seasonal parameters in a SSM model.
The prior is specified for the first m seasonal parameters, where m is the periodicity of the
defined time series. By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_breg">prior_breg</code></td>
<td>
<p>The prior distribution for the regression coefficient parameters in a
ARMAX model. By default the value is set <code>NULL</code>, then the default student(7,0,1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_prior_df">prior_df</code></td>
<td>
<p>The prior distribution for the degree freedom parameters in a t-student innovations
SSM model. By default the value is set <code>NULL</code>, then the default gamma(2,0.1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
<tr><td><code id="stan_Hw_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>varstan</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a <code>varstan</code> object with the fitted model.
</p>
<p>When <code>genT</code> option is <code>TRUE</code> a t-student innovations ssm model (see Ardia (2010)) is generated
see Fonseca, et. al (2019) for more details.
</p>
<p>The default priors used in a ssm( ) model are:
</p>

<ul>
<li><p>level ~ normal(0,0.5)
</p>
</li>
<li><p>Trend ~ normal(0,0.5)
</p>
</li>
<li><p>damped~ normal(0,0.5)
</p>
</li>
<li><p>Seasonal ~ normal(0,0.5)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>level1 ~ normal(0,1)
</p>
</li>
<li><p>trend1 ~ normal(0,1)
</p>
</li>
<li><p>seasonal1 ~ normal(0,1)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>A <code>varstan</code> object with the fitted SSM model.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code> <code><a href="#topic+garch">garch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Declaring a Holt-Winters model for the ipc data.
 sf1 = stan_Hw(ipc,iter = 500,chains = 1)

 # Declaring a Holt-Winters damped trend model for the ipc data.
 sf2 = stan_ssm(ipc,damped = TRUE,iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='stan_LocalLevel'>Fitting a Local level state-space model.</h2><span id='topic+stan_LocalLevel'></span>

<h3>Description</h3>

<p>Fitting a Local level state-space model in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_LocalLevel(
  ts,
  xreg = NULL,
  genT = FALSE,
  chains = 4,
  iter = 2000,
  warmup = floor(iter/2),
  adapt.delta = 0.9,
  tree.depth = 10,
  stepwise = TRUE,
  prior_sigma0 = NULL,
  prior_level = NULL,
  prior_level1 = NULL,
  prior_breg = NULL,
  prior_df = NULL,
  series.name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_LocalLevel_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student SSM model.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for step-size
adaptation, so warm-up samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_stepwise">stepwise</code></td>
<td>
<p>If TRUE, will do stepwise selection (faster). Otherwise, it searches
over all models. Non-stepwise selection can be very slow, especially for seasonal models.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_prior_sigma0">prior_sigma0</code></td>
<td>
<p>The prior distribution for the scale parameter in an SSM model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_prior_level">prior_level</code></td>
<td>
<p>The prior distribution for the level parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_prior_level1">prior_level1</code></td>
<td>
<p>The prior distribution for the initial level parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default student(6,0,2.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_prior_breg">prior_breg</code></td>
<td>
<p>The prior distribution for the regression coefficient parameters in a
ARMAX model. By default the value is set <code>NULL</code>, then the default student(7,0,1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_prior_df">prior_df</code></td>
<td>
<p>The prior distribution for the degree freedom parameters in a t-student innovations
SSM model. By default the value is set <code>NULL</code>, then the default gamma(2,0.1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
<tr><td><code id="stan_LocalLevel_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>varstan</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a <code>varstan</code> object with the fitted model.
</p>
<p>When <code>genT</code> option is <code>TRUE</code> a t-student innovations ssm model (see Ardia (2010)) is generated
see Fonseca, et. al (2019) for more details.
</p>
<p>The default priors used in a Local_level( ) model are:
</p>

<ul>
<li><p>level ~ normal(0,0.5)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>level1 ~ normal(0,1)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>A <code>varstan</code> object with the fitted Local Level model.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code> <code><a href="#topic+garch">garch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Declaring a local level model for the ipc data.
 sf1 = stan_LocalLevel(ipc,iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='stan_naive'>Naive and Random Walk models.</h2><span id='topic+stan_naive'></span>

<h3>Description</h3>

<p>naive is the model constructor for a random walk  model applied to <code>y</code>.
This is equivalent to an ARIMA(0,1,0) model. <code>naive()</code> is simply a wrapper
to  maintain forecast package similitude. <code>seasonal</code> returns the model constructor
for a seasonal random walk equivalent to an ARIMA(0,0,0)(0,1,0)m model where m is the
seasonal period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_naive(
  ts,
  seasonal = FALSE,
  m = 0,
  chains = 4,
  iter = 2000,
  warmup = floor(iter/2),
  adapt.delta = 0.9,
  tree.depth = 10,
  stepwise = TRUE,
  prior_mu0 = NULL,
  prior_sigma0 = NULL,
  series.name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_naive_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_seasonal">seasonal</code></td>
<td>
<p>a Boolean value for select a seasonal random walk instead.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_m">m</code></td>
<td>
<p>an optional integer value for the seasonal period.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for step-size
adaptation, so warm-up samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_stepwise">stepwise</code></td>
<td>
<p>If TRUE, will do stepwise selection (faster). Otherwise, it searches
over all models. Non-stepwise selection can be very slow, especially for seasonal models.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_prior_mu0">prior_mu0</code></td>
<td>
<p>The prior distribution for the location parameter in an ARIMA model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_prior_sigma0">prior_sigma0</code></td>
<td>
<p>The prior distribution for the scale parameter in an ARIMA model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
<tr><td><code id="stan_naive_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>varstan</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The random walk with drift model is
</p>
<p style="text-align: center;"><code class="reqn">Y_t = mu_0 + Y_{t-1} + epsilon_t</code>
</p>

<p>where  <code class="reqn">epsilon_t</code> is a normal iid error.
</p>
<p>The seasonal naive model is
</p>
<p style="text-align: center;"><code class="reqn">Y_t = mu_0 + Y_{t-m} + epsilon_t</code>
</p>

<p>where  <code class="reqn">epsilon_t</code> is a normal iid error.
</p>


<h3>Value</h3>

<p>A <code>varstan</code> object with the fitted naive Random Walk model.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>References</h3>

<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>.
</p>
<p>Box, G. E. P. and Jenkins, G.M. (1978). Time series analysis: Forecasting and
control. San Francisco: Holden-Day. <em>Biometrika</em>, 60(2), 297-303.
<code>doi:10.1093/biomet/65.2.297</code>.
</p>
<p>Kennedy, P. (1992). Forecasting with dynamic regression models: Alan Pankratz, 1991.
<em>International Journal of Forecasting</em>. 8(4), 647-648.
<code>url: https://EconPapers.repec.org/RePEc:eee:intfor:v:8:y:1992:i:4:p:647-648</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 # A seasonal Random-walk model.
 sf1 = stan_naive(birth,seasonal = TRUE,iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='stan_sarima'>Fitting a Multiplicative Seasonal ARIMA model.</h2><span id='topic+stan_sarima'></span>

<h3>Description</h3>

<p>Fitting a SARIMA model  in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_sarima(
  ts,
  order = c(1, 0, 0),
  seasonal = c(0, 0, 0),
  xreg = NULL,
  period = 0,
  chains = 4,
  iter = 2000,
  warmup = floor(iter/2),
  adapt.delta = 0.9,
  tree.depth = 10,
  stepwise = TRUE,
  prior_mu0 = NULL,
  prior_sigma0 = NULL,
  prior_ar = NULL,
  prior_ma = NULL,
  prior_sar = NULL,
  prior_sma = NULL,
  prior_breg = NULL,
  series.name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_sarima_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_order">order</code></td>
<td>
<p>A specification of the non-seasonal part of the ARIMA model: the
three components (p, d, q) are the AR order, the number of differences, and the
MA order.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_seasonal">seasonal</code></td>
<td>
<p>A specification of the seasonal part of the ARIMA model,same as
order parameter:  the three components (p, d, q) are the seasonal AR order,
the degree of seasonal differences, and the seasonal MA order.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_period">period</code></td>
<td>
<p>an integer specifying the periodicity of the time series by
default the value frequency(ts) is used.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for step-size
adaptation, so warm-up samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_stepwise">stepwise</code></td>
<td>
<p>If TRUE, will do stepwise selection (faster). Otherwise, it searches
over all models. Non-stepwise selection can be very slow, especially for seasonal models.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_prior_mu0">prior_mu0</code></td>
<td>
<p>The prior distribution for the location parameter in an ARIMA model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_prior_sigma0">prior_sigma0</code></td>
<td>
<p>The prior distribution for the scale parameter in an ARIMA model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_prior_ar">prior_ar</code></td>
<td>
<p>The prior distribution for the auto-regressive parameters in an ARIMA model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_prior_ma">prior_ma</code></td>
<td>
<p>The prior distribution for the moving average parameters in an ARIMA model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_prior_sar">prior_sar</code></td>
<td>
<p>The prior distribution for the seasonal auto-regressive parameters in a
SARIMA model. By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_prior_sma">prior_sma</code></td>
<td>
<p>The prior distribution for the seasonal moving average parameters in a
SARIMA model. By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_prior_breg">prior_breg</code></td>
<td>
<p>The prior distribution for the regression coefficient parameters in a
ARIMAX model. By default the value is set <code>NULL</code>, then the default student(7,0,1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
<tr><td><code id="stan_sarima_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>varstan</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a <code>varstan</code> object with the fitted model.
</p>
<p>If <code>xreg</code> option is used, the model by default will cancel the
seasonal differences adjusted (D = 0). If a value <code>d</code> &gt; 0 is used, all
the regressor variables in <code>xreg</code> will be difference as well.
</p>
<p>The default priors used in Sarima are:
</p>

<ul>
<li><p>ar ~ normal(0,0.5)
</p>
</li>
<li><p>ma ~ normal(0,0.5)
</p>
</li>
<li><p>mu0 ~ t-student(0,2.5,6)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>sar ~ normal(0,0.5)
</p>
</li>
<li><p>sma ~ normal(0,0.5)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>varstan</code> object with the fitted SARIMA model.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>References</h3>

<p>Box, G. E. P. and Jenkins, G.M. (1978). Time series analysis: Forecasting and
control. San Francisco: Holden-Day. <em>Biometrika</em>, 60(2), 297-303.
<code>doi:10.1093/biomet/65.2.297</code>.
</p>
<p>Kennedy, P. (1992). Forecasting with dynamic regression models: Alan Pankratz, 1991.
<em>International Journal of Forecasting</em>. 8(4), 647-648.
<code>url: https://EconPapers.repec.org/RePEc:eee:intfor:v:8:y:1992:i:4:p:647-648</code>.
</p>
<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+garch">garch</a></code> <code><a href="#topic+set_prior">set_prior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 # Declare a multiplicative seasonal ARIMA model for the birth data.
 sf1 = stan_sarima(birth,order = c(0,1,2),
                   seasonal = c(1,1,1),iter = 500,chains = 1)


 #Declare an Dynamic Harmonic Regression model for the birth data.
 sf2 = stan_sarima(birth,order = c(1,0,1),
                   xreg = fourier(birth,K = 2),iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='stan_ssm'>Fitting an Additive linear State space model.</h2><span id='topic+stan_ssm'></span>

<h3>Description</h3>

<p>Fitting an Additive linear State space model in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_ssm(
  ts,
  trend = FALSE,
  damped = FALSE,
  seasonal = FALSE,
  xreg = NULL,
  period = 0,
  genT = FALSE,
  chains = 4,
  iter = 2000,
  warmup = floor(iter/2),
  adapt.delta = 0.9,
  tree.depth = 10,
  stepwise = TRUE,
  prior_sigma0 = NULL,
  prior_level = NULL,
  prior_level1 = NULL,
  prior_trend = NULL,
  prior_trend1 = NULL,
  prior_damped = NULL,
  prior_seasonal = NULL,
  prior_seasonal1 = NULL,
  prior_breg = NULL,
  prior_df = NULL,
  series.name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_ssm_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_trend">trend</code></td>
<td>
<p>a boolean value to specify a trend local level model. By default
is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_damped">damped</code></td>
<td>
<p>a boolean value to specify a damped trend local level model. By default
is <code>FALSE</code>. If <code>trend</code> option is <code>FALSE</code> then <code>damped</code> is set to
<code>FALSE</code> automatically.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_seasonal">seasonal</code></td>
<td>
<p>a boolean value to specify a seasonal local level model. By default
is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_period">period</code></td>
<td>
<p>an integer specifying the periodicity of the time series by
default the value frequency(ts) is used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_gent">genT</code></td>
<td>
<p>a boolean value to specify for a generalized t-student SSM model.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for step-size
adaptation, so warm-up samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_stepwise">stepwise</code></td>
<td>
<p>If TRUE, will do stepwise selection (faster). Otherwise, it searches
over all models. Non-stepwise selection can be very slow, especially for seasonal models.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_sigma0">prior_sigma0</code></td>
<td>
<p>The prior distribution for the scale parameter in an SSM model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_level">prior_level</code></td>
<td>
<p>The prior distribution for the level parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_level1">prior_level1</code></td>
<td>
<p>The prior distribution for the initial level parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default student(6,0,2.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_trend">prior_trend</code></td>
<td>
<p>The prior distribution for the trend parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_trend1">prior_trend1</code></td>
<td>
<p>The prior distribution for the initial trend parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default student(6,0,2.5)  priors are used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_damped">prior_damped</code></td>
<td>
<p>The prior distribution for the damped trend parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_seasonal">prior_seasonal</code></td>
<td>
<p>The prior distribution for the seasonal parameter in a SSM model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_seasonal1">prior_seasonal1</code></td>
<td>
<p>The prior distribution for the initial seasonal parameters in a SSM model.
The prior is specified for the first m seasonal parameters, where m is the periodicity of the
defined time series. By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_breg">prior_breg</code></td>
<td>
<p>The prior distribution for the regression coefficient parameters in a
ARMAX model. By default the value is set <code>NULL</code>, then the default student(7,0,1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_prior_df">prior_df</code></td>
<td>
<p>The prior distribution for the degree freedom parameters in a t-student innovations
SSM model. By default the value is set <code>NULL</code>, then the default gamma(2,0.1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
<tr><td><code id="stan_ssm_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>varstan</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a <code>varstan</code> object with the fitted model.
</p>
<p>By  default  the  <code>ssm()</code>  function generates a local level model (or a ets(&quot;A&quot;,&quot;N&quot;,&quot;N&quot;) or
exponential smoothing model from the <span class="pkg">forecast</span> package). If <code>trend</code> is set <code>TRUE</code>,
then  a  local  trend ssm model is defined (a equivalent ets(&quot;A&quot;,&quot;A&quot;,&quot;N&quot;) or Holt model from the
<span class="pkg">forecast</span> package). For damped trend models set <code>damped</code> to <code>TRUE</code>. If <code>seasonal</code>
is  set  to  <code>TRUE</code> a seasonal local level model is defined (a equivalent ets(&quot;A&quot;,&quot;N&quot;,&quot;A&quot;) model
from  the  <span class="pkg">forecast</span> package). For a Holt-Winters method (ets(&quot;A&quot;,&quot;A&quot;,&quot;A&quot;)) set <code>Trend</code> and
<code>seasonal</code> to <code>TRUE</code>.
</p>
<p>When <code>genT</code> option is <code>TRUE</code> a t-student innovations ssm model (see Ardia (2010)) is generated
see Fonseca, et. al (2019) for more details.
</p>
<p>The default priors used in a ssm( ) model are:
</p>

<ul>
<li><p>level ~ normal(0,0.5)
</p>
</li>
<li><p>Trend ~ normal(0,0.5)
</p>
</li>
<li><p>damped~ normal(0,0.5)
</p>
</li>
<li><p>Seasonal ~ normal(0,0.5)
</p>
</li>
<li><p>sigma0 ~ t-student(0,1,7)
</p>
</li>
<li><p>level1 ~ normal(0,1)
</p>
</li>
<li><p>trend1 ~ normal(0,1)
</p>
</li>
<li><p>seasonal1 ~ normal(0,1)
</p>
</li>
<li><p>dfv ~ gamma(2,0.1)
</p>
</li>
<li><p>breg ~ t-student(0,2.5,6)
</p>
</li></ul>

<p>For changing the default prior use the function <code>set_prior()</code>.
</p>


<h3>Value</h3>

<p>A <code>varstan</code> object with the fitted SSM model.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>


<h3>References</h3>

<p>Fonseca, T. and Cequeira, V. and Migon, H. and Torres, C. (2019). The effects of
degrees of freedom estimation in the Asymmetric GARCH model with Student-t
Innovations. <em>arXiv</em> <code>doi: arXiv: 1910.01398</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sarima">Sarima</a></code> <code>auto.arima</code> <code><a href="#topic+set_prior">set_prior</a></code> <code><a href="#topic+garch">garch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Declaring a local level model for the ipc data.
 sf1 = stan_ssm(ipc,iter = 500,chains = 1)

 # Declaring a Holt model for the ipc data.
 sf2 = stan_ssm(ipc,trend = TRUE,damped = TRUE,iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='stan_SVM'>Fitting a Stochastic volatility model</h2><span id='topic+stan_SVM'></span>

<h3>Description</h3>

<p>Fitting a Stochastic Volatility model (SVM) in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_SVM(
  ts,
  arma = c(0, 0),
  xreg = NULL,
  chains = 4,
  iter = 2000,
  warmup = floor(iter/2),
  adapt.delta = 0.9,
  tree.depth = 10,
  stepwise = TRUE,
  prior_mu0 = NULL,
  prior_sigma0 = NULL,
  prior_ar = NULL,
  prior_ma = NULL,
  prior_alpha = NULL,
  prior_beta = NULL,
  prior_breg = NULL,
  series.name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_SVM_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_arma">arma</code></td>
<td>
<p>Optionally, a specification of the  ARMA model,same
as order parameter: the two components (p, q) are the AR order,and
the  MA order.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for step-size
adaptation, so warm-up samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_stepwise">stepwise</code></td>
<td>
<p>If TRUE, will do stepwise selection (faster). Otherwise, it searches
over all models. Non-stepwise selection can be very slow, especially for seasonal models.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_prior_mu0">prior_mu0</code></td>
<td>
<p>The prior distribution for the location parameter in an SVM model. By default
the value is set <code>NULL</code>, then the default normal(0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_prior_sigma0">prior_sigma0</code></td>
<td>
<p>The prior distribution for the scale parameter in an SVM model. By default
the value is set <code>NULL</code>, then the default student(7,0,1) prior is used.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_prior_ar">prior_ar</code></td>
<td>
<p>The prior distribution for the auto-regressive parameters in an ARMA model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_prior_ma">prior_ma</code></td>
<td>
<p>The prior distribution for the moving average parameters in an ARMA model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors are used.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_prior_alpha">prior_alpha</code></td>
<td>
<p>The prior distribution for the arch parameters in a GARCH model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_prior_beta">prior_beta</code></td>
<td>
<p>The prior distribution for the GARCH parameters in a GARCH model.
By default the value is set <code>NULL</code>, then the default normal(0,0.5) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_prior_breg">prior_breg</code></td>
<td>
<p>The prior distribution for the regression coefficient parameters in a
ARIMAX model. By default the value is set <code>NULL</code>, then the default student(7,0,1) priors
are used.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the series names.</p>
</td></tr>
<tr><td><code id="stan_SVM_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>varstan</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a <code>varstan</code> object with the fitted model.
</p>


<h3>Value</h3>

<p>A <code>varstan</code> object with the fitted SVM model.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>References</h3>

<p>Sangjoon,K. and Shephard, N. and Chib.S (1998). Stochastic Volatility: Likelihood
Inference and Comparison with ARCH Models. <em>Review of Economic Studies</em>.
65(1), 361-93. <code>url: https://www.jstor.org/stable/2566931</code>.
</p>
<p>Tsay, R (2010). Analysis of Financial Time Series.
<em>Wiley-Interscience</em>. 978-0470414354, second edition.
</p>
<p>Shumway, R.H. and Stoffer, D.S. (2010).Time Series Analysis and Its
Applications: With R Examples. <em>Springer Texts in Statistics</em>.
isbn: 9781441978646. First edition.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+garch">garch</a></code> <code><a href="#topic+set_prior">set_prior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Declares a SVM model for the IPC data
 sf1 = stan_SVM(ipc,arma = c(1,1),iter = 500,chains = 1)


</code></pre>

<hr>
<h2 id='student'>Define a t student prior distribution</h2><span id='topic+student'></span>

<h3>Description</h3>

<p>student(mu,sd)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>student(mu = 0, sd = 1, df = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="student_+3A_mu">mu</code></td>
<td>
<p>the location parameter mu</p>
</td></tr>
<tr><td><code id="student_+3A_sd">sd</code></td>
<td>
<p>the standard deviation parameter sigma</p>
</td></tr>
<tr><td><code id="student_+3A_df">df</code></td>
<td>
<p>the degree freedom parameter df</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a t student prior distribution using the hyper parameters
mu, sigma and df as degree freedom, by default a standard t-student(0,1,5)
distribution with 5 degree freedom is return.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='summary.varstan'>Summary method for a varstan object</h2><span id='topic+summary.varstan'></span>

<h3>Description</h3>

<p>Summaries of parameter estimates and MCMC convergence diagnostics
(Monte Carlo error, effective sample size, Rhat).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
summary(object, robust = FALSE, prob = 0.9, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.varstan_+3A_object">object</code></td>
<td>
<p>A varstan object.</p>
</td></tr>
<tr><td><code id="summary.varstan_+3A_robust">robust</code></td>
<td>
<p>A boolean value, if its <code>TRUE</code> it returns the median of the posterior distribution,
And if its <code>FALSE</code> it returns the mean, by default is the <code>FALSE</code> value</p>
</td></tr>
<tr><td><code id="summary.varstan_+3A_prob">prob</code></td>
<td>
<p>A number <code class="reqn">p \in (0,1)</code> indicating the desired
probability mass to include in the intervals. The default is to report
<code class="reqn">90</code>% intervals (<code>prob=0.9</code>) rather than the traditionally used
<code class="reqn">95</code>%.</p>
</td></tr>
<tr><td><code id="summary.varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>summary</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with the posterior mean, standard error, credible intervals, effective sample
size (ess),and Rhat for all the model parameters in a varstan model, if <code>robust</code> is <code>TRUE</code>
then the posterior mean and standard error, are replaced by the posterior mean and MAD.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros.
</p>

<hr>
<h2 id='SVM'>Constructor of an Stochastic volatility model object</h2><span id='topic+SVM'></span>

<h3>Description</h3>

<p>Constructor of the Stochastic Volatility model (SVM) for Bayesian estimation in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SVM(ts,arma = c(0,0),xreg = NULL,series.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SVM_+3A_ts">ts</code></td>
<td>
<p>a numeric or ts object with the univariate time series.</p>
</td></tr>
<tr><td><code id="SVM_+3A_arma">arma</code></td>
<td>
<p>Optionally, a specification of the  ARMA model,same
as order parameter: the two components (p, q) are the AR order,and
the  MA order.</p>
</td></tr>
<tr><td><code id="SVM_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a numerical matrix of external regressors,
which must have the same number of rows as ts. It should not be a data frame.</p>
</td></tr>
<tr><td><code id="SVM_+3A_series.name">series.name</code></td>
<td>
<p>an optional string vector with the time series names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>


<h3>Value</h3>

<p>The function returns a list with the data for running <code>stan()</code> function of
<span class="pkg">rstan</span> package.
</p>


<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>References</h3>

<p>Sangjoon,K. and Shephard, N. and Chib.S (1998). Stochastic Volatility: Likelihood
Inference and Comparison with ARCH Models. <em>Review of Economic Studies</em>.
65(1), 361-93. <code>url: https://www.jstor.org/stable/2566931</code>.
</p>
<p>Tsay, R (2010). Analysis of Financial Time Series.
<em>Wiley-Interscience</em>. 978-0470414354, second edition.
</p>
<p>Shumway, R.H. and Stoffer, D.S. (2010).Time Series Analysis and Its
Applications: With R Examples. <em>Springer Texts in Statistics</em>.
isbn: 9781441978646. First edition.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+garch">garch</a></code> <code><a href="#topic+set_prior">set_prior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Declares a SVM model for the IPC data

model = SVM(ipc,arma = c(1,1))
model

</code></pre>

<hr>
<h2 id='uniform'>Define a uniform prior distribution</h2><span id='topic+uniform'></span>

<h3>Description</h3>

<p>uniform(shape1,shape2)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniform(min = 0, max = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uniform_+3A_min">min</code></td>
<td>
<p>the first form parameter</p>
</td></tr>
<tr><td><code id="uniform_+3A_max">max</code></td>
<td>
<p>the second form parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Define a beta prior distribution using the hyper parameters
min and max, by default a uniform(0,1) distribution is
return.
</p>


<h3>Value</h3>

<p>a numerical vector interpreted as a prior in Stan
</p>

<hr>
<h2 id='varstan'>Constructor of a varstan object.</h2><span id='topic+varstan'></span>

<h3>Description</h3>

<p>Constructor of the varstan object for Bayesian estimation in <span class="pkg">Stan</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varstan(model,chains=4,iter=2000,warmup=floor(iter/2),
               adapt.delta = 0.90,tree.depth =10,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="varstan_+3A_model">model</code></td>
<td>
<p>One of the <code>varstan</code> model classes defined in the package.</p>
</td></tr>
<tr><td><code id="varstan_+3A_chains">chains</code></td>
<td>
<p>An integer of the number of Markov Chains chains to be run,
by default 4 chains are run.</p>
</td></tr>
<tr><td><code id="varstan_+3A_iter">iter</code></td>
<td>
<p>An integer of total iterations per chain including the warm-up,
by default  the number of iterations are 2000.</p>
</td></tr>
<tr><td><code id="varstan_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying number of warm-up (aka burn-in)
iterations. This also specifies the number of iterations used for stepsize
adaptation, so warmup samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="varstan_+3A_adapt.delta">adapt.delta</code></td>
<td>
<p>An optional real value between 0 and 1, the thin of the jumps
in a HMC method. By default is 0.9.</p>
</td></tr>
<tr><td><code id="varstan_+3A_tree.depth">tree.depth</code></td>
<td>
<p>An integer of the maximum  depth of the trees  evaluated
during each iteration. By default is 10.</p>
</td></tr>
<tr><td><code id="varstan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to  <code>rstan()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates one of  the defined models in <span class="pkg">Stan</span> using
the <code>stan()</code> function for sampling.
</p>
<p>This is the principal package's function and the link with <span class="pkg">Stan</span>, this function
fits the posterior distribution of every parameter for a defined model using a
HMC method.
</p>
<p>Every estimated model become a <code>varstan</code> object, with different methods
for summary, diagnostic, forecast and plotting.
</p>
<p><b>Defining priors</b>
</p>
<p>Default priors are chosen to be non or very weakly informative so that their
influence on the results will. However, after getting more familiar with Bayesian
statistics, I recommend you to start thinking about reasonable informative priors
for your model parameters.
</p>
<p>Those can be changed using the function <code>set_prior()</code> before estimating the
model with the <code>varstan()</code> function. For checking the defined priors use
<code>get_prior()</code> and <code>report()</code> functions.
</p>
<p><b>Adjusting the sampling behavior of <span class="pkg">Stan</span></b>
</p>
<p>In addition to choosing the number of iterations, warmup samples, and
chains, users can control the behavior of the NUTS sampler, by using the
<code>control</code> argument. The most important reason to use <code>control</code>
is to decrease (or eliminate at best) the number of divergent transitions
that cause a bias in the obtained posterior samples. Whenever you see the
warning &quot;There were x divergent transitions after warmup.&quot; you should really
think about increasing <code>adapt_delta</code>.  Increasing <code>adapt_delta</code> will
slow down the sampler but will decrease the number of divergent transitions
threatening the validity of your posterior samples.
</p>
<p>Another problem arises when the depth of the tree being evaluated in each iteration
is exceeded. This is less common than having divergent transitions, but may also
bias the posterior samples. When it happens, <span class="pkg">Stan</span> will throw out a warning
suggesting to increase <code>max_treedepth</code>. For more details on the <code>control</code>
argument see <code><a href="rstan.html#topic+stan">stan</a></code>.
</p>


<h3>Value</h3>

<p>a <code>varstan</code> object with the estimated time series model.
</p>
<p>A <code>varstan</code> object is a list that contains the following values:
</p>

<ul>
<li><p>Stanfit a Stanfit object returned by <code>rstan</code> pacakge.
</p>
</li>
<li><p>stan.parmaters The parameters used in Stan for the sample.
</p>
</li>
<li><p>model The defined model for the time series.
</p>
</li>
<li><p>series.name The time series' name.
</p>
</li>
<li><p>ts The provided time series data.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Asael Alonzo Matamoros
</p>


<h3>References</h3>

<p>Carpenter, B. and Gelman, A. and Hoffman, D. and  Lee, D. and Goodrich, B. and
Betancourt, M. and Brubaker, and Guo, L. and Riddell. 2017. Stan: A probabilistic
programming language. <em>Journal of Statistical Software</em> 76(1).
<code>doi: 10.18637/jss.v076.i01</code>.
</p>
<p>Stan Development Team. (2018). Stan Modeling Language Users Guide and Reference Manual,
Version 2.18.0. <code>url: http://mc-stan.org</code>.
</p>
<p>Paul-Christian Buerkner (2017). brms: An R Package for Bayesian Multilevel
Models Using Stan. <em>Journal of Statistical Software</em>, 80(1), 1-28.
<code>doi:10.18637/jss.v080.i01</code>
</p>
<p>Hyndman, R. &amp; Khandakar, Y. (2008). Automatic time series forecasting: the
forecast package for <code>R</code>. <em>Journal of Statistical Software</em>. 26(3),
1-22.<code>doi:	10.18637/jss.v027.i03</code>.
</p>


<h3>See Also</h3>

<p><code><a href="rstan.html#topic+stan">rstan:stan</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 # Fitting a seasonal ARIMA model
 mod1 = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
 fit1 = varstan(mod1,iter = 500,chains = 1)
 fit1

 # Fitting a GARCH(1,1) model
 dat = garch(ipc,order = c(1,1,0))
 fit2 = varstan(dat,iter = 500,chains = 1)
 fit2


</code></pre>

<hr>
<h2 id='waic.varstan'>Widely Applicable Information Criterion (WAIC)</h2><span id='topic+waic.varstan'></span><span id='topic+waic'></span>

<h3>Description</h3>

<p>Compute the widely applicable information criterion (WAIC)
based on the posterior likelihood using the <span class="pkg">loo</span> package.
For more details see <code><a href="loo.html#topic+waic">waic</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varstan'
waic(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="waic.varstan_+3A_x">x</code></td>
<td>
<p>A varstan object</p>
</td></tr>
<tr><td><code id="waic.varstan_+3A_...">...</code></td>
<td>
<p>additional values need in waic methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the <code>loo_compare</code> function of the <span class="pkg">loo</span> package
for more details on model comparisons.
</p>


<h3>Value</h3>

<p>An object of class <code>loo</code>. With the estimates of the
Watanabe-Akaike Information criteria.
</p>


<h3>References</h3>

<p>Vehtari, A., Gelman, A., &amp; Gabry J. (2016). Practical Bayesian model
evaluation using leave-one-out cross-validation and WAIC. <em>In Statistics
and Computing</em>, <code>doi:10.1007/s11222-016-9696-4</code>.
</p>
<p>Gelman, A., Hwang, J., &amp; Vehtari, A. (2014). Understanding predictive
information criteria for Bayesian models. <em>Statistics and Computing</em>.
24, 997-1016.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation
and widely applicable information criterion in singular learning theory.
<em>The Journal of Machine Learning Research</em>. 11, 3571-3594.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 library(astsa)
 model = Sarima(birth,order = c(0,1,2),seasonal = c(1,1,1))
 fit1 = varstan(model,iter = 500,chains = 1)

 waic1 = waic(fit1)
 waic1


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
