<!DOCTYPE html><html><head><title>Help for package robustfa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {robustfa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compute_cov_cor'>
<p>Compute the Robust Covariance and Correlation Matrix of A Numeric Matrix</p></a></li>
<li><a href='#computeScores'>
<p>Compute Factor Scores</p></a></li>
<li><a href='#detail'>
<p>Show Details of an Object</p></a></li>
<li><a href='#Fa-class'><p>Class <code>"Fa"</code></p></a></li>
<li><a href='#FaClassic'>
<p>Classical Factor Analysis</p></a></li>
<li><a href='#FaClassic-class'><p>Class <code>"FaClassic"</code></p></a></li>
<li><a href='#FaCov'>
<p>Robust Factor Analysis</p></a></li>
<li><a href='#FaCov-class'><p>Class <code>"FaCov"</code></p></a></li>
<li><a href='#factorScorePca'>
<p>Factor Analysis by Principal Component Analysis (PCA)</p></a></li>
<li><a href='#factorScorePfa'>
<p>Factor Analysis by Principal Factor Analysis (PFA)</p></a></li>
<li><a href='#FaRobust-class'><p>Class <code>"FaRobust"</code></p></a></li>
<li><a href='#fsOrder'>
<p>Compute the Ordered Factor Scores</p></a></li>
<li><a href='#getCenter-methods'><p>Access Center slot</p></a></li>
<li><a href='#getEigenvalues-methods'><p>Access Eigenvalues slot</p></a></li>
<li><a href='#getFa-methods'><p>Access slots of &quot;Fa&quot;</p></a></li>
<li><a href='#getLoadings-methods'><p>Access Loadings slot</p></a></li>
<li><a href='#getQuan-methods'><p>Access n.obs slot</p></a></li>
<li><a href='#getScores-methods'><p>Access Scores slot</p></a></li>
<li><a href='#getSdev-methods'><p>Access Standard Deviation slot</p></a></li>
<li><a href='#myFaPrint'><p>Show/Print/Display an Object</p></a></li>
<li><a href='#myplotDD'>
<p>Distance-Distance Plot</p></a></li>
<li><a href='#plot-methods'><p>Plot an object of class &quot;Fa&quot;</p></a></li>
<li><a href='#predict-methods'><p>Calculates prediction</p></a></li>
<li><a href='#print-methods'><p>Print/Display an Object</p></a></li>
<li><a href='#robustfa-package'>
<p>An Object Oriented Solution for Robust Factor Analysis</p></a></li>
<li><a href='#stock611'>
<p>The Stocks Data - Year 2001</p></a></li>
<li><a href='#summary-methods'><p>Summary an Object</p></a></li>
<li><a href='#SummaryFa-class'><p>Class <code>"SummaryFa"</code></p></a></li>
<li><a href='#Ulogical-class'><p>Class <code>"Ulogical"</code></p></a></li>
<li><a href='#Unumeric-class'><p>Class <code>"Unumeric"</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Object Oriented Solution for Robust Factor Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Frederic Bertrand <a href="https://orcid.org/0000-0002-0837-8281"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre],
  Ying-Ying Zhang (Robert) [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frederic Bertrand &lt;frederic.bertrand@utt.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Outliers virtually exist in any datasets of any application field. 
  To avoid the impact of outliers, we need to use robust estimators. 
  Classical estimators of multivariate mean and covariance matrix are 
  the sample mean and the sample covariance matrix. Outliers will 
  affect the sample mean and the sample covariance matrix, and thus 
  they will affect the classical factor analysis which depends on 
  the classical estimators (Pison, G., Rousseeuw, P.J., Filzmoser, 
  P. and Croux, C. (2003) &lt;<a href="https://doi.org/10.1016%2FS0047-259X%2802%2900007-6">doi:10.1016/S0047-259X(02)00007-6</a>&gt;). 
  So it is necessary to use the robust estimators of the sample 
  mean and the sample covariance matrix. There are several robust 
  estimators in the literature: Minimum Covariance Determinant estimator, 
  Orthogonalized Gnanadesikan-Kettenring, Minimum Volume Ellipsoid, 
  M, S, and Stahel-Donoho. 
  The most direct way to make multivariate analysis more robust is to replace
  the sample mean and the sample covariance matrix of the classical estimators 
  to robust estimators (Maronna, R.A., Martin, D. and Yohai, V. (2006) 
  &lt;<a href="https://doi.org/10.1002%2F0470010940">doi:10.1002/0470010940</a>&gt;) (Todorov, V. and Filzmoser, P. (2009) 
  &lt;<a href="https://doi.org/10.18637%2Fjss.v032.i03">doi:10.18637/jss.v032.i03</a>&gt;), which is our choice of robust factor
  analysis. We created an object oriented solution for robust factor 
  analysis based on new S4 classes. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>rrcov, R (&ge; 2.15.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats4, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>grid, lattice, cluster, mclust, MASS, ellipse, knitr,
rmarkdown</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-16 08:04:40 UTC; fbertran</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-16 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='compute_cov_cor'>
Compute the Robust Covariance and Correlation Matrix of A Numeric Matrix
</h2><span id='topic+compute_cov_cor'></span>

<h3>Description</h3>

<p>Compute the robust covariance and correlation matrix of a numeric matrix. The function is used to check whether S_r != S_r_tilda and R_r == R_r_tilda?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_cov_cor(x, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_cov_cor_+3A_x">x</code></td>
<td>

<p>A numeric matrix or an object that can be coerced to a numeric matrix.
</p>
</td></tr>
<tr><td><code id="compute_cov_cor_+3A_control">control</code></td>
<td>

<p>A control object (S4) for one of the available control classes, e.g. <code>CovControlMcd-class</code>, <code>CovControlOgk-class</code>, <code>CovControlSest-class</code>, etc., containing estimation options. The class of this object defines which estimator will be used. Alternatively a character string can be specified which names the estimator - one of auto, sde, mcd, ogk, m, mve, sfast, surreal, bisquare, rocke. If &quot;auto&quot; is specified or the argument is missing, the function will select the estimator.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>S_r</code></td>
<td>
<p>The robust covariance matrix of cov_x.</p>
</td></tr>
<tr><td><code>S_r_tilda</code></td>
<td>
<p>The robust covariance matrix of cov_scale_x.</p>
</td></tr>
<tr><td><code>R_r</code></td>
<td>
<p>The robust correlation matrix of cov_x.</p>
</td></tr>
<tr><td><code>R_r_tilda</code></td>
<td>
<p>The robust correlation matrix of cov_scale_x.</p>
</td></tr>
</table>
<p>cov_x = rrcov::CovRobust(x = x, control = control)
cov_scale_x = rrcov::CovRobust(x = scale(x), control = control)
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hbk")
hbk.x = hbk[,1:3]

compute_cov_cor(x = hbk.x, control = "mcd")

</code></pre>

<hr>
<h2 id='computeScores'>
Compute Factor Scores
</h2><span id='topic+computeScores'></span>

<h3>Description</h3>

<p>Compute factor scores on the result of factor analysis method, the method is one of &quot;mle&quot;, &quot;pca&quot;, and &quot;pfa&quot;. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeScores(out, x = data, covmat = covmat, cor = cor, scoresMethod = scoresMethod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeScores_+3A_out">out</code></td>
<td>

<p>The result of factorScorePca(), factorScorePfa(), or factanal(). It is a list.
</p>
</td></tr>
<tr><td><code id="computeScores_+3A_x">x</code></td>
<td>

<p>A numeric matrix.
</p>
</td></tr>
<tr><td><code id="computeScores_+3A_covmat">covmat</code></td>
<td>

<p>A list with components: cov, center, and n.obs.
</p>
</td></tr>
<tr><td><code id="computeScores_+3A_cor">cor</code></td>
<td>

<p>A logical value indicating whether the calculation should use the covariance matrix (<code>cor = FALSE</code>) or the correlation matrix (<code>cor = TRUE</code>).
</p>
</td></tr>
<tr><td><code id="computeScores_+3A_scoresmethod">scoresMethod</code></td>
<td>

<p>Type of scores to produce, if any. The default is <code>"none"</code>, <code>"regression"</code> gives Thompson's scores, <code>"Bartlett"</code> gives Bartlett's weighted least-squares scores.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a list. Except for the components of <code>out</code>, it also has components:
</p>
<table>
<tr><td><code>scoringCoef</code></td>
<td>
<p>The scoring coefficients.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>The matrix of scores.</p>
</td></tr>
<tr><td><code>meanF</code></td>
<td>
<p>The sample mean of the scores.</p>
</td></tr>
<tr><td><code>corF</code></td>
<td>
<p>The sample correlation matrix of the scores.</p>
</td></tr>
<tr><td><code>eigenvalues</code></td>
<td>
<p>The eigenvalues of the running matrix.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>The covariance matrix.</p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>
<p>The correlation matrix.</p>
</td></tr>
<tr><td><code>usedMatrix</code></td>
<td>
<p>The used matrix (running matrix) to compute <code>scoringCoef</code> etc..</p>
</td></tr>
<tr><td><code>reducedCorrelation</code></td>
<td>
<p>NULL. The reduced correlation matrix, reducedCorrelation is calculated in factorScorePfa.R.</p>
</td></tr>
</table>
<p>scoringCoef = F = meanF = corF = NULL if <code>scoresMethod = "none"</code>.
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("stock611")
stock604 = stock611[-c(92,2,337,338,379,539,79), ]
data = as.matrix(stock604[, 3:12])

factors = 2
cor = TRUE
scoresMethod = "regression" 

covx = rrcov::Cov(data)
covmat = list(cov = rrcov::getCov(covx), center = rrcov::getCenter(covx), n.obs = covx@n.obs)

out = stats::factanal(factors = factors, covmat = covmat)

out = computeScores(out, x = data, covmat = covmat, cor = cor, scoresMethod = scoresMethod)
out

</code></pre>

<hr>
<h2 id='detail'>
Show Details of an Object
</h2><span id='topic+detail'></span>

<h3>Description</h3>

<p>Show details of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detail(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detail_+3A_x">x</code></td>
<td>

<p>Any <code>R</code> object to be tested.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The argument <code>x</code>.</p>
</td></tr>
<tr><td><code>isS4</code></td>
<td>
<p>Logical, indicates whether <code>x</code> is an S4 object.</p>
</td></tr>
<tr><td><code>isObject</code></td>
<td>
<p>Logical, indicates whether <code>x</code> is an object, i.e., with a class attribute.</p>
</td></tr>
<tr><td><code>class</code></td>
<td>
<p>The class of <code>x</code>.</p>
</td></tr>
<tr><td><code>attributes</code></td>
<td>
<p>The attributes of <code>x</code>. Usually <code>result$attributes</code> is also a list.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+isS4">isS4</a></code>, <code><a href="base.html#topic+is.object">is.object</a></code>, <code><a href="base.html#topic+class">class</a></code>, <code><a href="base.html#topic+attributes">attributes</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stock611)
detail(stock611)

facovRegOgk=FaCov(x=scale(stock611[,3:12]), factors=3, cov.control = rrcov::CovControlOgk(), 
scoresMethod = "regression"); facovRegOgk
detail(facovRegOgk)

</code></pre>

<hr>
<h2 id='Fa-class'>Class <code>"Fa"</code></h2><span id='topic+Fa-class'></span>

<h3>Description</h3>

<p>Class <code>"Fa"</code> is a virtual base class for all classical and robust FA classes. <code>"Fa"</code> searves as a base class for deriving all other classes representing the results of the classical and robust Factor Analysis methods.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code> an unevaluated function call. </p>
</dd>
<dt><code>converged</code>:</dt><dd><p>Object of class <code>"Ulogical"</code> a logical character indicates whether the iterations converged. </p>
</dd>
<dt><code>loadings</code>:</dt><dd><p>Object of class <code>"matrix"</code> the matrix of variable loadings. </p>
</dd>
<dt><code>communality</code>:</dt><dd><p>Object of class <code>"Uvector"</code> the communality. </p>
</dd>
<dt><code>uniquenesses</code>:</dt><dd><p>Object of class <code>"vector"</code> the uniquenesses computed. </p>
</dd>
<dt><code>cor</code>:</dt><dd><p>Object of class <code>"Ulogical"</code> A logical value indicating whether the calculation should use the covariance matrix (<code>cor = FALSE</code>) or the correlation matrix (<code>cor = TRUE</code>). </p>
</dd>
<dt><code>covariance</code>:</dt><dd><p>Object of class <code>"matrix"</code> The robust/classical covariance matrix. </p>
</dd>
<dt><code>correlation</code>:</dt><dd><p>Object of class <code>"matrix"</code> The robust/classical correlation matrix. </p>
</dd>
<dt><code>usedMatrix</code>:</dt><dd><p>Object of class <code>"matrix"</code> The used matrix (running matrix). It may be the covariance or correlation matrix according to the value of <code>cor</code>. </p>
</dd>
<dt><code>reducedCorrelation</code>:</dt><dd><p>Object of class <code>"Umatrix"</code> The last reduced correlation matrix. reducedCorrelation is only calculated in factorScorePfa.R. </p>
</dd>
<dt><code>criteria</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The results of the optimization: the value of the negative log-likelihood and information on the iterations used. </p>
</dd>
<dt><code>factors</code>:</dt><dd><p>Object of class <code>"numeric"</code> the number of factors. </p>
</dd>
<dt><code>dof</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The number of degrees of freedom of the factor analysis model. </p>
</dd>
<dt><code>method</code>:</dt><dd><p>Object of class <code>"character"</code>. The method: one of &quot;mle&quot;, &quot;pca&quot;, and &quot;pfa&quot;. </p>
</dd>
<dt><code>scores</code>:</dt><dd><p>Object of class <code>"Umatrix"</code>. If requested, a matrix of scores. </p>
</dd>
<dt><code>scoresMethod</code>:</dt><dd><p>Object of class <code>"character"</code>. The scores method: one of &quot;none&quot;, &quot;regression&quot;, and &quot;Bartlett&quot;. </p>
</dd>
<dt><code>scoringCoef</code>:</dt><dd><p>Object of class <code>"Umatrix"</code> the matrix of scoring coefficients. </p>
</dd>
<dt><code>meanF</code>:</dt><dd><p>Object of class <code>"Uvector"</code> the column means of scores. </p>
</dd>
<dt><code>corF</code>:</dt><dd><p>Object of class <code>"Umatrix"</code> the correlation matrix of the scores. </p>
</dd>
<dt><code>STATISTIC</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The significance-test statistic, if it can be computed. </p>
</dd>
<dt><code>PVAL</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The significance-test P value, if it can be computed. </p>
</dd>
<dt><code>n.obs</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The number of observations. </p>
</dd>
<dt><code>center</code>:</dt><dd><p>Object of class <code>"Uvector"</code>. The center of the data. </p>
</dd>
<dt><code>eigenvalues</code>:</dt><dd><p>Object of class <code>"vector"</code> the eigenvalues. </p>
</dd>
<dt><code>cov.control</code>:</dt><dd><p>Object of class <code>"UCovControl"</code>. Record the cov control method. </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>getCenter</dt><dd><p><code>signature(obj = "Fa")</code>: center of the data </p>
</dd>
<dt>getEigenvalues</dt><dd><p><code>signature(obj = "Fa")</code>: the eigenvalues of the covariance/correlation matrix </p>
</dd>
<dt>getFa</dt><dd><p><code>signature(obj = "Fa")</code>: returns an S3 list of class <code>fa</code> for compatibility with the function factanal(). Thus the standard  screeplot() can be used. </p>
</dd>
<dt>getLoadings</dt><dd><p><code>signature(obj = "Fa")</code>: returns the matrix loadings </p>
</dd>
<dt>getQuan</dt><dd><p><code>signature(obj = "Fa")</code>: returns the number of observations used in the computation, i.e., n.obs </p>
</dd>
<dt>getScores</dt><dd><p><code>signature(obj = "Fa")</code>: if requested, a matrix of scores. </p>
</dd>
<dt>getSdev</dt><dd><p><code>signature(obj = "Fa")</code>: returns the standard deviations of the factor analysis, i.e., the square roots of the eigenvalues of the covariance/correlation matrix </p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "Fa", y = "missing")</code>: produces a scatterplot of the factor scores (if which = &quot;factorScore&quot;) or shows the eigenvalues plot (if which = &quot;screeplot&quot;) </p>
</dd>    
<dt>predict</dt><dd><p><code>signature(object = "Fa")</code>: calculates prediction using the results in object. The newdata argument is an optional data frame or matrix in which to look for variables with which to predict. If newdata is omitted, the scores are used. </p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "Fa")</code>: prints the results. obj = print(obj)</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "Fa")</code>: produce result summaries of an object of class &quot;Fa&quot;. </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Bartlett, M. S. (1937) The statistical conception of mental factors. <em>British Journal of Psychology</em>, <b>28</b>, 97&ndash;104. 
</p>
<p>Bartlett, M. S. (1938) Methods of estimating mental factors. <em>Nature</em>, <b>141</b>, 609&ndash;610. 
</p>
<p>Joreskog, K. G. (1963) <em>Statistical Estimation in Factor Analysis</em>. Almqvist and Wicksell. 
</p>
<p>Lawley, D. N. and Maxwell, A. E. (1971) <em>Factor Analysis as a Statistical Method</em>. Second edition. Butterworths. 
</p>
<p>Thomson, G. H. (1951) <em>The Factorial Analysis of Human Ability</em>. London University Press. 
</p>
<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>
<p>Zhang, Y. Y. (2014), Robust Factor Analysis and Its Applications in the CSI 100 Index, <em>Open Journal of Social Sciences</em> 2(07):12-18, <a href="https://doi.org/10.4236/jss.2014.27003">doi:10.4236/jss.2014.27003</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FaClassic-class">FaClassic-class</a></code>, <code><a href="#topic+FaCov-class">FaCov-class</a></code>, <code><a href="#topic+FaRobust-class">FaRobust-class</a></code>, <code><a href="#topic+Fa-class">Fa-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("Fa")
</code></pre>

<hr>
<h2 id='FaClassic'>
Classical Factor Analysis
</h2><span id='topic+FaClassic'></span><span id='topic+FaClassic.formula'></span><span id='topic+FaClassic.default'></span>

<h3>Description</h3>

<p>Performs a classical factor analysis and returns the results as an object of class <code>"FaClassic"</code> (a.k.a. constructor).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FaClassic(x, ...)
## S3 method for class 'formula'
FaClassic(formula, data = NULL, factors = 2, cor = FALSE, method = "mle", 
scoresMethod = "none", ...)
## Default S3 method:
FaClassic(x, factors = 2, cor = FALSE, method = c("mle", "pca", "pfa"), 
scoresMethod = c("none", "regression", "Bartlett"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FaClassic_+3A_x">x</code></td>
<td>
<p>A formula or a numeric matrix or an object that can be coerced to a numeric matrix.</p>
</td></tr>
<tr><td><code id="FaClassic_+3A_...">...</code></td>
<td>
<p>Arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="FaClassic_+3A_formula">formula</code></td>
<td>
<p>A formula with no response variable, referring only to numeric variables.</p>
</td></tr>
<tr><td><code id="FaClassic_+3A_data">data</code></td>
<td>
<p>An optional data frame (or similar: see <code><a href="stats.html#topic+model.frame">model.frame</a></code>) containing the variables in the <code>formula</code>.</p>
</td></tr>
<tr><td><code id="FaClassic_+3A_factors">factors</code></td>
<td>
<p>The number of factors to be fitted.</p>
</td></tr>
<tr><td><code id="FaClassic_+3A_cor">cor</code></td>
<td>
<p>A logical value indicating whether the calculation should use the covariance matrix (<code>cor = FALSE</code>) or the correlation matrix (<code>cor = TRUE</code>).
</p>
</td></tr>
<tr><td><code id="FaClassic_+3A_method">method</code></td>
<td>
<p>The method of factor analysis, one of &quot;mle&quot; (the default), &quot;pca&quot;, and &quot;pfa&quot;.</p>
</td></tr>
<tr><td><code id="FaClassic_+3A_scoresmethod">scoresMethod</code></td>
<td>
<p>Type of scores to produce, if any. The default is <code>"none"</code>, <code>"regression"</code> gives Thompson's scores, <code>"Bartlett"</code> gives Bartlett's weighted least-squares scores.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 object of class <code><a href="#topic+FaClassic-class">FaClassic-class</a></code> which is a subclass of the virtual class <code><a href="#topic+Fa-class">Fa-class</a></code>.    
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FaClassic-class">FaClassic-class</a></code>, <code><a href="#topic+FaCov-class">FaCov-class</a></code>, <code><a href="#topic+FaRobust-class">FaRobust-class</a></code>, <code><a href="#topic+Fa-class">Fa-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("hbk")
hbk.x = hbk[,1:3] 

## faClassicPcaReg uses the default method
faClassicPcaReg = FaClassic(x = hbk.x, factors = 2, method = "pca",
scoresMethod = "regression"); faClassicPcaReg
summary(faClassicPcaReg)

## faClassicForPcaReg uses the formula interface
## faClassicForPcaReg = faClassicPcaReg
faClassicForPcaReg = FaClassic(~., data=as.data.frame(hbk.x), factors = 2, 
method = "pca", scoresMethod = "regression"); faClassicForPcaReg
summary(faClassicForPcaReg)

</code></pre>

<hr>
<h2 id='FaClassic-class'>Class <code>"FaClassic"</code></h2><span id='topic+FaClassic-class'></span>

<h3>Description</h3>

<p>Contains the results of a classical Factor Analysis
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("FaClassic", ...)</code>. But the usual way of creating <code>FaClassic</code> objects is a call to the function <code>FaClassic</code> which serves as a constructor.
</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code> an unevaluated function call</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>Object of class <code>"Ulogical"</code> a logical character indicates whether the iterations converged </p>
</dd>
<dt><code>loadings</code>:</dt><dd><p>Object of class <code>"matrix"</code> the matrix of variable loadings </p>
</dd>
<dt><code>uniquenesses</code>:</dt><dd><p>Object of class <code>"vector"</code> the uniquenesses computed </p>
</dd>
<dt><code>covariance</code>:</dt><dd><p>Object of class <code>"matrix"</code> the covariance matrix </p>
</dd>
<dt><code>correlation</code>:</dt><dd><p>Object of class <code>"matrix"</code> the correlation matrix </p>
</dd>
<dt><code>usedMatrix</code>:</dt><dd><p>Object of class <code>"matrix"</code> the used matrix (running matrix) </p>
</dd>
<dt><code>criteria</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The results of the optimization: the value of the negative log-likelihood and information on the iterations used. </p>
</dd>
<dt><code>factors</code>:</dt><dd><p>Object of class <code>"numeric"</code> the number of factors </p>
</dd>
<dt><code>dof</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The number of degrees of freedom of the factor analysis model. </p>
</dd>
<dt><code>method</code>:</dt><dd><p>Object of class <code>"character"</code>. The method: one of &quot;mle&quot;, &quot;pca&quot;, and &quot;pfa&quot;.</p>
</dd>
<dt><code>scores</code>:</dt><dd><p>Object of class <code>"Umatrix"</code>. If requested, a matrix of scores. </p>
</dd>
<dt><code>scoresMethod</code>:</dt><dd><p>Object of class <code>"character"</code>. The scores method: one of &quot;none&quot;, &quot;regression&quot;, and &quot;Bartlett&quot;. </p>
</dd>
<dt><code>STATISTIC</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The significance-test statistic, if it can be computed. </p>
</dd>
<dt><code>PVAL</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The significance-test P value, if it can be computed. </p>
</dd>
<dt><code>n.obs</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The number of observations if available. </p>
</dd>
<dt><code>center</code>:</dt><dd><p>Object of class <code>"Uvector"</code>. The center of the data. </p>
</dd>
<dt><code>eigenvalues</code>:</dt><dd><p>Object of class <code>"vector"</code> the eigenvalues </p>
</dd>
<dt><code>cov.control</code>:</dt><dd><p>Object of class <code>"UCovControl"</code>. Record the cov control method. </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+Fa-class">Fa</a>"</code>, directly.
</p>


<h3>Methods</h3>

<p>No methods defined with class &quot;FaClassic&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FaClassic-class">FaClassic-class</a></code>, <code><a href="#topic+FaCov-class">FaCov-class</a></code>, <code><a href="#topic+FaRobust-class">FaRobust-class</a></code>, <code><a href="#topic+Fa-class">Fa-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("FaClassic")
</code></pre>

<hr>
<h2 id='FaCov'>
Robust Factor Analysis
</h2><span id='topic+FaCov'></span><span id='topic+FaCov.formula'></span><span id='topic+FaCov.default'></span>

<h3>Description</h3>

<p>Robust factor analysis are obtained by replacing the classical covariance matrix 
by a robust covariance estimator. This can be one of the available estimators in <code>rrcov</code>, i.e., MCD, OGK, M, S, SDE, or MVE estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FaCov(x, ...)
## S3 method for class 'formula'
FaCov(formula, data = NULL, factors = 2, cor = FALSE, method = "mle", 
scoresMethod = "none", ...)
## Default S3 method:
FaCov(x, factors = 2, cor = FALSE, cov.control = rrcov::CovControlMcd(), 
method = c("mle", "pca", "pfa"), 
scoresMethod = c("none", "regression", "Bartlett"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FaCov_+3A_x">x</code></td>
<td>
<p>A formula or a numeric matrix or an object that can be coerced to a numeric matrix.</p>
</td></tr>
<tr><td><code id="FaCov_+3A_...">...</code></td>
<td>
<p>Arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="FaCov_+3A_formula">formula</code></td>
<td>
<p>A formula with no response variable, referring only to numeric variables.</p>
</td></tr>
<tr><td><code id="FaCov_+3A_data">data</code></td>
<td>
<p>An optional data frame (or similar: see <code><a href="stats.html#topic+model.frame">model.frame</a></code>) containing the variables in the <code>formula</code>.</p>
</td></tr>
<tr><td><code id="FaCov_+3A_factors">factors</code></td>
<td>
<p>The number of factors to be fitted.</p>
</td></tr>
<tr><td><code id="FaCov_+3A_cor">cor</code></td>
<td>
<p>A logical value indicating whether the calculation should use the covariance matrix (<code>cor = FALSE</code>) or the correlation matrix (<code>cor = TRUE</code>).
</p>
</td></tr>
<tr><td><code id="FaCov_+3A_method">method</code></td>
<td>
<p>The method of factor analysis, one of &quot;mle&quot; (the default), &quot;pca&quot;, and &quot;pfa&quot;.</p>
</td></tr>
<tr><td><code id="FaCov_+3A_scoresmethod">scoresMethod</code></td>
<td>
<p>Type of scores to produce, if any. The default is <code>"none"</code>, <code>"regression"</code> gives Thompson's scores, <code>"Bartlett"</code> gives Bartlett's weighted least-squares scores.</p>
</td></tr>
<tr><td><code id="FaCov_+3A_cov.control">cov.control</code></td>
<td>
<p>Specifies which covariance estimator to use by providing a <code>CovControl-class</code> object. The default is <code>CovControlMcd-class</code> which will indirectly call <code>CovMcd</code>. If <code>cov.control=NULL</code> is specified, the classical estimates will be used by calling <code>CovClassic</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>FaCov</code>, serving as a constructor for objects of class <code><a href="#topic+FaCov-class">FaCov-class</a></code> is a generic function with &quot;formula&quot; and &quot;default&quot; methods. 
</p>


<h3>Value</h3>

<p>An S4 object of class <code><a href="#topic+FaCov-class">FaCov-class</a></code> which is a subclass of the virtual class <code><a href="#topic+Fa-class">Fa-class</a></code>.    
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FaClassic-class">FaClassic-class</a></code>, <code><a href="#topic+FaCov-class">FaCov-class</a></code>, <code><a href="#topic+FaRobust-class">FaRobust-class</a></code>, <code><a href="#topic+Fa-class">Fa-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("hbk")
hbk.x = hbk[,1:3] 

##
## faCovPcaRegMcd is obtained from FaCov.default
##
faCovPcaRegMcd = FaCov(x = hbk.x, factors = 2, method = "pca",
scoresMethod = "regression", cov.control = rrcov::CovControlMcd()); faCovPcaRegMcd

##
## In fact, it is equivalent to use FaCov.formula
## faCovForPcaRegMcd = faCovPcaRegMcd
##
faCovForPcaRegMcd = FaCov(~., data = as.data.frame(hbk.x), 
factors = 2, method = "pca", scoresMethod = "regression", 
cov.control = rrcov::CovControlMcd()); faCovForPcaRegMcd

</code></pre>

<hr>
<h2 id='FaCov-class'>Class <code>"FaCov"</code></h2><span id='topic+FaCov-class'></span>

<h3>Description</h3>

<p>Robust FA based on a robust covariance matrix. Robust FA are obtained by replacing the classical covariance matrix by a robust covariance estimator. This can be one of the available in <code>rrcov</code> estimators, i.e., MCD, OGK, M, S, SDE, or MVE estimator.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("FaCov", ...)</code>.
But the usual way of creating <code>FaCov</code> objects is a call to the function <code>FaCov</code> which serves as a constructor.
</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code> an unevaluated function call</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>Object of class <code>"Ulogical"</code> a logical character indicates whether the iterations converged </p>
</dd>
<dt><code>loadings</code>:</dt><dd><p>Object of class <code>"matrix"</code> the matrix of variable loadings </p>
</dd>
<dt><code>uniquenesses</code>:</dt><dd><p>Object of class <code>"vector"</code> the uniquenesses computed </p>
</dd>
<dt><code>covariance</code>:</dt><dd><p>Object of class <code>"matrix"</code> the covariance matrix </p>
</dd>
<dt><code>correlation</code>:</dt><dd><p>Object of class <code>"matrix"</code> the correlation matrix </p>
</dd>
<dt><code>usedMatrix</code>:</dt><dd><p>Object of class <code>"matrix"</code> the used matrix (running matrix) </p>
</dd>
<dt><code>criteria</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The results of the optimization: the value of the negative log-likelihood and information on the iterations used. </p>
</dd>
<dt><code>factors</code>:</dt><dd><p>Object of class <code>"numeric"</code> the number of factors </p>
</dd>
<dt><code>dof</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The number of degrees of freedom of the factor analysis model. </p>
</dd>
<dt><code>method</code>:</dt><dd><p>Object of class <code>"character"</code>. The method: one of &quot;mle&quot;, &quot;pca&quot;, and &quot;pfa&quot;.</p>
</dd>
<dt><code>scores</code>:</dt><dd><p>Object of class <code>"Umatrix"</code>. If requested, a matrix of scores. </p>
</dd>
<dt><code>scoresMethod</code>:</dt><dd><p>Object of class <code>"character"</code>. The scores method: one of &quot;none&quot;, &quot;regression&quot;, and &quot;Bartlett&quot;. </p>
</dd>
<dt><code>STATISTIC</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The significance-test statistic, if it can be computed. </p>
</dd>
<dt><code>PVAL</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The significance-test P value, if it can be computed. </p>
</dd>
<dt><code>n.obs</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The number of observations if available. </p>
</dd>
<dt><code>center</code>:</dt><dd><p>Object of class <code>"Uvector"</code>. The center of the data. </p>
</dd>
<dt><code>eigenvalues</code>:</dt><dd><p>Object of class <code>"vector"</code> the eigenvalues </p>
</dd>
<dt><code>cov.control</code>:</dt><dd><p>Object of class <code>"UCovControl"</code>. Record the cov control method. </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+FaRobust-class">FaRobust</a>"</code>, directly.
Class <code>"<a href="#topic+Fa-class">Fa</a>"</code>, by class &quot;FaRobust&quot;, distance 2.
</p>


<h3>Methods</h3>

<p>No methods defined with class &quot;FaCov&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FaClassic-class">FaClassic-class</a></code>, <code><a href="#topic+FaCov-class">FaCov-class</a></code>, <code><a href="#topic+FaRobust-class">FaRobust-class</a></code>, <code><a href="#topic+Fa-class">Fa-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("FaCov")
</code></pre>

<hr>
<h2 id='factorScorePca'>
Factor Analysis by Principal Component Analysis (PCA)
</h2><span id='topic+factorScorePca'></span>

<h3>Description</h3>

<p>Perform principal component factor analysis on a covariance matrix or data matrix. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factorScorePca(x, factors = 2, covmat = NULL, cor = FALSE, 
rotation = c("varimax", "none"), 
scoresMethod = c("none", "regression", "Bartlett"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="factorScorePca_+3A_x">x</code></td>
<td>

<p>A numeric matrix or an object that can be coerced to a numeric matrix.
</p>
</td></tr>
<tr><td><code id="factorScorePca_+3A_factors">factors</code></td>
<td>

<p>The number of factors to be fitted.
</p>
</td></tr>
<tr><td><code id="factorScorePca_+3A_covmat">covmat</code></td>
<td>

<p>A covariance matrix, or a covariance list as returned by <code><a href="stats.html#topic+cov.wt">cov.wt</a></code>. Of course, correlation matrices are covariance matrices.
</p>
</td></tr>
<tr><td><code id="factorScorePca_+3A_cor">cor</code></td>
<td>

<p>A logical value indicating whether the calculation should use the covariance matrix (<code>cor = FALSE</code>) or the correlation matrix (<code>cor = TRUE</code>).
</p>
</td></tr>
<tr><td><code id="factorScorePca_+3A_rotation">rotation</code></td>
<td>

<p>character. &quot;none&quot; or &quot;varimax&quot;: it will be called with first argument the loadings matrix, and should return a list with component <code>loadings</code> giving the rotated loadings, or just the rotated loadings.
</p>
</td></tr>
<tr><td><code id="factorScorePca_+3A_scoresmethod">scoresMethod</code></td>
<td>

<p>Type of scores to produce, if any. The default is <code>"none"</code>, <code>"regression"</code> gives Thompson's scores, <code>"Bartlett"</code> gives Bartlett's weighted least-squares scores.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Other feasible usages are:
</p>
<p><code>factorScorePca(factors, covmat)</code>
</p>
<p><code>factorScorePca(x, factors, rotation, scoresMethod)</code>
</p>
<p>If <code>x</code> is missing, then the following components of the result will be NULL: scores, ScoringCoef, meanF, corF, and n.obs.
</p>


<h3>Value</h3>

<p>An object of class <code>"factorScorePca"</code> with components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>A matrix of loadings, one column for each factor. This is of class <code>"loadings"</code> if <code>rotation = "varimax"</code>: see <code><a href="stats.html#topic+loadings">loadings</a></code> for its print method; It is a plain matrix if <code>rotation = "none"</code>.</p>
</td></tr>
<tr><td><code>communality</code></td>
<td>
<p>The common variance.</p>
</td></tr>
<tr><td><code>uniquenesses</code></td>
<td>
<p>The uniquenesses/specific variance computed.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>The robust/classical covariance matrix.</p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>
<p>The robust/classical correlation matrix.</p>
</td></tr>
<tr><td><code>usedMatrix</code></td>
<td>
<p>The used matrix (running matrix). It may be the covariance or correlation matrix according to the value of <code>cor</code>.</p>
</td></tr>
<tr><td><code>reducedCorrelation</code></td>
<td>
<p>NULL. The reduced correlation matrix, reducedCorrelation is calculated in factorScorePfa.R.</p>
</td></tr>
<tr><td><code>factors</code></td>
<td>
<p>The argument factors.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method: always <code>"pca"</code>.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>If requested, a matrix of scores. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>scoringCoef</code></td>
<td>
<p>The scoring coefficients. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>meanF</code></td>
<td>
<p>The sample mean of the scores. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>corF</code></td>
<td>
<p>The sample correlation matrix of the scores. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>scoresMethod</code></td>
<td>
<p>The argument <code>scoresMethod</code>.</p>
</td></tr>
<tr><td><code>n.obs</code></td>
<td>
<p>The number of observations if available. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>center</code></td>
<td>
<p>The center of the data. </p>
</td></tr>
<tr><td><code>eigenvalues</code></td>
<td>
<p>The eigenvalues of the usedMatrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+factorScorePfa">factorScorePfa</a></code>, <code><a href="stats.html#topic+factanal">factanal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(stock611)
R611=cor(stock611[,3:12]); R611

## covmat is a matrix
fsPca1=factorScorePca(factors = 3, covmat = R611); fsPca1

## covmat is a list
covx &lt;- rrcov::Cov(stock611[,3:12])
covmat &lt;- list(cov=rrcov::getCov(covx), center=rrcov::getCenter(covx), n.obs=covx@n.obs)
fsPca2=factorScorePca(factors = 3, covmat = covmat); fsPca2

## fsPca3 contains scores etc.
fsPca3=factorScorePca(x = stock611[,3:12], factors = 2, cor = TRUE, rotation = "varimax", 
scoresMethod = "regression"); fsPca3

</code></pre>

<hr>
<h2 id='factorScorePfa'>
Factor Analysis by Principal Factor Analysis (PFA)
</h2><span id='topic+factorScorePfa'></span>

<h3>Description</h3>

<p>Perform principal factor factor analysis on a covariance matrix or data matrix. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factorScorePfa(x, factors = 2, covmat = NULL, cor = FALSE, 
rotation = c("varimax", "none"), 
scoresMethod = c("none", "regression", "Bartlett"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="factorScorePfa_+3A_x">x</code></td>
<td>

<p>A numeric matrix or an object that can be coerced to a numeric matrix.
</p>
</td></tr>
<tr><td><code id="factorScorePfa_+3A_factors">factors</code></td>
<td>

<p>The number of factors to be fitted.
</p>
</td></tr>
<tr><td><code id="factorScorePfa_+3A_covmat">covmat</code></td>
<td>

<p>A covariance matrix, or a covariance list as returned by <code><a href="stats.html#topic+cov.wt">cov.wt</a></code>. Of course, correlation matrices are covariance matrices.
</p>
</td></tr>
<tr><td><code id="factorScorePfa_+3A_cor">cor</code></td>
<td>

<p>A logical value indicating whether the calculation should use the covariance matrix (<code>cor = FALSE</code>) or the correlation matrix (<code>cor = TRUE</code>).
</p>
</td></tr>
<tr><td><code id="factorScorePfa_+3A_rotation">rotation</code></td>
<td>

<p>character. &quot;none&quot; or &quot;varimax&quot;: it will be called with first argument the loadings matrix, and should return a list with component <code>loadings</code> giving the rotated loadings, or just the rotated loadings.
</p>
</td></tr>
<tr><td><code id="factorScorePfa_+3A_scoresmethod">scoresMethod</code></td>
<td>

<p>Type of scores to produce, if any. The default is <code>"none"</code>, <code>"regression"</code> gives Thompson's scores, <code>"Bartlett"</code> gives Bartlett's weighted least-squares scores.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Other feasible usages are:
</p>
<p><code>factorScorePfa(factors, covmat)</code>
</p>
<p><code>factorScorePfa(x, factors, rotation, scoresMethod)</code>
</p>
<p>If <code>x</code> is missing, then the following components of the result will be NULL: scores, ScoringCoef, meanF, corF, and n.obs.
</p>


<h3>Value</h3>

<p>An object of class <code>"factorScorePfa"</code> with components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>A matrix of loadings, one column for each factor. This is of class <code>"loadings"</code> if <code>rotation = "varimax"</code>: see <code><a href="stats.html#topic+loadings">loadings</a></code> for its print method; It is a plain matrix if <code>rotation = "none"</code>.</p>
</td></tr>
<tr><td><code>communality</code></td>
<td>
<p>The common variance.</p>
</td></tr>
<tr><td><code>uniquenesses</code></td>
<td>
<p>The uniquenesses/specific variance computed.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>The robust/classical covariance matrix.</p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>
<p>The robust/classical correlation matrix.</p>
</td></tr>
<tr><td><code>usedMatrix</code></td>
<td>
<p>The used matrix (running matrix). It may be the covariance or correlation matrix according to the value of <code>cor</code>.</p>
</td></tr>
<tr><td><code>reducedCorrelation</code></td>
<td>
<p>The last reduced correlation matrix.</p>
</td></tr>
<tr><td><code>factors</code></td>
<td>
<p>The argument factors.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method: always <code>"pfa"</code>.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>If requested, a matrix of scores. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>scoringCoef</code></td>
<td>
<p>The scoring coefficients. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>meanF</code></td>
<td>
<p>The sample mean of the scores. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>corF</code></td>
<td>
<p>The sample correlation matrix of the scores. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>scoresMethod</code></td>
<td>
<p>The argument <code>scoresMethod</code>.</p>
</td></tr>
<tr><td><code>n.obs</code></td>
<td>
<p>The number of observations if available. NULL if <code>x</code> is missing.</p>
</td></tr>
<tr><td><code>center</code></td>
<td>
<p>The center of the data. </p>
</td></tr>
<tr><td><code>eigenvalues</code></td>
<td>
<p>The eigenvalues of the usedMatrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+factorScorePca">factorScorePca</a></code>, <code><a href="stats.html#topic+factanal">factanal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(stock611)
R611 = cor(stock611[,3:12]); R611

## covmat is a matrix
fsPfa1 = factorScorePfa(factors = 3, covmat = R611); fsPfa1

## covmat is a list
covx = rrcov::Cov(stock611[,3:12])
covmat = list(cov = rrcov::getCov(covx), center = rrcov::getCenter(covx), n.obs = covx@n.obs)
fsPfa2 = factorScorePfa(factors = 3, cor = TRUE, covmat = covmat); fsPfa2

## fsPfa3 contains scores etc.
fsPfa3 = factorScorePfa(x = stock611[,3:12], factors = 2, 
cor = TRUE, rotation = "varimax", scoresMethod = "regression"); fsPfa3

</code></pre>

<hr>
<h2 id='FaRobust-class'>Class <code>"FaRobust"</code></h2><span id='topic+FaRobust-class'></span>

<h3>Description</h3>

<p>Class <code>"FaRobust"</code> is a virtual base class for all robust FA classes. Currently the only available robust FA class is <code>"FaCov"</code>. The class <code>"FaRobust"</code> serves as a base class for deriving all other classes representing the results of the robust Factor Analysis methods.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code> an unevaluated function call</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>Object of class <code>"Ulogical"</code> a logical character indicates whether the iterations converged </p>
</dd>
<dt><code>loadings</code>:</dt><dd><p>Object of class <code>"matrix"</code> the matrix of variable loadings </p>
</dd>
<dt><code>uniquenesses</code>:</dt><dd><p>Object of class <code>"vector"</code> the uniquenesses computed </p>
</dd>
<dt><code>covariance</code>:</dt><dd><p>Object of class <code>"matrix"</code> the covariance matrix </p>
</dd>
<dt><code>correlation</code>:</dt><dd><p>Object of class <code>"matrix"</code> the correlation matrix </p>
</dd>
<dt><code>usedMatrix</code>:</dt><dd><p>Object of class <code>"matrix"</code> the used matrix (running matrix) </p>
</dd>
<dt><code>criteria</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The results of the optimization: the value of the negative log-likelihood and information on the iterations used. </p>
</dd>
<dt><code>factors</code>:</dt><dd><p>Object of class <code>"numeric"</code> the number of factors </p>
</dd>
<dt><code>dof</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The number of degrees of freedom of the factor analysis model. </p>
</dd>
<dt><code>method</code>:</dt><dd><p>Object of class <code>"character"</code>. The method: one of &quot;mle&quot;, &quot;pca&quot;, and &quot;pfa&quot;.</p>
</dd>
<dt><code>scores</code>:</dt><dd><p>Object of class <code>"Umatrix"</code>. If requested, a matrix of scores. </p>
</dd>
<dt><code>scoresMethod</code>:</dt><dd><p>Object of class <code>"character"</code>. The scores method: one of &quot;none&quot;, &quot;regression&quot;, and &quot;Bartlett&quot;. </p>
</dd>
<dt><code>STATISTIC</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The significance-test statistic, if it can be computed. </p>
</dd>
<dt><code>PVAL</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The significance-test P value, if it can be computed. </p>
</dd>
<dt><code>n.obs</code>:</dt><dd><p>Object of class <code>"Unumeric"</code>. The number of observations if available. </p>
</dd>
<dt><code>center</code>:</dt><dd><p>Object of class <code>"Uvector"</code>. The center of the data. </p>
</dd>
<dt><code>eigenvalues</code>:</dt><dd><p>Object of class <code>"vector"</code> the eigenvalues </p>
</dd>
<dt><code>cov.control</code>:</dt><dd><p>Object of class <code>"UCovControl"</code>. Record the cov control method. </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+Fa-class">Fa</a>"</code>, directly.
</p>


<h3>Methods</h3>

<p>No methods defined with class &quot;FaRobust&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FaClassic-class">FaClassic-class</a></code>, <code><a href="#topic+FaCov-class">FaCov-class</a></code>, <code><a href="#topic+FaRobust-class">FaRobust-class</a></code>, <code><a href="#topic+Fa-class">Fa-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("FaRobust")
</code></pre>

<hr>
<h2 id='fsOrder'>
Compute the Ordered Factor Scores
</h2><span id='topic+fsOrder'></span>

<h3>Description</h3>

<p>Compute the ordered factor scores according to the first/second/third... column of the original factor scores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fsOrder(factorScores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fsOrder_+3A_factorscores">factorScores</code></td>
<td>

<p>The original factor scores.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with <code>m</code> (the number of factors) components:
</p>
<table>
<tr><td><code>[[1]]</code></td>
<td>
<p>The ordered factor scores with a decreasing first column.</p>
</td></tr>
<tr><td><code>[[2]]</code></td>
<td>
<p>The ordered factor scores with a decreasing second column.</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
</td></tr>
<tr><td><code>[[m]]</code></td>
<td>
<p>The ordered factor scores with a decreasing m-th column.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+order">order</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(stock611)
R611=cor(stock611[,3:12]); R611

## FS.pca contains scores etc.
fsPca=factorScorePca(x = stock611[,3:12], factors = 2, cor = TRUE, 
rotation = "varimax", scoresMethod = "regression"); fsPca

orderedFS=fsOrder(fsPca$scores); orderedFS

</code></pre>

<hr>
<h2 id='getCenter-methods'>Access Center slot</h2><span id='topic+getCenter-methods'></span><span id='topic+getCenter+2CFa-method'></span>

<h3>Description</h3>

<p>Accessor method to the Center slot of an object of class <code>"Fa"</code> and its subclasses.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(obj = "Fa")</code></dt><dd>
<p>Accessor method to the Center slot of an object of class <code>"Fa"</code> and its subclasses
</p>
</dd>
</dl>

<hr>
<h2 id='getEigenvalues-methods'>Access Eigenvalues slot</h2><span id='topic+getEigenvalues-methods'></span><span id='topic+getEigenvalues+2CFa-method'></span>

<h3>Description</h3>

<p>Accessor method to the Eigenvalues slot of an object of class <code>"Fa"</code> and its subclasses.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(obj = "Fa")</code></dt><dd>
<p>Accessor method to the Eigenvalues slot of an object of class <code>"Fa"</code> and its subclasses
</p>
</dd>
</dl>

<hr>
<h2 id='getFa-methods'>Access slots of &quot;Fa&quot;</h2><span id='topic+getFa-methods'></span><span id='topic+getFa+2CFa-method'></span><span id='topic+getFa'></span>

<h3>Description</h3>

<p>Accessor method to some slots of an object of class <code>"Fa"</code> and its subclasses. Return a list of class &quot;fa&quot;.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(obj = "Fa")</code></dt><dd>
<p>Accessor method to some slots of an object of class <code>"Fa"</code> and its subclasses. Return a list of class &quot;fa&quot;.
</p>
</dd>
</dl>

<hr>
<h2 id='getLoadings-methods'>Access Loadings slot</h2><span id='topic+getLoadings-methods'></span><span id='topic+getLoadings+2CFa-method'></span>

<h3>Description</h3>

<p>Accessor method to the Loadings slot of an object of class <code>"Fa"</code> and its subclasses.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(obj = "Fa")</code></dt><dd>
<p>Accessor method to the Loadings slot of an object of class <code>"Fa"</code> and its subclasses
</p>
</dd>
</dl>

<hr>
<h2 id='getQuan-methods'>Access n.obs slot</h2><span id='topic+getQuan-methods'></span><span id='topic+getQuan+2CFa-method'></span>

<h3>Description</h3>

<p>Accessor method to the n.obs slot of an object of class <code>"Fa"</code> and its subclasses.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(obj = "Fa")</code></dt><dd>
<p>Accessor method to the n.obs slot of an object of class <code>"Fa"</code> and its subclasses
</p>
</dd>
</dl>

<hr>
<h2 id='getScores-methods'>Access Scores slot</h2><span id='topic+getScores-methods'></span><span id='topic+getScores+2CFa-method'></span>

<h3>Description</h3>

<p>Accessor method to the Scores slot of an object of class <code>"Fa"</code> and its subclasses.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(obj = "Fa")</code></dt><dd>
<p>Accessor method to the Scores slot of an object of class <code>"Fa"</code> and its subclasses
</p>
</dd>
</dl>

<hr>
<h2 id='getSdev-methods'>Access Standard Deviation slot</h2><span id='topic+getSdev-methods'></span><span id='topic+getSdev+2CFa-method'></span>

<h3>Description</h3>

<p>Accessor method to the Standard Deviation slot of an object of class <code>"Fa"</code> and its subclasses.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(obj = "Fa")</code></dt><dd>
<p>Accessor method to the Standard Deviation slot of an object of class <code>"Fa"</code> and its subclasses
</p>
</dd>
</dl>

<hr>
<h2 id='myFaPrint'>Show/Print/Display an Object</h2><span id='topic+myFaPrint'></span>

<h3>Description</h3>

<p>Show/print/display an object, including the Call, Standard deviations, Loadings, and Rotated variables (if <code>print.x = TRUE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myFaPrint(object, print.x=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="myFaPrint_+3A_object">object</code></td>
<td>

<p>an object of class <code>"Fa"</code> or of a class derived from <code>"Fa"</code>. 
</p>
</td></tr>
<tr><td><code id="myFaPrint_+3A_print.x">print.x</code></td>
<td>

<p>Logical. If <code>print.x = TRUE</code>, then print the rotated variables (scores).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An invisible argument <code>object</code>.
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Fa-class">Fa-class</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("hbk")
hbk.x = hbk[,1:3] 

faCovPcaRegMcd = FaCov(x = hbk.x, factors = 2, method = "pca",
scoresMethod = "regression", cov.control = rrcov::CovControlMcd())

## you can use either object or print(object) or myFaPrint(object)
## since faCovPcaRegMcd is an object of class "Fa"

faCovPcaRegMcd
print(faCovPcaRegMcd)
myFaPrint(faCovPcaRegMcd)

</code></pre>

<hr>
<h2 id='myplotDD'>
Distance-Distance Plot
</h2><span id='topic+myplotDD'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p><code>"myplotDD"</code> is a revised version of <code>".myddplot"</code> in <code>"plot-utils.R"</code> in the package <code>"rrcov"</code>. In <code>"myplotDD"</code>, <code>id.n</code> and <code>ind</code> are printed out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myplotDD(x, cutoff, id.n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="myplotDD_+3A_x">x</code></td>
<td>

<p>An S4 object of class <code>"CovRobust"</code>.
</p>
</td></tr>
<tr><td><code id="myplotDD_+3A_cutoff">cutoff</code></td>
<td>

<p>The <code>cutoff</code> value used. If missing, <code>cutoff &lt;- sqrt(qchisq(0.975, p))</code> by default.
</p>
</td></tr>
<tr><td><code id="myplotDD_+3A_id.n">id.n</code></td>
<td>

<p>Number of observations to identify by a label. If not supplied, the number of observations with robust distance larger than <code>cutoff</code> is used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Distance-Distance Plot: Plot the vector <code>y=rd</code> (robust distances) against <code>x=md</code> (mahalanobis distances). Identify by a label the <code>id.n</code> observations with largest <code>rd</code>. If <code>id.n</code> is not supplied, calculate it as the number of observations larger than <code>cutoff</code>. Use <code>cutoff</code> to draw a horisontal and a vertical line. Draw also a dotted line with a slope 1.
</p>
<p><code>"myplotDD(x)"</code> is equivalent to <code>"plot(x, which="dd")"</code>.
<code>which</code>: indicate what kind of plot. If <code>which = "dd"</code>, then a distance-distance Plot.
</p>


<h3>Value</h3>

<p>A distance-distance plot is shown. Return a list with components:
</p>
<table>
<tr><td><code>cutoff</code></td>
<td>
<p>The <code>cutoff</code> value used. If missing, <code>cutoff &lt;- sqrt(qchisq(0.975, p))</code> by default.</p>
</td></tr>
<tr><td><code>id.n</code></td>
<td>
<p>Number of observations to identify by a label. If not supplied, the number of observations with robust distance larger than <code>cutoff</code> is used.</p>
</td></tr>
<tr><td><code>sort.y</code></td>
<td>
<p>A list containing the sorted values of y (the robust distance)</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>The indices of the largest <code>id.n</code> observations whose robust distances are larger than <code>cutoff</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a></code>, <code><a href="stats.html#topic+qchisq">qchisq</a></code>, <code>CovClassic</code>, <code>getDistance</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(stock611)
covMcd=CovRobust(x=scale(stock611[,3:12]), control="mcd"); covMcd

## "myplotDD" shows id.n and ind.
## Note: id.n and ind change each time due to covMcd changes each time!
## However, the ind of largest robust distances do not change.
result = myplotDD(x=covMcd); result

## "myplotDD" is equivalent to "plot(x=covMcd, which="dd")".
plot(x=covMcd, which="dd")

</code></pre>

<hr>
<h2 id='plot-methods'>Plot an object of class &quot;Fa&quot;</h2><span id='topic+plot-methods'></span><span id='topic+plot+2CFa+2Cmissing-method'></span><span id='topic+plot+2CFa-method'></span>

<h3>Description</h3>

<p>Plot an object of class &quot;Fa&quot;.  If which = &quot;factorScore&quot;, then a scatterplot of the factor scores is produced; if which = &quot;screeplot&quot;, shows the eigenvalues and is helpful to select the number of factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Fa'
plot(x, which=c("factorScore", "screeplot"), choices=1:2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-methods_+3A_x">x</code></td>
<td>
<p>an object of class <code>"Fa"</code> or of a class derived from <code>"Fa"</code></p>
</td></tr>
<tr><td><code id="plot-methods_+3A_which">which</code></td>
<td>
<p>indicate what kind of plot. If <code>which = "factorScore"</code>, then a scatterplot of the factor scores is produced; if <code>which = "screeplot"</code>, shows the eigenvalues and is helpful to select the number of factors.
</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_choices">choices</code></td>
<td>
<p>an integer vector indicate which columns of the factor scores to plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The feasible usages are:
<code>plot(x, which="factorScore", choices=1:2)</code>
<code>plot(x, which="screeplot")</code>
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "Fa", y = "missing")</code></dt><dd>
<p>generic functions - see <code>plot</code>
</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("hbk")
hbk.x = hbk[,1:3] 

faClassicPcaReg = FaClassic(x = hbk.x, factors = 2, method = "pca",
scoresMethod = "regression"); faClassicPcaReg
summary(faClassicPcaReg)

plot(faClassicPcaReg, which = "factorScore", choices = 1:2)
plot(faClassicPcaReg, which = "screeplot")

</code></pre>

<hr>
<h2 id='predict-methods'>Calculates prediction</h2><span id='topic+predict-methods'></span><span id='topic+predict+2CFa-method'></span><span id='topic+predict'></span>

<h3>Description</h3>

<p>Calculates prediction using the results in object. The newdata argument is an optional data frame or matrix in which to look for variables with which to predict. If newdata is omitted, the scores are used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code>"Fa"</code> or of a class derived from <code>"Fa"</code></p>
</td></tr>
<tr><td><code id="predict-methods_+3A_...">...</code></td>
<td>
<p>additional arguments, e.g., newdata: an optional data frame or matrix in which to look for variables with which to predict. If newdata is not missing, newdata should be scaled before <code>"predict"</code>.</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "Fa")</code></dt><dd>
<p>generic functions - see <code>print</code>, <code>summary</code>, <code>predict</code>, <code>plot</code>, <code>getCenter</code>, <code>getEigenvalues</code>, <code>getFa</code>, <code>getLoadings</code>, <code>getQuan</code>, <code>getScores</code>, <code>getSdev</code>
</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("hbk")
hbk.x = hbk[,1:3] 

faCovPcaRegMcd = FaCov(x = hbk.x, factors = 2, method = "pca",
scoresMethod = "regression", cov.control = rrcov::CovControlMcd()); faCovPcaRegMcd

## If missing newdata, the scores are used
predict(faCovPcaRegMcd)

##
## If not missing newdata, newdata should be scaled first.
##
newdata = hbk.x[1, ]
cor = FALSE # the default
newdata = { 
if (cor == TRUE)
	# standardized transformation
	scale(newdata, center = faCovPcaRegMcd@center, 
	scale = sqrt(diag(faCovPcaRegMcd@covariance)))
else # cor == FALSE
	# centralized transformation
	scale(newdata, center = faCovPcaRegMcd@center, scale = FALSE)
}

##
## Now, prediction = predict(faCovPcaRegMcd)[1,] = faCovPcaRegMcd@scores[1,]
##
prediction = predict(faCovPcaRegMcd, newdata = newdata)
prediction

</code></pre>

<hr>
<h2 id='print-methods'>Print/Display an Object</h2><span id='topic+print-methods'></span><span id='topic+print+2CFa-method'></span><span id='topic+print+2CSummaryFa-method'></span><span id='topic+print'></span>

<h3>Description</h3>

<p>Print/display an object, including the Call, Standard deviations, Loadings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print-methods_+3A_x">x</code></td>
<td>

<p>an object of class <code>"Fa"</code> or <code>"SummaryFa"</code> or of a class derived from <code>"Fa"</code> or of class or <code>"SummaryFa"</code>. 
</p>
</td></tr>
<tr><td><code id="print-methods_+3A_...">...</code></td>
<td>

<p>additional arguments, e.g., print.x=TRUE
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An invisible argument <code>x</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>x = &quot;Fa&quot;</dt><dd>
<p>generic functions - see <code>print</code>, <code>summary</code>, <code>predict</code>, <code>plot</code>, <code>getCenter</code>, <code>getEigenvalues</code>, <code>getFa</code>, <code>getLoadings</code>, <code>getQuan</code>, <code>getScores</code>, <code>getSdev</code>
</p>
</dd>
<dt>x = &quot;SummaryFa&quot;</dt><dd>
<p>generic functions - see <code>print</code>, <code>summary</code>, <code>predict</code>, <code>plot</code>, <code>getCenter</code>, <code>getEigenvalues</code>, <code>getFa</code>, <code>getLoadings</code>, <code>getQuan</code>, <code>getScores</code>, <code>getSdev</code>
</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Fa-class">Fa-class</a></code>, <code><a href="#topic+SummaryFa-class">SummaryFa-class</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("hbk")
hbk.x = hbk[,1:3] 

faCovPcaRegMcd = FaCov(x = hbk.x, factors = 2, method = "pca",
scoresMethod = "regression", cov.control = rrcov::CovControlMcd())

## you can use either object or print(object) or myFaPrint(object)
## since faCovPcaRegMcd is an object of class "Fa"

faCovPcaRegMcd
print(faCovPcaRegMcd)
myFaPrint(faCovPcaRegMcd)

</code></pre>

<hr>
<h2 id='robustfa-package'>
An Object Oriented Solution for Robust Factor Analysis
</h2><span id='topic+robustfa-package'></span><span id='topic+robustfa'></span>

<h3>Description</h3>

<p>Outliers virtually exist in any datasets of any application field. To avoid the impact of outliers, we need to use robust estimators. Classical estimators of multivariate mean and covariance matrix are the sample mean and the sample covariance matrix. Outliers will affect the sample mean and the sample covariance matrix, and thus they will affect the classical factor analysis which depends on the classical estimators (Pison, G., Rousseeuw, P.J., Filzmoser, P. and Croux, C. (2003) <a href="https://doi.org/10.1016/S0047-259X%2802%2900007-6">doi:10.1016/S0047-259X(02)00007-6</a>). So it is necessary to use the robust estimators of the sample mean and the sample covariance matrix. There are several robust estimators in the literature: MCD, OGK, MVE, M, S, and Stahel-Donoho. The most direct way to robustify multivariate anal-ysis is to replace the sample mean and the sample covariance matrix of the classical estimators to robust estima-tors (Maronna, R.A., Martin, D. and Yohai, V. (2006) <a href="https://doi.org/10.1002/0470010940">doi:10.1002/0470010940</a>) (Todorov, V. and Filzmoser, P. (2009) <a href="https://doi.org/10.18637/jss.v032.i03">doi:10.18637/jss.v032.i03</a>), which is our choice of robust factor analysis. robustfa is an object oriented solution for robust factor analysis. In the solution, new S4 classes <code>"Fa"</code>, <code>"FaClassic"</code>, <code>"FaRobust"</code>, <code>"FaCov"</code>, <code>"SummaryFa"</code> are created.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> robustfa</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-5</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-11-09</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> methods</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The most important functions are:
<code><a href="#topic+FaClassic">FaClassic</a></code>, <code><a href="#topic+FaCov">FaCov</a></code>, <code><a href="#topic+factorScorePca">factorScorePca</a></code>, <code><a href="#topic+factorScorePfa">factorScorePfa</a></code>
</p>


<h3>Author(s)</h3>

<p>Ying-Ying Zhang (Robert)
</p>
<p>Maintainer: Ying-Ying Zhang (Robert) &lt;robertzhangyying@qq.com&gt;
</p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("robustfa")

</code></pre>

<hr>
<h2 id='stock611'>
The Stocks Data - Year 2001
</h2><span id='topic+stock611'></span>

<h3>Description</h3>

<p>This data set consists of 611 observations with 12 variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(stock611)</code></pre>


<h3>Format</h3>

<p>A data frame with 611 observations on the following 12 variables.
</p>

<dl>
<dt><code>code</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>name</code></dt><dd><p>a numeric vector: the Chinese stocks name is replaced by integer, it can be found by its code.</p>
</dd>
<dt><code>x1</code></dt><dd><p>a numeric vector: main business income (China Yuan)</p>
</dd>
<dt><code>x2</code></dt><dd><p>a numeric vector: main business profit (China Yuan)</p>
</dd>
<dt><code>x3</code></dt><dd><p>a numeric vector: total profit (China Yuan)</p>
</dd>
<dt><code>x4</code></dt><dd><p>a numeric vector: net profit (China Yuan)</p>
</dd>
<dt><code>x5</code></dt><dd><p>a numeric vector: earnings per share (EPS) (China Yuan)</p>
</dd>
<dt><code>x6</code></dt><dd><p>a numeric vector: net assets per share (China Yuan)</p>
</dd>
<dt><code>x7</code></dt><dd><p>a numeric vector: net return on assets (%)</p>
</dd>
<dt><code>x8</code></dt><dd><p>a numeric vector: total return on assets (%)</p>
</dd>
<dt><code>x9</code></dt><dd><p>a numeric vector: total assets (China Yuan)</p>
</dd>
<dt><code>x10</code></dt><dd><p>a numeric vector: equity</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data set is from Chinese stock market in the year 2001. It was used in Wang X. M. (2009) to illustrate the factor analysis methods.
</p>


<h3>Source</h3>

<p>Wang X. M. (2009) <em>Applied Multivariate Analysis</em>. Third edition. ShangHai University of Finance &amp; Economics Press. (This is a Chinese book)
</p>
<p>Note: In Wang X. M.'s homepage, he provided a link to download materials related to his book (including the data set stock611): http://bb.shufe.edu.cn/bbcswebdav/institution/
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stock611)
str(stock611)
plot(stock611)
</code></pre>

<hr>
<h2 id='summary-methods'>Summary an Object</h2><span id='topic+summary-methods'></span><span id='topic+summary+2CFa-method'></span><span id='topic+summary'></span>

<h3>Description</h3>

<p>Produce result summaries of an object of class &quot;Fa&quot;. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code>"Fa"</code> or of a class derived from <code>"Fa"</code>.
</p>
</td></tr>
<tr><td><code id="summary-methods_+3A_...">...</code></td>
<td>

<p>additional arguments, e.g., print.x=TRUE.
</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "Fa")</code></dt><dd>
<p>Summary an object of class &quot;Fa&quot;.
</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("hbk")
hbk.x = hbk[,1:3] 

faCovPcaRegMcd = FaCov(x = hbk.x, factors = 2, method = "pca",
scoresMethod = "regression", cov.control = rrcov::CovControlMcd()); faCovPcaRegMcd

faCovPcaRegMcd
summary(faCovPcaRegMcd)

</code></pre>

<hr>
<h2 id='SummaryFa-class'>Class <code>"SummaryFa"</code></h2><span id='topic+SummaryFa-class'></span>

<h3>Description</h3>

<p>Summary of <code>"Fa"</code> objects. The <code>"Fa"</code> object plus some additional summary information.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("SummaryFa", ...)</code>. But most often by invoking 'summary' on an &quot;Fa&quot; object. They contain values meant for printing by 'show'.
</p>


<h3>Slots</h3>


<dl>
<dt><code>faobj</code>:</dt><dd><p>Object of class <code>"Fa"</code> </p>
</dd>
<dt><code>importance</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Matrix with additional information: importance of components. </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "SummaryFa")</code>: display the object </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Fa-class">Fa-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("SummaryFa")
</code></pre>

<hr>
<h2 id='Ulogical-class'>Class <code>"Ulogical"</code></h2><span id='topic+Ulogical-class'></span>

<h3>Description</h3>

<p>Define class unions for optional slots, e.g., for definition of slots which will be computed on demand.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Methods</h3>

<p>No methods defined with class &quot;Ulogical&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>

<hr>
<h2 id='Unumeric-class'>Class <code>"Unumeric"</code></h2><span id='topic+Unumeric-class'></span>

<h3>Description</h3>

<p>Define class unions for optional slots, e.g., for definition of slots which will be computed on demand.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Methods</h3>

<p>No methods defined with class &quot;Unumeric&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p> Ying-Ying Zhang (Robert) <a href="mailto:robertzhangyying@qq.com">robertzhangyying@qq.com</a> </p>


<h3>References</h3>

<p>Zhang, Y. Y. (2013), An Object Oriented Solution for Robust Factor Analysis.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
