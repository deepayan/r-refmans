<!DOCTYPE html><html lang="en"><head><title>Help for package heckmanGE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {heckmanGE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bread.heckmanGE'><p>bread.heckmanGE</p></a></li>
<li><a href='#coef.heckmanGE'><p>Extract Coefficients from a Generalized Heckman Model</p></a></li>
<li><a href='#estfun.heckmanGE'><p>Compute Estimating Functions for Generalized Heckman Model</p></a></li>
<li><a href='#fitheckmanGE'><p>fitheckmanGE</p></a></li>
<li><a href='#fitted.heckmanGE'><p>fitted.heckmanGE</p>
Extract Fitted Values of the Generalized Heckman Model</a></li>
<li><a href='#heckmanGE'><p>heckmanGE: A Package for Fitting Sample Selection Models</p></a></li>
<li><a href='#meat.heckmanGE'><p>meat.heckmanGE</p>
Compute Meat of the Covariance Matrix for the Generalized Heckman Model</a></li>
<li><a href='#meatCL.heckmanGE'><p>meatCL.heckmanGE</p>
Compute the Meat Matrix for a Heckman-Ge Model with Clustering</a></li>
<li><a href='#MEPS2001'><p>Medical Expenditure Panel Survey (MEPS) Data</p></a></li>
<li><a href='#model.frame.heckmanGE'><p>model.frame.heckmanGE</p>
Get the Model Frames of a Generalized Heckman Regression</a></li>
<li><a href='#model.matrix.heckmanGE'><p>model.matrix.heckmanGE</p>
Get the Design Matrices of a Generalized Heckman Regression</a></li>
<li><a href='#pnadC_y2024q2'><p>PNAD Continua de 2024, 2 trimestre</p></a></li>
<li><a href='#predict.heckmanGE'><p>predict.heckmanGE</p>
Predictions from the Generalized Heckman Model</a></li>
<li><a href='#print.heckmanGE'><p>print.heckmanGE</p>
Print of Generalized Heckman Model Results</a></li>
<li><a href='#residuals.heckmanGE'><p>residuals.heckmanGE</p>
Extract Residuals of the Generalized Heckman Model</a></li>
<li><a href='#sandwich.heckmanGE'><p>sandwich.heckmanGE</p>
Sandwich Estimator for Generalized Heckman Model</a></li>
<li><a href='#simulation'><p>Simulation dataset for the heckmanGE example</p></a></li>
<li><a href='#step2'><p>step2: Two-Step Estimation Function</p></a></li>
<li><a href='#summary.heckmanGE'><p>summary.heckmanGE</p>
Summary of Generalized Heckman Model</a></li>
<li><a href='#vcov.heckmanGE'><p>vcov.heckmanGE</p>
Variance-Covariance Matrix of the Generalized Heckman Model</a></li>
<li><a href='#vcovCL.heckmanGE'><p>Variance-Covariance with Cluster Correction for Heckman Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimation and Inference for Heckman Selection Models with
Cluster-Robust Variance</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-10-02</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for the estimation of Heckman selection models with robust 
  variance-covariance matrices. It includes functions for computing the bread 
  and meat matrices, as well as clustered standard errors for generalized Heckman 
  models, see Fernando de Souza Bastos and Wagner Barreto-Souza and Marc G. Genton 
  (2022, ISSN: <a href="https://www.jstor.org/stable/27164235">https://www.jstor.org/stable/27164235</a>). The package also offers 
  cluster-robust inference with sandwich estimators, and tools for handling issues 
  related to eigenvalues in covariance matrices.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/fsbmat-ufv/heckmanGE">https://github.com/fsbmat-ufv/heckmanGE</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fsbmat-ufv/heckmanGE/issues">https://github.com/fsbmat-ufv/heckmanGE/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>glm2, maxLik, miscTools, vctrs</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-05 22:52:43 UTC; Fernando</td>
</tr>
<tr>
<td>Author:</td>
<td>Bastos Fernando de Souza
    <a href="https://orcid.org/0000-0003-1503-4599"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Barbosa Rogério Jerônimo
    <a href="https://orcid.org/0000-0002-6796-4547"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Prates Marcos Oliveira
    <a href="https://orcid.org/0000-0001-8077-4898"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bastos Fernando de Souza &lt;fernando.bastos@ufv.br&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-07 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bread.heckmanGE'>bread.heckmanGE</h2><span id='topic+bread.heckmanGE'></span>

<h3>Description</h3>

<p>Bread Function for the <code>fitheckmanGE</code> Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bread.heckmanGE(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bread.heckmanGE_+3A_object">object</code></td>
<td>
<p>An object of class <code>fitheckmanGE</code>, which is the result of fitting
a Heckman selection model using the <code>fitheckmanGE</code> function.</p>
</td></tr>
<tr><td><code id="bread.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments (currently unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the &quot;bread&quot; component of the sandwich estimator for
the <code>fitheckmanGE</code> model. The bread matrix is typically defined as the product
of the number of observations and the variance-covariance matrix of the
estimated parameters.
</p>
<p>The bread matrix is an essential component of the sandwich estimator used to
obtain robust standard errors. It reflects the variability in the estimated
parameters due to the model's fit. The function uses the number of observations
and the variance-covariance matrix from the <code>fitheckmanGE</code> model object to
compute this matrix.
</p>


<h3>Value</h3>

<p>A matrix representing the bread component of the sandwich estimator. The
matrix is calculated as the product of the number of observations and the
variance-covariance matrix of the estimated parameters.
</p>

<hr>
<h2 id='coef.heckmanGE'>Extract Coefficients from a Generalized Heckman Model</h2><span id='topic+coef.heckmanGE'></span>

<h3>Description</h3>

<p>This function extracts the coefficients from a <code>heckmanGE</code> class object. You can specify which parts of the model you want to retrieve the coefficients for: selection, outcome, dispersion, or correlation. By default, the function returns the complete coefficient vector for all parts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckmanGE'
coef(
  object,
  part = c("selection", "outcome", "dispersion", "correlation"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.heckmanGE_+3A_object">object</code></td>
<td>
<p>An object of class <code>heckmanGE</code>, which contains the fitted model.</p>
</td></tr>
<tr><td><code id="coef.heckmanGE_+3A_part">part</code></td>
<td>
<p>A character vector indicating which parts of the model coefficients to return. Valid options are: <code>"selection"</code>, <code>"outcome"</code>, <code>"dispersion"</code>, and <code>"correlation"</code>. Multiple parts can be specified. By default, all parts are included in the returned coefficients.</p>
</td></tr>
<tr><td><code id="coef.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to or from other methods. Currently, these are not used in this method but must be included to match the generic method signature.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>coef.heckmanGE</code> function retrieves coefficients from the <code>heckmanGE</code> model object based on the specified parts. The parts represent different components of the Heckman model:
</p>

<ul>
<li> <p><code>"selection"</code>: Coefficients related to the selection equation.
</p>
</li>
<li> <p><code>"outcome"</code>: Coefficients related to the outcome equation.
</p>
</li>
<li> <p><code>"dispersion"</code>: Coefficients related to the dispersion equation.
</p>
</li>
<li> <p><code>"correlation"</code>: Coefficients related to the correlation between selection and outcome.
</p>
</li></ul>

<p>By default, the function returns coefficients from all parts. You can specify one or more parts in the <code>part</code> argument to extract coefficients from specific components.
</p>


<h3>Value</h3>

<p>A numeric vector containing the coefficients extracted from the model object. The coefficients correspond to the specified model parts, returned in the order they are requested.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
selectEq  &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
dispersion  &lt;- ~ age + female + totchr + ins
correlation  &lt;- ~ age
fit &lt;- heckmanGE(selection = selectEq,
                 outcome = outcomeEq,
                 dispersion = dispersion,
                 correlation = correlation,
                 data = MEPS2001)
# Extracting all coefficients:
coef(fit)

# Extracting only the selection and outcome coefficients:
coef(fit, part = c("selection", "outcome"))

</code></pre>

<hr>
<h2 id='estfun.heckmanGE'>Compute Estimating Functions for Generalized Heckman Model</h2><span id='topic+estfun.heckmanGE'></span>

<h3>Description</h3>

<p>This function calculates the estimating functions (i.e., the gradient of the log-likelihood) for the Generalized Heckman model.
It is primarily used for model diagnostics and inference, providing the gradient for each observation with respect to model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estfun.heckmanGE(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estfun.heckmanGE_+3A_x">x</code></td>
<td>
<p>An object of class <code>heckmanGE</code>, typically the result of fitting a generalized Heckman model. This object should contain model responses, model matrices, weights, and coefficient indexes necessary for the computation of the gradient.</p>
</td></tr>
<tr><td><code id="estfun.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments (currently not used, reserved for future extensions).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the gradient of the log-likelihood function for the Generalized Heckman model, which includes the selection, outcome, dispersion, and correlation components.
</p>
<p>The gradient is calculated per observation, and internally, the helper function <code>gradlik_gen_i</code> computes the gradient for each observation given the model parameters. This involves extracting components such as model matrices, weights, and coefficient indexes, and performing matrix operations specific to the model's structure.
</p>


<h3>Value</h3>

<p>A matrix of dimensions <code style="white-space: pre;">&#8288;n x p&#8288;</code>, where <code>n</code> is the number of observations and <code>p</code> is the number of parameters in the model. Each element of the matrix corresponds to the gradient of the log-likelihood function with respect to a given parameter for each observation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assuming 'model' is a fitted object of class 'heckmanGE':
data(MEPS2001)
selectEq  &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
dispersion  &lt;- ~ age + female + totchr + ins
correlation  &lt;- ~ age
fit &lt;- heckmanGE(selection = selectEq,
                 outcome = outcomeEq,
                 dispersion = dispersion,
                 correlation = correlation,
                 data = MEPS2001)
estfun.heckmanGE(fit)

</code></pre>

<hr>
<h2 id='fitheckmanGE'>fitheckmanGE</h2><span id='topic+fitheckmanGE'></span>

<h3>Description</h3>

<p>Newton-Raphson Optimization for Generalized Heckman Model Estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitheckmanGE(start, YS, XS, YO, XO, Msigma, Mrho, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitheckmanGE_+3A_start">start</code></td>
<td>
<p>A numeric vector of initial parameter guesses for the selection,
outcome, dispersion, and correlation equations.</p>
</td></tr>
<tr><td><code id="fitheckmanGE_+3A_ys">YS</code></td>
<td>
<p>A binary vector indicating selection status (1 if selected, 0 otherwise).</p>
</td></tr>
<tr><td><code id="fitheckmanGE_+3A_xs">XS</code></td>
<td>
<p>A matrix of independent variables for the selection equation.</p>
</td></tr>
<tr><td><code id="fitheckmanGE_+3A_yo">YO</code></td>
<td>
<p>A numeric vector of observed outcomes (dependent variable) for the
outcome equation.</p>
</td></tr>
<tr><td><code id="fitheckmanGE_+3A_xo">XO</code></td>
<td>
<p>A matrix of independent variables for the outcome equation.</p>
</td></tr>
<tr><td><code id="fitheckmanGE_+3A_msigma">Msigma</code></td>
<td>
<p>A matrix representing the predictors for the dispersion parameter.</p>
</td></tr>
<tr><td><code id="fitheckmanGE_+3A_mrho">Mrho</code></td>
<td>
<p>A matrix representing the predictors for the correlation parameter.</p>
</td></tr>
<tr><td><code id="fitheckmanGE_+3A_w">w</code></td>
<td>
<p>A numeric vector of observation weights, used in the likelihood
computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the parameters of a generalized Heckman selection
model using a Newton-Raphson optimization algorithm. It supports the modeling
of selection and outcome equations, along with associated dispersion and
correlation structures.
</p>
<p>This function uses the Newton-Raphson algorithm to estimate the parameters of
a generalized Heckman model, which accounts for sample selection bias.
The model is composed of a selection equation (modeled by <code>YS</code> and <code>XS</code>), an
outcome equation (modeled by <code>YO</code> and <code>XO</code>), and additional equations for
dispersion (<code>Msigma</code>) and correlation (<code>Mrho</code>). The optimization process
maximizes the log-likelihood of the model, allowing for robust estimation of
selection bias, while also estimating associated dispersion and correlation
parameters.
</p>
<p>The function outputs the coefficients, fitted values, residuals, and several
information criteria for model comparison.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt>coefficients</dt><dd><p>Named vector of estimated coefficients for selection,
outcome, dispersion, and correlation equations.</p>
</dd>
<dt>fitted.values</dt><dd><p>Named list with fitted values for each equation
(selection, outcome, dispersion, correlation).</p>
</dd>
<dt>residuals</dt><dd><p>Numeric vector of residuals for the selection and outcome
equations.</p>
</dd>
<dt>loglik</dt><dd><p>Log-likelihood value of the fitted model.</p>
</dd>
<dt>vcov</dt><dd><p>Variance-covariance matrix of the estimated parameters.</p>
</dd>
<dt>aic</dt><dd><p>Akaike Information Criterion (AIC) for the model.</p>
</dd>
<dt>bic</dt><dd><p>Bayesian Information Criterion (BIC) for the model.</p>
</dd>
<dt>optimization</dt><dd><p>Details of the optimization process, including
convergence information.</p>
</dd>
</dl>


<hr>
<h2 id='fitted.heckmanGE'>fitted.heckmanGE
Extract Fitted Values of the Generalized Heckman Model</h2><span id='topic+fitted.heckmanGE'></span>

<h3>Description</h3>

<p>This function extracts the fitted values from a <code>heckmanGE</code> object. You can specify which part of the model you want to retrieve the fitted values for: selection, outcome, dispersion, or correlation. By default, it returns the fitted values for the outcome part of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckmanGE'
fitted(
  object,
  part = c("selection", "outcome", "dispersion", "correlation"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.heckmanGE_+3A_object">object</code></td>
<td>
<p>An object of class <code>heckmanGE</code>. This object should contain the fitted values for different parts of the model.</p>
</td></tr>
<tr><td><code id="fitted.heckmanGE_+3A_part">part</code></td>
<td>
<p>A character vector specifying which part of the model to return the fitted values for. Options are &quot;selection&quot;, &quot;outcome&quot; (default), &quot;dispersion&quot;, or &quot;correlation&quot;. If multiple parts are provided, only the &quot;outcome&quot; part will be returned.</p>
</td></tr>
<tr><td><code id="fitted.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to or from other methods. These are not used in this method but must be included to match the generic method signature.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> If <code>part</code> is &quot;selection&quot;, the function returns the fitted values from the selection part of the model.
</p>
</li>
<li><p> If <code>part</code> is &quot;outcome&quot;, the function returns the fitted values from the outcome part of the model.
</p>
</li>
<li><p> If <code>part</code> is &quot;dispersion&quot;, the function returns the fitted values from the dispersion part of the model.
</p>
</li>
<li><p> If <code>part</code> is &quot;correlation&quot;, the function returns the fitted values from the correlation part of the model.
</p>
</li></ul>

<p>If <code>part</code> is not one of the specified options, an error will be raised. If multiple parts are provided, the function defaults to returning the fitted values for the outcome part of the model.
</p>


<h3>Value</h3>

<p>A vector of fitted values corresponding to the specified part of the <code>heckmanGE</code> model. The type of the returned values depends on the part specified.
</p>

<hr>
<h2 id='heckmanGE'>heckmanGE: A Package for Fitting Sample Selection Models</h2><span id='topic+heckmanGE'></span>

<h3>Description</h3>

<p>This package provides functions for fitting sample selection models,
specifically the Heckman-Ge model. It includes functionality for specifying
selection and outcome equations, as well as adjusting parameters for dispersion
and correlation.
</p>
<p>Estimates the parameters of the Generalized Heckman model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heckmanGE(
  selection,
  outcome,
  dispersion,
  correlation,
  data = sys.frame(sys.parent()),
  weights = NULL,
  cluster = NULL,
  start = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="heckmanGE_+3A_selection">selection</code></td>
<td>
<p>A formula. Selection equation.</p>
</td></tr>
<tr><td><code id="heckmanGE_+3A_outcome">outcome</code></td>
<td>
<p>A formula. Outcome Equation.</p>
</td></tr>
<tr><td><code id="heckmanGE_+3A_dispersion">dispersion</code></td>
<td>
<p>A right-handed formula. The equation for fitting of the
Dispersion Parameter.</p>
</td></tr>
<tr><td><code id="heckmanGE_+3A_correlation">correlation</code></td>
<td>
<p>A right-handed formula. The equation for fitting of the
Correlation Parameter.</p>
</td></tr>
<tr><td><code id="heckmanGE_+3A_data">data</code></td>
<td>
<p>A data.frame.</p>
</td></tr>
<tr><td><code id="heckmanGE_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process.
Should be NULL or a numeric vector.</p>
</td></tr>
<tr><td><code id="heckmanGE_+3A_cluster">cluster</code></td>
<td>
<p>a variable indicating the clustering of observations, a list
(or data.frame) thereof, or a formula specifying which variables from the
fitted model should be used. See documentation for sandwich::vcovCL. A formula
or list specifying the clusters for robust standard errors. Clustering adjusts
the standard errors by accounting for correlations within clusters.</p>
</td></tr>
<tr><td><code id="heckmanGE_+3A_start">start</code></td>
<td>
<p>Optional. A numeric vector with the initial values for the
parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optimized Function for fitting the Generalized Heckman Model
</p>
<p>(original version: package ssmodels. Modified by Rogerio Barbosa)
</p>
<p>The heckmanGE() function fits a generalization of the Heckman sample
selection model, allowing sample selection bias and dispersion parameters
to depend on covariates.
The <code>heckmanGE()</code> function fits a generalization of the Heckman sample
selection model, and is compatible with robust variance-covariance estimation
using packages such as <span class="pkg">sandwich</span>. In particular, the
<code><a href="sandwich.html#topic+vcovCL">vcovCL</a></code> function can be used for clustering, which
adjusts the standard errors by accounting for intra-cluster correlations in the data.
</p>


<h3>Value</h3>

<p>A list of results from the fitted model, including parameter estimates,
the Hessian matrix, number of observations, and other relevant statistics. If
initial values are not provided, the function estimates them using the Heckman
two-step method.
</p>
<p>A list containing:
</p>

<dl>
<dt>call</dt><dd><p>The matched function call.</p>
</dd>
<dt>coefficients</dt><dd><p>Estimated coefficients for the selection, outcome,
dispersion, and correlation equations.</p>
</dd>
<dt>vcov</dt><dd><p>The covariance matrix of the estimated coefficients.</p>
</dd>
<dt>logLik</dt><dd><p>The log-likelihood of the fitted model.</p>
</dd>
<dt>model.frames</dt><dd><p>List of model frames for each equation (selection, outcome,
dispersion, and correlation).</p>
</dd>
<dt>fitted.values</dt><dd><p>Fitted values of the outcome equation.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Fernando de Souza Bastos
</p>


<h3>See Also</h3>

<p><code><a href="sandwich.html#topic+vcovCL">vcovCL</a></code> for computing robust standard errors with clustering.
The function is compatible with the <span class="pkg">sandwich</span> package for estimating
heteroskedasticity-consistent and cluster-robust standard errors.
This can be useful for adjusting the standard errors when dealing with grouped
or clustered data. For more details, see the documentation for
<code><a href="sandwich.html#topic+vcovCL">vcovCL</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
selectEq  &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
dispersion  &lt;- ~ age + female + totchr + ins
correlation  &lt;- ~ age
fit &lt;- heckmanGE(selection = selectEq,
                 outcome = outcomeEq,
                 dispersion = dispersion,
                 correlation = correlation,
                 data = MEPS2001)
summary(fit)
</code></pre>

<hr>
<h2 id='meat.heckmanGE'>meat.heckmanGE
Compute Meat of the Covariance Matrix for the Generalized Heckman Model</h2><span id='topic+meat.heckmanGE'></span>

<h3>Description</h3>

<p>This function calculates the &quot;meat&quot; of the covariance matrix for a <code>heckmanGE</code> model. The &quot;meat&quot; refers to the part of the covariance matrix that is not accounted for by the model's fixed components. This is typically used in conjunction with the &quot;bread&quot; component to form a robust covariance matrix estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meat.heckmanGE(x, adjust = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meat.heckmanGE_+3A_x">x</code></td>
<td>
<p>An object of class <code>heckmanGE</code>. This object should be a fitted model for which the covariance matrix is to be computed.</p>
</td></tr>
<tr><td><code id="meat.heckmanGE_+3A_adjust">adjust</code></td>
<td>
<p>A logical value indicating whether to apply a small-sample correction to the covariance matrix. If <code>TRUE</code>, the matrix is adjusted by multiplying it by <code>n / (n - k)</code>, where <code>n</code> is the number of observations and <code>k</code> is the number of parameters.</p>
</td></tr>
<tr><td><code id="meat.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>estfun.heckmanGE</code>, which computes the estimating functions used in the calculation.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The function calculates the covariance matrix based on the estimating functions obtained from <code>estfun.heckmanGE</code>.
</p>
</li>
<li><p> The &quot;meat&quot; is calculated as the cross-product of the estimating functions, divided by the number of observations. If <code>adjust</code> is <code>TRUE</code>, a small-sample correction is applied.
</p>
</li></ul>



<h3>Value</h3>

<p>A matrix representing the &quot;meat&quot; of the covariance matrix. The dimensions and row/column names of the matrix correspond to the number of parameters in the model.
</p>

<hr>
<h2 id='meatCL.heckmanGE'>meatCL.heckmanGE
Compute the Meat Matrix for a Heckman-Ge Model with Clustering</h2><span id='topic+meatCL.heckmanGE'></span>

<h3>Description</h3>

<p>This function calculates the meat matrix for a Heckman-Ge model, which is used in the context of clustered standard errors. The meat matrix represents the variability of the estimated parameters and is a crucial component for robust inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meatCL.heckmanGE(
  x,
  cluster = NULL,
  type = NULL,
  cadjust = TRUE,
  multi0 = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meatCL.heckmanGE_+3A_x">x</code></td>
<td>
<p>An object of class <code>heckmanGE</code> containing the results from a Heckman-Ge model fit.</p>
</td></tr>
<tr><td><code id="meatCL.heckmanGE_+3A_cluster">cluster</code></td>
<td>
<p>A vector or a data frame specifying the cluster variable(s). If <code>NULL</code>, the default clustering variable is used.</p>
</td></tr>
<tr><td><code id="meatCL.heckmanGE_+3A_type">type</code></td>
<td>
<p>The type of heteroscedasticity-consistent (HC) estimator to use. Options are &quot;HC0&quot;, &quot;HC1&quot;, &quot;HC2&quot;, or &quot;HC3&quot;. Defaults to &quot;HC0&quot;.</p>
</td></tr>
<tr><td><code id="meatCL.heckmanGE_+3A_cadjust">cadjust</code></td>
<td>
<p>A logical value indicating whether to adjust for the number of clusters. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="meatCL.heckmanGE_+3A_multi0">multi0</code></td>
<td>
<p>A logical value indicating whether to include a column of ones in the cluster variable matrix. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="meatCL.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix representing the meat component of the robust covariance matrix estimator for the Heckman-Ge model.
</p>

<hr>
<h2 id='MEPS2001'>Medical Expenditure Panel Survey (MEPS) Data</h2><span id='topic+MEPS2001'></span>

<h3>Description</h3>

<p>The MEPS dataset contains large-scale survey data from the United States,
focusing on health services usage, costs, and insurance coverage. This dataset
is restricted to individuals aged 21 to 64 years. It includes outpatient cost
data with some zero expenditure values for model adjustment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MEPS2001
</code></pre>


<h3>Format</h3>

<p>A data frame with 3328 observations on the following variables:
</p>

<ul>
<li><p>educ: Education status (numeric)
</p>
</li>
<li><p>age: Age (numeric)
</p>
</li>
<li><p>income: Income (numeric)
</p>
</li>
<li><p>female: Gender (binary)
</p>
</li>
<li><p>vgood: Self-reported health status, very good (numeric)
</p>
</li>
<li><p>good: Self-reported health status, good (numeric)
</p>
</li>
<li><p>hospexp: Hospital expenditures (numeric)
</p>
</li>
<li><p>totchr: Total number of chronic diseases (numeric)
</p>
</li>
<li><p>ffs: Family support (numeric)
</p>
</li>
<li><p>dhospexp: Dummy variable for hospital expenditures (binary)
</p>
</li>
<li><p>age2: Age squared (numeric)
</p>
</li>
<li><p>agefem: Interaction between age and gender (numeric)
</p>
</li>
<li><p>fairpoor: Self-reported health status, fair or poor (numeric)
</p>
</li>
<li><p>year01: Year of survey (numeric)
</p>
</li>
<li><p>instype: Type of insurance (numeric)
</p>
</li>
<li><p>ambexp: Ambulatory expenditures (numeric)
</p>
</li>
<li><p>lambexp: Log of ambulatory expenditures (numeric)
</p>
</li>
<li><p>blhisp: Ethnicity (binary)
</p>
</li>
<li><p>instype_s1: Insurance type, version 1 (numeric)
</p>
</li>
<li><p>dambexp: Dummy variable for ambulatory expenditures (binary)
</p>
</li>
<li><p>lnambx: Log-transformed ambulatory expenditures (numeric)
</p>
</li>
<li><p>ins: Insurance status (binary)
</p>
</li></ul>



<h3>Source</h3>

<p>2001 Medical Expenditure Panel Survey by the Agency for Healthcare
Research and Quality.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
selectEq  &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
dispersion  &lt;- ~ age + female + totchr + ins
correlation  &lt;- ~ age
fit &lt;- heckmanGE(selection = selectEq,
                outcome = outcomeEq,
                dispersion = dispersion,
                correlation = correlation,
                data = MEPS2001)
summary(fit)
</code></pre>

<hr>
<h2 id='model.frame.heckmanGE'>model.frame.heckmanGE
Get the Model Frames of a Generalized Heckman Regression</h2><span id='topic+model.frame.heckmanGE'></span>

<h3>Description</h3>

<p>Extracts the model frames for different parts of a <code>heckmanGE</code> model. The model frames include the data used in the regression analysis for each component of the Generalized Heckman Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckmanGE'
model.frame(
  formula,
  part = c("selection", "outcome", "dispersion", "correlation"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model.frame.heckmanGE_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>heckmanGE</code>. This object should be a fitted model from which the model frames will be extracted.</p>
</td></tr>
<tr><td><code id="model.frame.heckmanGE_+3A_part">part</code></td>
<td>
<p>A character vector specifying the model part for which to extract the model frame. Options include &quot;selection&quot;, &quot;outcome&quot;, &quot;dispersion&quot;, and &quot;correlation&quot;. The default is &quot;outcome&quot;. If multiple parts are specified, only the &quot;outcome&quot; part will be returned.</p>
</td></tr>
<tr><td><code id="model.frame.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to or from other methods. These are not used in this method but must be included to match the generic method signature.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The function extracts the model frame corresponding to the specified part of the <code>heckmanGE</code> model.
</p>
</li>
<li><p> If the <code>part</code> argument is not specified correctly or includes multiple parts, the function defaults to returning the model frame for the &quot;outcome&quot; part.
</p>
</li></ul>



<h3>Value</h3>

<p>A model frame for the specified part of the <code>heckmanGE</code> object. If <code>part</code> is not one of the valid options, an error is raised.
</p>

<hr>
<h2 id='model.matrix.heckmanGE'>model.matrix.heckmanGE
Get the Design Matrices of a Generalized Heckman Regression</h2><span id='topic+model.matrix.heckmanGE'></span>

<h3>Description</h3>

<p>Extracts the design matrices for different parts of a <code>heckmanGE</code> model. The design matrices include the predictors used in the regression analysis for each component of the Generalized Heckman Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckmanGE'
model.matrix(
  object,
  part = c("selection", "outcome", "dispersion", "correlation"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model.matrix.heckmanGE_+3A_object">object</code></td>
<td>
<p>An object of class <code>heckmanGE</code>. This object should be a fitted model from which the design matrices will be extracted.</p>
</td></tr>
<tr><td><code id="model.matrix.heckmanGE_+3A_part">part</code></td>
<td>
<p>A character vector specifying the model part for which to extract the design matrix. Options include &quot;selection&quot;, &quot;outcome&quot;, &quot;dispersion&quot;, and &quot;correlation&quot;. The default is &quot;outcome&quot;. If multiple parts are specified, only the &quot;outcome&quot; part will be returned.</p>
</td></tr>
<tr><td><code id="model.matrix.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to or from other methods. These are not used in this method but must be included to match the generic method signature.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The function extracts the design matrix corresponding to the specified part of the <code>heckmanGE</code> model.
</p>
</li>
<li><p> If the <code>part</code> argument is not specified correctly or includes multiple parts, the function defaults to returning the design matrix for the &quot;outcome&quot; part.
</p>
</li></ul>



<h3>Value</h3>

<p>A design matrix for the specified part of the <code>heckmanGE</code> object. If <code>part</code> is not one of the valid options, an error is raised.
</p>

<hr>
<h2 id='pnadC_y2024q2'>PNAD Continua de 2024, 2 trimestre</h2><span id='topic+pnadC_y2024q2'></span>

<h3>Description</h3>

<p>The Continuous National Household Sample Survey (PNAD Continua)
for the second quarter of 2024 is an important source of
statistical data in Brazil, conducted by the Brazilian Institute
of Geography and Statistics (IBGE). The survey aims to provide
up-to-date information on the socioeconomic characteristics of
the Brazilian population, covering topics such as employment,
income, education, and other crucial aspects for the formulation
of public policies and economic and social studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pnadC_y2024q2
</code></pre>


<h3>Format</h3>

<p>A data frame with 326018 observations on the following variables:
</p>

<ul>
<li><p>PSU: Primary Sampling Unit identifier (factor)
</p>
</li>
<li><p>weight: Survey weight (numeric)
</p>
</li>
<li><p>age: Age of the respondent (numeric)
</p>
</li>
<li><p>participation: Labor force participation status (factor)
</p>
</li>
<li><p>male: Male indicator (binary)
</p>
</li>
<li><p>white: White indicator (binary)
</p>
</li>
<li><p>hhold_head: Household head indicator (binary)
</p>
</li>
<li><p>hhold_spouse: Spouse of household head indicator (binary)
</p>
</li>
<li><p>yearsSchooling: Total years of schooling completed (numeric)
</p>
</li>
<li><p>classWorker_employer: Employer indicator (binary)
</p>
</li>
<li><p>classWorker_selfEmployed: Self-employed indicator (binary)
</p>
</li>
<li><p>ln_salary: Natural logarithm of salary (numeric)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(pnadC_y2024q2)
attach(pnadC_y2024q2)
selectEq  &lt;- participation ~ age + I(age^2) +
 male + white + yearsSchooling +
 hhold_head + hhold_spouse
outcomeEq &lt;- ln_salary ~ age + I(age^2) +
 male + white + yearsSchooling +
 classWorker_employer + classWorker_selfEmployed
outcomeD  &lt;- ~ age + I(age^2) +
 male + white + yearsSchooling +
 classWorker_employer + classWorker_selfEmployed
outcomeC  &lt;- ~ male + yearsSchooling
fit_heckmanGE &lt;- heckmanGE(selection   = selectEq,
                           outcome     = outcomeEq,
                           dispersion  = outcomeD,
                           correlation = outcomeC,
                           data = pnadC_y2024q2,
                           weights = weight,
                           cluster = ~PSU)
                           summary(fit_heckmanGE)
</code></pre>

<hr>
<h2 id='predict.heckmanGE'>predict.heckmanGE
Predictions from the Generalized Heckman Model</h2><span id='topic+predict.heckmanGE'></span>

<h3>Description</h3>

<p>Generates predictions from a fitted <code>heckmanGE</code> model. Predictions can be made on the scale of the linear predictors or on the scale of the response variable. The function can also return confidence intervals for the predictions if requested.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckmanGE'
predict(
  object,
  ...,
  part = c("selection", "outcome", "dispersion", "correlation"),
  newdata = NULL,
  type = c("link", "response"),
  cofint = FALSE,
  confidence_level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.heckmanGE_+3A_object">object</code></td>
<td>
<p>An object of class <code>heckmanGE</code>. This object should be a fitted model from which predictions will be made.</p>
</td></tr>
<tr><td><code id="predict.heckmanGE_+3A_...">...</code></td>
<td>
<p>Argumentos adicionais passados para métodos específicos. Este argumento é mantido para compatibilidade com a função genérica <code>predict</code>.</p>
</td></tr>
<tr><td><code id="predict.heckmanGE_+3A_part">part</code></td>
<td>
<p>A character vector specifying the model part for which to make predictions. Options include &quot;selection&quot;, &quot;outcome&quot;, &quot;dispersion&quot;, and &quot;correlation&quot;. The default is &quot;outcome&quot;. If multiple parts are specified, only the &quot;outcome&quot; part will be used.</p>
</td></tr>
<tr><td><code id="predict.heckmanGE_+3A_newdata">newdata</code></td>
<td>
<p>Optionally, a data frame containing new data for making predictions. If omitted, the function uses the fitted linear predictors from the model object.</p>
</td></tr>
<tr><td><code id="predict.heckmanGE_+3A_type">type</code></td>
<td>
<p>The type of prediction required. The default is &quot;link&quot;, which returns predictions on the scale of the linear predictors. If &quot;response&quot; is specified, predictions are returned on the scale of the response variable after applying the inverse link function.</p>
</td></tr>
<tr><td><code id="predict.heckmanGE_+3A_cofint">cofint</code></td>
<td>
<p>A logical indicating whether to return confidence intervals for the predictions. Default is FALSE.</p>
</td></tr>
<tr><td><code id="predict.heckmanGE_+3A_confidence_level">confidence_level</code></td>
<td>
<p>A numeric value specifying the confidence level for the confidence intervals if <code>cofint</code> is TRUE. Default is 0.95.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The function first checks the validity of the <code>part</code> and <code>type</code> arguments.
</p>
</li>
<li><p> If <code>newdata</code> is provided, the function ensures it matches the variables and structure of the original model frame.
</p>
</li>
<li><p> Predictions can be on the link scale or the response scale, depending on the <code>type</code> argument.
</p>
</li>
<li><p> Confidence intervals are calculated if <code>cofint</code> is TRUE, using the standard errors derived from the model.
</p>
</li></ul>



<h3>Value</h3>

<p>A vector or matrix of predictions from the <code>heckmanGE</code> object, depending on the value of <code>cofint</code>. If <code>cofint</code> is TRUE, the function returns a matrix with the mean predicted value, and the lower and upper bounds of the confidence interval.
</p>

<hr>
<h2 id='print.heckmanGE'>print.heckmanGE
Print of Generalized Heckman Model Results</h2><span id='topic+print.heckmanGE'></span>

<h3>Description</h3>

<p>Prints a summary of the results from a fitted <code>heckmanGE</code> model, including estimates for different model components, log-likelihood, AIC, BIC, and other relevant statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckmanGE'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.heckmanGE_+3A_x">x</code></td>
<td>
<p>An x of class <code>heckmanGE</code>. This x should be a fitted model whose results are to be printed.</p>
</td></tr>
<tr><td><code id="print.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints the estimates and statistics of the Generalized Heckman model to the console.
</p>

<hr>
<h2 id='residuals.heckmanGE'>residuals.heckmanGE
Extract Residuals of the Generalized Heckman Model</h2><span id='topic+residuals.heckmanGE'></span>

<h3>Description</h3>

<p>Extracts residuals from a fitted <code>heckmanGE</code> model for a specified model component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckmanGE'
residuals(object, part = c("selection", "outcome"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.heckmanGE_+3A_object">object</code></td>
<td>
<p>An object of class <code>heckmanGE</code>. This object should be a fitted model from which residuals are to be extracted.</p>
</td></tr>
<tr><td><code id="residuals.heckmanGE_+3A_part">part</code></td>
<td>
<p>A character vector specifying which model component's residuals to return: either 'selection' or 'outcome'. Defaults to 'outcome'.</p>
</td></tr>
<tr><td><code id="residuals.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to or from other methods. These are not used in this method but must be included to match the generic method signature.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of residuals extracted from the specified part of the <code>heckmanGE</code> model.
</p>

<hr>
<h2 id='sandwich.heckmanGE'>sandwich.heckmanGE
Sandwich Estimator for Generalized Heckman Model</h2><span id='topic+sandwich.heckmanGE'></span>

<h3>Description</h3>

<p>Computes the sandwich estimator of the variance-covariance matrix for the <code>heckmanGE</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sandwich.heckmanGE(x, bread. = bread.heckmanGE, meat. = meat.heckmanGE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sandwich.heckmanGE_+3A_x">x</code></td>
<td>
<p>An object of class <code>heckmanGE</code> representing a fitted Generalized Heckman model.</p>
</td></tr>
<tr><td><code id="sandwich.heckmanGE_+3A_bread.">bread.</code></td>
<td>
<p>A function to compute the &quot;bread&quot; part of the sandwich estimator. Defaults to <code>bread.heckmanGE</code>.</p>
</td></tr>
<tr><td><code id="sandwich.heckmanGE_+3A_meat.">meat.</code></td>
<td>
<p>A function to compute the &quot;meat&quot; part of the sandwich estimator. Defaults to <code>meat.heckmanGE</code>.</p>
</td></tr>
<tr><td><code id="sandwich.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>meat.</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A variance-covariance matrix for the <code>heckmanGE</code> model, computed using the sandwich estimator.
</p>

<hr>
<h2 id='simulation'>Simulation dataset for the heckmanGE example</h2><span id='topic+simulation'></span>

<h3>Description</h3>

<p>This dataset contains simulated data used to illustrate the functionality
of the heckmanGE model. The data includes variables used in selection, outcome,
dispersion, and correlation equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation
</code></pre>


<h3>Format</h3>

<p>A data frame with 10,000 observations on the following variables:
</p>

<ul>
<li><p>y_o: Outcome variable from the simulated model (numeric)
</p>
</li>
<li><p>y_s: Selection indicator, 1 if selected, 0 otherwise (binary)
</p>
</li>
<li><p>prob_s: Probability of selection (numeric)
</p>
</li>
<li><p>x1: Simulated predictor from a normal distribution (numeric)
</p>
</li>
<li><p>x2: Simulated predictor from a Poisson distribution (numeric)
</p>
</li>
<li><p>x3: Simulated binary predictor (binary)
</p>
</li>
<li><p>x4: Simulated predictor from a normal distribution with mean 2 and sd 2 (numeric)
</p>
</li>
<li><p>x5: Simulated predictor from a Poisson distribution with lambda 1.5 (numeric)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(simulation)
selectEq  &lt;- y_s ~ x1 + x2 + x4
outcomeEq &lt;- y_o ~ x1 + x2 + x3
outcomeD  &lt;- ~ x1 + x5
outcomeC  &lt;- ~ x3 + x4
fit_heckmanGE &lt;- heckmanGE(selection   = selectEq,
                           outcome     = outcomeEq,
                           dispersion  = outcomeD,
                           correlation = outcomeC,
                           data = simulation)
summary(fit_heckmanGE)
</code></pre>

<hr>
<h2 id='step2'>step2: Two-Step Estimation Function</h2><span id='topic+step2'></span>

<h3>Description</h3>

<p>This function performs a two-step estimation process, commonly used in models that require correction for sample selection bias. It estimates parameters for selection, outcome, and dispersion equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step2(YS, XS, YO, XO, Msigma, Mrho, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step2_+3A_ys">YS</code></td>
<td>
<p>A binary numeric vector indicating selection (1 if selected, 0 otherwise).</p>
</td></tr>
<tr><td><code id="step2_+3A_xs">XS</code></td>
<td>
<p>A numeric matrix of covariates for the selection equation. Rows correspond to observations and columns to covariates.</p>
</td></tr>
<tr><td><code id="step2_+3A_yo">YO</code></td>
<td>
<p>A numeric vector of observed outcomes for the selected sample (where <code>YS == 1</code>).</p>
</td></tr>
<tr><td><code id="step2_+3A_xo">XO</code></td>
<td>
<p>A numeric matrix of covariates for the outcome equation. Rows correspond to selected observations.</p>
</td></tr>
<tr><td><code id="step2_+3A_msigma">Msigma</code></td>
<td>
<p>A numeric matrix of covariates for the dispersion equation.</p>
</td></tr>
<tr><td><code id="step2_+3A_mrho">Mrho</code></td>
<td>
<p>A numeric matrix of covariates for the correlation structure equation.</p>
</td></tr>
<tr><td><code id="step2_+3A_w">w</code></td>
<td>
<p>A numeric vector of weights to be used in the estimation process.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements a two-step estimation method for models with sample
selection bias. The process begins by estimating the selection equation using
a probit model to model the probability of selection. The Inverse Mills Ratio (IMR)
is computed from the probit model and added as a covariate in the outcome and
dispersion equations to correct for sample selection bias.
</p>
<p>The outcome equation is estimated using weighted least squares (WLS), where
the residuals are used to estimate the dispersion equation. Additionally,
initial estimates for the correlation structure are computed based on the
fitted values from the outcome equation.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>selection</code></td>
<td>
<p>Estimated coefficients for the selection equation (probit model).</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>Estimated coefficients for the outcome equation (weighted least squares).</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p>Estimated coefficients for the dispersion equation (log of residual variance).</p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>
<p>Initial guesses for the coefficients in the correlation structure.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code> for computing robust standard errors.
</p>

<hr>
<h2 id='summary.heckmanGE'>summary.heckmanGE
Summary of Generalized Heckman Model</h2><span id='topic+summary.heckmanGE'></span>

<h3>Description</h3>

<p>Provides a summary of the parameters and diagnostic information from a fitted Generalized Heckman model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckmanGE'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.heckmanGE_+3A_object">object</code></td>
<td>
<p>An object of class <code>heckmanGE</code> representing a fitted Generalized Heckman model.</p>
</td></tr>
<tr><td><code id="summary.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a detailed summary of the fitted Generalized Heckman model, including parameter estimates, standard errors, model fit statistics, and optimization details.
</p>

<hr>
<h2 id='vcov.heckmanGE'>vcov.heckmanGE
Variance-Covariance Matrix of the Generalized Heckman Model</h2><span id='topic+vcov.heckmanGE'></span>

<h3>Description</h3>

<p>Extracts the variance-covariance matrix of the coefficients for the Generalized Heckman model.
The matrix can be for specific parts of the model or the complete matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckmanGE'
vcov(
  object,
  part = c("selection", "outcome", "dispersion", "correlation"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.heckmanGE_+3A_object">object</code></td>
<td>
<p>An object of class <code>heckmanGE</code> representing a fitted Generalized Heckman model.</p>
</td></tr>
<tr><td><code id="vcov.heckmanGE_+3A_part">part</code></td>
<td>
<p>A character vector specifying the parts of the model to include in the variance-covariance matrix.
Options are &quot;selection&quot;, &quot;outcome&quot;, &quot;dispersion&quot;, and &quot;correlation&quot;.
By default, the function returns the complete variance-covariance matrix for all parts.</p>
</td></tr>
<tr><td><code id="vcov.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to or from other methods. These are not used in this method but must be included to match the generic method signature.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A variance-covariance matrix of the coefficients for the specified parts of the Generalized Heckman model.
</p>

<hr>
<h2 id='vcovCL.heckmanGE'>Variance-Covariance with Cluster Correction for Heckman Models</h2><span id='topic+vcovCL.heckmanGE'></span>

<h3>Description</h3>

<p>The <code>vcovCL.heckmanGE</code> function computes the variance-covariance matrix of a Heckman model,
applying a cluster correction. This is useful for obtaining robust variance estimates, especially
when there is within-group dependence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vcovCL.heckmanGE(
  x,
  cluster = NULL,
  type = NULL,
  sandwich = TRUE,
  fix = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcovCL.heckmanGE_+3A_x">x</code></td>
<td>
<p>An object resulting from the estimation of a Heckman model using the <code>heckmanGE</code> method.</p>
</td></tr>
<tr><td><code id="vcovCL.heckmanGE_+3A_cluster">cluster</code></td>
<td>
<p>A vector or factor identifying clusters in the data. If NULL, assumes no clustering.</p>
</td></tr>
<tr><td><code id="vcovCL.heckmanGE_+3A_type">type</code></td>
<td>
<p>A character string specifying the type of cluster correction to be applied. It can be
<code>"HC0"</code>, <code>"HC1"</code>, <code>"HC2"</code>, or <code>"HC3"</code>.</p>
</td></tr>
<tr><td><code id="vcovCL.heckmanGE_+3A_sandwich">sandwich</code></td>
<td>
<p>A logical value. If TRUE, the function applies the sandwich estimator to the
variance-covariance matrix.</p>
</td></tr>
<tr><td><code id="vcovCL.heckmanGE_+3A_fix">fix</code></td>
<td>
<p>A logical value. If TRUE, corrects any negative eigenvalues in the variance-covariance matrix.</p>
</td></tr>
<tr><td><code id="vcovCL.heckmanGE_+3A_...">...</code></td>
<td>
<p>Additional arguments that can be passed to internal methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a specialized implementation for obtaining a robust variance-covariance matrix
from Heckman models estimated with <code>heckmanGE</code>. It allows for cluster correction, which is particularly
important in contexts where observations within groups may not be independent.
</p>


<h3>Value</h3>

<p>A corrected variance-covariance matrix.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+meatCL.heckmanGE">meatCL.heckmanGE()</a></code>, <code><a href="#topic+sandwich.heckmanGE">sandwich.heckmanGE()</a></code>, <code><a href="#topic+bread.heckmanGE">bread.heckmanGE()</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
