<!DOCTYPE html><html><head><title>Help for package desirability2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {desirability2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#classification_results'><p>Classification results</p></a></li>
<li><a href='#d_overall'><p>Determine overall desirability</p></a></li>
<li><a href='#desirability2-package'><p>In-line desirability functions</p></a></li>
<li><a href='#inline_desirability'><p>Desirability functions for in-line computations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Desirability Functions for Multiparameter Optimization</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>In-line functions for multivariate optimization via desirability 
    functions (Derringer and Suich, 1980, &lt;<a href="https://doi.org/10.1080%2F00224065.1980.11980968">doi:10.1080/00224065.1980.11980968</a>&gt;)
    with easy use within 'dplyr' pipelines.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://desirability2.tidymodels.org">https://desirability2.tidymodels.org</a>,
<a href="https://github.com/tidymodels/desirability2">https://github.com/tidymodels/desirability2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>glue, purrr, rlang, stats, tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, dplyr, ggplot2, spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-10 16:04:01 UTC; max</td>
</tr>
<tr>
<td>Author:</td>
<td>Max Kuhn <a href="https://orcid.org/0000-0003-2402-136X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Posit Software, PBC [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Max Kuhn &lt;max@posit.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-11 09:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='classification_results'>Classification results</h2><span id='topic+classification_results'></span>

<h3>Description</h3>

<p>These data are a variation of a case study at <code>tidymodels.org</code> where a
penalized regression model was used for a binary classification task. The
outcome metrics in <code>classification_results</code> are the areas under the ROC and
PR curve, log-likelihood, and the number of predictors selected for a given
amount of penalization. Two tuning parameters, <code>mixture</code> and <code>penalty</code>, were
varied across 300 conditions.
</p>


<h3>Value</h3>

<table>
<tr><td><code>classification_results</code></td>
<td>
<p>a tibble</p>
</td></tr>
</table>


<h3>Source</h3>

<p>See the <code>example-data</code> directory in the package with code that is a variation
of the analysis shown at <a href="https://www.tidymodels.org/start/case-study/">https://www.tidymodels.org/start/case-study/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(classification_results)
</code></pre>

<hr>
<h2 id='d_overall'>Determine overall desirability</h2><span id='topic+d_overall'></span>

<h3>Description</h3>

<p>Once desirability columns have been created, determine the overall
desirability using a mean (geometric by default).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_overall(..., geometric = TRUE, tolerance = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_overall_+3A_...">...</code></td>
<td>
<p>One or more unquoted expressions separated by commas. To choose
multiple columns using selectors, <code><a href="dplyr.html#topic+across">dplyr::across()</a></code> can be used (see the
example below).</p>
</td></tr>
<tr><td><code id="d_overall_+3A_geometric">geometric</code></td>
<td>
<p>A logical for whether the geometric or arithmetic mean
should be used to summarize the columns.</p>
</td></tr>
<tr><td><code id="d_overall_+3A_tolerance">tolerance</code></td>
<td>
<p>A numeric value where values strictly less than this value
are capped at the value. For example, if users wish to use the geometric mean
without completely excluding settings, a value greater than zero can be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+d_max">d_max()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

# Choose model tuning parameters that minimize the number of predictors used
# while maximizing the area under the ROC curve.

classification_results %&gt;%
  mutate(
    d_feat = d_min(num_features, 1, 200),
    d_roc  = d_max(roc_auc, 0.5, 0.9),
    d_all  = d_overall(across(starts_with("d_")))
  ) %&gt;%
  arrange(desc(d_all))

# Bias the ranking toward minimizing features by using a larger scale.

classification_results %&gt;%
  mutate(
    d_feat = d_min(num_features, 1, 200, scale = 3),
    d_roc  = d_max(roc_auc, 0.5, 0.9),
    d_all  = d_overall(across(starts_with("d_")))
  ) %&gt;%
  arrange(desc(d_all))

</code></pre>

<hr>
<h2 id='desirability2-package'>In-line desirability functions</h2><span id='topic+desirability2'></span><span id='topic+desirability2-package'></span>

<h3>Description</h3>

<p>Desirability functions (Derringer and Suich, 1980,
<a href="https://doi.org/10.1080/00224065.1980.11980968">doi:10.1080/00224065.1980.11980968</a>) can be used for multivariate
optimization.
</p>


<h3>Details</h3>

<p>See:
</p>

<ul>
<li> <p><code><a href="#topic+d_max">d_max()</a></code> for individual desirability functions.
</p>
</li>
<li> <p><code><a href="#topic+d_overall">d_overall()</a></code> for combining functions into an overall objective function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Max Kuhn <a href="mailto:max@posit.co">max@posit.co</a> (<a href="https://orcid.org/0000-0003-2402-136X">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Posit Software, PBC [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://desirability2.tidymodels.org">https://desirability2.tidymodels.org</a>
</p>
</li>
<li> <p><a href="https://github.com/tidymodels/desirability2">https://github.com/tidymodels/desirability2</a>
</p>
</li></ul>


<hr>
<h2 id='inline_desirability'>Desirability functions for in-line computations</h2><span id='topic+inline_desirability'></span><span id='topic+d_max'></span><span id='topic+d_min'></span><span id='topic+d_target'></span><span id='topic+d_box'></span><span id='topic+d_custom'></span><span id='topic+d_category'></span>

<h3>Description</h3>

<p>Desirability functions map some input to a <code style="white-space: pre;">&#8288;[0, 1]&#8288;</code> scale where zero is
unacceptable and one is most desirable. The mapping depends on the situation.
For example, <code>d_max()</code> increases desirability with the input while <code>d_min()</code>
does the opposite. See the plots in the examples to see more examples.
</p>
<p>Currently, only the desirability functions defined by Derringer and Suich
(1980) are implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_max(x, low, high, scale = 1, missing = NA_real_, use_data = FALSE)

d_min(x, low, high, scale = 1, missing = NA_real_, use_data = FALSE)

d_target(
  x,
  low,
  target,
  high,
  scale_low = 1,
  scale_high = 1,
  missing = NA_real_,
  use_data = FALSE
)

d_box(x, low, high, missing = NA_real_, use_data = FALSE)

d_custom(x, x_vals, desirability, missing = NA_real_)

d_category(x, categories, missing = NA_real_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inline_desirability_+3A_x">x</code></td>
<td>
<p>A vector of data to compute the desirability function</p>
</td></tr>
<tr><td><code id="inline_desirability_+3A_low">low</code>, <code id="inline_desirability_+3A_high">high</code>, <code id="inline_desirability_+3A_target">target</code></td>
<td>
<p>Single numeric values that define the active ranges of
desirability.</p>
</td></tr>
<tr><td><code id="inline_desirability_+3A_scale">scale</code>, <code id="inline_desirability_+3A_scale_low">scale_low</code>, <code id="inline_desirability_+3A_scale_high">scale_high</code></td>
<td>
<p>A single numeric value to rescale the
desirability function (each should be great than 0.0). Values &gt;1.0 make the
desirability more difficult to satisfy while smaller values make it easier
(see the examples below). <code>scale_low</code> and  <code>scale_high</code> do the same for
target functions with <code>scale_low</code> affecting the range below the <code>target</code>
value and <code>scale_high</code> affecting values greater than <code>target</code>.</p>
</td></tr>
<tr><td><code id="inline_desirability_+3A_missing">missing</code></td>
<td>
<p>A single numeric value on <code style="white-space: pre;">&#8288;[0, 1]&#8288;</code> (or <code>NA_real_</code>) that
defines how missing values in <code>x</code> are mapped to the desirability score.</p>
</td></tr>
<tr><td><code id="inline_desirability_+3A_use_data">use_data</code></td>
<td>
<p>Should the low, middle, and/or high values be derived from
the data (<code>x</code>) using the minimum, maximum, or median (respectively)?</p>
</td></tr>
<tr><td><code id="inline_desirability_+3A_x_vals">x_vals</code>, <code id="inline_desirability_+3A_desirability">desirability</code></td>
<td>
<p>Numeric vectors of the same length that define the
desirability results at specific values of <code>x</code>. Values below and above the
data in <code>x_vals</code> are given values of zero and one, respectively.</p>
</td></tr>
<tr><td><code id="inline_desirability_+3A_categories">categories</code></td>
<td>
<p>A named list of desirability values that match all
possible categories to specific desirability values. Data that are not
included in <code>categories</code> are given the value in <code>missing</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each function translates the values to desirability on <code style="white-space: pre;">&#8288;[0, 1]&#8288;</code>.
</p>


<h4>Equations</h4>



<h5>Maximization</h5>


<ul>
<li> <p><code>data &gt; high</code>: d = 1.0
</p>
</li>
<li> <p><code>data &lt; low</code>: d = 0.0
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;low &lt;= data &lt;= high&#8288;</code>: <code class="reqn">d = \left(\frac{data-low}{high-low}\right)^{scale}</code>
</p>
</li></ul>




<h5>Minimization</h5>


<ul>
<li> <p><code>data &gt; high</code>: d = 0.0
</p>
</li>
<li> <p><code>data &lt; low</code>: d = 1.0
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;low &lt;= data &lt;= high&#8288;</code>: <code class="reqn">d = \left(\frac{data = low}{low - high}\right)^{scale}</code>
</p>
</li></ul>




<h5>Target</h5>


<ul>
<li> <p><code>data &gt; high</code>: d = 0.0
</p>
</li>
<li> <p><code>data &lt; low</code>: d = 0.0
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;low &lt;= data &lt;= target&#8288;</code>: <code class="reqn">d = \left(\frac{data - low}{target - low}\right)^{scale\_low}</code>
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;target &lt;= data &lt;= high&#8288;</code>: <code class="reqn">d = \left(\frac{data - high}{target - high}\right)^{scale\_high}</code>
</p>
</li></ul>




<h5>Minimization</h5>


<ul>
<li> <p><code>data &gt; high</code>: d = 0.0
</p>
</li>
<li> <p><code>data &lt; low</code>: d = 0.0
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;low &lt;= data &lt;= high&#8288;</code>:d = 1.0
</p>
</li></ul>




<h5>Categories</h5>


<ul>
<li> <p><code>data = level</code>: d = 1.0
</p>
</li>
<li> <p><code>data != level</code>: d = 0.0
</p>
</li></ul>




<h5>Custom</h5>

<p>For the sequence of values given to the function, <code>d_custom()</code> will return
the desirability values that correspond to data matching values in <code>x_vals</code>.
Otherwise, linear interpolation is used for values in-between.
</p>




<h4>Data-Based Values</h4>

<p>By default, most of the <code style="white-space: pre;">&#8288;d_*()&#8288;</code> functions require specific user inputs for
arguments such as <code>low</code>, <code>target</code> and <code>high</code>. When <code>use_data = TRUE</code>, the
functions can use the minimum, median, and maximum values of the existing
data to estimate those values (respectively) but <em>only when users do not
specify them</em>.
</p>



<h3>Value</h3>

<p>A numeric vector on <code style="white-space: pre;">&#8288;[0, 1]&#8288;</code> where larger values are more
desirable.
</p>


<h3>References</h3>

<p>Derringer, G. and Suich, R. (1980), Simultaneous Optimization of
Several Response Variables. <em>Journal of Quality Technology</em>, 12, 214-219.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+d_overall">d_overall()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(ggplot2)

set.seed(1)
dat &lt;- tibble(x = sort(runif(30)), y = sort(runif(30)))
d_max(dat$x[1:10], 0.1, 0.75)

dat %&gt;%
  mutate(d_x = d_max(x, 0.1, 0.75))

set.seed(2)
tibble(z = sort(runif(100))) %&gt;%
  mutate(
    no_scale = d_max(z, 0.1, 0.75),
    easier   = d_max(z, 0.1, 0.75, scale = 1/2)
  ) %&gt;%
  ggplot(aes(x = z)) +
  geom_point(aes(y = no_scale)) +
  geom_line(aes(y = no_scale), alpha = .5) +
  geom_point(aes(y = easier), col = "blue") +
  geom_line(aes(y = easier), col = "blue", alpha = .5) +
  lims(x = 0:1, y = 0:1) +
  coord_fixed() +
  ylab("Desirability")

# ------------------------------------------------------------------------------
# Target example

dat %&gt;%
  mutate(
    triangle = d_target(x, 0.1, 0.5, 0.9, scale_low = 2, scale_high = 1/2)
  ) %&gt;%
  ggplot(aes(x = x, y = triangle)) +
  geom_point() +
  geom_line(alpha = .5) +
  lims(x = 0:1, y = 0:1) +
  coord_fixed() +
  ylab("Desirability")

# ------------------------------------------------------------------------------
# Box constraints

dat %&gt;%
  mutate(box = d_box(x, 1/4, 3/4)) %&gt;%
  ggplot(aes(x = x, y = box)) +
  geom_point() +
  geom_line(alpha = .5) +
  lims(x = 0:1, y = 0:1) +
  coord_fixed() +
  ylab("Desirability")

# ------------------------------------------------------------------------------
# Custom function

v_x &lt;- seq(0, 1, length.out = 20)
v_d &lt;- 1 - exp(-10 * abs(v_x - .5))

dat %&gt;%
  mutate(v = d_custom(x, v_x, v_d)) %&gt;%
  ggplot(aes(x = x, y = v)) +
  geom_point() +
  geom_line(alpha = .5) +
  lims(x = 0:1, y = 0:1) +
  coord_fixed() +
  ylab("Desirability")

# ------------------------------------------------------------------------------
# Qualitative data

set.seed(3)
groups &lt;- sort(runif(10))
names(groups) &lt;- letters[1:10]

tibble(x = letters[1:7]) %&gt;%
  mutate(d = d_category(x, groups)) %&gt;%
  ggplot(aes(x = x, y = d)) +
  geom_bar(stat = "identity") +
  lims(y = 0:1) +
  ylab("Desirability")

# ------------------------------------------------------------------------------
# Apply the same function to many columns at once (dplyr &gt; 1.0)

dat %&gt;%
  mutate(across(c(everything()), ~ d_min(., .2, .6), .names = "d_{col}"))

# ------------------------------------------------------------------------------
# Using current data

set.seed(9015)
tibble(z = c(0, sort(runif(20)), 1)) %&gt;%
  mutate(
    user_specified = d_max(z, 0.1, 0.75),
    data_driven   = d_max(z, use_data = TRUE)
  ) %&gt;%
  ggplot(aes(x = z)) +
  geom_point(aes(y = user_specified)) +
  geom_line(aes(y = user_specified), alpha = .5) +
  geom_point(aes(y = data_driven), col = "blue") +
  geom_line(aes(y = data_driven), col = "blue", alpha = .5) +
  lims(x = 0:1, y = 0:1) +
  coord_fixed() +
  ylab("Desirability")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
