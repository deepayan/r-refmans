<!DOCTYPE html><html><head><title>Help for package gcxgclab</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gcxgclab}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#align'><p>Reference Batch Align</p></a></li>
<li><a href='#batch_eic'><p>Finds batch of EICs</p></a></li>
<li><a href='#batch_ms'><p>Finds batch of mass spectra</p></a></li>
<li><a href='#batch_preprocess'><p>Batch reprocessing</p></a></li>
<li><a href='#bl_corr'><p>Baseline correction</p></a></li>
<li><a href='#comp_nist'><p>Compares MS to NIST MS database</p></a></li>
<li><a href='#comp_peaks'><p>Compare Peaks</p></a></li>
<li><a href='#extract_data'><p>Extracts data from cdf file.</p></a></li>
<li><a href='#find_eic'><p>Finds EICs</p></a></li>
<li><a href='#find_ms'><p>Finds MS</p></a></li>
<li><a href='#gauss'><p>1D Gaussian function</p></a></li>
<li><a href='#gauss_fit'><p>Fitting to Gaussian curve</p></a></li>
<li><a href='#gauss2'><p>2D Gaussian function</p></a></li>
<li><a href='#gauss2_fit'><p>Fitting to 2D Gaussian curve</p></a></li>
<li><a href='#mass_list'><p>Creates list of atomic mass data</p></a></li>
<li><a href='#nist_list'><p>Creates list of NIST data</p></a></li>
<li><a href='#non_targeted'><p>Compares MS to atomic mass data</p></a></li>
<li><a href='#phase_shift'><p>Phase shift</p></a></li>
<li><a href='#plot_chr'><p>Plot chromatogram</p></a></li>
<li><a href='#plot_defect'><p>Plots the Kendrick Mass Defect of a peak</p></a></li>
<li><a href='#plot_eic'><p>Plots the EICs</p></a></li>
<li><a href='#plot_gauss'><p>Plots a peak with the fitted Gaussian curve.</p></a></li>
<li><a href='#plot_gauss2'><p>Plots a 3D peak with the fitted Gaussian curve.</p></a></li>
<li><a href='#plot_ms'><p>Plots the mass spectra of a peak.</p></a></li>
<li><a href='#plot_nist'><p>Plots the mass spectra of a NIST compound.</p></a></li>
<li><a href='#plot_peak'><p>Peak Plot</p></a></li>
<li><a href='#plot_peakonly'><p>Plot only peaks</p></a></li>
<li><a href='#preprocess'><p>Preprocessing</p></a></li>
<li><a href='#smooth'><p>Smoothing</p></a></li>
<li><a href='#targeted'><p>Targeted Analysis</p></a></li>
<li><a href='#thr_peaks'><p>Threshold Peaks</p></a></li>
<li><a href='#top_peaks'><p>Top Peaks</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>GCxGC Preprocessing and Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides complete detailed preprocessing of two-dimensional gas chromatogram (GCxGC) samples. Baseline correction, smoothing, peak detection, and peak alignment. Also provided are some analysis functions, such as finding extracted ion chromatograms, finding mass spectral data, targeted analysis, and nontargeted analysis with either the 'National Institute of Standards and Technology Mass Spectral Library' or with the mass data. There are also several visualization methods provided for each step of the preprocessing and analysis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ncdf4 (&ge; 1.19.0), dplyr (&ge; 1.0.8), ggplot2 (&ge; 3.3.5), ptw
(&ge; 1.9.16), stats (&ge; 4.2.0), utils (&ge; 4.2.0), nilde (&ge;
1.1.6), zoo (&ge; 1.8.11), nls.multstart (&ge; 1.3.0), Rdpack (&ge;
2.4.0)</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-19 21:05:23 UTC; k9638</td>
</tr>
<tr>
<td>Author:</td>
<td>Stephanie Gamble <a href="https://orcid.org/0000-0001-7209-0891"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Mannion Joseph [ctb],
  Granger Caroline [ctb],
  Battelle Savannah River Alliance [cph],
  NNSA, US DOE [fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stephanie Gamble &lt;stephanie.gamble@srnl.doe.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-22 14:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='align'>Reference Batch Align</h2><span id='topic+align'></span>

<h3>Description</h3>

<p><code>align</code> aligns peaks from samples to a reference sample's
peaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>align(data_list, THR = 1e+05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="align_+3A_data_list">data_list</code></td>
<td>
<p>a <em>list</em> object. Data extracted from each cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="align_+3A_thr">THR</code></td>
<td>
<p>a <em>float</em> object. Threshold for peak intensity. Should be a
number between the baseline value and the highest peak intensity. Default
is THR = 100000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function aligns the peaks from any number of samples. Peaks are
aligned to the retention times of the first peak. If aligning to a reference
or standard sample, this should be the first in the lists for data frames and
for the mass data. The function comp_peaks() is used to find the
corresponding peaks. This function  will return a new list of TIC data frames
and a list of mass data. The first sample's data is unchanged, used as the
reference. Then a TIC data frame and mass data for each of the given samples
containing the peaks and time coordinates of the aligned peaks. The time
coordinates are aligned to the first sample's peaks, the peak height and MS
is unchanged.
</p>


<h3>Value</h3>

<p>A <em>list</em> object. List of aligned data from each cdf file and a
list of peaks that were aligned for each file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file1 &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
file2 &lt;- system.file("extdata","sample2.cdf",package="gcxgclab")
file3 &lt;- system.file("extdata","sample3.cdf",package="gcxgclab")
frame1 &lt;- extract_data(file1,mod_t=.5)
frame2 &lt;- extract_data(file2,mod_t=.5)
frame3 &lt;- extract_data(file3,mod_t=.5)
aligned &lt;- align(list(frame1,frame2,frame3))
plot_peak(aligned$Peaks$S1,aligned$S1,title="Reference Sample 1")
plot_peak(aligned$Peaks$S2,aligned$S2,title="Aligned Sample 2")
plot_peak(aligned$Peaks$S3,aligned$S3,title="Aligned Sample 3")

</code></pre>

<hr>
<h2 id='batch_eic'>Finds batch of EICs</h2><span id='topic+batch_eic'></span>

<h3>Description</h3>

<p><code>batch_eic</code> calculates the mass defect for each ion, then finds
each listed EICs of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batch_eic(data, MOIs, tolerance = 5e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batch_eic_+3A_data">data</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="batch_eic_+3A_mois">MOIs</code></td>
<td>
<p>a <em>vector</em> object. A vector containing a list of all masses
of interest to be investigated.</p>
</td></tr>
<tr><td><code id="batch_eic_+3A_tolerance">tolerance</code></td>
<td>
<p>a <em>double</em> object. The tolerance allowed for the MOI.
Default is 0.0005.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracted Ion Chromatogram (EIC) is a plot of intensity at a chosen
m/z value, or range of values, as a function of retention time.
This function uses find_eic() to find intensity values at the given
mass-to-charge (m/z) values, MOIs, and in a range around MOI given a
tolerance. Calculates the mass defect for each ion, then finds the specific
EICs of interest. Returns a data frame of time values, mass values, intensity
values,and mass defects.
</p>


<h3>Value</h3>

<p>eic_list, <em>list</em> object, containing <em>data.frame</em> objects.
Data frames of time values, mass values, intensity values, and mass defects
for each MOI listed in the input csv or txt file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file1 &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file1,mod_t=.5)
mois &lt;- c(92.1397, 93.07058)
eics &lt;- batch_eic(frame, MOIs=mois ,tolerance = 0.005)
for (i in 1:length(eics)){
   print(plot_eic(eics[[i]], title=paste("EIC for MOI",mois[i])))
   print(plot_eic(eics[[i]], title=paste("EIC for MOI",mois[i]), dim=2))
}

</code></pre>

<hr>
<h2 id='batch_ms'>Finds batch of mass spectra</h2><span id='topic+batch_ms'></span>

<h3>Description</h3>

<p><code>batch_ms</code> Finds batch of mass spectra of peaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batch_ms(data, t_peaks, tolerance = 5e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batch_ms_+3A_data">data</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="batch_ms_+3A_t_peaks">t_peaks</code></td>
<td>
<p>a <em>vector</em> object. A list of times at which the peaks of
interest are located in the overall time index for the sample.</p>
</td></tr>
<tr><td><code id="batch_ms_+3A_tolerance">tolerance</code></td>
<td>
<p>a <em>double</em> object. The tolerance allowed for the time
index. Default is 0.0005.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses find_ms() to find the mass spectra values of
a batch list of peaks in intensity values of a GCxGC sample at overall time
index values specified in a txt or csv file. It outputs a list of data
frames, for each peak, of the mass values and percent intensity values which
can then be plotted to product the mass spectra plot.
</p>


<h3>Value</h3>

<p>A <em>list</em> object of <em>data.frame</em> objects. Each a data frame
of the mass values and the percent intensity values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
mzs &lt;- batch_ms(frame, t_peaks = peaks$'T'[1:5])
for (i in 1:length(mzs)){
   print(plot_ms(mzs[[i]], title=paste('Mass Spectrum of peak', i)))
}

</code></pre>

<hr>
<h2 id='batch_preprocess'>Batch reprocessing</h2><span id='topic+batch_preprocess'></span>

<h3>Description</h3>

<p><code>batch_preprocess</code> performs full preprocessing on a batch of
data files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batch_preprocess(
  path = ".",
  mod_t = 10,
  shift = 0,
  lambda = 20,
  gamma = 0.5,
  subtract = NULL,
  THR = 10^5,
  images = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batch_preprocess_+3A_path">path</code></td>
<td>
<p>a <em>string</em> object. The path to the directory containing the
cdf files to be batch preprocessed and aligned.</p>
</td></tr>
<tr><td><code id="batch_preprocess_+3A_mod_t">mod_t</code></td>
<td>
<p>a <em>float</em> object. The modulation time for the GCxGC sample
analysis. Default is 10.</p>
</td></tr>
<tr><td><code id="batch_preprocess_+3A_shift">shift</code></td>
<td>
<p>a <em>float</em> object. The number of seconds to shift the phase
by. Default is 0 to skip shifting.</p>
</td></tr>
<tr><td><code id="batch_preprocess_+3A_lambda">lambda</code></td>
<td>
<p>a <em>float</em> object. A number (parameter in Whittaker
smoothing), suggested between 1 to 10^5. Small lambda is very little
smoothing, large lambda is very smooth. Default is lambda = 20.</p>
</td></tr>
<tr><td><code id="batch_preprocess_+3A_gamma">gamma</code></td>
<td>
<p>a <em>float</em> object. Correction factor between 0 and 1. 0
results in almost no values being subtracted to the baseline, 1 results in
almost everything except the peaks to be subtracted to the baseline. Default
is 0.5.</p>
</td></tr>
<tr><td><code id="batch_preprocess_+3A_subtract">subtract</code></td>
<td>
<p>a <em>data.frame</em> object. Data frame containing TIC data
from a background sample or blank sample to be subtracted from the sample TIC
data.</p>
</td></tr>
<tr><td><code id="batch_preprocess_+3A_thr">THR</code></td>
<td>
<p>a <em>float</em> object. Threshold for peak intensity for peak
alignment. Should be a number between the baseline value and the highest peak
intensity. Default is THR = 100000.</p>
</td></tr>
<tr><td><code id="batch_preprocess_+3A_images">images</code></td>
<td>
<p>a <em>boolean</em> object. An optional input. If TRUE, all images
of preprocessing steps will be displayed. Default is FALSE, no images will be
displayed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs full preprocessing on a batch of data files.
Extracts data and performs peak alignment and performs smoothing and baseline
correction.
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object. A list of pairs of data frames. A TIC
data frame and an MS data frame for each file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>folder &lt;- system.file("extdata",package="gcxgclab")
frame_list &lt;- batch_preprocess(folder,mod_t=.5,lambda=10,gamma=0.5,images=TRUE)

</code></pre>

<hr>
<h2 id='bl_corr'>Baseline correction</h2><span id='topic+bl_corr'></span>

<h3>Description</h3>

<p><code>bl_corr</code> performs baseline correction of the intensity values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bl_corr(data, gamma = 0.5, subtract = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bl_corr_+3A_data">data</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="bl_corr_+3A_gamma">gamma</code></td>
<td>
<p>a <em>float</em> object. Correction factor between 0 and 1. 0
results in almost no values being subtracted to the baseline, 1 results in
almost everything except the peaks to be subtracted to the baseline. Default
is 0.5.</p>
</td></tr>
<tr><td><code id="bl_corr_+3A_subtract">subtract</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs baseline correction and baseline subtraction
for TIC values.
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object. A data frame of the overall time index,
the x-axis retention time, the y-axis retention time, and the baseline
corrected total intensity values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
sm_frame &lt;- smooth(frame, lambda=10)
blc_frame &lt;- bl_corr(sm_frame, gamma=0.5)
plot_chr(blc_frame, title='Baseline Corrected')

</code></pre>

<hr>
<h2 id='comp_nist'>Compares MS to NIST MS database</h2><span id='topic+comp_nist'></span>

<h3>Description</h3>

<p><code>comp_nist</code> compares the MS data from a peak to the NIST MS
database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp_nist(nistlist, ms, cutoff = 50, title = "Best NIST match")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comp_nist_+3A_nistlist">nistlist</code></td>
<td>
<p>a <em>list</em> object, a list of compound MS data from the
NIST MS Library database, ideally the output of nist_list().</p>
</td></tr>
<tr><td><code id="comp_nist_+3A_ms">ms</code></td>
<td>
<p>a <em>data.frame</em> object, a data frame of the mass values and the
percent intensity values, ideally the output of find_ms().</p>
</td></tr>
<tr><td><code id="comp_nist_+3A_cutoff">cutoff</code></td>
<td>
<p>a <em>float</em> object, the low end cutoff for the MS data,
determined based on the MS devices used for analysis. Default is 50.</p>
</td></tr>
<tr><td><code id="comp_nist_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the
head-to-tail plot of best NIST Library match. Default title &quot;Best NIST match&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes the MS data from an intensity peak in a sample
and compares it to the NIST MS Library database and determines the compound
which is the best match to the MS data.
</p>


<h3>Value</h3>

<p>a <em>data.frame</em> object, a list of the top 10 best matching
compounds from the NIST database, with their compounds, the index in the
nistlist, and match percent.
</p>

<hr>
<h2 id='comp_peaks'>Compare Peaks</h2><span id='topic+comp_peaks'></span>

<h3>Description</h3>

<p><code>comp_peaks</code> compares peaks of two samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp_peaks(ref_peaks, al_peaks)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comp_peaks_+3A_ref_peaks">ref_peaks</code></td>
<td>
<p>a <em>data.frame</em> object. A data frame with 4 columns
(Time, X, Y, Peak), ideally the output from either top_peaks() or
thr_peaks().</p>
</td></tr>
<tr><td><code id="comp_peaks_+3A_al_peaks">al_peaks</code></td>
<td>
<p>a <em>data.frame</em> object. A data frame with 4 columns
(Time, X, Y, Peak), ideally the output from either top_peaks() or
thr_peaks().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function find compares the peaks from two samples and
correlates the peaks by determining the peaks closest to each other in the
two samples, within a certain reasonable distance. Then returns a data frame
with a list of the correlated peaks including each of their time coordinates.
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object. A data frame with 8 columns containing
the matched peaks from the two samples, with the time, x, y, and peak values
for each.
</p>

<hr>
<h2 id='extract_data'>Extracts data from cdf file.</h2><span id='topic+extract_data'></span>

<h3>Description</h3>

<p><code>extract_data</code> Extracts the data from a cdf file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_data(filename, mod_t = 10, shift_time = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_data_+3A_filename">filename</code></td>
<td>
<p>a <em>string</em> object. The path or file name of the cdf
file to be opened.</p>
</td></tr>
<tr><td><code id="extract_data_+3A_mod_t">mod_t</code></td>
<td>
<p>a <em>float</em> object. The modulation time for the GCxGC sample
analysis. Default is 10.</p>
</td></tr>
<tr><td><code id="extract_data_+3A_shift_time">shift_time</code></td>
<td>
<p>a <em>boolean</em> object. Determines whether the Overall
Time Index should be shifted to 0. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function opens the specified cdf file using the implemented
function <code><a href="ncdf4.html#topic+nc_open">nc_open</a></code> from ncdf4 package, then extracts the
data and closes the cdf file using the implemented function
<code><a href="ncdf4.html#topic+nc_close">nc_close</a></code> from ncdf4 package
(Pierce 2021). It then returns a list of two data frames. The
first is a dataframe of the TIC data, the output of create_df(). The second
is a data frame of the full MS data, the output of mass_data().
</p>


<h3>Value</h3>

<p>A <em>list</em> object. A list of the extracted data: scan acquisition
time, total intensity, mass values, intensity values, and point count.
</p>


<h3>References</h3>

<p>Pierce D (2021).
&ldquo;Interface to Unidata netCDF (Version 4 or Earlier) Format Data Files.&rdquo;
<em>CRAN</em>.
<a href="https://cirrus.ucsd.edu/~pierce/ncdf/index.html">https://cirrus.ucsd.edu/~pierce/ncdf/index.html</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
plot_chr(frame, title='Raw Data', scale="linear")
plot_chr(frame, title='Log Intensity')

</code></pre>

<hr>
<h2 id='find_eic'>Finds EICs</h2><span id='topic+find_eic'></span>

<h3>Description</h3>

<p><code>find_eic</code> calculates the mass defect for each ion, then finds
the specific EICs of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_eic(data, MOI, tolerance = 5e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_eic_+3A_data">data</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="find_eic_+3A_moi">MOI</code></td>
<td>
<p>a <em>float</em> object. The mass (m/z) value of interest.</p>
</td></tr>
<tr><td><code id="find_eic_+3A_tolerance">tolerance</code></td>
<td>
<p>a <em>double</em> object. The tolerance allowed for the MOI.
Default is 0.0005.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracted Ion Chromatogram (EIC) is a plot of intensity at a chosen
m/z value, or range of values, as a function of retention time.
This function finds intensity values at the given mass-to-charge (m/z)
values, MOI, and in a range around MOI given a tolerance. Calculates the mass
defect for each ion, then finds the specific EICs of interest. Returns a data
frame of time values, mass values, intensity values, and mass defects.
</p>


<h3>Value</h3>

<p>eic, a <em>data.frame</em> object. A data frame of time values,
retention time 1, retention time 2, mass values, intensity values, and mass
defects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file1 &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file1,mod_t=.5)
eic &lt;- find_eic(frame, MOI=92.1397,tolerance=0.005)
plot_eic(eic,dim=1,title='EIC for MOI 92.1397')
plot_eic(eic,dim=2,title='EIC for MOI 92.1397')

</code></pre>

<hr>
<h2 id='find_ms'>Finds MS</h2><span id='topic+find_ms'></span>

<h3>Description</h3>

<p><code>find_ms</code> Finds mass spectra of a peak.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_ms(data, t_peak, tolerance = 5e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_ms_+3A_data">data</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="find_ms_+3A_t_peak">t_peak</code></td>
<td>
<p>a <em>float</em> object. The overall time index value for when
the peak occurs in the GCxGC sample (the 1D time value).</p>
</td></tr>
<tr><td><code id="find_ms_+3A_tolerance">tolerance</code></td>
<td>
<p>a <em>double</em> object. The tolerance allowed for the time
index. Default is 0.0005.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the mass spectra values of a peak in the
intensity values of a GCxGC sample at a specified overall time index value.
Then outputs a data frame of the mass values and percent intensity values
which can then be plotted to product the mass spectra plot.
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object. A data frame of the mass values and the
percent intensity values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
mz &lt;- find_ms(frame, t_peak=peaks$'T'[1])
plot_ms(mz)
plot_defect(mz,title="Kendrick Mass Defect, CH_2")

</code></pre>

<hr>
<h2 id='gauss'>1D Gaussian function</h2><span id='topic+gauss'></span>

<h3>Description</h3>

<p><code>gauss</code> Defines the 1D Gaussian curve function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gauss(a, b, c, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gauss_+3A_a">a</code>, <code id="gauss_+3A_b">b</code>, <code id="gauss_+3A_c">c</code></td>
<td>
<p>are <em>float</em> objects. Parameters in R^1 for the Gaussian
function.</p>
</td></tr>
<tr><td><code id="gauss_+3A_t">t</code></td>
<td>
<p>a <em>float</em> object. The independent variable in R^1 for the
Gaussian function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function defines a 1D Gaussian curve function.
</p>


<h3>Value</h3>

<p>A <em>float</em> object. The value of the Gaussian function at time t,
given the parameters input a,b,c.
</p>

<hr>
<h2 id='gauss_fit'>Fitting to Gaussian curve</h2><span id='topic+gauss_fit'></span>

<h3>Description</h3>

<p><code>gauss_fit</code> fits data around a peak to a Gaussian curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gauss_fit(TIC_df, peakcoord)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gauss_fit_+3A_tic_df">TIC_df</code></td>
<td>
<p>a <em>data.frame</em> object. Data frame with 4 columns
(Overall Time Index, RT1, RT2, TIC), ideally the output from create_df(), or
the first data frame returned from extract_data(), $TIC_df.</p>
</td></tr>
<tr><td><code id="gauss_fit_+3A_peakcoord">peakcoord</code></td>
<td>
<p>a <em>vector</em> object. The two dimensional time retention
coordinates of the peak of interest. c(RT1,RT2).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits data around the specified peak to a Gaussian
curve, minimized with nonlinear least squares method nls() from &quot;stats&quot;
package.
</p>


<h3>Value</h3>

<p>A <em>list</em> object with three items. The first <em>data.frame</em>
object. A data frame with two columns, (time, guassfit), the time values
around the peak, and the intensity values fitted to the optimal Gaussian
curve. Second, a <em>vector</em> object of the fitted parameters (a,b,c).
Third, a <em>double</em> object, the area under the fitted Gaussian curve.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
gaussfit &lt;- gauss_fit(frame$TIC_df, peakcoord=c(peaks$'X'[1], peaks$'Y'[1]))
message(paste('Area under curve =',gaussfit[[3]], 'u^2'))
plot_gauss(frame$TIC_df, gaussfit[[1]])

</code></pre>

<hr>
<h2 id='gauss2'>2D Gaussian function</h2><span id='topic+gauss2'></span>

<h3>Description</h3>

<p><code>gauss2</code> Defines the 2D Gaussian curve function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gauss2(a, b1, b2, c1, c2, t1, t2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gauss2_+3A_a">a</code>, <code id="gauss2_+3A_b1">b1</code>, <code id="gauss2_+3A_b2">b2</code>, <code id="gauss2_+3A_c1">c1</code>, <code id="gauss2_+3A_c2">c2</code></td>
<td>
<p>are <em>float</em> objects. Parameters in R^1 for the
Gaussian function.</p>
</td></tr>
<tr><td><code id="gauss2_+3A_t1">t1</code>, <code id="gauss2_+3A_t2">t2</code></td>
<td>
<p>are <em>float</em> objects. The independent variables t=(t1.t2)
in R^2 for the Gaussian function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function defines a 2D Gaussian curve function.
</p>


<h3>Value</h3>

<p>A <em>float</em> object. The value of the Gaussian function at time
t=(t1,t2) given the parameters input a,b1,b2,c1,c2.
</p>

<hr>
<h2 id='gauss2_fit'>Fitting to 2D Gaussian curve</h2><span id='topic+gauss2_fit'></span>

<h3>Description</h3>

<p><code>gauss2_fit</code> fits data around a peak to a 2D Gaussian curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gauss2_fit(TIC_df, peakcoord)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gauss2_fit_+3A_tic_df">TIC_df</code></td>
<td>
<p>a <em>data.frame</em> object. Data frame with 4 columns
(Overall Time Index, RT1, RT2, TIC), ideally the output from create_df(), or
the first data frame returned from extract_data(), $TIC_df.</p>
</td></tr>
<tr><td><code id="gauss2_fit_+3A_peakcoord">peakcoord</code></td>
<td>
<p>a <em>vector</em> object. The two dimensional time retention
coordinates of the peak of interest. c(RT1,RT2).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits data around the specified peak to a 2D Gaussian
curve, minimized with nonlinear least squares method nls() from &quot;stats&quot;
package.
</p>


<h3>Value</h3>

<p>A <em>list</em> object with three items. The first <em>data.frame</em>
object. A data frame with three columns, (time1, time2, guassfit), the time
values around the peak, and the intensity values fitted to the optimal
Gaussian curve. Second, a <em>vector</em> object of the fitted parameters
(a,b1,b2,c1,c2). Third, a <em>double</em> object, the volume under the fitted
Gaussian curve.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
gaussfit2 &lt;- gauss2_fit(frame$TIC_df, peakcoord=c(peaks$'X'[1], peaks$'Y'[1]))
message(paste('Volume under curve =',gaussfit2[[3]],'u^3'))
plot_gauss2(frame$TIC_df, gaussfit2[[1]])

</code></pre>

<hr>
<h2 id='mass_list'>Creates list of atomic mass data</h2><span id='topic+mass_list'></span>

<h3>Description</h3>

<p><code>mass_list</code> creates a list of atomic mass data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mass_list()
</code></pre>


<h3>Details</h3>

<p>This function creates a data frame containing the data for the
atomic weights for each element in the periodic table
(M. and et al. 2012).
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object, with two columns, (elements,
mass).
</p>


<h3>References</h3>

<p>M. W, et al. (2012).
&ldquo;The Ame2012 atomic mass evaluation.&rdquo;
<em>Chinese Phys. C</em>, <b>36 1603</b>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
mz &lt;- find_ms(frame, t_peak=peaks$'T'[1])
masslist &lt;- mass_list()
non_targeted(masslist, mz, THR=0.05)

</code></pre>

<hr>
<h2 id='nist_list'>Creates list of NIST data</h2><span id='topic+nist_list'></span>

<h3>Description</h3>

<p><code>nist_list</code> creates a list of the data from the NIST MS
database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nist_list(nistfile, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nist_list_+3A_nistfile">nistfile</code></td>
<td>
<p>a <em>string</em> object, the file name or path of the MSP file
for the NIST MS Library database.</p>
</td></tr>
<tr><td><code id="nist_list_+3A_...">...</code></td>
<td>
<p>additional optional <em>string</em> objects, the file names or paths
of the MSP file for the NIST MS Library if the data base is broken into
multiple files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes the MSP file containing the data from the NIST
MS Library database and creates a list of string vectors for each compound in
the database.
</p>


<h3>Value</h3>

<p>nistlist, a <em>list</em> object, a list of string vectors for each
compound in the database.
</p>

<hr>
<h2 id='non_targeted'>Compares MS to atomic mass data</h2><span id='topic+non_targeted'></span>

<h3>Description</h3>

<p><code>non_targeted</code> compares the MS data from a peak to atomic mass
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>non_targeted(masslist, ms, THR = 0.1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="non_targeted_+3A_masslist">masslist</code></td>
<td>
<p>a <em>list</em> object, a list of atomic weights, ideally the
output of mass_list().</p>
</td></tr>
<tr><td><code id="non_targeted_+3A_ms">ms</code></td>
<td>
<p>a <em>data.frame</em> object, a data frame of the mass values and the
percent intensity values, ideally the output of find_ms().</p>
</td></tr>
<tr><td><code id="non_targeted_+3A_thr">THR</code></td>
<td>
<p>a <em>double</em> object. The threshold of intensity of which to
include peaks for mass comparison. Default is 0.1.</p>
</td></tr>
<tr><td><code id="non_targeted_+3A_...">...</code></td>
<td>
<p>a <em>vector</em> object. Any further optional inputs which
indicate additional elements to consider in the compound, or restrictions on
the number of a certain element in the compound. Should be in the form
c('X', a, b) where X = element symbol, a = minimum number of atoms, b =
maximum number of atoms. a and b are optional. If no minimum, use a=0, if no
maximum, do not include b.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes the MS data from an intensity peak in a sample
and compares it to combinations of atomic masses. Then it approximates the
makeup of the compound, giving the best matches to the MS data. Note that
the default matches will contain only H, N, C, O, F, Cl, Br, I, and Si. The
user can input optional parameters to indicate additional elements to be
considered or restrictions on the number of any specific element in the
matching compounds.
</p>


<h3>Value</h3>

<p>A <em>list</em> object, a list of vectors containing strings of the
matching compounds.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
mz &lt;- find_ms(frame, t_peak=peaks$'T'[1])
masslist &lt;- mass_list()
non_targeted(masslist, mz, THR=0.05)

</code></pre>

<hr>
<h2 id='phase_shift'>Phase shift</h2><span id='topic+phase_shift'></span>

<h3>Description</h3>

<p><code>phase_shift</code> shifts the phase of the chromatogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phase_shift(data, shift)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phase_shift_+3A_data">data</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="phase_shift_+3A_shift">shift</code></td>
<td>
<p>a <em>float</em> object. The number of seconds to shift the phase
by.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function shifts the phase of the chromatogram up or down by
the specified number of seconds.
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object. A list of two data frames. A TIC data
frame and an MS data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
shifted &lt;- phase_shift(frame, -.2)
plot_chr(shifted, title='Shifted')

</code></pre>

<hr>
<h2 id='plot_chr'>Plot chromatogram</h2><span id='topic+plot_chr'></span>

<h3>Description</h3>

<p><code>plot_chr</code> plots TIC data for chromatogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_chr(data, scale = "log", dim = 2, floor = -1, title = "Intensity")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_chr_+3A_data">data</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="plot_chr_+3A_scale">scale</code></td>
<td>
<p>a <em>string</em> object. Either 'linear' or 'log'. log refers to
logarithm base 10. Default is log scale.</p>
</td></tr>
<tr><td><code id="plot_chr_+3A_dim">dim</code></td>
<td>
<p>a <em>integer</em> object. The time dimensions of the plot, either 1
or 2. Default is 2.</p>
</td></tr>
<tr><td><code id="plot_chr_+3A_floor">floor</code></td>
<td>
<p>a <em>float</em> object. The floor value for plotting. Values
below floor will be scaled up. Default for linear plotting is 0, default for
log plotting is 10^3.</p>
</td></tr>
<tr><td><code id="plot_chr_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the plot.
Default title &quot;Intensity&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a contour plot using of TIC data vs the x and
y retention times using <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> from ggplot2 package
(Wickham 2016).
</p>


<h3>Value</h3>

<p>A <em>ggplot</em> object. A contour plot of TIC data plotted in two
dimensional retention time.
</p>


<h3>References</h3>

<p>Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York.
ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
plot_chr(frame, title='Raw Data', scale="linear")
plot_chr(frame, title='Log Intensity')

</code></pre>

<hr>
<h2 id='plot_defect'>Plots the Kendrick Mass Defect of a peak</h2><span id='topic+plot_defect'></span>

<h3>Description</h3>

<p><code>plot_defect</code> Plots Kendrick Mass Defect of a peak.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_defect(ms, compound_mass = 14.01565, title = "Kendrick Mass Defect")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_defect_+3A_ms">ms</code></td>
<td>
<p>a <em>data.frame</em> object. A data frame of the mass values and the
percent intensity values, ideally the output of find_ms().</p>
</td></tr>
<tr><td><code id="plot_defect_+3A_compound_mass">compound_mass</code></td>
<td>
<p>a <em>float</em> object. The exact mass, using most common
ions, of the desired atom group to base the Kendrick mass on. Default is
14.01565, which is the mass for CH_2.</p>
</td></tr>
<tr><td><code id="plot_defect_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the plot.
Default title &quot;Kendrick Mass Defect&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a scatter  plot of the Kendrick mass defects
for mass spectrum data. Plotted using <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> from
ggplot2 package (Wickham 2016).
</p>


<h3>Value</h3>

<p>A <em>ggplot</em> object. A line plot of the mass spectra data. The
mass values vs the percent intensity values as a percent of the highest
intensity.
</p>


<h3>References</h3>

<p>Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York.
ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
mz &lt;- find_ms(frame, t_peak=peaks$'T'[1])
plot_ms(mz)
plot_defect(mz,title="Kendrick Mass Defect, CH_2")

</code></pre>

<hr>
<h2 id='plot_eic'>Plots the EICs</h2><span id='topic+plot_eic'></span>

<h3>Description</h3>

<p><code>plot_eic</code> Plots the EICs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_eic(eic, title = "EIC", dim = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_eic_+3A_eic">eic</code></td>
<td>
<p>a <em>data.frame</em> object. A data frame of the times and
intensity values of the EIC of interest, ideally the output of find_eic().</p>
</td></tr>
<tr><td><code id="plot_eic_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the plot.
Default title &quot;EIC&quot;.</p>
</td></tr>
<tr><td><code id="plot_eic_+3A_dim">dim</code></td>
<td>
<p>a <em>integer</em> object. The time dimensions of the plot, either 1
or 2. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a scatter plot of the overall time index vs
the intensity values at a given mass of interest using
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> from ggplot2 package
(Wickham 2016).
</p>


<h3>Value</h3>

<p>A <em>ggplot</em> object. A scatter plot of the overall time index vs
the intensity values at a given mass of interest.
</p>


<h3>References</h3>

<p>Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York.
ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file1 &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file1,mod_t=.5)
eic &lt;- find_eic(frame, MOI=92.1397,tolerance=0.005)
plot_eic(eic,dim=1,title='EIC for MOI 92.1397')
plot_eic(eic,dim=2,title='EIC for MOI 92.1397')

</code></pre>

<hr>
<h2 id='plot_gauss'>Plots a peak with the fitted Gaussian curve.</h2><span id='topic+plot_gauss'></span>

<h3>Description</h3>

<p><code>plot_gauss</code> Plots a peak with the fitted Gaussian curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_gauss(TIC_df, gauss_return, title = "Peak fit to Gaussian")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_gauss_+3A_tic_df">TIC_df</code></td>
<td>
<p>a <em>data.frame</em> object. Data frame with 4 columns
(Overall Time Index, RT1, RT2, TIC), ideally the output from create_df(), or
the first data frame returned from extract_data(), $TIC_df.</p>
</td></tr>
<tr><td><code id="plot_gauss_+3A_gauss_return">gauss_return</code></td>
<td>
<p>a <em>data.frame</em> object. The output from guass_fit().
A data frame with two columns, (time, guassfit), the time values around the
peak, and the intensity values fitted to the optimal Gaussian curve.</p>
</td></tr>
<tr><td><code id="plot_gauss_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the points around the peak in blue dots, with a
line plot of the Gaussian curve fit to the peak data in red, using
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> from ggplot2 package
(Wickham 2016).
</p>


<h3>Value</h3>

<p>A <em>ggplot</em> object. A plot of points around the peak with a line
plot of the Gaussian curve fit to the peak data.
</p>


<h3>References</h3>

<p>Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York.
ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
gaussfit &lt;- gauss_fit(frame$TIC_df, peakcoord=c(peaks$'X'[1], peaks$'Y'[1]))
message(paste('Area under curve =',gaussfit[[3]], 'u^2'))
plot_gauss(frame$TIC_df, gaussfit[[1]])

</code></pre>

<hr>
<h2 id='plot_gauss2'>Plots a 3D peak with the fitted Gaussian curve.</h2><span id='topic+plot_gauss2'></span>

<h3>Description</h3>

<p><code>plot_gauss2</code> Plots a 3D peak with the fitted Gaussian curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_gauss2(TIC_df, gauss2_return, title = "Peak fit to Gaussian")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_gauss2_+3A_tic_df">TIC_df</code></td>
<td>
<p>a <em>data.frame</em> object. Data frame with 4 columns
(Overall Time Index, RT1, RT2, TIC), ideally the output from create_df(), or
the first data frame returned from extract_data(), $TIC_df.</p>
</td></tr>
<tr><td><code id="plot_gauss2_+3A_gauss2_return">gauss2_return</code></td>
<td>
<p>a <em>data.frame</em> object. The output from guass_fit().
A data frame with two columns, (time, guassfit), the time values around the
peak, and the intensity values fitted to the optimal Gaussian curve.</p>
</td></tr>
<tr><td><code id="plot_gauss2_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the points around the peak with a
contour plot of the Gaussian curve fit to the peak data, using
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> from ggplot2 package
(Wickham 2016).
</p>


<h3>Value</h3>

<p>A <em>ggplot</em> object. A contour plot of the Gaussian curve fit to
the peak data.
</p>


<h3>References</h3>

<p>Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York.
ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
gaussfit2 &lt;- gauss2_fit(frame$TIC_df, peakcoord=c(peaks$'X'[1], peaks$'Y'[1]))
message(paste('Volume under curve =',gaussfit2[[3]],'u^3'))
plot_gauss2(frame$TIC_df, gaussfit2[[1]])

</code></pre>

<hr>
<h2 id='plot_ms'>Plots the mass spectra of a peak.</h2><span id='topic+plot_ms'></span>

<h3>Description</h3>

<p><code>plot_ms</code> Plots the mass spectra of a peak.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ms(ms, title = "Mass Spectrum")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_ms_+3A_ms">ms</code></td>
<td>
<p>a <em>data.frame</em> object. A data frame of the mass values and the
percent intensity values, ideally the output of find_ms().</p>
</td></tr>
<tr><td><code id="plot_ms_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the plot.
Default title &quot;Mass Spectrum&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a line plot of the mass spectra data. The
mass values vs the percent intensity values as a percent of the highest
intensity using <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> from ggplot2 package
(Wickham 2016).
</p>


<h3>Value</h3>

<p>A <em>ggplot</em> object. A line plot of the mass spectra data. The
mass values vs the percent intensity values as a percent of the highest
intensity.
</p>


<h3>References</h3>

<p>Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York.
ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
mz &lt;- find_ms(frame, t_peak=peaks$'T'[1])
plot_ms(mz)

</code></pre>

<hr>
<h2 id='plot_nist'>Plots the mass spectra of a NIST compound.</h2><span id='topic+plot_nist'></span>

<h3>Description</h3>

<p><code>plot_nist</code> Plots the mass spectra of a NIST compound.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_nist(nistlist, k, ms, title = "NIST Mass Spectrum")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_nist_+3A_nistlist">nistlist</code></td>
<td>
<p>a <em>list</em> object, a list of compound MS data from the
NIST MS Library database, ideally the output of nist_list().</p>
</td></tr>
<tr><td><code id="plot_nist_+3A_k">k</code></td>
<td>
<p>a <em>integer</em> object, the index of the NIST compound in the
nistlist input.</p>
</td></tr>
<tr><td><code id="plot_nist_+3A_ms">ms</code></td>
<td>
<p>a <em>data.frame</em> object, a data frame of the mass values and the
percent intensity values, ideally the output of find_ms().</p>
</td></tr>
<tr><td><code id="plot_nist_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the plot.
Default title &quot;Mass Spectrum&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces line plot of the mass spectra data from the
sample on top, and the mass spectrum from a NIST compound entry on the
bottom. The mass values vs the percent intensity values as a percent of the
highest intensity using <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> from ggplot2 package
(Wickham 2016).
</p>


<h3>Value</h3>

<p>A <em>ggplot</em> object. A line plot of the mass spectra data. The
mass values vs the percent intensity values as a percent of the highest
intensity.
</p>


<h3>References</h3>

<p>Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York.
ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>

<hr>
<h2 id='plot_peak'>Peak Plot</h2><span id='topic+plot_peak'></span>

<h3>Description</h3>

<p><code>plot_peak</code> plots peaks on a chromatograph plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_peak(
  peaks,
  data,
  title = "Intensity with Peaks",
  circlecolor = "red",
  circlesize = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_peak_+3A_peaks">peaks</code></td>
<td>
<p>a <em>data.frame</em> object. A data frame with 4 columns (Time,
X, Y, Peak), ideally the output from either thr_peaks() or top_peaks().</p>
</td></tr>
<tr><td><code id="plot_peak_+3A_data">data</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data(). Provides the
background GCxGC plot, created with plot_chr().</p>
</td></tr>
<tr><td><code id="plot_peak_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the plot.
Default title &quot;Intensity with Peaks&quot;.</p>
</td></tr>
<tr><td><code id="plot_peak_+3A_circlecolor">circlecolor</code></td>
<td>
<p>a <em>string</em> object. The desired color of the circles
which indicate the peaks. Default color red.</p>
</td></tr>
<tr><td><code id="plot_peak_+3A_circlesize">circlesize</code></td>
<td>
<p>a <em>double</em> object. The size of the circles which
indicate the peaks. Default size 5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function circles the identified peaks in a sample over a
chromatograph plot (ideally smoothed) using <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
from ggplot2 package (Wickham 2016).
</p>


<h3>Value</h3>

<p>A <em>ggplot</em> object. A plot of the chromatogram heatmap, with
identified peaks circled in red.
</p>


<h3>References</h3>

<p>Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York.
ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file1 &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file1,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
plot_peak(peaks, frame, title="Top 20 Peaks")

</code></pre>

<hr>
<h2 id='plot_peakonly'>Plot only peaks</h2><span id='topic+plot_peakonly'></span>

<h3>Description</h3>

<p><code>plot_peakonly</code> plots the peaks from a chromatograph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_peakonly(peak_df, title = "Peaks")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_peakonly_+3A_peak_df">peak_df</code></td>
<td>
<p>a <em>data.frame</em> object. A data frame with 4 columns
(Time, X, Y, Peak), ideally the output from top_peaks() or thr_peaks().</p>
</td></tr>
<tr><td><code id="plot_peakonly_+3A_title">title</code></td>
<td>
<p>a <em>string</em> object. Title placed at the top of the plot.
Default title &quot;Peaks&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a circle plot of the peak intensity vs
the x and y retention times using <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> from ggplot2
package (Wickham 2016). The size of the circle indicates the
intensity of the peak.
</p>


<h3>Value</h3>

<p>A <em>ggplot</em> object. A circle plot of peak intensity in 2D
retention time.
</p>


<h3>References</h3>

<p>Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>.
Springer-Verlag New York.
ISBN 978-3-319-24277-4, <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file1 &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file1,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
plot_peakonly(peaks,title="Top 20 Peaks")

</code></pre>

<hr>
<h2 id='preprocess'>Preprocessing</h2><span id='topic+preprocess'></span>

<h3>Description</h3>

<p><code>preprocess</code> performs full preprocessing on a data file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocess(
  filename,
  mod_t = 10,
  shift = 0,
  lambda = 20,
  gamma = 0.5,
  subtract = NULL,
  images = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preprocess_+3A_filename">filename</code></td>
<td>
<p>a <em>string</em> object. The file name or path of the cdf
file to be opened.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_mod_t">mod_t</code></td>
<td>
<p>a <em>float</em> object. The modulation time for the GCxGC sample
analysis.Default is 10.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_shift">shift</code></td>
<td>
<p>a <em>float</em> object. The number of seconds to shift the phase
by. Default is 0 to skip shifting.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_lambda">lambda</code></td>
<td>
<p>a <em>float</em> object. A number (parameter in Whittaker
smoothing), suggested between 1 to 10^5. Small lambda is very little
smoothing, large lambda is very smooth. Default is lambda = 20.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_gamma">gamma</code></td>
<td>
<p>a <em>float</em> object. Correction factor between 0 and 1. 0
results in almost no values being subtracted to the baseline, 1 results in
almost everything except the peaks to be subtracted to the baseline. Default
is 0.5.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_subtract">subtract</code></td>
<td>
<p>a <em>data.frame</em> object. Data frame containing TIC data
from a background sample or blank sample to be subtracted from the sample TIC
data.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_images">images</code></td>
<td>
<p>a <em>boolean</em> object. An optional input. If TRUE, all images
of preprocessing steps will be displayed. Default is FALSE, no images will be
displayed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs full preprocessing on a data file. Extracts
data and performs smoothing and baseline correction.
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object. A list of two data frames. A TIC data
frame and an MS data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- preprocess(file,mod_t=.5,lambda=10,gamma=0.5,images=TRUE)

</code></pre>

<hr>
<h2 id='smooth'>Smoothing</h2><span id='topic+smooth'></span>

<h3>Description</h3>

<p><code>smooth</code> performs smoothing of the intensity values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth(data, lambda = 20, dir = "XY")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smooth_+3A_data">data</code></td>
<td>
<p>a <em>list</em> object. Data extracted from a cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="smooth_+3A_lambda">lambda</code></td>
<td>
<p>a <em>float</em> object. A number (parameter in Whittaker
smoothing), suggested between 0 to 10^4. Small lambda is very little
smoothing, large lambda is very smooth. Default is lambda = 20.</p>
</td></tr>
<tr><td><code id="smooth_+3A_dir">dir</code></td>
<td>
<p>a <em>string</em> object. Either &quot;X&quot;, &quot;Y&quot;, or &quot;XY&quot; to indicate
direction of smoothing. &quot;XY&quot; indicates smoothing in both X (horizontal) and Y
(vertical) directions. Default &quot;XY&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs smoothing of the intensity values using
Whittaker smoothing algorithm <code><a href="ptw.html#topic+whit1">whit1</a></code> from the ptw package
(Eilers 2003).
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object. A list of two data frames. A TIC data
frame and an MS data frame.
</p>


<h3>References</h3>

<p>Eilers PH (2003).
&ldquo;A perfect smoother.&rdquo;
<em>Analytical Chemistry</em>, <b>75</b>, 3631-3636.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file,mod_t=.5)
sm_frame &lt;- smooth(frame, lambda=10)
plot_chr(sm_frame, title='Smoothed')

</code></pre>

<hr>
<h2 id='targeted'>Targeted Analysis</h2><span id='topic+targeted'></span>

<h3>Description</h3>

<p><code>targeted</code> performs targeted analysis for a batch of data
files, for a list of masses of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>targeted(
  data_list,
  MOIs,
  RTs = c(),
  window_size = c(),
  tolerance = 0.005,
  images = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="targeted_+3A_data_list">data_list</code></td>
<td>
<p>a <em>list</em> object. Data extracted from each cdf file,
ideally the output from extract_data().</p>
</td></tr>
<tr><td><code id="targeted_+3A_mois">MOIs</code></td>
<td>
<p>a <em>vector</em> object. A vector containing a list of all masses
of interest to be investigated.</p>
</td></tr>
<tr><td><code id="targeted_+3A_rts">RTs</code></td>
<td>
<p>a <em>vector</em> object. An optional vector containing a list of
retention times of interest for the listed masses of interest. Default values
if left empty will be at the retention time of the highest intensity for the
corresponding mass.</p>
</td></tr>
<tr><td><code id="targeted_+3A_window_size">window_size</code></td>
<td>
<p>a <em>vector</em> object. An optional vector containing a
list of window sizes corresponding to the retention times.  Window will be
defined by (RT-window_size, RT+window_size). Default if left
empty will be 0.1.</p>
</td></tr>
<tr><td><code id="targeted_+3A_tolerance">tolerance</code></td>
<td>
<p>a <em>float</em> object. The tolerance allowed for the MOI.
Default is 0.005.</p>
</td></tr>
<tr><td><code id="targeted_+3A_images">images</code></td>
<td>
<p>a <em>boolean</em> object. An optional input. If TRUE, all images
of the found peaks will be displayed. Default is FALSE, no images will be
displayed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs targeted analysis for a batch of data
files, for a list of masses of interest.
</p>


<h3>Value</h3>

<p>a <em>data.frame</em> object. A data frame containing the areas of the
peaks for the indicated MOIs and list of files.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file1 &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
file2 &lt;- system.file("extdata","sample2.cdf",package="gcxgclab")
file3 &lt;- system.file("extdata","sample3.cdf",package="gcxgclab")
frame1 &lt;- extract_data(file1,mod_t=.5)
frame2 &lt;- extract_data(file2,mod_t=.5)
frame3 &lt;- extract_data(file3,mod_t=.5)
targeted(list(frame1,frame2,frame3),MOIs = c(92.1397, 93.07058),
RTs = c(6.930, 48.594), images=TRUE)

</code></pre>

<hr>
<h2 id='thr_peaks'>Threshold Peaks</h2><span id='topic+thr_peaks'></span>

<h3>Description</h3>

<p><code>thr_peaks</code> finds all peaks above the given threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thr_peaks(TIC_df, THR = 1e+05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thr_peaks_+3A_tic_df">TIC_df</code></td>
<td>
<p>a <em>data.frame</em> object. Data frame with 4 columns
(Overall Time Index, RT1, RT2, TIC), ideally the output from create_df(), or
the first data frame returned from extract_data(), $TIC_df.</p>
</td></tr>
<tr><td><code id="thr_peaks_+3A_thr">THR</code></td>
<td>
<p>a <em>float</em> object. Threshold for peak intensity. Should be a
number between the baseline value and the highest peak intensity. Default
suggestion is THR = 100000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds all peaks in the sample above a given intensity
threshold.
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object. A data frame with 4 columns (Time, X, Y,
Peak) with all peaks above the given threshold, with their time coordinates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file1 &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file1,mod_t=.5)
thrpeaks &lt;- thr_peaks(frame$TIC_df, 100000)
plot_peak(thrpeaks, frame, title="Peaks Above 100,000")
plot_peakonly(thrpeaks,title="Peaks Above 100,000")

</code></pre>

<hr>
<h2 id='top_peaks'>Top Peaks</h2><span id='topic+top_peaks'></span>

<h3>Description</h3>

<p><code>top_peaks</code> finds the top N highest peaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>top_peaks(TIC_df, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="top_peaks_+3A_tic_df">TIC_df</code></td>
<td>
<p>a <em>data.frame</em> object. Data frame with 4 columns
(Overall Time Index, RT1, RT2, TIC), ideally the output from create_df(), or
the first data frame returned from extract_data(), $TIC_df.</p>
</td></tr>
<tr><td><code id="top_peaks_+3A_n">N</code></td>
<td>
<p><em>int</em> object. The number of top peaks to be found in the
sample. N should be an integer &gt;=1. Default suggestion is N = 20.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the top N peaks in intensity in the sample.
</p>


<h3>Value</h3>

<p>A <em>data.frame</em> object. A data frame with 4 columns (Time, X, Y,
Peak) with the top N peaks, with their time coordinates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file1 &lt;- system.file("extdata","sample1.cdf",package="gcxgclab")
frame &lt;- extract_data(file1,mod_t=.5)
peaks &lt;- top_peaks(frame$TIC_df, 5)
plot_peak(peaks, frame, title="Top 20 Peaks")
plot_peakonly(peaks,title="Top 20 Peaks")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
