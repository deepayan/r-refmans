<!DOCTYPE html><html lang="en"><head><title>Help for package skyscapeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {skyscapeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#antizenith'><p>Declination of the anti-zenith sun for a given location</p></a></li>
<li><a href='#az.pdf'><p>Convert discrete azimuth measurements into probability distributions</p></a></li>
<li><a href='#az2dec'><p>Calculates declination from azimuth and altitude measurements</p></a></li>
<li><a href='#BC.AD'><p>Converts year number (epoch) to calendar year</p></a></li>
<li><a href='#bernoulli.trial'><p>Execute a (series of) Bernoulli trial(s)</p></a></li>
<li><a href='#body.position'><p>Computes position of Solar System bodies in equatorial coordinates</p></a></li>
<li><a href='#coordtrans'><p>Coordinate-transform azimuth prob distributions into declination prob distributions</p></a></li>
<li><a href='#createHor'><p>Create <em>skyscapeR.horizon</em> object from Az/Alt data</p></a></li>
<li><a href='#createHWT'><p>Create and download horizon data from <em>HeyWhatsThat</em></p></a></li>
<li><a href='#curvigram'><p>(Defunct) Computes declination curvigram</p></a></li>
<li><a href='#downloadHWT'><p>Download horizon data from <em>HeyWhatsThat</em></p></a></li>
<li><a href='#dS'><p>Declination of December Solstice for a given year</p></a></li>
<li><a href='#EFM'><p>Equinoctial Full Moons</p></a></li>
<li><a href='#eq'><p>Declination of the sun at the Equinox</p></a></li>
<li><a href='#exportHor'><p>Exports a <em>skyscapeR.horizon</em> object into <em>Stellarium</em> format</p></a></li>
<li><a href='#findTargets'><p>Find celestial targets within declination and time ranges</p></a></li>
<li><a href='#hor2alt'><p>Retrieves horizon altitude for a given azimuth from a given horizon profile</p></a></li>
<li><a href='#hpdi'><p>Returns the high-density region of a probability distribution</p></a></li>
<li><a href='#jd2time'><p>Converts Julian date and time (in any timezone) to julian date</p></a></li>
<li><a href='#jS'><p>Declination of June Solstice for a given year</p></a></li>
<li><a href='#long.date'><p>Converts day-month in 'MM-DD' format to a more readable format</p></a></li>
<li><a href='#mag.dec'><p>Estimates magnetic declination (difference between true and magnetic</p>
north) based on IGRF 12th gen model</a></li>
<li><a href='#moonphase'><p>Computes the phase of the moon</p></a></li>
<li><a href='#nMjLX'><p>Declination of northern major Lunar Extreme for a given year</p></a></li>
<li><a href='#nmnLX'><p>Declination of northern minor Lunar Extreme for a given year</p></a></li>
<li><a href='#obliquity'><p>Computes obliquity of the ecliptic</p></a></li>
<li><a href='#orbit'><p>Calculate visible path of celestial object at given location</p></a></li>
<li><a href='#parallax.corr'><p>Corrected parallax for a given location and object altitude</p></a></li>
<li><a href='#plot.skyscapeR.horizon'><p>Plot horizon data</p></a></li>
<li><a href='#plot.skyscapeR.pdf'><p>Plot orientation probability distributions</p></a></li>
<li><a href='#plot.skyscapeR.sigTest'><p>Plot significance test of orientations</p></a></li>
<li><a href='#plot.skyscapeR.spd'><p>Plot orientation summed probability density</p></a></li>
<li><a href='#plot.skyscapeR.starphases'><p>Plot stellar phase and seasonality</p></a></li>
<li><a href='#plotAzimuth'><p>Polar plot of orientations (azimuths)</p></a></li>
<li><a href='#plotBars'><p>Bar plot of orientations (declination)</p></a></li>
<li><a href='#print.skyscapeR.sigTest'><p>Prints significance test results</p></a></li>
<li><a href='#pval2stars'><p>Converts p-value into symbol</p></a></li>
<li><a href='#randomTest'><p>Significance test against the null hypothesis of random orientation</p></a></li>
<li><a href='#reduct.compass'><p>Data reduction for compass measurements</p></a></li>
<li><a href='#reduct.theodolite'><p>Data reduction for theodolite measurements using the sun-sight method</p></a></li>
<li><a href='#riseset'><p>Computes the rising and setting azimuth, declination and time of a Solar System object</p>
for a given location and day</a></li>
<li><a href='#RugglesCKR'><p>Cork and Kerry Stone Row Data</p></a></li>
<li><a href='#RugglesRSC'><p>Recumbent Stone Circle Data</p></a></li>
<li><a href='#sigTest'><p>(Defunct) Perform a null hypothesis significance test of a given curvigram</p></a></li>
<li><a href='#sky.objects'><p>Creates a <em>skyscapeR.object</em> for plotting of celestial objects at given epoch</p></a></li>
<li><a href='#sky.sketch'><p>Create a simplistic sketch of the sky at a given moment in time</p></a></li>
<li><a href='#skyscapeR.vars'><p>See and change the global variables used by skyscapeR</p></a></li>
<li><a href='#sMjLX'><p>Declination of southern major Lunar Extreme for a given year</p></a></li>
<li><a href='#smnLX'><p>Declination of southern minor Lunar Extreme for a given year</p></a></li>
<li><a href='#solar.date'><p>Solar Date</p></a></li>
<li><a href='#spatial.equinox'><p>Declination of the spatial equinox for a given location</p></a></li>
<li><a href='#spd'><p>Summed probability density (SPD)</p></a></li>
<li><a href='#star'><p>Create <em>skyscapeR.star</em> object</p></a></li>
<li><a href='#star.phases'><p>Calculate the seasons and phase type of a star</p></a></li>
<li><a href='#sunAz'><p>Returns the azimuth of the sun at a given time from a specific location</p></a></li>
<li><a href='#ten'><p>Converts degree measurements in deg-min-sec (ยบ ' &quot;) format into decimal-point degree format.</p></a></li>
<li><a href='#time2jd'><p>Converts date and time (in any timezone) to Julian date</p></a></li>
<li><a href='#timestring'><p>Converts date and time numeric values to a single string</p></a></li>
<li><a href='#zenith'><p>Declination of the zenith sun for a given location</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Data Analysis and Visualization for Skyscape Archaeology</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-29</td>
</tr>
<tr>
<td>Description:</td>
<td>Data reduction, visualization and statistical analysis of measurements of orientation of archaeological structures, following Silva (2020) &lt;<a href="https://doi.org/10.1016%2Fj.jas.2020.105138">doi:10.1016/j.jas.2020.105138</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1), swephR</td>
</tr>
<tr>
<td>Imports:</td>
<td>png, oce, utils, stats, graphics, grDevices, MESS,
RColorBrewer, numDeriv, parallel, foreach, doParallel,
rootSolve, httr, plotrix, zoo</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-29 12:42:08 UTC; fabpsilva</td>
</tr>
<tr>
<td>Author:</td>
<td>Silva Fabio [aut, cre],
  Reijs Victor [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Silva Fabio &lt;fsilva@bournemouth.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-29 22:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='antizenith'>Declination of the anti-zenith sun for a given location</h2><span id='topic+antizenith'></span>

<h3>Description</h3>

<p>This function returns the declination of the sun
when it is at the anti-zenith for a given location with
corrected average parallax. If this phenomena does
not occur at given location (i.e. if location is
outside the tropical band) the function returns a
<em>NULL</em> value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>antizenith(loc, parallax = 0.00224, altitude = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="antizenith_+3A_loc">loc</code></td>
<td>
<p>This can be either the latitude of the
location, or a <em>skyscapeR.horizon</em> object.</p>
</td></tr>
<tr><td><code id="antizenith_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the sun.
Defaults to 0.00224.</p>
</td></tr>
<tr><td><code id="antizenith_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the sun. Defaults to 0 degrees.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+jS">jS</a></code>, <code><a href="#topic+dS">dS</a></code>, <code><a href="#topic+eq">eq</a></code>,
<code><a href="#topic+zenith">zenith</a></code>, <code><a href="#topic+spatial.equinox">spatial.equinox</a></code>, <code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Anti-zenith sun declination for Mexico City:
antizenith(19.419)

# There is no anti-zenith sun phenomena in London:
antizenith(51.507)
</code></pre>

<hr>
<h2 id='az.pdf'>Convert discrete azimuth measurements into probability distributions</h2><span id='topic+az.pdf'></span>

<h3>Description</h3>

<p>Convert discrete azimuth measurements into probability distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>az.pdf(
  pdf = "normal",
  az,
  unc,
  name,
  verbose = T,
  .cutoff = 1e-04,
  .res = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="az.pdf_+3A_pdf">pdf</code></td>
<td>
<p>(Optional) String describing the probability distribution to be used. At the
moment only <em>normal</em> and <em>uniform</em> are supported. Default is <em>normal</em></p>
</td></tr>
<tr><td><code id="az.pdf_+3A_az">az</code></td>
<td>
<p>An array of azimuths</p>
</td></tr>
<tr><td><code id="az.pdf_+3A_unc">unc</code></td>
<td>
<p>Azimuth uncertainties as either an array of the same length as <em>az</em> or a single
value to be applied to all measurements</p>
</td></tr>
<tr><td><code id="az.pdf_+3A_name">name</code></td>
<td>
<p>(Optional) An array of names to identify each measurement</p>
</td></tr>
<tr><td><code id="az.pdf_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control whether or not to display text. Default is TRUE.</p>
</td></tr>
<tr><td><code id="az.pdf_+3A_.cutoff">.cutoff</code></td>
<td>
<p>(Optional) Value of probability distribution(s) at which point it will be cutoff to save on memory. Default is 1e-4</p>
</td></tr>
<tr><td><code id="az.pdf_+3A_.res">.res</code></td>
<td>
<p>(Optional) Azimuth resolution with which to output probability distribution(s). Default is 0.01 degrees.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Silva, F (2020) A probabilistic framework and significance test for the analysis of structural orientations
in skyscape archaeology <em>Journal of Archaeological Science</em> 118, 105138. &lt;doi:10.1016/j.jas.2020.105138&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- az.pdf(az=c(87,93,90,110), unc=3)
plot(test)
</code></pre>

<hr>
<h2 id='az2dec'>Calculates declination from azimuth and altitude measurements</h2><span id='topic+az2dec'></span>

<h3>Description</h3>

<p>This function calculates the declination corresponding to an
orientation , i.e. an azimuth. The altitude can either be given
or, alternatively, if a <em>skyscapeR.horizon</em> object is provided,
the corresponding horizon altitude will be automatically retrieved.
This function is a wrapper for function <code><a href="swephR.html#topic+swe_azalt_rev">swe_azalt_rev</a></code>
of package <em>swephR</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>az2dec(
  az,
  loc,
  alt,
  refraction = skyscapeR.env$refraction,
  atm = skyscapeR.env$atm,
  temp = skyscapeR.env$temp
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="az2dec_+3A_az">az</code></td>
<td>
<p>Azimuth(s) for which to calculate declination(s). See examples below.</p>
</td></tr>
<tr><td><code id="az2dec_+3A_loc">loc</code></td>
<td>
<p>Location, can be either a <em>skyscapeR.horizon</em> object or, alternatively,
an array of latitude values.</p>
</td></tr>
<tr><td><code id="az2dec_+3A_alt">alt</code></td>
<td>
<p>(Optional) Altitude of orientation. If left empty and a <em>skyscapeR.horizon</em>
is provided then this is will automatically retrieved from the horizon data via <code><a href="#topic+hor2alt">hor2alt</a></code></p>
</td></tr>
<tr><td><code id="az2dec_+3A_refraction">refraction</code></td>
<td>
<p>(Optional) Whether atmospheric refraction is to be taken into account.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="az2dec_+3A_atm">atm</code></td>
<td>
<p>(Optional) Atmospheric pressure for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="az2dec_+3A_temp">temp</code></td>
<td>
<p>(Optional) Atmospheric temperature for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="swephR.html#topic+swe_azalt_rev">swe_azalt_rev</a></code>, <code><a href="#topic+hor2alt">hor2alt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dec &lt;- az2dec(az=92, loc=c(35,-8), alt=2)

# flat horizon with 2 degrees of altitude
hor &lt;- createHor(az=c(0,360), alt=c(2,2), loc=c(35,-8,25))
dec &lt;- az2dec(92, loc=hor)

# Can also be used for an array of azimuths:
decs &lt;- az2dec(az=c(87,92,110), loc=hor)
</code></pre>

<hr>
<h2 id='BC.AD'>Converts year number (epoch) to calendar year</h2><span id='topic+BC.AD'></span>

<h3>Description</h3>

<p>Converts year number (epoch) to calendar year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BC.AD(year)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BC.AD_+3A_year">year</code></td>
<td>
<p>year number</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>BC.AD(100)
BC.AD(0)
BC.AD(-1)
BC.AD(-99)
BC.AD(-100)
</code></pre>

<hr>
<h2 id='bernoulli.trial'>Execute a (series of) Bernoulli trial(s)</h2><span id='topic+bernoulli.trial'></span>

<h3>Description</h3>

<p>This function allows one to calculate the probability of having r structures
out of n, orientated towards a target with probability p.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bernoulli.trial(n, p, r, type = "tail")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bernoulli.trial_+3A_n">n</code></td>
<td>
<p>Total number of structures</p>
</td></tr>
<tr><td><code id="bernoulli.trial_+3A_p">p</code></td>
<td>
<p>Probability of target (e.g. ratio of azimuths)</p>
</td></tr>
<tr><td><code id="bernoulli.trial_+3A_r">r</code></td>
<td>
<p>Number of structures orientated towards target (hits)</p>
</td></tr>
<tr><td><code id="bernoulli.trial_+3A_type">type</code></td>
<td>
<p>(Optional) Type of probability to output. Possibilities are: (a) <em>single</em>
in which case the result of a single Bernoulli trial is reported; or (b) <em>tail</em> in
which case it calculates Bernoulli trials for all hit values between 1 and (r-1) and then
outputs 1 minus the calculated probability. The latter is effectively a p-value. Default is <em>tail</em></p>
</td></tr>
</table>


<h3>References</h3>

<p>Ruggles, C (1999) <em>Astronomy in Prehistoric Britain and Ireland</em>. Yale University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># probability of having at least 10 out of 30 structures
# aligned to targets covering 20% of the horizon
bernoulli.trial(30, 0.2, 10)
</code></pre>

<hr>
<h2 id='body.position'>Computes position of Solar System bodies in equatorial coordinates</h2><span id='topic+body.position'></span>

<h3>Description</h3>

<p>This function calculates the geocentric or topocentric declination and right ascension of solar
system bodies at a given time. It is a wrapper for function
<code><a href="swephR.html#topic+swe_calc_ut">swe_calc_ut</a></code> of package <em>swephR</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body.position(
  obj = "sun",
  time,
  timezone,
  calendar,
  dec,
  loc = NULL,
  refraction,
  atm,
  temp,
  verbose = T
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="body.position_+3A_obj">obj</code></td>
<td>
<p>(Optional) String containing name of the solar system body of interest. Can be
any of the planets (inc. Pluto), the Moon, the Sun or the Ecliptic. Defaults to 'sun'.</p>
</td></tr>
<tr><td><code id="body.position_+3A_time">time</code></td>
<td>
<p>Either a string containing the date and time in the format &quot;YYYY/MM/DD HH:MM:SS&quot;
(see <code><a href="#topic+timestring">timestring</a></code>), or a numeric containing the julian date (see <code><a href="#topic+time2jd">time2jd</a></code>).</p>
</td></tr>
<tr><td><code id="body.position_+3A_timezone">timezone</code></td>
<td>
<p>(Optional) Timezone of input either as a known acronym (e.g. &quot;GMT&quot;, &quot;CET&quot;) or
a string with continent followed by country capital (e.g. &quot;Europe/London&quot;). See
<a href="base.html#topic+timezones">timezones</a> for details. Only needed if <em>time</em> is a string. #' If not given the value set
by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="body.position_+3A_calendar">calendar</code></td>
<td>
<p>(Optional) Calendar used in parameter <em>time</em>. G for gregorian and J for julian.
Only needed if <em>time</em> is a string. If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="body.position_+3A_dec">dec</code></td>
<td>
<p>(Optional) Output declination: <em>geo</em> for the geocentric, or <em>topo</em> for the topocentric
frame of reference. If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="body.position_+3A_loc">loc</code></td>
<td>
<p>(Optional) Location, only needed if output is in topocentric declination.</p>
</td></tr>
<tr><td><code id="body.position_+3A_refraction">refraction</code></td>
<td>
<p>(Optional) Whether atmospheric refraction is to be taken into account.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="body.position_+3A_atm">atm</code></td>
<td>
<p>(Optional) Atmospheric pressure for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="body.position_+3A_temp">temp</code></td>
<td>
<p>(Optional) Atmospheric temperature for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="body.position_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control whether or not to display text. Default is TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="swephR.html#topic+swe_calc_ut">swe_calc_ut</a></code>, <code><a href="#topic+timestring">timestring</a></code>, <code><a href="#topic+time2jd">time2jd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Position of the sun at noon GMT on Christmas day 2018:
body.position('sun', '2018/12/25 12:00:00', timezone='GMT')

# Declination of the moon at same time
body.position('moon', '2018/12/25 12:00:00', timezone='GMT')$equatorial$Dec
</code></pre>

<hr>
<h2 id='coordtrans'>Coordinate-transform azimuth prob distributions into declination prob distributions</h2><span id='topic+coordtrans'></span>

<h3>Description</h3>

<p>Coordinate-transform azimuth prob distributions into declination prob distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coordtrans(pdf, hor, refraction, atm, temp, verbose = T, .res = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coordtrans_+3A_pdf">pdf</code></td>
<td>
<p>A <em>skyscapeR.pdf</em> object created with <code><a href="#topic+az.pdf">az.pdf</a></code></p>
</td></tr>
<tr><td><code id="coordtrans_+3A_hor">hor</code></td>
<td>
<p>A <em>skyscapeR.horizon</em> object created with <code><a href="#topic+createHor">createHor</a></code> or <code><a href="#topic+downloadHWT">downloadHWT</a></code></p>
</td></tr>
<tr><td><code id="coordtrans_+3A_refraction">refraction</code></td>
<td>
<p>(Optional) Whether atmospheric refraction is to be taken into account.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="coordtrans_+3A_atm">atm</code></td>
<td>
<p>(Optional) Atmospheric pressure for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="coordtrans_+3A_temp">temp</code></td>
<td>
<p>(Optional) Atmospheric temperature for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="coordtrans_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control whether or not to display text. Default is TRUE.</p>
</td></tr>
<tr><td><code id="coordtrans_+3A_.res">.res</code></td>
<td>
<p>(Optional) Declination resolution with which to output probability distribution(s). Default is 0.1 degrees.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Silva, F (2020) A probabilistic framework and significance test for the analysis of structural orientations
in skyscape archaeology <em>Journal of Archaeological Science</em> 118, 105138. &lt;doi:10.1016/j.jas.2020.105138&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Az &lt;- az.pdf(az=c(87,93,90,110), unc=3)
hor &lt;- createHor(az=c(0,360), alt=c(0,0), loc=c(35,-8,25)) # flat horizon with 0 degrees of altitude
Dec &lt;- coordtrans(Az, hor)
plot(Dec)
</code></pre>

<hr>
<h2 id='createHor'>Create <em>skyscapeR.horizon</em> object from Az/Alt data</h2><span id='topic+createHor'></span>

<h3>Description</h3>

<p>This function creates a <em>skyscapeR.horizon</em> object from measurements of
azimuth and altitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createHor(az, alt, alt.unc = 0.5, loc, name = "", smooth = F, .scale = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createHor_+3A_az">az</code></td>
<td>
<p>Array of azimuth values</p>
</td></tr>
<tr><td><code id="createHor_+3A_alt">alt</code></td>
<td>
<p>Array of altitude values.</p>
</td></tr>
<tr><td><code id="createHor_+3A_alt.unc">alt.unc</code></td>
<td>
<p>(Optional) Either a single value or an array of altitude
uncertainty.</p>
</td></tr>
<tr><td><code id="createHor_+3A_loc">loc</code></td>
<td>
<p>Location, a vector containing the latitude, longitude and elevation of
the location, in this order.</p>
</td></tr>
<tr><td><code id="createHor_+3A_name">name</code></td>
<td>
<p>Name of site.</p>
</td></tr>
<tr><td><code id="createHor_+3A_smooth">smooth</code></td>
<td>
<p>Boolean to control whether to smooth horizon profile using rolling mean.
Defaults to FALSE</p>
</td></tr>
<tr><td><code id="createHor_+3A_.scale">.scale</code></td>
<td>
<p>Rolling mean window for smoothing. See <code><a href="#topic+createHWT">createHWT</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.skyscapeR.horizon">plot.skyscapeR.horizon</a></code>
</p>
<p><code><a href="#topic+createHWT">createHWT</a></code>, <code><a href="#topic+downloadHWT">downloadHWT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a skyscapeR.horizon from 5 measurements:
az &lt;- c(0,90,180,270,360)
alt &lt;- c(0,5,5,0,0)
hor &lt;- createHor(az, alt, 0.1, c(40.1,-8), 'Test')
plot(hor)
</code></pre>

<hr>
<h2 id='createHWT'>Create and download horizon data from <em>HeyWhatsThat</em></h2><span id='topic+createHWT'></span>

<h3>Description</h3>

<p>This function send a data request to <em>HeyWhatsThat</em>, for the
creation of a horizon profile for a give Lat/Lon and elevation. It
then downloads the data and saves it as a <em>skyscapeR.horizon</em>
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createHWT(lat, lon, elevation = 1.6, name, src = "skyscapeR", verbose = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createHWT_+3A_lat">lat</code></td>
<td>
<p>The latitude of the location.</p>
</td></tr>
<tr><td><code id="createHWT_+3A_lon">lon</code></td>
<td>
<p>The longitude of the location.</p>
</td></tr>
<tr><td><code id="createHWT_+3A_elevation">elevation</code></td>
<td>
<p>(Optional) The elevation of the observer above
ground level in meters. Default is 1.6 meters (eye level).</p>
</td></tr>
<tr><td><code id="createHWT_+3A_name">name</code></td>
<td>
<p>(Optional) Name for horizon.</p>
</td></tr>
<tr><td><code id="createHWT_+3A_src">src</code></td>
<td>
<p>(Optional) Request source ID for <em>HeyWhatsThat</em>. Default is
'skyscapeR'. Only change this if you have been given a source ID by the
creator of <em>HeyWhatsThat</em>.</p>
</td></tr>
<tr><td><code id="createHWT_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean switch to control output. Default is <em>TRUE</em>.</p>
</td></tr>
</table>


<h3>References</h3>

<p><a href="http://heywhatsthat.com/">HeyWhatsThat.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+downloadHWT">downloadHWT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create and retrieve horizon data for the London Mithraeum:
hor &lt;- createHWT(lat=ten(51,30,45), lon=ten(0,5,26.1), name='London Mithraeum')

## End(Not run)
</code></pre>

<hr>
<h2 id='curvigram'>(Defunct) Computes declination curvigram</h2><span id='topic+curvigram'></span>

<h3>Description</h3>

<p>This function no longer works. Please use <code><a href="#topic+spd">spd</a></code> of <code><a href="stats.html#topic+density">density</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curvigram()
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+spd">spd</a></code>
</p>

<hr>
<h2 id='downloadHWT'>Download horizon data from <em>HeyWhatsThat</em></h2><span id='topic+downloadHWT'></span>

<h3>Description</h3>

<p>This function downloads previously created horizon data
from <em>HeyWhatsThat</em>, given its ID, and saves it as
a <em>skyscapeR.horizon</em> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>downloadHWT(HWTID)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="downloadHWT_+3A_hwtid">HWTID</code></td>
<td>
<p>This is the 8 character ID attributed by
<em>HeyWhatsThat.com</em></p>
</td></tr>
</table>


<h3>References</h3>

<p><a href="http://heywhatsthat.com/">HeyWhatsThat.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createHWT">createHWT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Retrieve horizon data for \href{https://www.heywhatsthat.com/?view=HIFVTBGK}{Liverpool Cathedral}:
hor &lt;- downloadHWT('HIFVTBGK')

## End(Not run)
</code></pre>

<hr>
<h2 id='dS'>Declination of December Solstice for a given year</h2><span id='topic+dS'></span>

<h3>Description</h3>

<p>This function calculates the declination of the sun
at December Solstice for a given year, based upon
obliquity estimation and corrected average parallax.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dS(
  year = skyscapeR.env$cur.year,
  loc = FALSE,
  parallax = 0.00224,
  altitude = 0,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dS_+3A_year">year</code></td>
<td>
<p>Year for which to calculate the declination.
Defaults to present year as given by <em>Sys.Date</em>.</p>
</td></tr>
<tr><td><code id="dS_+3A_loc">loc</code></td>
<td>
<p>(Optional) This can be either the latitude of the
location, or a <em>skyscapeR.horizon</em> object. If missing or <em>FALSE</em>,
function will output geocentric declination.</p>
</td></tr>
<tr><td><code id="dS_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the sun.
Defaults to 0.00224.</p>
</td></tr>
<tr><td><code id="dS_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the sun. Defaults to 0 degrees.</p>
</td></tr>
<tr><td><code id="dS_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control output of warnings and messages.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+obliquity">obliquity</a></code>, <code><a href="#topic+jS">jS</a></code>, <code><a href="#topic+eq">eq</a></code>,
<code><a href="#topic+zenith">zenith</a></code>, <code><a href="#topic+antizenith">antizenith</a></code>, <code><a href="#topic+spatial.equinox">spatial.equinox</a></code>,
<code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># December Solstice geocentric declination for year 4001 BC:
dS(-4000)

# Topocentric declination for same year and latitude of 50 degrees N:
dS(-4000, loc=50)
</code></pre>

<hr>
<h2 id='EFM'>Equinoctial Full Moons</h2><span id='topic+EFM'></span>

<h3>Description</h3>

<p>This function calculates the date, rise/set times, azimuth and declination
for sun and moon on the days of the Spring Full Moon (SFM) and Autumn Full
Moon (AFM), for a given year and location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EFM(
  season = "spring",
  rise = T,
  year,
  loc,
  min.phase = 0.99,
  refraction,
  atm,
  temp,
  timezone,
  calendar
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EFM_+3A_season">season</code></td>
<td>
<p>(Optional) Either 'spring' or 'autumn'. Default is 'spring.</p>
</td></tr>
<tr><td><code id="EFM_+3A_rise">rise</code></td>
<td>
<p>(Optional) Boolean to choose whether to calculate Equinoctial Full
Moon rises or sets. Defaults to <em>TRUE</em>.</p>
</td></tr>
<tr><td><code id="EFM_+3A_year">year</code></td>
<td>
<p>Epoch(s) for which to do calculations. Can be either a single value (the year),
two values (range of years), or a vector of years.</p>
</td></tr>
<tr><td><code id="EFM_+3A_loc">loc</code></td>
<td>
<p>This can be either a <em>skyscapeR.horizon</em> object, or a vector with the
latitude, longitude and elevation of the site, in this order.</p>
</td></tr>
<tr><td><code id="EFM_+3A_min.phase">min.phase</code></td>
<td>
<p>(Optional) Minimum lunar phase (between 0 and 1) for which a
moon is considered to be full. Defaults to 0.99.</p>
</td></tr>
<tr><td><code id="EFM_+3A_refraction">refraction</code></td>
<td>
<p>(Optional) Boolean for whether or not atmospheric refraction should be taken into account.
Defaults to <em>TRUE</em>.</p>
</td></tr>
<tr><td><code id="EFM_+3A_atm">atm</code></td>
<td>
<p>(Optional) Atmospheric pressure (in mbar). Only needed if <em>refraction</em> is set to <em>TRUE</em>.
Default is 1013.25 mbar.</p>
</td></tr>
<tr><td><code id="EFM_+3A_temp">temp</code></td>
<td>
<p>(Optional) Atmospheric temperature (in Celsius). Only needed if <em>refraction</em> is set to <em>TRUE</em>.
Default is 15 degrees.</p>
</td></tr>
<tr><td><code id="EFM_+3A_timezone">timezone</code></td>
<td>
<p>(Optional) Timezone for output of rising and setting time either as a known acronym
(e.g. &quot;GMT&quot;, &quot;CET&quot;) or a string with continent followed by country capital (e.g. &quot;Europe/London&quot;). See
<a href="base.html#topic+timezones">timezones</a> for details. Defaults to system timezone.</p>
</td></tr>
<tr><td><code id="EFM_+3A_calendar">calendar</code></td>
<td>
<p>(Optional) Calendar used to output dates. G for gregorian and J for julian. Defaults to <em>Gregorian</em>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Spring Full Moon from a location in Portugal in the year 2018
EFM(year=2018, loc=c(35,-8,100))

# Autumn Full Moons in the last three years
## Not run: 
EFM(season='autumn', year=c(2019,2021), loc=c(35,-8,100))

## End(Not run)
</code></pre>

<hr>
<h2 id='eq'>Declination of the sun at the Equinox</h2><span id='topic+eq'></span>

<h3>Description</h3>

<p>This function calculates the declination of the sun
at the astronomical equinox with corrected average parallax.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq(loc = FALSE, parallax = 0.00224, altitude = 0, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq_+3A_loc">loc</code></td>
<td>
<p>(Optional) This can be either the latitude of the
location, or a <em>skyscapeR.horizon</em> object. If missing or <em>FALSE</em>,
function will output geocentric declination.</p>
</td></tr>
<tr><td><code id="eq_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the sun.
Defaults to 0.00224.</p>
</td></tr>
<tr><td><code id="eq_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the sun. Defaults to 0 degrees.</p>
</td></tr>
<tr><td><code id="eq_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control output of warnings and messages.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+obliquity">obliquity</a></code>, <code><a href="#topic+jS">jS</a></code>, <code><a href="#topic+eq">eq</a></code>,
<code><a href="#topic+zenith">zenith</a></code>, <code><a href="#topic+antizenith">antizenith</a></code>, <code><a href="#topic+spatial.equinox">spatial.equinox</a></code>, <code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Equinoctial geocentric declination:
eq()

# Topocentric declination for same year and latitude of 50 degrees N:
eq(loc=50)
</code></pre>

<hr>
<h2 id='exportHor'>Exports a <em>skyscapeR.horizon</em> object into <em>Stellarium</em> format</h2><span id='topic+exportHor'></span>

<h3>Description</h3>

<p>This function exports any <em>skyscapeR.horizon</em> object into the landscape
format of <em>Stellarium</em>, ready to be imported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exportHor(hor, name, author = "skyscapeR", description, ground_col, hor_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exportHor_+3A_hor">hor</code></td>
<td>
<p>Horizon data in <em>skyscapeR.horizon</em> format.</p>
</td></tr>
<tr><td><code id="exportHor_+3A_name">name</code></td>
<td>
<p>Horizon name to be displayed in <em>Stellarium</em>, if different
from one in <em>skyscapeR.horizon</em> object.</p>
</td></tr>
<tr><td><code id="exportHor_+3A_author">author</code></td>
<td>
<p>(Optional) Author, to be included in <em>landscape.ini</em> file.</p>
</td></tr>
<tr><td><code id="exportHor_+3A_description">description</code></td>
<td>
<p>(Optional) Description, to be included in <em>landscape.ini</em> file.</p>
</td></tr>
<tr><td><code id="exportHor_+3A_ground_col">ground_col</code></td>
<td>
<p>Color of ground. Defaults to <em>Stellarium</em>'s default.</p>
</td></tr>
<tr><td><code id="exportHor_+3A_hor_col">hor_col</code></td>
<td>
<p>Color of horizon line. Defaults to <em>Stellarium</em>'s default.</p>
</td></tr>
</table>


<h3>References</h3>

<p><a href="https://stellarium.org/">Stellarium: a free open source planetarium</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createHor">createHor</a></code>, <code><a href="#topic+downloadHWT">downloadHWT</a></code>, <code><a href="#topic+plot.skyscapeR.horizon">plot.skyscapeR.horizon</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Downloads horizon data from HeyWhatsThat and exports it into Stellarium:
## Not run: 
hor &lt;- downloadHWT('HIFVTBGK')
exportHor(hor, name='Test', description='Test horizon export to Stellarium')

## End(Not run)
</code></pre>

<hr>
<h2 id='findTargets'>Find celestial targets within declination and time ranges</h2><span id='topic+findTargets'></span>

<h3>Description</h3>

<p>Find celestial targets within declination and time ranges
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findTargets(
  decrange,
  timerange,
  max.mag = 2.5,
  loc = FALSE,
  calendar = skyscapeR.env$calendar
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findTargets_+3A_decrange">decrange</code></td>
<td>
<p>Range of declination to consider.</p>
</td></tr>
<tr><td><code id="findTargets_+3A_timerange">timerange</code></td>
<td>
<p>Temporal range to consider</p>
</td></tr>
<tr><td><code id="findTargets_+3A_max.mag">max.mag</code></td>
<td>
<p>(Optional) Maximum magnitude of stars to consider. Defaults to 2.5</p>
</td></tr>
<tr><td><code id="findTargets_+3A_loc">loc</code></td>
<td>
<p>Location, either a <em>skyscapeR.object</em> or a vector
containing the latitude, longitude and elevation of location, in this order. Defaults
to FALSE, thus checking only geocentric declination.</p>
</td></tr>
<tr><td><code id="findTargets_+3A_calendar">calendar</code></td>
<td>
<p>(Optional) Calendar used in parameter <em>time</em>. G for gregorian and J for julian.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
findTargets(c(-25,-17.5), c(-2500,-1750))

# if a location is given then the zenith and anti-zenith sun will also be looked at:
findTargets(c(3,12), c(-2500,-1750), loc=c(8.6, 7.3, 200))

# if a horizon profile is given then the spatial equinox will also be looked at:
hor &lt;- downloadHWT('J657KVEV')
findTargets(c(-7,2), c(-2500,-1750), loc=hor)

## End(Not run)
</code></pre>

<hr>
<h2 id='hor2alt'>Retrieves horizon altitude for a given azimuth from a given horizon profile</h2><span id='topic+hor2alt'></span>

<h3>Description</h3>

<p>This function retrieves the horizon altitude for a given azimuth from
a previously created <em>skyscapeR.horizon</em> object via spline interpolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hor2alt(hor, az, return.unc = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hor2alt_+3A_hor">hor</code></td>
<td>
<p>A <em>skyscapeR.horizon</em> object from which to retrieve horizon altitude.</p>
</td></tr>
<tr><td><code id="hor2alt_+3A_az">az</code></td>
<td>
<p>Array of azimuth(s) for which to retrieve horizon altitude(s).</p>
</td></tr>
<tr><td><code id="hor2alt_+3A_return.unc">return.unc</code></td>
<td>
<p>(Optional) Boolean switch control where to output altitude uncertainty.
Default is <em>FALSE</em>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+createHor">createHor</a></code>, <code><a href="#topic+downloadHWT">downloadHWT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hor &lt;- downloadHWT('HIFVTBGK')
hor2alt(hor, 90)
</code></pre>

<hr>
<h2 id='hpdi'>Returns the high-density region of a probability distribution</h2><span id='topic+hpdi'></span>

<h3>Description</h3>

<p>Returns the high-density region of a probability distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hpdi(x, mass = 0.954)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hpdi_+3A_x">x</code></td>
<td>
<p>A <em>skyscapeR.spd</em> or <em>skyscapeR.pdf</em> object.</p>
</td></tr>
<tr><td><code id="hpdi_+3A_mass">mass</code></td>
<td>
<p>(Optional) Probability mass of the region. Default is 0.954.</p>
</td></tr>
</table>

<hr>
<h2 id='jd2time'>Converts Julian date and time (in any timezone) to julian date</h2><span id='topic+jd2time'></span>

<h3>Description</h3>

<p>Converts Julian date and time (in any timezone) to julian date
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jd2time(jd, timezone, calendar, verbose = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jd2time_+3A_jd">jd</code></td>
<td>
<p>Julian date in numeric format</p>
</td></tr>
<tr><td><code id="jd2time_+3A_timezone">timezone</code></td>
<td>
<p>(Optional) Desired timezone for output either as a known acronym (e.g. &quot;GMT&quot;, &quot;CET&quot;) or
a string with continent followed by country capital (e.g. &quot;Europe/London&quot;). See
<code><a href="base.html#topic+timezones">timezones</a></code> for details. Default is system timezone.</p>
</td></tr>
<tr><td><code id="jd2time_+3A_calendar">calendar</code></td>
<td>
<p>(Optional) Calendar used in parameter <em>time</em>. G for gregorian and J for julian.
Only needed if <em>time</em> is a string. Defaults to <em>Gregorian</em>.</p>
</td></tr>
<tr><td><code id="jd2time_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Controls whether messages should be displayed. Default is <em>FALSE</em>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="swephR.html#topic+swe_julday">swe_julday</a></code>, <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt</a></code>, <code><a href="base.html#topic+timezones">timezones</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>jd &lt;- time2jd('2018/12/25 12:00:00', 'GMT') # Julian date at noon GMT on Christmas day 2018
jd2time(jd, 'CET') # converts julian date to Central European timezone
</code></pre>

<hr>
<h2 id='jS'>Declination of June Solstice for a given year</h2><span id='topic+jS'></span>

<h3>Description</h3>

<p>This function calculates the declination of the sun
at June Solstice for a given year, based upon
obliquity estimation and corrected average parallax.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jS(
  year = skyscapeR.env$cur.year,
  loc = FALSE,
  parallax = 0.00224,
  altitude = 0,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jS_+3A_year">year</code></td>
<td>
<p>Year for which to calculate the declination.
Defaults to present year as given by <em>Sys.Date</em>.</p>
</td></tr>
<tr><td><code id="jS_+3A_loc">loc</code></td>
<td>
<p>(Optional) This can be either the latitude of the
location, or a <em>skyscapeR.horizon</em> object. If missing or <em>FALSE</em>,
function will output geocentric declination.</p>
</td></tr>
<tr><td><code id="jS_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the sun.
Defaults to 0.00224.</p>
</td></tr>
<tr><td><code id="jS_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the sun. Defaults to 0 degrees.</p>
</td></tr>
<tr><td><code id="jS_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control output of warnings and messages.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+obliquity">obliquity</a></code>, <code><a href="#topic+dS">dS</a></code>, <code><a href="#topic+eq">eq</a></code>,
<code><a href="#topic+zenith">zenith</a></code>, <code><a href="#topic+antizenith">antizenith</a></code>, <code><a href="#topic+spatial.equinox">spatial.equinox</a></code>,
<code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># June Solstice geocentric declination for year 4001 BC:
jS(-4000)

# Topocentric declination for same year and latitude of 50 degres N:
jS(-4000, loc=50)
</code></pre>

<hr>
<h2 id='long.date'>Converts day-month in 'MM-DD' format to a more readable format</h2><span id='topic+long.date'></span>

<h3>Description</h3>

<p>Converts day-month in 'MM-DD' format to a more readable format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>long.date(date)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="long.date_+3A_date">date</code></td>
<td>
<p>date in 'MM-DD' format</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>long.date('01-01')
long.date('08-23')
</code></pre>

<hr>
<h2 id='mag.dec'>Estimates magnetic declination (difference between true and magnetic
north) based on IGRF 12th gen model</h2><span id='topic+mag.dec'></span>

<h3>Description</h3>

<p>This function estimates the magnetic declination at a given location
and moment in time, using the <em>12th generation International
Geomagnetic Reference Field (IGRF)</em> model. This function is a wrapper
for function <code><a href="oce.html#topic+magneticField">magneticField</a></code> of package <em>oce</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mag.dec(loc, date)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mag.dec_+3A_loc">loc</code></td>
<td>
<p>Location, can be either a <em>skyscapeR.horizon</em> object or, alternatively,
a latitude.</p>
</td></tr>
<tr><td><code id="mag.dec_+3A_date">date</code></td>
<td>
<p>Date for which to calculate magnetic declination in the format: 'YYYY/MM/DD'</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="oce.html#topic+magneticField">magneticField</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Magnetic Declination for London on April 1st 2016:
loc &lt;- c( 51.5074, -0.1278 )
mag.dec( loc, "2016/04/01" )
</code></pre>

<hr>
<h2 id='moonphase'>Computes the phase of the moon</h2><span id='topic+moonphase'></span>

<h3>Description</h3>

<p>This function calculates the moon phase, in percentage of full. It is a wrapper
for function <code><a href="swephR.html#topic+swe_pheno_ut">swe_pheno_ut</a></code> of package <em>swephR</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moonphase(time, timezone, calendar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="moonphase_+3A_time">time</code></td>
<td>
<p>Either a string containing the date and time in the format &quot;YYYY-MM-DD HH:MM:SS&quot;
(see <code><a href="#topic+timestring">timestring</a></code>), or a numeric containing the julian date (see <code><a href="#topic+time2jd">time2jd</a></code>).</p>
</td></tr>
<tr><td><code id="moonphase_+3A_timezone">timezone</code></td>
<td>
<p>(Optional) Timezone of input either as a known acronym (e.g. &quot;GMT&quot;, &quot;CET&quot;) or
a string with continent followed by country capital (e.g. &quot;Europe/London&quot;). See
<a href="base.html#topic+timezones">timezones</a> for details. Only needed if <em>time</em> is a string. Defaults to system timezone.</p>
</td></tr>
<tr><td><code id="moonphase_+3A_calendar">calendar</code></td>
<td>
<p>(Optional) Calendar used in parameter <em>time</em>. G for gregorian and J for julian.
Only needed if <em>time</em> is a string. Defaults to Gregorian.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="swephR.html#topic+swe_pheno_ut">swe_pheno_ut</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Moonphase at noon GMT on Christmas day 2018:
moonphase('2018/12/25 12:00:00', 'GMT')
</code></pre>

<hr>
<h2 id='nMjLX'>Declination of northern major Lunar Extreme for a given year</h2><span id='topic+nMjLX'></span>

<h3>Description</h3>

<p>This function calculates the declination of the northern
major Lunar Extreme for a given year, based upon
obliquity estimation and corrected average parallax.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nMjLX(
  year = skyscapeR.env$cur.year,
  loc = FALSE,
  parallax = 0.952,
  altitude = 0,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nMjLX_+3A_year">year</code></td>
<td>
<p>Year for which to calculate the declination.
Defaults to present year as given by <em>Sys.Date</em>.</p>
</td></tr>
<tr><td><code id="nMjLX_+3A_loc">loc</code></td>
<td>
<p>(Optional) This can be either the latitude of the
location, or a <em>skyscapeR.horizon</em> object. If missing or <em>FALSE</em>,
function will output geocentric declination.</p>
</td></tr>
<tr><td><code id="nMjLX_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the moon
Defaults to 0.952.</p>
</td></tr>
<tr><td><code id="nMjLX_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the sun. Defaults to 0 degrees.</p>
</td></tr>
<tr><td><code id="nMjLX_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control output of warnings and messages.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+nmnLX">nmnLX</a></code>, <code><a href="#topic+smnLX">smnLX</a></code>, <code><a href="#topic+sMjLX">sMjLX</a></code>,
<code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Northern major Lunar Extreme geocentric declination for year 2501 BC:
nMjLX(-2500)

# Topocentric declination for same year and latitude of 50 degrees N:
nMjLX(-2500, loc=50)
</code></pre>

<hr>
<h2 id='nmnLX'>Declination of northern minor Lunar Extreme for a given year</h2><span id='topic+nmnLX'></span>

<h3>Description</h3>

<p>This function calculates the declination of the northern
minor Lunar Extreme for a given year, based upon
obliquity estimation and corrected average parallax.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nmnLX(
  year = skyscapeR.env$cur.year,
  loc = FALSE,
  parallax = 0.952,
  altitude = 0,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nmnLX_+3A_year">year</code></td>
<td>
<p>Year for which to calculate the declination.
Defaults to present year as given by <em>Sys.Date</em>.</p>
</td></tr>
<tr><td><code id="nmnLX_+3A_loc">loc</code></td>
<td>
<p>(Optional) This can be either the latitude of the
location, or a <em>skyscapeR.horizon</em> object. If missing or <em>FALSE</em>,
function will output geocentric declination.</p>
</td></tr>
<tr><td><code id="nmnLX_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the moon
Defaults to 0.952.</p>
</td></tr>
<tr><td><code id="nmnLX_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the sun. Defaults to 0 degrees.</p>
</td></tr>
<tr><td><code id="nmnLX_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control output of warnings and messages.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+smnLX">smnLX</a></code>, <code><a href="#topic+nMjLX">nMjLX</a></code>, <code><a href="#topic+sMjLX">sMjLX</a></code>,
<code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Northern minor Lunar Extreme geocentric declination for year 2501 BC:
nmnLX(-2500)

# Topocentric declination for same year and latitude of 50 degrees N:
nmnLX(-2500, loc=50)
</code></pre>

<hr>
<h2 id='obliquity'>Computes obliquity of the ecliptic</h2><span id='topic+obliquity'></span>

<h3>Description</h3>

<p>This function calculates the obliquity for a given epoch. It is a
wrapper for function <code><a href="swephR.html#topic+swe_calc_ut">swe_calc_ut</a></code> of package <em>swephR</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obliquity(year = skyscapeR.env$cur.year)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="obliquity_+3A_year">year</code></td>
<td>
<p>Year for which to calculate the obliquity.
Defaults to present year as given by <em>Sys.Date</em></p>
</td></tr>
</table>


<h3>References</h3>

<p>Laskar, J. et al. (2004), A long-term numerical
solution for the insolation quantities of the Earth, <em>Astron.
Astroph.</em>, 428, 261-285, doi:10.1051/0004-6361:20041335.
</p>


<h3>See Also</h3>

<p><code><a href="swephR.html#topic+swe_calc_ut">swe_calc_ut</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' # Obliquity for year 3999 BC:
obliquity(-4000)
</code></pre>

<hr>
<h2 id='orbit'>Calculate visible path of celestial object at given location</h2><span id='topic+orbit'></span>

<h3>Description</h3>

<p>This function calculates the visible path of a celestial
object from any location on earth. It outputs a <em>skyscapeR.orbit</em>
object, which includes AZ and ALT information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbit(dec, loc, res = 0.25, refraction, atm, temp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbit_+3A_dec">dec</code></td>
<td>
<p>Declination of object.</p>
</td></tr>
<tr><td><code id="orbit_+3A_loc">loc</code></td>
<td>
<p>Location, either a <em>skyscapeR.object</em> or a vector
containing the latitude and longitude of location, in this order.</p>
</td></tr>
<tr><td><code id="orbit_+3A_res">res</code></td>
<td>
<p>The resolution (in degrees of RA) with which to calculate the path.</p>
</td></tr>
<tr><td><code id="orbit_+3A_refraction">refraction</code></td>
<td>
<p>(Optional) Whether atmospheric refraction is to be taken into account.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="orbit_+3A_atm">atm</code></td>
<td>
<p>(Optional) Atmospheric pressure for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="orbit_+3A_temp">temp</code></td>
<td>
<p>(Optional) Atmospheric temperature for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Visible path of sun on june solstice on year 3999 BC from London:
sun.dec &lt;- jS(-4000)
london.lat &lt;- 51.5074 #N
london.lon &lt;- -0.1278 #W
loc &lt;- c( london.lat, london.lon, 0 )
path &lt;- orbit(sun.dec, loc)
plot(path$az, path$alt, ylim=c(0,90), type='l', xlab='AZ', ylab='ALT', col='red', lwd=2)
</code></pre>

<hr>
<h2 id='parallax.corr'>Corrected parallax for a given location and object altitude</h2><span id='topic+parallax.corr'></span>

<h3>Description</h3>

<p>Given the average parallax, this function corrects this value for a given latitude of the observer
and for the altitude of the celestial object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parallax.corr(parallax, loc, altitude = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parallax.corr_+3A_parallax">parallax</code></td>
<td>
<p>Average parallax to correct (e.g. 0.00224 for the Sun, or 0.952 for the Moon)</p>
</td></tr>
<tr><td><code id="parallax.corr_+3A_loc">loc</code></td>
<td>
<p>This can be either the latitude of the location, or a <em>skyscapeR.horizon</em> object.</p>
</td></tr>
<tr><td><code id="parallax.corr_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the celestial object.. Defaults to 0 degrees.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Parallax correction for the moon, as seen from latitude 50ยบN and at 0ยบ altitude
parallax.corr(0.952, 50, 0)
</code></pre>

<hr>
<h2 id='plot.skyscapeR.horizon'>Plot horizon data</h2><span id='topic+plot.skyscapeR.horizon'></span>

<h3>Description</h3>

<p>This function creates a plot of horizon data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'skyscapeR.horizon'
plot(
  x,
  show.az = F,
  xlim,
  ylim,
  obj,
  refraction = F,
  col.ground = "#fdae61",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.skyscapeR.horizon_+3A_x">x</code></td>
<td>
<p>Object of <em>skyscapeR.horizon</em> format.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.horizon_+3A_show.az">show.az</code></td>
<td>
<p>(Optional) Boolean that controls whether to display azimuth values or cardinal
directions. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.horizon_+3A_xlim">xlim</code></td>
<td>
<p>(Optional) Azimuth rage for plotting.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.horizon_+3A_ylim">ylim</code></td>
<td>
<p>(Optional) Altitude rage for plotting.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.horizon_+3A_obj">obj</code></td>
<td>
<p>(Optional) A <em>skyscapeR.object</em> object created with <code><a href="#topic+sky.objects">sky.objects</a></code>
for displaying the paths of celestial objects.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.horizon_+3A_refraction">refraction</code></td>
<td>
<p>(Optional) Boolean switch controlling whether to take refraction into account
when displaying the paths of celestial objects.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.horizon_+3A_col.ground">col.ground</code></td>
<td>
<p>(Optional) Color of the ground. Defaults to <em>#fdae61</em>.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.horizon_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <em>plot</em>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+downloadHWT">downloadHWT</a></code>, <code><a href="#topic+sky.objects">sky.objects</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot a horizon retrieved from HeyWhatsThat:
hor &lt;- downloadHWT('HIFVTBGK')
plot(hor)

# Add the paths of the solstices and equinoxes sun in the year 1999 BC:
tt &lt;- sky.objects('solar extremes', epoch=-2000, col='blue')
plot(hor, obj=tt)
</code></pre>

<hr>
<h2 id='plot.skyscapeR.pdf'>Plot orientation probability distributions</h2><span id='topic+plot.skyscapeR.pdf'></span>

<h3>Description</h3>

<p>Plot orientation probability distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'skyscapeR.pdf'
plot(
  x,
  index,
  hdr = 0.954,
  show.az = T,
  xlim,
  col = MESS::col.alpha("blue", 0.5),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.skyscapeR.pdf_+3A_x">x</code></td>
<td>
<p>A <em>skyscapeR.pdf</em> object created with either <code><a href="#topic+az.pdf">az.pdf</a></code> or <code><a href="#topic+coordtrans">coordtrans</a></code></p>
</td></tr>
<tr><td><code id="plot.skyscapeR.pdf_+3A_index">index</code></td>
<td>
<p>(Optional) A value to indicate which distribution to plot, when only one is desired.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.pdf_+3A_hdr">hdr</code></td>
<td>
<p>(Optional) High density region to highlight. Defaults to 0.954</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.pdf_+3A_show.az">show.az</code></td>
<td>
<p>(Optional) Whether to show the azimuth and transformation curve (horizon) when
displaying declination distributions. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.pdf_+3A_xlim">xlim</code></td>
<td>
<p>(Optional) Range of x-axis to plot.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.pdf_+3A_col">col</code></td>
<td>
<p>(Optional) Color of high density region to highlight. Defaults to blue with 0.5 alpha.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.pdf_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <em>plot</em>.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.skyscapeR.sigTest'>Plot significance test of orientations</h2><span id='topic+plot.skyscapeR.sigTest'></span>

<h3>Description</h3>

<p>Plot significance test of orientations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'skyscapeR.sigTest'
plot(
  x,
  xlim,
  title = NULL,
  show.pval = T,
  show.local = F,
  pal = brewer.pal(5, "PRGn")[c(1, 5)],
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.skyscapeR.sigTest_+3A_x">x</code></td>
<td>
<p>A <em>skyscapeR.sigTest</em> object created with <code><a href="#topic+randomTest">randomTest</a></code></p>
</td></tr>
<tr><td><code id="plot.skyscapeR.sigTest_+3A_xlim">xlim</code></td>
<td>
<p>(Optional) Range of x-axis to plot.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.sigTest_+3A_title">title</code></td>
<td>
<p>(Optional) Title to add to the plot.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.sigTest_+3A_show.pval">show.pval</code></td>
<td>
<p>(Optional) Boolean to control whether to print the global p-value. Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.sigTest_+3A_show.local">show.local</code></td>
<td>
<p>(Optional) Boolean to control whether to show local regions of significance. Default is FALSE</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.sigTest_+3A_pal">pal</code></td>
<td>
<p>(Optional) Color palette for local regions of significance. Default is brewer.pal(5, 'PRGn')</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.sigTest_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <em>plot</em>.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.skyscapeR.spd'>Plot orientation summed probability density</h2><span id='topic+plot.skyscapeR.spd'></span>

<h3>Description</h3>

<p>Plot orientation summed probability density
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'skyscapeR.spd'
plot(x, xlim, ylim, title = NULL, col = "blue", shading = T, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.skyscapeR.spd_+3A_x">x</code></td>
<td>
<p>A <em>skyscapeR.spd</em> object created with <code><a href="#topic+spd">spd</a></code></p>
</td></tr>
<tr><td><code id="plot.skyscapeR.spd_+3A_xlim">xlim</code></td>
<td>
<p>(Optional) Range of x-axis to plot.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.spd_+3A_ylim">ylim</code></td>
<td>
<p>(Optional) Range of y-axis to plot.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.spd_+3A_title">title</code></td>
<td>
<p>(Optional) Title to add to the plot.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.spd_+3A_col">col</code></td>
<td>
<p>(Optional) Color of summed probability density. Defaults to blue with 0.5 alpha.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.spd_+3A_shading">shading</code></td>
<td>
<p>(Optional) Boolean to control whether to color the entire distribution. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.spd_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <em>plot</em>.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.skyscapeR.starphases'>Plot stellar phase and seasonality</h2><span id='topic+plot.skyscapeR.starphases'></span>

<h3>Description</h3>

<p>This function creates a plot of stellar seasonality and phases/events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'skyscapeR.starphases'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.skyscapeR.starphases_+3A_x">x</code></td>
<td>
<p>Object of <em>skyscapeR.starphases</em> format.</p>
</td></tr>
<tr><td><code id="plot.skyscapeR.starphases_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <em>plot</em>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+star.phases">star.phases</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot the seasonality of Aldebaran for 3999 BCE:
## Not run: 
ss &lt;- star.phases('Aldebaran',-4000, c(35,-8, 200))
plot(ss)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotAzimuth'>Polar plot of orientations (azimuths)</h2><span id='topic+plotAzimuth'></span>

<h3>Description</h3>

<p>Polar plot of orientations (azimuths)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAzimuth(az, col = "blue", lwd = 1.5, lty = 1, obj, show.obj.labels = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotAzimuth_+3A_az">az</code></td>
<td>
<p>(Optional) Array of azimuths. Can be omitted is <em>obj</em> is given.</p>
</td></tr>
<tr><td><code id="plotAzimuth_+3A_col">col</code></td>
<td>
<p>(Optional) Single color or color palette to use for plotting measurements.</p>
</td></tr>
<tr><td><code id="plotAzimuth_+3A_lwd">lwd</code></td>
<td>
<p>(Optional) Line width to plot measurements. Defaults to 1.</p>
</td></tr>
<tr><td><code id="plotAzimuth_+3A_lty">lty</code></td>
<td>
<p>(Optional) Line type to plot measurements. Defaults to 1.</p>
</td></tr>
<tr><td><code id="plotAzimuth_+3A_obj">obj</code></td>
<td>
<p>(Optional) A <em>skyscapeR.object</em> object created with <code><a href="#topic+sky.objects">sky.objects</a></code>
for displaying the azimuths of celestial objects. Note that this assumes a single
location and a flat horizon of zero degrees.</p>
</td></tr>
<tr><td><code id="plotAzimuth_+3A_show.obj.labels">show.obj.labels</code></td>
<td>
<p>(Optional) Boolean to control whether to display celestial objects names.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Plot some azimuth data:
az &lt;- c(120, 100, 93, 97, 88, 115, 112, 67)
plotAzimuth(az)

# To visualize this data against the common solar and lunar targets:
tt &lt;- sky.objects('solar extremes', epoch=-2000, loc=c(35,-8), col='red')
plotAzimuth(az, obj=tt)

# To display only celestial objects
plotAzimuth(obj=tt)
</code></pre>

<hr>
<h2 id='plotBars'>Bar plot of orientations (declination)</h2><span id='topic+plotBars'></span>

<h3>Description</h3>

<p>Bar plot of orientations (declination)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBars(
  val,
  unc,
  names,
  unit = "Declination",
  col = "blue",
  shade = TRUE,
  mark = TRUE,
  sort = FALSE,
  xrange,
  yrange,
  obj,
  show.obj.label = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotBars_+3A_val">val</code></td>
<td>
<p>Array of declination or azimuth values.</p>
</td></tr>
<tr><td><code id="plotBars_+3A_unc">unc</code></td>
<td>
<p>Single value or array of measurement uncertainty</p>
</td></tr>
<tr><td><code id="plotBars_+3A_names">names</code></td>
<td>
<p>(Optional) Array of names of measurements in <em>val</em></p>
</td></tr>
<tr><td><code id="plotBars_+3A_unit">unit</code></td>
<td>
<p>(Optional). Either 'Declination' or 'Azimuth'. Defaults to 'Declination'.</p>
</td></tr>
<tr><td><code id="plotBars_+3A_col">col</code></td>
<td>
<p>(Optional) Color to plot measurements in. Defaults to <em>blue</em>.</p>
</td></tr>
<tr><td><code id="plotBars_+3A_shade">shade</code></td>
<td>
<p>(Optional) Boolean to control whether to shade a polygon of measurements. Defaults
to <em>TRUE</em></p>
</td></tr>
<tr><td><code id="plotBars_+3A_mark">mark</code></td>
<td>
<p>(Optional) Boolean to control whether to mark the declination value. Defaults to
<em>TRUE</em></p>
</td></tr>
<tr><td><code id="plotBars_+3A_sort">sort</code></td>
<td>
<p>(Optional) Boolean to control whether to sort the measurements by their declination
value. Defaults to <em>FALSE</em></p>
</td></tr>
<tr><td><code id="plotBars_+3A_xrange">xrange</code></td>
<td>
<p>(Optional) Array of limits for x-axis.</p>
</td></tr>
<tr><td><code id="plotBars_+3A_yrange">yrange</code></td>
<td>
<p>(Optional) Array of limits for y-axis.</p>
</td></tr>
<tr><td><code id="plotBars_+3A_obj">obj</code></td>
<td>
<p>(Optional) A <em>skyscapeR.object</em> object created with <code><a href="#topic+sky.objects">sky.objects</a></code>
for displaying the declination values of celestial objects.</p>
</td></tr>
<tr><td><code id="plotBars_+3A_show.obj.label">show.obj.label</code></td>
<td>
<p>(Optional) Boolean to control whether to label the celestial objects in
the polar plot. Defaults to <em>TRUE</em>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+sky.objects">sky.objects</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot some declination data:
decs &lt;- c(10, 12, -5, 4)
plotBars(decs, unc=5)

# To visualize this data against the common solar and lunar targets:
tt &lt;- sky.objects(c('solar extremes','lunar extremes'), epoch=-2000, lty=c(2,3))
plotBars(decs, unc=5, obj=tt)
</code></pre>

<hr>
<h2 id='print.skyscapeR.sigTest'>Prints significance test results</h2><span id='topic+print.skyscapeR.sigTest'></span>

<h3>Description</h3>

<p>This function prints the results of <code><a href="#topic+randomTest">randomTest</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'skyscapeR.sigTest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.skyscapeR.sigTest_+3A_x">x</code></td>
<td>
<p>Object of <em>skyscapeR.sigTest</em> format.</p>
</td></tr>
<tr><td><code id="print.skyscapeR.sigTest_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <em>print</em>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+randomTest">randomTest</a></code>
</p>

<hr>
<h2 id='pval2stars'>Converts p-value into symbol</h2><span id='topic+pval2stars'></span>

<h3>Description</h3>

<p>Converts p-value into symbol
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pval2stars(p.value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pval2stars_+3A_p.value">p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
</table>

<hr>
<h2 id='randomTest'>Significance test against the null hypothesis of random orientation</h2><span id='topic+randomTest'></span>

<h3>Description</h3>

<p>Significance test against the null hypothesis of random orientation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomTest(
  pdf,
  nsims = 1000,
  conf = 0.95,
  tails = 2,
  normalise = F,
  ncores = parallel::detectCores() - 1,
  save.sim = F,
  verbose = T
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomTest_+3A_pdf">pdf</code></td>
<td>
<p>A <em>skyscapeR.pdf</em> object created with either <code><a href="#topic+az.pdf">az.pdf</a></code> or <code><a href="#topic+coordtrans">coordtrans</a></code></p>
</td></tr>
<tr><td><code id="randomTest_+3A_nsims">nsims</code></td>
<td>
<p>(Optional) Boolean switch controlling whether to normalize the SPD. Default is FALSE</p>
</td></tr>
<tr><td><code id="randomTest_+3A_conf">conf</code></td>
<td>
<p>(Optional) Array of values (min and max) for SPD if different from range of <em>pdf</em></p>
</td></tr>
<tr><td><code id="randomTest_+3A_tails">tails</code></td>
<td>
<p>(Optional) Whether to calculate 1-tailed p-value (greater than) or 2-tailed p-value (smaller than or greater than).
Default is 2.</p>
</td></tr>
<tr><td><code id="randomTest_+3A_normalise">normalise</code></td>
<td>
<p>(Optional) Boolean to control whether to normalize SPDs. Default is FALSE</p>
</td></tr>
<tr><td><code id="randomTest_+3A_ncores">ncores</code></td>
<td>
<p>(Optional) Number of CPU cores to use. Default is the number of available cores minus 1.</p>
</td></tr>
<tr><td><code id="randomTest_+3A_save.sim">save.sim</code></td>
<td>
<p>(Optional) Boolean to control whether to save the output of each random simulation.
For testing/advanced use only. Default is FALSE</p>
</td></tr>
<tr><td><code id="randomTest_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control whether or not to display text. Default is TRUE.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Silva, F (2020) A probabilistic framework and significance test for the analysis of structural orientations
in skyscape archaeology <em>Journal of Archaeological Science</em> 118, 105138. &lt;doi:10.1016/j.jas.2020.105138&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# significance test for azimuth
Az &lt;- az.pdf(az=c(87,93,90,110), unc=3)
st1 &lt;- randomTest(Az, nsims=1000)
plot(st1)

# significance test for declination
hor &lt;- createHor(az=c(0,360), alt=c(0,0), loc=c(35,-8,25)) # flat horizon with 0 degrees of altitude
Dec &lt;- coordtrans(Az, hor)
st2 &lt;- randomTest(Dec, nsims=1000)
plot(st2)

## End(Not run)
</code></pre>

<hr>
<h2 id='reduct.compass'>Data reduction for compass measurements</h2><span id='topic+reduct.compass'></span>

<h3>Description</h3>

<p>This function calculates the true azimuth of a structure measured with
a compass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reduct.compass(loc, mag.az, date, magdec, alt, name, ID, HWT.ID)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reduct.compass_+3A_loc">loc</code></td>
<td>
<p>Location, either a <em>skyscapeR.object</em> or a vector
containing the latitude, longitude and elevation of location, in this order.</p>
</td></tr>
<tr><td><code id="reduct.compass_+3A_mag.az">mag.az</code></td>
<td>
<p>Array of magnetic azimuth measurements.</p>
</td></tr>
<tr><td><code id="reduct.compass_+3A_date">date</code></td>
<td>
<p>(Optional) Date of measurements as a string in the format: 'YYYY/MM/DD'.
Only necessary if <em>magdec</em> is not given.</p>
</td></tr>
<tr><td><code id="reduct.compass_+3A_magdec">magdec</code></td>
<td>
<p>(Optional) Magnetic declination, if known.</p>
</td></tr>
<tr><td><code id="reduct.compass_+3A_alt">alt</code></td>
<td>
<p>(Optional) Altitude, necessary for automatic declination calculation.
If missing and <em>loc</em> is a <em>skyscapeR.horizon</em> object then the altitude
will be automatically read from the horizon profile.</p>
</td></tr>
<tr><td><code id="reduct.compass_+3A_name">name</code></td>
<td>
<p>(Optional) Names or labels to identify each measurement.</p>
</td></tr>
<tr><td><code id="reduct.compass_+3A_id">ID</code></td>
<td>
<p>(Optional) IDs or codes to identify each measurement.</p>
</td></tr>
<tr><td><code id="reduct.compass_+3A_hwt.id">HWT.ID</code></td>
<td>
<p>(Optional) HeyWhatsThat IDs relating to a previously generated
horizon profile for measurement.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mag.dec">mag.dec</a></code>, <code><a href="#topic+az2dec">az2dec</a></code>, <code><a href="#topic+hor2alt">hor2alt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>loc &lt;- c(35,-7, 100)
mag.az &lt;- c(89.5, 105, 109.5)
data &lt;- reduct.compass(loc, mag.az, "2016/04/02")

# Declination will be automatically calculated if the altitude is also given:
data &lt;- reduct.compass(loc, mag.az, "2016/04/02", alt=c(1,2,0))

# Alternatively, the altitude can be automatically retrieved from a horizon profile:
hor &lt;- downloadHWT('HIFVTBGK')
data &lt;- reduct.compass(hor, mag.az, "2016/04/02")
</code></pre>

<hr>
<h2 id='reduct.theodolite'>Data reduction for theodolite measurements using the sun-sight method</h2><span id='topic+reduct.theodolite'></span>

<h3>Description</h3>

<p>This function calculates the true azimuth of a structure measured with
a theodolite using the sun-sight technique.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reduct.theodolite(
  loc,
  az,
  date,
  time,
  tz,
  az.sun = 0,
  limb,
  alt,
  name,
  ID,
  HWT.ID
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reduct.theodolite_+3A_loc">loc</code></td>
<td>
<p>Location, either a <em>skyscapeR.object</em> or a vector
containing the latitude, longitude and elevation of location, in this order.</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_az">az</code></td>
<td>
<p>Array of azimuths. Use <code><a href="#topic+ten">ten</a></code> to convert to
decimal point format if necessary.</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_date">date</code></td>
<td>
<p>Date of measurements as a string in the format: 'YYYY/MM/DD'</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_time">time</code></td>
<td>
<p>Time of sun-sight measurement in the format: 'HH:MM:SS'</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_tz">tz</code></td>
<td>
<p>Timezone of input wither as a known acronym (e.g. &quot;GMT&quot;, &quot;CET&quot;) or
a string with continent followed by country capital (e.g. &quot;Europe/London&quot;).</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_az.sun">az.sun</code></td>
<td>
<p>(Optional) Measured azimuth of the sun. Defaults to zero.</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_limb">limb</code></td>
<td>
<p>(Optional) Measured limb of the sun. Options are <em>left</em>, <em>right</em>.
If missing the center of the sun will be used for calculations.</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_alt">alt</code></td>
<td>
<p>(Optional) Altitude, necessary for automatic declination calculation.
If missing and <em>loc</em> is a <em>skyscapeR.horizon</em> object then the altitude
will be automatically read from the horizon profile.</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_name">name</code></td>
<td>
<p>(Optional) Names or labels to identify each measurement.</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_id">ID</code></td>
<td>
<p>(Optional) IDs or codes to identify each measurement.</p>
</td></tr>
<tr><td><code id="reduct.theodolite_+3A_hwt.id">HWT.ID</code></td>
<td>
<p>(Optional) HeyWhatsThat IDs relating to a previously generated
horizon profile for measurement.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ruggles, C.L.N. (1999). <em>Astronomy in Prehistoric Britain and Ireland</em>.
Yale University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sunAz">sunAz</a></code>, <code><a href="#topic+ten">ten</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lat &lt;- ten(35,50,37.8)
lon &lt;- ten(14,34,6.4)
elev &lt;- 100
az &lt;- c( ten(298,24,10), ten(302,20,40))
az.sun &lt;- ten(327,29,50)
date &lt;- "2016/02/20"
time &lt;- "11:07:17"

data &lt;- reduct.theodolite(c(lat,lon,elev), az, date , time, tz= "Europe/Malta", az.sun)

# Declination will be automatically calculated if the altitude is also given:
data &lt;- reduct.theodolite(c(lat,lon,elev), az, date , time, tz= "Europe/Malta", az.sun, alt=c(2,5))

# Alternatively, the altitude can be automatically retrieved from a horizon profile:
hor &lt;- downloadHWT('HIFVTBGK')
data &lt;- reduct.theodolite(hor, az, date, time, tz= "Europe/Malta", az.sun)
</code></pre>

<hr>
<h2 id='riseset'>Computes the rising and setting azimuth, declination and time of a Solar System object
for a given location and day</h2><span id='topic+riseset'></span>

<h3>Description</h3>

<p>Computes the rising and setting azimuth, declination and time of a Solar System object
for a given location and day
</p>


<h3>Usage</h3>

<pre><code class='language-R'>riseset(
  obj = "sun",
  date,
  jd,
  alt = 0,
  loc,
  calendar,
  timezone,
  dec,
  refraction,
  atm,
  temp,
  verbose = T
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="riseset_+3A_obj">obj</code></td>
<td>
<p>(Optional) String containing name of the solar system body of interest. Can be
any of the planets (inc. Pluto), the Moon, the Sun or the Ecliptic. Defaults to 'sun'.</p>
</td></tr>
<tr><td><code id="riseset_+3A_date">date</code></td>
<td>
<p>Either a string containing the date in the format &quot;YYYY/MM/DD&quot;
(see <code><a href="#topic+timestring">timestring</a></code>), or a numeric containing the julian date (see <code><a href="#topic+time2jd">time2jd</a></code>).
Can also be a single year (&quot;YYYY&quot;) or a month (&quot;YYYY/MM&quot;) to calculate risings and settings for every day in the
year or month, respectively. Not necessary if <em>jd</em> is given.</p>
</td></tr>
<tr><td><code id="riseset_+3A_jd">jd</code></td>
<td>
<p>(Optional) A numeric containing the julian date (see <code><a href="#topic+time2jd">time2jd</a></code>) for which to
calculate rising and settings. Only needed if <em>date</em> is not given.</p>
</td></tr>
<tr><td><code id="riseset_+3A_alt">alt</code></td>
<td>
<p>(Optional) The altitude of the horizon to consider. Defaults to zero degrees.</p>
</td></tr>
<tr><td><code id="riseset_+3A_loc">loc</code></td>
<td>
<p>Location, either a <em>skyscapeR.object</em> or a vector
containing the latitude, longitude and elevation of location, in this order.</p>
</td></tr>
<tr><td><code id="riseset_+3A_calendar">calendar</code></td>
<td>
<p>(Optional) Calendar used in parameter <em>date</em>. G for gregorian and J for julian.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="riseset_+3A_timezone">timezone</code></td>
<td>
<p>(Optional) Timezone for output of rising and setting time either as a known acronym
(e.g. &quot;GMT&quot;, &quot;CET&quot;) or a string with continent followed by country capital (e.g. &quot;Europe/London&quot;). See
<a href="base.html#topic+timezones">timezones</a> for details. If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="riseset_+3A_dec">dec</code></td>
<td>
<p>(Optional) Output declination: <em>geo</em> for the geocentric, or <em>topo</em> for the topocentric
frame of reference. If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="riseset_+3A_refraction">refraction</code></td>
<td>
<p>(Optional) Whether atmospheric refraction is to be taken into account.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="riseset_+3A_atm">atm</code></td>
<td>
<p>(Optional) Atmospheric pressure for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="riseset_+3A_temp">temp</code></td>
<td>
<p>(Optional) Atmospheric temperature for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.#'</p>
</td></tr>
<tr><td><code id="riseset_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control whether or not to display text. Default is TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="swephR.html#topic+swe_calc_ut">swe_calc_ut</a></code>, <code><a href="swephR.html#topic+swe_azalt">swe_azalt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Rising and setting of the sun on june solstice 2018, from the location of London
riseset('sun', '2018/06/21', loc=c(51.5, 0.11, 100))

# Rising ans setting of the moon on june solstice 2018, using a horizon profile
hor &lt;- downloadHWT('HIFVTBGK') # Liverpool cathedral
riseset('moon', '2018/06/21', loc=hor)

# Rising and setting of the sun throughout February 1999, from the location of London
riseset('sun', '1999/02', loc=c(51.5, 0.11, 100))

## Not run: 
# Rising and setting of the sun throughout 3001 BC, from the location of London
riseset('sun', -3000, loc=c(51.5, 0.11, 100))

## End(Not run)
</code></pre>

<hr>
<h2 id='RugglesCKR'>Cork and Kerry Stone Row Data</h2><span id='topic+RugglesCKR'></span>

<h3>Description</h3>

<p>Data from C.L.N. Ruggles' fieldwork on the Stone Rows of Cork and Kerry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RugglesCKR)
</code></pre>


<h3>Format</h3>

<p>A data frame with 41 rows and 5 variables:
</p>

<dl>
<dt>Ref</dt><dd><p>Site Ref</p>
</dd>
<dt>NE.SW</dt><dd><p>String indicating whether they are towards the NE or SW</p>
</dd>
<dt>Az.Hill</dt><dd><p>Azimuth of hill towards which the Stone Rows are pointing</p>
</dd>
<dt>Alt.Hill</dt><dd><p>Altitude of hill towards which the Stone Rows are pointing</p>
</dd>
<dt>Dec.Hill</dt><dd><p>Declination of hill towards which the Stone Rows are pointing</p>
</dd>
</dl>



<h3>References</h3>

<p>Ruggles, C.L.N. (1999). <em>Astronomy in Prehistoric Britain and Ireland</em>. Yale University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RugglesCKR)
kde &lt;- density(RugglesCKR$Dec.Hill, 2)
plot(kde)
</code></pre>

<hr>
<h2 id='RugglesRSC'>Recumbent Stone Circle Data</h2><span id='topic+RugglesRSC'></span>

<h3>Description</h3>

<p>Declination data from C.L.N. Ruggles' fieldwork on the Scottish Recumbent Stone Circles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RugglesRSC)
</code></pre>


<h3>Format</h3>

<p>A data frame with 37 rows and 2 variables:
</p>

<dl>
<dt>Dec</dt><dd><p>Declination</p>
</dd>
<dt>ID</dt><dd><p>Site ID</p>
</dd>
</dl>



<h3>References</h3>

<p>Ruggles, C.L.N. (1999). <em>Astronomy in Prehistoric Britain and Ireland</em>. Yale University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RugglesRSC)
kde &lt;- density(RugglesRSC$Dec, 2)
plot(kde)
</code></pre>

<hr>
<h2 id='sigTest'>(Defunct) Perform a null hypothesis significance test of a given curvigram</h2><span id='topic+sigTest'></span>

<h3>Description</h3>

<p>This function no longer works. Please use <code><a href="#topic+randomTest">randomTest</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigTest()
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+randomTest">randomTest</a></code>
</p>

<hr>
<h2 id='sky.objects'>Creates a <em>skyscapeR.object</em> for plotting of celestial objects at given epoch</h2><span id='topic+sky.objects'></span>

<h3>Description</h3>

<p>This function creates an object containing all the necessary information to
plot celestial objects/events unto the many plotting functions of <em>skyscapeR</em>
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sky.objects(names, epoch, loc = FALSE, col = "red", lty = 1, lwd = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sky.objects_+3A_names">names</code></td>
<td>
<p>The name(s) of the celestial object(s) or event(s) of interest.
These can be one of the following soli-lunar events: <em>jS</em>, <em>dS</em>, <em>eq</em>,
<em>nmnLX</em>, <em>nMjLX</em>,
<em>smnLX</em>, <em>sMjLX</em>, or the name of any star in the database. As shorthand, the names
<em>sun</em> and <em>moon</em> can be used to represent all the above solar and lunar events,
respectively. Alternatively, custom declination values can also be used.</p>
</td></tr>
<tr><td><code id="sky.objects_+3A_epoch">epoch</code></td>
<td>
<p>The year or year range (as an array) one is interested in.</p>
</td></tr>
<tr><td><code id="sky.objects_+3A_loc">loc</code></td>
<td>
<p>(Optional) This can be either a vector with the latitude and longitude of the
location, or a <em>skyscapeR.horizon</em> object.</p>
</td></tr>
<tr><td><code id="sky.objects_+3A_col">col</code></td>
<td>
<p>(Optional) The color for plotting, and differentiating these objects.
Defaults to red for all objects.</p>
</td></tr>
<tr><td><code id="sky.objects_+3A_lty">lty</code></td>
<td>
<p>(Optional) Line type (see <code><a href="graphics.html#topic+par">par</a></code>) used for differentiation.
Only activated for single year epochs.</p>
</td></tr>
<tr><td><code id="sky.objects_+3A_lwd">lwd</code></td>
<td>
<p>(Optional) Line width (see <code><a href="graphics.html#topic+par">par</a></code>) used for differentiation.
Only activated for single year epochs.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Create a object with solar targets for epoch range 4000-2000 BC:
tt &lt;- sky.objects('solar extremes', c(-4000,-2000))

# Create an object with a few stars for same epoch:
tt &lt;- sky.objects(c('Sirius', 'Betelgeuse', 'Antares'), c(-4000,-2000),
col=c('white', 'red', 'orange'))

# Create an object with solstices and a custom declination value:
tt &lt;- sky.objects(c('December Solstice','June Solstice', -13), c(-4000,-2000))
</code></pre>

<hr>
<h2 id='sky.sketch'>Create a simplistic sketch of the sky at a given moment in time</h2><span id='topic+sky.sketch'></span>

<h3>Description</h3>

<p>Create a simplistic sketch of the sky at a given moment in time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sky.sketch(
  time,
  timezone,
  calendar,
  xrange = c(30, 150),
  yrange = c(-45, 45),
  sun = T,
  moon = T,
  planets = F,
  exagerate = T,
  max.mag = 6,
  loc,
  atm,
  temp
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sky.sketch_+3A_time">time</code></td>
<td>
<p>Either a string containing the date and time in the format &quot;YYYY-MM-DD HH:MM:SS&quot;
(see <code><a href="#topic+timestring">timestring</a></code>), or a numeric containing the julian date (see <code><a href="#topic+time2jd">time2jd</a></code>).</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_timezone">timezone</code></td>
<td>
<p>(Optional) Timezone of input either as a known acronym (e.g. &quot;GMT&quot;, &quot;CET&quot;) or
a string with continent followed by country capital (e.g. &quot;Europe/London&quot;). See
<a href="base.html#topic+timezones">timezones</a> for details. Only needed if <em>time</em> is a string. If not given the value set
by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_calendar">calendar</code></td>
<td>
<p>(Optional) Calendar used in parameter <em>time</em>. G for gregorian and J for julian.
Only needed if <em>time</em> is a string. If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_xrange">xrange</code></td>
<td>
<p>Range of azimuths to display, preferably no larger than 120 degrees.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_yrange">yrange</code></td>
<td>
<p>Range of altitudes to display, preferably no larger than 120 degrees.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_sun">sun</code></td>
<td>
<p>(Optional) Boolean on whether the sun should be displayed. Defaults to <em>TRUE</em>.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_moon">moon</code></td>
<td>
<p>(Optional) Boolean on whether the moon should be displayed. Defaults to <em>TRUE</em>.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_planets">planets</code></td>
<td>
<p>(Optional) Boolean on whether the visible planets should be displayed. Defaults to <em>FALSE</em>.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_exagerate">exagerate</code></td>
<td>
<p>(Optional) Boolean on whether the size of the sun, moon and planets should be exaggerated,
which can be useful when attempting wider viewing angles. Defaults to <em>TRUE</em>.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_max.mag">max.mag</code></td>
<td>
<p>(Optional) Maximum magnitude of stars to consider. Default is 6.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_loc">loc</code></td>
<td>
<p>Location, either a <em>skyscapeR.object</em> or a vector
containing the latitude and longitude of location, in this order.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_atm">atm</code></td>
<td>
<p>(Optional) Atmospheric pressure for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="sky.sketch_+3A_temp">temp</code></td>
<td>
<p>(Optional) Atmospheric temperature for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>sky.sketch(time='2019/01/10 18:51', loc=c(35,-8,100))
</code></pre>

<hr>
<h2 id='skyscapeR.vars'>See and change the global variables used by skyscapeR</h2><span id='topic+skyscapeR.vars'></span>

<h3>Description</h3>

<p>See and change the global variables used by skyscapeR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skyscapeR.vars(timezone, calendar, refraction, atm, temp, dec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skyscapeR.vars_+3A_timezone">timezone</code></td>
<td>
<p>Timezone of input either as a known acronym (e.g. &quot;GMT&quot;, &quot;CET&quot;) or
a string with continent followed by country capital (e.g. &quot;Europe/London&quot;). See
<code><a href="base.html#topic+timezones">timezones</a></code> for details. Default is the system timezone</p>
</td></tr>
<tr><td><code id="skyscapeR.vars_+3A_calendar">calendar</code></td>
<td>
<p>Calendar used in parameter <em>time</em>. G for gregorian and J for julian.
Defaults to <em>Gregorian</em>.</p>
</td></tr>
<tr><td><code id="skyscapeR.vars_+3A_refraction">refraction</code></td>
<td>
<p>Whether atmospheric refraction is to be taken into account. Default is TRUE.</p>
</td></tr>
<tr><td><code id="skyscapeR.vars_+3A_atm">atm</code></td>
<td>
<p>Atmospheric pressure for refraction calculation. Default is 1013.25 mbar.</p>
</td></tr>
<tr><td><code id="skyscapeR.vars_+3A_temp">temp</code></td>
<td>
<p>Atmospheric temperature for refraction calculation. Default is 15 degrees.</p>
</td></tr>
<tr><td><code id="skyscapeR.vars_+3A_dec">dec</code></td>
<td>
<p>Output declination: <em>geo</em> for the geocentric, or <em>topo</em> for the topocentric
frame of reference. Defaults to topocentric.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Julian date at noon GMT on Christmas day 2018
time2jd('2018-12-25 12:00:00', 'GMT')
</code></pre>

<hr>
<h2 id='sMjLX'>Declination of southern major Lunar Extreme for a given year</h2><span id='topic+sMjLX'></span>

<h3>Description</h3>

<p>This function calculates the declination of the southern
major Lunar Extreme for a given year, based upon
obliquity estimation and corrected average parallax.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sMjLX(
  year = skyscapeR.env$cur.year,
  loc = FALSE,
  parallax = 0.952,
  altitude = 0,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sMjLX_+3A_year">year</code></td>
<td>
<p>Year for which to calculate the declination.
Defaults to present year as given by <em>Sys.Date</em>.</p>
</td></tr>
<tr><td><code id="sMjLX_+3A_loc">loc</code></td>
<td>
<p>(Optional) This can be either the latitude of the
location, or a <em>skyscapeR.horizon</em> object. If missing or <em>FALSE</em>,
function will output geocentric declination.</p>
</td></tr>
<tr><td><code id="sMjLX_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the moon
Defaults to 0.952.</p>
</td></tr>
<tr><td><code id="sMjLX_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the sun. Defaults to 0 degrees.</p>
</td></tr>
<tr><td><code id="sMjLX_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control output of warnings and messages.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+nmnLX">nmnLX</a></code>, <code><a href="#topic+smnLX">smnLX</a></code>, <code><a href="#topic+nMjLX">nMjLX</a></code>,
<code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Southern major Lunar Extreme geocentric declination for year 2501 BC:
sMjLX(-2500)

# Topocentric declination for same year and latitude of 50 degrees N:
sMjLX(-2500, loc=50)
</code></pre>

<hr>
<h2 id='smnLX'>Declination of southern minor Lunar Extreme for a given year</h2><span id='topic+smnLX'></span>

<h3>Description</h3>

<p>This function calculates the declination of the southern
minor Lunar Extreme for a given year, based upon
obliquity estimation and corrected average parallax.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smnLX(
  year = skyscapeR.env$cur.year,
  loc = FALSE,
  parallax = 0.952,
  altitude = 0,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smnLX_+3A_year">year</code></td>
<td>
<p>Year for which to calculate the declination.
Defaults to present year as given by <em>Sys.Date</em>.</p>
</td></tr>
<tr><td><code id="smnLX_+3A_loc">loc</code></td>
<td>
<p>(Optional) This can be either the latitude of the
location, or a <em>skyscapeR.horizon</em> object. If missing or <em>FALSE</em>,
function will output geocentric declination.</p>
</td></tr>
<tr><td><code id="smnLX_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the moon
Defaults to 0.952.</p>
</td></tr>
<tr><td><code id="smnLX_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the sun. Defaults to 0 degrees.</p>
</td></tr>
<tr><td><code id="smnLX_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control output of warnings and messages.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+nmnLX">nmnLX</a></code>, <code><a href="#topic+nMjLX">nMjLX</a></code>, <code><a href="#topic+sMjLX">sMjLX</a></code>,
<code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Southern minor Lunar Extreme geocentric declination for year 2501 BC:
smnLX(-2500)

# Topocentric declination for same year and latitude of 50 degrees N:
smnLX(-2500, loc=50)
</code></pre>

<hr>
<h2 id='solar.date'>Solar Date</h2><span id='topic+solar.date'></span>

<h3>Description</h3>

<p>Returns the calendar date when the sun has the same declination as the input declination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solar.date(dec, year, calendar, verbose = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="solar.date_+3A_dec">dec</code></td>
<td>
<p>Single value or array of declination values.</p>
</td></tr>
<tr><td><code id="solar.date_+3A_year">year</code></td>
<td>
<p>Year for which to do calculations.</p>
</td></tr>
<tr><td><code id="solar.date_+3A_calendar">calendar</code></td>
<td>
<p>(Optional) Calendar used for output. G for gregorian and J for julian. Defaults to Gregorian.</p>
</td></tr>
<tr><td><code id="solar.date_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Boolean to control whether or not to display text. Default is TRUE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>solar.date(-23, 2018)
solar.date(-12, 1200, calendar='G')
solar.date(-12, 1200, calendar='J')
solar.date(14, -2000)
</code></pre>

<hr>
<h2 id='spatial.equinox'>Declination of the spatial equinox for a given location</h2><span id='topic+spatial.equinox'></span>

<h3>Description</h3>

<p>Declination of the spatial equinox for a given location
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatial.equinox(hor, parallax = 0.00224)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spatial.equinox_+3A_hor">hor</code></td>
<td>
<p>This should be a <em>skyscapeR.horizon</em> object.</p>
</td></tr>
<tr><td><code id="spatial.equinox_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the sun.
Defaults to 0.00224.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+jS">jS</a></code>, <code><a href="#topic+dS">dS</a></code>, <code><a href="#topic+eq">eq</a></code>,
<code><a href="#topic+zenith">zenith</a></code>, <code><a href="#topic+antizenith">antizenith</a></code>, <code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
hor &lt;- createHWT(34.174051531543405, 110.81299818694872, name='Xipo, Lingbao')
spatial.equinox(hor)

## End(Not run)
</code></pre>

<hr>
<h2 id='spd'>Summed probability density (SPD)</h2><span id='topic+spd'></span>

<h3>Description</h3>

<p>Summed probability density (SPD)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spd(pdf, normalise = F, xrange, .cutoff = 1e-05, .res = 0.01)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spd_+3A_pdf">pdf</code></td>
<td>
<p>A <em>skyscapeR.pdf</em> object created with either <code><a href="#topic+az.pdf">az.pdf</a></code> or <code><a href="#topic+coordtrans">coordtrans</a></code></p>
</td></tr>
<tr><td><code id="spd_+3A_normalise">normalise</code></td>
<td>
<p>(Optional) Boolean to control whether to normalize the SPD. Default is FALSE</p>
</td></tr>
<tr><td><code id="spd_+3A_xrange">xrange</code></td>
<td>
<p>(Optional) Array of values (min and max) for SPD if different from range of <em>pdf</em></p>
</td></tr>
<tr><td><code id="spd_+3A_.cutoff">.cutoff</code></td>
<td>
<p>(Optional) Value of SPD at which point it will be cutoff to save on memory. Default is 1e-5</p>
</td></tr>
<tr><td><code id="spd_+3A_.res">.res</code></td>
<td>
<p>(Optional) Resolution with which to output SPD. Default is 0.01 degrees.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Silva, F (2020) A probabilistic framework and significance test for the analysis of structural orientations
in skyscape archaeology <em>Journal of Archaeological Science</em> 118, 105138. &lt;doi:10.1016/j.jas.2020.105138&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># SPD of azimuths
Az &lt;- az.pdf(az=c(87,93,90,110), unc=3)
s1 &lt;- spd(Az)
plot(s1)

# SPD of declinations
hor &lt;- createHor(az=c(0,360), alt=c(0,0), loc=c(35,-8,25)) # flat horizon with 0 degrees of altitude
Dec &lt;- coordtrans(Az, hor)
s2 &lt;- spd(Dec)
plot(s2)
</code></pre>

<hr>
<h2 id='star'>Create <em>skyscapeR.star</em> object</h2><span id='topic+star'></span>

<h3>Description</h3>

<p>This function retrieves information for a given star
and saves it in the <em>skyscapeR.star</em> format ready to be
used by other skyscapeR package function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>star(string, year = skyscapeR.env$cur.year)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="star_+3A_string">string</code></td>
<td>
<p>This can be either the traditional name for the star or its Bayer designation.</p>
</td></tr>
<tr><td><code id="star_+3A_year">year</code></td>
<td>
<p>Year for which to calculate the coordinates.
Defaults to current year.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="swephR.html#topic+swe_fixstar2_ut">swe_fixstar2_ut</a></code>, <code><a href="swephR.html#topic+swe_fixstar2_mag">swe_fixstar2_mag</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Retrieve data for Aldebaran:
Aldeb &lt;- star('Aldebaran')

# Retrieve data for Aldebaran on 2999 BC:
ss &lt;- star('Aldebaran', -3000)
</code></pre>

<hr>
<h2 id='star.phases'>Calculate the seasons and phase type of a star</h2><span id='topic+star.phases'></span>

<h3>Description</h3>

<p>This function calculates the seasons (Rising, Setting, etc.)
and phase types (Arising and Lying Hidden, Curtailed Passage) of a
star for a given location and epoch. This functions uses the
<em>arcus visionis</em> approximation of Purrington (1988) and
the atmospheric extinction approximation of Schaefer (1989). For
the nomenclature used, and description of star phase types, see Brady (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>star.phases(
  star,
  year,
  loc,
  alt.hor = 0,
  k = 0.2,
  limit = 6,
  alt.rs = 10,
  res = 1/24/6,
  refraction,
  atm,
  temp
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="star.phases_+3A_star">star</code></td>
<td>
<p>Either the star name or a <em>skyscapeR.star</em> object.</p>
</td></tr>
<tr><td><code id="star.phases_+3A_year">year</code></td>
<td>
<p>The year of interest. Must be in the <em>swephR</em> range of 13201 cal BC to 17191 AD</p>
</td></tr>
<tr><td><code id="star.phases_+3A_loc">loc</code></td>
<td>
<p>Location, either a <em>skyscapeR.object</em> or a vector
containing the latitude and longitude of location, in this order.</p>
</td></tr>
<tr><td><code id="star.phases_+3A_alt.hor">alt.hor</code></td>
<td>
<p>(Optional) The altitude of the horizon to consider.
Defaults to zero degrees.</p>
</td></tr>
<tr><td><code id="star.phases_+3A_k">k</code></td>
<td>
<p>(Optional) Extinction coefficient (see Schaefer 1989).
Defaults to 0.2, corresponding to a poor night on mountain top
or best night at a dry sea level site.</p>
</td></tr>
<tr><td><code id="star.phases_+3A_limit">limit</code></td>
<td>
<p>(Optional) The maximum magnitude of a star that can be
visible with the naked eye. Defaults to 6.</p>
</td></tr>
<tr><td><code id="star.phases_+3A_alt.rs">alt.rs</code></td>
<td>
<p>(Optional) The maximum altitude of a star's first or last
visibility for it to still be considered to be as rising or setting.
Defaults to ten degrees.</p>
</td></tr>
<tr><td><code id="star.phases_+3A_res">res</code></td>
<td>
<p>(Optional) Resolution of calculation. The smaller this
figure the slower the computation. Defaults to 1/24/6, i.e. every 10 minutes.</p>
</td></tr>
<tr><td><code id="star.phases_+3A_refraction">refraction</code></td>
<td>
<p>(Optional) Whether atmospheric refraction is to be taken into account.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="star.phases_+3A_atm">atm</code></td>
<td>
<p>(Optional) Atmospheric pressure for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
<tr><td><code id="star.phases_+3A_temp">temp</code></td>
<td>
<p>(Optional) Atmospheric temperature for refraction calculation.
If not given the value set by <code><a href="#topic+skyscapeR.vars">skyscapeR.vars</a></code> will be used instead.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Purrington, Robert D. (1988) Heliacal Rising and Setting:
Quantitative Aspects, <em>Journal for the History of Astronomy
(Archaeoastronomy Supplement 12)</em> 19, S72-S84. Available online at
[SAO/NASA ADS Astronomy Abstract Service](http://adsabs.harvard.edu/abs/1988JHAS...19...72P)
</p>
<p>Brady, Bernadette (2015) Star Phases: the Naked-eye Astronomy of the Old Kingdom
Pyramid Texts. In F Silva and N Campion (eds) <em>Skyscapes: The Role and Importance of
the Sky in Archaeology</em>. Oxford: Oxbow Books, pp. 76-86.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.skyscapeR.starphases">plot.skyscapeR.starphases</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ss1 &lt;- star.phases('Aldebaran',-4000, c(35,-8,200))

# One can then look at the star's phase type:
ss1$metadata$type

# Date range of seasons:
ss1$metadata$seasons

# Date range of phase-type events:
ss1$metadata$events

# And plot them:
plot(ss1)

# You can play with the parameters and see how predictions change:
ss1 &lt;- star.phases('Aldebaran',-4000, c(35,-8,200), alt.hor=2, alt.rs=5)
plot(ss1)

## End(Not run)
</code></pre>

<hr>
<h2 id='sunAz'>Returns the azimuth of the sun at a given time from a specific location</h2><span id='topic+sunAz'></span>

<h3>Description</h3>

<p>This function returns the azimuth of the sun at a given time and location,
useful for data reduction of theodolite measurements using the sun-sight
technique (<code><a href="#topic+reduct.theodolite">reduct.theodolite</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sunAz(loc, time, timezone, limb, alt = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sunAz_+3A_loc">loc</code></td>
<td>
<p>Location, either a <em>skyscapeR.object</em> or a vector
containing the latitude, longitude and elevation of location, in this order.</p>
</td></tr>
<tr><td><code id="sunAz_+3A_time">time</code></td>
<td>
<p>String containing the date and time in the following format:
&quot;YYYY-MM-DD HH:MM:SS&quot;</p>
</td></tr>
<tr><td><code id="sunAz_+3A_timezone">timezone</code></td>
<td>
<p>Timezone of input either as a known acronym (e.g. &quot;GMT&quot;, &quot;CET&quot;) or
a string with continent followed by country capital (e.g. &quot;Europe/London&quot;).</p>
</td></tr>
<tr><td><code id="sunAz_+3A_limb">limb</code></td>
<td>
<p>(Optional) Measured limb of the sun. Options are <em>left</em>, <em>right</em>.
If missing the center of the sun will be output.</p>
</td></tr>
<tr><td><code id="sunAz_+3A_alt">alt</code></td>
<td>
<p>(Optional) Boolean that triggers output of altitude of the sun at exact time.
Default is FALSE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+reduct.theodolite">reduct.theodolite</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sunAz(c(52,-3,100), '2017-10-04 12:32:14', 'Europe/London')
</code></pre>

<hr>
<h2 id='ten'>Converts degree measurements in deg-min-sec (ยบ ' &quot;) format into decimal-point degree format.</h2><span id='topic+ten'></span>

<h3>Description</h3>

<p>Converts degree measurements in deg-min-sec (ยบ ' &quot;) format into decimal-point degree format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ten(dd, mm = 0, ss = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ten_+3A_dd">dd</code></td>
<td>
<p>Degree</p>
</td></tr>
<tr><td><code id="ten_+3A_mm">mm</code></td>
<td>
<p>(Optional) Arcminutes</p>
</td></tr>
<tr><td><code id="ten_+3A_ss">ss</code></td>
<td>
<p>(Optional) Arcseconds</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>deg &lt;- ten(24, 52, 16)
</code></pre>

<hr>
<h2 id='time2jd'>Converts date and time (in any timezone) to Julian date</h2><span id='topic+time2jd'></span>

<h3>Description</h3>

<p>Converts date and time (in any timezone) to Julian date
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time2jd(time, timezone, calendar, verbose = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="time2jd_+3A_time">time</code></td>
<td>
<p>String containing the date and time in the format &quot;YYYY/MM/DD HH:MM:SS&quot;. BCE dates
should use negative sign. Use <code><a href="#topic+timestring">timestring</a></code> if needed.</p>
</td></tr>
<tr><td><code id="time2jd_+3A_timezone">timezone</code></td>
<td>
<p>(Optional) Timezone of input either as a known acronym (e.g. &quot;GMT&quot;, &quot;CET&quot;) or
a string with continent followed by country capital (e.g. &quot;Europe/London&quot;). See
<code><a href="base.html#topic+timezones">timezones</a></code> for details. Default is the system timezone</p>
</td></tr>
<tr><td><code id="time2jd_+3A_calendar">calendar</code></td>
<td>
<p>(Optional) Calendar used in parameter <em>time</em>. G for gregorian and J for julian.
Defaults to <em>Gregorian</em>.</p>
</td></tr>
<tr><td><code id="time2jd_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) Controls whether messages should be displayed. Default is <em>FALSE</em>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="swephR.html#topic+swe_julday">swe_julday</a></code>, <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt</a></code>, <code><a href="base.html#topic+timezones">timezones</a></code>,
<code><a href="#topic+timestring">timestring</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Julian date at noon GMT on Christmas day 2018
time2jd('2018/12/25 12:00:00', 'GMT')
</code></pre>

<hr>
<h2 id='timestring'>Converts date and time numeric values to a single string</h2><span id='topic+timestring'></span>

<h3>Description</h3>

<p>Converts date and time numeric values to a single string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timestring(year, month, day, hour = 12, minute = 0, second = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="timestring_+3A_year">year</code></td>
<td>
<p>Year</p>
</td></tr>
<tr><td><code id="timestring_+3A_month">month</code></td>
<td>
<p>Month</p>
</td></tr>
<tr><td><code id="timestring_+3A_day">day</code></td>
<td>
<p>Day</p>
</td></tr>
<tr><td><code id="timestring_+3A_hour">hour</code></td>
<td>
<p>Hour</p>
</td></tr>
<tr><td><code id="timestring_+3A_minute">minute</code></td>
<td>
<p>Minute</p>
</td></tr>
<tr><td><code id="timestring_+3A_second">second</code></td>
<td>
<p>Second</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>timestring(2018, 12, 25, 2, 34)
</code></pre>

<hr>
<h2 id='zenith'>Declination of the zenith sun for a given location</h2><span id='topic+zenith'></span>

<h3>Description</h3>

<p>This function returns the declination of the sun
when it is at the zenith for a given location with
corrected average parallax. If this phenomena does
not occur at given location (i.e. if location is
outside the tropical band) the function returns a
<em>NULL</em> value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zenith(loc, parallax = 0.00224, altitude = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="zenith_+3A_loc">loc</code></td>
<td>
<p>This can be either the latitude of the
location, or a <em>skyscapeR.horizon</em> object.</p>
</td></tr>
<tr><td><code id="zenith_+3A_parallax">parallax</code></td>
<td>
<p>(Optional) Average parallax value for the sun.
Defaults to 0.00224.</p>
</td></tr>
<tr><td><code id="zenith_+3A_altitude">altitude</code></td>
<td>
<p>(Optional) Altitude of the sun. Defaults to 0 degrees.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+jS">jS</a></code>, <code><a href="#topic+dS">dS</a></code>, <code><a href="#topic+eq">eq</a></code>,
<code><a href="#topic+antizenith">antizenith</a></code>, <code><a href="#topic+spatial.equinox">spatial.equinox</a></code>, <code><a href="#topic+parallax.corr">parallax.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Zenith sun declination for Mexico City:
zenith(19.419)

# There is no zenith sun phenomenon in London:
zenith(51.507)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
