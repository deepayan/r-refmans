<!DOCTYPE html><html><head><title>Help for package segRDA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {segRDA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#extract'><p>Extract results and breakpoints from a <code>smw</code> object</p></a></li>
<li><a href='#nema'><p>Nematodes data from Araca Bay, Sao Sebastiao, Brazil.</p></a></li>
<li><a href='#OrdData'><p>Data ordering</p></a></li>
<li><a href='#plot.smw'><p>Plot the dissimilarity profiles</p></a></li>
<li><a href='#pwRDA'><p>Piecewise redundancy analysis (pwRDA)</p></a></li>
<li><a href='#segRDA-package'><p>segRDA: Modeling Non-Continuous Linear Responses of Ecological Data</p></a></li>
<li><a href='#sim1'><p>Simulated datasets</p></a></li>
<li><a href='#SMW'><p>Split moving window analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-07-06</td>
</tr>
<tr>
<td>Title:</td>
<td>Modeling Non-Continuous Linear Responses of Ecological Data</td>
</tr>
<tr>
<td>Author:</td>
<td>Danilo C Vieira &lt;vieiradc@yahoo.com.br&gt;, Gustavo Fonseca &lt;gfonseca.unifesp@gmail.com&gt;, and Fabio Cop Ferreira &lt;fabiocferreira.unifesp@gmail.com&gt;, with contributions from Marco Colossi Brustolin.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Danilo C Vieira &lt;vieiradc@yahoo.com.br&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for modeling non-continuous linear responses of ecological communities to environmental data. The package is straightforward through three steps: (1) data ordering (function OrdData()), (2) split-moving-window analysis (function SMW()) and (3) piecewise redundancy analysis (function pwRDA()). Relevant references include Cornelius and Reynolds (1991) &lt;<a href="https://doi.org/10.2307%2F1941559">doi:10.2307/1941559</a>&gt; and Legendre and Legendre (2012, ISBN: 9780444538697).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15), vegan (&ge; 2.4)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/DaniloCVieira/segRDA">https://github.com/DaniloCVieira/segRDA</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DaniloCVieira/segRDA/issues">https://github.com/DaniloCVieira/segRDA/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-07-26 20:06:34 UTC; Danilo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-07-31 07:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='extract'>Extract results and breakpoints from a <code>smw</code> object</h2><span id='topic+extract'></span><span id='topic+print.dp'></span><span id='topic+print.smw'></span><span id='topic+bp'></span><span id='topic+extract.smw'></span><span id='topic+bp.dp'></span>

<h3>Description</h3>

<p>Functions to extract results and breakpoints from a <code>smw</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'smw'
extract(smw, w = NULL, index = "dp", sig = "z",
  z = 1.85, BPs = "max", seq.sig = 3)

## S3 method for class 'dp'
bp(dp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_+3A_smw">smw</code></td>
<td>
<p>An object of class <code>smw</code> resulted from the <code><a href="#topic+SMW">SMW</a></code> analysis.</p>
</td></tr>
<tr><td><code id="extract_+3A_w">w</code></td>
<td>
<p>Numeric. A &quot;target&quot; window size from which results will be extracted (see Details). Only effective if the <code>smw</code> object contains results from multiple window sizes.</p>
</td></tr>
<tr><td><code id="extract_+3A_index">index</code></td>
<td>
<p>The result to be extracted:
</p>

<ul>
<li> <p><code>"dp"</code>: The dissimilarity profile (DP) table containing significant discontinuities and suggested breakpoints.  The returned DP has class <code>"dp"</code>, with an own generic <code>print</code> method. The <code>print</code> command prints and returns invisibly the DP.
</p>
</li>
<li> <p><code>"rdp"</code>: data frame containing the randomized DP;
</p>
</li>
<li> <p><code>"md"</code>: mean dissimilarity of the randomized DP;
</p>
</li>
<li> <p><code>"sd"</code>: standard deviation for each sample position;
</p>
</li>
<li> <p><code>"oem"</code>: overall expected mean dissimilarity;
</p>
</li>
<li> <p><code>"osd"</code>: average standard deviation for the dissimilarities;
</p>
</li>
<li> <p><code>"params"</code>: list with input arguments
</p>
</li></ul>
</td></tr>
<tr><td><code id="extract_+3A_sig">sig</code></td>
<td>
<p>Significance test for detecting dissimilarity values that differs significantly from those appearing in a random pattern. The following tests are considered with default to <code>sig.test="z"</code>:
</p>

<ul>
<li> <p><code>"dp"</code> consider normalized dissimilarity (z-scores) discontinuities that exceed a &quot;z&quot; critical value;
</p>
</li>
<li> <p><code>"sd"</code> consider dissimilarity discontinuities that exceed mean plus one standard deviation;
</p>
</li>
<li> <p><code>"SD2"</code> consider dissimilarity discontinuities that exceed mean plus two standard deviation;
</p>
</li>
<li> <p><code>"tail1"</code> Consider dissimilarity discontinuities that exceed 95 percent confidence limits.
</p>
</li></ul>
</td></tr>
<tr><td><code id="extract_+3A_z">z</code></td>
<td>
<p>The critical value for the significance of z-values. Defaults to <code>'z=1.85'</code> (Erdös et.al, 2014).</p>
</td></tr>
<tr><td><code id="extract_+3A_bps">BPs</code></td>
<td>
<p>Defines if the breakpoints should be chosen as those sample positions corresponding to the maximum dissimilarity in a sequence of significant values (<code>"max"</code>) or as those sample positions corresponding to the median position of the sequence (<code>"median"</code>). Defaults to <code>BPs="max"</code>. If <code>NULL</code> the breakpoints are not computed.</p>
</td></tr>
<tr><td><code id="extract_+3A_seq.sig">seq.sig</code></td>
<td>
<p>The maximum length of consecutive, significant values of dissimilarity that will be considered in defining the community breakpoints. Defaults to <code>seq.sig=3</code>;</p>
</td></tr>
<tr><td><code id="extract_+3A_dp">dp</code></td>
<td>
<p>An object of class <code>dp</code> (see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code>smw</code> object contains results from multiple window sizes, the DP table will be based on the average Z-score over the set of analysed window sizes.  Available methods for class <code>"dp"</code> are <code>print</code>, <code>bp</code> and <code>plot</code>.
</p>
<p>The argument <code>w</code> is optional. If the <code>smw</code> object is length 1, <code>w</code> is ignored. If <code>length(smw)&gt;1</code> and <code>w</code> is <code>NULL</code>, the function will extract the dissimilarity profile averaged over the set of window sizes.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>"extract"</code> returns a result called by the argument <code>index</code> (see Details);
</p>
</li>
<li> <p><code>"bp"</code> returns the locations of the breakpoints.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+plot.smw">plot.smw</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim1)
sim1o&lt;-OrdData(sim1$envi,sim1$comm)


ws50&lt;-SMW(yo=sim1o$yo,ws=50)
ws50_dp&lt;-extract(ws50)
head(ws50_dp)

</code></pre>

<hr>
<h2 id='nema'>Nematodes data from Araca Bay, Sao Sebastiao, Brazil.</h2><span id='topic+nema'></span>

<h3>Description</h3>

<p>A total of  37 sites arranged in an irregular grid were surveyed during four sampling campaigns at the
Araçá Bay, southeastern Brazil. A total of 141 samples were collected for analyzing changes in
nematodes assemblages along the environmental gradient of the bay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nema)
</code></pre>


<h3>Format</h3>

<p><code>nema</code> is a list with the following components:
</p>

<dl>
<dt>envi</dt><dd><p>a matrix with 141 sites and 9 environmental variables: chlorophyll a (mg.m-2), bathymetry (meters), percentage of total organic carbon, percentage of coarse sands (as the sum of pebbles, very coarse, coarse, and medium grains), percentage of fine sand, percentage of very fine sand, mean grain size, and sorting coefficient.</p>
</dd>
<dt>comm</dt><dd><p>matrix with 141 sites of 194 nematodes species</p>
</dd>
</dl>


<h3>References</h3>


<ul>
<li><p> Checon, H. H., D. C. Vieira, G. N. Corte, E. C. P. M. Sousa, G. Fonseca, and A. C. Z. Amaral. 2018. Defining soft bottom habitats and potential indicator species as tools for monitoring coastal systems: A case study in a subtropical bay. Ocean &amp; Coastal Management.
</p>
</li>
<li><p> Corte, G. N., H. H. Checon, G. Fonseca, D. C. Vieira, F. Gallucci, M. Di Domenico, and A. C. Z. Amaral. 2017. Cross-taxon congruence in benthic communities: Searching for surrogates in marine sediments. Ecological Indicators 78:173–182.
</p>
</li></ul>


<hr>
<h2 id='OrdData'>Data ordering</h2><span id='topic+OrdData'></span>

<h3>Description</h3>

<p>Ordinates both community and explanatory matrices based on the first RDA score.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OrdData(x, y, axis = 1, method = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OrdData_+3A_x">x</code></td>
<td>
<p>explanatory matrix;</p>
</td></tr>
<tr><td><code id="OrdData_+3A_y">y</code></td>
<td>
<p>community matrix;</p>
</td></tr>
<tr><td><code id="OrdData_+3A_axis">axis</code></td>
<td>
<p>the RDA axis in which the ordering should be based. Defaults to <code>axis=1</code></p>
</td></tr>
<tr><td><code id="OrdData_+3A_method">method</code></td>
<td>
<p>standardization method (described in <code><a href="vegan.html#topic+decostand">decostand</a></code>) to be applied on y before the RDA analysis. If <code>NA</code> (default), no transformation is performed.</p>
</td></tr>
<tr><td><code id="OrdData_+3A_...">...</code></td>
<td>
<p>furhter parameters passed to <code><a href="vegan.html#topic+decostand">decostand</a></code> and <code>vegan::rda</code>;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"ord"</code>, which is a list consisting of:
</p>

<ol>
<li><p>xo: the ordered explanatory matrix
</p>
</li>
<li><p>yo: the ordered community matrix (non-transformed)
</p>
</li>
<li><p>x: the original explanatory matrix
</p>
</li>
<li><p>y: the original community matrix
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Danilo Candido Vieira
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim1)
sim1.o&lt;-OrdData(x=sim1$envi, y=sim1$comm)
sim1.o&lt;-OrdData(x=sim1$envi, y=sim1$comm, method="hellinger")
</code></pre>

<hr>
<h2 id='plot.smw'>Plot the dissimilarity profiles</h2><span id='topic+plot.smw'></span><span id='topic+bgDP'></span><span id='topic+bgDP.dp'></span>

<h3>Description</h3>

<p>Plot results from <code>smw</code> and <code>dp</code> objects. The command is a shortcut for extracting and plotting <code><a href="#topic+SMW">SMW</a></code> resuts. Auxiliary arguments from <code><a href="#topic+extract">extract</a></code> (i.e.  <code>sig</code>, <code>z</code>, <code>BPs</code> and <code>seq.sig</code>) can be passed to <code>plot.smw</code>.  The auxilary method <code>bgDP</code> is available for the returned <code>dp</code> object when the argument <code>bg</code> is not NULL (see Details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'smw'
plot(x, w = NULL, sig = "z", z = 1.85, BPs = "max",
  seq.sig = 3, w.effect = F, values = c("zscore", "diss"),
  pchs = c(16, 16, 17), cols = c("black", "red", "blue"), bg = NULL,
  bg_alpha = 0.1, wcols = "rainbow", legend = TRUE, ...)

## S3 method for class 'dp'
bgDP(dp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.smw_+3A_x">x</code></td>
<td>
<p>An object of class <code>"smw"</code> resulted from the function <code><a href="#topic+SMW">SMW</a></code>.</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_w">w</code></td>
<td>
<p>The window size from which results will be plotted. Only effective if <code>length(smw)&gt;1</code>.</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_sig">sig</code></td>
<td>
<p>Significance test for detecting dissimilarity values that differs significantly from those appearing in a random pattern. If <code>NULL</code> the significance test is ommited from the plot.The following tests are considered with default to <code>sig.test="z"</code>:
</p>

<ul>
<li> <p><code>'z'</code> consider normalized dissimilarity (z-scores) discontinuities that exceed a &quot;z&quot; critical value;
</p>
</li>
<li> <p><code>'sd'</code> consider dissimilarity discontinuities that exceed mean plus one standard deviation;
</p>
</li>
<li> <p><code>'SD2'</code> consider dissimilarity discontinuities that exceed mean plus two standard deviation;
</p>
</li>
<li> <p><code>'tail1'</code> Consider dissimilarity discontinuities that exceed 95 percent confidence limits.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.smw_+3A_z">z</code></td>
<td>
<p>The critical value for the significance of z-values. Defaults to <code>'z=1.85'</code> (Erdös et.al, 2014).</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_bps">BPs</code></td>
<td>
<p>Defines if the breakpoints should be chosen as those sample positions corresponding to the maximum dissimilarity in a sequence of significant values (<code>"max"</code>) or as those sample positions corresponding to the median position of the sequence (<code>"median"</code>). Defaults to <code>BPs="max"</code>. If <code>NULL</code> the breakpoints are not computed.</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_seq.sig">seq.sig</code></td>
<td>
<p>The maximum length of consecutive, significant values of dissimilarity that will be considered in defining the community breakpoints. Defaults to <code>seq.sig=3</code>;</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_w.effect">w.effect</code></td>
<td>
<p>Logical, if <code>TRUE</code> draws a  dissimilarity profile using different windows sizes and returns an invisible data.frame with the breakpoint frequencies. Only effective if <code>length(smw)&gt;1</code>. The function uses <code><a href="#topic+extract">extract</a></code> with defaults parameters to define the breakpoint positions for each of the evaluated window sizes.</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_values">values</code></td>
<td>
<p>Character. <code>"zscore"</code> for plotting z-scores, <code>"diss"</code> for plotting dissimilarity values.</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_pchs">pchs</code></td>
<td>
<p>A numerical vector of the form <code>c(d,s,b)</code> which modifies the default symbols of the plot. The default <code>pch = c(16,16,17)</code> describes respectively the dissimilarity values, significant dissimilarity values and breakpoints.</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_cols">cols</code></td>
<td>
<p>Vector of length 3 specifying the colors of the plot in the same way as the pch argument. Defaults to <code>colors=c("black","red","blue")</code>.</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_bg">bg</code></td>
<td>
<p>Optional. Sets background colors according to the breakpoints. It can be expressed either by a vector of colors or by the name of a pallet function (e.g. <code>"rainbow"</code>).</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_bg_alpha">bg_alpha</code></td>
<td>
<p>Factor modifying the opacity alpha of the backgroud [0,1].</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_wcols">wcols</code></td>
<td>
<p>Sets the colors for the window sizes (lines) when <code>w.effect=TRUE</code>. It can be expressed by a vector of colors or by the name of a pallet function. Defaults to <code>wcol="rainbow"</code> which uses the colour palette <code>rainbow</code> from R stats.</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_legend">legend</code></td>
<td>
<p>Logical. Should a default legend appear?</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
<tr><td><code id="plot.smw_+3A_dp">dp</code></td>
<td>
<p>An object of class <code>dp</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>bg</code> is not <code>NULL</code>, the attribute <code>params$bg</code> is added to the returned <code>dp</code>. This attribute contains the  sample colors used by the argument <code>bg</code>. The auxilary method <code>bgDP</code> can be used for accessing this color vector.
</p>


<h3>Value</h3>

<p>The function returns invisibly an object of class <code>"dp"</code> (see Details).
</p>


<h3>Author(s)</h3>

<p>Danilo Candido Vieira
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SMW">SMW</a></code>, <code><a href="#topic+extract">extract</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim1)
sim1o&lt;-OrdData(sim1$envi,sim1$comm)


ws20&lt;-SMW(yo=sim1o$yo,ws=20)
pool&lt;-SMW(yo=sim1o$yo,ws=c(20,30,40))
plot(ws20)
plot(pool, w.effect=TRUE)

</code></pre>

<hr>
<h2 id='pwRDA'>Piecewise redundancy analysis (pwRDA)</h2><span id='topic+pwRDA'></span>

<h3>Description</h3>

<p>Perform a pwRDA using the specified breakpoints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwRDA(x.ord, y.ord, BPs, n.rand = 99)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pwRDA_+3A_x.ord">x.ord</code></td>
<td>
<p>ordered explanatory matrix</p>
</td></tr>
<tr><td><code id="pwRDA_+3A_y.ord">y.ord</code></td>
<td>
<p>ordered community matrix</p>
</td></tr>
<tr><td><code id="pwRDA_+3A_bps">BPs</code></td>
<td>
<p>community breakpoints</p>
</td></tr>
<tr><td><code id="pwRDA_+3A_n.rand">n.rand</code></td>
<td>
<p>The number of randomizations for significance computation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an invisible list of length 4:
</p>

<ol>
<li> <p><code>..$summ</code>: summary statistics of the pwRDA analysis;
</p>
</li>
<li> <p><code>..$rda.0</code>: full model cca object, which is described separately in vegan::<code><a href="vegan.html#topic+cca.object">cca.object</a></code>
</p>
</li>
<li> <p><code>..$rda.pw</code>: pw model cca object, which is described separately in vegan::<code><a href="vegan.html#topic+cca.object">cca.object</a></code>
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Danilo Candido Vieira
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim1)
sim1o&lt;-OrdData(sim1$envi,sim1$comm)


w50&lt;-SMW(sim1o$yo, ws=50)
sim1.pw&lt;-pwRDA(sim1o$xo,sim1o$yo, BPs=bp(extract(w50)))

</code></pre>

<hr>
<h2 id='segRDA-package'>segRDA: Modeling Non-Continuous Linear Responses of Ecological Data</h2><span id='topic+segRDA'></span><span id='topic+segRDA-package'></span>

<h3>Description</h3>

<p>Tools for modeling non-continuous linear responses of ecological communities to environmental data. The package is straightforward through three steps: (1) data ordering (function OrdData()), (2) split-moving-window analysis (function SMW()) and (3) piecewise redundancy analysis (function pwRDA()). Relevant references include Cornelius and Reynolds (1991) &lt;doi:10.2307/1941559&gt; and Legendre and Legendre (2012, ISBN: 9780444538697).
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/DaniloCVieira/segRDA">https://github.com/DaniloCVieira/segRDA</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/DaniloCVieira/segRDA/issues">https://github.com/DaniloCVieira/segRDA/issues</a>
</p>
</li></ul>


<hr>
<h2 id='sim1'>Simulated datasets</h2><span id='topic+sim1'></span><span id='topic+sim2'></span><span id='topic+sim3'></span>

<h3>Description</h3>

<p>Simulated datasets for testing <span class="pkg">segRDA</span> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sim1)

data(sim2)

data(sim3)
</code></pre>


<h3>Format</h3>

<p>Each data set is a list with the following components:
</p>

<dl>
<dt>envi</dt><dd><p>environmental matrix</p>
</dd>
<dt>comm</dt><dd><p>community matrix</p>
</dd>
</dl>

<hr>
<h2 id='SMW'>Split moving window analysis</h2><span id='topic+SMW'></span>

<h3>Description</h3>

<p>Function <code>SMW</code> performs split moving window analysis (SMW) with randomizations tests. It may compute dissimilarities for a single window size or  for several windows sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMW(yo, ws, dist = "bray", rand = c("shift", "plot"), n.rand = 99)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SMW_+3A_yo">yo</code></td>
<td>
<p>The ordered community matrix.</p>
</td></tr>
<tr><td><code id="SMW_+3A_ws">ws</code></td>
<td>
<p>The window sizes to be analyzed. Either a single value or a vector of values.</p>
</td></tr>
<tr><td><code id="SMW_+3A_dist">dist</code></td>
<td>
<p>The dissimilarity index used in vegan::<code><a href="vegan.html#topic+vegdist">vegdist</a></code>. Defaults to <code>'bray'</code>.</p>
</td></tr>
<tr><td><code id="SMW_+3A_rand">rand</code></td>
<td>
<p>The type of randomization for significance computation (Erdös et.al, 2014):
</p>

<ul>
<li> <p><code>"shift"</code>: restricted randomization in which data belonging to the same species are randomly shifted along the data series (&quot;Random shift&quot;);
</p>
</li>
<li> <p><code>"plot"</code>: unrestricted randomization: each sample is randomly repositioned along the data series (&quot;Random plot&quot;).
</p>
</li></ul>
</td></tr>
<tr><td><code id="SMW_+3A_n.rand">n.rand</code></td>
<td>
<p>The number of randomizations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A two-level list object (<code>class smw</code>) describing the SMW results for each window <code>w</code> analyzed. The <code>smw</code> object is of length <code>ws</code>, and each of the  <code>w</code> slots is a list of SMW results:
</p>

<ul>
<li> <p><code>..$dp</code>: The raw dissimilarity profile (DP). The DP is a data frame giving the positions, labels, values of dissimilarity and z-scores for each sample;
</p>
</li>
<li> <p><code>..$rdp</code>: data frame containing the randomized DP;
</p>
</li>
<li> <p><code>..$md</code>: mean dissimilarity of the randomized DP;
</p>
</li>
<li> <p><code>..$sd</code>: standard deviation for each sample position;
</p>
</li>
<li> <p><code>..$oem</code>: overall expected mean dissimilarity;
</p>
</li>
<li> <p><code>..$osd</code>: average standard deviation for the dissimilarities;
</p>
</li>
<li> <p><code>..$params</code>: list with input arguments
</p>
</li></ul>

<p>Available methods for class <code>"smw"</code> are <code>print</code>, <code>extract</code> and <code>plot</code>.
</p>


<h3>Author(s)</h3>

<p>Danilo Candido Vieira
</p>


<h3>References</h3>


<ul>
<li><p> Erdos, L., Z. Bátori, C. S. Tölgyesi, and L. Körmöczi. 2014. The moving split window (MSW) analysis in vegetation science - An overview. Applied Ecology and Environmental Research 12:787–805.
</p>
</li>
<li><p> Cornelius, J. M., and J. F. Reynolds. 1991. On Determining the Statistical Significance of Discontinuities with Ordered Ecological Data. Ecology 72:2057–2070.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+plot.smw">plot.smw</a></code>, <code><a href="#topic+extract">extract</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim1)
sim1o&lt;-OrdData(sim1$envi,sim1$comm)


ws20&lt;-SMW(yo=sim1o$yo,ws=20)
pool&lt;-SMW(yo=sim1o$yo,ws=c(20,30,40))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
