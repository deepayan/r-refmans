<!DOCTYPE html><html lang="en"><head><title>Help for package tgcd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tgcd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#tgcd-package'><p>tgcd: An R package for analyzing thermoluminescence glow curves</p></a></li>
<li><a href='#Kitis'>
<p>Thermoluminescence glow curves provided by George Kitis</p></a></li>
<li><a href='#Refglow'>
<p>Reference glow curves</p></a></li>
<li><a href='#savgol'>
<p>Apply a Savitzky-Golay algorithm to smooth thermoluminescence glow curves</p></a></li>
<li><a href='#simPeak'>
<p>Thermoluminescence glow peak simulation</p></a></li>
<li><a href='#simqOTOR'>
<p>Thermoluminescence glow peak simulation</p></a></li>
<li><a href='#tgcd'>
<p>Thermoluminescence glow curve deconvolution (tgcd)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Thermoluminescence Glow Curve Deconvolution</td>
</tr>
<tr>
<td>Version:</td>
<td>2.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Jun Peng [aut, cre],
  John Burkardt [ctb],
  Jorge More [ctb],
  Burton Garbow [ctb],
  Kenneth Hillstrom [ctb],
  Linda R. Petzold [ctb],
  Alan C. Hindmarsh [ctb],
  R. Woodrow Setzer [ctb],
  Andrew Horchler [ctb],
  William Cody [ctb],
  Cleve Moler [ctb],
  Jack Dongarra [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jun Peng &lt;pengjun10@mails.ucas.ac.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Deconvolving thermoluminescence glow curves according to various 
        kinetic models (first-order, second-order, general-order, and mixed-order) using 
        a modified Levenberg-Marquardt algorithm (More, 1978) &lt;<a href="https://doi.org/10.1007%2FBFb0067700">doi:10.1007/BFb0067700</a>&gt;. 
        It provides the possibility of setting constraints or fixing any of parameters. 
        It offers an interactive way to initialize parameters by clicking with a mouse on 
        a plot at positions where peak maxima should be located. The optimal estimate is 
        obtained by "trial-and-error". It also provides routines for simulating first-order, 
        second-order, and general-order glow peaks.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, utils</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=tgcd">https://CRAN.R-project.org/package=tgcd</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-08 13:05:08 UTC; pengjun</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-08 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='tgcd-package'>tgcd: An R package for analyzing thermoluminescence glow curves</h2><span id='topic+tgcd-package'></span>

<h3>Description</h3>

<p>Package for thermoluminescence glow curve deconvolution (tgcd) and glow peak simulation.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> tgcd</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.7</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-09-08</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;">  GPL-2 | GPL-3 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>


<table>
<tr>
 <td style="text-align: left;">
Jun Peng </td><td style="text-align: left;"> Hunan University of Science and Technology, Xiangtan, China
</td>
</tr>

</table>

<p><b>Package maintainer</b><br />
Jun Peng
<a href="mailto:pengjun10@mails.ucas.ac.cn">pengjun10@mails.ucas.ac.cn</a>
</p>
<p><b>Related package projects</b><br />
R program KMS
<a href="https://github.com/pengjunUCAS/KMS">https://github.com/pengjunUCAS/KMS</a><br />
R package numOSL
<a href="https://CRAN.R-project.org/package=numOSL">https://CRAN.R-project.org/package=numOSL</a>
</p>


<h3>References</h3>

<p>Peng J, Dong ZB, Han FQ, 2016. tgcd: An R package for analyzing thermoluminescence glow curves. SoftwareX, 5: 112-120.
</p>
<p>Peng J, Kitis G, Sadek AM, Karsu Asal EC, Li, ZG, 2021. Thermoluminescence glow-curve deconvolution using analytical
expressions: A unified presentation. Applied Radiation and Isotopes, 168: 109440.
</p>

<hr>
<h2 id='Kitis'>
Thermoluminescence glow curves provided by George Kitis
</h2><span id='topic+Kitis'></span>

<h3>Description</h3>

<p>A total of 22 thermoluminescence glow curves measured from various materials provided by George Kitis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Kitis)</code></pre>


<h3>Format</h3>

<p>A list that contains 22 thermoluminescence glow curves.
</p>


<h3>Details</h3>

<p>This object contains 22 thermoluminescence glow curves (<code>x001</code> to <code>x022</code>) provided by George Kitis.
x001 (Al2O3:C), x002 (CaF2:Dy), x003 (LBO), x004 (Background), x005 (MgO), x006 (BeO), x007 (CaF2:Tm), x008 (Salt), 
x009 (CaF2:Dy), x010 to x016 (quartz irradiated with dose of 1, 2, 4, 8, 16, 32, and 64 Gy), x017 and x018 (BeO), 
x019 and x020 (Salt), x021 and x022 (MgO). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Load package "tgcd".
  require(tgcd)

  data(Kitis)
  names(Kitis)
</code></pre>

<hr>
<h2 id='Refglow'>
Reference glow curves
</h2><span id='topic+Refglow'></span>

<h3>Description</h3>

<p>Synthetic and measured thermoluminescence glow curves from the GLOCANIN project.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Refglow)</code></pre>


<h3>Format</h3>

<p>A list that contains 10 thermoluminescence glow curves.
</p>


<h3>Details</h3>

<p>This object contains 10 thermoluminescence glow curves (<code>x001</code> to <code>x010</code>) from the GLOCANIN project (Bos et al., 1993, 1994).
</p>


<h3>References</h3>

<p>Bos AJJ, Piters TM, Gomez Ros JM, Delgado A, 1993. An intercomparison of glow curve analysis computer programs: I. Synthetic glow curves. Radiation Protection Dosimetry, 47(1-4), 473-477.
</p>
<p>Bos AJJ, Piters TM, Gomez Ros JM, Delgado A, 1994. An intercomparison of glow curve analysis computer programs: II. Measured glow curves. Radiation Protection Dosimetry, 51(4): 257-264.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Load package "tgcd".
  require(tgcd)

  data(Refglow)
  names(Refglow)
</code></pre>

<hr>
<h2 id='savgol'>
Apply a Savitzky-Golay algorithm to smooth thermoluminescence glow curves
</h2><span id='topic+savgol'></span><span id='topic+savgol.default'></span>

<h3>Description</h3>

<p>Smooth thermoluminescence glow curves with a Savitzky-Golay smoothing filter and calculate derivatives.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>savgol(y, drv, hwd = 3 * (drv + 2), pod = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="savgol_+3A_y">y</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): the data to be filtered</p>
</td></tr>
<tr><td><code id="savgol_+3A_drv">drv</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(<b>required</b>): the order of the derivative to be calculated</p>
</td></tr>
<tr><td><code id="savgol_+3A_hwd">hwd</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): half width of the segement used for filter</p>
</td></tr>
<tr><td><code id="savgol_+3A_pod">pod</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): order of the polynomial used for filter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Savitzky-Golay smoothing algorithm is particularly good at preserving lineshape while removing high frequency squiggles (Press et al., 1986). 
The procedure can be used to calculate derivatives of thermoluminescence data to identify the location of glow peaks.
</p>


<h3>Value</h3>

<p>The filtered signal, which has the same length as <code>y</code>.
</p>


<h3>References</h3>

<p>Press WH, Teukolsky SA, Vetterling WT, Flannery BP, 1986. Numberic recipes in Fortran 77, the Art of Scientific Computing, second edition. 
</p>


<h3>See Also</h3>

<p><a href="#topic+tgcd">tgcd</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> library(tgcd)
 data(Refglow)

 x &lt;- Refglow$x009[,1]
 y &lt;- Refglow$x009[,2]
 y0 &lt;- savgol(y, drv=0)
 dy &lt;- savgol(y, drv=1)

 plot(x, y, type="p", pch=21, bg="black")
 points(x, y0, type="l", col="blue", lwd=2)

 plot(x, dy, type="l", col="blue", lwd=2)
 abline(h=0, lty="dashed", col="red", lwd=2)

</code></pre>

<hr>
<h2 id='simPeak'>
Thermoluminescence glow peak simulation
</h2><span id='topic+simPeak'></span><span id='topic+simPeak.default'></span>

<h3>Description</h3>

<p>Simulating first-order, second-order, or general-order glow peaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simPeak(temps, n0, Nn = NULL, bv = NULL, ff, 
        ae, hr, typ = c("f", "s", "g"), 
        outfile = NULL, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simPeak_+3A_temps">temps</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): temperature values (K) where the values of the thermoluminescence 
intensity will be computed. It needs to be sorted increasingly. A vector of temperature values may be generated 
using the internal function <a href="base.html#topic+seq">seq</a></p>
</td></tr>
<tr><td><code id="simPeak_+3A_n0">n0</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): initial concentration of trapped electrons (1/cm^3)</p>
</td></tr>
<tr><td><code id="simPeak_+3A_nn">Nn</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): total concentration of the traps in the crystal (1/cm^3)</p>
</td></tr>
<tr><td><code id="simPeak_+3A_bv">bv</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): order number for the general order glow peak</p>
</td></tr>
<tr><td><code id="simPeak_+3A_ff">ff</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): the frequency factor (1/s)</p>
</td></tr>
<tr><td><code id="simPeak_+3A_ae">ae</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): the activation energy (eV)</p>
</td></tr>
<tr><td><code id="simPeak_+3A_hr">hr</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): the linear heating rate (K/s)</p>
</td></tr>
<tr><td><code id="simPeak_+3A_typ">typ</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): the type of a glow peak, <code>typ="f"</code> means first-order, <code>typ="s"</code> means second-order, <code>typ="g"</code> means general-order,
default <code>typ="f"</code></p>
</td></tr>
<tr><td><code id="simPeak_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, simulated intensities of glow peaks will 
be written to a file named <code>"outfile"</code> in <code>CSV</code> format and saved to the current work directory</p>
</td></tr>
<tr><td><code id="simPeak_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): draw a plot according to the simulated glow peak or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+simPeak">simPeak</a> simulates glow peaks of various orders. The first-, second-, and general-order glow peak 
can be simulated using the following three ordinary equations, respectively (Pagonis et al., 2006):
</p>
<p><code class="reqn">\frac{d_n}{d_T}=\frac{-nSexp(-\frac{E}{kT})}{\beta}</code>
</p>
<p><code class="reqn">\frac{d_n}{d_T}=\frac{-n^{2}Sexp(-\frac{E}{kT})}{N_n\beta}</code>
</p>
<p><code class="reqn">\frac{d_n}{d_T}=\frac{-n^{b}Sexp(-\frac{E}{kT})}{N_n\beta}</code>
</p>
<p>where <code class="reqn">n</code> is the concentration of trapped electrons, <code class="reqn">\frac{d_n}{d_T}</code> the rate of change of the concentration 
of trapped electrons, <code class="reqn">S</code> the frequency factor, <code class="reqn">E</code> the activation energy, <code class="reqn">T</code> the absolute temperature, 
<code class="reqn">k</code> the Boltzmann constant, <code class="reqn">N_n</code> the total concentration of the traps in the crystal, <code class="reqn">b</code> the b value 
(kinetic order), and <code class="reqn">\beta</code> the linear heating rate.
</p>
<p>The ordinary equation is solved by the Fortran 77 subroutine <em>lsoda</em> (original version written by Linda R. Petzold and 
Alan C. Hindmarsh available at Netlib: <a href="https://www.netlib.org/odepack/">https://www.netlib.org/odepack/</a>, modified version by R. Woodrow Setzer from the R package 
<em>deSolve</em> (Soetaert et al., 2010) available at CRAN: <a href="https://CRAN.R-project.org/package=deSolve">https://CRAN.R-project.org/package=deSolve</a>).
</p>


<h3>Value</h3>

<p>Return an invisible list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>temps</code></td>
<td>
<p>a vector of temperature values</p>
</td></tr>
<tr><td><code>tl</code></td>
<td>
<p>values of the thermoluminescence intensity</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>variation of concentration of trapped electrons with temperature</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>parameters used for describing the shape of a glow peak (Pagonis et al., 2006):<br /> 
the temperature corresponding to half intensity on the left side of the peak (<code>T1</code>);<br /> 
the temperature corresponding to half intensity on the right side of the peak (<code>T2</code>);<br />
the temperature corresponding to maximum intensity (<code>Tm</code>);<br />
the half-width at the left side of the peak (<code>d1=Tm-T1</code>);<br />
the half-width at the right side of the peak (<code>d2=T2-Tm</code>);<br />
the total half-width (<code>thw=d1+d2</code>);<br />
the symmetry factor (<code>sf=d2/thw</code>)</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pagonis V, Kitis G, Furetta C, 2006. Numerical and practical exercises in thermoluminescence. Springer Science &amp; Business Media.
</p>
<p>Soetaert K, Petzoldt T, Setzer RW, 2010. Solving Differential Equations in R: Package deSolve. Journal of Statistical Software, 33(9): 1-25.
</p>


<h3>See Also</h3>

<p><a href="#topic+tgcd">tgcd</a>; <a href="#topic+simqOTOR">simqOTOR</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
   # Simulate second-order glow peaks with various 
   # initial electron trap concentration (n0).
    temps &lt;- seq(400, 600, by=0.5)
    peak1 &lt;- simPeak(temps, n0=0.2e10, Nn=1e10, 
      ff=1e19, ae=2.0, hr=1, typ="s")
    peak2 &lt;- simPeak(temps, n0=0.4e10, Nn=1e10, 
      ff=1e19, ae=2.0, hr=1, typ="s")
    peak3 &lt;- simPeak(temps, n0=0.6e10, Nn=1e10, 
      ff=1e19, ae=2.0, hr=1, typ="s")
    peak4 &lt;- simPeak(temps, n0=0.8e10, Nn=1e10, 
      ff=1e19, ae=2.0, hr=1, typ="s")
    peak5 &lt;- simPeak(temps, n0=1.0e10, Nn=1e10, 
      ff=1e19, ae=2.0, hr=1, typ="s")
    peaks &lt;- cbind(peak1$tl, peak2$tl, peak3$tl, peak4$tl, peak5$tl)
    matplot(temps, peaks, type="l", lwd=2, lty="solid", 
      xlab="Temperature (K)", ylab="TL intensity (counts)")

</code></pre>

<hr>
<h2 id='simqOTOR'>
Thermoluminescence glow peak simulation
</h2><span id='topic+simqOTOR'></span><span id='topic+simqOTOR.default'></span>

<h3>Description</h3>

<p>Simulating glow peaks according to the one trap-one recombination 
center (OTOR) model using the quasi-equilibrium approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simqOTOR(temps, n0, Nn, Ah, An, ff, ae, 
         hr, outfile = NULL, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simqOTOR_+3A_temps">temps</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(<b>required</b>): temperature values (K) where the values of the thermoluminescence 
intensity will be computed, it needs to be sorted increasingly</p>
</td></tr>
<tr><td><code id="simqOTOR_+3A_n0">n0</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): initial concentration of trapped electrons (1/cm^3)</p>
</td></tr>
<tr><td><code id="simqOTOR_+3A_nn">Nn</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): total concentration of the traps in the crystal (1/cm^3)</p>
</td></tr>
<tr><td><code id="simqOTOR_+3A_ah">Ah</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): probability coefficient of electron recombining with holes in the recombination center (cm^3/s)</p>
</td></tr>
<tr><td><code id="simqOTOR_+3A_an">An</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): probability coefficient of electron retrapping in the traps (cm^3/s)</p>
</td></tr>
<tr><td><code id="simqOTOR_+3A_ff">ff</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): the frequency factor (1/s)</p>
</td></tr>
<tr><td><code id="simqOTOR_+3A_ae">ae</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(<b>required</b>): the activation energy (eV)</p>
</td></tr>
<tr><td><code id="simqOTOR_+3A_hr">hr</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): the linear heating rate (K/s)</p>
</td></tr>
<tr><td><code id="simqOTOR_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, simulated intensities of glow peaks will 
be written to a file named <code>"outfile"</code> in <code>CSV</code> format and saved to the current work directory</p>
</td></tr>
<tr><td><code id="simqOTOR_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): draw a plot according to the simulated glow peak or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+simqOTOR">simqOTOR</a> simulates a synthetic glow peak according to the OTOR model using the quasi-equilibrium 
approximation. This function may be used to simulating glow peaks of first-, second-, and general-order, depending 
on the given kinetic parameters. The approximate equation of the OTOR model derived using the quasi-equilibrium 
approximation can be described by (Pagonis et al., 2006):
</p>
<p><code class="reqn">\frac{d_n}{d_T}=\frac{-A_hn^2Sexp(-\frac{E}{kT})}{[nA_h+(N_n-n)A_n]\beta}</code>
</p>
<p>where <code class="reqn">n</code> is the concentration of trapped electrons, <code class="reqn">\frac{d_n}{d_T}</code> the rate of change of the concentration 
of trapped electrons, <code class="reqn">S</code> the frequency factor, <code class="reqn">E</code> the activation energy, <code class="reqn">T</code> the absolute temperature, 
<code class="reqn">k</code> the Boltzmann constant, <code class="reqn">N_n</code> the total concentration of the traps in the crystal, <code class="reqn">A_h</code> the probability 
coefficient of electron recombining with holes in the recombination center, <code class="reqn">A_n</code> the probability coefficient of 
electron retrapping in the traps, and <code class="reqn">\beta</code> the linear heating rate.
</p>
<p>The ordinary equation is solved by the Fortran 77 subroutine <em>lsoda</em> (original version written by Linda R. Petzold and 
Alan C. Hindmarsh available at Netlib: <a href="https://www.netlib.org/odepack/">https://www.netlib.org/odepack/</a>, modified version by R. Woodrow Setzer from the R package 
<em>deSolve</em> (Soetaert et al., 2010) available at CRAN: <a href="https://CRAN.R-project.org/package=deSolve">https://CRAN.R-project.org/package=deSolve</a>).
</p>


<h3>Value</h3>

<p>Return an invisible list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>temps</code></td>
<td>
<p>a vector of temperature values</p>
</td></tr>
<tr><td><code>tl</code></td>
<td>
<p>values of the thermoluminescence intensity</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>variation of concentration of trapped electrons with temperature</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>parameters used for describing the shape of a glow peak, see function <a href="#topic+simPeak">simPeak</a> for details</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pagonis V, Kitis G, Furetta C, 2006. Numerical and practical exercises in thermoluminescence. Springer Science &amp; Business Media.
</p>
<p>Soetaert K, Petzoldt T, Setzer RW, 2010. Solving Differential Equations in R: Package deSolve. Journal of Statistical Software, 33(9): 1-25. 
</p>


<h3>See Also</h3>

<p><a href="#topic+tgcd">tgcd</a>; <a href="#topic+simPeak">simPeak</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
    # Synthesizing a glow curve consisting of five glow peaks.
     temps &lt;- seq(330, 730, by=0.5)
     peak1 &lt;- simqOTOR(temps, n0=0.7e10, Nn=1e10, Ah=1e-3, An=1e-7,
       ff=1e14, ae=1.5, hr=1, outfile = NULL, plot = TRUE)
     peak2 &lt;- simqOTOR(temps, n0=0.5e10, Nn=1e10, Ah=1e-7, An=1e-7,
       ff=1e17, ae=1.9, hr=1, outfile = NULL, plot = TRUE)
     peak3 &lt;- simqOTOR(temps, n0=0.2e10, Nn=1e10, Ah=1e-5, An=1e-7,
       ff=1e15, ae=1.45, hr=1, outfile = NULL, plot = TRUE)
     peak4 &lt;- simqOTOR(temps, n0=0.2e10, Nn=1e10, Ah=1e-5, An=1e-7,
       ff=1e9, ae=0.85, hr=1, outfile = NULL, plot = TRUE)
     peak5 &lt;- simqOTOR(temps, n0=0.3e10, Nn=1e10, Ah=1e-7, An=1e-7,
       ff=1e11, ae=1.4, hr=1, outfile = NULL, plot = TRUE)
     peaks &lt;- cbind(peak1$tl, peak2$tl, peak3$tl, peak4$tl, peak5$tl, 
       peak1$tl+peak2$tl+peak3$tl+peak4$tl+peak5$tl)
     matplot(temps, y=peaks, type="l", lwd=2, lty="solid", 
       xlab="Temperature (K)", ylab="TL intensity (counts)")
</code></pre>

<hr>
<h2 id='tgcd'>
Thermoluminescence glow curve deconvolution (tgcd)
</h2><span id='topic+tgcd'></span><span id='topic+tgcd.default'></span>

<h3>Description</h3>

<p>Thermoluminescence glow curve deconvolution according to various first-order, second-order, general-order, and mixed-order empirical expressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tgcd(Sigdata, npeak, model = "g1", subBG = FALSE, pickp = "d2", 
     pickb = "d0", nstart = 60, kkf = 0.03, mdt = NULL, mwt = NULL,  
     mr = NULL, edit.inis = TRUE, inisPAR = NULL, inisBG = NULL, 
     hr = NULL, hwd = NULL, pod = NULL, plot = TRUE, outfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tgcd_+3A_sigdata">Sigdata</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(<b>required</b>): a <code>2</code>-column matrix, temperature values (in unit K) and thermoluminescence signal values are 
stored in the first and second column, respectively</p>
</td></tr>
<tr><td><code id="tgcd_+3A_npeak">npeak</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(<b>required</b>): number of glow peaks, the allowed maximum number of glow peaks is set equal to 13</p>
</td></tr>
<tr><td><code id="tgcd_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): model used for glow curve deconvolution, <code>"f1"</code>, <code>"f2"</code>, and <code>"f3"</code> for first-order models, <code>"s1"</code>, 
<code>"s2"</code> for second-order models, <code>"g1"</code>, <code>"g2"</code>, <code>"g3"</code> for general-order models, <code>"wo"</code> and <code>"lw"</code> for the Wright Omega and the Lambert W functions,
<code>"m1"</code>, <code>"m2"</code>, and <code>"m3"</code> for the mixed-order models (see <b>Details</b>)</p>
</td></tr>
<tr><td><code id="tgcd_+3A_subbg">subBG</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): whether the user want to subtract the background during the deconvolution</p>
</td></tr>
<tr><td><code id="tgcd_+3A_pickp">pickp</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): mode used for initialization of kinetic parameters if <code>inisPAR=NULL</code>, 
<code>"d0"</code> and <code>"d01"</code> prompt the user to click with a mouse on the original and log-scale glow curves respectively to locate each glow peak,
<code>"d1"</code>, <code>"d2"</code>, <code>"d3"</code>, and <code>"d4"</code> prompt the user to click with a mouse on the first-, second-, third-, 
and fourth-derivative of the glow curve respectively to locate each glow peak</p>
</td></tr>
<tr><td><code id="tgcd_+3A_pickb">pickb</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(with default): mode used for initialization of background parameters if <code>inisBG=NULL</code>, 
<code>"d0"</code> and <code>"d01"</code> prompt the user to click with a mouse on the original and log-scale glow curves respectively to initilize the background parameters</p>
</td></tr>
<tr><td><code id="tgcd_+3A_nstart">nstart</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): number of trials performed in a &quot;trial-and-error&quot; protocol, the upper limit is set equal to 10000</p>
</td></tr>
<tr><td><code id="tgcd_+3A_kkf">kkf</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(with default): factor controlling the range of values from which random starting parameters will be generated during 
the &quot;trial-and-error&quot; protocol, <code>0&lt;kkf&lt;1</code>. For example, if <code>kkf=0.03</code> then kinetic parameters will be generated uniformly between 
<code>(1.0-kkf)*inisPAR</code> and <code>(1.0+kkf)*inisPAR</code> and background parameters will be generated uniformly between 
<code>(1.0-kkf)*inisBG</code> and <code>(1.0+kkf)*inisBG</code></p>
</td></tr>
<tr><td><code id="tgcd_+3A_mdt">mdt</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): allowed minimum distance between <code>Tm</code> values of glow peaks. 
A larger <code>mdt</code> prevents the appearance of strongly overlapping peaks</p>
</td></tr>
<tr><td><code id="tgcd_+3A_mwt">mwt</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): allowed maximum total half-width of deconvoluted glow peaks. 
A smaller <code>mwt</code> prevents the appearance of glow peaks with large total half-width</p>
</td></tr>
<tr><td><code id="tgcd_+3A_mr">mr</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): allowed minimum resolution of glow peaks. 
A larger <code>mr</code> prevents the appearance of strongly overlapping peaks</p>
</td></tr>
<tr><td><code id="tgcd_+3A_edit.inis">edit.inis</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): whether the user want to further modify, constrain, or fix 
the initialized kinetic (and/or background) parameters through an automatically generated <b>Dialog Table</b></p>
</td></tr>
<tr><td><code id="tgcd_+3A_inispar">inisPAR</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>(optional): a matrix (<code>3</code> or <code>4</code> columns) used for storing initial
kenetic parameters <code>Im</code>, <code>E</code>, <code>Tm</code>, <code>b</code> (or <code>R</code>, <code>a</code>) (see <b>Examples</b>)</p>
</td></tr>
<tr><td><code id="tgcd_+3A_inisbg">inisBG</code></td>
<td>
<p><a href="base.html#topic+vector">vector</a>(optional): a 3-element vector containing initial background parameters 
<code>A</code>, <code>B</code>, and <code>C</code> used for background subtraction (see <b>Examples</b>)</p>
</td></tr>
<tr><td><code id="tgcd_+3A_hr">hr</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>(optional): linear heating rate used for calculating the frequency factor</p>
</td></tr>
<tr><td><code id="tgcd_+3A_hwd">hwd</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): half width (length) of the segement used for Savitzky-Golay smoothing</p>
</td></tr>
<tr><td><code id="tgcd_+3A_pod">pod</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>(with default): order of the polynomial used for Savitzky-Golay smoothing</p>
</td></tr>
<tr><td><code id="tgcd_+3A_plot">plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a>(with default): draw a plot according to the fitting result or not</p>
</td></tr>
<tr><td><code id="tgcd_+3A_outfile">outfile</code></td>
<td>
<p><a href="base.html#topic+character">character</a>(optional): if specified, fitted signal values for each glow peak will be written to 
a file named <code>"outfile"</code> in <code>CSV</code> format and saved to the current work directory</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <a href="#topic+tgcd">tgcd</a> is used for deconvolving thermoluminescence glow curves according to various kinetic models. 
In the text below, <code class="reqn">I(T)</code> is the thermoluminescence intensity as function of temperature <code class="reqn">T</code>, <code class="reqn">E</code> the activation energyin ev, <code class="reqn">k</code> the Boltzmann constant in eV/k, 
<code class="reqn">T</code> the temperature in K with constant heating rate K/s, <code class="reqn">T_m</code> the temperature at maximum thermoluminescence intensity in K, 
<code class="reqn">I_m</code> the maximum intensity, <code class="reqn">b</code> is an extra parameter (the kinetic order) in application of a general-order model, 
<code class="reqn">R</code> is an extra parameter in application of the Lambert W (Wright Omega) function,
and <code class="reqn">\alpha</code> is an extra parameter in application of the mixed-order models.<br />
</p>
<p><b>First-order</b> glow peaks appear if the recombination probability (<code>A_m</code>) is greater than that of re-trapping (<code>A_n</code>) during excitation. 
The three parameters describing a glow peak are: <code class="reqn">I_m</code>, <code class="reqn">E</code>, and <code class="reqn">T_m</code>.
Three empirical expressions describing first-order glow peaks are available in function <a href="#topic+tgcd">tgcd</a>:<br />
<strong>&lt;1&gt;</strong>The first type of first-order empirical expression (<code>model="f1"</code>) is (Bos et al., 1993a)<br /><br />
<code class="reqn">I(T)=I_mexp(\frac{E}{kT_m}-\frac{E}{kT})exp[\frac{E}{kT_m}\alpha(\frac{E}{kT_m})-(\frac{T}{T_m})\alpha(\frac{E}{kT})exp(\frac{E}{kT_m}-\frac{E}{kT})]</code><br /><br />
where <code class="reqn">\alpha(x)</code> is a quotient of 4th-order polynomials of the form<br /><br />
<code class="reqn">\alpha(x)=\frac{a_0+a_1x+a_2x^2+a_3x^3+x^4}{b_0+b_1x+b_2x^2+b_3x^3+x^4}</code><br /><br />
<code class="reqn">a_0=0.267773734</code>, <code class="reqn">a_1=8.6347608925</code>, <code class="reqn">a_2=8.059016973</code>, <code class="reqn">a_3=8.5733287401</code>,<br />
<code class="reqn">b_0=3.9584969228</code>, <code class="reqn">b_1=21.0996530827</code>, <code class="reqn">b_2=25.6329561486</code>, <code class="reqn">b_3=9.5733223454</code><br />
</p>
<p><strong>&lt;2&gt;</strong>The second type of first-order empirical expression (<code>model="f2"</code>) is (Kitis et al., 1998)<br /><br />
<code class="reqn">I(T)=I_mexp[1+\frac{E}{kT}\frac{T-T_m}{T_m}-\frac{T^2}{T_m^2}exp(\frac{E}{kT}\frac{T-T_m}{T_m})(1-\frac{2kT}{E})-\frac{2kT_m}{E}]</code><br />
</p>
<p><strong>&lt;3&gt;</strong>The third type of first-order function fits a weibull function (<code>model="f3"</code>) (Pagonis et al., 2001)<br /><br />
<code class="reqn">I(T)=2.713I_m(\frac{T-T_m}{b}+0.996)^{15}exp[-(\frac{T-T_m}{b}+0.996)^{16}]</code><br /><br />
where <code class="reqn">b=\sqrt{\frac{242.036T_m^3k^2}{(E+T_mk)^2-7T_m^2k^2}}</code><br />
</p>
<p><b>Second-order</b> glow peaks appear if the re-trapping probability is comparable with or greater than that of recombination during excitation. 
The three parameters describing a glow peak are the same as those of first-orders.
Two empirical expressions describing second-order glow peaks are available in function <a href="#topic+tgcd">tgcd</a>:<br />
<strong>&lt;4&gt;</strong>The first type of second-order  empirical expression (<code>model="s1"</code>) is (Kitis et al., 1998)<br /><br />
<code class="reqn">I(T)=4I_mexp(\frac{E}{kT}\frac{T-T_m}{T_m})[\frac{T^2}{T_m^2}(1-\frac{2kT}{E})exp(\frac{E}{kT}\frac{T-T_m}{T_m})+1+\frac{2kT_m}{E}]^{-2}</code><br />
</p>
<p><strong>&lt;5&gt;</strong>The second type of second-order function fit a logistic asymmetric function (<code>model="s2"</code>) (Pagonis and Kitis, 2001)<br /><br />
<code class="reqn">I(T)=5.2973I_m[1+exp(-(\frac{T-T_m}{a_2}+0.38542))]^{-2.4702}exp[-(\frac{T-T_m}{a_2}+0.38542)]</code><br /><br />
where <code class="reqn">a_2=\sqrt{\frac{1.189T_m^4k^2}{E^2+4ET_mk}}</code><br />
</p>
<p><b>General-order</b> glow peaks are produced in intermediate cases (neither of first-order, nor of second-order). 
The four parameters describing a glow peak are: <code class="reqn">I_m</code>, <code class="reqn">E</code>, <code class="reqn">T_m</code>, and <code class="reqn">b</code>.
Three empirical expressions describing general-order glow peaks are available in function <a href="#topic+tgcd">tgcd</a>:<br />
<strong>&lt;6&gt;</strong>The first type of general-order empirical expression (<code>model="g1"</code>) is (Kitis et al., 1998)<br /><br />
<code class="reqn">I(T)=I_mb^{\frac{b}{b-1}}exp(\frac{E}{kT}\frac{T-T_m}{T_m})[(b-1)(1-\frac{2kT}{E})\frac{T^2}{T_m^2}exp(\frac{E}{kT}\frac{T-T_m}{T_m})+1+\frac{2kT_m(b-1)}{E}]^{-\frac{b}{b-1}}</code><br />
</p>
<p><strong>&lt;7&gt;</strong>The second type of general-order empirical expression (<code>model="g2"</code>) is (Gomez-Ros and Kitis, 2002)<br /><br />
<code class="reqn">I(T)=I_mexp(\frac{E}{kT_m}-\frac{E}{kT})[1+\frac{b-1}{b}\frac{E}{kT_m}(\frac{T}{T_m}exp(\frac{E}{kT_m}-\frac{E}{kT})F(\frac{E}{kT})-F(\frac{E}{kT_m}))]^{-\frac{b}{b-1}}</code><br /><br />
where <code class="reqn">F(x)</code> is a rational approximation function of the form<br /><br />
<code class="reqn">F(x)=1-\frac{a_0+a_1x+x^2}{b_0+b_1x+x^2}</code><br /><br />
<code class="reqn">a_0=0.250621</code>, <code class="reqn">a_1=2.334733</code>, <code class="reqn">b_0=1.681534</code>, <code class="reqn">b_1=3.330657</code><br />
</p>
<p><strong>&lt;8&gt;</strong>The third type of general-order empirical expression (<code>model="g3"</code>) is (Gomez-Ros and Kitis, 2002)<br /><br />
<code class="reqn">I(T)=I_mexp(\frac{E}{kT_m^2}(T-T_m))[\frac{1}{b}+\frac{b-1}{b}exp(\frac{E}{kT_m^2}(T-T_m))]^{-\frac{b}{b-1}}</code><br />
</p>
<p><b>One trap-one recombination (OTOR) model</b> based semi-analytical expressions have also been applied to fit glow peaks,
by using either the Lambert W function (Kitis and Vlachos, 2013; Sadek et al., 2015; Kitis et al., 2016) or 
the Wright Omega function (Singh and Gartia, 2013; 2014; 2015).
The four parameters describing a glow peak are: <code class="reqn">I_m</code>, <code class="reqn">E</code>, <code class="reqn">T_m</code>, and <code class="reqn">R=\frac{A_n}{A_m}</code> 
(where <code class="reqn">A_n</code> and <code class="reqn">A_m</code> represent the retrapping and recombination probabilities, respectively).
Two analytical expressions describing the OTOR model are available in function <a href="#topic+tgcd">tgcd</a>:<br />
<strong>&lt;9&gt;</strong>The semi-analytical expression derived using the Wright Omega function (<code class="reqn">R=\frac{A_n}{A_m}&lt;1</code>) can be described as (<code>model="wo"</code>)<br /><br />
<code class="reqn">I(T)=I_mexp(-\frac{E}{kT}\frac{T_m-T}{T_m})\frac{\omega(Z_m)+[\omega(Z_m)]^2}{\omega(Z)+[\omega(Z)]^2}</code><br /><br />
where <code class="reqn">Z_m=\frac{R}{1-R}-log(\frac{1-R}{R})+\frac{Eexp(\frac{E}{kT_m})}{kT_m^2(1-1.05R^{1.26})}F(T_m,E)</code>,<br /><br />
and <code class="reqn">Z=\frac{R}{1-R}-log(\frac{1-R}{R})+\frac{Eexp(\frac{E}{kT_m})}{kT_m^2(1-1.05R^{1.26})}F(T,E)</code>,<br /><br />
<strong>&lt;10.1&gt;</strong>The semi-analytical expression derived using the Lambert W function for <code class="reqn">R=\frac{A_n}{A_m}&lt;1</code> can be described as (<code>model="lw"</code>)<br /><br />
<code class="reqn">I(T)=I_mexp(-\frac{E}{kT}\frac{T_m-T}{T_m})\frac{W(exp(Z_m))+[W(exp(Z_m))]^2}{W(exp(Z))+[W(exp(Z))]^2}</code><br /><br />
where <code class="reqn">Z_m=\frac{R}{1-R}-log(\frac{1-R}{R})+\frac{Eexp(\frac{E}{kT_m})}{kT_m^2(1-1.05R^{1.26})}F(T_m,E)</code>,<br /><br />
and <code class="reqn">Z=\frac{R}{1-R}-log(\frac{1-R}{R})+\frac{Eexp(\frac{E}{kT_m})}{kT_m^2(1-1.05R^{1.26})}F(T,E)</code>,<br /><br />
<strong>&lt;10.2&gt;</strong>The semi-analytical expression derived using the Lambert W function for <code class="reqn">R=\frac{A_n}{A_m}&gt;1</code> can be described as (<code>model="lw"</code>)<br /><br />
<code class="reqn">I(T)=I_mexp(-\frac{E}{kT}\frac{T_m-T}{T_m})\frac{W(-1,-exp(-Z_m))+[W(-1,-exp(-Z_m))]^2}{W(-1,-exp(-Z))+[W(-1,-exp(-Z))]^2}</code><br /><br />
where <code class="reqn">Z_m=|\frac{R}{1-R}|+log(|\frac{1-R}{R}|)+\frac{Eexp(\frac{E}{kT_m})}{kT_m^2(2.963-3.24R^{-0.74})}F(T_m,E)</code>,<br /><br />
and <code class="reqn">Z=|\frac{R}{1-R}|+log(|\frac{1-R}{R}|)+\frac{Eexp(\frac{E}{kT_m})}{kT_m^2(2.963-3.24R^{-0.74})}F(T,E)</code><br /><br />
<code class="reqn">F(T_m,E)</code> and <code class="reqn">F(T,E)</code> are described as follows<br /><br />
<code class="reqn">F(T_m,E)=T_mexp(-\frac{E}{kT_m})+\frac{E}{k}Ei(-\frac{E}{kT_m})</code>,<br /><br />
<code class="reqn">F(T,E)=Texp(-\frac{E}{kT})+\frac{E}{k}Ei(-\frac{E}{kT})</code><br /><br />
where <code class="reqn">\omega(x)</code> and <code class="reqn">Ei(x)</code> are the wright Omega function and the exponential integral function for variable <code class="reqn">x</code>, respectively.
<code class="reqn">W(x)</code> and <code class="reqn">W(-1,x)</code> are the principal and the second branches of the Lambert W function, respectively.
The Fortran 90 subroutine used for evaluating the Wright Omega function is transformed from the Matlab code provided by Andrew Horchler (<a href="https://github.com/horchler/wrightOmegaq">https://github.com/horchler/wrightOmegaq</a>).
The Fortran 90 subroutine (original Fortran 77 version by William Cody) used for evaluating the Lambert W function written by John Burkardt is available at 
<a href="https://people.sc.fsu.edu/~jburkardt/f_src/toms743/toms743.f90">https://people.sc.fsu.edu/~jburkardt/f_src/toms743/toms743.f90</a>. 
The Fortran 90 subroutine used for evaluating the exponential integral function is written by John Burkardt (original Fortran 77 version by William Cody) 
(<a href="https://people.sc.fsu.edu/~jburkardt/f_src/toms715/toms715.f90">https://people.sc.fsu.edu/~jburkardt/f_src/toms715/toms715.f90</a>).<br />
</p>
<p><b>Mixed-order</b> kinetic models introduce an extra parameter <code class="reqn">\alpha=\frac{n_0}{n_0+M}</code> where <code class="reqn">n_0</code> is the initial filled concentration of the active traps and <code class="reqn">M</code>
is the trap concentration of the thermally disconnected deep traps (Sunta et al., 2002). The four parameters describing a glow peak are: <code class="reqn">I_m</code>, <code class="reqn">E</code>, <code class="reqn">T_m</code>, and <code class="reqn">\alpha</code>.
Three empirical expressions describing mixed-order glow peaks are available in function <a href="#topic+tgcd">tgcd</a>:<br />
<strong>&lt;11&gt;</strong>The first type of mixed-order empirical expression (<code>model="m1"</code>) is (Kitis and Gomez-Ros, 2000)<br /><br />
<code class="reqn">I(T)=\frac{I_m[exp(\frac{1-\frac{2kT_m}{E}}{R_m})-\alpha]^2exp(\frac{E}{kT}\frac{T-T_m}{T_m})exp[\frac{T^2}{T_m^2R_m}exp(\frac{E}{kT}\frac{T-T_m}{T_m})
(1-\frac{2kT}{E})]}{exp(\frac{1-\frac{2kT_m}{E}}{R_m})[exp[\frac{T^2}{T_m^2R_m}exp(\frac{E}{kT}\frac{T-T_m}{T_m})(1-\frac{2kT}{E})]-\alpha]^2}</code><br /><br /><br />
where <code class="reqn">R_m=\frac{A_m+\alpha}{A_m-\alpha}</code> and <code class="reqn">A_m=exp(\frac{A_m-\alpha}{A_m+\alpha}(1-\frac{2kT_m}{E}))</code><br />
</p>
<p><strong>&lt;12&gt;</strong>The second type of mixed-order empirical expression (<code>model="m2"</code>) is (Gomez-Ros and Kitis, 2002)<br /><br />
<code class="reqn">I(T)=\frac{4I_mR_m^2exp(\frac{E}{kT_m}-\frac{E}{kT})exp[R_m\frac{E}{kT_m}(\frac{T}{T_m}exp(\frac{E}{kT_m}-\frac{E}{kT})F(\frac{E}{kT})-F(\frac{E}{kT_m}))]}
{(1+R_m)[exp[R_m\frac{E}{kT_m}(\frac{T}{T_m}exp(\frac{E}{kT_m}-\frac{E}{kT})F(\frac{E}{kT})-F(\frac{E}{kT_m}))]-(1-R_m)]^2}</code><br /><br />
where <code class="reqn">R_m=(1-\alpha)(1+0.2922\alpha-0.2783\alpha^2)</code><br /><br />
<code class="reqn">F(x)=1-\frac{a_0+a_1x+x^2}{b_0+b_1x+x^2}</code><br /><br />
<code class="reqn">a_0=0.250621</code>, <code class="reqn">a_1=2.334733</code>, <code class="reqn">b_0=1.681534</code>, <code class="reqn">b_1=3.330657</code><br />
</p>
<p><strong>&lt;13&gt;</strong>The third type of mixed-order empirical expression (<code>model="m3"</code>) is (Vejnovic et al., 2008)<br /><br />
<code class="reqn">I(T)=\frac{I_m\alpha(2-l)^2exp[\frac{T^2}{T_m^2}(\frac{2}{l}-1)exp(\frac{E}{kT_m}\frac{T-T_m}{T_m})(1-\frac{2kT}{E})]exp(\frac{E}{kT_m}\frac{T-T_m}{T_m})}{
(l-1)[exp[\frac{T^2}{T_m^2}(\frac{2}{l}-1)exp(\frac{E}{kT_m}\frac{T-T_m}{T_m})(1-\frac{2kT}{E})]-\alpha]^2}</code><br /><br /><br />
where <code class="reqn">\alpha=(l-1)exp[\frac{2-l}{l}(1-\frac{2kT_m}{E})]</code><br />
</p>
<p>The <strong>background</strong> will be subtracted using the following expression if <code>subBG=TRUE</code> (Horowitz and Yossian, 1995; Kitis et al., 2012)<br /><br />
<code class="reqn">I(T)=A+Bexp(\frac{T}{C})</code><br /><br />
where <code class="reqn">A</code>, <code class="reqn">B</code>, and <code class="reqn">C</code> are positive parameters to be optimized.<br />
</p>
<p>The procedure minimizes the objective:
<code class="reqn">fcn=\sum_{i=1}^n |y_i^o-y_i^f|, i=1,...,n</code>
where <code class="reqn">y_i^o</code> and <code class="reqn">y_i^f</code> denote the <em>i-th</em> observed and fitted signal value, respectively, 
and <code class="reqn">n</code> indicates the number of data points.<br />
</p>
<p>The Levenberg-Marquardt algorithm (More, 1978) (<em>minpack</em>: <a href="https://netlib.org/minpack/">https://netlib.org/minpack/</a>, original Fortran 77 version by Jorge More, Burton Garbow, Kenneth Hillstrom. 
Fortran 90 version by John Burkardt <a href="https://people.sc.fsu.edu/~jburkardt/f_src/minpack/minpack.f90">https://people.sc.fsu.edu/~jburkardt/f_src/minpack/minpack.f90</a>) was modified so as to supports constraints and fixes of parameters.
A &quot;trial-and-error&quot; protocol with starting values generated uniformly around the given starting parameters <code>inisPAR</code> and <code>inisBG</code> is performed 
repeatedly to search the optimal parameters that give a minimum Figure Of Merit (FOM) value (Balian and Eddy, 1977).<br />
</p>
<p>Kinetic parameters can be initialized by the user through argument <code>inisPAR</code> or by clicking with a mouse on 
the plot of the thermoluminescence glow curve showing peak maxima if <code>inisPAR=NULL</code>.
Background parameters can be initialized by the user through argument <code>inisBG</code> or by clicking with a mouse on 
the plot of the thermoluminescence glow curve to select 4 data points if <code>inisBG=NULL</code>.<br />
</p>
<p>Parameters can be interactively constrained and fixed by modifying the following elements in a automatically 
generated <b>Dialog Table</b> if <code>edit.inis=TRUE</code>:<br /> 
<b>(1)</b> <code>INTENS[min,max,ini,fix]</code>: lower and upper bounds, starting and fixing values of <code class="reqn">I_m</code> <br />
<b>(2)</b> <code>ENERGY[min,max,ini,fix]</code>: lower and upper bounds, starting and fixing values of <code class="reqn">E</code> <br />
<b>(3)</b> <code>TEMPER[min,max,ini,fix]</code>: lower and upper bounds, starting and fixing values of <code class="reqn">T_m</code> <br />
<b>(4)</b> <code>bValue[min,max,ini,fix]</code>: lower and upper bounds, starting and fixing values of <code class="reqn">b</code> in the general-order model<br />
<b>(5)</b> <code>rValue[min,max,ini,fix]</code>: lower and upper bounds, starting and fixing values of <code class="reqn">R</code> in the OTOR model<br />
<b>(6)</b> <code>aValue[min,max,ini,fix]</code>: lower and upper bounds, starting and fixing values of <code class="reqn">\alpha</code> in the mixed-order model<br />
<b>(7)</b> <code>BG[min,max,ini,fix]</code>: lower and upper bounds, starting and fixing values of background parameters <code class="reqn">A</code>, <code class="reqn">B</code>, and <code class="reqn">C</code><br />
</p>


<h3>Value</h3>

<p>Return an <b>invisible</b> list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>comp.sig</code></td>
<td>
<p>calculated signal values for each glow peak</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>calculated residual values</p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>optimized parameters stored in a matrix</p>
</td></tr>
<tr><td><code>BGpars</code></td>
<td>
<p>optimized background parameters, it returns <code>NULL</code> if <code>subBG=FALSE</code></p>
</td></tr>
<tr><td><code>ff</code></td>
<td>
<p>calculated frequency factors, it returns <code>NULL</code> if <code>hr=NULL</code></p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>parameters used for describing the shape of a glow peak, see function <a href="#topic+simPeak">simPeak</a> for details</p>
</td></tr>
<tr><td><code>resolution</code></td>
<td>
<p>resolutions of optimized glow peaks calculated after Kitis and Pagonis (2019), it returns <code>NULL</code> if <code>npeak=1</code></p>
</td></tr>
<tr><td><code>SSR</code></td>
<td>
<p>Squared Sum of Residuals</p>
</td></tr>
<tr><td><code>RCS</code></td>
<td>
<p>Reduced Chi-Square value</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>squared &quot;pearson&quot; correlation between observed and fitted signals</p>
</td></tr>
<tr><td><code>FOM</code></td>
<td>
<p>Figure Of Merit value calculated after Balian and Eddy (1977)</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Function <a href="#topic+tgcd">tgcd</a> analyzes only thermoluminescence glow curves recorded with linear heating function (LHF) profile.
The model to be optimized should not be underdetermined. This means that the number of data points (<code class="reqn">n_d</code>) should exceed the number of parameters (<code class="reqn">n_2</code>).<br />
</p>
<p>If it is not <code>NULL</code> the argument <code>inisPAR</code>, the procedure used for initializing kinetic parameters by clicking with a mouse will not be triggered.
Similarly, if it is not <code>NULL</code> the argment <code>inisBG</code>, the procedure used for initializing background parameters by clicking with a mouse will not be triggered.<br />
</p>
<p>The user is advocated to use <code>mwt</code>, <code>mdt</code>, and <code>mr</code> to specify the allowed maximum total half-width, 
the allowed minimum distance, and the allowed minimum resolution respectively to resolve seriously overlapped glow peaks during the trial-and-error protocol.<br />
</p>
<p>Adrie J.J. Bos is appreciated for providing the reference glow curves of the GLOCANIN project to test this routine.<br />
</p>
<p>Amr M. Sadek is thanked for providing the Matlab code implementing the Lambert W (Wright Omega) function for reference.<br />
</p>
<p>George Kitis is appreciated for giving some useful suggestions to improve the program and providing many experimentally measured thermoluminescence glow curves to check the routine.<br />
</p>


<h3>References</h3>

<p>Balian HG, Eddy NW, 1977. Figure-of-merit (FOM), an improved criterion over the normalized chi-squared test for assessing goodness-of-fit of gamma-ray spectral peaks. 
Nuclear and Instruments Methods, 145: 389-395.
</p>
<p>Bos AJJ, Piters TM, Gomez-Ros JM, Delgado A, 1993a. An intercomparison of glow curve analysis computer programs. 
IRI-CIEMAT Report, 131-93-005.
</p>
<p>Gomez-Ros JM, Kitis G, 2002. Computerised glow curve deconvolution using general and mixed order kinetics. 
Radiation Protection Dosimetry, 101(1-4): 47-52.
</p>
<p>Horowitz YS, Yossian D, 1995. Computerized glow curve deconvolution: application to thermoluminescence dosimetry. 
Radiation Protection Dosimetry, 60: 1-114.
</p>
<p>Kitis G, Carinou E, Askounis P, 2012. Glow-curve de-convolution analysis of TL glow-curve from constant temperature hot gas TLD readers.
Radiation Measurements, 47: 258-265.
</p>
<p>Kitis G, Gomes-Ros JM, 2000. Thermoluminescence glow-curve deconvolution functions for mixed order of kinetics and continuous trap distribution. 
Nuclear Instruments and Methods in Physics Research A, 440: 224-231.
</p>
<p>Kitis G, Gomes-Ros JM, Tuyn JWN, 1998. Thermoluminescence glow curve deconvolution functions for first, second and general orders of kinetics. 
Journal of Physics D: Applied Physics, 31(19): 2636-2641.
</p>
<p>Kitis G, Pagonis V, 2019. On the resolution of overlapping peaks in complex thermoluminescence glow curves. 
Nuclear Instruments and Methods in Physics Research, A, 913: 78-84.
</p>
<p>Kitis G, Polymeris GS, Pagonis V, 2019. Stimulated luminescence emission: From phenomenological models to master analytical equations. 
Applied Radiation and Isotopes, 153: 108797.
</p>
<p>Kitis G, Polymeris GS, Sfampa IK, Prokic M, Meric N, Pagonis V, 2016. Prompt isothermal decay of thermoluminescence in MgB4O7:Dy, Na and LiB4O7:Cu, In dosimeters. 
Radiation Measurements, 84: 15-25.
</p>
<p>Kitis G, Vlachos ND, 2013. General semi-analytical expressions for TL, OSL and other luminescence stimulation modes derived from the OTOR model using the Lambert W-function. 
Radiation Measurements, 48: 47-54.
</p>
<p>More JJ, 1978. &quot;The Levenberg-Marquardt algorithm: implementation and theory,&quot; in Lecture Notes in Mathematics: Numerical Analysis, Springer-Verlag: Berlin. 105-116.
</p>
<p>Pagonis V, Mian SM, Kitis G, 2001. Fit of first order thermoluminescence glow peaks using the weibull distribution function. 
Radiation Protection Dosimetry, 93(1): 11-17.
</p>
<p>Pagonis V, Kitis G, 2001. Fit of second order thermoluminescence glow peaks using the logistic distribution function. 
Radiation Protection Dosimetry, 95(3): 225-229.
</p>
<p>Sadek AM, Eissa HM, Basha AM, Carinou E, Askounis P, Kitis G, 2015. The deconvolution of thermoluminescence glow-curves using general expressions 
derived from the one trap-one recombination (OTOR) level model. Applied Radiation and Isotopes, 95: 214-221.
</p>
<p>Singh LL, Gartia RK, 2013. Theoretical derivation of a simplified form of the OTOR/GOT differential equation. 
Radiation Measurements, 59: 160-164.
</p>
<p>Singh LL, Gartia RK, 2014. Glow-curve deconvolution of thermoluminescence curves in the simplified OTOR equation using the Hybrid Genetic Algorithm. 
Nuclear Instruments and Methods in Physics Research B, 319: 39-43.
</p>
<p>Singh LL, Gartia RK, 2015. Derivation of a simplified OSL OTOR equation using Wright Omega function and its application. 
Nuclear Instruments and Methods in Physics Research B, 346: 45-52.
</p>
<p>Sunta CM, Ayta WEF, Chubaci JFD, Watanabe S, 2002. General order and mixed order of thermoluminescence glow curves-a comparison. 
Radiation Measurements, 35: 47-57.
</p>
<p>Vejnovic Z, Pavlovic MB, Davidovi M, 2008. Thermoluminescence glow curve deconvolution function for the mixed-order kinetics. 
Radiation Measurements, 43: 1325-1330.
</p>
<p><b>Further reading</b> 
</p>
<p>Afouxenidis D, Polymeris GS, Tsirliganis NC, Kitis G., 2011. Computerised curve deconvolution of TL/OSL curves using a popular spreadsheet program. 
Radiation Protection Dosimetry, 1-8.
</p>
<p>Bos AJJ, Piters TM, Gomez Ros JM, Delgado A, 1993b. An intercomparison of glow curve analysis computer programs: I. Synthetic glow curves. 
Radiation Protection Dosimetry, 47(1-4), 473-477.
</p>
<p>Chung KS, Choe HS, Lee JI, Kim JL, Chang SY, 2005. A computer program for the deconvolution of thermoluminescence glow curves. 
Radiation Protection Dosimetry, 115(1-4): 345-349.
</p>
<p>Delgado A, Gomez-Ros JM, 2001. Computerised glow curve analysis: a tool for routine thermoluminescence dosimetry. 
Radiation Protection Dosimetry, 96(1-3): 127-132.
</p>
<p>El-Hafez AI, Yasin MN, Sadek AM, 2011. GCAFIT-A new tool for glow curve analysis in thermoluminescence nanodosimetry. 
Nuclear Instruments and Methods in Physics Research A, 637: 158-163.
</p>
<p>Espinosa G, Castano VM, 1991. Automated derivative analysis of thermoluminescence glow curves. 
Applied Radiation and Isotopes, 42(4): 377-381.
</p>
<p>Harvey JA, Rodrigues ML, Kearfott JK, 2011. A computerized glow curve analysis (GCA) method for WinREMS thermoluminescent dosimeter data using MATLAB. 
Applied Radiation and Isotopes, 69(9):1282-1286.
</p>
<p>Horowitz YS, Moscovitch M, 2012. Highlights and pitfalls of 20 years of application of computerised glow curve ananlysis to thermoluminescence research and dosimetry. 
Radiation Protection Dosimetry, 1-22.
</p>
<p>Horowitz Y, Delgado A, Pradhan AS, Yoder RC, 2002. Topics under debate: the use of computerised glow curve analysis will optimise personal thermoluminescence dosimetry. 
Radiation Protection Dosimetry, 102(3): 269-277.
</p>
<p>Karmakar M, Bhattacharyya S, Sarkar A, Mazumdar PS, Singh SD, 2017. Analysis of thermoluminescence glow curves using derivatives of different orders. 
Radiation Protection Dosimetry, 1-10.
</p>
<p>Kiisk V, 2013. Deconvolution and simulation of thermoluminescence glow curves with Mathcad. 
Radiation Protection Dosimetry, 156(3): 261-267.
</p>
<p>Pagonis V, Kitis G, Furetta C, 2006. Numerical and practical exercises in thermoluminescence. 
Springer Science &amp; Business Media. 
</p>
<p>Puchalska M, Bilski P, 2006. GlowFit-a new tool for thermoluminescence glow-curve deconvolution. 
Radiation Measurements, 41(6): 659-664. 
</p>
<p>Sadek AM, 2013. Test of the accuracy of the computerized glow curve deconvolution algorithm for the analysis of thermoluminescence glow curves.
Nuclear Instruments and Methods in Physics Research A, 712: 56-61.
</p>
<p>Sadek AM, Kitis G., 2018. Impact of non-fulfillment of the super position principle on the analysis of thermoluminescence glow-curve. 
Radiation Measurements, 116: 14-23.
</p>
<p>Singh TB, Rey L, Gartia RK, 2011. Applications of PeakFit software in thermoluminescence studies. 
Indian Journal of Pure &amp; Applied Physics, 49: 297-302.
</p>
<p>Sunta CM, 2015. Unraveling thermoluminescence. Springer India.
</p>


<h3>See Also</h3>

<p><a href="#topic+simPeak">simPeak</a>; <a href="#topic+simqOTOR">simqOTOR</a>; <a href="#topic+savgol">savgol</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the data.
  data(Refglow)
  data(Kitis)

# (1) Deconvolution of a glow curve using 4 peaks (no background subtraction) with 
#     the Wright Omega function using specified initial kinetic parameters.

  knPars &lt;- 
  cbind(c(400, 550, 850, 1600), # Im
        c(1.4, 1.5, 1.6, 2),    # E
        c(420, 460, 480, 510),  # Tm
        c(0.1, 0.1, 0.1, 0.1))  # R

  dd1 &lt;- tgcd(Refglow$x002, npeak=4, model="wo",
              inisPAR=knPars, nstart=10, edit.inis=FALSE)

  head(dd1$comp.sig)
  dd1$pars
  dd1$sp
  dd1$FOM

# (2) Deconvolution of a glow curve using 5 peaks (with background subtraction) with 
#     a mixed-order model using user-supplied intial kinetic and background parameters. 
  knPars &lt;- 
  cbind(c(46829.06, 187942.43, 121876.22, 110390.55, 67978.33), #Im
        c(1.17, 1.14, 1.57, 0.77, 1.31),                        # E
        c(369.86, 400.69, 428.51,  482.41, 537.28),             # Tm
        c(0.75,  0.81, 0.92, 0.001, 0.29))                      # a

  bgPars &lt;- c(1, 10, 100)  # A, B, C.

  dd2 &lt;- tgcd(Kitis$x009, npeak=5, model="m1", subBG=TRUE, 
              inisPAR=knPars, inisBG=bgPars, nstart=10, edit.inis=FALSE)

  dd2$residual
  dd2$SSR
  dd2$R2
  dd2$BGpars
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
