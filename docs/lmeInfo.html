<!DOCTYPE html><html><head><title>Help for package lmeInfo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmeInfo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Bryant2016'><p>Bryant et al. (2016)</p></a></li>
<li><a href='#CI_g'><p>Calculates a confidence interval for a standardized mean difference effect size</p></a></li>
<li><a href='#extract_varcomp'><p>Extract estimated variance components</p></a></li>
<li><a href='#Fisher_info'><p>Calculate expected, observed, or average Fisher information matrix</p></a></li>
<li><a href='#g_mlm'><p>Calculates adjusted mlm effect size</p></a></li>
<li><a href='#varcomp_vcov'><p>Estimated sampling variance-covariance of variance component</p>
parameters.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Information Matrices for 'lmeStruct' and 'glsStruct' Objects</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides analytic derivatives and information matrices for
    fitted linear mixed effects (lme) models and generalized least squares (gls) models
    estimated using lme() (from package 'nlme') and gls() (from package 'nlme'), respectively.
    The package includes functions for estimating the sampling variance-covariance of variance
    component parameters using the inverse Fisher information. The variance components include
    the parameters of the random effects structure (for lme models), the variance structure,
    and the correlation structure. The expected and average forms of the Fisher information matrix
    are used in the calculations, and models estimated by full maximum likelihood or
    restricted maximum likelihood are supported. The package also includes a function for estimating
    standardized mean difference effect sizes (Pustejovsky, Hedges, and Shadish (2014) &lt;<a href="https://doi.org/10.3102%2F1076998614547577">doi:10.3102/1076998614547577</a>&gt;)
    based on fitted lme or gls models.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://jepusto.github.io/lmeInfo/">https://jepusto.github.io/lmeInfo/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jepusto/lmeInfo/issues">https://github.com/jepusto/lmeInfo/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat (&ge; 2.1.0), knitr, rmarkdown, scdhlm, mlmRev,
carData, lme4, Matrix, merDeriv</td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme, stats</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-16 12:49:00 UTC; C-ama</td>
</tr>
<tr>
<td>Author:</td>
<td>James Pustejovsky <a href="https://orcid.org/0000-0003-0591-9465"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Man Chen [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Man Chen &lt;manchen9005@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-17 08:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='Bryant2016'>Bryant et al. (2016)</h2><span id='topic+Bryant2016'></span>

<h3>Description</h3>

<p>Data from a multi-level multiple baseline design conducted by Bryant et al. (2016).
The study involved collecting repeated measures of math performance on twelve students
nested in three schools. The variables are as follows:
</p>

<ul>
<li> <p><code>Study_ID</code> Study identifier.
</p>
</li>
<li> <p><code>school</code> School identifier.
</p>
</li>
<li> <p><code>case</code> Student identifier.
</p>
</li>
<li> <p><code>session</code> Measurement occasion.
</p>
</li>
<li> <p><code>treatment</code> Indicator for treatment phase.
</p>
</li>
<li> <p><code>outcome</code> Texas Early Mathematics Inventory (TEMI-Aim Check) scores.
</p>
</li>
<li> <p><code>trt_time</code> Measurement occasion times treatment phase.
</p>
</li>
<li> <p><code>session_c</code> Measurement occasion centered at the follow-up time (Measurement occasion 9).
</p>
</li></ul>



<h3>Format</h3>

<p>A data frame with 299 rows and 8 variables
</p>


<h3>Source</h3>

<p>Bryant, B. R., Bryant, D. P., Porterfield, J., Dennis, M. S., Falcomata, T.,
Valentine, C., Brewer, C., &amp; Bell, K. (2016).
The effects of a Tier 3 intervention on the mathematics performance of second grade
students with severe mathematics difficulties.
<em>Journal of Learning Disabilities, 49</em>(2), 176-188. <a href="https://doi.org/10.1177/0022219414538516">doi:10.1177/0022219414538516</a>
</p>

<hr>
<h2 id='CI_g'>Calculates a confidence interval for a standardized mean difference effect size</h2><span id='topic+CI_g'></span>

<h3>Description</h3>

<p>Calculates a confidence interval for a <code>g_mlm</code> object,
using either a central t distribution (for a symmetric interval) or a
non-central t distribution (for an asymmetric interval).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CI_g(g, cover = 0.95, bound = 35, symmetric = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CI_g_+3A_g">g</code></td>
<td>
<p>an estimated effect size object of class <code>g_mlm</code>.</p>
</td></tr>
<tr><td><code id="CI_g_+3A_cover">cover</code></td>
<td>
<p>confidence level.</p>
</td></tr>
<tr><td><code id="CI_g_+3A_bound">bound</code></td>
<td>
<p>numerical tolerance for non-centrality parameter in
<code><a href="stats.html#topic+qt">qt</a></code>.</p>
</td></tr>
<tr><td><code id="CI_g_+3A_symmetric">symmetric</code></td>
<td>
<p>If <code>TRUE</code> (the default), use a symmetric confidence
interval. If <code>FALSE</code>, use a non-central t approximation to obtain an
asymmetric confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of lower and upper confidence bounds.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(nlme)
data(Bryant2016, package = "lmeInfo")
Bryant2016_RML1 &lt;- lme(fixed = outcome ~ treatment,
                       random = ~ 1 | school/case,
                       correlation = corAR1(0, ~ session | school/case),
                       data = Bryant2016)
Bryant2016_g1 &lt;- g_mlm(Bryant2016_RML1, p_const = c(0,1), r_const = c(1,1,0,1),
                       infotype = "expected")
CI_g(Bryant2016_g1, symmetric = TRUE)
CI_g(Bryant2016_g1, symmetric = FALSE)

</code></pre>

<hr>
<h2 id='extract_varcomp'>Extract estimated variance components</h2><span id='topic+extract_varcomp'></span>

<h3>Description</h3>

<p>Extracts the estimated variance components from a fitted linear
mixed effects model (lmeStruct object) or generalized least squares model
(glsStruct object).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_varcomp(mod, separate_variances, vector)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_varcomp_+3A_mod">mod</code></td>
<td>
<p>Fitted model of class lmeStruct or glsStruct.</p>
</td></tr>
<tr><td><code id="extract_varcomp_+3A_separate_variances">separate_variances</code></td>
<td>
<p>Logical indicating whether to return the separate
level-1 variance components for each stratum if using <code>varIdent</code>
function to allow for different variances per stratum. Default is
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="extract_varcomp_+3A_vector">vector</code></td>
<td>
<p>Logical indicating whether to return the variance components as
a numeric vector. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>vector = FALSE</code>, an object of class <code>varcomp</code> consisting of a
list of estimated variance components. Models that do not include
correlation structure parameters or variance structure parameters will have
empty lists for those components. If <code>vector = TRUE</code>, a numeric vector
of estimated variance components.
</p>
<p>If <code>separate_variances = TRUE</code> and if <code>weights =
  varIdent(form = ~ 1 | Stratum)</code> is specified in the model fitting, separate
level-1 variance estimates will be returned for each stratum. If
<code>separate_variances = TRUE</code> but if the weighting structure is not
specified with <code>varIdent</code>, or if <code>separate_variances = FALSE</code>,
then no separate level-1 variance estimates will be returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(nlme)
data(Bryant2016)
Bryant2016_RML &lt;- lme(fixed = outcome ~ treatment,
                      random = ~ 1 | school/case,
                      correlation = corAR1(0, ~ session | school/case),
                      weights = varIdent(form = ~ 1 | treatment),
                      data = Bryant2016)
extract_varcomp(Bryant2016_RML, separate_variances = FALSE)
extract_varcomp(Bryant2016_RML, separate_variances = TRUE)
extract_varcomp(Bryant2016_RML, vector = TRUE)

</code></pre>

<hr>
<h2 id='Fisher_info'>Calculate expected, observed, or average Fisher information matrix</h2><span id='topic+Fisher_info'></span>

<h3>Description</h3>

<p>Calculates the expected, observed, or average Fisher information
matrix from a fitted linear mixed effects model (lmeStruct object) or
generalized least squares model (glsStruct object).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fisher_info(mod, type = "expected", separate_variances = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fisher_info_+3A_mod">mod</code></td>
<td>
<p>Fitted model of class lmeStruct or glsStruct.</p>
</td></tr>
<tr><td><code id="Fisher_info_+3A_type">type</code></td>
<td>
<p>Type of information matrix. One of <code>"expected"</code> (the
default), <code>"observed"</code>, or <code>"average"</code>.</p>
</td></tr>
<tr><td><code id="Fisher_info_+3A_separate_variances">separate_variances</code></td>
<td>
<p>Logical indicating whether to return the Fisher
information matrix for separate level-1 variance components if using
<code>varIdent</code> function to allow for different variances per stratum.
Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Information matrix corresponding to variance component parameters of
<code>mod</code>.
</p>
<p>If <code>separate_variances = TRUE</code> and if <code>weights = varIdent(form =
  ~ 1 | Stratum)</code> is specified in the model fitting, the Fisher information
matrix for separate level-1 variance estimates will be returned. If
<code>separate_variances = TRUE</code> but if the weighting structure is not
specified with <code>varIdent</code>, or if <code>separate_variances = FALSE</code>,
then the Fisher information matrix for the default variance components will
be returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(nlme)
data(Bryant2016)
Bryant2016_RML &lt;- lme(fixed = outcome ~ treatment,
                      random = ~ 1 | school/case,
                      correlation = corAR1(0, ~ session | school/case),
                      data = Bryant2016)
Fisher_info(Bryant2016_RML, type = "expected")
Fisher_info(Bryant2016_RML, type = "average")

Bryant2016_RML2 &lt;- lme(fixed = outcome ~ treatment,
                      random = ~ 1 | school/case,
                      correlation = corAR1(0, ~ session | school/case),
                      weights = varIdent(form = ~ 1 | treatment),
                      data = Bryant2016)
Fisher_info(Bryant2016_RML2, separate_variances = TRUE)

</code></pre>

<hr>
<h2 id='g_mlm'>Calculates adjusted mlm effect size</h2><span id='topic+g_mlm'></span>

<h3>Description</h3>

<p>Estimates a standardized mean difference effect size from a
fitted multi-level model, using restricted or full maximum likelihood
methods with small-sample correction, as described in Pustejovsky, Hedges,
&amp; Shadish (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>g_mlm(
  mod,
  p_const,
  mod_denom = mod,
  r_const = NULL,
  infotype = "expected",
  separate_variances = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="g_mlm_+3A_mod">mod</code></td>
<td>
<p>Fitted model of class lmeStruct (estimated using
<code>nlme::lme()</code>) or of class glsStruct (estimated using
<code>nlme::gls()</code>), from which to estimate the numerator of the effect
size.</p>
</td></tr>
<tr><td><code id="g_mlm_+3A_p_const">p_const</code></td>
<td>
<p>Vector of constants for calculating numerator of effect size.
Must be the same length as fixed effects in <code>mod</code>.</p>
</td></tr>
<tr><td><code id="g_mlm_+3A_mod_denom">mod_denom</code></td>
<td>
<p>Fitted model of class lmeStruct (estimated using
<code>nlme::lme()</code>) or of class glsStruct (estimated using
<code>nlme::gls()</code>), from which to estimate the denominator of the effect
size. If not otherwise specified, the same model will be used for the
numerator and the denominator calculations.</p>
</td></tr>
<tr><td><code id="g_mlm_+3A_r_const">r_const</code></td>
<td>
<p>Vector of constants for calculating denominator of effect
size. Must be the same length as the number of variance component
parameters in <code>mod_denom</code>.</p>
</td></tr>
<tr><td><code id="g_mlm_+3A_infotype">infotype</code></td>
<td>
<p>Type of information matrix. One of <code>"expected"</code> (the
default), <code>"observed"</code>, or <code>"average"</code>.</p>
</td></tr>
<tr><td><code id="g_mlm_+3A_separate_variances">separate_variances</code></td>
<td>
<p>Logical indicating whether to incorporate separate
level-1 variance components in the calculation of the effect size and
standard error for models with a 'varIdent()' variance structure. If
<code>TRUE</code>, make sure the <code>r_const</code> matches the parameterization of
the variance component as returned by <code>extract_varcomp(mod,
separate_variances = TRUE)</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="g_mlm_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components </p>

<table>
<tr>
 <td style="text-align: left;"> <code>p_beta</code> </td><td style="text-align: left;">
  Numerator of effect size </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>r_theta</code> </td><td style="text-align: left;"> Squared denominator of
  effect size </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>delta_AB</code> </td><td style="text-align: left;"> Unadjusted (mlm) effect size estimate
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>nu</code> </td><td style="text-align: left;"> Estimated denominator degrees of freedom </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>J_nu</code>
  </td><td style="text-align: left;"> Biased correction factor for effect size estimate </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>kappa</code>
  </td><td style="text-align: left;"> Scaled standard error of numerator </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>g_AB</code> </td><td style="text-align: left;"> Corrected
  effect size estimate </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>SE_g_AB</code> </td><td style="text-align: left;"> Approximate standard error
  estimate </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>theta</code> </td><td style="text-align: left;"> Estimated variance component parameters </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>info_inv</code> </td><td style="text-align: left;"> Inversed information matrix </td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>References</h3>

<p>Pustejovsky, J. E., Hedges, L. V., &amp; Shadish, W. R. (2014).
Design-comparable effect sizes in multiple baseline designs: A general
modeling framework. <em>Journal of Educational and Behavioral Statistics,
39</em>(4), 211-227. <a href="https://doi.org/10.3102/1076998614547577">doi:10.3102/1076998614547577</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(nlme)
data(Bryant2016, package = "lmeInfo")
Bryant2016_RML1 &lt;- lme(fixed = outcome ~ treatment,
                       random = ~ 1 | school/case,
                       correlation = corAR1(0, ~ session | school/case),
                       data = Bryant2016)
Bryant2016_g1 &lt;- g_mlm(Bryant2016_RML1, p_const = c(0,1), r_const = c(1,1,0,1),
                       infotype = "expected")
print(Bryant2016_g1)
summary(Bryant2016_g1)


Bryant2016_RML2 &lt;- lme(fixed = outcome ~ treatment,
                      random = ~ 1 | school/case,
                      correlation = corAR1(0, ~ session | school/case),
                      weights = varIdent(form = ~ 1 | treatment),
                      data = Bryant2016)
Bryant_g &lt;- g_mlm(Bryant2016_RML2, p_const = c(0,1), r_const = c(1,1,0,0,1))
Bryant_g_baseline &lt;- g_mlm(Bryant2016_RML2,
                           p_const = c(0,1),
                           r_const = c(1,1,0,1,0),
                           separate_variances = TRUE)
Bryant_g_treatment &lt;- g_mlm(Bryant2016_RML2,
                            p_const = c(0,1),
                            r_const = c(1,1,0,0,1),
                            separate_variances = TRUE)
print(Bryant_g)
print(Bryant_g_baseline)
print(Bryant_g_treatment)


</code></pre>

<hr>
<h2 id='varcomp_vcov'>Estimated sampling variance-covariance of variance component
parameters.</h2><span id='topic+varcomp_vcov'></span>

<h3>Description</h3>

<p>Estimate the sampling variance-covariance of variance component
parameters from a fitted linear mixed effects model (lmeStruct object)
or generalized least squares model (glsStruct object)
using the inverse Fisher information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcomp_vcov(mod, type = "expected", separate_variances = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcomp_vcov_+3A_mod">mod</code></td>
<td>
<p>Fitted model of class lmeStruct or glsStruct.</p>
</td></tr>
<tr><td><code id="varcomp_vcov_+3A_type">type</code></td>
<td>
<p>Type of information matrix. One of <code>"expected"</code> (the
default), <code>"observed"</code>, or <code>"average"</code>.</p>
</td></tr>
<tr><td><code id="varcomp_vcov_+3A_separate_variances">separate_variances</code></td>
<td>
<p>Logical indicating whether to return the Fisher
information matrix for separate level-1 variance components if using
<code>varIdent</code> function to allow for different variances per stratum.
Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sampling variance-covariance matrix corresponding to variance
component parameters of <code>mod</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(nlme)
data(Bryant2016)
Bryant2016_RML &lt;- lme(fixed = outcome ~ treatment,
                      random = ~ 1 | school/case,
                      correlation = corAR1(0, ~ session | school/case),
                      data = Bryant2016)
varcomp_vcov(Bryant2016_RML, type = "expected")

Bryant2016_RML2 &lt;- lme(fixed = outcome ~ treatment,
                      random = ~ 1 | school/case,
                      correlation = corAR1(0, ~ session | school/case),
                      weights = varIdent(form = ~ 1 | treatment),
                      data = Bryant2016)
varcomp_vcov(Bryant2016_RML2, separate_variances = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
