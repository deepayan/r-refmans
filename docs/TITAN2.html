<!DOCTYPE html><html><head><title>Help for package TITAN2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TITAN2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boot.titan'><p>Controls the allocation of bootstrap replicates</p></a></li>
<li><a href='#env.part'><p>Partitions environmental gradient for analysis</p></a></li>
<li><a href='#getivz'><p>Performs calculation of IndVal z scores from observed and permuted values</p></a></li>
<li><a href='#glades.env'><p>glades.env title</p></a></li>
<li><a href='#glades.taxa'><p>glades.taxa title</p></a></li>
<li><a href='#glades.titan'><p>glades.titan title</p></a></li>
<li><a href='#indval'><p>IndVal scores based on relative abundance across, and occurrence frequency</p>
within, groups</a></li>
<li><a href='#indvalp'><p>Calculate permuted IndVal scores using a group matrix</p></a></li>
<li><a href='#ivzsums'><p>Sum IndVal z scores across taxa</p></a></li>
<li><a href='#obs.summ'><p>Summarizes results from TITAN's analaysis of observed data</p></a></li>
<li><a href='#permiv'><p>Permutation of group membership for a single candidate partition</p></a></li>
<li><a href='#plot_sumz_density'><p>Plot community level change</p></a></li>
<li><a href='#plot_taxa_ridges'><p>Taxon change point ridge plots</p></a></li>
<li><a href='#plot-cps'><p>Plots probability densities of empirical distributions of bootstrapped change</p>
points</a></li>
<li><a href='#plot-sumz'><p>Plots the pattern of community change along an environmental gradient</p></a></li>
<li><a href='#plot-taxa'><p>Plots taxon-specific change points</p></a></li>
<li><a href='#smallBigBoot'><p>Summarizes raw output from TITAN's bootstrap procedure</p></a></li>
<li><a href='#sumz.tab'><p>Summarizes the results of the community-level sum(z) analysis</p></a></li>
<li><a href='#tboot'><p>Calculate bootstrapped IndVal z scores</p></a></li>
<li><a href='#titan'><p>Perform a threshold indicator taxa analysis</p></a></li>
<li><a href='#TITAN2'><p>Threshold Indicator Taxa Analysis</p></a></li>
<li><a href='#txa.screen'><p>Screening of site by taxa matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Threshold Indicator Taxa Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.4.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Uses indicator species scores across binary partitions of
  a sample set to detect congruence in taxon-specific changes of abundance
  and occurrence frequency along an environmental gradient as evidence of
  an ecological community threshold.  Relevant references include Baker and King 
  (2010) &lt;<a href="https://doi.org/10.1111%2Fj.2041-210X.2009.00007.x">doi:10.1111/j.2041-210X.2009.00007.x</a>&gt;, King and Baker (2010) 
  &lt;<a href="https://doi.org/10.1899%2F09-144.1">doi:10.1899/09-144.1</a>&gt;, and Baker and King (2013) &lt;<a href="https://doi.org/10.1899%2F12-142.1">doi:10.1899/12-142.1</a>&gt;.</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, dplyr, ggplot2, glue, cowplot, ggridges, purrr,
tibble, cli</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-14 21:07:26 UTC; david_kahle</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew E. Baker <a href="https://orcid.org/0000-0001-5069-0204"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Ryan S. King <a href="https://orcid.org/0000-0002-3159-9816"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  David Kahle <a href="https://orcid.org/0000-0002-9999-1558"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Kahle &lt;david@kahle.io&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-14 22:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='boot.titan'>Controls the allocation of bootstrap replicates</h2><span id='topic+boot.titan'></span>

<h3>Description</h3>

<p>A wrapper function for controlling the implementation of bootstrap replicates
using the function 'tboot' by sequential or parallel processing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot.titan(
  env,
  taxa,
  ivTot = ivTot,
  boot = boot,
  ncpus = ncpus,
  nBoot = nBoot,
  minSplt = minSplt,
  nPerm = 250,
  memory = memory,
  imax = imax,
  numUnit = numUnit
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot.titan_+3A_env">env</code></td>
<td>
<p>A vector of values for each sampling location along the
environmental gradient.</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_taxa">taxa</code></td>
<td>
<p>A site-by-taxon matrix of taxa counts at each sampling location.</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_ivtot">ivTot</code></td>
<td>
<p>A logical indicating whether IndVal scores should be calculated
using total relative abundance or the mean relative abundace originally
proposed by Dufrene and Legendre (1997). The default is to pass on the
argument from the original TITAN funtion call.</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_boot">boot</code></td>
<td>
<p>A logical specifying whether or not to implement TITAN's'
boostrap procedure. The default is to use the value specified in the
original TITAN function call.</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_ncpus">ncpus</code></td>
<td>
<p>An argument specifying the number of processing cores used by
the TITAN function call.  If ncpus&gt;1 then parallel processing is
implemented.  The default is to use the value specified in the original
TITAN function call.</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_nboot">nBoot</code></td>
<td>
<p>An argument specifying the number of bootstrap replicates.  The
default is to use the value specified in the original TITAN function call.</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_minsplt">minSplt</code></td>
<td>
<p>An argument specifying minimum split size for partitioning
along the environmental gradient.  The default is to use the value
specified in the original TITAN function call.</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_nperm">nPerm</code></td>
<td>
<p>The number of replicates used by the permutation procedure (not
to be confused with the number of bootstrap replicates).</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_memory">memory</code></td>
<td>
<p>A logical indicating whether scratch files should be used to
store temporary data in order to conserve active memory during
bootstrapping of large data sets.  The default is to pass on the argument
from the original TITAN funtion call.</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_imax">imax</code></td>
<td>
<p>A logical indicating whether taxon-specific change points should
be determined by IndVal maxima or z-score maxima (as in TITAN v1.0). The
default is to pass on the argument from the original TITAN funtion call.</p>
</td></tr>
<tr><td><code id="boot.titan_+3A_numunit">numUnit</code></td>
<td>
<p>An argument specifying the number of values along the
environmental gradient.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If 'ncpus'&gt;1 evaluates to TRUE, the function employs the package 'snow' to
implement parallel processing on multicore processors common in modern
desktop computers.  With some minor modification it is possible to configure
this code to allocate processes to cores on a high-performance computing
cluster (i.e., a supercomputer).  If 'ncpus'&gt;1 evaluates to FALSE, the
function uses 'lapply' to run 'tboot' in sequence 1:nBoot times.
</p>


<h3>Value</h3>

<p>A list of two items: </p>

<dl>
<dt>bSeq</dt><dd><p>An index of the sequence of bootstrap replicates. The structure
of bSeq will differ for sequential or parallel processing.</p>
</dd>
<dt>ivz.bt.list</dt><dd><p>Itself a list of four items comprising output passed on
from function <code><a href="#topic+tboot">tboot()</a></code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds. Methods in
Ecology and Evolution 1(1): 25:37.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tboot">tboot()</a></code>, <code><a href="#topic+small.boot">small.boot()</a></code>, <code><a href="#topic+big.boot">big.boot()</a></code>, <code><a href="#topic+titan">titan()</a></code>
</p>

<hr>
<h2 id='env.part'>Partitions environmental gradient for analysis</h2><span id='topic+env.part'></span>

<h3>Description</h3>

<p>This function compares the number of records in the environmental vector and
the umber of rows in the taxa matrix to ensure they are compatible.  It then
uses the rank order of environmental values at each sampling location to
determine group membership of all sampling sites at each level of
partitioning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>env.part(env, taxa, minSplt = minSplt, messaging = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="env.part_+3A_env">env</code></td>
<td>
<p>A vector of values for each sampling location along the
environmental gradient.</p>
</td></tr>
<tr><td><code id="env.part_+3A_taxa">taxa</code></td>
<td>
<p>A site by taxon matrix containing observed counts at each
sampling location.</p>
</td></tr>
<tr><td><code id="env.part_+3A_minsplt">minSplt</code></td>
<td>
<p>The  minimum split size used in binary partitioning.  The
default is to use the argument from the original TITAN function call.</p>
</td></tr>
<tr><td><code id="env.part_+3A_messaging">messaging</code></td>
<td>
<p>message user?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of seven objects: </p>

<dl>
<dt>env</dt><dd><p>an environmental vector</p>
</dd>
<dt>numUnit</dt><dd><p>the number of sample units in env</p>
</dd>
<dt>numTxa</dt><dd><p>the number of distinct taxonomic units in taxa</p>
</dd>
<dt>numClass</dt><dd><p>the number of candidate partitions (numUnit-2*minSplt)</p>
</dd>
<dt>srtEnv</dt><dd><p>a sorted version of the environmental vector</p>
</dd>
<dt>envcls</dt><dd><p>a vector of environmental values used to distinguish
partitions</p>
</dd>
<dt>eclass</dt><dd><p>a matrix of group membership relative to each partition in
envcls</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>

<hr>
<h2 id='getivz'>Performs calculation of IndVal z scores from observed and permuted values</h2><span id='topic+getivz'></span>

<h3>Description</h3>

<p>A wrapper function that calls 'indval' or 'indvals' to obtain observed IndVal
scores and 'permiv' to generate permuted values, then calculates z scores and
associated p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getivz(
  clss,
  spp,
  ivTot = ivTot,
  nPerm = nPerm,
  numClass = numClass,
  imax = imax,
  messaging = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getivz_+3A_clss">clss</code></td>
<td>
<p>A matrix of binary (0,1) group membership based on partitions of
sampling sites ranked along an environmental gradient.</p>
</td></tr>
<tr><td><code id="getivz_+3A_spp">spp</code></td>
<td>
<p>A site-by-taxon matrix of taxa counts at each sampling location.</p>
</td></tr>
<tr><td><code id="getivz_+3A_ivtot">ivTot</code></td>
<td>
<p>A logical indicating whether IndVal scores should be calculated
using total relative abundance or the mean relative abundace originally
proposed by Dufrene and Legendre (1997).</p>
</td></tr>
<tr><td><code id="getivz_+3A_nperm">nPerm</code></td>
<td>
<p>The number of permutations to be used by 'permiv'.</p>
</td></tr>
<tr><td><code id="getivz_+3A_numclass">numClass</code></td>
<td>
<p>The number of classes used to partition samples along the
enviorinmental gradient. The default is the total number of observations
less two times the minimum split size ('minSplt').</p>
</td></tr>
<tr><td><code id="getivz_+3A_imax">imax</code></td>
<td>
<p>A logical indicating whether taxon-specific change points should
be determined using IndVal maxima or z-score maxima (as in TITAN v1.0).</p>
</td></tr>
<tr><td><code id="getivz_+3A_messaging">messaging</code></td>
<td>
<p>message user?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls two subfunctions to first calculate IndVals and their
associated direction (i.e., a decreasing taxon, group 1, is associated with
the left side of any partition, whereas an increasing taxon, group 2, is
associated with the right) and second to develop permuted values for each
candidate partition. Output includes the indicator direction (1 or 2), z
scores, IndVal scores, and associated p value (obtained by the fraction of
times an observed IndVal is greater than those obtained from numPerm
randomizations of equivalent group sizes).  For more detail regarding the
relative benefits and potential drawbacks of using imax=T or imax=F, see
Baker and King (2013).
</p>


<h3>Value</h3>

<p>A matrix containing four submatrices (the first from
<code>[1:numTxa,]</code>, the second from <code>[(numTxa+1):(2*numTxa),]</code>, etc.),
the first two of which include indicator direction and z scores.
</p>

<dl>
<dt>Group Membership </dt><dd><p>A vector for every taxon showing decreasing
(<code>1</code>) or increasing (<code>2</code>) group membership at each value of
'envcls'</p>
</dd>
<dt>z scores </dt><dd><p>A vector for every taxon showing IndVal z scores at each
value of 'envcls'</p>
</dd>
<dt>IndVals </dt><dd><p>A vector for every taxon showing IndVal scores at each
value of 'envcls'</p>
</dd>
<dt>p values </dt><dd><p>A vector for every taxon showing IndVal p values at each
value of 'envcls'</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds. Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>Baker ME and RS King. 2013. Of TITAN and straw men: an appeal for
greater understanding of community data. Freshwater Science 32(2):489-506.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+indval">indval()</a></code>, <code><a href="#topic+indvals">indvals()</a></code>, <code><a href="#topic+indvalp">indvalp()</a></code>, <code><a href="#topic+indvalps">indvalps()</a></code>, <code><a href="#topic+permiv">permiv()</a></code>,
<code><a href="#topic+ivzsums">ivzsums()</a></code>
</p>

<hr>
<h2 id='glades.env'>glades.env title</h2><span id='topic+glades.env'></span>

<h3>Description</h3>

<p>glades.env description
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>

<hr>
<h2 id='glades.taxa'>glades.taxa title</h2><span id='topic+glades.taxa'></span>

<h3>Description</h3>

<p>glades.taxa description
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>

<hr>
<h2 id='glades.titan'>glades.titan title</h2><span id='topic+glades.titan'></span>

<h3>Description</h3>

<p>glades.titan description
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>

<hr>
<h2 id='indval'>IndVal scores based on relative abundance across, and occurrence frequency
within, groups</h2><span id='topic+indval'></span><span id='topic+indvals'></span>

<h3>Description</h3>

<p>Calculates indicator value scores using the original method of Dufrene and
Legendre (1997) for all taxa in a site-by-taxon matrix split into two groups
along an environmental gradient. A modified version (indvals) calculates
indicator value scores using a modification of Dufrene and Legendre (1997),
whereby relative abundance is computed as total relative abundance across
groups rather than as mean relative abundance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indval(grp, spp, allscores = FALSE)

indvals(grp, spp, allscores = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indval_+3A_grp">grp</code></td>
<td>
<p>A binary vector (0,1) indicating group membership for partitioning
of rows in 'spp' according to a ranks of an environmental variable.</p>
</td></tr>
<tr><td><code id="indval_+3A_spp">spp</code></td>
<td>
<p>A site-by-taxon matrix of taxa counts at each sampling location.</p>
</td></tr>
<tr><td><code id="indval_+3A_allscores">allscores</code></td>
<td>
<p>A logical indicating whether the list of scores returned by
the function should be truncated.  The default is to return just the
largest IndVal (of two, one for each side of the partition) and on which
side of the partition the score occurs. If allscores is TRUE, IndVals on
both sides of the partition, as well as their relative abundances are also
returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The modified version of the original IndVal method was developed to address
potential for bias in change point identification for highly skewed samples.
This and the function 'indvalps' are run when the argument 'ivTot' in the
original TITAN function call is set to TRUE.  The function 'indval' is
expected to be used more frequently, and 'indvals' is provided largely for
comparative purposes.
</p>


<h3>Value</h3>

<p>A 2-column matrix with the same nrow as the matrix 'spp'. The first
column consists of a 1 (left) or 2 (right) for each taxon indicating on
which group produced the largest IndVal score, and the second column
contains the actual IndVal score.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Dufrene, M. and P. Legendre. 1997. Species assemblages and
indicator species: the need for a flexible asymmetrical approach.
Ecological Monographs 67:345-366.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+indvalp">indvalp()</a></code>, <code><a href="#topic+indvalps">indvalps()</a></code>, <code><a href="#topic+getivz">getivz()</a></code>
</p>

<hr>
<h2 id='indvalp'>Calculate permuted IndVal scores using a group matrix</h2><span id='topic+indvalp'></span><span id='topic+indvalps'></span>

<h3>Description</h3>

<p>This function performs the same calculations as 'indval' or 'indvals', but
does so using matrix operations on a set of binary group assignments in
matrix form. Function 'indvalps' calculates indicator value scores using a
modification of Dufrene and Legendre (1997), whereby relative abundance is
computed as total relative abundance across groups rather than as mean
relative abundance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indvalp(grpMatrix, spp)

indvalps(grpMatrix, spp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indvalp_+3A_grpmatrix">grpMatrix</code></td>
<td>
<p>A site-by-permutation matrix of binary (0,1) assignments
indicating group membership for successive randomizations of rows of 'spp'
according to a ranks of an environmental variable.</p>
</td></tr>
<tr><td><code id="indvalp_+3A_spp">spp</code></td>
<td>
<p>A site-by-taxon matrix of taxa counts at each sampling location.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Although the 'indval' function is reasonably efficient for a single
calculation, when repeated during permutations (default = 250) and again
during for each bootstrap replicate (default = 500), small differences in
processing time can quickly become unwieldy. Even with the matrix operation,
the permutation accounts for &gt; 3/4 of processing time for most data sets (due
to the fact that it is repeated for each bootstrap replicate).
</p>
<p>The output matrix does not include information about the group membership of
indval maxima because this information is not used in the permutation
procedure (i.e., only the distribution of IndVal magnitudes is relevant).
</p>
<p>Modification of the original IndVal method was developed to address potential
for bias in change point identification for highly skewed samples. This and
the function 'indvals' are run when the argument 'ivTot' in the original
TITAN function call is TRUE.  It is expected that 'indval' and 'indvalp' will
be used more commonly.
</p>


<h3>Value</h3>

<p>A matrix (ivmax) of IndVal maxima across each partition with nrow
equal to the number of permutations and ncol equal to the number of taxa in
'spp'.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Dufrene, M. and P. Legendre. 1997. Species assemblages and
indicator species: the need for a flexible asymmetrical approach. Ecol.
Mon. 67:345-366.
</p>
<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds. Methods in
Ecology and Evolution 1(1): 25:37.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+indval">indval()</a></code>, <code><a href="#topic+indvals">indvals()</a></code>, <code><a href="#topic+getivz">getivz()</a></code>
</p>

<hr>
<h2 id='ivzsums'>Sum IndVal z scores across taxa</h2><span id='topic+ivzsums'></span><span id='topic+ivzsums.f'></span>

<h3>Description</h3>

<p>This function uses the output of 'getivz' (and, optionally, similar output
from the bootstrap procedure) to sum z scores across taxa associated with
each indicator direction (- or +) at each level of the environmental
gradient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivzsums(allivz)

ivzsums.f(allivz, sppmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ivzsums_+3A_allivz">allivz</code></td>
<td>
<p>The output matrix from the function 'getivz' that contains four
submatrices, the first two of which include indicator direction and z
scores.</p>
</td></tr>
<tr><td><code id="ivzsums_+3A_sppmax">sppmax</code></td>
<td>
<p>A completed summary output table for all taxa, used to
ascertain which taxa should be filtered and which retained.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function selects taxa identified as either increasing or decreasing at
each level of the environmental gradient and combines their IndVal z scores
to generate an assemblage-wide sum.  The sum(z) scores are interpreted as the
magnitude of community change at each level of the environmental gradient.
</p>
<p>The alias 'ivzsums.f' uses the output of 'getivz' to sum z scores across taxa
filtered by purity and reliability associated with each indicator direction
(- or +) at each level of the environmental gradient.  Filters are provided
by the final column (&quot;filter&quot;) in the 'sppmax' table that is part of each
TITAN object and an argument for 'ivzsums.f'.  All taxa with a value of
either 1 or 2 are pure and reliable decreasers or increasers, respectively,
and are selected for summation.  Filtered sums are used by the 'plot.sumz'
function to create estimates of robust community change more precise than the
original unfiltered sum(z) in TITAN v1.0.
</p>


<h3>Value</h3>

<p>A matrix of two (z- and z+) parallel vectors with length (nrow) equal
to the number of candidate partitions of an environmental gradient.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds. Methods in
Ecology and Evolution 1(1): 25:37.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getivz">getivz()</a></code>, <code><a href="#topic+plot_sumz">plot_sumz()</a></code>
</p>

<hr>
<h2 id='obs.summ'>Summarizes results from TITAN's analaysis of observed data</h2><span id='topic+obs.summ'></span>

<h3>Description</h3>

<p>This function populates the first seven columns of the 'sppmax' output table
with results summarized for each taxon from the output of 'getivz'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obs.summ(ivzScores, taxa, srtEnv, minSplt = minSplt, imax = imax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="obs.summ_+3A_ivzscores">ivzScores</code></td>
<td>
<p>The product of the 'getivz' function.  A data matrix
comprised of four submatrices including group membership, z scores,
IndVals, and p values.</p>
</td></tr>
<tr><td><code id="obs.summ_+3A_taxa">taxa</code></td>
<td>
<p>A site by taxon matrix with counts observed at each sampling
location.</p>
</td></tr>
<tr><td><code id="obs.summ_+3A_srtenv">srtEnv</code></td>
<td>
<p>A sorted version of the environmental gradient.</p>
</td></tr>
<tr><td><code id="obs.summ_+3A_minsplt">minSplt</code></td>
<td>
<p>The minimum split size used to determine partitions along the
environmental gradient.  The defualt is to use the argument from the
original TITAN function call.</p>
</td></tr>
<tr><td><code id="obs.summ_+3A_imax">imax</code></td>
<td>
<p>A logical indicating whether taxon-specific change points should
be determined using IndVal maxima or z-score maxima (as in TITAN v1.0).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The items summarized for each taxon include (1) the env value at the IndVal
maximum, (2) the env value at the z-score maximum, (3) the taxon's occurrence
frequency, (4) group membership (decreaser or increaser), (5) the observed
IndVal score, (6) the probability that the taxon's IndVal score could be
generated by random chance, (7) the z score. As the values 3-7 are computed
for every taxon at each candidate change point, values for the table are
determined by the maximum (IndVal or z score) indicated by the value of
'imax'.  For further detail regarding the advantages and disadvantages of
using imax=T or imax=F, see Baker and King (2013).
</p>


<h3>Value</h3>

<p>The function output consists of a list of three objects: </p>

<dl>
<dt>obs1</dt><dd><p>a logical indicating decreasing taxa</p>
</dd>
<dt>obs2</dt><dd><p>a logical indicating increasing taxa</p>
</dd>
<dt>sppmax</dt><dd><p>a partially completed summary output table for all taxa</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>Baker ME and RS King. 2013. Of TITAN and straw men: an appeal for
greater understanding of community data. Freshwater Science 32(2):489-506.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getivz">getivz()</a></code>, <code><a href="#topic+titan">titan()</a></code>
</p>

<hr>
<h2 id='permiv'>Permutation of group membership for a single candidate partition</h2><span id='topic+permiv'></span>

<h3>Description</h3>

<p>Randomizes group assignments for all permutations based on ranked values of
the environmental gradient, then calls the appropriate matrix-based IndVal
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permiv(grp, spp, ivTot = ivTot, nPerm = 250)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permiv_+3A_grp">grp</code></td>
<td>
<p>A vector of binary (0,1) assignments indicating group membership
for a single partition of nrows in 'spp' according to a ranks of an
environmental variable.</p>
</td></tr>
<tr><td><code id="permiv_+3A_spp">spp</code></td>
<td>
<p>A site-by-taxon matrix of taxa counts at each sampling location.</p>
</td></tr>
<tr><td><code id="permiv_+3A_ivtot">ivTot</code></td>
<td>
<p>A logical indicating whether IndVal scores should be calculated
using total relative abundance or the mean relative abundace originally
proposed by Dufrene and Legendre (1997).</p>
</td></tr>
<tr><td><code id="permiv_+3A_nperm">nPerm</code></td>
<td>
<p>The number of permutations to be performed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function handles the randomization portion of the permutation procedure,
and then serves as a wrapper for 'indvalp' and 'indvalps' (depending on the
value of 'ivTot'), which estimate change-point distributions across all
permutations.  The output is the same as 'indvalp' and 'indvalps' because the
function simply passes their products on.
</p>


<h3>Value</h3>

<p>A matrix (ivmax) of IndVal maxima with nrow equal to the number of
permutations and ncol equal to the number of taxa in 'spp'.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Dufrene, M. and P. Legendre. 1997. Species assemblages and
indicator species: the need for a flexible asymmetrical approach. Ecol.
Mon. 67:345-366.
</p>
<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds. Methods in
Ecology and Evolution 1(1): 25:37.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+indvalp">indvalp()</a></code>, <code><a href="#topic+indvalps">indvalps()</a></code>, <code><a href="#topic+getivz">getivz()</a></code>
</p>

<hr>
<h2 id='plot_sumz_density'>Plot community level change</h2><span id='topic+plot_sumz_density'></span>

<h3>Description</h3>

<p>Plot community level change
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sumz_density(
  titan.out,
  filter = TRUE,
  sumz = TRUE,
  points = FALSE,
  ribbon = TRUE,
  density = TRUE,
  change_points = TRUE,
  sumz1 = TRUE,
  sumz2 = TRUE,
  xlim = c(min(titan.out$env), max(titan.out$envcls)),
  xlabel = "Environmental Gradient",
  y1label = NULL,
  y2label = "Density",
  alpha1 = 0.65,
  alpha2 = 0.5,
  col1 = "steelblue4",
  col2 = "red",
  trans = "identity",
  legend.position = c(0.9, 0.9),
  ...,
  axis.text.x,
  axis.text.y,
  axis.title.x,
  axis.title.y
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_sumz_density_+3A_titan.out">titan.out</code></td>
<td>
<p>A TITAN output object.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_filter">filter</code></td>
<td>
<p>A logical indicating whether only pure and reliable taxa should
be used to create the plot.This is the recommended as a check of the
unfiltered default to assess whether impure or unreliable taxa are
substantially contributing to the distribution of sum(z) scores.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_sumz">sumz</code></td>
<td>
<p>Plot sum z values? (Default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_points">points</code></td>
<td>
<p>Plot points on sum z values? (Default = <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_ribbon">ribbon</code></td>
<td>
<p>Fill in axes under sum z values?  (Default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_density">density</code></td>
<td>
<p>Plot densities of change points?  (Default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_change_points">change_points</code></td>
<td>
<p>Plot ranges of change points? These are taken from the
titan object. (Default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_sumz1">sumz1</code></td>
<td>
<p>A logical specifying whether decreasing changes should be
plotted.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_sumz2">sumz2</code></td>
<td>
<p>A logical specifying whether increasing changes should be
plotted.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_xlim">xlim</code></td>
<td>
<p>x axis limits, e.g. <code>xlim = c(0,10)</code>.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_xlabel">xlabel</code></td>
<td>
<p>A character string for the x axis label.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_y1label">y1label</code></td>
<td>
<p>A character specifying the label of the second y axis</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_y2label">y2label</code></td>
<td>
<p>A character specifying the label of the second y axis</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_alpha1">alpha1</code>, <code id="plot_sumz_density_+3A_alpha2">alpha2</code></td>
<td>
<p>Transparency of Z- and Z+ values, respectively.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_col1">col1</code></td>
<td>
<p>A graphical argument specifying the color of group 1 symbols.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_col2">col2</code></td>
<td>
<p>A graphical argument specifying the color of group 2 symbols.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_trans">trans</code></td>
<td>
<p>a scale transformation to be applied to the x-axis through
ggplot2. e.g. <code>"log10"</code> or <code>"sqrt"</code>.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_legend.position">legend.position</code></td>
<td>
<p>ggplot2 legend position in relative coordinates of sum
z plot. (Default = <code>c(.9, .9)</code>)</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_...">...</code></td>
<td>
<p>An argument for passing generic plotting function parameters.</p>
</td></tr>
<tr><td><code id="plot_sumz_density_+3A_axis.text.x">axis.text.x</code>, <code id="plot_sumz_density_+3A_axis.text.y">axis.text.y</code>, <code id="plot_sumz_density_+3A_axis.title.x">axis.title.x</code>, <code id="plot_sumz_density_+3A_axis.title.y">axis.title.y</code></td>
<td>
<p>Font sizes of
respective axis text. Passed as the size argument to the ggplot2 thematic
elements of the same name. Defaults to current default ggplot2 theme.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot
</p>


<h3>Note</h3>

<p>Should not be used with output objects from TITAN v1.0.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>King, RS and ME Baker  2010. Considerations for identifying and
interpreting ecological community thresholds. Journal of the North American
Benthological Association 29(3):998-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_sumz">plot_sumz()</a></code>, <code><a href="#topic+plot_cps">plot_cps()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(glades.titan)

plot_sumz_density(glades.titan)
plot_sumz_density(glades.titan, trans = "log10")



</code></pre>

<hr>
<h2 id='plot_taxa_ridges'>Taxon change point ridge plots</h2><span id='topic+plot_taxa_ridges'></span>

<h3>Description</h3>

<p>Taxon change point ridge plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_taxa_ridges(
  titan.out,
  z1 = TRUE,
  z2 = TRUE,
  z1_fill_low = "lightblue",
  z1_fill_high = "black",
  z2_fill_low = "pink",
  z2_fill_high = "red",
  xlabel = "Environmental Gradient",
  n_ytaxa = 90,
  printspp = FALSE,
  grid = TRUE,
  d_lines = FALSE,
  trans = "identity",
  xaxis = !grid,
  xlim,
  breaks = ggplot2::waiver(),
  bw,
  rel_heights,
  ...,
  axis.text.x,
  axis.text.y,
  axis.title.x,
  axis.title.y
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_taxa_ridges_+3A_titan.out">titan.out</code></td>
<td>
<p>A TITAN output object.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_z1">z1</code></td>
<td>
<p>A logical specifying whether decreasing taxa should be plotted.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_z2">z2</code></td>
<td>
<p>A logical specifying whether increasing taxa should be plotted.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_z1_fill_low">z1_fill_low</code>, <code id="plot_taxa_ridges_+3A_z1_fill_high">z1_fill_high</code>, <code id="plot_taxa_ridges_+3A_z2_fill_low">z2_fill_low</code>, <code id="plot_taxa_ridges_+3A_z2_fill_high">z2_fill_high</code></td>
<td>
<p>Respective fill
colors passed to <code><a href="ggplot2.html#topic+scale_fill_gradient">scale_fill_gradient()</a></code></p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_xlabel">xlabel</code></td>
<td>
<p>A character string for the x axis label.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_n_ytaxa">n_ytaxa</code></td>
<td>
<p>The maximum number of taxa to be plotted.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_printspp">printspp</code></td>
<td>
<p>A logical specifying whether the sppmax table should be
printed.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_grid">grid</code></td>
<td>
<p>The <code>grid</code> argument of <code><a href="ggridges.html#topic+theme_ridges">theme_ridges()</a></code>. Setting this to
<code>FALSE</code> removes horizontal lines from the plot, see examples.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_d_lines">d_lines</code></td>
<td>
<p>Argument to pass to <code><a href="ggridges.html#topic+geom_density_ridges">geom_density_ridges()</a></code>.
Short for density lines, a logical determining whether the median change
point values from estimated from each taxon's density function, is plotted.
If <code>TRUE</code>, a dashed, black vertical line will be plotted.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_trans">trans</code></td>
<td>
<p>a scale transformation to be applied to the x-axis through
ggplot2. e.g. <code>"log10"</code> or <code>"sqrt"</code>.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_xaxis">xaxis</code></td>
<td>
<p>Logical; should the x-axis be plotted?</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_xlim">xlim</code></td>
<td>
<p>x axis limits, e.g. <code>xlim = c(0,10)</code>.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_breaks">breaks</code></td>
<td>
<p>Argument to pass to <code><a href="ggridges.html#topic+geom_density_ridges">geom_density_ridges()</a></code>.
Determines values and labels of breaks (ticks) on the x-axis.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_bw">bw</code></td>
<td>
<p>The bandwidth of used in the kernel density estimate; see
<code><a href="stats.html#topic+density">density()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_rel_heights">rel_heights</code></td>
<td>
<p>Argument to pass to <code><a href="cowplot.html#topic+plot_grid">cowplot::plot_grid()</a></code> as an override
for the defaults</p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_...">...</code></td>
<td>
<p>Arguments to pass to <code><a href="ggridges.html#topic+geom_density_ridges">geom_density_ridges()</a></code></p>
</td></tr>
<tr><td><code id="plot_taxa_ridges_+3A_axis.text.x">axis.text.x</code>, <code id="plot_taxa_ridges_+3A_axis.text.y">axis.text.y</code>, <code id="plot_taxa_ridges_+3A_axis.title.x">axis.title.x</code>, <code id="plot_taxa_ridges_+3A_axis.title.y">axis.title.y</code></td>
<td>
<p>Font sizes of
respective axis text. Passed as the size argument to the ggplot2 thematic
elements of the same name. Defaults to current default ggplot2 theme.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of decreasing and/or increasing taxon-specific change points
along the environmental gradient.
</p>


<h3>Note</h3>

<p>Should not be used with output objects from TITAN v1.0.
</p>


<h3>Author(s)</h3>

<p>M. Baker, R. King, D. Kahle
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>King, RS and ME Baker  2010. Considerations for identifying and
interpreting ecological community thresholds. Journal of the North American
Benthological Association 29(3):998-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_sumz">plot_sumz()</a></code>, <code><a href="#topic+plot_cps">plot_cps()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(glades.titan)


# basic usage
plot_taxa_ridges(glades.titan)


## Not run:  reduce R CMD check time

# manipulating the x axis thematic components
plot_taxa_ridges(glades.titan, grid = FALSE)
plot_taxa_ridges(glades.titan, xaxis = TRUE)


# applying scale transformations
plot_taxa_ridges(glades.titan, trans = "log10", xlim = c(1,150))


# removing z2
plot_taxa_ridges(glades.titan, z2 = FALSE, trans = "sqrt", xlim = c(0, 150))


# more styling
plot_taxa_ridges(glades.titan,
  axis.text.x = 12,
  axis.text.y = 4,
  axis.title.x = 14,
  xlabel = expression(paste("Surface water total phosphorus ("*mu*"g/l)"))
)


## End(Not run)



</code></pre>

<hr>
<h2 id='plot-cps'>Plots probability densities of empirical distributions of bootstrapped change
points</h2><span id='topic+plot-cps'></span><span id='topic+plot_cps'></span><span id='topic+plotCPs'></span>

<h3>Description</h3>

<p>This function allows more detailed exploration of taxon-specific response
documented by TITAN through analysis of empirical distributions of
bootstrapped change points, comparison of those distributions with observed
counts, and aggregate (optionally weighted) summaries of those distributions
across taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cps(
  titan.out,
  taxa.dist = T,
  z.weights = T,
  taxaID = NULL,
  cp.med = F,
  cp.trace = F,
  cp.hist = T,
  stacked = F,
  xlabel = "Environmental Gradient",
  xmin = min(titan.out$env),
  xmax = max(titan.out$envcls) * 1.25,
  tck = 0.025,
  bty = "u",
  ntick = 6,
  cex = 1.75,
  cex.axis = 1.75,
  cex.leg = 1.5,
  cex.lab = 1.75,
  write = F,
  leg.x = 0.8,
  leg.y = 0.8,
  leg = TRUE,
  ...
)

plotCPs(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-cps_+3A_titan.out">titan.out</code></td>
<td>
<p>A TITAN output object.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_taxa.dist">taxa.dist</code></td>
<td>
<p>A logical specifying whether taxon-specific distributions
should be plotted.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_z.weights">z.weights</code></td>
<td>
<p>A logical specifying whether taxon-specific or aggregate
community distributions should be weighted by their median z scores (median
of z-score maxima values across bootstrap replicates).</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_taxaid">taxaID</code></td>
<td>
<p>An index specifying whether a particular taxon should be
targeted for plotting. A 'NULL' value indicates all taxa should be plotted.
Values &gt;0 will select pure and reliabile taxa by their row number within
the 'sppmax' output table. Character strings may also be used corresponding
to the row name within the 'sppmax' output table.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_cp.med">cp.med</code></td>
<td>
<p>A logical specifying whether change point locations should be
plotted using the median value across all bootstrap replicates instead of
the observed value.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_cp.trace">cp.trace</code></td>
<td>
<p>A logical specifying whether IndVals and z scores across all
candidate change points should be plotted.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_cp.hist">cp.hist</code></td>
<td>
<p>A logical specifying whether histograms of replicate change
point PDFs should be plotted.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_stacked">stacked</code></td>
<td>
<p>A logical specifying whether community level aggregations of
change point PDFs are stacked or plotted separately.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_xlabel">xlabel</code></td>
<td>
<p>A character string for the x axis label.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_xmin">xmin</code></td>
<td>
<p>A graphical argument specifying the value of the x axis minimum.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_xmax">xmax</code></td>
<td>
<p>A graphical argument specifying the value of the x axis maximum.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_tck">tck</code></td>
<td>
<p>A graphical argument specifying the scale of axis tick marks.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_bty">bty</code></td>
<td>
<p>A graphical argument.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_ntick">ntick</code></td>
<td>
<p>A graphical argument specifying the default number of axis tick
marks.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_cex">cex</code></td>
<td>
<p>A graphical argument specifying the scaling of the figure.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_cex.axis">cex.axis</code></td>
<td>
<p>A graphical argument specifying the scaling of the axes.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_cex.leg">cex.leg</code></td>
<td>
<p>A graphical argument specifying the scaling of the legend.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_cex.lab">cex.lab</code></td>
<td>
<p>A graphical argument specifying the scaling of the lables.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_write">write</code></td>
<td>
<p>A logical specifying whether taxa subsets are written to screen.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_leg.x">leg.x</code></td>
<td>
<p>A graphical argument specifying the x coordinate of the legend.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_leg.y">leg.y</code></td>
<td>
<p>A graphical argument specifying the y coordinate of the legend.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_leg">leg</code></td>
<td>
<p>A logical specifying whether or not to plot the legend.</p>
</td></tr>
<tr><td><code id="plot-cps_+3A_...">...</code></td>
<td>
<p>An argument for passing generic plotting function parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Following the intitial (v1.0) TITAN publications, it was clear that
substantial information regarding taxon-specific change points was lost when
bootstrapped distributions were represented solely as quantiles (i.e., as in
<code><a href="#topic+plot_taxa">plot_taxa()</a></code> and the 'sppmax' output table).  Empirical probability densities
allow greater detail and more nuanced interpretation associated with this
uncertainty, especially when compared against observed abundance and
occurrence.  Further, comparison of the summed probability densities and the
filtered sum(z) plots with the default sum(z) output provides additional
support of community changes consistent with threshold behavior.
</p>


<h3>Value</h3>

<p>Three types of plots are possible outcomes of this function.  The
first (taxa.dist=T, taxID=NULL) is a matrix of histograms showing empirical
distributions of bootstrapped change-point locations (as probability
densities) for all pure and reliable taxa.  The value of the probability
densities can be weighted by the median z score for each taxon
(z.weights=T). The second plot (taxa.dist=T, taxID&gt;0 or a taxon label)
overlays a taxon-specific histogram on an abundance scatter plot and the
observed change-point location.  The third plot (taxa.dist=F) shows the sum
of probability densities across all pure and reliable taxa, optionally
weighted by median z scores (z.weights=T) or stacked (stacked=T).
</p>


<h3>Note</h3>

<p>Should not be used with output objects from TITAN v1.0.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>King, RS and ME Baker  2010. Considerations for identifying and
interpreting ecological community thresholds. Journal of the North American
Benthological Association 29(3):998-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_taxa">plot_taxa()</a></code>, <code><a href="#topic+plot_sumz">plot_sumz()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(glades.titan)
plot_cps(glades.titan,
  taxa.dist = FALSE,
  xlabel = "Surface Water TP (ug/l)",
  stacked = TRUE
)

</code></pre>

<hr>
<h2 id='plot-sumz'>Plots the pattern of community change along an environmental gradient</h2><span id='topic+plot-sumz'></span><span id='topic+plot_sumz'></span><span id='topic+plotSumz'></span>

<h3>Description</h3>

<p>Creates a plot of community-level sums of taxon-specific change along an
environmental gradient and optionally conveys uncertainty associated with the
maximum community change derived from decreasers or increasers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sumz(
  titan.out,
  filter = FALSE,
  cumfrq = TRUE,
  bootz1 = TRUE,
  bootz2 = TRUE,
  sumz1 = TRUE,
  sumz2 = TRUE,
  xmin = min(titan.out$env),
  xmax = max(titan.out$envcls) * 1.25,
  xlabel = "Environmental Gradient",
  y1label = NULL,
  y2label = "Cumulative Frequency",
  log = "",
  at = NULL,
  tck = 0.025,
  bty = "u",
  ntick = 6,
  prtty = TRUE,
  dig = 1,
  cex = 1.75,
  cex.axis = 1.75,
  cex.leg = 1.5,
  cex.lab = 1.75,
  leg.x = 0.8,
  leg.y = 0.8,
  legend = TRUE,
  pch1 = 16,
  pch2 = 1,
  col1 = "black",
  col2 = "black",
  ...
)

plotSumz(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-sumz_+3A_titan.out">titan.out</code></td>
<td>
<p>A TITAN output object.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_filter">filter</code></td>
<td>
<p>A logical indicating whether only pure and reliable taxa should
be used to create the plot.This is the recommended as a check of the
unfiltered default to assess whether impure or unreliable taxa are
substantially contributing to the distribution of sum(z) scores.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_cumfrq">cumfrq</code></td>
<td>
<p>A logical specifying whether cumulative frequencies of sum(z)
maxima across bootstrap replicates should be plotted.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_bootz1">bootz1</code></td>
<td>
<p>A logical specifying whether decreasing cumulative frequencies
exist or should be plotted.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_bootz2">bootz2</code></td>
<td>
<p>A logical specifying whether increasing cumulative frequencies
exist or should be plotted.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_sumz1">sumz1</code></td>
<td>
<p>A logical specifying whether decreasing changes should be
plotted.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_sumz2">sumz2</code></td>
<td>
<p>A logical specifying whether increasing changes should be
plotted.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_xmin">xmin</code></td>
<td>
<p>A graphical argument specifying the value of the x axis minimum.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_xmax">xmax</code></td>
<td>
<p>A graphical argument specifying the value of the x axis maximum.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_xlabel">xlabel</code></td>
<td>
<p>A character string for the x axis label.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_y1label">y1label</code></td>
<td>
<p>A character specifying the label of the second y axis</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_y2label">y2label</code></td>
<td>
<p>A character specifying the label of the second y axis</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_log">log</code></td>
<td>
<p>A graphical argument specifying whether an axis should be log
scaled.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_at">at</code></td>
<td>
<p>A graphical argument for controling placement of the x axis label</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_tck">tck</code></td>
<td>
<p>A graphical argument specifying the scale of axis tick marks.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_bty">bty</code></td>
<td>
<p>A graphical argument.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_ntick">ntick</code></td>
<td>
<p>A graphical argument specifying the default number of axis tick
marks.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_prtty">prtty</code></td>
<td>
<p>A logical specifying whether pretty() should be used to plot
axis labels.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_dig">dig</code></td>
<td>
<p>A numeric argument specifying the number of decimal digits in
axes.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_cex">cex</code></td>
<td>
<p>A graphical argument specifying the scaling of the figure.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_cex.axis">cex.axis</code></td>
<td>
<p>A graphical argument specifying the scaling of the axes.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_cex.leg">cex.leg</code></td>
<td>
<p>A graphical argument specifying the scaling of the legend.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_cex.lab">cex.lab</code></td>
<td>
<p>A graphical argument specifying the scaling of the lables.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_leg.x">leg.x</code></td>
<td>
<p>A graphical argument specifying the x coordinate of the legend.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_leg.y">leg.y</code></td>
<td>
<p>A graphical argument specifying the y coordinate of the legend.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_legend">legend</code></td>
<td>
<p>A logical specifying whether or not to plot the legend.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_pch1">pch1</code></td>
<td>
<p>A graphical argument specifying the type of group 1 symbols.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_pch2">pch2</code></td>
<td>
<p>A graphical argument specifying the type of group 2 symbols.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_col1">col1</code></td>
<td>
<p>A graphical argument specifying the color of group 1 symbols.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_col2">col2</code></td>
<td>
<p>A graphical argument specifying the color of group 2 symbols.</p>
</td></tr>
<tr><td><code id="plot-sumz_+3A_...">...</code></td>
<td>
<p>An argument for passing generic plotting function parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assumes that the TITAN object contains bootstrap summaries and
filtering information and automatically determines whether this is the case.
Without the bootstrap summaries, only unfiltered change magnitudes are
plotted.
</p>
<p>The original sum(z) plots (v1.0) did not filter taxa using purity and
reliability.  Because these taxa often have small z scores, they are unlikely
to contribute significantly to the sum(z) profiles.  However, subsequent
investigation has demonstrated that when sufficient numbers of taxa are
involved, it is possible for noisy data to generate artifactual peaks in
low-magnitude sum(z) profiles or plateaus.  Therefore, we recommend
evaluating filtered versions of the sum(z) to assess this potential in v2.0.
</p>


<h3>Value</h3>

<p>A plot of sum(z-) and sum(z+) profiles along the environmental
gradient.
</p>


<h3>Note</h3>

<p>Should not be used with output objects from TITAN v1.0.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>King, RS and ME Baker  2010. Considerations for identifying and
interpreting ecological community thresholds. Journal of the North American
Benthological Association 29(3):998-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_taxa">plot_taxa()</a></code>, <code><a href="#topic+plot_cps">plot_cps()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(glades.titan)
plot_sumz(glades.titan, filter = FALSE)




</code></pre>

<hr>
<h2 id='plot-taxa'>Plots taxon-specific change points</h2><span id='topic+plot-taxa'></span><span id='topic+plot_taxa'></span><span id='topic+plotTaxa'></span>

<h3>Description</h3>

<p>Creates a plot of taxon-specific change points with optional quantiles
conveying uncertainty resulting from bootstrapped samples and optional
filtering by pure and reliable taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_taxa(
  titan.out,
  z1 = TRUE,
  z2 = TRUE,
  interval = TRUE,
  prob95 = FALSE,
  z.med = TRUE,
  xlabel = "Environmental Gradient",
  log = "",
  at = NULL,
  xmin = min(titan.out$sppmax[, 8]),
  xmax = max(titan.out$sppmax[, 12]) * 1.05,
  tck = 0.025,
  bty = "u",
  ntick = 6,
  prtty = TRUE,
  dig = 1,
  leg.x = 0.8,
  leg.y = 10,
  cex.taxa = 0.6,
  cex = 1,
  cex.axis = 1,
  cex.leg = 1,
  cex.lab = 1,
  legend = TRUE,
  col1 = "black",
  fil1 = "black",
  col2 = "black",
  fil2 = "white",
  write = FALSE,
  all = FALSE,
  ...
)

plotTaxa(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-taxa_+3A_titan.out">titan.out</code></td>
<td>
<p>A TITAN output object.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_z1">z1</code></td>
<td>
<p>A logical specifying whether decreasing taxa should be plotted.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_z2">z2</code></td>
<td>
<p>A logical specifying whether decreasing taxa should be plotted.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_interval">interval</code></td>
<td>
<p>A logical specifying whether quantiles of bootstrapped change
points should be plotted.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_prob95">prob95</code></td>
<td>
<p>A logical specifying whether change-point locations should be
plotted on the basis of their 5th (for increasers) and 95th (for
decreasers) quantile versus their observed values.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_z.med">z.med</code></td>
<td>
<p>A logical specifying whether (1) change point magnitudes should
be obtained from the median z score across bootstrap replicates and (2)
whether the locations should be plotted on the basis of the 50th quantile
of change-point locations (i.e., if prob95=FALSE).</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_xlabel">xlabel</code></td>
<td>
<p>A character string for the x axis label.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_log">log</code></td>
<td>
<p>A graphical argument specifying whether an axis should be log
scaled.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_at">at</code></td>
<td>
<p>A graphical argument controlling the locatino of the x axis label.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_xmin">xmin</code></td>
<td>
<p>A graphical argument specifying the value of the x axis minimum.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_xmax">xmax</code></td>
<td>
<p>A graphical argument specifying the value of the x axis maximum.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_tck">tck</code></td>
<td>
<p>A graphical argument specifying the scale of axis tick marks.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_bty">bty</code></td>
<td>
<p>A graphical argument specyfying the box type around the plot.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_ntick">ntick</code></td>
<td>
<p>A graphical argument specifying the default number of axis tick
marks.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_prtty">prtty</code></td>
<td>
<p>A logical specifying whether pretty() should be used for axis
plotting.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_dig">dig</code></td>
<td>
<p>A numeric argument controlling the number of decimal digits in
axis labels.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_leg.x">leg.x</code></td>
<td>
<p>A graphical argument specifying the x coordinate of the legend.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_leg.y">leg.y</code></td>
<td>
<p>A graphical argument specifying the y coordinate of the legend.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_cex.taxa">cex.taxa</code></td>
<td>
<p>A graphical argument specifying the scaling of the taxa
names.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_cex">cex</code></td>
<td>
<p>A graphical argument specifying the scaling of the figure.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_cex.axis">cex.axis</code></td>
<td>
<p>A graphical argument specifying the scaling of the axes.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_cex.leg">cex.leg</code></td>
<td>
<p>A graphical argument specifying the scaling of the legend.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_cex.lab">cex.lab</code></td>
<td>
<p>A graphical argument specifying the scaling of the lables.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_legend">legend</code></td>
<td>
<p>A logical specifying whether or not to plot the legend.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_col1">col1</code></td>
<td>
<p>A graphical argument specifying the color of group 1 symbols.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_fil1">fil1</code></td>
<td>
<p>A graphical argument specifying the color of group 1 fills.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_col2">col2</code></td>
<td>
<p>A graphical argument specifying the color of group 2 symbols.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_fil2">fil2</code></td>
<td>
<p>A graphical argument specifying the color of group 2 fills.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_write">write</code></td>
<td>
<p>A logical specifying whether summary tables are written to
screen.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_all">all</code></td>
<td>
<p>A logical specifying whether all taxa with p&lt;0.05 should be
plotted.</p>
</td></tr>
<tr><td><code id="plot-taxa_+3A_...">...</code></td>
<td>
<p>An argument for passing generic plotting function parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fuction assumes that TITAN objects contain bootstrap summaries and
filtering information and automatically determines whether this is the case.
Without bootstrap summaries, only observed change-point locations and z-score
magnitudes will be plotted.  The plotting function automatically interprets
whether observed change-point values were obtained using IndVal or z-score
maxima.  The interval option is for turning off the intervals for TITAN
objects that contain bootstrap information. The prob95 is recommended for
communicating uncertainty involving management or policy action, whereas the
z.med option is recommended for increasingly robust estimates (by
incorporating uncertainty associated with the sample) of taxon-specific
change-point locations beyond those provided by the default (i.e., observed
values).
</p>


<h3>Value</h3>

<p>A plot of decreasing and/or increasing taxon-specific change points
along the environmental gradient.
</p>


<h3>Note</h3>

<p>Should not be used with output objects from TITAN v1.0.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>King, RS and ME Baker  2010. Considerations for identifying and
interpreting ecological community thresholds. Journal of the North American
Benthological Association 29(3):998-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_sumz">plot_sumz()</a></code>, <code><a href="#topic+plot_cps">plot_cps()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(glades.titan)
plot_taxa(glades.titan, xlabel = "Surface Water TP (ug/l)")


</code></pre>

<hr>
<h2 id='smallBigBoot'>Summarizes raw output from TITAN's bootstrap procedure</h2><span id='topic+smallBigBoot'></span><span id='topic+small.boot'></span><span id='topic+big.boot'></span>

<h3>Description</h3>

<p>A function to take output from TITAN's bootstrap procedure and process it for
summary output.  The default is to perform this processing entirely within
active memory, but in the event of overflowing system capacity, an optional
program writes temporary files to a scratch directory to circumvent memory
limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>small.boot(
  ivz.bt.list,
  bSeq,
  sppmax,
  obs1,
  obs2,
  nBoot,
  numClass,
  numUnit,
  ncpus,
  pur.cut,
  rel.cut,
  minSplt
)

big.boot(
  ivz.bt.list,
  bSeq,
  sppmax,
  obs1,
  obs2,
  nBoot,
  numClass,
  numUnit,
  ncpus,
  pur.cut,
  rel.cut,
  minSplt
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smallBigBoot_+3A_ivz.bt.list">ivz.bt.list</code></td>
<td>
<p>A list of output from each bootstrap replicate passed from
<code><a href="#topic+boot.titan">boot.titan()</a></code>.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_bseq">bSeq</code></td>
<td>
<p>An index of the sequence of bootstrap replicates.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_sppmax">sppmax</code></td>
<td>
<p>A taxon-specific summary output table for TITAN.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_obs1">obs1</code></td>
<td>
<p>A binary vector indicating membership in the decreasing group of
taxa.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_obs2">obs2</code></td>
<td>
<p>A binary vector indicating membership in the increasing group of
taxa.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_nboot">nBoot</code></td>
<td>
<p>An argument specifying the number of bootstrap replicates.  The
default is to use the value specified in the original TITAN function call.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_numclass">numClass</code></td>
<td>
<p>An argument specifying the number of candidate partitions
along the environmental gradient.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_numunit">numUnit</code></td>
<td>
<p>An argument specifying the number of values along the
environmental gradient.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_ncpus">ncpus</code></td>
<td>
<p>An argument specifying the number of processing cores used by
the TITAN function call.  If ncpus&gt;1 then parallel processing is indicated.
The default is to use the value specified in the original TITAN function
call.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_pur.cut">pur.cut</code></td>
<td>
<p>An argument specifying the cutoff value for determining
purity.  The default is to use the value specified in the original TITAN
function call.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_rel.cut">rel.cut</code></td>
<td>
<p>An argument specifying the cutoff value for determining
reliability.  The default is to use the value specified in the original
TITAN function call.</p>
</td></tr>
<tr><td><code id="smallBigBoot_+3A_minsplt">minSplt</code></td>
<td>
<p>An argument specifying minimum split size of partitioning
along the environmental gradient.  The default is to use the value
specified in the original TITAN function call.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use of 'small.boot' versus 'big.boot' is controlled by the argument 'memory'
in the original TITAN function call and passed to the wrapper function
'titan'.  The two progams have identical functionality, but they accomplish
those functions differently to deal with memory limitations.
</p>
<p>For sequential processing of the bootsrtap, the index 'bSeq' is simply a
sequence from 1:nBoot that is printed to the screen. For parallel processing,
'bSeq' is a list of length equal to 'ncpus', where each item is a segment of
the sequence allocated to each processing core.  Thus, depending on whether
'ncpus'&gt;1, the value of 'bSeq' is used differently to extract values from the
bootstrap output list.
</p>
<p>The first part of each function consists of defining output matrices, the
second involves extraction of output from the bootstrap list, the third part
involves calculating purity, reliability, the median z score, and quantiles
of the bootstrapped change points for each taxon.  These values are used to
complete the 'sppmax' output table and to identify the taxa that meet purity
and reliability criteria.  The final portion of each function finds the
maximum sum(z-), sum(z+), f.sum(z-), and f.sum(z+) for each bootstrap
replicate for later estimation of confidence intervals.  The final portion of
the summary involves calculating the filtered and unfiltered sum(z) scores
for each bootstrap replicate from the matrix of z scores and response
directions passed from the function boot.titan() within ivz.bt.list
</p>


<h3>Value</h3>

<p>A list of six items: </p>

<dl>
<dt>sppSub1</dt><dd><p>A vector of taxon index numbers for pure and reliable
decreasers</p>
</dd>
<dt>sppSub2</dt><dd><p>A vector of taxon index numbers for pure and reliable
increasers</p>
</dd>
<dt>sppmax</dt><dd><p>The completed taxon-specific summary output table for TITAN</p>
</dd>
<dt>maxSumz</dt><dd><p>A 2-column matrix of environmental values at sum(z-) and
sum(z+) maxima across all bootstrap replicates</p>
</dd>
<dt>maxFsumz</dt><dd><p>A 2-column matrix of environmental values at filtered
sum(z-) and sum(z+) maxima across all bootstrap replicates</p>
</dd>
<dt>metricArray</dt><dd><p>An array of group membership, env change points, z
scores, and p values for passing to 'plot.IVecdf'</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds. Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>Baker ME and RS King. 2013. Of TITAN and straw men: an appeal for
greater understanding of community data. Freshwater Science 32(2):489-506.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot.titan">boot.titan()</a></code>, <code><a href="#topic+tboot">tboot()</a></code>, <code><a href="#topic+titan">titan()</a></code>
</p>

<hr>
<h2 id='sumz.tab'>Summarizes the results of the community-level sum(z) analysis</h2><span id='topic+sumz.tab'></span>

<h3>Description</h3>

<p>This function populates the sumz.cp table using the resuls from function
'ivzsums' and, if 'boot'=TRUE, calls 'ivsums.f' to compute ivz sums filtered
by pure and reliable taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumz.tab(
  ivzScores,
  ivz,
  srtEnv,
  sppmax,
  maxSumz = maxSumz,
  maxFsumz = maxFsumz,
  minSplt = minSplt,
  boot = boot
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumz.tab_+3A_ivzscores">ivzScores</code></td>
<td>
<p>The product of the 'getivz' function.  A data matrix
comprised of four submatrices including group membership, z scores,
IndVals, and p values.</p>
</td></tr>
<tr><td><code id="sumz.tab_+3A_ivz">ivz</code></td>
<td>
<p>The product of the 'ivzsums' function.  A data matrix comprised of
two parallel vectors of sum(z-) and sum(z+) scores.</p>
</td></tr>
<tr><td><code id="sumz.tab_+3A_srtenv">srtEnv</code></td>
<td>
<p>A sorted version of the environmental gradient.</p>
</td></tr>
<tr><td><code id="sumz.tab_+3A_sppmax">sppmax</code></td>
<td>
<p>The taxon-specific summary output table from TITAN, passed to
'ivzsums.f'.</p>
</td></tr>
<tr><td><code id="sumz.tab_+3A_maxsumz">maxSumz</code></td>
<td>
<p>A vector of sum(z) maxima across bootstrap replicates.</p>
</td></tr>
<tr><td><code id="sumz.tab_+3A_maxfsumz">maxFsumz</code></td>
<td>
<p>A vector of sum(z) maxima filtered by pure and reliable taxa
across bootstrap replicates.</p>
</td></tr>
<tr><td><code id="sumz.tab_+3A_minsplt">minSplt</code></td>
<td>
<p>The minimum split size used to partition the environmental
gradient.  The default is to use the argument specified by the original
TITAN function call.</p>
</td></tr>
<tr><td><code id="sumz.tab_+3A_boot">boot</code></td>
<td>
<p>A logical indicating whether the bootstrap procedure should be
implemented.  The default is to use the argument specified by the original
TITAN function call.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function locates the env values of sum(z) maxima, then if 'boot'=TRUE,
locates the the env value of the filtered sum(z) and provides bootstrap
quantiles of both filtered and unfiltered distributions.
</p>


<h3>Value</h3>

<p>A list with two objects:
</p>

<dl>
<dt>sumz.cp</dt><dd><p>A second summary output table from TITAN to accompany
'sppmax'.</p>
</dd>
<dt>ivz.f</dt><dd><p>The product of the 'ivzsums.f' function.  A data matrix
comprised of two parallel vectors of filtered sum(z-) and sum(z+) scores.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>King, RS and ME Baker  2010. Considerations for identifying and
interpreting ecological community thresholds. Journal of the North American
Benthological Association 29(3):998-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ivzsums">ivzsums()</a></code>, <code><a href="#topic+ivzsums.f">ivzsums.f()</a></code>, <code><a href="#topic+getivz">getivz()</a></code>, <code><a href="#topic+titan">titan()</a></code>
</p>

<hr>
<h2 id='tboot'>Calculate bootstrapped IndVal z scores</h2><span id='topic+tboot'></span>

<h3>Description</h3>

<p>This function implements resampling (with replacement) of the observed
environmental gradient and site-by-taxon matrix, and then calls the function
<code><a href="#topic+getivz">getivz()</a></code> to obtain bootstrapped scores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tboot(
  bSeq,
  env,
  taxa,
  ivTot = ivTot,
  minSplt = minSplt,
  nPerm = nPerm,
  memory = memory,
  imax = imax
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tboot_+3A_bseq">bSeq</code></td>
<td>
<p>An index used to determine the sequence number of the current
bootstrap replicate.</p>
</td></tr>
<tr><td><code id="tboot_+3A_env">env</code></td>
<td>
<p>An environmental gradient.</p>
</td></tr>
<tr><td><code id="tboot_+3A_taxa">taxa</code></td>
<td>
<p>A site-by-taxon matrix of taxa counts at each sampling location.</p>
</td></tr>
<tr><td><code id="tboot_+3A_ivtot">ivTot</code></td>
<td>
<p>A logical indicating whether IndVal scores should be calculated
using total relative abundance or the mean relative abundace originally
proposed by Dufrene and Legendre (1997). The default is to pass on the
argument from the original TITAN funtion call.</p>
</td></tr>
<tr><td><code id="tboot_+3A_minsplt">minSplt</code></td>
<td>
<p>The minimum bin size for partitioning along the environmental
gradient.  The default is to pass on the argument from the original TITAN
funtion call.</p>
</td></tr>
<tr><td><code id="tboot_+3A_nperm">nPerm</code></td>
<td>
<p>The number of replicates used by the permutation procedure (not
to be confused with the number of bootstrap replicates). The default is to
pass on the argument from the original TITAN funtion call.</p>
</td></tr>
<tr><td><code id="tboot_+3A_memory">memory</code></td>
<td>
<p>A logical indicating whether scratch files should be used to
store temporary data in order to preserve RAM during bootstrapping of large
data sets.  The default is to pass on the argument from the original TITAN
funtion call.</p>
</td></tr>
<tr><td><code id="tboot_+3A_imax">imax</code></td>
<td>
<p>A logical indicating whether taxon-specific change points should
be determined by IndVal maxima or z-score maxima (as in Baker and King
2010). The default is to pass on the argument from the original TITAN
funtion call.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Four pieces of information are obtained from every taxon during each
bootstrap replicate. If the argument 'imax' is TRUE, bootstrapped change
points are identified based on IndVal maxima, whereas if 'imax' is FALSE
z-score maxima are used instead.  In addition to the IndVal or z score
maxima, the value of the environmental gradient, the indicator direction, and
the p value are also retained for that point.
</p>
<p>In addition to the above metric matrix for each taxon (1), the z scores
across all candidate chnage points are retained from each replicate (2), as
well as the response direction (maxgrp) (3) and a sorted version of resampled
environmental values (4).  These four items are combined as a list object.
</p>


<h3>Value</h3>

<p>A list of four elements: </p>

<dl>
<dt>bt.metrics</dt><dd><p>A matrix with nrow equal to number of taxa where the
first column is the bootstrapped IndVal or z score maximum, the second is
the environmental value, the third is the indicator direction, and the
fourth is the p value at that point.</p>
</dd>
<dt>ivzs</dt><dd><p>Z scores for all taxa across candidate change points in the
replicate sample</p>
</dd>
<dt>bsrti</dt><dd><p>A sorted version of the bootstrapped environmental gradient</p>
</dd>
<dt>rspdr</dt><dd><p>Response direction (1 or 2) for all taxa across candidate
change points in the replicate sample</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds. Methods in
Ecology and Evolution 1(1): 25:37.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getivz">getivz()</a></code>, <code><a href="#topic+ivzsums">ivzsums()</a></code>
</p>

<hr>
<h2 id='titan'>Perform a threshold indicator taxa analysis</h2><span id='topic+titan'></span>

<h3>Description</h3>

<p><code><a href="#topic+titan">titan()</a></code> is the primary wrapper function controlling operation of all
subroutines (<code><a href="#topic+txa.screen">txa.screen()</a></code>, <code><a href="#topic+env.part">env.part()</a></code>, <code><a href="#topic+getivz">getivz()</a></code>, <code><a href="#topic+ivzsums">ivzsums()</a></code>,
<code><a href="#topic+obs.summ">obs.summ()</a></code>, <code><a href="#topic+boot.titan">boot.titan()</a></code>, <code><a href="#topic+small.boot">small.boot()</a></code>/<code><a href="#topic+big.boot">big.boot()</a></code>, <code><a href="#topic+sumz.tab">sumz.tab()</a></code>)
apart from plotting functions within TITAN.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>titan(
  env,
  txa,
  minSplt = 5,
  numPerm = 250,
  boot = TRUE,
  nBoot = 500,
  imax = FALSE,
  ivTot = FALSE,
  pur.cut = 0.95,
  rel.cut = 0.95,
  ncpus = 1,
  memory = FALSE,
  messaging = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="titan_+3A_env">env</code></td>
<td>
<p>A vector of environmental values.</p>
</td></tr>
<tr><td><code id="titan_+3A_txa">txa</code></td>
<td>
<p>A site by taxon matrix containing observed counts at each sampling
location.</p>
</td></tr>
<tr><td><code id="titan_+3A_minsplt">minSplt</code></td>
<td>
<p>The  minimum split size to be used in partitioning.</p>
</td></tr>
<tr><td><code id="titan_+3A_numperm">numPerm</code></td>
<td>
<p>The number of replicates to be used during permutation.</p>
</td></tr>
<tr><td><code id="titan_+3A_boot">boot</code></td>
<td>
<p>A logical indicating whether bootstrap resampling should be
performed.</p>
</td></tr>
<tr><td><code id="titan_+3A_nboot">nBoot</code></td>
<td>
<p>The number of replicates to be used during bootstrap resampling.</p>
</td></tr>
<tr><td><code id="titan_+3A_imax">imax</code></td>
<td>
<p>A logical indication whether taxon-specific change points should
be determined using IndVal maxima or z-score maxima (as in Baker and King
2010, 2013).</p>
</td></tr>
<tr><td><code id="titan_+3A_ivtot">ivTot</code></td>
<td>
<p>A logical indicating whether IndVal scores should be calculated
using total relative abundance or the mean relative abundace originally
proposed by Dufrene and Legendre (1997).</p>
</td></tr>
<tr><td><code id="titan_+3A_pur.cut">pur.cut</code></td>
<td>
<p>A proportion specifying the cutoff value for determining
purity across all bootstrap replicates.</p>
</td></tr>
<tr><td><code id="titan_+3A_rel.cut">rel.cut</code></td>
<td>
<p>A proportion specifying the cutoff value for determining
reliability across all bootstrap replicates.</p>
</td></tr>
<tr><td><code id="titan_+3A_ncpus">ncpus</code></td>
<td>
<p>The number of processing cores to be used during processing.  If
greater than 1, TITAN will load and use the package 'snow' to perform
parallel processing on each core.</p>
</td></tr>
<tr><td><code id="titan_+3A_memory">memory</code></td>
<td>
<p>A logical indicating whether temporary files should be written
to a scratch directory during bootstrap processing to preserve active
memory.  This function is sometimes necessary for large data files (e.g.
more than 400 sampling sites and less than 100 taxa).</p>
</td></tr>
<tr><td><code id="titan_+3A_messaging">messaging</code></td>
<td>
<p>If <code>TRUE</code>, provide progress messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 13 items: </p>

<dl>
<dt>sppmax</dt><dd><p>Description of 'comp1'</p>
</dd>
<dt>sumz.cp</dt><dd><p>Description of 'comp1'</p>
</dd>
<dt>env</dt><dd><p>The vector of environmental values used in the TITAN function
call</p>
</dd>
<dt>taxa</dt><dd><p>The site-by-taxon matrix used in the TITAN function call</p>
</dd>
<dt>envlcs</dt><dd><p>A vector of candidate partitions derived from subtracting
'minSplt' from 'env'</p>
</dd>
<dt>srtEnv</dt><dd><p>A sorted version of environmental values</p>
</dd>
<dt>ivzScores</dt><dd><p>A matrix containing group membership, z scores, IndVals,
and p values for each taxon at every candidate partition in 'envcls'</p>
</dd>
<dt>ivz</dt><dd><p>A 2-column matrix containing parallel vectors of sum(z-) and
sum(z+ scores for every candidate partition in 'envcls')</p>
</dd>
<dt>ivz.f</dt><dd><p>A 2-column matrix containing parallel vectors of sum(z-) and
sum(z+ scores filtered by pure and reliable taxa for every candidate
partition in 'envcls')</p>
</dd>
<dt>maxSumz</dt><dd><p>A 2-column matrix of environmental values at sum(z-) and
sum(z+) maxima across all bootstrap replicates</p>
</dd>
<dt>maxFsumz</dt><dd><p>A 2-column matrix of environmental values at filtered
sum(z-) and sum(z+) maxima across all bootstrap replicates</p>
</dd>
<dt>metricArray</dt><dd><p>An array of group membership, env change points, z
scores, and p values equivalent to 'ivzScores' for each bootstrap
replicate</p>
</dd>
<dt>targs</dt><dd><p>A vector of arguments used in the TITAN function call</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>King, RS and ME Baker  2010. Considerations for identifying and
interpreting ecological community thresholds. Journal of the North American
Benthological Association 29(3):998-1008.
</p>
<p>Baker ME and RS King. 2013. Of TITAN and straw men: an appeal for
greater understanding of community data. Freshwater Science 32(2):489-506.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(glades.env); str(glades.env)
data(glades.taxa); str(glades.taxa)

# small run to illustrate data structure
glades.titan &lt;- titan(glades.env, glades.taxa, minSplt = 5,
  numPerm = 25, boot = TRUE, nBoot = 2, imax = FALSE,
  ivTot = FALSE, pur.cut = 0.95, rel.cut = 0.95, ncpus = 2, memory = FALSE
)
str(glades.titan, give.attr = FALSE)


# typical run
if (FALSE) {
glades.titan &lt;- titan(glades.env, glades.taxa, minSplt = 5,
  numPerm = 250, boot = TRUE, nBoot = 100, imax = FALSE,
  ivTot = FALSE, pur.cut = 0.95, rel.cut = 0.95, ncpus = 1, memory = FALSE
)
}




</code></pre>

<hr>
<h2 id='TITAN2'>Threshold Indicator Taxa Analysis</h2><span id='topic+TITAN2'></span><span id='topic+package-TITAN2'></span>

<h3>Description</h3>

<p>Uses indicator species scores across binary partitions of a sample set to
detect congruence in taxon-specific changes of abundance and occurrence
frequency along an environmental gradient as evidence of an ecological
community threshold.
</p>


<h3>Details</h3>

<p>Relevant references include Baker and King (2010)
<a href="doi:10.1111/j.2041-210X.2009.00007.x">doi:10.1111/j.2041-210X.2009.00007.x</a>, King and Baker (2010)
<a href="doi:10.1899/09-144.1">doi:10.1899/09-144.1</a>, and Baker and King (2013) <a href="doi:10.1899/12-142.1">doi:10.1899/12-142.1</a>.
</p>

<hr>
<h2 id='txa.screen'>Screening of site by taxa matrix</h2><span id='topic+txa.screen'></span>

<h3>Description</h3>

<p>Screens site by taxa matrix for potential minimum occurrence and frequency
problems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>txa.screen(txa, minSplt = minSplt, messaging = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="txa.screen_+3A_txa">txa</code></td>
<td>
<p>A site by taxon matrix of sampled counts at each sampling
location.</p>
</td></tr>
<tr><td><code id="txa.screen_+3A_minsplt">minSplt</code></td>
<td>
<p>The minimum split size used for partitioning.  The default is
to use the argument form the original TITAN function call.</p>
</td></tr>
<tr><td><code id="txa.screen_+3A_messaging">messaging</code></td>
<td>
<p>If <code>TRUE</code>, provide progress messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides a warning for low numbers of observations and data
sets with too few observations to make any reasonable interpretation.  It
also warns users when 100 percent occurence is detected and how much of the
data set meets this criterion, as IndVal based analyses are not ideal for
this type of data and we might recommend other techniques (Baker and King
2013). The function also assess whether occurrence frequencies for any taxa
fall below 3, and call attention to very small minimum split sizes.
</p>


<h3>Value</h3>

<p>A site by taxon matrix of sampled counts at each sampling location.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>Baker ME and RS King. 2013. Of TITAN and straw men: an appeal for
greater understanding of community data. Freshwater Science 32(2):489-506.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
