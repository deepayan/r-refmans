<!DOCTYPE html><html lang="en"><head><title>Help for package GEInfo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GEInfo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CGEInfo'><p>CGEInfo and GEsgMCP approaches with fixed tunings</p></a></li>
<li><a href='#coef.GEInfo'><p>Extract coefficients from a fitted object</p></a></li>
<li><a href='#cv.CGEInfo'><p>Cross-validation for CGEInfo</p></a></li>
<li><a href='#cv.GEInfo'><p>Cross-validation for GEInfo</p></a></li>
<li><a href='#GEInfo'><p>GEInfo approach with fixed tunings</p></a></li>
<li><a href='#matW'><p>Calculate matrix W</p></a></li>
<li><a href='#plot.GEInfo'><p>Heatmap of the identification results</p></a></li>
<li><a href='#plot.PubMed'><p>Visualize the prior information</p></a></li>
<li><a href='#predict.GEInfo'><p>Make Predictions for a fitted model</p></a></li>
<li><a href='#PubMed.search'><p>Search prior counts for G variables and G-E interactions</p></a></li>
<li><a href='#TypeS'><p>Construct Type_S prior information</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Gene-Environment Interaction Analysis Incorporating Prior
Information</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiaoyan Wang, Hongduo Liu, and Shuangge Ma</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiaoyan Wang &lt;xywang@hnu.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Realize three approaches for Gene-Environment interaction analysis. All of them adopt Sparse Group Minimax Concave Penalty to identify important G variables and G-E interactions, and simultaneously respect the hierarchy between main G and G-E interaction effects. All the three approaches are available for Linear, Logistic, and Poisson regression. Also realize to mine and construct prior information for G variables and G-E interactions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, glmnet, stats, rvest, dplyr, pheatmap, grDevices,
graphics</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-08 04:17:01 UTC; xiaoyanwang</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-10 17:52:50 UTC</td>
</tr>
</table>
<hr>
<h2 id='CGEInfo'>CGEInfo and GEsgMCP approaches with fixed tunings</h2><span id='topic+CGEInfo'></span>

<h3>Description</h3>

<p>Realize to estimate CGEInfo and GEsgMCP approaches at fixed tunings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CGEInfo(
  E,
  G,
  Y,
  family,
  lam1,
  lam2,
  xi = 6,
  epsilon = 0,
  max.it = 500,
  thresh = 0.001,
  S_G = NULL,
  S_GE = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CGEInfo_+3A_e">E</code></td>
<td>
<p>Observed matrix of E variables, of dimensions n x q.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_g">G</code></td>
<td>
<p>Observed matrix of G variables, of dimensions n x p.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_y">Y</code></td>
<td>
<p>Response variable of length n. Quantitative for family=&quot;gaussian&quot;, or family=&quot;poisson&quot; (non-negative count). For family=&quot;binomial&quot; should be a factor with two levels.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_family">family</code></td>
<td>
<p>Model type: one of (&quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;).</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_lam1">lam1</code></td>
<td>
<p>A user supplied lambda1.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_lam2">lam2</code></td>
<td>
<p>A user supplied lambda2.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_xi">xi</code></td>
<td>
<p>Tuning parameter of MCP penalty. Default is 6.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_epsilon">epsilon</code></td>
<td>
<p>Tuning parameter of Ridge penalty which shrinks the coefficients of variables having prior information. Default is 0.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations (total across entire path). Default is 500.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_thresh">thresh</code></td>
<td>
<p>Convergence threshold for group coordinate descent algorithm. The algorithm iterates until the change for each coefficient is less than thresh. Default is 1e-3.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_s_g">S_G</code></td>
<td>
<p>A user supplied vector, denoting the subscript of G variables which have prior information. Default is NULL.</p>
</td></tr>
<tr><td><code id="CGEInfo_+3A_s_ge">S_GE</code></td>
<td>
<p>A user supplied matrix, denoting the subscript of G-E interactions which have prior information.
The first and second columns of S_GE represent the subscript of G variable and the subscript of E variable, respectively.
For example, S_GE = matrix( c(1, 2), ncol = 2), which indicates that the 1st G and the 2nd E variables have an interaction effect on Y.
Default is NULL. If both S_G and S_GE are NULL, no prior information is incorporated in the model, in which case function CGEInfo realizes GEsgMCP approach.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;GEInfo&quot; is returned, which is a list including the estimation results at fixed tunings.
</p>
<table role = "presentation">
<tr><td><code>a</code></td>
<td>
<p>Coefficient vector of length q for E variables.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Coefficient vector of length (q+1)p for W (G variables and G-E interactions).</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Coefficient vector of length p for G variables.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Coefficient matrix of dimensions p*q for G-E interactions.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Intercept.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A coefficient vector of length (q+1)*(p+1), including the estimates for <code class="reqn">\alpha</code> (intercept), <code class="reqn">a</code> (coefficients for all E variables), and <code class="reqn">b</code> (coefficients for all G variables and G-E interactions).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wang X, Xu Y, and Ma S. (2019). Identifying gene-environment interactions incorporating prior information. Statistics in medicine, 38(9): 1620-1633. doi: <a href="https://doi.org/10.1002/sim.8064">10.1002/sim.8064</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 30; p &lt;- 5; q &lt;- 2
E &lt;- MASS::mvrnorm(n, rep(0,q), diag(q))
G &lt;- MASS::mvrnorm(n, rep(0,p), diag(p))
W &lt;- matW(E, G)
alpha &lt;- 0; a &lt;- seq(0.4, 0.6, length=q);
beta &lt;- c(seq(0.2, 0.5, length=3),rep(0, p-3))  # coefficients of G variables
vector.gamma &lt;- c(0.8, 0.5, 0, 0)
gamma &lt;- matrix(c(vector.gamma, rep(0, p*q - length(vector.gamma))), nrow=p, byrow=TRUE)
mat.b.gamma &lt;- cbind(beta, gamma)
b &lt;- as.vector (t(mat.b.gamma))              # coefficients of G and G-E interactions
Y &lt;- alpha + E %*% a + W %*% b + rnorm (n, 0, 0.5)
S_G &lt;- c(1)
S_GE &lt;- cbind(c(1), c(1))
fit1 &lt;- CGEInfo(E, G, Y,family='gaussian', S_G=S_G, S_GE=S_GE,lam1=0.4,lam2=0.4)
</code></pre>

<hr>
<h2 id='coef.GEInfo'>Extract coefficients from a fitted object</h2><span id='topic+coef.GEInfo'></span>

<h3>Description</h3>

<p>Report the estimate of all coefficients from a fitted &quot;CGEInfo&quot; or &quot;GEInfo&quot; model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEInfo'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.GEInfo_+3A_object">object</code></td>
<td>
<p>A fitted &quot;CGEInfo&quot; or &quot;GEInfo&quot; model object for which the estimate of coefficients is extracted.</p>
</td></tr>
<tr><td><code id="coef.GEInfo_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A coefficient vector of length (q+1) x (p+1), including the estimates for <code class="reqn">\alpha</code> (intercept), <code class="reqn">a</code> (coefficients for all E variables), and <code class="reqn">b</code> (coefficients for all G variables and G-E interactions).
</p>

<hr>
<h2 id='cv.CGEInfo'>Cross-validation for CGEInfo</h2><span id='topic+cv.CGEInfo'></span>

<h3>Description</h3>

<p>Does k-fold cross-validation for CGEInfo, returns the estimation results at best tunings, and produces a heatmap for the identification results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.CGEInfo(
  E,
  G,
  Y,
  family,
  nfolds = 3,
  xi = 6,
  epsilon = 0,
  max.it = 500,
  thresh = 0.001,
  criterion = "BIC",
  lam1 = NULL,
  lam2 = NULL,
  S_G = NULL,
  S_GE = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.CGEInfo_+3A_e">E</code></td>
<td>
<p>Observed matrix of E variables, of dimensions n x q.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_g">G</code></td>
<td>
<p>Observed matrix of G variables, of dimensions n x p.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_y">Y</code></td>
<td>
<p>Response variable, of length n. Quantitative for family=&quot;gaussian&quot;, or family=&quot;poisson&quot; (non-negative counts). For family=&quot;binomial&quot; should be a factor with two levels.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_family">family</code></td>
<td>
<p>Model type: one of (&quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;).</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_nfolds">nfolds</code></td>
<td>
<p>Number of folds. Default is 3.
Although nfolds can be as large as the sample size n (leave-one-out CV), it is not recommended for large datasets. Smallest value allowable is nfolds=3.
See Details.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_xi">xi</code></td>
<td>
<p>Tuning parameter of MCP penalty. Default is 6.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_epsilon">epsilon</code></td>
<td>
<p>Tuning parameter of Ridge penalty which shrinks the coefficients having prior information. Default is 0.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations (total across entire path). Default is 500.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_thresh">thresh</code></td>
<td>
<p>Convergence threshold for group coordinate descent algorithm. The algorithm iterates until the change for each coefficient is less than thresh. Default is 1e-3.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_criterion">criterion</code></td>
<td>
<p>Criterion used for cross-validation. Currently five options: MSE, AIC, BIC, EBIC, GCV. Default is BIC. See Details.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_lam1">lam1</code></td>
<td>
<p>A user supplied  lambda1 sequence.
Typical usage is to have the program compute its own lambda1 sequence. Supplying a value of lam1 overrides this. Default is lam1=NULL.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_lam2">lam2</code></td>
<td>
<p>A user supplied  lambda2 sequence. Default is lam2=NULL.
Typical usage is to have the program compute its own lambda2 sequence. Supplying a value of lam2 overrides this. Default is lam2=NULL.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_s_g">S_G</code></td>
<td>
<p>A user supplied vector, denoting the subscript of G variables which have prior information. Default is NULL. See Details.</p>
</td></tr>
<tr><td><code id="cv.CGEInfo_+3A_s_ge">S_GE</code></td>
<td>
<p>A user supplied matrix, denoting the subscript of G-E interactions which have prior information.
The first and second columns of S_GE represent the subscript of G variable and the subscript of E variable, respectively.
For example, S_GE = matrix( c(1, 2), ncol = 2), indicating that the 1st G variable and the 2nd E variables have an interaction effect on Y.
Default is NULL. If both S_G and S_GE are NULL, no prior information is incorporated in the model, in which case this function realizes GEsgMCP approach. See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calls CGEInfo nfolds times, each time leaving out 1/nfolds of the data. The cross-validation error is based on the user given &quot;criterion&quot;.
cv.CGEInfo supports to construct two methods: GEInfo and GEsgMCP, depending on whether S_G and S_GE are NULL.
When either S_G or S_GE is not NULL, CGEInfo approach is realized, which completely trusts the prior information.
Otherwise, GEsgMCP approach is constructed, in which no prior information is incorporated.
</p>
<p>In order to select the optimal tunings, there are five criteria available, which are MSE, AIC, BIC, GCV, and EBIC. Let L be the loss function of the model,
<code class="reqn">MSE=L</code>, <code class="reqn">AIC=2L+2df</code>, <code class="reqn">BIC=2L+ln(n)df</code>, <code class="reqn">GCV=2L/(1-df/n)^2</code>,
and <code class="reqn">EBIC=2L+ln(n)df + 2df ln(nvar) (1-ln(n)/(2ln(nvar)))</code>.
In most cases, BIC is a good choice. In the case of high dimension, EBIC criterion is recommended first,
which has demonstrated satisfactory performance in high-dimensional studies.
</p>


<h3>Value</h3>

<p>An object of class &quot;GEInfo&quot; is returned, which is a list with the ingredients of the cross-validation fit.
</p>
<table role = "presentation">
<tr><td><code>best.tuning</code></td>
<td>
<p>A vector of length 2, containing the best lambda1 and lambda2 selected by cross-validation.</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>Coefficient vector of length q for all E variables.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Coefficient vector of length p for all G variables.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Coefficient matrix of dimensions p*q for G-E interactions.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Coefficient vector of length (q+1)*p for W (G variables and G-E interactions).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Intercept.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A coefficient vector of length (q+1)*(p+1), including the estimates for <code class="reqn">\alpha</code> (intercept), <code class="reqn">a</code> (coefficients for all E variables), and <code class="reqn">b</code> (coefficients for all G variables and G-E interactions).</p>
</td></tr>
<tr><td><code>nvar</code></td>
<td>
<p>Number of non-zero coefficients at the best tunings.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wang X, Xu Y, and Ma S. (2019). Identifying gene-environment interactions incorporating prior information. Statistics in medicine, 38(9): 1620-1633. doi: <a href="https://doi.org/10.1002/sim.8064">10.1002/sim.8064</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 30; p &lt;- 5; q &lt;- 2
E &lt;- MASS::mvrnorm(n, rep(0,q), diag(q))
G &lt;- MASS::mvrnorm(n, rep(0,p), diag(p))
W &lt;- matW(E, G)
alpha &lt;- 0; a &lt;- seq(0.4, 0.6, length=q);
beta &lt;- c(seq(0.2, 0.5, length=3),rep(0, p-3))
vector.gamma &lt;- c(0.8, 0.5, 0, 0)
gamma &lt;- matrix(c(vector.gamma, rep(0, p*q - length(vector.gamma))), nrow=p, byrow=TRUE)
mat.b.gamma &lt;- cbind(beta, gamma)
b &lt;- as.vector (t(mat.b.gamma))
Y &lt;- alpha + E %*% a + W %*% b + rnorm (n, 0, 0.5)
S_G &lt;- c(1)
S_GE &lt;- cbind(c(1), c(1))
fit2 &lt;- cv.CGEInfo(E, G, Y,family='gaussian', S_G=S_G, S_GE=S_GE,lam1=0.4,lam2=0.4)
</code></pre>

<hr>
<h2 id='cv.GEInfo'>Cross-validation for GEInfo</h2><span id='topic+cv.GEInfo'></span>

<h3>Description</h3>

<p>Does k-fold cross-validation for GEInfo approach,
which adaptively accommodates the quality of the prior information and automatically detects the false information.
Tuning parameters are chosen based on a user given criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.GEInfo(
  E,
  G,
  Y,
  family,
  S_G,
  S_GE,
  nfolds = 3,
  xi = 6,
  epsilon = 0,
  max.it = 500,
  thresh = 0.001,
  criterion = "BIC",
  Type_Y = NULL,
  kappa1 = NULL,
  kappa2 = NULL,
  lam1 = NULL,
  lam2 = NULL,
  tau = c(0, 0.25, 0.5, 0.75, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.GEInfo_+3A_e">E</code></td>
<td>
<p>Observed matrix of E variables, of dimensions n x q.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_g">G</code></td>
<td>
<p>Observed matrix of G variables, of dimensions n x p.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_y">Y</code></td>
<td>
<p>Response variable, of length n. Quantitative for family=&quot;gaussian&quot;, or family=&quot;poisson&quot; (non-negative counts). For family=&quot;binomial&quot; should be a factor with two levels.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_family">family</code></td>
<td>
<p>Model type: one of (&quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;).</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_s_g">S_G</code></td>
<td>
<p>A user supplied vector, denoting the subscript of G variables which have prior information.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_s_ge">S_GE</code></td>
<td>
<p>A user supplied matrix, denoting the subscript of GE interactions which have prior information.
The first and second columns of S_GE represent the subscript of G variable and the subscript of E variable, respectively.
For example, S_GE = matrix( c(1, 2), ncol = 2), which indicates that the 1st G variable and the 2nd E variables have an interaction effect on Y.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_nfolds">nfolds</code></td>
<td>
<p>Number of folds. Default is 3.
Although nfolds can be as large as the sample size n (leave-one-out CV), it is not recommended for large datasets. Smallest value allowable is nfolds=3</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_xi">xi</code></td>
<td>
<p>Tuning parameter of MCP penalty. Default is 6.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_epsilon">epsilon</code></td>
<td>
<p>Tuning parameter of Ridge penalty which shrinks on the coefficients having prior information. Default is 0.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations (total across entire path). Default is 500.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_thresh">thresh</code></td>
<td>
<p>Convergence threshold for group coordinate descent algorithm. The algorithm iterates until the change for each coefficient is less than thresh. Default is 1e-3.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_criterion">criterion</code></td>
<td>
<p>Criterion used for tuning selection via cross-validation. Currently five options: MSE, AIC, BIC, EBIC, GCV. Default is BIC. See Details.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_type_y">Type_Y</code></td>
<td>
<p>A vector of Type_Y prior information, having the same length with Y. Default is NULL.
For family=&quot;gaussian&quot;, Type_Y is continuous. For family=&quot;binomial&quot;, Type_Y is binary.
For family=&quot;poisson&quot;, Type_Y is count.
If users supply a Type_Y prior information, this function will use it to estimate a GEInfo model. If Type_Y=NULL,
the function will incorporate the prior information included in S_G and S_GE to realize a GEInfo model.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_kappa1">kappa1</code></td>
<td>
<p>A user supplied kappa1 sequence. Default is kappa1=NULL.
Typical usage is to have the program compute its own kappa1 sequence. Supplying a value of kappa1 overrides this. See Details.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_kappa2">kappa2</code></td>
<td>
<p>A user supplied kappa2 sequence. Default is kappa2=NULL.
Typical usage is to have the program compute its own kappa2 sequence. Supplying a value of kappa2 overrides this. See Details.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_lam1">lam1</code></td>
<td>
<p>A user supplied lambda1 sequence. Default is lam1=NULL.
Typical usage is to have the program compute its own lambda1 sequence. Supplying a value of lam1 overrides this. See Details.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_lam2">lam2</code></td>
<td>
<p>A user supplied lambda2 sequence. Default is lam2=NULL.
Typical usage is to have the program compute its own lambda1 sequence. Supplying a value of lam2 overrides this. See Details.</p>
</td></tr>
<tr><td><code id="cv.GEInfo_+3A_tau">tau</code></td>
<td>
<p>A user supplied tau sequence ranging from 0 to 1.
Default is tau = c (0, 0.25,0.5,0.75,1). See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function contains five tuning parameters, namely kappa1, kappa2, lambda1, lambda2, and tau.
kappa1 and kappa2 are used to estimate model and select variables.
lambda1 and lambda2 are used to calculate the prior-predicted response based on S_G and S_GE.
tau is used for balancing between the observed response Y and the prior-predicted response.
When tau=0 and tau=1, this function realizes cross-validation for GEsgMCP and CGEInfo approaches, respectively.
</p>
<p>In order to select the optimal tuning combination, there are five criteria available, which are MSE, AIC, BIC, GCV, and EBIC. Let L be the loss function of the model,
<code class="reqn">MSE=L</code>, <code class="reqn">AIC=2L+2df</code>, <code class="reqn">BIC=2L+ln(n)df</code>, <code class="reqn">GCV=2L/(1-df/n)^2</code>,
and <code class="reqn">EBIC=2L+ln(n)df + 2df ln(nvar) (1-ln(n)/(2ln(nvar)))</code>.
In most cases, BIC is a good choice. In the case of high dimension, EBIC criterion is recommended first,
which has demonstrated satisfactory performance in high-dimensional studies.
</p>


<h3>Value</h3>

<p>An object of class &quot;GEInfo&quot; is returned, which is a list with the ingredients of the cross-validation fit.
</p>
<table role = "presentation">
<tr><td><code>coef.all.tau</code></td>
<td>
<p>A matrix of coefficients, of dimensions (p+1)(q+1) x length(tau).</p>
</td></tr>
<tr><td><code>best.tuning</code></td>
<td>
<p>A list containing the optimal tau, kappa1, and kappa2.</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>Coefficient vector of length q for E variables.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Coefficient vector of length p for E variables.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Coefficient matrix of dimensions p*q for G-E interactions.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Coefficient vector of length (q+1)p for W (G variables and G-E interactions).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Intercept.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A coefficient vector of length (q+1)(p+1), including the estimates for <code class="reqn">\alpha</code> (intercept), <code class="reqn">a</code> (coefficients for all E variables), and <code class="reqn">b</code> (coefficients for all G variables and G-E interactions).</p>
</td></tr>
<tr><td><code>nvar</code></td>
<td>
<p>Number of non-zero coefficients at the best tunings.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wang X, Xu Y, and Ma S. (2019). Identifying gene-environment interactions incorporating prior information. Statistics in medicine, 38(9): 1620-1633. doi: <a href="https://doi.org/10.1002/sim.8064">10.1002/sim.8064</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 30; p &lt;- 4; q &lt;- 2
E &lt;- MASS::mvrnorm(n, rep(0,q), diag(q))
G &lt;- MASS::mvrnorm(n, rep(0,p), diag(p))
W &lt;- matW(E, G)
alpha &lt;- 0; a &lt;- seq(0.4, 0.6, length=q);
beta &lt;- c(seq(0.2, 0.5, length=2), rep(0, p-2))
vector.gamma &lt;- c(0.8, 0.9, 0, 0)
gamma &lt;- matrix(c(vector.gamma, rep(0, p*q - length(vector.gamma))), nrow=p, byrow=TRUE)
mat.b.gamma &lt;- cbind(beta, gamma)
b &lt;- as.vector(t(mat.b.gamma))
Y &lt;- alpha + E %*% a + W %*% b + rnorm (n, 0, 0.5)
S_G &lt;- c(1)
S_GE &lt;- cbind(c(1), c(1))
fit4 &lt;- cv.GEInfo(E, G, Y, family='gaussian', S_G=S_G,
 S_GE=S_GE,lam1=0.4,lam2=0.4,kappa1 = 0.4,kappa2=0.4,tau=0.5)
</code></pre>

<hr>
<h2 id='GEInfo'>GEInfo approach with fixed tunings</h2><span id='topic+GEInfo'></span>

<h3>Description</h3>

<p>Realize to estimate the GEInfo approach at fixed tunings.
It is available for Linear, Logistic, and Poisson regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GEInfo(
  E,
  G,
  Y,
  family,
  S_G,
  S_GE,
  kappa1,
  kappa2,
  lam1,
  lam2,
  tau,
  xi = 6,
  epsilon = 0,
  max.it = 500,
  thresh = 0.001,
  Type_Y = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GEInfo_+3A_e">E</code></td>
<td>
<p>Observed matrix of E variables, of dimensions n x q.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_g">G</code></td>
<td>
<p>Observed matrix of G variables, of dimensions n x p.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_y">Y</code></td>
<td>
<p>Response variable, of length n. Quantitative for family=&quot;gaussian&quot;, or family=&quot;poisson&quot; (non-negative counts). For family=&quot;binomial&quot; should be a factor with two levels.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_family">family</code></td>
<td>
<p>Model type: one of (&quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;).</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_s_g">S_G</code></td>
<td>
<p>A user supplied vector, denoting the subscript of G variables which have prior information.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_s_ge">S_GE</code></td>
<td>
<p>A user supplied matrix, denoting the subscript of G-E interactions which have prior information.
The first and second columns of S_GE represent the subscript of G variable and the subscript of E variable, respectively.
For example, S_GE = matrix( c(1, 2), ncol = 2), which indicates that the 1st G variable and the 2nd E variable have an interaction effect on Y.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_kappa1">kappa1</code></td>
<td>
<p>A user supplied kappa1.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_kappa2">kappa2</code></td>
<td>
<p>A user supplied kappa2.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_lam1">lam1</code></td>
<td>
<p>A user supplied lambda1.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_lam2">lam2</code></td>
<td>
<p>A user supplied lambda2.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_tau">tau</code></td>
<td>
<p>A user supplied tau.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_xi">xi</code></td>
<td>
<p>Tuning parameter of MCP penalty. Default is 6.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_epsilon">epsilon</code></td>
<td>
<p>Tuning parameter of Ridge penalty which shrinks on the coefficients having prior information. Default is 0.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations (total across entire path). Default is 500.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_thresh">thresh</code></td>
<td>
<p>Convergence threshold for group coordinate descent algorithm. The algorithm iterates until the change for each coefficient is less than thresh. Default is 1e-3.</p>
</td></tr>
<tr><td><code id="GEInfo_+3A_type_y">Type_Y</code></td>
<td>
<p>A vector of Type_Y prior information, having the same length with Y. Default is NULL.
For family=&quot;gaussian&quot;, Type_Y is continuous. For family=&quot;binomial&quot;, Type_Y is binary.
For family=&quot;poisson&quot;, Type_Y is a count vector.
If users supply a Type_Y prior information, the function will use it to estimate a GEInfo model. If Type_Y=NULL,
the function will incorporate the Type_S prior information S_G and S_GE to realize a GEInfo model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function contains five tuning parameters, namely kappa1, kappa2, lambda1, lambda2, and tau.
kappa1 and kappa2 are used to estimate model and select variables.
lambda1 and lambda2 are used to calculate the prior-predicted response based on S_G and S_GE.
tau is used for balancing between the observed response Y and the prior-predicted response.
</p>


<h3>Value</h3>

<p>An object of class &quot;GEInfo&quot; is returned, which is a list with the ingredients of the cross-validation fit.
</p>
<table role = "presentation">
<tr><td><code>a</code></td>
<td>
<p>Coefficient vector of length q for E variables.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Coefficient vector of length (q+1)p for W (G variables and G-E interactions).</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Coefficient vector of length p for G variables.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Coefficient matrix of dimensions p*q for G-E interactions.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Intercept.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A coefficient vector of length (q+1)*(p+1), including the estimates for <code class="reqn">\alpha</code> (intercept), <code class="reqn">a</code> (coefficients for all E variables), and <code class="reqn">b</code> (coefficients for all G variables and G-E interactions).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wang X, Xu Y, and Ma S. (2019). Identifying gene-environment interactions incorporating prior information. Statistics in medicine, 38(9): 1620-1633. doi: <a href="https://doi.org/10.1002/sim.8064">10.1002/sim.8064</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 30; p &lt;- 4; q &lt;- 2
E &lt;- MASS::mvrnorm(n, rep(0,q), diag(q))
G &lt;- MASS::mvrnorm(n, rep(0,p), diag(p))
W &lt;- matW(E, G)
alpha &lt;- 0; a &lt;- seq(0.4, 0.6, length=q);
beta &lt;- c(seq(0.2, 0.5, length=2), rep(0, p-2))
vector.gamma &lt;- c(0.8, 0.9, 0, 0)
gamma &lt;- matrix(c(vector.gamma, rep(0, p*q - length(vector.gamma))), nrow=p, byrow=TRUE)
mat.b.gamma &lt;- cbind(beta, gamma)
b &lt;- as.vector(t(mat.b.gamma))              # coefficients of G and GE
Y &lt;- alpha + E %*% a + W %*% b + rnorm (n, 0, 0.5)
S_G &lt;- c(1)
S_GE &lt;- cbind(c(1), c(1))
fit3 &lt;- GEInfo(E, G, Y, family='gaussian', S_G=S_G,
S_GE=S_GE,kappa1 = 0.2,kappa2=0.2,lam1=0.2,lam2=0.2,tau=0.5)
</code></pre>

<hr>
<h2 id='matW'>Calculate matrix W</h2><span id='topic+matW'></span>

<h3>Description</h3>

<p>Calculate observed matrix W for all G variables and G-E interactions. Denote Wj as the n x (q+1) sub-matrix of W corresponding the jth G variable.
The first column of Wj is the observation vector of the jth G variable, and the rest q columns of Wj are observations of G-E interactions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matW(E, G)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matW_+3A_e">E</code></td>
<td>
<p>Observed matrix of E variables, of dimension n x q.</p>
</td></tr>
<tr><td><code id="matW_+3A_g">G</code></td>
<td>
<p>Observed matrix of G variables, of dimensions n x p.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of dimension n x [p(q+1)].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 30; q &lt;- 3; p &lt;- 5;
E &lt;- MASS::mvrnorm (n, rep (0, q), diag (q))
G &lt;- MASS::mvrnorm (n, rep (0, p), diag (p))
W &lt;- matW (E, G)
</code></pre>

<hr>
<h2 id='plot.GEInfo'>Heatmap of the identification results</h2><span id='topic+plot.GEInfo'></span>

<h3>Description</h3>

<p>Plot the heatmap for all E variables, identified G variables, and their G-E interactions from a fitted (GEInfo) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEInfo'
plot(x, Gname = NULL, Ename = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.GEInfo_+3A_x">x</code></td>
<td>
<p>A fitted &quot;GEInfo&quot; model object for which prediction is desired.</p>
</td></tr>
<tr><td><code id="plot.GEInfo_+3A_gname">Gname</code></td>
<td>
<p>Names of all G variables. Default is NULL.</p>
</td></tr>
<tr><td><code id="plot.GEInfo_+3A_ename">Ename</code></td>
<td>
<p>Names of all E variables. Default is NULL.</p>
</td></tr>
<tr><td><code id="plot.GEInfo_+3A_...">...</code></td>
<td>
<p>Other parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Heatmap.
</p>

<hr>
<h2 id='plot.PubMed'>Visualize the prior information</h2><span id='topic+plot.PubMed'></span>

<h3>Description</h3>

<p>Visualize the prior counts for G variables and G-E interactions. It reports a bar chart for the top 40 G variables by prior count and
a boxplot of prior counts for all G variables. For each E variables, it draws a bar chart for the corresponding top 20 G-E interactions by prior count.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PubMed'
plot(x, G.count = NULL, GE.count = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.PubMed_+3A_x">x</code></td>
<td>
<p>A 'PubMed' object for which visualization is desired.</p>
</td></tr>
<tr><td><code id="plot.PubMed_+3A_g.count">G.count</code></td>
<td>
<p>A numeric vector of length p, including prior counts for all G variables. Default is NULL.</p>
</td></tr>
<tr><td><code id="plot.PubMed_+3A_ge.count">GE.count</code></td>
<td>
<p>A numeric matrix of dimensions p*q, including prior counts for G-E interactions. Default is NULL.</p>
</td></tr>
<tr><td><code id="plot.PubMed_+3A_...">...</code></td>
<td>
<p>Other parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output includes bar chart for top G variables and G-E interactions by prior counts, and boxplot of prior counts for all G variables.
</p>

<hr>
<h2 id='predict.GEInfo'>Make Predictions for a fitted model</h2><span id='topic+predict.GEInfo'></span>

<h3>Description</h3>

<p>Output predicted response values for new observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEInfo'
predict(object, Enew, Gnew, family, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.GEInfo_+3A_object">object</code></td>
<td>
<p>A fitted &quot;GEInfo&quot; model object for which prediction is desired.</p>
</td></tr>
<tr><td><code id="predict.GEInfo_+3A_enew">Enew</code></td>
<td>
<p>Matrix of dimensions <code class="reqn">n_test x q</code> for E variables at which predictions are to be made.</p>
</td></tr>
<tr><td><code id="predict.GEInfo_+3A_gnew">Gnew</code></td>
<td>
<p>Matrix of dimensions <code class="reqn">n_test x p</code>for G variables at which predictions are to be made.</p>
</td></tr>
<tr><td><code id="predict.GEInfo_+3A_family">family</code></td>
<td>
<p>Model type: one of (&quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;).</p>
</td></tr>
<tr><td><code id="predict.GEInfo_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a vector of length <code class="reqn">n_test</code>, representing the fitted response value. For family= “gaussian”, the fitted values are returned;
for family = “binary”, the fitted probabilities are returned;
for family = “poisson”, the fitted means are returned.
</p>

<hr>
<h2 id='PubMed.search'>Search prior counts for G variables and G-E interactions</h2><span id='topic+PubMed.search'></span>

<h3>Description</h3>

<p>Provide an available tool for mining prior counts for G variables and G-E interactions from PubMed database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PubMed.search(Yname, Gname, Ename, Gnamefile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PubMed.search_+3A_yname">Yname</code></td>
<td>
<p>A user supplied character including disease name such as &quot;breast&quot;.</p>
</td></tr>
<tr><td><code id="PubMed.search_+3A_gname">Gname</code></td>
<td>
<p>A user supplied character vector including all G variable names.</p>
</td></tr>
<tr><td><code id="PubMed.search_+3A_ename">Ename</code></td>
<td>
<p>A user supplied character vector including all E variable names.</p>
</td></tr>
<tr><td><code id="PubMed.search_+3A_gnamefile">Gnamefile</code></td>
<td>
<p>A newline-delimited text file uploaded by users that contains all the G variable names to be searched. Each row represents a G variable name.
It provides another way to input G variable names besides from argument &quot;Gname&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return the searched frequencies.
</p>
<table role = "presentation">
<tr><td><code>G.count</code></td>
<td>
<p>A numeric vector, presenting the prior counts for all searched G variables.</p>
</td></tr>
<tr><td><code>GE.count</code></td>
<td>
<p>A numeric matrix of dimensions length(Gname) x length(Ename), which presents the prior counts
for all G variables (Gname) and E variables (Ename) comparisons</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>Yname &lt;- c('breast')
Gname &lt;- c('CAMP')
Ename &lt;- c('Age')
res &lt;- PubMed.search(Yname,Gname,Ename)
res
</code></pre>

<hr>
<h2 id='TypeS'>Construct Type_S prior information</h2><span id='topic+TypeS'></span>

<h3>Description</h3>

<p>For G variables and G-E interactions, transform their prior information from counts(frequencies) into a set of significant variables (Type_S)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TypeS(
  G.count,
  GE.count,
  eta_G = 0.95,
  eta_GE = 0.95,
  varphi_G = NULL,
  varphi_GE = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TypeS_+3A_g.count">G.count</code></td>
<td>
<p>A numeric vector, including the prior counts (frequencies) for G variables.</p>
</td></tr>
<tr><td><code id="TypeS_+3A_ge.count">GE.count</code></td>
<td>
<p>A numeric matrix, including the prior counts (frequencies) for G-E interactions.</p>
</td></tr>
<tr><td><code id="TypeS_+3A_eta_g">eta_G</code></td>
<td>
<p>A probability. The (eta_G)th quantile of G.count is used as a count (frequency) threshold (denoted by varphi_G) for G variables.
Default is 0.95.</p>
</td></tr>
<tr><td><code id="TypeS_+3A_eta_ge">eta_GE</code></td>
<td>
<p>A probability. The (eta_GE)th quantile of GE.count is used as a data-dependent count (frequency) threshold (denoted by varphi_GE) for G-E interactions.
Default is 0.95.</p>
</td></tr>
<tr><td><code id="TypeS_+3A_varphi_g">varphi_G</code></td>
<td>
<p>A user supplied  count threshold for G variables. It is used to determine which G variables will be finally included in the Type_S prior information set. Default is NULL.
Typical usage is to have the program calculate the (eta_G)th quantile of G.count as the threshold. Supplying a varphi_G value will override this.</p>
</td></tr>
<tr><td><code id="TypeS_+3A_varphi_ge">varphi_GE</code></td>
<td>
<p>A user supplied threshold value used for G-E interactions. It is used to determine which G-E interactions will be finally included in the Type_S prior information set. Default is NULL.
Typical usage is to have the program calculate the (eta_GE)th quantile of GE.count as the threshold. Supplying a varphi_GE value will override this.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The outputs include the Type_S prior information sets for G variable and G-E interactions.
</p>
<table role = "presentation">
<tr><td><code>S_G</code></td>
<td>
<p>A numeric vector, denoting the Type_S set for G variables. For j in S_G, the jth G variable
is suggested to be associated with the response.</p>
</td></tr>
<tr><td><code>S_GE</code></td>
<td>
<p>A numeric matrix, denoting the Type_S set for G-E interactions. For (l,k) in S_GE,the lth G variable
and the kth E variable is suggested to have an interaction effect on the response.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>G.count&lt;-c(100,300)
GE.count&lt;-matrix(c(130,356,8,30,87,2),nrow=2)
TypeS(G.count,GE.count)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
