<!DOCTYPE html><html><head><title>Help for package spatstat.Knet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spatstat.Knet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Knet'>
<p>Geometrically-Corrected K Function on Network</p></a></li>
<li><a href='#Knetinhom'>
<p>Geometrically-Corrected Inhomogeneous K Function on Network</p></a></li>
<li><a href='#spatstat.Knet-package'>
<p>Extension to 'spatstat' for Large Datasets on a Linear Network</p></a></li>
<li><a href='#wacrashes'>
<p>Road Accidents in Western Australia</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extension to 'spatstat' for Large Datasets on a Linear Network</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-12</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), spatstat.data (&ge; 3.0), spatstat.sparse (&ge;
3.0), spatstat.geom (&ge; 3.0), spatstat.random (&ge; 3.0),
spatstat.explore, spatstat.model, spatstat.linnet (&ge; 3.0),
spatstat (&ge; 3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>spatstat.utils (&ge; 3.0), Matrix</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adrian Baddeley &lt;Adrian.Baddeley@curtin.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Extension to the 'spatstat' family of packages, for analysing
	     large datasets of spatial points on a network. The geometrically-
	     corrected K function is computed using a memory-efficient
	     tree-based algorithm described by Rakshit, Baddeley and Nair (2019).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-12 10:41:46 UTC; adrian</td>
</tr>
<tr>
<td>Author:</td>
<td>Suman Rakshit <a href="https://orcid.org/0000-0003-0052-128X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Adrian Baddeley <a href="https://orcid.org/0000-0001-9499-8382"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-13 05:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='Knet'>
Geometrically-Corrected K Function on Network
</h2><span id='topic+Knet'></span>

<h3>Description</h3>

<p>Compute the geometrically-corrected <code class="reqn">K</code> function
for a point pattern on a linear network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Knet(X, r = NULL, freq, ..., verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Knet_+3A_x">X</code></td>
<td>

<p>Point pattern on a linear network (object of class <code>"lpp"</code>).
</p>
</td></tr>
<tr><td><code id="Knet_+3A_r">r</code></td>
<td>

<p>Optional. Numeric vector of values of the function argument <code class="reqn">r</code>. There is a sensible default.
</p>
</td></tr>
<tr><td><code id="Knet_+3A_freq">freq</code></td>
<td>

<p>Vector of frequencies corresponding to the point events on the
network. The length of this vector should be equal to the number
of points on the network. The default 
frequency is one for every point on the network.
</p>
</td></tr>
<tr><td><code id="Knet_+3A_...">...</code></td>
<td>

<p>Ignored.
</p>
</td></tr>
<tr><td><code id="Knet_+3A_verbose">verbose</code></td>
<td>

<p>A logical for printing iteration number corresponding
to each point event on the network.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the geometrically-corrected <code class="reqn">K</code> function,
proposed by Ang et al (2012), from point pattern data on a linear
network. 
The algorithm used in this computation is discussed in Rakshit et al (2019).
</p>
<p>The <span class="pkg">spatstat</span> function <code><a href="spatstat.linnet.html#topic+linearK">linearK</a></code>
is usable (and slightly faster) for the same purpose
for small datasets, but requires substantial amounts of memory.
For larger datasets, the function  <code>Knet</code> is much more efficient.
</p>


<h3>Value</h3>

<p>Function value table (object of class <code>"fv"</code>).
</p>


<h3>Author(s)</h3>

<p>Suman Rakshit (modified by Adrian Baddeley)
</p>


<h3>References</h3>

<p>Ang, Q.W., Baddeley, A. and Nair, G. (2012)
Geometrically corrected second-order analysis of 
events on a linear network, with applications to
ecology and criminology.
<em>Scandinavian Journal of Statistics</em> <b>39</b>, 591&ndash;617.
</p>
<p>Rakshit, S., Baddeley, A. and Nair, G. (2019)
Efficient code for second order analysis of events on a linear network.
<em>Journal of Statistical Software</em> <b>90</b> (1) 1&ndash;37.
DOI: <code>10.18637/jss.v090.i01</code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   UC &lt;- unmark(chicago)
   r &lt;- seq(0, 1000, length = 41)
   K &lt;- Knet(UC, r = r)
</code></pre>

<hr>
<h2 id='Knetinhom'>
Geometrically-Corrected Inhomogeneous K Function on Network
</h2><span id='topic+Knetinhom'></span>

<h3>Description</h3>

<p>Compute the geometrically-corrected inhomogeneous <code class="reqn">K</code> function
for a point pattern on a linear network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Knetinhom(X, lambda, r = NULL, freq, ..., verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Knetinhom_+3A_x">X</code></td>
<td>

<p>Point pattern on a linear network (object of class <code>"lpp"</code>).
</p>
</td></tr>
<tr><td><code id="Knetinhom_+3A_lambda">lambda</code></td>
<td>

<p>Fitted intensity of the point process. Either a numeric vector
giving values of the fitted intensity at each data point of
<code>X</code>, or an object of class
<code>"linim"</code>, <code>"linfun"</code> or <code>"lppm"</code> from which the
fitted intensity at each data point can be extracted.
</p>
</td></tr>
<tr><td><code id="Knetinhom_+3A_r">r</code></td>
<td>

<p>Optional. Numeric vector of values of the function argument
<code class="reqn">r</code>. There is a sensible default.
</p>
</td></tr>
<tr><td><code id="Knetinhom_+3A_freq">freq</code></td>
<td>

<p>Vector of frequencies corresponding to the point events on the
network. The length of this vector should be equal to the
number of points on the network. The default 
frequency is one for every point on the network.
</p>
</td></tr>
<tr><td><code id="Knetinhom_+3A_...">...</code></td>
<td>

<p>Ignored.
</p>
</td></tr>
<tr><td><code id="Knetinhom_+3A_verbose">verbose</code></td>
<td>

<p>Logical value indicating whether to print progress reports
during the computation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the inhomogeneous version of the
geometrically-corrected <code class="reqn">K</code> function, proposed by Ang et al
(2012), from point pattern data on a linear network.
</p>
<p>The algorithm used in this computation is described in Rakshit et al (2019).
</p>
<p>The <span class="pkg">spatstat</span> function
<code><a href="spatstat.linnet.html#topic+linearKinhom">linearKinhom</a></code>
is usable (and slightly faster) for this purpose
for small datasets, but requires substantial amounts of memory.
For larger datasets,
the function <code>Knetinhom</code> is much more efficient.
</p>


<h3>Value</h3>

<p>Function value table (object of class <code>"fv"</code>).
</p>


<h3>Author(s)</h3>

<p>Suman Rakshit (modified by Adrian Baddeley)
</p>


<h3>References</h3>

<p>Ang, Q.W., Baddeley, A. and Nair, G. (2012)
Geometrically corrected second-order analysis of 
events on a linear network, with applications to
ecology and criminology.
<em>Scandinavian Journal of Statistics</em> <b>39</b>, 591&ndash;617.
</p>
<p>Rakshit, S., Baddeley, A. and Nair, G. (2019)
Efficient code for second order analysis of events on a linear network.
<em>Journal of Statistical Software</em> <b>90</b> (1) 1&ndash;37.
DOI: <code>10.18637/jss.v090.i01</code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   UC &lt;- unmark(chicago)
   fit &lt;- lppm(UC ~ x+y)
   r &lt;- seq(0, 1000, length = 41)
   K &lt;- Knetinhom(UC, lambda=fit, r = r)
</code></pre>

<hr>
<h2 id='spatstat.Knet-package'>
Extension to 'spatstat' for Large Datasets on a Linear Network
</h2><span id='topic+spatstat.Knet-package'></span>

<h3>Description</h3>

<p>Extension to the 'spatstat' family of packages, for analysing
	     large datasets of spatial points on a network. The geometrically-
	     corrected K function is computed using a memory-efficient
	     tree-based algorithm described by Rakshit, Baddeley and Nair (2019).
</p>


<h3>Details</h3>

<p>This is an extension to the <span class="pkg">spatstat</span> package
for the analysis of large data sets on linear networks.
</p>
<p>Its main functionality is a memory-efficient algorithm
for computing the estimate of the <code class="reqn">K</code> function
on a linear network, described in Rakshit et al (2019).
</p>
<p>The main functions are <code><a href="#topic+Knet">Knet</a></code> and <code><a href="#topic+Knetinhom">Knetinhom</a></code>.
These are counterparts of the functions
<code><a href="spatstat.linnet.html#topic+linearK">linearK</a></code>
and 
<code><a href="spatstat.linnet.html#topic+linearKinhom">linearKinhom</a></code>
in the <span class="pkg">spatstat.linnet</span> package.
</p>
<p>The <span class="pkg">spatstat.linnet</span> functions
<code><a href="spatstat.linnet.html#topic+linearK">linearK</a></code>
and 
<code><a href="spatstat.linnet.html#topic+linearKinhom">linearKinhom</a></code>
are usable (and slightly faster)
for small datasets, but require substantial amounts of memory.
For larger datasets,
the functions  <code><a href="#topic+Knet">Knet</a></code> and <code><a href="#topic+Knetinhom">Knetinhom</a></code>
are much more efficient.
</p>
<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> spatstat.Knet</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Extension to 'spatstat' for Large Datasets on a Linear Network</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 3.0-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-11-12</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.5.0), spatstat.data (&gt;= 3.0), spatstat.sparse (&gt;= 3.0), spatstat.geom (&gt;= 3.0), spatstat.random (&gt;= 3.0), spatstat.explore, spatstat.model, spatstat.linnet (&gt;= 3.0), spatstat (&gt;= 3.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> spatstat.utils (&gt;= 3.0), Matrix</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person(given="Suman",
		    family="Rakshit",
		    role = c("aut", "cph"),
     		    email = "suman.rakshit@curtin.edu.au",
		    comment=c(ORCID="0000-0003-0052-128X")),
	     person(given="Adrian",
	            family="Baddeley",
		    role = c("cre", "cph"),
       	            email = "Adrian.Baddeley@curtin.edu.au",
		    comment = c(ORCID="0000-0001-9499-8382")))</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Adrian Baddeley &lt;Adrian.Baddeley@curtin.edu.au&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Extension to the 'spatstat' family of packages, for analysing
	     large datasets of spatial points on a network. The geometrically-
	     corrected K function is computed using a memory-efficient
	     tree-based algorithm described by Rakshit, Baddeley and Nair (2019).</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
NeedsCompilation: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
ByteCompile: </td><td style="text-align: left;"> true</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Suman Rakshit [aut, cph] (&lt;https://orcid.org/0000-0003-0052-128X&gt;),
  Adrian Baddeley [cre, cph] (&lt;https://orcid.org/0000-0001-9499-8382&gt;)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
Knet                    Geometrically-Corrected K Function on Network
Knetinhom               Geometrically-Corrected Inhomogeneous K
                        Function on Network
spatstat.Knet-package   Extension to 'spatstat' for Large Datasets on a
                        Linear Network
wacrashes               Road Accidents in Western Australia
</pre>


<h3>Author(s)</h3>

<p>NA
</p>
<p>Maintainer: Adrian Baddeley &lt;Adrian.Baddeley@curtin.edu.au&gt;
</p>


<h3>References</h3>

<p>Rakshit, S., Baddeley, A. and Nair, G. (2019)
Efficient code for second order analysis of events on a linear network.
<em>Journal of Statistical Software</em> <b>90</b> (1) 1&ndash;37.
DOI: <code>10.18637/jss.v090.i01</code> 
</p>

<hr>
<h2 id='wacrashes'>
Road Accidents in Western Australia
</h2><span id='topic+wacrashes'></span>

<h3>Description</h3>

<p>This dataset gives the spatial locations of all road accidents
recorded in the state of Western Australia for the year 2011, on the
state road network.
</p>
<p>These data were published and analysed in Rakshit et al (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wacrashes)</code></pre>


<h3>Format</h3>

<p>A object of class <code>"lpp"</code> representing the spatial point pattern
of accident locations on the network of roads in Western Australia.
</p>


<h3>Details</h3>

<p>The road network has 88,512 intersections and 115,169 road segments.
The spatial coordinates are expressed in metres, and the
total network length is 97,165,540 metres (97,165 km).
The number of accident locations on the network is 14,562.
</p>


<h3>Source</h3>

<p>Main Roads, Western Australia.
Made available as part of the Western Australian
Whole of Government Open Data Policy. 
</p>


<h3>References</h3>

<p>Rakshit, S., Baddeley, A. and Nair, G. (2019)
Efficient code for second order analysis of events on a linear network.
<em>Journal of Statistical Software</em> <b>90</b> (1) 1&ndash;37.
DOI: <code>10.18637/jss.v090.i01</code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(wacrashes)
  wacrashes
  summary(wacrashes)
  plot(wacrashes, cols="red", cex=0.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
