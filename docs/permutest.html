<!DOCTYPE html><html lang="en"><head><title>Help for package permutest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {permutest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adjust_p_value'><p>Adjust p-values for multiple testing</p></a></li>
<li><a href='#diff_in_means'><p>Calculate difference in means</p></a></li>
<li><a href='#diff_in_medians'><p>Calculate difference in medians</p></a></li>
<li><a href='#fisher'><p>Fisher combining function</p></a></li>
<li><a href='#liptak'><p>Liptak combining function</p></a></li>
<li><a href='#npc'><p>Run NPC</p></a></li>
<li><a href='#one_sample'><p>One-sample permutation test</p></a></li>
<li><a href='#one_sample_mean'><p>Calculate the one-sample problem test statistic</p></a></li>
<li><a href='#one_way_anova_stat'><p>Calculate one-way anova test statistic</p></a></li>
<li><a href='#permutation_test'><p>Run permutation test</p></a></li>
<li><a href='#permutation_test_ci'><p>Construct confidence interval by inverting permutation tests</p></a></li>
<li><a href='#permute_group'><p>Unstratified group permutation</p></a></li>
<li><a href='#permute_sign'><p>Sign permutation</p></a></li>
<li><a href='#strat_permute_group'><p>Stratified group permutation</p></a></li>
<li><a href='#tippett'><p>Tippett combining function</p></a></li>
<li><a href='#ttest_stat'><p>Calculate t-test statistic</p></a></li>
<li><a href='#two_sample'><p>Two-sample permutation test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Run Permutation Tests and Construct Associated Confidence
Intervals</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements permutation tests for any test statistic and randomization scheme and constructs associated confidence intervals as described in Glazer and Stark (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2405.05238">doi:10.48550/arXiv.2405.05238</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-25 17:18:13 UTC; ag88343</td>
</tr>
<tr>
<td>Author:</td>
<td>Amanda Glazer <a href="https://orcid.org/0000-0002-3229-7924"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Amanda Glazer &lt;amanda.glazer@austin.utexas.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-26 11:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adjust_p_value'>Adjust p-values for multiple testing</h2><span id='topic+adjust_p_value'></span>

<h3>Description</h3>

<p>This function takes an array of p-values and returns adjusted p-values using
user-inputted FWER or FDR correction method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjust_p_value(pvalues, method = "holm-bonferroni")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adjust_p_value_+3A_pvalues">pvalues</code></td>
<td>
<p>Array of p-values</p>
</td></tr>
<tr><td><code id="adjust_p_value_+3A_method">method</code></td>
<td>
<p>The FWER or FDR correction to use, either 'holm-bonferroni',
'bonferroni', or 'benjamini-hochberg'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Adjusted p-values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>adjust_p_value(pvalues = c(.05, .1, .5), method='holm-bonferroni')

</code></pre>

<hr>
<h2 id='diff_in_means'>Calculate difference in means</h2><span id='topic+diff_in_means'></span>

<h3>Description</h3>

<p>This function takes a data frame, and group and outcome column names as input
and returns the difference in mean outcome between the two groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diff_in_means(df, group_col, outcome_col, treatment_value = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diff_in_means_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="diff_in_means_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="diff_in_means_+3A_outcome_col">outcome_col</code></td>
<td>
<p>The name of the column in df that corresponds to the outcome variable</p>
</td></tr>
<tr><td><code id="diff_in_means_+3A_treatment_value">treatment_value</code></td>
<td>
<p>The value of group_col to be considered 'treatment'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The difference in mean outcome between the two groups
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(group = c(rep(1, 4), rep(2, 4)),
                   outcome = c(rep(3, 4), rep(5, 4)))

diff_in_means(df = data,
              group_col = "group",
              outcome_col = "outcome",
              treatment_value = 1)

</code></pre>

<hr>
<h2 id='diff_in_medians'>Calculate difference in medians</h2><span id='topic+diff_in_medians'></span>

<h3>Description</h3>

<p>This function takes a data frame, and group and outcome column names as input
and returns the difference in median outcome between the two groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diff_in_medians(df, group_col, outcome_col, treatment_value = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diff_in_medians_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="diff_in_medians_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="diff_in_medians_+3A_outcome_col">outcome_col</code></td>
<td>
<p>The name of the column in df that corresponds to the outcome variable</p>
</td></tr>
<tr><td><code id="diff_in_medians_+3A_treatment_value">treatment_value</code></td>
<td>
<p>The value of group_col to be considered 'treatment'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The difference in median outcome between the two groups
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(group = c(rep(1, 4), rep(2, 4)),
                   outcome = c(rep(3, 4), rep(5, 4)))

diff_in_medians(df = data,
              group_col = "group",
              outcome_col = "outcome",
              treatment_value = 1)
</code></pre>

<hr>
<h2 id='fisher'>Fisher combining function</h2><span id='topic+fisher'></span>

<h3>Description</h3>

<p>This function takes an array of p-values and returns a combined p-value using fisher's combining function:
<code class="reqn">-2 \sum_i \log(p_i)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fisher(pvalues)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fisher_+3A_pvalues">pvalues</code></td>
<td>
<p>Array of p-values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Combined p-value using fisher's method
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fisher(pvalues = c(.05, .1, .5))

</code></pre>

<hr>
<h2 id='liptak'>Liptak combining function</h2><span id='topic+liptak'></span>

<h3>Description</h3>

<p>This function takes an array of p-values and returns a combined p-value using Liptak's combining function:
<code class="reqn">\sum_i \Phi^{-1}(1-p_i)</code> where <code class="reqn">\Phi</code> is the CDF of the Normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>liptak(pvalues)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="liptak_+3A_pvalues">pvalues</code></td>
<td>
<p>Array of p-values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Combined p-value using Liptak's method
</p>


<h3>Examples</h3>

<pre><code class='language-R'>liptak(pvalues = c(.05, .1, .5))

</code></pre>

<hr>
<h2 id='npc'>Run NPC</h2><span id='topic+npc'></span>

<h3>Description</h3>

<p>This function takes a data frame and group and outcome column names as input
and returns the nonparametric combination of tests (NPC) omnibus p-value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npc(
  df,
  group_col,
  outcome_cols,
  strata_col = NULL,
  test_stat = "diff_in_means",
  perm_func = permute_group,
  combn = "fisher",
  shift = 0,
  reps = 10000,
  perm_set = NULL,
  complete_enum = FALSE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="npc_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="npc_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="npc_+3A_outcome_cols">outcome_cols</code></td>
<td>
<p>The names of the columns in df that corresponds to the outcome variable</p>
</td></tr>
<tr><td><code id="npc_+3A_strata_col">strata_col</code></td>
<td>
<p>The name of the column in df that corresponds to the strata</p>
</td></tr>
<tr><td><code id="npc_+3A_test_stat">test_stat</code></td>
<td>
<p>Test statistic function</p>
</td></tr>
<tr><td><code id="npc_+3A_perm_func">perm_func</code></td>
<td>
<p>Function to permute group, default is permute_group which randomly permutes group assignment</p>
</td></tr>
<tr><td><code id="npc_+3A_combn">combn</code></td>
<td>
<p>Combining function method to use, takes values 'fisher', 'tippett', or 'liptak', or a user defined function</p>
</td></tr>
<tr><td><code id="npc_+3A_shift">shift</code></td>
<td>
<p>Value of shift to apply in one- or two-sample problem</p>
</td></tr>
<tr><td><code id="npc_+3A_reps">reps</code></td>
<td>
<p>Number of iterations to use when calculating permutation p-value</p>
</td></tr>
<tr><td><code id="npc_+3A_perm_set">perm_set</code></td>
<td>
<p>Matrix of permutations to use instead of reps iterations of perm_func</p>
</td></tr>
<tr><td><code id="npc_+3A_complete_enum">complete_enum</code></td>
<td>
<p>Boolean, whether to calculate P-value under complete enumeration of permutations</p>
</td></tr>
<tr><td><code id="npc_+3A_seed">seed</code></td>
<td>
<p>An integer seed value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The omnibus p-value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(group = c(rep(1, 4), rep(2, 4)),
out1 = c(0, 1, 0, 0, 1, 1, 1, 0),
out2 = rep(1, 8))
output &lt;- npc(df = data, group_col = "group",
              outcome_cols = c("out1", "out2"), perm_func = permute_group,
              combn = "fisher", reps = 10^4, seed=42)

</code></pre>

<hr>
<h2 id='one_sample'>One-sample permutation test</h2><span id='topic+one_sample'></span>

<h3>Description</h3>

<p>This function runs a permutation test for the one-sample problem by calling
the permutation_test function using the one-sample mean test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>one_sample(x, shift = 0, alternative = "greater", reps = 10^4, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="one_sample_+3A_x">x</code></td>
<td>
<p>array of data</p>
</td></tr>
<tr><td><code id="one_sample_+3A_shift">shift</code></td>
<td>
<p>Value of shift to apply in one-sample problem</p>
</td></tr>
<tr><td><code id="one_sample_+3A_alternative">alternative</code></td>
<td>
<p>String, two-sided or one-sided (greater or less) p-value</p>
</td></tr>
<tr><td><code id="one_sample_+3A_reps">reps</code></td>
<td>
<p>Number of iterations to use when calculating permutation p-value</p>
</td></tr>
<tr><td><code id="one_sample_+3A_seed">seed</code></td>
<td>
<p>An integer seed value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The permutation test p-value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>one_sample(x = c(-1, 1, 2), seed = 42)

</code></pre>

<hr>
<h2 id='one_sample_mean'>Calculate the one-sample problem test statistic</h2><span id='topic+one_sample_mean'></span>

<h3>Description</h3>

<p>This function takes a data frame, and group and outcome column names as input
and returns the mean of the product of the outcome and group. This test statistic
is used for the one-sample problem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>one_sample_mean(df, group_col, outcome_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="one_sample_mean_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="one_sample_mean_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="one_sample_mean_+3A_outcome_col">outcome_col</code></td>
<td>
<p>The name of the column in df that corresponds to the outcome variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The one-sample problem test statistic: the mean of the product of the outcome and group
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(group = c(rep(1, 4), rep(2, 4)),
                   outcome = c(rep(3, 4), rep(5, 4)))

one_sample_mean(df = data,
              group_col = "group",
              outcome_col = "outcome")

</code></pre>

<hr>
<h2 id='one_way_anova_stat'>Calculate one-way anova test statistic</h2><span id='topic+one_way_anova_stat'></span>

<h3>Description</h3>

<p>This function takes a data frame, and group and outcome column names as input
and returns the one-way anova test statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>one_way_anova_stat(df, group_col, outcome_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="one_way_anova_stat_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="one_way_anova_stat_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="one_way_anova_stat_+3A_outcome_col">outcome_col</code></td>
<td>
<p>The name of the column in df that corresponds to the outcome variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The one-way anova test statistic:
<code class="reqn">\sum_{g=1}^G n_g(\overline{X_g} - \overline{X})^2</code> where <code class="reqn">g</code> indexes the groups
</p>

<hr>
<h2 id='permutation_test'>Run permutation test</h2><span id='topic+permutation_test'></span>

<h3>Description</h3>

<p>Run permutation test with user inputted data, test statistic, and permutation function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permutation_test(
  df,
  group_col,
  outcome_col,
  strata_col = NULL,
  test_stat = "diff_in_means",
  perm_func = permute_group,
  alternative = "two-sided",
  shift = 0,
  reps = 10000,
  perm_set = NULL,
  complete_enum = FALSE,
  return_test_dist = FALSE,
  return_perm_dist = FALSE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permutation_test_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_outcome_col">outcome_col</code></td>
<td>
<p>The name of the column in df that corresponds to the outcome variable</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_strata_col">strata_col</code></td>
<td>
<p>The name of the column in df that corresponds to the strata</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_test_stat">test_stat</code></td>
<td>
<p>Test statistic function</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_perm_func">perm_func</code></td>
<td>
<p>Function to permute group</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_alternative">alternative</code></td>
<td>
<p>String, two-sided or one-sided (greater or less) p-value; options are 'greater', 'less', or 'two-sided'</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_shift">shift</code></td>
<td>
<p>Value of shift to apply in one- or two-sample problem</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_reps">reps</code></td>
<td>
<p>Number of iterations to use when calculating permutation p-value</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_perm_set">perm_set</code></td>
<td>
<p>Matrix of group assignments to use instead of reps iterations of perm_func</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_complete_enum">complete_enum</code></td>
<td>
<p>Boolean, whether to calculate P-value under complete enumeration of permutations</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_return_test_dist">return_test_dist</code></td>
<td>
<p>Boolean, whether to return test statistic distribution under permutations</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_return_perm_dist">return_perm_dist</code></td>
<td>
<p>Boolean, whether to return a matrix where each row is the group assignment under that permutation</p>
</td></tr>
<tr><td><code id="permutation_test_+3A_seed">seed</code></td>
<td>
<p>An integer seed value</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>p_value</code>: the permutation test p-value
</p>
<p><code>test_stat_dist</code>: array, the distribution of the test statistic under the set of permutations,
if return_test_dist is set to TRUE
</p>
<p><code>perm_indices_mat</code>: matrix, each row corresponds to a permutation used
in the permutation test calculation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(group = c(rep(1, 10), rep(2, 10)), outcome = c(rep(1, 10), rep(1, 10)))

permutation_test(df = data, group_col = "group", outcome_col = "outcome",
test_stat = "diff_in_means", perm_func = permute_group, alternative = "greater",
shift = 0, reps = 10, return_perm_dist = TRUE, return_test_dist = TRUE, seed = 42)

</code></pre>

<hr>
<h2 id='permutation_test_ci'>Construct confidence interval by inverting permutation tests</h2><span id='topic+permutation_test_ci'></span>

<h3>Description</h3>

<p>This function constructs a confidence interval by inverting permutation tests and applying the method in Glazer and Stark, 2024.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permutation_test_ci(
  df,
  group_col,
  outcome_col,
  strata_col = NULL,
  test_stat = "diff_in_means",
  perm_func = permute_group,
  upper_bracket = NULL,
  lower_bracket = NULL,
  cl = 0.95,
  e = 0.1,
  reps = 10000,
  perm_set = NULL,
  seed = 42
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permutation_test_ci_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_outcome_col">outcome_col</code></td>
<td>
<p>The name of the column in df that corresponds to the outcome variable</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_strata_col">strata_col</code></td>
<td>
<p>The name of the column in df that corresponds to the strata</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_test_stat">test_stat</code></td>
<td>
<p>Test statistic function</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_perm_func">perm_func</code></td>
<td>
<p>Function to permute group</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_upper_bracket">upper_bracket</code></td>
<td>
<p>Array with 2 values that bracket upper confidence bound</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_lower_bracket">lower_bracket</code></td>
<td>
<p>Array with 2 values that bracket lower confidence bound</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_cl">cl</code></td>
<td>
<p>Confidence level, default 0.95</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_e">e</code></td>
<td>
<p>Maximum distance from true confidence bound value</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_reps">reps</code></td>
<td>
<p>Number of iterations to use when calculating permutation p-value</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_perm_set">perm_set</code></td>
<td>
<p>Matrix of group assignments to use instead of reps iterations of perm_func</p>
</td></tr>
<tr><td><code id="permutation_test_ci_+3A_seed">seed</code></td>
<td>
<p>An integer seed value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the permutation test p-value, and the test statistic distribution if applicable
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(35.3, 35.9, 37.2, 33.0, 31.9, 33.7, 36.0, 35.0, 33.3, 33.6, 37.9, 35.6, 29.0, 33.7, 35.7)
y &lt;- c(32.5, 34.0, 34.4, 31.8, 35.0, 34.6, 33.5, 33.6, 31.5, 33.8, 34.6)
df &lt;- data.frame(outcome = c(x, y), group = c(rep(1, length(x)), rep(0, length(y))))
permutation_test_ci(df = df, group_col = "group", outcome_col = "outcome", strata_col = NULL,
                    test_stat = "diff_in_means", perm_func = permute_group,
                    upper_bracket = NULL, lower_bracket = NULL,
                    cl = 0.95, e = 0.01, reps = 10^3, seed = 42)
</code></pre>

<hr>
<h2 id='permute_group'>Unstratified group permutation</h2><span id='topic+permute_group'></span>

<h3>Description</h3>

<p>This function takes a data frame and group column name as input
and returns the dataframe with the group column randomly permuted
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute_group(df, group_col, strata_col = NULL, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permute_group_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="permute_group_+3A_group_col">group_col</code></td>
<td>
<p>String, the name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="permute_group_+3A_strata_col">strata_col</code></td>
<td>
<p>The name of the column in df that corresponds to the strata, should be NULL for unstratified permutation</p>
</td></tr>
<tr><td><code id="permute_group_+3A_seed">seed</code></td>
<td>
<p>An integer seed value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The inputted data frame with the group column randomly shuffled
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(group_label = c(1, 2, 2, 1, 2, 1), outcome = 1:6)
permute_group(df = data, group_col = "group_label", strata_col = NULL, seed = 42)

</code></pre>

<hr>
<h2 id='permute_sign'>Sign permutation</h2><span id='topic+permute_sign'></span>

<h3>Description</h3>

<p>This function takes a data frame and group and outcome column name as input
and returns the dataframe with the group column replaced with randomly assigned signs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute_sign(df, group_col, strata_col = NULL, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permute_sign_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="permute_sign_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="permute_sign_+3A_strata_col">strata_col</code></td>
<td>
<p>The name of the column in df that corresponds to the strata, should be NULL for this function</p>
</td></tr>
<tr><td><code id="permute_sign_+3A_seed">seed</code></td>
<td>
<p>An integer seed value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The inputted data frame with the group column replaced with randomly assigned signs
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(group_label = rep(1, 6), outcome = 1:6)
permute_group(df = data, group_col = "group_label", strata_col = NULL, seed = 42)

</code></pre>

<hr>
<h2 id='strat_permute_group'>Stratified group permutation</h2><span id='topic+strat_permute_group'></span>

<h3>Description</h3>

<p>This function takes a data frame and group and strata column name as input
and returns the dataframe with the group column randomly permuted by strata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strat_permute_group(df, group_col, strata_col, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strat_permute_group_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="strat_permute_group_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="strat_permute_group_+3A_strata_col">strata_col</code></td>
<td>
<p>The name of the column in df that corresponds to the strata</p>
</td></tr>
<tr><td><code id="strat_permute_group_+3A_seed">seed</code></td>
<td>
<p>An integer seed value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The inputted data frame with the group column randomly shuffled by strata
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(group_label = c(1, 2, 2, 1, 2, 1), stratum = c(1, 1, 1, 2, 2, 2), outcome = 1:6)
permute_group(df = data, group_col = "group_label", strata_col = "stratum", seed = 42)

</code></pre>

<hr>
<h2 id='tippett'>Tippett combining function</h2><span id='topic+tippett'></span>

<h3>Description</h3>

<p>This function takes an array of p-values and returns a combined p-value using Tippett's combining function:
<code class="reqn">\max_i \{1-p_i\}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tippett(pvalues)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tippett_+3A_pvalues">pvalues</code></td>
<td>
<p>Array of p-values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Combined p-value using Tippett's method
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tippett(pvalues = c(.05, .1, .5))

</code></pre>

<hr>
<h2 id='ttest_stat'>Calculate t-test statistic</h2><span id='topic+ttest_stat'></span>

<h3>Description</h3>

<p>This function takes a data frame, and group and outcome column names as input
and returns the t test statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest_stat(df, group_col, outcome_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttest_stat_+3A_df">df</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="ttest_stat_+3A_group_col">group_col</code></td>
<td>
<p>The name of the column in df that corresponds to the group label</p>
</td></tr>
<tr><td><code id="ttest_stat_+3A_outcome_col">outcome_col</code></td>
<td>
<p>The name of the column in df that corresponds to the outcome variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The t test statistic
</p>

<hr>
<h2 id='two_sample'>Two-sample permutation test</h2><span id='topic+two_sample'></span>

<h3>Description</h3>

<p>This function runs a permutation test with difference in means test statistic
for the two-sample problem by calling
the permutation_test function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>two_sample(x, y, shift = 0, alternative = "greater", reps = 10^4, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="two_sample_+3A_x">x</code></td>
<td>
<p>array of data for treatment group</p>
</td></tr>
<tr><td><code id="two_sample_+3A_y">y</code></td>
<td>
<p>array of data for control group</p>
</td></tr>
<tr><td><code id="two_sample_+3A_shift">shift</code></td>
<td>
<p>Value of shift to apply in two-sample problem</p>
</td></tr>
<tr><td><code id="two_sample_+3A_alternative">alternative</code></td>
<td>
<p>String, two-sided or one-sided (greater or less) p-value; options are 'greater', 'less', or 'two-sided'</p>
</td></tr>
<tr><td><code id="two_sample_+3A_reps">reps</code></td>
<td>
<p>Number of iterations to use when calculating permutation p-value</p>
</td></tr>
<tr><td><code id="two_sample_+3A_seed">seed</code></td>
<td>
<p>An integer seed value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The permutation test p-value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>two_sample(x = c(10, 9, 11), y = c(12, 11, 13), alternative = "less", seed = 42)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
