<!DOCTYPE html><html lang="en"><head><title>Help for package BMA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BMA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bic.glm'><p>Bayesian Model Averaging for generalized linear models.</p></a></li>
<li><a href='#bic.surv'><p>Bayesian Model Averaging for Survival models.</p></a></li>
<li><a href='#bicreg'><p>Bayesian Model Averaging for linear regression models.</p></a></li>
<li><a href='#For.MC3.REG'><p> Helper function for MC3.REG</p></a></li>
<li><a href='#glib'><p>Model uncertainty in generalized linear models using Bayes factors</p></a></li>
<li><a href='#iBMA'><p> Iterated Bayesian Model Averaging variable selection for generalized linear models, linear models or survival models.</p></a></li>
<li><a href='#imageplot.bma'><p>Images of models used in Bayesian model averaging</p></a></li>
<li><a href='#MC3.REG'><p>Bayesian simultaneous variable selection and outlier identification</p></a></li>
<li><a href='#MC3.REG.choose'><p> Helper function to MC3.REG</p></a></li>
<li><a href='#MC3.REG.logpost'><p> Helper function to MC3.REG</p></a></li>
<li><a href='#orderplot'><p> Orderplot of iBMA objects</p></a></li>
<li><a href='#out.ltsreg'><p>out.ltsreg</p></a></li>
<li><a href='#plot.bicreg'><p> Plots the posterior distributions of coefficients derived from Bayesian model averaging</p></a></li>
<li><a href='#predict.bic.glm'><p>Predict function for Bayesian Model Averaging for generalized</p>
linear models.</a></li>
<li><a href='#predict.bicreg'><p>Predict function for Bayesian Model Averaging for linear models.</p></a></li>
<li><a href='#race'><p> Scottish Hill Racing data</p></a></li>
<li><a href='#summary.bic'><p>Summaries of Bayesian model averaging objects</p></a></li>
<li><a href='#summary.iBMA'><p>Summaries of iterated Bayesian model averaging objects</p></a></li>
<li><a href='#vaso'><p>Vaso data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>3.18.20</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-10</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Model Averaging</td>
</tr>
<tr>
<td>Description:</td>
<td>Package for Bayesian model averaging and variable selection for linear models,
        generalized linear models and survival models (cox
        regression).</td>
</tr>
<tr>
<td>Depends:</td>
<td>survival, leaps, robustbase, inline, rrcov</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hanase/BMA">https://github.com/hanase/BMA</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-11 01:18:21 UTC; hana</td>
</tr>
<tr>
<td>Author:</td>
<td>Adrian Raftery [aut],
  Jennifer Hoeting [aut],
  Chris Volinsky [aut],
  Ian Painter [aut],
  Ka Yee Yeung [aut],
  Hana Sevcikova [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hana Sevcikova &lt;hanas@uw.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-11 06:00:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='bic.glm'>Bayesian Model Averaging for generalized linear models.</h2><span id='topic+bic.glm'></span><span id='topic+bic.glm.data.frame'></span><span id='topic+bic.glm.matrix'></span><span id='topic+bic.glm.formula'></span>

<h3>Description</h3>

<p>Bayesian Model Averaging accounts for the model uncertainty inherent in the variable selection problem by averaging over the best models in the model class according to approximate posterior model probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bic.glm(x, ...)

## S3 method for class 'matrix'
bic.glm(x, y, glm.family, wt = rep(1, nrow(x)),
    strict = FALSE, prior.param = c(rep(0.5, ncol(x))), OR = 20, 
    maxCol = 30, OR.fix = 2, nbest = 150, dispersion = NULL, 
    factor.type = TRUE, factor.prior.adjust = FALSE, 
    occam.window = TRUE, call = NULL, ...)

## S3 method for class 'data.frame'
bic.glm(x, y, glm.family, wt = rep(1, nrow(x)),
    strict = FALSE, prior.param = c(rep(0.5, ncol(x))), OR = 20, 
    maxCol = 30, OR.fix = 2, nbest = 150, dispersion = NULL, 
    factor.type = TRUE, factor.prior.adjust = FALSE, 
    occam.window = TRUE, call = NULL, ...)

## S3 method for class 'formula'
bic.glm(f, data, glm.family, wt = rep(1, nrow(data)),
    strict = FALSE, prior.param = c(rep(0.5, ncol(x))), OR = 20, 
    maxCol = 30, OR.fix = 2, nbest = 150, dispersion = NULL, 
    factor.type = TRUE, factor.prior.adjust = FALSE, 
    occam.window = TRUE, na.action = na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bic.glm_+3A_x">x</code></td>
<td>
<p>a matrix or data.frame of independent variables.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_y">y</code></td>
<td>
<p>a vector of values for the dependent variable.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_f">f</code></td>
<td>
<p>a formula</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model. </p>
</td></tr>
<tr><td><code id="bic.glm_+3A_glm.family">glm.family</code></td>
<td>
<p>a description of the error distribution and link function to
be used in the model.  This can be a character string naming a
family function, a family function or the result of a call to
a family function.  (See 'family' for details of family
functions.)</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_wt">wt</code></td>
<td>
<p>an optional vector of weights to be used.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_strict">strict</code></td>
<td>
<p>a logical indicating whether models with more likely submodels are 
eliminated. <code>FALSE</code> returns all models whose posterior model probability is
within a factor of <code>1/OR</code> of that of the best model.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_prior.param">prior.param</code></td>
<td>
<p>a vector of values specifying the prior weights for each variable.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_or">OR</code></td>
<td>
<p> a number specifying the maximum ratio for excluding models in Occam's window </p>
</td></tr>
<tr><td><code id="bic.glm_+3A_maxcol">maxCol</code></td>
<td>
<p>a number specifying the maximum number of columns in design matrix 
(including intercept) to be kept.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_or.fix">OR.fix</code></td>
<td>
<p>width of the window which keeps models after the leaps approximation
is done.  
Because the leaps and bounds gives only an approximation to BIC, 
there is a need to increase the window at this first &quot;cut&quot; so as to 
assure that no good models are deleted. 
The level of this cut is at <code>1/(OR^OR.fix)</code>; the default value 
for <code>OR.fix</code> is 2.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_nbest">nbest</code></td>
<td>
<p>a number specifying the number of models of each size returned to 
<code>bic.glm</code> by the modified leaps algorithm.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_dispersion">dispersion</code></td>
<td>
<p>a logical value specifying whether dispersion should be 
estimated or not. Default is <code>TRUE</code> unless glm.family is poisson 
or binomial</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_factor.type">factor.type</code></td>
<td>
<p>a logical value specifying how variables of class &quot;factor&quot; are 
handled. 
A factor variable with d levels is turned into (d-1) dummy variables using a
treatment contrast.  
If <code>factor.type = TRUE</code>, models will contain either all or none of 
these dummy variables.  
If <code>factor.type = FALSE</code>, models are free  to select the dummy 
variables independently.  
In this case, factor.prior.adjust determines the prior on these variables.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_factor.prior.adjust">factor.prior.adjust</code></td>
<td>
<p>a logical value specifying whether 
the prior distribution on dummy variables for factors 
should be adjusted when <code>factor.type=FALSE</code>.
When <code>factor.prior.adjust=FALSE</code>, all dummy variables 
for variable <code>i</code> have prior equal to <code>prior.param[i]</code>.
Note that this makes the prior probability of the union of these variables 
much higher than <code>prior.param[i]</code>.  
Setting <code>factor.prior.adjust=T</code> corrects for this so that the union of 
the dummies equals <code>prior.param[i]</code>
(and hence the deletion of the factor has a prior of 
<code>1-prior.param[i]</code>).  
This adjustment changes the individual priors on each dummy variable to '
<code>1-(1-pp[i])^(1/(k+1))</code>.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_occam.window">occam.window</code></td>
<td>
<p>a logical value specifying if Occam's window should be used. 
If set to <code>FALSE</code> then all models selected by the modified leaps 
algorithm are returned.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_call">call</code></td>
<td>
<p>used internally</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when data contain <code>NA</code>s. Possible values are <code><a href="stats.html#topic+na.omit">na.omit</a></code>, <code><a href="stats.html#topic+na.exclude">na.exclude</a></code>, <code><a href="stats.html#topic+na.fail">na.fail</a></code>, <code><a href="stats.html#topic+na.pass">na.pass</a></code> or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="bic.glm_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bayesian Model Averaging accounts for the model uncertainty inherent in the variable selection problem by averaging over the best models in the model class according to approximate posterior model probability.  
</p>


<h3>Value</h3>

<p><code>bic.glm</code> returns an object of class <code>bic.glm</code>
</p>
<p>The function <code>summary</code> is used to print a summary of the results. 
The function <code>plot</code> is used to plot posterior distributions for the coefficients. 
The function <code>imageplot</code> generates an image of the models which were averaged over.
</p>
<p>An object of class <code>bic.glm</code> is a list containing at least the following components:
</p>
<table role = "presentation">
<tr><td><code>postprob</code></td>
<td>
<p>the posterior probabilities of the models selected</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>the estimated model deviances</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>labels identifying the models selected</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>values of BIC for the models</p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p>the number of independent variables in each of the models</p>
</td></tr>
<tr><td><code>which</code></td>
<td>
<p>a logical matrix with one row per model and one column per variable indicating whether that variable is in the model</p>
</td></tr>
<tr><td><code>probne0</code></td>
<td>
<p>the posterior probability that each variable is non-zero (in percent)</p>
</td></tr>
<tr><td><code>postmean</code></td>
<td>
<p>the posterior mean of each coefficient (from model averaging)</p>
</td></tr>
<tr><td><code>postsd</code></td>
<td>
<p>the posterior standard deviation of each coefficient (from model averaging) </p>
</td></tr>
<tr><td><code>condpostmean</code></td>
<td>
<p>the posterior mean of each coefficient conditional on the variable being included in the model</p>
</td></tr>
<tr><td><code>condpostsd</code></td>
<td>
<p>the posterior standard deviation of each coefficient conditional on the variable being included in the model</p>
</td></tr>
<tr><td><code>mle</code></td>
<td>
<p>matrix with one row per model and one column per variable giving the maximum likelihood estimate of each coefficient for each model</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>matrix with one row per model and one column per variable giving the standard error of each coefficient for each model</p>
</td></tr>
<tr><td><code>reduced</code></td>
<td>
<p>a logical indicating whether any variables were dropped before model averaging</p>
</td></tr>
<tr><td><code>dropped</code></td>
<td>
<p>a vector containing the names of those variables dropped before model averaging</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call that created the bma.lm object</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If more than <code>maxcol</code> variables are supplied, then bic.glm does stepwise 
elimination of variables until <code>maxcol</code> variables are reached.
<code>bic.glm</code> handles factor variables according to the <code>factor.type</code> 
parameter. If this is true then factor variables are kept in the model or dropped in 
entirety. If false, then each dummy variable can be kept or dropped independently. 
If <code>bic.glm</code> is used with a formula that includes interactions between factor 
variables, then <code>bic.glm</code> will create a new factor variable to represent that 
interaction, and this factor variable will be kept or dropped in entirety if 
<code>factor.type</code> is true. 
This can create interpretation problems if any of the corresponding main effects are
dropped.
Many thanks to Sanford Weisberg for making source code for leaps available.
</p>


<h3>Author(s)</h3>

<p>Chris Volinsky <a href="mailto:volinsky@research.att.com">volinsky@research.att.com</a>,
Adrian Raftery <a href="mailto:raftery@stat.washington.edu">raftery@stat.washington.edu</a>, and
Ian Painter <a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a>
</p>


<h3>References</h3>

<p> Raftery, Adrian E. (1995). Bayesian model selection in social research (with Discussion). Sociological Methodology 1995 (Peter V. Marsden, ed.), pp. 111-196, Cambridge, Mass.: Blackwells. 
</p>
<p>An earlier version, issued as Working Paper 94-12, Center for Studies in Demography 
and  Ecology, University of Washington (1994) is available as a technical report
from the Department of Statistics, University of Washington.</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.bic.glm">summary.bic.glm</a></code>, 
<code><a href="#topic+print.bic.glm">print.bic.glm</a></code>, 
<code><a href="#topic+plot.bic.glm">plot.bic.glm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
### logistic regression
library("MASS")
data(birthwt)
y&lt;- birthwt$lo
x&lt;- data.frame(birthwt[,-1])
x$race&lt;- as.factor(x$race)
x$ht&lt;- (x$ht&gt;=1)+0
x&lt;- x[,-9]
x$smoke &lt;- as.factor(x$smoke)
x$ptl&lt;- as.factor(x$ptl)
x$ht &lt;- as.factor(x$ht)
x$ui &lt;- as.factor(x$ui)

glm.out.FT &lt;- bic.glm(x, y, strict = FALSE, OR = 20, 
                      glm.family="binomial", factor.type=TRUE)
summary(glm.out.FT)
imageplot.bma(glm.out.FT)

glm.out.FF &lt;- bic.glm(x, y, strict = FALSE, OR = 20, 
                      glm.family="binomial", factor.type=FALSE)
summary(glm.out.FF)
imageplot.bma(glm.out.FF)

glm.out.TT &lt;- bic.glm(x, y, strict = TRUE, OR = 20, 
                      glm.family="binomial", factor.type=TRUE)
summary(glm.out.TT)
imageplot.bma(glm.out.TT)

glm.out.TF &lt;- bic.glm(x, y, strict = TRUE, OR = 20, 
                      glm.family="binomial", factor.type=FALSE)
summary(glm.out.TF)
imageplot.bma(glm.out.TF)

## End(Not run)

## Not run: 
### Gamma family 
library(survival)
data(cancer)
surv.t&lt;- veteran$time
x&lt;- veteran[,-c(3,4)]
x$celltype&lt;- factor(as.character(x$celltype))
sel&lt;- veteran$status == 0
x&lt;- x[!sel,]
surv.t&lt;- surv.t[!sel]

glm.out.va &lt;- bic.glm(x, y=surv.t, glm.family=Gamma(link="inverse"),
    factor.type=FALSE)
summary(glm.out.va)
imageplot.bma(glm.out.va)
plot(glm.out.va)

## End(Not run)

### Poisson family
### Yates (teeth) data. 

x&lt;- rbind(
    c(0, 0, 0),
    c(0, 1, 0),
    c(1, 0, 0),
    c(1, 1, 1))

y&lt;-c(4, 16, 1, 21)
n&lt;-c(1,1,1,1)

models&lt;- rbind(
    c(1, 1, 0),
    c(1, 1, 1))

glm.out.yates &lt;- bic.glm( x, y, n, glm.family = poisson(), 
                         factor.type=FALSE) 
summary(glm.out.yates)

## Not run: 
### Gaussian
library(MASS)
data(UScrime)
f &lt;- formula(log(y) ~  log(M)+So+log(Ed)+log(Po1)+log(Po2)+log(LF)+
                       log(M.F)+ log(Pop)+log(NW)+log(U1)+log(U2)+
                       log(GDP)+log(Ineq)+log(Prob)+log(Time))
glm.out.crime &lt;- bic.glm(f, data = UScrime, glm.family = gaussian()) 
summary(glm.out.crime)
# note the problems with the estimation of the posterior standard 
# deviation (compare with bicreg example)

## End(Not run)
</code></pre>

<hr>
<h2 id='bic.surv'>Bayesian Model Averaging for Survival models.</h2><span id='topic+bic.surv'></span><span id='topic+bic.surv.data.frame'></span><span id='topic+bic.surv.matrix'></span><span id='topic+bic.surv.formula'></span>

<h3>Description</h3>

<p>Bayesian Model Averaging for Cox proportional hazards models for
censored survival data. This accounts for the model uncertainty inherent
in the variable selection problem by averaging over the best models in
the model class according to approximate posterior model probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bic.surv(x, ...)

## S3 method for class 'matrix'
bic.surv(x, surv.t, cens, strict = FALSE, 
      OR = 20, maxCol = 30, prior.param = c(rep(0.5, ncol(x))), 
      OR.fix = 2, nbest = 150, factor.type = TRUE, 
      factor.prior.adjust = FALSE, call = NULL, ...)

## S3 method for class 'data.frame'
bic.surv(x, surv.t, cens, 
      strict = FALSE, OR = 20, maxCol = 30, 
      prior.param = c(rep(0.5, ncol(x))), OR.fix = 2, 
      nbest = 150, factor.type = TRUE, 
      factor.prior.adjust = FALSE, call = NULL, ...)

## S3 method for class 'formula'
bic.surv(f, data, strict = FALSE, 
     OR = 20, maxCol = 30, prior.param = c(rep(0.5, ncol(x))), 
     OR.fix = 2, nbest = 150, factor.type = TRUE, 
     factor.prior.adjust = FALSE, call = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bic.surv_+3A_x">x</code></td>
<td>
<p>a matrix or data frame of independent variables.</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_surv.t">surv.t</code></td>
<td>
<p>a vector of values for the dependent variable.</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_cens">cens</code></td>
<td>
<p>a vector of indicators of censoring (0=censored 1=uncensored)</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_f">f</code></td>
<td>
<p>a survival model formula</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_strict">strict</code></td>
<td>
<p> logical indicating whether models with more likely submodels are eliminated. 
<code>FALSE</code> returns all models whose posterior model probability is within a factor of <code>1/OR</code> of that of the best model.</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_or">OR</code></td>
<td>
<p> a number specifying the maximum ratio for excluding models in Occam's window </p>
</td></tr>
<tr><td><code id="bic.surv_+3A_maxcol">maxCol</code></td>
<td>
<p> a number specifying the maximum number of columns in design matrix (including intercept) to be kept. </p>
</td></tr>
<tr><td><code id="bic.surv_+3A_prior.param">prior.param</code></td>
<td>
<p>a vector of prior probabilities that parameters are non-zero. Default puts a prior of .5 on all parameters.  Setting to 1 forces the variable into the model.   </p>
</td></tr>
<tr><td><code id="bic.surv_+3A_or.fix">OR.fix</code></td>
<td>
<p>width of the window which keeps models after the leaps approximation is done.  
Because the leaps and bounds gives only an approximation to BIC, there is a need to increase the window at 
this first &quot;cut&quot; so as to ensure that no good models are deleted. 
The level of this cut is at <code>1/(OR^OR.fix)</code>; the default value for <code>OR.fix</code> is 2.</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_nbest">nbest</code></td>
<td>
<p>a value specifying the number of models of each size returned to bic.glm by the modified leaps algorithm.</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_factor.type">factor.type</code></td>
<td>
<p>a logical value specifying how variables of class &quot;factor&quot; are handled. 
A factor variable with d levels is turned into (d-1) dummy variables using a treatment contrast.  
If <code>factor.type = TRUE</code>, models will contain either all or none of these dummy variables.  
If <code>factor.type = FALSE</code>, models are free  to select the dummy variables independently.  
In this case, factor.prior.adjust determines the prior on these variables.</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_factor.prior.adjust">factor.prior.adjust</code></td>
<td>
<p>a logical value specifying if the prior distribution on
dummy variables for factors should be adjusted when <code>factor.type=FALSE</code>.
When <code>factor.prior.adjust=FALSE</code>, all dummy variables for variable 
<code>i</code> have prior equal to <code>prior.param[i]</code>.
Note that this makes the prior probability of the union of these variables much higher than <code>prior.param[i]</code>.  
Setting <code>factor.prior.adjust=T</code> corrects for this so that the union of the dummies equals <code>prior.param[i]</code>
(and hence the deletion of the factor has a prior of <code>1-prior.param[i]</code>).  
This adjustment changes the individual priors on each dummy variable to <code>1-(1-pp[i])^(1/(k+1))</code>.</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_call">call</code></td>
<td>
<p>used internally</p>
</td></tr>
<tr><td><code id="bic.surv_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bayesian Model Averaging accounts for the model uncertainty inherent in the variable selection problem by averaging over the best models in the model class according to approximate posterior model probability.  
<code>bic.surv</code> averages of Cox regression models.
</p>


<h3>Value</h3>

<p><code>bic.surv</code> returns an object of class <code>bic.surv</code>
</p>
<p>The function <code>summary</code> is used to print a summary of the results. 
The function <code>plot</code> is used to plot posterior distributions for the 
coefficients. 
The function <code>imageplot</code> generates an image of the models which were 
averaged over.
</p>
<p>An object of class <code>bic.glm</code> is a list containing at least the following 
components:
</p>
<table role = "presentation">
<tr><td><code>postprob</code></td>
<td>
<p>the posterior probabilities of the models selected</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>labels identifying the models selected</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>values of BIC for the models</p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p>the number of independent variables in each of the models</p>
</td></tr>
<tr><td><code>which</code></td>
<td>
<p>a logical matrix with one row per model and one column per variable indicating whether that variable is in the model</p>
</td></tr>
<tr><td><code>probne0</code></td>
<td>
<p>the posterior probability that each variable is non-zero (in percent)</p>
</td></tr>
<tr><td><code>postmean</code></td>
<td>
<p>the posterior mean of each coefficient (from model averaging)</p>
</td></tr>
<tr><td><code>postsd</code></td>
<td>
<p>the posterior standard deviation of each coefficient (from model averaging) </p>
</td></tr>
<tr><td><code>condpostmean</code></td>
<td>
<p>the posterior mean of each coefficient conditional on the variable being included in the model</p>
</td></tr>
<tr><td><code>condpostsd</code></td>
<td>
<p>the posterior standard deviation of each coefficient conditional on the variable being included in the model</p>
</td></tr>
<tr><td><code>mle</code></td>
<td>
<p>matrix with one row per model and one column per variable giving the maximum likelihood estimate of each coefficient for each model</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>matrix with one row per model and one column per variable giving the standard error of each coefficient for each model</p>
</td></tr>
<tr><td><code>reduced</code></td>
<td>
<p>a logical indicating whether any variables were dropped before model averaging</p>
</td></tr>
<tr><td><code>dropped</code></td>
<td>
<p>a vector containing the names of those variables dropped before model averaging</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call that created the bma.lm object</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If more than <code>maxcol</code> variables are supplied, then bic.surv does 
stepwise elimination of variables until <code>maxcol</code> variables are reached.
Many thanks to Sanford Weisberg for making source code for leaps available.
</p>


<h3>Author(s)</h3>

<p>Chris Volinsky 
<a href="mailto:volinsky@research.att.com">volinsky@research.att.com</a>;
Adrian Raftery 
<a href="mailto:raftery@uw.edu">raftery@uw.edu</a>;
Ian Painter 
<a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a>
</p>


<h3>References</h3>

 
<p>Volinsky, C.T., Madigan, D., Raftery, A.E. and Kronmal, R.A. (1997). 
&quot;Bayesian Model Averaging in Proportional Hazard Models:  
Assessing the Risk of a Stroke.&quot;  Applied Statistics 46: 433-448
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.bic.surv">summary.bic.surv</a></code>, 
<code><a href="#topic+print.bic.surv">print.bic.surv</a></code>, 
<code><a href="#topic+plot.bic.surv">plot.bic.surv</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## veteran data
library(survival)
data(cancer)

test.bic.surv&lt;- bic.surv(Surv(time,status) ~ ., data = veteran, 
                         factor.type = TRUE)
summary(test.bic.surv, conditional=FALSE, digits=2)
plot(test.bic.surv)

imageplot.bma(test.bic.surv)

## End(Not run)

## pbc data

x&lt;- pbc[1:312,]
surv.t&lt;- x$time
cens&lt;- as.numeric((x$status == 2))

x&lt;- x[,c("age", "albumin", "alk.phos", "ascites", "bili", "edema", 
         "hepato", "platelet", "protime", "sex", "ast", "spiders", 
         "stage", "trt", "copper")]

## Not run: 
x$bili&lt;- log(x$bili)
x$alb&lt;- log(x$alb)
x$protime&lt;- log(x$protime)
x$copper&lt;- log(x$copper)
x$ast&lt;- log(x$ast)

test.bic.surv&lt;- bic.surv(x, surv.t, cens, 
                         factor.type=FALSE, strict=FALSE)
summary(test.bic.surv)

## End(Not run)

</code></pre>

<hr>
<h2 id='bicreg'>Bayesian Model Averaging for linear regression models.</h2><span id='topic+bicreg'></span>

<h3>Description</h3>

<p>Bayesian Model Averaging accounts for the model uncertainty inherent in the variable selection problem by averaging over the best models in the model class according to approximate posterior model probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bicreg(x, y, wt = rep(1, length(y)), strict = FALSE, OR = 20, 
       maxCol = 31, drop.factor.levels = TRUE, nbest = 150)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bicreg_+3A_x">x</code></td>
<td>
<p> a matrix of independent variables </p>
</td></tr>
<tr><td><code id="bicreg_+3A_y">y</code></td>
<td>
<p> a vector of values for the dependent variable </p>
</td></tr>
<tr><td><code id="bicreg_+3A_wt">wt</code></td>
<td>
<p> a vector of weights for regression </p>
</td></tr>
<tr><td><code id="bicreg_+3A_strict">strict</code></td>
<td>
<p> logical. FALSE returns all models whose posterior model probability is within a factor of 1/OR of that of the best model. TRUE returns a more parsimonious set of models, where any model with a more likely submodel is eliminated.  </p>
</td></tr>
<tr><td><code id="bicreg_+3A_or">OR</code></td>
<td>
<p> a number specifying the maximum ratio for excluding models in Occam's window </p>
</td></tr>
<tr><td><code id="bicreg_+3A_maxcol">maxCol</code></td>
<td>
<p> a number specifying the maximum number of columns in the design matrix (including the intercept) to be kept. </p>
</td></tr>
<tr><td><code id="bicreg_+3A_drop.factor.levels">drop.factor.levels</code></td>
<td>
<p> logical. Indicates whether factor levels can be individually dropped in the stepwise procedure to reduce the number of columns in the design matrix, or if a factor can be dropped only in its entirety. </p>
</td></tr>
<tr><td><code id="bicreg_+3A_nbest">nbest</code></td>
<td>
<p> a value specifying the number of models of each size
returned to bic.glm by the leaps algorithm. The default is 150
(replacing the original default of 10).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bayesian Model Averaging accounts for the model uncertainty inherent in the variable selection problem by averaging over the best models in the model class according to the approximate posterior model probabilities.  
</p>


<h3>Value</h3>

<p><code>bicreg</code> returns an object of class <code>bicreg</code>
</p>
<p>The function 'summary' is used to print a summary of the results. The function 'plot' is used to plot posterior distributions for the coefficients.
</p>
<p>An object of class <code>bicreg</code> is a list containing at least the following components:
</p>
<table role = "presentation">
<tr><td><code>postprob</code></td>
<td>
<p>the posterior probabilities of the models selected</p>
</td></tr>
<tr><td><code>namesx</code></td>
<td>
<p>the names of the variables</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>labels identifying the models selected</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>R2 values for the models</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>values of BIC for the models</p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p>the number of independent variables in each of the models</p>
</td></tr>
<tr><td><code>which</code></td>
<td>
<p>a logical matrix with one row per model and one column per variable indicating whether that variable is in the model</p>
</td></tr>
<tr><td><code>probne0</code></td>
<td>
<p>the posterior probability that each variable is non-zero (in percent)</p>
</td></tr>
<tr><td><code>postmean</code></td>
<td>
<p>the posterior mean of each coefficient (from model averaging)</p>
</td></tr>
<tr><td><code>postsd</code></td>
<td>
<p>the posterior standard deviation of each coefficient (from model averaging) </p>
</td></tr>
<tr><td><code>condpostmean</code></td>
<td>
<p>the posterior mean of each coefficient conditional on the variable being included in the model</p>
</td></tr>
<tr><td><code>condpostsd</code></td>
<td>
<p>the posterior standard deviation of each coefficient conditional on the variable being included in the model</p>
</td></tr>
<tr><td><code>ols</code></td>
<td>
<p>matrix with one row per model and one column per variable giving the OLS estimate of each coefficient for each model</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>matrix with one row per model and one column per variable giving the standard error of each coefficient for each model</p>
</td></tr>
<tr><td><code>reduced</code></td>
<td>
<p>a logical indicating whether any variables were dropped before model averaging</p>
</td></tr>
<tr><td><code>dropped</code></td>
<td>
<p>a vector containing the names of those variables dropped before model averaging</p>
</td></tr>
<tr><td><code>residvar</code></td>
<td>
<p>residual variance for each model</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call that created the bicreg object</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Original Splus code developed by Adrian Raftery (<a href="mailto:raftery@uw.edu">raftery@uw.edu</a>) and revised by Chris T. Volinsky. Translation to R by Ian Painter. </p>


<h3>References</h3>

<p>Raftery, Adrian E. (1995). Bayesian model selection in social research (with Discussion). Sociological Methodology 1995 (Peter V. Marsden, ed.), pp. 111-196, Cambridge, Mass.: Blackwells.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.bicreg">summary.bicreg</a></code>, <code><a href="#topic+print.bicreg">print.bicreg</a></code>, <code><a href="#topic+plot.bicreg">plot.bicreg</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
data(UScrime)
x&lt;- UScrime[,-16]
y&lt;- log(UScrime[,16])
x[,-2]&lt;- log(x[,-2])
lma&lt;- bicreg(x, y, strict = FALSE, OR = 20) 
summary(lma)
plot(lma)

imageplot.bma(lma)

</code></pre>

<hr>
<h2 id='For.MC3.REG'> Helper function for MC3.REG </h2><span id='topic+For.MC3.REG'></span>

<h3>Description</h3>

<p>Helper function for MC3.REG which implements each step of the Metropolis-Hastings algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>For.MC3.REG(i, g, Ys, Xs, PI, K, nu, lambda, phi, outs.list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="For.MC3.REG_+3A_i">i</code></td>
<td>
<p>the current iteration number.</p>
</td></tr>
<tr><td><code id="For.MC3.REG_+3A_g">g</code></td>
<td>
<p>a list containing the current state and the history of the
Markov-Chain. This list is in the same form as the return value (see
the 'value' section below):
</p>

<dl>
<dt>M0.var</dt><dd><p>a logical vector specifying the variables in the
current model.</p>
</dd>
<dt>M0.out</dt><dd><p>a logical vector specifying the outliers in the
current model.</p>
</dd>
<dt>M0.1</dt><dd><p>a number representing the variables in the current
model in binary form.</p>
</dd>
<dt>M0.2</dt><dd><p>a number represnting the outliers in the current model
in binary form.</p>
</dd>
<dt>outcnt</dt><dd><p>the number of potential outliers</p>
</dd> 
</dl>
</td></tr>
<tr><td><code id="For.MC3.REG_+3A_ys">Ys</code></td>
<td>
<p>the vector of scaled responses.</p>
</td></tr>
<tr><td><code id="For.MC3.REG_+3A_xs">Xs</code></td>
<td>
<p>the matrix of scaled covariates.</p>
</td></tr>
<tr><td><code id="For.MC3.REG_+3A_pi">PI</code></td>
<td>
<p>a hyperparameter indicating the prior probability of an outlier.  
The default values are 0.1 if the data set has less than 50 observations, 0.02 otherwise. </p>
</td></tr>
<tr><td><code id="For.MC3.REG_+3A_k">K</code></td>
<td>
<p> a hyperparameter indicating the outlier inflation factor </p>
</td></tr>
<tr><td><code id="For.MC3.REG_+3A_nu">nu</code></td>
<td>
<p> regression hyperparameter.
Default value is 2.58 if r2 for the full model is less than 0.9 
or 0.2 if r2 for the full model is greater than 0.9. </p>
</td></tr>
<tr><td><code id="For.MC3.REG_+3A_lambda">lambda</code></td>
<td>
<p> regression hyperparameter.
Default value is 0.28 if r2 for the full model is less than 0.9 
or 0.1684 if r2 for the full model is greater than 0.9. </p>
</td></tr>
<tr><td><code id="For.MC3.REG_+3A_phi">phi</code></td>
<td>
<p> regression hyperparameter.
Default value is 2.85 if r2 for the full model is less than 0.9 
or 9.2 if r2 for the full model is greater than 0.9.  </p>
</td></tr>
<tr><td><code id="For.MC3.REG_+3A_outs.list">outs.list</code></td>
<td>
<p> a vector of all potential outlier locations
(e.g. <code>c(10,12)</code> means the 10th and 12th points are
potential outliers).
If <code>NULL</code> and if <code>outliers</code> is <code>TRUE</code>,
then potential outliers are estimated using the
<code><a href="#topic+out.ltsreg">out.ltsreg</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p> This function implements a single Metropolis-Hastings step, choosing a proposal model, calculating the Bayes Factor between the current model and proposal model, and updating the current model to the proposal model if the step results in an update. 
</p>


<h3>Value</h3>

<p>a list containing the current state and the history of the Markov-Chain, with components
</p>
<table role = "presentation">
<tr><td><code>flag</code></td>
<td>
<p>a 0/1 number specifying whether the previous Metropolis-Hastings step resulted in a changed state or not.</p>
</td></tr>
<tr><td><code>big.list</code></td>
<td>
<p>a matrix containing the history of the Markov-Chain. Each row represents a unique model (combination of variables and outliers). The first column is the set of variables in the model (in binary form), the second column is the set of outliers in the model (in binary form), the third column is the log-posterior for the model (up to a constant) and the fourth column is the number of times that model has been visited.</p>
</td></tr>
<tr><td><code>M0.var</code></td>
<td>
<p>a logical vector specifying the variables in the current model.</p>
</td></tr>
<tr><td><code>M0.out</code></td>
<td>
<p>a logical vector specifying the outliers in the current model.</p>
</td></tr>
<tr><td><code>M0.1</code></td>
<td>
<p>a number representing the variables in the current model in binary form.</p>
</td></tr>
<tr><td><code>M0.2</code></td>
<td>
<p>a number represnting the outliers in the current model in binary form.</p>
</td></tr>
<tr><td><code>outcnt</code></td>
<td>
<p>the number of potential outliers</p>
</td></tr>
</table>


<h3>Note</h3>

<p> The implementation here differs from the Splus implentation. The Splus implementation uses global variables to contain the state of the current model and the history of the Markov-Chain. This implentation passes the current state and history to the function and then returns the updated state. </p>


<h3>Author(s)</h3>

<p>Jennifer Hoeting <a href="mailto:jennifer.hoeting@gmail.com">jennifer.hoeting@gmail.com</a> with the assistance of Gary Gadbury. Translation from Splus to R by Ian Painter <a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a>.</p>


<h3>References</h3>

    
<p>Bayesian Model Averaging for Linear Regression Models 
Adrian E. Raftery, David Madigan, and Jennifer A. Hoeting (1997). 
Journal of the American Statistical Association, 92, 179-191. 
</p>
<p>A Method for Simultaneous Variable and Transformation Selection in Linear Regression 
Jennifer Hoeting, Adrian E. Raftery and David Madigan (2002). 
Journal of Computational and Graphical Statistics 11 (485-507) 
</p>
<p>A Method for Simultaneous Variable Selection and Outlier Identification in Linear Regression 
Jennifer Hoeting, Adrian E. Raftery and David Madigan (1996). 
Computational Statistics and Data Analysis, 22, 251-270 
</p>
<p>Earlier versions of these papers are available via the World Wide Web using the url:
<a href="https://www.stat.colostate.edu/~jah/papers/">https://www.stat.colostate.edu/~jah/papers/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+MC3.REG">MC3.REG</a></code>, <code><a href="#topic+MC3.REG.choose">MC3.REG.choose</a></code>, <code><a href="#topic+MC3.REG.logpost">MC3.REG.logpost</a></code> </p>

<hr>
<h2 id='glib'>Model uncertainty in generalized linear models using Bayes factors</h2><span id='topic+glib'></span><span id='topic+glib.matrix'></span><span id='topic+glib.data.frame'></span><span id='topic+glib.bic.glm'></span><span id='topic+as.bic.glm'></span><span id='topic+as.bic.glm.glib'></span>

<h3>Description</h3>

<p>Function to evaluate Bayes factors and account for model uncertainty in generalized linear models. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glib(x, ...)

## S3 method for class 'matrix'
glib(x, y, n = rep(1, nrow(x)), 
     error = "poisson", link = "log", scale = 1, 
     models = NULL, phi = c(1, 1.65, 5), psi = 1, 
     nu = 0, pmw = rep(1, nrow(models)), glimest = TRUE, 
     glimvar = FALSE, output.priorvar = FALSE, 
     post.bymodel = TRUE, output.postvar = FALSE, 
     priormean = NULL, priorvar = NULL, 
     nbest = 150, call = NULL, ...)

## S3 method for class 'data.frame'
glib(x, y, n = rep(1, nrow(x)), 
     error = "poisson", link = "log", scale = 1, 
     models = NULL,  phi = c(1, 1.65, 5), 
     psi = 1, nu = 0, pmw = rep(1, nrow(models)), 
     glimest = TRUE, glimvar = FALSE, output.priorvar = FALSE, 
     post.bymodel = TRUE, output.postvar = FALSE, 
     priormean = NULL, priorvar = NULL, 
     nbest = 150, call = NULL, ...)

## S3 method for class 'bic.glm'
glib(x, scale = 1, phi = 1, psi = 1, nu = 0, 
     glimest = TRUE, glimvar = FALSE, output.priorvar = FALSE, 
     post.bymodel = TRUE, output.postvar = FALSE, 
     priormean = NULL, priorvar = NULL, call = NULL, ...)

as.bic.glm(g, ...)

## S3 method for class 'glib'
as.bic.glm( g, index.phi=1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glib_+3A_x">x</code></td>
<td>
<p> an <code>n</code> x <code>p</code> matrix of independent variables  </p>
</td></tr>
<tr><td><code id="glib_+3A_g">g</code></td>
<td>
<p> an object of type <code>bic.glm</code></p>
</td></tr>
<tr><td><code id="glib_+3A_y">y</code></td>
<td>
<p> a vector of values for the dependent variable </p>
</td></tr>
<tr><td><code id="glib_+3A_n">n</code></td>
<td>
<p> an optional vector of weights to be used. </p>
</td></tr>
<tr><td><code id="glib_+3A_error">error</code></td>
<td>
<p>a string indicating the error family to use. Currently &quot;gaussian&quot;, &quot;gamma&quot;, &quot;inverse gaussian&quot;, &quot;binomial&quot; and &quot;poisson&quot; are implemented. </p>
</td></tr>
<tr><td><code id="glib_+3A_link">link</code></td>
<td>
<p>a string indicating the link to use. Currently &quot;identity&quot;, &quot;log&quot;, &quot;logit&quot;, &quot;probit&quot;, &quot;sqrt&quot;, &quot;inverse&quot; and &quot;loglog&quot; are implemented.</p>
</td></tr>
<tr><td><code id="glib_+3A_scale">scale</code></td>
<td>
<p>the scale factor for the model. May be either a numeric constant or a string specifying the estimation, either &quot;deviance&quot; or &quot;pearson&quot;. The default value is 1 for &quot;binomial&quot; and &quot;poisson&quot; error structures, and &quot;pearson&quot; for the others.</p>
</td></tr>
<tr><td><code id="glib_+3A_models">models</code></td>
<td>
<p> an optional matrix representing the models to be averaged over. 
<code>models</code> is a <code>n</code> x <code>p</code> matrix in which each row represents a model. 
The corresponding entry in the row is 1 if that variable is included in the model; 0 if not. 
The default value is <code>NULL</code> which will cause <code>glib</code> to call <code>bic.glm</code> with the parameter <code>occam.window</code> set to <code>FALSE</code> to obtain the models to average over.</p>
</td></tr>
<tr><td><code id="glib_+3A_phi">phi</code></td>
<td>
<p>a vector of phi values. Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="glib_+3A_psi">psi</code></td>
<td>
<p>a scalar prior parameter. Default: <code>1</code>. </p>
</td></tr>
<tr><td><code id="glib_+3A_nu">nu</code></td>
<td>
<p>a scalar prior parameter. Default: 0 </p>
</td></tr>
<tr><td><code id="glib_+3A_pmw">pmw</code></td>
<td>
<p>a vector of prior model weights. These must be positive, but do not have to sum to one. 
The prior model probabilities are given by  <code>pmw/sum(pmw)</code>. 
The default is a vector of 1's of length <code>nrow(models)</code></p>
</td></tr>
<tr><td><code id="glib_+3A_glimest">glimest</code></td>
<td>
<p> a logical value specifying whether to output estimates and standard errors for each model. </p>
</td></tr>
<tr><td><code id="glib_+3A_glimvar">glimvar</code></td>
<td>
<p> a logical value specifying whether glim variance matrices are output for each model.</p>
</td></tr>
<tr><td><code id="glib_+3A_output.priorvar">output.priorvar</code></td>
<td>
<p> a logical value specifying whether the prior variance is output for each model and value of phi combination.</p>
</td></tr>
<tr><td><code id="glib_+3A_post.bymodel">post.bymodel</code></td>
<td>
<p>a logical value specifying whether to output the posterior mean and sd for each model and value of phi combination.</p>
</td></tr>
<tr><td><code id="glib_+3A_output.postvar">output.postvar</code></td>
<td>
<p>a logical value specifying whether to output the posterior variance matrix for each model and value of phi combination.</p>
</td></tr>
<tr><td><code id="glib_+3A_priormean">priormean</code></td>
<td>
<p>an optional vector of length p+1 containing a user specified prior mean on the variables (including the intercept),
where p=number of independent variables. </p>
</td></tr>
<tr><td><code id="glib_+3A_priorvar">priorvar</code></td>
<td>
<p>an optional matrix containing a user specified prior variance matrix, a (p+1) x (p+1) matrix. 
Default has the prior variance estimated as in Raftery(1996). </p>
</td></tr>
<tr><td><code id="glib_+3A_nbest">nbest</code></td>
<td>
<p> an integer giving the number of best models of each size to be returned by bic.glm if <code>models == NULL</code></p>
</td></tr>
<tr><td><code id="glib_+3A_call">call</code></td>
<td>
<p>the call to the function</p>
</td></tr>
<tr><td><code id="glib_+3A_index.phi">index.phi</code></td>
<td>
<p>an index to the value of phi to use when converting a <code>glib</code> object to a <code>bic.glm</code> object</p>
</td></tr>
<tr><td><code id="glib_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function to evaluate Bayes factors and account for model
uncertainty in generalized linear models. 
This also calculates posterior distributions from a set of reference
proper priors. 
<code>as.bic.glm</code> creates a 'bic.glm' object from a 'glib' object.
</p>


<h3>Value</h3>

<p><code>glib</code> returns an object of type <code>glib</code>, which is a list
containing the following items:
</p>
<table role = "presentation">
<tr><td><code>inputs</code></td>
<td>
<p>a list echoing the inputs
(x,y,n,error,link,models,phi,psi,nu)</p>
</td></tr>
<tr><td><code>bf</code></td>
<td>
<p>a list containing the model comparison results:
</p>

<dl>
<dt>twologB10</dt><dd><p>an <code>nmodel</code> x <code>nphi</code> matrix whose
<code>[i,j]</code> element is 2logB10 for model i against the null model
with <code>phi=phi[j]</code>. A Laplace approximation (one-step Newton)
is used. </p>
</dd>
<dt>postprob</dt><dd><p> a matrix containing the posterior probabilities
of the models for each value of phi. </p>
</dd>
<dt>deviance</dt><dd><p> a vector containing the deviances for the models. </p>
</dd>
<dt>chi2</dt><dd><p> a vector containing the (DV0-DV1)/scale for the models </p>
</dd>
<dt>npar</dt><dd><p> a vector containing the number of parameters estimated
for each model. </p>
</dd>
<dt>scale</dt><dd><p> the estimated or assigned scale used </p>
</dd>
</dl>
</td></tr>
<tr><td><code>posterior</code></td>
<td>
<p>a list containing the Bayesian model mixing results:
</p>

<dl>
<dt>prob0</dt><dd><p> an <code>ncol(x)</code> x <code>nphi</code> matrix whose [k,j]
element is the posterior probability that the
parameter corresponding to the k-th column of x is zero,
for the j-th value of phi. </p>
</dd>
<dt>mean</dt><dd><p> a <code>ncol(x)</code> x <code>nphi</code> matrix whose [k,j]
element is the posterior mean of the parameter corresponding to
the k-th column of x, for the j-th value of phi.</p>
</dd>
<dt>sd</dt><dd><p> as for mean, but for the posterior standard deviation.
NOTE: Both mean and sd are CONDITIONAL on the parameter being
non-zero. They do not include the intercept. </p>
</dd>
</dl>
</td></tr>
<tr><td><code>glim.est</code></td>
<td>
<p>a list containing the GLIM estimates for the different
models:
</p>

<dl>
<dt>coef</dt><dd><p>An nmodel-list, each of whose elements is the coef
value from &quot;glim&quot; for one of the models.</p>
</dd>
<dt>se</dt><dd><p> as coef, but contains standard errors.</p>
</dd>
<dt>var</dt><dd><p> as coef, but contains variance matrices of the
estimates.</p>
</dd>
</dl>
</td></tr>
<tr><td><code>posterior.bymodel</code></td>
<td>
<p>a list containing model-specific posterior
means and sds:
</p>

<dl>
<dt>mean</dt><dd><p>a list with <code>nmodel</code> elements, whose <code>i</code>th element
is a <code>npar[i]xnphi</code> matrix, containing the posterior means of
the npar[i] parameters of model <code>i</code>,  for each value of phi.</p>
</dd>
<dt>sd</dt><dd><p> as for mean, but for posterior standard deviations.</p>
</dd>
<dt>var</dt><dd><p> a list with <code>nmodel</code> elements, whose <code>i</code>th element
is a <code>npar[i]</code> by <code>npar[i]</code> by <code>nphi</code> array,
containing the posterior variance matrix of the parameters of
model i for each value of phi.</p>
</dd>
</dl>
</td></tr>  <tr><td><code>prior</code></td>
<td>
<p>a list containing the prior distributions:
</p>

<dl>
<dt>mean</dt><dd><p> prior mean for the biggest model
(this doesn't depend on phi)</p>
</dd>
<dt>var</dt><dd><p> similar to corresponding member of posterior.bymodel.</p>
</dd>
</dl>
</td></tr>
<tr><td><code>models</code></td>
<td>
<p> an array containing the models used.</p>
</td></tr>
<tr><td><code>glm.out</code></td>
<td>
<p>an object of type 'bic.glm' containing the results of
any call to <code>bic.glm</code> </p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call to the function</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The outputs controlled by glimvar, output.priorvar and output.postvar can take up a lot of space, 
which is why these control parameters are F by default. </p>


<h3>Author(s)</h3>

<p> Original Splus code developed by Adrian Raftery <a href="mailto:raftery@uw.edu">raftery@uw.edu</a> and revised by Chris T. Volinsky. Translation to R by Ian S. Painter. </p>


<h3>References</h3>

<p> Raftery, A.E. (1988). Approximate Bayes factors for generalized linear  models. Technical Report no. 121, Department of Statistics, University of Washington. 
</p>
<p>Raftery, Adrian E. (1995). Bayesian model selection in social research (with Discussion). Sociological Methodology 1995 (Peter V. Marsden, ed.), pp. 111-196, Cambridge, Mass.: Blackwells. 
</p>
<p>Raftery, A.E. (1996). Approximate Bayes factors and accounting for model uncertainty in generalized linear models. Biometrika (83: 251-266). 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+bic.glm">bic.glm</a></code>, <code><a href="#topic+summary.glib">summary.glib</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
### Finney data
data(vaso)
x&lt;- vaso[,1:2]
y&lt;- vaso[,3]
n&lt;- rep(1,times=length(y))

finney.models&lt;- rbind(
    c(1, 0),
    c(0, 1),
    c(1, 1))

finney.glib &lt;- glib (x,y,n, error="binomial", link="logit", 
                     models=finney.models, glimvar=TRUE, 
                     output.priorvar=TRUE, output.postvar=TRUE)
summary(finney.glib)

finney.bic.glm&lt;- as.bic.glm(finney.glib)
plot(finney.bic.glm,mfrow=c(2,1))

## End(Not run)

### Yates (teeth) data. 

x&lt;- rbind(
    c(0, 0, 0),
    c(0, 1, 0),
    c(1, 0, 0),
    c(1, 1, 1))

y&lt;-c(4, 16, 1, 21)
n&lt;-c(1,1,1,1)

models&lt;- rbind(
    c(1, 1, 0),
    c(1, 1, 1))

glib.yates &lt;- glib ( x, y, n, models=models, glimvar=TRUE,
                     output.priorvar=TRUE, output.postvar=TRUE) 
summary(glib.yates)

## Not run: 
### logistic regression with no models specified
library("MASS")
data(birthwt)
y&lt;- birthwt$lo
x&lt;- data.frame(birthwt[,-1])
x$race&lt;- as.factor(x$race)
x$ht&lt;- (x$ht&gt;=1)+0
x&lt;- x[,-9]
x$smoke &lt;- as.factor(x$smoke)
x$ptl&lt;- as.factor(x$ptl)
x$ht &lt;- as.factor(x$ht)
x$ui &lt;- as.factor(x$ui)

glib.birthwt&lt;- glib(x,y, error="binomial", link = "logit")
summary(glib.birthwt)

glm.birthwt&lt;- as.bic.glm(glib.birthwt)

imageplot.bma(glm.birthwt)
plot(glm.birthwt)

## End(Not run)


</code></pre>

<hr>
<h2 id='iBMA'> Iterated Bayesian Model Averaging variable selection for generalized linear models, linear models or survival models.</h2><span id='topic+iBMA'></span><span id='topic+iBMA.glm'></span><span id='topic+iBMA.bicreg'></span><span id='topic+iBMA.surv'></span><span id='topic+iBMA.glm.data.frame'></span><span id='topic+iBMA.glm.matrix'></span><span id='topic+iBMA.glm.iBMA.intermediate.glm'></span><span id='topic+iBMA.bicreg.data.frame'></span><span id='topic+iBMA.bicreg.matrix'></span><span id='topic+iBMA.bicreg.iBMA.intermediate.bicreg'></span><span id='topic+iBMA.surv.data.frame'></span><span id='topic+iBMA.surv.matrix'></span><span id='topic+iBMA.surv.iBMA.intermediate.surv'></span>

<h3>Description</h3>

<p>This function implements the iterated Bayesian Model Averaging method for variable selection. 
This method works by making repeated calls to a Bayesian model averaging procedure, iterating through the variables in a fixed order. After each call to the Bayesian model averaging procedure only those variables 
which have posterior probability greater than a specified threshold are retained, those variables whose 
posterior probabilities do not meet the threshold are replaced with the next set of variables. The order in which the variables are to be considered
is usually determined on the basis of the some measure of goodness of fit calculated univariately for each variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iBMA.glm(x, ...)
iBMA.bicreg(x, ...)
iBMA.surv(x, ...)

## S3 method for class 'matrix'
iBMA.glm(x, Y, wt = rep(1, nrow(X)), 
       thresProbne0 = 5, glm.family, maxNvar = 30, 
       nIter = 100, verbose = FALSE, sorted = FALSE, 
       factor.type = TRUE, ...)

## S3 method for class 'matrix'
iBMA.glm(x, Y, wt = rep(1, nrow(X)), 
       thresProbne0 = 5, glm.family, maxNvar = 30, 
       nIter = 100, verbose = FALSE, sorted = FALSE, 
       factor.type = TRUE, ...)

## S3 method for class 'iBMA.intermediate.glm'
iBMA.glm(x, nIter = NULL, 
        verbose = NULL, ...) 

## S3 method for class 'matrix'
iBMA.bicreg(x, Y, wt = rep(1, nrow(X)), 
        thresProbne0 = 5, maxNvar = 30, nIter = 100, 
        verbose = FALSE, sorted = FALSE, ...)

## S3 method for class 'data.frame'
iBMA.bicreg(x, Y, wt = rep(1, nrow(X)), 
        thresProbne0 = 5, maxNvar = 30, nIter = 100, 
        verbose = FALSE, sorted = FALSE, ...)

## S3 method for class 'iBMA.intermediate.bicreg'
iBMA.bicreg(x, 
        nIter = NULL, verbose = NULL, ...) 

## S3 method for class 'matrix'
iBMA.surv(x, surv.t, cens, 
        wt = rep(1, nrow(X)), thresProbne0 = 5, 
        maxNvar = 30, nIter = 100, verbose = FALSE, 
        sorted = FALSE, factor.type = TRUE, ...)

## S3 method for class 'data.frame'
iBMA.surv(x, surv.t, cens, 
        wt = rep(1, nrow(X)), thresProbne0 = 5, 
        maxNvar = 30, nIter = 100, verbose = FALSE, 
        sorted = FALSE, factor.type = TRUE, ...)

## S3 method for class 'iBMA.intermediate.surv'
iBMA.surv(x, nIter = NULL,verbose = NULL, ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iBMA_+3A_x">x</code></td>
<td>
<p>a matrix or data.frame of independent variables,
or else an object of class <code>iBMA.glm.intermediate</code>,
<code>iBMA.bicreg.intermediate</code> or <code>iBMA.surv.intermediate</code>
that contains the current state of an incomplete selection.</p>
</td></tr>
<tr><td><code id="iBMA_+3A_y">Y</code></td>
<td>
<p>a vector of values for the dependent variable.</p>
</td></tr>
<tr><td><code id="iBMA_+3A_surv.t">surv.t</code></td>
<td>
<p>a vector of survival times.</p>
</td></tr>
<tr><td><code id="iBMA_+3A_cens">cens</code></td>
<td>
<p>a vector of indicators of censoring (0=censored 1=uncensored)</p>
</td></tr>
<tr><td><code id="iBMA_+3A_wt">wt</code></td>
<td>
<p>an optional vector of weights to be used.</p>
</td></tr>
<tr><td><code id="iBMA_+3A_thresprobne0">thresProbne0</code></td>
<td>
<p> a number giving the probability threshold for including variables as a percent.</p>
</td></tr>
<tr><td><code id="iBMA_+3A_glm.family">glm.family</code></td>
<td>
<p>glm family.</p>
</td></tr>
<tr><td><code id="iBMA_+3A_maxnvar">maxNvar</code></td>
<td>
<p> a number giving the maximum number of variables to be
considered in a model. </p>
</td></tr>  
<tr><td><code id="iBMA_+3A_niter">nIter</code></td>
<td>
<p> a number giving the maximum number of iterations that should be run. </p>
</td></tr>
<tr><td><code id="iBMA_+3A_verbose">verbose</code></td>
<td>
<p> a logical value specifying if verbose output should be produced or not </p>
</td></tr>
<tr><td><code id="iBMA_+3A_sorted">sorted</code></td>
<td>
<p> a logical value specifying if the variables have been sorted or not. If <code>FALSE</code> then <code>iBMA.glm</code> will sort the variables prior to running any iterations.</p>
</td></tr>
<tr><td><code id="iBMA_+3A_factor.type">factor.type</code></td>
<td>
<p>  a logical value specifying how variables of class &quot;factor&quot;
are handled.  A factor variable with d levels is turned into
(d-1) dummy variables using a treatment contrast.   If
'factor.type = TRUE', models will contain either all or none
of these dummy variables.   If 'factor.type = FALSE', models
are free  to select the dummy variables independently.   In
this case, factor.prior.adjust determines the prior on these
variables.</p>
</td></tr>
<tr><td><code id="iBMA_+3A_...">...</code></td>
<td>
<p> other parameters to be passed to <code>bic.glm</code>, <code>bicreg</code> or <code>bic.surv</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These methods can be run in a 'batch' mode by setting <code>nIter</code> to be larger than the number of variables. 
Alternatively, if <code>nIter</code> is set to be small, the procedure may return before all of the variables have been examined. 
In this case the returned result of the call will be of class 'iBMA.X.intermediate', and if iBMA.X is called with this result as the input, <code>nIter</code> more iterations will be run.
</p>
<p>If on any iteration there are no variables that have posterior probability less than the threshold, the variable with the lowest posterior probability is dropped.
</p>


<h3>Value</h3>

<p>An object of either type iBMA.X, or of type iBMA.X.intermediate, where 'X' is either 'glm', 'bicreg' or 'surv'. 
Objects of type 'iBMA.X.intermediate' consist of a list with components for each parameter passed into iBMA.X as well as the following components:
</p>
<table role = "presentation">
<tr><td><code>sortedX</code></td>
<td>
<p>a matrix or data.frame containing the sorted variables.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>initial.order</code></td>
<td>
<p>the inital ordering of the variables.</p>
</td></tr>
<tr><td><code>nVar</code></td>
<td>
<p>the number of variables.</p>
</td></tr>
<tr><td><code>currentSet</code></td>
<td>
<p>a vector specifying the set of variables currently selected.</p>
</td></tr> 
<tr><td><code>nextVar</code></td>
<td>
<p>the next variable to be examined</p>
</td></tr>
<tr><td><code>current.probne0</code></td>
<td>
<p>the posterior probabilities for inclusion for each of the variables in the current set of variables.</p>
</td></tr> 
<tr><td><code>maxProbne0</code></td>
<td>
<p>the maximum posterior probability calculated for each variable</p>
</td></tr>
<tr><td><code>nTimes</code></td>
<td>
<p>the number of times each variable has been included in the set of selected variables</p>
</td></tr>
<tr><td><code>currIter</code></td>
<td>
<p>the current iteration number</p>
</td></tr>
<tr><td><code>new.vars</code></td>
<td>
<p>the set of variables that will be added to the current set during the next iteration</p>
</td></tr>
<tr><td><code>first.in.model</code></td>
<td>
<p>a vector of numbers giving the iteration number that each variable was first examined in. A value of NA indicates that a variable has not yet been examined.</p>
</td></tr> 
<tr><td><code>iter.dropped</code></td>
<td>
<p>a vector giving the iteration number in which each variable was dropped from the current set. A value of NA indicates that a variable has not yet been dropeed.</p>
</td></tr>
</table>
<p>Objects of the type iBMA.glm contain in addition to all of these elements the following components:
</p>
<table role = "presentation">
<tr><td><code>nIterations</code></td>
<td>
<p>the total number of iterations that were run</p>
</td></tr>
<tr><td><code>selected</code></td>
<td>
<p>the set of variables that were selected (in terms of the initial ordering of the variables)</p>
</td></tr>
<tr><td><code>bma</code></td>
<td>
<p>an object of type 'bic.X' containing the results of the Bayesian model averaging run on the selected set of variables.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>The parameters <code>verbose</code> and <code>nIter</code> can be changed between sets of iterations. 
</p>
<p>The parameter <code>sorted</code> specifies if the variables should be sorted prior to iteration, if <code>sorted</code> is set to <code>FALSE</code> then the variables are sorted according to the decreasing single variable model R2 values for iBMA.bicreg or the single variable model increasing Chi-sq P-values for iBMA.glm and iBMA.surv.
Subsequent reference to variables is in terms of this ordered set of variables.
</p>
<p>It is possible to obtain degenerate results when using a large number of predictor variables in linear regression. This problem is much less common with logistic regression and survival analysis.
</p>


<h3>Author(s)</h3>

<p>Ka Yee Yeung, <a href="mailto:kayee@uw.edu">kayee@uw.edu</a>,
Adrian Raftery <a href="mailto:raftery@uw.edu">raftery@uw.edu</a>,
Ian Painter <a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a>
</p>


<h3>References</h3>

<p>Yeung, K.Y., Bumgarner, R.E. and Raftery, A.E. (2005). &lsquo; Bayesian Model Averaging: Development of an improved multi-class, gene selection and classification tool for microarray data.&rsquo; Bioinformatics, 21(10), 2394-2402 </p>


<h3>See Also</h3>

 
<p><code><a href="#topic+bic.glm">bic.glm</a></code>, 
<code><a href="#topic+bicreg">bicreg</a></code>, 
<code><a href="#topic+bic.surv">bic.surv</a></code>,
<code><a href="#topic+summary.iBMA.bicreg">summary.iBMA.bicreg</a></code>, 
<code><a href="#topic+print.iBMA.bicreg">print.iBMA.bicreg</a></code>, 
<code><a href="#topic+orderplot.iBMA.bicreg">orderplot.iBMA.bicreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
############ iBMA.glm
library("MASS")
data(birthwt)
 y&lt;- birthwt$lo
 x&lt;- data.frame(birthwt[,-1])
 x$race&lt;- as.factor(x$race)
 x$ht&lt;- (x$ht&gt;=1)+0
 x&lt;- x[,-9]
 x$smoke &lt;- as.factor(x$smoke)
 x$ptl&lt;- as.factor(x$ptl)
 x$ht &lt;- as.factor(x$ht)
 x$ui &lt;- as.factor(x$ui)

### add 41 columns of noise
noise&lt;- matrix(rnorm(41*nrow(x)), ncol=41)
colnames(noise)&lt;- paste('noise', 1:41, sep='')
x&lt;- cbind(x, noise)

iBMA.glm.out&lt;- iBMA.glm( x, y, glm.family="binomial", 
                         factor.type=FALSE, verbose = TRUE, 
                         thresProbne0 = 5 )
summary(iBMA.glm.out)

## End(Not run)

## Not run: 
################## iBMA.surv
library(survival)
data(cancer)

surv.t&lt;- veteran$time
cens&lt;- veteran$status
veteran$time&lt;- NULL
veteran$status&lt;- NULL
lvet&lt;- nrow(veteran)
invlogit&lt;- function(x) exp(x)/(1+exp(x))
# generate random noise, 34 uniform variables 
# and 10 factors each with 4 levels
X &lt;- data.frame(matrix(runif(lvet*34), ncol=34), 
               matrix(letters[1:6][(rbinom(10*lvet, 3, .5))+1], 
               ncol = 10))
colnames(X) &lt;- c(paste("u",1:34, sep=""),paste("C",1:10, sep=""))
for(i in 35:44) X[,i] &lt;- as.factor(X[,i])
veteran_plus_noise&lt;- cbind(veteran, X)


test.iBMA.surv &lt;- iBMA.surv(x = veteran_plus_noise, 
                            surv.t = surv.t, cens = cens, 
                            thresProbne0 = 5, maxNvar = 30, 
                            factor.type = TRUE, verbose = TRUE, 
                            nIter = 100)

test.iBMA.surv
summary(test.iBMA.surv)

## End(Not run)

## Not run: 
############ iBMA.bicreg ... degenerate example
library(MASS)
data(UScrime)
UScrime$M&lt;- log(UScrime$M); UScrime$Ed&lt;- log(UScrime$Ed); 
UScrime$Po1&lt;- log(UScrime$Po1); UScrime$Po2&lt;- log(UScrime$Po2); 
UScrime$LF&lt;- log(UScrime$LF); UScrime$M.F&lt;- log(UScrime$M.F)
UScrime$Pop&lt;- log(UScrime$Pop); UScrime$NW&lt;- log(UScrime$NW); 
UScrime$U1&lt;- log(UScrime$U1); UScrime$U2&lt;- log(UScrime$U2); 
UScrime$GDP&lt;- log(UScrime$GDP); UScrime$Ineq&lt;- log(UScrime$Ineq)
UScrime$Prob&lt;- log(UScrime$Prob); UScrime$Time&lt;- log(UScrime$Time) 
noise&lt;- matrix(rnorm(35*nrow(UScrime)), ncol=35)
colnames(noise)&lt;- paste('noise', 1:35, sep='')
UScrime_plus_noise&lt;- cbind(UScrime, noise)

y&lt;- UScrime_plus_noise$y
UScrime_plus_noise$y &lt;- NULL

# run 2 iterations and examine results
iBMA.bicreg.crime &lt;- iBMA.bicreg( x = UScrime_plus_noise, 
 Y = y, thresProbne0 = 5, verbose = TRUE, maxNvar = 30, nIter = 2)
summary(iBMA.bicreg.crime)
orderplot(iBMA.bicreg.crime)

## End(Not run)

## Not run: 
# run from current state until completion
iBMA.bicreg.crime &lt;- iBMA.bicreg( iBMA.bicreg.crime, nIter = 200)
summary(iBMA.bicreg.crime)
orderplot(iBMA.bicreg.crime)

## End(Not run)

set.seed(0)
x &lt;- matrix( rnorm(50*30), 50, 30)
lp &lt;- apply( x[,1:5], 1, sum)
iBMA.bicreg.ex &lt;- iBMA.bicreg( x = x,  Y = lp, thresProbne0 = 5, maxNvar = 20)

explp &lt;- exp(lp)
prob &lt;- explp/(1+explp)
y=rbinom(n=length(prob),prob=prob,size=1)
iBMA.glm.ex &lt;- iBMA.glm( x = x, Y = y, glm.family = "binomial",
                         factor.type = FALSE, thresProbne0 = 5, maxNvar = 20)

cat("\n\n CAUTION: iBMA.bicreg can give degenerate results when")
cat(" the number of predictor variables is large\n\n")


</code></pre>

<hr>
<h2 id='imageplot.bma'>Images of models used in Bayesian model averaging </h2><span id='topic+imageplot.bma'></span>

<h3>Description</h3>

<p>Creates an image of the models selected using <code><a href="#topic+bicreg">bicreg</a></code>, <code><a href="#topic+bic.glm">bic.glm</a></code> or <code><a href="#topic+bic.surv">bic.surv</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imageplot.bma(bma.out, color = c("red", "blue", "#FFFFD5"), 
              order = c("input", "probne0", "mds"), ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imageplot.bma_+3A_bma.out">bma.out</code></td>
<td>
<p>An object of type 'bicreg', 'bic.glm' or 'bic.surv'</p>
</td></tr>
<tr><td><code id="imageplot.bma_+3A_color">color</code></td>
<td>
<p>A vector of colors of length 3, or a string with value &quot;default&quot; or &quot;blackandwhite&quot;, representing the colors to use for the plot. 
The first color is the color to use when the variable estimate is positive, the second color is the color to use when the variable estimate is negative, and the third color is the color to use when the variable is not included in the model.
</p>
<p>The value &quot;default&quot; is available for backward compatibility with the first version of <code>imageplot.bma</code>, and uses the same color for positive and negative estimates. 
The value &quot;blackandwhite&quot; produces a black and white image.</p>
</td></tr>
<tr><td><code id="imageplot.bma_+3A_order">order</code></td>
<td>
<p>The order in which to show the variables. The value &quot;input&quot; keeps the order as found in the object, the value &quot;probne0&quot; orders the variables in terms of probability of inclusion, and the value &quot;mds&quot; orders the variables using (single) multidimensional scaling</p>
</td></tr> 
<tr><td><code id="imageplot.bma_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to the <code>image</code> and <code>axis</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>Creates an image of the models selected using <code><a href="#topic+bicreg">bicreg</a></code>, <code><a href="#topic+bic.glm">bic.glm</a></code> or <code><a href="#topic+bic.surv">bic.surv</a></code>. The image displays inclusion and exclusion of variables within models using separate colors. By default the color for inclusion depends on whether the variable estimate for each model is positive or negative.
</p>
<p>If the <code>factor.type == TRUE</code> option is set in the bma object being displayed, then <code>imageplot.bma</code> displays only inclusion and exclusion of models, with the color not linked to variable estimates.
</p>
<p>The option <code>color = "mds"</code> is useful for observing variables with linked behavior, it attemps to order the variables in such a way as to keep variabiles with linked behavior (for example, one variabile is only included in a model when another variabile is not included in the model) close together.
This option uses multidimensional scaling on one dimension using Kendall's tau statistic calculated on two-by-two tables of pairwise comparisons of variable inclusion/exclusion from the selected models.
</p>


<h3>Author(s)</h3>

<p>Adrian E. Raftery <a href="mailto:raftery@uw.edu">raftery@uw.edu</a> and Hana Sevcikova <a href="mailto:hanas@uw.edu">hanas@uw.edu</a></p>


<h3>References</h3>

<p>Clyde, M. (1999) Bayesian Model Averaging and Model Search Strategies (with discussion). In Bayesian Statistics 6. J.M. Bernardo, A.P. Dawid, J.O. Berger, and A.F.M. Smith eds. Oxford University Press, pages 157-185.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+bicreg">bicreg</a></code>, <code><a href="#topic+bic.glm">bic.glm</a></code>, <code><a href="#topic+bic.surv">bic.surv</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># logistic regression using bic.glm
library("MASS")
data(birthwt)
y&lt;- birthwt$lo
x&lt;- data.frame(birthwt[,-1])
x$race&lt;- as.factor(x$race)
x$ht&lt;- (x$ht&gt;=1)+0
x&lt;- x[,-9]
x$smoke &lt;- as.factor(x$smoke)
x$ptl&lt;- as.factor(x$ptl)
x$ht &lt;- as.factor(x$ht)
x$ui &lt;- as.factor(x$ui)

glm.out1&lt;- bic.glm(x, y, strict = TRUE, OR = 20, glm.family="binomial")
imageplot.bma(glm.out1)

## Not run: 
# logistic regression using glib
library("MASS")
data(birthwt)
y&lt;- birthwt$lo
x&lt;- data.frame(birthwt[,-1])
x$race&lt;- as.factor(x$race)
x$ht&lt;- (x$ht&gt;=1)+0
x&lt;- x[,-9]
x$smoke &lt;- as.factor(x$smoke)
x$ptl&lt;- as.factor(x$ptl)
x$ht &lt;- as.factor(x$ht)
x$ui &lt;- as.factor(x$ui)

glib.birthwt&lt;- glib(x,y, error="binomial", link = "logit")
glm.birthwt&lt;- as.bic.glm(glib.birthwt)
imageplot.bma(glm.birthwt, order = "mds")

## End(Not run)
</code></pre>

<hr>
<h2 id='MC3.REG'>Bayesian simultaneous variable selection and outlier identification</h2><span id='topic+MC3.REG'></span><span id='topic+as.data.frame.mc3'></span><span id='topic++5B.mc3'></span>

<h3>Description</h3>

<p>Performs Bayesian simultaneous variable selection and outlier identification (SVO) via Markov chain Monte Carlo model
composition (MC3).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MC3.REG(all.y, all.x, num.its, M0.var= , M0.out= , outs.list= , 
        outliers = TRUE, PI=.1*(length(all.y) &lt;50) + 
        .02*(length(all.y) &gt;= 50),  K=7, nu= , lambda= , phi= )

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MC3.REG_+3A_all.y">all.y</code></td>
<td>
<p>a vector of responses</p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_all.x">all.x</code></td>
<td>
<p> a matrix of covariates</p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_num.its">num.its</code></td>
<td>
<p>the number of iterations of the Markov chain sampler</p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_m0.var">M0.var</code></td>
<td>
<p>a logical vector specifying the starting model. For example, if you  have 3 predictors and the starting model is X1 and X3, then <code>M0.var</code> would be <code>c(TRUE,FALSE,TRUE)</code>. The default is a logical vector of <code>TRUE</code>s. NOTE: the starting predictor model cannot be the null model. </p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_m0.out">M0.out</code></td>
<td>
<p>a logical vector specifying the starting model outlier set. The default value is a logical vector of <code>TRUE</code>'s the same length as <code>outs.list</code>. This can be <code>NULL</code> only if outs.list is <code>NULL</code>, otherwise it must be the same length as <code>outs.list</code> (but can be a vector of all <code>FALSE</code>) </p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_outs.list">outs.list</code></td>
<td>
<p> a vector of all potential outlier locations  (e.g. <code>c(10,12)</code> means the 10th and 12th points are potential outliers). If <code>NULL</code> and if <code>outliers</code> is <code>TRUE</code>, then potential outliers are estimated using the <code><a href="#topic+out.ltsreg">out.ltsreg</a></code> function.</p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_outliers">outliers</code></td>
<td>
<p>a logical parameter indicating whether outliers are to be included. If <code>outs.list</code> is non null then this <code>outliers</code> is ignored. If <code>outs.list</code> is <code>NULL</code> and outliers is <code>TRUE</code>, potential outliers are estimated as described above.</p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_pi">PI</code></td>
<td>
<p>a hyperparameter indicating the prior probability of an outlier. The default values are 0.1 if the data set has less than 50 observations, 0.02 otherwise. </p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_k">K</code></td>
<td>
<p> a hyperparameter indicating the outlier inflation factor </p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_nu">nu</code></td>
<td>
<p> regression hyperparameter. Default value is 2.58 if r2 for the full model is less than 0.9 or 0.2 if r2 for the full model is greater than 0.9. </p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_lambda">lambda</code></td>
<td>
<p> regression hyperparameter. Default value is 0.28 if r2 for the full model is less than 0.9 or 0.1684 if r2 for the full model is greater than 0.9. </p>
</td></tr>
<tr><td><code id="MC3.REG_+3A_phi">phi</code></td>
<td>
<p> regression hyperparameter. Default value is 2.85 if r2 for the full model is less than 0.9 or 9.2 if r2 for the full model is greater than 0.9.  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs Bayesian simultaneous variable and outlier selection using Monte Carlo Markov Chain Model Choice (MC3). 
Potential models are visited using a Metropolis-Hastings algorithm on the integrated likelihood. 
At the end of the chain exact posterior probabilities are calculated for each model visited.
</p>


<h3>Value</h3>

<p>An object of class <code>mc3</code>. Print and summary methods exist for this class.
Objects of class <code>mc3</code> are a list consisting of at least
</p>
<table role = "presentation">
<tr><td><code>post.prob</code></td>
<td>
<p>The posterior probabilities of each model visited.</p>
</td></tr>
<tr><td><code>variables</code></td>
<td>
<p>An indicator matrix of the variables in each model.</p>
</td></tr>
<tr><td><code>outliers</code></td>
<td>
<p>An indicator matrix of the outliers in each model, if outliers were selected.</p>
</td></tr>
<tr><td><code>visit.count</code></td>
<td>
<p>The number of times each model was visited.</p>
</td></tr>
<tr><td><code>outlier.numbers</code></td>
<td>
<p>An index showing which outliers were eligable for selection.</p>
</td></tr>
<tr><td><code>var.names</code></td>
<td>
<p>The names of the variables.</p>
</td></tr>
<tr><td><code>n.models</code></td>
<td>
<p>The number of models visited.</p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>The value of PI used.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>The value of K used.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>The value of nu used.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The value of lambda used.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>The value of phi used.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The function call.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The default values for <code>nu</code>, <code>lambda</code> and <code>phi</code> are recommended when the R2 value for the full model with all outliers is less than 0.9.
</p>
<p>If <code>PI</code> is set too high it is possible to generate sub models which are singular, at which point the function will crash.
</p>
<p>The implementation of this function is different from that used in the Splus function. In particular, variables which were global are now passed between functions.</p>


<h3>Author(s)</h3>

<p>Jennifer Hoeting <a href="mailto:jennifer.hoeting@gmail.com">jennifer.hoeting@gmail.com</a> with the assistance of Gary Gadbury. Translation from Splus to R by Ian S. Painter.</p>


<h3>References</h3>

    
<p>Bayesian Model Averaging for Linear Regression Models 
Adrian E. Raftery, David Madigan, and Jennifer A. Hoeting (1997). 
Journal of the American Statistical Association, 92, 179-191. 
</p>
<p>A Method for Simultaneous Variable and Transformation Selection in Linear Regression 
Jennifer Hoeting, Adrian E. Raftery and David Madigan (2002). 
Journal of Computational and Graphical Statistics 11 (485-507) 
</p>
<p>A Method for Simultaneous Variable Selection and Outlier Identification in Linear Regression 
Jennifer Hoeting, Adrian E. Raftery and David Madigan (1996). 
Computational Statistics and Data Analysis, 22, 251-270 
</p>
<p>Earlier versions of these papers are available via the World Wide Web using the url:
<a href="https://www.stat.colostate.edu/~jah/papers/">https://www.stat.colostate.edu/~jah/papers/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+out.ltsreg">out.ltsreg</a></code> <code><a href="#topic+as.data.frame.mc3">as.data.frame.mc3</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Example 1:   Scottish hill racing data.

data(race)
b&lt;- out.ltsreg(race[,-1], race[,1], 2)
races.run1&lt;-MC3.REG(race[,1], race[,-1], num.its=20000, c(FALSE,TRUE), 
                    rep(TRUE,length(b)), b, PI = .1, K = 7, nu = .2, 
                    lambda = .1684, phi = 9.2)
races.run1
summary(races.run1)

## End(Not run)

# Example 2: Crime data
library(MASS)
data(UScrime)

y.crime.log&lt;- log(UScrime$y)
x.crime.log&lt;- UScrime[,-ncol(UScrime)]
x.crime.log[,-2]&lt;- log(x.crime.log[,-2])
crime.run1&lt;-MC3.REG(y.crime.log, x.crime.log, num.its=2000, 
                     rep(TRUE,15), outliers = FALSE)
crime.run1[1:25,]
summary(crime.run1)




</code></pre>

<hr>
<h2 id='MC3.REG.choose'> Helper function to MC3.REG </h2><span id='topic+MC3.REG.choose'></span>

<h3>Description</h3>

<p>Helper function to MC3.REG that chooses the proposal model for a Metropolis-Hastings step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MC3.REG.choose(M0.var, M0.out)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MC3.REG.choose_+3A_m0.var">M0.var</code></td>
<td>
<p>a logical vector specifying the variables in the current model.</p>
</td></tr>
<tr><td><code id="MC3.REG.choose_+3A_m0.out">M0.out</code></td>
<td>
<p>a logical vector specifying the outliers in the current model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list representing the proposal model, with components
</p>
<table role = "presentation">
<tr><td><code>var</code></td>
<td>
<p>a logical vector specifying the variables in the proposal model.</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>a logical vector specifying the outliers in the proposal model.</p>
</td></tr>
</table>


<h3>Note</h3>

<p> The implementation here differs from the Splus implentation. The Splus implementation uses global variables to contain the state of the current model and the history of the Markov-Chain. This implentation passes the current state and history to the function and then returns the updated state. </p>


<h3>Author(s)</h3>

<p>Jennifer Hoeting <a href="mailto:jennifer.hoeting@gmail.com">jennifer.hoeting@gmail.com</a> with the assistance of Gary Gadbury. Translation from Splus to R by Ian Painter <a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a>.</p>


<h3>References</h3>

    
<p>Bayesian Model Averaging for Linear Regression Models 
Adrian E. Raftery, David Madigan, and Jennifer A. Hoeting (1997). 
Journal of the American Statistical Association, 92, 179-191. 
</p>
<p>A Method for Simultaneous Variable and Transformation Selection in Linear Regression 
Jennifer Hoeting, Adrian E. Raftery and David Madigan (2002). 
Journal of Computational and Graphical Statistics 11 (485-507) 
</p>
<p>A Method for Simultaneous Variable Selection and Outlier Identification in Linear Regression 
Jennifer Hoeting, Adrian E. Raftery and David Madigan (1996). 
Computational Statistics and Data Analysis, 22, 251-270 
</p>
<p>Earlier versions of these papers are available via the World Wide Web using the url:
<a href="https://www.stat.colostate.edu/~jah/papers/">https://www.stat.colostate.edu/~jah/papers/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+MC3.REG">MC3.REG</a></code>, <code><a href="#topic+For.MC3.REG">For.MC3.REG</a></code>, <code><a href="#topic+MC3.REG.logpost">MC3.REG.logpost</a></code> </p>

<hr>
<h2 id='MC3.REG.logpost'> Helper function to MC3.REG  </h2><span id='topic+MC3.REG.logpost'></span>

<h3>Description</h3>

<p>Helper function to MC3.REG that calculates the posterior model probability (up to a constant).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MC3.REG.logpost(Y, X, model.vect, p, i, K, nu, lambda, phi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MC3.REG.logpost_+3A_y">Y</code></td>
<td>
<p>the vector of scaled responses.</p>
</td></tr>
<tr><td><code id="MC3.REG.logpost_+3A_x">X</code></td>
<td>
<p>the matrix of scaled covariates.</p>
</td></tr>
<tr><td><code id="MC3.REG.logpost_+3A_model.vect">model.vect</code></td>
<td>
<p> logical vector indicating which variables are to be included in the model </p>
</td></tr>
<tr><td><code id="MC3.REG.logpost_+3A_p">p</code></td>
<td>
<p>number of variables in model.vect</p>
</td></tr>
<tr><td><code id="MC3.REG.logpost_+3A_i">i</code></td>
<td>
<p> vector of possible outliers</p>
</td></tr>
<tr><td><code id="MC3.REG.logpost_+3A_k">K</code></td>
<td>
<p> a hyperparameter indicating the outlier inflation factor </p>
</td></tr>
<tr><td><code id="MC3.REG.logpost_+3A_nu">nu</code></td>
<td>
<p> regression hyperparameter. Default value is 2.58 if r2 for the full model is less than 0.9 
or 0.2 if r2 for the full model is greater than 0.9. </p>
</td></tr>
<tr><td><code id="MC3.REG.logpost_+3A_lambda">lambda</code></td>
<td>
<p> regression hyperparameter. Default value is 0.28 if r2 for the full model is less than 0.9 
or 0.1684 if r2 for the full model is greater than 0.9. </p>
</td></tr>
<tr><td><code id="MC3.REG.logpost_+3A_phi">phi</code></td>
<td>
<p> regression hyperparameter. Default value is 2.85 if r2 for the full model is less than 0.9 
or 9.2 if r2 for the full model is greater than 0.9.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The log-posterior distribution for the model (up to a constant).
</p>


<h3>Note</h3>

<p> The implementation here differs from the Splus implentation. The Splus implementation uses global variables to contain the state of the current model and the history of the Markov-Chain. This implentation passes the current state and history to the function and then returns the updated state. </p>


<h3>Author(s)</h3>

<p>Jennifer Hoeting <a href="mailto:jennifer.hoeting@gmail.com">jennifer.hoeting@gmail.com</a> with the assistance of Gary Gadbury. Translation from Splus to R by Ian Painter <a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a>.</p>


<h3>References</h3>

    
<p>Bayesian Model Averaging for Linear Regression Models 
Adrian E. Raftery, David Madigan, and Jennifer A. Hoeting (1997). 
Journal of the American Statistical Association, 92, 179-191. 
</p>
<p>A Method for Simultaneous Variable and Transformation Selection in Linear Regression 
Jennifer Hoeting, Adrian E. Raftery and David Madigan (2002). 
Journal of Computational and Graphical Statistics 11 (485-507) 
</p>
<p>A Method for Simultaneous Variable Selection and Outlier Identification in Linear Regression 
Jennifer Hoeting, Adrian E. Raftery and David Madigan (1996). 
Computational Statistics and Data Analysis, 22, 251-270 
</p>
<p>Earlier versions of these papers are available via the World Wide Web using the url:
<a href="https://www.stat.colostate.edu/~jah/papers/">https://www.stat.colostate.edu/~jah/papers/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+MC3.REG">MC3.REG</a></code>, <code><a href="#topic+For.MC3.REG">For.MC3.REG</a></code>, <code><a href="#topic+MC3.REG.choose">MC3.REG.choose</a></code> </p>

<hr>
<h2 id='orderplot'> Orderplot of iBMA objects </h2><span id='topic+orderplot'></span><span id='topic+orderplot.iBMA.glm'></span><span id='topic+orderplot.iBMA.bicreg'></span><span id='topic+orderplot.iBMA.surv'></span><span id='topic+orderplot.iBMA.intermediate.glm'></span><span id='topic+orderplot.iBMA.intermediate.bicreg'></span><span id='topic+orderplot.iBMA.intermediate.surv'></span>

<h3>Description</h3>

<p>This function displays a plot showing the selection and rejection of variables being considered in an iterated Bayesian model averaging variable selection procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orderplot(x, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orderplot_+3A_x">x</code></td>
<td>
<p> an object of type iBMA.glm, iBMA.bicreg, iBMA.surv, iBMA.intermediate.glm, iBMA.intermediate.bicreg or iBMA.intermediate.surv.</p>
</td></tr>
<tr><td><code id="orderplot_+3A_...">...</code></td>
<td>
<p> other parameters to be passed to plot.default </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The x-axis represents iterations, the y-axis variables. 
For each variable, a dot in the far left indicates that the variable has not yet been examined, 
a black line indicates the variable has been examined and dropped, the start of the line represents when the variable was first examined, 
the end represents when the variable was dropped. A blue line represents a variable that is still in the selected set of variables.
If the iterations have completed then the blue lines end with blue dots, representing the final set of variables selected.
</p>


<h3>Author(s)</h3>

<p>Ian Painter <a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.iBMA.glm">summary.iBMA.glm</a></code>, <code><a href="#topic+iBMA">iBMA</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
############ iBMA.glm
library("MASS")
data(birthwt)
 y&lt;- birthwt$lo
 x&lt;- data.frame(birthwt[,-1])
 x$race&lt;- as.factor(x$race)
 x$ht&lt;- (x$ht&gt;=1)+0
 x&lt;- x[,-9]
 x$smoke &lt;- as.factor(x$smoke)
 x$ptl&lt;- as.factor(x$ptl)
 x$ht &lt;- as.factor(x$ht)
 x$ui &lt;- as.factor(x$ui)

### add 41 columns of noise
noise&lt;- matrix(rnorm(41*nrow(x)), ncol=41)
colnames(noise)&lt;- paste('noise', 1:41, sep='')
x&lt;- cbind(x, noise)

iBMA.glm.out&lt;- iBMA.glm(x, y,  glm.family="binomial", factor.type=FALSE, 
                        verbose = TRUE, thresProbne0 = 5 )
orderplot(iBMA.glm.out)

## End(Not run)

</code></pre>

<hr>
<h2 id='out.ltsreg'>out.ltsreg </h2><span id='topic+out.ltsreg'></span>

<h3>Description</h3>

<p>Function to identify potential outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>out.ltsreg(x, y, delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="out.ltsreg_+3A_x">x</code></td>
<td>
<p>the design matrix</p>
</td></tr>
<tr><td><code id="out.ltsreg_+3A_y">y</code></td>
<td>
<p>observations</p>
</td></tr>
<tr><td><code id="out.ltsreg_+3A_delta">delta</code></td>
<td>
<p> the threshold set by the user.  Standardized residuals from least trimmed squares regression that are larger than delta are identified as potential outliers</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 0/1 vector indicating whether each observation is a potential outlier. The function was designed for use with the variable and outlier selection function <code>MC3.REG</code>
</p>


<h3>Author(s)</h3>

<p>Jennifer A. Hoeting</p>


<h3>See Also</h3>

  <p><code><a href="#topic+MC3.REG">MC3.REG</a></code></p>

<hr>
<h2 id='plot.bicreg'> Plots the posterior distributions of coefficients derived from Bayesian model averaging</h2><span id='topic+plot.bicreg'></span><span id='topic+plot.bic.glm'></span><span id='topic+plot.bic.surv'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>Displays plots of the posterior distributions of the coefficients generated by Bayesian model averaging over linear regression, generalized linear and survival analysis models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bicreg'
plot(x, e = 1e-04, mfrow = NULL, 
      include = 1:x$n.vars, include.intercept = TRUE, ...)

## S3 method for class 'bic.glm'
plot(x, e = 1e-04, mfrow = NULL, 
                       include = 1:length(x$namesx), ...)

## S3 method for class 'bic.surv'
plot(x, e = 1e-04, mfrow = NULL, 
                        include = 1:length(x$namesx), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bicreg_+3A_x">x</code></td>
<td>
<p> object of type bicreg, bic.glm or bic.surv. </p>
</td></tr>
<tr><td><code id="plot.bicreg_+3A_e">e</code></td>
<td>
<p> optional numeric value specifying the range over which the distributions are to be graphed.  </p>
</td></tr>
<tr><td><code id="plot.bicreg_+3A_mfrow">mfrow</code></td>
<td>
<p> optional vector specifying the layout for each set of graphs </p>
</td></tr>
<tr><td><code id="plot.bicreg_+3A_include">include</code></td>
<td>
<p> optional numerical vector specifying which variables to graph (excluding intercept)</p>
</td></tr>
<tr><td><code id="plot.bicreg_+3A_include.intercept">include.intercept</code></td>
<td>
<p> optional logical value, if true the posterior distribution of the intercept is incuded in the plots</p>
</td></tr>
<tr><td><code id="plot.bicreg_+3A_...">...</code></td>
<td>
<p>other parameters to be passed to <code>plot</code> and <code>lines</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces a plot of the posterior distribuion of the coefficients produced by model averaging. 
The posterior probability that the coefficient is zero is represented by a solid line at zero, with height equal to the probability.
The nonzero part of the distribution is scaled so that the maximum height is equal to the probability that the coefficient is nonzero.
</p>
<p>The parameter <code>e</code> specifies the range over which the distributions are to be graphed by specifying the tail probabilities that dictate the range to plot over. </p>


<h3>Author(s)</h3>

<p>Ian Painter <a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a></p>


<h3>References</h3>

<p>Hoeting, J.A., Raftery, A.E. and Madigan, D. (1996). A method for simultaneous variable selection and outlier identification in linear regression. Computational Statistics and Data Analysis, 22, 251-270.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
data(UScrime)
x&lt;- UScrime[,-16]
y&lt;- log(UScrime[,16])
x[,-2]&lt;- log(x[,-2])
plot( bicreg(x, y)) 
</code></pre>

<hr>
<h2 id='predict.bic.glm'>Predict function for Bayesian Model Averaging for generalized
linear models.</h2><span id='topic+predict.bic.glm'></span>

<h3>Description</h3>

<p>Bayesian Model Averaging (BMA) accounts for the model uncertainty
inherent in the variable selection problem by averaging over the best
models in the model class according to approximate posterior model
probability. This function predicts the response resulting from a BMA
generalized linear model from given data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bic.glm'
predict( object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.bic.glm_+3A_object">object</code></td>
<td>
<p>a fitted object inheriting from class <code>bic.glm</code>.</p>
</td></tr>
<tr><td><code id="predict.bic.glm_+3A_newdata">newdata</code></td>
<td>
<p>a data frame containing observations on variables from 
which the predictor variables are to be selected or 
constructed from a formula.</p>
</td></tr>
<tr><td><code id="predict.bic.glm_+3A_...">...</code></td>
<td>
<p>ignored (for compatibility with generic function).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The predicted values from the BMA model for each observation in newdata.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+bic.glm">bic.glm</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Example 1 (Gaussian)

     library(MASS)
     data(UScrime)

     f &lt;- formula(log(y) ~  log(M)+So+log(Ed)+log(Po1)+log(Po2)+
            log(LF)+log(M.F)+log(Pop)+log(NW)+log(U1)+log(U2)+
            log(GDP)+log(Ineq)+log(Prob)+log(Time))

     bic.glm.crimeT &lt;- bic.glm(f, data = UScrime, 
                               glm.family = gaussian())
     predict(bic.glm.crimeT, newdata = UScrime)

     bic.glm.crimeF &lt;- bic.glm(f, data = UScrime, 
                               glm.family = gaussian(),
                               factor.type = FALSE)
     predict(bic.glm.crimeF, newdata = UScrime)

## End(Not run)

## Not run: 
# Example 2 (binomial)

     library(MASS)
     data(birthwt)

     y &lt;- birthwt$lo
     x &lt;- data.frame(birthwt[,-1])
     x$race &lt;- as.factor(x$race)
     x$ht &lt;- (x$ht&gt;=1)+0
     x &lt;- x[,-9]
     x$smoke &lt;- as.factor(x$smoke)
     x$ptl &lt;- as.factor(x$ptl)
     x$ht  &lt;- as.factor(x$ht)

     x$ui &lt;- as.factor(x$ui)

     bic.glm.bwT &lt;- bic.glm(x, y, strict = FALSE, OR = 20,
                            glm.family="binomial",  
                            factor.type=TRUE)
     predict( bic.glm.bwT, newdata = x)

     bic.glm.bwF &lt;- bic.glm(x, y, strict = FALSE, OR = 20,
                            glm.family="binomial",  
                            factor.type=FALSE)
     predict( bic.glm.bwF, newdata = x)

## End(Not run)

## Not run: 
# Example 3 (Gaussian)

     library(MASS)
     data(anorexia)

     anorexia.formula &lt;- formula(Postwt ~ Prewt+Treat+offset(Prewt))

     bic.glm.anorexiaF &lt;- bic.glm( anorexia.formula, data=anorexia,
                       glm.family="gaussian", factor.type=FALSE)
     predict( bic.glm.anorexiaF, newdata=anorexia)

     bic.glm.anorexiaT &lt;- bic.glm( anorexia.formula, data=anorexia,
                           glm.family="gaussian", factor.type=TRUE)
     predict( bic.glm.anorexiaT, newdata=anorexia)

## End(Not run)

## Not run: 
# Example 4 (Gamma)

     library(survival)
     data(cancer)

     surv.t &lt;- veteran$time
     x &lt;- veteran[,-c(3,4)]
     x$celltype &lt;- factor(as.character(x$celltype))
     sel&lt;- veteran$status == 0
     x &lt;- x[!sel,]
     surv.t &lt;- surv.t[!sel]

     bic.glm.vaT &lt;- bic.glm(x, y=surv.t, 
                            glm.family=Gamma(link="inverse"),
                            factor.type=TRUE)
     predict( bic.glm.vaT, x)

     bic.glm.vaF &lt;- bic.glm(x, y=surv.t, 
                            glm.family=Gamma(link="inverse"),
                            factor.type=FALSE)
     predict( bic.glm.vaF, x)

## End(Not run)

# Example 5 (poisson - Yates teeth data)

     x &lt;- rbind.data.frame(c(0, 0, 0),
                           c(0, 1, 0),
                           c(1, 0, 0),
                           c(1, 1, 1))

     y &lt;- c(4, 16, 1, 21)
     n &lt;- c(1,1,1,1)

     bic.glm.yatesF &lt;- bic.glm( x, y, glm.family=poisson(),
                               weights=n, factor.type=FALSE)

     predict( bic.glm.yatesF, x)

## Not run: 
# Example 6 (binomial - Venables and Ripley)

    ldose &lt;- rep(0:5, 2)
    numdead &lt;- c(1, 4, 9, 13, 18, 20, 0, 2, 6, 10, 12, 16)
    sex &lt;- factor(rep(c("M", "F"), c(6, 6)))
    SF &lt;- cbind(numdead, numalive=20-numdead) 

    budworm &lt;- cbind.data.frame(ldose = ldose, numdead = numdead,
                                sex = sex, SF = SF)
    budworm.formula &lt;- formula(SF ~ sex*ldose)

    bic.glm.budwormF &lt;- bic.glm( budworm.formula, data=budworm,
                   glm.family="binomial", factor.type=FALSE)
    predict(bic.glm.budwormF, newdata=budworm)

    bic.glm.budwormT &lt;- bic.glm( budworm.formula, data=budworm,
                      glm.family="binomial", factor.type=TRUE)
    predict(bic.glm.budwormT, newdata=budworm)

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.bicreg'>Predict function for Bayesian Model Averaging for linear models.</h2><span id='topic+predict.bicreg'></span>

<h3>Description</h3>

<p>Bayesian Model Averaging (BMA) accounts for the model uncertainty inherent in the 
variable selection problem by averaging over the best models in the model class 
according to approximate posterior model probability. This function predicts
the response resulting from a BMA linear model from given data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bicreg'
predict( object, newdata, quantiles, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.bicreg_+3A_object">object</code></td>
<td>
<p>a fitted object inheriting from class <code>bicreg</code>.</p>
</td></tr>
<tr><td><code id="predict.bicreg_+3A_newdata">newdata</code></td>
<td>
<p>a data frame containing observations on variables from 
which the predictor variables are to be selected or 
constructed from a formula.</p>
</td></tr>
<tr><td><code id="predict.bicreg_+3A_quantiles">quantiles</code></td>
<td>
<p>The quantiles for which a predictive estimate is
desired. The default is <code>c(.1,.5,.9)</code>, corresponding to the
median (.5), and the 10th and 90th precentiles.</p>
</td></tr>
<tr><td><code id="predict.bicreg_+3A_...">...</code></td>
<td>
<p>ignored (for compatibility with generic function).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The predicted response values from the BMA model for each observation in newdata.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+bicreg">bicreg</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
  library(MASS)

# Example 1

     data(UScrime)

     x &lt;- UScrime[,-16]
     y &lt;- log(UScrime[,16])
     x[,-2]&lt;- log(x[,-2])

     crimeBMA &lt;- bicreg(x, y, strict = FALSE, OR = 20)
     predict( crimeBMA, x)

# Example 2 (Venables and Ripley)

     npkBMA &lt;- bicreg( x = npk[, c("block","N","K")], y=npk$yield)
     predict( npkBMA, newdata = npk)

# Example 3 (Venables and Ripley)

     gasPRbma &lt;- bicreg( x = whiteside[,c("Insul", "Temp")], 
                         y = whiteside$Gas)
     predict( gasPRbma, newdata = whiteside)

</code></pre>

<hr>
<h2 id='race'> Scottish Hill Racing data</h2><span id='topic+race'></span>

<h3>Description</h3>

<p>The record-winning times for 35 hill races in Scotland, as reported by Atkinson (1986). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(race)</code></pre>


<h3>Format</h3>

<p>data.frame
</p>


<h3>Details</h3>

<p>The distance travelled and the height climbed in each race is also given. The data contains a known error - Atkinson (1986) reports that the record for Knock Hill (observation 18) should actually be 18 minutes rather than 78 minutes.
</p>

<dl>
<dt>Variable</dt><dd><p>Description</p>
</dd>
<dt>Race</dt><dd><p>Name of race</p>
</dd> 
<dt>Distance</dt><dd><p>Distance covered in miles</p>
</dd> 
<dt>Climb</dt><dd><p>Elevation climbed during race in feet</p>
</dd>
<dt>Time</dt><dd><p>Record time for race in minutes</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="http://www.statsci.org/data/general/hills.html">http://www.statsci.org/data/general/hills.html</a>
</p>


<h3>References</h3>

<p>Atkison, A.C., Comments on &quot;Influential Observations, High Leverage Points, and Outliers in Linear Regression&quot;, Statistical Science, 1 (1986) 397-402
</p>

<hr>
<h2 id='summary.bic'>Summaries of Bayesian model averaging objects</h2><span id='topic+summary'></span><span id='topic+summary.bicreg'></span><span id='topic+summary.bic.glm'></span><span id='topic+summary.bic.surv'></span><span id='topic+summary.glib'></span><span id='topic+summary.mc3'></span><span id='topic+print'></span><span id='topic+print.bicreg'></span><span id='topic+print.bic.glm'></span><span id='topic+print.bic.surv'></span><span id='topic+print.glib'></span><span id='topic+print.mc3'></span>

<h3>Description</h3>

<p><code>summary</code> and <code>print</code> methods for Bayesian model averaging objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'bicreg'
summary(object, n.models = 5, 
         digits = max(3, getOption("digits") - 3), 
         conditional = FALSE, display.dropped = FALSE, ...)

## S3 method for class 'bic.glm'
summary(object, n.models = 5, 
         digits = max(3, getOption("digits") - 3), 
         conditional = FALSE, display.dropped = FALSE, ...)

## S3 method for class 'bic.surv'
summary(object, n.models = 5, 
         digits = max(3, getOption("digits") - 3), 
         conditional = FALSE, display.dropped = FALSE, ...)

## S3 method for class 'glib'
summary(object, n.models = 5, 
         digits = max(3, getOption("digits") - 3), 
         conditional = FALSE, index.phi=1, ...) 

## S3 method for class 'mc3'
summary(object, n.models = 5, 
         digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'bicreg'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'bic.glm'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'bic.surv'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'mc3'
print(x, digits = max(3, getOption("digits") - 3), 
                    n.models = nrow(x$variables), ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bic_+3A_object">object</code></td>
<td>
<p> object of type 'bicreg', 'bic.glm', 'bic.surv', 'glib' or 'mc3'</p>
</td></tr>
<tr><td><code id="summary.bic_+3A_x">x</code></td>
<td>
<p> object of type 'bicreg', 'bic.glm', 'bic.surv', 'glib' or 'mc3'</p>
</td></tr>
<tr><td><code id="summary.bic_+3A_n.models">n.models</code></td>
<td>
<p> optional number specifying the number of models to display in summary </p>
</td></tr>
<tr><td><code id="summary.bic_+3A_digits">digits</code></td>
<td>
<p> optional number specifying the number of digits to display </p>
</td></tr>
<tr><td><code id="summary.bic_+3A_conditional">conditional</code></td>
<td>
<p> optional logical value specifying whether to display conditional expectation and standard deviation</p>
</td></tr>
<tr><td><code id="summary.bic_+3A_display.dropped">display.dropped</code></td>
<td>
<p> optional logical value specifying whether to display the names of any variables dropped before model averaging takes place </p>
</td></tr>
<tr><td><code id="summary.bic_+3A_index.phi">index.phi</code></td>
<td>
<p> optional number specifying which value of phi to use if multiple values of phi were run. Applies to <code>glib</code> objects only</p>
</td></tr>
<tr><td><code id="summary.bic_+3A_...">...</code></td>
<td>
<p>other parameters to be passed to <code>print.default</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The print methods display a view similar to <code>print.lm</code> or <code>print.glm</code>. 
The summary methods display a view specific to model averaging. 
</p>


<h3>Note</h3>

<p>The summary function does not create a summary object (unlike <code>summary.lm</code> or <code>summary.glm</code>), instead it directly prints the summary. Note that no calculations are done to create the summary.</p>


<h3>Author(s)</h3>

<p>Ian Painter <a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># logistic regression
library("MASS")
data(birthwt)
y&lt;- birthwt$lo
x&lt;- data.frame(birthwt[,-1])
x$race&lt;- as.factor(x$race)
x$ht&lt;- (x$ht&gt;=1)+0
x&lt;- x[,-9]
x$smoke &lt;- as.factor(x$smoke)
x$ptl&lt;- as.factor(x$ptl)
x$ht &lt;- as.factor(x$ht)
x$ui &lt;- as.factor(x$ui)

glm.out1&lt;- bic.glm(x, y, OR = 20, glm.family="binomial", 
                   factor.type=TRUE)
summary(glm.out1, conditional = TRUE)
</code></pre>

<hr>
<h2 id='summary.iBMA'>Summaries of iterated Bayesian model averaging objects</h2><span id='topic+summary.iBMA.glm'></span><span id='topic+summary.iBMA.bicreg'></span><span id='topic+summary.iBMA.surv'></span><span id='topic+print.iBMA.glm'></span><span id='topic+print.iBMA.bicreg'></span><span id='topic+print.iBMA.surv'></span><span id='topic+summary.iBMA.intermediate.glm'></span><span id='topic+summary.iBMA.intermediate.bicreg'></span><span id='topic+summary.iBMA.intermediate.surv'></span><span id='topic+print.iBMA.intermediate.glm'></span><span id='topic+print.iBMA.intermediate.bicreg'></span><span id='topic+print.iBMA.intermediate.surv'></span>

<h3>Description</h3>

<p><code>summary</code> and <code>print</code> methods for iterated Bayesian model averaging objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'iBMA.glm'
summary(object, ...)
## S3 method for class 'iBMA.bicreg'
summary(object, ...)
## S3 method for class 'iBMA.surv'
summary(object, ...)
## S3 method for class 'iBMA.glm'
print(x, ...)
## S3 method for class 'iBMA.bicreg'
print(x, ...)
## S3 method for class 'iBMA.surv'
print(x, ...)
## S3 method for class 'iBMA.intermediate.glm'
summary(object, ...)
## S3 method for class 'iBMA.intermediate.bicreg'
summary(object, ...)
## S3 method for class 'iBMA.intermediate.surv'
summary(object, ...)
## S3 method for class 'iBMA.intermediate.glm'
print(x, ...)
## S3 method for class 'iBMA.intermediate.bicreg'
print(x, ...)
## S3 method for class 'iBMA.intermediate.surv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.iBMA_+3A_object">object</code></td>
<td>
<p>object of type <code>iBMA.glm</code>, <code>iBMA.bicreg</code>,
<code>iBMA.surv</code>, <code>iBMA.intermediate.glm</code>, 
<code>iBMA.intermediate.bicreg</code> or <code>iBMA.intermediate.surv</code>.</p>
</td></tr>
<tr><td><code id="summary.iBMA_+3A_x">x</code></td>
<td>
<p>object of type <code>iBMA.glm</code>, <code>iBMA.bicreg</code> ,
<code>iBMA.surv</code>, <code>iBMA.intermediate.glm</code>, 
<code>iBMA.intermediate.bicreg</code> or <code>iBMA.intermediate.surv</code>.</p>
</td></tr>
<tr><td><code id="summary.iBMA_+3A_...">...</code></td>
<td>
<p>other parameters to be passed to <code>print.bic.lmg</code>, 
<code>print.bicreg</code> or <code>print.bic.surv</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These methods provide concise and summarized information about the variables that 
have been examined up to the last iteration. 
If the result is a final result then the methods also display the results of 
calling print or summary on the Bayesian model average object for the final 
set of variables.
</p>


<h3>Note</h3>

<p>The summary function does not create a summary object 
(unlike <code>summary.lm</code> or <code>summary.glm</code>). 
Instead it directly prints the summary. 
Note that no calculations are done to create the summary.</p>


<h3>Author(s)</h3>

<p>Ian Painter <a href="mailto:ian.painter@gmail.com">ian.painter@gmail.com</a></p>

<hr>
<h2 id='vaso'>Vaso data</h2><span id='topic+vaso'></span>

<h3>Description</h3>

<p>Finney's data on vaso-contriction in the skin of the digits. <br />
The <code>vaso</code> data frame has 39 rows and 3 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vaso)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>volume</dt><dd><p>volume</p>
</dd>
<dt>rate</dt><dd><p>rate</p>
</dd>
<dt>y</dt><dd><p>response: 0= nonoccurrence, 1= occurrence</p>
</dd>
</dl>



<h3>References</h3>

<p>Atkinson, A.C. and Riani, M. (2000),  <em>Robust Diagnostic Regression Analysis</em>, First Edition. New York: Springer, Table A.23</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
