<!DOCTYPE html><html lang="en"><head><title>Help for package SmoothHazard</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SmoothHazard}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#idm'><p>Fit an illness-death model</p></a></li>
<li><a href='#idmModel'><p>Generate illness-death model objects</p></a></li>
<li><a href='#intensity'><p>M-spline estimate of the transition intensity function</p></a></li>
<li><a href='#Paq1000'><p>Paquid data set</p></a></li>
<li><a href='#plot.idm'><p>Plot method for an illness-death model</p></a></li>
<li><a href='#plot.shr'><p>Plot method for a survival model.</p></a></li>
<li><a href='#predict.idm'><p>Predictions for an illness-death model using either a penalized likelihood</p>
approach or a Weibull parametrization.</a></li>
<li><a href='#print.idm'><p>Print method for <code>idm</code> objects</p></a></li>
<li><a href='#print.shr'><p>Print method for <code>shrSplines</code> objects</p></a></li>
<li><a href='#shr'><p>Fit a survival model</p></a></li>
<li><a href='#sim.idmModel'><p>Simulate illness-death model data</p></a></li>
<li><a href='#sim.survIC'><p>Simulate interval censored survival data</p></a></li>
<li><a href='#simulateIDM'><p>Sample illness-death model data</p></a></li>
<li><a href='#summary.idm'><p>Summary of a fitted illness-death model</p></a></li>
<li><a href='#summary.shr'><p>Summary of a fitted survival model using a penalized likelihood approach</p></a></li>
<li><a href='#survIC'><p>Generate survival model objects</p></a></li>
<li><a href='#testdata'><p>Data set for survival models: right-censored and interval-censored data.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimation of Smooth Hazard Models for Interval-Censored Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2024.04.10</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of two-state (survival) models and irreversible illness-
    death models with possibly interval-censored, left-truncated and right-censored
    data. Proportional intensities regression models can be specified to allow for
    covariates effects separately for each transition. We use either a parametric
    approach with Weibull baseline intensities or a semi-parametric approach with
    M-splines approximation of baseline intensities in order to obtain smooth
    estimates of the hazard functions. Parameter estimates are obtained by maximum
    likelihood in the parametric approach and by penalized maximum likelihood in the
    semi-parametric approach.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Copyright:</td>
<td>See inst/COPYRIGHTS</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.9.1), prodlim (&ge; 1.4.9)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lava (&ge; 1.4.1), mvtnorm (&ge; 1.0-3)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Alexander Gerds &lt;tag@biostat.ku.dk&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-10 14:10:36 UTC; tag</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Celia Touraine [aut],
  Thomas Alexander Gerds [aut, cre],
  Pierre Joly [aut] (Author and maintainer of the Fortran code),
  Cecile Proust-Lima [aut] (Author of the Fortran code),
  Helene Jacqmin-Gadda [aut] (Author of the Fortran code),
  Amadou Diakite [aut] (Author of the Fortran code),
  W.D. Cody [aut] (Author of the Fortran code),
  A.H. Morris [aut] (Author of the Fortran code),
  B.W. Brown [aut] (Author of the Fortran code),
  Robin Genuer [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-10 20:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='idm'>Fit an illness-death model</h2><span id='topic+idm'></span>

<h3>Description</h3>

<p>Fit an illness-death model using either a semi-parametric approach
(penalized likelihood with an approximation of the transition intensity
functions by linear combination of M-splines) or a parametric approach
(specifying Weibull distributions on the transition intensities).
Left-truncated, right-censored, and interval-censored data are allowed.
State 0 corresponds to the initial state, state 1 to the transient one,
state 2 to the absorbant one. The allowed transitions are: 0 &ndash;&gt; 1, 0 &ndash;&gt; 2
and 1 &ndash;&gt; 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idm(
  formula01,
  formula02,
  formula12,
  data,
  maxiter = 200,
  eps = c(5, 5, 3),
  n.knots = c(7, 7, 7),
  knots = "equidistant",
  CV = FALSE,
  kappa = c(1000000, 500000, 20000),
  method = "Weib",
  conf.int = 0.95,
  print.iter = FALSE,
  subset = NULL,
  na.action = na.fail
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idm_+3A_formula01">formula01</code></td>
<td>
<p>A formula specifying a regression model for the
<code>0 --&gt; 1</code> transition from the initial state to the transient
state of the illness-death model.  The right hand side of the
formula specifies the covariate terms, and the left hand side must
be an event history object as returned by the function <code>Hist</code>.</p>
</td></tr>
<tr><td><code id="idm_+3A_formula02">formula02</code></td>
<td>
<p>A formula specifying a regression model for the
<code>0 --&gt; 2</code> transition from the initial state to the absorbing
state. The left hand side must be equal to the left hand side of
<code>formula01</code>. If missing it is set to <code>formula01</code>.</p>
</td></tr>
<tr><td><code id="idm_+3A_formula12">formula12</code></td>
<td>
<p>A formula specifying a regression model for the
<code>1 --&gt; 2</code> transition from the transient state to the absorbing
state.  operator is not required. If missing it is set to
<code>formula01</code>.</p>
</td></tr>
<tr><td><code id="idm_+3A_data">data</code></td>
<td>
<p>A data frame in which to interpret the variables of
<code>formula01</code>, <code>formula02</code> and <code>formula12</code>.</p>
</td></tr>
<tr><td><code id="idm_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations. The default is 200.</p>
</td></tr>
<tr><td><code id="idm_+3A_eps">eps</code></td>
<td>
<p>A vector of 3 integers &gt;0 used to define the power of
three convergence criteria: 1. for the regression parameters,
2. for the likelihood, 3. for the second derivatives. The default
is <code>c(5,5,3)</code> which is translated into convergence if the
respective values change less then <code class="reqn">10^{-5}</code> (for regression
parameters and likelihood) and <code class="reqn">10^{-3}</code> for the second
derivatives between two iterations.</p>
</td></tr>
<tr><td><code id="idm_+3A_n.knots">n.knots</code></td>
<td>
<p>For <code>method="Splines"</code> only, a vector of length
3 specifing the number of knots, one for each transition, for the
M-splines estimate of the baseline intensities in the order <code>0
--&gt; 1</code>, <code>0 --&gt; 2</code>, <code>1 --&gt; 2</code>. The default is c(7,7,7). When <code>knots</code>
are specified as a list this argument is ignored.
The algorithm needs least 5 knots and at most 20 knots.</p>
</td></tr>
<tr><td><code id="idm_+3A_knots">knots</code></td>
<td>
<p>Argument only active for the penalized likelihood approach <code>method="Splines"</code>.
There are three ways to control the placement of the knots between the smallest and the largest
of all time points:
</p>

<dl>
<dt><code>knots="equidistant"</code></dt><dd><p>Knots are placed with same distance on the time scale.</p>
</dd>
<dt><code>knots="quantiles"</code></dt><dd><p>Knots are placed such that the number of observations is roughly the same between knots.</p>
</dd>
<dt>knots=list()</dt><dd><p>List of 1 or 2 or three vectors. The list elements are the actual placements
(timepoints) of the knots for the M-spline. The list may contain 
one vector of placements for each transition in the order <code>0 --&gt; 1</code>, <code>0 --&gt; 2</code>, <code>1 --&gt; 2</code>.
If only vector is specifified the knots are used for all transitions. If only 2 vectors are specifified, the
knots for the <code>0 --&gt; 1</code> transition are also used for the <code>1 --&gt; 2</code> transition.</p>
</dd>
</dl>

<p>The algorithm needs at least 5 knots and allows no more than 20 knots.</p>
</td></tr>
<tr><td><code id="idm_+3A_cv">CV</code></td>
<td>
<p>Binary variable equals to 1 when search (by approximated
cross validation) of the smoothing parameters <code>kappa</code> and 0
otherwise. Argument for the penalized likelihood approach. The
default is 0.</p>
</td></tr>
<tr><td><code id="idm_+3A_kappa">kappa</code></td>
<td>
<p>Argument only active for the penalized likelihood approach <code>method="Splines"</code>.
A vector with 3 positive values (smoothing parameters), one for each transition, in the order 
0 &ndash;&gt; 1, 0 &ndash;&gt; 2 and 1 &ndash;&gt; 2..
If CV=1 these are used as starting values for a cross validation search to optimize kappa.</p>
</td></tr>
<tr><td><code id="idm_+3A_method">method</code></td>
<td>
<p>type of estimation method: &quot;Splines&quot; for a
penalized likelihood approach with approximation of the transition
intensities by M-splines, &quot;Weib&quot; for a parametric approach with a
Weibull distribution on the transition intensities. Default is
&quot;Weib&quot;.</p>
</td></tr>
<tr><td><code id="idm_+3A_conf.int">conf.int</code></td>
<td>
<p>Level of confidence pointwise confidence intervals of the transition intensities, i.e.,
a value between 0 and 1, the default is <code>0.95</code>.
The default is also used when <code>conf.int=TRUE</code>.
To avoid computation of confidence intervals, set <code>conf.int</code> to FALSE or NULL.</p>
</td></tr>
<tr><td><code id="idm_+3A_print.iter">print.iter</code></td>
<td>
<p>boolean parameter. Equals to <code>TRUE</code> to print
the likelihood during the iteration process, <code>FALSE</code>
otherwise. Default is <code>FALSE</code>. This option is not running on
Windows.</p>
</td></tr>
<tr><td><code id="idm_+3A_subset">subset</code></td>
<td>
<p>expression indicating the subset of the rows of data
to be used in the fit. All observations are included by default.</p>
</td></tr>
<tr><td><code id="idm_+3A_na.action">na.action</code></td>
<td>
<p>how NAs are treated. The default is first, any
na.action attribute of data, second a na.action setting of options,
and third 'na.fail' if that is unset. The 'factory-fresh' default
is na.omit. Another possible value is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimated parameters are obtained using the robust Marquardt algorithm
(Marquardt, 1963) which is a combination between a Newton-Raphson algorithm
and a steepest descent algorithm.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>the call that produced the result.</p>
</td></tr> <tr><td><code>coef</code></td>
<td>
<p>regression
parameters.</p>
</td></tr> <tr><td><code>loglik</code></td>
<td>
<p>vector containing the log-likelihood without and
with covariate.</p>
</td></tr> <tr><td><code>cv</code></td>
<td>
<p>vector containing the convergence criteria.</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>number of iterations.</p>
</td></tr> <tr><td><code>converged</code></td>
<td>
<p>integer equal to 1 when
the model converged, 2, 3 or 4 otherwise.</p>
</td></tr> <tr><td><code>modelPar</code></td>
<td>
<p>Weibull
parameters.</p>
</td></tr> <tr><td><code>N</code></td>
<td>
<p>number of subjects.</p>
</td></tr> <tr><td><code>events1</code></td>
<td>
<p>number of events 0
&ndash;&gt; 1.</p>
</td></tr> <tr><td><code>events2</code></td>
<td>
<p>number of events 0 &ndash;&gt; 2 or 0 &ndash;&gt; 1 &ndash;&gt; 2.</p>
</td></tr>
<tr><td><code>NC</code></td>
<td>
<p>vector containing the number of covariates on transitions 0 &ndash;&gt; 1,
0 &ndash;&gt; 2, 1 &ndash;&gt; 2.</p>
</td></tr> <tr><td><code>responseTrans</code></td>
<td>
<p>model response for the 0 &ndash;&gt; 1
transition. <code>Hist</code> or <code>Surv</code> object.</p>
</td></tr> <tr><td><code>responseAbs</code></td>
<td>
<p>model
response for the 0 &ndash;&gt; 2 transition. <code>Hist</code> or <code>Surv</code> object.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>times for which transition intensities have been evaluated for
plotting. Vector in the Weibull approach. Matrix in the penalized likelihhod
approach for which the colums corresponds to the transitions 0 &ndash;&gt; 1, 1 &ndash;&gt;
2, 0 &ndash;&gt; 2.</p>
</td></tr> <tr><td><code>intensity01</code></td>
<td>
<p>matched values of the intensities for
transition 0 &ndash;&gt; 1.</p>
</td></tr> <tr><td><code>lowerIntensity01</code></td>
<td>
<p>lower confidence intervals for
the values of the intensities for transition 0 &ndash;&gt; 1.</p>
</td></tr>
<tr><td><code>upperIntensity01</code></td>
<td>
<p>upper confidence intervals for the values of the
intensities for transition 0 &ndash;&gt; 1.</p>
</td></tr> <tr><td><code>intensity02</code></td>
<td>
<p>matched values of
the intensities for transition 0 &ndash;&gt; 2.</p>
</td></tr> <tr><td><code>lowerIntensity02</code></td>
<td>
<p>lower
confidence intervals for the values of the intensities for transition 0 &ndash;&gt;
2.</p>
</td></tr> <tr><td><code>upperIntensity02</code></td>
<td>
<p>upper confidence intervals for the values of the
intensities for transition 0 &ndash;&gt; 2.</p>
</td></tr> <tr><td><code>intensity12</code></td>
<td>
<p>matched values of
the intensities for transition 1 &ndash;&gt; 2.</p>
</td></tr> <tr><td><code>lowerIntensity12</code></td>
<td>
<p>lower
confidence intervals for the values of the intensities for transition 1 &ndash;&gt;
2.</p>
</td></tr> <tr><td><code>upperIntensity12</code></td>
<td>
<p>upper confidence intervals for the values of the
intensities for transition 1 &ndash;&gt; 2.</p>
</td></tr> <tr><td><code>RR</code></td>
<td>
<p>vector of relative risks.</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>variance-covariance matrix derived from the Hessian of the log-likelihood 
if using method=&quot;Weib&quot; or, from the Hessian of the penalized log-likelihood 
if using method=&quot;Splines&quot;.</p>
</td></tr> 
<tr><td><code>se</code></td>
<td>
<p>standart errors of the
regression parameters.</p>
</td></tr> <tr><td><code>Xnames01</code></td>
<td>
<p>names of covariates on 0 &ndash;&gt; 1.</p>
</td></tr>
<tr><td><code>Xnames02</code></td>
<td>
<p>names of covariates on 0 &ndash;&gt; 2.</p>
</td></tr> <tr><td><code>Xnames12</code></td>
<td>
<p>names of
covariates on 1 &ndash;&gt; 2.</p>
</td></tr> <tr><td><code>knots01</code></td>
<td>
<p>knots to approximate by M-splines the
intensity of the 0 &ndash;&gt; 1 transition.</p>
</td></tr> <tr><td><code>knots02</code></td>
<td>
<p>knots to approximate by
M-splines the intensity of the 0 &ndash;&gt; 2 transition.</p>
</td></tr> <tr><td><code>knots12</code></td>
<td>
<p>knots to
approximate by M-splines the intensity of the 1 &ndash;&gt; 2 transition.</p>
</td></tr>
<tr><td><code>nknots01</code></td>
<td>
<p>number of knots on transition 0 &ndash;&gt; 1.</p>
</td></tr>
<tr><td><code>nknots02</code></td>
<td>
<p>number of knots on transition 0 &ndash;&gt; 2.</p>
</td></tr>
<tr><td><code>nknots12</code></td>
<td>
<p>number of knots on transition 1 &ndash;&gt; 2.</p>
</td></tr>
<tr><td><code>theta01</code></td>
<td>
<p>square root of splines coefficients for transition 0 &ndash;&gt; 1.</p>
</td></tr>
<tr><td><code>theta02</code></td>
<td>
<p>square root of splines coefficients for transition 0 &ndash;&gt; 2.</p>
</td></tr>
<tr><td><code>theta12</code></td>
<td>
<p>square root of splines coefficients for transition 1 &ndash;&gt; 2.</p>
</td></tr>
<tr><td><code>CV</code></td>
<td>
<p>a binary variable equals to 1 when search of the smoothing
parameters <a href="base.html#topic+kappa">kappa</a> by approximated cross-validation, 1 otherwise. The
default is 0.</p>
</td></tr> <tr><td><code>kappa</code></td>
<td>
<p>vector containing the smoothing parameters for
transition 0 &ndash;&gt; 1, 0 &ndash;&gt; 2, 1 &ndash;&gt; 2 used to estimate the model by the
penalized likelihood approach.</p>
</td></tr> <tr><td><code>CVcrit</code></td>
<td>
<p>cross validation criteria.</p>
</td></tr>
<tr><td><code>DoF</code></td>
<td>
<p>degrees of freedom of the model.</p>
</td></tr> <tr><td><code>na.action</code></td>
<td>
<p>observations
deleted if missing values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>R: Celia Touraine &lt;Celia.Touraine@isped.u-bordeaux2.fr&gt; Fortran:
Pierre Joly &lt;Pierre.Joly@isped.u-bordeaux2.fr&gt;
</p>


<h3>References</h3>

<p>D. Marquardt (1963). An algorithm for least-squares estimation
of nonlinear parameters.  <em>SIAM Journal of Applied Mathematics</em>,
431-441.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.idm">print.idm</a></code>
<code><a href="#topic+summary.idm">summary.idm</a></code>
<code><a href="#topic+predict.idm">predict.idm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lava)
library(prodlim)
set.seed(17)
d &lt;- simulateIDM(100)
# right censored data
fitRC &lt;- idm(formula01=Hist(time=observed.illtime,event=seen.ill)~X1+X2,
             formula02=Hist(time=observed.lifetime,event=seen.exit)~X1+X2,
             formula12=Hist(time=observed.lifetime,event=seen.exit)~X1+X2,data=d,
             conf.int=FALSE)
fitRC


set.seed(17)
d &lt;- simulateIDM(300)
fitRC.splines &lt;- idm(formula01=Hist(time=observed.illtime,event=seen.ill)~X1+X2,
             formula02=Hist(time=observed.lifetime,event=seen.exit)~X1+X2,
             formula12=Hist(time=observed.lifetime,event=seen.exit)~1,data=d,
             conf.int=FALSE,method="splines")

# interval censored data
fitIC &lt;- idm(formula01=Hist(time=list(L,R),event=seen.ill)~X1+X2,
             formula02=Hist(time=observed.lifetime,event=seen.exit)~X1+X2,
             formula12=Hist(time=observed.lifetime,event=seen.exit)~X1+X2,data=d,
             conf.int=FALSE)
fitIC



    data(Paq1000)

    # Illness-death model with certif on the 3 transitions
    # Weibull parametrization and likelihood maximization

    fit.weib &lt;- idm(formula02=Hist(time=t,event=death,entry=e)~certif,
                    formula01=Hist(time=list(l,r),event=dementia)~certif,
                    data=Paq1000)

    # Illness-death model with certif on transitions 01 and 02
    # Splines parametrization and penalized likelihood maximization
    fit.splines &lt;-  idm(formula02=Hist(time=t,event=death,entry=e)~certif,
                        formula01=Hist(time=list(l,r),event=dementia)~certif,
                        formula12=~1,
                        method="Splines",
                        data=Paq1000)
    fit.weib
    summary(fit.splines)


</code></pre>

<hr>
<h2 id='idmModel'>Generate illness-death model objects</h2><span id='topic+idmModel'></span>

<h3>Description</h3>

<p>Function to generate an illness-death model for simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idmModel(
  scale.illtime = 1/100,
  shape.illtime = 1,
  scale.lifetime = 1/100,
  shape.lifetime = 1,
  scale.waittime = 1/100,
  shape.waittime = 1,
  scale.censtime = 1/100,
  shape.censtime = 1,
  n.inspections = 5,
  schedule = 10,
  punctuality = 5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idmModel_+3A_scale.illtime">scale.illtime</code></td>
<td>
<p>Weilbull scale for latent illness time</p>
</td></tr>
<tr><td><code id="idmModel_+3A_shape.illtime">shape.illtime</code></td>
<td>
<p>Weilbull shape for latent illness time</p>
</td></tr>
<tr><td><code id="idmModel_+3A_scale.lifetime">scale.lifetime</code></td>
<td>
<p>Weilbull scale for latent life time</p>
</td></tr>
<tr><td><code id="idmModel_+3A_shape.lifetime">shape.lifetime</code></td>
<td>
<p>Weilbull shape for latent life time</p>
</td></tr>
<tr><td><code id="idmModel_+3A_scale.waittime">scale.waittime</code></td>
<td>
<p>Weilbull scale for latent life time</p>
</td></tr>
<tr><td><code id="idmModel_+3A_shape.waittime">shape.waittime</code></td>
<td>
<p>Weilbull shape for latent life time</p>
</td></tr>
<tr><td><code id="idmModel_+3A_scale.censtime">scale.censtime</code></td>
<td>
<p>Weilbull scale for censoring time</p>
</td></tr>
<tr><td><code id="idmModel_+3A_shape.censtime">shape.censtime</code></td>
<td>
<p>Weilbull shape for censoring time</p>
</td></tr>
<tr><td><code id="idmModel_+3A_n.inspections">n.inspections</code></td>
<td>
<p>Number of inspection times</p>
</td></tr>
<tr><td><code id="idmModel_+3A_schedule">schedule</code></td>
<td>
<p>Mean of the waiting time between adjacent
inspections.</p>
</td></tr>
<tr><td><code id="idmModel_+3A_punctuality">punctuality</code></td>
<td>
<p>Standard deviation of waiting time between
inspections.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the functionality of the lava PACKAGE the function generates
a latent variable model (latent illtime, waittime and lifetime)
and censoring mechanism (censtime, inspection1,inspection2,...,inspectionK).
</p>
<p>The function <code><a href="#topic+sim.idmModel">sim.idmModel</a></code> then simulates
right censored lifetimes and interval censored illness times.
</p>


<h3>Value</h3>

<p>A latent variable model object <code>lvm</code>
</p>


<h3>Author(s)</h3>

<p>Thomas Alexander Gerds
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(lava)
library(prodlim)
# generate illness-death model based on exponentially
# distributed times
m &lt;- idmModel(scale.illtime=1/70,
              shape.illtime=1.8,
              scale.lifetime=1/50,
              shape.lifetime=0.7,
              scale.waittime=1/30,
              shape.waittime=0.7)
round(sim(m,6),1)

# Estimate the parameters of the Weibull models
# based on the uncensored exact event times
# and the uncensored illstatus.
set.seed(18)
d &lt;- sim(m,100,latent=FALSE)
d$uncensored.status &lt;- 1
f &lt;- idm(formula01=Hist(time=illtime,event=illstatus)~1,
         formula02=Hist(time=lifetime,event=uncensored.status)~1,
         data=d,
         conf.int=FALSE)
print(f)

# Change the rate of the 0-&gt;2 and 0-&gt;1 transitions
# also the rate of the 1-&gt;2 transition
# and also lower the censoring rate
m &lt;- idmModel(scale.lifetime=1/2000,
              scale.waittime=1/30,
              scale.illtime=1/1000,
              scale.censtime=1/1000)
set.seed(18)
d &lt;- sim(m,50,latent=TRUE)
d$uncensored.status &lt;- 1

f &lt;- idm(formula01=Hist(time=observed.illtime,event=illstatus)~1,
         formula02=Hist(time=observed.lifetime,event=uncensored.status)~1,
         data=d,
         conf.int=FALSE)
print(f)

# Estimate based on the right censored observations
fc &lt;- idm(formula01=Hist(time=illtime,event=seen.ill)~1,
          formula02=Hist(time=observed.lifetime,event=seen.exit)~1,
          data=d,
          conf.int=FALSE)
print(fc)

# Estimate based on interval censored and right censored observations
fi &lt;- idm(formula01=Hist(time=list(L,R),event=seen.ill)~1,
          formula02=Hist(time=observed.lifetime,event=seen.exit)~1,
          data=d,
          conf.int=FALSE)
print(fi)

# Estimation of covariate effects:
# X1, X2, X3
m &lt;- idmModel(shape.waittime=2,
              scale.lifetime=1/2000,
              scale.waittime=1/300,
              scale.illtime=1/10000,
              scale.censtime=1/10000)
distribution(m,"X1") &lt;- binomial.lvm(p=0.3)
distribution(m,"X2") &lt;- normal.lvm(mean=120,sd=20)
distribution(m,"X3") &lt;- normal.lvm(mean=50,sd=20)
regression(m,to="latent.illtime",from="X1") &lt;- 1.7
regression(m,to="latent.illtime",from="X2") &lt;- 0.07
regression(m,to="latent.illtime",from="X3") &lt;- -0.1
regression(m,to="latent.waittime",from="X1") &lt;- 1.8
regression(m,to="latent.lifetime",from="X1") &lt;- 0.7
set.seed(28)
d &lt;- sim(m,100,latent=TRUE)
head(d)
table(ill=d$seen.ill,death=d$seen.exit)

# Estimation based on uncensored data
d$uncensored.status &lt;- 1
# uncensored data
F1 &lt;- idm(formula01=Hist(time=illtime,event=illstatus)~X1+X2+X3,
          formula02=Hist(time=lifetime,event=uncensored.status)~X1+X2+X3,
          data=d,conf.int=FALSE)
print(F1)

# Estimation based on right censored data
F2 &lt;- idm(formula01=Hist(time=illtime,event=seen.ill)~X1+X2+X3,
          formula02=Hist(time=observed.lifetime,event=seen.exit)~X1+X2+X3,
          data=d,conf.int=FALSE)
print(F2)

# Estimation based on interval censored and right censored data
F3 &lt;- idm(formula01=Hist(time=list(L,R),event=seen.ill)~X1+X2+X3,
          formula02=Hist(time=observed.lifetime,event=seen.exit)~X1+X2+X3,
          data=d,conf.int=FALSE)
print(F3)
cbind(uncensored=F1$coef,right.censored=F2$coef,interval.censored=F3$coef)

</code></pre>

<hr>
<h2 id='intensity'>M-spline estimate of the transition intensity function</h2><span id='topic+intensity'></span>

<h3>Description</h3>

<p>M-spline estimate of the transition intensity function
and the cumulative transition intensity function
for survival and illness-death models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intensity(times, knots, number.knots, theta, linear.predictor = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="intensity_+3A_times">times</code></td>
<td>
<p>Time points at which to estimate the intensity function</p>
</td></tr>
<tr><td><code id="intensity_+3A_knots">knots</code></td>
<td>
<p>Knots for the M-spline</p>
</td></tr>
<tr><td><code id="intensity_+3A_number.knots">number.knots</code></td>
<td>
<p>Number of knots for the M-splines (and I-splines see details)</p>
</td></tr>
<tr><td><code id="intensity_+3A_theta">theta</code></td>
<td>
<p>The coefficients for the linear combination of M-splines (and I-splines see details)</p>
</td></tr>
<tr><td><code id="intensity_+3A_linear.predictor">linear.predictor</code></td>
<td>
<p>Linear predictor beta*Z. When it is non-zero, 
transition and cumulative transition are multiplied by <code>exp(linear.predictor)</code>. Default is zero.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimate of the transition intensity function is a linear
combination of M-splines and the estimate of the cumulative transition
intensity function is a linear combination of I-splines (the integral of a
M-spline is called I-spline). The coefficients <code>theta</code> are the same for
the M-splines and I-splines.
</p>
<p>Important: the theta parameters returned by <code>idm</code> and <code>shr</code> are in fact
the square root of the splines coefficients. See examples.
</p>
<p>This function is a R-translation of a corresponding Fortran function called <code>susp</code>. <code>susp</code> is
used internally by <code>idm</code> and <code>shr</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>times</code></td>
<td>
<p>The time points at which the following estimates are evaluated.</p>
</td></tr>
<tr><td><code>intensity</code></td>
<td>
<p>The transition intensity function evaluated at <code>times</code>.</p>
</td></tr>
<tr><td><code>cumulative.intensity</code></td>
<td>
<p>The cumulative transition intensity function evaluated at <code>times</code></p>
</td></tr>
<tr><td><code>survival</code></td>
<td>
<p>The &quot;survival&quot; function, i.e., exp(-cumulative.intensity)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>R: Celia Touraine &lt;Celia.Touraine@isped.u-bordeaux2.fr&gt; and Thomas Alexander Gerds &lt;tag@biostat.ku.dk&gt;
Fortran: Pierre Joly &lt;Pierre.Joly@isped.u-bordeaux2.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+shr">shr</a></code>, <code><a href="#topic+idm">idm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(testdata)
fit.su &lt;- shr(Hist(time=list(l, r), id) ~ cov,
              data = testdata,method = "Splines",CV = TRUE)
intensity(times = fit.su$time, knots = fit.su$knots,
           number.knots = fit.su$nknots, theta = fit.su$theta^2)


  data(Paq1000)
  fit.idm &lt;-  idm(formula02 = Hist(time = t, event = death, entry = e) ~ certif,
                  formula01 = Hist(time = list(l,r), event = dementia) ~ certif,
                  formula12 = ~ certif, method = "Splines", data = Paq1000)
  # Probability of survival in state 0 at age 80 for a subject with no cep given
  # that he is in state 0 at 70
  su0 &lt;- (intensity(times = 80, knots = fit.idm$knots01, 
                   number.knots = fit.idm$nknots01, 
                   theta = fit.idm$theta01^2)$survival
         *intensity(times = 80, knots = fit.idm$knots02, 
                   number.knots = fit.idm$nknots02, 
                   theta = fit.idm$theta02^2)$survival)/
        (intensity(times = 70, knots = fit.idm$knots01, 
                   number.knots = fit.idm$nknots01, 
                   theta = fit.idm$theta01^2)$survival
        *intensity(times = 70, knots = fit.idm$knots02, 
                   number.knots = fit.idm$nknots02, 
                   theta = fit.idm$theta02^2)$survival)
  # Same result as:  
  predict(fit.idm, s = 70, t = 80, conf.int = FALSE) # see first element               

</code></pre>

<hr>
<h2 id='Paq1000'>Paquid data set</h2><span id='topic+Paq1000'></span>

<h3>Description</h3>

<p>Paquid data set composed of 1000 subjects selected randomly from the Paquid
data set of 3675 subjects.
</p>


<h3>Format</h3>

<p>A data frame with 1000 rows and the following 8 columns.  </p>

<dl>
<dt>dementia</dt><dd><p>dementia status, 0=non-demented, 1=demented</p>
</dd>
<dt>death</dt><dd><p>death status, 0=alive, 1=dead</p>
</dd> <dt>e</dt><dd><p>age at
entry in the study</p>
</dd> <dt>l</dt><dd><p>for demented subjects: age at the visit
before the diagnostic visit; for non-demented subjects: age at the last
visit (censoring age)</p>
</dd> <dt>r</dt><dd><p>for demented subjects: age at the
diagnostic visit; for non-demented subjects: age at the last visit
(censoring age)</p>
</dd> <dt>t</dt><dd><p>for dead subjects: age at death; for alive
subject: age at the latest news</p>
</dd> <dt>certif</dt><dd><p>primary school
certificate:<code>0=without certificate</code>, <code>1=with certificate</code></p>
</dd>
<dt>gender</dt><dd><p>gender: <code>0=female</code>, <code>1=male</code></p>
</dd> </dl>



<h3>Examples</h3>

<pre><code class='language-R'>
data(Paq1000)

</code></pre>

<hr>
<h2 id='plot.idm'>Plot method for an illness-death model</h2><span id='topic+plot.idm'></span>

<h3>Description</h3>

<p>Plot estimated baseline transition intensities from an object of class
<code>idm</code> optionally with confidence limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'idm'
plot(
  x,
  conf.int = FALSE,
  citype = "shadow",
  add = FALSE,
  axes = TRUE,
  col,
  lwd,
  lty,
  xlim,
  ylim,
  xlab,
  ylab,
  legend = TRUE,
  transition = c("01", "02", "12"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.idm_+3A_x">x</code></td>
<td>
<p>a <code>idmWeib</code> class object (output from calling
<code>idm</code> with the (default) option <code>intensities</code>=&quot;Weib&quot;.</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_conf.int">conf.int</code></td>
<td>
<p>If TRUE show confidence limits</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_citype">citype</code></td>
<td>
<p>Type of confidence limits, can be &quot;shadow&quot; or &quot;bars&quot;</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_add">add</code></td>
<td>
<p>If TRUE add to existing plot</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_axes">axes</code></td>
<td>
<p>If TRUE axes are drawn</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_col">col</code></td>
<td>
<p>Color of the lines</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_lwd">lwd</code></td>
<td>
<p>Width of the lines</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_lty">lty</code></td>
<td>
<p>Type of the lines</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_xlim">xlim</code></td>
<td>
<p>Limits for x-axis</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_ylim">ylim</code></td>
<td>
<p>Limits for y-axis</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_ylab">ylab</code></td>
<td>
<p>Label for y-axis</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_legend">legend</code></td>
<td>
<p>If TRUE a legend is drawn, which can be further controlled via <code><a href="prodlim.html#topic+SmartControl">SmartControl</a></code>.</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_transition">transition</code></td>
<td>
<p>Choose one of the transition intensities: <code>c("01","02","12")</code>.</p>
</td></tr>
<tr><td><code id="plot.idm_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="prodlim.html#topic+SmartControl">SmartControl</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print a plot of the baseline transition intensities of an
illness-death model estimated using a Weibull approach.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.idm">print.idm</a></code>,<code><a href="#topic+summary.idm">summary.idm</a></code>,<code><a href="#topic+idm">idm</a></code>,
</p>
<p><code><a href="#topic+idm">idm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(lava)
library(prodlim)
m &lt;- idmModel(scale.lifetime=1/10,scale.illtime=1/8)
distribution(m,"X") &lt;- binomial.lvm()
regression(m,latent.lifetime~X) &lt;- 0.7
set.seed(30)
d &lt;- sim(m,100)
fit.weib &lt;- idm(formula02=Hist(observed.lifetime,event=seen.exit)~1,
formula01=Hist(time=list(L,R),event=seen.ill)~1,data=d,conf.int=FALSE)
plot(fit.weib)


## FIXME: the limits for the 01 transition are a bit wide!?
## with bootstrap confidence limits
fit.weib &lt;- idm(formula02=Hist(observed.lifetime,event=seen.exit)~1,
formula01=Hist(time=list(L,R),event=seen.ill)~1,data=d,conf.int=TRUE)
plot(fit.weib)

 

</code></pre>

<hr>
<h2 id='plot.shr'>Plot method for a survival model.</h2><span id='topic+plot.shr'></span>

<h3>Description</h3>

<p>Plot estimated baseline survival function from an object of class
<code>shr</code>. Pointwise confidence limits are available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shr'
plot(
  x,
  type = "shr",
  add = FALSE,
  newdata = NULL,
  cause = NULL,
  col,
  lty,
  lwd,
  ylim,
  xlim,
  xlab = "Time",
  ylab,
  legend = TRUE,
  confint = TRUE,
  timeOrigin = 0,
  axes = TRUE,
  percent = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.shr_+3A_x">x</code></td>
<td>
<p>a <code>shrWeib</code> or a <code>shrSplines</code> class object (output from
calling <code><a href="#topic+shr">shr</a></code> function).</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_type">type</code></td>
<td>
<p>type of function to plot. The default is &quot;shr&quot;.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_add">add</code></td>
<td>
<p>boolean.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_newdata">newdata</code></td>
<td>
<p>newdata.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_cause">cause</code></td>
<td>
<p>cause.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_col">col</code></td>
<td>
<p>col.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_lty">lty</code></td>
<td>
<p>lty.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_lwd">lwd</code></td>
<td>
<p>lwd.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_ylim">ylim</code></td>
<td>
<p>ylim.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_xlim">xlim</code></td>
<td>
<p>xlim.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_xlab">xlab</code></td>
<td>
<p>xlab.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_ylab">ylab</code></td>
<td>
<p>ylab.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_legend">legend</code></td>
<td>
<p>legend.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_confint">confint</code></td>
<td>
<p>confint.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_timeorigin">timeOrigin</code></td>
<td>
<p>timeOrigin.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_axes">axes</code></td>
<td>
<p>axes.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_percent">percent</code></td>
<td>
<p>percent.</p>
</td></tr>
<tr><td><code id="plot.shr_+3A_...">...</code></td>
<td>
<p>other graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print a plot of a suvival model.
</p>


<h3>Author(s)</h3>

<p>R: Celia Touraine &lt;Celia.Touraine@isped.u-bordeaux2.fr&gt; Fortran:
Pierre Joly &lt;Pierre.Joly@isped.u-bordeaux2.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.shr">plot.shr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Weibull survival model
library(prodlim)
data(testdata)
fit.su &lt;- shr(Hist(time=list(l,r),id)~cov,data=testdata) 

# pointwise confidence limits
plot(fit.su)

# no pointwise confidence limits
plot(fit.su,confint=FALSE)


</code></pre>

<hr>
<h2 id='predict.idm'>Predictions for an illness-death model using either a penalized likelihood
approach or a Weibull parametrization.</h2><span id='topic+predict.idm'></span>

<h3>Description</h3>

<p>Predict transition probabilities and cumulative probabilities from an object
of class <code>idmSplines</code> with confidence intervals are calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'idm'
predict(
  object,
  s,
  t,
  newdata,
  nsim = 200,
  seed = 21,
  conf.int = 0.95,
  lifeExpect = FALSE,
  maxtime,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.idm_+3A_object">object</code></td>
<td>
<p>an <code>idm</code> class objects returned by a call to the
<code><a href="#topic+idm">idm</a></code> function</p>
</td></tr>
<tr><td><code id="predict.idm_+3A_s">s</code></td>
<td>
<p>time point at which prediction is made.</p>
</td></tr>
<tr><td><code id="predict.idm_+3A_t">t</code></td>
<td>
<p>time horizon for prediction.</p>
</td></tr>
<tr><td><code id="predict.idm_+3A_newdata">newdata</code></td>
<td>
<p>A data frame with covariate values for prediction.</p>
</td></tr>
<tr><td><code id="predict.idm_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations for the confidence intervals
calculations.  The default is 200.</p>
</td></tr>
<tr><td><code id="predict.idm_+3A_seed">seed</code></td>
<td>
<p>Seed passed to <code>set.seed</code> for Monte Carlo
simulation of confidence intervals.</p>
</td></tr>
<tr><td><code id="predict.idm_+3A_conf.int">conf.int</code></td>
<td>
<p>Level of confidence, i.e., a value between 0 and 1,
the default is <code>0.95</code>.  The default is also used when
<code>conf.int=TRUE</code>.  To avoid computation of confidence
intervals, set <code>conf.int</code> to FALSE or NULL.</p>
</td></tr>
<tr><td><code id="predict.idm_+3A_lifeexpect">lifeExpect</code></td>
<td>
<p>Logical. If <code>TRUE</code> compute life
expectancies, i.e., <code>t=Inf</code>.</p>
</td></tr>
<tr><td><code id="predict.idm_+3A_maxtime">maxtime</code></td>
<td>
<p>The upper limit of integration for calculations of life expectancies from Weibull parametrizations.</p>
</td></tr>
<tr><td><code id="predict.idm_+3A_...">...</code></td>
<td>
<p>other parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the following predictions with pointwise
confidence intervals: </p>
<table role = "presentation">
<tr><td><code>p00</code></td>
<td>
<p>the transition probability
<code class="reqn">p_{00}</code>.</p>
</td></tr>  <tr><td><code>p01</code></td>
<td>
<p>the transition probability
<code class="reqn">p_{01}</code>.</p>
</td></tr> <tr><td><code>p11</code></td>
<td>
<p>the transition probability
<code class="reqn">p_{11}</code>.</p>
</td></tr> <tr><td><code>p12</code></td>
<td>
<p>the transition probability
<code class="reqn">p_{12}</code>.</p>
</td></tr> <tr><td><code>p02_0</code></td>
<td>
<p>the probability of direct
transition from state 0 to state 2.</p>
</td></tr> <tr><td><code>p02_1</code></td>
<td>
<p>the
probability of transition from state 0 to state 2 via state 1.</p>
</td></tr>
<tr><td><code>p02</code></td>
<td>
<p>transition probability <code class="reqn">p_{02}</code>. Note that
<code>p02</code>=<code>p_02_0</code>+<code>p02_1</code>.</p>
</td></tr> <tr><td><code>F01</code></td>
<td>
<p>the lifetime
risk of disease. <code>F01</code>=<code>p01</code>+<code>p02_1</code>.</p>
</td></tr>
<tr><td><code>F0.</code></td>
<td>
<p>the probability of exit from state
0. <code>F0.</code>=<code>p02_0</code>+<code>p01</code>+<code>p02_1</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>R: Celia Touraine &lt;Celia.Touraine@isped.u-bordeaux2.fr&gt;
and Thomas Alexander Gerds &lt;tag@biostat.ku.dk&gt; Fortran: Pierre
Joly &lt;Pierre.Joly@isped.u-bordeaux2.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+idm">idm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(100)
d=simulateIDM(n = 200)
fit &lt;- idm(formula01=Hist(time=list(L,R),event=seen.ill)~X1+X2+X3,
               formula02=Hist(time=observed.lifetime,event=seen.exit)~X1+X2+X3,
               data=d,conf.int=FALSE)
predict(fit,s=0,t=80,conf.int=FALSE,lifeExpect=FALSE)
predict(fit,s=0,t=80,nsim=4,conf.int=TRUE,lifeExpect=FALSE)
predict(fit,s=0,t=80,nsim=4,conf.int=FALSE,lifeExpect=TRUE)

data(Paq1000)
library(prodlim)
fit.paq &lt;- idm(formula02=Hist(time=t,event=death,entry=e)~certif,
formula01=Hist(time=list(l,r),event=dementia)~certif,data=Paq1000)

predict(fit.paq,s=70,t=80,newdata=data.frame(certif=1))
predict(fit.paq,s=70,lifeExpect=TRUE,newdata=data.frame(certif=1))

fit.splines &lt;-  idm(formula02=Hist(time=t,event=death,entry=e)~certif,
		formula01=Hist(time=list(l,r),event=dementia)~certif,
                formula12=~1,
                method="Splines",
		data=Paq1000)

predict(fit.splines,s=70,t=80,newdata=data.frame(certif=1))
predict(fit.splines,s=70,t=80,lifeExpect=TRUE,newdata=data.frame(certif=1),nsim=20)




</code></pre>

<hr>
<h2 id='print.idm'>Print method for <code>idm</code> objects</h2><span id='topic+print.idm'></span>

<h3>Description</h3>

<p>Print a summary of a fitted illness-death model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'idm'
print(x, conf.int = 0.95, digits = 4, pvalDigits = 4, eps = 0.0001, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.idm_+3A_x">x</code></td>
<td>
<p>Class <code>idm</code> object, i.e. the result of a call to the
<code><a href="#topic+idm">idm</a></code> function with <code>intensities</code>=&quot;Weib&quot;.</p>
</td></tr>
<tr><td><code id="print.idm_+3A_conf.int">conf.int</code></td>
<td>
<p>The level of confidence for the hazard ratios. The default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="print.idm_+3A_digits">digits</code></td>
<td>
<p>Number of digits to print.</p>
</td></tr>
<tr><td><code id="print.idm_+3A_pvaldigits">pvalDigits</code></td>
<td>
<p>Number of digits to print for p-values.</p>
</td></tr>
<tr><td><code id="print.idm_+3A_eps">eps</code></td>
<td>
<p>Passed to <code>format.pval</code>.</p>
</td></tr>
<tr><td><code id="print.idm_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>Author(s)</h3>

<p>Celia Touraine &lt;Celia.Touraine@isped.u-bordeaux2.fr&gt;, Thomas A. Gerds &lt;tag@biostat.ku.dk&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.idm">summary.idm</a></code>, <code><a href="#topic+plot.idm">plot.idm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Paq1000)
library(prodlim)
fit.splines &lt;-  idm(formula02=Hist(time=t,event=death,entry=e)~certif,
		formula01=Hist(time=list(l,r),event=dementia)~certif,
                formula12=~1,
                method="Splines",
		data=Paq1000)
print(fit.splines)


</code></pre>

<hr>
<h2 id='print.shr'>Print method for <code>shrSplines</code> objects</h2><span id='topic+print.shr'></span>

<h3>Description</h3>

<p>Print a summary of a fitted illness-death model using the penalized
likelihood approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shr'
print(x, conf.int = 0.95, digits = 4, pvalDigits = 4, eps = 0.0001, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.shr_+3A_x">x</code></td>
<td>
<p>a <code>shr</code> object, i.e., the result of a call to the
<code><a href="#topic+shr">shr</a></code> function with <code>hazard</code>=&quot;Splines&quot;.</p>
</td></tr>
<tr><td><code id="print.shr_+3A_conf.int">conf.int</code></td>
<td>
<p>The level of confidence for the hazard ratios. The default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="print.shr_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>
<tr><td><code id="print.shr_+3A_pvaldigits">pvalDigits</code></td>
<td>
<p>number of digits to print for p-values.</p>
</td></tr>
<tr><td><code id="print.shr_+3A_eps">eps</code></td>
<td>
<p>convergence criterion used for p-values.</p>
</td></tr>
<tr><td><code id="print.shr_+3A_...">...</code></td>
<td>
<p>other unusued arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>Author(s)</h3>

<p>R: Celia Touraine &lt;Celia.Touraine@isped.u-bordeaux2.fr&gt; Fortran:
Pierre Joly &lt;Pierre.Joly@isped.u-bordeaux2.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.shr">summary.shr</a></code>, <code><a href="#topic+plot.shr">plot.shr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# a penalized survival model 
library(prodlim)
data(testdata)
fit.su &lt;- shr(Hist(time=list(l,r),id)~cov,data=testdata,method="Splines") 
print(fit.su) 

</code></pre>

<hr>
<h2 id='shr'>Fit a survival model</h2><span id='topic+shr'></span>

<h3>Description</h3>

<p>Fit a survival model using either a semi-parametric approach (penalized
likelihood with an approximation of the hazard function by linear
combination of M-splines) or a parametric approach (specifying a Weibull
distribution on the hazard function). Left-truncated, right-censored, and
interval-censored data are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shr(
  formula,
  data,
  eps = c(5, 5, 3),
  n.knots = 7,
  knots = "equidistant",
  CV = FALSE,
  kappa = 10000,
  conf.int = 0.95,
  maxiter = 200,
  method = "Weib",
  print.iter = FALSE,
  na.action = na.omit
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shr_+3A_formula">formula</code></td>
<td>
<p>a formula object with the response on the left hand side
and the terms on the right hand side. The
response must be a survival object or Hist object as returned by
the <code>'Surv'</code> or <code>'Hist'</code> function.</p>
</td></tr>
<tr><td><code id="shr_+3A_data">data</code></td>
<td>
<p>a data frame in which to interpret the variables named
in the <code>formula</code>.</p>
</td></tr>
<tr><td><code id="shr_+3A_eps">eps</code></td>
<td>
<p>a vector of length 3 for the convergence criteria
(criterion for parameters, criterion for likelihood, criterion for
second derivatives). The default is <code>c(5,5,3)</code> and corresponds to
criteria equals to <code>10^{-5}</code>, <code>10^{-5}</code> and <code>10^{-3}</code>.</p>
</td></tr>
<tr><td><code id="shr_+3A_n.knots">n.knots</code></td>
<td>
<p>Argument only active for the penalized likelihood approach <code>method="splines"</code>.
Number of knots for the splines to use to approximate
the hazard function. The default is 7. If <code>knots</code> are given as a vector this argument is ignored.
The algorithm needs least 5 knots and at most 20 knots.</p>
</td></tr>
<tr><td><code id="shr_+3A_knots">knots</code></td>
<td>
<p>Argument only active for the penalized likelihood approach <code>method="splines"</code>.
There are three ways to control the placement of the knots between the smallest and the largest
of all time points:
</p>

<dl>
<dt><code>knots="equidistant"</code></dt><dd><p>Knots are placed with same distance on the time scale.</p>
</dd>
<dt><code>knots="quantiles"</code></dt><dd><p>Knots are placed such that the number of observations is roughly the same between knots.</p>
</dd>
<dt>knots=list()</dt><dd><p>List of length 3. The list elements are the actual placements
(timepoints) of the knots for the M-spline.</p>
</dd>
</dl>

<p>The algorithm reuqires at least 5 knots and allows no more than 20 knots.</p>
</td></tr>
<tr><td><code id="shr_+3A_cv">CV</code></td>
<td>
<p>binary variable equals to 1 when search (by approximated
cross validation) of the smoothing parameter kappa and 0
otherwise. Argument for the penalized likelihood approach. The
default is 0.</p>
</td></tr>
<tr><td><code id="shr_+3A_kappa">kappa</code></td>
<td>
<p>Argument only active for the penalized likelihood approach <code>method="splines"</code>.
A positive number (smoothing parameter) 
If CV=1 the value is used as a starting value 
for a cross validation search to optimize <code>kappa</code>.</p>
</td></tr>
<tr><td><code id="shr_+3A_conf.int">conf.int</code></td>
<td>
<p>Level of confidence pointwise confidence intervals of the survival and hazard functions, i.e.,
a value between 0 and 1, the default is <code>0.95</code>.
The default is also used when <code>conf.int=TRUE</code>.
To avoid computation of confidence intervals, set <code>conf.int</code> to FALSE or NULL.</p>
</td></tr>
<tr><td><code id="shr_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations. The default is 200.</p>
</td></tr>
<tr><td><code id="shr_+3A_method">method</code></td>
<td>
<p>type of estimation method: &quot;Splines&quot; for a penalized
likelihood approach with approximation of the hazard function by
M-splines, &quot;Weib&quot; for a parametric approach with a Weibull
distribution on the hazard function. Default is <code>"Weib"</code>.</p>
</td></tr>
<tr><td><code id="shr_+3A_print.iter">print.iter</code></td>
<td>
<p>boolean parameter. Equals to <code>TRUE</code> to print
the likelihood during the iteration process, <code>FALSE</code>
otherwise. Default is <code>FALSE</code>. This option is not running on
Windows.</p>
</td></tr>
<tr><td><code id="shr_+3A_na.action">na.action</code></td>
<td>
<p>how NAs are treated. The default is first, any
na.action attribute of data, second a na.action setting of options,
and third 'na.fail' if that is unset. The 'factory-fresh' default
is na.omit. Another possible value is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimated parameters are obtained using the robust Marquardt algorithm
(Marquardt, 1963) which is a combination between a Newton-Raphson algorithm
and a steepest descent algorithm.
</p>


<h3>Value</h3>


<dl>
<dt>call</dt><dd></dd> <dt>coef</dt><dd><p>regression parameters.</p>
</dd>
<dt>loglik</dt><dd><p>vector containing the log-likelihood without and with covariate.</p>
</dd>
<dt>modelPar</dt><dd><p>Weibull parameters.</p>
</dd>
<dt>N</dt><dd><p>number of subjects.</p>
</dd>
<dt>NC</dt><dd><p>number of covariates.</p>
</dd>
<dt>nevents</dt><dd><p>number of events.</p>
</dd>
<dt>modelResponse</dt><dd><p>model response: <code>Hist</code> or <code>Surv</code> object.</p>
</dd>
<dt>converged</dt><dd><p>integer equal to 1 when the model converged, 2, 3 or 4 otherwise.</p>
</dd>
<dt>time</dt><dd><p>times for which survival and hazard functions have been evaluated for plotting.</p>
</dd>
<dt>hazard</dt><dd><p>matched values of the hazard function.</p>
</dd>
<dt>lowerHazard</dt><dd><p>lower confidence limits for hazard function.</p>
</dd>
<dt>upperHazard</dt><dd><p>upper confidence limits for hazard function.</p>
</dd>
<dt>surv</dt><dd><p>matched values of the survival function.</p>
</dd>
<dt>lowerSurv</dt><dd><p>lower confidence limits for survival function.</p>
</dd>
<dt>upperSurv</dt><dd><p>upper confidence limits for survival function.</p>
</dd>
<dt>RR</dt><dd><p>vector of relative risks.</p>
</dd>
<dt>V</dt><dd><p>variance-covariance matrix.</p>
</dd>
<dt>se</dt><dd><p>standard errors.</p>
</dd>
<dt>knots</dt><dd><p>knots of the M-splines estimate of the hazard function.</p>
</dd>
<dt>nknots</dt><dd><p>number of knots.</p>
</dd>
<dt>CV</dt><dd><p>a binary variable equals to 1 when search of the smoothing parameter
<a href="base.html#topic+kappa">kappa</a> by approximated cross-validation, 1 otherwise. The default is 0.</p>
</dd>
<dt>niter</dt><dd><p>number of iterations.</p>
</dd>
<dt>cv</dt><dd><p>vector containing the convergence criteria.</p>
</dd>
<dt>na.action</dt><dd><p>observations deleted if missing values.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>R: Celia Touraine <a href="mailto:celia.touraine@icm.unicancer.fr">celia.touraine@icm.unicancer.fr</a> Fortran:
Pierre Joly <a href="mailto:Pierre.Joly@isped.u-bordeaux2.fr">Pierre.Joly@isped.u-bordeaux2.fr</a>
</p>


<h3>References</h3>

<p>D. Marquardt (1963). An algorithm for least-squares estimation
of nonlinear parameters.  <em>SIAM Journal of Applied Mathematics</em>,
431-441.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+shr">shr</a></code>, <code><a href="#topic+print.shr">print.shr</a></code>,
<code><a href="#topic+summary.shr">summary.shr</a></code>, <code><a href="#topic+print.shr">print.shr</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Weibull survival model
library(prodlim)
data(testdata)
fit.su &lt;- shr(Hist(time=list(l,r),id)~cov,data=testdata) 
fit.su
summary(fit.su)

shr.spline &lt;- shr(Hist(time=list(l,r),id)~cov,data=testdata,method="splines",n.knots=6)
shr.spline
shr.spline.q &lt;- shr(Hist(time=list(l,r),id)~cov,data=testdata,
                    method="splines",n.knots=6,knots="quantiles")
plot(shr.spline.q)

## manual placement of knots
shr.spline.man &lt;- shr(Hist(time=list(l,r),id)~cov,data=testdata,method="splines",knots=seq(0,7,1))

</code></pre>

<hr>
<h2 id='sim.idmModel'>Simulate illness-death model data</h2><span id='topic+sim.idmModel'></span>

<h3>Description</h3>

<p>Function to simulate illness-death model data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'idmModel'
sim(
  x,
  n,
  illness.known.at.death = TRUE,
  compliance = 1,
  latent = FALSE,
  keep.inspectiontimes = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.idmModel_+3A_x">x</code></td>
<td>
<p>An <code>idmModel</code> object as obtained with
<code>idmModel</code></p>
</td></tr>
<tr><td><code id="sim.idmModel_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code id="sim.idmModel_+3A_illness.known.at.death">illness.known.at.death</code></td>
<td>
<p>Affects the value of variable
seen.ill</p>
</td></tr>
<tr><td><code id="sim.idmModel_+3A_compliance">compliance</code></td>
<td>
<p>Probability of missing an inspection time.</p>
</td></tr>
<tr><td><code id="sim.idmModel_+3A_latent">latent</code></td>
<td>
<p>if TRUE keep the latent event times</p>
</td></tr>
<tr><td><code id="sim.idmModel_+3A_keep.inspectiontimes">keep.inspectiontimes</code></td>
<td>
<p>if <code>TRUE</code> keep the inspection
times.</p>
</td></tr>
<tr><td><code id="sim.idmModel_+3A_...">...</code></td>
<td>
<p>Extra arguments given to <code>sim</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the functionality of the lava PACKAGE
</p>


<h3>Value</h3>

<p>A data set with interval censored observations from an illness-death model
</p>


<h3>Author(s)</h3>

<p>Thomas Alexander Gerds
</p>


<h3>Examples</h3>

<pre><code class='language-R'>example(idmModel)
help(idmModel)
</code></pre>

<hr>
<h2 id='sim.survIC'>Simulate interval censored survival data</h2><span id='topic+sim.survIC'></span>

<h3>Description</h3>

<p>Function to simulate interval censored survival data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survIC'
sim(x, n, compliance = 1, latent = TRUE, keep.inspectiontimes = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.survIC_+3A_x">x</code></td>
<td>
<p>An <code>survIC</code> object as obtained with
<code>survIC</code></p>
</td></tr>
<tr><td><code id="sim.survIC_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code id="sim.survIC_+3A_compliance">compliance</code></td>
<td>
<p>Probability of missing an inspection time.</p>
</td></tr>
<tr><td><code id="sim.survIC_+3A_latent">latent</code></td>
<td>
<p>if TRUE keep the latent event times</p>
</td></tr>
<tr><td><code id="sim.survIC_+3A_keep.inspectiontimes">keep.inspectiontimes</code></td>
<td>
<p>if <code>TRUE</code> keep the inspection
times.</p>
</td></tr>
<tr><td><code id="sim.survIC_+3A_...">...</code></td>
<td>
<p>Extra arguments given to <code>sim</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the functionality of the lava PACKAGE
</p>


<h3>Value</h3>

<p>A data set with interval censored observations
</p>


<h3>Author(s)</h3>

<p>Thomas Alexander Gerds
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lava)
example(survIC)
help(survIC)
ol &lt;- survIC()
dat.ol &lt;- sim(ol,10)
</code></pre>

<hr>
<h2 id='simulateIDM'>Sample illness-death model data</h2><span id='topic+simulateIDM'></span>

<h3>Description</h3>

<p>Simulate data from an illness-death model with interval censored event times and covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulateIDM(n = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulateIDM_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulate data from an illness-death model with interval censored event times
and covariates for the purpose of illustrating the help pages of the SmoothHazard package.
See the body of the function for details, i.e., evaluate simulateIDM
</p>


<h3>Value</h3>

<p>Object with class <code>data.frame</code> which contains the simulated data.
</p>


<h3>See Also</h3>

<p>idmModel sim.idmModel
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulateIDM
simulateIDM(100)
</code></pre>

<hr>
<h2 id='summary.idm'>Summary of a fitted illness-death model</h2><span id='topic+summary.idm'></span>

<h3>Description</h3>

<p>Summarize the event history data of an illness-death regression model
and show regression coefficients for transition intensities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'idm'
summary(object, conf.int = 0.95, digits = 4, pvalDigits = 4, eps = 0.0001, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.idm_+3A_object">object</code></td>
<td>
<p>a <code>idmSplines</code> object, i.e., the result of a call to the
<code><a href="#topic+idm">idm</a></code> function with <code>intensities</code>=&quot;Splines&quot;.</p>
</td></tr>
<tr><td><code id="summary.idm_+3A_conf.int">conf.int</code></td>
<td>
<p>The level of confidence for the hazard ratios. The default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="summary.idm_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>
<tr><td><code id="summary.idm_+3A_pvaldigits">pvalDigits</code></td>
<td>
<p>number of digits to print for p-values.</p>
</td></tr>
<tr><td><code id="summary.idm_+3A_eps">eps</code></td>
<td>
<p>convergence criterion used for p-values.</p>
</td></tr>
<tr><td><code id="summary.idm_+3A_...">...</code></td>
<td>
<p>other unusued arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>Author(s)</h3>

<p>R: Celia Touraine &lt;Celia.Touraine@isped.u-bordeaux2.fr&gt; Fortran:
Pierre Joly &lt;Pierre.Joly@isped.u-bordeaux2.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+idm">idm</a></code>, <code><a href="#topic+print.idm">print.idm</a></code>,
<code><a href="#topic+plot.idm">plot.idm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(prodlim)
data(Paq1000)
fit.splines &lt;-  idm(formula02=Hist(time=t,event=death,entry=e)~certif,
		formula01=Hist(time=list(l,r),event=dementia)~certif,
                formula12=~1,
                method="Splines",
		data=Paq1000)
summary(fit.splines) 

</code></pre>

<hr>
<h2 id='summary.shr'>Summary of a fitted survival model using a penalized likelihood approach</h2><span id='topic+summary.shr'></span>

<h3>Description</h3>

<p>Print a short summary of a fitted illness-death model using the penalized
likelihood approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shr'
summary(object, conf.int = 0.95, digits = 4, pvalDigits = 4, eps = 0.0001, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.shr_+3A_object">object</code></td>
<td>
<p>a <code>shr</code> object, i.e., the result of a call to the
<code><a href="#topic+shr">shr</a></code> function.</p>
</td></tr>
<tr><td><code id="summary.shr_+3A_conf.int">conf.int</code></td>
<td>
<p>The level of confidence for the hazard ratios. The default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="summary.shr_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>
<tr><td><code id="summary.shr_+3A_pvaldigits">pvalDigits</code></td>
<td>
<p>number of digits to print for p-values.</p>
</td></tr>
<tr><td><code id="summary.shr_+3A_eps">eps</code></td>
<td>
<p>convergence criterion used for p-values.</p>
</td></tr>
<tr><td><code id="summary.shr_+3A_...">...</code></td>
<td>
<p>other unusued arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>Author(s)</h3>

<p>Celia Touraine &lt;Celia.Touraine@isped.u-bordeaux2.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+shr">shr</a></code>, <code><a href="#topic+print.shr">print.shr</a></code>,
<code><a href="#topic+plot.shr">plot.shr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# a penalized survival model 
data(testdata)
library(prodlim)
fit.su &lt;- shr(Hist(time=list(l,r),id)~cov,data=testdata,method="Splines") 
summary(fit.su)

# Weibull survival model 
data(testdata)
fit.su &lt;- shr(Hist(time=list(l,r),id)~cov,data=testdata) 
summary(fit.su) 

</code></pre>

<hr>
<h2 id='survIC'>Generate survival model objects</h2><span id='topic+survIC'></span><span id='topic+survModelIC'></span>

<h3>Description</h3>

<p>Function to generate a latent variable model for interval censored survival times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survIC(
  scale.time = 1/100,
  shape.time = 1,
  n.inspections = 5,
  schedule = 10,
  punctuality = 5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survIC_+3A_scale.time">scale.time</code></td>
<td>
<p>Weilbull scale for latent time</p>
</td></tr>
<tr><td><code id="survIC_+3A_shape.time">shape.time</code></td>
<td>
<p>Weilbull shape for latent time</p>
</td></tr>
<tr><td><code id="survIC_+3A_n.inspections">n.inspections</code></td>
<td>
<p>Number of inspection times</p>
</td></tr>
<tr><td><code id="survIC_+3A_schedule">schedule</code></td>
<td>
<p>Mean of the waiting time between adjacent
inspections.</p>
</td></tr>
<tr><td><code id="survIC_+3A_punctuality">punctuality</code></td>
<td>
<p>Standard deviation of waiting time between
inspections.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the functionality of the lava PACKAGE the function generates
a latent variable model with a latent time
and a censoring mechanism (censtime, inspection1,inspection2,...,inspectionK).
</p>
<p>The function <code><a href="#topic+sim.survIC">sim.survIC</a></code> then simulates
interval censored times.
</p>


<h3>Value</h3>

<p>A latent variable model object <code>lvm</code>
</p>


<h3>Author(s)</h3>

<p>Thomas Alexander Gerds
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(lava)
library(prodlim)
# generate survival model based on exponentially
# distributed times
m &lt;- survIC(scale.time=1/50, shape.time=0.7)
round(sim(m,6),1)

# Estimate the parameters of the Weibull models
# based on the uncensored exact event times
# and the uncensored illstatus.
set.seed(18)
d &lt;- sim(m,100,latent=FALSE)
d$uncensored.status &lt;- 1
f &lt;- shr(Hist(time=list(L,R),event=uncensored.status)~1,
         data=d,
         conf.int=FALSE)
print(f)

</code></pre>

<hr>
<h2 id='testdata'>Data set for survival models: right-censored and interval-censored data.</h2><span id='topic+testdata'></span>

<h3>Description</h3>

<p>A simulated data frame for survival models composed of right-censored and
interval-censored data.
</p>


<h3>Format</h3>

<p>A data frame with 936 observations on the following 4 variables.
</p>
 <dl>
<dt>l</dt><dd><p>for diseased subjects: left endpoint of
censoring interval; for non-diseased subjects: right censoring time</p>
</dd>
<dt>r</dt><dd><p>for diseased subjects: right endpoint of censoring
interval; for non-diseased subjects: right censoring time for the disease
event</p>
</dd> <dt>id</dt><dd><p>disease status</p>
</dd> <dt>cov</dt><dd><p>covariate</p>
</dd> </dl>



<h3>Examples</h3>

<pre><code class='language-R'>
data(testdata)
head(testdata)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
