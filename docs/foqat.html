<!DOCTYPE html><html><head><title>Help for package foqat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {foqat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#afp'><p>Calculate aerosol formation potential</p></a></li>
<li><a href='#anylm'><p>Analysis of linear regression for time series in batch</p></a></li>
<li><a href='#aqi'><p>Demo data of air quality</p></a></li>
<li><a href='#avri'><p>Calculate average of variation</p></a></li>
<li><a href='#dm8n'><p>Calculate daily maximum-8-hour ozone</p></a></li>
<li><a href='#dm8n_batch'><p>Calculate daily maximum-8-hour ozone in batch</p></a></li>
<li><a href='#dm8n_np'><p>Calculate daily maximum-8-hour ozone without printing plot</p></a></li>
<li><a href='#fm'><p>format the theme of plot</p></a></li>
<li><a href='#geom_avri'><p>Plot the average variation</p></a></li>
<li><a href='#geom_avri_batch'><p>Plot the average variation in batch</p></a></li>
<li><a href='#geom_psd'><p>Plot the time series of particle size distribution.</p></a></li>
<li><a href='#geom_ts'><p>Plot time series</p></a></li>
<li><a href='#geom_ts_batch'><p>Plot time series in batch</p></a></li>
<li><a href='#geom_tsw'><p>Plot time series</p></a></li>
<li><a href='#koh'><p>get kOH</p></a></li>
<li><a href='#loh'><p>Calculate OH reactivity</p></a></li>
<li><a href='#met'><p>Demo data of meteorology</p></a></li>
<li><a href='#nsvp'><p>Calculate Surface Area, Volume, Mass of particle by particle number concentration</p></a></li>
<li><a href='#ofp'><p>Calculate ozone formation potential</p></a></li>
<li><a href='#prop'><p>Convert time series into proportion time series</p></a></li>
<li><a href='#setup_tuv'><p>Demo data of setup for tuv</p></a></li>
<li><a href='#statdf'><p>Summary of dataframe</p></a></li>
<li><a href='#svri'><p>Compute the variation of summary statistics</p></a></li>
<li><a href='#transp'><p>Convert the format of particle size data</p></a></li>
<li><a href='#trs'><p>Resample time series by summary statistics</p></a></li>
<li><a href='#tuv'><p>Calculate TUV in batch</p></a></li>
<li><a href='#tuv_batch'><p>Calculate TUV in Batch Online</p></a></li>
<li><a href='#tuv_core'><p>Calculate TUV Online</p></a></li>
<li><a href='#voc'><p>Demo data of volatile organic compounds (VOCs)</p></a></li>
<li><a href='#vocct'><p>Convertion and analysis of VOC concentrations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Field Observation Quick Analysis Toolkit</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.8.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Tianshu Chen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tianshu Chen &lt;tianshu129@163.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for quickly processing and analyzing 
	field observation data and air quality data. This 
	tools contain functions that facilitate analysis 
	in atmospheric chemistry (especially in ozone 
	pollution). Some functions of time series are also 
	applicable to other fields. For detail please view 
	homepage<a href="https://github.com/tianshu129/foqat">https://github.com/tianshu129/foqat</a>.
	Scientific Reference:
	1. The Hydroxyl Radical (OH) Reactivity: Roger Atkinson and Janet Arey (2003) &lt;<a href="https://doi.org/10.1021%2Fcr0206420">doi:10.1021/cr0206420</a>&gt;.
	2. Ozone Formation Potential (OFP): <a href="http://ww2.arb.ca.gov/sites/default/files/barcu/regact/2009/mir2009/mir10.pdf">http://ww2.arb.ca.gov/sites/default/files/barcu/regact/2009/mir2009/mir10.pdf</a>, Zhang et al.(2021) &lt;<a href="https://doi.org/10.5194%2Facp-21-11053-2021">doi:10.5194/acp-21-11053-2021</a>&gt;.
	3. Aerosol Formation Potential (AFP): Wenjing Wu et al. (2016) &lt;<a href="https://doi.org/10.1016%2Fj.jes.2016.03.025">doi:10.1016/j.jes.2016.03.025</a>&gt;.
	4. TUV model: <a href="https://www2.acom.ucar.edu/modeling/tropospheric-ultraviolet-and-visible-tuv-radiation-model">https://www2.acom.ucar.edu/modeling/tropospheric-ultraviolet-and-visible-tuv-radiation-model</a>.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tianshu129/foqat">https://github.com/tianshu129/foqat</a>,
<a href="https://tianshu129.github.io/foqat/">https://tianshu129.github.io/foqat/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tianshu129/foqat/issues">https://github.com/tianshu129/foqat/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lubridate, magrittr, dplyr, plyr, stats, stringr, utils,
lmodel2, reshape2, ggplot2, ggplotify, gridExtra, scales,
rvest, xml2, ggnewscale, patchwork</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-30 05:54:29 UTC; chentianshu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-30 06:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='afp'>Calculate aerosol formation potential</h2><span id='topic+afp'></span>

<h3>Description</h3>

<p>Calculate Aerosol Formation Potential (AFP) of VOC time series. Unit of AFP is ug/m3.
Note: for Chinese VOC name, please also use English punctuation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>afp(
  df,
  inunit = "ppbv",
  t = 25,
  p = 101.325,
  stcd = FALSE,
  sortd = TRUE,
  chn = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="afp_+3A_df">df</code></td>
<td>
<p>dataframe contains time series.</p>
</td></tr>
<tr><td><code id="afp_+3A_inunit">inunit</code></td>
<td>
<p>input's unit for VOC concentration. A character vector from these options: &quot;ugm&quot; or &quot;ppbv&quot;. 
&quot;ugm&quot; means ug/m3. &quot;ppbv&quot; means part per billion volumn. The default vaule is &quot;ppbv&quot;.</p>
</td></tr>
<tr><td><code id="afp_+3A_t">t</code></td>
<td>
<p>Temperature, in Degrees Celsius, used to convert data in 
micrograms per cubic meter to standard conditions 
(25 Degrees Celsius, 101.325 kPa). By default, t equals to 25 Degrees Celsius.</p>
</td></tr>
<tr><td><code id="afp_+3A_p">p</code></td>
<td>
<p>Pressure, in kPa, used to convert data in micrograms per cubic meter 
to standard conditions (25 Degrees Celsius, 101.325 kPa). 
By default, p equals to 101.325 kPa.</p>
</td></tr>
<tr><td><code id="afp_+3A_stcd">stcd</code></td>
<td>
<p>logical. Does it output results in standard conditions? The default vaule is FALSE.</p>
</td></tr>
<tr><td><code id="afp_+3A_sortd">sortd</code></td>
<td>
<p>logical value. It determines whether the VOC species
are sorted or not. By default, sortd has value &quot;TRUE&quot;.
If TRUE, VOC species in time series will be arranged according to VOC group,
relative molecular weight, and SOAY value.</p>
</td></tr>
<tr><td><code id="afp_+3A_chn">chn</code></td>
<td>
<p>logical. Dose colnames present as Chinese? The default vaule is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CAS number is matched for each VOC speices (from column name), and the
average SOA yield (SOAY) is matched through the CAS number and used for time series calculation. <br />
The average SOAY comes from &quot;W. Wu, B. Zhao, S. Wang, J. Hao, Ozone 
and secondary organic aerosol formation potential from anthropogenic volatile 
organic compounds emissions in China. J Environ Sci. 53, 224â€“237 (2017)&quot;.
Note: If input VOC species contain M,P-xylene, it will be automatically divided into m-xylene and P-xylene evenly.
</p>


<h3>Value</h3>

<p>a list contains 5 tables:
SOAY_Result: matched SOAY value result;
AFP_Result: AFP time series of VOC by species;
AFP_Result_mean: the average value and proportion of AFP of VOC by species (sorted from large to small);
AFP_Result_group: AFP time series of VOC classified by groups;
AFP_Result_group_mean: the average value and proportion of AFP of VOC according to major groups (sorted from large to small).
</p>

<hr>
<h2 id='anylm'>Analysis of linear regression for time series in batch</h2><span id='topic+anylm'></span>

<h3>Description</h3>

<p>Analyse linear regression for time series in batch
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anylm(
  df,
  xd = 2,
  yd = 3,
  zd = NULL,
  td = NULL,
  mi = 1,
  range.y = "interval",
  range.x = "interval",
  nperm = 99,
  showpage = TRUE,
  scint = FALSE,
  dign = 1,
  zfill = "lightgray",
  ppsize = 2,
  showinfo = TRUE,
  ptsize = 12,
  pncol = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anylm_+3A_df">df</code></td>
<td>
<p>dataframe of time series.</p>
</td></tr>
<tr><td><code id="anylm_+3A_xd">xd</code></td>
<td>
<p>species or columns for x axis, vector of number or colnames. Default vaule is '2'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_yd">yd</code></td>
<td>
<p>species or columns for y axis, vector of number or colnames. Default vaule is '3'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_zd">zd</code></td>
<td>
<p>species or columns to fill points, vector of number or colnames. Default vaule is 'NULL'.
If zd is setted, labels for scaled color represent Percentile value (0, 0.25, 0.5,0.75, 1).</p>
</td></tr>
<tr><td><code id="anylm_+3A_td">td</code></td>
<td>
<p>1 column to group data, number or colname. Default vaule is 'NULL'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_mi">mi</code></td>
<td>
<p>index (1~4) of methods: 1. ordinary least squares (OLS); 2. major axis (MA); 3. standard major axis (SMA);
4. and ranged major axis (RMA). Refered from R package 'lmodel2'. Default vaule is '1'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_range.y">range.y</code></td>
<td>
<p>Parametres for ranged major axis regression (RMA). If range.y = NULL and range.x = NULL, RMA will not be computed.
If only one of them is NULL, the program will stop. If range.y = &quot;relative&quot;: variable y has a true zero (relative-scale variable).
If range.y = &quot;interval&quot;: variable y possibly includes negative values (interval-scale variable).
If range.x = &quot;relative&quot;: variable x has a true zero (relative-scale variable).
If range.x = &quot;interval&quot;: variable x possibly includes negative values (interval-scale variable). Refered from R package 'lmodel2'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_range.x">range.x</code></td>
<td>
<p>Parametres, please see 'range.y'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_nperm">nperm</code></td>
<td>
<p>Number of permutations for the tests. If nperm = 0, tests will not be computed. Refered from R package 'lmodel2'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_showpage">showpage</code></td>
<td>
<p>logical value for showing all plots. If TRUE, print all plot in 1 page. Default vaule is 'TRUE'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_scint">scint</code></td>
<td>
<p>logical value for displaying scientific notion in legend and plot title. Default vaule is 'FALSE'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_dign">dign</code></td>
<td>
<p>numeric value for digists in legend and plot title. Default vaule is '1'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_zfill">zfill</code></td>
<td>
<p>color for points, only valid when zd is NULL. Default vaule is &quot;lightgray&quot;.</p>
</td></tr>
<tr><td><code id="anylm_+3A_ppsize">ppsize</code></td>
<td>
<p>size for points. Default vaule is &quot;lightgray&quot;.</p>
</td></tr>
<tr><td><code id="anylm_+3A_showinfo">showinfo</code></td>
<td>
<p>logical value for displaying regression information in plot title. Default vaule is 'TRUE'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_ptsize">ptsize</code></td>
<td>
<p>font size for plot title. Default vaule is '12'.</p>
</td></tr>
<tr><td><code id="anylm_+3A_pncol">pncol</code></td>
<td>
<p>number of columns for plots in page. Refered from R package 'gridExtra'. Default vaule is 'NULL'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>X axis, Y axis, scaled color for points are flexible for multiple columns.
Data could also be grouped according to 1 column. <br />
</p>


<h3>Value</h3>

<p>a list contains: data_list, lm_df, lm_list, plot_list, all_plot.<br />
data_list: a list contains data for linear regression.<br />
lm_df: a dataframe for key results of linear regression. row index of lm_df corresponds to 'id' of plot in 'all_plot'.<br />
lm_list: a list contains detail results of linear regression.<br />
plot_list: a list contains plots for linear regression. <br />
all_plot: a page for all plots in 'plot_list'.<br />
To see page, please use this function: 'gridExtra::grid.arrange(grobs=...)'.<br />
To see page, please use this 2-lines function:<br />
'g=gridExtra::arrangeGrob(grobs=...)',<br />
'ggplot2::ggsave(filename = &quot;example.jpg&quot;, plot =g)'.<br />
'id' of plot corresponds to row index of 'lm_df'.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>anylm(aqi, xd=c(2,3), yd=6, zd=4, td=NULL, dign=3)
</code></pre>

<hr>
<h2 id='aqi'>Demo data of air quality</h2><span id='topic+aqi'></span>

<h3>Description</h3>

<p>5 days air quality data (1 min resolution) includes: NO, NO2, CO, SO2, O3.
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aqi
</code></pre>


<h3>Format</h3>

<p>A data frame with 7140 rows and 6 variables:
</p>

<dl>
<dt>Time</dt><dd><p>Time for data</p>
</dd>
<dt>NO</dt><dd><p>Nitric oxide (NO)</p>
</dd>
<dt>NO2</dt><dd><p>Nitrogen Dioxide (NO2)</p>
</dd>
<dt>CO</dt><dd><p>Carbon monoxide (CO)</p>
</dd>
<dt>SO2</dt><dd><p>Sulfur dioxide (SO2)</p>
</dd>
<dt>O3</dt><dd><p>Ozone (O3)</p>
</dd>
</dl>


<hr>
<h2 id='avri'>Calculate average of variation</h2><span id='topic+avri'></span>

<h3>Description</h3>

<p>Calculates average of variation of time series. (contain but not limited to:
average daily variation, average monthly variation, average annual variation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>avri(
  df,
  bkip = NULL,
  mode = "recipes",
  value = "day",
  st = NULL,
  et = NULL,
  na.rm = TRUE,
  digits = 2,
  wind = FALSE,
  coliws = 2,
  coliwd = 3,
  sn = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="avri_+3A_df">df</code></td>
<td>
<p>dataframe of time series.</p>
</td></tr>
<tr><td><code id="avri_+3A_bkip">bkip</code></td>
<td>
<p>the basic time reslution for average variation, such as '1 hour'. If mode &quot;custom&quot; is selected, do not need to enter bkip.</p>
</td></tr>
<tr><td><code id="avri_+3A_mode">mode</code></td>
<td>
<p>for calculating cycles: &quot;recipes&quot;, &quot;ncycle&quot;, &quot;custom&quot;.
&quot;recipes&quot; means using internal setting for calculation.
&quot;ncycle&quot; means setting number of items for per cycle.
&quot;custom&quot; means using 1 column in dataframe as a list of grouping elements for calculation.</p>
</td></tr>
<tr><td><code id="avri_+3A_value">value</code></td>
<td>
<p>for detail setting of mode. Possible values for &quot;recipes&quot; are &quot;day&quot;, &quot;week&quot;, &quot;month&quot;, year&quot;.
&quot;day&quot; equals to 24 (hours) values in 1 day.
&quot;week&quot; equals to 7 (days) values in 1 week.
&quot;month&quot; equals to 31 (days) values in 1 month.
&quot;year&quot; equals to 12 (months) values in 1 year.
values for &quot;ncycle&quot; is a number representing number of items in per cycle.
values for &quot;custom&quot; is a number representing column index in dataframe.</p>
</td></tr>
<tr><td><code id="avri_+3A_st">st</code></td>
<td>
<p>start time of resampling. The default value is the fisrt value of datetime column.</p>
</td></tr>
<tr><td><code id="avri_+3A_et">et</code></td>
<td>
<p>end time of resampling. The default value is the last value of datetime column.</p>
</td></tr>
<tr><td><code id="avri_+3A_na.rm">na.rm</code></td>
<td>
<p>logical value. Remove NA value or not?</p>
</td></tr>
<tr><td><code id="avri_+3A_digits">digits</code></td>
<td>
<p>numeric value, digits for result dataframe.</p>
</td></tr>
<tr><td><code id="avri_+3A_wind">wind</code></td>
<td>
<p>logical value. if TRUE, please set coliwd, coliws.</p>
</td></tr>
<tr><td><code id="avri_+3A_coliws">coliws</code></td>
<td>
<p>numeric value, column index of wind speed in dataframe.</p>
</td></tr>
<tr><td><code id="avri_+3A_coliwd">coliwd</code></td>
<td>
<p>numeric value, column index of wind direction (degree) in dataframe.</p>
</td></tr>
<tr><td><code id="avri_+3A_sn">sn</code></td>
<td>
<p>logical value. if TRUE, the results will be presented by scientific notation (string).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you have wind data (wind speed, and wind direction in dgree), please set 'wind' as 'TRUE', and set values for 'coliwd' and 'coliws'.
</p>


<h3>Value</h3>

<p>a data frame which contains both the average variations and the standard deviations.
Note that when the pattern USES
&quot;ncycle&quot; or &quot;custom&quot;, the start time determines the start time of the first
element in the average variation. For example, if the first timestamp of data is
&quot;2010-05-01 12:00:00&quot;, the resolution is 1 hour, the mode is &quot;ncycle&quot;, and the
value is 24, then the result represents diurnal variation starting from 12 o'clock.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>avri(met, bkip = "1 hour", mode = "recipes", value = "day",
st = "2017-05-01 00:00:00", wind = TRUE, coliws = 4, coliwd = 5)
</code></pre>

<hr>
<h2 id='dm8n'>Calculate daily maximum-8-hour ozone</h2><span id='topic+dm8n'></span>

<h3>Description</h3>

<p>Calculates daily maximum-8-hour ozone from ozone observation data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dm8n(
  df,
  colid = 1,
  colio = 2,
  starthour = 0,
  endhour = 16,
  nh = 6,
  nc = 14,
  na.rm = TRUE,
  outputmode = 1,
  unitlb = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dm8n_+3A_df">df</code></td>
<td>
<p>dataframe of time series for ozone and other related parameters.</p>
</td></tr>
<tr><td><code id="dm8n_+3A_colid">colid</code></td>
<td>
<p>column index for date-time. By default, it equals to 1.</p>
</td></tr>
<tr><td><code id="dm8n_+3A_colio">colio</code></td>
<td>
<p>column index for ozone. By default, it equals to 2.</p>
</td></tr>
<tr><td><code id="dm8n_+3A_starthour">starthour</code></td>
<td>
<p>numeric, start hour for calculating 8-hour ozone. By default, it equals to 0.</p>
</td></tr>
<tr><td><code id="dm8n_+3A_endhour">endhour</code></td>
<td>
<p>numeric, end hour for calculating 8-hour ozone. By default, it equals to 16 which means averaging ozone between 16~23.</p>
</td></tr>
<tr><td><code id="dm8n_+3A_nh">nh</code></td>
<td>
<p>numeric. The number of effective hourly concentrations per 8-hour period.</p>
</td></tr>
<tr><td><code id="dm8n_+3A_nc">nc</code></td>
<td>
<p>numeric. The number of effective 8-hour average concentrations per day.</p>
</td></tr>
<tr><td><code id="dm8n_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values (including NaN) be omitted from the calculations?</p>
</td></tr>
<tr><td><code id="dm8n_+3A_outputmode">outputmode</code></td>
<td>
<p>numeric, the format of the output, possible value: 1 or 2. See 'value' for the results of filling in 1 or 2.</p>
</td></tr>
<tr><td><code id="dm8n_+3A_unitlb">unitlb</code></td>
<td>
<p>labels for y axis of dma8 plot. By default, it equals to NA. If set this parameter, the order of species should same as that in the dataframe.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can calculate daily maximum-8-hour ozone and other parameters corresponding to it.
</p>


<h3>Value</h3>

<p>a dataframe depends on the value of 'outputMode'. Value 1 will output 1 list which incudes
1 table (maximum-8-hour ozone) and 1 plot (dma8 plot). Value 2 will output 1 list which contains 4
tables (8-hour ozone, statistics of the number of effective hourly concentrations in each 8-hour average concentration, 
statistics of the number of effective 8-hour average concentrations in each day, maximum-8-hour ozone) and 1 plot (dma8 plot).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
dm8n(aqi,colio=6,unitlb=c("NO (ppbv)", "NO2 (ppbv)", "CO (ppbv)", "SO2 (ppbv)", "O3 (ppbv)"))

## End(Not run)
</code></pre>

<hr>
<h2 id='dm8n_batch'>Calculate daily maximum-8-hour ozone in batch</h2><span id='topic+dm8n_batch'></span>

<h3>Description</h3>

<p>Calculates daily maximum-8-hour ozone in batch
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dm8n_batch(
  df,
  starthour = 0,
  endhour = 16,
  nh = 6,
  nc = 14,
  na.rm = TRUE,
  outputmode = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dm8n_batch_+3A_df">df</code></td>
<td>
<p>dataframe of time series for ozone and other related parameters.</p>
</td></tr>
<tr><td><code id="dm8n_batch_+3A_starthour">starthour</code></td>
<td>
<p>numeric, start hour for calculating 8-hour ozone. By default, it equals to 0.</p>
</td></tr>
<tr><td><code id="dm8n_batch_+3A_endhour">endhour</code></td>
<td>
<p>numeric, end hour for calculating 8-hour ozone. By default, it equals to 16 which means averaging ozone between 16~23.</p>
</td></tr>
<tr><td><code id="dm8n_batch_+3A_nh">nh</code></td>
<td>
<p>numeric. The number of effective hourly concentrations per 8-hour period.</p>
</td></tr>
<tr><td><code id="dm8n_batch_+3A_nc">nc</code></td>
<td>
<p>numeric. The number of effective 8-hour average concentrations per day.</p>
</td></tr>
<tr><td><code id="dm8n_batch_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values (including NaN) be omitted from the calculations?</p>
</td></tr>
<tr><td><code id="dm8n_batch_+3A_outputmode">outputmode</code></td>
<td>
<p>numeric, the format of the output, possible value: 1 or 2. See 'value' for the results of filling in 1 or 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can calculate daily maximum-8-hour ozone in batch.
</p>


<h3>Value</h3>

<p>a dataframe depends on the value of
'outputMode'. Value 1 will output 1 list which incudes
1 table (maximum-8-hour ozone). Value 2 will output 
1 list which contains 4 tables (8-hour ozone, 
statistics of the number of effective hourly 
concentrations in each 8-hour average concentration, 
statistics of the number of effective 8-hour average
concentrations in each day, maximum-8-hour ozone).
</p>

<hr>
<h2 id='dm8n_np'>Calculate daily maximum-8-hour ozone without printing plot</h2><span id='topic+dm8n_np'></span>

<h3>Description</h3>

<p>Calculates daily maximum-8-hour ozone from ozone observation data without printing plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dm8n_np(
  df,
  colid = 1,
  colio = 2,
  starthour = 0,
  endhour = 16,
  nh = 6,
  nc = 14,
  na.rm = TRUE,
  outputmode = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dm8n_np_+3A_df">df</code></td>
<td>
<p>dataframe of time series for ozone and other related parameters.</p>
</td></tr>
<tr><td><code id="dm8n_np_+3A_colid">colid</code></td>
<td>
<p>column index for date-time. By default, it equals to 1.</p>
</td></tr>
<tr><td><code id="dm8n_np_+3A_colio">colio</code></td>
<td>
<p>column index for ozone. By default, it equals to 2.</p>
</td></tr>
<tr><td><code id="dm8n_np_+3A_starthour">starthour</code></td>
<td>
<p>numeric, start hour for calculating 8-hour ozone. By default, it equals to 0.</p>
</td></tr>
<tr><td><code id="dm8n_np_+3A_endhour">endhour</code></td>
<td>
<p>numeric, end hour for calculating 8-hour ozone. By default, it equals to 16 which means averaging ozone between 16~23.</p>
</td></tr>
<tr><td><code id="dm8n_np_+3A_nh">nh</code></td>
<td>
<p>numeric. The number of effective hourly concentrations per 8-hour period.</p>
</td></tr>
<tr><td><code id="dm8n_np_+3A_nc">nc</code></td>
<td>
<p>numeric. The number of effective 8-hour average concentrations per day.</p>
</td></tr>
<tr><td><code id="dm8n_np_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values (including NaN) be omitted from the calculations?</p>
</td></tr>
<tr><td><code id="dm8n_np_+3A_outputmode">outputmode</code></td>
<td>
<p>numeric, the format of the output, possible value: 1 or 2. See 'value' for the results of filling in 1 or 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can calculate daily maximum-8-hour ozone and other parameters corresponding to it.
</p>


<h3>Value</h3>

<p>a dataframe depends on the value of
'outputMode'. Value 1 will output 1 list which incudes
1 table (maximum-8-hour ozone). Value 2 will output 
1 list which contains 4 tables (8-hour ozone, 
statistics of the number of effective hourly 
concentrations in each 8-hour average concentration, 
statistics of the number of effective 8-hour average
concentrations in each day, maximum-8-hour ozone).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dm8n_np(aqi,colio=6)
</code></pre>

<hr>
<h2 id='fm'>format the theme of plot</h2><span id='topic+fm'></span>

<h3>Description</h3>

<p>Format the theme of plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fm(p, fsz = 13, lsz = 0.5, tkl = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fm_+3A_p">p</code></td>
<td>
<p>a ggplot-format plot.</p>
</td></tr>
<tr><td><code id="fm_+3A_fsz">fsz</code></td>
<td>
<p>font size in plot.</p>
</td></tr>
<tr><td><code id="fm_+3A_lsz">lsz</code></td>
<td>
<p>line size of panel border and axis in plot.</p>
</td></tr>
<tr><td><code id="fm_+3A_tkl">tkl</code></td>
<td>
<p>tick length in plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot with a new theme.
</p>

<hr>
<h2 id='geom_avri'>Plot the average variation</h2><span id='topic+geom_avri'></span>

<h3>Description</h3>

<p>Easy way to plot the average variation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_avri(
  df,
  cave = 2,
  csd = 3,
  ssd = 1,
  alpha = 0.5,
  xlab = NULL,
  ylab = NULL,
  lcc = NULL,
  lsize = 1,
  rff = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_avri_+3A_df">df</code></td>
<td>
<p>dataframe contains average variation value and their standard deviation.</p>
</td></tr>
<tr><td><code id="geom_avri_+3A_cave">cave</code></td>
<td>
<p>column index of average variation. The default vaule is 2.</p>
</td></tr>
<tr><td><code id="geom_avri_+3A_csd">csd</code></td>
<td>
<p>column index of standard deviation. The default vaule is 3.</p>
</td></tr>
<tr><td><code id="geom_avri_+3A_ssd">ssd</code></td>
<td>
<p>scale value for standard deviation. The default vaule is 1.</p>
</td></tr>
<tr><td><code id="geom_avri_+3A_alpha">alpha</code></td>
<td>
<p>the alpha value of ribbon. The default vaule is 0.5.</p>
</td></tr>
<tr><td><code id="geom_avri_+3A_xlab">xlab</code></td>
<td>
<p>text expression of x axis label. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_avri_+3A_ylab">ylab</code></td>
<td>
<p>text expression of y axis label. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_avri_+3A_lcc">lcc</code></td>
<td>
<p>color of line. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_avri_+3A_lsize">lsize</code></td>
<td>
<p>size of line. The default vaule is NULL.The default vaule is 1.</p>
</td></tr>
<tr><td><code id="geom_avri_+3A_rff">rff</code></td>
<td>
<p>fill color of ribbon. The default vaule is NULL.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
x=avri(aqi, bkip = "1 hour", mode = "recipes", value
 = "day", st = "2017-05-01 00:00:00")
geom_avri(x,cave=6, csd=11, alpha=0.5, lcc="#0050b3",
 rff="#40a9ff", xlab="Time",ylab=bquote(O[3]~" "~(ppbv)))

## End(Not run)
</code></pre>

<hr>
<h2 id='geom_avri_batch'>Plot the average variation in batch</h2><span id='topic+geom_avri_batch'></span>

<h3>Description</h3>

<p>Easy way to plot the average variation in batch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_avri_batch(
  df,
  ssd = 1,
  alpha = 0.5,
  xlab = NULL,
  ylab = NULL,
  lcc = NULL,
  lsize = 1,
  rff = NULL,
  ncol = 2,
  bquote = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_avri_batch_+3A_df">df</code></td>
<td>
<p>dataframe contains average variation value and their standard deviation.</p>
</td></tr>
<tr><td><code id="geom_avri_batch_+3A_ssd">ssd</code></td>
<td>
<p>scale value for standard deviation. The default vaule is 1.</p>
</td></tr>
<tr><td><code id="geom_avri_batch_+3A_alpha">alpha</code></td>
<td>
<p>the alpha value of ribbon. The default vaule is 0.5.</p>
</td></tr>
<tr><td><code id="geom_avri_batch_+3A_xlab">xlab</code></td>
<td>
<p>text expression of x axis label. The default vaule is NULL. Need to set with ylab at the same time.</p>
</td></tr>
<tr><td><code id="geom_avri_batch_+3A_ylab">ylab</code></td>
<td>
<p>text expression of y axis label. The default vaule is NULL. Need to set with xlab at the same time.</p>
</td></tr>
<tr><td><code id="geom_avri_batch_+3A_lcc">lcc</code></td>
<td>
<p>colors of lines. The default vaule is NULL. Need to set with rff at the same time.</p>
</td></tr>
<tr><td><code id="geom_avri_batch_+3A_lsize">lsize</code></td>
<td>
<p>size of lines. The default vaule is NULL.The default vaule is 1.</p>
</td></tr>
<tr><td><code id="geom_avri_batch_+3A_rff">rff</code></td>
<td>
<p>fill colors of ribbons. The default vaule is NULL. Need to set with lcc at the same time.</p>
</td></tr>
<tr><td><code id="geom_avri_batch_+3A_ncol">ncol</code></td>
<td>
<p>number of figure columns in final plot layout. The default vaule is 2.</p>
</td></tr>
<tr><td><code id="geom_avri_batch_+3A_bquote">bquote</code></td>
<td>
<p>logical value. Set to TRUE if you want to use bquote in labs (xlab and y lab). The default vaule is FALSE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
#example 1
x=avri(aqi, bkip = "1 hour", mode = "recipes", value
 = "day", st = "2017-05-01 00:00:00")
geom_avri_batch(x)
#example 2
x=avri(aqi, bkip = "1 hour", mode = "recipes", value
 = "day", st = "2017-05-01 00:00:00")
lcc=c("#f5222d","#fa8c16","#52c41a","#1890ff","#722ed1")
rff=c("#ff7875","#ffc069","#95de64","#69c0ff","#b37feb")
xlab1=list(bquote(Time~""),bquote(Time~""),bquote(Time~""),
bquote(Time~""),bquote(Time~""))
ylab1=list(bquote(NO~" "~(ppbv)), bquote(NO[2]~" "~(ppbv)), 
bquote(CO~" "~(ppmv)), bquote(SO[2]~" "~(ppbv)), bquote(O[3]~" "~(ppbv)))
geom_avri_batch(x, alpha=0.6, xlab=xlab1, ylab=ylab1,
 lcc=lcc, rff=rff, bquote=TRUE)
#example 3
x=avri(aqi, bkip = "1 hour", mode = "recipes", value
 = "day", st = "2017-05-01 00:00:00")
xlab2=rep("Time",5)
ylab2=c("NO","NO2","CO","SO2","O3")
geom_avri_batch(x, alpha=0.6, xlab=xlab2, ylab=ylab2,
 lcc=lcc, rff=rff, bquote=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='geom_psd'>Plot the time series of particle size distribution.</h2><span id='topic+geom_psd'></span>

<h3>Description</h3>

<p>Plot the time series of particle size distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_psd(
  df,
  labxyl = NULL,
  logy = TRUE,
  ybk = NULL,
  nlmt = NULL,
  csbk = pretty_breaks(4),
  trans = "identity",
  colsz = 1,
  fsz = 13,
  lsz = 0.4,
  tkl = 0.2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_psd_+3A_df">df</code></td>
<td>
<p>dataframe of particle size data: the first column of input is datetime; the other columns are number concentration (N, unit: #/cm3) or log number concentration (dN/dlogdp, unit: #/cm3) for each particle size channel. Column names of the other columns are the middle particle size for each particle size channel.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_labxyl">labxyl</code></td>
<td>
<p>vector, Set the title of x axis, y axis, legend. The default vaule is NULL. Bquote grammer is accepted.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_logy">logy</code></td>
<td>
<p>logical. Plot the data with log y axis. The default vaule is TRUE.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_ybk">ybk</code></td>
<td>
<p>numeric vector, breaks of y axis.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_nlmt">nlmt</code></td>
<td>
<p>numeric value, range of particle number for colorscales of plot.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_csbk">csbk</code></td>
<td>
<p>numeric vector, breaks of color bar.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_trans">trans</code></td>
<td>
<p>character string, &quot;identity&quot; or &quot;log10&quot;. transformation of color bar breaks.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_colsz">colsz</code></td>
<td>
<p>numeric value, size of columns in plot.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_fsz">fsz</code></td>
<td>
<p>font size in plot.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_lsz">lsz</code></td>
<td>
<p>line size of panel border and axis in plot.</p>
</td></tr>
<tr><td><code id="geom_psd_+3A_tkl">tkl</code></td>
<td>
<p>tick length in plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot for the time series of particle size distribution. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
dn_table = read.delim(system.file("extdata", "smps.txt", package = "foqat"),
check.names = FALSE)
dn1_table=dn_table[,c(1,5:148)]
dn1_table[,1]=as.POSIXct(dn1_table[,1], format="%m/%d/%Y %H:%M:%S", tz="GMT")
geom_psd(dn1_table,fsz=10)

## End(Not run)
</code></pre>

<hr>
<h2 id='geom_ts'>Plot time series</h2><span id='topic+geom_ts'></span>

<h3>Description</h3>

<p>Easy way to plot time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_ts(
  df,
  yl = NULL,
  yr = NULL,
  yllab = NULL,
  yrlab = NULL,
  xlab = NULL,
  llist = NULL,
  plist = NULL,
  alist = NULL,
  blist = NULL,
  llab = NULL,
  plab = NULL,
  alab = NULL,
  blab = NULL,
  ltype = NULL,
  pshape = NULL,
  lsize = 1,
  psize = 1,
  lcc = NULL,
  pcc = NULL,
  aff = NULL,
  bff = NULL,
  ana = TRUE,
  apos = "stack",
  bna = TRUE,
  bpos = "identity",
  yl_limit = NULL,
  yr_limit = NULL,
  yl_breaks = waiver(),
  yr_breaks = waiver(),
  yl_minor_breaks = waiver()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_ts_+3A_df">df</code></td>
<td>
<p>dataframe contains time series.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_yl">yl</code></td>
<td>
<p>vector, col index of species to be putted in the left y axis.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_yr">yr</code></td>
<td>
<p>vector, col index of species to be putted in the right y axis. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_yllab">yllab</code></td>
<td>
<p>text expression of left y axis label. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_yrlab">yrlab</code></td>
<td>
<p>text expression of right y axis label. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_xlab">xlab</code></td>
<td>
<p>text expression of x axis label. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_llist">llist</code></td>
<td>
<p>vector, col index of species to be ploted by line.The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_plist">plist</code></td>
<td>
<p>vector, col index of species to be ploted by points.The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_alist">alist</code></td>
<td>
<p>plist vector, col index of species to be ploted by areas. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_blist">blist</code></td>
<td>
<p>plist vector, col index of species to be ploted by bars. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_llab">llab</code></td>
<td>
<p>list of text expressions of legend labels of lines. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_plab">plab</code></td>
<td>
<p>list of text expressions of legend labels of points. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_alab">alab</code></td>
<td>
<p>list of text expressions of legend labels of areas. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_blab">blab</code></td>
<td>
<p>list of text expressions of legend labels of bars. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_ltype">ltype</code></td>
<td>
<p>vector, type of lines. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_pshape">pshape</code></td>
<td>
<p>vector, shape of points. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_lsize">lsize</code></td>
<td>
<p>vector, size of lines. The default vaule is NULL.The default vaule is 1.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_psize">psize</code></td>
<td>
<p>vector, size of points. The default vaule is NULL.The default vaule is 1.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_lcc">lcc</code></td>
<td>
<p>vector, colors of lines. The default vaule is NULL. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_pcc">pcc</code></td>
<td>
<p>vector, colors of points. The default vaule is NULL. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_aff">aff</code></td>
<td>
<p>fill color of areas. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_bff">bff</code></td>
<td>
<p>fill color of bars. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_ana">ana</code></td>
<td>
<p>logical value, the way to handle NA values for areas. If you select FALSE, NA value will be replaced by 0.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_apos">apos</code></td>
<td>
<p>Position adjustment for areas, either as a string, or the result of a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_bna">bna</code></td>
<td>
<p>logical value, the way to handle NA values for bars. If you select FALSE, NA value will be replaced by 0.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_bpos">bpos</code></td>
<td>
<p>Position adjustment for bars, either as a string, or the result of a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_yl_limit">yl_limit</code></td>
<td>
<p>two numeric values, specifying the lower limit and the upper limit of the scale in left y axis.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_yr_limit">yr_limit</code></td>
<td>
<p>two numeric values, specifying the lower limit and the upper limit of the scale in right y axis.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_yl_breaks">yl_breaks</code></td>
<td>
<p>a numeric vector of positions for breaks in left y axis.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_yr_breaks">yr_breaks</code></td>
<td>
<p>a numeric vector of positions for breaks in right y axis.</p>
</td></tr>
<tr><td><code id="geom_ts_+3A_yl_minor_breaks">yl_minor_breaks</code></td>
<td>
<p>a numeric vector of positions for minor breaks in left y axis.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
aqi2=aqi
aqi2$NO[aqi2$NO&gt;7]=NA
aqi2$NO2=aqi2$NO2*0.3
geom_ts(
    	df=aqi2,
    	yl=c(3,2), 
    	yr=6, 
    	alist=c(3,2), 
    	llist=6, 
   	alab=list(bquote(NO[2]~" "), bquote(NO~" ")),
		llab=list(bquote(O[3]~" ")),
     yllab=bquote(NO[x]~" "~(ppbv)),
     yrlab=bquote(O[3]~" "~(ppbv)),
     lcc="#ff4d4f", 
     aff=c("#096dd9","#69c0ff"),
xlab="Datetime")

## End(Not run)
</code></pre>

<hr>
<h2 id='geom_ts_batch'>Plot time series in batch</h2><span id='topic+geom_ts_batch'></span>

<h3>Description</h3>

<p>Easy way to plot time series in batch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_ts_batch(
  df,
  xlab = NULL,
  ylab = NULL,
  cclist = NULL,
  bquote = FALSE,
  breaks = waiver(),
  date_breaks = waiver(),
  labels = waiver(),
  date_labels = waiver(),
  minor_breaks = waiver(),
  date_minor_breaks = waiver(),
  expand = c(0, 0),
  panelgap = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_ts_batch_+3A_df">df</code></td>
<td>
<p>dataframe of time series.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_xlab">xlab</code></td>
<td>
<p>text expression of x axis label. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_ylab">ylab</code></td>
<td>
<p>text expression of y axis label. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_cclist">cclist</code></td>
<td>
<p>vector, colors of lines. The default vaule is NULL.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_bquote">bquote</code></td>
<td>
<p>logical value. Set to TRUE if you want to use bquote in labs (xlab and y lab). The default vaule is FALSE.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_breaks">breaks</code></td>
<td>
<p>One of:
- 'NULL' for no breaks
- 'waiver()' for the breaks specified by 'date_breaks'
- A 'Date'/'POSIXct' vector giving positions of breaks
- A function that takes the limits as input and returns breaks as output</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_date_breaks">date_breaks</code></td>
<td>
<p>A string giving the distance between breaks like &quot;2
weeks&quot;, or &quot;10 years&quot;. If both 'breaks' and 'date_breaks' are
specified, 'date_breaks' wins.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_labels">labels</code></td>
<td>
<p>One of:
- 'NULL' no labels
- 'waiver()' for the default labels computed by the transformation object
- A character vector giving labels (must be same length as 'breaks')
- A function that takes the breaks as input and returns labels as output. 
Also accepts rlang lambda function notation.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_date_labels">date_labels</code></td>
<td>
<p>A string giving the formatting specification for the
labels. Codes are defined in [strftime()]. If both 'labels'
and 'date_labels' are specified, 'date_labels' wins.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_minor_breaks">minor_breaks</code></td>
<td>
<p>One of:
- 'NULL' for no breaks
- 'waiver()' for the breaks specified by 'date_minor_breaks'
- A 'Date'/'POSIXct' vector giving positions of minor breaks
- A function that takes the limits as input and returns minor breaks as
output</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_date_minor_breaks">date_minor_breaks</code></td>
<td>
<p>A string giving the distance between minor breaks
like &quot;2 weeks&quot;, or &quot;10 years&quot;. If both 'minor_breaks' and
'date_minor_breaks' are specified, 'date_minor_breaks' wins.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_expand">expand</code></td>
<td>
<p>For position scales, a vector of range expansion constants used
to add some padding around the data to ensure that they are placed some 
distance away from the axes. Use the convenience function expansion() to 
generate the values for the expand argument. The defaults are to expand the 
scale by 5
side for discrete variables.</p>
</td></tr>
<tr><td><code id="geom_ts_batch_+3A_panelgap">panelgap</code></td>
<td>
<p>gap of panels. The default vaule is 0.5.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
#example 1
geom_ts_batch(aqi)
#example 2
xlab1="Time"
ylab1=c("NO","NO2","CO","SO2","O3")
geom_ts_batch(aqi, xlab=xlab1, ylab=ylab1)
#example 3
xlab2=bquote(Time~"")
ylab2=list(bquote(NO~" "~(ppbv)), bquote(NO[2]~"
 "~(ppbv)), bquote(CO~" "~(ppmv)), bquote(SO[2]~"
 "~(ppbv)), bquote(O[3]~" "~(ppbv)))
cclist=c("#eb2f96", "#1890ff", "#52c41a", "#faad14", "#f5222d")
geom_ts_batch(aqi, xlab=xlab2, ylab=ylab2, cclist=cclist, bquote=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='geom_tsw'>Plot time series</h2><span id='topic+geom_tsw'></span>

<h3>Description</h3>

<p>Easy way to plot time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_tsw(
  df,
  coliws = 2,
  coliwd = 3,
  lsize = 0.8,
  psize = NA,
  msize = 8,
  mlabel = "West wind",
  mx = 0.05,
  my = -0.1,
  mwd = 270
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_tsw_+3A_df">df</code></td>
<td>
<p>dataframe contains time series.</p>
</td></tr>
<tr><td><code id="geom_tsw_+3A_coliws">coliws</code></td>
<td>
<p>column index of wind speed. The default vaule is 2.</p>
</td></tr>
<tr><td><code id="geom_tsw_+3A_coliwd">coliwd</code></td>
<td>
<p>column index of wind direction. The default vaule is 3.</p>
</td></tr>
<tr><td><code id="geom_tsw_+3A_lsize">lsize</code></td>
<td>
<p>size of line (wind speed). The default vaule is 0.8.</p>
</td></tr>
<tr><td><code id="geom_tsw_+3A_psize">psize</code></td>
<td>
<p>size of point (wind speed). The default vaule is NA.</p>
</td></tr>
<tr><td><code id="geom_tsw_+3A_msize">msize</code></td>
<td>
<p>size of mark (wind direction). The default vaule is 8.</p>
</td></tr>
<tr><td><code id="geom_tsw_+3A_mlabel">mlabel</code></td>
<td>
<p>label of mark (wind direction). The default vaule is &quot;West wind&quot;.</p>
</td></tr>
<tr><td><code id="geom_tsw_+3A_mx">mx</code></td>
<td>
<p>adjust value for the x position of mark (wind direction). The default vaule is 0.05.</p>
</td></tr>
<tr><td><code id="geom_tsw_+3A_my">my</code></td>
<td>
<p>adjust value for the y position of mark (wind direction). The default vaule is -0.1.</p>
</td></tr>
<tr><td><code id="geom_tsw_+3A_mwd">mwd</code></td>
<td>
<p>direction of mark (wind direction). The default vaule is 270.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
metds=trs(met, bkip="15 mins")
geom_tsw(metds, coliws=4, coliwd=5)

## End(Not run)
</code></pre>

<hr>
<h2 id='koh'>get kOH</h2><span id='topic+koh'></span>

<h3>Description</h3>

<p>Searches kOH value from 'chemspider.com'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>koh(spec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="koh_+3A_spec">spec</code></td>
<td>
<p>chemical specise to be searched. chemical specise's name or CAS Number is acceptable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Theoretical values of the species' OH reaction constant kOH at 25 degrees were obtained from 'Chemspider.com'. Value source: US Environmental Protection Agency's EPISuite.<br />
Unit is cm3/molecule-sec.<br />
Condition is 25 deg C.
</p>


<h3>Value</h3>

<p>the theoretical value of the species' OH reaction constant kOH at 25 degrees.
</p>

<hr>
<h2 id='loh'>Calculate OH reactivity</h2><span id='topic+loh'></span>

<h3>Description</h3>

<p>Calculate OH reactivity of VOC time series in 25 degree celsius. 
Note: for Chinese VOC name, please also use English punctuation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loh(
  df,
  unit = "ppbv",
  t = 25,
  p = 101.325,
  stcd = FALSE,
  sortd = TRUE,
  atk = TRUE,
  chn = FALSE,
  bvoc = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loh_+3A_df">df</code></td>
<td>
<p>dataframe contains time series.</p>
</td></tr>
<tr><td><code id="loh_+3A_unit">unit</code></td>
<td>
<p>unit for VOC concentration. A character vector from these options: &quot;ugm&quot; or &quot;ppbv&quot;. &quot;ugm&quot; means ug/m3. &quot;ppbv&quot; means part per billion volumn.</p>
</td></tr>
<tr><td><code id="loh_+3A_t">t</code></td>
<td>
<p>Temperature, in Degrees Celsius, used to convert data in 
micrograms per cubic meter to standard conditions 
(25 Degrees Celsius, 101.325 kPa). By default, t equals to 25 Degrees Celsius.</p>
</td></tr>
<tr><td><code id="loh_+3A_p">p</code></td>
<td>
<p>Pressure, in kPa, used to convert data in micrograms per cubic meter 
to standard conditions (25 Degrees Celsius, 101.325 kPa). 
By default, p equals to 101.325 kPa.</p>
</td></tr>
<tr><td><code id="loh_+3A_stcd">stcd</code></td>
<td>
<p>logical. Does it output the concentration in standard condition? 
The default vaule is FALSE.</p>
</td></tr>
<tr><td><code id="loh_+3A_sortd">sortd</code></td>
<td>
<p>logical value. It determines whether the VOC species
are sorted or not. By default, sortd has value &quot;TRUE&quot;.
If TRUE, VOC species in time series will be arranged according to VOC group,
relative molecular weight, and OH Rate Constant.</p>
</td></tr>
<tr><td><code id="loh_+3A_atk">atk</code></td>
<td>
<p>logical. use kOH value from atk or not? If not, kOH comes from 'AopWin v1.92' will be used. The default vaule is TRUE.</p>
</td></tr>
<tr><td><code id="loh_+3A_chn">chn</code></td>
<td>
<p>logical. Dose colnames present as Chinese? The default vaule is FALSE.</p>
</td></tr>
<tr><td><code id="loh_+3A_bvoc">bvoc</code></td>
<td>
<p>logical. Whether you want to list BVOC as a separate VOC group? The default vaule is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CAS number is matched for each VOC speices (from column name), and the
OH Rate Constant is matched through the CAS number and used for time series calculation. <br />
The OH Rate Constant comes from 'AopWin v1.92' in 25 degree celsius.
</p>


<h3>Value</h3>

<p>a list contains 5 tables:
KOH_Result: the matched KOH value results;
LOH_Result: the LOH time series of VOC by species;
LOH_Result_stat: the statistics of LOH of VOC by species;
LOH_Result_group: the LOH time series of VOC classified by groups;
LOH_Result_group_mean: the statistics of LOH of VOC according to major groups.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>voc_loh=loh(voc)
summary(voc_loh)
</code></pre>

<hr>
<h2 id='met'>Demo data of meteorology</h2><span id='topic+met'></span>

<h3>Description</h3>

<p>5 days meteorology data (5 mins resolution) includes: Temperature, Humidity,
Wind speed, Wind direction.
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>met
</code></pre>


<h3>Format</h3>

<p>A data frame with 1287 rows and 5 variables:
</p>

<dl>
<dt>Time</dt><dd><p>Time for data</p>
</dd>
<dt>TEM</dt><dd><p>Temperature</p>
</dd>
<dt>HUM</dt><dd><p>Humidity</p>
</dd>
<dt>WS</dt><dd><p>Wind speed</p>
</dd>
<dt>WD</dt><dd><p>Wind direction</p>
</dd>
</dl>


<hr>
<h2 id='nsvp'>Calculate Surface Area, Volume, Mass of particle by particle number concentration</h2><span id='topic+nsvp'></span>

<h3>Description</h3>

<p>Calculate Surface Area, Volume, Mass of particle by particle number concentration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsvp(df, dlogdp = FALSE, dsty = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nsvp_+3A_df">df</code></td>
<td>
<p>dataframe of particle size data: the first column of input is datetime; the other columns are number concentration (N, unit: #/cm3) or log number concentration (dN/dlogdp, unit: #/cm3) for each particle size channel. Column names of the other columns are the middle particle size for each particle size channel.</p>
</td></tr>
<tr><td><code id="nsvp_+3A_dlogdp">dlogdp</code></td>
<td>
<p>logical value, TRUE if the third column is log number concentration (dN/dlogdp).</p>
</td></tr>
<tr><td><code id="nsvp_+3A_dsty">dsty</code></td>
<td>
<p>numeric value, density of particle namtter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with 2 dataframe. The first dataframe is a time series for Surface Area (unit: Âµm2/cm3), Volume (unit: Âµm3/cm3), Mass  (unit: Âµg/m3) of each channels; the second dataframe is a time series for total Surface Area, Volume, Mass of all channels.
</p>

<hr>
<h2 id='ofp'>Calculate ozone formation potential</h2><span id='topic+ofp'></span>

<h3>Description</h3>

<p>Calculate Ozone Formation Potential (OFP) of VOC time series.
Note: for Chinese VOC name, please also use English punctuation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ofp(
  df,
  inunit = "ppbv",
  outunit = "ppbv",
  t = 25,
  p = 101.325,
  stcd = FALSE,
  sortd = TRUE,
  chn = FALSE,
  mtype = "usa",
  bvoc = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ofp_+3A_df">df</code></td>
<td>
<p>dataframe contains time series.</p>
</td></tr>
<tr><td><code id="ofp_+3A_inunit">inunit</code></td>
<td>
<p>input's unit for VOC concentration. A character vector from these options: &quot;ugm&quot; or &quot;ppbv&quot;. 
&quot;ugm&quot; means ug/m3. &quot;ppbv&quot; means part per billion volumn. The default vaule is &quot;ppbv&quot;.</p>
</td></tr>
<tr><td><code id="ofp_+3A_outunit">outunit</code></td>
<td>
<p>output's unit for VOC concentration. A character from these options: &quot;ugm&quot; or &quot;ppbv&quot;. 
&quot;ugm&quot; means ug/m3. &quot;ppbv&quot; means part per billion volumn. The default vaule is &quot;ppbv&quot;.</p>
</td></tr>
<tr><td><code id="ofp_+3A_t">t</code></td>
<td>
<p>Temperature, in Degrees Celsius, used to convert data in 
micrograms per cubic meter to standard conditions 
(25 Degrees Celsius, 101.325 kPa). By default, t equals to 25 Degrees Celsius.</p>
</td></tr>
<tr><td><code id="ofp_+3A_p">p</code></td>
<td>
<p>Pressure, in kPa, used to convert data in micrograms per cubic meter 
to standard conditions (25 Degrees Celsius, 101.325 kPa). 
By default, p equals to 101.325 kPa.</p>
</td></tr>
<tr><td><code id="ofp_+3A_stcd">stcd</code></td>
<td>
<p>logical. Does it output results in standard conditions? The default vaule is FALSE.</p>
</td></tr>
<tr><td><code id="ofp_+3A_sortd">sortd</code></td>
<td>
<p>logical value. It determines whether the VOC species
are sorted or not. By default, sortd has value &quot;TRUE&quot;.
If TRUE, VOC species in time series will be arranged according to VOC group,
relative molecular weight, and MIR value.</p>
</td></tr>
<tr><td><code id="ofp_+3A_chn">chn</code></td>
<td>
<p>logical. Dose colnames present as Chinese? The default vaule is FALSE.</p>
</td></tr>
<tr><td><code id="ofp_+3A_mtype">mtype</code></td>
<td>
<p>text. &quot;usa&quot; for MIR value from USA, &quot;chn&quot; for MIR value from CHINA.</p>
</td></tr>
<tr><td><code id="ofp_+3A_bvoc">bvoc</code></td>
<td>
<p>logical. Whether you want to list BVOC as a separate VOC group? The default vaule is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CAS number is matched for each VOC speices (from column name), and the
Maximum Incremental Reactivity (MIR) value is matched through the CAS number and used for time series calculation. <br />
The MIR value comes from &lt;https://ww2.arb.ca.gov/sites/default/files/classic/regact/2009/mir2009/mir10.pdf&gt;, 
Zhang et al.(2021) &lt;doi:10.5194/acp-21-11053-2021&gt;.
</p>


<h3>Value</h3>

<p>a list contains 5 tables:
MIR_Result: the matched MIR value results;
OFP_Result: the OFP time series of VOC by species;
OFP_Result_stat: the statistics of OFP of VOC by species;
OFP_Result_group: OFP the time series of VOC classified by groups;
OFP_Result_group_stat: the statistics of OFP of VOC according to major groups.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>voc_ofp=ofp(voc)
summary(voc_ofp)
</code></pre>

<hr>
<h2 id='prop'>Convert time series into proportion time series</h2><span id='topic+prop'></span>

<h3>Description</h3>

<p>Convert time series into proportion time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prop(df, cmcase = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prop_+3A_df">df</code></td>
<td>
<p>dataframe of time series.</p>
</td></tr>
<tr><td><code id="prop_+3A_cmcase">cmcase</code></td>
<td>
<p>logical value. Set to TRUE if you only 
want to retain cases which are complete, i.e., have 
no missing values. The default vaule is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with proportion time series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prop(voc)
</code></pre>

<hr>
<h2 id='setup_tuv'>Demo data of setup for tuv</h2><span id='topic+setup_tuv'></span>

<h3>Description</h3>

<p>5 days setup data for tuv includes: nt,	lat,	lon,	o3col.
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_tuv
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 rows and 5 variables:
</p>

<dl>
<dt>date</dt><dd><p>date for each day</p>
</dd>
<dt>nt</dt><dd><p>data point for each day</p>
</dd>
<dt>lat</dt><dd><p>lat for each day</p>
</dd>
<dt>lon</dt><dd><p>lon for each day</p>
</dd>
<dt>o3col</dt><dd><p>o3 column concentration for each day</p>
</dd>
</dl>


<hr>
<h2 id='statdf'>Summary of dataframe</h2><span id='topic+statdf'></span>

<h3>Description</h3>

<p>Summary of dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statdf(df, n = 2, cmcase = FALSE, prop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="statdf_+3A_df">df</code></td>
<td>
<p>dataframe of time series.</p>
</td></tr>
<tr><td><code id="statdf_+3A_n">n</code></td>
<td>
<p>digits for reuslt in dataframe.</p>
</td></tr>
<tr><td><code id="statdf_+3A_cmcase">cmcase</code></td>
<td>
<p>logical value. Set to TRUE if you only 
want to summary cases which are complete, i.e., have 
no missing values.</p>
</td></tr>
<tr><td><code id="statdf_+3A_prop">prop</code></td>
<td>
<p>logical value. Convert time series into 
proportion time series before summary.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Summary of dataframe: mean, standard deviation (sd), minimum (min), percentiles
(0.25, 0.50, 0.75), maximum (max).
</p>


<h3>Value</h3>

<p>a dataframe, columns stands for parameters, 
rows stands for variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>statdf(voc)
</code></pre>

<hr>
<h2 id='svri'>Compute the variation of summary statistics</h2><span id='topic+svri'></span>

<h3>Description</h3>

<p>Compute the variation of summary statistics for time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svri(
  df,
  bkip = NULL,
  mode = "recipes",
  value = "day",
  st = NULL,
  et = NULL,
  fun = "mean",
  probs = 0.5,
  na.rm = TRUE,
  digits = 2,
  wind = FALSE,
  coliws = 2,
  coliwd = 3,
  sn = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svri_+3A_df">df</code></td>
<td>
<p>dataframe of time series.</p>
</td></tr>
<tr><td><code id="svri_+3A_bkip">bkip</code></td>
<td>
<p>the basic time reslution for variation, such as '1 hour'. If mode &quot;custom&quot; is selected, do not need to enter bkip.</p>
</td></tr>
<tr><td><code id="svri_+3A_mode">mode</code></td>
<td>
<p>for calculating cycles: &quot;recipes&quot;, &quot;ncycle&quot;, &quot;custom&quot;.
&quot;recipes&quot; means using internal setting for calculation.
&quot;ncycle&quot; means setting number of items for per cycle.
&quot;custom&quot; means using 1 column in dataframe as a list of grouping elements for calculation.</p>
</td></tr>
<tr><td><code id="svri_+3A_value">value</code></td>
<td>
<p>for detail setting of mode. Possible values for &quot;recipes&quot; are &quot;day&quot;, &quot;week&quot;, &quot;month&quot;, year&quot;.
&quot;day&quot; equals to 24 (hours) values in 1 day.
&quot;week&quot; equals to 7 (days) values in 1 week.
&quot;month&quot; equals to 31 (days) values in 1 month.
&quot;year&quot; equals to 12 (months) values in 1 year.
values for &quot;ncycle&quot; is a number representing number of items in per cycle.
values for &quot;custom&quot; is a number representing column index in dataframe.</p>
</td></tr>
<tr><td><code id="svri_+3A_st">st</code></td>
<td>
<p>start time of resampling. The default value is the fisrt value of datetime column.</p>
</td></tr>
<tr><td><code id="svri_+3A_et">et</code></td>
<td>
<p>end time of resampling. The default value is the last value of datetime column.</p>
</td></tr>
<tr><td><code id="svri_+3A_fun">fun</code></td>
<td>
<p>a function to compute the summary statistics which can be applied to all data subsets: 'sum', 'mean', 'median', 'min', 'max', 'sd' and 'quantile'.</p>
</td></tr>
<tr><td><code id="svri_+3A_probs">probs</code></td>
<td>
<p>numeric vector of probabilities with values in \([0,1]\).</p>
</td></tr>
<tr><td><code id="svri_+3A_na.rm">na.rm</code></td>
<td>
<p>logical value. Remove NA value or not?</p>
</td></tr>
<tr><td><code id="svri_+3A_digits">digits</code></td>
<td>
<p>numeric value, digits for result dataframe.</p>
</td></tr>
<tr><td><code id="svri_+3A_wind">wind</code></td>
<td>
<p>logical value. if TRUE, please set coliwd, coliws.</p>
</td></tr>
<tr><td><code id="svri_+3A_coliws">coliws</code></td>
<td>
<p>numeric value, column index of wind speed in dataframe.</p>
</td></tr>
<tr><td><code id="svri_+3A_coliwd">coliwd</code></td>
<td>
<p>numeric value, column index of wind direction (degree) in dataframe.</p>
</td></tr>
<tr><td><code id="svri_+3A_sn">sn</code></td>
<td>
<p>logical value. if TRUE, the results will be presented by scientific notation (string).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you have wind data (wind speed, and wind direction in dgree), please set 'wind' as 'TRUE', and set values for 'coliwd' and 'coliws'.
</p>


<h3>Value</h3>

<p>the variation of summary statistics
Note that when the pattern USES
&quot;ncycle&quot; or &quot;custom&quot;, the start time determines the start time of the first
element in the average variation. For example, if the first timestamp of data is
&quot;2010-05-01 12:00:00&quot;, the resolution is 1 hour, the mode is &quot;ncycle&quot;, and the
value is 24, then the result represents diurnal variation starting from 12 o'clock.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>svri(met, bkip = "1 hour", mode = "recipes", value = "day", fun = 'quantile', probs=0.5,
st = "2017-05-01 00:00:00")
</code></pre>

<hr>
<h2 id='transp'>Convert the format of particle size data</h2><span id='topic+transp'></span>

<h3>Description</h3>

<p>Converting the format of particle size data. There are 2 types of particle size data: table and list.
For table format: the first column of input is datetime; the other column is the number concentration of each particle size channel, column name is the middle particle size of the particle size channel.  
For list format: the first column of input is datetime. The second column of input is for middle ranges of channels. 
The third column of input is for particle number concentration of each channel at each timepoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transp(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transp_+3A_df">df</code></td>
<td>
<p>dataframe of particle size data: a table or a list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe. If the input is a table, the output is a list, and if the input is a list, the output is a table.
</p>

<hr>
<h2 id='trs'>Resample time series by summary statistics</h2><span id='topic+trs'></span>

<h3>Description</h3>

<p>Resamples time series by summary statistics, and returns complete time series with new time resolution.
(wind data is acceptable)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trs(
  df,
  bkip,
  st = NULL,
  et = NULL,
  fun = "mean",
  probs = 0.5,
  na.rm = TRUE,
  wind = FALSE,
  coliws = 2,
  coliwd = 3,
  cpms = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trs_+3A_df">df</code></td>
<td>
<p>dataframe of time series.</p>
</td></tr>
<tr><td><code id="trs_+3A_bkip">bkip</code></td>
<td>
<p>new resolution breaking input of time series, such as '1 hour'.</p>
</td></tr>
<tr><td><code id="trs_+3A_st">st</code></td>
<td>
<p>start time of resampling. The default value is the fisrt value of datetime column.</p>
</td></tr>
<tr><td><code id="trs_+3A_et">et</code></td>
<td>
<p>end time of resampling. The default value is the last value of datetime column.</p>
</td></tr>
<tr><td><code id="trs_+3A_fun">fun</code></td>
<td>
<p>a function to compute the summary statistics which can be applied to all data subsets: 'sum', 'mean', 'median', 'min', 'max', 'sd' and 'quantile'.</p>
</td></tr>
<tr><td><code id="trs_+3A_probs">probs</code></td>
<td>
<p>numeric vector of probabilities with values in \([0,1]\).</p>
</td></tr>
<tr><td><code id="trs_+3A_na.rm">na.rm</code></td>
<td>
<p>logical value. Remove NA value or not?</p>
</td></tr>
<tr><td><code id="trs_+3A_wind">wind</code></td>
<td>
<p>logical value. if TRUE, please set coliwd, coliws.</p>
</td></tr>
<tr><td><code id="trs_+3A_coliws">coliws</code></td>
<td>
<p>numeric value, column index of wind speed in dataframe.</p>
</td></tr>
<tr><td><code id="trs_+3A_coliwd">coliwd</code></td>
<td>
<p>numeric value, column index of wind direction (degree) in dataframe.</p>
</td></tr>
<tr><td><code id="trs_+3A_cpms">cpms</code></td>
<td>
<p>logical value. Compensate the insufficient amount of the millisecond bit for datetime column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you have wind data (wind speed, and wind direction in dgree), please set 'wind' as 'TRUE', and set values for 'coliwd' and 'coliws'.
</p>


<h3>Value</h3>

<p>a dataframe which contains a time series for summary statistics with a new time resolution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>trs(met, bkip = "1 hour", st = "2017-05-01 00:00:00", wind = TRUE, coliws = 4, coliwd = 5)
</code></pre>

<hr>
<h2 id='tuv'>Calculate TUV in batch</h2><span id='topic+tuv'></span>

<h3>Description</h3>

<p>This function runs TUV in batch by reading the time series for the
parameters to be entered, and summarizes the results to the new dataframe. <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tuv(pathtuv, df, colid = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tuv_+3A_pathtuv">pathtuv</code></td>
<td>
<p>path for parent folder of TUV executable for Windows, such as &quot;c:/tuv5.3.1.exe&quot;.</p>
</td></tr>
<tr><td><code id="tuv_+3A_df">df</code></td>
<td>
<p>dataframe of the time series for the parameters to be entered, such as 'date', 'o3col'. It must includes date column.</p>
</td></tr>
<tr><td><code id="tuv_+3A_colid">colid</code></td>
<td>
<p>column index of date. The default value is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are online and offline versions of the TUV model, but both need to run on
a daily basis (that means manually reset parameters for each day's simulation). <br />
This function runs TUV in batch by reading the time series for the
parameters to be entered, and summarizes the results to the new dataframe. <br />
Currently only mode 2 (mode that outputs the photolysis rates) is supported. <br />
Logical variables are not supported currently!!! <br />
Please download <a href="https://www2.acom.ucar.edu/modeling/tropospheric-ultraviolet-and-visible-tuv-radiation-model">TUV executable for Windows</a> before you use this function.
</p>
<p>Columns of photolysis rate coefficients (s-1): <br />
1 = O3 -&gt; O2 + O(1D) <br />
2 = H2O2 -&gt; 2 OH <br />
3 = NO2 -&gt; NO + O(3P) <br />
4 = NO3 -&gt; NO + O2 <br />
5 = NO3 -&gt; NO2 + O(3P) <br />
6 = CH2O -&gt; H + HCO <br />
7 = CH2O -&gt; H2 + CO <br />
</p>


<h3>Value</h3>

<p>a dataframe.The first column is datetime. The second column is the solar altitude Angle. The rates of photolysis for each reaction(Unit: s-1)
start from third column: 1 = O3 -&gt; O2 + O1D
</p>

<hr>
<h2 id='tuv_batch'>Calculate TUV in Batch Online</h2><span id='topic+tuv_batch'></span>

<h3>Description</h3>

<p>This function runs TUV in batch online by reading the time series for the <br />
parameters to be entered, and summarizes the results to the new dataframe. <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tuv_batch(df, inputMode = 0, outputMode = 2, nStreams = -2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tuv_batch_+3A_df">df</code></td>
<td>
<p>Dataframe of time series of parameters. The first column of df should be datetime. The other columns (names) could be set as following: <br />
wStart -&gt; Shortest wavelength. The default value is 280. <br />  
wStop -&gt; Longest wavelength.  The default value is 420. <br />
wIntervals -&gt; Number of equal-sized subdivisions of the range End-Start. The default value is 140. <br /> 
latitude -&gt; Latitudes: positive North of equator, negative South of equator. The default value is 0. <br />
longitude -&gt; Longitudes: positive East of the Greenwich meridian, negative West of the Greenwich meridian. The default value is 0. <br />  
zenith -&gt; Solar zenith angle (deg). The default value is 0. <br />
ozone -&gt; Ozone column, in Dobson Units (du), vertical, from ground (even if above sea level) to space. The US Standard Atmosphere O3 is used to specify the shape of the vertical profile but the total column is re-scaled to the value selected here by the user. The default value is 300. <br />
albedo -&gt; Surface albedo: Assumes a Lambertian reflection (isotropic radiance) Values for snow can reach 0.90-0.99, but otherwise values at UV wavelengths are in the range 0.02-0.20 depending on the precise surface.  The default value is 0.1.
gAltitude -&gt; Ground elevation: The elevation of the ground, in km above mean sea level.  The default value is 0. <br />
mAltitude -&gt; Measurement altitude: The altitude in the atmosphere for which results are requested. This should not be confused with the ground elevation. For example, if you have measurements made from an airplane, flying at 6 km above the ground, and the surface is at 1.5 km, then you will want to request results for a measurement altitude of 7.5 km asl.   The default value is 0. <br />
taucld -&gt; Cloud Optical Depth: vertical optical depth of the cloud. The default value is 0.00.  <br />
zbase -&gt; Cloud base: base of cloud, in km (asl). The default value is 4.00. <br />  
ztop -&gt; Cloud top:  top of cloud, in km (asl). The default value is 5.00. <br />  
tauaer -&gt; Optical Depth: total extinction (absorption + scattering) at 550 nm, vertical, from ground to space. The default value is 0.235. <br />
ssaaer -&gt; Single Scattering Albedo (S-S alb), assumed independent of wavelength. The default value is 0.990. <br />
alpha -&gt; Alpha (Angstrom exponent), gives wavelength dependence of optical depth, by multiplying the 550 nm value by (550 nm/wavelength, nm)**alpha. The default value is 1.000. <br />
dirsun -&gt; Direct beam, direct solar beam. The default value is 1.0. <br /> 
difdn -&gt; Diffuse down, down-ward propagating scattered radiation (diffuse sky light). The default value is 1.0. <br />  
difup -&gt; Diffuse up, up-ward propagating scattered radiation (diffuse light from below). The default value is NA. <br /></p>
</td></tr>
<tr><td><code id="tuv_batch_+3A_inputmode">inputMode</code></td>
<td>
<p>The default value is 0. InputMode 0: User-specified geographic location and time/date. The code computes the appropriate solar zenith angle and Earth-Sun distance.  InputMode 1: User specifies the solar zenith angle, and the annual average Earth-Sun distance is used. To avoid inconsistencies (e.g. overhead sun at the poles), options 1 and 2 cannot be invoked at the same time.</p>
</td></tr>
<tr><td><code id="tuv_batch_+3A_outputmode">outputMode</code></td>
<td>
<p>The default value is 2.  OutputMode 2: Molecular photolysis frequencies (109 photoreactions). OutputMode 3: Weighted irradiance (27 weighting functions). OutputMode 4: Spectral actinic flux. OutputMode 5: Spectral irradiance.</p>
</td></tr>
<tr><td><code id="tuv_batch_+3A_nstreams">nStreams</code></td>
<td>
<p>The default value is -2.   NStreams -2: Pseudo-spherical 2 streams (faster, less accurate). NStreams 4: Pseudo-spherical discrete ordinate 4 streams (slower, more accurate).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe. The contents of dataframe are diterminated by OutputMode. <br /> 
OutputMode 2: Molecular photolysis frequencies (109 photoreactions). <br />
OutputMode 3: Weighted irradiance (27 weighting functions). <br />
OutputMode 4: Spectral actinic flux. <br />
OutputMode 5: Spectral irradiance. <br />
</p>

<hr>
<h2 id='tuv_core'>Calculate TUV Online</h2><span id='topic+tuv_core'></span>

<h3>Description</h3>

<p>This function runs TUV online by reading the input parameters, and summarizes the results to the new dataframe. <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tuv_core(
  wStart = 280,
  wStop = 420,
  wIntervals = 140,
  inputMode = 0,
  latitude = 0,
  longitude = 0,
  date = 20150630,
  timeStamp = "12:00:00",
  zenith = 0,
  ozone = 300,
  albedo = 0.1,
  gAltitude = 0,
  mAltitude = 0,
  taucld = 0,
  zbase = 4,
  ztop = 5,
  tauaer = 0.235,
  ssaaer = 0.99,
  alpha = 1,
  time = 12,
  outputMode = 2,
  nStreams = -2,
  dirsun = 1,
  difdn = 1,
  difup = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tuv_core_+3A_wstart">wStart</code></td>
<td>
<p>Shortest wavelength. The default value is 280. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_wstop">wStop</code></td>
<td>
<p>Longest wavelength.  The default value is 420. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_wintervals">wIntervals</code></td>
<td>
<p>Number of equal-sized subdivisions of the range End-Start. The default value is 140. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_inputmode">inputMode</code></td>
<td>
<p>The default value is 0. InputMode 0: User-specified geographic location and time/date. The code computes the appropriate solar zenith angle and Earth-Sun distance.  InputMode 1: User specifies the solar zenith angle, and the annual average Earth-Sun distance is used. To avoid inconsistencies (e.g. overhead sun at the poles), options 1 and 2 cannot be invoked at the same time.</p>
</td></tr>
<tr><td><code id="tuv_core_+3A_latitude">latitude</code></td>
<td>
<p>Latitudes: positive North of equator, negative South of equator. The default value is 0. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_longitude">longitude</code></td>
<td>
<p>Longitudes: positive East of the Greenwich meridian, negative West of the Greenwich meridian. The default value is 0. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_date">date</code></td>
<td>
<p>Date (format: (YYYYMMDD, GMT). The default value is 20150630. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_timestamp">timeStamp</code></td>
<td>
<p>-&gt; Timestamp (format: hh:mm:ss, GMT). The default value is &quot;12:00:00&quot;. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_zenith">zenith</code></td>
<td>
<p>Solar zenith angle (deg). The default value is 0. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_ozone">ozone</code></td>
<td>
<p>Ozone column, in Dobson Units (du), vertical, from ground (even if above sea level) to space. The US Standard Atmosphere O3 is used to specify the shape of the vertical profile but the total column is re-scaled to the value selected here by the user. The default value is 300. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_albedo">albedo</code></td>
<td>
<p>Surface albedo: Assumes a Lambertian reflection (isotropic radiance) Values for snow can reach 0.90-0.99, but otherwise values at UV wavelengths are in the range 0.02-0.20 depending on the precise surface.  The default value is 0.1.</p>
</td></tr>
<tr><td><code id="tuv_core_+3A_galtitude">gAltitude</code></td>
<td>
<p>Ground elevation: The elevation of the ground, in km above mean sea level.  The default value is 0. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_maltitude">mAltitude</code></td>
<td>
<p>Measurement altitude: The altitude in the atmosphere for which results are requested. This should not be confused with the ground elevation. For example, if you have measurements made from an airplane, flying at 6 km above the ground, and the surface is at 1.5 km, then you will want to request results for a measurement altitude of 7.5 km asl.   The default value is 0. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_taucld">taucld</code></td>
<td>
<p>Cloud Optical Depth: vertical optical depth of the cloud. The default value is 0.00.  <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_zbase">zbase</code></td>
<td>
<p>Cloud base: base of cloud, in km (asl). The default value is 4.00. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_ztop">ztop</code></td>
<td>
<p>Cloud top:  top of cloud, in km (asl). The default value is 5.00. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_tauaer">tauaer</code></td>
<td>
<p>Optical Depth: total extinction (absorption + scattering) at 550 nm, vertical, from ground to space. The default value is 0.235. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_ssaaer">ssaaer</code></td>
<td>
<p>Single Scattering Albedo (S-S alb), assumed independent of wavelength. The default value is 0.990. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_alpha">alpha</code></td>
<td>
<p>Alpha (Angstrom exponent), gives wavelength dependence of optical depth, by multiplying the 550 nm value by (550 nm/wavelength, nm)**alpha. The default value is 1.000. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_time">time</code></td>
<td>
<p>Hour. The default value is 12. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_outputmode">outputMode</code></td>
<td>
<p>The default value is 2.  OutputMode 2: Molecular photolysis frequencies (109 photoreactions). OutputMode 3: Weighted irradiance (27 weighting functions). OutputMode 4: Spectral actinic flux. OutputMode 5: Spectral irradiance.</p>
</td></tr>
<tr><td><code id="tuv_core_+3A_nstreams">nStreams</code></td>
<td>
<p>The default value is -2.   NStreams -2: Pseudo-spherical 2 streams (faster, less accurate). NStreams 4: Pseudo-spherical discrete ordinate 4 streams (slower, more accurate).</p>
</td></tr>
<tr><td><code id="tuv_core_+3A_dirsun">dirsun</code></td>
<td>
<p>Direct beam, direct solar beam. The default value is 1.0. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_difdn">difdn</code></td>
<td>
<p>Diffuse down, down-ward propagating scattered radiation (diffuse sky light). The default value is 1.0. <br /></p>
</td></tr>
<tr><td><code id="tuv_core_+3A_difup">difup</code></td>
<td>
<p>Diffuse up, up-ward propagating scattered radiation (diffuse light from below). The default value is NA. <br /></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe. The contents of dataframe are diterminated by OutputMode. <br /> 
OutputMode 2: Molecular photolysis frequencies (109 photoreactions). <br />
OutputMode 3: Weighted irradiance (27 weighting functions). <br />
OutputMode 4: Spectral actinic flux. <br />
OutputMode 5: Spectral irradiance. <br />
</p>

<hr>
<h2 id='voc'>Demo data of volatile organic compounds (VOCs)</h2><span id='topic+voc'></span>

<h3>Description</h3>

<p>5 days VOCs data (1 hour resolution) includes: Propylene, Acetylene, n-Butane,
trans-2-Butene, Cyclohexane.
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>voc
</code></pre>


<h3>Format</h3>

<p>A data frame with 120 rows and 6 variables:
</p>

<dl>
<dt>Time</dt><dd><p>Time for data</p>
</dd>
<dt>Propylene</dt><dd><p>Propylene</p>
</dd>
<dt>Acetylene</dt><dd><p>Acetylene</p>
</dd>
<dt>n.Butane</dt><dd><p>n-Butane</p>
</dd>
<dt>trans.2.Butene</dt><dd><p>trans-2-Butene</p>
</dd>
<dt>Cyclohexane</dt><dd><p>Cyclohexane</p>
</dd>
</dl>


<hr>
<h2 id='vocct'>Convertion and analysis of VOC concentrations</h2><span id='topic+vocct'></span>

<h3>Description</h3>

<p>convert unit of VOCs between micrograms per cubic meter (ugm) and parts
per billion by volume (ppbv); conduct statistics of VOC concentrations.
Note: for Chinese VOC name, please also use English punctuation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vocct(
  df,
  unit = "ppbv",
  t = 25,
  p = 101.325,
  stcd = FALSE,
  sortd = TRUE,
  chn = FALSE,
  bvoc = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vocct_+3A_df">df</code></td>
<td>
<p>dataframe contains time series.</p>
</td></tr>
<tr><td><code id="vocct_+3A_unit">unit</code></td>
<td>
<p>unit for VOC concentration. A character vector from these options: &quot;ugm&quot; or &quot;ppbv&quot;. &quot;ugm&quot; means ug/m3. &quot;ppbv&quot; means part per billion volumn.</p>
</td></tr>
<tr><td><code id="vocct_+3A_t">t</code></td>
<td>
<p>Temperature, in Degrees Celsius, used to convert data in 
micrograms per cubic meter to standard conditions 
(25 Degrees Celsius, 101.325 kPa). By default, t equals to 25 Degrees Celsius.</p>
</td></tr>
<tr><td><code id="vocct_+3A_p">p</code></td>
<td>
<p>Pressure, in kPa, used to convert data in micrograms per cubic meter 
to standard conditions (25 Degrees Celsius, 101.325 kPa). 
By default, p equals to 101.325 kPa.</p>
</td></tr>
<tr><td><code id="vocct_+3A_stcd">stcd</code></td>
<td>
<p>logical. Does it output results in standard conditions? The default vaule is FALSE.</p>
</td></tr>
<tr><td><code id="vocct_+3A_sortd">sortd</code></td>
<td>
<p>logical value. It determines whether the VOC species
are sorted or not. By default, sortd has value &quot;TRUE&quot;.
If TRUE, VOC species in time series will be arranged according to VOC group,
relative molecular weight, and MIR value.</p>
</td></tr>
<tr><td><code id="vocct_+3A_chn">chn</code></td>
<td>
<p>logical. Dose colnames present as Chinese? The default vaule is FALSE.</p>
</td></tr>
<tr><td><code id="vocct_+3A_bvoc">bvoc</code></td>
<td>
<p>logical. Whether you want to list BVOC as a separate VOC group? The default vaule is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CAS number was matched for each VOC speices (from column name), and the
Molecular Weight (MW) value and Maximum Incremental Reactivity (MIR) value are matched through the CAS number and used for time series calculation. <br />
The MIR value comes from &quot;Carter, W. P. (2009). Updated maximum incremental
reactivity scale and hydrocarbon bin reactivities for regulatory applications.
California Air Resources Board Contract, 2009, 339&quot; (revised January 28, 2010).
</p>


<h3>Value</h3>

<p>a list contains 9 tables:
MW_Result: the matched Molecular Weight (MW) value result;
Con_ugm: the time series of VOC mass concentration by species;
Con_ugm_stat: the statistics of VOC mass concentration by species;
Con_ugm_group: the time series of VOC mass concentration classified by groups;
Con_ugm_group_stat: the statistics of VOC mass concentrationaccording to major groups;
Con_ppbv: time series of VOC volume concentration by species;
Con_ppbv_stat: the statistics of VOC volume concentration by species;
Con_ppbv_group: the time series of VOC volume concentration according to major groups;
Con_ppbv_group_stat: the time series of VOC volume concentration classified by groups.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>voc_con=vocct(voc)
summary(voc_con)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
