<!DOCTYPE html><html lang="en"><head><title>Help for package kitagawa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {kitagawa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#kitagawa-package'><p>kitagawa: Spectral Response of Water Wells to Harmonic Strain and Pressure Signals</p></a></li>
<li><a href='#alpha_constants'><p>Calculate any constants depending on effective stress coefficient <code class="reqn">\alpha</code></p></a></li>
<li><a href='#cross_spectrum'><p>Calculate the cross-spectrum of two timeseries</p></a></li>
<li><a href='#kitagawa-constants'><p>Access to constants used by default</p></a></li>
<li><a href='#kitagawa-utilities'><p>General utility functions</p></a></li>
<li><a href='#logsmoo'><p>Logarithmic smoothing with loess</p></a></li>
<li><a href='#logticks'><p>Add proper logarithm ticks to a plot axis.</p></a></li>
<li><a href='#omega_constants'><p>Calculate any constants that depend on angular frequency <code class="reqn">\omega</code></p></a></li>
<li><a href='#omega_norm'><p>Dimensionless frequency from diffusivity and depth</p></a></li>
<li><a href='#open_well_response'><p>Spectral response for an open well</p></a></li>
<li><a href='#owrsp-methods'><p>Generic methods for objects with class <code>'owrsp'</code>.</p></a></li>
<li><a href='#sensing_volume'><p>Calculate volume of fluids in the sensing region of the borehole.</p></a></li>
<li><a href='#well_response'><p>Spectral response for a sealed well</p></a></li>
<li><a href='#wrsp-methods'><p>Generic methods for objects with class <code>'wrsp'</code>.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spectral Response of Water Wells to Harmonic Strain and Pressure
Signals</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-26</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools to calculate the theoretical hydrodynamic response
    of an aquifer undergoing harmonic straining or pressurization, or analyze
    measured responses. There are
    two classes of models here, designed for use with confined
    aquifers: (1) for sealed wells, based on the model of 
    Kitagawa et al (2011, &lt;<a href="https://doi.org/10.1029%2F2010JB007794">doi:10.1029/2010JB007794</a>&gt;), 
    and (2) for open wells, based on the models of
    Cooper et al (1965, &lt;<a href="https://doi.org/10.1029%2FJZ070i016p03915">doi:10.1029/JZ070i016p03915</a>&gt;), 
    Hsieh et al (1987, &lt;<a href="https://doi.org/10.1029%2FWR023i010p01824">doi:10.1029/WR023i010p01824</a>&gt;), 
    Rojstaczer (1988, &lt;<a href="https://doi.org/10.1029%2FJB093iB11p13619">doi:10.1029/JB093iB11p13619</a>&gt;), 
    Liu et al (1989, &lt;<a href="https://doi.org/10.1029%2FJB094iB07p09453">doi:10.1029/JB094iB07p09453</a>&gt;), and
    Wang et al (2018, &lt;<a href="https://doi.org/10.1029%2F2018WR022793">doi:10.1029/2018WR022793</a>&gt;). Wang's 
    solution is a special exception which
    allows for leakage out of the aquifer 
    (semi-confined); it is equivalent to Hsieh's model
    when there is no leakage (the confined case).
    These models treat strain (or aquifer head) as an input to the
    physical system, and fluid-pressure (or water height) as the output. The
    applicable frequency band of these models is characteristic of seismic
    waves, atmospheric pressure fluctuations, and solid earth tides.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/abarbour/kitagawa">https://github.com/abarbour/kitagawa</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/abarbour/kitagawa/issues">https://github.com/abarbour/kitagawa/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.1), stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>Bessel, kelvin (&ge; 1.2.0), psd (&ge; 2.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, tibble, RColorBrewer, signal, testthat, knitr,
rmarkdown, formatR, covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-28 17:10:06 UTC; abarbour</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew J. Barbour <a href="https://orcid.org/0000-0002-6890-2452"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Jonathan Kennel <a href="https://orcid.org/0000-0003-4474-6886"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew J. Barbour &lt;andy.barbour@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-29 09:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='kitagawa-package'>kitagawa: Spectral Response of Water Wells to Harmonic Strain and Pressure Signals</h2><span id='topic+kitagawa-package'></span><span id='topic+kitagawa'></span>

<h3>Description</h3>

<p>Provides tools to calculate the theoretical hydrodynamic response of an aquifer undergoing harmonic straining or pressurization, or analyze measured responses. There are two classes of models here, designed for use with confined aquifers: (1) for sealed wells, based on the model of Kitagawa et al (2011, <a href="https://doi.org/10.1029/2010JB007794">doi:10.1029/2010JB007794</a>), and (2) for open wells, based on the models of Cooper et al (1965, <a href="https://doi.org/10.1029/JZ070i016p03915">doi:10.1029/JZ070i016p03915</a>), Hsieh et al (1987, <a href="https://doi.org/10.1029/WR023i010p01824">doi:10.1029/WR023i010p01824</a>), Rojstaczer (1988, <a href="https://doi.org/10.1029/JB093iB11p13619">doi:10.1029/JB093iB11p13619</a>), Liu et al (1989, <a href="https://doi.org/10.1029/JB094iB07p09453">doi:10.1029/JB094iB07p09453</a>), and Wang et al (2018, <a href="https://doi.org/10.1029/2018WR022793">doi:10.1029/2018WR022793</a>). Wang's solution is a special exception which allows for leakage out of the aquifer (semi-confined); it is equivalent to Hsieh's model when there is no leakage (the confined case). These models treat strain (or aquifer head) as an input to the physical system, and fluid-pressure (or water height) as the output. The applicable frequency band of these models is characteristic of seismic waves, atmospheric pressure fluctuations, and solid earth tides.
</p>


<h3>Details</h3>

<p>Provides tools to calculate the theoretical hydrodynamic response
of an aquifer undergoing harmonic straining or pressurization. There are
two classes of models here: (1) for sealed wells, based on the model of
Kitagawa et al (2011), and (2) for open wells, based on the models of
Cooper et al (1965), Hsieh et al (1987), Rojstaczer (1988), Liu et al
(1989), and Wang et al (2018). These models treat strain (or aquifer head) as 
an input to the physical system, and fluid-pressure (or water height) as the output. The
applicable frequency band of these models is characteristic of seismic
waves, atmospheric pressure fluctuations, and solid earth tides.
The Wang et al (2018) can explicitly model vertical leakage.
</p>
<p>The following functions provide the primary features of the package:
</p>
<p><code><a href="#topic+well_response">well_response</a></code> and <code><a href="#topic+open_well_response">open_well_response</a></code>, which 
take in arguments for well- and aquifer-parameters, and the frequencies
at which to calculate the response functions.
They both access the constants-calculation routines as necessary, meaning
the user need not worry about those functions
(e.g., <code><a href="#topic+alpha_constants">alpha_constants</a></code>).
</p>
<p>Helper functions: 
</p>

<dl>
<dt><code><a href="#topic+sensing_volume">sensing_volume</a></code></dt><dd><p> can be used to compute the
sensing volume of fluid, for the specified well dimensions.</p>
</dd>
</dl>



<h3>Scientific background</h3>

<p>The underlying model is based upon the assumption that fluid flows radially
through an homogeneous, isotropic, confined aquifer.
</p>
<p>The underlying principle is as follows.  When a harmonic wave induces
strain in a confined aquifer (one having an aquitard above and below it), 
fluid flows radially into, and out of a well penetrating the aquifer.
The flow-induced drawdown, <code class="reqn">s</code>, is governed by the following 
partial differential equation, expressed in radial coordinates(<code class="reqn">r</code>):
</p>
<p style="text-align: center;"><code class="reqn">
\frac{\partial^2 s}{\partial r^2} + \frac{1}{r} 
\frac{\partial s}{ \partial r} - \frac{S}{T}\frac{\partial s}{\partial t} = 0
</code>
</p>

<p>where <code class="reqn">S, T</code> are the aquifer storativity and transmissivity respectively.
</p>
<p>The solution to this PDE, with periodic discharge boundary conditions,
gives the amplitude and phase response we wish to calculate.
The solution  for an open well was presented by
Cooper et al (1965), and subsequently modified by Liu et al (1989). 
Wang et al (2018) modified this solution for the leaky aquifer case.
Kitagawa et al (2011) adapted the solution
of Hsieh et al (1987) for the case of a sealed well.
When there is no leakage, Wang et al (2018) is
equivalent to Hsieh et al (1987).
</p>
<p>These models are applicable to any quasi-static process involving harmonic, 
volumetric strain of an aquifer 
(e.g. passing Rayleigh waves, or changes in the Earth's tidal potential). 
In practice, however, the presence of permeable fractures can violate the
assumption of isotropic permeability, which may substantially
alter the response by introducing shear-strain coupling. But these
complications are beyond the scope of this model.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Andrew J. Barbour <a href="mailto:andy.barbour@gmail.com">andy.barbour@gmail.com</a> (<a href="https://orcid.org/0000-0002-6890-2452">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Jonathan Kennel (<a href="https://orcid.org/0000-0003-4474-6886">ORCID</a>) [contributor]
</p>
</li></ul>

<p>Andrew J. Barbour &lt;andy.barbour@gmail.com&gt; with contributions from Jonathan Kennel
</p>


<h3>References</h3>

<p>Abramowitz, M. and Stegun, I. A. (Eds.). &quot;Kelvin Functions.&quot; 
<code class="reqn">\S 9.9</code> in Handbook of Mathematical Functions with Formulas, Graphs, 
and Mathematical Tables, 9th printing. New York: Dover, pp. 379-381, 1972.
</p>
<p>Cooper, H. H., Bredehoeft, J. D., Papadopulos, I. S., and Bennett, R. R. (1965),
The response of well-aquifer systems to seismic waves, 
<em>J. Geophys. Res.</em>, <strong>70</strong> (16)
</p>
<p>Hsieh, P. A., J. D. Bredehoeft, and J. M. Farr (1987),
Determination of aquifer transmissivity from Earth tide analysis,
<em>Water Resour. Res.</em>, <strong>23</strong> (10)
</p>
<p>Kitagawa, Y., S. Itaba, N. Matsumoto, and N. Koisumi (2011),
Frequency characteristics of the response of water pressure in a closed well to volumetric strain 
in the high-frequency domain,
<em>J. Geophys. Res.</em>, <strong>116</strong>, B08301
</p>
<p>Liu, L.-B., Roeloffs, E., and Zheng, X.-Y. (1989),
Seismically Induced Water Level Fluctuations in the Wali Well, Beijing, China,
<em>J. Geophys. Res.</em>, <strong>94</strong> (B7)
</p>
<p>Roeloffs, E. (1996),
Poroelastic techniques in the study of earthquake-related hydrologic phenomena,
<em>Advances in Geophysics</em>, <strong>37</strong>
</p>
<p>Wang C.-Y., Doan, M.-L., Xue, L., Barbour, A. (2018),
Tidal Response of Groundwater in a Leaky Aquiferâ€”Application to Oklahoma,
<em>Water Resour. Res.</em>, <strong>54</strong> (10)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/abarbour/kitagawa">https://github.com/abarbour/kitagawa</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/abarbour/kitagawa/issues">https://github.com/abarbour/kitagawa/issues</a>
</p>
</li></ul>

<p><code><a href="#topic+open_well_response">open_well_response</a></code>, 
<code><a href="#topic+well_response">well_response</a></code>, 
<code><a href="#topic+sensing_volume">sensing_volume</a></code>, 
<code><a href="#topic+wrsp-methods">wrsp-methods</a></code>
</p>

<hr>
<h2 id='alpha_constants'>Calculate any constants depending on effective stress coefficient <code class="reqn">\alpha</code></h2><span id='topic+alpha_constants'></span><span id='topic+alpha_constants.default'></span>

<h3>Description</h3>

<p>This function accesses the appropriate method to calculate the
<code class="reqn">\alpha</code>-dependent constant associated with the choice of <code>c.type</code>.  
There are currently four such constants, which correspond to
<strong>Equations 10, 11, 18, 19</strong> in Kitagawa et al (2011).
</p>
<p><em>This function is not likely to be needed by the user.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha_constants(alpha = 0, c.type = c("Phi", "Psi", "A", "Kel"))

## Default S3 method:
alpha_constants(alpha = 0, c.type = c("Phi", "Psi", "A", "Kel"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="alpha_constants_+3A_alpha">alpha</code></td>
<td>
<p>the constant alpha (see <code><a href="#topic+omega_constants">omega_constants</a></code>)</p>
</td></tr>
<tr><td><code id="alpha_constants_+3A_c.type">c.type</code></td>
<td>
<p>the constant to calculate</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>What is <code>"alpha"</code>?</h4>

<p>The constant <code class="reqn">\alpha</code> is a function of frequency <code class="reqn">\omega</code> as well 
as aquifer and well parameters; it is formally defined as
</p>
<p style="text-align: center;"><code class="reqn">\alpha \equiv R_S \sqrt{\omega S / T}</code>
</p>

<p>where <code class="reqn">S</code> is the storativity, <code class="reqn">T</code> is the aquifer's effective
transmissivity, and <code class="reqn">R_S</code> is the radius of the screened portion
of the well.
</p>



<h4>What is calculated?</h4>

<p>The various constants which may be calculated with this function are
</p>

<dl>
<dt><code>Phi</code></dt><dd><p>Given as <code class="reqn">\Phi</code> in Eqn. 10</p>
</dd>
<dt><code>Psi</code></dt><dd><p>Given as <code class="reqn">\Psi</code> in Eqn. 11</p>
</dd>
<dt><code>A</code></dt><dd><p>Given as <code class="reqn">A_i, i=1,2</code> in Eqns. 18, 19</p>
</dd>
<dt><code>Kel</code></dt><dd><p>The complex Kelvin functions (see Abramowitz and Stegun, 1972)</p>
</dd>
</dl>




<h3>Value</h3>

<p>Complex matrix having values representing the constant 
represented by <code>c.type</code>, 
<em>as well as</em> any other <code class="reqn">\alpha</code>-dependent constants 
which are needed in the computation.
</p>


<h3>Author(s)</h3>

<p>A. J. Barbour &lt;andy.barbour@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+omega_constants">omega_constants</a></code>, <code><a href="#topic+well_response">well_response</a></code>
</p>
<p>Other ConstantsCalculators: 
<code><a href="#topic+kitagawa-constants">kitagawa-constants</a></code>,
<code><a href="#topic+omega_constants">omega_constants</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha_constants()   # kelvin::Keir gives warning
alpha_constants(1)  # defaults to constant 'Phi' (note output also has Kel)
alpha_constants(1:10, c.type="A")  # constant 'A' (again, note output)
</code></pre>

<hr>
<h2 id='cross_spectrum'>Calculate the cross-spectrum of two timeseries</h2><span id='topic+cross_spectrum'></span><span id='topic+cross_spectrum.mts'></span><span id='topic+cross_spectrum.default'></span>

<h3>Description</h3>

<p>Calculate the cross-spectrum of two timeseries
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cross_spectrum(x, ...)

## S3 method for class 'mts'
cross_spectrum(x, ...)

## Default S3 method:
cross_spectrum(
  x,
  y,
  k = 10,
  samp = 1,
  q,
  adaptive = FALSE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cross_spectrum_+3A_x">x</code></td>
<td>
<p>numeric; timeseries</p>
</td></tr>
<tr><td><code id="cross_spectrum_+3A_...">...</code></td>
<td>
<p>additional arguments to <code><a href="psd.html#topic+pspectrum">pspectrum</a></code></p>
</td></tr>
<tr><td><code id="cross_spectrum_+3A_y">y</code></td>
<td>
<p>numeric; timeseries. if missing, assumed to be column no. 2 in <code>x</code></p>
</td></tr>
<tr><td><code id="cross_spectrum_+3A_k">k</code></td>
<td>
<p>integer; the number of sine tapers, unless this is <code>NULL</code>; in the latter case
a Welch-based spectrum is calculated rather than a multitaper spectrum. There are distinct
advantages and disadvantages to either of these.</p>
</td></tr>
<tr><td><code id="cross_spectrum_+3A_samp">samp</code></td>
<td>
<p>numeric; the sampling rate (e.g., <code><a href="stats.html#topic+deltat">deltat</a></code>) of the data; must be the same for <code>x</code> and <code>y</code></p>
</td></tr>
<tr><td><code id="cross_spectrum_+3A_q">q</code></td>
<td>
<p>numeric; the probability quantile [0,1] to calculate coherence significance levels; if missing, a 
pre-specified sequence is included. This is will be ignored for Welch-based spectra (see <code>k</code>).</p>
</td></tr>
<tr><td><code id="cross_spectrum_+3A_adaptive">adaptive</code></td>
<td>
<p>logical; should adaptive multitaper estimation be used?</p>
</td></tr>
<tr><td><code id="cross_spectrum_+3A_verbose">verbose</code></td>
<td>
<p>logical; should messages be printed?</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
require(psd)

n &lt;- 1000
ramp &lt;- seq_len(n)
parab &lt;- ramp^2

set.seed(1255)
X &lt;- ts(rnorm(n) + ramp/2)
Y &lt;- ts(rnorm(n) + ramp/10 + parab/100)

# Calculate the multitaper cross spectrum
csd &lt;- cross_spectrum(X, Y, k=20)

</code></pre>

<hr>
<h2 id='kitagawa-constants'>Access to constants used by default</h2><span id='topic+kitagawa-constants'></span><span id='topic+constants'></span>

<h3>Description</h3>

<p>The response of an aquifer depends on its mechanical
and hydrological properties; if these are not known or 
specified, these constants are used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constants(do.str = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kitagawa-constants_+3A_do.str">do.str</code></td>
<td>
<p>logical; should the structure be printed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code><a href="#topic+constants">constants</a></code>
shows the structure of (optionally),
and returns the assumed constants, which do <em>not</em> reside in
the namespace.
</p>


<h4>Values</h4>


<dl>
<dt>For water: </dt><dd><p>Density and bulk modulus</p>
</dd>
<dt>Gravity: </dt><dd><p>Standard gravitational acceleration at 6371km radius (Earth)</p>
</dd>
<dt>Conversions: </dt><dd><p>Degrees to radians</p>
</dd>
</dl>




<h3>Value</h3>

<p>The constants, invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+well_response">well_response</a></code> and <code><a href="#topic+open_well_response">open_well_response</a></code>
</p>
<p><code><a href="#topic+kitagawa-package">kitagawa-package</a></code>
</p>
<p>Other ConstantsCalculators: 
<code><a href="#topic+alpha_constants">alpha_constants</a>()</code>,
<code><a href="#topic+omega_constants">omega_constants</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>constants()
constants(FALSE) # returns invisibly
</code></pre>

<hr>
<h2 id='kitagawa-utilities'>General utility functions</h2><span id='topic+kitagawa-utilities'></span><span id='topic+.nullchk'></span><span id='topic+.in0to1'></span><span id='topic+is.wrsp'></span><span id='topic+is.owrsp'></span>

<h3>Description</h3>

<p>General utility functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.nullchk(X)

.in0to1(X)

is.wrsp(X)

is.owrsp(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kitagawa-utilities_+3A_x">X</code></td>
<td>
<p>something to be checked (vector, scalar, wrsp object, ...)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+.nullchk">.nullchk</a></code> quickly checks for <code>NULL</code> and <code>NA</code>,
and raises an error if <code>TRUE</code>; 
<em>This function is not likely to be needed by the user.</em>
</p>
<p><code><a href="#topic+.in0to1">.in0to1</a></code> checks if values are numeric and in [0,1] (inclusive).
</p>
<p><code><a href="#topic+is.wrsp">is.wrsp</a></code> and <code><a href="#topic+is.owrsp">is.owrsp</a></code> report whether an object 
has S3 class 'wrsp' or 'owrsp', respectively.  Such an object
would be returned by, for example, <code><a href="#topic+well_response">well_response</a></code>.
</p>


<h3>Author(s)</h3>

<p>A. J. Barbour &lt;andy.barbour@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kitagawa-package">kitagawa-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
.nullchk(1:10) # OK
.nullchk(NULL) # error
.nullchk(c(1:10,NULL)) # error
.nullchk(NA) # error
.nullchk(c(1:10,NA)) # error

.in0to1(1:10) # error
.in0to1(NULL) # error
.in0to1(c(1:10,NULL)) # error
.in0to1(NA) # error
.in0to1(c(1:10,NA)) # error
.in0to1(c(1,NA)) # error

is.wrsp(1) # FALSE

## End(Not run)
</code></pre>

<hr>
<h2 id='logsmoo'>Logarithmic smoothing with loess</h2><span id='topic+logsmoo'></span>

<h3>Description</h3>

<p>Logarithmic smoothing with loess
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logsmoo(x, y, x.is.log = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logsmoo_+3A_x">x</code></td>
<td>
<p>numeric; the index series (cannot contain <code>NA</code>)</p>
</td></tr>
<tr><td><code id="logsmoo_+3A_y">y</code></td>
<td>
<p>numeric; the series of values associated with x</p>
</td></tr>
<tr><td><code id="logsmoo_+3A_x.is.log">x.is.log</code></td>
<td>
<p>logical; determines whether the series in <code>x</code> has
been log-transformed already. If <code>FALSE</code> then <code>log10</code> is used.</p>
</td></tr>
<tr><td><code id="logsmoo_+3A_...">...</code></td>
<td>
<p>additional parameters (e.g., <code>span</code>) passed to <code><a href="stats.html#topic+loess.smooth">loess.smooth</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of <code><a href="stats.html#topic+loess.smooth">loess.smooth</a></code>
</p>


<h3>References</h3>

<p>Barbour, A. J., and D. C. Agnew (2011), Noise levels on 
Plate Boundary Observatory borehole strainmeters in southern California,
Bulletin of the Seismological Society of America, 101(5), 2453-2466,
doi: 10.1785/0120110062
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+loess.smooth">loess.smooth</a></code> and <code><a href="stats.html#topic+approxfun">approxfun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(11133)
n &lt;- 101
lx &lt;- seq(-1,1,length.out=n)
y &lt;- rnorm(n) + cumsum(rnorm(n))
plot(lx, y, col='grey')
lines(logsmoo(lx, y, x.is.log=TRUE))

</code></pre>

<hr>
<h2 id='logticks'>Add proper logarithm ticks to a plot axis.</h2><span id='topic+logticks'></span><span id='topic+log_ticks'></span><span id='topic+log2_ticks'></span><span id='topic+log10_ticks'></span>

<h3>Description</h3>

<p>Add proper logarithm ticks to a plot axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logticks(
  ax = 1,
  n.minor = 9,
  t.lims,
  t.ratio = 0.5,
  major.ticks = NULL,
  base = c("ten", "ln", "two"),
  ticks.only = FALSE,
  ...
)

log_ticks(...)

log2_ticks(...)

log10_ticks(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logticks_+3A_ax">ax</code></td>
<td>
<p>numeric; the axis number to add tick-marks to</p>
</td></tr>
<tr><td><code id="logticks_+3A_n.minor">n.minor</code></td>
<td>
<p>numeric; the number of minor ticks to display</p>
</td></tr>
<tr><td><code id="logticks_+3A_t.lims">t.lims</code></td>
<td>
<p>numeric; the upper and lower tick limits (in log space)</p>
</td></tr>
<tr><td><code id="logticks_+3A_t.ratio">t.ratio</code></td>
<td>
<p>numeric; the ratio of minor to major tick lengths.</p>
</td></tr>
<tr><td><code id="logticks_+3A_major.ticks">major.ticks</code></td>
<td>
<p>numeric; the axis limits.</p>
</td></tr>
<tr><td><code id="logticks_+3A_base">base</code></td>
<td>
<p>numeric; the base of the logarithm (somewhat experimental)</p>
</td></tr>
<tr><td><code id="logticks_+3A_ticks.only">ticks.only</code></td>
<td>
<p>logical; on the axis</p>
</td></tr>
<tr><td><code id="logticks_+3A_...">...</code></td>
<td>
<p>additional parameters passed to the <code>axis</code> call for the major ticks.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This uses <code><a href="base.html#topic+pretty">pretty</a></code> with <code>n==5</code>, and assumes 
that the data along the axis <code>ax</code> has 
<em>already</em> been transformed into its logarithm.
<em>Only integer exponents are labeled.</em>
</p>
<p>The functions 
<code><a href="#topic+log_ticks">log_ticks</a></code>,
<code><a href="#topic+log2_ticks">log2_ticks</a></code>, and
<code><a href="#topic+log10_ticks">log10_ticks</a></code> are wrapper functions.
</p>
<p>Set the <code>axt</code> parameter (e.g. <code>xaxt</code>) to <code>'n'</code> 
in the original plot command to prevent adding default tick marks.
</p>


<h3>Author(s)</h3>

<p>A. J. Barbour &lt;andy.barbour@gmail.com&gt;
</p>


<h3>References</h3>

<p>This was modified from a post on StackOverflow:
<a href="https://stackoverflow.com/questions/6955440/displaying-minor-logarithmic-ticks-in-x-axis-in-r">https://stackoverflow.com/questions/6955440/displaying-minor-logarithmic-ticks-in-x-axis-in-r</a>
</p>


<h3>See Also</h3>

<p>Other PlotUtilities: 
<code><a href="#topic+wrsp-methods">wrsp-methods</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 10^(0:8)
y &lt;- 1:9

plot(log10(x),y,xaxt="n",xlab="x",xlim=c(0,9))
logticks()
logticks(ax=3, ticks.only=TRUE)

par(tcl=0.5) # have tick marks show up on inside instead
plot(log10(x),y,xaxt="n",xlab="x",xlim=c(0,9))
logticks()
logticks(ax=3, ticks.only=TRUE)
</code></pre>

<hr>
<h2 id='omega_constants'>Calculate any constants that depend on angular frequency <code class="reqn">\omega</code></h2><span id='topic+omega_constants'></span><span id='topic+omega_constants.default'></span>

<h3>Description</h3>

<p>This function accesses the appropriate method to calculate the
<code class="reqn">\omega</code>-dependent constant associated with the choice of <code>c.type</code>.
</p>
<p><em>This function is not likely to be needed by the user.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omega_constants(omega = 0, c.type = c("alpha", "diffusivity_time"), ...)

## Default S3 method:
omega_constants(omega = 0, c.type = c("alpha", "diffusivity_time"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="omega_constants_+3A_omega">omega</code></td>
<td>
<p>frequency,  <code class="reqn">[rad/sec]</code></p>
</td></tr>
<tr><td><code id="omega_constants_+3A_c.type">c.type</code></td>
<td>
<p>the constant to calculate</p>
</td></tr>
<tr><td><code id="omega_constants_+3A_...">...</code></td>
<td>
<p>additional params passed to calculator.  In the case of 
<code>ctype="alpha"</code>, set 
<code>S., T., Rs.</code>; and, in the case of
<code>ctype="diffusivity_time"</code>, set
<code>D.</code> or <code>S., T.</code>.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>What is <code>"omega"</code>?</h4>

<p>The name is in reference to
radial frequency <code class="reqn">\omega</code>, which is defined as
</p>
<p style="text-align: center;"><code class="reqn">\omega \equiv 2 \pi / \tau</code>
</p>

<p>where <code class="reqn">\tau</code> is the period of oscillation.
</p>



<h4>What is the <code>"alpha"</code> calculation?</h4>

<p>The parameter <code class="reqn">\alpha</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">\alpha \equiv r_w \sqrt{\omega S / T}</code>
</p>

<p>where <code class="reqn">r_w</code> is the radius of the well,
where <code class="reqn">S</code> is the storativity, and <code class="reqn">T</code> is
transmissivity.  See the parameter <code>...</code> for details
on how to pass these values.
</p>
<p>This definition is common to many papers on the topic.  For example,
it corresponds to  <strong>Equation 12</strong> in Kitagawa et al (2011).
Because the computation of <code class="reqn">\alpha</code> depends also on physical
properties, additional parameters can be
passed through (e.g. the transmissivity).  
</p>



<h4>What is the <code>"diffusivity_time"</code> calculation?</h4>

<p>This is a similar calculation to <code><a href="#topic+omega_norm">omega_norm</a></code>. It uses
the effective hydraulic diffusivity <code class="reqn">D</code>, which is defined in
this case as the ratio of transmissivity to storativity:
</p>
<p style="text-align: center;"><code class="reqn">D \equiv \frac{T}{S}</code>
</p>




<h3>Value</h3>

<p>Values of the constant represented by <code>c.type</code> for the given
parameters
</p>


<h3>Warnings Issued</h3>

<p>In the case <code>c.type='alpha'</code>, the 
parameters <code>S.</code>, <code>T.</code>,  and <code>Rs.</code> should
be passed; otherwise, values are assumed to ensure the 
calculation does not fail, and the results are essentially meaningless.
</p>
<p>Warnings will be issued if any necessary parameters are missing, indicating
default values were used.
</p>


<h3>Author(s)</h3>

<p>A. J. Barbour &lt;andy.barbour@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+alpha_constants">alpha_constants</a></code>, <code><a href="#topic+well_response">well_response</a></code>, and
<code><a href="#topic+kitagawa-package">kitagawa-package</a></code> for references and more background.
</p>
<p>Other ConstantsCalculators: 
<code><a href="#topic+alpha_constants">alpha_constants</a>()</code>,
<code><a href="#topic+kitagawa-constants">kitagawa-constants</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># alpha
omega_constants() # default is alpha, but will give warnings about S., T., Rs.
omega_constants(T.=1,S.=1,Rs.=1)  # 0, no warnings
omega_constants(1:10)  # sequence, with warnings about S., T., Rs.
omega_constants(1:10,T.=1,S.=1,Rs.=1) # sequence, no warnings
# diffusivity time
omega_constants(c.type="diffusivity_time", D.=1)  # 0, no warnings
omega_constants(c.type="diff", D.=1)  # 0, no warnings (arg matching)
omega_constants(c.type="diff")  # 0, warnings about S., T. because no D.
omega_constants(c.type="diff", S.=1)  # 0, warnings about T. because no D. or S.
</code></pre>

<hr>
<h2 id='omega_norm'>Dimensionless frequency from diffusivity and depth</h2><span id='topic+omega_norm'></span>

<h3>Description</h3>

<p>Dimensionless frequency from diffusivity and depth
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omega_norm(omega, Diffusiv, z, invert = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="omega_norm_+3A_omega">omega</code></td>
<td>
<p>numeric; angular frequency</p>
</td></tr>
<tr><td><code id="omega_norm_+3A_diffusiv">Diffusiv</code></td>
<td>
<p>numeric; hydraulic diffusivity</p>
</td></tr>
<tr><td><code id="omega_norm_+3A_z">z</code></td>
<td>
<p>numeric; depth</p>
</td></tr>
<tr><td><code id="omega_norm_+3A_invert">invert</code></td>
<td>
<p>logical; should <code>omega</code> be taken as normalized
frequency?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dimensionless frequency <code class="reqn">Q</code> is defined as </p>
<p style="text-align: center;"><code class="reqn">Q=\frac{z^2 \omega}{2 D}</code>
</p>

<p>where 
<code class="reqn">z</code> is the well depth,
<code class="reqn">\omega</code> is the angular frequency
and <code class="reqn">D</code> is the hydraulic diffusivity.
</p>


<h3>Value</h3>

<p><code><a href="#topic+omega_norm">omega_norm</a></code> returns dimensionless frequency, unless <code>invert=TRUE</code>
where it will assume <code>omega</code> is dimensionless frequency, and return radial frequency.
</p>


<h3>Author(s)</h3>

<p>A. J. Barbour &lt;andy.barbour@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+open_well_response">open_well_response</a></code>, <code><a href="#topic+kitagawa-package">kitagawa-package</a></code>
</p>
<p>Other utilities: 
<code><a href="#topic+sensing_volume">sensing_volume</a>()</code>
</p>

<hr>
<h2 id='open_well_response'>Spectral response for an open well</h2><span id='topic+open_well_response'></span><span id='topic+open_well_response.default'></span>

<h3>Description</h3>

<p>This is the primary function to calculate the response
for an open (exposed to air) well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>open_well_response(omega, T., S., ...)

## Default S3 method:
open_well_response(
  omega,
  T.,
  S.,
  Rs. = (8/12) * (1200/3937),
  rho,
  grav,
  z,
  Hw,
  Ta,
  leak,
  freq.units = c("rad_per_sec", "Hz"),
  model = c("rojstaczer", "liu", "cooper", "hsieh", "wang"),
  as.pressure = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="open_well_response_+3A_omega">omega</code></td>
<td>
<p>numeric; frequency,  (see <code>freq.units</code>)</p>
</td></tr>
<tr><td><code id="open_well_response_+3A_t.">T.</code></td>
<td>
<p>numeric; effective aquifer transmissivity <code class="reqn">[m^2/s]</code></p>
</td></tr>
<tr><td><code id="open_well_response_+3A_s.">S.</code></td>
<td>
<p>numeric; well storativity,  <code class="reqn">[unitless]</code></p>
</td></tr>
<tr><td><code id="open_well_response_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
<tr><td><code id="open_well_response_+3A_rs.">Rs.</code></td>
<td>
<p>numeric; the <em>radius</em> of the open (screened) section</p>
</td></tr>
<tr><td><code id="open_well_response_+3A_rho">rho</code></td>
<td>
<p>numeric; fluid density (assumed if missing)</p>
</td></tr>
<tr><td><code id="open_well_response_+3A_grav">grav</code></td>
<td>
<p>numeric; the local gravitational acceleration (assumed if missing)</p>
</td></tr>
<tr><td><code id="open_well_response_+3A_z">z</code></td>
<td>
<p>numeric; From Rojstaczer (1988): the depth from the water table (assumed if missing and if needed)</p>
</td></tr>
<tr><td><code id="open_well_response_+3A_hw">Hw</code></td>
<td>
<p>numeric; height of water column above confined surface (assumed if missing and if needed)</p>
</td></tr>
<tr><td><code id="open_well_response_+3A_ta">Ta</code></td>
<td>
<p>numeric; thickness of aquifer (assumed if missing and if needed)</p>
</td></tr>
<tr><td><code id="open_well_response_+3A_leak">leak</code></td>
<td>
<p>numeric; specific leakage <code class="reqn">K'/b'</code> <code class="reqn">[1/s]</code></p>
</td></tr>
<tr><td><code id="open_well_response_+3A_freq.units">freq.units</code></td>
<td>
<p>character; setup the units of <code>omega</code></p>
</td></tr>
<tr><td><code id="open_well_response_+3A_model">model</code></td>
<td>
<p>character; use the response model from either
Rojstaczer (1988),
Liu et al (1989),
Cooper et al (1965), 
Hsieh et al (1987), or
Wang et al (2018).</p>
</td></tr>
<tr><td><code id="open_well_response_+3A_as.pressure">as.pressure</code></td>
<td>
<p>logical; should the response be relative to aquifer pressure? (default is aquifer head)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As opposed to <code><a href="#topic+well_response">well_response</a></code>, this
calculates the theoretical, complex
well response for an unsealed (open) well.
</p>
<p>The response depends strongly on the physical properties
given. Default values are assumed where reasonable&ndash;for instance, 
the pore-fluid is assumed to be water&ndash;but considerable care 
should be invested in the choice of
parameters, especially in the case of starting parameters
in an optimization scheme.
</p>
<p>The responses returned here are,
effectively, the amplification of water levels in a well, relative to 
the pressure head in the aquifer; or
</p>
<p style="text-align: center;"><code class="reqn">Z = \frac{z}{h} \equiv \frac{\rho g z}{p}</code>
</p>

<p>If <code>as.pressure=TRUE</code>, then the responses are scaled by
<code>rho*grav</code> so that they represent water levels relative to
aquifer pressure:
</p>
<p style="text-align: center;"><code class="reqn">Z = \frac{z}{p}</code>
</p>

<p>Not all parameters need to be given, but should be.  
For example, if
either <code>rho</code> or <code>grav</code> are not specified, they
are taken from <code><a href="#topic+constants">constants</a></code>.
<em>Parameters which do not end in <code>.</code> do
not need to be specified (they may be excluded); if
they are missing, assumptions may be made and warnings will be thrown.</em>
</p>


<h3>Value</h3>

<p>An object with class <code>'owrsp'</code>
</p>


<h3>Models</h3>



<h4><code>"rojstaczer"</code></h4>

<p>Rojstaczer (1988) is based on measurements of water level
and strain from volumetric or areal strainmeters.
</p>



<h4><code>"cooper"</code>, <code>"hsieh"</code>, and <code>"liu"</code></h4>

<p>Cooper et al (1965), Hsieh et al (1987) and Liu et al (1989) are based
on measurements of water level and 
displacements from seismometers or strainmeters; these 
models are expressed succinctly in Roeloffs (1996).
</p>
<p>The sense of the phase shift 
for the Liu and Rojstaczer models are reversed from their original presentation, 
in order to account for differences in sign convention.
</p>



<h4><code>"wang"</code></h4>

<p>Wang et al (2018) allows for specific leakage &ndash; vertical conductivity across
a semi-permeable aquitard &ndash; but the perfectly confined case (i.e., Hsieh, et al 1987)
is recovered when leakage is zero.
</p>



<h3>Author(s)</h3>

<p>A. J. Barbour and J. Kennel
</p>


<h3>References</h3>

<p>See <code><a href="#topic+kitagawa-package">kitagawa-package</a></code> for references and more background.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+well_response">well_response</a></code> for the sealed-well equivalents, and
<code><a href="#topic+owrsp-methods">owrsp-methods</a></code> for a description of the class <code>'owrsp'</code> and its methods.
</p>
<p>Other WellResponseFunctions: 
<code><a href="#topic+well_response">well_response</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>OWR &lt;- open_well_response(1:10,1,1)
plot(OWR)
OWR &lt;- open_well_response(1/(1:200),1,1,Ta=100,Hw=10,model="liu",freq.units="Hz")
plot(OWR)
</code></pre>

<hr>
<h2 id='owrsp-methods'>Generic methods for objects with class <code>'owrsp'</code>.</h2><span id='topic+owrsp-methods'></span><span id='topic+owrsp'></span><span id='topic+as.data.frame.owrsp'></span><span id='topic+data.frame.owrsp'></span><span id='topic+print.owrsp'></span><span id='topic+summary.owrsp'></span><span id='topic+print.summary.owrsp'></span><span id='topic+lines.owrsp'></span><span id='topic+points.owrsp'></span><span id='topic+plot.owrsp'></span>

<h3>Description</h3>

<p>An object with class 'owrsp' is a list containing the
response information, and the
mechanical, hydraulic, and material properties used to
generate the response for an open well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'owrsp'
as.data.frame(x, ...)

data.frame.owrsp(x, ...)

## S3 method for class 'owrsp'
print(x, n = 3, ...)

## S3 method for class 'owrsp'
summary(object, ...)

## S3 method for class 'summary.owrsp'
print(x, ...)

## S3 method for class 'owrsp'
lines(x, series = c("amp", "phs"), ...)

## S3 method for class 'owrsp'
points(x, series = c("amp", "phs"), pch = "+", ...)

## S3 method for class 'owrsp'
plot(
  x,
  xlims = c(-3, 1),
  ylims = list(amp = NULL, phs = 185 * c(-1, 1)),
  logamp = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="owrsp-methods_+3A_x">x</code></td>
<td>
<p>'owrsp' object</p>
</td></tr>
<tr><td><code id="owrsp-methods_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
<tr><td><code id="owrsp-methods_+3A_n">n</code></td>
<td>
<p>numeric; the number of <code>head</code> and <code>tail</code> to print</p>
</td></tr>
<tr><td><code id="owrsp-methods_+3A_object">object</code></td>
<td>
<p>'owrsp' object</p>
</td></tr>
<tr><td><code id="owrsp-methods_+3A_series">series</code></td>
<td>
<p>character; the series to plot (amplitude or phase)</p>
</td></tr>
<tr><td><code id="owrsp-methods_+3A_pch">pch</code></td>
<td>
<p>point character, as in <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="owrsp-methods_+3A_xlims">xlims</code></td>
<td>
<p>limits for x-axis (applies to both amp and phs frames)</p>
</td></tr>
<tr><td><code id="owrsp-methods_+3A_ylims">ylims</code></td>
<td>
<p>optional list of limits for y-axis (i.e., <code>list(amp=c(..),phs=c(...))</code>)</p>
</td></tr>
<tr><td><code id="owrsp-methods_+3A_logamp">logamp</code></td>
<td>
<p>logical; should the amplitude be in log10 units</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The response information is a
matrix with frequency, complex response
[<code class="reqn">\omega</code>, <code class="reqn">Z_\alpha (\omega)</code>]
where the units of <code class="reqn">\omega</code> will be as they were input.
The amplitude of <code class="reqn">Z</code>
is in meters per strain, 
and the phase is in radians.
</p>


<h3>Author(s)</h3>

<p>A. J. Barbour &lt;andy.barbour@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+open_well_response">open_well_response</a></code>
</p>
<p><code><a href="#topic+kitagawa-package">kitagawa-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>S. &lt;- 1e-5  	# Storativity [nondimensional]
T. &lt;- 1e-4		# Transmissivity [m**2 / s]
frq &lt;- 1/(1:200)
# Defaults to the Rojstaczer formulation
W &lt;- open_well_response(frq, T. = T., S. = S., Rs. = 0.12, freq.units="Hz")
# (warning message about missing 'z')
W &lt;- open_well_response(frq, T. = T., S. = S., Rs. = 0.12, freq.units="Hz", z=1)
str(W)
print(W)
print(summary(W))
plot(rnorm(10), xlim=c(-1,11), ylim=c(-2,2))
lines(W)
lines(W, "phs", col="red")
points(W)
points(W, "phs")
#
Wdf &lt;- as.data.frame(W)
plot(Mod(wellresp) ~ omega, Wdf) # amplitude
plot(Arg(wellresp) ~ omega, Wdf) # phase
plot(W)
# change limits:
plot(W, xlims=c(-4,0), ylims=list(amp=c(-7,-3), phs=185*c(-1,1)))
</code></pre>

<hr>
<h2 id='sensing_volume'>Calculate volume of fluids in the sensing region of the borehole.</h2><span id='topic+sensing_volume'></span>

<h3>Description</h3>

<p>This function calculates the volume of fluid in the screened section, 
namely <strong>Equation 2</strong> in Kitagawa et al (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensing_volume(rad_grout, len_grout, rad_screen, len_screen)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sensing_volume_+3A_rad_grout">rad_grout</code></td>
<td>
<p>radius of the grouting  <code class="reqn">[m]</code></p>
</td></tr>
<tr><td><code id="sensing_volume_+3A_len_grout">len_grout</code></td>
<td>
<p>length of the grouting  <code class="reqn">[m]</code></p>
</td></tr>
<tr><td><code id="sensing_volume_+3A_rad_screen">rad_screen</code></td>
<td>
<p>radius of the screened interval  <code class="reqn">[m]</code></p>
</td></tr>
<tr><td><code id="sensing_volume_+3A_len_screen">len_screen</code></td>
<td>
<p>length of the screened interval  <code class="reqn">[m]</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Although typical scientific boreholes with water-level sensors are 
drilled very deeply, pore-fluids are only allowed to flow through
a relatively short section, known as the &quot;screened&quot; section.  The
calculation assumes two pairs of radii and lengths: one for the cemented (grout)
section, and another for the screened section.
</p>
<p>The volume calculated is
</p>
<p style="text-align: center;"><code class="reqn">
\pi R_C^2 (L_C - L_S) + \pi R_S^2 L_S
</code>
</p>

<p>where 
<code class="reqn">R</code> and <code class="reqn">L</code> denote radius and length respectively, and subscripts
<code class="reqn">C</code> and <code class="reqn">S</code> denote the cemented and screened sections respectively.
</p>
<p>This calculation assumes the measurement is for a sealed well.
</p>


<h3>Value</h3>

<p>scalar, with units of <code class="reqn">[m^3]</code>
</p>


<h3>Author(s)</h3>

<p>A. J. Barbour &lt;andy.barbour@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+well_response">well_response</a></code>
</p>
<p>Other utilities: 
<code><a href="#topic+omega_norm">omega_norm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### dummy example
sensing_volume(1, 1, 1, 1)
#
#### a more physically realistic calculation:
# Physical params applicable for B084 borehole
# (see: http://pbo.unavco.org/station/overview/B084/ for details)
#
Rc &lt;- 0.0508   # m, radius of water-sensing (2in)
Lc &lt;- 146.9    # m, length of grouted region (482ft)
Rs &lt;- 3*Rc     # m, radius of screened region (6in)
Ls &lt;- 9.14     # m, length of screened region (30ft)
#
# calculate the sensing volume for the given well parameters
sensing_volume(Rc, Lc, Rs, Ls) # m**3, ~= 1.8
</code></pre>

<hr>
<h2 id='well_response'>Spectral response for a sealed well</h2><span id='topic+well_response'></span><span id='topic+well_response.default'></span>

<h3>Description</h3>

<p>This is the primary function to calculate the response
for a sealed well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>well_response(omega, T., S., Vw., Rs., Ku., B., ...)

## Default S3 method:
well_response(
  omega,
  T.,
  S.,
  Vw.,
  Rs.,
  Ku.,
  B.,
  Avs,
  Aw,
  rho,
  Kf,
  grav,
  freq.units = c("rad_per_sec", "Hz"),
  as.pressure = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="well_response_+3A_omega">omega</code></td>
<td>
<p>frequency, (see <code>freq.units</code>)</p>
</td></tr>
<tr><td><code id="well_response_+3A_t.">T.</code></td>
<td>
<p>effective aquifer transmissivity <code class="reqn">[m^2/s]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_s.">S.</code></td>
<td>
<p>well storativity,  <code class="reqn">[unitless]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_vw.">Vw.</code></td>
<td>
<p>well volume,     <code class="reqn">[m^3]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_rs.">Rs.</code></td>
<td>
<p>radius of screened portion,  <code class="reqn">[m]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_ku.">Ku.</code></td>
<td>
<p>undrained bulk modulus,  <code class="reqn">[Pa]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_b.">B.</code></td>
<td>
<p>Skempton's coefficient,  <code class="reqn">[unitless, bounded]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
<tr><td><code id="well_response_+3A_avs">Avs</code></td>
<td>
<p>amplification factor for volumetric strain <code class="reqn">E_{kk,obs}/E_{kk}</code>,  <code class="reqn">[]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_aw">Aw</code></td>
<td>
<p>amplification factor of well volume change for <code class="reqn">E_{kk}</code>,  <code class="reqn">[]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_rho">rho</code></td>
<td>
<p>fluid density <code class="reqn">[kg/m^3]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_kf">Kf</code></td>
<td>
<p>bulk modulus of fluid,  <code class="reqn">[Pa]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_grav">grav</code></td>
<td>
<p>local gravitational acceleration <code class="reqn">[m/s^2]</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_freq.units">freq.units</code></td>
<td>
<p>set the units of <code>omega</code></p>
</td></tr>
<tr><td><code id="well_response_+3A_as.pressure">as.pressure</code></td>
<td>
<p>logical; should the response for water pressure? (default is water height)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The response depends strongly on the physical properties
given. Default values are assumed where reasonable&ndash;for instance, 
the pore-fluid is assumed to be water&ndash;but considerable care 
should be invested in the choice of
parameters, unless the function is used in an optimization scheme.
</p>
<p>Assumed values are:
</p>

<table>
<tr>
 <td style="text-align: right;">
<code>Avs</code>  </td><td style="text-align: left;"> 1 </td><td style="text-align: right;"> </td><td style="text-align: left;"> amplification factor for volumetric strain</td>
</tr>
<tr>
 <td style="text-align: right;">
<code>Aw</code>   </td><td style="text-align: left;"> 1 </td><td style="text-align: right;"> </td><td style="text-align: left;"> amplification factor for water well</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>The responses returned here are,
effectively, the amplification of water levels in a well, relative to 
the aquifer strain; or
</p>
<p style="text-align: center;"><code class="reqn">Z = \frac{z}{\epsilon} \equiv \frac{p}{\rho g \epsilon}</code>
</p>

<p>If <code>as.pressure=TRUE</code>, then the responses are scaled by
<code>rho*grav</code> so that they represent water pressure relative to
aquifer strain:
</p>
<p style="text-align: center;"><code class="reqn">Z = \frac{p}{\epsilon}</code>
</p>

<p>Not all parameters need to be given, but should be.  
For example, if
either <code>rho</code> or <code>grav</code> are not specified, they
are taken from <code><a href="#topic+constants">constants</a></code>.
<em>Parameters which do not end in <code>.</code> do
not need to be specified (they may be excluded); if
they are missing, warnings will be thrown.</em>
</p>


<h3>Value</h3>

<p>An object with class <code>'wrsp'</code>
</p>


<h3>Author(s)</h3>

<p>A. J. Barbour
</p>


<h3>References</h3>

<p>See <code><a href="#topic+kitagawa-package">kitagawa-package</a></code> for references and more background.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+open_well_response">open_well_response</a></code> for the open-well equivalents
<code><a href="#topic+wrsp-methods">wrsp-methods</a></code> for a description of the class <code>'wrsp'</code> and its methods,
<code><a href="#topic+sensing_volume">sensing_volume</a></code> to easily estimate the volume <code>Vw.</code>, and
<code><a href="#topic+kitagawa-package">kitagawa-package</a></code> for references and more background.
</p>
<p>Other WellResponseFunctions: 
<code><a href="#topic+open_well_response">open_well_response</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### dummy example
well_response(1:10, T.=1, S.=1, Vw.=1, Rs.=1, Ku.=1, B.=1)

#### a more physically realistic calculation:
# Physical params applicable for B084 borehole
# (see: http://pbo.unavco.org/station/overview/B084/ for details)
#
Rc &lt;- 0.0508   # m, radius of water-sensing (2in)
Lc &lt;- 146.9    # m, length of grouted region (482ft)
Rs &lt;- 3*Rc     # m, radius of screened region (6in)
Ls &lt;- 9.14     # m, length of screened region (30ft)
#
# calculate the sensing volume for the given well parameters
Volw &lt;- sensing_volume(Rc, Lc, Rs, Ls) # m**3, ~= 1.8
#
Frqs &lt;- 10**seq.int(from=-4,to=0,by=0.1) # log10-space
head(Rsp &lt;- well_response(omega=Frqs, T.=1e-6, S.=1e-5, 
Vw.=Volw, Rs.=Rs, Ku.=40e9, B.=0.2, freq.units="Hz"))

# Access plot.wrsp:
plot(Rsp)

</code></pre>

<hr>
<h2 id='wrsp-methods'>Generic methods for objects with class <code>'wrsp'</code>.</h2><span id='topic+wrsp-methods'></span><span id='topic+wrsp'></span><span id='topic+as.data.frame.wrsp'></span><span id='topic+data.frame.wrsp'></span><span id='topic+print.wrsp'></span><span id='topic+summary.wrsp'></span><span id='topic+print.summary.wrsp'></span><span id='topic+lines.wrsp'></span><span id='topic+points.wrsp'></span><span id='topic+plot.wrsp'></span><span id='topic+kitplot'></span><span id='topic+kitplot.wrsp'></span>

<h3>Description</h3>

<p>An object with class 'wrsp' is a list containing the
response information, and the
mechanical, hydraulic, and material properties used to
generate the response for a sealed well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wrsp'
as.data.frame(x, ...)

data.frame.wrsp(x, ...)

## S3 method for class 'wrsp'
print(x, n = 3, ...)

## S3 method for class 'wrsp'
summary(object, ...)

## S3 method for class 'summary.wrsp'
print(x, ...)

## S3 method for class 'wrsp'
lines(x, series = c("amp", "phs"), ...)

## S3 method for class 'wrsp'
points(x, series = c("amp", "phs"), pch = "+", ...)

## S3 method for class 'wrsp'
plot(
  x,
  xlims = c(-3, 1),
  ylims = list(amp = NULL, phs = 185 * c(-1, 1)),
  logamp = TRUE,
  ...
)

kitplot(x, ...)

## S3 method for class 'wrsp'
kitplot(
  x,
  xlims = c(-3, 1),
  ylims = list(amp = NULL, phs = 185 * c(-1, 1)),
  logamp = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wrsp-methods_+3A_x">x</code></td>
<td>
<p>'wrsp' object</p>
</td></tr>
<tr><td><code id="wrsp-methods_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
<tr><td><code id="wrsp-methods_+3A_n">n</code></td>
<td>
<p>numeric; the number of <code>head</code> and <code>tail</code> to print</p>
</td></tr>
<tr><td><code id="wrsp-methods_+3A_object">object</code></td>
<td>
<p>'wrsp' object</p>
</td></tr>
<tr><td><code id="wrsp-methods_+3A_series">series</code></td>
<td>
<p>character; the series to plot (amplitude or phase)</p>
</td></tr>
<tr><td><code id="wrsp-methods_+3A_pch">pch</code></td>
<td>
<p>point character, as in <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="wrsp-methods_+3A_xlims">xlims</code></td>
<td>
<p>limits for x-axis (applies to both amp and phs frames)</p>
</td></tr>
<tr><td><code id="wrsp-methods_+3A_ylims">ylims</code></td>
<td>
<p>optional list of limits for y-axis (i.e., <code>list(amp=c(..),phs=c(...))</code>)</p>
</td></tr>
<tr><td><code id="wrsp-methods_+3A_logamp">logamp</code></td>
<td>
<p>logical; should the amplitude be in log10 units</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The response information is a
matrix with frequency, complex response
[<code class="reqn">\omega</code>, <code class="reqn">Z_\alpha (\omega)</code>]
where the units of <code class="reqn">\omega</code> will be as they were input.
The amplitude of <code class="reqn">Z</code>
is in meters per strain, 
and the phase is in radians.
</p>
<p><code><a href="#topic+kitplot">kitplot</a></code> was previously a standalone function, but
is now simply a reference to <code><a href="#topic+plot.wrsp">plot.wrsp</a></code>.
</p>


<h3>Author(s)</h3>

<p>A. J. Barbour &lt;andy.barbour@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+well_response">well_response</a></code>
</p>
<p><code><a href="#topic+kitagawa-package">kitagawa-package</a></code>
</p>
<p>Other PlotUtilities: 
<code><a href="#topic+logticks">logticks</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>W &lt;- well_response(1:10, T.=1, S.=1, Vw.=1, Rs.=1, Ku.=1, B.=1)
str(W)
print(W)
print(summary(W))
#
# Plot the response
plot(rnorm(10), xlim=c(-1,11), ylim=c(-2,2))
lines(W)
lines(W, "phs", col="red")
points(W)
points(W, "phs")
#
Wdf &lt;- as.data.frame(W)
plot(Mod(wellresp) ~ omega, Wdf) # amplitude
plot(Arg(wellresp) ~ omega, Wdf) # phase
#
# or use the builtin method plot.wrsp
plot(W)
# change limits:
plot(W, xlims=c(-1,1), ylims=list(amp=c(5,8), phs=185*c(-1,1)))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
