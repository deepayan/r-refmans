<!DOCTYPE html><html lang="en"><head><title>Help for package geeCRT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {geeCRT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#geeCRT'><p>geeCRT: a package for implementing the bias-corrected generalized estimating equations in analyzing cluster randomized trials</p></a></li>
<li><a href='#cpgeeSWD'><p>Cluster-Period GEE for Estimating the Mean and Correlation Parameters in Cross-Sectional SW-CRTs</p></a></li>
<li><a href='#geemaee'><p>GEE and Matrix-adjusted Estimating Equations (MAEE) for Estimating the Marginal Mean and Correlation Parameters in CRTs</p></a></li>
<li><a href='#print.cpgeeSWD'><p>The print format for cpgeeSWD output</p></a></li>
<li><a href='#print.geemaee'><p>The print format for geemaee output</p></a></li>
<li><a href='#sampleSWCRTLarge'><p>simulated large SW-CRT data</p></a></li>
<li><a href='#sampleSWCRTSmall'><p>simulated small SW-CRT data</p></a></li>
<li><a href='#simbinCLF'><p>Generating Correlated Binary Data using the Conditional Linear Family Method.</p></a></li>
<li><a href='#simbinPROBIT'><p>Generating Correlated Binary Data using the Multivariate Probit Method.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bias-Corrected GEE for Cluster Randomized Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-18</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hengshi Yu &lt;hengshi@umich.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Population-averaged models have been increasingly used in the design and analysis of 
             cluster randomized trials (CRTs). To facilitate the applications of population-averaged 
             models in CRTs, the package implements the generalized estimating equations (GEE) and 
             matrix-adjusted estimating equations (MAEE) approaches to jointly estimate the marginal 
             mean models correlation models both for general CRTs and stepped wedge CRTs. Despite the 
             general GEE/MAEE approach, the package also implements a fast cluster-period GEE method by 
             Li et al. (2022) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxaa056">doi:10.1093/biostatistics/kxaa056</a>&gt;
             specifically for stepped wedge CRTs with large and variable cluster-period sizes and gives 
             a simple and efficient estimating equations approach based on the cluster-period means to 
             estimate the intervention effects as well as correlation parameters. In addition, the package 
             also provides functions for generating correlated binary data with specific mean vector and 
             correlation matrix based on the multivariate probit method in Emrich and Piedmonte (1991) &lt;<a href="https://doi.org/10.1080%2F00031305.1991.10475828">doi:10.1080/00031305.1991.10475828</a>&gt; or 
             the conditional linear family method in Qaqish (2003) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2F90.2.455">doi:10.1093/biomet/90.2.455</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, rootSolve, mvtnorm</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-19 06:28:37 UTC; hengshiyu</td>
</tr>
<tr>
<td>Author:</td>
<td>Hengshi Yu [aut, cre],
  Fan Li [aut],
  Paul Rathouz [aut],
  Elizabeth L. Turner [aut],
  John Preisser [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-19 06:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='geeCRT'>geeCRT: a package for implementing the bias-corrected generalized estimating equations in analyzing cluster randomized trials</h2><span id='topic+geeCRT'></span><span id='topic+geeCRT-package'></span>

<h3>Description</h3>

<p>geeCRT: a package for implementing the bias-corrected generalized estimating equations in analyzing cluster randomized trials
</p>


<h3>geeCRT functions</h3>

<p>The simbinPROBIT function performs correlated binary outcome data simulation using the multivariate probit method
The simbinCLF function performs correlated binary outcome data simulation using the conditional linear family method
The cpgeeSWD function performs cluster-period generalized estimating equations for estimating the marginal mean and correlation parameters in cross-sectional stepped wedge cluster randomized trials
The geemaee function performs matrix-adjusted generalized estimating equations on estimating the marginal mean and correlation parameters in cluster randomized trials
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Hengshi Yu <a href="mailto:hengshi@umich.edu">hengshi@umich.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Fan Li <a href="mailto:fan.f.li@yale.edu">fan.f.li@yale.edu</a>
</p>
</li>
<li><p> Paul Rathouz <a href="mailto:paul.rathouz@austin.utexas.edu">paul.rathouz@austin.utexas.edu</a>
</p>
</li>
<li><p> Elizabeth L. Turner <a href="mailto:liz.turner@duke.edu">liz.turner@duke.edu</a>
</p>
</li>
<li><p> John Preisser <a href="mailto:jpreisse@bios.unc.edu">jpreisse@bios.unc.edu</a>
</p>
</li></ul>


<hr>
<h2 id='cpgeeSWD'>Cluster-Period GEE for Estimating the Mean and Correlation Parameters in Cross-Sectional SW-CRTs</h2><span id='topic+cpgeeSWD'></span>

<h3>Description</h3>

<p>cpgeeSWD implements the cluster-period GEE developed for cross-sectional stepped wedge cluster randomized trials (SW-CRTs). It provides valid estimation and inference for the
treatment effect and intraclass correlation parameters within the GEE framework, and is computationally efficient for SW-CRTs with large cluster sizes. The program currently only allows for
a marginal mean model with discrete period effects and the intervention indicator without additional covariates. The program offers bias-corrected ICC estimates
as well as bias-corrected sandwich variances for both the treatment effect parameter and the ICC parameters. The technical details of the cluster-period GEE approach are provided in Li et al. (2020+).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpgeeSWD(
  y,
  X,
  id,
  m,
  corstr,
  family = "binomial",
  maxiter = 500,
  epsilon = 0.001,
  printrange = TRUE,
  alpadj = FALSE,
  rho.init = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpgeeSWD_+3A_y">y</code></td>
<td>
<p>a vector specifying the cluster-period means (proportions)</p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_x">X</code></td>
<td>
<p>design matrix for the marginal mean model, including period indicator and intervention indicator</p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_id">id</code></td>
<td>
<p>a vector specifying cluster identifier</p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_m">m</code></td>
<td>
<p>a vector of the cluster-period sizes</p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_corstr">corstr</code></td>
<td>
<p>correlation structure specified for the individual-level outcomes, could be <code>'exchangeable'</code>, <code>'nest_exch'</code> or <code>'exp_decay'</code></p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_family">family</code></td>
<td>
<p>See corresponding documentation to <code>glm</code>. The current version only supports <code>family = 'binomial'</code></p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations for Fisher scoring updates</p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_epsilon">epsilon</code></td>
<td>
<p>tolerance for convergence</p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_printrange">printrange</code></td>
<td>
<p>print details of range violations when <code>family = 'binomial'</code>. The default is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_alpadj">alpadj</code></td>
<td>
<p>if <code>TRUE</code>, performs bias adjustment for the alpha estimating equations. The default is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="cpgeeSWD_+3A_rho.init">rho.init</code></td>
<td>
<p>user-specified initial value for the decay parameter when <code>corstr = 'exp_decay'</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>outbeta</code> estimates of marginal mean model parameters and standard errors with different finite-sample bias corrections.
The current version supports model-based standard error (MB), the sandwich standard error (BC0) extending Zhao and Prentice (2001),
the sandwich standard errors (BC1) extending Kauermann and Carroll (2001), the sandwich standard errors (BC2) extending Mancl and DeRouen (2001),
and the sandwich standard errors (BC3) extending the Fay and Graubard (2001). A summary of
these bias-corrections can also be found in Lu et al. (2007), and Li et al. (2018).
</p>
<p><code>outalpha</code> estimates of correlation parameters and standard errors with different finite-sample bias corrections.
The current version supports the sandwich standard error (BC0) extending Zhao and Prentice (2001),
the sandwich standard errors (BC1) extending Kauermann and Carroll (2001), the sandwich standard errors (BC2) extending
Mancl and DeRouen (2001), and the sandwich standard errors (BC3) extending the Fay and Graubard (2001). A summary of
these bias-corrections can also be found in Preisser et al. (2008).
</p>
<p><code>beta</code> a vector of estimates for marginal mean model parameters
</p>
<p><code>alpha</code> a vector of estimates of correlation parameters
</p>
<p><code>MB</code> model-based covariance estimate for the marginal mean model parameters
</p>
<p><code>BC0</code> robust sandwich covariance estimate of the marginal mean model and correlation parameters
</p>
<p><code>BC1</code> robust sandwich covariance estimate of the marginal mean model and correlation parameters with the
Kauermann and Carroll (2001) correction
</p>
<p><code>BC2</code> robust sandwich covariance estimate of the marginal mean model and correlation parameters with the
Mancl and DeRouen (2001) correction
</p>
<p><code>BC3</code> robust sandwich covariance estimate of the marginal mean model and correlation parameters with the
Fay and Graubard (2001) correction
</p>
<p><code>niter</code> number of iterations used in the Fisher scoring updates for model fitting
</p>


<h3>Author(s)</h3>

<p>Hengshi Yu &lt;hengshi@umich.edu&gt;, Fan Li &lt;fan.f.li@yale.edu&gt;, Paul Rathouz &lt;paul.rathouz@austin.utexas.edu&gt;, Elizabeth L. Turner &lt;liz.turner@duke.edu&gt;, John Preisser &lt;jpreisse@bios.unc.edu&gt;
</p>


<h3>References</h3>

<p>Zhao, L. P., Prentice, R. L. (1990). Correlated binary regression using a quadratic exponential model. Biometrika, 77(3), 642-648.
</p>
<p>Mancl, L. A., DeRouen, T. A. (2001). A covariance estimator for GEE with improved small sample properties. Biometrics, 57(1), 126-134.
</p>
<p>Kauermann, G., Carroll, R. J. (2001). A note on the efficiency of sandwich covariance matrix estimation. Journal of the American Statistical Association, 96(456), 1387-1396.
</p>
<p>Fay, M. P., Graubard, B. I. (2001). Small sample adjustments for Wald type tests using sandwich estimators. Biometrics, 57(4), 1198-1206.
</p>
<p>Lu, B., Preisser, J. S., Qaqish, B. F., Suchindran, C., Bangdiwala, S. I., Wolfson, M. (2007). A comparison of two bias corrected covariance estimators for generalized estimating equations. Biometrics, 63(3), 935-941.
</p>
<p>Preisser, J. S., Lu, B., Qaqish, B. F. (2008). Finite sample adjustments in estimating equations and covariance estimators for intracluster correlations. Statistics in Medicine, 27(27), 5764-5785.
</p>
<p>Li, F., Turner, E. L., Preisser, J. S. (2018). Sample size determination for GEE analyses of stepped wedge cluster randomized trials. Biometrics, 74(4), 1450-1458.
</p>
<p>Li, F. (2020). Design and analysis considerations for cohort stepped wedge cluster randomized trials with a decay correlation structure. Statistics in Medicine, 39(4), 438-455.
</p>
<p>Li, F., Yu, H., Rathouz, P., Turner, E. L., Preisser, J. S. (2021). Marginal modeling of cluster-period means and intraclass correlations in stepped wedge designs with binary outcomes. Biostatistics, kxaa056.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulated SW-CRT example with binary outcome

########################################################################
### Example 1): simulated SW-CRT with smaller cluster-period sizes (5~10)
########################################################################

sampleSWCRT &lt;- sampleSWCRTSmall

#############################################################
### cluster-period id, period, outcome, and design matrix ###
#############################################################

### id, period, outcome
id &lt;- sampleSWCRT$id
period &lt;- sampleSWCRT$period
y &lt;- sampleSWCRT$y_bin
X &lt;- as.matrix(sampleSWCRT[, c("period1", "period2", "period3", "period4", "treatment")])

m &lt;- as.matrix(table(id, period))
n &lt;- dim(m)[1]
t &lt;- dim(m)[2]
clp_mu &lt;- tapply(y, list(id, period), FUN = mean)
y_cp &lt;- c(t(clp_mu))

### design matrix for correlation parameters
trt &lt;- tapply(X[, t + 1], list(id, period), FUN = mean)
trt &lt;- c(t(trt))

time &lt;- tapply(period, list(id, period), FUN = mean)
time &lt;- c(t(time))
X_cp &lt;- matrix(0, n * t, t)

s &lt;- 1
for (i in 1:n) {
    for (j in 1:t) {
        X_cp[s, time[s]] &lt;- 1
        s &lt;- s + 1
    }
}
X_cp &lt;- cbind(X_cp, trt)
id_cp &lt;- rep(1:n, each = t)
m_cp &lt;- c(t(m))

#####################################################
### cluster-period matrix-adjusted estimating equations (MAEE)
### with exchangeable, nested exchangeable and exponential decay correlation structures ###
#####################################################

# exchangeable
est_maee_exc &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "exchangeable",
    alpadj = TRUE
)
print(est_maee_exc)

# nested exchangeable
est_maee_nex &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "nest_exch",
    alpadj = TRUE
)
print(est_maee_nex)

# exponential decay
est_maee_ed &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "exp_decay",
    alpadj = TRUE
)
print(est_maee_ed)

#####################################################
### cluster-period GEE
### with exchangeable, nested exchangeable and exponential decay correlation structures ###
#####################################################

# exchangeable
est_uee_exc &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "exchangeable",
    alpadj = FALSE
)
print(est_uee_exc)

# nested exchangeable
est_uee_nex &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "nest_exch",
    alpadj = FALSE
)
print(est_uee_nex)

# exponential decay
est_uee_ed &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "exp_decay",
    alpadj = FALSE
)
print(est_uee_ed)

########################################################################
### Example 2): simulated SW-CRT with larger cluster-period sizes (20~30)
########################################################################

sampleSWCRT &lt;- sampleSWCRTLarge

#############################################################
### cluster-period id, period, outcome, and design matrix ###
#############################################################

### id, period, outcome
id &lt;- sampleSWCRT$id
period &lt;- sampleSWCRT$period
y &lt;- sampleSWCRT$y_bin
X &lt;- as.matrix(sampleSWCRT[, c("period1", "period2", "period3", "period4", "period5", "treatment")])

m &lt;- as.matrix(table(id, period))
n &lt;- dim(m)[1]
t &lt;- dim(m)[2]
clp_mu &lt;- tapply(y, list(id, period), FUN = mean)
y_cp &lt;- c(t(clp_mu))

### design matrix for correlation parameters
trt &lt;- tapply(X[, t + 1], list(id, period), FUN = mean)
trt &lt;- c(t(trt))

time &lt;- tapply(period, list(id, period), FUN = mean)
time &lt;- c(t(time))
X_cp &lt;- matrix(0, n * t, t)

s &lt;- 1
for (i in 1:n) {
    for (j in 1:t) {
        X_cp[s, time[s]] &lt;- 1
        s &lt;- s + 1
    }
}
X_cp &lt;- cbind(X_cp, trt)
id_cp &lt;- rep(1:n, each = t)
m_cp &lt;- c(t(m))

#####################################################
### cluster-period matrix-adjusted estimating equations (MAEE)
### with exchangeable, nested exchangeable and exponential decay correlation structures ###
#####################################################

# exchangeable
est_maee_exc &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "exchangeable",
    alpadj = TRUE
)
print(est_maee_exc)

# nested exchangeable
est_maee_nex &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "nest_exch",
    alpadj = TRUE
)
print(est_maee_nex)

# exponential decay
est_maee_ed &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "exp_decay",
    alpadj = TRUE
)
print(est_maee_ed)

#####################################################
### cluster-period GEE
### with exchangeable, nested exchangeable and exponential decay correlation structures ###
#####################################################

# exchangeable
est_uee_exc &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "exchangeable",
    alpadj = FALSE
)
print(est_uee_exc)

# nested exchangeable
est_uee_nex &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "nest_exch",
    alpadj = FALSE
)
print(est_uee_nex)

# exponential decay
est_uee_ed &lt;- cpgeeSWD(
    y = y_cp, X = X_cp, id = id_cp,
    m = m_cp, corstr = "exp_decay",
    alpadj = FALSE
)
print(est_uee_ed)

</code></pre>

<hr>
<h2 id='geemaee'>GEE and Matrix-adjusted Estimating Equations (MAEE) for Estimating the Marginal Mean and Correlation Parameters in CRTs</h2><span id='topic+geemaee'></span>

<h3>Description</h3>

<p>geemaee implements the GEE and matrix-adjusted estimating equations (MAEE) for analyzing cluster randomized trials (CRTs). It supports estimation and inference for the
marginal mean and intraclass correlation parameters within the population-averaged modeling framework. With suitable choice of the design matrices, the function can be used to analyze
parallel, crossover and stepped wedge cluster randomized trials. The program also offers bias-corrected intraclass correlation estimates, as well as bias-corrected sandwich variances for both the marginal mean and correlation parameters.
The technical details of the GEE and MAEE approach are provided in Preisser (2008) and Li et al. (2018, 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geemaee(
  y,
  X,
  id,
  Z,
  family,
  link = NULL,
  maxiter = 500,
  epsilon = 0.001,
  printrange = TRUE,
  alpadj = FALSE,
  shrink = "ALPHA",
  makevone = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geemaee_+3A_y">y</code></td>
<td>
<p>a vector specifying the outcome variable across all clusters</p>
</td></tr>
<tr><td><code id="geemaee_+3A_x">X</code></td>
<td>
<p>design matrix for the marginal mean model, including the intercept</p>
</td></tr>
<tr><td><code id="geemaee_+3A_id">id</code></td>
<td>
<p>a vector specifying cluster identifier</p>
</td></tr>
<tr><td><code id="geemaee_+3A_z">Z</code></td>
<td>
<p>design matrix for the correlation model, should be all pairs j &lt; k for each cluster</p>
</td></tr>
<tr><td><code id="geemaee_+3A_family">family</code></td>
<td>
<p>See corresponding documentation to <code>glm</code>. The current version supports <code>'continuous'</code>, <code>'binomial'</code>, <code>'poisson'</code> and <code>'quasipoisson'</code></p>
</td></tr>
<tr><td><code id="geemaee_+3A_link">link</code></td>
<td>
<p>a specification for the model link function name</p>
</td></tr>
<tr><td><code id="geemaee_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations for Fisher scoring updates</p>
</td></tr>
<tr><td><code id="geemaee_+3A_epsilon">epsilon</code></td>
<td>
<p>tolerance for convergence. The default is 0.001</p>
</td></tr>
<tr><td><code id="geemaee_+3A_printrange">printrange</code></td>
<td>
<p>print details of range violations. The default is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="geemaee_+3A_alpadj">alpadj</code></td>
<td>
<p>if <code>TRUE</code>, performs bias adjustment for the correlation estimating equations. The default is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="geemaee_+3A_shrink">shrink</code></td>
<td>
<p>method to tune step sizes in case of non-convergence including <code>'THETA'</code> or <code>'ALPHA'</code>. The default is <code>'ALPHA'</code></p>
</td></tr>
<tr><td><code id="geemaee_+3A_makevone">makevone</code></td>
<td>
<p>if <code>TRUE</code>, it assumes unit variances for the correlation parameters in the correlation estimating equations. The default is <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>outbeta</code> estimates of marginal mean model parameters and standard errors with different finite-sample bias corrections.
The current version supports model-based standard error (MB), the sandwich standard error (BC0) extending Liang and Zeger (1986),
the sandwich standard errors (BC1) extending Kauermann and Carroll (2001), the sandwich standard errors (BC2) extending Mancl and DeRouen (2001),
and the sandwich standard errors (BC3) extending the Fay and Graubard (2001). A summary of
these bias-corrections can also be found in Lu et al. (2007), and Li et al. (2018).
</p>
<p><code>outalpha</code> estimates of intraclass correlation parameters and standard errors with different finite-sample bias corrections.
The current version supports the sandwich standard error (BC0) extending Zhao and Prentice (2001),
the sandwich standard errors (BC1) extending Kauermann and Carroll (2001), the sandwich standard errors (BC2) extending
Mancl and DeRouen (2001), and the sandwich standard errors (BC3) extending the Fay and Graubard (2001). A summary of
these bias-corrections can also be found in Preisser et al. (2008).
</p>
<p><code>beta</code> a vector of estimates for marginal mean model parameters
</p>
<p><code>alpha</code> a vector of estimates of correlation parameters
</p>
<p><code>MB</code> model-based covariance estimate for the marginal mean model parameters
</p>
<p><code>BC0</code> robust sandwich covariance estimate of the marginal mean model and correlation parameters
</p>
<p><code>BC1</code> robust sandwich covariance estimate of the marginal mean model and correlation parameters with the
Kauermann and Carroll (2001) correction
</p>
<p><code>BC2</code> robust sandwich covariance estimate of the marginal mean model and correlation parameters with the
Mancl and DeRouen (2001) correction
</p>
<p><code>BC3</code> robust sandwich covariance estimate of the marginal mean model and correlation parameters with the
Fay and Graubard (2001) correction
</p>
<p><code>niter</code> number of iterations used in the Fisher scoring updates for model fitting
</p>


<h3>Author(s)</h3>

<p>Hengshi Yu &lt;hengshi@umich.edu&gt;, Fan Li &lt;fan.f.li@yale.edu&gt;, Paul Rathouz &lt;paul.rathouz@austin.utexas.edu&gt;, Elizabeth L. Turner &lt;liz.turner@duke.edu&gt;, John Preisser &lt;jpreisse@bios.unc.edu&gt;
</p>


<h3>References</h3>

<p>Liang, K. Y., Zeger, S. L. (1986). Longitudinal data analysis using generalized linear models. Biometrika, 73(1), 13-22.
</p>
<p>Prentice, R. L. (1988). Correlated binary regression with covariates specific to each binary observation. Biometrics, 1033-1048.
</p>
<p>Zhao, L. P., Prentice, R. L. (1990). Correlated binary regression using a quadratic exponential model. Biometrika, 77(3), 642-648.
</p>
<p>Prentice, R. L., Zhao, L. P. (1991). Estimating equations for parameters in means and covariances of multivariate discrete and continuous responses. Biometrics, 825-839.
</p>
<p>Sharples, K., Breslow, N. (1992). Regression analysis of correlated binary data: some small sample results for the estimating equation approach. Journal of Statistical Computation and Simulation, 42(1-2), 1-20.
</p>
<p>Mancl, L. A., DeRouen, T. A. (2001). A covariance estimator for GEE with improved small sample properties. Biometrics, 57(1), 126-134.
</p>
<p>Kauermann, G., Carroll, R. J. (2001). A note on the efficiency of sandwich covariance matrix estimation. Journal of the American Statistical Association, 96(456), 1387-1396.
</p>
<p>Fay, M. P., Graubard, B. I. (2001). Small sample adjustments for Wald type tests using sandwich estimators. Biometrics, 57(4), 1198-1206.
</p>
<p>Lu, B., Preisser, J. S., Qaqish, B. F., Suchindran, C., Bangdiwala, S. I., Wolfson, M. (2007). A comparison of two bias corrected covariance estimators for generalized estimating equations. Biometrics, 63(3), 935-941.
</p>
<p>Preisser, J. S., Lu, B., Qaqish, B. F. (2008). Finite sample adjustments in estimating equations and covariance estimators for intracluster correlations. Statistics in Medicine, 27(27), 5764-5785.
</p>
<p>Li, F., Turner, E. L., Preisser, J. S. (2018). Sample size determination for GEE analyses of stepped wedge cluster randomized trials. Biometrics, 74(4), 1450-1458.
</p>
<p>Li, F., Forbes, A. B., Turner, E. L., Preisser, J. S. (2019). Power and sample size requirements for GEE analyses of cluster randomized crossover trials. Statistics in Medicine, 38(4), 636-649.
</p>
<p>Li, F. (2020). Design and analysis considerations for cohort stepped wedge cluster randomized trials with a decay correlation structure. Statistics in Medicine, 39(4), 438-455.
</p>
<p>Li, F., Yu, H., Rathouz, P. J., Turner, E. L., &amp; Preisser, J. S. (2022). Marginal modeling of cluster-period means and intraclass correlations in stepped wedge designs with binary outcomes. Biostatistics, 23(3), 772-788.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulated SW-CRT examples

#################################################################
### function to create the design matrix for correlation parameters
### under the nested exchangeable correlation structure
#################################################################
createzCrossSec &lt;- function(m) {
  Z &lt;- NULL
  n &lt;- dim(m)[1]
  for (i in 1:n) {
    alpha_0 &lt;- 1
    alpha_1 &lt;- 2
    n_i &lt;- c(m[i, ])
    n_length &lt;- length(n_i)
    POS &lt;- matrix(alpha_1, sum(n_i), sum(n_i))
    loc1 &lt;- 0
    loc2 &lt;- 0
    for (s in 1:n_length) {
      n_t &lt;- n_i[s]
      loc1 &lt;- loc2 + 1
      loc2 &lt;- loc1 + n_t - 1
      for (k in loc1:loc2) {
        for (j in loc1:loc2) {
          if (k != j) {
            POS[k, j] &lt;- alpha_0
          } else {
            POS[k, j] &lt;- 0
          }
        }
      }
    }
    zrow &lt;- diag(2)
    z_c &lt;- NULL
    for (j in 1:(sum(n_i) - 1)) {
      for (k in (j + 1):sum(n_i)) {
        z_c &lt;- rbind(z_c, zrow[POS[j, k], ])
      }
    }
    Z &lt;- rbind(Z, z_c)
  }
  return(Z)
}

########################################################################
### Example 1): simulated SW-CRT with smaller cluster-period sizes (5~10)
########################################################################

sampleSWCRT &lt;- sampleSWCRTSmall

###############################################################
### Individual-level id, period, outcome, and design matrix ###
###############################################################

id &lt;- sampleSWCRT$id
period &lt;- sampleSWCRT$period
X &lt;- as.matrix(sampleSWCRT[, c("period1", "period2", "period3", "period4", "treatment")])

m &lt;- as.matrix(table(id, period))
n &lt;- dim(m)[1]
t &lt;- dim(m)[2]
### design matrix for correlation parameters
Z &lt;- createzCrossSec(m)

################################################################
### (1) Matrix-adjusted estimating equations and GEE
### on continous outcome with nested exchangeable correlation structure
################################################################

est_maee_ind_con &lt;- geemaee(
  y = sampleSWCRT$y_con, X = X, id = id,
  Z = Z, family = "continuous",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = TRUE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_maee_ind_con)


est_uee_ind_con &lt;- geemaee(
  y = sampleSWCRT$y_con, X = X, id = id,
  Z = Z, family = "continuous",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = FALSE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_uee_ind_con)


###############################################################
### (2) Matrix-adjusted estimating equations and GEE
### on binary outcome with nested exchangeable correlation structure
###############################################################

est_maee_ind_bin &lt;- geemaee(
  y = sampleSWCRT$y_bin, X = X, id = id,
  Z = Z, family = "binomial",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = TRUE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_maee_ind_bin)


### GEE
est_uee_ind_bin &lt;- geemaee(
  y = sampleSWCRT$y_bin, X = X, id = id,
  Z = Z, family = "binomial",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = FALSE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_uee_ind_bin)

###############################################################
### (3) Matrix-adjusted estimating equations and GEE
### on count outcome with nested exchangeable correlation structure
### using Poisson distribution
###############################################################
### MAEE
est_maee_ind_cnt_poisson = geemaee(
  y = sampleSWCRT$y_bin,
  X = X, id = id, Z = Z,
  family = "poisson",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = TRUE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_maee_ind_cnt_poisson)


### GEE
est_uee_ind_cnt_poisson = geemaee(
  y = sampleSWCRT$y_bin,
  X = X, id = id, Z = Z,
  family = "poisson",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = FALSE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_uee_ind_cnt_poisson)


###############################################################
### (4) Matrix-adjusted estimating equations and GEE
### on count outcome with nested exchangeable correlation structure
### using Quasi-Poisson distribution
###############################################################
### MAEE
est_maee_ind_cnt_quasipoisson = geemaee(
  y = sampleSWCRT$y_bin,
  X = X, id = id, Z = Z,
  family = "quasipoisson",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = TRUE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_maee_ind_cnt_quasipoisson)


### GEE
est_uee_ind_cnt_quasipoisson = geemaee(
  y = sampleSWCRT$y_bin,
  X = X, id = id, Z = Z,
  family = "quasipoisson",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = FALSE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_uee_ind_cnt_quasipoisson)


## This will elapse longer.
########################################################################
### Example 2): simulated SW-CRT with larger cluster-period sizes (20~30)
########################################################################

sampleSWCRT &lt;- sampleSWCRTLarge

###############################################################
### Individual-level id, period, outcome, and design matrix ###
###############################################################

id &lt;- sampleSWCRT$id
period &lt;- sampleSWCRT$period
X &lt;- as.matrix(sampleSWCRT[, c("period1", "period2", "period3", "period4", "period5", "treatment")])

m &lt;- as.matrix(table(id, period))
n &lt;- dim(m)[1]
t &lt;- dim(m)[2]
### design matrix for correlation parameters
Z &lt;- createzCrossSec(m)

################################################################
### (1) Matrix-adjusted estimating equations and GEE
### on continous outcome with nested exchangeable correlation structure
################################################################

### MAEE
est_maee_ind_con &lt;- geemaee(
  y = sampleSWCRT$y_con, X = X, id = id,
  Z = Z, family = "continuous",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = TRUE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_maee_ind_con)


### GEE
est_uee_ind_con &lt;- geemaee(
  y = sampleSWCRT$y_con, X = X, id = id,
  Z = Z, family = "continuous",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = FALSE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_uee_ind_con)

###############################################################
### (2) Matrix-adjusted estimating equations and GEE
### on binary outcome with nested exchangeable correlation structure
###############################################################

### MAEE
est_maee_ind_bin &lt;- geemaee(
  y = sampleSWCRT$y_bin, X = X, id = id,
  Z = Z, family = "binomial",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = TRUE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_maee_ind_bin)


### GEE
est_uee_ind_bin &lt;- geemaee(
  y = sampleSWCRT$y_bin, X = X, id = id,
  Z = Z, family = "binomial",
  maxiter = 500, epsilon = 0.001,
  printrange = TRUE, alpadj = FALSE,
  shrink = "ALPHA", makevone = FALSE
)
print(est_uee_ind_bin)


</code></pre>

<hr>
<h2 id='print.cpgeeSWD'>The print format for cpgeeSWD output</h2><span id='topic+print.cpgeeSWD'></span>

<h3>Description</h3>

<p>The print format for cpgeeSWD output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cpgeeSWD'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.cpgeeSWD_+3A_x">x</code></td>
<td>
<p>The object of cpgeeSWD output</p>
</td></tr>
<tr><td><code id="print.cpgeeSWD_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output from <code><a href="base.html#topic+print">print</a></code>
</p>

<hr>
<h2 id='print.geemaee'>The print format for geemaee output</h2><span id='topic+print.geemaee'></span>

<h3>Description</h3>

<p>The print format for geemaee output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'geemaee'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.geemaee_+3A_x">x</code></td>
<td>
<p>The object of geemaee output</p>
</td></tr>
<tr><td><code id="print.geemaee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output from <code><a href="base.html#topic+print">print</a></code>
</p>

<hr>
<h2 id='sampleSWCRTLarge'>simulated large SW-CRT data</h2><span id='topic+sampleSWCRTLarge'></span>

<h3>Description</h3>

<p>Simulated cross-sectional individual-level SW-CRT data with 12 clusters and 5 periods. The cluster-period size is uniformly distributed between 20 and 30.
The correlated binary and continuous outcomes are used for analysis as examples.
</p>


<h3>Format</h3>

<p>A data frame with 1508 rows and 10 variables:
</p>

<dl>
<dt>period1</dt><dd><p>indicator of being at period 1</p>
</dd>
<dt>period2</dt><dd><p>indicator of being at period 2</p>
</dd>
<dt>period3</dt><dd><p>indicator of being at period 3</p>
</dd>
<dt>period4</dt><dd><p>indicator of being at period 4</p>
</dd>
<dt>period5</dt><dd><p>indicator of being at period 5</p>
</dd>
<dt>treatment</dt><dd><p>indicator of being treated</p>
</dd>
<dt>id</dt><dd><p>cluster identification number</p>
</dd>
<dt>period</dt><dd><p>period order number</p>
</dd>
<dt>y_bin</dt><dd><p>binary outcome variable</p>
</dd>
<dt>y_con</dt><dd><p>continous outcome variable</p>
</dd>
</dl>


<hr>
<h2 id='sampleSWCRTSmall'>simulated small SW-CRT data</h2><span id='topic+sampleSWCRTSmall'></span>

<h3>Description</h3>

<p>Simulated cross-sectional individual-level SW-CRT data with 12 clusters and 4 periods. The cluster-period size is uniformly distributed between 5 and 10.
The correlated binary and continuous outcomes are used for analysis as examples.
</p>


<h3>Format</h3>

<p>A data frame with 373 rows and 9 variables:
</p>

<dl>
<dt>period1</dt><dd><p>indicator of being at period 1</p>
</dd>
<dt>period2</dt><dd><p>indicator of being at period 2</p>
</dd>
<dt>period3</dt><dd><p>indicator of being at period 3</p>
</dd>
<dt>period4</dt><dd><p>indicator of being at period 4</p>
</dd>
<dt>treatment</dt><dd><p>indicator of being treated</p>
</dd>
<dt>id</dt><dd><p>cluster identification number</p>
</dd>
<dt>period</dt><dd><p>period order number</p>
</dd>
<dt>y_bin</dt><dd><p>binary outcome variable</p>
</dd>
<dt>y_con</dt><dd><p>continous outcome variable</p>
</dd>
</dl>


<hr>
<h2 id='simbinCLF'>Generating Correlated Binary Data using the Conditional Linear Family Method.</h2><span id='topic+simbinCLF'></span>

<h3>Description</h3>

<p>simbinCLF generates correlated binary data using the conditional linear family method (Qaqish, 2003).
It simulates a vector of binary outcomes according the specified marginal mean vector and correlation structure.
Natural constraints and compatibility between the marginal mean and correlation matrix are checked.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simbinCLF(mu, Sigma, n = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simbinCLF_+3A_mu">mu</code></td>
<td>
<p>a mean vector when <code>n = 1</code> or is <code>NULL</code>, otherwise a list of mean vectors for the <code>n</code> clusters</p>
</td></tr>
<tr><td><code id="simbinCLF_+3A_sigma">Sigma</code></td>
<td>
<p>a correlation matrix when <code>n = 1</code> or is <code>NULL</code>, otherwise a list of correlation matrices for the <code>n</code> clusters</p>
</td></tr>
<tr><td><code id="simbinCLF_+3A_n">n</code></td>
<td>
<p>number of clusters. The default is <code>1</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>y</code> a vector of simulated binary outcomes for <code>n</code> clusters.
</p>


<h3>Author(s)</h3>

<p>Hengshi Yu &lt;hengshi@umich.edu&gt;, Fan Li &lt;fan.f.li@yale.edu&gt;, Paul Rathouz &lt;paul.rathouz@austin.utexas.edu&gt;, Elizabeth L. Turner &lt;liz.turner@duke.edu&gt;, John Preisser &lt;jpreisse@bios.unc.edu&gt;
</p>


<h3>References</h3>

<p>Qaqish, B. F. (2003). A family of multivariate binary distributions for simulating correlated binary variables with
specified marginal means and correlations. Biometrika, 90(2), 455-463.
</p>
<p>Preisser, J. S., Qaqish, B. F. (2014). A comparison of methods for simulating correlated binary variables with specified marginal means
and correlations. Journal of Statistical Computation and Simulation, 84(11), 2441-2452.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#####################################################################
# Simulate 2 clusters, 3 periods and cluster-period size of 5 #######
#####################################################################

t &lt;- 3
n &lt;- 2
m &lt;- 5

# means of cluster 1
u_c1 &lt;- c(0.4, 0.3, 0.2)
u1 &lt;- rep(u_c1, c(rep(m, t)))
# means of cluster 2
u_c2 &lt;- c(0.35, 0.25, 0.2)
u2 &lt;- rep(u_c2, c(rep(m, t)))

# List of mean vectors
mu &lt;- list()
mu[[1]] &lt;- u1
mu[[2]] &lt;- u2
# List of correlation matrices

## correlation parameters
alpha0 &lt;- 0.03
alpha1 &lt;- 0.015
rho &lt;- 0.8

## (1) exchangeable
Sigma &lt;- list()
Sigma[[1]] &lt;- diag(m * t) * (1 - alpha1) + matrix(alpha1, m * t, m * t)
Sigma[[2]] &lt;- diag(m * t) * (1 - alpha1) + matrix(alpha1, m * t, m * t)

y_exc &lt;- simbinCLF(mu = mu, Sigma = Sigma, n = n)

## (2) nested exchangeable
Sigma &lt;- list()
cor_matrix &lt;- matrix(alpha1, m * t, m * t)
loc1 &lt;- 0
loc2 &lt;- 0
for (t in 1:t) {
    loc1 &lt;- loc2 + 1
    loc2 &lt;- loc1 + m - 1
    for (i in loc1:loc2) {
        for (j in loc1:loc2) {
            if (i != j) {
                cor_matrix[i, j] &lt;- alpha0
            } else {
                cor_matrix[i, j] &lt;- 1
            }
        }
    }
}

Sigma[[1]] &lt;- cor_matrix
Sigma[[2]] &lt;- cor_matrix

y_nex &lt;- simbinCLF(mu = mu, Sigma = Sigma, n = n)

## (3) exponential decay

Sigma &lt;- list()

### function to find the period of the ith index
region_ij &lt;- function(points, i) {
    diff &lt;- i - points
    for (h in 1:(length(diff) - 1)) {
        if (diff[h] &gt; 0 &amp; diff[h + 1] &lt;= 0) {
            find &lt;- h
        }
    }
    return(find)
}

cor_matrix &lt;- matrix(0, m * t, m * t)
useage_m &lt;- cumsum(m * t)
useage_m &lt;- c(0, useage_m)

for (i in 1:(m * t)) {
    i_reg &lt;- region_ij(useage_m, i)
    for (j in 1:(m * t)) {
        j_reg &lt;- region_ij(useage_m, j)
        if (i_reg == j_reg &amp; i != j) {
            cor_matrix[i, j] &lt;- alpha0
        } else if (i == j) {
            cor_matrix[i, j] &lt;- 1
        } else if (i_reg != j_reg) {
            cor_matrix[i, j] &lt;- alpha0 * (rho^(abs(i_reg - j_reg)))
        }
    }
}

Sigma[[1]] &lt;- cor_matrix
Sigma[[2]] &lt;- cor_matrix

y_ed &lt;- simbinCLF(mu = mu, Sigma = Sigma, n = n)

</code></pre>

<hr>
<h2 id='simbinPROBIT'>Generating Correlated Binary Data using the Multivariate Probit Method.</h2><span id='topic+simbinPROBIT'></span>

<h3>Description</h3>

<p>simbinPROBIT generates correlated binary data using the multivariate Probit method
(Emrich and Piedmonte, 1991). It simulates a vector of binary outcomes according the specified marginal
mean vector and correlation structure. Constraints and compatibility between the marginal mean and
correlation matrix are checked.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simbinPROBIT(mu, Sigma, n = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simbinPROBIT_+3A_mu">mu</code></td>
<td>
<p>a mean vector when <code>n = 1</code> or is <code>NULL</code>, otherwise a list of mean vectors for the <code>n</code> clusters</p>
</td></tr>
<tr><td><code id="simbinPROBIT_+3A_sigma">Sigma</code></td>
<td>
<p>a correlation matrix when <code>n = 1</code> or is <code>NULL</code>, otherwise a list of correlation matrices for the <code>n</code> clusters</p>
</td></tr>
<tr><td><code id="simbinPROBIT_+3A_n">n</code></td>
<td>
<p>number of clusters. The default is <code>1</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>y</code> a vector of simulated binary outcomes for <code>n</code> clusters.
</p>


<h3>Author(s)</h3>

<p>Hengshi Yu &lt;hengshi@umich.edu&gt;, Fan Li &lt;fan.f.li@yale.edu&gt;, Paul Rathouz &lt;paul.rathouz@austin.utexas.edu&gt;, Elizabeth L. Turner &lt;liz.turner@duke.edu&gt;, John Preisser &lt;jpreisse@bios.unc.edu&gt;
</p>


<h3>References</h3>

<p>Emrich, L. J., &amp; Piedmonte, M. R. (1991). A method for generating high-dimensional multivariate binary variates.
The American Statistician, 45(4), 302-304.
</p>
<p>Preisser, J. S., Qaqish, B. F. (2014). A comparison of methods for simulating correlated binary variables with specified marginal means
and correlations. Journal of Statistical Computation and Simulation, 84(11), 2441-2452.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#####################################################################
# Simulate 2 clusters, 3 periods and cluster-period size of 5 #######
#####################################################################

t &lt;- 3
n &lt;- 2
m &lt;- 5

# means of cluster 1
u_c1 &lt;- c(0.4, 0.3, 0.2)
u1 &lt;- rep(u_c1, c(rep(m, t)))
# means of cluster 2
u_c2 &lt;- c(0.35, 0.25, 0.2)
u2 &lt;- rep(u_c2, c(rep(m, t)))

# List of mean vectors
mu &lt;- list()
mu[[1]] &lt;- u1
mu[[2]] &lt;- u2
# List of correlation matrices

## correlation parameters
alpha0 &lt;- 0.03
alpha1 &lt;- 0.015
rho &lt;- 0.8

## (1) exchangeable
Sigma &lt;- list()
Sigma[[1]] &lt;- diag(m * t) * (1 - alpha1) + matrix(alpha1, m * t, m * t)
Sigma[[2]] &lt;- diag(m * t) * (1 - alpha1) + matrix(alpha1, m * t, m * t)
y_exc &lt;- simbinPROBIT(mu = mu, Sigma = Sigma, n = n)

## (2) nested exchangeable
Sigma &lt;- list()
cor_matrix &lt;- matrix(alpha1, m * t, m * t)
loc1 &lt;- 0
loc2 &lt;- 0
for (t in 1:t) {
    loc1 &lt;- loc2 + 1
    loc2 &lt;- loc1 + m - 1
    for (i in loc1:loc2) {
        for (j in loc1:loc2) {
            if (i != j) {
                cor_matrix[i, j] &lt;- alpha0
            } else {
                cor_matrix[i, j] &lt;- 1
            }
        }
    }
}

Sigma[[1]] &lt;- cor_matrix
Sigma[[2]] &lt;- cor_matrix
y_nex &lt;- simbinPROBIT(mu = mu, Sigma = Sigma, n = n)

## (3) exponential decay

Sigma &lt;- list()

### function to find the period of the ith index
region_ij &lt;- function(points, i) {
    diff &lt;- i - points
    for (h in 1:(length(diff) - 1)) {
        if (diff[h] &gt; 0 &amp; diff[h + 1] &lt;= 0) {
            find &lt;- h
        }
    }
    return(find)
}

cor_matrix &lt;- matrix(0, m * t, m * t)
useage_m &lt;- cumsum(m * t)
useage_m &lt;- c(0, useage_m)

for (i in 1:(m * t)) {
    i_reg &lt;- region_ij(useage_m, i)
    for (j in 1:(m * t)) {
        j_reg &lt;- region_ij(useage_m, j)
        if (i_reg == j_reg &amp; i != j) {
            cor_matrix[i, j] &lt;- alpha0
        } else if (i == j) {
            cor_matrix[i, j] &lt;- 1
        } else if (i_reg != j_reg) {
            cor_matrix[i, j] &lt;- alpha0 * (rho^(abs(i_reg - j_reg)))
        }
    }
}
Sigma[[1]] &lt;- cor_matrix
Sigma[[2]] &lt;- cor_matrix
y_ed &lt;- simbinPROBIT(mu = mu, Sigma = Sigma, n = n)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
