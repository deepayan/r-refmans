<!DOCTYPE html><html><head><title>Help for package IRTBEMM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IRTBEMM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BEMM.1PLAG'>
<p>Calibrating 1PLAG model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm.</p></a></li>
<li><a href='#BEMM.1PLG'>
<p>Calibrating 1PLG model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm.</p></a></li>
<li><a href='#BEMM.3PL'>
<p>Calibrating 3PL model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm.</p></a></li>
<li><a href='#BEMM.4PL'>
<p>Calibrating 4PL model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm.</p></a></li>
<li><a href='#Input.Checking'>
<p>Checking user speciflied input variables.</p></a></li>
<li><a href='#Prob.model'>
<p>Calculate the probabilites based on a given model and parameters.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Family of Bayesian EMM Algorithm for Item Response Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-06</td>
</tr>
<tr>
<td>Description:</td>
<td>Applying the family of the Bayesian Expectation-Maximization-Maximization (BEMM) algorithm to estimate: (1) Three parameter logistic (3PL) model proposed by Birnbaum (1968, ISBN:9780201043105); (2) four parameter logistic (4PL) model proposed by Barton &amp; Lord (1981) &lt;<a href="https://doi.org/10.1002%2Fj.2333-8504.1981.tb01255.x">doi:10.1002/j.2333-8504.1981.tb01255.x</a>&gt;; (3) one parameter logistic guessing (1PLG) and (4) one parameter logistic ability-based guessing (1PLAG) models proposed by San Martín et al (2006) &lt;<a href="https://doi.org/10.1177%2F0146621605282773">doi:10.1177/0146621605282773</a>&gt;. The BEMM family includes (1) the BEMM algorithm for 3PL model proposed by Guo &amp; Zheng (2019) &lt;<a href="https://doi.org/10.3389%2Ffpsyg.2019.01175">doi:10.3389/fpsyg.2019.01175</a>&gt;; (2) the BEMM algorithm for 1PLG model and (3) the BEMM algorithm for 1PLAG model proposed by Guo, Wu, Zheng, &amp; Chen (2021) &lt;<a href="https://doi.org/10.1177%2F0146621621990761">doi:10.1177/0146621621990761</a>&gt;; (4) the BEMM algorithm for 4PL model proposed by Zheng, Guo, &amp; Kern (2021) &lt;<a href="https://doi.org/10.1177%2F21582440211052556">doi:10.1177/21582440211052556</a>&gt;; and (5) their maximum likelihood estimation versions proposed by Zheng, Meng, Guo, &amp; Liu (2018) &lt;<a href="https://doi.org/10.3389%2Ffpsyg.2017.02302">doi:10.3389/fpsyg.2017.02302</a>&gt;. Thus, both Bayesian modal estimates and maximum likelihood estimates are available.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-06 09:22:42 UTC; syguo1992</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Shaoyang Guo [aut, cre, cph],
  Chanjin Zheng [aut],
  Justin L Kern [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shaoyang Guo &lt;syguo1992@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-06 12:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='BEMM.1PLAG'>
Calibrating 1PLAG model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm.
</h2><span id='topic+BEMM.1PLAG'></span>

<h3>Description</h3>

<p>This function can estimate the item parameters of the 1PLAG model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm proposed by Guo, Wu, Zheng, &amp; Wang (2018, April). Both Bayesan modal estimates and maximum likelihood estimates are available. In addition, the examinees' ability and a few model fits information can be also obtained through this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BEMM.1PLAG(data, PriorAlpha = c(-1.9, 1), PriorBeta = c(0, 4), 
	PriorGamma = c(-1.39, 0.25), InitialAlpha = NA, 
	InitialBeta = NA, InitialGamma = NA, Tol = 0.0001, 
	max.ECycle = 2000L, max.MCycle = 100L, n.decimal = 3L, 
	n.Quadpts = 31L, Theta.lim = c(-6, 6), Missing = -9, 
	ParConstraint = FALSE, BiasSE=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BEMM.1PLAG_+3A_data">data</code></td>
<td>

<p>A <code>matrix</code> or <code>data.frame</code> consists of dichotomous data (1 for correct and 0 for wrong response), with missing data coded as in Missing (by default, Missing=-9). Each row of data represents a examinne' responses, and each column represents an item.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_prioralpha">PriorAlpha</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for the logarithmic weight of the ability in the guessing component (<em>ln(alpha</em>)) parameter in the 1PLAG model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters normal distribution for all <em>log(alpha)</em> parameters. By default, PriorAlpha=c(-1.9,1), which means a Normal prior of mean=-1.9 and variance=1 will be used for the logarithmic weight of the ability.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for the weight of the ability will be obtained.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_priorbeta">PriorBeta</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for item difficulty (<em>beta</em>) parameters in the 1PLAG and 1PLG model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of normal distribution for all <em>beta</em> parameters. By default, PriorBeta=c(0,4), which means a normal prior of mean=0 and variance=4 will be used for all item difficulty parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item difficulty parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of normal prior (mean and variance) for single item <em>beta</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_priorgamma">PriorGamma</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for item guessing (<em>gamma</em>) parameters in the 1PLAG and 1PLG model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of normal distribution for all <em>gamma</em> parameters. By default, PriorGamma=c(-1.39,0.25), which means a normal prior of mean=-1.39 and variance=0.25 will be used for all item guessing parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item guessing parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of normal prior (mean and variance) for single item <em>gamma</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_initialalpha">InitialAlpha</code></td>
<td>

<p>The user specified starting value for the weight of the ability in the guessing component (<em>alpha</em>) parameters in the 1PLAG model. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>alpha</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting value of <em>alpha</em>.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_initialbeta">InitialBeta</code></td>
<td>

<p>The user specified starting values for item difficulty (<em>beta</em>) parameters in the 1PLAG and 1PLG models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>beta</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>beta</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>beta</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_initialgamma">InitialGamma</code></td>
<td>

<p>The user specified starting values for item guessing (<em>gamma</em>) parameters in the 1PLAG and 1PLG models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>gamma</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>gamma</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>gamma</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_tol">Tol</code></td>
<td>

<p>A single number (<code>numeric</code>), refers to convergence threshold for E-step cycles; defaults are 0.0001.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_max.ecycle">max.ECycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of E-step cycles; defaults are 2000L.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_max.mcycle">max.MCycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of M-step cycles; defaults are 100L.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_n.quadpts">n.Quadpts</code></td>
<td>

<p>A single <code>integer</code>, refers to number of quadrature points per dimension (must be larger than 5); defaults are 31L.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_n.decimal">n.decimal</code></td>
<td>

<p>A single <code>integer</code>, refers to number of decimal places when outputs results.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_theta.lim">Theta.lim</code></td>
<td>

<p>A <code>numeric</code> with two number, refers to the range of integration grid for each dimension; default is c(-6, 6).
</p>
</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_missing">Missing</code></td>
<td>

<p>A single number (<code>numeric</code>) to indicate which elements are missing; default is -9. The Missing cannot be 0 or 1.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_parconstraint">ParConstraint</code></td>
<td>

<p>A logical value to indicate whether estimates parametes in a reasonable range; default is FALSE. If ParConstraint=TRUE: <em>alpha</em> in [0, 0.707], <em>beta</em> in [-6, 6], <em>gamma</em> in [-7, 0].
</p>
</td></tr>
<tr><td><code id="BEMM.1PLAG_+3A_biasse">BiasSE</code></td>
<td>

<p>A logical value to determine whether directly estimating SEs from inversed Hession matrix rather than USEM method, default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>One parameter logsitc ability-based guessing (1PLAG) model proposed by San Martín et al.(2006). Let <em>invlogit(x)=1 / (1 + exp(-x))</em>:
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, \alpha, \beta, \gamma) = invlogit(\theta - \beta) + (1 - invlogit(\theta - \beta)) * invlogit(\alpha * \theta + \gamma)</code>
</p>

<p>where x=1 is the correct response, <em>theta</em> is examinne's ability; <em>alpha</em> is the weight of the ability in the guessing component; <em>beta</em> and <em>gamma</em> are the item difficulty and guessing parameter, respectively.
These parameter labels are <strong>capitalized</strong> in program for emphasis.  
</p>


<h3>Value</h3>

<p>This function will return a list includes following:
</p>

<dl>
<dt>Est.ItemPars</dt><dd><p>A <code>dataframe</code> consists of the estimates of <em>alpha</em>, <em>beta</em> and <em>gamma</em> parameters and corresponding estimated standard errors.</p>
</dd>
<dt>Est.Theta</dt><dd><p>A <code>dataframe</code> consists of the estimates of <em>theta</em> and corresponding estimated standard errors (EAP method).</p>
</dd>
<dt>Loglikelihood</dt><dd><p>The loglikelihood.</p>
</dd>
<dt>Iteration</dt><dd><p>The number of iterations.</p>
</dd>
<dt>EM.Map</dt><dd><p>The parameter estimation history of iterations.</p>
</dd>
<dt>fits.test</dt><dd><p>The model fits information includes G2 test, AIC, BIC and RMSEA.</p>
</dd>
<dt>Elapsed.time</dt><dd><p>The running time of the program.</p>
</dd>
<dt>InitialValues</dt><dd><p>The initial values of item parameters.</p>
</dd>
</dl>



<h3>References</h3>

<p>Guo, S., Wu, T., Zheng, C., &amp; Wang, W.-C. (2018, April). <em>Bayesian Expectation-Maximization-Maximization for 1PL-AG Model</em>. Paper presented at the 80th NCME Annual Meeting, New York, NY. 
</p>
<p>San Martín, E., Del Pino, G., &amp; De Boeck, P. (2006). IRT models for ability-based guessing. <em>Applied Psychological Measurement</em>, <em>30</em>(3), 183-203. <a href="https://doi.org/10.1177/0146621605282773">doi:10.1177/0146621605282773</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###Example: A brief simulation study###

#generate true values and response matrix
set.seed(10)
library(IRTBEMM)
I=500    #set the number of examinees is 500
J=10      #set the number of items is 10
true.alpha=0.2 #simulate true weight parameters
true.beta=rnorm(J,0,1)     #simulate true difficulty parameters
true.gamma=rnorm(J,-1.39,0.5)    #simulate true guessing parameters
true.th=rnorm(I,0,1)       #simulate true theta parameters
true.par=list(Alpha=true.alpha, Beta=true.beta, Gamma=true.gamma)   #make a list
response=matrix(NA,I,J)       #Create a array to save response data
for (i in 1:I){
  #calucate the probability of 1PLAG
  P=Prob.model(X=true.th[i], Model='1PLAG', Par.est0=true.par)  
  response[i,]=rbinom(J,1,P)   #simulate the response
}

#To save example running time, we set the Tol to 0.1
#Obtain the Bayesian modal estimation (BME) using default priors

#Estimate model via BEMM algorithm
bme.res=BEMM.1PLAG(response, Tol=0.1) 

bme.res$Est.ItemPars         #show item estimates
bme.res$Est.Theta            #show ability estimates
bme.res$Loglikelihood        #show log-likelihood
bme.res$EM.Map               #show EM iteration history
bme.res$fits.test 		     #show model fits information


#Obtain the maximum likelihood estimation (MLE) by setting Prior=NA

#Estimate model via EMM algorithm
mle.res=BEMM.1PLAG(response, PriorAlpha=NA, PriorBeta=NA, PriorGamma=NA, Tol=0.1) 

mle.res$Est.ItemPars       #show item estimates
mle.res$Est.Theta          #show ability estimates
mle.res$Loglikelihood      #show log-likelihood
mle.res$EM.Map             #show EM iteration history
mle.res$fits.test 		   #show model fits information


</code></pre>

<hr>
<h2 id='BEMM.1PLG'>
Calibrating 1PLG model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm.
</h2><span id='topic+BEMM.1PLG'></span>

<h3>Description</h3>

<p>This function can estimate the item parameters of the 1PLG model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm proposed by Guo, Wu, Zheng, &amp; Wang (2018, April). Both Bayesan modal estimates and maximum likelihood estimates are available. In addition, the examinees' ability and a few model fits information can be also obtained through this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BEMM.1PLG(data, PriorBeta = c(0, 4), PriorGamma = c(-1.39, 0.25), 
	InitialBeta = NA, InitialGamma = NA, 
	Tol = 0.0001, max.ECycle = 2000L, max.MCycle = 100L, 
	n.decimal = 3L, n.Quadpts = 31L, Theta.lim = c(-6, 6), 
	Missing = -9, ParConstraint = FALSE, BiasSE=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BEMM.1PLG_+3A_data">data</code></td>
<td>

<p>A <code>matrix</code> or <code>data.frame</code> consists of dichotomous data (1 for correct and 0 for wrong response), with missing data coded as in Missing (by default, Missing=-9). Each row of data represents a examinne' responses, and each column represents an item.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_priorbeta">PriorBeta</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for item difficulty (<em>beta</em>) parameters in the 1PLAG and 1PLG model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of normal distribution for all <em>beta</em> parameters. By default, PriorBeta=c(0,4), which means a normal prior of mean=0 and variance=4 will be used for all item difficulty parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item difficulty parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of normal prior (mean and variance) for single item <em>beta</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_priorgamma">PriorGamma</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for item guessing (<em>gamma</em>) parameters in the 1PLAG and 1PLG model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of normal distribution for all <em>gamma</em> parameters. By default, PriorGamma=c(-1.39,0.25), which means a normal prior of mean=-1.39 and variance=0.25 will be used for all item guessing parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item guessing parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of normal prior (mean and variance) for single item <em>gamma</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_initialbeta">InitialBeta</code></td>
<td>

<p>The user specified starting values for item difficulty (<em>beta</em>) parameters in the 1PLAG and 1PLG models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>beta</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>beta</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>beta</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_initialgamma">InitialGamma</code></td>
<td>

<p>The user specified starting values for item guessing (<em>gamma</em>) parameters in the 1PLAG and 1PLG models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>gamma</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>gamma</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>gamma</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_tol">Tol</code></td>
<td>

<p>A single number (<code>numeric</code>), refers to convergence threshold for E-step cycles; defaults are 0.0001.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_max.ecycle">max.ECycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of E-step cycles; defaults are 2000L.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_max.mcycle">max.MCycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of M-step cycles; defaults are 100L.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_n.quadpts">n.Quadpts</code></td>
<td>

<p>A single <code>integer</code>, refers to number of quadrature points per dimension (must be larger than 5); defaults are 31L.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_n.decimal">n.decimal</code></td>
<td>

<p>A single <code>integer</code>, refers to number of decimal places when outputs results.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_theta.lim">Theta.lim</code></td>
<td>

<p>A <code>numeric</code> with two number, refers to the range of integration grid for each dimension; default is c(-6, 6).
</p>
</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_missing">Missing</code></td>
<td>

<p>A single number (<code>numeric</code>) to indicate which elements are missing; default is -9. The Missing cannot be 0 or 1.
</p>
</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_parconstraint">ParConstraint</code></td>
<td>

<p>A logical value to indicate whether estimates parametes in a reasonable range; default is FALSE. If ParConstraint=TRUE: <em>beta</em> in [-6, 6], <em>gamma</em> in [-7, 0].
</p>
</td></tr>
<tr><td><code id="BEMM.1PLG_+3A_biasse">BiasSE</code></td>
<td>

<p>A logical value to determine whether directly estimating SEs from inversed Hession matrix rather than USEM method, default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>One parameter logsitc guessing (1PLG) model proposed by San Martín et al.(2006). Let <em>invlogit(x)=1 / (1 + exp(-x))</em>:
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, \beta, \gamma) = invlogit(\theta - \beta) + (1 - invlogit(\theta - \beta)) * invlogit(\gamma)</code>
</p>

<p>where x=1 is the correct response, <em>theta</em> is examinne's ability; <em>beta</em> and <em>gamma</em> are the item difficulty and guessing parameter, respectively.
These parameter labels are <strong>capitalized</strong> in program for emphasis.  
</p>


<h3>Value</h3>

<p>This function will return a list includes following:
</p>

<dl>
<dt>Est.ItemPars</dt><dd><p>A <code>dataframe</code> consists of the estimates of <em>beta</em> and <em>gamma</em> parameters and corresponding estimated standard errors.</p>
</dd>
<dt>Est.Theta</dt><dd><p>A <code>dataframe</code> consists of the estimates of <em>theta</em> and corresponding estimated standard errors (EAP method).</p>
</dd>
<dt>Loglikelihood</dt><dd><p>The loglikelihood.</p>
</dd>
<dt>Iteration</dt><dd><p>The number of iterations.</p>
</dd>
<dt>EM.Map</dt><dd><p>The parameter estimation history of iterations.</p>
</dd>
<dt>fits.test</dt><dd><p>The model fits information includes G2 test, AIC, BIC and RMSEA.</p>
</dd>
<dt>Elapsed.time</dt><dd><p>The running time of the program.</p>
</dd>
<dt>InitialValues</dt><dd><p>The initial values of item parameters.</p>
</dd>
</dl>



<h3>References</h3>

<p>Guo, S., Wu, T., Zheng, C., &amp; Wang, W.-C. (2018, April). <em>Bayesian Expectation-Maximization-Maximization for 1PL-AG Model</em>. Paper presented at the 80th NCME Annual Meeting, New York, NY. 
</p>
<p>San Martín, E., Del Pino, G., &amp; De Boeck, P. (2006). IRT models for ability-based guessing. <em>Applied Psychological Measurement</em>, <em>30</em>(3), 183-203. <a href="https://doi.org/10.1177/0146621605282773">doi:10.1177/0146621605282773</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###Example: A brief simulation study###

#generate true values and response matrix
set.seed(10)
library(IRTBEMM)
I=500    #set the number of examinees is 500
J=10      #set the number of items is 10
true.beta=rnorm(J,0,1)     #simulate true difficulty parameters
true.gamma=rnorm(J,-1.39,0.5)    #simulate true guessing parameters
true.th=rnorm(I,0,1)       #simulate true theta parameters
true.par=list(Beta=true.beta, Gamma=true.gamma)   #make a list
response=matrix(NA,I,J)       #Create a array to save response data
for (i in 1:I){
   #calucate the probability of 1PLG
   P=Prob.model(X=true.th[i], Model='1PLG', Par.est0=true.par)  
   response[i,]=rbinom(J,1,P)   #simulate the response
}

#To save example running time, we set the Tol to 0.1
#Obtain the Bayesian modal estimation (BME) using default priors

#Estimate model via BEMM algorithm
bme.res=BEMM.1PLG(response, Tol=0.1) 

bme.res$Est.ItemPars         #show item estimates
bme.res$Est.Theta            #show ability estimates
bme.res$Loglikelihood        #show log-likelihood
bme.res$EM.Map               #show EM iteration history
bme.res$fits.test 		     #show model fits information


#Obtain the maximum likelihood estimation (MLE) by setting Prior=NA

#Estimate model via EMM algorithm
mle.res=BEMM.1PLG(response, PriorBeta=NA, PriorGamma=NA, Tol=0.1) 

mle.res$Est.ItemPars       #show item estimates
mle.res$Est.Theta          #show ability estimates
mle.res$Loglikelihood      #show log-likelihood
mle.res$EM.Map             #show EM iteration history
mle.res$fits.test 		   #show model fits information


</code></pre>

<hr>
<h2 id='BEMM.3PL'>
Calibrating 3PL model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm.
</h2><span id='topic+BEMM.3PL'></span>

<h3>Description</h3>

<p>This function can estimate the item parameters of the 3PL model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm proposed by Guo &amp; Zheng(2019) and Zheng, Meng, Guo, &amp; Liu (2018). Both Bayesan modal estimates and maximum likelihood estimates are available. In addition, the examinees' ability and a few model fits information can be also obtained through this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BEMM.3PL(data, PriorA = c(0, 0.25), PriorB = c(0, 4), PriorC = c(4, 16), 
	InitialA = NA, InitialB = NA, InitialC = NA, 
	Tol = 0.0001, max.ECycle = 2000L, max.MCycle = 100L, 
	n.decimal = 3L, n.Quadpts = 31L, Theta.lim = c(-6, 6), 
	Missing = -9, ParConstraint = FALSE, BiasSE=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BEMM.3PL_+3A_data">data</code></td>
<td>

<p>A <code>matrix</code> or <code>data.frame</code> consists of dichotomous data (1 for correct and 0 for wrong response), with missing data coded as in Missing (by default, Missing=-9). Each row of data represents a examinne' responses, and each column represents an item.
</p>
</td></tr>
<tr><td><code id="BEMM.3PL_+3A_priora">PriorA</code></td>
<td>
<p>The user specified <strong>logarithmic normal distribution</strong> prior for item discrimation (<em>a</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of logarithmic normal distribution for all <em>a</em> parameters. By default, PriorA=c(0,0.25), which means a log normal prior of mean=0 and variance=0.25 will be used for all item discrimation parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item discrimation parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of log normal prior (mean and variance) for single item <em>a</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.3PL_+3A_priorb">PriorB</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for item difficulty (<em>b</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of normal distribution for all <em>b</em> parameters. By default, PriorB=c(0,4), which means a normal prior of mean=0 and variance=4 will be used for all item difficulty parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item difficulty parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of normal prior (mean and variance) for single item <em>b</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.3PL_+3A_priorc">PriorC</code></td>
<td>

<p>The user specified <strong>Beta(x,y) distribution</strong> prior for item guessing (<em>c</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters x and y of Beta distribution for all <em>c</em> parameters. By default, PriorC=c(4,16), which means a Beta prior of mean=4/(4+16)=0.2 and variance=0.008 will be used for all item guessing parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item guessing parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of Beta prior (x and y) for single item <em>c</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.3PL_+3A_initiala">InitialA</code></td>
<td>

<p>The user specified starting values for item discrimation (<em>a</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>a</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>a</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>a</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.3PL_+3A_initialb">InitialB</code></td>
<td>

<p>The user specified starting values for item difficulty (<em>b</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>b</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>b</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>b</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.3PL_+3A_initialc">InitialC</code></td>
<td>

<p>The user specified starting values for item guessing (<em>c</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>c</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>c</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>c</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.3PL_+3A_tol">Tol</code></td>
<td>

<p>A single number (<code>numeric</code>), refers to convergence threshold for E-step cycles; defaults are 0.0001.
</p>
</td></tr>
<tr><td><code id="BEMM.3PL_+3A_max.ecycle">max.ECycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of E-step cycles; defaults are 2000L.
</p>
</td></tr>
<tr><td><code id="BEMM.3PL_+3A_max.mcycle">max.MCycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of M-step cycles; defaults are 100L.
</p>
</td></tr>
<tr><td><code id="BEMM.3PL_+3A_n.quadpts">n.Quadpts</code></td>
<td>

<p>A single <code>integer</code>, refers to number of quadrature points per dimension (must be larger than 5); defaults are 31L.
</p>
</td></tr>
<tr><td><code id="BEMM.3PL_+3A_n.decimal">n.decimal</code></td>
<td>

<p>A single <code>integer</code>, refers to number of decimal places when outputs results.
</p>
</td></tr>
<tr><td><code id="BEMM.3PL_+3A_theta.lim">Theta.lim</code></td>
<td>

<p>A <code>numeric</code> with two number, refers to the range of integration grid for each dimension; default is c(-6, 6).
</p>
</td></tr>
<tr><td><code id="BEMM.3PL_+3A_missing">Missing</code></td>
<td>

<p>A single number (<code>numeric</code>) to indicate which elements are missing; default is -9. The Missing cannot be 0 or 1.
</p>
</td></tr>
<tr><td><code id="BEMM.3PL_+3A_parconstraint">ParConstraint</code></td>
<td>

<p>A logical value to indicate whether estimates parametes in a reasonable range; default is FALSE. If ParConstraint=TRUE: <em>a</em> in [0.001, 6], <em>b</em> in [-6, 6], <em>c</em> in [0.0001, 0.5].
</p>
</td></tr>
<tr><td><code id="BEMM.3PL_+3A_biasse">BiasSE</code></td>
<td>

<p>A logical value to determine whether directly estimating SEs from inversed Hession matrix rather than USEM method, default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three parameter logistic (3PL) model proposed by Birnbaum(1968):
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, a, b, c) = c + (1 - c) / (1 + exp(-D * a * (\theta - b))),</code>
</p>

<p>where x=1 is the correct response, <em>theta</em> is examinne's ability; <em>a</em>, <em>b</em> and <em>c</em> are the item discrimination, difficulty and guessing parameter, respectively; D is the scaling constant 1.702.
These parameter labels are <strong>capitalized</strong> in program for emphasis.  
</p>


<h3>Value</h3>

<p>This function will return a list includes following:
</p>

<dl>
<dt>Est.ItemPars</dt><dd><p>A <code>dataframe</code> consists of the estimates of <em>a</em>, <em>b</em> and <em>c</em> parameters and corresponding estimated standard errors.</p>
</dd>
<dt>Est.Theta</dt><dd><p>A <code>dataframe</code> consists of the estimates of <em>theta</em> and corresponding estimated standard errors (EAP method).</p>
</dd>
<dt>Loglikelihood</dt><dd><p>The loglikelihood.</p>
</dd>
<dt>Iteration</dt><dd><p>The number of iterations.</p>
</dd>
<dt>EM.Map</dt><dd><p>The parameter estimation history of iterations.</p>
</dd>
<dt>fits.test</dt><dd><p>The model fits information includes G2 test, AIC, BIC and RMSEA.</p>
</dd>
<dt>Elapsed.time</dt><dd><p>The running time of the program.</p>
</dd>
<dt>InitialValues</dt><dd><p>The initial values of item parameters.</p>
</dd>
</dl>



<h3>References</h3>

<p>Birnbaum, A. (1968). <em>Some latent trait models and their use in inferring an examinee's ability</em>. In F. M. Lord &amp; M. R. Novick (Eds.), Statistical theories of mental test scores (pp. 395-479). MA: Adison-Wesley.
</p>
<p>Guo, S., &amp; Zheng, C. (2019). The Bayesian Expectation-Maximization-Maximization for the 3PLM. <em>Frontiers in Psychology</em>, <em>10</em>(1175), 1-11. <a href="https://doi.org/10.3389/fpsyg.2019.01175">doi:10.3389/fpsyg.2019.01175</a>
</p>
<p>Zheng, C., Meng, X., Guo, S., &amp; Liu, Z. (2018). Expectation-Maximization-Maximization: A feasible MLE algorithm for the three-parameter logistic model based on a mixture modeling reformulation. <em>Frontiers in Psychology</em>, <em>8</em>(2302), 1-10. <a href="https://doi.org/10.3389/fpsyg.2017.02302">doi:10.3389/fpsyg.2017.02302</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###Example: A brief simulation study###

#generate true values and response matrix
set.seed(10)
library(IRTBEMM)
I=500    #set the number of examinees is 500
J=10      #set the number of items is 10
true.a=runif(J,0.4,2)      #simulate true discrimination parameters
true.b=rnorm(J,0,1)     #simulate true difficulty parameters
true.c=rbeta(J,2,8)       #simulate true guessing parameters
true.th=rnorm(I,0,1)      #simulate true theta parameters
true.par=list(A=true.a, B=true.b, C=true.c)   #make a list
response=matrix(NA,I,J)       #Create a array to save response data
for (i in 1:I){
  #calucate the probability of 3PL
  P=Prob.model(X=true.th[i], Model='3PL', Par.est0=true.par, D=1.702)  
  response[i,]=rbinom(J,1,P)   #simulate the response
}

#To save example running time, we set the Tol to 0.1
#Obtain the Bayesian modal estimation (BME) using default priors

#Estimate model via BEMM algorithm
bme.res=BEMM.3PL(response, Tol=0.1) 

bme.res$Est.ItemPars       #show item estimates
bme.res$Est.Theta          #show ability estimates
bme.res$Loglikelihood      #show log-likelihood
bme.res$EM.Map             #show EM iteration history
bme.res$fits.test 		   #show model fits information


#Obtain the maximum likelihood estimation (MLE) by setting Prior=NA

#Estimate model via EMM algorithm
mle.res=BEMM.3PL(response, PriorA=NA, PriorB=NA, PriorC=NA, Tol=0.1) 

mle.res$Est.ItemPars       #show item estimates
mle.res$Est.Theta          #show ability estimates
mle.res$Loglikelihood      #show log-likelihood
mle.res$EM.Map             #show EM iteration history
mle.res$fits.test 		   #show model fits information


</code></pre>

<hr>
<h2 id='BEMM.4PL'>
Calibrating 4PL model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm.
</h2><span id='topic+BEMM.4PL'></span>

<h3>Description</h3>

<p>This function can estimate the item parameters of the 4PL model via Bayesian Expectation-Maximization-Maximization (BEMM) algorithm proposed by Zhang, Guo, &amp; Zheng (2018, April). Both Bayesan modal estimates and maximum likelihood estimates are available. In addition, the examinees' ability and a few model fits information can be also obtained through this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BEMM.4PL(data, PriorA = c(0, 0.25), PriorB = c(0, 4), PriorC = c(4, 16), 
	PriorS = c(4, 16), InitialA = NA, InitialB = NA, InitialC = NA, 
	InitialS = NA, Tol = 0.0001, max.ECycle = 2000L, max.MCycle = 100L, 
	n.decimal = 3L, n.Quadpts = 31L, Theta.lim = c(-6, 6), 
	Missing = -9, ParConstraint = FALSE, BiasSE=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BEMM.4PL_+3A_data">data</code></td>
<td>

<p>A <code>matrix</code> or <code>data.frame</code> consists of dichotomous data (1 for correct and 0 for wrong response), with missing data coded as in Missing (by default, Missing=-9). Each row of data represents a examinne' responses, and each column represents an item.
</p>
</td></tr>
<tr><td><code id="BEMM.4PL_+3A_priora">PriorA</code></td>
<td>
<p>The user specified <strong>logarithmic normal distribution</strong> prior for item discrimation (<em>a</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of logarithmic normal distribution for all <em>a</em> parameters. By default, PriorA=c(0,0.25), which means a log normal prior of mean=0 and variance=0.25 will be used for all item discrimation parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item discrimation parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of log normal prior (mean and variance) for single item <em>a</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.4PL_+3A_priorb">PriorB</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for item difficulty (<em>b</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of normal distribution for all <em>b</em> parameters. By default, PriorB=c(0,4), which means a normal prior of mean=0 and variance=4 will be used for all item difficulty parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item difficulty parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of normal prior (mean and variance) for single item <em>b</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.4PL_+3A_priorc">PriorC</code></td>
<td>

<p>The user specified <strong>Beta(x,y) distribution</strong> prior for item guessing (<em>c</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters x and y of Beta distribution for all <em>c</em> parameters. By default, PriorC=c(4,16), which means a Beta prior of mean=4/(4+16)=0.2 and variance=0.008 will be used for all item guessing parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item guessing parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of Beta prior (x and y) for single item <em>c</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.4PL_+3A_priors">PriorS</code></td>
<td>

<p>The user specified <strong>Beta(x,y) distribution</strong> prior for item slipping (<em>s</em>) parameters in the 4PL model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters x and y of Beta distribution for all <em>s</em> parameters. By default, PriorS=c(4,16), which means a Beta prior of mean=4/(4+16)=0.2 and variance=0.008 will be used for all item slipping parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item slipping parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of Beta prior (x and y) for single item <em>s</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.4PL_+3A_initiala">InitialA</code></td>
<td>

<p>The user specified starting values for item discrimation (<em>a</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>a</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>a</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>a</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.4PL_+3A_initialb">InitialB</code></td>
<td>

<p>The user specified starting values for item difficulty (<em>b</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>b</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>b</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>b</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.4PL_+3A_initialc">InitialC</code></td>
<td>

<p>The user specified starting values for item guessing (<em>c</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>c</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>c</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>c</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.4PL_+3A_initials">InitialS</code></td>
<td>

<p>The user specified starting values for item slipping (<em>s</em>) parameters in the 4PL model. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>s</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>s</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>s</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="BEMM.4PL_+3A_tol">Tol</code></td>
<td>

<p>A single number (<code>numeric</code>), refers to convergence threshold for E-step cycles; defaults are 0.0001.
</p>
</td></tr>
<tr><td><code id="BEMM.4PL_+3A_max.ecycle">max.ECycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of E-step cycles; defaults are 2000L.
</p>
</td></tr>
<tr><td><code id="BEMM.4PL_+3A_max.mcycle">max.MCycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of M-step cycles; defaults are 100L.
</p>
</td></tr>
<tr><td><code id="BEMM.4PL_+3A_n.quadpts">n.Quadpts</code></td>
<td>

<p>A single <code>integer</code>, refers to number of quadrature points per dimension (must be larger than 5); defaults are 31L.
</p>
</td></tr>
<tr><td><code id="BEMM.4PL_+3A_n.decimal">n.decimal</code></td>
<td>

<p>A single <code>integer</code>, refers to number of decimal places when outputs results.
</p>
</td></tr>
<tr><td><code id="BEMM.4PL_+3A_theta.lim">Theta.lim</code></td>
<td>

<p>A <code>numeric</code> with two number, refers to the range of integration grid for each dimension; default is c(-6, 6).
</p>
</td></tr>
<tr><td><code id="BEMM.4PL_+3A_missing">Missing</code></td>
<td>

<p>A single number (<code>numeric</code>) to indicate which elements are missing; default is -9. The Missing cannot be 0 or 1.
</p>
</td></tr>
<tr><td><code id="BEMM.4PL_+3A_parconstraint">ParConstraint</code></td>
<td>

<p>A logical value to indicate whether estimates parametes in a reasonable range; default is FALSE. If ParConstraint=TRUE: <em>a</em> in [0.001, 6], <em>b</em> in [-6, 6], <em>c</em> in [0.0001, 0.5], <em>s</em> in [0.0001, 0.5].
</p>
</td></tr>
<tr><td><code id="BEMM.4PL_+3A_biasse">BiasSE</code></td>
<td>

<p>A logical value to determine whether directly estimating SEs from inversed Hession matrix rather than USEM method, default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Four parameter logistic (4PL) model proposed by Barton &amp; Lord's (1981). Transfer the unslipping (upper asymptote) parameter <em>d</em> to slipping parameter <em>s</em> by set <em>s=1-d</em>:
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, a, b, c, s) = c + (1 - s - c) / (1 + exp(-D * a * (\theta - b))),</code>
</p>

<p>where x=1 is the correct response; <em>theta</em> is examinne's ability. <em>a</em>, <em>b</em>, <em>c</em> and <em>s</em> are the item discrimination, difficulty guessing and slipping parameter, respectively; D is the scaling constant 1.702.
These parameter labels are <strong>capitalized</strong> in program for emphasis.  
</p>


<h3>Value</h3>

<p>This function will return a list includes following:
</p>

<dl>
<dt>Est.ItemPars</dt><dd><p>A <code>dataframe</code> consists of the estimates of <em>a</em>, <em>b</em>, <em>c</em> and <em>s</em> parameters and corresponding estimated standard errors.</p>
</dd>
<dt>Est.Theta</dt><dd><p>A <code>dataframe</code> consists of the estimates of <em>theta</em> and corresponding estimated standard errors (EAP method).</p>
</dd>
<dt>Loglikelihood</dt><dd><p>The loglikelihood.</p>
</dd>
<dt>Iteration</dt><dd><p>The number of iterations.</p>
</dd>
<dt>EM.Map</dt><dd><p>The parameter estimation history of iterations.</p>
</dd>
<dt>fits.test</dt><dd><p>The model fits information includes G2 test, AIC, BIC and RMSEA.</p>
</dd>
<dt>Elapsed.time</dt><dd><p>The running time of the program.</p>
</dd>
<dt>InitialValues</dt><dd><p>The initial values of item parameters.</p>
</dd>
</dl>



<h3>References</h3>

<p>Barton, M. A., &amp; Lord, F. M. (1981). An upper asymptote for the three-parameter logistic item response model. <em>ETS Research Report Series</em>, <em>1981</em>(1), 1-8. <a href="https://doi.org/10.1002/j.2333-8504.1981.tb01255.x">doi:10.1002/j.2333-8504.1981.tb01255.x</a>
</p>
<p>Zhang, C., Guo, S., &amp; Zheng, C. (2018, April). <em>Bayesian Expectation-Maximization-Maximization Algorithm for the 4PLM</em>. Paper presented at the 80th NCME Annual Meeting, New York, NY. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###Example: A brief simulation study###

#generate true values and response matrix
set.seed(10)
library(IRTBEMM)
I=500    #set the number of examinees is 500
J=10      #set the number of items is 10
true.a=runif(J,0.4,2)     #simulate true discrimination parameters
true.b=rnorm(J,0,1)       #simulate true difficulty parameters
true.c=rbeta(J,2,8)       #simulate true guessing parameters
true.s=rbeta(J,2,8)       #simulate true slipping parameters
true.th=rnorm(I,0,1)      #simulate true theta parameters
true.par=list(A=true.a, B=true.b, C=true.c, S=true.s)   #make a list
response=matrix(NA,I,J)       #Create a array to save response data
for (i in 1:I){
  #calucate the probability of 4PL
  P=Prob.model(X=true.th[i], Model='4PL', Par.est0=true.par, D=1.702)  
  response[i,]=rbinom(J,1,P)   #simulate the response
}

#To save example running time, we set the Tol to 0.1
#Obtain the Bayesian modal estimation (BME) using default priors

#Estimate model via BEMM algorithm
bme.res=BEMM.4PL(response, Tol=0.1) 

bme.res$Est.ItemPars       #show item estimates
bme.res$Est.Theta          #show ability estimates
bme.res$Loglikelihood      #show log-likelihood
bme.res$EM.Map             #show EM iteration history
bme.res$fits.test 		   #show model fits information


#Obtain the maximum likelihood estimation (MLE) by setting Prior=NA

#Estimate model via EMM algorithm
mle.res=BEMM.4PL(response, Tol=0.1,
		PriorA=NA, PriorB=NA, PriorC=NA, PriorS=NA)

mle.res$Est.ItemPars       #show item estimates
mle.res$Est.Theta          #show ability estimates
mle.res$Loglikelihood      #show log-likelihood
mle.res$EM.Map             #show EM iteration history
mle.res$fits.test 		   #show model fits information


</code></pre>

<hr>
<h2 id='Input.Checking'>
Checking user speciflied input variables.
</h2><span id='topic+Input.Checking'></span>

<h3>Description</h3>

<p>Based on the given model, checking whether user speciflied input variables are correct. If the input variables are acceptable, this function will format them and then return them as a <code>list</code>. Otherwise, this function will return a error message to indicate which variables are unacceptable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Input.Checking(Model, data, 
	PriorA=c(0,0.25), PriorB=c(0,4), PriorC=c(4,16), PriorS=c(4,16),
	PriorAlpha=c(-1.9,1), PriorBeta=c(0,4), PriorGamma=c(-1.39,0.25),
	InitialA=NA, InitialB=NA, InitialC=NA, InitialS=NA,
	InitialAlpha=NA, InitialBeta=NA, InitialGamma=NA,
	Tol=0.0001, max.ECycle=1000L, max.MCycle=100L, n.Quadpts=31L, n.decimal=3L, 
	Theta.lim=c(-6,6), Missing=-9, ParConstraint=FALSE, BiasSE=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Input.Checking_+3A_model">Model</code></td>
<td>
<p>A <code>character</code> to declare the type of items to be modeled. The parameter labels follow conventional use, can be:
</p>

<ul>
<li><p>  '3PL' - Three parameter logistic (3PL) model proposed by Birnbaum(1968):
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, a, b, c) = c + (1 - c) / (1 + exp(-D * a * (\theta - b)))</code>
</p>

<p>where x=1 is the correct response, <em>theta</em> is examinne's ability; <em>a</em>, <em>b</em> and <em>c</em> are the item discrimination, difficulty and guessing parameter, respectively; D is the scaling constant 1.702.
</p>
</li>
<li><p>  '4PL' - Four parameter logistic (4PL) model proposed by Barton &amp; Lord's(1981). Transfer the unslipping (upper asymptote) parameter <em>d</em> to slipping parameter <em>s</em> by set <em>s=1-d</em>:
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, a, b, c, s) = c + (1 - s - c) / (1 + exp(-D * a * (\theta - b)))</code>
</p>

<p>where x=1 is the correct response; <em>theta</em> is examinne's ability. <em>a</em>, <em>b</em>, <em>c</em> and <em>s</em> are the item discrimination, difficulty guessing and slipping parameter, respectively; D is the scaling constant 1.702.
</p>
</li>
<li><p>  '1PLG' - One parameter logsitc guessing (1PLG) model proposed by San Martín et al.(2006). Let <em>invlogit(x)=1 / (1 + exp(-x))</em>: 
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, \beta, \gamma) = invlogit(\theta - \beta) + (1 - invlogit(\theta - \beta)) * invlogit(\gamma)</code>
</p>

<p>where x=1 is the correct response, <em>theta</em> is examinne's ability; <em>beta</em> and <em>gamma</em> are the item difficulty and guessing parameter, respectively.
</p>
</li>
<li><p>  '1PLAG' - One parameter logsitc ability-based guessing (1PLAG) model proposed by San Martín et al.(2006). Let <em>invlogit(x)=1 / (1 + exp(-x))</em>:
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, \alpha, \beta, \gamma) = invlogit(\theta - \beta) + (1 - invlogit(\theta - \beta)) * invlogit(\alpha * \theta + \gamma)</code>
</p>

<p>where x=1 is the correct response, <em>theta</em> is examinne's ability; <em>alpha</em> is the weight of the ability in the guessing component; <em>beta</em> and <em>gamma</em> are the item difficulty and guessing parameter, respectively.
</p>
</li></ul>

<p>These parameter labels are <strong>capitalized</strong> in program for emphasis.
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_data">data</code></td>
<td>

<p>A <code>matrix</code> or <code>data.frame</code> consists of dichotomous data (1 for correct and 0 for wrong response), with missing data coded as in Missing (by default, Missing=-9). Each row of data represents a examinne' responses, and each column represents an item.
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_priora">PriorA</code></td>
<td>
<p>The user specified <strong>logarithmic normal distribution</strong> prior for item discrimation (<em>a</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of logarithmic normal distribution for all <em>a</em> parameters. By default, PriorA=c(0,0.25), which means a log normal prior of mean=0 and variance=0.25 will be used for all item discrimation parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item discrimation parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of log normal prior (mean and variance) for single item <em>a</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_priorb">PriorB</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for item difficulty (<em>b</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of normal distribution for all <em>b</em> parameters. By default, PriorB=c(0,4), which means a normal prior of mean=0 and variance=4 will be used for all item difficulty parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item difficulty parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of normal prior (mean and variance) for single item <em>b</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_priorc">PriorC</code></td>
<td>

<p>The user specified <strong>Beta(x,y) distribution</strong> prior for item guessing (<em>c</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters x and y of Beta distribution for all <em>c</em> parameters. By default, PriorC=c(4,16), which means a Beta prior of mean=4/(4+16)=0.2 and variance=0.008 will be used for all item guessing parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item guessing parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of Beta prior (x and y) for single item <em>c</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_priors">PriorS</code></td>
<td>

<p>The user specified <strong>Beta(x,y) distribution</strong> prior for item slipping (<em>s</em>) parameters in the 4PL model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters x and y of Beta distribution for all <em>s</em> parameters. By default, PriorS=c(4,16), which means a Beta prior of mean=4/(4+16)=0.2 and variance=0.008 will be used for all item slipping parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item slipping parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of Beta prior (x and y) for single item <em>s</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_prioralpha">PriorAlpha</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for the logarithmic weight of the ability in the guessing component (<em>ln(alpha</em>)) parameter in the 1PLAG model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters normal distribution for all <em>log(alpha)</em> parameters. By default, PriorAlpha=c(-1.9,1), which means a Normal prior of mean=-1.9 and variance=1 will be used for the logarithmic weight of the ability.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for the weight of the ability will be obtained.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_priorbeta">PriorBeta</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for item difficulty (<em>beta</em>) parameters in the 1PLAG and 1PLG model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of normal distribution for all <em>beta</em> parameters. By default, PriorBeta=c(0,4), which means a normal prior of mean=0 and variance=4 will be used for all item difficulty parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item difficulty parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of normal prior (mean and variance) for single item <em>beta</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_priorgamma">PriorGamma</code></td>
<td>

<p>The user specified <strong>normal distribution</strong> prior for item guessing (<em>gamma</em>) parameters in the 1PLAG and 1PLG model. Can be:
</p>
	
<ul>
<li><p> A <code>numeric</code> with two hyperparameters mean and variance of normal distribution for all <em>gamma</em> parameters. By default, PriorGamma=c(-1.39,0.25), which means a normal prior of mean=-1.39 and variance=0.25 will be used for all item guessing parameters.
</p>
</li>
<li><p> A <code>NA</code>, refers to no priors will be used, so maximum likelihood estimates for item guessing parameter will be obtained.
</p>
</li>
<li><p> A <code>matrix</code> with two columns, and each row of matrix consists of two hyperparameters of normal prior (mean and variance) for single item <em>gamma</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_initiala">InitialA</code></td>
<td>

<p>The user specified starting values for item discrimation (<em>a</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>a</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>a</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>a</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_initialb">InitialB</code></td>
<td>

<p>The user specified starting values for item difficulty (<em>b</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>b</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>b</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>b</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_initialc">InitialC</code></td>
<td>

<p>The user specified starting values for item guessing (<em>c</em>) parameters in the 3PL and 4PL models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>c</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>c</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>c</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_initials">InitialS</code></td>
<td>

<p>The user specified starting values for item slipping (<em>s</em>) parameters in the 4PL model. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>s</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>s</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>s</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_initialalpha">InitialAlpha</code></td>
<td>

<p>The user specified starting value for the weight of the ability in the guessing component (<em>alpha</em>) parameters in the 1PLAG model. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>alpha</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting value of <em>alpha</em>.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_initialbeta">InitialBeta</code></td>
<td>

<p>The user specified starting values for item difficulty (<em>beta</em>) parameters in the 1PLAG and 1PLG models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>beta</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>beta</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>beta</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_initialgamma">InitialGamma</code></td>
<td>

<p>The user specified starting values for item guessing (<em>gamma</em>) parameters in the 1PLAG and 1PLG models. Can be:
</p>
	
<ul>
<li><p> A <code>NA</code> (default), refers to no specified starting values for <em>gamma</em> parameter.
</p>
</li>
<li><p> A single number (<code>numeric</code>), refers to set this number to be the starting values of <em>gamma</em> for all items.
</p>
</li>
<li><p> A <code>numeric</code> consists of starting values for each <em>gamma</em> parameter.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Input.Checking_+3A_tol">Tol</code></td>
<td>

<p>A single number (<code>numeric</code>), refers to convergence threshold for E-step cycles; defaults are 0.0001.
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_max.ecycle">max.ECycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of E-step cycles; defaults are 2000L.
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_max.mcycle">max.MCycle</code></td>
<td>

<p>A single <code>integer</code>, refers to maximum number of M-step cycles; defaults are 100L.
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_n.quadpts">n.Quadpts</code></td>
<td>

<p>A single <code>integer</code>, refers to number of quadrature points per dimension (must be larger than 5); defaults are 31L.
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_n.decimal">n.decimal</code></td>
<td>

<p>A single <code>integer</code>, refers to number of decimal places when outputs results.
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_theta.lim">Theta.lim</code></td>
<td>

<p>A <code>numeric</code> with two number, refers to the range of integration grid for each dimension; default is c(-6, 6).
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_missing">Missing</code></td>
<td>

<p>A single number (<code>numeric</code>) to indicate which elements are missing; default is -9. The Missing cannot be 0 or 1.
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_parconstraint">ParConstraint</code></td>
<td>

<p>A logical value to indicate whether estimates parametes in a reasonable range; default is FALSE. If ParConstraint=TRUE: <em>a</em> in [0.001, 6], <em>b</em> in [-6, 6], <em>c</em> in [0.0001, 0.5], <em>s</em> in [0.0001, c], <em>alpha</em> in [0, 0.707], <em>beta</em> in [-6, 6], <em>gamma</em> in [-7, 0].
</p>
</td></tr>
<tr><td><code id="Input.Checking_+3A_biasse">BiasSE</code></td>
<td>

<p>A logical value to determine whether directly estimating SEs from inversed Hession matrix rather than USEM method, default is FALSE.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Barton, M. A., &amp; Lord, F. M. (1981). An upper asymptote for the three-parameter logistic item response model. <em>ETS Research Report Series</em>, <em>1981</em>(1), 1-8. <a href="https://doi.org/10.1002/j.2333-8504.1981.tb01255.x">doi:10.1002/j.2333-8504.1981.tb01255.x</a>
</p>
<p>Birnbaum, A. (1968). <em>Some latent trait models and their use in inferring an examinee's ability</em>. In F. M. Lord &amp; M. R. Novick (Eds.), Statistical theories of mental test scores (pp. 395-479). MA: Adison-Wesley.
</p>
<p>San Martín, E., Del Pino, G., &amp; De Boeck, P. (2006). IRT models for ability-based guessing. <em>Applied Psychological Measurement</em>, <em>30</em>(3), 183-203. <a href="https://doi.org/10.1177/0146621605282773">doi:10.1177/0146621605282773</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#An example to show the error message when the variance of a normal prior is negative.
library(IRTBEMM)
#generate a response matrix with 1000 examinees and 10 items randomly
data=matrix(rbinom(10000,1,0.5), 1000, 10)  
#test whether variable data is correct.
res=Input.Checking('3PL',data)   

</code></pre>

<hr>
<h2 id='Prob.model'>
Calculate the probabilites based on a given model and parameters.
</h2><span id='topic+Prob.model'></span>

<h3>Description</h3>

<p>Based on the given model, return the correct probabilities of a single examinne with ability X answering each item.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prob.model(X, Model, Par.est0, D=1.702)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Prob.model_+3A_x">X</code></td>
<td>
<p>A <code>numeric</code> with length=1 consists of an examinee's ability theta.</p>
</td></tr>
<tr><td><code id="Prob.model_+3A_model">Model</code></td>
<td>
<p>A <code>character</code> to declare the type of items to be modeled. The parameter labels follow conventional uses, can be:
</p>

<ul>
<li><p>  '3PL' - Three parameter logistic (3PL) model proposed by Birnbaum(1968):
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, a, b, c) = c + (1 - c) / (1 + exp(-D * a * (\theta - b)))</code>
</p>

<p>where x=1 is the correct response, <em>theta</em> is examinne's ability; <em>a</em>, <em>b</em> and <em>c</em> are the item discrimination, difficulty and guessing parameter, respectively; D is the scaling constant 1.702.
</p>
</li>
<li><p>  '4PL' - Four parameter logistic (4PL) model proposed by Barton &amp; Lord's(1981). Transfer the unslipping (upper asymptote) parameter <em>d</em> to slipping parameter <em>s</em> by set <em>s=1-d</em>:
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, a, b, c, s) = c + (1 - s - c) / (1 + exp(-D * a * (\theta - b)))</code>
</p>

<p>where x=1 is the correct response; <em>theta</em> is examinne's ability. <em>a</em>, <em>b</em>, <em>c</em> and <em>s</em> are the item discrimination, difficulty guessing and slipping parameter, respectively; D is the scaling constant 1.702.
</p>
</li>
<li><p>  '1PLG' - One parameter logsitc guessing (1PLG) model proposed by San Martín et al.(2006). Let <em>invlogit(x)=1 / (1 + exp(-x))</em>: 
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, \beta, \gamma) = invlogit(\theta - \beta) + (1 - invlogit(\theta - \beta)) * invlogit(\gamma)</code>
</p>

<p>where x=1 is the correct response, <em>theta</em> is examinne's ability; <em>beta</em> and <em>gamma</em> are the item difficulty and guessing parameter, respectively.
</p>
</li>
<li><p>  '1PLAG' - One parameter logsitc ability-based guessing (1PLAG) model proposed by San Martín et al.(2006). Let <em>invlogit(x)=1 / (1 + exp(-x))</em>:
</p>
<p style="text-align: center;"><code class="reqn">P(x = 1|\theta, \alpha, \beta, \gamma) = invlogit(\theta - \beta) + (1 - invlogit(\theta - \beta)) * invlogit(\alpha * \theta + \gamma)</code>
</p>

<p>where x=1 is the correct response, <em>theta</em> is examinne's ability; <em>alpha</em> is the weight of the ability in the guessing component; <em>beta</em> and <em>gamma</em> are the item difficulty and guessing parameter, respectively.
</p>
</li></ul>

<p>These parameter labels are <strong>capitalized</strong> in program for emphasis.</p>
</td></tr>
<tr><td><code id="Prob.model_+3A_par.est0">Par.est0</code></td>
<td>
<p>A <code>list</code> that consists of item parameters for each item based on the given model. Can be:
</p>

<ul>
<li><p> For 3PL model, <strong>list(A, B, C)</strong> - A, B, C are <code>numeric</code> refer to item discrimination, difficulty and pseudo guessing parameters for each item, respectively.
</p>
</li>
<li><p> For 4PL model, <strong>list(A, B, C, S)</strong> - A, B, C, S are <code>numeric</code> refer to item discrimination, difficulty, pseudo guessing and slipping parameters for each item, respectively.
</p>
</li>
<li><p> For 1PLG model, <strong>list(Beta, Gamma)</strong> - Beta, Gamma are <code>numeric</code> refer to item difficulty and guessing (on the logistic scales) parameters for each item, respectively.
</p>
</li>
<li><p> For 1PLAG model, <strong>list(Alpha, Beta, Gamma)</strong> - Alpha refers to the weight of the ability in the guessing component, and Beta and Gamma are <code>numeric</code> refer to item difficulty and guessing (on the logistic scales) parameters for each item, respectively.
</p>
</li></ul>

<p>Please note these <strong>capitalized</strong> parameter lables are transformed from the Model section.
</p>
</td></tr>
<tr><td><code id="Prob.model_+3A_d">D</code></td>
<td>
<p>A single <code>numeric</code> refers to the scaling constant only used in the 3PL and 4PL model. By default, D=1.702.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> consists of the correct probabilities of a single examinne with ability X answering each item.
</p>


<h3>References</h3>

<p>Barton, M. A., &amp; Lord, F. M. (1981). An upper asymptote for the three-parameter logistic item response model. <em>ETS Research Report Series</em>, <em>1981</em>(1), 1-8. <a href="https://doi.org/10.1002/j.2333-8504.1981.tb01255.x">doi:10.1002/j.2333-8504.1981.tb01255.x</a>
</p>
<p>Birnbaum, A. (1968). <em>Some latent trait models and their use in inferring an examinee's ability</em>. In F. M. Lord &amp; M. R. Novick (Eds.), Statistical theories of mental test scores (pp. 395-479). MA: Adison-Wesley.
</p>
<p>San Martín, E., Del Pino, G., &amp; De Boeck, P. (2006). IRT models for ability-based guessing. <em>Applied Psychological Measurement</em>, <em>30</em>(3), 183-203. <a href="https://doi.org/10.1177/0146621605282773">doi:10.1177/0146621605282773</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Obtain the correct probabilities of five 3PL model items when theta=1.2 and D=1.702. 
library(IRTBEMM)
th=1.2                           #Examinee's ability parameter theta
A=c(1.5, 2, 0.5, 1.2, 0.4)       #item discrimination parameters
B=c(-0.5, 0, 1.5, 0.3, 2.8)      #item difficulty parameters
C=c(0.1, 0.2, 0.3, 0.15, 0.25)   #item pseudo guessing parameters
Par3PL=list(A=A, B=B, C=C)       #Create a list for 3PL
P.3pl=Prob.model(X=th, Model='3PL', Par.est0=Par3PL)   #Obtain the 3PL probabilities

#Obtain the correct probabilities of five 4PL model items when theta=1.2 and D=1. 
S=c(0.3, 0.1, 0.13, 0.09, 0.05)  #item pseudo slipping parameters
Par4PL=list(A=A, B=B, C=C, S=S)  #Create a list for 4PL
P.4pl=Prob.model(X=th, Model='4PL', Par.est0=Par4PL, D=1)   #Obtain the 4PL probabilities

#Obtain the correct probabilities of three 1PLG model items when theta=0.3.
th=0.3
Beta=c(0.8, -1.9, 2.4)
Gamma=c(-1.31, -0.89, -0.18)
Par1PLG=list(Beta=Beta, Gamma=Gamma)                 #Create a list for 1PLG
P.1plg=Prob.model(X=th, Model='1PLG', Par.est0=Par1PLG)   #Obtain the 1PLG probabilities

#Obtain the correct probabilities of three 1PLAG model items when theta=0.3.
Alpha=0.2
Par1PLAG=list(Alpha=Alpha, Beta=Beta, Gamma=Gamma)     #Create a list for 1PLAG
P.1plag=Prob.model(X=th, Model='1PLAG', Par.est0=Par1PLAG)   #Obtain the 1PLAG probabilities


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
