<!DOCTYPE html><html><head><title>Help for package SimComp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SimComp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coagulation'>
<p>Data from a clinical study of three sets of extracorporeal circulation</p>
in heart-lung machines</a></li>
<li><a href='#DfSattDiff'>
<p>Degrees of Freedom Accoding to Satterthwaite (1946) for Differences of Means</p></a></li>
<li><a href='#DfSattRat'>
<p>Degrees of Freedom Accoding to Satterthwaite (1946) for Ratios of Means</p></a></li>
<li><a href='#ermvnorm'><p> Multivariate Normal Random Numbers with Exact Parameters</p></a></li>
<li><a href='#plot.SimCi'><p> Plot function for SimCi-objects</p></a></li>
<li><a href='#print.SimCi'><p> Print function for SimCi-objects</p></a></li>
<li><a href='#print.SimTest'><p> Print function for SimTest-objects</p></a></li>
<li><a href='#rcm'><p> Random Correlation Matrices</p></a></li>
<li><a href='#SimCiDiff'><p> Simultaneous Confidence Intervals for General Contrasts (Differences) of</p>
Means of Multiple Endpoints</a></li>
<li><a href='#SimCiRat'><p> Simultaneous Confidence Intervals for General Contrasts (Ratios) of Means</p>
of Multiple Endpoints</a></li>
<li><a href='#SimComp-package'>
<p>Simultaneous Comparisons for Multiple Endpoints</p></a></li>
<li><a href='#SimTestDiff'><p> Simultaneous Tests for General Contrasts (Differences) of Means of</p>
Multiple Endpoints</a></li>
<li><a href='#SimTestRat'><p> Simultaneous Tests for General Contrasts (Ratios) of Means of Multiple</p>
Endpoints</a></li>
<li><a href='#summary.SimCi'><p> Summary function for SimCi-objects</p></a></li>
<li><a href='#summary.SimTest'><p> Summary function for SimTest-objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simultaneous Comparisons for Multiple Endpoints</td>
</tr>
<tr>
<td>Version:</td>
<td>3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-08-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Mario Hasler, Christof Kluss</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mario Hasler &lt;hasler@email.uni-kiel.de&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, multcomp, mratios, graphics, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Simultaneous tests and confidence intervals are provided for one-way experimental designs with one or many normally distributed, primary response variables (endpoints). Differences (Hasler and Hothorn, 2011 &lt;<a href="https://doi.org/10.2202%2F1557-4679.1258">doi:10.2202/1557-4679.1258</a>&gt;) or ratios (Hasler and Hothorn, 2012 &lt;<a href="https://doi.org/10.1080%2F19466315.2011.633868">doi:10.1080/19466315.2011.633868</a>&gt;) of means can be considered. Various contrasts can be chosen, unbalanced sample sizes are allowed as well as heterogeneous variances (Hasler and Hothorn, 2008 &lt;<a href="https://doi.org/10.1002%2Fbimj.200710466">doi:10.1002/bimj.200710466</a>&gt;) or covariance matrices (Hasler, 2014 &lt;<a href="https://doi.org/10.1515%2Fijb-2012-0015">doi:10.1515/ijb-2012-0015</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-26 13:46:48 UTC; Administrator</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-26 14:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='coagulation'>
Data from a clinical study of three sets of extracorporeal circulation
in heart-lung machines
</h2><span id='topic+coagulation'></span>

<h3>Description</h3>

<p>Three sets of extracorporeal circulation in heart-lung machines: treatments H and B, and
standard S. Twelve (S and H each) and eleven (B) male adult patients have been considered.
The analysis is based on a set of laboratory parameters restricted to the blood
coagulation system, characterized by three primary endpoints (each as quotient from post-
and pre-surgery values). Higher values indicate a better treatment effect. For more
details, see Kropf et al. (2000).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coagulation)</code></pre>


<h3>Format</h3>

<p>A data frame with 35 observations on the following 5 variables.
</p>

<dl>
<dt><code>Patient</code></dt><dd><p>a numeric vector, the patients' number</p>
</dd>
<dt><code>Thromb.count</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ADP</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>TRAP</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Group</code></dt><dd><p>a factor with levels <code>B</code>, <code>H</code>, <code>S</code>
specifying the treatments, where <code>S</code> is the standard</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kropf, S. et al. (2000): Multiple comparisons of treatments with stable multivariate tests
in a two-stage adaptive design, including a test for non-inferiority. <em>Biometrical
Journal</em> 42, 951-965.
</p>


<h3>References</h3>

<p>Hasler, M. and Hothorn, L.A. (2011): A Dunnett-type procedure for multiple endpoints.
<em>The International Journal of Biostatistics</em> 7, Article 3, &lt;doi:10.2202/1557-4679.1258&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(coagulation)
str(coagulation)
</code></pre>

<hr>
<h2 id='DfSattDiff'> 
Degrees of Freedom Accoding to Satterthwaite (1946) for Differences of Means 
</h2><span id='topic+DfSattDiff'></span>

<h3>Description</h3>

<p>Degrees of freedom accoding to Satterthwaite (1946) for (multivariate)
<em>t</em>-distributions related to multiple contrast tests or corresponding
simultaneous confidence intervals for differences of means. For contrasts 
representing a two-sample <em>t</em>-test, the degree of freedom coincides 
with the one of Welch (1938).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfSattDiff(n, sd, type = "Dunnett", base = 1, ContrastMat = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DfSattDiff_+3A_n">n</code></td>
<td>
<p> a vector of numbers of observations </p>
</td></tr>
<tr><td><code id="DfSattDiff_+3A_sd">sd</code></td>
<td>
<p> a vector of standard deviations </p>
</td></tr>
<tr><td><code id="DfSattDiff_+3A_type">type</code></td>
<td>
<p> a character string, defining the type of contrast, with the following
options:
</p>

<ul>
<li><p> &quot;Dunnett&quot;: many-to-one comparisons
</p>
</li>
<li><p> &quot;Tukey&quot;: all-pair comparisons
</p>
</li>
<li><p> &quot;Sequen&quot;: comparisons of consecutive groups
</p>
</li>
<li><p> &quot;AVE&quot;: comparison of each group with average of all others
</p>
</li>
<li><p> &quot;GrandMean&quot;: comparison of each group with grand mean of all
groups
</p>
</li>
<li><p> &quot;Changepoint&quot;: differences of averages of groups of higher
order to averages of groups of lower order
</p>
</li>
<li><p> &quot;Marcus&quot;: Marcus contrasts
</p>
</li>
<li><p> &quot;McDermott&quot;: McDermott contrasts
</p>
</li>
<li><p> &quot;Williams&quot;: Williams trend tests
</p>
</li>
<li><p> &quot;UmbrellaWilliams&quot;: Umbrella-protected Williams trend tests
</p>
</li></ul>

<p>note that <code>type</code> is ignored if <code>ContrastMat</code> is specified
by the user (see below) </p>
</td></tr>
<tr><td><code id="DfSattDiff_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control group for Dunnett contrasts,
ignored otherwise </p>
</td></tr>
<tr><td><code id="DfSattDiff_+3A_contrastmat">ContrastMat</code></td>
<td>
<p> a contrast matrix, where columns correspond to groups and rows
correspond to contrasts </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation of critical values or (adjusted) <em>p</em>-values related to multiple
contrast tests or corresponding simultaneous confidence intervals is based on a
multivariate <em>t</em>-distribution. For homoscedastic data, the respective degree of
freedom only depends on the total sample size and the number of groups. A simple and
well-known special case is the usual <em>t</em>-test. If the data are heteroscedastic,
however, the degree of freedom of a <em>t</em>-test must be decreased according to 
Welch (1938) to come to an approximate solution. Degrees of freedom according to 
Satterthwaite (1946) refer to any linear combinations (contrasts) of normal means. 
They are applied, for example, when doing multiple contrast tests for heteroscedastic 
data according to Hasler and Hothorn (2008) &lt;doi:10.1002/bimj.200710466&gt; or 
Hasler (2014) &lt;doi:10.1515/ijb-2012-0015&gt;. Like Welch (1938), Satterthwaite (1946) 
approximated the degree of freedom by matching first and second moments. The 
resulting degree of freedom then depends on the contrast and on the sample sizes and 
sample variances per group.
</p>


<h3>Value</h3>

<p>A vector of degrees of freedom.
</p>


<h3>Note</h3>

<p>The commands <code>SimTestDiff()</code> and <code>SimCiDiff()</code> use these degrees of freedom 
automatically if <code>covar.equal=FALSE</code> (default). You don't need to apply 
<code>DfSattDiff()</code> additionally.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>References</h3>

<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17&ndash;28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793&ndash;800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>
<p>Satterthwaite, F.E. (1946): An approximate distribution of estimates of variance
components. <em>Biometrics</em> 2, 110&ndash;114.
</p>
<p>Welch, B.L. (1938): The significance of the difference between two means when the
population variances are unequal. <em>Biometrika</em> 29, 350&ndash;362.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+DfSattRat">DfSattRat</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Degrees of freedom for a comparison of group two and three against group one, assuming
# unequal standard deviations for the groups. This is an extension for the well-known
# Dunnett-test to the case of heteroscedasticity.

# Either by specifying the type of contrast:
DfSattDiff(n=c(10,6,6), sd=c(1,3,6), type="Dunnett", base=1)

# Or by specifying the contrast matrix:
DfSattDiff(n=c(10,6,6), sd=c(1,3,6), ContrastMat=rbind(c(-1,1,0),c(-1,0,1)))

# Example 2:
# Degrees of freedom for an all-pair comparison of the groups B, H and S on endpoint ADP,
# assuming unequal standard deviations for the groups. This is an extension for the well-
# known Tukey-test to the case of heteroscedasticity. The same degrees of freedom are 
# used automatically by command \code{SimTestDiff()}.

data(coagulation)

DfSattDiff(n=tapply(X=coagulation$ADP, INDEX=coagulation$Group, FUN=length),
  sd=tapply(X=coagulation$ADP, INDEX=coagulation$Group, FUN=sd),
  type="Tukey")
</code></pre>

<hr>
<h2 id='DfSattRat'> 
Degrees of Freedom Accoding to Satterthwaite (1946) for Ratios of Means 
</h2><span id='topic+DfSattRat'></span>

<h3>Description</h3>

<p>Degrees of freedom accoding to Satterthwaite (1946) for (multivariate)
<em>t</em>-distributions related to multiple contrast tests or corresponding
simultaneous confidence intervals for ratios of means. For contrasts 
representing a two-sample <em>t</em>-test, the degree of freedom coincides 
with the one of Welch (1938).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfSattRat(n, sd, type = "Dunnett", base = 1, Num.Contrast = NULL, Den.Contrast = NULL,
          Margin = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DfSattRat_+3A_n">n</code></td>
<td>
<p> a vector of numbers of observations </p>
</td></tr>
<tr><td><code id="DfSattRat_+3A_sd">sd</code></td>
<td>
<p> a vector of standard deviations </p>
</td></tr>
<tr><td><code id="DfSattRat_+3A_type">type</code></td>
<td>
<p> a character string, defining the type of contrast, with the following
options:
</p>

<ul>
<li><p> &quot;Dunnett&quot;: many-to-one comparisons
</p>
</li>
<li><p> &quot;Tukey&quot;: all-pair comparisons
</p>
</li>
<li><p> &quot;Sequen&quot;: comparisons of consecutive groups
</p>
</li>
<li><p> &quot;AVE&quot;: comparison of each group with average of all others
</p>
</li>
<li><p> &quot;GrandMean&quot;: comparison of each group with grand mean of all
groups
</p>
</li>
<li><p> &quot;Changepoint&quot;: differences of averages of groups of higher
order to averages of groups of lower order
</p>
</li>
<li><p> &quot;Marcus&quot;: Marcus contrasts
</p>
</li>
<li><p> &quot;McDermott&quot;: McDermott contrasts
</p>
</li>
<li><p> &quot;Williams&quot;: Williams trend tests
</p>
</li>
<li><p> &quot;UmbrellaWilliams&quot;: Umbrella-protected Williams trend tests
</p>
</li></ul>

<p>note that <code>type</code> is ignored if <code>Num.Contrast</code> or 
<code>Den.Contrast</code> is specified by the user (see below) </p>
</td></tr>
<tr><td><code id="DfSattRat_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control group for Dunnett contrasts,
ignored otherwise </p>
</td></tr>
<tr><td><code id="DfSattRat_+3A_num.contrast">Num.Contrast</code></td>
<td>
<p> a numerator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="DfSattRat_+3A_den.contrast">Den.Contrast</code></td>
<td>
<p> a denominator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="DfSattRat_+3A_margin">Margin</code></td>
<td>
<p> a single numeric value, or a numeric vector with length equal to
the number of contrasts, default is 1 </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation of critical values or (adjusted) <em>p</em>-values related to multiple
contrast tests or corresponding simultaneous confidence intervals is based on a
multivariate <em>t</em>-distribution. For homoscedastic data, the respective degree of
freedom only depends on the total sample size and the number of groups. A simple and
well-known special case is the usual <em>t</em>-test. If the data are heteroscedastic,
however, the degree of freedom of a <em>t</em>-test must be decreased according to 
Welch (1938) to come to an approximate solution. Degrees of freedom according to
Satterthwaite (1946) refer to any linear combinations (contrasts) of normal means.
They are applied, for example, when doing multiple contrast tests for heteroscedastic
data according to Hasler and Hothorn (2008) &lt;doi:10.1002/bimj.200710466&gt; or 
Hasler (2014) &lt;doi:10.1515/ijb-2012-0015&gt;. Like Welch (1938), Satterthwaite (1946) 
approximated the degree of freedom by matching first and second moments. The 
resulting degree of freedom then depends on the numerator contrast, the denominator 
contrast, the (relative) margin to test against, and on the sample sizes and sample 
variances per group. If <code>Margin=1</code> or <code>Margin=NULL</code> (default), 
the result coincides with the result of <code>DfSattDiff()</code>.
</p>


<h3>Value</h3>

<p>A vector of degrees of freedom.
</p>


<h3>Note</h3>

<p>The commands <code>SimTestRat()</code> and <code>SimCiRat()</code> use these degrees of freedom 
automatically if <code>covar.equal=FALSE</code> (default). You don't need to apply 
<code>DfSattRat()</code> additionally.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>References</h3>

<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17&ndash;28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793&ndash;800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>
<p>Satterthwaite, F.E. (1946): An approximate distribution of estimates of variance
components. <em>Biometrics</em> 2, 110&ndash;114.
</p>
<p>Welch, B.L. (1938): The significance of the difference between two means when the
population variances are unequal. <em>Biometrika</em> 29, 350&ndash;362.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+DfSattDiff">DfSattDiff</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Degrees of freedom for a non-inferiority test of group two and three against group one,
# assuming unequal standard deviations for the groups. This is an extension for the well-
# known Dunnett-test to the case of heteroscedasticity and in terms of ratios of means
# instead of differences.

# Either by specifying the type of contrast:
DfSattRat(n=c(10,6,6), sd=c(1,3,6), type="Dunnett", base=1, Margin=0.8)

# Or by specifying the contrast matrices:
DfSattRat(n=c(10,6,6), sd=c(1,3,6), Num.Contrast=rbind(c(0,1,0),c(0,0,1)),
  Den.Contrast=rbind(c(1,0,0),c(1,0,0)), Margin=0.8)

# Example 2:
# Degrees of freedom for an all-pair comparison of the groups B, H and S on endpoint ADP,
# assuming unequal standard deviations for the groups. This is an extension for the well-
# known Tukey-test to the case of heteroscedasticity and in terms of ratios of means
# instead of differences. The same degrees of freedom are used automatically by command 
# \code{SimTestRat()}.

data(coagulation)

DfSattRat(n=tapply(X=coagulation$ADP, INDEX=coagulation$Group, FUN=length),
  sd=tapply(X=coagulation$ADP, INDEX=coagulation$Group, FUN=sd),
  type="Tukey")
</code></pre>

<hr>
<h2 id='ermvnorm'> Multivariate Normal Random Numbers with Exact Parameters </h2><span id='topic+ermvnorm'></span>

<h3>Description</h3>

<p>Random numbers of the multivariate normal distribution with EXACT mean vector, EXACT
variance vector and approximate correlation matrix. This function is based on the
function <code>rmvnorm</code> of the package <span class="pkg">mvtnorm</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ermvnorm(n, mean, sd, corr = diag(rep(1, length(mean))), mnt = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ermvnorm_+3A_n">n</code></td>
<td>
<p> a number of observations </p>
</td></tr>
<tr><td><code id="ermvnorm_+3A_mean">mean</code></td>
<td>
<p> a mean vector </p>
</td></tr>
<tr><td><code id="ermvnorm_+3A_sd">sd</code></td>
<td>
<p> a vector of standard deviations </p>
</td></tr>
<tr><td><code id="ermvnorm_+3A_corr">corr</code></td>
<td>
<p> a correlation matrix </p>
</td></tr>
<tr><td><code id="ermvnorm_+3A_mnt">mnt</code></td>
<td>
<p> a maximum number of tries for the computation </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unfortunately, it's very common to present only summary statistics in the literature
when evaluating real data. This makes it hard to retrace or to verify the related
statistical evaluation. Also, the use of such data as an example for other
statistical tests is hardly possible. For that reason, <code>ermvnorm</code> allows to
reproduce data by simulation. In contrast to <code>rmvnorm</code> of the package mvtnorm,
the function <code>ermvnorm</code> produces random numbers which have EXACTLY the same
paramer values as specified by <code>mean</code> and <code>sd</code>. The correlation matrix
<code>corr</code> is met only approximately.
</p>
<p>The simple idea behind <code>ermvnorm</code> is to apply <code>rmvnorm</code> of the package
mvtnorm, but only for the first n-2 random numbers. The remaining 2 numbers are
obtained by solving a quadratic equation to achieve the specified values for the
mean vector and for the vector of standard deviations. Depending on the n-2 random
numbers, the underlying quadratic equation can possibly have no solution. In this
case, <code>ermvnorm</code> creates a new set of n-2 random numbers until a valid data
set is obtained, or until the maximum number of tries <code>mnt</code> is reached.
</p>


<h3>Value</h3>

<p>A matrix of random numbers with dimension n * length(mean).
</p>


<h3>Note</h3>

<p>This function is to be used only with caution. Usually, random numbers with exact
mean and standard deviation are not intended to be used. For example, simulations
concerning type I error or power of statistical tests cannot be based on
<code>ermvnorm</code>.
</p>


<h3>Author(s)</h3>

<p> Gemechis Djira Dilba and Mario Hasler</p>


<h3>References</h3>

<p>Hothorn, T. et al. (2001): On Multivariate <em>t</em> and Gauss Probabilities in R.
<em>R News</em> 1, 27&ndash;29.
</p>


<h3>See Also</h3>

 <p><code><a href="mvtnorm.html#topic+rmvnorm">rmvnorm</a></code>, <code><a href="#topic+rcm">rcm</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# A dataset representing one endpoint.

set.seed(1234)
dataset1 &lt;- ermvnorm(n=10,mean=100,sd=10)
dataset1
mean(dataset1)
sd(dataset1)

# Example 2:
# A dataset representing two correlated endpoints.

set.seed(5678)
dataset2 &lt;- ermvnorm(n=10,mean=c(10,120),sd=c(1,10),corr=rbind(c(1,0.7),c(0.7,1)))
dataset2
mean(dataset2[,1]); mean(dataset2[,2])
sd(dataset2[,1]); sd(dataset2[,2])
round(cor(dataset2),3)
pairs(dataset2)

# Example 3:
# A dataset representing three uncorrelated endpoints.

set.seed(9101)
dataset3 &lt;- ermvnorm(n=20,mean=c(1,12,150),sd=c(0.5,2,20))
dataset3
mean(dataset3[,1]); mean(dataset3[,2]); mean(dataset3[,3])
sd(dataset3[,1]); sd(dataset3[,2]); sd(dataset3[,3])
pairs(dataset3)

# Example 4:
# A dataset representing four randomly correlated endpoints.

set.seed(1121)
dataset4 &lt;- ermvnorm(n=10,mean=c(2,10,50,120),sd=c(1,4,8,10),corr=rcm(ncol=4))
dataset4
mean(dataset4[,1]); mean(dataset4[,2]); mean(dataset4[,3]); mean(dataset4[,4])
sd(dataset4[,1]); sd(dataset4[,2]); sd(dataset4[,3]); sd(dataset4[,4])
round(cor(dataset4),3)
pairs(dataset4)
</code></pre>

<hr>
<h2 id='plot.SimCi'> Plot function for SimCi-objects </h2><span id='topic+plot.SimCi'></span>

<h3>Description</h3>

<p>A plot of the results of <code>SimCiDiff</code> and <code>SimCiRat</code>,
respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SimCi'
plot(x, xlim, xlab, ylim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SimCi_+3A_x">x</code></td>
<td>
<p> an object of class &quot;SimCi&quot; as obtained by calling
<code>SimCiDiff</code> or <code>SimCiRat</code> </p>
</td></tr>
<tr><td><code id="plot.SimCi_+3A_xlim">xlim</code></td>
<td>
<p> a numeric vector of length 2, giving the x coordinate range </p>
</td></tr>
<tr><td><code id="plot.SimCi_+3A_xlab">xlab</code></td>
<td>
<p> a title for the x axis </p>
</td></tr>
<tr><td><code id="plot.SimCi_+3A_ylim">ylim</code></td>
<td>
<p> a numeric vector of length 2, giving the y coordinate range </p>
</td></tr>
<tr><td><code id="plot.SimCi_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <code>plot</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p> A plot of the confidence intervals of a &quot;SimCi&quot; object. </p>


<h3>Author(s)</h3>

<p> Christof Kluss and Mario Hasler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+SimCiDiff">SimCiDiff</a></code>, <code><a href="#topic+SimCiRat">SimCiRat</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Simultaneous confidence intervals related to a comparison of the groups
# B and H against the standard S, on endpoint Thromb.count, assuming unequal
# variances for the groups. This is an extension of the well-known Dunnett-
# intervals to the case of heteroscedasticity.

data(coagulation)

interv1 &lt;- SimCiDiff(data=coagulation, grp="Group", resp="Thromb.count",
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
interv1
plot(interv1)

# Example 2:
# Simultaneous confidence intervals related to a comparisons of the groups
# B and H against the standard S, simultaneously on all endpoints, assuming
# unequal covariance matrices for the groups. This is an extension of the well-
# known Dunnett-intervals to the case of heteroscedasticity and multiple
# endpoints.

data(coagulation)

interv2 &lt;- SimCiDiff(data=coagulation, grp="Group", resp=c("Thromb.count","ADP","TRAP"),
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
summary(interv2)
par(mfrow=c(1,3)); plot(interv2)
</code></pre>

<hr>
<h2 id='print.SimCi'> Print function for SimCi-objects </h2><span id='topic+print.SimCi'></span>

<h3>Description</h3>

<p>A short print out of the results of <code>SimCiDiff</code> and <code>SimCiRat</code>,
respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SimCi'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.SimCi_+3A_x">x</code></td>
<td>
<p> an object of class &quot;SimCi&quot; as obtained by calling
<code>SimCiDiff</code> or <code>SimCiRat</code> </p>
</td></tr>
<tr><td><code id="print.SimCi_+3A_digits">digits</code></td>
<td>
<p> digits for rounding the results </p>
</td></tr>
<tr><td><code id="print.SimCi_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <code>print</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out containing the estimates, degrees of freedom, raw and 
simultaneous confidence intervals computed by <code>SimCiDiff</code> or 
<code>SimCiRat</code>, respectively.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+print.SimTest">print.SimTest</a></code> </p>

<hr>
<h2 id='print.SimTest'> Print function for SimTest-objects </h2><span id='topic+print.SimTest'></span>

<h3>Description</h3>

<p>A short print out of the results of <code>SimTestDiff</code> and <code>SimTestRat</code>,
respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SimTest'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.SimTest_+3A_x">x</code></td>
<td>
<p> an object of class &quot;SimTest&quot; as obtained by calling
<code>SimTestDiff</code> or <code>SimTestRat</code> </p>
</td></tr>
<tr><td><code id="print.SimTest_+3A_digits">digits</code></td>
<td>
<p> digits for rounding the results </p>
</td></tr>
<tr><td><code id="print.SimTest_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <code>print</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out containing the margins, estimates, test statistics, degrees of 
freedom, raw and adjusted <em>p</em>-values computed by <code>SimTestDiff</code> 
or <code>SimTestRat</code>, respectively.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+print.SimCi">print.SimCi</a></code> </p>

<hr>
<h2 id='rcm'> Random Correlation Matrices </h2><span id='topic+rcm'></span>

<h3>Description</h3>

<p>Correlation matrices with random off-diagonal elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcm(nrow = NULL, ncol = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rcm_+3A_nrow">nrow</code></td>
<td>
<p> the desired number of rows </p>
</td></tr>
<tr><td><code id="rcm_+3A_ncol">ncol</code></td>
<td>
<p> the desired number of columns </p>
</td></tr>
</table>


<h3>Details</h3>

<p>As a correlation matrix is symmetric, only one of <code>nrow</code> or <code>ncol</code>
needs to be specified.
</p>


<h3>Value</h3>

<p>A symmetric correlation matrix with random elements.
</p>


<h3>Author(s)</h3>

<p> Kornelius Rohmeyer and Mario Hasler </p>


<h3>References</h3>

<p>Holmes, R.B. (1991): On random correlation matrices.
<em>Siam Journal on Matrix Analysis and Applications</em> 12, 239&ndash;272.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ermvnorm">ermvnorm</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# A correlation matrix representing three randomly correlated endpoints.

set.seed(1234)
rcm(nrow=3)

# Example 2:
# A correlation matrix representing five randomly correlated endpoints.

set.seed(5678)
rcm(ncol=5)
</code></pre>

<hr>
<h2 id='SimCiDiff'> Simultaneous Confidence Intervals for General Contrasts (Differences) of 
Means of Multiple Endpoints </h2><span id='topic+SimCiDiff'></span><span id='topic+SimCiDiff.default'></span><span id='topic+SimCiDiff.formula'></span>

<h3>Description</h3>

<p>Simultaneous confidence intervals for general contrasts (linear functions) of 
normal means (e.g., &quot;Dunnett&quot;, &quot;Tukey&quot;, &quot;Williams&quot; ect.), and for single or 
multiple endpoints (primary response variables) simultaneously. The procedure of 
Hasler and Hothorn (2011) &lt;doi:10.2202/1557-4679.1258&gt; is applied for 
differences of means of normally distributed data. The variances/ covariance 
matrices of the treatment groups (containing the covariances between the 
endpoints) may be assumed to be equal or possibly unequal for the different 
groups (Hasler, 2014 &lt;doi:10.1515/ijb-2012-0015&gt;). For the case of only a single 
endpoint and unequal covariance matrices (variances), the procedure coincides 
with the PI procedure of Hasler and Hothorn (2008) &lt;doi:10.1002/bimj.200710466&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
SimCiDiff(data, grp, resp = NULL, na.action = "na.error", type = "Dunnett", 
  base = 1, ContrastMat = NULL, alternative = "two.sided", covar.equal = FALSE, 
  conf.level = 0.95, CorrMatDat = NULL, ...)
## S3 method for class 'formula'
SimCiDiff(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimCiDiff_+3A_data">data</code></td>
<td>
<p> a data frame containing a grouping variable and the endpoints as
columns </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_grp">grp</code></td>
<td>
<p> a character string with the name of the grouping variable </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_resp">resp</code></td>
<td>
<p> a vector of character strings with the names of the endpoints; if
<code>resp=NULL</code> (default), all column names of the data frame
without the grouping variable are chosen automatically </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_formula">formula</code></td>
<td>
<p> a formula specifying a numerical response and a grouping factor 
(e.g. <kbd>response ~ treatment</kbd>)  </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_na.action">na.action</code></td>
<td>
<p> a character string indicating what should happen when the data 
contain <code>NAs</code>;
if <code>na.action="na.error"</code> (default) the procedure stops 
with an error message; if <code>na.action="multi.df"</code> a new 
experimental version is used (details will follow soon) </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_type">type</code></td>
<td>
<p> a character string, defining the type of contrast, with the following
options:
</p>

<ul>
<li><p> &quot;Dunnett&quot;: many-to-one comparisons
</p>
</li>
<li><p> &quot;Tukey&quot;: all-pair comparisons
</p>
</li>
<li><p> &quot;Sequen&quot;: comparisons of consecutive groups
</p>
</li>
<li><p> &quot;AVE&quot;: comparison of each group with average of all others
</p>
</li>
<li><p> &quot;GrandMean&quot;: comparison of each group with grand mean of all
groups
</p>
</li>
<li><p> &quot;Changepoint&quot;: differences of averages of groups of higher
order to averages of groups of lower order
</p>
</li>
<li><p> &quot;Marcus&quot;: Marcus contrasts
</p>
</li>
<li><p> &quot;McDermott&quot;: McDermott contrasts
</p>
</li>
<li><p> &quot;Williams&quot;: Williams trend tests
</p>
</li>
<li><p> &quot;UmbrellaWilliams&quot;: Umbrella-protected Williams trend tests
</p>
</li></ul>

<p>note that <code>type</code> is ignored if <code>ContrastMat</code> is specified
by the user (see below) </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control group for Dunnett contrasts,
ignored otherwise </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_contrastmat">ContrastMat</code></td>
<td>
<p> a contrast matrix, where columns correspond to groups and rows
correspond to contrasts </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code>
or <code>"less"</code> </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_covar.equal">covar.equal</code></td>
<td>
<p> a logical variable indicating whether to treat the variances/ 
covariance matrices of the treatment groups (containing the 
covariances between the endpoints) as being equal;
if <code>TRUE</code> then the pooled variance/ covariance matrix is 
used, otherwise the Satterthwaite approximation to the degrees 
of freedom is used </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value defining the simultaneous confidence level </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_corrmatdat">CorrMatDat</code></td>
<td>
<p> a correlation matrix of the endpoints, if <code>NULL</code> (default) 
it is estimated from the data </p>
</td></tr>
<tr><td><code id="SimCiDiff_+3A_...">...</code></td>
<td>
<p> arguments to be passed to SimCiDiff.default </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interest is in simultaneous confidence intervals for several linear combinations
(contrasts) of treatment means in a one-way ANOVA model, and for single or 
multiple endpoints simultaneously. For example, corresponding intervals for the all-
pair comparison of Tukey (1953) and the many-to-one comparison of Dunnett (1955) are 
implemented, but allowing for heteroscedasticity and multiple endpoints. The user is 
also free to create other interesting problem-specific contrasts. Approximate 
multivariate <em>t</em>-distributions are used to calculate lower and upper limits 
(Hasler and Hothorn, 2011 &lt;doi:10.2202/1557-4679.1258&gt;). Simultaneous tests based on 
these intervals control the familywise error rate in admissible ranges and in the 
strong sense. The variances/ covariance matrices of the treatment groups (containing 
the covariances between the endpoints) can be assumed to be equal 
(<code>covar.equal=TRUE</code>) or unequal (<code>covar.equal=FALSE</code>). If being equal, the 
pooled variance/ covariance matrix is used, otherwise approximations to the degrees 
of freedom (Satterthwaite, 1946) are used (Hasler, 2014 &lt;doi:10.1515/ijb-2012-0015&gt;; 
Hasler and Hothorn, 2008 &lt;doi:10.1002/bimj.200710466&gt;). Unequal covariance matrices 
occure if variances or correlations of some endpoints differ depending on the 
treatment groups.
</p>


<h3>Value</h3>

<p>An object of class SimCi containing:
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p> a matrix of estimated differences </p>
</td></tr>
<tr><td><code>lower.raw</code></td>
<td>
<p> a matrix of raw (unadjusted) lower limits </p>
</td></tr>
<tr><td><code>upper.raw</code></td>
<td>
<p> a matrix of raw (unadjusted) upper limits </p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p> a matrix of lower limits adjusted for multiplicity </p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p> a matrix of upper limits adjusted for multiplicity </p>
</td></tr>
<tr><td><code>CorrMatDat</code></td>
<td>
<p> if not prespecified by <code>CorrMatDat</code>, either the estimated 
common correlation matrix of the endpoints 
(<code>covar.equal=TRUE</code>) or a list of different (one for each 
treatment) estimated correlation matrices of the endpoints 
(<code>covar.equal=FALSE</code>) </p>
</td></tr>
<tr><td><code>CorrMatComp</code></td>
<td>
<p> the estimated correlation matrix of the comparisons </p>
</td></tr>
<tr><td><code>degr.fr</code></td>
<td>
<p> a matrix of degrees of freedom </p>
</td></tr>
</table>


<h3>Note</h3>

<p>By default (<code>na.action="na.error"</code>), the procedure stops if there are 
missing values. A new experimental version for missing values is used if 
<code>na.action="multi.df"</code>. If <code>covar.equal=TRUE</code>, the number of endpoints 
must not be greater than the total sample size minus the number of treatment 
groups. If <code>covar.equal=FALSE</code>, the number of endpoints must not be greater 
than the minimal sample size minus 1. Otherwise the procedure stops.
</p>
<p>All intervals have the same direction for all comparisons and endpoints
(<code>alternative="..."</code>). In case of doubt, use <code>"two.sided"</code>.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>References</h3>

<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17&ndash;28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2011): A Dunnett-type procedure for multiple endpoints.
<em>The International Journal of Biostatistics</em> 7, Article 3, &lt;doi:10.2202/1557-4679.1258&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793&ndash;800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SimTestDiff">SimTestDiff</a></code>, <code><a href="#topic+SimTestRat">SimTestRat</a></code>, 
<code><a href="#topic+SimCiRat">SimCiRat</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Simultaneous confidence intervals related to a comparison of the groups
# B and H against the standard S, for endpoint Thromb.count, assuming unequal
# variances for the groups. This is an extension of the well-known Dunnett-
# intervals to the case of heteroscedasticity.

data(coagulation)

interv1 &lt;- SimCiDiff(data=coagulation, grp="Group", resp="Thromb.count",
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
interv1
plot(interv1)

# Example 2:
# Simultaneous confidence intervals related to a comparisons of the groups
# B and H against the standard S, simultaneously for all endpoints, assuming
# unequal covariance matrices for the groups. This is an extension of the well-
# known Dunnett-intervals to the case of heteroscedasticity and multiple
# endpoints.

data(coagulation)

interv2 &lt;- SimCiDiff(data=coagulation, grp="Group", resp=c("Thromb.count","ADP","TRAP"),
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
summary(interv2)
plot(interv2)
</code></pre>

<hr>
<h2 id='SimCiRat'> Simultaneous Confidence Intervals for General Contrasts (Ratios) of Means 
of Multiple Endpoints </h2><span id='topic+SimCiRat'></span><span id='topic+SimCiRat.default'></span><span id='topic+SimCiRat.formula'></span>

<h3>Description</h3>

<p>Simultaneous confidence intervals for general contrasts (linear functions) of 
normal means (e.g., &quot;Dunnett&quot;, &quot;Tukey&quot;, &quot;Williams&quot; ect.), and for single or 
multiple endpoints (primary response variables) simultaneously. The procedure of 
Hasler and Hothorn (2012) &lt;doi:10.1080/19466315.2011.633868&gt; is applied for 
ratios of means of normally distributed data. The variances/ covariance matrices 
of the treatment groups (containing the covariances between the endpoints) may be 
assumed to be equal or possibly unequal for the different groups (Hasler, 2014 
&lt;doi:10.1515/ijb-2012-0015&gt;). For the case of only a single endpoint and unequal 
covariance matrices (variances), the procedure coincides with the PI procedure of 
Hasler and Hothorn (2008) &lt;doi:10.1002/bimj.200710466&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
SimCiRat(data, grp, resp = NULL, na.action = "na.error", type = "Dunnett", 
  base = 1, Num.Contrast = NULL, Den.Contrast = NULL, alternative = "two.sided", 
  covar.equal = FALSE, conf.level = 0.95, CorrMatDat = NULL, ...)
## S3 method for class 'formula'
SimCiRat(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimCiRat_+3A_data">data</code></td>
<td>
<p> a data frame containing a grouping variable and the endpoints as
columns </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_grp">grp</code></td>
<td>
<p> a character string with the name of the grouping variable </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_resp">resp</code></td>
<td>
<p> a vector of character strings with the names of the endpoints; if
<code>resp=NULL</code> (default), all column names of the data frame
without the grouping variable are chosen automatically </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_formula">formula</code></td>
<td>
<p> a formula specifying a numerical response and a grouping factor 
(e.g. <kbd>response ~ treatment</kbd>)  </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_na.action">na.action</code></td>
<td>
<p> a character string indicating what should happen when the data 
contain <code>NAs</code>;
if <code>na.action="na.error"</code> (default) the procedure stops 
with an error message; if <code>na.action="multi.df"</code> a new 
experimental version is used (details will follow soon) </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_type">type</code></td>
<td>
<p> a character string, defining the type of contrast, with the following
options:
</p>

<ul>
<li><p> &quot;Dunnett&quot;: many-to-one comparisons
</p>
</li>
<li><p> &quot;Tukey&quot;: all-pair comparisons
</p>
</li>
<li><p> &quot;Sequen&quot;: comparisons of consecutive groups
</p>
</li>
<li><p> &quot;AVE&quot;: comparison of each group with average of all others
</p>
</li>
<li><p> &quot;GrandMean&quot;: comparison of each group with grand mean of all
groups
</p>
</li>
<li><p> &quot;Changepoint&quot;: differences of averages of groups of higher
order to averages of groups of lower order
</p>
</li>
<li><p> &quot;Marcus&quot;: Marcus contrasts
</p>
</li>
<li><p> &quot;McDermott&quot;: McDermott contrasts
</p>
</li>
<li><p> &quot;Williams&quot;: Williams trend tests
</p>
</li>
<li><p> &quot;UmbrellaWilliams&quot;: Umbrella-protected Williams trend tests
</p>
</li></ul>

<p>note that <code>type</code> is ignored if <code>Num.Contrast</code> or 
<code>Den.Contrast</code> is specified by the user (see below) </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control group for Dunnett contrasts,
ignored otherwise </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_num.contrast">Num.Contrast</code></td>
<td>
<p> a numerator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_den.contrast">Den.Contrast</code></td>
<td>
<p> a denominator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code>
or <code>"less"</code> </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_covar.equal">covar.equal</code></td>
<td>
<p> a logical variable indicating whether to treat the variances/ 
covariance matrices of the treatment groups (containing the 
covariances between the endpoints) as being equal;
if <code>TRUE</code> then the pooled variance/ covariance matrix is 
used, otherwise the Satterthwaite approximation to the degrees 
of freedom is used </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value defining the simultaneous confidence level </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_corrmatdat">CorrMatDat</code></td>
<td>
<p> a correlation matrix of the endpoints, if <code>NULL</code> (default) 
it is estimated from the data </p>
</td></tr>
<tr><td><code id="SimCiRat_+3A_...">...</code></td>
<td>
<p> arguments to be passed to SimCiRat.default </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interest is in simultaneous confidence intervals for several linear combinations
(contrasts) of treatment means in a one-way ANOVA model, and for single or 
multiple endpoints simultaneously. For example, corresponding intervals for the all-
pair comparison of Tukey (1953) and the many-to-one comparison of Dunnett (1955) are 
implemented, but allowing for heteroscedasticity and multiple endpoints, and in 
terms of ratios of means. The user is also free to create other interesting 
problem-specific contrasts. Approximate multivariate <em>t</em>-distributions are used 
to calculate lower and upper limits (Hasler and Hothorn, 2012 
&lt;doi:10.1080/19466315.2011.633868&gt;). Simultaneous tests based on these intervals 
control the familywise error rate in admissible ranges and in the strong sense. The 
variances/ covariance matrices of the treatment groups (containing the covariances 
between the endpoints) can be assumed to be equal (<code>covar.equal=TRUE</code>) or 
unequal (<code>covar.equal=FALSE</code>). If being equal, the pooled variance/ covariance 
matrix is used, otherwise approximations to the degrees of freedom 
(Satterthwaite, 1946) are used (Hasler, 2014 &lt;doi:10.1515/ijb-2012-0015&gt;; 
Hasler and Hothorn, 2008 &lt;doi:10.1002/bimj.200710466&gt;). Unequal covariance matrices 
occure if variances or correlations of some endpoints differ depending on the 
treatment groups.
</p>


<h3>Value</h3>

<p>An object of class SimCi containing:
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p> a matrix of estimated ratios </p>
</td></tr>
<tr><td><code>lower.raw</code></td>
<td>
<p> a matrix of raw (unadjusted) lower limits </p>
</td></tr>
<tr><td><code>upper.raw</code></td>
<td>
<p> a matrix of raw (unadjusted) upper limits </p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p> a matrix of lower limits adjusted for multiplicity </p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p> a matrix of upper limits adjusted for multiplicity </p>
</td></tr>
<tr><td><code>CorrMatDat</code></td>
<td>
<p> if not prespecified by <code>CorrMatDat</code>, either the estimated 
common correlation matrix of the endpoints 
(<code>covar.equal=TRUE</code>) or a list of different (one for each 
treatment) estimated correlation matrices of the endpoints 
(<code>covar.equal=FALSE</code>) </p>
</td></tr>
<tr><td><code>CorrMatComp</code></td>
<td>
<p> the estimated correlation matrix of the comparisons </p>
</td></tr>
<tr><td><code>degr.fr</code></td>
<td>
<p> a matrix of degrees of freedom </p>
</td></tr>
</table>


<h3>Note</h3>

<p>By default (<code>na.action="na.error"</code>), the procedure stops if there are 
missing values. A new experimental version for missing values is used if 
<code>na.action="multi.df"</code>. If <code>covar.equal=TRUE</code>, the number of endpoints 
must not be greater than the total sample size minus the number of treatment 
groups. If <code>covar.equal=FALSE</code>, the number of endpoints must not be greater 
than the minimal sample size minus 1. Otherwise the procedure stops.
</p>
<p>All intervals have the same direction for all comparisons and endpoints
(<code>alternative="..."</code>). In case of doubt, use <code>"two.sided"</code>.
</p>
<p>The correlation matrix for the multivariate <em>t</em>-distribution also depends 
on the unknown ratios. The same problem also arises for the degrees of freedom 
if the covariance matrices for the different groups are assumed to be unequal 
(<code>covar.equal=FALSE</code>). Both problems are handled by a plug-in approach, see 
the references therefore.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>References</h3>

<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17&ndash;28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2012): A multivariate Williams-type trend procedure.
<em>Statistics in Biopharmaceutical Research</em> 4, 57&ndash;65, &lt;doi:10.1080/19466315.2011.633868&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793&ndash;800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>
<p>Dilba, G. et al. (2006): Simultaneous confidence sets and confidence intervals for
multiple ratios. <em>Journal of Statistical Planning and Inference</em> 136, 2640&ndash;2658,
&lt;DOI:10.1016/j.jspi.2004.11.009&gt;.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SimTestRat">SimTestRat</a></code>, <code><a href="#topic+SimTestDiff">SimTestDiff</a></code>, 
<code><a href="#topic+SimCiDiff">SimCiDiff</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Simultaneous confidence intervals related to a comparison of the groups
# B and H against the standard S, for endpoint Thromb.count, assuming unequal
# variances for the groups. This is an extension of the well-known Dunnett-
# intervals to the case of heteroscedasticity and in terms of ratios of means
# instead of differences.

data(coagulation)

interv1 &lt;- SimCiRat(data=coagulation, grp="Group", resp="Thromb.count",
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
interv1
plot(interv1)

# Example 2:
# Simultaneous confidence intervals related to a comparisons of the groups
# B and H against the standard S, simultaneously for all endpoints, assuming
# unequal covariance matrices for the groups. This is an extension of the well-
# known Dunnett-intervals to the case of heteroscedasticity and multiple
# endpoints and in terms of ratios of means instead of differences.

data(coagulation)

interv2 &lt;- SimCiRat(data=coagulation, grp="Group", resp=c("Thromb.count","ADP","TRAP"),
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
summary(interv2)
plot(interv2)
</code></pre>

<hr>
<h2 id='SimComp-package'>
Simultaneous Comparisons for Multiple Endpoints
</h2><span id='topic+SimComp-package'></span><span id='topic+SimComp'></span>

<h3>Description</h3>

<p>Simultaneous tests and confidence intervals are provided for one-way experimental designs with one or many normally distributed, primary response variables (endpoints). Differences (Hasler and Hothorn, 2011 &lt;doi:10.2202/1557-4679.1258&gt;) or ratios (Hasler and Hothorn, 2012 &lt;doi:10.1080/19466315.2011.633868&gt;) of means can be considered. Various contrasts can be chosen, unbalanced sample sizes are allowed as well as heterogeneous variances (Hasler and Hothorn, 2008 &lt;doi:10.1002/bimj.200710466&gt;) or covariance matrices (Hasler, 2014 &lt;doi:10.1515/ijb-2012-0015&gt;).
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> SimComp</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Simultaneous Comparisons for Multiple Endpoints</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 3.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-08-26</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Mario Hasler, Christof Kluss</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Mario Hasler &lt;hasler@email.uni-kiel.de&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> mvtnorm, multcomp, mratios, graphics, stats</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Simultaneous tests and confidence intervals are provided for one-way experimental designs with one or many normally distributed, primary response variables (endpoints). Differences (Hasler and Hothorn, 2011 &lt;doi:10.2202/1557-4679.1258&gt;) or ratios (Hasler and Hothorn, 2012 &lt;doi:10.1080/19466315.2011.633868&gt;) of means can be considered. Various contrasts can be chosen, unbalanced sample sizes are allowed as well as heterogeneous variances (Hasler and Hothorn, 2008 &lt;doi:10.1002/bimj.200710466&gt;) or covariance matrices (Hasler, 2014 &lt;doi:10.1515/ijb-2012-0015&gt;).</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
DfSattDiff              Degrees of Freedom Accoding to Satterthwaite
                        (1946) for Differences of Means
DfSattRat               Degrees of Freedom Accoding to Satterthwaite
                        (1946) for Ratios of Means
SimCiDiff               Simultaneous Confidence Intervals for General
                        Contrasts (Differences) of Means of Multiple
                        Endpoints
SimCiRat                Simultaneous Confidence Intervals for General
                        Contrasts (Ratios) of Means of Multiple
                        Endpoints
SimComp-package         Simultaneous Comparisons for Multiple Endpoints
SimTestDiff             Simultaneous Tests for General Contrasts
                        (Differences) of Means of Multiple Endpoints
SimTestRat              Simultaneous Tests for General Contrasts
                        (Ratios) of Means of Multiple Endpoints
coagulation             Data from a clinical study of three sets of
                        extracorporeal circulation in heart-lung
                        machines
ermvnorm                Multivariate Normal Random Numbers with Exact
                        Parameters
plot.SimCi              Plot function for SimCi-objects
print.SimCi             Print function for SimCi-objects
print.SimTest           Print function for SimTest-objects
rcm                     Random Correlation Matrices
summary.SimCi           Summary function for SimCi-objects
summary.SimTest         Summary function for SimTest-objects
</pre>


<h3>Author(s)</h3>

<p>Mario Hasler, Christof Kluss
</p>
<p>Maintainer: Mario Hasler &lt;hasler@email.uni-kiel.de&gt;
</p>
<p>Thanks to: Frank Schaarschmidt, Gemechis Djira Dilba, Kornelius Rohmeyer
</p>


<h3>References</h3>

<p>Hasler, M. and Hothorn, L.A. (2018): Multi-arm trials with multiple primary endpoints and
missing values. <em>Statistics in Medicine</em> 37, 710&ndash;721, &lt;doi:10.1002/sim.7542&gt;.
</p>
<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17&ndash;28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2012): A multivariate Williams-type trend procedure.
<em>Statistics in Biopharmaceutical Research</em> 4, 57&ndash;65, &lt;doi:10.1080/19466315.2011.633868&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2011): A Dunnett-type procedure for multiple endpoints.
<em>The International Journal of Biostatistics</em> 7, Article 3, &lt;doi:10.2202/1557-4679.1258&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793&ndash;800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>
<p>Dilba, G. et al. (2006): Simultaneous confidence sets and confidence intervals for
multiple ratios. <em>Journal of Statistical Planning and Inference</em> 136, 2640&ndash;2658,
&lt;doi:10.1016/j.jspi.2004.11.009&gt;.
</p>


<h3>See Also</h3>

 <p><code><a href="mratios.html#topic+mratios-package">multcomp</a></code>,
<code><a href="mratios.html#topic+mratios-package">mratios</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# A comparison of the groups B and H against the standard S, for endpoint
# Thromb.count, assuming unequal variances for the groups. This is an
# extension of the well-known Dunnett-test to the case of heteroscedasticity.

data(coagulation)

comp1 &lt;- SimTestDiff(data=coagulation, grp="Group", resp="Thromb.count",
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
comp1

# Example 2:
# A comparison of the groups B and H against the standard S, simultaneously
# for all endpoints, assuming unequal covariance matrices for the groups. This is
# an extension of the well-known Dunnett-test to the case of heteroscedasticity
# and multiple endpoints.

data(coagulation)

comp2 &lt;- SimTestDiff(data=coagulation, grp="Group", resp=c("Thromb.count","ADP","TRAP"),
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
summary(comp2)
</code></pre>

<hr>
<h2 id='SimTestDiff'> Simultaneous Tests for General Contrasts (Differences) of Means of 
Multiple Endpoints </h2><span id='topic+SimTestDiff'></span><span id='topic+SimTestDiff.default'></span><span id='topic+SimTestDiff.formula'></span>

<h3>Description</h3>

<p>Simultaneous tests for general contrasts (linear functions) of normal means (e.g.,
&quot;Dunnett&quot;, &quot;Tukey&quot;, &quot;Williams&quot; ect.), and for single or multiple endpoints 
(primary response variables) simultaneously. The procedure of Hasler and Hothorn 
(2011) &lt;doi:10.2202/1557-4679.1258&gt; is applied for differences of means of 
normally distributed data. The variances/ covariance matrices of the treatment 
groups (containing the covariances between the endpoints) may be assumed to be 
equal or possibly unequal for the different groups (Hasler, 2014 
&lt;doi:10.1515/ijb-2012-0015&gt;). For the case of only a single endpoint and unequal 
covariance matrices (variances), the procedure coincides with the PI procedure of 
Hasler and Hothorn (2008) &lt;doi:10.1002/bimj.200710466&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
SimTestDiff(data, grp, resp = NULL, na.action = "na.error", type = "Dunnett", 
  base = 1, ContrastMat = NULL, alternative = "two.sided", Margin = 0, 
  covar.equal = FALSE, CorrMatDat = NULL, ...)
## S3 method for class 'formula'
SimTestDiff(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimTestDiff_+3A_data">data</code></td>
<td>
<p> a data frame containing a grouping variable and the endpoints as
columns </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_grp">grp</code></td>
<td>
<p> a character string with the name of the grouping variable </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_resp">resp</code></td>
<td>
<p> a vector of character strings with the names of the endpoints; if
<code>resp=NULL</code> (default), all column names of the data frame
without the grouping variable are chosen automatically </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_formula">formula</code></td>
<td>
<p> a formula specifying a numerical response and a grouping factor 
(e.g. <kbd>response ~ treatment</kbd>)  </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_na.action">na.action</code></td>
<td>
<p> a character string indicating what should happen when the data 
contain <code>NAs</code>;
if <code>na.action="na.error"</code> (default) the procedure stops 
with an error message; if <code>na.action="multi.df"</code> multiple 
marginal degrees of freedom are used to adjust for the missing 
values problem </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_type">type</code></td>
<td>
<p> a character string, defining the type of contrast, with the following
options:
</p>

<ul>
<li><p> &quot;Dunnett&quot;: many-to-one comparisons
</p>
</li>
<li><p> &quot;Tukey&quot;: all-pair comparisons
</p>
</li>
<li><p> &quot;Sequen&quot;: comparisons of consecutive groups
</p>
</li>
<li><p> &quot;AVE&quot;: comparison of each group with average of all others
</p>
</li>
<li><p> &quot;GrandMean&quot;: comparison of each group with grand mean of all
groups
</p>
</li>
<li><p> &quot;Changepoint&quot;: differences of averages of groups of higher
order to averages of groups of lower order
</p>
</li>
<li><p> &quot;Marcus&quot;: Marcus contrasts
</p>
</li>
<li><p> &quot;McDermott&quot;: McDermott contrasts
</p>
</li>
<li><p> &quot;Williams&quot;: Williams trend tests
</p>
</li>
<li><p> &quot;UmbrellaWilliams&quot;: Umbrella-protected Williams trend tests
</p>
</li></ul>

<p>note that <code>type</code> is ignored if <code>ContrastMat</code>is specified
by the user (see below) </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control group for Dunnett contrasts,
ignored otherwise </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_contrastmat">ContrastMat</code></td>
<td>
<p> a contrast matrix, where columns correspond to groups and rows
correspond to contrasts </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code>
or <code>"less"</code> </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_margin">Margin</code></td>
<td>
<p> a single numeric value, or a numeric vector corresponding to
endpoints, or a matrix where columns correspond to endpoints and
rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_covar.equal">covar.equal</code></td>
<td>
<p> a logical variable indicating whether to treat the variances/ 
covariance matrices of the treatment groups (containing the 
covariances between the endpoints) as being equal;
if <code>TRUE</code> then the pooled variance/ covariance matrix is 
used, otherwise the Satterthwaite approximation to the degrees 
of freedom is used </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_corrmatdat">CorrMatDat</code></td>
<td>
<p> a correlation matrix of the endpoints, if <code>NULL</code> (default) 
it is estimated from the data </p>
</td></tr>
<tr><td><code id="SimTestDiff_+3A_...">...</code></td>
<td>
<p> arguments to be passed to SimTestDiff.default </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interest is in simultaneous tests for several linear combinations (contrasts) of
treatment means in a one-way ANOVA model, and for single or multiple endpoints 
simultaneously. For example, the all-pair comparison of Tukey (1953) and the many-
to-one comparison of Dunnett (1955) are implemented, but allowing for 
heteroscedasticity and multiple endpoints. The user is also free to create other 
interesting problem-specific contrasts. Approximate multivariate <em>t</em>-
distributions are used to calculate (adjusted) <em>p</em>-values (Hasler and Hothorn, 
2011 &lt;doi:10.2202/1557-4679.1258&gt;). This approach controls the familywise error rate 
in admissible ranges and in the strong sense. The variances/ covariance matrices of 
the treatment groups (containing the covariances between the endpoints) can be 
assumed to be equal (<code>covar.equal=TRUE</code>) or unequal (<code>covar.equal=FALSE</code>). 
If being equal, the pooled variance/ covariance matrix is used, otherwise 
approximations to the degrees of freedom (Satterthwaite, 1946) are used (Hasler, 
2014 &lt;doi:10.1515/ijb-2012-0015&gt;; Hasler and Hothorn, 2008 
&lt;doi:10.1002/bimj.200710466&gt;). Unequal covariance matrices occure if variances or 
correlations of some endpoints differ depending on the treatment groups.
</p>


<h3>Value</h3>

<p>An object of class SimTest containing:
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p> a matrix of estimated differences </p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p> a matrix of the calculated test statistics </p>
</td></tr>
<tr><td><code>p.val.raw</code></td>
<td>
<p> a matrix of raw <em>p</em>-values </p>
</td></tr>
<tr><td><code>p.val.adj</code></td>
<td>
<p> a matrix of <em>p</em>-values adjusted for multiplicity </p>
</td></tr>
<tr><td><code>CorrMatDat</code></td>
<td>
<p> if not prespecified by <code>CorrMatDat</code>, either the estimated 
common correlation matrix of the endpoints 
(<code>covar.equal=TRUE</code>) or a list of different (one for each 
treatment) estimated correlation matrices of the endpoints 
(<code>covar.equal=FALSE</code>) </p>
</td></tr>
<tr><td><code>CorrMatComp</code></td>
<td>
<p> the estimated correlation matrix of the comparisons </p>
</td></tr>
<tr><td><code>degr.fr</code></td>
<td>
<p> a matrix of degrees of freedom </p>
</td></tr>
</table>


<h3>Note</h3>

<p>By default (<code>na.action="na.error"</code>), the procedure stops if there are 
missing values. A new experimental version for missing values is used if 
<code>na.action="multi.df"</code>. If <code>covar.equal=TRUE</code>, the number of endpoints 
must not be greater than the total sample size minus the number of treatment 
groups. If <code>covar.equal=FALSE</code>, the number of endpoints must not be greater 
than the minimal sample size minus 1. Otherwise the procedure stops.
</p>
<p>All hypotheses are tested with the same test direction for all comparisons and
endpoints (<code>alternative="..."</code>). In case of doubt, use <code>"two.sided"</code>.
</p>
<p>If <code>Margin</code> is a single numeric value or a numeric vector, then the same
value(s) are used for the remaining comparisons or endpoints.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>References</h3>

<p>Hasler, M. and Hothorn, L.A. (2018): Multi-arm trials with multiple primary endpoints and
missing values. <em>Statistics in Medicine</em> 37, 710&ndash;721, &lt;doi:10.1002/sim.7542&gt;.
</p>
<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17&ndash;28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2011): A Dunnett-type procedure for multiple endpoints.
<em>The International Journal of Biostatistics</em> 7, Article 3, &lt;doi:10.2202/1557-4679.1258&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793&ndash;800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SimCiDiff">SimCiDiff</a></code>, <code><a href="#topic+SimTestRat">SimTestRat</a></code>, 
<code><a href="#topic+SimCiRat">SimCiRat</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# A comparison of the groups B and H against the standard S, for endpoint
# Thromb.count, assuming unequal variances for the groups. This is an
# extension of the well-known Dunnett-test to the case of heteroscedasticity.

data(coagulation)

comp1 &lt;- SimTestDiff(data=coagulation, grp="Group", resp="Thromb.count",
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
comp1

# Example 2:
# A comparison of the groups B and H against the standard S, simultaneously
# for all endpoints, assuming unequal covariance matrices for the groups. This is
# an extension of the well-known Dunnett-test to the case of heteroscedasticity
# and multiple endpoints.

data(coagulation)

comp2 &lt;- SimTestDiff(data=coagulation, grp="Group", resp=c("Thromb.count","ADP","TRAP"),
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
summary(comp2)
</code></pre>

<hr>
<h2 id='SimTestRat'> Simultaneous Tests for General Contrasts (Ratios) of Means of Multiple 
Endpoints </h2><span id='topic+SimTestRat'></span><span id='topic+SimTestRat.default'></span><span id='topic+SimTestRat.formula'></span>

<h3>Description</h3>

<p>Simultaneous tests for general contrasts (linear functions) of normal means (e.g.,
&quot;Dunnett&quot;, &quot;Tukey&quot;, &quot;Williams&quot; ect.), and for single or multiple endpoints 
(primary response variables) simultaneously. The procedure of Hasler and Hothorn 
(2012) &lt;doi:10.1080/19466315.2011.633868&gt; is applied for ratios of means of 
normally distributed data. The variances/ covariance matrices of the treatment 
groups (containing the covariances between the endpoints) may be assumed to be 
equal or possibly unequal for the different groups (Hasler, 2014 
&lt;doi:10.1515/ijb-2012-0015&gt;). For the case of only a single endpoint and unequal 
covariance matrices (variances), the procedure coincides with the PI procedure of 
Hasler and Hothorn (2008) &lt;doi:10.1002/bimj.200710466&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
SimTestRat(data, grp, resp = NULL, na.action = "na.error", type = "Dunnett", 
  base = 1, Num.Contrast = NULL, Den.Contrast = NULL, alternative = "two.sided", 
  Margin = 1, covar.equal = FALSE, CorrMatDat = NULL, ...)
## S3 method for class 'formula'
SimTestRat(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimTestRat_+3A_data">data</code></td>
<td>
<p> a data frame containing a grouping variable and the endpoints as
columns </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_grp">grp</code></td>
<td>
<p> a character string with the name of the grouping variable </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_resp">resp</code></td>
<td>
<p> a vector of character strings with the names of the endpoints; if
<code>resp=NULL</code> (default), all column names of the data frame
without the grouping variable are chosen automatically </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_formula">formula</code></td>
<td>
<p> a formula specifying a numerical response and a grouping factor 
(e.g. <kbd>response ~ treatment</kbd>)  </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_na.action">na.action</code></td>
<td>
<p> a character string indicating what should happen when the data 
contain <code>NAs</code>;
if <code>na.action="na.error"</code> (default) the procedure stops 
with an error message; if <code>na.action="multi.df"</code> a new 
experimental version is used (details will follow soon) </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_type">type</code></td>
<td>
<p> a character string, defining the type of contrast, with the following
options:
</p>

<ul>
<li><p> &quot;Dunnett&quot;: many-to-one comparisons
</p>
</li>
<li><p> &quot;Tukey&quot;: all-pair comparisons
</p>
</li>
<li><p> &quot;Sequen&quot;: comparisons of consecutive groups
</p>
</li>
<li><p> &quot;AVE&quot;: comparison of each group with average of all others
</p>
</li>
<li><p> &quot;GrandMean&quot;: comparison of each group with grand mean of all
groups
</p>
</li>
<li><p> &quot;Changepoint&quot;: differences of averages of groups of higher
order to averages of groups of lower order
</p>
</li>
<li><p> &quot;Marcus&quot;: Marcus contrasts
</p>
</li>
<li><p> &quot;McDermott&quot;: McDermott contrasts
</p>
</li>
<li><p> &quot;Williams&quot;: Williams trend tests
</p>
</li>
<li><p> &quot;UmbrellaWilliams&quot;: Umbrella-protected Williams trend tests
</p>
</li></ul>

<p>note that <code>type</code> is ignored if <code>Num.Contrast</code> or 
<code>Den.Contrast</code> is specified by the user (see below) </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control group for Dunnett contrasts,
ignored otherwise </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_num.contrast">Num.Contrast</code></td>
<td>
<p> a numerator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_den.contrast">Den.Contrast</code></td>
<td>
<p> a denominator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code>
or <code>"less"</code> </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_margin">Margin</code></td>
<td>
<p> a single numeric value, or a numeric vector corresponding to
endpoints, or a matrix where columns correspond to endpoints and
rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_covar.equal">covar.equal</code></td>
<td>
<p> a logical variable indicating whether to treat the variances/ 
covariance matrices of the treatment groups (containing the 
covariances between the endpoints) as being equal;
if <code>TRUE</code> then the pooled variance/ covariance matrix is 
used, otherwise the Satterthwaite approximation to the degrees 
of freedom is used </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_corrmatdat">CorrMatDat</code></td>
<td>
<p> a correlation matrix of the endpoints, if <code>NULL</code> (default) 
it is estimated from the data </p>
</td></tr>
<tr><td><code id="SimTestRat_+3A_...">...</code></td>
<td>
<p> arguments to be passed to SimTestRat.default </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interest is in simultaneous tests for several linear combinations (contrasts) of
treatment means in a one-way ANOVA model, and for single or multiple endpoints 
simultaneously. For example, the all-pair comparison of Tukey (1953) and the many-
to-one comparison of Dunnett (1955) are implemented, but allowing for 
heteroscedasticity and multiple endpoints, and in terms of ratios of means. The user 
is also free to create other interesting problem-specific contrasts. Approximate 
multivariate <em>t</em>-distributions are used to calculate (adjusted) <em>p</em>-values 
(Hasler and Hothorn, 2012 &lt;doi:10.1080/19466315.2011.633868&gt;). This approach 
controls the familywise error rate in admissible ranges and in the strong sense. The 
variances/ covariance matrices of the treatment groups (containing the covariances 
between the endpoints) can be assumed to be equal (<code>covar.equal=TRUE</code>) or 
unequal (<code>covar.equal=FALSE</code>). If being equal, the pooled variance/ covariance 
matrix is used, otherwise approximations to the degrees of freedom (Satterthwaite, 
1946) are used (Hasler, 2014 &lt;doi:10.1515/ijb-2012-0015&gt;; Hasler and Hothorn, 2008 
&lt;doi:10.1002/bimj.200710466&gt;). Unequal covariance matrices occure if variances or 
correlations of some endpoints differ depending on the treatment groups.
</p>


<h3>Value</h3>

<p>An object of class SimTest containing:
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p> a matrix of estimated differences </p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p> a matrix of the calculated test statistics </p>
</td></tr>
<tr><td><code>p.val.raw</code></td>
<td>
<p> a matrix of raw <em>p</em>-values </p>
</td></tr>
<tr><td><code>p.val.adj</code></td>
<td>
<p> a matrix of <em>p</em>-values adjusted for multiplicity </p>
</td></tr>
<tr><td><code>CorrMatDat</code></td>
<td>
<p> if not prespecified by <code>CorrMatDat</code>, either the estimated 
common correlation matrix of the endpoints 
(<code>covar.equal=TRUE</code>) or a list of different (one for each 
treatment) estimated correlation matrices of the endpoints 
(<code>covar.equal=FALSE</code>) </p>
</td></tr>
<tr><td><code>CorrMatComp</code></td>
<td>
<p> the estimated correlation matrix of the comparisons </p>
</td></tr>
<tr><td><code>degr.fr</code></td>
<td>
<p> a matrix of degrees of freedom </p>
</td></tr>
</table>


<h3>Note</h3>

<p>By default (<code>na.action="na.error"</code>), the procedure stops if there are 
missing values. A new experimental version for missing values is used if 
<code>na.action="multi.df"</code>. If <code>covar.equal=TRUE</code>, the number of endpoints 
must not be greater than the total sample size minus the number of treatment 
groups. If <code>covar.equal=FALSE</code>, the number of endpoints must not be greater 
than the minimal sample size minus 1. Otherwise the procedure stops.
</p>
<p>All hypotheses are tested with the same test direction for all comparisons and
endpoints (<code>alternative="..."</code>). In case of doubt, use <code>"two.sided"</code>.
</p>
<p>If <code>Margin</code> is a single numeric value or a numeric vector, then the same
value(s) are used for the remaining comparisons or endpoints.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>References</h3>

<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17&ndash;28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2012): A multivariate Williams-type trend procedure.
<em>Statistics in Biopharmaceutical Research</em> 4, 57&ndash;65, &lt;doi:10.1080/19466315.2011.633868&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793&ndash;800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>
<p>Dilba, G. et al. (2006): Simultaneous confidence sets and confidence intervals for
multiple ratios. <em>Journal of Statistical Planning and Inference</em> 136, 2640&ndash;2658,
&lt;doi:10.1016/j.jspi.2004.11.009&gt;.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SimCiRat">SimCiRat</a></code>, <code><a href="#topic+SimTestDiff">SimTestDiff</a></code>, 
<code><a href="#topic+SimCiDiff">SimCiDiff</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# A comparison of the groups B and H against the standard S, for endpoint
# Thromb.count, assuming unequal variances for the groups. This is an
# extension of the well-known Dunnett-test to the case of heteroscedasticity 
# and in terms of ratios of means instead of differences.

data(coagulation)

comp1 &lt;- SimTestRat(data=coagulation, grp="Group", resp="Thromb.count",
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
comp1

# Example 2:
# A comparison of the groups B and H against the standard S, simultaneously
# for all endpoints, assuming unequal covariance matrices for the groups. This is
# an extension of the well-known Dunnett-test to the case of heteroscedasticity
# and multiple endpoints and in terms of ratios of means instead of differences.

data(coagulation)

comp2 &lt;- SimTestDiff(data=coagulation, grp="Group", resp=c("Thromb.count","ADP","TRAP"),
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
summary(comp2)
</code></pre>

<hr>
<h2 id='summary.SimCi'> Summary function for SimCi-objects </h2><span id='topic+summary.SimCi'></span>

<h3>Description</h3>

<p>A detailed print out of the results of <code>SimCiDiff</code> and <code>SimCiRat</code>,
respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SimCi'
summary(object, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SimCi_+3A_object">object</code></td>
<td>
<p> an object of class &quot;SimCi&quot; as obtained by calling
<code>SimCiDiff</code> or <code>SimCiRat</code> </p>
</td></tr>
<tr><td><code id="summary.SimCi_+3A_digits">digits</code></td>
<td>
<p> digits for rounding the results </p>
</td></tr>
<tr><td><code id="summary.SimCi_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <code>print</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out containing the estimates, degrees of freedom, raw and 
simultaneous confidence intervals, estimated covariance and correlation 
matrices of the data and of the comparisons computed by <code>SimCiDiff</code> 
or <code>SimCiRat</code>, respectively.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.SimTest">summary.SimTest</a></code> </p>

<hr>
<h2 id='summary.SimTest'> Summary function for SimTest-objects </h2><span id='topic+summary.SimTest'></span>

<h3>Description</h3>

<p>A detailed print out of the results of <code>SimTestDiff</code> and <code>SimTestRat</code>,
respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SimTest'
summary(object, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SimTest_+3A_object">object</code></td>
<td>
<p> an object of class &quot;SimTest&quot; as obtained by calling
<code>SimTestDiff</code> or <code>SimTestRat</code> </p>
</td></tr>
<tr><td><code id="summary.SimTest_+3A_digits">digits</code></td>
<td>
<p> digits for rounding the results </p>
</td></tr>
<tr><td><code id="summary.SimTest_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <code>print</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out containing the estimates, test statistics, degrees of freedom, 
raw and adjusted <em>p</em>-values, estimated covariance correlation 
matrices of the data and of the comparisons computed by <code>SimTestDiff</code> 
or <code>SimTestRat</code>, respectively.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.SimCi">summary.SimCi</a></code> </p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
