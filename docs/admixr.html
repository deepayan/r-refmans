<!DOCTYPE html><html><head><title>Help for package admixr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {admixr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#count_snps'><p>Count the number/proportion of present/missing sites in each sample</p></a></li>
<li><a href='#download_data'><p>Download example SNP data.</p></a></li>
<li><a href='#eigenstrat'><p>EIGENSTRAT data constructor</p></a></li>
<li><a href='#f4ratio'><p>Calculate the D, f4, f4-ratio, or f3 statistic.</p></a></li>
<li><a href='#filter_bed'><p>Filter EIGENSTRAT data based on a given BED file</p></a></li>
<li><a href='#keep_transitions'><p>Remove transversions (C-&gt;T and G-&gt;A substitutions)</p></a></li>
<li><a href='#loginfo'><p>Print the full log output of an admixr wrapper to the console.</p></a></li>
<li><a href='#merge_eigenstrat'><p>Merge two sets of EIGENSTRAT datasets</p></a></li>
<li><a href='#print.admixr_result'><p>Print out the admixr result object (dataframe or a list) without showing</p>
the hidden attributes.</a></li>
<li><a href='#print.EIGENSTRAT'><p>EIGENSTRAT print method</p></a></li>
<li><a href='#qpAdm'><p>Calculate ancestry proportions in a set of target populations.</p></a></li>
<li><a href='#qpAdm_filter'><p>Filter qpAdm rotation results for only 'sensible' models</p></a></li>
<li><a href='#qpAdm_rotation'><p>Fit qpAdm models based on the rotation strategy described in</p>
Harney et al. 2020 (bioRxiv)</a></li>
<li><a href='#qpWave'><p>Find the most likely number of ancestry waves using the qpWave method.</p></a></li>
<li><a href='#read_ind'><p>Read an EIGENSTRAT ind/snp/geno file.</p></a></li>
<li><a href='#read_output'><p>Read an output file from one of the ADMIXTOOLS programs.</p></a></li>
<li><a href='#relabel'><p>Change labels of populations or samples</p></a></li>
<li><a href='#reset'><p>Reset modifications to an EIGENSTRAT object</p></a></li>
<li><a href='#transversions_only'><p>Remove transversions (C-&gt;T and G-&gt;A substitutions)</p></a></li>
<li><a href='#write_ind'><p>Write an EIGENSTRAT ind/snp/geno file.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>An Interface for Running 'ADMIXTOOLS' Analyses</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.1</td>
</tr>
<tr>
<td>Description:</td>
<td>An interface for performing all stages of 'ADMIXTOOLS' analyses
    (<a href="https://reich.hms.harvard.edu/software">https://reich.hms.harvard.edu/software</a>) entirely from R. Wrapper functions
    (D, f4, f3, etc.) completely automate the generation of intermediate
    configuration files, run 'ADMIXTOOLS' programs on the command-line, and
    parse output files to extract values of interest. This allows users to focus
    on the analysis itself instead of worrying about low-level technical details.
    A set of complementary functions for processing and filtering of data in
    the 'EIGENSTRAT' format is also provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/bodkan/admixr">https://github.com/bodkan/admixr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bodkan/admixr/issues">https://github.com/bodkan/admixr/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, magrittr, readr, stringr, tibble, stats, rlang, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, glue, testthat, tidyr, knitr, rmarkdown, tidyverse</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>ADMIXTOOLS suite of command-line utilities for
population genetics. See
&lt;https://reich.hms.harvard.edu/software&gt; for the most recent
installation instructions and further information.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-07-01 19:15:50 UTC; martin_petr</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Petr <a href="https://orcid.org/0000-0003-4879-8421"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Petr &lt;contact@bodkan.net&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-07-03 10:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>Added via usethis::use_pipe().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='count_snps'>Count the number/proportion of present/missing sites in each sample</h2><span id='topic+count_snps'></span>

<h3>Description</h3>

<p>Count the number/proportion of present/missing sites in each sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>count_snps(data, missing = FALSE, prop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="count_snps_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
<tr><td><code id="count_snps_+3A_missing">missing</code></td>
<td>
<p>Count present SNPs or missing SNPs?</p>
</td></tr>
<tr><td><code id="count_snps_+3A_prop">prop</code></td>
<td>
<p>Calculate the proportion instead of counts?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame object with SNP counts/proportions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: snps &lt;- eigenstrat(download_data(dirname = tempdir()))

present_count &lt;- count_snps(snps)
missing_count &lt;- count_snps(snps, missing = TRUE)

present_proportion &lt;- count_snps(snps, prop = TRUE)
missing_proportion &lt;- count_snps(snps, missing = TRUE, prop = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='download_data'>Download example SNP data.</h2><span id='topic+download_data'></span>

<h3>Description</h3>

<p>The data is downloaded to a temporary directory by default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_data(dirname = tempdir())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="download_data_+3A_dirname">dirname</code></td>
<td>
<p>Directory in which to put the data (EIGENSTRAT trio
of snp/geno/ind files).</p>
</td></tr>
</table>

<hr>
<h2 id='eigenstrat'>EIGENSTRAT data constructor</h2><span id='topic+eigenstrat'></span>

<h3>Description</h3>

<p>This function creates an instance of the EIGENSTRAT S3 class, which
encapsulates all paths to data files required for an ADMIXTOOLS analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenstrat(prefix = NULL, ind = NULL, snp = NULL, geno = NULL, exclude = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigenstrat_+3A_prefix">prefix</code></td>
<td>
<p>Shared path to an EIGENSTRAT trio (set of ind/snp/geno files).</p>
</td></tr>
<tr><td><code id="eigenstrat_+3A_ind">ind</code>, <code id="eigenstrat_+3A_snp">snp</code>, <code id="eigenstrat_+3A_geno">geno</code></td>
<td>
<p>Paths to individual EIGENSTRAT components.</p>
</td></tr>
<tr><td><code id="eigenstrat_+3A_exclude">exclude</code></td>
<td>
<p>Pre-defined snp file with excluded sites.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object of the EIGENSTRAT class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download an example genomic data and get the path prefix to the
# trio of snp/geno/ind files in an EIGENSTRAT format
prefix &lt;- download_data(dirname = tempdir())

# wrap the trio of snp/geno/ind files in an object of the class
# EIGENSTRAT
snps &lt;- eigenstrat(prefix)

## End(Not run)

</code></pre>

<hr>
<h2 id='f4ratio'>Calculate the D, f4, f4-ratio, or f3 statistic.</h2><span id='topic+f4ratio'></span><span id='topic+d'></span><span id='topic+f4'></span><span id='topic+f3'></span>

<h3>Description</h3>

<p>Calculate the D, f4, f4-ratio, or f3 statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f4ratio(data, X, A, B, C, O, outdir = NULL, params = NULL)

d(
  data,
  W,
  X,
  Y,
  Z,
  quartets = NULL,
  outdir = NULL,
  f4mode = FALSE,
  params = NULL
)

f4(data, W, X, Y, Z, quartets = NULL, outdir = NULL, params = NULL)

f3(data, A, B, C, outdir = NULL, inbreed = FALSE, params = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f4ratio_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
<tr><td><code id="f4ratio_+3A_outdir">outdir</code></td>
<td>
<p>Where to put all generated files (temporary directory by default).</p>
</td></tr>
<tr><td><code id="f4ratio_+3A_params">params</code></td>
<td>
<p>Named list of parameters and their values.</p>
</td></tr>
<tr><td><code id="f4ratio_+3A_w">W</code>, <code id="f4ratio_+3A_x">X</code>, <code id="f4ratio_+3A_y">Y</code>, <code id="f4ratio_+3A_z">Z</code>, <code id="f4ratio_+3A_a">A</code>, <code id="f4ratio_+3A_b">B</code>, <code id="f4ratio_+3A_c">C</code>, <code id="f4ratio_+3A_o">O</code></td>
<td>
<p>Population names according to the nomenclature used in
Patterson et al., 2012.</p>
</td></tr>
<tr><td><code id="f4ratio_+3A_quartets">quartets</code></td>
<td>
<p>List of character vectors (quartets of population/sample labels)</p>
</td></tr>
<tr><td><code id="f4ratio_+3A_f4mode">f4mode</code></td>
<td>
<p>Calculate the f4 statistic instead of the D statistic.</p>
</td></tr>
<tr><td><code id="f4ratio_+3A_inbreed">inbreed</code></td>
<td>
<p>See README.3PopTest in ADMIXTOOLS for an explanation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame object with calculated statistics
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download an example genomic data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# define a set of populations to analyze
pops &lt;- c("French", "Sardinian", "Han", "Papuan", "Dinka")

result_f4ratio &lt;- f4ratio(
    X = pops, A = "Altai", B = "Vindija", C = "Yoruba", O = "Chimp",
    data = snps
)

result_d &lt;- d(
    W = pops, X = "Yoruba", Y = "Vindija", Z = "Chimp",
    data = snps
)

result_f4 &lt;- f4(
    W = pops, X = "Yoruba", Y = "Vindija", Z = "Chimp",
    data = snps
)

result_f3 &lt;- f3(
    A = pops, B = "Mbuti", C = "Khomani_San",
    data = snps
)

## End(Not run)

</code></pre>

<hr>
<h2 id='filter_bed'>Filter EIGENSTRAT data based on a given BED file</h2><span id='topic+filter_bed'></span>

<h3>Description</h3>

<p>Keep (or discard) SNPs that overlap (or lie outside of) regions in a given
BED file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_bed(data, bed, remove = FALSE, outfile = tempfile(fileext = ".snp"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_bed_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
<tr><td><code id="filter_bed_+3A_bed">bed</code></td>
<td>
<p>Path to a BED file.</p>
</td></tr>
<tr><td><code id="filter_bed_+3A_remove">remove</code></td>
<td>
<p>Remove sites falling inside the BED file regions? By default,
sites that do not overlap BED regions are removed.</p>
</td></tr>
<tr><td><code id="filter_bed_+3A_outfile">outfile</code></td>
<td>
<p>Path to an output snp file with coordinates of excluded sites.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function requires a functioning bedtools installation! See:
</p>
<p>- https://github.com/arq5x/bedtools2
</p>
<p>- https://bedtools.readthedocs.io/
</p>


<h3>Value</h3>

<p>Updated S3 EIGENSTRAT data object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download an example genomic data set
prefix &lt;- download_data(dirname = tempdir())
# create an EIGENSTRAT R object from the downloaded data
snps &lt;- eigenstrat(prefix)

# get the path to an example BED file
bed &lt;- file.path(dirname(prefix), "regions.bed")

# BED file contains regions to keep in an analysis
snps_kept &lt;- filter_bed(snps, bed)
# BED file contains regions to remove from an analysis
snps_removed &lt;- filter_bed(snps, bed, remove = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='keep_transitions'>Remove transversions (C-&gt;T and G-&gt;A substitutions)</h2><span id='topic+keep_transitions'></span>

<h3>Description</h3>

<p>Remove substitutions that are more likely to be a result of ancient DNA
damage (C-&gt;T and G-&gt;A substitutions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keep_transitions(data, outfile = tempfile(fileext = ".snp"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="keep_transitions_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
<tr><td><code id="keep_transitions_+3A_outfile">outfile</code></td>
<td>
<p>Path to an output snp file with coordinates of excluded sites.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updated S3 EIGENSTRAT data object with an additional 'exclude' slot
specifying the path to the set of SNPs to be removed.
</p>

<hr>
<h2 id='loginfo'>Print the full log output of an admixr wrapper to the console.</h2><span id='topic+loginfo'></span>

<h3>Description</h3>

<p>Print the full log output of an admixr wrapper to the console.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loginfo(x, target = NA, save = FALSE, prefix = NA, dir = ".", suffix = ".txt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loginfo_+3A_x">x</code></td>
<td>
<p>Output from one of the admixr wrappers (d, f4, qpAdm, ...)</p>
</td></tr>
<tr><td><code id="loginfo_+3A_target">target</code></td>
<td>
<p>A specific log to examine (relevant for multiple target qpAdm runs)</p>
</td></tr>
<tr><td><code id="loginfo_+3A_save">save</code></td>
<td>
<p>Save the log output to a disk?</p>
</td></tr>
<tr><td><code id="loginfo_+3A_prefix">prefix</code></td>
<td>
<p>Prefix of the output log file(s) (name of the admixr command by default)</p>
</td></tr>
<tr><td><code id="loginfo_+3A_dir">dir</code></td>
<td>
<p>In which directory to save the log file(s)?</p>
</td></tr>
<tr><td><code id="loginfo_+3A_suffix">suffix</code></td>
<td>
<p>Suffix of the output log file(s) (&quot;.txt&quot; by default)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download an example genomic data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# define a set of populations to analyze and calculate a D statistic
pops &lt;- c("French", "Sardinian", "Han", "Papuan", "Khomani_San", "Mbuti", "Dinka")
result_d &lt;- d(
    W = pops, X = "Yoruba", Y = "Vindija", Z = "Chimp",
    data = snps
)

# examine the full log output associated with the returned object
loginfo(result_d)

## End(Not run)

</code></pre>

<hr>
<h2 id='merge_eigenstrat'>Merge two sets of EIGENSTRAT datasets</h2><span id='topic+merge_eigenstrat'></span>

<h3>Description</h3>

<p>This function utilizes the 'mergeit' command distributed in ADMIXTOOLS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_eigenstrat(merged, a, b, strandcheck = "NO")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_eigenstrat_+3A_merged">merged</code></td>
<td>
<p>Prefix of the path to the merged EIGENSTRAT snp/ind/geno trio.</p>
</td></tr>
<tr><td><code id="merge_eigenstrat_+3A_a">a</code>, <code id="merge_eigenstrat_+3A_b">b</code></td>
<td>
<p>Two EIGENSTRAT objects to merge.</p>
</td></tr>
<tr><td><code id="merge_eigenstrat_+3A_strandcheck">strandcheck</code></td>
<td>
<p>Deal with potential strand issues? Mostly for historic reasons. For details see the README of ADMIXTOOLS convertf.</p>
</td></tr>
</table>

<hr>
<h2 id='print.admixr_result'>Print out the admixr result object (dataframe or a list) without showing
the hidden attributes.</h2><span id='topic+print.admixr_result'></span>

<h3>Description</h3>

<p>Print out the admixr result object (dataframe or a list) without showing
the hidden attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'admixr_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.admixr_result_+3A_x">x</code></td>
<td>
<p>admixr output object (dataframe or a list produced by qpAdm/qpWave)</p>
</td></tr>
<tr><td><code id="print.admixr_result_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to print.</p>
</td></tr>
</table>

<hr>
<h2 id='print.EIGENSTRAT'>EIGENSTRAT print method</h2><span id='topic+print.EIGENSTRAT'></span>

<h3>Description</h3>

<p>Print EIGENSTRAT object components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EIGENSTRAT'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.EIGENSTRAT_+3A_x">x</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
<tr><td><code id="print.EIGENSTRAT_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>

<hr>
<h2 id='qpAdm'>Calculate ancestry proportions in a set of target populations.</h2><span id='topic+qpAdm'></span>

<h3>Description</h3>

<p>Calculate ancestry proportions in a set of target populations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qpAdm(
  data,
  target,
  sources,
  outgroups,
  outdir = NULL,
  params = list(allsnps = "YES", summary = "YES", details = "YES")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qpAdm_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
<tr><td><code id="qpAdm_+3A_target">target</code></td>
<td>
<p>Vector of target populations (evaluated one at a time).</p>
</td></tr>
<tr><td><code id="qpAdm_+3A_sources">sources</code></td>
<td>
<p>Source populations related to true ancestors.</p>
</td></tr>
<tr><td><code id="qpAdm_+3A_outgroups">outgroups</code></td>
<td>
<p>Outgroup populations.</p>
</td></tr>
<tr><td><code id="qpAdm_+3A_outdir">outdir</code></td>
<td>
<p>Where to put all generated files (temporary directory by default).</p>
</td></tr>
<tr><td><code id="qpAdm_+3A_params">params</code></td>
<td>
<p>Named list of parameters and their values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of three components:
1. estimated ancestry proportions
2. ranks statistics
3. analysis of patterns (all possible subsets of ancestry sources).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download example data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# estimate the proportion of Neandertal ancestry in a French
# individual and other associated qpAdm statistics (see detailed
# description in the tutorial vignette)
result &lt;- qpAdm(
    target = "French",
    sources = c("Vindija", "Yoruba"),
    outgroups = c("Chimp", "Denisova", "Altai"),
    data = snps
)

## End(Not run)

</code></pre>

<hr>
<h2 id='qpAdm_filter'>Filter qpAdm rotation results for only 'sensible' models</h2><span id='topic+qpAdm_filter'></span>

<h3>Description</h3>

<p>Filter for p-value larger than a specified cuttof and admixture
proportions between 0 and 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qpAdm_filter(x, p = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qpAdm_filter_+3A_x">x</code></td>
<td>
<p>Output of a qpAdm_rotation() function</p>
</td></tr>
<tr><td><code id="qpAdm_filter_+3A_p">p</code></td>
<td>
<p>p-value cutoff (default 0: will only filter for sensible
admixture proportions)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>qpAdm_rotation object filtered down based on p-value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download an example genomic data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# find the set of most likely two-source qpAdm models of
# a French individual - produce only the 'proportions'
# qpAdm summary
models &lt;- qpAdm_rotation(
    data = snps,
    target = "French",
    candidates = c("Dinka", "Mbuti", "Yoruba", "Vindija",
                   "Altai", "Denisova", "Chimp"),
    minimize = TRUE,
    nsources = 2,
    ncores = 2,
    fulloutput = FALSE
)

# filter out models which can clearly be rejected
fits &lt;- qpAdm_filter(models, p = 0.05)

## End(Not run)

</code></pre>

<hr>
<h2 id='qpAdm_rotation'>Fit qpAdm models based on the rotation strategy described in
Harney et al. 2020 (bioRxiv)</h2><span id='topic+qpAdm_rotation'></span>

<h3>Description</h3>

<p>Fit qpAdm models based on the rotation strategy described in
Harney et al. 2020 (bioRxiv)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qpAdm_rotation(
  data,
  target,
  candidates,
  minimize = TRUE,
  nsources = 2,
  ncores = 1,
  fulloutput = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qpAdm_rotation_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT dataset</p>
</td></tr>
<tr><td><code id="qpAdm_rotation_+3A_target">target</code></td>
<td>
<p>Target population that is modeled as admixed</p>
</td></tr>
<tr><td><code id="qpAdm_rotation_+3A_candidates">candidates</code></td>
<td>
<p>Potential candidates for sources and outgroups</p>
</td></tr>
<tr><td><code id="qpAdm_rotation_+3A_minimize">minimize</code></td>
<td>
<p>Test also all possible subsets of outgroups? (default TRUE)</p>
</td></tr>
<tr><td><code id="qpAdm_rotation_+3A_nsources">nsources</code></td>
<td>
<p>Number of sources to pull from the candidates</p>
</td></tr>
<tr><td><code id="qpAdm_rotation_+3A_ncores">ncores</code></td>
<td>
<p>Number of CPU cores to utilize for model fitting</p>
</td></tr>
<tr><td><code id="qpAdm_rotation_+3A_fulloutput">fulloutput</code></td>
<td>
<p>Report also 'ranks' and 'subsets' analysis from
qpAdm in addition to the admixture proportions results? (default FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>qpAdm list with proportions, ranks and subsets elements (as
with a traditional qpAdm run) or just the proportions
(determined by the value of the 'fulloutput' argument)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download an example genomic data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# find the set of most likely two-source qpAdm models of
# a French individual - produce only the 'proportions'
# qpAdm summary
models &lt;- qpAdm_rotation(
    data = snps,
    target = "French",
    candidates = c("Dinka", "Mbuti", "Yoruba", "Vindija",
                   "Altai", "Denisova", "Chimp"),
    minimize = TRUE,
    nsources = 2,
    ncores = 2,
    fulloutput = FALSE
)

## End(Not run)

</code></pre>

<hr>
<h2 id='qpWave'>Find the most likely number of ancestry waves using the qpWave method.</h2><span id='topic+qpWave'></span>

<h3>Description</h3>

<p>Given a set of 'left' populations, estimate the lowest number of necessary
admixture sources related to the set of 'right' populations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qpWave(
  data,
  left,
  right,
  maxrank = NULL,
  details = FALSE,
  outdir = NULL,
  params = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qpWave_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
<tr><td><code id="qpWave_+3A_left">left</code>, <code id="qpWave_+3A_right">right</code></td>
<td>
<p>Character vectors of populations labels.</p>
</td></tr>
<tr><td><code id="qpWave_+3A_maxrank">maxrank</code></td>
<td>
<p>Maximum rank to test for.</p>
</td></tr>
<tr><td><code id="qpWave_+3A_details">details</code></td>
<td>
<p>Return the A, B matrices used in rank calculations?</p>
</td></tr>
<tr><td><code id="qpWave_+3A_outdir">outdir</code></td>
<td>
<p>Where to put all generated files (temporary directory by default).</p>
</td></tr>
<tr><td><code id="qpWave_+3A_params">params</code></td>
<td>
<p>Named list of parameters and their values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It has been shown (Reich, Nature 2012 - Reconstructing Native American
population history) that if the 'left' populations are mixtures of N
different sources related to the set of 'right' populations, the rank of the
matrix of the form <code class="reqn">f_4(left_i, left_j; right_k, right_l)</code> will have a
rank N - 1. This function uses the ADMIXTOOLS command qpWave to find the
lowest possible rank of this matrix that is consistent with the data.
</p>


<h3>Value</h3>

<p>Table of rank test results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download example data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# run the qpWave wrapper (detailed description in the tutorial vignette)
result &lt;- qpWave(
     left = c("French", "Sardinian", "Han"),
     right = c("Altai", "Yoruba", "Mbuti"),
     data = snps
)

## End(Not run)

</code></pre>

<hr>
<h2 id='read_ind'>Read an EIGENSTRAT ind/snp/geno file.</h2><span id='topic+read_ind'></span><span id='topic+read_snp'></span><span id='topic+read_geno'></span>

<h3>Description</h3>

<p>These functions each read one part of the EIGENSTRAT dataset trio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ind(data)

read_snp(data, exclude = FALSE)

read_geno(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_ind_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
<tr><td><code id="read_ind_+3A_exclude">exclude</code></td>
<td>
<p>Read the list of excluded SNPs?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>read_geno()</code> will only read plain-text geno files, not compressed ones.
</p>


<h3>Value</h3>

<p>A data.frame object.
</p>

<hr>
<h2 id='read_output'>Read an output file from one of the ADMIXTOOLS programs.</h2><span id='topic+read_output'></span>

<h3>Description</h3>

<p>Read an output file from one of the ADMIXTOOLS programs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_output(file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_output_+3A_file">file</code></td>
<td>
<p>A path to an output file.</p>
</td></tr>
<tr><td><code id="read_output_+3A_...">...</code></td>
<td>
<p>See the 'details' argument of qpWave.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the results.
</p>

<hr>
<h2 id='relabel'>Change labels of populations or samples</h2><span id='topic+relabel'></span>

<h3>Description</h3>

<p>Replace population/sample names with specified group labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relabel(data, ..., outfile = tempfile(fileext = ".ind"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relabel_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT trio.</p>
</td></tr>
<tr><td><code id="relabel_+3A_...">...</code></td>
<td>
<p>Population/sample names to merge (each new group defined as a
character vector).</p>
</td></tr>
<tr><td><code id="relabel_+3A_outfile">outfile</code></td>
<td>
<p>Path to an output snp file with coordinates of excluded sites.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updated S3 EIGENSTRAT data object with an additional 'group' slot
specifying the path to a new ind file.
#'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download an example genomic data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# group individual samples into larger populations, creating a new
# EIGENSTRAT R object
new_snps &lt;- relabel(
    snps,
    European = c("French", "Sardinian"),
    African = c("Dinka", "Yoruba", "Mbuti", "Khomani_San"),
    Archaic = c("Vindija", "Altai", "Denisova")
)

## End(Not run)

</code></pre>

<hr>
<h2 id='reset'>Reset modifications to an EIGENSTRAT object</h2><span id='topic+reset'></span>

<h3>Description</h3>

<p>Set 'exclude' and 'group' modifications of snp and ind files, effectively
resetting the dataset into its original state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reset(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reset_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EIGENSTRAT data S3 object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download an example genomic data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# group individual samples into larger populations, creating a new
# EIGENSTRAT R object
new_snps &lt;- relabel(
    snps,
    European = c("French", "Sardinian"),
    African = c("Dinka", "Yoruba", "Mbuti", "Khomani_San"),
    Archaic = c("Vindija", "Altai", "Denisova")
)

# remove the population grouping in the previous step - this
# results in the same EIGENSTRAT object tht we started with
original_snps &lt;- reset(new_snps)

## End(Not run)

</code></pre>

<hr>
<h2 id='transversions_only'>Remove transversions (C-&gt;T and G-&gt;A substitutions)</h2><span id='topic+transversions_only'></span>

<h3>Description</h3>

<p>Remove substitutions that are more likely to be a result of ancient DNA
damage (C-&gt;T and G-&gt;A substitutions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transversions_only(data, outfile = tempfile(fileext = ".snp"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transversions_only_+3A_data">data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td></tr>
<tr><td><code id="transversions_only_+3A_outfile">outfile</code></td>
<td>
<p>Path to an output snp file with coordinates of excluded sites.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updated S3 EIGENSTRAT data object with an additional 'exclude' slot
specifying the path to the set of SNPs to be removed from a downstream
analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # download an example genomic data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# perform the calculation only on transversions
snps_tv &lt;- transversions_only(snps)
results_d &lt;- d(W = "French", X = "Dinka", Y = "Altai", Z = "Chimp", data = snps_tv)

## End(Not run)

</code></pre>

<hr>
<h2 id='write_ind'>Write an EIGENSTRAT ind/snp/geno file.</h2><span id='topic+write_ind'></span><span id='topic+write_snp'></span><span id='topic+write_geno'></span>

<h3>Description</h3>

<p>Write an EIGENSTRAT ind/snp/geno file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_ind(df, file)

write_snp(df, file)

write_geno(df, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_ind_+3A_df">df</code></td>
<td>
<p>A data.frame object.</p>
</td></tr>
<tr><td><code id="write_ind_+3A_file">file</code></td>
<td>
<p>Path to an output file.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
