<!DOCTYPE html><html><head><title>Help for package smurf</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {smurf}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#smurf-package'><p>smurf: Sparse Multi-Type Regularized Feature Modeling</p></a></li>
<li><a href='#coef_reest'><p>Coefficients of Re-estimated Model</p></a></li>
<li><a href='#coef.glmsmurf'><p>Coefficients of Estimated Model</p></a></li>
<li><a href='#deviance_reest'><p>Deviance of Re-estimated Model</p></a></li>
<li><a href='#deviance.glmsmurf'><p>Deviance of Estimated Model</p></a></li>
<li><a href='#fitted_reest'><p>Fitted Values of Re-estimated Model</p></a></li>
<li><a href='#fitted.glmsmurf'><p>Fitted Values of Estimated Model</p></a></li>
<li><a href='#glmsmurf'><p>Fit a Multi-Type Regularized GLM Using the SMuRF Algorithm</p></a></li>
<li><a href='#glmsmurf-class'><p>Class of Multi-Type Regularized GLMs Fitted Using the SMuRF Algorithm</p></a></li>
<li><a href='#glmsmurf.control'><p>Control Function for Fitting a Multi-Type Regularized GLM Using the SMuRF Algorithm.</p></a></li>
<li><a href='#p'><p>Define Individual Subpenalties for a Multi-Type Regularized GLM</p></a></li>
<li><a href='#plot_lambda'><p>Plot Goodness-of-Fit Statistics or Information Criteria</p></a></li>
<li><a href='#plot_reest'><p>Plot Coefficients of Re-estimated Model</p></a></li>
<li><a href='#plot.glmsmurf'><p>Plot Coefficients of Estimated Model</p></a></li>
<li><a href='#predict_reest'><p>Predictions Using Re-estimated Model</p></a></li>
<li><a href='#predict.glmsmurf'><p>Predictions Using Estimated Model</p></a></li>
<li><a href='#residuals_reest'><p>Residuals of Re-estimated Model</p></a></li>
<li><a href='#residuals.glmsmurf'><p>Residuals of Estimated Model</p></a></li>
<li><a href='#summary.glmsmurf'><p>Summary of a Multi-Type Regularized GLM Fitted Using the SMuRF Algorithm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sparse Multi-Type Regularized Feature Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-22</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the SMuRF algorithm of Devriendt et al. (2021) &lt;<a href="https://doi.org/10.1016%2Fj.insmatheco.2020.11.010">doi:10.1016/j.insmatheco.2020.11.010</a>&gt; to fit generalized linear models (GLMs) with multiple types of predictors via regularized maximum likelihood.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/TReynkens/smurf">https://gitlab.com/TReynkens/smurf</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.com/TReynkens/smurf/-/issues">https://gitlab.com/TReynkens/smurf/-/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>catdata, glmnet (&ge; 4.0), graphics, MASS, Matrix, methods,
mgcv, parallel, RColorBrewer, Rcpp (&ge; 0.12.12), stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bookdown, knitr, rmarkdown, roxygen2 (&ge; 6.0.0), testthat</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo (&ge; 0.8.300.1.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-22 16:17:16 UTC; tom</td>
</tr>
<tr>
<td>Author:</td>
<td>Tom Reynkens <a href="https://orcid.org/0000-0002-5516-5107"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Sander Devriendt [aut],
  Katrien Antonio [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tom Reynkens &lt;tomreynkens@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-22 17:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='smurf-package'>smurf: Sparse Multi-Type Regularized Feature Modeling</h2><span id='topic+smurf'></span><span id='topic+smurf-package'></span>

<h3>Description</h3>

<p>Implementation of the SMuRF algorithm of Devriendt et al. (2021) <a href="https://doi.org/10.1016/j.insmatheco.2020.11.010">doi:10.1016/j.insmatheco.2020.11.010</a> to fit generalized linear models (GLMs) with multiple types of predictors via regularized maximum likelihood.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Tom Reynkens <a href="mailto:tomreynkens@hotmail.com">tomreynkens@hotmail.com</a> (<a href="https://orcid.org/0000-0002-5516-5107">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Sander Devriendt <a href="mailto:sander.devriendt@kuleuven.be">sander.devriendt@kuleuven.be</a>
</p>
</li>
<li><p> Katrien Antonio
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://gitlab.com/TReynkens/smurf">https://gitlab.com/TReynkens/smurf</a>
</p>
</li>
<li><p> Report bugs at <a href="https://gitlab.com/TReynkens/smurf/-/issues">https://gitlab.com/TReynkens/smurf/-/issues</a>
</p>
</li></ul>


<hr>
<h2 id='coef_reest'>Coefficients of Re-estimated Model</h2><span id='topic+coef_reest'></span><span id='topic+coef_reest.glmsmurf'></span><span id='topic+coefficients_reest'></span><span id='topic+coefficients_reest.glmsmurf'></span>

<h3>Description</h3>

<p>Function to extract the coefficients of the re-estimated model. 
<code>coefficients_reest</code> is an <em>alias</em> for it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coef_reest(object, ...)

## S3 method for class 'glmsmurf'
coef_reest(object, ...)

coefficients_reest(object, ...)

## S3 method for class 'glmsmurf'
coefficients_reest(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef_reest_+3A_object">object</code></td>
<td>
<p>An object for which the extraction of model coefficients is meaningful. 
E.g. an object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="coef_reest_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the coefficients of the re-estimated model in <code>object</code>, 
when they are available, or, otherwise, the coefficients of the estimated model in <code>object</code> with a warning.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coef.glmsmurf">coef.glmsmurf</a></code>, <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="#topic+summary.glmsmurf">summary.glmsmurf</a></code>, <code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples

</code></pre>

<hr>
<h2 id='coef.glmsmurf'>Coefficients of Estimated Model</h2><span id='topic+coef.glmsmurf'></span><span id='topic+coefficients.glmsmurf'></span>

<h3>Description</h3>

<p>Function to extract the coefficients of the estimated model. 
<code>coefficients</code> is an <em>alias</em> for it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmsmurf'
coef(object, ...)

## S3 method for class 'glmsmurf'
coefficients(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.glmsmurf_+3A_object">object</code></td>
<td>
<p>An object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="coef.glmsmurf_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the coefficients of the estimated model in <code>object</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coef_reest">coef_reest</a></code>, <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="#topic+summary.glmsmurf">summary.glmsmurf</a></code>, <code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples

</code></pre>

<hr>
<h2 id='deviance_reest'>Deviance of Re-estimated Model</h2><span id='topic+deviance_reest'></span><span id='topic+deviance_reest.glmsmurf'></span>

<h3>Description</h3>

<p>Function to extract the deviance of the re-estimated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deviance_reest(object, ...)

## S3 method for class 'glmsmurf'
deviance_reest(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deviance_reest_+3A_object">object</code></td>
<td>
<p>An object for which the extraction of the deviance is meaningful. 
E.g. an object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="deviance_reest_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The deviance of the re-estimated model in <code>object</code>, 
when it is available or, otherwise, the deviance of the estimated model in <code>object</code> with a warning.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+deviance.glmsmurf">deviance.glmsmurf</a></code>, <code><a href="stats.html#topic+deviance">deviance</a></code>, <code><a href="#topic+summary.glmsmurf">summary.glmsmurf</a></code>, 
<code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
   
</code></pre>

<hr>
<h2 id='deviance.glmsmurf'>Deviance of Estimated Model</h2><span id='topic+deviance.glmsmurf'></span>

<h3>Description</h3>

<p>Function to extract the deviance of the estimated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmsmurf'
deviance(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deviance.glmsmurf_+3A_object">object</code></td>
<td>
<p>An object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="deviance.glmsmurf_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The deviance of the estimated model in <code>object</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+deviance_reest">deviance_reest</a></code>, <code><a href="stats.html#topic+deviance">deviance</a></code>, <code><a href="#topic+summary.glmsmurf">summary.glmsmurf</a></code>, 
<code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
         
</code></pre>

<hr>
<h2 id='fitted_reest'>Fitted Values of Re-estimated Model</h2><span id='topic+fitted_reest'></span><span id='topic+fitted_reest.glmsmurf'></span>

<h3>Description</h3>

<p>Function to extract the fitted values of the re-estimated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitted_reest(object, ...)

## S3 method for class 'glmsmurf'
fitted_reest(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted_reest_+3A_object">object</code></td>
<td>
<p>An object for which the extraction of fitted values is meaningful. 
E.g. an object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="fitted_reest_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the fitted values of the re-estimated model in <code>object</code>, 
when they are available or, otherwise, the fitted values of the estimated model in <code>object</code> with a warning.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitted.glmsmurf">fitted.glmsmurf</a></code>, <code><a href="stats.html#topic+fitted.values">fitted</a></code>, <code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
 
</code></pre>

<hr>
<h2 id='fitted.glmsmurf'>Fitted Values of Estimated Model</h2><span id='topic+fitted.glmsmurf'></span>

<h3>Description</h3>

<p>Function to extract the fitted values of the estimated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmsmurf'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.glmsmurf_+3A_object">object</code></td>
<td>
<p>An object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="fitted.glmsmurf_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the fitted values of the estimated model in <code>object</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitted_reest">fitted_reest</a></code>, <code><a href="stats.html#topic+fitted.values">fitted</a></code>, <code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
    
</code></pre>

<hr>
<h2 id='glmsmurf'>Fit a Multi-Type Regularized GLM Using the SMuRF Algorithm</h2><span id='topic+glmsmurf'></span><span id='topic+glmsmurf.fit'></span>

<h3>Description</h3>

<p>SMuRF algorithm to fit a generalized linear model (GLM) with multiple types of predictors via regularized maximum likelihood.
<code>glmsmurf.fit</code> contains the fitting function for a given design matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmsmurf(
  formula,
  family,
  data,
  weights,
  start,
  offset,
  lambda,
  lambda1 = 0,
  lambda2 = 0,
  pen.weights,
  adj.matrix,
  standardize = TRUE,
  control = list(),
  x.return = FALSE,
  y.return = TRUE,
  pen.weights.return = FALSE
)

glmsmurf.fit(
  X,
  y,
  weights,
  start,
  offset,
  family,
  pen.cov,
  n.par.cov,
  group.cov,
  refcat.cov,
  lambda,
  lambda1 = 0,
  lambda2 = 0,
  pen.weights,
  adj.matrix,
  standardize = TRUE,
  control = list(),
  formula = NULL,
  data = NULL,
  x.return = FALSE,
  y.return = FALSE,
  pen.weights.return = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmsmurf_+3A_formula">formula</code></td>
<td>
<p>A <code><a href="stats.html#topic+formula">formula</a></code> object describing the model to be fitted. 
Penalties are specified using the <code><a href="#topic+p">p</a></code> function. For <code>glmsmurf.fit</code> this is an optional argument which is only used when penalty weights are computed using a generalized additive model (GAM).</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_family">family</code></td>
<td>
<p>A <code><a href="stats.html#topic+family">family</a></code> object specifying the error distribution and link function for the model.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_data">data</code></td>
<td>
<p>A data frame containing the model response and predictors for <code>n</code> observations.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_weights">weights</code></td>
<td>
<p>An optional vector of prior weights to use in the likelihood. It should be a numeric vector of length <code>n</code> (the number of observations),
or <code>NULL</code>. When <code>NULL</code> or nothing is given, equal prior weights (all ones) will be used.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_start">start</code></td>
<td>
<p>A vector containing the starting values for the coefficients. It should either be a numeric vector 
of length <code>p+1</code> (with <code>p</code> the number of parameters excluding the intercept) or <code>NULL</code>. In the latter case, the link function applied to the weighted average of the response vector is used 
as starting value for the intercept and zero for the other coefficients.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_offset">offset</code></td>
<td>
<p>A vector containing the offset for the model. It should be a vector of size <code>n</code> or NULL (no offset). 
Offset(s) specified using the <code>formula</code> object will be ignored!</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_lambda">lambda</code></td>
<td>
<p>Either the penalty parameter, a positive number; or a string describing the method and measure used to select the penalty parameter:
</p>

<ul>
<li> <p><code>"is.aic"</code> (in-sample; Akaike Information Criterion (AIC)),
</p>
</li>
<li> <p><code>"is.bic"</code> (in-sample; Bayesian Information Criterion (BIC)),
</p>
</li>
<li> <p><code>"is.gcv"</code> (in-sample; Generalized Cross-Validation (GCV) score),
</p>
</li>
<li> <p><code>"oos.dev"</code> (out-of-sample; deviance), 
</p>
</li>
<li> <p><code>"oos.mse"</code> (out-of-sample; Mean Squared Error (MSE)),
</p>
</li>
<li> <p><code>"oos.dss"</code> (out-of-sample; Dawid-Sebastiani Score (DSS)),
</p>
</li>
<li> <p><code>"cv.dev"</code> (cross-validation (CV); deviance),
</p>
</li>
<li> <p><code>"cv.mse"</code> (CV; MSE),
</p>
</li>
<li> <p><code>"cv.dss"</code> (CV; DSS),
</p>
</li>
<li> <p><code>"cv1se.dev"</code> (CV with one standard error (SE) rule; deviance),
</p>
</li>
<li> <p><code>"cv1se.mse"</code> (CV with one SE rule; MSE),
</p>
</li>
<li> <p><code>"cv1se.dss"</code> (CV with one SE rule; DSS).
</p>
</li></ul>
                 
<p>E.g. <code>"is.aic"</code> indicates in-sample selection of lambda with the AIC as measure.
When <code>lambda</code> is missing or <code>NULL</code>, it will be selected using cross-validation with the one standard error rule and the deviance as measure (<code>"cv1se.dev"</code>).</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_lambda1">lambda1</code></td>
<td>
<p>The penalty parameter for the <code class="reqn">L_1</code>-penalty in Sparse (Generalized) Fused Lasso or Sparse Graph-Guided Fused Lasso is <code class="reqn">\lambda \times \lambda_1</code>. 
A positive numeric with default 0 (no extra  <code class="reqn">L_1</code>-penalty).</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_lambda2">lambda2</code></td>
<td>
<p>The penalty parameter for the <code class="reqn">L_2</code>-penalty in Group (Generalized) Fused Lasso or Group Graph-Guided Fused Lasso is <code class="reqn">\lambda \times \lambda_2</code>. A positive numeric with default 0 (no extra <code class="reqn">L_2</code>-penalty).</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_pen.weights">pen.weights</code></td>
<td>
<p>Either a string describing the method to compute the penalty weights: 
</p>

<ul>
<li> <p><code>"eq"</code> (default; equal penalty weights),
</p>
</li>
<li> <p><code>"stand"</code> (standardization penalty weights),
</p>
</li>
<li> <p><code>"glm"</code> (adaptive GLM penalty weights),
</p>
</li>
<li> <p><code>"glm.stand"</code> (stand. ad. GLM penalty weights), 
</p>
</li>
<li> <p><code>"gam"</code> (ad. GAM penalty weights),
</p>
</li>
<li> <p><code>"gam.stand"</code> (stand. ad. GAM penalty weights);
</p>
</li></ul>
                 
<p>or a list with the penalty weight vector per predictor. This list should have length equal to the number of predictors and predictor names as element names.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_adj.matrix">adj.matrix</code></td>
<td>
<p>A named list containing the adjacency matrices (a.k.a. neighbor matrices) for each of the predictors with a Graph-Guided Fused Lasso penalty. 
The list elements should have the names of the corresponding predictors. If only one predictor has a Graph-Guided Fused Lasso penalty, 
it is also possible to only give the adjacency matrix itself (not in a list).</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_standardize">standardize</code></td>
<td>
<p>Logical indicating if predictors with a Lasso or Group Lasso penalty are standardized, default is <code>TRUE</code>.
The returned coefficients are always on the original (i.e. non-standardized) scale.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_control">control</code></td>
<td>
<p>A list of parameters used in the fitting process. This is passed to <code><a href="#topic+glmsmurf.control">glmsmurf.control</a></code>.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_x.return">x.return</code></td>
<td>
<p>Logical indicating if the used model matrix should be returned in the output object, default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_y.return">y.return</code></td>
<td>
<p>Logical indicating if the used response vector should be returned in the output object, default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_pen.weights.return">pen.weights.return</code></td>
<td>
<p>Logical indicating if the list of the used penalty weight vector per predictor should be returned in the output object, default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_x">X</code></td>
<td>
<p>Only for <code>glmsmurf.fit</code>: the design matrix including ones for the intercept. A <code>n</code> by <code>(p+1)</code> matrix which can
be of numeric matrix class (<code><a href="methods.html#topic+StructureClasses">matrix-class</a></code>) or of class Matrix (<code><a href="Matrix.html#topic+Matrix-class">Matrix-class</a></code>) including sparse matrix class (<code><a href="Matrix.html#topic+dgCMatrix-class">dgCMatrix-class</a></code>).</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_y">y</code></td>
<td>
<p>Only for <code>glmsmurf.fit</code>: the response vector, a numeric vector of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_pen.cov">pen.cov</code></td>
<td>
<p>Only for <code>glmsmurf.fit</code>: a list with the penalty type per predictor (covariate). A named list of strings with predictor names as element names. 
Possible types: <code>"none"</code> (no penalty, e.g. for intercept), <code>"lasso"</code> (Lasso), <code>"grouplasso"</code> (Group Lasso), 
<code>"flasso"</code> (Fused Lasso), <code>"gflasso"</code> (Generalized Fused Lasso), 
<code>"2dflasso"</code> (2D Fused Lasso) or <code>"ggflasso"</code> (Graph-Guided Fused Lasso).</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_n.par.cov">n.par.cov</code></td>
<td>
<p>Only for <code>glmsmurf.fit</code>: a list with the number of parameters to estimate per predictor (covariate). A named list of strictly positive integers with predictor names as element names.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_group.cov">group.cov</code></td>
<td>
<p>Only for <code>glmsmurf.fit</code>: a list with the group of each predictor (covariate) which is only used for the Group Lasso penalty. 
A named list of positive integers with predictor names as element names where 0 means no group.</p>
</td></tr>
<tr><td><code id="glmsmurf_+3A_refcat.cov">refcat.cov</code></td>
<td>
<p>Only for <code>glmsmurf.fit</code>: a list with the number of the reference category in the original order of the levels of each predictor (covariate).
When the predictor is not a factor or no reference category is present, it is equal to 0. This number will only be taken into account for a Fused Lasso, Generalized Fused Lasso or Graph-Guided Fused Lasso penalty 
when a reference category is present.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the package vignette for more details and a complete description of a use case.
</p>
<p>As a user, it is important to take the following into acocunt:
</p>

<ul>
<li><p> The estimated coefficients are rounded to 7 digits.
</p>
</li>
<li><p> The cross-validation folds are not deterministic. The validation sample for selecting lambda out-of-sample is determined at random when no indices are provided 
in 'validation.index' in the control object argument. In these cases, the selected value of lambda is hence not deterministic. 
When selecting lambda in-sample, or out-of-sample when indices are provided in 'validation.index' in the control object argument, the selected value of lambda is deterministic.
</p>
</li>
<li><p> The <code>glmsmurf</code> function can handle many use cases and is preferred for general use.
The <code>glmsmurf.fit</code> function requires a more thorough understanding of the package internals and should hence be used with care!
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class '<code>glmsmurf</code>' is returned. See <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code> for more details about this class and its generic functions.
</p>


<h3>References</h3>

<p>Devriendt, S., Antonio, K., Reynkens, T. and Verbelen, R. (2021). &quot;Sparse Regression with Multi-type Regularized Feature Modeling&quot;, Insurance: Mathematics and Economics, 96, 248&ndash;261. &lt;doi:10.1016/j.insmatheco.2020.11.010&gt;.
</p>
<p>Hastie, T., Tibshirani, R., and Wainwright, M. (2015). <em>Statistical Learning with Sparsity: The Lasso and Generalizations</em>. CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>, <code><a href="#topic+glmsmurf.control">glmsmurf.control</a></code>, <code><a href="#topic+p">p</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Munich rent data from catdata package
data("rent", package = "catdata")

# The considered predictors are the same as in 
# Gertheiss and Tutz (Ann. Appl. Stat., 2010).
# Response is monthly rent per square meter in Euro

# Urban district in Munich
rent$area &lt;- as.factor(rent$area)

# Decade of construction
rent$year &lt;- as.factor(floor(rent$year / 10) * 10)

# Number of rooms
rent$rooms &lt;- as.factor(rent$rooms)

# Quality of the house with levels "fair", "good" and "excellent"
rent$quality &lt;- as.factor(rent$good + 2 * rent$best)
levels(rent$quality) &lt;- c("fair", "good", "excellent")

# Floor space divided in categories (0, 30), [30, 40), ...,  [130, 140)
sizeClasses &lt;- c(0, seq(30, 140, 10))
rent$size &lt;- as.factor(sizeClasses[findInterval(rent$size, sizeClasses)])

# Is warm water present?
rent$warm &lt;- factor(rent$warm, labels = c("yes", "no"))

# Is central heating present?
rent$central &lt;- factor(rent$central, labels = c("yes", "no"))

# Does the bathroom have tiles?
rent$tiles &lt;- factor(rent$tiles, labels = c("yes", "no"))

# Is there special furniture in the bathroom?
rent$bathextra &lt;- factor(rent$bathextra, labels = c("no", "yes"))

# Is the kitchen well-equipped?
rent$kitchen &lt;- factor(rent$kitchen, labels = c("no", "yes"))



# Create formula with 'rentm' as response variable,
# 'area' with a Generalized Fused Lasso penalty,
# 'year', 'rooms', 'quality' and 'size' with Fused Lasso penalties,
# and the other predictors with Lasso penalties.
formu &lt;- rentm ~ p(area, pen = "gflasso") + 
 p(year, pen = "flasso") + p(rooms, pen = "flasso") + 
 p(quality, pen = "flasso") + p(size, pen = "flasso") +
 p(warm, pen = "lasso") + p(central, pen = "lasso") + 
 p(tiles, pen = "lasso") + p(bathextra, pen = "lasso") + 
 p(kitchen, pen = "lasso") 


# Fit a multi-type regularized GLM using the SMuRF algorithm.
# We use standardization adaptive penalty weights based on an initial GLM fit.
# The value for lambda is selected using cross-validation 
# (with the deviance as loss measure and the one standard error rule), see example(plot_lambda) 
munich.fit &lt;- glmsmurf(formula = formu, family = gaussian(), data = rent, 
                       pen.weights = "glm.stand", lambda = 0.02)


####
# S3 methods for glmsmurf objects


# Model summary
summary(munich.fit) 


# Get coefficients of estimated model
coef(munich.fit) 
# Get coefficients of re-estimated model
coef_reest(munich.fit)
 

# Plot coefficients of estimated model
plot(munich.fit)
# Plot coefficients of re-estimated model
plot_reest(munich.fit)


# Get deviance of estimated model
deviance(munich.fit) 
# Get deviance of re-estimated model
deviance_reest(munich.fit)


# Get fitted values of estimated model
fitted(munich.fit) 
# Get fitted values of re-estimated model
fitted_reest(munich.fit)


# Get predicted values of estimated model on scale of linear predictors
predict(munich.fit, type = "link") 
# Get predicted values of re-estimated model on scale of linear predictors
predict_reest(munich.fit, type = "link")


# Get deviance residuals of estimated model
residuals(munich.fit, type = "deviance") 
# Get deviance residuals of re-estimated model
residuals_reest(munich.fit, type = "deviance")
</code></pre>

<hr>
<h2 id='glmsmurf-class'>Class of Multi-Type Regularized GLMs Fitted Using the SMuRF Algorithm</h2><span id='topic+glmsmurf-class'></span>

<h3>Description</h3>

<p>The functions <code><a href="#topic+glmsmurf">glmsmurf</a></code> and <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code> return objects of the S3 class '<code>glmsmurf</code>'
which partially inherits from the '<code>glm</code>' and '<code>lm</code>' classes.
</p>


<h3>Value</h3>

<p>An object of class '<code>glmsmurf</code>' is a list with at least following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>Coefficients of the estimated model.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>Working residuals of the estimated model, see <code><a href="stats.html#topic+glm">glm</a></code>: <code class="reqn">((y_1-\mu_1)/(d\mu/d\eta(\eta_1)), \ldots, (y_n-\mu_n)/(d\mu/d\eta(\eta_n)))</code>.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>Fitted mean values of the estimated model <code class="reqn">(\mu_1, \ldots, \mu_n)=(g^{-1}(\eta_1), \ldots, g^{-1}(\eta_n))</code> with <code class="reqn">g^{-1}</code> the inverse link function.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>Numeric rank of the estimated model, i.e. the number of unique non-zero coefficients.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>The used <code><a href="stats.html#topic+family">family</a></code> object.</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>Linear fit of the estimated model on the link scale <code class="reqn">(\eta_1, \ldots, \eta_n)</code>.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>Deviance of the estimated model: minus twice the log-likelihood, up to a constant.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike Information Criterion of the estimated model: <code class="reqn">-2\times L + 2\times rank</code> with <code class="reqn">L</code> the log-likelihood.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian Information Criterion of the estimated model: <code class="reqn">-2\times L + \ln(n^*)\times rank</code> with <code class="reqn">n^*</code> the number of observations excluding those with weight 0.</p>
</td></tr>
<tr><td><code>gcv</code></td>
<td>
<p>Generalized Cross-Validation score of the estimated model: <code class="reqn">deviance / (n^* \times (1 - rank / n^*)^2).</code></p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>Deviance of the null model, i.e. the model with only an intercept and offset.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>Residual degrees of freedom of the estimated model, i.e. the number of observations (excluding those with weight 0) minus the rank of the estimated model.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>Residual degrees of freedom for the null model, i.e. the number of observations (excluding those with weight 0) minus the rank of the null model.</p>
</td></tr>   
<tr><td><code>obj.fun</code></td>
<td>
<p>Value of the objective function of the estimated model: minus the regularized scaled log-likelihood of the estimated model.</p>
</td></tr>   
<tr><td><code>weights</code></td>
<td>
<p>The prior weights that were initially supplied. 
Note that they are called <code>prior.weights</code> in the output of <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code>offset</code></td>
<td>
<p>The used offset vector.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The used penalty parameter: initially supplied by the user, or selected in-sample, out-of-sample or using cross-validation.</p>
</td></tr>
<tr><td><code>lambda1</code></td>
<td>
<p>The used penalty parameter for the <code class="reqn">L_1</code>-penalty in Sparse (Generalized) Fused Lasso or 
Sparse Graph-Guided Fused Lasso is <code class="reqn">\lambda \times \lambda_1</code></p>
</td></tr>
<tr><td><code>lambda2</code></td>
<td>
<p>The used penalty parameter for the <code class="reqn">L_2</code>-penalty in Group (Generalized) Fused Lasso or 
Group Graph-Guided Fused Lasso is <code class="reqn">\lambda \times \lambda_2</code>.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>The number of iterations that are performed to fit the model.</p>
</td></tr>   
<tr><td><code>converged</code></td>
<td>
<p>An integer code indicating whether the algorithm converged successfully:
</p>

<dl>
<dt>0</dt><dd><p>Successful convergence.</p>
</dd>
<dt>1</dt><dd><p>Maximum number of iterations reached.</p>
</dd>
<dt>2</dt><dd><p>Two subsequent restarts were performed.</p>
</dd>
<dt>3</dt><dd><p>Low step size (i.e. below 1e-14).</p>
</dd>
</dl>
</td></tr>
<tr><td><code>final.stepsize</code></td>
<td>
<p>Final step size used in the algorithm.</p>
</td></tr>
<tr><td><code>n.par.cov</code></td>
<td>
<p>List with number of parameters to estimate per predictor (covariate).</p>
</td></tr>
<tr><td><code>pen.cov</code></td>
<td>
<p>List with penalty type per predictor (covariate).</p>
</td></tr>
<tr><td><code>group.cov</code></td>
<td>
<p>List with group of each predictor (covariate) for Group Lasso where 0 means no group.</p>
</td></tr> 
<tr><td><code>refcat.cov</code></td>
<td>
<p>List with number of the reference category in the original order of the levels of each predictor (covariate) where 0 indicates no reference category.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>The used control list, see <code><a href="#topic+glmsmurf.control">glmsmurf.control</a></code>.</p>
</td></tr>
</table>
<p>Optionally, following elements are also included:
</p>
<table>
<tr><td><code>X</code></td>
<td>
<p>The model matrix, only returned when the argument <code>x.return</code> in <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code> is <code>TRUE</code>.</p>
</td></tr> 
<tr><td><code>y</code></td>
<td>
<p>The response vector, only returned when the argument <code>y.return</code> in <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code> is <code>TRUE</code>.</p>
</td></tr> 
<tr><td><code>pen.weights</code></td>
<td>
<p>List with the vector of penalty weights per predictor (covariate), only returned when the argument <code>pen.weights.return</code> in <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code> is <code>TRUE</code>.</p>
</td></tr> 
</table>
<p>When the model is re-estimated, i.e. <code>reest = TRUE</code> in <code><a href="#topic+glmsmurf.control">glmsmurf.control</a></code>, 
the following components are also present:
</p>
<table>
<tr><td><code>glm.reest</code></td>
<td>
<p>Output from the call to <code><a href="stats.html#topic+glm">glm</a></code> to fit the re-estimated model.</p>
</td></tr>
<tr><td><code>coefficients.reest</code></td>
<td>
<p>Coefficients of the re-estimated model.</p>
</td></tr>
<tr><td><code>residuals.reest</code></td>
<td>
<p>Working residuals of the re-estimated model.</p>
</td></tr>
<tr><td><code>fitted.values.reest</code></td>
<td>
<p>Fitted mean values of the re-estimated model.</p>
</td></tr>
<tr><td><code>rank.reest</code></td>
<td>
<p>Numeric rank of the re-estimated model, i.e. the number of unique non-zero re-estimated coefficients.</p>
</td></tr>
<tr><td><code>linear.predictors.reest</code></td>
<td>
<p>Linear fit of the re-estimated model on the link scale.</p>
</td></tr>
<tr><td><code>deviance.reest</code></td>
<td>
<p>Deviance of the re-estimated model.</p>
</td></tr> 
<tr><td><code>aic.reest</code></td>
<td>
<p>AIC of the re-estimated model.</p>
</td></tr>
<tr><td><code>bic.reest</code></td>
<td>
<p>BIC of the re-estimated model.</p>
</td></tr>
<tr><td><code>gcv.reest</code></td>
<td>
<p>GCV score of the re-estimated model.</p>
</td></tr>
<tr><td><code>df.residual.reest</code></td>
<td>
<p>Residual degrees of freedom of the re-estimated model.</p>
</td></tr>
<tr><td><code>obj.fun.reest</code></td>
<td>
<p>Value of the objective function of the re-estimated model: minus the regularized scaled log-likelihood of the re-estimated model.</p>
</td></tr>
<tr><td><code>X.reest</code></td>
<td>
<p>The model matrix used in the re-estimation, only returned when the argument <code>x.return</code> in <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code> is <code>TRUE</code>.</p>
</td></tr> 
</table>
<p>When lambda is not given as input but selected in-sample, out-of-sample or using cross-validation, 
i.e. the <code>lambda</code> argument in <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code> is a string describing the selection method, 
the following components are also present:
</p>
<table>
<tr><td><code>lambda.method</code></td>
<td>
<p>Method (in-sample, out-of-sample or cross-validation (possibly with the one standard error rule)) and measure (AIC, BIC, GCV score, deviance, MSE or DSS) used to select <code>lambda</code>.
E.g. <code>"is.bic"</code> indicates in-sample selection of lambda with the BIC as measure.</p>
</td></tr>
<tr><td><code>lambda.vector</code></td>
<td>
<p>Vector of <code>lambda</code> values that were considered in the selection process.</p>
</td></tr>
<tr><td><code>lambda.measures</code></td>
<td>
<p>List with for each of the relevant measures a matrix containing for each considered value of <code>lambda</code> (rows) 
the measure for the whole data (in-sample), for the validation data (out-of-sample) or per cross-validation fold (cross-validation) (columns).</p>
</td></tr>
<tr><td><code>lambda.coefficients</code></td>
<td>
<p>Matrix containing for each considered value of <code>lambda</code> (rows) the estimated (when <code>lambda.reest = FALSE</code> in <code><a href="#topic+glmsmurf.control">glmsmurf.control</a></code>)
or re-estimated (when <code>lambda.reest = TRUE</code>) coefficients when selecting lambda in-sample or out-of-sample (or using cross-validation with one fold); and <code>NULL</code> otherwise.</p>
</td></tr>
</table>
<p>When the object is output from <code><a href="#topic+glmsmurf">glmsmurf</a></code>, following elements are also included:   
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>The supplied formula.</p>
</td></tr>  
<tr><td><code>terms</code></td>
<td>
<p>The <code><a href="stats.html#topic+terms">terms</a></code> object used.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>The contrasts used (when relevant).</p>
</td></tr>  
<tr><td><code>xlevels</code></td>
<td>
<p>The levels of the factors used in fitting (when relevant).</p>
</td></tr>
</table>


<h3>S3 generics</h3>

<p>Following S3 generic functions are available for an object of class &quot;<code>glmsmurf</code>&quot;:
</p>

<dl>
<dt><code><a href="#topic+coef.glmsmurf">coef</a></code></dt><dd><p>Extract coefficients of the estimated model.</p>
</dd>
<dt><code><a href="#topic+coef_reest">coef_reest</a></code></dt><dd><p>Extract coefficients of the re-estimated model, when available.</p>
</dd>
<dt><code><a href="#topic+deviance.glmsmurf">deviance</a></code></dt><dd><p>Extract deviance of the estimated model.</p>
</dd>
<dt><code><a href="#topic+deviance_reest">deviance_reest</a></code></dt><dd><p>Extract deviance of the re-estimated model, when available.</p>
</dd>
<dt><code><a href="stats.html#topic+glm.summaries">family</a></code></dt><dd><p>Extract family object.</p>
</dd>
<dt><code><a href="#topic+fitted.glmsmurf">fitted</a></code></dt><dd><p>Extract fitted values of the estimated model.</p>
</dd>
<dt><code><a href="#topic+fitted_reest">fitted_reest</a></code></dt><dd><p>Extract fitted values of the re-estimated model, when available.</p>
</dd>   
<dt><code><a href="#topic+plot.glmsmurf">plot</a></code></dt><dd><p>Plot coefficients of the estimated model.</p>
</dd> 
<dt><code><a href="#topic+plot_reest">plot_reest</a></code></dt><dd><p>Plot coefficients of the re-estimated model, when available.</p>
</dd> 
<dt><code><a href="#topic+plot_lambda">plot_lambda</a></code></dt><dd><p>Plot goodness-of-fit statistics or information criteria
as a function of lambda, when lambda is selected in-sample, out-of-sample or 
using cross-validation.</p>
</dd> 
<dt><code><a href="#topic+predict.glmsmurf">predict</a></code></dt><dd><p>Obtain predictions using the estimated model.</p>
</dd>
<dt><code><a href="#topic+predict_reest">predict_reest</a></code></dt><dd><p>Obtain predictions using the re-estimated model, when available.</p>
</dd>   
<dt><code><a href="#topic+residuals.glmsmurf">residuals</a></code></dt><dd><p>Extract residuals of the estimated model.</p>
</dd> 
<dt><code><a href="#topic+residuals_reest">residuals_reest</a></code></dt><dd><p>Extract residuals of the re-estimated model, when available.</p>
</dd> 
<dt><code><a href="#topic+summary.glmsmurf">summary</a></code></dt><dd><p>Print a summary of the estimated model, and of the re-estimated model (when available).</p>
</dd>    
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples

</code></pre>

<hr>
<h2 id='glmsmurf.control'>Control Function for Fitting a Multi-Type Regularized GLM Using the SMuRF Algorithm.</h2><span id='topic+glmsmurf.control'></span>

<h3>Description</h3>

<p>Control function to handle parameters for fitting a multi-type regularized generalized linear model (GLM) using the SMuRF algorithm.
The function sets defaults and performs input checks on the provided parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmsmurf.control(
  epsilon = 1e-08,
  maxiter = 10000,
  step = NULL,
  tau = 0.5,
  reest = TRUE,
  lambda.vector = NULL,
  lambda.min = NULL,
  lambda.max = NULL,
  lambda.length = 50L,
  lambda.reest = FALSE,
  k = 5L,
  oos.prop = 0.2,
  validation.index = NULL,
  ncores = NULL,
  po.ncores = NULL,
  print = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmsmurf.control_+3A_epsilon">epsilon</code></td>
<td>
<p>Numeric tolerance value for stopping criterion. A numeric strictly larger than 0, default is <code>1e-8</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations of the SMuRF algorithm. A numeric larger than or equal to 1, default is <code>10 000</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_step">step</code></td>
<td>
<p>Initial step size, a numeric strictly larger than 0 or <code>NULL</code>. When <code>NULL</code> (default), it is equal to <code>0.1</code> times the sample size.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_tau">tau</code></td>
<td>
<p>Parameter for backtracking the step size. A numeric strictly between 0 and 1, default is 0.5.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_reest">reest</code></td>
<td>
<p>A logical indicating if the obtained (reduced) model is re-estimated using <code><a href="stats.html#topic+glm">glm</a></code>. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_lambda.vector">lambda.vector</code></td>
<td>
<p>Values of lambda to consider when selecting the optimal value of lambda. A vector of strictly positive numerics (which is preferably a decreasing sequence as we make use of warm starts) or <code>NULL</code> (default).
When <code>NULL</code>, it is set to an exponential decreasing sequence of length <code>lambda.length</code> between <code>lambda.max</code> and <code>lambda.min</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_lambda.min">lambda.min</code></td>
<td>
<p>Minimum value of lambda to consider when selecting the optimal value of lambda. A strictly positive numeric or <code>NULL</code> (default).
When <code>NULL</code>, it is equal to <code>0.0001</code> times <code>lambda.max</code>. This argument is ignored when <code>lambda.vector</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_lambda.max">lambda.max</code></td>
<td>
<p>Maximum value of lambda to consider when selecting the optimal value of lambda. A strictly positive numeric larger than <code>lambda.min</code> or <code>NULL</code> (default).
In the latter case, <code>lambda.max</code> will be determined based on the used penalty types such that it is one of the smallest values of lambda that results in an intercept-only model. This argument is ignored when <code>lambda.vector</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_lambda.length">lambda.length</code></td>
<td>
<p>Number of lambda values to consider when selecting the optimal value of lambda. A strictly positive integer, default is 50. This argument is ignored when <code>lambda.vector</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_lambda.reest">lambda.reest</code></td>
<td>
<p>Logical indicating if the re-estimated coefficients are used when selecting lambda, default is <code>FALSE</code>.
This argument is only used if <code>reest</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_k">k</code></td>
<td>
<p>Number of folds when selecting lambda using cross-validation. A strictly positive integer, default is 5 (i.e. five-fold cross-validation). This number cannot be larger than the number of observations. Note that cross-validation with one fold (<code>k=1</code>) is the same as in-sample selection of <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_oos.prop">oos.prop</code></td>
<td>
<p>Proportion of the data that is used as the validation sample when selecting <code>lambda</code> out-of-sample. A numeric strictly between 0 and 1, default is 0.2.
This argument is ignored when <code>validation.index</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_validation.index">validation.index</code></td>
<td>
<p>Vector containing the row indices of the data matrix corresponding to the observations that are used as the validation sample.
This argument is only used when <code>lambda</code> is selected out-of-sample. Default is <code>NULL</code> meaning that randomly 100*<code>oos.prop</code>% of the data are used as validation sample.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores used when performing cross-validation. A strictly positive integer or <code>NULL</code> (default). 
When <code>NULL</code>, <code>max(nc-1,1)</code> cores are used where <code>nc</code> is the number of cores as determined by <code><a href="parallel.html#topic+detectCores">detectCores</a></code>.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_po.ncores">po.ncores</code></td>
<td>
<p>Number of cores used when computing the proximal operators. A strictly positive integer or <code>NULL</code> (default).
When <code>NULL</code> or <code>ncores &gt; 1</code>, <code>po.ncores</code> is set to 1.</p>
</td></tr>
<tr><td><code id="glmsmurf.control_+3A_print">print</code></td>
<td>
<p>A logical indicating if intermediate results need to be printed, default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details on the selection of lambda can be found in the package vignette.
</p>


<h3>Value</h3>

<p>A list with elements named as the arguments.
</p>


<h3>See Also</h3>

<p>Fitting procedures: <code><a href="#topic+glmsmurf">glmsmurf</a></code> and <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code> (given design matrix). <code><a href="stats.html#topic+glm.control">glm.control</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(plot_lambda) for examples 
</code></pre>

<hr>
<h2 id='p'>Define Individual Subpenalties for a Multi-Type Regularized GLM</h2><span id='topic+p'></span>

<h3>Description</h3>

<p>Function used to define regularization terms in a <code><a href="#topic+glmsmurf">glmsmurf</a></code> model formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p(pred1, pred2 = NULL, pen = "lasso", refcat = NULL, group = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_+3A_pred1">pred1</code></td>
<td>
<p>Name of the predictor used in the regularization term.</p>
</td></tr>
<tr><td><code id="p_+3A_pred2">pred2</code></td>
<td>
<p>Either <code>NULL</code> (default) meaning that only one predictor is used in the regularization term, or the name of the second predictor that is used in a 2D Fused Lasso regularization term.</p>
</td></tr>
<tr><td><code id="p_+3A_pen">pen</code></td>
<td>
<p>Type of penalty for this predictor, one of 
</p>

<ul>
<li> <p><code>"none"</code> (no penalty),
</p>
</li>
<li> <p><code>"lasso"</code> (Lasso),
</p>
</li>
<li> <p><code>"grouplasso"</code> (Group Lasso),
</p>
</li>
<li> <p><code>"flasso"</code> (Fused Lasso), 
</p>
</li>
<li> <p><code>"gflasso"</code> (Generalized Fused Lasso),
</p>
</li>
<li> <p><code>"2dflasso"</code> (2D Fused Lasso),
</p>
</li>
<li> <p><code>"ggflasso"</code> (Graph-Guided Fused Lasso).
</p>
</li></ul>
  
<p>Default is <code>"lasso"</code>.</p>
</td></tr>
<tr><td><code id="p_+3A_refcat">refcat</code></td>
<td>
<p>Reference level when <code>pred1</code> is a factor and <code>pen</code> is <code>"none"</code>, <code>"flasso"</code>, <code>"gflasso"</code>, or <code>"ggflasso"</code>;
otherwise <code>refcat</code> is ignored. Default is <code>NULL</code> which means that the first level of <code>pred1</code> is used as the reference level (if <code>refcat</code> is not ignored).</p>
</td></tr>
<tr><td><code id="p_+3A_group">group</code></td>
<td>
<p>Group to which the predictor belongs, only used for a Group Lasso penalty. 
Default is <code>NULL</code> which means that predictor does not belong to a group.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Predictors with no penalty, a Lasso penalty or a Group Lasso penalty should be numeric or a factor which can be non-numeric.  
Predictors with a Fused Lasso, Generalized Fused Lasso, Graph-Guided Fused Lasso or 2D Fused Lasso penalty should be given as a factor 
which can also be non-numeric. When a predictor is given as a factor, there cannot be any unused levels.
</p>
<p>For a predictor with a Fused Lasso penalty, the levels should be ordered from smallest to largest. 
The first level will be the reference level, but this can be changed using the <code>refcat</code> argument.
</p>
<p>When <code>lambda * lambda1 &gt; 0</code> or <code>lambda * lambda2 &gt; 0</code> in <code><a href="#topic+glmsmurf">glmsmurf</a></code>, no reference level is used
for the Fused Lasso, Generalized Fused Lasso and Graph-Guided Fused Lasso penalties, and <code>refcat</code> will hence be ignored.
</p>
<p>If <code>pred2</code> is different from <code>NULL</code>, <code>pen</code> should be set to <code>"2dflasso"</code>, and vice versa.
Note that there cannot be any unused levels in the interaction between <code>pred1</code> and <code>pred2</code>.
</p>
<p>When adding an interaction between <code>pred1</code> and <code>pred2</code> with a 2D Fused Lasso penalty, the 1D effects
should also be present in the model and the reference categories for the 1D predictors need to be the respective first levels. 
The reference level for the 2D predictor will then be the 2D level where it least one of the 1D components is equal to the 1D reference levels. 
It is also allowed to add binned factors, of predictors
that are included in the model, in the interaction. They should have the original predictor name + '.binned' as predictor names.
For example: the original predictors 'age' and 'power' are included in the model and
the interaction of 'age.binned' and 'power.binned' can also be present in the model formula.
</p>
<p>An overview of the different penalty types and their usage can be found in the package vignette.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glmsmurf">glmsmurf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Munich rent data from catdata package
data("rent", package = "catdata")

# The considered predictors are the same as in 
# Gertheiss and Tutz (Ann. Appl. Stat., 2010).
# Response is monthly rent per square meter in Euro

# Urban district in Munich
rent$area &lt;- as.factor(rent$area)

# Decade of construction
rent$year &lt;- as.factor(floor(rent$year / 10) * 10)

# Number of rooms
rent$rooms &lt;- as.factor(rent$rooms)

# Quality of the house with levels "fair", "good" and "excellent"
rent$quality &lt;- as.factor(rent$good + 2 * rent$best)
levels(rent$quality) &lt;- c("fair", "good", "excellent")

# Floor space divided in categories (0, 30), [30, 40), ...,  [130, 140)
sizeClasses &lt;- c(0, seq(30, 140, 10))
rent$size &lt;- as.factor(sizeClasses[findInterval(rent$size, sizeClasses)])

# Is warm water present?
rent$warm &lt;- factor(rent$warm, labels = c("yes", "no"))

# Is central heating present?
rent$central &lt;- factor(rent$central, labels = c("yes", "no"))

# Does the bathroom have tiles?
rent$tiles &lt;- factor(rent$tiles, labels = c("yes", "no"))

# Is there special furniture in the bathroom?
rent$bathextra &lt;- factor(rent$bathextra, labels = c("no", "yes"))

# Is the kitchen well-equipped?
rent$kitchen &lt;- factor(rent$kitchen, labels = c("no", "yes"))



# Create formula with 'rentm' as response variable,
# 'area' with a Generalized Fused Lasso penalty,
# 'year', 'rooms', 'quality' and 'size' with Fused Lasso penalties 
# where the reference category for 'year' is changed to 2000,
# 'warm' and 'central' are in one group for the Group Lasso penalty,
# 'tiles' and 'bathextra' are not regularized and 
# 'kitchen' has a Lasso penalty
formu &lt;- rentm ~ p(area, pen = "gflasso") + 
  p(year, pen = "flasso", refcat = 2000) + p(rooms, pen = "flasso") + 
  p(quality, pen = "flasso") + p(size, pen = "flasso") +
  p(warm, pen = "grouplasso", group = 1) + p(central, pen = "grouplasso", group = 1) + 
  p(tiles, pen = "none") + bathextra + 
  p(kitchen, pen = "lasso")


# Fit a multi-type regularized GLM using the SMuRF algorithm.
# We use standardization adaptive penalty weights based on an initial GLM fit.
munich.fit &lt;- glmsmurf(formula = formu, family = gaussian(), data = rent, 
                       pen.weights = "glm.stand", lambda = 0.1)

# Model summary
summary(munich.fit) 
</code></pre>

<hr>
<h2 id='plot_lambda'>Plot Goodness-of-Fit Statistics or Information Criteria</h2><span id='topic+plot_lambda'></span><span id='topic+plot_lambda.glmsmurf'></span>

<h3>Description</h3>

<p>Function to plot the goodness-of-fit statistics or information criteria
as a function of lambda when lambda is selected in-sample, out-of-sample or using cross-validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_lambda(x, ...)

## S3 method for class 'glmsmurf'
plot_lambda(
  x,
  xlab = NULL,
  ylab = NULL,
  lambda.opt = TRUE,
  cv1se = TRUE,
  log.lambda = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_lambda_+3A_x">x</code></td>
<td>
<p>An object for which the extraction of goodness-of-fit statistics or information criteria is meaningful. 
E.g. an object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="plot_lambda_+3A_...">...</code></td>
<td>
<p>Additional arguments for the <code><a href="graphics.html#topic+plot.default">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="plot_lambda_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis. The default value is <code>NULL</code> which means that <code>substitute(log(lambda))</code> is used when <code>log.lambda=TRUE</code>
and <code>substitute(lambda)</code> when <code>log.lambda=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_lambda_+3A_ylab">ylab</code></td>
<td>
<p>Label for the y-axis. The default value is <code>NULL</code> which means that the y-axis label is 
determined based on method that was used to select lambda.</p>
</td></tr>
<tr><td><code id="plot_lambda_+3A_lambda.opt">lambda.opt</code></td>
<td>
<p>Logical indicating if the optimal value of lambda should be indicated on the plot 
by a vertical dashed line. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_lambda_+3A_cv1se">cv1se</code></td>
<td>
<p>Logical indicating if the standard errors should be indicated on the plot 
when cross-validation with the one standard error rule is performed (e.g. &quot;cv1se.dev&quot;). Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_lambda_+3A_log.lambda">log.lambda</code></td>
<td>
<p>Logical indicating if the logarithm of lambda is plotted on the x-axis, default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot can only be made when lambda is selected in-sample, out-of-sample or using cross-validation (possibly with the one standard error rule), 
see the <code>lambda</code> argument of <code><a href="#topic+glmsmurf">glmsmurf</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Munich rent data from catdata package
data("rent", package = "catdata")

# The considered predictors are the same as in 
# Gertheiss and Tutz (Ann. Appl. Stat., 2010).
# Response is monthly rent per square meter in Euro

# Urban district in Munich
rent$area &lt;- as.factor(rent$area)

# Decade of construction
rent$year &lt;- as.factor(floor(rent$year / 10) * 10)

# Number of rooms
rent$rooms &lt;- as.factor(rent$rooms)

# Quality of the house with levels "fair", "good" and "excellent"
rent$quality &lt;- as.factor(rent$good + 2 * rent$best)
levels(rent$quality) &lt;- c("fair", "good", "excellent")

# Floor space divided in categories (0, 30), [30, 40), ...,  [130, 140)
sizeClasses &lt;- c(0, seq(30, 140, 10))
rent$size &lt;- as.factor(sizeClasses[findInterval(rent$size, sizeClasses)])

# Is warm water present?
rent$warm &lt;- factor(rent$warm, labels = c("yes", "no"))

# Is central heating present?
rent$central &lt;- factor(rent$central, labels = c("yes", "no"))

# Does the bathroom have tiles?
rent$tiles &lt;- factor(rent$tiles, labels = c("yes", "no"))

# Is there special furniture in the bathroom?
rent$bathextra &lt;- factor(rent$bathextra, labels = c("no", "yes"))

# Is the kitchen well-equipped?
rent$kitchen &lt;- factor(rent$kitchen, labels = c("no", "yes"))



# Create formula with 'rentm' as response variable,
# 'area' with a Generalized Fused Lasso penalty,
# 'year', 'rooms', 'quality' and 'size' with Fused Lasso penalties,
# and the other predictors with Lasso penalties.
formu &lt;- rentm ~ p(area, pen = "gflasso") + 
  p(year, pen = "flasso") + p(rooms, pen = "flasso") + 
  p(quality, pen = "flasso") + p(size, pen = "flasso") +
  p(warm, pen = "lasso") + p(central, pen = "lasso") + 
  p(tiles, pen = "lasso") + p(bathextra, pen = "lasso") + 
  p(kitchen, pen = "lasso") 

# Fit a multi-type regularized GLM using the SMuRF algorithm and select the optimal value of lambda 
# using cross-validation (with the deviance as loss measure and the one standard error rule).
# We use standardization adaptive penalty weights based on an initial GLM fit.
# The number of values of lambda to consider in cross-validation is
# set to 10 using the control argument (default is 50).
munich.fit.cv &lt;- glmsmurf(formula = formu, family = gaussian(), data = rent, 
                          pen.weights = "glm.stand", lambda = "cv1se.dev",
                          control = list(lambda.length = 10L, ncores = 1L))


# Plot average deviance over cross-validation folds as a function of the logarithm of lambda
plot_lambda(munich.fit.cv)
# Zoomed plot
plot_lambda(munich.fit.cv, xlim = c(-7, -3.5), ylim = c(1575, 1750))

</code></pre>

<hr>
<h2 id='plot_reest'>Plot Coefficients of Re-estimated Model</h2><span id='topic+plot_reest'></span><span id='topic+plot_reest.glmsmurf'></span>

<h3>Description</h3>

<p>Function to plot the coefficients of the re-estimated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_reest(x, ...)

## S3 method for class 'glmsmurf'
plot_reest(
  x,
  xlab = "Index",
  ylab = "Re-estimated coefficients",
  basic = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_reest_+3A_x">x</code></td>
<td>
<p>An object for which the extraction of model coefficients is meaningful. 
E.g. an object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="plot_reest_+3A_...">...</code></td>
<td>
<p>Additional arguments for the <code><a href="graphics.html#topic+plot.default">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="plot_reest_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis, default is <code>"Index"</code>.</p>
</td></tr>
<tr><td><code id="plot_reest_+3A_ylab">ylab</code></td>
<td>
<p>Label for the y-axis, default is <code>"Re-estimated coefficients"</code>.</p>
</td></tr>
<tr><td><code id="plot_reest_+3A_basic">basic</code></td>
<td>
<p>Logical indicating if the basic lay-out is used for the plot, default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the re-estimated model is not included in <code>x</code>, 
the coefficients of the estimated model in <code>x</code> are plotted with a warning.
</p>
<p>See <code><a href="#topic+plot.glmsmurf">plot.glmsmurf</a></code> for more details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.glmsmurf">plot.glmsmurf</a></code>, <code><a href="#topic+coef_reest">coef_reest</a></code>, <code><a href="#topic+summary.glmsmurf">summary.glmsmurf</a></code>, <code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
</code></pre>

<hr>
<h2 id='plot.glmsmurf'>Plot Coefficients of Estimated Model</h2><span id='topic+plot.glmsmurf'></span>

<h3>Description</h3>

<p>Function to plot the coefficients of the estimated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmsmurf'
plot(x, xlab = "Index", ylab = "Estimated coefficients", basic = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.glmsmurf_+3A_x">x</code></td>
<td>
<p>An object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="plot.glmsmurf_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis, default is <code>"Index"</code>.</p>
</td></tr>
<tr><td><code id="plot.glmsmurf_+3A_ylab">ylab</code></td>
<td>
<p>Label for the y-axis, default is <code>"Estimated coefficients"</code>.</p>
</td></tr>
<tr><td><code id="plot.glmsmurf_+3A_basic">basic</code></td>
<td>
<p>Logical indicating if the basic lay-out is used for the plot, default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.glmsmurf_+3A_...">...</code></td>
<td>
<p>Additional arguments for the <code><a href="graphics.html#topic+plot.default">plot</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>basic=FALSE</code>, the improved lay-out for the plot is used. Per predictor, groups of equal coefficients are indicated
in the same color (up to 8 colors), and zero coefficients are indicated by grey squares.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_reest">plot_reest</a></code>, <code><a href="#topic+coef.glmsmurf">coef.glmsmurf</a></code>, <code><a href="#topic+summary.glmsmurf">summary.glmsmurf</a></code>, <code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
</code></pre>

<hr>
<h2 id='predict_reest'>Predictions Using Re-estimated Model</h2><span id='topic+predict_reest'></span><span id='topic+predict_reest.glmsmurf'></span>

<h3>Description</h3>

<p>Function to obtain predictions using the re-estimated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_reest(object, ...)

## S3 method for class 'glmsmurf'
predict_reest(
  object,
  newdata = NULL,
  newoffset = NULL,
  type = c("link", "response", "terms"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_reest_+3A_object">object</code></td>
<td>
<p>An object for which predictions are meaningful. 
E.g. an object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="predict_reest_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
<tr><td><code id="predict_reest_+3A_newdata">newdata</code></td>
<td>
<p>Optionally, a data frame containing the predictors used in the prediction. 
This can only be used when <code>object</code> contains a formula. 
When <code>newdata</code> is omitted, the predictions are based on the data used to fit the model in <code>object</code>.</p>
</td></tr>
<tr><td><code id="predict_reest_+3A_newoffset">newoffset</code></td>
<td>
<p>Optionally, a vector containing a new offset to be used in the prediction.
When <code>newoffset</code> is omitted, the predictions use the offset which was used to fit the model in <code>object</code>.</p>
</td></tr>
<tr><td><code id="predict_reest_+3A_type">type</code></td>
<td>
<p>Type of prediction. The default is on the scale of the linear predictors (<code>"link"</code>).
Another option is on the scale of the response variable (<code>"response"</code>). 
For type <code>"terms"</code> a matrix containing the fitted values of each term in the model, on the linear predictor scale, is returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the predicted values using the re-estimated model in <code>object</code>, 
when this is available, or, otherwise, the predicted values using the estimated model in <code>object</code> with a warning.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.glmsmurf">predict.glmsmurf</a></code>, <code><a href="stats.html#topic+predict.glm">predict.glm</a></code>, <code><a href="stats.html#topic+predict">predict</a></code>, 
<code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
          
</code></pre>

<hr>
<h2 id='predict.glmsmurf'>Predictions Using Estimated Model</h2><span id='topic+predict.glmsmurf'></span>

<h3>Description</h3>

<p>Function to obtain predictions using the estimated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmsmurf'
predict(
  object,
  newdata = NULL,
  newoffset = NULL,
  type = c("link", "response", "terms"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.glmsmurf_+3A_object">object</code></td>
<td>
<p>An object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="predict.glmsmurf_+3A_newdata">newdata</code></td>
<td>
<p>Optionally, a data frame containing the predictors used in the prediction. 
This can only be used when <code>object</code> contains a formula. 
When <code>newdata</code> is omitted, the predictions are based on the data used to fit the model in <code>object</code>.</p>
</td></tr>
<tr><td><code id="predict.glmsmurf_+3A_newoffset">newoffset</code></td>
<td>
<p>Optionally, a vector containing a new offset to be used in the prediction.
When <code>newoffset</code> is omitted, the predictions use the offset which was used to fit the model in <code>object</code>.</p>
</td></tr>
<tr><td><code id="predict.glmsmurf_+3A_type">type</code></td>
<td>
<p>Type of prediction. The default is on the scale of the linear predictors (<code>"link"</code>).
Another option is on the scale of the response variable (<code>"response"</code>). 
For type <code>"terms"</code> a matrix containing the fitted values of each term in the model, on the linear predictor scale, is returned.</p>
</td></tr>
<tr><td><code id="predict.glmsmurf_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the predicted values using the estimated model in <code>object</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_reest">predict_reest</a></code>, <code><a href="stats.html#topic+predict.glm">predict.glm</a></code>, <code><a href="stats.html#topic+predict">predict</a></code>, 
<code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
         
</code></pre>

<hr>
<h2 id='residuals_reest'>Residuals of Re-estimated Model</h2><span id='topic+residuals_reest'></span><span id='topic+residuals_reest.glmsmurf'></span><span id='topic+resid_reest'></span><span id='topic+resid_reest.glmsmurf'></span>

<h3>Description</h3>

<p>Function to extract the residuals of the re-estimated model. 
<code>resid_reest</code> is an <em>alias</em> for it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>residuals_reest(object, ...)

## S3 method for class 'glmsmurf'
residuals_reest(
  object,
  type = c("deviance", "pearson", "working", "response", "partial"),
  ...
)

resid_reest(object, ...)

## S3 method for class 'glmsmurf'
resid_reest(
  object,
  type = c("deviance", "pearson", "working", "response", "partial"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals_reest_+3A_object">object</code></td>
<td>
<p>An object for which the extraction of model residuals is meaningful. 
E.g. an object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="residuals_reest_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
<tr><td><code id="residuals_reest_+3A_type">type</code></td>
<td>
<p>Type of residuals that should be returned. One of <code>"deviance"</code> (default), 
<code>"pearson"</code>, <code>"working"</code>, <code>"response"</code> or <code>"partial"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="stats.html#topic+glm.summaries">glm.summaries</a></code> for an overview of the different types of residuals.
</p>


<h3>Value</h3>

<p>A vector containing the residuals of the re-estimated model in <code>object</code>
when they are available, or, otherwise, the residuals of the estimated model in <code>object</code> with a warning.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+residuals.glmsmurf">residuals.glmsmurf</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+glm.summaries">glm.summaries</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
 
</code></pre>

<hr>
<h2 id='residuals.glmsmurf'>Residuals of Estimated Model</h2><span id='topic+residuals.glmsmurf'></span><span id='topic+resid.glmsmurf'></span>

<h3>Description</h3>

<p>Function to extract the residuals of the estimated model. 
<code>resid</code> is an <em>alias</em> for it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmsmurf'
residuals(
  object,
  type = c("deviance", "pearson", "working", "response", "partial"),
  ...
)

## S3 method for class 'glmsmurf'
resid(
  object,
  type = c("deviance", "pearson", "working", "response", "partial"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.glmsmurf_+3A_object">object</code></td>
<td>
<p>An object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="residuals.glmsmurf_+3A_type">type</code></td>
<td>
<p>Type of residuals that should be returned. One of <code>"deviance"</code> (default), 
<code>"pearson"</code>, <code>"working"</code>, <code>"response"</code> or <code>"partial"</code>.</p>
</td></tr>
<tr><td><code id="residuals.glmsmurf_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="stats.html#topic+glm.summaries">glm.summaries</a></code> for an overview of the different types of residuals.
</p>


<h3>Value</h3>

<p>A vector containing the residuals of the estimated model in <code>object</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+residuals_reest">residuals_reest</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+glm.summaries">glm.summaries</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples
  
</code></pre>

<hr>
<h2 id='summary.glmsmurf'>Summary of a Multi-Type Regularized GLM Fitted Using the SMuRF Algorithm</h2><span id='topic+summary.glmsmurf'></span>

<h3>Description</h3>

<p>Function to print a summary of a <code>glmsmurf</code>-object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmsmurf'
summary(object, digits = 3L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.glmsmurf_+3A_object">object</code></td>
<td>
<p>An object of class '<code><a href="#topic+glmsmurf-class">glmsmurf</a></code>', typically the result of a call to <code><a href="#topic+glmsmurf">glmsmurf</a></code> or <code><a href="#topic+glmsmurf.fit">glmsmurf.fit</a></code>.</p>
</td></tr>
<tr><td><code id="summary.glmsmurf_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits used when printing, default is 3.</p>
</td></tr>
<tr><td><code id="summary.glmsmurf_+3A_...">...</code></td>
<td>
<p>Additional arguments which are currently ignored.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+summary.glm">summary.glm</a></code>, <code><a href="#topic+glmsmurf">glmsmurf</a></code>, <code><a href="#topic+glmsmurf-class">glmsmurf-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example(glmsmurf) for examples

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
