<!DOCTYPE html><html><head><title>Help for package xgxr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {xgxr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#case1_pkpd'><p>Case 1 PKPD Data Set</p></a></li>
<li><a href='#edit_rmd_template_str'><p>Edit a Rmd Template from xgx</p></a></li>
<li><a href='#get_rmd_name'><p>Determine the name of a Rmd template</p></a></li>
<li><a href='#get_rmd_str'><p><code>get_rmd_str</code> returns a Rmd template string, based on the desired PKPD parameters</p></a></li>
<li><a href='#mad'><p>Multiple Ascending Dose Data Set</p></a></li>
<li><a href='#mad_missing_duplicates'><p>Multiple Ascending Dose Data Set (Duplicates Removed)</p></a></li>
<li><a href='#mad_nca'><p>Multiple Ascending Dose Noncompartmental Analysis (NCA) dataset</p></a></li>
<li><a href='#nlmixr_theo_sd'><p>nlmixr Theophylline SD Data Set</p></a></li>
<li><a href='#predict.nls'><p>predict.nls</p></a></li>
<li><a href='#predictdf'><p>Prediction data frame from ggplot2</p>
Get predictions with standard errors into data frame</a></li>
<li><a href='#predictdf.nls'><p>Prediction data frame for nls</p></a></li>
<li><a href='#predictdf.polr'><p>Prediction data frame for polr</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#sad'><p>Single Ascending Dose Data Set</p></a></li>
<li><a href='#StatSmoothOrdinal'><p>Stat object for producing smooths through ordinal data</p></a></li>
<li><a href='#StatSummaryBinQuant'><p>Stat ggproto object for binning by quantile for xgx_stat_ci</p></a></li>
<li><a href='#StatSummaryOrdinal'><p>Stat ggproto object for creating ggplot layers of binned confidence intervals</p>
for probabiliities of classes in ordinal data</a></li>
<li><a href='#theme_xgx'><p>Calls the standard theme for xGx graphics</p></a></li>
<li><a href='#xgx_annotate_filenames'><p>Append filenames to bottom of the plot</p></a></li>
<li><a href='#xgx_annotate_status'><p>Create a status (e.g. DRAFT) annotation layer</p></a></li>
<li><a href='#xgx_annotate_status_png'><p>Annotate a png file or directory of png files</p></a></li>
<li><a href='#xgx_auto_explore'><p>Produce an xgx-styled report the given dataset using xgx R markdown templates,</p>
or a user-provided R markdown template.  (Note: The R markdown template provided must
be formatted in a similar manner to that of the xgx R markdown templates to work.)
The working directory will contain a new directory ('xgx_autoexplore_output') after running this function,
which will contain a directory for the dataset, and futher a directory for the type of analysis / R markdown template.</a></li>
<li><a href='#xgx_breaks_log10'><p>Sets the default breaks for log10</p></a></li>
<li><a href='#xgx_breaks_time'><p>Sets the default breaks for a time axis</p></a></li>
<li><a href='#xgx_check_data'><p>Check data for various issues</p></a></li>
<li><a href='#xgx_conf_int'><p><code>xgx_conf_int</code> returns a dataframe with mean +/- confidence intervals</p></a></li>
<li><a href='#xgx_dirs2char'><p>Append filenames to bottom of the plot</p></a></li>
<li><a href='#xgx_geom_ci'><p>Plot data with mean and confidence intervals</p></a></li>
<li><a href='#xgx_geom_pi'><p>Plot data with median and percent intervals</p></a></li>
<li><a href='#xgx_labels_log10'><p>Nice labels for log10.</p></a></li>
<li><a href='#xgx_minor_breaks_log10'><p>Sets the default minor_breaks for log10 scales</p></a></li>
<li><a href='#xgx_plot'><p>Create a new xgx plot</p></a></li>
<li><a href='#xgx_save'><p>Saving plot, automatically annotating the status and denoting the filenames</p></a></li>
<li><a href='#xgx_save_table'><p>Saving table as an image, also labeling the program that created the table</p>
and where the table is stored</a></li>
<li><a href='#xgx_scale_x_log10'><p>log10 scales the x axis with a &quot;pretty&quot; set of breaks</p></a></li>
<li><a href='#xgx_scale_x_reverselog10'><p>Reverse-log transform for the x scale.</p></a></li>
<li><a href='#xgx_scale_x_time_units'><p>Convert time units for plotting</p></a></li>
<li><a href='#xgx_scale_y_log10'><p>log10 scales the y axis with a &quot;pretty&quot; set of breaks</p></a></li>
<li><a href='#xgx_scale_y_percentchangelog10'><p>percentchangelog10 transform for the y scale.</p></a></li>
<li><a href='#xgx_scale_y_reverselog10'><p>Reverselog transform for the y scale.</p></a></li>
<li><a href='#xgx_stat_ci'><p>Plot data with mean and confidence intervals</p></a></li>
<li><a href='#xgx_stat_pi'><p>Plot data with median and percent intervals</p></a></li>
<li><a href='#xgx_stat_smooth'><p>Wrapper for stat_smooth</p></a></li>
<li><a href='#xgx_summarize_covariates'><p>Summarize Covariate information in a dataset</p></a></li>
<li><a href='#xgx_summarize_data'><p>Check data for various issues</p></a></li>
<li><a href='#xgx_theme'><p>Calls the standard theme for xGx graphics</p></a></li>
<li><a href='#xgx_theme_set'><p>Sets the standard theme for xGx graphics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Exploratory Graphics for Pharmacometrics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Supports a structured approach
    for exploring PKPD data <a href="https://opensource.nibr.com/xgx/">https://opensource.nibr.com/xgx/</a>. It also
    contains helper functions for enabling the modeler to follow best R
    practices (by appending the program name, figure name location, and
    draft status to each plot). In addition, it enables the modeler to
    follow best graphical practices (by providing a theme that
    reduces chart ink, and by providing time-scale, log-scale, and
    reverse-log-transform-scale functions for more readable axes).
    Finally, it provides some data checking and summarizing functions for
    rapidly exploring pharmacokinetics and pharmacodynamics (PKPD) datasets.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://opensource.nibr.com/xgx/">https://opensource.nibr.com/xgx/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Novartis/xgxr/issues">https://github.com/Novartis/xgxr/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>assertthat, binom, Deriv, DescTools, dplyr, ggplot2, glue,
graphics, grDevices, gtable, Hmisc, labeling, magrittr,
minpack.lm, pander, png, RCurl, readr, scales, stats, stringr,
tibble, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>caTools, gridExtra, knitr, pkgdown, rmarkdown, testthat,
tidyr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-22 12:37:10 UTC; steinanf</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew Stein [aut, cre],
  Alison Margolskee [aut],
  Fariba Khanshan [aut],
  Konstantin Krismer
    <a href="https://orcid.org/0000-0001-8994-3416"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Matthew Fidler <a href="https://orcid.org/0000-0001-8538-6691"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Novartis Pharma AG [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Stein &lt;andy.stein@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-22 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Value</h3>

<p>result of piped operation
</p>

<hr>
<h2 id='case1_pkpd'>Case 1 PKPD Data Set</h2><span id='topic+case1_pkpd'></span>

<h3>Description</h3>

<p>Case 1 PKPD Data Set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>case1_pkpd
</code></pre>


<h3>Format</h3>

<p>A data frame with the following 21 columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
  column 1: </td><td style="text-align: left;"> <code>ID</code> </td><td style="text-align: left;"> integer; unique subject ID</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 2: </td><td style="text-align: left;"> <code>TIME</code> </td><td style="text-align: left;"> numeric; time relative to first drug 
  administration</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 3: </td><td style="text-align: left;"> <code>NOMTIME</code> </td><td style="text-align: left;"> numeric; nominal time</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 4: </td><td style="text-align: left;"> <code>TIMEUNIT</code> </td><td style="text-align: left;"> factor; unit of TIME</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 5: </td><td style="text-align: left;"> <code>AMT</code> </td><td style="text-align: left;"> integer; dosing amount (for dosing events) 
  in mg</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 6: </td><td style="text-align: left;"> <code>LIDV</code> </td><td style="text-align: left;"> numeric; observation on a linear scale 
  (observation type determined by CMT), units determined by EVENTU column</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 7: </td><td style="text-align: left;"> <code>CMT</code> </td><td style="text-align: left;"> integer; compartment number 
  (determines observation type):</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 1 = Dosing event</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 2 = PK concentration</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 3 = Continuous response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 4 = Count response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 5 = Ordinal response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 6 = Binary response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 8: </td><td style="text-align: left;"> <code>NAME</code> </td><td style="text-align: left;"> factor; description of event</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 9: </td><td style="text-align: left;"> <code>EVENTU</code> </td><td style="text-align: left;"> factor; unit for observation</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 10: </td><td style="text-align: left;"> <code>CENS</code> </td><td style="text-align: left;"> integer; censored values
  (0 = not censored, 1 = censored)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 11: </td><td style="text-align: left;"> <code>EVID</code> </td><td style="text-align: left;"> integer; event ID (0 = observation, 
  1 = dosing event)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 12: </td><td style="text-align: left;"> <code>WEIGHTB</code> </td><td style="text-align: left;"> numeric; baseline body weight (kg)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 13: </td><td style="text-align: left;"> <code>eff0</code> </td><td style="text-align: left;"> numeric; efficacy</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 14: </td><td style="text-align: left;"> <code>TRTACT</code> </td><td style="text-align: left;"> factor; treatment group label</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 15: </td><td style="text-align: left;"> <code>DOSE</code> </td><td style="text-align: left;"> integer; Dose in mg</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 16: </td><td style="text-align: left;"> <code>PROFDAY</code> </td><td style="text-align: left;"> integer; day of profile</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 17: </td><td style="text-align: left;"> <code>PROFTIME</code> </td><td style="text-align: left;"> numeric; time within PROFDAY</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 18: </td><td style="text-align: left;"> <code>CYCLE</code> </td><td style="text-align: left;"> integer; count of drug administrations
  received</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 19: </td><td style="text-align: left;"> <code>PART</code> </td><td style="text-align: left;"> integer; part of study</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 20: </td><td style="text-align: left;"> <code>STUDY</code> </td><td style="text-align: left;"> integer; study</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 21: </td><td style="text-align: left;"> <code>IPRED</code> </td><td style="text-align: left;"> numeric; individual prediction</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>


<hr>
<h2 id='edit_rmd_template_str'>Edit a Rmd Template from xgx</h2><span id='topic+edit_rmd_template_str'></span>

<h3>Description</h3>

<p><code>edit_rmd_template_str</code> returns a path to the altered Rmd template
</p>


<h3>Usage</h3>

<pre><code class='language-R'>edit_rmd_template_str(
  rmd_str = NULL,
  mapping = NULL,
  rmd_output_path = NULL,
  data_path = NULL,
  multiple_dosing = FALSE,
  pk_cmt = NULL,
  pd_cmt = NULL,
  dose_cmt = NULL,
  steady_state_day = NULL,
  time_between_doses = NULL,
  author_name = NULL,
  add_datetime = TRUE,
  show_explanation = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="edit_rmd_template_str_+3A_rmd_str">rmd_str</code></td>
<td>
<p>A character string containing the Rmd template raw characters</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_mapping">mapping</code></td>
<td>
<p>A list of column name mappings from the
original (template) dataset column names
to the corresponding columns in the new dataset</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_rmd_output_path">rmd_output_path</code></td>
<td>
<p>A custom output path for the generated Rmd file
(This is typically left as 'NULL' in order to maintain the hierarchical directory structure of 'xgx_autoexplore_output'))</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_data_path">data_path</code></td>
<td>
<p>Path (as a string) to the dataset that is to be analyzed</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_multiple_dosing">multiple_dosing</code></td>
<td>
<p>if FALSE use single ascending dose template, if TRUE use multiple</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_pk_cmt">pk_cmt</code></td>
<td>
<p>An integer denoting the &quot;compartment&quot; containing the PK data. The &quot;CMT&quot; column will typically
have these integers, where each row may contain either PK or PD data, potentially of different types (continuous, ordinal, etc.)</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_pd_cmt">pd_cmt</code></td>
<td>
<p>An integer denoting the &quot;compartment&quot; containing the PD data, of the desired type  (continuous, ordinal, etc.). The &quot;CMT&quot; column will typically
have these integers, where each row may contain either PK or PD data</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_dose_cmt">dose_cmt</code></td>
<td>
<p>CMT associated with dosing event</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_steady_state_day">steady_state_day</code></td>
<td>
<p>For multiple ascending dose, what day is steady state rich profile?</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_time_between_doses">time_between_doses</code></td>
<td>
<p>time interval between doses</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_author_name">author_name</code></td>
<td>
<p>The name of the author to be displayed on the template</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_add_datetime">add_datetime</code></td>
<td>
<p>Boolean indicating additon of a date stamp to the beginnning of the Rmd file</p>
</td></tr>
<tr><td><code id="edit_rmd_template_str_+3A_show_explanation">show_explanation</code></td>
<td>
<p>Boolean indicating if the additional explanations (text in between figures) are needed for the user.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string of the new R markdown template
</p>

<hr>
<h2 id='get_rmd_name'>Determine the name of a Rmd template</h2><span id='topic+get_rmd_name'></span>

<h3>Description</h3>

<p><code>get_rmd_name</code> returns a name for an Rmd template, based on the desired PKPD parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rmd_name(
  rmd_template_name = NULL,
  multiple_dosing = FALSE,
  pk_cmt = NULL,
  pd_cmt = NULL,
  pd_data_type = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rmd_name_+3A_rmd_template_name">rmd_template_name</code></td>
<td>
<p>A custom output name for the generated Rmd file</p>
</td></tr>
<tr><td><code id="get_rmd_name_+3A_multiple_dosing">multiple_dosing</code></td>
<td>
<p>if FALSE use single ascending dose template, if TRUE use multiple</p>
</td></tr>
<tr><td><code id="get_rmd_name_+3A_pk_cmt">pk_cmt</code></td>
<td>
<p>An integer denoting the &quot;compartment&quot; containing the PK data. The &quot;CMT&quot; column will typically
have these integers, where each row may contain either PK or PD data, potentially of different types (continuous, ordinal, etc.)</p>
</td></tr>
<tr><td><code id="get_rmd_name_+3A_pd_cmt">pd_cmt</code></td>
<td>
<p>An integer denoting the &quot;compartment&quot; containing the PD data, of the desired type  (continuous, ordinal, etc.). The &quot;CMT&quot; column will typically
have these integers, where each row may contain either PK or PD data</p>
</td></tr>
<tr><td><code id="get_rmd_name_+3A_pd_data_type">pd_data_type</code></td>
<td>
<p>The type of PD data - acceptable values exist in the following list: [&quot;binary&quot;,&quot;continuous&quot;,&quot;count&quot;,&quot;ordinal&quot;,&quot;real_example&quot;,&quot;receptor_occupancy&quot;,&quot;time_to_event&quot;]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a string for the Rmd template name
</p>

<hr>
<h2 id='get_rmd_str'><code>get_rmd_str</code> returns a Rmd template string, based on the desired PKPD parameters</h2><span id='topic+get_rmd_str'></span>

<h3>Description</h3>

<p><code>get_rmd_str</code> returns a Rmd template string, based on the desired PKPD parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rmd_str(
  rmd_template_name = NULL,
  multiple_dosing = FALSE,
  pk_cmt = NULL,
  pd_cmt = NULL,
  pd_data_type = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rmd_str_+3A_rmd_template_name">rmd_template_name</code></td>
<td>
<p>A custom output name for the generated Rmd file</p>
</td></tr>
<tr><td><code id="get_rmd_str_+3A_multiple_dosing">multiple_dosing</code></td>
<td>
<p>if FALSE use single ascending dose template, if TRUE use multiple</p>
</td></tr>
<tr><td><code id="get_rmd_str_+3A_pk_cmt">pk_cmt</code></td>
<td>
<p>An integer denoting the &quot;compartment&quot; containing the PK data. The &quot;CMT&quot; column will typically
have these integers, where each row may contain either PK or PD data, potentially of different types (continuous, ordinal, etc.)</p>
</td></tr>
<tr><td><code id="get_rmd_str_+3A_pd_cmt">pd_cmt</code></td>
<td>
<p>An integer denoting the &quot;compartment&quot; containing the PD data, of the desired type  (continuous, ordinal, etc.). The &quot;CMT&quot; column will typically
have these integers, where each row may contain either PK or PD data</p>
</td></tr>
<tr><td><code id="get_rmd_str_+3A_pd_data_type">pd_data_type</code></td>
<td>
<p>The type of PD data - acceptable values exist in the following list: [&quot;binary&quot;,&quot;continuous&quot;,&quot;count&quot;,&quot;ordinal&quot;,&quot;real_example&quot;,&quot;receptor_occupancy&quot;,&quot;time_to_event&quot;]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a string for the Rmd template name
</p>

<hr>
<h2 id='mad'>Multiple Ascending Dose Data Set</h2><span id='topic+mad'></span>

<h3>Description</h3>

<p>Model generated PK and PD data to mimic an orally administered small
molecule with various endpoints from continuous to ordinal response and
count data. Simulated multiple dose administration ranging from 100 mg
to 1600 mg, once per day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mad
</code></pre>


<h3>Format</h3>

<p>A data frame with the following 19 columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
  column 1: </td><td style="text-align: left;"> <code>ID</code> </td><td style="text-align: left;"> numeric; unique subject ID</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 2: </td><td style="text-align: left;"> <code>TIME</code> </td><td style="text-align: left;"> numeric; time relative to first drug 
  administration</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 3: </td><td style="text-align: left;"> <code>NOMTIME</code> </td><td style="text-align: left;"> numeric; nominal time</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 4: </td><td style="text-align: left;"> <code>TIMEUNIT</code> </td><td style="text-align: left;"> character; unit of TIME</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 5: </td><td style="text-align: left;"> <code>AMT</code> </td><td style="text-align: left;"> numeric; dosing amount (for dosing events) 
  in mg</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 6: </td><td style="text-align: left;"> <code>LIDV</code> </td><td style="text-align: left;"> numeric; observation on a linear scale 
  (observation type determined by CMT), units determined by EVENTU column</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 7: </td><td style="text-align: left;"> <code>MDV</code> </td><td style="text-align: left;"> numeric; missing dependent variable</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 8: </td><td style="text-align: left;"> <code>CMT</code> </td><td style="text-align: left;"> integer; compartment number 
  (determines observation type):</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 1 = Dosing event</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 2 = PK concentration</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 3 = Continuous response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 4 = Count response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 5 = Ordinal response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 6 = Binary response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 9: </td><td style="text-align: left;"> <code>NAME</code> </td><td style="text-align: left;"> character; description of event</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 10: </td><td style="text-align: left;"> <code>EVENTU</code> </td><td style="text-align: left;"> character; unit for observation</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 11: </td><td style="text-align: left;"> <code>CENS</code> </td><td style="text-align: left;"> integer; censored values
  (0 = not censored, 1 = censored)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 12: </td><td style="text-align: left;"> <code>EVID</code> </td><td style="text-align: left;"> integer; event ID (0 = observation, 
  1 = dosing event)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 13: </td><td style="text-align: left;"> <code>WEIGHTB</code> </td><td style="text-align: left;"> numeric; baseline body weight (kg)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 14: </td><td style="text-align: left;"> <code>SEX</code> </td><td style="text-align: left;"> character; sex</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 15: </td><td style="text-align: left;"> <code>TRTACT</code> </td><td style="text-align: left;"> factor; treatment group label</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 16: </td><td style="text-align: left;"> <code>DOSE</code> </td><td style="text-align: left;"> numeric; randomized dose in mg</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 17: </td><td style="text-align: left;"> <code>PROFDAY</code> </td><td style="text-align: left;"> numeric; day of profile</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 18: </td><td style="text-align: left;"> <code>PROFTIME</code> </td><td style="text-align: left;"> numeric; time within PROFDAY</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 19: </td><td style="text-align: left;"> <code>CYCLE</code> </td><td style="text-align: left;"> numeric; count of drug administrations 
  received
</td>
</tr>

</table>


<hr>
<h2 id='mad_missing_duplicates'>Multiple Ascending Dose Data Set (Duplicates Removed)</h2><span id='topic+mad_missing_duplicates'></span>

<h3>Description</h3>

<p>Model generated PK and PD data to mimic an orally administered small
molecule with various endpoints from continuous to ordinal response and
count data. Simulated multiple dose administration ranging from 100 mg
to 1600 mg, once per day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mad_missing_duplicates
</code></pre>


<h3>Format</h3>

<p>A data frame with the following 19 columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
  column 1: </td><td style="text-align: left;"> <code>ID</code> </td><td style="text-align: left;"> numeric; unique subject ID</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 2: </td><td style="text-align: left;"> <code>TIME</code> </td><td style="text-align: left;"> numeric; time relative to first drug 
  administration</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 3: </td><td style="text-align: left;"> <code>NOMTIME</code> </td><td style="text-align: left;"> numeric; nominal time</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 4: </td><td style="text-align: left;"> <code>TIMEUNIT</code> </td><td style="text-align: left;"> character; unit of TIME</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 5: </td><td style="text-align: left;"> <code>AMT</code> </td><td style="text-align: left;"> numeric; dosing amount (for dosing events) 
  in mg</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 6: </td><td style="text-align: left;"> <code>LIDV</code> </td><td style="text-align: left;"> numeric; observation on a linear scale 
  (observation type determined by CMT), units determined by EVENTU column</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 7: </td><td style="text-align: left;"> <code>MDV</code> </td><td style="text-align: left;"> numeric; missing dependent variable</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 8: </td><td style="text-align: left;"> <code>CMT</code> </td><td style="text-align: left;"> integer; compartment number 
  (determines observation type):</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 1 = Dosing event</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 2 = PK concentration</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 3 = Continuous response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 4 = Count response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 5 = Ordinal response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 6 = Binary response data</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 9: </td><td style="text-align: left;"> <code>NAME</code> </td><td style="text-align: left;"> character; description of event</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 10: </td><td style="text-align: left;"> <code>EVENTU</code> </td><td style="text-align: left;"> character; unit for observation</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 11: </td><td style="text-align: left;"> <code>CENS</code> </td><td style="text-align: left;"> integer; censored values
  (0 = not censored, 1 = censored)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 12: </td><td style="text-align: left;"> <code>EVID</code> </td><td style="text-align: left;"> integer; event ID (0 = observation, 
  1 = dosing event)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 13: </td><td style="text-align: left;"> <code>WEIGHTB</code> </td><td style="text-align: left;"> numeric; baseline body weight (kg)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 14: </td><td style="text-align: left;"> <code>SEX</code> </td><td style="text-align: left;"> character; sex</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 15: </td><td style="text-align: left;"> <code>TRTACT</code> </td><td style="text-align: left;"> factor; treatment group label</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 16: </td><td style="text-align: left;"> <code>DOSE</code> </td><td style="text-align: left;"> numeric; randomized dose in mg</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 17: </td><td style="text-align: left;"> <code>PROFDAY</code> </td><td style="text-align: left;"> numeric; day of profile</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 18: </td><td style="text-align: left;"> <code>PROFTIME</code> </td><td style="text-align: left;"> numeric; time within PROFDAY</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 19: </td><td style="text-align: left;"> <code>CYCLE</code> </td><td style="text-align: left;"> numeric; count of drug administrations 
  received
</td>
</tr>

</table>


<hr>
<h2 id='mad_nca'>Multiple Ascending Dose Noncompartmental Analysis (NCA) dataset</h2><span id='topic+mad_nca'></span>

<h3>Description</h3>

<p>Multiple Ascending Dose Noncompartmental Analysis (NCA) dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mad_nca
</code></pre>


<h3>Format</h3>

<p>A data frame with the following 7 columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
  column 1: </td><td style="text-align: left;"> <code>ID</code> </td><td style="text-align: left;"> numeric; unique subject ID</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 2: </td><td style="text-align: left;"> <code>PARAM</code> </td><td style="text-align: left;"> character; NCA parameter</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 3: </td><td style="text-align: left;"> <code>VALUE</code> </td><td style="text-align: left;"> numeric; Value of the NCA parameter</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 4: </td><td style="text-align: left;"> <code>DOSE</code> </td><td style="text-align: left;"> numeric; randomized dose in mg</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 15: </td><td style="text-align: left;"> <code>TRTACT</code> </td><td style="text-align: left;"> factor; treatment group label</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 14: </td><td style="text-align: left;"> <code>SEX</code> </td><td style="text-align: left;"> character; sex</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 13: </td><td style="text-align: left;"> <code>WEIGHTB</code> </td><td style="text-align: left;"> numeric; baseline body weight (kg)
</td>
</tr>

</table>


<hr>
<h2 id='nlmixr_theo_sd'>nlmixr Theophylline SD Data Set</h2><span id='topic+nlmixr_theo_sd'></span>

<h3>Description</h3>

<p>Theophylline dataset, from the nlmixr R package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlmixr_theo_sd
</code></pre>


<h3>Format</h3>

<p>A data frame with the following 7 columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
  column 1: </td><td style="text-align: left;"> <code>ID</code> </td><td style="text-align: left;"> integer; unique patient identifier</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 2: </td><td style="text-align: left;"> <code>TIME</code> </td><td style="text-align: left;"> numeric; time relative to first drug 
  administration</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 3: </td><td style="text-align: left;"> <code>DV</code> </td><td style="text-align: left;"> numeric; dependent variable (drug concentration) </td>
</tr>
<tr>
 <td style="text-align: right;">
  column 4: </td><td style="text-align: left;"> <code>AMT</code> </td><td style="text-align: left;"> numeric; dose of drug </td>
</tr>
<tr>
 <td style="text-align: right;">
  column 5: </td><td style="text-align: left;"> <code>EVID</code> </td><td style="text-align: left;"> integer; event ID, 1 if dose, 0 otherwise</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 6: </td><td style="text-align: left;"> <code>CMT</code> </td><td style="text-align: left;"> integer; compartment number</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 7: </td><td style="text-align: left;"> <code>WT</code> </td><td style="text-align: left;"> numeric; weight
</td>
</tr>

</table>


<hr>
<h2 id='predict.nls'>predict.nls</h2><span id='topic+predict.nls'></span>

<h3>Description</h3>

<p>predict.nls
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nls'
predict(
  object,
  newdata = NULL,
  se.fit = FALSE,
  interval = "none",
  level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.nls_+3A_object">object</code></td>
<td>
<p>Object of class inheriting from &quot;nls&quot;</p>
</td></tr>
<tr><td><code id="predict.nls_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with which to predict. 
If omitted, the fitted values are used.</p>
</td></tr>
<tr><td><code id="predict.nls_+3A_se.fit">se.fit</code></td>
<td>
<p>A switch indicating if standard errors are required.</p>
</td></tr>
<tr><td><code id="predict.nls_+3A_interval">interval</code></td>
<td>
<p>Type of interval calculation, &quot;none&quot; or &quot;confidence&quot;</p>
</td></tr>
<tr><td><code id="predict.nls_+3A_level">level</code></td>
<td>
<p>Level of confidence interval to use</p>
</td></tr>
<tr><td><code id="predict.nls_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the predictions produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>predict.nls</code> produces a vector of predictions or a matrix of predictions and 
bounds with column names <code>fit</code>, <code>lwr</code>, and <code>upr</code> if interval is set. 
</p>
<p>If <code>se.fit</code> is <code>TRUE</code>, a list with the following components is returned:
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>vector or matrix as above</p>
</td></tr>
<tr><td><code>se.fit</code></td>
<td>
<p>standard error of predicted means</p>
</td></tr>
<tr><td><code>residual.scale</code></td>
<td>
<p>residual standard deviations</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom for residual</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(12345)
data_to_plot &lt;- data.frame(x1 = rep(c(0, 25, 50, 100, 200, 400, 600), 10)) %&gt;%
  dplyr::mutate(AUC = x1*rlnorm(length(x1), 0, 0.3),
         x2 = x1*stats::rlnorm(length(x1), 0, 0.3),
         Response = (15 + 50*x2/(20+x2))*stats::rlnorm(length(x2), 0, 0.3))


gg &lt;- ggplot2::ggplot(data = data_to_plot, ggplot2::aes(x = AUC, y = Response)) + 
  ggplot2::geom_point() + 
  xgx_geom_smooth(method = "nls",  
                  method.args = list(formula = y ~ E0 + Emax* x / (EC50 + x),
                                     start = list(E0 = 15, Emax = 50, EC50 = 20) ), 
                  color = "black", size = 0.5, alpha = 0.25)
gg

mod &lt;- stats::nls(formula = Response ~ E0 + Emax * AUC / (EC50 + AUC), 
data = data_to_plot, 
start = list(E0 = 15, Emax = 50, EC50 = 20))

predict.nls(mod)

predict.nls(mod, se.fit = TRUE)

predict.nls(mod, 
            newdata = data.frame(AUC = c(0, 25, 50, 100, 200, 400, 600)), 
            se.fit = TRUE)
            
predict.nls(mod, 
            newdata = data.frame(AUC = c(0, 25, 50, 100, 200, 400, 600)), 
            se.fit = TRUE, interval = "confidence", level = 0.95)
            
predict(mod, 
            newdata = data.frame(AUC = c(0, 25, 50, 100, 200, 400, 600)), 
            se.fit = TRUE, interval = "confidence", level = 0.95)

</code></pre>

<hr>
<h2 id='predictdf'>Prediction data frame from ggplot2
Get predictions with standard errors into data frame</h2><span id='topic+predictdf'></span>

<h3>Description</h3>

<p>Prediction data frame from ggplot2
Get predictions with standard errors into data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictdf(model, xseq, se, level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictdf_+3A_model">model</code></td>
<td>
<p>model object</p>
</td></tr>
<tr><td><code id="predictdf_+3A_xseq">xseq</code></td>
<td>
<p>newdata</p>
</td></tr>
<tr><td><code id="predictdf_+3A_se">se</code></td>
<td>
<p>Display confidence interval around smooth?</p>
</td></tr>
<tr><td><code id="predictdf_+3A_level">level</code></td>
<td>
<p>Level of confidence interval to use</p>
</td></tr>
</table>

<hr>
<h2 id='predictdf.nls'>Prediction data frame for nls</h2><span id='topic+predictdf.nls'></span>

<h3>Description</h3>

<p>Get predictions with standard errors into data frame for use with geom_smooth
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nls'
predictdf(model, xseq, se, level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictdf.nls_+3A_model">model</code></td>
<td>
<p>nls object</p>
</td></tr>
<tr><td><code id="predictdf.nls_+3A_xseq">xseq</code></td>
<td>
<p>newdata</p>
</td></tr>
<tr><td><code id="predictdf.nls_+3A_se">se</code></td>
<td>
<p>Display confidence interval around smooth?</p>
</td></tr>
<tr><td><code id="predictdf.nls_+3A_level">level</code></td>
<td>
<p>Level of confidence interval to use</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ggplot2::geom_smooth</code> produces confidence intervals by silently calling functions 
of the form predictdf.method, where method is &quot;loess&quot;, &quot;lm&quot;, &quot;glm&quot; etc. 
depending on what method is specified in the call to <code>geom_smooth</code>. 
Currently <code>ggplot2</code> does not define a <code>predictdf.nls</code> function for method of type &quot;nls&quot;, 
and thus confidence intervals cannot be automatically generated by <code>geom_smooth</code> 
for method = &quot;nls&quot;. Here we define <code>predictdf.nls</code> for calculating the confidence 
intervals of an object of type nls. <code>geom_smooth</code> will silently call this function 
whenever method = &quot;nls&quot;, and produce the appropriate confidence intervals.
</p>
<p><code>predictdf.nls</code> calculates CI for a model fit of class nls based on the &quot;delta-method&quot; 
http://sia.webpopix.org/nonlinearRegression.html#confidence-intervals-and-prediction-intervals)
</p>
<p>CI = [ f(x0, beta) + qt_(alpha/2, n - d) * se(f(x0, beta)),
f(x0, beta) + qt_(1 - alpha/2, n - d) * se(f(x0, beta))]
</p>
<p>where:
beta = vector of parameter estimates
x = independent variable
se(f(x0, beta)) = sqrt( delta(f)(x0, beta) * Var(beta) * (delta(f)(x0, beta))' )
delta(f) is the gradient of f
</p>


<h3>Value</h3>

<p>dataframe with x and y values, if se is TRUE dataframe also includes ymin and ymax
</p>

<hr>
<h2 id='predictdf.polr'>Prediction data frame for polr</h2><span id='topic+predictdf.polr'></span>

<h3>Description</h3>

<p>Get predictions with standard errors into data frame for use with geom_smooth
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'polr'
predictdf(model, xseq, se, level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictdf.polr_+3A_model">model</code></td>
<td>
<p>object returned from polr</p>
</td></tr>
<tr><td><code id="predictdf.polr_+3A_xseq">xseq</code></td>
<td>
<p>sequence of x values for which to compute the smooth</p>
</td></tr>
<tr><td><code id="predictdf.polr_+3A_se">se</code></td>
<td>
<p>if TRUE then confidence intervals are returned</p>
</td></tr>
<tr><td><code id="predictdf.polr_+3A_level">level</code></td>
<td>
<p>confidence level for confidence intervals</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predictdf.polr</code> is used by xgx_geom_smooth when method = &quot;polr&quot; 
to calculate confidence intervals via bootstraps.
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+nlsLM'></span><span id='topic+gtable'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>gtable</dt><dd><p><code><a href="gtable.html#topic+gtable">gtable</a></code></p>
</dd>
<dt>minpack.lm</dt><dd><p><code><a href="minpack.lm.html#topic+nlsLM">nlsLM</a></code></p>
</dd>
</dl>

<hr>
<h2 id='sad'>Single Ascending Dose Data Set</h2><span id='topic+sad'></span>

<h3>Description</h3>

<p>Model generated PK data to mimic an orally administered small molecule.
Simulated single dose administration ranging from 100 mg to 1600 mg.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sad
</code></pre>


<h3>Format</h3>

<p>A data frame with the following 16 columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
  column 1: </td><td style="text-align: left;"> <code>ID</code> </td><td style="text-align: left;"> numeric; unique subject ID</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 2: </td><td style="text-align: left;"> <code>TIME</code> </td><td style="text-align: left;"> numeric; time relative to first drug 
  administration</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 3: </td><td style="text-align: left;"> <code>NOMTIME</code> </td><td style="text-align: left;"> numeric; nominal time</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 4: </td><td style="text-align: left;"> <code>TIMEUNIT</code> </td><td style="text-align: left;"> character; unit of TIME</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 5: </td><td style="text-align: left;"> <code>AMT</code> </td><td style="text-align: left;"> numeric; dosing amount (for dosing events) 
  in mg</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 6: </td><td style="text-align: left;"> <code>LIDV</code> </td><td style="text-align: left;"> numeric; observation on a linear scale 
  (observation type determined by CMT), units determined by EVENTU column</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 7: </td><td style="text-align: left;"> <code>MDV</code> </td><td style="text-align: left;"> numeric; missing dependent variable </td>
</tr>
<tr>
 <td style="text-align: right;">
  (1 if missing, 0 otherwise)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 8: </td><td style="text-align: left;"> <code>CMT</code> </td><td style="text-align: left;"> integer; compartment number 
  (determines observation type):</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 1 = Dosing event</td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> CMT 2 = PK concentration</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 9: </td><td style="text-align: left;"> <code>NAME</code> </td><td style="text-align: left;"> character; description of event</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 10: </td><td style="text-align: left;"> <code>EVENTU</code> </td><td style="text-align: left;"> character; unit for observation</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 11: </td><td style="text-align: left;"> <code>CENS</code> </td><td style="text-align: left;"> integer; censored values
  (0 = not censored, 1 = censored)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 12: </td><td style="text-align: left;"> <code>EVID</code> </td><td style="text-align: left;"> integer; event ID (0 = observation, 
  1 = dosing event)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 13: </td><td style="text-align: left;"> <code>WEIGHTB</code> </td><td style="text-align: left;"> numeric; baseline body weight (kg)</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 14: </td><td style="text-align: left;"> <code>SEX</code> </td><td style="text-align: left;"> character; sex</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 15: </td><td style="text-align: left;"> <code>TRTACT</code> </td><td style="text-align: left;"> factor; treatment group label</td>
</tr>
<tr>
 <td style="text-align: right;">
  column 16: </td><td style="text-align: left;"> <code>DOSE</code> </td><td style="text-align: left;"> numeric; randomized dose in mg 
  received
</td>
</tr>

</table>


<hr>
<h2 id='StatSmoothOrdinal'>Stat object for producing smooths through ordinal data</h2><span id='topic+StatSmoothOrdinal'></span>

<h3>Description</h3>

<p>Stat object for producing smooths through ordinal data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatSmoothOrdinal
</code></pre>


<h3>Format</h3>

<p>An object of class <code>StatSmoothOrdinal</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 8.
</p>

<hr>
<h2 id='StatSummaryBinQuant'>Stat ggproto object for binning by quantile for xgx_stat_ci</h2><span id='topic+StatSummaryBinQuant'></span>

<h3>Description</h3>

<p>Source:
https://github.com/tidyverse/ggplot2/blob/351eb41623397dea20ed0059df62a4a5974d88cb/R/stat-summary-bin.R
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatSummaryBinQuant
</code></pre>


<h3>Format</h3>

<p>An object of class <code>StatSummaryBinQuant</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 5.
</p>


<h3>Details</h3>

<p><code>StatSummaryBinQuant</code> returns a ggproto object for plotting mean +/- confidence bins
</p>


<h3>Value</h3>

<p>ggplot2 ggproto object
</p>

<hr>
<h2 id='StatSummaryOrdinal'>Stat ggproto object for creating ggplot layers of binned confidence intervals
for probabiliities of classes in ordinal data</h2><span id='topic+StatSummaryOrdinal'></span>

<h3>Description</h3>

<p><code>StatSummaryOrdinal</code> returns a ggproto object for plotting mean +/- confidence intervals
for ordinal data. It also allows for binning values on the independent axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatSummaryOrdinal
</code></pre>


<h3>Format</h3>

<p>An object of class <code>StatSummaryOrdinal</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 8.
</p>


<h3>Value</h3>

<p>ggplot2 ggproto object
</p>

<hr>
<h2 id='theme_xgx'>Calls the standard theme for xGx graphics</h2><span id='topic+theme_xgx'></span>

<h3>Description</h3>

<p>Calls the standard theme for xGx graphics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_xgx()
</code></pre>


<h3>Value</h3>

<p>xgx ggplot2 compatible theme
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- 10^(seq(-3, 3, by = 0.1))
ec50 &lt;- 1
data &lt;- data.frame(concentration = conc, 
                   bound_receptor = 1 * conc / (conc + ec50))
ggplot2::ggplot(data, ggplot2::aes(y = concentration, x = bound_receptor)) +
  ggplot2::geom_point() +
  ggplot2::geom_line() +
  xgx_scale_y_log10() +
  xgx_scale_x_reverselog10() +
  theme_xgx()
  
</code></pre>

<hr>
<h2 id='xgx_annotate_filenames'>Append filenames to bottom of the plot</h2><span id='topic+xgx_annotate_filenames'></span>

<h3>Description</h3>

<p><code>xgx_annotate_filenames</code> appends file details to the bottom of a plot 
using the plot caption option. 
File details to append include the parent directory, the path of the R 
script which generated the plot, 
and the path of the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_annotate_filenames(dirs, hjust = 0.5, color = "black", size = 11)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_annotate_filenames_+3A_dirs">dirs</code></td>
<td>
<p>list containing directories and filenames.  It must contain 
five fields
</p>

<ol>
<li><p> parent_dir  = Parent directory containing the Rscript and the Results 
folder
</p>
</li>
<li><p> rscript_dir = Subdirectory ofparent_dir that contains the Rscript 
used to generate the figure
</p>
</li>
<li><p> rscript_name= Name of the Rscript used to generate the figure
</p>
</li>
<li><p> results_dir = Subdirectory ofparent_dir where the figure is stored
</p>
</li>
<li><p> filename    = Filename
</p>
</li></ol>
</td></tr>
<tr><td><code id="xgx_annotate_filenames_+3A_hjust">hjust</code></td>
<td>
<p>horizontal justification of the caption</p>
</td></tr>
<tr><td><code id="xgx_annotate_filenames_+3A_color">color</code></td>
<td>
<p>font color for caption, default black</p>
</td></tr>
<tr><td><code id="xgx_annotate_filenames_+3A_size">size</code></td>
<td>
<p>font size for caption, default 11</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dirs &lt;- list(parent_dir = "/your/parent/path/",
             rscript_dir = "./Rscripts/",
             rscript_name = "Example.R",
             results_dir = "./Results/",
             filename = "your_file_name.png")
data &lt;- data.frame(x = 1:1000, y = rnorm(1000))
ggplot2::ggplot(data = data, ggplot2::aes(x = x, y = y)) +
  ggplot2::geom_point() +
  xgx_annotate_filenames(dirs)

</code></pre>

<hr>
<h2 id='xgx_annotate_status'>Create a status (e.g. DRAFT) annotation layer</h2><span id='topic+xgx_annotate_status'></span>

<h3>Description</h3>

<p><code>xgx_annotate_status</code> adds a status (e.g. DRAFT) annotation layer 
to a plot. 
The text of the annotation can be customized, the default is &quot;DRAFT&quot;. 
The color, location, size, fontface, transparency of the annotation can 
also be customized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_annotate_status(
  status = "DRAFT",
  x = Inf,
  y = Inf,
  color = "grey",
  hjust = 1.2,
  vjust = 1.2,
  fontsize = 7,
  fontface = "bold",
  alpha = 0.5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_annotate_status_+3A_status">status</code></td>
<td>
<p>the text to</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_+3A_x">x</code></td>
<td>
<p>x location, default Inf (right most point)</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_+3A_y">y</code></td>
<td>
<p>y location, default Inf (up most point)</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_+3A_color">color</code></td>
<td>
<p>font color, default &quot;grey&quot;</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_+3A_hjust">hjust</code></td>
<td>
<p>horizontal justification, default 1.2</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_+3A_vjust">vjust</code></td>
<td>
<p>vertical justification, default 1.2</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_+3A_fontsize">fontsize</code></td>
<td>
<p>font size to use, default 7</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_+3A_fontface">fontface</code></td>
<td>
<p>font style to use, default &quot;bold&quot;</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_+3A_alpha">alpha</code></td>
<td>
<p>transparency, default is 0.5</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot layer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(x = 1:1000, y = rnorm(1000))
ggplot2::ggplot(data = data, ggplot2::aes(x = x, y = y)) + 
  ggplot2::geom_point() +
  xgx_annotate_status("DRAFT")

</code></pre>

<hr>
<h2 id='xgx_annotate_status_png'>Annotate a png file or directory of png files</h2><span id='topic+xgx_annotate_status_png'></span>

<h3>Description</h3>

<p>These function annotates a single png file or all files within a
directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_annotate_status_png(
  file_or_dir,
  script = "",
  status = "DRAFT",
  date_format = "%a %b %d %X %Y",
  col = grDevices::grey(0.8, alpha = 0.7),
  font = 2,
  cex_status_mult = 7,
  cex_footnote_mult = 0.8,
  status_angle = 45,
  x11 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_annotate_status_png_+3A_file_or_dir">file_or_dir</code></td>
<td>
<p>The png file to annotate or directory location for
annotating png files.  Note this will annotate just once, so if
you generate multiple png files and then annotate at the end of
your script it will have the correct script name on it. Then if
you create new images in a different script in the same directory
and then annotate with the script name the second script, the PNG
files will show the correct script location for each file.</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_png_+3A_script">script</code></td>
<td>
<p>Script name to add as a footnote; By default this is
empty, though it could name the script that</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_png_+3A_status">status</code></td>
<td>
<p>Draft or other status; If <code>status="Final"</code> or
<code>status=""</code> the status overlay will be removed.  By default
the status is DRAFT.</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_png_+3A_date_format">date_format</code></td>
<td>
<p>Date format for adding the time the png was
annotated.</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_png_+3A_col">col</code></td>
<td>
<p>Color for annotating the draft status</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_png_+3A_font">font</code></td>
<td>
<p>Font to use for the annotation function</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_png_+3A_cex_status_mult">cex_status_mult</code></td>
<td>
<p>Multiplication factor for the status
annotation.  By default 7</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_png_+3A_cex_footnote_mult">cex_footnote_mult</code></td>
<td>
<p>Multiplication factor for the footnote
annotation. By default 0.8</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_png_+3A_status_angle">status_angle</code></td>
<td>
<p>Angle to rotate status</p>
</td></tr>
<tr><td><code id="xgx_annotate_status_png_+3A_x11">x11</code></td>
<td>
<p>Display on the X11/Windows device</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a png file has been annotated once, this function will not
annotate it again.  Therefore, you can run this function on
directories with different input script names and it will label
each file based on when each file was run.
</p>
<p>Based on code from MrFlick on
<a href="https://stackoverflow.com/a/23816416">Stack Overflow</a>.
</p>


<h3>Value</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Matthew Fidler, Alison M, ....
</p>


<h3>Examples</h3>

<pre><code class='language-R'># using the examples from plot()
file.name &lt;- tempfile()
grDevices::png(file.name)
graphics::plot(cars)
graphics::lines(stats::lowess(cars))
grDevices::dev.off()
# annotate one file
xgx_annotate_status_png(file.name, "/tmp/script1.R")

</code></pre>

<hr>
<h2 id='xgx_auto_explore'>Produce an xgx-styled report the given dataset using xgx R markdown templates,
or a user-provided R markdown template.  (Note: The R markdown template provided must
be formatted in a similar manner to that of the xgx R markdown templates to work.)
The working directory will contain a new directory ('xgx_autoexplore_output') after running this function,
which will contain a directory for the dataset, and futher a directory for the type of analysis / R markdown template.</h2><span id='topic+xgx_auto_explore'></span>

<h3>Description</h3>

<p><code>xgx_auto_explore</code> returns an HTML and PDF document with plots
describing the provided dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_auto_explore(
  data_path = NULL,
  mapping = list(),
  author_name = NULL,
  multiple_dosing = FALSE,
  pk_cmt = NULL,
  pd_cmt = NULL,
  pd_data_type = NULL,
  dose_cmt = NULL,
  steady_state_day = NULL,
  time_between_doses = NULL,
  rmd_template_name = NULL,
  rmd_template_path = NULL,
  rmd_output_path = NULL,
  pdf_output_path = NULL,
  html_output_path = NULL,
  add_datetime = TRUE,
  show_explanation = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_auto_explore_+3A_data_path">data_path</code></td>
<td>
<p>Path (as a string) to the dataset that is to be analyzed</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_mapping">mapping</code></td>
<td>
<p>A list of column name mappings from the
original (template) dataset column names
to the corresponding columns in the new dataset.</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_author_name">author_name</code></td>
<td>
<p>The name of the author to be displayed on the template</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_multiple_dosing">multiple_dosing</code></td>
<td>
<p>Whether or not to use a &quot;Multiple&quot; or &quot;Single&quot; Ascending dose template</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_pk_cmt">pk_cmt</code></td>
<td>
<p>An integer denoting the &quot;compartment&quot; containing the PK data. The &quot;CMT&quot; column will typically
have these integers, where each row may contain PK, PD, dosing or other events/observations data</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_pd_cmt">pd_cmt</code></td>
<td>
<p>An integer denoting the &quot;compartment&quot; containing the PD data, 
of the desired type  (continuous, ordinal, etc.). The &quot;CMT&quot; column will typically
have these integers, where each row may contain PK, PD, dosing or other events/observations data</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_pd_data_type">pd_data_type</code></td>
<td>
<p>The type of PD data - acceptable values exist in the following list: 
[&quot;binary&quot;,&quot;continuous&quot;,&quot;count&quot;,&quot;ordinal&quot;,&quot;real_example&quot;,&quot;receptor_occupancy&quot;,&quot;time_to_event&quot;]</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_dose_cmt">dose_cmt</code></td>
<td>
<p>Integer denoting the compartment for dosing records</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_steady_state_day">steady_state_day</code></td>
<td>
<p>used to denote the day of rich sampling of PK at steady state</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_time_between_doses">time_between_doses</code></td>
<td>
<p>dosing interval, has units to match the time variable of the dataset</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_rmd_template_name">rmd_template_name</code></td>
<td>
<p>A custom output name for the generated Rmd file</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_rmd_template_path">rmd_template_path</code></td>
<td>
<p>A user provided custom template (as a string)</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_rmd_output_path">rmd_output_path</code></td>
<td>
<p>A custom output path for the generated Rmd file
(This is typically left as 'NULL' in order to maintain the hierarchical directory structure of 'xgx_autoexplore_output'))</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_pdf_output_path">pdf_output_path</code></td>
<td>
<p>A custom output path for the generated PDF file
(This is typically left as 'NULL' in order to maintain the hierarchical directory structure of 'xgx_autoexplore_output'))</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_html_output_path">html_output_path</code></td>
<td>
<p>A custom output path for the generated HTML file
(This is typically left as 'NULL' in order to maintain the hierarchical directory structure of 'xgx_autoexplore_output'))</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_add_datetime">add_datetime</code></td>
<td>
<p>Boolean indicating additon of a date stamp to the beginnning of the Rmd file</p>
</td></tr>
<tr><td><code id="xgx_auto_explore_+3A_show_explanation">show_explanation</code></td>
<td>
<p>Boolean indicating if the additional explanations (text in between figures) are needed for the user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used quickly to explore your data by generating 
overview plots before constructing non-linear mixed effects models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
author_name = "Your Name Here"
show_explanation = FALSE

## Not run: 
# Try out the nonlinear_pkpd dataset with the
# Multiple Ascending Dose PK Rmd template
data_path &lt;- "~/nonlinear_pkpd.csv"

# Specify the mapping of column names
mapping &lt;- list(
  "TIME" = "TIM2",
  "NOMTIME" = "NT",
  "EVID" = 0,
  "CENS" = 0,
  "DOSE" = "MGKG",
  "TRTACT" = "TRT",
  "LIDV_NORM" = "LIDV/MGKG",
  "LIDV_UNIT" = "UNIT",
  "PROFDAY" = 1,
  "SEX" = 0,
  "WEIGHTB" = 0)


# 5 contains the PK Concentration in this dataset
pk_cmt = 5
# We don't need PD right now
pd_cmt = NULL
pd_data_type = NULL


dose_cmt = 1
steady_state_day = c(0, 6)
time_between_doses = 24
multiple_dosing = TRUE

output_directory = tempdir()

xgx_auto_explore(data_path = data_path,
                 mapping = mapping,
                 author_name = author_name,
                 pk_cmt = pk_cmt,
                 pd_cmt = pd_cmt,
                 dose_cmt = dose_cmt,
                 steady_state_day = steady_state_day,
                 time_between_doses = time_between_doses,
                 multiple_dosing = multiple_dosing,
                 pd_data_type = pd_data_type,
                 rmd_output_path = output_directory,
                 show_explanation = show_explanation)

## End(Not run)
    
</code></pre>

<hr>
<h2 id='xgx_breaks_log10'>Sets the default breaks for log10</h2><span id='topic+xgx_breaks_log10'></span>

<h3>Description</h3>

<p><code>xgx_breaks_log10</code> sets nice breaks for log10 scale.
it's better than the default function because it ensures there is at least 
2 breaks
and also, it will try to go by 3s (i.e. 1,3,10,30,100) if it makes sense
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_breaks_log10(data_range)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_breaks_log10_+3A_data_range">data_range</code></td>
<td>
<p>range of the data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>for the extended breaks function, weights is a set of 4 weights for
</p>

<ol>
<li><p> simplicity - how early in the Q order are you
</p>
</li>
<li><p> coverage - labelings that don't extend outside the data: 
range(data) / range(labels)
</p>
</li>
<li><p> density (previously granularity) - how close to the number of 
ticks do you get (default is 5)
</p>
</li>
<li><p> legibility - has to do with fontsize and formatting to prevent 
label overlap
</p>
</li></ol>



<h3>Value</h3>

<p>numeric vector of breaks
</p>


<h3>References</h3>

<p>Talbot, Justin, Sharon Lin, and Pat Hanrahan. 
&quot;An extension of Wilkinson’s 
algorithm for positioning tick labels on axes.&quot; IEEE Transactions 
on visualization and computer graphics 16.6 (2010): 1036-1043.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xgx_breaks_log10(c(1, 1000))
xgx_breaks_log10(c(0.001, 100))
xgx_breaks_log10(c(1e-4, 1e4))
xgx_breaks_log10(c(1e-9, 1e9))
xgx_breaks_log10(c(1, 2))
xgx_breaks_log10(c(1, 5))
xgx_breaks_log10(c(1, 10))
xgx_breaks_log10(c(1, 100))
xgx_breaks_log10(c(1, 1.01))
xgx_breaks_log10(c(1, 1.0001))
print(xgx_breaks_log10(c(1, 1.000001)), digits = 10)

</code></pre>

<hr>
<h2 id='xgx_breaks_time'>Sets the default breaks for a time axis</h2><span id='topic+xgx_breaks_time'></span>

<h3>Description</h3>

<p><code>xgx_breaks_time</code> sets the default breaks for a time axis, 
given the units of the data and the units of the plot.
It is inspired by scales::extended_breaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_breaks_time(data_range, units_plot, number_breaks = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_breaks_time_+3A_data_range">data_range</code></td>
<td>
<p>range of the data</p>
</td></tr>
<tr><td><code id="xgx_breaks_time_+3A_units_plot">units_plot</code></td>
<td>
<p>units to use in the plot</p>
</td></tr>
<tr><td><code id="xgx_breaks_time_+3A_number_breaks">number_breaks</code></td>
<td>
<p>number of breaks to aim for (default is 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>for the extended breaks function, weights is a set of 4 weights for
</p>

<ol>
<li><p> simplicity - how early in the Q order are you
</p>
</li>
<li><p> coverage - labelings that don't extend outside the data:
range(data) / range(labels)
</p>
</li>
<li><p> density (previously granularity) - how close to the number of ticks 
do you get (default is 5)
</p>
</li>
<li><p> legibility - has to do with fontsize and formatting to prevent 
label overlap
</p>
</li></ol>



<h3>Value</h3>

<p>numeric vector of breaks
</p>


<h3>References</h3>

<p>Talbot, Justin, Sharon Lin, and Pat Hanrahan.
&quot;An extension of Wilkinson’s algorithm for positioning tick labels on axes.&quot;
IEEE Transactions on visualization and 
computer graphics 16.6 (2010): 1036-1043.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xgx_breaks_time(c(0, 5), "h")
xgx_breaks_time(c(0, 6), "h")
xgx_breaks_time(c(-3, 5), "h")
xgx_breaks_time(c(0, 24), "h")
xgx_breaks_time(c(0, 12), "h")
xgx_breaks_time(c(1, 4), "d")
xgx_breaks_time(c(1, 12), "d")
xgx_breaks_time(c(1, 14), "d")
xgx_breaks_time(c(1, 50), "d")
xgx_breaks_time(c(1000, 3000), "d")
xgx_breaks_time(c(-21, 100), "d")
xgx_breaks_time(c(-1, 10), "w")

</code></pre>

<hr>
<h2 id='xgx_check_data'>Check data for various issues</h2><span id='topic+xgx_check_data'></span>

<h3>Description</h3>

<p><code>xgx_check_data</code> performs a series of checks on a PK or PKPD dataset
It was inspired by the dataset preparation table from 
<a href="https://iqrtools.intiquan.com/doc/book/analysis-dataset-preparation.html">IntiQuan</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_check_data(data, covariates = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_check_data_+3A_data">data</code></td>
<td>
<p>the dataset to check.  Must contain the above columns</p>
</td></tr>
<tr><td><code id="xgx_check_data_+3A_covariates">covariates</code></td>
<td>
<p>the column names of covariates, to explore</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dataset must have the following columns
</p>

<ul>
<li><p> ID      = unique subject identifier.  USUBJID is another option 
if ID is not there
</p>
</li>
<li><p> EVID    = event ID: 1 for dose, 0 otherwise
</p>
</li>
<li><p> AMT     = value of the dose
</p>
</li>
<li><p> TIME    = time of the measurement
</p>
</li>
<li><p> DV      = dependent value (linear scale).  will check if LIDV or 
LNDV are also there if DV is not
</p>
</li>
<li><p> YTYPE   = data measurement for LIDV.  will check if CMT is there, 
if YTYPE is not
</p>
</li></ul>

<p>The dataset may also have additional columns
</p>

<ul>
<li><p> CENS = flag for censoring of the data because it's below the 
limit of quantification (BLOQ)
</p>
</li>
<li><p> MDV  = missing dependent variable - will be counted and then 
filtered out from the data check
</p>
</li></ul>



<h3>Value</h3>

<p>data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>covariates &lt;- c("WEIGHTB", "SEX")
check &lt;- xgx_check_data(mad_missing_duplicates, covariates)

</code></pre>

<hr>
<h2 id='xgx_conf_int'><code>xgx_conf_int</code> returns a dataframe with mean +/- confidence intervals</h2><span id='topic+xgx_conf_int'></span>

<h3>Description</h3>

<p><code>xgx_conf_int</code> returns a dataframe with mean +/- confidence intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_conf_int(y, conf_level = 0.95, distribution = "normal")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_conf_int_+3A_y">y</code></td>
<td>
<p>data to compute confidence interval of</p>
</td></tr>
<tr><td><code id="xgx_conf_int_+3A_conf_level">conf_level</code></td>
<td>
<p>The percentile for the confidence interval (should fall 
between 0 and 1). The default is 0.95, which corresponds to a 95 percent 
confidence interval.</p>
</td></tr>
<tr><td><code id="xgx_conf_int_+3A_distribution">distribution</code></td>
<td>
<p>The distribution which the data follow, used for 
calculating confidence intervals. The options are &quot;normal&quot;, &quot;lognormal&quot;, 
and &quot;binomial&quot;. The &quot;normal&quot; option will use the Student t Distribution 
to calculate confidence intervals, the &quot;lognormal&quot; option will transform 
data to the log space first. The &quot;binomial&quot; option will use the
<code><a href="binom.html#topic+binom.confint">binom.exact</a></code> function to calculate the
confidence 
intervals. Note: binomial data must be numeric and contain only 1's and 0's.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default settings for normally distributed data, 95% confidence interval,  
data &lt;- data.frame(x = rep(c(1, 2, 3), each = 20),
                   y = rep(c(1, 2, 3), each = 20) + stats::rnorm(60),
                   group = rep(1:3, 20))
xgx_conf_int(data$y)
  
</code></pre>

<hr>
<h2 id='xgx_dirs2char'>Append filenames to bottom of the plot</h2><span id='topic+xgx_dirs2char'></span>

<h3>Description</h3>

<p><code>xgx_dirs2char</code> returns a character variable based on the dirs list.
The caption gives the filename
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_dirs2char(dirs, include_time = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_dirs2char_+3A_dirs">dirs</code></td>
<td>
<p>list containing directories and filenames.  It must contain 
five fields
</p>

<ol>
<li><p> parent_dir  = Parent directory containing the Rscript and the Results 
folder
</p>
</li>
<li><p> rscript_dir = Subdirectory ofparent_dir that contains the Rscript 
used to generate the figure
</p>
</li>
<li><p> rscript_name= Name of the Rscript used to generate the figure
</p>
</li>
<li><p> results_dir = Subdirectory ofparent_dir where the figure is stored
</p>
</li>
<li><p> filename    = Filename
</p>
</li></ol>
</td></tr>
<tr><td><code id="xgx_dirs2char_+3A_include_time">include_time</code></td>
<td>
<p>is logical with default TRUE.  If TRUE, it includes 
date / time in the output character</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dirs &lt;- list(parent_dir = "/your/parent/path/",
            rscript_dir = "./Rscripts/",
            rscript_name = "Example.R",
            results_dir = "./Results/",
            filename = "your_file_name.png")
caption &lt;- xgx_dirs2char(dirs)

</code></pre>

<hr>
<h2 id='xgx_geom_ci'>Plot data with mean and confidence intervals</h2><span id='topic+xgx_geom_ci'></span>

<h3>Description</h3>

<p>Plot data with mean and confidence intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_geom_ci(
  mapping = NULL,
  data = NULL,
  conf_level = 0.95,
  distribution = "normal",
  bins = NULL,
  breaks = NULL,
  geom = list("point", "line", "errorbar"),
  position = "identity",
  fun.args = list(),
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_geom_ci_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by 'aes' or 'aes_'. 
If specified and 'inherit.aes = TRUE' (the default), it is combined with the 
default mapping at the top level of the plot. You must supply mapping if 
there is no plot mapping.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three options:
</p>
<p>If NULL, the default, the data is inherited from the plot data as specified 
in the call to ggplot.
</p>
<p>A data.frame, or other object, will override the plot data. All objects 
will be fortified to produce a data frame. See fortify for which variables 
will be created.
</p>
<p>A function will be called with a single argument, the plot data. The return 
value must be a data.frame., and will be used as the layer data.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_conf_level">conf_level</code></td>
<td>
<p>The percentile for the confidence interval (should fall 
between 0 and 1). The default is 0.95, which corresponds to a 95 percent 
confidence interval.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_distribution">distribution</code></td>
<td>
<p>The distribution which the data follow, used for 
calculating confidence intervals. The options are &quot;normal&quot;, &quot;lognormal&quot;, 
and &quot;binomial&quot;. The &quot;normal&quot; option will use the Student t Distribution 
to calculate confidence intervals, the &quot;lognormal&quot; option will transform 
data to the log space first. The &quot;binomial&quot; option will use the
<code><a href="binom.html#topic+binom.confint">binom.exact</a></code> function to calculate the
confidence 
intervals. Note: binomial data must be numeric and contain only 1's and 0's.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_bins">bins</code></td>
<td>
<p>number of bins to cut up the x data, cuts data into quantiles.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_breaks">breaks</code></td>
<td>
<p>breaks to cut up the x data, if this option is used, bins is ignored</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom. Can be a list of multiple 
geoms, e.g. list(&quot;point&quot;,&quot;line&quot;,&quot;errorbar&quot;), which is the default.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of 
a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_fun.args">fun.args</code></td>
<td>
<p>Optional additional arguments passed on to the functions.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a 
warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? 
NA, the default, includes if any aesthetics are mapped. FALSE never 
includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather 
than combining with them. This is most useful for helper functions that 
define both data and aesthetics and shouldn't inherit behaviour from the 
default plot specification, e.g. borders.</p>
</td></tr>
<tr><td><code id="xgx_geom_ci_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer. These are often aesthetics, 
used to set an aesthetic to a fixed value, like color = &quot;red&quot; or size = 3. 
They may also be parameters to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 plot layer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(x = rep(c(1, 2, 3), each = 20),
                   y = rep(c(1, 2, 3), each = 20) + stats::rnorm(60))
ggplot2::ggplot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_geom_ci(conf_level = 0.95)
 
</code></pre>

<hr>
<h2 id='xgx_geom_pi'>Plot data with median and percent intervals</h2><span id='topic+xgx_geom_pi'></span>

<h3>Description</h3>

<p>Plot data with median and percent intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_geom_pi(
  mapping = NULL,
  data = NULL,
  percent_level = 0.95,
  geom = list("line", "ribbon"),
  position = "identity",
  fun.args = list(),
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_geom_pi_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by 'aes' or 'aes_'. 
If specified and 'inherit.aes = TRUE' (the default), it is combined with the 
default mapping at the top level of the plot. You must supply mapping if 
there is no plot mapping.</p>
</td></tr>
<tr><td><code id="xgx_geom_pi_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three options:
</p>
<p>If NULL, the default, the data is inherited from the plot data as specified 
in the call to ggplot.
</p>
<p>A data.frame, or other object, will override the plot data. All objects 
will be fortified to produce a data frame. See fortify for which variables 
will be created.
</p>
<p>A function will be called with a single argument, the plot data. The return 
value must be a data.frame., and will be used as the layer data.</p>
</td></tr>
<tr><td><code id="xgx_geom_pi_+3A_percent_level">percent_level</code></td>
<td>
<p>The upper or lower percentile for the percent interval (should fall 
between 0 and 1). The default is 0.95, which corresponds  
to (0.05, 0.95) interval. Supplying 0.05 would give the same result</p>
</td></tr>
<tr><td><code id="xgx_geom_pi_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom. Can be a list of multiple 
geoms, e.g. list(&quot;line&quot;,&quot;ribbon&quot;), which is the default.</p>
</td></tr>
<tr><td><code id="xgx_geom_pi_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of 
a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="xgx_geom_pi_+3A_fun.args">fun.args</code></td>
<td>
<p>Optional additional arguments passed on to the functions.</p>
</td></tr>
<tr><td><code id="xgx_geom_pi_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a 
warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="xgx_geom_pi_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? 
NA, the default, includes if any aesthetics are mapped. FALSE never 
includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="xgx_geom_pi_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather 
than combining with them. This is most useful for helper functions that 
define both data and aesthetics and shouldn't inherit behaviour from the 
default plot specification, e.g. borders.</p>
</td></tr>
<tr><td><code id="xgx_geom_pi_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer. These are often aesthetics, 
used to set an aesthetic to a fixed value, like color = &quot;red&quot; or size = 3. 
They may also be parameters to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 plot layer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(x = rep(c(1, 2, 3), each = 20),
                   y = rep(c(1, 2, 3), each = 20) + stats::rnorm(60))
ggplot2::ggplot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_geom_pi(percent_level = 0.95)
 
</code></pre>

<hr>
<h2 id='xgx_labels_log10'>Nice labels for log10.</h2><span id='topic+xgx_labels_log10'></span>

<h3>Description</h3>

<p>Returns a set of labels for ggplot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_labels_log10(breaks)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_labels_log10_+3A_breaks">breaks</code></td>
<td>
<p>breaks for the function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>either character or expression
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(xgx_labels_log10(c(1e-5, 1, 1e5)))

</code></pre>

<hr>
<h2 id='xgx_minor_breaks_log10'>Sets the default minor_breaks for log10 scales</h2><span id='topic+xgx_minor_breaks_log10'></span>

<h3>Description</h3>

<p><code>xgx_minor_breaks_log10</code> sets nice minor_breaks for log10 scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_minor_breaks_log10(data_range)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_minor_breaks_log10_+3A_data_range">data_range</code></td>
<td>
<p>range of the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of breaks
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xgx_minor_breaks_log10(c(1, 1000))
xgx_minor_breaks_log10(c(0.001, 100))
xgx_minor_breaks_log10(c(1e-4, 1e4))
xgx_minor_breaks_log10(c(1e-9, 1e9))
xgx_minor_breaks_log10(c(1, 2))
xgx_minor_breaks_log10(c(1, 5))
xgx_minor_breaks_log10(c(1, 10))
xgx_minor_breaks_log10(c(1, 100))
xgx_minor_breaks_log10(c(1, 1.01))
xgx_minor_breaks_log10(c(1, 1.0001))
print(xgx_minor_breaks_log10(c(1, 1.000001)), digits = 10)

</code></pre>

<hr>
<h2 id='xgx_plot'>Create a new xgx plot</h2><span id='topic+xgx_plot'></span>

<h3>Description</h3>

<p>Create a new xgx plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_plot(
  data = NULL,
  mapping = ggplot2::aes(),
  ...,
  environment = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_plot_+3A_data">data</code></td>
<td>
<p>Default dataset to use for plot. If not already a data.frame, 
will be converted to one by fortify.</p>
</td></tr>
<tr><td><code id="xgx_plot_+3A_mapping">mapping</code></td>
<td>
<p>As in ggplot2; Default list of aesthetic mappings to use 
for plot. Must define x, y, and group for xgx_spaghetti.</p>
</td></tr>
<tr><td><code id="xgx_plot_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods. Not currently used.</p>
</td></tr>
<tr><td><code id="xgx_plot_+3A_environment">environment</code></td>
<td>
<p>If an variable defined in the aesthetic mapping is not 
found in the data, ggplot will look for it in this environment. It defaults 
to using the environment in which <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> is called.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
time &lt;- rep(seq(1, 10), 5)
id &lt;- sort(rep(seq(1, 5), 10))
conc &lt;- exp(-time) * sort(rep(stats::rlnorm(5), 10))

data &lt;- data.frame(time = time, concentration = conc, id = id)
xgx_plot(data = data,
         mapping = ggplot2::aes(x = time, y = concentration, group = id)) + 
  ggplot2::geom_line() + 
  ggplot2::geom_point()
  
</code></pre>

<hr>
<h2 id='xgx_save'>Saving plot, automatically annotating the status and denoting the filenames</h2><span id='topic+xgx_save'></span>

<h3>Description</h3>

<p>Saving plot, automatically annotating the status and denoting the filenames
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_save(
  width,
  height,
  dirs = NULL,
  filename_main = NULL,
  status = "DRAFT",
  g = ggplot2::last_plot(),
  filetype = "png",
  status_x = Inf,
  status_y = Inf,
  status_fontsize = 7,
  status_fontcolor = "grey",
  filenames_fontsize = 11,
  filenames_fontcolor = "black"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_save_+3A_width">width</code></td>
<td>
<p>width of plot</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_height">height</code></td>
<td>
<p>height of plot</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_dirs">dirs</code></td>
<td>
<p>list of directories.  If NULL or if directories missing, there 
is default behavior below
</p>

<ol>
<li><p> parent_dir  = Parent directory containing the Rscript and the Results 
folder, default getwd()
</p>
</li>
<li><p> rscript_dir = Subdirectory of parent_dir that contains the Rscript 
used to generate the figure, default &quot;./&quot;
</p>
</li>
<li><p> rscript_name= Name of the Rscript used to generate the figure, 
default &quot;Name_Of_Script_Here.R&quot;
</p>
</li>
<li><p> results_dir = Subdirectory ofparent_dir where the figure is stored, 
default &quot;./&quot;
</p>
</li>
<li><p> filename_prefix = prefix of filename to be appended to filename_main
</p>
</li></ol>
</td></tr>
<tr><td><code id="xgx_save_+3A_filename_main">filename_main</code></td>
<td>
<p>main part of the filename, excluding prefix and suffix.
no default</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_status">status</code></td>
<td>
<p>status to be annotated</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_g">g</code></td>
<td>
<p>ggplot plot object, default is ggplot::last_plot()</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_filetype">filetype</code></td>
<td>
<p>file extension (e.g. &quot;pdf&quot;,&quot;csv&quot; etc.)</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_status_x">status_x</code></td>
<td>
<p>x location of the status in plot</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_status_y">status_y</code></td>
<td>
<p>y location of the status in plot</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_status_fontsize">status_fontsize</code></td>
<td>
<p>font size for status in plot</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_status_fontcolor">status_fontcolor</code></td>
<td>
<p>font color for status in plot</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_filenames_fontsize">filenames_fontsize</code></td>
<td>
<p>font size for filenames info in plot</p>
</td></tr>
<tr><td><code id="xgx_save_+3A_filenames_fontcolor">filenames_fontcolor</code></td>
<td>
<p>font color for filenames info in plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 plot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>directory = tempdir()
dirs &lt;- list(parent_dir  = directory,
             rscript_dir = directory,
             rscript_name = "example.R",
             results_dir = directory,
             filename_prefix = "example_")
data &lt;- data.frame(x = 1:1000, y = stats::rnorm(1000))
ggplot2::ggplot(data = data, ggplot2::aes(x = x, y = y)) +
  ggplot2::geom_point()
xgx_save(4, 4, dirs, "Example", "DRAFT")

</code></pre>

<hr>
<h2 id='xgx_save_table'>Saving table as an image, also labeling the program that created the table 
and where the table is stored</h2><span id='topic+xgx_save_table'></span>

<h3>Description</h3>

<p>Saving table as an image, also labeling the program that created the table 
and where the table is stored
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_save_table(data, dirs = NULL, filename_main = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_save_table_+3A_data">data</code></td>
<td>
<p>data.frame or table of results</p>
</td></tr>
<tr><td><code id="xgx_save_table_+3A_dirs">dirs</code></td>
<td>
<p>list of directories.  If NULL or if directories missing, there 
is default behavior below
</p>

<ol>
<li><p> parent_dir  = Parent directory containing the Rscript and the 
Results folder, default getwd()
</p>
</li>
<li><p> rscript_dir = Subdirectory of parent_dir that contains the Rscript 
used to generate the figure, default &quot;./&quot;
</p>
</li>
<li><p> rscript_name= Name of the Rscript used to generate the figure, 
default &quot;Name_Of_Script_Here.R&quot;
</p>
</li>
<li><p> results_dir = Subdirectory ofparent_dir where the figure is stored, 
default &quot;./&quot;
</p>
</li>
<li><p> filename_prefix = prefix of filename to be appended to filename_main
</p>
</li></ol>
</td></tr>
<tr><td><code id="xgx_save_table_+3A_filename_main">filename_main</code></td>
<td>
<p>main part of the filename, excluding prefix and 
extension.  no default</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 plot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>directory = tempdir()
dirs &lt;- list(parent_dir  = directory,
             rscript_dir = directory,
             rscript_name = "example.R",
             results_dir = directory,
             filename_prefix = "example_")
data &lt;- data.frame(x = c(1, 2), y = c(1, 2))
xgx_save_table(data, dirs = dirs, filename_main = "test")

</code></pre>

<hr>
<h2 id='xgx_scale_x_log10'>log10 scales the x axis with a &quot;pretty&quot; set of breaks</h2><span id='topic+xgx_scale_x_log10'></span>

<h3>Description</h3>

<p><code>xgx_scale_x_log10</code> is similar to
<code><a href="ggplot2.html#topic+scale_continuous">scale_x_log10</a></code>.  
But it uses what we believe to be a nicer spacing and set of tick marks
it can be used the same as
<code><a href="ggplot2.html#topic+scale_continuous">scale_x_log10</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_scale_x_log10(
  breaks = xgx_breaks_log10,
  minor_breaks = NULL,
  labels = xgx_labels_log10,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_scale_x_log10_+3A_breaks">breaks</code></td>
<td>
<p>major breaks, default is a function defined here</p>
</td></tr>
<tr><td><code id="xgx_scale_x_log10_+3A_minor_breaks">minor_breaks</code></td>
<td>
<p>minor breaks, default is a function defined here</p>
</td></tr>
<tr><td><code id="xgx_scale_x_log10_+3A_labels">labels</code></td>
<td>
<p>function for setting the labels, defined here</p>
</td></tr>
<tr><td><code id="xgx_scale_x_log10_+3A_...">...</code></td>
<td>
<p>other arguments passed to
<code><a href="ggplot2.html#topic+scale_continuous">scale_x_log10</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 compatible scale object
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
conc &lt;- 10^(seq(-3, 3, by = 0.1))
ec50 &lt;- 1
data &lt;- data.frame(concentration  = conc,
                   bound_receptor = 1 * conc / (conc + ec50))
ggplot2::ggplot(data, ggplot2::aes(x = concentration, y = bound_receptor)) + 
ggplot2::geom_point() + 
  ggplot2::geom_line() + 
  xgx_scale_x_log10() +
  xgx_scale_y_reverselog10()
  
</code></pre>

<hr>
<h2 id='xgx_scale_x_reverselog10'>Reverse-log transform for the x scale.</h2><span id='topic+xgx_scale_x_reverselog10'></span>

<h3>Description</h3>

<p><code>xgx_scale_x_reverselog10</code> is designed to be used with data that 
approaches 100
A common example is receptor occupancy in drug development.  
It is used when you want even spacing between 90, 99, 99.9, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_scale_x_reverselog10(labels = NULL, accuracy = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_scale_x_reverselog10_+3A_labels">labels</code></td>
<td>
<p>if NULL, then the default is to use scales::percent()</p>
</td></tr>
<tr><td><code id="xgx_scale_x_reverselog10_+3A_accuracy">accuracy</code></td>
<td>
<p>if NULL, then use the the default as specified by scales::percent()
to round to the hundredths place, set accuracy 0.01</p>
</td></tr>
<tr><td><code id="xgx_scale_x_reverselog10_+3A_...">...</code></td>
<td>
<p>other parameters passed to 
<code><a href="ggplot2.html#topic+scale_continuous">scale_x_continuous</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 compatible scale object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- 10^(seq(-3, 3, by = 0.1))
ec50 &lt;- 1
data &lt;- data.frame(concentration = conc, 
                   bound_receptor = 1 * conc / (conc + ec50))
ggplot2::ggplot(data, ggplot2::aes(y = concentration, x = bound_receptor)) +
  ggplot2::geom_point() +
  ggplot2::geom_line() +
  xgx_scale_y_log10() +
  xgx_scale_x_reverselog10()
 
</code></pre>

<hr>
<h2 id='xgx_scale_x_time_units'>Convert time units for plotting</h2><span id='topic+xgx_scale_x_time_units'></span><span id='topic+xgx_scale_y_time_units'></span>

<h3>Description</h3>

<p><code>xgx_scale_x_time_units</code> converts x axis scale from one time unit
to another.
Supported units include hours, days, weeks, months, and years, which
can also be called using just the first letter (h, d, w, m, y).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_scale_x_time_units(
  units_dataset,
  units_plot = NULL,
  breaks = NULL,
  labels = NULL,
  ...
)

xgx_scale_y_time_units(
  units_dataset,
  units_plot = NULL,
  breaks = NULL,
  labels = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_scale_x_time_units_+3A_units_dataset">units_dataset</code></td>
<td>
<p>units of the input dataset, must be specified by user
as &quot;h&quot;, &quot;d&quot;, &quot;w&quot;, &quot;m&quot;, or &quot;y&quot;</p>
</td></tr>
<tr><td><code id="xgx_scale_x_time_units_+3A_units_plot">units_plot</code></td>
<td>
<p>units of the plot, will be units of the dataset if empty</p>
</td></tr>
<tr><td><code id="xgx_scale_x_time_units_+3A_breaks">breaks</code></td>
<td>
<p>One of:
</p>

<ul>
<li> <p><code>NULL</code> for no breaks
</p>
</li>
<li> <p><code>waiver()</code> for the default breaks computed by the
<a href="scales.html#topic+trans_new">transformation object</a>
</p>
</li>
<li><p> A numeric vector of positions
</p>
</li>
<li><p> A function that takes the limits as input and returns breaks
as output (e.g., a function returned by <code><a href="scales.html#topic+breaks_extended">scales::extended_breaks()</a></code>).
Also accepts rlang <a href="rlang.html#topic+as_function">lambda</a> function notation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="xgx_scale_x_time_units_+3A_labels">labels</code></td>
<td>
<p>One of:
</p>

<ul>
<li> <p><code>NULL</code> for no labels
</p>
</li>
<li> <p><code>waiver()</code> for the default labels computed by the
transformation object
</p>
</li>
<li><p> A character vector giving labels (must be same length as <code>breaks</code>)
</p>
</li>
<li><p> A function that takes the breaks as input and returns labels
as output. Also accepts rlang <a href="rlang.html#topic+as_function">lambda</a> function
notation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="xgx_scale_x_time_units_+3A_...">...</code></td>
<td>
<p>other parameters for
<code><a href="ggplot2.html#topic+scale_continuous">scale_x_continuous</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note: <code>xgx_scale_x_time_units</code> only scales the plot axis, all other
specifications must be on the original scale of the dataset (e.g. breaks,
position, width)
</p>


<h3>Value</h3>

<p>ggplot2 compatible scale object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(x = 1:1000, y = rnorm(1000))
ggplot2::ggplot(data = data, ggplot2::aes(x = x, y = y)) +
  ggplot2::geom_point() +
  xgx_scale_x_time_units(units_dataset = "hours", units_plot = "weeks")
</code></pre>

<hr>
<h2 id='xgx_scale_y_log10'>log10 scales the y axis with a &quot;pretty&quot; set of breaks</h2><span id='topic+xgx_scale_y_log10'></span>

<h3>Description</h3>

<p><code>xgx_scale_y_log10</code> is similar to 
<code><a href="ggplot2.html#topic+scale_continuous">scale_y_log10</a></code>.  
But it uses what we believe to be a nicer spacing and set of tick marks
it can be used the same as 
<code><a href="ggplot2.html#topic+scale_continuous">scale_y_log10</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_scale_y_log10(
  breaks = xgx_breaks_log10,
  minor_breaks = NULL,
  labels = xgx_labels_log10,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_scale_y_log10_+3A_breaks">breaks</code></td>
<td>
<p>major breaks, default is a function defined here</p>
</td></tr>
<tr><td><code id="xgx_scale_y_log10_+3A_minor_breaks">minor_breaks</code></td>
<td>
<p>minor breaks, default is a function defined here</p>
</td></tr>
<tr><td><code id="xgx_scale_y_log10_+3A_labels">labels</code></td>
<td>
<p>function for setting the labels, defined here</p>
</td></tr>
<tr><td><code id="xgx_scale_y_log10_+3A_...">...</code></td>
<td>
<p>other arguments passed to 
<code><a href="ggplot2.html#topic+scale_continuous">scale_y_log10</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 compatible scale object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- 10^(seq(-3, 3, by = 0.1))
ec50 &lt;- 1
data &lt;- data.frame(concentration = conc, 
                   bound_receptor = 1 * conc / (conc + ec50))
ggplot2::ggplot(data, ggplot2::aes(y = concentration, x = bound_receptor)) +
  ggplot2::geom_point() +
  ggplot2::geom_line() +
  xgx_scale_y_log10() +
  xgx_scale_x_reverselog10()
  
</code></pre>

<hr>
<h2 id='xgx_scale_y_percentchangelog10'>percentchangelog10 transform for the y scale.</h2><span id='topic+xgx_scale_y_percentchangelog10'></span><span id='topic+xgx_scale_x_percentchangelog10'></span>

<h3>Description</h3>

<p><code>xgx_scale_y_percentchangelog10</code> and <code>xgx_scale_x_percentchangelog10</code> are designed 
to be used with percent change (PCHG) from baseline data (on a scale of -1 to +Inf).
Common examples include 
It is used when you have a wide range of data on a percent change scale, 
especially data close to -100
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_scale_y_percentchangelog10(
  breaks = NULL,
  minor_breaks = NULL,
  labels = NULL,
  accuracy = 1,
  n_breaks = 7,
  ...
)

xgx_scale_x_percentchangelog10(
  breaks = NULL,
  minor_breaks = NULL,
  labels = NULL,
  accuracy = 1,
  n_breaks = 7,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_scale_y_percentchangelog10_+3A_breaks">breaks</code></td>
<td>
<p>if NULL, then default is to use a variant of 
2^(labeling::extended(log2(PCHG + 1))) - 1, where PCHG represents the range of the data</p>
</td></tr>
<tr><td><code id="xgx_scale_y_percentchangelog10_+3A_minor_breaks">minor_breaks</code></td>
<td>
<p>if NULL, then default is to use nicely spaced log10(PCHG + 1) minor breaks</p>
</td></tr>
<tr><td><code id="xgx_scale_y_percentchangelog10_+3A_labels">labels</code></td>
<td>
<p>if NULL, then the default is to use scales::percent_format()</p>
</td></tr>
<tr><td><code id="xgx_scale_y_percentchangelog10_+3A_accuracy">accuracy</code></td>
<td>
<p>accuracy to use with scales::percent_format(), if NULL, 
then the default is set to 1</p>
</td></tr>
<tr><td><code id="xgx_scale_y_percentchangelog10_+3A_n_breaks">n_breaks</code></td>
<td>
<p>number of desired breaks, if NULL, then the default is set to 7</p>
</td></tr>
<tr><td><code id="xgx_scale_y_percentchangelog10_+3A_...">...</code></td>
<td>
<p>other parameters passed to 
<code><a href="ggplot2.html#topic+scale_continuous">scale_y_continuous</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 compatible scale object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat1 &lt;- data.frame(x = rnorm(100), PCHG = exp(rnorm(100)) - 1)

ggplot2::ggplot(dat1, ggplot2::aes(x = x, y = PCHG)) +
  ggplot2::geom_point() +
  xgx_theme() +
  xgx_scale_y_percentchangelog10()
 
</code></pre>

<hr>
<h2 id='xgx_scale_y_reverselog10'>Reverselog transform for the y scale.</h2><span id='topic+xgx_scale_y_reverselog10'></span>

<h3>Description</h3>

<p><code>xgx_scale_y_reverselog10</code> is designed to be used with data 
that approaches 100
A common example is receptor occupancy in drug development.  
It is used when you want even spacing between 90, 99, 99.9, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_scale_y_reverselog10(labels = NULL, accuracy = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_scale_y_reverselog10_+3A_labels">labels</code></td>
<td>
<p>if NULL, then the default is to use scales::percent()</p>
</td></tr>
<tr><td><code id="xgx_scale_y_reverselog10_+3A_accuracy">accuracy</code></td>
<td>
<p>if NULL, then use the the default as specified by scales::percent()
to round to the hundredths place, set accuracy 0.01</p>
</td></tr>
<tr><td><code id="xgx_scale_y_reverselog10_+3A_...">...</code></td>
<td>
<p>other parameters passed to 
<code><a href="ggplot2.html#topic+scale_continuous">scale_y_continuous</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 compatible scale object
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
conc &lt;- 10^(seq(-3, 3, by = 0.1))
ec50 &lt;- 1
data &lt;- data.frame(concentration  = conc,
                   bound_receptor = 1 * conc / (conc + ec50))
ggplot2::ggplot(data, ggplot2::aes(x = concentration, y = bound_receptor)) + 
ggplot2::geom_point() + 
  ggplot2::geom_line() + 
  xgx_scale_x_log10() +
  xgx_scale_y_reverselog10()
 
</code></pre>

<hr>
<h2 id='xgx_stat_ci'>Plot data with mean and confidence intervals</h2><span id='topic+xgx_stat_ci'></span>

<h3>Description</h3>

<p><code>xgx_stat_ci</code> returns a ggplot layer plotting mean +/- confidence 
intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_stat_ci(
  mapping = NULL,
  data = NULL,
  conf_level = 0.95,
  distribution = "normal",
  bins = NULL,
  breaks = NULL,
  geom = list("point", "line", "errorbar"),
  position = "identity",
  fun.args = list(),
  fun.data = NULL,
  na.rm = FALSE,
  orientation = "x",
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_stat_ci_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by 'aes' or 'aes_'. 
If specified and 'inherit.aes = TRUE' (the default), it is combined with the 
default mapping at the top level of the plot. You must supply mapping if 
there is no plot mapping.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three options:
</p>
<p>If NULL, the default, the data is inherited from the plot data as specified 
in the call to ggplot.
</p>
<p>A data.frame, or other object, will override the plot data. All objects 
will be fortified to produce a data frame. See fortify for which variables 
will be created.
</p>
<p>A function will be called with a single argument, the plot data. The return 
value must be a data.frame., and will be used as the layer data.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_conf_level">conf_level</code></td>
<td>
<p>The percentile for the confidence interval (should fall 
between 0 and 1). The default is 0.95, which corresponds to a 95 percent 
confidence interval.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_distribution">distribution</code></td>
<td>
<p>The distribution which the data follow, used for 
calculating confidence intervals. The options are &quot;normal&quot;, &quot;lognormal&quot;, 
and &quot;binomial&quot;. The &quot;normal&quot; option will use the Student t Distribution 
to calculate confidence intervals, the &quot;lognormal&quot; option will transform 
data to the log space first. The &quot;binomial&quot; option will use the
<code><a href="binom.html#topic+binom.confint">binom.exact</a></code> function to calculate the
confidence 
intervals. Note: binomial data must be numeric and contain only 1's and 0's.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_bins">bins</code></td>
<td>
<p>number of bins to cut up the x data, cuts data into quantiles.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_breaks">breaks</code></td>
<td>
<p>breaks to cut up the x data, if this option is used, bins is ignored</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom. Can be a list of multiple 
geoms, e.g. list(&quot;point&quot;,&quot;line&quot;,&quot;errorbar&quot;), which is the default.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of 
a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_fun.args">fun.args</code></td>
<td>
<p>Optional additional arguments passed on to the functions.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_fun.data">fun.data</code></td>
<td>
<p>A function that is given the complete data and should return 
a data frame with variables ymin, y, and ymax.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a 
warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_orientation">orientation</code></td>
<td>
<p>The orientation of the layer, passed on to ggplot2::stat_summary. 
Only implemented for ggplot2 v.3.3.0 and later. The default (&quot;x&quot;) summarizes y values over
x values (same behavior as ggplot2 v.3.2.1 or earlier). Setting <code>orientation = "y"</code> will 
summarize x values over y values, which may be useful in some situations where you want to flip
the axes, e.g. to create forest plots. Setting <code>orientation = NA</code> will try to automatically
determine the orientation from the aesthetic mapping (this is more stable for ggplot2 v.3.3.2
compared to v.3.3.0).
See <code><a href="ggplot2.html#topic+stat_summary">stat_summary</a></code> (v.3.3.0 or greater) for more information.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? 
NA, the default, includes if any aesthetics are mapped. FALSE never 
includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather 
than combining with them. This is most useful for helper functions that 
define both data and aesthetics and shouldn't inherit behaviour from the 
default plot specification, e.g. borders.</p>
</td></tr>
<tr><td><code id="xgx_stat_ci_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer. These are often aesthetics, 
used to set an aesthetic to a fixed value, like color = &quot;red&quot; or size = 3. 
They may also be parameters to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to generate mean +/- confidence interval plots 
for different distributions, 
and multiple geoms with a single function call.
</p>


<h3>Value</h3>

<p>ggplot2 plot layer
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default settings for normally distributed data, 95% confidence interval,  
data &lt;- data.frame(x = rep(c(1, 2, 3), each = 20),
                   y = rep(c(1, 2, 3), each = 20) + stats::rnorm(60),
                   group = rep(1:3, 20))
xgx_plot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_stat_ci(conf_level = 0.95)

# try different geom 
xgx_plot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_stat_ci(conf_level = 0.95, geom = list("ribbon", "point", "line"))
 
# plotting lognormally distributed data
data &lt;- data.frame(x = rep(c(1, 2, 3), each = 20),
                   y = 10^(rep(c(1, 2, 3), each = 20) + stats::rnorm(60)),
                   group = rep(1:3, 20))
xgx_plot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_stat_ci(conf_level = 0.95, distribution = "lognormal")
  
# note: you DO NOT need to use both distribution = "lognormal"
# and scale_y_log10()
xgx_plot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_stat_ci(conf_level = 0.95) + xgx_scale_y_log10()
 
# plotting binomial data
data &lt;- data.frame(x = rep(c(1, 2, 3), each = 20),
                   y = stats::rbinom(60, 1, rep(c(0.2, 0.6, 0.8),
                   each = 20)),
                   group = rep(1:3, 20))
xgx_plot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_stat_ci(conf_level = 0.95, distribution = "binomial")
 
# including multiple groups in same plot
xgx_plot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_stat_ci(conf_level = 0.95, distribution = "binomial", 
              ggplot2::aes(color = factor(group)),
              position = ggplot2::position_dodge(width = 0.5))
              
# plotting ordinal or multinomial data
set.seed(12345) 
data = data.frame(x = 120*exp(stats::rnorm(100,0,1)), 
              response = sample(c("Mild","Moderate","Severe"), 100, replace = TRUE),
              covariate = sample(c("Male","Female"), 100, replace = TRUE))
  
xgx_plot(data = data) + 
  xgx_stat_ci(mapping = ggplot2::aes(x = x, response = response, colour = covariate), 
              distribution = "ordinal", bins = 4) + 
  ggplot2::scale_y_continuous(labels = scales::percent_format()) + ggplot2::facet_wrap(~response)

xgx_plot(data = data) + 
  xgx_stat_ci(mapping = ggplot2::aes(x = x, response = response, colour = response), 
              distribution = "ordinal", bins = 4) + 
  ggplot2::scale_y_continuous(labels = scales::percent_format()) + ggplot2::facet_wrap(~covariate)

# Example plotting categorical vs categorical data
set.seed(12345)
data = data.frame(x = 120*exp(stats::rnorm(100,0,1)),
                  response = sample(c("Trt1", "Trt2", "Trt3"), 100, replace = TRUE),
                  covariate = factor(
                    sample(c("White","Black","Asian","Other"), 100, replace = TRUE),
                                     levels = c("White", "Black", "Asian", "Other")))

xgx_plot(data = data) +
  xgx_stat_ci(mapping = ggplot2::aes(x = response, response = covariate),
              distribution = "ordinal") +
  xgx_stat_ci(mapping = ggplot2::aes(x = 1, response = covariate), geom = "hline",
              distribution = "ordinal") +
  ggplot2::scale_y_continuous(labels = scales::percent_format()) + 
  ggplot2::facet_wrap(~covariate) + 
  ggplot2::xlab("Treatment group") + 
  ggplot2::ylab("Percent of subjects by category")

# Same example with orientation flipped (only works for ggplot2 v.3.3.0 or later)
# only run if ggplot2 v.3.3.0 or later
ggplot2_geq_v3.3.0 &lt;- utils::compareVersion(
  as.character(utils::packageVersion("ggplot2")), '3.3.0') &gt;= 0

if(ggplot2_geq_v3.3.0){

xgx_plot(data = data) +
xgx_stat_ci(mapping = ggplot2::aes(y = response, response = covariate), orientation = "y",
            distribution = "ordinal") +
  xgx_stat_ci(mapping = ggplot2::aes(y = 1, response = covariate), orientation = "y", 
              geom = "vline", distribution = "ordinal") +
  ggplot2::scale_x_continuous(labels = scales::percent_format()) +
  ggplot2::facet_wrap(~covariate) +
  ggplot2::ylab("Treatment group") +
  ggplot2::xlab("Percent of subjects by category")
  
}

 
</code></pre>

<hr>
<h2 id='xgx_stat_pi'>Plot data with median and percent intervals</h2><span id='topic+xgx_stat_pi'></span>

<h3>Description</h3>

<p><code>xgx_stat_pi</code> returns a ggplot layer plotting median +/- percent 
intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_stat_pi(
  mapping = NULL,
  data = NULL,
  percent_level = 0.95,
  geom = list("line", "ribbon"),
  position = "identity",
  bins = NULL,
  breaks = NULL,
  fun.args = list(),
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_stat_pi_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by 'aes' or 'aes_'. 
If specified and 'inherit.aes = TRUE' (the default), it is combined with the 
default mapping at the top level of the plot. You must supply mapping if 
there is no plot mapping.</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three options:
</p>
<p>If NULL, the default, the data is inherited from the plot data as specified 
in the call to ggplot.
</p>
<p>A data.frame, or other object, will override the plot data. All objects 
will be fortified to produce a data frame. See fortify for which variables 
will be created.
</p>
<p>A function will be called with a single argument, the plot data. The return 
value must be a data.frame., and will be used as the layer data.</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_percent_level">percent_level</code></td>
<td>
<p>The upper or lower percentile for the percent interval (should fall 
between 0 and 1). The default is 0.95, which corresponds  
to (0.05, 0.95) interval. Supplying 0.05 would give the same result</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom. Can be a list of multiple 
geoms, e.g. list(&quot;line&quot;,&quot;ribbon&quot;), which is the default.</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of 
a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_bins">bins</code></td>
<td>
<p>number of bins to cut up the x data, cuts data into quantiles.</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_breaks">breaks</code></td>
<td>
<p>breaks to cut up the x data, if this option is used, bins is ignored</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_fun.args">fun.args</code></td>
<td>
<p>Optional additional arguments passed on to the functions.</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a 
warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? 
NA, the default, includes if any aesthetics are mapped. FALSE never 
includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather 
than combining with them. This is most useful for helper functions that 
define both data and aesthetics and shouldn't inherit behaviour from the 
default plot specification, e.g. borders.</p>
</td></tr>
<tr><td><code id="xgx_stat_pi_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer. These are often aesthetics, 
used to set an aesthetic to a fixed value, like color = &quot;red&quot; or size = 3. 
They may also be parameters to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 plot layer
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default settings for normally distributed data, (5%,95%) interval,
data &lt;- data.frame(x = rep(c(1, 2, 3), each = 20),
                   y = rep(c(1, 2, 3), each = 20) + stats::rnorm(60),
                   group = rep(1:3, 20))
xgx_plot(data, ggplot2::aes(x = x, y = y)) +
  xgx_stat_pi(percent_level = 0.95)

# try different geom 
xgx_plot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_stat_pi(percent_level = 0.95, geom = list("errorbar", "point", "line"))
 
# including multiple groups in same plot
xgx_plot(data, ggplot2::aes(x = x, y = y)) + 
  xgx_stat_pi(percent_level = 0.95, 
              ggplot2::aes(color = factor(group), fill = factor(group)),
              position = ggplot2::position_dodge(width = 0.5))
              
# including multiple percent intervals in same plot              
xgx_plot(data, ggplot2::aes(x = x, y = y)) +
  xgx_stat_pi(percent_level = 0.90) + 
  xgx_stat_pi(percent_level = 0.80) + 
  xgx_stat_pi(percent_level = 0.70) + 
  xgx_stat_pi(percent_level = 0.60)      
 
</code></pre>

<hr>
<h2 id='xgx_stat_smooth'>Wrapper for stat_smooth</h2><span id='topic+xgx_stat_smooth'></span><span id='topic+xgx_geom_smooth'></span><span id='topic+xgx_geom_smooth_emax'></span>

<h3>Description</h3>

<p><code>xgx_stat_smooth</code> and <code>xgx_geom_smooth</code> produce smooth fits through continuous or categorical data. 
For categorical, ordinal, or multinomial data use method = polr. 
This wrapper also works with nonlinear methods like nls and nlsLM for continuous data.
</p>
<p><code>xgx_geom_smooth_emax</code> uses minpack.lm::nlsLM, predictdf.nls, and stat_smooth to display Emax model fit to data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_stat_smooth(
  mapping = NULL,
  data = NULL,
  geom = "smooth",
  position = "identity",
  ...,
  method = NULL,
  formula = NULL,
  se = TRUE,
  n = 80,
  span = 0.75,
  n_boot = 200,
  fullrange = FALSE,
  level = 0.95,
  method.args = list(),
  na.rm = FALSE,
  orientation = "x",
  show.legend = NA,
  inherit.aes = TRUE
)

xgx_geom_smooth(
  mapping = NULL,
  data = NULL,
  geom = "smooth",
  position = "identity",
  ...,
  method = NULL,
  formula = NULL,
  se = TRUE,
  n = 80,
  span = 0.75,
  fullrange = FALSE,
  level = 0.95,
  method.args = list(),
  na.rm = FALSE,
  orientation = "x",
  show.legend = NA,
  inherit.aes = TRUE
)

xgx_geom_smooth_emax(
  mapping = NULL,
  data = NULL,
  geom = "smooth",
  position = "identity",
  ...,
  method = "nlsLM",
  formula,
  se = TRUE,
  n = 80,
  span = 0.75,
  fullrange = FALSE,
  level = 0.95,
  method.args = list(),
  na.rm = FALSE,
  orientation = "x",
  show.legend = NA,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_stat_smooth_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by 'aes' or 'aes_'. 
If specified and 'inherit.aes = TRUE' (the default), it is combined with the 
default mapping at the top level of the plot. You must supply mapping if 
there is no plot mapping.
Warning: for 'method = polr', do not define 'y' aesthetic, use 'response' instead.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three options:
</p>
<p>If NULL, the default, the data is inherited from the plot data as specified 
in the call to ggplot.
</p>
<p>A data.frame, or other object, will override the plot data. All objects 
will be fortified to produce a data frame. See fortify for which variables 
will be created.
</p>
<p>A function will be called with a single argument, the plot data. The return 
value must be a data.frame., and will be used as the layer data.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom. Can be a list of multiple 
geoms, e.g. list(&quot;point&quot;,&quot;line&quot;,&quot;errorbar&quot;), which is the default.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of 
a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer. These are often aesthetics, 
used to set an aesthetic to a fixed value, like color = &quot;red&quot; or size = 3. 
They may also be parameters to the paired geom/stat.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_method">method</code></td>
<td>
<p>method (function) to use, eg. lm, glm, gam, loess, rlm. 
Example: '&quot;polr&quot;' for ordinal data. '&quot;nlsLM&quot;' for nonlinear least squares.
If method is left as 'NULL', then a typical 'StatSmooth' is applied, 
with the corresponding defaults, i.e. For datasets with n &lt; 1000 default is loess. 
For datasets with 1000 or more observations defaults to gam.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_formula">formula</code></td>
<td>
<p>formula to use in smoothing function, eg. y ~ x, y ~ poly(x, 2), y ~ log(x)</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_se">se</code></td>
<td>
<p>display confidence interval around smooth? (TRUE by default, see level to control)</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_n">n</code></td>
<td>
<p>number of points to evaluate smoother at</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_span">span</code></td>
<td>
<p>Controls the amount of smoothing for the default loess smoother. 
Smaller numbers produce wigglier lines, larger numbers produce smoother lines.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_n_boot">n_boot</code></td>
<td>
<p>number of bootstraps to perform to compute confidence interval, 
currently only used for method = &quot;polr&quot;, default is 200</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_fullrange">fullrange</code></td>
<td>
<p>should the fit span the full range of the plot, or just the data</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_level">level</code></td>
<td>
<p>The percentile for the confidence interval (should fall 
between 0 and 1). The default is 0.95, which corresponds to a 95 percent 
confidence interval.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_method.args">method.args</code></td>
<td>
<p>Optional additional arguments passed on to the method.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a 
warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_orientation">orientation</code></td>
<td>
<p>The orientation of the layer, passed on to ggplot2::stat_summary. 
Only implemented for ggplot2 v.3.3.0 and later. The default (&quot;x&quot;) summarizes y values over
x values (same behavior as ggplot2 v.3.2.1 or earlier). Setting <code>orientation = "y"</code> will 
summarize x values over y values, which may be useful in some situations where you want to flip
the axes, e.g. to create forest plots. Setting <code>orientation = NA</code> will try to automatically
determine the orientation from the aesthetic mapping (this is more stable for ggplot2 v.3.3.2
compared to v.3.3.0).</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? 
NA, the default, includes if any aesthetics are mapped. FALSE never 
includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="xgx_stat_smooth_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather 
than combining with them. This is most useful for helper functions that 
define both data and aesthetics and shouldn't inherit behaviour from the 
default plot specification, e.g. borders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 plot layer
</p>


<h3>Warning</h3>

<p><code>nlsLM</code> uses <code>nls.lm</code> which implements the Levenberg-Marquardt
algorithm for fitting a nonlinear model, and may fail to converge for a
number of reasons. See <code>?nls.lm</code> for more information.
</p>
<p><code>nls</code> uses Gauss-Newton method for estimating parameters, 
and could fail if the parameters are not identifiable. If this happens 
you will see the following warning message: 
Warning message:
Computation failed in 'stat_smooth()':
singular gradient
</p>
<p><code>nls</code> will also fail if used on artificial &quot;zero-residual&quot; data, 
use <code>nlsLM</code> instead.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predictdf.nls">predictdf.nls</a></code> for information on how nls confidence intervals are calculated.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example with nonlinear least squares (method = "nlsLM")
Nsubj &lt;- 10
Doses &lt;- c(0, 25, 50, 100, 200)
Ntot &lt;- Nsubj*length(Doses)
times &lt;- c(0,14,30,60,90)

dat1 &lt;- data.frame(ID = 1:(Ntot),
                   DOSE = rep(Doses, Nsubj),
                   PD0 = stats::rlnorm(Ntot, log(100), 1),
                   Kout = exp(stats::rnorm(Ntot,-2, 0.3)),
                   Imax = 1,
                   ED50 = 25) %&gt;%
  dplyr::mutate(PDSS = PD0*(1 - Imax*DOSE/(DOSE + ED50))*exp(stats::rnorm(Ntot, 0.05, 0.3))) %&gt;%
  merge(data.frame(ID = rep(1:(Ntot), each = length(times)), Time = times), by = "ID") %&gt;%
  dplyr::mutate(PD = ((PD0 - PDSS)*(exp(-Kout*Time)) + PDSS), 
                PCHG = (PD - PD0)/PD0)

gg &lt;- ggplot2::ggplot(dat1 %&gt;% subset(Time == 90), 
                      ggplot2::aes(x = DOSE, y = PCHG)) +
  ggplot2::geom_boxplot(ggplot2::aes(group = DOSE)) +
  xgx_theme() +
  xgx_scale_y_percentchangelog10() +
  ggplot2::ylab("Percent Change from Baseline") +
  ggplot2::xlab("Dose (mg)")

gg +
  xgx_stat_smooth(method = "nlsLM", formula = y ~ E0 + Emax*x/(ED50 + x),
                  method.args = list(
                    start = list(Emax = -0.50, ED50 = 25, E0 = 0),
                    lower = c(-Inf, 0, -Inf)
                  ),
                  se = TRUE)
              
gg + 
  xgx_geom_smooth_emax()  
  
## Not run:   
# example with ordinal data (method = "polr")
set.seed(12345)
data = data.frame(x = 120*exp(stats::rnorm(100,0,1)),
                  response = sample(c("Mild","Moderate","Severe"), 100, replace = TRUE),
                  covariate = sample(c("Male","Female"), 100, replace = TRUE)) %&gt;%
  dplyr::mutate(y = (50 + 20*x/(200 + x))*exp(stats::rnorm(100, 0, 0.3)))
  
# example coloring by the response categories
xgx_plot(data = data) +
  xgx_stat_smooth(mapping = ggplot2::aes(x = x, response = response,
                                         colour = response, fill = response),
                  method = "polr") +
  ggplot2::scale_y_continuous(labels = scales::percent_format())


# example faceting by the response categories, coloring by a different covariate 
xgx_plot(data = data) +
xgx_stat_smooth(mapping = ggplot2::aes(x = x, response = response, 
                                       colour = covariate, fill = covariate),
                method = "polr", level = 0.80) + 
                ggplot2::facet_wrap(~response) + 
                ggplot2::scale_y_continuous(labels = scales::percent_format())

## End(Not run)

</code></pre>

<hr>
<h2 id='xgx_summarize_covariates'>Summarize Covariate information in a dataset</h2><span id='topic+xgx_summarize_covariates'></span>

<h3>Description</h3>

<p><code>xgx_summarize_covariates</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_summarize_covariates(data, covariates = NULL, n_cts = 8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_summarize_covariates_+3A_data">data</code></td>
<td>
<p>the dataset to check. must contain a USUBJID or ID column 
for subject id</p>
</td></tr>
<tr><td><code id="xgx_summarize_covariates_+3A_covariates">covariates</code></td>
<td>
<p>the column names of covariates, to explore</p>
</td></tr>
<tr><td><code id="xgx_summarize_covariates_+3A_n_cts">n_cts</code></td>
<td>
<p>the number of unique values for a covariate to be treated as 
continuous, default is 8</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(ID = 1:10, WT0 = rnorm(10, 70, 10),
                   SEX = round(runif(10)))
x &lt;- xgx_summarize_covariates(data, c("WT0", "SEX"))

</code></pre>

<hr>
<h2 id='xgx_summarize_data'>Check data for various issues</h2><span id='topic+xgx_summarize_data'></span>

<h3>Description</h3>

<p>Calls <code><a href="#topic+xgx_check_data">xgx_check_data</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_summarize_data(data, covariates = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xgx_summarize_data_+3A_data">data</code></td>
<td>
<p>the dataset to check.  Must contain the above columns</p>
</td></tr>
<tr><td><code id="xgx_summarize_data_+3A_covariates">covariates</code></td>
<td>
<p>the column names of covariates, to explore</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>covariates &lt;- c("WEIGHTB", "SEX")
check &lt;- xgx_summarize_data(mad_missing_duplicates, covariates)
</code></pre>

<hr>
<h2 id='xgx_theme'>Calls the standard theme for xGx graphics</h2><span id='topic+xgx_theme'></span>

<h3>Description</h3>

<p>Calls the standard theme for xGx graphics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_theme()
</code></pre>


<h3>Value</h3>

<p>xgx ggplot2 compatible theme
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- 10^(seq(-3, 3, by = 0.1))
ec50 &lt;- 1
data &lt;- data.frame(concentration = conc, 
                   bound_receptor = 1 * conc / (conc + ec50))
ggplot2::ggplot(data, ggplot2::aes(y = concentration, x = bound_receptor)) +
  ggplot2::geom_point() +
  ggplot2::geom_line() +
  xgx_scale_y_log10() +
  xgx_scale_x_reverselog10() +
  xgx_theme()
  
</code></pre>

<hr>
<h2 id='xgx_theme_set'>Sets the standard theme for xGx graphics</h2><span id='topic+xgx_theme_set'></span>

<h3>Description</h3>

<p>xgx_theme_set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xgx_theme_set()
</code></pre>


<h3>Value</h3>

<p>xgx ggplot2 compatible theme
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- 10^(seq(-3, 3, by = 0.1))
ec50 &lt;- 1
data &lt;- data.frame(concentration = conc, 
                   bound_receptor = 1 * conc / (conc + ec50))
xgx_theme_set()
ggplot2::ggplot(data, ggplot2::aes(y = concentration, x = bound_receptor)) +
  ggplot2::geom_point() +
  ggplot2::geom_line() +
  xgx_scale_y_log10() +
  xgx_scale_x_reverselog10()
  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
