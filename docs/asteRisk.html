<!DOCTYPE html><html><head><title>Help for package asteRisk</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {asteRisk}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calculateRazel'><p>Calculates azimuth, elevation and range of a given object</p></a></li>
<li><a href='#dateTimeToMJD'><p>Calculate Modified Julian Date for a given date and time</p></a></li>
<li><a href='#deg2rad'><p>Converts an angle in degrees to radians</p></a></li>
<li><a href='#ECItoKOE'><p>Calculate ECI coordinates from Keplerian orbital elements</p></a></li>
<li><a href='#GCRFtoITRF'><p>Convert coordinates from GCRF to ITRF</p></a></li>
<li><a href='#GCRFtoLATLON'><p>Convert coordinates from GCRF to geodetic latitude, longitude and altitude</p></a></li>
<li><a href='#getLatestSpaceData'><p>Retrieves the latest space data</p></a></li>
<li><a href='#hpop'><p>High-precision numerical orbital propagator</p></a></li>
<li><a href='#ITRFtoGCRF'><p>Convert coordinates from ITRF to GCRF</p></a></li>
<li><a href='#ITRFtoLATLON'><p>Convert coordinates from ITRF to geodetic latitude, longitude and altitude</p></a></li>
<li><a href='#JPLephemerides'><p>Calculate JPL main celestial objects ephemerides for a given Modified Julian Date</p></a></li>
<li><a href='#KOEtoECI'><p>Calculate ECI coordinates from Keplerian orbital elements</p></a></li>
<li><a href='#LATLONtoGCRF'><p>Convert coordinates from geodetic latitude, longitude and altitude to GCRF</p></a></li>
<li><a href='#LATLONtoITRF'><p>Convert coordinates from geodetic latitude, longitude and altitude to ITRF</p></a></li>
<li><a href='#parseTLElines'><p>Parse the lines of a TLE</p></a></li>
<li><a href='#rad2deg'><p>Converts an angle in radians to degrees</p></a></li>
<li><a href='#readGLONASSNavigationRINEX'><p>Read a RINEX navigation file for GLONASS satellites</p></a></li>
<li><a href='#readGPSNavigationRINEX'><p>Read a RINEX navigation file for GPS satellites</p></a></li>
<li><a href='#readOEM'><p>Read an Orbital Ephemeris Message file</p></a></li>
<li><a href='#readTLE'><p>Read a TLE file</p></a></li>
<li><a href='#revDay2radMin'><p>Converts revolutions per day to radians per minute</p></a></li>
<li><a href='#sdp4'><p>Propagate an orbital state vector with the SDP4 model</p></a></li>
<li><a href='#sgdp4'><p>Propagate an orbital state vector with the SGP4/SDP4 model</p></a></li>
<li><a href='#sgp4'><p>Propagate an orbital state vector with the SGP4 model</p></a></li>
<li><a href='#TEMEtoGCRF'><p>Convert coordinates from TEME to GCRF</p></a></li>
<li><a href='#TEMEtoITRF'><p>Convert coordinates from TEME to ITRF</p></a></li>
<li><a href='#TEMEtoLATLON'><p>Convert coordinates from TEME to geodetic latitude, longitude and altitude</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Computation of Satellite Position</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides basic functionalities to calculate the position of
    satellites given a known state vector. The package includes implementations
    of the SGP4 and SDP4 simplified perturbation models to propagate orbital
    state vectors, as well as utilities to read TLE files and convert coordinates
    between different frames of reference. Several of the functionalities of the
    package (including the high-precision numerical orbit propagator) require
    the coefficients and data included in the 'asteRiskData' package, available
    in a 'drat' repository. To install this data package, run 
    'install.packages("asteRiskData", repos="https://rafael-ayala.github.io/drat/")'.
    Felix R. Hoots, Ronald L. Roehrich and T.S. Kelso (1988) <a href="https://celestrak.org/NORAD/documentation/spacetrk.pdf">https://celestrak.org/NORAD/documentation/spacetrk.pdf</a>.
    David Vallado, Paul Crawford, Richard Hujsak and T.S. Kelso (2012) &lt;<a href="https://doi.org/10.2514%2F6.2006-6753">doi:10.2514/6.2006-6753</a>&gt;.
    Felix R. Hoots, Paul W. Schumacher Jr. and Robert A. Glover (2014) &lt;<a href="https://doi.org/10.2514%2F1.9161">doi:10.2514/1.9161</a>&gt;.</td>
</tr>
<tr>
<td>Acknowledgements:</td>
<td>The development of this work is supported by the
following grants: a KAKENHI Grant-in-Aid for Research Activity
Start-up Grant Number 21K20645 to Rafael Ayala, a JSPS
Postdoctoral Fellowship for Research in Japan (Standard) Grant
Number P20810 to Lara Sell√©s Vidal (Overseas researcher under
Postdoctoral Fellowship of Japan Society for the Promotion of
Science), and grants by the Spanish Ministry of Science and
Innovation (grant code PID2019-105471RB-I00) and the Regional
Government of Andalusia (grant code P18-RT-1060) to David Ruiz.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppParallel</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11, GNU make</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve, nanotime, stats, onion, Rcpp, RcppParallel, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>asteRiskData, knitr, formatR, webshot, BiocStyle, RUnit,
BiocGenerics, plotly, lazyeval, dplyr, ggmap, rmarkdown,
markdown</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Rafael-Ayala/asteRisk/issues">https://github.com/Rafael-Ayala/asteRisk/issues</a></td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://rafael-ayala.github.io/drat/">https://rafael-ayala.github.io/drat/</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-14 10:44:33 UTC; rafael</td>
</tr>
<tr>
<td>Author:</td>
<td>Rafael Ayala <a href="https://orcid.org/0000-0002-9332-4623"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Daniel Ayala <a href="https://orcid.org/0000-0003-2095-1009"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  David Ruiz <a href="https://orcid.org/0000-0003-4460-5493"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Lara Selles Vidal <a href="https://orcid.org/0000-0003-2537-6824"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rafael Ayala &lt;rafael.ayala@oist.jp&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-14 13:20:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='calculateRazel'>Calculates azimuth, elevation and range of a given object
</h2><span id='topic+calculateRazel'></span>

<h3>Description</h3>

<p>The horizontal coordinate system, also called azimuth-elevation system, uses the 
local horizon of an observer as its fundamental plane. In it, a given point is
defined by 2 main angles: azimuth and elevation. Azimuth defines the angle
of the point around the horizon in the X-Y plane, measured from the true North 
and usually increasing towards the East. Elevation is the angle between the 
object and the X-Y plane. Finally, the range defines the distance between the
observer and the point.
</p>
<p>This function calculates the azimuth, elevation and range given the coordinates
of an observed satellite and of an observer. Both sets of coordinates must be
provided as Cartesian geocentric coordinates in ITRF.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateRazel(geocentricObserver, geocentricSatellite, degreesOutput=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateRazel_+3A_geocentricobserver">geocentricObserver</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of the observer in ITRF frame.
</p>
</td></tr>
<tr><td><code id="calculateRazel_+3A_geocentricsatellite">geocentricSatellite</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of the satellite in ITRF frame.
</p>
</td></tr>
<tr><td><code id="calculateRazel_+3A_degreesoutput">degreesOutput</code></td>
<td>
<p>Logical indicating if the output should be in sexagesimal
degrees. If <code>degreesOutput=FALSE</code>, the output will be in radians.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with three elements, corresponding to the azimuth and elevation in
degrees (or radians if specified) and the range in the same unit as the provided
Cartesian coordinates.
</p>


<h3>References</h3>

<p>https://gssc.esa.int/navipedia/index.php/Transformations_between_ECEF_and_ENU_coordinates
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The following were the coordinates of Italsat-2 in ITRF the 27th of June, 2006
# at 00:58:29.34 UTC, in meters.

italsat_ITRF &lt;- c(-37325542.8, 19152438.3, 138384.5)

# Let us calculate its azimuth, elevation and range for an observer from Tokyo.
# The latitude and longitude of the city are 35.6762 degrees North, 139.6503 
# degrees East. Let's assume an observer placed at sea level (0 m)
# We first convert these coordinates to ITRF:

observer_ITRF &lt;- LATLONtoITRF(c(35.6762, 139.6503, 0), degreesInput=TRUE)

# We can now calculate the azimuth and elevation:

razel &lt;- calculateRazel(observer_ITRF, italsat_ITRF, degreesOutput=TRUE)
razel[1] # Azimuth
razel[2] # Elevation
</code></pre>

<hr>
<h2 id='dateTimeToMJD'>Calculate Modified Julian Date for a given date and time
</h2><span id='topic+dateTimeToMJD'></span>

<h3>Description</h3>

<p>The Julian Date (JD) of a given date and time is the number of days since noon of
Monday 1st of January 4713 BC, including a fractional part. Modified Julian Date
(MJD) are instead the number of days since 00:00 of November 17th, 1858. The 
difference JD and MJD for a given instant is always 2400000.5, which is the JD
of the reference time for MJD.
</p>
<p>This function calculates the MJD of a date and time, provided as a date-time
character string in UTC time. The output refers by default to the MJD in UTC,
but different time systems can be chosen: UTC (Coordinated Universal Time),
UT1 (Universal Time), TT (Terrestrial Time) and TDB (Barycentric Dynamical Time).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dateTimeToMJD(dateTime, timeSystem="UTC")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dateTimeToMJD_+3A_datetime">dateTime</code></td>
<td>
<p>Date-time string with the date and time in UTC corresponding
to the provided geodetic coordinates.
</p>
</td></tr>
<tr><td><code id="dateTimeToMJD_+3A_timesystem">timeSystem</code></td>
<td>
<p>Time system into which the MJD should be calculated. Should
be one from &quot;UTC&quot; (Coordinated Universal Time; default), &quot;UT1&quot; (Universal Time), 
&quot;TT&quot; (Terrestrial Time) and &quot;TDB&quot; (Barycentric Dynamical Time).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The MJD for the specified date and time in the chosen time system.
</p>


<h3>References</h3>

<p>https://gssc.esa.int/navipedia/index.php/Julian_Date
https://gssc.esa.int/navipedia/index.php/Transformations_between_Time_Systems
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
# Let's calculate the MJD of the 12th of June, 2000 at 10:00:00 UTC time, in UTC

MJD_UTC &lt;- dateTimeToMJD("2000-06-12 10:00:00", timeSystem = "UTC")

# Let's now calculate the MJD for the same instant in TDB:

MJD_TDB &lt;- dateTimeToMJD("2000-06-12 10:00:00", timeSystem = "TDB")

# We can now calculate the difference in seconds, which matches the difference 
# between UTC and TDB for that day:

(MJD_UTC - MJD_TDB) * 86400
}
</code></pre>

<hr>
<h2 id='deg2rad'>Converts an angle in degrees to radians
</h2><span id='topic+deg2rad'></span>

<h3>Description</h3>

<p>This function converts an angle in degrees to radians.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deg2rad(degrees)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deg2rad_+3A_degrees">degrees</code></td>
<td>
<p>Value of the angle in degrees.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The corresponding value of the angle in radians.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>deg2rad(180)
</code></pre>

<hr>
<h2 id='ECItoKOE'>Calculate ECI coordinates from Keplerian orbital elements
</h2><span id='topic+ECItoKOE'></span>

<h3>Description</h3>

<p>Keplerian orbital elements are a set of six parameters used to described the
orbits of celestial objects, including satellites. While satellites do not
follow a perfectly Keplerian orbit, their state at any point can be defined
by the orbital parameters that they would have if they were located at the same
position with the same velocity following a perfectly Keplerian orbit (i.e.,
if perturbations were absent). These are called osculating orbital elements.
</p>
<p>Keplerian orbital elements can be unequivocally determined from a satellite
if its position and velocity are known. This function calculates orbital
elements from the position and velocity of a satellite in an ECI (Earth-centered
inertial) frame of reference. The elements (such as the equatorial plane) with 
respect to which the resulting orbital elements will be defined are the same as 
those used for the ECI frame of reference. The function calculates the six
standard orbital elements, plus some alternative elements useful for the 
characterization of special orbits, such as circular ones or orbits with no
inclination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ECItoKOE(position_ECI, velocity_ECI)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ECItoKOE_+3A_position_eci">position_ECI</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of an object in an ECI frame, in m.
</p>
</td></tr>
<tr><td><code id="ECItoKOE_+3A_velocity_eci">velocity_ECI</code></td>
<td>
<p>Vector with the X, Y and Z components of the velocity
of an object in an ECI frame, in m/s.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following standard and alternative orbital elements:
</p>
<table>
<tr><td><code>semiMajorAxis</code></td>
<td>
<p>Semi-major axis of orbital ellipse in meters.
</p>
</td></tr>
<tr><td><code>eccentricity</code></td>
<td>
<p>Numerical eccentricity of the orbit. Eccentricity measures how much
the orbit deviates from being circular.
</p>
</td></tr>
<tr><td><code>inclination</code></td>
<td>
<p>Inclination of the orbital plane in radians. Inclination is the
angle between the orbital plane and the equator.
</p>
</td></tr>
<tr><td><code>meanAnomaly</code></td>
<td>
<p>Mean anomaly of the orbit in radians. Mean anomaly indicates where
the satellite is along its orbital path, and is defined as the angle between
the direction of the perigee and the hypothetical point where the object would 
be if it was moving in a circular orbit with the same period as its true orbit 
after the same amount of time since it last crossed the perigee had ellapsed.
</p>
</td></tr>
<tr><td><code>argumentPerigee</code></td>
<td>
<p>Argument of perigee in radians. This is the angle between the 
direction of the ascending node and the direction of the perigee (the point of 
the orbit at which the object is closest to the Earth).
</p>
</td></tr>
<tr><td><code>longitudeAscendingNode</code></td>
<td>
<p>Longitude of the ascending node (also called
right ascension of the ascending node) in radians. This is the angle between 
the direction of the ascending node (the point where thesatellite crosses the 
equatorial plane moving north) and the direction of the First Point of Aries 
(which indicates the location of the vernal equinox).
</p>
</td></tr>
<tr><td><code>trueAnomaly</code></td>
<td>
<p>True anomaly of the orbit in radians. Unlike mean anomaly,
true anomaly is the angle between the direction of the perigee and the actual
position of the satellite.
</p>
</td></tr>
<tr><td><code>argumentLatitude</code></td>
<td>
<p>Argument of latitude of the orbit in radians. Defined
as the angle between the equator and the position of the satellite. It is
useful to define the position of satellites in circular orbits, where the
argument of perigee and true anomaly are not well defined.
</p>
</td></tr>
<tr><td><code>longitudePerigee</code></td>
<td>
<p>Longitude of perigee of the orbit in radians. Defined
as the angle between the vernal equinox and the perigee. It is useful for
cases of orbits with 0 inclination, where the longitude of the ascending node
and the argument of perigee are not well defined.
</p>
</td></tr>
<tr><td><code>trueLongitude</code></td>
<td>
<p>Longitude of perigee of the orbit in radians. Defined
as the angle between the vernal equinox and the position of the satellite. 
It is useful for cases of circular orbits with 0 inclination, where the 
longitude of the ascending node, the argument of perigee and true anomaly are
not well defined.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>https://www.gsc-europa.eu/system-service-status/orbital-and-technical-parameters
https://celestrak.org/columns/v02n01/
https://www.faa.gov/about/office_org/headquarters_offices/avs/offices/aam/cami/library/online_libraries/aerospace_medicine/tutorial/media/iii.4.1.4_describing_orbits.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The following were the position and velocity of satellite MOLNIYA 1-83 
# the 25th of June, 2006 at 00:33:43 UTC in the GCRF frame (in m and m/s).

position_GCRF &lt;- c(-14471729.582, -4677558.558, 9369.461)
velocity_GCRF &lt;- c(-3251.691, -3276.008, 4009.228)

# Let's calculate the orbital elements of the satellite at that time

orbital_elements &lt;- ECItoKOE(position_GCRF, velocity_GCRF)
</code></pre>

<hr>
<h2 id='GCRFtoITRF'>Convert coordinates from GCRF to ITRF
</h2><span id='topic+GCRFtoITRF'></span>

<h3>Description</h3>

<p>The GCRF (Geocentric Celestial Reference Frame) frame of reference is an 
Earth-centered inertial coordinate frame, where the origin is placed at the 
center of mass of Earth and the coordinate frame is fixed with respect to the 
stars (and therefore not fixed with respect to the Earth surface in its 
rotation). The X-axis is aligned with the mean equinox of Earth at 12:00
Terrestrial Time on the 1st of January, 2000, and the Z-axis is aligned with
the Earth¬¥s rotation axis.
</p>
<p>It is almost equivalent to the J2000 frame of reference (also called EME2000), 
and in some contexts it is also referred to as ICRF frame (although in its 
strict definition, the origin of coordinates is placed at the barycenter of the 
Solar System).
</p>
<p>In the ITRF (International Terrestrial Reference Frame), the origin is also 
placed at the center of mass of Earth, but the frame rotates with respect to the 
stars to remain fixed with respect to the Earth surface as it rotates. The 
Z-axis extends along the true North as defined by the IERS reference pole, and 
the X-axis extends towards the intersection between the equator and the 
Greenwich meridian at any time.
</p>
<p>The coordinates and velocities input and calculated with the high-precision
orbital propagator (<a href="#topic+hpop">hpop</a>) are in the GCRF frame of reference.
</p>
<p>This function requires the <code>asteRiskData</code> package, which can be installed 
by running <code>install.packages('asteRiskData', repos='https://rafael-ayala.github.io/drat/')</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GCRFtoITRF(position_GCRF, velocity_GCRF, dateTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GCRFtoITRF_+3A_position_gcrf">position_GCRF</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of an object in GCRF frame, in m.
</p>
</td></tr>
<tr><td><code id="GCRFtoITRF_+3A_velocity_gcrf">velocity_GCRF</code></td>
<td>
<p>Vector with the X, Y and Z components of the velocity
of an object in GCRF frame, in m/s.
</p>
</td></tr>
<tr><td><code id="GCRFtoITRF_+3A_datetime">dateTime</code></td>
<td>
<p>Date-time string with the date and time in UTC corresponding
to the provided position and velocity vectors. This specifies the time for 
which the conversion from GCRF to ITRF coordinates will be performed. It is
important to provide an accurate value, since the point over the surface of
Earth to which a set of GCRF coordinates refers varies with time due to
the motion of Earth.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements representing the position and velocity of the satellite
in the ITRF (International Terrestrial Reference Frame) frame of reference. 
Position values are in m, and velocity values are in m/s. Each of the two 
elements contains three values, corresponding to the X, Y and Z components of 
position and velocity in this order.
</p>


<h3>References</h3>

<p>https://celestrak.org/columns/v02n01/
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
# The following were the position and velocity of satellite MOLNIYA 1-83 
# the 25th of June, 2006 at 00:33:43 UTC in the GCRF frame (in m and m/s).

position_GCRF &lt;- c(-14471729.582, -4677558.558, 9369.461)
velocity_GCRF &lt;- c(-3251.691, -3276.008, 4009.228)

# Let¬¥s convert them into the ITRF frame

coordinates_ITRF &lt;- GCRFtoITRF(position_GCRF, velocity_GCRF, "2006-06-27 00:58:29.34")
}
</code></pre>

<hr>
<h2 id='GCRFtoLATLON'>Convert coordinates from GCRF to geodetic latitude, longitude and altitude
</h2><span id='topic+GCRFtoLATLON'></span>

<h3>Description</h3>

<p>The GCRF (Geocentric Celestial Reference Frame) frame of reference is an 
Earth-centered inertial coordinate frame, where the origin is placed at the 
center of mass of Earth and the coordinate frame is fixed with respect to the 
stars (and therefore not fixed with respect to the Earth surface in its 
rotation). The X-axis is aligned with the mean equinox of Earth at 12:00
Terrestrial Time on the 1st of January, 2000, and the Z-axis is aligned with
the Earth¬¥s rotation axis. This function converts position in GCRF to geodetic 
latitude, longitude and altitude, which can be considered to be a non-inertial, 
Earth-centered frame of reference.
</p>
<p>This function requires the <code>asteRiskData</code> package, which can be installed 
by running <code>install.packages('asteRiskData', repos='https://rafael-ayala.github.io/drat/')</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GCRFtoLATLON(position_GCRF, dateTime, degreesOutput=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GCRFtoLATLON_+3A_position_gcrf">position_GCRF</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of an object in TEME frame, in m.
</p>
</td></tr>
<tr><td><code id="GCRFtoLATLON_+3A_datetime">dateTime</code></td>
<td>
<p>Date-time string with the date and time in UTC corresponding
to the provided position vector. This specifies the time for which the
conversion from GCRF to geodetic coordinates will be performed. It is
important to provide an accurate value, since the point over the surface of
Earth to which a set of GCRF coordinates refers varies with time due to
the motion of Earth.
</p>
</td></tr>
<tr><td><code id="GCRFtoLATLON_+3A_degreesoutput">degreesOutput</code></td>
<td>
<p>Logical indicating if the output should be in sexagesimal
degrees. If <code>degreesOutput=FALSE</code>, the output will be in radians.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with three elements, corresponding to the latitude and longitude in
degrees (or radians if specified) and the altitude in m.
</p>


<h3>References</h3>

<p>https://arc.aiaa.org/doi/10.2514/6.2006-6753
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
# The following orbital parameters correspond to an object with NORAD catalogue
# number 24208 (Italsat 2) the 26th of June, 2006 at 00:58:29.34 UTC.

n0 &lt;- 1.007781*((2*pi)/(1440))  # Multiplication by 2pi/1440 to convert to radians/min
e0 &lt;- 0.002664 # mean eccentricity at epoch
i0 &lt;- 3.8536*pi/180 # mean inclination at epoch in radians
M0 &lt;- 48.3*pi/180 # mean anomaly at epoch in radians
omega0 &lt;- 311.0977*pi/180 # mean argument of perigee at epoch in radians
OMEGA0 &lt;- 80.0121*pi/180 # mean longitude of ascending node at epoch in radians
Bstar &lt;- 1e-04 # drag coefficient
epochDateTime &lt;- "2006-06-26 00:58:29.34"

# Let¬¥s calculate the position and velocity of the satellite 1 day later

state_1day_TEME &lt;- sgdp4(n0=n0, e0=e0, i0=i0, M0=M0, omega0=omega0, OMEGA0=OMEGA0,
                         Bstar=Bstar, initialDateTime=epochDateTime, targetTime=1440)

# We can now convert the results in TEME frame to GCRF frame, previously
# multiplying by 1000 to convert the km output of sgdp4 to m

state_1day_GCRF &lt;- TEMEtoGCRF(state_1day_TEME$position*1000, 
                              state_1day_TEME$velocity*1000,
                              "2006-06-27 00:58:29.34")

# Finally, we convert the results in GCRF frame to geodetic latitude, longitude
# and altitude

state_1day_geodetic &lt;- GCRFtoLATLON(state_1day_GCRF$position, "2006-06-27 00:58:29.34")
}
</code></pre>

<hr>
<h2 id='getLatestSpaceData'>Retrieves the latest space data
</h2><span id='topic+getLatestSpaceData'></span>

<h3>Description</h3>

<p>The <code>asteRiskData</code> package provides the data and coefficients required
for calculation of forces for <a href="#topic+hpop">hpop</a> and other functions such certain
conversions between reference frames. Some of the data tables included in the
package are updated periodically with new data. These include Earth orientation 
parameters, space weather data and solar and geomagnetic storms. In order to 
perform the calculations dependent on such data for the most recent times, the 
latest available data must be retrieved.
</p>
<p>This function automatically updates the data tables, enabling such calculations
for the most recent times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLatestSpaceData(targets="all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLatestSpaceData_+3A_targets">targets</code></td>
<td>
<p>Character vector specifying the data that should be updated.
It should be a vector containing one or more of the following strings: &quot;all&quot;
(to update all data), &quot;EOP&quot; (Earth orientation parameters), &quot;SW&quot; (space weather),
&quot;SS&quot; (solar storms) or &quot;GS&quot; (geomagnetic storms). By default, all data are 
updated.
</p>
</td></tr></table>


<h3>Value</h3>

<p>This function is invoked for its side effect, which is updating the data tables
used internally for calculations requiring <code>asteRiskData</code> package, such as 
those performed by <a href="#topic+hpop">hpop</a>.
</p>


<h3>References</h3>

<p>http://www.celestrak.org/SpaceData/EOP-All.txt
https://celestrak.org/SpaceData/SW-All.txt
https://sol.spacenvironment.net/jb2008/indices.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {
if(requireNamespace("asteRiskData", quietly = TRUE)) {
# The table of Earth orientation parameters distributed with asteRiskData
# comprises data up to the 21st of March, 2021

asteRiskData::earthPositions[nrow(asteRiskData::earthPositions),]

# The table can be easily updated to include the most recent available data

getLatestSpaceData(targets="all")
asteRiskData::earthPositions[nrow(asteRiskData::earthPositions),]
}
}
</code></pre>

<hr>
<h2 id='hpop'>High-precision numerical orbital propagator
</h2><span id='topic+hpop'></span>

<h3>Description</h3>

<p>Given the position and velocity of a satellite at a given time (in the ICRF
system of coordinates centered on the Solar System Barycenter, any of the main planets,
Earth's Moon or Pluto), propagates its position by calculating its acceleration 
(based on a force model) and solving the resulting second-order ODE through 
numerical integration. This allows propagation of orbits with considerably 
higher accuracy than other propagators such as SGP4 and SDP4, but at the expense 
of a much higher computational cost. The forces and effects currently considered 
are gravitational attraction by the  Earth (using the GGM05C gravity model, with
spherical harmonics up to degree and order of 360); effects of Earth ocean and 
solid tides; gravitational attraction by the Moon (using the GRGM1200B gravity
model with spherical harmonics up to degree and order of 1200), Sun and planets 
(considered as point masses); solar radiation pressure; atmospheric drag, and relativistic 
effects. The forcefield is based on the forces described in Satellite Orbits: 
Models, Methods and Applications (Oliver Montenbruck and Eberhard Gill) and 
Fundamentals of Astrodynamics and Applications (David Vallado).
The NRLMSISE-00 model is used to calculate atmospheric density for the
calculation of atmospheric drag. The FES2014 model is used to calculate Earth 
geopotential model corrections due to ocean tides.
As mentioned before, the central body for the frame of reference can be any of the
Solar System Barycenter (SSB), any of the main planets, Earth's Moon or Pluto.
By default, it is assumed to be Earth, corresponding to GCRF (Geocentric ICRF).
The initial position will be checked against the position of said celestial bodies,
to identify if it falls under the Laplacian gravitational sphere of influence of any of them.
If this is the case, and it differs from the specified central body, the coordinate
system will be changed to be centered on the celestial body whose sphere of influence
includes the object of interest. This avoids instability in propagation.
The high-precision numerical orbital propagator requires the <code>asteRiskData</code>
package, which provides the data and coefficients required for calculation of
the modeled forces. <code>asteRiskData</code> can be installed by running 
<code>install.packages('asteRiskData', repos='https://rafael-ayala.github.io/drat/')</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hpop(position, velocity, dateTime, times, satelliteMass, dragArea, 
     radiationArea, dragCoefficient, radiationCoefficient, 
     earthSphericalHarmonicsDegree=130, solidEarthTides=TRUE,
     oceanTides=TRUE, moonSphericalHarmonicsDegree=150, centralBody="Earth", 
     autoCentralBodyChange=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hpop_+3A_position">position</code></td>
<td>
<p>Initial position of the satellite in the GCRF system of
coordinates. Should be provided as a numeric vector with 3 components that
indicate the X, Y and Z components of the position in meters.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_velocity">velocity</code></td>
<td>
<p>Initial velocity of the satellite in the GCRF system of
coordinates. Should be provided as a numeric vector with 3 components that
indicate the X, Y and Z components of the position in meters/second.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_datetime">dateTime</code></td>
<td>
<p>Date time string in the YYYY-MM-DD HH:MM:SS format indicating
the time corresponding to the initial position and velocity, in UTC time.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_times">times</code></td>
<td>
<p>Vector with the times at which the position and velocity of the
satellite should be calculated, in seconds since the initial time.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_satellitemass">satelliteMass</code></td>
<td>
<p>Mass of the satellite in kilograms.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_dragarea">dragArea</code></td>
<td>
<p>Effective area of the satellite for atmospheric drag in
squared meters. If the way that a satellite will orient with respect to its
velocity is not known, a mean cross-sectional area should be calculated
assuming that the orientation of the satellite with respect to its velocity
will vary uniformly. A decent estimate can be obtained with a flat-plate model,
where the satellite is considered to be parallelepiped-shaped. The mean
effective area can then be calculated as CSA = (S1 + S2 + S3 (+S4))/2, where
S1, S2 and S3 are the areas of the three perpendicular surfaces of the model
and S4 is an optional term to account for the area of solar panels (potential
masking between the solar panels and the main surfaces is not considered; this
might be partially accounted for by introducing a factor to reduce the 
calculated effective area). 
</p>
</td></tr>
<tr><td><code id="hpop_+3A_radiationarea">radiationArea</code></td>
<td>
<p>Effective area of the satellite subject to the effect of
radiation pressure in squared meters.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_dragcoefficient">dragCoefficient</code></td>
<td>
<p>Drag coefficient (Cd) used for the calculation of
atmospheric drag. For low Earth-orbiting satellites, a value of 2.2 is
frequently employed if a better approximation is not available.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_radiationcoefficient">radiationCoefficient</code></td>
<td>
<p>Coefficient for the force resulting from radiation
pressure. This parameter is usually referred to as reflectivity coefficient
(Cr) and the value varies for different satellites and orbits. If unknown,
a value of 1.2 is usually a decent approximation.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_earthsphericalharmonicsdegree">earthSphericalHarmonicsDegree</code></td>
<td>
<p>Maximum degree and order that should be 
considered when calculating the Earth geopotential model. The model will be 
complete up to the specified degree/order, i.e., all zonal, sectorial and
tesseral spherical harmonics will be calculated. The maximum possible value
is 360, since that is the highest degree and order of the Stokes' coefficients
provided in the GGM05C model. Note that spherical harmonics for Earth gravity
field will only be used if Earth is the central body for propagation; otherwise,
only a point-mass attraction will be calculated.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_solidearthtides">solidEarthTides</code></td>
<td>
<p>Logical indicating if corrections of the Cnm and Snm
Stokes' coefficients for the geopotential model due to solid Earth tides 
should be performed, following IERS 2010 procedures and considering anelasticity
of the Earth.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_oceantides">oceanTides</code></td>
<td>
<p>Logical indicating if corrections of the Cnm and Snm
Stokes' coefficients for the geopotential model due to ocean tides should be 
performed, using the FES2014 oceanic tides model.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_moonsphericalharmonicsdegree">moonSphericalHarmonicsDegree</code></td>
<td>
<p>Maximum degree and order that should be 
considered when calculating the Moon gravity model. The model will be 
complete up to the specified degree/order, i.e., all zonal, sectorial and
tesseral spherical harmonics will be calculated. The maximum possible value
is 1200, since that is the highest degree and order of the Stokes' coefficients
provided in the GRGM1200B model. Note that spherical harmonics for Moon gravity
field will only be used if Moon is the central body for propagation; otherwise,
only a point-mass attraction will be calculated.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_centralbody">centralBody</code></td>
<td>
<p>Character string indicating the celestial body on which the
supplied initial position (in ICRF) are centered. Should be one of &quot;SSB&quot; (meaning
Solar System Barycenter), &quot;Mercury&quot;, &quot;Venus&quot;, &quot;Earth&quot;, &quot;Moon&quot;, &quot;Mars&quot;, &quot;Jupiter&quot;,
&quot;Saturn&quot;, &quot;Uranus&quot;, &quot;Neptune&quot; or &quot;Pluto&quot;. The initial position will be checked 
against the position of said celestial bodies, to identify if it falls under the 
Laplacian gravitational sphere of influence of any of them. If this is the case, 
and it differs from the specified central body, the coordinate system will be 
changed to be centered on the celestial body whose sphere of influence includes 
the object of interest.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_autocentralbodychange">autoCentralBodyChange</code></td>
<td>
<p>Logical indicating if the celestial object used as
the center of coordinates should be automatically updated during propagation
based on the radii of the spheres of influence of the main planets, the Moon
and Pluto. By default, <code>autoCentralBodyChange=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="hpop_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to <a href="deSolve.html#topic+ode">ode</a> to control how
numerical integration is performed. By default, the RADAU5 solver is used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the results of the numerical integration at the requested times.
Each row contains the results for one of the requested times. The data frame 
contains eight columns: time (indicating the time for the corresponding row
in seconds since the initial time), X, Y, Z (indicating the X, Y and Z
components of the position for that time in meters), dX, dY and dZ (indicating
the X, Y and Z components of the velocity for that time in meters/second) and 
centralBody, indicating the central body of the frame of reference for the
results for the corresponding time.
Positions and velocities are returned in the ICRF frame of reference, centered
in the celestial body specified in column centralBody. If <code>autoCentralBodyChange=TRUE</code>,
the celestial body whose sphere of influence includes the object of interest
will be automatically used as the central body. Additionally, if transitions in
or out of the spheres of influence of the main celestial bodies are detected
during propagation of the trajectory, the central body will be automatically 
modified accordingly. If <code>autoCentralBodyChange=FALSE</code>, such automatic
changes of the central body will not be performed, and instead the user-specified
central body will be used at all times. Note, however, that it is not recommended
to perform propagation in a frame center at an object different than the celestial
body whose sphere of influence includes the target of propagation, since this
can lead to a substantial loss of accuracy. For details, see <a href="https://etd.auburn.edu/bitstream/handle/10415/1133/Vautier_Mana_34.pdf">M. Vautier, 2008</a>. 
Note that, if none of the spheres of influence of the 
planets, Moon or Pluto  included the object of interest, the center of the ICRF 
frame will be placed at the Solar System Barycenter.
</p>


<h3>References</h3>

<p>Satellite Orbits: Models, Methods and Applications. Oliver Montenbruck and Eberhard Gill.
Fundamentals of Astrodynamics and Applications. David Vallado.
https://www.mathworks.com/matlabcentral/fileexchange/55167-high-precision-orbit-propagator
https://ccmc.gsfc.nasa.gov/modelweb/models/nrlmsise00.php
https://digitalcommons.usu.edu/cgi/viewcontent.cgi?article=1144&amp;context=smallsat
https://iopscience.iop.org/article/10.1088/1742-6596/911/1/012009/pdf
https://www.sciencedirect.com/science/article/pii/S1110016821000016
https://etd.auburn.edu/bitstream/handle/10415/1133/Vautier_Mana_34.pdf?sequence=1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
# The following are the position and velocity in the GCRF frame of satellite
# MOLNIYA 1-83 the 25th of June, 2006 at 00:33:43 UTC.

initialPosition &lt;-c(-14568679.5026116, -4366250.78287623, 9417.9289105405)
initialVelocity &lt;- c(-3321.17428902497, -3205.49400830455, 4009.26862308806) 
initialTime &lt;- "2006-06-25 00:33:43"

# Molniya satellites have a mass of approximately 1600 kg and a cross-section of
# 15 m2. Additionally, let¬¥s use 2.2 and 1.2 as approximately values of the
# drag and reflectivity coefficients, respectively.

molniyaMass &lt;- 1600
molniyaCrossSection &lt;- 15
molniyaCr &lt;- 1.2
molniyaCd &lt;- 2.2

# Let¬¥s calculate the position and velocity of the satellite for each minute of
# the following 10 minutes.

targetTimes &lt;- seq(0, 600, by=60)
hpop_results &lt;- hpop(initialPosition, initialVelocity, initialTime, targetTimes, 
                     molniyaMass, molniyaCrossSection, molniyaCrossSection,
                     molniyaCr, molniyaCd)
}
</code></pre>

<hr>
<h2 id='ITRFtoGCRF'>Convert coordinates from ITRF to GCRF
</h2><span id='topic+ITRFtoGCRF'></span>

<h3>Description</h3>

<p>The ITRF (International Terrestrial Reference Frame) is an ECEF (Earth Centered, 
Earth Fixed) frame of reference, i.e., a non-inertial frame of reference where 
the origin is placed at the center of mass of Earth, and the frame rotates 
with respect to the stars to remain fixed with respect to the Earth surface as 
it rotates. The Z-axis extends along the true North as defined by the IERS
reference pole, and the X-axis extends towards the intersection between the
equator and the Greenwich meridian at any time.
</p>
<p>The GCRF (Geocentric Celestial Reference Frame) frame of reference is an 
Earth-centered inertial coordinate frame, where the origin is also placed at the 
center of mass of Earth and the coordinate frame is fixed with respect to the 
stars (and therefore not fixed with respect to the Earth surface in its 
rotation). The X-axis is aligned with the mean equinox of Earth at 12:00
Terrestrial Time on the 1st of January, 2000, and the Z-axis is aligned with
the Earth¬¥s rotation axis.
</p>
<p>This function requires the <code>asteRiskData</code> package, which can be installed 
by running <code>install.packages('asteRiskData', repos='https://rafael-ayala.github.io/drat/')</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITRFtoGCRF(position_ITRF, velocity_ITRF, dateTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITRFtoGCRF_+3A_position_itrf">position_ITRF</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of an object in ITRF frame, in m.
</p>
</td></tr>
<tr><td><code id="ITRFtoGCRF_+3A_velocity_itrf">velocity_ITRF</code></td>
<td>
<p>Vector with the X, Y and Z components of the velocity
of an object in ITRF frame, in m/s.
</p>
</td></tr>
<tr><td><code id="ITRFtoGCRF_+3A_datetime">dateTime</code></td>
<td>
<p>Date-time string with the date and time in UTC corresponding
to the provided position and velocity vectors. This specifies the time for 
which the conversion from ITRF to GCRF coordinates will be performed. It is
important to provide an accurate value, since the point over the surface of
Earth to which a set of GCRF coordinates refers varies with time due to
the motion of Earth.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements representing the position and velocity of the satellite
in the GCRF (Earth-centered non-intertial) frame of reference. Position values
are in m, and velocity values are in m/s. Each of the two elements contains
three values, corresponding to the X, Y and Z components of position and
velocity in this order.
</p>


<h3>References</h3>

<p>https://celestrak.org/columns/v02n01/
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
# The following were the position and velocity of satellite MOLNIYA 1-83 
# the 25th of June, 2006 at 00:33:43 UTC in the ECEF frame (in m and m/s).

position_ITRF &lt;- c(1.734019e+06, -1.510972e+07, 39.08228)
velocity_ITRF &lt;- c(1468.832, -3962.464, 4007.039)

# Let¬¥s convert them into the GCRF frame

coordinates_GCRF &lt;- ITRFtoGCRF(position_ITRF, velocity_ITRF, "2006-06-25 00:33:43")
}
</code></pre>

<hr>
<h2 id='ITRFtoLATLON'>Convert coordinates from ITRF to geodetic latitude, longitude and altitude
</h2><span id='topic+ITRFtoLATLON'></span>

<h3>Description</h3>

<p>The ITRF (International Terrestrial Reference Frame) is an ECEF (Earth Centered, 
Earth Fixed) frame of reference, i.e., a non-inertial frame of reference where 
the origin is placed at the center of mass of Earth, and the frame rotates 
with respect to the stars to remain fixed with respect to the Earth surface as 
it rotates. The Z-axis extends along the true North as defined by the IERS
reference pole, and the X-axis extends towards the intersection between the
equator and the Greenwich meridian at any time. This function converts Cartesian 
coordinates in the ECEF frame to geodetic latitude, longitude and altitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITRFtoLATLON(position_ITRF, degreesOutput=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITRFtoLATLON_+3A_position_itrf">position_ITRF</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of an object in ITRF frame, in m.
</p>
</td></tr>
<tr><td><code id="ITRFtoLATLON_+3A_degreesoutput">degreesOutput</code></td>
<td>
<p>Logical indicating if the output should be in sexagesimal
degrees. If <code>degreesOutput=FALSE</code>, the output will be in radians.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with three elements, corresponding to the latitude and longitude in
degrees (or radians if specified) and the altitude in m.
</p>


<h3>References</h3>

<p>https://arc.aiaa.org/doi/10.2514/6.2006-6753
</p>


<h3>Examples</h3>

<pre><code class='language-R'>coordinates_ITRF &lt;- c(5062040.1, -530657.4, 3863936.5)

# Let's calculate the geodetic latitude, longitude and altitude

geodetic &lt;- ITRFtoLATLON &lt;- (coordinates_ITRF)

# A longer application example follows, useful to represent the groundtrack of a 
# satellite after propagaton with SGP4/SDP4

if(requireNamespace("asteRiskData", quietly = TRUE)) {
# The following orbital parameters correspond to an object with NORAD catalogue
# number 24208 (Italsat 2) the 26th of June, 2006 at 00:58:29.34 UTC.

n0 &lt;- 1.007781*((2*pi)/(1440))  # Multiplication by 2pi/1440 to convert to radians/min
e0 &lt;- 0.002664 # mean eccentricity at epoch
i0 &lt;- 3.8536*pi/180 # mean inclination at epoch in radians
M0 &lt;- 48.3*pi/180 # mean anomaly at epoch in radians
omega0 &lt;- 311.0977*pi/180 # mean argument of perigee at epoch in radians
OMEGA0 &lt;- 80.0121*pi/180 # mean longitude of ascending node at epoch in radians
Bstar &lt;- 1e-04 # drag coefficient
epochDateTime &lt;- "2006-06-26 00:58:29.34"

# Let¬¥s calculate the position and velocity of the satellite 1 day later

state_1day_TEME &lt;- sgdp4(n0=n0, e0=e0, i0=i0, M0=M0, omega0=omega0, OMEGA0=OMEGA0,
                         Bstar=Bstar, initialDateTime=epochDateTime, targetTime=1440)

# We can now convert the results in TEME frame to ITRF frame, previously
# multiplying by 1000 to convert the km output of sgdp4 to m

state_1day_ITRF &lt;- TEMEtoITRF(state_1day_TEME$position, state_1day_TEME$velocity,
                              "2006-06-27 00:58:29.34")
                              
# Finally, we can convert the ECEF coordinates to geodetic latitude, longitude
# and altitude

state_1day_geodetic &lt;- ITRFtoLATLON(state_1day_ITRF$position)
}
</code></pre>

<hr>
<h2 id='JPLephemerides'>Calculate JPL main celestial objects ephemerides for a given Modified Julian Date
</h2><span id='topic+JPLephemerides'></span>

<h3>Description</h3>

<p>NASA's Jet Propulsion Laboratory (JPL) provides mathematical models of the Solar
System known as Development Ephemerides (DE). The models are given as sets of 
Chebyshev coefficients, which cam be used to calculate the position (and its 
derivatives) of the Sun, the eight major planets, Pluto and the Moon.
This function employes JPL DE440 to calculate the position (and optionally
velocities also) of the mentioned celestial objects, in ICRF frame. 
JPL DE440 covers the period from 1550 to 2650 AC. In addition to the position of 
celestial objects, lunar libration angles are also calculated. Internally, 
calculations are performed by employing Clenshaw's algorithm together with the 
Chebyshev coefficients provided by JPL DE440.
The target time should be specified as a Modified Julian Date (MJD). MJD in different
time systems can be used. Currently, UTC, UT1, TT and TDB are supported.
Additionally, a central body with respect to which positions and velocities are
calculated should be specified. By default, the Solar System Barycenter (SSB) is
used, but additionally Mercury, Venus, Earth, Moon, Mars, Jupiter, Saturn, Uranus,
Neptune or Pluto can be selected.
Note that this function requires the additional package asteRiskData, which
provides the Chebyshev coefficients, and can be installed by running
<code>install.packages("asteRiskData", repos="https://rafael-ayala.github.io/drat/")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JPLephemerides(MJD, timeSystem="UTC", centralBody="SSB", derivatives="acceleration")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JPLephemerides_+3A_mjd">MJD</code></td>
<td>
<p>Modified Julian Date of the time for which celestial object ephemerides
should be calculated. MJD are fractional number of days since midnight of the
17th of November, 1858. The MJD of a date-time string can be obtained with
function <a href="#topic+dateTimeToMJD">dateTimeToMJD</a>.
</p>
</td></tr>
<tr><td><code id="JPLephemerides_+3A_timesystem">timeSystem</code></td>
<td>
<p>Time system into which the MJD is provided. Should be one 
from &quot;UTC&quot; (Coordinated Universal Time; default), &quot;UT1&quot; (Universal Time), 
&quot;TT&quot; (Terrestrial Time) and &quot;TDB&quot; (Barycentric Dynamical Time).
</p>
</td></tr>
<tr><td><code id="JPLephemerides_+3A_centralbody">centralBody</code></td>
<td>
<p>String indicating the celestial object that will be taken
as the center of coordinates to which positions and velocities are referred.
Must be one of &quot;SSB&quot; (Solar System Barycenter), &quot;Mercury&quot;, &quot;Venus&quot;, &quot;Earth&quot;,
&quot;Moon&quot;, &quot;Mars&quot;, &quot;Jupiter&quot;, &quot;Saturn&quot;, &quot;Uranus&quot;, &quot;Neptune&quot; or &quot;Pluto&quot;.
</p>
</td></tr>
<tr><td><code id="JPLephemerides_+3A_derivatives">derivatives</code></td>
<td>
<p>String indicating what derivatives of positions should be
calculated. Must be one of &quot;none&quot;, &quot;velocity&quot; or &quot;acceleration&quot;. If &quot;none&quot;,
only position is calculated. If &quot;velocity&quot;, velocities are calculated, as well
as first order derivatives of Moon libration angles. If &quot;acceleration&quot;, 
both velocities and accelerations (as well as second order derivatives of Moon 
libration angles) are calculated.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of vectors providing the positions (in meters), velocities (in m/s; only
if requested), accelerations (in m/s^2; only if requested), Moon libration angles 
(in radians), first derivatives of Moon libration angles (in radians/s; only if 
velocities were requested) and second derivatives of Moon libration angles (in
radians/s^2; only if accelerations were requested) of celestial objects with 
respect to the specified central body. For position, velocity and acceleration 
vectors, X, Y and Z components are given in this order. For Moon libration angles
and their derivatives, they are given in the following order: phi, theta and psi.
</p>


<h3>References</h3>

<p>https://gssc.esa.int/navipedia/index.php/Julian_Date
https://gssc.esa.int/navipedia/index.php/Transformations_between_Time_Systems
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
# Let's calculate the MJD of the 12th of June, 2000 at 10:00:00 UTC time, in UTC

MJD_UTC &lt;- dateTimeToMJD("2000-06-12 10:00:00", timeSystem = "UTC")

# Let's now calculate the JPL ephemerides using Earth as the central body:

ephemerides &lt;- JPLephemerides(MJD_UTC, timeSystem = "UTC", centralBody="Earth")

# We can now calculate, for example, the exact distance between the barycenters
# of Earth and Moon

sqrt(sum(ephemerides$positionMoon^2))
}
</code></pre>

<hr>
<h2 id='KOEtoECI'>Calculate ECI coordinates from Keplerian orbital elements
</h2><span id='topic+KOEtoECI'></span>

<h3>Description</h3>

<p>Keplerian orbital elements are a set of six parameters used to described the
orbits of celestial objects, including satellites. While satellites do not
follow a perfectly Keplerian orbit, their state at any point can be defined
by the orbital parameters that they would have if they were located at the same
position with the same velocity following a perfectly Keplerian orbit (i.e.,
if perturbations were absent). These are called osculating orbital elements.
</p>
<p>A complete set of six Keplerian elements defines unequivocally the position
and velocity of the satellite in a given frame of reference, and therefore can
be used to calculate its cartesian coordinates. This function calculates the
coordinates of a satellite in an ECI (Earth-centered inertial) frame of
reference from a set of Keplerian orbital elements. The exact ECI frame of the
resulting coordinates is the same used to define the supplied orbital elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KOEtoECI(a, e, i, M, omega, OMEGA, keplerAccuracy=10e-8, maxKeplerIterations=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KOEtoECI_+3A_a">a</code></td>
<td>
<p>Semi-major axis of orbital ellipse in meters. 
</p>
</td></tr>
<tr><td><code id="KOEtoECI_+3A_e">e</code></td>
<td>
<p>Numerical eccentricity of the orbit. Eccentricity measures how much
the orbit deviates from being circular.
</p>
</td></tr>
<tr><td><code id="KOEtoECI_+3A_i">i</code></td>
<td>
<p>Inclination of the orbital plane in radians. Inclination is the
angle between the orbital plane and the equator.
</p>
</td></tr>
<tr><td><code id="KOEtoECI_+3A_m">M</code></td>
<td>
<p>Mean anomaly of the orbit in radians. Mean anomaly indicates where
the satellite is along its orbital path, and is defined as the angle between
the direction of the perigee and the hypothetical point where the object would 
be if it was moving in a circular orbit with the same period as its true orbit 
after the same amount of time since it last crossed the perigee had ellapsed.
</p>
</td></tr>
<tr><td><code id="KOEtoECI_+3A_omega">omega</code></td>
<td>
<p>Argument of perigee in radians. This is the angle between the 
direction of the ascending node and the direction of the perigee (the point of 
the orbit at which the object is closest to the Earth).
</p>
</td></tr>
<tr><td><code id="KOEtoECI_+3A_omega">OMEGA</code></td>
<td>
<p>Right ascension of the ascending node in radians. This is the 
angle between the direction of the ascending node (the point where the 
satellite crosses the equatorial plane moving north) and the direction of the 
First Point of Aries (which indicates the location of the vernal equinox).
</p>
</td></tr>
<tr><td><code id="KOEtoECI_+3A_kepleraccuracy">keplerAccuracy</code></td>
<td>
<p>Accuracy to consider Kepler's equation solved when
calculating eccentric anomaly from mean anomaly. If two consecutive solutions 
differ by a value lower than this accuracy, integration is considered to have 
converged.
</p>
</td></tr>
<tr><td><code id="KOEtoECI_+3A_maxkepleriterations">maxKeplerIterations</code></td>
<td>
<p>Maximum number of iterations after which 
fixed-point integration of Kepler's equation will stop, even if convergence 
according to the accuracy criterion has not been reached.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements representing the position and velocity of the satellite
in the same ECI (Earth Centered, Earth Fixed) frame of reference into which
the provided orbital elements were defined. Position values are in m, and 
velocity values are in m/s. Each of the two elements contains three values,
corresponding to the X, Y and Z components of position and velocity in this 
order.
</p>


<h3>References</h3>

<p>https://www.gsc-europa.eu/system-service-status/orbital-and-technical-parameters
https://celestrak.org/columns/v02n01/
https://downloads.rene-schwarz.com/download/M001-Keplerian_Orbit_Elements_to_Cartesian_State_Vectors.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Let's calculate the ECI coordinates from the orbital elements provided by a
# TLE. It should be noted that this is often not recommended, since the orbital
# elements supplied in a TLE are not osculating orbital elements, but instead
# mean orbital elements set to fit a range of actual observations. The
# recommended procedures are to use TLE only in conjunction with the SGP4/SDP4
# models, and viceversa.
# The following orbital parameters correspond to an object with NORAD catalogue
# number 24208 (Italsat 2) the 26th of June, 2006 at 00:58:29.34 UTC.

n0 &lt;- 1.007781*((2*pi)/(86400))  # Multiplication by 2pi/86400 to convert to radians/s
e0 &lt;- 0.002664 # mean eccentricity at epoch
i0 &lt;- 3.8536*pi/180 # mean inclination at epoch in radians
M0 &lt;- 48.3*pi/180 # mean anomaly at epoch in radians
omega0 &lt;- 311.0977*pi/180 # mean argument of perigee at epoch in radians
OMEGA0 &lt;- 80.0121*pi/180 # mean longitude of ascending node at epoch in radians

# The semi-major axis can be calculated from the mean motion in radians/s 
# as follows: (mu is the standard gravitational parameter of Earth)

mu &lt;- 3.986004418e14 # in units of m3 s-2
a0 &lt;- (mu^(1/3))/(n0^(2/3))

# The ECI coordinates can then be calculated. In this case, they will be in TEME
# frame, since the original orbital elements are derived from a TLE
coordinates_ECI &lt;- KOEtoECI(a0, e0, i0, M0, omega0, OMEGA0)
</code></pre>

<hr>
<h2 id='LATLONtoGCRF'>Convert coordinates from geodetic latitude, longitude and altitude to GCRF
</h2><span id='topic+LATLONtoGCRF'></span>

<h3>Description</h3>

<p>The GCRF (Geocentric Celestial Reference Frame) frame of reference is an 
Earth-centered inertial coordinate frame, where the origin is also placed at the 
center of mass of Earth and the coordinate frame is fixed with respect to the 
stars (and therefore not fixed with respect to the Earth surface in its 
rotation). The X-axis is aligned with the mean equinox of Earth at 12:00
Terrestrial Time on the 1st of January, 2000, and the Z-axis is aligned with
the Earth¬¥s rotation axis. This function converts geodetic latitude, 
longitude and altitude to Cartesian coordinates in the GCRF frame. The WGS84
Earth ellipsoid model is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LATLONtoGCRF(position_LATLON, dateTime, degreesInput=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LATLONtoGCRF_+3A_position_latlon">position_LATLON</code></td>
<td>
<p>Vector with the latitude, longitude and altitude of the
object. Latitude and longitude can be provided in sexagesimal degrees or in 
radians (by default, sexagesimal degrees are asumed). Altitude must be 
provided in meters.
</p>
</td></tr>
<tr><td><code id="LATLONtoGCRF_+3A_datetime">dateTime</code></td>
<td>
<p>Date-time string with the date and time in UTC corresponding
to the provided geodetic coordinates.
</p>
</td></tr>
<tr><td><code id="LATLONtoGCRF_+3A_degreesinput">degreesInput</code></td>
<td>
<p>Logical indicating if the input latitude and longitude are
in sexagesimal degrees. If <code>degreesInput=FALSE</code>, the input will be
considered to be in radians. This specifies the time for which the conversion 
from geodetic coordinates to GCRF will be performed. It is important to 
provide an accurate value, since the point over the surface of Earth to which 
a set of GCRF coordinates corresponds varies with time due to the motion of 
Earth.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with three elements, corresponding to the  X, Y and Z components of 
position in meters in the ECEF frame, in this order.
</p>


<h3>References</h3>

<p>https://apps.dtic.mil/sti/pdfs/ADA280358.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
latitude &lt;- 37.3891
longitude &lt;- -5.9845
altitude &lt;- 20000

# Let¬¥s calculate the corresponding coordinates in GCRF frame, assuming that
# the provided coordinates were valid the 20th of October, 2020 at 15:00:00 UTC

coordinatesGCRF &lt;- LATLONtoGCRF(c(latitude, longitude, altitude), 
                                dateTime="2020-10-20 15:00:00")
}
</code></pre>

<hr>
<h2 id='LATLONtoITRF'>Convert coordinates from geodetic latitude, longitude and altitude to ITRF
</h2><span id='topic+LATLONtoITRF'></span>

<h3>Description</h3>

<p>The ITRF (International Terrestrial Reference Frame) is an ECEF (Earth Centered, 
Earth Fixed) frame of reference, i.e., a non-inertial frame of reference where 
the origin is placed at the center of mass of Earth, and the frame rotates 
with respect to the stars to remain fixed with respect to the Earth surface as 
it rotates. The Z-axis extends along the true North as defined by the IERS
reference pole, and the X-axis extends towards the intersection between the
equator and the Greenwich meridian at any time. This function converts geodetic 
latitude, longitude and altitude to Cartesian coordinates in the ITRF frame. The 
WGS84 Earth ellipsoid model is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LATLONtoITRF(position_LATLON, degreesInput=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LATLONtoITRF_+3A_position_latlon">position_LATLON</code></td>
<td>
<p>Vector with the latitude, longitude and altitude of the
object. Latitude and longitude can be provided in sexagesimal degrees or in 
radians (by default, sexagesimal degrees are asumed). Altitude must be 
provided in meters.
</p>
</td></tr>
<tr><td><code id="LATLONtoITRF_+3A_degreesinput">degreesInput</code></td>
<td>
<p>Logical indicating if the input latitude and longitude are
in sexagesimal degrees. If <code>degreesInput=FALSE</code>, the input will be
considered to be in radians.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with three elements, corresponding to the  X, Y and Z components of 
position in meters in the ITRF frame, in this order.
</p>


<h3>References</h3>

<p>https://apps.dtic.mil/sti/pdfs/ADA280358.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>latitude &lt;- 37.3891
longitude &lt;- -5.9845
altitude &lt;- 20000

# Let¬¥s calculate the corresponding coordinates in ECEF frame

coordinates_ITRF &lt;- LATLONtoITRF(c(latitude, longitude, altitude))
</code></pre>

<hr>
<h2 id='parseTLElines'>Parse the lines of a TLE
</h2><span id='topic+parseTLElines'></span>

<h3>Description</h3>

<p>TLE (Two-/Three- Line Element) is the standard format for representing orbital
state vectors. This function parses a character vector where each element
represents a line of the TLE. The supplied character vector can have either 2
(for Two Line Elements) or 3 (for Three Line Elements) elements. The two lines
of a Two Line Element contain all the information. The additional line in a
Three Line Element is optional, and contains just the satellite name. For a
detailed description of the TLE format, see https://celestrak.org/columns/v04n03/#FAQ01.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parseTLElines(lines)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parseTLElines_+3A_lines">lines</code></td>
<td>
<p>Character vector where each element is a string corresponding to
a line of the TLE. The character vector must have either 2 or 3 elements.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements that define the orbital state vector of the
satellite:
</p>
<table>
<tr><td><code>NORADcatalogNumber</code></td>
<td>
<p>NORAD Catalog Number, also known as Satellite
Catalog Number, assigned by United States Space Command to each artificial
object orbiting Earth</p>
</td></tr>
<tr><td><code>classificationLevel</code></td>
<td>
<p>Classification level of the information for the
orbiting object. Can be unclassified, classified, secret or unknown</p>
</td></tr>
<tr><td><code>internationalDesignator</code></td>
<td>
<p>International Designator, also known as COSPAR
ID, of the object. It consists of the launch year, separated by a hyphen from
a three-digit number indicating the launch number for that year and a set of
one to three letters indicating the piece for a launch with multiple pieces.</p>
</td></tr>
<tr><td><code>launchYear</code></td>
<td>
<p>The launch year of the object</p>
</td></tr>
<tr><td><code>launchNumber</code></td>
<td>
<p>The launch number of the object during its launch year</p>
</td></tr>
<tr><td><code>launchPiece</code></td>
<td>
<p>The piece for the launch of the object, if it was a launch
with multiple pieces</p>
</td></tr>
<tr><td><code>dateTime</code></td>
<td>
<p>Date time string to which the orbital state vector
corresponds</p>
</td></tr>
<tr><td><code>elementNumber</code></td>
<td>
<p>Element number for the object. In principle, every time
a new TLE is generated for an object, the element number is incremented, and
therefore element numbers could be used to assess if all the TLEs for a
certain object are available. However, in practice it is observed that this is
not always the case, with some numbers skipped and some numbers repeated.</p>
</td></tr>
<tr><td><code>inclination</code></td>
<td>
<p>Mean orbital inclination of the satellite in degrees.
This is the angle between the orbital plane of the satellite and the
equatorial plane</p>
</td></tr>
<tr><td><code>ascension</code></td>
<td>
<p>Mean longitude of the ascending node of the satellite at
epoch, also known as right ascension of the ascending node, in degrees. This
is the angle between the direction of the ascending node (the point where the
satellite crosses the equatorial plane moving north) and the direction
of the First Point of Aries (which indicates the location of the vernal
equinox)</p>
</td></tr>
<tr><td><code>eccentricity</code></td>
<td>
<p>Mean eccentricity of the orbit of the object.
Eccentricity is a measurement of how much the orbit deviates from a circular
shape, with 0 indicating a perfectly circular orbit and 1 indicating an
extreme case of parabolic trajectory</p>
</td></tr>
<tr><td><code>perigeeArgument</code></td>
<td>
<p>Mean argument of the perigee of the object in degrees.
This is the angle between the direction of the ascending node and the
direction of the perigee (the point of the orbit at which the object is
closest to the Earth)</p>
</td></tr>
<tr><td><code>meanAnomaly</code></td>
<td>
<p>Mean anomaly of the orbit of the object in degrees. This
indicates where the satellite is along its orbital path. It is provided as
the angle between the direction of the perigee and the hypothetical point
where the object would be if it was moving in a circular orbit with the same
period as its true orbit after the same amount of time since it last crossed
the perigee had ellapsed. Therefore, 0 denotes that the object is at the
perigee</p>
</td></tr>
<tr><td><code>meanMotion</code></td>
<td>
<p>Mean motion of the satellite at epoch in revolutions/day
</p>
</td></tr>
<tr><td><code>meanMotionDerivative</code></td>
<td>
<p>First time derivative of the mean motion of the
satellite in revolutions/day^2^</p>
</td></tr>
<tr><td><code>meanMotionSecondDerivative</code></td>
<td>
<p>Second time derivative of the mean motion of
the satellite in revolutions/day^3^.
</p>
</td></tr>
<tr><td><code>Bstar</code></td>
<td>
<p>Drag coefficient of the satellite in units of (earth radii)^-1^.
Bstar is an adjusted value of the ballistic coefficient of the satellite, and
it indicates how susceptible it is to atmospheric drag.
</p>
</td></tr>
<tr><td><code>ephemerisType</code></td>
<td>
<p>Source for the ephemeris (orbital state vector). Most
commonly, it is distributed data obtained by combaining multiple observations
with the SGP4/SDP4 models
</p>
</td></tr>
<tr><td><code>epochRevolutionNumber</code></td>
<td>
<p>Number of full orbital revolutions completed by
the object
</p>
</td></tr>
<tr><td><code>objectName</code></td>
<td>
<p>Name of the object, retrieved from the first line of the
TLE if a Three Line Element was provided
</p>
</td></tr>
</table>


<h3>References</h3>

<p>https://celestrak.org/columns/v04n03/#FAQ01
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The following lines correspond to a TLE for Italsat 2 the 26th of June, 2006
# at 00:58:29.34 UTC.

italsat2_lines &lt;- c("ITALSAT 2",
"1 24208U 96044A   06177.04061740 -.00000094  00000-0  10000-3 0  1600",
"2 24208   3.8536  80.0121 0026640 311.0977  48.3000  1.00778054 36119")

italsat2_TLE &lt;- parseTLElines(italsat2_lines)
italsat2_TLE
</code></pre>

<hr>
<h2 id='rad2deg'>Converts an angle in radians to degrees
</h2><span id='topic+rad2deg'></span>

<h3>Description</h3>

<p>This function converts an angle in radians to degrees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rad2deg(radians)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rad2deg_+3A_radians">radians</code></td>
<td>
<p>Value of the angle in radians.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The corresponding value of the angle in degrees.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rad2deg(pi)
</code></pre>

<hr>
<h2 id='readGLONASSNavigationRINEX'>Read a RINEX navigation file for GLONASS satellites
</h2><span id='topic+readGLONASSNavigationRINEX'></span>

<h3>Description</h3>

<p>RINEX (Receiver Independent Exchange Format) is one of the most widely used
formats for providing data of satellite navigation systems. The RINEX standard
defines several structured text file types, among which navigation files are used 
to distribute positional information of the satellites. The exact information 
provided in a RINEX navigation file varies for each satellite navigation system. 
This function reads RINEX navigation files for satellites of the GLONASS 
constellation, operated by Russia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readGLONASSNavigationRINEX(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readGLONASSNavigationRINEX_+3A_filename">filename</code></td>
<td>
<p>Path to the GLONASS RINEX navigation file.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements. The first element, named <code>header</code>, is a list with
the following elements:
</p>
<table>
<tr><td><code>rinexVersion</code></td>
<td>
<p>Version of the RINEX format used in the file</p>
</td></tr>
<tr><td><code>rinexFileType</code></td>
<td>
<p>Type of RINEX file</p>
</td></tr>
<tr><td><code>generatorProgram</code></td>
<td>
<p>Program used to generate the RINEX file</p>
</td></tr>
<tr><td><code>generatorEntity</code></td>
<td>
<p>Individual or organization that generated the file</p>
</td></tr>
<tr><td><code>fileCreationDateString</code></td>
<td>
<p>Date-time string indicating when the file was
created</p>
</td></tr>
<tr><td><code>refYear</code></td>
<td>
<p>Reference year for system time correction</p>
</td></tr>
<tr><td><code>refMonth</code></td>
<td>
<p>Reference month for system time correction</p>
</td></tr>
<tr><td><code>refDay</code></td>
<td>
<p>Reference day for system time correction</p>
</td></tr>
<tr><td><code>sysTimeCorrection</code></td>
<td>
<p>Correction to system time scale to fine-tune GLONASS
time to UTC in seconds. Since GLONASS time is linked to UTC, it should be a
very small amount</p>
</td></tr>
<tr><td><code>leapSeconds</code></td>
<td>
<p>Leap seconds introduced since 1980. Useful to convert to
GPS time</p>
</td></tr>
<tr><td><code>comments</code></td>
<td>
<p>Miscellaneous comments found in the header of the RINEX file</p>
</td></tr>
</table>
<p>The second element is named <code>messages</code>, and it contains one element for
each navigation message found in the RINEX file. Each of these elements is a 
list with the following elements that provide information about the position
of the GLONASS satellite:
</p>
<table>
<tr><td><code>satelliteNumber</code></td>
<td>
<p>Slot number of the satellite within the GLONASS
constellation. It can be converted to a PRN code by adding 37 to it</p>
</td></tr>
<tr><td><code>epochYearShort</code></td>
<td>
<p>Epoch year in 2-digit format. If lower than 80, the
meaning should be taken as 20XX, while if larger than 80, it refers to 19XX.</p>
</td></tr>
<tr><td><code>epochMonth</code></td>
<td>
<p>Epoch month</p>
</td></tr>
<tr><td><code>epochDay</code></td>
<td>
<p>Epoch day</p>
</td></tr>
<tr><td><code>epochHour</code></td>
<td>
<p>Epoch hour</p>
</td></tr>
<tr><td><code>epochMinute</code></td>
<td>
<p>Epoch minute</p>
</td></tr>
<tr><td><code>epochSecond</code></td>
<td>
<p>Epoch second</p>
</td></tr>
<tr><td><code>ephemerisUTCTime</code></td>
<td>
<p>A nanotime object indicating the time
corresponding to the reported position (ephemeris) in the present message. 
The time is in UTC, obtained by applying the individual clock bias of the 
particular satellite (<code>clockBias</code> field of each message) and the latest 
global GLONASS time bias with respect to UTC (<code>sysTimeCorrection</code> field
of the header) to the uncorrected ephemeris time, given by the previous
time fields. Corrections are performed as described in the GLONASS system
specifications (https://russianspacesystems.ru/wp-content/uploads/2016/08/ICD_GLONASS_eng_v5.1.pdf)</p>
</td></tr>
<tr><td><code>clockBias</code></td>
<td>
<p>Clock bias (i.e., constant offset) that should be applied to
the satellite time in order to obtain an even more accurate UTC time. In 
seconds</p>
</td></tr>
<tr><td><code>relativeFreqBias</code></td>
<td>
<p>Clock drift of the satellite clock that should be
applied in combination with the time difference to the reference time in order
to obtain an even more accurate UTC time. In seconds per second</p>
</td></tr>
<tr><td><code>messageFrameTime</code></td>
<td>
<p>Second of the UTC day when the message was 
transmitted</p>
</td></tr>
<tr><td><code>positionX</code></td>
<td>
<p>X coordinate of the position of the satellite in km, in the
ITRF system of coordinates</p>
</td></tr>
<tr><td><code>positionY</code></td>
<td>
<p>Y coordinate of the position of the satellite in km, in the
ITRF system of coordinates</p>
</td></tr>
<tr><td><code>positionZ</code></td>
<td>
<p>Z coordinate of the position of the satellite in km, in the
ITRF system of coordinates</p>
</td></tr>
<tr><td><code>velocityX</code></td>
<td>
<p>X component of the velocity of the satellite in km/s, in the
ITRF system of coordinates</p>
</td></tr>
<tr><td><code>velocityY</code></td>
<td>
<p>Y component of the velocity of the satellite in km/s, in the
ITRF system of coordinates</p>
</td></tr>
<tr><td><code>velocityZ</code></td>
<td>
<p>Z component of the velocity of the satellite in km/s, in the
ITRF system of coordinates</p>
</td></tr>
<tr><td><code>accelX</code></td>
<td>
<p>X component of the accel of the satellite in km/s, in the
ITRF system of coordinates</p>
</td></tr>
<tr><td><code>accelY</code></td>
<td>
<p>Y component of the accel of the satellite in km/s, in the
ITRF system of coordinates</p>
</td></tr>
<tr><td><code>accelZ</code></td>
<td>
<p>Z component of the accel of the satellite in km/s, in the
ITRF system of coordinates</p>
</td></tr>
<tr><td><code>satelliteHealthCode</code></td>
<td>
<p>Code indicating the health of the satellite. 0 if
healthy</p>
</td></tr>
<tr><td><code>freqNumber</code></td>
<td>
<p>Frequency number (k) of the GLONASS satellite. The two 
frequencies in MHz, f1 and f2, used by the satellite to transmit data can be 
calculated as follows: f1 = 1602 + k*9/16 and f2 = 1246 + k*7/16</p>
</td></tr>
<tr><td><code>informationAge</code></td>
<td>
<p>Age in days of the observation data used to generate
the provided ephemeris</p>
</td></tr>
</table>


<h3>References</h3>

<p>https://gage.upc.edu/gFD/
https://www.navcen.uscg.gov/pubs/gps/rinex/rinex.txt
ftp://www.ngs.noaa.gov/cors/RINEX211.txt
http://acc.igs.org/misc/rinex304.pdf
https://russianspacesystems.ru/wp-content/uploads/2016/08/ICD_GLONASS_eng_v5.1.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The file testGLONASSRINEX.txt provided with the package includes 5 navigation
# messages from 4 GLONASS satellites

testGLONASSnav &lt;- readGLONASSNavigationRINEX(paste0(path.package("asteRisk"), 
"/testGLONASSRINEX.txt"))
testGLONASSnav$header
testGLONASSnav$messages
</code></pre>

<hr>
<h2 id='readGPSNavigationRINEX'>Read a RINEX navigation file for GPS satellites
</h2><span id='topic+readGPSNavigationRINEX'></span>

<h3>Description</h3>

<p>RINEX (Receiver Independent Exchange Format) is one of the most widely used
formats for providing data of satellite navigation systems. The RINEX standard
defines several structured text file types file types, among which navigation 
files are used to distribute positional information of the satellites. The exact 
information provided in a RINEX navigation file varies for each satellite navigation 
system. This function reads RINEX navigation files for satellites of the GPS 
constellation, operated by the USA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readGPSNavigationRINEX(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readGPSNavigationRINEX_+3A_filename">filename</code></td>
<td>
<p>Path to the GPS RINEX navigation file.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements. The first element, named <code>header</code>, is a list with
the following elements:
</p>
<table>
<tr><td><code>rinexVersion</code></td>
<td>
<p>Version of the RINEX format used in the file</p>
</td></tr>
<tr><td><code>rinexFileType</code></td>
<td>
<p>Type of RINEX file</p>
</td></tr>
<tr><td><code>generatorProgram</code></td>
<td>
<p>Program used to generate the RINEX file</p>
</td></tr>
<tr><td><code>generatorEntity</code></td>
<td>
<p>Individual or organization that generated the file</p>
</td></tr>
<tr><td><code>fileCreationDateString</code></td>
<td>
<p>Date-time string indicating when the file was
created</p>
</td></tr>
<tr><td><code>ionAlphaA0</code></td>
<td>
<p>Coefficient for ionospheric correction A0</p>
</td></tr>
<tr><td><code>ionAlphaA1</code></td>
<td>
<p>Coefficient for ionospheric correction A1</p>
</td></tr>
<tr><td><code>ionAlphaA2</code></td>
<td>
<p>Coefficient for ionospheric correction A2</p>
</td></tr>
<tr><td><code>ionAlphaA3</code></td>
<td>
<p>Coefficient for ionospheric correction A3</p>
</td></tr>
<tr><td><code>ionBetaB0</code></td>
<td>
<p>Coefficient for ionospheric correction B0</p>
</td></tr>
<tr><td><code>ionBetaB1</code></td>
<td>
<p>Coefficient for ionospheric correction B1</p>
</td></tr>
<tr><td><code>ionBetaB2</code></td>
<td>
<p>Coefficient for ionospheric correction B2</p>
</td></tr>
<tr><td><code>ionBetaB3</code></td>
<td>
<p>Coefficient for ionospheric correction B3</p>
</td></tr>
<tr><td><code>deltaUTCA0</code></td>
<td>
<p>A0 parameter, corresponding to bias between GPST and UTC
time at the reference time (Tot) given by fields <code>referenceTimeUTC</code> and
<code>referenceWeekUTC</code>. Should be used to compute accurate time in UTC</p>
</td></tr>
<tr><td><code>deltaUTCA1</code></td>
<td>
<p>A1 parameter, corresponding to the clock drift between
GPST and UTC at the reference time (Tot) given by fields <code>referenceTimeUTC</code> 
and <code>referenceWeekUTC</code>. Should be used to compute accurate time in UTC</p>
</td></tr>
<tr><td><code>referenceTimeUTC</code></td>
<td>
<p>Time in seconds of current UTC week of Tot, which is
the reference time to correct GPST time to UTC</p>
</td></tr>
<tr><td><code>referenceWeekUTC</code></td>
<td>
<p>UTC reference week number (continuous scale, not
modulo 1024) of Tot.</p>
</td></tr>
<tr><td><code>leapSeconds</code></td>
<td>
<p>Leap seconds introduced since the 6th of January, 1980. 
Useful to convert to UTC time (UTC time = GPS time - leap seconds)</p>
</td></tr>
<tr><td><code>comments</code></td>
<td>
<p>Miscellaneous comments found in the header of the RINEX file</p>
</td></tr>
</table>
<p>The second element is named <code>messages</code>, and it contains one element for
each navigation message found in the RINEX file. Each of these elements is a 
list with the following elements that provide information about the position
of the GPS satellite:
</p>
<table>
<tr><td><code>satellitePRNCode</code></td>
<td>
<p>PRN code of the satellite. Unique PRN codes are
assigned to all satellites in global navigation satellite systems, and 
therefore provide an identifier for each of them</p>
</td></tr>
<tr><td><code>tocYearShort</code></td>
<td>
<p>Toc year in 2-digit format. If lower than 80, the meaning 
should be taken as 20XX, while if larger than 80, it refers to 19XX. Toc is
the GPS time of the specific satellite that should be used as the time 
reference to apply clock bias, clock drift and possibly even clock drift rate,
as well as a relativistic correction, as described in the GPS system 
specification (https://www.gps.gov/technical/icwg/IS-GPS-200H.pdf) to obtain 
the corrected GPST system time. The GPST system time can be converted to UTC 
time by subtracting leap seconds since the 6th of January 1980 and performing
another polynomial correction to account for bias and drift between GPST and
UTC times.</p>
</td></tr>
<tr><td><code>tocMonth</code></td>
<td>
<p>Toc month</p>
</td></tr>
<tr><td><code>tocDay</code></td>
<td>
<p>Toc day</p>
</td></tr>
<tr><td><code>tocHour</code></td>
<td>
<p>Toc hour</p>
</td></tr>
<tr><td><code>tocMinute</code></td>
<td>
<p>Toc minute</p>
</td></tr>
<tr><td><code>tocSecond</code></td>
<td>
<p>Toc second</p>
</td></tr>
<tr><td><code>UTCepochDateTime</code></td>
<td>
<p>Date-time string indicating the time corresponding
to the reported position in the present message. The time is in UTC, obtained
by subtracting the leap seconds (if available in the header) from the time
of the satellite system (which is in GPS time). If leap seconds are not
provided in the header, the time will be in GPS. For an even more 
accurate conversion to actual UTC time, the clock bias, clock drift and 
possibly even clock drift rate (described in the next three elements) must be 
considered</p>
</td></tr>
<tr><td><code>clockBias</code></td>
<td>
<p>Clock bias (i.e., constant offset) at Toc that should be 
applied to the satellite time in order to calculate accurate GPST. In seconds.
Often referred to as af0.</p>
</td></tr>
<tr><td><code>clockDrift</code></td>
<td>
<p>Clock drift of the satellite clock at Toc that should be 
applied to the satellite time in order to calculate accurate GPST. In seconds.
Often referred to as af1.</p>
</td></tr>
<tr><td><code>clockDriftRate</code></td>
<td>
<p>Rate of change for the clock drift of the satellite 
clock at Toc. It is frequently 0, but if not, it should be applied in 
combination with clock bias and clock drift in order to correct to GPST as
accurately as possible. In seconds per square second. Often referred to as af2.</p>
</td></tr>  
<tr><td><code>IODE</code></td>
<td>
<p>Issue-of-data ephemeris. It acts as a time-stamp or unique 
identifier for the provided navigation data. In particular, the IODE of a 
given navigation message should never be the same as the IODE for any other
navigation message broadcasted by the same satellite in the past 6 days,
although violations of this rule have been observed. Most frequently, IODE
are not reused in a period of 7 days, so that they match exactly the IODC.</p>
</td></tr>
<tr><td><code>radiusCorrectionSine</code></td>
<td>
<p>Amplitude of the sine harmonic component for the 
correction of orbital radius. In meters</p>
</td></tr>
<tr><td><code>deltaN</code></td>
<td>
<p>Mean motion difference from computed value. In radians per
second. In order to obtain the real (perturbed) mean motion, first the 
Keplerian mean motion should be calculated from the semi-major axis. Then, 
deltaN should be added to it.</p>
</td></tr>
<tr><td><code>correctedMeanMotion</code></td>
<td>
<p>Corrected mean motion calculated by adding deltaN
to the value computed from the semi-major axis. In radians per second</p>
</td></tr>
<tr><td><code>meanAnomaly</code></td>
<td>
<p>Mean anomaly of the satellite at epoch. In radians. This 
indicates where the satellite is along its orbital path. It is provided as the 
angle between the direction of the perigee and the hypothetical point where 
the object would be if it was moving in a circular orbit with the same period 
as its true orbit after the same amount of time since it last crossed the 
perigee had ellapsed. Therefore, 0 denotes that the object is at the perigee. 
This is a Keplerian orbital element.</p>
</td></tr>
<tr><td><code>latitudeCorrectionCosine</code></td>
<td>
<p>Amplitude of the cosine harmonic component
for the correction of latitude argument. In radians</p>
</td></tr>
<tr><td><code>eccentricity</code></td>
<td>
<p>Eccentricity of the orbit of the satellite at epoch. This
is a Keplerian orbital element.</p>
</td></tr>
<tr><td><code>latitudeCorrectionSine</code></td>
<td>
<p>Amplitude of the sine harmonic component for 
the correction of latitude argument. In radians</p>
</td></tr>
<tr><td><code>semiMajorAxis</code></td>
<td>
<p>Semi-major axis of the orbit of the satellite at epoch.
In meters. This is a Keplerian orbital element</p>
</td></tr>
<tr><td><code>toeSecondsOfGPSWeek</code></td>
<td>
<p>Time of the GPS week (in seconds) for the ephemeris.
Together with the <code>toeGPSWeek</code>, it can be used to calculate the ephemeris
time in GPS time of the specific satellite, to which sequential corrections
first to GPST and then to UTC should be applied.</p>
</td></tr>
<tr><td><code>inclinationCorrectionCosine</code></td>
<td>
<p>Amplitude of the cosine harmonic component
for the correction of inclination. In radians</p>
</td></tr>
<tr><td><code>ascension</code></td>
<td>
<p>Longitude of the ascending node of the satellite at epoch, 
also known as right ascension of the ascending node, in radians. This is the 
angle between the direction of the ascending node (the point where the 
satellite crosses the equatorial plane moving north) and the direction of the 
First Point of Aries (which indicates the location of the vernal equinox).
This is a Keplerian orbital element.</p>
</td></tr>
<tr><td><code>inclinationCorrectionSine</code></td>
<td>
<p>Amplitude of the sine harmonic component
for the correction of inclination. In radians</p>
</td></tr>
<tr><td><code>inclination</code></td>
<td>
<p>Mean orbital inclination of the satellite in radians. This
is the angle between the orbital plane of the satellite and the equatorial 
plane. This is a Keplerian orbital element.</p>
</td></tr>
<tr><td><code>radiusCorrectionCosine</code></td>
<td>
<p>Amplitude of the cosine harmonic component for 
the correction of orbital radius. In meters.</p>
</td></tr>
<tr><td><code>perigeeArgument</code></td>
<td>
<p>Mean argument of the perigee of the object in radians. 
This is the angle between the direction of the ascending node and the 
direction of the perigee (the point of the orbit at which the object is 
closest to the Earth). This is a Keplerian orbital element.</p>
</td></tr>
<tr><td><code>OMEGADot</code></td>
<td>
<p>Angular velocity of the satellite with respect to the vernal
equinox. In radians/second.</p>
</td></tr>
<tr><td><code>codesL2Channel</code></td>
<td>
<p>Flag indicating if coarse/acquisition (C/A) code is
being transmitted on the L2 channel (value of 1) or not (value of 0)</p>
</td></tr>
<tr><td><code>toeGPSWeek</code></td>
<td>
<p>GPS week number at epoch</p>
</td></tr>
<tr><td><code>dataFlagL2P</code></td>
<td>
<p>Flag indicating if precise (P) code is being transmitted 
on the L2 channel (value of 1) or not (value of 0)</p>
</td></tr>
<tr><td><code>satelliteAccuracy</code></td>
<td>
<p>Accuracy of the position of the satellite, in 
meters.</p>
</td></tr>
<tr><td><code>satelliteHealthCode</code></td>
<td>
<p>Code indicating the health of the satellite. 0 if
healthy.</p>
</td></tr>
<tr><td><code>totalGroupDelay</code></td>
<td>
<p>Bias difference between codes broadcasted on L1 and
the ionospheric-free combination of the codes broadcasted at L1 and L2, in
seconds. This parameter, also known as timing group delay (TGD), should be 
considered when calculating satellite clock error.</p>
</td></tr>
<tr><td><code>IODC</code></td>
<td>
<p>Issue-of-data clock. It acts as a time-stamp or unique identifier 
for the provided navigation data. In particular, the IODC of a given 
navigation message should never be the same as the IODC for any other
navigation message broadcasted by the same satellite in the past 7 days,
although violations of this rule have been observed. Most frequently, IODE
are not reused in a period of 7 days instead of the mandatory 6 days, so that 
they match exactly the IODC.</p>
</td></tr>
<tr><td><code>transmissionTime</code></td>
<td>
<p>Transmission time for the navigation message, in
seconds of GPS week.</p>
</td></tr>
<tr><td><code>fitInterval</code></td>
<td>
<p>Flag indicating for how long the broadcasted ephemeris are
valid since the last time the data was updated. It should be noted that in
order to obtain positional values/orbital elements at times other than epoch,
the corrections for perturbed orbital elements should be applied and 
propagated. If 0, the ephemeris data are valid for up to 4 hours. If 1, they
are valid for more than 4 hours.</p>
</td></tr>
<tr><td><code>ephemerisUTCTime</code></td>
<td>
<p>A nanotime object indicating the time
corresponding to the reported position (ephemeris) in the present message. 
The time is in UTC, obtained by first applying the individual clock bias, clock 
drift and clock drift rate of the particular satellite (fields <code>clockBias</code>,
<code>clockDrift</code> and <code>clockDriftRate</code> of each message) and a relativistic
correction to obtain corrected GPST time (system-wide GPS time), and then
subtraction of leap seconds since the 6th of January 1980 and a second polynomial
correction (with fields <code>deltaUTCA0</code> and <code>deltaUTCA1</code> from the 
header) to obtain UTC time. Corrections are performed as described in the GPS
system specifications (https://www.gps.gov/technical/icwg/IS-GPS-200H.pdf).</p>
</td></tr>
<tr><td><code>position_ITRF</code></td>
<td>
<p>Position of the satellite in the ITRF frame, calculated
from the provided orbital ephemeris following the procedure described in the
GPS system specifications. In meters.</p>
</td></tr>
<tr><td><code>velocity_ITRF</code></td>
<td>
<p>Velocity of the satellite in the ITRF frame, calculated
from the provided orbital ephemeris following the procedure described in the
GPS system specifications. In meters/second.</p>
</td></tr>
<tr><td><code>acceleration_ITRF</code></td>
<td>
<p>Acceleration of the satellite in the ITRF frame, calculated
from the provided orbital ephemeris following the procedure described in the
GPS system specifications. In meters/squared second.</p>
</td></tr>
</table>


<h3>References</h3>

<p>https://gage.upc.edu/gFD/
https://www.navcen.uscg.gov/pubs/gps/rinex/rinex.txt
ftp://www.ngs.noaa.gov/cors/RINEX211.txt
http://acc.igs.org/misc/rinex304.pdf
https://www.icao.int/Meetings/AMC/MA/2004/GNSS/icd.pdf
https://www.gps.gov/technical/icwg/IS-GPS-200H.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The file testGPSRINEX.txt provided with the package includes 3 navigation
# messages from 3 GPS satellites

testGPSnav &lt;- readGPSNavigationRINEX(paste0(path.package("asteRisk"), 
"/testGPSRINEX.txt"))
testGPSnav$header
testGPSnav$messages
</code></pre>

<hr>
<h2 id='readOEM'>Read an Orbital Ephemeris Message file
</h2><span id='topic+readOEM'></span>

<h3>Description</h3>

<p>OEM (Orbital Ephemeris Message) is one of the three standard file formats defined
by the CCSDS for transferring spacecraft orbit information. OEM files contain
the position and velocity of a given object at multiple times (epochs). They can
also contain optionally acceleration values, covariance matrixes that indicate
the uncertainty of the provided state vectors and other additional information.
This function reads OEM files, retrieving also the optional fields.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readOEM(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readOEM_+3A_filename">filename</code></td>
<td>
<p>Path to the OEM file.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements. The first element, named <code>header</code>, is a list with
the following elements:
</p>
<table>
<tr><td><code>OMVersion</code></td>
<td>
<p>Version of the OEM format used in the file</p>
</td></tr>
<tr><td><code>creationDate</code></td>
<td>
<p>Date of creation of the file</p>
</td></tr>
<tr><td><code>creator</code></td>
<td>
<p>Individual or organization that generated the file</p>
</td></tr>
</table>
<p>The second element is named <code>dataBlocks</code>, and it contains one element for
each ephemeris data block found in the OEM file. Each of these elements is a 
list with the following elements that provide information about the ephemerides
of object (note that some elements are not mandatory and therefore might not be
present in all OEM files; in these cases, their value is set to NULL):
</p>
<table>
<tr><td><code>objectName</code></td>
<td>
<p>Name of the object</p>
</td></tr>
<tr><td><code>objectID</code></td>
<td>
<p>Object identifier for the object. Frequently, although not
always, the identifier has the format YYYY-NNNPPP, where YYYY is the year
of launch, NNN is the three-digit serial number specifying the launch number
during year YYYY and PPP is a part specifier comprising 1 to 3 capital letters
that indicate the part of the object put into space during the launch.</p>
</td></tr>
<tr><td><code>referenceFrame</code></td>
<td>
<p>Frame of reference in which ephemerides are provided.</p>
</td></tr>
<tr><td><code>refFrameEpoch</code></td>
<td>
<p>Epoch for the frame of reference, for cases where it is
not intrinsic to the frame itself, such as TEME.</p>
</td></tr>
<tr><td><code>centerName</code></td>
<td>
<p>Name of the center of coordinates. For example, a celestial
body, the barycenter of the entire Solar System or even other spacecraft.</p>
</td></tr>
<tr><td><code>timeSystem</code></td>
<td>
<p>Time system used for the ephemerides, covariance matrixes
and all other time fields of the data block.</p>
</td></tr>
<tr><td><code>startTime</code></td>
<td>
<p>Start time of the time span covered by the ephemerides and
covariance matrixes in this data block.</p>
</td></tr>
<tr><td><code>endTime</code></td>
<td>
<p>End time of the time span covered by the ephemerides and
covariance matrixes in this data block.</p>
</td></tr>
<tr><td><code>usableStartTime</code></td>
<td>
<p>Start time of the usable time span covered by the 
ephemerides and covariance matrixes in this data block.</p>
</td></tr>
<tr><td><code>usableEndTime</code></td>
<td>
<p>End time of the usable time span covered by the 
ephemerides and covariance matrixes in this data block.</p>
</td></tr>
<tr><td><code>interpolationMethod</code></td>
<td>
<p>Recommended interpolation method to calculate
ephemerides at epochs between those directly given in the data block.</p>
</td></tr>
<tr><td><code>interpolationOrder</code></td>
<td>
<p>Recommended interpolation degree to calculate
ephemerides at epochs between those directly given in the data block.</p>
</td></tr>
<tr><td><code>mass</code></td>
<td>
<p>Mass in kg of the object.</p>
</td></tr>
<tr><td><code>dragArea</code></td>
<td>
<p>Effective area of the object subjected to drag, in square
meters.</p>
</td></tr>
<tr><td><code>dragCoefficient</code></td>
<td>
<p>Drag coefficient of the object.</p>
</td></tr>
<tr><td><code>solarRadArea</code></td>
<td>
<p>Effective area of the object subjected to solar radiation
pressure, in square meters.</p>
</td></tr>
<tr><td><code>solarRadCoefficient</code></td>
<td>
<p>Solar radiation pressure coefficient of the object.</p>
</td></tr>
<tr><td><code>ephemerides</code></td>
<td>
<p>Data frame with the 7 or 10 columns providing the ephemerides
for the object. The 1st column provides the epochs for each ephemeris; columns
2 to 4 provide the X, Y and Z components of position (in km), and columns 5 to
7 provide the X, Y and Z components of velocity (in km/s). Columns 8 to 10 are
optional, and if present provide the X, Y and Z components of acceleration (in
km/s2)</p>
</td></tr>
<tr><td><code>covarianceMatrixes</code></td>
<td>
<p>List where each element is a 3-element list that
provides a covariance matrix for this data block. Each of the 3-element lists
corresponding to a covariance matrix contains the following elements:
</p>

<ul>
<li><p>epoch Epoch of the navigation solution related to this covariance
matrix.
</p>
</li>
<li><p>referenceFrame Reference frame for the covariance matrix. Frequently
this is the same as for the ephemerides. In order to facilitate interpretation
of the covariance matrix, conversion to a perifocal frame of reference might
be advisable.
</p>
</li>
<li><p>covarianceMatrix Covariance matrix that provides information about
the uncertainties of position and velocities. This is a symmetric 6x6 matrix
where the values in the diagonal are the squared standard deviations of each 
variable, and the other values are covariances between 2 variables (those 
corresponding to the row and column of each value). The rows and columns
correspond to the following variables, in the specified order: X position,
Y position, Z position, X velocity, Y velocity and Z velocity.
</p>
</li></ul>
</td></tr>
</table>


<h3>References</h3>

<p>https://public.ccsds.org/Pubs/502x0b2c1e2.pdf
https://spotthestation.nasa.gov/trajectory_data.cfm
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The file testOEM.txt provided with the package includes ephemerides data
# for the ISS publicly available

testOEM_ISS &lt;- readOEM(paste0(path.package("asteRisk"), "/testOEM.txt"))
testOEM_ISS$header
testOEM_ISS$dataBlocks[[1]]$objectName
head(testOEM_ISS$dataBlocks[[1]]$ephemerides)
</code></pre>

<hr>
<h2 id='readTLE'>Read a TLE file
</h2><span id='topic+readTLE'></span>

<h3>Description</h3>

<p>TLE (Two-/Three- Line Element) is a standard structured text file format for 
representing orbital state vectors. This function reads a TLE file containing 
one or more TLEs. The TLE file can contain either Two Line Elements or Three Line 
Elements, but all the TLE in a single file must be of the same type. The two 
lines of a Two Line Element contain all the ephemeris information. The additional 
line in a Three Line Element is optional, and contains just the satellite name. 
For a detailed description of the TLE format, see https://celestrak.com/columns/v04n03/#FAQ01.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readTLE(filename, maxTLEs=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readTLE_+3A_filename">filename</code></td>
<td>
<p>Path to the TLE file. Alternatively, an URL pointing to a 
TLE file.
</p>
</td></tr>
<tr><td><code id="readTLE_+3A_maxtles">maxTLEs</code></td>
<td>
<p>Maximum number of TLEs to read, starting from the beginning of
the file. By default, all TLEs present in the file are read.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements that define the orbital state vector of the
satellite (or, if the file contained multiple TLE, a nested list, where each
element of the top level list represents an orbital state vector, and comprises
the following elements):
</p>
<table>
<tr><td><code>NORADcatalogNumber</code></td>
<td>
<p>NORAD Catalog Number, also known as Satellite
Catalog Number, assigned by United States Space Command to each artificial
object orbiting Earth</p>
</td></tr>
<tr><td><code>classificationLevel</code></td>
<td>
<p>Classification level of the information for the
orbiting object. Can be unclassified, classified, secret or unknown</p>
</td></tr>
<tr><td><code>internationalDesignator</code></td>
<td>
<p>International Designator, also known as COSPAR
ID, of the object. It consists of the launch year, separated by a hyphen from
a three-digit number indicating the launch number for that year and a set of
one to three letters indicating the piece for a launch with multiple pieces.</p>
</td></tr>
<tr><td><code>launchYear</code></td>
<td>
<p>The launch year of the object</p>
</td></tr>
<tr><td><code>launchNumber</code></td>
<td>
<p>The launch number of the object during its launch year</p>
</td></tr>
<tr><td><code>launchPiece</code></td>
<td>
<p>The piece for the launch of the object, if it was a launch
with multiple pieces</p>
</td></tr>
<tr><td><code>dateTime</code></td>
<td>
<p>Date time string to which the orbital state vector
corresponds</p>
</td></tr>
<tr><td><code>elementNumber</code></td>
<td>
<p>Element number for the object. In principle, every time
a new TLE is generated for an object, the element number is incremented, and
therefore element numbers could be used to assess if all the TLEs for a
certain object are available. However, in practice it is observed that this is
not always the case, with some numbers skipped and some numbers repeated.</p>
</td></tr>
<tr><td><code>inclination</code></td>
<td>
<p>Mean orbital inclination of the satellite in degrees.
This is the angle between the orbital plane of the satellite and the
equatorial plane</p>
</td></tr>
<tr><td><code>ascension</code></td>
<td>
<p>Mean longitude of the ascending node of the satellite at
epoch, also known as right ascension of the ascending node, in degrees. This
is the angle between the direction of the ascending node (the point where the
satellite crosses the equatorial plane moving north) and the direction
of the First Point of Aries (which indicates the location of the vernal
equinox)</p>
</td></tr>
<tr><td><code>eccentricity</code></td>
<td>
<p>Mean eccentricity of the orbit of the object.
Eccentricity is a measurement of how much the orbit deviates from a circular
shape, with 0 indicating a perfectly circular orbit and 1 indicating an
extreme case of parabolic trajectory</p>
</td></tr>
<tr><td><code>perigeeArgument</code></td>
<td>
<p>Mean argument of the perigee of the object in degrees.
This is the angle between the direction of the ascending node and the
direction of the perigee (the point of the orbit at which the object is
closest to the Earth)</p>
</td></tr>
<tr><td><code>meanAnomaly</code></td>
<td>
<p>Mean anomaly of the orbit of the object in degrees. This
indicates where the satellite is along its orbital path. It is provided as
the angle between the direction of the perigee and the hypothetical point
where the object would be if it was moving in a circular orbit with the same
period as its true orbit after the same amount of time since it last crossed
the perigee had ellapsed. Therefore, 0 denotes that the object is at the
perigee</p>
</td></tr>
<tr><td><code>meanMotion</code></td>
<td>
<p>Mean motion of the satellite at epoch in revolutions/day
</p>
</td></tr>
<tr><td><code>meanMotionDerivative</code></td>
<td>
<p>First time derivative of the mean motion of the
satellite in revolutions/day^2^</p>
</td></tr>
<tr><td><code>meanMotionSecondDerivative</code></td>
<td>
<p>Second time derivative of the mean motion of
the satellite in revolutions/day^3^.
</p>
</td></tr>
<tr><td><code>Bstar</code></td>
<td>
<p>Drag coefficient of the satellite in units of (earth radii)^-1^.
Bstar is an adjusted value of the ballistic coefficient of the satellite, and
it indicates how susceptible it is to atmospheric drag.
</p>
</td></tr>
<tr><td><code>ephemerisType</code></td>
<td>
<p>Source for the ephemeris (orbital state vector). Most
commonly, it is distributed data obtained by combaining multiple observations
with the SGP4/SDP4 models
</p>
</td></tr>
<tr><td><code>epochRevolutionNumber</code></td>
<td>
<p>Number of full orbital revolutions completed by
the object
</p>
</td></tr>
<tr><td><code>objectName</code></td>
<td>
<p>Name of the object, retrieved from the first line of the
TLE if a Three Line Element was provided
</p>
</td></tr>
</table>


<h3>References</h3>

<p>https://celestrak.org/columns/v04n03/#FAQ01
http://www.celestrak.org/publications/aiaa/2006-6753/AIAA-2006-6753.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The file testTLE.txt provided with the package includes 29 TLE covering a
# variety of satellites, extracted from Revisiting Space Track Report #3

test_TLEs &lt;- readTLE(paste0(path.package("asteRisk"), "/testTLE.txt"))
test_TLEs
</code></pre>

<hr>
<h2 id='revDay2radMin'>Converts revolutions per day to radians per minute
</h2><span id='topic+revDay2radMin'></span>

<h3>Description</h3>

<p>This function converts a rotation rate in revolutions per day to radians per
minute. This conversion is useful since values in TLEs are given in revolutions
per day, but the SGP4 and SDP4 propagators require the mean motion to be provided
in radians per minute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>revDay2radMin(revPerDay)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="revDay2radMin_+3A_revperday">revPerDay</code></td>
<td>
<p>Value of the rotation rate in revolutions per day.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The corresponding value of the rotation rate in radians per minute.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>revDay2radMin(2)
</code></pre>

<hr>
<h2 id='sdp4'>Propagate an orbital state vector with the SDP4 model
</h2><span id='topic+sdp4'></span>

<h3>Description</h3>

<p>Given an orbital state vector of a satellite, applies the SDP4 model to
propagate its orbit to the desired time point. This allows the calculation of
the position and velocity of the satellite at different times, both before
and after the time corresponding to the known state vector (referred to as
&quot;epoch&quot;). Kepler's equation is solved through fixed-point integration.
The SDP4 model is a modified version of the SGP4 model that takes into account
the secular and periodic perturbations of the Moon and the Sun on the orbit of
the satellite. It also considers the Earth resonance effects on 24-hour
geostationary and 12-hour Molniya orbits.
Thanks to this, the SDP4 model can correctly propagate the orbit of objects
in deep space (with orbital periods larger than 225 minutes, corresponding to
altitudes higher than 5877.5 km). However, it should be noted that SDP4 employs
only simplified drag equations, and lacks corrections for low-perigee orbits.
Therefore, it is recommended to apply the standard SGP4 model (available through
the <code><a href="#topic+sgp4">sgp4</a></code> function) for satellites that are not in deep space. This
implementation is based on a previous SDP4 implementation in Julia
(SatelliteToolbox).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdp4(n0, e0, i0, M0, omega0, OMEGA0, Bstar, initialDateTime, targetTime,
     keplerAccuracy=10e-12, maxKeplerIterations=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sdp4_+3A_n0">n0</code></td>
<td>
<p>Mean motion of the satellite at epoch in radians/min.
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_e0">e0</code></td>
<td>
<p>Mean eccentricity of the orbit of the satellite at epoch.
Eccentricity ranges from 0 (perfectly circular orbit) to 1 (parabolic
trajectory).
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_i0">i0</code></td>
<td>
<p>Mean orbital inclination of the satellite at epoch in radians.
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_m0">M0</code></td>
<td>
<p>Mean anomaly of the satellite at epoch.
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_omega0">omega0</code></td>
<td>
<p>Mean argument of perigee of the satellite at epoch.
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_omega0">OMEGA0</code></td>
<td>
<p>Mean longitude of the ascending node of the satellite at epoch.
Also known as right ascension of the ascending node.
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_bstar">Bstar</code></td>
<td>
<p>Drag coefficient of the satellite in units of (earth radii)^-1^.
Bstar is an adjusted value of the ballistic coefficient of the satellite, and
it indicates how susceptible it is to atmospheric drag.
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_initialdatetime">initialDateTime</code></td>
<td>
<p>Date-time string in UTC indicating the time
corresponding to the known state vector of the satellite. Unlike for SGP4,
it must be provided in all cases since it is required to calculate Moon and
Sun perturbations.
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_targettime">targetTime</code></td>
<td>
<p>Time at which the position and velocity of the satellite
should be calculated. It can be provided in two different ways: either as
a number corresponding to the time in minutes counting from epoch at which
the orbit should be propagated, or as a date-time string in UTC.
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_kepleraccuracy">keplerAccuracy</code></td>
<td>
<p>Accuracy to consider Kepler¬¥s equation solved. If two
consecutive solutions differ by a value lower than this accuracy, integration
is considered to have converged.
</p>
</td></tr>
<tr><td><code id="sdp4_+3A_maxkepleriterations">maxKeplerIterations</code></td>
<td>
<p>Maximum number of iterations after which fixed-point
integration of Kepler's equation will stop, even if convergence according to
the accuracy criterion has not been reached.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three elements. The first two elements represent the position and
velocity of the satellite at the target time, in the TEME (True Equator, Mean
Equinox) frame of reference. Position values are in km, and velocity values are
in km/s. Each of these two elements contains three values, corresponding to the
X, Y and Z components of position and velocity in this order. The third element
indicates the algorithm used to propagate the orbit (sdp4).
</p>


<h3>References</h3>

<p>https://juliapackages.com/p/satellitetoolbox
https://celestrak.org/NORAD/documentation/spacetrk.pdf
http://www.celestrak.org/publications/aiaa/2006-6753/AIAA-2006-6753.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The following orbital parameters correspond to an object with NORAD catalogue
# number 24208 (Italsat 2) the 26th of June, 2006 at 00:58:29.34 UTC.

n0 &lt;- 1.007781*((2*pi)/(1440))  # Multiplication by 2pi/1440 to convert to radians/min
e0 &lt;- 0.002664 # mean eccentricity at epoch
i0 &lt;- 3.8536*pi/180 # mean inclination at epoch in radians
M0 &lt;- 48.3*pi/180 # mean anomaly at epoch in radians
omega0 &lt;- 311.0977*pi/180 # mean argument of perigee at epoch in radians
OMEGA0 &lt;- 80.0121*pi/180 # mean longitude of ascending node at epoch in radians
Bstar &lt;- 1e-04 # drag coefficient
epochDateTime &lt;- "2006-06-26 00:58:29.34"

# Calculation of the orbital period

2*pi/n0

# The period is higher than 225 min, and therefore the SDP4 model should be
# applied. Furthermore, from the mean motion in revolutions/day, it can be
# seen that it is a geostarionary satellite with a 24-hour period. Let¬¥s
# calculate and compare the position and velocity of the satellite at epoch
# and 1 day later.

state_0 &lt;- sdp4(n0=n0, e0=e0, i0=i0, M0=M0, omega0=omega0, OMEGA0=OMEGA0,
                Bstar=Bstar, initialDateTime=epochDateTime, targetTime=0)
state_1day &lt;- sdp4(n0=n0, e0=e0, i0=i0, M0=M0, omega0=omega0, OMEGA0=OMEGA0,
                   Bstar=Bstar, initialDateTime=epochDateTime, targetTime=1440)
state_0
state_1day

# The position and velocity are very similar after a full day, in accordance
# with the geostationary orbit
</code></pre>

<hr>
<h2 id='sgdp4'>Propagate an orbital state vector with the SGP4/SDP4 model
</h2><span id='topic+sgdp4'></span>

<h3>Description</h3>

<p>Given an orbital state vector of a satellite, applies the SGP4 or SDP4 model to
propagate its orbit to the desired time point, as appropriate depending on the
orbital period. The model will be automatically chosen depending on the
orbital period. For objects in deep space (with orbital periods larger than
225 minutes, equivalent to altitudes higher than 5877.5 km) the SDP4 model will
be applied. For objects near Earth (orbital periods shorter than 225 minutes, or
altitudes lower than 5877.5 km) the SGP4 model will be used. It is not
recommended to apply SGP4 to objects in deep space or SDP4 to objects near
Earth, but this can be forced by calling directly the <code><a href="#topic+sgp4">sgp4</a></code> and
<code><a href="#topic+sdp4">sdp4</a></code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sgdp4(n0, e0, i0, M0, omega0, OMEGA0, Bstar, initialDateTime=NULL, targetTime,
      keplerAccuracy=10e-12, maxKeplerIterations=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sgdp4_+3A_n0">n0</code></td>
<td>
<p>Mean motion of the satellite at epoch in radians/min.
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_e0">e0</code></td>
<td>
<p>Mean eccentricity of the orbit of the satellite at epoch.
Eccentricity ranges from 0 (perfectly circular orbit) to 1 (parabolic
trajectory).
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_i0">i0</code></td>
<td>
<p>Mean orbital inclination of the satellite at epoch in radians.
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_m0">M0</code></td>
<td>
<p>Mean anomaly of the satellite at epoch.
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_omega0">omega0</code></td>
<td>
<p>Mean argument of perigee of the satellite at epoch.
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_omega0">OMEGA0</code></td>
<td>
<p>Mean longitude of the ascending node of the satellite at epoch.
Also known as right ascension of the ascending node.
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_bstar">Bstar</code></td>
<td>
<p>Drag coefficient of the satellite in units of (earth radii)^-1^.
Bstar is an adjusted value of the ballistic coefficient of the satellite, and
it indicates how susceptible it is to atmospheric drag.
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_initialdatetime">initialDateTime</code></td>
<td>
<p>Date-time string in UTC indicating the time
corresponding to the known state vector of the satellite. It must be provided
for objects in deep space, and also for objects near Earth if <code>targetTime</code>
is provided as a date-time string.
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_targettime">targetTime</code></td>
<td>
<p>Time at which the position and velocity of the satellite
should be calculated. It can be provided in two different ways: either as
a number corresponding to the time in minutes counting from epoch at which
the orbit should be propagated, or as a date-time string in UTC, in which case
the date-time string for epoch must be provided through <code>initialDateTime</code>.
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_kepleraccuracy">keplerAccuracy</code></td>
<td>
<p>Accuracy to consider Kepler¬¥s equation solved. If two
consecutive solutions differ by a value lower than this accuracy, integration
is considered to have converged.
</p>
</td></tr>
<tr><td><code id="sgdp4_+3A_maxkepleriterations">maxKeplerIterations</code></td>
<td>
<p>Maximum number of iterations after which fixed-point
integration of Kepler's equation will stop, even if convergence according to
the accuracy criterion has not been reached.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three elements. The first two elements represent the position and
velocity of the satellite at the target time, in the TEME (True Equator, Mean
Equinox) frame of reference. Position values are in km, and velocity values are
in km/s. Each of these two elements contains three values, corresponding to the
X, Y and Z components of position and velocity in this order. The third element
indicates the algorithm used to propagate the orbit (sgp4 or sdp4).
</p>


<h3>References</h3>

<p>https://celestrak.org/NORAD/documentation/spacetrk.pdf
http://www.celestrak.org/publications/aiaa/2006-6753/AIAA-2006-6753.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The following orbital parameters correspond to an object with NORAD catalogue
# number 24208 (Italsat 2) the 26th of June, 2006 at 00:58:29.34 UTC.

n0 &lt;- 1.007781*((2*pi)/(1440))  # Multiplication by 2pi/1440 to convert to radians/min
e0 &lt;- 0.002664 # mean eccentricity at epoch
i0 &lt;- 3.8536*pi/180 # mean inclination at epoch in radians
M0 &lt;- 48.3*pi/180 # mean anomaly at epoch in radians
omega0 &lt;- 311.0977*pi/180 # mean argument of perigee at epoch in radians
OMEGA0 &lt;- 80.0121*pi/180 # mean longitude of ascending node at epoch in radians
Bstar &lt;- 1e-04 # drag coefficient
epochDateTime &lt;- "2006-06-26 00:58:29.34"

# Calculation of the orbital period

2*pi/n0

# The period is higher than 225 min, and therefore the SDP4 model should be
# applied. Let¬¥s calculatethe position and velocity of the satellite 12 hours
# after epoch.

italsat_12h &lt;- sgdp4(n0=n0, e0=e0, i0=i0, M0=M0, omega0=omega0, OMEGA0=OMEGA0,
                     Bstar=Bstar, initialDateTime=epochDateTime, targetTime=0)
italsat_12h$algorithm

# The SDP4 model was correctly chosen.
</code></pre>

<hr>
<h2 id='sgp4'>Propagate an orbital state vector with the SGP4 model
</h2><span id='topic+sgp4'></span>

<h3>Description</h3>

<p>Given an orbital state vector of a satellite, applies the SGP4 model to
propagate its orbit to the desired time point. This allows the calculation of
the position and velocity of the satellite at different times, both before
and after the time corresponding to the known state vector (referred to as
&quot;epoch&quot;). Kepler's equation is solved through fixed-point integration.
The SGP4 model can only accurately propagate the orbit of objects near Earth
(with an orbital period shorter than 225 minutes, corresponding approximately to
an altitude lower than 5877.5 km). For propagation of objects in deep space, the
SDP4 model should be used, available through the <code><a href="#topic+sdp4">sdp4</a></code> function.
This implementation is based on the theory and implementation described in
Space Track Report #3, and includes the corrections summarized in Revisiting
Space Track Report #3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sgp4(n0, e0, i0, M0, omega0, OMEGA0, Bstar, initialDateTime=NULL, targetTime,
     keplerAccuracy=10e-12, maxKeplerIterations=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sgp4_+3A_n0">n0</code></td>
<td>
<p>Mean motion of the satellite at epoch in radians/min.
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_e0">e0</code></td>
<td>
<p>Mean eccentricity of the orbit of the satellite at epoch.
Eccentricity ranges from 0 (perfectly circular orbit) to 1 (parabolic
trajectory).
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_i0">i0</code></td>
<td>
<p>Mean orbital inclination of the satellite at epoch in radians.
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_m0">M0</code></td>
<td>
<p>Mean anomaly of the satellite at epoch.
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_omega0">omega0</code></td>
<td>
<p>Mean argument of perigee of the satellite at epoch.
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_omega0">OMEGA0</code></td>
<td>
<p>Mean longitude of the ascending node of the satellite at epoch.
Also known as right ascension of the ascending node.
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_bstar">Bstar</code></td>
<td>
<p>Drag coefficient of the satellite in units of (earth radii)^-1^.
Bstar is an adjusted value of the ballistic coefficient of the satellite, and
it indicates how susceptible it is to atmospheric drag.
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_initialdatetime">initialDateTime</code></td>
<td>
<p>Optional date-time string in UTC indicating the time
corresponding to the known state vector of the satellite. It must be provided
if <code>targetTime</code> is provided as a date-time string.
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_targettime">targetTime</code></td>
<td>
<p>Time at which the position and velocity of the satellite
should be calculated. It can be provided in two different ways: either as
a number corresponding to the time in minutes counting from epoch at which
the orbit should be propagated, or as a date-time string in UTC, in which case
the date-time string for epoch must be provided through <code>initialDateTime</code>.
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_kepleraccuracy">keplerAccuracy</code></td>
<td>
<p>Accuracy to consider Kepler¬¥s equation solved. If two
consecutive solutions differ by a value lower than this accuracy, integration
is considered to have converged.
</p>
</td></tr>
<tr><td><code id="sgp4_+3A_maxkepleriterations">maxKeplerIterations</code></td>
<td>
<p>Maximum number of iterations after which fixed-point
integration of Kepler's equation will stop, even if convergence according to
the accuracy criterion has not been reached.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three elements. The first two elements represent the position and
velocity of the satellite at the target time, in the TEME (True Equator, Mean
Equinox) frame of reference. Position values are in km, and velocity values are
in km/s. Each of these two elements contains three values, corresponding to the
X, Y and Z components of position and velocity in this order. The third element
indicates the algorithm used to propagate the orbit (sgp4).
</p>


<h3>References</h3>

<p>https://celestrak.org/NORAD/documentation/spacetrk.pdf
http://www.celestrak.org/publications/aiaa/2006-6753/AIAA-2006-6753.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The following orbital parameters correspond to an object with NORAD catalogue
# number 88888 the 1st of October, 1980 at 23:41:24 UTC.

n0 &lt;- 16.05824518*((2*pi)/(1440))  # Multiplication by 2pi/1440 to convert to radians/min
e0 &lt;- 0.0086731 # mean eccentricity at epoch
i0 &lt;- 72.8435*pi/180 # mean inclination at epoch in radians
M0 &lt;- 110.5714*pi/180 # mean anomaly at epoch in radians
omega0 &lt;- 52.6988*pi/180 # mean argument of perigee at epoch in radians
OMEGA0 &lt;- 115.9689*pi/180 # mean longitude of ascending node at epoch in radians
Bstar &lt;- 0.66816e-4 # drag coefficient

# Calculation of the orbital period

2*pi/n0

# The period is lower than 225 min, and therefore the SGP4 model is valid.
# Let¬¥s calculate the position and velocity of the satellite 40 minutes after
# epoch

new_state &lt;- sgp4(n0=n0, e0=e0, i0=i0, M0=M0, omega0=omega0, OMEGA0=OMEGA0,
                  Bstar=Bstar,targetTime = 40)
new_state
</code></pre>

<hr>
<h2 id='TEMEtoGCRF'>Convert coordinates from TEME to GCRF
</h2><span id='topic+TEMEtoGCRF'></span>

<h3>Description</h3>

<p>The TEME (True Equator, Mean Equinox) and GCRF (Geocentric Celestial Reference
Frame) are both ECI frames of reference, i.e., Earth-centered inertial 
coordinate frames, where the origin is placed at the center of mass
of Earth and the coordinate frame is fixed with respect to the stars (and
therefore not fixed with respect to the Earth surface in its rotation). 
</p>
<p>The difference between the two resides in the fact that in the GCRF frame,
the X-axis and Z-axis are aligned respectively with the mean equinox and 
rotation axis of Earth at 12:00 Terrestrial Time on the 1st of January, 2000,
while in the TEME frame they are aligned with the mean equinox and rotation
axis at the time of the corresponding TLE. Due to the change of the direction
of the vernal equinox and the rotation axis over time, coordinates in the two
frames differ slightly.
</p>
<p>This function requires the <code>asteRiskData</code> package, which can be installed 
by running <code>install.packages('asteRiskData', repos='https://rafael-ayala.github.io/drat/')</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TEMEtoGCRF(position_TEME, velocity_TEME, dateTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TEMEtoGCRF_+3A_position_teme">position_TEME</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of an object in TEME frame, in m.
</p>
</td></tr>
<tr><td><code id="TEMEtoGCRF_+3A_velocity_teme">velocity_TEME</code></td>
<td>
<p>Vector with the X, Y and Z components of the velocity
of an object in TEME frame, in m/s.
</p>
</td></tr>
<tr><td><code id="TEMEtoGCRF_+3A_datetime">dateTime</code></td>
<td>
<p>Date-time string with the date and time in UTC corresponding
to the provided position and velocity vectors. This specifies the time for 
which the conversion from TEME to GCRF coordinates will be performed. It is
required due to the change in the exact position of the rotation axis of 
Earth due to precesion, nutation and polar motion.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements representing the position and velocity of the satellite
in the ECEF (Earth Centered, Earth Fixed) frame of reference. Position values
are in m, and velocity values are in m/s. Each of the two elements contains
three values, corresponding to the X, Y and Z components of position and
velocity in this order.
</p>


<h3>References</h3>

<p>https://celestrak.org/columns/v04n03/#FAQ01
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
# The following orbital parameters correspond to an object with NORAD catalogue
# number 24208 (Italsat 2) the 26th of June, 2006 at 00:58:29.34 UTC.

n0 &lt;- 1.007781*((2*pi)/(1440))  # Multiplication by 2pi/1440 to convert to radians/min
e0 &lt;- 0.002664 # mean eccentricity at epoch
i0 &lt;- 3.8536*pi/180 # mean inclination at epoch in radians
M0 &lt;- 48.3*pi/180 # mean anomaly at epoch in radians
omega0 &lt;- 311.0977*pi/180 # mean argument of perigee at epoch in radians
OMEGA0 &lt;- 80.0121*pi/180 # mean longitude of ascending node at epoch in radians
Bstar &lt;- 1e-04 # drag coefficient
epochDateTime &lt;- "2006-06-26 00:58:29.34"

# Let¬¥s calculate the position and velocity of the satellite 1 day later

state_1day_TEME &lt;- sgdp4(n0=n0, e0=e0, i0=i0, M0=M0, omega0=omega0, OMEGA0=OMEGA0,
                         Bstar=Bstar, initialDateTime=epochDateTime, targetTime=1440)

# We can now convert the results in TEME frame to GCRF frame, previously
# multiplying by 1000 to convert the km output of sgdp4 to m

state_1day_GCRF &lt;- TEMEtoGCRF(state_1day_TEME$position*1000, 
                              state_1day_TEME$velocity*1000,
                              "2006-06-27 00:58:29.34")
}
</code></pre>

<hr>
<h2 id='TEMEtoITRF'>Convert coordinates from TEME to ITRF
</h2><span id='topic+TEMEtoITRF'></span>

<h3>Description</h3>

<p>The TEME (True Equator, Mean Equinox) frame of reference is an Earth-centered
inertial coordinate frame, where the origin is placed at the center of mass
of Earth and the coordinate frame is fixed with respect to the stars (and
therefore not fixed with respect to the Earth surface in its rotation). The
coordinates and velocities calculated with the SGP4 and SDP4 models are in the
TEME frame of reference. This function converts positions and velocities in
TEME to the ITRF (International Terrestrial Reference Frame), which is an ECEF 
(Earth Centered, Earth Fixed) frame of reference. In the ITRF, the origin is 
also placed at the center of mass of Earth, but the frame rotates with respect 
to the stars to remain fixed with respect to the Earth surface as it rotates. 
The Z-axis extends along the true North as defined by the IERS reference pole, 
and the X-axis extends towards the intersection between the equator and the 
Greenwich meridian at any time.
</p>
<p>This function requires the <code>asteRiskData</code> package, which can be installed 
by running <code>install.packages('asteRiskData', repos='https://rafael-ayala.github.io/drat/')</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TEMEtoITRF(position_TEME, velocity_TEME, dateTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TEMEtoITRF_+3A_position_teme">position_TEME</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of an object in TEME frame, in m.
</p>
</td></tr>
<tr><td><code id="TEMEtoITRF_+3A_velocity_teme">velocity_TEME</code></td>
<td>
<p>Vector with the X, Y and Z components of the velocity
of an object in TEME frame, in m/s.
</p>
</td></tr>
<tr><td><code id="TEMEtoITRF_+3A_datetime">dateTime</code></td>
<td>
<p>Date-time string with the date and time in UTC corresponding
to the provided position and velocity vectors. This specifies the time for 
which the conversion from TEME to ITRF coordinates will be performed. It is
important to provide an accurate value, since the point over the surface of
Earth to which a set of TEME coordinates refers varies with time due to
the motion of Earth.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements representing the position and velocity of the satellite
in the ITRF (International Terrestrial Reference Frame) frame of reference. 
Position values are in m, and velocity values are in m/s. Each of the two 
elements contains three values, corresponding to the X, Y and Z components of 
position and velocity in this order.
</p>


<h3>References</h3>

<p>https://celestrak.org/columns/v04n03/#FAQ01
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
# The following orbital parameters correspond to an object with NORAD catalogue
# number 24208 (Italsat 2) the 26th of June, 2006 at 00:58:29.34 UTC.

n0 &lt;- 1.007781*((2*pi)/(1440))  # Multiplication by 2pi/1440 to convert to radians/min
e0 &lt;- 0.002664 # mean eccentricity at epoch
i0 &lt;- 3.8536*pi/180 # mean inclination at epoch in radians
M0 &lt;- 48.3*pi/180 # mean anomaly at epoch in radians
omega0 &lt;- 311.0977*pi/180 # mean argument of perigee at epoch in radians
OMEGA0 &lt;- 80.0121*pi/180 # mean longitude of ascending node at epoch in radians
Bstar &lt;- 1e-04 # drag coefficient
epochDateTime &lt;- "2006-06-26 00:58:29.34"

# Let¬¥s calculate the position and velocity of the satellite 1 day later

state_1day_TEME &lt;- sgdp4(n0=n0, e0=e0, i0=i0, M0=M0, omega0=omega0, OMEGA0=OMEGA0,
                         Bstar=Bstar, initialDateTime=epochDateTime, targetTime=1440)

# We can now convert the results in TEME frame to ITRF frame, previously
# multiplying by 1000 to convert the km output of sgdp4 to m

state_1day_ITRF &lt;- TEMEtoITRF(state_1day_TEME$position*1000, 
                              state_1day_TEME$velocity*1000,
                              "2006-06-27 00:58:29.34")
}
</code></pre>

<hr>
<h2 id='TEMEtoLATLON'>Convert coordinates from TEME to geodetic latitude, longitude and altitude
</h2><span id='topic+TEMEtoLATLON'></span>

<h3>Description</h3>

<p>The TEME (True Equator, Mean Equinox) frame of reference is an Earth-centered
inertial coordinate frame, where the origin is placed at the center of mass
of Earth and the coordinate frame is fixed with respect to the stars (and
therefore not fixed with respect to the Earth surface in its rotation). The
coordinates and velocities calculated with the SGP4 and SDP4 models are in the
TEME frame of reference. This function converts position in TEME to geodetic 
latitude, longitude and altitude, which can be considered to be a non-inertial, 
Earth-centered frame of reference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TEMEtoLATLON(position_TEME, dateTime, degreesOutput=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TEMEtoLATLON_+3A_position_teme">position_TEME</code></td>
<td>
<p>Vector with the X, Y and Z components of the position
of an object in TEME frame, in m.
</p>
</td></tr>
<tr><td><code id="TEMEtoLATLON_+3A_datetime">dateTime</code></td>
<td>
<p>Date-time string with the date and time in UTC corresponding
to the provided position vector. This specifies the time for which the
conversion from TEME to geodetic coordinates will be performed. It is
important to provide an accurate value, since the point over the surface of
Earth to which a set of TEME coordinates refers varies with time due to
the motion of Earth.
</p>
</td></tr>
<tr><td><code id="TEMEtoLATLON_+3A_degreesoutput">degreesOutput</code></td>
<td>
<p>Logical indicating if the output should be in sexagesimal
degrees. If <code>degreesOutput=FALSE</code>, the output will be in radians.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with three elements, corresponding to the latitude and longitude in
degrees (or radians if specified) and the altitude in m.
</p>


<h3>References</h3>

<p>https://arc.aiaa.org/doi/10.2514/6.2006-6753
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("asteRiskData", quietly = TRUE)) {
# The following orbital parameters correspond to an object with NORAD catalogue
# number 24208 (Italsat 2) the 26th of June, 2006 at 00:58:29.34 UTC.

n0 &lt;- 1.007781*((2*pi)/(1440))  # Multiplication by 2pi/1440 to convert to radians/min
e0 &lt;- 0.002664 # mean eccentricity at epoch
i0 &lt;- 3.8536*pi/180 # mean inclination at epoch in radians
M0 &lt;- 48.3*pi/180 # mean anomaly at epoch in radians
omega0 &lt;- 311.0977*pi/180 # mean argument of perigee at epoch in radians
OMEGA0 &lt;- 80.0121*pi/180 # mean longitude of ascending node at epoch in radians
Bstar &lt;- 1e-04 # drag coefficient
epochDateTime &lt;- "2006-06-26 00:58:29.34"

# Let¬¥s calculate the position and velocity of the satellite 1 day later

state_1day_TEME &lt;- sgdp4(n0=n0, e0=e0, i0=i0, M0=M0, omega0=omega0, OMEGA0=OMEGA0,
                         Bstar=Bstar, initialDateTime=epochDateTime, targetTime=1440)

# We can now convert the results in TEME frame to geodetic latitude, longitude
# and altitude, previously multiplying by 1000 to convert the km output of 
# sgdp4 to m

state_1day_geodetic &lt;- TEMEtoLATLON(state_1day_TEME$position*1000, 
                                    "2006-06-27 00:58:29.34")
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
