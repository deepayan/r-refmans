<!DOCTYPE html><html lang="en"><head><title>Help for package TAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ARorder.lognorm'><p>Identify the autoregressive orders for a log-normal TAR model given the number of regimes and thresholds.</p></a></li>
<li><a href='#ARorder.norm'><p>Identify the autoregressive orders for a Gaussian TAR model given the number of regimes and thresholds.</p></a></li>
<li><a href='#LS.lognorm'><p>Estimate a log-normal TAR model using Least Square method given the structural parameters.</p></a></li>
<li><a href='#LS.norm'><p>Estimate a Gaussian TAR model using Least Square method given the structural parameters.</p></a></li>
<li><a href='#Param.lognorm'><p>Estimate a TAR model using Gibbs Sampler given the structural parameters.</p></a></li>
<li><a href='#Param.norm'><p>Estimate a Gaussian TAR model using Gibbs Sampler given the structural parameters.</p></a></li>
<li><a href='#reg.thr.lognorm'><p>Identify the number of regimes and the corresponding thresholds for a log-normal TAR model.</p></a></li>
<li><a href='#reg.thr.norm'><p>Identify the number of regimes and the corresponding thresholds for a Gaussian TAR model.</p></a></li>
<li><a href='#simu.tar.lognorm'><p>Simulate a series from a log-normal TAR model with Gaussian distributed error for positive valued time series.</p></a></li>
<li><a href='#simu.tar.norm'><p>Simulate a series from a TAR model with Gaussian distributed error.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Modeling of Autoregressive Threshold Time Series Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-02-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Hanwen Zhang, Fabio H. Nieto</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hanwen Zhang &lt;hanwengutierrez@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Identification and estimation of the autoregressive threshold models with Gaussian noise, as well as positive-valued time series. The package provides the identification of the number of regimes, the thresholds and the autoregressive orders, as well as the estimation of remain parameters. The package implements the methodology from the 2005 paper: Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data &lt;<a href="https://doi.org/10.1081%2FSTA-200054435">doi:10.1081/STA-200054435</a>&gt;.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-02-24 02:41:45 UTC; hanwenzhang</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-02-24 08:31:45</td>
</tr>
</table>
<hr>
<h2 id='ARorder.lognorm'>Identify the autoregressive orders for a log-normal TAR model given the number of regimes and thresholds.</h2><span id='topic+ARorder.lognorm'></span>

<h3>Description</h3>

<p>This function identify the autoregressive orders for a log-normal TAR model given the number of regimes and thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARorder.lognorm(Z, X, l, r, k_Max = 3, k_Min = 0, n.sim = 500,
  p.burnin = 0.3, n.thin = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ARorder.lognorm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="ARorder.lognorm_+3A_x">X</code></td>
<td>
<p>The series of interest</p>
</td></tr>
<tr><td><code id="ARorder.lognorm_+3A_l">l</code></td>
<td>
<p>The number of regimes.</p>
</td></tr>
<tr><td><code id="ARorder.lognorm_+3A_r">r</code></td>
<td>
<p>The vector of thresholds for the series {Z_t}.</p>
</td></tr>
<tr><td><code id="ARorder.lognorm_+3A_k_max">k_Max</code></td>
<td>
<p>The minimum value for each autoregressive order. The default is 3.</p>
</td></tr>
<tr><td><code id="ARorder.lognorm_+3A_k_min">k_Min</code></td>
<td>
<p>The maximum value for each autoregressive order. The default is 0.</p>
</td></tr>
<tr><td><code id="ARorder.lognorm_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of iteration for the Gibbs Sampler</p>
</td></tr>
<tr><td><code id="ARorder.lognorm_+3A_p.burnin">p.burnin</code></td>
<td>
<p>Percentage of iterations used for burn-in</p>
</td></tr>
<tr><td><code id="ARorder.lognorm_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinnin factor for the Gibbs Sampler</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-normal TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">log X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}log X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for some <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights. <code class="reqn">\{e_t\}</code> is the Gaussian white noise process <code class="reqn">N(0,1)</code>.
</p>


<h3>Value</h3>

<p>The identified autoregressive orders with posterior probabilities
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simu.tar.lognorm">simu.tar.lognorm</a>, <a href="#topic+ARorder.norm">ARorder.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345678)
Z&lt;-arima.sim(n=500,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(1,0.5,-0.3,-0.5,-0.7,NA),nrow=l)
H &lt;- c(1, 1.3)
X &lt;- simu.tar.lognorm(Z,l,r,K,theta,H)
#res &lt;- ARorder.lognorm(Z,X,l,r)
#res$K.est
#res$K.prob
</code></pre>

<hr>
<h2 id='ARorder.norm'>Identify the autoregressive orders for a Gaussian TAR model given the number of regimes and thresholds.</h2><span id='topic+ARorder.norm'></span>

<h3>Description</h3>

<p>This function identify the autoregressive orders for a TAR model with Gaussian noise process given the number of regimes and thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARorder.norm(Z, X, l, r, k_Max = 3, k_Min = 0, n.sim = 500,
  p.burnin = 0.3, n.thin = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ARorder.norm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="ARorder.norm_+3A_x">X</code></td>
<td>
<p>The series of interest</p>
</td></tr>
<tr><td><code id="ARorder.norm_+3A_l">l</code></td>
<td>
<p>The number of regimes.</p>
</td></tr>
<tr><td><code id="ARorder.norm_+3A_r">r</code></td>
<td>
<p>The vector of thresholds for the series {Z_t}.</p>
</td></tr>
<tr><td><code id="ARorder.norm_+3A_k_max">k_Max</code></td>
<td>
<p>The minimum value for each autoregressive order. The default is 3.</p>
</td></tr>
<tr><td><code id="ARorder.norm_+3A_k_min">k_Min</code></td>
<td>
<p>The maximum value for each autoregressive order. The default is 0.</p>
</td></tr>
<tr><td><code id="ARorder.norm_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of iteration for the Gibbs Sampler</p>
</td></tr>
<tr><td><code id="ARorder.norm_+3A_p.burnin">p.burnin</code></td>
<td>
<p>Percentage of iterations used for</p>
</td></tr>
<tr><td><code id="ARorder.norm_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinnin factor for the Gibbs Sampler</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for som <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights. <code class="reqn">\{e_t\}</code> is the Gaussian white noise process <code class="reqn">N(0,1)</code>.
</p>


<h3>Value</h3>

<p>The identified autoregressive orders with posterior probabilities
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simu.tar.norm">simu.tar.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123456789)
Z&lt;-arima.sim(n=300,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(1,-0.5,0.5,-0.7,-0.3,NA), nrow=l)
H &lt;- c(1, 1.5)
X &lt;- simu.tar.norm(Z,l,r,K,theta,H)
#res &lt;- ARorder.norm(Z,X,l,r)
#res$K.est
#res$K.prob
</code></pre>

<hr>
<h2 id='LS.lognorm'>Estimate a log-normal TAR model using Least Square method given the structural parameters.</h2><span id='topic+LS.lognorm'></span>

<h3>Description</h3>

<p>This function estimate a log-normal TAR model using Least Square method given the structural parameters, i.e. the number of regimes, thresholds and autoregressive orders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LS.lognorm(Z, X, l, r, K)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LS.lognorm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="LS.lognorm_+3A_x">X</code></td>
<td>
<p>The series of interest</p>
</td></tr>
<tr><td><code id="LS.lognorm_+3A_l">l</code></td>
<td>
<p>The number of regimes.</p>
</td></tr>
<tr><td><code id="LS.lognorm_+3A_r">r</code></td>
<td>
<p>The vector of thresholds for the series <code class="reqn">\{Z_t\}</code>.</p>
</td></tr>
<tr><td><code id="LS.lognorm_+3A_k">K</code></td>
<td>
<p>The vector containing the autoregressive orders of the <code class="reqn">l</code> regimes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">log X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}log X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for som <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights.
</p>


<h3>Value</h3>

<p>The function returns the autoregressive coefficients matrix theta and variance weights H. Rows of the matrix theta represent regimes
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simu.tar.norm">simu.tar.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Z&lt;-arima.sim(n=500,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(1,0.5,-0.3,-0.5,-0.7,NA),nrow=l)
H &lt;- c(1, 1.3)
X &lt;- simu.tar.lognorm(Z,l,r,K,theta,H)
ts.plot(X)
LS.lognorm(Z,X,l,r,K)
</code></pre>

<hr>
<h2 id='LS.norm'>Estimate a Gaussian TAR model using Least Square method given the structural parameters.</h2><span id='topic+LS.norm'></span>

<h3>Description</h3>

<p>This function estimate a Gaussian TAR model using Least Square method given the structural parameters, i.e. the number of regimes, thresholds and autoregressive orders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LS.norm(Z, X, l, r, K)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LS.norm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="LS.norm_+3A_x">X</code></td>
<td>
<p>The series of interest</p>
</td></tr>
<tr><td><code id="LS.norm_+3A_l">l</code></td>
<td>
<p>The number of regimes.</p>
</td></tr>
<tr><td><code id="LS.norm_+3A_r">r</code></td>
<td>
<p>The vector of thresholds for the series <code class="reqn">\{Z_t\}</code>.</p>
</td></tr>
<tr><td><code id="LS.norm_+3A_k">K</code></td>
<td>
<p>The vector containing the autoregressive orders of the <code class="reqn">l</code> regimes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for som <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights.
</p>


<h3>Value</h3>

<p>The function returns the autoregressive coefficients matrix theta and variance weights <code class="reqn">H</code>. Rows of the matrix theta represent regimes
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simu.tar.norm">simu.tar.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Z&lt;-arima.sim(n=500,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(1,-0.5,0.5,-0.7,-0.3,NA), nrow=l)
H &lt;- c(1, 1.5)
X &lt;- simu.tar.norm(Z,l,r,K,theta,H)
LS.norm(Z,X,l,r,c(0,0))
</code></pre>

<hr>
<h2 id='Param.lognorm'>Estimate a TAR model using Gibbs Sampler given the structural parameters.</h2><span id='topic+Param.lognorm'></span>

<h3>Description</h3>

<p>This function estimate a TAR model using Gibbs Sampler given the structural parameters, i.e. the number of regimes, thresholds and autoregressive orders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Param.lognorm(Z, X, l, r, K, n.sim = 500, p.burnin = 0.2, n.thin = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Param.lognorm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="Param.lognorm_+3A_x">X</code></td>
<td>
<p>The series of interest</p>
</td></tr>
<tr><td><code id="Param.lognorm_+3A_l">l</code></td>
<td>
<p>The number of regimes.</p>
</td></tr>
<tr><td><code id="Param.lognorm_+3A_r">r</code></td>
<td>
<p>The vector of thresholds for the series <code class="reqn">\{Z_t\}</code>.</p>
</td></tr>
<tr><td><code id="Param.lognorm_+3A_k">K</code></td>
<td>
<p>The vector containing the autoregressive orders of the l regimes.</p>
</td></tr>
<tr><td><code id="Param.lognorm_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of iteration for the Gibbs Sampler</p>
</td></tr>
<tr><td><code id="Param.lognorm_+3A_p.burnin">p.burnin</code></td>
<td>
<p>Percentage of iterations used for burn-in</p>
</td></tr>
<tr><td><code id="Param.lognorm_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinnin factor for the Gibbs Sampler</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for som <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights. <code class="reqn">\{e_t\}</code> is the Gaussian white noise process <code class="reqn">N(0,1)</code>.
</p>


<h3>Value</h3>

<p>The function returns the autoregressive coefficients matrix theta and variance weights <code class="reqn">H</code>. Rows of the matrix theta represent regimes
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LS.norm">LS.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Example 1, TAR model with 2 regimes
 #' set.seed(12345678)
Z&lt;-arima.sim(n=500,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(1,0.5,-0.3,-0.5,-0.7,NA),nrow=l)
H &lt;- c(1, 1.3)
X &lt;- simu.tar.lognorm(Z,l,r,K,theta,H)
# res &lt;- Param.lognorm(Z,X,l,r,K)

# Example 2, TAR model with 3 regimes
Z&lt;-arima.sim(n=300, list(ar=c(0.5)))
l &lt;- 3
r &lt;- c(-0.6, 0.6)
K &lt;- c(1, 2, 1)
theta &lt;- matrix(c(1,0.5,-0.5,-0.5,0.2,-0.7,NA, 0.5,NA), nrow=l)
H &lt;- c(1, 1.5, 2)
X &lt;- simu.tar.lognorm(Z, l, r, K, theta, H)
# res &lt;- Param.lognorm(Z,X,l,r,K)
</code></pre>

<hr>
<h2 id='Param.norm'>Estimate a Gaussian TAR model using Gibbs Sampler given the structural parameters.</h2><span id='topic+Param.norm'></span>

<h3>Description</h3>

<p>This function estimate a Gaussian TAR model using Gibbs Sampler given the structural parameters, i.e. the number of regimes, thresholds and autoregressive orders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Param.norm(Z, X, l, r, K, n.sim = 500, p.burnin = 0.2, n.thin = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Param.norm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="Param.norm_+3A_x">X</code></td>
<td>
<p>The series of interest</p>
</td></tr>
<tr><td><code id="Param.norm_+3A_l">l</code></td>
<td>
<p>The number of regimes.</p>
</td></tr>
<tr><td><code id="Param.norm_+3A_r">r</code></td>
<td>
<p>The vector of thresholds for the series <code class="reqn">\{Z_t\}</code>.</p>
</td></tr>
<tr><td><code id="Param.norm_+3A_k">K</code></td>
<td>
<p>The vector containing the autoregressive orders of the <code class="reqn">l</code> regimes.</p>
</td></tr>
<tr><td><code id="Param.norm_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of iteration for the Gibbs Sampler</p>
</td></tr>
<tr><td><code id="Param.norm_+3A_p.burnin">p.burnin</code></td>
<td>
<p>Percentage of iterations used for burn-in</p>
</td></tr>
<tr><td><code id="Param.norm_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinnin factor for the Gibbs Sampler</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for som <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights. <code class="reqn">\{e_t\}</code> is the Gaussian white noise process <code class="reqn">N(0,1)</code>.
</p>


<h3>Value</h3>

<p>The function returns the autoregressive coefficients matrix theta and variance weights <code class="reqn">H</code>. Rows of the matrix theta represent regimes
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LS.norm">LS.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Example 1, TAR model with 2 regimes
Z&lt;-arima.sim(n=500,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(1,-0.5,0.5,-0.7,-0.3,NA), nrow=l)
H &lt;- c(1, 1.5)
X &lt;- simu.tar.norm(Z,l,r,K,theta,H)
# res &lt;- Param.norm(Z,X,l,r,K)

# Example 2, TAR model with 3 regimes
Z&lt;-arima.sim(n=300, list(ar=c(0.5)))
l &lt;- 3
r &lt;- c(-0.6, 0.6)
K &lt;- c(1, 2, 1)
theta &lt;- matrix(c(1,0.5,-0.5,-0.5,0.2,-0.7,NA, 0.5,NA), nrow=l)
H &lt;- c(1, 1.5, 2)
X &lt;- simu.tar.norm(Z, l, r, K, theta, H)
# res &lt;- Param.norm(Z,X,l,r,K)
</code></pre>

<hr>
<h2 id='reg.thr.lognorm'>Identify the number of regimes and the corresponding thresholds for a log-normal TAR model.</h2><span id='topic+reg.thr.lognorm'></span>

<h3>Description</h3>

<p>This function identify the number of regimes and the corresponding thresholds for a log-normal TAR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reg.thr.lognorm(Z, X, n.sim = 500, p.burnin = 0.2, n.thin = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reg.thr.lognorm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="reg.thr.lognorm_+3A_x">X</code></td>
<td>
<p>The series of interest</p>
</td></tr>
<tr><td><code id="reg.thr.lognorm_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of iteration for the Gibbs Sampler</p>
</td></tr>
<tr><td><code id="reg.thr.lognorm_+3A_p.burnin">p.burnin</code></td>
<td>
<p>Percentage of iterations used for Burn-in</p>
</td></tr>
<tr><td><code id="reg.thr.lognorm_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinnin factor for the Gibbs Sampler</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">log X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}log X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for som <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights. <code class="reqn">\{e_t\}</code> is the Gaussian white noise process <code class="reqn">N(0,1)</code>.
</p>


<h3>Value</h3>

<p>The function returns the identified number of regimes with posterior probabilities and the thresholds with credible intervals.
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LS.norm">LS.norm</a></code>s
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345678)
# Example 1, log-normal TAR model with 2 regimes
Z&lt;-arima.sim(n=400,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(-1,0.5,0.3,-0.5,-0.7,NA),nrow=l)
H &lt;- c(1, 1.5)
#X &lt;- simu.tar.lognorm(Z,l,r,K,theta,H)
#res &lt;- reg.thr.lognorm(Z,X)
#res$L.est
#res$L.prob
#res$R.est
#res$R.CI

</code></pre>

<hr>
<h2 id='reg.thr.norm'>Identify the number of regimes and the corresponding thresholds for a Gaussian TAR model.</h2><span id='topic+reg.thr.norm'></span>

<h3>Description</h3>

<p>This function identify the number of regimes and the corresponding thresholds for a TAR model with Gaussian noise process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reg.thr.norm(Z, X, n.sim = 500, p.burnin = 0.2, n.thin = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reg.thr.norm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="reg.thr.norm_+3A_x">X</code></td>
<td>
<p>The series of interest</p>
</td></tr>
<tr><td><code id="reg.thr.norm_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of iteration for the Gibbs Sampler</p>
</td></tr>
<tr><td><code id="reg.thr.norm_+3A_p.burnin">p.burnin</code></td>
<td>
<p>Percentage of iterations used for Burn-in</p>
</td></tr>
<tr><td><code id="reg.thr.norm_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinnin factor for the Gibbs Sampler</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for som <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights. <code class="reqn">\{e_t\}</code> is the Gaussian white noise process <code class="reqn">N(0,1)</code>.
</p>


<h3>Value</h3>

<p>The function returns the identified number of regimes with posterior probabilities and the thresholds with credible intervals.
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LS.norm">LS.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345678)
# Example 1, TAR model with 2 regimes
Z&lt;-arima.sim(n=300,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(1,-0.5,0.5,-0.7,-0.3,NA), nrow=l)
H &lt;- c(1, 1.5)
X &lt;- simu.tar.norm(Z,l,r,K,theta,H)
#res &lt;- reg.thr.norm(Z,X)
#res$L.est
#res$L.prob
#res$R.est
#res$R.CI

</code></pre>

<hr>
<h2 id='simu.tar.lognorm'>Simulate a series from a log-normal TAR model with Gaussian distributed error for positive valued time series.</h2><span id='topic+simu.tar.lognorm'></span>

<h3>Description</h3>

<p>This function simulates a serie from  a log-normal TAR model with Gaussian distributed error given the parameters of the model from a given threshold process <code class="reqn">\{Z_t\}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simu.tar.lognorm(Z, l, r, K, theta, H)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simu.tar.lognorm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="simu.tar.lognorm_+3A_l">l</code></td>
<td>
<p>The number of regimes.</p>
</td></tr>
<tr><td><code id="simu.tar.lognorm_+3A_r">r</code></td>
<td>
<p>The vector of thresholds for the series <code class="reqn">\{Z_t\}</code>.</p>
</td></tr>
<tr><td><code id="simu.tar.lognorm_+3A_k">K</code></td>
<td>
<p>The vector containing the autoregressive orders of the <code class="reqn">l</code> regimes.</p>
</td></tr>
<tr><td><code id="simu.tar.lognorm_+3A_theta">theta</code></td>
<td>
<p>The matrix of autoregressive coefficients of dimension <code class="reqn">l\times\max{K}</code>. <code class="reqn">j</code>-th row contains the autoregressive coefficients of regime <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="simu.tar.lognorm_+3A_h">H</code></td>
<td>
<p>The vector containing the variance weights of the <code class="reqn">l</code> regimes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for som <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights. <code class="reqn">\{e_t\}</code> is the Gaussian white noise process <code class="reqn">N(0,1)</code>.
</p>


<h3>Value</h3>

<p>The time series <code class="reqn">\{X_t\}</code>.
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simu.tar.norm">simu.tar.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345678)
Z&lt;-arima.sim(n=500,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(1,0.5,-0.3,-0.5,-0.7,NA),nrow=l)
H &lt;- c(1, 1.3)
X &lt;- simu.tar.lognorm(Z,l,r,K,theta,H)
ts.plot(X)

</code></pre>

<hr>
<h2 id='simu.tar.norm'>Simulate a series from a TAR model with Gaussian distributed error.</h2><span id='topic+simu.tar.norm'></span>

<h3>Description</h3>

<p>This function simulates a serie from a TAR model with Gaussian distributed error given the parameters of the model from a given threshold process <code class="reqn">\{Z_t\}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simu.tar.norm(Z, l, r, K, theta, H)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simu.tar.norm_+3A_z">Z</code></td>
<td>
<p>The threshold series</p>
</td></tr>
<tr><td><code id="simu.tar.norm_+3A_l">l</code></td>
<td>
<p>The number of regimes.</p>
</td></tr>
<tr><td><code id="simu.tar.norm_+3A_r">r</code></td>
<td>
<p>The vector of thresholds for the series <code class="reqn">\{Z_t\}</code>.</p>
</td></tr>
<tr><td><code id="simu.tar.norm_+3A_k">K</code></td>
<td>
<p>The vector containing the autoregressive orders of the l regimes.</p>
</td></tr>
<tr><td><code id="simu.tar.norm_+3A_theta">theta</code></td>
<td>
<p>The matrix of autoregressive coefficients of dimension <code class="reqn">l\times\max{K}</code>. <code class="reqn">j</code>-th row contains the autoregressive coefficients of regime <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="simu.tar.norm_+3A_h">H</code></td>
<td>
<p>The vector containing the variance weights of the <code class="reqn">l</code> regimes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TAR model is given by </p>
<p style="text-align: center;"><code class="reqn">X_t=a_0^{(j)} + \sum_{i=1}^{k_j}a_i^{(j)}X_{t-i}+h^{(j)}e_t</code>
</p>
<p> when <code class="reqn">Z_t\in (r_{j-1},r_j]</code> for som <code class="reqn">j</code> (<code class="reqn">j=1,\cdots,l</code>). 
the <code class="reqn">\{Z_t\}</code> is the threshold process, <code class="reqn">l</code> is the number of regimes, <code class="reqn">k_j</code> is the autoregressive order in the regime <code class="reqn">j</code>. <code class="reqn">a_i^{(j)}</code> with <code class="reqn">i=0,1,\cdots,k_j</code> denote the autoregressive coefficients, while <code class="reqn">h^{(j)}</code> denote the variance weights. <code class="reqn">\{e_t\}</code> is the Gaussian white noise process <code class="reqn">N(0,1)</code>.
</p>


<h3>Value</h3>

<p>The time series <code class="reqn">\{X_t\}</code>.
</p>


<h3>Author(s)</h3>

<p>Hanwen Zhang &lt;hanwenzhang at usantotomas.edu.co&gt;
</p>


<h3>References</h3>

<p>Nieto, F. H. (2005), <em>Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data</em>. Communications in Statistics. Theory and Methods, 34; 905-930
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simu.tar.norm">simu.tar.norm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Z&lt;-arima.sim(n=500,list(ar=c(0.5)))
l &lt;- 2
r &lt;- 0
K &lt;- c(2,1)
theta &lt;- matrix(c(1,-0.5,0.5,-0.7,-0.3,NA),nrow=l)
H &lt;- c(1, 1.5)
X &lt;- simu.tar.norm(Z,l,r,K,theta,H)
ts.plot(X)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
