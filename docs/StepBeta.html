<!DOCTYPE html><html lang="en"><head><title>Help for package StepBeta</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {StepBeta}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#check_formula_terms'><p>StepBeta and StepBetaBinomial internal object</p></a></li>
<li><a href='#Combination_Terms'><p>StepBetaBinomial internal object</p></a></li>
<li><a href='#dispersion_formula_terms'><p>StepBeta internal object</p></a></li>
<li><a href='#keep_formula_terms'><p>StepBeta internal object</p></a></li>
<li><a href='#remove_formula_interactions'><p>StepBeta internal object</p></a></li>
<li><a href='#Step_glimML'><p>Stepwise model selection for Beta-Binomial and Negative Binomial Regressions from aod package</p></a></li>
<li><a href='#StepBeta'><p>Stepwise model selection for Beta Regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stepwise Procedure for Beta, Beta-Binomial and Negative Binomial
Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Sergio Garofalo</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sergio Garofalo &lt;sergio.garofalo96@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Starting from a Regression Model, it provides a stepwise 
              procedure to select the linear predictor.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>glue, stats, betareg, combinat, aod, MASS</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-10 14:19:11 UTC; sergi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-10 15:30:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='check_formula_terms'>StepBeta and StepBetaBinomial internal object</h2><span id='topic+check_formula_terms'></span>

<h3>Description</h3>

<p>StepBeta and StepBetaBinomial internal object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_formula_terms(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_formula_terms_+3A_model">model</code></td>
<td>
<p>Beta regression model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the complete formula in a standard form
</p>

<hr>
<h2 id='Combination_Terms'>StepBetaBinomial internal object</h2><span id='topic+Combination_Terms'></span>

<h3>Description</h3>

<p>StepBetaBinomial internal object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Combination_Terms(Terms, interaction = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Combination_Terms_+3A_terms">Terms</code></td>
<td>
<p>Variables from the starting model</p>
</td></tr>
<tr><td><code id="Combination_Terms_+3A_interaction">interaction</code></td>
<td>
<p>Parameter to define which part of linear predictor to operate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function create alle possible combination of the linear predictor
</p>

<hr>
<h2 id='dispersion_formula_terms'>StepBeta internal object</h2><span id='topic+dispersion_formula_terms'></span>

<h3>Description</h3>

<p>StepBeta internal object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dispersion_formula_terms(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dispersion_formula_terms_+3A_object">object</code></td>
<td>
<p>full model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function updates the formula for the dispersion component of the model
</p>

<hr>
<h2 id='keep_formula_terms'>StepBeta internal object</h2><span id='topic+keep_formula_terms'></span>

<h3>Description</h3>

<p>StepBeta internal object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keep_formula_terms(the_formula, var_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="keep_formula_terms_+3A_the_formula">the_formula</code></td>
<td>
<p>Formula of Beta Regression model</p>
</td></tr>
<tr><td><code id="keep_formula_terms_+3A_var_name">var_name</code></td>
<td>
<p>Names of the variables to keep</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function updates the formula, it keeps the variables defined by the user
</p>

<hr>
<h2 id='remove_formula_interactions'>StepBeta internal object</h2><span id='topic+remove_formula_interactions'></span>

<h3>Description</h3>

<p>StepBeta internal object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_formula_interactions(the_formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remove_formula_interactions_+3A_the_formula">the_formula</code></td>
<td>
<p>Formula of Beta Regression model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a reduced form of the formula. It excludes the interactive effects.
</p>

<hr>
<h2 id='Step_glimML'>Stepwise model selection for Beta-Binomial and Negative Binomial Regressions from aod package</h2><span id='topic+Step_glimML'></span>

<h3>Description</h3>

<p>This function performs a stepwise algorithm to define the best linear predictor according to an user defined criterion (defeault is the Akaike Information Criterion aka AIC, but it is also possible to perform the corrected version AICc).
It works only for object from betabin function (class &quot;glimML&quot; from &quot;aod&quot; package). If the object is different from &quot;glimMl&quot; class, the function performs the classical step function in &quot;stats&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Step_glimML(object, k = 2, overdispersion = T, correctAIC = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Step_glimML_+3A_object">object</code></td>
<td>
<p>Object of class &quot;glimML&quot;. If the class is different the function apply step function in &quot;stats&quot; package</p>
</td></tr>
<tr><td><code id="Step_glimML_+3A_k">k</code></td>
<td>
<p>The penalty parameter used for the criterion, e.g. default is k = 2 which identify the classical AIC. BIC can be obtained as k = log(n)</p>
</td></tr>
<tr><td><code id="Step_glimML_+3A_overdispersion">overdispersion</code></td>
<td>
<p>Provide the stepwise procedure also for the overdispersion component of the model (defined as random) Default is TRUE</p>
</td></tr>
<tr><td><code id="Step_glimML_+3A_correctaic">correctAIC</code></td>
<td>
<p>Use AICc instead of AIC. Default TRUE is for AICc</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Step_glimML is different from step (stats) and stepAIC (MASS) functions; for an object of class betabin is impossible to use an algorithm which uses the function extractAIC.
Starting from a full model it provides a backaward procedure where the scope model is the reduced one.
</p>
<p>First, Step_glimML operates with all the principal effects included in the model; starting from the full model, the algorithm computes all the possible models, it calculates the measure (default is AIC) and it defines as a good predictor the model with lower AIC.
</p>
<p>Then, based on the previous results, Step_glimML operates adding all the possible interactive effects. As in the first passage, the model choosen by the algorithm is the one whose AIC is the lowest.
</p>
<p>During the procedure, Step_glimML considers all the possible models which betabin can fit. There are many cases where betabin function falls into error, in these cases the algorithm does not consider the linear predictor which causes the error and it goes forward.
</p>


<h3>Value</h3>

<p>The algorithm returns an object of class &quot;glimML&quot;
</p>


<h3>Author(s)</h3>

<p>Sergio Garofalo
</p>


<h3>References</h3>

<p>Crowder, M.J., 1978. Beta-binomial anova for proportions. Appl. Statist. 27, 34-37.
</p>
<p>Lawless, J.F., 1987. Negative binomial and mixed Poisson regression. The Canadian Journal of Statistics, 15(3): 209-225.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) Modern Applied Statistics with S. Fourth edition. Springer.
</p>
<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) The New S Language. Wadsworth &amp; Brooks/Cole. (has iris3 as iris.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Starting from a "betabinom" model

## Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) The New S Language.
## Wadsworth &amp; Brooks/Cole. (has iris3 as iris.)

## Prepare the data

library(aod)
data(iris)

############ Beta Binomial model
## Not run: 
n &lt;- round(runif(dim(iris)[1],1,50))
y &lt;- round(runif(length(n), 1,n))
data &lt;- cbind(iris,y,n)
fullModel &lt;- betabin(cbind(y, n - y) ~ Sepal.Width * Petal.Length + Petal.Width, ~ Species,
                     data = data)
reducedModel &lt;- Step_glimML(fullModel)
summary(reducedModel)

## End(Not run)
############ Negative Binomial model
## Not run: 
data &lt;- iris
data$Sepal.Length &lt;- round(Sepal.length + runif(dim(data)[1],0,1) * 100)
fullModel &lt;- negbin(Sepal.Length ~ Sepal.Width * Petal.Length + Petal.Width, ~ Species,
                    data = data)
reducedModel &lt;-Step_glimML(fullModel)
summary(reducedModel)

## End(Not run)

</code></pre>

<hr>
<h2 id='StepBeta'>Stepwise model selection for Beta Regression</h2><span id='topic+StepBeta'></span>

<h3>Description</h3>

<p>This function performs a stepwise algorithm to define the best linear predictor according to an user defined criterion (defeault is the Akaike Information Criterion aka AIC).
It works for objects of class &quot;betareg&quot; from betareg function. If the object is different from &quot;betareg&quot; class, the function performs the classical step function in &quot;stats&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StepBeta(object, k = 2, dispersion = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="StepBeta_+3A_object">object</code></td>
<td>
<p>Object of class &quot;betareg&quot;. If the class is different the function apply the step function in &quot;stats&quot; package</p>
</td></tr>
<tr><td><code id="StepBeta_+3A_k">k</code></td>
<td>
<p>The penalty parameter used for the criterion, e.g. default is k = 2 which identify the classical AIC. BIC can be obtained as k = log(n)</p>
</td></tr>
<tr><td><code id="StepBeta_+3A_dispersion">dispersion</code></td>
<td>
<p>Provide the stepwise procedure also for dispersion parameter. Default is TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>StepBeta is different from step (stats) and stepAIC (MASS) functions; for an object of class &quot;betareg&quot; is impossible to use an algorithm which uses the function extractAIC
Starting from a full model it provides a backaward procedure where the scope model is the reduced one.
</p>
<p>First, StepBeta operates with all the principal effects included in the model; starting from the full model, the algorithm computes all the possible models, it calculates the measure (default is AIC) and it defines as a good predictor the model with lower AIC.
</p>
<p>Then, based on the previous results, StepBeta operates adding all the possible interactive effects. As in the first passage, the model choosen by the algorithm is the one whose AIC is the lowest.
</p>
<p>During the procedure, StepBeta considers all the possible models which betareg can fit. There are many cases where betareg function falls into error, in these cases the algorithm does not consider the linear predictor which causes the error and it goes forward.
</p>


<h3>Value</h3>

<p>The algorithm returns an object of class &quot;betareg&quot;
</p>


<h3>Author(s)</h3>

<p>Sergio Garofalo
</p>


<h3>References</h3>

<p>Cribari-Neto, F., and Zeileis, A. (2010). Beta Regression in R. Journal of Statistical Software, 34(2), 1&ndash;24. 10.18637/jss.v034.i02
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) Modern Applied Statistics with S. Fourth edition. Springer.
</p>
<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) The New S Language. Wadsworth &amp; Brooks/Cole. (has iris3 as iris.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Starting from a "betareg" model

## Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) The New S Language.
## Wadsworth &amp; Brooks/Cole. (has iris3 as iris.)

## Prepare the data

library(betareg)
data &lt;- iris
data$Sepal.Length &lt;- data$Sepal.Length/(max(data$Sepal.Length) + 0.01)

###### Mean parameters

fullModel &lt;- betareg(Sepal.Length ~ Sepal.Width * Petal.Length *
                                    Petal.Width * Species, data = data)
reducedModel &lt;- StepBeta(fullModel)
summary(reducedModel)

##### Mean and precision parameters

fullModel &lt;- betareg(Sepal.Length ~ Sepal.Width * Petal.Length *
                                    Petal.Width * Species| Sepal.Width + Petal.Length,
                                    data = data)
reducedModel &lt;- StepBeta(fullModel, dispersion = TRUE)
summary(reducedModel)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
