<!DOCTYPE html><html><head><title>Help for package CholWishart</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CholWishart}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CholWishart'><p>Cholesky Factor of a Wishart or Inverse Wishart</p></a></li>
<li><a href='#dWishart'><p>Density for Random Wishart Distributed Matrices</p></a></li>
<li><a href='#lmvgamma'><p>Multivariate Gamma Function</p></a></li>
<li><a href='#mvdigamma'><p>Multivariate Digamma Function</p></a></li>
<li><a href='#rCholWishart'><p>Cholesky Factor of Random Wishart Distributed Matrices</p></a></li>
<li><a href='#rGenInvWishart'><p>Random Generalized Inverse Wishart Distributed Matrices</p></a></li>
<li><a href='#rInvCholWishart'><p>Cholesky Factor of Random Inverse Wishart Distributed Matrices</p></a></li>
<li><a href='#rInvWishart'><p>Random Inverse Wishart Distributed Matrices</p></a></li>
<li><a href='#rPseudoWishart'><p>Random Pseudo Wishart Distributed Matrices</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Cholesky Decomposition of the Wishart Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Sampling from the Cholesky factorization of a Wishart random 
    variable, sampling from the inverse Wishart distribution, sampling from 
    the Cholesky factorization of an inverse Wishart random variable, sampling
    from the pseudo Wishart distribution, sampling from the generalized
    inverse Wishart distribution, computing densities for the Wishart 
    and inverse Wishart distributions, and computing the multivariate gamma 
    and digamma functions. Provides a header file so the C functions can be
    called directly from other programs.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-us</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gzt/CholWishart">https://github.com/gzt/CholWishart</a>
<a href="https://gzt.github.io/CholWishart/">https://gzt.github.io/CholWishart/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gzt/CholWishart/issues">https://github.com/gzt/CholWishart/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-07 17:22:15 UTC; gzt</td>
</tr>
<tr>
<td>Author:</td>
<td>Geoffrey Thompson <a href="https://orcid.org/0000-0003-2436-8822"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  R Core Team [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Geoffrey Thompson &lt;gzthompson@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-08 08:30:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='CholWishart'>Cholesky Factor of a Wishart or Inverse Wishart</h2><span id='topic+CholWishart'></span>

<h3>Description</h3>

<p>The most common use for this package is likely fast sampling from the
inverse Wishart or use of the multivariate gamma and digamma functions.
This is a package for fast computation of various functions related to
the Wishart distribution, such as sampling from the Cholesky factorization
of the Wishart, sampling from the inverse Wishart,
sampling from the Cholesky factorization of the inverse Wishart,
sampling from the pseudo Wishart,
computing densities for the Wishart and inverse Wishart,
and computing a few auxiliary functions
such as the multivariate gamma and digamma functions.
Many of these functions are written in C to maximize efficiency.
</p>

<hr>
<h2 id='dWishart'>Density for Random Wishart Distributed Matrices</h2><span id='topic+dWishart'></span><span id='topic+dInvWishart'></span>

<h3>Description</h3>

<p>Compute the density of an observation of a random Wishart distributed matrix
(<code>dWishart</code>) or an observation
from the inverse Wishart distribution (<code>dInvWishart</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dWishart(x, df, Sigma, log = TRUE)

dInvWishart(x, df, Sigma, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dWishart_+3A_x">x</code></td>
<td>
<p>positive definite <code class="reqn">p \times p</code> observations for density
estimation - either one matrix or a 3-D array.</p>
</td></tr>
<tr><td><code id="dWishart_+3A_df">df</code></td>
<td>
<p>numeric parameter, &quot;degrees of freedom&quot;.</p>
</td></tr>
<tr><td><code id="dWishart_+3A_sigma">Sigma</code></td>
<td>
<p>positive definite <code class="reqn">p \times p</code> &quot;scale&quot; matrix,
the matrix parameter of the distribution.</p>
</td></tr>
<tr><td><code id="dWishart_+3A_log">log</code></td>
<td>
<p>logical, whether to return value on the log scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note there are different ways of parameterizing the Inverse
Wishart distribution, so check which one you need.
Here,  If <code class="reqn">X \sim IW_p(\Sigma, \nu)</code> then
<code class="reqn">X^{-1} \sim W_p(\Sigma^{-1}, \nu)</code>.
Dawid (1981) has a different definition: if
<code class="reqn">X \sim W_p(\Sigma^{-1}, \nu)</code> and
<code class="reqn">\nu &gt; p - 1</code>, then
<code class="reqn">X^{-1} = Y \sim IW(\Sigma, \delta)</code>,
where
<code class="reqn">\delta = \nu - p + 1</code>.
</p>


<h3>Value</h3>

<p>Density or log of density
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dInvWishart</code>: density for the inverse Wishart distribution.
</p>
</li></ul>


<h3>References</h3>

<p>Dawid, A. (1981). Some Matrix-Variate Distribution Theory:
Notational Considerations and a Bayesian Application.
<em>Biometrika</em>, 68(1), 265-274. doi: <a href="https://doi.org/10.2307/2335827">10.2307/2335827</a>
</p>
<p>Gupta, A. K.  and D. K. Nagar (1999). <em>Matrix variate distributions</em>.
Chapman and Hall.
</p>
<p>Mardia, K. V., J. T. Kent, and J. M. Bibby (1979)
<em>Multivariate Analysis</em>,
London: Academic Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20180222)
A &lt;- rWishart(1, 10, diag(4))[, , 1]
A
dWishart(x = A, df = 10, Sigma = diag(4L), log = TRUE)
dInvWishart(x = solve(A), df = 10, Sigma = diag(4L), log = TRUE)
</code></pre>

<hr>
<h2 id='lmvgamma'>Multivariate Gamma Function</h2><span id='topic+lmvgamma'></span><span id='topic+mvgamma'></span>

<h3>Description</h3>

<p>A special mathematical function related to the gamma function,
generalized for multivariate gammas. <code>lmvgamma</code> is the log of the
multivariate gamma, <code>mvgamma</code>.
</p>
<p>The multivariate gamma function for a dimension p is defined as:
</p>
<p style="text-align: center;"><code class="reqn">\Gamma_{p}(a)=\pi^{p(p-1)/4}\prod_{j=1}^{p}
    \Gamma [a+(1-j)/2]</code>
</p>

<p>For <code class="reqn">p = 1</code>, this is the same as the usual gamma function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmvgamma(x, p)

mvgamma(x, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmvgamma_+3A_x">x</code></td>
<td>
<p>non-negative numeric vector, matrix, or array</p>
</td></tr>
<tr><td><code id="lmvgamma_+3A_p">p</code></td>
<td>
<p>positive integer, dimension of a square matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>lmvgamma</code> log of multivariate gamma of dimension <code>p</code>
for each entry of <code>x</code>. For non-log variant,
use <code>mvgamma</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>mvgamma</code>: Multivariate gamma function.
</p>
</li></ul>


<h3>References</h3>

<p>A. K. Gupta and D. K. Nagar 1999. <em>Matrix variate distributions</em>.
Chapman and Hall.
</p>
<p>Multivariate gamma function.
In <em>Wikipedia, The Free Encyclopedia</em>,from
<a href="https://en.wikipedia.org/w/index.php?title=Multivariate_gamma_function">https://en.wikipedia.org/w/index.php?title=Multivariate_gamma_function</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+gamma">gamma</a></code> and <code><a href="base.html#topic+lgamma">lgamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lgamma(1:12)
lmvgamma(1:12, 1L)
mvgamma(1:12, 1L)
gamma(1:12)
</code></pre>

<hr>
<h2 id='mvdigamma'>Multivariate Digamma Function</h2><span id='topic+mvdigamma'></span>

<h3>Description</h3>

<p>A special mathematical function related to the gamma function,
generalized for multivariate distributions.
The multivariate digamma function is the derivative of the log of the
multivariate gamma function; for <code class="reqn">p = 1</code> it is the same as the
univariate digamma function.
</p>
<p style="text-align: center;"><code class="reqn">\psi_{p}(a)=\sum _{i=1}^{p}\psi(a+(1-i)/2)
     </code>
</p>

<p>where <code class="reqn">\psi</code> is the univariate digamma function (the
derivative of the log-gamma function).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvdigamma(x, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvdigamma_+3A_x">x</code></td>
<td>
<p>non-negative numeric vector, matrix, or array</p>
</td></tr>
<tr><td><code id="mvdigamma_+3A_p">p</code></td>
<td>
<p>positive integer, dimension of a square matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of values of multivariate digamma function.
</p>


<h3>References</h3>

<p>A. K. Gupta and D. K. Nagar 1999. <em>Matrix variate distributions</em>.
Chapman and Hall.
</p>
<p>Multivariate gamma function.
In <em>Wikipedia, The Free Encyclopedia</em>,from
<a href="https://en.wikipedia.org/w/index.php?title=Multivariate_gamma_function">https://en.wikipedia.org/w/index.php?title=Multivariate_gamma_function</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+gamma">gamma</a></code>, <code><a href="base.html#topic+lgamma">lgamma</a></code>,
<code><a href="base.html#topic+digamma">digamma</a></code>, and <code><a href="#topic+mvgamma">mvgamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>digamma(1:10)
mvdigamma(1:10, 1L)
</code></pre>

<hr>
<h2 id='rCholWishart'>Cholesky Factor of Random Wishart Distributed Matrices</h2><span id='topic+rCholWishart'></span>

<h3>Description</h3>

<p>Generate n random matrices, distributed according
to the Cholesky factorization of a Wishart distribution with
parameters <code>Sigma</code> and <code>df</code>, <code class="reqn">W_p(Sigma, df)</code>
(known as the Bartlett decomposition
in the context of Wishart random matrices).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rCholWishart(n, df, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rCholWishart_+3A_n">n</code></td>
<td>
<p>integer sample size.</p>
</td></tr>
<tr><td><code id="rCholWishart_+3A_df">df</code></td>
<td>
<p>numeric parameter, &quot;degrees of freedom&quot;.</p>
</td></tr>
<tr><td><code id="rCholWishart_+3A_sigma">Sigma</code></td>
<td>
<p>positive definite <code class="reqn">p \times p</code> &quot;scale&quot; matrix,
the matrix parameter of the distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric array, say <code>R</code>, of dimension
<code class="reqn">p \times p \times n</code>,
where each <code>R[,,i]</code> is a Cholesky decomposition of a sample
from the Wishart distribution <code class="reqn">W_p(Sigma, df)</code>. Based on a
modification of the existing code for the <code>rWishart</code> function.
</p>


<h3>References</h3>

<p>Anderson, T. W. (2003). <em>An Introduction to Multivariate Statistical
Analysis</em> (3rd ed.).
Hoboken, N. J.: Wiley Interscience.
</p>
<p>Mardia, K. V., J. T. Kent, and J. M. Bibby (1979)
<em>Multivariate Analysis</em>,
London: Academic Press.
</p>
<p>A. K. Gupta and D. K. Nagar 1999. <em>Matrix variate distributions</em>.
Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rWishart">rWishart</a></code>, <code><a href="#topic+rInvCholWishart">rInvCholWishart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># How it is parameterized:
set.seed(20180211)
A &lt;- rCholWishart(1L, 10, 3 * diag(5L))[, , 1]
A
set.seed(20180211)
B &lt;- rInvCholWishart(1L, 10, 1 / 3 * diag(5L))[, , 1]
B
crossprod(A) %*% crossprod(B)

set.seed(20180211)
C &lt;- chol(stats::rWishart(1L, 10, 3 * diag(5L))[, , 1])
C
</code></pre>

<hr>
<h2 id='rGenInvWishart'>Random Generalized Inverse Wishart Distributed Matrices</h2><span id='topic+rGenInvWishart'></span>

<h3>Description</h3>

<p>Generate n random matrices, distributed according
to the generalized inverse Wishart distribution with parameters
<code>Sigma</code> and <code>df</code>, <code class="reqn">W_p(\Sigma, df)</code>,
with sample size <code>df</code> less than the dimension <code>p</code>.
</p>
<p>Let <code class="reqn">X_i</code>, <code class="reqn">i = 1, 2, ..., df</code> be <code>df</code>
observations of a multivariate normal distribution with mean 0 and
covariance <code>Sigma</code>. Then <code class="reqn">\sum X_i X_i'</code> is distributed as a pseudo
Wishart <code class="reqn">W_p(\Sigma, df)</code>. Sometimes this is called a
singular Wishart distribution, however, that can be confused with the case
where <code class="reqn">\Sigma</code> itself is singular. Then the generalized inverse
Wishart distribution is the natural extension of the inverse Wishart using
the Moore-Penrose pseudo-inverse. This can generate samples for positive
semi-definite <code class="reqn">\Sigma</code> however, a function dedicated to generating
singular normal random distributions or singular pseudo Wishart distributions
should be used if that is desired.
</p>
<p>Note there are different ways of parameterizing the Inverse
Wishart distribution, so check which one you need.
Here, if <code class="reqn">X \sim IW_p(\Sigma, \nu)</code> then
<code class="reqn">X^{-1} \sim W_p(\Sigma^{-1}, \nu)</code>.
Dawid (1981) has a different definition: if
<code class="reqn">X \sim W_p(\Sigma^{-1}, \nu)</code> and
<code class="reqn">\nu &gt; p - 1</code>, then
<code class="reqn">X^{-1} = Y \sim IW(\Sigma, \delta)</code>,
where <code class="reqn">\delta = \nu - p + 1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rGenInvWishart(n, df, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rGenInvWishart_+3A_n">n</code></td>
<td>
<p>integer sample size.</p>
</td></tr>
<tr><td><code id="rGenInvWishart_+3A_df">df</code></td>
<td>
<p>integer parameter, &quot;degrees of freedom&quot;, should be less than the
dimension of <code>p</code></p>
</td></tr>
<tr><td><code id="rGenInvWishart_+3A_sigma">Sigma</code></td>
<td>
<p>positive semi-definite <code class="reqn">p \times p</code> &quot;scale&quot; matrix,
the matrix parameter of the distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric array, say <code>R</code>, of dimension
<code class="reqn">p \times p \times n</code>,
where each <code>R[,,i]</code> is a realization of the pseudo Wishart
distribution <code class="reqn">W_p(Sigma, df)</code>.
</p>


<h3>References</h3>

<p>Diaz-Garcia, Jose A, Ramon Gutierrez Jaimez, and Kanti V Mardia. 1997.
“Wishart and Pseudo-Wishart Distributions and Some Applications to
Shape Theory.”
Journal of Multivariate Analysis 63 (1): 73–87. doi: <a href="https://doi.org/10.1006/jmva.1997.1689">10.1006/jmva.1997.1689</a>.
</p>
<p>Bodnar, T.,  Mazur, S., Podgórski, K.
&quot;Singular inverse Wishart distribution and
its application to portfolio theory&quot;,
Journal of Multivariate Analysis, Volume 143,
2016, Pages 314-326, ISSN 0047-259X,
doi: <a href="https://doi.org/10.1016/j.jmva.2015.09.021">10.1016/j.jmva.2015.09.021</a>.
</p>
<p>Bodnar, T.,  Okhrin, Y., &quot;Properties of the singular, inverse
and generalized inverse partitioned Wishart distributions&quot;, Journal of
Multivariate Analysis, Volume 99, Issue 10, 2008,  Pages 2389-2405,
ISSN 0047-259X, doi: <a href="https://doi.org/10.1016/j.jmva.2008.02.024">10.1016/j.jmva.2008.02.024</a>.
</p>
<p>Uhlig, Harald. &quot;On Singular Wishart and Singular Multivariate Beta
Distributions.&quot;
Ann. Statist. 22 (1994), no. 1, 395&ndash;405. doi: <a href="https://doi.org/10.1214/aos/1176325375">10.1214/aos/1176325375</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rWishart">rWishart</a></code>, <code><a href="#topic+rInvWishart">rInvWishart</a></code>,
and <code><a href="#topic+rPseudoWishart">rPseudoWishart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20181228)
A &lt;- rGenInvWishart(1L, 4L, 5.0 * diag(5L))[, , 1]
A
# A should be singular
eigen(A)$values
set.seed(20181228)
B &lt;- rPseudoWishart(1L, 4L, 5.0 * diag(5L))[, , 1]

# A should be a Moore-Penrose pseudo-inverse of B
B
# this should be equal to B
B %*% A %*% B
# this should be equal to A
A %*% B %*% A
</code></pre>

<hr>
<h2 id='rInvCholWishart'>Cholesky Factor of Random Inverse Wishart Distributed Matrices</h2><span id='topic+rInvCholWishart'></span>

<h3>Description</h3>

<p>Generate n random matrices, distributed according
to the Cholesky factor of an inverse Wishart distribution with
parameters <code>Sigma</code> and <code>df</code>, <code class="reqn">W_p(Sigma, df)</code>.
</p>
<p>Note there are different ways of parameterizing the Inverse
Wishart distribution, so check which one you need.
Here, if <code class="reqn">X \sim IW_p(\Sigma, \nu)</code> then
<code class="reqn">X^{-1} \sim W_p(\Sigma^{-1}, \nu)</code>.
Dawid (1981) has a different definition: if
<code class="reqn">X \sim W_p(\Sigma^{-1}, \nu)</code> and
<code class="reqn">\nu &gt; p - 1</code>, then
<code class="reqn">X^{-1} = Y \sim IW(\Sigma, \delta)</code>,
where <code class="reqn">\delta = \nu - p + 1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rInvCholWishart(n, df, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rInvCholWishart_+3A_n">n</code></td>
<td>
<p>integer sample size.</p>
</td></tr>
<tr><td><code id="rInvCholWishart_+3A_df">df</code></td>
<td>
<p>numeric parameter, &quot;degrees of freedom&quot;.</p>
</td></tr>
<tr><td><code id="rInvCholWishart_+3A_sigma">Sigma</code></td>
<td>
<p>positive definite <code class="reqn">p \times p</code> &quot;scale&quot; matrix,
the matrix parameter of the distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric array, say <code>R</code>, of dimension
<code class="reqn">p \times p \times n</code>,
where each <code>R[,,i]</code> is a Cholesky decomposition of a realization
of the Wishart distribution <code class="reqn">W_p(Sigma, df)</code>.
Based on a modification of the existing code for the <code>rWishart</code> function
</p>


<h3>References</h3>

<p>Anderson, T. W. (2003).
<em>An Introduction to Multivariate Statistical Analysis</em> (3rd ed.).
Hoboken, N. J.: Wiley Interscience.
</p>
<p>Dawid, A. (1981). Some Matrix-Variate Distribution Theory:
Notational Considerations and a
Bayesian Application. <em>Biometrika</em>, 68(1), 265-274.
doi: <a href="https://doi.org/10.2307/2335827">10.2307/2335827</a>
</p>
<p>Gupta, A. K.  and D. K. Nagar (1999). <em>Matrix variate distributions</em>.
Chapman and Hall.
</p>
<p>Mardia, K. V., J. T. Kent, and J. M. Bibby (1979)
<em>Multivariate Analysis</em>,
London: Academic Press.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rWishart">rWishart</a></code> and <code><a href="#topic+rCholWishart">rCholWishart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># How it is parameterized:
set.seed(20180211)
A &lt;- rCholWishart(1L, 10, 3 * diag(5L))[, , 1]
A
set.seed(20180211)
B &lt;- rInvCholWishart(1L, 10, 1 / 3 * diag(5L))[, , 1]
B
crossprod(A) %*% crossprod(B)

set.seed(20180211)
C &lt;- chol(stats::rWishart(1L, 10, 3 * diag(5L))[, , 1])
C
</code></pre>

<hr>
<h2 id='rInvWishart'>Random Inverse Wishart Distributed Matrices</h2><span id='topic+rInvWishart'></span>

<h3>Description</h3>

<p>Generate n random matrices, distributed according
to the inverse Wishart distribution with parameters <code>Sigma</code> and
<code>df</code>, <code class="reqn">W_p(Sigma, df)</code>.
</p>
<p>Note there are different ways of parameterizing the Inverse
Wishart distribution, so check which one you need.
Here, if <code class="reqn">X \sim IW_p(\Sigma, \nu)</code> then
<code class="reqn">X^{-1} \sim W_p(\Sigma^{-1}, \nu)</code>.
Dawid (1981) has a different definition: if
<code class="reqn">X \sim W_p(\Sigma^{-1}, \nu)</code> and
<code class="reqn">\nu &gt; p - 1</code>, then
<code class="reqn">X^{-1} = Y \sim IW(\Sigma, \delta)</code>,
where <code class="reqn">\delta = \nu - p + 1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rInvWishart(n, df, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rInvWishart_+3A_n">n</code></td>
<td>
<p>integer sample size.</p>
</td></tr>
<tr><td><code id="rInvWishart_+3A_df">df</code></td>
<td>
<p>numeric parameter, &quot;degrees of freedom&quot;.</p>
</td></tr>
<tr><td><code id="rInvWishart_+3A_sigma">Sigma</code></td>
<td>
<p>positive definite <code class="reqn">p \times p</code> &quot;scale&quot; matrix,
the matrix parameter of the distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric array, say <code>R</code>, of dimension
<code class="reqn">p \times p \times n</code>,
where each <code>R[,,i]</code> is a realization of the inverse Wishart distribution
<code class="reqn">IW_p(Sigma, df)</code>.
Based on a modification of the existing code for the <code>rWishart</code>
function.
</p>


<h3>References</h3>

<p>Dawid, A. (1981). Some Matrix-Variate Distribution Theory:
Notational Considerations and a
Bayesian Application. <em>Biometrika</em>, 68(1), 265-274.
doi: <a href="https://doi.org/10.2307/2335827">10.2307/2335827</a>
</p>
<p>Gupta, A. K.  and D. K. Nagar (1999). <em>Matrix variate distributions</em>.
Chapman and Hall.
</p>
<p>Mardia, K. V., J. T. Kent, and J. M. Bibby (1979)
<em>Multivariate Analysis</em>,
London: Academic Press.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rWishart">rWishart</a></code>, <code><a href="#topic+rCholWishart">rCholWishart</a></code>,
and <code><a href="#topic+rInvCholWishart">rInvCholWishart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20180221)
A &lt;- rInvWishart(1L, 10, 5 * diag(5L))[, , 1]
set.seed(20180221)
B &lt;- stats::rWishart(1L, 10, .2 * diag(5L))[, , 1]

A %*% B
</code></pre>

<hr>
<h2 id='rPseudoWishart'>Random Pseudo Wishart Distributed Matrices</h2><span id='topic+rPseudoWishart'></span>

<h3>Description</h3>

<p>Generate n random matrices, distributed according
to the pseudo Wishart distribution with parameters <code>Sigma</code> and
<code>df</code>, <code class="reqn">W_p(\Sigma, df)</code>, with sample size
<code>df</code> less than the dimension <code>p</code>.
</p>
<p>Let <code class="reqn">X_i</code>, <code class="reqn">i = 1, 2, ..., df</code> be <code>df</code>
observations of a multivariate normal distribution with mean 0 and
covariance <code>Sigma</code>. Then <code class="reqn">\sum X_i X_i'</code> is distributed as a pseudo
Wishart <code class="reqn">W_p(\Sigma, df)</code>. Sometimes this is called a
singular Wishart distribution, however, that can be confused with the case
where <code class="reqn">\Sigma</code> itself is singular. If cases with a singular
<code class="reqn">\Sigma</code> are desired, this function cannot provide them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rPseudoWishart(n, df, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rPseudoWishart_+3A_n">n</code></td>
<td>
<p>integer sample size.</p>
</td></tr>
<tr><td><code id="rPseudoWishart_+3A_df">df</code></td>
<td>
<p>integer parameter, &quot;degrees of freedom&quot;, should be less than the
dimension of <code>p</code></p>
</td></tr>
<tr><td><code id="rPseudoWishart_+3A_sigma">Sigma</code></td>
<td>
<p>positive definite <code class="reqn">p \times p</code> &quot;scale&quot; matrix, the
matrix parameter of the distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric array, say <code>R</code>, of dimension
<code class="reqn">p \times p \times n</code>,
where each <code>R[,,i]</code> is a realization of the pseudo Wishart
distribution <code class="reqn">W_p(Sigma, df)</code>.
</p>


<h3>References</h3>

<p>Diaz-Garcia, Jose A, Ramon Gutierrez Jaimez, and Kanti V Mardia. 1997.
“Wishart and Pseudo-Wishart Distributions and Some Applications to
Shape Theory.”
Journal of Multivariate Analysis 63 (1): 73–87. doi: <a href="https://doi.org/10.1006/jmva.1997.1689">10.1006/jmva.1997.1689</a>.
</p>
<p>Uhlig, Harald. &quot;On Singular Wishart and Singular Multivariate
Beta Distributions.&quot;
Ann. Statist. 22 (1994), no. 1, 395&ndash;405. doi: <a href="https://doi.org/10.1214/aos/1176325375">10.1214/aos/1176325375</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rWishart">rWishart</a></code>, <code><a href="#topic+rInvWishart">rInvWishart</a></code>,
and <code><a href="#topic+rGenInvWishart">rGenInvWishart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20181227)
A &lt;- rPseudoWishart(1L, 4L, 5.0 * diag(5L))[, , 1]
# A should be singular
eigen(A)$values
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
