<!DOCTYPE html><html><head><title>Help for package imputeFin</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {imputeFin}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#imputeFin-package'><p>imputeFin: Imputation of Financial Time Series with Missing Values.</p></a></li>
<li><a href='#fit_AR1_Gaussian'><p>Fit Gaussian AR(1) model to time series with missing values and/or outliers</p></a></li>
<li><a href='#fit_AR1_t'><p>Fit Student's t AR(1) model to time series with missing values and/or outliers</p></a></li>
<li><a href='#fit_VAR_t'><p>Fit Student's t VAR model to time series with missing values and/or outliers</p></a></li>
<li><a href='#impute_AR1_Gaussian'><p>Impute missing values of time series based on a Gaussian AR(1) model</p></a></li>
<li><a href='#impute_AR1_t'><p>Impute missing values of time series based on a Student's t AR(1) model</p></a></li>
<li><a href='#impute_OHLC'><p>Impute missing values of an OHLC time series on a rolling window basis based on a Gaussian AR(1) model</p></a></li>
<li><a href='#impute_rolling_AR1_Gaussian'><p>Impute missing values of time series on a rolling window basis based on a Gaussian AR(1) model</p></a></li>
<li><a href='#plot_imputed'><p>Plot imputed time series.</p></a></li>
<li><a href='#ts_AR1_Gaussian'><p>Synthetic AR(1) Gaussian time series with missing values</p></a></li>
<li><a href='#ts_AR1_t'><p>Synthetic AR(1) Student's t time series with missing values</p></a></li>
<li><a href='#ts_VAR_t'><p>Synthetic Student's t VAR data with missing values</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Imputation of Financial Time Series with Missing Values and/or
Outliers</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-02-19</td>
</tr>
<tr>
<td>Description:</td>
<td>Missing values often occur in financial data due to a variety 
    of reasons (errors in the collection process or in the processing stage, 
    lack of asset liquidity, lack of reporting of funds, etc.). However, 
    most data analysis methods expect complete data and cannot be employed 
    with missing values. One convenient way to deal with this issue without 
    having to redesign the data analysis method is to impute the missing 
    values. This package provides an efficient way to impute the missing 
    values based on modeling the time series with a random walk or an 
    autoregressive (AR) model, convenient to model log-prices and log-volumes 
    in financial data. In the current version, the imputation is 
    univariate-based (so no asset correlation is used). In addition,
    outliers can be detected and removed.
    The package is based on the paper:
    J. Liu, S. Kumar, and D. P. Palomar (2019). Parameter Estimation of 
    Heavy-Tailed AR Model With Missing Data Via Stochastic EM. IEEE Trans. on 
    Signal Processing, vol. 67, no. 8, pp. 2159-2172. &lt;<a href="https://doi.org/10.1109%2FTSP.2019.2899816">doi:10.1109/TSP.2019.2899816</a>&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel P. Palomar &lt;daniel.p.palomar@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=imputeFin">https://CRAN.R-project.org/package=imputeFin</a>,
<a href="https://github.com/dppalomar/imputeFin">https://github.com/dppalomar/imputeFin</a>,
<a href="https://www.danielppalomar.com">https://www.danielppalomar.com</a>,
<a href="https://doi.org/10.1109/TSP.2019.2899816">https://doi.org/10.1109/TSP.2019.2899816</a>,
<a href="https://doi.org/10.1109/TSP.2020.3033378">https://doi.org/10.1109/TSP.2020.3033378</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dppalomar/imputeFin/issues">https://github.com/dppalomar/imputeFin/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, zoo, mvtnorm, magrittr, parallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, ggplot2, prettydoc, rmarkdown, R.rsp, testthat, xts</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown, R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-20 01:21:56 UTC; palomar</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel P. Palomar [cre, aut],
  Junyan Liu [aut],
  Rui Zhou [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-20 05:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='imputeFin-package'>imputeFin: Imputation of Financial Time Series with Missing Values.</h2><span id='topic+imputeFin-package'></span>

<h3>Description</h3>

<p>Missing values often occur in financial data due to a variety 
of reasons (errors in the collection process or in the processing stage, 
lack of asset liquidity, lack of reporting of funds, etc.). However, 
most data analysis methods expect complete data and cannot be employed 
with missing values. One convenient way to deal with this issue without 
having to redesign the data analysis method is to impute the missing 
values. This package provides an efficient way to impute the missing 
values based on modeling the time series with a random walk or an 
autoregressive (AR) model, convenient to model log-prices and log-volumes 
in financial data. In the current version, the imputation is 
univariate-based (so no asset correlation is used). In addition,
outliers can be detected and removed.
</p>


<h3>Functions</h3>

<p><code><a href="#topic+fit_AR1_Gaussian">fit_AR1_Gaussian</a></code>, <code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code>,
<code><a href="#topic+fit_AR1_t">fit_AR1_t</a></code>, <code><a href="#topic+impute_AR1_t">impute_AR1_t</a></code>,
<code><a href="#topic+plot_imputed">plot_imputed</a></code>
</p>


<h3>Data</h3>

<p><code><a href="#topic+ts_AR1_Gaussian">ts_AR1_Gaussian</a></code>, <code><a href="#topic+ts_AR1_t">ts_AR1_t</a></code>
</p>


<h3>Help</h3>

<p>For a quick help see the README file:
<a href="https://github.com/dppalomar/imputeFin/blob/master/README.md">GitHub-README</a>.
</p>
<p>For more details see the vignette:
<a href="https://CRAN.R-project.org/package=imputeFin/vignettes/ImputeFinancialTimeSeries.html">CRAN-vignette</a>.
</p>


<h3>Author(s)</h3>

<p>Junyan Liu, Rui Zhou, and Daniel P. Palomar
</p>


<h3>References</h3>

<p>J. Liu, S. Kumar, and D. P. Palomar, &quot;Parameter estimation of heavy-tailed AR model with missing 
data via stochastic EM,&quot; IEEE Trans. on Signal Processing, vol. 67, no. 8, pp. 2159-2172, Apr. 2019.
&lt;https://doi.org/10.1109/TSP.2019.2899816&gt;
</p>
<p>R. Zhou, J. Liu, S. Kumar, and D. P. Palomar, &quot;Studentâ€™s t VAR Modeling with Missing Data via 
Stochastic EM and Gibbs Sampling,&quot; IEEE Trans. on Signal Processing, vol. 68, pp. 6198-6211, Oct. 2020.
&lt;https://doi.org/10.1109/TSP.2020.3033378&gt;
</p>

<hr>
<h2 id='fit_AR1_Gaussian'>Fit Gaussian AR(1) model to time series with missing values and/or outliers</h2><span id='topic+fit_AR1_Gaussian'></span>

<h3>Description</h3>

<p>Estimate the parameters of a univariate Gaussian AR(1) model 
to fit the given time series with missing values and/or outliers. 
For multivariate time series, the function will perform a 
number of individual univariate fittings without attempting 
to model the correlations among the time series.
If the time series does not contain missing values, the 
maximum likelihood (ML) estimation is done in one shot.
With missing values, the iterative EM algorithm is employed 
for the estimation until converge is achieved.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_AR1_Gaussian(
  y,
  random_walk = FALSE,
  zero_mean = FALSE,
  remove_outliers = FALSE,
  outlier_prob_th = 0.001,
  verbose = TRUE,
  return_iterates = FALSE,
  return_condMeanCov = FALSE,
  tol = 1e-08,
  maxiter = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_AR1_Gaussian_+3A_y">y</code></td>
<td>
<p>Time series object coercible to either a numeric vector or numeric matrix 
(e.g., <code>zoo</code> or <code>xts</code>) with missing values denoted by <code>NA</code>.</p>
</td></tr>
<tr><td><code id="fit_AR1_Gaussian_+3A_random_walk">random_walk</code></td>
<td>
<p>Logical value indicating if the time series is assumed to be a random walk so that <code>phi1 = 1</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_Gaussian_+3A_zero_mean">zero_mean</code></td>
<td>
<p>Logical value indicating if the time series is assumed zero-mean so that <code>phi0 = 0</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_Gaussian_+3A_remove_outliers">remove_outliers</code></td>
<td>
<p>Logical value indicating whether to detect and remove outliers.</p>
</td></tr>
<tr><td><code id="fit_AR1_Gaussian_+3A_outlier_prob_th">outlier_prob_th</code></td>
<td>
<p>Threshold of probability of observation to declare an outlier (default is <code>1e-3</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_Gaussian_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether to output messages (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_Gaussian_+3A_return_iterates">return_iterates</code></td>
<td>
<p>Logical value indicating if the iterates are to be returned (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_Gaussian_+3A_return_condmeancov">return_condMeanCov</code></td>
<td>
<p>Logical value indicating if the conditional mean and covariance matrix of the 
time series (excluding the leading and trailing missing values) given the observed data are to be returned (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_Gaussian_+3A_tol">tol</code></td>
<td>
<p>Positive number denoting the relative tolerance used as stopping criterion (default is <code>1e-8</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_Gaussian_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer indicating the maximum number of iterations allowed (default is <code>100</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the argument <code>y</code> is a univariate time series (i.e., coercible to a numeric vector), then this 
function will return a list with the following elements:
</p>
<table>
<tr><td><code>phi0</code></td>
<td>
<p>The estimate for <code>phi0</code> (real number).</p>
</td></tr>
<tr><td><code>phi1</code></td>
<td>
<p>The estimate for <code>phi1</code> (real number).</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>The estimate for <code>sigma^2</code> (positive number).</p>
</td></tr>
<tr><td><code>phi0_iterates</code></td>
<td>
<p>Numeric vector with the estimates for <code>phi0</code> at each iteration
(returned only when <code>return_iterates = TRUE</code>).</p>
</td></tr>
<tr><td><code>phi1_iterates</code></td>
<td>
<p>Numeric vector with the estimates for <code>phi1</code> at each iteration
(returned only when <code>return_iterates = TRUE</code>).</p>
</td></tr>
<tr><td><code>sigma2_iterates</code></td>
<td>
<p>Numeric vector with the estimates for <code>sigma^2</code> at each iteration
(returned only when <code>return_iterates = TRUE</code>).</p>
</td></tr>
<tr><td><code>f_iterates</code></td>
<td>
<p>Numeric vector with the objective values at each iteration
(returned only when <code>return_iterates = TRUE</code>).</p>
</td></tr>
<tr><td><code>cond_mean_y</code></td>
<td>
<p>Numeric vector (of same length as argument <code>y</code>) with the conditional mean of the time series 
(excluding the leading and trailing missing values)
given the observed data (returned only when <code>return_condMeanCov = TRUE</code>).</p>
</td></tr>
<tr><td><code>cond_cov_y</code></td>
<td>
<p>Numeric matrix (with number of columns/rows equal to the length of the argument <code>y</code>)
with the conditional covariance matrix of the time series (excluding the leading and trailing missing values) 
given the observed data (returned only when <code>return_condMeanCov = TRUE</code>).</p>
</td></tr>
<tr><td><code>index_miss</code></td>
<td>
<p>Indices of missing values imputed.</p>
</td></tr>
<tr><td><code>index_outliers</code></td>
<td>
<p>Indices of outliers detected/corrected.</p>
</td></tr>
</table>
<p>If the argument <code>y</code> is a multivariate time series (i.e., with multiple columns and coercible to a numeric matrix), 
then this function will return a list with each element as in the case of univariate <code>y</code> corresponding to each
of the columns (i.e., one list element per column of <code>y</code>), with the following additional elements that combine the 
estimated values in a convenient vector form:
</p>
<table>
<tr><td><code>phi0_vct</code></td>
<td>
<p>Numeric vector (with length equal to the number of columns of <code>y</code>)
with the estimates for <code>phi0</code> for each of the univariate time series.</p>
</td></tr>
<tr><td><code>phi1_vct</code></td>
<td>
<p>Numeric vector (with length equal to the number of columns of <code>y</code>)
with the estimates for <code>phi1</code> for each of the univariate time series.</p>
</td></tr>
<tr><td><code>sigma2_vct</code></td>
<td>
<p>Numeric vector (with length equal to the number of columns of <code>y</code>)
with the estimates for <code>sigma2</code> for each of the univariate time series.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Junyan Liu and Daniel P. Palomar
</p>


<h3>References</h3>

<p>R. J. Little and D. B. Rubin, Statistical Analysis with Missing Data, 2nd ed. Hoboken, N.J.: John Wiley &amp; Sons, 2002.
</p>
<p>J. Liu, S. Kumar, and D. P. Palomar, &quot;Parameter estimation of heavy-tailed AR model with missing 
data via stochastic EM,&quot; IEEE Trans. on Signal Processing, vol. 67, no. 8, pp. 2159-2172, 15 April, 2019.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code>, <code><a href="#topic+fit_AR1_t">fit_AR1_t</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(imputeFin)
data(ts_AR1_Gaussian)
y_missing &lt;- ts_AR1_Gaussian$y_missing
fitted &lt;- fit_AR1_Gaussian(y_missing)

</code></pre>

<hr>
<h2 id='fit_AR1_t'>Fit Student's t AR(1) model to time series with missing values and/or outliers</h2><span id='topic+fit_AR1_t'></span>

<h3>Description</h3>

<p>Estimate the parameters of a univariate Student's t AR(1) 
model to fit the given time series with missing values and/or outliers. 
For multivariate time series, the function will perform a 
number of indidivual univariate fittings without attempting 
to model the correlations among the time series.
If the time series does not contain missing values, the 
maximum likelihood (ML) estimation is done via the iterative
EM algorithm until converge is achieved.
With missing values, the stochastic EM algorithm is employed 
for the estimation (currently the maximum number of iterations
will be executed without attempting to check early converge).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_AR1_t(
  y,
  random_walk = FALSE,
  zero_mean = FALSE,
  fast_and_heuristic = TRUE,
  remove_outliers = FALSE,
  outlier_prob_th = 0.001,
  verbose = TRUE,
  return_iterates = FALSE,
  return_condMean_Gaussian = FALSE,
  tol = 1e-08,
  maxiter = 100,
  n_chain = 10,
  n_thin = 1,
  K = 30
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_AR1_t_+3A_y">y</code></td>
<td>
<p>Time series object coercible to either a numeric vector or numeric matrix 
(e.g., <code>zoo</code> or <code>xts</code>) with missing values denoted by <code>NA</code>.</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_random_walk">random_walk</code></td>
<td>
<p>Logical value indicating if the time series is assumed to be a random walk so that <code>phi1 = 1</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_zero_mean">zero_mean</code></td>
<td>
<p>Logical value indicating if the time series is assumed zero-mean so that <code>phi0 = 0</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_fast_and_heuristic">fast_and_heuristic</code></td>
<td>
<p>Logical value indicating whether a heuristic but fast method is to be used to 
estimate the parameters of the Student's t AR(1) model (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_remove_outliers">remove_outliers</code></td>
<td>
<p>Logical value indicating whether to detect and remove outliers.</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_outlier_prob_th">outlier_prob_th</code></td>
<td>
<p>Threshold of probability of observation to declare an outlier (default is <code>1e-3</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether to output messages (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_return_iterates">return_iterates</code></td>
<td>
<p>Logical value indicating if the iterates are to be returned (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_return_condmean_gaussian">return_condMean_Gaussian</code></td>
<td>
<p>Logical value indicating if the conditional mean and covariance matrix of the 
time series (excluding the leading and trailing missing values) given the observed 
data are to be returned (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_tol">tol</code></td>
<td>
<p>Positive number denoting the relative tolerance used as stopping criterion (default is <code>1e-8</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer indicating the maximum number of iterations allowed (default is <code>100</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_n_chain">n_chain</code></td>
<td>
<p>Positive integer indicating the number of the parallel Markov chains in the stochastic 
EM method (default is <code>10</code>).</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_n_thin">n_thin</code></td>
<td>
<p>Positive integer indicating the sampling period of the Gibbs sampling in the stochastic 
EM method (default is <code>1</code>). Every <code>n_thin</code>-th samples is used. This is aimed 
to reduce the dependence of the samples.</p>
</td></tr>
<tr><td><code id="fit_AR1_t_+3A_k">K</code></td>
<td>
<p>Positive number controlling the values of the step sizes in the stochastic EM method 
(default is <code>30</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the argument <code>y</code> is a univariate time series (i.e., coercible to a numeric vector), then this 
function will return a list with the following elements:
</p>
<table>
<tr><td><code>phi0</code></td>
<td>
<p>The estimate for <code>phi0</code> (real number).</p>
</td></tr>
<tr><td><code>phi1</code></td>
<td>
<p>The estimate for <code>phi1</code> (real number).</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>The estimate for <code>sigma^2</code> (positive number).</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>The estimate for <code>nu</code> (positive number).</p>
</td></tr>
<tr><td><code>phi0_iterates</code></td>
<td>
<p>Numeric vector with the estimates for <code>phi0</code> at each iteration
(returned only when <code>return_iterates = TRUE</code>).</p>
</td></tr>
<tr><td><code>phi1_iterates</code></td>
<td>
<p>Numeric vector with the estimates for <code>phi1</code> at each iteration
(returned only when <code>return_iterates = TRUE</code>).</p>
</td></tr>
<tr><td><code>sigma2_iterates</code></td>
<td>
<p>Numeric vector with the estimates for <code>sigma^2</code> at each iteration
(returned only when <code>return_iterates = TRUE</code>).</p>
</td></tr>
<tr><td><code>nu_iterate</code></td>
<td>
<p>Numeric vector with the estimates for <code>nu</code> at each iteration
(returned only when <code>return_iterates = TRUE</code>).</p>
</td></tr>
<tr><td><code>f_iterates</code></td>
<td>
<p>Numeric vector with the objective values at each iteration
(returned only when <code>return_iterates = TRUE</code>).</p>
</td></tr>
<tr><td><code>cond_mean_y_Gaussian</code></td>
<td>
<p>Numeric vector (of same length as argument <code>y</code>) with the conditional mean of the 
time series (excluding the missing values at the head and tail) given the observed data based 
on Gaussian AR(1) model (returned only when <code>return_condMean_Gaussian = TRUE</code>).</p>
</td></tr>
<tr><td><code>index_miss</code></td>
<td>
<p>Indices of missing values imputed.</p>
</td></tr>
<tr><td><code>index_outliers</code></td>
<td>
<p>Indices of outliers detected/corrected.</p>
</td></tr>
</table>
<p>If the argument <code>y</code> is a multivariate time series (i.e., with multiple columns and coercible to a numeric matrix), 
then this function will return a list with each element as in the case of univariate <code>y</code> corresponding to each
of the columns (i.e., one list element per column of <code>y</code>), with the following additional elements that combine the 
estimated values in a convenient vector form:
</p>
<table>
<tr><td><code>phi0_vct</code></td>
<td>
<p>Numeric vector (with length equal to the number of columns of <code>y</code>)
with the estimates for <code>phi0</code> for each of the univariate time series.</p>
</td></tr>
<tr><td><code>phi1_vct</code></td>
<td>
<p>Numeric vector (with length equal to the number of columns of <code>y</code>)
with the estimates for <code>phi1</code> for each of the univariate time series.</p>
</td></tr>
<tr><td><code>sigma2_vct</code></td>
<td>
<p>Numeric vector (with length equal to the number of columns of <code>y</code>)
with the estimates for <code>sigma2</code> for each of the univariate time series.</p>
</td></tr>
<tr><td><code>nu_vct</code></td>
<td>
<p>Numeric vector (with length equal to the number of columns of <code>y</code>)
with the estimates for <code>nu</code> for each of the univariate time series.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Junyan Liu and Daniel P. Palomar
</p>


<h3>References</h3>

<p>J. Liu, S. Kumar, and D. P. Palomar, &quot;Parameter estimation of heavy-tailed AR model with missing 
data via stochastic EM,&quot; IEEE Trans. on Signal Processing, vol. 67, no. 8, pp. 2159-2172, 15 April, 2019.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+impute_AR1_t">impute_AR1_t</a></code>, <code><a href="#topic+fit_AR1_Gaussian">fit_AR1_Gaussian</a></code>, <code><a href="#topic+fit_VAR_t">fit_VAR_t</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(imputeFin)
data(ts_AR1_t) 
y_missing &lt;- ts_AR1_t$y_missing
fitted &lt;- fit_AR1_t(y_missing)

</code></pre>

<hr>
<h2 id='fit_VAR_t'>Fit Student's t VAR model to time series with missing values and/or outliers</h2><span id='topic+fit_VAR_t'></span>

<h3>Description</h3>

<p>Estimate the parameters of a Student's t vector autoregressive
model 
</p>
<p style="text-align: center;"><code class="reqn">y_t = \phi_0 + \sum_{i=1}^p \Phi_i * y_{t-i} + \epsilon_t</code>
</p>

<p>to fit the given time series with missing values. 
If the time series does not contain missing values, the 
maximum likelihood (ML) estimation is done via the iterative
EM algorithm until converge is achieved.
With missing values, the stochastic EM algorithm is employed 
for the estimation (currently the maximum number of iterations
will be executed without attempting to check early converge).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_VAR_t(
  Y,
  p = 1,
  omit_missing = FALSE,
  parallel_max_cores = max(1, parallel::detectCores() - 1),
  verbose = FALSE,
  return_iterates = FALSE,
  initial = NULL,
  L = 10,
  maxiter = 50,
  ptol = 0.001,
  partition_groups = TRUE,
  K = round(maxiter/3)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_VAR_t_+3A_y">Y</code></td>
<td>
<p>Time series object coercible to either a numeric matrix (e.g., <code>zoo</code> or <code>xts</code>) with missing values denoted by <code>NA</code>.</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_p">p</code></td>
<td>
<p>Positive integer indicating the order of the VAR model.</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_omit_missing">omit_missing</code></td>
<td>
<p>Logical value indicating whether to use the omit-variable method, i.e., 
excluding the variables with missing data from the analysis (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_parallel_max_cores">parallel_max_cores</code></td>
<td>
<p>Positive integer indicating the maximum numer of cores used in the parallel computing, 
only valid when <code>partition_groups</code> = <code>TRUE</code> (default is <code class="reqn">1</code>).</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether to report in console the information of each iteration.</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_return_iterates">return_iterates</code></td>
<td>
<p>Logical value indicating whether to return the parameter estimates at each iteration (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_initial">initial</code></td>
<td>
<p>List with the initial values of the parameters of the VAR model, which may contain some or all of the following elements:
</p>
<ul>
<li><p><code>nu</code> (<code class="reqn">\nu</code>) - a positive number as the degrees of freedom,
</p>
</li>
<li><p><code>phi0</code> (<code class="reqn">\phi_0</code>) - a numerical vector of length <code>ncol(Y)</code> as the interception of VAR model,
</p>
</li>
<li><p><code>Phii</code> (<code class="reqn">\Phi_i</code>) - a list of <code>p</code> matrices of dimension <code>ncol(Y)</code> as the autoregressive coefficient matrices,
</p>
</li>
<li><p><code>scatter</code> (<code class="reqn">\Sigma</code>) - a positive definite of dimension <code>ncol(Y)</code> as the scatter matrix.</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_l">L</code></td>
<td>
<p>Positive integer with the number of Markov chains (default is <code class="reqn">10</code>).</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer with the number of maximum iterations (default is <code class="reqn">100</code>).</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_ptol">ptol</code></td>
<td>
<p>Non-negative number with the tolerance to determine the convergence of the (stochastic) EM method.</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_partition_groups">partition_groups</code></td>
<td>
<p>Logical value indicating whether to partition <code>Y</code> into groups (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="fit_VAR_t_+3A_k">K</code></td>
<td>
<p>Positive integer indicating the values of the step sizes in the stochastic EM method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>nu</code></td>
<td>
<p>The estimate for <code class="reqn">\nu</code>.</p>
</td></tr>
<tr><td><code>phi0</code></td>
<td>
<p>The estimate for <code class="reqn">\phi_0</code>.</p>
</td></tr>
<tr><td><code>Phii</code></td>
<td>
<p>The estimate for <code class="reqn">\Phi_i</code>.</p>
</td></tr>
<tr><td><code>scatter</code></td>
<td>
<p>The estimate for scatter matrix, i.e., <code class="reqn">\Sigma</code>.</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>A logical value indicating whether the method has converged.</p>
</td></tr>
<tr><td><code>iter_usage</code></td>
<td>
<p>A number indicating how many iteration has been used.</p>
</td></tr>
<tr><td><code>elapsed_times</code></td>
<td>
<p>A numerical vector indicating how much is comsumed in each iteration.</p>
</td></tr>
<tr><td><code>elapsed_time</code></td>
<td>
<p>A number indicating how much time is comsumed overall.</p>
</td></tr>
<tr><td><code>elapsed_time_per_iter</code></td>
<td>
<p>A number indicating how much time is comsumed for each iteration in average.</p>
</td></tr>
<tr><td><code>iterates_record</code></td>
<td>
<p>A list as the records of parameter estimates of each iteration, only returned when <code>return_iterates</code> = <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rui Zhou and Daniel P. Palomar
</p>


<h3>References</h3>

<p>R. Zhou, J. Liu, S. Kumar, and D. P. Palomar, &quot;Studentâ€™s t VAR Modeling with Missing Data via 
Stochastic EM and Gibbs Sampling,&quot; IEEE Trans. on Signal Processing, vol. 68, pp. 6198-6211, Oct. 2020.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_AR1_t">fit_AR1_t</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(imputeFin)
data(ts_VAR_t)
fitted &lt;- fit_VAR_t(Y = ts_VAR_t$Y, p = 2, parallel_max_cores = 2)


</code></pre>

<hr>
<h2 id='impute_AR1_Gaussian'>Impute missing values of time series based on a Gaussian AR(1) model</h2><span id='topic+impute_AR1_Gaussian'></span>

<h3>Description</h3>

<p>Impute inner missing values (excluding leading and trailing ones) 
of time series by drawing samples from the conditional distribution 
of the missing values given the observed data based on a Gaussian 
AR(1) model as estimated with the function <code><a href="#topic+fit_AR1_Gaussian">fit_AR1_Gaussian</a></code>. 
Outliers can be detected and removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute_AR1_Gaussian(
  y,
  n_samples = 1,
  random_walk = FALSE,
  zero_mean = FALSE,
  remove_outliers = FALSE,
  outlier_prob_th = 0.001,
  verbose = TRUE,
  return_estimates = FALSE,
  tol = 1e-10,
  maxiter = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impute_AR1_Gaussian_+3A_y">y</code></td>
<td>
<p>Time series object coercible to either a numeric vector or numeric matrix 
(e.g., <code>zoo</code> or <code>xts</code>) with missing values denoted by <code>NA</code>.</p>
</td></tr>
<tr><td><code id="impute_AR1_Gaussian_+3A_n_samples">n_samples</code></td>
<td>
<p>Positive integer indicating the number of imputations (default is <code>1</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_Gaussian_+3A_random_walk">random_walk</code></td>
<td>
<p>Logical value indicating if the time series is assumed to be a random walk so that <code>phi1 = 1</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_Gaussian_+3A_zero_mean">zero_mean</code></td>
<td>
<p>Logical value indicating if the time series is assumed zero-mean so that <code>phi0 = 0</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_Gaussian_+3A_remove_outliers">remove_outliers</code></td>
<td>
<p>Logical value indicating whether to detect and remove outliers.</p>
</td></tr>
<tr><td><code id="impute_AR1_Gaussian_+3A_outlier_prob_th">outlier_prob_th</code></td>
<td>
<p>Threshold of probability of observation to declare an outlier (default is <code>1e-3</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_Gaussian_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether to output messages (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_Gaussian_+3A_return_estimates">return_estimates</code></td>
<td>
<p>Logical value indicating if the estimates of the model parameters 
are to be returned (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_Gaussian_+3A_tol">tol</code></td>
<td>
<p>Positive number denoting the relative tolerance used as stopping criterion (default is <code>1e-8</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_Gaussian_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer indicating the maximum number of iterations allowed (default is <code>100</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>By default (i.e., for <code>n_samples = 1</code> and <code>return_estimates = FALSE</code>), 
the function will return an imputed time series of the same class and dimensions 
as the argument <code>y</code> with one new attribute recording the locations of missing 
values (the function <code><a href="#topic+plot_imputed">plot_imputed</a></code> will make use of such information
to indicate the imputed values), as well as locations of outliers removed.
</p>
<p>If <code>n_samples &gt; 1</code>, the function will return a list consisting of <code>n_sample</code> 
imputed time series with names: y_imputed.1, y_imputed.2, etc. 
</p>
<p>If <code>return_estimates = TRUE</code>, in addition to the imputed time series <code>y_imputed</code>, 
the function will return the estimated model parameters:
</p>
<table>
<tr><td><code>phi0</code></td>
<td>
<p>The estimate for <code>phi0</code> (numeric scalar or vector depending 
on the number of time series).</p>
</td></tr>
<tr><td><code>phi1</code></td>
<td>
<p>The estimate for <code>phi1</code> (numeric scalar or vector depending 
on the number of time series).</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>The estimate for <code>sigma2</code> (numeric scalar or vector depending 
on the number of time series).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Junyan Liu and Daniel P. Palomar
</p>


<h3>References</h3>

<p>R. J. Little and D. B. Rubin, Statistical Analysis with Missing Data, 2nd ed. Hoboken, N.J.: John Wiley &amp; Sons, 2002.
</p>
<p>J. Liu, S. Kumar, and D. P. Palomar, &quot;Parameter estimation of heavy-tailed AR model with missing 
data via stochastic EM,&quot; IEEE Trans. on Signal Processing, vol. 67, no. 8, pp. 2159-2172, 15 April, 2019.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_imputed">plot_imputed</a></code>, <code><a href="#topic+fit_AR1_Gaussian">fit_AR1_Gaussian</a></code>, <code><a href="#topic+impute_AR1_t">impute_AR1_t</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(imputeFin)
data(ts_AR1_Gaussian) 
y_missing &lt;- ts_AR1_Gaussian$y_missing
y_imputed &lt;- impute_AR1_Gaussian(y_missing)
plot_imputed(y_imputed)

</code></pre>

<hr>
<h2 id='impute_AR1_t'>Impute missing values of time series based on a Student's t AR(1) model</h2><span id='topic+impute_AR1_t'></span>

<h3>Description</h3>

<p>Impute inner missing values (excluding leading and trailing ones) 
of time series by drawing samples from the conditional distribution 
of the missing values given the observed data based on a Student's t 
AR(1) model as estimated with the function <code><a href="#topic+fit_AR1_t">fit_AR1_t</a></code>. 
Outliers can be detected and removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute_AR1_t(
  y,
  n_samples = 1,
  random_walk = FALSE,
  zero_mean = FALSE,
  fast_and_heuristic = TRUE,
  remove_outliers = FALSE,
  outlier_prob_th = 0.001,
  verbose = TRUE,
  return_estimates = FALSE,
  tol = 1e-08,
  maxiter = 100,
  K = 30,
  n_burn = 100,
  n_thin = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impute_AR1_t_+3A_y">y</code></td>
<td>
<p>Time series object coercible to either a numeric vector or numeric matrix 
(e.g., <code>zoo</code> or <code>xts</code>) with missing values denoted by <code>NA</code>.</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_n_samples">n_samples</code></td>
<td>
<p>Positive integer indicating the number of imputations (default is <code>1</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_random_walk">random_walk</code></td>
<td>
<p>Logical value indicating if the time series is assumed to be a random walk so that <code>phi1 = 1</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_zero_mean">zero_mean</code></td>
<td>
<p>Logical value indicating if the time series is assumed zero-mean so that <code>phi0 = 0</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_fast_and_heuristic">fast_and_heuristic</code></td>
<td>
<p>Logical value indicating whether a heuristic but fast method is to be used to 
estimate the parameters of the Student's t AR(1) model (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_remove_outliers">remove_outliers</code></td>
<td>
<p>Logical value indicating whether to detect and remove outliers.</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_outlier_prob_th">outlier_prob_th</code></td>
<td>
<p>Threshold of probability of observation to declare an outlier (default is <code>1e-3</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether to output messages (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_return_estimates">return_estimates</code></td>
<td>
<p>Logical value indicating if the estimates of the model parameters 
are to be returned (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_tol">tol</code></td>
<td>
<p>Positive number denoting the relative tolerance used as stopping criterion (default is <code>1e-8</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer indicating the maximum number of iterations allowed (default is <code>100</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_k">K</code></td>
<td>
<p>Positive number controlling the values of the step sizes in the stochastic EM method 
(default is <code>30</code>).</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_n_burn">n_burn</code></td>
<td>
<p>Positive integer controlling the length of the burn-in period of the Gibb sampling 
(default is <code>100</code>). The first <code>(n_burn * n_thin)</code> samples generated will 
be ignored.</p>
</td></tr>
<tr><td><code id="impute_AR1_t_+3A_n_thin">n_thin</code></td>
<td>
<p>Positive integer indicating the sampling period of the Gibbs sampling in the stochastic 
EM method (default is <code>1</code>). Every <code>n_thin</code>-th samples is used. This is aimed 
to reduce the dependence of the samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>By default (i.e., for <code>n_samples = 1</code> and <code>return_estimates = FALSE</code>), 
the function will return an imputed time series of the same class and dimensions 
as the argument <code>y</code> with one new attribute recording the locations of missing 
values (the function <code><a href="#topic+plot_imputed">plot_imputed</a></code> will make use of such information
to indicate the imputed values), as well as locations of outliers removed.
</p>
<p>If <code>n_samples &gt; 1</code>, the function will return a list consisting of <code>n_sample</code> 
imputed time series with names: y_imputed.1, y_imputed.2, etc.
</p>
<p>If <code>return_estimates = TRUE</code>, in addition to the imputed time series <code>y_imputed</code>, 
the function will return the estimated model parameters:
</p>
<table>
<tr><td><code>phi0</code></td>
<td>
<p>The estimate for <code>phi0</code> (numeric scalar or vector depending 
on the number of time series).</p>
</td></tr>
<tr><td><code>phi1</code></td>
<td>
<p>The estimate for <code>phi1</code> (numeric scalar or vector depending 
on the number of time series).</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>The estimate for <code>sigma2</code> (numeric scalar or vector depending 
on the number of time series).</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>The estimate for <code>nu</code> (numeric scalar or vector depending 
on the number of time series).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Junyan Liu and Daniel P. Palomar
</p>


<h3>References</h3>

<p>J. Liu, S. Kumar, and D. P. Palomar, &quot;Parameter estimation of heavy-tailed AR model with missing 
data via stochastic EM,&quot; IEEE Trans. on Signal Processing, vol. 67, no. 8, pp. 2159-2172, 15 April, 2019.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_imputed">plot_imputed</a></code>, <code><a href="#topic+fit_AR1_t">fit_AR1_t</a></code>, <code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(imputeFin)
data(ts_AR1_t) 
y_missing &lt;- ts_AR1_t$y_missing
y_imputed &lt;- impute_AR1_t(y_missing)
plot_imputed(y_imputed)

</code></pre>

<hr>
<h2 id='impute_OHLC'>Impute missing values of an OHLC time series on a rolling window basis based on a Gaussian AR(1) model</h2><span id='topic+impute_OHLC'></span>

<h3>Description</h3>

<p>Impute inner missing values (excluding leading and trailing ones) 
of an OHLC time series on a rolling window basis. This is a wrapper 
of the functions <code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code> and 
<code><a href="#topic+impute_rolling_AR1_Gaussian">impute_rolling_AR1_Gaussian</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute_OHLC(
  y_OHLC,
  rolling_window = 252,
  remove_outliers = FALSE,
  outlier_prob_th = 0.001,
  tol = 1e-10,
  maxiter = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impute_OHLC_+3A_y_ohlc">y_OHLC</code></td>
<td>
<p>Time series object coercible to a numeric matrix (e.g., <code>zoo</code> or <code>xts</code>) 
with four columns denoting the prices Op, Hi, Lo, Cl.</p>
</td></tr>
<tr><td><code id="impute_OHLC_+3A_rolling_window">rolling_window</code></td>
<td>
<p>Rolling window length (default is <code>252</code>).</p>
</td></tr>
<tr><td><code id="impute_OHLC_+3A_remove_outliers">remove_outliers</code></td>
<td>
<p>Logical value indicating whether to detect and remove outliers.</p>
</td></tr>
<tr><td><code id="impute_OHLC_+3A_outlier_prob_th">outlier_prob_th</code></td>
<td>
<p>Threshold of probability of observation to declare an outlier (default is <code>1e-3</code>).</p>
</td></tr>
<tr><td><code id="impute_OHLC_+3A_tol">tol</code></td>
<td>
<p>Positive number denoting the relative tolerance used as stopping criterion (default is <code>1e-8</code>).</p>
</td></tr>
<tr><td><code id="impute_OHLC_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer indicating the maximum number of iterations allowed (default is <code>100</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Imputed OHLC prices.
</p>


<h3>Author(s)</h3>

<p>Daniel P. Palomar
</p>


<h3>See Also</h3>

<p><code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code>, <code><a href="#topic+impute_rolling_AR1_Gaussian">impute_rolling_AR1_Gaussian</a></code>
</p>

<hr>
<h2 id='impute_rolling_AR1_Gaussian'>Impute missing values of time series on a rolling window basis based on a Gaussian AR(1) model</h2><span id='topic+impute_rolling_AR1_Gaussian'></span>

<h3>Description</h3>

<p>Impute inner missing values (excluding leading and trailing ones) 
of time series on a rolling window basis. This is a wrapper of the 
function <code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute_rolling_AR1_Gaussian(
  y,
  rolling_window = 252,
  random_walk = FALSE,
  zero_mean = FALSE,
  remove_outliers = FALSE,
  outlier_prob_th = 0.001,
  tol = 1e-10,
  maxiter = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impute_rolling_AR1_Gaussian_+3A_y">y</code></td>
<td>
<p>Time series object coercible to either a numeric vector or numeric matrix 
(e.g., <code>zoo</code> or <code>xts</code>) with missing values denoted by <code>NA</code>.</p>
</td></tr>
<tr><td><code id="impute_rolling_AR1_Gaussian_+3A_rolling_window">rolling_window</code></td>
<td>
<p>Rolling window length (default is <code>252</code>).</p>
</td></tr>
<tr><td><code id="impute_rolling_AR1_Gaussian_+3A_random_walk">random_walk</code></td>
<td>
<p>Logical value indicating if the time series is assumed to be a random walk so that <code>phi1 = 1</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="impute_rolling_AR1_Gaussian_+3A_zero_mean">zero_mean</code></td>
<td>
<p>Logical value indicating if the time series is assumed zero-mean so that <code>phi0 = 0</code> 
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="impute_rolling_AR1_Gaussian_+3A_remove_outliers">remove_outliers</code></td>
<td>
<p>Logical value indicating whether to detect and remove outliers.</p>
</td></tr>
<tr><td><code id="impute_rolling_AR1_Gaussian_+3A_outlier_prob_th">outlier_prob_th</code></td>
<td>
<p>Threshold of probability of observation to declare an outlier (default is <code>1e-3</code>).</p>
</td></tr>
<tr><td><code id="impute_rolling_AR1_Gaussian_+3A_tol">tol</code></td>
<td>
<p>Positive number denoting the relative tolerance used as stopping criterion (default is <code>1e-8</code>).</p>
</td></tr>
<tr><td><code id="impute_rolling_AR1_Gaussian_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer indicating the maximum number of iterations allowed (default is <code>100</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Same as <code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code> for the case <code>n_samples = 1</code> 
and <code>return_estimates = FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel P. Palomar
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_imputed">plot_imputed</a></code>, <code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(imputeFin)
data(ts_AR1_Gaussian) 
y_missing &lt;- ts_AR1_Gaussian$y_missing
y_imputed &lt;- impute_rolling_AR1_Gaussian(y_missing)
plot_imputed(y_imputed)

</code></pre>

<hr>
<h2 id='plot_imputed'>Plot imputed time series.</h2><span id='topic+plot_imputed'></span>

<h3>Description</h3>

<p>Plot single imputed time series (as returned by functions 
<code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code> and <code><a href="#topic+impute_AR1_t">impute_AR1_t</a></code>),
highlighting the imputed values in a different color.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_imputed(
  y_imputed,
  column = 1,
  title = "Imputed time series",
  color_imputed = "red",
  type = c("ggplot2", "simple")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_imputed_+3A_y_imputed">y_imputed</code></td>
<td>
<p>Imputed time series (can be any object coercible to a numeric vector 
or a numeric matrix). If it has the attribute <code>"index_miss"</code> (as
returned by any of the imputation functions 
<code><a href="#topic+impute_AR1_Gaussian">impute_AR1_Gaussian</a></code> and <code><a href="#topic+impute_AR1_t">impute_AR1_t</a></code>), then
it will highlight the imputed values in a different color.</p>
</td></tr>
<tr><td><code id="plot_imputed_+3A_column">column</code></td>
<td>
<p>Positive integer indicating the column index to be plotted (only valid if 
the argument <code>y_imputed</code> is coercible to a matrix with more than one 
column). Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot_imputed_+3A_title">title</code></td>
<td>
<p>Title of the plot (default is <code>"Imputed time series"</code>).</p>
</td></tr>
<tr><td><code id="plot_imputed_+3A_color_imputed">color_imputed</code></td>
<td>
<p>Color for the imputed values (default is <code>"red"</code>).</p>
</td></tr>
<tr><td><code id="plot_imputed_+3A_type">type</code></td>
<td>
<p>Type of plot. Valid options: <code>"ggplot2"</code> and <code>"simple"</code>. Default is 
<code>"ggplot2"</code> (the package <code>ggplot2</code> must be installed).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(imputeFin)
data(ts_AR1_t) 
y_missing &lt;- ts_AR1_t$y_missing
y_imputed &lt;- impute_AR1_t(y_missing)
plot_imputed(y_missing, title = "Original time series with missing values")
plot_imputed(y_imputed)

</code></pre>

<hr>
<h2 id='ts_AR1_Gaussian'>Synthetic AR(1) Gaussian time series with missing values</h2><span id='topic+ts_AR1_Gaussian'></span>

<h3>Description</h3>

<p>Synthetic AR(1) Gaussian time series with missing values for 
estimation and imputation testing purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ts_AR1_Gaussian)
</code></pre>


<h3>Format</h3>

<p>List with the following elements:
</p>

<dl>
<dt>y_missing</dt><dd><p>300 x 3 <code>zoo</code> object with three AR(1) Gaussian time 
series along the columns: the first column contains a
time series with 10% consecutive missing values; the
second column contains a time series with 10% missing 
values randomly distributed; and the third column contains 
the union of the previous missing values.</p>
</dd>
<dt>phi0</dt><dd><p>Value of <code>phi0</code> used to generate the time series.</p>
</dd>
<dt>phi1</dt><dd><p>Value of <code>phi1</code> used to generate the time series.</p>
</dd>
<dt>sigma2</dt><dd><p>Value of <code>sigma2</code> used to generate the time series.</p>
</dd>
</dl>


<hr>
<h2 id='ts_AR1_t'>Synthetic AR(1) Student's t time series with missing values</h2><span id='topic+ts_AR1_t'></span>

<h3>Description</h3>

<p>Synthetic AR(1) Student's t time series with missing values for 
estimation and imputation testing purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ts_AR1_t)
</code></pre>


<h3>Format</h3>

<p>List with the following elements:
</p>

<dl>
<dt>y_missing</dt><dd><p>300 x 3 <code>zoo</code> object with three AR(1) Student's t time 
series along the columns: the first column contains a
time series with 10% consecutive missing values; the
second column contains a time series with 10% missing 
values randomly distributed; and the third column contains 
the union of the previous missing values.</p>
</dd>
<dt>phi0</dt><dd><p>Value of <code>phi0</code> used to generate the time series.</p>
</dd>
<dt>phi1</dt><dd><p>Value of <code>phi1</code> used to generate the time series.</p>
</dd>
<dt>sigma2</dt><dd><p>Value of <code>sigma2</code> used to generate the time series.</p>
</dd>
<dt>nu</dt><dd><p>Value of <code>nu</code> used to generate the time series.</p>
</dd>
</dl>


<hr>
<h2 id='ts_VAR_t'>Synthetic Student's t VAR data with missing values</h2><span id='topic+ts_VAR_t'></span>

<h3>Description</h3>

<p>Synthetic Student's t VAR data with missing values for 
estimation and imputation testing purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ts_VAR_t)
</code></pre>


<h3>Format</h3>

<p>List with the following elements:
</p>

<dl>
<dt>Y</dt><dd><p>200 x 3 <code>zoo</code> object as a Student's t VAR time series.</p>
</dd>
<dt>phi0</dt><dd><p>True value of the constant vector in the VAR model.</p>
</dd>
<dt>Phii</dt><dd><p>True value of the coefficient matrix in the VAR model.</p>
</dd>
<dt>scatter</dt><dd><p>True value of the scatter matrix (of the noise distribution) in the VAR model.</p>
</dd>
<dt>nu</dt><dd><p>True value of the degrees of freedom (of the noise distribution) in the VAR model.</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
